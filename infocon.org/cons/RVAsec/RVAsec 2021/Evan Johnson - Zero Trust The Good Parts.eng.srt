1
00:00:15,839 --> 00:00:17,520
all right y'all i'm ready to get started

2
00:00:17,520 --> 00:00:19,600
are you

3
00:00:19,600 --> 00:00:20,720
awesome

4
00:00:20,720 --> 00:00:22,880
um hope you all had a great lunch it's

5
00:00:22,880 --> 00:00:24,880
great to be here at rva sec and great to

6
00:00:24,880 --> 00:00:27,279
see people in person for the first time

7
00:00:27,279 --> 00:00:29,279
in a long time it feels like at a

8
00:00:29,279 --> 00:00:31,359
security conference for me

9
00:00:31,359 --> 00:00:33,040
um

10
00:00:33,040 --> 00:00:36,559
i am speaking here today uh my talk is

11
00:00:36,559 --> 00:00:39,040
called zero trust the good parts and

12
00:00:39,040 --> 00:00:40,960
it's really kind of a talk about the

13
00:00:40,960 --> 00:00:43,120
three years of work that the last three

14
00:00:43,120 --> 00:00:46,079
years of my job completely changing how

15
00:00:46,079 --> 00:00:48,239
we do identity and access management at

16
00:00:48,239 --> 00:00:49,760
cloudflare

17
00:00:49,760 --> 00:00:51,039
and um

18
00:00:51,039 --> 00:00:53,360
kind of building a product to offer the

19
00:00:53,360 --> 00:00:55,039
same thing that we use internally

20
00:00:55,039 --> 00:00:56,960
externally and

21
00:00:56,960 --> 00:00:59,440
all the hairy decisions and things that

22
00:00:59,440 --> 00:01:00,960
we had to do

23
00:01:00,960 --> 00:01:02,239
and uh

24
00:01:02,239 --> 00:01:04,080
sharing the thought process throughout

25
00:01:04,080 --> 00:01:06,320
of about how we um

26
00:01:06,320 --> 00:01:08,479
addressed all of the problems that came

27
00:01:08,479 --> 00:01:10,880
with completely changing our

28
00:01:10,880 --> 00:01:12,240
identity and access management

29
00:01:12,240 --> 00:01:14,560
architecture

30
00:01:14,560 --> 00:01:17,680
who's heard the buzzword zero trust

31
00:01:17,680 --> 00:01:20,799
a lot of hands whose company is

32
00:01:20,799 --> 00:01:23,360
seriously investing in zero trust and

33
00:01:23,360 --> 00:01:25,759
and moving towards that model

34
00:01:25,759 --> 00:01:27,520
not as many hands

35
00:01:27,520 --> 00:01:29,920
uh that's surprising

36
00:01:29,920 --> 00:01:31,280
um

37
00:01:31,280 --> 00:01:34,479
all right well i'll get started

38
00:01:34,640 --> 00:01:37,680
so about me i work at cloudflare i'm a

39
00:01:37,680 --> 00:01:39,439
director of security engineering there i

40
00:01:39,439 --> 00:01:42,640
joined the company in 2015 uh as the

41
00:01:42,640 --> 00:01:44,640
first security engineer when we were

42
00:01:44,640 --> 00:01:46,799
about a hundred people and now it's been

43
00:01:46,799 --> 00:01:50,000
a wild ride where like 2500 people about

44
00:01:50,000 --> 00:01:51,200
and

45
00:01:51,200 --> 00:01:55,119
publicly traded and um it's been

46
00:01:55,119 --> 00:01:55,920
fun

47
00:01:55,920 --> 00:01:57,280
lots of security incidents in the

48
00:01:57,280 --> 00:02:00,719
process and uh not fun times too

49
00:02:00,719 --> 00:02:01,840
uh

50
00:02:01,840 --> 00:02:03,840
i also was the first security engineer

51
00:02:03,840 --> 00:02:06,000
at a company called segment which got

52
00:02:06,000 --> 00:02:07,840
acquired by twilio before that i was at

53
00:02:07,840 --> 00:02:10,239
lastpass the password manager and then

54
00:02:10,239 --> 00:02:11,680
um

55
00:02:11,680 --> 00:02:14,640
uh before that i was at jmu jmu double

56
00:02:14,640 --> 00:02:16,239
duke goduks

57
00:02:16,239 --> 00:02:19,040
and i love startups and security

58
00:02:19,040 --> 00:02:22,000
if you're uh in the startup world uh

59
00:02:22,000 --> 00:02:23,440
feel free to ask me questions but i have

60
00:02:23,440 --> 00:02:27,120
two cats flew here from texas this week

61
00:02:27,120 --> 00:02:30,720
and a lot of tabs open this is my

62
00:02:30,720 --> 00:02:33,519
fourth caffeinated beverage so i'm

63
00:02:33,519 --> 00:02:35,280
on my way to six

64
00:02:35,280 --> 00:02:37,760
cloudflare if you're unfamiliar we are a

65
00:02:37,760 --> 00:02:40,160
large network we have millions of

66
00:02:40,160 --> 00:02:41,760
internet properties

67
00:02:41,760 --> 00:02:43,920
that we protect sitting behind our

68
00:02:43,920 --> 00:02:46,160
network we provide like

69
00:02:46,160 --> 00:02:50,000
waff solutions ddos mitigation

70
00:02:50,000 --> 00:02:52,560
load balancing content delivery image

71
00:02:52,560 --> 00:02:54,480
optimization our product

72
00:02:54,480 --> 00:02:56,800
list is really really long but

73
00:02:56,800 --> 00:02:58,720
lots of traffic lots of requests

74
00:02:58,720 --> 00:03:00,879
real-time communication

75
00:03:00,879 --> 00:03:02,000
we

76
00:03:02,000 --> 00:03:04,159
one metric that we report on publicly is

77
00:03:04,159 --> 00:03:06,879
number of cyber threats blocked each day

78
00:03:06,879 --> 00:03:08,959
uh for varying level levels of cyber

79
00:03:08,959 --> 00:03:11,840
threat everything from a waff event

80
00:03:11,840 --> 00:03:13,120
firing to

81
00:03:13,120 --> 00:03:15,440
like a packet blocked in a ddos attack

82
00:03:15,440 --> 00:03:17,840
or something

83
00:03:17,840 --> 00:03:20,959
and kind of our big

84
00:03:20,959 --> 00:03:23,040
thing about our network is we're all

85
00:03:23,040 --> 00:03:25,360
over the place we have 250 plus points

86
00:03:25,360 --> 00:03:28,400
of presence around the globe uh doing

87
00:03:28,400 --> 00:03:30,239
all of these features in each one of

88
00:03:30,239 --> 00:03:31,120
them

89
00:03:31,120 --> 00:03:32,480
each

90
00:03:32,480 --> 00:03:34,720
point of presence is we try to get it

91
00:03:34,720 --> 00:03:36,959
near population centers so like this is

92
00:03:36,959 --> 00:03:39,280
actually more of a population graph than

93
00:03:39,280 --> 00:03:41,920
than it is a cloudflare network map

94
00:03:41,920 --> 00:03:44,239
because we're within 50 milliseconds of

95
00:03:44,239 --> 00:03:46,400
like most of the planet so it's pretty

96
00:03:46,400 --> 00:03:48,480
cool really large network hardware all

97
00:03:48,480 --> 00:03:50,000
over the place

98
00:03:50,000 --> 00:03:50,959
and

99
00:03:50,959 --> 00:03:52,560
the basics of how

100
00:03:52,560 --> 00:03:56,080
the the product and how our architecture

101
00:03:56,080 --> 00:03:58,159
is and this is very important for like

102
00:03:58,159 --> 00:04:01,920
how we designed our zero truss stuff to

103
00:04:01,920 --> 00:04:04,640
solve for our own problems is

104
00:04:04,640 --> 00:04:06,560
we sit in the middle between websites

105
00:04:06,560 --> 00:04:09,360
and people using them so it it makes it

106
00:04:09,360 --> 00:04:11,280
really easy to block stuff makes it

107
00:04:11,280 --> 00:04:12,720
really easy to

108
00:04:12,720 --> 00:04:16,000
do whatever it we need to do so

109
00:04:16,000 --> 00:04:18,560
at its core all cloudflare is is a giant

110
00:04:18,560 --> 00:04:20,560
man in the middle that you actually want

111
00:04:20,560 --> 00:04:21,600
rather than

112
00:04:21,600 --> 00:04:24,560
one that you don't want

113
00:04:24,800 --> 00:04:27,919
okay so our strategy this is this is

114
00:04:27,919 --> 00:04:31,680
when we get into the zero trust so

115
00:04:31,680 --> 00:04:32,479
four

116
00:04:32,479 --> 00:04:34,320
years ago we're sitting there and we

117
00:04:34,320 --> 00:04:36,960
didn't like what we had for our identity

118
00:04:36,960 --> 00:04:39,199
and access management the traditional

119
00:04:39,199 --> 00:04:42,160
perimeter security model the vpn more on

120
00:04:42,160 --> 00:04:44,160
that later but

121
00:04:44,160 --> 00:04:45,600
our whole

122
00:04:45,600 --> 00:04:48,639
the whole way that we go about building

123
00:04:48,639 --> 00:04:50,639
security products and offering them is i

124
00:04:50,639 --> 00:04:52,400
think somewhat unique

125
00:04:52,400 --> 00:04:53,280
where

126
00:04:53,280 --> 00:04:55,600
we build a product for us and solve a

127
00:04:55,600 --> 00:04:58,400
real problem and we actually use it

128
00:04:58,400 --> 00:05:01,039
incorporate it into our security model

129
00:05:01,039 --> 00:05:02,000
kind of

130
00:05:02,000 --> 00:05:04,400
shave off the rough edges and work on it

131
00:05:04,400 --> 00:05:06,880
keep iterating and

132
00:05:06,880 --> 00:05:09,039
eventually someone will buy it from us

133
00:05:09,039 --> 00:05:12,479
so eventually people want to use it

134
00:05:12,479 --> 00:05:14,479
that strategy is called dog fooding

135
00:05:14,479 --> 00:05:17,120
hence the can of alpo we had a vp of

136
00:05:17,120 --> 00:05:18,560
engineering who

137
00:05:18,560 --> 00:05:21,520
uh literally had cans of alpo on his

138
00:05:21,520 --> 00:05:23,680
desk and would hand them out when people

139
00:05:23,680 --> 00:05:25,680
uh with dog food

140
00:05:25,680 --> 00:05:28,000
and so uh

141
00:05:28,000 --> 00:05:28,800
like

142
00:05:28,800 --> 00:05:30,400
i don't go a day without talking about

143
00:05:30,400 --> 00:05:32,639
dog fooding it's a it's a big deal to us

144
00:05:32,639 --> 00:05:34,479
the other big part of our strategy you

145
00:05:34,479 --> 00:05:36,560
can get an mba just reading this one

146
00:05:36,560 --> 00:05:37,759
book

147
00:05:37,759 --> 00:05:39,919
by clay christensen the innovator's

148
00:05:39,919 --> 00:05:42,720
dilemma that's the other big thing

149
00:05:42,720 --> 00:05:44,880
to call out

150
00:05:44,880 --> 00:05:46,560
every decision the company makes it's

151
00:05:46,560 --> 00:05:48,880
about like disrupting and moving into

152
00:05:48,880 --> 00:05:51,840
new spaces and constantly

153
00:05:51,840 --> 00:05:56,319
settling for what we were doing prior

154
00:05:56,319 --> 00:05:57,520
so

155
00:05:57,520 --> 00:05:59,440
dog fooding huge

156
00:05:59,440 --> 00:06:00,880
huge uh

157
00:06:00,880 --> 00:06:03,520
huge proponent of it i love it and also

158
00:06:03,520 --> 00:06:05,280
it gives me as a security person a lot

159
00:06:05,280 --> 00:06:07,840
of power because

160
00:06:07,840 --> 00:06:10,160
a security person at a security company

161
00:06:10,160 --> 00:06:12,240
where we're trying to solve

162
00:06:12,240 --> 00:06:13,520
our security problems with our own

163
00:06:13,520 --> 00:06:15,199
products i can go to any product manager

164
00:06:15,199 --> 00:06:18,319
and say hey this is what i need

165
00:06:18,319 --> 00:06:20,080
i get to set your roadmap for the next

166
00:06:20,080 --> 00:06:23,120
year this is great and uh so we're kind

167
00:06:23,120 --> 00:06:25,840
of in the middle of the product life

168
00:06:25,840 --> 00:06:27,759
cycle and we feel more

169
00:06:27,759 --> 00:06:28,720
like

170
00:06:28,720 --> 00:06:30,400
we feel less like a cost center and more

171
00:06:30,400 --> 00:06:32,800
like a value add to the business

172
00:06:32,800 --> 00:06:35,039
which is unique and it's a lot of fun

173
00:06:35,039 --> 00:06:37,520
it's empowering

174
00:06:37,520 --> 00:06:39,360
okay

175
00:06:39,360 --> 00:06:41,680
so we set the stage

176
00:06:41,680 --> 00:06:44,400
this is a stock photo that i had in my

177
00:06:44,400 --> 00:06:46,840
template of a woman who looked very

178
00:06:46,840 --> 00:06:49,919
confused and i think she's confused

179
00:06:49,919 --> 00:06:52,080
about what xero trust actually is at

180
00:06:52,080 --> 00:06:55,280
least that's what i imagined

181
00:06:55,919 --> 00:06:57,520
i thought about it for a while and i

182
00:06:57,520 --> 00:07:00,400
tried to boil it down into one sentence

183
00:07:00,400 --> 00:07:02,479
about what is zero trust and i think

184
00:07:02,479 --> 00:07:04,160
this is what i came up with

185
00:07:04,160 --> 00:07:06,160
feel free to raise your hand and tell me

186
00:07:06,160 --> 00:07:10,160
otherwise if you think differently but

187
00:07:10,160 --> 00:07:11,360
i think

188
00:07:11,360 --> 00:07:13,039
all zero trust is

189
00:07:13,039 --> 00:07:17,520
is you don't have an inherent trust of

190
00:07:17,520 --> 00:07:19,039
any other thing

191
00:07:19,039 --> 00:07:21,440
based on its network position or based

192
00:07:21,440 --> 00:07:23,280
on its ip address so just because it's

193
00:07:23,280 --> 00:07:24,720
on your lan doesn't mean you have to

194
00:07:24,720 --> 00:07:27,440
trust it and i think that's

195
00:07:27,440 --> 00:07:29,280
if i had to summarize in a sentence what

196
00:07:29,280 --> 00:07:31,120
it is

197
00:07:31,120 --> 00:07:32,240
um

198
00:07:32,240 --> 00:07:35,520
any other thoughts on that

199
00:07:35,520 --> 00:07:37,759
okay we're we're completely in agreement

200
00:07:37,759 --> 00:07:39,120
on that cool

201
00:07:39,120 --> 00:07:41,120
um

202
00:07:41,120 --> 00:07:41,919
cool

203
00:07:41,919 --> 00:07:44,160
you can you can think about it and let

204
00:07:44,160 --> 00:07:46,639
me know if you uh decide otherwise

205
00:07:46,639 --> 00:07:49,599
so i think the reason why we got there

206
00:07:49,599 --> 00:07:51,840
is because

207
00:07:51,840 --> 00:07:53,840
um

208
00:07:53,840 --> 00:07:55,680
it used to be that you had all of your

209
00:07:55,680 --> 00:07:58,400
stuff on one network and then i think

210
00:07:58,400 --> 00:08:00,400
the big thing that changed was such a

211
00:08:00,400 --> 00:08:02,960
huge reliance on cloud services

212
00:08:02,960 --> 00:08:05,840
that's a big one so your your stuff is

213
00:08:05,840 --> 00:08:07,599
not just your network anymore and

214
00:08:07,599 --> 00:08:09,280
suddenly there's all of these holes that

215
00:08:09,280 --> 00:08:11,919
you're poking in your firewalls and

216
00:08:11,919 --> 00:08:13,440
all of these trust relationships you

217
00:08:13,440 --> 00:08:14,879
have between

218
00:08:14,879 --> 00:08:17,520
aws or oracle cloud or whoever your

219
00:08:17,520 --> 00:08:20,479
cloud vendors are

220
00:08:21,280 --> 00:08:24,240
the advent of devops and containers i

221
00:08:24,240 --> 00:08:26,639
think is a big reason too because

222
00:08:26,639 --> 00:08:28,160
people stopped

223
00:08:28,160 --> 00:08:30,240
kind of hand making the their

224
00:08:30,240 --> 00:08:31,680
infrastructure

225
00:08:31,680 --> 00:08:33,599
it's a lot less common to see

226
00:08:33,599 --> 00:08:35,279
people building systems where they go

227
00:08:35,279 --> 00:08:38,080
run apt-get install apache and set it up

228
00:08:38,080 --> 00:08:40,000
by hand and then maintain it by hand

229
00:08:40,000 --> 00:08:42,000
they use configuration management tools

230
00:08:42,000 --> 00:08:42,640
and

231
00:08:42,640 --> 00:08:43,760
um

232
00:08:43,760 --> 00:08:44,560
and

233
00:08:44,560 --> 00:08:46,320
none of that

234
00:08:46,320 --> 00:08:49,680
is based but on ip so uh

235
00:08:49,680 --> 00:08:52,320
it's it's all like

236
00:08:52,320 --> 00:08:55,279
what's the word all of that is is done

237
00:08:55,279 --> 00:08:57,519
with like orchestration software to run

238
00:08:57,519 --> 00:09:00,399
your containers run your um run your

239
00:09:00,399 --> 00:09:03,680
jobs configuration manage your fleet

240
00:09:03,680 --> 00:09:06,000
uh one thing that i think is

241
00:09:06,000 --> 00:09:07,519
at least for us

242
00:09:07,519 --> 00:09:09,360
one of the forcing functions away from

243
00:09:09,360 --> 00:09:10,720
the traditional

244
00:09:10,720 --> 00:09:13,760
uh security vendors and tools was we

245
00:09:13,760 --> 00:09:15,760
wanted stronger second factor i'll get

246
00:09:15,760 --> 00:09:17,600
into this more but

247
00:09:17,600 --> 00:09:19,040
um

248
00:09:19,040 --> 00:09:21,600
we didn't like having to use authy and

249
00:09:21,600 --> 00:09:24,240
google authenticator as things that we

250
00:09:24,240 --> 00:09:26,080
relied on and it was really

251
00:09:26,080 --> 00:09:27,839
uncomfortable

252
00:09:27,839 --> 00:09:32,399
having to settle for totp or whatever

253
00:09:32,399 --> 00:09:35,040
second factor we had available to us in

254
00:09:35,040 --> 00:09:37,839
some of these older tools

255
00:09:37,839 --> 00:09:40,480
we wanted uh web off n and yubi keys and

256
00:09:40,480 --> 00:09:42,640
security keys and i'll talk about that

257
00:09:42,640 --> 00:09:44,160
more in in

258
00:09:44,160 --> 00:09:46,240
a bit about how we

259
00:09:46,240 --> 00:09:47,920
kind of made that jump and then

260
00:09:47,920 --> 00:09:50,480
web-based everything the world is on

261
00:09:50,480 --> 00:09:52,560
http 2 and

262
00:09:52,560 --> 00:09:54,480
http now

263
00:09:54,480 --> 00:09:57,200
everything is a web service

264
00:09:57,200 --> 00:09:58,000
it's

265
00:09:58,000 --> 00:10:01,279
less about running ftp you have dropbox

266
00:10:01,279 --> 00:10:04,439
and drive

267
00:10:05,200 --> 00:10:08,240
cattle not pets yeah so uh this is the

268
00:10:08,240 --> 00:10:11,680
idea in devops where you you're not hand

269
00:10:11,680 --> 00:10:14,160
making your machine apt-get install

270
00:10:14,160 --> 00:10:15,680
apache and

271
00:10:15,680 --> 00:10:18,000
let me migrate or let me rotate the logs

272
00:10:18,000 --> 00:10:20,959
by hand that's a pet because you're

273
00:10:20,959 --> 00:10:22,240
you're

274
00:10:22,240 --> 00:10:24,560
loving that server and like taking care

275
00:10:24,560 --> 00:10:27,440
of just that one server but uh cattle

276
00:10:27,440 --> 00:10:30,720
you're treating your fleet of of uh

277
00:10:30,720 --> 00:10:34,480
machines as as a thing and you solve

278
00:10:34,480 --> 00:10:36,000
problems for all of the machines rather

279
00:10:36,000 --> 00:10:38,640
than one at a time

280
00:10:38,640 --> 00:10:39,920
yeah that's a

281
00:10:39,920 --> 00:10:43,279
that's a good saying

282
00:10:44,720 --> 00:10:46,160
if i have other things like that feel

283
00:10:46,160 --> 00:10:47,760
free to raise your hand jump in and ask

284
00:10:47,760 --> 00:10:50,000
questions okay

285
00:10:50,000 --> 00:10:50,800
so

286
00:10:50,800 --> 00:10:52,560
about four

287
00:10:52,560 --> 00:10:55,200
uh maybe 2016. what year is it uh five

288
00:10:55,200 --> 00:10:56,399
years ago

289
00:10:56,399 --> 00:10:58,720
beyond the beyond court papers came out

290
00:10:58,720 --> 00:11:00,440
from google

291
00:11:00,440 --> 00:11:03,279
cloud.google.com beyondcorp anyone who's

292
00:11:03,279 --> 00:11:05,279
seriously considering working on any

293
00:11:05,279 --> 00:11:07,279
xero trust products anyone who's

294
00:11:07,279 --> 00:11:09,519
seriously considering a vendor to

295
00:11:09,519 --> 00:11:10,959
purchase

296
00:11:10,959 --> 00:11:13,200
zero trustee stuff whatever you're doing

297
00:11:13,200 --> 00:11:14,959
with zero trust go read these papers it

298
00:11:14,959 --> 00:11:17,360
takes about two hours there's six papers

299
00:11:17,360 --> 00:11:20,079
each one is about three pages and it

300
00:11:20,079 --> 00:11:21,440
kind of gives you everything you need to

301
00:11:21,440 --> 00:11:23,040
know about

302
00:11:23,040 --> 00:11:26,320
xero trust before it's called zero trust

303
00:11:26,320 --> 00:11:29,279
google really built this whole thing and

304
00:11:29,279 --> 00:11:31,040
like everything google they're always 10

305
00:11:31,040 --> 00:11:33,360
years ahead of the rest of the industry

306
00:11:33,360 --> 00:11:34,959
because they just have so much money to

307
00:11:34,959 --> 00:11:37,519
throw out problems and so they were very

308
00:11:37,519 --> 00:11:39,200
far ahead and described this really

309
00:11:39,200 --> 00:11:40,160
great

310
00:11:40,160 --> 00:11:42,399
kind of situation where they

311
00:11:42,399 --> 00:11:44,959
dissolved their network boundary

312
00:11:44,959 --> 00:11:48,480
and um they used to brag here's our

313
00:11:48,480 --> 00:11:50,240
internal google page and they like

314
00:11:50,240 --> 00:11:52,560
posted a url that you could just go to

315
00:11:52,560 --> 00:11:54,480
and be like oh this is like google corp

316
00:11:54,480 --> 00:11:58,880
i could just log in if i had a password

317
00:11:58,880 --> 00:12:01,120
and

318
00:12:01,519 --> 00:12:03,120
that was that was a big deal a lot of

319
00:12:03,120 --> 00:12:04,880
people wanted to mimic that

320
00:12:04,880 --> 00:12:06,560
and

321
00:12:06,560 --> 00:12:09,760
it kind of set the whole industry

322
00:12:09,760 --> 00:12:10,880
towards

323
00:12:10,880 --> 00:12:13,440
towards this direction

324
00:12:13,440 --> 00:12:14,720
you couldn't just buy it though you

325
00:12:14,720 --> 00:12:16,399
couldn't just buy the beyondcorp product

326
00:12:16,399 --> 00:12:18,720
they didn't offer it at the time and now

327
00:12:18,720 --> 00:12:20,160
you can kind of buy some of it from

328
00:12:20,160 --> 00:12:21,600
google like you can buy an identity

329
00:12:21,600 --> 00:12:23,680
aware proxy but you can't buy the whole

330
00:12:23,680 --> 00:12:25,040
thing

331
00:12:25,040 --> 00:12:26,480
so

332
00:12:26,480 --> 00:12:28,079
um there we are

333
00:12:28,079 --> 00:12:30,160
sitting on the left we had the uh the

334
00:12:30,160 --> 00:12:32,399
security model from the left hand side

335
00:12:32,399 --> 00:12:35,680
where perimeter security model walls

336
00:12:35,680 --> 00:12:37,680
uh

337
00:12:37,680 --> 00:12:39,440
uh mostly

338
00:12:39,440 --> 00:12:41,519
mostly security at the perimeter and we

339
00:12:41,519 --> 00:12:44,079
wanted security throughout at every

340
00:12:44,079 --> 00:12:45,519
stage

341
00:12:45,519 --> 00:12:47,440
and the very first way that we started

342
00:12:47,440 --> 00:12:49,680
to work on this and started to address

343
00:12:49,680 --> 00:12:50,399
this

344
00:12:50,399 --> 00:12:54,000
is we wanted to solve for http

345
00:12:54,000 --> 00:12:56,079
so

346
00:12:56,079 --> 00:12:58,639
the this is solving for the web

347
00:12:58,639 --> 00:13:00,639
scenario so you go to a website that we

348
00:13:00,639 --> 00:13:03,680
had internally and the previous state is

349
00:13:03,680 --> 00:13:06,399
you had to go log into the vpn

350
00:13:06,399 --> 00:13:08,800
you had so let's say our internal jira

351
00:13:08,800 --> 00:13:11,519
or internal task tracker you had to log

352
00:13:11,519 --> 00:13:12,959
into the vpn

353
00:13:12,959 --> 00:13:15,680
like do the second factor thing and then

354
00:13:15,680 --> 00:13:17,600
wait for the whole like

355
00:13:17,600 --> 00:13:20,560
negotiation of your new network and

356
00:13:20,560 --> 00:13:22,639
maybe sometimes it wouldn't work

357
00:13:22,639 --> 00:13:25,440
and then you could go to jira and then

358
00:13:25,440 --> 00:13:27,200
maybe an hour later you'd get signed out

359
00:13:27,200 --> 00:13:29,680
of the vpn something wrong would happen

360
00:13:29,680 --> 00:13:32,000
and so we wanted to to first solve for

361
00:13:32,000 --> 00:13:32,839
that

362
00:13:32,839 --> 00:13:36,480
problem and the very first thing that we

363
00:13:36,480 --> 00:13:37,680
did

364
00:13:37,680 --> 00:13:39,040
was we re

365
00:13:39,040 --> 00:13:42,320
we wrote this piece of software which is

366
00:13:42,320 --> 00:13:44,240
actually so old that it's archived now

367
00:13:44,240 --> 00:13:46,480
on github but you can go see it and find

368
00:13:46,480 --> 00:13:48,800
it and this was the original identity

369
00:13:48,800 --> 00:13:50,880
aware proxy that we built there's a lot

370
00:13:50,880 --> 00:13:53,279
of other prior art in identity aware

371
00:13:53,279 --> 00:13:55,680
proxies you can go look at the bitly

372
00:13:55,680 --> 00:13:58,480
oauth proxy which is a big open source

373
00:13:58,480 --> 00:13:59,440
project

374
00:13:59,440 --> 00:14:01,839
google has an identity aware proxy built

375
00:14:01,839 --> 00:14:04,560
into google cloud there's a few others

376
00:14:04,560 --> 00:14:06,000
but

377
00:14:06,000 --> 00:14:09,120
um this was a game changer internally at

378
00:14:09,120 --> 00:14:12,000
our company because

379
00:14:12,000 --> 00:14:15,279
well the previous state we had people we

380
00:14:15,279 --> 00:14:18,399
run a 24 7 365 business and so people

381
00:14:18,399 --> 00:14:19,760
would get woken up in the middle of the

382
00:14:19,760 --> 00:14:21,519
night and

383
00:14:21,519 --> 00:14:22,240
they

384
00:14:22,240 --> 00:14:24,480
couldn't just see what's broken on their

385
00:14:24,480 --> 00:14:26,320
phone they'd get paged that something's

386
00:14:26,320 --> 00:14:27,279
broken

387
00:14:27,279 --> 00:14:29,360
they would have to like sleep next to

388
00:14:29,360 --> 00:14:31,839
their laptop and then open their laptop

389
00:14:31,839 --> 00:14:33,440
and log into the vpn go through that

390
00:14:33,440 --> 00:14:36,480
whole process i just described

391
00:14:36,480 --> 00:14:39,600
um so it's really we put maybe just the

392
00:14:39,600 --> 00:14:42,160
metrics server our internal task tracker

393
00:14:42,160 --> 00:14:44,480
we put a few basic things

394
00:14:44,480 --> 00:14:45,839
behind

395
00:14:45,839 --> 00:14:46,959
the

396
00:14:46,959 --> 00:14:48,880
identity aware proxy just to try it out

397
00:14:48,880 --> 00:14:51,360
with unsensitive things

398
00:14:51,360 --> 00:14:52,959
because we didn't want to put everything

399
00:14:52,959 --> 00:14:55,040
behind it too quickly and have a problem

400
00:14:55,040 --> 00:14:57,120
a security problem that we didn't expect

401
00:14:57,120 --> 00:14:58,399
so we kind of

402
00:14:58,399 --> 00:15:00,320
went slow and started with just a few

403
00:15:00,320 --> 00:15:02,480
things to make people's lives easier

404
00:15:02,480 --> 00:15:06,399
and it was a real game changer the

405
00:15:06,399 --> 00:15:08,800
the product manager for

406
00:15:08,800 --> 00:15:11,680
the xero trust stuff

407
00:15:11,680 --> 00:15:13,839
likes to tell the story about how they

408
00:15:13,839 --> 00:15:16,240
paved roads in texas how

409
00:15:16,240 --> 00:15:19,519
i'm from texas now i guess but

410
00:15:19,519 --> 00:15:21,440
i didn't know the story he said that all

411
00:15:21,440 --> 00:15:22,880
the roads were unpaved and there's so

412
00:15:22,880 --> 00:15:25,040
much land in texas

413
00:15:25,040 --> 00:15:26,720
that

414
00:15:26,720 --> 00:15:28,399
they used to just pave a mile in the

415
00:15:28,399 --> 00:15:30,320
center of the town and then everybody

416
00:15:30,320 --> 00:15:33,120
would be driving their f-150s and then

417
00:15:33,120 --> 00:15:36,240
hit the paved road and be like that was

418
00:15:36,240 --> 00:15:38,639
awesome i want that everywhere and then

419
00:15:38,639 --> 00:15:40,720
the next election when it was budget

420
00:15:40,720 --> 00:15:43,600
time everybody wanted to pave roads and

421
00:15:43,600 --> 00:15:45,519
it was really easy to get buy-in so we

422
00:15:45,519 --> 00:15:47,759
did the exact same strategy

423
00:15:47,759 --> 00:15:48,800
as

424
00:15:48,800 --> 00:15:51,360
as the texas paved roads problem

425
00:15:51,360 --> 00:15:54,000
and we paved just a few roads the

426
00:15:54,000 --> 00:15:56,160
metrics the internal task tracker and it

427
00:15:56,160 --> 00:15:57,680
made everybody's lives easier and

428
00:15:57,680 --> 00:15:58,959
everybody could immediately see the

429
00:15:58,959 --> 00:16:03,040
value of what we were trying to do

430
00:16:03,680 --> 00:16:04,959
and

431
00:16:04,959 --> 00:16:07,480
so that is you can go see this

432
00:16:07,480 --> 00:16:11,040
github.com cloudflare slash nginx google

433
00:16:11,040 --> 00:16:12,000
oauth

434
00:16:12,000 --> 00:16:14,079
and architecturally this is kind of how

435
00:16:14,079 --> 00:16:15,680
it worked

436
00:16:15,680 --> 00:16:17,360
so user

437
00:16:17,360 --> 00:16:19,360
one of our operations or sre team

438
00:16:19,360 --> 00:16:20,480
members

439
00:16:20,480 --> 00:16:23,279
there on the left with their laptop just

440
00:16:23,279 --> 00:16:25,199
woken up at two in the morning

441
00:16:25,199 --> 00:16:27,199
because something's down

442
00:16:27,199 --> 00:16:30,399
they log into on the far right

443
00:16:30,399 --> 00:16:33,360
jira or our metrics dashboards to see

444
00:16:33,360 --> 00:16:34,959
what's broken

445
00:16:34,959 --> 00:16:37,759
that passes through our network and when

446
00:16:37,759 --> 00:16:39,519
our network sees

447
00:16:39,519 --> 00:16:40,560
the

448
00:16:40,560 --> 00:16:42,000
request

449
00:16:42,000 --> 00:16:44,720
going to that particular url they say

450
00:16:44,720 --> 00:16:46,560
hey this person needs to log in with our

451
00:16:46,560 --> 00:16:48,720
identity provider and they do a quick

452
00:16:48,720 --> 00:16:51,040
oauth handshake up to the identity

453
00:16:51,040 --> 00:16:53,839
provider comes back down when

454
00:16:53,839 --> 00:16:55,759
we see that they've logged in

455
00:16:55,759 --> 00:16:57,680
we sign a little cookie

456
00:16:57,680 --> 00:16:59,199
and then

457
00:16:59,199 --> 00:17:01,600
set it as a cookie in their browser

458
00:17:01,600 --> 00:17:03,360
and then each time they make a request

459
00:17:03,360 --> 00:17:05,839
we validate the cookie

460
00:17:05,839 --> 00:17:08,640
in the center so this is

461
00:17:08,640 --> 00:17:09,439
how

462
00:17:09,439 --> 00:17:11,839
identity aware proxies work

463
00:17:11,839 --> 00:17:13,280
basically all of them have the same

464
00:17:13,280 --> 00:17:14,880
architecture

465
00:17:14,880 --> 00:17:16,559
there's not a lot of

466
00:17:16,559 --> 00:17:18,959
distinguishing factors between them

467
00:17:18,959 --> 00:17:21,599
uh but they all pretty much usually so

468
00:17:21,599 --> 00:17:23,760
support a bunch of different identity

469
00:17:23,760 --> 00:17:26,880
providers over oauth 2 or

470
00:17:26,880 --> 00:17:29,280
over saml there's a variety of different

471
00:17:29,280 --> 00:17:31,120
integrations between

472
00:17:31,120 --> 00:17:32,400
all of the identity

473
00:17:32,400 --> 00:17:35,600
aware proxies and identity providers but

474
00:17:35,600 --> 00:17:38,640
usually it's oauth

475
00:17:38,640 --> 00:17:39,600
and then

476
00:17:39,600 --> 00:17:41,440
actually configuring that this might be

477
00:17:41,440 --> 00:17:42,960
hard for you to read

478
00:17:42,960 --> 00:17:44,320
can i

479
00:17:44,320 --> 00:17:47,039
let me try to point so this is a fake

480
00:17:47,039 --> 00:17:48,320
internal

481
00:17:48,320 --> 00:17:51,120
site so this says pace.example.com

482
00:17:51,120 --> 00:17:52,799
so let's say we had an internal paste

483
00:17:52,799 --> 00:17:54,960
bin something to just

484
00:17:54,960 --> 00:17:57,600
host documents or host text somewhere to

485
00:17:57,600 --> 00:17:59,679
share stuff

486
00:17:59,679 --> 00:18:02,480
but the root of it says okay have a

487
00:18:02,480 --> 00:18:05,039
session duration for 24 hours

488
00:18:05,039 --> 00:18:06,960
oh this is grayed out really hard to see

489
00:18:06,960 --> 00:18:09,760
but it says the policy name is

490
00:18:09,760 --> 00:18:10,720
paste

491
00:18:10,720 --> 00:18:12,400
and

492
00:18:12,400 --> 00:18:13,760
it says

493
00:18:13,760 --> 00:18:14,880
deny

494
00:18:14,880 --> 00:18:16,720
everyone so everybody is blocked from

495
00:18:16,720 --> 00:18:17,600
paste

496
00:18:17,600 --> 00:18:20,880
uh pretty simple you can also say

497
00:18:20,880 --> 00:18:23,120
everybody in this group that is in the

498
00:18:23,120 --> 00:18:24,559
identity provider

499
00:18:24,559 --> 00:18:28,080
gets access everybody in

500
00:18:28,080 --> 00:18:30,160
a high-risk country

501
00:18:30,160 --> 00:18:32,320
is blocked you can be pretty expressive

502
00:18:32,320 --> 00:18:34,880
with with policies you can say only

503
00:18:34,880 --> 00:18:37,200
these ips are allowed if there are some

504
00:18:37,200 --> 00:18:38,480
ip

505
00:18:38,480 --> 00:18:42,960
shenanigans you still want to do um but

506
00:18:42,960 --> 00:18:44,880
basically we have one of these for every

507
00:18:44,880 --> 00:18:46,320
internal website which you see in the

508
00:18:46,320 --> 00:18:50,640
bottom right which is 510 items for just

509
00:18:50,640 --> 00:18:51,919
this one

510
00:18:51,919 --> 00:18:52,720
uh

511
00:18:52,720 --> 00:18:53,919
just this one account we have more

512
00:18:53,919 --> 00:18:55,440
accounts but this is the main account

513
00:18:55,440 --> 00:18:58,000
where you'd see a lot of these policies

514
00:18:58,000 --> 00:19:00,160
so

515
00:19:00,320 --> 00:19:02,080
that's what it looks like in practice as

516
00:19:02,080 --> 00:19:06,000
somebody going in and setting this up

517
00:19:07,440 --> 00:19:10,720
so that's kind of how it works for http

518
00:19:10,720 --> 00:19:13,120
overview of the architecture you can

519
00:19:13,120 --> 00:19:14,480
figure it here

520
00:19:14,480 --> 00:19:15,280
and

521
00:19:15,280 --> 00:19:18,240
it kind of all started with about 250

522
00:19:18,240 --> 00:19:22,240
lines of lua of all things

523
00:19:22,840 --> 00:19:25,760
so uh

524
00:19:25,760 --> 00:19:26,720
okay

525
00:19:26,720 --> 00:19:29,360
a big portion of

526
00:19:29,360 --> 00:19:30,480
securing

527
00:19:30,480 --> 00:19:33,200
anything these days is second factor if

528
00:19:33,200 --> 00:19:35,200
you're not investing in second factor

529
00:19:35,200 --> 00:19:37,280
you don't have it that should probably

530
00:19:37,280 --> 00:19:39,200
be your biggest priority as a security

531
00:19:39,200 --> 00:19:40,880
person at your business

532
00:19:40,880 --> 00:19:42,080
um

533
00:19:42,080 --> 00:19:44,960
we wanted really strong second factor we

534
00:19:44,960 --> 00:19:47,120
get really targeted phishing attacks all

535
00:19:47,120 --> 00:19:48,160
the time

536
00:19:48,160 --> 00:19:52,000
based on what we do and our sensitivity

537
00:19:52,000 --> 00:19:52,720
so

538
00:19:52,720 --> 00:19:54,400
we basically made the decision as a

539
00:19:54,400 --> 00:19:55,679
company that

540
00:19:55,679 --> 00:19:57,600
totp

541
00:19:57,600 --> 00:20:00,320
whatever vendor all of these second

542
00:20:00,320 --> 00:20:02,240
factors aren't good enough we have to

543
00:20:02,240 --> 00:20:04,159
settle we can't settle for anything less

544
00:20:04,159 --> 00:20:06,640
than a security key and a unfishable

545
00:20:06,640 --> 00:20:08,880
because they're unfishable and

546
00:20:08,880 --> 00:20:10,400
even if you make a mistake even if

547
00:20:10,400 --> 00:20:12,799
you're bleary-eyed just getting off of a

548
00:20:12,799 --> 00:20:14,799
flight you still can't get phished

549
00:20:14,799 --> 00:20:16,480
because the technology just doesn't

550
00:20:16,480 --> 00:20:19,039
allow you to

551
00:20:19,039 --> 00:20:22,400
so we really wanted these and we wanted

552
00:20:22,400 --> 00:20:24,960
to them to enable

553
00:20:24,960 --> 00:20:27,840
that we wanted the zero trust stuff that

554
00:20:27,840 --> 00:20:30,960
we were building to actually enable that

555
00:20:30,960 --> 00:20:33,039
also i would say that if you aren't

556
00:20:33,039 --> 00:20:34,720
super familiar with ub keys or you

557
00:20:34,720 --> 00:20:37,039
looked at them a long time ago

558
00:20:37,039 --> 00:20:39,200
uh i think you should like re-look at

559
00:20:39,200 --> 00:20:41,440
them if you haven't in a long time

560
00:20:41,440 --> 00:20:43,440
there's been a lot of improvements over

561
00:20:43,440 --> 00:20:46,000
the past year or two in just the support

562
00:20:46,000 --> 00:20:48,799
for security keys and uh ub keys out

563
00:20:48,799 --> 00:20:51,679
there ios and safari supported as of

564
00:20:51,679 --> 00:20:53,440
last december

565
00:20:53,440 --> 00:20:57,039
um it's supported natively in ssh now so

566
00:20:57,039 --> 00:20:59,679
you can when you generate an ssh key

567
00:20:59,679 --> 00:21:02,080
when you do dash t for the type of key

568
00:21:02,080 --> 00:21:03,480
you can do

569
00:21:03,480 --> 00:21:06,400
ecdsa-sk which means security key one of

570
00:21:06,400 --> 00:21:08,000
these things and that's really nice

571
00:21:08,000 --> 00:21:10,480
because then you can do two-factor auth

572
00:21:10,480 --> 00:21:14,240
directly in ssh which is cool there's

573
00:21:14,240 --> 00:21:15,679
the support for these is getting really

574
00:21:15,679 --> 00:21:18,159
really good and also

575
00:21:18,159 --> 00:21:20,640
face id is a security key all of these

576
00:21:20,640 --> 00:21:22,960
um like biometric things that are

577
00:21:22,960 --> 00:21:25,600
getting built into devices they're

578
00:21:25,600 --> 00:21:27,760
adding support for the same web offend

579
00:21:27,760 --> 00:21:31,600
protocol that's under the hood here so

580
00:21:31,600 --> 00:21:34,480
if there's one takeaway from this talk

581
00:21:34,480 --> 00:21:35,840
take a look at security keys and if

582
00:21:35,840 --> 00:21:37,919
you're not doing 2fa please dude please

583
00:21:37,919 --> 00:21:40,480
work on that

584
00:21:41,520 --> 00:21:44,000
okay so how can we actually enforce

585
00:21:44,000 --> 00:21:46,880
security keys and start to move away

586
00:21:46,880 --> 00:21:48,960
uh from what we had before actually

587
00:21:48,960 --> 00:21:50,159
before

588
00:21:50,159 --> 00:21:52,080
let me just cover this too

589
00:21:52,080 --> 00:21:53,120
before

590
00:21:53,120 --> 00:21:55,360
one of the big challenges with enabling

591
00:21:55,360 --> 00:21:57,600
security keys was that we were limited

592
00:21:57,600 --> 00:22:01,200
by whatever the vpn provider

593
00:22:01,200 --> 00:22:03,200
supported so

594
00:22:03,200 --> 00:22:06,559
you're stuck with whatever 2fa they give

595
00:22:06,559 --> 00:22:09,520
you integrations for and

596
00:22:09,520 --> 00:22:13,600
it just wasn't open enough for us and we

597
00:22:13,600 --> 00:22:15,360
really

598
00:22:15,360 --> 00:22:17,360
it was a big hassle to do anything with

599
00:22:17,360 --> 00:22:18,559
the vpn

600
00:22:18,559 --> 00:22:20,799
managing groups managing anything so

601
00:22:20,799 --> 00:22:23,120
adding more support for second factors

602
00:22:23,120 --> 00:22:24,159
was

603
00:22:24,159 --> 00:22:25,520
a big hassle

604
00:22:25,520 --> 00:22:28,480
so we just decided let's get rid of it

605
00:22:28,480 --> 00:22:31,120
and then in practice this is what i

606
00:22:31,120 --> 00:22:32,559
showed you before

607
00:22:32,559 --> 00:22:34,400
the architecture

608
00:22:34,400 --> 00:22:36,720
where we support

609
00:22:36,720 --> 00:22:39,360
security keys and where we enforce it is

610
00:22:39,360 --> 00:22:41,440
we make sure everybody in the identity

611
00:22:41,440 --> 00:22:44,240
provider sets up a security key

612
00:22:44,240 --> 00:22:46,559
and that's step one

613
00:22:46,559 --> 00:22:47,760
but

614
00:22:47,760 --> 00:22:50,240
we didn't have when we first started

615
00:22:50,240 --> 00:22:51,919
introducing security keys you're in this

616
00:22:51,919 --> 00:22:53,200
kind of

617
00:22:53,200 --> 00:22:54,799
chicken and egg problem where everybody

618
00:22:54,799 --> 00:22:56,720
has a two-factor authentication thing

619
00:22:56,720 --> 00:22:57,840
already

620
00:22:57,840 --> 00:22:59,520
and then they have a security key and

621
00:22:59,520 --> 00:23:01,440
you can't like if you have a big

622
00:23:01,440 --> 00:23:03,840
workforce you can't just one day say hey

623
00:23:03,840 --> 00:23:06,080
the old way you used to log in

624
00:23:06,080 --> 00:23:08,080
doesn't work and you have to use this

625
00:23:08,080 --> 00:23:09,200
new way

626
00:23:09,200 --> 00:23:11,039
that does not work

627
00:23:11,039 --> 00:23:13,679
so what we did was we had this kind of

628
00:23:13,679 --> 00:23:14,720
tandem

629
00:23:14,720 --> 00:23:16,400
solution where they were living side by

630
00:23:16,400 --> 00:23:19,440
side we sent we literally sent envelopes

631
00:23:19,440 --> 00:23:21,440
we went to the office and we pack these

632
00:23:21,440 --> 00:23:23,200
envelopes with everybody i don't know

633
00:23:23,200 --> 00:23:25,120
why we did this ourselves but we packed

634
00:23:25,120 --> 00:23:28,240
envelopes of of these yubi keys that you

635
00:23:28,240 --> 00:23:30,799
just saw in every single person's

636
00:23:30,799 --> 00:23:33,280
envelope and we mailed it to them

637
00:23:33,280 --> 00:23:36,400
we gave every employee two of them and i

638
00:23:36,400 --> 00:23:37,280
have

639
00:23:37,280 --> 00:23:39,760
one in my laptop right here i can show

640
00:23:39,760 --> 00:23:40,880
you

641
00:23:40,880 --> 00:23:42,480
it just lives like right here and i can

642
00:23:42,480 --> 00:23:45,360
touch it to log in and then

643
00:23:45,360 --> 00:23:47,360
there's another one on my keychain which

644
00:23:47,360 --> 00:23:49,360
is the bigger one that you just saw that

645
00:23:49,360 --> 00:23:53,440
works over nfc so we gave everybody two

646
00:23:53,440 --> 00:23:54,799
security keys

647
00:23:54,799 --> 00:23:57,200
and then they set them up

648
00:23:57,200 --> 00:23:59,520
and then it was like okay well how is

649
00:23:59,520 --> 00:24:00,880
this going to work where they live side

650
00:24:00,880 --> 00:24:02,400
by side

651
00:24:02,400 --> 00:24:04,240
and that's kind of we built a product

652
00:24:04,240 --> 00:24:06,400
for that so we have this identity aware

653
00:24:06,400 --> 00:24:07,520
proxy

654
00:24:07,520 --> 00:24:09,919
and when you log into the identity

655
00:24:09,919 --> 00:24:13,039
provider it provides like a big blob of

656
00:24:13,039 --> 00:24:16,400
stuff back to our identity or proxy it

657
00:24:16,400 --> 00:24:19,039
looks kind of like this actually it

658
00:24:19,039 --> 00:24:20,799
looks exactly like this except with real

659
00:24:20,799 --> 00:24:24,000
data um these are all z's and sensitive

660
00:24:24,000 --> 00:24:26,640
stuff that i redacted but uh the

661
00:24:26,640 --> 00:24:28,480
important thing is

662
00:24:28,480 --> 00:24:30,640
your identity provider probably would

663
00:24:30,640 --> 00:24:33,039
tell your

664
00:24:33,039 --> 00:24:35,440
your proxy what type of

665
00:24:35,440 --> 00:24:37,520
second factor was logged in with so you

666
00:24:37,520 --> 00:24:40,960
can see here amr means authentication

667
00:24:40,960 --> 00:24:42,799
method

668
00:24:42,799 --> 00:24:45,200
r something

669
00:24:45,200 --> 00:24:47,440
authentication method

670
00:24:47,440 --> 00:24:49,919
and then uh it tells you the the

671
00:24:49,919 --> 00:24:52,080
properties of that authentication method

672
00:24:52,080 --> 00:24:56,960
so swk is software key and uh mfa means

673
00:24:56,960 --> 00:24:59,440
multi-factor authentication and so what

674
00:24:59,440 --> 00:25:02,720
we did was we added support for saying

675
00:25:02,720 --> 00:25:05,120
that some of our applications like that

676
00:25:05,120 --> 00:25:07,679
paste thing i just showed you

677
00:25:07,679 --> 00:25:10,880
only uh were accessible if you use the

678
00:25:10,880 --> 00:25:13,840
security key so when you go to login we

679
00:25:13,840 --> 00:25:16,240
messaged out instead of saying

680
00:25:16,240 --> 00:25:17,279
hey

681
00:25:17,279 --> 00:25:19,760
multi thousand person workforce you log

682
00:25:19,760 --> 00:25:22,000
in only with security keys now we said

683
00:25:22,000 --> 00:25:22,960
hey

684
00:25:22,960 --> 00:25:24,720
when you log into just this one

685
00:25:24,720 --> 00:25:26,080
application

686
00:25:26,080 --> 00:25:28,320
you have to use security keys we we

687
00:25:28,320 --> 00:25:30,159
basically made a list of five or so

688
00:25:30,159 --> 00:25:31,840
really high sensitive applications and

689
00:25:31,840 --> 00:25:34,720
that's the way we introduced it um so we

690
00:25:34,720 --> 00:25:36,640
said if you log into this internal

691
00:25:36,640 --> 00:25:38,240
dashboard if you log into this really

692
00:25:38,240 --> 00:25:41,039
sensitive thing or this other thing

693
00:25:41,039 --> 00:25:42,960
you will not be able to reach it if you

694
00:25:42,960 --> 00:25:44,400
don't touch your security key when

695
00:25:44,400 --> 00:25:46,960
logging in

696
00:25:47,120 --> 00:25:50,240
and that worked really well because when

697
00:25:50,240 --> 00:25:51,919
you're introducing a new technology to

698
00:25:51,919 --> 00:25:54,159
your users they might not be familiar

699
00:25:54,159 --> 00:25:56,640
with it it took them time to set it up

700
00:25:56,640 --> 00:25:57,520
like

701
00:25:57,520 --> 00:25:59,039
they all arrived in the mail at

702
00:25:59,039 --> 00:26:01,039
different times and then people like put

703
00:26:01,039 --> 00:26:02,480
it on their counter and forgot about it

704
00:26:02,480 --> 00:26:04,640
for probably a month and they really

705
00:26:04,640 --> 00:26:06,960
needed a reason to start using it but

706
00:26:06,960 --> 00:26:08,240
they also

707
00:26:08,240 --> 00:26:11,120
needed some time to adjust to it

708
00:26:11,120 --> 00:26:13,360
so that was a good balancing act where

709
00:26:13,360 --> 00:26:15,279
we could kind of explain

710
00:26:15,279 --> 00:26:16,880
the sensitivity

711
00:26:16,880 --> 00:26:20,080
of these specific apps and also

712
00:26:20,080 --> 00:26:22,240
start to enforce the security keys but

713
00:26:22,240 --> 00:26:23,520
that's what it looks like this is a real

714
00:26:23,520 --> 00:26:24,480
assertion

715
00:26:24,480 --> 00:26:26,880
from the identity provider that i

716
00:26:26,880 --> 00:26:29,039
copied and pasted and redacted some of

717
00:26:29,039 --> 00:26:30,720
the stuff

718
00:26:30,720 --> 00:26:32,640
and then the actual enforcement

719
00:26:32,640 --> 00:26:34,960
uh any terraform users out here i met

720
00:26:34,960 --> 00:26:38,640
somebody yesterday okay some uh this is

721
00:26:38,640 --> 00:26:40,640
all terraform code this is the cattle

722
00:26:40,640 --> 00:26:43,360
not pets mentality of configuring your

723
00:26:43,360 --> 00:26:46,640
cloud servers services in uh in code

724
00:26:46,640 --> 00:26:48,640
what is it infrastructure as code

725
00:26:48,640 --> 00:26:52,080
um and this is all just a bunch of junk

726
00:26:52,080 --> 00:26:53,679
explaining how to set up one of those

727
00:26:53,679 --> 00:26:56,000
policies i was showing you earlier but

728
00:26:56,000 --> 00:26:58,799
the important part is down here it says

729
00:26:58,799 --> 00:27:02,159
require swk and that's how we actually

730
00:27:02,159 --> 00:27:04,159
required that uh

731
00:27:04,159 --> 00:27:06,799
you used your security key

732
00:27:06,799 --> 00:27:08,640
so it's um

733
00:27:08,640 --> 00:27:10,559
pretty simple when i go through it like

734
00:27:10,559 --> 00:27:12,480
that but a lot of a lot of programming

735
00:27:12,480 --> 00:27:14,559
and a lot of attention to detail to

736
00:27:14,559 --> 00:27:16,559
build that

737
00:27:16,559 --> 00:27:19,440
this is what our actual migration of web

738
00:27:19,440 --> 00:27:21,279
authent two web authent looked like

739
00:27:21,279 --> 00:27:24,799
these are real metrics and you can see

740
00:27:24,799 --> 00:27:26,159
um

741
00:27:26,159 --> 00:27:28,559
i wish i could make this like

742
00:27:28,559 --> 00:27:30,799
i guess it'd have to be a mile long but

743
00:27:30,799 --> 00:27:32,480
i could i wish i could show you like

744
00:27:32,480 --> 00:27:36,240
when we first introduced security keys

745
00:27:36,240 --> 00:27:37,679
excuse me

746
00:27:37,679 --> 00:27:40,240
when we first introduced security keys

747
00:27:40,240 --> 00:27:41,200
uh

748
00:27:41,200 --> 00:27:43,279
it wasn't really didn't really take off

749
00:27:43,279 --> 00:27:45,679
this blue line is web authent and usage

750
00:27:45,679 --> 00:27:48,159
of security keys and the red line is

751
00:27:48,159 --> 00:27:50,399
usage of totp and other forms of second

752
00:27:50,399 --> 00:27:51,520
factor

753
00:27:51,520 --> 00:27:52,559
and

754
00:27:52,559 --> 00:27:54,960
at first it was only the red line and

755
00:27:54,960 --> 00:27:59,760
then we introduced the security keys and

756
00:28:00,799 --> 00:28:03,039
it was like some security keys and then

757
00:28:03,039 --> 00:28:05,520
we enforced those five applications or

758
00:28:05,520 --> 00:28:08,640
so and this is kind of it just took off

759
00:28:08,640 --> 00:28:10,240
where people just got in the habit of

760
00:28:10,240 --> 00:28:11,520
touching

761
00:28:11,520 --> 00:28:14,080
it for everything and it worked out

762
00:28:14,080 --> 00:28:14,840
really

763
00:28:14,840 --> 00:28:17,200
well where we

764
00:28:17,200 --> 00:28:18,880
we started with a five and then we added

765
00:28:18,880 --> 00:28:20,480
a six and a seventh and we slowly

766
00:28:20,480 --> 00:28:22,240
expanded the set of apps that were

767
00:28:22,240 --> 00:28:24,960
protected by security keys and then

768
00:28:24,960 --> 00:28:27,440
uh eventually we got to this point

769
00:28:27,440 --> 00:28:30,000
where we said let's just turn off the

770
00:28:30,000 --> 00:28:34,000
other way and uh we said it's going away

771
00:28:34,000 --> 00:28:37,360
um there wasn't there's like a few

772
00:28:37,360 --> 00:28:39,600
things that didn't support security keys

773
00:28:39,600 --> 00:28:40,720
like i think we had a problem with

774
00:28:40,720 --> 00:28:42,799
salesforce and like one other thing but

775
00:28:42,799 --> 00:28:45,279
that was more on us than on them uh just

776
00:28:45,279 --> 00:28:48,399
had to figure out how to get it working

777
00:28:48,399 --> 00:28:50,320
so that was really cool any thoughts on

778
00:28:50,320 --> 00:28:53,520
security keys or questions

779
00:28:53,520 --> 00:28:55,840
they're like 30 bucks online

780
00:28:55,840 --> 00:28:58,840
cool

781
00:29:07,120 --> 00:29:09,120
ah yeah so

782
00:29:09,120 --> 00:29:10,640
the question is what happens when

783
00:29:10,640 --> 00:29:13,039
somebody loses their key so they they're

784
00:29:13,039 --> 00:29:15,279
required to have these um these hardware

785
00:29:15,279 --> 00:29:16,640
keys

786
00:29:16,640 --> 00:29:18,480
what happens if they lose it

787
00:29:18,480 --> 00:29:20,640
this happened just last week to one of

788
00:29:20,640 --> 00:29:22,399
our like senior directors of product or

789
00:29:22,399 --> 00:29:24,799
something he calls me and he's like

790
00:29:24,799 --> 00:29:27,360
evan i just lost my security key and i i

791
00:29:27,360 --> 00:29:30,080
have an important meeting tomorrow like

792
00:29:30,080 --> 00:29:32,480
i'm about to call an uber to go to my

793
00:29:32,480 --> 00:29:35,520
house three hours away from the city and

794
00:29:35,520 --> 00:29:38,960
uh pick up my laptop to bring it

795
00:29:38,960 --> 00:29:41,039
and um

796
00:29:41,039 --> 00:29:43,200
we we don't care if it's like the

797
00:29:43,200 --> 00:29:46,399
security key we issued you or not so i

798
00:29:46,399 --> 00:29:48,080
was like if you can get one overnighted

799
00:29:48,080 --> 00:29:51,039
to you from amazon and uh just expense

800
00:29:51,039 --> 00:29:53,200
it then we can like get you set back up

801
00:29:53,200 --> 00:29:55,520
get you on a call with it and get you

802
00:29:55,520 --> 00:29:56,799
set back up

803
00:29:56,799 --> 00:29:58,320
but also

804
00:29:58,320 --> 00:30:00,240
we encourage everybody to

805
00:30:00,240 --> 00:30:03,440
add face id as a security key too so

806
00:30:03,440 --> 00:30:05,279
last line of defense do you have your

807
00:30:05,279 --> 00:30:06,080
phone

808
00:30:06,080 --> 00:30:08,720
and then um

809
00:30:08,720 --> 00:30:10,240
and then

810
00:30:10,240 --> 00:30:12,559
last is the two security keys so if you

811
00:30:12,559 --> 00:30:13,279
can

812
00:30:13,279 --> 00:30:14,960
if you have the key ring security key

813
00:30:14,960 --> 00:30:16,000
that you're keeping with you all the

814
00:30:16,000 --> 00:30:19,360
time if you can just get a dongle um

815
00:30:19,360 --> 00:30:21,440
uh that can save you

816
00:30:21,440 --> 00:30:22,480
so

817
00:30:22,480 --> 00:30:23,440
uh

818
00:30:23,440 --> 00:30:25,679
yeah if you lose all your security keys

819
00:30:25,679 --> 00:30:26,720
you got to get

820
00:30:26,720 --> 00:30:28,480
you got to get a new one

821
00:30:28,480 --> 00:30:30,960
and uh we'll we'll ship you one but also

822
00:30:30,960 --> 00:30:33,039
amazon will too pretty quickly

823
00:30:33,039 --> 00:30:36,159
um if you're in a if you're in a bind

824
00:30:36,159 --> 00:30:38,960
but it it's that's the only situation

825
00:30:38,960 --> 00:30:41,360
that i know of that's happened in the

826
00:30:41,360 --> 00:30:44,399
last two years since we rolled this out

827
00:30:44,399 --> 00:30:46,159
where someone was just absolutely locked

828
00:30:46,159 --> 00:30:49,159
out

829
00:30:57,360 --> 00:30:58,960
yeah

830
00:30:58,960 --> 00:31:00,159
so the

831
00:31:00,159 --> 00:31:01,600
the question is

832
00:31:01,600 --> 00:31:03,440
you can use face id

833
00:31:03,440 --> 00:31:06,480
do people prefer that versus using the

834
00:31:06,480 --> 00:31:08,080
security key

835
00:31:08,080 --> 00:31:09,760
i would say that the security properties

836
00:31:09,760 --> 00:31:13,200
aren't any different so i'm not i don't

837
00:31:13,200 --> 00:31:14,320
feel like

838
00:31:14,320 --> 00:31:16,240
we're losing any security when somebody

839
00:31:16,240 --> 00:31:18,320
uses face id because it's still the web

840
00:31:18,320 --> 00:31:19,600
authent

841
00:31:19,600 --> 00:31:21,679
thing under the hood

842
00:31:21,679 --> 00:31:23,279
whether it's face id whether it's a

843
00:31:23,279 --> 00:31:25,919
security key whatever

844
00:31:25,919 --> 00:31:27,679
so

845
00:31:27,679 --> 00:31:29,519
yeah you can also set up for the touch

846
00:31:29,519 --> 00:31:32,399
id on your macbook or

847
00:31:32,399 --> 00:31:34,720
or your windows assistant i think it's

848
00:31:34,720 --> 00:31:37,919
called you can set it up in octa or your

849
00:31:37,919 --> 00:31:39,840
identity provider the same way you'd set

850
00:31:39,840 --> 00:31:42,720
up a security key so um

851
00:31:42,720 --> 00:31:45,440
a lot of devices support web authent and

852
00:31:45,440 --> 00:31:47,360
what the yubi keys do

853
00:31:47,360 --> 00:31:50,639
without needing a ub key

854
00:31:51,600 --> 00:31:53,279
yeah but the security properties in my

855
00:31:53,279 --> 00:31:54,480
mind the security properties are the

856
00:31:54,480 --> 00:31:57,039
same if you have fips requirements you

857
00:31:57,039 --> 00:32:00,399
probably can't do that but um

858
00:32:00,399 --> 00:32:02,640
not everybody does okay

859
00:32:02,640 --> 00:32:04,720
i gotta move on

860
00:32:04,720 --> 00:32:07,120
last roll-based access control

861
00:32:07,120 --> 00:32:09,279
excuse me

862
00:32:09,279 --> 00:32:12,000
with our vpn it was a nightmare for

863
00:32:12,000 --> 00:32:15,840
role-based access control because we

864
00:32:16,720 --> 00:32:18,799
we had applications which meant that

865
00:32:18,799 --> 00:32:20,960
they were tied to subnets and ips and

866
00:32:20,960 --> 00:32:22,240
there's like a bunch of spreadsheets

867
00:32:22,240 --> 00:32:23,279
trying to keep track of where

868
00:32:23,279 --> 00:32:26,000
applications were and what subnets and

869
00:32:26,000 --> 00:32:27,919
it just didn't work very well i mean you

870
00:32:27,919 --> 00:32:31,039
can make it work but for us it was a big

871
00:32:31,039 --> 00:32:32,159
hassle

872
00:32:32,159 --> 00:32:33,760
um

873
00:32:33,760 --> 00:32:35,440
that was a big problem but it was nice

874
00:32:35,440 --> 00:32:37,600
to be able especially when the

875
00:32:37,600 --> 00:32:39,360
application was just a web service or

876
00:32:39,360 --> 00:32:41,120
something it was way nicer to be able to

877
00:32:41,120 --> 00:32:44,159
just manage a group in our identity

878
00:32:44,159 --> 00:32:45,440
provider

879
00:32:45,440 --> 00:32:46,880
hook it up to

880
00:32:46,880 --> 00:32:49,519
the proxy and then

881
00:32:49,519 --> 00:32:51,760
say

882
00:32:51,760 --> 00:32:54,640
you'll see this redacted area

883
00:32:54,640 --> 00:32:57,519
you'll say okay this group gets access

884
00:32:57,519 --> 00:33:00,399
nobody else does so this is the pro dash

885
00:33:00,399 --> 00:33:01,919
this is a real one that i copied and

886
00:33:01,919 --> 00:33:04,000
pasted today from our internal

887
00:33:04,000 --> 00:33:06,559
code that manages all the stuff

888
00:33:06,559 --> 00:33:08,640
the pro dash service i have no idea what

889
00:33:08,640 --> 00:33:10,799
it is but only this group is allowed to

890
00:33:10,799 --> 00:33:12,480
have access to it and it requires a

891
00:33:12,480 --> 00:33:14,000
security key

892
00:33:14,000 --> 00:33:16,559
so our back was a lot simpler to set up

893
00:33:16,559 --> 00:33:18,559
and manage

894
00:33:18,559 --> 00:33:22,559
pretty instant gratification there

895
00:33:22,559 --> 00:33:25,679
okay so we talked about http that's easy

896
00:33:25,679 --> 00:33:26,880
stuff

897
00:33:26,880 --> 00:33:29,360
how do you handle non-http services like

898
00:33:29,360 --> 00:33:31,600
ssh and

899
00:33:31,600 --> 00:33:35,360
any other thing over tcp so you run an

900
00:33:35,360 --> 00:33:39,200
ftp service or sftp service how do you

901
00:33:39,200 --> 00:33:41,600
authenticate that in a zero trust world

902
00:33:41,600 --> 00:33:43,919
if you're going to try to and this is

903
00:33:43,919 --> 00:33:46,799
where we get a little mad scienti

904
00:33:46,799 --> 00:33:49,360
mad scientisty there's a lot less prior

905
00:33:49,360 --> 00:33:51,519
art here so i talked about some open

906
00:33:51,519 --> 00:33:54,640
source projects the bitly oauth proxy

907
00:33:54,640 --> 00:33:56,720
there's a bunch that you can find

908
00:33:56,720 --> 00:33:59,360
identity aware proxies off the shelf

909
00:33:59,360 --> 00:34:00,320
you

910
00:34:00,320 --> 00:34:02,080
will be hard-pressed to find things that

911
00:34:02,080 --> 00:34:04,640
support there are a few services that

912
00:34:04,640 --> 00:34:07,600
support ssh but like generic tcp auth

913
00:34:07,600 --> 00:34:11,520
whatever it is there's not many

914
00:34:11,918 --> 00:34:12,960
so

915
00:34:12,960 --> 00:34:14,639
this is the previous architecture i

916
00:34:14,639 --> 00:34:16,000
showed you

917
00:34:16,000 --> 00:34:17,918
but with these two giant green

918
00:34:17,918 --> 00:34:20,879
rectangles and so what we came up with

919
00:34:20,879 --> 00:34:23,359
to solve this problem of i want to

920
00:34:23,359 --> 00:34:25,520
authenticate i want to ssh into a

921
00:34:25,520 --> 00:34:28,079
service without needing special network

922
00:34:28,079 --> 00:34:29,040
access

923
00:34:29,040 --> 00:34:31,199
what we came up with is you run a

924
00:34:31,199 --> 00:34:33,199
special

925
00:34:33,199 --> 00:34:35,040
here's my thing

926
00:34:35,040 --> 00:34:37,440
you run a special service here on the

927
00:34:37,440 --> 00:34:38,719
server

928
00:34:38,719 --> 00:34:40,639
uh we call it cloudflare d

929
00:34:40,639 --> 00:34:44,399
which connects to our edge network

930
00:34:44,399 --> 00:34:46,560
you run a special service here called

931
00:34:46,560 --> 00:34:49,359
cloudflare d same one that connects here

932
00:34:49,359 --> 00:34:52,960
and then uh that that is all over http

933
00:34:52,960 --> 00:34:54,159
because we already solved the problem

934
00:34:54,159 --> 00:34:56,560
for http and then what we do is we

935
00:34:56,560 --> 00:34:59,040
tunnel raw tcp through this http

936
00:34:59,040 --> 00:35:01,599
connection uh it's http 2 so you can

937
00:35:01,599 --> 00:35:03,520
like actually kind of do that instead of

938
00:35:03,520 --> 00:35:05,839
http one but

939
00:35:05,839 --> 00:35:09,040
uh this is a tremendous hack

940
00:35:09,040 --> 00:35:11,200
uh in the sense that like

941
00:35:11,200 --> 00:35:13,520
this is not good software design or

942
00:35:13,520 --> 00:35:15,280
architecture but it works really really

943
00:35:15,280 --> 00:35:17,359
well

944
00:35:17,359 --> 00:35:19,600
so we're stuck with it for forever

945
00:35:19,600 --> 00:35:21,359
[Music]

946
00:35:21,359 --> 00:35:21,850
and

947
00:35:21,850 --> 00:35:23,520
[Music]

948
00:35:23,520 --> 00:35:25,680
it's really nice because you're able to

949
00:35:25,680 --> 00:35:27,520
authenticate users using all the same

950
00:35:27,520 --> 00:35:29,440
stuff the groups

951
00:35:29,440 --> 00:35:31,359
it's still cookie based authentication

952
00:35:31,359 --> 00:35:34,560
for ssh plus your ssh key

953
00:35:34,560 --> 00:35:36,880
um it's it's all the same stuff is

954
00:35:36,880 --> 00:35:38,000
reusable

955
00:35:38,000 --> 00:35:40,240
except now we're just sending a whole

956
00:35:40,240 --> 00:35:42,839
tcp connection through it and

957
00:35:42,839 --> 00:35:45,920
uh and not http

958
00:35:45,920 --> 00:35:48,640
all of this code is open source

959
00:35:48,640 --> 00:35:50,400
you can go read cloudflare and

960
00:35:50,400 --> 00:35:51,760
cloudflare d

961
00:35:51,760 --> 00:35:53,760
uh the source code you can go see the

962
00:35:53,760 --> 00:35:56,839
tremendous hack that is tcp over

963
00:35:56,839 --> 00:36:00,960
http uh it's it's all out there

964
00:36:00,960 --> 00:36:02,240
and then

965
00:36:02,240 --> 00:36:06,480
um the way it looks in practice

966
00:36:06,480 --> 00:36:08,240
there's a lot of lines here but there's

967
00:36:08,240 --> 00:36:09,599
actually two things happening that's why

968
00:36:09,599 --> 00:36:12,400
there's so many lines

969
00:36:12,800 --> 00:36:15,200
so the way it looks in practice

970
00:36:15,200 --> 00:36:18,480
as i explained you do the

971
00:36:18,480 --> 00:36:20,800
i'll cover the bottom part this is what

972
00:36:20,800 --> 00:36:23,359
first this is what your ssh config would

973
00:36:23,359 --> 00:36:25,200
look like when using this and the

974
00:36:25,200 --> 00:36:27,920
important thing to see is

975
00:36:27,920 --> 00:36:31,359
your ssh into vm.example.com

976
00:36:31,359 --> 00:36:32,880
and then

977
00:36:32,880 --> 00:36:34,000
um

978
00:36:34,000 --> 00:36:36,880
when it has this proxy command thing and

979
00:36:36,880 --> 00:36:40,079
proxy command is built into ssh it's

980
00:36:40,079 --> 00:36:43,200
like native in the protocol

981
00:36:43,200 --> 00:36:45,920
so there's no special magic here and it

982
00:36:45,920 --> 00:36:47,200
will just

983
00:36:47,200 --> 00:36:50,400
run this cloudflare d command here and

984
00:36:50,400 --> 00:36:53,200
then proxy your entire ssh connection

985
00:36:53,200 --> 00:36:54,960
over that so

986
00:36:54,960 --> 00:36:56,720
we actually it might be a tremendous

987
00:36:56,720 --> 00:36:58,240
hack but it

988
00:36:58,240 --> 00:37:00,560
it's not so bad the tooling is was all

989
00:37:00,560 --> 00:37:02,000
there to support it

990
00:37:02,000 --> 00:37:05,119
and it's pretty simple we have a command

991
00:37:05,119 --> 00:37:07,359
that we tell our engineers to run which

992
00:37:07,359 --> 00:37:09,200
auto generates this because there's a

993
00:37:09,200 --> 00:37:12,000
bunch of like crazy

994
00:37:12,000 --> 00:37:14,480
percent signs and

995
00:37:14,480 --> 00:37:17,200
weird standard out standard in

996
00:37:17,200 --> 00:37:19,680
stuff but this is all auto generated our

997
00:37:19,680 --> 00:37:21,680
engineers don't need to touch this they

998
00:37:21,680 --> 00:37:22,880
just run like

999
00:37:22,880 --> 00:37:25,040
cloudflare d ssh

1000
00:37:25,040 --> 00:37:27,570
config generate

1001
00:37:27,570 --> 00:37:29,119
[Music]

1002
00:37:29,119 --> 00:37:30,320
but it's

1003
00:37:30,320 --> 00:37:32,880
that part is pretty neat as a client

1004
00:37:32,880 --> 00:37:35,119
that's what it looks like you you set up

1005
00:37:35,119 --> 00:37:37,520
this ssh config

1006
00:37:37,520 --> 00:37:38,720
run it

1007
00:37:38,720 --> 00:37:40,560
that's part one of this slide

1008
00:37:40,560 --> 00:37:43,200
uh in order to get your ssh connection

1009
00:37:43,200 --> 00:37:46,160
over http part two of this slide is

1010
00:37:46,160 --> 00:37:48,960
something that

1011
00:37:49,040 --> 00:37:51,359
is special one thing that we wanted to

1012
00:37:51,359 --> 00:37:53,760
do this is just more of an experiment

1013
00:37:53,760 --> 00:37:56,800
and it exists in the product but

1014
00:37:56,800 --> 00:37:59,280
um it was more for fun

1015
00:37:59,280 --> 00:38:02,480
we wanted to support ssh certificates

1016
00:38:02,480 --> 00:38:05,839
so we will actually provide short-lived

1017
00:38:05,839 --> 00:38:08,720
ssh certificates that we sign for some

1018
00:38:08,720 --> 00:38:10,880
of our engineers when we want to give

1019
00:38:10,880 --> 00:38:14,480
them short-lived access to a machine

1020
00:38:14,480 --> 00:38:16,640
and

1021
00:38:16,640 --> 00:38:19,359
it works the same way as everything else

1022
00:38:19,359 --> 00:38:22,240
with ssh over the http connection but

1023
00:38:22,240 --> 00:38:24,079
there's a lot more back and forth where

1024
00:38:24,079 --> 00:38:25,520
you're getting the certificate signed

1025
00:38:25,520 --> 00:38:26,640
and all of that

1026
00:38:26,640 --> 00:38:28,640
some prior art here

1027
00:38:28,640 --> 00:38:31,520
is the netflix bless

1028
00:38:31,520 --> 00:38:33,520
project netflix

1029
00:38:33,520 --> 00:38:36,160
on their github they have a

1030
00:38:36,160 --> 00:38:38,240
separate skunk works github for just

1031
00:38:38,240 --> 00:38:40,240
like crazy experiments that they do and

1032
00:38:40,240 --> 00:38:42,079
one of the things that they have on

1033
00:38:42,079 --> 00:38:43,920
there is a project called bless

1034
00:38:43,920 --> 00:38:45,599
b-l-e-s-s

1035
00:38:45,599 --> 00:38:47,520
and

1036
00:38:47,520 --> 00:38:49,599
that is ssh

1037
00:38:49,599 --> 00:38:52,400
certificates uh almost identical to what

1038
00:38:52,400 --> 00:38:54,960
we built here so we kind of just

1039
00:38:54,960 --> 00:38:57,599
copied it

1040
00:38:59,440 --> 00:39:02,960
uh great artist steal

1041
00:39:03,040 --> 00:39:05,200
cool

1042
00:39:08,320 --> 00:39:10,560
what

1043
00:39:11,200 --> 00:39:13,280
no it's all open

1044
00:39:13,280 --> 00:39:15,119
uh question is is there a patent

1045
00:39:15,119 --> 00:39:16,880
minefield around this stuff the answer

1046
00:39:16,880 --> 00:39:19,440
is definitely not it's all um

1047
00:39:19,440 --> 00:39:21,599
ssh certificates are like

1048
00:39:21,599 --> 00:39:24,720
in the open source software and um but i

1049
00:39:24,720 --> 00:39:25,920
think nobody

1050
00:39:25,920 --> 00:39:27,119
maybe the

1051
00:39:27,119 --> 00:39:30,400
new art that black bless did that we

1052
00:39:30,400 --> 00:39:33,280
kind of copied was hooking up ssh

1053
00:39:33,280 --> 00:39:35,280
certificates to an identity provider

1054
00:39:35,280 --> 00:39:37,359
like your octa or your one login or your

1055
00:39:37,359 --> 00:39:40,920
azure id whatever

1056
00:39:50,000 --> 00:39:51,200
yeah

1057
00:39:51,200 --> 00:39:53,280
the question is

1058
00:39:53,280 --> 00:39:55,119
the question is what's the vulnerability

1059
00:39:55,119 --> 00:39:59,680
here the device is compromised and uh

1060
00:39:59,680 --> 00:40:01,839
is that it like is that the

1061
00:40:01,839 --> 00:40:04,079
risk scenario and the answer is yes let

1062
00:40:04,079 --> 00:40:07,040
me advance the slide

1063
00:40:09,359 --> 00:40:10,720
okay so

1064
00:40:10,720 --> 00:40:12,560
um

1065
00:40:12,560 --> 00:40:14,480
this is

1066
00:40:14,480 --> 00:40:16,880
uh how we if you read the beyond court

1067
00:40:16,880 --> 00:40:18,880
papers which i called out earlier

1068
00:40:18,880 --> 00:40:21,359
two of the six if you go to any zero

1069
00:40:21,359 --> 00:40:23,040
trust vendor

1070
00:40:23,040 --> 00:40:25,280
and and they offer you an identity or

1071
00:40:25,280 --> 00:40:29,920
proxy ask about their device identity

1072
00:40:29,920 --> 00:40:31,200
solution

1073
00:40:31,200 --> 00:40:33,040
two of the six beyond court papers are

1074
00:40:33,040 --> 00:40:35,200
about device identity and authenticating

1075
00:40:35,200 --> 00:40:37,599
like the device is one that you own

1076
00:40:37,599 --> 00:40:40,319
and that's a major tenant of what google

1077
00:40:40,319 --> 00:40:42,319
originally wrote about and it seems like

1078
00:40:42,319 --> 00:40:44,640
a lot of vendors just forgot about that

1079
00:40:44,640 --> 00:40:46,640
or they didn't read the papers

1080
00:40:46,640 --> 00:40:48,160
but

1081
00:40:48,160 --> 00:40:51,359
the way we're doing this is we

1082
00:40:51,359 --> 00:40:54,560
on all the client machines on the left

1083
00:40:54,560 --> 00:40:56,319
we uh

1084
00:40:56,319 --> 00:41:00,319
in we started installing wireguard

1085
00:41:00,319 --> 00:41:01,680
clients

1086
00:41:01,680 --> 00:41:02,720
um

1087
00:41:02,720 --> 00:41:04,800
which wireguard is a protocol that is

1088
00:41:04,800 --> 00:41:06,800
supposed to replace openvpn made by this

1089
00:41:06,800 --> 00:41:10,560
guy named jason dunenfeld

1090
00:41:10,560 --> 00:41:12,880
and it has support in the mainline linux

1091
00:41:12,880 --> 00:41:15,040
kernel which is great but it's supposed

1092
00:41:15,040 --> 00:41:17,440
to i mean the big gripe with openvpn is

1093
00:41:17,440 --> 00:41:19,680
it's like 150 000 lines of code and

1094
00:41:19,680 --> 00:41:21,839
nobody's ever read it and wireguard is

1095
00:41:21,839 --> 00:41:24,160
supposed to be like it's 2000 lines of

1096
00:41:24,160 --> 00:41:26,640
code it's a lot simpler

1097
00:41:26,640 --> 00:41:28,319
um

1098
00:41:28,319 --> 00:41:30,800
so we install we started installing all

1099
00:41:30,800 --> 00:41:32,640
of these clients on our

1100
00:41:32,640 --> 00:41:35,440
corporate machines that basically send

1101
00:41:35,440 --> 00:41:38,000
all the traffic to our server

1102
00:41:38,000 --> 00:41:40,400
and we have a

1103
00:41:40,400 --> 00:41:41,839
in the back end

1104
00:41:41,839 --> 00:41:43,359
a

1105
00:41:43,359 --> 00:41:45,280
mapping of like

1106
00:41:45,280 --> 00:41:46,000
uh

1107
00:41:46,000 --> 00:41:48,160
wireguard public key because part of the

1108
00:41:48,160 --> 00:41:49,839
authentication process for wireguard is

1109
00:41:49,839 --> 00:41:51,359
you present your public key

1110
00:41:51,359 --> 00:41:54,480
we have that along with your device

1111
00:41:54,480 --> 00:41:57,520
serial number and then your name your

1112
00:41:57,520 --> 00:42:00,240
email address so we know

1113
00:42:00,240 --> 00:42:02,640
when you're connecting with your actual

1114
00:42:02,640 --> 00:42:05,680
device and um

1115
00:42:05,680 --> 00:42:09,599
that's part one of device identity

1116
00:42:09,599 --> 00:42:11,440
um

1117
00:42:11,440 --> 00:42:14,640
but the that's the wire guard portion

1118
00:42:14,640 --> 00:42:18,560
part two oh beyondcorp yes

1119
00:42:18,560 --> 00:42:21,839
i covered that um part two is we

1120
00:42:21,839 --> 00:42:23,839
actually started putting certificates

1121
00:42:23,839 --> 00:42:26,640
the traditional pki route we started

1122
00:42:26,640 --> 00:42:28,720
putting uh certificates directly in

1123
00:42:28,720 --> 00:42:30,800
people's browsers

1124
00:42:30,800 --> 00:42:32,720
and

1125
00:42:32,720 --> 00:42:34,480
enforcing that people have those

1126
00:42:34,480 --> 00:42:36,800
certificates when they hit our our

1127
00:42:36,800 --> 00:42:39,920
machines so just like just like our edge

1128
00:42:39,920 --> 00:42:42,319
enforces that you have a cookie that

1129
00:42:42,319 --> 00:42:44,240
says who you are we also enforce that

1130
00:42:44,240 --> 00:42:46,160
you're doing mutually authenticated tls

1131
00:42:46,160 --> 00:42:48,560
between your client and server and

1132
00:42:48,560 --> 00:42:50,160
actually we're in the phase of dialing

1133
00:42:50,160 --> 00:42:52,079
the pressure up right now just like we

1134
00:42:52,079 --> 00:42:54,640
did the security keys two years ago

1135
00:42:54,640 --> 00:42:56,240
where we started dialing up the pressure

1136
00:42:56,240 --> 00:42:58,640
and enforcing people have their

1137
00:42:58,640 --> 00:43:00,560
security key when logging in

1138
00:43:00,560 --> 00:43:02,560
right now we're in the phase of we just

1139
00:43:02,560 --> 00:43:04,720
pushed out the um

1140
00:43:04,720 --> 00:43:06,960
the certificates and we're just trying

1141
00:43:06,960 --> 00:43:09,119
them out on a few websites internally

1142
00:43:09,119 --> 00:43:11,280
that we enforce the

1143
00:43:11,280 --> 00:43:13,839
certificates for

1144
00:43:14,240 --> 00:43:15,920
so

1145
00:43:15,920 --> 00:43:17,599
those are the two ways we're addressing

1146
00:43:17,599 --> 00:43:19,839
the

1147
00:43:20,160 --> 00:43:21,680
actually there's a third way i forgot

1148
00:43:21,680 --> 00:43:23,440
about

1149
00:43:23,440 --> 00:43:25,040
there's also all these other device

1150
00:43:25,040 --> 00:43:26,960
signals i don't think that our core

1151
00:43:26,960 --> 00:43:30,480
competency is the like endpoint

1152
00:43:30,480 --> 00:43:32,319
protection that's not something that

1153
00:43:32,319 --> 00:43:33,839
we're going to get into we're really

1154
00:43:33,839 --> 00:43:35,359
good network people we're really good

1155
00:43:35,359 --> 00:43:37,359
like real-time services people and

1156
00:43:37,359 --> 00:43:38,880
distributed systems

1157
00:43:38,880 --> 00:43:41,359
engineers um

1158
00:43:41,359 --> 00:43:43,119
so we started like

1159
00:43:43,119 --> 00:43:45,280
integrating with some of these people

1160
00:43:45,280 --> 00:43:47,760
who are good at um

1161
00:43:47,760 --> 00:43:49,920
at endpoint protection and

1162
00:43:49,920 --> 00:43:51,839
like for me all i care about is like

1163
00:43:51,839 --> 00:43:54,240
full disc encryption is turned on

1164
00:43:54,240 --> 00:43:56,400
they're running our

1165
00:43:56,400 --> 00:43:59,520
software like the process list has our

1166
00:43:59,520 --> 00:44:01,119
software that we

1167
00:44:01,119 --> 00:44:02,800
mandate is running

1168
00:44:02,800 --> 00:44:04,960
and then

1169
00:44:04,960 --> 00:44:06,800
there might be another one like passcode

1170
00:44:06,800 --> 00:44:08,880
you're you're enforcing a password like

1171
00:44:08,880 --> 00:44:10,560
i only care about really basic security

1172
00:44:10,560 --> 00:44:11,760
controls but

1173
00:44:11,760 --> 00:44:14,079
integrating with some of these that can

1174
00:44:14,079 --> 00:44:16,400
tell you okay there's not viruses or

1175
00:44:16,400 --> 00:44:19,520
anything is

1176
00:44:19,520 --> 00:44:22,079
a value add but that's not really my

1177
00:44:22,079 --> 00:44:23,920
wheelhouse

1178
00:44:23,920 --> 00:44:25,280
but those are the three ways we're kind

1179
00:44:25,280 --> 00:44:27,359
of addressing the device

1180
00:44:27,359 --> 00:44:30,799
identity stuff internally

1181
00:44:32,319 --> 00:44:34,800
okay the last is the real crazy

1182
00:44:34,800 --> 00:44:36,960
experimentation stuff that we're doing

1183
00:44:36,960 --> 00:44:38,160
right now

1184
00:44:38,160 --> 00:44:41,680
this is like pure mad scientist stuff so

1185
00:44:41,680 --> 00:44:43,599
i think it's really cool but

1186
00:44:43,599 --> 00:44:46,880
it's not really well used internally yet

1187
00:44:46,880 --> 00:44:49,040
it's still got some rough edges but i

1188
00:44:49,040 --> 00:44:50,720
think there's a lot of hope in this

1189
00:44:50,720 --> 00:44:51,680
space

1190
00:44:51,680 --> 00:44:54,720
the first is called xero trust apps

1191
00:44:54,720 --> 00:44:56,480
which we're building we have a whole

1192
00:44:56,480 --> 00:44:58,960
blog post about it you can go search it

1193
00:44:58,960 --> 00:45:00,560
and read it and they have like nice gifs

1194
00:45:00,560 --> 00:45:03,040
and stuff which show this but

1195
00:45:03,040 --> 00:45:05,520
you'll notice this is in a browser so

1196
00:45:05,520 --> 00:45:08,000
this is an ssh thing in a browser if

1197
00:45:08,000 --> 00:45:11,280
you've ever used google cloud's uh

1198
00:45:11,280 --> 00:45:13,599
like vm thing you can press a button and

1199
00:45:13,599 --> 00:45:15,760
it'll give you an ssh connection in a

1200
00:45:15,760 --> 00:45:18,160
browser and if you're ever like how does

1201
00:45:18,160 --> 00:45:19,839
that work i'll tell you i don't know how

1202
00:45:19,839 --> 00:45:22,319
theirs works but i know how hours work

1203
00:45:22,319 --> 00:45:24,720
and what we did was we took the ssh

1204
00:45:24,720 --> 00:45:27,599
client and compiled it to webassembly

1205
00:45:27,599 --> 00:45:28,720
and then

1206
00:45:28,720 --> 00:45:30,160
sent all the connections over a

1207
00:45:30,160 --> 00:45:32,160
websocket and then treated everything

1208
00:45:32,160 --> 00:45:33,920
the same way so instead of having to

1209
00:45:33,920 --> 00:45:36,720
deal with all of these

1210
00:45:36,720 --> 00:45:38,960
really weird protocols like i was

1211
00:45:38,960 --> 00:45:41,520
explaining all the challenges with ssh

1212
00:45:41,520 --> 00:45:44,079
we just put it all in a websocket run it

1213
00:45:44,079 --> 00:45:47,839
in webassembly on in a browser and um it

1214
00:45:47,839 --> 00:45:49,520
seems to kind of work there's a lot of

1215
00:45:49,520 --> 00:45:51,440
details there and

1216
00:45:51,440 --> 00:45:53,440
and that are very specific to each

1217
00:45:53,440 --> 00:45:55,680
individual application and i think it

1218
00:45:55,680 --> 00:45:57,280
took somebody like two weeks to get this

1219
00:45:57,280 --> 00:45:58,880
running and it's still kind of new and

1220
00:45:58,880 --> 00:46:00,720
experimental but

1221
00:46:00,720 --> 00:46:02,400
it's promising and it does work like you

1222
00:46:02,400 --> 00:46:04,079
can actually go try this out for free

1223
00:46:04,079 --> 00:46:05,920
there it doesn't cost anything to use

1224
00:46:05,920 --> 00:46:08,160
these products and

1225
00:46:08,160 --> 00:46:11,359
set it up give it a try

1226
00:46:11,680 --> 00:46:15,119
that's one area and then another is we

1227
00:46:15,119 --> 00:46:17,920
acquired a company last january called

1228
00:46:17,920 --> 00:46:19,660
s2 systems and

1229
00:46:19,660 --> 00:46:20,800
[Music]

1230
00:46:20,800 --> 00:46:23,520
they do remote browser

1231
00:46:23,520 --> 00:46:25,760
stuff like

1232
00:46:25,760 --> 00:46:27,359
and this is like a real version of

1233
00:46:27,359 --> 00:46:30,720
chrome that we run on our edge and so we

1234
00:46:30,720 --> 00:46:33,200
started integrating that with our

1235
00:46:33,200 --> 00:46:34,480
products

1236
00:46:34,480 --> 00:46:37,359
where we can actually enforce that for

1237
00:46:37,359 --> 00:46:39,760
our super sensitive high sensitivity

1238
00:46:39,760 --> 00:46:40,800
apps

1239
00:46:40,800 --> 00:46:43,680
it's in a browser that's not running on

1240
00:46:43,680 --> 00:46:45,040
your machine

1241
00:46:45,040 --> 00:46:47,839
you access the you access this browser

1242
00:46:47,839 --> 00:46:50,640
just like you go to any other web url we

1243
00:46:50,640 --> 00:46:52,720
intercept it and then run the browser in

1244
00:46:52,720 --> 00:46:54,800
the back end and then render what it

1245
00:46:54,800 --> 00:46:56,560
what you're seeing on your machine

1246
00:46:56,560 --> 00:46:57,920
so

1247
00:46:57,920 --> 00:47:00,480
um this is still experimental for the

1248
00:47:00,480 --> 00:47:01,520
most part

1249
00:47:01,520 --> 00:47:03,440
it's real and runs on our edge and like

1250
00:47:03,440 --> 00:47:05,119
it's really cool and actually works very

1251
00:47:05,119 --> 00:47:06,160
well

1252
00:47:06,160 --> 00:47:08,560
uh internally we're using this because

1253
00:47:08,560 --> 00:47:10,160
we're still shaving a lot of the rough

1254
00:47:10,160 --> 00:47:12,640
edges off we use it for all news sites

1255
00:47:12,640 --> 00:47:15,119
so you go to like cnn or

1256
00:47:15,119 --> 00:47:17,680
whatever new site new york times and it

1257
00:47:17,680 --> 00:47:20,480
renders in this remote browser and

1258
00:47:20,480 --> 00:47:22,720
it's pretty neat but we're not

1259
00:47:22,720 --> 00:47:24,960
incorporating it into our security model

1260
00:47:24,960 --> 00:47:27,680
i can imagine a future where we do and

1261
00:47:27,680 --> 00:47:28,559
we

1262
00:47:28,559 --> 00:47:30,960
make sure that before you download a pdf

1263
00:47:30,960 --> 00:47:31,760
or

1264
00:47:31,760 --> 00:47:33,520
um

1265
00:47:33,520 --> 00:47:35,839
before you

1266
00:47:35,839 --> 00:47:39,040
maybe we block drive by mal malvertising

1267
00:47:39,040 --> 00:47:40,319
or

1268
00:47:40,319 --> 00:47:42,160
whatever whatever types of things we

1269
00:47:42,160 --> 00:47:44,480
want to do it just gives us a lot of

1270
00:47:44,480 --> 00:47:48,079
control having the entire browser be

1271
00:47:48,079 --> 00:47:51,119
ours so

1272
00:47:51,280 --> 00:47:52,400
that's kind of

1273
00:47:52,400 --> 00:47:53,920
experimental stuff and this isn't like

1274
00:47:53,920 --> 00:47:55,760
headless chrome this is like

1275
00:47:55,760 --> 00:47:57,520
full chrome this is like real chrome

1276
00:47:57,520 --> 00:47:59,200
that we just

1277
00:47:59,200 --> 00:48:01,440
run on our edge it's kind of

1278
00:48:01,440 --> 00:48:03,280
nutty but it works

1279
00:48:03,280 --> 00:48:04,720
okay

1280
00:48:04,720 --> 00:48:06,880
that's all i had for you there's a lot

1281
00:48:06,880 --> 00:48:08,960
of content here if you have any

1282
00:48:08,960 --> 00:48:12,240
questions or um whatever i'll be around

1283
00:48:12,240 --> 00:48:15,119
but my email is evan cloudflare.com i

1284
00:48:15,119 --> 00:48:18,559
hope you have a good idea around

1285
00:48:18,559 --> 00:48:20,880
some of the problems associated with

1286
00:48:20,880 --> 00:48:22,400
moving to zero trust and some of the

1287
00:48:22,400 --> 00:48:25,280
ways you can address them and um

1288
00:48:25,280 --> 00:48:27,200
the technology

1289
00:48:27,200 --> 00:48:28,319
uh

1290
00:48:28,319 --> 00:48:30,160
like you don't have to figure it out all

1291
00:48:30,160 --> 00:48:32,240
out on your own and you can investigate

1292
00:48:32,240 --> 00:48:35,200
in some prior art but the main

1293
00:48:35,200 --> 00:48:36,960
the main parts of xero trust the main

1294
00:48:36,960 --> 00:48:39,440
tenants you need to be successful is you

1295
00:48:39,440 --> 00:48:41,599
need to solve the http problem the

1296
00:48:41,599 --> 00:48:44,079
non-http problem and then you need

1297
00:48:44,079 --> 00:48:46,640
strong device identity

1298
00:48:46,640 --> 00:48:48,559
and um

1299
00:48:48,559 --> 00:48:50,480
yeah if you can solve those three things

1300
00:48:50,480 --> 00:48:51,599
then

1301
00:48:51,599 --> 00:48:53,760
you're good to go and check out security

1302
00:48:53,760 --> 00:48:56,319
keys if you haven't um because the

1303
00:48:56,319 --> 00:48:58,079
support has become really amazing in the

1304
00:48:58,079 --> 00:49:00,240
last two years

1305
00:49:00,240 --> 00:49:03,839
that's all i had any questions

1306
00:49:32,240 --> 00:49:34,720
yeah uh the question is what do you do

1307
00:49:34,720 --> 00:49:37,359
for role-based access control and like a

1308
00:49:37,359 --> 00:49:39,119
massive organization

1309
00:49:39,119 --> 00:49:40,880
we're not a massive organization so we

1310
00:49:40,880 --> 00:49:43,119
can actually like

1311
00:49:43,119 --> 00:49:44,640
like hand to groom

1312
00:49:44,640 --> 00:49:47,040
groups and i'll usually tell people

1313
00:49:47,040 --> 00:49:48,960
you're in charge of this group like

1314
00:49:48,960 --> 00:49:50,880
this is your responsibility and then

1315
00:49:50,880 --> 00:49:53,839
it's theirs um there's a lot of

1316
00:49:53,839 --> 00:49:55,280
i think that

1317
00:49:55,280 --> 00:49:57,440
there's not a lot of public prior art on

1318
00:49:57,440 --> 00:49:59,040
this problem though like i know that

1319
00:49:59,040 --> 00:50:00,559
some companies have implemented things

1320
00:50:00,559 --> 00:50:02,480
where they see if i make a group change

1321
00:50:02,480 --> 00:50:04,400
and it affects more than 10 of the

1322
00:50:04,400 --> 00:50:06,559
workforce or they have thresholds in

1323
00:50:06,559 --> 00:50:08,400
there where

1324
00:50:08,400 --> 00:50:10,480
they test their changes before

1325
00:50:10,480 --> 00:50:13,520
making them and have some like basically

1326
00:50:13,520 --> 00:50:15,680
unit tests for what

1327
00:50:15,680 --> 00:50:18,079
is and is not a good group change

1328
00:50:18,079 --> 00:50:19,920
and then maintaining those is hard like

1329
00:50:19,920 --> 00:50:21,440
you have to do it by the org chart by

1330
00:50:21,440 --> 00:50:22,720
the region

1331
00:50:22,720 --> 00:50:24,000
by

1332
00:50:24,000 --> 00:50:26,720
the app sensitivity but you end up with

1333
00:50:26,720 --> 00:50:28,079
like all of these

1334
00:50:28,079 --> 00:50:31,119
circles and patchwork of security

1335
00:50:31,119 --> 00:50:33,040
um requirements for each

1336
00:50:33,040 --> 00:50:35,040
app and it's hard so i don't have

1337
00:50:35,040 --> 00:50:37,839
answers for you that's a hard problem

1338
00:50:37,839 --> 00:50:40,839
okay

1339
00:50:42,740 --> 00:50:50,470
[Applause]

