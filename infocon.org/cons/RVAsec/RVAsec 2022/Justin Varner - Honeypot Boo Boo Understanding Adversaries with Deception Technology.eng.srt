1
00:00:12,320 --> 00:00:15,320
my

2
00:00:16,480 --> 00:00:19,840
all right we're going to kick things off

3
00:00:19,840 --> 00:00:22,160
so i'm really excited to be here and

4
00:00:22,160 --> 00:00:23,920
talk to you guys

5
00:00:23,920 --> 00:00:25,119
about

6
00:00:25,119 --> 00:00:27,039
deception technology

7
00:00:27,039 --> 00:00:29,359
and a better way

8
00:00:29,359 --> 00:00:31,840
to think about preach detection

9
00:00:31,840 --> 00:00:34,320
and we need something now more than ever

10
00:00:34,320 --> 00:00:36,640
i feel like this is an idea whose time

11
00:00:36,640 --> 00:00:38,000
has come

12
00:00:38,000 --> 00:00:39,200
and

13
00:00:39,200 --> 00:00:41,120
this is my opportunity to

14
00:00:41,120 --> 00:00:42,640
hopefully educate and give you some

15
00:00:42,640 --> 00:00:45,600
practical ways to start using deception

16
00:00:45,600 --> 00:00:48,160
technology now

17
00:00:48,160 --> 00:00:51,280
to mitigate the impact of breaches and

18
00:00:51,280 --> 00:00:53,120
and know in real time when these things

19
00:00:53,120 --> 00:00:55,680
are occurring

20
00:00:56,160 --> 00:00:59,680
but first off oops

21
00:00:59,680 --> 00:01:01,520
we need to talk about what

22
00:01:01,520 --> 00:01:04,400
a honey trap is and a honey trap can be

23
00:01:04,400 --> 00:01:05,760
a honey pot

24
00:01:05,760 --> 00:01:07,920
or a honey token

25
00:01:07,920 --> 00:01:09,600
and really it's just a security

26
00:01:09,600 --> 00:01:10,880
mechanism

27
00:01:10,880 --> 00:01:13,439
designed to entice adversaries to

28
00:01:13,439 --> 00:01:15,280
announce their presence

29
00:01:15,280 --> 00:01:18,080
it's a component of a larger discipline

30
00:01:18,080 --> 00:01:20,159
known as reception technology

31
00:01:20,159 --> 00:01:22,080
and these honey traps are designed to

32
00:01:22,080 --> 00:01:23,200
produce

33
00:01:23,200 --> 00:01:26,240
a lower volume of high fidelity alerts

34
00:01:26,240 --> 00:01:27,920
and only when you need it most when

35
00:01:27,920 --> 00:01:29,840
something bad's happening

36
00:01:29,840 --> 00:01:31,840
and why do we need this

37
00:01:31,840 --> 00:01:34,240
we got to reduce our time to detection

38
00:01:34,240 --> 00:01:35,840
it's it's taking way too long to know

39
00:01:35,840 --> 00:01:37,280
that bad things are happening and it's

40
00:01:37,280 --> 00:01:38,840
resulting in

41
00:01:38,840 --> 00:01:41,360
catastrophe and as you can see from some

42
00:01:41,360 --> 00:01:44,560
of the headlines over the past decade

43
00:01:44,560 --> 00:01:46,640
millions and millions of alerts going

44
00:01:46,640 --> 00:01:47,840
back to

45
00:01:47,840 --> 00:01:50,320
snowden with the nsa

46
00:01:50,320 --> 00:01:52,479
all the way to anyone that had a

47
00:01:52,479 --> 00:01:54,720
security clearance office of personnel

48
00:01:54,720 --> 00:01:56,000
management

49
00:01:56,000 --> 00:01:58,479
you know your information was dumped and

50
00:01:58,479 --> 00:02:00,240
you know it's out there for

51
00:02:00,240 --> 00:02:02,640
everyone to pilfer through same with

52
00:02:02,640 --> 00:02:04,479
equifax i think that

53
00:02:04,479 --> 00:02:05,920
affect everybody here with a credit

54
00:02:05,920 --> 00:02:08,479
score which is 147

55
00:02:08,479 --> 00:02:11,440
million americans so everyone now has to

56
00:02:11,440 --> 00:02:14,080
do credit monitoring for life and

57
00:02:14,080 --> 00:02:16,319
it's it's not good and then solarwinds

58
00:02:16,319 --> 00:02:18,640
really shook up our confidence in supply

59
00:02:18,640 --> 00:02:19,599
chain

60
00:02:19,599 --> 00:02:22,080
and it took a really long time for

61
00:02:22,080 --> 00:02:23,920
anyone to even know

62
00:02:23,920 --> 00:02:25,520
that anything bad was happening and by

63
00:02:25,520 --> 00:02:26,959
then it was too late

64
00:02:26,959 --> 00:02:28,560
so we need we need something else we

65
00:02:28,560 --> 00:02:31,760
need something that actually works

66
00:02:32,160 --> 00:02:33,920
there's any jimmy mcmillan fans out

67
00:02:33,920 --> 00:02:35,040
there

68
00:02:35,040 --> 00:02:36,800
he he ran his whole platform on the

69
00:02:36,800 --> 00:02:39,519
price of rent being high and he's right

70
00:02:39,519 --> 00:02:42,239
but the cost of cyber crime is now a big

71
00:02:42,239 --> 00:02:43,280
problem

72
00:02:43,280 --> 00:02:44,560
just as an

73
00:02:44,560 --> 00:02:46,959
assessment of last year alone

74
00:02:46,959 --> 00:02:48,640
six trillion dollars cost the global

75
00:02:48,640 --> 00:02:49,760
economy

76
00:02:49,760 --> 00:02:52,560
which is wild and by 2025 that's

77
00:02:52,560 --> 00:02:55,680
expected to go up to 10.5 trillion

78
00:02:55,680 --> 00:02:57,920
about every 39 seconds an organization

79
00:02:57,920 --> 00:02:59,440
is breached

80
00:02:59,440 --> 00:03:04,080
the fbi got 847 000 cyber complaints but

81
00:03:04,080 --> 00:03:05,440
i hope now

82
00:03:05,440 --> 00:03:07,760
that there's an actual opportunity

83
00:03:07,760 --> 00:03:09,599
for me to give you a solution on how we

84
00:03:09,599 --> 00:03:10,319
can

85
00:03:10,319 --> 00:03:13,040
stop the pain

86
00:03:13,680 --> 00:03:15,599
so yeah the average breach based off

87
00:03:15,599 --> 00:03:17,120
ibm's

88
00:03:17,120 --> 00:03:20,560
breach report from 2021 takes about 212

89
00:03:20,560 --> 00:03:22,080
days before anyone even knows that the

90
00:03:22,080 --> 00:03:24,640
breach is happening let alone the time

91
00:03:24,640 --> 00:03:26,319
to mitigate the breach that's a whole

92
00:03:26,319 --> 00:03:28,239
other story and if you look back over

93
00:03:28,239 --> 00:03:29,360
the years that some of the biggest

94
00:03:29,360 --> 00:03:31,040
breaches of all time

95
00:03:31,040 --> 00:03:32,640
you had cam4

96
00:03:32,640 --> 00:03:35,239
what's interesting about that is there's

97
00:03:35,239 --> 00:03:38,159
10.88 billion accounts and there's 7.3

98
00:03:38,159 --> 00:03:40,319
billion people so there are multiple

99
00:03:40,319 --> 00:03:42,159
accounts because it was kind of a

100
00:03:42,159 --> 00:03:44,080
naughty video streaming site so people

101
00:03:44,080 --> 00:03:45,599
probably didn't want others to know what

102
00:03:45,599 --> 00:03:48,319
was going on then you have yahoo

103
00:03:48,319 --> 00:03:50,959
who got breached multiple times and

104
00:03:50,959 --> 00:03:52,720
you know three billion accounts

105
00:03:52,720 --> 00:03:55,360
and then there's that aadh aar that was

106
00:03:55,360 --> 00:03:57,760
india's digital identity program

107
00:03:57,760 --> 00:03:58,879
and

108
00:03:58,879 --> 00:04:00,879
probably shouldn't have done it but at

109
00:04:00,879 --> 00:04:01,840
the time

110
00:04:01,840 --> 00:04:03,519
you know the

111
00:04:03,519 --> 00:04:05,120
indian government said hey if somebody

112
00:04:05,120 --> 00:04:07,280
can breach this system

113
00:04:07,280 --> 00:04:09,360
i'll be surprised the internet never

114
00:04:09,360 --> 00:04:11,280
disappoints so two hours later every

115
00:04:11,280 --> 00:04:14,400
single person had their account dumped

116
00:04:14,400 --> 00:04:15,280
so

117
00:04:15,280 --> 00:04:19,199
don't be don't be pompous

118
00:04:19,358 --> 00:04:22,000
so let's talk about canary and

119
00:04:22,000 --> 00:04:24,160
who i'm representing you know i'm i'm a

120
00:04:24,160 --> 00:04:26,720
authorized partner of canary so i don't

121
00:04:26,720 --> 00:04:28,960
actually work for canary i've just over

122
00:04:28,960 --> 00:04:30,560
the years

123
00:04:30,560 --> 00:04:33,120
contributed talked to them researched a

124
00:04:33,120 --> 00:04:34,320
lot of this and they've supported me

125
00:04:34,320 --> 00:04:36,479
along the way they're it's a company out

126
00:04:36,479 --> 00:04:38,000
of south africa

127
00:04:38,000 --> 00:04:40,080
uh cape town and they're just an

128
00:04:40,080 --> 00:04:42,080
extraordinary group of people and they

129
00:04:42,080 --> 00:04:44,240
developed this whole idea of canary in

130
00:04:44,240 --> 00:04:45,440
the code mine

131
00:04:45,440 --> 00:04:46,960
though it's no longer cold to use

132
00:04:46,960 --> 00:04:50,160
canaries since 1986 you know that's when

133
00:04:50,160 --> 00:04:52,320
british miners stop stopped using actual

134
00:04:52,320 --> 00:04:53,360
birds

135
00:04:53,360 --> 00:04:54,960
we can use them all over our networks

136
00:04:54,960 --> 00:04:56,560
and in our code

137
00:04:56,560 --> 00:04:57,440
and

138
00:04:57,440 --> 00:04:59,360
the way they refer to canaries is you

139
00:04:59,360 --> 00:05:01,120
have birds which are traditionally honey

140
00:05:01,120 --> 00:05:03,600
pots and then you have tokens they call

141
00:05:03,600 --> 00:05:04,880
them canary tokens which are honey

142
00:05:04,880 --> 00:05:06,400
tokens

143
00:05:06,400 --> 00:05:09,039
the birds they can be anything from a

144
00:05:09,039 --> 00:05:10,880
smart fridge to a dumb terminal or a

145
00:05:10,880 --> 00:05:13,280
database server or scada system

146
00:05:13,280 --> 00:05:14,800
and they look real and they're designed

147
00:05:14,800 --> 00:05:16,000
to entice

148
00:05:16,000 --> 00:05:18,080
bad actors to do stupid things and lead

149
00:05:18,080 --> 00:05:19,440
them down this path

150
00:05:19,440 --> 00:05:21,120
and then you have tokens and this is

151
00:05:21,120 --> 00:05:23,039
where people can start deploying these

152
00:05:23,039 --> 00:05:25,400
now there's a free service from thinx

153
00:05:25,400 --> 00:05:27,919
canarytokens.org you can generate any

154
00:05:27,919 --> 00:05:31,199
number of tokens like word documents

155
00:05:31,199 --> 00:05:34,080
slack keys api keys from aws

156
00:05:34,080 --> 00:05:36,080
and the whole point of this is we want

157
00:05:36,080 --> 00:05:37,280
early warning

158
00:05:37,280 --> 00:05:38,960
from these canaries that a breach is

159
00:05:38,960 --> 00:05:40,479
happening we want to know

160
00:05:40,479 --> 00:05:42,000
at the time of the breach

161
00:05:42,000 --> 00:05:45,919
not 212 days later when it's too late

162
00:05:46,160 --> 00:05:48,000
so i'm going to talk to you now about

163
00:05:48,000 --> 00:05:50,400
birds and honey pots so the bird's the

164
00:05:50,400 --> 00:05:52,960
word

165
00:05:52,960 --> 00:05:54,080
all right

166
00:05:54,080 --> 00:05:54,880
so

167
00:05:54,880 --> 00:05:56,960
from the window to the lulls i mean if

168
00:05:56,960 --> 00:05:58,400
any of you like littlejohn you'll

169
00:05:58,400 --> 00:05:59,759
appreciate this

170
00:05:59,759 --> 00:06:01,440
but

171
00:06:01,440 --> 00:06:03,680
let's talk about windows microsoft's

172
00:06:03,680 --> 00:06:05,520
active directory

173
00:06:05,520 --> 00:06:07,360
you know active directory most

174
00:06:07,360 --> 00:06:08,720
organizations that have been around for

175
00:06:08,720 --> 00:06:11,520
a while use it you manage users

176
00:06:11,520 --> 00:06:14,160
passwords files

177
00:06:14,160 --> 00:06:15,919
so it's really attractive target if you

178
00:06:15,919 --> 00:06:17,840
can compromise active directory you can

179
00:06:17,840 --> 00:06:19,440
typically take over

180
00:06:19,440 --> 00:06:21,280
the entire network

181
00:06:21,280 --> 00:06:23,440
so we can lower people in

182
00:06:23,440 --> 00:06:26,000
with a bird that acts looks and chirps

183
00:06:26,000 --> 00:06:28,000
like a domain controller and if any of

184
00:06:28,000 --> 00:06:31,039
you remember the microsoft binbows meme

185
00:06:31,039 --> 00:06:32,960
it was a japanese computer hardware

186
00:06:32,960 --> 00:06:34,560
store and there was actually a version

187
00:06:34,560 --> 00:06:36,160
of windows that came out called

188
00:06:36,160 --> 00:06:37,360
microsoft

189
00:06:37,360 --> 00:06:40,000
bimbos and all i had was notepad sticky

190
00:06:40,000 --> 00:06:42,080
notes and calculator so from a security

191
00:06:42,080 --> 00:06:43,520
perspective it had a minimal attack

192
00:06:43,520 --> 00:06:45,360
surface but

193
00:06:45,360 --> 00:06:46,800
our our bird is going to look a lot more

194
00:06:46,800 --> 00:06:49,120
legitimate and for

195
00:06:49,120 --> 00:06:51,199
people out there that know nmap tried

196
00:06:51,199 --> 00:06:52,160
and true

197
00:06:52,160 --> 00:06:53,680
tool for

198
00:06:53,680 --> 00:06:55,280
scanning ports and doing service

199
00:06:55,280 --> 00:06:57,919
enumeration so here's just the output

200
00:06:57,919 --> 00:06:59,919
when i run an end map scan

201
00:06:59,919 --> 00:07:01,680
of my bird and i'm targeting certain

202
00:07:01,680 --> 00:07:03,039
ports that i know windows domain

203
00:07:03,039 --> 00:07:04,560
controller runs on

204
00:07:04,560 --> 00:07:05,360
like

205
00:07:05,360 --> 00:07:09,120
ftp ssh you know iis

206
00:07:09,120 --> 00:07:10,479
you can see

207
00:07:10,479 --> 00:07:12,160
the amount of detail

208
00:07:12,160 --> 00:07:13,599
and realism in the service

209
00:07:13,599 --> 00:07:15,759
identification like

210
00:07:15,759 --> 00:07:17,039
port 80

211
00:07:17,039 --> 00:07:18,960
you know microsoft internet information

212
00:07:18,960 --> 00:07:21,360
services looks authentic then you get

213
00:07:21,360 --> 00:07:24,400
down to like port 88 it even shows you

214
00:07:24,400 --> 00:07:26,319
what looks to be an ostensibly

215
00:07:26,319 --> 00:07:28,160
legitimate domain

216
00:07:28,160 --> 00:07:29,120
that i'm

217
00:07:29,120 --> 00:07:31,120
thinks.com is a real site

218
00:07:31,120 --> 00:07:34,160
similarly you get to port 389

219
00:07:34,160 --> 00:07:36,080
and 636 which are common for

220
00:07:36,080 --> 00:07:37,440
authentication

221
00:07:37,440 --> 00:07:38,880
same deal it says

222
00:07:38,880 --> 00:07:40,960
connected to domain you'd be

223
00:07:40,960 --> 00:07:42,160
hard-pressed to tell the difference

224
00:07:42,160 --> 00:07:43,440
between this

225
00:07:43,440 --> 00:07:45,440
and a real domain controller

226
00:07:45,440 --> 00:07:46,960
and then the beauty in this is when

227
00:07:46,960 --> 00:07:48,720
somebody starts targeting

228
00:07:48,720 --> 00:07:50,400
this domain controller

229
00:07:50,400 --> 00:07:52,319
the lights lights up your christmas tree

230
00:07:52,319 --> 00:07:54,639
no need to do it yourself this year but

231
00:07:54,639 --> 00:07:56,000
if you look

232
00:07:56,000 --> 00:07:57,440
on the left side

233
00:07:57,440 --> 00:07:58,960
this is a collection of alerts that are

234
00:07:58,960 --> 00:08:01,840
generated not only does it aggregate

235
00:08:01,840 --> 00:08:03,759
the port scans but if somebody tries to

236
00:08:03,759 --> 00:08:06,479
log in to your web server that's bogus

237
00:08:06,479 --> 00:08:07,919
it'll actually capture the username and

238
00:08:07,919 --> 00:08:10,800
password or the sql server so it'll help

239
00:08:10,800 --> 00:08:13,360
you identify how sophisticated they are

240
00:08:13,360 --> 00:08:16,000
and um and if you're being targeted

241
00:08:16,000 --> 00:08:18,639
and you can also see um in the bottom

242
00:08:18,639 --> 00:08:19,440
right

243
00:08:19,440 --> 00:08:21,360
there's a lot of alerting endpoints for

244
00:08:21,360 --> 00:08:23,919
canary this is slack particularly but

245
00:08:23,919 --> 00:08:27,280
you can send emails sms

246
00:08:27,280 --> 00:08:30,720
pagerduty you can create jira tickets

247
00:08:30,720 --> 00:08:31,680
it's

248
00:08:31,680 --> 00:08:33,599
it's very flexible

249
00:08:33,599 --> 00:08:36,399
and super powerful

250
00:08:36,399 --> 00:08:38,240
but i did want to talk to you

251
00:08:38,240 --> 00:08:39,599
about

252
00:08:39,599 --> 00:08:41,440
ted stevens and the fact that he was

253
00:08:41,440 --> 00:08:43,360
right the internet's not a big truck he

254
00:08:43,360 --> 00:08:45,839
said it's a series of tubes not really

255
00:08:45,839 --> 00:08:47,920
but it is mostly noise and and if you

256
00:08:47,920 --> 00:08:48,880
want to

257
00:08:48,880 --> 00:08:50,240
look at

258
00:08:50,240 --> 00:08:52,160
outside birds which are really

259
00:08:52,160 --> 00:08:54,160
researched honey pots traditionally

260
00:08:54,160 --> 00:08:55,279
these are the ones that have been around

261
00:08:55,279 --> 00:08:56,959
for 20 years before

262
00:08:56,959 --> 00:08:58,880
things came around and found a better

263
00:08:58,880 --> 00:09:01,360
way to do it you can automate contextual

264
00:09:01,360 --> 00:09:03,600
analysis and you can gather

265
00:09:03,600 --> 00:09:05,519
ips with this outside bird and it

266
00:09:05,519 --> 00:09:07,279
doesn't alert you for every

267
00:09:07,279 --> 00:09:09,279
event but it does aggregate

268
00:09:09,279 --> 00:09:11,600
ips and it's amazing how scary and weird

269
00:09:11,600 --> 00:09:13,040
the internet is but

270
00:09:13,040 --> 00:09:14,640
you send these ips through a service

271
00:09:14,640 --> 00:09:16,160
like grey noise and the beauty and grey

272
00:09:16,160 --> 00:09:18,959
noise is it filters out everything other

273
00:09:18,959 --> 00:09:20,800
than stuff you should focus on so if

274
00:09:20,800 --> 00:09:22,560
there's malicious traffic

275
00:09:22,560 --> 00:09:25,360
from china it tells you it's malicious

276
00:09:25,360 --> 00:09:27,680
it's known that it's a scanner or botnet

277
00:09:27,680 --> 00:09:29,519
or it's part of a content delivery

278
00:09:29,519 --> 00:09:32,080
network or aws so you don't care about

279
00:09:32,080 --> 00:09:33,839
that what you really care about are the

280
00:09:33,839 --> 00:09:35,839
unknowns there so this can save you

281
00:09:35,839 --> 00:09:38,160
countless hours for the extra curious

282
00:09:38,160 --> 00:09:40,640
people that want to still do traditional

283
00:09:40,640 --> 00:09:42,880
research and use honey pots you can

284
00:09:42,880 --> 00:09:44,480
configure outside birds with canary

285
00:09:44,480 --> 00:09:46,160
which is pretty cool

286
00:09:46,160 --> 00:09:48,720
and then another great integration

287
00:09:48,720 --> 00:09:50,720
that's built in you can rumble and

288
00:09:50,720 --> 00:09:53,120
tumble through that asset jungle jordan

289
00:09:53,120 --> 00:09:54,720
i mean canarian

290
00:09:54,720 --> 00:09:56,959
things go together like george foreman

291
00:09:56,959 --> 00:09:59,839
and grilled chicken and

292
00:09:59,839 --> 00:10:01,360
the beauty in this

293
00:10:01,360 --> 00:10:03,040
is you can start building a whole asset

294
00:10:03,040 --> 00:10:06,640
inventory from any ips that your tokens

295
00:10:06,640 --> 00:10:08,800
trigger and the point in this is you can

296
00:10:08,800 --> 00:10:11,200
determine is this a known asset of mine

297
00:10:11,200 --> 00:10:12,079
or

298
00:10:12,079 --> 00:10:14,160
is this something that's unknown and if

299
00:10:14,160 --> 00:10:15,600
something you don't have is triggering

300
00:10:15,600 --> 00:10:17,440
alerts

301
00:10:17,440 --> 00:10:19,600
could be compromised so you could then

302
00:10:19,600 --> 00:10:20,800
throw that in the gray noise and

303
00:10:20,800 --> 00:10:22,079
correlate it

304
00:10:22,079 --> 00:10:24,240
and it's super cool if you guys know hd

305
00:10:24,240 --> 00:10:26,560
more you know metasploit this is his

306
00:10:26,560 --> 00:10:27,600
company

307
00:10:27,600 --> 00:10:28,560
and

308
00:10:28,560 --> 00:10:30,720
incredibly powerful tool written in go

309
00:10:30,720 --> 00:10:33,519
so it's super fast and free i highly

310
00:10:33,519 --> 00:10:35,920
recommend it

311
00:10:35,920 --> 00:10:38,320
it's tokens all the way down now that we

312
00:10:38,320 --> 00:10:39,760
now that we've talked about birds and

313
00:10:39,760 --> 00:10:41,519
honey pots i'm going to talk to you

314
00:10:41,519 --> 00:10:42,880
about

315
00:10:42,880 --> 00:10:44,399
tokens and all the cool things you can

316
00:10:44,399 --> 00:10:46,240
do with them

317
00:10:46,240 --> 00:10:48,720
if there's any chris farley black sheep

318
00:10:48,720 --> 00:10:50,800
fans out there

319
00:10:50,800 --> 00:10:52,959
this is a scene from that i love that

320
00:10:52,959 --> 00:10:54,880
movie rest in peace but we're going to

321
00:10:54,880 --> 00:10:56,880
talk about some reconnaissance

322
00:10:56,880 --> 00:11:00,720
and enumeration tokens first

323
00:11:00,720 --> 00:11:03,200
so dns

324
00:11:03,200 --> 00:11:05,040
domain name system for those that don't

325
00:11:05,040 --> 00:11:08,480
know when you type in google or rv sec

326
00:11:08,480 --> 00:11:10,720
behind the scenes it's translating all

327
00:11:10,720 --> 00:11:12,560
of that to internet protocol addresses

328
00:11:12,560 --> 00:11:13,680
you don't need to know how to route

329
00:11:13,680 --> 00:11:14,399
traffic

330
00:11:14,399 --> 00:11:16,000
you just need to know how to

331
00:11:16,000 --> 00:11:17,519
find whatever you need to on the

332
00:11:17,519 --> 00:11:18,560
internet

333
00:11:18,560 --> 00:11:21,440
well we can use these dns canary tokens

334
00:11:21,440 --> 00:11:22,880
to create

335
00:11:22,880 --> 00:11:24,720
fictitious domain names

336
00:11:24,720 --> 00:11:26,320
and map these to what are called dark

337
00:11:26,320 --> 00:11:28,320
network segments these are networks

338
00:11:28,320 --> 00:11:30,320
created specifically for no reason at

339
00:11:30,320 --> 00:11:32,720
all except for this probably and there's

340
00:11:32,720 --> 00:11:34,079
nothing on there

341
00:11:34,079 --> 00:11:35,519
the whole point in this is somebody

342
00:11:35,519 --> 00:11:38,160
tries to enumerate these unused segments

343
00:11:38,160 --> 00:11:40,160
it'll resolve to these fake domain names

344
00:11:40,160 --> 00:11:42,480
and then start to fire an alert so

345
00:11:42,480 --> 00:11:43,920
it's pretty slick and one thing i want

346
00:11:43,920 --> 00:11:45,760
to point out in the bottom left

347
00:11:45,760 --> 00:11:47,160
when you do a query you get the

348
00:11:47,160 --> 00:11:49,040
canarytokens.com which is like pretty

349
00:11:49,040 --> 00:11:51,360
obvious if you actually like subscribe

350
00:11:51,360 --> 00:11:53,360
to their service you can customize the

351
00:11:53,360 --> 00:11:54,880
domain to be your own domain so it

352
00:11:54,880 --> 00:11:56,800
blends in you know it could be i think

353
00:11:56,800 --> 00:11:59,760
it's like docs.rvaseq.com

354
00:11:59,760 --> 00:12:01,519
so it wouldn't be evident

355
00:12:01,519 --> 00:12:03,360
immediately that you know they're being

356
00:12:03,360 --> 00:12:05,920
duped but even with dns one thing to

357
00:12:05,920 --> 00:12:07,519
point out for the technical people is

358
00:12:07,519 --> 00:12:09,360
like you're only going to get the ip

359
00:12:09,360 --> 00:12:11,200
address of the dns server that resolved

360
00:12:11,200 --> 00:12:13,760
it not the ip of the user but even with

361
00:12:13,760 --> 00:12:16,399
that it was able to determine this was

362
00:12:16,399 --> 00:12:18,560
originating in richmond virginia from

363
00:12:18,560 --> 00:12:20,639
cloudflare you know i use the one one

364
00:12:20,639 --> 00:12:22,959
one or one zero zero two

365
00:12:22,959 --> 00:12:24,880
dns server and so that's great for

366
00:12:24,880 --> 00:12:26,639
initial reconnaissance and people that

367
00:12:26,639 --> 00:12:29,200
might be inside your network

368
00:12:29,200 --> 00:12:32,000
and if we continue

369
00:12:32,000 --> 00:12:35,440
along the path of dns we can use this

370
00:12:35,440 --> 00:12:37,839
thing called web redirect tokens for all

371
00:12:37,839 --> 00:12:39,680
those nozi o'donnells out there that are

372
00:12:39,680 --> 00:12:41,200
trying to poke around

373
00:12:41,200 --> 00:12:42,959
and figure out what's happening

374
00:12:42,959 --> 00:12:45,760
on these subdomains

375
00:12:45,760 --> 00:12:47,120
what's really neat about this is you

376
00:12:47,120 --> 00:12:49,120
grab a ton of information

377
00:12:49,120 --> 00:12:51,200
really quickly so they'll hit the token

378
00:12:51,200 --> 00:12:53,519
in less than a second it'll flash by and

379
00:12:53,519 --> 00:12:56,240
redirect them to the actual site so for

380
00:12:56,240 --> 00:12:57,600
an example

381
00:12:57,600 --> 00:12:59,440
this domain thinks that i o

382
00:12:59,440 --> 00:13:01,519
that i transferred to things

383
00:13:01,519 --> 00:13:03,040
and it quickly flashes sends you the

384
00:13:03,040 --> 00:13:05,680
canary tokens then you end up in rva sec

385
00:13:05,680 --> 00:13:06,639
the

386
00:13:06,639 --> 00:13:08,800
map on the bottom left is really helpful

387
00:13:08,800 --> 00:13:10,480
too because it'll show you

388
00:13:10,480 --> 00:13:12,800
geographically where all these ips

389
00:13:12,800 --> 00:13:14,639
originating are from

390
00:13:14,639 --> 00:13:17,120
so you can correlate maybe there's some

391
00:13:17,120 --> 00:13:19,680
larger threat campaign or maybe there's

392
00:13:19,680 --> 00:13:21,200
something going on here rather than just

393
00:13:21,200 --> 00:13:23,279
random traffic and it also allows you to

394
00:13:23,279 --> 00:13:25,600
filter out like known

395
00:13:25,600 --> 00:13:27,839
search bots and crawlers and things like

396
00:13:27,839 --> 00:13:29,920
that and if you look at the right

397
00:13:29,920 --> 00:13:31,600
at some of the information

398
00:13:31,600 --> 00:13:33,440
and why is this important

399
00:13:33,440 --> 00:13:35,519
you know we wanna in this process start

400
00:13:35,519 --> 00:13:37,279
building a forensics trail

401
00:13:37,279 --> 00:13:40,320
and this is where it'll culminate based

402
00:13:40,320 --> 00:13:41,600
off all this information that you're

403
00:13:41,600 --> 00:13:43,920
gathering you can with a high degree of

404
00:13:43,920 --> 00:13:45,199
certainty

405
00:13:45,199 --> 00:13:47,440
de-anonymize most people because there's

406
00:13:47,440 --> 00:13:50,079
only so many people in richmond that run

407
00:13:50,079 --> 00:13:52,880
windows and firefox you know tons of

408
00:13:52,880 --> 00:13:54,959
places gather this information like

409
00:13:54,959 --> 00:13:56,639
valve's steam service and their hardware

410
00:13:56,639 --> 00:13:58,160
survey so if you need to do

411
00:13:58,160 --> 00:13:59,839
investigations

412
00:13:59,839 --> 00:14:01,519
this will help

413
00:14:01,519 --> 00:14:03,040
you know the cause with either third

414
00:14:03,040 --> 00:14:06,079
party company or the fbi it even tells

415
00:14:06,079 --> 00:14:06,800
you

416
00:14:06,800 --> 00:14:08,800
the version of windows

417
00:14:08,800 --> 00:14:10,720
you know the javascript or the mime

418
00:14:10,720 --> 00:14:11,680
types

419
00:14:11,680 --> 00:14:13,680
like lots of lots of good information

420
00:14:13,680 --> 00:14:15,279
just from this one token they haven't

421
00:14:15,279 --> 00:14:17,199
even been inside yet

422
00:14:17,199 --> 00:14:19,120
all right and there's also a really

423
00:14:19,120 --> 00:14:20,880
interesting token if there's any

424
00:14:20,880 --> 00:14:23,040
dodgeball fans out there

425
00:14:23,040 --> 00:14:24,959
the purpose of this token

426
00:14:24,959 --> 00:14:26,320
is to

427
00:14:26,320 --> 00:14:28,160
determine if somebody has cloned your

428
00:14:28,160 --> 00:14:30,240
website and it happens all the time but

429
00:14:30,240 --> 00:14:32,240
how would you know like and it's okay

430
00:14:32,240 --> 00:14:33,760
like there's tons of free tools to do

431
00:14:33,760 --> 00:14:36,000
this like ht track

432
00:14:36,000 --> 00:14:37,680
and you can clone the site locally or

433
00:14:37,680 --> 00:14:38,639
whatever

434
00:14:38,639 --> 00:14:41,199
but if somebody clones like thinks.com

435
00:14:41,199 --> 00:14:42,720
and deploys it on this bogus domain

436
00:14:42,720 --> 00:14:44,079
thinks that io you probably want to know

437
00:14:44,079 --> 00:14:46,720
about it because this has been

438
00:14:46,720 --> 00:14:48,240
helpful for actually sending cease and

439
00:14:48,240 --> 00:14:50,160
desist letters to get these domains

440
00:14:50,160 --> 00:14:52,880
taken down so i've seen this be highly

441
00:14:52,880 --> 00:14:54,959
effective and all you have to do is

442
00:14:54,959 --> 00:14:56,560
create the token it gives you like five

443
00:14:56,560 --> 00:14:59,199
lines of code that you can embed on your

444
00:14:59,199 --> 00:15:02,560
html pages and when you do it it fires

445
00:15:02,560 --> 00:15:05,279
an alert same deal you get your alert in

446
00:15:05,279 --> 00:15:06,959
your console

447
00:15:06,959 --> 00:15:09,360
slack any number of endpoints

448
00:15:09,360 --> 00:15:13,440
super cool helpful helpful token

449
00:15:13,440 --> 00:15:16,000
apis if you don't know what it means is

450
00:15:16,000 --> 00:15:18,880
alert protect investigate just ask bert

451
00:15:18,880 --> 00:15:21,760
macklin but for real this is

452
00:15:21,760 --> 00:15:23,600
this is api tokens

453
00:15:23,600 --> 00:15:24,959
let's talk about a few of those and what

454
00:15:24,959 --> 00:15:27,040
you can do

455
00:15:27,040 --> 00:15:28,880
many borah fans out there hopefully

456
00:15:28,880 --> 00:15:31,920
appreciate this but aws amazon web

457
00:15:31,920 --> 00:15:33,199
services

458
00:15:33,199 --> 00:15:34,639
this is a great

459
00:15:34,639 --> 00:15:38,240
token because everybody wants an aws key

460
00:15:38,240 --> 00:15:40,639
if you're a pen tester a bad guy a red

461
00:15:40,639 --> 00:15:41,680
teamer

462
00:15:41,680 --> 00:15:44,320
you one aws if you find a set of keys

463
00:15:44,320 --> 00:15:46,079
you're gonna be hard-pressed to not try

464
00:15:46,079 --> 00:15:47,120
and use them

465
00:15:47,120 --> 00:15:48,079
well

466
00:15:48,079 --> 00:15:50,240
you can drop these tokens like on every

467
00:15:50,240 --> 00:15:52,480
company laptop there's a

468
00:15:52,480 --> 00:15:55,199
pretty simple uh script i wrote that's

469
00:15:55,199 --> 00:15:58,480
on the canary utils site for for jim

470
00:15:58,480 --> 00:16:00,480
the endpoint management system and it'll

471
00:16:00,480 --> 00:16:03,279
just go and create a unique memo

472
00:16:03,279 --> 00:16:05,199
for the user and tell you like where

473
00:16:05,199 --> 00:16:06,959
this token's at that's one important

474
00:16:06,959 --> 00:16:09,120
thing to note make sure you use good

475
00:16:09,120 --> 00:16:11,199
descriptions because you might end up

476
00:16:11,199 --> 00:16:13,360
issuing thousands of tokens and if it

477
00:16:13,360 --> 00:16:15,040
just says token fired it's not going to

478
00:16:15,040 --> 00:16:17,279
be helpful so make sure you use like a

479
00:16:17,279 --> 00:16:19,279
meaningful description

480
00:16:19,279 --> 00:16:20,160
and

481
00:16:20,160 --> 00:16:21,680
what's really cool as well so you get

482
00:16:21,680 --> 00:16:23,360
the geographic information again you can

483
00:16:23,360 --> 00:16:24,720
start correlating

484
00:16:24,720 --> 00:16:26,320
where this may be happening and if

485
00:16:26,320 --> 00:16:27,759
there's a trend here

486
00:16:27,759 --> 00:16:29,759
but it also tells you the command that

487
00:16:29,759 --> 00:16:32,320
was run and so you can start to

488
00:16:32,320 --> 00:16:34,160
figure out the level of sophistication

489
00:16:34,160 --> 00:16:35,600
like if somebody gets a set of keys what

490
00:16:35,600 --> 00:16:37,040
are they going to do first they're

491
00:16:37,040 --> 00:16:38,560
probably going to run

492
00:16:38,560 --> 00:16:40,399
caller identity they might list some

493
00:16:40,399 --> 00:16:42,320
buckets but again you're building this

494
00:16:42,320 --> 00:16:44,480
kind of forensics trail and they don't

495
00:16:44,480 --> 00:16:45,759
even know it this is part of your threat

496
00:16:45,759 --> 00:16:46,880
hunting

497
00:16:46,880 --> 00:16:48,480
appeal

498
00:16:48,480 --> 00:16:51,120
built in

499
00:16:51,120 --> 00:16:53,839
and if we continue along the aws route

500
00:16:53,839 --> 00:16:56,480
there's another good bang for the bucket

501
00:16:56,480 --> 00:16:58,079
there is

502
00:16:58,079 --> 00:17:00,959
an aws simple storage service bucket

503
00:17:00,959 --> 00:17:04,400
token and s3 over the years has been

504
00:17:04,400 --> 00:17:05,919
pwned multiple times because people

505
00:17:05,919 --> 00:17:07,919
would accidentally like put sensitive

506
00:17:07,919 --> 00:17:09,599
information on buckets that were exposed

507
00:17:09,599 --> 00:17:10,799
to the world

508
00:17:10,799 --> 00:17:12,640
and all of that so i don't recommend

509
00:17:12,640 --> 00:17:15,359
creating a bucket that's world readable

510
00:17:15,359 --> 00:17:17,359
but the best use case for this

511
00:17:17,359 --> 00:17:19,199
is in your network because you can

512
00:17:19,199 --> 00:17:20,400
create

513
00:17:20,400 --> 00:17:23,039
a bucket like aetna

514
00:17:23,039 --> 00:17:25,359
baa phi or something that blends into

515
00:17:25,359 --> 00:17:27,039
your naming scheme

516
00:17:27,039 --> 00:17:29,840
and just the mere act of listing the

517
00:17:29,840 --> 00:17:30,960
buckets

518
00:17:30,960 --> 00:17:32,640
will fire an alert so it's almost

519
00:17:32,640 --> 00:17:34,880
impossible to not trip over this token

520
00:17:34,880 --> 00:17:36,960
and you can you can even

521
00:17:36,960 --> 00:17:39,840
issue a fake set of aws keys and then

522
00:17:39,840 --> 00:17:42,160
create a fake bucket in that account and

523
00:17:42,160 --> 00:17:43,360
so you get

524
00:17:43,360 --> 00:17:44,720
double alerting

525
00:17:44,720 --> 00:17:46,640
and you can see from the alert on the

526
00:17:46,640 --> 00:17:47,600
right

527
00:17:47,600 --> 00:17:50,080
not only are you getting the ip address

528
00:17:50,080 --> 00:17:51,360
you're getting

529
00:17:51,360 --> 00:17:53,600
the type of request the user that made

530
00:17:53,600 --> 00:17:56,000
the request

531
00:17:56,000 --> 00:17:58,000
and you're getting the user agent which

532
00:17:58,000 --> 00:17:59,919
has all kinds of good information so

533
00:17:59,919 --> 00:18:01,440
this was actually run

534
00:18:01,440 --> 00:18:04,080
with the boto3

535
00:18:04,080 --> 00:18:06,799
sdk on linux and you can tell kind of

536
00:18:06,799 --> 00:18:07,760
from the

537
00:18:07,760 --> 00:18:09,679
bottom i mean there's a couple methods

538
00:18:09,679 --> 00:18:11,360
that i use to access it but really where

539
00:18:11,360 --> 00:18:14,960
it says aws sdk java linux that's

540
00:18:14,960 --> 00:18:17,039
that's where it tells you

541
00:18:17,039 --> 00:18:19,520
what's going on there

542
00:18:19,520 --> 00:18:20,640
and then

543
00:18:20,640 --> 00:18:24,240
this is just a fun slide i had i had a

544
00:18:24,240 --> 00:18:26,240
good time with this if anyone remembers

545
00:18:26,240 --> 00:18:28,559
exhibits pimp my ride you can apply his

546
00:18:28,559 --> 00:18:31,520
logic to slack or aws

547
00:18:31,520 --> 00:18:33,679
and you can get super meta

548
00:18:33,679 --> 00:18:36,160
do things like drops draw drop slack

549
00:18:36,160 --> 00:18:38,400
tokens in your slack space

550
00:18:38,400 --> 00:18:40,240
so by the time they realize

551
00:18:40,240 --> 00:18:41,600
they've been duped they're going to have

552
00:18:41,600 --> 00:18:43,520
to go back to myspace and someone called

553
00:18:43,520 --> 00:18:44,960
steve austin is going to give you a

554
00:18:44,960 --> 00:18:47,280
stunner no but you can drop these also

555
00:18:47,280 --> 00:18:49,200
in your code repositories

556
00:18:49,200 --> 00:18:51,440
on people's laptops anyone that's in

557
00:18:51,440 --> 00:18:52,400
slack

558
00:18:52,400 --> 00:18:53,919
that's reading public channels all they

559
00:18:53,919 --> 00:18:56,720
have to do is search for xoxp or xoxp

560
00:18:56,720 --> 00:18:58,559
which is a bot token they're going to

561
00:18:58,559 --> 00:19:00,240
find this juicy nugget and they're going

562
00:19:00,240 --> 00:19:01,679
to try and use it doesn't have any

563
00:19:01,679 --> 00:19:03,360
permissions but

564
00:19:03,360 --> 00:19:06,799
yeah it's they're going to get stunned

565
00:19:06,799 --> 00:19:07,520
and

566
00:19:07,520 --> 00:19:09,520
kind of the last

567
00:19:09,520 --> 00:19:12,320
api token you know as an example

568
00:19:12,320 --> 00:19:14,400
is uh kubernetes token

569
00:19:14,400 --> 00:19:17,280
and kubernetes is a google

570
00:19:17,280 --> 00:19:20,640
invention and it's just it's k8 is what

571
00:19:20,640 --> 00:19:22,880
people refer to it it's just k eight

572
00:19:22,880 --> 00:19:26,000
letters s pretty cool uh and the whole

573
00:19:26,000 --> 00:19:27,600
point of kubernetes without getting into

574
00:19:27,600 --> 00:19:29,360
too much detail it's a way to manage

575
00:19:29,360 --> 00:19:30,960
like thousands and thousands of

576
00:19:30,960 --> 00:19:33,600
applications and orchestrate

577
00:19:33,600 --> 00:19:36,480
um you know activity quickly and it's a

578
00:19:36,480 --> 00:19:39,280
whole big wonderful mess but it's lovely

579
00:19:39,280 --> 00:19:40,640
and this is going to bring the bums to

580
00:19:40,640 --> 00:19:42,720
the jar and if you start to

581
00:19:42,720 --> 00:19:44,640
similarly apply this logic and write a

582
00:19:44,640 --> 00:19:46,960
script to deploy like a kubernetes token

583
00:19:46,960 --> 00:19:48,400
on everyone's machine

584
00:19:48,400 --> 00:19:50,000
it'll tell you

585
00:19:50,000 --> 00:19:51,360
okay what's the end point they hit in

586
00:19:51,360 --> 00:19:54,000
kubernetes api also what's the user

587
00:19:54,000 --> 00:19:56,240
agent so if they're stupid and keep

588
00:19:56,240 --> 00:19:57,520
running all these tokens on their own

589
00:19:57,520 --> 00:19:58,640
machine you're going to gather more and

590
00:19:58,640 --> 00:20:00,799
more information forensically that's

591
00:20:00,799 --> 00:20:02,720
going to help you

592
00:20:02,720 --> 00:20:04,080
as you start to layer these tokens

593
00:20:04,080 --> 00:20:06,559
together

594
00:20:06,559 --> 00:20:08,480
all right well

595
00:20:08,480 --> 00:20:10,799
let's talk about some device specific

596
00:20:10,799 --> 00:20:13,280
tokens and these are ones that everyone

597
00:20:13,280 --> 00:20:14,799
here can apply

598
00:20:14,799 --> 00:20:17,360
right now and i recommend you do for a

599
00:20:17,360 --> 00:20:19,440
couple of reasons

600
00:20:19,440 --> 00:20:20,880
so first off

601
00:20:20,880 --> 00:20:23,200
you've got this uh wire guard

602
00:20:23,200 --> 00:20:25,679
token wire guard is like a new

603
00:20:25,679 --> 00:20:29,120
uh faster version of openvpn it's

604
00:20:29,120 --> 00:20:30,640
used by a lot of companies commercially

605
00:20:30,640 --> 00:20:31,840
and otherwise

606
00:20:31,840 --> 00:20:34,000
and what you can do with this token is

607
00:20:34,000 --> 00:20:35,360
you can create

608
00:20:35,360 --> 00:20:38,080
a vpn profile and you can call it rva

609
00:20:38,080 --> 00:20:41,919
sec private vpn or something attractive

610
00:20:41,919 --> 00:20:43,919
the idea here is if your phone gets

611
00:20:43,919 --> 00:20:46,240
compromised and it happens a lot if you

612
00:20:46,240 --> 00:20:49,120
look at last year with nso group and the

613
00:20:49,120 --> 00:20:51,679
pegasus spyware it was super insidious

614
00:20:51,679 --> 00:20:52,880
because the only way you'd know if your

615
00:20:52,880 --> 00:20:54,400
phone was compromised

616
00:20:54,400 --> 00:20:56,880
is if you did forensics so this is like

617
00:20:56,880 --> 00:20:59,600
a quick mechanism to detect like okay

618
00:20:59,600 --> 00:21:01,440
somebody's pulled my iphone

619
00:21:01,440 --> 00:21:03,360
and it's pretty simple you scan the qr

620
00:21:03,360 --> 00:21:04,400
code

621
00:21:04,400 --> 00:21:07,440
somebody enables it fires a slack alert

622
00:21:07,440 --> 00:21:08,880
tells you everything

623
00:21:08,880 --> 00:21:10,159
you need to know you should probably

624
00:21:10,159 --> 00:21:12,240
burn it go get yourself a motorola flip

625
00:21:12,240 --> 00:21:15,679
phone or something that is dumb because

626
00:21:15,679 --> 00:21:17,760
this isn't good

627
00:21:17,760 --> 00:21:18,799
and

628
00:21:18,799 --> 00:21:21,120
you can you should scan this qr code

629
00:21:21,120 --> 00:21:23,760
because if you'd like to

630
00:21:23,760 --> 00:21:25,280
or you don't need to but it's it's

631
00:21:25,280 --> 00:21:28,880
legitimate and qr codes really

632
00:21:28,880 --> 00:21:30,960
they go back a long time but they they

633
00:21:30,960 --> 00:21:32,880
certainly took off during

634
00:21:32,880 --> 00:21:35,280
the pandemic you know with things like

635
00:21:35,280 --> 00:21:37,360
toast and some people just love scanning

636
00:21:37,360 --> 00:21:38,640
qr codes

637
00:21:38,640 --> 00:21:39,919
but the whole idea here and where this

638
00:21:39,919 --> 00:21:41,280
can be useful

639
00:21:41,280 --> 00:21:43,200
is you can drop some emails

640
00:21:43,200 --> 00:21:45,360
unread that are hidden from all your

641
00:21:45,360 --> 00:21:47,679
employees with some headline like

642
00:21:47,679 --> 00:21:50,080
multi-factor device enrollment code

643
00:21:50,080 --> 00:21:52,080
bogus code but when they scan it

644
00:21:52,080 --> 00:21:54,240
similarly it'll fire an alert

645
00:21:54,240 --> 00:21:55,840
and you know then you're going to know

646
00:21:55,840 --> 00:21:57,600
someone's up to no good you could also

647
00:21:57,600 --> 00:22:00,159
print this out and put new wi-fi

648
00:22:00,159 --> 00:22:02,559
password but you probably don't push out

649
00:22:02,559 --> 00:22:03,760
your watch you probably push out your

650
00:22:03,760 --> 00:22:07,039
wi-fi securely like within tuner jam if

651
00:22:07,039 --> 00:22:08,320
you're doing it right

652
00:22:08,320 --> 00:22:09,760
and so the only people that are going to

653
00:22:09,760 --> 00:22:11,679
think you have a new wi-fi password are

654
00:22:11,679 --> 00:22:13,679
the punks that are inside trying to get

655
00:22:13,679 --> 00:22:15,840
access so there's a lot of different use

656
00:22:15,840 --> 00:22:19,039
cases and this is just one

657
00:22:19,039 --> 00:22:21,760
okay and this is where it gets fun

658
00:22:21,760 --> 00:22:24,320
and it's a bit trippy but this is the

659
00:22:24,320 --> 00:22:25,919
the part of the tokens where it's all

660
00:22:25,919 --> 00:22:26,880
about

661
00:22:26,880 --> 00:22:28,799
information warfare

662
00:22:28,799 --> 00:22:30,480
and really messing with the adversaries

663
00:22:30,480 --> 00:22:32,559
because if they've gotten to this point

664
00:22:32,559 --> 00:22:34,559
it's time to just mess with them and

665
00:22:34,559 --> 00:22:35,760
kind of give them the sense that you're

666
00:22:35,760 --> 00:22:38,840
on to them and it's time to like get out

667
00:22:38,840 --> 00:22:42,480
uh so we can start with this databases

668
00:22:42,480 --> 00:22:44,559
get it the data base sickly is asked to

669
00:22:44,559 --> 00:22:47,360
be dumped but you can create a

670
00:22:47,360 --> 00:22:50,080
token like a mysql token

671
00:22:50,080 --> 00:22:52,080
call it something cool like nft payments

672
00:22:52,080 --> 00:22:53,280
table or

673
00:22:53,280 --> 00:22:54,640
you know

674
00:22:54,640 --> 00:22:56,720
credit card backup something

675
00:22:56,720 --> 00:22:58,960
that looks legitimate and just fill it

676
00:22:58,960 --> 00:23:00,559
with gibberish or actually it does it

677
00:23:00,559 --> 00:23:02,400
for you but you can insert

678
00:23:02,400 --> 00:23:05,919
any number of things that look real

679
00:23:05,919 --> 00:23:07,039
and

680
00:23:07,039 --> 00:23:08,799
somebody accesses it you know starts

681
00:23:08,799 --> 00:23:10,400
trying to run database commands or just

682
00:23:10,400 --> 00:23:12,240
imports the database

683
00:23:12,240 --> 00:23:14,799
you're gonna get an alert similarly um

684
00:23:14,799 --> 00:23:16,880
you'll get your email however number of

685
00:23:16,880 --> 00:23:18,559
endpoints you want and the one thing

686
00:23:18,559 --> 00:23:19,919
i'll say about

687
00:23:19,919 --> 00:23:22,159
canary that i didn't mention earlier is

688
00:23:22,159 --> 00:23:24,000
the whole point is to have a low volume

689
00:23:24,000 --> 00:23:26,400
of these alerts and so

690
00:23:26,400 --> 00:23:28,000
you don't necessarily

691
00:23:28,000 --> 00:23:29,200
want to be

692
00:23:29,200 --> 00:23:31,440
sending emails or slacks for everything

693
00:23:31,440 --> 00:23:32,720
but you can

694
00:23:32,720 --> 00:23:35,600
designate specific tokens of high value

695
00:23:35,600 --> 00:23:37,280
and only send those to pagerduty right

696
00:23:37,280 --> 00:23:38,480
because that's the intent the page of

697
00:23:38,480 --> 00:23:40,559
duty is like something bad's going off

698
00:23:40,559 --> 00:23:43,520
similar to the pager but other ones like

699
00:23:43,520 --> 00:23:44,720
when you're doing the reconnaissance

700
00:23:44,720 --> 00:23:45,679
stuff you're going to get a lot of

701
00:23:45,679 --> 00:23:48,559
people that are like trying to hit your

702
00:23:48,559 --> 00:23:50,400
domain you know i think when i deployed

703
00:23:50,400 --> 00:23:52,880
things that i owe there were like 114

704
00:23:52,880 --> 00:23:54,880
hits an hour roughly if people that just

705
00:23:54,880 --> 00:23:56,640
thought this was legitimate that's a lot

706
00:23:56,640 --> 00:23:57,760
of alerts

707
00:23:57,760 --> 00:23:59,840
so you can set up your alerts

708
00:23:59,840 --> 00:24:01,840
accordingly carry has this thing called

709
00:24:01,840 --> 00:24:04,960
flocks and so on and so forth

710
00:24:04,960 --> 00:24:06,480
uh

711
00:24:06,480 --> 00:24:08,000
what if i told you

712
00:24:08,000 --> 00:24:09,840
conspiracy theories are conspiracy

713
00:24:09,840 --> 00:24:11,679
realities well if you

714
00:24:11,679 --> 00:24:14,159
conspiracy keanu happens to be mucking

715
00:24:14,159 --> 00:24:15,600
around he's going to see something that

716
00:24:15,600 --> 00:24:16,559
looks

717
00:24:16,559 --> 00:24:18,320
quite tantalizing like executive

718
00:24:18,320 --> 00:24:20,080
compensation plan

719
00:24:20,080 --> 00:24:21,360
or

720
00:24:21,360 --> 00:24:23,600
go to market strategy and you can use

721
00:24:23,600 --> 00:24:25,520
this as an opportunity

722
00:24:25,520 --> 00:24:27,279
to educate

723
00:24:27,279 --> 00:24:28,559
and

724
00:24:28,559 --> 00:24:30,480
you know terrorize but you know you can

725
00:24:30,480 --> 00:24:33,200
drop something in there about operation

726
00:24:33,200 --> 00:24:35,679
uh northwoods right where the

727
00:24:35,679 --> 00:24:38,240
government was considering attacking

728
00:24:38,240 --> 00:24:40,320
u.s cities to galvanize support for

729
00:24:40,320 --> 00:24:43,279
invading cuba or harp you know where

730
00:24:43,279 --> 00:24:45,039
allegedly the weather is being

731
00:24:45,039 --> 00:24:47,919
controlled by you know the navy or

732
00:24:47,919 --> 00:24:50,720
whatever or mk ultra

733
00:24:50,720 --> 00:24:52,880
which was fascinating and

734
00:24:52,880 --> 00:24:55,760
kind of surreal but yeah it happened so

735
00:24:55,760 --> 00:24:56,799
at this point they're probably going to

736
00:24:56,799 --> 00:24:58,960
be freaking out and being like what's

737
00:24:58,960 --> 00:25:00,960
going on and

738
00:25:00,960 --> 00:25:03,120
they'll probably go the other way

739
00:25:03,120 --> 00:25:05,279
and if not there's a really cool service

740
00:25:05,279 --> 00:25:06,559
called bittrap

741
00:25:06,559 --> 00:25:07,919
and they just launch

742
00:25:07,919 --> 00:25:09,600
and what they do is they pay out bug

743
00:25:09,600 --> 00:25:12,159
bounties in different amounts as you get

744
00:25:12,159 --> 00:25:13,840
further and further than the network so

745
00:25:13,840 --> 00:25:15,840
at this point maybe open the document

746
00:25:15,840 --> 00:25:16,960
you're like hey you're here we know

747
00:25:16,960 --> 00:25:18,720
you're here if you leave now

748
00:25:18,720 --> 00:25:20,400
we'll give you a thousand dollars if you

749
00:25:20,400 --> 00:25:21,200
stay

750
00:25:21,200 --> 00:25:22,720
you should be aware of these potential

751
00:25:22,720 --> 00:25:24,640
consequences so

752
00:25:24,640 --> 00:25:26,960
it's a really neat concept and they just

753
00:25:26,960 --> 00:25:28,400
partnered with thinx

754
00:25:28,400 --> 00:25:30,880
and it's brilliant

755
00:25:30,880 --> 00:25:31,919
and

756
00:25:31,919 --> 00:25:35,279
i'm obsessed with db cooper um because

757
00:25:35,279 --> 00:25:38,000
nobody knows what really happened and

758
00:25:38,000 --> 00:25:40,400
you know this this whole

759
00:25:40,400 --> 00:25:42,720
you know spread some bull sheets the

760
00:25:42,720 --> 00:25:44,080
whole point here

761
00:25:44,080 --> 00:25:46,400
is like again make something that sounds

762
00:25:46,400 --> 00:25:49,840
attractive like project db cooper

763
00:25:49,840 --> 00:25:52,320
nft financial prospectus whatever that

764
00:25:52,320 --> 00:25:55,120
means somebody opens it you could drop

765
00:25:55,120 --> 00:25:56,400
all kinds of gibberish you can make it

766
00:25:56,400 --> 00:25:58,799
look as authentic as you want in this

767
00:25:58,799 --> 00:26:00,640
case i just kind of grabbed some

768
00:26:00,640 --> 00:26:03,600
information the fbi sadly closed this

769
00:26:03,600 --> 00:26:06,240
case and i asked our fbi friends last

770
00:26:06,240 --> 00:26:08,320
night what the situation is and

771
00:26:08,320 --> 00:26:09,919
they said they get that question a lot

772
00:26:09,919 --> 00:26:12,240
and there's no other information but uh

773
00:26:12,240 --> 00:26:14,400
you know maybe this adversary opens this

774
00:26:14,400 --> 00:26:17,039
thing and goes on on a wild tangent and

775
00:26:17,039 --> 00:26:18,799
leaves your network i mean either way

776
00:26:18,799 --> 00:26:20,799
you're going to confuse and

777
00:26:20,799 --> 00:26:22,880
and you know send them down a different

778
00:26:22,880 --> 00:26:24,880
path and that's the whole whole point is

779
00:26:24,880 --> 00:26:27,600
to get them to leave

780
00:26:27,600 --> 00:26:29,840
and then all of this

781
00:26:29,840 --> 00:26:32,400
culminates in what i call

782
00:26:32,400 --> 00:26:35,039
deception inception

783
00:26:35,039 --> 00:26:36,960
for better breach detection and i want

784
00:26:36,960 --> 00:26:38,559
to walk you through one example of how

785
00:26:38,559 --> 00:26:40,000
you can layer

786
00:26:40,000 --> 00:26:42,320
all these different tokens together

787
00:26:42,320 --> 00:26:44,400
and in the process

788
00:26:44,400 --> 00:26:46,960
forensic forensically

789
00:26:46,960 --> 00:26:48,480
gathers so much information that you

790
00:26:48,480 --> 00:26:50,960
send to your sim your security incident

791
00:26:50,960 --> 00:26:52,400
event management system

792
00:26:52,400 --> 00:26:54,400
or liam neeson who

793
00:26:54,400 --> 00:26:56,320
isn't going to mess around

794
00:26:56,320 --> 00:26:58,880
and the way that it works you've got an

795
00:26:58,880 --> 00:27:01,440
adversary like whoever they pop your

796
00:27:01,440 --> 00:27:02,720
server right

797
00:27:02,720 --> 00:27:04,559
and let's say it's running nginx which

798
00:27:04,559 --> 00:27:05,840
is pretty common

799
00:27:05,840 --> 00:27:07,279
while you can

800
00:27:07,279 --> 00:27:09,200
do something cool with dns tokens you

801
00:27:09,200 --> 00:27:10,480
can create

802
00:27:10,480 --> 00:27:13,600
a process token such that if they hop on

803
00:27:13,600 --> 00:27:15,440
the server and they run ls to list the

804
00:27:15,440 --> 00:27:18,320
contents it'll fire an alert or even if

805
00:27:18,320 --> 00:27:20,399
they ssh into the system

806
00:27:20,399 --> 00:27:22,880
like the dns token is very extensible

807
00:27:22,880 --> 00:27:24,320
and customizable

808
00:27:24,320 --> 00:27:26,480
and there's so much um that you can do

809
00:27:26,480 --> 00:27:28,480
with it beyond just

810
00:27:28,480 --> 00:27:30,880
enumeration and so at that point or

811
00:27:30,880 --> 00:27:32,960
maybe you just wrap the nmap process in

812
00:27:32,960 --> 00:27:36,320
a token and that will work well

813
00:27:36,320 --> 00:27:38,240
the first time they hit a token starts

814
00:27:38,240 --> 00:27:40,799
to send forensic data to the sim

815
00:27:40,799 --> 00:27:42,559
then they're going to run nmap like i

816
00:27:42,559 --> 00:27:44,720
showed you on slide seven

817
00:27:44,720 --> 00:27:47,039
and the moment they run nmap

818
00:27:47,039 --> 00:27:48,159
they're probably going to hit a bunch of

819
00:27:48,159 --> 00:27:49,200
systems

820
00:27:49,200 --> 00:27:51,520
one of them is going to blend in

821
00:27:51,520 --> 00:27:53,200
and they're going to you know hit it

822
00:27:53,200 --> 00:27:54,559
because how can you not if you're doing

823
00:27:54,559 --> 00:27:56,320
situational awareness when you first get

824
00:27:56,320 --> 00:27:57,360
into

825
00:27:57,360 --> 00:27:59,919
a network you'd be hard-pressed

826
00:27:59,919 --> 00:28:02,000
to not you know want to run this and see

827
00:28:02,000 --> 00:28:04,080
what's uh what's going on

828
00:28:04,080 --> 00:28:05,440
and then maybe we can lead them down a

829
00:28:05,440 --> 00:28:06,240
path

830
00:28:06,240 --> 00:28:08,960
and say oh here's a windows file server

831
00:28:08,960 --> 00:28:11,200
right that just has all kinds of goodies

832
00:28:11,200 --> 00:28:13,120
in it stuff about

833
00:28:13,120 --> 00:28:15,360
again executive plans or organizational

834
00:28:15,360 --> 00:28:17,520
charts or maybe someone was silly

835
00:28:17,520 --> 00:28:19,200
because this has happened and they left

836
00:28:19,200 --> 00:28:21,039
some plain text credentials on there

837
00:28:21,039 --> 00:28:23,760
like some aws keys well that's

838
00:28:23,760 --> 00:28:26,720
convenient right or a kubernetes token

839
00:28:26,720 --> 00:28:28,559
you can see where this is going

840
00:28:28,559 --> 00:28:29,679
so

841
00:28:29,679 --> 00:28:32,240
they open this document they find this

842
00:28:32,240 --> 00:28:33,440
gold mine

843
00:28:33,440 --> 00:28:35,279
like an aws

844
00:28:35,279 --> 00:28:38,640
then they list buckets whoops mistake

845
00:28:38,640 --> 00:28:40,080
and they list and they hit a bucket

846
00:28:40,080 --> 00:28:42,559
that's also token so you've got

847
00:28:42,559 --> 00:28:44,720
seven layer seven layer dip or no sorry

848
00:28:44,720 --> 00:28:47,520
six layers of forensics

849
00:28:47,520 --> 00:28:48,399
and

850
00:28:48,399 --> 00:28:50,720
you can have even more like the way that

851
00:28:50,720 --> 00:28:52,480
this really works because i get this

852
00:28:52,480 --> 00:28:53,919
question a lot

853
00:28:53,919 --> 00:28:54,880
is

854
00:28:54,880 --> 00:28:56,240
how do you

855
00:28:56,240 --> 00:28:57,840
like or i hear this statement

856
00:28:57,840 --> 00:28:59,679
adversaries or

857
00:28:59,679 --> 00:29:01,360
bad guys that know what they're doing

858
00:29:01,360 --> 00:29:04,080
they're going to know to avoid this and

859
00:29:04,080 --> 00:29:06,320
there may be something that stands out

860
00:29:06,320 --> 00:29:08,240
and they'll say well this is

861
00:29:08,240 --> 00:29:10,080
uh this looks suspicious you know

862
00:29:10,080 --> 00:29:11,440
doesn't seem legit

863
00:29:11,440 --> 00:29:13,840
but if you put enough of these

864
00:29:13,840 --> 00:29:15,679
together and you layer them it almost

865
00:29:15,679 --> 00:29:17,200
becomes impossible to not trip over

866
00:29:17,200 --> 00:29:18,960
something like a landmine you know if

867
00:29:18,960 --> 00:29:20,960
you drop aws keys

868
00:29:20,960 --> 00:29:22,880
everywhere within your normal aws keys

869
00:29:22,880 --> 00:29:24,399
and let's just say you're silly and you

870
00:29:24,399 --> 00:29:25,760
push them to github

871
00:29:25,760 --> 00:29:27,679
you know and they're publicly available

872
00:29:27,679 --> 00:29:29,840
you'll have some legitimate ones and

873
00:29:29,840 --> 00:29:32,159
you'll have some non-legitimate ones

874
00:29:32,159 --> 00:29:33,919
and of course you don't want secrets and

875
00:29:33,919 --> 00:29:35,520
source code but let's just say that you

876
00:29:35,520 --> 00:29:37,279
already have them well what a great

877
00:29:37,279 --> 00:29:40,320
transition plan to also drop bogus ones

878
00:29:40,320 --> 00:29:42,159
in to see if somebody's already been in

879
00:29:42,159 --> 00:29:43,840
your network maybe poking around using

880
00:29:43,840 --> 00:29:46,240
these these keys

881
00:29:46,240 --> 00:29:49,120
so there's a lot of opportunity and

882
00:29:49,120 --> 00:29:51,120
the whole point in this is like token

883
00:29:51,120 --> 00:29:53,039
token token you know thinks has said

884
00:29:53,039 --> 00:29:54,399
that there are people

885
00:29:54,399 --> 00:29:56,480
customers that have minted over millions

886
00:29:56,480 --> 00:29:58,240
of tokens and

887
00:29:58,240 --> 00:29:59,200
you get

888
00:29:59,200 --> 00:30:00,799
they let you min as many as you want on

889
00:30:00,799 --> 00:30:03,600
their site or if you subscribe same deal

890
00:30:03,600 --> 00:30:05,760
so you may as well do it and

891
00:30:05,760 --> 00:30:07,600
there's a lot of creative smart people

892
00:30:07,600 --> 00:30:09,520
out here and what

893
00:30:09,520 --> 00:30:11,520
makes this whole thing fun

894
00:30:11,520 --> 00:30:13,279
is that it really taps in

895
00:30:13,279 --> 00:30:14,799
to your creativity

896
00:30:14,799 --> 00:30:17,120
you know as well as your logical ability

897
00:30:17,120 --> 00:30:18,080
and

898
00:30:18,080 --> 00:30:20,399
you know if you can think of it you can

899
00:30:20,399 --> 00:30:22,640
you can achieve it you know there's so

900
00:30:22,640 --> 00:30:24,080
much possibility

901
00:30:24,080 --> 00:30:25,840
there's been some tokens that

902
00:30:25,840 --> 00:30:28,880
i actually sent them um that kind of got

903
00:30:28,880 --> 00:30:30,320
worked into

904
00:30:30,320 --> 00:30:32,399
their platform right so

905
00:30:32,399 --> 00:30:34,159
one of the one of the things i wanted

906
00:30:34,159 --> 00:30:36,240
was kubernetes and i worked with them

907
00:30:36,240 --> 00:30:38,559
through the beta on the containerized

908
00:30:38,559 --> 00:30:39,440
bird

909
00:30:39,440 --> 00:30:41,760
and it ended up being part of uh the

910
00:30:41,760 --> 00:30:43,039
token their latest token is the

911
00:30:43,039 --> 00:30:45,200
kubernetes token which is super helpful

912
00:30:45,200 --> 00:30:47,440
because if you're cloud native

913
00:30:47,440 --> 00:30:51,120
you run kubernetes more than likely um

914
00:30:51,120 --> 00:30:52,960
and so all this said

915
00:30:52,960 --> 00:30:55,440
once it ends up with liam neesom

916
00:30:55,440 --> 00:30:56,799
he may not know who you are right at

917
00:30:56,799 --> 00:30:58,720
that moment but

918
00:30:58,720 --> 00:31:00,880
he's got enough information

919
00:31:00,880 --> 00:31:03,279
to if he can't de-anonymize you you can

920
00:31:03,279 --> 00:31:04,960
pass it on to someone

921
00:31:04,960 --> 00:31:06,240
that will

922
00:31:06,240 --> 00:31:07,200
and

923
00:31:07,200 --> 00:31:09,279
that is really really

924
00:31:09,279 --> 00:31:11,279
really great because

925
00:31:11,279 --> 00:31:13,200
how else are you going to find

926
00:31:13,200 --> 00:31:15,279
needles in a haystack and or a hay farm

927
00:31:15,279 --> 00:31:16,720
which is really what the problem is we

928
00:31:16,720 --> 00:31:20,320
got alert fatigue that's causing burnout

929
00:31:20,320 --> 00:31:21,760
of employees

930
00:31:21,760 --> 00:31:24,720
and people to leave the industry and the

931
00:31:24,720 --> 00:31:26,799
bad guys keep winning you know

932
00:31:26,799 --> 00:31:27,600
and

933
00:31:27,600 --> 00:31:30,240
this is why we need something different

934
00:31:30,240 --> 00:31:32,559
and i truly believe that this

935
00:31:32,559 --> 00:31:34,559
can be useful for everyone here you know

936
00:31:34,559 --> 00:31:36,080
i've seen companies

937
00:31:36,080 --> 00:31:37,840
not be catastrophically breached because

938
00:31:37,840 --> 00:31:39,200
of this i've seen

939
00:31:39,200 --> 00:31:40,720
elite pen test

940
00:31:40,720 --> 00:31:42,159
firms that trip

941
00:31:42,159 --> 00:31:43,600
after eight minutes because they think

942
00:31:43,600 --> 00:31:45,360
they have a gold mine and they found the

943
00:31:45,360 --> 00:31:46,880
slack token

944
00:31:46,880 --> 00:31:48,559
and so you could start start to mess

945
00:31:48,559 --> 00:31:50,159
with them

946
00:31:50,159 --> 00:31:51,679
and this is this is kind of what we need

947
00:31:51,679 --> 00:31:53,760
to kind of get the upper hand

948
00:31:53,760 --> 00:31:55,360
against adversaries

949
00:31:55,360 --> 00:31:57,120
and with that

950
00:31:57,120 --> 00:31:59,200
i want to thank everyone

951
00:31:59,200 --> 00:32:01,279
for your time and one to open up for

952
00:32:01,279 --> 00:32:04,279
questions

953
00:32:05,110 --> 00:32:14,640
[Applause]

954
00:32:14,640 --> 00:32:16,640
buehler anyone there

955
00:32:16,640 --> 00:32:19,279
hey michael

956
00:32:19,279 --> 00:32:21,600
man i watched that hbo show

957
00:32:21,600 --> 00:32:23,360
i'm not sure at least seven people think

958
00:32:23,360 --> 00:32:24,799
he's still alive

959
00:32:24,799 --> 00:32:27,200
i i think my friend is db cooper but

960
00:32:27,200 --> 00:32:29,519
that's a whole other thing

961
00:32:29,519 --> 00:32:31,519
i don't know honestly i think his plan

962
00:32:31,519 --> 00:32:32,480
though

963
00:32:32,480 --> 00:32:34,480
you know it was uh it was foiled by he

964
00:32:34,480 --> 00:32:37,440
just improperly tied as his harness and

965
00:32:37,440 --> 00:32:39,600
he asked for 200 grand and

966
00:32:39,600 --> 00:32:41,279
i don't think he landed with any of it

967
00:32:41,279 --> 00:32:42,399
if he's still around

968
00:32:42,399 --> 00:32:43,360
but

969
00:32:43,360 --> 00:32:45,039
it's a yeah it's a good question we'll

970
00:32:45,039 --> 00:32:47,120
have to ask fbi agents

971
00:32:47,120 --> 00:32:50,120
yes

972
00:32:59,760 --> 00:33:01,679
it's a good question i kind of

973
00:33:01,679 --> 00:33:04,159
so yeah he if you couldn't hear he asked

974
00:33:04,159 --> 00:33:05,440
in

975
00:33:05,440 --> 00:33:06,559
new environments this is great

976
00:33:06,559 --> 00:33:08,640
greenfield but what about live ones so

977
00:33:08,640 --> 00:33:11,039
one example i kind of gave is like

978
00:33:11,039 --> 00:33:12,799
yeah maybe you have source codes or

979
00:33:12,799 --> 00:33:14,720
secrets in like

980
00:33:14,720 --> 00:33:17,279
github or you you're already using aws

981
00:33:17,279 --> 00:33:18,480
keys and properly and you're storing

982
00:33:18,480 --> 00:33:20,720
them locally on people's machines

983
00:33:20,720 --> 00:33:23,039
well you know that you want a plan to

984
00:33:23,039 --> 00:33:25,360
not do that but in the interim

985
00:33:25,360 --> 00:33:27,200
you'd like to know if people are

986
00:33:27,200 --> 00:33:29,840
rummaging around so you can add

987
00:33:29,840 --> 00:33:32,240
legit illegitimate keys to legitimate

988
00:33:32,240 --> 00:33:34,159
ones and have it all kind of blend in

989
00:33:34,159 --> 00:33:35,360
and so

990
00:33:35,360 --> 00:33:37,519
that'll tell you people do indeed have

991
00:33:37,519 --> 00:33:39,679
access and

992
00:33:39,679 --> 00:33:41,440
they're mucking around and that'll give

993
00:33:41,440 --> 00:33:43,679
you time to sort of transition but also

994
00:33:43,679 --> 00:33:46,000
highlight where they might be targeting

995
00:33:46,000 --> 00:33:47,679
you know and so

996
00:33:47,679 --> 00:33:49,440
yeah people don't always do things the

997
00:33:49,440 --> 00:33:52,080
right way there's a lot of technical and

998
00:33:52,080 --> 00:33:55,200
security debt that accumulates over time

999
00:33:55,200 --> 00:33:57,279
but these tokens

1000
00:33:57,279 --> 00:33:59,519
you know can just be

1001
00:33:59,519 --> 00:34:01,279
deployed normally like anything else you

1002
00:34:01,279 --> 00:34:02,320
do

1003
00:34:02,320 --> 00:34:04,000
and they'll let you know

1004
00:34:04,000 --> 00:34:05,760
amidst the noise

1005
00:34:05,760 --> 00:34:07,360
you know if things are happening you

1006
00:34:07,360 --> 00:34:09,119
know because it's even harder in a

1007
00:34:09,119 --> 00:34:11,440
well-established environment to

1008
00:34:11,440 --> 00:34:14,079
have solid monitoring and more signal

1009
00:34:14,079 --> 00:34:16,560
the noise so this kind of adds signal

1010
00:34:16,560 --> 00:34:19,359
emits the noise

1011
00:34:19,520 --> 00:34:22,239
great question

1012
00:34:25,359 --> 00:34:29,239
anyone else yeah

1013
00:34:44,000 --> 00:34:46,239
that's a great question how do you talk

1014
00:34:46,239 --> 00:34:48,800
to leadership about tokens

1015
00:34:48,800 --> 00:34:51,918
but not introduce risk well the first

1016
00:34:51,918 --> 00:34:53,760
rule deception technologies you don't

1017
00:34:53,760 --> 00:34:56,960
talk about deception technology right so

1018
00:34:56,960 --> 00:34:58,160
you don't want to

1019
00:34:58,160 --> 00:35:00,320
let bad guys know because

1020
00:35:00,320 --> 00:35:02,160
then they may actually be more more

1021
00:35:02,160 --> 00:35:04,800
careful so it is something that really

1022
00:35:04,800 --> 00:35:06,800
should be need to know and it should be

1023
00:35:06,800 --> 00:35:08,480
done in a way that

1024
00:35:08,480 --> 00:35:11,280
is subtle and not obvious right so a lot

1025
00:35:11,280 --> 00:35:12,960
of endpoint

1026
00:35:12,960 --> 00:35:15,440
software you know it affects the user

1027
00:35:15,440 --> 00:35:17,440
there's some performance hit there's

1028
00:35:17,440 --> 00:35:18,880
something and it becomes evident to

1029
00:35:18,880 --> 00:35:21,119
people that aren't in the security team

1030
00:35:21,119 --> 00:35:22,160
that

1031
00:35:22,160 --> 00:35:23,920
you know their machines being messed

1032
00:35:23,920 --> 00:35:25,920
with but if you can kind of pitch it to

1033
00:35:25,920 --> 00:35:27,119
them that

1034
00:35:27,119 --> 00:35:29,520
this will blend in like normal activity

1035
00:35:29,520 --> 00:35:32,400
there's very low impact to the user

1036
00:35:32,400 --> 00:35:33,440
and

1037
00:35:33,440 --> 00:35:35,520
there's a lot of benefit

1038
00:35:35,520 --> 00:35:37,760
usually it's it's well received you know

1039
00:35:37,760 --> 00:35:40,320
like these tokens are a couple kilobytes

1040
00:35:40,320 --> 00:35:42,560
in size like they're very lightweight

1041
00:35:42,560 --> 00:35:43,440
and

1042
00:35:43,440 --> 00:35:45,680
they don't have a huge impact but

1043
00:35:45,680 --> 00:35:48,560
absolutely you don't want to tell people

1044
00:35:48,560 --> 00:35:49,920
that bad guys are coming some people

1045
00:35:49,920 --> 00:35:51,599
will put up an adt sign out in front of

1046
00:35:51,599 --> 00:35:52,800
their house and think it deteriorates

1047
00:35:52,800 --> 00:35:54,880
criminals in reality probably tells them

1048
00:35:54,880 --> 00:35:55,920
that you have something valuable to

1049
00:35:55,920 --> 00:35:58,240
protect so unless you have adt i don't

1050
00:35:58,240 --> 00:35:59,760
really recommend putting up a sign

1051
00:35:59,760 --> 00:36:01,040
that's just my

1052
00:36:01,040 --> 00:36:02,880
my thought but

1053
00:36:02,880 --> 00:36:03,880
thanks for the question

1054
00:36:03,880 --> 00:36:05,920
[Music]

1055
00:36:05,920 --> 00:36:08,920
yes

1056
00:36:17,520 --> 00:36:19,040
yeah that's that's a good question they

1057
00:36:19,040 --> 00:36:21,760
actually have a binary exe token on

1058
00:36:21,760 --> 00:36:23,599
their site and

1059
00:36:23,599 --> 00:36:26,160
the way it works is it

1060
00:36:26,160 --> 00:36:27,760
it'll replace the

1061
00:36:27,760 --> 00:36:30,960
actual binary or like on the linux case

1062
00:36:30,960 --> 00:36:33,920
you can have it be like a sim link to

1063
00:36:33,920 --> 00:36:36,720
like a script so like you can name it uh

1064
00:36:36,720 --> 00:36:38,320
let's say ls right

1065
00:36:38,320 --> 00:36:41,280
well ls when they type it um

1066
00:36:41,280 --> 00:36:42,640
they think they're typing ls but in

1067
00:36:42,640 --> 00:36:44,560
reality it's pointing to

1068
00:36:44,560 --> 00:36:47,040
ls that actually has the canary code

1069
00:36:47,040 --> 00:36:48,640
which is like a few lines

1070
00:36:48,640 --> 00:36:50,720
and all it does is it says here's the

1071
00:36:50,720 --> 00:36:52,560
command but in the command it hits the

1072
00:36:52,560 --> 00:36:54,720
dns token and when the dns tokens hit

1073
00:36:54,720 --> 00:36:56,720
that's when the alert fires so it does

1074
00:36:56,720 --> 00:36:58,079
its normal command

1075
00:36:58,079 --> 00:36:59,839
hits the dns endpoint

1076
00:36:59,839 --> 00:37:01,520
and it still functions it's not like the

1077
00:37:01,520 --> 00:37:03,520
binary is broken or

1078
00:37:03,520 --> 00:37:06,320
like the program just stops working but

1079
00:37:06,320 --> 00:37:08,480
you know when you create the token they

1080
00:37:08,480 --> 00:37:10,320
they make it as extensively realistic as

1081
00:37:10,320 --> 00:37:12,720
possible and on the windows side i don't

1082
00:37:12,720 --> 00:37:14,800
know the exact details but i think

1083
00:37:14,800 --> 00:37:16,480
in the executable they actually inject

1084
00:37:16,480 --> 00:37:18,480
like the token

1085
00:37:18,480 --> 00:37:20,000
you know on top of like the binary so

1086
00:37:20,000 --> 00:37:21,760
they take what you have they copy it and

1087
00:37:21,760 --> 00:37:23,760
they add that little bit of metadata

1088
00:37:23,760 --> 00:37:25,359
and it's pretty brilliant you know and

1089
00:37:25,359 --> 00:37:27,280
they don't have an official

1090
00:37:27,280 --> 00:37:29,599
linux binary token but like i said you

1091
00:37:29,599 --> 00:37:31,359
can wrap dns tokens and there's a github

1092
00:37:31,359 --> 00:37:33,119
project called

1093
00:37:33,119 --> 00:37:35,599
yellow taxi i think where somebody wrote

1094
00:37:35,599 --> 00:37:37,760
it and see and made it more easier to

1095
00:37:37,760 --> 00:37:38,880
distribute

1096
00:37:38,880 --> 00:37:42,240
but yeah thanks for the question

1097
00:37:44,320 --> 00:37:46,960
anyone else

1098
00:37:48,720 --> 00:37:51,720
yes

1099
00:38:05,680 --> 00:38:08,000
yeah

1100
00:38:08,400 --> 00:38:10,800
yeah exactly yeah so

1101
00:38:10,800 --> 00:38:12,720
that's you know i've run into this

1102
00:38:12,720 --> 00:38:14,720
situation you talk to

1103
00:38:14,720 --> 00:38:16,400
developers or the one developer that's

1104
00:38:16,400 --> 00:38:18,160
going to review your you know pull

1105
00:38:18,160 --> 00:38:20,000
requests and know what's happening or

1106
00:38:20,000 --> 00:38:22,320
like the security champions in your

1107
00:38:22,320 --> 00:38:24,240
company if you have that set up you know

1108
00:38:24,240 --> 00:38:26,240
on the business units you tell them hey

1109
00:38:26,240 --> 00:38:28,000
we're doing this thing make it look like

1110
00:38:28,000 --> 00:38:30,000
a normal pull request or a

1111
00:38:30,000 --> 00:38:33,200
commit you know maybe go back in time if

1112
00:38:33,200 --> 00:38:34,800
you're in this bad situation where

1113
00:38:34,800 --> 00:38:36,400
you've accidentally pushed you know

1114
00:38:36,400 --> 00:38:38,400
secrets of source code and look at what

1115
00:38:38,400 --> 00:38:39,680
that said

1116
00:38:39,680 --> 00:38:41,920
and then do the same thing but

1117
00:38:41,920 --> 00:38:44,320
you can also just you know have a pull

1118
00:38:44,320 --> 00:38:46,240
request that says you know we're

1119
00:38:46,240 --> 00:38:48,800
upgrading the jenkins build server or

1120
00:38:48,800 --> 00:38:50,240
something and

1121
00:38:50,240 --> 00:38:52,240
in that it adds some keys or we're

1122
00:38:52,240 --> 00:38:54,880
adding uh chef scripts or terraform or

1123
00:38:54,880 --> 00:38:56,000
what have you

1124
00:38:56,000 --> 00:38:58,000
and then you just happen maybe you know

1125
00:38:58,000 --> 00:38:59,440
you just happen to drop some tokens in

1126
00:38:59,440 --> 00:39:02,160
there in the in the aws directory but

1127
00:39:02,160 --> 00:39:04,000
yeah you have to communicate

1128
00:39:04,000 --> 00:39:06,320
with the right people and of course

1129
00:39:06,320 --> 00:39:08,240
i don't recommend you know creating like

1130
00:39:08,240 --> 00:39:10,640
a jira ticket or github ticket that says

1131
00:39:10,640 --> 00:39:12,480
putting canary token in source code you

1132
00:39:12,480 --> 00:39:15,119
know like don't be silly

1133
00:39:15,119 --> 00:39:16,880
just find a way to communicate maybe use

1134
00:39:16,880 --> 00:39:19,359
code words you know like um

1135
00:39:19,359 --> 00:39:21,680
yeah you know adding new keys to the

1136
00:39:21,680 --> 00:39:23,520
kingdom something

1137
00:39:23,520 --> 00:39:25,119
but yeah that's a good question thank

1138
00:39:25,119 --> 00:39:28,119
you

1139
00:39:30,640 --> 00:39:33,118
who else

1140
00:39:39,599 --> 00:39:42,079
there's it's just my email address i'm a

1141
00:39:42,079 --> 00:39:45,200
ghost but yeah it's on that front slide

1142
00:39:45,200 --> 00:39:46,400
um

1143
00:39:46,400 --> 00:39:47,920
send me an email anytime i don't really

1144
00:39:47,920 --> 00:39:50,560
do the social network thing um

1145
00:39:50,560 --> 00:39:52,240
maybe i should but

1146
00:39:52,240 --> 00:39:54,720
yeah love to stay in touch

1147
00:39:54,720 --> 00:39:56,800
love to talk about this or anything else

1148
00:39:56,800 --> 00:39:58,079
um

1149
00:39:58,079 --> 00:39:59,839
you know relatively new concept you know

1150
00:39:59,839 --> 00:40:00,800
even just talking to security

1151
00:40:00,800 --> 00:40:02,160
practitioners

1152
00:40:02,160 --> 00:40:03,359
a lot of

1153
00:40:03,359 --> 00:40:04,960
people like haven't really considered

1154
00:40:04,960 --> 00:40:06,720
this and um

1155
00:40:06,720 --> 00:40:08,480
i think it's really starting to take off

1156
00:40:08,480 --> 00:40:10,400
like 2021 seemed to be the year of

1157
00:40:10,400 --> 00:40:12,160
deception technology and

1158
00:40:12,160 --> 00:40:13,839
and for good reason

1159
00:40:13,839 --> 00:40:16,079
and so i i expect things to continue to

1160
00:40:16,079 --> 00:40:17,760
flourish and

1161
00:40:17,760 --> 00:40:19,920
yeah love to keep in touch and talk more

1162
00:40:19,920 --> 00:40:21,760
about it so

1163
00:40:21,760 --> 00:40:23,359
hit me up

1164
00:40:23,359 --> 00:40:25,200
there's nothing else

1165
00:40:25,200 --> 00:40:27,680
just wanted to thank you all again

1166
00:40:27,680 --> 00:40:31,160
appreciate you

