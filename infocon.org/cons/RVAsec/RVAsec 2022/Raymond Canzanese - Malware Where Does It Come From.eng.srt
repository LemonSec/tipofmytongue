1
00:00:16,960 --> 00:00:19,520
so i i was told we have to start exactly

2
00:00:19,520 --> 00:00:21,439
on time no matter how many people are in

3
00:00:21,439 --> 00:00:23,519
the room so let's go ahead and get

4
00:00:23,519 --> 00:00:26,080
started um i'm really happy that

5
00:00:26,080 --> 00:00:28,800
everybody is here uh joining me for the

6
00:00:28,800 --> 00:00:30,400
last presentation of the day

7
00:00:30,400 --> 00:00:32,960
i i didn't know if i'd be presenting to

8
00:00:32,960 --> 00:00:35,200
nobody or maybe one or two people so

9
00:00:35,200 --> 00:00:37,520
this is pretty exciting i'm also excited

10
00:00:37,520 --> 00:00:39,280
to be at a conference i've done like no

11
00:00:39,280 --> 00:00:41,760
conferences for two and a half years and

12
00:00:41,760 --> 00:00:44,719
now two weeks two conferences i i could

13
00:00:44,719 --> 00:00:47,200
i could get used to this so i'm here to

14
00:00:47,200 --> 00:00:50,399
talk about malware and i started i guess

15
00:00:50,399 --> 00:00:52,640
with my kind of stupid provocative

16
00:00:52,640 --> 00:00:54,960
question where does malware come from uh

17
00:00:54,960 --> 00:00:56,800
i picked that title because everybody

18
00:00:56,800 --> 00:00:59,600
probably has a duh uh response to that

19
00:00:59,600 --> 00:01:02,399
right like uh it's obviously email right

20
00:01:02,399 --> 00:01:04,720
it all comes from social media or or

21
00:01:04,720 --> 00:01:07,040
whatever you've seen a lot of

22
00:01:07,040 --> 00:01:09,600
and so um what we were doing for this

23
00:01:09,600 --> 00:01:11,760
presentation is we looked at all of the

24
00:01:11,760 --> 00:01:13,520
malware that we've blocked so far this

25
00:01:13,520 --> 00:01:16,320
year so that's about 1.2 million malware

26
00:01:16,320 --> 00:01:17,520
blocks

27
00:01:17,520 --> 00:01:19,759
this is from january 1st through the end

28
00:01:19,759 --> 00:01:20,960
of may

29
00:01:20,960 --> 00:01:22,880
so almost half of a year worth of

30
00:01:22,880 --> 00:01:25,920
malware blocks we have at netscope about

31
00:01:25,920 --> 00:01:28,880
3.1 million uh users that were in this

32
00:01:28,880 --> 00:01:31,600
data set meaning like on average workday

33
00:01:31,600 --> 00:01:34,079
we'll see 3.1 million people um where

34
00:01:34,079 --> 00:01:36,000
these malware downloads were generated

35
00:01:36,000 --> 00:01:38,320
from it's mostly managed enterprise

36
00:01:38,320 --> 00:01:40,400
windows laptops so it's not a lot of

37
00:01:40,400 --> 00:01:43,600
phones um you know uh so keep that in

38
00:01:43,600 --> 00:01:45,600
mind as we go through like hey ray why

39
00:01:45,600 --> 00:01:47,600
didn't you see more android malware well

40
00:01:47,600 --> 00:01:48,720
because i'm not looking at a lot of

41
00:01:48,720 --> 00:01:50,960
phones i'm still looking at laptops

42
00:01:50,960 --> 00:01:52,479
and it's all coming from our secure web

43
00:01:52,479 --> 00:01:55,840
gateway so it's all http https traffic

44
00:01:55,840 --> 00:01:58,159
so just another thing to keep in mind as

45
00:01:58,159 --> 00:02:00,479
you're saying hey that doesn't maybe uh

46
00:02:00,479 --> 00:02:03,439
jive with what i see in my organization

47
00:02:03,439 --> 00:02:05,759
so this is my lawyer slide so i am

48
00:02:05,759 --> 00:02:08,160
presenting stuff that we've extracted

49
00:02:08,160 --> 00:02:10,800
from our data in our

50
00:02:10,800 --> 00:02:13,040
telemetry this is based on anonymized

51
00:02:13,040 --> 00:02:14,720
data that we collect from a subset of

52
00:02:14,720 --> 00:02:16,560
our customers that give us prior

53
00:02:16,560 --> 00:02:18,400
authorization to do this kind of

54
00:02:18,400 --> 00:02:20,959
research and another thing i just want

55
00:02:20,959 --> 00:02:22,879
to make super clear and i'll bring this

56
00:02:22,879 --> 00:02:23,920
up again

57
00:02:23,920 --> 00:02:26,480
just to make sure it clicks is

58
00:02:26,480 --> 00:02:28,319
when i talk about something and i talk

59
00:02:28,319 --> 00:02:30,080
about like oh one drive is where i'm

60
00:02:30,080 --> 00:02:32,560
seeing the most malware downloads

61
00:02:32,560 --> 00:02:34,239
all i see is the downloads in other

62
00:02:34,239 --> 00:02:36,959
words attacker puts malware all over the

63
00:02:36,959 --> 00:02:39,280
internet um you know victims visiting

64
00:02:39,280 --> 00:02:41,760
some websites i'm talking here just

65
00:02:41,760 --> 00:02:44,000
about that big red highlighted thing i'm

66
00:02:44,000 --> 00:02:45,680
talking about the places where attackers

67
00:02:45,680 --> 00:02:48,720
were successful in getting a victim to

68
00:02:48,720 --> 00:02:50,640
try to download some malware where we

69
00:02:50,640 --> 00:02:52,480
were able to step in and say whoa whoa

70
00:02:52,480 --> 00:02:53,680
don't do that

71
00:02:53,680 --> 00:02:55,840
and so that's that's just uh something

72
00:02:55,840 --> 00:02:58,080
to keep in mind as we go so i'm gonna

73
00:02:58,080 --> 00:03:00,560
focus this in two places most of the

74
00:03:00,560 --> 00:03:01,920
time i'm gonna spend talking about some

75
00:03:01,920 --> 00:03:04,400
of the really cool stuff that we've seen

76
00:03:04,400 --> 00:03:06,640
attackers doing so far this year to get

77
00:03:06,640 --> 00:03:08,080
people to try to click on and download

78
00:03:08,080 --> 00:03:10,959
malware that's most of it but this lends

79
00:03:10,959 --> 00:03:13,360
itself toward the let's talk strategy

80
00:03:13,360 --> 00:03:16,560
for them defending against that event

81
00:03:16,560 --> 00:03:18,720
and so um again let's just talk about

82
00:03:18,720 --> 00:03:21,040
those uh one plus million malware

83
00:03:21,040 --> 00:03:23,200
downloads um let's start looking at them

84
00:03:23,200 --> 00:03:25,440
by file type again it's mostly windows

85
00:03:25,440 --> 00:03:28,480
laptops so no surprise the most popular

86
00:03:28,480 --> 00:03:32,080
file types that we're seeing are exl exe

87
00:03:32,080 --> 00:03:34,959
and dll files right pe files for windows

88
00:03:34,959 --> 00:03:37,519
um that makes sense office files make

89
00:03:37,519 --> 00:03:40,400
sense if i was giving this presentation

90
00:03:40,400 --> 00:03:42,879
two and a half years ago that little

91
00:03:42,879 --> 00:03:45,040
slice of that pie that's office files

92
00:03:45,040 --> 00:03:47,360
would have been like half of that pie

93
00:03:47,360 --> 00:03:49,920
because at that time emo tech was super

94
00:03:49,920 --> 00:03:53,280
active we saw just some really crazy

95
00:03:53,280 --> 00:03:54,720
persistent

96
00:03:54,720 --> 00:03:57,040
email campaigns uh distributing

97
00:03:57,040 --> 00:03:59,040
malicious office documents that's come

98
00:03:59,040 --> 00:04:00,640
down an awful lot

99
00:04:00,640 --> 00:04:02,640
and i can thank google and i can thank

100
00:04:02,640 --> 00:04:04,560
microsoft a lot for that

101
00:04:04,560 --> 00:04:06,080
google started saying please don't

102
00:04:06,080 --> 00:04:08,400
download this this office document it

103
00:04:08,400 --> 00:04:11,120
has something in there that might not be

104
00:04:11,120 --> 00:04:12,080
something you want to run on your

105
00:04:12,080 --> 00:04:14,480
computer then eventually uh microsoft

106
00:04:14,480 --> 00:04:16,798
started blocking macros by default

107
00:04:16,798 --> 00:04:19,600
finally we threw a party for it right um

108
00:04:19,600 --> 00:04:21,680
shorts based on mark of the web and mark

109
00:04:21,680 --> 00:04:23,440
of the web is only relevant on windows

110
00:04:23,440 --> 00:04:25,759
systems and there's ways to get around

111
00:04:25,759 --> 00:04:27,919
that right but that was a huge win and

112
00:04:27,919 --> 00:04:29,680
so we're excited about that and then

113
00:04:29,680 --> 00:04:31,919
that little slice of other um there's

114
00:04:31,919 --> 00:04:33,360
some cool stuff in there right there's

115
00:04:33,360 --> 00:04:34,880
there's chrome extensions there's

116
00:04:34,880 --> 00:04:38,160
different um uh archive formats um

117
00:04:38,160 --> 00:04:40,080
powershell scripts are of course getting

118
00:04:40,080 --> 00:04:42,400
more and more popular link files so

119
00:04:42,400 --> 00:04:43,680
there's cool stuff in there it's just

120
00:04:43,680 --> 00:04:45,280
the cool stuff isn't the majority right

121
00:04:45,280 --> 00:04:47,440
the majority is just hey here's here's

122
00:04:47,440 --> 00:04:49,520
another trojan downloader

123
00:04:49,520 --> 00:04:52,400
uh when it comes to file types um again

124
00:04:52,400 --> 00:04:54,000
right this is mostly people downloading

125
00:04:54,000 --> 00:04:56,160
stuff from the web um so we're mostly

126
00:04:56,160 --> 00:04:58,479
blocking that initial stage so lots of

127
00:04:58,479 --> 00:05:00,880
trojans lots of downloaders um you might

128
00:05:00,880 --> 00:05:02,880
look at this chart and tell me you're a

129
00:05:02,880 --> 00:05:05,039
little bit crazy um because fishing

130
00:05:05,039 --> 00:05:06,960
isn't malware and exploits aren't

131
00:05:06,960 --> 00:05:08,960
malware i'll get to the fishing because

132
00:05:08,960 --> 00:05:11,680
the fishing is is weird

133
00:05:11,680 --> 00:05:13,600
we call it fishing because when we first

134
00:05:13,600 --> 00:05:16,479
saw this happening it was all related to

135
00:05:16,479 --> 00:05:18,720
fishing and now we've seen it really

136
00:05:18,720 --> 00:05:20,639
spread out from there so we'll dive into

137
00:05:20,639 --> 00:05:22,560
that and when i say exploit here i'm

138
00:05:22,560 --> 00:05:24,880
talking about file file based exploits

139
00:05:24,880 --> 00:05:26,400
right so this is somebody actually

140
00:05:26,400 --> 00:05:28,000
trying to download malware that's a file

141
00:05:28,000 --> 00:05:29,520
based exploit exploiting something on

142
00:05:29,520 --> 00:05:31,440
their local machine

143
00:05:31,440 --> 00:05:32,800
and then others

144
00:05:32,800 --> 00:05:33,919
that's you know everything else

145
00:05:33,919 --> 00:05:36,400
ransomware all the all the really scary

146
00:05:36,400 --> 00:05:37,919
stuff next stage downloads other types

147
00:05:37,919 --> 00:05:39,120
of malware

148
00:05:39,120 --> 00:05:40,960
in terms of families um this is

149
00:05:40,960 --> 00:05:42,479
something people that say what's the

150
00:05:42,479 --> 00:05:44,400
family that you know is 90 of all the

151
00:05:44,400 --> 00:05:46,320
malware downloads you see there's really

152
00:05:46,320 --> 00:05:48,560
no dominant family in fact you look at

153
00:05:48,560 --> 00:05:49,759
these and you might say i'm going to

154
00:05:49,759 --> 00:05:50,880
have to google that i've never even

155
00:05:50,880 --> 00:05:52,639
heard of that before except for maybe

156
00:05:52,639 --> 00:05:53,680
emote

157
00:05:53,680 --> 00:05:55,759
that uh just will not go away no matter

158
00:05:55,759 --> 00:05:58,160
how many times we declare victory over

159
00:05:58,160 --> 00:06:01,360
emo debt um so in other words just lots

160
00:06:01,360 --> 00:06:02,560
of different stuff right there's no

161
00:06:02,560 --> 00:06:04,880
dominant family malware's so fragmented

162
00:06:04,880 --> 00:06:06,560
now everybody's stealing code from each

163
00:06:06,560 --> 00:06:08,560
other building new things we keep giving

164
00:06:08,560 --> 00:06:10,720
them new family names um so there's just

165
00:06:10,720 --> 00:06:13,039
nothing ever that really stands out um

166
00:06:13,039 --> 00:06:15,280
so now let's pivot to i think what is

167
00:06:15,280 --> 00:06:18,160
the cool stuff and um i ordered this in

168
00:06:18,160 --> 00:06:20,080
what i think is most cool to less to at

169
00:06:20,080 --> 00:06:22,000
least cool so i'm going to lead with the

170
00:06:22,000 --> 00:06:24,240
the the coolest thing i think we've seen

171
00:06:24,240 --> 00:06:27,039
in the past year um which is uh

172
00:06:27,039 --> 00:06:28,479
attackers just getting really good at

173
00:06:28,479 --> 00:06:31,360
marketing um really good at seo and

174
00:06:31,360 --> 00:06:34,800
finding really clever ways to use pdfs

175
00:06:34,800 --> 00:06:37,840
and so um what we saw that that had us

176
00:06:37,840 --> 00:06:39,840
focusing on this is we're looking at all

177
00:06:39,840 --> 00:06:41,440
these malware downloads and we're

178
00:06:41,440 --> 00:06:43,360
looking at all the referrers

179
00:06:43,360 --> 00:06:45,280
and those http headers for those malware

180
00:06:45,280 --> 00:06:47,520
downloads and we start thinking hey

181
00:06:47,520 --> 00:06:50,400
something's weird uh we must have

182
00:06:50,400 --> 00:06:52,080
something that's broken and giving us

183
00:06:52,080 --> 00:06:55,319
bad data because google

184
00:06:55,319 --> 00:06:58,000
www.google.com can't possibly be the

185
00:06:58,000 --> 00:07:00,560
referrer for uh you know 15 of all the

186
00:07:00,560 --> 00:07:02,400
malware downloads that we're seeing and

187
00:07:02,400 --> 00:07:03,599
then we started looking and we're like

188
00:07:03,599 --> 00:07:06,160
oh bing's in there baidu's there um oh

189
00:07:06,160 --> 00:07:08,000
duck duck goes even in there right all

190
00:07:08,000 --> 00:07:09,840
of the search engines and we start

191
00:07:09,840 --> 00:07:11,840
looking and it's not just one url right

192
00:07:11,840 --> 00:07:13,759
it's thousands of urls across those

193
00:07:13,759 --> 00:07:15,120
search engines

194
00:07:15,120 --> 00:07:17,120
and it's victims all over the place

195
00:07:17,120 --> 00:07:19,039
right this wasn't the case of like oh

196
00:07:19,039 --> 00:07:20,720
there's like somebody doing something

197
00:07:20,720 --> 00:07:23,039
weird somewhere who's uh finding these

198
00:07:23,039 --> 00:07:25,120
pdfs and trying to download them no this

199
00:07:25,120 --> 00:07:26,639
is like all over the board different

200
00:07:26,639 --> 00:07:28,960
industries different geographies

201
00:07:28,960 --> 00:07:31,280
different languages people managing to

202
00:07:31,280 --> 00:07:33,440
find themselves downloading malicious

203
00:07:33,440 --> 00:07:37,440
pdfs directly from referrals from google

204
00:07:37,440 --> 00:07:39,360
then when we looked at where those pdfs

205
00:07:39,360 --> 00:07:42,000
were located also no rhyme or reason to

206
00:07:42,000 --> 00:07:44,560
it they were all over the web um so some

207
00:07:44,560 --> 00:07:47,520
of the top places they were were weebly

208
00:07:47,520 --> 00:07:50,560
baidu cloud squarespace s3 a bunch of

209
00:07:50,560 --> 00:07:52,560
different cdns there wasn't like one

210
00:07:52,560 --> 00:07:56,160
favorite cdn here and then a boatload as

211
00:07:56,160 --> 00:07:58,160
you could probably expect wordpress

212
00:07:58,160 --> 00:08:00,160
websites that were obviously left open

213
00:08:00,160 --> 00:08:03,520
or compromised in some way and so also

214
00:08:03,520 --> 00:08:05,520
not much sense to make out of it there

215
00:08:05,520 --> 00:08:08,240
so then we start looking at the files

216
00:08:08,240 --> 00:08:10,960
themselves um to try to see what's going

217
00:08:10,960 --> 00:08:13,520
on there and we look at one and it looks

218
00:08:13,520 --> 00:08:15,360
like this it's a stupid captcha on the

219
00:08:15,360 --> 00:08:16,879
first page and we say we've seen this

220
00:08:16,879 --> 00:08:18,319
before right let's see what the other

221
00:08:18,319 --> 00:08:20,560
one is the next one's another stupid

222
00:08:20,560 --> 00:08:22,560
capture next one's another super capture

223
00:08:22,560 --> 00:08:24,879
we've probably hand looked through a

224
00:08:24,879 --> 00:08:26,960
hundred of these at this point and found

225
00:08:26,960 --> 00:08:29,440
nothing but pdfs that look exactly like

226
00:08:29,440 --> 00:08:32,399
this but are all subtly different so

227
00:08:32,399 --> 00:08:35,919
page one huge blank page captcha the

228
00:08:35,919 --> 00:08:38,000
captcha is a link you click anywhere on

229
00:08:38,000 --> 00:08:40,080
it it's sending you to a url that

230
00:08:40,080 --> 00:08:42,159
usually looks innocuous we found a lot

231
00:08:42,159 --> 00:08:44,959
of feedburner urls there um different

232
00:08:44,959 --> 00:08:48,240
rss feed urls there clearly a technique

233
00:08:48,240 --> 00:08:49,519
where you can point somebody to

234
00:08:49,519 --> 00:08:51,360
something and that thing that they're

235
00:08:51,360 --> 00:08:52,880
going to grab is going to be the latest

236
00:08:52,880 --> 00:08:55,200
thing on a feed so you can keep changing

237
00:08:55,200 --> 00:08:56,560
what that payload is that they're

238
00:08:56,560 --> 00:08:58,720
getting there and you're also hitting a

239
00:08:58,720 --> 00:09:00,560
domain that's probably not going to be

240
00:09:00,560 --> 00:09:02,880
url filtered

241
00:09:02,880 --> 00:09:04,720
you click on one of those you end up

242
00:09:04,720 --> 00:09:06,000
going through just a boatload of

243
00:09:06,000 --> 00:09:08,560
redirects and at the end of it um all

244
00:09:08,560 --> 00:09:10,800
over the place i mentioned that i said

245
00:09:10,800 --> 00:09:12,800
this slice of the pie was fishing

246
00:09:12,800 --> 00:09:14,880
malware um so when we first saw these

247
00:09:14,880 --> 00:09:16,800
they were all leading to phishing pages

248
00:09:16,800 --> 00:09:18,320
and now we're seeing more and more of

249
00:09:18,320 --> 00:09:19,440
them and they're leading to malware

250
00:09:19,440 --> 00:09:21,760
download pages and scan pages and and

251
00:09:21,760 --> 00:09:24,560
spam and click fraud and some really

252
00:09:24,560 --> 00:09:27,200
graphic pornography i wish i could unsee

253
00:09:27,200 --> 00:09:29,839
um but that's that's like

254
00:09:29,839 --> 00:09:32,000
and they're also unrelated to a theme so

255
00:09:32,000 --> 00:09:33,920
like each one of these

256
00:09:33,920 --> 00:09:36,800
pdfs has a theme to it and then you

257
00:09:36,800 --> 00:09:38,240
click on the link and you go somewhere

258
00:09:38,240 --> 00:09:39,920
and there seems to be like no rhyme or

259
00:09:39,920 --> 00:09:42,000
reason to the theme of the pdf and then

260
00:09:42,000 --> 00:09:44,880
the uh the end and so the rest of the

261
00:09:44,880 --> 00:09:47,279
the pdf um every one of these has a

262
00:09:47,279 --> 00:09:48,560
title

263
00:09:48,560 --> 00:09:51,760
and the title is usually something very

264
00:09:51,760 --> 00:09:53,680
specific i picked one of the generic

265
00:09:53,680 --> 00:09:56,000
ones here that we saw a few times

266
00:09:56,000 --> 00:09:59,040
but the most common one that we saw was

267
00:09:59,040 --> 00:10:01,839
user manual and so it's always like

268
00:10:01,839 --> 00:10:03,519
something that none of us had ever heard

269
00:10:03,519 --> 00:10:05,600
of user manual it was like medical

270
00:10:05,600 --> 00:10:06,720
equipment

271
00:10:06,720 --> 00:10:09,680
very specific components of car engines

272
00:10:09,680 --> 00:10:12,240
uh industrial automation equipment a lot

273
00:10:12,240 --> 00:10:13,600
of different

274
00:10:13,600 --> 00:10:15,040
multimeters

275
00:10:15,040 --> 00:10:17,839
and they're like specific product names

276
00:10:17,839 --> 00:10:20,079
some standards documents some tax forms

277
00:10:20,079 --> 00:10:22,800
but it seems like the idea here is pick

278
00:10:22,800 --> 00:10:23,839
something

279
00:10:23,839 --> 00:10:26,560
so specific that if you can manage to

280
00:10:26,560 --> 00:10:29,040
get the search engines to index it it's

281
00:10:29,040 --> 00:10:30,480
probably going to be in that first page

282
00:10:30,480 --> 00:10:32,560
of search results and so somebody's

283
00:10:32,560 --> 00:10:35,040
probably going to see it and click on it

284
00:10:35,040 --> 00:10:38,079
the second you know page of that after

285
00:10:38,079 --> 00:10:41,120
that title is just like a bunch of text

286
00:10:41,120 --> 00:10:43,440
that they clearly just copied and pasted

287
00:10:43,440 --> 00:10:45,519
usually out of those user manuals so it

288
00:10:45,519 --> 00:10:47,360
said user manual for this

289
00:10:47,360 --> 00:10:50,240
then that entire user manual is at

290
00:10:50,240 --> 00:10:52,640
approximately that font size

291
00:10:52,640 --> 00:10:55,200
inside that pdf usually crammed into a

292
00:10:55,200 --> 00:10:57,839
page or two and then at the end

293
00:10:57,839 --> 00:10:59,760
you know they know their seo you need

294
00:10:59,760 --> 00:11:02,959
links um so the ends of these pdfs are

295
00:11:02,959 --> 00:11:05,120
usually links to a bunch of other pdfs

296
00:11:05,120 --> 00:11:07,760
exactly like this so they've got a

297
00:11:07,760 --> 00:11:10,079
system set up where when they generate

298
00:11:10,079 --> 00:11:12,240
one new ones they make sure they back

299
00:11:12,240 --> 00:11:13,519
link to the old ones that they've

300
00:11:13,519 --> 00:11:16,480
already got set up um so just super

301
00:11:16,480 --> 00:11:19,279
weird and so what are we doing about

302
00:11:19,279 --> 00:11:21,279
this right because we first saw this

303
00:11:21,279 --> 00:11:23,600
years ago right and what do you do you

304
00:11:23,600 --> 00:11:25,200
report them to everybody you can you

305
00:11:25,200 --> 00:11:27,200
report them to microsoft to google get

306
00:11:27,200 --> 00:11:29,440
them de-listed from the search engines

307
00:11:29,440 --> 00:11:31,519
you also if they're hosted somewhere

308
00:11:31,519 --> 00:11:33,040
where you have a hosting provider you

309
00:11:33,040 --> 00:11:34,880
can get in contact with you contact the

310
00:11:34,880 --> 00:11:36,880
hosting provider and that gets taken

311
00:11:36,880 --> 00:11:39,200
down so we've been doing this forever

312
00:11:39,200 --> 00:11:40,399
and then

313
00:11:40,399 --> 00:11:42,640
it was around november this started

314
00:11:42,640 --> 00:11:45,360
happening um meaning this is like four

315
00:11:45,360 --> 00:11:46,959
and a half x what we were seeing this

316
00:11:46,959 --> 00:11:49,519
time last year it's just crazy how fast

317
00:11:49,519 --> 00:11:52,320
this is going uh and so we continue to

318
00:11:52,320 --> 00:11:54,720
report uh they continue to get taken

319
00:11:54,720 --> 00:11:56,000
down

320
00:11:56,000 --> 00:11:58,079
you know usually microsoft and google

321
00:11:58,079 --> 00:12:00,480
are very fast and you go and you google

322
00:12:00,480 --> 00:12:03,200
those terms uh and and you won't find

323
00:12:03,200 --> 00:12:05,920
that anywhere the hosting providers are

324
00:12:05,920 --> 00:12:07,760
usually a little slower but i'm not as

325
00:12:07,760 --> 00:12:10,399
worried about the hosting providers if

326
00:12:10,399 --> 00:12:12,880
the main way to drive traffic there is

327
00:12:12,880 --> 00:12:14,160
now gone

328
00:12:14,160 --> 00:12:16,560
um and so the question is is it working

329
00:12:16,560 --> 00:12:18,720
um and i'd say

330
00:12:18,720 --> 00:12:20,720
i'm playing a really stupid game of

331
00:12:20,720 --> 00:12:22,959
whack-a-mole

332
00:12:22,959 --> 00:12:25,360
we are really good at taking down or

333
00:12:25,360 --> 00:12:26,959
helping to take down because we can't do

334
00:12:26,959 --> 00:12:29,120
anything but report the urls that we

335
00:12:29,120 --> 00:12:32,000
know about um but there's just new ones

336
00:12:32,000 --> 00:12:33,680
constantly right it's always new search

337
00:12:33,680 --> 00:12:35,360
terms it's always it's always something

338
00:12:35,360 --> 00:12:37,920
else and so um this is just something

339
00:12:37,920 --> 00:12:39,519
interesting right because again we think

340
00:12:39,519 --> 00:12:41,360
about how people end up clicking on

341
00:12:41,360 --> 00:12:42,720
malware and you're like oh it's

342
00:12:42,720 --> 00:12:44,639
obviously email

343
00:12:44,639 --> 00:12:47,839
and this is not email right this is just

344
00:12:47,839 --> 00:12:49,839
something that everybody does in their

345
00:12:49,839 --> 00:12:52,480
everyday life google something they need

346
00:12:52,480 --> 00:12:54,079
and then click on the result that seems

347
00:12:54,079 --> 00:12:56,000
like it's going to give it to them and

348
00:12:56,000 --> 00:12:58,639
then oh another captcha i click on those

349
00:12:58,639 --> 00:12:59,839
all the time right of course i'm going

350
00:12:59,839 --> 00:13:01,920
to click on the captcha i'll click on

351
00:13:01,920 --> 00:13:03,760
all the buses and the fire hydrants and

352
00:13:03,760 --> 00:13:05,680
then i'll get my manual

353
00:13:05,680 --> 00:13:08,800
so it's just like another way that

354
00:13:08,800 --> 00:13:10,959
what attackers are doing

355
00:13:10,959 --> 00:13:13,760
is really good marketing in the way that

356
00:13:13,760 --> 00:13:15,680
everybody else is doing marketing and

357
00:13:15,680 --> 00:13:18,560
it's becoming increasingly hard to train

358
00:13:18,560 --> 00:13:20,880
people regular people not security

359
00:13:20,880 --> 00:13:23,440
professionals right everybody else to

360
00:13:23,440 --> 00:13:25,279
just be able to recognize this right you

361
00:13:25,279 --> 00:13:27,360
should know every time you see a search

362
00:13:27,360 --> 00:13:29,360
result in google that that's a bad

363
00:13:29,360 --> 00:13:31,200
search result you shouldn't click on

364
00:13:31,200 --> 00:13:33,120
versus a good search result you should

365
00:13:33,120 --> 00:13:35,680
click on not super easy

366
00:13:35,680 --> 00:13:37,360
especially when things keep changing so

367
00:13:37,360 --> 00:13:38,480
much

368
00:13:38,480 --> 00:13:40,720
uh so that that was attack strategy

369
00:13:40,720 --> 00:13:42,399
number one i think i have a total of

370
00:13:42,399 --> 00:13:45,600
four of these so number two i'm calling

371
00:13:45,600 --> 00:13:48,240
meet people in the cloud

372
00:13:48,240 --> 00:13:50,720
and so when we look at all these malware

373
00:13:50,720 --> 00:13:52,720
downloads and where the actual malware

374
00:13:52,720 --> 00:13:55,120
download was hosted

375
00:13:55,120 --> 00:13:57,920
it's been hovering around for the past

376
00:13:57,920 --> 00:13:59,040
few years

377
00:13:59,040 --> 00:14:02,320
50 of them sitting on cloud apps versus

378
00:14:02,320 --> 00:14:04,720
you know the infected wordpress pages

379
00:14:04,720 --> 00:14:07,120
and all over the normal web

380
00:14:07,120 --> 00:14:09,199
and we always look at that list of the

381
00:14:09,199 --> 00:14:11,519
top apps and this goes back to make make

382
00:14:11,519 --> 00:14:12,880
sure i'm super clear about what i'm

383
00:14:12,880 --> 00:14:14,000
saying

384
00:14:14,000 --> 00:14:16,000
when you look at that list of top apps

385
00:14:16,000 --> 00:14:18,160
you're like omg

386
00:14:18,160 --> 00:14:20,399
that's microsoft and google and box and

387
00:14:20,399 --> 00:14:22,560
dropbox i can't believe that they are

388
00:14:22,560 --> 00:14:24,639
doing such a bad job

389
00:14:24,639 --> 00:14:26,160
that's not what's happening here they're

390
00:14:26,160 --> 00:14:28,800
doing an excellent job um they're trying

391
00:14:28,800 --> 00:14:30,639
to keep up with this as well

392
00:14:30,639 --> 00:14:33,199
they are just so incredibly popular that

393
00:14:33,199 --> 00:14:36,320
if an attacker manages to get malware uh

394
00:14:36,320 --> 00:14:38,880
hosted on one drive for a significant

395
00:14:38,880 --> 00:14:41,440
amount of time and manages to get people

396
00:14:41,440 --> 00:14:44,240
to click on links to visit that malware

397
00:14:44,240 --> 00:14:46,480
there's probably not a lot in terms of

398
00:14:46,480 --> 00:14:49,360
uh things they were trained to avoid um

399
00:14:49,360 --> 00:14:51,199
that that's gonna help them oh uh

400
00:14:51,199 --> 00:14:53,279
onedrive link cool i click on onedrive

401
00:14:53,279 --> 00:14:56,240
links a thousand times a day obviously

402
00:14:56,240 --> 00:14:57,600
i'm gonna click on this onedrive link

403
00:14:57,600 --> 00:15:00,639
too it seems super important

404
00:15:00,639 --> 00:15:03,199
and from a url filtering or

405
00:15:03,199 --> 00:15:05,519
dns filtering point of view right if

406
00:15:05,519 --> 00:15:07,680
you're filtering at that level also not

407
00:15:07,680 --> 00:15:09,199
going to do anything about onedrive

408
00:15:09,199 --> 00:15:10,560
right unless you decided you're going to

409
00:15:10,560 --> 00:15:13,760
block one drive and so you see um you

410
00:15:13,760 --> 00:15:16,480
know github box dropbox salesforce all

411
00:15:16,480 --> 00:15:18,880
sorts of uh things there and it's just

412
00:15:18,880 --> 00:15:21,199
like a list of popular apps you know the

413
00:15:21,199 --> 00:15:23,040
the ordering changes depending on who's

414
00:15:23,040 --> 00:15:25,920
doing what um you know i mentioned emote

415
00:15:25,920 --> 00:15:28,639
emote a few years ago picked box as

416
00:15:28,639 --> 00:15:31,120
their favorite cloud app to abuse and

417
00:15:31,120 --> 00:15:34,320
box was up top of this list for months

418
00:15:34,320 --> 00:15:37,199
um you know it just it's just the way it

419
00:15:37,199 --> 00:15:39,199
is right it's trends of where what

420
00:15:39,199 --> 00:15:41,199
attackers are doing and what users are

421
00:15:41,199 --> 00:15:43,600
falling for

422
00:15:43,600 --> 00:15:45,839
so just like to carve that up obviously

423
00:15:45,839 --> 00:15:47,759
the cloud storage apps are a big part of

424
00:15:47,759 --> 00:15:49,600
this because it's easy to throw anything

425
00:15:49,600 --> 00:15:51,519
on free cloud storage accounts um

426
00:15:51,519 --> 00:15:53,279
software hosting websites i think i have

427
00:15:53,279 --> 00:15:54,720
an example here of something that we

428
00:15:54,720 --> 00:15:56,880
recently saw on github but we see tons

429
00:15:56,880 --> 00:15:58,800
of stuff on github and sourceforge again

430
00:15:58,800 --> 00:16:00,000
because you can throw anything you want

431
00:16:00,000 --> 00:16:02,000
on github and sourceforge um file

432
00:16:02,000 --> 00:16:03,199
transfer

433
00:16:03,199 --> 00:16:04,800
zippyshare and we transfer are the

434
00:16:04,800 --> 00:16:06,399
biggest ones we see

435
00:16:06,399 --> 00:16:09,440
in that regard and then chat um you

436
00:16:09,440 --> 00:16:11,600
you'd probably think like social media

437
00:16:11,600 --> 00:16:13,440
would be higher up here we actually see

438
00:16:13,440 --> 00:16:15,360
more through chat especially through

439
00:16:15,360 --> 00:16:17,519
like discord than we've seen recently

440
00:16:17,519 --> 00:16:19,440
through social media so those seem to be

441
00:16:19,440 --> 00:16:20,959
like the favorite ways that that

442
00:16:20,959 --> 00:16:23,040
attackers are trying to reach users

443
00:16:23,040 --> 00:16:25,279
through non-traditional means outside of

444
00:16:25,279 --> 00:16:26,399
email

445
00:16:26,399 --> 00:16:29,440
um so my example here um this was one

446
00:16:29,440 --> 00:16:32,000
gustavo on my team just found this i

447
00:16:32,000 --> 00:16:33,839
think a month or two ago

448
00:16:33,839 --> 00:16:36,880
it's redline steeler redline steeler is

449
00:16:36,880 --> 00:16:38,720
not super new i think it's been around

450
00:16:38,720 --> 00:16:40,800
at least a year and a half

451
00:16:40,800 --> 00:16:43,120
it does exactly what its name says it

452
00:16:43,120 --> 00:16:44,959
does it steals

453
00:16:44,959 --> 00:16:48,399
typically save data in the browsers

454
00:16:48,399 --> 00:16:50,560
chat logs from discord and telegram uh

455
00:16:50,560 --> 00:16:52,880
any sort of vpn or ftp credentials it

456
00:16:52,880 --> 00:16:55,600
can find on the end host and the way we

457
00:16:55,600 --> 00:16:57,440
saw somebody distributing redline

458
00:16:57,440 --> 00:17:00,480
steeler was just like purely um let's

459
00:17:00,480 --> 00:17:02,160
hit people where they're probably

460
00:17:02,160 --> 00:17:04,720
seeking out information um not sort of

461
00:17:04,720 --> 00:17:06,720
go after them with email so i actually

462
00:17:06,720 --> 00:17:09,359
spun up a youtube channel and talked

463
00:17:09,359 --> 00:17:10,880
about something that they figured

464
00:17:10,880 --> 00:17:12,480
everybody would get excited about

465
00:17:12,480 --> 00:17:15,359
cryptocurrency right uh crypto

466
00:17:15,359 --> 00:17:18,079
youtube channel and all those videos and

467
00:17:18,079 --> 00:17:20,160
the person's profile everything was

468
00:17:20,160 --> 00:17:22,400
linking to uh chrome extension you

469
00:17:22,400 --> 00:17:25,119
should download from github um that

470
00:17:25,119 --> 00:17:27,119
wasn't a chrome extension at all it was

471
00:17:27,119 --> 00:17:29,840
actually just redline steeler and so we

472
00:17:29,840 --> 00:17:31,679
we found this because

473
00:17:31,679 --> 00:17:33,679
you know somebody fell for this we saw

474
00:17:33,679 --> 00:17:36,720
the refers we saw it came from youtube

475
00:17:36,720 --> 00:17:40,320
and we helped get this taken down both

476
00:17:40,320 --> 00:17:43,760
by youtube and github

477
00:17:43,760 --> 00:17:44,880
so next

478
00:17:44,880 --> 00:17:47,280
strategy here is you know the same way

479
00:17:47,280 --> 00:17:50,000
you're sort of going to cloud apps

480
00:17:50,000 --> 00:17:51,520
because those are the cloud ups that you

481
00:17:51,520 --> 00:17:53,120
know everybody's using so they're

482
00:17:53,120 --> 00:17:54,880
probably going to fall for and click on

483
00:17:54,880 --> 00:17:57,200
and and you know allow those attacks to

484
00:17:57,200 --> 00:17:59,039
happen also make sure that when you're

485
00:17:59,039 --> 00:18:01,120
going somewhere on the web that that

486
00:18:01,120 --> 00:18:02,720
place you go on the web is also

487
00:18:02,720 --> 00:18:05,200
somewhere a user is likely to click and

488
00:18:05,200 --> 00:18:07,600
so like i said it's about 50 50 split of

489
00:18:07,600 --> 00:18:09,760
the malware coming from weber cloud

490
00:18:09,760 --> 00:18:11,919
and the breakdown here

491
00:18:11,919 --> 00:18:13,360
you look at this and your initial

492
00:18:13,360 --> 00:18:15,679
reaction is probably like well hell yeah

493
00:18:15,679 --> 00:18:17,440
i'm blocking some of that stuff because

494
00:18:17,440 --> 00:18:19,520
it's super easy because why in the world

495
00:18:19,520 --> 00:18:20,960
would i allow people to download

496
00:18:20,960 --> 00:18:23,120
shareware and freeware sites uh let's

497
00:18:23,120 --> 00:18:24,880
just block all those and those

498
00:18:24,880 --> 00:18:27,200
uncategorized sites let's just block all

499
00:18:27,200 --> 00:18:29,120
of that too and we're winning now

500
00:18:29,120 --> 00:18:31,360
because we're blocking 25 of all the

501
00:18:31,360 --> 00:18:33,280
malware downloads that we've recently

502
00:18:33,280 --> 00:18:35,120
seen right and so that's that's kind of

503
00:18:35,120 --> 00:18:36,799
the point here is like the the

504
00:18:36,799 --> 00:18:38,480
conventional wisdom of like block the

505
00:18:38,480 --> 00:18:41,200
bad stuff uh kind of drove attackers to

506
00:18:41,200 --> 00:18:42,720
make sure they weren't going to the bad

507
00:18:42,720 --> 00:18:45,039
places need to make sure they go to the

508
00:18:45,039 --> 00:18:46,799
the the more legitimate places where

509
00:18:46,799 --> 00:18:47,840
it's going to be harder for you to

510
00:18:47,840 --> 00:18:51,520
filter them away and so content servers

511
00:18:51,520 --> 00:18:53,360
are the biggest block here right about

512
00:18:53,360 --> 00:18:56,400
one-fifth of it that's cdns all kinds of

513
00:18:56,400 --> 00:18:58,000
different cdns that's just how the web

514
00:18:58,000 --> 00:18:59,520
works right and so

515
00:18:59,520 --> 00:19:01,520
the web works that way for normal people

516
00:19:01,520 --> 00:19:03,760
doing benign things the web works that

517
00:19:03,760 --> 00:19:05,760
way for attackers doing malicious things

518
00:19:05,760 --> 00:19:08,080
get the malware on those cdns uh it's

519
00:19:08,080 --> 00:19:09,440
going to be a little harder to filter

520
00:19:09,440 --> 00:19:12,799
out the business and technology sites

521
00:19:12,799 --> 00:19:15,120
two very distinct trends that we're

522
00:19:15,120 --> 00:19:18,760
seeing there one is find a business or

523
00:19:18,760 --> 00:19:21,440
technology-oriented wordpress site

524
00:19:21,440 --> 00:19:23,120
and link to your malware from it right

525
00:19:23,120 --> 00:19:24,960
because odds are they didn't patch right

526
00:19:24,960 --> 00:19:27,520
um there's a way for us to use that um

527
00:19:27,520 --> 00:19:28,880
the other one

528
00:19:28,880 --> 00:19:31,679
which is a little uh easier for an

529
00:19:31,679 --> 00:19:34,240
attacker to do is just spin up a new

530
00:19:34,240 --> 00:19:37,919
website copy some existing website

531
00:19:37,919 --> 00:19:41,200
that has a lot of content host it there

532
00:19:41,200 --> 00:19:44,320
for a while so that web root and all the

533
00:19:44,320 --> 00:19:47,360
url classifying services on the web find

534
00:19:47,360 --> 00:19:49,200
it and classify it and say oh yep this

535
00:19:49,200 --> 00:19:51,679
is a technology site then start abusing

536
00:19:51,679 --> 00:19:53,440
things right so we've seen lots of just

537
00:19:53,440 --> 00:19:56,480
like mirrors of yahoo's landing page

538
00:19:56,480 --> 00:19:59,679
mirrors of aol's landing page mirrors of

539
00:19:59,679 --> 00:20:02,000
blogs mirrors of anything you can think

540
00:20:02,000 --> 00:20:04,159
of run your web crawler

541
00:20:04,159 --> 00:20:06,640
scrape that site spin it up on your own

542
00:20:06,640 --> 00:20:09,120
web server uh wait till it's classified

543
00:20:09,120 --> 00:20:11,520
as normal traffic uh then launch your

544
00:20:11,520 --> 00:20:14,159
attack and so this is just another way

545
00:20:14,159 --> 00:20:16,320
that sure you still have to drive people

546
00:20:16,320 --> 00:20:18,880
to that site um but you're at least kind

547
00:20:18,880 --> 00:20:20,880
of confident that that simple url

548
00:20:20,880 --> 00:20:22,480
filters aren't going to filter that

549
00:20:22,480 --> 00:20:24,960
stuff out

550
00:20:24,960 --> 00:20:27,360
and so the the last one because i led

551
00:20:27,360 --> 00:20:29,679
with of course the answer is email

552
00:20:29,679 --> 00:20:31,679
the last one i just wanted to share was

553
00:20:31,679 --> 00:20:34,080
get a little bit more creative than you

554
00:20:34,080 --> 00:20:36,000
used to be with email

555
00:20:36,000 --> 00:20:37,679
and especially because you know

556
00:20:37,679 --> 00:20:39,520
everybody in the whole world in the

557
00:20:39,520 --> 00:20:41,919
enterprise is using google workspaces or

558
00:20:41,919 --> 00:20:43,120
onedrive

559
00:20:43,120 --> 00:20:45,039
so a really nice way to

560
00:20:45,039 --> 00:20:46,400
meet them there

561
00:20:46,400 --> 00:20:48,480
and generate some really nice emails is

562
00:20:48,480 --> 00:20:51,039
just start uploading bad stuff to

563
00:20:51,039 --> 00:20:54,000
onedrive and google drive and start

564
00:20:54,000 --> 00:20:56,400
commenting on it which obviously you do

565
00:20:56,400 --> 00:20:59,919
automated uh through api and

566
00:20:59,919 --> 00:21:02,480
target whoever you want right at um

567
00:21:02,480 --> 00:21:04,159
however many people google will allow

568
00:21:04,159 --> 00:21:06,720
you to in every comment and try to drive

569
00:21:06,720 --> 00:21:09,280
people to those documents and so this is

570
00:21:09,280 --> 00:21:12,640
just one example of a pretty

571
00:21:12,640 --> 00:21:15,280
low effort one um you know this was just

572
00:21:15,280 --> 00:21:18,159
like a fake shipping invoice um i don't

573
00:21:18,159 --> 00:21:20,240
think anybody actually fell for this one

574
00:21:20,240 --> 00:21:21,440
uh but

575
00:21:21,440 --> 00:21:23,679
um we see a lot of these that are more

576
00:21:23,679 --> 00:21:26,960
targeted uh more sophisticated uh that

577
00:21:26,960 --> 00:21:28,559
look like they're coming from somebody

578
00:21:28,559 --> 00:21:30,880
that you work with because it's easy to

579
00:21:30,880 --> 00:21:32,480
set your name to whatever you want your

580
00:21:32,480 --> 00:21:34,559
name to be when you create a onedrive or

581
00:21:34,559 --> 00:21:37,120
a google drive account and that's that

582
00:21:37,120 --> 00:21:39,039
right i've seen a bunch of these coming

583
00:21:39,039 --> 00:21:40,480
from my ceo

584
00:21:40,480 --> 00:21:41,919
i've seen a bunch of these coming from

585
00:21:41,919 --> 00:21:45,200
other companies ceos to their employees

586
00:21:45,200 --> 00:21:48,480
and it's just you know another way that

587
00:21:48,480 --> 00:21:50,240
you might catch somebody off guard

588
00:21:50,240 --> 00:21:53,360
because i probably have a hundred emails

589
00:21:53,360 --> 00:21:56,159
per day of somebody tagged you in a

590
00:21:56,159 --> 00:21:57,280
document

591
00:21:57,280 --> 00:21:58,880
and so you just get used to either

592
00:21:58,880 --> 00:22:01,200
clicking to go to those documents or

593
00:22:01,200 --> 00:22:02,640
clicking on whatever the thing is

594
00:22:02,640 --> 00:22:04,400
somebody's trying to push you to in one

595
00:22:04,400 --> 00:22:06,320
of those documents and your email

596
00:22:06,320 --> 00:22:07,600
filters

597
00:22:07,600 --> 00:22:09,200
aren't filtering this kind of stuff out

598
00:22:09,200 --> 00:22:11,120
either

599
00:22:11,120 --> 00:22:14,240
so that brings me to uh defensive

600
00:22:14,240 --> 00:22:16,240
strategies that maybe we can put in

601
00:22:16,240 --> 00:22:18,720
place to do something about this

602
00:22:18,720 --> 00:22:21,520
and so um you know the the first lesson

603
00:22:21,520 --> 00:22:23,840
that i take from this is that

604
00:22:23,840 --> 00:22:25,840
if you're doing

605
00:22:25,840 --> 00:22:28,960
url filtering at the category or domain

606
00:22:28,960 --> 00:22:31,840
level it's just really not effective

607
00:22:31,840 --> 00:22:34,720
against the majority of the stuff we see

608
00:22:34,720 --> 00:22:37,039
users getting to today

609
00:22:37,039 --> 00:22:40,400
the tax shifting to the cloud apps have

610
00:22:40,400 --> 00:22:43,760
made uh you know that a lot harder um

611
00:22:43,760 --> 00:22:46,559
once upon a time we used to joke how

612
00:22:46,559 --> 00:22:48,799
long until this this url feed that we

613
00:22:48,799 --> 00:22:51,480
subscribed to sends us

614
00:22:51,480 --> 00:22:54,000
drive.google.com again as one of those

615
00:22:54,000 --> 00:22:56,559
malicious uh domains we need to block on

616
00:22:56,559 --> 00:22:58,240
account of how much malware they saw at

617
00:22:58,240 --> 00:23:00,480
drive.google.com

618
00:23:00,480 --> 00:23:02,960
the the second one here is that

619
00:23:02,960 --> 00:23:04,400
attackers

620
00:23:04,400 --> 00:23:07,200
are most successful when they're trying

621
00:23:07,200 --> 00:23:10,240
to catch their victims off guard so

622
00:23:10,240 --> 00:23:13,440
sure we still see a lot of just stupid

623
00:23:13,440 --> 00:23:15,600
email driven click on this link and

624
00:23:15,600 --> 00:23:17,440
they'll get to a bad thing

625
00:23:17,440 --> 00:23:19,760
type stuff but it's getting more

626
00:23:19,760 --> 00:23:20,960
creative

627
00:23:20,960 --> 00:23:23,520
those search engine results i mean who

628
00:23:23,520 --> 00:23:25,760
who's taken a security training here

629
00:23:25,760 --> 00:23:28,240
where you were warned to be wary of

630
00:23:28,240 --> 00:23:31,039
search engine results anybody

631
00:23:31,039 --> 00:23:33,280
i i've never seen one right but this has

632
00:23:33,280 --> 00:23:35,440
been happening for at least two and a

633
00:23:35,440 --> 00:23:37,280
half years that i'm aware of right but

634
00:23:37,280 --> 00:23:38,960
no security training for that because

635
00:23:38,960 --> 00:23:41,279
what are you going to tell people um the

636
00:23:41,279 --> 00:23:43,360
other challenge right with security

637
00:23:43,360 --> 00:23:45,120
training and cloud apps and that kind of

638
00:23:45,120 --> 00:23:46,799
stuff and i know i'm supposed to be

639
00:23:46,799 --> 00:23:48,720
talking about malware but i'll digress a

640
00:23:48,720 --> 00:23:49,840
little bit

641
00:23:49,840 --> 00:23:52,880
a lot of the fishing pages we see today

642
00:23:52,880 --> 00:23:55,200
are hosted on whatever app they're

643
00:23:55,200 --> 00:23:58,159
fishing for right so we see a lot of

644
00:23:58,159 --> 00:24:00,559
office 365 phishing pages

645
00:24:00,559 --> 00:24:02,880
hosted on azure websites

646
00:24:02,880 --> 00:24:04,720
and when all you've trained your users

647
00:24:04,720 --> 00:24:07,360
to do is just be suspicious of things

648
00:24:07,360 --> 00:24:10,480
when there's uh no green lock next to

649
00:24:10,480 --> 00:24:12,720
the url or when you click on that green

650
00:24:12,720 --> 00:24:15,679
lock the certificate's issued to uh

651
00:24:15,679 --> 00:24:18,960
godaddy or let's encrypt or maybe when

652
00:24:18,960 --> 00:24:20,640
you look at the url you're like that's a

653
00:24:20,640 --> 00:24:22,159
weird url

654
00:24:22,159 --> 00:24:24,000
but when these kinds of phishing pages

655
00:24:24,000 --> 00:24:27,279
get spun up that certificate is issued

656
00:24:27,279 --> 00:24:29,240
by microsoft to

657
00:24:29,240 --> 00:24:32,320
windows.net which is owned by microsoft

658
00:24:32,320 --> 00:24:34,320
and it's got a really pretty green lock

659
00:24:34,320 --> 00:24:36,320
there and so it's just becoming it's

660
00:24:36,320 --> 00:24:38,480
just becoming really hard right and so i

661
00:24:38,480 --> 00:24:41,120
i don't want to sound like i'm too down

662
00:24:41,120 --> 00:24:43,039
on the trainings right but there's a

663
00:24:43,039 --> 00:24:45,520
limit to how effective trainings can

664
00:24:45,520 --> 00:24:46,799
really be

665
00:24:46,799 --> 00:24:48,799
and how much you can change users

666
00:24:48,799 --> 00:24:51,120
behavior without turning them into

667
00:24:51,120 --> 00:24:52,720
somebody like us

668
00:24:52,720 --> 00:24:55,679
who is paranoid of everything trusts

669
00:24:55,679 --> 00:24:58,720
nobody never clicks on anything ever

670
00:24:58,720 --> 00:25:00,240
except in their special machine that

671
00:25:00,240 --> 00:25:02,320
they use to click on things right and

672
00:25:02,320 --> 00:25:03,600
that's not what we're trying to do to

673
00:25:03,600 --> 00:25:05,520
the world right because we probably all

674
00:25:05,520 --> 00:25:07,760
lose our jobs if we went back and said

675
00:25:07,760 --> 00:25:10,240
yep we have to block search engines uh

676
00:25:10,240 --> 00:25:13,200
emails and most cloud apps uh to solve

677
00:25:13,200 --> 00:25:14,720
the malware problem right that's not

678
00:25:14,720 --> 00:25:16,080
that's not what we're advocating for

679
00:25:16,080 --> 00:25:18,400
sorry that was my digression so creative

680
00:25:18,400 --> 00:25:21,039
email work on search engines work um

681
00:25:21,039 --> 00:25:23,120
these cloud apps work and we need to

682
00:25:23,120 --> 00:25:24,799
make sure we're doing something to

683
00:25:24,799 --> 00:25:27,520
address those um so sort of like my call

684
00:25:27,520 --> 00:25:30,000
to action is um

685
00:25:30,000 --> 00:25:32,720
please please please double check your

686
00:25:32,720 --> 00:25:35,919
security controls um i know you steer

687
00:25:35,919 --> 00:25:37,360
all your traffic through your network

688
00:25:37,360 --> 00:25:39,600
security controls because obviously do

689
00:25:39,600 --> 00:25:41,919
you do right um except for that traffic

690
00:25:41,919 --> 00:25:44,320
you don't steer right that traffic

691
00:25:44,320 --> 00:25:45,840
wasn't you weren't thinking about that

692
00:25:45,840 --> 00:25:47,840
when you said we steer everything and i

693
00:25:47,840 --> 00:25:49,360
know there's a lot of vendors out there

694
00:25:49,360 --> 00:25:51,520
that say um well don't steer our traffic

695
00:25:51,520 --> 00:25:53,279
through your security controls it's too

696
00:25:53,279 --> 00:25:55,520
much traffic and nothing bad will ever

697
00:25:55,520 --> 00:25:58,080
come through our network right and so

698
00:25:58,080 --> 00:26:00,240
that that's not what we're seeing right

699
00:26:00,240 --> 00:26:01,120
we are

700
00:26:01,120 --> 00:26:02,559
seeing bad things make it to their

701
00:26:02,559 --> 00:26:05,120
victims through those networks um also

702
00:26:05,120 --> 00:26:07,039
when you're checking those controls make

703
00:26:07,039 --> 00:26:09,600
sure you're not like entirely dependent

704
00:26:09,600 --> 00:26:12,159
on domain based blocking and

705
00:26:12,159 --> 00:26:14,240
category-based blocking it'll be

706
00:26:14,240 --> 00:26:17,360
effective you will block a lot of stuff

707
00:26:17,360 --> 00:26:19,200
and if your goal is to come up with some

708
00:26:19,200 --> 00:26:21,520
awesome charts to show your board of how

709
00:26:21,520 --> 00:26:23,279
much stuff you blocked it'll be big

710
00:26:23,279 --> 00:26:24,720
numbers right because there's still a

711
00:26:24,720 --> 00:26:26,400
lot of malicious stuff on the

712
00:26:26,400 --> 00:26:29,200
uncategorized websites and on the dot x

713
00:26:29,200 --> 00:26:32,000
y z and dot r u and all sorts of weird

714
00:26:32,000 --> 00:26:34,720
uh tlds that are easy to block it's just

715
00:26:34,720 --> 00:26:36,480
not everything and the stuff that's

716
00:26:36,480 --> 00:26:38,080
making it through is obviously the stuff

717
00:26:38,080 --> 00:26:40,559
that's not on those tlds and not on

718
00:26:40,559 --> 00:26:42,720
those domains

719
00:26:42,720 --> 00:26:45,760
so um the other thing that i just i

720
00:26:45,760 --> 00:26:48,000
couldn't resist i really just wanted to

721
00:26:48,000 --> 00:26:50,240
talk about where malware comes from

722
00:26:50,240 --> 00:26:52,159
but i couldn't resist also talking about

723
00:26:52,159 --> 00:26:55,039
what weird stuff we see malware doing um

724
00:26:55,039 --> 00:26:57,279
after it lands on somebody's machine

725
00:26:57,279 --> 00:26:59,360
and so um this is kind of like the

726
00:26:59,360 --> 00:27:02,159
what's next this is the we're seeing

727
00:27:02,159 --> 00:27:05,200
some of this uh and it's starting to

728
00:27:05,200 --> 00:27:07,360
make us nervous that that attackers

729
00:27:07,360 --> 00:27:09,840
might have realized how successful this

730
00:27:09,840 --> 00:27:13,039
is and start doing more of it and that's

731
00:27:13,039 --> 00:27:14,720
the getting creative with your

732
00:27:14,720 --> 00:27:16,080
commanding control

733
00:27:16,080 --> 00:27:18,559
and so um traditional command control is

734
00:27:18,559 --> 00:27:20,399
like what's going on in the top of this

735
00:27:20,399 --> 00:27:22,399
slide right you have an attacker who

736
00:27:22,399 --> 00:27:23,840
obviously that's an attacker because

737
00:27:23,840 --> 00:27:26,080
they're using green uh text on a black

738
00:27:26,080 --> 00:27:28,000
background that's that's for me i know

739
00:27:28,000 --> 00:27:29,440
that everybody uses like the person in

740
00:27:29,440 --> 00:27:31,440
the hoodie i like the green text right

741
00:27:31,440 --> 00:27:33,760
that's that's only hackers uh i love the

742
00:27:33,760 --> 00:27:35,840
matrix growing up

743
00:27:35,840 --> 00:27:38,480
and they spin up their own server

744
00:27:38,480 --> 00:27:39,840
and they use that server for whatever

745
00:27:39,840 --> 00:27:41,520
right it's a one-way communication a

746
00:27:41,520 --> 00:27:43,440
dead drop resolver maybe it's two-way

747
00:27:43,440 --> 00:27:45,760
communication but the fact that it's an

748
00:27:45,760 --> 00:27:48,399
attacker-controlled server um you know

749
00:27:48,399 --> 00:27:49,760
and it's been that way for a long time

750
00:27:49,760 --> 00:27:52,080
means that we've gotten pretty good at

751
00:27:52,080 --> 00:27:52,960
uh

752
00:27:52,960 --> 00:27:54,559
detecting and protecting against that

753
00:27:54,559 --> 00:27:57,360
stuff right we we have dga detection

754
00:27:57,360 --> 00:27:59,200
algorithms where we can identify dga

755
00:27:59,200 --> 00:28:02,159
domains and block them proactively

756
00:28:02,159 --> 00:28:05,440
you know a lot of those um

757
00:28:05,440 --> 00:28:07,520
you know like top-level domains you can

758
00:28:07,520 --> 00:28:10,000
just block them you can get tons of

759
00:28:10,000 --> 00:28:12,399
cerakotta rules that you can put into

760
00:28:12,399 --> 00:28:14,640
place that's going to block a lot of

761
00:28:14,640 --> 00:28:16,399
what we see for commanding control and

762
00:28:16,399 --> 00:28:18,799
you can have a really good defense event

763
00:28:18,799 --> 00:28:20,399
against commanding control there sure

764
00:28:20,399 --> 00:28:22,080
you're still worried about

765
00:28:22,080 --> 00:28:25,039
malleable c2 and cobalt strike right

766
00:28:25,039 --> 00:28:26,799
like that's that's one where maybe we

767
00:28:26,799 --> 00:28:29,039
haven't fully gotten a hand around

768
00:28:29,039 --> 00:28:30,399
staying ahead of what's going on with

769
00:28:30,399 --> 00:28:32,799
cobalt strike in the wild but

770
00:28:32,799 --> 00:28:34,480
it's pretty good right we're we feel

771
00:28:34,480 --> 00:28:36,720
like we've got a good strategy there and

772
00:28:36,720 --> 00:28:39,440
what we've seen start happening

773
00:28:39,440 --> 00:28:42,399
is that those attackers have figured out

774
00:28:42,399 --> 00:28:45,039
that infrastructure is hard

775
00:28:45,039 --> 00:28:47,840
that cloud apps are cheap uh that nobody

776
00:28:47,840 --> 00:28:49,600
blocks them and that it's super easy to

777
00:28:49,600 --> 00:28:50,799
use

778
00:28:50,799 --> 00:28:53,360
and so all of that stuff

779
00:28:53,360 --> 00:28:54,960
we've seen just start happening over

780
00:28:54,960 --> 00:28:56,559
cloud apps

781
00:28:56,559 --> 00:28:59,520
we've seen um dead drop resolvers in the

782
00:28:59,520 --> 00:29:02,159
form of youtube comments um in the form

783
00:29:02,159 --> 00:29:05,279
of uh just files uploaded to random s3

784
00:29:05,279 --> 00:29:07,760
buckets all over the internet um

785
00:29:07,760 --> 00:29:10,720
comments added to emails all sorts of

786
00:29:10,720 --> 00:29:13,679
weird things right if you find an app

787
00:29:13,679 --> 00:29:16,320
where you can post something publicly or

788
00:29:16,320 --> 00:29:17,760
send a message

789
00:29:17,760 --> 00:29:19,520
it's a really nice app to use for

790
00:29:19,520 --> 00:29:22,240
command and control and so

791
00:29:22,240 --> 00:29:24,559
to sort of illustrate that this isn't

792
00:29:24,559 --> 00:29:27,200
like some crazy uh thing that ray's

793
00:29:27,200 --> 00:29:28,399
talking about that's not really

794
00:29:28,399 --> 00:29:29,360
happening

795
00:29:29,360 --> 00:29:32,399
i collected uh just a few

796
00:29:32,399 --> 00:29:33,679
examples

797
00:29:33,679 --> 00:29:34,880
of

798
00:29:34,880 --> 00:29:37,840
different attackers and campaigns we've

799
00:29:37,840 --> 00:29:40,000
seen just in the past few months and

800
00:29:40,000 --> 00:29:42,480
what cloud apps they were using and so

801
00:29:42,480 --> 00:29:45,760
you see again like what's the theme

802
00:29:45,760 --> 00:29:47,279
i don't know what the theme is the theme

803
00:29:47,279 --> 00:29:48,880
is there seem to be just picking their

804
00:29:48,880 --> 00:29:50,320
favorite cloud apps the ones they're

805
00:29:50,320 --> 00:29:53,360
most familiar with um because you know

806
00:29:53,360 --> 00:29:56,240
uh they they just know how to do it um

807
00:29:56,240 --> 00:29:58,880
the other thing that helps is that a lot

808
00:29:58,880 --> 00:30:02,399
of people have written um toolkits uh to

809
00:30:02,399 --> 00:30:04,320
do this and they've posted them to

810
00:30:04,320 --> 00:30:08,320
github uh so there's uh c3 there's slack

811
00:30:08,320 --> 00:30:10,880
or there's twit ore there's a bunch of

812
00:30:10,880 --> 00:30:12,480
these if you go to github and just look

813
00:30:12,480 --> 00:30:15,520
for like cloud command and control tools

814
00:30:15,520 --> 00:30:17,039
there's a bunch of these tools that you

815
00:30:17,039 --> 00:30:18,960
can just download and they're really

816
00:30:18,960 --> 00:30:20,960
useful for people like us

817
00:30:20,960 --> 00:30:22,799
because it's fun to run them in our

818
00:30:22,799 --> 00:30:25,200
environment and say hey if somebody

819
00:30:25,200 --> 00:30:27,520
started using twitter as a command and

820
00:30:27,520 --> 00:30:29,919
control channel would anybody notice

821
00:30:29,919 --> 00:30:31,840
right would any of our security controls

822
00:30:31,840 --> 00:30:34,399
say it's really weird that ray started

823
00:30:34,399 --> 00:30:38,159
tweeting uh base64 encoded strings every

824
00:30:38,159 --> 00:30:41,840
10 minutes uh and he does it 24 7 now

825
00:30:41,840 --> 00:30:43,679
and so you know like and so what i'm

826
00:30:43,679 --> 00:30:45,840
trying to indicate there is like there

827
00:30:45,840 --> 00:30:46,720
are

828
00:30:46,720 --> 00:30:49,039
ways to detect this kind of stuff

829
00:30:49,039 --> 00:30:51,520
it's just that maybe the tools we've

830
00:30:51,520 --> 00:30:53,520
already set up aren't good at detecting

831
00:30:53,520 --> 00:30:54,880
this right it's not easy to write a

832
00:30:54,880 --> 00:30:58,240
circada rule that detects twitter posts

833
00:30:58,240 --> 00:31:00,240
from rey without

834
00:31:00,240 --> 00:31:02,640
completely breaking twitter um so that's

835
00:31:02,640 --> 00:31:04,720
that's sort of the the the takeaway

836
00:31:04,720 --> 00:31:08,320
there on the command and control side um

837
00:31:08,320 --> 00:31:11,279
and so that was about it i left a a

838
00:31:11,279 --> 00:31:14,640
healthy blanket of time for questions um

839
00:31:14,640 --> 00:31:16,320
so if you have any questions i'm here to

840
00:31:16,320 --> 00:31:18,790
entertain them

841
00:31:18,790 --> 00:31:27,119
[Applause]

842
00:31:29,760 --> 00:31:31,360
if nobody has questions i do have like

843
00:31:31,360 --> 00:31:33,919
some survey questions i love asking

844
00:31:33,919 --> 00:31:36,399
questions like this so when when i s

845
00:31:36,399 --> 00:31:38,080
when you saw the title to this

846
00:31:38,080 --> 00:31:40,640
presentation whose reaction was like

847
00:31:40,640 --> 00:31:42,640
email or like something just like

848
00:31:42,640 --> 00:31:44,159
guttural where you were like i know the

849
00:31:44,159 --> 00:31:45,600
answer to this because i deal with this

850
00:31:45,600 --> 00:31:48,158
all the time

851
00:31:49,200 --> 00:31:50,080
so

852
00:31:50,080 --> 00:31:52,320
like okay there's a few of them is there

853
00:31:52,320 --> 00:31:54,320
anything that like i talked about here

854
00:31:54,320 --> 00:31:57,200
that you're seeing in your environments

855
00:31:57,200 --> 00:32:00,159
um or like did you learn something new

856
00:32:00,159 --> 00:32:01,679
like something here i talked about that

857
00:32:01,679 --> 00:32:04,960
you haven't seen yet

858
00:32:10,240 --> 00:32:11,679
in the last couple

859
00:32:11,679 --> 00:32:13,679
so that comment was we've had a couple

860
00:32:13,679 --> 00:32:16,240
google drive phishing emails in the last

861
00:32:16,240 --> 00:32:18,960
couple hours um that sounds about right

862
00:32:18,960 --> 00:32:20,960
and you said a couple a couple hundred

863
00:32:20,960 --> 00:32:23,679
or literally just like two

864
00:32:23,679 --> 00:32:27,600
a couple unique yeah so so the the

865
00:32:27,600 --> 00:32:28,640
right

866
00:32:28,640 --> 00:32:31,200
the the google drive phishing email

867
00:32:31,200 --> 00:32:34,080
thing um is really interesting too um

868
00:32:34,080 --> 00:32:34,880
because

869
00:32:34,880 --> 00:32:36,640
i mean like it's a phishing email i

870
00:32:36,640 --> 00:32:38,559
don't know if what you saw was like you

871
00:32:38,559 --> 00:32:42,000
know a comment or a google drive file or

872
00:32:42,000 --> 00:32:44,000
something related to phishing um but one

873
00:32:44,000 --> 00:32:46,320
of the things we started to see more and

874
00:32:46,320 --> 00:32:49,679
more is like a fake google drive plugin

875
00:32:49,679 --> 00:32:52,480
and so it's a you know it's a please

876
00:32:52,480 --> 00:32:55,840
authorize uh access to google drive to

877
00:32:55,840 --> 00:32:59,519
this seemingly innocuous and useful app

878
00:32:59,519 --> 00:33:01,120
and that's kind of like the newest

879
00:33:01,120 --> 00:33:02,399
version of phishing we've seen and so

880
00:33:02,399 --> 00:33:04,000
we've seen it for it's mostly been

881
00:33:04,000 --> 00:33:08,480
google drive and microsoft 365. and the

882
00:33:08,480 --> 00:33:11,120
the flavor is usually like here's a fake

883
00:33:11,120 --> 00:33:13,360
plugin please authorize it and all it

884
00:33:13,360 --> 00:33:15,519
needs is permissions to read your email

885
00:33:15,519 --> 00:33:17,200
and send email on your behalf and

886
00:33:17,200 --> 00:33:18,960
typically to view all of your documents

887
00:33:18,960 --> 00:33:22,640
either in google drive or microsoft 365.

888
00:33:22,640 --> 00:33:24,080
and it's really hard right because like

889
00:33:24,080 --> 00:33:26,000
if it's a if it's a credential phishing

890
00:33:26,000 --> 00:33:30,080
email for google drive or onedrive

891
00:33:30,080 --> 00:33:32,880
you have mfa of course right

892
00:33:32,880 --> 00:33:35,200
you have mfa right so what good is it if

893
00:33:35,200 --> 00:33:37,440
the attacker gets the the email uh or

894
00:33:37,440 --> 00:33:39,120
gets the the username and password for

895
00:33:39,120 --> 00:33:40,720
the email but

896
00:33:40,720 --> 00:33:43,120
if they authorize that plugin they're

897
00:33:43,120 --> 00:33:44,960
already authenticated they already did

898
00:33:44,960 --> 00:33:47,600
the mfa step up and all they're doing is

899
00:33:47,600 --> 00:33:50,640
clicking and saying allow um and that's

900
00:33:50,640 --> 00:33:53,679
i mean it's just a lot harder to prevent

901
00:33:53,679 --> 00:33:56,080
you can go in and disable that feature

902
00:33:56,080 --> 00:33:57,679
um which

903
00:33:57,679 --> 00:33:59,679
is not a bad idea if you don't think

904
00:33:59,679 --> 00:34:01,840
your users should be allowing

905
00:34:01,840 --> 00:34:03,679
whatever they feel like they should

906
00:34:03,679 --> 00:34:04,960
allow

907
00:34:04,960 --> 00:34:06,559
you can also monitor it right there's

908
00:34:06,559 --> 00:34:08,480
logs of that stuff you can go in and see

909
00:34:08,480 --> 00:34:11,119
the stuff that everybody's authorized um

910
00:34:11,119 --> 00:34:13,359
the the first time we looked to see what

911
00:34:13,359 --> 00:34:16,320
people had authorized uh it just in our

912
00:34:16,320 --> 00:34:19,599
company internally i think

913
00:34:19,599 --> 00:34:21,520
somebody almost fainted in the meeting

914
00:34:21,520 --> 00:34:23,440
because we thought oh it's pretty bad i

915
00:34:23,440 --> 00:34:25,040
bet you people have authorized like two

916
00:34:25,040 --> 00:34:26,800
or three things each and there'd be like

917
00:34:26,800 --> 00:34:28,879
somebody who'd authorized like 97

918
00:34:28,879 --> 00:34:30,560
different apps

919
00:34:30,560 --> 00:34:32,320
and the sets of permissions they were

920
00:34:32,320 --> 00:34:35,280
were like email email email manage your

921
00:34:35,280 --> 00:34:37,440
documents email manage your documents

922
00:34:37,440 --> 00:34:39,679
full control over everything

923
00:34:39,679 --> 00:34:42,239
and it's just a crazy ecosystem to allow

924
00:34:42,239 --> 00:34:45,199
your users to do that

925
00:34:54,320 --> 00:34:56,000
get some bang from the buck so the

926
00:34:56,000 --> 00:34:57,359
question was like where do you get some

927
00:34:57,359 --> 00:34:58,480
bang from the buck if you want to do

928
00:34:58,480 --> 00:35:00,880
some threat hunting on this um so like

929
00:35:00,880 --> 00:35:03,839
assuming you have uh some data to threat

930
00:35:03,839 --> 00:35:06,880
hunt in right um i'd say start looking

931
00:35:06,880 --> 00:35:08,160
at those malware alerts and where

932
00:35:08,160 --> 00:35:09,760
they're coming from so like the alerts

933
00:35:09,760 --> 00:35:11,359
you're actually getting

934
00:35:11,359 --> 00:35:14,480
in your environment take a look at those

935
00:35:14,480 --> 00:35:16,400
and see like how people are getting

936
00:35:16,400 --> 00:35:18,400
there you know like why they're clicking

937
00:35:18,400 --> 00:35:20,320
on the stuff um and start with

938
00:35:20,320 --> 00:35:22,720
whatever's happening to you right i i

939
00:35:22,720 --> 00:35:24,480
know that like it's exciting to come and

940
00:35:24,480 --> 00:35:26,320
see these presentations and for me to

941
00:35:26,320 --> 00:35:28,160
say like this is the kind of stuff we're

942
00:35:28,160 --> 00:35:30,560
seeing right but if you aren't seeing

943
00:35:30,560 --> 00:35:31,920
this stuff

944
00:35:31,920 --> 00:35:33,839
then obviously the place to start isn't

945
00:35:33,839 --> 00:35:35,760
with the crazy stuff ray talked about

946
00:35:35,760 --> 00:35:37,440
today the place to start is with

947
00:35:37,440 --> 00:35:38,560
whatever you're seeing in your

948
00:35:38,560 --> 00:35:40,640
environment and what you can start

949
00:35:40,640 --> 00:35:42,560
locking down from there so that that's

950
00:35:42,560 --> 00:35:44,640
always my my advice is start with

951
00:35:44,640 --> 00:35:46,720
whatever's happening to you um and make

952
00:35:46,720 --> 00:35:48,960
sure that you are thinking like whatever

953
00:35:48,960 --> 00:35:50,560
like think a step ahead of it right like

954
00:35:50,560 --> 00:35:52,480
this is what i see happening what could

955
00:35:52,480 --> 00:35:54,320
i have maybe blocked upstream to prevent

956
00:35:54,320 --> 00:35:56,320
this from happening um because that's

957
00:35:56,320 --> 00:35:57,760
that's typically what we're doing is

958
00:35:57,760 --> 00:36:00,480
we're finding those um you know like

959
00:36:00,480 --> 00:36:03,040
it got to the point where somebody tried

960
00:36:03,040 --> 00:36:05,359
to download malware i wish it didn't

961
00:36:05,359 --> 00:36:07,680
even get to that point i wish we had

962
00:36:07,680 --> 00:36:10,720
blocked the page that they visited that

963
00:36:10,720 --> 00:36:12,560
they clicked on or blocked the email

964
00:36:12,560 --> 00:36:14,640
right like you're trying to get ahead of

965
00:36:14,640 --> 00:36:17,598
it as much as possible

966
00:36:17,760 --> 00:36:20,079
and then i mean the addendum to that is

967
00:36:20,079 --> 00:36:22,880
if you don't have visibility visibility

968
00:36:22,880 --> 00:36:24,400
is always the first thing you want to do

969
00:36:24,400 --> 00:36:25,520
right you want to address that

970
00:36:25,520 --> 00:36:28,400
visibility gap you want to make sure

971
00:36:28,400 --> 00:36:29,599
that you can

972
00:36:29,599 --> 00:36:32,240
see what's

973
00:36:39,119 --> 00:36:42,240
and happening files and but the zip file

974
00:36:42,240 --> 00:36:44,320
right so are you pulling that from like

975
00:36:44,320 --> 00:36:45,040
what

976
00:36:45,040 --> 00:36:47,839
like the actual file is delivered

977
00:36:47,839 --> 00:36:50,640
or when it's extracted does it line up

978
00:36:50,640 --> 00:36:51,520
with

979
00:36:51,520 --> 00:36:54,560
most exes

980
00:36:54,560 --> 00:36:57,680
so this chart is of just like that first

981
00:36:57,680 --> 00:37:00,000
thing that the user is clicking on right

982
00:37:00,000 --> 00:37:02,400
so when i say exe dll here i mean like

983
00:37:02,400 --> 00:37:04,320
the user you know is clicking on a link

984
00:37:04,320 --> 00:37:09,320
to download an exe or dll so this is

985
00:37:09,920 --> 00:37:13,520
right yes so once yeah so the

986
00:37:13,520 --> 00:37:15,920
exactly so yeah so once you extract

987
00:37:15,920 --> 00:37:18,800
those zips or the rars or the gzips a

988
00:37:18,800 --> 00:37:20,640
lot of what we've been seeing is a lot

989
00:37:20,640 --> 00:37:23,040
of that same stuff you know inside there

990
00:37:23,040 --> 00:37:25,760
there's a lot of we see a lot of uh

991
00:37:25,760 --> 00:37:28,320
especially like raw and gzip files where

992
00:37:28,320 --> 00:37:30,480
you can set the mark of the web

993
00:37:30,480 --> 00:37:33,040
and have it um persist when you unzip

994
00:37:33,040 --> 00:37:35,280
that file it'll contain

995
00:37:35,280 --> 00:37:36,960
the office document

996
00:37:36,960 --> 00:37:39,520
and the bitmap file that the office

997
00:37:39,520 --> 00:37:40,960
document is going to extract the malware

998
00:37:40,960 --> 00:37:42,240
from to drop

999
00:37:42,240 --> 00:37:44,320
so we see you know a lot of that kind of

1000
00:37:44,320 --> 00:37:46,560
stuff or it contains the exe or a

1001
00:37:46,560 --> 00:37:50,079
powershell script the link files that we

1002
00:37:50,079 --> 00:37:52,400
see a lot of them typically come in

1003
00:37:52,400 --> 00:37:54,640
within zips right it's like unzip this

1004
00:37:54,640 --> 00:37:56,800
then click on the link file and um

1005
00:37:56,800 --> 00:37:58,160
that's that's where you end up from

1006
00:37:58,160 --> 00:37:59,599
there so this is this is very much like

1007
00:37:59,599 --> 00:38:01,280
just that sort of first swipe of

1008
00:38:01,280 --> 00:38:03,680
whatever people clicking on

1009
00:38:03,680 --> 00:38:04,720
yeah

1010
00:38:04,720 --> 00:38:06,880
but now now i want to go unzip all of

1011
00:38:06,880 --> 00:38:08,480
them and figure out what's you know

1012
00:38:08,480 --> 00:38:10,560
that's that's a lot harder data analysis

1013
00:38:10,560 --> 00:38:13,720
to do

1014
00:38:22,400 --> 00:38:23,839
so

1015
00:38:23,839 --> 00:38:25,520
we're talking to microsoft and google

1016
00:38:25,520 --> 00:38:27,760
about it we're talking to the hosting

1017
00:38:27,760 --> 00:38:29,760
providers that are abused the most for

1018
00:38:29,760 --> 00:38:33,040
it um right now it seems like the

1019
00:38:33,040 --> 00:38:35,280
solution is keep playing whack-a-mole

1020
00:38:35,280 --> 00:38:38,400
and hope that we have invested so much

1021
00:38:38,400 --> 00:38:40,640
time and energy into playing

1022
00:38:40,640 --> 00:38:43,839
whack-a-mole that whoever is doing it

1023
00:38:43,839 --> 00:38:46,320
isn't getting the roi they need and they

1024
00:38:46,320 --> 00:38:48,720
give up

1025
00:38:48,720 --> 00:38:50,880
other than that

1026
00:38:50,880 --> 00:38:52,960
i mean the the the other things you

1027
00:38:52,960 --> 00:38:54,800
could do right is try to get some of

1028
00:38:54,800 --> 00:38:57,440
this stuff into the browser right

1029
00:38:57,440 --> 00:38:59,280
maybe google or microsoft can be more

1030
00:38:59,280 --> 00:39:02,320
proactive about what types of pdfs they

1031
00:39:02,320 --> 00:39:03,359
index

1032
00:39:03,359 --> 00:39:06,320
um you know if if google wanted to stop

1033
00:39:06,320 --> 00:39:07,920
it today right they could stop indexing

1034
00:39:07,920 --> 00:39:10,640
pdfs so there's like draconian things

1035
00:39:10,640 --> 00:39:11,920
they could do

1036
00:39:11,920 --> 00:39:13,520
but that would hurt than all the

1037
00:39:13,520 --> 00:39:15,839
legitimate pdfs they've indexed so

1038
00:39:15,839 --> 00:39:18,000
unfortunately it's just we're just

1039
00:39:18,000 --> 00:39:19,920
hoping that we can beat them uh

1040
00:39:19,920 --> 00:39:21,440
demoralize them

1041
00:39:21,440 --> 00:39:25,480
before they demoralize us

1042
00:39:32,400 --> 00:39:34,400
oh

1043
00:39:34,400 --> 00:39:35,280
that

1044
00:39:35,280 --> 00:39:37,839
that pdf stuff

1045
00:39:37,839 --> 00:39:40,640
we are convinced that that pdf stuff is

1046
00:39:40,640 --> 00:39:43,920
a hundred percent automated um and that

1047
00:39:43,920 --> 00:39:45,760
you know it's probably just one group

1048
00:39:45,760 --> 00:39:49,760
doing it right now um it's too similar

1049
00:39:49,760 --> 00:39:51,680
every time it has the same weird

1050
00:39:51,680 --> 00:39:53,440
artifacts in every single one of those

1051
00:39:53,440 --> 00:39:56,480
pdfs um which we detect with the same

1052
00:39:56,480 --> 00:39:59,200
signature every single time as well so i

1053
00:39:59,200 --> 00:40:00,320
mean that's the other thing that we can

1054
00:40:00,320 --> 00:40:01,839
do about it right is maybe it doesn't

1055
00:40:01,839 --> 00:40:04,160
matter so much because everybody's edr

1056
00:40:04,160 --> 00:40:06,079
and network controls and everything is

1057
00:40:06,079 --> 00:40:08,319
blocking uh the vast majority of this

1058
00:40:08,319 --> 00:40:10,400
because it's it is really stupid easy to

1059
00:40:10,400 --> 00:40:11,440
detect

1060
00:40:11,440 --> 00:40:13,440
we have one signature that blocked all

1061
00:40:13,440 --> 00:40:15,599
of those

1062
00:40:15,599 --> 00:40:18,240
they're not creative um but i'd say in

1063
00:40:18,240 --> 00:40:20,240
general most of the attacks that we

1064
00:40:20,240 --> 00:40:21,599
thwart are

1065
00:40:21,599 --> 00:40:25,240
clearly automated

1066
00:40:48,319 --> 00:40:50,560
the answer that question whether it was

1067
00:40:50,560 --> 00:40:52,960
about twitter or any other vendor is

1068
00:40:52,960 --> 00:40:57,040
usually yes right no no vendor uh

1069
00:40:57,040 --> 00:41:00,160
let's i don't like using absolutes most

1070
00:41:00,160 --> 00:41:01,200
vendors

1071
00:41:01,200 --> 00:41:03,359
who create these apps

1072
00:41:03,359 --> 00:41:05,920
aren't okay with people abusing them

1073
00:41:05,920 --> 00:41:07,839
right they they don't want people

1074
00:41:07,839 --> 00:41:10,800
abusing them uh and so they want to

1075
00:41:10,800 --> 00:41:14,400
thwart abuse on those platforms um

1076
00:41:14,400 --> 00:41:17,440
it's hard to do at the scale at which a

1077
00:41:17,440 --> 00:41:19,440
lot of these operate right so like one

1078
00:41:19,440 --> 00:41:21,440
of the questions i often get it's funny

1079
00:41:21,440 --> 00:41:22,960
that you picked twitter because i don't

1080
00:41:22,960 --> 00:41:25,359
know a lot about what twitter does to to

1081
00:41:25,359 --> 00:41:27,520
stop this stuff but one question i often

1082
00:41:27,520 --> 00:41:29,839
get is um

1083
00:41:29,839 --> 00:41:32,200
ray you must be wrong or maybe you're

1084
00:41:32,200 --> 00:41:35,520
misrepresenting something because i use

1085
00:41:35,520 --> 00:41:38,720
google drive and i use onedrive and i

1086
00:41:38,720 --> 00:41:41,440
know that if i upload malware to google

1087
00:41:41,440 --> 00:41:44,640
drive and onedrive it gets blocked right

1088
00:41:44,640 --> 00:41:46,960
either either i get a notification that

1089
00:41:46,960 --> 00:41:49,599
that malware was blocked or when i try

1090
00:41:49,599 --> 00:41:51,440
to download it it says he can't download

1091
00:41:51,440 --> 00:41:53,280
his malware or if i try to share it with

1092
00:41:53,280 --> 00:41:55,440
somebody um and they click on that

1093
00:41:55,440 --> 00:41:57,680
shared link it doesn't work and so like

1094
00:41:57,680 --> 00:41:59,920
a lot of these vendors even

1095
00:41:59,920 --> 00:42:00,720
know

1096
00:42:00,720 --> 00:42:02,400
that this stuff is happening right they

1097
00:42:02,400 --> 00:42:03,839
they know that people are going to try

1098
00:42:03,839 --> 00:42:06,000
to upload malware to these platforms and

1099
00:42:06,000 --> 00:42:09,440
so they're doing what they can to scan

1100
00:42:09,440 --> 00:42:11,119
the files that were uploaded to those

1101
00:42:11,119 --> 00:42:12,480
platforms

1102
00:42:12,480 --> 00:42:14,560
but these are companies operating in a

1103
00:42:14,560 --> 00:42:17,359
very large scale servicing

1104
00:42:17,359 --> 00:42:20,079
people the world over with wildly

1105
00:42:20,079 --> 00:42:22,480
different risk tolerances

1106
00:42:22,480 --> 00:42:24,560
and also don't want to be in the

1107
00:42:24,560 --> 00:42:26,720
business of support

1108
00:42:26,720 --> 00:42:29,680
like a lot of us are when some user

1109
00:42:29,680 --> 00:42:31,440
complains that you blocked something

1110
00:42:31,440 --> 00:42:33,599
that wasn't actually malicious right and

1111
00:42:33,599 --> 00:42:35,839
so they're generally

1112
00:42:35,839 --> 00:42:38,240
more conservative than we who work in

1113
00:42:38,240 --> 00:42:40,240
corporate security are

1114
00:42:40,240 --> 00:42:42,839
because it has to be a

1115
00:42:42,839 --> 00:42:45,520
one-size-fits-all solution

1116
00:42:45,520 --> 00:42:49,119
and they can't afford to

1117
00:42:49,119 --> 00:42:50,800
go too far

1118
00:42:50,800 --> 00:42:53,839
and damage the usability of that

1119
00:42:53,839 --> 00:42:55,760
platform for the legitimate users

1120
00:42:55,760 --> 00:42:57,920
especially if that platform is a free

1121
00:42:57,920 --> 00:43:00,960
platform that is completely dependent on

1122
00:43:00,960 --> 00:43:02,400
the fact that it's super popular and

1123
00:43:02,400 --> 00:43:04,079
they can serve people ads through it um

1124
00:43:04,079 --> 00:43:06,240
which a lot of these platforms are and

1125
00:43:06,240 --> 00:43:07,839
so it's just

1126
00:43:07,839 --> 00:43:09,760
it's not malice on the part of any of

1127
00:43:09,760 --> 00:43:12,400
these cloud providers it's just

1128
00:43:12,400 --> 00:43:15,680
it's just a really hard problem to solve

1129
00:43:15,680 --> 00:43:17,839
and i mean twitter has a lot of other

1130
00:43:17,839 --> 00:43:19,680
hard problems to solve around abuse of

1131
00:43:19,680 --> 00:43:21,200
its platform

1132
00:43:21,200 --> 00:43:23,440
this probably isn't the most high

1133
00:43:23,440 --> 00:43:27,839
profile of those problems right now

1134
00:43:31,200 --> 00:43:33,560
uh what are you seeing from the

1135
00:43:33,560 --> 00:43:36,880
uh people

1136
00:43:37,440 --> 00:43:41,160
yeah i mean

1137
00:43:45,359 --> 00:43:46,880
so

1138
00:43:46,880 --> 00:43:49,599
not so much i think the the majority of

1139
00:43:49,599 --> 00:43:51,599
the cdn abuse that we see and i think

1140
00:43:51,599 --> 00:43:53,520
this is just i feel like i kind of make

1141
00:43:53,520 --> 00:43:55,839
the same statement in a lot of places

1142
00:43:55,839 --> 00:43:59,200
it's boring and it's simple right it's

1143
00:43:59,200 --> 00:44:02,079
it's just that cdns are generally ways

1144
00:44:02,079 --> 00:44:04,319
for you to host files for your cheap

1145
00:44:04,319 --> 00:44:05,520
and so that's where they're hosting

1146
00:44:05,520 --> 00:44:07,520
their files right and so again i'm

1147
00:44:07,520 --> 00:44:08,880
talking about malware but when it's

1148
00:44:08,880 --> 00:44:10,480
malicious websites when it's malicious

1149
00:44:10,480 --> 00:44:12,800
javascript when you know like whatever

1150
00:44:12,800 --> 00:44:15,280
those malicious files are it's just all

1151
00:44:15,280 --> 00:44:18,319
over the cdn's um you know a lot of the

1152
00:44:18,319 --> 00:44:20,960
early stuff you saw with cdn abuse right

1153
00:44:20,960 --> 00:44:23,760
was around um

1154
00:44:23,760 --> 00:44:26,880
i'm blanking on the term

1155
00:44:29,680 --> 00:44:32,319
too late on a friday sorry um but

1156
00:44:32,319 --> 00:44:33,760
there's there's an attack right where

1157
00:44:33,760 --> 00:44:36,240
you can try to hit another website on

1158
00:44:36,240 --> 00:44:39,040
the same cdn by crafting your your

1159
00:44:39,040 --> 00:44:41,440
requests in a certain way most cdns

1160
00:44:41,440 --> 00:44:42,800
check for that stuff now right so you

1161
00:44:42,800 --> 00:44:45,280
don't see a lot domain fronting there we

1162
00:44:45,280 --> 00:44:47,760
go my brain's not broken yet uh domain

1163
00:44:47,760 --> 00:44:48,720
fronting

1164
00:44:48,720 --> 00:44:51,119
you don't see uh you don't see so much

1165
00:44:51,119 --> 00:44:52,319
of that anymore because it's getting a

1166
00:44:52,319 --> 00:44:53,920
lot harder because the cdns enforce it

1167
00:44:53,920 --> 00:44:55,520
so that's like an example of like they

1168
00:44:55,520 --> 00:44:57,920
saw the abuse they were in a perfect

1169
00:44:57,920 --> 00:45:00,319
position to do something about it um so

1170
00:45:00,319 --> 00:45:02,720
they just now double check the s and i

1171
00:45:02,720 --> 00:45:04,800
uh in the host header and make sure they

1172
00:45:04,800 --> 00:45:06,560
make sense before they

1173
00:45:06,560 --> 00:45:08,160
point you to whatever content you're at

1174
00:45:08,160 --> 00:45:10,000
so

1175
00:45:10,000 --> 00:45:13,839
it's just boring but there's a lot of it

1176
00:45:17,359 --> 00:45:19,760
so i promised i'd be on time

1177
00:45:19,760 --> 00:45:21,280
and i'm on time

1178
00:45:21,280 --> 00:45:25,160
thanks so much for your attention

1179
00:45:29,770 --> 00:45:32,909
[Applause]

1180
00:45:35,520 --> 00:45:37,599
you

