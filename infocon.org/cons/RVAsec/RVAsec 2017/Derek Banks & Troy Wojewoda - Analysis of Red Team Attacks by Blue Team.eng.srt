1
00:00:26,689 --> 00:00:32,879
so<font color="#E5E5E5"> uh thanks</font><font color="#CCCCCC"> for coming everyone</font>

2
00:00:30,329 --> 00:00:35,629
this talk is<font color="#CCCCCC"> poor-man's</font><font color="#E5E5E5"> five versus spot</font>

3
00:00:32,879 --> 00:00:40,760
<font color="#E5E5E5">how to use free and open source software</font>

4
00:00:35,629 --> 00:00:43,050
to detect attackers in your network so

5
00:00:40,760 --> 00:00:45,000
really what it's about is<font color="#E5E5E5"> incident</font>

6
00:00:43,050 --> 00:00:48,479
response on a shoestring budget<font color="#CCCCCC"> because</font>

7
00:00:45,000 --> 00:00:50,640
<font color="#E5E5E5">I guess every one of</font><font color="#CCCCCC"> money concerns how</font>

8
00:00:48,479 --> 00:00:53,820
many people use some kind of free or

9
00:00:50,640 --> 00:00:55,019
<font color="#CCCCCC">open source software to do some kind</font><font color="#E5E5E5"> of</font>

10
00:00:53,820 --> 00:00:58,710
detection or monitoring<font color="#E5E5E5"> in their</font>

11
00:00:55,019 --> 00:01:02,220
environment now<font color="#CCCCCC"> that's a good number</font><font color="#E5E5E5"> of</font>

12
00:00:58,710 --> 00:01:03,629
people<font color="#CCCCCC"> yes so sometimes the free</font><font color="#E5E5E5"> and</font>

13
00:01:02,220 --> 00:01:06,770
open<font color="#CCCCCC"> source stuff is</font><font color="#E5E5E5"> actually better</font>

14
00:01:03,629 --> 00:01:08,850
than<font color="#CCCCCC"> what you get with a vendor and</font>

15
00:01:06,770 --> 00:01:13,590
before we go<font color="#E5E5E5"> any further I'd like to</font><font color="#CCCCCC"> say</font>

16
00:01:08,850 --> 00:01:15,479
<font color="#E5E5E5">that this is all done in a lab</font>

17
00:01:13,590 --> 00:01:18,540
environment<font color="#CCCCCC"> there's certainly a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of</font>

18
00:01:15,479 --> 00:01:20,729
caveats<font color="#CCCCCC"> to how these</font><font color="#E5E5E5"> things perform at</font>

19
00:01:18,540 --> 00:01:22,170
scale<font color="#CCCCCC"> so your mileage may</font><font color="#E5E5E5"> vary with</font>

20
00:01:20,729 --> 00:01:28,110
<font color="#E5E5E5">everything that we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk</font>

21
00:01:22,170 --> 00:01:32,280
<font color="#CCCCCC">about so everybody everybody hear me</font><font color="#E5E5E5"> all</font>

22
00:01:28,110 --> 00:01:35,340
right<font color="#E5E5E5"> so I'm Troy</font><font color="#CCCCCC"> Rhoda my primary role</font>

23
00:01:32,280 --> 00:01:37,020
is the incident responder<font color="#CCCCCC"> technically my</font>

24
00:01:35,340 --> 00:01:39,540
title is a structure<font color="#CCCCCC"> to analysts of</font>

25
00:01:37,020 --> 00:01:43,590
escalated Incident Response<font color="#CCCCCC"> a current</font>

26
00:01:39,540 --> 00:01:45,299
employer<font color="#CCCCCC"> kind of started off</font><font color="#E5E5E5"> doing all</font>

27
00:01:43,590 --> 00:01:48,990
kinds of<font color="#E5E5E5"> things been doing it for</font><font color="#CCCCCC"> 10</font>

28
00:01:45,299 --> 00:01:51,659
plus<font color="#CCCCCC"> years</font><font color="#E5E5E5"> but really focused on host</font>

29
00:01:48,990 --> 00:01:54,330
and network based forensics<font color="#E5E5E5"> campaign</font>

30
00:01:51,659 --> 00:01:55,950
analysis malware analysis<font color="#E5E5E5"> although I</font>

31
00:01:54,330 --> 00:01:57,479
wouldn't classify myself as a reverse

32
00:01:55,950 --> 00:01:59,580
engineer I definitely like to<font color="#E5E5E5"> get</font>

33
00:01:57,479 --> 00:02:04,729
samples<font color="#E5E5E5"> as many as</font><font color="#CCCCCC"> possible and pick</font>

34
00:01:59,580 --> 00:02:07,830
them apart<font color="#E5E5E5"> as as much as I can</font><font color="#CCCCCC"> Oh</font>

35
00:02:04,729 --> 00:02:10,049
<font color="#CCCCCC">hunting gathering</font><font color="#E5E5E5"> and just also you know</font>

36
00:02:07,830 --> 00:02:11,670
<font color="#E5E5E5">you know taking the the realm of the</font>

37
00:02:10,049 --> 00:02:15,599
ideas<font color="#CCCCCC"> of you know</font><font color="#E5E5E5"> thinking outside the</font>

38
00:02:11,670 --> 00:02:17,010
box<font color="#CCCCCC"> just</font><font color="#E5E5E5"> kind of you know discussing</font>

39
00:02:15,599 --> 00:02:18,390
things<font color="#E5E5E5"> at work and you know</font><font color="#CCCCCC"> picking</font>

40
00:02:17,010 --> 00:02:19,798
<font color="#E5E5E5">apart working in the socket with</font><font color="#CCCCCC"> the</font>

41
00:02:18,390 --> 00:02:21,298
teams<font color="#E5E5E5"> and it's kind of you know</font>

42
00:02:19,799 --> 00:02:22,920
questioning<font color="#E5E5E5"> not</font><font color="#CCCCCC"> only thinking outside</font>

43
00:02:21,299 --> 00:02:24,480
the<font color="#E5E5E5"> box but why does it</font><font color="#CCCCCC"> even have</font><font color="#E5E5E5"> to be</font>

44
00:02:22,920 --> 00:02:29,000
a box you<font color="#E5E5E5"> know those kinds</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> things and</font>

45
00:02:24,480 --> 00:02:31,649
that's it yeah used to<font color="#E5E5E5"> do that stuff and</font>

46
00:02:29,000 --> 00:02:34,499
then I realized it was easier easier to

47
00:02:31,650 --> 00:02:37,750
hack things<font color="#E5E5E5"> and so now I'm a Red Team</font>

48
00:02:34,499 --> 00:02:39,490
person I organized a meet-up

49
00:02:37,750 --> 00:02:41,920
with anybody's in here from Hampton

50
00:02:39,490 --> 00:02:45,070
Roads<font color="#E5E5E5"> Hampton Roads area there's a meet</font>

51
00:02:41,920 --> 00:02:48,250
<font color="#E5E5E5">up once a month</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I started and try</font>

52
00:02:45,070 --> 00:02:50,560
and maintain<font color="#E5E5E5"> sometimes poorly</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> also</font>

53
00:02:48,250 --> 00:02:53,860
for those<font color="#E5E5E5"> of</font><font color="#CCCCCC"> you that</font><font color="#E5E5E5"> are running office</font>

54
00:02:50,560 --> 00:02:59,680
<font color="#E5E5E5">web</font><font color="#CCCCCC"> app with</font><font color="#E5E5E5"> no two-factor on the</font>

55
00:02:53,860 --> 00:03:01,330
outside of<font color="#E5E5E5"> your environment</font><font color="#CCCCCC"> thank you so</font>

56
00:02:59,680 --> 00:03:03,570
a little<font color="#E5E5E5"> bit about detection versus</font>

57
00:03:01,330 --> 00:03:07,360
<font color="#CCCCCC">prevention so if you've been to a sand</font>

58
00:03:03,570 --> 00:03:09,519
<font color="#CCCCCC">class or even outside of</font><font color="#E5E5E5"> Sands</font><font color="#CCCCCC"> there's a</font>

59
00:03:07,360 --> 00:03:12,220
saying<font color="#E5E5E5"> that you may have heard detection</font>

60
00:03:09,520 --> 00:03:14,340
or<font color="#E5E5E5"> prevention is ideal but detection is</font>

61
00:03:12,220 --> 00:03:19,000
a must<font color="#E5E5E5"> and the active behind that is</font>

62
00:03:14,340 --> 00:03:21,310
<font color="#CCCCCC">that prevention</font><font color="#E5E5E5"> is going to fail there's</font>

63
00:03:19,000 --> 00:03:24,190
no way you're<font color="#E5E5E5"> going to prevent an</font>

64
00:03:21,310 --> 00:03:26,440
attacker from<font color="#E5E5E5"> ever getting in but you</font>

65
00:03:24,190 --> 00:03:28,450
must<font color="#E5E5E5"> detect them I think I don't know</font>

66
00:03:26,440 --> 00:03:30,370
what the current Verizon statistic is

67
00:03:28,450 --> 00:03:31,810
but I would<font color="#CCCCCC"> bet it's</font><font color="#E5E5E5"> still somewhere</font>

68
00:03:30,370 --> 00:03:34,480
<font color="#CCCCCC">then does</font><font color="#E5E5E5"> anybody know is it still like</font>

69
00:03:31,810 --> 00:03:38,020
280 days or some nonsense<font color="#E5E5E5"> before</font><font color="#CCCCCC"> their</font>

70
00:03:34,480 --> 00:03:40,119
attacker is detected yeah<font color="#E5E5E5"> so you really</font>

71
00:03:38,020 --> 00:03:43,120
need<font color="#E5E5E5"> to be able to detect them when it</font>

72
00:03:40,120 --> 00:03:47,230
happens<font color="#E5E5E5"> and also preventative solutions</font>

73
00:03:43,120 --> 00:03:49,269
<font color="#CCCCCC">well they may cost more money</font><font color="#E5E5E5"> yeah and</font>

74
00:03:47,230 --> 00:03:52,119
also<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> just a Derek's point that</font>

75
00:03:49,269 --> 00:03:53,140
you want to be<font color="#CCCCCC"> able to prevent but in</font>

76
00:03:52,120 --> 00:03:54,850
the times when<font color="#CCCCCC"> those</font><font color="#E5E5E5"> preventive</font>

77
00:03:53,140 --> 00:03:56,679
mechanisms fail you want to be able<font color="#CCCCCC"> to</font>

78
00:03:54,850 --> 00:04:00,010
go back as much<font color="#E5E5E5"> as possible and find out</font>

79
00:03:56,680 --> 00:04:02,470
they did you can the full<font color="#E5E5E5"> picture of</font>

80
00:04:00,010 --> 00:04:04,170
what happened<font color="#E5E5E5"> and so you know we wanted</font>

81
00:04:02,470 --> 00:04:07,390
<font color="#E5E5E5">to highlight you know identification</font>

82
00:04:04,170 --> 00:04:12,790
<font color="#E5E5E5">those detection mechanisms is really key</font>

83
00:04:07,390 --> 00:04:14,708
<font color="#CCCCCC">to unraveling the full picture so but</font>

84
00:04:12,790 --> 00:04:16,539
like everything<font color="#E5E5E5"> is paid off right if</font>

85
00:04:14,709 --> 00:04:17,769
you're<font color="#E5E5E5"> going to use some of the things</font>

86
00:04:16,540 --> 00:04:20,919
<font color="#CCCCCC">that we're going</font><font color="#E5E5E5"> to talk about here</font><font color="#CCCCCC"> in a</font>

87
00:04:17,769 --> 00:04:24,220
bit<font color="#E5E5E5"> um it's not really</font><font color="#CCCCCC"> free right</font><font color="#E5E5E5"> it</font>

88
00:04:20,918 --> 00:04:25,450
takes<font color="#E5E5E5"> your time</font><font color="#CCCCCC"> so whereas you</font><font color="#E5E5E5"> have a</font>

89
00:04:24,220 --> 00:04:27,490
<font color="#CCCCCC">trade-off</font><font color="#E5E5E5"> where you can actually buy a</font>

90
00:04:25,450 --> 00:04:29,320
product<font color="#E5E5E5"> and call someone if something</font>

91
00:04:27,490 --> 00:04:31,390
breaks<font color="#E5E5E5"> if you're if you're using</font>

92
00:04:29,320 --> 00:04:33,880
<font color="#CCCCCC">open-source</font><font color="#E5E5E5"> products and free products</font>

93
00:04:31,390 --> 00:04:37,000
you have<font color="#E5E5E5"> community support</font><font color="#CCCCCC"> and your own</font>

94
00:04:33,880 --> 00:04:40,630
research in<font color="#E5E5E5"> your own time so there's a</font>

95
00:04:37,000 --> 00:04:42,729
trade-off there but it's been<font color="#CCCCCC"> my</font>

96
00:04:40,630 --> 00:04:44,050
experience<font color="#E5E5E5"> if you use these</font><font color="#CCCCCC"> things and</font>

97
00:04:42,729 --> 00:04:46,359
you take the time<font color="#E5E5E5"> to understand what</font>

98
00:04:44,050 --> 00:04:47,490
<font color="#E5E5E5">they can do</font><font color="#CCCCCC"> instead of just</font><font color="#E5E5E5"> relying on</font>

99
00:04:46,360 --> 00:04:50,140
<font color="#E5E5E5">someone else to do it</font>

100
00:04:47,490 --> 00:04:50,590
<font color="#E5E5E5">your security skills are going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font>

101
00:04:50,140 --> 00:04:53,430
better

102
00:04:50,590 --> 00:04:57,340
[Music]

103
00:04:53,430 --> 00:04:59,950
so some of the core my are in monitoring

104
00:04:57,340 --> 00:05:03,429
components that<font color="#CCCCCC"> Troy</font><font color="#E5E5E5"> and I came</font><font color="#CCCCCC"> up with</font>

105
00:04:59,950 --> 00:05:06,010
from our<font color="#E5E5E5"> experiences the first is</font>

106
00:05:03,430 --> 00:05:07,780
network monitoring<font color="#CCCCCC"> I assume at this</font>

107
00:05:06,010 --> 00:05:09,430
<font color="#CCCCCC">point</font><font color="#E5E5E5"> everyone sitting in here is has</font>

108
00:05:07,780 --> 00:05:12,280
some kind of<font color="#E5E5E5"> monitoring on their ingress</font>

109
00:05:09,430 --> 00:05:13,900
and egress<font color="#E5E5E5"> and then there's host based</font>

110
00:05:12,280 --> 00:05:18,460
<font color="#E5E5E5">monitoring so things that are only edge</font>

111
00:05:13,900 --> 00:05:20,679
of your network<font color="#E5E5E5"> like it typically in</font>

112
00:05:18,460 --> 00:05:22,570
this talk it's going to be a Windows

113
00:05:20,680 --> 00:05:26,550
workstation but we're also talking<font color="#CCCCCC"> about</font>

114
00:05:22,570 --> 00:05:30,490
mobile<font color="#CCCCCC"> devices things</font><font color="#E5E5E5"> that users use and</font>

115
00:05:26,550 --> 00:05:32,020
then another core or key component

116
00:05:30,490 --> 00:05:36,130
because I our teams are usually<font color="#E5E5E5"> pretty</font>

117
00:05:32,020 --> 00:05:39,159
small<font color="#CCCCCC"> is is forensics</font><font color="#E5E5E5"> at scale so what</font><font color="#CCCCCC"> I</font>

118
00:05:36,130 --> 00:05:42,969
mean<font color="#E5E5E5"> by</font><font color="#CCCCCC"> that is you have one or two</font>

119
00:05:39,160 --> 00:05:44,920
three analysts<font color="#E5E5E5"> if they have to go and</font>

120
00:05:42,970 --> 00:05:47,380
reach out and touch<font color="#E5E5E5"> a box and get</font>

121
00:05:44,920 --> 00:05:50,190
evidence<font color="#E5E5E5"> get memory process lists</font>

122
00:05:47,380 --> 00:05:53,200
<font color="#CCCCCC">whatever</font><font color="#E5E5E5"> you have to be able to do that</font>

123
00:05:50,190 --> 00:05:54,820
across all<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> workstations in</font><font color="#E5E5E5"> your</font>

124
00:05:53,200 --> 00:05:56,740
environment<font color="#CCCCCC"> and that can be a</font><font color="#E5E5E5"> challenge</font>

125
00:05:54,820 --> 00:05:58,570
<font color="#E5E5E5">so if you detect that something's</font>

126
00:05:56,740 --> 00:06:00,790
happened<font color="#E5E5E5"> and you have to send a tech out</font>

127
00:05:58,570 --> 00:06:03,219
and put a USB<font color="#E5E5E5"> stick in to do</font><font color="#CCCCCC"> your</font>

128
00:06:00,790 --> 00:06:06,480
incident response<font color="#E5E5E5"> well that might take a</font>

129
00:06:03,220 --> 00:06:09,040
<font color="#E5E5E5">while</font><font color="#CCCCCC"> and then also</font><font color="#E5E5E5"> centralized logging</font>

130
00:06:06,480 --> 00:06:11,980
logging everything<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> can possibly</font>

131
00:06:09,040 --> 00:06:14,230
log to a centralized<font color="#E5E5E5"> location so you</font>

132
00:06:11,980 --> 00:06:17,020
<font color="#E5E5E5">have the evidence</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you need when</font>

133
00:06:14,230 --> 00:06:20,020
something happens<font color="#E5E5E5"> and then log</font>

134
00:06:17,020 --> 00:06:21,760
correlation correlating those events<font color="#CCCCCC"> to</font>

135
00:06:20,020 --> 00:06:27,820
<font color="#E5E5E5">figure out if there's an</font><font color="#CCCCCC"> actual incident</font>

136
00:06:21,760 --> 00:06:29,289
<font color="#E5E5E5">that's occurred hi so one thing</font><font color="#CCCCCC"> I kind</font>

137
00:06:27,820 --> 00:06:31,210
of wanted to<font color="#E5E5E5"> just touch on this real</font>

138
00:06:29,290 --> 00:06:33,730
quick<font color="#E5E5E5"> since</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> topic here is about</font>

139
00:06:31,210 --> 00:06:35,799
doing<font color="#E5E5E5"> IR forensics on a shoestring</font>

140
00:06:33,730 --> 00:06:38,410
budget<font color="#CCCCCC"> I didn't really want</font><font color="#E5E5E5"> to get too</font>

141
00:06:35,800 --> 00:06:41,080
much<font color="#CCCCCC"> into intelligence</font><font color="#E5E5E5"> especially not</font>

142
00:06:38,410 --> 00:06:43,120
transferring or deploying all there's a

143
00:06:41,080 --> 00:06:44,919
<font color="#E5E5E5">lot of things are there's a lot</font><font color="#CCCCCC"> of talks</font>

144
00:06:43,120 --> 00:06:46,090
about<font color="#E5E5E5"> cyber threat intelligence and</font>

145
00:06:44,920 --> 00:06:47,830
sharing threat intelligence<font color="#CCCCCC"> that's</font>

146
00:06:46,090 --> 00:06:49,570
<font color="#E5E5E5">really important but I think</font><font color="#CCCCCC"> if you're</font>

147
00:06:47,830 --> 00:06:51,700
<font color="#CCCCCC">not</font><font color="#E5E5E5"> doing the fundamental things if</font>

148
00:06:49,570 --> 00:06:55,300
you're<font color="#E5E5E5"> not doing the basic logging the</font>

149
00:06:51,700 --> 00:06:57,330
centralized logging<font color="#E5E5E5"> the ability to see</font>

150
00:06:55,300 --> 00:07:00,400
<font color="#E5E5E5">all the things</font><font color="#CCCCCC"> leaving your network or</font>

151
00:06:57,330 --> 00:07:03,190
operating or executing on your end

152
00:07:00,400 --> 00:07:04,630
points then<font color="#CCCCCC"> intelligence is really</font><font color="#E5E5E5"> not</font>

153
00:07:03,190 --> 00:07:07,090
an area<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be focusing</font>

154
00:07:04,630 --> 00:07:09,550
but it's not a talk if we don't talk

155
00:07:07,090 --> 00:07:12,909
<font color="#E5E5E5">about the kill chain and actually</font><font color="#CCCCCC"> you</font>

156
00:07:09,550 --> 00:07:14,500
know<font color="#E5E5E5"> Lockheed</font><font color="#CCCCCC"> Martin cyber kill chain</font><font color="#E5E5E5"> so</font>

157
00:07:12,910 --> 00:07:17,530
I kind of took my own<font color="#E5E5E5"> little flavor from</font>

158
00:07:14,500 --> 00:07:19,630
<font color="#E5E5E5">that</font><font color="#CCCCCC"> and you know one of</font><font color="#E5E5E5"> the show you</font>

159
00:07:17,530 --> 00:07:21,929
know<font color="#E5E5E5"> if I'm sure everybody's heard of</font>

160
00:07:19,630 --> 00:07:24,760
<font color="#E5E5E5">the cyber kill chain but if you haven't</font>

161
00:07:21,930 --> 00:07:26,350
used<font color="#E5E5E5"> the attackers basically the phases</font>

162
00:07:24,760 --> 00:07:30,789
<font color="#E5E5E5">attacker has</font><font color="#CCCCCC"> to do in order</font><font color="#E5E5E5"> for them to</font>

163
00:07:26,350 --> 00:07:33,190
<font color="#E5E5E5">start</font><font color="#CCCCCC"> to basically</font><font color="#E5E5E5"> get and execute their</font>

164
00:07:30,790 --> 00:07:35,380
mission<font color="#E5E5E5"> so you know</font><font color="#CCCCCC"> there do some type</font>

165
00:07:33,190 --> 00:07:37,000
of reconnaissance<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then their next</font>

166
00:07:35,380 --> 00:07:39,880
step would be some type of<font color="#E5E5E5"> weapon is a</font>

167
00:07:37,000 --> 00:07:43,030
<font color="#CCCCCC">ssin and then delivery</font><font color="#E5E5E5"> followed by</font>

168
00:07:39,880 --> 00:07:45,580
exploitation<font color="#CCCCCC"> installation command and</font>

169
00:07:43,030 --> 00:07:47,140
control and<font color="#CCCCCC"> then really you know what</font>

170
00:07:45,580 --> 00:07:50,169
are they after actions on objectives or

171
00:07:47,140 --> 00:07:51,729
at profit in<font color="#E5E5E5"> this case so I like to use</font>

172
00:07:50,170 --> 00:07:53,680
this and<font color="#E5E5E5"> I really like to</font><font color="#CCCCCC"> use this</font>

173
00:07:51,730 --> 00:07:56,170
<font color="#E5E5E5">backward where when I'm doing instant</font>

174
00:07:53,680 --> 00:07:58,990
response to kind of map<font color="#CCCCCC"> that and marry</font>

175
00:07:56,170 --> 00:08:02,380
<font color="#E5E5E5">that to our instant response</font><font color="#CCCCCC"> lifecycle</font>

176
00:07:58,990 --> 00:08:05,040
so<font color="#CCCCCC"> we use the the</font><font color="#E5E5E5"> pickerel model the</font>

177
00:08:02,380 --> 00:08:07,000
preparation identification<font color="#E5E5E5"> containment</font>

178
00:08:05,040 --> 00:08:09,640
eradication recovery<font color="#E5E5E5"> and lessons learned</font>

179
00:08:07,000 --> 00:08:12,250
<font color="#CCCCCC">as we're going through a cyber incident</font>

180
00:08:09,640 --> 00:08:13,780
response but it's<font color="#E5E5E5"> always coming back to</font>

181
00:08:12,250 --> 00:08:16,270
what can you identify<font color="#E5E5E5"> and most</font>

182
00:08:13,780 --> 00:08:18,400
importantly we're in the cyber kill

183
00:08:16,270 --> 00:08:20,380
chain is the attacker when you're

184
00:08:18,400 --> 00:08:22,929
identifying<font color="#E5E5E5"> them so I kind of wanted to</font>

185
00:08:20,380 --> 00:08:25,840
like<font color="#E5E5E5"> show from an emotional perspective</font>

186
00:08:22,930 --> 00:08:27,310
<font color="#E5E5E5">what goes</font><font color="#CCCCCC"> through some ir teams</font><font color="#E5E5E5"> when</font>

187
00:08:25,840 --> 00:08:29,770
you're<font color="#CCCCCC"> detecting them and if you're</font>

188
00:08:27,310 --> 00:08:31,450
<font color="#E5E5E5">successful</font><font color="#CCCCCC"> for instance if you have</font>

189
00:08:29,770 --> 00:08:33,280
signature mechanisms that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> hitting</font>

190
00:08:31,450 --> 00:08:36,370
and preventing the delivery of the of

191
00:08:33,280 --> 00:08:37,689
the initial attack<font color="#E5E5E5"> then that's that's</font>

192
00:08:36,370 --> 00:08:38,740
kind of like the best situation you want

193
00:08:37,690 --> 00:08:39,490
<font color="#E5E5E5">to be in you could just sit back and</font>

194
00:08:38,740 --> 00:08:43,240
<font color="#CCCCCC">watch it</font>

195
00:08:39,490 --> 00:08:44,680
that's<font color="#E5E5E5"> Miller time that's right</font><font color="#CCCCCC"> but if</font>

196
00:08:43,240 --> 00:08:48,850
it's<font color="#E5E5E5"> getting a little bit further down</font>

197
00:08:44,680 --> 00:08:50,890
the kill<font color="#E5E5E5"> chain then that's when you got</font>

198
00:08:48,850 --> 00:08:52,270
it gets a little<font color="#E5E5E5"> bit little you know</font>

199
00:08:50,890 --> 00:08:53,980
worrisome like if you have signatures

200
00:08:52,270 --> 00:08:56,410
<font color="#CCCCCC">firing on command and</font><font color="#E5E5E5"> control or</font>

201
00:08:53,980 --> 00:08:57,790
exploitation installation<font color="#E5E5E5"> but if it's</font>

202
00:08:56,410 --> 00:08:59,980
but if they're<font color="#E5E5E5"> getting the data the data</font>

203
00:08:57,790 --> 00:09:01,390
is gone and<font color="#E5E5E5"> they're winning then it's</font>

204
00:08:59,980 --> 00:09:02,590
dead that's it that's the<font color="#E5E5E5"> worst case</font>

205
00:09:01,390 --> 00:09:06,670
scenario<font color="#E5E5E5"> right so as you're going</font>

206
00:09:02,590 --> 00:09:08,740
<font color="#E5E5E5">through these phases of the IR incident</font>

207
00:09:06,670 --> 00:09:10,209
response<font color="#E5E5E5"> phases you're constantly going</font>

208
00:09:08,740 --> 00:09:11,980
back<font color="#E5E5E5"> so you may think you have</font><font color="#CCCCCC"> something</font>

209
00:09:10,210 --> 00:09:14,140
contained<font color="#E5E5E5"> but then you may have</font><font color="#CCCCCC"> a couple</font>

210
00:09:11,980 --> 00:09:16,660
<font color="#E5E5E5">other members</font><font color="#CCCCCC"> that are maybe maybe a few</font>

211
00:09:14,140 --> 00:09:18,550
of you<font color="#CCCCCC"> are looking at some end points</font>

212
00:09:16,660 --> 00:09:19,900
and<font color="#E5E5E5"> getting really deep dive</font>

213
00:09:18,550 --> 00:09:21,280
on three<font color="#E5E5E5"> or four systems but then some</font>

214
00:09:19,900 --> 00:09:22,840
other<font color="#E5E5E5"> folks are then kind of going</font>

215
00:09:21,280 --> 00:09:24,670
through<font color="#E5E5E5"> more the network data did we</font>

216
00:09:22,840 --> 00:09:26,980
miss anything<font color="#E5E5E5"> and it's kind of like a</font>

217
00:09:24,670 --> 00:09:28,900
<font color="#E5E5E5">give and take</font><font color="#CCCCCC"> relationship</font><font color="#E5E5E5"> there and</font>

218
00:09:26,980 --> 00:09:31,930
constantly<font color="#CCCCCC"> feeding back said</font><font color="#E5E5E5"> have we</font>

219
00:09:28,900 --> 00:09:35,470
<font color="#E5E5E5">identified</font><font color="#CCCCCC"> everything and then where is</font>

220
00:09:31,930 --> 00:09:39,160
<font color="#E5E5E5">that so I like to use that back in the</font>

221
00:09:35,470 --> 00:09:40,870
kill chain to kind of show from an

222
00:09:39,160 --> 00:09:42,280
escalation perspective when we<font color="#E5E5E5"> have to</font>

223
00:09:40,870 --> 00:09:45,310
start reporting<font color="#E5E5E5"> this back up to</font><font color="#CCCCCC"> our</font>

224
00:09:42,280 --> 00:09:47,709
<font color="#CCCCCC">manage it to</font><font color="#E5E5E5"> maybe our manager or</font><font color="#CCCCCC"> the</font>

225
00:09:45,310 --> 00:09:50,469
CISO or the CIO or the<font color="#E5E5E5"> CEO</font><font color="#CCCCCC"> of the</font>

226
00:09:47,710 --> 00:09:52,690
company based off<font color="#CCCCCC"> of</font><font color="#E5E5E5"> where in the</font><font color="#CCCCCC"> in the</font>

227
00:09:50,470 --> 00:09:55,420
kill chain<font color="#CCCCCC"> that we're detecting and</font>

228
00:09:52,690 --> 00:09:59,980
seeing the adversary<font color="#E5E5E5"> does anybody have</font>

229
00:09:55,420 --> 00:10:02,439
<font color="#CCCCCC">any questions on that so we'll talk</font>

230
00:09:59,980 --> 00:10:05,020
<font color="#CCCCCC">about</font><font color="#E5E5E5"> a couple</font><font color="#CCCCCC"> of the options that you</font>

231
00:10:02,440 --> 00:10:08,890
have<font color="#CCCCCC"> for monitoring using</font><font color="#E5E5E5"> open source</font>

232
00:10:05,020 --> 00:10:11,319
tools and if anyone knows me<font color="#E5E5E5"> I'm an</font>

233
00:10:08,890 --> 00:10:13,720
unapologetic<font color="#CCCCCC"> bro fanboy even though I'm</font>

234
00:10:11,320 --> 00:10:17,050
<font color="#CCCCCC">Red Team</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> I think that bro is</font>

235
00:10:13,720 --> 00:10:19,120
probably one of the best network

236
00:10:17,050 --> 00:10:20,800
<font color="#E5E5E5">monitoring solutions that's free that</font>

237
00:10:19,120 --> 00:10:23,770
<font color="#CCCCCC">you can use it's really the forensics</font>

238
00:10:20,800 --> 00:10:25,329
ground truth of what happens<font color="#CCCCCC"> on</font><font color="#E5E5E5"> your</font>

239
00:10:23,770 --> 00:10:26,860
network<font color="#E5E5E5"> and I get the question</font><font color="#CCCCCC"> and</font>

240
00:10:25,330 --> 00:10:28,960
what's the<font color="#CCCCCC"> difference wing bro and snort</font>

241
00:10:26,860 --> 00:10:31,690
<font color="#CCCCCC">well they're</font><font color="#E5E5E5"> really apples and oranges</font>

242
00:10:28,960 --> 00:10:34,180
they don't do the same<font color="#CCCCCC"> thing snort uses</font>

243
00:10:31,690 --> 00:10:36,100
signatures to detect something<font color="#E5E5E5"> that</font>

244
00:10:34,180 --> 00:10:38,079
<font color="#CCCCCC">matches on your network</font><font color="#E5E5E5"> where bro is</font>

245
00:10:36,100 --> 00:10:42,280
really like running<font color="#CCCCCC"> a Wireshark its</font>

246
00:10:38,080 --> 00:10:44,260
scale<font color="#CCCCCC"> and decoding protocols using bro</font>

247
00:10:42,280 --> 00:10:46,689
scripts<font color="#E5E5E5"> and out of the box</font>

248
00:10:44,260 --> 00:10:48,610
all of the major protocols glue

249
00:10:46,690 --> 00:10:52,810
<font color="#CCCCCC">protocols</font><font color="#E5E5E5"> HTTP they're all log to a</font>

250
00:10:48,610 --> 00:10:55,390
<font color="#CCCCCC">text-based file so they're really</font><font color="#E5E5E5"> not</font>

251
00:10:52,810 --> 00:10:57,969
the<font color="#CCCCCC"> same</font><font color="#E5E5E5"> kind of thing they have</font>

252
00:10:55,390 --> 00:11:00,760
different use cases so use the tool for

253
00:10:57,970 --> 00:11:05,700
the<font color="#CCCCCC"> right</font><font color="#E5E5E5"> application just real quick</font>

254
00:11:00,760 --> 00:11:12,160
does anybody not<font color="#E5E5E5"> know what bro is</font><font color="#CCCCCC"> okay</font>

255
00:11:05,700 --> 00:11:15,810
so bro is um<font color="#CCCCCC"> like I said</font><font color="#E5E5E5"> a an open</font>

256
00:11:12,160 --> 00:11:18,910
source project<font color="#CCCCCC"> that essentially takes</font>

257
00:11:15,810 --> 00:11:22,119
protocols like HTTP and logs them to a

258
00:11:18,910 --> 00:11:24,610
log file<font color="#E5E5E5"> at scale on your network so all</font>

259
00:11:22,120 --> 00:11:28,720
the<font color="#CCCCCC"> workstations</font><font color="#E5E5E5"> where they go in terms</font>

260
00:11:24,610 --> 00:11:31,000
of<font color="#E5E5E5"> HTTP SSL traffic DHCP DNS and you</font>

261
00:11:28,720 --> 00:11:32,480
have those text files<font color="#E5E5E5"> over time so it's</font>

262
00:11:31,000 --> 00:11:35,410
basically decoding<font color="#CCCCCC"> those protocol</font>

263
00:11:32,480 --> 00:11:38,810
logging the activity of<font color="#E5E5E5"> those protocols</font>

264
00:11:35,410 --> 00:11:41,269
<font color="#E5E5E5">so a little</font><font color="#CCCCCC"> bit more about network</font>

265
00:11:38,810 --> 00:11:42,949
monitoring full packet captures anybody

266
00:11:41,269 --> 00:11:49,600
do full packet capture now on their

267
00:11:42,949 --> 00:11:52,880
network what do you use<font color="#CCCCCC"> oh yeah</font><font color="#E5E5E5"> cool</font>

268
00:11:49,600 --> 00:11:56,089
there are a<font color="#E5E5E5"> couple</font><font color="#CCCCCC"> open source tools</font><font color="#E5E5E5"> AOL</font>

269
00:11:52,880 --> 00:11:58,519
has a tool called Moloch<font color="#E5E5E5"> you can also do</font>

270
00:11:56,089 --> 00:12:00,829
it with<font color="#E5E5E5"> TCP dump and scripting in fact</font>

271
00:11:58,519 --> 00:12:02,779
if you<font color="#E5E5E5"> google full packet capture the</font>

272
00:12:00,829 --> 00:12:04,939
first or second hit is a sans white

273
00:12:02,779 --> 00:12:07,040
paper<font color="#E5E5E5"> that</font><font color="#CCCCCC"> explains how to do it with</font>

274
00:12:04,940 --> 00:12:10,339
TCP dump<font color="#E5E5E5"> and scripting there's a caveat</font>

275
00:12:07,040 --> 00:12:13,969
<font color="#CCCCCC">to that though</font><font color="#E5E5E5"> storing full packet data</font>

276
00:12:10,339 --> 00:12:15,800
is expensive<font color="#E5E5E5"> and even</font><font color="#CCCCCC"> though the scripts</font>

277
00:12:13,970 --> 00:12:18,860
<font color="#CCCCCC">and the OS to run on are going to</font><font color="#E5E5E5"> be</font>

278
00:12:15,800 --> 00:12:20,719
<font color="#E5E5E5">fruity so a saturated one gigabit</font>

279
00:12:18,860 --> 00:12:24,769
connection is<font color="#E5E5E5"> willing to store about</font><font color="#CCCCCC"> 6</font>

280
00:12:20,720 --> 00:12:27,529
terabytes<font color="#E5E5E5"> a day so it gets expensive</font>

281
00:12:24,769 --> 00:12:29,120
<font color="#E5E5E5">pretty quick to store it</font><font color="#CCCCCC"> also typically</font>

282
00:12:27,529 --> 00:12:32,329
<font color="#E5E5E5">in most scenarios you're going to need</font>

283
00:12:29,120 --> 00:12:39,709
and it's a relatively<font color="#E5E5E5"> expensive capture</font>

284
00:12:32,329 --> 00:12:43,430
card to do it so switching<font color="#CCCCCC"> gears from</font>

285
00:12:39,709 --> 00:12:45,589
<font color="#E5E5E5">network</font><font color="#CCCCCC"> to host based solutions we're</font>

286
00:12:43,430 --> 00:12:47,899
going to<font color="#CCCCCC"> focus today</font><font color="#E5E5E5"> on primarily on two</font>

287
00:12:45,589 --> 00:12:50,630
<font color="#E5E5E5">things on the</font><font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> system on a</font>

288
00:12:47,899 --> 00:12:54,440
system<font color="#CCCCCC"> turtles</font><font color="#E5E5E5"> tool that's written by</font>

289
00:12:50,630 --> 00:12:56,329
mark russinovich from<font color="#E5E5E5"> Microsoft and also</font>

290
00:12:54,440 --> 00:12:57,949
a logging capability get the logs<font color="#E5E5E5"> off</font>

291
00:12:56,329 --> 00:13:00,380
<font color="#E5E5E5">since Windows doesn't have a really cool</font>

292
00:12:57,949 --> 00:13:02,990
logging way to<font color="#CCCCCC"> to remote</font><font color="#E5E5E5"> to get the logs</font>

293
00:13:00,380 --> 00:13:04,730
off but the ability<font color="#CCCCCC"> to kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> look at</font>

294
00:13:02,990 --> 00:13:06,529
what's executing on the<font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> and</font>

295
00:13:04,730 --> 00:13:07,880
again this is<font color="#E5E5E5"> the I know there are a lot</font>

296
00:13:06,529 --> 00:13:10,189
of<font color="#E5E5E5"> commercial tools that are out</font><font color="#CCCCCC"> there</font>

297
00:13:07,880 --> 00:13:12,199
<font color="#CCCCCC">that do some of the things but</font><font color="#E5E5E5"> you know</font>

298
00:13:10,190 --> 00:13:14,510
again<font color="#CCCCCC"> this focus focus</font><font color="#E5E5E5"> is on what can we</font>

299
00:13:12,199 --> 00:13:17,649
do<font color="#CCCCCC"> smaller ir teams can do</font><font color="#E5E5E5"> small</font>

300
00:13:14,510 --> 00:13:23,149
companies<font color="#CCCCCC"> can do for basically</font><font color="#E5E5E5"> for free</font>

301
00:13:17,649 --> 00:13:26,240
<font color="#E5E5E5">and going more into system on hat who</font>

302
00:13:23,149 --> 00:13:26,630
hasn't heard<font color="#CCCCCC"> about system on good that's</font>

303
00:13:26,240 --> 00:13:30,819
awesome

304
00:13:26,630 --> 00:13:35,660
so<font color="#E5E5E5"> who doesn't like raising their hand</font>

305
00:13:30,819 --> 00:13:38,420
great<font color="#CCCCCC"> so I gotta like do some</font><font color="#E5E5E5"> double</font>

306
00:13:35,660 --> 00:13:41,029
negatives here<font color="#E5E5E5"> right but by default</font><font color="#CCCCCC"> this</font>

307
00:13:38,420 --> 00:13:42,260
<font color="#E5E5E5">is what's just not actually logs</font><font color="#CCCCCC"> we're</font>

308
00:13:41,029 --> 00:13:45,170
going to<font color="#CCCCCC"> focus a lot</font><font color="#E5E5E5"> on the process</font>

309
00:13:42,260 --> 00:13:45,710
create log<font color="#E5E5E5"> but it also not only logs the</font>

310
00:13:45,170 --> 00:13:47,449
process

311
00:13:45,710 --> 00:13:50,900
that are executing on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> on the system</font>

312
00:13:47,450 --> 00:13:53,450
but<font color="#E5E5E5"> it actually logs</font><font color="#CCCCCC"> the sha-1 hash of</font>

313
00:13:50,900 --> 00:13:55,220
that<font color="#E5E5E5"> process it logs the full path that</font>

314
00:13:53,450 --> 00:13:56,930
the process is executing from<font color="#E5E5E5"> it also</font>

315
00:13:55,220 --> 00:13:58,790
logs the full<font color="#E5E5E5"> command-line arguments</font>

316
00:13:56,930 --> 00:14:01,640
that<font color="#CCCCCC"> are given</font><font color="#E5E5E5"> when the process executes</font>

317
00:13:58,790 --> 00:14:03,290
<font color="#E5E5E5">and additionally</font><font color="#CCCCCC"> it also</font><font color="#E5E5E5"> logs the parent</font>

318
00:14:01,640 --> 00:14:05,660
process<font color="#E5E5E5"> and the parent processes</font>

319
00:14:03,290 --> 00:14:07,640
<font color="#CCCCCC">command-line arguments that was launched</font>

320
00:14:05,660 --> 00:14:09,560
<font color="#E5E5E5">some really valuable information so</font>

321
00:14:07,640 --> 00:14:13,730
here's<font color="#CCCCCC"> a</font><font color="#E5E5E5"> sample</font><font color="#CCCCCC"> of what a system on a</font>

322
00:14:09,560 --> 00:14:16,400
typical<font color="#CCCCCC"> system on log will look like</font><font color="#E5E5E5"> for</font>

323
00:14:13,730 --> 00:14:18,440
a basic<font color="#E5E5E5"> process execution so we have</font>

324
00:14:16,400 --> 00:14:19,730
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> and I'm sorry my virtual</font>

325
00:14:18,440 --> 00:14:23,150
<font color="#CCCCCC">machine has</font><font color="#E5E5E5"> a really old version</font><font color="#CCCCCC"> of</font>

326
00:14:19,730 --> 00:14:24,980
PowerShell<font color="#CCCCCC"> but PowerShell needs to say</font>

327
00:14:23,150 --> 00:14:27,020
you could see the image there of the

328
00:14:24,980 --> 00:14:30,550
full path on disk<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> command line</font>

329
00:14:27,020 --> 00:14:33,740
<font color="#CCCCCC">that was</font><font color="#E5E5E5"> executed</font><font color="#CCCCCC"> the sha-1</font><font color="#E5E5E5"> hash and</font>

330
00:14:30,550 --> 00:14:36,170
then also the parent process<font color="#E5E5E5"> so we see</font>

331
00:14:33,740 --> 00:14:39,680
that CMD dot exe executed or was the

332
00:14:36,170 --> 00:14:42,319
<font color="#CCCCCC">para process</font><font color="#E5E5E5"> that executed PowerShell go</font>

333
00:14:39,680 --> 00:14:43,880
ahead the one thing I also wanted<font color="#CCCCCC"> to</font>

334
00:14:42,320 --> 00:14:46,610
mention and<font color="#CCCCCC"> we acted this slide in here</font>

335
00:14:43,880 --> 00:14:49,130
last<font color="#E5E5E5"> minute</font><font color="#CCCCCC"> if for</font><font color="#E5E5E5"> those of you that</font>

336
00:14:46,610 --> 00:14:50,900
were<font color="#E5E5E5"> able to go to</font><font color="#CCCCCC"> Daniels presentation</font>

337
00:14:49,130 --> 00:14:53,720
Daniel from<font color="#CCCCCC"> Andy at yesterday</font><font color="#E5E5E5"> really</font>

338
00:14:50,900 --> 00:14:55,310
<font color="#E5E5E5">awesome presentation kudos to him</font><font color="#CCCCCC"> he</font>

339
00:14:53,720 --> 00:14:59,600
went<font color="#E5E5E5"> through a lot of PowerShell and</font>

340
00:14:55,310 --> 00:15:02,420
occupation techniques<font color="#E5E5E5"> one thing that you</font>

341
00:14:59,600 --> 00:15:04,600
might<font color="#E5E5E5"> want to also do is not just try to</font>

342
00:15:02,420 --> 00:15:08,660
find known evil in your environment<font color="#CCCCCC"> or</font>

343
00:15:04,600 --> 00:15:11,690
<font color="#E5E5E5">not good but look for good indicators or</font>

344
00:15:08,660 --> 00:15:15,560
good processes<font color="#CCCCCC"> that are operating or</font>

345
00:15:11,690 --> 00:15:17,600
executing out of known spaces so lots of

346
00:15:15,560 --> 00:15:20,089
times<font color="#E5E5E5"> what bad</font><font color="#CCCCCC"> guys like to do is take</font>

347
00:15:17,600 --> 00:15:21,770
something<font color="#E5E5E5"> like CMD dot exe or</font><font color="#CCCCCC"> PowerShell</font>

348
00:15:20,090 --> 00:15:23,180
dot exe and<font color="#CCCCCC"> if they know that the good</font>

349
00:15:21,770 --> 00:15:25,010
<font color="#CCCCCC">guys are</font><font color="#E5E5E5"> logging those and kind of</font>

350
00:15:23,180 --> 00:15:28,099
running regular expressions or other

351
00:15:25,010 --> 00:15:29,630
kind of pattern recognition<font color="#CCCCCC"> scripts to</font>

352
00:15:28,100 --> 00:15:31,460
<font color="#CCCCCC">go see what are the command line</font>

353
00:15:29,630 --> 00:15:34,040
arguments for those processes<font color="#CCCCCC"> they just</font>

354
00:15:31,460 --> 00:15:36,770
copy that<font color="#E5E5E5"> process to somewhere in you</font>

355
00:15:34,040 --> 00:15:39,680
know<font color="#E5E5E5"> percent</font><font color="#CCCCCC"> AppData percent</font><font color="#E5E5E5"> and then</font>

356
00:15:36,770 --> 00:15:43,610
execute<font color="#E5E5E5"> it out of there and so if you</font>

357
00:15:39,680 --> 00:15:47,599
look<font color="#CCCCCC"> here what was done was we have the</font>

358
00:15:43,610 --> 00:15:50,180
same<font color="#CCCCCC"> sha-1</font><font color="#E5E5E5"> of the of the hash</font><font color="#CCCCCC"> that was</font>

359
00:15:47,600 --> 00:15:54,530
<font color="#CCCCCC">PowerShell dot exe running but in this</font>

360
00:15:50,180 --> 00:15:56,180
case it's the valid process<font color="#CCCCCC"> powershell</font>

361
00:15:54,530 --> 00:15:57,800
dot exe<font color="#E5E5E5"> but it's running out of could go</font>

362
00:15:56,180 --> 00:15:59,270
back one sec so<font color="#E5E5E5"> you can see it so it's</font>

363
00:15:57,800 --> 00:16:02,390
<font color="#E5E5E5">running</font><font color="#CCCCCC"> out of</font>

364
00:15:59,270 --> 00:16:04,490
basically<font color="#CCCCCC"> percent AppData percent which</font>

365
00:16:02,390 --> 00:16:06,949
is<font color="#CCCCCC"> the users</font><font color="#E5E5E5"> directory called not</font>

366
00:16:04,490 --> 00:16:08,990
<font color="#E5E5E5">Mallard not Exe but the hash is the same</font>

367
00:16:06,950 --> 00:16:12,020
hash<font color="#CCCCCC"> as powershell dat</font><font color="#E5E5E5"> so what you</font>

368
00:16:08,990 --> 00:16:15,640
typically want to do is generate a<font color="#E5E5E5"> list</font>

369
00:16:12,020 --> 00:16:19,130
of known good hashes specifically like

370
00:16:15,640 --> 00:16:20,960
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> Turtles like cmd.exe</font><font color="#CCCCCC"> and</font>

371
00:16:19,130 --> 00:16:23,780
<font color="#CCCCCC">PowerShell and</font><font color="#E5E5E5"> some other things and</font>

372
00:16:20,960 --> 00:16:27,440
<font color="#CCCCCC">then look for the</font><font color="#E5E5E5"> execution of those</font>

373
00:16:23,780 --> 00:16:29,630
processes<font color="#E5E5E5"> outside of C windows or C</font>

374
00:16:27,440 --> 00:16:34,400
windows system32<font color="#CCCCCC"> and you probably</font><font color="#E5E5E5"> found</font>

375
00:16:29,630 --> 00:16:37,160
<font color="#E5E5E5">something interesting so we've been on</font>

376
00:16:34,400 --> 00:16:40,490
<font color="#CCCCCC">wall</font><font color="#E5E5E5"> consolidation so as a penetration</font>

377
00:16:37,160 --> 00:16:43,550
tester<font color="#CCCCCC"> I hardly ever see one anyone</font>

378
00:16:40,490 --> 00:16:46,310
logging centrally and it may sound weird

379
00:16:43,550 --> 00:16:47,689
<font color="#CCCCCC">to</font><font color="#E5E5E5"> you guys but it just there's I get</font>

380
00:16:46,310 --> 00:16:50,660
the question<font color="#CCCCCC"> all the time well how can I</font>

381
00:16:47,690 --> 00:16:52,490
have detected what you did<font color="#CCCCCC"> well having</font>

382
00:16:50,660 --> 00:16:54,530
somebody<font color="#E5E5E5"> watch centralized logs would</font>

383
00:16:52,490 --> 00:16:57,050
have been a really really<font color="#E5E5E5"> good start</font><font color="#CCCCCC"> so</font>

384
00:16:54,530 --> 00:17:00,579
<font color="#CCCCCC">how can</font><font color="#E5E5E5"> you do that for</font><font color="#CCCCCC"> free and Windows</font>

385
00:16:57,050 --> 00:17:03,170
I can't believe that<font color="#E5E5E5"> it's 2017 and</font>

386
00:17:00,580 --> 00:17:03,590
<font color="#CCCCCC">Windows does not have a native syslog</font>

387
00:17:03,170 --> 00:17:06,470
shipper

388
00:17:03,590 --> 00:17:09,110
<font color="#E5E5E5">I just I still have anybody</font><font color="#CCCCCC"> else find</font>

389
00:17:06,470 --> 00:17:11,960
that odd why can't Windows just<font color="#E5E5E5"> build in</font>

390
00:17:09,109 --> 00:17:15,109
a native syslog shipper<font color="#E5E5E5"> but there is</font><font color="#CCCCCC"> NS</font>

391
00:17:11,960 --> 00:17:16,160
<font color="#E5E5E5">log</font><font color="#CCCCCC"> alright sorry NX log which there's a</font>

392
00:17:15,109 --> 00:17:20,540
free<font color="#CCCCCC"> Community Edition</font>

393
00:17:16,160 --> 00:17:24,020
and it works beautifully<font color="#E5E5E5"> to send Windows</font>

394
00:17:20,540 --> 00:17:26,510
event logs into<font color="#E5E5E5"> a syslog server and a</font>

395
00:17:24,020 --> 00:17:30,710
<font color="#CCCCCC">variety of formats as you'll see later</font><font color="#E5E5E5"> I</font>

396
00:17:26,510 --> 00:17:33,440
picked JSON and<font color="#E5E5E5"> then also of</font><font color="#CCCCCC"> course</font>

397
00:17:30,710 --> 00:17:35,240
there's native syslog on devices<font color="#CCCCCC"> you</font>

398
00:17:33,440 --> 00:17:37,820
know that are<font color="#E5E5E5"> Linux based and Linux</font>

399
00:17:35,240 --> 00:17:40,130
clients themselves<font color="#CCCCCC"> and then there is</font>

400
00:17:37,820 --> 00:17:41,750
Windows Event collector<font color="#E5E5E5"> but the reason I</font>

401
00:17:40,130 --> 00:17:43,720
didn't choose<font color="#CCCCCC"> to do that in the lab that</font>

402
00:17:41,750 --> 00:17:46,820
<font color="#CCCCCC">you'll see here in a bit was because</font>

403
00:17:43,720 --> 00:17:47,780
other<font color="#E5E5E5"> devices can't log to it and if</font>

404
00:17:46,820 --> 00:17:49,399
you're going<font color="#E5E5E5"> to be setting up something</font>

405
00:17:47,780 --> 00:17:51,680
<font color="#CCCCCC">you</font><font color="#E5E5E5"> don't have centralized logging and</font>

406
00:17:49,400 --> 00:17:53,600
you're going<font color="#E5E5E5"> to set up a server to log</font>

407
00:17:51,680 --> 00:17:55,460
<font color="#E5E5E5">it's probably good</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get the most</font>

408
00:17:53,600 --> 00:17:59,030
<font color="#E5E5E5">coverage out of that as you</font><font color="#CCCCCC"> can so I</font>

409
00:17:55,460 --> 00:18:03,920
<font color="#E5E5E5">ended up going</font><font color="#CCCCCC"> to NX log and so for</font>

410
00:17:59,030 --> 00:18:07,120
correlation so a<font color="#E5E5E5"> sim for free a DIY</font><font color="#CCCCCC"> cell</font>

411
00:18:03,920 --> 00:18:09,140
so there are things<font color="#E5E5E5"> like</font><font color="#CCCCCC"> grey log and</font>

412
00:18:07,120 --> 00:18:11,389
<font color="#CCCCCC">elasticsearch I'm sure a lot of you guys</font>

413
00:18:09,140 --> 00:18:12,290
have heard<font color="#E5E5E5"> of them but we didn't choose</font>

414
00:18:11,390 --> 00:18:14,690
<font color="#CCCCCC">that for this one</font>

415
00:18:12,290 --> 00:18:16,879
because<font color="#E5E5E5"> honestly it's difficult to stand</font>

416
00:18:14,690 --> 00:18:19,880
up and<font color="#E5E5E5"> maintain it's not impossible but</font>

417
00:18:16,880 --> 00:18:22,310
for<font color="#CCCCCC"> a small ir team I think there it's</font>

418
00:18:19,880 --> 00:18:24,110
an easier win<font color="#E5E5E5"> to go with logging to a</font>

419
00:18:22,310 --> 00:18:28,310
text-based file and<font color="#E5E5E5"> using</font><font color="#CCCCCC"> command-line</font>

420
00:18:24,110 --> 00:18:31,429
<font color="#E5E5E5">tools and then once that's in place to</font>

421
00:18:28,310 --> 00:18:33,770
move on to something

422
00:18:31,430 --> 00:18:35,360
you know<font color="#E5E5E5"> maybe open source however it's</font>

423
00:18:33,770 --> 00:18:37,850
also<font color="#E5E5E5"> probably not realistic</font><font color="#CCCCCC"> that you</font>

424
00:18:35,360 --> 00:18:39,590
have no budget<font color="#CCCCCC"> at all right</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> if you</font>

425
00:18:37,850 --> 00:18:41,570
<font color="#E5E5E5">have a budget</font><font color="#CCCCCC"> and you're looking for</font>

426
00:18:39,590 --> 00:18:45,129
something spend money on I would

427
00:18:41,570 --> 00:18:45,129
<font color="#CCCCCC">actually probably spend that on</font><font color="#E5E5E5"> a film</font>

428
00:18:46,840 --> 00:18:53,959
yeah so basically when you're doing

429
00:18:51,050 --> 00:18:55,639
forensics<font color="#E5E5E5"> or actually part of your IR</font>

430
00:18:53,960 --> 00:18:57,590
team<font color="#E5E5E5"> and you and you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> it event</font>

431
00:18:55,640 --> 00:18:59,270
<font color="#E5E5E5">something</font><font color="#CCCCCC"> that got through and then you</font>

432
00:18:57,590 --> 00:19:01,310
have to go<font color="#CCCCCC"> find</font><font color="#E5E5E5"> okay well how many</font>

433
00:18:59,270 --> 00:19:03,080
<font color="#E5E5E5">systems are affected how do we do this</font>

434
00:19:01,310 --> 00:19:05,600
we<font color="#CCCCCC"> really want to look</font><font color="#E5E5E5"> for solutions</font>

435
00:19:03,080 --> 00:19:07,550
<font color="#E5E5E5">that scale you</font><font color="#CCCCCC"> don't want a</font><font color="#E5E5E5"> one-to-one</font>

436
00:19:05,600 --> 00:19:09,310
although there's tools out there<font color="#E5E5E5"> where</font>

437
00:19:07,550 --> 00:19:12,200
they're<font color="#E5E5E5"> really good one to one type</font>

438
00:19:09,310 --> 00:19:14,389
<font color="#E5E5E5">analyst to the</font><font color="#CCCCCC"> endpoint but</font><font color="#E5E5E5"> you want one</font>

439
00:19:12,200 --> 00:19:17,650
<font color="#CCCCCC">too</font><font color="#E5E5E5"> many you</font><font color="#CCCCCC"> want an analyst</font><font color="#E5E5E5"> to like</font>

440
00:19:14,390 --> 00:19:21,050
<font color="#CCCCCC">five thousand so</font><font color="#E5E5E5"> you can then</font><font color="#CCCCCC"> go and say</font>

441
00:19:17,650 --> 00:19:22,670
you know you know one too many or<font color="#E5E5E5"> one</font>

442
00:19:21,050 --> 00:19:24,110
the one solutions<font color="#E5E5E5"> how are you going to</font>

443
00:19:22,670 --> 00:19:25,400
<font color="#E5E5E5">be able to detect or find all these</font>

444
00:19:24,110 --> 00:19:28,100
<font color="#E5E5E5">things in</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> environment it's just not</font>

445
00:19:25,400 --> 00:19:30,770
going<font color="#E5E5E5"> to work</font><font color="#CCCCCC"> so we listed</font><font color="#E5E5E5"> a couple</font>

446
00:19:28,100 --> 00:19:33,199
<font color="#E5E5E5">things in</font><font color="#CCCCCC"> here and I think for</font><font color="#E5E5E5"> the lab</font>

447
00:19:30,770 --> 00:19:34,840
<font color="#E5E5E5">purposes and the attacks simulation that</font>

448
00:19:33,200 --> 00:19:38,690
we do

449
00:19:34,840 --> 00:19:40,459
<font color="#CCCCCC">Google's Gert tool is what we we ended</font>

450
00:19:38,690 --> 00:19:43,970
<font color="#E5E5E5">up calling Google</font><font color="#CCCCCC"> Rapid Response</font><font color="#E5E5E5"> does</font>

451
00:19:40,460 --> 00:19:48,100
anyone use Google<font color="#E5E5E5"> Rapid Response suite I</font>

452
00:19:43,970 --> 00:19:48,100
was thoroughly impressed<font color="#CCCCCC"> with that</font><font color="#E5E5E5"> tool</font>

453
00:19:48,370 --> 00:19:59,050
so I guess<font color="#E5E5E5"> for the what we did for</font><font color="#CCCCCC"> this</font>

454
00:19:54,350 --> 00:20:03,139
<font color="#E5E5E5">attack talk was set up a lab and then we</font>

455
00:19:59,050 --> 00:20:06,649
<font color="#CCCCCC">wanted</font><font color="#E5E5E5"> to conduct a real-world attack so</font>

456
00:20:03,140 --> 00:20:09,980
<font color="#E5E5E5">we called it operation</font><font color="#CCCCCC"> wannabe we were</font>

457
00:20:06,650 --> 00:20:11,810
going to use the<font color="#E5E5E5"> actual wanna cry or the</font>

458
00:20:09,980 --> 00:20:13,940
exploits<font color="#E5E5E5"> that were based on what all</font>

459
00:20:11,810 --> 00:20:16,580
that<font color="#E5E5E5"> wanna cry was based on because</font>

460
00:20:13,940 --> 00:20:18,710
<font color="#E5E5E5">they're in</font><font color="#CCCCCC"> Metasploit now it</font><font color="#E5E5E5"> actually</font>

461
00:20:16,580 --> 00:20:21,439
turned out<font color="#CCCCCC"> to not really work that well</font>

462
00:20:18,710 --> 00:20:24,050
<font color="#E5E5E5">so</font><font color="#CCCCCC"> but we still</font><font color="#E5E5E5"> thought we should name</font>

463
00:20:21,440 --> 00:20:25,850
<font color="#CCCCCC">it operation want to be and so we chose</font>

464
00:20:24,050 --> 00:20:28,010
basically

465
00:20:25,850 --> 00:20:31,219
<font color="#CCCCCC">and attack because it</font><font color="#E5E5E5"> still works so</font>

466
00:20:28,010 --> 00:20:34,280
<font color="#E5E5E5">modeling a fish gaining a foothold and</font>

467
00:20:31,220 --> 00:20:36,950
then moving<font color="#E5E5E5"> laterally</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font>

468
00:20:34,280 --> 00:20:39,770
established situ<font color="#E5E5E5"> over encryption or an</font>

469
00:20:36,950 --> 00:20:43,150
encrypted<font color="#CCCCCC"> channel and then</font><font color="#E5E5E5"> action</font><font color="#CCCCCC"> zone</font>

470
00:20:39,770 --> 00:20:47,360
objectives<font color="#CCCCCC"> to exit rate sensitive</font><font color="#E5E5E5"> data</font>

471
00:20:43,150 --> 00:20:50,780
so the part of this<font color="#E5E5E5"> I actually now have</font>

472
00:20:47,360 --> 00:20:52,490
an amazing lab at my house<font color="#E5E5E5"> it's held</font>

473
00:20:50,780 --> 00:20:56,149
together by duct tape and popsicle

474
00:20:52,490 --> 00:20:59,360
sticks but still we had a domain

475
00:20:56,150 --> 00:21:02,630
controller<font color="#CCCCCC"> a sequel server</font><font color="#E5E5E5"> a file server</font>

476
00:20:59,360 --> 00:21:06,168
<font color="#E5E5E5">a handful of Windows workstations</font><font color="#CCCCCC"> and</font>

477
00:21:02,630 --> 00:21:08,809
then<font color="#E5E5E5"> on a bunt to syslog server and a</font>

478
00:21:06,169 --> 00:21:11,080
<font color="#CCCCCC">pfSense firewall so for the products</font>

479
00:21:08,809 --> 00:21:15,080
<font color="#E5E5E5">that we chose to go through this with</font>

480
00:21:11,080 --> 00:21:16,970
<font color="#E5E5E5">bro sis Mon and X log Google rapid</font>

481
00:21:15,080 --> 00:21:19,939
response<font color="#E5E5E5"> and then deploying these</font>

482
00:21:16,970 --> 00:21:22,130
through group<font color="#CCCCCC"> policy and so if anyone's</font>

483
00:21:19,940 --> 00:21:24,020
<font color="#E5E5E5">interested at the end of June I'm doing</font>

484
00:21:22,130 --> 00:21:25,460
a webcast or Black Hills<font color="#E5E5E5"> of doing a</font>

485
00:21:24,020 --> 00:21:28,340
webcast where I actually<font color="#E5E5E5"> walk through</font>

486
00:21:25,460 --> 00:21:31,130
<font color="#CCCCCC">how I set all this up I figured for the</font>

487
00:21:28,340 --> 00:21:33,590
<font color="#E5E5E5">purposes</font><font color="#CCCCCC"> of this talk I'd end up</font>

488
00:21:31,130 --> 00:21:39,950
<font color="#E5E5E5">spending a half hour 45</font><font color="#CCCCCC"> minutes just</font>

489
00:21:33,590 --> 00:21:41,449
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> about that we didn't really</font><font color="#E5E5E5"> want</font>

490
00:21:39,950 --> 00:21:42,650
to<font color="#E5E5E5"> walk through the actual attack</font>

491
00:21:41,450 --> 00:21:45,320
because I didn't want<font color="#E5E5E5"> to tell the story</font>

492
00:21:42,650 --> 00:21:47,030
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the attack through the attackers</font>

493
00:21:45,320 --> 00:21:49,939
perspective<font color="#CCCCCC"> I thought it would be a</font>

494
00:21:47,030 --> 00:21:51,408
whole lot<font color="#E5E5E5"> more fun to</font><font color="#CCCCCC"> use the tools that</font>

495
00:21:49,940 --> 00:21:55,450
we're<font color="#CCCCCC"> talking about to</font><font color="#E5E5E5"> figure out what</font>

496
00:21:51,409 --> 00:21:58,990
would<font color="#E5E5E5"> happen or what happened</font>

497
00:21:55,450 --> 00:22:02,470
so we debated this a little bit of how

498
00:21:58,990 --> 00:22:05,299
the pretend<font color="#CCCCCC"> IR team got alerted through</font>

499
00:22:02,470 --> 00:22:06,980
<font color="#E5E5E5">it was something wrong on an endpoint</font>

500
00:22:05,299 --> 00:22:09,260
<font color="#CCCCCC">but</font><font color="#E5E5E5"> there was something</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> on there</font>

501
00:22:06,980 --> 00:22:11,299
was a compromise<font color="#E5E5E5"> that happened and so</font>

502
00:22:09,260 --> 00:22:13,520
what we figured<font color="#E5E5E5"> was no matter what we</font>

503
00:22:11,299 --> 00:22:15,230
chose it would be arbitrary<font color="#CCCCCC"> because we</font>

504
00:22:13,520 --> 00:22:17,299
did the attack right so we could have

505
00:22:15,230 --> 00:22:20,539
said oh we found a fish or a large data

506
00:22:17,299 --> 00:22:22,400
transfer but I<font color="#E5E5E5"> thought it'd</font><font color="#CCCCCC"> be fun to</font>

507
00:22:20,539 --> 00:22:25,070
look<font color="#E5E5E5"> at the SSL log has anybody in here</font>

508
00:22:22,400 --> 00:22:28,940
ever looked to see what happens when you

509
00:22:25,070 --> 00:22:33,470
set up meterpreter<font color="#CCCCCC"> a reverse HTTP</font>

510
00:22:28,940 --> 00:22:37,909
listener it so the common name of<font color="#E5E5E5"> the</font>

511
00:22:33,470 --> 00:22:39,560
<font color="#E5E5E5">certificate that that that's used is</font>

512
00:22:37,909 --> 00:22:43,450
randomly<font color="#CCCCCC"> generated</font>

513
00:22:39,560 --> 00:22:45,370
so in this case in the bro log when the

514
00:22:43,450 --> 00:22:49,490
attack happened

515
00:22:45,370 --> 00:22:52,580
there was a really odd named<font color="#E5E5E5"> common name</font>

516
00:22:49,490 --> 00:22:54,380
<font color="#E5E5E5">that</font><font color="#CCCCCC"> was recorded</font><font color="#E5E5E5"> by bro</font><font color="#CCCCCC"> I mean I I know</font>

517
00:22:52,580 --> 00:23:00,439
you<font color="#E5E5E5"> guys can't see the log file very</font>

518
00:22:54,380 --> 00:23:01,670
well<font color="#E5E5E5"> but a common name of herb</font><font color="#CCCCCC"> ja that's</font>

519
00:23:00,440 --> 00:23:04,430
<font color="#E5E5E5">probably not normal</font>

520
00:23:01,670 --> 00:23:06,560
oh yeah the other<font color="#CCCCCC"> thing too is you see</font>

521
00:23:04,430 --> 00:23:09,350
the the other common names<font color="#E5E5E5"> above it or</font>

522
00:23:06,560 --> 00:23:12,350
the<font color="#E5E5E5"> other certificate fields above it</font>

523
00:23:09,350 --> 00:23:15,260
<font color="#E5E5E5">all have other you know indications like</font>

524
00:23:12,350 --> 00:23:18,260
<font color="#E5E5E5">location and OU's and</font><font color="#CCCCCC"> and such as that</font>

525
00:23:15,260 --> 00:23:20,390
right so here<font color="#CCCCCC"> we just</font><font color="#E5E5E5"> see a common name</font>

526
00:23:18,260 --> 00:23:23,000
random common name and<font color="#E5E5E5"> pretty much all</font>

527
00:23:20,390 --> 00:23:25,550
those other<font color="#CCCCCC"> fields</font><font color="#E5E5E5"> are not filled out so</font>

528
00:23:23,000 --> 00:23:27,200
yeah and and<font color="#E5E5E5"> so you know in a normal day</font>

529
00:23:25,550 --> 00:23:28,430
<font color="#CCCCCC">of</font><font color="#E5E5E5"> someone who monitors and doesn't</font><font color="#CCCCCC"> and</font>

530
00:23:27,200 --> 00:23:31,040
<font color="#E5E5E5">it</font><font color="#CCCCCC"> responds I mean that's not</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> end of</font>

531
00:23:28,430 --> 00:23:35,390
the world<font color="#E5E5E5"> right but I would probably go</font>

532
00:23:31,040 --> 00:23:37,100
look at<font color="#E5E5E5"> that so then usually if it's a</font>

533
00:23:35,390 --> 00:23:38,990
network indicator<font color="#CCCCCC"> you'll look</font><font color="#E5E5E5"> around to</font>

534
00:23:37,100 --> 00:23:41,990
see what<font color="#E5E5E5"> else happened on the network so</font>

535
00:23:38,990 --> 00:23:44,800
this is still<font color="#E5E5E5"> bro</font><font color="#CCCCCC"> and it looked like the</font>

536
00:23:41,990 --> 00:23:50,240
internal IP address made a connection

537
00:23:44,800 --> 00:23:54,320
<font color="#CCCCCC">role IP</font><font color="#E5E5E5"> out to over SSL to the server</font>

538
00:23:50,240 --> 00:23:59,020
<font color="#E5E5E5">over TCP 443 and then also there are a</font>

539
00:23:54,320 --> 00:24:02,240
whole lot<font color="#CCCCCC"> of connections</font><font color="#E5E5E5"> to TCP 4 4 4 4</font>

540
00:23:59,020 --> 00:24:06,139
does anybody know what that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> or what</font>

541
00:24:02,240 --> 00:24:07,460
<font color="#E5E5E5">it's associated</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> yeah yes the</font>

542
00:24:06,140 --> 00:24:11,200
attacker didn't<font color="#E5E5E5"> know what he was doing</font>

543
00:24:07,460 --> 00:24:15,080
right good job<font color="#E5E5E5"> there yeah yeah</font>

544
00:24:11,200 --> 00:24:18,500
so if you see this now I'm getting kind

545
00:24:15,080 --> 00:24:20,120
of more concerned<font color="#E5E5E5"> right so now I have an</font>

546
00:24:18,500 --> 00:24:23,270
indication<font color="#CCCCCC"> that there's something</font><font color="#E5E5E5"> going</font>

547
00:24:20,120 --> 00:24:28,209
on on the<font color="#CCCCCC"> endpoint that's probably not</font>

548
00:24:23,270 --> 00:24:30,879
normal in this lovely log<font color="#E5E5E5"> so the</font>

549
00:24:28,210 --> 00:24:34,310
everyone<font color="#E5E5E5"> can read that yeah</font><font color="#CCCCCC"> Ray's</font><font color="#E5E5E5"> active</font>

550
00:24:30,880 --> 00:24:36,170
so<font color="#E5E5E5"> so we showed you it up front at the</font>

551
00:24:34,310 --> 00:24:38,149
beginning<font color="#E5E5E5"> what</font><font color="#CCCCCC"> sis mom looks like nice</font>

552
00:24:36,170 --> 00:24:41,360
and<font color="#E5E5E5"> pretty when you look at it at an MMC</font>

553
00:24:38,150 --> 00:24:44,200
<font color="#E5E5E5">shell session</font><font color="#CCCCCC"> but when you grab that</font>

554
00:24:41,360 --> 00:24:47,000
<font color="#CCCCCC">data</font><font color="#E5E5E5"> and port it</font><font color="#CCCCCC"> over the</font><font color="#E5E5E5"> assist log</font>

555
00:24:44,200 --> 00:24:50,270
this<font color="#E5E5E5"> is kind of like what you live it's</font>

556
00:24:47,000 --> 00:24:51,280
raw data<font color="#E5E5E5"> raw data so we said it was poor</font>

557
00:24:50,270 --> 00:24:53,290
<font color="#E5E5E5">man Stivers</font>

558
00:24:51,280 --> 00:24:56,260
<font color="#CCCCCC">by if you expected it to be a pretty web</font>

559
00:24:53,290 --> 00:24:57,370
dashboard<font color="#E5E5E5"> I'm sorry yeah so I mean</font>

560
00:24:56,260 --> 00:24:59,080
<font color="#E5E5E5">essentially if you're going to be doing</font>

561
00:24:57,370 --> 00:25:01,479
<font color="#E5E5E5">this and like</font><font color="#CCCCCC"> Derek setup front you</font><font color="#E5E5E5"> want</font>

562
00:24:59,080 --> 00:25:03,010
to be investing in not<font color="#CCCCCC"> only centralized</font>

563
00:25:01,480 --> 00:25:05,350
logging which is great when<font color="#E5E5E5"> you get the</font>

564
00:25:03,010 --> 00:25:07,420
logs over<font color="#E5E5E5"> but probably some type of</font>

565
00:25:05,350 --> 00:25:08,949
<font color="#CCCCCC">correlation engine</font><font color="#E5E5E5"> or something where</font>

566
00:25:07,420 --> 00:25:11,050
you<font color="#E5E5E5"> can then start ripping these</font><font color="#CCCCCC"> fields</font>

567
00:25:08,950 --> 00:25:12,220
out and then indexing them or<font color="#E5E5E5"> doing</font>

568
00:25:11,050 --> 00:25:13,990
something<font color="#E5E5E5"> with</font><font color="#CCCCCC"> them so</font><font color="#E5E5E5"> you can more</font>

569
00:25:12,220 --> 00:25:15,040
<font color="#E5E5E5">quickly go</font><font color="#CCCCCC"> through that</font><font color="#E5E5E5"> that's obviously</font>

570
00:25:13,990 --> 00:25:18,220
where you're going to want<font color="#E5E5E5"> to</font><font color="#CCCCCC"> spend your</font>

571
00:25:15,040 --> 00:25:20,320
time<font color="#E5E5E5"> and effort but here you can see by</font>

572
00:25:18,220 --> 00:25:23,050
pivoting<font color="#E5E5E5"> on that IP</font><font color="#CCCCCC"> address that was in</font>

573
00:25:20,320 --> 00:25:26,260
the bro data<font color="#E5E5E5"> now we see this because we</font>

574
00:25:23,050 --> 00:25:28,389
can we're logging<font color="#E5E5E5"> all processes and oh</font>

575
00:25:26,260 --> 00:25:30,160
by the way<font color="#E5E5E5"> system on also logs all</font>

576
00:25:28,390 --> 00:25:33,670
network connections made by all

577
00:25:30,160 --> 00:25:36,250
processes<font color="#CCCCCC"> then you can we</font><font color="#E5E5E5"> can find by</font>

578
00:25:33,670 --> 00:25:39,040
pivoting on<font color="#E5E5E5"> that IP that</font><font color="#CCCCCC"> PowerShell is</font>

579
00:25:36,250 --> 00:25:43,180
the responsible party or process of

580
00:25:39,040 --> 00:25:45,550
<font color="#CCCCCC">making that</font><font color="#E5E5E5"> network connection yeah and</font>

581
00:25:43,180 --> 00:25:49,810
so using<font color="#CCCCCC"> command line</font><font color="#E5E5E5"> tools like you</font>

582
00:25:45,550 --> 00:25:53,340
know<font color="#CCCCCC"> grid and grep and all</font><font color="#E5E5E5"> once you get</font>

583
00:25:49,810 --> 00:25:53,340
used<font color="#CCCCCC"> to it it's actually pretty powerful</font>

584
00:25:54,390 --> 00:26:00,220
so you're also in the<font color="#E5E5E5"> system on log we</font>

585
00:25:57,940 --> 00:26:02,920
see some subsequent<font color="#E5E5E5"> commands that were</font>

586
00:26:00,220 --> 00:26:07,020
run on the workstation<font color="#E5E5E5"> so how many of</font>

587
00:26:02,920 --> 00:26:11,140
<font color="#E5E5E5">your users typically run net commands</font>

588
00:26:07,020 --> 00:26:13,210
yeah that<font color="#E5E5E5"> that's not normal</font><font color="#CCCCCC"> so that</font><font color="#E5E5E5"> so</font>

589
00:26:11,140 --> 00:26:14,800
the log that<font color="#E5E5E5"> was</font><font color="#CCCCCC"> associated with this if</font>

590
00:26:13,210 --> 00:26:16,630
you<font color="#E5E5E5"> thought the</font><font color="#CCCCCC"> last one</font><font color="#E5E5E5"> was bad there</font>

591
00:26:14,800 --> 00:26:20,379
was no way a<font color="#E5E5E5"> screenshot was coming out</font>

592
00:26:16,630 --> 00:26:23,380
<font color="#E5E5E5">of this so</font><font color="#CCCCCC"> so it was net users domain</font>

593
00:26:20,380 --> 00:26:25,660
and net accounts domain and a whole lot

594
00:26:23,380 --> 00:26:27,520
of LDAP connections to the domain

595
00:26:25,660 --> 00:26:29,080
controller they actually kind of

596
00:26:27,520 --> 00:26:30,580
correspond it to the same amount<font color="#E5E5E5"> of</font>

597
00:26:29,080 --> 00:26:35,290
users<font color="#CCCCCC"> that were in the domain does</font>

598
00:26:30,580 --> 00:26:38,909
anybody know what<font color="#CCCCCC"> happened there was it</font>

599
00:26:35,290 --> 00:26:43,149
was a password spray so they attacker<font color="#E5E5E5"> me</font>

600
00:26:38,910 --> 00:26:45,250
<font color="#CCCCCC">was trying</font><font color="#E5E5E5"> to guess a password for you</font>

601
00:26:43,150 --> 00:26:47,230
know the users in<font color="#E5E5E5"> the domain</font><font color="#CCCCCC"> now in this</font>

602
00:26:45,250 --> 00:26:49,990
case in the lab yes it's kind<font color="#E5E5E5"> of</font>

603
00:26:47,230 --> 00:26:53,200
contrived<font color="#E5E5E5"> but I didn't have a thousand</font>

604
00:26:49,990 --> 00:26:54,760
users so as an attacker if I you know

605
00:26:53,200 --> 00:26:56,710
get into<font color="#E5E5E5"> an environment</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> has a</font>

606
00:26:54,760 --> 00:26:58,510
thousand or<font color="#E5E5E5"> more users and you have an</font>

607
00:26:56,710 --> 00:27:00,400
eight<font color="#E5E5E5"> character password policy what do</font>

608
00:26:58,510 --> 00:27:02,520
you think the chances are that I'm going

609
00:27:00,400 --> 00:27:04,530
<font color="#CCCCCC">to guess</font><font color="#E5E5E5"> that someone's password is</font>

610
00:27:02,520 --> 00:27:10,680
<font color="#CCCCCC">I guess it's still spring</font><font color="#E5E5E5"> right spring</font>

611
00:27:04,530 --> 00:27:12,840
2017 probably a hundred<font color="#CCCCCC"> percent so so</font>

612
00:27:10,680 --> 00:27:15,920
now you know really concerned that

613
00:27:12,840 --> 00:27:20,280
<font color="#CCCCCC">something bad has happened</font>

614
00:27:15,920 --> 00:27:26,160
so looking further into the<font color="#E5E5E5"> log we found</font>

615
00:27:20,280 --> 00:27:28,440
that invoice<font color="#CCCCCC"> excess xlsm was executed</font><font color="#E5E5E5"> on</font>

616
00:27:26,160 --> 00:27:34,410
<font color="#CCCCCC">the system so</font><font color="#E5E5E5"> anybody want to guess what</font>

617
00:27:28,440 --> 00:27:40,920
<font color="#E5E5E5">happened next</font><font color="#CCCCCC"> the user clicked infect my</font>

618
00:27:34,410 --> 00:27:44,730
computer<font color="#E5E5E5"> whoo yeah now we really know</font>

619
00:27:40,920 --> 00:27:47,070
something<font color="#E5E5E5"> bad has been right so just so</font>

620
00:27:44,730 --> 00:27:50,780
if you didn't know<font color="#E5E5E5"> with with</font><font color="#CCCCCC"> juror</font><font color="#E5E5E5"> you</font>

621
00:27:47,070 --> 00:27:53,669
can<font color="#CCCCCC"> actually pull those files</font><font color="#E5E5E5"> back so</font>

622
00:27:50,780 --> 00:27:55,860
<font color="#E5E5E5">girl you have access</font><font color="#CCCCCC"> to the raw disk to</font>

623
00:27:53,670 --> 00:27:58,170
also memory<font color="#CCCCCC"> so if you wanted to</font><font color="#E5E5E5"> do</font>

624
00:27:55,860 --> 00:28:01,020
things with memory acquisition<font color="#E5E5E5"> or some</font>

625
00:27:58,170 --> 00:28:04,170
kind of file on disk<font color="#E5E5E5"> that was that is a</font>

626
00:28:01,020 --> 00:28:07,230
tool that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> use and also in the</font>

627
00:28:04,170 --> 00:28:09,240
<font color="#E5E5E5">case of this if you found this you most</font>

628
00:28:07,230 --> 00:28:11,460
<font color="#CCCCCC">likely want</font><font color="#E5E5E5"> to say okay who else may</font>

629
00:28:09,240 --> 00:28:13,650
have gotten<font color="#E5E5E5"> this file and then with</font><font color="#CCCCCC"> ger</font>

630
00:28:11,460 --> 00:28:14,940
you can then put in searches and look

631
00:28:13,650 --> 00:28:17,130
throughout your entire<font color="#CCCCCC"> environment to</font>

632
00:28:14,940 --> 00:28:19,200
see who else has this<font color="#E5E5E5"> file laid out on</font>

633
00:28:17,130 --> 00:28:21,390
their disk<font color="#E5E5E5"> yeah so it's the concept of</font>

634
00:28:19,200 --> 00:28:23,580
what they call a hunt<font color="#E5E5E5"> right so on the</font>

635
00:28:21,390 --> 00:28:26,460
single IP address I launched a hunt

636
00:28:23,580 --> 00:28:27,990
<font color="#E5E5E5">looking specifically for invoice xlsm</font>

637
00:28:26,460 --> 00:28:30,930
which happened to<font color="#E5E5E5"> be on the desktop of</font>

638
00:28:27,990 --> 00:28:32,760
<font color="#E5E5E5">the computer and as Troy said then</font>

639
00:28:30,930 --> 00:28:35,280
there's a concept of<font color="#E5E5E5"> a global hunt with</font>

640
00:28:32,760 --> 00:28:37,230
with ger where you can go<font color="#E5E5E5"> look globally</font>

641
00:28:35,280 --> 00:28:40,550
<font color="#E5E5E5">for</font><font color="#CCCCCC"> the indicator that you had in this</font>

642
00:28:37,230 --> 00:28:43,710
case<font color="#E5E5E5"> a file name and so the</font><font color="#CCCCCC"> next</font><font color="#E5E5E5"> step</font><font color="#CCCCCC"> is</font>

643
00:28:40,550 --> 00:28:45,360
what other systems<font color="#CCCCCC"> have</font><font color="#E5E5E5"> now talked to</font>

644
00:28:43,710 --> 00:28:47,040
the command control<font color="#E5E5E5"> server because we</font>

645
00:28:45,360 --> 00:28:49,439
know that<font color="#CCCCCC"> there's an infected machine</font>

646
00:28:47,040 --> 00:28:51,960
we know that the command and control

647
00:28:49,440 --> 00:28:57,110
server we know the IP address<font color="#CCCCCC"> of that</font>

648
00:28:51,960 --> 00:29:00,750
<font color="#E5E5E5">and so it turns out</font><font color="#CCCCCC"> surprisingly that</font>

649
00:28:57,110 --> 00:29:02,310
the attacker made it over<font color="#CCCCCC"> to the sequel</font>

650
00:29:00,750 --> 00:29:06,990
server where all<font color="#E5E5E5"> the company secrets</font>

651
00:29:02,310 --> 00:29:10,770
were score<font color="#CCCCCC"> capped they may know how they</font>

652
00:29:06,990 --> 00:29:12,210
got<font color="#E5E5E5"> there I guess the password lion knew</font>

653
00:29:10,770 --> 00:29:14,540
all the<font color="#CCCCCC"> passwords but yeah I guess the</font>

654
00:29:12,210 --> 00:29:14,540
<font color="#E5E5E5">password</font>

655
00:29:14,830 --> 00:29:22,939
so here is the<font color="#E5E5E5"> the actual lateral move</font>

656
00:29:19,340 --> 00:29:27,110
<font color="#E5E5E5">from the workstation to the sequel</font>

657
00:29:22,940 --> 00:29:28,610
server<font color="#CCCCCC"> there was a security</font><font color="#E5E5E5"> log on the</font>

658
00:29:27,110 --> 00:29:31,428
sequel server<font color="#E5E5E5"> itself a Windows Event</font>

659
00:29:28,610 --> 00:29:33,769
<font color="#CCCCCC">Security log that showed that there was</font>

660
00:29:31,429 --> 00:29:36,019
a successful login using the

661
00:29:33,769 --> 00:29:38,929
administrator account because apparently

662
00:29:36,019 --> 00:29:40,580
in this in this domain the domain

663
00:29:38,929 --> 00:29:44,480
<font color="#CCCCCC">administrator has a really crappy</font>

664
00:29:40,580 --> 00:29:47,600
password<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> also a corresponding</font>

665
00:29:44,480 --> 00:29:50,570
log entry for the actual<font color="#E5E5E5"> wall again in</font>

666
00:29:47,600 --> 00:29:52,010
syslog so if you've never used<font color="#E5E5E5"> system on</font>

667
00:29:50,570 --> 00:29:53,418
and<font color="#E5E5E5"> centralized logging at this point</font>

668
00:29:52,010 --> 00:29:57,830
you should be<font color="#E5E5E5"> realizing wow this</font><font color="#CCCCCC"> was</font>

669
00:29:53,419 --> 00:30:03,100
actually<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of powerful yeah this is</font>

670
00:29:57,830 --> 00:30:07,699
<font color="#E5E5E5">this is a one little log snippet from</font>

671
00:30:03,100 --> 00:30:09,559
from bro bros connection<font color="#E5E5E5"> logs</font><font color="#CCCCCC"> it kind of</font>

672
00:30:07,700 --> 00:30:12,230
got cut<font color="#E5E5E5"> off at</font><font color="#CCCCCC"> the end but the</font><font color="#E5E5E5"> four</font>

673
00:30:09,559 --> 00:30:15,799
<font color="#E5E5E5">point four seconds</font><font color="#CCCCCC"> I believe</font><font color="#E5E5E5"> that second</font>

674
00:30:12,230 --> 00:30:16,880
seconds was<font color="#E5E5E5"> the duration</font><font color="#CCCCCC"> size so one</font>

675
00:30:15,799 --> 00:30:21,379
thing we just<font color="#E5E5E5"> wanted to point out here</font>

676
00:30:16,880 --> 00:30:23,080
<font color="#CCCCCC">and I really like to use</font><font color="#E5E5E5"> bro as as the</font>

677
00:30:21,380 --> 00:30:26,419
tool which we're talking about<font color="#E5E5E5"> over</font>

678
00:30:23,080 --> 00:30:28,309
<font color="#E5E5E5">connections over SSL or TLS</font><font color="#CCCCCC"> lots of</font>

679
00:30:26,419 --> 00:30:29,600
times in<font color="#E5E5E5"> my experience people just throw</font>

680
00:30:28,309 --> 00:30:31,220
their hands up<font color="#E5E5E5"> like oh it's encrypted</font>

681
00:30:29,600 --> 00:30:33,709
<font color="#E5E5E5">there's nothing we can do we can't see</font>

682
00:30:31,220 --> 00:30:35,990
<font color="#CCCCCC">anything that</font><font color="#E5E5E5"> might be true as</font><font color="#CCCCCC"> far as</font>

683
00:30:33,710 --> 00:30:37,519
for content wise and confidentiality<font color="#E5E5E5"> but</font>

684
00:30:35,990 --> 00:30:39,889
there's a<font color="#E5E5E5"> lots of</font><font color="#CCCCCC"> things you</font><font color="#E5E5E5"> can do and</font>

685
00:30:37,519 --> 00:30:42,649
see<font color="#E5E5E5"> and detect even though the</font>

686
00:30:39,889 --> 00:30:44,418
connection is encrypted<font color="#E5E5E5"> as we saw</font>

687
00:30:42,649 --> 00:30:46,428
earlier<font color="#E5E5E5"> with bro we can see common name</font>

688
00:30:44,419 --> 00:30:48,620
fields or certificate values<font color="#E5E5E5"> bro also</font>

689
00:30:46,429 --> 00:30:50,899
<font color="#E5E5E5">sees the public come down when a</font>

690
00:30:48,620 --> 00:30:52,850
<font color="#E5E5E5">connection is made and it hashes the</font>

691
00:30:50,899 --> 00:30:54,219
certificate<font color="#E5E5E5"> there's things you can do</font>

692
00:30:52,850 --> 00:31:00,289
and<font color="#CCCCCC"> you could pivot</font><font color="#E5E5E5"> off of that as well</font>

693
00:30:54,220 --> 00:31:03,860
<font color="#CCCCCC">and then</font><font color="#E5E5E5"> finally if you're smart you're</font>

694
00:31:00,289 --> 00:31:06,379
<font color="#E5E5E5">not using anything less than TLS 1.0 but</font>

695
00:31:03,860 --> 00:31:10,340
if you're using TLS 1.0 and greater<font color="#E5E5E5"> per</font>

696
00:31:06,380 --> 00:31:13,279
RFC you have to be logging<font color="#E5E5E5"> the the</font>

697
00:31:10,340 --> 00:31:16,879
hostname value in that<font color="#E5E5E5"> certificate that</font>

698
00:31:13,279 --> 00:31:19,100
SSL<font color="#E5E5E5"> exchange so you may not</font><font color="#CCCCCC"> be able to</font>

699
00:31:16,880 --> 00:31:22,970
see the full URL<font color="#E5E5E5"> that's being accessed</font>

700
00:31:19,100 --> 00:31:25,279
<font color="#E5E5E5">by whomever but in the bro log you'll</font>

701
00:31:22,970 --> 00:31:26,070
also see the fully qualified<font color="#CCCCCC"> domain name</font>

702
00:31:25,279 --> 00:31:28,170
of<font color="#CCCCCC"> the server</font>

703
00:31:26,070 --> 00:31:29,939
that it's talking<font color="#E5E5E5"> to so there's a lot of</font>

704
00:31:28,170 --> 00:31:33,570
<font color="#E5E5E5">things that you can still</font><font color="#CCCCCC"> see and</font><font color="#E5E5E5"> here</font>

705
00:31:29,940 --> 00:31:35,310
we have right up<font color="#CCCCCC"> not the duration but</font>

706
00:31:33,570 --> 00:31:36,659
then you can also get<font color="#E5E5E5"> bytes so how many</font>

707
00:31:35,310 --> 00:31:42,450
byte counts so kind<font color="#E5E5E5"> of like thick</font>

708
00:31:36,660 --> 00:31:44,220
NetFlow data<font color="#E5E5E5"> if you will and so this</font>

709
00:31:42,450 --> 00:31:46,080
kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> brings us to the back to the</font><font color="#CCCCCC"> end</font>

710
00:31:44,220 --> 00:31:48,240
<font color="#E5E5E5">point</font><font color="#CCCCCC"> so we knew we were going through</font>

711
00:31:46,080 --> 00:31:51,929
this that PowerShell was obviously used

712
00:31:48,240 --> 00:31:54,120
in this attack<font color="#CCCCCC"> and when I went</font><font color="#E5E5E5"> to go to</font>

713
00:31:51,930 --> 00:31:57,360
the<font color="#E5E5E5"> logs</font><font color="#CCCCCC"> I was like scratching my head</font>

714
00:31:54,120 --> 00:31:59,070
<font color="#E5E5E5">because I actually was like</font><font color="#CCCCCC"> okay</font>

715
00:31:57,360 --> 00:32:01,500
<font color="#CCCCCC">PowerShell I want to see all the parent</font>

716
00:31:59,070 --> 00:32:03,540
processes of PowerShell<font color="#CCCCCC"> and I couldn't</font>

717
00:32:01,500 --> 00:32:05,700
find anything other than PowerShell<font color="#CCCCCC"> as</font>

718
00:32:03,540 --> 00:32:06,990
the<font color="#E5E5E5"> pair of process which yeah so for</font>

719
00:32:05,700 --> 00:32:09,710
you<font color="#CCCCCC"> guys on this side of the room that</font>

720
00:32:06,990 --> 00:32:13,760
can't see the<font color="#E5E5E5"> cash value that was logged</font>

721
00:32:09,710 --> 00:32:17,700
for the actual power shop of macro is

722
00:32:13,760 --> 00:32:20,580
some Chinese characters so that's

723
00:32:17,700 --> 00:32:23,130
probably not a valid hash yeah<font color="#CCCCCC"> and where</font>

724
00:32:20,580 --> 00:32:26,669
the hash is is where the parent<font color="#E5E5E5"> command</font>

725
00:32:23,130 --> 00:32:28,830
<font color="#CCCCCC">line is is where the half should be</font><font color="#E5E5E5"> so</font>

726
00:32:26,670 --> 00:32:30,720
what was going<font color="#CCCCCC"> on here I was like</font>

727
00:32:28,830 --> 00:32:32,939
scratching my head thinking<font color="#E5E5E5"> I never kind</font>

728
00:32:30,720 --> 00:32:34,350
of you know what was what's the<font color="#E5E5E5"> deal I</font>

729
00:32:32,940 --> 00:32:36,390
thought maybe something<font color="#E5E5E5"> was wrong with</font>

730
00:32:34,350 --> 00:32:37,649
<font color="#E5E5E5">the lab setup so then I you know it kept</font>

731
00:32:36,390 --> 00:32:39,480
running it in<font color="#E5E5E5"> the virtual machine</font><font color="#CCCCCC"> ik of</font>

732
00:32:37,650 --> 00:32:42,540
running the Excel spreadsheet<font color="#CCCCCC"> and my own</font>

733
00:32:39,480 --> 00:32:44,700
malware<font color="#E5E5E5"> set up a lab and I was seeing</font>

734
00:32:42,540 --> 00:32:46,409
<font color="#E5E5E5">the same thing on my MMC console that we</font>

735
00:32:44,700 --> 00:32:50,370
were seeing being poured over syslog<font color="#E5E5E5"> so</font>

736
00:32:46,410 --> 00:32:52,590
what it came<font color="#CCCCCC"> down to was PowerShell the</font>

737
00:32:50,370 --> 00:32:54,810
initial dropper coming out of the macro

738
00:32:52,590 --> 00:32:57,659
<font color="#E5E5E5">that</font><font color="#CCCCCC"> execute</font><font color="#E5E5E5"> the PowerShell command had</font>

739
00:32:54,810 --> 00:32:59,639
<font color="#E5E5E5">this a lot a lot of basics before enough</font>

740
00:32:57,660 --> 00:33:03,510
so<font color="#E5E5E5"> where it overflowed the field and</font>

741
00:32:59,640 --> 00:33:04,940
corrupted the<font color="#E5E5E5"> log file so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't know</font>

742
00:33:03,510 --> 00:33:07,710
<font color="#E5E5E5">has anybody else seen this</font>

743
00:33:04,940 --> 00:33:10,170
<font color="#CCCCCC">I</font><font color="#E5E5E5"> mean I'm sure this isn't the first</font>

744
00:33:07,710 --> 00:33:14,220
rodeo that that happened<font color="#E5E5E5"> but we're</font>

745
00:33:10,170 --> 00:33:15,960
<font color="#E5E5E5">running the latest</font><font color="#CCCCCC"> usman</font><font color="#E5E5E5"> just I</font><font color="#CCCCCC"> think</font>

746
00:33:14,220 --> 00:33:19,200
the moral<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> story is have more</font><font color="#E5E5E5"> than</font>

747
00:33:15,960 --> 00:33:20,520
one dance move<font color="#E5E5E5"> so I think we I was you</font>

748
00:33:19,200 --> 00:33:22,740
know<font color="#E5E5E5"> we were kind of</font><font color="#CCCCCC"> brainstorming</font><font color="#E5E5E5"> back</font>

749
00:33:20,520 --> 00:33:24,629
and forth about what are things like how

750
00:33:22,740 --> 00:33:27,120
is it possible as Microsoft going to<font color="#E5E5E5"> fix</font>

751
00:33:24,630 --> 00:33:29,340
this or<font color="#CCCCCC"> is</font><font color="#E5E5E5"> this is this really a bug but</font>

752
00:33:27,120 --> 00:33:31,709
needless to say<font color="#E5E5E5"> one really neat thing</font>

753
00:33:29,340 --> 00:33:35,010
you can do is actually<font color="#E5E5E5"> in</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> system on</font>

754
00:33:31,710 --> 00:33:37,080
logs<font color="#E5E5E5"> is pull out processes that don't</font>

755
00:33:35,010 --> 00:33:39,030
<font color="#E5E5E5">have any parent processes because that</font>

756
00:33:37,080 --> 00:33:40,679
<font color="#E5E5E5">spells fields got corrupted</font>

757
00:33:39,030 --> 00:33:42,420
so that's another technique<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do may be</font>

758
00:33:40,680 --> 00:33:44,550
<font color="#E5E5E5">to kind of find where those anomalies</font>

759
00:33:42,420 --> 00:33:45,960
<font color="#E5E5E5">are but if you actually saw that that if</font>

760
00:33:44,550 --> 00:33:47,460
we printed it<font color="#E5E5E5"> out I forget how many</font>

761
00:33:45,960 --> 00:33:49,020
<font color="#E5E5E5">characters that basics before ended up</font>

762
00:33:47,460 --> 00:33:51,870
being it was just really<font color="#CCCCCC"> really long um</font>

763
00:33:49,020 --> 00:33:54,629
I didn't<font color="#E5E5E5"> want to give up I was kind</font><font color="#CCCCCC"> of</font>

764
00:33:51,870 --> 00:33:57,959
determined<font color="#E5E5E5"> I wanted to see for</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that</font>

765
00:33:54,630 --> 00:33:59,550
<font color="#E5E5E5">Excel was the parent process</font><font color="#CCCCCC"> so I dumped</font>

766
00:33:57,960 --> 00:34:02,180
the memory of<font color="#E5E5E5"> the infected system and</font>

767
00:33:59,550 --> 00:34:05,810
then used volatility<font color="#E5E5E5"> and with volatility</font>

768
00:34:02,180 --> 00:34:08,929
<font color="#CCCCCC">the first thing I did was run PS list</font>

769
00:34:05,810 --> 00:34:11,580
<font color="#CCCCCC">plugin and</font><font color="#E5E5E5"> that get in then</font><font color="#CCCCCC"> encrypt on</font>

770
00:34:08,929 --> 00:34:15,270
<font color="#E5E5E5">PowerShell and I saw</font><font color="#CCCCCC"> okay PowerShell has</font>

771
00:34:11,580 --> 00:34:18,620
executed three times<font color="#E5E5E5"> go ahead and next</font>

772
00:34:15,270 --> 00:34:20,820
with a parent process<font color="#E5E5E5"> of 1680 so then</font>

773
00:34:18,620 --> 00:34:24,359
kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> going back to</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> PS list</font>

774
00:34:20,820 --> 00:34:28,770
output now let's pivot on 1680<font color="#E5E5E5"> and then</font>

775
00:34:24,360 --> 00:34:30,540
sure enough 1680<font color="#E5E5E5"> is the process ID of</font>

776
00:34:28,770 --> 00:34:32,610
<font color="#CCCCCC">Excel dot exe so at</font><font color="#E5E5E5"> least then I was</font>

777
00:34:30,540 --> 00:34:36,000
<font color="#CCCCCC">happy</font><font color="#E5E5E5"> I was able to</font><font color="#CCCCCC"> actually see that</font>

778
00:34:32,610 --> 00:34:37,560
<font color="#E5E5E5">and know that it was there</font><font color="#CCCCCC"> and you can</font>

779
00:34:36,000 --> 00:34:38,989
kind of see what<font color="#E5E5E5"> what happened here if</font>

780
00:34:37,560 --> 00:34:42,540
you kind of go<font color="#CCCCCC"> down the timeline</font><font color="#E5E5E5"> that</font>

781
00:34:38,989 --> 00:34:45,239
<font color="#E5E5E5">Excel launches</font><font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> PowerShell</font>

782
00:34:42,540 --> 00:34:47,070
<font color="#E5E5E5">actually launches PowerShell PowerShell</font>

783
00:34:45,239 --> 00:34:50,120
actually watches PowerShell again and it

784
00:34:47,070 --> 00:34:53,429
kind of goes<font color="#E5E5E5"> down this rabbit hole</font><font color="#CCCCCC"> is</font>

785
00:34:50,120 --> 00:35:02,130
that kind of<font color="#E5E5E5"> the expected</font><font color="#CCCCCC"> output of your</font>

786
00:34:53,429 --> 00:35:04,380
macro<font color="#E5E5E5"> when</font><font color="#CCCCCC"> you'd sure so up to this</font>

787
00:35:02,130 --> 00:35:06,990
point<font color="#E5E5E5"> we've talked a lot</font><font color="#CCCCCC"> about detection</font>

788
00:35:04,380 --> 00:35:10,260
<font color="#CCCCCC">and I do believe that prevention</font><font color="#E5E5E5"> does</font>

789
00:35:06,990 --> 00:35:12,419
have a place<font color="#CCCCCC"> but like I said I it's</font><font color="#E5E5E5"> my</font>

790
00:35:10,260 --> 00:35:16,260
experience<font color="#E5E5E5"> that</font><font color="#CCCCCC"> all prevention actually</font>

791
00:35:12,420 --> 00:35:17,700
fails at some point so um<font color="#CCCCCC"> for the guys</font>

792
00:35:16,260 --> 00:35:19,140
that are pen testers<font color="#E5E5E5"> in the audience you</font>

793
00:35:17,700 --> 00:35:20,790
already know the answers this question

794
00:35:19,140 --> 00:35:24,089
<font color="#E5E5E5">but does anybody want to guess how many</font>

795
00:35:20,790 --> 00:35:26,220
time and how many times antivirus

796
00:35:24,090 --> 00:35:31,830
firewall or<font color="#E5E5E5"> an IDs has stopped me</font>

797
00:35:26,220 --> 00:35:33,779
getting into<font color="#CCCCCC"> somewhere at</font><font color="#E5E5E5"> zero you know</font>

798
00:35:31,830 --> 00:35:35,610
you need these<font color="#E5E5E5"> things it's the advice</font>

799
00:35:33,780 --> 00:35:36,990
that<font color="#E5E5E5"> everybody's heard forever about</font>

800
00:35:35,610 --> 00:35:39,150
what you<font color="#E5E5E5"> should do to protect</font><font color="#CCCCCC"> your</font>

801
00:35:36,990 --> 00:35:41,669
network<font color="#E5E5E5"> but it's been my experience too</font>

802
00:35:39,150 --> 00:35:45,870
that<font color="#E5E5E5"> even beyond this you know products</font>

803
00:35:41,670 --> 00:35:48,600
<font color="#CCCCCC">they're build security products they</font>

804
00:35:45,870 --> 00:35:49,890
just aren't<font color="#E5E5E5"> that hard to get past and if</font>

805
00:35:48,600 --> 00:35:52,319
<font color="#E5E5E5">you've actually read the Black Hills</font>

806
00:35:49,890 --> 00:35:54,930
blog we<font color="#E5E5E5"> you know picked on</font>

807
00:35:52,320 --> 00:35:56,940
I<font color="#CCCCCC"> lands</font><font color="#E5E5E5"> here recently on things</font><font color="#CCCCCC"> that are</font>

808
00:35:54,930 --> 00:36:01,859
supposed<font color="#E5E5E5"> to be preventive aren't always</font>

809
00:35:56,940 --> 00:36:04,620
preventive but things that<font color="#E5E5E5"> do stop me as</font>

810
00:36:01,860 --> 00:36:08,250
a pen tester are generally configuration

811
00:36:04,620 --> 00:36:10,500
based so how<font color="#CCCCCC"> many</font><font color="#E5E5E5"> people have a 15</font><font color="#CCCCCC"> or</font>

812
00:36:08,250 --> 00:36:13,890
more character password policy for their

813
00:36:10,500 --> 00:36:16,920
users<font color="#CCCCCC"> in their environment I don't want</font>

814
00:36:13,890 --> 00:36:20,400
to come<font color="#E5E5E5"> pen test your environment</font><font color="#CCCCCC"> and</font>

815
00:36:16,920 --> 00:36:22,470
then for service accounts<font color="#E5E5E5"> 27 characters</font>

816
00:36:20,400 --> 00:36:24,900
or more<font color="#CCCCCC"> and the reason I recommend</font><font color="#E5E5E5"> this</font>

817
00:36:22,470 --> 00:36:27,990
is actually here<font color="#E5E5E5"> recently there was an</font>

818
00:36:24,900 --> 00:36:30,150
article<font color="#CCCCCC"> put out by abou bik's that you</font>

819
00:36:27,990 --> 00:36:32,640
just can't crack a password<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> 27</font>

820
00:36:30,150 --> 00:36:36,180
characters are longer<font color="#E5E5E5"> hash cat won't do</font>

821
00:36:32,640 --> 00:36:39,060
it<font color="#E5E5E5"> and then also on the perimeter</font>

822
00:36:36,180 --> 00:36:41,430
<font color="#E5E5E5">two-factor when I see a single factor</font>

823
00:36:39,060 --> 00:36:43,680
portal or a single factor login

824
00:36:41,430 --> 00:36:45,470
authentication portal especially one

825
00:36:43,680 --> 00:36:48,299
<font color="#CCCCCC">that I think is tied to Active Directory</font>

826
00:36:45,470 --> 00:36:51,899
<font color="#CCCCCC">most likely I'm going</font><font color="#E5E5E5"> to guess valid</font>

827
00:36:48,300 --> 00:36:53,310
domain accounts<font color="#E5E5E5"> and that sort of gets me</font>

828
00:36:51,900 --> 00:36:57,720
down the road of getting in from<font color="#E5E5E5"> the</font>

829
00:36:53,310 --> 00:37:00,000
outside<font color="#CCCCCC"> and much much quicker also</font><font color="#E5E5E5"> once</font>

830
00:36:57,720 --> 00:37:01,950
<font color="#E5E5E5">a footholds established how many people</font>

831
00:37:00,000 --> 00:37:06,570
use something some kind<font color="#E5E5E5"> of mechanism</font>

832
00:37:01,950 --> 00:37:08,339
<font color="#E5E5E5">that rent that that changes the local</font>

833
00:37:06,570 --> 00:37:10,110
administrator password on every single

834
00:37:08,340 --> 00:37:12,240
workstation<font color="#E5E5E5"> everything system in their</font>

835
00:37:10,110 --> 00:37:13,950
environment<font color="#E5E5E5"> so</font><font color="#CCCCCC"> if you didn't</font><font color="#E5E5E5"> know</font>

836
00:37:12,240 --> 00:37:16,830
there's a free product<font color="#CCCCCC"> from Microsoft</font>

837
00:37:13,950 --> 00:37:19,950
called<font color="#CCCCCC"> laps</font><font color="#E5E5E5"> local administrator password</font>

838
00:37:16,830 --> 00:37:22,500
system that<font color="#E5E5E5"> that will do that</font><font color="#CCCCCC"> for you</font>

839
00:37:19,950 --> 00:37:24,990
the idea being that if me as an attacker

840
00:37:22,500 --> 00:37:27,660
gets<font color="#E5E5E5"> onto</font><font color="#CCCCCC"> your system</font><font color="#E5E5E5"> and gets the</font>

841
00:37:24,990 --> 00:37:30,149
administrator hash well that gets me

842
00:37:27,660 --> 00:37:34,609
further down the road of of being able

843
00:37:30,150 --> 00:37:37,080
to escalate my privileges<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> also</font>

844
00:37:34,610 --> 00:37:38,580
environmental configuration environments

845
00:37:37,080 --> 00:37:40,770
that<font color="#E5E5E5"> I've been in that follow the</font>

846
00:37:38,580 --> 00:37:43,650
Microsoft<font color="#E5E5E5"> three-tier approach where</font>

847
00:37:40,770 --> 00:37:46,770
basically all workstations are managed

848
00:37:43,650 --> 00:37:48,930
at a tier 2 level with accounts that

849
00:37:46,770 --> 00:37:51,540
<font color="#CCCCCC">only</font><font color="#E5E5E5"> manage workstations and then</font>

850
00:37:48,930 --> 00:37:53,490
servers like file servers and sequel

851
00:37:51,540 --> 00:37:55,080
servers things of that nature<font color="#CCCCCC"> are</font>

852
00:37:53,490 --> 00:37:57,180
managed<font color="#CCCCCC"> with a completely different</font><font color="#E5E5E5"> set</font>

853
00:37:55,080 --> 00:38:00,120
of credentials<font color="#E5E5E5"> from probably a jump</font>

854
00:37:57,180 --> 00:38:01,740
station and those server credentials can

855
00:38:00,120 --> 00:38:04,200
<font color="#E5E5E5">never be used on a workstation anywhere</font>

856
00:38:01,740 --> 00:38:05,700
for management<font color="#E5E5E5"> purposes and then domain</font>

857
00:38:04,200 --> 00:38:08,759
controllers

858
00:38:05,700 --> 00:38:11,930
domain administrator accounts are only

859
00:38:08,760 --> 00:38:15,089
used in<font color="#E5E5E5"> the case of logging into a</font>

860
00:38:11,930 --> 00:38:17,399
controller<font color="#CCCCCC"> what that does is if I'm</font>

861
00:38:15,089 --> 00:38:19,290
<font color="#E5E5E5">moving laterally in your environment as</font>

862
00:38:17,400 --> 00:38:20,910
an attacker<font color="#E5E5E5"> that</font><font color="#CCCCCC"> makes it really</font>

863
00:38:19,290 --> 00:38:23,430
<font color="#E5E5E5">difficult for me to get a domain</font>

864
00:38:20,910 --> 00:38:26,730
<font color="#E5E5E5">administrator credential so these are</font>

865
00:38:23,430 --> 00:38:28,649
the kinds of<font color="#E5E5E5"> things that</font><font color="#CCCCCC"> that when I see</font>

866
00:38:26,730 --> 00:38:31,190
them<font color="#CCCCCC"> it makes</font><font color="#E5E5E5"> my life a</font><font color="#CCCCCC"> lot more</font>

867
00:38:28,650 --> 00:38:34,020
difficult as an attacker<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> also</font>

868
00:38:31,190 --> 00:38:36,059
finally restricting<font color="#CCCCCC"> client-to-client</font>

869
00:38:34,020 --> 00:38:38,730
communication environment<font color="#CCCCCC"> that I've been</font>

870
00:38:36,059 --> 00:38:40,349
in where clients can't communicate with

871
00:38:38,730 --> 00:38:42,750
<font color="#E5E5E5">each other just flat-out not able to</font>

872
00:38:40,349 --> 00:38:50,280
<font color="#CCCCCC">communicate with each</font><font color="#E5E5E5"> other</font><font color="#CCCCCC"> it makes</font><font color="#E5E5E5"> me</font>

873
00:38:42,750 --> 00:38:53,339
cry<font color="#E5E5E5"> so there are actually some features</font>

874
00:38:50,280 --> 00:38:56,700
that<font color="#CCCCCC"> I didn't have time to get into</font><font color="#E5E5E5"> in</font>

875
00:38:53,339 --> 00:38:59,069
this talk<font color="#CCCCCC"> Windows 10 has some pretty</font>

876
00:38:56,700 --> 00:39:01,500
interesting<font color="#CCCCCC"> security features in</font><font color="#E5E5E5"> the</font>

877
00:38:59,069 --> 00:39:03,720
Enterprise Edition<font color="#CCCCCC"> one of</font><font color="#E5E5E5"> those is</font>

878
00:39:01,500 --> 00:39:08,520
device guard<font color="#E5E5E5"> so what that does</font><font color="#CCCCCC"> is it</font>

879
00:39:03,720 --> 00:39:11,700
attempts to not let untrusted code<font color="#CCCCCC"> run</font>

880
00:39:08,520 --> 00:39:13,440
in your<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> and so it's only</font>

881
00:39:11,700 --> 00:39:15,750
good<font color="#CCCCCC"> Koken right so it's a whitelisting</font>

882
00:39:13,440 --> 00:39:18,089
type solution and a<font color="#E5E5E5"> partner for</font><font color="#CCCCCC"> that</font>

883
00:39:15,750 --> 00:39:20,819
it's credential guard<font color="#E5E5E5"> and so what that</font>

884
00:39:18,089 --> 00:39:23,520
<font color="#CCCCCC">does is it takes sensitive secrets like</font>

885
00:39:20,819 --> 00:39:27,660
<font color="#E5E5E5">password it only lets</font><font color="#CCCCCC"> system like the</font>

886
00:39:23,520 --> 00:39:30,119
approved<font color="#E5E5E5"> system components talk to those</font>

887
00:39:27,660 --> 00:39:31,710
<font color="#E5E5E5">credentials so it kind of separates that</font>

888
00:39:30,119 --> 00:39:34,890
out from the<font color="#E5E5E5"> rest of the operating</font>

889
00:39:31,710 --> 00:39:36,809
system however if anybody's ever tried

890
00:39:34,890 --> 00:39:41,069
to pull a white listing and solutions

891
00:39:36,809 --> 00:39:44,010
like this yeah that's a different can<font color="#CCCCCC"> of</font>

892
00:39:41,069 --> 00:39:45,808
worms<font color="#CCCCCC"> I do think these things work but</font>

893
00:39:44,010 --> 00:39:50,130
<font color="#E5E5E5">they're definitely a lot of</font><font color="#CCCCCC"> caveats</font><font color="#E5E5E5"> and</font>

894
00:39:45,809 --> 00:39:51,569
there are you know some planning<font color="#E5E5E5"> and</font>

895
00:39:50,130 --> 00:39:54,780
deployment issues that go along<font color="#CCCCCC"> with</font>

896
00:39:51,569 --> 00:40:00,420
<font color="#E5E5E5">that certainly get outside of the scope</font>

897
00:39:54,780 --> 00:40:02,910
of this<font color="#E5E5E5"> talk so</font><font color="#CCCCCC"> keep out</font><font color="#E5E5E5"> today and I'm</font>

898
00:40:00,420 --> 00:40:06,480
going<font color="#E5E5E5"> to post the slides on SlideShare</font>

899
00:40:02,910 --> 00:40:09,629
or<font color="#E5E5E5"> going to give them to a to Jake and</font>

900
00:40:06,480 --> 00:40:12,359
so right if you if you can't find<font color="#CCCCCC"> them</font>

901
00:40:09,630 --> 00:40:14,010
<font color="#E5E5E5">just drop me a note let me know and like</font>

902
00:40:12,359 --> 00:40:15,930
I said<font color="#CCCCCC"> we're going</font><font color="#E5E5E5"> to be doing a</font><font color="#CCCCCC"> webcast</font>

903
00:40:14,010 --> 00:40:17,200
where I'm going to kind of walk<font color="#CCCCCC"> through</font>

904
00:40:15,930 --> 00:40:20,020
this stuff kind<font color="#CCCCCC"> of live</font>

905
00:40:17,200 --> 00:40:23,410
<font color="#E5E5E5">then with</font><font color="#CCCCCC"> no slides and and asked</font>

906
00:40:20,020 --> 00:40:27,400
questions then if you're there so in

907
00:40:23,410 --> 00:40:30,660
conclusion I think free and<font color="#CCCCCC"> open-source</font>

908
00:40:27,400 --> 00:40:32,980
<font color="#E5E5E5">tools really can be a powerful force</font><font color="#CCCCCC"> for</font>

909
00:40:30,660 --> 00:40:35,170
<font color="#CCCCCC">logging</font><font color="#E5E5E5"> and monitoring in your</font>

910
00:40:32,980 --> 00:40:36,700
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> and if you're</font><font color="#CCCCCC"> not doing</font><font color="#E5E5E5"> if</font>

911
00:40:35,170 --> 00:40:40,240
you<font color="#E5E5E5"> don't have a solution now this is a</font>

912
00:40:36,700 --> 00:40:41,859
<font color="#E5E5E5">great place</font><font color="#CCCCCC"> to start</font><font color="#E5E5E5"> so and especially</font>

913
00:40:40,240 --> 00:40:43,180
<font color="#E5E5E5">if you're not logging on your edge if</font>

914
00:40:41,860 --> 00:40:47,580
you're not consolidating<font color="#CCCCCC"> your windows</font>

915
00:40:43,180 --> 00:40:50,799
logs<font color="#CCCCCC"> you can use free things to</font><font color="#E5E5E5"> do it</font>

916
00:40:47,580 --> 00:40:52,779
yeah I would<font color="#CCCCCC"> just add to that</font><font color="#E5E5E5"> have more</font>

917
00:40:50,800 --> 00:40:56,020
<font color="#CCCCCC">than one dance move things are going to</font>

918
00:40:52,780 --> 00:40:57,610
fail<font color="#E5E5E5"> tools are going to fail</font><font color="#CCCCCC"> and just</font>

919
00:40:56,020 --> 00:41:01,750
have backups and try to figure<font color="#E5E5E5"> out</font>

920
00:40:57,610 --> 00:41:04,330
<font color="#CCCCCC">exactly how else or you know just</font><font color="#E5E5E5"> to the</font>

921
00:41:01,750 --> 00:41:06,070
<font color="#E5E5E5">point of the system</font><font color="#CCCCCC"> on corruption log</font>

922
00:41:04,330 --> 00:41:08,049
thing like how else can I get<font color="#E5E5E5"> this data</font>

923
00:41:06,070 --> 00:41:09,880
and then kind of go<font color="#CCCCCC"> through those</font>

924
00:41:08,050 --> 00:41:12,370
<font color="#E5E5E5">scenarios you want to run into those</font>

925
00:41:09,880 --> 00:41:13,420
<font color="#E5E5E5">those roadblocks those issues that where</font>

926
00:41:12,370 --> 00:41:15,640
you're banging your<font color="#CCCCCC"> head</font><font color="#E5E5E5"> up against the</font>

927
00:41:13,420 --> 00:41:17,610
<font color="#E5E5E5">wall</font><font color="#CCCCCC"> especially when you're doing some</font>

928
00:41:15,640 --> 00:41:19,930
<font color="#CCCCCC">type of synthesis</font><font color="#E5E5E5"> of attack</font><font color="#CCCCCC"> or</font>

929
00:41:17,610 --> 00:41:21,910
simulation<font color="#E5E5E5"> because it just gives</font><font color="#CCCCCC"> you</font>

930
00:41:19,930 --> 00:41:24,040
<font color="#CCCCCC">that more arsenal on your tool belt for</font>

931
00:41:21,910 --> 00:41:25,810
when something<font color="#E5E5E5"> does fail you're not just</font>

932
00:41:24,040 --> 00:41:27,400
sitting<font color="#CCCCCC"> there</font><font color="#E5E5E5"> pounding</font><font color="#CCCCCC"> your head against</font>

933
00:41:25,810 --> 00:41:29,920
<font color="#E5E5E5">the</font><font color="#CCCCCC"> wall I think I can't do anything</font>

934
00:41:27,400 --> 00:41:34,060
<font color="#E5E5E5">else</font><font color="#CCCCCC"> after</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> I think we've all been</font>

935
00:41:29,920 --> 00:41:36,550
<font color="#E5E5E5">there so does anyone have</font><font color="#CCCCCC"> questions I</font>

936
00:41:34,060 --> 00:41:38,730
think we have<font color="#CCCCCC"> probably seven minutes or</font>

937
00:41:36,550 --> 00:41:38,730
<font color="#E5E5E5">so</font>

938
00:41:45,920 --> 00:41:54,239
yeah so I<font color="#E5E5E5"> use the</font><font color="#CCCCCC"> NX log and actually on</font>

939
00:41:50,130 --> 00:42:00,329
<font color="#CCCCCC">NX log blog so that's NX l OG I think</font>

940
00:41:54,239 --> 00:42:02,999
CEO<font color="#E5E5E5"> yeah they have a blog entry that it</font>

941
00:42:00,329 --> 00:42:04,859
gives you<font color="#E5E5E5"> the</font><font color="#CCCCCC"> configuration</font><font color="#E5E5E5"> and so I can</font>

942
00:42:02,999 --> 00:42:07,049
also send it to you if you want so it's

943
00:42:04,859 --> 00:42:08,489
just basically<font color="#CCCCCC"> a text</font><font color="#E5E5E5"> file and then I</font>

944
00:42:07,049 --> 00:42:10,410
deployed it in<font color="#E5E5E5"> the environment using</font><font color="#CCCCCC"> a</font>

945
00:42:08,489 --> 00:42:12,960
GPO<font color="#CCCCCC"> and basically that was just a batch</font>

946
00:42:10,410 --> 00:42:14,279
file where<font color="#CCCCCC"> anytime</font><font color="#E5E5E5"> a machine started it</font>

947
00:42:12,960 --> 00:42:16,170
would check to<font color="#E5E5E5"> see if it was installed</font>

948
00:42:14,279 --> 00:42:18,420
the service was running if it wasn't

949
00:42:16,170 --> 00:42:20,999
would<font color="#CCCCCC"> started and puts the configuration</font>

950
00:42:18,420 --> 00:42:23,430
file in place and I<font color="#E5E5E5"> think when</font><font color="#CCCCCC"> we did it</font>

951
00:42:20,999 --> 00:42:26,339
in lab it was JSON JSON alpha<font color="#E5E5E5"> yeah they</font>

952
00:42:23,430 --> 00:42:29,730
have CSV and<font color="#CCCCCC"> I think there's</font><font color="#E5E5E5"> one or two</font>

953
00:42:26,339 --> 00:42:31,619
<font color="#E5E5E5">other I mistakenly</font><font color="#CCCCCC"> thought hey it's</font>

954
00:42:29,730 --> 00:42:36,180
<font color="#CCCCCC">Jason's they'll be simple with ours</font>

955
00:42:31,619 --> 00:42:38,190
right<font color="#CCCCCC"> yeah no</font><font color="#E5E5E5"> so we we want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have a</font>

956
00:42:36,180 --> 00:42:42,239
tool<font color="#E5E5E5"> or we wanted to have a tool written</font>

957
00:42:38,190 --> 00:42:44,640
to basically search through<font color="#CCCCCC"> the JSON so</font>

958
00:42:42,239 --> 00:42:46,109
that's<font color="#E5E5E5"> coming I think we just had issues</font>

959
00:42:44,640 --> 00:42:47,730
with<font color="#E5E5E5"> it</font><font color="#CCCCCC"> and did want to say hey we have</font>

960
00:42:46,109 --> 00:42:51,710
a tool that's<font color="#E5E5E5"> half working you want</font><font color="#CCCCCC"> it</font>

961
00:42:47,730 --> 00:42:51,710
so no one<font color="#CCCCCC"> wants that</font>

962
00:42:59,299 --> 00:43:03,509
yeah absolutely<font color="#CCCCCC"> so we didn't touch on</font>

963
00:43:02,190 --> 00:43:06,450
that<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> question</font><font color="#E5E5E5"> was is</font><font color="#CCCCCC"> heya</font>

964
00:43:03,509 --> 00:43:10,859
<font color="#E5E5E5">deployed this</font><font color="#CCCCCC"> Mon and holy crap look at</font>

965
00:43:06,450 --> 00:43:13,680
<font color="#CCCCCC">all the logs</font><font color="#E5E5E5"> so I don't know how many of</font>

966
00:43:10,859 --> 00:43:18,538
you<font color="#E5E5E5"> guys follow Swift on security on</font>

967
00:43:13,680 --> 00:43:20,910
<font color="#E5E5E5">Twitter</font><font color="#CCCCCC"> so whoever that is they have a</font>

968
00:43:18,539 --> 00:43:24,660
configuration<font color="#E5E5E5"> file</font><font color="#CCCCCC"> I have the link</font><font color="#E5E5E5"> in</font>

969
00:43:20,910 --> 00:43:25,589
the resources slide<font color="#E5E5E5"> where it's a good</font>

970
00:43:24,660 --> 00:43:27,058
<font color="#E5E5E5">place to start</font>

971
00:43:25,589 --> 00:43:30,630
so they've they have a<font color="#E5E5E5"> configuration</font>

972
00:43:27,059 --> 00:43:33,779
file that<font color="#E5E5E5"> you can start as a place to I</font>

973
00:43:30,630 --> 00:43:35,749
can configure it<font color="#E5E5E5"> that sort of whitelist</font>

974
00:43:33,779 --> 00:43:37,619
out a whole bunch<font color="#CCCCCC"> of noise and I</font>

975
00:43:35,749 --> 00:43:39,509
actually<font color="#E5E5E5"> when I was showing this a</font>

976
00:43:37,619 --> 00:43:41,009
couple folks folks at Black Hills<font color="#E5E5E5"> that</font>

977
00:43:39,509 --> 00:43:42,869
was the<font color="#E5E5E5"> comment they made and like holy</font>

978
00:43:41,009 --> 00:43:46,170
crap<font color="#E5E5E5"> why isn't it annoys I expected this</font>

979
00:43:42,869 --> 00:43:48,180
to<font color="#CCCCCC"> be like ridiculously like crazy well</font>

980
00:43:46,170 --> 00:43:50,190
because I used that configuration<font color="#E5E5E5"> file</font>

981
00:43:48,180 --> 00:43:52,919
and<font color="#CCCCCC"> the other option is you</font><font color="#E5E5E5"> could</font><font color="#CCCCCC"> write</font>

982
00:43:50,190 --> 00:43:54,720
<font color="#CCCCCC">your own</font><font color="#E5E5E5"> but I would find one like</font><font color="#CCCCCC"> that</font>

983
00:43:52,920 --> 00:43:57,119
one and<font color="#CCCCCC"> just them whitelist the stuff</font>

984
00:43:54,720 --> 00:43:59,368
out that<font color="#E5E5E5"> you need so in my case I was</font>

985
00:43:57,119 --> 00:44:01,769
having trouble<font color="#CCCCCC"> with it not</font><font color="#E5E5E5"> liking</font><font color="#CCCCCC"> ger</font>

986
00:43:59,369 --> 00:44:04,170
and it was filling<font color="#E5E5E5"> up</font><font color="#CCCCCC"> with Goethe Exe</font>

987
00:44:01,769 --> 00:44:09,140
<font color="#CCCCCC">and so it was pretty</font><font color="#E5E5E5"> easy just to follow</font>

988
00:44:04,170 --> 00:44:09,140
what they did and and white list out<font color="#CCCCCC"> ger</font>

989
00:44:12,589 --> 00:44:17,119
<font color="#E5E5E5">okay well thanks everyone</font>

990
00:44:20,710 --> 00:44:22,770
you

