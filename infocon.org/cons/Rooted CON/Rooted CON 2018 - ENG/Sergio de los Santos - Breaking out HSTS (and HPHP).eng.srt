1
00:00:00,120 --> 00:00:07,740
the next speaker is here Sergio de los

2
00:00:05,879 --> 00:00:12,629
Santos is one of our biggest

3
00:00:07,740 --> 00:00:16,070
heavyweights been trying to convince him

4
00:00:12,630 --> 00:00:19,920
to be here in previous editions and

5
00:00:16,070 --> 00:00:24,630
finally he's here I keep having

6
00:00:19,920 --> 00:00:25,800
discussions with him so thank you so

7
00:00:24,630 --> 00:00:31,320
much thank you if you could introduce

8
00:00:25,800 --> 00:00:35,730
yourself you can hear me yes well my

9
00:00:31,320 --> 00:00:38,550
name is the kilo Santos and by the way

10
00:00:35,730 --> 00:00:42,180
there are some rumors circulating I can

11
00:00:38,550 --> 00:00:45,110
leave Malaga my home city I'm here okay

12
00:00:42,180 --> 00:00:49,230
this is not a hologram of myself it's me

13
00:00:45,110 --> 00:00:53,730
I'm not particularly thrilled but but

14
00:00:49,230 --> 00:00:56,788
I'm here well this is a presentation

15
00:00:53,730 --> 00:01:01,078
similar to something you could see back

16
00:00:56,789 --> 00:01:06,090
in December of last year it was a really

17
00:01:01,079 --> 00:01:08,369
nice experience we've been investigating

18
00:01:06,090 --> 00:01:12,960
along these lines for quite some time I

19
00:01:08,369 --> 00:01:16,350
started doing this myself in 2015 when

20
00:01:12,960 --> 00:01:17,820
this was more or less than you so it's

21
00:01:16,350 --> 00:01:21,119
been quite an interesting journey so far

22
00:01:17,820 --> 00:01:25,729
I want to leave it behind

23
00:01:21,119 --> 00:01:25,729
but it's a really nice lesson learned

24
00:01:26,420 --> 00:01:30,250
I think it's quite cool actually

25
00:01:31,000 --> 00:01:35,610
there's nothing absolutely spectacular

26
00:01:32,830 --> 00:01:40,980
but it's interesting food for thought

27
00:01:35,610 --> 00:01:44,310
and talking about innovation and

28
00:01:40,980 --> 00:01:44,310
laboratory stuff

29
00:01:45,490 --> 00:01:51,490
at the cybersecurity unit for telephony

30
00:01:47,890 --> 00:01:53,350
go digital we do our best to produce

31
00:01:51,490 --> 00:01:54,990
positive impact on the products and

32
00:01:53,350 --> 00:01:57,309
services that they sell

33
00:01:54,990 --> 00:01:58,320
once we improve existing products or

34
00:01:57,310 --> 00:02:02,530
services

35
00:01:58,320 --> 00:02:06,190
so how does TLS work this is a very

36
00:02:02,530 --> 00:02:10,259
light explanation a law school these are

37
00:02:06,190 --> 00:02:14,980
not my slides anyway if you're using

38
00:02:10,259 --> 00:02:17,200
clear text and there is a man in the

39
00:02:14,980 --> 00:02:19,179
middle that man in the middle cannot

40
00:02:17,200 --> 00:02:21,880
could access the passwords or send any

41
00:02:19,180 --> 00:02:24,459
sensitive information but is moving

42
00:02:21,880 --> 00:02:27,760
throughout an Edward Alexis Ala until

43
00:02:24,459 --> 00:02:30,750
Isis is bo- so TLS is all about

44
00:02:27,760 --> 00:02:35,070
possession in theory

45
00:02:30,750 --> 00:02:38,860
who says shall be the previous speaker

46
00:02:35,070 --> 00:02:41,410
has told us about the vulnerabilities

47
00:02:38,860 --> 00:02:45,670
that may exist in different protocols

48
00:02:41,410 --> 00:02:49,269
including TLS so to keep things as

49
00:02:45,670 --> 00:02:53,470
simple against TLS in general I think

50
00:02:49,269 --> 00:02:57,100
there are two main common attacks these

51
00:02:53,470 --> 00:02:59,220
are the two most frequent attacks SSL

52
00:02:57,100 --> 00:02:59,220
strip

53
00:02:59,730 --> 00:03:04,579
which is explaining the fact that most

54
00:03:01,739 --> 00:03:06,920
pages are not using HTTPS for

55
00:03:04,580 --> 00:03:09,360
man-in-the-middle attacks and then rogue

56
00:03:06,920 --> 00:03:11,809
certificates which I'm sure you know

57
00:03:09,360 --> 00:03:11,810
about

58
00:03:15,450 --> 00:03:22,440
grow certificates issued by a fake CA

59
00:03:19,980 --> 00:03:25,319
Authority embedded in your browser

60
00:03:22,440 --> 00:03:27,750
embedded in your journal Network issued

61
00:03:25,319 --> 00:03:30,119
by mistake whatever these reg

62
00:03:27,750 --> 00:03:32,610
certificate may be able to intercept

63
00:03:30,120 --> 00:03:37,370
communications on top of now we have the

64
00:03:32,610 --> 00:03:39,600
lack of trust in TLS so not so long ago

65
00:03:37,370 --> 00:03:44,190
it was 2013

66
00:03:39,600 --> 00:03:46,260
something about 2014 a couple of

67
00:03:44,190 --> 00:03:48,660
mechanisms of security mechanisms were

68
00:03:46,260 --> 00:03:56,299
implemented back then to add another

69
00:03:48,660 --> 00:04:00,769
layer on top of TLS nuts HSTs and HP KP

70
00:03:56,300 --> 00:04:00,769
how does HSTs work

71
00:04:03,590 --> 00:04:12,349
as you see on that big screen when you

72
00:04:09,140 --> 00:04:15,170
access a site you go to Netflix for

73
00:04:12,349 --> 00:04:20,120
example using HDTV there is a location

74
00:04:15,170 --> 00:04:24,050
to HTTPS and when you are in HTTPS you

75
00:04:20,120 --> 00:04:29,110
get a header with that name plus the

76
00:04:24,050 --> 00:04:34,090
expiry time and your browser obviously

77
00:04:29,110 --> 00:04:35,660
will go up to the SSL path through a 302

78
00:04:34,090 --> 00:04:38,690
from then on

79
00:04:35,660 --> 00:04:43,340
since the browser has the header he will

80
00:04:38,690 --> 00:04:46,280
remember that it always has to go you to

81
00:04:43,340 --> 00:04:48,950
it using TLS to that website using TLS

82
00:04:46,280 --> 00:04:50,388
now it does have before word addressing

83
00:04:48,950 --> 00:04:53,810
which is a three and seven an internal

84
00:04:50,389 --> 00:04:56,350
three or seven the SSL strip has nothing

85
00:04:53,810 --> 00:04:59,630
to do can do nothing because there is no

86
00:04:56,350 --> 00:05:01,220
open connection there is an encoded

87
00:04:59,630 --> 00:05:05,780
connection and encrypted connection

88
00:05:01,220 --> 00:05:11,620
using an internal 3:07 because what the

89
00:05:05,780 --> 00:05:14,780
browser does is look into its own memory

90
00:05:11,620 --> 00:05:16,729
you may try to force the browser to use

91
00:05:14,780 --> 00:05:20,419
the 302 but it doesn't use it it will

92
00:05:16,729 --> 00:05:23,830
use the 307 what happens with the other

93
00:05:20,419 --> 00:05:23,830
one the H pkp

94
00:05:28,819 --> 00:05:37,610
Chrome has been working with this to get

95
00:05:32,509 --> 00:05:39,439
rid of it actually what does it do we're

96
00:05:37,610 --> 00:05:44,029
talking about Braille certificates and

97
00:05:39,439 --> 00:05:47,169
HSTs attacking in different places I'm

98
00:05:44,029 --> 00:05:47,169
not sure I'm moving too much

99
00:05:53,380 --> 00:05:57,820
I was saying that rogue certificates was

100
00:05:55,870 --> 00:06:01,000
one of the most common attacks

101
00:05:57,820 --> 00:06:06,010
you must remember the certificate you

102
00:06:01,000 --> 00:06:08,320
use to go into the website yes it's

103
00:06:06,010 --> 00:06:11,830
really funny when people say oh there is

104
00:06:08,320 --> 00:06:14,020
a lock there there is a lock icon but no

105
00:06:11,830 --> 00:06:16,659
one remembers because it hasn't make any

106
00:06:14,020 --> 00:06:19,180
sense to make an effort to remember who

107
00:06:16,660 --> 00:06:20,770
issued a certificate if if someone

108
00:06:19,180 --> 00:06:23,080
changes the certificate for your bank

109
00:06:20,770 --> 00:06:25,900
and your browser you will notice a thing

110
00:06:23,080 --> 00:06:28,990
I mean no one notices that no one

111
00:06:25,900 --> 00:06:32,500
remembers that everything seems to be

112
00:06:28,990 --> 00:06:34,330
okay that I know alerts so if a rogue

113
00:06:32,500 --> 00:06:38,020
certificate is there you will not notice

114
00:06:34,330 --> 00:06:41,820
a thing what this does is to force the

115
00:06:38,020 --> 00:06:44,200
browser to remember the certificates

116
00:06:41,820 --> 00:06:48,180
what the administrator does is when

117
00:06:44,200 --> 00:06:48,180
swells weren't serving the certificate

118
00:06:48,510 --> 00:06:53,820
it will issue a string through the

119
00:06:51,520 --> 00:06:53,820
header

120
00:06:54,660 --> 00:07:00,810
okay been through RFC tells you then you

121
00:06:57,780 --> 00:07:02,609
need at least two pills pills are a

122
00:07:00,810 --> 00:07:07,740
representation of the certificate in

123
00:07:02,610 --> 00:07:10,320
fact the spki field not all extensions

124
00:07:07,740 --> 00:07:13,230
of course you may change the date you

125
00:07:10,320 --> 00:07:17,010
may change other little things so it

126
00:07:13,230 --> 00:07:23,190
would get too complicated what this does

127
00:07:17,010 --> 00:07:28,440
where 509 is to sign the CPK I it signs

128
00:07:23,190 --> 00:07:34,440
that it hashes it and it calculates the

129
00:07:28,440 --> 00:07:38,550
MD 64 so now the administrator is given

130
00:07:34,440 --> 00:07:44,900
the option to choose one out of these

131
00:07:38,550 --> 00:07:47,730
three certificates and from then on

132
00:07:44,900 --> 00:07:49,620
choose any certificate one of them must

133
00:07:47,730 --> 00:07:52,380
not be Industry one of them must be for

134
00:07:49,620 --> 00:07:55,620
back up when I say back up it means that

135
00:07:52,380 --> 00:08:00,420
if you shoot yourself of the food you

136
00:07:55,620 --> 00:08:02,880
can change quickly so it serves you one

137
00:08:00,420 --> 00:08:05,390
of those certificates those errors are

138
00:08:02,880 --> 00:08:05,390
wrong actually

139
00:08:07,560 --> 00:08:12,660
one of them is given to you maybe one

140
00:08:10,380 --> 00:08:15,080
any one of those out of those three and

141
00:08:12,660 --> 00:08:17,370
the other one which is a fake one the

142
00:08:15,080 --> 00:08:20,340
browser will remember this and will say

143
00:08:17,370 --> 00:08:23,190
okay you told me to remember this one

144
00:08:20,340 --> 00:08:28,859
this one and that one as soon as the one

145
00:08:23,190 --> 00:08:30,480
that I'm remembering changes and doesn't

146
00:08:28,860 --> 00:08:32,219
belong to this group but I will show you

147
00:08:30,480 --> 00:08:36,570
an alert telling you something has

148
00:08:32,219 --> 00:08:39,150
changed now the administrator has to be

149
00:08:36,570 --> 00:08:41,250
smart if you pick this one which is

150
00:08:39,150 --> 00:08:42,959
changing very often you will have to

151
00:08:41,250 --> 00:08:45,510
remember to change the one you use for

152
00:08:42,960 --> 00:08:47,340
backup and the one you're pinning if you

153
00:08:45,510 --> 00:08:51,000
change this which is not changing that

154
00:08:47,340 --> 00:08:52,440
fast that's more suitable but then do

155
00:08:51,000 --> 00:08:54,570
you have an additional security problem

156
00:08:52,440 --> 00:08:56,760
if there is a man-in-the-middle attack

157
00:08:54,570 --> 00:09:00,480
or this certificate is changed they

158
00:08:56,760 --> 00:09:04,500
might issue one for the same CA by

159
00:09:00,480 --> 00:09:06,360
mistake in fact I saw someone issuing a

160
00:09:04,500 --> 00:09:08,250
fake certificate a real certificate so

161
00:09:06,360 --> 00:09:12,780
here you're less protected and it more

162
00:09:08,250 --> 00:09:14,610
cumbersome you're not protected by is

163
00:09:12,780 --> 00:09:20,730
very cumbersome or you're less protected

164
00:09:14,610 --> 00:09:22,620
but it's simpler this is somehow

165
00:09:20,730 --> 00:09:26,180
determining the overlap between what you

166
00:09:22,620 --> 00:09:26,180
remember and the pins

167
00:09:26,759 --> 00:09:32,230
so this is relatively simple you need to

168
00:09:31,059 --> 00:09:34,449
have one for backup

169
00:09:32,230 --> 00:09:36,309
and one which is real representing one

170
00:09:34,449 --> 00:09:40,959
of those three that's basically the

171
00:09:36,309 --> 00:09:42,809
whole summary for this if at any point

172
00:09:40,959 --> 00:09:46,628
in time one of these certificates

173
00:09:42,809 --> 00:09:50,618
changes you will get this alert I don't

174
00:09:46,629 --> 00:09:53,129
know if you've seen this before it's

175
00:09:50,619 --> 00:09:53,129
very clear

176
00:09:53,330 --> 00:10:00,620
yeah so I've come here to these third

177
00:09:58,250 --> 00:10:02,600
chain and this is not what I was

178
00:10:00,620 --> 00:10:05,420
expecting this is not what I was

179
00:10:02,600 --> 00:10:09,500
remembering and I don't seem to visit

180
00:10:05,420 --> 00:10:12,170
this before so we are using this page

181
00:10:09,500 --> 00:10:17,089
web but this page that I'm showing you

182
00:10:12,170 --> 00:10:23,300
this side is public okay so it's often

183
00:10:17,089 --> 00:10:27,200
useful video demos so we've done lots of

184
00:10:23,300 --> 00:10:31,459
studies to find out who implements these

185
00:10:27,200 --> 00:10:35,209
and you found terrible things as to how

186
00:10:31,459 --> 00:10:37,880
this is implemented we have went through

187
00:10:35,209 --> 00:10:43,699
a lecture we've seen that many pins are

188
00:10:37,880 --> 00:10:47,140
badly inserted or put in place so all

189
00:10:43,700 --> 00:10:51,110
that has been published already I

190
00:10:47,140 --> 00:10:53,420
encourage you to visit our locker

191
00:10:51,110 --> 00:10:59,990
we often post entries on Mondays and

192
00:10:53,420 --> 00:11:03,649
Tuesdays but what I liked most was the

193
00:10:59,990 --> 00:11:05,950
way browsers implemented it okay and

194
00:11:03,649 --> 00:11:08,600
this is what my presentation is about

195
00:11:05,950 --> 00:11:11,510
when I could see how this was

196
00:11:08,600 --> 00:11:15,700
implemented by Firefox that was in 2015

197
00:11:11,510 --> 00:11:21,189
it remains has remained the same

198
00:11:15,700 --> 00:11:27,440
surgery's files high-security service

199
00:11:21,190 --> 00:11:30,980
dot txt and when I google site security

200
00:11:27,440 --> 00:11:34,370
service I called an entry an entry which

201
00:11:30,980 --> 00:11:35,600
was a source code so no one was talking

202
00:11:34,370 --> 00:11:40,180
about it there was no documentation

203
00:11:35,600 --> 00:11:40,180
about it and I said what this is cool

204
00:11:41,540 --> 00:11:48,920
so we found this and we wanted to kind

205
00:11:45,560 --> 00:11:53,839
of decrypt it okay so there was no other

206
00:11:48,920 --> 00:11:57,819
documentation just the source code it is

207
00:11:53,839 --> 00:12:00,440
not always easy to look at it and to

208
00:11:57,820 --> 00:12:02,510
find out things actually some things

209
00:12:00,440 --> 00:12:05,540
were not even implemented in the code so

210
00:12:02,510 --> 00:12:09,589
we analyzed it little by little and then

211
00:12:05,540 --> 00:12:17,449
we discovered that it stores domains

212
00:12:09,589 --> 00:12:22,339
then it wave through HSCs OHP KP P so

213
00:12:17,449 --> 00:12:25,609
this is cool so this is the number of

214
00:12:22,339 --> 00:12:29,329
days the number of different days where

215
00:12:25,610 --> 00:12:31,970
you've visited these sites so that means

216
00:12:29,329 --> 00:12:33,649
that if I visited today that would be

217
00:12:31,970 --> 00:12:35,480
one if I visited again I will continue

218
00:12:33,649 --> 00:12:37,370
to have number one buddy five visited

219
00:12:35,480 --> 00:12:41,899
tomorrow I will have number two and if I

220
00:12:37,370 --> 00:12:44,570
told if I visited next time next year it

221
00:12:41,899 --> 00:12:47,240
would be number three okay this is

222
00:12:44,570 --> 00:12:49,850
something that Firefox has invented so

223
00:12:47,240 --> 00:12:50,269
we wanted to understand why they did

224
00:12:49,850 --> 00:12:54,649
that

225
00:12:50,269 --> 00:12:57,910
okay so this is the number of days since

226
00:12:54,649 --> 00:12:57,910
a pop

227
00:12:58,860 --> 00:13:01,520
so

228
00:13:01,600 --> 00:13:07,550
Kunduz they had a number of flags and

229
00:13:04,490 --> 00:13:11,959
domains and then pins pins because he

230
00:13:07,550 --> 00:13:14,449
was HP KP entry it also showed up here

231
00:13:11,959 --> 00:13:19,758
because it was like really difficult we

232
00:13:14,449 --> 00:13:22,758
just made at plugging for the browser to

233
00:13:19,759 --> 00:13:26,199
interpret the times when I will expire

234
00:13:22,759 --> 00:13:30,079
what was reset whether he said domain

235
00:13:26,199 --> 00:13:34,189
processes about pins this is a plug-in

236
00:13:30,079 --> 00:13:36,349
that parses txt file so it is there

237
00:13:34,189 --> 00:13:37,879
available to you so that you can that

238
00:13:36,350 --> 00:13:45,490
Laurie that you don't have to go through

239
00:13:37,879 --> 00:13:48,319
all that crap so but did we find

240
00:13:45,490 --> 00:13:53,930
so the time we found that the limit was

241
00:13:48,319 --> 00:13:58,279
set has 1024 lines not domains I mean

242
00:13:53,930 --> 00:14:04,939
lines so therefore a domain with hpk

243
00:13:58,279 --> 00:14:08,779
peahen HSTs will occupy two entries and

244
00:14:04,939 --> 00:14:11,149
we will only have like 1024 possibility

245
00:14:08,779 --> 00:14:13,550
and senses of history and things and

246
00:14:11,149 --> 00:14:16,670
then your mind starts to think why but a

247
00:14:13,550 --> 00:14:18,469
subjective or not not enough okay so the

248
00:14:16,670 --> 00:14:22,819
first question was what happens if we

249
00:14:18,470 --> 00:14:28,149
tried to fill up those what are the four

250
00:14:22,819 --> 00:14:28,149
entries with junk

251
00:14:29,620 --> 00:14:37,660
but there are several ways to do it so

252
00:14:32,940 --> 00:14:40,840
you just manipulate the headers of a

253
00:14:37,660 --> 00:14:43,089
side so we had to prepare the club

254
00:14:40,840 --> 00:14:44,770
painting we asked it to result for the

255
00:14:43,090 --> 00:14:48,970
subdomains and to put it in the same

256
00:14:44,770 --> 00:14:52,839
place we bought the relevant domains we

257
00:14:48,970 --> 00:14:56,830
bought two domains to make changes in

258
00:14:52,839 --> 00:14:58,930
the domain headers so the only thing

259
00:14:56,830 --> 00:15:02,800
that I did here was that I'm helping

260
00:14:58,930 --> 00:15:06,250
myself I'm using club pinning so but we

261
00:15:02,800 --> 00:15:10,089
did it with JavaScript sending quick

262
00:15:06,250 --> 00:15:12,100
requests and indexed is JavaScript in

263
00:15:10,089 --> 00:15:17,020
any size okay so therefore we'll be

264
00:15:12,100 --> 00:15:19,900
filling filling it up with junk behind

265
00:15:17,020 --> 00:15:25,180
so it magic that I visited Netflix or

266
00:15:19,900 --> 00:15:28,569
Instagram and instead of txt I take a

267
00:15:25,180 --> 00:15:30,579
look at pin patron and say ooh necklace

268
00:15:28,570 --> 00:15:38,110
goes through a chest yes

269
00:15:30,580 --> 00:15:41,200
so in theory the attack should not be

270
00:15:38,110 --> 00:15:44,790
working because they visit will go

271
00:15:41,200 --> 00:15:47,950
through at 307 address internal address

272
00:15:44,790 --> 00:15:49,000
so with this attack will work with the

273
00:15:47,950 --> 00:15:53,530
zoom man in the middle

274
00:15:49,000 --> 00:15:56,710
I wouldn't win any but bounty with it

275
00:15:53,530 --> 00:16:00,400
then you inject any JavaScript to any

276
00:15:56,710 --> 00:16:03,820
visited sites then it starts to fill it

277
00:16:00,400 --> 00:16:06,819
up with headers and I said so the visit

278
00:16:03,820 --> 00:16:09,790
the all sorry the victim visits any site

279
00:16:06,820 --> 00:16:14,080
for instance in this case hola mundo dot

280
00:16:09,790 --> 00:16:20,800
s or some JavaScript is being injected

281
00:16:14,080 --> 00:16:23,140
there a few seconds or minutes later the

282
00:16:20,800 --> 00:16:26,889
user what wouldn't notice anything

283
00:16:23,140 --> 00:16:32,120
whatsoever and then

284
00:16:26,889 --> 00:16:35,720
browser I take five minutes depending on

285
00:16:32,120 --> 00:16:38,860
the configuration and now if they visit

286
00:16:35,720 --> 00:16:43,189
oh sorry the victim juices are plugging

287
00:16:38,860 --> 00:16:47,600
to see what it remembers about HP KP and

288
00:16:43,189 --> 00:16:50,870
HSTs actually will see these 1,024

289
00:16:47,600 --> 00:16:58,420
entries and then we see that instagram

290
00:16:50,870 --> 00:17:02,629
entry is gone so it has d hosted

291
00:16:58,420 --> 00:17:05,688
instagram from the HSTs database so

292
00:17:02,629 --> 00:17:08,209
therefore we will have the opportunity

293
00:17:05,689 --> 00:17:12,470
now to carry a conventional

294
00:17:08,209 --> 00:17:15,650
man-in-the-middle attack and that's why

295
00:17:12,470 --> 00:17:18,620
HSTs was stored in the browser so let us

296
00:17:15,650 --> 00:17:19,220
say we have d hosted and two main from

297
00:17:18,619 --> 00:17:21,589
the browser

298
00:17:19,220 --> 00:17:25,549
so therefore the host doesn't work

299
00:17:21,589 --> 00:17:31,549
anymore okay now we will visit instagram

300
00:17:25,549 --> 00:17:34,549
we will not type in HTTPS in theory you

301
00:17:31,549 --> 00:17:38,210
should consult HTTPS palaces look you

302
00:17:34,549 --> 00:17:42,400
wanted to go through HSE s of TLS but

303
00:17:38,210 --> 00:17:42,400
you forgot to write it

304
00:17:43,700 --> 00:17:47,750
well then they

305
00:17:48,360 --> 00:17:53,699
so no matter the test that you make then

306
00:17:52,380 --> 00:17:58,290
in clear-text

307
00:17:53,700 --> 00:18:03,390
you will see it like an SSL strip attack

308
00:17:58,290 --> 00:18:08,580
to instagram so we have kind of if if i

309
00:18:03,390 --> 00:18:08,970
did her eliminated HSTs from any web

310
00:18:08,580 --> 00:18:14,810
sites

311
00:18:08,970 --> 00:18:22,100
thanks to implementation of firefox but

312
00:18:14,810 --> 00:18:25,980
some entries were not overridden so

313
00:18:22,100 --> 00:18:30,300
filling that up with Jang o of writing

314
00:18:25,980 --> 00:18:32,580
it was kind of random so everything

315
00:18:30,300 --> 00:18:39,450
comes from the school that was invented

316
00:18:32,580 --> 00:18:41,939
by Firefox that explains us why they

317
00:18:39,450 --> 00:18:45,090
have came up with our score and why they

318
00:18:41,940 --> 00:18:47,100
are storing the different number the

319
00:18:45,090 --> 00:18:47,429
different types that you have visited to

320
00:18:47,100 --> 00:18:52,409
you

321
00:18:47,430 --> 00:18:54,780
websites so well in when they disclose

322
00:18:52,410 --> 00:18:57,450
the source code and they explained the

323
00:18:54,780 --> 00:19:03,860
score these are the comments for the

324
00:18:57,450 --> 00:19:03,860
source code I says well the entry

325
00:19:09,490 --> 00:19:17,980
an entry school is incremented once for

326
00:19:13,810 --> 00:19:22,210
every day and then the entry with the

327
00:19:17,980 --> 00:19:26,100
lowest score is evicted when we will

328
00:19:22,210 --> 00:19:32,440
have lots of entries with the lowest

329
00:19:26,100 --> 00:19:35,469
score any entry will be evicted because

330
00:19:32,440 --> 00:19:39,400
that will depend on the memory that is

331
00:19:35,470 --> 00:19:42,430
to say in the way the memory is landing

332
00:19:39,400 --> 00:19:45,400
for the memory is being made okay so we

333
00:19:42,430 --> 00:19:48,520
will evict the entry with the lowest

334
00:19:45,400 --> 00:19:50,380
school so what does that mean means that

335
00:19:48,520 --> 00:19:53,830
the highest school the more difficult

336
00:19:50,380 --> 00:19:57,060
for you to be evicted so what does it

337
00:19:53,830 --> 00:20:01,360
mean that you will be easily more easily

338
00:19:57,060 --> 00:20:05,950
attacked the sites that you visit and

339
00:20:01,360 --> 00:20:09,580
frequently whereas the most visited

340
00:20:05,950 --> 00:20:12,280
sites will be more difficult to evict

341
00:20:09,580 --> 00:20:15,310
and then we will continue reading the

342
00:20:12,280 --> 00:20:18,010
source code of Firefox they say it may

343
00:20:15,310 --> 00:20:21,129
happen that all the remains may have the

344
00:20:18,010 --> 00:20:24,460
highest score so therefore we will not

345
00:20:21,130 --> 00:20:31,290
be able to evict anyone the worst that

346
00:20:24,460 --> 00:20:36,970
will happen is that the AA 1025 entries

347
00:20:31,290 --> 00:20:42,310
so therefore the 1020 v entry will be

348
00:20:36,970 --> 00:20:45,280
replaced every time but that would not

349
00:20:42,310 --> 00:20:51,100
be that bad because you will have to end

350
00:20:45,280 --> 00:20:54,129
up modifying the file well you will have

351
00:20:51,100 --> 00:20:57,550
to have very high scores and then having

352
00:20:54,130 --> 00:20:59,710
these 1025 entries and I said well this

353
00:20:57,550 --> 00:21:01,300
will never happen they said they will

354
00:20:59,710 --> 00:21:05,980
never happen and say yes of course it

355
00:21:01,300 --> 00:21:09,010
will happen so we started to invade that

356
00:21:05,980 --> 00:21:13,150
with our fake to invade this course with

357
00:21:09,010 --> 00:21:17,020
our fake domains so we said

358
00:21:13,150 --> 00:21:20,800
we thought if we fill everything up with

359
00:21:17,020 --> 00:21:25,870
sufficiently high school we wouldn't

360
00:21:20,800 --> 00:21:27,669
need to reach 1025 who will try to evict

361
00:21:25,870 --> 00:21:30,159
our centuries with the highest school

362
00:21:27,670 --> 00:21:33,910
and at the end of the day to be left

363
00:21:30,160 --> 00:21:39,400
with one slot only so how would it work

364
00:21:33,910 --> 00:21:42,120
I junk HST a century as injection and

365
00:21:39,400 --> 00:21:44,920
the next one I do the same thing and

366
00:21:42,120 --> 00:21:49,870
then the school will be incremented by

367
00:21:44,920 --> 00:21:54,250
one so I could just send the same junk

368
00:21:49,870 --> 00:21:56,709
HSTs entries and the then they will be

369
00:21:54,250 --> 00:22:04,020
incremented by two and the process would

370
00:21:56,710 --> 00:22:07,630
be like that and then I remember horses

371
00:22:04,020 --> 00:22:12,820
7sl Canada's just DeLorean that's what

372
00:22:07,630 --> 00:22:15,070
it is therefore well to increase it by

373
00:22:12,820 --> 00:22:17,320
today artificially and to carry out an

374
00:22:15,070 --> 00:22:23,860
attack in a question of minutes if we

375
00:22:17,320 --> 00:22:29,439
managed to increase the scores of these

376
00:22:23,860 --> 00:22:35,280
junk pages quickly we will also be able

377
00:22:29,440 --> 00:22:38,920
to will be more likely to evict

378
00:22:35,280 --> 00:22:41,470
frequently used domains and in the worst

379
00:22:38,920 --> 00:22:47,950
cases energy will be left with one entry

380
00:22:41,470 --> 00:22:52,570
only okay and now to go through DeLorean

381
00:22:47,950 --> 00:22:56,139
and to tell you how it goes

382
00:22:52,570 --> 00:22:59,769
it is as follows okay DeLorean and then

383
00:22:56,139 --> 00:23:02,469
we said one day in the future then we

384
00:22:59,769 --> 00:23:04,960
start listening remember that the

385
00:23:02,470 --> 00:23:10,809
DeLorean in case you don't know it is an

386
00:23:04,960 --> 00:23:15,549
MTP server it simulates to be server and

387
00:23:10,809 --> 00:23:17,769
to be server and this boon to will ask

388
00:23:15,549 --> 00:23:20,679
for the time to the servers it will be

389
00:23:17,769 --> 00:23:23,320
decided and it will tell the server that

390
00:23:20,679 --> 00:23:27,190
we are in the future so that with that

391
00:23:23,320 --> 00:23:29,950
future day we just sent in the or

392
00:23:27,190 --> 00:23:33,610
injected domains again so we have a

393
00:23:29,950 --> 00:23:36,580
JavaScript injection visiting the fake

394
00:23:33,610 --> 00:23:40,959
domains again

395
00:23:36,580 --> 00:23:45,549
and therefore we managed we see we

396
00:23:40,960 --> 00:23:49,299
increase the scores rapidly if we go

397
00:23:45,549 --> 00:23:52,629
back to the victim sites we increase

398
00:23:49,299 --> 00:23:53,350
DeLorean and we set it to two J's ahead

399
00:23:52,629 --> 00:23:58,178
of time

400
00:23:53,350 --> 00:24:01,719
Ubuntu that is the victim will ask for

401
00:23:58,179 --> 00:24:03,700
time again to this fault server the

402
00:24:01,720 --> 00:24:07,120
server says that we are two days ahead

403
00:24:03,700 --> 00:24:10,389
in time and then we repeat the operation

404
00:24:07,120 --> 00:24:13,600
again what requests were made quite

405
00:24:10,389 --> 00:24:17,139
frequently and quite fast as well in

406
00:24:13,600 --> 00:24:19,658
this Kubuntu so for the server it's

407
00:24:17,139 --> 00:24:21,758
already Saturday any visitor will be

408
00:24:19,659 --> 00:24:26,470
made through these injected JavaScript

409
00:24:21,759 --> 00:24:29,289
you will have feeling that it is on a

410
00:24:26,470 --> 00:24:32,860
different day and then we will start to

411
00:24:29,289 --> 00:24:36,940
see an increase in the scorn of fake

412
00:24:32,860 --> 00:24:42,039
sites so therefore little by little we

413
00:24:36,940 --> 00:24:45,940
will have the chance to evict entries

414
00:24:42,039 --> 00:24:50,200
with highest course you may end up

415
00:24:45,940 --> 00:24:52,539
saying well you may need well some

416
00:24:50,200 --> 00:24:57,159
scores may be very high like 15 but

417
00:24:52,539 --> 00:25:00,570
other pages or other sites are like have

418
00:24:57,159 --> 00:25:00,570
very very lowest scores

419
00:25:07,230 --> 00:25:14,279
so sometimes when the scores are

420
00:25:10,250 --> 00:25:17,210
ungreased okay they are just reset to

421
00:25:14,279 --> 00:25:22,919
zero that happened some time seeing

422
00:25:17,210 --> 00:25:25,139
Holly frequency decides okay so man in

423
00:25:22,919 --> 00:25:29,159
the middle plus DeLorean not for windows

424
00:25:25,139 --> 00:25:31,620
plus HSTs this is a very nice technique

425
00:25:29,159 --> 00:25:33,529
in those places what you are already in

426
00:25:31,620 --> 00:25:37,289
the middle for instance you are in a

427
00:25:33,529 --> 00:25:40,200
hotel with an Wi-Fi network this is a

428
00:25:37,289 --> 00:25:43,860
hostile environment so when you want to

429
00:25:40,200 --> 00:25:46,830
visit a page and you may just want to

430
00:25:43,860 --> 00:25:50,039
have that jaco to make that huginn take

431
00:25:46,830 --> 00:25:52,110
captive signs of the hotel and if you

432
00:25:50,039 --> 00:25:55,649
are staying at the hotel you have a few

433
00:25:52,110 --> 00:25:58,289
days to experiment with it you can also

434
00:25:55,649 --> 00:26:00,510
improve this attack by introducing some

435
00:25:58,289 --> 00:26:01,980
timing that is to say introducing the

436
00:26:00,510 --> 00:26:03,929
ones that you have visited because you

437
00:26:01,980 --> 00:26:06,630
have the cloud pinning and using the

438
00:26:03,929 --> 00:26:09,210
locks do you know which ones do visit it

439
00:26:06,630 --> 00:26:11,220
and you can surf you can deliver exactly

440
00:26:09,210 --> 00:26:13,830
the same them and you can detect you

441
00:26:11,220 --> 00:26:17,250
completely see how long the table is so

442
00:26:13,830 --> 00:26:19,620
that you serve the only what is

443
00:26:17,250 --> 00:26:21,960
necessary to end up with one is loud

444
00:26:19,620 --> 00:26:25,709
only we have not implemented it but

445
00:26:21,960 --> 00:26:29,639
surely if we try it we will succeed in

446
00:26:25,710 --> 00:26:32,850
doing it well we in the case we just

447
00:26:29,639 --> 00:26:34,979
don't want to evict any specific entry

448
00:26:32,850 --> 00:26:38,158
or domain this is what will happen all

449
00:26:34,980 --> 00:26:41,070
the time we will only have one entry the

450
00:26:38,159 --> 00:26:46,279
worst gas case the scenario in the

451
00:26:41,070 --> 00:26:50,120
Firefox comments made by the programmer

452
00:26:46,279 --> 00:26:50,120
fulfilled easily

453
00:26:50,260 --> 00:27:01,129
don't forget that this is really

454
00:26:52,520 --> 00:27:01,910
negative when we have expiry date class

455
00:27:01,130 --> 00:27:07,130
hm

456
00:27:01,910 --> 00:27:09,410
hi one that always will stay and the new

457
00:27:07,130 --> 00:27:11,360
entries are below for anything new and

458
00:27:09,410 --> 00:27:14,090
if he knew means that when you open up

459
00:27:11,360 --> 00:27:17,629
the Firefox sites and then you get the

460
00:27:14,090 --> 00:27:19,939
box for favorites that's already an

461
00:27:17,630 --> 00:27:20,870
entry when you go to a sides and it's

462
00:27:19,940 --> 00:27:24,200
full of hats

463
00:27:20,870 --> 00:27:29,059
well that is taking up space so in

464
00:27:24,200 --> 00:27:35,809
practice then single entry is all the

465
00:27:29,059 --> 00:27:39,620
time receiving a score zero so that's

466
00:27:35,809 --> 00:27:42,170
full Firefox and now forget about school

467
00:27:39,620 --> 00:27:46,959
because drum doesn't have any scores let

468
00:27:42,170 --> 00:27:54,080
us see how chrome does that supports the

469
00:27:46,960 --> 00:27:57,950
Odysseys Jason file JSON file stores all

470
00:27:54,080 --> 00:28:00,490
the information about the site is

471
00:27:57,950 --> 00:28:04,510
visited and that's something which is

472
00:28:00,490 --> 00:28:10,130
interested it encrypts the domain or

473
00:28:04,510 --> 00:28:12,559
actually hashed the domain we didn't

474
00:28:10,130 --> 00:28:17,650
know how we did it but we found it out

475
00:28:12,559 --> 00:28:17,649
okay is hash

476
00:28:17,770 --> 00:28:26,270
base64 hush we built a plugin for the

477
00:28:21,409 --> 00:28:29,620
browser but our browser knows which

478
00:28:26,270 --> 00:28:39,820
domain that is it does it through

479
00:28:29,620 --> 00:28:43,489
visiting the history and the comparison

480
00:28:39,820 --> 00:28:46,370
so therefore he knows these domains are

481
00:28:43,490 --> 00:28:50,649
having visitors so privacy is not very

482
00:28:46,370 --> 00:28:54,860
high and the rest of data are here a

483
00:28:50,649 --> 00:28:59,779
garrison that we've found the following

484
00:28:54,860 --> 00:29:05,320
contrary to Firefox from has no storage

485
00:28:59,779 --> 00:29:05,320
limit whatsoever no type of limit

486
00:29:07,510 --> 00:29:21,919
firefox only allowed 1k so 1,024 below

487
00:29:16,070 --> 00:29:26,450
and to the side so if you introduced a

488
00:29:21,919 --> 00:29:31,399
pin in firefox to the right you could

489
00:29:26,450 --> 00:29:33,230
only reach 22 22 23 pins the rest of the

490
00:29:31,399 --> 00:29:37,969
pins are ignored because it doesn't want

491
00:29:33,230 --> 00:29:43,490
to store any more pins whereas chrome as

492
00:29:37,970 --> 00:29:49,669
we see that now it looks like endless

493
00:29:43,490 --> 00:29:52,390
well so endless what happens if we fill

494
00:29:49,669 --> 00:29:57,590
it up with thousands and thousands of

495
00:29:52,390 --> 00:30:00,529
jerk entries and pains and very long

496
00:29:57,590 --> 00:30:04,600
long ones with lots and lots of pins in

497
00:30:00,529 --> 00:30:10,549
them well that's what we did we just

498
00:30:04,600 --> 00:30:12,320
decided to hide it here okay by clicking

499
00:30:10,549 --> 00:30:15,789
on this button you will go to cloud

500
00:30:12,320 --> 00:30:19,779
pinning and cloud pinning will fill up

501
00:30:15,789 --> 00:30:23,929
50,000 requests each of them including

502
00:30:19,779 --> 00:30:29,000
high number of pins okay now one true

503
00:30:23,929 --> 00:30:35,230
pin and 4000 false ones okay let us see

504
00:30:29,000 --> 00:30:39,679
what happens now if you connect these

505
00:30:35,230 --> 00:30:41,809
points of cloud pinning this is what is

506
00:30:39,679 --> 00:30:46,779
happening behind the scenes okay the

507
00:30:41,809 --> 00:30:50,000
user currently cannot see anything and

508
00:30:46,779 --> 00:30:53,090
look these are all the requests that are

509
00:30:50,000 --> 00:30:56,419
being made in the background well the

510
00:30:53,090 --> 00:30:59,770
side effect is that these star grows

511
00:30:56,419 --> 00:31:02,450
very very quickly in megabytes

512
00:30:59,770 --> 00:31:04,760
everything is dumped in real time

513
00:31:02,450 --> 00:31:09,799
doesn't go through the memory everything

514
00:31:04,760 --> 00:31:11,260
is stored in the txt file and the size

515
00:31:09,799 --> 00:31:16,240
of it increases

516
00:31:11,260 --> 00:31:21,730
significantly so 25 30 megabytes this is

517
00:31:16,240 --> 00:31:28,170
real time and you see the increasing the

518
00:31:21,730 --> 00:31:31,510
size of file actually ten minutes later

519
00:31:28,170 --> 00:31:34,260
depending on your network latency or

520
00:31:31,510 --> 00:31:38,280
less than 10 minutes later we'll have

521
00:31:34,260 --> 00:31:42,990
120 megabytes okay so the users still

522
00:31:38,280 --> 00:31:46,450
waiting so we have reached 500 Megas

523
00:31:42,990 --> 00:31:49,720
megabytes from a txt there is no limit

524
00:31:46,450 --> 00:31:51,670
we could come on 500 magazine is enough

525
00:31:49,720 --> 00:31:54,310
and then the users are okay in the

526
00:31:51,670 --> 00:31:58,690
meantime I will visit another address

527
00:31:54,310 --> 00:32:01,240
okay this is real okay so it is frozen

528
00:31:58,690 --> 00:32:06,700
okay chrome gets frozen you cannot

529
00:32:01,240 --> 00:32:11,770
typing anything then you restart the

530
00:32:06,700 --> 00:32:15,010
browser and again what you cannot type

531
00:32:11,770 --> 00:32:19,690
in anything again okay so you cannot use

532
00:32:15,010 --> 00:32:22,720
it how could we use it how could we go

533
00:32:19,690 --> 00:32:27,040
back to it remember it's been frozen if

534
00:32:22,720 --> 00:32:30,070
you manage to reach the history and to

535
00:32:27,040 --> 00:32:34,810
delete it okay oh brother

536
00:32:30,070 --> 00:32:36,159
delete the txt well any user says well

537
00:32:34,810 --> 00:32:39,310
this is not working for me I don't know

538
00:32:36,160 --> 00:32:41,500
what is happening then we'll just go to

539
00:32:39,310 --> 00:32:45,179
Firefox and then we will just launch an

540
00:32:41,500 --> 00:32:45,180
attack from Firefox basically

541
00:32:49,230 --> 00:32:52,950
well or the person will go to Internet

542
00:32:51,330 --> 00:32:57,409
Explorer and we will aside sack from

543
00:32:52,950 --> 00:32:57,410
from Internet Explorer which is easier

544
00:32:59,870 --> 00:33:07,850
so this is very easy well do to a man in

545
00:33:03,590 --> 00:33:15,470
the middle attack South with 300 400

546
00:33:07,850 --> 00:33:21,350
megabytes so Crum stops working in a few

547
00:33:15,470 --> 00:33:25,730
minutes what happens with Internet

548
00:33:21,350 --> 00:33:28,030
Explorer ok 25 minutes before I finish

549
00:33:25,730 --> 00:33:28,030
good

550
00:33:31,310 --> 00:33:37,310
well of course we didn't find any

551
00:33:34,580 --> 00:33:43,610
documentation for Internet Explorer and

552
00:33:37,310 --> 00:33:47,570
then we go to this file dot dat this is

553
00:33:43,610 --> 00:33:55,550
the extensible storage excel type of

554
00:33:47,570 --> 00:33:58,310
file it is a type of database of

555
00:33:55,550 --> 00:34:00,320
Microsoft for which there is no

556
00:33:58,310 --> 00:34:02,570
documentation whatsoever no information

557
00:34:00,320 --> 00:34:06,679
about how it is stored or the type of

558
00:34:02,570 --> 00:34:10,989
database what it is stored so we are a

559
00:34:06,680 --> 00:34:10,990
bit like lost

560
00:34:16,418 --> 00:34:23,248
so for name we could what we are not

561
00:34:20,349 --> 00:34:28,480
expecting to find HP KP not rolling

562
00:34:23,248 --> 00:34:30,598
inside of Explorer so we don't expect to

563
00:34:28,480 --> 00:34:33,159
find it

564
00:34:30,599 --> 00:34:40,599
because when from is saying that it

565
00:34:33,159 --> 00:34:42,609
would eliminate HP K P so Internet

566
00:34:40,599 --> 00:34:45,399
Explorer we'll just wait and see what

567
00:34:42,609 --> 00:34:50,668
happens and well we was right okay

568
00:34:45,399 --> 00:34:50,668
because HP can P will be eliminated so

569
00:34:51,449 --> 00:34:58,118
some domains are starting here we don't

570
00:34:54,518 --> 00:35:02,169
know as I say how those domains are it's

571
00:34:58,119 --> 00:35:04,029
thought when it expires as I was surely

572
00:35:02,170 --> 00:35:08,859
there is something fishy here

573
00:35:04,029 --> 00:35:13,960
okay domain but surely DC's associated

574
00:35:08,859 --> 00:35:16,930
with HTTP s we don't know how it has

575
00:35:13,960 --> 00:35:22,710
that but probably someone which is

576
00:35:16,930 --> 00:35:25,509
better at professing could find that out

577
00:35:22,710 --> 00:35:28,529
so it is complicated because we have to

578
00:35:25,509 --> 00:35:28,529
do that life

579
00:35:29,960 --> 00:35:36,569
some of it is process extremely simple

580
00:35:33,720 --> 00:35:39,270
tests when you have where we deduce

581
00:35:36,569 --> 00:35:43,020
Internet Explorer you go to well-known

582
00:35:39,270 --> 00:35:51,030
sites Facebook Instagram or Facebook

583
00:35:43,020 --> 00:35:55,799
Google Outlook so it looks like so if

584
00:35:51,030 --> 00:35:59,970
you visited that fast with no TLS then

585
00:35:55,799 --> 00:36:03,839
you revisited it without TLS and did

586
00:35:59,970 --> 00:36:06,480
like kind of internal re forwarding and

587
00:36:03,839 --> 00:36:09,720
there well said letter sends out lots of

588
00:36:06,480 --> 00:36:11,250
requests to drop in see what happens and

589
00:36:09,720 --> 00:36:15,140
we give the hair back

590
00:36:11,250 --> 00:36:20,119
we sent in Mahara 31 requested the 21st

591
00:36:15,140 --> 00:36:24,980
25th of November and sometime later from

592
00:36:20,119 --> 00:36:30,059
what we didn't see any information about

593
00:36:24,980 --> 00:36:32,790
ATT s so nothing was being stored

594
00:36:30,059 --> 00:36:35,130
because the domain was to be known but

595
00:36:32,790 --> 00:36:37,319
when you visited known domains it seems

596
00:36:35,130 --> 00:36:39,599
that there was some kind of changes in

597
00:36:37,319 --> 00:36:43,170
the table and I said well something must

598
00:36:39,599 --> 00:36:48,660
be wrong in what we were doing either

599
00:36:43,170 --> 00:36:52,380
the hair something was failing and then

600
00:36:48,660 --> 00:36:56,250
when we did the life reversing we could

601
00:36:52,380 --> 00:36:58,309
see that in witness dot DLL and I said

602
00:36:56,250 --> 00:37:03,000
we had no documentation well so whether

603
00:36:58,309 --> 00:37:05,099
we had HTTP host enable and then we

604
00:37:03,000 --> 00:37:11,750
could see methods that were kind of

605
00:37:05,099 --> 00:37:15,440
related to HSTs so checking active adage

606
00:37:11,750 --> 00:37:15,440
said it in the database

607
00:37:19,020 --> 00:37:25,810
well these were cold

608
00:37:21,850 --> 00:37:28,150
these were requests that this existed

609
00:37:25,810 --> 00:37:35,610
but these ones were not calling each

610
00:37:28,150 --> 00:37:43,150
other they were not being called in the

611
00:37:35,610 --> 00:37:45,760
ordinary work flow but in any case it

612
00:37:43,150 --> 00:37:47,950
looked like it worked

613
00:37:45,760 --> 00:37:52,540
if you visited something with no TLS

614
00:37:47,950 --> 00:37:58,689
then we revisited it through

615
00:37:52,540 --> 00:38:00,700
TLS secrecy that worked so our theory or

616
00:37:58,690 --> 00:38:07,150
hypothesis was that this was being

617
00:38:00,700 --> 00:38:10,419
cheated by do decided by cachet so what

618
00:38:07,150 --> 00:38:14,380
was making everything running was the

619
00:38:10,420 --> 00:38:18,090
cachet and we did the following tests so

620
00:38:14,380 --> 00:38:18,090
we visited Instagram

621
00:38:20,020 --> 00:38:29,490
so we eliminated hash or we just

622
00:38:26,040 --> 00:38:29,490
restarted the browser

623
00:38:37,100 --> 00:38:43,779
if shaft is the only thing that allows

624
00:38:39,170 --> 00:38:48,260
you to read this table were supposedly

625
00:38:43,780 --> 00:38:54,020
Internet Explorer restores the HST has

626
00:38:48,260 --> 00:39:01,300
values so husband hasn't done anything

627
00:38:54,020 --> 00:39:01,300
and when you want to make an attack

628
00:39:01,900 --> 00:39:08,740
you can easily attack instagram by

629
00:39:05,440 --> 00:39:13,090
eliminating the cache you don't have to

630
00:39:08,740 --> 00:39:16,629
eliminate the HSTs table but just by

631
00:39:13,090 --> 00:39:20,050
eliminating the cache Oh restarting the

632
00:39:16,630 --> 00:39:22,800
browser you can already bypassed the

633
00:39:20,050 --> 00:39:22,800
HSCs

634
00:39:24,820 --> 00:39:34,830
but we were not clear about the sites

635
00:39:29,590 --> 00:39:39,430
that were remembered and stored and

636
00:39:34,830 --> 00:39:42,670
actually what is confusing that some of

637
00:39:39,430 --> 00:39:44,830
the functions should be cold or not cold

638
00:39:42,670 --> 00:39:48,880
that's because of the cache effects and

639
00:39:44,830 --> 00:39:52,720
also very confusing reading that inside

640
00:39:48,880 --> 00:39:58,690
that Explorer had support for HTTP but

641
00:39:52,720 --> 00:40:01,120
actually this does not work we were so

642
00:39:58,690 --> 00:40:04,180
excited that we mentioned this during

643
00:40:01,120 --> 00:40:06,130
the blackhat conference and then

644
00:40:04,180 --> 00:40:09,970
Microsoft came along and said you have

645
00:40:06,130 --> 00:40:14,350
been deceived this will be on in June of

646
00:40:09,970 --> 00:40:17,950
2018 we are actually testing it simply

647
00:40:14,350 --> 00:40:20,440
speaking it doesn't work they have it

648
00:40:17,950 --> 00:40:22,270
available for certain domains they have

649
00:40:20,440 --> 00:40:26,880
the methods implemented but they don't

650
00:40:22,270 --> 00:40:31,800
call each other okay despite this and

651
00:40:26,880 --> 00:40:31,800
this has been confirmed by Microsoft

652
00:40:34,840 --> 00:40:43,440
kick it up or ie UNIVAC easily implement

653
00:40:38,110 --> 00:40:43,440
a few millimeter so this is the new part

654
00:40:46,440 --> 00:40:52,170
people are asking me about the world arm

655
00:40:49,020 --> 00:40:52,829
elbow well this is the answer if you're

656
00:40:52,170 --> 00:40:57,210
in iOS

657
00:40:52,829 --> 00:40:59,160
forget about HP KP why no idea no one

658
00:40:57,210 --> 00:41:03,030
tells you that it doesn't work in fact

659
00:40:59,160 --> 00:41:05,970
if you take a look at the page what can

660
00:41:03,030 --> 00:41:09,630
I use in Firefox and Chrome it works

661
00:41:05,970 --> 00:41:13,129
no mean I under iOS it doesn't work okay

662
00:41:09,630 --> 00:41:17,130
in Android 4 which is a bit old in

663
00:41:13,130 --> 00:41:20,220
Android 4 chrome says it does work it

664
00:41:17,130 --> 00:41:23,730
doesn't work it's alive ok HP KP doesn't

665
00:41:20,220 --> 00:41:26,430
work in Chrome for Android 4.0 this is a

666
00:41:23,730 --> 00:41:30,960
small video clip to show you how it

667
00:41:26,430 --> 00:41:33,200
works these are tests using a mobile

668
00:41:30,960 --> 00:41:33,200
phone

669
00:41:34,330 --> 00:41:42,850
a mobile phone with chrome so we go to

670
00:41:39,280 --> 00:41:48,190
our testing system does certificate has

671
00:41:42,850 --> 00:41:52,569
been side by Comodo we can see with

672
00:41:48,190 --> 00:41:54,520
Chrome for Mac or Chrome for whatever so

673
00:41:52,570 --> 00:41:57,820
we go to the website I've chased a

674
00:41:54,520 --> 00:42:03,370
certificate behind the scenes so when

675
00:41:57,820 --> 00:42:06,810
you press f5 to refresh you will see

676
00:42:03,370 --> 00:42:10,930
that it hasn't pinned what it remembers

677
00:42:06,810 --> 00:42:16,750
onion in iOS for Chrome it takes it

678
00:42:10,930 --> 00:42:18,750
directly and it keeps working I think

679
00:42:16,750 --> 00:42:22,280
I've broken something

680
00:42:18,750 --> 00:42:27,480
no it's running this is Firefox now

681
00:42:22,280 --> 00:42:29,730
Firefox on iOS same thing the

682
00:42:27,480 --> 00:42:34,130
certificate is changed not from Colona

683
00:42:29,730 --> 00:42:36,750
anymore it is now from GeoTrust I do f5

684
00:42:34,130 --> 00:42:41,100
Firefox tells me there is a problem with

685
00:42:36,750 --> 00:42:41,670
the pin but with Firefox on iOS no

686
00:42:41,100 --> 00:42:47,930
problem

687
00:42:41,670 --> 00:42:47,930
by the way if you have an iOS telephone

688
00:42:48,320 --> 00:42:55,920
download Firefox for iOS and try to

689
00:42:51,600 --> 00:42:58,500
click on the green padlock you will see

690
00:42:55,920 --> 00:43:00,150
nothing that is broken I don't know why

691
00:42:58,500 --> 00:43:02,940
he doesn't share information about the

692
00:43:00,150 --> 00:43:04,530
certificate I don't know whether this is

693
00:43:02,940 --> 00:43:06,720
a part of the latest release from

694
00:43:04,530 --> 00:43:08,250
Firefox in theory should be able to see

695
00:43:06,720 --> 00:43:11,730
information about the certificate you

696
00:43:08,250 --> 00:43:17,430
don't see anything so it doesn't work in

697
00:43:11,730 --> 00:43:21,810
iOS other stuff we wanted to test it to

698
00:43:17,430 --> 00:43:26,960
see how this attack would work using

699
00:43:21,810 --> 00:43:26,960
Chrome in a mobile phone again

700
00:43:29,150 --> 00:43:35,290
basically the same story we see chrome

701
00:43:31,970 --> 00:43:38,410
using 14 megabytes when we do the attack

702
00:43:35,290 --> 00:43:40,970
the attack will launch from our website

703
00:43:38,410 --> 00:43:43,069
with a man-in-the-middle the user visits

704
00:43:40,970 --> 00:43:45,589
a website look at that so

705
00:43:43,070 --> 00:43:48,410
it starts consuming one megabyte per

706
00:43:45,590 --> 00:43:52,430
second if I see five shots of their

707
00:43:48,410 --> 00:43:54,170
browser off it still consumes one

708
00:43:52,430 --> 00:43:58,129
megabyte per second and there's no

709
00:43:54,170 --> 00:44:05,440
downloads apparently because there's no

710
00:43:58,130 --> 00:44:08,570
arrows at the top so you consume data

711
00:44:05,440 --> 00:44:11,900
you can you can switch the application

712
00:44:08,570 --> 00:44:15,080
off and chrome will keep downloading to

713
00:44:11,900 --> 00:44:18,940
the extent that Chrome will go bust and

714
00:44:15,080 --> 00:44:18,940
still consume data

715
00:44:21,820 --> 00:44:24,750
finally

716
00:44:26,850 --> 00:44:33,480
it freezes and everything breaks in your

717
00:44:31,620 --> 00:44:35,790
mobile phone obviously you have less

718
00:44:33,480 --> 00:44:39,120
storage in your desktop computer and

719
00:44:35,790 --> 00:44:43,680
then your data plan will be impacted

720
00:44:39,120 --> 00:44:46,549
directly so the urine dip chips

721
00:44:43,680 --> 00:44:46,549
basically

722
00:44:50,040 --> 00:44:53,300
a really cool thing

723
00:44:57,320 --> 00:45:04,630
Sheila was working on she said much much

724
00:45:02,000 --> 00:45:08,420
much better programmer than any of us

725
00:45:04,630 --> 00:45:12,070
there's a certain small module for post

726
00:45:08,420 --> 00:45:14,570
exploitation just imagine that the

727
00:45:12,070 --> 00:45:18,530
device has been infected this is the

728
00:45:14,570 --> 00:45:21,610
module created by Sheila this was please

729
00:45:18,530 --> 00:45:25,430
it officially a very short while ago

730
00:45:21,610 --> 00:45:28,700
this is what the module does in the

731
00:45:25,430 --> 00:45:32,049
device which is being attacked just

732
00:45:28,700 --> 00:45:34,850
imagine you're in front of the device

733
00:45:32,050 --> 00:45:36,920
and you want to capture passwords with

734
00:45:34,850 --> 00:45:40,700
from the encrypted network um for that

735
00:45:36,920 --> 00:45:45,050
you need an ssl script on HTTP is

736
00:45:40,700 --> 00:45:47,689
interfering for HP KP in that case it

737
00:45:45,050 --> 00:45:53,570
will be very simple you simply load the

738
00:45:47,690 --> 00:45:55,730
module for post exploitation are you a

739
00:45:53,570 --> 00:45:58,040
lord of the mr. Prosser in the infected

740
00:45:55,730 --> 00:46:02,390
computer in this case this is session

741
00:45:58,040 --> 00:46:04,850
two you've run it and you eliminate all

742
00:46:02,390 --> 00:46:09,020
those little files that are showing it

743
00:46:04,850 --> 00:46:12,080
now the txt for Chrome for Firefox or

744
00:46:09,020 --> 00:46:14,300
opera I know I'm the only person in

745
00:46:12,080 --> 00:46:19,370
Spain using opera I guess it must be

746
00:46:14,300 --> 00:46:22,250
other uses of opera out there anyway so

747
00:46:19,370 --> 00:46:26,120
now you can do whatever you want

748
00:46:22,250 --> 00:46:27,220
launch any type of attack because with a

749
00:46:26,120 --> 00:46:31,490
single click

750
00:46:27,220 --> 00:46:34,140
all the cache was the reaches this is a

751
00:46:31,490 --> 00:46:38,490
way to make things simpler

752
00:46:34,140 --> 00:46:38,490
with a module for post exploitation

753
00:46:39,660 --> 00:46:48,089
there is something else we don't really

754
00:46:43,150 --> 00:46:53,740
know how to use it to be evil in chrome

755
00:46:48,089 --> 00:46:56,740
that draw attention this is another way

756
00:46:53,740 --> 00:47:00,868
to attack you can configure your own

757
00:46:56,740 --> 00:47:05,049
recipe to inject pins to inject HP KP

758
00:47:00,869 --> 00:47:07,329
all the rubbish you want to inject if I

759
00:47:05,049 --> 00:47:11,170
send one which is real another waffle

760
00:47:07,329 --> 00:47:13,660
pack happening in there one yes it ends

761
00:47:11,170 --> 00:47:15,520
in a one I'm sending it through the

762
00:47:13,660 --> 00:47:20,980
header there's no problem these are the

763
00:47:15,520 --> 00:47:24,700
two pins everything is correct but if I

764
00:47:20,980 --> 00:47:29,140
go over here and I take a look at what

765
00:47:24,700 --> 00:47:30,970
was stored by chrome chrome stores

766
00:47:29,140 --> 00:47:34,680
something that ends in a zero another

767
00:47:30,970 --> 00:47:37,359
one that was quite striking at first I

768
00:47:34,680 --> 00:47:39,390
was wondering how come it doesn't

769
00:47:37,359 --> 00:47:42,808
respect that hash it's impossible

770
00:47:39,390 --> 00:47:42,808
doesn't make any sense

771
00:47:43,340 --> 00:47:52,640
so after a lot of thinking what I think

772
00:47:47,440 --> 00:47:55,120
happens here but this is base64 base64

773
00:47:52,640 --> 00:47:57,200
has some sort of padding at the end

774
00:47:55,120 --> 00:47:59,029
base64 doesn't have a single

775
00:47:57,200 --> 00:48:03,710
relationship with whatever you're coding

776
00:47:59,030 --> 00:48:07,910
there is a padding okay depending on how

777
00:48:03,710 --> 00:48:11,120
you code what could happen here

778
00:48:07,910 --> 00:48:13,490
perhaps Cockrum is decoding it to 64 and

779
00:48:11,120 --> 00:48:15,589
then encoding it again in that case

780
00:48:13,490 --> 00:48:18,919
we'll have a zero at the end whereas you

781
00:48:15,590 --> 00:48:22,760
have an a.1 at the end how about using

782
00:48:18,920 --> 00:48:24,080
this to be evil well because this is

783
00:48:22,760 --> 00:48:25,790
something that will never happen you

784
00:48:24,080 --> 00:48:27,500
will never be able to calculate the

785
00:48:25,790 --> 00:48:28,880
certificate which says r1 at the end it

786
00:48:27,500 --> 00:48:34,730
will always have a sinner at the end

787
00:48:28,880 --> 00:48:36,230
because of our padding I really don't

788
00:48:34,730 --> 00:48:38,690
know why it decodes I'm done encodes

789
00:48:36,230 --> 00:48:41,390
Firefox respects this whatever you send

790
00:48:38,690 --> 00:48:44,990
is what it stores but chrome does a

791
00:48:41,390 --> 00:48:48,830
decoding which is a bit strange I have

792
00:48:44,990 --> 00:48:50,660
to keep investigating there's another

793
00:48:48,830 --> 00:48:53,450
doubt something that comes up every now

794
00:48:50,660 --> 00:48:55,790
and then how about incognito well you

795
00:48:53,450 --> 00:49:00,460
know the HSTs were used for super

796
00:48:55,790 --> 00:49:04,430
cookies it can be used to track users

797
00:49:00,460 --> 00:49:08,570
HSTs was used to track users this is not

798
00:49:04,430 --> 00:49:15,740
something we found out ourselves we saw

799
00:49:08,570 --> 00:49:20,270
a guy serving you a unique pin back up

800
00:49:15,740 --> 00:49:22,450
when you get a unique pin backup we get

801
00:49:20,270 --> 00:49:24,440
stored and you attract how you tracked

802
00:49:22,450 --> 00:49:27,980
well there's something I haven't told

803
00:49:24,440 --> 00:49:33,440
you about when HP KP shows you that the

804
00:49:27,980 --> 00:49:35,240
error are telling you hey the

805
00:49:33,440 --> 00:49:37,250
certification string you you are giving

806
00:49:35,240 --> 00:49:40,910
me is not the one that I am remembering

807
00:49:37,250 --> 00:49:45,790
at that time there is a trigger that

808
00:49:40,910 --> 00:49:48,319
goes off which is this you're giving me

809
00:49:45,790 --> 00:49:50,509
these three certificates which I

810
00:49:48,319 --> 00:49:52,190
understand are fake I'm sending them

811
00:49:50,510 --> 00:49:54,619
somewhere what do you want to send them

812
00:49:52,190 --> 00:49:57,220
there's a trigger there so in order to

813
00:49:54,619 --> 00:50:02,260
attract you what you can do is to send

814
00:49:57,220 --> 00:50:06,078
yourself to send you a unique pin and

815
00:50:02,260 --> 00:50:09,290
produce a failure so that you send up

816
00:50:06,079 --> 00:50:12,020
unique pin to yourself so you end up

817
00:50:09,290 --> 00:50:16,150
being tracked this was mentioned as a

818
00:50:12,020 --> 00:50:20,710
token conference is perfectly feasible

819
00:50:16,150 --> 00:50:20,710
there is no solutions so to say

820
00:50:22,890 --> 00:50:30,319
the rethink of teacher mode it doesn't

821
00:50:25,800 --> 00:50:33,360
respect HP KP anymore or HSTs why

822
00:50:30,320 --> 00:50:35,520
because this wasn't the case before in

823
00:50:33,360 --> 00:50:37,770
2013 in fact there was a discussion and

824
00:50:35,520 --> 00:50:39,570
I'm going discussion the city should be

825
00:50:37,770 --> 00:50:42,420
there they were and the other way around

826
00:50:39,570 --> 00:50:44,040
why are you respecting my my F chest TS

827
00:50:42,420 --> 00:50:45,390
in incognito mode because you have

828
00:50:44,040 --> 00:50:48,240
access to all my history

829
00:50:45,390 --> 00:50:52,020
you shouldn't have access to HSTs so it

830
00:50:48,240 --> 00:50:55,490
was removed well people are wondering

831
00:50:52,020 --> 00:51:00,300
should it respected sure not respected

832
00:50:55,490 --> 00:51:01,859
currently he doesn't respect it one of

833
00:51:00,300 --> 00:51:05,160
the things that struck me which is

834
00:51:01,860 --> 00:51:07,370
related to being tracked is to induce a

835
00:51:05,160 --> 00:51:07,370
failure

836
00:51:09,590 --> 00:51:19,130
what this website does is the following

837
00:51:12,380 --> 00:51:21,470
a failure is induced there is a pin

838
00:51:19,130 --> 00:51:27,560
failure this user sees nothing

839
00:51:21,470 --> 00:51:31,569
as I understand it here we should see an

840
00:51:27,560 --> 00:51:31,570
alert or something

841
00:51:35,020 --> 00:51:41,470
we should see an alert anyway as we see

842
00:51:38,410 --> 00:51:43,839
in other websites an alert telling you

843
00:51:41,470 --> 00:51:45,850
there are external resources in this

844
00:51:43,840 --> 00:51:49,240
website are changing your certificate

845
00:51:45,850 --> 00:51:52,029
but that is not shown in Chrome or in

846
00:51:49,240 --> 00:51:53,950
Firefox the alert is shown here some in

847
00:51:52,030 --> 00:51:55,990
an area which is not visible for the

848
00:51:53,950 --> 00:51:56,919
user this should be changed in my

849
00:51:55,990 --> 00:52:00,009
opinion anyway

850
00:51:56,920 --> 00:52:02,380
and finally chapter yet it's got his

851
00:52:00,010 --> 00:52:08,380
typical txt file it was included

852
00:52:02,380 --> 00:52:11,350
recently I tried to break it to no avail

853
00:52:08,380 --> 00:52:13,780
it doesn't support HP KP for the time

854
00:52:11,350 --> 00:52:19,360
being anyway we took a look at the

855
00:52:13,780 --> 00:52:23,050
source code and the only remarkable

856
00:52:19,360 --> 00:52:25,450
thing we found was this I'm really

857
00:52:23,050 --> 00:52:26,860
wicked because I'm writing matters that

858
00:52:25,450 --> 00:52:28,540
changed the control flow

859
00:52:26,860 --> 00:52:31,050
but who will notice that well I did

860
00:52:28,540 --> 00:52:31,050
notice it

861
00:52:37,340 --> 00:52:40,780
so this how it works

862
00:52:41,350 --> 00:52:46,330
there's other ways to find out where

863
00:52:44,530 --> 00:52:49,600
workarounds got Helmick men mentioned

864
00:52:46,330 --> 00:52:53,680
this but anyway this is just an anecdote

865
00:52:49,600 --> 00:52:56,560
once you see the message telling you

866
00:52:53,680 --> 00:52:58,470
that the fake pin has been used as

867
00:52:56,560 --> 00:53:02,290
there's no way you can access that

868
00:52:58,470 --> 00:53:06,370
unless you use the word bad idea of the

869
00:53:02,290 --> 00:53:08,500
two words together it gives you a safe

870
00:53:06,370 --> 00:53:11,370
conduct so to say for testing which is

871
00:53:08,500 --> 00:53:11,370
active in Chrome

872
00:53:13,270 --> 00:53:20,440
when this was known and by the way this

873
00:53:18,250 --> 00:53:23,650
has been like this for two years they

874
00:53:20,440 --> 00:53:26,350
said he would change their word this is

875
00:53:23,650 --> 00:53:28,930
source code for Chrome they said it will

876
00:53:26,350 --> 00:53:31,900
change it and replace it with this if

877
00:53:28,930 --> 00:53:34,259
you recorded base64 it says this isn't

878
00:53:31,900 --> 00:53:34,260
safe

879
00:53:37,079 --> 00:53:46,449
so someone typing this is unsafe could

880
00:53:40,809 --> 00:53:50,529
circumvent the system in case you're

881
00:53:46,449 --> 00:53:55,989
interested here we've done lots of

882
00:53:50,529 --> 00:54:01,599
things we've tried a lot of different

883
00:53:55,989 --> 00:54:03,910
things to break the system since this is

884
00:54:01,599 --> 00:54:08,349
stored properly we've done two billion

885
00:54:03,910 --> 00:54:12,328
things here this is the most remarkable

886
00:54:08,349 --> 00:54:14,979
things we achieved anyway conclusions

887
00:54:12,329 --> 00:54:18,309
the message the take-home message

888
00:54:14,979 --> 00:54:20,229
Firefox uses its own system was going to

889
00:54:18,309 --> 00:54:22,509
allow us on the one hand to Eirik

890
00:54:20,229 --> 00:54:24,069
domains with a low score and in

891
00:54:22,509 --> 00:54:25,719
practical terms hidden assets have

892
00:54:24,069 --> 00:54:29,709
reduced the database to one entry

893
00:54:25,719 --> 00:54:32,410
constantly overwritten by the way Chrome

894
00:54:29,709 --> 00:54:38,009
allows as many headers as possible

895
00:54:32,410 --> 00:54:41,699
literally whatever fits into a header

896
00:54:38,009 --> 00:54:41,699
and it makes it crash

897
00:54:43,890 --> 00:54:49,970
I'm not sure about the wording all

898
00:54:46,200 --> 00:54:53,220
attacks all attacks may be achieved via

899
00:54:49,970 --> 00:54:58,069
man-in-the-middle or not simply by

900
00:54:53,220 --> 00:54:58,069
visiting a website and

901
00:54:59,300 --> 00:55:07,700
both browsers I didn't mention that the

902
00:55:01,520 --> 00:55:10,130
representation for example Firefox has

903
00:55:07,700 --> 00:55:12,368
promised of the pin everything is

904
00:55:10,130 --> 00:55:14,930
together into CHD so it looks a bit odd

905
00:55:12,369 --> 00:55:19,330
we haven't been able to be evil with

906
00:55:14,930 --> 00:55:19,330
this browser for that purpose but anyway

907
00:55:20,300 --> 00:55:24,950
Internet Explorer edge do not even work

908
00:55:22,940 --> 00:55:27,050
with not known domains and we have

909
00:55:24,950 --> 00:55:28,879
created tools that are really cool to do

910
00:55:27,050 --> 00:55:31,400
a number of things to check your local

911
00:55:28,880 --> 00:55:38,060
database with pin pro to test your

912
00:55:31,400 --> 00:55:41,380
database with with cloud pinning and to

913
00:55:38,060 --> 00:55:44,509
delete your database with a module for

914
00:55:41,380 --> 00:55:46,070
post exploitation so one of the

915
00:55:44,510 --> 00:55:47,780
conclusions of that we can tell there

916
00:55:46,070 --> 00:55:49,640
there is not a strong bed yet for

917
00:55:47,780 --> 00:55:55,130
improving these implementations in

918
00:55:49,640 --> 00:55:59,770
browsers not yet at least I'm not sure

919
00:55:55,130 --> 00:55:59,770
about who is behind the scene years

920
00:56:01,630 --> 00:56:05,930
these things have been seen from we've

921
00:56:04,370 --> 00:56:08,480
been seen for quite some time and yet I

922
00:56:05,930 --> 00:56:14,359
haven't solve them and then something

923
00:56:08,480 --> 00:56:17,120
I've been told I can I can mention disk

924
00:56:14,360 --> 00:56:19,610
answering outage here just yes this is

925
00:56:17,120 --> 00:56:25,730
the initial name for my presentation

926
00:56:19,610 --> 00:56:27,920
this is server which is really funny so

927
00:56:25,730 --> 00:56:31,640
I was fascinated by that word disk

928
00:56:27,920 --> 00:56:35,780
ancing and I spent a few minutes to find

929
00:56:31,640 --> 00:56:38,390
out why the title for my presentation at

930
00:56:35,780 --> 00:56:41,960
rotator come

931
00:56:38,390 --> 00:56:45,650
in case you didn't get it it took me a

932
00:56:41,960 --> 00:56:48,100
while discussing out I've never heard

933
00:56:45,650 --> 00:56:48,100
that word

934
00:56:48,820 --> 00:56:55,760
and I've people thought that I had

935
00:56:51,410 --> 00:56:58,129
invented a word the key is here how do

936
00:56:55,760 --> 00:57:01,630
you call this an English break what does

937
00:56:58,130 --> 00:57:01,630
it say here breaking

938
00:57:02,620 --> 00:57:09,580
so this cancer means break in Spanish

939
00:57:05,360 --> 00:57:13,220
thus kunsing means breaking whatever a

940
00:57:09,580 --> 00:57:15,470
plain words whoever did this well I

941
00:57:13,220 --> 00:57:17,689
don't want to criticize them but it was

942
00:57:15,470 --> 00:57:19,819
funny it took me quite a few minutes

943
00:57:17,690 --> 00:57:22,340
until I realized that he was Spanglish

944
00:57:19,820 --> 00:57:24,710
disk and see what the hell whatever it

945
00:57:22,340 --> 00:57:31,460
was Spanglish that was a job is it for

946
00:57:24,710 --> 00:57:34,520
me thank you so much it can surpass

947
00:57:31,460 --> 00:57:38,360
kilauea he let me figure better you must

948
00:57:34,520 --> 00:57:40,820
know tell my boss okay replacing offers

949
00:57:38,360 --> 00:57:46,340
from telefónica buy offers from Orange

950
00:57:40,820 --> 00:57:50,140
questions there is one over here any

951
00:57:46,340 --> 00:57:50,140
others don't leave him

952
00:57:59,020 --> 00:58:06,610
I please just the microphone perhaps I

953
00:58:03,220 --> 00:58:08,560
did I missed it but you said you were

954
00:58:06,610 --> 00:58:11,290
going to explain why Google has

955
00:58:08,560 --> 00:58:12,549
forgotten about HP KP and I have the

956
00:58:11,290 --> 00:58:14,860
impression that he didn't actually

957
00:58:12,550 --> 00:58:18,520
explain one nobody didn't explain one

958
00:58:14,860 --> 00:58:19,930
it's very cumbersome you can shoot

959
00:58:18,520 --> 00:58:22,420
yourself in the food

960
00:58:19,930 --> 00:58:24,490
if you've certificates are changed and

961
00:58:22,420 --> 00:58:27,400
you don't pay attention to the backup

962
00:58:24,490 --> 00:58:29,589
certificate you can do a ransom hbk

963
00:58:27,400 --> 00:58:32,410
beyond yourself you would block your

964
00:58:29,590 --> 00:58:34,180
users until they forget that pin if

965
00:58:32,410 --> 00:58:36,580
you've made a mistake and then

966
00:58:34,180 --> 00:58:40,120
administrators have no idea how this

967
00:58:36,580 --> 00:58:44,610
works if you took a look at the

968
00:58:40,120 --> 00:58:49,390
configuration for HP KP I can tell you

969
00:58:44,610 --> 00:58:52,900
you will be fearful there's so many

970
00:58:49,390 --> 00:58:55,470
uncertainties people are getting really

971
00:58:52,900 --> 00:58:55,470
confused

972
00:58:56,859 --> 00:59:02,739
very easily so this is nothing was the

973
00:58:59,920 --> 00:59:04,059
best way to manage things they would

974
00:59:02,739 --> 00:59:05,289
probably focus on certificate

975
00:59:04,059 --> 00:59:07,299
transparency which is something I'm

976
00:59:05,289 --> 00:59:11,319
studying right now well it looks much

977
00:59:07,299 --> 00:59:13,059
better it is not a pin but he does solve

978
00:59:11,319 --> 00:59:16,900
one of the main problems with TLS I

979
00:59:13,059 --> 00:59:19,869
think there will be a combination on the

980
00:59:16,900 --> 00:59:23,229
one hand the big ones are not have not

981
00:59:19,869 --> 00:59:27,729
adopted this probably Internet Explorer

982
00:59:23,229 --> 00:59:30,038
will not be doing it our ministry just

983
00:59:27,729 --> 00:59:31,930
don't really understand it it is true

984
00:59:30,039 --> 00:59:35,349
that the system has a number of things

985
00:59:31,930 --> 00:59:37,660
that are quite complicated and it hasn't

986
00:59:35,349 --> 00:59:39,009
worked probably well by the way there's

987
00:59:37,660 --> 00:59:42,009
something else I didn't mention this

988
00:59:39,009 --> 00:59:43,299
this has me reported to Firefox but they

989
00:59:42,009 --> 00:59:47,410
have ignored me completely

990
00:59:43,299 --> 00:59:48,959
okay the email was ignored someone not

991
00:59:47,410 --> 00:59:52,808
even me

992
00:59:48,959 --> 00:59:54,129
published comments in the forum for

993
00:59:52,809 --> 00:59:58,029
Firefox and they didn't seem too

994
00:59:54,130 --> 01:00:00,390
interested in this okay any more

995
00:59:58,029 --> 01:00:00,390
questions

996
01:00:00,610 --> 01:00:04,900
hi good morning first of all

997
01:00:03,160 --> 01:00:07,210
congratulations I really enjoyed your

998
01:00:04,900 --> 01:00:13,780
presentation thank you one question for

999
01:00:07,210 --> 01:00:17,290
me if we use the preload are we safe

1000
01:00:13,780 --> 01:00:19,570
using its HSTs and if there is no

1001
01:00:17,290 --> 01:00:23,380
preload in the other one in HP KP do we

1002
01:00:19,570 --> 01:00:25,830
remove it or was well with preloads it

1003
01:00:23,380 --> 01:00:25,830
should work

1004
01:00:27,290 --> 01:00:33,470
in fact pre-loading is for this to avoid

1005
01:00:31,040 --> 01:00:35,480
this now you have to wonder who has

1006
01:00:33,470 --> 01:00:38,930
preloads and then who implements

1007
01:00:35,480 --> 01:00:42,020
preloads properly in theory prinos has

1008
01:00:38,930 --> 01:00:44,600
to do with two things okay it's not just

1009
01:00:42,020 --> 01:00:46,190
using your preload in your header you

1010
01:00:44,600 --> 01:00:48,680
have to list to be in the list of

1011
01:00:46,190 --> 01:00:52,360
reloading and do the same the two things

1012
01:00:48,680 --> 01:00:55,310
that is so cumbersome so complicated

1013
01:00:52,360 --> 01:00:57,890
they conducted a study there was some

1014
01:00:55,310 --> 01:01:00,200
6,000 cases and less than two thousand

1015
01:00:57,890 --> 01:01:02,930
to do a problem we did it ourselves

1016
01:01:00,200 --> 01:01:04,310
you can see who has been preloaded and

1017
01:01:02,930 --> 01:01:06,379
whether it meets the requirements to be

1018
01:01:04,310 --> 01:01:07,880
pre-loaded and most of them don't

1019
01:01:06,380 --> 01:01:10,880
actually meet the requirements to be

1020
01:01:07,880 --> 01:01:13,160
pre-loaded and the second question on HP

1021
01:01:10,880 --> 01:01:13,790
kb whether we can remove it I don't know

1022
01:01:13,160 --> 01:01:16,129
what you mean

1023
01:01:13,790 --> 01:01:18,710
since it doesn't have a preload what do

1024
01:01:16,130 --> 01:01:20,770
we do you know website do we get rid of

1025
01:01:18,710 --> 01:01:24,380
it straight away

1026
01:01:20,770 --> 01:01:26,810
no one said is it's a bad option if you

1027
01:01:24,380 --> 01:01:28,370
use it properly it's a good thing I

1028
01:01:26,810 --> 01:01:34,450
don't think you should remove it

1029
01:01:28,370 --> 01:01:34,450
altogether and besides

1030
01:01:36,599 --> 01:01:39,989
this is a problem for brasses now

1031
01:01:38,579 --> 01:01:41,939
because they're not implemented properly

1032
01:01:39,989 --> 01:01:45,439
but I cannot see why you should remove

1033
01:01:41,939 --> 01:01:48,390
it if you do if you're using it properly

1034
01:01:45,439 --> 01:01:51,269
but as I say it is very complicated

1035
01:01:48,390 --> 01:01:55,379
perhaps the effort you need to keep a

1036
01:01:51,269 --> 01:01:59,999
safe and healthy HP KP in places doesn't

1037
01:01:55,380 --> 01:02:02,849
pay off so I would probably go to CAA if

1038
01:01:59,999 --> 01:02:04,368
you don't know what CIA is you should

1039
01:02:02,849 --> 01:02:07,949
focus on that is much better

1040
01:02:04,369 --> 01:02:09,929
certificate transparency CAA implies you

1041
01:02:07,949 --> 01:02:13,229
seen something in one of your fields for

1042
01:02:09,929 --> 01:02:16,079
the DNS who your CA is who your favorite

1043
01:02:13,229 --> 01:02:21,299
CA is and that will allow you to be your

1044
01:02:16,079 --> 01:02:23,130
pins on your CA to a make attacks more

1045
01:02:21,299 --> 01:02:26,819
complicated much more complicated but

1046
01:02:23,130 --> 01:02:28,979
now the CAS the issue certificates have

1047
01:02:26,819 --> 01:02:33,299
to go to a DNS to check it not all of

1048
01:02:28,979 --> 01:02:38,098
them do that but if the question is I'm

1049
01:02:33,299 --> 01:02:41,209
at the administrating a website and I

1050
01:02:38,099 --> 01:02:44,969
want to implement HP JP go for CA a

1051
01:02:41,209 --> 01:02:47,939
cleaner safer it's the future and it

1052
01:02:44,969 --> 01:02:51,599
works well thank you there's another

1053
01:02:47,939 --> 01:02:53,928
question down below do you please place

1054
01:02:51,599 --> 01:02:53,929
your hand

1055
01:02:55,830 --> 01:03:00,170
any more questions there's another one

1056
01:02:57,780 --> 01:03:00,170
over there

1057
01:03:00,680 --> 01:03:04,808
hi congratulations for your talk for the

1058
01:03:03,200 --> 01:03:11,259
contents and for the style very

1059
01:03:04,809 --> 01:03:11,260
entertaining well hot topics basically

1060
01:03:11,920 --> 01:03:19,510
all of these attacks you've talked about

1061
01:03:14,630 --> 01:03:19,510
what they wear with plugins like HTTP

1062
01:03:22,140 --> 01:03:26,940
everywhere HTTPS Everywhere I don't

1063
01:03:25,079 --> 01:03:29,700
really know how it works this is what I

1064
01:03:26,940 --> 01:03:32,970
think I would do what I did at the start

1065
01:03:29,700 --> 01:03:36,089
when I looked at the tht I tried to

1066
01:03:32,970 --> 01:03:39,480
force writing something on it and he

1067
01:03:36,089 --> 01:03:41,849
respected it if you're restoring

1068
01:03:39,480 --> 01:03:43,920
something in the database obviously it

1069
01:03:41,849 --> 01:03:46,950
will not work but I don't think it does

1070
01:03:43,920 --> 01:03:49,980
it that way I think what it does is use

1071
01:03:46,950 --> 01:03:53,460
an internal forwarding address

1072
01:03:49,980 --> 01:03:55,499
forwarding if he goes beyond the storage

1073
01:03:53,460 --> 01:03:58,559
system for Firefox it will work properly

1074
01:03:55,499 --> 01:04:01,890
bear in mind we are attacking the system

1075
01:03:58,559 --> 01:04:04,910
itself the storage system itself I don't

1076
01:04:01,890 --> 01:04:08,129
really know how HTTPS Everywhere works

1077
01:04:04,910 --> 01:04:11,180
but there are two ways as I'm doing 307

1078
01:04:08,130 --> 01:04:14,249
on everything which I think makes sense

1079
01:04:11,180 --> 01:04:17,640
what it does is with all requests they

1080
01:04:14,249 --> 01:04:21,988
are rewritten with HTTPS yes it does 307

1081
01:04:17,640 --> 01:04:24,529
live nothing that's a good idea if all

1082
01:04:21,989 --> 01:04:27,410
this and this is what I did at the start

1083
01:04:24,529 --> 01:04:29,819
how about were force on the tht

1084
01:04:27,410 --> 01:04:31,410
everything to go through the HTTP that's

1085
01:04:29,819 --> 01:04:33,890
a bad idea because this is what could

1086
01:04:31,410 --> 01:04:33,890
happen actually

1087
01:04:36,100 --> 01:04:42,150
when they send a question so here with

1088
01:04:39,160 --> 01:04:48,850
the post exploitation module with Sheila

1089
01:04:42,150 --> 01:04:51,300
instead of deleting why not adding you

1090
01:04:48,850 --> 01:04:55,240
raise the service with any burst proxy

1091
01:04:51,300 --> 01:04:57,880
if what you want to do is add things to

1092
01:04:55,240 --> 01:05:01,330
the storage system in the browser you

1093
01:04:57,880 --> 01:05:06,190
will have a problem with Firefox if you

1094
01:05:01,330 --> 01:05:10,180
try to add it it's more complicated it's

1095
01:05:06,190 --> 01:05:15,490
gonna layer it first it uses the layer

1096
01:05:10,180 --> 01:05:22,080
then stores chrome works differently if

1097
01:05:15,490 --> 01:05:24,069
you add to Firefox in real time

1098
01:05:22,080 --> 01:05:28,540
you will have a problem but it's a

1099
01:05:24,070 --> 01:05:30,750
perfectly valid idea it makes sense any

1100
01:05:28,540 --> 01:05:33,910
other questions

1101
01:05:30,750 --> 01:05:36,240
great oh there is the reason question

1102
01:05:33,910 --> 01:05:36,240
over there

1103
01:05:48,369 --> 01:05:53,739
hi very good job thank you so much I

1104
01:05:50,979 --> 01:05:56,279
enjoyed it a lot one question in chrome

1105
01:05:53,739 --> 01:06:07,569
and the desktop version and the attack

1106
01:05:56,279 --> 01:06:09,549
using HP kp/h pkp and when you use when

1107
01:06:07,569 --> 01:06:11,529
you make the browser freeze

1108
01:06:09,549 --> 01:06:13,719
they sit because of the administration

1109
01:06:11,529 --> 01:06:15,759
tools what do you mean in the video you

1110
01:06:13,719 --> 01:06:17,049
have the administration tools no no no I

1111
01:06:15,759 --> 01:06:18,400
just wanted to show you what is

1112
01:06:17,049 --> 01:06:20,049
happening behind the scenes the user

1113
01:06:18,400 --> 01:06:24,569
sees nothing it's absolutely transparent

1114
01:06:20,049 --> 01:06:29,700
bear in mind that you would need to

1115
01:06:24,569 --> 01:06:32,229
press f12 if you have a lot of requests

1116
01:06:29,700 --> 01:06:34,450
with the administration tools and the

1117
01:06:32,229 --> 01:06:37,149
appreciation tools are open it will

1118
01:06:34,450 --> 01:06:40,390
freeze no has nothing to do with it it

1119
01:06:37,150 --> 01:06:41,950
will happen all the time in fact in

1120
01:06:40,390 --> 01:06:44,019
we've done it in the browser

1121
01:06:41,950 --> 01:06:46,410
in a mobile browser and there's no f

1122
01:06:44,019 --> 01:06:46,410
12th

1123
01:06:47,119 --> 01:06:51,099
now we're done thank you so much thank

1124
01:06:49,009 --> 01:06:51,099
you

1125
01:06:51,380 --> 01:06:57,419
[Applause]

