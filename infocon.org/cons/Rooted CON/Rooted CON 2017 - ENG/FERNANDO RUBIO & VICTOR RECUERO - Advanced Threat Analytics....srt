1
00:00:00,000 --> 00:00:05,190
so vamos<font color="#E5E5E5"> a la if you could please go</font>

2
00:00:02,580 --> 00:00:06,629
back to your seats will give a<font color="#CCCCCC"> couple of</font>

3
00:00:05,190 --> 00:00:09,350
<font color="#E5E5E5">minutes to those of you are still</font>

4
00:00:06,629 --> 00:00:09,350
entering the room

5
00:00:18,270 --> 00:00:26,070
well the next<font color="#E5E5E5"> presentation is advanced</font>

6
00:00:22,080 --> 00:00:28,799
threat analytics detection of threads in

7
00:00:26,070 --> 00:00:32,700
the acetone x-ray<font color="#E5E5E5"> fair and on Victor of</font>

8
00:00:28,800 --> 00:00:39,150
the<font color="#E5E5E5"> speakers a really cool content so</font>

9
00:00:32,700 --> 00:00:42,989
yours can you hear us you can hear as

10
00:00:39,150 --> 00:00:48,900
well very<font color="#CCCCCC"> well so good</font><font color="#E5E5E5"> afternoon</font>

11
00:00:42,989 --> 00:00:51,629
everyone we'll talk<font color="#CCCCCC"> about detecting</font>

12
00:00:48,900 --> 00:00:54,690
threats in active directory using a TA a

13
00:00:51,630 --> 00:01:05,850
class right analytics this is fernando

14
00:00:54,690 --> 00:01:09,330
Romeo so here we<font color="#CCCCCC"> go we live in an era of</font>

15
00:01:05,850 --> 00:01:14,310
war<font color="#E5E5E5"> of</font><font color="#CCCCCC"> x from home and are tons of war</font>

16
00:01:09,330 --> 00:01:16,229
it is important to know yourself and you

17
00:01:14,310 --> 00:01:18,270
<font color="#CCCCCC">know the enemy to know all sorts of</font>

18
00:01:16,229 --> 00:01:20,190
things we have the opportunity to listen

19
00:01:18,270 --> 00:01:25,410
to a<font color="#E5E5E5"> beautiful presentation earlier</font>

20
00:01:20,190 --> 00:01:27,600
today by the way cyber war so knowing

21
00:01:25,410 --> 00:01:29,009
ourselves let's<font color="#CCCCCC"> start</font><font color="#E5E5E5"> with that that</font>

22
00:01:27,600 --> 00:01:31,110
means<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we need to know about the</font>

23
00:01:29,009 --> 00:01:34,679
changing environment around us mobile

24
00:01:31,110 --> 00:01:38,130
devices the Internet of Things the cloud

25
00:01:34,679 --> 00:01:42,149
the<font color="#CCCCCC"> environment is changing knowing the</font>

26
00:01:38,130 --> 00:01:44,699
enemy implies knowing what threats we

27
00:01:42,149 --> 00:01:48,240
are facing from our point of view in our

28
00:01:44,700 --> 00:01:52,729
experience in threat detection almost

29
00:01:48,240 --> 00:01:55,429
everyone comes down to goes out to

30
00:01:52,729 --> 00:01:58,820
credential<font color="#CCCCCC"> theft</font>

31
00:01:55,430 --> 00:02:00,320
fishing very few other things so this is

32
00:01:58,820 --> 00:02:02,330
<font color="#CCCCCC">not just about knowing ourselves on</font>

33
00:02:00,320 --> 00:02:04,339
knowing the enemy we need to take into

34
00:02:02,330 --> 00:02:07,280
account<font color="#E5E5E5"> the changes I was taking place</font>

35
00:02:04,340 --> 00:02:09,830
it is not enough with defending your

36
00:02:07,280 --> 00:02:11,810
perimeter we're building a high of oil

37
00:02:09,830 --> 00:02:15,110
or a second wall and we now<font color="#CCCCCC"> have to</font>

38
00:02:11,810 --> 00:02:18,290
protect identities and if we go into the

39
00:02:15,110 --> 00:02:20,810
detail when your call to when you call

40
00:02:18,290 --> 00:02:22,940
nine or so for incident response it's

41
00:02:20,810 --> 00:02:27,470
<font color="#E5E5E5">always the same story someone got a</font>

42
00:02:22,940 --> 00:02:29,930
phishing attempt they click on the

43
00:02:27,470 --> 00:02:32,800
button to install malware whatever it is

44
00:02:29,930 --> 00:02:35,840
and<font color="#E5E5E5"> by the way I'm very pessimistic even</font>

45
00:02:32,800 --> 00:02:37,220
if there wasn't a button that would they

46
00:02:35,840 --> 00:02:39,920
would find our way to have something

47
00:02:37,220 --> 00:02:41,989
installed I<font color="#E5E5E5"> will affect them so you have</font>

48
00:02:39,920 --> 00:02:45,260
one pc compromised they steal

49
00:02:41,989 --> 00:02:49,280
credentials they use a keylogger they

50
00:02:45,260 --> 00:02:50,959
take it<font color="#CCCCCC"> and out of the browsers or local</font>

51
00:02:49,280 --> 00:02:53,200
accounts whatever they want to get<font color="#E5E5E5"> to</font>

52
00:02:50,959 --> 00:02:56,150
someone don't want to go somewhere<font color="#E5E5E5"> else</font>

53
00:02:53,200 --> 00:03:00,190
workstation because they need to get the

54
00:02:56,150 --> 00:03:03,350
workstation that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> minister's domain I</font>

55
00:03:00,190 --> 00:03:07,040
remember reading someone whose goal was

56
00:03:03,350 --> 00:03:10,970
to get<font color="#E5E5E5"> hold of 66 onions</font><font color="#CCCCCC"> okay there are</font>

57
00:03:07,040 --> 00:03:12,679
there are hunting so to say thank you to

58
00:03:10,970 --> 00:03:15,350
the domain controller and from there<font color="#E5E5E5"> you</font>

59
00:03:12,680 --> 00:03:17,180
can control the entire organization take

60
00:03:15,350 --> 00:03:19,579
a look at this an important idea that

61
00:03:17,180 --> 00:03:21,650
<font color="#E5E5E5">comes out of this if therefore we</font>

62
00:03:19,580 --> 00:03:23,870
defended the network perimeter with it

63
00:03:21,650 --> 00:03:25,459
perimeter networks now that we defend

64
00:03:23,870 --> 00:03:27,890
identities we have to do the same thing

65
00:03:25,459 --> 00:03:34,209
so how common is it in your

66
00:03:27,890 --> 00:03:34,208
<font color="#E5E5E5">organization's to do things differently</font>

67
00:03:35,080 --> 00:03:41,660
so what<font color="#CCCCCC"> are we doing we're breaking the</font>

68
00:03:37,700 --> 00:03:43,549
segmentation there is a<font color="#E5E5E5"> zero layer so it</font>

69
00:03:41,660 --> 00:03:45,260
is a domain controllers and anything

70
00:03:43,550 --> 00:03:48,470
above it<font color="#CCCCCC"> you don't use a domain</font>

71
00:03:45,260 --> 00:03:50,780
controller outside<font color="#E5E5E5"> of that layer layer</font>

72
00:03:48,470 --> 00:03:53,630
<font color="#E5E5E5">one with servers with the information</font>

73
00:03:50,780 --> 00:03:57,380
unlaid so we have a<font color="#E5E5E5"> workstations but the</font>

74
00:03:53,630 --> 00:04:03,079
use of the nexus point what lessons that

75
00:03:57,380 --> 00:04:05,230
we learn from<font color="#CCCCCC"> all this but attacks are</font>

76
00:04:03,080 --> 00:04:07,940
getting<font color="#E5E5E5"> increasingly sophisticated</font>

77
00:04:05,230 --> 00:04:10,579
during this conference<font color="#CCCCCC"> unsure you get a</font>

78
00:04:07,940 --> 00:04:13,040
lot of information<font color="#E5E5E5"> about attacks we've</font>

79
00:04:10,580 --> 00:04:16,340
been hearing about this the degree of

80
00:04:13,040 --> 00:04:20,238
sophistication of attacks is higher and

81
00:04:16,339 --> 00:04:24,099
higher what is the target target the

82
00:04:20,238 --> 00:04:27,320
terminus identities citizens of<font color="#E5E5E5"> the tone</font>

83
00:04:24,100 --> 00:04:30,020
<font color="#CCCCCC">that yellow are period which is usually</font>

84
00:04:27,320 --> 00:04:33,469
24 to 48 hours is critical when

85
00:04:30,020 --> 00:04:35,630
protecting identities because this is

86
00:04:33,470 --> 00:04:38,389
where an attacker will try to get

87
00:04:35,630 --> 00:04:39,800
administrator privileges as soon as

88
00:04:38,389 --> 00:04:42,979
they've<font color="#CCCCCC"> got administrator privileges</font>

89
00:04:39,800 --> 00:04:47,240
they can do whatever they want most

90
00:04:42,979 --> 00:04:51,469
attacks go unnoticed so they may remain

91
00:04:47,240 --> 00:04:53,900
in place for 11 or after 12 14<font color="#CCCCCC"> ones it</font>

92
00:04:51,470 --> 00:04:55,760
is<font color="#E5E5E5"> important to take into account what</font>

93
00:04:53,900 --> 00:04:58,280
response plans we<font color="#CCCCCC"> have in place</font><font color="#E5E5E5"> if we</font>

94
00:04:55,760 --> 00:05:00,050
assume<font color="#CCCCCC"> that we can be victims we have to</font>

95
00:04:58,280 --> 00:05:02,830
be on the ready and have<font color="#E5E5E5"> a response</font>

96
00:05:00,050 --> 00:05:05,240
plans in place this is not an<font color="#E5E5E5"> easy task</font>

97
00:05:02,830 --> 00:05:06,830
sometimes this is very costly we don't

98
00:05:05,240 --> 00:05:08,570
<font color="#E5E5E5">know the extent which we have been</font>

99
00:05:06,830 --> 00:05:10,599
compromised and sometimes it is simply

100
00:05:08,570 --> 00:05:10,599
impossible

101
00:05:11,920 --> 00:05:19,030
so if it's<font color="#CCCCCC"> okay with you</font><font color="#E5E5E5"> the first thing</font>

102
00:05:14,200 --> 00:05:24,900
we'll show is the addendum to show how

103
00:05:19,030 --> 00:05:27,909
the attack takes place so we have a lab

104
00:05:24,900 --> 00:05:30,549
where<font color="#CCCCCC"> we will be conducting</font><font color="#E5E5E5"> the demos</font>

105
00:05:27,910 --> 00:05:34,480
for this<font color="#E5E5E5"> presentation very simple three</font>

106
00:05:30,550 --> 00:05:37,960
boxes one the domain controller with the

107
00:05:34,480 --> 00:05:40,960
data<font color="#E5E5E5"> center it's got a central console</font>

108
00:05:37,960 --> 00:05:43,630
and then we have<font color="#CCCCCC"> to work stations to</font>

109
00:05:40,960 --> 00:05:46,989
client workstations from where we will

110
00:05:43,630 --> 00:05:49,150
simulate a number of operations I wanted

111
00:05:46,990 --> 00:05:50,920
<font color="#CCCCCC">to tell you also</font><font color="#E5E5E5"> about the typical</font>

112
00:05:49,150 --> 00:05:52,900
environment that we face when talking

113
00:05:50,920 --> 00:05:55,570
about this cyber defense or the<font color="#E5E5E5"> all</font>

114
00:05:52,900 --> 00:05:58,719
potential<font color="#E5E5E5"> threats that we might face one</font>

115
00:05:55,570 --> 00:06:01,750
of the most common threads there may be

116
00:05:58,720 --> 00:06:05,200
<font color="#E5E5E5">happening millions of times per second</font>

117
00:06:01,750 --> 00:06:07,570
<font color="#CCCCCC">this is scanning attempt someone is</font>

118
00:06:05,200 --> 00:06:09,250
probing our network to find out about it

119
00:06:07,570 --> 00:06:11,950
this is<font color="#CCCCCC"> something that</font><font color="#E5E5E5"> can be detected</font>

120
00:06:09,250 --> 00:06:15,610
in many different ways the goal is to

121
00:06:11,950 --> 00:06:18,340
<font color="#CCCCCC">get a number</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> machine addresses IP</font>

122
00:06:15,610 --> 00:06:21,790
addresses for a number will charge a

123
00:06:18,340 --> 00:06:24,969
transfer to do an FXR transfer from our

124
00:06:21,790 --> 00:06:26,650
<font color="#CCCCCC">DNS server and easy</font><font color="#E5E5E5"> glaceon if we launch</font>

125
00:06:24,970 --> 00:06:29,830
that scanning attempt we've done our

126
00:06:26,650 --> 00:06:31,929
homework we have a area transfer is

127
00:06:29,830 --> 00:06:36,969
protected we<font color="#E5E5E5"> don't allow two answers</font><font color="#CCCCCC"> to</font>

128
00:06:31,930 --> 00:06:38,740
any boxes so in a successful<font color="#E5E5E5"> attempt but</font>

129
00:06:36,970 --> 00:06:40,900
this is a very basics this is what

130
00:06:38,740 --> 00:06:45,550
happens<font color="#CCCCCC"> millions of times per second as</font>

131
00:06:40,900 --> 00:06:47,940
<font color="#E5E5E5">I said</font><font color="#CCCCCC"> before brute force attack a brute</font>

132
00:06:45,550 --> 00:06:51,270
force attack

133
00:06:47,940 --> 00:06:57,000
is about someone<font color="#CCCCCC"> making an attempt to</font>

134
00:06:51,270 --> 00:06:59,700
validate we will try to get access<font color="#E5E5E5"> with</font>

135
00:06:57,000 --> 00:07:01,560
an account with multiple pathways by the

136
00:06:59,700 --> 00:07:03,960
way now<font color="#E5E5E5"> that for another show you the</font>

137
00:07:01,560 --> 00:07:08,310
tool<font color="#E5E5E5"> and this demo will be using a</font>

138
00:07:03,960 --> 00:07:11,669
number of tools lawyers of<font color="#E5E5E5"> Microsoft</font>

139
00:07:08,310 --> 00:07:13,560
don't like us telling anyone anyone on

140
00:07:11,670 --> 00:07:15,630
how to hack windows we will not show you

141
00:07:13,560 --> 00:07:17,400
how to hack windows we will tell you

142
00:07:15,630 --> 00:07:20,520
<font color="#E5E5E5">about friends will tell you about the</font>

143
00:07:17,400 --> 00:07:22,560
procedure underneath the process is

144
00:07:20,520 --> 00:07:23,640
underneath because<font color="#CCCCCC"> we</font><font color="#E5E5E5"> want you to</font>

145
00:07:22,560 --> 00:07:26,280
<font color="#E5E5E5">understand about the fence and</font>

146
00:07:23,640 --> 00:07:28,140
protection but there were certain

147
00:07:26,280 --> 00:07:31,500
processes that have been automated using

148
00:07:28,140 --> 00:07:33,539
scripts and we will not go<font color="#CCCCCC"> down in depth</font>

149
00:07:31,500 --> 00:07:36,780
what you saw in this script is a

150
00:07:33,540 --> 00:07:39,180
function trying to do a simple bind to

151
00:07:36,780 --> 00:07:40,919
an administrator account with 20

152
00:07:39,180 --> 00:07:44,190
attempts for<font color="#E5E5E5"> the impossible to do X</font>

153
00:07:40,920 --> 00:07:47,610
accuses right so we had an attempt using

154
00:07:44,190 --> 00:07:51,420
brute force what else can<font color="#E5E5E5"> we find it is</font>

155
00:07:47,610 --> 00:07:57,090
not always active attacks it is not

156
00:07:51,420 --> 00:07:59,700
always someone trying<font color="#CCCCCC"> to get in the way</font>

157
00:07:57,090 --> 00:08:01,560
sometimes they're just listening waiting

158
00:07:59,700 --> 00:08:06,240
for<font color="#E5E5E5"> us to release information that is</font>

159
00:08:01,560 --> 00:08:09,570
sensitive for example a password<font color="#CCCCCC"> passed</font>

160
00:08:06,240 --> 00:08:13,370
from<font color="#E5E5E5"> one unit to another we if we</font><font color="#CCCCCC"> will</font>

161
00:08:09,570 --> 00:08:17,330
<font color="#E5E5E5">either using an administrator account</font>

162
00:08:13,370 --> 00:08:21,990
<font color="#CCCCCC">user mother password fucker we love that</font>

163
00:08:17,330 --> 00:08:24,150
if that<font color="#E5E5E5"> is the case we would be applying</font>

164
00:08:21,990 --> 00:08:25,590
about them<font color="#E5E5E5"> if I practice or carrying out</font>

165
00:08:24,150 --> 00:08:27,989
about practice because we would be

166
00:08:25,590 --> 00:08:31,409
disseminating or broadcasting sensitive

167
00:08:27,990 --> 00:08:33,479
information we cannot pay attention to

168
00:08:31,410 --> 00:08:35,880
the<font color="#E5E5E5"> event viewer all the time of course</font>

169
00:08:33,479 --> 00:08:39,630
<font color="#E5E5E5">but some we really have to such common</font>

170
00:08:35,880 --> 00:08:42,870
sense p we're not using it as hell ok

171
00:08:39,630 --> 00:08:44,130
this is slack text plain text so that we

172
00:08:42,870 --> 00:08:45,720
<font color="#CCCCCC">are balling inning against the domain</font>

173
00:08:44,130 --> 00:08:47,480
controller or you serve with

174
00:08:45,720 --> 00:08:50,720
administrative privileges

175
00:08:47,480 --> 00:08:54,100
I did this<font color="#CCCCCC"> on purpose otherwise i would</font>

176
00:08:50,720 --> 00:08:56,480
use cameras but in all reviews<font color="#CCCCCC"> they do</font>

177
00:08:54,100 --> 00:08:59,180
there is an<font color="#E5E5E5"> event in the main controls</font>

178
00:08:56,480 --> 00:09:01,639
us every 24 hours telling you the simple

179
00:08:59,180 --> 00:09:03,319
points in plain text<font color="#CCCCCC"> i haven't done</font><font color="#E5E5E5"> a</font>

180
00:09:01,639 --> 00:09:05,240
single<font color="#E5E5E5"> review in 10 years we haven't</font>

181
00:09:03,320 --> 00:09:07,490
seen<font color="#E5E5E5"> that problem if you are the</font>

182
00:09:05,240 --> 00:09:09,470
security<font color="#E5E5E5"> guy in a company's both</font><font color="#CCCCCC"> sim</font>

183
00:09:07,490 --> 00:09:14,019
card<font color="#CCCCCC"> into account is usually VPNs</font>

184
00:09:09,470 --> 00:09:14,019
<font color="#E5E5E5">proxies passwords in plain text</font>

185
00:09:14,350 --> 00:09:18,980
sometimes is as simple as changing

186
00:09:16,160 --> 00:09:22,550
<font color="#E5E5E5">default but anyway I've been</font>

187
00:09:18,980 --> 00:09:24,800
authenticated these are very<font color="#E5E5E5"> basic</font>

188
00:09:22,550 --> 00:09:29,689
threats but if we<font color="#CCCCCC"> go into more serious</font>

189
00:09:24,800 --> 00:09:32,959
things we could see<font color="#CCCCCC"> financial</font><font color="#E5E5E5"> theft</font><font color="#CCCCCC"> okay</font>

190
00:09:29,690 --> 00:09:35,389
or an attempt to steal credentials we

191
00:09:32,959 --> 00:09:37,300
will attempt take and we'll<font color="#E5E5E5"> do it in</font><font color="#CCCCCC"> the</font>

192
00:09:35,389 --> 00:09:44,360
next day month we were still financials

193
00:09:37,300 --> 00:09:48,829
using hash bash this is an attack

194
00:09:44,360 --> 00:09:50,990
technique based on the side of for

195
00:09:48,829 --> 00:09:53,269
validation and<font color="#E5E5E5"> tln doesn't need the</font>

196
00:09:50,990 --> 00:09:55,910
password is only needs a hash the

197
00:09:53,269 --> 00:09:58,760
validation hash if we get hold of that

198
00:09:55,910 --> 00:10:02,149
validation hash we can obtain those

199
00:09:58,760 --> 00:10:05,600
privileges in another box how can we<font color="#E5E5E5"> get</font>

200
00:10:02,149 --> 00:10:08,290
hold of that hash to waste one by going

201
00:10:05,600 --> 00:10:10,910
to the local Sam for that<font color="#E5E5E5"> Windows</font>

202
00:10:08,290 --> 00:10:12,800
computer and getting the hash<font color="#E5E5E5"> that would</font>

203
00:10:10,910 --> 00:10:17,260
be useful<font color="#E5E5E5"> for local accounts we</font>

204
00:10:12,800 --> 00:10:20,810
attacking the local Sam if we have to

205
00:10:17,260 --> 00:10:22,970
work stations with the same account on

206
00:10:20,810 --> 00:10:27,138
<font color="#E5E5E5">the same pathway we could use that just</font>

207
00:10:22,970 --> 00:10:29,540
imagine the typical situation where all

208
00:10:27,139 --> 00:10:33,310
local users are administrators same

209
00:10:29,540 --> 00:10:33,310
account name and same password

210
00:10:33,400 --> 00:10:38,020
if the domain administrator is the same

211
00:10:35,920 --> 00:10:40,930
where you can imagine but getting access

212
00:10:38,020 --> 00:10:42,850
to that hash through the local son we

213
00:10:40,930 --> 00:10:48,640
could reach higher privileges in a very

214
00:10:42,850 --> 00:10:54,580
simple way another option no need<font color="#E5E5E5"> for</font>

215
00:10:48,640 --> 00:10:56,800
the local son la<font color="#CCCCCC"> NSA ESS getting cash</font>

216
00:10:54,580 --> 00:10:58,840
for the use of the<font color="#CCCCCC"> salad into Venus that</font>

217
00:10:56,800 --> 00:11:01,510
machine if the<font color="#CCCCCC"> users an administrator</font>

218
00:10:58,840 --> 00:11:03,360
just imagine the harsh will get by the

219
00:11:01,510 --> 00:11:09,569
way Microsoft has a free tool called

220
00:11:03,360 --> 00:11:13,390
lapse very simple you<font color="#CCCCCC"> distributed to the</font>

221
00:11:09,570 --> 00:11:15,070
different computers and every<font color="#CCCCCC"> end the</font>

222
00:11:13,390 --> 00:11:17,319
number<font color="#E5E5E5"> of days the password will be</font>

223
00:11:15,070 --> 00:11:20,830
changed apart from changing it it

224
00:11:17,320 --> 00:11:23,080
changes it into the active<font color="#E5E5E5"> directory so</font>

225
00:11:20,830 --> 00:11:25,990
you get rid<font color="#E5E5E5"> of that problem with a local</font>

226
00:11:23,080 --> 00:11:28,510
administrator and have<font color="#E5E5E5"> those people when</font>

227
00:11:25,990 --> 00:11:30,370
they log in through a client workstation

228
00:11:28,510 --> 00:11:31,870
they were not usually into the same

229
00:11:30,370 --> 00:11:34,210
username they will use the local

230
00:11:31,870 --> 00:11:35,920
administrator it's not a<font color="#E5E5E5"> stolen that</font>

231
00:11:34,210 --> 00:11:43,360
<font color="#E5E5E5">credential is not valid to access</font>

232
00:11:35,920 --> 00:11:46,270
anything so let's go to the demo as you

233
00:11:43,360 --> 00:11:49,900
see on the<font color="#E5E5E5"> screen what for lenders</font>

234
00:11:46,270 --> 00:11:53,530
showing we have user one if we try to

235
00:11:49,900 --> 00:11:55,660
access the ministry to<font color="#CCCCCC"> resources see</font>

236
00:11:53,530 --> 00:11:58,630
here we will not<font color="#E5E5E5"> be granted an access</font>

237
00:11:55,660 --> 00:12:01,319
now we will still<font color="#E5E5E5"> credentials using such</font>

238
00:11:58,630 --> 00:12:06,250
much I've opened a new<font color="#E5E5E5"> terminal window</font>

239
00:12:01,320 --> 00:12:07,750
here<font color="#CCCCCC"> and i have my higher privileges i'm</font>

240
00:12:06,250 --> 00:12:10,780
still<font color="#E5E5E5"> use of one but if i go</font><font color="#CCCCCC"> to the</font>

241
00:12:07,750 --> 00:12:14,560
administrative resource i do have access

242
00:12:10,780 --> 00:12:17,380
to the domain controller my privilege is

243
00:12:14,560 --> 00:12:20,290
not higher now remember<font color="#CCCCCC"> that period 24</font>

244
00:12:17,380 --> 00:12:24,760
to 48 hours<font color="#E5E5E5"> after that I can do whatever</font>

245
00:12:20,290 --> 00:12:29,610
I like anything doing<font color="#CCCCCC"> a back up</font><font color="#E5E5E5"> getting</font>

246
00:12:24,760 --> 00:12:32,260
rid<font color="#CCCCCC"> o deleting uses adding new users</font>

247
00:12:29,610 --> 00:12:35,380
this is our daily<font color="#CCCCCC"> practice is what we</font>

248
00:12:32,260 --> 00:12:37,870
see every single day seems like a funny

249
00:12:35,380 --> 00:12:39,520
thing to do put some<font color="#E5E5E5"> believers you may</font>

250
00:12:37,870 --> 00:12:41,790
believe us when we're doing<font color="#CCCCCC"> Siddhant</font>

251
00:12:39,520 --> 00:12:44,710
responses the type of issues we find

252
00:12:41,790 --> 00:12:46,449
there's a 20-17 I don't know about your

253
00:12:44,710 --> 00:12:49,990
<font color="#CCCCCC">companies but in most companies we see</font>

254
00:12:46,450 --> 00:12:53,230
<font color="#E5E5E5">this is what we</font><font color="#CCCCCC"> have to avoid</font><font color="#E5E5E5"> okay it</font>

255
00:12:49,990 --> 00:12:54,670
sounds like a joke because it is such an

256
00:12:53,230 --> 00:12:58,270
old<font color="#E5E5E5"> technique that this is what most</font>

257
00:12:54,670 --> 00:13:00,910
companies are facing right now so what

258
00:12:58,270 --> 00:13:03,100
<font color="#CCCCCC">are we suggesting for detection here's</font>

259
00:13:00,910 --> 00:13:06,430
<font color="#E5E5E5">when we start talking about</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> TA</font>

260
00:13:03,100 --> 00:13:08,290
advanced threat analytics this is the

261
00:13:06,430 --> 00:13:13,060
tool that will be in charge<font color="#CCCCCC"> of detecting</font>

262
00:13:08,290 --> 00:13:14,949
things of course this is a cybersecurity

263
00:13:13,060 --> 00:13:16,599
reference architecture not<font color="#CCCCCC"> the only</font>

264
00:13:14,950 --> 00:13:18,940
product of course this other things

265
00:13:16,600 --> 00:13:20,590
there you have the entire model<font color="#CCCCCC"> atas</font>

266
00:13:18,940 --> 00:13:23,200
<font color="#E5E5E5">here in two places on the one hand</font>

267
00:13:20,590 --> 00:13:25,030
<font color="#E5E5E5">you've got in on the identity side just</font>

268
00:13:23,200 --> 00:13:26,650
<font color="#E5E5E5">next to</font><font color="#CCCCCC"> the arcade directory it only</font>

269
00:13:25,030 --> 00:13:29,530
makes sense if we use Active Directory

270
00:13:26,650 --> 00:13:32,890
this is for detecting threats on active

271
00:13:29,530 --> 00:13:36,250
directory and then that's all suck it is

272
00:13:32,890 --> 00:13:38,980
<font color="#CCCCCC">integrated perfectly there and then when</font>

273
00:13:36,250 --> 00:13:43,810
<font color="#CCCCCC">we see how to use it you see how it</font>

274
00:13:38,980 --> 00:13:45,850
makes<font color="#CCCCCC"> sense so what</font><font color="#E5E5E5"> is it exactly this</font>

275
00:13:43,810 --> 00:13:49,089
is an on-premise tool<font color="#E5E5E5"> okay this is not</font>

276
00:13:45,850 --> 00:13:50,770
in the cloud if you have<font color="#E5E5E5"> everything in</font>

277
00:13:49,090 --> 00:13:52,630
the<font color="#E5E5E5"> cloud obviously you can set it up in</font>

278
00:13:50,770 --> 00:13:54,189
the cloud just look at<font color="#E5E5E5"> as another</font>

279
00:13:52,630 --> 00:13:59,050
virtual machine it works in two ways

280
00:13:54,190 --> 00:14:00,760
<font color="#E5E5E5">okay it does machine learning exactly us</font>

281
00:13:59,050 --> 00:14:02,740
are they do with credit cards if you

282
00:14:00,760 --> 00:14:04,510
<font color="#E5E5E5">spend 50 euros with your carrycot in</font>

283
00:14:02,740 --> 00:14:07,420
Madrid and suddenly user you start

284
00:14:04,510 --> 00:14:09,160
spending millions in Las<font color="#CCCCCC"> Vegas it's</font>

285
00:14:07,420 --> 00:14:12,849
quite likely<font color="#CCCCCC"> there is not me what is the</font>

286
00:14:09,160 --> 00:14:15,610
same philosophy if<font color="#E5E5E5"> it if Jack logs in</font>

287
00:14:12,850 --> 00:14:17,470
through the same computer accessing the

288
00:14:15,610 --> 00:14:19,210
same resources and suddenly they start

289
00:14:17,470 --> 00:14:21,940
connecting to two hundred service that

290
00:14:19,210 --> 00:14:23,200
is not only<font color="#E5E5E5"> the</font><font color="#CCCCCC"> second thing is those</font>

291
00:14:21,940 --> 00:14:25,210
<font color="#E5E5E5">things</font><font color="#CCCCCC"> that are detected in a</font>

292
00:14:23,200 --> 00:14:27,840
deterministic way that's hash hash how

293
00:14:25,210 --> 00:14:31,300
can it be detected well you say one

294
00:14:27,840 --> 00:14:33,310
loudoun if<font color="#E5E5E5"> I did</font><font color="#CCCCCC"> run</font><font color="#E5E5E5"> us who have a log</font>

295
00:14:31,300 --> 00:14:35,949
on we have a log on of an administrator

296
00:14:33,310 --> 00:14:38,410
I don't see them a<font color="#E5E5E5"> CEO authentication</font>

297
00:14:35,950 --> 00:14:39,290
etl em with a connection<font color="#E5E5E5"> centers if it</font>

298
00:14:38,410 --> 00:14:42,110
was an administrator

299
00:14:39,290 --> 00:14:44,930
this is not normal huh / from day one

300
00:14:42,110 --> 00:14:47,779
this gets detected the good thing<font color="#CCCCCC"> that</font>

301
00:14:44,930 --> 00:14:49,810
it works this way is that machine

302
00:14:47,779 --> 00:14:52,070
learning generates less false positives

303
00:14:49,810 --> 00:15:00,018
false positives are a<font color="#CCCCCC"> problem with these</font>

304
00:14:52,070 --> 00:15:02,240
tools here we have a list<font color="#E5E5E5"> of the</font>

305
00:15:00,019 --> 00:15:07,069
strengths that can be detected by this

306
00:15:02,240 --> 00:15:08,930
version of 88 threads is all attacks get

307
00:15:07,069 --> 00:15:11,509
more and more<font color="#CCCCCC"> sophisticated so new</font>

308
00:15:08,930 --> 00:15:14,719
<font color="#E5E5E5">threats come along they will get added</font>

309
00:15:11,509 --> 00:15:17,589
<font color="#E5E5E5">to the product and there are maybe</font>

310
00:15:14,720 --> 00:15:22,130
forming blocks or categories of friends

311
00:15:17,589 --> 00:15:24,019
abnormal resource use us what work

312
00:15:22,130 --> 00:15:26,439
Fernando said someone accessing a

313
00:15:24,019 --> 00:15:30,709
resource for which they have no access

314
00:15:26,440 --> 00:15:32,600
and then scanning<font color="#CCCCCC"> intense what we saw</font>

315
00:15:30,709 --> 00:15:34,810
before if someone tries to obtain

316
00:15:32,600 --> 00:15:41,079
information and is unable to<font color="#CCCCCC"> do service</font>

317
00:15:34,810 --> 00:15:46,250
and then attempt to steal credentials

318
00:15:41,079 --> 00:15:48,769
and then malpractice in configuration in

319
00:15:46,250 --> 00:15:53,779
security configuration for example

320
00:15:48,769 --> 00:15:57,319
violation using plain text exchanging

321
00:15:53,779 --> 00:16:00,439
passwords in claim tasted so how does

322
00:15:57,319 --> 00:16:01,790
that work but<font color="#E5E5E5"> first of all this is</font><font color="#CCCCCC"> not</font>

323
00:16:00,440 --> 00:16:03,110
something you put up to the<font color="#CCCCCC"> domain</font>

324
00:16:01,790 --> 00:16:05,510
<font color="#CCCCCC">controller level we're monitoring the</font>

325
00:16:03,110 --> 00:16:07,040
<font color="#CCCCCC">network what I really like about this is</font>

326
00:16:05,510 --> 00:16:09,680
two<font color="#E5E5E5"> things first is living and it won't</font>

327
00:16:07,040 --> 00:16:12,260
never tells you lies there are lots<font color="#E5E5E5"> of</font>

328
00:16:09,680 --> 00:16:14,180
tools of monitor events yeah the problem

329
00:16:12,260 --> 00:16:17,029
with events is that they can be

330
00:16:14,180 --> 00:16:20,750
deceitful I can send whatever<font color="#E5E5E5"> events I</font>

331
00:16:17,029 --> 00:16:22,569
like if I become administrator in fact

332
00:16:20,750 --> 00:16:26,149
people in the active a nice treat me

333
00:16:22,569 --> 00:16:27,860
don't need to know but<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> you do have</font>

334
00:16:26,149 --> 00:16:30,050
to talk to<font color="#E5E5E5"> you the guys over</font><font color="#CCCCCC"> at</font>

335
00:16:27,860 --> 00:16:31,699
communication because you want to<font color="#E5E5E5"> listen</font>

336
00:16:30,050 --> 00:16:33,620
<font color="#CCCCCC">to that traffic they need to</font><font color="#E5E5E5"> know me</font>

337
00:16:31,699 --> 00:16:34,849
from<font color="#E5E5E5"> then on you can do lots of things</font>

338
00:16:33,620 --> 00:16:38,120
for example<font color="#E5E5E5"> in Windows the</font>

339
00:16:34,850 --> 00:16:40,819
authentication is cameras even<font color="#CCCCCC"> all</font><font color="#E5E5E5"> ntlm</font>

340
00:16:38,120 --> 00:16:42,860
the cameras something is coded but who

341
00:16:40,819 --> 00:16:44,839
is the use of our meeting what resources

342
00:16:42,860 --> 00:16:46,540
are they accessing from what time box

343
00:16:44,839 --> 00:16:48,220
well

344
00:16:46,540 --> 00:16:52,680
<font color="#E5E5E5">thanks by looking but meeting at the</font>

345
00:16:48,220 --> 00:16:56,110
tear the network traffic it works

346
00:16:52,680 --> 00:16:58,030
encrypted our<font color="#E5E5E5"> PC using the MTL</font><font color="#CCCCCC"> LTM so</font>

347
00:16:56,110 --> 00:16:59,410
that server is validating someone but we

348
00:16:58,030 --> 00:17:01,689
don't know who<font color="#CCCCCC"> is validating from what</font>

349
00:16:59,410 --> 00:17:05,139
client and so on<font color="#E5E5E5"> and so forth for that</font>

350
00:17:01,690 --> 00:17:06,960
we also take event viewers we can<font color="#E5E5E5"> take</font>

351
00:17:05,140 --> 00:17:10,780
them from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> domain consoles at seven</font>

352
00:17:06,960 --> 00:17:13,930
if you have a<font color="#CCCCCC"> CM you can forward events</font>

353
00:17:10,780 --> 00:17:16,349
from<font color="#CCCCCC"> cm to this tool since we're talking</font>

354
00:17:13,930 --> 00:17:19,540
about CM because the<font color="#E5E5E5"> other way around</font>

355
00:17:16,349 --> 00:17:24,250
this will generate alerts so we can

356
00:17:19,540 --> 00:17:25,750
forward it to see every important idea

357
00:17:24,250 --> 00:17:28,450
is that we don't install anything of the

358
00:17:25,750 --> 00:17:31,870
domain controllers in active directory

359
00:17:28,450 --> 00:17:35,820
no need<font color="#E5E5E5"> to know anything but that if a</font>

360
00:17:31,870 --> 00:17:39,639
domain was consulted was compromised

361
00:17:35,820 --> 00:17:41,740
they don't know<font color="#CCCCCC"> that we are senior you</font>

362
00:17:39,640 --> 00:17:43,540
think if they know we've noticed their

363
00:17:41,740 --> 00:17:44,980
format machines the reform of machines

364
00:17:43,540 --> 00:17:51,879
in this case the machine is not<font color="#E5E5E5"> in the</font>

365
00:17:44,980 --> 00:17:54,010
domain this is the first thing<font color="#CCCCCC"> okay</font>

366
00:17:51,880 --> 00:18:00,160
sorry i was mentioning the few previous

367
00:17:54,010 --> 00:18:02,379
life and then abnormal use it needs to

368
00:18:00,160 --> 00:18:07,270
learn and it needs three weeks why weeks

369
00:18:02,380 --> 00:18:10,420
well usually are our users behave the

370
00:18:07,270 --> 00:18:14,200
same<font color="#E5E5E5"> on mondays or wednesdays but not on</font>

371
00:18:10,420 --> 00:18:17,710
those two days so it learns for three

372
00:18:14,200 --> 00:18:20,350
weeks that doesn't mean early<font color="#CCCCCC"> learned</font>

373
00:18:17,710 --> 00:18:22,240
forever whatever<font color="#E5E5E5"> was no longer whatever</font>

374
00:18:20,350 --> 00:18:24,459
no is abnormal can go the other way

375
00:18:22,240 --> 00:18:27,100
around<font color="#CCCCCC"> a typical carry example is a user</font>

376
00:18:24,460 --> 00:18:28,750
that<font color="#CCCCCC"> has been</font><font color="#E5E5E5"> dedicated to another</font>

377
00:18:27,100 --> 00:18:31,510
department or start something from the

378
00:18:28,750 --> 00:18:34,690
world well they will<font color="#E5E5E5"> be detected because</font>

379
00:18:31,510 --> 00:18:37,240
they will have in theory abnormal

380
00:18:34,690 --> 00:18:40,150
behavior but it ignores abnormal

381
00:18:37,240 --> 00:18:42,340
behavior there are some others that<font color="#CCCCCC"> the</font>

382
00:18:40,150 --> 00:18:45,010
system which we need to learn about for

383
00:18:42,340 --> 00:18:48,610
21 days the enemy day there will be

384
00:18:45,010 --> 00:18:51,840
correlations the system<font color="#E5E5E5"> will not tell us</font>

385
00:18:48,610 --> 00:18:53,620
that the user is accessing one resource

386
00:18:51,840 --> 00:18:55,149
another capacity in other

387
00:18:53,620 --> 00:18:58,239
functionalities we see that all<font color="#CCCCCC"> users</font>

388
00:18:55,150 --> 00:18:59,530
<font color="#CCCCCC">are very similar profile there isn't</font>

389
00:18:58,240 --> 00:19:01,930
anyone<font color="#E5E5E5"> accessing</font><font color="#CCCCCC"> fans</font>

390
00:18:59,530 --> 00:19:04,450
resources whenever we have a new user<font color="#E5E5E5"> if</font>

391
00:19:01,930 --> 00:19:07,450
they<font color="#E5E5E5"> start behaving that way it can be</font>

392
00:19:04,450 --> 00:19:10,450
detected to know how everyone<font color="#E5E5E5"> is</font>

393
00:19:07,450 --> 00:19:12,280
behaving<font color="#CCCCCC"> parts embeddable</font><font color="#E5E5E5"> aqui por lo</font>

394
00:19:10,450 --> 00:19:16,180
vemos en la en la propia consult Otis

395
00:19:12,280 --> 00:19:17,500
repress tomato<font color="#CCCCCC"> raton mal redondo</font>

396
00:19:16,180 --> 00:19:19,720
recordar que seamos reconocimiento

397
00:19:17,500 --> 00:19:22,060
dedenne SI y SI no es una fuerza bruta

398
00:19:19,720 --> 00:19:23,500
scene tape or le<font color="#CCCCCC"> D'Ablo hicimos un sin</font>

399
00:19:22,060 --> 00:19:27,310
perdon que funciona y por último<font color="#CCCCCC"> el</font>

400
00:19:23,500 --> 00:19:30,570
possesses saber como aparecido ESO te es

401
00:19:27,310 --> 00:19:35,500
cuidar clean le hago sudafed o algo de

402
00:19:30,570 --> 00:19:40,210
vacaciones horse a<font color="#CCCCCC"> verb ante de complete</font>

403
00:19:35,500 --> 00:19:42,820
a game assateague male<font color="#CCCCCC"> jaros tito becca</font>

404
00:19:40,210 --> 00:19:44,770
vamos an astro cliente uno es<font color="#E5E5E5"> ten</font>

405
00:19:42,820 --> 00:19:47,139
oppressed el desperado allen SI lo

406
00:19:44,770 --> 00:19:52,060
tenemos a ver que entiendo que me gusta

407
00:19:47,140 --> 00:19:58,320
messiest entiendo guna party sees our

408
00:19:52,060 --> 00:19:58,320
API console<font color="#E5E5E5"> i</font><font color="#CCCCCC"> whistle</font><font color="#E5E5E5"> to very quickly so</font>

409
00:19:58,470 --> 00:20:05,530
so the<font color="#E5E5E5"> first thing that</font><font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> show</font>

410
00:20:00,790 --> 00:20:07,920
<font color="#E5E5E5">you the timeline which is timelines</font>

411
00:20:05,530 --> 00:20:11,290
where these threads have been generated

412
00:20:07,920 --> 00:20:14,260
<font color="#E5E5E5">now DC activities that we did before</font>

413
00:20:11,290 --> 00:20:18,550
recognition attack through<font color="#CCCCCC"> DNS twist</font>

414
00:20:14,260 --> 00:20:23,860
<font color="#CCCCCC">force attack exchange so password in</font>

415
00:20:18,550 --> 00:20:25,899
plain text with tone identities so

416
00:20:23,860 --> 00:20:29,500
timeline is savage chrono

417
00:20:25,900 --> 00:20:32,170
chronologically so here<font color="#E5E5E5"> DC's arranged</font>

418
00:20:29,500 --> 00:20:34,150
spiked collars so these colors are very

419
00:20:32,170 --> 00:20:36,310
obvious<font color="#E5E5E5"> it's SS about possibilities</font>

420
00:20:34,150 --> 00:20:40,960
threats and bread tells us about the

421
00:20:36,310 --> 00:20:43,899
level<font color="#E5E5E5"> of criticality so these two also</font>

422
00:20:40,960 --> 00:20:46,060
helps identify false positives Oh asked

423
00:20:43,900 --> 00:20:48,190
us about that either go to DNS free

424
00:20:46,060 --> 00:20:50,440
cognition the first thing that asks in

425
00:20:48,190 --> 00:20:53,260
me it's are you sure that this is not

426
00:20:50,440 --> 00:20:56,980
one of your<font color="#E5E5E5"> DNS servers who are you sure</font>

427
00:20:53,260 --> 00:20:59,650
that this is not a machine from what you

428
00:20:56,980 --> 00:21:02,470
<font color="#CCCCCC">are doing scanning while the answer is</font>

429
00:20:59,650 --> 00:21:06,330
no we are foolish so it gives us so much

430
00:21:02,470 --> 00:21:11,740
information in a very simple manner if I

431
00:21:06,330 --> 00:21:12,879
go here I'll see data and I can<font color="#E5E5E5"> open</font>

432
00:21:11,740 --> 00:21:15,610
that

433
00:21:12,880 --> 00:21:19,390
here I see<font color="#CCCCCC"> lots of intuitive information</font>

434
00:21:15,610 --> 00:21:22,090
about the accounts suspicious activities

435
00:21:19,390 --> 00:21:25,240
that is to say an exclusive timeline in

436
00:21:22,090 --> 00:21:27,040
all the activities that<font color="#CCCCCC"> I have been</font>

437
00:21:25,240 --> 00:21:30,840
<font color="#E5E5E5">carried out from these equipments and</font>

438
00:21:27,040 --> 00:21:33,820
also what<font color="#E5E5E5"> Fernando told us about</font>

439
00:21:30,840 --> 00:21:37,030
<font color="#E5E5E5">contextualizing threats or detention if</font>

440
00:21:33,820 --> 00:21:39,460
I did<font color="#E5E5E5"> 20 attempts of brute force it is</font>

441
00:21:37,030 --> 00:21:41,889
not that I have 20 different entries but

442
00:21:39,460 --> 00:21:44,680
I have just one entry on the timeline

443
00:21:41,890 --> 00:21:48,010
selenium of those 20 attempts actually

444
00:21:44,680 --> 00:21:50,680
notice that there are 21 so there<font color="#CCCCCC"> is an</font>

445
00:21:48,010 --> 00:21:53,830
extra one because weed is our validation

446
00:21:50,680 --> 00:21:55,540
and here it<font color="#E5E5E5"> also recommends us what to</font>

447
00:21:53,830 --> 00:21:57,760
do sometimes recommendations have

448
00:21:55,540 --> 00:22:00,310
<font color="#E5E5E5">service specific I'm sure that this has</font>

449
00:21:57,760 --> 00:22:03,010
happened to<font color="#E5E5E5"> these another self careful</font>

450
00:22:00,310 --> 00:22:05,679
research these equipments or these

451
00:22:03,010 --> 00:22:08,260
accounts who carry out any corrective

452
00:22:05,680 --> 00:22:10,990
actions for that in the<font color="#E5E5E5"> case of zns</font>

453
00:22:08,260 --> 00:22:13,330
precognition it has want us about that

454
00:22:10,990 --> 00:22:15,940
even if we did not succeed in doing that

455
00:22:13,330 --> 00:22:18,520
and then in terms of these attempts

456
00:22:15,940 --> 00:22:20,650
brute force it<font color="#CCCCCC"> has sometimes</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> is</font>

457
00:22:18,520 --> 00:22:24,190
telling us<font color="#E5E5E5"> that the password has been</font>

458
00:22:20,650 --> 00:22:27,790
contained and that has<font color="#CCCCCC"> been validated</font><font color="#E5E5E5"> on</font>

459
00:22:24,190 --> 00:22:30,730
plain text so I like it here<font color="#E5E5E5"> because he</font>

460
00:22:27,790 --> 00:22:34,120
says s and then assessing green and

461
00:22:30,730 --> 00:22:36,010
indeed this time we have<font color="#E5E5E5"> jello not very</font>

462
00:22:34,120 --> 00:22:37,989
very not highly highly critical<font color="#CCCCCC"> but</font>

463
00:22:36,010 --> 00:22:40,210
itself me I<font color="#E5E5E5"> mean researching this</font>

464
00:22:37,990 --> 00:22:43,270
because it's critical because he belongs

465
00:22:40,210 --> 00:22:46,150
two domains admins and here I see lots

466
00:22:43,270 --> 00:22:48,190
of<font color="#E5E5E5"> information about the criticality so</font>

467
00:22:46,150 --> 00:22:51,850
<font color="#E5E5E5">therefore its service it for me to move</font>

468
00:22:48,190 --> 00:22:55,030
around to get more information sobre su

469
00:22:51,850 --> 00:22:57,959
sitar the exchange of traditional in

470
00:22:55,030 --> 00:23:01,000
plain text on here is stealing all<font color="#E5E5E5"> my</font>

471
00:22:57,960 --> 00:23:03,430
credentials and this is<font color="#E5E5E5"> not telling</font><font color="#CCCCCC"> me</font>

472
00:23:01,000 --> 00:23:06,790
these may be the<font color="#E5E5E5"> case no it is</font><font color="#CCCCCC"> Felicia</font>

473
00:23:03,430 --> 00:23:08,860
it cannot identify what the

474
00:23:06,790 --> 00:23:12,909
administrator<font color="#E5E5E5"> Hodge has been obtained</font>

475
00:23:08,860 --> 00:23:16,689
but we did in our demo was to attack me

476
00:23:12,910 --> 00:23:20,580
look at some of<font color="#E5E5E5"> team through an account</font>

477
00:23:16,690 --> 00:23:23,470
whose password it may be in a different

478
00:23:20,580 --> 00:23:26,139
machine so therefore<font color="#CCCCCC"> we have obtained</font>

479
00:23:23,470 --> 00:23:28,240
this value this operation

480
00:23:26,140 --> 00:23:30,970
has been local no traffic has been

481
00:23:28,240 --> 00:23:32,230
generated<font color="#E5E5E5"> 88 does not come with doesn't</font>

482
00:23:30,970 --> 00:23:34,450
know what that information comes from

483
00:23:32,230 --> 00:23:40,570
but those first year that someone is

484
00:23:34,450 --> 00:23:45,510
using and privileges so well now we<font color="#CCCCCC"> have</font>

485
00:23:40,570 --> 00:23:45,510
more time for more time for more demos

486
00:23:46,290 --> 00:23:55,750
so this is very easy to set up as any

487
00:23:51,100 --> 00:24:00,340
Microsoft tools this is a component we

488
00:23:55,750 --> 00:24:03,220
bought these two years ago so what<font color="#CCCCCC"> can</font>

489
00:24:00,340 --> 00:24:07,750
you set up well there is an architecture

490
00:24:03,220 --> 00:24:10,630
here<font color="#E5E5E5"> allows you to have 7 6 and then</font>

491
00:24:07,750 --> 00:24:13,390
says<font color="#CCCCCC"> ok give me a new set account so</font>

492
00:24:10,630 --> 00:24:15,160
that I have a list of all the users then

493
00:24:13,390 --> 00:24:17,410
it sells me about the events tell me

494
00:24:15,160 --> 00:24:19,690
where you are going to<font color="#E5E5E5"> sell it from from</font>

495
00:24:17,410 --> 00:24:22,180
<font color="#E5E5E5">the</font><font color="#CCCCCC"> controller's of CM controllers and</font>

496
00:24:19,690 --> 00:24:24,370
then it asked me to define a honey token

497
00:24:22,180 --> 00:24:26,020
<font color="#E5E5E5">that is to say</font><font color="#CCCCCC"> a juicer that we</font><font color="#E5E5E5"> don't</font>

498
00:24:24,370 --> 00:24:29,979
use for anything else we refer<font color="#CCCCCC"> to it as</font>

499
00:24:26,020 --> 00:24:32,170
<font color="#E5E5E5">superuser and say we're generating</font>

500
00:24:29,980 --> 00:24:35,560
alerts whenever minutes<font color="#E5E5E5"> then we also</font>

501
00:24:32,170 --> 00:24:37,960
have exclusions so if<font color="#E5E5E5"> we have a machine</font>

502
00:24:35,560 --> 00:24:40,000
on<font color="#E5E5E5"> Nexus we can't exclude it because we</font>

503
00:24:37,960 --> 00:24:42,940
just wanted to recognize the NSA all the

504
00:24:40,000 --> 00:24:45,550
time and then we<font color="#E5E5E5"> figured pass we may</font>

505
00:24:42,940 --> 00:24:47,590
have positives false positives so

506
00:24:45,550 --> 00:24:50,409
<font color="#CCCCCC">therefore we have the</font><font color="#E5E5E5"> option to say</font>

507
00:24:47,590 --> 00:24:52,629
leave it out and<font color="#CCCCCC"> then by the demo and</font>

508
00:24:50,410 --> 00:24:55,540
show you how<font color="#CCCCCC"> to detect acts and then</font><font color="#E5E5E5"> I</font>

509
00:24:52,630 --> 00:24:58,360
can tell you about the email server will

510
00:24:55,540 --> 00:25:00,430
cease not to<font color="#CCCCCC"> recent alerts and defeat</font>

511
00:24:58,360 --> 00:25:02,740
this is as much self<font color="#CCCCCC"> setup that you have</font>

512
00:25:00,430 --> 00:25:05,080
to do but<font color="#E5E5E5"> it's most difficult for this</font>

513
00:25:02,740 --> 00:25:08,020
product<font color="#E5E5E5"> is to tell to production people</font>

514
00:25:05,080 --> 00:25:10,659
that they have to double the traffic on

515
00:25:08,020 --> 00:25:13,870
switches and what does the as much work

516
00:25:10,660 --> 00:25:18,270
as you have to do all<font color="#E5E5E5"> right nadoo super</font>

517
00:25:13,870 --> 00:25:18,270
<font color="#CCCCCC">dusa we try Holly talking now</font>

518
00:25:25,690 --> 00:25:34,769
and I tell<font color="#E5E5E5"> you</font><font color="#CCCCCC"> more as this will tell</font>

519
00:25:32,080 --> 00:25:40,990
you<font color="#CCCCCC"> how about other attacks holding key</font>

520
00:25:34,769 --> 00:25:44,230
ticket has Simon<font color="#CCCCCC"> keys golden ticket</font>

521
00:25:40,990 --> 00:25:46,470
Simon<font color="#E5E5E5"> chicas golden tickets and skeleton</font>

522
00:25:44,230 --> 00:25:46,470
key

523
00:25:56,230 --> 00:26:09,980
so after juicer juicer collins CO left

524
00:26:03,429 --> 00:26:18,620
<font color="#CCCCCC">thank you album so</font><font color="#E5E5E5"> because we don't know</font>

525
00:26:09,980 --> 00:26:21,490
we just<font color="#E5E5E5"> enter super do so so so very</font>

526
00:26:18,620 --> 00:26:21,489
quickly

527
00:26:25,890 --> 00:26:32,610
so Claire fetes this is well this<font color="#E5E5E5"> is</font>

528
00:26:29,790 --> 00:26:35,100
<font color="#CCCCCC">made up of three phases not from the</font>

529
00:26:32,610 --> 00:26:38,879
user logs on and then play the reserve

530
00:26:35,100 --> 00:26:43,770
this come out of<font color="#E5E5E5"> sleep password one is</font>

531
00:26:38,880 --> 00:26:47,280
nice based on our CDs and a que es if

532
00:26:43,770 --> 00:26:49,800
your domain is<font color="#CCCCCC"> 2000 a and you have nots</font>

533
00:26:47,280 --> 00:26:52,800
enabled it do you have only three and

534
00:26:49,800 --> 00:26:55,230
then from those derivatives after<font color="#E5E5E5"> level</font>

535
00:26:52,800 --> 00:26:57,840
it goes to the main control and then it

536
00:26:55,230 --> 00:27:00,990
says I want to validate and then we will

537
00:26:57,840 --> 00:27:04,230
<font color="#E5E5E5">have</font><font color="#CCCCCC"> okay RCS support and then I said I</font>

538
00:27:00,990 --> 00:27:07,820
need validation and because wealth<font color="#E5E5E5"> do</font>

539
00:27:04,230 --> 00:27:12,270
they decide<font color="#E5E5E5"> to use a s and then the</font>

540
00:27:07,820 --> 00:27:14,659
clients encrypts the hour and then the

541
00:27:12,270 --> 00:27:17,040
other does the<font color="#E5E5E5"> opposite okay i</font>

542
00:27:14,660 --> 00:27:19,590
deciphered and then I get the right time

543
00:27:17,040 --> 00:27:21,420
handle a tissue and then I give<font color="#CCCCCC"> you a</font>

544
00:27:19,590 --> 00:27:23,459
ticket they figure the<font color="#CCCCCC"> grants in secret</font>

545
00:27:21,420 --> 00:27:26,070
that allows you<font color="#CCCCCC"> to get other tickets and</font>

546
00:27:23,460 --> 00:27:28,110
then it also tells you about the probe

547
00:27:26,070 --> 00:27:29,970
to belong to and the privileges as you

548
00:27:28,110 --> 00:27:32,100
have to use<font color="#CCCCCC"> that that's it but cannot</font>

549
00:27:29,970 --> 00:27:34,080
see the contents of the ticket because

550
00:27:32,100 --> 00:27:38,100
it is encrypted and it is signed with

551
00:27:34,080 --> 00:27:40,889
the hash of an account it looks it

552
00:27:38,100 --> 00:27:43,290
appears as a disabled accounts but it is

553
00:27:40,890 --> 00:27:45,240
used by<font color="#CCCCCC"> cabelas then I try</font><font color="#E5E5E5"> to connect to</font>

554
00:27:43,290 --> 00:27:48,149
a server of the internet access for a

555
00:27:45,240 --> 00:27:50,880
one you need require authentication and

556
00:27:48,150 --> 00:27:53,910
then I want<font color="#CCCCCC"> to get mike rivera stickers</font>

557
00:27:50,880 --> 00:27:55,980
and then<font color="#E5E5E5"> i get these blended tickets i</font>

558
00:27:53,910 --> 00:27:58,590
show it and<font color="#CCCCCC"> i said</font><font color="#E5E5E5"> i want to do this a</font>

559
00:27:55,980 --> 00:28:00,240
domain control and trips ish validate

560
00:27:58,590 --> 00:28:02,220
Who I am and then it gives me the<font color="#E5E5E5"> same</font>

561
00:28:00,240 --> 00:28:04,950
trigger but it's an encrypted with a

562
00:28:02,220 --> 00:28:07,050
password that the Seminoles I get that

563
00:28:04,950 --> 00:28:10,500
secret<font color="#E5E5E5"> I show it to the server and then</font>

564
00:28:07,050 --> 00:28:12,450
I am the it authenticates me okay that

565
00:28:10,500 --> 00:28:16,350
would be Kerberos so the first thing

566
00:28:12,450 --> 00:28:18,540
that's going to<font color="#E5E5E5"> do is the pasta ticket</font>

567
00:28:16,350 --> 00:28:20,969
if<font color="#E5E5E5"> I am the administrator of a</font><font color="#CCCCCC"> machine</font>

568
00:28:18,540 --> 00:28:23,820
and then<font color="#CCCCCC"> I do so has been validated and</font>

569
00:28:20,970 --> 00:28:25,560
then I can steal the credential from of

570
00:28:23,820 --> 00:28:27,360
the juicer at the end of the day I'm a

571
00:28:25,560 --> 00:28:29,040
cylinder Twitter<font color="#CCCCCC"> I take the ticket from</font>

572
00:28:27,360 --> 00:28:30,479
the memory<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I take it to a file I</font>

573
00:28:29,040 --> 00:28:31,860
would you sit in the very same machine

574
00:28:30,480 --> 00:28:33,300
but doesn't really<font color="#E5E5E5"> make sense because it</font>

575
00:28:31,860 --> 00:28:35,129
was already in the machine i want reduce

576
00:28:33,300 --> 00:28:36,810
it in another machine<font color="#E5E5E5"> i take it</font><font color="#CCCCCC"> on a</font>

577
00:28:35,130 --> 00:28:38,000
machine adjusts in souther prefers

578
00:28:36,810 --> 00:28:39,800
commands and then

579
00:28:38,000 --> 00:28:41,210
the file I just<font color="#CCCCCC"> built up the tickets and</font>

580
00:28:39,800 --> 00:28:44,120
then I can validate myself in another

581
00:28:41,210 --> 00:28:46,820
machine and someone asked me help to<font color="#CCCCCC"> you</font>

582
00:28:44,120 --> 00:28:48,439
detect that well the ticket<font color="#E5E5E5"> you gave it</font>

583
00:28:46,820 --> 00:28:51,530
<font color="#CCCCCC">to</font><font color="#E5E5E5"> one machine and is induced neural</font>

584
00:28:48,440 --> 00:28:53,480
<font color="#CCCCCC">ones that seems very trivial and if you</font>

585
00:28:51,530 --> 00:28:55,790
tell me well in my machine study hard

586
00:28:53,480 --> 00:28:58,010
and they see why are you<font color="#E5E5E5"> going to</font>

587
00:28:55,790 --> 00:28:59,480
generate false positive well because we

588
00:28:58,010 --> 00:29:01,900
may<font color="#CCCCCC"> believe that</font><font color="#E5E5E5"> there are two different</font>

589
00:28:59,480 --> 00:29:04,730
machines and at the end is only one is

590
00:29:01,900 --> 00:29:07,310
sometimes when you have 10 minutes

591
00:29:04,730 --> 00:29:08,990
<font color="#E5E5E5">leases</font><font color="#CCCCCC"> okay that may be detected as a</font>

592
00:29:07,310 --> 00:29:11,360
false positives we have gone to client

593
00:29:08,990 --> 00:29:17,480
number two now and here<font color="#CCCCCC"> we can see the</font>

594
00:29:11,360 --> 00:29:18,979
tickets in that machine so the clients

595
00:29:17,480 --> 00:29:20,540
and the<font color="#CCCCCC"> separate areas important a</font>

596
00:29:18,980 --> 00:29:22,910
client says that that chica has been

597
00:29:20,540 --> 00:29:25,940
given to the server<font color="#CCCCCC"> and when it says</font>

598
00:29:22,910 --> 00:29:27,980
that is being<font color="#E5E5E5"> given for gkb that means</font>

599
00:29:25,940 --> 00:29:30,650
that is a big ticket<font color="#E5E5E5"> for a better</font>

600
00:29:27,980 --> 00:29:34,790
service it also says that reduce AAS and

601
00:29:30,650 --> 00:29:39,680
then these<font color="#CCCCCC"> the ticket now is valid for</font>

602
00:29:34,790 --> 00:29:42,500
10 hours well but it can be renewed for

603
00:29:39,680 --> 00:29:46,820
a week but only for a week often<font color="#CCCCCC"> atakus</font>

604
00:29:42,500 --> 00:29:49,820
use it as an intermediate way and when

605
00:29:46,820 --> 00:29:52,580
they want to achieve<font color="#CCCCCC"> persistence they</font>

606
00:29:49,820 --> 00:29:58,540
use it a mixer we will be showing you

607
00:29:52,580 --> 00:30:02,960
very soon handy script has copied that

608
00:29:58,540 --> 00:30:06,590
to client number one<font color="#CCCCCC"> okay we'll go to</font>

609
00:30:02,960 --> 00:30:11,390
plan one and then from the file<font color="#E5E5E5"> I put</font>

610
00:30:06,590 --> 00:30:15,919
<font color="#E5E5E5">this I put it</font><font color="#CCCCCC"> in memory so launched a</font>

611
00:30:11,390 --> 00:30:22,190
playlist to see all the users so clients

612
00:30:15,920 --> 00:30:25,550
it says juice of<font color="#CCCCCC"> one okay on gvt and</font>

613
00:30:22,190 --> 00:30:27,350
then another<font color="#E5E5E5"> one for sis so it means</font>

614
00:30:25,550 --> 00:30:31,850
that for each service that<font color="#E5E5E5"> I want to</font>

615
00:30:27,350 --> 00:30:34,550
carry outs I needed ticket so to dodge

616
00:30:31,850 --> 00:30:36,439
that you need a different tickets the

617
00:30:34,550 --> 00:30:40,850
difference on the one that i got from

618
00:30:36,440 --> 00:30:45,800
curve errors so we try<font color="#CCCCCC"> to go to see</font>

619
00:30:40,850 --> 00:30:47,980
dollar ok so to the past the ticket but

620
00:30:45,800 --> 00:30:50,450
<font color="#CCCCCC">the problem with specificity</font>

621
00:30:47,980 --> 00:30:53,960
how do<font color="#E5E5E5"> you protect yourself against that</font>

622
00:30:50,450 --> 00:30:55,249
I<font color="#E5E5E5"> gave you a hint before with the money</font>

623
00:30:53,960 --> 00:30:59,149
to<font color="#E5E5E5"> start to travel across the</font>

624
00:30:55,249 --> 00:31:02,869
<font color="#E5E5E5">organization Judas f7 so that means it</font>

625
00:30:59,149 --> 00:31:04,639
is known as<font color="#CCCCCC"> Prudential hygiene so I'm</font>

626
00:31:02,869 --> 00:31:07,070
<font color="#E5E5E5">telling you about the pass rush but</font>

627
00:31:04,639 --> 00:31:10,668
<font color="#E5E5E5">Pacific as well they may introduce a</font>

628
00:31:07,070 --> 00:31:12,918
keylogger in your machine yes and no

629
00:31:10,669 --> 00:31:14,690
girls can also be introducing windows so

630
00:31:12,919 --> 00:31:16,549
at the end of the day the general is a

631
00:31:14,690 --> 00:31:18,679
general the province a general problem

632
00:31:16,549 --> 00:31:23,899
that is to say<font color="#E5E5E5"> the stealing of</font>

633
00:31:18,679 --> 00:31:25,789
credentials so the main idea what is

634
00:31:23,899 --> 00:31:27,918
essential here is the model of the three

635
00:31:25,789 --> 00:31:32,419
layers that I proposed to you before<font color="#E5E5E5"> to</font>

636
00:31:27,919 --> 00:31:35,029
<font color="#E5E5E5">not log on ever in applying to the</font>

637
00:31:32,419 --> 00:31:37,519
<font color="#CCCCCC">closet that is compromised they may</font>

638
00:31:35,029 --> 00:31:41,299
<font color="#E5E5E5">steal it from you sometimes the</font>

639
00:31:37,519 --> 00:31:43,700
attackers take away the proxy what do

640
00:31:41,299 --> 00:31:45,889
<font color="#CCCCCC">you do next do</font><font color="#E5E5E5"> log on on the machine and</font>

641
00:31:43,700 --> 00:31:47,509
then you steal the credentials and<font color="#CCCCCC"> then</font>

642
00:31:45,889 --> 00:31:52,248
they take it from there and<font color="#E5E5E5"> the scale is</font>

643
00:31:47,509 --> 00:31:58,220
privileged so seekers is same as before

644
00:31:52,249 --> 00:32:03,169
same time renewable is 256 seed dollar

645
00:31:58,220 --> 00:32:09,529
and<font color="#E5E5E5"> itself</font><font color="#CCCCCC"> at that everything is fine ok</font>

646
00:32:03,169 --> 00:32:16,990
hi delete space next now we are trying

647
00:32:09,529 --> 00:32:16,990
<font color="#E5E5E5">to achieve persistence don't wait for</font><font color="#CCCCCC"> me</font>

648
00:32:18,190 --> 00:32:26,799
we will replicate the hash of the

649
00:32:21,429 --> 00:32:29,379
password of case haji BTW because in the

650
00:32:26,799 --> 00:32:32,590
<font color="#CCCCCC">first authentication i encrypt the hour</font>

651
00:32:29,379 --> 00:32:36,658
with the<font color="#E5E5E5"> hash and then it gives me a</font>

652
00:32:32,590 --> 00:32:39,490
<font color="#E5E5E5">secret which has been encrypted with k</font>

653
00:32:36,659 --> 00:32:41,830
LGBT if<font color="#CCCCCC"> i know that i calculate my own</font>

654
00:32:39,490 --> 00:32:44,039
tickets and that is golden tickets how

655
00:32:41,830 --> 00:32:47,230
we're going to get that hash now we are

656
00:32:44,039 --> 00:32:50,740
administrators we go to the main control

657
00:32:47,230 --> 00:32:54,009
and then we have it to replicate the

658
00:32:50,740 --> 00:32:56,470
password for me and I said okay you have

659
00:32:54,009 --> 00:32:58,000
<font color="#CCCCCC">the privilege to replicate passwords and</font>

660
00:32:56,470 --> 00:32:59,889
they said well this is a domain control

661
00:32:58,000 --> 00:33:03,370
that<font color="#E5E5E5"> will have just promoted and some</font>

662
00:32:59,889 --> 00:33:06,029
tools use that very same privilege the

663
00:33:03,370 --> 00:33:08,379
one that comes to mind<font color="#E5E5E5"> is you are</font>

664
00:33:06,029 --> 00:33:10,450
synchronizing through the Microsoft

665
00:33:08,379 --> 00:33:13,029
cloud there is an option for set up a

666
00:33:10,450 --> 00:33:15,159
society and synchronized Hodges of my

667
00:33:13,029 --> 00:33:17,950
<font color="#CCCCCC">houses</font><font color="#E5E5E5"> if you enable that data cons</font>

668
00:33:15,159 --> 00:33:21,370
needs to have a number of privileges if

669
00:33:17,950 --> 00:33:24,129
you don't enable it and you don't need

670
00:33:21,370 --> 00:33:27,850
to replicate passwords in the club to

671
00:33:24,129 --> 00:33:30,009
will not have those passwords if you

672
00:33:27,850 --> 00:33:33,629
have that well past the ticket is

673
00:33:30,009 --> 00:33:33,629
already there let us take a<font color="#CCCCCC"> look at it</font>

674
00:33:34,409 --> 00:33:47,350
and then you also have honey token so

675
00:33:40,629 --> 00:33:50,709
it's a B and then pass it secret<font color="#CCCCCC"> sense</font>

676
00:33:47,350 --> 00:33:54,039
as whether the machine is behind not

677
00:33:50,710 --> 00:33:55,750
natural not and it says okay<font color="#E5E5E5"> I</font><font color="#CCCCCC"> give</font><font color="#E5E5E5"> the</font>

678
00:33:54,039 --> 00:33:59,320
ticket to client<font color="#E5E5E5"> rule and the ticket is</font>

679
00:33:55,750 --> 00:34:02,080
dangerous<font color="#E5E5E5"> thing client one so let us</font>

680
00:33:59,320 --> 00:34:05,259
wait<font color="#CCCCCC"> for a minute until we get the alert</font>

681
00:34:02,080 --> 00:34:07,360
detecting the applications so we are

682
00:34:05,259 --> 00:34:09,790
going to detect golden tickets golden

683
00:34:07,360 --> 00:34:12,460
tickets detection requires us to have

684
00:34:09,790 --> 00:34:13,989
five days of data and a machine and this

685
00:34:12,460 --> 00:34:18,099
is so because we're going<font color="#E5E5E5"> to do two</font>

686
00:34:13,989 --> 00:34:19,750
things well first of all what's the

687
00:34:18,099 --> 00:34:23,260
golden<font color="#CCCCCC"> ticket Colton secret is the</font>

688
00:34:19,750 --> 00:34:25,719
<font color="#E5E5E5">actual attacker generators on TGT</font>

689
00:34:23,260 --> 00:34:29,800
<font color="#CCCCCC">fucking to do that well because</font><font color="#E5E5E5"> we have</font>

690
00:34:25,719 --> 00:34:31,069
fabricated the passwords of he<font color="#E5E5E5"> hardly</font>

691
00:34:29,800 --> 00:34:34,340
BTW

692
00:34:31,070 --> 00:34:36,980
generous his own tickets that the first

693
00:34:34,340 --> 00:34:40,490
two steps having escaped and this is

694
00:34:36,980 --> 00:34:43,610
what<font color="#CCCCCC"> we detect we detect skipping of</font>

695
00:34:40,489 --> 00:34:46,819
those two steps<font color="#E5E5E5"> and then we also detect</font>

696
00:34:43,610 --> 00:34:52,460
that they are using<font color="#E5E5E5"> our CFO how that we</font>

697
00:34:46,820 --> 00:34:54,500
have it there so five days of data we

698
00:34:52,460 --> 00:34:56,150
have<font color="#E5E5E5"> deficit</font><font color="#CCCCCC"> lease</font><font color="#E5E5E5"> up we are going to</font>

699
00:34:54,500 --> 00:35:00,470
stop the database and we're going<font color="#CCCCCC"> to</font>

700
00:34:56,150 --> 00:35:03,800
inject five days of data so we are

701
00:35:00,470 --> 00:35:05,930
playing around with it and what<font color="#CCCCCC"> else</font>

702
00:35:03,800 --> 00:35:10,610
<font color="#CCCCCC">current size of all golden tickets well</font>

703
00:35:05,930 --> 00:35:13,250
first that that hack<font color="#E5E5E5"> hounds has a hash</font>

704
00:35:10,610 --> 00:35:14,870
that never changes and<font color="#CCCCCC"> you see so</font>

705
00:35:13,250 --> 00:35:17,810
because<font color="#E5E5E5"> Microsoft does not change the</font>

706
00:35:14,870 --> 00:35:19,819
<font color="#E5E5E5">password for how long have</font><font color="#CCCCCC"> you had that</font>

707
00:35:17,810 --> 00:35:22,310
accounts with that very<font color="#E5E5E5"> same password</font>

708
00:35:19,820 --> 00:35:25,580
well those of you who have gone up to

709
00:35:22,310 --> 00:35:28,670
<font color="#CCCCCC">2000</font><font color="#E5E5E5"> and eggs well since you set up the</font>

710
00:35:25,580 --> 00:35:30,560
domain 2002 2001 the same person

711
00:35:28,670 --> 00:35:32,720
continues to be there what are the

712
00:35:30,560 --> 00:35:35,090
<font color="#CCCCCC">consequences there well we did that by</font>

713
00:35:32,720 --> 00:35:38,209
replicating<font color="#E5E5E5"> it in real time but imagine</font>

714
00:35:35,090 --> 00:35:40,280
the backup people in your company where

715
00:35:38,210 --> 00:35:43,070
it is encrypted yes but when you give<font color="#E5E5E5"> me</font>

716
00:35:40,280 --> 00:35:45,290
the backup of a domain<font color="#CCCCCC"> controller I can</font>

717
00:35:43,070 --> 00:35:47,360
get it so what I mean<font color="#CCCCCC"> is that it back up</font>

718
00:35:45,290 --> 00:35:49,550
made ten years ago could also be a<font color="#CCCCCC"> good</font>

719
00:35:47,360 --> 00:35:53,510
thing could also be<font color="#E5E5E5"> valid for me but</font>

720
00:35:49,550 --> 00:35:55,790
<font color="#CCCCCC">it's been perspectives change it well</font>

721
00:35:53,510 --> 00:35:58,940
actually you have to<font color="#E5E5E5"> change it two times</font>

722
00:35:55,790 --> 00:36:03,290
to have to change it twice because well

723
00:35:58,940 --> 00:36:07,120
the previous password and the next

724
00:36:03,290 --> 00:36:13,270
<font color="#E5E5E5">password are valid you cannot</font><font color="#CCCCCC"> change it</font>

725
00:36:07,120 --> 00:36:13,270
two times one after another so

726
00:36:14,619 --> 00:36:20,089
so if I we are doing is doing that for

727
00:36:17,750 --> 00:36:23,569
actively perhaps you have to change it

728
00:36:20,089 --> 00:36:25,400
once a<font color="#CCCCCC"> month then you reset it so that</font>

729
00:36:23,569 --> 00:36:29,089
tickets after a month I stopped<font color="#E5E5E5"> being</font>

730
00:36:25,400 --> 00:36:30,530
valid then also in all systems well you

731
00:36:29,089 --> 00:36:33,650
may have<font color="#E5E5E5"> problems and if you have</font>

732
00:36:30,530 --> 00:36:35,180
problems do<font color="#CCCCCC"> not call me it's a good</font>

733
00:36:33,650 --> 00:36:40,790
<font color="#E5E5E5">thing that you do it it's a good</font><font color="#CCCCCC"> idea</font>

734
00:36:35,180 --> 00:36:44,750
but<font color="#CCCCCC"> do it carefully what else do we have</font>

735
00:36:40,790 --> 00:36:46,400
our golden ticket no not yet<font color="#E5E5E5"> have you</font>

736
00:36:44,750 --> 00:36:49,819
introduced what you entered with five

737
00:36:46,400 --> 00:36:51,319
days<font color="#E5E5E5"> of data well I journal that you</font>

738
00:36:49,819 --> 00:36:53,839
notice that<font color="#E5E5E5"> when we were to stop in the</font>

739
00:36:51,319 --> 00:36:56,500
database such as I reduces a Mongol

740
00:36:53,839 --> 00:37:02,960
database that's what's behind it

741
00:36:56,500 --> 00:37:05,359
non-relational only tokens where we have

742
00:37:02,960 --> 00:37:07,640
launched golden ticket and we will

743
00:37:05,359 --> 00:37:14,450
detect it for us this is special it is

744
00:37:07,640 --> 00:37:22,009
using our c4 we had it there now that

745
00:37:14,450 --> 00:37:28,359
<font color="#CCCCCC">was to get full client to ya</font><font color="#E5E5E5"> solid it</font>

746
00:37:22,010 --> 00:37:34,760
was a year the person who may be sooo

747
00:37:28,359 --> 00:37:37,640
ready to last for<font color="#CCCCCC"> ten yes some lessons</font>

748
00:37:34,760 --> 00:37:42,140
that I left for make it left for<font color="#E5E5E5"> ten</font>

749
00:37:37,640 --> 00:37:49,879
hours it uses our CFO and then expires

750
00:37:42,140 --> 00:37:52,520
in 2017 20 20 20 27 so these key

751
00:37:49,880 --> 00:37:54,650
skeleton this is a<font color="#E5E5E5"> master key the</font>

752
00:37:52,520 --> 00:37:57,530
attacker wants to log on as any other

753
00:37:54,650 --> 00:37:59,960
user and you may go say what you<font color="#CCCCCC"> made</font>

754
00:37:57,530 --> 00:38:06,829
reset the password yes but then users

755
00:37:59,960 --> 00:38:09,910
<font color="#CCCCCC">will find out then you inject it in the</font>

756
00:38:06,829 --> 00:38:09,910
domain controller

757
00:38:11,819 --> 00:38:17,259
I'm going<font color="#E5E5E5"> to launch the skeleton key no</font>

758
00:38:14,770 --> 00:38:23,619
that's<font color="#E5E5E5"> not the right one so these one</font>

759
00:38:17,260 --> 00:38:30,460
creates that master key remote skeleton

760
00:38:23,619 --> 00:38:35,500
key I can do it again all right how does

761
00:38:30,460 --> 00:38:38,500
this work as I was saying<font color="#E5E5E5"> actually what</font>

762
00:38:35,500 --> 00:38:41,829
is<font color="#E5E5E5"> three so I have control to this</font>

763
00:38:38,500 --> 00:38:46,089
domain controller has copied files and

764
00:38:41,829 --> 00:38:49,210
now you will<font color="#CCCCCC"> you would do hooking it</font>

765
00:38:46,089 --> 00:38:51,460
would make hooking into functions so we

766
00:38:49,210 --> 00:38:54,339
the domain controllers<font color="#E5E5E5"> I support our c4</font>

767
00:38:51,460 --> 00:38:56,589
this is going to say I only support hard

768
00:38:54,339 --> 00:38:58,569
to fool how do you detect it because it

769
00:38:56,589 --> 00:39:02,319
does<font color="#CCCCCC"> is in this</font><font color="#E5E5E5"> way if we got to kind of</font>

770
00:38:58,569 --> 00:39:06,099
do it through a<font color="#CCCCCC"> es and then</font><font color="#E5E5E5"> second</font><font color="#CCCCCC"> says</font>

771
00:39:02,319 --> 00:39:10,630
<font color="#CCCCCC">when you requested encrypt decrypt</font>

772
00:39:06,099 --> 00:39:14,470
encrypted function requested try some

773
00:39:10,630 --> 00:39:18,280
why does it work only with our c4 this

774
00:39:14,470 --> 00:39:20,558
is so because<font color="#E5E5E5"> I uses something so to</font>

775
00:39:18,280 --> 00:39:22,540
users with the<font color="#E5E5E5"> same password do not</font>

776
00:39:20,559 --> 00:39:28,059
generate the same hash and then eyes

777
00:39:22,540 --> 00:39:30,069
when you hush it consumes lots of CPU so

778
00:39:28,059 --> 00:39:32,710
therefore<font color="#E5E5E5"> imagine that you have to do</font>

779
00:39:30,069 --> 00:39:34,029
the third malware that malicious

780
00:39:32,710 --> 00:39:35,950
software if you have to validate that

781
00:39:34,030 --> 00:39:38,680
very same password for all the users to

782
00:39:35,950 --> 00:39:40,540
<font color="#E5E5E5">either</font><font color="#CCCCCC"> precompute they have generated</font>

783
00:39:38,680 --> 00:39:42,129
for each of the pursuit<font color="#E5E5E5"> of each of the</font>

784
00:39:40,540 --> 00:39:44,890
users and that would take up lots of

785
00:39:42,130 --> 00:39:49,960
<font color="#E5E5E5">memory or do calculated real time but</font>

786
00:39:44,890 --> 00:39:53,140
that will take up lots of<font color="#E5E5E5"> CPU and so the</font>

787
00:39:49,960 --> 00:39:55,900
bigger the domain the easier it is to

788
00:39:53,140 --> 00:40:00,220
detect the tools that<font color="#E5E5E5"> you know it has</font>

789
00:39:55,900 --> 00:40:03,190
been great to<font color="#CCCCCC"> our c4 piggy it's good</font>

790
00:40:00,220 --> 00:40:05,348
that it says that it only uses<font color="#CCCCCC"> our c4 so</font>

791
00:40:03,190 --> 00:40:08,559
the same<font color="#E5E5E5"> password no matter the user</font>

792
00:40:05,349 --> 00:40:11,680
generates always the same hash<font color="#E5E5E5"> I</font><font color="#CCCCCC"> launch</font>

793
00:40:08,559 --> 00:40:15,400
the other script perhaps now we need<font color="#CCCCCC"> to</font>

794
00:40:11,680 --> 00:40:19,000
play the video but it<font color="#E5E5E5"> is not detecting</font>

795
00:40:15,400 --> 00:40:21,549
them to logic this is not exact

796
00:40:19,000 --> 00:40:25,080
sometimes and it's like longer<font color="#E5E5E5"> sometimes</font>

797
00:40:21,549 --> 00:40:28,280
they take shorter so well more

798
00:40:25,080 --> 00:40:30,540
less we often wait for 15 minutes so

799
00:40:28,280 --> 00:40:35,700
<font color="#CCCCCC">malicious replication the housing</font>

800
00:40:30,540 --> 00:40:38,870
already that has been detected so the

801
00:40:35,700 --> 00:40:42,529
tools should detect code and secret and

802
00:40:38,870 --> 00:40:51,240
then the<font color="#E5E5E5"> last one will be will detect</font>

803
00:40:42,530 --> 00:40:54,080
this<font color="#E5E5E5"> x.x with a remote code to sell go</font>

804
00:40:51,240 --> 00:40:54,080
back to diggity

805
00:41:07,440 --> 00:41:14,220
now we go to this kill chain so

806
00:41:11,610 --> 00:41:16,290
<font color="#E5E5E5">sophisticated attacks no matter how</font>

807
00:41:14,220 --> 00:41:19,080
sophisticated attacks on the tool can

808
00:41:16,290 --> 00:41:21,330
identify them and<font color="#CCCCCC"> Fernando told you how</font>

809
00:41:19,080 --> 00:41:23,190
each<font color="#CCCCCC"> of them are detected and in which</font>

810
00:41:21,330 --> 00:41:25,200
point if those attacks<font color="#E5E5E5"> occur more</font>

811
00:41:23,190 --> 00:41:33,680
sophisticated over time the tool can be

812
00:41:25,200 --> 00:41:38,700
adapted to detect those<font color="#E5E5E5"> attacks then we</font>

813
00:41:33,680 --> 00:41:42,899
double the traffic of the<font color="#E5E5E5"> switches just</font>

814
00:41:38,700 --> 00:41:45,689
to detect the attacks the tool has then

815
00:41:42,900 --> 00:41:47,910
only detection has not<font color="#CCCCCC"> been</font><font color="#E5E5E5"> made</font><font color="#CCCCCC"> any</font>

816
00:41:45,690 --> 00:41:50,250
<font color="#CCCCCC">Corrections</font><font color="#E5E5E5"> no nothing but it has I let</font>

817
00:41:47,910 --> 00:41:54,089
us about all the attacks<font color="#E5E5E5"> that having</font>

818
00:41:50,250 --> 00:41:55,350
launched and last response<font color="#E5E5E5"> incidents two</font>

819
00:41:54,090 --> 00:41:57,680
things I don't<font color="#CCCCCC"> know whether you've seen</font>

820
00:41:55,350 --> 00:42:04,740
the recommendations that<font color="#CCCCCC"> I gave it</font><font color="#E5E5E5"> and</font>

821
00:41:57,680 --> 00:42:07,529
switch<font color="#E5E5E5"> off do forensics but it is good</font>

822
00:42:04,740 --> 00:42:13,140
to<font color="#E5E5E5"> know how what happens what happens if</font>

823
00:42:07,530 --> 00:42:15,990
that account so then it says<font color="#CCCCCC"> you wear</font>

824
00:42:13,140 --> 00:42:18,779
this user has been trying<font color="#E5E5E5"> to access</font>

825
00:42:15,990 --> 00:42:22,680
those machines over a<font color="#E5E5E5"> month and</font><font color="#CCCCCC"> then</font>

826
00:42:18,780 --> 00:42:25,140
<font color="#E5E5E5">remember the slc</font><font color="#CCCCCC"> then I would</font><font color="#E5E5E5"> like to</font>

827
00:42:22,680 --> 00:42:33,120
<font color="#CCCCCC">tell</font><font color="#E5E5E5"> you well we have a happy to take</font>

828
00:42:25,140 --> 00:42:36,680
any questions that you may have our own

829
00:42:33,120 --> 00:42:36,680
tabare questions

830
00:42:47,200 --> 00:42:53,399
I have a<font color="#E5E5E5"> question</font><font color="#CCCCCC"> they sent them what</font>

831
00:42:49,839 --> 00:42:57,070
happens when I have a reverse proxy and

832
00:42:53,400 --> 00:42:59,470
has to pass on Kerberos ticket<font color="#CCCCCC"> to a nap</font>

833
00:42:57,070 --> 00:43:01,240
<font color="#CCCCCC">and I am just</font><font color="#E5E5E5"> in the middle he will</font>

834
00:42:59,470 --> 00:43:03,220
detect exactly the same as if you were

835
00:43:01,240 --> 00:43:05,078
behind<font color="#E5E5E5"> that's what you have to do is</font>

836
00:43:03,220 --> 00:43:09,339
just<font color="#E5E5E5"> to leave it out of the</font><font color="#CCCCCC"> passer</font>

837
00:43:05,079 --> 00:43:11,560
<font color="#E5E5E5">ticket therefore if I</font><font color="#CCCCCC"> find load the</font>

838
00:43:09,339 --> 00:43:14,950
party tickets it means that I have like

839
00:43:11,560 --> 00:43:18,670
a free entry yes you have it<font color="#E5E5E5"> okay thank</font>

840
00:43:14,950 --> 00:43:20,589
you<font color="#E5E5E5"> very much for your talk and the</font>

841
00:43:18,670 --> 00:43:24,839
<font color="#E5E5E5">question is very obvious how does this</font>

842
00:43:20,589 --> 00:43:28,990
tool<font color="#E5E5E5"> behave with all go to the cloud</font>

843
00:43:24,839 --> 00:43:31,450
everything is active directory we have

844
00:43:28,990 --> 00:43:34,390
the machines<font color="#E5E5E5"> in the domain even if you</font>

845
00:43:31,450 --> 00:43:37,390
go beyond that does it have<font color="#CCCCCC"> a capability</font>

846
00:43:34,390 --> 00:43:40,598
<font color="#CCCCCC">to detect foreign things in an active</font>

847
00:43:37,390 --> 00:43:45,730
directory v2c and the last second

848
00:43:40,599 --> 00:43:49,150
question have you found any attacks

849
00:43:45,730 --> 00:43:52,420
trying to fake a TA and so that it<font color="#E5E5E5"> is</font>

850
00:43:49,150 --> 00:43:54,400
not detected well have your Active

851
00:43:52,420 --> 00:43:57,280
Directory this is not good<font color="#E5E5E5"> for it this</font>

852
00:43:54,400 --> 00:43:59,670
is for<font color="#E5E5E5"> just an active directory as such</font>

853
00:43:57,280 --> 00:44:02,319
if you have an active directed in

854
00:43:59,670 --> 00:44:04,270
directory in the cloud this is good for

855
00:44:02,319 --> 00:44:07,060
<font color="#CCCCCC">it and actually</font><font color="#E5E5E5"> you should have it and</font>

856
00:44:04,270 --> 00:44:10,869
actually<font color="#E5E5E5"> you don't want any controller</font>

857
00:44:07,060 --> 00:44:12,369
to be left out having said that but this

858
00:44:10,869 --> 00:44:13,750
is a company that we bought a couple of

859
00:44:12,369 --> 00:44:16,480
years<font color="#E5E5E5"> ago the machine learning</font>

860
00:44:13,750 --> 00:44:18,310
technology is gone<font color="#CCCCCC"> into being introduced</font>

861
00:44:16,480 --> 00:44:21,010
into the<font color="#E5E5E5"> product after that they</font>

862
00:44:18,310 --> 00:44:24,390
identity protections so at the end of

863
00:44:21,010 --> 00:44:27,250
the day this is exactly the same thing

864
00:44:24,390 --> 00:44:30,220
abnormal behaviors they're being logged

865
00:44:27,250 --> 00:44:34,720
on from<font color="#E5E5E5"> tall net when you have that and</font>

866
00:44:30,220 --> 00:44:36,730
this is that for you well whenever the

867
00:44:34,720 --> 00:44:38,169
entities are in the cloud and the second

868
00:44:36,730 --> 00:44:42,369
example that we showed you is quite

869
00:44:38,170 --> 00:44:44,290
recent so whenever there is a response

870
00:44:42,369 --> 00:44:46,030
incident this is what we do when we are

871
00:44:44,290 --> 00:44:48,869
<font color="#E5E5E5">called to go there the first</font><font color="#CCCCCC"> thing that</font>

872
00:44:46,030 --> 00:44:51,609
<font color="#E5E5E5">we do is to set this up he gave us a</font>

873
00:44:48,869 --> 00:44:53,859
view much better than if we go and take

874
00:44:51,609 --> 00:44:56,619
a<font color="#E5E5E5"> look at our fault events but events</font>

875
00:44:53,859 --> 00:44:58,609
events aimed at<font color="#CCCCCC"> avoiding deeds exactly i</font>

876
00:44:56,619 --> 00:45:00,470
haven't found any<font color="#CCCCCC"> i'm not aware of</font>

877
00:44:58,609 --> 00:45:03,170
<font color="#E5E5E5">hernando said before this tool is</font>

878
00:45:00,470 --> 00:45:07,249
intended to be as silence as possible so

879
00:45:03,170 --> 00:45:12,799
that it is<font color="#CCCCCC"> not easily detected so it is</font>

880
00:45:07,249 --> 00:45:14,480
<font color="#E5E5E5">very</font><font color="#CCCCCC"> easy Jung tool so we still</font><font color="#E5E5E5"> having</font>

881
00:45:12,799 --> 00:45:18,880
being in that scenario that you

882
00:45:14,480 --> 00:45:27,470
mentioned<font color="#E5E5E5"> but we could happen and</font>

883
00:45:18,880 --> 00:45:31,430
sometimes we get questions and even as

884
00:45:27,470 --> 00:45:34,578
well we know some of the information but

885
00:45:31,430 --> 00:45:37,249
sometimes<font color="#CCCCCC"> we don't know much we don't</font>

886
00:45:34,579 --> 00:45:43,099
<font color="#E5E5E5">know much more about the architecture of</font>

887
00:45:37,249 --> 00:45:45,499
the product so our lawyers do not let us

888
00:45:43,099 --> 00:45:48,440
show you the tools so that we don't

889
00:45:45,499 --> 00:45:50,328
focus on the<font color="#E5E5E5"> two thousand secrets would</font>

890
00:45:48,440 --> 00:45:52,309
<font color="#E5E5E5">you all do it with the same tool but</font>

891
00:45:50,329 --> 00:45:54,440
it's tomorrow if you had another two to

892
00:45:52,309 --> 00:45:57,529
do it you will end it it would also

893
00:45:54,440 --> 00:46:00,230
detected it's about detecting techniques

894
00:45:57,529 --> 00:46:02,410
<font color="#E5E5E5">who do fake it well could be fact why</font>

895
00:46:00,230 --> 00:46:02,410
not

896
00:46:05,850 --> 00:46:09,110
any other questions

897
00:46:12,010 --> 00:46:17,150
in the beginning of<font color="#E5E5E5"> the presentation</font>

898
00:46:13,910 --> 00:46:22,549
just said that he takes three<font color="#E5E5E5"> weeks</font>

899
00:46:17,150 --> 00:46:26,660
before<font color="#E5E5E5"> the system is fully set up but</font>

900
00:46:22,550 --> 00:46:30,110
then you also said that when you go to a

901
00:46:26,660 --> 00:46:32,420
company we in trouble then you just plug

902
00:46:30,110 --> 00:46:35,690
it in you just install it to analyze it

903
00:46:32,420 --> 00:46:38,150
just that<font color="#E5E5E5"> these particles there is no</font>

904
00:46:35,690 --> 00:46:41,840
abnormal behavior<font color="#CCCCCC"> is itself being set up</font>

905
00:46:38,150 --> 00:46:44,120
it detects it immediately it requires

906
00:46:41,840 --> 00:46:49,000
three weeks understand<font color="#E5E5E5"> juices behavior</font>

907
00:46:44,120 --> 00:46:51,650
and<font color="#CCCCCC"> to understand and to generate alerts</font>

908
00:46:49,000 --> 00:46:53,720
abnormal use of resources<font color="#E5E5E5"> that is also</font>

909
00:46:51,650 --> 00:46:55,880
available but that requires three weeks

910
00:46:53,720 --> 00:46:58,220
of data and then some alerts are<font color="#CCCCCC"> makes</font>

911
00:46:55,880 --> 00:47:01,300
they need to have five days of theta of

912
00:46:58,220 --> 00:47:05,180
the users to<font color="#E5E5E5"> see that the they had</font>

913
00:47:01,300 --> 00:47:09,490
having a downgrade but some activities

914
00:47:05,180 --> 00:47:11,870
are detected right from<font color="#CCCCCC"> the beginning so</font>

915
00:47:09,490 --> 00:47:14,180
so it tells you that this user doesn't

916
00:47:11,870 --> 00:47:17,299
do this regularly and this time is

917
00:47:14,180 --> 00:47:19,250
trying to do<font color="#E5E5E5"> this and that and it is</font>

918
00:47:17,300 --> 00:47:21,830
accessed listed as we have showed<font color="#CCCCCC"> you</font>

919
00:47:19,250 --> 00:47:24,710
with other attacks but in<font color="#CCCCCC"> that case you</font>

920
00:47:21,830 --> 00:47:26,450
<font color="#CCCCCC">need the</font><font color="#E5E5E5"> three week learning periods and</font>

921
00:47:24,710 --> 00:47:32,900
it is just<font color="#E5E5E5"> impossible for us to simulate</font>

922
00:47:26,450 --> 00:47:34,850
it here<font color="#CCCCCC"> right if there are no more</font>

923
00:47:32,900 --> 00:47:37,210
<font color="#E5E5E5">questions thank you</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> much for your</font>

924
00:47:34,850 --> 00:47:37,210
<font color="#CCCCCC">attention</font>

925
00:47:39,799 --> 00:47:42,799
what

