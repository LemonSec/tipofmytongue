1
00:00:01,040 --> 00:00:03,360
don't don't run as soon as matt's done

2
00:00:03,360 --> 00:00:07,120
we have uh door prizes at the end

3
00:00:07,120 --> 00:00:10,320
so we got some nice stuff over there

4
00:00:10,320 --> 00:00:15,280
and then online two

5
00:00:15,280 --> 00:00:18,240
online people do say stay put oh yeah

6
00:00:18,240 --> 00:00:20,080
the online vote too

7
00:00:20,080 --> 00:00:23,039
uh except for the actual physical ones

8
00:00:23,039 --> 00:00:24,880
create gift cards so those will be

9
00:00:24,880 --> 00:00:27,359
sent to your via email the actual

10
00:00:27,359 --> 00:00:28,000
physical

11
00:00:28,000 --> 00:00:31,039
ones that we have over

12
00:00:35,520 --> 00:00:38,719
all right so uh matt's uh title

13
00:00:38,719 --> 00:00:45,840
is lend me your irs your errors

14
00:00:57,039 --> 00:00:58,879
means we're saying the constant rods of

15
00:00:58,879 --> 00:01:00,640
unsophisticated attacks

16
00:01:00,640 --> 00:01:02,800
from automated tools button scrolls

17
00:01:02,800 --> 00:01:05,119
exploit kits fish kits and script keys

18
00:01:05,119 --> 00:01:06,000
online

19
00:01:06,000 --> 00:01:08,880
as we saw earlier so once in a while we

20
00:01:08,880 --> 00:01:09,840
encounter attacks

21
00:01:09,840 --> 00:01:13,040
worthy of ones

22
00:01:14,640 --> 00:01:16,479
this talk features live dental

23
00:01:16,479 --> 00:01:18,479
reenactments from some advanced attacks

24
00:01:18,479 --> 00:01:21,119
investigated by the presenter

25
00:01:21,119 --> 00:01:23,280
the live demo showcase technical deep

26
00:01:23,280 --> 00:01:24,799
dives on the end of things on both the

27
00:01:24,799 --> 00:01:26,000
attacker investigator

28
00:01:26,000 --> 00:01:28,640
signing the attacks takeaways are

29
00:01:28,640 --> 00:01:29,520
strategies

30
00:01:29,520 --> 00:01:31,439
freely available tools and techniques

31
00:01:31,439 --> 00:01:33,119
helpful during incident response

32
00:01:33,119 --> 00:01:34,799
investigations

33
00:01:34,799 --> 00:01:38,240
matt works in or on computer security

34
00:01:38,240 --> 00:01:40,400
incident response team performing

35
00:01:40,400 --> 00:01:41,680
digital forensics and

36
00:01:41,680 --> 00:01:44,880
incident response is a show host for the

37
00:01:44,880 --> 00:01:46,240
correct real podcast

38
00:01:46,240 --> 00:01:49,600
which is a good listening point

39
00:01:49,600 --> 00:01:51,920
as with 20 years from my professional

40
00:01:51,920 --> 00:01:52,880
experience

41
00:01:52,880 --> 00:01:56,159
at it and information security he's a

42
00:01:56,159 --> 00:01:58,479
security director for a cincinnati

43
00:01:58,479 --> 00:02:00,880
cincinnati network between professional

44
00:02:00,880 --> 00:02:02,799
association

45
00:02:02,799 --> 00:02:04,640
which they meet on this the following

46
00:02:04,640 --> 00:02:05,920
thursday of us

47
00:02:05,920 --> 00:02:08,240
such as

48
00:02:11,200 --> 00:02:13,760
as we've seen earlier as well from some

49
00:02:13,760 --> 00:02:15,440
of the other speakers

50
00:02:15,440 --> 00:02:17,440
volunteers as a technical mentor for

51
00:02:17,440 --> 00:02:19,200
women's security alignment

52
00:02:19,200 --> 00:02:22,319
and is a 2019 spark rising tech

53
00:02:22,319 --> 00:02:25,760
stars award winner matt has presented on

54
00:02:25,760 --> 00:02:27,920
numerous information security topics

55
00:02:27,920 --> 00:02:30,400
at many technical meet up groups at

56
00:02:30,400 --> 00:02:32,080
immigration security conferences across

57
00:02:32,080 --> 00:02:33,040
the country

58
00:02:33,040 --> 00:02:35,519
all right thank you for coming out

59
00:02:35,519 --> 00:02:36,160
presenting

60
00:02:36,160 --> 00:02:39,280
at the stage is yours thank you dr

61
00:02:39,280 --> 00:02:42,720
c it's great to be here in person again

62
00:02:42,720 --> 00:02:44,879
uh i've always never well i've never

63
00:02:44,879 --> 00:02:46,800
taken speaking engagements for granted

64
00:02:46,800 --> 00:02:47,120
but

65
00:02:47,120 --> 00:02:50,720
being in person again is special so

66
00:02:50,720 --> 00:02:52,560
thank you everybody for coming out and

67
00:02:52,560 --> 00:02:54,160
definitely thank you for sticking out to

68
00:02:54,160 --> 00:02:56,400
the very last talk of the day

69
00:02:56,400 --> 00:02:58,000
see just as many seats full as they're

70
00:02:58,000 --> 00:02:59,680
worth the start of the day so

71
00:02:59,680 --> 00:03:01,599
i take that as a positive thank you for

72
00:03:01,599 --> 00:03:03,200
sticking it out i

73
00:03:03,200 --> 00:03:05,120
hope it's worth your while so i will do

74
00:03:05,120 --> 00:03:06,640
my best

75
00:03:06,640 --> 00:03:08,319
so for those who don't know me my name

76
00:03:08,319 --> 00:03:10,560
is matt sheer

77
00:03:10,560 --> 00:03:12,640
and i work for a big well-known

78
00:03:12,640 --> 00:03:13,680
organization

79
00:03:13,680 --> 00:03:16,800
as an infosec engineer performing

80
00:03:16,800 --> 00:03:20,640
dfir on a c-cert as previously mentioned

81
00:03:20,640 --> 00:03:22,640
i am the uh one of the co-hosts for the

82
00:03:22,640 --> 00:03:24,080
threat reel podcast

83
00:03:24,080 --> 00:03:26,560
a little behind but uh we'll get it

84
00:03:26,560 --> 00:03:27,840
ramped back up here

85
00:03:27,840 --> 00:03:30,560
and uh give us a listen if you will with

86
00:03:30,560 --> 00:03:30,959
my

87
00:03:30,959 --> 00:03:32,799
co-host there micah brown in the front

88
00:03:32,799 --> 00:03:35,440
row thank you

89
00:03:35,440 --> 00:03:37,840
and so just uh some quick points so

90
00:03:37,840 --> 00:03:38,959
where i volunteer

91
00:03:38,959 --> 00:03:41,120
again i serve as chair for the simpa

92
00:03:41,120 --> 00:03:43,120
security sig meeting the third thursday

93
00:03:43,120 --> 00:03:44,319
of each month

94
00:03:44,319 --> 00:03:46,080
uh sounds like we're going to have a

95
00:03:46,080 --> 00:03:47,440
conflict in november

96
00:03:47,440 --> 00:03:50,000
shame on you guys but uh you know we'll

97
00:03:50,000 --> 00:03:52,799
we'll work it out

98
00:03:54,720 --> 00:03:56,720
just kidding attend wherever you like uh

99
00:03:56,720 --> 00:03:58,480
yeah it's no big deal we're we're all

100
00:03:58,480 --> 00:04:00,239
here to support one another

101
00:04:00,239 --> 00:04:01,840
but i am an official hacking is not a

102
00:04:01,840 --> 00:04:03,439
crime advocate and a

103
00:04:03,439 --> 00:04:05,760
technical mentor at wamsa the women's

104
00:04:05,760 --> 00:04:07,200
security alliance

105
00:04:07,200 --> 00:04:09,360
uh just a quick disclaimer that yes i do

106
00:04:09,360 --> 00:04:11,040
have a day job but the opinions

107
00:04:11,040 --> 00:04:13,120
expressed are based solely on my own

108
00:04:13,120 --> 00:04:14,080
independent security

109
00:04:14,080 --> 00:04:16,399
research you do not express or reflect

110
00:04:16,399 --> 00:04:18,720
the views or opinions of my employer

111
00:04:18,720 --> 00:04:20,639
and then the objectives today are to

112
00:04:20,639 --> 00:04:23,040
provide reenactments of real world

113
00:04:23,040 --> 00:04:23,840
attacks

114
00:04:23,840 --> 00:04:25,280
we're going to talk about how these

115
00:04:25,280 --> 00:04:27,840
attacks worked how and why they defeated

116
00:04:27,840 --> 00:04:29,759
some of our security solutions

117
00:04:29,759 --> 00:04:30,720
then we're going to show instant

118
00:04:30,720 --> 00:04:32,800
responses to these attacks and we're

119
00:04:32,800 --> 00:04:34,400
going to demo investigative tools and

120
00:04:34,400 --> 00:04:35,120
techniques

121
00:04:35,120 --> 00:04:37,360
uh that anybody here can use and then

122
00:04:37,360 --> 00:04:38,880
we're going to discuss lessons learned

123
00:04:38,880 --> 00:04:41,280
and key takeaways

124
00:04:41,280 --> 00:04:42,720
so just to make sure we're all on the

125
00:04:42,720 --> 00:04:44,720
same page everybody here probably knows

126
00:04:44,720 --> 00:04:46,400
this but just to make sure

127
00:04:46,400 --> 00:04:49,520
ioc or ioc is an indicator compromise

128
00:04:49,520 --> 00:04:52,639
ir is incident response dfir is digital

129
00:04:52,639 --> 00:04:54,400
forensics and incident response and you

130
00:04:54,400 --> 00:04:55,680
might hear these terms

131
00:04:55,680 --> 00:04:58,160
used throughout the presentation other

132
00:04:58,160 --> 00:04:59,840
disclaimers that the demos are

133
00:04:59,840 --> 00:05:02,800
all based on 100 percent true stories

134
00:05:02,800 --> 00:05:04,720
these demos dutifully recreate

135
00:05:04,720 --> 00:05:07,440
actual attacks however some of the

136
00:05:07,440 --> 00:05:08,880
details were altered

137
00:05:08,880 --> 00:05:11,120
an investigation demos are sped up

138
00:05:11,120 --> 00:05:13,919
considerably in the interest of time

139
00:05:13,919 --> 00:05:17,440
also i have a demo environment set up on

140
00:05:17,440 --> 00:05:19,919
my laptop specifically

141
00:05:19,919 --> 00:05:21,759
you should really only do this kind of

142
00:05:21,759 --> 00:05:24,160
analysis in a dedicated sandbox

143
00:05:24,160 --> 00:05:27,120
something that's volatile just to make

144
00:05:27,120 --> 00:05:29,520
sure you don't get yourself infected

145
00:05:29,520 --> 00:05:31,759
so when you see me doing stuff here on a

146
00:05:31,759 --> 00:05:32,800
local system

147
00:05:32,800 --> 00:05:35,280
it's a pretend sandbox just to make sure

148
00:05:35,280 --> 00:05:35,919
we're on the

149
00:05:35,919 --> 00:05:39,520
same page on that and then also this

150
00:05:39,520 --> 00:05:43,120
does give live demos so if things fail

151
00:05:43,120 --> 00:05:44,080
miserably

152
00:05:44,080 --> 00:05:46,800
bear with me but i'm doing live demos

153
00:05:46,800 --> 00:05:47,759
because i'm either

154
00:05:47,759 --> 00:05:52,639
bold fearless

155
00:05:52,639 --> 00:05:55,840
or crazy please pick

156
00:05:55,840 --> 00:06:00,880
two so i'm not just crazy

157
00:06:02,400 --> 00:06:03,680
so our first scenario we're going to

158
00:06:03,680 --> 00:06:06,479
call the mystery attachment

159
00:06:06,479 --> 00:06:08,560
and the preface for this is that there

160
00:06:08,560 --> 00:06:10,240
was a news headline from

161
00:06:10,240 --> 00:06:12,960
uh sort of summer of 2018 that a

162
00:06:12,960 --> 00:06:14,880
mousebam campaign was targeting banks

163
00:06:14,880 --> 00:06:16,720
using microsoft publisher

164
00:06:16,720 --> 00:06:19,199
milespan campaigns happen all the time

165
00:06:19,199 --> 00:06:20,240
banks targeted

166
00:06:20,240 --> 00:06:22,639
all the time what's unusual about this

167
00:06:22,639 --> 00:06:24,400
is that threat actors don't usually

168
00:06:24,400 --> 00:06:24,960
leverage

169
00:06:24,960 --> 00:06:27,759
microsoft publisher sure you'll find

170
00:06:27,759 --> 00:06:28,880
macro

171
00:06:28,880 --> 00:06:32,160
uh in excel microsoft word

172
00:06:32,160 --> 00:06:34,720
pdfs you know we'll have mal code in

173
00:06:34,720 --> 00:06:35,199
them

174
00:06:35,199 --> 00:06:38,240
microsoft publisher not one of the big

175
00:06:38,240 --> 00:06:41,039
um platforms that are leveraged heavily

176
00:06:41,039 --> 00:06:42,639
through threat actors

177
00:06:42,639 --> 00:06:45,120
um anyway uh there was a flawed amy rap

178
00:06:45,120 --> 00:06:47,039
that was part of the curse.net

179
00:06:47,039 --> 00:06:48,880
and anybody who gets the slides and i

180
00:06:48,880 --> 00:06:50,800
know osf is going to be posting these

181
00:06:50,800 --> 00:06:52,319
later on

182
00:06:52,319 --> 00:06:54,319
there's a link to trustwave down there

183
00:06:54,319 --> 00:06:55,680
if anybody wants to read the original

184
00:06:55,680 --> 00:06:57,199
article

185
00:06:57,199 --> 00:06:59,520
but anyway it was about a week later i'm

186
00:06:59,520 --> 00:07:01,520
sitting at my desk probably multitasking

187
00:07:01,520 --> 00:07:03,440
working on a whole bunch of stuff at the

188
00:07:03,440 --> 00:07:04,639
same time

189
00:07:04,639 --> 00:07:07,360
and i get somebody running up to my desk

190
00:07:07,360 --> 00:07:09,360
and they're really frantic and freaking

191
00:07:09,360 --> 00:07:10,080
out

192
00:07:10,080 --> 00:07:11,840
and they're just amped up and they're

193
00:07:11,840 --> 00:07:14,720
telling me hey one of our vips

194
00:07:14,720 --> 00:07:17,759
tried to open up this document this

195
00:07:17,759 --> 00:07:18,800
publisher file

196
00:07:18,800 --> 00:07:21,919
actually um from their iphone

197
00:07:21,919 --> 00:07:25,039
and what you know man this is the iocs

198
00:07:25,039 --> 00:07:26,160
from that news article

199
00:07:26,160 --> 00:07:28,319
that stuff that had you know a big buzz

200
00:07:28,319 --> 00:07:30,160
because it was targeting banks

201
00:07:30,160 --> 00:07:32,240
like like this is just spot on with

202
00:07:32,240 --> 00:07:33,599
everything that we know

203
00:07:33,599 --> 00:07:35,680
about this particular flawed amy rap

204
00:07:35,680 --> 00:07:37,680
part of the nakur's botnet

205
00:07:37,680 --> 00:07:40,880
um and so what i'm being asked is hey

206
00:07:40,880 --> 00:07:42,720
we need somebody to look at this and

207
00:07:42,720 --> 00:07:44,720
understand what's happened here

208
00:07:44,720 --> 00:07:47,440
now to be honest we don't have any good

209
00:07:47,440 --> 00:07:49,919
mobile forensics tools

210
00:07:49,919 --> 00:07:52,000
and we don't really have somebody that's

211
00:07:52,000 --> 00:07:53,599
particularly

212
00:07:53,599 --> 00:07:55,919
expert level like edmund in reverse

213
00:07:55,919 --> 00:07:57,520
engineering malware let alone for a

214
00:07:57,520 --> 00:07:58,720
mobile platform

215
00:07:58,720 --> 00:08:00,240
but still in the environment i'm the

216
00:08:00,240 --> 00:08:02,080
most qualified person to try to take a

217
00:08:02,080 --> 00:08:02,720
look at it

218
00:08:02,720 --> 00:08:05,120
so what can i do and say yeah i'll dig

219
00:08:05,120 --> 00:08:06,720
into it right away

220
00:08:06,720 --> 00:08:08,319
and uh you know the frenetic visitors

221
00:08:08,319 --> 00:08:09,759
told me oh we'll get you that attachment

222
00:08:09,759 --> 00:08:11,120
right away we need to know

223
00:08:11,120 --> 00:08:13,680
you know what's going on here and figure

224
00:08:13,680 --> 00:08:15,919
out because this vip has access to all

225
00:08:15,919 --> 00:08:17,599
sorts of sensitive data

226
00:08:17,599 --> 00:08:19,840
so you know i when they first approached

227
00:08:19,840 --> 00:08:21,120
me i'm like yeah i'll look into this

228
00:08:21,120 --> 00:08:22,319
thing but as they're standing there

229
00:08:22,319 --> 00:08:23,120
talking

230
00:08:23,120 --> 00:08:25,520
and just kind of the anxiety on them

231
00:08:25,520 --> 00:08:27,199
like that's just wearing off on me and

232
00:08:27,199 --> 00:08:28,639
all of a sudden i'm starting to get

233
00:08:28,639 --> 00:08:30,400
worked up because this visitor at my

234
00:08:30,400 --> 00:08:31,680
desk

235
00:08:31,680 --> 00:08:33,440
so for the investigation we're going to

236
00:08:33,440 --> 00:08:35,200
open up the

237
00:08:35,200 --> 00:08:38,080
demo file in our pretend sandbox we're

238
00:08:38,080 --> 00:08:39,760
going to detonate

239
00:08:39,760 --> 00:08:42,159
and do research attempts and just sort

240
00:08:42,159 --> 00:08:43,360
of see the failures to understand

241
00:08:43,360 --> 00:08:45,920
anything about this file a little bit

242
00:08:45,920 --> 00:08:48,080
and then i'm going to do a strings demo

243
00:08:48,080 --> 00:08:50,399
and we'll hash the file and

244
00:08:50,399 --> 00:08:52,160
show you some of the searching i did for

245
00:08:52,160 --> 00:08:54,160
that and then we'll look at

246
00:08:54,160 --> 00:08:56,640
the exif data while i'm pondering what

247
00:08:56,640 --> 00:08:57,920
my next steps are

248
00:08:57,920 --> 00:09:00,320
so with that let me go ahead and go to

249
00:09:00,320 --> 00:09:02,320
the file here

250
00:09:02,320 --> 00:09:04,399
and i don't have microsoft publisher

251
00:09:04,399 --> 00:09:05,440
installed here in this

252
00:09:05,440 --> 00:09:07,360
linux environment so you're gonna have

253
00:09:07,360 --> 00:09:11,600
to pretend this is microsoft publisher

254
00:09:12,480 --> 00:09:15,120
and it's you know a little bit different

255
00:09:15,120 --> 00:09:17,279
than what edmund showed

256
00:09:17,279 --> 00:09:19,120
it's the same concept though the threat

257
00:09:19,120 --> 00:09:21,600
actors are essentially telling you that

258
00:09:21,600 --> 00:09:23,600
uh hey you have to click the enable

259
00:09:23,600 --> 00:09:25,120
content button

260
00:09:25,120 --> 00:09:27,040
on this file in order to see the

261
00:09:27,040 --> 00:09:28,320
contents of it

262
00:09:28,320 --> 00:09:30,640
um you know again it's a total ruse but

263
00:09:30,640 --> 00:09:32,399
we see this kind of thing in malicious

264
00:09:32,399 --> 00:09:34,399
files all the time

265
00:09:34,399 --> 00:09:37,519
so but looking at it i can't find the

266
00:09:37,519 --> 00:09:39,040
macros now i

267
00:09:39,040 --> 00:09:40,560
never spend any time on microsoft

268
00:09:40,560 --> 00:09:42,240
publisher it's just simply not

269
00:09:42,240 --> 00:09:46,160
a um productivity suite package

270
00:09:46,160 --> 00:09:48,800
that i ever use so i don't know if it's

271
00:09:48,800 --> 00:09:50,880
my own ineptitude we did have publisher

272
00:09:50,880 --> 00:09:52,720
in our sandbox environment

273
00:09:52,720 --> 00:09:54,399
but i couldn't figure anything out on

274
00:09:54,399 --> 00:09:56,160
this um

275
00:09:56,160 --> 00:09:59,519
so yeah we went ahead and uh you know

276
00:09:59,519 --> 00:10:01,760
in the sandbox it does static analysis

277
00:10:01,760 --> 00:10:04,079
and runs automated static analysis tools

278
00:10:04,079 --> 00:10:05,920
and spits out a nice report

279
00:10:05,920 --> 00:10:07,360
so we can try to understand what this

280
00:10:07,360 --> 00:10:09,760
thing actually did while that's doing

281
00:10:09,760 --> 00:10:11,519
its thing

282
00:10:11,519 --> 00:10:13,920
what i like to do if i am looking at an

283
00:10:13,920 --> 00:10:15,040
unknown file

284
00:10:15,040 --> 00:10:19,200
is just simply run strings through it

285
00:10:19,200 --> 00:10:21,360
and when i run strings what i like to do

286
00:10:21,360 --> 00:10:22,320
a lot of times

287
00:10:22,320 --> 00:10:25,200
is pipe it out through less just because

288
00:10:25,200 --> 00:10:27,279
then i can use navigational tools i can

289
00:10:27,279 --> 00:10:28,399
use find

290
00:10:28,399 --> 00:10:30,959
features stuff like that so if i pipe

291
00:10:30,959 --> 00:10:31,519
out

292
00:10:31,519 --> 00:10:34,720
strings to less i can kind of line by

293
00:10:34,720 --> 00:10:36,880
line go through what i'm looking at here

294
00:10:36,880 --> 00:10:38,160
and up at the top you see some

295
00:10:38,160 --> 00:10:40,640
interesting things you know this

296
00:10:40,640 --> 00:10:42,880
very much if you do research you find

297
00:10:42,880 --> 00:10:44,240
out this definitely looks like a

298
00:10:44,240 --> 00:10:46,399
legitimate microsoft publisher file it's

299
00:10:46,399 --> 00:10:47,839
what you would expect to see

300
00:10:47,839 --> 00:10:49,760
at the top in strings it tells you it's

301
00:10:49,760 --> 00:10:52,399
microsoft publisher 3 format

302
00:10:52,399 --> 00:10:54,880
ms publisher.3 and then you start

303
00:10:54,880 --> 00:10:56,800
getting like a bunch of stuff

304
00:10:56,800 --> 00:10:58,640
it's it's human readable but it doesn't

305
00:10:58,640 --> 00:11:00,160
necessarily make a whole lot of sense

306
00:11:00,160 --> 00:11:01,519
just basically some

307
00:11:01,519 --> 00:11:04,000
simple gobbledygook that uh not really

308
00:11:04,000 --> 00:11:05,920
understanding exactly what's in here

309
00:11:05,920 --> 00:11:07,519
usually what you hope to find is some

310
00:11:07,519 --> 00:11:09,120
sort of thing that you can use

311
00:11:09,120 --> 00:11:11,519
an artifact you can use for attribution

312
00:11:11,519 --> 00:11:13,120
maybe it's a comment code

313
00:11:13,120 --> 00:11:14,880
or just something that's plain text

314
00:11:14,880 --> 00:11:17,440
exposed so we talked about go language

315
00:11:17,440 --> 00:11:18,240
earlier

316
00:11:18,240 --> 00:11:20,560
go is notorious at dumping out plain

317
00:11:20,560 --> 00:11:21,519
text

318
00:11:21,519 --> 00:11:24,720
stuff and lots of it in high volume

319
00:11:24,720 --> 00:11:26,959
when you run strings against it but you

320
00:11:26,959 --> 00:11:29,440
can use it as a very quick and easy tool

321
00:11:29,440 --> 00:11:31,360
and if you're not using something that

322
00:11:31,360 --> 00:11:33,120
has strings within your native os

323
00:11:33,120 --> 00:11:35,680
i know you can download it for windows i

324
00:11:35,680 --> 00:11:37,120
think

325
00:11:37,120 --> 00:11:39,519
microsoft has a version of it available

326
00:11:39,519 --> 00:11:41,600
for those of you who attended the oisf

327
00:11:41,600 --> 00:11:43,920
cyber chef workshop that i put together

328
00:11:43,920 --> 00:11:46,079
you can use cyber chef

329
00:11:46,079 --> 00:11:50,399
to use strings so very powerful tool

330
00:11:50,399 --> 00:11:51,519
in this case i didn't really find

331
00:11:51,519 --> 00:11:53,920
anything particularly interesting

332
00:11:53,920 --> 00:11:57,519
so you know while the sandbox is doing

333
00:11:57,519 --> 00:11:59,040
its analysis thing

334
00:11:59,040 --> 00:12:00,720
you know let's just see what we can find

335
00:12:00,720 --> 00:12:03,600
out about it and so if i do a shaw 256

336
00:12:03,600 --> 00:12:06,959
sum of the oops i forgot the word sum

337
00:12:06,959 --> 00:12:09,600
sum of the file now i can dump out the

338
00:12:09,600 --> 00:12:10,160
hash

339
00:12:10,160 --> 00:12:13,360
for this particular file and you know do

340
00:12:13,360 --> 00:12:14,480
research on that

341
00:12:14,480 --> 00:12:17,279
and so while that analysis is running i

342
00:12:17,279 --> 00:12:18,240
can actually

343
00:12:18,240 --> 00:12:19,920
try to see if this hash has been seen in

344
00:12:19,920 --> 00:12:21,920
the wild anywhere

345
00:12:21,920 --> 00:12:24,399
so what i did with this is i went ahead

346
00:12:24,399 --> 00:12:26,720
and started looking in my usual places

347
00:12:26,720 --> 00:12:29,519
where i like to look for things so i

348
00:12:29,519 --> 00:12:30,800
went to virustotal

349
00:12:30,800 --> 00:12:33,360
and search for the hash there you

350
00:12:33,360 --> 00:12:34,480
probably won't be able to read it here

351
00:12:34,480 --> 00:12:36,079
but in the top of the address field you

352
00:12:36,079 --> 00:12:38,240
can see the hash value there

353
00:12:38,240 --> 00:12:39,760
no match is found so it didn't really

354
00:12:39,760 --> 00:12:41,839
find anything

355
00:12:41,839 --> 00:12:43,120
which i thought is unusual if we were

356
00:12:43,120 --> 00:12:45,760
getting targeted by commodity malware

357
00:12:45,760 --> 00:12:47,519
i almost you know a little surprised

358
00:12:47,519 --> 00:12:48,880
that it's never been seen anywhere

359
00:12:48,880 --> 00:12:49,600
before

360
00:12:49,600 --> 00:12:52,000
let alone having any sort of verdict on

361
00:12:52,000 --> 00:12:54,880
it as to whether it's malicious or not

362
00:12:54,880 --> 00:12:56,880
so johnny malware has a lot of the same

363
00:12:56,880 --> 00:12:58,639
engines but sometimes it has a couple

364
00:12:58,639 --> 00:12:59,040
more

365
00:12:59,040 --> 00:13:01,680
that maybe aren't there so you can see

366
00:13:01,680 --> 00:13:02,160
clearly

367
00:13:02,160 --> 00:13:04,399
searching for the hash here as well hash

368
00:13:04,399 --> 00:13:06,560
not found so this is kind of like strike

369
00:13:06,560 --> 00:13:07,600
two

370
00:13:07,600 --> 00:13:10,959
and uh just a quick note so in my case

371
00:13:10,959 --> 00:13:12,880
the tools in the environment that i had

372
00:13:12,880 --> 00:13:14,720
at the time that were available to me

373
00:13:14,720 --> 00:13:16,800
all supported shaw 256.

374
00:13:16,800 --> 00:13:18,480
i've had somebody actually ask me what

375
00:13:18,480 --> 00:13:20,800
about md5 could you use md5 absolutely

376
00:13:20,800 --> 00:13:22,079
you can use md5

377
00:13:22,079 --> 00:13:24,320
if your environment supports md5 like

378
00:13:24,320 --> 00:13:26,000
you can't trust it for certain things

379
00:13:26,000 --> 00:13:26,399
but

380
00:13:26,399 --> 00:13:28,880
for the purposes of identifying malware

381
00:13:28,880 --> 00:13:30,320
it's usually sufficient hashing

382
00:13:30,320 --> 00:13:32,639
algorithm for that

383
00:13:32,639 --> 00:13:34,480
my main point is use what's in your

384
00:13:34,480 --> 00:13:36,000
environment know what your environment

385
00:13:36,000 --> 00:13:36,880
supports

386
00:13:36,880 --> 00:13:38,639
and uh you know there's no right or

387
00:13:38,639 --> 00:13:40,160
wrong there you could search

388
00:13:40,160 --> 00:13:43,519
both ways if you wanted to hybrid

389
00:13:43,519 --> 00:13:45,040
analysis is a

390
00:13:45,040 --> 00:13:47,199
platform that'll do its own static

391
00:13:47,199 --> 00:13:49,440
analysis this is something that's free

392
00:13:49,440 --> 00:13:51,440
that i was able to use that are you know

393
00:13:51,440 --> 00:13:53,440
in addition to our commercial solution

394
00:13:53,440 --> 00:13:55,199
because as we all know some skiers will

395
00:13:55,199 --> 00:13:57,680
find things that others miss right

396
00:13:57,680 --> 00:13:59,360
so i'm just trying to cast a wide net

397
00:13:59,360 --> 00:14:00,720
here but it's

398
00:14:00,720 --> 00:14:02,240
getting interesting that all these

399
00:14:02,240 --> 00:14:03,920
places i'm searching nothing is seeing

400
00:14:03,920 --> 00:14:06,959
this particular file

401
00:14:06,959 --> 00:14:08,320
so as i'm kind of wondering what's going

402
00:14:08,320 --> 00:14:10,639
on here like i can't find anything about

403
00:14:10,639 --> 00:14:11,600
this and then

404
00:14:11,600 --> 00:14:13,519
you know about that time i start getting

405
00:14:13,519 --> 00:14:15,199
the report

406
00:14:15,199 --> 00:14:17,600
that uh you know it's not really finding

407
00:14:17,600 --> 00:14:19,760
any malicious content here no

408
00:14:19,760 --> 00:14:22,959
no bad artifacts so i'm spending a ton

409
00:14:22,959 --> 00:14:24,079
of time

410
00:14:24,079 --> 00:14:27,519
searching on flawed amy the curse.net

411
00:14:27,519 --> 00:14:30,000
i'm looking for iocs i'm googling

412
00:14:30,000 --> 00:14:31,920
different artifacts they're reporting

413
00:14:31,920 --> 00:14:33,440
like all this stuff is taking a lot of

414
00:14:33,440 --> 00:14:36,079
time i also search for the hash

415
00:14:36,079 --> 00:14:39,440
on google and nothing so

416
00:14:39,440 --> 00:14:41,680
at this point i'm really kind of

417
00:14:41,680 --> 00:14:43,440
thinking you know this is

418
00:14:43,440 --> 00:14:45,920
this isn't good and i'm not quite sure

419
00:14:45,920 --> 00:14:48,399
exactly what to do i can't identify this

420
00:14:48,399 --> 00:14:50,880
nothing flags it as being malicious you

421
00:14:50,880 --> 00:14:52,800
know when i did our internal scanning

422
00:14:52,800 --> 00:14:54,959
when i ran it through our sandbox

423
00:14:54,959 --> 00:14:56,320
detonation process

424
00:14:56,320 --> 00:14:59,360
there's nothing that makes me say this

425
00:14:59,360 --> 00:15:00,480
is definitely bad

426
00:15:00,480 --> 00:15:04,079
and um but you know again it matches

427
00:15:04,079 --> 00:15:05,760
those iocs from what we know

428
00:15:05,760 --> 00:15:08,880
about flawed amy so it's still very

429
00:15:08,880 --> 00:15:10,079
concerning

430
00:15:10,079 --> 00:15:11,760
and at this point i'm thinking you know

431
00:15:11,760 --> 00:15:13,600
could this thing have been re-encoded

432
00:15:13,600 --> 00:15:15,279
is there some modification that could

433
00:15:15,279 --> 00:15:17,120
have been done by the threat actors to

434
00:15:17,120 --> 00:15:18,720
make sure it wouldn't get caught up by

435
00:15:18,720 --> 00:15:20,079
any scanners

436
00:15:20,079 --> 00:15:22,160
was this thing specially crafted some

437
00:15:22,160 --> 00:15:24,160
way specifically to target

438
00:15:24,160 --> 00:15:27,199
this vip user at our organization

439
00:15:27,199 --> 00:15:29,839
um and that all of a sudden tells me

440
00:15:29,839 --> 00:15:31,440
okay now we go from maybe some

441
00:15:31,440 --> 00:15:33,440
things commodity malware to something

442
00:15:33,440 --> 00:15:35,519
that's very specific and targeted

443
00:15:35,519 --> 00:15:36,720
and it's starting to get a little bit

444
00:15:36,720 --> 00:15:38,720
scary

445
00:15:38,720 --> 00:15:41,120
and i'm thinking okay you know i can't

446
00:15:41,120 --> 00:15:42,320
tell what this is

447
00:15:42,320 --> 00:15:45,279
so but we need to to do something here

448
00:15:45,279 --> 00:15:46,800
and what's the appropriate course of

449
00:15:46,800 --> 00:15:47,600
action

450
00:15:47,600 --> 00:15:50,560
uh first i'm thinking well it's a

451
00:15:50,560 --> 00:15:52,399
microsoft publisher file it's an

452
00:15:52,399 --> 00:15:55,440
iphone the chances that you could have

453
00:15:55,440 --> 00:15:57,759
publisher-based malware infecting an

454
00:15:57,759 --> 00:16:00,560
iphone probably pretty slim

455
00:16:00,560 --> 00:16:02,160
but i'm not comfortable with that level

456
00:16:02,160 --> 00:16:04,480
risk because this is a vip user that has

457
00:16:04,480 --> 00:16:07,040
access to lots of sensitive data

458
00:16:07,040 --> 00:16:08,639
so i'm thinking that's not really a good

459
00:16:08,639 --> 00:16:10,800
option so then i start thinking well

460
00:16:10,800 --> 00:16:12,720
what if we did a security wipe on the

461
00:16:12,720 --> 00:16:14,480
device and then

462
00:16:14,480 --> 00:16:16,320
basically let the user go about business

463
00:16:16,320 --> 00:16:17,600
as usual would that be

464
00:16:17,600 --> 00:16:19,680
thorough enough am i comfortable with

465
00:16:19,680 --> 00:16:21,199
that level of risk

466
00:16:21,199 --> 00:16:23,759
as long as the attachment and the email

467
00:16:23,759 --> 00:16:25,040
from it are gone

468
00:16:25,040 --> 00:16:28,240
we do a security wipe on the device

469
00:16:28,240 --> 00:16:29,600
i'm still not comfortable with that

470
00:16:29,600 --> 00:16:32,480
level of risk so now my thought is

471
00:16:32,480 --> 00:16:34,160
i don't know what else to do other than

472
00:16:34,160 --> 00:16:35,519
we're just going to confiscate the

473
00:16:35,519 --> 00:16:36,959
device

474
00:16:36,959 --> 00:16:38,880
shut it down throw it in the forensics

475
00:16:38,880 --> 00:16:40,320
room and

476
00:16:40,320 --> 00:16:42,160
get this person a new device now they

477
00:16:42,160 --> 00:16:44,399
weren't due for a device refresh

478
00:16:44,399 --> 00:16:46,480
yet but they were within maybe six

479
00:16:46,480 --> 00:16:48,399
months or less of getting a refresh

480
00:16:48,399 --> 00:16:50,399
anyway so it probably wouldn't have been

481
00:16:50,399 --> 00:16:52,160
any big deal to do that

482
00:16:52,160 --> 00:16:54,800
um but still it's gonna be bad news for

483
00:16:54,800 --> 00:16:55,759
the user

484
00:16:55,759 --> 00:16:57,360
but as i'm thinking through all these

485
00:16:57,360 --> 00:16:59,839
things in my head i finally get the idea

486
00:16:59,839 --> 00:17:01,759
like this is the dumbest thing ever but

487
00:17:01,759 --> 00:17:03,360
i didn't look at the exif data

488
00:17:03,360 --> 00:17:05,839
question

489
00:17:07,599 --> 00:17:09,280
good question so the question was was

490
00:17:09,280 --> 00:17:11,280
this targeting the corporate email or

491
00:17:11,280 --> 00:17:12,720
the personal email this was starting

492
00:17:12,720 --> 00:17:15,280
their corporate email

493
00:17:15,280 --> 00:17:16,959
so yeah and that was part of the other

494
00:17:16,959 --> 00:17:18,400
alarming thing making me think

495
00:17:18,400 --> 00:17:21,919
was this a targeted attack against us

496
00:17:21,919 --> 00:17:23,359
and as i'm thinking that might be the

497
00:17:23,359 --> 00:17:25,199
best option is to confiscate the device

498
00:17:25,199 --> 00:17:27,280
get them a new one

499
00:17:27,280 --> 00:17:28,480
i thought this is the dumbest thing ever

500
00:17:28,480 --> 00:17:30,320
but i didn't think to check the exit

501
00:17:30,320 --> 00:17:32,480
properties now windows this is very

502
00:17:32,480 --> 00:17:34,000
simple you can just right click on the

503
00:17:34,000 --> 00:17:34,400
file

504
00:17:34,400 --> 00:17:36,320
go into the properties look at the

505
00:17:36,320 --> 00:17:38,320
details see if there's an author

506
00:17:38,320 --> 00:17:40,080
assigned to it see what properties it

507
00:17:40,080 --> 00:17:40,720
has

508
00:17:40,720 --> 00:17:42,480
you know that kind of thing sometimes

509
00:17:42,480 --> 00:17:43,760
there's useful information in there

510
00:17:43,760 --> 00:17:44,799
sometimes it isn't

511
00:17:44,799 --> 00:17:46,240
now you do have to take it with a grain

512
00:17:46,240 --> 00:17:48,000
of salt because what's in there

513
00:17:48,000 --> 00:17:51,280
might be spoofed so in the linux world

514
00:17:51,280 --> 00:17:55,360
we can actually use the pearl exif tool

515
00:17:56,000 --> 00:17:58,320
and so i will run that against the file

516
00:17:58,320 --> 00:18:00,320
here and we'll go ahead and type it out

517
00:18:00,320 --> 00:18:00,799
to

518
00:18:00,799 --> 00:18:03,840
less and so we start getting the exit

519
00:18:03,840 --> 00:18:05,360
property data here

520
00:18:05,360 --> 00:18:09,840
and the mime type for this is like fpx

521
00:18:09,840 --> 00:18:12,799
you can see the extension on there image

522
00:18:12,799 --> 00:18:15,200
slash vnd.fpx i've never really seen

523
00:18:15,200 --> 00:18:16,960
this before

524
00:18:16,960 --> 00:18:18,799
but i don't look at publisher files very

525
00:18:18,799 --> 00:18:20,720
often almost never in fact

526
00:18:20,720 --> 00:18:22,480
so i started googling the stuff and i'm

527
00:18:22,480 --> 00:18:24,559
looking at it and uh

528
00:18:24,559 --> 00:18:26,480
yeah it turns out these are what you

529
00:18:26,480 --> 00:18:28,400
should see for a microsoft publisher

530
00:18:28,400 --> 00:18:29,360
file

531
00:18:29,360 --> 00:18:32,000
so by all looks like this thing looks

532
00:18:32,000 --> 00:18:33,039
normal

533
00:18:33,039 --> 00:18:34,720
and then i look at the author now the

534
00:18:34,720 --> 00:18:36,480
author in real life didn't

535
00:18:36,480 --> 00:18:40,000
exactly say test fish but we'll go back

536
00:18:40,000 --> 00:18:40,320
to

537
00:18:40,320 --> 00:18:43,120
the slides here and yeah this was

538
00:18:43,120 --> 00:18:44,559
actually a face paul

539
00:18:44,559 --> 00:18:46,720
moment and it's when you realize that

540
00:18:46,720 --> 00:18:47,840
the email attachment

541
00:18:47,840 --> 00:18:49,919
you've spent three hours or more

542
00:18:49,919 --> 00:18:51,520
researching and looking at

543
00:18:51,520 --> 00:18:54,000
came from your test fishing vendor and

544
00:18:54,000 --> 00:18:55,440
it's okay if you want to laugh at my

545
00:18:55,440 --> 00:18:56,000
pain on

546
00:18:56,000 --> 00:18:58,799
this uh because it hurt it hurt right

547
00:18:58,799 --> 00:19:00,080
here

548
00:19:00,080 --> 00:19:03,360
and so i didn't just trust that right

549
00:19:03,360 --> 00:19:04,320
like i actually went through and

550
00:19:04,320 --> 00:19:06,240
validated this i actually went into our

551
00:19:06,240 --> 00:19:08,559
mail

552
00:19:08,720 --> 00:19:10,720
you know secure mail transfer agent

553
00:19:10,720 --> 00:19:12,320
platform and looked at the

554
00:19:12,320 --> 00:19:13,919
pulled the headers out of there and i'm

555
00:19:13,919 --> 00:19:15,760
looking and it really was

556
00:19:15,760 --> 00:19:17,679
what i expected to see xor so i'm

557
00:19:17,679 --> 00:19:19,280
looking at it like i might as well just

558
00:19:19,280 --> 00:19:19,919
tell me

559
00:19:19,919 --> 00:19:21,440
yes matt this really is your test

560
00:19:21,440 --> 00:19:24,400
fishing vendors ipa address you dolt

561
00:19:24,400 --> 00:19:26,880
and why this hurts is because i've gone

562
00:19:26,880 --> 00:19:28,240
out and given talks

563
00:19:28,240 --> 00:19:30,320
called fishing forensics is it just

564
00:19:30,320 --> 00:19:32,080
suspicious or is it malicious

565
00:19:32,080 --> 00:19:35,120
and guess what i always always always

566
00:19:35,120 --> 00:19:36,559
start with the message headers

567
00:19:36,559 --> 00:19:39,200
the one time i don't man it came back

568
00:19:39,200 --> 00:19:40,320
and bit me hard

569
00:19:40,320 --> 00:19:43,280
and i felt like such a dummy so what

570
00:19:43,280 --> 00:19:44,559
went wrong here

571
00:19:44,559 --> 00:19:46,320
i got caught up in the moment by

572
00:19:46,320 --> 00:19:48,480
subconsciously letting somebody else

573
00:19:48,480 --> 00:19:51,200
influence my investigation and their

574
00:19:51,200 --> 00:19:53,120
anxiety and bad assumptions

575
00:19:53,120 --> 00:19:56,559
wore off on me uh and so

576
00:19:56,559 --> 00:19:58,559
again my standard process is always

577
00:19:58,559 --> 00:20:00,080
start with the message headers

578
00:20:00,080 --> 00:20:01,520
uh when you're investigating phishing

579
00:20:01,520 --> 00:20:03,679
emails and contents i abandoned my own

580
00:20:03,679 --> 00:20:05,679
standards this one time by focusing on

581
00:20:05,679 --> 00:20:06,000
the

582
00:20:06,000 --> 00:20:09,200
attachment first and so the road to

583
00:20:09,200 --> 00:20:10,400
redemption here

584
00:20:10,400 --> 00:20:12,400
was really just painful lessons learned

585
00:20:12,400 --> 00:20:14,320
for reminders to stick

586
00:20:14,320 --> 00:20:16,240
to my standard investigative processes

587
00:20:16,240 --> 00:20:17,360
and procedures

588
00:20:17,360 --> 00:20:19,200
if i'd started my investigation by

589
00:20:19,200 --> 00:20:20,799
looking at the headers first

590
00:20:20,799 --> 00:20:22,320
i could have closed this investigation

591
00:20:22,320 --> 00:20:24,960
out in minutes instead of hours

592
00:20:24,960 --> 00:20:26,480
and because it was test fishing i

593
00:20:26,480 --> 00:20:28,480
approved it we didn't need any further

594
00:20:28,480 --> 00:20:30,320
actions on that

595
00:20:30,320 --> 00:20:32,480
the second scenario here i'm calling

596
00:20:32,480 --> 00:20:34,400
security scanner evasion

597
00:20:34,400 --> 00:20:35,760
and we're going to talk about the code

598
00:20:35,760 --> 00:20:38,159
here in a little bit but the preface for

599
00:20:38,159 --> 00:20:39,840
this is that we get identical phishing

600
00:20:39,840 --> 00:20:40,640
emails

601
00:20:40,640 --> 00:20:42,480
they are hitting inboxes basically

602
00:20:42,480 --> 00:20:43,760
flooding inboxes

603
00:20:43,760 --> 00:20:45,600
and we're getting wide scale reports of

604
00:20:45,600 --> 00:20:47,200
this stuff coming in

605
00:20:47,200 --> 00:20:48,559
and it's defeating our security

606
00:20:48,559 --> 00:20:50,640
solutions and

607
00:20:50,640 --> 00:20:52,400
you know so i look at it in the

608
00:20:52,400 --> 00:20:53,679
hyperlink

609
00:20:53,679 --> 00:20:56,880
from the message it um doesn't look like

610
00:20:56,880 --> 00:20:58,480
the websites up anymore

611
00:20:58,480 --> 00:21:01,600
in the security tools i'm using

612
00:21:01,600 --> 00:21:03,919
so you know my thought is well maybe if

613
00:21:03,919 --> 00:21:05,520
it was taken down we don't need to

614
00:21:05,520 --> 00:21:07,440
remediate this it's already problem

615
00:21:07,440 --> 00:21:08,880
solved

616
00:21:08,880 --> 00:21:10,720
but i'm not just taking that at face

617
00:21:10,720 --> 00:21:12,080
value

618
00:21:12,080 --> 00:21:14,080
and so what i want to do is go ahead and

619
00:21:14,080 --> 00:21:16,000
investigate this and find out was the

620
00:21:16,000 --> 00:21:18,480
website really taken down

621
00:21:18,480 --> 00:21:20,240
and so for the investigation we're going

622
00:21:20,240 --> 00:21:22,720
to look at the email message source code

623
00:21:22,720 --> 00:21:24,320
we're going to look at the hyperlinks in

624
00:21:24,320 --> 00:21:26,000
particular and then we're going to check

625
00:21:26,000 --> 00:21:28,080
the landing page with a security scanner

626
00:21:28,080 --> 00:21:29,039
and again we're just

627
00:21:29,039 --> 00:21:31,600
simulating this in my pretend sandbox

628
00:21:31,600 --> 00:21:32,799
you know which is something i did in the

629
00:21:32,799 --> 00:21:34,159
real life sandbox

630
00:21:34,159 --> 00:21:35,840
then we'll look at the landing page

631
00:21:35,840 --> 00:21:37,840
source code and we'll open up the

632
00:21:37,840 --> 00:21:40,640
phishing page in a sandbox just so we

633
00:21:40,640 --> 00:21:42,240
can see it here

634
00:21:42,240 --> 00:21:47,120
so let me go ahead and go to the file

635
00:21:47,120 --> 00:21:49,919
and so here's something like the email

636
00:21:49,919 --> 00:21:51,200
that came in here

637
00:21:51,200 --> 00:21:52,559
i'll make this a little bit bigger so

638
00:21:52,559 --> 00:21:54,480
people can read it and you're not going

639
00:21:54,480 --> 00:21:56,080
to read the top line but

640
00:21:56,080 --> 00:21:58,039
it's from in this case it's from

641
00:21:58,039 --> 00:21:59,360
evil.scammer

642
00:21:59,360 --> 00:22:02,880
promise we are legit.com the subject is

643
00:22:02,880 --> 00:22:03,760
this link is

644
00:22:03,760 --> 00:22:06,720
totally safe and it's to phishing target

645
00:22:06,720 --> 00:22:08,600
which is on winning.victim

646
00:22:08,600 --> 00:22:11,520
randomtarget.org and so the email is

647
00:22:11,520 --> 00:22:13,679
something like this hello fishing target

648
00:22:13,679 --> 00:22:15,679
we have a really important message for

649
00:22:15,679 --> 00:22:17,679
you to retrieve your message

650
00:22:17,679 --> 00:22:20,480
click here that's real subtle isn't it

651
00:22:20,480 --> 00:22:21,200
regards

652
00:22:21,200 --> 00:22:24,720
spoof sender now i've been asked

653
00:22:24,720 --> 00:22:26,640
hey matt have you ever used this as a

654
00:22:26,640 --> 00:22:28,159
test fishing template

655
00:22:28,159 --> 00:22:31,280
no i haven't but most of you know as

656
00:22:31,280 --> 00:22:32,320
well as i do

657
00:22:32,320 --> 00:22:34,559
if i did use this very same email as a

658
00:22:34,559 --> 00:22:35,919
test fishing template

659
00:22:35,919 --> 00:22:37,600
there's still probably going to be at

660
00:22:37,600 --> 00:22:39,760
least one person if not more in the

661
00:22:39,760 --> 00:22:41,520
organization that's still

662
00:22:41,520 --> 00:22:43,280
going to click on this link even though

663
00:22:43,280 --> 00:22:45,120
it has more red flags in it

664
00:22:45,120 --> 00:22:46,880
than you can find inside of vladimir

665
00:22:46,880 --> 00:22:49,120
putin's garage as souvenirs from his old

666
00:22:49,120 --> 00:22:49,760
kgb

667
00:22:49,760 --> 00:22:53,520
days now i don't like to

668
00:22:53,520 --> 00:22:55,919
just hover over links to see what they

669
00:22:55,919 --> 00:22:57,200
are because i'm always afraid that

670
00:22:57,200 --> 00:22:59,120
whatever email client or browser or

671
00:22:59,120 --> 00:23:00,240
whatever i'm using

672
00:23:00,240 --> 00:23:02,880
might allow some javascript for like on

673
00:23:02,880 --> 00:23:04,559
mouse over or on hover

674
00:23:04,559 --> 00:23:06,640
something like that to execute so i like

675
00:23:06,640 --> 00:23:08,000
to actually look at the message

676
00:23:08,000 --> 00:23:10,240
source so i'm going to go into the view

677
00:23:10,240 --> 00:23:12,880
menu and pull up the message source

678
00:23:12,880 --> 00:23:14,480
and i'll make this a little bit bigger

679
00:23:14,480 --> 00:23:16,720
here this way i can safely look at

680
00:23:16,720 --> 00:23:18,720
hyperlinks without actually clicking

681
00:23:18,720 --> 00:23:21,360
anything or hovering over anything stuff

682
00:23:21,360 --> 00:23:23,600
like that so if i search for http or

683
00:23:23,600 --> 00:23:25,760
https

684
00:23:25,760 --> 00:23:29,919
sure enough i find a link

685
00:23:29,919 --> 00:23:33,120
and so from here i can copy it from the

686
00:23:33,120 --> 00:23:35,440
page code and again we know this is our

687
00:23:35,440 --> 00:23:36,480
link because you have the

688
00:23:36,480 --> 00:23:39,039
click here reference down here that's in

689
00:23:39,039 --> 00:23:40,799
that message

690
00:23:40,799 --> 00:23:43,440
and let me go ahead and open it up in

691
00:23:43,440 --> 00:23:43,919
the

692
00:23:43,919 --> 00:23:48,159
again my pretend sandbox browser right

693
00:23:48,720 --> 00:23:51,279
and google's like hey you might not want

694
00:23:51,279 --> 00:23:54,000
to trust this

695
00:23:54,159 --> 00:23:55,760
but i'm feeling dangerous since i'm in

696
00:23:55,760 --> 00:23:58,240
this environment okay

697
00:23:58,240 --> 00:24:01,200
what i get is a 404 error message pretty

698
00:24:01,200 --> 00:24:03,120
typical right looks like this file is no

699
00:24:03,120 --> 00:24:04,000
longer there this

700
00:24:04,000 --> 00:24:07,200
page is down site might be down

701
00:24:07,200 --> 00:24:08,880
so is this something i really need to

702
00:24:08,880 --> 00:24:10,640
worry about

703
00:24:10,640 --> 00:24:12,559
you know from the looks of this looks

704
00:24:12,559 --> 00:24:14,799
like it's nothing to worry about because

705
00:24:14,799 --> 00:24:15,440
the

706
00:24:15,440 --> 00:24:18,400
file isn't there but i don't really want

707
00:24:18,400 --> 00:24:20,720
to trust that so let's go ahead and

708
00:24:20,720 --> 00:24:24,559
get me out of strings here and let me

709
00:24:24,559 --> 00:24:27,600
clear this up and uh what i'm going to

710
00:24:27,600 --> 00:24:28,480
do is

711
00:24:28,480 --> 00:24:31,679
i'm going to go ahead and use curl to

712
00:24:31,679 --> 00:24:34,320
get that and i still should have the

713
00:24:34,320 --> 00:24:35,039
address

714
00:24:35,039 --> 00:24:37,679
hyperlinked in here and with curl i can

715
00:24:37,679 --> 00:24:39,760
output that to a file

716
00:24:39,760 --> 00:24:43,919
and we'll go ahead and call that

717
00:24:44,840 --> 00:24:47,520
unknown.html

718
00:24:47,520 --> 00:24:48,640
and so what that's going to do is that's

719
00:24:48,640 --> 00:24:49,760
just going to get the source code

720
00:24:49,760 --> 00:24:51,200
there's a number of ways you can pull

721
00:24:51,200 --> 00:24:51,520
down

722
00:24:51,520 --> 00:24:54,720
web source code another tool you can use

723
00:24:54,720 --> 00:24:58,640
is wget and we can just simply wget

724
00:24:58,640 --> 00:25:01,679
grab the file it's going to pull it down

725
00:25:01,679 --> 00:25:03,760
so more than one way to skin the cat

726
00:25:03,760 --> 00:25:05,120
here it doesn't really matter which

727
00:25:05,120 --> 00:25:06,720
technique you use whatever you have

728
00:25:06,720 --> 00:25:07,840
available whatever is in your

729
00:25:07,840 --> 00:25:09,200
environment whatever you're comfortable

730
00:25:09,200 --> 00:25:09,919
with

731
00:25:09,919 --> 00:25:12,000
um let me go ahead and clear up the

732
00:25:12,000 --> 00:25:15,120
screen here and if i

733
00:25:15,120 --> 00:25:19,039
look at the html files

734
00:25:19,279 --> 00:25:21,039
you'll see they're the same byte size

735
00:25:21,039 --> 00:25:22,640
919 bytes

736
00:25:22,640 --> 00:25:24,640
one is called index.html that's what i

737
00:25:24,640 --> 00:25:26,240
got through wget

738
00:25:26,240 --> 00:25:28,480
the other is what i um exported from

739
00:25:28,480 --> 00:25:29,279
curl

740
00:25:29,279 --> 00:25:31,360
um you'll see they're the same file size

741
00:25:31,360 --> 00:25:33,120
now one thing it's an artifact of the

742
00:25:33,120 --> 00:25:35,440
local demo and the fact that i'm using

743
00:25:35,440 --> 00:25:38,720
um the fact that i'm using

744
00:25:38,720 --> 00:25:42,400
uh wget to retrieve a file off of the

745
00:25:42,400 --> 00:25:43,919
local system

746
00:25:43,919 --> 00:25:47,120
is it shows the original date of the

747
00:25:47,120 --> 00:25:49,360
the file rather than today's date in

748
00:25:49,360 --> 00:25:50,159
real life

749
00:25:50,159 --> 00:25:52,159
when you use wget or curl you're going

750
00:25:52,159 --> 00:25:53,520
to get the date that you

751
00:25:53,520 --> 00:25:55,760
retrieve the file so just kind of ignore

752
00:25:55,760 --> 00:25:56,799
that part of the

753
00:25:56,799 --> 00:25:59,679
of this what you're seeing here but i

754
00:25:59,679 --> 00:26:01,200
can forensically prove that it didn't

755
00:26:01,200 --> 00:26:03,039
matter which method i used to get these

756
00:26:03,039 --> 00:26:04,159
files

757
00:26:04,159 --> 00:26:07,279
i can do another shaw 256 sum on the

758
00:26:07,279 --> 00:26:09,360
html files

759
00:26:09,360 --> 00:26:11,200
and i can see that i've got the exact

760
00:26:11,200 --> 00:26:13,600
same hash value for both files

761
00:26:13,600 --> 00:26:15,360
so it didn't matter which method i used

762
00:26:15,360 --> 00:26:17,360
either works you know go with what you

763
00:26:17,360 --> 00:26:18,799
like

764
00:26:18,799 --> 00:26:20,559
and there's other methods as well but

765
00:26:20,559 --> 00:26:22,400
those are the two common ones that i

766
00:26:22,400 --> 00:26:24,400
frequently go to

767
00:26:24,400 --> 00:26:25,919
so let's go ahead and take a look and

768
00:26:25,919 --> 00:26:29,760
see what's in the file here

769
00:26:29,760 --> 00:26:32,400
because again we just got a standard 404

770
00:26:32,400 --> 00:26:35,919
when we looked at this in our pretend

771
00:26:36,840 --> 00:26:39,840
sandbox

772
00:26:42,559 --> 00:26:44,240
i'll make this bit bigger here so people

773
00:26:44,240 --> 00:26:46,960
can see it

774
00:26:47,200 --> 00:26:49,600
we don't really get a 404 here what's

775
00:26:49,600 --> 00:26:51,760
interesting is we have some javascript

776
00:26:51,760 --> 00:26:53,039
and whether you can read and understand

777
00:26:53,039 --> 00:26:55,200
the javascript or not it's relatively

778
00:26:55,200 --> 00:26:55,600
easy

779
00:26:55,600 --> 00:26:58,080
let me break it down so basically in the

780
00:26:58,080 --> 00:27:00,080
script the first line is if the user

781
00:27:00,080 --> 00:27:02,480
agent is chrome

782
00:27:02,480 --> 00:27:04,960
go to this you redirect to this logon

783
00:27:04,960 --> 00:27:05,600
page

784
00:27:05,600 --> 00:27:10,080
this login page if it's microsoft edge

785
00:27:10,080 --> 00:27:12,960
you know it's an else statement go to

786
00:27:12,960 --> 00:27:14,000
that page

787
00:27:14,000 --> 00:27:16,240
if it's firefox go to that page if it's

788
00:27:16,240 --> 00:27:17,760
microsoft internet explorer

789
00:27:17,760 --> 00:27:20,320
opera safari if it's any of the common

790
00:27:20,320 --> 00:27:22,159
real world web browsers

791
00:27:22,159 --> 00:27:25,679
go to the login page at the very bottom

792
00:27:25,679 --> 00:27:27,679
is the final else statement that says if

793
00:27:27,679 --> 00:27:29,520
it's none of those things

794
00:27:29,520 --> 00:27:32,720
then go to the fake 404 page

795
00:27:32,720 --> 00:27:34,960
so now the sudden what you realize when

796
00:27:34,960 --> 00:27:35,760
you look at this

797
00:27:35,760 --> 00:27:38,799
is this is actually checking to see if

798
00:27:38,799 --> 00:27:40,640
you're going to the site in a real web

799
00:27:40,640 --> 00:27:41,440
browser

800
00:27:41,440 --> 00:27:43,039
or if you're using some sort of tool

801
00:27:43,039 --> 00:27:45,039
that's not a common web browser

802
00:27:45,039 --> 00:27:46,720
if you're using a common or a tool

803
00:27:46,720 --> 00:27:48,559
that's not a common web browser

804
00:27:48,559 --> 00:27:51,039
it's going to send you a 404 page to be

805
00:27:51,039 --> 00:27:51,840
deceptive

806
00:27:51,840 --> 00:27:53,520
so that you think it's already down

807
00:27:53,520 --> 00:27:55,520
there's nothing i need to do here

808
00:27:55,520 --> 00:28:00,000
what you realize looking at the other um

809
00:28:00,000 --> 00:28:03,279
looking at the other uh address here

810
00:28:03,279 --> 00:28:04,559
is that it's sending you somewhere

811
00:28:04,559 --> 00:28:06,320
entirely different if you're

812
00:28:06,320 --> 00:28:08,720
not coming in out of the sandbox but

813
00:28:08,720 --> 00:28:10,399
through some other method

814
00:28:10,399 --> 00:28:13,360
so let's oops oh i just clicked the

815
00:28:13,360 --> 00:28:14,480
wrong thing

816
00:28:14,480 --> 00:28:18,720
hold on here launch a new chrome here

817
00:28:22,159 --> 00:28:25,600
bear with me one second here

818
00:28:26,720 --> 00:28:31,440
oh somebody got two of them all right so

819
00:28:31,440 --> 00:28:34,559
let me go ahead and uh go to the page

820
00:28:34,559 --> 00:28:36,559
now and i'm getting my deceptive warning

821
00:28:36,559 --> 00:28:37,919
thing again

822
00:28:37,919 --> 00:28:41,679
yeah we know now the sudden what we have

823
00:28:41,679 --> 00:28:43,440
when we're going in a real web browser

824
00:28:43,440 --> 00:28:46,159
is a microsoft office 365 credential

825
00:28:46,159 --> 00:28:47,600
harvesting page

826
00:28:47,600 --> 00:28:49,360
and this is something that threat actors

827
00:28:49,360 --> 00:28:50,799
will use to collect

828
00:28:50,799 --> 00:28:53,200
usernames and passwords as was discussed

829
00:28:53,200 --> 00:28:55,120
earlier in this conference

830
00:28:55,120 --> 00:28:56,720
for the purpose of you know account

831
00:28:56,720 --> 00:28:59,120
takeover business email compromise

832
00:28:59,120 --> 00:29:01,919
that sort of thing but definitely

833
00:29:01,919 --> 00:29:04,080
unusual here that threat actors

834
00:29:04,080 --> 00:29:07,039
sort of went the extra mile to use the

835
00:29:07,039 --> 00:29:08,240
browser user

836
00:29:08,240 --> 00:29:11,360
agent string redirection

837
00:29:11,360 --> 00:29:13,840
to basically check to make sure you're

838
00:29:13,840 --> 00:29:15,679
using a real web browser

839
00:29:15,679 --> 00:29:17,679
where this gets a little scary is i got

840
00:29:17,679 --> 00:29:19,840
lucky because the threat actors had used

841
00:29:19,840 --> 00:29:20,799
javascript

842
00:29:20,799 --> 00:29:24,000
which is a client-side language very

843
00:29:24,000 --> 00:29:25,360
easy for me to look at

844
00:29:25,360 --> 00:29:27,520
if the threat actor had used some sort

845
00:29:27,520 --> 00:29:29,760
of server side language

846
00:29:29,760 --> 00:29:34,320
you know be it php cgi perl python ruby

847
00:29:34,320 --> 00:29:37,360
asp whatever have you

848
00:29:37,360 --> 00:29:40,000
if they had used that i wouldn't be able

849
00:29:40,000 --> 00:29:40,960
to get the code

850
00:29:40,960 --> 00:29:42,799
sure i'd be able to see that a redirect

851
00:29:42,799 --> 00:29:44,399
happened but i didn't wouldn't

852
00:29:44,399 --> 00:29:47,360
necessarily understand why

853
00:29:47,360 --> 00:29:49,120
so just something to look out for if you

854
00:29:49,120 --> 00:29:50,640
see a redirect and you can't

855
00:29:50,640 --> 00:29:52,720
you know figure out any other way it

856
00:29:52,720 --> 00:29:54,399
could be something like that

857
00:29:54,399 --> 00:29:56,399
the other thing to note here is in this

858
00:29:56,399 --> 00:29:58,080
case it was just looking for the common

859
00:29:58,080 --> 00:29:59,440
browsers

860
00:29:59,440 --> 00:30:01,039
but think about this if threat actors

861
00:30:01,039 --> 00:30:02,799
had an exploit that they knew

862
00:30:02,799 --> 00:30:05,440
only worked on firefox they could round

863
00:30:05,440 --> 00:30:06,080
robin

864
00:30:06,080 --> 00:30:09,120
check to see for firefox users

865
00:30:09,120 --> 00:30:10,799
send them to the malicious page and then

866
00:30:10,799 --> 00:30:12,880
round robin them to whatever the

867
00:30:12,880 --> 00:30:14,960
eventual destination is after they've

868
00:30:14,960 --> 00:30:16,559
you know tried to do some sort of an

869
00:30:16,559 --> 00:30:18,320
exploit against that browser

870
00:30:18,320 --> 00:30:19,840
and they can even get more granular than

871
00:30:19,840 --> 00:30:21,760
that if i know that the

872
00:30:21,760 --> 00:30:24,159
exploit will only work against certain

873
00:30:24,159 --> 00:30:26,640
versions of the firefox web browser

874
00:30:26,640 --> 00:30:29,600
again they could you know just change up

875
00:30:29,600 --> 00:30:30,880
what they're looking for in the user

876
00:30:30,880 --> 00:30:31,919
agent string

877
00:30:31,919 --> 00:30:34,640
and then really just target the specific

878
00:30:34,640 --> 00:30:35,760
browser versions

879
00:30:35,760 --> 00:30:37,679
and think what a nightmare that is to

880
00:30:37,679 --> 00:30:39,440
analyze then because if you're not

881
00:30:39,440 --> 00:30:40,240
hitting it

882
00:30:40,240 --> 00:30:42,720
with the right browser you may never see

883
00:30:42,720 --> 00:30:45,039
the attack page it gets harder to

884
00:30:45,039 --> 00:30:48,240
see harder to discover harder to detect

885
00:30:48,240 --> 00:30:50,640
you know harder to mitigate honestly to

886
00:30:50,640 --> 00:30:52,799
when they've taken those actions

887
00:30:52,799 --> 00:30:56,000
and uh you know it gets a little scary

888
00:30:56,000 --> 00:30:58,000
so the remediation in this case was we

889
00:30:58,000 --> 00:30:59,519
determined the actual phishing landing

890
00:30:59,519 --> 00:31:00,159
page

891
00:31:00,159 --> 00:31:01,600
and we blocked it through content

892
00:31:01,600 --> 00:31:03,919
filtering then we worked with our secure

893
00:31:03,919 --> 00:31:06,000
email gateway vendor to block the active

894
00:31:06,000 --> 00:31:08,159
phishing campaign because it was pouring

895
00:31:08,159 --> 00:31:08,640
in

896
00:31:08,640 --> 00:31:11,840
pretty fast and heavy

897
00:31:11,840 --> 00:31:14,159
my third and final scenario today i'm

898
00:31:14,159 --> 00:31:16,799
calling the rabbit hole

899
00:31:16,799 --> 00:31:18,720
and just do you set the table for this

900
00:31:18,720 --> 00:31:19,919
uh so i record

901
00:31:19,919 --> 00:31:21,360
received a request from a user to

902
00:31:21,360 --> 00:31:23,360
investigate an email message they got

903
00:31:23,360 --> 00:31:25,760
to determine if it was legitimate or not

904
00:31:25,760 --> 00:31:28,080
the email appears fishy at first glance

905
00:31:28,080 --> 00:31:29,840
but is it just suspicious or is it

906
00:31:29,840 --> 00:31:31,360
malicious

907
00:31:31,360 --> 00:31:34,080
that's what we need to find out so i can

908
00:31:34,080 --> 00:31:35,600
tell from the message headers when i'm

909
00:31:35,600 --> 00:31:37,200
looking at those that the source i p

910
00:31:37,200 --> 00:31:38,799
address was a mismatch for the sender's

911
00:31:38,799 --> 00:31:41,120
domain right away

912
00:31:41,120 --> 00:31:43,200
the message source code in particular

913
00:31:43,200 --> 00:31:45,440
was interesting because the link text

914
00:31:45,440 --> 00:31:47,120
didn't match the actual hyperlink

915
00:31:47,120 --> 00:31:48,640
destination

916
00:31:48,640 --> 00:31:50,240
in this case the malicious threat actors

917
00:31:50,240 --> 00:31:51,679
objective appeared to be

918
00:31:51,679 --> 00:31:54,559
credential harvesting for the purposes

919
00:31:54,559 --> 00:31:56,159
of account takeover

920
00:31:56,159 --> 00:31:58,480
and we'll take a look at that so let me

921
00:31:58,480 --> 00:32:01,840
go ahead and open up this email

922
00:32:10,480 --> 00:32:12,840
and so this pretends to be from paypal

923
00:32:12,840 --> 00:32:15,039
support of course the email address is

924
00:32:15,039 --> 00:32:16,399
pp support

925
00:32:16,399 --> 00:32:19,519
at pwned hyphen server.org

926
00:32:19,519 --> 00:32:22,240
the subject is paypal bank account

927
00:32:22,240 --> 00:32:23,840
change confirmation

928
00:32:23,840 --> 00:32:26,159
now if i have a paypal account i don't

929
00:32:26,159 --> 00:32:27,600
make any changes to it

930
00:32:27,600 --> 00:32:29,679
why would i get a message saying that

931
00:32:29,679 --> 00:32:31,840
there's a change to it

932
00:32:31,840 --> 00:32:33,440
and again this is targeting our

933
00:32:33,440 --> 00:32:34,880
unwitting victim again

934
00:32:34,880 --> 00:32:36,640
and the email is simply dear paypal

935
00:32:36,640 --> 00:32:38,960
customer we received your request

936
00:32:38,960 --> 00:32:41,600
to update your bank account on file this

937
00:32:41,600 --> 00:32:42,960
process will complete in the next

938
00:32:42,960 --> 00:32:45,919
four hours if you didn't request this

939
00:32:45,919 --> 00:32:46,880
change

940
00:32:46,880 --> 00:32:50,240
log in and reject the activity well this

941
00:32:50,240 --> 00:32:50,640
is

942
00:32:50,640 --> 00:32:52,799
meant to basically instill a sense of

943
00:32:52,799 --> 00:32:54,720
urgency because i know if i'm a user i

944
00:32:54,720 --> 00:32:55,760
didn't make changes

945
00:32:55,760 --> 00:32:58,000
i'm seeing this i'm going to start

946
00:32:58,000 --> 00:32:59,760
getting amped up a little bit

947
00:32:59,760 --> 00:33:01,360
because why is this happening is my

948
00:33:01,360 --> 00:33:02,799
account been been

949
00:33:02,799 --> 00:33:05,919
you know breached compromised and

950
00:33:05,919 --> 00:33:07,600
more importantly if i only have four

951
00:33:07,600 --> 00:33:09,600
hours and maybe it's this email came in

952
00:33:09,600 --> 00:33:10,000
an hour

953
00:33:10,000 --> 00:33:11,519
ago i've got a very limited amount of

954
00:33:11,519 --> 00:33:13,840
time hop in and reject this pending

955
00:33:13,840 --> 00:33:14,720
change

956
00:33:14,720 --> 00:33:16,480
so the threat actors are trying to

957
00:33:16,480 --> 00:33:18,080
instill the sense of urgency

958
00:33:18,080 --> 00:33:20,640
and what gets interesting here is the

959
00:33:20,640 --> 00:33:21,440
hyperlink

960
00:33:21,440 --> 00:33:24,080
that's the real paypal login page except

961
00:33:24,080 --> 00:33:24,640
that's not

962
00:33:24,640 --> 00:33:27,440
really exactly as it seems and you'll

963
00:33:27,440 --> 00:33:29,039
see here in a minute when we look at the

964
00:33:29,039 --> 00:33:30,480
source code

965
00:33:30,480 --> 00:33:33,600
what i mean by that oops go back and

966
00:33:33,600 --> 00:33:33,919
let's

967
00:33:33,919 --> 00:33:36,840
get the message source i'll make it

968
00:33:36,840 --> 00:33:39,840
bigger

969
00:33:41,120 --> 00:33:44,399
again we'll look for our http

970
00:33:44,399 --> 00:33:47,039
and so here's the link that you see in

971
00:33:47,039 --> 00:33:47,840
the email

972
00:33:47,840 --> 00:33:50,960
that goes to the real paypal login page

973
00:33:50,960 --> 00:33:52,799
but that's just the link text that's not

974
00:33:52,799 --> 00:33:54,640
the actual hyperlink itself

975
00:33:54,640 --> 00:33:57,760
the actual href for the hyperlink is

976
00:33:57,760 --> 00:33:58,720
going to

977
00:33:58,720 --> 00:34:00,519
you know my case scenario something

978
00:34:00,519 --> 00:34:04,159
right.be which is a belgium domain

979
00:34:04,159 --> 00:34:07,279
and if i'm not in belgium and i'm a

980
00:34:07,279 --> 00:34:09,599
paypal customer

981
00:34:09,599 --> 00:34:11,520
already this should send off flags that

982
00:34:11,520 --> 00:34:13,119
you know something isn't right here with

983
00:34:13,119 --> 00:34:13,918
this

984
00:34:13,918 --> 00:34:15,440
so we'll take a look at this in our

985
00:34:15,440 --> 00:34:20,399
pretend sandbox again

986
00:34:20,399 --> 00:34:22,159
and in this case you know certainly

987
00:34:22,159 --> 00:34:24,399
looks like a paypal login page

988
00:34:24,399 --> 00:34:26,320
uh looks trustworthy except the fact

989
00:34:26,320 --> 00:34:27,760
that we know

990
00:34:27,760 --> 00:34:30,719
that you know this isn't isn't right and

991
00:34:30,719 --> 00:34:32,239
we didn't make any changes

992
00:34:32,239 --> 00:34:35,520
uh that sort of thing and what gets

993
00:34:35,520 --> 00:34:36,960
really interesting is if i look in the

994
00:34:36,960 --> 00:34:38,639
address bar closely enough i notice the

995
00:34:38,639 --> 00:34:40,879
original hyperlink was a belgium domain

996
00:34:40,879 --> 00:34:43,520
this is going to dot de which is a site

997
00:34:43,520 --> 00:34:44,480
in germany

998
00:34:44,480 --> 00:34:46,560
so what that's going on here let's try

999
00:34:46,560 --> 00:34:48,399
to figure out why so we use that same

1000
00:34:48,399 --> 00:34:49,359
technique

1001
00:34:49,359 --> 00:34:53,199
of using curl and we're going to

1002
00:34:53,199 --> 00:34:56,320
get that page from the email

1003
00:34:56,320 --> 00:34:58,800
not necessarily where we ended up and

1004
00:34:58,800 --> 00:35:00,839
we'll output that

1005
00:35:00,839 --> 00:35:04,240
to first page

1006
00:35:04,240 --> 00:35:06,959
html

1007
00:35:09,040 --> 00:35:12,400
and then we'll go ahead and pull that up

1008
00:35:12,400 --> 00:35:14,839
in a text editor just so we can look at

1009
00:35:14,839 --> 00:35:17,200
it

1010
00:35:17,200 --> 00:35:20,480
and for a login page it's awful tiny for

1011
00:35:20,480 --> 00:35:21,200
the

1012
00:35:21,200 --> 00:35:24,400
actual uh html

1013
00:35:24,400 --> 00:35:27,359
the actual web content and what you see

1014
00:35:27,359 --> 00:35:27,839
here

1015
00:35:27,839 --> 00:35:31,680
is a meta refresh and what that is is

1016
00:35:31,680 --> 00:35:33,599
this way to redirect

1017
00:35:33,599 --> 00:35:36,640
a browser to go to a different page

1018
00:35:36,640 --> 00:35:38,400
so we have our first page that's in

1019
00:35:38,400 --> 00:35:40,320
belgium but we see it's actually

1020
00:35:40,320 --> 00:35:42,960
redirecting to this site here in germany

1021
00:35:42,960 --> 00:35:46,000
and it's not what we had before and we

1022
00:35:46,000 --> 00:35:46,960
noticed

1023
00:35:46,960 --> 00:35:48,640
from the sandbox that's kind of where we

1024
00:35:48,640 --> 00:35:50,000
ended up as well

1025
00:35:50,000 --> 00:35:52,000
so really it's not the first landing

1026
00:35:52,000 --> 00:35:54,400
page but the second one

1027
00:35:54,400 --> 00:35:56,960
that we need to look at next so let's go

1028
00:35:56,960 --> 00:35:58,000
ahead and do that

1029
00:35:58,000 --> 00:36:01,119
we'll go ahead and use curl again we'll

1030
00:36:01,119 --> 00:36:03,839
put in our second destination

1031
00:36:03,839 --> 00:36:13,839
and we'll output that to second page

1032
00:36:14,320 --> 00:36:17,280
now let's look at the source code here

1033
00:36:17,280 --> 00:36:17,680
um

1034
00:36:17,680 --> 00:36:19,599
again pretty tiny for what we would

1035
00:36:19,599 --> 00:36:21,680
expect

1036
00:36:21,680 --> 00:36:24,079
and the reason for that is that you

1037
00:36:24,079 --> 00:36:26,000
notice in the code

1038
00:36:26,000 --> 00:36:28,480
there's another domain in here and it's

1039
00:36:28,480 --> 00:36:29,119
inside of an

1040
00:36:29,119 --> 00:36:32,960
iframe and with the style command of

1041
00:36:32,960 --> 00:36:34,400
absolute 100

1042
00:36:34,400 --> 00:36:36,320
width and height and no border this is a

1043
00:36:36,320 --> 00:36:37,839
seamless iframe

1044
00:36:37,839 --> 00:36:39,359
so the second page we think we're

1045
00:36:39,359 --> 00:36:40,960
looking at we're not even looking at

1046
00:36:40,960 --> 00:36:42,720
that because the content

1047
00:36:42,720 --> 00:36:45,760
is actually coming from this third page

1048
00:36:45,760 --> 00:36:47,440
so let's go ahead and get the source

1049
00:36:47,440 --> 00:36:54,880
code for that page

1050
00:36:54,880 --> 00:37:00,160
and we'll output that to third page

1051
00:37:03,599 --> 00:37:09,839
and we'll take a look at that

1052
00:37:10,000 --> 00:37:11,839
and what do we end up with here

1053
00:37:11,839 --> 00:37:14,640
gobbledygook

1054
00:37:14,800 --> 00:37:17,520
now believe it or not i actually made

1055
00:37:17,520 --> 00:37:17,920
this

1056
00:37:17,920 --> 00:37:19,359
more readable and you're probably

1057
00:37:19,359 --> 00:37:20,839
thinking what you made this more

1058
00:37:20,839 --> 00:37:22,720
readable

1059
00:37:22,720 --> 00:37:24,160
because it doesn't look very readable to

1060
00:37:24,160 --> 00:37:27,040
me now what i mean by more readable is i

1061
00:37:27,040 --> 00:37:28,320
put in some white space

1062
00:37:28,320 --> 00:37:30,240
this could all just be one block of

1063
00:37:30,240 --> 00:37:31,760
garbage with no

1064
00:37:31,760 --> 00:37:34,960
real easy way to discern you know

1065
00:37:34,960 --> 00:37:37,599
what's going on in here content-wise but

1066
00:37:37,599 --> 00:37:39,520
we can tell right away that some sort of

1067
00:37:39,520 --> 00:37:40,800
javascript

1068
00:37:40,800 --> 00:37:43,200
and we can see it's using some sort of a

1069
00:37:43,200 --> 00:37:46,720
unescape sequence here

1070
00:37:46,880 --> 00:37:50,560
and i'm just going to make a wild guess

1071
00:37:50,560 --> 00:37:52,720
that there's a good chance that this is

1072
00:37:52,720 --> 00:37:54,560
some sort of a function that's getting

1073
00:37:54,560 --> 00:37:55,280
fed back

1074
00:37:55,280 --> 00:38:00,079
into the the actual

1075
00:38:01,119 --> 00:38:03,760
unescape sequence but it's not really

1076
00:38:03,760 --> 00:38:05,040
readable

1077
00:38:05,040 --> 00:38:07,200
now in the olden days this was kind of a

1078
00:38:07,200 --> 00:38:08,800
pain you would actually basically have

1079
00:38:08,800 --> 00:38:09,680
to

1080
00:38:09,680 --> 00:38:12,800
unescape the sequence following that

1081
00:38:12,800 --> 00:38:14,720
and then feed the function back into it

1082
00:38:14,720 --> 00:38:16,560
to basically get the

1083
00:38:16,560 --> 00:38:18,720
actual web code out the important thing

1084
00:38:18,720 --> 00:38:19,760
to remember though

1085
00:38:19,760 --> 00:38:21,760
is with modern web browsers any web

1086
00:38:21,760 --> 00:38:23,040
browser really

1087
00:38:23,040 --> 00:38:24,560
if something's going to be readable on

1088
00:38:24,560 --> 00:38:26,320
the screen it has to be something that

1089
00:38:26,320 --> 00:38:27,280
can be decoded

1090
00:38:27,280 --> 00:38:29,440
at some level by the browser because if

1091
00:38:29,440 --> 00:38:31,200
it's not possible to do that

1092
00:38:31,200 --> 00:38:33,119
you'll never see it so the three editors

1093
00:38:33,119 --> 00:38:35,359
wouldn't use a technique like that

1094
00:38:35,359 --> 00:38:38,320
unfortunately with modern browsers we

1095
00:38:38,320 --> 00:38:40,880
actually have

1096
00:38:40,880 --> 00:38:43,359
a developer tools that are built into

1097
00:38:43,359 --> 00:38:45,119
the browser that we can use

1098
00:38:45,119 --> 00:38:47,440
to sort of do the heavy lifting for us

1099
00:38:47,440 --> 00:38:49,119
and see what's going on

1100
00:38:49,119 --> 00:38:50,960
so again just to recap we talked about

1101
00:38:50,960 --> 00:38:53,119
the first destination going to

1102
00:38:53,119 --> 00:38:55,359
a compromised web host on one foreign

1103
00:38:55,359 --> 00:38:56,160
country

1104
00:38:56,160 --> 00:38:58,720
it didn't stop there it went to a

1105
00:38:58,720 --> 00:39:00,800
another compromise web host in yet

1106
00:39:00,800 --> 00:39:02,320
another country

1107
00:39:02,320 --> 00:39:04,640
and then the third destination is a

1108
00:39:04,640 --> 00:39:07,200
compromise web host in a third country

1109
00:39:07,200 --> 00:39:09,440
so like this thing has many layers of

1110
00:39:09,440 --> 00:39:11,760
obfuscations starting all the way back

1111
00:39:11,760 --> 00:39:14,320
to the original hyperlink not matching

1112
00:39:14,320 --> 00:39:15,440
the you know the

1113
00:39:15,440 --> 00:39:18,560
linked text in the email itself

1114
00:39:18,560 --> 00:39:20,960
um so we got the source code we looked

1115
00:39:20,960 --> 00:39:22,000
at that

1116
00:39:22,000 --> 00:39:23,839
we see that it's got the javascript

1117
00:39:23,839 --> 00:39:25,200
encoding

1118
00:39:25,200 --> 00:39:27,119
and so what we'll do is we'll use the

1119
00:39:27,119 --> 00:39:29,119
built-in browser developer tools

1120
00:39:29,119 --> 00:39:30,800
and try to understand this and make a

1121
00:39:30,800 --> 00:39:32,400
little more sense of it

1122
00:39:32,400 --> 00:39:36,000
so let me go ahead and

1123
00:39:37,599 --> 00:39:40,720
pull in the browser developer tools get

1124
00:39:40,720 --> 00:39:41,119
those

1125
00:39:41,119 --> 00:39:46,640
loaded up so now if i come back in here

1126
00:39:46,640 --> 00:39:48,880
and i reload the uh you know that final

1127
00:39:48,880 --> 00:39:52,000
destination page

1128
00:39:52,320 --> 00:39:55,440
now i can bounce back into the tools

1129
00:39:55,440 --> 00:39:56,960
here

1130
00:39:56,960 --> 00:40:00,960
and i can see here that i've got

1131
00:40:00,960 --> 00:40:04,079
just a very small level of html but what

1132
00:40:04,079 --> 00:40:04,880
i can do

1133
00:40:04,880 --> 00:40:08,079
is i can actually right click

1134
00:40:08,079 --> 00:40:11,119
edit as html now this looks exactly like

1135
00:40:11,119 --> 00:40:13,200
what our text file did when we opened it

1136
00:40:13,200 --> 00:40:14,640
up in a text editor

1137
00:40:14,640 --> 00:40:16,400
and we can see a little better now you

1138
00:40:16,400 --> 00:40:18,000
know we've got the uh

1139
00:40:18,000 --> 00:40:19,839
you know javascript here at the top we

1140
00:40:19,839 --> 00:40:21,680
can see the unescape sequence

1141
00:40:21,680 --> 00:40:24,319
uh we can guess that that's pulling this

1142
00:40:24,319 --> 00:40:26,880
df might be some sort of a function

1143
00:40:26,880 --> 00:40:29,119
and it's very long as you probably get

1144
00:40:29,119 --> 00:40:31,440
the idea from looking at the text file

1145
00:40:31,440 --> 00:40:34,319
but if we keep going in this now all of

1146
00:40:34,319 --> 00:40:35,920
a sudden we actually get to

1147
00:40:35,920 --> 00:40:39,119
the actual decoded content here

1148
00:40:39,119 --> 00:40:40,880
so the browser developer tools will

1149
00:40:40,880 --> 00:40:42,880
actually decode that javascript for us

1150
00:40:42,880 --> 00:40:44,720
in order for us to read it

1151
00:40:44,720 --> 00:40:46,880
we can actually see the plain text

1152
00:40:46,880 --> 00:40:49,200
version of the unescape sequence

1153
00:40:49,200 --> 00:40:50,640
and then we see something interesting

1154
00:40:50,640 --> 00:40:52,480
here because we end up with more

1155
00:40:52,480 --> 00:40:54,480
gobbledygook right but if you look at

1156
00:40:54,480 --> 00:40:55,520
the uh

1157
00:40:55,520 --> 00:40:58,160
the link here the uh you know it's

1158
00:40:58,160 --> 00:41:00,400
basically calling a shortcut icon

1159
00:41:00,400 --> 00:41:03,680
um the mime type here of image

1160
00:41:03,680 --> 00:41:07,920
slash x-icon and then we see base64

1161
00:41:07,920 --> 00:41:09,839
so i'm going to guess that this is like

1162
00:41:09,839 --> 00:41:12,400
a base64 encoded fave icon

1163
00:41:12,400 --> 00:41:16,480
for the page but we'll just kind of look

1164
00:41:16,480 --> 00:41:18,319
over that a little bit here and go

1165
00:41:18,319 --> 00:41:20,079
forward and sure enough

1166
00:41:20,079 --> 00:41:22,800
we start seeing more regular html but

1167
00:41:22,800 --> 00:41:24,319
then we see more

1168
00:41:24,319 --> 00:41:27,520
base64 encoding down here and again

1169
00:41:27,520 --> 00:41:29,760
from the you know mime type we get the

1170
00:41:29,760 --> 00:41:30,560
idea

1171
00:41:30,560 --> 00:41:34,400
that it's a jpeg file and space 64

1172
00:41:34,400 --> 00:41:36,880
encoded and then you know once we get

1173
00:41:36,880 --> 00:41:37,760
past that

1174
00:41:37,760 --> 00:41:40,640
there's more html in here that sort of

1175
00:41:40,640 --> 00:41:41,839
thing

1176
00:41:41,839 --> 00:41:43,359
what's really nice about browser

1177
00:41:43,359 --> 00:41:45,119
developer tools is if i click on the

1178
00:41:45,119 --> 00:41:46,480
network tab

1179
00:41:46,480 --> 00:41:50,079
and then i uh you know i'm on the image

1180
00:41:50,079 --> 00:41:52,560
tab here you'll see it actually pulled

1181
00:41:52,560 --> 00:41:54,400
the file and if i mouse over that i get

1182
00:41:54,400 --> 00:41:55,440
the base64

1183
00:41:55,440 --> 00:41:58,480
decoded or encoded value of it

1184
00:41:58,480 --> 00:42:00,240
tells me it's a jpeg all the stuff i

1185
00:42:00,240 --> 00:42:02,000
sort of expected to see based on the

1186
00:42:02,000 --> 00:42:04,880
code i was looking at just a moment ago

1187
00:42:04,880 --> 00:42:08,000
what's really cool about this though is

1188
00:42:08,000 --> 00:42:11,599
that we can actually click on that

1189
00:42:11,599 --> 00:42:13,599
and there's a preview tab that comes

1190
00:42:13,599 --> 00:42:15,440
available and we see a paypal

1191
00:42:15,440 --> 00:42:19,040
logo and if we go back to the page

1192
00:42:19,040 --> 00:42:20,720
we can kind of marry this up with what

1193
00:42:20,720 --> 00:42:22,480
we were looking at and so there

1194
00:42:22,480 --> 00:42:25,280
at the very top right here is the paypal

1195
00:42:25,280 --> 00:42:27,280
logo

1196
00:42:27,280 --> 00:42:28,800
what's interesting about the developer

1197
00:42:28,800 --> 00:42:30,319
tools though is it didn't get that first

1198
00:42:30,319 --> 00:42:31,920
b64

1199
00:42:31,920 --> 00:42:34,960
encoded item and again we're guessing

1200
00:42:34,960 --> 00:42:37,359
that's like some sort of a fav icon

1201
00:42:37,359 --> 00:42:39,040
something like that so let me edit the

1202
00:42:39,040 --> 00:42:41,760
html and

1203
00:42:41,760 --> 00:42:43,280
we'll kind of show the old school way

1204
00:42:43,280 --> 00:42:44,960
that we can do something like that by

1205
00:42:44,960 --> 00:42:46,160
hand

1206
00:42:46,160 --> 00:42:47,520
and i kind of talk about that in the

1207
00:42:47,520 --> 00:42:49,599
slide deck here and so whether the

1208
00:42:49,599 --> 00:42:51,280
threat actor they've used encoded

1209
00:42:51,280 --> 00:42:52,319
elements

1210
00:42:52,319 --> 00:42:54,640
to avoid analysis and detection or just

1211
00:42:54,640 --> 00:42:56,960
keep the entire site as one single page

1212
00:42:56,960 --> 00:42:57,760
file

1213
00:42:57,760 --> 00:43:00,640
they also use base64 encoded elements

1214
00:43:00,640 --> 00:43:01,680
that we've seen

1215
00:43:01,680 --> 00:43:04,240
inside of their javascript encoded page

1216
00:43:04,240 --> 00:43:06,319
so now we have encoding

1217
00:43:06,319 --> 00:43:08,720
embedded in encoding using a couple

1218
00:43:08,720 --> 00:43:10,560
different techniques for it so

1219
00:43:10,560 --> 00:43:12,960
very interesting and like i said it's

1220
00:43:12,960 --> 00:43:14,800
hard to guess the motive

1221
00:43:14,800 --> 00:43:17,599
but you know either way kind of sneaky

1222
00:43:17,599 --> 00:43:18,720
and something that we can

1223
00:43:18,720 --> 00:43:20,480
kind of understand a little bit and so

1224
00:43:20,480 --> 00:43:22,560
we've looked at decoding them using the

1225
00:43:22,560 --> 00:43:23,920
browser developer tools

1226
00:43:23,920 --> 00:43:25,520
let's see what that looks like doing it

1227
00:43:25,520 --> 00:43:28,000
by hand so i have to scroll past

1228
00:43:28,000 --> 00:43:31,119
the encoded part here and now i can get

1229
00:43:31,119 --> 00:43:32,240
to

1230
00:43:32,240 --> 00:43:35,520
the actual content of the

1231
00:43:35,520 --> 00:43:38,800
first base64 encoded item and in this

1232
00:43:38,800 --> 00:43:39,440
case

1233
00:43:39,440 --> 00:43:43,119
i'm going to go ahead and guess that

1234
00:43:43,119 --> 00:43:44,960
you know this is a fave icon so i'm just

1235
00:43:44,960 --> 00:43:46,480
going to copy this

1236
00:43:46,480 --> 00:43:48,960
you can paste it in any text editor you

1237
00:43:48,960 --> 00:43:50,400
want

1238
00:43:50,400 --> 00:43:51,839
and i'm just going to go ahead and save

1239
00:43:51,839 --> 00:43:53,599
this

1240
00:43:53,599 --> 00:43:58,800
and we'll call it unknown dot txt

1241
00:43:59,040 --> 00:44:01,200
and save it and so we just have our our

1242
00:44:01,200 --> 00:44:03,599
plain text file that's that base64

1243
00:44:03,599 --> 00:44:07,119
stuff and so then we can basically

1244
00:44:07,119 --> 00:44:08,079
decode this by

1245
00:44:08,079 --> 00:44:10,560
hand so let me go back to the terminal

1246
00:44:10,560 --> 00:44:11,200
here

1247
00:44:11,200 --> 00:44:13,359
i'm going to go ahead and clear this out

1248
00:44:13,359 --> 00:44:17,759
and i'm going to run base64 command

1249
00:44:18,800 --> 00:44:22,240
oops do a dash d to d code

1250
00:44:22,240 --> 00:44:25,520
and we know it's unknown.txt and we're

1251
00:44:25,520 --> 00:44:27,200
going to basically redirect that output

1252
00:44:27,200 --> 00:44:27,920
to

1253
00:44:27,920 --> 00:44:30,640
fave icon

1254
00:44:32,240 --> 00:44:35,599
ico and actually i am going to throw a

1255
00:44:35,599 --> 00:44:38,720
hyphen dash i in here base64-i

1256
00:44:38,720 --> 00:44:40,800
just sort of ignores any warnings or

1257
00:44:40,800 --> 00:44:42,560
stuff that thinks it can't interpret

1258
00:44:42,560 --> 00:44:45,119
and spits out or redirected output to

1259
00:44:45,119 --> 00:44:46,720
fave icon

1260
00:44:46,720 --> 00:44:49,520
so now if i come in here and look in my

1261
00:44:49,520 --> 00:44:51,480
dfir folder i should have the

1262
00:44:51,480 --> 00:44:53,920
favicon.ico file

1263
00:44:53,920 --> 00:44:59,359
and if i go ahead and blow this thing up

1264
00:45:00,000 --> 00:45:01,440
you know it sure looks like it might be

1265
00:45:01,440 --> 00:45:03,440
a favicon file

1266
00:45:03,440 --> 00:45:05,119
and i know it's going to be microscopic

1267
00:45:05,119 --> 00:45:07,119
and you may not be able to see this

1268
00:45:07,119 --> 00:45:09,280
well or if at all but you can tell here

1269
00:45:09,280 --> 00:45:10,960
in the top of the browser tab you get

1270
00:45:10,960 --> 00:45:11,920
that little paypal

1271
00:45:11,920 --> 00:45:14,319
fave icon so we've successfully at this

1272
00:45:14,319 --> 00:45:15,760
point decoded

1273
00:45:15,760 --> 00:45:17,920
the two encoded elements inside of our

1274
00:45:17,920 --> 00:45:19,119
encoded

1275
00:45:19,119 --> 00:45:21,920
web file to really understand you know

1276
00:45:21,920 --> 00:45:22,560
what the

1277
00:45:22,560 --> 00:45:25,680
those elements of it are

1278
00:45:25,680 --> 00:45:28,319
so that's kind of doing it by hand but

1279
00:45:28,319 --> 00:45:28,800
anyway

1280
00:45:28,800 --> 00:45:30,319
in this rate even though they sent us on

1281
00:45:30,319 --> 00:45:32,640
a wild goose chase we determined the

1282
00:45:32,640 --> 00:45:33,200
final

1283
00:45:33,200 --> 00:45:35,280
landing page and we blocked it through

1284
00:45:35,280 --> 00:45:36,880
web content filtering

1285
00:45:36,880 --> 00:45:38,079
we also went ahead and blocked the

1286
00:45:38,079 --> 00:45:40,800
intermediary sites since we knew they

1287
00:45:40,800 --> 00:45:42,480
were compromised as well

1288
00:45:42,480 --> 00:45:44,240
in order for threat actors to leverage

1289
00:45:44,240 --> 00:45:46,560
those and again it gets harder to shut

1290
00:45:46,560 --> 00:45:48,160
this thing down because if you only shut

1291
00:45:48,160 --> 00:45:50,160
down the first address that you had

1292
00:45:50,160 --> 00:45:52,480
you're gonna miss where the final

1293
00:45:52,480 --> 00:45:53,280
payload is

1294
00:45:53,280 --> 00:45:54,800
they could send something else that's

1295
00:45:54,800 --> 00:45:56,800
using those same

1296
00:45:56,800 --> 00:45:58,400
redirect techniques and there's a bunch

1297
00:45:58,400 --> 00:46:00,160
of them but the ones i had witnessed

1298
00:46:00,160 --> 00:46:01,520
personally on it were

1299
00:46:01,520 --> 00:46:04,880
the meta refresh and the iframe as a way

1300
00:46:04,880 --> 00:46:07,280
to serve up that content

1301
00:46:07,280 --> 00:46:08,960
once we blocked everything we reported

1302
00:46:08,960 --> 00:46:10,640
to compromise website owners

1303
00:46:10,640 --> 00:46:12,560
this was a lot easier in the past before

1304
00:46:12,560 --> 00:46:14,800
who is data was all privatized

1305
00:46:14,800 --> 00:46:18,079
uh and privacy enforced so you could

1306
00:46:18,079 --> 00:46:19,680
actually tell where to email abuse

1307
00:46:19,680 --> 00:46:22,640
complaints so we did that as well

1308
00:46:22,640 --> 00:46:25,200
so that's really it but you know

1309
00:46:25,200 --> 00:46:26,560
definitely as you see me hanging out

1310
00:46:26,560 --> 00:46:28,000
here afterwards if you want to

1311
00:46:28,000 --> 00:46:30,480
join micah and penelope and i at the

1312
00:46:30,480 --> 00:46:32,000
troll pub afterwards

1313
00:46:32,000 --> 00:46:34,000
uh feel free to hit me up give me your

1314
00:46:34,000 --> 00:46:36,240
own dfir stories i love hearing war

1315
00:46:36,240 --> 00:46:37,280
stories

1316
00:46:37,280 --> 00:46:39,920
and with that let me just say friends

1317
00:46:39,920 --> 00:46:40,800
romans

1318
00:46:40,800 --> 00:46:45,050
oisf attendees lend me your irs

1319
00:46:45,050 --> 00:46:47,820
[Music]

1320
00:46:47,820 --> 00:46:49,760
[Applause]

1321
00:46:49,760 --> 00:46:57,839
any questions

1322
00:47:03,760 --> 00:47:06,079
oh uh so for reverse engineering malware

1323
00:47:06,079 --> 00:47:07,280
we have actually had a commercial

1324
00:47:07,280 --> 00:47:08,240
solution

1325
00:47:08,240 --> 00:47:10,240
um so if you don't have a commercial

1326
00:47:10,240 --> 00:47:11,440
solution available

1327
00:47:11,440 --> 00:47:14,000
sift and remnucks are awesome you can

1328
00:47:14,000 --> 00:47:15,200
definitely use

1329
00:47:15,200 --> 00:47:18,800
tools from either of those to do

1330
00:47:18,800 --> 00:47:20,400
you know definitely good analysis

1331
00:47:20,400 --> 00:47:22,559
particularly static analysis

1332
00:47:22,559 --> 00:47:23,839
so if i didn't have the commercial

1333
00:47:23,839 --> 00:47:25,359
solution that we were paying big bucks

1334
00:47:25,359 --> 00:47:25,920
for

1335
00:47:25,920 --> 00:47:27,359
i definitely would have used one of

1336
00:47:27,359 --> 00:47:28,640
those if i didn't have one of those

1337
00:47:28,640 --> 00:47:29,839
available

1338
00:47:29,839 --> 00:47:39,839
but a good question yes

1339
00:47:40,400 --> 00:47:42,079
you have a way to just say i want my

1340
00:47:42,079 --> 00:47:44,000
user agent to do this so you can pretend

1341
00:47:44,000 --> 00:47:46,000
to be a browser

1342
00:47:46,000 --> 00:47:48,960
yeah there are it depends on the tool

1343
00:47:48,960 --> 00:47:50,000
some will support

1344
00:47:50,000 --> 00:47:52,000
customizing headers and some of them

1345
00:47:52,000 --> 00:47:53,680
will even give you a list

1346
00:47:53,680 --> 00:47:56,240
of hey here's headers you can select for

1347
00:47:56,240 --> 00:47:59,040
port to be whatever browser you want

1348
00:47:59,040 --> 00:48:00,960
and you see thread actors and a lot of

1349
00:48:00,960 --> 00:48:02,720
the offensive security tools

1350
00:48:02,720 --> 00:48:06,079
will rotate through you'll see attack

1351
00:48:06,079 --> 00:48:06,720
from

1352
00:48:06,720 --> 00:48:09,520
you know the same you know origin

1353
00:48:09,520 --> 00:48:10,480
address

1354
00:48:10,480 --> 00:48:12,240
and you see them cycling through a bunch

1355
00:48:12,240 --> 00:48:14,720
of different user agent strings

1356
00:48:14,720 --> 00:48:18,000
so some defensive security tools will

1357
00:48:18,000 --> 00:48:20,640
do that some won't really just depends

1358
00:48:20,640 --> 00:48:22,960
on the solution you're using

1359
00:48:22,960 --> 00:48:25,760
but you can certainly do it by hand in

1360
00:48:25,760 --> 00:48:28,160
particular chrome makes it very easy

1361
00:48:28,160 --> 00:48:29,359
i haven't really messed around with it

1362
00:48:29,359 --> 00:48:31,599
in firefox and some of the microsoft

1363
00:48:31,599 --> 00:48:32,800
browsers but i imagine you could

1364
00:48:32,800 --> 00:48:34,880
probably do it in those as well

1365
00:48:34,880 --> 00:48:37,280
and then i've also seen like extensions

1366
00:48:37,280 --> 00:48:39,200
for those other browsers that will

1367
00:48:39,200 --> 00:48:41,599
let you select specific user agent

1368
00:48:41,599 --> 00:48:42,960
strings

1369
00:48:42,960 --> 00:48:44,640
so there are definitely options out

1370
00:48:44,640 --> 00:48:46,400
there but there may be some

1371
00:48:46,400 --> 00:48:48,160
security tools that don't let you do

1372
00:48:48,160 --> 00:48:50,079
that and they just send a

1373
00:48:50,079 --> 00:48:53,200
default um user agent that's not a known

1374
00:48:53,200 --> 00:48:53,680
good

1375
00:48:53,680 --> 00:48:56,720
you know normal everyday user browser if

1376
00:48:56,720 --> 00:48:59,040
you will

1377
00:49:00,880 --> 00:49:02,800
yes you can set the user agent string

1378
00:49:02,800 --> 00:49:04,000
and curl as well

1379
00:49:04,000 --> 00:49:05,520
in this case i'm not really interacting

1380
00:49:05,520 --> 00:49:06,960
with it so i didn't really need to

1381
00:49:06,960 --> 00:49:08,720
specify any options

1382
00:49:08,720 --> 00:49:10,319
just for the purpose of retrieving the

1383
00:49:10,319 --> 00:49:12,559
page but if you're actively interacting

1384
00:49:12,559 --> 00:49:14,160
with the page and sending commands to

1385
00:49:14,160 --> 00:49:15,359
the page

1386
00:49:15,359 --> 00:49:18,559
yeah you can absolutely within curl use

1387
00:49:18,559 --> 00:49:21,440
the different options to set your user

1388
00:49:21,440 --> 00:49:24,240
agent string to be what you'd like

1389
00:49:24,240 --> 00:49:28,400
so great point anything else

1390
00:49:28,400 --> 00:49:29,920
all right folks i have one humble

1391
00:49:29,920 --> 00:49:32,640
request i'm almost at a thousand twitter

1392
00:49:32,640 --> 00:49:34,480
followers help me out and i need like

1393
00:49:34,480 --> 00:49:37,000
five more if you're not following me at

1394
00:49:37,000 --> 00:49:40,079
c3rkah please do

1395
00:49:40,079 --> 00:49:43,119
thank you maybe you get the

1396
00:49:43,119 --> 00:49:44,400
prize you're gonna give out when you get

1397
00:49:44,400 --> 00:49:48,720
about i don't think it works like that

1398
00:49:49,440 --> 00:49:51,040
besides you'd be really upset if i gave

1399
00:49:51,040 --> 00:49:52,640
you like an oisf uh

1400
00:49:52,640 --> 00:49:56,160
you know glass i'll just go

1401
00:49:56,160 --> 00:49:57,599
i'm just joking man that's like one of

1402
00:49:57,599 --> 00:49:59,599
the coolest in all sincerity that's like

1403
00:49:59,599 --> 00:50:01,119
one of the coolest

1404
00:50:01,119 --> 00:50:03,200
speaker giveaways i've ever seen so

1405
00:50:03,200 --> 00:50:04,160
thank you

1406
00:50:04,160 --> 00:50:07,200
yeah i've got my box over there yeah i

1407
00:50:07,200 --> 00:50:07,520
just

1408
00:50:07,520 --> 00:50:08,800
i don't want to break it here on the

1409
00:50:08,800 --> 00:50:13,839
stage flailing about

1410
00:50:14,810 --> 00:50:17,860
[Music]

1411
00:50:24,839 --> 00:50:27,839
uh

1412
00:50:35,810 --> 00:50:38,940
[Applause]

1413
00:50:39,520 --> 00:50:41,839
well i wanted to make a purchase and so

1414
00:50:41,839 --> 00:50:44,079
it denied the purchase because i had to

1415
00:50:44,079 --> 00:50:45,440
call the bank

1416
00:50:45,440 --> 00:50:47,920
to say hey i'm actually overseas trying

1417
00:50:47,920 --> 00:50:49,599
to make this purchase

1418
00:50:49,599 --> 00:50:52,319
right so then i get back and like two

1419
00:50:52,319 --> 00:50:53,680
days later

1420
00:50:53,680 --> 00:50:56,640
i get this email that says hey you know

1421
00:50:56,640 --> 00:50:57,839
we have a problem with your credit card

1422
00:50:57,839 --> 00:50:59,440
click here on this link

1423
00:50:59,440 --> 00:51:02,480
and sure enough you know oh yeah

1424
00:51:02,480 --> 00:51:04,640
it just it was once in all perfect

1425
00:51:04,640 --> 00:51:06,640
timing right but it was one of those

1426
00:51:06,640 --> 00:51:09,520
training things so i'm like oh yeah i

1427
00:51:09,520 --> 00:51:11,040
know that i had problems with my credit

1428
00:51:11,040 --> 00:51:12,800
card this has got to be a legit

1429
00:51:12,800 --> 00:51:15,440
and did not take my first instinct and

1430
00:51:15,440 --> 00:51:16,960
check the hyperlink and all that other

1431
00:51:16,960 --> 00:51:17,599
stuff

1432
00:51:17,599 --> 00:51:19,200
clicked on the link and sure enough it

1433
00:51:19,200 --> 00:51:21,040
was our internal

1434
00:51:21,040 --> 00:51:24,240
uh training thing

1435
00:51:28,000 --> 00:51:31,200
so happened to be the perfect timing

1436
00:51:31,200 --> 00:51:32,800
right they were just coming back with

1437
00:51:32,800 --> 00:51:34,319
the training um

1438
00:51:34,319 --> 00:51:37,280
anyway so yeah even the best of us uh

1439
00:51:37,280 --> 00:51:39,040
you know like matt said he drove him out

1440
00:51:39,040 --> 00:51:40,960
uh nuts for hours trying to figure that

1441
00:51:40,960 --> 00:51:42,400
out

1442
00:51:42,400 --> 00:51:44,000
you know if it happens when you're in a

1443
00:51:44,000 --> 00:51:45,920
russian you don't take your time

1444
00:51:45,920 --> 00:51:47,680
to evaluate and look at that kind of

1445
00:51:47,680 --> 00:51:49,760
stuff carefully because it can very

1446
00:51:49,760 --> 00:51:50,480
easily

1447
00:51:50,480 --> 00:51:53,119
fortunately for me it was just you know

1448
00:51:53,119 --> 00:51:54,240
the internal

1449
00:51:54,240 --> 00:51:57,359
uh training security thing so uh the

1450
00:51:57,359 --> 00:51:59,200
other thing i wanted to mention

1451
00:51:59,200 --> 00:52:01,680
uh i know man you were picking on paypal

1452
00:52:01,680 --> 00:52:03,919
there

1453
00:52:16,720 --> 00:52:18,640
the one that's on our website if you go

1454
00:52:18,640 --> 00:52:21,839
to ohio infosec.org

1455
00:52:21,839 --> 00:52:24,960
and go down to the donation link

1456
00:52:24,960 --> 00:52:27,200
on our website that one is working so if

1457
00:52:27,200 --> 00:52:33,839
you open up a browser go to ohiosec.org

1458
00:52:34,820 --> 00:52:37,909
[Applause]

1459
00:52:44,839 --> 00:52:47,839
uh

1460
00:52:50,900 --> 00:52:54,059
[Music]

1461
00:53:04,240 --> 00:53:09,680
we're going to do some raffle

