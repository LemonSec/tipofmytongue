1
00:00:00,960 --> 00:00:04,000
okay can you hear me talking now

2
00:00:04,000 --> 00:00:06,160
okay

3
00:00:08,720 --> 00:00:09,920
okay

4
00:00:09,920 --> 00:00:13,400
yeah i'm not fine

5
00:00:27,680 --> 00:00:30,320
next up is scott he's going to talk

6
00:00:30,320 --> 00:00:32,320
about some random wear

7
00:00:32,320 --> 00:00:35,320
uh

8
00:00:55,039 --> 00:00:59,800
it's showing me as

9
00:01:11,200 --> 00:01:12,799
what's cause they had a mic or the

10
00:01:12,799 --> 00:01:14,320
speaker on over there if they turn that

11
00:01:14,320 --> 00:01:16,799
speaker off

12
00:01:16,799 --> 00:01:21,119
oh that's pausing for you oh okay

13
00:01:21,119 --> 00:01:24,840
so i have to use mine

14
00:01:27,520 --> 00:01:30,520
is

15
00:01:51,119 --> 00:01:54,360
i don't think

16
00:02:06,799 --> 00:02:08,960
the

17
00:02:15,680 --> 00:02:17,360
okay so i switched it back to my local

18
00:02:17,360 --> 00:02:18,800
speakers and then i just turned the

19
00:02:18,800 --> 00:02:20,480
volume down because i couldn't control

20
00:02:20,480 --> 00:02:22,879
the speaker out there

21
00:02:22,879 --> 00:02:25,879
um

22
00:02:43,280 --> 00:02:44,319
well

23
00:02:44,319 --> 00:02:46,800
thanks coming out uh again my talk was

24
00:02:46,800 --> 00:02:49,040
going to be about ransomware yeah why

25
00:02:49,040 --> 00:02:51,920
it's not the actual problem

26
00:02:51,920 --> 00:02:54,959
uh about me i'm a principal a research

27
00:02:54,959 --> 00:02:57,280
consultant at trustedsec i've been here

28
00:02:57,280 --> 00:03:00,159
for been trusted about five years

29
00:03:00,159 --> 00:03:01,920
uh for about four and a half of those

30
00:03:01,920 --> 00:03:04,080
years i've worked in incident response

31
00:03:04,080 --> 00:03:05,440
we've worked with many different

32
00:03:05,440 --> 00:03:08,239
companies from very small to very large

33
00:03:08,239 --> 00:03:09,760
during the time i get to see a lot of

34
00:03:09,760 --> 00:03:11,200
different types of environments and

35
00:03:11,200 --> 00:03:13,519
different types of incidents

36
00:03:13,519 --> 00:03:14,959
so kind of today's talk is going to be

37
00:03:14,959 --> 00:03:16,640
kind of about what i've seen during

38
00:03:16,640 --> 00:03:18,800
these incidents and what i've

39
00:03:18,800 --> 00:03:20,480
experienced

40
00:03:20,480 --> 00:03:23,680
for me my background is software dev

41
00:03:23,680 --> 00:03:26,720
i kind of got into ir because i like

42
00:03:26,720 --> 00:03:28,319
tearing apart malware i like writing

43
00:03:28,319 --> 00:03:29,760
malware

44
00:03:29,760 --> 00:03:31,280
kind of like earlier conversation that

45
00:03:31,280 --> 00:03:33,280
was talking about ctf is a great way to

46
00:03:33,280 --> 00:03:34,959
learn that's how i learned most the

47
00:03:34,959 --> 00:03:38,159
things i deal with now

48
00:03:38,480 --> 00:03:41,599
today's agenda again ransomware

49
00:03:41,599 --> 00:03:43,120
everyone sees it it's probably one of

50
00:03:43,120 --> 00:03:44,480
the most talked about

51
00:03:44,480 --> 00:03:46,000
topics in the news when it comes to

52
00:03:46,000 --> 00:03:47,280
cyber

53
00:03:47,280 --> 00:03:48,640
uh

54
00:03:48,640 --> 00:03:50,400
one of the funny it's one of the top two

55
00:03:50,400 --> 00:03:52,799
items that we get the most calls for of

56
00:03:52,799 --> 00:03:54,879
as far as incidents the other one being

57
00:03:54,879 --> 00:03:56,799
business email compromises

58
00:03:56,799 --> 00:03:58,480
uh funny thing about business compromise

59
00:03:58,480 --> 00:04:00,239
you tend not to see them as much in the

60
00:04:00,239 --> 00:04:04,000
news as you do ransomware

61
00:04:04,000 --> 00:04:06,239
again kind of like i stated earlier this

62
00:04:06,239 --> 00:04:08,959
most this presentation is based off of

63
00:04:08,959 --> 00:04:13,720
my experiences working through ir cases

64
00:04:15,040 --> 00:04:17,120
during my five years of working in the

65
00:04:17,120 --> 00:04:18,399
uh or my four and a half years work on

66
00:04:18,399 --> 00:04:19,918
incident response i kind of got to see a

67
00:04:19,918 --> 00:04:22,000
little bit of an evolution inside the

68
00:04:22,000 --> 00:04:24,560
ransomware attacks themselves

69
00:04:24,560 --> 00:04:26,960
when the ransomware attack started

70
00:04:26,960 --> 00:04:28,400
they were generally

71
00:04:28,400 --> 00:04:31,520
like a single computer that got infected

72
00:04:31,520 --> 00:04:34,240
or got compromised ransomware on it

73
00:04:34,240 --> 00:04:35,520
uh and the

74
00:04:35,520 --> 00:04:37,759
the ransoms were generally down to like

75
00:04:37,759 --> 00:04:39,360
fifty dollars to maybe a couple hundred

76
00:04:39,360 --> 00:04:41,520
dollars but they were really low they

77
00:04:41,520 --> 00:04:43,600
were small value

78
00:04:43,600 --> 00:04:45,759
uh

79
00:04:45,759 --> 00:04:46,560
the

80
00:04:46,560 --> 00:04:48,320
encryption software themselves weren't

81
00:04:48,320 --> 00:04:49,759
generally actually encryption they're

82
00:04:49,759 --> 00:04:51,199
more obfuscation

83
00:04:51,199 --> 00:04:53,199
so it was easy to actually just find

84
00:04:53,199 --> 00:04:55,280
something else online to get your data

85
00:04:55,280 --> 00:04:58,479
back and they were kind of like low low

86
00:04:58,479 --> 00:04:59,680
low end

87
00:04:59,680 --> 00:05:01,919
they started growing and started getting

88
00:05:01,919 --> 00:05:03,520
a little bit more

89
00:05:03,520 --> 00:05:04,880
advanced

90
00:05:04,880 --> 00:05:06,720
uh when people started figuring out how

91
00:05:06,720 --> 00:05:08,720
to protect themselves from it kind of

92
00:05:08,720 --> 00:05:10,320
the same cat mouse game that you always

93
00:05:10,320 --> 00:05:12,639
get with the security

94
00:05:12,639 --> 00:05:14,639
so they can start moving into

95
00:05:14,639 --> 00:05:16,080
like encrypting more and more of the

96
00:05:16,080 --> 00:05:17,360
systems

97
00:05:17,360 --> 00:05:19,120
uh

98
00:05:19,120 --> 00:05:20,479
and then

99
00:05:20,479 --> 00:05:23,280
as that starts growing you got people

100
00:05:23,280 --> 00:05:26,000
started using backups more so the backup

101
00:05:26,000 --> 00:05:27,600
systems they stopped paying the ransoms

102
00:05:27,600 --> 00:05:29,600
because now you have the backups so the

103
00:05:29,600 --> 00:05:31,520
attackers get into your system they

104
00:05:31,520 --> 00:05:33,600
start trying to figure out what kind of

105
00:05:33,600 --> 00:05:35,520
backups environments do you have what

106
00:05:35,520 --> 00:05:37,840
tools do you use to protect your systems

107
00:05:37,840 --> 00:05:40,479
so then they start attacking the backups

108
00:05:40,479 --> 00:05:43,759
uh initially it was just shadow copies

109
00:05:43,759 --> 00:05:45,600
then they start building into the uh the

110
00:05:45,600 --> 00:05:47,360
ransomware itself to disable shadow

111
00:05:47,360 --> 00:05:49,759
copies or overwrite them

112
00:05:49,759 --> 00:05:52,160
then they start moving the systems or

113
00:05:52,160 --> 00:05:54,400
the backups off system into a central

114
00:05:54,400 --> 00:05:55,520
location

115
00:05:55,520 --> 00:05:57,680
now the attackers started getting access

116
00:05:57,680 --> 00:06:00,080
to your system starting to monitor first

117
00:06:00,080 --> 00:06:02,000
find okay you're backing up into this

118
00:06:02,000 --> 00:06:04,000
environment how can they disrupt it or

119
00:06:04,000 --> 00:06:05,360
corrupt it

120
00:06:05,360 --> 00:06:08,800
so again back and forth that constant

121
00:06:08,800 --> 00:06:11,120
cat and mouse game

122
00:06:11,120 --> 00:06:12,479
some of the other things that we started

123
00:06:12,479 --> 00:06:14,720
seeing around that same time also and

124
00:06:14,720 --> 00:06:16,479
this happened for a very short period of

125
00:06:16,479 --> 00:06:17,600
time

126
00:06:17,600 --> 00:06:19,120
because the attackers weren't getting

127
00:06:19,120 --> 00:06:22,160
paid because people actually had backups

128
00:06:22,160 --> 00:06:24,000
we actually had a few calls with clients

129
00:06:24,000 --> 00:06:25,840
where the attackers had called in bomb

130
00:06:25,840 --> 00:06:27,039
threats

131
00:06:27,039 --> 00:06:28,400
if you don't pay our ransom we're going

132
00:06:28,400 --> 00:06:29,919
to bomb you

133
00:06:29,919 --> 00:06:32,319
so they'd end up evacuating buildings we

134
00:06:32,319 --> 00:06:33,840
heard about that for like two maybe

135
00:06:33,840 --> 00:06:35,120
three months

136
00:06:35,120 --> 00:06:37,759
with a few different clients

137
00:06:37,759 --> 00:06:40,240
um something else that started happening

138
00:06:40,240 --> 00:06:41,039
is

139
00:06:41,039 --> 00:06:43,440
basically the attackers or

140
00:06:43,440 --> 00:06:45,120
organizations started discovering that

141
00:06:45,120 --> 00:06:46,960
there's money in this

142
00:06:46,960 --> 00:06:48,960
so instead of being like one or two

143
00:06:48,960 --> 00:06:51,360
people doing it it started becoming more

144
00:06:51,360 --> 00:06:53,280
of an industry forum

145
00:06:53,280 --> 00:06:55,360
so you have large groups of people that

146
00:06:55,360 --> 00:06:57,039
will actually dedicate time and

147
00:06:57,039 --> 00:06:59,039
resources to developing the tools

148
00:06:59,039 --> 00:07:01,120
getting in your systems

149
00:07:01,120 --> 00:07:02,800
so it started to really grow and about

150
00:07:02,800 --> 00:07:04,720
that same time the cost of the

151
00:07:04,720 --> 00:07:06,639
ransomware started to spike

152
00:07:06,639 --> 00:07:08,720
it just escalated really really fast

153
00:07:08,720 --> 00:07:10,720
with what people were asking some of the

154
00:07:10,720 --> 00:07:12,080
initial big hacks where they started

155
00:07:12,080 --> 00:07:13,840
asking for millions of dollars for some

156
00:07:13,840 --> 00:07:17,280
of the bigger systems

157
00:07:17,280 --> 00:07:19,280
something else that is actually just

158
00:07:19,280 --> 00:07:20,240
kind of

159
00:07:20,240 --> 00:07:21,440
interesting

160
00:07:21,440 --> 00:07:23,360
uh ransomware groups have some of the

161
00:07:23,360 --> 00:07:25,840
best customer service out there

162
00:07:25,840 --> 00:07:28,639
i they're better than delta

163
00:07:28,639 --> 00:07:31,280
because they want your money

164
00:07:31,280 --> 00:07:33,759
uh i've actually had a few clients who

165
00:07:33,759 --> 00:07:35,599
had to pay the ransoms

166
00:07:35,599 --> 00:07:37,440
and they were actually really impressed

167
00:07:37,440 --> 00:07:39,039
with the quality of the customer service

168
00:07:39,039 --> 00:07:41,520
that they got

169
00:07:42,639 --> 00:07:44,319
the other thing with it also it's

170
00:07:44,319 --> 00:07:46,720
spawned off lots of other side services

171
00:07:46,720 --> 00:07:48,879
side company side businesses

172
00:07:48,879 --> 00:07:50,639
um i guess you can't go anywhere now

173
00:07:50,639 --> 00:07:53,199
without hearing about uh

174
00:07:53,199 --> 00:07:55,039
ransomware protection services i was

175
00:07:55,039 --> 00:07:56,400
listening to darknet diaries the other

176
00:07:56,400 --> 00:07:58,000
day and i think two of the commercials

177
00:07:58,000 --> 00:07:59,599
on there were for ransomware protection

178
00:07:59,599 --> 00:08:01,280
services

179
00:08:01,280 --> 00:08:03,680
um also there's now uh

180
00:08:03,680 --> 00:08:06,560
ransomware negotiators

181
00:08:06,560 --> 00:08:08,160
so if you get hit with ransomware you

182
00:08:08,160 --> 00:08:09,840
can call this negotiator who will do the

183
00:08:09,840 --> 00:08:12,400
negotiations for you and surprisingly

184
00:08:12,400 --> 00:08:14,080
they work

185
00:08:14,080 --> 00:08:15,599
um

186
00:08:15,599 --> 00:08:18,160
we've not we've not recommended any but

187
00:08:18,160 --> 00:08:19,759
we've worked with clients who've used

188
00:08:19,759 --> 00:08:20,879
them

189
00:08:20,879 --> 00:08:22,879
and they've almost got the asking price

190
00:08:22,879 --> 00:08:24,639
down to almost like a tenth sometimes of

191
00:08:24,639 --> 00:08:27,919
what they initially ask

192
00:08:29,039 --> 00:08:30,479
something else that's interesting again

193
00:08:30,479 --> 00:08:32,958
with it being a larger business

194
00:08:32,958 --> 00:08:34,799
they're constantly trying to find ways

195
00:08:34,799 --> 00:08:37,279
now to get more money

196
00:08:37,279 --> 00:08:40,159
so yes you got hit with ransomware there

197
00:08:40,159 --> 00:08:42,399
that's not maybe not their primary thing

198
00:08:42,399 --> 00:08:44,080
they've got into your system already

199
00:08:44,080 --> 00:08:45,600
they know your environment they've

200
00:08:45,600 --> 00:08:48,480
already ex-filled your sensitive data

201
00:08:48,480 --> 00:08:49,839
now they'll come back a month or two

202
00:08:49,839 --> 00:08:51,360
later and say well if you don't want us

203
00:08:51,360 --> 00:08:53,040
to release this

204
00:08:53,040 --> 00:08:55,839
pay us more money

205
00:08:56,320 --> 00:08:58,560
and that's always a fun topic to come up

206
00:08:58,560 --> 00:09:01,279
with clients is the fact of do you trust

207
00:09:01,279 --> 00:09:02,720
them

208
00:09:02,720 --> 00:09:04,480
they're crooks

209
00:09:04,480 --> 00:09:06,080
they stole your data

210
00:09:06,080 --> 00:09:07,600
if you go out and pay them x amount of

211
00:09:07,600 --> 00:09:09,519
money to protect your data it doesn't

212
00:09:09,519 --> 00:09:12,640
stop them from actually releasing it

213
00:09:12,640 --> 00:09:14,720
other ones will release on

214
00:09:14,720 --> 00:09:16,320
auction sites

215
00:09:16,320 --> 00:09:17,760
uh there's a couple different types of

216
00:09:17,760 --> 00:09:19,519
auction sites they'll do

217
00:09:19,519 --> 00:09:21,519
we'll only sell this data once so they

218
00:09:21,519 --> 00:09:23,200
try to drive the price up to only sell

219
00:09:23,200 --> 00:09:24,480
one copy

220
00:09:24,480 --> 00:09:25,920
and then the clients will have the

221
00:09:25,920 --> 00:09:28,160
potential to buy their their own data

222
00:09:28,160 --> 00:09:29,040
back

223
00:09:29,040 --> 00:09:30,880
or they'll open up for everyone to get

224
00:09:30,880 --> 00:09:32,399
and that's generally a lower price but

225
00:09:32,399 --> 00:09:35,680
they try to sell more copies

226
00:09:35,760 --> 00:09:38,320
recently well somewhat recently

227
00:09:38,320 --> 00:09:40,000
ransomware now is becoming more of a

228
00:09:40,000 --> 00:09:41,440
service

229
00:09:41,440 --> 00:09:43,920
where you can go into a purchase a

230
00:09:43,920 --> 00:09:45,680
platform they'll provide you with the

231
00:09:45,680 --> 00:09:47,680
ransomware

232
00:09:47,680 --> 00:09:49,440
those uh that software was a little

233
00:09:49,440 --> 00:09:50,720
different than some of the other ones

234
00:09:50,720 --> 00:09:54,160
i'll talk about because those generally

235
00:09:54,160 --> 00:09:56,000
include a little bit more of like a an

236
00:09:56,000 --> 00:09:58,240
implant rather than just the ransomware

237
00:09:58,240 --> 00:10:00,080
software

238
00:10:00,080 --> 00:10:01,920
um something else that we've also seen a

239
00:10:01,920 --> 00:10:04,640
few times actually quite a few times

240
00:10:04,640 --> 00:10:06,800
doing the ir cases we'll track back to

241
00:10:06,800 --> 00:10:08,800
where it was initially the initial

242
00:10:08,800 --> 00:10:10,320
infection

243
00:10:10,320 --> 00:10:12,480
we'll see the attackers come in real

244
00:10:12,480 --> 00:10:13,760
silently

245
00:10:13,760 --> 00:10:15,760
you do a little bit of reconnaissance

246
00:10:15,760 --> 00:10:17,600
around the environment try to figure out

247
00:10:17,600 --> 00:10:19,680
what the protections are did they get

248
00:10:19,680 --> 00:10:21,440
caught but not do anything they're

249
00:10:21,440 --> 00:10:24,160
really really under under the radar

250
00:10:24,160 --> 00:10:25,440
and then

251
00:10:25,440 --> 00:10:27,040
they'll come back in maybe a week or

252
00:10:27,040 --> 00:10:28,560
every month just to check to see if they

253
00:10:28,560 --> 00:10:30,560
still have access and then all of a

254
00:10:30,560 --> 00:10:32,640
sudden somebody will come in and it's

255
00:10:32,640 --> 00:10:34,800
like a bull in a china shop they'll make

256
00:10:34,800 --> 00:10:37,519
so much noise throw out all their uh

257
00:10:37,519 --> 00:10:38,800
tooling

258
00:10:38,800 --> 00:10:40,160
and then that's when they release the

259
00:10:40,160 --> 00:10:42,160
ransomware one of the things that we've

260
00:10:42,160 --> 00:10:43,760
been noticing is that tends to be

261
00:10:43,760 --> 00:10:47,040
somebody will get the initial access

262
00:10:47,040 --> 00:10:49,120
and then sell off that access to other

263
00:10:49,120 --> 00:10:50,240
people

264
00:10:50,240 --> 00:10:52,000
we've had one case where they sold it

265
00:10:52,000 --> 00:10:55,200
off to like three different attackers

266
00:10:55,200 --> 00:10:56,959
we've seen people it was kind of

267
00:10:56,959 --> 00:10:57,760
interesting because it was really

268
00:10:57,760 --> 00:11:00,640
confusing during the ir case is like

269
00:11:00,640 --> 00:11:02,240
the methodology seemed all over the

270
00:11:02,240 --> 00:11:04,399
place until we realized it was a couple

271
00:11:04,399 --> 00:11:05,839
different groups that were using the

272
00:11:05,839 --> 00:11:07,279
same access point

273
00:11:07,279 --> 00:11:09,839
one of them was trying to excel data

274
00:11:09,839 --> 00:11:11,519
and then trying to do more like a

275
00:11:11,519 --> 00:11:13,680
corporate espionage and then the last

276
00:11:13,680 --> 00:11:15,040
group came in and just released

277
00:11:15,040 --> 00:11:17,360
ransomware and basically screwed over

278
00:11:17,360 --> 00:11:18,640
the two people that were already in

279
00:11:18,640 --> 00:11:22,000
there trying to be under the radar

280
00:11:24,160 --> 00:11:26,399
so just a curious curiosity how many you

281
00:11:26,399 --> 00:11:27,600
guys don't have to raise your hands or

282
00:11:27,600 --> 00:11:29,360
anything but how many people have worked

283
00:11:29,360 --> 00:11:31,040
with ransomware have been affected by

284
00:11:31,040 --> 00:11:33,680
ransomware

285
00:11:33,680 --> 00:11:36,160
a couple

286
00:11:36,160 --> 00:11:37,440
lucky

287
00:11:37,440 --> 00:11:38,520
it's ugly

288
00:11:38,520 --> 00:11:41,120
[Applause]

289
00:11:41,120 --> 00:11:43,120
so kind of getting into ransomware

290
00:11:43,120 --> 00:11:44,800
itself so

291
00:11:44,800 --> 00:11:47,519
the evolution i talked about was of an

292
00:11:47,519 --> 00:11:49,760
uh ransomware attack

293
00:11:49,760 --> 00:11:51,600
to be considered ransomware attack they

294
00:11:51,600 --> 00:11:52,959
basically all they had to do is at some

295
00:11:52,959 --> 00:11:55,760
point release ransomware

296
00:11:55,760 --> 00:11:59,200
so so the ransomware itself

297
00:11:59,200 --> 00:12:01,040
um

298
00:12:01,040 --> 00:12:03,279
so actually i i grabbed the image off

299
00:12:03,279 --> 00:12:04,959
online it irritates me because it's

300
00:12:04,959 --> 00:12:07,120
actually backwards

301
00:12:07,120 --> 00:12:08,880
sorry i didn't notice until i put it in

302
00:12:08,880 --> 00:12:11,519
the slide but ransomware the whole goal

303
00:12:11,519 --> 00:12:14,880
is to try to find your files and encrypt

304
00:12:14,880 --> 00:12:16,639
them in a way that you need to pay them

305
00:12:16,639 --> 00:12:17,680
to get

306
00:12:17,680 --> 00:12:20,480
your regular data back

307
00:12:20,480 --> 00:12:22,160
kind of talked early on ransomware was

308
00:12:22,160 --> 00:12:23,760
more obfuscation where they either would

309
00:12:23,760 --> 00:12:25,600
go in an xor it

310
00:12:25,600 --> 00:12:27,760
or they'd use some type of one-time pad

311
00:12:27,760 --> 00:12:30,000
to xor it was weird

312
00:12:30,000 --> 00:12:32,079
they would do rot 13 sometimes it was

313
00:12:32,079 --> 00:12:34,000
just enough to obfuscate it so the

314
00:12:34,000 --> 00:12:36,480
general person had no idea what it was

315
00:12:36,480 --> 00:12:38,639
they started moving that over then to

316
00:12:38,639 --> 00:12:40,800
actual encryption

317
00:12:40,800 --> 00:12:42,639
um the encryption basically will just

318
00:12:42,639 --> 00:12:45,279
make it look like garbage

319
00:12:45,279 --> 00:12:46,800
uh to kind of pivot off the earlier

320
00:12:46,800 --> 00:12:48,240
topic uh

321
00:12:48,240 --> 00:12:49,760
the magic values i don't know if you can

322
00:12:49,760 --> 00:12:51,440
see up there like on the right hand side

323
00:12:51,440 --> 00:12:54,240
the gif tells you it's a picture

324
00:12:54,240 --> 00:12:55,680
where you on the left you have no idea

325
00:12:55,680 --> 00:12:58,239
what it is

326
00:12:59,200 --> 00:13:00,959
so

327
00:13:00,959 --> 00:13:02,240
i'll get into this a little bit more

328
00:13:02,240 --> 00:13:04,800
later on but generally ransomware is

329
00:13:04,800 --> 00:13:06,639
stupid

330
00:13:06,639 --> 00:13:08,880
it's very simple code most people could

331
00:13:08,880 --> 00:13:10,880
probably write in

332
00:13:10,880 --> 00:13:12,800
a couple hours

333
00:13:12,800 --> 00:13:14,880
to get a generic ransom or something

334
00:13:14,880 --> 00:13:16,959
that would go out and encrypt

335
00:13:16,959 --> 00:13:18,959
some of the more advanced pieces take a

336
00:13:18,959 --> 00:13:21,200
little longer but in general

337
00:13:21,200 --> 00:13:23,360
they don't spend a lot of time on the

338
00:13:23,360 --> 00:13:26,000
ransomware software itself

339
00:13:26,000 --> 00:13:29,440
um how do you get how does it get in

340
00:13:29,440 --> 00:13:31,120
well i'm calling it drive-by this is

341
00:13:31,120 --> 00:13:32,959
your typical

342
00:13:32,959 --> 00:13:34,720
you post it up on some like forum

343
00:13:34,720 --> 00:13:37,680
somebody downloads it uh some website

344
00:13:37,680 --> 00:13:39,360
that somebody goes browses to and it

345
00:13:39,360 --> 00:13:40,880
infects your computer

346
00:13:40,880 --> 00:13:42,959
and this is not the ransomware this is

347
00:13:42,959 --> 00:13:44,880
just how the attackers get in this is

348
00:13:44,880 --> 00:13:46,639
your normal

349
00:13:46,639 --> 00:13:49,920
uh how you got fish type of thing

350
00:13:49,920 --> 00:13:52,240
um i'm calling opportunistic uh

351
00:13:52,240 --> 00:13:54,079
opportunistic generally comes up with

352
00:13:54,079 --> 00:13:55,040
the

353
00:13:55,040 --> 00:13:56,880
uh a zero days release the proof of

354
00:13:56,880 --> 00:13:58,480
concepts pushed out

355
00:13:58,480 --> 00:13:59,360
uh

356
00:13:59,360 --> 00:14:01,600
like the half name type things

357
00:14:01,600 --> 00:14:02,880
where somebody gets hold of it and they

358
00:14:02,880 --> 00:14:05,600
go out searching for people who have it

359
00:14:05,600 --> 00:14:07,600
similar to like spray and praise is what

360
00:14:07,600 --> 00:14:09,040
i'm calling them where they just send

361
00:14:09,040 --> 00:14:10,560
out a bunch of things to a lot of people

362
00:14:10,560 --> 00:14:13,360
in hopes that something hits

363
00:14:13,360 --> 00:14:14,800
um what a lot of people are worried

364
00:14:14,800 --> 00:14:16,959
about are more of the targeting attacks

365
00:14:16,959 --> 00:14:19,120
where your organization is

366
00:14:19,120 --> 00:14:21,680
specifically picked out and attacked by

367
00:14:21,680 --> 00:14:24,079
a group

368
00:14:24,160 --> 00:14:25,680
kind of talked about earlier supply

369
00:14:25,680 --> 00:14:26,959
chain

370
00:14:26,959 --> 00:14:30,000
this one we've seen a lot more recently

371
00:14:30,000 --> 00:14:32,079
and it's not the traditional supply

372
00:14:32,079 --> 00:14:34,720
chain you might have an it vendor that

373
00:14:34,720 --> 00:14:37,680
does your your i.t management or you

374
00:14:37,680 --> 00:14:39,600
have a third-party

375
00:14:39,600 --> 00:14:41,920
security firm that does your monitoring

376
00:14:41,920 --> 00:14:44,160
they have access into your system they

377
00:14:44,160 --> 00:14:46,079
get compromised and then all of their

378
00:14:46,079 --> 00:14:48,079
clients are then

379
00:14:48,079 --> 00:14:49,199
compromised

380
00:14:49,199 --> 00:14:51,120
because they have your data they have

381
00:14:51,120 --> 00:14:53,440
your admin access

382
00:14:53,440 --> 00:14:55,120
and then can we talk about ransomware as

383
00:14:55,120 --> 00:14:58,199
a service

384
00:14:58,800 --> 00:15:01,040
um who's targeted

385
00:15:01,040 --> 00:15:03,760
well pretty much anyone

386
00:15:03,760 --> 00:15:05,920
uh what you see about in the news a lot

387
00:15:05,920 --> 00:15:08,079
of times are those big companies that

388
00:15:08,079 --> 00:15:10,560
get hit with ransomware

389
00:15:10,560 --> 00:15:12,800
but from what we've seen a lot of the

390
00:15:12,800 --> 00:15:14,800
small companies that you might not ever

391
00:15:14,800 --> 00:15:15,839
heard of

392
00:15:15,839 --> 00:15:17,680
are the ones that actually are the most

393
00:15:17,680 --> 00:15:18,720
money

394
00:15:18,720 --> 00:15:21,920
uh we've had a bunch of different uh

395
00:15:21,920 --> 00:15:23,600
we had some like third party nine or

396
00:15:23,600 --> 00:15:25,839
some non-profit types that were raising

397
00:15:25,839 --> 00:15:28,399
millions of dollars get compromised and

398
00:15:28,399 --> 00:15:31,440
hit with ransomware um

399
00:15:31,440 --> 00:15:32,720
the size of the business doesn't

400
00:15:32,720 --> 00:15:34,800
necessarily mean how or correlate to how

401
00:15:34,800 --> 00:15:36,399
much that client has or how much the

402
00:15:36,399 --> 00:15:38,959
ransomware people are asking for it

403
00:15:38,959 --> 00:15:41,040
um

404
00:15:41,040 --> 00:15:43,040
it's different types of i.t stacks so

405
00:15:43,040 --> 00:15:45,360
again it goes back to like a recent zero

406
00:15:45,360 --> 00:15:46,880
day or something that gets released and

407
00:15:46,880 --> 00:15:49,199
if you have an unpatched system it gives

408
00:15:49,199 --> 00:15:50,480
the people will go out there and use

409
00:15:50,480 --> 00:15:52,079
like show it on to search the internet

410
00:15:52,079 --> 00:15:53,519
to try to find

411
00:15:53,519 --> 00:15:55,839
okay this this group has happened to be

412
00:15:55,839 --> 00:15:59,680
open to this vulnerability we can get in

413
00:16:00,639 --> 00:16:02,800
um client vendor relationships is

414
00:16:02,800 --> 00:16:04,720
another one that we've seen

415
00:16:04,720 --> 00:16:08,160
where a client gets a

416
00:16:08,160 --> 00:16:10,959
client a gets compromised they use the

417
00:16:10,959 --> 00:16:13,279
existing communications back and forth

418
00:16:13,279 --> 00:16:15,600
between client a and client b

419
00:16:15,600 --> 00:16:17,839
to then uh

420
00:16:17,839 --> 00:16:20,160
trick them into installing some software

421
00:16:20,160 --> 00:16:24,399
or browsing to a site and infecting them

422
00:16:26,560 --> 00:16:28,079
so another thing that we see all the

423
00:16:28,079 --> 00:16:29,920
time in the news is groups and

424
00:16:29,920 --> 00:16:31,920
attribution

425
00:16:31,920 --> 00:16:34,399
these irritate me personally as an ir

426
00:16:34,399 --> 00:16:35,360
person

427
00:16:35,360 --> 00:16:36,720
because

428
00:16:36,720 --> 00:16:38,480
almost always one of the first questions

429
00:16:38,480 --> 00:16:41,360
we get is who did it

430
00:16:41,360 --> 00:16:42,639
and it's like because during a normal

431
00:16:42,639 --> 00:16:44,160
kickoff call we'll be trying to figure

432
00:16:44,160 --> 00:16:46,160
out what the client wants what is their

433
00:16:46,160 --> 00:16:48,720
end goal and almost always it's who did

434
00:16:48,720 --> 00:16:50,560
it

435
00:16:50,560 --> 00:16:53,600
and that's generally not important

436
00:16:53,600 --> 00:16:55,680
at least at the beginning the importance

437
00:16:55,680 --> 00:16:57,600
is how did they get in

438
00:16:57,600 --> 00:17:00,079
what did they do why they're in

439
00:17:00,079 --> 00:17:02,720
and honestly a lot of these are rotating

440
00:17:02,720 --> 00:17:04,640
groups the people who you hear inside

441
00:17:04,640 --> 00:17:06,319
these different ransomware groups

442
00:17:06,319 --> 00:17:07,839
sometimes they rotate between each other

443
00:17:07,839 --> 00:17:09,919
that they share code

444
00:17:09,919 --> 00:17:11,520
sometimes they try to make attacks look

445
00:17:11,520 --> 00:17:13,439
like each other

446
00:17:13,439 --> 00:17:14,559
one thing you'll notice when you start

447
00:17:14,559 --> 00:17:15,919
looking through the codes there's snip

448
00:17:15,919 --> 00:17:19,599
of codes taken from other people so it's

449
00:17:19,599 --> 00:17:23,280
it's not really useful as much as far as

450
00:17:23,280 --> 00:17:25,359
who did it the nice thing about if you

451
00:17:25,359 --> 00:17:27,039
can identify the who did it sometimes

452
00:17:27,039 --> 00:17:29,440
you can find some of their ttps and use

453
00:17:29,440 --> 00:17:30,960
that in your analysis to try to find

454
00:17:30,960 --> 00:17:33,440
what else they did in your system

455
00:17:33,440 --> 00:17:36,000
but a lot of times

456
00:17:36,000 --> 00:17:39,440
it's just it's extra help

457
00:17:39,440 --> 00:17:40,880
again like the code variants we talked

458
00:17:40,880 --> 00:17:43,360
about it's easy to write

459
00:17:43,360 --> 00:17:45,600
it's easy to steal from other people

460
00:17:45,600 --> 00:17:47,039
i'll get a little bit later on into the

461
00:17:47,039 --> 00:17:50,000
complexity of the code

462
00:17:52,880 --> 00:17:54,240
i couldn't think of anything i had

463
00:17:54,240 --> 00:17:59,080
variant in it other than that so

464
00:18:00,320 --> 00:18:02,240
so again back to the main thing why is

465
00:18:02,240 --> 00:18:04,480
ransomware the scapes go for a bigger

466
00:18:04,480 --> 00:18:05,520
issue

467
00:18:05,520 --> 00:18:06,559
again

468
00:18:06,559 --> 00:18:08,640
the bigger issue is your environment is

469
00:18:08,640 --> 00:18:10,880
already compromised

470
00:18:10,880 --> 00:18:13,440
um originally or sometimes you might get

471
00:18:13,440 --> 00:18:15,679
a one-off ransomware they release it and

472
00:18:15,679 --> 00:18:17,760
it compromises a system

473
00:18:17,760 --> 00:18:19,760
but generally anymore most of what we

474
00:18:19,760 --> 00:18:21,280
see is

475
00:18:21,280 --> 00:18:23,200
the attackers get into your environment

476
00:18:23,200 --> 00:18:25,440
through like a fishing or through a

477
00:18:25,440 --> 00:18:26,480
browse

478
00:18:26,480 --> 00:18:28,799
normally it's through like into fishing

479
00:18:28,799 --> 00:18:31,280
uh they get their foothold in

480
00:18:31,280 --> 00:18:33,200
they use that to reconnais the rest of

481
00:18:33,200 --> 00:18:34,400
the environment to see what you're

482
00:18:34,400 --> 00:18:36,080
running what's your detections looking

483
00:18:36,080 --> 00:18:38,559
like have they been caught

484
00:18:38,559 --> 00:18:40,400
they will then take sometimes take their

485
00:18:40,400 --> 00:18:42,240
time other times they rush through

486
00:18:42,240 --> 00:18:45,200
things but the normal goal then is to

487
00:18:45,200 --> 00:18:47,600
move laterally and escalate privileges

488
00:18:47,600 --> 00:18:50,080
they try to get domain admin as fast as

489
00:18:50,080 --> 00:18:52,160
possible and from there a lot of times

490
00:18:52,160 --> 00:18:54,160
they'll use your existing

491
00:18:54,160 --> 00:18:55,760
like patch network or software

492
00:18:55,760 --> 00:18:57,440
deployment systems to push the

493
00:18:57,440 --> 00:18:59,600
ransomware out

494
00:18:59,600 --> 00:19:01,039
um other times they'll use their own

495
00:19:01,039 --> 00:19:04,000
scripts to map the network to try to

496
00:19:04,000 --> 00:19:06,400
identify what's their targets

497
00:19:06,400 --> 00:19:08,240
a lot of times they also will spend

498
00:19:08,240 --> 00:19:11,039
their time to see what in your system is

499
00:19:11,039 --> 00:19:12,720
the most valuable

500
00:19:12,720 --> 00:19:14,320
so they won't just go out and encrypt

501
00:19:14,320 --> 00:19:15,919
every one of your systems they'll try to

502
00:19:15,919 --> 00:19:17,679
make sure that they encrypt the systems

503
00:19:17,679 --> 00:19:19,919
that are the that will hurt you the most

504
00:19:19,919 --> 00:19:21,679
that makes you want to actually pay the

505
00:19:21,679 --> 00:19:24,640
ransom

506
00:19:24,640 --> 00:19:26,320
um again we talked i talked about a

507
00:19:26,320 --> 00:19:28,400
little bit earlier about how sometimes

508
00:19:28,400 --> 00:19:30,000
one group will come in

509
00:19:30,000 --> 00:19:31,840
get the initial access and then sell it

510
00:19:31,840 --> 00:19:36,199
off to a different group later on

511
00:19:38,240 --> 00:19:40,480
that's

512
00:19:40,480 --> 00:19:42,480
so

513
00:19:42,480 --> 00:19:44,400
again i talked about again some of the

514
00:19:44,400 --> 00:19:46,240
things that they're really interested in

515
00:19:46,240 --> 00:19:47,200
is

516
00:19:47,200 --> 00:19:49,280
what in your system is

517
00:19:49,280 --> 00:19:53,120
particularly vulnerable or accessible

518
00:19:53,120 --> 00:19:54,320
some of the things that they will do

519
00:19:54,320 --> 00:19:55,840
they'll encrypt those or they'll take

520
00:19:55,840 --> 00:19:57,280
them out we talked about they'll use

521
00:19:57,280 --> 00:20:00,640
those for extortion later on

522
00:20:00,640 --> 00:20:01,520
and

523
00:20:01,520 --> 00:20:03,760
one thing that we see a lot

524
00:20:03,760 --> 00:20:06,000
is that ransomware is not really the

525
00:20:06,000 --> 00:20:08,640
main purpose of the attack

526
00:20:08,640 --> 00:20:11,679
the ransomware is a great anti-forensics

527
00:20:11,679 --> 00:20:13,200
tool

528
00:20:13,200 --> 00:20:14,799
it goes through and encrypts your logs

529
00:20:14,799 --> 00:20:17,360
files it goes through and

530
00:20:17,360 --> 00:20:19,520
a lot of them will remove like your

531
00:20:19,520 --> 00:20:21,360
your shadow copies

532
00:20:21,360 --> 00:20:23,760
um they encrypt a bunch of your event

533
00:20:23,760 --> 00:20:25,120
logs

534
00:20:25,120 --> 00:20:26,400
um

535
00:20:26,400 --> 00:20:28,240
something we'll see later on when i go

536
00:20:28,240 --> 00:20:30,480
through one of the examples is that

537
00:20:30,480 --> 00:20:31,760
something that the ransomware will also

538
00:20:31,760 --> 00:20:34,080
try to do is

539
00:20:34,080 --> 00:20:35,520
try and some of them will clear out your

540
00:20:35,520 --> 00:20:38,000
event logs prior very first part of

541
00:20:38,000 --> 00:20:39,679
their run they'll clear them out they'll

542
00:20:39,679 --> 00:20:41,120
execute themselves

543
00:20:41,120 --> 00:20:42,400
and try and encrypt everything and the

544
00:20:42,400 --> 00:20:43,520
last step it will try to clear your

545
00:20:43,520 --> 00:20:46,918
event logs again

546
00:20:48,559 --> 00:20:50,720
so kind of like i talked about the

547
00:20:50,720 --> 00:20:53,039
complexity of ransomware code itself it

548
00:20:53,039 --> 00:20:55,520
really varies its code

549
00:20:55,520 --> 00:20:58,240
but if you really want to think about

550
00:20:58,240 --> 00:21:00,000
the attack chain or the process that

551
00:21:00,000 --> 00:21:01,360
they're going through

552
00:21:01,360 --> 00:21:04,000
most of the advanced attackers have

553
00:21:04,000 --> 00:21:05,679
access to your system

554
00:21:05,679 --> 00:21:07,360
so by the point that they actually go to

555
00:21:07,360 --> 00:21:09,360
run this uh the ransomware on your

556
00:21:09,360 --> 00:21:11,440
computers or on your systems they

557
00:21:11,440 --> 00:21:12,960
already know your systems they know your

558
00:21:12,960 --> 00:21:16,159
protections so they have them disabled

559
00:21:16,159 --> 00:21:19,039
so the ransomware software itself is

560
00:21:19,039 --> 00:21:20,960
they focus more on

561
00:21:20,960 --> 00:21:23,360
how can they make that run faster more

562
00:21:23,360 --> 00:21:24,720
efficient

563
00:21:24,720 --> 00:21:26,159
rather than trying to build in all the

564
00:21:26,159 --> 00:21:30,880
tools to bypass av or edr detections

565
00:21:30,880 --> 00:21:33,280
they don't really most time care about

566
00:21:33,280 --> 00:21:35,679
escalating privileges they don't care

567
00:21:35,679 --> 00:21:37,360
about mapping your network a lot of

568
00:21:37,360 --> 00:21:38,720
times

569
00:21:38,720 --> 00:21:39,919
the mapping that they'll try of your

570
00:21:39,919 --> 00:21:41,679
network to see okay what map drives do

571
00:21:41,679 --> 00:21:42,720
you have

572
00:21:42,720 --> 00:21:44,320
some of them will go out and try to see

573
00:21:44,320 --> 00:21:46,400
if there's shares on your network

574
00:21:46,400 --> 00:21:48,320
but that's the extent they do they don't

575
00:21:48,320 --> 00:21:50,320
a lot of them don't try to like warm

576
00:21:50,320 --> 00:21:51,679
where they try to

577
00:21:51,679 --> 00:21:53,440
pivot their vulnerability

578
00:21:53,440 --> 00:21:55,200
you can again it's software you can make

579
00:21:55,200 --> 00:21:57,280
it pretty much do whatever you want

580
00:21:57,280 --> 00:21:58,960
but a lot of them they want to spend

581
00:21:58,960 --> 00:22:01,360
those times and the complexities of

582
00:22:01,360 --> 00:22:03,039
obfuscating their code

583
00:22:03,039 --> 00:22:04,799
a lot of times the ransomware itself

584
00:22:04,799 --> 00:22:06,960
they don't spend that much time on it

585
00:22:06,960 --> 00:22:08,880
because they don't care

586
00:22:08,880 --> 00:22:10,080
they already have your systems they

587
00:22:10,080 --> 00:22:11,600
could be signatures they disabled your

588
00:22:11,600 --> 00:22:13,840
edr

589
00:22:13,840 --> 00:22:17,120
no point in hiding at that point

590
00:22:18,159 --> 00:22:20,960
so i completely stole this image from a

591
00:22:20,960 --> 00:22:22,880
ransomware vendor site

592
00:22:22,880 --> 00:22:25,039
uh it kind of goes over what's the

593
00:22:25,039 --> 00:22:27,039
differences between

594
00:22:27,039 --> 00:22:29,919
malware and ransomware

595
00:22:29,919 --> 00:22:32,159
i don't on the ransomware side i don't

596
00:22:32,159 --> 00:22:35,440
particularly like the last three

597
00:22:35,440 --> 00:22:38,000
because i've not seen too many of them

598
00:22:38,000 --> 00:22:40,480
try to elevate privileges they might try

599
00:22:40,480 --> 00:22:42,720
to you might be admin they might try to

600
00:22:42,720 --> 00:22:44,640
elevate them their their selves to

601
00:22:44,640 --> 00:22:45,600
system

602
00:22:45,600 --> 00:22:46,880
because when you're actually going you

603
00:22:46,880 --> 00:22:48,240
have a lower context if you're just

604
00:22:48,240 --> 00:22:50,159
admin you have to bump it up to get

605
00:22:50,159 --> 00:22:52,080
access to a little bit more

606
00:22:52,080 --> 00:22:53,840
i don't consider that quite elevation of

607
00:22:53,840 --> 00:22:55,440
privileges i think if you go in as a

608
00:22:55,440 --> 00:22:56,880
regular user

609
00:22:56,880 --> 00:22:59,280
or some type of surface service account

610
00:22:59,280 --> 00:23:01,280
escalating yourself to admin in my

611
00:23:01,280 --> 00:23:04,080
opinion is escalation privileges

612
00:23:04,080 --> 00:23:06,320
transferring files and data

613
00:23:06,320 --> 00:23:08,799
i don't see a lot of ransomware actually

614
00:23:08,799 --> 00:23:10,080
doing this

615
00:23:10,080 --> 00:23:12,240
most ransomware that i see don't like to

616
00:23:12,240 --> 00:23:13,760
beacon out

617
00:23:13,760 --> 00:23:15,919
it's a lot of times it just wants to run

618
00:23:15,919 --> 00:23:18,000
and encrypt things local almost all the

619
00:23:18,000 --> 00:23:19,520
exfil they've done they've done

620
00:23:19,520 --> 00:23:21,760
previously

621
00:23:21,760 --> 00:23:23,280
that could be through other malware

622
00:23:23,280 --> 00:23:26,480
software or it could be just they have

623
00:23:26,480 --> 00:23:27,760
unfortunately a lot of times we see an

624
00:23:27,760 --> 00:23:29,360
rdp session

625
00:23:29,360 --> 00:23:32,799
where they just copy it out

626
00:23:33,039 --> 00:23:35,039
again the exiltration of key material

627
00:23:35,039 --> 00:23:38,080
again that is done normally outside of

628
00:23:38,080 --> 00:23:42,039
the actual ransomware software

629
00:23:50,960 --> 00:23:52,000
yeah and that's the reason i like to

630
00:23:52,000 --> 00:23:53,520
call a distinction between a ransomware

631
00:23:53,520 --> 00:23:55,760
attack and the ransomware itself

632
00:23:55,760 --> 00:23:57,440
normally when you hear people talk about

633
00:23:57,440 --> 00:23:58,720
ransomware

634
00:23:58,720 --> 00:24:00,720
they think that it's just a one

635
00:24:00,720 --> 00:24:03,840
executable one program that does it all

636
00:24:03,840 --> 00:24:05,600
when a lot of times it's not the

637
00:24:05,600 --> 00:24:07,600
ransomware itself is just a very small

638
00:24:07,600 --> 00:24:09,918
part

639
00:24:11,120 --> 00:24:13,840
um general malware itself

640
00:24:13,840 --> 00:24:15,039
there's the

641
00:24:15,039 --> 00:24:16,559
wonderful tons of different things that

642
00:24:16,559 --> 00:24:18,400
the malware will try to do

643
00:24:18,400 --> 00:24:22,400
and hiding itself gaining persistence

644
00:24:22,400 --> 00:24:24,640
the obfuscation in malware itself is

645
00:24:24,640 --> 00:24:26,159
sometimes just

646
00:24:26,159 --> 00:24:29,520
a nightmare if you try to reverse it

647
00:24:29,520 --> 00:24:31,520
a lot of malware itself they'll key to

648
00:24:31,520 --> 00:24:33,440
the actual systems or the domains you're

649
00:24:33,440 --> 00:24:34,320
using

650
00:24:34,320 --> 00:24:37,200
none of that is seen inside ransomware

651
00:24:37,200 --> 00:24:38,640
which is part the reason why it's so

652
00:24:38,640 --> 00:24:41,279
hard for like your avs or edrs to detect

653
00:24:41,279 --> 00:24:42,880
the rants earlier

654
00:24:42,880 --> 00:24:45,279
because it's using basic things it's

655
00:24:45,279 --> 00:24:48,000
it's will run like your winzip

656
00:24:48,000 --> 00:24:49,440
like if you try to password protect a

657
00:24:49,440 --> 00:24:51,919
file or a group of files

658
00:24:51,919 --> 00:24:55,120
it it runs using basic i open files i

659
00:24:55,120 --> 00:24:58,000
write files i delete files

660
00:24:58,000 --> 00:25:00,799
um the encrypting of the files

661
00:25:00,799 --> 00:25:03,200
that is they normally will use the same

662
00:25:03,200 --> 00:25:05,279
file they'll open it

663
00:25:05,279 --> 00:25:06,640
encrypt all the data and then write it

664
00:25:06,640 --> 00:25:08,880
back

665
00:25:10,240 --> 00:25:12,400
so

666
00:25:12,400 --> 00:25:13,760
kind of blew through that really fast

667
00:25:13,760 --> 00:25:14,960
because i wanted to spend a little bit

668
00:25:14,960 --> 00:25:16,799
more time going through samples which

669
00:25:16,799 --> 00:25:19,840
i'm hoping you guys can be able to see

670
00:25:19,840 --> 00:25:21,760
um

671
00:25:21,760 --> 00:25:23,440
so i'm going to go through the kanti

672
00:25:23,440 --> 00:25:26,320
sample of ransomware to demonstrate the

673
00:25:26,320 --> 00:25:28,880
complexity of it

674
00:25:28,880 --> 00:25:30,640
one thing i happen to also do is i have

675
00:25:30,640 --> 00:25:32,640
the source code for it so it's easier to

676
00:25:32,640 --> 00:25:35,440
read for anybody who likes c

677
00:25:35,440 --> 00:25:37,120
i don't know how many people here like c

678
00:25:37,120 --> 00:25:39,200
so

679
00:25:39,200 --> 00:25:41,840
c is a little easier to read than

680
00:25:41,840 --> 00:25:43,600
assemble it

681
00:25:43,600 --> 00:25:45,600
but i also have a

682
00:25:45,600 --> 00:25:47,919
ghidra version of the assembly for a

683
00:25:47,919 --> 00:25:49,919
similar kanti sample so i can kind of

684
00:25:49,919 --> 00:25:51,360
show you what it looks like when it's in

685
00:25:51,360 --> 00:25:53,919
c and what it looks like when it's been

686
00:25:53,919 --> 00:25:56,919
compiled

687
00:25:58,400 --> 00:25:59,919
somebody posted a link inside a work

688
00:25:59,919 --> 00:26:00,720
chat

689
00:26:00,720 --> 00:26:03,840
and i just downloaded it

690
00:26:04,720 --> 00:26:06,159
um

691
00:26:06,159 --> 00:26:09,520
i think if you also go to like vx on uh

692
00:26:09,520 --> 00:26:12,400
vx underground

693
00:26:12,559 --> 00:26:14,640
they have that's where i got the sample

694
00:26:14,640 --> 00:26:16,559
but i think they also have the code up

695
00:26:16,559 --> 00:26:19,600
there as well um they do have code for a

696
00:26:19,600 --> 00:26:21,600
couple others different ransomware and

697
00:26:21,600 --> 00:26:22,880
malware samples too that have been

698
00:26:22,880 --> 00:26:24,559
leaked

699
00:26:24,559 --> 00:26:27,120
they also will have write-ups on people

700
00:26:27,120 --> 00:26:29,760
who've done research or analysis of them

701
00:26:29,760 --> 00:26:31,440
so it's kind of a nice if you don't have

702
00:26:31,440 --> 00:26:33,760
time especially during an ir case when

703
00:26:33,760 --> 00:26:34,720
you get

704
00:26:34,720 --> 00:26:36,480
a piece of malware and you don't have

705
00:26:36,480 --> 00:26:38,240
time to actually dig into it to figure

706
00:26:38,240 --> 00:26:40,000
out what it does going up to some of

707
00:26:40,000 --> 00:26:42,559
those sites will give you a cheat sheet

708
00:26:42,559 --> 00:26:44,559
into what to look for

709
00:26:44,559 --> 00:26:46,960
they might not match 100 but it gives

710
00:26:46,960 --> 00:26:49,440
you a good idea

711
00:26:49,440 --> 00:26:52,159
i've had a situation in the past where a

712
00:26:52,159 --> 00:26:54,640
client was hit with some malware

713
00:26:54,640 --> 00:26:56,480
and it was

714
00:26:56,480 --> 00:26:58,320
they had an audited coming in like the

715
00:26:58,320 --> 00:27:00,799
next day or another on the next week and

716
00:27:00,799 --> 00:27:02,400
i had a weekend to reverse engineer the

717
00:27:02,400 --> 00:27:04,480
malware i happen to go out and find

718
00:27:04,480 --> 00:27:06,799
almost the exact same code base so i was

719
00:27:06,799 --> 00:27:08,559
able to go side by side and actually

720
00:27:08,559 --> 00:27:11,120
figure it out in like a day or two

721
00:27:11,120 --> 00:27:12,720
rather than like sometimes reversing

722
00:27:12,720 --> 00:27:15,760
takes weeks to months

723
00:27:16,960 --> 00:27:19,520
so let's

724
00:27:19,520 --> 00:27:22,080
exit that

725
00:27:27,440 --> 00:27:28,640
ow

726
00:27:28,640 --> 00:27:32,039
let me see

727
00:27:35,279 --> 00:27:37,279
that way i can see it too it's otherwise

728
00:27:37,279 --> 00:27:40,000
it's really hard

729
00:27:45,270 --> 00:27:46,960
[Music]

730
00:27:46,960 --> 00:27:49,520
so

731
00:27:49,520 --> 00:27:51,840
let me

732
00:27:52,799 --> 00:27:54,399
so this is i'm not going to go through

733
00:27:54,399 --> 00:27:56,399
every one of the files can you guys see

734
00:27:56,399 --> 00:27:59,879
this at all

735
00:28:10,320 --> 00:28:11,840
yeah i didn't think about this

736
00:28:11,840 --> 00:28:13,520
two way through when i was setting it up

737
00:28:13,520 --> 00:28:15,760
but it's like ah

738
00:28:15,760 --> 00:28:17,440
so there's only going to be a handful of

739
00:28:17,440 --> 00:28:18,480
these files that i'm actually going to

740
00:28:18,480 --> 00:28:20,399
walk you guys through a lot of the other

741
00:28:20,399 --> 00:28:25,399
ones are just helper or supporting files

742
00:28:31,520 --> 00:28:34,240
let's start off with just the main

743
00:28:34,240 --> 00:28:36,320
so the initial pieces what they come in

744
00:28:36,320 --> 00:28:38,799
is they do this initialize api

745
00:28:38,799 --> 00:28:40,159
module

746
00:28:40,159 --> 00:28:42,159
this one will actually then go through

747
00:28:42,159 --> 00:28:43,440
and try to

748
00:28:43,440 --> 00:28:46,000
register your libraries that they'll

749
00:28:46,000 --> 00:28:47,760
need so that it doesn't link them

750
00:28:47,760 --> 00:28:49,360
directly

751
00:28:49,360 --> 00:28:51,200
this is kind of

752
00:28:51,200 --> 00:28:52,240
it all it makes a little more

753
00:28:52,240 --> 00:28:53,360
obfuscation when you're looking at the

754
00:28:53,360 --> 00:28:56,760
code as well

755
00:28:58,320 --> 00:28:59,919
so

756
00:28:59,919 --> 00:29:03,600
and i apologize guys i use vim

757
00:29:04,080 --> 00:29:05,760
so if you see me bouncing around that's

758
00:29:05,760 --> 00:29:07,840
what i'm doing

759
00:29:07,840 --> 00:29:08,720
um

760
00:29:08,720 --> 00:29:10,559
so this one will go in first and cause i

761
00:29:10,559 --> 00:29:11,760
get the api

762
00:29:11,760 --> 00:29:13,520
address it will look for the libraries

763
00:29:13,520 --> 00:29:15,279
for the hashes it will try to load the

764
00:29:15,279 --> 00:29:17,440
basic libraries

765
00:29:17,440 --> 00:29:18,960
not a whole lot to it will allocate a

766
00:29:18,960 --> 00:29:20,720
space that they will use then as a

767
00:29:20,720 --> 00:29:22,880
reference for later on

768
00:29:22,880 --> 00:29:25,440
the next is the disable hooks

769
00:29:25,440 --> 00:29:26,799
where it will go through in any hooks

770
00:29:26,799 --> 00:29:28,159
that are already set up for like your

771
00:29:28,159 --> 00:29:30,960
kernel 32 your win32 drivers

772
00:29:30,960 --> 00:29:32,720
ntdll any of the type of libraries

773
00:29:32,720 --> 00:29:34,080
they're going to be using

774
00:29:34,080 --> 00:29:36,080
it will grab hold of those and then try

775
00:29:36,080 --> 00:29:39,760
to reload its own copy of them

776
00:29:39,760 --> 00:29:41,200
later on it will go then through and

777
00:29:41,200 --> 00:29:42,880
just trying to clean up the hook so that

778
00:29:42,880 --> 00:29:45,039
anything that's using is using its copy

779
00:29:45,039 --> 00:29:47,120
its pointer of them rather than the

780
00:29:47,120 --> 00:29:50,320
normal ones that are loaded in

781
00:29:50,880 --> 00:29:51,760
uh

782
00:29:51,760 --> 00:29:54,159
it goes through and generates a list or

783
00:29:54,159 --> 00:29:56,720
takes basically a bunch of cues of oh

784
00:29:56,720 --> 00:29:58,480
how many drives are our shared drives

785
00:29:58,480 --> 00:30:01,200
what are the hosts around it

786
00:30:01,200 --> 00:30:03,440
are there any whitelisted pids something

787
00:30:03,440 --> 00:30:05,279
that conti will do is it will go through

788
00:30:05,279 --> 00:30:08,399
and try to kill off previous versions or

789
00:30:08,399 --> 00:30:10,720
if you give it an id or a name of

790
00:30:10,720 --> 00:30:12,399
something a process it will try to kill

791
00:30:12,399 --> 00:30:15,199
those beforehand

792
00:30:16,960 --> 00:30:19,200
it creates a mutex again it's trying to

793
00:30:19,200 --> 00:30:20,640
protect itself to see if it's already

794
00:30:20,640 --> 00:30:22,000
running so it doesn't run multiple

795
00:30:22,000 --> 00:30:25,360
copies of itself and ends up fighting

796
00:30:25,360 --> 00:30:27,360
this copy has debug

797
00:30:27,360 --> 00:30:29,200
so if not debug then it parses the

798
00:30:29,200 --> 00:30:32,080
command line for your inputs coming in

799
00:30:32,080 --> 00:30:34,640
if it's debug it writes its own

800
00:30:34,640 --> 00:30:36,640
just the test one

801
00:30:36,640 --> 00:30:38,880
uh next steps that does it grabs your

802
00:30:38,880 --> 00:30:41,360
system's information

803
00:30:41,360 --> 00:30:43,440
and this is used to try to determine how

804
00:30:43,440 --> 00:30:45,120
beefy is your system how many threads

805
00:30:45,120 --> 00:30:48,159
can it spawn to start your encryption

806
00:30:48,159 --> 00:30:50,399
uh so that's what these these two lines

807
00:30:50,399 --> 00:30:51,840
are doing is trying to determine okay

808
00:30:51,840 --> 00:30:53,360
how many threads can i use for local how

809
00:30:53,360 --> 00:30:56,799
many threads will i use for network

810
00:30:57,600 --> 00:30:59,679
then next thing it does it creates a

811
00:30:59,679 --> 00:31:00,880
thread pool

812
00:31:00,880 --> 00:31:03,440
um basically it's going to be now let me

813
00:31:03,440 --> 00:31:05,840
move into

814
00:31:06,559 --> 00:31:08,399
i had these set up online so i could see

815
00:31:08,399 --> 00:31:10,159
them all on the page but they don't show

816
00:31:10,159 --> 00:31:11,440
up here

817
00:31:11,440 --> 00:31:13,360
so create thread pool actually just

818
00:31:13,360 --> 00:31:15,279
comes in it sets up the events that it's

819
00:31:15,279 --> 00:31:18,399
using so that anytime you put

820
00:31:18,399 --> 00:31:21,200
a new file name on the queue the thread

821
00:31:21,200 --> 00:31:22,480
itself that's running in the background

822
00:31:22,480 --> 00:31:24,559
will pop that that name off and try to

823
00:31:24,559 --> 00:31:26,000
encrypt that file

824
00:31:26,000 --> 00:31:27,840
and then you can have multiple threads

825
00:31:27,840 --> 00:31:29,919
running all doing the same

826
00:31:29,919 --> 00:31:30,840
type of

827
00:31:30,840 --> 00:31:33,840
work that part was actually will

828
00:31:33,840 --> 00:31:35,679
actually be when we call the bottom part

829
00:31:35,679 --> 00:31:37,919
here

830
00:31:38,559 --> 00:31:42,320
the start i'm sorry

831
00:31:43,679 --> 00:31:46,080
start itself comes in checks to see what

832
00:31:46,080 --> 00:31:47,279
type of thread pool you're saying

833
00:31:47,279 --> 00:31:50,000
whether you're doing network local

834
00:31:50,000 --> 00:31:51,360
backups

835
00:31:51,360 --> 00:31:53,360
and then this for loop will take that

836
00:31:53,360 --> 00:31:55,760
value we said earlier of how many uh

837
00:31:55,760 --> 00:31:57,919
threads or any processes we do and it

838
00:31:57,919 --> 00:32:00,240
will actually create a thread that's

839
00:32:00,240 --> 00:32:03,600
running this thread handler

840
00:32:09,760 --> 00:32:14,200
i'm really used to a very large monitor

841
00:32:15,760 --> 00:32:19,440
actually my desk one's not too far off

842
00:32:19,519 --> 00:32:21,279
one thing i found is like the reverse

843
00:32:21,279 --> 00:32:22,880
engineering with a very large monitor is

844
00:32:22,880 --> 00:32:24,159
very nice

845
00:32:24,159 --> 00:32:26,000
trying to do it on the laptop

846
00:32:26,000 --> 00:32:28,559
um

847
00:32:28,559 --> 00:32:30,960
i know i had originally like four

848
00:32:30,960 --> 00:32:33,760
computer four monitors and i hated it so

849
00:32:33,760 --> 00:32:36,320
i found one that was a 42 inch actual

850
00:32:36,320 --> 00:32:37,440
monitor

851
00:32:37,440 --> 00:32:40,399
and i replaced all of them with just it

852
00:32:40,399 --> 00:32:42,960
and it i wanted a widescreen but i also

853
00:32:42,960 --> 00:32:45,519
need the height

854
00:32:45,519 --> 00:32:49,200
it's completely derailed sorry

855
00:32:54,640 --> 00:32:57,600
wow that was full when i

856
00:32:57,600 --> 00:33:00,840
got him

857
00:33:04,240 --> 00:33:07,399
thank you

858
00:33:21,200 --> 00:33:22,799
i have had issues with this computer and

859
00:33:22,799 --> 00:33:24,640
its battery this is the second battery

860
00:33:24,640 --> 00:33:27,360
i've used in it

861
00:33:30,559 --> 00:33:32,559
i don't run much on this

862
00:33:32,559 --> 00:33:34,159
um honestly i

863
00:33:34,159 --> 00:33:36,480
anytime i have a server at my house that

864
00:33:36,480 --> 00:33:38,080
i run proxmox on that i do all my

865
00:33:38,080 --> 00:33:39,600
analysis on

866
00:33:39,600 --> 00:33:41,200
and this is just basically a dumb

867
00:33:41,200 --> 00:33:43,600
computer

868
00:33:50,240 --> 00:33:52,480
okay so um once it comes into this

869
00:33:52,480 --> 00:33:53,519
thread

870
00:33:53,519 --> 00:33:54,960
it sets up a couple different things in

871
00:33:54,960 --> 00:33:56,720
the first part of it and then it gets

872
00:33:56,720 --> 00:33:58,960
into your while loop that basically just

873
00:33:58,960 --> 00:34:01,679
excuse me pulls things off of that cue

874
00:34:01,679 --> 00:34:04,240
and then it will try to uh

875
00:34:04,240 --> 00:34:06,000
it does some interesting things where it

876
00:34:06,000 --> 00:34:08,000
tries to uh deter

877
00:34:08,000 --> 00:34:09,199
sorry let me double check make sure i'm

878
00:34:09,199 --> 00:34:12,158
not getting ahead of myself

879
00:34:16,239 --> 00:34:17,918
okay yeah so this one comes through it

880
00:34:17,918 --> 00:34:19,599
grabs out the name off the queue it does

881
00:34:19,599 --> 00:34:20,960
a couple things looking at the name to

882
00:34:20,960 --> 00:34:22,719
try to determine okay i've already

883
00:34:22,719 --> 00:34:24,639
encrypted this or not and then it will

884
00:34:24,639 --> 00:34:26,000
eventually come down and follow into

885
00:34:26,000 --> 00:34:27,679
this encrypt

886
00:34:27,679 --> 00:34:30,720
function inside locker

887
00:34:31,119 --> 00:34:33,119
inside this this is where okay it goes

888
00:34:33,119 --> 00:34:34,800
through the actual encryption steps of

889
00:34:34,800 --> 00:34:35,839
it

890
00:34:35,839 --> 00:34:37,199
the one thing i think that's interesting

891
00:34:37,199 --> 00:34:38,239
with this

892
00:34:38,239 --> 00:34:40,399
is it tries to determine what kind of

893
00:34:40,399 --> 00:34:41,679
file it is

894
00:34:41,679 --> 00:34:43,359
is it a database file then they make

895
00:34:43,359 --> 00:34:45,839
sure they encrypt all the file if it's a

896
00:34:45,839 --> 00:34:48,399
virtual box or a vm

897
00:34:48,399 --> 00:34:50,719
the only encrypt part of the file

898
00:34:50,719 --> 00:34:52,399
part of the thinking behind that i think

899
00:34:52,399 --> 00:34:54,399
is the fact that those files are so

900
00:34:54,399 --> 00:34:55,440
large

901
00:34:55,440 --> 00:34:57,280
that if they change spend all their time

902
00:34:57,280 --> 00:35:01,599
just running over a 100 gig file

903
00:35:01,599 --> 00:35:03,119
if you detect it there's a better chance

904
00:35:03,119 --> 00:35:04,560
you can stop them from getting to other

905
00:35:04,560 --> 00:35:06,640
files that are more sensitive so they're

906
00:35:06,640 --> 00:35:08,400
only going to encrypt certain parts of

907
00:35:08,400 --> 00:35:10,880
that file just to corrupt it

908
00:35:10,880 --> 00:35:14,000
and then move on to others

909
00:35:14,720 --> 00:35:17,119
they overwrite it uh so the issue is if

910
00:35:17,119 --> 00:35:19,599
you try to copy a file there's a chance

911
00:35:19,599 --> 00:35:20,800
it's still on the disk and you can

912
00:35:20,800 --> 00:35:22,240
recover it

913
00:35:22,240 --> 00:35:24,560
uh it just removes the pointer to the

914
00:35:24,560 --> 00:35:26,880
side of the ntfs but if you do some more

915
00:35:26,880 --> 00:35:29,040
deep forensics on it there's that

916
00:35:29,040 --> 00:35:30,880
an off chance that you might be able to

917
00:35:30,880 --> 00:35:34,760
recover parts of it

918
00:35:42,839 --> 00:35:45,760
yeah um so the other side of the thing

919
00:35:45,760 --> 00:35:47,440
that this piece of malware will actually

920
00:35:47,440 --> 00:35:50,320
do is it'll check the file size itself

921
00:35:50,320 --> 00:35:52,320
if it's a very very large file it will

922
00:35:52,320 --> 00:35:55,839
only encrypt a part of it um if it's

923
00:35:55,839 --> 00:35:57,359
underneath a certain file size then it

924
00:35:57,359 --> 00:36:00,400
will recruit all of it

925
00:36:00,960 --> 00:36:02,640
i'm not going to actually dig into the

926
00:36:02,640 --> 00:36:04,240
actual what they're doing for the

927
00:36:04,240 --> 00:36:05,920
encryption

928
00:36:05,920 --> 00:36:07,680
most of this you can really just go on

929
00:36:07,680 --> 00:36:10,400
to stack overflow and copy out the

930
00:36:10,400 --> 00:36:11,760
encryption software

931
00:36:11,760 --> 00:36:13,200
that's pretty much what they use a lot

932
00:36:13,200 --> 00:36:14,400
of times

933
00:36:14,400 --> 00:36:16,240
sometimes they'll go in and they'll get

934
00:36:16,240 --> 00:36:19,839
third party libraries they'll pull in

935
00:36:21,040 --> 00:36:22,880
does it have like a barometer so you

936
00:36:22,880 --> 00:36:25,200
don't notice it while it's working

937
00:36:25,200 --> 00:36:27,839
so

938
00:36:29,599 --> 00:36:32,079
this one i did not see um actually that

939
00:36:32,079 --> 00:36:33,119
was going to get something i was going

940
00:36:33,119 --> 00:36:35,200
to talk about later um there's a lot of

941
00:36:35,200 --> 00:36:37,200
tools out there that they're ransomware

942
00:36:37,200 --> 00:36:38,880
products that people are selling

943
00:36:38,880 --> 00:36:40,560
they're like yes we're going to stop

944
00:36:40,560 --> 00:36:42,240
ransomware some of their detections is

945
00:36:42,240 --> 00:36:44,320
just the fact that touching files so

946
00:36:44,320 --> 00:36:45,280
fast

947
00:36:45,280 --> 00:36:47,280
that's what it triggers on

948
00:36:47,280 --> 00:36:48,880
so yeah having something that will go

949
00:36:48,880 --> 00:36:50,560
through and say okay i'm only going to

950
00:36:50,560 --> 00:36:52,560
encrypt

951
00:36:52,560 --> 00:36:55,440
10 files at a time or in a minute

952
00:36:55,440 --> 00:36:57,359
or some rate limit will bypass any of

953
00:36:57,359 --> 00:36:59,520
type that type of protection

954
00:36:59,520 --> 00:37:01,760
but again it's software it's not that

955
00:37:01,760 --> 00:37:02,960
hard to actually put some type of rate

956
00:37:02,960 --> 00:37:06,440
limiting in here

957
00:37:08,320 --> 00:37:11,119
inventory management recording on these

958
00:37:11,119 --> 00:37:14,160
systems of being productive

959
00:37:14,160 --> 00:37:14,960
and

960
00:37:14,960 --> 00:37:16,480
what if it's

961
00:37:16,480 --> 00:37:19,280
attempting it being successful

962
00:37:19,280 --> 00:37:20,960
no a lot of times with again the

963
00:37:20,960 --> 00:37:22,880
ransomware itself is dumb

964
00:37:22,880 --> 00:37:25,839
they just throw it out and hope it works

965
00:37:25,839 --> 00:37:27,200
most time it will work because they're

966
00:37:27,200 --> 00:37:29,440
running it as an admin

967
00:37:29,440 --> 00:37:32,079
um as far as what we've seen inside ir

968
00:37:32,079 --> 00:37:33,440
cases itself

969
00:37:33,440 --> 00:37:34,800
uh one of the first things they do with

970
00:37:34,800 --> 00:37:36,560
the reconnaissance is they develop a

971
00:37:36,560 --> 00:37:38,720
list of all your hosts

972
00:37:38,720 --> 00:37:39,920
and that's what they use to kind of

973
00:37:39,920 --> 00:37:41,359
check off of whether or not they've ran

974
00:37:41,359 --> 00:37:44,598
it on there

975
00:37:51,119 --> 00:37:53,520
well yeah the negotiators sometimes work

976
00:37:53,520 --> 00:37:56,079
independently of the ir investigation

977
00:37:56,079 --> 00:37:57,520
but by the time that they get brought in

978
00:37:57,520 --> 00:37:59,040
we have a pretty good idea of how many

979
00:37:59,040 --> 00:38:00,800
computers were affected

980
00:38:00,800 --> 00:38:02,960
because

981
00:38:03,280 --> 00:38:05,440
that's not all the time now

982
00:38:05,440 --> 00:38:06,480
and that kind of actually goes back to

983
00:38:06,480 --> 00:38:07,760
something i kind of meant to talk about

984
00:38:07,760 --> 00:38:08,800
earlier

985
00:38:08,800 --> 00:38:10,320
um

986
00:38:10,320 --> 00:38:11,599
with some of the different types of

987
00:38:11,599 --> 00:38:13,599
ransomware attacks with the spray and

988
00:38:13,599 --> 00:38:16,079
praise or the drive-bys

989
00:38:16,079 --> 00:38:17,119
um

990
00:38:17,119 --> 00:38:19,440
the ransomware itself is not keyed right

991
00:38:19,440 --> 00:38:22,320
so it's a generic uh private key

992
00:38:22,320 --> 00:38:24,320
so it might 20 organizations might get

993
00:38:24,320 --> 00:38:25,839
hit with the same ransomware one person

994
00:38:25,839 --> 00:38:28,000
pays posts the decryption online it's

995
00:38:28,000 --> 00:38:30,240
usable for the others

996
00:38:30,240 --> 00:38:32,000
they move to try and be more specific

997
00:38:32,000 --> 00:38:34,880
for our each organization

998
00:38:34,880 --> 00:38:36,640
that is another thing that's a little

999
00:38:36,640 --> 00:38:37,920
bit more of a headache for the

1000
00:38:37,920 --> 00:38:40,079
ransomware groups is the fact of how do

1001
00:38:40,079 --> 00:38:41,680
they know which key goes to what

1002
00:38:41,680 --> 00:38:43,760
software

1003
00:38:43,760 --> 00:38:46,240
um some of them they did they sometimes

1004
00:38:46,240 --> 00:38:48,960
we did see them beaking out that data

1005
00:38:48,960 --> 00:38:51,040
uh most of the time it's built into like

1006
00:38:51,040 --> 00:38:52,400
the ransom note

1007
00:38:52,400 --> 00:38:53,920
here's a key give it to me that we'll

1008
00:38:53,920 --> 00:38:55,839
line that up with what version of the

1009
00:38:55,839 --> 00:38:57,839
ransomware we gave you so what key lines

1010
00:38:57,839 --> 00:39:00,160
up to it

1011
00:39:00,160 --> 00:39:01,920
um sometimes when they're in the

1012
00:39:01,920 --> 00:39:03,359
releasing ransomware they'll use the

1013
00:39:03,359 --> 00:39:06,000
same ransomware with different keys

1014
00:39:06,000 --> 00:39:08,720
so you'll buy a decryption tool

1015
00:39:08,720 --> 00:39:11,839
it'll only work for part of your files

1016
00:39:11,839 --> 00:39:13,920
because they'll come back oh sorry yeah

1017
00:39:13,920 --> 00:39:15,599
that's that's a that's a new tier of

1018
00:39:15,599 --> 00:39:18,400
level service

1019
00:39:21,440 --> 00:39:23,200
so something else that i wanted to get

1020
00:39:23,200 --> 00:39:25,359
into and kind of show that in here real

1021
00:39:25,359 --> 00:39:26,560
quick before

1022
00:39:26,560 --> 00:39:29,119
kind of moving on how we doing time oh

1023
00:39:29,119 --> 00:39:31,440
sorry running late

1024
00:39:31,440 --> 00:39:33,119
um

1025
00:39:33,119 --> 00:39:35,359
obfuscation as far as when you get into

1026
00:39:35,359 --> 00:39:36,960
malware so one of the first things that

1027
00:39:36,960 --> 00:39:39,599
i ever do when i'm running malware i run

1028
00:39:39,599 --> 00:39:40,560
file

1029
00:39:40,560 --> 00:39:42,640
to see what is it really it checks your

1030
00:39:42,640 --> 00:39:44,160
magic headers

1031
00:39:44,160 --> 00:39:47,839
um i run an md5 hash of it a shawl 256

1032
00:39:47,839 --> 00:39:48,880
hash

1033
00:39:48,880 --> 00:39:52,160
and then i run strings

1034
00:39:52,480 --> 00:39:54,560
you'd be shocked with how fast strings

1035
00:39:54,560 --> 00:39:56,720
will give you the answers you need

1036
00:39:56,720 --> 00:39:59,680
um with this one i

1037
00:39:59,680 --> 00:40:02,240
don't know if you can see it well the

1038
00:40:02,240 --> 00:40:05,680
obfa and there's an obfw

1039
00:40:05,680 --> 00:40:10,040
any idea what obf stands for

1040
00:40:10,160 --> 00:40:12,480
obfuscation

1041
00:40:12,480 --> 00:40:15,839
uh the a is your ascii the w will be

1042
00:40:15,839 --> 00:40:17,520
like your wide string you're using the

1043
00:40:17,520 --> 00:40:18,720
code

1044
00:40:18,720 --> 00:40:20,720
so inside the code these are all really

1045
00:40:20,720 --> 00:40:22,319
readable strings

1046
00:40:22,319 --> 00:40:25,119
um when you actually get into the uh

1047
00:40:25,119 --> 00:40:26,319
the

1048
00:40:26,319 --> 00:40:28,960
reversing

1049
00:40:31,200 --> 00:40:32,880
uh

1050
00:40:32,880 --> 00:40:34,720
and i don't know how to zoom this part

1051
00:40:34,720 --> 00:40:38,279
in darn

1052
00:40:39,119 --> 00:40:40,560
this part down here

1053
00:40:40,560 --> 00:40:43,839
is what that string looks like

1054
00:40:44,079 --> 00:40:47,920
so what the obf a and ovfw is is a

1055
00:40:47,920 --> 00:40:50,240
pre-compiler option so when you go to

1056
00:40:50,240 --> 00:40:52,800
actually compile this it removes the

1057
00:40:52,800 --> 00:40:55,119
string and then puts this obfuscation

1058
00:40:55,119 --> 00:40:58,560
routine in its place

1059
00:40:58,880 --> 00:41:01,359
so what they'll do is though i i

1060
00:41:01,359 --> 00:41:06,160
relabeled these so i knew what they were

1061
00:41:06,160 --> 00:41:08,160
they'll put the characters in a

1062
00:41:08,160 --> 00:41:10,000
basically a byte array and then we'll

1063
00:41:10,000 --> 00:41:12,240
come down and do a simple

1064
00:41:12,240 --> 00:41:14,400
uh math operation on it to get back to

1065
00:41:14,400 --> 00:41:17,119
the original piece and in this case it's

1066
00:41:17,119 --> 00:41:18,560
whatever the current

1067
00:41:18,560 --> 00:41:21,119
original value was subtracted by some

1068
00:41:21,119 --> 00:41:22,720
value

1069
00:41:22,720 --> 00:41:25,440
multiplicated by multiple yeah wow sorry

1070
00:41:25,440 --> 00:41:28,319
talking hard multiplica multiplied by

1071
00:41:28,319 --> 00:41:30,960
another value and then

1072
00:41:30,960 --> 00:41:33,280
modulus so that it's back inside the

1073
00:41:33,280 --> 00:41:36,319
regular byte range

1074
00:41:36,319 --> 00:41:39,760
so this is just annoying

1075
00:41:39,760 --> 00:41:41,040
when you're doing rura's engineering and

1076
00:41:41,040 --> 00:41:42,800
this is what you're looking at

1077
00:41:42,800 --> 00:41:45,520
because the way they did this is that

1078
00:41:45,520 --> 00:41:49,040
obfw and obfa uses a random value

1079
00:41:49,040 --> 00:41:51,599
generator for the pre-compiler

1080
00:41:51,599 --> 00:41:54,319
so each one of these strings is compiled

1081
00:41:54,319 --> 00:41:57,040
or obfuscated using the same technique

1082
00:41:57,040 --> 00:41:58,960
but different values

1083
00:41:58,960 --> 00:42:00,880
so writing a script to go through is a

1084
00:42:00,880 --> 00:42:03,839
little bit more of a pain

1085
00:42:04,079 --> 00:42:06,800
so to cheat

1086
00:42:08,079 --> 00:42:12,440
let's see if i can bring this up

1087
00:42:16,960 --> 00:42:19,440
come on

1088
00:42:21,440 --> 00:42:25,560
this is not liking my t-mux

1089
00:42:36,720 --> 00:42:40,200
oh darn

1090
00:42:45,760 --> 00:42:47,200
well looks like i'm not going to show

1091
00:42:47,200 --> 00:42:50,399
you that because i can't

1092
00:42:57,280 --> 00:42:59,839
there we go

1093
00:43:02,160 --> 00:43:03,839
so when i first started going through it

1094
00:43:03,839 --> 00:43:05,760
i always have the way i tend to do

1095
00:43:05,760 --> 00:43:07,440
things is i always have like a python

1096
00:43:07,440 --> 00:43:09,040
file that i write

1097
00:43:09,040 --> 00:43:11,440
and i do my i was doing the

1098
00:43:11,440 --> 00:43:13,359
a new function for each one until i

1099
00:43:13,359 --> 00:43:15,760
realized that there was a pattern to him

1100
00:43:15,760 --> 00:43:18,319
and then what's up

1101
00:43:18,319 --> 00:43:20,160
okay what i do

1102
00:43:20,160 --> 00:43:21,599
i'm not used to this keyboard i always

1103
00:43:21,599 --> 00:43:24,000
have a desk a regular keyboard next to

1104
00:43:24,000 --> 00:43:26,560
me

1105
00:43:26,560 --> 00:43:28,079
so when i got to the point i started

1106
00:43:28,079 --> 00:43:29,520
realizing what the pattern was i created

1107
00:43:29,520 --> 00:43:31,200
two functions

1108
00:43:31,200 --> 00:43:33,119
for the two different variations of

1109
00:43:33,119 --> 00:43:34,640
their obfuscation

1110
00:43:34,640 --> 00:43:36,079
and then after that i started printing

1111
00:43:36,079 --> 00:43:38,000
out each of their sequences to figure

1112
00:43:38,000 --> 00:43:41,839
out what was going on

1113
00:43:45,760 --> 00:43:47,280
and then i just dump it all out to the

1114
00:43:47,280 --> 00:43:49,040
screen and then i take that values and i

1115
00:43:49,040 --> 00:43:51,680
put it back inside gidra as the variable

1116
00:43:51,680 --> 00:43:53,920
inside there so i know what's going on

1117
00:43:53,920 --> 00:43:56,000
so as you can see with some of these

1118
00:43:56,000 --> 00:43:58,000
uh something i wanted to call out it

1119
00:43:58,000 --> 00:43:59,440
goes through and tries to remove your

1120
00:43:59,440 --> 00:44:01,359
shadow copies

1121
00:44:01,359 --> 00:44:03,200
it's something like i'm

1122
00:44:03,200 --> 00:44:04,640
really not going to have time to go into

1123
00:44:04,640 --> 00:44:06,480
which i was hoping to but

1124
00:44:06,480 --> 00:44:09,200
then they also will have lists of uh

1125
00:44:09,200 --> 00:44:10,880
like different files that they're

1126
00:44:10,880 --> 00:44:12,160
focused on

1127
00:44:12,160 --> 00:44:13,920
uh they do checks for that they do check

1128
00:44:13,920 --> 00:44:15,200
to see whether or not it was already

1129
00:44:15,200 --> 00:44:16,319
encrypted

1130
00:44:16,319 --> 00:44:17,200
um

1131
00:44:17,200 --> 00:44:19,520
it will grab the name of the readme file

1132
00:44:19,520 --> 00:44:20,800
itself that they're putting the

1133
00:44:20,800 --> 00:44:24,400
ransomware note that's also obfuscated

1134
00:44:24,400 --> 00:44:26,000
one difference between the code base

1135
00:44:26,000 --> 00:44:28,720
that i had and the

1136
00:44:28,720 --> 00:44:31,680
the actual exe sample was the exe sample

1137
00:44:31,680 --> 00:44:32,960
had the

1138
00:44:32,960 --> 00:44:35,839
the ransom note as far as a resource so

1139
00:44:35,839 --> 00:44:37,359
it pulls it out of the resource then

1140
00:44:37,359 --> 00:44:40,160
writes it to disk

1141
00:44:40,400 --> 00:44:42,560
this will also say different files or

1142
00:44:42,560 --> 00:44:44,000
folders inside the windows directory

1143
00:44:44,000 --> 00:44:46,800
they're interested in

1144
00:44:49,359 --> 00:44:52,799
sorry rushing through this last part

1145
00:44:57,280 --> 00:44:59,200
so i kind of want to go real fast into

1146
00:44:59,200 --> 00:45:03,119
like the actual defense for ransomware

1147
00:45:03,119 --> 00:45:04,960
rather than focusing solely on

1148
00:45:04,960 --> 00:45:07,040
ransomware itself i like to say dude

1149
00:45:07,040 --> 00:45:09,200
basically your defense in depth

1150
00:45:09,200 --> 00:45:10,800
you have

1151
00:45:10,800 --> 00:45:12,160
the tools that are out there to protect

1152
00:45:12,160 --> 00:45:14,000
ransomware could help you yes there are

1153
00:45:14,000 --> 00:45:16,000
ways to bypass them

1154
00:45:16,000 --> 00:45:16,720
but

1155
00:45:16,720 --> 00:45:19,040
they could limit the actual

1156
00:45:19,040 --> 00:45:21,119
effectiveness of the ransomware software

1157
00:45:21,119 --> 00:45:22,960
if it happens to get to that point but

1158
00:45:22,960 --> 00:45:24,720
rather than spending lots of money on

1159
00:45:24,720 --> 00:45:26,800
the ransomware defense you almost need

1160
00:45:26,800 --> 00:45:29,200
to spend as much time up front to

1161
00:45:29,200 --> 00:45:31,599
remove the attacker's dwell time

1162
00:45:31,599 --> 00:45:32,960
the amount of time that they're in your

1163
00:45:32,960 --> 00:45:35,280
environment the faster you can detect

1164
00:45:35,280 --> 00:45:36,880
them and kick them out the less damage

1165
00:45:36,880 --> 00:45:38,560
they can do

1166
00:45:38,560 --> 00:45:39,280
so

1167
00:45:39,280 --> 00:45:41,680
i was that comes up to a lot of times of

1168
00:45:41,680 --> 00:45:43,520
just

1169
00:45:43,520 --> 00:45:44,720
monitoring

1170
00:45:44,720 --> 00:45:47,440
tools your your stack itself and then

1171
00:45:47,440 --> 00:45:49,839
having people that are able to actually

1172
00:45:49,839 --> 00:45:51,520
look at those logs look at what your

1173
00:45:51,520 --> 00:45:54,160
sims ingesting and know what's what they

1174
00:45:54,160 --> 00:45:55,599
need to focus on

1175
00:45:55,599 --> 00:45:57,200
um we've seen a lot of times where

1176
00:45:57,200 --> 00:45:58,800
people like smaller companies will do

1177
00:45:58,800 --> 00:46:01,119
third parties to do their uh

1178
00:46:01,119 --> 00:46:02,400
their sims

1179
00:46:02,400 --> 00:46:04,000
and

1180
00:46:04,000 --> 00:46:05,200
we get called in and one of the

1181
00:46:05,200 --> 00:46:06,560
questions they ask us is why didn't our

1182
00:46:06,560 --> 00:46:08,160
sim detect this

1183
00:46:08,160 --> 00:46:09,839
they had the logs the person who looked

1184
00:46:09,839 --> 00:46:11,040
at it just didn't know what they were

1185
00:46:11,040 --> 00:46:13,040
looking at

1186
00:46:13,040 --> 00:46:14,720
so some of the things that we also say

1187
00:46:14,720 --> 00:46:17,280
is uh do tabletops

1188
00:46:17,280 --> 00:46:18,640
um

1189
00:46:18,640 --> 00:46:20,720
it's basically a role-playing game it's

1190
00:46:20,720 --> 00:46:23,119
a safe environment where if you get get

1191
00:46:23,119 --> 00:46:25,119
the right company that comes in they'll

1192
00:46:25,119 --> 00:46:27,200
understand what your environment is like

1193
00:46:27,200 --> 00:46:30,079
customize the tabletop to be your target

1194
00:46:30,079 --> 00:46:31,440
against you

1195
00:46:31,440 --> 00:46:33,839
using things that they've seen

1196
00:46:33,839 --> 00:46:36,319
in real life and the idea is also to

1197
00:46:36,319 --> 00:46:38,560
make it the worst possible day ever for

1198
00:46:38,560 --> 00:46:39,760
you

1199
00:46:39,760 --> 00:46:41,440
because it's safe

1200
00:46:41,440 --> 00:46:43,520
nothing's really going to be encrypted

1201
00:46:43,520 --> 00:46:45,280
but you can walk through your steps if

1202
00:46:45,280 --> 00:46:47,040
you have third party vendors that do

1203
00:46:47,040 --> 00:46:49,599
your it and your security

1204
00:46:49,599 --> 00:46:51,440
you get them involved in it so you can

1205
00:46:51,440 --> 00:46:54,000
see how they will answer the questions

1206
00:46:54,000 --> 00:46:55,920
if you have a third-party ir group have

1207
00:46:55,920 --> 00:46:58,240
them involved so that you know and

1208
00:46:58,240 --> 00:46:59,680
you've gone through the stuff ahead of

1209
00:46:59,680 --> 00:47:01,520
time so you know how you're going to

1210
00:47:01,520 --> 00:47:03,520
react who to call

1211
00:47:03,520 --> 00:47:06,480
what they have what they don't have

1212
00:47:06,480 --> 00:47:08,000
um again

1213
00:47:08,000 --> 00:47:10,240
constant like i don't really recommend

1214
00:47:10,240 --> 00:47:12,079
releasing ransomware in your environment

1215
00:47:12,079 --> 00:47:15,440
to see how it will happen but

1216
00:47:16,400 --> 00:47:19,760
if you really want to live on the edge

1217
00:47:20,319 --> 00:47:22,400
but

1218
00:47:22,400 --> 00:47:25,359
okay so i'm pretty much out of time um

1219
00:47:25,359 --> 00:47:27,839
questions

1220
00:47:31,839 --> 00:47:32,880
um

1221
00:47:32,880 --> 00:47:35,760
again when i first started in ir we saw

1222
00:47:35,760 --> 00:47:37,440
ransoms as like

1223
00:47:37,440 --> 00:47:39,200
two hundred dollars

1224
00:47:39,200 --> 00:47:42,000
um we've seen a mask upwards of a couple

1225
00:47:42,000 --> 00:47:43,760
million

1226
00:47:43,760 --> 00:47:46,800
um it really depends on your environment

1227
00:47:46,800 --> 00:47:48,240
what you have

1228
00:47:48,240 --> 00:47:51,280
um if they're confident that there's

1229
00:47:51,280 --> 00:47:54,079
nothing you can do but go to them

1230
00:47:54,079 --> 00:47:55,920
the price is higher

1231
00:47:55,920 --> 00:47:58,640
um we've worked with some uh

1232
00:47:58,640 --> 00:48:00,400
clients who

1233
00:48:00,400 --> 00:48:02,400
basically their whole

1234
00:48:02,400 --> 00:48:04,160
company is going to go out of business

1235
00:48:04,160 --> 00:48:06,480
if they don't pay the ransom they had

1236
00:48:06,480 --> 00:48:08,480
more problems negotiating than others

1237
00:48:08,480 --> 00:48:11,520
who just wanted a couple documents back

1238
00:48:11,520 --> 00:48:12,559
because the

1239
00:48:12,559 --> 00:48:14,160
attackers had spent enough time in their

1240
00:48:14,160 --> 00:48:16,240
environment to know the damage they

1241
00:48:16,240 --> 00:48:18,079
caused

1242
00:48:18,079 --> 00:48:21,760
so that's how that set the price point

1243
00:48:21,760 --> 00:48:23,920
it is migration it's not exactly

1244
00:48:23,920 --> 00:48:26,400
technical

1245
00:48:27,280 --> 00:48:30,559
so over the last two years

1246
00:48:30,559 --> 00:48:34,440
for work for many companies

1247
00:48:46,839 --> 00:48:50,000
um additional complaints

1248
00:48:50,000 --> 00:48:51,520
because

1249
00:48:51,520 --> 00:48:53,839
believe it or change in everything

1250
00:48:53,839 --> 00:48:55,280
people would write

1251
00:48:55,280 --> 00:48:56,720
services

1252
00:48:56,720 --> 00:48:59,839
so if you're personally

1253
00:49:00,400 --> 00:49:02,960
what you see

1254
00:49:04,400 --> 00:49:06,480
so that's it yes with everyone going

1255
00:49:06,480 --> 00:49:07,760
remote it has

1256
00:49:07,760 --> 00:49:09,680
created an interesting dynamic for

1257
00:49:09,680 --> 00:49:11,520
especially like ransomware

1258
00:49:11,520 --> 00:49:12,400
uh

1259
00:49:12,400 --> 00:49:14,720
because what we've seen a lot of times

1260
00:49:14,720 --> 00:49:16,960
now is a end user will get compromised

1261
00:49:16,960 --> 00:49:18,079
at home

1262
00:49:18,079 --> 00:49:19,200
some of the things that we've seen is

1263
00:49:19,200 --> 00:49:20,400
they've got compromised through their

1264
00:49:20,400 --> 00:49:22,880
personal accounts that pivoted then into

1265
00:49:22,880 --> 00:49:25,200
their work computer that then waited for

1266
00:49:25,200 --> 00:49:27,440
the vpn connection back to work to get

1267
00:49:27,440 --> 00:49:28,319
in

1268
00:49:28,319 --> 00:49:30,079
and once they've done that then they've

1269
00:49:30,079 --> 00:49:33,680
used they'll compromise a system

1270
00:49:33,680 --> 00:49:35,520
inside and then they'll use that to

1271
00:49:35,520 --> 00:49:37,040
release the ransomware they don't

1272
00:49:37,040 --> 00:49:39,040
generally will do that from

1273
00:49:39,040 --> 00:49:41,359
okay just keep going

1274
00:49:41,359 --> 00:49:43,040
uh they won't they generally won't try

1275
00:49:43,040 --> 00:49:44,960
to release the ransomware through the

1276
00:49:44,960 --> 00:49:46,800
remote server

1277
00:49:46,800 --> 00:49:49,200
uh just because it's the network

1278
00:49:49,200 --> 00:49:50,720
connection the latency is too long

1279
00:49:50,720 --> 00:49:55,480
they're not encrypting fast enough yeah

1280
00:49:56,319 --> 00:49:59,640
as far as

1281
00:50:12,640 --> 00:50:13,839
so a lot of times when we're getting

1282
00:50:13,839 --> 00:50:15,520
back to it uh we don't get to that

1283
00:50:15,520 --> 00:50:17,200
detail uh we might find that it was

1284
00:50:17,200 --> 00:50:18,640
initially

1285
00:50:18,640 --> 00:50:20,480
uh there was a come in the way i

1286
00:50:20,480 --> 00:50:21,520
discussed

1287
00:50:21,520 --> 00:50:23,040
but we don't

1288
00:50:23,040 --> 00:50:25,359
a lot of the attacks are still um we can

1289
00:50:25,359 --> 00:50:26,880
trace them back to internal so we don't

1290
00:50:26,880 --> 00:50:30,000
get as far as saying okay this came from

1291
00:50:30,000 --> 00:50:31,839
a remote system even though we do check

1292
00:50:31,839 --> 00:50:34,078
that

1293
00:50:34,880 --> 00:50:36,880
yeah for payment for ransomware they

1294
00:50:36,880 --> 00:50:40,839
ever let people into a national

1295
00:50:44,220 --> 00:50:49,470
[Laughter]

1296
00:50:52,319 --> 00:50:54,079
same i want to say same difficulty

1297
00:50:54,079 --> 00:50:57,359
harder to infect more documents

1298
00:50:57,359 --> 00:50:59,760
because normally the environment itself

1299
00:50:59,760 --> 00:51:01,760
you're going to get a single computer

1300
00:51:01,760 --> 00:51:04,240
rather than a file share

1301
00:51:04,240 --> 00:51:06,960
so if they can get onto a vital

1302
00:51:06,960 --> 00:51:10,000
system but then a lot of times you'll

1303
00:51:10,000 --> 00:51:12,240
have more backups with your providers

1304
00:51:12,240 --> 00:51:13,920
so you you're able to say okay well

1305
00:51:13,920 --> 00:51:16,559
let's just go to last hour last week

1306
00:51:16,559 --> 00:51:18,880
last month we might lose some data but

1307
00:51:18,880 --> 00:51:22,520
we're not paying the ransom

1308
00:51:23,280 --> 00:51:25,440
yes

1309
00:51:25,440 --> 00:51:27,520
have you guys ran into any issues when

1310
00:51:27,520 --> 00:51:28,800
um

1311
00:51:28,800 --> 00:51:30,160
you're working with a client that's

1312
00:51:30,160 --> 00:51:32,160
trying to that's kind of hit that wall

1313
00:51:32,160 --> 00:51:34,800
of we've got to pay because

1314
00:51:34,800 --> 00:51:37,359
it's that bad have you ran into any

1315
00:51:37,359 --> 00:51:38,960
issues where

1316
00:51:38,960 --> 00:51:41,200
you're finding that it's that challenge

1317
00:51:41,200 --> 00:51:42,559
of

1318
00:51:42,559 --> 00:51:44,880
us government says well

1319
00:51:44,880 --> 00:51:49,040
do not pay if the actors are part of xyz

1320
00:51:49,040 --> 00:51:51,520
nation state but the

1321
00:51:51,520 --> 00:51:54,000
grand if we know attribution is very

1322
00:51:54,000 --> 00:51:56,160
hard nine times out of ten you're not

1323
00:51:56,160 --> 00:51:57,280
going to know

1324
00:51:57,280 --> 00:52:00,240
what that who it's attributed to

1325
00:52:00,240 --> 00:52:02,559
before you get to that point or even

1326
00:52:02,559 --> 00:52:04,800
when you're at that so our stance on it

1327
00:52:04,800 --> 00:52:06,240
we never tell

1328
00:52:06,240 --> 00:52:08,640
a client to pay or not to pay

1329
00:52:08,640 --> 00:52:10,640
that comes a business decision on their

1330
00:52:10,640 --> 00:52:12,559
part

1331
00:52:12,559 --> 00:52:13,920
we will walk them through if they do

1332
00:52:13,920 --> 00:52:15,359
decide to pay

1333
00:52:15,359 --> 00:52:17,359
steps they'll need to do to safely bring

1334
00:52:17,359 --> 00:52:19,440
things back up

1335
00:52:19,440 --> 00:52:21,359
as far as you don't run the decryption

1336
00:52:21,359 --> 00:52:23,200
software on your network

1337
00:52:23,200 --> 00:52:26,240
you might just reinfect yourself

1338
00:52:26,240 --> 00:52:28,079
you basically you need to rebuild your

1339
00:52:28,079 --> 00:52:30,880
environment a lot of cases

1340
00:52:30,880 --> 00:52:33,119
as far as

1341
00:52:33,119 --> 00:52:34,800
when we discuss with them and say okay

1342
00:52:34,800 --> 00:52:35,839
is it

1343
00:52:35,839 --> 00:52:37,839
us says you're not allowed to pay

1344
00:52:37,839 --> 00:52:39,680
this country

1345
00:52:39,680 --> 00:52:42,160
we will tell them that if we know if i

1346
00:52:42,160 --> 00:52:43,599
mean if we have that information we will

1347
00:52:43,599 --> 00:52:44,720
share it to them saying you're not

1348
00:52:44,720 --> 00:52:46,720
supposed to do this

1349
00:52:46,720 --> 00:52:48,640
um

1350
00:52:48,640 --> 00:52:50,319
in the case of a company where they're

1351
00:52:50,319 --> 00:52:51,760
going to go under

1352
00:52:51,760 --> 00:52:54,559
unless they do it a lot of times

1353
00:52:54,559 --> 00:52:56,480
we like don't tell us

1354
00:52:56,480 --> 00:53:00,480
do what you need to do it's not our call

1355
00:53:00,480 --> 00:53:02,160
sometimes they'll do it sometimes well

1356
00:53:02,160 --> 00:53:03,920
most of times if it's that dire they'll

1357
00:53:03,920 --> 00:53:05,440
do it

1358
00:53:05,440 --> 00:53:07,599
um a lot of times we'll push them not

1359
00:53:07,599 --> 00:53:10,800
push them we'll uh

1360
00:53:10,800 --> 00:53:15,200
suggest they get in contact with a uh

1361
00:53:16,000 --> 00:53:18,079
wow head's drawing a blank somebody to

1362
00:53:18,079 --> 00:53:20,079
negotiate for them sure

1363
00:53:20,079 --> 00:53:21,839
and then they will come back going yes

1364
00:53:21,839 --> 00:53:25,599
this group we cannot negotiate with

1365
00:53:25,920 --> 00:53:26,880
so

1366
00:53:26,880 --> 00:53:28,240
and then on the other side notice we

1367
00:53:28,240 --> 00:53:30,720
also bring legal in

1368
00:53:30,720 --> 00:53:32,800
if they have almost as soon as we get on

1369
00:53:32,800 --> 00:53:34,319
an incident we say

1370
00:53:34,319 --> 00:53:36,880
involve your

