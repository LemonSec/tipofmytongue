1
00:00:00,030 --> 00:00:04,950
and we are now recording all right hope

2
00:00:04,950 --> 00:00:06,569
everybody enjoyed lunch we've got a

3
00:00:06,569 --> 00:00:09,870
Darryl Hyland who started this group 170

4
00:00:09,870 --> 00:00:12,750
years ago I believe he's got a face made

5
00:00:12,750 --> 00:00:16,590
for podcast and his moustache launched

6
00:00:16,590 --> 00:00:19,800
the hipster revolution so he apologizes

7
00:00:19,800 --> 00:00:22,160
for that as we all do

8
00:00:22,160 --> 00:00:24,779
yeah he wasn't at first it's a formal

9
00:00:24,779 --> 00:00:27,630
term that the boy is cool it's yeah it's

10
00:00:27,630 --> 00:00:29,429
not good but not everybody can get

11
00:00:29,429 --> 00:00:31,650
everything right so we had a lot that -

12
00:00:31,650 --> 00:00:35,489
Darryl that's his one mistake so far but

13
00:00:35,489 --> 00:00:37,579
we are thankful to have him speak and

14
00:00:37,579 --> 00:00:39,960
he's going to do some cool stuff and

15
00:00:39,960 --> 00:00:42,570
talk about some of the changes for Preta

16
00:00:42,570 --> 00:00:44,730
which can be pretty exciting so I'll

17
00:00:44,730 --> 00:00:56,670
turn it over here can you start working

18
00:00:56,670 --> 00:00:57,149
out

19
00:00:57,149 --> 00:00:59,609
I apologize right now the Adrian that

20
00:00:59,609 --> 00:01:01,079
he'll probably not keep that camera on

21
00:01:01,079 --> 00:01:04,438
me because he's recorded me before and I

22
00:01:04,438 --> 00:01:08,010
have a tendency to get very mobile so my

23
00:01:08,010 --> 00:01:12,510
presentation is yeah pray had to create

24
00:01:12,510 --> 00:01:16,350
a suite embedded device hacking for the

25
00:01:16,350 --> 00:01:21,330
masses so I've been really busy lately

26
00:01:21,330 --> 00:01:24,689
to travel and why so there's not a whole

27
00:01:24,689 --> 00:01:28,500
lot of slides in here there's a few

28
00:01:28,500 --> 00:01:31,799
there's not but so what I want to do is

29
00:01:31,799 --> 00:01:34,439
I'm going to talk to you about and I

30
00:01:34,439 --> 00:01:35,970
think most of you are probably aware of

31
00:01:35,970 --> 00:01:37,320
some of the work I've done over the last

32
00:01:37,320 --> 00:01:38,430
couple of years

33
00:01:38,430 --> 00:01:40,380
specifically with printers everyone

34
00:01:40,380 --> 00:01:42,810
associates me with hacking printers even

35
00:01:42,810 --> 00:01:44,369
though I do other cool things every year

36
00:01:44,369 --> 00:01:46,560
the print everything just doesn't go

37
00:01:46,560 --> 00:01:48,299
away because it's about an attack vector

38
00:01:48,299 --> 00:01:52,049
or pen testers typically you can go into

39
00:01:52,049 --> 00:01:55,950
a company and if it's a large company

40
00:01:55,950 --> 00:01:58,920
let's say a thousand employees or so or

41
00:01:58,920 --> 00:02:02,040
more we have a hit ratio between 40 and

42
00:02:02,040 --> 00:02:05,250
50% that we can extract active drive the

43
00:02:05,250 --> 00:02:05,730
credential

44
00:02:05,730 --> 00:02:08,009
from the printer and gain access and a

45
00:02:08,009 --> 00:02:09,570
foothold into the environments active

46
00:02:09,570 --> 00:02:12,150
directory so we kind of we've been

47
00:02:12,150 --> 00:02:13,680
playing with that for a number of years

48
00:02:13,680 --> 00:02:16,290
I think we started four or five years

49
00:02:16,290 --> 00:02:18,750
ago doing that and back then sex trade

50
00:02:18,750 --> 00:02:21,090
was probably ten maybe fifteen percent

51
00:02:21,090 --> 00:02:23,910
since then it's up to like I said forty

52
00:02:23,910 --> 00:02:28,620
to fifty percent so I work for rapid7 a

53
00:02:28,620 --> 00:02:30,870
little bit history about me I before

54
00:02:30,870 --> 00:02:33,900
that I work for CDW but I'm working for

55
00:02:33,900 --> 00:02:36,420
rapid seven as a pen tester pen testing

56
00:02:36,420 --> 00:02:39,540
team I've been an IT for 20 plus you're

57
00:02:39,540 --> 00:02:41,880
loosely the plus there I'll never change

58
00:02:41,880 --> 00:02:44,880
that number always been plus and yes

59
00:02:44,880 --> 00:02:47,850
I've been shaving my head for thirty

60
00:02:47,850 --> 00:02:51,030
years so I've been shaving my head from

61
00:02:51,030 --> 00:02:52,800
the time I actually had hair on my head

62
00:02:52,800 --> 00:02:56,880
at shave I don't have to quite shave it

63
00:02:56,880 --> 00:02:58,130
as much anymore

64
00:02:58,130 --> 00:03:01,910
it's kind of caught up through attrition

65
00:03:01,910 --> 00:03:04,140
and I've been working as a pen tester

66
00:03:04,140 --> 00:03:05,940
for the last six years so that's kind of

67
00:03:05,940 --> 00:03:07,590
dig into this so what are we gonna talk

68
00:03:07,590 --> 00:03:09,450
about so I'm going to talk a little bit

69
00:03:09,450 --> 00:03:12,060
about prayer we may not even run the

70
00:03:12,060 --> 00:03:13,350
full hour I'm not sure all this would go

71
00:03:13,350 --> 00:03:16,590
really comes down to if you guys start

72
00:03:16,590 --> 00:03:18,900
falling asleep on me or show no interest

73
00:03:18,900 --> 00:03:22,880
I'll just talk quicker so we might eat

74
00:03:22,880 --> 00:03:25,080
so we're talking about parada

75
00:03:25,080 --> 00:03:28,080
using parada be nice to be able to do

76
00:03:28,080 --> 00:03:30,510
live examples here but you know I'm not

77
00:03:30,510 --> 00:03:32,370
going to commit a felony on the final

78
00:03:32,370 --> 00:03:34,470
carbonic on camera so we're not going to

79
00:03:34,470 --> 00:03:37,920
do this live a demo over the tool we'll

80
00:03:37,920 --> 00:03:39,239
play with them too low I'll show you the

81
00:03:39,239 --> 00:03:40,650
functions of the tool and then we'll

82
00:03:40,650 --> 00:03:42,570
move on from there and then we'll talk

83
00:03:42,570 --> 00:03:44,459
real quick about Metasploit what we're

84
00:03:44,459 --> 00:03:46,620
doing with Fredo in what we're going to

85
00:03:46,620 --> 00:03:50,100
move prey to to next then when we talk

86
00:03:50,100 --> 00:03:52,080
about migrating credit over Metasploit

87
00:03:52,080 --> 00:03:54,030
and then we're going to finish up with

88
00:03:54,030 --> 00:03:57,090
future of prey this point how we're

89
00:03:57,090 --> 00:03:59,010
going to interact hopefully we haven't

90
00:03:59,010 --> 00:04:01,500
done it yet is still in the design stage

91
00:04:01,500 --> 00:04:06,600
of the new parada the data meta device

92
00:04:06,600 --> 00:04:09,630
harvesting data tool how's it going to

93
00:04:09,630 --> 00:04:14,299
interact with Metasploit yes

94
00:04:18,450 --> 00:04:21,070
that's my personal project

95
00:04:21,070 --> 00:04:24,010
so that doesn't change this is something

96
00:04:24,010 --> 00:04:25,900
I developed four years ago and I've

97
00:04:25,900 --> 00:04:28,030
continued to support it and will

98
00:04:28,030 --> 00:04:29,350
continue to support it all the way

99
00:04:29,350 --> 00:04:32,230
through until well until the new version

100
00:04:32,230 --> 00:04:34,090
comes out which will we're going to move

101
00:04:34,090 --> 00:04:36,630
some of the functionality over to

102
00:04:36,630 --> 00:04:39,190
Metasploit and we'll explain why we're

103
00:04:39,190 --> 00:04:41,050
going to do that and it makes a lot of

104
00:04:41,050 --> 00:04:43,480
sense so let's go ahead and move from

105
00:04:43,480 --> 00:04:45,520
there to the next side okay so it looks

106
00:04:45,520 --> 00:04:47,230
like we're talking about parada yeah I

107
00:04:47,230 --> 00:04:49,270
was like three hours sleep last night

108
00:04:49,270 --> 00:04:51,250
and I kind of finished organized and

109
00:04:51,250 --> 00:04:53,470
slide so I'm never quite sure what's

110
00:04:53,470 --> 00:04:56,020
gonna show up on me hopefully nothing is

111
00:04:56,020 --> 00:05:00,040
going to give you trouble so so what

112
00:05:00,040 --> 00:05:03,940
does parada create I pray that is the

113
00:05:03,940 --> 00:05:06,220
name of my tool I developed four years

114
00:05:06,220 --> 00:05:10,870
ago it's Latin for plunder thief who

115
00:05:10,870 --> 00:05:13,930
need so basically it's the word for

116
00:05:13,930 --> 00:05:17,590
robbing somebody freaking born so the

117
00:05:17,590 --> 00:05:21,160
current version is written in Perl and

118
00:05:21,160 --> 00:05:24,280
let's look like level set this whole

119
00:05:24,280 --> 00:05:28,570
thing I am NOT a programmer okay so so

120
00:05:28,570 --> 00:05:30,820
writing this whole program and it

121
00:05:30,820 --> 00:05:32,380
progressed quite a bit over the years

122
00:05:32,380 --> 00:05:35,200
and gotten fairly advanced was not

123
00:05:35,200 --> 00:05:37,540
necessarily easy for me I'm not fast

124
00:05:37,540 --> 00:05:41,860
I'm not proficient but I am stubborn so

125
00:05:41,860 --> 00:05:44,200
I can normally get things working and

126
00:05:44,200 --> 00:05:46,000
when they don't work right I can usually

127
00:05:46,000 --> 00:05:48,670
figure out how to fix them if you set

128
00:05:48,670 --> 00:05:51,280
down and said Daryl right now write me a

129
00:05:51,280 --> 00:05:55,090
program in Perl that will print hello

130
00:05:55,090 --> 00:05:57,820
world to the screen I would give you a

131
00:05:57,820 --> 00:06:02,320
look of total befuddlement okay and then

132
00:06:02,320 --> 00:06:05,890
I'll jump on Google and figure it out so

133
00:06:05,890 --> 00:06:08,230
that's my programming skills and I'm

134
00:06:08,230 --> 00:06:11,530
good at it I'm good at Google okay at

135
00:06:11,530 --> 00:06:15,970
least I think I'm okay so current

136
00:06:15,970 --> 00:06:17,540
version

137
00:06:17,540 --> 00:06:20,910
pray that will actually enumerate about

138
00:06:20,910 --> 00:06:25,110
103 different devices or models so as an

139
00:06:25,110 --> 00:06:26,700
example if we're looking at a Konica

140
00:06:26,700 --> 00:06:28,230
printer as you're a sprinter there's

141
00:06:28,230 --> 00:06:30,540
multiple models so we have various

142
00:06:30,540 --> 00:06:32,970
changes within the application and stuff

143
00:06:32,970 --> 00:06:35,190
little test for Denarius versions and

144
00:06:35,190 --> 00:06:36,480
it'll check for all these and that's

145
00:06:36,480 --> 00:06:37,770
about a hundred and three different

146
00:06:37,770 --> 00:06:40,200
devices and it covers things from

147
00:06:40,200 --> 00:06:44,640
network cameras to multifunction

148
00:06:44,640 --> 00:06:48,240
printers to switches a lot of balanced

149
00:06:48,240 --> 00:06:51,930
service modems I mean there's all kinds

150
00:06:51,930 --> 00:06:54,090
of things we look at let the tool will

151
00:06:54,090 --> 00:06:56,550
harvest it will harvest Active Directory

152
00:06:56,550 --> 00:06:59,250
credentials it will harvest user names

153
00:06:59,250 --> 00:07:02,990
it will harvest SNMP community streams

154
00:07:02,990 --> 00:07:06,320
in somewhere rare cases that'll actually

155
00:07:06,320 --> 00:07:09,090
kick off the scan bed on a printer

156
00:07:09,090 --> 00:07:11,070
especially the smaller ones that we find

157
00:07:11,070 --> 00:07:13,500
in offices like the office you know the

158
00:07:13,500 --> 00:07:16,650
cheap crap $150 off his jets that

159
00:07:16,650 --> 00:07:19,170
everyone buys for their homes why spying

160
00:07:19,170 --> 00:07:21,090
companies buying those and executives

161
00:07:21,090 --> 00:07:22,380
picking them in their office so they

162
00:07:22,380 --> 00:07:24,660
keep printing scanning do all this stuff

163
00:07:24,660 --> 00:07:26,760
they don't have to get up and walk 30

164
00:07:26,760 --> 00:07:28,710
feet to a freaking prayer okay so

165
00:07:28,710 --> 00:07:30,870
they're lazy they're also lazy leaving

166
00:07:30,870 --> 00:07:33,180
stuff sitting on the skinheads so I'm

167
00:07:33,180 --> 00:07:35,180
pilot even if the printer is secure

168
00:07:35,180 --> 00:07:37,290
tradeable actually on a number of these

169
00:07:37,290 --> 00:07:39,630
Officejet trigger despite of the

170
00:07:39,630 --> 00:07:42,330
security the scan bed automatically and

171
00:07:42,330 --> 00:07:45,300
sydney was setting on the scan bed so i

172
00:07:45,300 --> 00:07:46,800
threw that in there purely it's just

173
00:07:46,800 --> 00:07:49,770
something fun and evil to do it rarely

174
00:07:49,770 --> 00:07:51,900
adds much value during pen testing other

175
00:07:51,900 --> 00:07:54,510
than make fun of somebody that they put

176
00:07:54,510 --> 00:07:56,010
their you know their paycheck or

177
00:07:56,010 --> 00:07:57,960
something on their let their driver's

178
00:07:57,960 --> 00:08:00,300
license in one of the cool demos is I

179
00:08:00,300 --> 00:08:03,960
actually did we prayed up in Norway a

180
00:08:03,960 --> 00:08:05,490
number of years ago I was thinking okay

181
00:08:05,490 --> 00:08:07,530
I want to do it with the tools somehow

182
00:08:07,530 --> 00:08:10,200
but I don't have access to ten twelve

183
00:08:10,200 --> 00:08:12,630
thousand dollar printers to do this so I

184
00:08:12,630 --> 00:08:15,510
set my office jet up home and put it on

185
00:08:15,510 --> 00:08:18,030
the Internet and I was thinking what can

186
00:08:18,030 --> 00:08:19,920
I show them that would get your

187
00:08:19,920 --> 00:08:21,930
attention I'm thinking I don't think

188
00:08:21,930 --> 00:08:23,730
they'll get disciplined do it anyway so

189
00:08:23,730 --> 00:08:25,380
I actually put president

190
00:08:25,380 --> 00:08:29,340
first on my scan bed and then attacked

191
00:08:29,340 --> 00:08:32,309
it from Norway it was actually and I'm

192
00:08:32,309 --> 00:08:33,780
waiting to see what's happened because

193
00:08:33,780 --> 00:08:35,190
when you're in foreign countries and

194
00:08:35,190 --> 00:08:37,049
speaking you don't know the culture or

195
00:08:37,049 --> 00:08:39,330
even if they fit he gets believe it or

196
00:08:39,330 --> 00:08:40,979
not they actually got that so that was

197
00:08:40,979 --> 00:08:43,979
somewhat energy I think I one time at a

198
00:08:43,979 --> 00:08:46,340
conference I dummied up the conference

199
00:08:46,340 --> 00:08:49,050
the guy who was running the conference

200
00:08:49,050 --> 00:08:52,770
and was the emcee I do meet up a credit

201
00:08:52,770 --> 00:08:54,720
card his credit card

202
00:08:54,720 --> 00:08:56,430
the fake number and everything and put

203
00:08:56,430 --> 00:08:59,610
it on the scan bed that's running shows

204
00:08:59,610 --> 00:09:01,830
up on the screen so that's one of the

205
00:09:01,830 --> 00:09:03,240
ways I've Taemin with this tool so

206
00:09:03,240 --> 00:09:04,860
there's all kinds of functions and

207
00:09:04,860 --> 00:09:06,480
features and we'll look at some of these

208
00:09:06,480 --> 00:09:08,130
and we're going to look at some of the

209
00:09:08,130 --> 00:09:10,800
outputs of these and the way we

210
00:09:10,800 --> 00:09:26,370
fingerprint with Priya anyone have a

211
00:09:26,370 --> 00:09:31,530
couple triple-a batteries along surprise

212
00:09:31,530 --> 00:09:34,790
these will light up the entire screen

213
00:09:34,790 --> 00:09:37,170
absorb some of this it's getting

214
00:09:37,170 --> 00:09:38,700
brighter to see heats up it gets

215
00:09:38,700 --> 00:09:41,370
brighter so when the fingerprint devices

216
00:09:41,370 --> 00:09:42,600
there are several key pieces of

217
00:09:42,600 --> 00:09:43,170
information

218
00:09:43,170 --> 00:09:46,590
so what prey that does is it numerate

219
00:09:46,590 --> 00:09:48,150
several things that queries the web

220
00:09:48,150 --> 00:09:50,580
interface on devices because we all know

221
00:09:50,580 --> 00:10:00,780
where we should all know that all the

222
00:10:00,780 --> 00:10:04,320
devices in the world all devices in the

223
00:10:04,320 --> 00:10:05,100
world

224
00:10:05,100 --> 00:10:08,370
and web servers I don't know if you

225
00:10:08,370 --> 00:10:10,320
think this but I really don't think that

226
00:10:10,320 --> 00:10:14,700
was a really brilliant idea but it makes

227
00:10:14,700 --> 00:10:17,100
my job fairly easy so this tool will

228
00:10:17,100 --> 00:10:18,720
actually quarry the web interface and

229
00:10:18,720 --> 00:10:20,130
what it looks for is two pieces of

230
00:10:20,130 --> 00:10:22,050
information the title page of the server

231
00:10:22,050 --> 00:10:26,340
type we find out probably about 75% of

232
00:10:26,340 --> 00:10:29,550
all occurrences the data returned helps

233
00:10:29,550 --> 00:10:31,440
us fingerprint the device down to

234
00:10:31,440 --> 00:10:33,810
sometimes all the way down to a model

235
00:10:33,810 --> 00:10:36,420
number we identify that the web server

236
00:10:36,420 --> 00:10:39,280
the title page is two pieces in from

237
00:10:39,280 --> 00:10:41,620
and were able to quickly see hey this is

238
00:10:41,620 --> 00:10:46,060
this is a Cisco device this is a you

239
00:10:46,060 --> 00:10:53,320
know period of my brother so this is you

240
00:10:53,320 --> 00:10:55,540
know a Xerox printer it happens to be a

241
00:10:55,540 --> 00:10:58,780
work sintra 5640 if we can get a lot

242
00:10:58,780 --> 00:11:01,120
kind of detail about 75% of the time

243
00:11:01,120 --> 00:11:03,580
through that then we also found out for

244
00:11:03,580 --> 00:11:08,680
most devices mainly printers SNMP now of

245
00:11:08,680 --> 00:11:10,480
course SNMP we know does enable and

246
00:11:10,480 --> 00:11:11,800
every frequency on the face the earth

247
00:11:11,800 --> 00:11:15,550
right along with web stuff so the SNP

248
00:11:15,550 --> 00:11:18,700
stuff we found out for fingerprinting

249
00:11:18,700 --> 00:11:22,270
devices comes in handy on printers

250
00:11:22,270 --> 00:11:24,310
especially because printers SNMP has

251
00:11:24,310 --> 00:11:26,740
been being able you're not going to

252
00:11:26,740 --> 00:11:28,150
change it so you're not going to change

253
00:11:28,150 --> 00:11:31,390
the public community string because what

254
00:11:31,390 --> 00:11:33,640
happens if you do basically the

255
00:11:33,640 --> 00:11:35,890
functionality of the printer breaks so

256
00:11:35,890 --> 00:11:37,480
your printer driver can no longer tell

257
00:11:37,480 --> 00:11:39,580
whether the printer paper of egg all

258
00:11:39,580 --> 00:11:41,560
those fun things so that's never going

259
00:11:41,560 --> 00:11:42,100
to change

260
00:11:42,100 --> 00:11:44,830
now the SMTP across other devices we

261
00:11:44,830 --> 00:11:47,230
gather that also if public or private is

262
00:11:47,230 --> 00:11:49,240
actually able mainly public I think is a

263
00:11:49,240 --> 00:11:52,240
little check for but in a lot of cases I

264
00:11:52,240 --> 00:11:54,910
wanted it has changed so we have a lot

265
00:11:54,910 --> 00:11:57,430
of tach modules in there they'll hit the

266
00:11:57,430 --> 00:12:00,220
interface identify the device and then

267
00:12:00,220 --> 00:12:01,900
what it'll do is it'll log on to the

268
00:12:01,900 --> 00:12:04,000
device go to the configuration page for

269
00:12:04,000 --> 00:12:06,850
SNMP and pull those communities we can

270
00:12:06,850 --> 00:12:08,470
typically take those community strings

271
00:12:08,470 --> 00:12:11,110
back into the network and attack other

272
00:12:11,110 --> 00:12:13,180
devices of the network an example the

273
00:12:13,180 --> 00:12:16,480
attack would be we find a company that

274
00:12:16,480 --> 00:12:20,200
is very big on using SNMP to enable all

275
00:12:20,200 --> 00:12:22,150
the places of m'angil devices on their

276
00:12:22,150 --> 00:12:27,460
network turns out that they even put all

277
00:12:27,460 --> 00:12:29,110
their cameras we have a couple of

278
00:12:29,110 --> 00:12:30,670
promises this during assessment i've

279
00:12:30,670 --> 00:12:32,440
done so they have been able destined to

280
00:12:32,440 --> 00:12:33,820
be on their camera so they can manage

281
00:12:33,820 --> 00:12:35,620
older cameras but one thing they fail to

282
00:12:35,620 --> 00:12:37,030
do is change the default

283
00:12:37,030 --> 00:12:39,430
birds will need to network cameras we

284
00:12:39,430 --> 00:12:41,350
always seem to find one or two on every

285
00:12:41,350 --> 00:12:44,020
large environment so we can log on to

286
00:12:44,020 --> 00:12:46,690
the camera go to the SNMP page

287
00:12:46,690 --> 00:12:49,210
pull the SNP configurations out of the

288
00:12:49,210 --> 00:12:51,490
configs on the page turn around and

289
00:12:51,490 --> 00:12:53,110
replay those against all the Cisco

290
00:12:53,110 --> 00:12:54,730
devices because they made you said the

291
00:12:54,730 --> 00:12:56,620
same as in community streams on their

292
00:12:56,620 --> 00:12:59,110
wireless cameras as they did on the

293
00:12:59,110 --> 00:13:01,420
routers switches and firewalls and now

294
00:13:01,420 --> 00:13:03,100
we can pull the running configs off

295
00:13:03,100 --> 00:13:04,900
their wireless switches and firewalls

296
00:13:04,900 --> 00:13:06,760
you get that type of data so that's kind

297
00:13:06,760 --> 00:13:09,940
of the LTAC factor there so I wasn't

298
00:13:09,940 --> 00:13:10,930
going through this if you have any

299
00:13:10,930 --> 00:13:13,000
questions in the input don't hesitate to

300
00:13:13,000 --> 00:13:18,610
you know throw it in there what's that

301
00:13:18,610 --> 00:13:25,500
help I every company I've never seen

302
00:13:25,500 --> 00:13:28,270
I've never been indifferent now that we

303
00:13:28,270 --> 00:13:29,790
differ between the public and private

304
00:13:29,790 --> 00:13:32,530
but I have yet to find a case where

305
00:13:32,530 --> 00:13:35,170
they're set differently normally when I

306
00:13:35,170 --> 00:13:37,660
find as I said down the customer go okay

307
00:13:37,660 --> 00:13:40,390
SNMP school you need to use great

308
00:13:40,390 --> 00:13:43,120
management tool but set security levels

309
00:13:43,120 --> 00:13:45,520
a Cisco router is that it's just

310
00:13:45,520 --> 00:13:48,190
different security level than an IP

311
00:13:48,190 --> 00:13:50,830
camera okay you need to take that into

312
00:13:50,830 --> 00:13:53,350
consideration that's like hiring an

313
00:13:53,350 --> 00:13:56,560
employee and his first day you go Bob

314
00:13:56,560 --> 00:13:58,750
here's your username oh yeah and here's

315
00:13:58,750 --> 00:14:01,300
your password and that same password is

316
00:14:01,300 --> 00:14:02,860
the same password you use for all the

317
00:14:02,860 --> 00:14:05,200
domain admins the company it's that same

318
00:14:05,200 --> 00:14:07,150
philosophy you wouldn't do that you

319
00:14:07,150 --> 00:14:09,460
shouldn't do that with your recipe for

320
00:14:09,460 --> 00:14:11,020
public private communication area should

321
00:14:11,020 --> 00:14:15,520
be considered just like passwords so

322
00:14:15,520 --> 00:14:18,610
Preta from a structural standpoint has

323
00:14:18,610 --> 00:14:21,970
three key pieces it has a name

324
00:14:21,970 --> 00:14:25,180
dispatcher program what that dispatcher

325
00:14:25,180 --> 00:14:28,270
program does it takes input the input

326
00:14:28,270 --> 00:14:31,630
you can feed into it is a cider you know

327
00:14:31,630 --> 00:14:34,120
like a 192 once they say da zero Doug

328
00:14:34,120 --> 00:14:37,180
0/24 and it will actually crawl that you

329
00:14:37,180 --> 00:14:39,580
do that and for like 40 80 or for two or

330
00:14:39,580 --> 00:14:42,930
three you can also feed into it a a

331
00:14:42,930 --> 00:14:45,050
national target list

332
00:14:45,050 --> 00:14:47,029
phylla contains all your IPS that you

333
00:14:47,029 --> 00:14:49,580
want to check feed that into it or you

334
00:14:49,580 --> 00:14:51,769
can feed the outputs and in map into it

335
00:14:51,769 --> 00:14:54,680
so you run an nmap and you get a GM map

336
00:14:54,680 --> 00:14:56,870
output you can put that straight into

337
00:14:56,870 --> 00:14:59,420
parada it'll do it by all the devices

338
00:14:59,420 --> 00:15:02,290
all of the ports that have certain HTTP

339
00:15:02,290 --> 00:15:05,480
HTTPS enabled and what it does is it

340
00:15:05,480 --> 00:15:08,709
goes through and does the fingerprinting

341
00:15:08,709 --> 00:15:11,930
the title page the server type in the

342
00:15:11,930 --> 00:15:15,740
SNMP and if it has a match within the

343
00:15:15,740 --> 00:15:17,899
target list database or the data bot

344
00:15:17,899 --> 00:15:20,810
list that it has it has a match for that

345
00:15:20,810 --> 00:15:23,269
particular device it will go ahead and

346
00:15:23,269 --> 00:15:25,339
will call individual modules so we try

347
00:15:25,339 --> 00:15:27,410
to structure this thing like a framework

348
00:15:27,410 --> 00:15:29,350
so you can write different modules and

349
00:15:29,350 --> 00:15:31,490
there's a number of reason why I did

350
00:15:31,490 --> 00:15:33,620
that I hate have a program that has all

351
00:15:33,620 --> 00:15:35,209
this different data and it's all in one

352
00:15:35,209 --> 00:15:37,130
big program because it's not manageable

353
00:15:37,130 --> 00:15:40,040
this way it's easy this main body of the

354
00:15:40,040 --> 00:15:42,019
program never changes you have a data

355
00:15:42,019 --> 00:15:44,600
file that you just add a single string

356
00:15:44,600 --> 00:15:47,390
to it it contains the name of the device

357
00:15:47,390 --> 00:15:49,970
and fader print data and the module that

358
00:15:49,970 --> 00:15:51,860
needs to be run if it has it hit on it

359
00:15:51,860 --> 00:15:54,079
and then it will call that Roger when it

360
00:15:54,079 --> 00:15:56,000
finds it it'll run it it will output the

361
00:15:56,000 --> 00:15:58,640
data until five now this is an ongoing

362
00:15:58,640 --> 00:16:00,890
project I've been doing it for years

363
00:16:00,890 --> 00:16:03,980
and what I've managed to do in four

364
00:16:03,980 --> 00:16:06,940
years is never tell you it's not a paid

365
00:16:06,940 --> 00:16:09,620
since I suck at programming this is a

366
00:16:09,620 --> 00:16:11,930
beta program so we're always looking for

367
00:16:11,930 --> 00:16:16,160
ways to improve it it's getting close

368
00:16:16,160 --> 00:16:20,180
and close to these people so that that's

369
00:16:20,180 --> 00:16:25,459
how that particularly works okay and

370
00:16:25,459 --> 00:16:27,230
that they recover that scans network

371
00:16:27,230 --> 00:16:29,449
embedded systems so we scan our network

372
00:16:29,449 --> 00:16:32,300
if you do that by I like using a gene in

373
00:16:32,300 --> 00:16:34,220
that enjoy so goes through all these

374
00:16:34,220 --> 00:16:36,350
different devices if it gets a hit on a

375
00:16:36,350 --> 00:16:38,540
device it fires up a separate module to

376
00:16:38,540 --> 00:16:41,980
runs the data out puts it into a file

377
00:16:41,980 --> 00:16:44,089
and all those is based on the

378
00:16:44,089 --> 00:16:46,339
fingerprinting the input data and of

379
00:16:46,339 --> 00:16:48,370
course it said it logs all records

380
00:16:48,370 --> 00:16:53,930
so how we use this okay this is kind of

381
00:16:53,930 --> 00:16:55,880
interesting so when I first wrote is

382
00:16:55,880 --> 00:16:58,339
told started started using it

383
00:16:58,339 --> 00:17:00,529
it was last totally wrong the last day

384
00:17:00,529 --> 00:17:03,499
of the engagement before he left because

385
00:17:03,499 --> 00:17:05,510
everyone's going yeah you know what kind

386
00:17:05,510 --> 00:17:07,459
of day we have our panel of our own

387
00:17:07,459 --> 00:17:09,020
methods for compromising all the

388
00:17:09,020 --> 00:17:12,380
services on the network excuse me so we

389
00:17:12,380 --> 00:17:14,150
were slow and getting around using the

390
00:17:14,150 --> 00:17:16,880
tool initially I show up at a company

391
00:17:16,880 --> 00:17:20,029
site and this is where it all changed so

392
00:17:20,029 --> 00:17:22,490
it turned out that every workstation on

393
00:17:22,490 --> 00:17:24,500
the network the administrator account

394
00:17:24,500 --> 00:17:27,919
was disabled or was not network

395
00:17:27,919 --> 00:17:31,190
accessible ok so if I did compromise am

396
00:17:31,190 --> 00:17:32,870
admin account wasn't going to work to

397
00:17:32,870 --> 00:17:35,750
get anything else it also turned out

398
00:17:35,750 --> 00:17:37,549
that the password was different every

399
00:17:37,549 --> 00:17:40,279
server in their environment so if I

400
00:17:40,279 --> 00:17:42,470
compromised a single server which we did

401
00:17:42,470 --> 00:17:44,240
the compromised machine here machine

402
00:17:44,240 --> 00:17:45,890
there we weren't able to get any kind of

403
00:17:45,890 --> 00:17:49,010
crazy girl anywhere else so that didn't

404
00:17:49,010 --> 00:17:52,159
work they also had some network

405
00:17:52,159 --> 00:17:53,990
segmentation that could really play that

406
00:17:53,990 --> 00:17:56,289
this was because some other isolated

407
00:17:56,289 --> 00:17:58,929
systems that were used to control

408
00:17:58,929 --> 00:18:02,539
plumbing and stuff through the city so

409
00:18:02,539 --> 00:18:04,940
I'm on this four-day engagement on day

410
00:18:04,940 --> 00:18:08,120
three I've broken into 30 machines and I

411
00:18:08,120 --> 00:18:10,820
I'm not go maenad I don't own everything

412
00:18:10,820 --> 00:18:13,820
in the world so I get down the last day

413
00:18:13,820 --> 00:18:19,970
I run this program it finds a printer it

414
00:18:19,970 --> 00:18:23,299
extracts the data and guess what that

415
00:18:23,299 --> 00:18:25,279
one account they set up and that device

416
00:18:25,279 --> 00:18:28,640
was a domain admin account so if I'd ran

417
00:18:28,640 --> 00:18:30,500
this day one it basically had everything

418
00:18:30,500 --> 00:18:32,360
to start with and then the rest of the

419
00:18:32,360 --> 00:18:34,340
time would have been play time instead

420
00:18:34,340 --> 00:18:36,620
of panic to try to elevate myself in the

421
00:18:36,620 --> 00:18:39,230
environment we've been fairly quick so

422
00:18:39,230 --> 00:18:40,880
after that we started running this is

423
00:18:40,880 --> 00:18:42,770
the first tool soon as I get an in that

424
00:18:42,770 --> 00:18:44,960
gun G and then output I feed it into

425
00:18:44,960 --> 00:18:46,850
this tool and I let it run why go off

426
00:18:46,850 --> 00:18:49,820
and do other Hakman I ran an engagement

427
00:18:49,820 --> 00:18:54,679
this last week I managed to pull user

428
00:18:54,679 --> 00:18:56,149
name and passwords for Active Directory

429
00:18:56,149 --> 00:18:58,820
even though I by the time this was done

430
00:18:58,820 --> 00:19:00,710
running I'd already compromised somebody

431
00:19:00,710 --> 00:19:03,770
and done much other easels that wasn't

432
00:19:03,770 --> 00:19:06,620
the deal but yet we're hitting forty to

433
00:19:06,620 --> 00:19:11,730
fifty percent so it's kind of amazing

434
00:19:11,730 --> 00:19:14,100
was sitting out there for the taking in

435
00:19:14,100 --> 00:19:16,770
this tool generally doesn't use a lot of

436
00:19:16,770 --> 00:19:19,320
experts it uses the functionality of the

437
00:19:19,320 --> 00:19:21,840
environment by using the functionality

438
00:19:21,840 --> 00:19:24,720
of the environment we're able to fly

439
00:19:24,720 --> 00:19:27,930
underneath the radar screen IDS's an IPS

440
00:19:27,930 --> 00:19:29,910
solutions and stuff like that so it's

441
00:19:29,910 --> 00:19:33,120
it's pretty impactful you know the

442
00:19:33,120 --> 00:19:34,770
customers never going to notice because

443
00:19:34,770 --> 00:19:36,390
we're doing normal stuff

444
00:19:36,390 --> 00:19:38,370
and we're getting credentials that we

445
00:19:38,370 --> 00:19:41,880
turn around and use like normal users to

446
00:19:41,880 --> 00:19:44,010
use that data to gain access to other

447
00:19:44,010 --> 00:19:46,830
critical systems in the environment and

448
00:19:46,830 --> 00:19:50,130
Dave Kennedy had mentioned earlier you

449
00:19:50,130 --> 00:19:51,900
know about that type of thing

450
00:19:51,900 --> 00:19:53,550
you know it's one thing throwing an

451
00:19:53,550 --> 00:19:55,500
exploit but he's talking about using the

452
00:19:55,500 --> 00:19:58,020
normal functionality of the systems of

453
00:19:58,020 --> 00:20:00,810
the devices of the programs and that's

454
00:20:00,810 --> 00:20:04,020
basically how this works so then we

455
00:20:04,020 --> 00:20:05,550
always get challenged and always like to

456
00:20:05,550 --> 00:20:06,900
throw this in here especially when we're

457
00:20:06,900 --> 00:20:09,360
dealing with multifunction printers so

458
00:20:09,360 --> 00:20:11,160
how many people in here that work for a

459
00:20:11,160 --> 00:20:13,260
company that their first rule before any

460
00:20:13,260 --> 00:20:15,000
printers deployed under their network

461
00:20:15,000 --> 00:20:17,190
that they are forced to change the

462
00:20:17,190 --> 00:20:19,350
default passwords and something complex

463
00:20:19,350 --> 00:20:23,250
before it's ever actually deployed so we

464
00:20:23,250 --> 00:20:25,800
have we have two in here so when did you

465
00:20:25,800 --> 00:20:31,080
start doing it and you probably see my

466
00:20:31,080 --> 00:20:35,460
presentation but people are not doing

467
00:20:35,460 --> 00:20:38,450
that so passwords are rarely an issue

468
00:20:38,450 --> 00:20:42,060
dealing with multifunction printers now

469
00:20:42,060 --> 00:20:45,090
other embedded devices yeah we see more

470
00:20:45,090 --> 00:20:47,430
of those actually configured but if

471
00:20:47,430 --> 00:20:48,960
there's a number of them configured

472
00:20:48,960 --> 00:20:51,360
other than I think you know routers and

473
00:20:51,360 --> 00:20:53,340
switches most companies are above

474
00:20:53,340 --> 00:20:56,100
deploying those default creds but mostly

475
00:20:56,100 --> 00:20:58,520
the other embedded devices they may have

476
00:20:58,520 --> 00:21:01,110
you know fifty or a hundred of them on

477
00:21:01,110 --> 00:21:04,170
the network like IP camera inevitably

478
00:21:04,170 --> 00:21:06,150
there's always one or two where the

479
00:21:06,150 --> 00:21:08,580
default craves are still there which

480
00:21:08,580 --> 00:21:10,710
gives you football same way with things

481
00:21:10,710 --> 00:21:14,130
like Liebherr and APC power control

482
00:21:14,130 --> 00:21:16,620
systems or the management cards that go

483
00:21:16,620 --> 00:21:19,170
with ABC management cars inevitably

484
00:21:19,170 --> 00:21:21,730
there's always at least one or two

485
00:21:21,730 --> 00:21:24,340
properly configured and again we get

486
00:21:24,340 --> 00:21:26,350
back to the SNMP thing if they're heavy

487
00:21:26,350 --> 00:21:29,530
SNMP shop that one or two misconfigured

488
00:21:29,530 --> 00:21:31,570
cards is going to give me access to be

489
00:21:31,570 --> 00:21:34,120
able to pull those estimate P streams in

490
00:21:34,120 --> 00:21:35,890
the hardware environment and gain access

491
00:21:35,890 --> 00:21:38,350
to various other devices on their

492
00:21:38,350 --> 00:21:53,980
network any questions okay okay so let's

493
00:21:53,980 --> 00:21:55,510
let's look at this stuff let's see if

494
00:21:55,510 --> 00:21:58,260
this works okay

495
00:22:27,670 --> 00:22:31,540
and we'll see that okay see that in the

496
00:22:31,540 --> 00:22:48,429
back so you have three era and just to

497
00:22:48,429 --> 00:22:50,830
look at some of the information on the

498
00:22:50,830 --> 00:22:52,600
thing like I said there was three key

499
00:22:52,600 --> 00:22:55,059
pieces there's the dispatcher which

500
00:22:55,059 --> 00:23:02,679
turns out to be the Prieta dot pl pretty

501
00:23:02,679 --> 00:23:05,230
straightforward there we also have the

502
00:23:05,230 --> 00:23:07,090
data file what's in data folder and we

503
00:23:07,090 --> 00:23:10,690
have a jobs file so let's jump over here

504
00:23:10,690 --> 00:23:14,230
and look at the data file this is kind

505
00:23:14,230 --> 00:23:17,140
of like the fingerprinting list it's

506
00:23:17,140 --> 00:23:19,059
fairly straightforward so it starts off

507
00:23:19,059 --> 00:23:22,059
the first pipe to lemonade is what I

508
00:23:22,059 --> 00:23:24,160
used is just a numbering system it means

509
00:23:24,160 --> 00:23:26,890
nothing you can write each in there

510
00:23:26,890 --> 00:23:30,610
there works fine so that's just for me

511
00:23:30,610 --> 00:23:32,169
to keep track of what I've actually put

512
00:23:32,169 --> 00:23:35,770
in there and then we get into the title

513
00:23:35,770 --> 00:23:39,280
page in this case it's HP LaserJet CP 0

514
00:23:39,280 --> 00:23:42,910
5 and then we get the server type so we

515
00:23:42,910 --> 00:23:44,500
get that fingerprint it's going to call

516
00:23:44,500 --> 00:23:48,700
job MP 0 0 0 1 pretty straightforward so

517
00:23:48,700 --> 00:23:50,559
we come down through here we see a

518
00:23:50,559 --> 00:23:53,020
number of different devices a lot of

519
00:23:53,020 --> 00:23:56,140
these do weird things this phase are one

520
00:23:56,140 --> 00:23:57,760
of us some testing we were doing it

521
00:23:57,760 --> 00:23:59,500
actually pulls the clone file off a

522
00:23:59,500 --> 00:24:02,410
phaser crash and if you've seen any of

523
00:24:02,410 --> 00:24:04,500
my other presentations there's ways to

524
00:24:04,500 --> 00:24:07,210
extract data out of those that may be

525
00:24:07,210 --> 00:24:10,660
usable we have the Toshiba

526
00:24:10,660 --> 00:24:13,980
devices right here Toshiba and this is a

527
00:24:13,980 --> 00:24:17,830
as you can see it looks for top access

528
00:24:17,830 --> 00:24:20,500
and Toshiba tech Corp which is going to

529
00:24:20,500 --> 00:24:24,940
cover almost all models so some of these

530
00:24:24,940 --> 00:24:28,419
fingerprints are ambiguous and that can

531
00:24:28,419 --> 00:24:30,730
be a problem at times because they may

532
00:24:30,730 --> 00:24:32,530
have the same fingerprint that you may

533
00:24:32,530 --> 00:24:36,040
see some some sub models being produced

534
00:24:36,040 --> 00:24:37,750
when we identify some of those sub

535
00:24:37,750 --> 00:24:38,290
models

536
00:24:38,290 --> 00:24:40,450
the attack doesn't work sometimes will

537
00:24:40,450 --> 00:24:43,600
convert to use an SNMP for the

538
00:24:43,600 --> 00:24:46,020
fingerprinting specifically on printers

539
00:24:46,020 --> 00:24:48,580
and we have a number of Xerox to do

540
00:24:48,580 --> 00:24:50,890
various different things pull address

541
00:24:50,890 --> 00:24:55,000
books here is some Officejet devices

542
00:24:55,000 --> 00:24:57,730
that will actually trigger the actual

543
00:24:57,730 --> 00:25:02,670
remote pay or the scan on the system

544
00:25:23,310 --> 00:25:32,070
that with the riko's rico's and there's

545
00:25:32,070 --> 00:25:34,690
the rico's i know our manufacturing

546
00:25:34,690 --> 00:25:37,150
there's like three or four weird name

547
00:25:37,150 --> 00:25:39,610
companies that i've seen out there that

548
00:25:39,610 --> 00:25:41,620
are duplicates of the reco they just

549
00:25:41,620 --> 00:25:43,330
remade they you know they redo the

550
00:25:43,330 --> 00:25:45,490
splash pages on the web interface and

551
00:25:45,490 --> 00:25:47,830
they put their own decals on the front

552
00:25:47,830 --> 00:25:49,840
of it but yeah there's your scenes some

553
00:25:49,840 --> 00:25:52,740
of that take place now I don't know of

554
00:25:52,740 --> 00:25:55,780
Xerox is doing that I think Xerox is

555
00:25:55,780 --> 00:25:59,440
still holding tight to their brand and I

556
00:25:59,440 --> 00:26:01,840
think HP stills holding tight to their

557
00:26:01,840 --> 00:26:07,740
brand but I think Konica Toshiba and

558
00:26:07,740 --> 00:26:11,050
rico's you may see some off Brandi

559
00:26:11,050 --> 00:26:15,970
taking place with other vendors so as

560
00:26:15,970 --> 00:26:17,560
you can see we have a number of devices

561
00:26:17,560 --> 00:26:19,270
here here's a candid image runner

562
00:26:19,270 --> 00:26:21,670
advanced versions and you can see the

563
00:26:21,670 --> 00:26:23,560
different modules we have set up a run

564
00:26:23,560 --> 00:26:25,810
here's some cannons where we have

565
00:26:25,810 --> 00:26:27,640
multiple modules that are actually run

566
00:26:27,640 --> 00:26:30,360
that do different things

567
00:26:31,710 --> 00:26:34,780
yeah these this is the fingerprinting

568
00:26:34,780 --> 00:26:36,580
table this is the table where the

569
00:26:36,580 --> 00:26:39,220
comparisons made so this data is pulled

570
00:26:39,220 --> 00:26:42,460
into the main dispatcher program so when

571
00:26:42,460 --> 00:26:44,410
to going out and hits the IP address he

572
00:26:44,410 --> 00:26:46,510
gets that data back the title page and

573
00:26:46,510 --> 00:26:47,720
server and compare

574
00:26:47,720 --> 00:26:50,330
to this list and if it gets a match it

575
00:26:50,330 --> 00:26:52,700
runs those programs at the end you know

576
00:26:52,700 --> 00:26:55,610
for us here in and I like an option

577
00:26:55,610 --> 00:26:57,559
where it's like oh hey this is a Canon

578
00:26:57,559 --> 00:27:00,640
IR 30-45 you have these three options

579
00:27:00,640 --> 00:27:02,750
it'll go right through all those three

580
00:27:02,750 --> 00:27:04,880
to run so up here we see the can and I

581
00:27:04,880 --> 00:27:06,770
are these are the older image runners

582
00:27:06,770 --> 00:27:09,590
and I've written multiple modules for

583
00:27:09,590 --> 00:27:11,510
those because I want each module to do a

584
00:27:11,510 --> 00:27:12,980
different function I don't want to write

585
00:27:12,980 --> 00:27:15,650
a module that did everything because if

586
00:27:15,650 --> 00:27:17,120
they changed something within their

587
00:27:17,120 --> 00:27:18,980
environments and a firmware upgrade and

588
00:27:18,980 --> 00:27:20,780
they changed the way of doing one thing

589
00:27:20,780 --> 00:27:23,270
I don't want all three of my modules to

590
00:27:23,270 --> 00:27:25,549
break I'd rather have one of them break

591
00:27:25,549 --> 00:27:27,140
and then we identify it we're able to

592
00:27:27,140 --> 00:27:29,240
fix one module we don't have to fix a

593
00:27:29,240 --> 00:27:31,280
program that's crammed full all kinds of

594
00:27:31,280 --> 00:27:33,710
crap that's confusing so if you look at

595
00:27:33,710 --> 00:27:35,000
the modules which I'll show you in a

596
00:27:35,000 --> 00:27:37,030
minute most of them are fairly simple

597
00:27:37,030 --> 00:27:39,470
anyone here could reproduce them

598
00:27:39,470 --> 00:27:41,299
themselves you can look through the

599
00:27:41,299 --> 00:27:42,950
modules and if you have a printer that

600
00:27:42,950 --> 00:27:45,049
when you go to the web interface and you

601
00:27:45,049 --> 00:27:46,309
can drill down through it and get

602
00:27:46,309 --> 00:27:48,380
everything you can easily take some of

603
00:27:48,380 --> 00:27:49,730
these modules that I'll show you here in

604
00:27:49,730 --> 00:27:52,309
a minute and basically cut paste add

605
00:27:52,309 --> 00:27:54,020
your own pieces in them because they're

606
00:27:54,020 --> 00:27:57,110
all annotated they all make sense and I

607
00:27:57,110 --> 00:27:58,159
don't care if you're not a permanent

608
00:27:58,159 --> 00:28:01,220
it's that easy to figure out because it

609
00:28:01,220 --> 00:28:02,600
was wrote by somebody who's not a

610
00:28:02,600 --> 00:28:06,530
programmer so you'll get a lot of people

611
00:28:06,530 --> 00:28:09,250
griping try and keep my language decent

612
00:28:09,250 --> 00:28:11,720
you get a lot of people griping about

613
00:28:11,720 --> 00:28:15,650
Perl programmers so any Perl programmer

614
00:28:15,650 --> 00:28:17,210
that looks at anything you've written yo

615
00:28:17,210 --> 00:28:18,980
you know I could write that in one line

616
00:28:18,980 --> 00:28:21,890
of code kick him in the ass because

617
00:28:21,890 --> 00:28:22,940
these are going to write one line of

618
00:28:22,940 --> 00:28:24,919
code no one's going to understand six

619
00:28:24,919 --> 00:28:26,600
months down the road and I hate people

620
00:28:26,600 --> 00:28:30,530
to do that for programming especially in

621
00:28:30,530 --> 00:28:32,559
these descriptive languages need to be

622
00:28:32,559 --> 00:28:35,690
descriptive they don't need to be

623
00:28:35,690 --> 00:28:37,340
compressed because the amount of speed

624
00:28:37,340 --> 00:28:38,900
you're gonna get by doing compressed

625
00:28:38,900 --> 00:28:41,690
code in Perl is it in my opinion gonna

626
00:28:41,690 --> 00:28:44,059
be significant enough to outweigh the

627
00:28:44,059 --> 00:28:45,230
fact that no one's going to know what

628
00:28:45,230 --> 00:28:46,520
the hell you did six months down the

629
00:28:46,520 --> 00:28:53,270
road so that's my pitch of people so

630
00:28:53,270 --> 00:28:55,220
then we get in so now up here we had

631
00:28:55,220 --> 00:28:56,809
these ones that started with P these are

632
00:28:56,809 --> 00:28:59,240
all printers and then we get into these

633
00:28:59,240 --> 00:29:01,760
lower modules a number of these will

634
00:29:01,760 --> 00:29:04,580
just check for default creds like

635
00:29:04,580 --> 00:29:09,440
riverbed seller on devices easy server

636
00:29:09,440 --> 00:29:10,850
some of these I'm not even sure what the

637
00:29:10,850 --> 00:29:13,640
hell they are but they're various

638
00:29:13,640 --> 00:29:15,230
devices we've encountered that are

639
00:29:15,230 --> 00:29:17,480
embedded devices and we go hey let's we

640
00:29:17,480 --> 00:29:18,950
got time that's right a quick module

641
00:29:18,950 --> 00:29:20,390
while we're on engagement in case we see

642
00:29:20,390 --> 00:29:22,789
these again it'll automatically tell us

643
00:29:22,789 --> 00:29:24,530
of default creds are there because when

644
00:29:24,530 --> 00:29:26,539
you're on engagement a large one where

645
00:29:26,539 --> 00:29:28,399
you end up with a thousand devices

646
00:29:28,399 --> 00:29:30,890
embedded devices on the network to go in

647
00:29:30,890 --> 00:29:33,140
and check the default creds with every

648
00:29:33,140 --> 00:29:35,299
device becomes inherently difficult and

649
00:29:35,299 --> 00:29:37,460
of course you want to share with the

650
00:29:37,460 --> 00:29:39,169
customer any kind of security risks that

651
00:29:39,169 --> 00:29:42,710
may exist so the goal here is when we do

652
00:29:42,710 --> 00:29:44,510
find devices we'll be able to identify

653
00:29:44,510 --> 00:29:46,730
since we can't physically look at every

654
00:29:46,730 --> 00:29:47,330
device

655
00:29:47,330 --> 00:29:49,820
let's try through time to start

656
00:29:49,820 --> 00:29:52,610
automating as much of it as we can for

657
00:29:52,610 --> 00:29:57,860
testing that so we have a large number

658
00:29:57,860 --> 00:30:01,100
of different devices here and these ones

659
00:30:01,100 --> 00:30:04,669
at the bottom are stuff that me and Matt

660
00:30:04,669 --> 00:30:08,120
is in the back we're working on I don't

661
00:30:08,120 --> 00:30:10,659
know if you've seen the work we did

662
00:30:10,659 --> 00:30:12,770
hopefully I get a speaking of a lot of

663
00:30:12,770 --> 00:30:14,750
Derby con and people go we'll get to see

664
00:30:14,750 --> 00:30:19,720
it but we'll save that for another time

665
00:30:19,720 --> 00:30:22,429
let's jump out of here any questions

666
00:30:22,429 --> 00:30:25,039
about that file there so let's jump over

667
00:30:25,039 --> 00:30:28,159
and look at the job files real quick of

668
00:30:28,159 --> 00:30:33,280
course it's a perl script which is yes

669
00:30:36,730 --> 00:30:39,530
you know I actually it was kind of funny

670
00:30:39,530 --> 00:30:41,720
I had two guys working with me bitching

671
00:30:41,720 --> 00:30:47,240
about about that problem and it was kind

672
00:30:47,240 --> 00:30:48,559
of weird so I do have a program to

673
00:30:48,559 --> 00:30:51,940
automate that but I never did release it

674
00:30:51,940 --> 00:30:54,350
the one thing was that they were

675
00:30:54,350 --> 00:30:56,720
grabbing about as I tell them look your

676
00:30:56,720 --> 00:30:58,399
own engagement generating modules when

677
00:30:58,399 --> 00:31:00,080
you find a device that has people

678
00:31:00,080 --> 00:31:02,899
credit write a module for default craps

679
00:31:02,899 --> 00:31:05,390
we can add other functionality to it

680
00:31:05,390 --> 00:31:11,750
later so typically this is manually

681
00:31:11,750 --> 00:31:14,000
generated that's how I do it but I did

682
00:31:14,000 --> 00:31:17,799
actually write a program that basically

683
00:31:17,799 --> 00:31:21,250
all you have to do is type in the page

684
00:31:21,250 --> 00:31:24,289
of the server you know main blah blah

685
00:31:24,289 --> 00:31:25,010
one page

686
00:31:25,010 --> 00:31:27,320
yes put in the value of what they're

687
00:31:27,320 --> 00:31:29,809
signing username to put in the value of

688
00:31:29,809 --> 00:31:31,700
what you call the password and then put

689
00:31:31,700 --> 00:31:34,549
in a new name and password and run the

690
00:31:34,549 --> 00:31:36,980
program it would in the IP of the device

691
00:31:36,980 --> 00:31:38,779
it will fingerprints the device grab

692
00:31:38,779 --> 00:31:40,700
that data and it will generate that

693
00:31:40,700 --> 00:31:42,679
entire string and write a fully

694
00:31:42,679 --> 00:31:45,470
functional module to do everything so

695
00:31:45,470 --> 00:31:48,350
basically so I wrote it curls for the

696
00:31:48,350 --> 00:31:50,389
script that would do that and I could

697
00:31:50,389 --> 00:32:00,740
get them to use that either so yeah yeah

698
00:32:00,740 --> 00:32:02,899
default password you know be nice to

699
00:32:02,899 --> 00:32:05,539
actually keep it a default password list

700
00:32:05,539 --> 00:32:08,179
it's so difficult because I'd love to be

701
00:32:08,179 --> 00:32:09,350
able to do that I'd love to have them

702
00:32:09,350 --> 00:32:11,179
all memorized I have like half the most

703
00:32:11,179 --> 00:32:14,929
the printers memorized by now but yeah

704
00:32:14,929 --> 00:32:16,820
the white is awesome plus it saves you

705
00:32:16,820 --> 00:32:19,370
from having to go look at every device

706
00:32:19,370 --> 00:32:21,830
on the network if you don't have time

707
00:32:21,830 --> 00:32:24,380
I've literally been on the sites where

708
00:32:24,380 --> 00:32:27,590
they had 10,000 systems and in 3 to

709
00:32:27,590 --> 00:32:29,389
4,000 of those were printers embedded

710
00:32:29,389 --> 00:32:33,710
devices so in engagements they're time

711
00:32:33,710 --> 00:32:35,690
consuming you're short period of time to

712
00:32:35,690 --> 00:32:38,389
actually do the work so you don't always

713
00:32:38,389 --> 00:32:40,880
get a chance to do this but my my goal

714
00:32:40,880 --> 00:32:42,799
has been when I do have time are always

715
00:32:42,799 --> 00:32:45,350
generate some kind of module so so we're

716
00:32:45,350 --> 00:32:47,059
looking at these modules here and let's

717
00:32:47,059 --> 00:32:55,240
look at let me just bring one of them up

718
00:33:00,700 --> 00:33:03,909
I'm not sure

719
00:33:07,680 --> 00:33:13,890
here has to be a Minolta and most of it

720
00:33:13,890 --> 00:33:16,290
is just generic data a lot of the core

721
00:33:16,290 --> 00:33:19,620
stuff is brought in from the primary

722
00:33:19,620 --> 00:33:21,330
program so you don't have to do a lot of

723
00:33:21,330 --> 00:33:23,520
things all of these things here never

724
00:33:23,520 --> 00:33:26,540
change so this is just cut and paste

725
00:33:26,540 --> 00:33:28,980
type of stuff anytime you want to do

726
00:33:28,980 --> 00:33:29,640
anything

727
00:33:29,640 --> 00:33:32,100
same way with that that's just output

728
00:33:32,100 --> 00:33:33,870
for logging information that what you're

729
00:33:33,870 --> 00:33:36,150
looking for and then the first thing you

730
00:33:36,150 --> 00:33:38,250
do here is we were actually validating

731
00:33:38,250 --> 00:33:40,710
model types so what it does is it

732
00:33:40,710 --> 00:33:42,810
basically pulls the primary piece of

733
00:33:42,810 --> 00:33:44,310
data off the device which is the

734
00:33:44,310 --> 00:33:45,960
fingerprinting says hey it's this model

735
00:33:45,960 --> 00:33:50,070
or that model we set a basic session

736
00:33:50,070 --> 00:33:53,010
cookie storage information because it's

737
00:33:53,010 --> 00:33:54,450
gonna need a cookie as it moves through

738
00:33:54,450 --> 00:33:57,870
the program pretty straightforward we

739
00:33:57,870 --> 00:34:00,030
enable redirecting I have some printers

740
00:34:00,030 --> 00:34:01,530
that just had like real issues with

741
00:34:01,530 --> 00:34:03,330
redirecting type stuff so that's kind of

742
00:34:03,330 --> 00:34:06,600
a redirecting for the post operation and

743
00:34:06,600 --> 00:34:09,239
then we actually do a post so here we're

744
00:34:09,239 --> 00:34:11,880
actually doing a post for the log line

745
00:34:11,880 --> 00:34:14,730
and it's going to call the password that

746
00:34:14,730 --> 00:34:16,739
password field which is and this is one

747
00:34:16,739 --> 00:34:18,780
of the more complex moppet here's the

748
00:34:18,780 --> 00:34:20,850
where the passwords are set for the two

749
00:34:20,850 --> 00:34:26,969
different type of models and I know

750
00:34:26,969 --> 00:34:30,090
looking at codes boring yeah I heard

751
00:34:30,090 --> 00:34:31,800
that and I think I'm trying to make a

752
00:34:31,800 --> 00:34:32,730
point here

753
00:34:32,730 --> 00:34:35,820
that's code here that guy's not gonna

754
00:34:35,820 --> 00:34:37,380
run it and run my program or anything

755
00:34:37,380 --> 00:34:42,389
anyways so feel free get some sleep and

756
00:34:42,389 --> 00:34:44,719
then what this does is it actually

757
00:34:44,719 --> 00:34:49,560
parses LDAP settings on the device so

758
00:34:49,560 --> 00:34:51,389
this here is probably one of the most

759
00:34:51,389 --> 00:34:54,510
complex ones so what this thing does

760
00:34:54,510 --> 00:34:56,580
this program here and you look at it

761
00:34:56,580 --> 00:34:58,430
it's simple all we're doing is

762
00:34:58,430 --> 00:35:00,450
reproducing what you would do from a

763
00:35:00,450 --> 00:35:04,590
keyboard in Perl your login process your

764
00:35:04,590 --> 00:35:07,680
post your guess we're taking the output

765
00:35:07,680 --> 00:35:09,750
for parts of it we're putting in a

766
00:35:09,750 --> 00:35:12,270
pretty straightforward every structure

767
00:35:12,270 --> 00:35:15,030
and every one of these Perl programs is

768
00:35:15,030 --> 00:35:18,240
annotated okay it tells you what the

769
00:35:18,240 --> 00:35:21,260
next block does this is one of

770
00:35:21,260 --> 00:35:23,660
your comp well not one complex one we

771
00:35:23,660 --> 00:35:26,900
have some very complex ones that do soap

772
00:35:26,900 --> 00:35:30,560
message attacks we have one what I have

773
00:35:30,560 --> 00:35:32,510
a cool interior is like really cool so

774
00:35:32,510 --> 00:35:34,550
anyone ever see my firmware attack work

775
00:35:34,550 --> 00:35:37,580
that I did in Xerox so one of the big

776
00:35:37,580 --> 00:35:40,670
things is there's ways to reproduce a

777
00:35:40,670 --> 00:35:44,350
Xeroxes firmware process using firmware

778
00:35:44,350 --> 00:35:46,580
Xeroxes and the tools it is pulling

779
00:35:46,580 --> 00:35:48,620
cruise ship and actually getting a

780
00:35:48,620 --> 00:35:51,650
reverse shell device privileges really

781
00:35:51,650 --> 00:35:53,690
cymbals trivial I wrote a paper with us

782
00:35:53,690 --> 00:35:55,730
out there but one of the things we ran

783
00:35:55,730 --> 00:35:58,010
into is what happens if I hit a Xerox

784
00:35:58,010 --> 00:36:02,290
printer so much changed the password

785
00:36:03,760 --> 00:36:06,770
more attack to the thing and all you do

786
00:36:06,770 --> 00:36:09,860
to send this job to the port 9100

787
00:36:09,860 --> 00:36:11,210
there's not a pending case so we

788
00:36:11,210 --> 00:36:13,520
actually have a module in here that what

789
00:36:13,520 --> 00:36:16,670
it does is it is it is actually a

790
00:36:16,670 --> 00:36:19,970
firmware bootstrap program that sent the

791
00:36:19,970 --> 00:36:22,910
port 90 101 port 91 and when it

792
00:36:22,910 --> 00:36:26,000
processes the data it executes a shell

793
00:36:26,000 --> 00:36:28,280
script on the system it goes to a

794
00:36:28,280 --> 00:36:30,860
specific admin config file which is the

795
00:36:30,860 --> 00:36:32,810
only thing when the device is not

796
00:36:32,810 --> 00:36:35,150
encrypted only password and that's the

797
00:36:35,150 --> 00:36:37,550
console password it pulls the set

798
00:36:37,550 --> 00:36:39,500
password out writes to the root of the

799
00:36:39,500 --> 00:36:42,740
web server in a file called traded up

800
00:36:42,740 --> 00:36:45,620
txt then the program retrieves it and

801
00:36:45,620 --> 00:36:47,480
then Sons another firmware attack for

802
00:36:47,480 --> 00:36:49,300
the device to actually delete the file

803
00:36:49,300 --> 00:36:53,060
so and the reason why we have to go

804
00:36:53,060 --> 00:36:54,680
through all those steps is we don't have

805
00:36:54,680 --> 00:36:57,290
control of the IP address if we can't

806
00:36:57,290 --> 00:36:59,360
write into the firmware package the IP

807
00:36:59,360 --> 00:37:01,190
address were coming from dynamically

808
00:37:01,190 --> 00:37:03,140
because it has to be signed with

809
00:37:03,140 --> 00:37:05,270
proprietary information so I had to pre

810
00:37:05,270 --> 00:37:07,310
build it so it was easy enough to pre

811
00:37:07,310 --> 00:37:10,730
build the injection attack so that it's

812
00:37:10,730 --> 00:37:13,160
actually just writes the file so and

813
00:37:13,160 --> 00:37:15,860
we're locally that's retrieval through

814
00:37:15,860 --> 00:37:27,230
the web interface so I think does anyone

815
00:37:27,230 --> 00:37:28,790
have any questions about

816
00:37:28,790 --> 00:37:32,420
pretas structure and how it basically

817
00:37:32,420 --> 00:37:34,790
out works

818
00:37:34,790 --> 00:37:40,010
anyone confused I'm actually going to

819
00:37:40,010 --> 00:37:41,540
present part of this stuff because I'm

820
00:37:41,540 --> 00:37:44,990
actually speaking at blackhat Arsenal at

821
00:37:44,990 --> 00:37:47,660
blackhat and talking about Pereda so

822
00:37:47,660 --> 00:37:49,660
some of this stuff I'm bouncing off you

823
00:37:49,660 --> 00:37:52,070
so it's important to get feedback so if

824
00:37:52,070 --> 00:37:54,290
you go there ah you just confuse the

825
00:37:54,290 --> 00:37:58,359
hell out of me I do not hurt my feelings

826
00:38:02,619 --> 00:38:05,480
yeah and when you run the tool I mean

827
00:38:05,480 --> 00:38:09,380
it's a freighter pearl so there's a

828
00:38:09,380 --> 00:38:12,050
command structure it's basically three

829
00:38:12,050 --> 00:38:13,760
to four pieces of information you put in

830
00:38:13,760 --> 00:38:16,580
from the command line straight forward

831
00:38:16,580 --> 00:38:18,740
and what it does is it outputs let's go

832
00:38:18,740 --> 00:38:21,109
ahead in this case here let's say we we

833
00:38:21,109 --> 00:38:23,660
did a GM map file containing data we

834
00:38:23,660 --> 00:38:25,820
said the project would be sample on and

835
00:38:25,820 --> 00:38:29,570
the output log file with me let's go to

836
00:38:29,570 --> 00:38:35,510
sample what I wrote in there so the

837
00:38:35,510 --> 00:38:37,790
output would be group 1 so to create two

838
00:38:37,790 --> 00:38:39,859
files one's called group on that blog

839
00:38:39,859 --> 00:38:42,920
one's called group 1 web host now this

840
00:38:42,920 --> 00:38:45,160
should be clean data and if it's not

841
00:38:45,160 --> 00:38:49,970
everyone close their eyes it's not that

842
00:38:49,970 --> 00:38:53,960
would be stable so these are the two

843
00:38:53,960 --> 00:38:56,660
things that are output I just type in

844
00:38:56,660 --> 00:38:59,090
well yeah I typed in well okay so this

845
00:38:59,090 --> 00:39:03,380
is actually a real output from like only

846
00:39:03,380 --> 00:39:07,970
a few days ago from an assessment and as

847
00:39:07,970 --> 00:39:10,580
you see we actually just got our hands 1

848
00:39:10,580 --> 00:39:13,580
an SNMP community stream from an APC

849
00:39:13,580 --> 00:39:17,540
device that this particular one we

850
00:39:17,540 --> 00:39:20,480
worked on all the other APC devices in

851
00:39:20,480 --> 00:39:23,030
their case they weren't using SNMP in

852
00:39:23,030 --> 00:39:26,540
their cisco department and this was so

853
00:39:26,540 --> 00:39:30,130
but and this was the only APC device

854
00:39:30,130 --> 00:39:33,650
that was did not have the password set

855
00:39:33,650 --> 00:39:35,210
properly so it was what is the password

856
00:39:35,210 --> 00:39:40,820
for an APC device default password for a

857
00:39:40,820 --> 00:39:44,210
closed APC APC there you go now everyone

858
00:39:44,210 --> 00:39:45,580
knows it's pretty simple straightforward

859
00:39:45,580 --> 00:39:48,920
kind of like UPS's from them yeah yeah

860
00:39:48,920 --> 00:39:50,810
that liebherr liebherr is another victim

861
00:39:50,810 --> 00:39:52,700
people just leave it leave it yet leave

862
00:39:52,700 --> 00:39:54,590
early runs the same way ABC ABC it's

863
00:39:54,590 --> 00:39:56,270
pretty straightforward with both of us

864
00:39:56,270 --> 00:39:57,980
in community strings off over they've

865
00:39:57,980 --> 00:40:00,020
configured so I love these devices

866
00:40:00,020 --> 00:40:03,710
because there's always one and of course

867
00:40:03,710 --> 00:40:06,440
here we have cameras Falcon serious

868
00:40:06,440 --> 00:40:09,109
camera devices and it turned out that

869
00:40:09,109 --> 00:40:11,990
half of their devices had no community

870
00:40:11,990 --> 00:40:13,550
string set as you can see we try to

871
00:40:13,550 --> 00:40:14,960
strip the community string off of the

872
00:40:14,960 --> 00:40:17,420
second side okay so that didn't really

873
00:40:17,420 --> 00:40:20,240
work but we were able to identify all

874
00:40:20,240 --> 00:40:22,400
the devices that had default creds and

875
00:40:22,400 --> 00:40:24,500
I've been working on cleaning this up so

876
00:40:24,500 --> 00:40:26,270
I mean this stuff doesn't look easily

877
00:40:26,270 --> 00:40:28,220
possible but if you just grab this file

878
00:40:28,220 --> 00:40:31,400
for the word success you'll get all the

879
00:40:31,400 --> 00:40:34,100
permanent data typically don't get the

880
00:40:34,100 --> 00:40:35,540
public thing so I'm trying to clean up

881
00:40:35,540 --> 00:40:36,859
some of the output it's been taking me a

882
00:40:36,859 --> 00:40:38,720
while so that it's quickly possible

883
00:40:38,720 --> 00:40:40,369
because one of my biggest complaints is

884
00:40:40,369 --> 00:40:42,170
a lot of cool tools out there if you go

885
00:40:42,170 --> 00:40:44,390
into like colleague and look at all the

886
00:40:44,390 --> 00:40:46,250
tools that people were written almost

887
00:40:46,250 --> 00:40:48,770
the outputs from 90% of Tao tools and

888
00:40:48,770 --> 00:40:50,900
colleague worthless for parsing so if I

889
00:40:50,900 --> 00:40:52,760
use the tool against one system I'm fine

890
00:40:52,760 --> 00:40:54,680
but if I use the tool against 10,000

891
00:40:54,680 --> 00:40:56,240
systems I'm screwed there's no way I can

892
00:40:56,240 --> 00:40:58,430
parse any of it to usable I have to

893
00:40:58,430 --> 00:41:00,890
write my own parsers which is my biggest

894
00:41:00,890 --> 00:41:02,300
complaint so they usually just get

895
00:41:02,300 --> 00:41:04,040
pissed off and rewrite the whole program

896
00:41:04,040 --> 00:41:14,090
myself so as you can see here we've got

897
00:41:14,090 --> 00:41:17,800
all these devices so then we get down to

898
00:41:20,350 --> 00:41:23,090
does it had me dependencies besides just

899
00:41:23,090 --> 00:41:24,710
having Perl of a system

900
00:41:24,710 --> 00:41:26,150
well there's I'll show the perl

901
00:41:26,150 --> 00:41:29,740
dependencies yeah there are some Perl

902
00:41:38,109 --> 00:41:40,460
some reason I got parsed out of there

903
00:41:40,460 --> 00:41:44,030
but as you can see attempted a password

904
00:41:44,030 --> 00:41:46,040
extract this particular module carries

905
00:41:46,040 --> 00:41:49,570
out an attack what's known as a a

906
00:41:49,570 --> 00:41:53,240
capture LDAP as a pass back attack so

907
00:41:53,240 --> 00:41:56,930
what it does is for some reason I remove

908
00:41:56,930 --> 00:41:57,519
this

909
00:41:57,519 --> 00:41:59,229
going to change it because it did return

910
00:41:59,229 --> 00:42:01,749
data but the data was proprietary

911
00:42:01,749 --> 00:42:03,819
information would identify the person so

912
00:42:03,819 --> 00:42:05,709
I've cleaned it out and I was gonna put

913
00:42:05,709 --> 00:42:08,289
bogus data in there show you generally

914
00:42:08,289 --> 00:42:10,779
what it would look like because it would

915
00:42:10,779 --> 00:42:12,819
contain some binary garbage in there to

916
00:42:12,819 --> 00:42:16,089
some but basically what it is is an

917
00:42:16,089 --> 00:42:17,829
automated pass back attack because it's

918
00:42:17,829 --> 00:42:20,169
a sharp printers and way to pass back

919
00:42:20,169 --> 00:42:22,869
attack works is it will actually log on

920
00:42:22,869 --> 00:42:25,119
to the printer they'll go to the LDAP

921
00:42:25,119 --> 00:42:27,549
configuration page they will change the

922
00:42:27,549 --> 00:42:31,509
IP address of the LDAP server to point

923
00:42:31,509 --> 00:42:34,089
back to itself it'll next tell the

924
00:42:34,089 --> 00:42:36,669
printer to do an LDAP lookup in

925
00:42:36,669 --> 00:42:37,959
plaintext

926
00:42:37,959 --> 00:42:40,269
capture the password username and

927
00:42:40,269 --> 00:42:42,579
password for health apathetic ation and

928
00:42:42,579 --> 00:42:44,979
then change the password back but the

929
00:42:44,979 --> 00:42:47,169
sharp actually doesn't have to change

930
00:42:47,169 --> 00:42:49,209
the password it it can set the password

931
00:42:49,209 --> 00:42:51,189
without permanently writing it in there

932
00:42:51,189 --> 00:42:53,829
because there's a testament so it kind

933
00:42:53,829 --> 00:42:57,069
of automates kind of like you go to the

934
00:42:57,069 --> 00:42:59,319
printer and say hey you know tell me

935
00:42:59,319 --> 00:43:01,059
what your LDAP settings are and the

936
00:43:01,059 --> 00:43:03,189
reason why this the cool thing about

937
00:43:03,189 --> 00:43:06,359
this whole thing here the reason why

938
00:43:06,359 --> 00:43:09,009
this function is the way it was was

939
00:43:09,009 --> 00:43:11,469
because crap I did four years ago so

940
00:43:11,469 --> 00:43:13,269
four years ago I hit a bunch of the

941
00:43:13,269 --> 00:43:15,609
printer companies with the fact that you

942
00:43:15,609 --> 00:43:17,529
could go to the settings on the page the

943
00:43:17,529 --> 00:43:19,929
LDAP settings on the page and if you

944
00:43:19,929 --> 00:43:21,579
looked at the source you would find the

945
00:43:21,579 --> 00:43:25,389
password story in the web source so I

946
00:43:25,389 --> 00:43:28,359
did this every way a true con and they

947
00:43:28,359 --> 00:43:31,929
were like I you know I pissed off a half

948
00:43:31,929 --> 00:43:35,229
dozen of them and not once they all

949
00:43:35,229 --> 00:43:39,219
changed so now the actual printer or the

950
00:43:39,219 --> 00:43:42,130
password stored on the device no longer

951
00:43:42,130 --> 00:43:45,069
in the source and to change it you have

952
00:43:45,069 --> 00:43:47,049
to check a button before you can even

953
00:43:47,049 --> 00:43:50,009
change the password but they screwed up

954
00:43:50,009 --> 00:43:52,269
everything else in the page can be

955
00:43:52,269 --> 00:43:56,679
changed so now all I have to do alter

956
00:43:56,679 --> 00:43:59,139
the printer to say pay your LDAP servers

957
00:43:59,139 --> 00:44:04,569
not happen anymore it's me it'll be nice

958
00:44:04,569 --> 00:44:06,219
enough to try to authenticate with the

959
00:44:06,219 --> 00:44:09,410
password its torrent in the system

960
00:44:09,410 --> 00:44:11,359
you got to watch that you got to set the

961
00:44:11,359 --> 00:44:13,099
device the plain text is there like

962
00:44:13,099 --> 00:44:16,220
Kerberos and until then anything and SS

963
00:44:16,220 --> 00:44:17,690
at all and just gonna shut those things

964
00:44:17,690 --> 00:44:23,900
off and then go yeah do it to a check of

965
00:44:23,900 --> 00:44:25,460
course the printer come back they failed

966
00:44:25,460 --> 00:44:28,460
it did on all you news barnett cabin you

967
00:44:28,460 --> 00:44:32,299
capture the plain text the shark will

968
00:44:32,299 --> 00:44:35,420
actually show up the username will be

969
00:44:35,420 --> 00:44:37,160
fairly easy to read if you cut and paste

970
00:44:37,160 --> 00:44:38,930
it in the text so get rid of some of the

971
00:44:38,930 --> 00:44:41,059
weird binary but you have to strip the

972
00:44:41,059 --> 00:44:43,819
0b off there's a 0b that shows up in the

973
00:44:43,819 --> 00:44:46,160
closing end of the password and that's

974
00:44:46,160 --> 00:44:50,180
not part of the password like this

975
00:44:50,180 --> 00:44:56,990
presentation okay if the other thing I

976
00:44:56,990 --> 00:45:12,680
want to show is this yeah yeah

977
00:45:12,680 --> 00:45:14,539
unfortunately the web host ones

978
00:45:14,539 --> 00:45:16,190
incorrect so I inadvertently overrode

979
00:45:16,190 --> 00:45:18,589
this stuff and I think this is the one I

980
00:45:18,589 --> 00:45:22,279
cleaned up so you see how the password

981
00:45:22,279 --> 00:45:23,509
shows up there that's how it will

982
00:45:23,509 --> 00:45:25,670
actually show up it may be a little

983
00:45:25,670 --> 00:45:27,470
weird binary at the beginning sometimes

984
00:45:27,470 --> 00:45:29,650
is that 0b of that to be stripped off

985
00:45:29,650 --> 00:45:32,720
the other program that I inadvertently

986
00:45:32,720 --> 00:45:35,089
at 12:00 1:00 o'clock last night

987
00:45:35,089 --> 00:45:37,940
overrode with the wrong file the group

988
00:45:37,940 --> 00:45:40,039
one web host will contain all the

989
00:45:40,039 --> 00:45:42,230
fingerprint data unfortunately this one

990
00:45:42,230 --> 00:45:43,880
doesn't because I invert they overrode

991
00:45:43,880 --> 00:45:45,920
opposed to the reason but it will

992
00:45:45,920 --> 00:45:47,269
contain all that fingerprint data

993
00:45:47,269 --> 00:45:49,759
contain the IP address it will contain

994
00:45:49,759 --> 00:45:52,309
the server type it will contain the

995
00:45:52,309 --> 00:45:55,249
title page and it also contained all the

996
00:45:55,249 --> 00:45:58,759
SNMP data that pulled off twice so even

997
00:45:58,759 --> 00:46:00,230
though you didn't attack a device that

998
00:46:00,230 --> 00:46:02,749
it was the tool for it you can literally

999
00:46:02,749 --> 00:46:05,359
go through and visually look through

1000
00:46:05,359 --> 00:46:08,450
quickly to identify devices that you may

1001
00:46:08,450 --> 00:46:11,390
want to look at as a pen tester I know

1002
00:46:11,390 --> 00:46:12,680
there's tools out there it'll do

1003
00:46:12,680 --> 00:46:15,170
screenshots of like the websites those

1004
00:46:15,170 --> 00:46:16,519
are kind of cool but this is also a

1005
00:46:16,519 --> 00:46:18,310
quick way you are

1006
00:46:18,310 --> 00:46:21,340
do a quick analysis and you can find

1007
00:46:21,340 --> 00:46:23,320
devices you want to look at for further

1008
00:46:23,320 --> 00:46:27,720
and do some other cool stuff with so

1009
00:46:40,830 --> 00:46:43,990
yeah Metasploit so how many people here

1010
00:46:43,990 --> 00:46:47,700
don't know about medicine for years okay

1011
00:46:47,700 --> 00:46:52,960
so Matt's point is a is a Penta is a key

1012
00:46:52,960 --> 00:46:55,210
tool for all pen testers it's basically

1013
00:46:55,210 --> 00:46:58,210
a tool contains ongoing development of

1014
00:46:58,210 --> 00:47:00,760
vulnerability attacks that you can carry

1015
00:47:00,760 --> 00:47:04,150
out to validate whether vulnerabilities

1016
00:47:04,150 --> 00:47:06,430
actually exist or they can be exploited

1017
00:47:06,430 --> 00:47:08,470
or exploited you can use this tool to

1018
00:47:08,470 --> 00:47:10,990
take control of formal systems and do

1019
00:47:10,990 --> 00:47:13,870
various things so this tool is written

1020
00:47:13,870 --> 00:47:17,980
by HT Moore and his guys in 2003 and

1021
00:47:17,980 --> 00:47:21,130
then in 2000 and written Perl and then

1022
00:47:21,130 --> 00:47:23,590
in 2007 they rewrote the whole thing to

1023
00:47:23,590 --> 00:47:26,320
run in Ruby and currently there is

1024
00:47:26,320 --> 00:47:29,050
literally everybody on the face of the

1025
00:47:29,050 --> 00:47:32,110
earth is actually using this tool for

1026
00:47:32,110 --> 00:47:34,860
pen testing almost everybody does

1027
00:47:34,860 --> 00:47:38,680
Metasploit was purchased trying to was

1028
00:47:38,680 --> 00:47:43,390
purchased by rapid7 write work for there

1029
00:47:43,390 --> 00:47:47,110
are still a Metasploit open-source

1030
00:47:47,110 --> 00:47:49,530
version that's continued supported and

1031
00:47:49,530 --> 00:47:52,980
will always be supported the framework

1032
00:47:52,980 --> 00:47:55,870
there is a pro version that is available

1033
00:47:55,870 --> 00:47:58,120
professional version that you instrument

1034
00:47:58,120 --> 00:47:59,770
has a lot of other forms and whistles

1035
00:47:59,770 --> 00:48:03,730
and functionalities and stuff but

1036
00:48:03,730 --> 00:48:06,190
generally they're fairly close to being

1037
00:48:06,190 --> 00:48:07,300
the same thing from the framework

1038
00:48:07,300 --> 00:48:10,870
standpoint so what I am in the process

1039
00:48:10,870 --> 00:48:14,520
of doing is I am going to migrate a

1040
00:48:14,520 --> 00:48:19,480
large portion of prayer the modules over

1041
00:48:19,480 --> 00:48:22,210
to Metasploit there's a number of

1042
00:48:22,210 --> 00:48:23,860
reasons for going with that model

1043
00:48:23,860 --> 00:48:26,380
they're listed here it's easier to

1044
00:48:26,380 --> 00:48:27,400
maintain but

1045
00:48:27,400 --> 00:48:29,170
we're dealing with a project medic

1046
00:48:29,170 --> 00:48:31,359
project which is has a large amount of

1047
00:48:31,359 --> 00:48:35,079
involvement Metasploit can also be used

1048
00:48:35,079 --> 00:48:36,759
to capture data that you pulled the

1049
00:48:36,759 --> 00:48:38,950
advices can be used in other attack

1050
00:48:38,950 --> 00:48:41,799
vectors and scenarios like patchwork

1051
00:48:41,799 --> 00:48:43,059
that you pull the passwords we

1052
00:48:43,059 --> 00:48:44,619
eventually get those passwords in the

1053
00:48:44,619 --> 00:48:46,480
device can be used our baton attacks

1054
00:48:46,480 --> 00:48:48,999
other systems so you have this full

1055
00:48:48,999 --> 00:48:51,220
functionality plus this is the big thing

1056
00:48:51,220 --> 00:48:53,859
large community based Metasploit has

1057
00:48:53,859 --> 00:48:56,619
over 200,000 people that are involved in

1058
00:48:56,619 --> 00:48:59,309
supporting that crimes around the world

1059
00:48:59,309 --> 00:49:02,410
so it gives us the ability probably with

1060
00:49:02,410 --> 00:49:04,420
Creta this is nice

1061
00:49:04,420 --> 00:49:08,249
I wrote almost every one of the modules

1062
00:49:08,249 --> 00:49:10,660
and trying to get people involved in

1063
00:49:10,660 --> 00:49:12,430
that project was very difficult I had a

1064
00:49:12,430 --> 00:49:14,380
couple people throw some help in there

1065
00:49:14,380 --> 00:49:16,660
but generally it's been a small audience

1066
00:49:16,660 --> 00:49:18,759
of people and that's why after four

1067
00:49:18,759 --> 00:49:20,230
years I can only do one hundred so

1068
00:49:20,230 --> 00:49:23,230
devices if I move it over here and start

1069
00:49:23,230 --> 00:49:25,599
down that road getting other people

1070
00:49:25,599 --> 00:49:27,160
involved saying hey there's an attack

1071
00:49:27,160 --> 00:49:29,589
vector that's build from there we can

1072
00:49:29,589 --> 00:49:32,700
bring that amount of functionality up

1073
00:49:32,700 --> 00:49:41,799
significantly any questions so to start

1074
00:49:41,799 --> 00:49:43,779
this project being a co-worker had been

1075
00:49:43,779 --> 00:49:46,749
working on migrating modules over and

1076
00:49:46,749 --> 00:49:50,079
we've done total of seven modules have

1077
00:49:50,079 --> 00:49:53,019
been written so far and these include

1078
00:49:53,019 --> 00:49:55,690
the Xerox help that passed pass back

1079
00:49:55,690 --> 00:49:59,499
module okay also a Konica address

1080
00:49:59,499 --> 00:50:02,559
password extract module can an address

1081
00:50:02,559 --> 00:50:05,950
book extract module and some lehp

1082
00:50:05,950 --> 00:50:08,079
username extract modules who's about

1083
00:50:08,079 --> 00:50:10,480
seven or eight of these the other one is

1084
00:50:10,480 --> 00:50:13,239
not listed up here is the Xerox password

1085
00:50:13,239 --> 00:50:14,710
attack because the firmware attack

1086
00:50:14,710 --> 00:50:15,640
that's been written

1087
00:50:15,640 --> 00:50:18,819
that's available out there are these

1088
00:50:18,819 --> 00:50:22,210
alive they can be pulled down their beta

1089
00:50:22,210 --> 00:50:24,220
right now and at the end I'll show you

1090
00:50:24,220 --> 00:50:26,710
where you can download these from and

1091
00:50:26,710 --> 00:50:28,630
I'll show you how to if you haven't used

1092
00:50:28,630 --> 00:50:30,390
Metasploit or how to put stuff in a

1093
00:50:30,390 --> 00:50:33,100
repository or Metasploit that will get

1094
00:50:33,100 --> 00:50:34,960
written every time the update I'll show

1095
00:50:34,960 --> 00:50:36,280
you how to do that here and if I have

1096
00:50:36,280 --> 00:50:39,100
time let's speed through this so here's

1097
00:50:39,100 --> 00:50:41,350
a couple examples of these these were

1098
00:50:41,350 --> 00:50:44,080
actually tested so here happens to be a

1099
00:50:44,080 --> 00:50:46,720
th one of the HP modules and the goal of

1100
00:50:46,720 --> 00:50:48,340
this one is pull an address books in

1101
00:50:48,340 --> 00:50:50,680
terms of are pulling user names turns

1102
00:50:50,680 --> 00:50:53,170
out a lot of the lower-end printers at

1103
00:50:53,170 --> 00:50:56,710
least lower in color printers support a

1104
00:50:56,710 --> 00:50:58,870
chargeback functionality so they keep

1105
00:50:58,870 --> 00:51:00,640
very detailed color walks for charge

1106
00:51:00,640 --> 00:51:02,530
back this is clean your Active Directory

1107
00:51:02,530 --> 00:51:04,900
user names so if you're in a Windows

1108
00:51:04,900 --> 00:51:06,400
environment be talking use one of these

1109
00:51:06,400 --> 00:51:08,320
printers it's going to actually write

1110
00:51:08,320 --> 00:51:11,650
your username into this wall okay so

1111
00:51:11,650 --> 00:51:13,270
we're able to pull those usernames and

1112
00:51:13,270 --> 00:51:15,160
this is a sample that running which

1113
00:51:15,160 --> 00:51:16,930
could come in handy for brute force II

1114
00:51:16,930 --> 00:51:23,800
during assessments or whatever so the

1115
00:51:23,800 --> 00:51:27,250
Canon pulls the address books it'll pull

1116
00:51:27,250 --> 00:51:29,410
the entire address books and save it the

1117
00:51:29,410 --> 00:51:31,060
big theme of the Candida dance version

1118
00:51:31,060 --> 00:51:33,880
versions that the key thing is is just

1119
00:51:33,880 --> 00:51:35,500
you'll always want to pull the address

1120
00:51:35,500 --> 00:51:37,060
books it's not going to be the passwords

1121
00:51:37,060 --> 00:51:40,720
you have to log on check a box and says

1122
00:51:40,720 --> 00:51:43,450
export passwords and then you have to

1123
00:51:43,450 --> 00:51:45,460
export passwords but they're all

1124
00:51:45,460 --> 00:51:48,400
encrypted unless you know that the post

1125
00:51:48,400 --> 00:51:51,160
process that makes the request is flawed

1126
00:51:51,160 --> 00:51:53,590
with an e NC mode setting that if you

1127
00:51:53,590 --> 00:51:55,420
said from the normal two to zero

1128
00:51:55,420 --> 00:51:56,860
it'll actually output everything

1129
00:51:56,860 --> 00:51:59,670
unencrypted so we have a like that here

1130
00:51:59,670 --> 00:52:02,800
so as an example you can see we're

1131
00:52:02,800 --> 00:52:05,800
actually able to pull the address book

1132
00:52:05,800 --> 00:52:08,440
and unencrypted the actual passwords of

1133
00:52:08,440 --> 00:52:10,630
habit unencrypted before the symptom

1134
00:52:10,630 --> 00:52:11,100
toast

1135
00:52:11,100 --> 00:52:13,780
so we're automating that and Preta does

1136
00:52:13,780 --> 00:52:15,760
all this too but here we're making it

1137
00:52:15,760 --> 00:52:19,180
available in Metasploit here is the

1138
00:52:19,180 --> 00:52:22,420
Konica this one will actually do soap

1139
00:52:22,420 --> 00:52:24,490
messaging request against the device and

1140
00:52:24,490 --> 00:52:27,520
it pulls barish user names in this case

1141
00:52:27,520 --> 00:52:31,600
it is a ftp password is being pulled off

1142
00:52:31,600 --> 00:52:34,390
the device for ftp services but over

1143
00:52:34,390 --> 00:52:39,490
full FTP SMTP and SMB passwords out of

1144
00:52:39,490 --> 00:52:41,770
the address proportionality on the

1145
00:52:41,770 --> 00:52:44,050
device we've automated that and right

1146
00:52:44,050 --> 00:52:46,210
now we have most set up to actually

1147
00:52:46,210 --> 00:52:49,690
save this data the shows of the era care

1148
00:52:49,690 --> 00:52:51,400
cringe will save so I'll save them all

1149
00:52:51,400 --> 00:52:57,130
out into a loop file here is a extract

1150
00:52:57,130 --> 00:52:59,140
admin password from the Xerox s as a

1151
00:52:59,140 --> 00:53:01,240
firmware attack will actually go out

1152
00:53:01,240 --> 00:53:03,099
there and pull the password that happens

1153
00:53:03,099 --> 00:53:04,570
to be the default for most works

1154
00:53:04,570 --> 00:53:06,609
interests this attack doesn't work on

1155
00:53:06,609 --> 00:53:08,589
the new stuff zero are kind of like

1156
00:53:08,589 --> 00:53:10,930
fixed it when I pull which is what I

1157
00:53:10,930 --> 00:53:14,260
expect but I haven't got around to look

1158
00:53:14,260 --> 00:53:15,940
at it to new ones but I assure you soon

1159
00:53:15,940 --> 00:53:16,359
as I do

1160
00:53:16,359 --> 00:53:19,960
we made a fix that problem and I'm sure

1161
00:53:19,960 --> 00:53:21,160
I'll be able to get these passwords

1162
00:53:21,160 --> 00:53:25,030
because I know how I can do it already

1163
00:53:25,030 --> 00:53:26,589
they just have had a chance to test it

1164
00:53:26,589 --> 00:53:30,790
so demo how to install the beta so let's

1165
00:53:30,790 --> 00:53:38,560
look at this real quick let's jump to

1166
00:53:38,560 --> 00:53:40,660
the end I want you guys if you get stuff

1167
00:53:40,660 --> 00:53:44,260
this right here is where the modules are

1168
00:53:44,260 --> 00:53:47,650
available right here in uh boos go Joe

1169
00:53:47,650 --> 00:53:50,020
pray this point you can get all the new

1170
00:53:50,020 --> 00:53:53,020
Metasploit modules okay and this is

1171
00:53:53,020 --> 00:53:56,680
where you can download prayer let's jump

1172
00:53:56,680 --> 00:53:59,430
back up here

1173
00:54:16,960 --> 00:54:20,500
okay so in this case here we want to

1174
00:54:20,500 --> 00:54:34,240
load up a module so we go yeah so we can

1175
00:54:34,240 --> 00:54:35,559
see all the modules and there's

1176
00:54:35,559 --> 00:54:37,960
something I do developer this box also

1177
00:54:37,960 --> 00:54:40,240
so you see some weird stuff there but as

1178
00:54:40,240 --> 00:54:42,609
you can see oxygen or Prieta they show

1179
00:54:42,609 --> 00:54:45,520
up but literally in the core system my

1180
00:54:45,520 --> 00:54:48,280
predicate pro or framework they're not

1181
00:54:48,280 --> 00:54:50,200
there they're not in that standard

1182
00:54:50,200 --> 00:54:58,030
folder they're in another poll and where

1183
00:54:58,030 --> 00:55:00,099
they're at is the best way to do it is

1184
00:55:00,099 --> 00:55:08,079
if you come along and you go this is

1185
00:55:08,079 --> 00:55:10,030
Ruby this is in your home drive on your

1186
00:55:10,030 --> 00:55:12,339
system you create these folders they'll

1187
00:55:12,339 --> 00:55:14,770
be a document set for their if you go in

1188
00:55:14,770 --> 00:55:21,329
there and create these auxilary scanner

1189
00:55:21,329 --> 00:55:25,869
in this case prayer and we create this

1190
00:55:25,869 --> 00:55:28,119
folder just like this here we can

1191
00:55:28,119 --> 00:55:30,010
download all those and put them in this

1192
00:55:30,010 --> 00:55:31,990
folder here and then when you reload

1193
00:55:31,990 --> 00:55:34,839
Metasploit up they'll be available under

1194
00:55:34,839 --> 00:55:37,420
that standard boxes scanner create a

1195
00:55:37,420 --> 00:55:40,260
folder function that way when you update

1196
00:55:40,260 --> 00:55:44,980
or make changes to Metasploit your your

1197
00:55:44,980 --> 00:55:47,260
DS will not get overwritten and once

1198
00:55:47,260 --> 00:55:48,970
they're available in the course system

1199
00:55:48,970 --> 00:55:55,270
then you can take them out here yes well

1200
00:55:55,270 --> 00:55:56,829
you can do a git clone but you're not

1201
00:55:56,829 --> 00:55:58,299
going to get these modules because

1202
00:55:58,299 --> 00:56:04,569
they're not in Metasploit if you put

1203
00:56:04,569 --> 00:56:08,109
them in here yeah yeah I was just

1204
00:56:08,109 --> 00:56:09,819
showing you where to put you know yeah

1205
00:56:09,819 --> 00:56:13,869
you can do that if you want yeah that'll

1206
00:56:13,869 --> 00:56:15,970
work fine so you get cloned into this

1207
00:56:15,970 --> 00:56:18,730
folder you'll have to be rooted on this

1208
00:56:18,730 --> 00:56:19,839
but if you're doing it from the Kali

1209
00:56:19,839 --> 00:56:21,339
then that's not a problem but if you're

1210
00:56:21,339 --> 00:56:24,190
not on colleges make sure your your

1211
00:56:24,190 --> 00:56:28,020
route and and these are and also suggest

1212
00:56:28,020 --> 00:56:29,760
if you're out there and you're looking

1213
00:56:29,760 --> 00:56:34,890
at some of the stuff we're doing and you

1214
00:56:34,890 --> 00:56:37,020
want to get involved in this project

1215
00:56:37,020 --> 00:56:39,780
please do give me a holler I'll help you

1216
00:56:39,780 --> 00:56:42,840
out ever how I can parada the main prey

1217
00:56:42,840 --> 00:56:44,490
to programs not going to go away for at

1218
00:56:44,490 --> 00:56:48,810
least a year it'll take that long before

1219
00:56:48,810 --> 00:56:50,190
we get everything written so it's going

1220
00:56:50,190 --> 00:56:54,349
to continue to be supported the

1221
00:56:54,349 --> 00:57:01,680
disappear for purpose pull this folder

1222
00:57:01,680 --> 00:57:07,619
this folder that Doc MSF for for yeah

1223
00:57:07,619 --> 00:57:09,650
but when it's created when you installed

1224
00:57:09,650 --> 00:57:13,260
when you install Metasploit you don't

1225
00:57:13,260 --> 00:57:15,540
install it as if you try to install

1226
00:57:15,540 --> 00:57:18,540
Metasploit to not do it as route I don't

1227
00:57:18,540 --> 00:57:20,849
know if you kini Kings I've never been

1228
00:57:20,849 --> 00:57:24,660
able to yeah I wouldn't I wouldn't know

1229
00:57:24,660 --> 00:57:27,150
in this case here this is pro for me so

1230
00:57:27,150 --> 00:57:28,890
this had to be routed to actually get it

1231
00:57:28,890 --> 00:57:32,130
all installed but whatever I would check

1232
00:57:32,130 --> 00:57:33,480
it out if you could write to this

1233
00:57:33,480 --> 00:57:39,089
without being rude and that's fine it is

1234
00:57:39,089 --> 00:57:41,130
but when you create we create the

1235
00:57:41,130 --> 00:57:43,560
install of Metasploit it's ever how you

1236
00:57:43,560 --> 00:57:45,330
created Metasploit and that's how it's

1237
00:57:45,330 --> 00:57:53,900
going to do yeah there's there's so many

1238
00:57:53,900 --> 00:57:56,130
fingers and the various things it's

1239
00:57:56,130 --> 00:57:58,380
easier just to I just installed

1240
00:57:58,380 --> 00:58:00,270
everything is routing that way I didn't

1241
00:58:00,270 --> 00:58:02,250
run into problems when I'm dealing with

1242
00:58:02,250 --> 00:58:05,700
the postcode Postgres database stuff

1243
00:58:05,700 --> 00:58:08,060
because if you install it modest route

1244
00:58:08,060 --> 00:58:10,800
they may run into problems with Postgres

1245
00:58:10,800 --> 00:58:12,450
getting Postgres to automatically start

1246
00:58:12,450 --> 00:58:15,270
up and then a lot of issues but most

1247
00:58:15,270 --> 00:58:17,580
people run the framework just off Kali

1248
00:58:17,580 --> 00:58:20,220
and colleagues routes so you're not

1249
00:58:20,220 --> 00:58:21,960
gonna run into any issues in that case

1250
00:58:21,960 --> 00:58:24,240
there yes now you said would all see

1251
00:58:24,240 --> 00:58:26,099
file to be able to read all these at one

1252
00:58:26,099 --> 00:58:30,300
time against the same set and also you

1253
00:58:30,300 --> 00:58:32,339
pull in in map into the database and

1254
00:58:32,339 --> 00:58:35,160
then you know base who we want to ask

1255
00:58:35,160 --> 00:58:39,330
and based on like who has 480 open those

1256
00:58:39,330 --> 00:58:40,710
are those are those things

1257
00:58:40,710 --> 00:58:42,900
that we're gonna be working on so

1258
00:58:42,900 --> 00:58:45,960
currently currently right now Metasploit

1259
00:58:45,960 --> 00:58:49,920
is not a global fall scanning tool

1260
00:58:49,920 --> 00:58:53,160
you cannot say scan the entire network

1261
00:58:53,160 --> 00:58:55,440
and carry out exploits or run module so

1262
00:58:55,440 --> 00:58:58,680
it won't do that so right now if I want

1263
00:58:58,680 --> 00:58:59,790
to try off like every I don't know what

1264
00:58:59,790 --> 00:59:00,810
kind of put into something is if I'm

1265
00:59:00,810 --> 00:59:02,130
gonna try every one of these modules I

1266
00:59:02,130 --> 00:59:03,390
have to do individually you'll throw

1267
00:59:03,390 --> 00:59:05,310
them all into them that's the current

1268
00:59:05,310 --> 00:59:07,859
state of this point okay we're gonna go

1269
00:59:07,859 --> 00:59:09,660
there but pretas gonna be around for a

1270
00:59:09,660 --> 00:59:13,050
little bit so pray that does it yeah it

1271
00:59:13,050 --> 00:59:14,940
does everything it looks like it's valid

1272
00:59:14,940 --> 00:59:16,650
based on like hitted and such very right

1273
00:59:16,650 --> 00:59:20,550
exactly it so let me go ahead and finish

1274
00:59:20,550 --> 00:59:22,650
up the presentation because we're going

1275
00:59:22,650 --> 00:59:24,150
to touch on that that's where we're

1276
00:59:24,150 --> 00:59:31,950
gonna go so France ploy he met his boy

1277
00:59:31,950 --> 00:59:36,240
Freitas for you screw them together real

1278
00:59:36,240 --> 00:59:40,800
hard to get that so so like I said we're

1279
00:59:40,800 --> 00:59:42,960
migrating all the modules over to

1280
00:59:42,960 --> 00:59:45,300
Metasploit from trip that's the goal we

1281
00:59:45,300 --> 00:59:47,820
got eight someone will get throwed away

1282
00:59:47,820 --> 00:59:49,589
because they're old not as useful

1283
00:59:49,589 --> 00:59:51,930
anymore we're going to generate new ones

1284
00:59:51,930 --> 00:59:54,270
there's stuff already existing in Venice

1285
00:59:54,270 --> 00:59:57,690
we fall within on our model that we're

1286
00:59:57,690 --> 01:00:02,630
already looking for where our goal is to

1287
01:00:02,630 --> 01:00:06,720
create a new move Fred now that will

1288
01:00:06,720 --> 01:00:08,820
contain none of the modules but its

1289
01:00:08,820 --> 01:00:11,130
purpose is is the function as that

1290
01:00:11,130 --> 01:00:15,270
scanner okay so what we want to do with

1291
01:00:15,270 --> 01:00:17,010
the new created is we want to improve

1292
01:00:17,010 --> 01:00:19,589
fingerprinting of embedded devices and

1293
01:00:19,589 --> 01:00:23,010
have a higher accuracy rate we want the

1294
01:00:23,010 --> 01:00:25,950
ability to cold medicine modules now how

1295
01:00:25,950 --> 01:00:27,300
we're going to do that we haven't hashed

1296
01:00:27,300 --> 01:00:31,050
that out yet because from what I

1297
01:00:31,050 --> 01:00:32,609
understand they designed within

1298
01:00:32,609 --> 01:00:35,750
Metasploit is not for to be scan earth

1299
01:00:35,750 --> 01:00:38,790
automated scanner so writing a module

1300
01:00:38,790 --> 01:00:39,990
that they're going to let us put it into

1301
01:00:39,990 --> 01:00:41,820
the core product that turns it into a

1302
01:00:41,820 --> 01:00:45,359
scanner may not but we're considering

1303
01:00:45,359 --> 01:00:47,430
the options and we haven't talked to the

1304
01:00:47,430 --> 01:00:50,580
power to be yet so what we want to do is

1305
01:00:50,580 --> 01:00:53,339
we want to we want to be able to call

1306
01:00:53,339 --> 01:00:54,030
these meds

1307
01:00:54,030 --> 01:00:56,070
magis we want to do what you said we

1308
01:00:56,070 --> 01:00:58,670
want to scan the environment somehow

1309
01:00:58,670 --> 01:01:00,810
fingerprint the devices that actually

1310
01:01:00,810 --> 01:01:04,680
matter to us and then what we want to do

1311
01:01:04,680 --> 01:01:06,510
is call the appropriate Metasploit

1312
01:01:06,510 --> 01:01:09,960
module so we may run this as a standard

1313
01:01:09,960 --> 01:01:12,470
Metasploit extension like you know like

1314
01:01:12,470 --> 01:01:14,790
incognito or something when we get into

1315
01:01:14,790 --> 01:01:17,670
vetted in there or some other

1316
01:01:17,670 --> 01:01:19,890
functionality and there's a possibility

1317
01:01:19,890 --> 01:01:23,760
it may be totally standalone in just API

1318
01:01:23,760 --> 01:01:26,820
handle transactions with menace we

1319
01:01:26,820 --> 01:01:28,880
haven't hashed out those details yet but

1320
01:01:28,880 --> 01:01:31,260
there it's in the works we're kind of

1321
01:01:31,260 --> 01:01:51,900
working on that yes right yeah well in

1322
01:01:51,900 --> 01:01:54,530
that case there

1323
01:01:54,530 --> 01:01:57,450
yeah auto phones there Auto puns not a

1324
01:01:57,450 --> 01:02:06,420
very accepted function so I'm not I'm

1325
01:02:06,420 --> 01:02:09,060
not in to run an auto and I would never

1326
01:02:09,060 --> 01:02:13,110
recommend that so we're not exploiting

1327
01:02:13,110 --> 01:02:14,340
to need to fight the goal is not to

1328
01:02:14,340 --> 01:02:16,080
exploit any devices so we don't want

1329
01:02:16,080 --> 01:02:18,060
parada actually carrying out what we

1330
01:02:18,060 --> 01:02:20,250
consider exploits it's one thing there

1331
01:02:20,250 --> 01:02:22,460
are few exploits that take place there

1332
01:02:22,460 --> 01:02:25,410
sorta kinda but generally it's an

1333
01:02:25,410 --> 01:02:27,600
information gathering tool so we only

1334
01:02:27,600 --> 01:02:30,060
want to do that so yeah I know what

1335
01:02:30,060 --> 01:02:31,980
you're saying but you know you're

1336
01:02:31,980 --> 01:02:34,230
talking about major change or rewrite of

1337
01:02:34,230 --> 01:02:35,940
minutes like they may not allow that I

1338
01:02:35,940 --> 01:02:37,650
can assure you the whole auto phone

1339
01:02:37,650 --> 01:02:41,010
thing and the general product is in that

1340
01:02:41,010 --> 01:02:43,220
functionality is not going to be

1341
01:02:43,220 --> 01:02:52,980
supporting quite right but it Maps not

1342
01:02:52,980 --> 01:02:54,480
sufficient enough to carry out these

1343
01:02:54,480 --> 01:02:57,540
attacks it's not sufficient data it map

1344
01:02:57,540 --> 01:02:59,670
doesn't even in that fingerprinting is

1345
01:02:59,670 --> 01:03:04,590
not necessarily sufficient data also and

1346
01:03:04,590 --> 01:03:06,380
I'll be I'll be the first one I

1347
01:03:06,380 --> 01:03:09,320
like in map being ran from Metasploit no

1348
01:03:09,320 --> 01:03:12,860
some people do that because you end up

1349
01:03:12,860 --> 01:03:14,540
with everything in Metasploit and then

1350
01:03:14,540 --> 01:03:15,860
there's a lot of cool data that's

1351
01:03:15,860 --> 01:03:17,750
possible that's usable in other places

1352
01:03:17,750 --> 01:03:20,450
that's a pitch to get out of Metasploit

1353
01:03:20,450 --> 01:03:21,560
once it's in there

1354
01:03:21,560 --> 01:03:23,540
I like running in that by itself in

1355
01:03:23,540 --> 01:03:25,520
Division one of them medically you

1356
01:03:25,520 --> 01:03:30,640
endpoint the XML you do it all wrong

1357
01:03:30,850 --> 01:03:34,520
naturally run in that and then output

1358
01:03:34,520 --> 01:03:37,820
the XML as I like T and map out whether

1359
01:03:37,820 --> 01:03:40,760
like standard and meant output I have

1360
01:03:40,760 --> 01:03:42,470
something I do with all three of them so

1361
01:03:42,470 --> 01:03:44,060
I usually try to keep someone that so

1362
01:03:44,060 --> 01:03:45,740
separate but yeah I understand where

1363
01:03:45,740 --> 01:03:47,240
you're going that's it so those those

1364
01:03:47,240 --> 01:04:03,590
old things were being thought out yeah

1365
01:04:03,590 --> 01:04:05,060
we were looking at a number of things

1366
01:04:05,060 --> 01:04:10,690
there's also a ruby fingerprinting tool

1367
01:04:10,690 --> 01:04:14,480
that HD board is was part of the not too

1368
01:04:14,480 --> 01:04:17,120
long ago framework that already exists

1369
01:04:17,120 --> 01:04:19,370
out there that we've considered possibly

1370
01:04:19,370 --> 01:04:21,980
leveraging it or building Preta around

1371
01:04:21,980 --> 01:04:25,760
that so yeah it should be an email if

1372
01:04:25,760 --> 01:04:28,220
you if you have any thoughts on that

1373
01:04:28,220 --> 01:04:30,110
subject you may be about will go ahead

1374
01:04:30,110 --> 01:04:32,360
cuz I'm open any thoughts in the entire

1375
01:04:32,360 --> 01:04:36,290
subject so so our goal is additional

1376
01:04:36,290 --> 01:04:37,850
Metasploit module we want to make one

1377
01:04:37,850 --> 01:04:40,070
our build out more Metasploit get all

1378
01:04:40,070 --> 01:04:43,720
the stuff that I get all migrated over

1379
01:04:43,720 --> 01:04:46,880
in a badge scanning engine are your

1380
01:04:46,880 --> 01:04:48,710
brilliant advice is ability call

1381
01:04:48,710 --> 01:04:50,060
Metasploit module these things that

1382
01:04:50,060 --> 01:04:51,470
haven't been done yet this is what we're

1383
01:04:51,470 --> 01:04:54,620
thinking and we've been brainstorming on

1384
01:04:54,620 --> 01:04:56,480
it so we have some ideas we have some

1385
01:04:56,480 --> 01:05:00,020
thoughts but but we're not there yet we

1386
01:05:00,020 --> 01:05:01,790
haven't jumped off that bridge our goal

1387
01:05:01,790 --> 01:05:04,250
is to get as many of the modules that

1388
01:05:04,250 --> 01:05:06,230
we've developed and create up over to

1389
01:05:06,230 --> 01:05:08,540
Metasploit once we get a large chunk of

1390
01:05:08,540 --> 01:05:10,790
stuff over there then we'll start

1391
01:05:10,790 --> 01:05:13,220
looking at okay how do we interact with

1392
01:05:13,220 --> 01:05:13,740
notes

1393
01:05:13,740 --> 01:05:16,589
how do we build a scanner can we build a

1394
01:05:16,589 --> 01:05:18,270
theater that the letters put in

1395
01:05:18,270 --> 01:05:21,150
Metasploit to do this so my ultimate

1396
01:05:21,150 --> 01:05:23,940
goal would be able to in Metasploit you

1397
01:05:23,940 --> 01:05:28,890
would just type in Prieta taking in that

1398
01:05:28,890 --> 01:05:30,750
data that's there or some other data

1399
01:05:30,750 --> 01:05:32,280
that our habits ability to do

1400
01:05:32,280 --> 01:05:34,530
fingerprinting that way or haven't

1401
01:05:34,530 --> 01:05:36,599
ability to take the in map that's Rand

1402
01:05:36,599 --> 01:05:39,930
and import some of that functionality

1403
01:05:39,930 --> 01:05:44,220
you see in G and that we replayed it out

1404
01:05:44,220 --> 01:05:45,900
instead of giving it a sited location

1405
01:05:45,900 --> 01:05:48,150
this can you give it like in math while

1406
01:05:48,150 --> 01:05:50,250
I pee list and say only check it ones

1407
01:05:50,250 --> 01:05:52,020
like I was doing by default what is

1408
01:05:52,020 --> 01:05:54,900
pretty check port 80 no you have to tell

1409
01:05:54,900 --> 01:05:57,119
the report yeah they're the two

1410
01:05:57,119 --> 01:05:58,770
functions you have to tell what port if

1411
01:05:58,770 --> 01:06:00,540
you if you put a cider in you need to

1412
01:06:00,540 --> 01:06:03,000
say eight if you put in an IP list a

1413
01:06:03,000 --> 01:06:06,510
file list you have to put in the port 84

1414
01:06:06,510 --> 01:06:08,820
four three okay but if you use GM map

1415
01:06:08,820 --> 01:06:11,070
output you just reference the GM map

1416
01:06:11,070 --> 01:06:12,720
file it automatically oh yeah mat

1417
01:06:12,720 --> 01:06:15,240
contains all that data so if it has HTTP

1418
01:06:15,240 --> 01:06:17,420
as it possible it will check it out

1419
01:06:17,420 --> 01:06:21,240
yep the only issue with that is there's

1420
01:06:21,240 --> 01:06:23,609
some really bizarre ports that exist out

1421
01:06:23,609 --> 01:06:28,290
there that in map will say HTTP and it

1422
01:06:28,290 --> 01:06:30,420
plays hell and parade up because what it

1423
01:06:30,420 --> 01:06:34,470
does is is it it doesn't it'll establish

1424
01:06:34,470 --> 01:06:36,390
a connection and give it to connection

1425
01:06:36,390 --> 01:06:39,000
but then won't let it timeout it'll hold

1426
01:06:39,000 --> 01:06:41,670
it so it'll stop running those are rare

1427
01:06:41,670 --> 01:06:44,630
but I've run into those a few times and

1428
01:06:44,630 --> 01:06:47,280
seven but I gotta buy my exclusion in

1429
01:06:47,280 --> 01:06:49,950
there for it but I haven't quite figured

1430
01:06:49,950 --> 01:06:52,800
out exactly there's a couple of them I

1431
01:06:52,800 --> 01:06:55,080
don't count on that often but once in a

1432
01:06:55,080 --> 01:06:56,130
while when I hit very large

1433
01:06:56,130 --> 01:06:58,320
organizations that have like eight nine

1434
01:06:58,320 --> 01:07:00,119
ten thousand machines I usually end up

1435
01:07:00,119 --> 01:07:01,680
finding one or two of those in there

1436
01:07:01,680 --> 01:07:03,869
they totally freakin screws you up yeah

1437
01:07:03,869 --> 01:07:06,270
I've gotten very devices I you know be

1438
01:07:06,270 --> 01:07:07,589
able to find the passwords quickly if I

1439
01:07:07,589 --> 01:07:09,660
have to do googling in myself or for a

1440
01:07:09,660 --> 01:07:14,280
lot of useful about so the ultimate goal

1441
01:07:14,280 --> 01:07:15,869
was to write all these in there let's

1442
01:07:15,869 --> 01:07:18,780
let's let's you if your own assessments

1443
01:07:18,780 --> 01:07:21,119
and you find a device and they all have

1444
01:07:21,119 --> 01:07:23,670
web interfaces and it takes the default

1445
01:07:23,670 --> 01:07:24,750
password once you

1446
01:07:24,750 --> 01:07:27,270
and default the default password look at

1447
01:07:27,270 --> 01:07:28,740
the pearl have you written for pray it

1448
01:07:28,740 --> 01:07:30,840
up or look at Metasploit modules and

1449
01:07:30,840 --> 01:07:32,940
look at let's let's start writing

1450
01:07:32,940 --> 01:07:34,350
modules to do that that's kind of

1451
01:07:34,350 --> 01:07:37,020
automate is functionality for anyone

1452
01:07:37,020 --> 01:07:39,330
here does this type of work that's how I

1453
01:07:39,330 --> 01:07:41,520
work together to make it our jobs all

1454
01:07:41,520 --> 01:07:43,980
that much more freaky easier at least

1455
01:07:43,980 --> 01:07:47,070
for a data gathering now that's the

1456
01:07:47,070 --> 01:07:48,090
ultimate goal

1457
01:07:48,090 --> 01:07:52,290
I'm lazy tell ya lazy devices I can

1458
01:07:52,290 --> 01:07:53,850
think of a lot more funner things to

1459
01:07:53,850 --> 01:07:55,470
play with we're on our own assessments

1460
01:07:55,470 --> 01:07:57,630
and have checked for default creds

1461
01:07:57,630 --> 01:08:01,500
manual held on to 50 devices so hope you

1462
01:08:01,500 --> 01:08:04,160
found that entertaining and whitening

1463
01:08:04,160 --> 01:08:06,390
you didn't throw nothing having so I

1464
01:08:06,390 --> 01:08:08,270
guess that counts for something

1465
01:08:08,270 --> 01:08:19,290
are you gonna save the migration you

1466
01:08:19,290 --> 01:08:20,850
know I don't know I know I'm going to

1467
01:08:20,850 --> 01:08:23,100
juggling 40 billion projects and this is

1468
01:08:23,100 --> 01:08:24,930
kind of like an extended project and

1469
01:08:24,930 --> 01:08:27,270
actually sanctioned rapid 17 standard

1470
01:08:27,270 --> 01:08:35,910
project to migrate that stuff over but

1471
01:08:35,910 --> 01:08:38,310
it makes it makes some it make some

1472
01:08:38,310 --> 01:08:40,350
better opportunities for me so to get as

1473
01:08:40,350 --> 01:08:42,960
a sanction project not we're sanctioned

1474
01:08:42,960 --> 01:08:46,140
afterward sanction project so so my goal

1475
01:08:46,140 --> 01:08:48,359
is I'd like to have it all done all the

1476
01:08:48,359 --> 01:08:51,120
kooky modules boomed over by the end of

1477
01:08:51,120 --> 01:08:54,240
the year I don't expect that

1478
01:08:54,240 --> 01:08:57,509
don't be a crate up sploit the scanning

1479
01:08:57,509 --> 01:09:01,439
engine functionality probably until next

1480
01:09:01,439 --> 01:09:04,890
year mid next year later I'm inspecting

1481
01:09:04,890 --> 01:09:07,799
because you know I like juggling the 14

1482
01:09:07,799 --> 01:09:09,630
balls at the same time you know how that

1483
01:09:09,630 --> 01:09:13,680
goes and and I can only there's only so

1484
01:09:13,680 --> 01:09:15,240
many nice I could stay up to 3:00 in the

1485
01:09:15,240 --> 01:09:17,759
morning the right stuff most of these

1486
01:09:17,759 --> 01:09:20,450
were written at 2:00 in the morning

1487
01:09:20,450 --> 01:09:22,470
that's usually where I do one for our

1488
01:09:22,470 --> 01:09:24,000
game Saturday night to stay up to three

1489
01:09:24,000 --> 01:09:28,529
of the morning I don't write I stab 3

1490
01:09:28,529 --> 01:09:31,609
the morning Google

1491
01:09:34,250 --> 01:09:36,810
look at other people's code and when I'm

1492
01:09:36,810 --> 01:09:40,049
stumped I asked my friends this isn't

1493
01:09:40,049 --> 01:09:41,609
working and then they get something they

1494
01:09:41,609 --> 01:09:43,770
ask their friends officially we asked

1495
01:09:43,770 --> 01:09:49,529
enough friends oh we're at in see little

1496
01:09:49,529 --> 01:09:51,270
courtroom quirky things with some of

1497
01:09:51,270 --> 01:09:52,649
these modules we were trying to do

1498
01:09:52,649 --> 01:09:54,840
because if you look at most Metasploit

1499
01:09:54,840 --> 01:09:56,910
modules what do they do they carry out

1500
01:09:56,910 --> 01:09:59,700
one function is for one quarter but I

1501
01:09:59,700 --> 01:10:02,340
have one of my modules goes to several

1502
01:10:02,340 --> 01:10:03,960
different ports to actually carry out

1503
01:10:03,960 --> 01:10:08,250
all of this functionality and there was

1504
01:10:08,250 --> 01:10:13,500
no solution just make that work so that

1505
01:10:13,500 --> 01:10:15,900
was kind of so that was my presentation

1506
01:10:15,900 --> 01:10:18,679
I hope you enjoyed it

