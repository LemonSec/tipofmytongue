1
00:00:06,120 --> 00:00:08,940
hey everyone uh so today we're gonna

2
00:00:08,940 --> 00:00:10,980
present Andre at azer I'm somewhere our

3
00:00:10,980 --> 00:00:13,139
hybrid approach that we have seen used

4
00:00:13,139 --> 00:00:14,880
by some of the react families that we

5
00:00:14,880 --> 00:00:16,800
will be discussing

6
00:00:16,800 --> 00:00:18,600
uh first we would like to introduce

7
00:00:18,600 --> 00:00:22,279
ourselves uh my name is

8
00:00:24,920 --> 00:00:28,380
sitting there so we all are working for

9
00:00:28,380 --> 00:00:31,579
security research team in z-scara

10
00:00:31,579 --> 00:00:34,680
so um so here's the agenda so first we

11
00:00:34,680 --> 00:00:37,559
will be uh discussing about the neighbor

12
00:00:37,559 --> 00:00:39,719
approach that malwarees are called being

13
00:00:39,719 --> 00:00:42,420
up and then along with that we will also

14
00:00:42,420 --> 00:00:44,879
be discussing about some of the top rats

15
00:00:44,879 --> 00:00:47,760
that we have seen in this in scalar

16
00:00:47,760 --> 00:00:50,280
along with the the different fat groups

17
00:00:50,280 --> 00:00:53,160
that we have seen using those uh rats

18
00:00:53,160 --> 00:00:55,379
specifically and then we will Deep dive

19
00:00:55,379 --> 00:00:58,440
into a few case studies of the Rat

20
00:00:58,440 --> 00:01:01,140
families that we have seen where they

21
00:01:01,140 --> 00:01:04,440
are using malware uh rental specifically

22
00:01:04,440 --> 00:01:06,119
and then we will conclude this session

23
00:01:06,119 --> 00:01:07,979
at that

24
00:01:07,979 --> 00:01:11,580
so here we have a wider very small

25
00:01:11,580 --> 00:01:13,920
representation of the let's act like

26
00:01:13,920 --> 00:01:14,939
cycle

27
00:01:14,939 --> 00:01:17,220
so we know like the attack starts with

28
00:01:17,220 --> 00:01:19,200
the initial infection Vector which could

29
00:01:19,200 --> 00:01:21,840
include the spam email malicious

30
00:01:21,840 --> 00:01:23,280
attachment

31
00:01:23,280 --> 00:01:25,560
and that can result into dropping a

32
00:01:25,560 --> 00:01:28,560
malware downloader or dropper and then

33
00:01:28,560 --> 00:01:29,939
uh

34
00:01:29,939 --> 00:01:33,119
final stays would be where a rem

35
00:01:33,119 --> 00:01:36,720
somewhere or any other threat category

36
00:01:36,720 --> 00:01:38,520
um related to any other sector category

37
00:01:38,520 --> 00:01:40,860
malware will be dropped

38
00:01:40,860 --> 00:01:43,500
so over the past few years I think we

39
00:01:43,500 --> 00:01:45,960
have everyone has observed that uh the

40
00:01:45,960 --> 00:01:47,579
malware different malwares they are

41
00:01:47,579 --> 00:01:49,320
combining the features from other

42
00:01:49,320 --> 00:01:52,439
categories and that I think is driven by

43
00:01:52,439 --> 00:01:54,659
the profitability of uh other malware

44
00:01:54,659 --> 00:01:56,640
families for example ransomware so we

45
00:01:56,640 --> 00:01:58,860
saw that from somewhere is now having

46
00:01:58,860 --> 00:02:01,979
the Steeler capabilities as well

47
00:02:01,979 --> 00:02:03,659
so they are sealing the data and then

48
00:02:03,659 --> 00:02:05,640
they are finally you know blackmailing

49
00:02:05,640 --> 00:02:07,979
the victim to earn more money and we

50
00:02:07,979 --> 00:02:10,979
have seen that same Trend in Rat as well

51
00:02:10,979 --> 00:02:14,040
so now we have seen few more rat

52
00:02:14,040 --> 00:02:16,440
families those are combining ransomware

53
00:02:16,440 --> 00:02:17,879
features as well and we will be

54
00:02:17,879 --> 00:02:20,299
discussing

55
00:02:20,819 --> 00:02:24,420
so here is a list of the top uh 10 rats

56
00:02:24,420 --> 00:02:27,540
that we have seen and

57
00:02:27,540 --> 00:02:30,300
Ram post rat is at the top

58
00:02:30,300 --> 00:02:33,000
the we have seen that the adaptability

59
00:02:33,000 --> 00:02:36,180
or popularity of any red depends on the

60
00:02:36,180 --> 00:02:38,340
feature uh that it provides and that's

61
00:02:38,340 --> 00:02:41,640
true related to each malware family

62
00:02:41,640 --> 00:02:44,700
so we have listed few groups as well

63
00:02:44,700 --> 00:02:46,920
so these threat groups we have seen they

64
00:02:46,920 --> 00:02:49,080
use a different kind of rats and they

65
00:02:49,080 --> 00:02:51,420
target different uh Industries as well

66
00:02:51,420 --> 00:02:54,599
and that includes travel industry and

67
00:02:54,599 --> 00:02:56,519
then Hospitality including you know

68
00:02:56,519 --> 00:02:59,519
targeting specific governments as well

69
00:02:59,519 --> 00:03:01,500
so when we were doing research and we

70
00:03:01,500 --> 00:03:03,959
were following up these threat groups we

71
00:03:03,959 --> 00:03:07,800
came to know what this very small t858

72
00:03:07,800 --> 00:03:11,459
tract actor this is uh financially

73
00:03:11,459 --> 00:03:13,500
motivated fat actor which is active

74
00:03:13,500 --> 00:03:15,360
since 2018.

75
00:03:15,360 --> 00:03:18,480
and when we followed up the campaigns or

76
00:03:18,480 --> 00:03:21,599
the phishing emails that they are using

77
00:03:21,599 --> 00:03:24,959
so we agreed I mean

78
00:03:24,959 --> 00:03:27,360
we come to know that they are mainly

79
00:03:27,360 --> 00:03:29,700
targeting travel and hospitality

80
00:03:29,700 --> 00:03:31,500
industries and based on the language

81
00:03:31,500 --> 00:03:35,040
that they use in the campaign ah so they

82
00:03:35,040 --> 00:03:37,019
are mainly you know targeting users

83
00:03:37,019 --> 00:03:38,819
speaking Spanish and Portuguese

84
00:03:38,819 --> 00:03:41,299
languages

85
00:03:43,860 --> 00:03:46,620
so related to the specific campaign that

86
00:03:46,620 --> 00:03:48,480
I was mentioning regarding a specific

87
00:03:48,480 --> 00:03:51,720
racks so we observed that this actor is

88
00:03:51,720 --> 00:03:54,599
you know they are hopping or delivering

89
00:03:54,599 --> 00:03:58,319
Venom rat and uh this scope is doing

90
00:03:58,319 --> 00:04:00,659
this activity or the campaigns that we

91
00:04:00,659 --> 00:04:02,819
saw uh those are active starting from

92
00:04:02,819 --> 00:04:06,180
October 2020 and they are still active

93
00:04:06,180 --> 00:04:09,540
and then we you know clustered the the

94
00:04:09,540 --> 00:04:12,420
campaigns based on the ttps based on the

95
00:04:12,420 --> 00:04:13,620
infection chain

96
00:04:13,620 --> 00:04:16,139
so and uh we will be discussing about

97
00:04:16,139 --> 00:04:18,600
each and every infection chain what kind

98
00:04:18,600 --> 00:04:21,899
of variations we see have seen so from

99
00:04:21,899 --> 00:04:25,919
here I will yeah here we have seen the

100
00:04:25,919 --> 00:04:28,320
uh you know more details about the Wrath

101
00:04:28,320 --> 00:04:30,660
so Venom rat is basically developed by

102
00:04:30,660 --> 00:04:32,759
Venom Control software

103
00:04:32,759 --> 00:04:35,040
and they are selling it malware as a

104
00:04:35,040 --> 00:04:35,940
service

105
00:04:35,940 --> 00:04:39,120
ah they are sharing the updates on the

106
00:04:39,120 --> 00:04:42,600
debater and this particular rat is

107
00:04:42,600 --> 00:04:44,520
having features like as I mentioned

108
00:04:44,520 --> 00:04:46,740
ransomware but even they have AV Vision

109
00:04:46,740 --> 00:04:51,080
uh key logging and all of those things

110
00:04:51,240 --> 00:04:53,460
so when we were doing research on this

111
00:04:53,460 --> 00:04:57,000
random rat we try to find is there any

112
00:04:57,000 --> 00:04:58,860
similarity of this rat with any other

113
00:04:58,860 --> 00:04:59,699
app

114
00:04:59,699 --> 00:05:02,580
so we were able to find that this

115
00:05:02,580 --> 00:05:04,979
threats the random rat is having same

116
00:05:04,979 --> 00:05:07,199
configuration decryption routine similar

117
00:05:07,199 --> 00:05:10,020
to Chrysler rat so as you can see we

118
00:05:10,020 --> 00:05:13,440
have uh displayed here two snapshots one

119
00:05:13,440 --> 00:05:16,560
is from random config and another one is

120
00:05:16,560 --> 00:05:19,620
from passer rat so both of these are

121
00:05:19,620 --> 00:05:22,620
using the same coding so people I mean

122
00:05:22,620 --> 00:05:25,860
it's a kind of like found out that this

123
00:05:25,860 --> 00:05:29,160
uh they both use the same port

124
00:05:29,160 --> 00:05:32,699
and then for this particular uh track

125
00:05:32,699 --> 00:05:35,340
Factor they are using specifically two

126
00:05:35,340 --> 00:05:37,979
versions of the Venom bracket 2.7 and

127
00:05:37,979 --> 00:05:41,039
2.8 and both of those verses having uh

128
00:05:41,039 --> 00:05:43,020
the Rams of memory and we will be

129
00:05:43,020 --> 00:05:45,240
discussing like why they prefer to use

130
00:05:45,240 --> 00:05:48,620
these two in the coming slides

131
00:05:48,780 --> 00:05:50,639
yeah so here I will head over to a

132
00:05:50,639 --> 00:05:52,259
winner so he will explain the infection

133
00:05:52,259 --> 00:05:54,600
chains thank you

134
00:05:54,600 --> 00:05:57,600
so we have divided these uh into

135
00:05:57,600 --> 00:06:00,000
different clusters so we will discuss

136
00:06:00,000 --> 00:06:03,600
the cluster one first so in this uh in

137
00:06:03,600 --> 00:06:05,759
the cluster one the infection chain

138
00:06:05,759 --> 00:06:08,100
basically starts with the malicious chm

139
00:06:08,100 --> 00:06:10,500
uh which is actually bundled inside the

140
00:06:10,500 --> 00:06:12,600
rare archive and which is downloaded

141
00:06:12,600 --> 00:06:15,000
from the Google Drive so in malicious

142
00:06:15,000 --> 00:06:16,919
chm we have seen that it is basically

143
00:06:16,919 --> 00:06:20,280
downloading and executing an HTA file uh

144
00:06:20,280 --> 00:06:21,660
using the trusted window utility

145
00:06:21,660 --> 00:06:23,880
mssda.exe

146
00:06:23,880 --> 00:06:27,479
so this HTA file is further going to

147
00:06:27,479 --> 00:06:30,240
download and execute the vbscript so

148
00:06:30,240 --> 00:06:33,060
here we can see that this hdf file is

149
00:06:33,060 --> 00:06:35,699
basically starting a Powershell process

150
00:06:35,699 --> 00:06:37,979
uh which actually download and execute

151
00:06:37,979 --> 00:06:39,960
the vbscript file and then the vbscript

152
00:06:39,960 --> 00:06:42,539
file further executed using the start

153
00:06:42,539 --> 00:06:45,539
process now this obfuscated vbscript

154
00:06:45,539 --> 00:06:48,360
basically downloads uh another

155
00:06:48,360 --> 00:06:51,539
Powershell script which is uh done by

156
00:06:51,539 --> 00:06:53,460
replacing and concatenating different

157
00:06:53,460 --> 00:06:55,979
functions and that will again decode the

158
00:06:55,979 --> 00:06:58,139
Powershell script and that powershells

159
00:06:58,139 --> 00:07:00,000
Powershell script will be our loader

160
00:07:00,000 --> 00:07:02,759
Powershell script so that loader

161
00:07:02,759 --> 00:07:06,479
Powershell script will download a PE

162
00:07:06,479 --> 00:07:10,680
file by decoding a huge j64 blob and

163
00:07:10,680 --> 00:07:13,259
that PE file will be our dll that will

164
00:07:13,259 --> 00:07:16,940
that name as a class library3.dll so

165
00:07:16,940 --> 00:07:19,860
this dll will be loaded by executing

166
00:07:19,860 --> 00:07:23,280
this run method and the argument to the

167
00:07:23,280 --> 00:07:26,819
run method is reversed URL so now this

168
00:07:26,819 --> 00:07:29,400
dll will be it will be a downloader

169
00:07:29,400 --> 00:07:31,919
injector dll so this dll will basically

170
00:07:31,919 --> 00:07:35,160
uh download final payload from the

171
00:07:35,160 --> 00:07:39,000
Firebase and uh by using the string

172
00:07:39,000 --> 00:07:41,940
reversing of the URL and then it will in

173
00:07:41,940 --> 00:07:44,880
uh once downloaded uh it will reverse

174
00:07:44,880 --> 00:07:47,759
and base64 decoded and then it will be

175
00:07:47,759 --> 00:07:51,419
injected into reg ASM process by using

176
00:07:51,419 --> 00:07:53,099
process following

177
00:07:53,099 --> 00:07:54,960
so that was our first infection chain

178
00:07:54,960 --> 00:07:57,240
and the variation we have seen in this

179
00:07:57,240 --> 00:08:00,180
like earlier it was using uh remote HDA

180
00:08:00,180 --> 00:08:02,759
to download the VB script but here we

181
00:08:02,759 --> 00:08:04,500
can see that the malicious chm is

182
00:08:04,500 --> 00:08:06,240
directly downloading the obfuscated UV

183
00:08:06,240 --> 00:08:09,720
script using the wgac method so in this

184
00:08:09,720 --> 00:08:11,639
we have seen that chm is directly

185
00:08:11,639 --> 00:08:13,740
downloading the VB script

186
00:08:13,740 --> 00:08:17,160
uh moving on to Cluster two uh we have

187
00:08:17,160 --> 00:08:20,280
uh seen that the infection chain is

188
00:08:20,280 --> 00:08:22,259
quite similar to Cluster one until this

189
00:08:22,259 --> 00:08:24,300
remote HTA is downloading the VB script

190
00:08:24,300 --> 00:08:26,940
but in this cluster 2 we have seen that

191
00:08:26,940 --> 00:08:29,580
video script is basically uh sleeping

192
00:08:29,580 --> 00:08:32,640
initially for three seconds and then uh

193
00:08:32,640 --> 00:08:34,679
it will this VB script will download and

194
00:08:34,679 --> 00:08:37,080
execute the Powershell script from the

195
00:08:37,080 --> 00:08:39,958
Firebase now this Powershell script is

196
00:08:39,958 --> 00:08:43,200
basically uh used to download uh run PE

197
00:08:43,200 --> 00:08:45,660
loader Powershell script and that event

198
00:08:45,660 --> 00:08:49,380
P loader will again execute the final

199
00:08:49,380 --> 00:08:52,740
payload so here we can see that uh this

200
00:08:52,740 --> 00:08:54,959
run P loaders commercial script is

201
00:08:54,959 --> 00:08:57,959
downloading uh these two different

202
00:08:57,959 --> 00:09:00,240
modules one is the final payload that is

203
00:09:00,240 --> 00:09:02,640
Venom rat and then other is the runty

204
00:09:02,640 --> 00:09:05,820
module so this run P module will

205
00:09:05,820 --> 00:09:07,100
basically

206
00:09:07,100 --> 00:09:11,339
inject the Venom rat into the uh using

207
00:09:11,339 --> 00:09:12,860
the remote process

208
00:09:12,860 --> 00:09:16,980
uh then we have seen that this run PE

209
00:09:16,980 --> 00:09:19,019
module is quite similar to process

210
00:09:19,019 --> 00:09:22,080
hollowing only where the Run P module is

211
00:09:22,080 --> 00:09:25,100
again downloading and executing the uh

212
00:09:25,100 --> 00:09:28,380
final payload while injecting it into

213
00:09:28,380 --> 00:09:31,440
the remote process ASP underscore ASP

214
00:09:31,440 --> 00:09:34,019
net underscore compiler.exe and another

215
00:09:34,019 --> 00:09:37,019
process is caskall.exe using the Run P

216
00:09:37,019 --> 00:09:40,320
module so in the cluster 2 we have seen

217
00:09:40,320 --> 00:09:43,260
another variation where in remote HTA

218
00:09:43,260 --> 00:09:45,120
basically downloading two different

219
00:09:45,120 --> 00:09:47,459
Power two different files one is

220
00:09:47,459 --> 00:09:51,300
vbscript all from the Firebase itself so

221
00:09:51,300 --> 00:09:53,700
one is the baby script another is the PS

222
00:09:53,700 --> 00:09:55,980
file that is run P loader Powershell

223
00:09:55,980 --> 00:09:58,800
script and that run P loader Powershell

224
00:09:58,800 --> 00:10:02,459
script will uh execute the final payload

225
00:10:02,459 --> 00:10:06,300
so another variation after this the

226
00:10:06,300 --> 00:10:07,740
initial variation we have seen another

227
00:10:07,740 --> 00:10:11,519
variation where this uh VB script will

228
00:10:11,519 --> 00:10:14,279
create a link file in the startup for

229
00:10:14,279 --> 00:10:16,519
the folder for the persistence mechanism

230
00:10:16,519 --> 00:10:20,580
so here we can see that the VB script is

231
00:10:20,580 --> 00:10:22,260
basically creating a link file in the

232
00:10:22,260 --> 00:10:25,320
startup folder and that link file name

233
00:10:25,320 --> 00:10:28,160
we can see here is like viewer

234
00:10:28,160 --> 00:10:31,920
frontal.hotel realfrontal dot link and

235
00:10:31,920 --> 00:10:36,180
that run P loader this link file will

236
00:10:36,180 --> 00:10:37,920
execute to

237
00:10:37,920 --> 00:10:40,800
you know for the persistence and it will

238
00:10:40,800 --> 00:10:43,440
VB skip will again execute this run PE

239
00:10:43,440 --> 00:10:47,519
file uh run PE loader Powershell script

240
00:10:47,519 --> 00:10:51,120
then uh the next variation we have seen

241
00:10:51,120 --> 00:10:53,360
here is that

242
00:10:53,360 --> 00:10:56,579
this VB script is basically downloaded

243
00:10:56,579 --> 00:10:59,579
by malicious chm directly using the curl

244
00:10:59,579 --> 00:11:03,000
method so here we can see that this chm

245
00:11:03,000 --> 00:11:04,220
file is

246
00:11:04,220 --> 00:11:06,660
downloading vbscript using the curl

247
00:11:06,660 --> 00:11:09,000
method and then DB script to basically

248
00:11:09,000 --> 00:11:11,399
download and execute this run P loader

249
00:11:11,399 --> 00:11:12,959
and that run P loader will inject the

250
00:11:12,959 --> 00:11:15,899
Venom rat into the remote process so

251
00:11:15,899 --> 00:11:18,180
here we can see that link file is all

252
00:11:18,180 --> 00:11:21,060
also created and in this case the name

253
00:11:21,060 --> 00:11:23,700
of the link file is primevideo.link

254
00:11:23,700 --> 00:11:26,640
so uh after this variation we have seen

255
00:11:26,640 --> 00:11:28,620
another variation in the cluster 2 where

256
00:11:28,620 --> 00:11:32,519
you know uh this uh run P loader file is

257
00:11:32,519 --> 00:11:35,040
actually creating a scheduled task

258
00:11:35,040 --> 00:11:38,160
so this uh schedule task is basically

259
00:11:38,160 --> 00:11:41,519
created by run P loader file uh then the

260
00:11:41,519 --> 00:11:44,579
name of the task is Hill hild and those

261
00:11:44,579 --> 00:11:47,700
this schedule task is created to you

262
00:11:47,700 --> 00:11:49,019
know maintain the Persistence of the

263
00:11:49,019 --> 00:11:52,440
system and this schedule task basically

264
00:11:52,440 --> 00:11:53,839
uh

265
00:11:53,839 --> 00:11:57,180
there for to you know execute the VB

266
00:11:57,180 --> 00:12:00,240
script in every 132 minute and as we

267
00:12:00,240 --> 00:12:01,339
already

268
00:12:01,339 --> 00:12:03,899
discussed that vbscript is basically

269
00:12:03,899 --> 00:12:06,839
there to execute the Run P loader

270
00:12:06,839 --> 00:12:08,880
Powershell script

271
00:12:08,880 --> 00:12:12,180
now ah moving on to the file name

272
00:12:12,180 --> 00:12:15,300
analysis so we have done some we have

273
00:12:15,300 --> 00:12:17,579
seen most frequent file name used by the

274
00:12:17,579 --> 00:12:19,440
threat actor 558 those are the

275
00:12:19,440 --> 00:12:21,480
reservation reservation model then

276
00:12:21,480 --> 00:12:24,420
document name so using this we can you

277
00:12:24,420 --> 00:12:26,579
know see that this fat actor is

278
00:12:26,579 --> 00:12:28,320
basically targeting hospitality industry

279
00:12:28,320 --> 00:12:31,860
and travel industry so with this I will

280
00:12:31,860 --> 00:12:33,899
hand out over to level

281
00:12:33,899 --> 00:12:35,399
thank you

282
00:12:35,399 --> 00:12:37,800
yeah so we saw variations in the

283
00:12:37,800 --> 00:12:39,839
infection chain but when we were doing

284
00:12:39,839 --> 00:12:43,500
analysis for the uh random rat folder so

285
00:12:43,500 --> 00:12:45,540
the code was same but there were two

286
00:12:45,540 --> 00:12:47,820
variants that I mentioned earlier

287
00:12:47,820 --> 00:12:50,459
so regarding specifically regarding the

288
00:12:50,459 --> 00:12:53,220
ransomware module it was not enabled by

289
00:12:53,220 --> 00:12:56,399
default so the I mean like for enabling

290
00:12:56,399 --> 00:13:00,240
it it requires uh CNC communication and

291
00:13:00,240 --> 00:13:02,519
apart from that it also requires the

292
00:13:02,519 --> 00:13:04,920
cryptographers like I mean whether

293
00:13:04,920 --> 00:13:07,620
author would use Bitcoin or any other

294
00:13:07,620 --> 00:13:09,959
cryptocurrency so that information will

295
00:13:09,959 --> 00:13:12,360
be provided by CNC

296
00:13:12,360 --> 00:13:13,800
and the

297
00:13:13,800 --> 00:13:16,680
all other things including the key also

298
00:13:16,680 --> 00:13:18,120
that I have mentioned here encryption

299
00:13:18,120 --> 00:13:20,760
key so everything is hard coded like

300
00:13:20,760 --> 00:13:22,500
what folders it should scan for

301
00:13:22,500 --> 00:13:25,560
encrypting the files and then

302
00:13:25,560 --> 00:13:28,320
um even even the van extension name for

303
00:13:28,320 --> 00:13:30,959
after encryption encrypting the files

304
00:13:30,959 --> 00:13:34,200
another thing that we noted is if you if

305
00:13:34,200 --> 00:13:35,940
you are able to see the extension list

306
00:13:35,940 --> 00:13:38,339
it's quite extensive so they have even

307
00:13:38,339 --> 00:13:42,180
mentioned exe and bl they are so we are

308
00:13:42,180 --> 00:13:44,100
not sure we think that this is Maybe by

309
00:13:44,100 --> 00:13:46,560
mistake or this just a copy paste thing

310
00:13:46,560 --> 00:13:49,620
because like if ransomware will be able

311
00:13:49,620 --> 00:13:52,560
to encrypt the sys files from the system

312
00:13:52,560 --> 00:13:56,599
32 folder then system won't work

313
00:13:57,000 --> 00:14:01,440
uh regarding encryption so they use the

314
00:14:01,440 --> 00:14:03,720
same kind of encryption AES mostly used

315
00:14:03,720 --> 00:14:06,660
by uh and software and another thing

316
00:14:06,660 --> 00:14:08,279
that here I mentioned regarding the

317
00:14:08,279 --> 00:14:10,139
encryption key but if you check here

318
00:14:10,139 --> 00:14:12,959
they are not using that value they are

319
00:14:12,959 --> 00:14:15,180
just using another value for calculating

320
00:14:15,180 --> 00:14:18,839
the uh the key and IV and that is

321
00:14:18,839 --> 00:14:21,480
important to note because uh when we

322
00:14:21,480 --> 00:14:23,459
tested it like if you check the

323
00:14:23,459 --> 00:14:26,579
decryption also so first it will drop

324
00:14:26,579 --> 00:14:29,040
the decrypter from the resource section

325
00:14:29,040 --> 00:14:32,399
and then if you see here it is using the

326
00:14:32,399 --> 00:14:36,060
same salt value and not using the

327
00:14:36,060 --> 00:14:38,760
password provided by the user so that

328
00:14:38,760 --> 00:14:40,980
means like whatever password we are we

329
00:14:40,980 --> 00:14:43,380
provide it will be able to decrypt the

330
00:14:43,380 --> 00:14:45,360
files and that also like so just like

331
00:14:45,360 --> 00:14:47,519
maybe it is under development

332
00:14:47,519 --> 00:14:51,060
and we saw that like I mean even if you

333
00:14:51,060 --> 00:14:52,800
don't have the decrypter you can use any

334
00:14:52,800 --> 00:14:55,620
decrypter you have the key and ID value

335
00:14:55,620 --> 00:14:57,360
you can just provide that and you will

336
00:14:57,360 --> 00:15:00,000
be able to decade for the files

337
00:15:00,000 --> 00:15:03,180
and another thing so the The Ransom note

338
00:15:03,180 --> 00:15:05,339
also they have hard coder not

339
00:15:05,339 --> 00:15:08,459
downloading from everywhere only the

340
00:15:08,459 --> 00:15:11,699
thing like Bitcoin and crypto addresses

341
00:15:11,699 --> 00:15:15,800
that I mentioned they will get from here

342
00:15:15,899 --> 00:15:18,240
so I mean when we were checking like

343
00:15:18,240 --> 00:15:20,279
during the code analysis the code

344
00:15:20,279 --> 00:15:22,500
comparison so we were able to find that

345
00:15:22,500 --> 00:15:25,079
they used an open source ransomware

346
00:15:25,079 --> 00:15:28,740
welder so we kind of like get hold of

347
00:15:28,740 --> 00:15:30,779
that we decompiled we compare the code

348
00:15:30,779 --> 00:15:32,579
we were able to decide that this is the

349
00:15:32,579 --> 00:15:33,300
same

350
00:15:33,300 --> 00:15:34,560
and

351
00:15:34,560 --> 00:15:37,500
we also try to find like as I mentioned

352
00:15:37,500 --> 00:15:39,120
earlier so we also compared with other

353
00:15:39,120 --> 00:15:40,860
malware families specifically for

354
00:15:40,860 --> 00:15:43,199
ransomware and we were able to find that

355
00:15:43,199 --> 00:15:46,440
another ransomware magnets so that is

356
00:15:46,440 --> 00:15:49,199
also using the same rat and if you see

357
00:15:49,199 --> 00:15:53,160
here uh Magnus and random rats they both

358
00:15:53,160 --> 00:15:58,440
have the same uh encryption code

359
00:15:58,440 --> 00:16:00,779
and similarly for Magnus also he will be

360
00:16:00,779 --> 00:16:02,639
able to decrypt the files

361
00:16:02,639 --> 00:16:05,519
earlier we mentioned that they used two

362
00:16:05,519 --> 00:16:08,519
specific versions of the Venom brat and

363
00:16:08,519 --> 00:16:11,639
uh like I mean when we further checked

364
00:16:11,639 --> 00:16:14,940
on other lead sites so we were able to

365
00:16:14,940 --> 00:16:17,279
find these uh you know cracked versions

366
00:16:17,279 --> 00:16:19,980
of these two specific variants of the

367
00:16:19,980 --> 00:16:22,139
Venom bread and similarly we did

368
00:16:22,139 --> 00:16:24,060
analysis on that try to find whether

369
00:16:24,060 --> 00:16:27,540
they use the same Builders or not so the

370
00:16:27,540 --> 00:16:29,220
you the same one we were able to find

371
00:16:29,220 --> 00:16:30,079
that

372
00:16:30,079 --> 00:16:32,940
uh comparing the code and strings and

373
00:16:32,940 --> 00:16:35,600
those things

374
00:16:35,699 --> 00:16:38,160
yeah from here we will be discussing the

375
00:16:38,160 --> 00:16:40,740
second wrap that we saw so vinash will

376
00:16:40,740 --> 00:16:42,779
do this

377
00:16:42,779 --> 00:16:45,120
yeah so we have discussed that the

378
00:16:45,120 --> 00:16:48,079
league Builder has been used for uh

379
00:16:48,079 --> 00:16:51,360
creating the rack

380
00:16:51,360 --> 00:16:54,540
so here we have seen while you're doing

381
00:16:54,540 --> 00:16:57,680
some course intelligence uh you know

382
00:16:57,680 --> 00:17:00,420
investigation so we have found another

383
00:17:00,420 --> 00:17:02,940
rack which is using the ransomware

384
00:17:02,940 --> 00:17:06,059
module so we haven't found any campaign

385
00:17:06,059 --> 00:17:08,579
that has been you know used this

386
00:17:08,579 --> 00:17:12,480
particular rack but uh we we are sure we

387
00:17:12,480 --> 00:17:14,880
this can be seen in the future because

388
00:17:14,880 --> 00:17:18,240
uh this uh new rat that is called as

389
00:17:18,240 --> 00:17:21,119
Anarchy panel rack we have found that

390
00:17:21,119 --> 00:17:22,799
this has been distributed on the leak

391
00:17:22,799 --> 00:17:25,079
Forum this January on this year January

392
00:17:25,079 --> 00:17:27,319
only so

393
00:17:27,319 --> 00:17:29,580
we have also found a GitHub account

394
00:17:29,580 --> 00:17:32,640
where the features are mentioned uh for

395
00:17:32,640 --> 00:17:35,220
this NRP guide panel Anarchy panel red

396
00:17:35,220 --> 00:17:37,440
so those are some common features like

397
00:17:37,440 --> 00:17:40,740
ransomware and MBR in Factor then uh

398
00:17:40,740 --> 00:17:42,539
Steeler is there then remote Shell

399
00:17:42,539 --> 00:17:44,700
Aviation these are some features

400
00:17:44,700 --> 00:17:46,620
mentioned on the GitHub account

401
00:17:46,620 --> 00:17:49,440
so during our analysis we have found

402
00:17:49,440 --> 00:17:52,080
that it is quite similar with the DC

403
00:17:52,080 --> 00:17:55,980
rack and we have found that the DC red

404
00:17:55,980 --> 00:17:59,520
salt and the configuration routine is

405
00:17:59,520 --> 00:18:02,700
quite similar in both the both the rats

406
00:18:02,700 --> 00:18:06,620
and we have seen that this Anarchy react

407
00:18:06,620 --> 00:18:09,419
ransomware module code has been copied

408
00:18:09,419 --> 00:18:12,080
from the DC right transmitter module

409
00:18:12,080 --> 00:18:15,660
so as we see in that uh this has been

410
00:18:15,660 --> 00:18:18,539
distributed on the league Forum so uh

411
00:18:18,539 --> 00:18:22,200
using that uh Builder uh League Builders

412
00:18:22,200 --> 00:18:24,660
we have seen that this ransomware node

413
00:18:24,660 --> 00:18:27,120
can be you know you can customize the

414
00:18:27,120 --> 00:18:30,059
ransomware node and uh satisfied from

415
00:18:30,059 --> 00:18:33,539
the panel itself and those CNC panel

416
00:18:33,539 --> 00:18:36,000
will control the ransomware and MBR in

417
00:18:36,000 --> 00:18:37,200
Factor module

418
00:18:37,200 --> 00:18:39,480
so here we can see that this is the

419
00:18:39,480 --> 00:18:42,620
ransomware module where uh there is uh

420
00:18:42,620 --> 00:18:45,480
features having MBR encryptor and

421
00:18:45,480 --> 00:18:47,880
decrypter and crypt

422
00:18:47,880 --> 00:18:51,419
so ah in this ransomware module we have

423
00:18:51,419 --> 00:18:54,120
seen two different modules so in both

424
00:18:54,120 --> 00:18:56,160
the modules few things are quite similar

425
00:18:56,160 --> 00:18:57,780
like encrypting the file on the target

426
00:18:57,780 --> 00:19:00,360
machine so both the module will do that

427
00:19:00,360 --> 00:19:03,419
and then it will decrypt the file

428
00:19:03,419 --> 00:19:05,760
remotely from the C2 panel the only

429
00:19:05,760 --> 00:19:08,160
difference is like in the module one it

430
00:19:08,160 --> 00:19:10,799
will drop and execute a decrypter on the

431
00:19:10,799 --> 00:19:12,660
target machine while in module two it

432
00:19:12,660 --> 00:19:15,240
will drop and execute the MBR in Factor

433
00:19:15,240 --> 00:19:17,039
on the target machine so we will discuss

434
00:19:17,039 --> 00:19:19,440
about the MDR in Factor further uh in

435
00:19:19,440 --> 00:19:21,960
the later slides but let's start with

436
00:19:21,960 --> 00:19:25,679
the encryption process so if the machine

437
00:19:25,679 --> 00:19:28,620
is already encrypted it will it will

438
00:19:28,620 --> 00:19:31,679
check the registry key that registry

439
00:19:31,679 --> 00:19:34,320
value is set as encrypted and if the

440
00:19:34,320 --> 00:19:37,200
system is not encrypted already it will

441
00:19:37,200 --> 00:19:40,919
perform certain actions that is like uh

442
00:19:40,919 --> 00:19:43,740
it will pass the ransomware node from

443
00:19:43,740 --> 00:19:45,539
the packet and Generator encryption

444
00:19:45,539 --> 00:19:48,900
password so we have a done some analysis

445
00:19:48,900 --> 00:19:51,660
on the algorithm and seen that it will

446
00:19:51,660 --> 00:19:53,880
create generate almost nearly eight

447
00:19:53,880 --> 00:19:55,320
quadrillion different passwords

448
00:19:55,320 --> 00:19:58,740
combination and further it will send

449
00:19:58,740 --> 00:20:00,840
those encrypted encryption password to

450
00:20:00,840 --> 00:20:05,039
C2 along with the hardware idle and once

451
00:20:05,039 --> 00:20:07,380
during the inscription it will set the

452
00:20:07,380 --> 00:20:10,380
registry key as encryption in progress

453
00:20:10,380 --> 00:20:13,020
so during encryption we have seen that

454
00:20:13,020 --> 00:20:16,200
the module will basically execute three

455
00:20:16,200 --> 00:20:19,020
different functions one is system driver

456
00:20:19,020 --> 00:20:21,960
that is basically you know to encrypt

457
00:20:21,960 --> 00:20:24,660
the C drive and then there is fixed

458
00:20:24,660 --> 00:20:27,660
driver and drivers so this function is

459
00:20:27,660 --> 00:20:30,960
basically used to Target other logical

460
00:20:30,960 --> 00:20:33,240
drives apart from the C drive or system

461
00:20:33,240 --> 00:20:35,760
drive you can call uh just to ignore the

462
00:20:35,760 --> 00:20:37,919
re-encryption of the system Drive

463
00:20:37,919 --> 00:20:40,200
then we have seen that these are the

464
00:20:40,200 --> 00:20:42,120
following Target extension those are

465
00:20:42,120 --> 00:20:46,500
being targeted by the rat and during the

466
00:20:46,500 --> 00:20:49,140
encryption uh it's using basically as

467
00:20:49,140 --> 00:20:50,820
encryption

468
00:20:50,820 --> 00:20:54,480
and once the encryption is done it will

469
00:20:54,480 --> 00:20:57,299
set the registry key as encrypted so we

470
00:20:57,299 --> 00:20:59,299
have also seen that it is using this

471
00:20:59,299 --> 00:21:03,299
extension uh since like some Arabic

472
00:21:03,299 --> 00:21:06,240
language extension so we have the uh we

473
00:21:06,240 --> 00:21:08,580
don't know what exactly it is we also

474
00:21:08,580 --> 00:21:11,299
tried with the Google Translator

475
00:21:11,299 --> 00:21:15,299
so after that uh once the inscription is

476
00:21:15,299 --> 00:21:18,539
done it will basically download a

477
00:21:18,539 --> 00:21:22,620
wallpaper from the mgo.com and set it on

478
00:21:22,620 --> 00:21:26,160
the desktop and after that it will also

479
00:21:26,160 --> 00:21:28,620
uh you know remove the restore point

480
00:21:28,620 --> 00:21:31,219
from the system

481
00:21:31,320 --> 00:21:35,280
so during uh encryption uh after

482
00:21:35,280 --> 00:21:38,700
encryption it will drop and execute a

483
00:21:38,700 --> 00:21:41,820
decrypter also and that decrypter is

484
00:21:41,820 --> 00:21:43,620
actually embedded as a resource in the

485
00:21:43,620 --> 00:21:45,120
ransomware module

486
00:21:45,120 --> 00:21:48,720
so what it does in the decryption so

487
00:21:48,720 --> 00:21:50,640
decrypter basically reads the encrypted

488
00:21:50,640 --> 00:21:52,919
file on the target Machine by checking

489
00:21:52,919 --> 00:21:55,320
the extension of the files and then it

490
00:21:55,320 --> 00:21:57,900
performs uh decryption AES decryption

491
00:21:57,900 --> 00:21:59,400
routine

492
00:21:59,400 --> 00:22:02,280
um using the shaw 256 hash of the

493
00:22:02,280 --> 00:22:03,480
decryption password

494
00:22:03,480 --> 00:22:06,539
and during the decryption process it

495
00:22:06,539 --> 00:22:08,580
will set the registry key as decryption

496
00:22:08,580 --> 00:22:10,679
in progress and once the decryption is

497
00:22:10,679 --> 00:22:12,900
completed it will set the registry key

498
00:22:12,900 --> 00:22:14,640
as decrypted

499
00:22:14,640 --> 00:22:17,640
so ah as we have earlier talked about

500
00:22:17,640 --> 00:22:20,100
the second module which is MBR in Factor

501
00:22:20,100 --> 00:22:23,340
so in this module what it does is

502
00:22:23,340 --> 00:22:27,419
instead of decrypter it will drop MBR uh

503
00:22:27,419 --> 00:22:30,360
and execute it so what it does is MBR

504
00:22:30,360 --> 00:22:34,679
first overwrite the first 512 bytes of

505
00:22:34,679 --> 00:22:38,520
MBR with the ransomware node and during

506
00:22:38,520 --> 00:22:40,679
the end of this process it will also

507
00:22:40,679 --> 00:22:44,220
cause blue blue screen of death and we

508
00:22:44,220 --> 00:22:46,740
have also noticed that this MBR in

509
00:22:46,740 --> 00:22:48,919
Factor will only work in the Legacy

510
00:22:48,919 --> 00:22:52,020
operating system but not in the latest

511
00:22:52,020 --> 00:22:54,360
operating system

512
00:22:54,360 --> 00:22:55,380
so

513
00:22:55,380 --> 00:22:57,120
um during our investigation we have also

514
00:22:57,120 --> 00:22:58,919
found that this mbrn factor is again

515
00:22:58,919 --> 00:23:01,500
copied and modified from uh open source

516
00:23:01,500 --> 00:23:04,020
project that is named as cryline version

517
00:23:04,020 --> 00:23:07,500
5.0 we have found it on the GitHub

518
00:23:07,500 --> 00:23:09,960
so with that I will hand it over to

519
00:23:09,960 --> 00:23:13,580
Nirmal to conclude our presentation

520
00:23:14,520 --> 00:23:17,820
yeah so what we discussed was the top

521
00:23:17,820 --> 00:23:22,020
rats in the starting so I mean as I

522
00:23:22,020 --> 00:23:24,240
mentioned what is on the top can change

523
00:23:24,240 --> 00:23:27,179
easily because like uh the malware

524
00:23:27,179 --> 00:23:30,059
landscape is depends on multiple things

525
00:23:30,059 --> 00:23:33,299
like if there is any new uh threat

526
00:23:33,299 --> 00:23:35,460
coming or any new feature coming that

527
00:23:35,460 --> 00:23:37,740
any other app can provide so malware

528
00:23:37,740 --> 00:23:40,260
groups they will start using it

529
00:23:40,260 --> 00:23:42,840
and we have also seen and we have shown

530
00:23:42,840 --> 00:23:45,600
examples that now malware authors they

531
00:23:45,600 --> 00:23:47,580
use cracked versions they use the code

532
00:23:47,580 --> 00:23:49,980
from different malware families this

533
00:23:49,980 --> 00:23:51,900
which is together and then they drive

534
00:23:51,900 --> 00:23:55,380
new valuations so we think like in a

535
00:23:55,380 --> 00:23:57,240
future we would see these kind of

536
00:23:57,240 --> 00:23:59,400
malwarees which would have you know

537
00:23:59,400 --> 00:24:01,440
multiple capabilities stealing

538
00:24:01,440 --> 00:24:03,360
capabilities and encryption and all of

539
00:24:03,360 --> 00:24:06,419
those and with the other changes in the

540
00:24:06,419 --> 00:24:08,700
threat landscape including you know uh

541
00:24:08,700 --> 00:24:11,520
political things or uh technology

542
00:24:11,520 --> 00:24:13,740
changes we think like I mean in new

543
00:24:13,740 --> 00:24:15,960
future we would see uh some always

544
00:24:15,960 --> 00:24:18,299
having more capabilities and combination

545
00:24:18,299 --> 00:24:21,360
of other amalware types just to increase

546
00:24:21,360 --> 00:24:24,199
the value

547
00:24:24,840 --> 00:24:26,940
yeah I think that's it from our side

548
00:24:26,940 --> 00:24:29,780
thank you very much

549
00:24:36,419 --> 00:24:37,980
thank you

550
00:24:37,980 --> 00:24:41,720
so do we have any questions

551
00:24:48,440 --> 00:24:51,679
over there

552
00:25:00,360 --> 00:25:02,880
did you look at the possibilities to

553
00:25:02,880 --> 00:25:05,039
recover actually the

554
00:25:05,039 --> 00:25:10,020
over the MBR records like 500 gold bytes

555
00:25:10,020 --> 00:25:11,880
what other disabilities like if you

556
00:25:11,880 --> 00:25:13,380
don't want to pay Ransom

557
00:25:13,380 --> 00:25:16,919
did you consider those so you know as we

558
00:25:16,919 --> 00:25:19,020
mentioned it will only work on the

559
00:25:19,020 --> 00:25:24,059
Legacy uh booting system uh so we were

560
00:25:24,059 --> 00:25:26,640
we haven't tested it like it will we

561
00:25:26,640 --> 00:25:29,159
will be able to decrypt the MBR or not

562
00:25:29,159 --> 00:25:32,580
but it will only work on the Legacy not

563
00:25:32,580 --> 00:25:35,658
on the latest one

564
00:25:41,279 --> 00:25:43,740
okay no more questions

565
00:25:43,740 --> 00:25:46,140
one two three

566
00:25:46,140 --> 00:25:49,100
It's a larger

567
00:25:50,159 --> 00:25:52,200
okay thank you very much

568
00:25:52,200 --> 00:25:54,799
thank you

569
00:25:59,779 --> 00:26:02,960
thank you

