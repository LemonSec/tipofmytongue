1
00:00:00,000 --> 00:00:06,420
there we go<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right hmm</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> guarantee</font>

2
00:00:04,440 --> 00:00:09,030
I'm the last talk of the day thank<font color="#E5E5E5"> you</font>

3
00:00:06,420 --> 00:00:13,110
<font color="#E5E5E5">everybody for sticking around</font><font color="#CCCCCC"> my name is</font>

4
00:00:09,030 --> 00:00:16,070
Robert Simmons<font color="#E5E5E5"> and I am the director of</font>

5
00:00:13,110 --> 00:00:18,810
<font color="#E5E5E5">research innovation at threat connect</font>

6
00:00:16,070 --> 00:00:23,029
<font color="#E5E5E5">were</font><font color="#CCCCCC"> based out of Arlington Virginia</font><font color="#E5E5E5"> so</font>

7
00:00:18,810 --> 00:00:27,390
this is not a local company<font color="#CCCCCC"> to</font><font color="#E5E5E5"> France</font>

8
00:00:23,029 --> 00:00:30,210
but I also go by<font color="#CCCCCC"> the nickname loot</font>

9
00:00:27,390 --> 00:00:32,668
<font color="#CCCCCC">kano's which is duckbill platypus</font><font color="#E5E5E5"> in</font>

10
00:00:30,210 --> 00:00:36,450
<font color="#CCCCCC">russian</font><font color="#E5E5E5"> and that actually goes back to</font><font color="#CCCCCC"> a</font>

11
00:00:32,668 --> 00:00:39,540
nickname I got from when I was learning

12
00:00:36,450 --> 00:00:42,059
Russian<font color="#E5E5E5"> in college and they made us pick</font>

13
00:00:39,540 --> 00:00:44,160
a Russian name for while<font color="#CCCCCC"> we're in class</font>

14
00:00:42,059 --> 00:00:45,750
and so I<font color="#CCCCCC"> think if</font><font color="#E5E5E5"> they're any Russian</font>

15
00:00:44,160 --> 00:00:49,559
speakers you'll get the joke here my

16
00:00:45,750 --> 00:00:54,510
name was Alexander<font color="#CCCCCC"> Chiba dashkevich you</font>

17
00:00:49,559 --> 00:00:57,750
<font color="#CCCCCC">know so</font><font color="#E5E5E5"> so a couple of laughs maybe</font><font color="#CCCCCC"> so</font>

18
00:00:54,510 --> 00:01:02,099
to start off I<font color="#E5E5E5"> want to go over some</font>

19
00:00:57,750 --> 00:01:03,420
<font color="#CCCCCC">basic definitions first and so what</font>

20
00:01:02,100 --> 00:01:06,060
we're<font color="#CCCCCC"> gonna talk</font><font color="#E5E5E5"> about today is</font>

21
00:01:03,420 --> 00:01:08,330
developing<font color="#E5E5E5"> a program of threat</font>

22
00:01:06,060 --> 00:01:11,010
<font color="#CCCCCC">intelligence and so ways to do hunting</font>

23
00:01:08,330 --> 00:01:13,229
to find threats to actually feed a

24
00:01:11,010 --> 00:01:14,760
threat intelligence program<font color="#E5E5E5"> so there are</font>

25
00:01:13,229 --> 00:01:16,979
a<font color="#E5E5E5"> couple of different types of threat</font>

26
00:01:14,760 --> 00:01:19,250
<font color="#CCCCCC">intelligence</font><font color="#E5E5E5"> there is tactical threat</font>

27
00:01:16,979 --> 00:01:21,830
intelligence so this is based<font color="#E5E5E5"> on</font>

28
00:01:19,250 --> 00:01:24,600
learning<font color="#E5E5E5"> the attack patterns or the</font>

29
00:01:21,830 --> 00:01:26,908
TTP's of an attacker attacker

30
00:01:24,600 --> 00:01:29,189
methodology is their tools and<font color="#CCCCCC"> their</font>

31
00:01:26,909 --> 00:01:31,560
tactics<font color="#CCCCCC"> that's not what we're gonna be</font>

32
00:01:29,189 --> 00:01:33,449
<font color="#E5E5E5">talking about</font><font color="#CCCCCC"> today specifically</font><font color="#E5E5E5"> there's</font>

33
00:01:31,560 --> 00:01:35,600
also operational threat intelligence

34
00:01:33,450 --> 00:01:38,520
which is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> details of a specific</font>

35
00:01:35,600 --> 00:01:40,500
incoming attack<font color="#CCCCCC"> you know you could</font>

36
00:01:38,520 --> 00:01:43,590
develop this type<font color="#CCCCCC"> of operational threat</font>

37
00:01:40,500 --> 00:01:46,140
intelligence by looking at chat log

38
00:01:43,590 --> 00:01:47,700
captures<font color="#E5E5E5"> looking at forums and this sort</font>

39
00:01:46,140 --> 00:01:50,549
<font color="#E5E5E5">of thing</font><font color="#CCCCCC"> this is also not</font><font color="#E5E5E5"> what we're</font>

40
00:01:47,700 --> 00:01:52,290
going<font color="#CCCCCC"> to be talking about</font><font color="#E5E5E5"> today and</font><font color="#CCCCCC"> then</font>

41
00:01:50,549 --> 00:01:54,659
you<font color="#CCCCCC"> have strategic threat intelligence</font>

42
00:01:52,290 --> 00:01:58,820
which is<font color="#E5E5E5"> high level threat intelligence</font>

43
00:01:54,659 --> 00:02:01,680
which can involve risk<font color="#E5E5E5"> and looking at</font>

44
00:01:58,820 --> 00:02:04,199
changing risk and this<font color="#E5E5E5"> is the type</font><font color="#CCCCCC"> of</font>

45
00:02:01,680 --> 00:02:07,350
intelligence<font color="#CCCCCC"> which is</font><font color="#E5E5E5"> basically aimed at</font>

46
00:02:04,200 --> 00:02:09,509
management<font color="#E5E5E5"> and aimed at the upper levels</font>

47
00:02:07,350 --> 00:02:12,120
of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> company so they</font><font color="#E5E5E5"> can make</font>

48
00:02:09,508 --> 00:02:13,380
strategic<font color="#CCCCCC"> decisions but</font><font color="#E5E5E5"> today we're</font>

49
00:02:12,120 --> 00:02:16,200
going<font color="#E5E5E5"> to be talking about</font><font color="#CCCCCC"> technical</font>

50
00:02:13,380 --> 00:02:18,870
threat intelligence which is indicators

51
00:02:16,200 --> 00:02:20,760
of<font color="#CCCCCC"> compromised</font><font color="#E5E5E5"> gathering data from</font>

52
00:02:18,870 --> 00:02:23,520
various<font color="#CCCCCC"> sources</font><font color="#E5E5E5"> in the operational</font>

53
00:02:20,760 --> 00:02:26,160
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> and then you know baking</font>

54
00:02:23,520 --> 00:02:29,130
them down into<font color="#E5E5E5"> threat intelligence that</font>

55
00:02:26,160 --> 00:02:32,070
you can then either publish<font color="#E5E5E5"> or use</font>

56
00:02:29,130 --> 00:02:35,700
inside<font color="#E5E5E5"> of</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> own organization so I</font>

57
00:02:32,070 --> 00:02:37,769
know this<font color="#E5E5E5"> is one of the government</font>

58
00:02:35,700 --> 00:02:39,810
<font color="#E5E5E5">slides where it has not</font><font color="#CCCCCC"> Evert you know</font>

59
00:02:37,770 --> 00:02:42,120
it's not<font color="#E5E5E5"> a very good</font><font color="#CCCCCC"> picture but</font><font color="#E5E5E5"> it's</font>

60
00:02:39,810 --> 00:02:44,330
<font color="#E5E5E5">very effective in exactly telling you</font>

61
00:02:42,120 --> 00:02:47,790
exactly<font color="#E5E5E5"> what the intelligence process is</font>

62
00:02:44,330 --> 00:02:50,490
<font color="#E5E5E5">so you have planning and planning and</font>

63
00:02:47,790 --> 00:02:53,100
direction<font color="#E5E5E5"> and then you have collection</font>

64
00:02:50,490 --> 00:02:55,770
<font color="#CCCCCC">the next stage is where you process and</font>

65
00:02:53,100 --> 00:02:57,780
exploit the intelligence<font color="#CCCCCC"> the next stage</font>

66
00:02:55,770 --> 00:03:00,360
is<font color="#CCCCCC"> going through analysis and production</font>

67
00:02:57,780 --> 00:03:02,900
<font color="#CCCCCC">and then dissemination</font><font color="#E5E5E5"> you know sending</font>

68
00:03:00,360 --> 00:03:07,950
out reports or delivering reports<font color="#E5E5E5"> to</font>

69
00:03:02,900 --> 00:03:10,050
your customer<font color="#CCCCCC"> or to your superiors so</font>

70
00:03:07,950 --> 00:03:15,119
another way to look<font color="#CCCCCC"> at the intelligence</font>

71
00:03:10,050 --> 00:03:17,190
process<font color="#E5E5E5"> is by focusing</font><font color="#CCCCCC"> the data that you</font>

72
00:03:15,120 --> 00:03:19,430
get<font color="#CCCCCC"> from your operational environment</font>

73
00:03:17,190 --> 00:03:22,440
down to something<font color="#CCCCCC"> that can be consumed</font>

74
00:03:19,430 --> 00:03:25,350
<font color="#E5E5E5">and you know interpreted in the form of</font>

75
00:03:22,440 --> 00:03:28,950
intelligence<font color="#E5E5E5"> so one of the</font><font color="#CCCCCC"> lenses that</font>

76
00:03:25,350 --> 00:03:30,540
<font color="#CCCCCC">you</font><font color="#E5E5E5"> use is collection so you have lots</font>

77
00:03:28,950 --> 00:03:32,970
of<font color="#E5E5E5"> information out in the operational</font>

78
00:03:30,540 --> 00:03:35,280
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> you collect some</font>

79
00:03:32,970 --> 00:03:37,020
amount of it<font color="#E5E5E5"> and then you have the data</font>

80
00:03:35,280 --> 00:03:40,170
<font color="#E5E5E5">that you've</font><font color="#CCCCCC"> collected</font><font color="#E5E5E5"> you have another</font>

81
00:03:37,020 --> 00:03:42,810
lens that you<font color="#CCCCCC"> process and exploit that</font>

82
00:03:40,170 --> 00:03:46,049
<font color="#E5E5E5">information that data that data down to</font>

83
00:03:42,810 --> 00:03:49,380
information and then you have analysts

84
00:03:46,050 --> 00:03:51,420
<font color="#E5E5E5">that look at the data and analyze</font><font color="#CCCCCC"> it and</font>

85
00:03:49,380 --> 00:03:56,310
<font color="#E5E5E5">produce intelligence from that</font>

86
00:03:51,420 --> 00:03:58,890
information<font color="#E5E5E5"> so there's a there's a</font>

87
00:03:56,310 --> 00:04:01,740
concept from<font color="#E5E5E5"> david rocco's pyramid of</font>

88
00:03:58,890 --> 00:04:04,160
pain<font color="#E5E5E5"> where the different you know</font>

89
00:04:01,740 --> 00:04:06,750
different<font color="#E5E5E5"> levels of the pyramid of pain</font>

90
00:04:04,160 --> 00:04:10,049
<font color="#E5E5E5">when you take this away</font><font color="#CCCCCC"> from the</font>

91
00:04:06,750 --> 00:04:13,110
adversary<font color="#E5E5E5"> it you know kind of equals how</font>

92
00:04:10,050 --> 00:04:16,799
bad how bad<font color="#CCCCCC"> of damage you're going to do</font>

93
00:04:13,110 --> 00:04:18,840
to<font color="#E5E5E5"> that adversaries campaign or you know</font>

94
00:04:16,798 --> 00:04:22,260
whatever<font color="#CCCCCC"> that</font><font color="#E5E5E5"> whatever they're targeting</font>

95
00:04:18,839 --> 00:04:24,150
at that particular<font color="#E5E5E5"> point</font><font color="#CCCCCC"> so hash values</font>

96
00:04:22,260 --> 00:04:26,070
are<font color="#E5E5E5"> very easy for an adversary to change</font>

97
00:04:24,150 --> 00:04:27,270
you can just<font color="#CCCCCC"> reap</font>

98
00:04:26,070 --> 00:04:28,980
you know recompile your malware

99
00:04:27,270 --> 00:04:32,310
recompile your implant whatever you want

100
00:04:28,980 --> 00:04:35,100
to call it<font color="#CCCCCC"> and you</font><font color="#E5E5E5"> get a new hash value</font>

101
00:04:32,310 --> 00:04:37,860
<font color="#E5E5E5">which you know is you know then not</font>

102
00:04:35,100 --> 00:04:40,980
detected<font color="#E5E5E5"> you can go for some of</font><font color="#CCCCCC"> the more</font>

103
00:04:37,860 --> 00:04:44,340
<font color="#CCCCCC">difficult or you know targeted hash</font>

104
00:04:40,980 --> 00:04:47,250
values like an import hash<font color="#E5E5E5"> etc</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> still</font>

105
00:04:44,340 --> 00:04:49,049
<font color="#CCCCCC">still hash value you can adjust your</font><font color="#E5E5E5"> you</font>

106
00:04:47,250 --> 00:04:52,230
can adjust<font color="#CCCCCC"> your build and</font><font color="#E5E5E5"> then evade</font>

107
00:04:49,050 --> 00:04:55,110
<font color="#E5E5E5">things that work on hash values then IP</font>

108
00:04:52,230 --> 00:04:56,610
addresses IP<font color="#E5E5E5"> addresses are very cheap</font>

109
00:04:55,110 --> 00:04:59,880
you<font color="#E5E5E5"> can move around from an IP address</font>

110
00:04:56,610 --> 00:05:01,770
<font color="#E5E5E5">to another IP address very easily</font><font color="#CCCCCC"> you</font>

111
00:04:59,880 --> 00:05:03,690
know taking<font color="#CCCCCC"> away a particular IP address</font>

112
00:05:01,770 --> 00:05:05,760
on a virtual<font color="#E5E5E5"> private server or something</font>

113
00:05:03,690 --> 00:05:10,440
<font color="#CCCCCC">like that</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> very painful for</font><font color="#CCCCCC"> the</font>

114
00:05:05,760 --> 00:05:12,930
adversary<font color="#E5E5E5"> to to correct for then domain</font>

115
00:05:10,440 --> 00:05:14,820
names as we've seen<font color="#E5E5E5"> you know domain</font>

116
00:05:12,930 --> 00:05:17,070
names there's a lot of domain<font color="#E5E5E5"> generation</font>

117
00:05:14,820 --> 00:05:19,500
algorithms out<font color="#E5E5E5"> there</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> now</font>

118
00:05:17,070 --> 00:05:21,330
you know adversaries will you know

119
00:05:19,500 --> 00:05:24,230
create domain names but domain the

120
00:05:21,330 --> 00:05:26,490
domain name space<font color="#CCCCCC"> is smaller</font><font color="#E5E5E5"> and so</font>

121
00:05:24,230 --> 00:05:29,070
finding it finding<font color="#CCCCCC"> a new domain</font><font color="#E5E5E5"> name</font>

122
00:05:26,490 --> 00:05:31,620
<font color="#E5E5E5">once one</font><font color="#CCCCCC"> has been taken away</font><font color="#E5E5E5"> actually</font>

123
00:05:29,070 --> 00:05:34,380
takes<font color="#CCCCCC"> some form of</font><font color="#E5E5E5"> money unless you're</font>

124
00:05:31,620 --> 00:05:37,020
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use something like free nom TK</font>

125
00:05:34,380 --> 00:05:38,520
where you get free<font color="#E5E5E5"> domain names but for</font>

126
00:05:37,020 --> 00:05:40,469
the<font color="#E5E5E5"> most</font><font color="#CCCCCC"> part you have</font><font color="#E5E5E5"> to actually spend</font>

127
00:05:38,520 --> 00:05:43,229
money so there is a there<font color="#CCCCCC"> is a</font>

128
00:05:40,470 --> 00:05:44,880
bottleneck there and then network and

129
00:05:43,230 --> 00:05:48,420
host<font color="#CCCCCC"> artifact</font><font color="#E5E5E5"> so this is actually</font>

130
00:05:44,880 --> 00:05:51,540
looking<font color="#E5E5E5"> at signatures that you can find</font>

131
00:05:48,420 --> 00:05:53,970
on a host or signatures<font color="#E5E5E5"> that you can</font>

132
00:05:51,540 --> 00:05:56,190
detect<font color="#E5E5E5"> on a network so this would be</font>

133
00:05:53,970 --> 00:05:57,920
something along<font color="#CCCCCC"> lines</font><font color="#E5E5E5"> of a signature for</font>

134
00:05:56,190 --> 00:06:00,440
<font color="#E5E5E5">a host-based intrusion detection system</font>

135
00:05:57,920 --> 00:06:03,210
<font color="#CCCCCC">network intrusion detection system</font>

136
00:06:00,440 --> 00:06:05,580
<font color="#E5E5E5">signatures of various types and then</font>

137
00:06:03,210 --> 00:06:09,659
figuring<font color="#E5E5E5"> out a</font><font color="#CCCCCC"> particular tool so</font>

138
00:06:05,580 --> 00:06:12,300
finding finding<font color="#E5E5E5"> the the</font><font color="#CCCCCC"> attack pattern</font>

139
00:06:09,660 --> 00:06:14,910
involving a particular malware family

140
00:06:12,300 --> 00:06:16,950
and understanding and being able<font color="#CCCCCC"> to</font>

141
00:06:14,910 --> 00:06:18,630
detect<font color="#E5E5E5"> that malware family that you know</font>

142
00:06:16,950 --> 00:06:21,450
<font color="#E5E5E5">taking that</font><font color="#CCCCCC"> away from an adversary is</font>

143
00:06:18,630 --> 00:06:24,840
very challenging<font color="#CCCCCC"> and then taking away an</font>

144
00:06:21,450 --> 00:06:29,010
entire attack pattern or a TTP is the

145
00:06:24,840 --> 00:06:30,419
toughest<font color="#CCCCCC"> thing to</font><font color="#E5E5E5"> do so the concept of</font>

146
00:06:29,010 --> 00:06:33,360
what I'm going<font color="#CCCCCC"> to share</font><font color="#E5E5E5"> with you today</font>

147
00:06:30,420 --> 00:06:35,520
is a process I know we've watched a lot

148
00:06:33,360 --> 00:06:38,100
<font color="#CCCCCC">of very technical talks this talk is</font><font color="#E5E5E5"> not</font>

149
00:06:35,520 --> 00:06:38,799
<font color="#CCCCCC">going to be the very technical this is</font>

150
00:06:38,100 --> 00:06:42,250
going to be more

151
00:06:38,800 --> 00:06:44,830
<font color="#E5E5E5">or process-driven and I want to actually</font>

152
00:06:42,250 --> 00:06:48,250
<font color="#E5E5E5">share the</font><font color="#CCCCCC"> process with everyone because</font>

153
00:06:44,830 --> 00:06:51,068
I think the inverse<font color="#CCCCCC"> pyramid of pain</font><font color="#E5E5E5"> if</font>

154
00:06:48,250 --> 00:06:54,550
you<font color="#E5E5E5"> consider the things that we as</font>

155
00:06:51,069 --> 00:06:57,159
defenders of<font color="#E5E5E5"> a network develop the most</font>

156
00:06:54,550 --> 00:06:58,900
difficult thing for<font color="#E5E5E5"> the most effective</font>

157
00:06:57,159 --> 00:07:01,240
thing for us to<font color="#CCCCCC"> share and the most</font>

158
00:06:58,900 --> 00:07:03,969
<font color="#E5E5E5">difficult thing for us</font><font color="#CCCCCC"> to develop</font><font color="#E5E5E5"> is</font>

159
00:07:01,240 --> 00:07:07,659
processes<font color="#E5E5E5"> so I would say the inverse of</font>

160
00:07:03,970 --> 00:07:10,770
a TTP up there tough is developing a an

161
00:07:07,659 --> 00:07:14,680
effective process<font color="#CCCCCC"> down at</font><font color="#E5E5E5"> the bottom so</font>

162
00:07:10,770 --> 00:07:17,198
<font color="#CCCCCC">I want</font><font color="#E5E5E5"> to define the problem that I want</font>

163
00:07:14,680 --> 00:07:20,650
that<font color="#E5E5E5"> that I'm solving or attempting to</font>

164
00:07:17,199 --> 00:07:24,400
solve<font color="#CCCCCC"> first</font><font color="#E5E5E5"> part of the problem is we</font>

165
00:07:20,650 --> 00:07:26,289
<font color="#E5E5E5">all have small teams</font><font color="#CCCCCC"> well some of</font><font color="#E5E5E5"> us are</font>

166
00:07:24,400 --> 00:07:29,979
<font color="#CCCCCC">lucky and have a large team but most of</font>

167
00:07:26,289 --> 00:07:33,219
<font color="#E5E5E5">us are small teams</font><font color="#CCCCCC"> my team</font><font color="#E5E5E5"> is a team</font><font color="#CCCCCC"> of</font>

168
00:07:29,979 --> 00:07:35,590
<font color="#CCCCCC">10</font><font color="#E5E5E5"> and also hi Eric I'm sure you're out</font>

169
00:07:33,219 --> 00:07:38,560
<font color="#CCCCCC">there</font><font color="#E5E5E5"> watching this slide did say team</font>

170
00:07:35,590 --> 00:07:40,780
of<font color="#CCCCCC"> 9 before</font><font color="#E5E5E5"> last week so we had a new</font>

171
00:07:38,560 --> 00:07:43,840
hire so he's<font color="#E5E5E5"> just joined us in the past</font>

172
00:07:40,780 --> 00:07:46,679
week<font color="#CCCCCC"> but we're still a team</font><font color="#E5E5E5"> of 10 which</font>

173
00:07:43,840 --> 00:07:49,508
<font color="#CCCCCC">is a small team you need</font><font color="#E5E5E5"> to be able to</font>

174
00:07:46,680 --> 00:07:52,000
compete and<font color="#E5E5E5"> fight above your weight</font>

175
00:07:49,509 --> 00:07:55,090
class<font color="#E5E5E5"> and so to be able to</font><font color="#CCCCCC"> do that you</font>

176
00:07:52,000 --> 00:07:58,599
have<font color="#E5E5E5"> to use automation and intelligent</font>

177
00:07:55,090 --> 00:08:00,940
efficient processes so the second part

178
00:07:58,599 --> 00:08:04,360
of the<font color="#E5E5E5"> problem is you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> limited</font>

179
00:08:00,940 --> 00:08:06,159
<font color="#E5E5E5">resources</font><font color="#CCCCCC"> so I know a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of a lot of</font>

180
00:08:04,360 --> 00:08:09,159
<font color="#E5E5E5">organizations are representative in this</font>

181
00:08:06,159 --> 00:08:11,770
room you create paid feeds and so you're

182
00:08:09,159 --> 00:08:14,080
<font color="#E5E5E5">generating this large quantity of data</font>

183
00:08:11,770 --> 00:08:16,479
that someone needs to consume<font color="#E5E5E5"> and it's</font>

184
00:08:14,080 --> 00:08:20,050
not<font color="#CCCCCC"> always easy to consume this large</font>

185
00:08:16,479 --> 00:08:21,758
quantity of data you<font color="#E5E5E5"> have you know paid</font>

186
00:08:20,050 --> 00:08:23,469
feeds you have open source<font color="#E5E5E5"> intelligence</font>

187
00:08:21,759 --> 00:08:26,610
feeds<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you might just collect from</font>

188
00:08:23,469 --> 00:08:29,289
various sources on the<font color="#E5E5E5"> internet and so</font>

189
00:08:26,610 --> 00:08:31,240
<font color="#E5E5E5">depending on the quality</font><font color="#CCCCCC"> of the feed and</font>

190
00:08:29,289 --> 00:08:34,598
how many you're bringing in<font color="#E5E5E5"> there might</font>

191
00:08:31,240 --> 00:08:37,510
be a high signal-to-noise ratio on<font color="#CCCCCC"> that</font>

192
00:08:34,599 --> 00:08:39,789
particular feed<font color="#E5E5E5"> it might be you know</font>

193
00:08:37,510 --> 00:08:42,659
<font color="#E5E5E5">there might be false</font><font color="#CCCCCC"> positives</font><font color="#E5E5E5"> some are</font>

194
00:08:39,789 --> 00:08:45,850
better at false positives<font color="#E5E5E5"> and others</font><font color="#CCCCCC"> etc</font>

195
00:08:42,659 --> 00:08:49,180
<font color="#E5E5E5">and then also another limited resource</font>

196
00:08:45,850 --> 00:08:51,810
is your tools that you're using and your

197
00:08:49,180 --> 00:08:54,660
time so when you have

198
00:08:51,810 --> 00:08:57,989
<font color="#CCCCCC">a automated malware analysis system</font><font color="#E5E5E5"> you</font>

199
00:08:54,660 --> 00:09:00,000
have a limited<font color="#CCCCCC"> amount of you know time</font>

200
00:08:57,990 --> 00:09:02,300
that that system<font color="#E5E5E5"> can be running and it</font>

201
00:09:00,000 --> 00:09:06,330
has<font color="#CCCCCC"> a limited amount</font><font color="#E5E5E5"> of resources</font><font color="#CCCCCC"> so</font>

202
00:09:02,300 --> 00:09:08,130
there are only n files that you can<font color="#CCCCCC"> an</font>

203
00:09:06,330 --> 00:09:10,500
<font color="#CCCCCC">analyzed with an automated malware</font>

204
00:09:08,130 --> 00:09:13,439
<font color="#E5E5E5">analysis system so you have to</font><font color="#CCCCCC"> actually</font>

205
00:09:10,500 --> 00:09:15,510
figure<font color="#E5E5E5"> out</font><font color="#CCCCCC"> a way to</font><font color="#E5E5E5"> maximize the</font>

206
00:09:13,440 --> 00:09:19,760
utilization<font color="#E5E5E5"> of the tools that you have</font>

207
00:09:15,510 --> 00:09:22,680
<font color="#E5E5E5">available and then the third part is</font>

208
00:09:19,760 --> 00:09:24,900
limited time so if you<font color="#CCCCCC"> have a team of</font>

209
00:09:22,680 --> 00:09:28,050
analysts<font color="#E5E5E5"> you don't want that team of</font>

210
00:09:24,900 --> 00:09:29,850
<font color="#E5E5E5">analysts doing manual labor</font><font color="#CCCCCC"> you don't</font>

211
00:09:28,050 --> 00:09:31,770
want them just moving data around you

212
00:09:29,850 --> 00:09:34,529
want them spending<font color="#CCCCCC"> as much time</font><font color="#E5E5E5"> as</font>

213
00:09:31,770 --> 00:09:36,870
possible<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> their primary job which</font>

214
00:09:34,529 --> 00:09:42,150
is analyzing malware and analyzing

215
00:09:36,870 --> 00:09:45,180
threats so this is the this<font color="#E5E5E5"> is a couple</font>

216
00:09:42,150 --> 00:09:49,199
of<font color="#CCCCCC"> swimlanes that represent</font><font color="#E5E5E5"> what my team</font>

217
00:09:45,180 --> 00:09:51,540
was<font color="#E5E5E5"> doing at the</font><font color="#CCCCCC"> beginning of</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know</font>

218
00:09:49,200 --> 00:09:54,990
when<font color="#E5E5E5"> I first arrived at threat connect</font>

219
00:09:51,540 --> 00:09:56,280
and this is a couple years<font color="#CCCCCC"> ago and by</font>

220
00:09:54,990 --> 00:09:57,870
the<font color="#E5E5E5"> way just to give you a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of</font>

221
00:09:56,280 --> 00:10:00,480
<font color="#E5E5E5">background the talk that you're seeing</font>

222
00:09:57,870 --> 00:10:03,660
<font color="#E5E5E5">today is actually an evolution</font><font color="#CCCCCC"> of a talk</font>

223
00:10:00,480 --> 00:10:07,170
that<font color="#CCCCCC"> I have given in the past I first</font>

224
00:10:03,660 --> 00:10:10,530
gave this with rich Barger<font color="#E5E5E5"> back at</font><font color="#CCCCCC"> Sand</font>

225
00:10:07,170 --> 00:10:12,390
<font color="#E5E5E5">CTI Summit in Alexandria</font><font color="#CCCCCC"> Virginia quite</font>

226
00:10:10,530 --> 00:10:16,380
a<font color="#E5E5E5"> few years ago and so this is an</font>

227
00:10:12,390 --> 00:10:17,939
evolution<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that same process but and I</font>

228
00:10:16,380 --> 00:10:19,260
see<font color="#E5E5E5"> people taking</font><font color="#CCCCCC"> pictures of</font><font color="#E5E5E5"> this one</font>

229
00:10:17,940 --> 00:10:22,170
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> not the one you want to take a</font>

230
00:10:19,260 --> 00:10:25,770
picture<font color="#CCCCCC"> of this is the old</font><font color="#E5E5E5"> process so</font>

231
00:10:22,170 --> 00:10:27,180
I've kind<font color="#E5E5E5"> of categorized the left part</font>

232
00:10:25,770 --> 00:10:28,980
<font color="#E5E5E5">of each of these swim lanes as the</font>

233
00:10:27,180 --> 00:10:31,229
things that the analyst has to do

234
00:10:28,980 --> 00:10:33,690
manually and<font color="#E5E5E5"> then the stuff on the right</font>

235
00:10:31,230 --> 00:10:36,570
<font color="#CCCCCC">is</font><font color="#E5E5E5"> something that a computer or a system</font>

236
00:10:33,690 --> 00:10:39,930
is<font color="#E5E5E5"> doing for the analyst and so on the</font>

237
00:10:36,570 --> 00:10:44,220
<font color="#CCCCCC">left-hand side</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Yarra hunting</font>

238
00:10:39,930 --> 00:10:46,319
which we do<font color="#CCCCCC"> our particular location for</font>

239
00:10:44,220 --> 00:10:48,029
doing<font color="#CCCCCC"> your hunting is virustotal which</font>

240
00:10:46,320 --> 00:10:50,970
<font color="#CCCCCC">I'm sure a</font><font color="#E5E5E5"> lot of you also do hunting</font>

241
00:10:48,029 --> 00:10:52,589
there as well but the the concept here

242
00:10:50,970 --> 00:10:56,100
<font color="#E5E5E5">is actually not restricted to virustotal</font>

243
00:10:52,589 --> 00:10:58,620
<font color="#E5E5E5">it's using</font><font color="#CCCCCC"> Yarra</font><font color="#E5E5E5"> to actually take a body</font>

244
00:10:56,100 --> 00:11:01,380
of<font color="#CCCCCC"> yar rules and a stream of files and</font>

245
00:10:58,620 --> 00:11:03,300
<font color="#CCCCCC">then take the results from them</font><font color="#E5E5E5"> so you</font>

246
00:11:01,380 --> 00:11:04,360
have to update<font color="#E5E5E5"> the rule</font><font color="#CCCCCC"> tech rule sets</font>

247
00:11:03,300 --> 00:11:07,209
in

248
00:11:04,360 --> 00:11:09,160
<font color="#E5E5E5">files so of course</font><font color="#CCCCCC"> you know one of</font><font color="#E5E5E5"> the</font>

249
00:11:07,209 --> 00:11:11,050
main problems is you<font color="#E5E5E5"> have a whole</font><font color="#CCCCCC"> bunch</font>

250
00:11:09,160 --> 00:11:13,000
of<font color="#E5E5E5"> rules and where do you how do you</font>

251
00:11:11,050 --> 00:11:14,500
keep them organized so problem that's a

252
00:11:13,000 --> 00:11:17,620
problem number one here<font color="#E5E5E5"> that I</font>

253
00:11:14,500 --> 00:11:19,120
identified<font color="#E5E5E5"> and then you have to copy and</font>

254
00:11:17,620 --> 00:11:19,920
paste<font color="#E5E5E5"> them to deploy them out to</font>

255
00:11:19,120 --> 00:11:22,510
virustotal

256
00:11:19,920 --> 00:11:24,420
<font color="#CCCCCC">and then you have the virus total</font>

257
00:11:22,510 --> 00:11:26,769
hunting system that gives you a bunch<font color="#E5E5E5"> of</font>

258
00:11:24,420 --> 00:11:28,750
notifications<font color="#E5E5E5"> and then you have to</font><font color="#CCCCCC"> look</font>

259
00:11:26,769 --> 00:11:31,120
<font color="#CCCCCC">through the notification emails I</font>

260
00:11:28,750 --> 00:11:33,579
understand that it is<font color="#CCCCCC"> available via API</font>

261
00:11:31,120 --> 00:11:35,680
and we'll<font color="#E5E5E5"> get into that</font><font color="#CCCCCC"> but you know</font>

262
00:11:33,579 --> 00:11:37,329
most people<font color="#E5E5E5"> are just</font><font color="#CCCCCC"> reading</font><font color="#E5E5E5"> through the</font>

263
00:11:35,680 --> 00:11:41,019
emails that<font color="#E5E5E5"> come out and so that's the</font>

264
00:11:37,329 --> 00:11:43,510
terrible way to to work<font color="#E5E5E5"> and then you</font>

265
00:11:41,019 --> 00:11:45,820
have to<font color="#CCCCCC"> download the file upload it to</font>

266
00:11:43,510 --> 00:11:47,350
over here on the sandboxing side you're

267
00:11:45,820 --> 00:11:49,899
then uploading<font color="#E5E5E5"> your sand bought your</font>

268
00:11:47,350 --> 00:11:52,000
file to the sandbox<font color="#CCCCCC"> you then go get</font>

269
00:11:49,899 --> 00:11:54,100
coffee and come back and<font color="#E5E5E5"> it'll be done</font>

270
00:11:52,000 --> 00:11:56,649
and then you look at the sandbox report

271
00:11:54,100 --> 00:11:59,380
<font color="#E5E5E5">and then you have to analyze the sandbox</font>

272
00:11:56,649 --> 00:12:01,570
data<font color="#E5E5E5"> and then write an Intel report</font><font color="#CCCCCC"> so</font>

273
00:11:59,380 --> 00:12:05,500
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> gonna show</font><font color="#E5E5E5"> you in a moment the</font>

274
00:12:01,570 --> 00:12:08,260
improved<font color="#CCCCCC"> workflow</font><font color="#E5E5E5"> but I want to go</font>

275
00:12:05,500 --> 00:12:10,959
<font color="#E5E5E5">in-depth into some of this some of the</font>

276
00:12:08,260 --> 00:12:13,269
problems<font color="#CCCCCC"> that we had</font><font color="#E5E5E5"> so the ways that</font>

277
00:12:10,959 --> 00:12:15,550
<font color="#E5E5E5">you can do it wrong are keeping your</font>

278
00:12:13,269 --> 00:12:17,220
rules on a file server<font color="#CCCCCC"> first of all</font>

279
00:12:15,550 --> 00:12:19,779
that's not<font color="#E5E5E5"> where you are rules belong</font>

280
00:12:17,220 --> 00:12:21,519
<font color="#CCCCCC">having them on some persons laptop and</font>

281
00:12:19,779 --> 00:12:23,740
then that laptop gets lost<font color="#CCCCCC"> because</font>

282
00:12:21,519 --> 00:12:26,709
they've been<font color="#E5E5E5"> working on rules over the</font>

283
00:12:23,740 --> 00:12:28,510
weekend or<font color="#E5E5E5"> something</font><font color="#CCCCCC"> like that if you</font>

284
00:12:26,709 --> 00:12:30,729
have<font color="#CCCCCC"> it spread across</font><font color="#E5E5E5"> lots of people's</font>

285
00:12:28,510 --> 00:12:35,649
laptops<font color="#E5E5E5"> all of these are the wrong way</font>

286
00:12:30,730 --> 00:12:37,930
to do it<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> also for</font><font color="#E5E5E5"> for working</font>

287
00:12:35,649 --> 00:12:39,640
with<font color="#CCCCCC"> ama's downloading files from one</font>

288
00:12:37,930 --> 00:12:42,760
<font color="#E5E5E5">thing and uploading something else is</font>

289
00:12:39,640 --> 00:12:44,769
also<font color="#CCCCCC"> totally doing it</font><font color="#E5E5E5"> wrong</font><font color="#CCCCCC"> and you know</font>

290
00:12:42,760 --> 00:12:46,089
<font color="#CCCCCC">I lift</font><font color="#E5E5E5"> things and I put them</font><font color="#CCCCCC"> down I lift</font>

291
00:12:44,769 --> 00:12:49,329
<font color="#E5E5E5">things up and</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> put them</font><font color="#CCCCCC"> down so you</font>

292
00:12:46,089 --> 00:12:50,740
<font color="#CCCCCC">don't want your analysts doing that</font><font color="#E5E5E5"> you</font>

293
00:12:49,329 --> 00:12:51,729
don't<font color="#CCCCCC"> want them waiting for AMAs to</font>

294
00:12:50,740 --> 00:12:56,380
finish you<font color="#CCCCCC"> want to have everything</font>

295
00:12:51,730 --> 00:12:59,649
queued up in advance<font color="#E5E5E5"> so this is the this</font>

296
00:12:56,380 --> 00:13:01,949
is<font color="#E5E5E5"> the improved version and I think some</font>

297
00:12:59,649 --> 00:13:04,660
<font color="#CCCCCC">people</font><font color="#E5E5E5"> will recognize</font><font color="#CCCCCC"> that there is one</font>

298
00:13:01,949 --> 00:13:07,689
key piece that's still over<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font>

299
00:13:04,660 --> 00:13:10,180
analysts<font color="#CCCCCC"> swimlane here and this is</font>

300
00:13:07,690 --> 00:13:14,350
because virustotal doesn't have a way<font color="#E5E5E5"> to</font>

301
00:13:10,180 --> 00:13:16,630
upload<font color="#E5E5E5"> yaar rules</font><font color="#CCCCCC"> unit via API to their</font>

302
00:13:14,350 --> 00:13:17,350
hunting<font color="#CCCCCC"> system that's a request that</font><font color="#E5E5E5"> I</font>

303
00:13:16,630 --> 00:13:19,300
made long

304
00:13:17,350 --> 00:13:21,790
go which hasn't been<font color="#E5E5E5"> satisfied yet but</font>

305
00:13:19,300 --> 00:13:24,219
if anyone<font color="#CCCCCC"> out there will anyone from</font>

306
00:13:21,790 --> 00:13:28,719
virus<font color="#E5E5E5"> totals here go ahead</font><font color="#CCCCCC"> and take this</font>

307
00:13:24,220 --> 00:13:30,460
as a feature request<font color="#CCCCCC"> but so you</font><font color="#E5E5E5"> download</font>

308
00:13:28,720 --> 00:13:32,880
the download<font color="#E5E5E5"> the rule sets from the</font>

309
00:13:30,460 --> 00:13:35,380
hunting system which was a which was a

310
00:13:32,880 --> 00:13:37,150
feature that<font color="#CCCCCC"> I did request and they did</font>

311
00:13:35,380 --> 00:13:40,000
<font color="#E5E5E5">put in so the the ability</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> download</font>

312
00:13:37,150 --> 00:13:41,620
<font color="#E5E5E5">your rule sets</font><font color="#CCCCCC"> you're welcome that one</font>

313
00:13:40,000 --> 00:13:45,790
is<font color="#E5E5E5"> that's a feature request I put in</font>

314
00:13:41,620 --> 00:13:47,440
<font color="#E5E5E5">years ago</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> virus</font><font color="#CCCCCC"> you then have</font><font color="#E5E5E5"> the</font>

315
00:13:45,790 --> 00:13:49,270
hunting system where<font color="#E5E5E5"> of our sort of</font>

316
00:13:47,440 --> 00:13:51,220
looks for different files that are

317
00:13:49,270 --> 00:13:53,980
submitted<font color="#E5E5E5"> and if they match one of your</font>

318
00:13:51,220 --> 00:13:56,080
rules you get a<font color="#E5E5E5"> notification</font><font color="#CCCCCC"> so we have</font>

319
00:13:53,980 --> 00:13:58,120
a notification prioritization system

320
00:13:56,080 --> 00:14:02,080
which I'll go into<font color="#E5E5E5"> in depth in</font><font color="#CCCCCC"> just a</font>

321
00:13:58,120 --> 00:14:04,090
moment<font color="#CCCCCC"> but</font><font color="#E5E5E5"> you then have</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> take any of</font>

322
00:14:02,080 --> 00:14:05,680
the files that<font color="#E5E5E5"> you're alerted to you</font>

323
00:14:04,090 --> 00:14:08,020
have to download<font color="#E5E5E5"> them from the</font><font color="#CCCCCC"> virus</font>

324
00:14:05,680 --> 00:14:10,120
<font color="#CCCCCC">odel file repository so this is all</font><font color="#E5E5E5"> done</font>

325
00:14:08,020 --> 00:14:11,260
automatically<font color="#E5E5E5"> and then it's all sent</font>

326
00:14:10,120 --> 00:14:13,510
into<font color="#E5E5E5"> the sandbox</font>

327
00:14:11,260 --> 00:14:15,760
you've got the sandbox results after a

328
00:14:13,510 --> 00:14:17,620
certain<font color="#E5E5E5"> period of time</font><font color="#CCCCCC"> and then the</font>

329
00:14:15,760 --> 00:14:19,840
sandbox results along<font color="#E5E5E5"> with the</font>

330
00:14:17,620 --> 00:14:21,730
notification<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the file and any other</font>

331
00:14:19,840 --> 00:14:23,950
tools<font color="#E5E5E5"> that you have available are all</font>

332
00:14:21,730 --> 00:14:26,560
<font color="#E5E5E5">just presented to</font><font color="#CCCCCC"> the analyst</font><font color="#E5E5E5"> and they</font>

333
00:14:23,950 --> 00:14:29,380
can do their work<font color="#CCCCCC"> and all of this gets</font>

334
00:14:26,560 --> 00:14:32,290
<font color="#E5E5E5">done constantly some</font><font color="#CCCCCC"> pieces of this</font>

335
00:14:29,380 --> 00:14:35,920
process occur in the morning so<font color="#E5E5E5"> that our</font>

336
00:14:32,290 --> 00:14:37,959
our team can get<font color="#CCCCCC"> their</font><font color="#E5E5E5"> get their work</font>

337
00:14:35,920 --> 00:14:39,370
done<font color="#CCCCCC"> immediately</font><font color="#E5E5E5"> so the stuff is all</font>

338
00:14:37,960 --> 00:14:42,250
<font color="#CCCCCC">batched</font><font color="#E5E5E5"> out in the morning and then they</font>

339
00:14:39,370 --> 00:14:45,520
have a you<font color="#E5E5E5"> know a number of</font><font color="#CCCCCC"> things that</font>

340
00:14:42,250 --> 00:14:47,620
they can<font color="#CCCCCC"> look at immediately</font><font color="#E5E5E5"> so doing it</font>

341
00:14:45,520 --> 00:14:49,930
right<font color="#CCCCCC"> one</font><font color="#E5E5E5"> of the things</font><font color="#CCCCCC"> you need to</font><font color="#E5E5E5"> do</font>

342
00:14:47,620 --> 00:14:52,450
is keep<font color="#E5E5E5"> your rules in a revision control</font>

343
00:14:49,930 --> 00:14:55,870
system I'm<font color="#E5E5E5"> not telling you to use</font><font color="#CCCCCC"> git if</font>

344
00:14:52,450 --> 00:14:59,170
you like subversion if you like you<font color="#E5E5E5"> know</font>

345
00:14:55,870 --> 00:15:02,170
CVS or something<font color="#E5E5E5"> ancient that's</font><font color="#CCCCCC"> ok too</font>

346
00:14:59,170 --> 00:15:05,110
<font color="#E5E5E5">but</font><font color="#CCCCCC"> keep them all in</font><font color="#E5E5E5"> revision</font><font color="#CCCCCC"> control</font>

347
00:15:02,170 --> 00:15:09,550
that's where rules belong<font color="#CCCCCC"> I especially</font>

348
00:15:05,110 --> 00:15:11,260
love the<font color="#E5E5E5"> git blame feature so you know</font>

349
00:15:09,550 --> 00:15:13,180
if you've<font color="#CCCCCC"> got a</font><font color="#E5E5E5"> bunch of people</font><font color="#CCCCCC"> working</font>

350
00:15:11,260 --> 00:15:14,890
on rules and something you know

351
00:15:13,180 --> 00:15:17,050
something<font color="#E5E5E5"> changes and</font>

352
00:15:14,890 --> 00:15:18,310
all of a<font color="#CCCCCC"> sudden you're not</font><font color="#E5E5E5"> detecting</font>

353
00:15:17,050 --> 00:15:21,370
something<font color="#E5E5E5"> that you think</font><font color="#CCCCCC"> you should be</font>

354
00:15:18,310 --> 00:15:23,560
you can<font color="#E5E5E5"> figure out and get to find blame</font>

355
00:15:21,370 --> 00:15:26,230
as to who it was<font color="#CCCCCC"> that check that</font><font color="#E5E5E5"> thing</font>

356
00:15:23,560 --> 00:15:29,589
in so these things are good get blame is

357
00:15:26,230 --> 00:15:31,209
great<font color="#E5E5E5"> but this</font><font color="#CCCCCC"> also lets you have</font>

358
00:15:29,590 --> 00:15:34,420
deployment<font color="#E5E5E5"> scripts so</font>

359
00:15:31,209 --> 00:15:36,878
that when when you do a commit<font color="#CCCCCC"> when you</font>

360
00:15:34,420 --> 00:15:39,939
<font color="#E5E5E5">check in that code in</font><font color="#CCCCCC"> your revision</font>

361
00:15:36,879 --> 00:15:43,240
control<font color="#CCCCCC"> you can also kick off a script</font>

362
00:15:39,939 --> 00:15:45,099
that<font color="#E5E5E5"> can be</font><font color="#CCCCCC"> and if you think about it</font>

363
00:15:43,240 --> 00:15:49,379
you're<font color="#CCCCCC"> basically using the same paradigm</font>

364
00:15:45,100 --> 00:15:52,809
<font color="#E5E5E5">that web authors use where they</font><font color="#CCCCCC"> do</font>

365
00:15:49,379 --> 00:15:55,749
deployments<font color="#E5E5E5"> and changes do do to commit</font>

366
00:15:52,809 --> 00:15:58,300
log messages that they that they add and

367
00:15:55,749 --> 00:16:01,329
so commit log messages can kick off a

368
00:15:58,300 --> 00:16:04,179
<font color="#E5E5E5">process and so the</font><font color="#CCCCCC"> process I'm using</font>

369
00:16:01,329 --> 00:16:06,670
here is<font color="#E5E5E5"> that it deploys the the rules</font>

370
00:16:04,179 --> 00:16:09,100
<font color="#CCCCCC">that were changed</font><font color="#E5E5E5"> into whatever</font><font color="#CCCCCC"> you're</font>

371
00:16:06,670 --> 00:16:11,939
<font color="#E5E5E5">hunting system you're</font><font color="#CCCCCC"> using it at that</font>

372
00:16:09,100 --> 00:16:13,720
time so it<font color="#E5E5E5"> also allows you to sync your</font>

373
00:16:11,939 --> 00:16:16,660
<font color="#E5E5E5">information with</font><font color="#CCCCCC"> the threat intelligence</font>

374
00:16:13,720 --> 00:16:18,790
platform of course<font color="#E5E5E5"> I work for one but</font>

375
00:16:16,660 --> 00:16:20,350
you<font color="#CCCCCC"> could sync it with Miss</font><font color="#E5E5E5"> or any of</font>

376
00:16:18,790 --> 00:16:22,929
the different<font color="#CCCCCC"> various threat</font>

377
00:16:20,350 --> 00:16:28,600
intelligence platforms<font color="#CCCCCC"> I know I'm deep</font>

378
00:16:22,929 --> 00:16:30,309
in<font color="#CCCCCC"> missed territory here</font><font color="#E5E5E5"> so this is this</font>

379
00:16:28,600 --> 00:16:34,480
<font color="#E5E5E5">is actually</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit of the change</font>

380
00:16:30,309 --> 00:16:36,339
format not<font color="#E5E5E5"> necessarily format but kind</font>

381
00:16:34,480 --> 00:16:40,689
of abuse of the format that<font color="#CCCCCC"> I'm using</font>

382
00:16:36,339 --> 00:16:43,480
<font color="#CCCCCC">for doing prioritization and</font><font color="#E5E5E5"> other other</font>

383
00:16:40,689 --> 00:16:47,110
things<font color="#CCCCCC"> so there's a couple</font><font color="#E5E5E5"> of details it</font>

384
00:16:43,480 --> 00:16:49,720
won't be obvious here what I'm doing<font color="#CCCCCC"> but</font>

385
00:16:47,110 --> 00:16:53,049
I'm using the meta sections you assign

386
00:16:49,720 --> 00:16:55,389
priority<font color="#E5E5E5"> and confidence</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> each one of</font>

387
00:16:53,049 --> 00:16:58,839
<font color="#CCCCCC">the rules that we've got deployed</font><font color="#E5E5E5"> this</font>

388
00:16:55,389 --> 00:17:01,119
way<font color="#E5E5E5"> priority and I'll go and depth into</font>

389
00:16:58,839 --> 00:17:04,059
<font color="#E5E5E5">what I mean by priority but it should be</font>

390
00:17:01,119 --> 00:17:06,760
obvious it's how important<font color="#E5E5E5"> this rule is</font>

391
00:17:04,059 --> 00:17:10,809
for your organization<font color="#E5E5E5"> and then</font>

392
00:17:06,760 --> 00:17:13,569
confidence can<font color="#E5E5E5"> be you know judged over</font>

393
00:17:10,809 --> 00:17:16,230
time as to how<font color="#CCCCCC"> good of a rule it is</font>

394
00:17:13,569 --> 00:17:18,609
whether it's high in false positives<font color="#E5E5E5"> or</font>

395
00:17:16,230 --> 00:17:20,319
you know when you first deploy the rule

396
00:17:18,609 --> 00:17:22,148
it's basically the gut feeling of the

397
00:17:20,319 --> 00:17:24,990
<font color="#CCCCCC">analyst as to how good of a job</font><font color="#E5E5E5"> they did</font>

398
00:17:22,148 --> 00:17:27,099
<font color="#E5E5E5">writing the rule</font><font color="#CCCCCC"> sandbox restricted</font>

399
00:17:24,990 --> 00:17:29,890
obviously because you're using

400
00:17:27,099 --> 00:17:31,779
automation to take rules from<font color="#E5E5E5"> you know</font>

401
00:17:29,890 --> 00:17:34,090
take the<font color="#E5E5E5"> output of rules and add that to</font>

402
00:17:31,779 --> 00:17:36,100
<font color="#CCCCCC">sandboxes many automated</font><font color="#E5E5E5"> malware</font>

403
00:17:34,090 --> 00:17:38,260
analysis systems can only handle certain

404
00:17:36,100 --> 00:17:40,570
<font color="#E5E5E5">file types</font><font color="#CCCCCC"> and then there</font><font color="#E5E5E5"> are other file</font>

405
00:17:38,260 --> 00:17:42,429
types that<font color="#E5E5E5"> you might be hunting for that</font>

406
00:17:40,570 --> 00:17:43,510
you would never<font color="#E5E5E5"> want to sandbox like you</font>

407
00:17:42,429 --> 00:17:47,860
would never<font color="#E5E5E5"> want to say</font>

408
00:17:43,510 --> 00:17:50,610
a CSV file<font color="#E5E5E5"> or a text file to</font><font color="#CCCCCC"> a sandbox</font>

409
00:17:47,860 --> 00:17:53,620
that would waste the resources<font color="#CCCCCC"> there so</font>

410
00:17:50,610 --> 00:17:56,500
you can apply sandbox restriction to<font color="#CCCCCC"> the</font>

411
00:17:53,620 --> 00:17:58,600
rules<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then there's another</font><font color="#E5E5E5"> really</font>

412
00:17:56,500 --> 00:18:00,910
<font color="#E5E5E5">interesting detail down there on the</font>

413
00:17:58,600 --> 00:18:04,330
conditions<font color="#CCCCCC"> so I don't know if any of</font><font color="#E5E5E5"> you</font>

414
00:18:00,910 --> 00:18:07,900
deploy rules to<font color="#E5E5E5"> virus</font><font color="#CCCCCC"> Odle</font><font color="#E5E5E5"> or use</font><font color="#CCCCCC"> Yara</font>

415
00:18:04,330 --> 00:18:12,129
<font color="#E5E5E5">on your own but virus</font><font color="#CCCCCC"> Odle has its own</font>

416
00:18:07,900 --> 00:18:15,970
<font color="#CCCCCC">condition language and so what we do is</font>

417
00:18:12,130 --> 00:18:18,580
actually<font color="#E5E5E5"> split the generic</font><font color="#CCCCCC"> Yara language</font>

418
00:18:15,970 --> 00:18:20,740
for conditions and the virus total<font color="#E5E5E5"> on</font>

419
00:18:18,580 --> 00:18:23,110
two<font color="#E5E5E5"> different lines</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that the</font>

420
00:18:20,740 --> 00:18:26,620
automation<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> use to build the</font><font color="#CCCCCC"> our</font>

421
00:18:23,110 --> 00:18:28,990
rules<font color="#E5E5E5"> that go to someone's - you know</font>

422
00:18:26,620 --> 00:18:31,540
someone's analysis system that they're

423
00:18:28,990 --> 00:18:33,130
using locally as opposed to<font color="#E5E5E5"> the analysis</font>

424
00:18:31,540 --> 00:18:35,340
system that they're using<font color="#CCCCCC"> at virus Hodel</font>

425
00:18:33,130 --> 00:18:38,830
<font color="#E5E5E5">you can strip out the virus total</font>

426
00:18:35,340 --> 00:18:42,490
specific in conditions<font color="#E5E5E5"> in an automated</font>

427
00:18:38,830 --> 00:18:44,500
<font color="#E5E5E5">way and you can have one repository</font><font color="#CCCCCC"> of</font>

428
00:18:42,490 --> 00:18:48,790
rules that<font color="#E5E5E5"> get deployed in two different</font>

429
00:18:44,500 --> 00:18:51,610
ways so you know one of the things<font color="#CCCCCC"> you</font>

430
00:18:48,790 --> 00:18:55,000
get<font color="#CCCCCC"> from this is you know you can get an</font>

431
00:18:51,610 --> 00:18:56,800
associate<font color="#CCCCCC"> and</font><font color="#E5E5E5"> associations from a</font>

432
00:18:55,000 --> 00:18:59,260
particular signature<font color="#E5E5E5"> out to different</font>

433
00:18:56,800 --> 00:19:01,300
<font color="#CCCCCC">files</font><font color="#E5E5E5"> that have been caught</font><font color="#CCCCCC"> by this</font>

434
00:18:59,260 --> 00:19:05,590
<font color="#CCCCCC">particular signature</font><font color="#E5E5E5"> this is a pretty</font>

435
00:19:01,300 --> 00:19:07,570
recent one it's<font color="#E5E5E5"> an x-man</font><font color="#CCCCCC"> PDB and these</font>

436
00:19:05,590 --> 00:19:09,669
are some files<font color="#CCCCCC"> that we actually caught</font>

437
00:19:07,570 --> 00:19:13,270
with it<font color="#CCCCCC"> we'll have</font><font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit more</font>

438
00:19:09,670 --> 00:19:16,420
<font color="#E5E5E5">detail in a moment but I want</font><font color="#CCCCCC"> to pause</font>

439
00:19:13,270 --> 00:19:19,950
here<font color="#CCCCCC"> and say that one of</font><font color="#E5E5E5"> the tools that</font>

440
00:19:16,420 --> 00:19:22,930
<font color="#E5E5E5">I've been using</font><font color="#CCCCCC"> recently I found this</font>

441
00:19:19,950 --> 00:19:28,630
<font color="#E5E5E5">sort of semi abandoned library called</font>

442
00:19:22,930 --> 00:19:33,250
<font color="#CCCCCC">ply</font><font color="#E5E5E5"> Yara and it uses ply which is David</font>

443
00:19:28,630 --> 00:19:36,040
David Beasley<font color="#CCCCCC"> de Beezus Python Lexx</font><font color="#E5E5E5"> yak</font>

444
00:19:33,250 --> 00:19:38,710
<font color="#E5E5E5">so it's Lex and yak that has been</font>

445
00:19:36,040 --> 00:19:43,750
implemented<font color="#CCCCCC"> using Python and so this</font>

446
00:19:38,710 --> 00:19:45,720
uses<font color="#E5E5E5"> ply to parse virustotal you know</font>

447
00:19:43,750 --> 00:19:50,650
any type not just virus level but any

448
00:19:45,720 --> 00:19:52,630
any<font color="#E5E5E5"> yard rule format and I actually had</font>

449
00:19:50,650 --> 00:19:55,570
a discussion<font color="#E5E5E5"> with</font><font color="#CCCCCC"> some of the maintainer</font>

450
00:19:52,630 --> 00:19:56,780
<font color="#CCCCCC">of Yarra Python</font><font color="#E5E5E5"> and one of the</font><font color="#CCCCCC"> Reitman</font>

451
00:19:55,570 --> 00:19:59,929
and<font color="#CCCCCC"> I know that you</font>

452
00:19:56,780 --> 00:20:02,270
<font color="#E5E5E5">Python can parse</font><font color="#CCCCCC"> yard rules and then</font>

453
00:19:59,930 --> 00:20:05,180
provide you with the same<font color="#E5E5E5"> information</font>

454
00:20:02,270 --> 00:20:09,010
<font color="#E5E5E5">that I get from play ARRA however it</font>

455
00:20:05,180 --> 00:20:12,320
can't handle<font color="#CCCCCC"> the virus Hodel specific</font>

456
00:20:09,010 --> 00:20:14,030
conditions and so this<font color="#E5E5E5"> player I found</font>

457
00:20:12,320 --> 00:20:16,010
can do every you know<font color="#E5E5E5"> it basically</font>

458
00:20:14,030 --> 00:20:20,060
handles everything<font color="#CCCCCC"> I had</font><font color="#E5E5E5"> to rewrite it</font>

459
00:20:16,010 --> 00:20:24,110
<font color="#E5E5E5">almost from</font><font color="#CCCCCC"> scratch but right now this</font>

460
00:20:20,060 --> 00:20:26,000
<font color="#E5E5E5">is the upstream of it I have a fork of</font>

461
00:20:24,110 --> 00:20:29,750
it on my github<font color="#E5E5E5"> and I've actually been</font>

462
00:20:26,000 --> 00:20:32,390
in<font color="#E5E5E5"> discussions with this projects father</font>

463
00:20:29,750 --> 00:20:35,080
for custody<font color="#E5E5E5"> and so the custody battle</font>

464
00:20:32,390 --> 00:20:38,630
<font color="#CCCCCC">hasn't ended yet but I will</font><font color="#E5E5E5"> get</font>

465
00:20:35,080 --> 00:20:42,560
permission<font color="#CCCCCC"> to upstream</font><font color="#E5E5E5"> all of my changes</font>

466
00:20:38,630 --> 00:20:46,040
to<font color="#E5E5E5"> the main repo probably over the</font>

467
00:20:42,560 --> 00:20:49,250
weekend<font color="#E5E5E5"> so keep keep out keep an eye out</font>

468
00:20:46,040 --> 00:20:53,720
for the changes that<font color="#CCCCCC"> I will be checking</font>

469
00:20:49,250 --> 00:20:55,700
<font color="#E5E5E5">in very soon so I want to pause here</font><font color="#CCCCCC"> and</font>

470
00:20:53,720 --> 00:20:57,190
<font color="#E5E5E5">highlight something because I know a lot</font>

471
00:20:55,700 --> 00:20:59,990
of us work<font color="#CCCCCC"> with open source software</font>

472
00:20:57,190 --> 00:21:00,470
<font color="#CCCCCC">open source software is a really really</font>

473
00:20:59,990 --> 00:21:04,460
<font color="#E5E5E5">good thing</font>

474
00:21:00,470 --> 00:21:07,850
I love open source<font color="#CCCCCC"> but I want to be who</font>

475
00:21:04,460 --> 00:21:10,790
everyone to be good open source citizens

476
00:21:07,850 --> 00:21:13,790
so this is an example<font color="#E5E5E5"> of good open</font>

477
00:21:10,790 --> 00:21:16,129
source citizenry<font color="#CCCCCC"> this is actually taken</font>

478
00:21:13,790 --> 00:21:18,740
from<font color="#E5E5E5"> Netflix's open connect appliance</font>

479
00:21:16,130 --> 00:21:20,750
information page<font color="#E5E5E5"> and it's highlighting</font>

480
00:21:18,740 --> 00:21:23,900
that they use<font color="#CCCCCC"> FreeBSD for all of their</font>

481
00:21:20,750 --> 00:21:24,830
servers<font color="#E5E5E5"> and so I want to make make a</font>

482
00:21:23,900 --> 00:21:27,020
point here

483
00:21:24,830 --> 00:21:29,689
so all code improvements feature

484
00:21:27,020 --> 00:21:32,060
<font color="#E5E5E5">additions and bug</font><font color="#CCCCCC"> fixes contributed are</font>

485
00:21:29,690 --> 00:21:34,100
contributed directly<font color="#E5E5E5"> back to</font><font color="#CCCCCC"> the open</font>

486
00:21:32,060 --> 00:21:35,750
source<font color="#E5E5E5"> community for FreeBSD so they</font>

487
00:21:34,100 --> 00:21:39,409
don't<font color="#E5E5E5"> keep any of these things to</font>

488
00:21:35,750 --> 00:21:41,210
<font color="#CCCCCC">themselves and you know if you've got</font>

489
00:21:39,410 --> 00:21:43,340
something<font color="#CCCCCC"> that you're using and then</font>

490
00:21:41,210 --> 00:21:45,460
<font color="#E5E5E5">you've forked it in</font><font color="#CCCCCC"> github and then</font>

491
00:21:43,340 --> 00:21:48,409
you've made<font color="#CCCCCC"> wonderful improvements to it</font>

492
00:21:45,460 --> 00:21:51,020
why<font color="#E5E5E5"> not take those</font><font color="#CCCCCC"> improvements and</font><font color="#E5E5E5"> do a</font>

493
00:21:48,410 --> 00:21:53,270
pull<font color="#CCCCCC"> request and</font><font color="#E5E5E5"> send that stuff back to</font>

494
00:21:51,020 --> 00:21:55,190
the original project<font color="#CCCCCC"> please do that</font>

495
00:21:53,270 --> 00:21:57,410
<font color="#CCCCCC">don't keep your don't keep your</font>

496
00:21:55,190 --> 00:22:01,310
wonderful changes<font color="#E5E5E5"> and improvements to</font>

497
00:21:57,410 --> 00:22:03,850
yourself so end of that aside<font color="#E5E5E5"> and I'm</font>

498
00:22:01,310 --> 00:22:07,250
going<font color="#E5E5E5"> to show you what payara does</font>

499
00:22:03,850 --> 00:22:08,780
hopefully we've got we thought that

500
00:22:07,250 --> 00:22:10,580
worked<font color="#E5E5E5"> all right good</font>

501
00:22:08,780 --> 00:22:14,450
the demo gods are smiling<font color="#E5E5E5"> up</font>

502
00:22:10,580 --> 00:22:19,240
on my<font color="#E5E5E5"> presentation so as you can</font><font color="#CCCCCC"> see</font>

503
00:22:14,450 --> 00:22:22,820
here this<font color="#E5E5E5"> is this is</font><font color="#CCCCCC"> just a one</font>

504
00:22:19,240 --> 00:22:24,590
<font color="#E5E5E5">particular rule set and so what it</font><font color="#CCCCCC"> does</font>

505
00:22:22,820 --> 00:22:26,539
<font color="#CCCCCC">it breaks the rule it breaks a</font>

506
00:22:24,590 --> 00:22:28,699
particular rule I've got a lot of<font color="#CCCCCC"> rules</font>

507
00:22:26,539 --> 00:22:31,820
<font color="#E5E5E5">in this one rule set this is actually</font>

508
00:22:28,700 --> 00:22:35,090
our<font color="#E5E5E5"> Russia</font><font color="#CCCCCC"> focused</font><font color="#E5E5E5"> rule set</font><font color="#CCCCCC"> but this is</font>

509
00:22:31,820 --> 00:22:37,939
one of<font color="#E5E5E5"> the rules</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Turla rule and so</font>

510
00:22:35,090 --> 00:22:40,309
as you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see it</font><font color="#E5E5E5"> shows you all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

511
00:22:37,940 --> 00:22:44,029
<font color="#E5E5E5">condition terms and it basically</font><font color="#CCCCCC"> payara</font>

512
00:22:40,309 --> 00:22:46,970
coughs up<font color="#E5E5E5"> a Python dictionary which can</font>

513
00:22:44,029 --> 00:22:49,880
then be dumped to JSON<font color="#E5E5E5"> as you like or</font>

514
00:22:46,970 --> 00:22:52,639
used<font color="#E5E5E5"> however you want but</font><font color="#CCCCCC"> it shows you</font>

515
00:22:49,880 --> 00:22:55,039
all<font color="#CCCCCC"> the condition terms it then</font><font color="#E5E5E5"> shows</font>

516
00:22:52,639 --> 00:22:59,449
you<font color="#CCCCCC"> a separate section for the metadata</font>

517
00:22:55,039 --> 00:23:01,970
<font color="#E5E5E5">and here we've got you know the sandbox</font>

518
00:22:59,450 --> 00:23:04,789
restriction for<font color="#E5E5E5"> this one is false</font><font color="#CCCCCC"> this</font>

519
00:23:01,970 --> 00:23:07,490
is<font color="#CCCCCC"> a high priority this is another key</font>

520
00:23:04,789 --> 00:23:09,379
<font color="#E5E5E5">for my team it's whether the whether</font>

521
00:23:07,490 --> 00:23:12,320
this rule is destined for<font color="#E5E5E5"> our Intel</font>

522
00:23:09,380 --> 00:23:15,590
product or not<font color="#CCCCCC"> and then down at the</font>

523
00:23:12,320 --> 00:23:17,600
<font color="#E5E5E5">bottom</font><font color="#CCCCCC"> you've got the and this was this</font>

524
00:23:15,590 --> 00:23:19,908
<font color="#E5E5E5">is</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> I actually added</font><font color="#CCCCCC"> to play</font>

525
00:23:17,600 --> 00:23:21,918
<font color="#CCCCCC">ara it didn't actually give you the</font>

526
00:23:19,909 --> 00:23:23,480
start and<font color="#E5E5E5"> stop lines but it's actually</font>

527
00:23:21,919 --> 00:23:26,539
<font color="#CCCCCC">very valuable</font><font color="#E5E5E5"> when you're looking</font>

528
00:23:23,480 --> 00:23:29,179
<font color="#CCCCCC">through and editing a larger rule set</font><font color="#E5E5E5"> to</font>

529
00:23:26,539 --> 00:23:32,090
know where that particular<font color="#E5E5E5"> rule starts</font>

530
00:23:29,179 --> 00:23:34,070
and stops so I've given<font color="#E5E5E5"> you the start</font>

531
00:23:32,090 --> 00:23:36,678
line<font color="#E5E5E5"> and the stop line so</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can</font>

532
00:23:34,070 --> 00:23:39,830
go<font color="#E5E5E5"> directly to where your rule exists in</font>

533
00:23:36,679 --> 00:23:42,799
your<font color="#E5E5E5"> file and then it breaks out</font>

534
00:23:39,830 --> 00:23:45,740
modifiers<font color="#E5E5E5"> into bricks the strings out</font>

535
00:23:42,799 --> 00:23:49,129
<font color="#E5E5E5">into the modifiers and then the various</font>

536
00:23:45,740 --> 00:23:50,750
strings so you've got the name<font color="#CCCCCC"> of the</font>

537
00:23:49,130 --> 00:23:53,000
the<font color="#CCCCCC"> name of the string</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you're</font>

538
00:23:50,750 --> 00:23:55,909
looking for the value<font color="#E5E5E5"> and then the</font>

539
00:23:53,000 --> 00:23:58,880
various modifiers so you know outside<font color="#E5E5E5"> of</font>

540
00:23:55,909 --> 00:24:00,399
<font color="#CCCCCC">what I'm using ply</font><font color="#E5E5E5"> ara for you know I</font>

541
00:23:58,880 --> 00:24:02,809
would recommend it for<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of other</font>

542
00:24:00,399 --> 00:24:04,668
<font color="#E5E5E5">purposes you could use it for linting</font>

543
00:24:02,809 --> 00:24:07,100
your rules you<font color="#E5E5E5"> could use it</font><font color="#CCCCCC"> for making</font>

544
00:24:04,669 --> 00:24:08,630
<font color="#E5E5E5">sure that they you know</font><font color="#CCCCCC"> you could ingest</font>

545
00:24:07,100 --> 00:24:12,019
rules from somewhere<font color="#CCCCCC"> else</font><font color="#E5E5E5"> and if you've</font>

546
00:24:08,630 --> 00:24:14,210
got a<font color="#CCCCCC"> particular you know</font><font color="#E5E5E5"> if you like</font>

547
00:24:12,019 --> 00:24:17,690
<font color="#E5E5E5">indentation in a certain way</font><font color="#CCCCCC"> you could</font>

548
00:24:14,210 --> 00:24:19,429
have it<font color="#CCCCCC"> output in your way and so</font>

549
00:24:17,690 --> 00:24:20,840
there's you know there's<font color="#E5E5E5"> lots of</font>

550
00:24:19,429 --> 00:24:24,190
<font color="#E5E5E5">different</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> you could</font><font color="#CCCCCC"> use this</font><font color="#E5E5E5"> for</font>

551
00:24:20,840 --> 00:24:24,189
so I<font color="#E5E5E5"> encourage</font><font color="#CCCCCC"> you to check it out</font>

552
00:24:24,230 --> 00:24:31,580
so and by the<font color="#E5E5E5"> way this is a plug for</font>

553
00:24:29,149 --> 00:24:33,678
another<font color="#E5E5E5"> favorite open-source project I</font>

554
00:24:31,580 --> 00:24:37,250
have I<font color="#E5E5E5"> know I was in the workshop here</font>

555
00:24:33,679 --> 00:24:40,370
on Tuesday so thumbs up<font color="#E5E5E5"> for using</font>

556
00:24:37,250 --> 00:24:42,139
Jupiter in the<font color="#E5E5E5"> workshops but yeah</font>

557
00:24:40,370 --> 00:24:46,129
Jupiter is really<font color="#CCCCCC"> awesome what you just</font>

558
00:24:42,139 --> 00:24:47,959
saw there is<font color="#E5E5E5"> notebook programming via</font>

559
00:24:46,130 --> 00:24:50,120
this product called<font color="#CCCCCC"> Jupiter and so</font>

560
00:24:47,960 --> 00:24:54,679
notebook programming is somewhere in

561
00:24:50,120 --> 00:24:56,928
between<font color="#CCCCCC"> a repl</font><font color="#E5E5E5"> and our repl by the way</font>

562
00:24:54,679 --> 00:24:59,179
is the medical<font color="#E5E5E5"> term</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> when you go to</font>

563
00:24:56,929 --> 00:25:01,549
the<font color="#E5E5E5"> command line</font><font color="#CCCCCC"> you type Python or Perl</font>

564
00:24:59,179 --> 00:25:05,510
<font color="#E5E5E5">the thing that you get at</font><font color="#CCCCCC"> that point is</font>

565
00:25:01,549 --> 00:25:07,970
an repl<font color="#E5E5E5"> and then it's the notebook</font>

566
00:25:05,510 --> 00:25:10,610
programming is basically<font color="#E5E5E5"> somewhere some</font>

567
00:25:07,970 --> 00:25:12,710
happy medium<font color="#CCCCCC"> between an repl and a</font>

568
00:25:10,610 --> 00:25:15,100
monolithic script that you have to<font color="#CCCCCC"> edit</font>

569
00:25:12,710 --> 00:25:18,019
one piece and then rerun<font color="#E5E5E5"> the whole thing</font>

570
00:25:15,100 --> 00:25:20,809
so back to the back<font color="#E5E5E5"> to the core of the</font>

571
00:25:18,019 --> 00:25:24,440
talk so this the the idea here is<font color="#CCCCCC"> to</font>

572
00:25:20,809 --> 00:25:26,899
<font color="#CCCCCC">take the data that's coming</font><font color="#E5E5E5"> out of your</font>

573
00:25:24,440 --> 00:25:29,659
<font color="#E5E5E5">hunting process</font><font color="#CCCCCC"> you know you've got a</font>

574
00:25:26,899 --> 00:25:32,330
whole set<font color="#CCCCCC"> of</font><font color="#E5E5E5"> rules deployed and then the</font>

575
00:25:29,659 --> 00:25:35,510
result of<font color="#E5E5E5"> that rule is a match</font><font color="#CCCCCC"> on a file</font>

576
00:25:32,330 --> 00:25:37,970
<font color="#E5E5E5">and so the you you want to have a</font>

577
00:25:35,510 --> 00:25:40,309
prioritization<font color="#CCCCCC"> queue and so what you're</font>

578
00:25:37,970 --> 00:25:42,590
<font color="#E5E5E5">seeing here is</font><font color="#CCCCCC"> just this is a</font><font color="#E5E5E5"> JavaScript</font>

579
00:25:40,309 --> 00:25:45,350
that my team<font color="#E5E5E5"> has</font><font color="#CCCCCC"> whipped up for you know</font>

580
00:25:42,590 --> 00:25:48,590
priority basically<font color="#E5E5E5"> ordering the output</font>

581
00:25:45,350 --> 00:25:50,240
of our<font color="#CCCCCC"> various rules</font><font color="#E5E5E5"> and I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> show</font>

582
00:25:48,590 --> 00:25:52,309
<font color="#E5E5E5">you I wan type ramas that I would show</font>

583
00:25:50,240 --> 00:25:53,690
you<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the gotchas and</font><font color="#E5E5E5"> problems</font>

584
00:25:52,309 --> 00:25:56,899
<font color="#E5E5E5">that we've identified so this is</font>

585
00:25:53,690 --> 00:25:58,789
actually this particular<font color="#E5E5E5"> queue</font><font color="#CCCCCC"> right</font>

586
00:25:56,899 --> 00:26:00,918
here has a<font color="#E5E5E5"> problem that we've identified</font>

587
00:25:58,789 --> 00:26:05,149
and I'll show<font color="#CCCCCC"> you one of</font><font color="#E5E5E5"> the kind of the</font>

588
00:26:00,919 --> 00:26:07,549
solution<font color="#E5E5E5"> that we've got for it but you</font>

589
00:26:05,149 --> 00:26:09,500
can see<font color="#E5E5E5"> over</font><font color="#CCCCCC"> here that</font><font color="#E5E5E5"> there's a lot</font><font color="#CCCCCC"> of</font>

590
00:26:07,549 --> 00:26:11,210
things that are generic<font color="#E5E5E5"> and that run</font>

591
00:26:09,500 --> 00:26:12,980
<font color="#E5E5E5">right in the middle is probably one that</font>

592
00:26:11,210 --> 00:26:17,299
<font color="#CCCCCC">our team would</font><font color="#E5E5E5"> be very much more</font>

593
00:26:12,980 --> 00:26:19,370
interested in so the apt<font color="#CCCCCC"> ERP in there in</font>

594
00:26:17,299 --> 00:26:21,500
the middle that's a very you know<font color="#E5E5E5"> very</font>

595
00:26:19,370 --> 00:26:24,590
important<font color="#E5E5E5"> one</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> us to look at but</font>

596
00:26:21,500 --> 00:26:27,200
<font color="#E5E5E5">these other ones they're basically TTP</font>

597
00:26:24,590 --> 00:26:30,559
or general signatures which are also

598
00:26:27,200 --> 00:26:32,960
<font color="#CCCCCC">very rich in finding you know finding</font>

599
00:26:30,559 --> 00:26:35,779
bad things but they're probably<font color="#E5E5E5"> not</font><font color="#CCCCCC"> as</font>

600
00:26:32,960 --> 00:26:38,300
high of a priority<font color="#E5E5E5"> so one of the things</font>

601
00:26:35,779 --> 00:26:40,430
that we've that we're implementing

602
00:26:38,300 --> 00:26:42,560
<font color="#CCCCCC">is a lottery queue</font><font color="#E5E5E5"> so you've got the you</font>

603
00:26:40,430 --> 00:26:45,680
<font color="#E5E5E5">have the team you have one team looking</font>

604
00:26:42,560 --> 00:26:47,360
at<font color="#E5E5E5"> or you have the team we don't have</font>

605
00:26:45,680 --> 00:26:50,170
two teams you<font color="#CCCCCC"> have one team looking at</font>

606
00:26:47,360 --> 00:26:53,570
the<font color="#E5E5E5"> output of the very targeted rules</font>

607
00:26:50,170 --> 00:26:57,380
<font color="#CCCCCC">apt you know</font><font color="#E5E5E5"> malware families that are</font>

608
00:26:53,570 --> 00:27:00,110
very specific<font color="#CCCCCC"> or you know very specific</font>

609
00:26:57,380 --> 00:27:02,720
threats and then there's another<font color="#CCCCCC"> Q of</font>

610
00:27:00,110 --> 00:27:03,830
the<font color="#CCCCCC"> lottery Q which is</font><font color="#E5E5E5"> the TT PS and</font>

611
00:27:02,720 --> 00:27:05,810
stuff like that which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> kind of a</font>

612
00:27:03,830 --> 00:27:08,570
<font color="#CCCCCC">grab-bag where you know in between</font>

613
00:27:05,810 --> 00:27:10,460
<font color="#CCCCCC">working on something</font><font color="#E5E5E5"> which takes you a</font>

614
00:27:08,570 --> 00:27:12,200
lot<font color="#CCCCCC"> of time</font><font color="#E5E5E5"> you just go and grab</font>

615
00:27:10,460 --> 00:27:14,030
<font color="#E5E5E5">something</font><font color="#CCCCCC"> from the</font><font color="#E5E5E5"> grab bag which could</font>

616
00:27:12,200 --> 00:27:16,390
be something<font color="#CCCCCC"> very</font><font color="#E5E5E5"> new</font><font color="#CCCCCC"> you could discover</font>

617
00:27:14,030 --> 00:27:18,980
something<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> haven't seen before</font>

618
00:27:16,390 --> 00:27:21,140
<font color="#CCCCCC">but you basically</font><font color="#E5E5E5"> have a lottery</font><font color="#CCCCCC"> queue</font>

619
00:27:18,980 --> 00:27:24,920
where you spend some<font color="#CCCCCC"> time just trying</font><font color="#E5E5E5"> to</font>

620
00:27:21,140 --> 00:27:26,750
<font color="#E5E5E5">trying to win the lottery so one of the</font>

621
00:27:24,920 --> 00:27:31,010
things that we do<font color="#CCCCCC"> after we've got the</font>

622
00:27:26,750 --> 00:27:33,050
the<font color="#CCCCCC"> rules prioritized is in addition to</font>

623
00:27:31,010 --> 00:27:37,010
<font color="#CCCCCC">the high priority and high confidence</font>

624
00:27:33,050 --> 00:27:40,340
<font color="#E5E5E5">and on down</font><font color="#CCCCCC"> there scoring and so you</font>

625
00:27:37,010 --> 00:27:42,470
know we have<font color="#CCCCCC"> our own scoring and weights</font>

626
00:27:40,340 --> 00:27:45,080
for these different good and bad things

627
00:27:42,470 --> 00:27:48,350
<font color="#E5E5E5">but what I would encourage you to do and</font>

628
00:27:45,080 --> 00:27:50,600
our what we<font color="#E5E5E5"> think of as good and bad</font>

629
00:27:48,350 --> 00:27:53,000
might actually not match<font color="#CCCCCC"> up</font><font color="#E5E5E5"> with the</font>

630
00:27:50,600 --> 00:27:55,850
right thing<font color="#CCCCCC"> for</font><font color="#E5E5E5"> your organization but</font>

631
00:27:53,000 --> 00:27:57,620
what you should<font color="#E5E5E5"> do is take you know make</font>

632
00:27:55,850 --> 00:28:00,260
a list of<font color="#CCCCCC"> the things</font><font color="#E5E5E5"> that you would</font><font color="#CCCCCC"> want</font>

633
00:27:57,620 --> 00:28:03,050
<font color="#CCCCCC">to add</font><font color="#E5E5E5"> points</font><font color="#CCCCCC"> to your</font><font color="#E5E5E5"> finding or</font>

634
00:28:00,260 --> 00:28:04,940
subtract points<font color="#E5E5E5"> to</font><font color="#CCCCCC"> your finding and then</font>

635
00:28:03,050 --> 00:28:07,490
you assign weights<font color="#E5E5E5"> to each one of</font><font color="#CCCCCC"> these</font>

636
00:28:04,940 --> 00:28:10,760
and that<font color="#E5E5E5"> way you've got a calculated</font>

637
00:28:07,490 --> 00:28:14,900
weighted score that you can apply<font color="#E5E5E5"> to</font>

638
00:28:10,760 --> 00:28:17,660
<font color="#CCCCCC">each one of the files that</font><font color="#E5E5E5"> match your</font>

639
00:28:14,900 --> 00:28:20,960
your yard rule and at that point you can

640
00:28:17,660 --> 00:28:23,570
<font color="#CCCCCC">then order</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> output in by the</font>

641
00:28:20,960 --> 00:28:25,580
score<font color="#CCCCCC"> and then you could have</font><font color="#E5E5E5"> your team</font>

642
00:28:23,570 --> 00:28:29,899
picking<font color="#E5E5E5"> things off from the top of that</font>

643
00:28:25,580 --> 00:28:32,240
queue<font color="#CCCCCC"> one of the other things here is</font>

644
00:28:29,900 --> 00:28:34,220
we've discovered<font color="#CCCCCC"> that there's a bit of</font>

645
00:28:32,240 --> 00:28:38,680
<font color="#CCCCCC">non-intuitive ordering that</font><font color="#E5E5E5"> you need to</font>

646
00:28:34,220 --> 00:28:42,680
do and the non-intuitive<font color="#E5E5E5"> 'no siz that</font>

647
00:28:38,680 --> 00:28:45,650
<font color="#E5E5E5">instead of having it</font><font color="#CCCCCC"> go from high high</font>

648
00:28:42,680 --> 00:28:47,510
high medium high low etc etc we actually

649
00:28:45,650 --> 00:28:49,970
<font color="#CCCCCC">bump call the low confidence kind</font><font color="#E5E5E5"> of</font>

650
00:28:47,510 --> 00:28:51,030
noisy garbage rules all<font color="#CCCCCC"> the way down to</font>

651
00:28:49,970 --> 00:28:53,540
the<font color="#E5E5E5"> bottom</font>

652
00:28:51,030 --> 00:28:56,399
this actually<font color="#CCCCCC"> saves time and effort and</font>

653
00:28:53,540 --> 00:28:58,710
<font color="#CCCCCC">it</font><font color="#E5E5E5"> doesn't you know it doesn't</font><font color="#CCCCCC"> it it</font>

654
00:28:56,400 --> 00:29:00,420
hasn't<font color="#E5E5E5"> really affected our overall</font>

655
00:28:58,710 --> 00:29:03,470
process and<font color="#E5E5E5"> this has actually improved</font>

656
00:29:00,420 --> 00:29:08,760
the amount of<font color="#E5E5E5"> garbage that that ends up</font>

657
00:29:03,470 --> 00:29:10,320
<font color="#E5E5E5">taking up someone's time so one of the</font>

658
00:29:08,760 --> 00:29:13,230
things<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is where we're</font><font color="#E5E5E5"> gonna hit</font>

659
00:29:10,320 --> 00:29:14,760
<font color="#CCCCCC">some of the more you</font><font color="#E5E5E5"> know business end</font>

660
00:29:13,230 --> 00:29:16,890
of stuff so you need to<font color="#E5E5E5"> have a</font>

661
00:29:14,760 --> 00:29:18,330
prioritization<font color="#E5E5E5"> meeting and you have to</font>

662
00:29:16,890 --> 00:29:22,410
have your<font color="#E5E5E5"> priorities</font><font color="#CCCCCC"> a prioritization</font>

663
00:29:18,330 --> 00:29:25,740
meetings<font color="#E5E5E5"> frequently so you know our our</font>

664
00:29:22,410 --> 00:29:28,650
team prioritizes stuff<font color="#CCCCCC"> you know week to</font>

665
00:29:25,740 --> 00:29:30,420
week<font color="#CCCCCC"> it depends on what you know what</font>

666
00:29:28,650 --> 00:29:31,920
your organization is and what you're

667
00:29:30,420 --> 00:29:33,810
looking<font color="#CCCCCC"> for but you should have a</font>

668
00:29:31,920 --> 00:29:35,910
frequent prioritization meeting where

669
00:29:33,810 --> 00:29:37,590
you<font color="#E5E5E5"> review what</font><font color="#CCCCCC"> it is that you're</font>

670
00:29:35,910 --> 00:29:38,910
<font color="#E5E5E5">looking for what's important for your</font>

671
00:29:37,590 --> 00:29:43,350
<font color="#E5E5E5">team what's important for your</font>

672
00:29:38,910 --> 00:29:45,960
organization<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then last of all you</font>

673
00:29:43,350 --> 00:29:47,580
<font color="#CCCCCC">need to</font><font color="#E5E5E5"> automate</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> AMAs I'm not going</font>

674
00:29:45,960 --> 00:29:49,950
to go into<font color="#E5E5E5"> detail about automating</font>

675
00:29:47,580 --> 00:29:52,110
specific ones<font color="#E5E5E5"> but these are ones that I</font>

676
00:29:49,950 --> 00:29:55,350
personally have<font color="#E5E5E5"> automated myself I'm</font>

677
00:29:52,110 --> 00:29:57,899
familiar<font color="#E5E5E5"> with the API</font><font color="#CCCCCC"> of all of them and</font>

678
00:29:55,350 --> 00:30:00,120
so<font color="#E5E5E5"> actually if you have</font><font color="#CCCCCC"> any of these and</font>

679
00:29:57,900 --> 00:30:03,780
you<font color="#E5E5E5"> want to implement my process please</font>

680
00:30:00,120 --> 00:30:05,669
<font color="#E5E5E5">you know contact me</font><font color="#CCCCCC"> I can</font><font color="#E5E5E5"> help you with</font>

681
00:30:03,780 --> 00:30:08,370
some<font color="#CCCCCC"> of the idiosyncrasies of all of</font>

682
00:30:05,670 --> 00:30:13,700
these<font color="#E5E5E5"> various a mas because every</font><font color="#CCCCCC"> AMA is</font>

683
00:30:08,370 --> 00:30:16,229
kind<font color="#E5E5E5"> of like its own</font><font color="#CCCCCC"> little snowflake</font><font color="#E5E5E5"> so</font>

684
00:30:13,700 --> 00:30:20,250
future work<font color="#CCCCCC"> that I</font><font color="#E5E5E5"> would like to take on</font>

685
00:30:16,230 --> 00:30:23,280
with this particular<font color="#E5E5E5"> project</font><font color="#CCCCCC"> so in</font>

686
00:30:20,250 --> 00:30:25,020
<font color="#CCCCCC">addition to those two values that we saw</font>

687
00:30:23,280 --> 00:30:28,350
earlier which are priority<font color="#E5E5E5"> and</font>

688
00:30:25,020 --> 00:30:31,410
confidence<font color="#CCCCCC"> I have a hypothesis that we</font>

689
00:30:28,350 --> 00:30:32,909
can add another<font color="#E5E5E5"> value</font><font color="#CCCCCC"> and the name of</font><font color="#E5E5E5"> it</font>

690
00:30:31,410 --> 00:30:35,490
<font color="#E5E5E5">doesn't really matter I've just chosen</font>

691
00:30:32,910 --> 00:30:37,770
business value it could be effectiveness

692
00:30:35,490 --> 00:30:41,220
or you know<font color="#E5E5E5"> whatever you want to call it</font>

693
00:30:37,770 --> 00:30:45,510
<font color="#E5E5E5">but</font><font color="#CCCCCC"> a third value</font><font color="#E5E5E5"> and my hypothesis is</font>

694
00:30:41,220 --> 00:30:46,980
<font color="#E5E5E5">that this third value can be you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> we</font>

695
00:30:45,510 --> 00:30:51,030
would have to<font color="#E5E5E5"> toy with how much weight</font>

696
00:30:46,980 --> 00:30:53,700
it gets in the process but<font color="#CCCCCC"> it can be</font>

697
00:30:51,030 --> 00:30:57,270
completely<font color="#CCCCCC"> automated</font><font color="#E5E5E5"> so what you would</font>

698
00:30:53,700 --> 00:31:01,350
do is choose all<font color="#CCCCCC"> of the different you</font>

699
00:30:57,270 --> 00:31:04,530
know steps in your process<font color="#CCCCCC"> which you can</font>

700
00:31:01,350 --> 00:31:06,540
measure the rules successfulness

701
00:31:04,530 --> 00:31:08,670
<font color="#E5E5E5">this actually might be different for</font>

702
00:31:06,540 --> 00:31:11,280
your<font color="#E5E5E5"> organization</font><font color="#CCCCCC"> so if you're</font><font color="#E5E5E5"> just</font>

703
00:31:08,670 --> 00:31:13,200
<font color="#CCCCCC">defending a network you know the the</font>

704
00:31:11,280 --> 00:31:16,260
<font color="#E5E5E5">business value</font><font color="#CCCCCC"> of a particular rule</font>

705
00:31:13,200 --> 00:31:18,990
<font color="#CCCCCC">maybe it effectively blocked something</font>

706
00:31:16,260 --> 00:31:21,390
<font color="#CCCCCC">or it effectively found something that</font>

707
00:31:18,990 --> 00:31:25,110
<font color="#E5E5E5">would not have gone detected otherwise</font>

708
00:31:21,390 --> 00:31:28,380
by a different system<font color="#CCCCCC"> you know so these</font>

709
00:31:25,110 --> 00:31:30,479
particular<font color="#E5E5E5"> steps in my business value</font>

710
00:31:28,380 --> 00:31:32,370
<font color="#E5E5E5">are for my team so I would encourage you</font>

711
00:31:30,480 --> 00:31:34,500
<font color="#E5E5E5">you know once we've got this worked out</font>

712
00:31:32,370 --> 00:31:36,629
and I've done a little bit<font color="#CCCCCC"> more</font>

713
00:31:34,500 --> 00:31:38,850
<font color="#CCCCCC">exploration in here you would</font><font color="#E5E5E5"> want to</font>

714
00:31:36,630 --> 00:31:40,790
choose<font color="#E5E5E5"> a different set that are that</font><font color="#CCCCCC"> are</font>

715
00:31:38,850 --> 00:31:43,590
tuned<font color="#CCCCCC"> to your</font><font color="#E5E5E5"> particular organization</font>

716
00:31:40,790 --> 00:31:47,040
<font color="#CCCCCC">and then give them a scoring</font><font color="#E5E5E5"> weight and</font>

717
00:31:43,590 --> 00:31:49,350
then have<font color="#E5E5E5"> that weight you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> calculate</font>

718
00:31:47,040 --> 00:31:52,260
<font color="#E5E5E5">a business value of low medium</font><font color="#CCCCCC"> or high</font>

719
00:31:49,350 --> 00:31:55,919
<font color="#E5E5E5">which can then be included into your</font>

720
00:31:52,260 --> 00:31:58,290
prioritization process so just<font color="#CCCCCC"> to</font>

721
00:31:55,920 --> 00:32:01,170
explain<font color="#CCCCCC"> these</font><font color="#E5E5E5"> for my organization</font><font color="#CCCCCC"> my</font>

722
00:31:58,290 --> 00:32:03,330
team<font color="#E5E5E5"> the there's a basically a pool of</font>

723
00:32:01,170 --> 00:32:05,930
<font color="#E5E5E5">data coming out of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> are hunting</font>

724
00:32:03,330 --> 00:32:09,270
process<font color="#CCCCCC"> and then the</font><font color="#E5E5E5"> analyst can claim</font>

725
00:32:05,930 --> 00:32:11,750
claim parts of it to analyze<font color="#CCCCCC"> so one of</font>

726
00:32:09,270 --> 00:32:15,240
the one of<font color="#E5E5E5"> these steps would be whether</font>

727
00:32:11,750 --> 00:32:17,010
the output<font color="#CCCCCC"> of a rule</font><font color="#E5E5E5"> was you know pretty</font>

728
00:32:15,240 --> 00:32:20,220
enough to<font color="#CCCCCC"> be</font><font color="#E5E5E5"> claimed by</font><font color="#CCCCCC"> one of the</font>

729
00:32:17,010 --> 00:32:22,410
analysts<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then the data set gets</font>

730
00:32:20,220 --> 00:32:24,630
analyzed so whether the analysts looked

731
00:32:22,410 --> 00:32:26,940
at it and said if this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> garbage and</font>

732
00:32:24,630 --> 00:32:28,920
then just moved on or whether they began

733
00:32:26,940 --> 00:32:32,220
actually analyzing that particular

734
00:32:28,920 --> 00:32:34,710
output<font color="#CCCCCC"> and then once they've analyzed</font>

735
00:32:32,220 --> 00:32:37,920
the output<font color="#E5E5E5"> you know there is a point</font>

736
00:32:34,710 --> 00:32:39,930
where they might go again<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is not</font>

737
00:32:37,920 --> 00:32:41,730
really important or<font color="#E5E5E5"> this is a complete</font>

738
00:32:39,930 --> 00:32:44,130
false positive or<font color="#E5E5E5"> it's garbage and then</font>

739
00:32:41,730 --> 00:32:47,430
<font color="#E5E5E5">they threw that away but the other</font>

740
00:32:44,130 --> 00:32:49,590
<font color="#CCCCCC">option is they've published that</font><font color="#E5E5E5"> into an</font>

741
00:32:47,430 --> 00:32:52,110
intelligence product<font color="#E5E5E5"> and so you know</font>

742
00:32:49,590 --> 00:32:55,080
publication of<font color="#E5E5E5"> that as intelligence is</font>

743
00:32:52,110 --> 00:32:58,379
another<font color="#E5E5E5"> you know plus X for that</font>

744
00:32:55,080 --> 00:33:01,020
particular calculation<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then further</font>

745
00:32:58,380 --> 00:33:04,050
from<font color="#CCCCCC"> that</font><font color="#E5E5E5"> there's the</font><font color="#CCCCCC"> possibility that</font>

746
00:33:01,020 --> 00:33:08,070
<font color="#E5E5E5">this is important enough</font><font color="#CCCCCC"> for it to be</font>

747
00:33:04,050 --> 00:33:10,200
<font color="#E5E5E5">shared widely via blog post or shared in</font>

748
00:33:08,070 --> 00:33:12,659
you know in our common<font color="#E5E5E5"> community inside</font>

749
00:33:10,200 --> 00:33:15,560
<font color="#E5E5E5">of our threat intelligence platform and</font>

750
00:33:12,660 --> 00:33:18,830
then you've got<font color="#E5E5E5"> four</font>

751
00:33:15,560 --> 00:33:21,860
perhaps this drove in our case<font color="#E5E5E5"> drove a</font>

752
00:33:18,830 --> 00:33:24,199
new account<font color="#CCCCCC"> to be created</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> in our</font>

753
00:33:21,860 --> 00:33:26,149
system and then you know the the<font color="#CCCCCC"> Holy</font>

754
00:33:24,200 --> 00:33:29,030
<font color="#CCCCCC">Grail would</font><font color="#E5E5E5"> be that you can</font><font color="#CCCCCC"> actually</font>

755
00:33:26,150 --> 00:33:32,570
kind<font color="#E5E5E5"> of trace the Rube Goldberg drawing</font>

756
00:33:29,030 --> 00:33:36,379
of our intelligence<font color="#E5E5E5"> process from a yard</font>

757
00:33:32,570 --> 00:33:38,240
rule out to a new<font color="#E5E5E5"> customer so that would</font>

758
00:33:36,380 --> 00:33:42,680
be the holy grail<font color="#CCCCCC"> of business value for</font>

759
00:33:38,240 --> 00:33:44,720
us at<font color="#CCCCCC"> least so also</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> things</font>

760
00:33:42,680 --> 00:33:46,640
that<font color="#E5E5E5"> that I encourage</font><font color="#CCCCCC"> when you're when</font>

761
00:33:44,720 --> 00:33:50,270
you<font color="#E5E5E5"> implement a process</font><font color="#CCCCCC"> like this</font><font color="#E5E5E5"> is</font>

762
00:33:46,640 --> 00:33:53,600
keep your bean counters happy<font color="#CCCCCC"> being able</font>

763
00:33:50,270 --> 00:33:56,540
to<font color="#E5E5E5"> maximize the movement of data from</font>

764
00:33:53,600 --> 00:33:58,159
collection to exploitation<font color="#CCCCCC"> and when I</font>

765
00:33:56,540 --> 00:34:00,530
say exploitation I don't mean

766
00:33:58,160 --> 00:34:02,030
exploitation in the<font color="#E5E5E5"> in the terms of</font>

767
00:34:00,530 --> 00:34:04,190
exploiting a vulnerability

768
00:34:02,030 --> 00:34:07,970
I mean exploiting the data and<font color="#E5E5E5"> turning</font>

769
00:34:04,190 --> 00:34:10,130
it into<font color="#CCCCCC"> information and then you need</font><font color="#E5E5E5"> to</font>

770
00:34:07,970 --> 00:34:12,860
collect<font color="#E5E5E5"> metrics on your</font><font color="#CCCCCC"> utilization so</font>

771
00:34:10,130 --> 00:34:16,010
this is<font color="#E5E5E5"> extremely important when budget</font>

772
00:34:12,860 --> 00:34:17,870
time comes around<font color="#CCCCCC"> because I know no one</font>

773
00:34:16,010 --> 00:34:19,840
in<font color="#CCCCCC"> this room has an infinite budget</font>

774
00:34:17,870 --> 00:34:23,899
<font color="#E5E5E5">except for maybe the folks from Google</font>

775
00:34:19,840 --> 00:34:26,690
<font color="#E5E5E5">and so the rest of</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> that don't have an</font>

776
00:34:23,899 --> 00:34:29,080
infinite<font color="#E5E5E5"> budget</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> have to prove</font><font color="#CCCCCC"> that</font>

777
00:34:26,690 --> 00:34:32,060
<font color="#E5E5E5">you</font><font color="#CCCCCC"> are using your resources effectively</font>

778
00:34:29,080 --> 00:34:34,969
<font color="#CCCCCC">year by year so that</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> bee encounters</font>

779
00:34:32,060 --> 00:34:38,270
will say<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> I agree</font><font color="#CCCCCC"> you need more</font>

780
00:34:34,969 --> 00:34:40,428
resources<font color="#CCCCCC"> to the tune of money</font><font color="#E5E5E5"> and so</font>

781
00:34:38,270 --> 00:34:42,770
what you need<font color="#E5E5E5"> to do is first of all</font>

782
00:34:40,429 --> 00:34:45,800
prove<font color="#E5E5E5"> to them that you're using things</font>

783
00:34:42,770 --> 00:34:47,780
like<font color="#E5E5E5"> an AMA maximal capacity</font><font color="#CCCCCC"> and the way</font>

784
00:34:45,800 --> 00:34:50,030
you can do that<font color="#CCCCCC"> is</font><font color="#E5E5E5"> making</font><font color="#CCCCCC"> sure that</font><font color="#E5E5E5"> you</font>

785
00:34:47,780 --> 00:34:52,340
automate<font color="#E5E5E5"> the data going in and then</font>

786
00:34:50,030 --> 00:34:53,929
basically pushing the most amount<font color="#E5E5E5"> of</font>

787
00:34:52,340 --> 00:34:55,790
data to your AMA<font color="#CCCCCC"> that you've got the</font>

788
00:34:53,929 --> 00:34:58,250
<font color="#E5E5E5">resources for and then when you cap</font><font color="#CCCCCC"> it</font>

789
00:34:55,790 --> 00:35:02,690
out you can<font color="#CCCCCC"> actually keep track</font><font color="#E5E5E5"> of your</font>

790
00:34:58,250 --> 00:35:04,400
<font color="#CCCCCC">utilization statistics and come to your</font>

791
00:35:02,690 --> 00:35:06,250
your<font color="#CCCCCC"> bee encounters with a nice graph</font>

792
00:35:04,400 --> 00:35:08,960
saying look we're at<font color="#CCCCCC"> maximum capacity</font>

793
00:35:06,250 --> 00:35:10,940
<font color="#CCCCCC">and then if you give us</font><font color="#E5E5E5"> this more money</font>

794
00:35:08,960 --> 00:35:13,010
<font color="#E5E5E5">we'll be able to add more</font><font color="#CCCCCC"> capacity of</font>

795
00:35:10,940 --> 00:35:14,900
the AMA and<font color="#E5E5E5"> we'll be able to handle</font><font color="#CCCCCC"> the</font>

796
00:35:13,010 --> 00:35:18,740
<font color="#CCCCCC">the load that we've got coming</font><font color="#E5E5E5"> in from</font>

797
00:35:14,900 --> 00:35:20,420
collections<font color="#E5E5E5"> also there's a there's a</font>

798
00:35:18,740 --> 00:35:23,000
term<font color="#CCCCCC"> in here</font><font color="#E5E5E5"> so you need to establish</font>

799
00:35:20,420 --> 00:35:24,380
KPIs and<font color="#CCCCCC"> I know I'm</font><font color="#E5E5E5"> getting really into</font>

800
00:35:23,000 --> 00:35:26,300
the management speak and the business

801
00:35:24,380 --> 00:35:28,820
<font color="#E5E5E5">ask stuff would you have to do that we</font>

802
00:35:26,300 --> 00:35:29,460
<font color="#E5E5E5">are in a business so KPI is a key</font>

803
00:35:28,820 --> 00:35:32,460
<font color="#CCCCCC">performance in</font>

804
00:35:29,460 --> 00:35:34,560
<font color="#CCCCCC">cater and so automating everything in</font>

805
00:35:32,460 --> 00:35:37,320
the way that<font color="#E5E5E5"> I have talked about here in</font>

806
00:35:34,560 --> 00:35:39,630
<font color="#CCCCCC">this</font><font color="#E5E5E5"> process leads you to being able to</font>

807
00:35:37,320 --> 00:35:41,760
<font color="#E5E5E5">develop key performance indicators so a</font>

808
00:35:39,630 --> 00:35:45,119
key<font color="#CCCCCC"> performance indicator is something</font>

809
00:35:41,760 --> 00:35:47,130
that can<font color="#E5E5E5"> be measured on on a schedule so</font>

810
00:35:45,119 --> 00:35:49,650
it<font color="#E5E5E5"> might be measured every day it might</font>

811
00:35:47,130 --> 00:35:51,750
be measured every week but it's

812
00:35:49,650 --> 00:35:54,510
basically a number<font color="#E5E5E5"> of some kind that you</font>

813
00:35:51,750 --> 00:35:56,849
<font color="#E5E5E5">can put up on a wall and you can say oh</font>

814
00:35:54,510 --> 00:35:59,400
hey like the the work that I'm doing now

815
00:35:56,849 --> 00:36:02,010
<font color="#E5E5E5">is I do better work it's actually</font>

816
00:35:59,400 --> 00:36:03,510
shifting that like dial towards green or

817
00:36:02,010 --> 00:36:08,070
<font color="#CCCCCC">whatever it is that you're using as your</font>

818
00:36:03,510 --> 00:36:10,950
<font color="#E5E5E5">KPI so KPIs are important and it's very</font>

819
00:36:08,070 --> 00:36:13,050
very<font color="#E5E5E5"> important to to</font><font color="#CCCCCC"> gather statistics</font>

820
00:36:10,950 --> 00:36:16,348
<font color="#E5E5E5">about the different stages of</font><font color="#CCCCCC"> your</font>

821
00:36:13,050 --> 00:36:17,970
process and apply KPIs<font color="#E5E5E5"> to each stage so</font>

822
00:36:16,349 --> 00:36:23,790
that<font color="#CCCCCC"> you know whether you're</font><font color="#E5E5E5"> being</font>

823
00:36:17,970 --> 00:36:26,129
successful<font color="#E5E5E5"> or not so one of the other</font>

824
00:36:23,790 --> 00:36:29,190
things is where you get<font color="#CCCCCC"> your</font><font color="#E5E5E5"> samples and</font>

825
00:36:26,130 --> 00:36:31,170
so like I said<font color="#E5E5E5"> my team hunts in</font>

826
00:36:29,190 --> 00:36:33,450
different locations one of them being

827
00:36:31,170 --> 00:36:36,000
virustotal but that's not<font color="#E5E5E5"> necessarily</font>

828
00:36:33,450 --> 00:36:38,730
where this process<font color="#CCCCCC"> is</font><font color="#E5E5E5"> required to be</font>

829
00:36:36,000 --> 00:36:42,869
applied<font color="#E5E5E5"> a lot of us are defending a</font>

830
00:36:38,730 --> 00:36:45,330
large organization<font color="#CCCCCC"> and</font><font color="#E5E5E5"> so there</font><font color="#CCCCCC"> are</font>

831
00:36:42,869 --> 00:36:48,390
other places where<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can apply a</font><font color="#CCCCCC"> yarra</font>

832
00:36:45,330 --> 00:36:50,549
hunting<font color="#CCCCCC"> process I've seen Yara</font><font color="#E5E5E5"> spoken</font>

833
00:36:48,390 --> 00:36:52,230
about<font color="#E5E5E5"> in many of the talks this week and</font>

834
00:36:50,550 --> 00:36:54,900
what that's<font color="#E5E5E5"> really awesome</font>

835
00:36:52,230 --> 00:36:56,640
but I can<font color="#E5E5E5"> tell you some of</font><font color="#CCCCCC"> the places</font>

836
00:36:54,900 --> 00:36:59,820
<font color="#E5E5E5">where you</font><font color="#CCCCCC"> want to get data from your own</font>

837
00:36:56,640 --> 00:37:03,629
<font color="#E5E5E5">network so I use bro for carving files</font>

838
00:36:59,820 --> 00:37:07,050
out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> network capture</font><font color="#CCCCCC"> it is fantastic I</font>

839
00:37:03,630 --> 00:37:09,630
love bro<font color="#E5E5E5"> some check some of</font><font color="#CCCCCC"> my other</font>

840
00:37:07,050 --> 00:37:12,119
talks where I go<font color="#CCCCCC"> in-depth into how to</font>

841
00:37:09,630 --> 00:37:14,730
use bro for malware<font color="#E5E5E5"> analysis</font><font color="#CCCCCC"> and not</font>

842
00:37:12,119 --> 00:37:17,760
<font color="#E5E5E5">necessarily for network intrusion</font>

843
00:37:14,730 --> 00:37:20,280
detection<font color="#E5E5E5"> but I would encourage you to</font>

844
00:37:17,760 --> 00:37:22,440
<font color="#CCCCCC">look those up also you can look at</font>

845
00:37:20,280 --> 00:37:24,869
incoming email attachments so if you

846
00:37:22,440 --> 00:37:26,250
have you know<font color="#E5E5E5"> some</font><font color="#CCCCCC"> sort</font><font color="#E5E5E5"> of system on</font>

847
00:37:24,869 --> 00:37:30,210
your mail server which is<font color="#E5E5E5"> pulling</font>

848
00:37:26,250 --> 00:37:33,260
attachments<font color="#CCCCCC"> those that stream</font><font color="#E5E5E5"> of samples</font>

849
00:37:30,210 --> 00:37:36,290
can also be put<font color="#CCCCCC"> through this process</font>

850
00:37:33,260 --> 00:37:38,849
<font color="#CCCCCC">endpoint</font><font color="#E5E5E5"> collection I know that</font><font color="#CCCCCC"> av</font>

851
00:37:36,290 --> 00:37:41,190
<font color="#E5E5E5">quarantine you can get back quarantine</font>

852
00:37:38,849 --> 00:37:42,819
from your endpoints<font color="#CCCCCC"> if you have</font>

853
00:37:41,190 --> 00:37:44,529
<font color="#E5E5E5">something like carbon black</font>

854
00:37:42,819 --> 00:37:46,119
which is<font color="#E5E5E5"> actually pulling any file it</font>

855
00:37:44,529 --> 00:37:49,119
doesn't know<font color="#CCCCCC"> about</font><font color="#E5E5E5"> all of</font><font color="#CCCCCC"> these</font>

856
00:37:46,119 --> 00:37:52,839
different<font color="#E5E5E5"> streams of files can all be</font>

857
00:37:49,119 --> 00:37:55,479
funneled down into one<font color="#E5E5E5"> queue and then</font>

858
00:37:52,839 --> 00:37:57,640
that queue can<font color="#CCCCCC"> be processed with yara</font>

859
00:37:55,479 --> 00:37:59,078
and then the output can have the

860
00:37:57,640 --> 00:38:01,808
<font color="#E5E5E5">prioritization system that I've</font>

861
00:37:59,079 --> 00:38:04,469
described here<font color="#CCCCCC"> applied</font><font color="#E5E5E5"> to it and then</font>

862
00:38:01,809 --> 00:38:06,969
you could<font color="#E5E5E5"> have a small team</font><font color="#CCCCCC"> of people</font>

863
00:38:04,469 --> 00:38:09,339
looking at the output<font color="#CCCCCC"> of this</font><font color="#E5E5E5"> and</font>

864
00:38:06,969 --> 00:38:11,709
hunting<font color="#E5E5E5"> for things that and</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> my</font>

865
00:38:09,339 --> 00:38:14,140
perspective<font color="#CCCCCC"> my</font><font color="#E5E5E5"> team is hunting for new</font>

866
00:38:11,709 --> 00:38:18,038
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> things that</font><font color="#E5E5E5"> we can you know</font>

867
00:38:14,140 --> 00:38:20,439
<font color="#E5E5E5">either publish publicly etc but your</font>

868
00:38:18,039 --> 00:38:24,099
your team might<font color="#CCCCCC"> actually only</font><font color="#E5E5E5"> be</font>

869
00:38:20,439 --> 00:38:26,019
interested<font color="#CCCCCC"> in you know the adversaries</font>

870
00:38:24,099 --> 00:38:27,429
that<font color="#CCCCCC"> you have modeled during your threat</font>

871
00:38:26,019 --> 00:38:30,098
modeling and I hope you do threat

872
00:38:27,429 --> 00:38:31,779
modeling<font color="#E5E5E5"> so once you've done threat</font>

873
00:38:30,099 --> 00:38:33,640
modeling you might be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to narrow the</font>

874
00:38:31,779 --> 00:38:35,949
things that you're<font color="#E5E5E5"> looking for down to</font>

875
00:38:33,640 --> 00:38:39,848
the possibilities of<font color="#CCCCCC"> what</font><font color="#E5E5E5"> you think will</font>

876
00:38:35,949 --> 00:38:42,640
<font color="#E5E5E5">actually be attacking the the resources</font>

877
00:38:39,849 --> 00:38:44,709
in your<font color="#E5E5E5"> organization and so that could</font>

878
00:38:42,640 --> 00:38:47,618
<font color="#CCCCCC">be</font><font color="#E5E5E5"> part</font><font color="#CCCCCC"> of your</font><font color="#E5E5E5"> prioritization process</font>

879
00:38:44,709 --> 00:38:49,989
and then at the speaker dinner the other

880
00:38:47,619 --> 00:38:52,900
night<font color="#E5E5E5"> we</font><font color="#CCCCCC"> actually had a laugh because</font>

881
00:38:49,989 --> 00:38:54,909
one of<font color="#E5E5E5"> the other and this was in the</font>

882
00:38:52,900 --> 00:38:56,829
talk<font color="#E5E5E5"> before we we spoke the other day</font>

883
00:38:54,909 --> 00:38:59,349
<font color="#E5E5E5">but so</font><font color="#CCCCCC"> CCleaner</font>

884
00:38:56,829 --> 00:39:02,289
<font color="#CCCCCC">I know we heard</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> the story of</font>

885
00:38:59,349 --> 00:39:04,119
<font color="#CCCCCC">ccleaner</font><font color="#E5E5E5"> and so you can also take</font><font color="#CCCCCC"> your</font>

886
00:39:02,289 --> 00:39:06,909
<font color="#E5E5E5">supply</font><font color="#CCCCCC"> chain so the files</font><font color="#E5E5E5"> that you've</font>

887
00:39:04,119 --> 00:39:10,269
gotten your supply<font color="#CCCCCC"> chain</font><font color="#E5E5E5"> that you know</font>

888
00:39:06,909 --> 00:39:12,009
you might<font color="#E5E5E5"> trust them but why not funnel</font>

889
00:39:10,269 --> 00:39:13,779
them in so there's a you<font color="#E5E5E5"> know I'm</font>

890
00:39:12,009 --> 00:39:16,269
<font color="#E5E5E5">talking about a</font><font color="#CCCCCC"> process that can take a</font>

891
00:39:13,779 --> 00:39:18,969
large volume of files and narrow it down

892
00:39:16,269 --> 00:39:21,609
<font color="#E5E5E5">to something that is manageable for a</font>

893
00:39:18,969 --> 00:39:24,489
team<font color="#E5E5E5"> so including things that you think</font>

894
00:39:21,609 --> 00:39:27,130
<font color="#E5E5E5">are safe from your from your supply</font>

895
00:39:24,489 --> 00:39:31,119
chain<font color="#CCCCCC"> is a good</font><font color="#E5E5E5"> idea to add to your</font>

896
00:39:27,130 --> 00:39:33,390
hunting system so I want<font color="#E5E5E5"> to go over a</font>

897
00:39:31,119 --> 00:39:39,479
few success stories<font color="#CCCCCC"> that my team</font><font color="#E5E5E5"> has had</font>

898
00:39:33,390 --> 00:39:45,819
recently and so this is<font color="#E5E5E5"> a Casper agent</font>

899
00:39:39,479 --> 00:39:48,189
<font color="#CCCCCC">this is a implant that leverages</font><font color="#E5E5E5"> you</font>

900
00:39:45,819 --> 00:39:49,479
know fake documents<font color="#E5E5E5"> and I'll show you in</font>

901
00:39:48,189 --> 00:39:53,169
<font color="#CCCCCC">just</font><font color="#E5E5E5"> a moment</font><font color="#CCCCCC"> what one of those looks</font>

902
00:39:49,479 --> 00:39:55,910
like but this<font color="#E5E5E5"> is and you know this was</font>

903
00:39:53,169 --> 00:39:59,750
<font color="#E5E5E5">one that was discovered by Palo Alto</font>

904
00:39:55,910 --> 00:40:02,808
<font color="#CCCCCC">skyy etc but</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> actually took some</font><font color="#E5E5E5"> of</font>

905
00:39:59,750 --> 00:40:04,970
the information<font color="#E5E5E5"> from from those earlier</font>

906
00:40:02,809 --> 00:40:07,670
discoveries and then deployed a set of

907
00:40:04,970 --> 00:40:08,509
<font color="#CCCCCC">yar rules that we had</font><font color="#E5E5E5"> built based excuse</font>

908
00:40:07,670 --> 00:40:10,430
me

909
00:40:08,510 --> 00:40:13,069
based on the files that<font color="#CCCCCC"> had been</font>

910
00:40:10,430 --> 00:40:15,288
discovered<font color="#E5E5E5"> before and found you know it</font>

911
00:40:13,069 --> 00:40:17,240
was<font color="#E5E5E5"> sort of like knocking knocking a</font>

912
00:40:15,289 --> 00:40:18,920
hole<font color="#CCCCCC"> in the wall and finding a whole</font>

913
00:40:17,240 --> 00:40:22,669
bunch of<font color="#E5E5E5"> cockroaches back there so we</font>

914
00:40:18,920 --> 00:40:27,319
find you<font color="#E5E5E5"> know a whole raft more of these</font>

915
00:40:22,670 --> 00:40:28,579
attacks<font color="#CCCCCC"> and you know as as everyone has</font>

916
00:40:27,319 --> 00:40:31,009
<font color="#E5E5E5">said a couple times this week</font>

917
00:40:28,579 --> 00:40:32,839
<font color="#CCCCCC">attribution is hard</font><font color="#E5E5E5"> so I'm this</font>

918
00:40:31,010 --> 00:40:35,569
particular one I'm not<font color="#E5E5E5"> going to attempt</font>

919
00:40:32,839 --> 00:40:38,660
to<font color="#E5E5E5"> it attribute it but there's a theme</font>

920
00:40:35,569 --> 00:40:40,279
with the documents<font color="#CCCCCC"> that you'll see</font><font color="#E5E5E5"> at</font>

921
00:40:38,660 --> 00:40:42,680
least you can you can see the

922
00:40:40,280 --> 00:40:45,799
<font color="#E5E5E5">victimology here they're going after</font>

923
00:40:42,680 --> 00:40:47,629
<font color="#E5E5E5">people that</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> interested in Middle</font>

924
00:40:45,799 --> 00:40:52,609
East political affairs Palestinian

925
00:40:47,630 --> 00:40:54,680
Authority Israel<font color="#E5E5E5"> etc and so this is one</font>

926
00:40:52,609 --> 00:40:57,529
of<font color="#E5E5E5"> the this</font><font color="#CCCCCC"> is one of</font><font color="#E5E5E5"> the documents and</font>

927
00:40:54,680 --> 00:41:00,020
<font color="#CCCCCC">by the way this is not like</font><font color="#E5E5E5"> seek you</font>

928
00:40:57,530 --> 00:41:01,549
know secret document<font color="#E5E5E5"> we did check before</font>

929
00:41:00,020 --> 00:41:03,200
we published any of<font color="#E5E5E5"> these to see if</font>

930
00:41:01,549 --> 00:41:05,960
<font color="#E5E5E5">they're available on the open source</font>

931
00:41:03,200 --> 00:41:07,910
<font color="#E5E5E5">already so none of the none of these</font>

932
00:41:05,960 --> 00:41:10,010
documents<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we've published</font><font color="#CCCCCC"> are not</font>

933
00:41:07,910 --> 00:41:12,828
<font color="#E5E5E5">already available just by doing a google</font>

934
00:41:10,010 --> 00:41:14,990
<font color="#CCCCCC">image search so and that's actually</font>

935
00:41:12,829 --> 00:41:16,609
<font color="#CCCCCC">probably exactly what the adversary did</font>

936
00:41:14,990 --> 00:41:18,890
as well they probably did a<font color="#CCCCCC"> google image</font>

937
00:41:16,609 --> 00:41:21,529
<font color="#E5E5E5">search</font><font color="#CCCCCC"> found</font><font color="#E5E5E5"> things that they thought</font>

938
00:41:18,890 --> 00:41:24,078
<font color="#E5E5E5">were you know good bait</font><font color="#CCCCCC"> for their</font>

939
00:41:21,529 --> 00:41:28,039
victims<font color="#E5E5E5"> and then baked that into their</font>

940
00:41:24,079 --> 00:41:34,089
their malware at the same time you know

941
00:41:28,039 --> 00:41:34,089
<font color="#E5E5E5">you can go and look at this didn't load</font>

942
00:41:37,670 --> 00:41:45,950
<font color="#E5E5E5">ha that's a great success story blank</font>

943
00:41:42,049 --> 00:41:48,319
slide<font color="#E5E5E5"> so fail story</font><font color="#CCCCCC"> and the slides but</font>

944
00:41:45,950 --> 00:41:50,779
so I'll I'll just<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> describe what</font>

945
00:41:48,319 --> 00:41:53,420
<font color="#CCCCCC">was there is a multi go drawing</font><font color="#E5E5E5"> a multi</font>

946
00:41:50,779 --> 00:41:55,789
go graph of something that is very

947
00:41:53,420 --> 00:41:57,349
<font color="#CCCCCC">generic that we</font><font color="#E5E5E5"> found but is you know</font>

948
00:41:55,789 --> 00:42:03,289
fairly<font color="#E5E5E5"> important let me see if I can</font>

949
00:41:57,349 --> 00:42:04,490
actually<font color="#CCCCCC"> get</font><font color="#E5E5E5"> that to reload it's not</font>

950
00:42:03,289 --> 00:42:07,970
<font color="#E5E5E5">gonna reload</font><font color="#CCCCCC"> all right</font>

951
00:42:04,490 --> 00:42:09,890
so either way that was<font color="#E5E5E5"> one that I added</font>

952
00:42:07,970 --> 00:42:12,970
<font color="#E5E5E5">this morning so it actually let's see</font>

953
00:42:09,890 --> 00:42:16,210
what is this a try reloading<font color="#E5E5E5"> to reload</font>

954
00:42:12,970 --> 00:42:18,950
no it's not<font color="#E5E5E5"> gonna reload</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so</font>

955
00:42:16,210 --> 00:42:21,440
moving<font color="#E5E5E5"> on this is</font><font color="#CCCCCC"> another success story</font>

956
00:42:18,950 --> 00:42:22,970
so<font color="#E5E5E5"> I've been</font><font color="#CCCCCC"> tracking a particular</font>

957
00:42:21,440 --> 00:42:25,670
adversary Zed

958
00:42:22,970 --> 00:42:29,470
five five six six seven seven for quite

959
00:42:25,670 --> 00:42:32,390
a while<font color="#CCCCCC"> this adversary began years ago</font>

960
00:42:29,470 --> 00:42:36,019
<font color="#CCCCCC">you know spreading aleena</font><font color="#E5E5E5"> point-of-sale</font>

961
00:42:32,390 --> 00:42:38,058
malware<font color="#CCCCCC"> and over the years the the</font>

962
00:42:36,019 --> 00:42:39,229
hunting system that I've<font color="#E5E5E5"> been using has</font>

963
00:42:38,059 --> 00:42:41,299
been feeding<font color="#CCCCCC"> me more and more</font>

964
00:42:39,230 --> 00:42:45,430
<font color="#CCCCCC">information</font><font color="#E5E5E5"> more and more information</font>

965
00:42:41,299 --> 00:42:49,250
<font color="#CCCCCC">about</font><font color="#E5E5E5"> it and then finally you know</font>

966
00:42:45,430 --> 00:42:51,410
<font color="#E5E5E5">myself and a couple of colleagues we</font>

967
00:42:49,250 --> 00:42:53,509
actually had some breakthrough in this

968
00:42:51,410 --> 00:42:56,328
because the<font color="#CCCCCC"> amount of</font><font color="#E5E5E5"> data that</font><font color="#CCCCCC"> I had</font>

969
00:42:53,509 --> 00:42:58,460
collected over<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> about this</font>

970
00:42:56,329 --> 00:43:00,740
particular adversary kind of added up to

971
00:42:58,460 --> 00:43:03,380
the<font color="#CCCCCC"> point where we</font><font color="#E5E5E5"> could say all right</font>

972
00:43:00,740 --> 00:43:05,209
<font color="#E5E5E5">we've figured out like this and this and</font>

973
00:43:03,380 --> 00:43:09,559
<font color="#E5E5E5">these patterns and then finally had a</font>

974
00:43:05,210 --> 00:43:14,119
breakthrough where one of the email

975
00:43:09,559 --> 00:43:17,359
<font color="#E5E5E5">addresses</font><font color="#CCCCCC"> that the adversary used to to</font>

976
00:43:14,119 --> 00:43:20,420
sign up for<font color="#E5E5E5"> to sign up</font><font color="#CCCCCC"> for their</font><font color="#E5E5E5"> Twitter</font>

977
00:43:17,359 --> 00:43:23,960
account<font color="#E5E5E5"> actually had so that the the</font>

978
00:43:20,420 --> 00:43:26,000
<font color="#E5E5E5">Twitter name was the let's see if I get</font>

979
00:43:23,960 --> 00:43:28,670
<font color="#E5E5E5">this right</font><font color="#CCCCCC"> so the</font><font color="#E5E5E5"> Twitter name it's it's</font>

980
00:43:26,000 --> 00:43:31,160
<font color="#CCCCCC">Marella</font><font color="#E5E5E5"> here so the Twitter name had</font>

981
00:43:28,670 --> 00:43:33,140
another Associated Twitter account and

982
00:43:31,160 --> 00:43:35,990
that other<font color="#E5E5E5"> associated Twitter account</font>

983
00:43:33,140 --> 00:43:39,920
the name of<font color="#E5E5E5"> that account</font><font color="#CCCCCC"> happened to</font><font color="#E5E5E5"> be</font>

984
00:43:35,990 --> 00:43:41,479
a password<font color="#E5E5E5"> that</font><font color="#CCCCCC"> showed up in well</font>

985
00:43:39,920 --> 00:43:44,059
actually<font color="#E5E5E5"> not the exact thing but it was</font>

986
00:43:41,480 --> 00:43:47,150
a<font color="#E5E5E5"> variation of the password in the</font>

987
00:43:44,059 --> 00:43:49,460
myspace dump and this was fascinating

988
00:43:47,150 --> 00:43:50,910
<font color="#CCCCCC">because you know if you</font><font color="#E5E5E5"> take the if you</font>

989
00:43:49,460 --> 00:43:53,220
take the information<font color="#E5E5E5"> we</font><font color="#CCCCCC"> had here and</font>

990
00:43:50,910 --> 00:43:57,118
found we<font color="#CCCCCC"> found that password</font><font color="#E5E5E5"> in the</font>

991
00:43:53,220 --> 00:43:59,368
myspace dump and then lo and<font color="#CCCCCC"> behold back</font>

992
00:43:57,119 --> 00:44:02,069
in the day when this adversary was using

993
00:43:59,369 --> 00:44:05,160
MySpace<font color="#CCCCCC"> this was before they had</font><font color="#E5E5E5"> kind of</font>

994
00:44:02,069 --> 00:44:07,200
ratcheted<font color="#E5E5E5"> up</font><font color="#CCCCCC"> their OPSEC and they used</font>

995
00:44:05,160 --> 00:44:08,759
their personal email<font color="#E5E5E5"> address</font><font color="#CCCCCC"> and so we</font>

996
00:44:07,200 --> 00:44:11,279
got<font color="#E5E5E5"> there we got their first and last</font>

997
00:44:08,760 --> 00:44:13,680
name personal email address from from

998
00:44:11,280 --> 00:44:16,260
the registered email<font color="#E5E5E5"> address from the</font>

999
00:44:13,680 --> 00:44:19,319
myspace dump<font color="#E5E5E5"> by going</font><font color="#CCCCCC"> backwards from the</font>

1000
00:44:16,260 --> 00:44:21,089
password<font color="#E5E5E5"> so you know that's</font><font color="#CCCCCC"> an</font>

1001
00:44:19,319 --> 00:44:23,130
interesting interesting success story

1002
00:44:21,089 --> 00:44:26,160
it's not directly<font color="#E5E5E5"> related to our hunting</font>

1003
00:44:23,130 --> 00:44:28,289
process<font color="#E5E5E5"> but the you know the slew thing</font>

1004
00:44:26,160 --> 00:44:30,270
that occurred<font color="#E5E5E5"> wouldn't have happened if</font>

1005
00:44:28,289 --> 00:44:32,069
I hadn't been collecting this body of

1006
00:44:30,270 --> 00:44:35,220
information<font color="#CCCCCC"> over the years using</font><font color="#E5E5E5"> our</font>

1007
00:44:32,069 --> 00:44:36,690
hunting process<font color="#CCCCCC"> looks like we've got</font>

1008
00:44:35,220 --> 00:44:39,569
<font color="#E5E5E5">about eight minutes left I got a couple</font>

1009
00:44:36,690 --> 00:44:41,549
<font color="#E5E5E5">more slides so some of the ten minutes</font>

1010
00:44:39,569 --> 00:44:43,650
left<font color="#E5E5E5"> good all right so some of the key</font>

1011
00:44:41,549 --> 00:44:46,410
takeaways here<font color="#CCCCCC"> that I'd like you to have</font>

1012
00:44:43,650 --> 00:44:48,990
are making sure that you organize your

1013
00:44:46,410 --> 00:44:52,200
signatures in<font color="#E5E5E5"> revision control and this</font>

1014
00:44:48,990 --> 00:44:54,839
doesn't<font color="#CCCCCC"> necessarily apply to only Yarra</font>

1015
00:44:52,200 --> 00:44:56,700
signatures if you've got bro scripts if

1016
00:44:54,839 --> 00:44:58,859
you've got<font color="#E5E5E5"> various types of signatures</font>

1017
00:44:56,700 --> 00:45:01,049
if you look at them<font color="#CCCCCC"> they're texts and</font>

1018
00:44:58,859 --> 00:45:02,819
they look like code<font color="#E5E5E5"> treat them like code</font>

1019
00:45:01,049 --> 00:45:05,069
they need to be<font color="#CCCCCC"> room they need</font><font color="#E5E5E5"> to have</font>

1020
00:45:02,819 --> 00:45:08,520
revisions<font color="#CCCCCC"> keep them in a</font><font color="#E5E5E5"> revision</font>

1021
00:45:05,069 --> 00:45:11,670
control system<font color="#CCCCCC"> also make sure that you</font>

1022
00:45:08,520 --> 00:45:13,920
apply automation<font color="#E5E5E5"> between systems in your</font>

1023
00:45:11,670 --> 00:45:16,380
<font color="#E5E5E5">tool chain don't make your</font><font color="#CCCCCC"> analysts take</font>

1024
00:45:13,920 --> 00:45:18,930
the output from<font color="#CCCCCC"> one thing</font><font color="#E5E5E5"> and then pivot</font>

1025
00:45:16,380 --> 00:45:21,690
to another thing<font color="#E5E5E5"> without some form of</font>

1026
00:45:18,930 --> 00:45:25,799
automation<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> make them work and that</font>

1027
00:45:21,690 --> 00:45:27,029
way also<font color="#E5E5E5"> one of the other takeaways and</font>

1028
00:45:25,799 --> 00:45:29,520
<font color="#E5E5E5">this is a more recent one</font><font color="#CCCCCC"> that we've</font>

1029
00:45:27,029 --> 00:45:32,579
kind of come to the conclusion of is

1030
00:45:29,520 --> 00:45:35,549
have separate<font color="#E5E5E5"> queues for signature type</font>

1031
00:45:32,579 --> 00:45:37,319
<font color="#E5E5E5">so if you've got attack pattern</font><font color="#CCCCCC"> queue if</font>

1032
00:45:35,549 --> 00:45:39,750
you've got attack pattern signatures or

1033
00:45:37,319 --> 00:45:43,410
TTP's<font color="#E5E5E5"> and I'll give you an example of</font>

1034
00:45:39,750 --> 00:45:46,920
<font color="#CCCCCC">this</font><font color="#E5E5E5"> so you</font><font color="#CCCCCC"> know dot the the file ending</font>

1035
00:45:43,410 --> 00:45:49,649
is<font color="#E5E5E5"> PDF DXE so that's a very generic sort</font>

1036
00:45:46,920 --> 00:45:51,299
<font color="#E5E5E5">of attack pattern type of signature so</font>

1037
00:45:49,650 --> 00:45:53,010
you want to have those separated<font color="#E5E5E5"> from</font>

1038
00:45:51,299 --> 00:45:55,470
your<font color="#CCCCCC"> malware family and your adversary</font>

1039
00:45:53,010 --> 00:45:57,630
based signatures<font color="#CCCCCC"> so that you can have</font>

1040
00:45:55,470 --> 00:45:59,038
two queues and<font color="#E5E5E5"> the one that I kind of</font>

1041
00:45:57,630 --> 00:46:01,410
called the attack pattern<font color="#E5E5E5"> queue the</font>

1042
00:45:59,039 --> 00:46:03,670
lottery<font color="#CCCCCC"> so you know it's kind of a</font>

1043
00:46:01,410 --> 00:46:07,180
<font color="#CCCCCC">grab-bag as to what you're going to</font><font color="#E5E5E5"> get</font>

1044
00:46:03,670 --> 00:46:09,630
and then you want to<font color="#E5E5E5"> have remember to</font>

1045
00:46:07,180 --> 00:46:12,339
have periodic prioritization meetings

1046
00:46:09,630 --> 00:46:14,200
<font color="#CCCCCC">and then this</font><font color="#E5E5E5"> is not even like a</font>

1047
00:46:12,340 --> 00:46:15,700
security<font color="#CCCCCC"> takeaway</font><font color="#E5E5E5"> this is just one of</font>

1048
00:46:14,200 --> 00:46:17,980
<font color="#E5E5E5">those things that</font><font color="#CCCCCC"> I want to hammer home</font>

1049
00:46:15,700 --> 00:46:20,049
<font color="#E5E5E5">when you're</font><font color="#CCCCCC"> making</font><font color="#E5E5E5"> changes to an open</font>

1050
00:46:17,980 --> 00:46:22,480
<font color="#E5E5E5">source project</font><font color="#CCCCCC"> send your changes</font>

1051
00:46:20,050 --> 00:46:25,060
upstream<font color="#E5E5E5"> send them back</font><font color="#CCCCCC"> to the people</font>

1052
00:46:22,480 --> 00:46:26,800
<font color="#CCCCCC">that wrote the project make</font><font color="#E5E5E5"> sure that</font>

1053
00:46:25,060 --> 00:46:33,460
you and<font color="#E5E5E5"> that's the best way to share</font>

1054
00:46:26,800 --> 00:46:35,470
your wonderful<font color="#E5E5E5"> patches to the code so I</font>

1055
00:46:33,460 --> 00:46:38,410
hope that<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> implement this</font>

1056
00:46:35,470 --> 00:46:39,129
particular<font color="#E5E5E5"> process you don't end up like</font>

1057
00:46:38,410 --> 00:46:41,109
this

1058
00:46:39,130 --> 00:46:44,020
and I hope you<font color="#E5E5E5"> guys watch It's Always</font>

1059
00:46:41,110 --> 00:46:46,660
Sunny in Philadelphia<font color="#E5E5E5"> and Charlie but</font>

1060
00:46:44,020 --> 00:46:50,620
yeah this<font color="#E5E5E5"> is when he we found Pepe</font>

1061
00:46:46,660 --> 00:46:52,720
Silvia<font color="#E5E5E5"> so thank you</font><font color="#CCCCCC"> all</font>

1062
00:46:50,620 --> 00:46:58,410
it's been great<font color="#E5E5E5"> this week and if you</font>

1063
00:46:52,720 --> 00:47:01,470
<font color="#CCCCCC">have any questions thanks Robert</font>

1064
00:46:58,410 --> 00:47:07,629
[Applause]

1065
00:47:01,470 --> 00:47:10,120
are there any questions nope

1066
00:47:07,630 --> 00:47:13,179
<font color="#E5E5E5">okay thank you</font>

1067
00:47:10,120 --> 00:47:13,179
[Applause]

