1
00:00:00,000 --> 00:00:04,529
present<font color="#E5E5E5"> some of our findings from</font>

2
00:00:01,530 --> 00:00:07,710
semantics perspective on wanna cry<font color="#E5E5E5"> and</font>

3
00:00:04,529 --> 00:00:09,660
our<font color="#E5E5E5"> investigation and this</font><font color="#CCCCCC"> is actually</font>

4
00:00:07,710 --> 00:00:16,199
my first<font color="#CCCCCC"> time up I'll come</font><font color="#E5E5E5"> on first time</font>

5
00:00:09,660 --> 00:00:17,670
speaking so<font color="#CCCCCC"> I am be kind and if I send a</font>

6
00:00:16,199 --> 00:00:21,359
bit weird I'm also<font color="#E5E5E5"> suffering from a cold</font>

7
00:00:17,670 --> 00:00:23,550
so I'm don't worry about that if I sound

8
00:00:21,359 --> 00:00:26,820
a bit odd<font color="#CCCCCC"> and so the wanna cry</font>

9
00:00:23,550 --> 00:00:30,900
<font color="#E5E5E5">investigation and was something that was</font>

10
00:00:26,820 --> 00:00:33,000
kind of a big<font color="#CCCCCC"> thing for us in terms of</font>

11
00:00:30,900 --> 00:00:35,489
<font color="#E5E5E5">we start seeing</font><font color="#CCCCCC"> some massive increases</font>

12
00:00:33,000 --> 00:00:37,829
in kind of<font color="#E5E5E5"> exploitation attempts for</font>

13
00:00:35,489 --> 00:00:39,809
maternal blue and it was one<font color="#CCCCCC"> of those</font>

14
00:00:37,829 --> 00:00:42,120
things<font color="#CCCCCC"> that was happening on a Friday it</font>

15
00:00:39,809 --> 00:00:43,949
<font color="#E5E5E5">was coming into the afternoon</font><font color="#CCCCCC"> and when</font>

16
00:00:42,120 --> 00:00:46,680
we start seeing these red<font color="#E5E5E5"> flags but</font>

17
00:00:43,950 --> 00:00:47,579
<font color="#CCCCCC">these amount of detection attempts we</font>

18
00:00:46,680 --> 00:00:50,190
knew that<font color="#E5E5E5"> it was going</font><font color="#CCCCCC"> to be something</font>

19
00:00:47,579 --> 00:00:51,930
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was massive and was our team that</font>

20
00:00:50,190 --> 00:00:55,140
were called in so a bit of<font color="#E5E5E5"> background</font>

21
00:00:51,930 --> 00:00:56,280
<font color="#CCCCCC">for myself as well and I've been</font><font color="#E5E5E5"> working</font>

22
00:00:55,140 --> 00:00:58,890
with<font color="#E5E5E5"> Symantec for the last eight years</font>

23
00:00:56,280 --> 00:01:01,469
<font color="#E5E5E5">or so</font><font color="#CCCCCC"> I'm initially I came in as a</font>

24
00:00:58,890 --> 00:01:03,030
reverse engineer and we kind of pull

25
00:01:01,469 --> 00:01:05,280
<font color="#E5E5E5">apart malware kind of figure out what it</font>

26
00:01:03,030 --> 00:01:06,780
does<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we write and the</font><font color="#CCCCCC"> text and</font>

27
00:01:05,280 --> 00:01:09,600
signatures for our different protection

28
00:01:06,780 --> 00:01:11,640
technologies and later I joined<font color="#E5E5E5"> a</font><font color="#CCCCCC"> team</font>

29
00:01:09,600 --> 00:01:14,490
called<font color="#E5E5E5"> the attack investigations team so</font>

30
00:01:11,640 --> 00:01:18,240
kind of<font color="#CCCCCC"> our role is looking at high</font>

31
00:01:14,490 --> 00:01:20,970
<font color="#CCCCCC">profile attacks</font><font color="#E5E5E5"> and we do a lot of</font>

32
00:01:18,240 --> 00:01:22,500
<font color="#CCCCCC">tracking of apt groups as well</font><font color="#E5E5E5"> and we</font>

33
00:01:20,970 --> 00:01:24,330
kind<font color="#E5E5E5"> of feed all</font><font color="#CCCCCC"> our information that</font><font color="#E5E5E5"> we</font>

34
00:01:22,500 --> 00:01:25,979
kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> into other teams within</font>

35
00:01:24,330 --> 00:01:29,369
Symantec to help protect<font color="#E5E5E5"> our customers a</font>

36
00:01:25,979 --> 00:01:32,429
<font color="#CCCCCC">little bit further so an overview of</font><font color="#E5E5E5"> the</font>

37
00:01:29,369 --> 00:01:34,079
talk<font color="#CCCCCC"> just to kind of give you a sense of</font>

38
00:01:32,430 --> 00:01:35,460
where you<font color="#CCCCCC"> stand</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and it's</font><font color="#CCCCCC"> short</font>

39
00:01:34,079 --> 00:01:37,408
enough<font color="#CCCCCC"> I'll try to keep within the</font><font color="#E5E5E5"> 30</font>

40
00:01:35,460 --> 00:01:39,809
minutes<font color="#E5E5E5"> so to some time for questions as</font>

41
00:01:37,409 --> 00:01:42,060
well and so we<font color="#CCCCCC"> have a bit of</font><font color="#E5E5E5"> background</font>

42
00:01:39,810 --> 00:01:44,130
<font color="#E5E5E5">and about one a cry</font><font color="#CCCCCC"> which most</font><font color="#E5E5E5"> views</font>

43
00:01:42,060 --> 00:01:45,869
would<font color="#E5E5E5"> be</font><font color="#CCCCCC"> our familiar</font><font color="#E5E5E5"> with so kind of an</font>

44
00:01:44,130 --> 00:01:48,179
a<font color="#E5E5E5"> roundup of what we were</font><font color="#CCCCCC"> able to find</font>

45
00:01:45,869 --> 00:01:51,540
<font color="#E5E5E5">out based on what was publicized and</font>

46
00:01:48,180 --> 00:01:53,040
<font color="#E5E5E5">we'll talk about our</font><font color="#CCCCCC"> investigation so in</font>

47
00:01:51,540 --> 00:01:55,229
a lot of cases and<font color="#E5E5E5"> people were</font>

48
00:01:53,040 --> 00:01:58,680
<font color="#E5E5E5">interested in trying</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> identify where</font>

49
00:01:55,229 --> 00:02:01,860
<font color="#CCCCCC">the attack was coming</font><font color="#E5E5E5"> from and for</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> we</font>

50
00:01:58,680 --> 00:02:03,810
were<font color="#E5E5E5"> able to</font><font color="#CCCCCC"> identify an earlier variant</font>

51
00:02:01,860 --> 00:02:06,479
<font color="#E5E5E5">that was used that predated the May</font>

52
00:02:03,810 --> 00:02:08,340
attacks<font color="#E5E5E5"> and enough</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of gave us the</font>

53
00:02:06,479 --> 00:02:10,649
<font color="#E5E5E5">most amount of</font><font color="#CCCCCC"> insight into the</font>

54
00:02:08,340 --> 00:02:11,730
attackers<font color="#CCCCCC"> and links to other groups and</font>

55
00:02:10,649 --> 00:02:12,470
other<font color="#E5E5E5"> activities which we'll discuss</font>

56
00:02:11,730 --> 00:02:14,750
<font color="#CCCCCC">tonight</font>

57
00:02:12,470 --> 00:02:18,260
and allows to<font color="#E5E5E5"> talk about those links</font>

58
00:02:14,750 --> 00:02:20,240
<font color="#E5E5E5">what we found some shared code and kind</font>

59
00:02:18,260 --> 00:02:21,980
<font color="#E5E5E5">of</font><font color="#CCCCCC"> any</font><font color="#E5E5E5"> the other relates activity that</font>

60
00:02:20,240 --> 00:02:23,030
we found as<font color="#CCCCCC"> part of</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> as well</font><font color="#E5E5E5"> and</font>

61
00:02:21,980 --> 00:02:25,299
<font color="#E5E5E5">then we'll just kind of wrap it up</font><font color="#CCCCCC"> with</font>

62
00:02:23,030 --> 00:02:27,980
<font color="#CCCCCC">some lessons learned and some takeaways</font>

63
00:02:25,300 --> 00:02:29,600
so the background<font color="#E5E5E5"> itself</font><font color="#CCCCCC"> so before I</font>

64
00:02:27,980 --> 00:02:32,540
kind<font color="#CCCCCC"> of talked about wanna cry I kind of</font>

65
00:02:29,600 --> 00:02:33,590
want to<font color="#E5E5E5"> put things in to talk about kind</font>

66
00:02:32,540 --> 00:02:35,329
<font color="#E5E5E5">of context to</font><font color="#CCCCCC"> put things</font><font color="#E5E5E5"> into</font>

67
00:02:33,590 --> 00:02:39,020
perspective<font color="#CCCCCC"> so when people</font><font color="#E5E5E5"> talk about</font>

68
00:02:35,330 --> 00:02:41,000
<font color="#CCCCCC">Massive Attack's</font><font color="#E5E5E5"> and that were and super</font>

69
00:02:39,020 --> 00:02:42,530
impactful<font color="#E5E5E5"> some of the names are kind</font><font color="#CCCCCC"> of</font>

70
00:02:41,000 --> 00:02:44,180
<font color="#CCCCCC">slope to the top</font><font color="#E5E5E5"> are you</font><font color="#CCCCCC"> gee blaster and</font>

71
00:02:42,530 --> 00:02:46,790
this is kind of a super old<font color="#CCCCCC"> world</font><font color="#E5E5E5"> back</font>

72
00:02:44,180 --> 00:02:49,490
<font color="#CCCCCC">from</font><font color="#E5E5E5"> 2003 and and this is where we seen</font>

73
00:02:46,790 --> 00:02:51,679
like 16 million machines that were

74
00:02:49,490 --> 00:02:54,170
infected in<font color="#CCCCCC"> a single day which is a</font>

75
00:02:51,680 --> 00:02:56,090
massive<font color="#CCCCCC"> number a similar wound uh kind</font>

76
00:02:54,170 --> 00:02:59,540
of flows the top was corn<font color="#CCCCCC"> our conficker</font>

77
00:02:56,090 --> 00:03:01,460
so<font color="#CCCCCC"> am configure had up to 15 million</font>

78
00:02:59,540 --> 00:03:03,590
machines that<font color="#CCCCCC"> have been</font><font color="#E5E5E5"> affected within</font>

79
00:03:01,460 --> 00:03:08,150
a<font color="#E5E5E5"> 24 hour period</font><font color="#CCCCCC"> and this was kind of</font>

80
00:03:03,590 --> 00:03:11,720
<font color="#E5E5E5">later on in November 2008 but then we</font>

81
00:03:08,150 --> 00:03:12,530
had one a<font color="#CCCCCC"> cry</font><font color="#E5E5E5"> in May</font><font color="#CCCCCC"> um and the number</font>

82
00:03:11,720 --> 00:03:15,230
<font color="#CCCCCC">solana</font><font color="#E5E5E5"> cry</font>

83
00:03:12,530 --> 00:03:17,630
were relatively<font color="#E5E5E5"> small in comparison</font><font color="#CCCCCC"> to</font>

84
00:03:15,230 --> 00:03:21,170
some<font color="#CCCCCC"> of the other big attacks we</font><font color="#E5E5E5"> only</font>

85
00:03:17,630 --> 00:03:23,660
seen around like<font color="#E5E5E5"> 300,000 or maybe a</font>

86
00:03:21,170 --> 00:03:26,420
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit more and machines ever have</font>

87
00:03:23,660 --> 00:03:30,500
been<font color="#E5E5E5"> infected by wanna cry and this</font><font color="#CCCCCC"> is</font>

88
00:03:26,420 --> 00:03:33,670
kind of bit odd and<font color="#CCCCCC"> the reason why this</font>

89
00:03:30,500 --> 00:03:36,020
is is because<font color="#E5E5E5"> of the impact</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> hot so</font>

90
00:03:33,670 --> 00:03:38,299
what happened was when people<font color="#E5E5E5"> came into</font>

91
00:03:36,020 --> 00:03:41,570
work they were<font color="#E5E5E5"> turning on machines they</font>

92
00:03:38,300 --> 00:03:43,430
started receiving are seeing this<font color="#E5E5E5"> and</font>

93
00:03:41,570 --> 00:03:47,030
went to the<font color="#E5E5E5"> machine on basically</font>

94
00:03:43,430 --> 00:03:50,150
requesting and payment of bitcoins<font color="#CCCCCC"> work</font>

95
00:03:47,030 --> 00:03:52,610
to bid $300 and informing them that

96
00:03:50,150 --> 00:03:54,050
their machine had<font color="#CCCCCC"> been and held to</font>

97
00:03:52,610 --> 00:03:56,510
ransom<font color="#E5E5E5"> and</font><font color="#CCCCCC"> doctor files have been</font>

98
00:03:54,050 --> 00:03:58,010
encrypted and and this<font color="#E5E5E5"> is obviously more</font>

99
00:03:56,510 --> 00:04:00,018
impactful than<font color="#E5E5E5"> what you see well some of</font>

100
00:03:58,010 --> 00:04:01,760
<font color="#CCCCCC">the other</font><font color="#E5E5E5"> and a big threat</font><font color="#CCCCCC"> sure we had</font>

101
00:04:00,019 --> 00:04:03,320
<font color="#CCCCCC">mult are millions of machines affected</font>

102
00:04:01,760 --> 00:04:05,929
where those<font color="#CCCCCC"> trucks was run in the</font>

103
00:04:03,320 --> 00:04:07,220
background and but this was more

104
00:04:05,930 --> 00:04:10,810
impactful<font color="#E5E5E5"> than</font><font color="#CCCCCC"> that it was being</font>

105
00:04:07,220 --> 00:04:15,190
disruptive<font color="#CCCCCC"> it was stopping productivity</font>

106
00:04:10,810 --> 00:04:17,810
and when I say impacts<font color="#E5E5E5"> what I mean is</font>

107
00:04:15,190 --> 00:04:19,160
when we start seeing<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the reports</font>

108
00:04:17,810 --> 00:04:20,839
kind of floating around some social

109
00:04:19,160 --> 00:04:23,300
<font color="#CCCCCC">media platforms people posting pictures</font>

110
00:04:20,839 --> 00:04:24,000
and some media outlets<font color="#E5E5E5"> reporting on some</font>

111
00:04:23,300 --> 00:04:25,530
of those<font color="#E5E5E5"> too</font>

112
00:04:24,000 --> 00:04:27,210
disruptions are actually incurred by

113
00:04:25,530 --> 00:04:29,340
this and we start<font color="#E5E5E5"> seeing attacks that</font>

114
00:04:27,210 --> 00:04:32,430
were on Billboard's whatever<font color="#E5E5E5"> becoming</font>

115
00:04:29,340 --> 00:04:35,190
locked we've seen kiosks emergency

116
00:04:32,430 --> 00:04:40,830
departments between<font color="#E5E5E5"> train stations in</font>

117
00:04:35,190 --> 00:04:44,130
Germany and ATMs<font color="#E5E5E5"> home TVs even</font><font color="#CCCCCC"> the NHS</font>

118
00:04:40,830 --> 00:04:45,890
in the UK and even FedEx as well so this

119
00:04:44,130 --> 00:04:48,840
<font color="#E5E5E5">was</font><font color="#CCCCCC"> apparent that</font><font color="#E5E5E5"> it was a massive issue</font>

120
00:04:45,890 --> 00:04:50,430
and<font color="#E5E5E5"> this is was why our team was called</font>

121
00:04:48,840 --> 00:04:52,140
in<font color="#E5E5E5"> on</font><font color="#CCCCCC"> this to be able</font><font color="#E5E5E5"> to kind</font><font color="#CCCCCC"> of help</font>

122
00:04:50,430 --> 00:04:54,150
other teams<font color="#CCCCCC"> it's smart to kind of figure</font>

123
00:04:52,140 --> 00:04:56,490
what was going on<font color="#CCCCCC"> header were</font><font color="#E5E5E5"> doing or</font>

124
00:04:54,150 --> 00:04:58,169
<font color="#E5E5E5">spreading and if there was any links to</font>

125
00:04:56,490 --> 00:04:59,820
<font color="#CCCCCC">other groups and</font><font color="#E5E5E5"> you know in a tux and</font>

126
00:04:58,169 --> 00:05:01,020
what we could<font color="#E5E5E5"> do to kind of help our</font>

127
00:04:59,820 --> 00:05:04,409
customers gonna protect themselves from

128
00:05:01,020 --> 00:05:06,080
that and in terms<font color="#E5E5E5"> of distribution when</font>

129
00:05:04,410 --> 00:05:08,940
we<font color="#E5E5E5"> start looking at some of the</font>

130
00:05:06,080 --> 00:05:11,039
exploitation attempts<font color="#E5E5E5"> from eternal blue</font>

131
00:05:08,940 --> 00:05:13,860
<font color="#E5E5E5">and we seen a</font><font color="#CCCCCC"> massive surge which</font>

132
00:05:11,040 --> 00:05:15,960
occurred on May 12th and this<font color="#E5E5E5"> is what</font>

133
00:05:13,860 --> 00:05:17,190
kind<font color="#CCCCCC"> of set off red flags</font><font color="#E5E5E5"> for us and we</font>

134
00:05:15,960 --> 00:05:19,140
knew it's going<font color="#CCCCCC"> to be a long weekend at</font>

135
00:05:17,190 --> 00:05:20,790
this<font color="#E5E5E5"> stage and</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is kind of why I</font>

136
00:05:19,140 --> 00:05:22,650
<font color="#E5E5E5">kind</font><font color="#CCCCCC"> of led into</font><font color="#E5E5E5"> that makes me</font><font color="#CCCCCC"> want to</font>

137
00:05:20,790 --> 00:05:24,360
<font color="#CCCCCC">cry because we knew was gonna be a</font>

138
00:05:22,650 --> 00:05:25,890
painful investigation from<font color="#E5E5E5"> our side</font>

139
00:05:24,360 --> 00:05:27,930
particularly<font color="#E5E5E5"> the fact that we're gonna</font>

140
00:05:25,890 --> 00:05:30,479
<font color="#E5E5E5">have to pull in resources and over the</font>

141
00:05:27,930 --> 00:05:33,260
weekend and what we seen was<font color="#CCCCCC"> the initial</font>

142
00:05:30,479 --> 00:05:36,450
search<font color="#CCCCCC"> moved</font><font color="#E5E5E5"> around</font><font color="#CCCCCC"> to so very detailed</font>

143
00:05:33,260 --> 00:05:39,570
<font color="#E5E5E5">machines are had been attempting</font><font color="#CCCCCC"> to</font>

144
00:05:36,450 --> 00:05:41,190
spread<font color="#E5E5E5"> what a cry but then</font><font color="#CCCCCC"> we seen some</font>

145
00:05:39,570 --> 00:05:44,190
initial<font color="#CCCCCC"> drop off</font><font color="#E5E5E5"> as we entered the</font>

146
00:05:41,190 --> 00:05:45,510
weekend and followed<font color="#CCCCCC"> by a resurgence</font>

147
00:05:44,190 --> 00:05:47,310
later on and it was likely that<font color="#E5E5E5"> this</font>

148
00:05:45,510 --> 00:05:50,310
<font color="#E5E5E5">resurgence was caused by people</font><font color="#CCCCCC"> coming</font>

149
00:05:47,310 --> 00:05:51,390
back in over the weekend<font color="#CCCCCC"> on Monday and</font>

150
00:05:50,310 --> 00:05:55,350
<font color="#E5E5E5">then turning on</font><font color="#CCCCCC"> their machines</font><font color="#E5E5E5"> and then</font>

151
00:05:51,390 --> 00:05:56,520
finding<font color="#E5E5E5"> that it was</font><font color="#CCCCCC"> infected we also</font>

152
00:05:55,350 --> 00:05:57,780
<font color="#E5E5E5">took out the day they were</font><font color="#CCCCCC"> able to</font>

153
00:05:56,520 --> 00:06:00,060
<font color="#E5E5E5">collect from our</font><font color="#CCCCCC"> Kalama tree and just</font>

154
00:05:57,780 --> 00:06:02,460
<font color="#E5E5E5">kind of mapped it out over time</font><font color="#CCCCCC"> across</font>

155
00:06:00,060 --> 00:06:06,030
<font color="#E5E5E5">the heat map</font><font color="#CCCCCC"> and we found out some of</font>

156
00:06:02,460 --> 00:06:08,520
the countries that were impacted<font color="#E5E5E5"> and</font>

157
00:06:06,030 --> 00:06:11,039
kind<font color="#E5E5E5"> of early on I kind</font><font color="#CCCCCC"> of had mass</font><font color="#E5E5E5"> of</font>

158
00:06:08,520 --> 00:06:13,500
numbers in terms<font color="#E5E5E5"> of infections and was</font>

159
00:06:11,040 --> 00:06:15,270
the likes of like Russia China<font color="#E5E5E5"> Brazil</font>

160
00:06:13,500 --> 00:06:17,700
and<font color="#CCCCCC"> these are</font><font color="#E5E5E5"> kind of countries that</font>

161
00:06:15,270 --> 00:06:20,340
have really good internet<font color="#E5E5E5"> access both</font>

162
00:06:17,700 --> 00:06:22,710
they for whatever reason have a lot of

163
00:06:20,340 --> 00:06:24,330
<font color="#E5E5E5">on part systems and these were the</font>

164
00:06:22,710 --> 00:06:26,010
countries that we start seeing<font color="#E5E5E5"> reports</font>

165
00:06:24,330 --> 00:06:28,890
<font color="#E5E5E5">come</font><font color="#CCCCCC"> from in the early days when one</font>

166
00:06:26,010 --> 00:06:31,080
<font color="#CCCCCC">Akari</font><font color="#E5E5E5"> start spreading in terms of</font>

167
00:06:28,890 --> 00:06:33,539
<font color="#CCCCCC">spreading itself and there's a</font><font color="#E5E5E5"> couple of</font>

168
00:06:31,080 --> 00:06:35,820
<font color="#CCCCCC">message that it uses so em the first is</font>

169
00:06:33,539 --> 00:06:36,840
where is enumerates all the network

170
00:06:35,820 --> 00:06:39,990
adapters

171
00:06:36,840 --> 00:06:41,909
<font color="#CCCCCC">and detect IP information</font><font color="#E5E5E5"> about their</font>

172
00:06:39,990 --> 00:06:43,710
system<font color="#CCCCCC"> may have infected</font><font color="#E5E5E5"> it'll generate</font>

173
00:06:41,910 --> 00:06:45,990
a list<font color="#E5E5E5"> of IP addresses within those</font>

174
00:06:43,710 --> 00:06:49,039
subnets<font color="#CCCCCC"> and then essentially</font><font color="#E5E5E5"> try to</font>

175
00:06:45,990 --> 00:06:52,169
connect to<font color="#E5E5E5"> all those</font><font color="#CCCCCC"> machines</font><font color="#E5E5E5"> and</font>

176
00:06:49,040 --> 00:06:54,990
connect a report<font color="#CCCCCC"> four</font><font color="#E5E5E5"> four five attempt</font>

177
00:06:52,169 --> 00:06:56,698
to make a successful<font color="#E5E5E5"> connection if a</font>

178
00:06:54,990 --> 00:06:58,949
successful connection is<font color="#E5E5E5"> actually made</font>

179
00:06:56,699 --> 00:07:01,560
it will then prepare and the eternal

180
00:06:58,949 --> 00:07:03,840
blue exploit to be able<font color="#E5E5E5"> to deploy want</font>

181
00:07:01,560 --> 00:07:05,610
to cry on<font color="#CCCCCC"> to</font><font color="#E5E5E5"> those remote machines and</font>

182
00:07:03,840 --> 00:07:08,070
it will also<font color="#E5E5E5"> generate a random</font><font color="#CCCCCC"> IP</font>

183
00:07:05,610 --> 00:07:09,810
address so it'll generate up to 128

184
00:07:08,070 --> 00:07:11,880
random IP addresses it will attempt<font color="#CCCCCC"> a</font>

185
00:07:09,810 --> 00:07:14,250
connection with them<font color="#E5E5E5"> and if a connection</font>

186
00:07:11,880 --> 00:07:16,260
<font color="#CCCCCC">is successful</font><font color="#E5E5E5"> again it'll prepare the</font>

187
00:07:14,250 --> 00:07:19,680
turnable you exploit and then it will

188
00:07:16,260 --> 00:07:21,990
<font color="#E5E5E5">try to deploy</font><font color="#CCCCCC"> I have one a cry on to</font>

189
00:07:19,680 --> 00:07:24,660
<font color="#E5E5E5">those machines for any time I had a</font>

190
00:07:21,990 --> 00:07:27,630
<font color="#E5E5E5">successful connection</font><font color="#CCCCCC"> and it would then</font>

191
00:07:24,660 --> 00:07:30,389
scan and all the<font color="#E5E5E5"> IPS from</font><font color="#CCCCCC"> one to two to</font>

192
00:07:27,630 --> 00:07:31,710
<font color="#CCCCCC">five within that same I</font><font color="#E5E5E5"> am subnet to</font><font color="#CCCCCC"> be</font>

193
00:07:30,389 --> 00:07:39,330
<font color="#E5E5E5">able to seeker to connect any of those</font>

194
00:07:31,710 --> 00:07:43,138
ones so the kill switch<font color="#E5E5E5"> itself so in the</font>

195
00:07:39,330 --> 00:07:44,789
code<font color="#CCCCCC"> and there was basically a higher</font>

196
00:07:43,139 --> 00:07:48,870
<font color="#E5E5E5">Kota domain which was an unregistered</font>

197
00:07:44,789 --> 00:07:51,389
domain and this domain and<font color="#E5E5E5"> basically</font>

198
00:07:48,870 --> 00:07:53,280
worked as a type of kill switch<font color="#CCCCCC"> so if a</font>

199
00:07:51,389 --> 00:07:55,860
connection<font color="#E5E5E5"> could</font><font color="#CCCCCC"> be made to this domain</font>

200
00:07:53,280 --> 00:07:57,989
and<font color="#E5E5E5"> a successful response was given back</font>

201
00:07:55,860 --> 00:07:59,220
and it<font color="#E5E5E5"> would then essentially terminate</font>

202
00:07:57,990 --> 00:08:02,910
itself so it wouldn't continue<font color="#E5E5E5"> spreading</font>

203
00:07:59,220 --> 00:08:05,190
and<font color="#CCCCCC"> Marketo Marcus and how to identify</font>

204
00:08:02,910 --> 00:08:07,349
<font color="#CCCCCC">this</font><font color="#E5E5E5"> and he registered a domain as part</font>

205
00:08:05,190 --> 00:08:08,880
of his botnet<font color="#CCCCCC"> truckin</font><font color="#E5E5E5"> so I think at the</font>

206
00:08:07,349 --> 00:08:10,650
<font color="#E5E5E5">time he even admitted that he wasn't</font>

207
00:08:08,880 --> 00:08:12,780
<font color="#E5E5E5">aware that it</font><font color="#CCCCCC"> was actually</font><font color="#E5E5E5"> kills which</font>

208
00:08:10,650 --> 00:08:14,310
he just seen<font color="#E5E5E5"> an unregistered domain as</font>

209
00:08:12,780 --> 00:08:16,979
part of his analysis and<font color="#CCCCCC"> then registered</font>

210
00:08:14,310 --> 00:08:19,260
<font color="#CCCCCC">after Lane and I think he had a story up</font>

211
00:08:16,979 --> 00:08:21,060
on his blog<font color="#E5E5E5"> kind of detailing kind of</font>

212
00:08:19,260 --> 00:08:23,430
the circumstances<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> events and it</font>

213
00:08:21,060 --> 00:08:24,840
kind of led to<font color="#E5E5E5"> understanding why it</font>

214
00:08:23,430 --> 00:08:27,330
<font color="#E5E5E5">actually became a kill switch at a later</font>

215
00:08:24,840 --> 00:08:29,880
stage<font color="#E5E5E5"> so it was theorized that this was</font>

216
00:08:27,330 --> 00:08:32,490
likely<font color="#CCCCCC"> used to evade</font><font color="#E5E5E5"> sound boxing so in</font>

217
00:08:29,880 --> 00:08:34,860
most sandbox environments and you'll

218
00:08:32,490 --> 00:08:37,349
generally see people submit samples<font color="#E5E5E5"> and</font>

219
00:08:34,860 --> 00:08:41,130
they'll want to<font color="#E5E5E5"> be able to</font><font color="#CCCCCC"> capture or</font>

220
00:08:37,349 --> 00:08:43,709
fake and I am<font color="#E5E5E5"> c2 or command and control</font>

221
00:08:41,130 --> 00:08:45,480
<font color="#CCCCCC">and</font><font color="#E5E5E5"> every social responses and basically</font>

222
00:08:43,708 --> 00:08:46,920
to extract<font color="#CCCCCC"> see too quickly and usually</font>

223
00:08:45,480 --> 00:08:47,640
<font color="#E5E5E5">to kind of cluster malware in later</font>

224
00:08:46,920 --> 00:08:51,209
stages

225
00:08:47,640 --> 00:08:53,550
and we started sinkhole domain which

226
00:08:51,209 --> 00:08:55,979
stopped the spreading of wanna cry which

227
00:08:53,550 --> 00:08:57,990
was<font color="#CCCCCC"> a</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> good</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> and but what we</font>

228
00:08:55,980 --> 00:09:00,450
kind<font color="#E5E5E5"> of gave us tips to some of our</font>

229
00:08:57,990 --> 00:09:03,240
customers<font color="#CCCCCC"> was instead of</font><font color="#E5E5E5"> relying on an</font>

230
00:09:00,450 --> 00:09:05,779
<font color="#E5E5E5">external domain</font><font color="#CCCCCC"> I ensure that you create</font>

231
00:09:03,240 --> 00:09:09,899
<font color="#CCCCCC">DNS entries for any of their local</font>

232
00:09:05,779 --> 00:09:11,250
machines so it resolves<font color="#CCCCCC"> to machine</font>

233
00:09:09,899 --> 00:09:13,170
that's<font color="#CCCCCC"> within</font><font color="#E5E5E5"> your own network that you</font>

234
00:09:11,250 --> 00:09:14,670
control so your own private<font color="#CCCCCC"> sink</font><font color="#E5E5E5"> own as</font>

235
00:09:13,170 --> 00:09:16,740
such<font color="#E5E5E5"> and the reason why we were</font><font color="#CCCCCC"> doing</font>

236
00:09:14,670 --> 00:09:18,569
<font color="#E5E5E5">this was while people were relying on</font>

237
00:09:16,740 --> 00:09:22,500
this external domain they were adding

238
00:09:18,570 --> 00:09:24,480
<font color="#E5E5E5">the unready domain to and</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> white</font>

239
00:09:22,500 --> 00:09:27,060
<font color="#E5E5E5">lists and which kind of presented a</font>

240
00:09:24,480 --> 00:09:29,310
couple<font color="#E5E5E5"> of issues</font><font color="#CCCCCC"> one there was reports</font>

241
00:09:27,060 --> 00:09:32,699
of<font color="#E5E5E5"> attacks</font><font color="#CCCCCC"> being performed so</font><font color="#E5E5E5"> DDoS</font>

242
00:09:29,310 --> 00:09:35,430
attacks on and from the<font color="#E5E5E5"> mayor botanist</font>

243
00:09:32,700 --> 00:09:39,570
against the domain<font color="#CCCCCC"> de</font><font color="#E5E5E5"> or the</font><font color="#CCCCCC"> sink</font><font color="#E5E5E5"> holder</font>

244
00:09:35,430 --> 00:09:41,819
and our tech was running and and if that

245
00:09:39,570 --> 00:09:43,610
had succeeded then it would have allowed

246
00:09:41,820 --> 00:09:46,320
what a quite a spread even further<font color="#E5E5E5"> and</font>

247
00:09:43,610 --> 00:09:48,899
there was<font color="#CCCCCC"> also kind of the</font><font color="#E5E5E5"> ability</font>

248
00:09:46,320 --> 00:09:50,130
whereby if a later stages<font color="#E5E5E5"> people had</font>

249
00:09:48,899 --> 00:09:52,410
forgotten<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they had added this</font>

250
00:09:50,130 --> 00:09:54,570
domain into their other white into their

251
00:09:52,410 --> 00:09:55,890
white lists and the domain became one

252
00:09:54,570 --> 00:09:57,240
registered and<font color="#E5E5E5"> then start being used for</font>

253
00:09:55,890 --> 00:09:59,519
malicious purposes<font color="#E5E5E5"> later stage they've</font>

254
00:09:57,240 --> 00:10:00,600
effectively given a free pass<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this</font>

255
00:09:59,519 --> 00:10:04,410
<font color="#E5E5E5">was something that we were kind of</font>

256
00:10:00,600 --> 00:10:06,390
suggesting<font color="#CCCCCC"> is best practice for them and</font>

257
00:10:04,410 --> 00:10:08,339
in terms of<font color="#CCCCCC"> payment</font><font color="#E5E5E5"> and it seemed like</font>

258
00:10:06,390 --> 00:10:10,110
<font color="#E5E5E5">the guys who created one</font><font color="#CCCCCC"> equai kind of</font>

259
00:10:08,339 --> 00:10:13,440
made a few mistakes<font color="#E5E5E5"> or kind of hurried</font>

260
00:10:10,110 --> 00:10:16,230
and development of the tool itself<font color="#E5E5E5"> so it</font>

261
00:10:13,440 --> 00:10:19,740
looked<font color="#E5E5E5"> like and there was a point where</font>

262
00:10:16,230 --> 00:10:21,720
<font color="#E5E5E5">a</font><font color="#CCCCCC"> decrypter or sorry a Bitcoin generator</font>

263
00:10:19,740 --> 00:10:24,540
so a Bitcoin<font color="#CCCCCC"> address generator was</font>

264
00:10:21,720 --> 00:10:25,949
supposed to be dropped to<font color="#E5E5E5"> disk</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> when</font>

265
00:10:24,540 --> 00:10:29,750
you were looking<font color="#CCCCCC"> at the code itself it</font>

266
00:10:25,949 --> 00:10:31,920
looked<font color="#E5E5E5"> like it was calling the Bitcoin</font>

267
00:10:29,750 --> 00:10:33,839
address generator<font color="#E5E5E5"> before I was even</font>

268
00:10:31,920 --> 00:10:35,849
written to disk<font color="#E5E5E5"> so this was kind of a</font>

269
00:10:33,839 --> 00:10:37,350
big thing<font color="#E5E5E5"> whereby it wasn't able to</font>

270
00:10:35,850 --> 00:10:40,140
generate<font color="#E5E5E5"> a unique address for each</font>

271
00:10:37,350 --> 00:10:41,790
infection and which meant that it

272
00:10:40,140 --> 00:10:43,470
actually<font color="#CCCCCC"> had</font><font color="#E5E5E5"> to fall</font><font color="#CCCCCC"> back to some</font>

273
00:10:41,790 --> 00:10:47,040
default values that have been<font color="#CCCCCC"> hard coded</font>

274
00:10:43,470 --> 00:10:48,839
in and<font color="#E5E5E5"> to the samples themselves</font><font color="#CCCCCC"> well 13</font>

275
00:10:47,040 --> 00:10:50,250
<font color="#E5E5E5">hours later they also tried</font><font color="#CCCCCC"> to release a</font>

276
00:10:48,839 --> 00:10:52,589
fix for this<font color="#E5E5E5"> but at this point the</font>

277
00:10:50,250 --> 00:10:54,149
damage<font color="#E5E5E5"> had been done and mitigation had</font>

278
00:10:52,589 --> 00:10:55,500
been kind of rolled out across different

279
00:10:54,149 --> 00:10:57,510
organizations<font color="#E5E5E5"> to kill switch had been</font>

280
00:10:55,500 --> 00:10:58,240
<font color="#E5E5E5">put in place so it kind of didn't have</font>

281
00:10:57,510 --> 00:11:01,869
<font color="#E5E5E5">much</font>

282
00:10:58,240 --> 00:11:03,730
and a fact lady<font color="#E5E5E5"> so without a unique</font>

283
00:11:01,869 --> 00:11:07,439
<font color="#E5E5E5">Bitcoin address generator and a</font>

284
00:11:03,730 --> 00:11:09,369
defaulted to<font color="#CCCCCC"> the tree</font><font color="#E5E5E5"> kind of had</font>

285
00:11:07,439 --> 00:11:11,649
defiled addresses that were embedded

286
00:11:09,369 --> 00:11:14,100
within the sample itself<font color="#E5E5E5"> and the</font>

287
00:11:11,649 --> 00:11:16,209
attackers<font color="#E5E5E5"> were demanding around $300 in</font>

288
00:11:14,100 --> 00:11:18,249
bitcoins and then saying<font color="#E5E5E5"> that</font><font color="#CCCCCC"> it might</font>

289
00:11:16,209 --> 00:11:20,529
double in price<font color="#E5E5E5"> after three days if</font>

290
00:11:18,249 --> 00:11:22,600
there was no<font color="#E5E5E5"> payment received and after</font>

291
00:11:20,529 --> 00:11:24,490
seven days<font color="#E5E5E5"> and the attackers also</font>

292
00:11:22,600 --> 00:11:26,499
<font color="#E5E5E5">claimed that files would be lost or</font>

293
00:11:24,490 --> 00:11:27,999
modified and but there was actually<font color="#CCCCCC"> no</font>

294
00:11:26,499 --> 00:11:29,410
<font color="#CCCCCC">evidence of this so</font><font color="#E5E5E5"> even when we looked</font>

295
00:11:27,999 --> 00:11:30,639
at the code itself we couldn't see

296
00:11:29,410 --> 00:11:33,249
anything<font color="#E5E5E5"> in there that would actually</font>

297
00:11:30,639 --> 00:11:36,670
try to delete<font color="#E5E5E5"> the files or even</font><font color="#CCCCCC"> modify</font>

298
00:11:33,249 --> 00:11:38,589
them after<font color="#CCCCCC"> this time period and last</font>

299
00:11:36,670 --> 00:11:41,050
<font color="#E5E5E5">time I checked there was around $90,000</font>

300
00:11:38,589 --> 00:11:44,439
<font color="#E5E5E5">in the</font><font color="#CCCCCC"> Bitcoin address that</font><font color="#E5E5E5"> I had been</font>

301
00:11:41,050 --> 00:11:48,160
paid<font color="#E5E5E5"> and it may have</font><font color="#CCCCCC"> changed since for</font>

302
00:11:44,439 --> 00:11:53,319
likely and even when it kind<font color="#E5E5E5"> of came to</font>

303
00:11:48,160 --> 00:11:54,610
<font color="#CCCCCC">the dead line</font><font color="#E5E5E5"> in terms of the render</font>

304
00:11:53,319 --> 00:11:57,189
<font color="#E5E5E5">time that the attackers</font><font color="#CCCCCC"> had given</font><font color="#E5E5E5"> people</font>

305
00:11:54,610 --> 00:11:58,600
<font color="#E5E5E5">to kind of pay up the ransom</font><font color="#CCCCCC"> we've seen</font>

306
00:11:57,189 --> 00:12:00,849
that<font color="#E5E5E5"> it kind of made a</font><font color="#CCCCCC"> last-place so</font>

307
00:11:58,600 --> 00:12:02,019
they were sending<font color="#E5E5E5"> out messages and which</font>

308
00:12:00,850 --> 00:12:04,899
is kind of funny<font color="#CCCCCC"> because their start</font>

309
00:12:02,019 --> 00:12:09,759
referring<font color="#E5E5E5"> to her as victims as customers</font>

310
00:12:04,899 --> 00:12:14,470
in<font color="#E5E5E5"> this case so for our investigation</font>

311
00:12:09,759 --> 00:12:16,869
<font color="#CCCCCC">and identifying the vector</font><font color="#E5E5E5"> of the attack</font>

312
00:12:14,470 --> 00:12:19,240
was kind<font color="#E5E5E5"> of super difficult</font><font color="#CCCCCC"> and this was</font>

313
00:12:16,869 --> 00:12:21,100
mainly down to a<font color="#E5E5E5"> couple of reasons</font>

314
00:12:19,240 --> 00:12:23,049
so the first one was kind of larger

315
00:12:21,100 --> 00:12:25,240
number of organizations were in practice

316
00:12:23,049 --> 00:12:27,850
<font color="#CCCCCC">at the amount of organizations</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> were</font>

317
00:12:25,240 --> 00:12:29,319
impacted<font color="#E5E5E5"> and by the stress and also</font><font color="#CCCCCC"> a</font>

318
00:12:27,850 --> 00:12:32,529
large amount of<font color="#E5E5E5"> traffic that had been</font>

319
00:12:29,319 --> 00:12:34,059
<font color="#CCCCCC">generated by the spreading</font><font color="#E5E5E5"> and of</font><font color="#CCCCCC"> won</font>

320
00:12:32,529 --> 00:12:35,799
<font color="#CCCCCC">acclaim and</font><font color="#E5E5E5"> this made it</font><font color="#CCCCCC"> difficult to</font>

321
00:12:34,059 --> 00:12:38,110
<font color="#E5E5E5">then dig through like your telemetry and</font>

322
00:12:35,799 --> 00:12:39,670
dick tree logs<font color="#E5E5E5"> kind of identify that</font>

323
00:12:38,110 --> 00:12:41,769
<font color="#E5E5E5">first machine that had been affected</font>

324
00:12:39,670 --> 00:12:43,889
particularly when it was a likely<font color="#CCCCCC"> gonna</font>

325
00:12:41,769 --> 00:12:46,059
<font color="#CCCCCC">be outside of</font><font color="#E5E5E5"> your own customer base and</font>

326
00:12:43,889 --> 00:12:47,139
<font color="#E5E5E5">and it was a lot of it was a big</font><font color="#CCCCCC"> thing</font>

327
00:12:46,059 --> 00:12:48,790
for<font color="#E5E5E5"> a lot of</font><font color="#CCCCCC"> groups that we were in</font>

328
00:12:47,139 --> 00:12:50,619
talking<font color="#E5E5E5"> about</font><font color="#CCCCCC"> this turn at the time they</font>

329
00:12:48,790 --> 00:12:52,118
wanted<font color="#CCCCCC"> to</font><font color="#E5E5E5"> find patient zero</font><font color="#CCCCCC"> and they</font>

330
00:12:50,619 --> 00:12:54,369
thought<font color="#E5E5E5"> that this would be kind of the</font>

331
00:12:52,119 --> 00:12:56,679
<font color="#CCCCCC">way to be able to</font><font color="#E5E5E5"> identify</font><font color="#CCCCCC"> how it</font>

332
00:12:54,369 --> 00:12:57,999
initially got on like did<font color="#CCCCCC"> it for</font><font color="#E5E5E5"> example</font>

333
00:12:56,679 --> 00:13:00,730
was it<font color="#CCCCCC"> received</font><font color="#E5E5E5"> by an email that then</font>

334
00:12:57,999 --> 00:13:02,290
<font color="#CCCCCC">start</font><font color="#E5E5E5"> spreading and but this was kind of</font>

335
00:13:00,730 --> 00:13:05,350
some<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> questions that the</font><font color="#CCCCCC"> group's</font>

336
00:13:02,290 --> 00:13:06,779
wanted<font color="#E5E5E5"> to answer</font><font color="#CCCCCC"> and for</font><font color="#E5E5E5"> us what we</font>

337
00:13:05,350 --> 00:13:09,430
<font color="#E5E5E5">actually ate was how to look off the</font>

338
00:13:06,779 --> 00:13:11,770
samples that we had<font color="#E5E5E5"> collected ourselves</font>

339
00:13:09,430 --> 00:13:13,239
and we kind of<font color="#E5E5E5"> tore it apart a bit and</font>

340
00:13:11,770 --> 00:13:17,260
then look for<font color="#E5E5E5"> kind of some unique</font>

341
00:13:13,240 --> 00:13:20,080
<font color="#E5E5E5">markers and we created a somewhat loose</font>

342
00:13:17,260 --> 00:13:23,020
signature<font color="#E5E5E5"> that we could</font><font color="#CCCCCC"> then use to</font><font color="#E5E5E5"> kind</font>

343
00:13:20,080 --> 00:13:25,270
<font color="#E5E5E5">of query or search across our big file</font>

344
00:13:23,020 --> 00:13:26,650
repository<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> actually got a</font><font color="#E5E5E5"> couple</font>

345
00:13:25,270 --> 00:13:29,319
<font color="#E5E5E5">of hits which is a bit odd because the</font>

346
00:13:26,650 --> 00:13:30,880
hits<font color="#E5E5E5"> that we got were additional samples</font>

347
00:13:29,320 --> 00:13:32,830
<font color="#E5E5E5">that look like one a cry but they</font>

348
00:13:30,880 --> 00:13:35,020
weren't<font color="#E5E5E5"> and even</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> had</font><font color="#CCCCCC"> been reported</font>

349
00:13:32,830 --> 00:13:36,730
as<font color="#CCCCCC"> part of the May attacks</font><font color="#E5E5E5"> and what we</font>

350
00:13:35,020 --> 00:13:38,350
did was<font color="#CCCCCC"> we took those samples</font><font color="#E5E5E5"> and then</font>

351
00:13:36,730 --> 00:13:40,200
we found<font color="#E5E5E5"> him against our</font><font color="#CCCCCC"> Kalama tree to</font>

352
00:13:38,350 --> 00:13:43,120
see was there any customers that had and

353
00:13:40,200 --> 00:13:44,470
been impacted by<font color="#CCCCCC"> these samples</font><font color="#E5E5E5"> and we</font>

354
00:13:43,120 --> 00:13:46,630
<font color="#E5E5E5">actually found with six organizations</font>

355
00:13:44,470 --> 00:13:48,580
<font color="#CCCCCC">and this predated the attacks</font><font color="#E5E5E5"> that we</font>

356
00:13:46,630 --> 00:13:50,620
had<font color="#E5E5E5"> in May all the way back to</font><font color="#CCCCCC"> February</font>

357
00:13:48,580 --> 00:13:51,940
<font color="#CCCCCC">and so this obviously</font><font color="#E5E5E5"> was a big thing</font>

358
00:13:50,620 --> 00:13:53,620
<font color="#CCCCCC">for us so we wanted to kind of jump in</font>

359
00:13:51,940 --> 00:13:55,180
on this<font color="#CCCCCC"> I kind of figure out what was</font>

360
00:13:53,620 --> 00:13:58,000
going<font color="#CCCCCC"> on was talking activities</font><font color="#E5E5E5"> around</font>

361
00:13:55,180 --> 00:14:00,489
her and was<font color="#CCCCCC"> this</font><font color="#E5E5E5"> are essentially patient</font>

362
00:13:58,000 --> 00:14:02,260
zero and this what gave us<font color="#E5E5E5"> the most</font>

363
00:14:00,490 --> 00:14:04,600
<font color="#CCCCCC">insight to these attacks I</font><font color="#E5E5E5"> allow just</font>

364
00:14:02,260 --> 00:14:07,870
kind<font color="#E5E5E5"> of create links</font><font color="#CCCCCC"> to other groups and</font>

365
00:14:04,600 --> 00:14:10,510
other activity that<font color="#CCCCCC"> we are later talked</font>

366
00:14:07,870 --> 00:14:12,070
about so when we first<font color="#CCCCCC"> found these</font><font color="#E5E5E5"> new</font>

367
00:14:10,510 --> 00:14:14,530
samples we kind of had a quick<font color="#CCCCCC"> look to</font>

368
00:14:12,070 --> 00:14:17,260
see<font color="#E5E5E5"> what similarities to water or what</font>

369
00:14:14,530 --> 00:14:19,060
differences there was and the first main

370
00:14:17,260 --> 00:14:21,130
difference was it didn't contain<font color="#E5E5E5"> the</font>

371
00:14:19,060 --> 00:14:22,839
aterna<font color="#CCCCCC"> bloom exploit code at all and</font>

372
00:14:21,130 --> 00:14:25,060
this was something that was<font color="#E5E5E5"> like oh</font>

373
00:14:22,840 --> 00:14:27,550
right<font color="#E5E5E5"> this is a big thing</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

374
00:14:25,060 --> 00:14:29,619
something<font color="#CCCCCC"> that my pre days and when</font>

375
00:14:27,550 --> 00:14:32,939
<font color="#E5E5E5">internal blue was actually added to want</font>

376
00:14:29,620 --> 00:14:35,050
to cry<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> dug this version one and</font>

377
00:14:32,940 --> 00:14:36,430
some of the<font color="#CCCCCC"> similarities</font><font color="#E5E5E5"> so these are</font>

378
00:14:35,050 --> 00:14:38,290
some of<font color="#CCCCCC"> the similar or kind</font><font color="#E5E5E5"> of</font>

379
00:14:36,430 --> 00:14:40,839
simplistic<font color="#E5E5E5"> one so I did a cryptic</font>

380
00:14:38,290 --> 00:14:43,510
<font color="#E5E5E5">filename for example and Warner</font>

381
00:14:40,840 --> 00:14:46,240
<font color="#CCCCCC">decrypter</font><font color="#E5E5E5"> products he used exclamations</font>

382
00:14:43,510 --> 00:14:48,790
instead of<font color="#CCCCCC"> odd symbols and the component</font>

383
00:14:46,240 --> 00:14:50,650
<font color="#E5E5E5">files in the archives that</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> better</font>

384
00:14:48,790 --> 00:14:52,660
<font color="#E5E5E5">within the resources and followed</font>

385
00:14:50,650 --> 00:14:54,250
similar<font color="#E5E5E5"> naming conventions and the</font>

386
00:14:52,660 --> 00:14:57,400
<font color="#CCCCCC">configuration format was identical</font>

387
00:14:54,250 --> 00:14:58,780
<font color="#E5E5E5">across the two samples and</font><font color="#CCCCCC"> the passwords</font>

388
00:14:57,400 --> 00:15:00,670
used to encrypt the archive<font color="#CCCCCC"> that was</font>

389
00:14:58,780 --> 00:15:02,560
<font color="#E5E5E5">embedded within it were</font><font color="#CCCCCC"> somewhat similar</font>

390
00:15:00,670 --> 00:15:07,510
as well<font color="#E5E5E5"> so the kind of reference while I</font>

391
00:15:02,560 --> 00:15:10,119
cry<font color="#CCCCCC"> for the first victim</font><font color="#E5E5E5"> that we</font>

392
00:15:07,510 --> 00:15:12,400
actually<font color="#E5E5E5"> found and this was our February</font>

393
00:15:10,120 --> 00:15:13,840
victim<font color="#E5E5E5"> and we weren't able to retrieve</font><font color="#CCCCCC"> a</font>

394
00:15:12,400 --> 00:15:15,730
full timeline<font color="#E5E5E5"> of the events that</font>

395
00:15:13,840 --> 00:15:17,560
<font color="#CCCCCC">happened on</font><font color="#E5E5E5"> the machine but we started</font>

396
00:15:15,730 --> 00:15:20,970
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> at I need events around</font>

397
00:15:17,560 --> 00:15:23,229
<font color="#CCCCCC">we seem</font><font color="#E5E5E5"> wanna cry version</font><font color="#CCCCCC"> 1 on this</font><font color="#E5E5E5"> and</font>

398
00:15:20,970 --> 00:15:25,389
within this organization<font color="#CCCCCC"> and we found</font>

399
00:15:23,230 --> 00:15:27,939
some<font color="#CCCCCC"> additional</font><font color="#E5E5E5"> tools on some</font><font color="#CCCCCC"> activity</font>

400
00:15:25,389 --> 00:15:30,339
there the first one was we've seen many

401
00:15:27,939 --> 00:15:32,680
<font color="#CCCCCC">cuts have been deployed</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> had been</font>

402
00:15:30,339 --> 00:15:34,420
used<font color="#CCCCCC"> dope credentials from the machine</font>

403
00:15:32,680 --> 00:15:36,339
that had been<font color="#CCCCCC"> affected and</font><font color="#E5E5E5"> those</font>

404
00:15:34,420 --> 00:15:40,839
credentials<font color="#CCCCCC"> were then later stored into</font>

405
00:15:36,339 --> 00:15:42,879
a file called<font color="#CCCCCC"> cgw ry and and then</font>

406
00:15:40,839 --> 00:15:45,670
another till watch<font color="#E5E5E5"> which kind of looked</font>

407
00:15:42,879 --> 00:15:48,249
like a network scanner and called HP

408
00:15:45,670 --> 00:15:50,559
tasks and was also<font color="#CCCCCC"> deployed onto that</font>

409
00:15:48,249 --> 00:15:52,930
<font color="#E5E5E5">machine and it looks like the attackers</font>

410
00:15:50,559 --> 00:15:55,329
could provide a<font color="#CCCCCC"> command line argument</font>

411
00:15:52,930 --> 00:15:57,758
<font color="#CCCCCC">which would allow it to</font><font color="#E5E5E5"> assert our</font>

412
00:15:55,329 --> 00:16:00,160
search through an IP range and and

413
00:15:57,759 --> 00:16:03,430
<font color="#E5E5E5">basically attempt to mount remote</font><font color="#CCCCCC"> chairs</font>

414
00:16:00,160 --> 00:16:07,329
<font color="#E5E5E5">using the</font><font color="#CCCCCC"> credentials from</font><font color="#E5E5E5"> that cg</font><font color="#CCCCCC"> w ry</font>

415
00:16:03,430 --> 00:16:09,540
<font color="#E5E5E5">file and if it was able</font><font color="#CCCCCC"> to create a</font>

416
00:16:07,329 --> 00:16:12,209
successful<font color="#CCCCCC"> connection it would then</font>

417
00:16:09,540 --> 00:16:14,889
essentially add this to a log file and

418
00:16:12,209 --> 00:16:16,899
<font color="#CCCCCC">then it would copy some wanna cry</font>

419
00:16:14,889 --> 00:16:19,059
components and from version<font color="#CCCCCC"> one across</font>

420
00:16:16,899 --> 00:16:20,529
<font color="#E5E5E5">onto these machines and the table that</font>

421
00:16:19,059 --> 00:16:22,389
<font color="#E5E5E5">I've listed here</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of gives you some</font>

422
00:16:20,529 --> 00:16:25,269
details of<font color="#E5E5E5"> some of those components</font><font color="#CCCCCC"> that</font>

423
00:16:22,389 --> 00:16:26,680
were copied<font color="#CCCCCC"> across so we seen</font><font color="#E5E5E5"> like an</font>

424
00:16:25,269 --> 00:16:27,910
<font color="#CCCCCC">the</font><font color="#E5E5E5"> application for displaying the</font>

425
00:16:26,680 --> 00:16:30,309
messages which<font color="#CCCCCC"> were stored</font><font color="#E5E5E5"> in some</font>

426
00:16:27,910 --> 00:16:32,980
additional files<font color="#E5E5E5"> we also</font><font color="#CCCCCC"> had the</font><font color="#E5E5E5"> one</font>

427
00:16:30,309 --> 00:16:35,050
acquire encryption component itself<font color="#CCCCCC"> the</font>

428
00:16:32,980 --> 00:16:37,540
<font color="#E5E5E5">configuration</font><font color="#CCCCCC"> details and then the</font>

429
00:16:35,050 --> 00:16:39,490
<font color="#E5E5E5">message</font><font color="#CCCCCC"> files so most of your files are</font>

430
00:16:37,540 --> 00:16:42,309
encrypted or the instructions of<font color="#E5E5E5"> how to</font>

431
00:16:39,490 --> 00:16:47,740
be able<font color="#CCCCCC"> to pay and your Bitcoin ransom</font>

432
00:16:42,309 --> 00:16:50,379
and the<font color="#E5E5E5"> February victim as</font><font color="#CCCCCC"> well and we</font>

433
00:16:47,740 --> 00:16:53,500
also<font color="#E5E5E5"> seen that this HP task till was</font>

434
00:16:50,379 --> 00:16:56,019
also the tool that<font color="#E5E5E5"> was used to</font><font color="#CCCCCC"> execute</font>

435
00:16:53,500 --> 00:16:58,870
<font color="#CCCCCC">the newly copied one account</font><font color="#E5E5E5"> samples on</font>

436
00:16:56,019 --> 00:17:01,019
these remote machines and and we also

437
00:16:58,870 --> 00:17:03,550
had<font color="#E5E5E5"> identify some additional tools and</font>

438
00:17:01,019 --> 00:17:05,890
<font color="#E5E5E5">back doors that were on the infected</font>

439
00:17:03,550 --> 00:17:08,230
<font color="#CCCCCC">machines</font><font color="#E5E5E5"> as well and we</font><font color="#CCCCCC"> weren't</font><font color="#E5E5E5"> able at</font>

440
00:17:05,890 --> 00:17:09,760
the time to kind<font color="#E5E5E5"> of make any additional</font>

441
00:17:08,230 --> 00:17:11,470
<font color="#CCCCCC">links but when we started looking</font><font color="#E5E5E5"> at</font>

442
00:17:09,760 --> 00:17:12,939
some<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the victims from March and April</font>

443
00:17:11,470 --> 00:17:14,740
that kind of cleared up the picture

444
00:17:12,939 --> 00:17:16,270
<font color="#E5E5E5">first so some of the tools that we did</font>

445
00:17:14,740 --> 00:17:18,510
find in this organization was a<font color="#CCCCCC"> hawk</font>

446
00:17:16,270 --> 00:17:20,809
<font color="#CCCCCC">tail we</font><font color="#E5E5E5"> caught</font><font color="#CCCCCC"> desta over-involved mer</font>

447
00:17:18,510 --> 00:17:25,158
downloader and

448
00:17:20,809 --> 00:17:27,619
we had some proxy<font color="#E5E5E5"> tools as well so the</font>

449
00:17:25,159 --> 00:17:29,840
<font color="#E5E5E5">March and April victims so we had signs</font>

450
00:17:27,619 --> 00:17:31,580
of additional victims<font color="#E5E5E5"> and we had at</font>

451
00:17:29,840 --> 00:17:33,139
least<font color="#E5E5E5"> five</font><font color="#CCCCCC"> organizations that we had</font>

452
00:17:31,580 --> 00:17:37,039
<font color="#E5E5E5">identified I have been impacted</font><font color="#CCCCCC"> in</font>

453
00:17:33,139 --> 00:17:39,678
throughout<font color="#E5E5E5"> this period and new samples</font>

454
00:17:37,039 --> 00:17:41,749
of one<font color="#E5E5E5"> car</font><font color="#CCCCCC"> I modified versions of one</font>

455
00:17:39,679 --> 00:17:44,149
<font color="#CCCCCC">acquired version one had been prepared</font>

456
00:17:41,749 --> 00:17:45,919
for each of these<font color="#E5E5E5"> victims and they</font><font color="#CCCCCC"> have</font>

457
00:17:44,149 --> 00:17:47,809
been delivered<font color="#E5E5E5"> when we looked at the</font>

458
00:17:45,919 --> 00:17:49,700
victimology itself<font color="#E5E5E5"> it kind of seemed a</font>

459
00:17:47,809 --> 00:17:52,789
bit<font color="#E5E5E5"> odd and majority of</font><font color="#CCCCCC"> all these</font>

460
00:17:49,700 --> 00:17:55,490
<font color="#E5E5E5">victims were actually located and within</font>

461
00:17:52,789 --> 00:17:58,279
<font color="#E5E5E5">Asia and but there was no real pattern</font>

462
00:17:55,490 --> 00:18:01,249
to the type<font color="#E5E5E5"> of industries</font><font color="#CCCCCC"> that were</font>

463
00:17:58,279 --> 00:18:03,980
being impacted<font color="#E5E5E5"> so we had</font><font color="#CCCCCC"> organizations</font>

464
00:18:01,249 --> 00:18:05,869
<font color="#E5E5E5">from government hospitality and chemical</font>

465
00:18:03,980 --> 00:18:07,759
industries but<font color="#CCCCCC"> the only kind of pattern</font>

466
00:18:05,869 --> 00:18:09,320
<font color="#CCCCCC">that kind</font><font color="#E5E5E5"> of emerged from that was they</font>

467
00:18:07,759 --> 00:18:12,289
<font color="#E5E5E5">were all</font><font color="#CCCCCC"> organizations none of them were</font>

468
00:18:09,320 --> 00:18:14,389
individuals or consumers and we also

469
00:18:12,289 --> 00:18:16,158
<font color="#E5E5E5">found</font><font color="#CCCCCC"> some additional</font><font color="#E5E5E5"> backdoors and this</font>

470
00:18:14,389 --> 00:18:17,508
is what<font color="#E5E5E5"> kind of gave us the most amount</font>

471
00:18:16,159 --> 00:18:20,419
<font color="#E5E5E5">of information linking it</font><font color="#CCCCCC"> back to</font>

472
00:18:17,509 --> 00:18:22,009
previous<font color="#E5E5E5"> attacks and within these</font>

473
00:18:20,419 --> 00:18:24,110
<font color="#E5E5E5">organizations we</font><font color="#CCCCCC"> had seen in</font><font color="#E5E5E5"> some cases</font>

474
00:18:22,009 --> 00:18:26,480
a new backdoor that hadn't<font color="#CCCCCC"> been</font>

475
00:18:24,110 --> 00:18:28,189
identified<font color="#E5E5E5"> before called children of</font><font color="#CCCCCC"> Alf</font>

476
00:18:26,480 --> 00:18:30,649
<font color="#CCCCCC">nack had been identified and</font><font color="#E5E5E5"> we had</font>

477
00:18:28,190 --> 00:18:32,960
evidence<font color="#E5E5E5"> of this to being used to deploy</font>

478
00:18:30,649 --> 00:18:35,658
<font color="#CCCCCC">one equai and we also had another</font>

479
00:18:32,960 --> 00:18:37,909
<font color="#CCCCCC">backdoor called Trojan of Bravo neck and</font>

480
00:18:35,659 --> 00:18:40,519
we also were<font color="#CCCCCC"> able to find evidence</font><font color="#E5E5E5"> of</font>

481
00:18:37,909 --> 00:18:45,889
this being used to deploy one<font color="#CCCCCC"> occurring</font>

482
00:18:40,519 --> 00:18:48,230
in some of these victims so an alpha

483
00:18:45,889 --> 00:18:51,498
<font color="#CCCCCC">knock itself had been used drop wanna</font>

484
00:18:48,230 --> 00:18:53,419
cry<font color="#E5E5E5"> entry victims and it's a slightly</font>

485
00:18:51,499 --> 00:18:55,009
modified version that<font color="#E5E5E5"> was deployed to</font>

486
00:18:53,419 --> 00:18:58,369
<font color="#E5E5E5">each of these are within each of these</font>

487
00:18:55,009 --> 00:19:01,460
<font color="#CCCCCC">environments and the backdoor itself</font><font color="#E5E5E5"> um</font>

488
00:18:58,369 --> 00:19:03,289
<font color="#E5E5E5">I've been copied</font><font color="#CCCCCC"> onto the machines and</font>

489
00:19:01,460 --> 00:19:04,970
then we've seen<font color="#E5E5E5"> two minutes later many</font>

490
00:19:03,289 --> 00:19:07,899
cuts<font color="#E5E5E5"> being deployed through that tool</font>

491
00:19:04,970 --> 00:19:11,960
and many carts<font color="#CCCCCC"> were then executed</font>

492
00:19:07,899 --> 00:19:15,408
so essentially<font color="#CCCCCC"> dumped the credentials</font>

493
00:19:11,960 --> 00:19:16,610
<font color="#E5E5E5">and then it would install</font><font color="#CCCCCC"> WinRAR</font><font color="#E5E5E5"> to be</font>

494
00:19:15,409 --> 00:19:17,869
able<font color="#E5E5E5"> to collect</font><font color="#CCCCCC"> those credentials</font><font color="#E5E5E5"> and</font>

495
00:19:16,610 --> 00:19:21,619
move it off<font color="#E5E5E5"> to some attacker control</font>

496
00:19:17,869 --> 00:19:23,749
every<font color="#CCCCCC"> software and later</font><font color="#E5E5E5"> we seen another</font>

497
00:19:21,619 --> 00:19:25,730
tool called<font color="#CCCCCC"> G dot exe been deployed and</font>

498
00:19:23,749 --> 00:19:28,070
just<font color="#E5E5E5"> performed</font><font color="#CCCCCC"> UNESCO</font><font color="#E5E5E5"> cops and this was</font>

499
00:19:25,730 --> 00:19:29,700
used basically to<font color="#E5E5E5"> identify some machines</font>

500
00:19:28,070 --> 00:19:31,500
that were of value<font color="#CCCCCC"> to the attacker</font>

501
00:19:29,700 --> 00:19:33,540
so and they used that<font color="#CCCCCC"> to profile in</font>

502
00:19:31,500 --> 00:19:34,770
<font color="#E5E5E5">network</font><font color="#CCCCCC"> research and the</font><font color="#E5E5E5"> return and even</font>

503
00:19:33,540 --> 00:19:37,110
<font color="#E5E5E5">connected some additional information</font><font color="#CCCCCC"> at</font>

504
00:19:34,770 --> 00:19:38,940
later stages<font color="#E5E5E5"> we also found some</font>

505
00:19:37,110 --> 00:19:40,800
<font color="#CCCCCC">additional tools</font><font color="#E5E5E5"> are also seen</font><font color="#CCCCCC"> in the</font>

506
00:19:38,940 --> 00:19:42,090
February victim as well<font color="#E5E5E5"> so</font><font color="#CCCCCC"> again that</font>

507
00:19:40,800 --> 00:19:44,340
<font color="#E5E5E5">kind of network scanning tool that we</font>

508
00:19:42,090 --> 00:19:47,100
identified and<font color="#CCCCCC"> that was used</font><font color="#E5E5E5"> to deploy</font><font color="#CCCCCC"> I</font>

509
00:19:44,340 --> 00:19:49,310
wanna cry and also<font color="#CCCCCC"> being</font><font color="#E5E5E5"> used</font><font color="#CCCCCC"> to execute</font>

510
00:19:47,100 --> 00:19:52,080
the samples on those remote machines

511
00:19:49,310 --> 00:19:54,659
<font color="#CCCCCC">Bravo knock yourself and was so</font><font color="#E5E5E5"> much</font>

512
00:19:52,080 --> 00:19:57,030
different<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> US and it actually</font><font color="#CCCCCC"> used</font>

513
00:19:54,660 --> 00:19:59,450
a set of common<font color="#E5E5E5"> passwords and to be able</font>

514
00:19:57,030 --> 00:20:03,420
<font color="#E5E5E5">to connect SMB shares and in order to</font>

515
00:19:59,450 --> 00:20:06,120
copy across wanna cry<font color="#CCCCCC"> and we also found</font>

516
00:20:03,420 --> 00:20:07,620
<font color="#E5E5E5">other variants of</font><font color="#CCCCCC"> Bravo NOC which</font>

517
00:20:06,120 --> 00:20:11,939
actually<font color="#E5E5E5"> contain one acquire embedded</font>

518
00:20:07,620 --> 00:20:13,739
within itself so the links<font color="#CCCCCC"> and related</font>

519
00:20:11,940 --> 00:20:15,120
activity<font color="#E5E5E5"> so I'll try get to</font><font color="#CCCCCC"> fit as</font>

520
00:20:13,740 --> 00:20:16,680
quickly<font color="#E5E5E5"> only probably take a couple</font><font color="#CCCCCC"> of</font>

521
00:20:15,120 --> 00:20:18,510
<font color="#E5E5E5">minutes because I want to open</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> up for</font>

522
00:20:16,680 --> 00:20:19,800
questions as well and we<font color="#CCCCCC"> fair some</font>

523
00:20:18,510 --> 00:20:22,200
<font color="#E5E5E5">network</font><font color="#CCCCCC"> are shared that</font><font color="#E5E5E5"> were code</font>

524
00:20:19,800 --> 00:20:23,460
between<font color="#CCCCCC"> and doozer and</font><font color="#E5E5E5"> al-falaq</font><font color="#CCCCCC"> and</font>

525
00:20:22,200 --> 00:20:25,200
<font color="#CCCCCC">doozer</font><font color="#E5E5E5"> is a tool that was used by the</font>

526
00:20:23,460 --> 00:20:27,540
group<font color="#E5E5E5"> Lazarus and previous attacks and</font>

527
00:20:25,200 --> 00:20:29,310
it had similar code for generating the

528
00:20:27,540 --> 00:20:31,889
buffer<font color="#E5E5E5"> that was used</font><font color="#CCCCCC"> for command</font><font color="#E5E5E5"> and</font>

529
00:20:29,310 --> 00:20:34,290
control communications<font color="#E5E5E5"> and somewhat</font><font color="#CCCCCC"> of a</font>

530
00:20:31,890 --> 00:20:36,200
fake SSL handshake and a<font color="#CCCCCC"> generated</font>

531
00:20:34,290 --> 00:20:39,420
random number which<font color="#CCCCCC"> was then used to</font>

532
00:20:36,200 --> 00:20:42,120
<font color="#E5E5E5">look up a table</font><font color="#CCCCCC"> and to send some</font><font color="#E5E5E5"> data to</font>

533
00:20:39,420 --> 00:20:44,310
the<font color="#E5E5E5"> SI toos and this table was identical</font>

534
00:20:42,120 --> 00:20:45,719
<font color="#E5E5E5">across the two samples and which it was</font>

535
00:20:44,310 --> 00:20:47,929
a kind of strong indication<font color="#CCCCCC"> that this</font>

536
00:20:45,720 --> 00:20:50,280
<font color="#CCCCCC">was a shared call between</font><font color="#E5E5E5"> these two and</font>

537
00:20:47,930 --> 00:20:52,170
they also repented the same kind<font color="#E5E5E5"> of</font>

538
00:20:50,280 --> 00:20:55,350
marker or a<font color="#E5E5E5"> signature to the start of on</font>

539
00:20:52,170 --> 00:20:56,580
ec2 communications as<font color="#E5E5E5"> well when we</font>

540
00:20:55,350 --> 00:20:58,469
decrypted some of the strings within<font color="#E5E5E5"> the</font>

541
00:20:56,580 --> 00:20:59,669
two samples so alpha knock inducer<font color="#E5E5E5"> we</font>

542
00:20:58,470 --> 00:21:01,410
found<font color="#CCCCCC"> that the decrypted strings were</font>

543
00:20:59,670 --> 00:21:03,240
pretty much<font color="#CCCCCC"> identical for the most part</font>

544
00:21:01,410 --> 00:21:06,210
and this again was a strong indicator

545
00:21:03,240 --> 00:21:09,150
<font color="#CCCCCC">that there was overlap and we</font><font color="#E5E5E5"> also film</font>

546
00:21:06,210 --> 00:21:11,010
<font color="#E5E5E5">an overlap</font><font color="#CCCCCC"> with Bravo</font><font color="#E5E5E5"> knock on</font><font color="#CCCCCC"> user</font>

547
00:21:09,150 --> 00:21:13,080
again and in<font color="#CCCCCC"> doctors</font>

548
00:21:11,010 --> 00:21:16,410
kind of shared cryptographic<font color="#CCCCCC"> and number</font>

549
00:21:13,080 --> 00:21:18,540
of<font color="#E5E5E5"> related routines and there was also</font>

550
00:21:16,410 --> 00:21:20,640
some<font color="#E5E5E5"> additional</font><font color="#CCCCCC"> share code that was</font>

551
00:21:18,540 --> 00:21:23,820
called out<font color="#CCCCCC"> by Google so</font><font color="#E5E5E5"> Neil had</font>

552
00:21:20,640 --> 00:21:26,490
actually<font color="#E5E5E5"> posted two hashes and some</font>

553
00:21:23,820 --> 00:21:29,129
address and locations<font color="#E5E5E5"> the first hash was</font>

554
00:21:26,490 --> 00:21:31,980
one acquired a second<font color="#E5E5E5"> was a variant of</font>

555
00:21:29,130 --> 00:21:34,710
<font color="#CCCCCC">canta P and again kanta p has been used</font>

556
00:21:31,980 --> 00:21:36,570
<font color="#E5E5E5">by lazarus and this group which had been</font>

557
00:21:34,710 --> 00:21:39,540
<font color="#CCCCCC">used against several</font><font color="#E5E5E5"> banks in the past</font>

558
00:21:36,570 --> 00:21:40,379
and we also had shared code which<font color="#E5E5E5"> was</font>

559
00:21:39,540 --> 00:21:43,770
part<font color="#CCCCCC"> of our course</font>

560
00:21:40,380 --> 00:21:45,750
sedimentation<font color="#E5E5E5"> so generally in openness</font>

561
00:21:43,770 --> 00:21:47,280
<font color="#CCCCCC">le</font><font color="#E5E5E5"> of around 300 plus ciphers that</font><font color="#CCCCCC"> you</font>

562
00:21:45,750 --> 00:21:49,320
can choose<font color="#E5E5E5"> from and this implementation</font>

563
00:21:47,280 --> 00:21:53,280
<font color="#E5E5E5">it was limited to</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> 75 and we'd only</font>

564
00:21:49,320 --> 00:21:54,750
<font color="#E5E5E5">seen that across these two</font><font color="#CCCCCC"> samples and</font>

565
00:21:53,280 --> 00:21:57,870
there was<font color="#E5E5E5"> also other chip-ins from other</font>

566
00:21:54,750 --> 00:22:00,420
people<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of identifying that this was</font>

567
00:21:57,870 --> 00:22:05,909
part of<font color="#E5E5E5"> Lazarus and as you can see there</font>

568
00:22:00,420 --> 00:22:07,950
<font color="#CCCCCC">from cousins Yarra will and there's also</font>

569
00:22:05,910 --> 00:22:10,110
some temporal<font color="#E5E5E5"> attribution as well so in</font>

570
00:22:07,950 --> 00:22:12,330
some of<font color="#CCCCCC"> the victims we also</font><font color="#E5E5E5"> found and</font>

571
00:22:10,110 --> 00:22:15,120
some additional<font color="#E5E5E5"> Lazarus</font><font color="#CCCCCC"> till so we had</font>

572
00:22:12,330 --> 00:22:17,159
<font color="#E5E5E5">asked over and involved</font><font color="#CCCCCC"> mer</font><font color="#E5E5E5"> and there's</font>

573
00:22:15,120 --> 00:22:19,649
been<font color="#CCCCCC"> many links kind of already</font>

574
00:22:17,160 --> 00:22:23,010
documented between those two<font color="#E5E5E5"> and we also</font>

575
00:22:19,650 --> 00:22:25,170
seen<font color="#E5E5E5"> al sac and being used in another</font>

576
00:22:23,010 --> 00:22:26,490
sample which was<font color="#E5E5E5"> a job inquiry resume</font>

577
00:22:25,170 --> 00:22:28,140
which kind of suggested maybe this

578
00:22:26,490 --> 00:22:30,990
initially was<font color="#CCCCCC"> impacting these</font>

579
00:22:28,140 --> 00:22:32,340
<font color="#E5E5E5">organizations through email</font><font color="#CCCCCC"> so I'm</font><font color="#E5E5E5"> gonna</font>

580
00:22:30,990 --> 00:22:35,550
shared infrastructure as<font color="#E5E5E5"> well we also</font>

581
00:22:32,340 --> 00:22:37,709
had shared C and C's<font color="#E5E5E5"> so we had Doozer</font>

582
00:22:35,550 --> 00:22:40,350
which connected<font color="#CCCCCC"> to</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> IPS one of which</font>

583
00:22:37,710 --> 00:22:42,840
had been<font color="#E5E5E5"> also a</font><font color="#CCCCCC"> CNC for children of</font>

584
00:22:40,350 --> 00:22:45,719
Bravo<font color="#E5E5E5"> knack and we also had alpha</font><font color="#CCCCCC"> naki</font>

585
00:22:42,840 --> 00:22:48,899
which was<font color="#E5E5E5"> also contacting a CT which was</font>

586
00:22:45,720 --> 00:22:51,180
found in the same file<font color="#E5E5E5"> and that in turn</font>

587
00:22:48,900 --> 00:22:53,310
<font color="#CCCCCC">also</font><font color="#E5E5E5"> AM contacted under I Peter</font><font color="#CCCCCC"> would</font>

588
00:22:51,180 --> 00:22:57,870
<font color="#CCCCCC">share</font><font color="#E5E5E5"> between</font><font color="#CCCCCC"> dr. otaku pops another</font>

589
00:22:53,310 --> 00:23:00,419
<font color="#CCCCCC">Lazarus - so we are able</font><font color="#E5E5E5"> to assign some</font>

590
00:22:57,870 --> 00:23:02,459
<font color="#CCCCCC">confidence value</font><font color="#E5E5E5"> cities</font><font color="#CCCCCC"> under links we</font>

591
00:23:00,420 --> 00:23:04,140
had network infrastructure overlap which

592
00:23:02,460 --> 00:23:06,690
we had hard links on our<font color="#E5E5E5"> kind of high</font>

593
00:23:04,140 --> 00:23:09,600
confidence same infiltration<font color="#E5E5E5"> in terms of</font>

594
00:23:06,690 --> 00:23:12,060
the tools that were and found we also

595
00:23:09,600 --> 00:23:14,129
had shared<font color="#E5E5E5"> code which kind of range</font>

596
00:23:12,060 --> 00:23:15,240
between<font color="#CCCCCC"> a kind of</font><font color="#E5E5E5"> medium to weak</font><font color="#CCCCCC"> but</font>

597
00:23:14,130 --> 00:23:16,800
<font color="#E5E5E5">when you kind of put them all together</font>

598
00:23:15,240 --> 00:23:19,110
it kind<font color="#CCCCCC"> of suggested to us that</font><font color="#E5E5E5"> this was</font>

599
00:23:16,800 --> 00:23:22,290
<font color="#E5E5E5">a high confidence and we all saw</font><font color="#CCCCCC"> till</font>

600
00:23:19,110 --> 00:23:23,820
co-occurrence so and<font color="#CCCCCC"> lazarus tools on</font>

601
00:23:22,290 --> 00:23:25,649
impacted victims that we<font color="#E5E5E5"> had want to cry</font>

602
00:23:23,820 --> 00:23:28,200
<font color="#E5E5E5">and we also kind of had some techniques</font>

603
00:23:25,650 --> 00:23:31,080
which we considered weak so like the use

604
00:23:28,200 --> 00:23:32,550
<font color="#CCCCCC">of hard coded SMB credentials and</font>

605
00:23:31,080 --> 00:23:34,350
password<font color="#E5E5E5"> this</font><font color="#CCCCCC"> to be able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> spread over</font>

606
00:23:32,550 --> 00:23:36,629
<font color="#E5E5E5">SMB which was also seen</font><font color="#CCCCCC"> in other tools</font>

607
00:23:34,350 --> 00:23:41,610
used by<font color="#E5E5E5"> a la Souris in the past</font><font color="#CCCCCC"> so since</font>

608
00:23:36,630 --> 00:23:43,740
Jonah so the lessons learned were pretty

609
00:23:41,610 --> 00:23:46,229
bad<font color="#E5E5E5"> Apache and the patch</font><font color="#CCCCCC"> had being</font>

610
00:23:43,740 --> 00:23:48,390
released about<font color="#E5E5E5"> a month previous and but</font>

611
00:23:46,230 --> 00:23:49,950
yes we still had<font color="#CCCCCC"> and</font><font color="#E5E5E5"> all these victims</font>

612
00:23:48,390 --> 00:23:52,470
<font color="#E5E5E5">that have been impacted by wanna cry and</font>

613
00:23:49,950 --> 00:23:53,799
either for reasons<font color="#E5E5E5"> like OEM equipment</font>

614
00:23:52,470 --> 00:23:56,860
legal certificate

615
00:23:53,799 --> 00:23:59,289
reasons or kind of rogue devices<font color="#CCCCCC"> we're</font>

616
00:23:56,860 --> 00:24:00,850
still bad at performing<font color="#E5E5E5"> backups and a</font>

617
00:23:59,289 --> 00:24:02,950
lot<font color="#CCCCCC"> of people</font><font color="#E5E5E5"> that I was</font><font color="#CCCCCC"> talking to have</font>

618
00:24:00,850 --> 00:24:04,779
said oh it's cool I have really good

619
00:24:02,950 --> 00:24:06,460
<font color="#E5E5E5">restoration plans in place but when you</font>

620
00:24:04,779 --> 00:24:08,289
<font color="#E5E5E5">ask them what happens when you're the</font>

621
00:24:06,460 --> 00:24:10,210
directory server is knocked offline<font color="#E5E5E5"> or</font>

622
00:24:08,289 --> 00:24:12,039
<font color="#CCCCCC">your network is down</font><font color="#E5E5E5"> how can you restore</font>

623
00:24:10,210 --> 00:24:14,110
<font color="#E5E5E5">them and they were pretty much kind</font><font color="#CCCCCC"> of</font>

624
00:24:12,039 --> 00:24:16,629
plain that<font color="#E5E5E5"> they were essentially dead in</font>

625
00:24:14,110 --> 00:24:18,158
the<font color="#E5E5E5"> water at</font><font color="#CCCCCC"> that stage</font><font color="#E5E5E5"> and there's no</font>

626
00:24:16,629 --> 00:24:19,238
such thing as your perimeter so a lot<font color="#CCCCCC"> of</font>

627
00:24:18,159 --> 00:24:21,909
other people were<font color="#E5E5E5"> saying oh I've blocked</font>

628
00:24:19,239 --> 00:24:22,360
port for four or<font color="#E5E5E5"> five</font><font color="#CCCCCC"> on my</font><font color="#E5E5E5"> firewall I'm</font>

629
00:24:21,909 --> 00:24:24,549
good

630
00:24:22,360 --> 00:24:28,959
but that's<font color="#E5E5E5"> not really the case why</font>

631
00:24:24,549 --> 00:24:30,249
you'll<font color="#CCCCCC"> see a lot of kind of issues are</font>

632
00:24:28,960 --> 00:24:31,570
kind of<font color="#E5E5E5"> public we</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> use byline</font>

633
00:24:30,249 --> 00:24:33,399
let's say for example machines coming

634
00:24:31,570 --> 00:24:36,820
<font color="#CCCCCC">into</font><font color="#E5E5E5"> your network and linked to motor</font>

635
00:24:33,399 --> 00:24:39,008
vendors to your corporate network<font color="#E5E5E5"> and</font>

636
00:24:36,820 --> 00:24:40,869
other things as well<font color="#CCCCCC"> which kind of open</font>

637
00:24:39,009 --> 00:24:43,090
your<font color="#E5E5E5"> perimeter so that</font><font color="#CCCCCC"> line between your</font>

638
00:24:40,869 --> 00:24:46,959
perimeter<font color="#E5E5E5"> and order other parameters can</font>

639
00:24:43,090 --> 00:24:50,649
kind of become more ambiguous<font color="#E5E5E5"> and a bit</font>

640
00:24:46,960 --> 00:24:52,419
<font color="#E5E5E5">more blurred as such as security</font><font color="#CCCCCC"> in</font>

641
00:24:50,649 --> 00:24:54,219
published<font color="#E5E5E5"> and procedures and continuity</font>

642
00:24:52,419 --> 00:24:55,690
planning does work Friday the customers

643
00:24:54,220 --> 00:24:57,399
that<font color="#E5E5E5"> we talked that didn't get impacted</font>

644
00:24:55,690 --> 00:24:58,779
by this<font color="#E5E5E5"> they had really</font><font color="#CCCCCC"> good policies in</font>

645
00:24:57,399 --> 00:25:00,488
<font color="#CCCCCC">place they had really good procedures</font>

646
00:24:58,779 --> 00:25:02,619
and continuity planning there and they

647
00:25:00,489 --> 00:25:03,789
were able for<font color="#E5E5E5"> any ones that were</font>

648
00:25:02,619 --> 00:25:06,178
impacted they were able<font color="#E5E5E5"> to quickly</font>

649
00:25:03,789 --> 00:25:09,340
restore services and get back to<font color="#CCCCCC"> working</font>

650
00:25:06,179 --> 00:25:11,320
so the takeaways wanna cry is extremely

651
00:25:09,340 --> 00:25:14,109
disruptive attack and the leak of

652
00:25:11,320 --> 00:25:16,840
eternal blue was<font color="#CCCCCC"> the reason why this</font>

653
00:25:14,109 --> 00:25:19,480
turned<font color="#E5E5E5"> into a global</font><font color="#CCCCCC"> threat and expected</font>

654
00:25:16,840 --> 00:25:21,009
losses<font color="#E5E5E5"> and productivity and</font><font color="#CCCCCC"> an efforts</font>

655
00:25:19,480 --> 00:25:23,499
to mitigate were significant<font color="#E5E5E5"> because</font><font color="#CCCCCC"> of</font>

656
00:25:21,009 --> 00:25:25,570
<font color="#E5E5E5">this attack</font><font color="#CCCCCC"> and we found multiple strong</font>

657
00:25:23,499 --> 00:25:29,049
links<font color="#E5E5E5"> to previous attacks conducted by</font>

658
00:25:25,570 --> 00:25:30,609
<font color="#CCCCCC">Lazarus and we had overlaps</font><font color="#E5E5E5"> in some kind</font>

659
00:25:29,049 --> 00:25:33,129
of technical aspects<font color="#CCCCCC"> like code sharing</font>

660
00:25:30,609 --> 00:25:35,499
<font color="#E5E5E5">and</font><font color="#CCCCCC"> c2</font>

661
00:25:33,129 --> 00:25:37,779
communications<font color="#E5E5E5"> and he also had previous</font>

662
00:25:35,499 --> 00:25:40,269
<font color="#CCCCCC">well documented and links to</font><font color="#E5E5E5"> other</font>

663
00:25:37,779 --> 00:25:42,369
attacks such<font color="#CCCCCC"> as the attacks on Sony with</font>

664
00:25:40,269 --> 00:25:45,070
<font color="#E5E5E5">test over and Bangladesh central bank</font>

665
00:25:42,369 --> 00:25:46,959
account<font color="#CCCCCC"> EP and we also</font><font color="#E5E5E5"> had despite the</font>

666
00:25:45,070 --> 00:25:49,809
links Lazarus<font color="#CCCCCC"> it doesn't</font><font color="#E5E5E5"> look like that</font>

667
00:25:46,960 --> 00:25:52,539
it was<font color="#E5E5E5"> and</font><font color="#CCCCCC"> paired</font><font color="#E5E5E5"> kind of hallmarks of a</font>

668
00:25:49,809 --> 00:25:54,279
<font color="#CCCCCC">nation stays and kind</font><font color="#E5E5E5"> of type of</font>

669
00:25:52,539 --> 00:25:55,749
<font color="#E5E5E5">campaign and for the fact</font><font color="#CCCCCC"> that it was</font>

670
00:25:54,279 --> 00:25:58,119
looked like that the<font color="#CCCCCC"> till was</font><font color="#E5E5E5"> hurriedly</font>

671
00:25:55,749 --> 00:26:00,179
put<font color="#CCCCCC"> together and while it might</font><font color="#E5E5E5"> being</font>

672
00:25:58,119 --> 00:26:02,740
inducted<font color="#E5E5E5"> by Lazarus</font><font color="#CCCCCC"> it looks like it was</font>

673
00:26:00,179 --> 00:26:05,710
possibly<font color="#E5E5E5"> financially motivated initially</font>

674
00:26:02,740 --> 00:26:07,690
but<font color="#E5E5E5"> either</font><font color="#CCCCCC"> Accardo or something happened</font>

675
00:26:05,710 --> 00:26:08,980
<font color="#CCCCCC">where and they basically</font><font color="#E5E5E5"> have weaponized</font>

676
00:26:07,690 --> 00:26:11,950
<font color="#E5E5E5">way to turn a blue and</font><font color="#CCCCCC"> I kind of spread</font>

677
00:26:08,980 --> 00:26:22,450
<font color="#E5E5E5">be under control and finally we're still</font>

678
00:26:11,950 --> 00:26:24,429
<font color="#E5E5E5">about</font><font color="#CCCCCC"> a patching oh thank</font><font color="#E5E5E5"> you thank</font><font color="#CCCCCC"> you</font>

679
00:26:22,450 --> 00:26:26,260
<font color="#CCCCCC">Alan for the talk</font><font color="#E5E5E5"> and sorry we</font><font color="#CCCCCC"> cannot</font>

680
00:26:24,429 --> 00:26:28,090
take<font color="#CCCCCC"> a</font><font color="#E5E5E5"> questions at this time</font><font color="#CCCCCC"> because we</font>

681
00:26:26,260 --> 00:26:31,029
have better over time<font color="#E5E5E5"> but you can catch</font>

682
00:26:28,090 --> 00:26:34,659
probably<font color="#E5E5E5"> Alan during the break</font><font color="#CCCCCC"> and ask</font>

683
00:26:31,029 --> 00:26:35,470
him<font color="#CCCCCC"> questions yeah</font><font color="#E5E5E5"> I think not</font>

684
00:26:34,660 --> 00:26:36,480
[Applause]

685
00:26:35,470 --> 00:26:39,259
[Music]

686
00:26:36,480 --> 00:26:39,259
[Applause]

