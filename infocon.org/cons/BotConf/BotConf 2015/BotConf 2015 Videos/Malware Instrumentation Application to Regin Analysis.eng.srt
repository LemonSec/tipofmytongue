1
00:00:00,000 --> 00:00:05,150
okay so now we're going more in depth

2
00:00:05,150 --> 00:00:09,800
into the malware in this case quickly

3
00:00:09,800 --> 00:00:13,340
with the metric asthmatics presentation

4
00:00:13,340 --> 00:00:15,870
yeah we're switched so you have the

5
00:00:15,870 --> 00:00:18,779
floor thank you thank you so here for

6
00:00:18,779 --> 00:00:21,080
the boring stuff so I work for Verizon

7
00:00:21,080 --> 00:00:23,939
but I do not speak on the behalf of

8
00:00:23,939 --> 00:00:26,880
verizon that's not that my team does not

9
00:00:26,880 --> 00:00:29,460
support me with this presentation just

10
00:00:29,460 --> 00:00:33,960
bigger stuff you but yeah you are so

11
00:00:33,960 --> 00:00:36,000
yeah it's this is not marketing

12
00:00:36,000 --> 00:00:39,180
presentation or anything that no

13
00:00:39,180 --> 00:00:44,129
intentional attribution or sorry about

14
00:00:44,129 --> 00:00:47,460
that so first let's have a reminder of

15
00:00:47,460 --> 00:00:49,680
what is working there was a couple of

16
00:00:49,680 --> 00:00:54,350
article about this and basically it is a

17
00:00:54,350 --> 00:00:59,100
malware that is used to collect

18
00:00:59,100 --> 00:01:03,600
information and many people make a lot

19
00:01:03,600 --> 00:01:09,330
of birds about this component are you

20
00:01:09,330 --> 00:01:12,869
have a launcher stager sometimes a care

21
00:01:12,869 --> 00:01:15,420
Colonel component and use all on

22
00:01:15,420 --> 00:01:18,299
component well this is like plug is you

23
00:01:18,299 --> 00:01:20,400
do not care about that this just for

24
00:01:20,400 --> 00:01:21,810
persistent this is d completely

25
00:01:21,810 --> 00:01:24,890
disposable stage 1 stage 2 it just

26
00:01:24,890 --> 00:01:28,979
something you can change easily to full

27
00:01:28,979 --> 00:01:34,979
aav detection then sometimes have driver

28
00:01:34,979 --> 00:01:36,990
why would you like would you like a

29
00:01:36,990 --> 00:01:41,700
driver today usually it's when you want

30
00:01:41,700 --> 00:01:43,860
to hide your communication within a

31
00:01:43,860 --> 00:01:47,100
legitimate channel for example you you

32
00:01:47,100 --> 00:01:50,280
have a web server and you want to infect

33
00:01:50,280 --> 00:01:53,280
it and to take some part of the

34
00:01:53,280 --> 00:01:54,810
communication of the web server so you

35
00:01:54,810 --> 00:01:58,619
will look the network stack take some

36
00:01:58,619 --> 00:02:02,430
packets that are with a blueprint and to

37
00:02:02,430 --> 00:02:05,520
do that you need the driver is very but

38
00:02:05,520 --> 00:02:09,449
just for that back in today's they're

39
00:02:09,449 --> 00:02:13,890
always put the driver do not always

40
00:02:13,890 --> 00:02:18,810
use it but but today is a lot I don't

41
00:02:18,810 --> 00:02:20,640
know if today but the most recent

42
00:02:20,640 --> 00:02:23,220
attraction i saw was only use or non

43
00:02:23,220 --> 00:02:27,690
affection so do not be afraid by rigging

44
00:02:27,690 --> 00:02:31,800
as oh it's driver complex know most of

45
00:02:31,800 --> 00:02:37,860
the interesting stuff there so on top of

46
00:02:37,860 --> 00:02:42,840
that like plug eggs or any malware that

47
00:02:42,840 --> 00:02:45,959
are really widely used there are modules

48
00:02:45,959 --> 00:02:48,720
so that you can make it evolve or adapt

49
00:02:48,720 --> 00:02:52,560
it according to your target and those

50
00:02:52,560 --> 00:02:55,590
modules are stored within some kind of

51
00:02:55,590 --> 00:02:58,380
virtual file system just of storage

52
00:02:58,380 --> 00:03:01,200
space again it's not something complex

53
00:03:01,200 --> 00:03:05,040
it's just a storage place so we're just

54
00:03:05,040 --> 00:03:09,630
a reminder so why do i present waiting

55
00:03:09,630 --> 00:03:13,170
at botnet add vodka because it is a

56
00:03:13,170 --> 00:03:18,390
botnet it is not what it is not a usual

57
00:03:18,390 --> 00:03:21,329
troyer yarn with command and control

58
00:03:21,329 --> 00:03:23,760
stuff like that so if you have I uses

59
00:03:23,760 --> 00:03:28,709
about wagon with IPS right just of our

60
00:03:28,709 --> 00:03:35,340
DN youth because we gain is when you

61
00:03:35,340 --> 00:03:38,640
install a wagon node you configure

62
00:03:38,640 --> 00:03:43,380
outbound connections peers and there is

63
00:03:43,380 --> 00:03:46,640
some kind of routing protocol like bgp

64
00:03:46,640 --> 00:03:50,810
that relays the communication over the

65
00:03:50,810 --> 00:03:54,180
network over the botnet now like a

66
00:03:54,180 --> 00:03:56,160
peer-to-peer port and peer peer to peer

67
00:03:56,160 --> 00:04:01,739
botnet so concerning those connections

68
00:04:01,739 --> 00:04:04,170
you can anyone just need the module for

69
00:04:04,170 --> 00:04:07,560
connection can be TCP can be you dt can

70
00:04:07,560 --> 00:04:10,500
be in the mid pipes can be cookies can

71
00:04:10,500 --> 00:04:13,980
be files can be USB keys can be anything

72
00:04:13,980 --> 00:04:20,029
you want on the other hand to receive

73
00:04:20,029 --> 00:04:23,160
messages you need to open port so you

74
00:04:23,160 --> 00:04:26,310
need a module that open connection or

75
00:04:26,310 --> 00:04:28,550
listen to the connect

76
00:04:28,550 --> 00:04:33,410
more than that so this is just for the

77
00:04:33,410 --> 00:04:37,320
networking part but on top of that you

78
00:04:37,320 --> 00:04:41,550
have a trust layer with first of all

79
00:04:41,550 --> 00:04:48,270
ready and actually to send packets

80
00:04:48,270 --> 00:04:52,950
message to another node you need to have

81
00:04:52,950 --> 00:04:55,680
a public key or private key that is

82
00:04:55,680 --> 00:04:58,380
trusted by which to publicly trusted on

83
00:04:58,380 --> 00:05:02,280
the other side so put you come on like

84
00:05:02,280 --> 00:05:04,530
ssh server you know you have the period

85
00:05:04,530 --> 00:05:06,690
key you connect your your server because

86
00:05:06,690 --> 00:05:09,930
it took your nonno stir twisted key is

87
00:05:09,930 --> 00:05:18,240
to that so basically this is it here so

88
00:05:18,240 --> 00:05:22,430
I hear the VPN overly each node has

89
00:05:22,430 --> 00:05:25,610
virtual IP because when you are

90
00:05:25,610 --> 00:05:30,510
operating this kind of botnet you do not

91
00:05:30,510 --> 00:05:34,740
care about the actual IP of the of the

92
00:05:34,740 --> 00:05:37,740
infected machine you just need to have

93
00:05:37,740 --> 00:05:40,140
some IDs that you maintain internally so

94
00:05:40,140 --> 00:05:46,770
it's not as a virtual IP and so that you

95
00:05:46,770 --> 00:05:50,310
can for example would your you are at

96
00:05:50,310 --> 00:05:52,770
home there are bunch of connection

97
00:05:52,770 --> 00:05:54,990
everywhere about you know that you want

98
00:05:54,990 --> 00:05:57,900
to update the filters that collect

99
00:05:57,900 --> 00:06:00,960
emails on a server somewhere you just

100
00:06:00,960 --> 00:06:03,300
have the IP of the server somewhere you

101
00:06:03,300 --> 00:06:06,270
send the date and it will be routed over

102
00:06:06,270 --> 00:06:09,540
the botnet to other term this is how it

103
00:06:09,540 --> 00:06:12,810
works and you have masternodes

104
00:06:12,810 --> 00:06:14,940
masternodes is note that you have at

105
00:06:14,940 --> 00:06:17,430
home that is the most node that control

106
00:06:17,430 --> 00:06:20,970
everything actually there are several

107
00:06:20,970 --> 00:06:24,390
masternodes ja o master node / no to

108
00:06:24,390 --> 00:06:31,170
master notes / victim and well let's see

109
00:06:31,170 --> 00:06:36,350
that so this is typically what you have

110
00:06:36,979 --> 00:06:41,510
victim a that got infected

111
00:06:41,600 --> 00:06:45,450
forum victim a someone infected victim

112
00:06:45,450 --> 00:06:49,140
be and from LinkedIn be you can go to

113
00:06:49,140 --> 00:06:52,530
victim see and you have a master node

114
00:06:52,530 --> 00:06:57,270
that control everything here so I've put

115
00:06:57,270 --> 00:07:00,120
some XX because you can in Don this is

116
00:07:00,120 --> 00:07:05,060
oh yeah do not do like my respected

117
00:07:05,840 --> 00:07:08,490
antivirus researcher that too who is on

118
00:07:08,490 --> 00:07:12,590
the virtual IP of the nodes this is

119
00:07:12,590 --> 00:07:15,330
nonsense this is a great variety i just

120
00:07:15,330 --> 00:07:19,470
put XX just joining my stuff because if

121
00:07:19,470 --> 00:07:22,320
you are the article you can know which

122
00:07:22,320 --> 00:07:25,770
is this victim according to the IP but

123
00:07:25,770 --> 00:07:27,270
this is your strategy it's not to

124
00:07:27,270 --> 00:07:32,040
actually be this is interesting this is

125
00:07:32,040 --> 00:07:35,520
in germany or this was in germany this

126
00:07:35,520 --> 00:07:41,370
was in ireland i believe and victim see

127
00:07:41,370 --> 00:07:45,720
was in Saddam so you have this kind of

128
00:07:45,720 --> 00:07:48,390
network that go about everywhere in the

129
00:07:48,390 --> 00:07:52,229
world and from where you can operate

130
00:07:52,229 --> 00:07:56,820
very big botnet very big this is one

131
00:07:56,820 --> 00:08:00,990
victim when you have a wig in the

132
00:08:00,990 --> 00:08:03,470
typical virgin injection looks like that

133
00:08:03,470 --> 00:08:07,620
you have master node that have control

134
00:08:07,620 --> 00:08:11,940
over everything the shed lines are trust

135
00:08:11,940 --> 00:08:16,550
that is everybody trusts the mass road

136
00:08:16,820 --> 00:08:19,350
the other lines are actual connection

137
00:08:19,350 --> 00:08:22,290
and what you can see is that in that

138
00:08:22,290 --> 00:08:26,760
picture everyone about everyone first

139
00:08:26,760 --> 00:08:29,360
the master node but i do not have any

140
00:08:29,360 --> 00:08:32,039
strong line to the master node this is

141
00:08:32,039 --> 00:08:34,020
because i did not find any connection

142
00:08:34,020 --> 00:08:36,089
actual connection to the mass alone I do

143
00:08:36,089 --> 00:08:38,429
not know from where it comes and how to

144
00:08:38,429 --> 00:08:42,150
reach it this is this is the actual

145
00:08:42,150 --> 00:08:46,020
command and control and this is why i

146
00:08:46,020 --> 00:08:49,589
use is about I pru series domain name I

147
00:08:49,589 --> 00:08:53,630
uses about weddings usually of no use

148
00:08:53,630 --> 00:08:57,020
in this network you can see particular

149
00:08:57,020 --> 00:09:01,400
node like this one this one this one

150
00:09:01,400 --> 00:09:06,460
that seems to collect information from

151
00:09:06,460 --> 00:09:10,100
collectors and this is it that is

152
00:09:10,100 --> 00:09:16,490
waiting is like sim one you have

153
00:09:16,490 --> 00:09:19,160
collectors for events a distributed over

154
00:09:19,160 --> 00:09:22,490
your network and that are centralized at

155
00:09:22,490 --> 00:09:27,200
some point and actually those particular

156
00:09:27,200 --> 00:09:30,110
nodes of concentrators and exfiltration

157
00:09:30,110 --> 00:09:33,560
points in this infection there was eight

158
00:09:33,560 --> 00:09:41,000
out boond point that is eight point to

159
00:09:41,000 --> 00:09:45,160
go outside the dictum and I believe

160
00:09:45,160 --> 00:09:51,890
those those exit nodes were actually

161
00:09:51,890 --> 00:09:55,970
going to other victims well like to

162
00:09:55,970 --> 00:09:58,310
really know where is that command and

163
00:09:58,310 --> 00:10:02,360
control it is very difficult so ah I

164
00:10:02,360 --> 00:10:05,270
wanted to show that to try to explain

165
00:10:05,270 --> 00:10:07,840
that to you because in what I saw in

166
00:10:07,840 --> 00:10:12,290
public communication about wagon they

167
00:10:12,290 --> 00:10:15,020
explained it just like a need for run or

168
00:10:15,020 --> 00:10:19,370
any remote access tool and this is very

169
00:10:19,370 --> 00:10:22,370
not it when you deal with reckon if you

170
00:10:22,370 --> 00:10:24,920
ever did with it you have to draw this

171
00:10:24,920 --> 00:10:27,770
kind of map to hunt for each infected

172
00:10:27,770 --> 00:10:32,660
node because if you do like the usual

173
00:10:32,660 --> 00:10:36,200
stuff looking for the dominant control

174
00:10:36,200 --> 00:10:40,460
and booked into IP you you won't stop

175
00:10:40,460 --> 00:10:47,770
the infection huh but how does it work

176
00:10:48,070 --> 00:10:50,840
because to operate this kind of self and

177
00:10:50,840 --> 00:10:55,190
to have some kind of reliability over

178
00:10:55,190 --> 00:10:57,560
this network you need a specific design

179
00:10:57,560 --> 00:11:01,850
and this is designed on with the seeker

180
00:11:01,850 --> 00:11:04,430
serious service oriented architecture as

181
00:11:04,430 --> 00:11:06,640
way with

182
00:11:06,640 --> 00:11:09,400
err pc protocol remote procedure call

183
00:11:09,400 --> 00:11:16,750
and if you did with virgin you know it

184
00:11:16,750 --> 00:11:20,340
because of this template this is our

185
00:11:20,340 --> 00:11:24,970
NRCC so it's not ID ideas yet but will

186
00:11:24,970 --> 00:11:31,330
come what is it RPC so this is a

187
00:11:31,330 --> 00:11:34,930
civilized data that you send to this

188
00:11:34,930 --> 00:11:39,190
virtual IP so this is a local IP it's

189
00:11:39,190 --> 00:11:41,290
not local IP are actually two mastre

190
00:11:41,290 --> 00:11:49,930
reporting note but okay 127 00 to this

191
00:11:49,930 --> 00:11:53,260
is the module that you want to worry and

192
00:11:53,260 --> 00:11:55,390
this is the onload you want to query so

193
00:11:55,390 --> 00:11:58,990
basically anything you want you will do

194
00:11:58,990 --> 00:12:02,560
is working is sent remote procedure call

195
00:12:02,560 --> 00:12:05,680
to is on your local node or to a remote

196
00:12:05,680 --> 00:12:09,130
node and everything is done with modules

197
00:12:09,130 --> 00:12:12,850
and unders you want to add an IP you

198
00:12:12,850 --> 00:12:16,180
want to add a keyword you just add a

199
00:12:16,180 --> 00:12:19,510
keyword to the module that under mail

200
00:12:19,510 --> 00:12:22,150
interception this is really how it works

201
00:12:22,150 --> 00:12:26,880
and all the modules like documented in

202
00:12:26,880 --> 00:12:31,300
Simon thetac and kaspersky documents are

203
00:12:31,300 --> 00:12:33,910
mostly related to interception and

204
00:12:33,910 --> 00:12:40,140
collection of data and it is pretty

205
00:12:40,140 --> 00:12:43,300
easily too white module and this is what

206
00:12:43,300 --> 00:12:47,910
you should do because of this complexity

207
00:12:47,910 --> 00:12:53,230
this way of working costs a lot because

208
00:12:53,230 --> 00:12:55,660
you have the malware you will do some

209
00:12:55,660 --> 00:12:58,180
reverse engineering to know how you are

210
00:12:58,180 --> 00:13:01,330
impacted what information are collected

211
00:13:01,330 --> 00:13:05,970
and then you will write some tools to

212
00:13:05,970 --> 00:13:08,590
decode the information with the virtual

213
00:13:08,590 --> 00:13:11,860
file system and a vecina lat and this

214
00:13:11,860 --> 00:13:16,360
takes days to test to compile we test

215
00:13:16,360 --> 00:13:18,670
with you and you go back to reverse

216
00:13:18,670 --> 00:13:19,890
engineering

217
00:13:19,890 --> 00:13:26,200
this way is odd this way is what I would

218
00:13:26,200 --> 00:13:29,080
recommend because working is really well

219
00:13:29,080 --> 00:13:33,090
couldn't on the air PC architecture and

220
00:13:33,090 --> 00:13:36,820
what you just need to do is to get some

221
00:13:36,820 --> 00:13:41,530
pointers on those are PC anger and we're

222
00:13:41,530 --> 00:13:44,680
with a note you want to have the data

223
00:13:44,680 --> 00:13:46,660
that is in the virtual file system just

224
00:13:46,660 --> 00:13:50,380
worried so this is more and more

225
00:13:50,380 --> 00:13:54,270
instrumentation and in the paper that

226
00:13:54,270 --> 00:13:57,760
submitted to both cough is explaining

227
00:13:57,760 --> 00:13:59,500
the details of the instrumentation and

228
00:13:59,500 --> 00:14:03,450
this is what I want to show you a tree

229
00:14:04,320 --> 00:14:15,730
okay so typical example here are create

230
00:14:15,730 --> 00:14:21,850
a stream I query module 9 under 52 with

231
00:14:21,850 --> 00:14:27,640
wife the connection list to the peer

232
00:14:27,640 --> 00:14:32,440
node and you can do that as long as you

233
00:14:32,440 --> 00:14:35,860
have instrumentation of the building so

234
00:14:35,860 --> 00:14:39,730
we're starting now you can interrupt me

235
00:14:39,730 --> 00:14:44,140
and asked question anytime no question

236
00:14:44,140 --> 00:14:46,290
yet

237
00:15:03,260 --> 00:15:10,550
so how it works this is for Paul so i

238
00:15:10,550 --> 00:15:12,650
told you about instrumentation we gained

239
00:15:12,650 --> 00:15:19,040
the architecture so basically the first

240
00:15:19,040 --> 00:15:23,000
thing you need to know is the number

241
00:15:23,000 --> 00:15:27,430
that module ID and that under ID and

242
00:15:27,430 --> 00:15:31,070
this is quite easily be easy to spot in

243
00:15:31,070 --> 00:15:35,090
waiting because you need to instantiate

244
00:15:35,090 --> 00:15:39,350
modules and this is how you do it you

245
00:15:39,350 --> 00:15:43,180
just do module you with some parameters

246
00:15:43,180 --> 00:15:47,270
with Sam oh dude ID and the model object

247
00:15:47,270 --> 00:15:50,870
and this part charm is always the same

248
00:15:50,870 --> 00:15:56,000
and it is you can even white yahoo to

249
00:15:56,000 --> 00:16:01,610
spot the module definition so here we

250
00:16:01,610 --> 00:16:04,160
have the definition for module nine that

251
00:16:04,160 --> 00:16:06,140
can you handle everything that is

252
00:16:06,140 --> 00:16:15,800
related to network then this is not this

253
00:16:15,800 --> 00:16:24,490
one yet yeah then you define unders

254
00:16:25,510 --> 00:16:28,670
module add under and you have IDs for

255
00:16:28,670 --> 00:16:31,250
others so this is how you collect try

256
00:16:31,250 --> 00:16:33,890
these folders and you have the actual

257
00:16:33,890 --> 00:16:38,000
under which is this function then

258
00:16:38,000 --> 00:16:44,480
looking into the function you will know

259
00:16:44,480 --> 00:16:49,820
that the function with the word that

260
00:16:49,820 --> 00:16:52,250
will be then positioned so you have the

261
00:16:52,250 --> 00:16:56,630
actual signature of the under so I have

262
00:16:56,630 --> 00:17:00,440
the module ideas under rd the parameters

263
00:17:00,440 --> 00:17:07,030
have to sent it I just no need to

264
00:17:09,280 --> 00:17:15,349
actually watch it so I take a pointer on

265
00:17:15,349 --> 00:17:17,510
module nine for example or what do I do

266
00:17:17,510 --> 00:17:26,810
here no it's not this one here so let's

267
00:17:26,810 --> 00:17:33,890
say I want to query dust under 17 of 19

268
00:17:33,890 --> 00:17:39,970
I know this is an IV so I parks an IV I

269
00:17:39,970 --> 00:17:44,110
put it in the stream so what the word

270
00:17:44,110 --> 00:17:49,550
pretty 0 and then send the swim to

271
00:17:49,550 --> 00:17:56,720
underline under 17 and what is

272
00:17:56,720 --> 00:18:04,010
interesting is that it actually works so

273
00:18:04,010 --> 00:18:06,740
this is available on the Internet this

274
00:18:06,740 --> 00:18:09,520
is a code that dude everything I just

275
00:18:09,520 --> 00:18:14,660
explained instrumentation I load the

276
00:18:14,660 --> 00:18:18,920
library offer again take a few pointers

277
00:18:18,920 --> 00:18:23,540
to the module management at stuff like

278
00:18:23,540 --> 00:18:30,760
that wyd the code and just have a nice

279
00:18:30,760 --> 00:18:34,580
interface to coriander so if i want to

280
00:18:34,580 --> 00:18:42,320
set for example net set IP it won't work

281
00:18:42,320 --> 00:18:50,870
you will see our set IP 02 so ginger

282
00:18:50,870 --> 00:18:55,150
first tell me so this is actually this

283
00:18:55,150 --> 00:18:58,940
so i just sent to model line I want to

284
00:18:58,940 --> 00:19:02,990
be the eyes of virtual IP 02 and can be

285
00:19:02,990 --> 00:19:06,350
all cryptic is not fun I told you before

286
00:19:06,350 --> 00:19:09,500
you need prevent a publicly associated

287
00:19:09,500 --> 00:19:17,170
to your RT so I will do that crypto key

288
00:19:17,170 --> 00:19:19,240
crypto

289
00:19:19,240 --> 00:19:37,950
10 JP MP jordans 2011 6902 169 success

290
00:19:37,950 --> 00:19:45,040
okay just so i changed my IP it's not

291
00:19:45,040 --> 00:19:54,090
film not yet no I told you I have to

292
00:19:55,830 --> 00:20:00,160
open port to communicate receive data so

293
00:20:00,160 --> 00:20:09,910
net add tcp in port 80 let you let's at

294
00:20:09,910 --> 00:20:13,300
first so let's start I have nothing oh

295
00:20:13,300 --> 00:20:20,309
I've already it open net miss teen yeah

296
00:20:20,309 --> 00:20:25,679
so here I can see that module 6 37 t3 is

297
00:20:25,679 --> 00:20:31,870
listening on port 80 and it is actually

298
00:20:31,870 --> 00:20:34,570
listening and you know what actually the

299
00:20:34,570 --> 00:20:41,950
service the help this is all the under

300
00:20:41,950 --> 00:20:45,040
are coded and you can add more if you

301
00:20:45,040 --> 00:20:46,900
want the source code is available on the

302
00:20:46,900 --> 00:20:51,580
internet so and no for Paul who told

303
00:20:51,580 --> 00:20:59,350
that the demo never walked net cons here

304
00:20:59,350 --> 00:21:03,630
are so here maybe you want so I

305
00:21:03,630 --> 00:21:09,400
configurator an output connection to not

306
00:21:09,400 --> 00:21:14,290
IP 0002 via whoa dude citrus 73 that is

307
00:21:14,290 --> 00:21:18,059
actually tcp to that actually this is

308
00:21:18,059 --> 00:21:22,150
real IP which is desirey of this vm on

309
00:21:22,150 --> 00:21:25,140
port 80

310
00:21:25,460 --> 00:21:28,039
and then I will tell you about that one

311
00:21:28,039 --> 00:21:32,570
later so I've configuring something and

312
00:21:32,570 --> 00:21:38,230
if I do something like that msg 0002

313
00:21:38,230 --> 00:21:48,470
hello maybe it will work hey so I just

314
00:21:48,470 --> 00:21:50,840
sent a message from here drink learn to

315
00:21:50,840 --> 00:21:58,220
trust minute more details here there are

316
00:21:58,220 --> 00:22:02,570
some sister and Jerry 2443 another thing

317
00:22:02,570 --> 00:22:04,250
you need to know is working is that

318
00:22:04,250 --> 00:22:07,880
third when you do not communicate so its

319
00:22:07,880 --> 00:22:10,750
initialization channel and data channel

320
00:22:10,750 --> 00:22:13,760
the data channel it d is dynamically

321
00:22:13,760 --> 00:22:17,720
array initialized on the saucer section

322
00:22:17,720 --> 00:22:23,380
note that is if you look here

323
00:22:28,080 --> 00:22:32,669
this one is currently established but it

324
00:22:32,669 --> 00:22:36,750
has been opened on the reception of the

325
00:22:36,750 --> 00:22:38,760
initialization message this is a

326
00:22:38,760 --> 00:22:43,860
protocol the note that sends a message

327
00:22:43,860 --> 00:22:46,380
tells the reception not ok i will send

328
00:22:46,380 --> 00:22:52,380
you data on that channel so you can for

329
00:22:52,380 --> 00:22:56,519
example initiates channel with DNS query

330
00:22:56,519 --> 00:23:02,039
and tells open may OTC purport or 443

331
00:23:02,039 --> 00:23:05,639
this will be open dynamically and sent

332
00:23:05,639 --> 00:23:08,850
to them and then you will use the data

333
00:23:08,850 --> 00:23:11,429
to networks internet so this is also

334
00:23:11,429 --> 00:23:15,019
tricky because when you see our UCS and

335
00:23:15,019 --> 00:23:17,370
intelligence on working this raise a

336
00:23:17,370 --> 00:23:19,470
talk about the initialization channel

337
00:23:19,470 --> 00:23:21,929
but you also need to look at the data

338
00:23:21,929 --> 00:23:23,850
tenant which you really want to have the

339
00:23:23,850 --> 00:23:29,539
communication no question

340
00:23:36,450 --> 00:23:42,270
I saw from your diagram that you have an

341
00:23:42,270 --> 00:23:45,390
IP internal IP of the master node yeah

342
00:23:45,390 --> 00:23:46,860
and you have a great framework to

343
00:23:46,860 --> 00:23:48,030
communicate have you tried to

344
00:23:48,030 --> 00:23:50,160
communicate the master node to send him

345
00:23:50,160 --> 00:23:52,530
at all Forbes all well I only do that on

346
00:23:52,530 --> 00:23:55,980
my small laptop I understand so no life

347
00:23:55,980 --> 00:23:58,560
experiments with their aging no way life

348
00:23:58,560 --> 00:24:02,820
in spearmint would say and about those

349
00:24:02,820 --> 00:24:10,340
master load because this is interesting

350
00:24:10,970 --> 00:24:17,430
here so i told you as possible I've put

351
00:24:17,430 --> 00:24:21,330
XX here to this is because you have a

352
00:24:21,330 --> 00:24:27,410
wagon networks are organized on / 8

353
00:24:27,410 --> 00:24:30,390
subnetwork virtual itís always talk

354
00:24:30,390 --> 00:24:33,000
about what we're trying to do not do who

355
00:24:33,000 --> 00:24:35,910
is on the citee this is stupid I have to

356
00:24:35,910 --> 00:24:39,230
repeat it because people do that and

357
00:24:39,230 --> 00:24:42,060
this is oh you can actually indentify

358
00:24:42,060 --> 00:24:48,440
victims because the master node easily

359
00:24:48,800 --> 00:24:55,980
first IP in 2 / 8 with ending seven and

360
00:24:55,980 --> 00:25:01,380
eight so for example 1550 the master

361
00:25:01,380 --> 00:25:05,010
node of the victim 50 would be 50 dot 0

362
00:25:05,010 --> 00:25:09,330
dot 0 dot 7 and there is the sigil

363
00:25:09,330 --> 00:25:11,940
Melissa always too much to note because

364
00:25:11,940 --> 00:25:14,790
of residency and the second will be 50

365
00:25:14,790 --> 00:25:18,390
donne 0 donne 0 dot eight then you have

366
00:25:18,390 --> 00:25:21,270
to master reporting note you do not see

367
00:25:21,270 --> 00:25:23,640
master reporting not because master

368
00:25:23,640 --> 00:25:26,460
control igg nodes have trust over

369
00:25:26,460 --> 00:25:29,250
everything Master reporting node our

370
00:25:29,250 --> 00:25:32,520
trust by no one but they can receive

371
00:25:32,520 --> 00:25:35,870
thing from anyone so they trust everyone

372
00:25:35,870 --> 00:25:39,420
those from mastre reporting node of IP

373
00:25:39,420 --> 00:25:45,210
so for example 5000 6 and 5000 54

374
00:25:45,210 --> 00:25:49,299
remember why i do not know about one

375
00:25:49,299 --> 00:25:51,580
two and three but I believe there are

376
00:25:51,580 --> 00:25:58,419
used for specific purpose go to another

377
00:25:58,419 --> 00:26:02,440
question again about masternodes maybe

378
00:26:02,440 --> 00:26:12,580
how much time do I have yet okay master

379
00:26:12,580 --> 00:26:15,940
nada will interesting because I told you

380
00:26:15,940 --> 00:26:18,940
about those majha like this every module

381
00:26:18,940 --> 00:26:25,600
I've seen has an odd modulite but for

382
00:26:25,600 --> 00:26:33,190
example 96 373 always odd but some even

383
00:26:33,190 --> 00:26:36,399
modulus these are referenced in the code

384
00:26:36,399 --> 00:26:43,960
and they have a special wall because you

385
00:26:43,960 --> 00:26:47,679
can if you have a different model ID you

386
00:26:47,679 --> 00:26:50,559
can send message and signed and they are

387
00:26:50,559 --> 00:26:55,499
trusted so I don't know if you part of a

388
00:26:55,499 --> 00:26:58,029
company that do some control until

389
00:26:58,029 --> 00:27:00,190
engines you can try to impress on eight

390
00:27:00,190 --> 00:27:04,210
modules using even model ID and

391
00:27:04,210 --> 00:27:06,999
communicate with the master node because

392
00:27:06,999 --> 00:27:09,190
to communicate with master node you need

393
00:27:09,190 --> 00:27:11,799
to have a private key that is trusted

394
00:27:11,799 --> 00:27:14,499
with with associated to the key that you

395
00:27:14,499 --> 00:27:17,440
trusted by the master node but if you

396
00:27:17,440 --> 00:27:20,889
have evil modularity and this can be

397
00:27:20,889 --> 00:27:27,508
actually spotted in the either here or

398
00:27:28,950 --> 00:27:33,419
is it was it was it was it

399
00:27:36,080 --> 00:27:47,929
oh maybe here yeah what'd you hear this

400
00:27:47,929 --> 00:27:50,750
is very particular in when you do some

401
00:27:50,750 --> 00:27:52,309
reverse engineering you you will

402
00:27:52,309 --> 00:27:54,289
understand why the spirit picker

403
00:27:54,289 --> 00:27:57,590
particular copulation bottom you see

404
00:27:57,590 --> 00:28:00,890
here there be x equals 1 I will tell you

405
00:28:00,890 --> 00:28:05,690
that and to actually set a constant

406
00:28:05,690 --> 00:28:10,370
value you do 1 plus each doesn't make

407
00:28:10,370 --> 00:28:13,700
sense usually you put just F naught 1

408
00:28:13,700 --> 00:28:20,179
plus p and note that f is older and e is

409
00:28:20,179 --> 00:28:31,850
Evan why because the here here here this

410
00:28:31,850 --> 00:28:35,419
is our B X it is defined here I believe

411
00:28:35,419 --> 00:28:38,320
that this is a compilation constant

412
00:28:38,320 --> 00:28:42,950
laser set at one or zero zero when you

413
00:28:42,950 --> 00:28:44,899
have much load so everything will be

414
00:28:44,899 --> 00:28:49,000
compiled with even moduli DS with more

415
00:28:49,000 --> 00:28:52,639
power that are twisted everywhere some

416
00:28:52,639 --> 00:28:56,740
kind of back door and when you have a

417
00:28:56,740 --> 00:29:01,610
slave node that we will put on victim

418
00:29:01,610 --> 00:29:04,039
side you will set the compilation

419
00:29:04,039 --> 00:29:10,510
protein at one note that from what I saw

420
00:29:10,510 --> 00:29:14,480
wagon nodes are compiled a few hours

421
00:29:14,480 --> 00:29:19,809
before infection so this will make sense

422
00:29:19,809 --> 00:29:26,919
so I did not really experiment with even

423
00:29:26,919 --> 00:29:30,260
body ladies but if somebody want to do

424
00:29:30,260 --> 00:29:33,669
and to try please

425
00:29:34,639 --> 00:29:39,979
other stuff Dr still time

426
00:29:46,730 --> 00:29:49,220
because I had some spare stylus like you

427
00:29:49,220 --> 00:29:52,450
do not have an equation Oh

428
00:29:55,960 --> 00:29:59,560
oh this flag you mentioned will it be

429
00:29:59,560 --> 00:30:02,800
test at the source node at each node in

430
00:30:02,800 --> 00:30:04,900
the past to the master node because you

431
00:30:04,900 --> 00:30:06,490
said you would be able to communicate

432
00:30:06,490 --> 00:30:11,460
because you don't need signing key but

433
00:30:11,460 --> 00:30:14,380
where is it checked if it's only as you

434
00:30:14,380 --> 00:30:16,960
started start node where you could fake

435
00:30:16,960 --> 00:30:22,330
the flags it's useless actually so on to

436
00:30:22,330 --> 00:30:29,680
be precise so much in line check that

437
00:30:29,680 --> 00:30:36,120
your air pc is signed with everything

438
00:30:36,120 --> 00:30:40,200
quickly and add that access control

439
00:30:40,200 --> 00:30:44,340
there is a white list of modules that

440
00:30:44,340 --> 00:30:47,860
bypass the timing process and this

441
00:30:47,860 --> 00:30:52,510
whitest is actually stored on the on the

442
00:30:52,510 --> 00:30:55,000
virtual file system you know as argument

443
00:30:55,000 --> 00:30:59,260
and this is what I collected so you have

444
00:30:59,260 --> 00:31:03,480
it on the paper where is it here yeah

445
00:31:03,480 --> 00:31:08,800
exactly so this is what I collected from

446
00:31:08,800 --> 00:31:13,030
different virtual file system those are

447
00:31:13,030 --> 00:31:17,340
the model IDs that can buy that I

448
00:31:17,340 --> 00:31:27,130
believe bypass the signing verification

449
00:31:27,130 --> 00:31:32,260
and also sported where our those modular

450
00:31:32,260 --> 00:31:34,360
front sides into the source code in the

451
00:31:34,360 --> 00:31:36,820
binary code I don't have the source on

452
00:31:36,820 --> 00:31:40,390
fraternity and 0 seems to be able to

453
00:31:40,390 --> 00:31:46,350
manage modules for seems to be able to

454
00:31:46,350 --> 00:31:51,310
manage connections II to edit the

455
00:31:51,310 --> 00:31:54,810
cryptographic parameters maybe add some

456
00:31:54,810 --> 00:31:59,260
private keys this is why I'm not sure

457
00:31:59,260 --> 00:32:01,470
but it really looks like a bathroom or

458
00:32:01,470 --> 00:32:05,470
some kind of Eden stuff by the developer

459
00:32:05,470 --> 00:32:08,640
to keep an ahead on

460
00:32:08,640 --> 00:32:13,050
on note with some hidden if its turf so

461
00:32:13,050 --> 00:32:15,930
if you are contracting we're going to do

462
00:32:15,930 --> 00:32:18,390
your stuff I do not know I take a look

463
00:32:18,390 --> 00:32:23,250
at that is naturally same stuff or ask

464
00:32:23,250 --> 00:32:26,220
your contractor why did you put that in

465
00:32:26,220 --> 00:32:31,620
the code just useless on the other hand

466
00:32:31,620 --> 00:32:33,210
if you are part of control intelligence

467
00:32:33,210 --> 00:32:34,470
you can look into that it may be

468
00:32:34,470 --> 00:32:36,780
interesting because as far as I know

469
00:32:36,780 --> 00:32:40,110
nobody claimed wagon infection so i

470
00:32:40,110 --> 00:32:41,760
believe first thicker first owner

471
00:32:41,760 --> 00:32:51,140
something like that yeah

472
00:32:56,460 --> 00:32:59,080
thank you so I'm pretty glasses working

473
00:32:59,080 --> 00:33:01,119
for looking class I have a question if

474
00:33:01,119 --> 00:33:03,999
you can potentially write a crawler to

475
00:33:03,999 --> 00:33:05,649
check your local network or even on the

476
00:33:05,649 --> 00:33:07,239
internet for region infections would

477
00:33:07,239 --> 00:33:09,249
that be technically possible yeah buddy

478
00:33:09,249 --> 00:33:11,919
so I believe you can watch some kind of

479
00:33:11,919 --> 00:33:20,889
scanner but why Tunguska is it so to

480
00:33:20,889 --> 00:33:23,499
question hey can you actually white it

481
00:33:23,499 --> 00:33:25,239
yeah definitely just try to communicate

482
00:33:25,239 --> 00:33:28,299
you will see some different pattern in

483
00:33:28,299 --> 00:33:30,460
the communication for example the packet

484
00:33:30,460 --> 00:33:35,519
will be eaten like for example yours a

485
00:33:35,519 --> 00:33:40,869
blueprint for any channel and if you put

486
00:33:40,869 --> 00:33:42,539
the boot prints the package will be

487
00:33:42,539 --> 00:33:45,729
eaten and you won't have the return of

488
00:33:45,729 --> 00:33:48,879
the HTTP GET for example so you can do

489
00:33:48,879 --> 00:33:51,070
almost the same ways very good that is

490
00:33:51,070 --> 00:33:55,049
try to initiate the communication you

491
00:33:55,049 --> 00:33:58,090
you will send some packet and it won't

492
00:33:58,090 --> 00:34:01,269
have the usual behavior because it will

493
00:34:01,269 --> 00:34:04,809
be hit on this is one way the second

494
00:34:04,809 --> 00:34:08,109
question is can you do it without being

495
00:34:08,109 --> 00:34:15,520
noticed this is another story because

496
00:34:15,520 --> 00:34:18,010
yeah if you really want to do it

497
00:34:18,010 --> 00:34:19,869
seriously you you want to do it without

498
00:34:19,869 --> 00:34:23,440
being noticed so yeah you would need to

499
00:34:23,440 --> 00:34:27,190
be somewhere on the backbone send some

500
00:34:27,190 --> 00:34:32,829
TCP packet and we intercept it so yeah

501
00:34:32,829 --> 00:34:35,139
it is possible and did not do that but

502
00:34:35,139 --> 00:34:37,770
it is possible

503
00:34:42,469 --> 00:34:45,888
another question

504
00:34:48,668 --> 00:34:50,980
so if you want to catch up later at the

505
00:34:50,980 --> 00:34:54,899
work program

506
00:35:01,540 --> 00:35:04,030
now have two minutes left you want me to

507
00:35:04,030 --> 00:35:08,800
do have slides left difference

508
00:35:08,800 --> 00:35:11,200
perspective here so what do I say that

509
00:35:11,200 --> 00:35:15,340
yeah do not use it dunno if you use our

510
00:35:15,340 --> 00:35:19,240
uses be cautious it you need to know how

511
00:35:19,240 --> 00:35:21,820
it works before using ioc's because you

512
00:35:21,820 --> 00:35:24,060
have you you will have false confidence

513
00:35:24,060 --> 00:35:30,640
using IOC's with Ricky once I use

514
00:35:30,640 --> 00:35:34,060
structurally detection so this is what i

515
00:35:34,060 --> 00:35:40,030
did in a former position to detect

516
00:35:40,030 --> 00:35:43,600
reagan actually used the file structure

517
00:35:43,600 --> 00:35:47,100
whether that the file names for example

518
00:35:47,100 --> 00:35:54,190
ball as published a way to to detect gfs

519
00:35:54,190 --> 00:35:57,280
the script this is quite good and this

520
00:35:57,280 --> 00:35:59,140
is the way you should do it do the same

521
00:35:59,140 --> 00:36:02,950
for network communication i think yeah

522
00:36:02,950 --> 00:36:05,110
if you want to hunt it just draws a map

523
00:36:05,110 --> 00:36:07,540
and try to go from a node to another

524
00:36:07,540 --> 00:36:11,200
node and so on because this is a botnet

525
00:36:11,200 --> 00:36:14,500
this is not usual command and control

526
00:36:14,500 --> 00:36:20,050
infrastructure if you are an attacker

527
00:36:20,050 --> 00:36:24,820
check about those even nodes this is

528
00:36:24,820 --> 00:36:31,120
really strange move to add credit to

529
00:36:31,120 --> 00:36:35,470
leak is rather than even numbers this is

530
00:36:35,470 --> 00:36:39,640
just but yeah what your mark the in

531
00:36:39,640 --> 00:36:42,490
intercommunication I just useless do it

532
00:36:42,490 --> 00:36:46,530
after the rest if i did a decryption

533
00:36:46,530 --> 00:36:51,660
people who understand that we understand

534
00:36:52,170 --> 00:36:55,290
we are not interesting and if you do

535
00:36:55,290 --> 00:36:58,470
some control intelligence stuff yeah you

536
00:36:58,470 --> 00:37:01,589
can actually instead of decrypting the

537
00:37:01,589 --> 00:37:04,619
traffic from infected note you can

538
00:37:04,619 --> 00:37:07,140
actually activate logging on note with

539
00:37:07,140 --> 00:37:09,359
your associated air kisses this is much

540
00:37:09,359 --> 00:37:12,780
more easier than decrypting doing p caps

541
00:37:12,780 --> 00:37:17,520
and decrypting the traffic in that fire

542
00:37:17,520 --> 00:37:21,930
adversary intent with the function that

543
00:37:21,930 --> 00:37:24,720
our ship at node and know that you can

544
00:37:24,720 --> 00:37:26,849
always use for example to filter

545
00:37:26,849 --> 00:37:29,520
keywords this is for example the

546
00:37:29,520 --> 00:37:32,309
keywords that are used on the mail

547
00:37:32,309 --> 00:37:35,220
servers to filter out mates that won't

548
00:37:35,220 --> 00:37:37,049
be for sale said barbara Jean so if you

549
00:37:37,049 --> 00:37:38,880
put any one of those keywords in your

550
00:37:38,880 --> 00:37:41,160
mail should be filtered out and won't be

551
00:37:41,160 --> 00:37:49,710
intercepted on the wagons of iphone yeah

552
00:37:49,710 --> 00:37:52,349
i know this is for any funny word so i

553
00:37:52,349 --> 00:37:57,349
keep that for the last slide thank

