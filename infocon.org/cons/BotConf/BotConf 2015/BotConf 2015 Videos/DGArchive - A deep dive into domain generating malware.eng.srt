1
00:00:00,319 --> 00:00:04,290
okay good morning we're starting right

2
00:00:04,290 --> 00:00:05,910
on time

3
00:00:05,910 --> 00:00:08,039
so the first presentation for the next

4
00:00:08,039 --> 00:00:10,230
50 minutes is with Danielle from the

5
00:00:10,230 --> 00:00:14,190
front of Institute on a project around D

6
00:00:14,190 --> 00:00:17,190
G a generation by malware you have the

7
00:00:17,190 --> 00:00:20,939
floor good morning nice and somebody

8
00:00:20,939 --> 00:00:23,220
made it so not that many casualties from

9
00:00:23,220 --> 00:00:26,730
last night who was here at last year's

10
00:00:26,730 --> 00:00:30,269
Kampf that's quite a lot who has seen my

11
00:00:30,269 --> 00:00:32,790
lightning talk on the same project okay

12
00:00:32,790 --> 00:00:34,739
so some of you might know how this talk

13
00:00:34,739 --> 00:00:37,980
will start is this generated domain or

14
00:00:37,980 --> 00:00:43,230
not yes it is you were so convinced what

15
00:00:43,230 --> 00:00:48,600
not family is it maybe it's cryptolocker

16
00:00:48,600 --> 00:00:51,449
okay what what about the second one is

17
00:00:51,449 --> 00:00:56,670
this generated No

18
00:00:56,670 --> 00:00:58,710
yeah but yet is it so it's this one miss

19
00:00:58,710 --> 00:01:02,340
you Alice on there's a third one but

20
00:01:02,340 --> 00:01:04,470
that was my kid so the general issue

21
00:01:04,470 --> 00:01:06,510
with that is by just looking at the

22
00:01:06,510 --> 00:01:08,790
domains you have not really a good idea

23
00:01:08,790 --> 00:01:11,220
what kind of dg8 at this and there was a

24
00:01:11,220 --> 00:01:14,070
really frustrating situation to me so i

25
00:01:14,070 --> 00:01:15,840
started looking at DJ's then I got

26
00:01:15,840 --> 00:01:18,030
hooked on DTS and try to find as many as

27
00:01:18,030 --> 00:01:19,590
possible of them find as many C's as

28
00:01:19,590 --> 00:01:20,970
possible then it's basically where we

29
00:01:20,970 --> 00:01:22,710
ended up with this project DG archive

30
00:01:22,710 --> 00:01:25,470
that I'm going to talk about here so

31
00:01:25,470 --> 00:01:28,770
agenda first I'm going to do a quick

32
00:01:28,770 --> 00:01:32,130
introduction on the GS so basically what

33
00:01:32,130 --> 00:01:34,590
is it where does it come from how is it

34
00:01:34,590 --> 00:01:38,490
used what purpose does it fit then my

35
00:01:38,490 --> 00:01:39,900
project DG archive from what you can do

36
00:01:39,900 --> 00:01:42,090
with it then I'm going to compare

37
00:01:42,090 --> 00:01:44,340
basically features you can find out

38
00:01:44,340 --> 00:01:46,439
about DG s and all of the ones that are

39
00:01:46,439 --> 00:01:48,960
connected there I'm very lucky that I

40
00:01:48,960 --> 00:01:51,000
was able to get the registration info

41
00:01:51,000 --> 00:01:53,850
for about 80 million domains by two main

42
00:01:53,850 --> 00:01:56,640
tools they collaborated with me on that

43
00:01:56,640 --> 00:01:59,070
one and then we are looking closer a bit

44
00:01:59,070 --> 00:02:00,630
on on some of the details that you can

45
00:02:00,630 --> 00:02:02,610
do with that kind of data whole talk is

46
00:02:02,610 --> 00:02:05,189
co t green but there will be one short

47
00:02:05,189 --> 00:02:06,899
section afterwards that still be ember

48
00:02:06,899 --> 00:02:09,258
so some content only for this conference

49
00:02:09,258 --> 00:02:11,160
there's only two slides and you will

50
00:02:11,160 --> 00:02:13,020
basically see in advance please don't

51
00:02:13,020 --> 00:02:13,920
tweet about that every

52
00:02:13,920 --> 00:02:17,670
otherwise it's fine okay so the main

53
00:02:17,670 --> 00:02:21,450
generation algorithms um it's a concept

54
00:02:21,450 --> 00:02:23,130
that was basically first described back

55
00:02:23,130 --> 00:02:25,500
in 2008 at least from what I can tell so

56
00:02:25,500 --> 00:02:28,620
back then it was called domain flux some

57
00:02:28,620 --> 00:02:30,510
of you might know on the other hand fast

58
00:02:30,510 --> 00:02:33,120
flux fast for service networks so the

59
00:02:33,120 --> 00:02:35,160
idea behind that is that you have one

60
00:02:35,160 --> 00:02:37,410
domain name or few domain names that

61
00:02:37,410 --> 00:02:39,420
resolve to a lot of IP addresses so that

62
00:02:39,420 --> 00:02:41,430
was basically in order to harm your C&C

63
00:02:41,430 --> 00:02:44,459
infrastructure of IP addresses domain

64
00:02:44,459 --> 00:02:47,100
flux is the inverse principle you will

65
00:02:47,100 --> 00:02:48,780
have a lot of domain names the point to

66
00:02:48,780 --> 00:02:50,970
potentially little number of IP

67
00:02:50,970 --> 00:02:54,269
addresses so in order to achieve this

68
00:02:54,269 --> 00:02:55,920
you can use a domain generation

69
00:02:55,920 --> 00:02:58,440
algorithm so basically an algorithm that

70
00:02:58,440 --> 00:03:02,010
is able to produce CNC information run

71
00:03:02,010 --> 00:03:04,260
the viewpoints dynamically and you can

72
00:03:04,260 --> 00:03:06,209
think of that as a shared secret between

73
00:03:06,209 --> 00:03:08,130
your malware or the guy who coded it on

74
00:03:08,130 --> 00:03:10,980
the compromise host and your bot master

75
00:03:10,980 --> 00:03:13,050
because he obviously has to know how to

76
00:03:13,050 --> 00:03:14,540
generate those domains in order to

77
00:03:14,540 --> 00:03:17,880
register them then I will be talking

78
00:03:17,880 --> 00:03:20,820
about seeds seeds are generally just a

79
00:03:20,820 --> 00:03:23,299
collection of parameters that are used

80
00:03:23,299 --> 00:03:26,579
to influence the algorithm to produce a

81
00:03:26,579 --> 00:03:30,090
certain set of domains and occasionally

82
00:03:30,090 --> 00:03:31,049
I might be using this term

83
00:03:31,049 --> 00:03:34,380
algorithmically generated domain or more

84
00:03:34,380 --> 00:03:36,239
likely the abbreviation a TD because

85
00:03:36,239 --> 00:03:38,579
it's quick to talk about that and that's

86
00:03:38,579 --> 00:03:40,200
basically just domains the fallout over

87
00:03:40,200 --> 00:03:45,140
DGA okay what was the first DGA so

88
00:03:45,140 --> 00:03:47,820
looking at a lot of stuff I basically

89
00:03:47,820 --> 00:03:50,670
found one variant of sanity which did

90
00:03:50,670 --> 00:03:53,190
something that you could call domain

91
00:03:53,190 --> 00:03:55,950
generation back in 2006 so in February

92
00:03:55,950 --> 00:03:58,590
2006 s is one variant of sanity that

93
00:03:58,590 --> 00:04:01,170
uses hard coded second level and

94
00:04:01,170 --> 00:04:03,720
top-level domains but generates a third

95
00:04:03,720 --> 00:04:06,000
level domain for that so this is already

96
00:04:06,000 --> 00:04:09,150
an algorithm that modifies domains but

97
00:04:09,150 --> 00:04:10,920
since the main component of the

98
00:04:10,920 --> 00:04:14,010
renderview is not used for the CNC

99
00:04:14,010 --> 00:04:15,540
contact because if you already have a

100
00:04:15,540 --> 00:04:17,459
hard-coded second-level domain part you

101
00:04:17,459 --> 00:04:19,260
can use a terribly i what we call this

102
00:04:19,260 --> 00:04:21,478
the first instance of DG a so it

103
00:04:21,478 --> 00:04:23,190
basically does it but it doesn't use it

104
00:04:23,190 --> 00:04:26,280
to find the CNC server I actually have

105
00:04:26,280 --> 00:04:27,600
no idea why they put

106
00:04:27,600 --> 00:04:29,520
there may be for authentication because

107
00:04:29,520 --> 00:04:31,290
if you only generate that pair of

108
00:04:31,290 --> 00:04:33,960
third-level domains on that day you want

109
00:04:33,960 --> 00:04:36,780
to authenticate your malware checking in

110
00:04:36,780 --> 00:04:38,970
never found out it's so far in the past

111
00:04:38,970 --> 00:04:41,010
it's hard to get information on that so

112
00:04:41,010 --> 00:04:45,030
the next two instances both around July

113
00:04:45,030 --> 00:04:48,090
2007 are on the one hand topic so

114
00:04:48,090 --> 00:04:49,920
there's one analysis report by Verisign

115
00:04:49,920 --> 00:04:53,520
that already documents DGA like domains

116
00:04:53,520 --> 00:04:57,390
that are later also or can be generated

117
00:04:57,390 --> 00:04:59,070
by the work that president gross did

118
00:04:59,070 --> 00:05:02,100
when he took over topic in early 2008

119
00:05:02,100 --> 00:05:04,710
and on the other hand you can find

120
00:05:04,710 --> 00:05:09,230
cracking so john.babinec are you here

121
00:05:09,230 --> 00:05:10,860
not seeing him

122
00:05:10,860 --> 00:05:16,080
at least he blocked in April 2008 on icy

123
00:05:16,080 --> 00:05:18,420
block about cracking and he listed one

124
00:05:18,420 --> 00:05:21,630
hash that was uploaded in July 2007 to

125
00:05:21,630 --> 00:05:22,200
virustotal

126
00:05:22,200 --> 00:05:23,790
so that was also on the other hand II

127
00:05:23,790 --> 00:05:26,040
one of the first instances that I was

128
00:05:26,040 --> 00:05:27,900
able to find the DJ binary if you want

129
00:05:27,900 --> 00:05:32,910
so it was them first publicly mentioned

130
00:05:32,910 --> 00:05:35,130
in April of 2008 which is also around

131
00:05:35,130 --> 00:05:37,350
the time that I found where DJ as a

132
00:05:37,350 --> 00:05:40,620
concept was first publicly mentioned but

133
00:05:40,620 --> 00:05:42,540
the concept itself really took off only

134
00:05:42,540 --> 00:05:46,620
in November 2008 to April 2009 so first

135
00:05:46,620 --> 00:05:48,660
there was three be there was this

136
00:05:48,660 --> 00:05:50,940
takedown of Nicola this malicious

137
00:05:50,940 --> 00:05:53,370
infrastructure and the Bob masters of

138
00:05:53,370 --> 00:05:55,110
Shri B were able to regain control

139
00:05:55,110 --> 00:05:57,300
because they had a backup TGA in their

140
00:05:57,300 --> 00:05:59,340
boundaries which then started suddenly

141
00:05:59,340 --> 00:06:02,130
generating domains and I think back at

142
00:06:02,130 --> 00:06:04,110
the time it was probably overseen that

143
00:06:04,110 --> 00:06:05,550
there was this type of functionality in

144
00:06:05,550 --> 00:06:08,750
the binary they our second one configure

145
00:06:08,750 --> 00:06:11,250
probably don't need to talk that much

146
00:06:11,250 --> 00:06:14,100
about this one because it was very well

147
00:06:14,100 --> 00:06:17,340
documented and third one obviously topic

148
00:06:17,340 --> 00:06:19,800
which like I mentioned was taking over

149
00:06:19,800 --> 00:06:23,160
and then published about by Brad stone

150
00:06:23,160 --> 00:06:26,040
gross so what dated since topic only

151
00:06:26,040 --> 00:06:27,990
generates free domains per day and three

152
00:06:27,990 --> 00:06:30,690
per week a group of researchers went

153
00:06:30,690 --> 00:06:32,430
there and just registered those domains

154
00:06:32,430 --> 00:06:34,320
before the Bob masters did and singled

155
00:06:34,320 --> 00:06:36,450
other traffic and the basically gave

156
00:06:36,450 --> 00:06:39,300
among the the first insight on what's

157
00:06:39,300 --> 00:06:41,100
the ratio of the many

158
00:06:41,100 --> 00:06:44,430
a piece with regard to - static IPS they

159
00:06:44,430 --> 00:06:46,560
locked all of the credentials that were

160
00:06:46,560 --> 00:06:48,630
submitted and this somewhat kicked off

161
00:06:48,630 --> 00:06:51,030
all of this ethical debate on what can

162
00:06:51,030 --> 00:06:53,910
you do with memory research okay

163
00:06:53,910 --> 00:06:56,310
so why would you want to use ggas so

164
00:06:56,310 --> 00:06:57,900
there's probably a couple of reasons for

165
00:06:57,900 --> 00:06:59,130
that

166
00:06:59,130 --> 00:07:01,860
it really aggravates analysis so back in

167
00:07:01,860 --> 00:07:03,510
the good old days it was just as easy as

168
00:07:03,510 --> 00:07:05,070
running a sample dumping it and you

169
00:07:05,070 --> 00:07:06,840
could just see a memory all the domains

170
00:07:06,840 --> 00:07:08,190
that probably will talk to you

171
00:07:08,190 --> 00:07:10,680
not so possible with DJ's because you

172
00:07:10,680 --> 00:07:12,300
have to do code analysis in order to

173
00:07:12,300 --> 00:07:16,050
infer how the algorithm works it does

174
00:07:16,050 --> 00:07:18,630
evasion so if you have a digit at this

175
00:07:18,630 --> 00:07:20,280
time based so you will see different

176
00:07:20,280 --> 00:07:22,620
domains being generated at different

177
00:07:22,620 --> 00:07:26,130
points of time you will have many DJ's

178
00:07:26,130 --> 00:07:28,080
that have rather short-lived domains so

179
00:07:28,080 --> 00:07:30,510
maybe just one day and so on and the

180
00:07:30,510 --> 00:07:32,400
reaction time blacklists has to be

181
00:07:32,400 --> 00:07:34,740
really short in order to wrap on those

182
00:07:34,740 --> 00:07:36,480
domains as well in order to be able to

183
00:07:36,480 --> 00:07:38,520
blacklist them quick enough and then

184
00:07:38,520 --> 00:07:40,350
again you have basically a lot of

185
00:07:40,350 --> 00:07:42,360
entries in your blacklist that are

186
00:07:42,360 --> 00:07:44,340
outdated just after one day

187
00:07:44,340 --> 00:07:46,230
so it basically pollutes you'll break

188
00:07:46,230 --> 00:07:49,760
this on on a certain way you have backup

189
00:07:49,760 --> 00:07:52,230
so it's probably smart to to have a DJ

190
00:07:52,230 --> 00:07:53,850
in your binary because you only need to

191
00:07:53,850 --> 00:07:55,680
register those domains whenever you need

192
00:07:55,680 --> 00:07:58,140
back access and the basically brings us

193
00:07:58,140 --> 00:08:00,630
to the next point you have asymmetry so

194
00:08:00,630 --> 00:08:02,820
d attacker only needs to control a

195
00:08:02,820 --> 00:08:05,400
single domain in order to have control

196
00:08:05,400 --> 00:08:08,280
of it botnet while the defender needs to

197
00:08:08,280 --> 00:08:11,100
prohibit access to all of the domains so

198
00:08:11,100 --> 00:08:13,320
it's kind of horrible from a defender

199
00:08:13,320 --> 00:08:16,740
perspective and in the end it's pretty

200
00:08:16,740 --> 00:08:18,390
feasible to use DJ's because the mains

201
00:08:18,390 --> 00:08:21,000
are pretty cheap by now so even if you

202
00:08:21,000 --> 00:08:23,460
run a DJ that has like ability of one

203
00:08:23,460 --> 00:08:25,530
day you just chill out five bucks for a

204
00:08:25,530 --> 00:08:26,730
domain and then you have control over

205
00:08:26,730 --> 00:08:29,000
your button for one day

206
00:08:29,000 --> 00:08:33,059
okay so DJ is a pretty annoying I'd say

207
00:08:33,059 --> 00:08:34,110
so

208
00:08:34,110 --> 00:08:36,599
I get this idea why not go there and

209
00:08:36,599 --> 00:08:39,210
yeah since I reverse a lot reverse all

210
00:08:39,210 --> 00:08:41,610
of the DJ's I can find or basically get

211
00:08:41,610 --> 00:08:43,140
them contributed by other people and

212
00:08:43,140 --> 00:08:45,300
then generates all of the domains and

213
00:08:45,300 --> 00:08:48,090
put them in a database because this

214
00:08:48,090 --> 00:08:51,330
gives some nice use cases so we have

215
00:08:51,330 --> 00:08:53,670
this database eg archive and what you

216
00:08:53,670 --> 00:08:53,920
can

217
00:08:53,920 --> 00:08:56,230
do better it's for example you can query

218
00:08:56,230 --> 00:08:58,950
a domain name you can ask DG archive

219
00:08:58,950 --> 00:09:02,019
this is DG a domain and it will tell you

220
00:09:02,019 --> 00:09:05,110
yeah for example it's nine not only that

221
00:09:05,110 --> 00:09:08,290
since I was able to yeah basically know

222
00:09:08,290 --> 00:09:09,610
how to generate them and when they are

223
00:09:09,610 --> 00:09:11,709
valid it also tells you yeah this main

224
00:09:11,709 --> 00:09:13,420
was welded on this in that day and that

225
00:09:13,420 --> 00:09:15,100
something is probably helpful if you're

226
00:09:15,100 --> 00:09:16,899
doing forensics or going through browser

227
00:09:16,899 --> 00:09:18,430
logs proxy locks and so on

228
00:09:18,430 --> 00:09:21,100
see occasions there maybe I will to look

229
00:09:21,100 --> 00:09:24,160
into a window of domains and since we

230
00:09:24,160 --> 00:09:25,540
have a database of domains it's also

231
00:09:25,540 --> 00:09:27,519
pretty much possible to just give up

232
00:09:27,519 --> 00:09:31,839
block lists based on that okay so at

233
00:09:31,839 --> 00:09:34,390
that lightning talk last year at

234
00:09:34,390 --> 00:09:36,399
coverage of about eight families with

235
00:09:36,399 --> 00:09:39,990
twenty seats and four million domains

236
00:09:39,990 --> 00:09:42,610
status before I went robot comp is now

237
00:09:42,610 --> 00:09:44,110
for the three different families and

238
00:09:44,110 --> 00:09:46,180
variants I basically had to split up

239
00:09:46,180 --> 00:09:47,740
some of the families and variants

240
00:09:47,740 --> 00:09:49,690
because they are technically the same

241
00:09:49,690 --> 00:09:51,700
code base but the DGA is so different

242
00:09:51,700 --> 00:09:53,470
that you can call it a different variant

243
00:09:53,470 --> 00:09:55,450
in that case and there's coverage of

244
00:09:55,450 --> 00:10:01,269
about 200 8t seats with just shy of 20

245
00:10:01,269 --> 00:10:04,300
million domains so it's quite a lot

246
00:10:04,300 --> 00:10:08,740
right now okay so how do I proceed in

247
00:10:08,740 --> 00:10:12,579
finding DJ's it's more or less since my

248
00:10:12,579 --> 00:10:14,920
background is somewhat academic also

249
00:10:14,920 --> 00:10:17,500
being a PhD CEO and I look at papers so

250
00:10:17,500 --> 00:10:18,699
it's basically the first and you can

251
00:10:18,699 --> 00:10:20,199
find the range of papers the basic and

252
00:10:20,199 --> 00:10:23,190
proposed systems in order to find DJ's

253
00:10:23,190 --> 00:10:26,110
so i remixed the the knowledge that you

254
00:10:26,110 --> 00:10:27,670
can find there with some common sense of

255
00:10:27,670 --> 00:10:30,640
my side and from shadow server thanks to

256
00:10:30,640 --> 00:10:34,500
you guys I see if basically the whole

257
00:10:34,500 --> 00:10:38,230
DNS feed of their sin boxes so all of

258
00:10:38,230 --> 00:10:39,640
the call-outs that you get for single

259
00:10:39,640 --> 00:10:41,949
samples are provided through this kind

260
00:10:41,949 --> 00:10:44,740
of feed and from those 1.2 million

261
00:10:44,740 --> 00:10:47,019
sandbox runs with about 50 million

262
00:10:47,019 --> 00:10:49,060
domain lookups 4 million unique domains

263
00:10:49,060 --> 00:10:51,880
I basically run analysis on a per sample

264
00:10:51,880 --> 00:10:54,310
basis there and try to find as many ETA

265
00:10:54,310 --> 00:10:56,829
candidates as possible procedure for

266
00:10:56,829 --> 00:10:59,230
that is I first filter out with this

267
00:10:59,230 --> 00:11:02,079
like Alexa I have a separated back list

268
00:11:02,079 --> 00:11:04,660
because you will find many samples that

269
00:11:04,660 --> 00:11:06,399
look like they call to DG a domains but

270
00:11:06,399 --> 00:11:07,450
actually there

271
00:11:07,450 --> 00:11:09,610
ha coded or someone typed on the

272
00:11:09,610 --> 00:11:12,040
keyboard like my cat in order to have

273
00:11:12,040 --> 00:11:12,760
two mains in there

274
00:11:12,760 --> 00:11:14,620
and I can also filter out through DJ

275
00:11:14,620 --> 00:11:16,270
archive because if I if there's a domain

276
00:11:16,270 --> 00:11:17,860
that I already have in my database I can

277
00:11:17,860 --> 00:11:19,630
pretty much say yeah probably that

278
00:11:19,630 --> 00:11:22,270
family and they don't have to go get it

279
00:11:22,270 --> 00:11:25,090
second step I don't need to do scoring

280
00:11:25,090 --> 00:11:27,820
for domains and the principles are

281
00:11:27,820 --> 00:11:30,280
applied our first Engram analysis you

282
00:11:30,280 --> 00:11:32,860
have some combinations of characters

283
00:11:32,860 --> 00:11:34,900
letters that are more common in language

284
00:11:34,900 --> 00:11:39,310
or domains than others less frequent of

285
00:11:39,310 --> 00:11:41,050
such combinations give a higher value

286
00:11:41,050 --> 00:11:42,970
that's basically the whole idea then you

287
00:11:42,970 --> 00:11:45,100
have to tune it a lot and eventually it

288
00:11:45,100 --> 00:11:48,190
will work I also do entropy analysis

289
00:11:48,190 --> 00:11:50,560
meaning if you have a white or uniform

290
00:11:50,560 --> 00:11:52,210
distribution of characters this also

291
00:11:52,210 --> 00:11:54,760
gives a higher score then you can see

292
00:11:54,760 --> 00:11:57,250
that many of the DTS use quite long

293
00:11:57,250 --> 00:12:00,130
domain names or because think of it from

294
00:12:00,130 --> 00:12:01,660
a marketing perspective you run a

295
00:12:01,660 --> 00:12:02,860
business you want to show the main

296
00:12:02,860 --> 00:12:04,600
because nobody can recognize a long

297
00:12:04,600 --> 00:12:06,400
domain and wants to type that stuff so

298
00:12:06,400 --> 00:12:09,310
it's more likely at least I found that

299
00:12:09,310 --> 00:12:10,690
many of the DJs for some reason use

300
00:12:10,690 --> 00:12:12,010
known are domains because they are less

301
00:12:12,010 --> 00:12:13,930
registered but we'll see about that

302
00:12:13,930 --> 00:12:17,140
later and then you also have an X domain

303
00:12:17,140 --> 00:12:20,020
because the idea is if you generate a

304
00:12:20,020 --> 00:12:22,510
lot of domains anyway many of them will

305
00:12:22,510 --> 00:12:24,130
not be registered so many of them will

306
00:12:24,130 --> 00:12:25,900
return that they are not resolving to

307
00:12:25,900 --> 00:12:28,030
any IP address so it's basically the

308
00:12:28,030 --> 00:12:29,470
four things that are used for scoring

309
00:12:29,470 --> 00:12:32,050
there and what I also do since I

310
00:12:32,050 --> 00:12:34,750
reversed or basically got all those

311
00:12:34,750 --> 00:12:36,430
three implementations of those CGAs I

312
00:12:36,430 --> 00:12:38,980
have a pretty good feeling about how the

313
00:12:38,980 --> 00:12:41,080
domains look like that those tjs

314
00:12:41,080 --> 00:12:42,970
generate so I have a feeling for what's

315
00:12:42,970 --> 00:12:44,920
the minimum and maximum length that the

316
00:12:44,920 --> 00:12:46,960
domain has what's your alphabet for

317
00:12:46,960 --> 00:12:48,100
example are there some characters

318
00:12:48,100 --> 00:12:50,200
missing does it also include numbers

319
00:12:50,200 --> 00:12:51,670
does it have a dash in there because

320
00:12:51,670 --> 00:12:53,800
there are some what is - did I know that

321
00:12:53,800 --> 00:12:56,920
also used - and what are they Tod that

322
00:12:56,920 --> 00:12:59,230
are generally associated with that this

323
00:12:59,230 --> 00:13:02,770
and their family and this matching step

324
00:13:02,770 --> 00:13:04,270
is pretty interesting because if I have

325
00:13:04,270 --> 00:13:07,210
a match for many of the domains but it's

326
00:13:07,210 --> 00:13:08,770
not in GG archive I likely have a new

327
00:13:08,770 --> 00:13:10,570
seat so I have to look at that sample

328
00:13:10,570 --> 00:13:13,000
and extracted seat push it into the G

329
00:13:13,000 --> 00:13:15,780
archive if they have no match or

330
00:13:15,780 --> 00:13:18,490
inconsistent matches it's likely that I

331
00:13:18,490 --> 00:13:20,710
may have found a new DTA so I analyze

332
00:13:20,710 --> 00:13:21,010
this

333
00:13:21,010 --> 00:13:24,880
well that's a lot of hand work but I

334
00:13:24,880 --> 00:13:27,190
think it gives quite good results to

335
00:13:27,190 --> 00:13:31,650
follow that approach okay so second part

336
00:13:31,650 --> 00:13:35,320
EGA features so what are typical

337
00:13:35,320 --> 00:13:39,100
features of DJ's example characteristics

338
00:13:39,100 --> 00:13:41,500
can be something like what I would call

339
00:13:41,500 --> 00:13:43,990
a DG a class in a generation scheme

340
00:13:43,990 --> 00:13:47,380
morph that in a second and what you can

341
00:13:47,380 --> 00:13:49,930
also see is that a lot of TGS use

342
00:13:49,930 --> 00:13:53,950
well-known algorithms like pseudo-random

343
00:13:53,950 --> 00:13:56,170
number generators of certain type that

344
00:13:56,170 --> 00:13:59,950
unknown or hashing like md5 shot 2 5 6

345
00:13:59,950 --> 00:14:02,110
and so on and you can find that in the

346
00:14:02,110 --> 00:14:05,170
algorithms as well of course the main

347
00:14:05,170 --> 00:14:06,910
structure like I just mentioned so you

348
00:14:06,910 --> 00:14:08,320
will have a minimum maximum length

349
00:14:08,320 --> 00:14:10,630
average length an alphabet that's used

350
00:14:10,630 --> 00:14:14,200
by DGA you will have this set of TDC you

351
00:14:14,200 --> 00:14:17,320
can see there then you in case you have

352
00:14:17,320 --> 00:14:19,390
a time-dependent DGA you can also see

353
00:14:19,390 --> 00:14:21,760
what's the validity period of single

354
00:14:21,760 --> 00:14:23,710
domains and also how many domains are

355
00:14:23,710 --> 00:14:25,870
generated per cycle because if you take

356
00:14:25,870 --> 00:14:27,670
something like configure with its fifty

357
00:14:27,670 --> 00:14:28,720
thousand two minutes per day that's

358
00:14:28,720 --> 00:14:29,890
right

359
00:14:29,890 --> 00:14:32,440
quite characteristic for this one this

360
00:14:32,440 --> 00:14:34,290
is only covered indirectly through the

361
00:14:34,290 --> 00:14:36,880
number of generated domains everyone you

362
00:14:36,880 --> 00:14:38,230
can also look at the main randomness

363
00:14:38,230 --> 00:14:41,650
it's also basically I cut it out for

364
00:14:41,650 --> 00:14:43,360
this talk if you want to have more

365
00:14:43,360 --> 00:14:44,770
information on that just see me offline

366
00:14:44,770 --> 00:14:47,320
in the break and we can talk about that

367
00:14:47,320 --> 00:14:50,800
and CC priority um right impression that

368
00:14:50,800 --> 00:14:53,050
many people think that DJ's are mostly

369
00:14:53,050 --> 00:14:56,200
used as backup algorithms in malware and

370
00:14:56,200 --> 00:14:59,140
so on that was also my impression before

371
00:14:59,140 --> 00:15:01,510
I started with that research and the

372
00:15:01,510 --> 00:15:04,840
thing is actually yes TTS are more or

373
00:15:04,840 --> 00:15:06,640
less always used as last priority in

374
00:15:06,640 --> 00:15:10,090
malware but you also have 28 families

375
00:15:10,090 --> 00:15:12,520
out of the 40 that base we use DDS

376
00:15:12,520 --> 00:15:15,580
they're only CNC mechanism so although

377
00:15:15,580 --> 00:15:17,920
it's the only one or last one it's

378
00:15:17,920 --> 00:15:19,660
basically the the relevant one for those

379
00:15:19,660 --> 00:15:22,870
metal families 28 because yes five that

380
00:15:22,870 --> 00:15:24,910
actually use hard core determines but

381
00:15:24,910 --> 00:15:27,310
they have more or less no relevance

382
00:15:27,310 --> 00:15:28,900
because the malware author or the bot

383
00:15:28,900 --> 00:15:31,450
master knows EDTA works anyway so I

384
00:15:31,450 --> 00:15:32,890
don't have to care about my heart color

385
00:15:32,890 --> 00:15:34,860
demands any longer

386
00:15:34,860 --> 00:15:38,889
okay so the CDA classes have been

387
00:15:38,889 --> 00:15:41,500
defined by my colleague Thomas barabash

388
00:15:41,500 --> 00:15:44,649
who was giving a talk tomorrow in back

389
00:15:44,649 --> 00:15:47,620
in 2012 and he says or basically the

390
00:15:47,620 --> 00:15:49,470
group of researchers they found out or

391
00:15:49,470 --> 00:15:52,360
postulated there are two basic

392
00:15:52,360 --> 00:15:53,740
characteristics you can find up for a

393
00:15:53,740 --> 00:15:55,810
DGA so the first one is is a time

394
00:15:55,810 --> 00:15:57,850
dependent so will it generate different

395
00:15:57,850 --> 00:16:00,519
remains over time and is it

396
00:16:00,519 --> 00:16:02,589
deterministic deterministic in that

397
00:16:02,589 --> 00:16:06,130
sense meaning thus far it's basically at

398
00:16:06,130 --> 00:16:07,660
every time all information available

399
00:16:07,660 --> 00:16:10,230
that you need to generate domains and

400
00:16:10,230 --> 00:16:12,490
they basically had to introduce the

401
00:16:12,490 --> 00:16:14,050
class because you might have heard about

402
00:16:14,050 --> 00:16:16,810
topic which had a data variant that used

403
00:16:16,810 --> 00:16:18,970
Twitter trends in order to generate a

404
00:16:18,970 --> 00:16:21,130
mate's so you cannot pre generate them

405
00:16:21,130 --> 00:16:23,680
beyond a certain date and on the other

406
00:16:23,680 --> 00:16:26,620
end this beat up which uses currency

407
00:16:26,620 --> 00:16:28,870
values which are also published daily

408
00:16:28,870 --> 00:16:31,990
modest and you can no longer regenerate

409
00:16:31,990 --> 00:16:35,259
them beyond one week so that's basically

410
00:16:35,259 --> 00:16:37,360
a limiting factor in how you can print

411
00:16:37,360 --> 00:16:39,459
the mains there and for the last one

412
00:16:39,459 --> 00:16:41,880
time independent and non deterministic

413
00:16:41,880 --> 00:16:45,189
and this would be something that you

414
00:16:45,189 --> 00:16:47,560
shotgun approach probably have a feeling

415
00:16:47,560 --> 00:16:49,930
that Meerut is doing that because they

416
00:16:49,930 --> 00:16:52,000
are sitting with the x86 instruction

417
00:16:52,000 --> 00:16:54,819
read time stamp router which totally

418
00:16:54,819 --> 00:16:57,579
makes up the de-seeding and they have

419
00:16:57,579 --> 00:17:00,699
only six letter domains with comm so

420
00:17:00,699 --> 00:17:02,829
basically they just do random domains

421
00:17:02,829 --> 00:17:04,449
and hope that they probably hit one of

422
00:17:04,449 --> 00:17:06,849
their domains I think otherwise he DJ is

423
00:17:06,849 --> 00:17:08,380
program I'm not used I'm not really sure

424
00:17:08,380 --> 00:17:10,480
about that otherwise please discuss with

425
00:17:10,480 --> 00:17:12,369
me about that I want to find that out

426
00:17:12,369 --> 00:17:15,069
and the second thing is generation

427
00:17:15,069 --> 00:17:18,189
schemes so I've seen more or less for

428
00:17:18,189 --> 00:17:20,530
different kinds of dgs work so they are

429
00:17:20,530 --> 00:17:24,429
arithmetic pjs that are the ones that

430
00:17:24,429 --> 00:17:26,439
you normally assume that are those that

431
00:17:26,439 --> 00:17:29,010
are generators those basically random

432
00:17:29,010 --> 00:17:31,780
sequences of characters numbers and so

433
00:17:31,780 --> 00:17:32,860
on

434
00:17:32,860 --> 00:17:34,870
secondly you have worthless DJ's so

435
00:17:34,870 --> 00:17:37,090
basically they pick words from a word

436
00:17:37,090 --> 00:17:40,210
list and put them in a sequence then you

437
00:17:40,210 --> 00:17:42,960
have HBase tgs on the two right now

438
00:17:42,960 --> 00:17:46,150
which basically have a full hash as

439
00:17:46,150 --> 00:17:47,350
their domain name

440
00:17:47,350 --> 00:17:50,950
and finally there is one family or well

441
00:17:50,950 --> 00:17:53,440
the taxi does I think rather d/dx our

442
00:17:53,440 --> 00:17:55,630
name but email was called explosion at

443
00:17:55,630 --> 00:17:57,730
least where Kaspersky and so on that

444
00:17:57,730 --> 00:17:59,559
uses permutation that means you start

445
00:17:59,559 --> 00:18:03,039
off with one domain and just switch the

446
00:18:03,039 --> 00:18:06,669
order of the letters in there so it

447
00:18:06,669 --> 00:18:08,380
didn't fit with with the other scheme so

448
00:18:08,380 --> 00:18:10,990
I thought having its own class would

449
00:18:10,990 --> 00:18:15,570
make sense okay now we play jeopardy I

450
00:18:15,570 --> 00:18:18,340
thought how do you represent that much

451
00:18:18,340 --> 00:18:20,440
information because I had it when I

452
00:18:20,440 --> 00:18:21,879
started writing the paper everything in

453
00:18:21,879 --> 00:18:24,250
the table and plotting a table with 40

454
00:18:24,250 --> 00:18:25,990
entries on the slide doesn't make any

455
00:18:25,990 --> 00:18:27,909
sense because you would have to be like

456
00:18:27,909 --> 00:18:29,830
that close to be able to read anything

457
00:18:29,830 --> 00:18:32,049
so I thought to go with this matrix kind

458
00:18:32,049 --> 00:18:34,600
of style and first we are going to look

459
00:18:34,600 --> 00:18:36,549
at what's the distribution of classes

460
00:18:36,549 --> 00:18:39,480
and schemes here so the majority of

461
00:18:39,480 --> 00:18:43,389
those TGS is actually time based so 20

462
00:18:43,389 --> 00:18:45,700
to 55 percent of the ones that I know of

463
00:18:45,700 --> 00:18:48,100
are time dependent and also

464
00:18:48,100 --> 00:18:51,039
deterministic that means you can once

465
00:18:51,039 --> 00:18:52,779
you have the ivory of you and have seats

466
00:18:52,779 --> 00:18:54,250
you can pre generate the domains that

467
00:18:54,250 --> 00:18:58,720
those DJ's use another 16 a time

468
00:18:58,720 --> 00:19:00,909
independent that means giving a seat in

469
00:19:00,909 --> 00:19:02,919
the algorithm you can generate a static

470
00:19:02,919 --> 00:19:05,860
list of domains and there are those two

471
00:19:05,860 --> 00:19:09,519
examples that are non-deterministic that

472
00:19:09,519 --> 00:19:11,529
need like I said Twitter feed I don't

473
00:19:11,529 --> 00:19:13,149
have that one and I think the Twitter

474
00:19:13,149 --> 00:19:15,250
API changed anyway so this one is no

475
00:19:15,250 --> 00:19:17,590
longer relevant but there's also beat up

476
00:19:17,590 --> 00:19:19,149
using this currency and from information

477
00:19:19,149 --> 00:19:21,399
this one is very relevant since it's an

478
00:19:21,399 --> 00:19:27,820
active family ok so next what generation

479
00:19:27,820 --> 00:19:29,820
schemes today use and the vast majority

480
00:19:29,820 --> 00:19:34,389
uses arithmetic schemes so it's good 85%

481
00:19:34,389 --> 00:19:36,970
of all of those ejs basically produced

482
00:19:36,970 --> 00:19:39,220
those more or less completely random

483
00:19:39,220 --> 00:19:43,049
domain names another free use word list

484
00:19:43,049 --> 00:19:45,820
so super box I think another name for

485
00:19:45,820 --> 00:19:47,980
that one would be NIF dart for cosy it

486
00:19:47,980 --> 00:19:49,419
would be you know if you see the usual

487
00:19:49,419 --> 00:19:52,419
problem arise again I try to stick with

488
00:19:52,419 --> 00:19:54,279
the Microsoft names because from my

489
00:19:54,279 --> 00:19:56,019
feeling their detection engine produces

490
00:19:56,019 --> 00:19:59,200
quite stable detections once they have a

491
00:19:59,200 --> 00:20:00,430
detection for something

492
00:20:00,430 --> 00:20:03,430
and yeah like I said there's two

493
00:20:03,430 --> 00:20:05,350
families that use hashing sober meter

494
00:20:05,350 --> 00:20:08,620
produces those md5 long ones and Dyer

495
00:20:08,620 --> 00:20:12,400
uses an excerpt of two of a sha-256 -

496
00:20:12,400 --> 00:20:15,030
and prepends it also with a letter and

497
00:20:15,030 --> 00:20:18,670
yeah there's this one P version so this

498
00:20:18,670 --> 00:20:21,430
permutation volatile cedar and in

499
00:20:21,430 --> 00:20:23,500
brackets you can see that I basically

500
00:20:23,500 --> 00:20:26,710
also wrote the algorithms like I said 11

501
00:20:26,710 --> 00:20:29,890
of those use HCG whatever it is is going

502
00:20:29,890 --> 00:20:32,020
to explain it in a second the more

503
00:20:32,020 --> 00:20:34,240
exotic ones the the one I really like is

504
00:20:34,240 --> 00:20:36,340
for example 9mm which which uses the

505
00:20:36,340 --> 00:20:39,340
probably less known PR energy score or

506
00:20:39,340 --> 00:20:42,520
shift and the crockpot guys actually run

507
00:20:42,520 --> 00:20:43,960
a custom implementation of missing

508
00:20:43,960 --> 00:20:45,340
twister so it's not this time that one I

509
00:20:45,340 --> 00:20:47,200
was happy I basically recognized the Des

510
00:20:47,200 --> 00:20:49,090
Moines twister thought okay can we use

511
00:20:49,090 --> 00:20:51,040
it nope

512
00:20:51,040 --> 00:20:53,260
had to rewrite this whole stupids pure

513
00:20:53,260 --> 00:20:56,650
energy myself because I do Python and

514
00:20:56,650 --> 00:20:58,480
there was about the custom one-off item

515
00:20:58,480 --> 00:20:59,620
but I found the original implementation

516
00:20:59,620 --> 00:21:01,750
that they ripped and put into their

517
00:21:01,750 --> 00:21:04,210
malware which is some Japanese C

518
00:21:04,210 --> 00:21:06,880
implementation of Amazon twister yeah

519
00:21:06,880 --> 00:21:08,440
for a couple other ones you can see md5

520
00:21:08,440 --> 00:21:09,190
and so on

521
00:21:09,190 --> 00:21:12,280
so what's HCG HCG is the linear

522
00:21:12,280 --> 00:21:14,020
congruential generator it's a really

523
00:21:14,020 --> 00:21:15,580
really simple scheme on how to generate

524
00:21:15,580 --> 00:21:18,910
more less random numbers it works this

525
00:21:18,910 --> 00:21:20,380
way you have seats you start off with

526
00:21:20,380 --> 00:21:23,260
its X and in this example you multiply

527
00:21:23,260 --> 00:21:25,870
it with a value a you add a value C you

528
00:21:25,870 --> 00:21:28,390
do module um ended up with a new random

529
00:21:28,390 --> 00:21:30,280
number that you can then again put in

530
00:21:30,280 --> 00:21:32,470
again and by doing this you end up with

531
00:21:32,470 --> 00:21:35,740
a sequence of random numbers there are

532
00:21:35,740 --> 00:21:38,530
many different variants of that for

533
00:21:38,530 --> 00:21:40,000
example just the Park and Miller one

534
00:21:40,000 --> 00:21:41,920
these are the guys who proposed this

535
00:21:41,920 --> 00:21:44,050
algorithm in the 80s you will have this

536
00:21:44,050 --> 00:21:46,210
the famous book numerical recipes and

537
00:21:46,210 --> 00:21:47,560
there's an implementation of it in their

538
00:21:47,560 --> 00:21:50,440
Microsoft Visual Studio and many of the

539
00:21:50,440 --> 00:21:53,020
other DJ's also run custom values for in

540
00:21:53,020 --> 00:21:56,290
a and C at least that doesn't give them

541
00:21:56,290 --> 00:21:57,340
perfect randomness

542
00:21:57,340 --> 00:22:01,330
anymore yeah but sed also is pretty

543
00:22:01,330 --> 00:22:04,510
limited in that domain but allows them

544
00:22:04,510 --> 00:22:07,570
to customize so what would a really

545
00:22:07,570 --> 00:22:10,420
trivial detail of life based on this LCG

546
00:22:10,420 --> 00:22:13,640
so let's take this this Python code here

547
00:22:13,640 --> 00:22:16,070
in order to generate the domain we need

548
00:22:16,070 --> 00:22:18,260
some TVs in this case we have those five

549
00:22:18,260 --> 00:22:19,040
tio DS

550
00:22:19,040 --> 00:22:22,520
ComNet arc ruined TV then we want to

551
00:22:22,520 --> 00:22:24,230
have domains that are 10 characters long

552
00:22:24,230 --> 00:22:26,330
so we need two for loop and what we are

553
00:22:26,330 --> 00:22:28,549
doing now is we are running our random

554
00:22:28,549 --> 00:22:30,980
number generator doing this LCG and

555
00:22:30,980 --> 00:22:34,370
cropping the output to the range of 0 to

556
00:22:34,370 --> 00:22:38,570
25 by doing module 26 okay now we add

557
00:22:38,570 --> 00:22:41,600
this to hex 61 which is the SQL

558
00:22:41,600 --> 00:22:44,480
presentation or the equivalent to a and

559
00:22:44,480 --> 00:22:48,049
end up with the range of A to Z because

560
00:22:48,049 --> 00:22:50,080
there are 26 letters in the alphabet so

561
00:22:50,080 --> 00:22:54,049
0 plus 25 is basically A to Z do this 10

562
00:22:54,049 --> 00:22:54,410
times

563
00:22:54,410 --> 00:22:56,630
we also roll our dice again for the

564
00:22:56,630 --> 00:22:58,370
domains and end up with something like

565
00:22:58,370 --> 00:23:01,690
that so it's really a really simple of

566
00:23:01,690 --> 00:23:06,919
example of a TGA okay um the main

567
00:23:06,919 --> 00:23:10,070
structure so there's way too much

568
00:23:10,070 --> 00:23:12,200
information in that slide I still put it

569
00:23:12,200 --> 00:23:13,309
in there so you can read it offline

570
00:23:13,309 --> 00:23:14,900
later on because those lipids will

571
00:23:14,900 --> 00:23:17,540
obviously be published what you'll see

572
00:23:17,540 --> 00:23:19,700
is the minimum length maximum length for

573
00:23:19,700 --> 00:23:22,760
D domains those ggs generate detailed

574
00:23:22,760 --> 00:23:24,860
ease that are used or the number of

575
00:23:24,860 --> 00:23:26,990
different healed is more or less and the

576
00:23:26,990 --> 00:23:29,419
size of the alphabet that those dgs use

577
00:23:29,419 --> 00:23:32,179
so before you get lost the numbers let's

578
00:23:32,179 --> 00:23:35,179
focus on that one configure and knickers

579
00:23:35,179 --> 00:23:38,270
are the ones that use by far the most

580
00:23:38,270 --> 00:23:40,220
different T of these so for configure

581
00:23:40,220 --> 00:23:42,559
that's the infamous version C which uses

582
00:23:42,559 --> 00:23:45,440
alone I think 119 or something different

583
00:23:45,440 --> 00:23:47,870
T of these spread all over the different

584
00:23:47,870 --> 00:23:50,929
registrar's knickers also uses for the

585
00:23:50,929 --> 00:23:54,650
three of them what this helps you is you

586
00:23:54,650 --> 00:23:57,080
will probably normal life never see the

587
00:23:57,080 --> 00:23:59,299
T of these that those TGS use so that's

588
00:23:59,299 --> 00:24:02,360
basically a dead give it a dead giveaway

589
00:24:02,360 --> 00:24:04,280
that you have one of those two DJs if

590
00:24:04,280 --> 00:24:07,850
you see them in domain locks then we

591
00:24:07,850 --> 00:24:09,830
have a couple of those that use at least

592
00:24:09,830 --> 00:24:12,880
five different TJ's at least proceed

593
00:24:12,880 --> 00:24:15,350
that's still pretty annoying because I'm

594
00:24:15,350 --> 00:24:16,520
if you want to mitigate a threat like

595
00:24:16,520 --> 00:24:18,350
that you basically have to talk to a lot

596
00:24:18,350 --> 00:24:19,700
of registrar's in order to get all those

597
00:24:19,700 --> 00:24:21,020
domains blocked if you want to do it on

598
00:24:21,020 --> 00:24:23,330
that level or have to buy a lot of

599
00:24:23,330 --> 00:24:26,510
domains from from different TLDs

600
00:24:26,510 --> 00:24:29,150
good news most of them basically use

601
00:24:29,150 --> 00:24:32,929
less than five even if there's timber

602
00:24:32,929 --> 00:24:34,640
fifteen-year that means just that I've

603
00:24:34,640 --> 00:24:36,260
seen fifteen different T of these for

604
00:24:36,260 --> 00:24:38,090
timber but this at most four in one

605
00:24:38,090 --> 00:24:43,580
sample okay size of alphabet um we have

606
00:24:43,580 --> 00:24:45,710
this volatility definitely it has the

607
00:24:45,710 --> 00:24:47,300
smallest one it's only nine different

608
00:24:47,300 --> 00:24:48,710
errors yeah of course if you have

609
00:24:48,710 --> 00:24:50,419
permutation that means you will not get

610
00:24:50,419 --> 00:24:52,429
any new ones in there so basically this

611
00:24:52,429 --> 00:24:54,080
old dotnet Explorer thing that have in

612
00:24:54,080 --> 00:24:56,330
start has nine different characters and

613
00:24:56,330 --> 00:24:58,100
you will not have more or less than that

614
00:24:58,100 --> 00:25:01,040
bar metal is a hash so we'll have the

615
00:25:01,040 --> 00:25:05,090
range from 8 to zetz HOF and 0 to 9 so

616
00:25:05,090 --> 00:25:10,610
that's 16 the very most DJ's use 26 so

617
00:25:10,610 --> 00:25:13,160
the whole range from A to Z there are

618
00:25:13,160 --> 00:25:17,059
two of them that have a - Z + a - so

619
00:25:17,059 --> 00:25:21,350
much - and rhythms have 27 naturally the

620
00:25:21,350 --> 00:25:24,770
next one there's four of them using 36

621
00:25:24,770 --> 00:25:28,130
so characters and numbers and then you

622
00:25:28,130 --> 00:25:32,030
have those so I've cut out what's wrong

623
00:25:32,030 --> 00:25:33,710
with these ones if you have time in the

624
00:25:33,710 --> 00:25:36,100
end I'm going to cover those as well

625
00:25:36,100 --> 00:25:39,200
okay the main length just way too much

626
00:25:39,200 --> 00:25:40,820
to talk about that one and compare it so

627
00:25:40,820 --> 00:25:43,010
I leave it out as well like I said just

628
00:25:43,010 --> 00:25:44,450
see me afterwards if you're interested

629
00:25:44,450 --> 00:25:48,290
in that one registration status that's

630
00:25:48,290 --> 00:25:50,929
basically that what I was interested in

631
00:25:50,929 --> 00:25:53,120
the most after having a lot of TGA

632
00:25:53,120 --> 00:25:56,240
domains so after collecting them having

633
00:25:56,240 --> 00:25:58,820
lot of seats I thought what can what can

634
00:25:58,820 --> 00:26:02,750
you do with it so um question sets arise

635
00:26:02,750 --> 00:26:05,000
there are how many potential DJ domains

636
00:26:05,000 --> 00:26:07,010
are here so my approach was okay if I

637
00:26:07,010 --> 00:26:08,630
have family that was first spotted at

638
00:26:08,630 --> 00:26:09,140
some dates

639
00:26:09,140 --> 00:26:11,419
I just generate all of the domains until

640
00:26:11,419 --> 00:26:13,070
a certain date so right now for me this

641
00:26:13,070 --> 00:26:15,530
is end of this year then that's a

642
00:26:15,530 --> 00:26:17,090
question like are there collisions

643
00:26:17,090 --> 00:26:20,030
between DJ's so area DJ is the basically

644
00:26:20,030 --> 00:26:21,530
generates an overlapping set of domains

645
00:26:21,530 --> 00:26:24,919
and finally how many of the DJ domains

646
00:26:24,919 --> 00:26:27,290
are registered because if you look

647
00:26:27,290 --> 00:26:29,179
around there's no ground proof on that

648
00:26:29,179 --> 00:26:31,550
at all and I hope I can give some

649
00:26:31,550 --> 00:26:35,030
estimates or answers to that so we

650
00:26:35,030 --> 00:26:38,929
conducted a study with a data set of the

651
00:26:38,929 --> 00:26:40,370
gr craft that we fixed to the

652
00:26:40,370 --> 00:26:44,690
26 22nd of September this year and like

653
00:26:44,690 --> 00:26:46,309
I said we use the AG's basically

654
00:26:46,309 --> 00:26:48,049
generated from whenever we saw a family

655
00:26:48,049 --> 00:26:51,559
first until end of this year eternal

656
00:26:51,559 --> 00:26:54,110
thanks to Michael tulips and tomatoes

657
00:26:54,110 --> 00:26:56,630
because they provided me with the whole

658
00:26:56,630 --> 00:26:58,250
historic Whois data for all of those

659
00:26:58,250 --> 00:27:00,380
domains so I could do many many

660
00:27:00,380 --> 00:27:03,669
interesting funny things on that and

661
00:27:03,669 --> 00:27:06,140
evaluating the information you can grab

662
00:27:06,140 --> 00:27:09,520
from Whois data gives you things like

663
00:27:09,520 --> 00:27:11,539
what of those remains are sinkholes

664
00:27:11,539 --> 00:27:13,700
because many of the seen hole operators

665
00:27:13,700 --> 00:27:16,010
most of them I think put that

666
00:27:16,010 --> 00:27:17,870
information either in the registry field

667
00:27:17,870 --> 00:27:19,610
in the email field or in the name

668
00:27:19,610 --> 00:27:21,919
servers so it's based based on Whois

669
00:27:21,919 --> 00:27:24,110
data it's possible to spot quite a lot

670
00:27:24,110 --> 00:27:26,750
of sinkholes since its historic Whois

671
00:27:26,750 --> 00:27:28,700
data you can also see when registration

672
00:27:28,700 --> 00:27:31,250
entries changed so if you have first

673
00:27:31,250 --> 00:27:33,770
registration that points to some name

674
00:27:33,770 --> 00:27:35,510
server and later points to a single

675
00:27:35,510 --> 00:27:37,039
server that gives you are in the belt

676
00:27:37,039 --> 00:27:39,020
okay someone took control over that

677
00:27:39,020 --> 00:27:41,000
domain especially if that happens before

678
00:27:41,000 --> 00:27:44,270
the domain normally would expire then

679
00:27:44,270 --> 00:27:46,309
you can look at pre registrations so

680
00:27:46,309 --> 00:27:48,320
think of it that way we have a DG a

681
00:27:48,320 --> 00:27:51,679
generates some domains and someone

682
00:27:51,679 --> 00:27:55,220
registered domains of that DG a far

683
00:27:55,220 --> 00:27:59,330
before this DJ first appeared okay so

684
00:27:59,330 --> 00:28:00,860
this means you have collisions with

685
00:28:00,860 --> 00:28:03,260
probably benign services and it's

686
00:28:03,260 --> 00:28:04,429
probably annoying because if you want to

687
00:28:04,429 --> 00:28:06,320
run a black list with pre-generated

688
00:28:06,320 --> 00:28:09,140
domains and you basically have those in

689
00:28:09,140 --> 00:28:11,409
there it means you might end up blocking

690
00:28:11,409 --> 00:28:14,960
legitimate domains as well and finally

691
00:28:14,960 --> 00:28:17,899
the main parking I found one case where

692
00:28:17,899 --> 00:28:22,070
basically a domain Parker used one and a

693
00:28:22,070 --> 00:28:23,570
half thousand domains to drive traffic

694
00:28:23,570 --> 00:28:26,690
through advertisement that's at least my

695
00:28:26,690 --> 00:28:29,539
assumption now it looks like so that

696
00:28:29,539 --> 00:28:31,970
might also be a use case for DJ's so he

697
00:28:31,970 --> 00:28:34,669
registered domain from I think five or

698
00:28:34,669 --> 00:28:36,500
so different DJ's to 12

699
00:28:36,500 --> 00:28:39,190
the bots go to the main see controls

700
00:28:39,190 --> 00:28:42,890
okay here's another random fact um we

701
00:28:42,890 --> 00:28:46,220
first saw TGS come up in 2007 but in

702
00:28:46,220 --> 00:28:49,280
fact more than half of the DJ's appeared

703
00:28:49,280 --> 00:28:51,440
2013 in later so it's something that

704
00:28:51,440 --> 00:28:53,090
really picked up speed in the last few

705
00:28:53,090 --> 00:28:55,120
years

706
00:28:55,330 --> 00:29:00,110
okay so lot of dgs again um who is

707
00:29:00,110 --> 00:29:03,080
generating the most domains in famous

708
00:29:03,080 --> 00:29:05,240
conficker again if you do fifty thousand

709
00:29:05,240 --> 00:29:06,530
domains per year

710
00:29:06,530 --> 00:29:08,840
put a day do this for more than six

711
00:29:08,840 --> 00:29:10,310
years then you end up with a very very

712
00:29:10,310 --> 00:29:12,560
large number like what a twenty five

713
00:29:12,560 --> 00:29:15,410
million domains I'm using three seats

714
00:29:15,410 --> 00:29:18,170
two of them are a and B variance of

715
00:29:18,170 --> 00:29:20,110
conflict and they're more or less

716
00:29:20,110 --> 00:29:24,500
Niklaus I do 250 and 500 domains so just

717
00:29:24,500 --> 00:29:26,300
a fraction of what these the C version

718
00:29:26,300 --> 00:29:29,300
does the next big ones are those four

719
00:29:29,300 --> 00:29:30,950
they have at least a couple million

720
00:29:30,950 --> 00:29:31,610
domains

721
00:29:31,610 --> 00:29:34,670
I think game over DJ try to step in the

722
00:29:34,670 --> 00:29:36,350
foot so configure we're doing 10,000

723
00:29:36,350 --> 00:29:37,970
domains per day at least one of the two

724
00:29:37,970 --> 00:29:41,000
seats you can find them more often does

725
00:29:41,000 --> 00:29:42,740
a thousand per day in a sector for a

726
00:29:42,740 --> 00:29:44,210
long time cryptolocker there's also a

727
00:29:44,210 --> 00:29:47,120
thousand per day Nico's does 2048 per

728
00:29:47,120 --> 00:29:51,080
for days and as a couple of seats then

729
00:29:51,080 --> 00:29:52,370
at least you have a couple of ggas

730
00:29:52,370 --> 00:29:55,130
that's looking at a period generated

731
00:29:55,130 --> 00:29:58,310
more than 50,000 domains and all of

732
00:29:58,310 --> 00:30:00,590
those families you can see here are

733
00:30:00,590 --> 00:30:03,710
basically time-based DJ's so they are

734
00:30:03,710 --> 00:30:04,940
basically really the ones that are

735
00:30:04,940 --> 00:30:07,280
responsible for generating a lot of

736
00:30:07,280 --> 00:30:10,580
domains there's only two time

737
00:30:10,580 --> 00:30:13,160
independent DJ's that also have or that

738
00:30:13,160 --> 00:30:15,470
I track with more than 50,000 domains on

739
00:30:15,470 --> 00:30:17,030
the one that it's tiny banker because

740
00:30:17,030 --> 00:30:19,880
they are really active they push out new

741
00:30:19,880 --> 00:30:22,330
campaigns every other week I think and

742
00:30:22,330 --> 00:30:25,580
bandar-e which does up to 15,000 domains

743
00:30:25,580 --> 00:30:28,460
proceed so that's why you end up with a

744
00:30:28,460 --> 00:30:30,320
lot of domains there as well

745
00:30:30,320 --> 00:30:33,470
many of the the very others have less

746
00:30:33,470 --> 00:30:36,050
than 50,000 even with multiple seats you

747
00:30:36,050 --> 00:30:37,940
have something like remnant with just 18

748
00:30:37,940 --> 00:30:40,430
different seats but also only 18,000

749
00:30:40,430 --> 00:30:44,390
unique domains altogether during that

750
00:30:44,390 --> 00:30:46,040
study I ended up with something in the

751
00:30:46,040 --> 00:30:48,980
domain of 143 million potential domains

752
00:30:48,980 --> 00:30:51,740
and at least eighteen point five million

753
00:30:51,740 --> 00:30:56,170
without configure it's still a lot ok so

754
00:30:56,170 --> 00:30:58,930
there are two ways how dgs can collide

755
00:30:58,930 --> 00:31:01,610
so first you can have collisions within

756
00:31:01,610 --> 00:31:02,330
your DJ

757
00:31:02,330 --> 00:31:04,850
meaning the same DJ with the same seed

758
00:31:04,850 --> 00:31:07,780
will generate the same domains over time

759
00:31:07,780 --> 00:31:10,370
that's certainly possible because if you

760
00:31:10,370 --> 00:31:12,560
have limited randomness and so on domain

761
00:31:12,560 --> 00:31:13,730
to the repeat over time

762
00:31:13,730 --> 00:31:15,290
it's especially the case if you look at

763
00:31:15,290 --> 00:31:17,060
super box so this is just one thing that

764
00:31:17,060 --> 00:31:19,400
I mentioned with visitor board but this

765
00:31:19,400 --> 00:31:23,660
TTA you have 384 words in your word list

766
00:31:23,660 --> 00:31:25,880
and you combine always only two words of

767
00:31:25,880 --> 00:31:27,290
that it gives you a very limited number

768
00:31:27,290 --> 00:31:30,230
of combinations you can do and if you

769
00:31:30,230 --> 00:31:31,820
look at a long period of time those will

770
00:31:31,820 --> 00:31:34,340
repeat over time and then you have the

771
00:31:34,340 --> 00:31:36,860
second case are there DJ's that collide

772
00:31:36,860 --> 00:31:39,560
against each other so let's look at this

773
00:31:39,560 --> 00:31:42,680
one first so my gut feeling told me I

774
00:31:42,680 --> 00:31:44,240
should first look at collisions of

775
00:31:44,240 --> 00:31:48,050
Conficker with other ones I let you

776
00:31:48,050 --> 00:31:49,610
guess so whatwhat's you guess how many

777
00:31:49,610 --> 00:31:51,530
collisions do we have between configure

778
00:31:51,530 --> 00:31:56,300
and the other DJ's just shout anyway

779
00:31:56,300 --> 00:32:02,990
what thousands okay yeah no 15

780
00:32:02,990 --> 00:32:04,790
it's only 15 collisions between

781
00:32:04,790 --> 00:32:06,230
configure and the other ones so it's

782
00:32:06,230 --> 00:32:08,390
really far less than I also thought

783
00:32:08,390 --> 00:32:11,630
would there would be knickers actually

784
00:32:11,630 --> 00:32:14,660
in that case benefits by using for the

785
00:32:14,660 --> 00:32:16,550
three different TVs because that gives

786
00:32:16,550 --> 00:32:19,970
you more overlap with configure and with

787
00:32:19,970 --> 00:32:21,590
the other ones it's the case these are

788
00:32:21,590 --> 00:32:24,410
normally really small domain so five to

789
00:32:24,410 --> 00:32:27,580
six letters because otherwise it's like

790
00:32:27,580 --> 00:32:30,050
very very unlikely that you'll generate

791
00:32:30,050 --> 00:32:31,490
nine letters with two different

792
00:32:31,490 --> 00:32:34,370
algorithms and they still overlap okay

793
00:32:34,370 --> 00:32:38,660
so we put one figure out with having

794
00:32:38,660 --> 00:32:40,100
seen that there are only 15 between

795
00:32:40,100 --> 00:32:41,360
config and the other ones do you think

796
00:32:41,360 --> 00:32:43,310
they are still collisions between those

797
00:32:43,310 --> 00:32:46,060
remaining DJs

798
00:32:46,060 --> 00:32:48,260
yes no yes

799
00:32:48,260 --> 00:32:51,740
yeah just one single collision and

800
00:32:51,740 --> 00:32:55,540
that's between fixed bar and 9 min and

801
00:32:55,540 --> 00:32:59,120
the domain looks like this and that's

802
00:32:59,120 --> 00:33:01,610
exactly what I thought so that's really

803
00:33:01,610 --> 00:33:04,460
coincidence so not basically made up by

804
00:33:04,460 --> 00:33:11,900
me and yeah that's how I felt but that's

805
00:33:11,900 --> 00:33:14,030
really good to know because if you don't

806
00:33:14,030 --> 00:33:16,520
have collisions between GGAs that

807
00:33:16,520 --> 00:33:18,680
doesn't mean you can perfectly use it to

808
00:33:18,680 --> 00:33:20,330
identify other families

809
00:33:20,330 --> 00:33:22,310
because you don't have the issue that

810
00:33:22,310 --> 00:33:24,620
you might take a family with something

811
00:33:24,620 --> 00:33:26,300
that overlaps so if they perfectly

812
00:33:26,300 --> 00:33:28,190
exclude each other it's a really good

813
00:33:28,190 --> 00:33:30,890
tool to take neither families and even

814
00:33:30,890 --> 00:33:33,200
down to two campaigns or seeds there's

815
00:33:33,200 --> 00:33:37,420
basically DD takeaway of this study okay

816
00:33:37,420 --> 00:33:39,980
yeah then I said it's possible that

817
00:33:39,980 --> 00:33:41,780
domains collide with benign services

818
00:33:41,780 --> 00:33:44,120
because that's what might happen if you

819
00:33:44,120 --> 00:33:46,610
have for example of worthless TGA so at

820
00:33:46,610 --> 00:33:49,540
least that's what I wouldn't anticipate

821
00:33:49,540 --> 00:33:52,010
let's first have a look how many domains

822
00:33:52,010 --> 00:33:53,990
are registered at all because we need

823
00:33:53,990 --> 00:33:55,730
that in order to see how many up

824
00:33:55,730 --> 00:33:59,630
benignly registered okay so those again

825
00:33:59,630 --> 00:34:01,040
are the unique domains for those

826
00:34:01,040 --> 00:34:05,210
families and the very most oh no first I

827
00:34:05,210 --> 00:34:07,250
don't have data for those four families

828
00:34:07,250 --> 00:34:09,170
so four configure it's simply too many

829
00:34:09,170 --> 00:34:12,020
domains and it's hard to get that kind

830
00:34:12,020 --> 00:34:14,210
of information because the registration

831
00:34:14,210 --> 00:34:16,850
for those domains is blocked as well so

832
00:34:16,850 --> 00:34:20,510
I think the main tools told me that you

833
00:34:20,510 --> 00:34:22,400
would have to guess so since I wanted to

834
00:34:22,400 --> 00:34:24,260
have a really consistent database I just

835
00:34:24,260 --> 00:34:25,400
said okay then we don't look at

836
00:34:25,400 --> 00:34:27,350
configuring and for the other ones

837
00:34:27,350 --> 00:34:30,320
it's ddns so you usually have only one

838
00:34:30,320 --> 00:34:32,960
second level domain and I also wanted to

839
00:34:32,960 --> 00:34:34,940
exclude them for the same reason because

840
00:34:34,940 --> 00:34:36,710
you could basically do something like

841
00:34:36,710 --> 00:34:38,570
passive DNS to it you'll get that kind

842
00:34:38,570 --> 00:34:41,000
of information but still then you would

843
00:34:41,000 --> 00:34:43,600
have to guess and you don't have the

844
00:34:43,600 --> 00:34:45,650
wealth of information that Whois

845
00:34:45,650 --> 00:34:47,860
provides you okay so with the other ones

846
00:34:47,860 --> 00:34:50,418
the one with the very most registrations

847
00:34:50,418 --> 00:34:54,949
is game over peer-to-peer okay why

848
00:34:54,949 --> 00:34:58,100
should that be the case yeah you might

849
00:34:58,100 --> 00:34:59,540
remember that there was a takedown and

850
00:34:59,540 --> 00:35:01,400
then cause of this takedown many many

851
00:35:01,400 --> 00:35:03,890
weight domains have been registered this

852
00:35:03,890 --> 00:35:06,080
does for example not include all of the

853
00:35:06,080 --> 00:35:07,460
Russian domains because instead of

854
00:35:07,460 --> 00:35:09,230
registering they were blocked and

855
00:35:09,230 --> 00:35:11,870
there's also something that's not

856
00:35:11,870 --> 00:35:13,520
providing any whose info in that case

857
00:35:13,520 --> 00:35:15,650
you can ask the register we have a

858
00:35:15,650 --> 00:35:16,970
protocol and they tell you nope you

859
00:35:16,970 --> 00:35:18,440
cannot register them so that's not

860
00:35:18,440 --> 00:35:20,090
reflected in here so the number should

861
00:35:20,090 --> 00:35:22,640
actually be a bit higher in a sense of

862
00:35:22,640 --> 00:35:26,000
domains that are not available then we

863
00:35:26,000 --> 00:35:30,770
have those they have high relative

864
00:35:30,770 --> 00:35:32,660
numbers of registration so I'm going by

865
00:35:32,660 --> 00:35:34,099
percentage now all of them have

866
00:35:34,099 --> 00:35:37,099
more than 10% registrations and four of

867
00:35:37,099 --> 00:35:38,359
the on the left side

868
00:35:38,359 --> 00:35:40,489
excluding super box you can see they

869
00:35:40,489 --> 00:35:42,680
have less than four thousand domains so

870
00:35:42,680 --> 00:35:45,739
that somewhat explains the high relative

871
00:35:45,739 --> 00:35:48,319
number and super box with those eleven

872
00:35:48,319 --> 00:35:50,989
thousand domains and no take down as far

873
00:35:50,989 --> 00:35:55,489
as I know looks interesting as well then

874
00:35:55,489 --> 00:35:57,410
you have those more than five percent

875
00:35:57,410 --> 00:36:00,349
and you see there's not actually that

876
00:36:00,349 --> 00:36:03,799
many so this is one down there has 13 as

877
00:36:03,799 --> 00:36:06,380
per but I found only 15 but they only

878
00:36:06,380 --> 00:36:09,400
know Limited net of set of seats they're

879
00:36:09,400 --> 00:36:11,839
remnant which also had to take down only

880
00:36:11,839 --> 00:36:14,960
has 900 which I cannot explain for some

881
00:36:14,960 --> 00:36:17,359
reason and this one is also probably a

882
00:36:17,359 --> 00:36:20,930
rather unpopular family and has few

883
00:36:20,930 --> 00:36:24,259
registrations so then you have some that

884
00:36:24,259 --> 00:36:28,249
have less relative but high absolute

885
00:36:28,249 --> 00:36:29,900
registration so all of the green ones

886
00:36:29,900 --> 00:36:31,430
now have more than a thousand

887
00:36:31,430 --> 00:36:34,700
registrations and two other names show

888
00:36:34,700 --> 00:36:36,229
up here that's per meter and

889
00:36:36,229 --> 00:36:36,799
cryptolocker

890
00:36:36,799 --> 00:36:39,170
and both of them also have takedowns so

891
00:36:39,170 --> 00:36:41,420
that explains a bit there higher numbers

892
00:36:41,420 --> 00:36:45,829
and all of the other ones have both low

893
00:36:45,829 --> 00:36:47,390
relative and absolute numbers of

894
00:36:47,390 --> 00:36:51,829
registrations okay so it gives us a

895
00:36:51,829 --> 00:36:54,799
total of around about 115,000

896
00:36:54,799 --> 00:36:56,440
registrations that I know of which is

897
00:36:56,440 --> 00:36:59,089
0.62 percent of those 80 point five

898
00:36:59,089 --> 00:37:01,069
million domains that are potentially

899
00:37:01,069 --> 00:37:03,999
generated so less than 1% is likely

900
00:37:03,999 --> 00:37:06,710
register yeah

901
00:37:06,710 --> 00:37:08,930
like I said those three were takedowns

902
00:37:08,930 --> 00:37:10,849
and how many of those are takedowns

903
00:37:10,849 --> 00:37:13,329
actually the vast majority so I'm

904
00:37:13,329 --> 00:37:16,309
looking at that you have 72 thousand

905
00:37:16,309 --> 00:37:17,690
registrations that are related to the

906
00:37:17,690 --> 00:37:19,180
game of attitude peer-to-peer deck down

907
00:37:19,180 --> 00:37:21,829
almost 8,000 of the barometer ones

908
00:37:21,829 --> 00:37:23,420
almost 3,000 of the coop the locker ones

909
00:37:23,420 --> 00:37:25,759
which then again means that seventy two

910
00:37:25,759 --> 00:37:29,960
point five six percent of those 115,000

911
00:37:29,960 --> 00:37:33,009
domains are actually ones that have been

912
00:37:33,009 --> 00:37:35,930
basically done together with the

913
00:37:35,930 --> 00:37:40,279
takedown yeah this is the next

914
00:37:40,279 --> 00:37:42,469
interesting thing dude DJ's collide with

915
00:37:42,469 --> 00:37:44,749
pre-register that's what I call it been

916
00:37:44,749 --> 00:37:47,280
likely benign domains

917
00:37:47,280 --> 00:37:50,790
we exclude those again your gut feeling

918
00:37:50,790 --> 00:37:52,560
might tell you if you have a DJ that

919
00:37:52,560 --> 00:37:53,490
uses word list

920
00:37:53,490 --> 00:37:56,370
that makes it probably more likely that

921
00:37:56,370 --> 00:37:58,500
domains I registered by other people

922
00:37:58,500 --> 00:37:59,910
because those domain names are

923
00:37:59,910 --> 00:38:02,250
attractive or these more attractive than

924
00:38:02,250 --> 00:38:06,200
20 character long random names and

925
00:38:06,200 --> 00:38:09,420
indeed you can see that those three

926
00:38:09,420 --> 00:38:11,790
families have rather high registrations

927
00:38:11,790 --> 00:38:14,130
even before their families appeared in

928
00:38:14,130 --> 00:38:15,750
case of super box this is really drastic

929
00:38:15,750 --> 00:38:19,470
so I'm Dave about 3/4 of all the domains

930
00:38:19,470 --> 00:38:21,570
you have there that have been registered

931
00:38:21,570 --> 00:38:24,390
before early 2013 I think when this

932
00:38:24,390 --> 00:38:26,340
family first showed you can see that

933
00:38:26,340 --> 00:38:28,140
many of them even were registered in the

934
00:38:28,140 --> 00:38:31,860
early 2000s because two names from top

935
00:38:31,860 --> 00:38:35,580
net sounds like something you might want

936
00:38:35,580 --> 00:38:36,690
to have to start a business because

937
00:38:36,690 --> 00:38:38,880
especially the choice of words implies

938
00:38:38,880 --> 00:38:41,520
it so those guys really I think wanted

939
00:38:41,520 --> 00:38:43,790
to melt into a DD Bank benign domains

940
00:38:43,790 --> 00:38:47,520
for Guzzi mats new it's far less but

941
00:38:47,520 --> 00:38:48,870
it's still a high relative number there

942
00:38:48,870 --> 00:38:51,630
we have a couple more families that also

943
00:38:51,630 --> 00:38:53,820
have a lot of pre registered domains and

944
00:38:53,820 --> 00:38:56,850
it's mostly because they have shot the

945
00:38:56,850 --> 00:38:59,010
main names I'm doing a breakdown shortly

946
00:38:59,010 --> 00:39:02,580
on that those families have at least

947
00:39:02,580 --> 00:39:05,010
some pre-registrations before they first

948
00:39:05,010 --> 00:39:07,320
appeared and all of the others have no

949
00:39:07,320 --> 00:39:09,420
single registration that's because we

950
00:39:09,420 --> 00:39:11,220
have seen earlier that many or basically

951
00:39:11,220 --> 00:39:13,230
the majority of them uses arithmetic

952
00:39:13,230 --> 00:39:15,390
concepts so generating really random

953
00:39:15,390 --> 00:39:17,160
domain names which makes it really

954
00:39:17,160 --> 00:39:19,080
unlikely that someone wanted to get

955
00:39:19,080 --> 00:39:21,800
those domains before the family appeared

956
00:39:21,800 --> 00:39:24,210
okay so what can we conclude from that

957
00:39:24,210 --> 00:39:26,660
um let's break down again those

958
00:39:26,660 --> 00:39:29,820
pre-registrations about 90% of them are

959
00:39:29,820 --> 00:39:33,800
worthless DJ's which leaves us with of

960
00:39:33,800 --> 00:39:36,870
good thousand domains out of them

961
00:39:36,870 --> 00:39:40,460
another 93% have only a length of 5 to 6

962
00:39:40,460 --> 00:39:44,040
so the longer a domain gets over DG it's

963
00:39:44,040 --> 00:39:46,140
very unlikely that it's somehow

964
00:39:46,140 --> 00:39:48,390
registered by someone that's not related

965
00:39:48,390 --> 00:39:50,610
to the tml we're actually or a sinkhole

966
00:39:50,610 --> 00:39:55,140
oh you will have accidential real words

967
00:39:55,140 --> 00:39:56,880
so this is for example a domain

968
00:39:56,880 --> 00:39:59,320
generated by pushed off and

969
00:39:59,320 --> 00:40:00,700
I think it makes sense that someone

970
00:40:00,700 --> 00:40:02,950
might have registered that one and the

971
00:40:02,950 --> 00:40:04,720
other ones that are longer than six and

972
00:40:04,720 --> 00:40:06,940
collide are what I call rather

973
00:40:06,940 --> 00:40:09,220
pronounceable names so it's easy to

974
00:40:09,220 --> 00:40:11,170
speak something like conch on an ax or

975
00:40:11,170 --> 00:40:12,910
candle meat and that's something that

976
00:40:12,910 --> 00:40:14,440
you will find for basically all of those

977
00:40:14,440 --> 00:40:16,600
domains I think many of them might even

978
00:40:16,600 --> 00:40:18,430
have a meaning and all of the language I

979
00:40:18,430 --> 00:40:20,050
think yesterday we also heard that them

980
00:40:20,050 --> 00:40:22,150
there to the Western world

981
00:40:22,150 --> 00:40:23,910
random-looking domains that are

982
00:40:23,910 --> 00:40:26,530
generated by by asian countries mainly

983
00:40:26,530 --> 00:40:28,210
that's also what I saw so many of them

984
00:40:28,210 --> 00:40:29,920
basically are registered with a Chinese

985
00:40:29,920 --> 00:40:34,270
registrar but the good news is since we

986
00:40:34,270 --> 00:40:36,400
don't have that many collisions with

987
00:40:36,400 --> 00:40:39,760
Longboat SDGs and long domains it's fair

988
00:40:39,760 --> 00:40:41,140
to Houston for blocking because we'll

989
00:40:41,140 --> 00:40:43,780
almost have no false positives with that

990
00:40:43,780 --> 00:40:45,910
so I think it's pretty viable to use

991
00:40:45,910 --> 00:40:47,950
those pre-generated domains in order to

992
00:40:47,950 --> 00:40:52,510
do blocking okay so more that's the last

993
00:40:52,510 --> 00:40:54,790
part before I might have time for the

994
00:40:54,790 --> 00:40:56,320
bonus part we'll see about that

995
00:40:56,320 --> 00:40:59,080
consider time dependent DJ's for time

996
00:40:59,080 --> 00:41:00,790
dependent DJ's you can think of

997
00:41:00,790 --> 00:41:03,580
something when do those domains get

998
00:41:03,580 --> 00:41:06,220
registered relatively to the time when

999
00:41:06,220 --> 00:41:09,160
those domains get valid so if a DJ that

1000
00:41:09,160 --> 00:41:11,800
generates domains today and I want to

1001
00:41:11,800 --> 00:41:14,080
use those domains so it might be a good

1002
00:41:14,080 --> 00:41:16,180
idea to register them like three days in

1003
00:41:16,180 --> 00:41:17,830
advance so I definitely have those

1004
00:41:17,830 --> 00:41:21,460
domains when they become valid since

1005
00:41:21,460 --> 00:41:23,500
those domains have a window of validity

1006
00:41:23,500 --> 00:41:25,840
we can do a calculation of this

1007
00:41:25,840 --> 00:41:27,550
registration look ahead that's basically

1008
00:41:27,550 --> 00:41:29,890
what I called it here so the offsets the

1009
00:41:29,890 --> 00:41:31,540
relative offset between when a domain

1010
00:41:31,540 --> 00:41:34,000
becomes valid and when it was registered

1011
00:41:34,000 --> 00:41:40,270
and I try to defer between sinkholes and

1012
00:41:40,270 --> 00:41:41,770
non sinkholes because you can see some

1013
00:41:41,770 --> 00:41:44,830
differences here another flood of

1014
00:41:44,830 --> 00:41:47,530
information incoming because it was to

1015
00:41:47,530 --> 00:41:48,880
my feeling the the best way to represent

1016
00:41:48,880 --> 00:41:51,370
that stuff but you can see here

1017
00:41:51,370 --> 00:41:54,130
basically the middle access means if a

1018
00:41:54,130 --> 00:41:57,130
domain becomes valid and it's registered

1019
00:41:57,130 --> 00:41:59,800
on the same day the data point will sit

1020
00:41:59,800 --> 00:42:02,620
here in the middle if it's registered

1021
00:42:02,620 --> 00:42:04,210
before the domain becomes wellit's it

1022
00:42:04,210 --> 00:42:06,970
will be shifted to the left if it's

1023
00:42:06,970 --> 00:42:08,500
research that afterwards they will be

1024
00:42:08,500 --> 00:42:10,660
shifted to the right and the rep pass

1025
00:42:10,660 --> 00:42:12,040
that you can see it's basically the

1026
00:42:12,040 --> 00:42:13,090
validity

1027
00:42:13,090 --> 00:42:15,820
that's those TGS F so for game of a

1028
00:42:15,820 --> 00:42:17,260
peer-to-peer it's possible that remains

1029
00:42:17,260 --> 00:42:21,850
a valid up to seven seven days for Guzzi

1030
00:42:21,850 --> 00:42:23,650
you might have to Mesa developed for a

1031
00:42:23,650 --> 00:42:25,900
full three months and so on and you

1032
00:42:25,900 --> 00:42:27,940
basically see how that this more or less

1033
00:42:27,940 --> 00:42:30,940
some shows in the data so first

1034
00:42:30,940 --> 00:42:34,410
opposition is sinkholes anomaly resisted

1035
00:42:34,410 --> 00:42:38,980
much earlier than non sinkholes let them

1036
00:42:38,980 --> 00:42:41,260
be malicious ones or some said I were

1037
00:42:41,260 --> 00:42:43,810
not able to identify sinkholes I think

1038
00:42:43,810 --> 00:42:46,360
that's pretty much what you would also

1039
00:42:46,360 --> 00:42:48,730
assume because as a sinkhole uh you can

1040
00:42:48,730 --> 00:42:50,320
always benefit from the data that's

1041
00:42:50,320 --> 00:42:52,540
coming in even before the domain

1042
00:42:52,540 --> 00:42:55,060
actually becomes valid for a bad guy you

1043
00:42:55,060 --> 00:42:57,490
have to ensure that you have control of

1044
00:42:57,490 --> 00:43:00,490
the domain at the peak of the time so

1045
00:43:00,490 --> 00:43:03,190
it's perfectly explainable that many of

1046
00:43:03,190 --> 00:43:05,320
those registrations happen even during

1047
00:43:05,320 --> 00:43:09,550
the validity window of a domain there's

1048
00:43:09,550 --> 00:43:11,830
some interesting what I thought first is

1049
00:43:11,830 --> 00:43:15,760
outlier for vomit I when I look closer

1050
00:43:15,760 --> 00:43:16,540
at that one

1051
00:43:16,540 --> 00:43:19,750
I saw that at one point in time the word

1052
00:43:19,750 --> 00:43:22,090
domains registered for the same date but

1053
00:43:22,090 --> 00:43:24,040
one two and three years in advance

1054
00:43:24,040 --> 00:43:26,650
so it looks like some basically the

1055
00:43:26,650 --> 00:43:28,120
botnet operator wanted to do insurance

1056
00:43:28,120 --> 00:43:31,150
there so even if it's botnets botnet

1057
00:43:31,150 --> 00:43:32,710
gets taken down he will have those two

1058
00:43:32,710 --> 00:43:35,950
mains far into the future it's not a

1059
00:43:35,950 --> 00:43:37,090
complete thought because you would

1060
00:43:37,090 --> 00:43:38,410
normally sees those domains as well I've

1061
00:43:38,410 --> 00:43:40,540
been doing a takedown but that I think I

1062
00:43:40,540 --> 00:43:41,980
see one of the motivations where you

1063
00:43:41,980 --> 00:43:43,330
would do that and then I look for the

1064
00:43:43,330 --> 00:43:45,100
other families and I found more two more

1065
00:43:45,100 --> 00:43:46,930
families where this is also the case so

1066
00:43:46,930 --> 00:43:48,490
both nine name and more Offutt

1067
00:43:48,490 --> 00:43:50,290
especially more of it with one

1068
00:43:50,290 --> 00:43:53,350
registration for years in advance so

1069
00:43:53,350 --> 00:43:56,170
more offer also later became since the

1070
00:43:56,170 --> 00:43:59,350
same code base say VGA even game over P

1071
00:43:59,350 --> 00:44:04,210
2 p.m. then we have this one that's

1072
00:44:04,210 --> 00:44:05,560
probably also something that people see

1073
00:44:05,560 --> 00:44:07,900
later on when you might want to look at

1074
00:44:07,900 --> 00:44:09,280
the slides again because too much data

1075
00:44:09,280 --> 00:44:12,430
and so on game over video peer from a

1076
00:44:12,430 --> 00:44:14,380
DGA point of view was completely taken

1077
00:44:14,380 --> 00:44:16,060
down so there are no registrations

1078
00:44:16,060 --> 00:44:18,760
wellit's after the takedown date which

1079
00:44:18,760 --> 00:44:22,630
was end of May 2013

1080
00:44:22,630 --> 00:44:24,160
1414

1081
00:44:24,160 --> 00:44:27,850
and the last interesting pointed over to

1082
00:44:27,850 --> 00:44:29,620
point out is this one I'm not sure how

1083
00:44:29,620 --> 00:44:30,910
that happened so either it's my

1084
00:44:30,910 --> 00:44:33,190
reversing fail or the reversing field of

1085
00:44:33,190 --> 00:44:37,000
someone else for three be in 2015

1086
00:44:37,000 --> 00:44:40,090
someone registered domains 30 days after

1087
00:44:40,090 --> 00:44:44,110
they stopped being welded so it looks to

1088
00:44:44,110 --> 00:44:46,600
me that someone has enough buy one in

1089
00:44:46,600 --> 00:44:48,130
the de month there or it didn't

1090
00:44:48,130 --> 00:44:49,600
understand the algorithm correctly at

1091
00:44:49,600 --> 00:44:51,160
least I debug the driver and I'm pretty

1092
00:44:51,160 --> 00:44:53,980
sure that my data is correct so whoever

1093
00:44:53,980 --> 00:44:56,140
was in holding them didn't get any data

1094
00:44:56,140 --> 00:44:57,880
I think from from what he tried to do

1095
00:44:57,880 --> 00:45:03,880
them okay conclusion yeah this is the

1096
00:45:03,880 --> 00:45:05,590
till the MRAP part so please refrain

1097
00:45:05,590 --> 00:45:10,000
from publishing that DG archive I'm

1098
00:45:10,000 --> 00:45:11,860
always happy to give out accounts to

1099
00:45:11,860 --> 00:45:13,210
that service because it makes it more

1100
00:45:13,210 --> 00:45:15,550
valuable if more people to it can

1101
00:45:15,550 --> 00:45:17,650
benefit from it so you can request free

1102
00:45:17,650 --> 00:45:20,320
access by sending me an email one thing

1103
00:45:20,320 --> 00:45:22,180
please do not send emails from free

1104
00:45:22,180 --> 00:45:24,940
mailers because I want to maintain some

1105
00:45:24,940 --> 00:45:28,840
kind of protection for this service so I

1106
00:45:28,840 --> 00:45:31,030
need some basic proof of identity one of

1107
00:45:31,030 --> 00:45:32,290
the easiest way to do that is if you

1108
00:45:32,290 --> 00:45:33,430
send me an email from your corporate

1109
00:45:33,430 --> 00:45:34,810
account because then I know where you

1110
00:45:34,810 --> 00:45:37,000
come from or you have someone bet for

1111
00:45:37,000 --> 00:45:39,430
you otherwise if we see each other today

1112
00:45:39,430 --> 00:45:41,650
in person I at least know your face and

1113
00:45:41,650 --> 00:45:43,510
that's also some kind of trust building

1114
00:45:43,510 --> 00:45:45,310
because that's what many of the things

1115
00:45:45,310 --> 00:45:47,140
you are about like something I mean it

1116
00:45:47,140 --> 00:45:52,330
also said yesterday future plans I am I

1117
00:45:52,330 --> 00:45:55,150
want to document this in more detail

1118
00:45:55,150 --> 00:45:58,090
because even in 15 minutes I can only

1119
00:45:58,090 --> 00:46:00,040
put in so on so much information and I

1120
00:46:00,040 --> 00:46:02,260
think a paper is a better way to do that

1121
00:46:02,260 --> 00:46:06,550
in more detail the heuristic or domain

1122
00:46:06,550 --> 00:46:09,040
classifier that I used to find new seats

1123
00:46:09,040 --> 00:46:12,220
and DJs I'm probably also offering that

1124
00:46:12,220 --> 00:46:14,050
through DG archive so if you put in

1125
00:46:14,050 --> 00:46:15,820
domains it will at least tell you if

1126
00:46:15,820 --> 00:46:17,980
it's not another database that it fits

1127
00:46:17,980 --> 00:46:21,220
this entire team of those DJ's so this

1128
00:46:21,220 --> 00:46:23,890
should maybe also be helpful for things

1129
00:46:23,890 --> 00:46:26,740
that I don't cover yet I need to do more

1130
00:46:26,740 --> 00:46:29,920
automation because it's it was for a

1131
00:46:29,920 --> 00:46:31,630
long time a three-time project and it's

1132
00:46:31,630 --> 00:46:34,660
becoming quite relevant or usable and

1133
00:46:34,660 --> 00:46:37,600
finally I was approached by someone

1134
00:46:37,600 --> 00:46:41,860
so time ago um who said hey um it would

1135
00:46:41,860 --> 00:46:43,810
be cool I'm looking up domains and you

1136
00:46:43,810 --> 00:46:45,250
don't have them in your database and I

1137
00:46:45,250 --> 00:46:46,960
think other people might feel the same

1138
00:46:46,960 --> 00:46:48,510
way so I'd looked at the locks and

1139
00:46:48,510 --> 00:46:51,040
actually this you can always see some

1140
00:46:51,040 --> 00:46:53,170
users query for the same domains in the

1141
00:46:53,170 --> 00:46:54,910
same time of age so normally that means

1142
00:46:54,910 --> 00:46:56,950
they see that in other telemetry want to

1143
00:46:56,950 --> 00:46:59,140
know if it's a DJ a domain or not and I

1144
00:46:59,140 --> 00:47:00,730
think it would be a good idea to connect

1145
00:47:00,730 --> 00:47:03,400
those people and if someone else already

1146
00:47:03,400 --> 00:47:06,010
knows those domains it could be a good

1147
00:47:06,010 --> 00:47:07,960
thing to basically work together and try

1148
00:47:07,960 --> 00:47:09,700
to identify those algorithms or those

1149
00:47:09,700 --> 00:47:12,220
seeds and in order to give you a glimpse

1150
00:47:12,220 --> 00:47:14,740
you can use that's why it still remember

1151
00:47:14,740 --> 00:47:16,750
those credentials to check out the

1152
00:47:16,750 --> 00:47:19,450
service like last year this time

1153
00:47:19,450 --> 00:47:22,390
password is data candy but this is

1154
00:47:22,390 --> 00:47:24,640
limited to look up so you can throw in

1155
00:47:24,640 --> 00:47:26,380
domains in the mask you can see there in

1156
00:47:26,380 --> 00:47:28,390
order to check out domains but it

1157
00:47:28,390 --> 00:47:30,070
doesn't allow you to pre generate those

1158
00:47:30,070 --> 00:47:34,060
block lists because the license under

1159
00:47:34,060 --> 00:47:35,680
which I give the data out is basically

1160
00:47:35,680 --> 00:47:38,320
non-commercial and requires you to not

1161
00:47:38,320 --> 00:47:39,490
use it commercially so you are not

1162
00:47:39,490 --> 00:47:41,230
allowed to put those block lists into

1163
00:47:41,230 --> 00:47:42,880
feeds but if you are running a cert you

1164
00:47:42,880 --> 00:47:45,970
can have all my data so I'd like to

1165
00:47:45,970 --> 00:47:48,250
provide a for fee and since this was a

1166
00:47:48,250 --> 00:47:49,930
lot of work and you cannot stem all of

1167
00:47:49,930 --> 00:47:52,690
that alone I have to say thank you to us

1168
00:47:52,690 --> 00:47:54,880
bada if you are into DJs you probably

1169
00:47:54,880 --> 00:47:56,410
know that name because he is blogging

1170
00:47:56,410 --> 00:47:58,330
really a lot about that stuff and I

1171
00:47:58,330 --> 00:48:00,250
collaborate regularly with him on that

1172
00:48:00,250 --> 00:48:02,950
occasion and Michael clap from domain

1173
00:48:02,950 --> 00:48:05,110
shields obviously Chris Baker was the

1174
00:48:05,110 --> 00:48:07,210
guy who hooked me up with my dad and got

1175
00:48:07,210 --> 00:48:09,880
all this to Maine to sing started from

1176
00:48:09,880 --> 00:48:11,950
Enoch with Trey DJ's from time to time

1177
00:48:11,950 --> 00:48:14,710
Thomas also contributed DJs and all of

1178
00:48:14,710 --> 00:48:16,780
the other people basically also

1179
00:48:16,780 --> 00:48:18,520
contributed in one or the other way be

1180
00:48:18,520 --> 00:48:20,770
it and hey you missed up that seed or

1181
00:48:20,770 --> 00:48:22,690
here's another seed here's another DTA

1182
00:48:22,690 --> 00:48:25,030
should look at that thing and so on so

1183
00:48:25,030 --> 00:48:26,830
thanks to all of you and especially

1184
00:48:26,830 --> 00:48:28,720
shadows over because they support my

1185
00:48:28,720 --> 00:48:36,850
research vastly ok two minutes um we can

1186
00:48:36,850 --> 00:48:40,390
do questions or bonus whisper bonus and

1187
00:48:40,390 --> 00:48:47,980
who's for questions bonus okay I told

1188
00:48:47,980 --> 00:48:49,530
you that

1189
00:48:49,530 --> 00:48:51,630
some of those alphabets look somewhat

1190
00:48:51,630 --> 00:48:54,840
weird okay it's still not sure if it's

1191
00:48:54,840 --> 00:48:56,369
intentional because my colleagues here

1192
00:48:56,369 --> 00:48:58,950
now you cannot say it sparks but I'm

1193
00:48:58,950 --> 00:49:00,840
pretty sure it's bugs so we we have this

1194
00:49:00,840 --> 00:49:03,420
algorithm and they try to map the

1195
00:49:03,420 --> 00:49:06,780
alphabet from A to Z and he do this by

1196
00:49:06,780 --> 00:49:11,490
adding at most 25 to your 8 I don't know

1197
00:49:11,490 --> 00:49:13,320
if people don't understand how module

1198
00:49:13,320 --> 00:49:15,810
works but for seven different algorithms

1199
00:49:15,810 --> 00:49:18,800
you can see that they use modulo 25

1200
00:49:18,800 --> 00:49:20,910
because they probably want arranged to

1201
00:49:20,910 --> 00:49:23,160
be up to 25 but that makes you end up

1202
00:49:23,160 --> 00:49:25,590
with 24 so all of those names you can

1203
00:49:25,590 --> 00:49:28,320
see there will never contain a set so

1204
00:49:28,320 --> 00:49:29,880
they all of them generate domains that

1205
00:49:29,880 --> 00:49:32,630
will not contain as it

1206
00:49:32,630 --> 00:49:36,030
some of them mess up twice so if you

1207
00:49:36,030 --> 00:49:38,220
split up your alphabet into vowels and

1208
00:49:38,220 --> 00:49:39,869
consonants and characters and numbers

1209
00:49:39,869 --> 00:49:41,730
you have a chance to do that modern ones

1210
00:49:41,730 --> 00:49:44,310
so that means you end up with 34 or even

1211
00:49:44,310 --> 00:49:46,920
musai which the author I think forgot

1212
00:49:46,920 --> 00:49:49,560
the letter J so you then have basically

1213
00:49:49,560 --> 00:49:51,980
three characters that will never show up

1214
00:49:51,980 --> 00:49:55,650
or you can even be more special the way

1215
00:49:55,650 --> 00:49:57,450
Ramdas written basically halves the

1216
00:49:57,450 --> 00:49:59,160
whole alphabet so they only take every

1217
00:49:59,160 --> 00:50:00,720
second character also not sure if

1218
00:50:00,720 --> 00:50:02,880
intentionally or not it's really

1219
00:50:02,880 --> 00:50:04,859
completely messed up topic uses

1220
00:50:04,859 --> 00:50:06,030
different alphabets for different

1221
00:50:06,030 --> 00:50:07,650
letters and doesn't reach all it

1222
00:50:07,650 --> 00:50:10,680
probably wants eurozone as well yeah so

1223
00:50:10,680 --> 00:50:13,950
that's the one that I cannot cover yeah

1224
00:50:13,950 --> 00:50:17,160
that was the bonus part so here we go

1225
00:50:17,160 --> 00:50:21,200
okay thank you for your attention

1226
00:50:26,850 --> 00:50:29,910
thank you

