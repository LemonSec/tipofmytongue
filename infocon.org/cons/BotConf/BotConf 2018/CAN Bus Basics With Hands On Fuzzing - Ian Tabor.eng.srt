1
00:00:00,000 --> 00:00:02,029
Oh

2
00:00:03,280 --> 00:00:06,740
thank you

3
00:00:05,060 --> 00:00:08,300
welcome everyone this is slightly better

4
00:00:06,740 --> 00:00:11,480
attended in the last time I did it but

5
00:00:08,300 --> 00:00:13,639
somewhere X I mean table this is my fate

6
00:00:11,480 --> 00:00:14,059
he's my old colleague from we're used to

7
00:00:13,639 --> 00:00:15,588
work

8
00:00:14,059 --> 00:00:17,480
he knows roughly how to get stuff

9
00:00:15,589 --> 00:00:20,900
working so he'll be around just to help

10
00:00:17,480 --> 00:00:25,519
you if I'm stuck at the front of here so

11
00:00:20,900 --> 00:00:27,140
let me start Who am I you could say I'm

12
00:00:25,519 --> 00:00:29,479
the ultimate car hire because I built

13
00:00:27,140 --> 00:00:32,029
that thing 14 years ago it has three

14
00:00:29,480 --> 00:00:34,340
ECU's two of which I built the third one

15
00:00:32,029 --> 00:00:37,180
is the electronic distributor which was

16
00:00:34,340 --> 00:00:39,830
built by Ford but it goes like stink and

17
00:00:37,180 --> 00:00:42,500
great little cars to drive but it has

18
00:00:39,830 --> 00:00:43,640
they'd be no electronics at all there is

19
00:00:42,500 --> 00:00:46,610
a little disclaimer at the bottom here

20
00:00:43,640 --> 00:00:50,450
if you brick your own car it's not my

21
00:00:46,610 --> 00:00:53,030
fault I made my Jack loses gearbox and

22
00:00:50,450 --> 00:00:55,000
with a 50 grand car that's not a fun

23
00:00:53,030 --> 00:00:56,630
conversation to have with the dealer I

24
00:00:55,000 --> 00:00:58,880
didn't have to have that conversation

25
00:00:56,630 --> 00:01:00,680
with a dealer I just had to give it

26
00:00:58,880 --> 00:01:03,710
three weeks to learn how to change gear

27
00:01:00,680 --> 00:01:07,820
again don't do it unless you know what

28
00:01:03,710 --> 00:01:11,900
you're doing ready just don't but okay

29
00:01:07,820 --> 00:01:13,669
so when it comes to car hacking I found

30
00:01:11,900 --> 00:01:17,390
a vulnerability a few years ago in my

31
00:01:13,670 --> 00:01:18,860
own vehicle Citroen ds5 which is exactly

32
00:01:17,390 --> 00:01:21,440
the same head unit as what's in the

33
00:01:18,860 --> 00:01:24,410
suitcase at the end there on the coroner

34
00:01:21,440 --> 00:01:27,860
box in that you could tether through

35
00:01:24,410 --> 00:01:30,020
Wi-Fi and that exposed a telnet port on

36
00:01:27,860 --> 00:01:32,659
the head unit which then gave you access

37
00:01:30,020 --> 00:01:34,729
it gave someone access to the entire GPS

38
00:01:32,659 --> 00:01:37,610
history telephone history and your phone

39
00:01:34,730 --> 00:01:39,790
book etc manufacturers like yeah it's up

40
00:01:37,610 --> 00:01:42,140
to the user to secure their Wi-Fi

41
00:01:39,790 --> 00:01:44,930
actually not you really should get rid

42
00:01:42,140 --> 00:01:47,390
of the telnet port but allegedly it's

43
00:01:44,930 --> 00:01:49,420
fixed now by disabling the Wi-Fi you can

44
00:01:47,390 --> 00:01:52,340
still do the same hack over Bluetooth

45
00:01:49,420 --> 00:01:55,880
genius

46
00:01:52,340 --> 00:01:57,409
so in 2018 last year I did a talk about

47
00:01:55,880 --> 00:01:59,750
that those findings in slightly more

48
00:01:57,409 --> 00:02:00,770
detail than that and the process of

49
00:01:59,750 --> 00:02:04,210
actually disclosing it to the

50
00:02:00,770 --> 00:02:06,408
manufacturer very strange weird French

51
00:02:04,210 --> 00:02:09,109
conference calls I don't speak a word of

52
00:02:06,409 --> 00:02:10,970
French never have done that was it odd

53
00:02:09,110 --> 00:02:14,150
that yes I did

54
00:02:10,970 --> 00:02:15,109
DC 44:20 last year in April besides

55
00:02:14,150 --> 00:02:17,180
London rookie track

56
00:02:15,110 --> 00:02:19,460
in June last year and actually spoke at

57
00:02:17,180 --> 00:02:22,240
DEFCON car hacking village last year as

58
00:02:19,460 --> 00:02:25,160
well that was scary

59
00:02:22,240 --> 00:02:27,170
and the last year I got invited to a

60
00:02:25,160 --> 00:02:31,609
bugcrowd live car hacking event in

61
00:02:27,170 --> 00:02:33,380
October over in America where we find

62
00:02:31,610 --> 00:02:35,900
that found a major vulnerability in a

63
00:02:33,380 --> 00:02:38,060
vendors vehicle got a nice little payout

64
00:02:35,900 --> 00:02:41,300
which then paid to my car in the Box to

65
00:02:38,060 --> 00:02:44,810
be built which is now I'll I'm why I'm

66
00:02:41,300 --> 00:02:48,500
doing the car hacking village UK I was

67
00:02:44,810 --> 00:02:51,020
also part of a panel at DEFCON 27 this

68
00:02:48,500 --> 00:02:54,230
year with cyber Gibbons if you know him

69
00:02:51,020 --> 00:02:56,060
and inspectors who's from America and

70
00:02:54,230 --> 00:02:59,780
I've had been a bit of a busy year

71
00:02:56,060 --> 00:03:02,840
there's been eight different conferences

72
00:02:59,780 --> 00:03:03,920
this year so far there's this one I've

73
00:03:02,840 --> 00:03:06,830
got another one in a couple of weeks

74
00:03:03,920 --> 00:03:08,679
time with Interpol which is going to be

75
00:03:06,830 --> 00:03:10,640
scary because I'm on stage with Toyota

76
00:03:08,680 --> 00:03:12,739
and they've got their own car hacking

77
00:03:10,640 --> 00:03:15,529
platform and I've got my lovely car in a

78
00:03:12,739 --> 00:03:18,320
box it's gonna be a bit weird in front

79
00:03:15,530 --> 00:03:20,959
of Rio de coppers honest govern I'm not

80
00:03:18,320 --> 00:03:23,570
gonna steal your car yeah you can quite

81
00:03:20,959 --> 00:03:26,299
easy end of the month I've got b-sides

82
00:03:23,570 --> 00:03:29,750
whales that should be my last one for

83
00:03:26,299 --> 00:03:32,630
this year things might change I don't

84
00:03:29,750 --> 00:03:35,450
know one thing I will say is downstairs

85
00:03:32,630 --> 00:03:38,359
on the hackers for food banks table

86
00:03:35,450 --> 00:03:41,420
there is a limited edition car hack

87
00:03:38,360 --> 00:03:43,100
village 44 con mug what I'd only do is

88
00:03:41,420 --> 00:03:45,559
produce these for people that helped out

89
00:03:43,100 --> 00:03:48,950
with the conference and all the village

90
00:03:45,560 --> 00:03:51,500
so there is one of 10 downstairs if you

91
00:03:48,950 --> 00:03:56,298
want it go and buy it it helps that the

92
00:03:51,500 --> 00:03:57,830
charity I didn't set the price but if

93
00:03:56,299 --> 00:03:59,420
you got some spare change go and give it

94
00:03:57,830 --> 00:04:00,400
to them they're doing it for a good

95
00:03:59,420 --> 00:04:04,130
cause

96
00:04:00,400 --> 00:04:09,080
so on to the actual workshop so workshop

97
00:04:04,130 --> 00:04:12,530
outline we've first got the possible

98
00:04:09,080 --> 00:04:15,170
ECU's an attack surface we've got how

99
00:04:12,530 --> 00:04:17,238
canvas will what canvas is how the

100
00:04:15,170 --> 00:04:22,070
frames laid out the obd2 connector

101
00:04:17,238 --> 00:04:23,599
itself socket can and SL can which is

102
00:04:22,070 --> 00:04:26,000
serie line can which is what these

103
00:04:23,599 --> 00:04:27,590
clusters will use and then you've got

104
00:04:26,000 --> 00:04:28,920
some possible software options that

105
00:04:27,590 --> 00:04:31,890
probably won't work today

106
00:04:28,920 --> 00:04:33,870
because the hardware is a bit limited in

107
00:04:31,890 --> 00:04:35,219
what it does but you might be able to

108
00:04:33,870 --> 00:04:39,210
use it in the future if you actually get

109
00:04:35,220 --> 00:04:40,040
more involved in car hacking so first

110
00:04:39,210 --> 00:04:43,859
things first

111
00:04:40,040 --> 00:04:46,380
who has got their own car who has tried

112
00:04:43,860 --> 00:04:50,760
to hack their own car who has broken

113
00:04:46,380 --> 00:04:52,560
their own car no okay if you're a car

114
00:04:50,760 --> 00:04:54,210
hacker and you say you've not broke your

115
00:04:52,560 --> 00:04:57,480
own car you even not been trying or

116
00:04:54,210 --> 00:04:58,289
you're lying because normally you break

117
00:04:57,480 --> 00:05:00,360
something

118
00:04:58,290 --> 00:05:03,180
hopefully not something fundamentally

119
00:05:00,360 --> 00:05:05,040
wrong but if you know anything about

120
00:05:03,180 --> 00:05:05,490
cars these days they're all computers on

121
00:05:05,040 --> 00:05:07,350
wheels

122
00:05:05,490 --> 00:05:11,520
preferably actually smartphones on

123
00:05:07,350 --> 00:05:14,340
wheels the new Land Rover Freelander

124
00:05:11,520 --> 00:05:18,539
last week was released that has 83 ECU's

125
00:05:14,340 --> 00:05:20,549
I can't think of 83 places to put an ECU

126
00:05:18,540 --> 00:05:22,110
into a car so I don't know where they

127
00:05:20,550 --> 00:05:25,080
bloody put them but they're bloody

128
00:05:22,110 --> 00:05:29,190
everywhere so here's a lovely little

129
00:05:25,080 --> 00:05:30,630
picture of all the different ECU's cars

130
00:05:29,190 --> 00:05:32,969
are getting smarter you've got adaptive

131
00:05:30,630 --> 00:05:35,159
cruise control that lighting a bag of

132
00:05:32,970 --> 00:05:37,950
London energy once upon a time it was

133
00:05:35,160 --> 00:05:39,420
engine control that was it your computer

134
00:05:37,950 --> 00:05:42,090
but you've got all this other

135
00:05:39,420 --> 00:05:44,970
interesting stuff I won't read them out

136
00:05:42,090 --> 00:05:46,619
because it's just how point bingo I'm

137
00:05:44,970 --> 00:05:48,720
not going to do it I hate it

138
00:05:46,620 --> 00:05:51,930
who do to me but there are a lot of

139
00:05:48,720 --> 00:05:53,910
things in a car I will publish these at

140
00:05:51,930 --> 00:05:58,350
a later date through my website at some

141
00:05:53,910 --> 00:06:00,840
point so there are a lot of tack tack

142
00:05:58,350 --> 00:06:02,580
surfaces especially nowadays everyone

143
00:06:00,840 --> 00:06:04,650
think seems to think let's make them

144
00:06:02,580 --> 00:06:07,140
connected yeah great we'll give it Wi-Fi

145
00:06:04,650 --> 00:06:08,280
will give it bluetooth we'll make it so

146
00:06:07,140 --> 00:06:10,219
that when it gets a certain distance

147
00:06:08,280 --> 00:06:13,229
from the house it turns your bloody

148
00:06:10,220 --> 00:06:17,580
heating on it's like a genius on the

149
00:06:13,230 --> 00:06:21,990
ball mmm yeah they had the whole thing

150
00:06:17,580 --> 00:06:23,609
about keyless entry grey wonderful make

151
00:06:21,990 --> 00:06:25,800
sure you put your keys in a Faraday box

152
00:06:23,610 --> 00:06:27,330
inside your house because well guys

153
00:06:25,800 --> 00:06:32,220
someone will try relay attack on you

154
00:06:27,330 --> 00:06:33,719
especially you've got a nice car just in

155
00:06:32,220 --> 00:06:35,280
the safety case states that once they've

156
00:06:33,720 --> 00:06:36,350
got your car it won't turn off until it

157
00:06:35,280 --> 00:06:38,969
stops

158
00:06:36,350 --> 00:06:42,510
genius no

159
00:06:38,970 --> 00:06:45,870
so attack service this is sort of the

160
00:06:42,510 --> 00:06:48,840
attacks of his as set out within the car

161
00:06:45,870 --> 00:06:52,200
 hack as a handbook you got cell

162
00:06:48,840 --> 00:06:54,780
network Wi-Fi network tire pressure

163
00:06:52,200 --> 00:06:57,810
monitoring system they are very good at

164
00:06:54,780 --> 00:07:00,570
tracking vehicles I have been told but

165
00:06:57,810 --> 00:07:04,020
I'm not not confirmed this but some

166
00:07:00,570 --> 00:07:06,420
councils use sensors that pick up higher

167
00:07:04,020 --> 00:07:08,039
pressure monitoring systems and monitor

168
00:07:06,420 --> 00:07:09,630
where the hell you're driving they can

169
00:07:08,040 --> 00:07:12,060
also do the same with Bluetooth beacons

170
00:07:09,630 --> 00:07:14,280
so if you don't to be tracked turn your

171
00:07:12,060 --> 00:07:17,100
Bluetooth off means you can't use your

172
00:07:14,280 --> 00:07:21,630
phone that you can't be tracked but the

173
00:07:17,100 --> 00:07:24,780
car can be tracked anyway but the reason

174
00:07:21,630 --> 00:07:27,510
why I can exists is once upon a time on

175
00:07:24,780 --> 00:07:30,109
the left you had all your different ECU

176
00:07:27,510 --> 00:07:32,849
is connected by lots of different wires

177
00:07:30,110 --> 00:07:36,870
which is a bit of a problem because in

178
00:07:32,850 --> 00:07:39,360
the late 90s they were projecting that

179
00:07:36,870 --> 00:07:41,400
during the North Sea's it would be about

180
00:07:39,360 --> 00:07:43,800
57 percent of the vehicles mass would be

181
00:07:41,400 --> 00:07:45,859
copper because all the bits of cable

182
00:07:43,800 --> 00:07:48,150
going between all the different PC use

183
00:07:45,860 --> 00:07:50,690
so they had to come up with something

184
00:07:48,150 --> 00:07:54,409
meaningful boss then came up with kin

185
00:07:50,690 --> 00:07:59,780
which is now used within cars ships

186
00:07:54,410 --> 00:08:01,770
planes boats industrial control systems

187
00:07:59,780 --> 00:08:06,299
kitchens and things can use it as well

188
00:08:01,770 --> 00:08:10,609
but I know why I don't know how but yeah

189
00:08:06,300 --> 00:08:15,570
it was it was introduced by Bosch in

190
00:08:10,610 --> 00:08:18,660
1986 can network itself is just a simple

191
00:08:15,570 --> 00:08:21,419
two wire twisted pair network you've got

192
00:08:18,660 --> 00:08:24,210
a terminator each end and then every you

193
00:08:21,419 --> 00:08:28,349
see you saw things off that to our

194
00:08:24,210 --> 00:08:30,450
network normally the Terminator is

195
00:08:28,350 --> 00:08:32,520
either in the instrument cluster which

196
00:08:30,450 --> 00:08:34,380
you have in front of you or in the body

197
00:08:32,520 --> 00:08:37,079
control module which is sort of your

198
00:08:34,380 --> 00:08:39,838
main fuse box you shouldn't need to put

199
00:08:37,080 --> 00:08:42,690
a terminator if you're ever doing can

200
00:08:39,839 --> 00:08:43,860
stuff yourself on your own device unless

201
00:08:42,690 --> 00:08:46,080
you've got two devices talking

202
00:08:43,860 --> 00:08:47,550
back-to-back in which then you will

203
00:08:46,080 --> 00:08:51,960
because otherwise you'll get reflections

204
00:08:47,550 --> 00:08:52,699
on the end can itself uses what they

205
00:08:51,960 --> 00:08:57,940
call differential

206
00:08:52,700 --> 00:09:01,360
signaling so one one pin goes high as

207
00:08:57,940 --> 00:09:05,810
and one thing goes one voltage goes low

208
00:09:01,360 --> 00:09:08,510
zero is dominant as opposed to zero is

209
00:09:05,810 --> 00:09:10,459
dominant and one is recessive so if you

210
00:09:08,510 --> 00:09:13,400
measure the voltage on the pins you will

211
00:09:10,460 --> 00:09:14,960
normally get 2.5 volts unless there's a

212
00:09:13,400 --> 00:09:17,209
message coming across and then you'll

213
00:09:14,960 --> 00:09:18,830
get a it will go up by probably about a

214
00:09:17,210 --> 00:09:26,030
volt and down by probably about a volt

215
00:09:18,830 --> 00:09:28,070
so on here you've got zero one zero the

216
00:09:26,030 --> 00:09:34,730
actual frame itself is structured like

217
00:09:28,070 --> 00:09:37,520
this this is a can 2.0 frame with a

218
00:09:34,730 --> 00:09:42,700
standard length arbitration ID which is

219
00:09:37,520 --> 00:09:46,340
11 bits which gives you 2048 possible

220
00:09:42,700 --> 00:09:49,130
can message IDs the lowest message

221
00:09:46,340 --> 00:09:50,960
always wins so if you want to kill a car

222
00:09:49,130 --> 00:09:52,939
send message zero we've a load of

223
00:09:50,960 --> 00:09:54,650
rubbish in it and all the other ECU's

224
00:09:52,940 --> 00:09:56,000
will eventually go to sleep if you send

225
00:09:54,650 --> 00:09:57,380
it fast enough because it goes off

226
00:09:56,000 --> 00:10:00,170
something's more importantly I'm gonna

227
00:09:57,380 --> 00:10:04,100
go to sleep so if you want to be

228
00:10:00,170 --> 00:10:05,780
nefarious I'm not saying do this it

229
00:10:04,100 --> 00:10:08,180
might work it might not most it's not it

230
00:10:05,780 --> 00:10:09,410
does and the new way to get it back is

231
00:10:08,180 --> 00:10:12,079
actually powerful thing off and pair it

232
00:10:09,410 --> 00:10:13,969
back on on here you've got the color

233
00:10:12,080 --> 00:10:18,800
coding the green is the arbitration ID

234
00:10:13,970 --> 00:10:21,890
which said goes from 0 to 2048 and it's

235
00:10:18,800 --> 00:10:23,959
normally denoted in hex so you'll see a

236
00:10:21,890 --> 00:10:26,290
three digit number which will be the hex

237
00:10:23,960 --> 00:10:29,270
number not actually the decimal number

238
00:10:26,290 --> 00:10:31,910
the blue part is a request request

239
00:10:29,270 --> 00:10:34,460
remote that is a special type of frame

240
00:10:31,910 --> 00:10:36,890
where if you set that you're basically

241
00:10:34,460 --> 00:10:39,350
saying can I have some data from ECU X

242
00:10:36,890 --> 00:10:41,860
and then it will apply back with the

243
00:10:39,350 --> 00:10:44,000
required data that you it requests for

244
00:10:41,860 --> 00:10:47,570
you don't really see it much in a

245
00:10:44,000 --> 00:10:50,090
vehicle normally can is just fire and

246
00:10:47,570 --> 00:10:54,500
forget you don't see much saying give me

247
00:10:50,090 --> 00:10:58,280
some data is is a reply the yellow one

248
00:10:54,500 --> 00:11:00,680
on here is the length of the message a

249
00:10:58,280 --> 00:11:04,160
message can be anything from 0 to 8

250
00:11:00,680 --> 00:11:07,550
bytes byte excuse me

251
00:11:04,160 --> 00:11:11,719
eight bytes long so you've got either

252
00:11:07,550 --> 00:11:14,870
zero bits or 64 bits of data you can get

253
00:11:11,720 --> 00:11:16,970
a lot of data in 64 bits but be careful

254
00:11:14,870 --> 00:11:19,790
some of those messages carry more than

255
00:11:16,970 --> 00:11:21,529
one message in those bits so when you

256
00:11:19,790 --> 00:11:23,540
start playing the clusters the message

257
00:11:21,529 --> 00:11:26,420
for rev counter is the same message for

258
00:11:23,540 --> 00:11:27,829
the speedo so you have to change them

259
00:11:26,420 --> 00:11:31,130
both at the same time if you want to

260
00:11:27,829 --> 00:11:33,859
change them both and then all the stuff

261
00:11:31,130 --> 00:11:36,320
at the end is like CRC field and end of

262
00:11:33,860 --> 00:11:38,029
frame which is just if you don't ever

263
00:11:36,320 --> 00:11:42,440
see that so you don't really worry about

264
00:11:38,029 --> 00:11:43,820
it if ever bit if you've ever been

265
00:11:42,440 --> 00:11:46,310
trying to hacky carp

266
00:11:43,820 --> 00:11:49,220
you've got your obd2 connector this is

267
00:11:46,310 --> 00:11:53,510
in this was originally set up in America

268
00:11:49,220 --> 00:11:57,430
by California state emissions board as a

269
00:11:53,510 --> 00:12:00,680
standard for emissions testing back when

270
00:11:57,430 --> 00:12:01,729
fuel injection cars came out because

271
00:12:00,680 --> 00:12:03,109
they had to check that they were

272
00:12:01,730 --> 00:12:05,329
squirting the right amount of fuel in

273
00:12:03,110 --> 00:12:06,880
and getting the right clean air out to

274
00:12:05,329 --> 00:12:09,800
the back of it so they had a standard

275
00:12:06,880 --> 00:12:14,329
this has then gone forward to be adapted

276
00:12:09,800 --> 00:12:18,229
this is the minimal box the mineral is 6

277
00:12:14,329 --> 00:12:21,800
and 14 if you've got a posh car and you

278
00:12:18,230 --> 00:12:24,709
don't get stolen by either a key rope

279
00:12:21,800 --> 00:12:26,779
reprogramming attack or someone trying

280
00:12:24,709 --> 00:12:29,599
to reprogram your car where you've got

281
00:12:26,779 --> 00:12:31,070
the 12 volts it's always online put a

282
00:12:29,600 --> 00:12:33,199
switch under the dashboard to turn the

283
00:12:31,070 --> 00:12:35,000
12 volts off so if they then come and

284
00:12:33,199 --> 00:12:37,579
try and plug something in to reprogram

285
00:12:35,000 --> 00:12:41,120
your car it's normally fed by the thing

286
00:12:37,579 --> 00:12:45,219
they plug in from the car so if that 12

287
00:12:41,120 --> 00:12:47,480
volts isn't on it's not bit of work so

288
00:12:45,220 --> 00:12:50,510
yeah there was a spate a few years ago

289
00:12:47,480 --> 00:12:52,370
with lots of BMWs and high-end Ford's

290
00:12:50,510 --> 00:12:54,439
getting nixed because you could break

291
00:12:52,370 --> 00:12:57,640
the window plug into the obd2 port

292
00:12:54,440 --> 00:13:00,350
reprogram a key for the keyless ignition

293
00:12:57,640 --> 00:13:07,279
starting and drive off without the alarm

294
00:13:00,350 --> 00:13:11,870
went off genius not a good idea so onto

295
00:13:07,279 --> 00:13:14,720
socket can socket can is a sort of

296
00:13:11,870 --> 00:13:17,690
wrapper with in Linux rather than

297
00:13:14,720 --> 00:13:22,540
Windows that allows you access to the

298
00:13:17,690 --> 00:13:25,040
controller this hardware here you have

299
00:13:22,540 --> 00:13:27,949
doesn't really conform to socket can

300
00:13:25,040 --> 00:13:30,260
because it uses serial line can and

301
00:13:27,950 --> 00:13:36,290
Syrah line can is an extension that sort

302
00:13:30,260 --> 00:13:38,840
of fits in the middle that the drivers

303
00:13:36,290 --> 00:13:40,910
on the hard way on the Arduino boards

304
00:13:38,840 --> 00:13:43,370
that you have are a bit temperamental

305
00:13:40,910 --> 00:13:47,339
and don't initialize socket Cyril line

306
00:13:43,370 --> 00:13:48,670
can correctly so doesn't always work so

307
00:13:47,340 --> 00:13:52,580
[Music]

308
00:13:48,670 --> 00:13:55,219
on to Cyril line can itself

309
00:13:52,580 --> 00:13:57,830
Sarah line can is based on the lorry

310
00:13:55,220 --> 00:13:59,690
cell protocol and here is how you would

311
00:13:57,830 --> 00:14:01,910
initialize this if you had a Linux

312
00:13:59,690 --> 00:14:05,960
machine and you had an adapter that

313
00:14:01,910 --> 00:14:07,280
would actually work it works on some of

314
00:14:05,960 --> 00:14:08,810
my boards it doesn't work on all of them

315
00:14:07,280 --> 00:14:11,030
doesn't work on any of them because our

316
00:14:08,810 --> 00:14:13,369
opinion it works in about one in 20

317
00:14:11,030 --> 00:14:16,760
times and which is a bit temperamental

318
00:14:13,370 --> 00:14:20,630
but I can show you how to use your line

319
00:14:16,760 --> 00:14:24,260
can its baby human readable if you know

320
00:14:20,630 --> 00:14:26,090
what you're reading and so we'll come on

321
00:14:24,260 --> 00:14:27,920
to that in a second

322
00:14:26,090 --> 00:14:30,890
there are some further information so

323
00:14:27,920 --> 00:14:33,500
where it says - low case s and then a

324
00:14:30,890 --> 00:14:36,290
number those numbers denote the serial

325
00:14:33,500 --> 00:14:41,600
line speed anything from 10 K up to 1

326
00:14:36,290 --> 00:14:44,390
Meg 1 Meg is a maximum can 2.0 the other

327
00:14:41,600 --> 00:14:47,420
things there - o means open - c means

328
00:14:44,390 --> 00:14:48,949
foes don't quite get when you start it

329
00:14:47,420 --> 00:14:53,360
youth open the device and then close a

330
00:14:48,950 --> 00:14:57,050
device but it works when it works - this

331
00:14:53,360 --> 00:14:59,270
is the serial speed dev TTY is your tty

332
00:14:57,050 --> 00:15:01,400
port and can 0 is the name of the port

333
00:14:59,270 --> 00:15:03,530
you want it to be just called if you

334
00:15:01,400 --> 00:15:06,980
don't put can 0 at the end it is called

335
00:15:03,530 --> 00:15:09,050
SL can 0 Robin can 0 and then you have

336
00:15:06,980 --> 00:15:16,540
to modify your scripts and things decor

337
00:15:09,050 --> 00:15:19,010
Denis so for the fuzzing setup there are

338
00:15:16,540 --> 00:15:22,490
the at the top there is the command that

339
00:15:19,010 --> 00:15:24,890
you would used for a Linux device if SL

340
00:15:22,490 --> 00:15:29,840
can be actually worked at the bottom

341
00:15:24,890 --> 00:15:31,400
there is the commands you need to use if

342
00:15:29,840 --> 00:15:33,950
you want to use a serial

343
00:15:31,400 --> 00:15:40,100
port either in Windows or Linux it will

344
00:15:33,950 --> 00:15:42,770
work the the C is actually just a reset

345
00:15:40,100 --> 00:15:44,090
of the microcontroller you can just

346
00:15:42,770 --> 00:15:45,530
press the reset button on top there's a

347
00:15:44,090 --> 00:15:49,130
little red button most of the clusters

348
00:15:45,530 --> 00:15:51,680
that will reset it if you're lucky

349
00:15:49,130 --> 00:15:53,600
enough to get s okay and working you

350
00:15:51,680 --> 00:15:58,189
have four bits of software the part of

351
00:15:53,600 --> 00:15:59,630
can utils can dump which basically spews

352
00:15:58,190 --> 00:16:02,510
the entire contents of what's coming off

353
00:15:59,630 --> 00:16:03,860
the can bus to the screen and just keep

354
00:16:02,510 --> 00:16:05,660
scrolling until it finishes

355
00:16:03,860 --> 00:16:08,600
normally it won't finish until the

356
00:16:05,660 --> 00:16:10,790
cluster goes to sleep and it doesn't go

357
00:16:08,600 --> 00:16:14,630
to sleep very often it will just keep

358
00:16:10,790 --> 00:16:17,360
spewing rubbish can sniffer only shows

359
00:16:14,630 --> 00:16:20,240
the output of the messages that are

360
00:16:17,360 --> 00:16:21,860
changing by default so if you're looking

361
00:16:20,240 --> 00:16:24,200
for a specific message when you're

362
00:16:21,860 --> 00:16:26,360
trying to look at your car do can

363
00:16:24,200 --> 00:16:28,100
sniffer it will get rid of anything

364
00:16:26,360 --> 00:16:31,340
that's not changing and then when you

365
00:16:28,100 --> 00:16:33,320
flick a switch you will see a message

366
00:16:31,340 --> 00:16:36,200
probably come back and then a bit will

367
00:16:33,320 --> 00:16:38,150
change depending which one which bit is

368
00:16:36,200 --> 00:16:40,040
actually being used so that's quite

369
00:16:38,150 --> 00:16:43,100
handy to use if you're trying to work

370
00:16:40,040 --> 00:16:47,089
out what's going on most of the time to

371
00:16:43,100 --> 00:16:50,330
work out stuff on a car the BBC files

372
00:16:47,090 --> 00:16:54,170
that they use on our sort of closely

373
00:16:50,330 --> 00:16:55,340
guarded secrets I would say you can get

374
00:16:54,170 --> 00:16:57,380
hold of them if you work you're a

375
00:16:55,340 --> 00:16:59,270
manufacturer but you have to sign

376
00:16:57,380 --> 00:17:00,290
non-disclosure agreements and things so

377
00:16:59,270 --> 00:17:03,590
you're not allowed to tell anyone about

378
00:17:00,290 --> 00:17:05,920
them etc etc I have a few for a couple

379
00:17:03,590 --> 00:17:08,600
of different cars I can't give you them

380
00:17:05,920 --> 00:17:10,010
more than what my life is worth if I do

381
00:17:08,599 --> 00:17:14,119
that I won't be allowed on any bug

382
00:17:10,010 --> 00:17:15,829
bounties again so what you need to do is

383
00:17:14,119 --> 00:17:19,909
try and work out what those messages do

384
00:17:15,829 --> 00:17:21,560
yourself either by fuzzing if it's your

385
00:17:19,910 --> 00:17:23,630
own car do not fight your own car

386
00:17:21,560 --> 00:17:26,569
because you may make it jump the mileage

387
00:17:23,630 --> 00:17:28,250
or something stupid like that and if

388
00:17:26,569 --> 00:17:30,620
you're on a PC P Finance and you've got

389
00:17:28,250 --> 00:17:33,020
10,000 miles a year and you jump hit

390
00:17:30,620 --> 00:17:34,159
20,000 miles when you take the car back

391
00:17:33,020 --> 00:17:36,139
to the garage they will charge you for

392
00:17:34,160 --> 00:17:40,640
those extra twenty thousand miles 10

393
00:17:36,140 --> 00:17:41,960
p.m. on or whatever is if you can prove

394
00:17:40,640 --> 00:17:44,030
that there's no way you could have

395
00:17:41,960 --> 00:17:45,140
actually done that mileage right jump it

396
00:17:44,030 --> 00:17:47,420
a million miles

397
00:17:45,140 --> 00:17:49,250
or 500,000 miles and then go back and

398
00:17:47,420 --> 00:17:50,570
say there's no way even at 70

399
00:17:49,250 --> 00:17:52,400
mile-an-hour I could have done that

400
00:17:50,570 --> 00:17:56,240
distance in this amount of time since

401
00:17:52,400 --> 00:17:57,980
the last service so must be a glitch so

402
00:17:56,240 --> 00:17:59,510
can you please fix it for nothing

403
00:17:57,980 --> 00:18:02,170
because it must be your car that's

404
00:17:59,510 --> 00:18:04,940
broken and honest guv I didn't break it

405
00:18:02,170 --> 00:18:06,350
here on last of that that it's true I

406
00:18:04,940 --> 00:18:09,260
know people who have done it with high

407
00:18:06,350 --> 00:18:11,120
cars and taking it back and gone yeah I

408
00:18:09,260 --> 00:18:13,549
just got in it and it was at this really

409
00:18:11,120 --> 00:18:17,479
high mileage I don't know why and they

410
00:18:13,549 --> 00:18:18,799
believe them people do say if you're

411
00:18:17,480 --> 00:18:21,860
gonna hack a car hack a hire car

412
00:18:18,799 --> 00:18:22,970
problem is if you find anything if you

413
00:18:21,860 --> 00:18:24,770
try and disclose that to the

414
00:18:22,970 --> 00:18:27,919
manufacturer the first question

415
00:18:24,770 --> 00:18:30,500
manufacturers will be whose car was it

416
00:18:27,919 --> 00:18:32,330
and if you say it was Hertz they will

417
00:18:30,500 --> 00:18:33,950
probably be very cross with hers and

418
00:18:32,330 --> 00:18:36,049
hers will then put you on a blacklist

419
00:18:33,950 --> 00:18:38,600
you'll never be able to hire a car again

420
00:18:36,049 --> 00:18:40,160
and that won't be just hurts that will

421
00:18:38,600 --> 00:18:42,439
be all the different car manufacturers

422
00:18:40,160 --> 00:18:44,419
or all different car hire companies

423
00:18:42,440 --> 00:18:46,669
because they have a nice little friendly

424
00:18:44,419 --> 00:18:48,710
agreement between each other that if I

425
00:18:46,669 --> 00:18:52,460
black this someone they'll black someone

426
00:18:48,710 --> 00:18:55,700
as well so be careful screwing around my

427
00:18:52,460 --> 00:18:58,220
cars it's fun but just know how to fix

428
00:18:55,700 --> 00:18:59,870
it if it all goes peaked on normally

429
00:18:58,220 --> 00:19:02,679
disconnect battery for about 20 minutes

430
00:18:59,870 --> 00:19:04,909
and everything sort of fixes itself I

431
00:19:02,679 --> 00:19:06,700
can't guarantee that because I'm not

432
00:19:04,910 --> 00:19:13,280
broken every car that I've ever owned

433
00:19:06,700 --> 00:19:16,250
yet so on to the next bit which is here

434
00:19:13,280 --> 00:19:18,799
are some examples of some messages to Oh

435
00:19:16,250 --> 00:19:21,260
as commands to send the messages to

436
00:19:18,799 --> 00:19:25,280
change the thoughts that you have either

437
00:19:21,260 --> 00:19:28,580
at the top you've got the speed 250 mile

438
00:19:25,280 --> 00:19:30,820
an hour all these clusters are from

439
00:19:28,580 --> 00:19:33,470
French vehicles so actually all the

440
00:19:30,820 --> 00:19:35,689
odometers and speedos are actually in

441
00:19:33,470 --> 00:19:37,700
kilometers per hour by default you just

442
00:19:35,690 --> 00:19:39,290
happen to have the bit of plastic on top

443
00:19:37,700 --> 00:19:46,240
of it that actually prints the miles per

444
00:19:39,290 --> 00:19:49,960
hour on the front so 1e is not 50 it's

445
00:19:46,240 --> 00:19:52,309
somewhere around 800 or something in hex

446
00:19:49,960 --> 00:19:54,919
because it's done in fractions of a

447
00:19:52,309 --> 00:19:58,809
kilometer so some of those numbers don't

448
00:19:54,919 --> 00:19:58,809
make sense 70 is

449
00:19:58,910 --> 00:20:05,160
for the for the rev counter it's the

450
00:20:03,300 --> 00:20:07,680
first 11 bits of that message is the rev

451
00:20:05,160 --> 00:20:09,530
counter ID and if you ever get to see a

452
00:20:07,680 --> 00:20:11,820
dvc file it's a bit of a mine fuzz

453
00:20:09,530 --> 00:20:13,639
because some of the some of its in

454
00:20:11,820 --> 00:20:16,919
little-endian some of this in big endian

455
00:20:13,640 --> 00:20:19,380
so you'll have a have a bit of data that

456
00:20:16,920 --> 00:20:23,760
says you've got 64 bits of data that

457
00:20:19,380 --> 00:20:26,100
start a bit 63 how does that work it

458
00:20:23,760 --> 00:20:27,960
starts a bit 63 and goes backwards it

459
00:20:26,100 --> 00:20:30,990
doesn't start a bit zero and go forwards

460
00:20:27,960 --> 00:20:33,570
it's mhm I had to write my own script to

461
00:20:30,990 --> 00:20:36,180
decode BBC files when on working with a

462
00:20:33,570 --> 00:20:38,480
project and it was just like that will

463
00:20:36,180 --> 00:20:40,440
make sense now

464
00:20:38,480 --> 00:20:44,600
when you're when you're trying to work

465
00:20:40,440 --> 00:20:47,030
out where things are so you've got here

466
00:20:44,600 --> 00:20:52,800
trying to show you how this works

467
00:20:47,030 --> 00:20:55,080
actually it's on the next day so if

468
00:20:52,800 --> 00:20:59,370
you're using can saying you've got hands

469
00:20:55,080 --> 00:21:01,020
in the bus ID then you've got your

470
00:20:59,370 --> 00:21:03,300
arbitration ID which is your message

471
00:21:01,020 --> 00:21:06,690
number and then you've got hash and then

472
00:21:03,300 --> 00:21:09,210
you've got your 8 bytes of data if

473
00:21:06,690 --> 00:21:11,700
you're using s open through a serial

474
00:21:09,210 --> 00:21:14,420
port you've got the T which means a

475
00:21:11,700 --> 00:21:17,760
normal message an uppercase T means a

476
00:21:14,420 --> 00:21:19,770
extended message you don't have an

477
00:21:17,760 --> 00:21:22,770
arbitration ID which is three characters

478
00:21:19,770 --> 00:21:25,200
in hex if you put it through his decimal

479
00:21:22,770 --> 00:21:28,410
you'll get the wrong wrong answer you

480
00:21:25,200 --> 00:21:31,080
then have the elude message length here

481
00:21:28,410 --> 00:21:35,990
and then you have your data which is

482
00:21:31,080 --> 00:21:35,990
eight bytes or sixteen characters of hex

483
00:21:36,080 --> 00:21:48,210
so on here on here the speed is byte

484
00:21:46,200 --> 00:21:48,870
byte number two because they always

485
00:21:48,210 --> 00:21:53,000
start from zero

486
00:21:48,870 --> 00:21:57,540
geez Brett can't read byte number zero

487
00:21:53,000 --> 00:22:00,300
because again it stops from zero now I

488
00:21:57,540 --> 00:22:01,860
will go on to show you at the front here

489
00:22:00,300 --> 00:22:06,149
if you can see it there is my car in the

490
00:22:01,860 --> 00:22:09,629
box this is most of the electronics out

491
00:22:06,150 --> 00:22:11,460
of the Peugeot 208 in front of you are

492
00:22:09,630 --> 00:22:12,150
clusters most of them are clusters from

493
00:22:11,460 --> 00:22:15,900
a potahto

494
00:22:12,150 --> 00:22:17,880
which is the same as them the odd ones

495
00:22:15,900 --> 00:22:21,000
at the end the one at the front is a

496
00:22:17,880 --> 00:22:23,190
Citroen c4 the one behind is a Citroen

497
00:22:21,000 --> 00:22:26,490
c3 our ds3 and the one at the back is a

498
00:22:23,190 --> 00:22:28,620
Peugeot 207 if you want to have a play

499
00:22:26,490 --> 00:22:30,780
with the cluster the older is the

500
00:22:28,620 --> 00:22:33,060
cheaper is but the Peugeot 207 one was I

501
00:22:30,780 --> 00:22:36,960
think 13 pound if you just want to have

502
00:22:33,060 --> 00:22:40,879
a play fuzzier own cluster the toy ones

503
00:22:36,960 --> 00:22:43,290
are about 30 quid each if you get the

504
00:22:40,880 --> 00:22:46,680
boring one without the little matrix

505
00:22:43,290 --> 00:22:48,090
display in the middle you can get little

506
00:22:46,680 --> 00:22:49,610
matrix display in the middle which shows

507
00:22:48,090 --> 00:22:52,230
you your sat-nav directions and things

508
00:22:49,610 --> 00:22:53,790
they're not even we start about 80 quid

509
00:22:52,230 --> 00:22:57,060
because they're very very rare to get

510
00:22:53,790 --> 00:22:59,670
hold of but my car in the Box has got

511
00:22:57,060 --> 00:23:01,560
all the electronics from there it is

512
00:22:59,670 --> 00:23:03,660
more or less a functioning car at the

513
00:23:01,560 --> 00:23:05,370
moment the wheel speed sensors don't

514
00:23:03,660 --> 00:23:09,000
work because I broke the thing that

515
00:23:05,370 --> 00:23:13,530
simulates it because I need to do some

516
00:23:09,000 --> 00:23:16,740
work on it but I do have some simulators

517
00:23:13,530 --> 00:23:18,680
on there simulating the engine so that

518
00:23:16,740 --> 00:23:21,990
it thinks the crank is working

519
00:23:18,680 --> 00:23:24,540
simulating the o2 sensor so it thinks

520
00:23:21,990 --> 00:23:26,370
the o2 sensors working there's some very

521
00:23:24,540 --> 00:23:29,310
big resistors that get very very hot

522
00:23:26,370 --> 00:23:31,649
simulating these Oh two sensor heater

523
00:23:29,310 --> 00:23:32,970
circuit if you're gonna go anywhere near

524
00:23:31,650 --> 00:23:35,190
it please don't touch those big

525
00:23:32,970 --> 00:23:38,970
resistors they get hot you will get

526
00:23:35,190 --> 00:23:40,110
burnt you have been warned last time I

527
00:23:38,970 --> 00:23:42,120
said that someone they went around

528
00:23:40,110 --> 00:23:45,899
touched it went oh that's hot it's like

529
00:23:42,120 --> 00:23:48,260
I told you you idiot so the corner box

530
00:23:45,900 --> 00:23:51,000
actually has four different canvases

531
00:23:48,260 --> 00:23:52,410
looking at the screen here on the left

532
00:23:51,000 --> 00:23:54,990
hand side you've got your normal obd2

533
00:23:52,410 --> 00:23:57,330
port at the bottom you've got the body

534
00:23:54,990 --> 00:23:59,400
control module which is the bit in the

535
00:23:57,330 --> 00:23:59,970
middle which is normally a big sort of

536
00:23:59,400 --> 00:24:02,250
fuse box

537
00:23:59,970 --> 00:24:04,140
you've got your main fuse box under the

538
00:24:02,250 --> 00:24:07,410
dash on under the bonnet which also has

539
00:24:04,140 --> 00:24:08,970
an ECU in it of some description for you

540
00:24:07,410 --> 00:24:12,150
lights and stuff and then you've got

541
00:24:08,970 --> 00:24:14,010
your ABS ESP the power steering and your

542
00:24:12,150 --> 00:24:16,920
engine ECU there on one bus which is a

543
00:24:14,010 --> 00:24:19,260
high-speed bus at 500 kilobits you think

544
00:24:16,920 --> 00:24:21,300
got two loads of speed buses you got the

545
00:24:19,260 --> 00:24:22,590
yellow and green one which is your

546
00:24:21,300 --> 00:24:24,418
steering controls which do your

547
00:24:22,590 --> 00:24:26,549
indicators and things

548
00:24:24,419 --> 00:24:28,200
your airbag ECU which is not in the

549
00:24:26,549 --> 00:24:30,029
vehicle because I don't want to fill the

550
00:24:28,200 --> 00:24:33,179
form in when some fuzz is it makes an

551
00:24:30,029 --> 00:24:34,619
airbag go off and gets a big explosion

552
00:24:33,179 --> 00:24:37,349
in their face and a lot of powder

553
00:24:34,619 --> 00:24:39,539
everywhere makes a mess there is some

554
00:24:37,349 --> 00:24:41,789
extra obd2 ports on the back of the car

555
00:24:39,539 --> 00:24:44,759
in a box so you can play with those

556
00:24:41,789 --> 00:24:46,919
buses themself if you get finished with

557
00:24:44,759 --> 00:24:51,929
fuzzing the ones you desk and come never

558
00:24:46,919 --> 00:24:53,759
play the blue can box on here is your

559
00:24:51,929 --> 00:24:56,309
instrument cluster the matrix within the

560
00:24:53,759 --> 00:24:58,950
instrument cluster the head unit the

561
00:24:56,309 --> 00:25:00,658
extra obd2 port and there is one final

562
00:24:58,950 --> 00:25:03,629
canvas that goes between the head unit

563
00:25:00,659 --> 00:25:06,289
and the screen for the head units and I

564
00:25:03,629 --> 00:25:09,509
believe that's used for the touchscreen

565
00:25:06,289 --> 00:25:11,789
but I wouldn't have done that personally

566
00:25:09,509 --> 00:25:14,639
I'd used to use SPI or something but as

567
00:25:11,789 --> 00:25:16,169
it's a car you might as well use can but

568
00:25:14,639 --> 00:25:41,580
I will show you everything actually

569
00:25:16,169 --> 00:25:43,200
works so it does disco mode so one of

570
00:25:41,580 --> 00:25:45,269
the crew members downstairs actually has

571
00:25:43,200 --> 00:25:47,039
a Peugeot 208 and he said I could play

572
00:25:45,269 --> 00:25:50,309
with his car as long as I guaranteed I

573
00:25:47,039 --> 00:25:53,908
didn't break his car I can't guarantee

574
00:25:50,309 --> 00:25:55,379
you that so you won't let me so wouldn't

575
00:25:53,909 --> 00:25:56,729
it be fun to have it so that if it got

576
00:25:55,379 --> 00:25:58,408
to a certain speed your car just went

577
00:25:56,729 --> 00:26:03,239
mental and started flashing its lights

578
00:25:58,409 --> 00:26:05,960
everywhere I have another one here which

579
00:26:03,239 --> 00:26:09,690
is slightly harder to play with but and

580
00:26:05,960 --> 00:26:10,469
I think it's might break when it gets to

581
00:26:09,690 --> 00:26:12,389
50 mile an hour

582
00:26:10,469 --> 00:26:15,179
it makes your dashboard go absolutely

583
00:26:12,389 --> 00:26:17,279
mental so all the lights flashes if

584
00:26:15,179 --> 00:26:20,070
there's major alarms going on if you

585
00:26:17,279 --> 00:26:21,690
stop the vehicle it turns off doesn't

586
00:26:20,070 --> 00:26:24,418
show up anywhere so unless you know

587
00:26:21,690 --> 00:26:25,469
where it is you you basically have no

588
00:26:24,419 --> 00:26:27,659
knowledge of this thing

589
00:26:25,469 --> 00:26:30,389
so if you wanted to play a prank on a

590
00:26:27,659 --> 00:26:31,830
mate of yours or their keys at lunchtime

591
00:26:30,389 --> 00:26:33,748
go and put it around the buffer

592
00:26:31,830 --> 00:26:35,970
dashboard give them the keys back

593
00:26:33,749 --> 00:26:36,930
without letting them know they drive

594
00:26:35,970 --> 00:26:40,470
home that night

595
00:26:36,930 --> 00:26:42,600
get to 50 mile-an-hour oops you could

596
00:26:40,470 --> 00:26:44,910
probably do it through the obd2 port I

597
00:26:42,600 --> 00:26:47,620
haven't had time to actually sit down

598
00:26:44,910 --> 00:26:48,980
with it to work out how to do it

599
00:26:47,620 --> 00:26:52,530
[Music]

600
00:26:48,980 --> 00:26:55,110
if anyone can see you got the rev count

601
00:26:52,530 --> 00:26:58,740
on the left-hand side it's currently off

602
00:26:55,110 --> 00:27:02,490
because the car is off if I crank it it

603
00:26:58,740 --> 00:27:04,170
will jump up to 650 revs which is your

604
00:27:02,490 --> 00:27:07,470
default idle position and now it's doing

605
00:27:04,170 --> 00:27:11,010
about 2,000 revs and it beeps a lot but

606
00:27:07,470 --> 00:27:14,100
if I play with this little dial here you

607
00:27:11,010 --> 00:27:17,129
should see the rev counter now it's now

608
00:27:14,100 --> 00:27:18,719
doing 7,000 revs if I may actually

609
00:27:17,130 --> 00:27:20,940
squirt the right messages I can make it

610
00:27:18,720 --> 00:27:21,560
make it look like it's doing 158 mile an

611
00:27:20,940 --> 00:27:23,760
hour

612
00:27:21,560 --> 00:27:26,460
there's no way aperture to the right

613
00:27:23,760 --> 00:27:29,040
will do 158 my IR it will shake itself

614
00:27:26,460 --> 00:27:31,470
the pits first but if I don't want to

615
00:27:29,040 --> 00:27:34,050
have a play compressing buttons there's

616
00:27:31,470 --> 00:27:35,220
the washer button which was originally

617
00:27:34,050 --> 00:27:37,830
going to have a bottle of whiskey

618
00:27:35,220 --> 00:27:40,050
attached to it so that if you could get

619
00:27:37,830 --> 00:27:43,710
it to spit the whiskey out without using

620
00:27:40,050 --> 00:27:45,780
the switch you got to drink it problem

621
00:27:43,710 --> 00:27:47,910
is alcohol and cars are sort of frowned

622
00:27:45,780 --> 00:27:50,399
on and every time you press the button

623
00:27:47,910 --> 00:27:52,740
it is about half a liter so it would get

624
00:27:50,400 --> 00:27:56,150
expensive for me and very drunk messy

625
00:27:52,740 --> 00:28:00,600
for you so I had to can that my dear but

626
00:27:56,150 --> 00:28:06,780
in order to have a play have a play let

627
00:28:00,600 --> 00:28:09,990
me go back to the lectin so this is it

628
00:28:06,780 --> 00:28:13,350
in carrier mode it folds away into the

629
00:28:09,990 --> 00:28:15,540
two types of boxes this is in my car

630
00:28:13,350 --> 00:28:19,740
takes up all the boot it's been there

631
00:28:15,540 --> 00:28:20,909
for the last three months and it'll be

632
00:28:19,740 --> 00:28:23,040
there for the next three weeks at least

633
00:28:20,910 --> 00:28:25,740
because I've got a conference in two

634
00:28:23,040 --> 00:28:27,600
weeks time and I've got besides Wales so

635
00:28:25,740 --> 00:28:29,550
you've got the smaller box which is the

636
00:28:27,600 --> 00:28:31,949
head unit in a box that will work on its

637
00:28:29,550 --> 00:28:33,210
own because there's a little Arduino in

638
00:28:31,950 --> 00:28:35,430
the bottom left hand corner in the

639
00:28:33,210 --> 00:28:37,080
little blue box that forges the 5

640
00:28:35,430 --> 00:28:40,080
correct messages to make it think that

641
00:28:37,080 --> 00:28:41,820
it's in a car that was fun when I went

642
00:28:40,080 --> 00:28:43,020
to buy it from the scrapyard it's like

643
00:28:41,820 --> 00:28:43,439
excuse me can I have the wires that go

644
00:28:43,020 --> 00:28:44,700
with it

645
00:28:43,440 --> 00:28:47,310
and the bloke went you've got the eyes

646
00:28:44,700 --> 00:28:49,380
in the car you've got and I went no I

647
00:28:47,310 --> 00:28:50,470
haven't I'm putting it in my kit car so

648
00:28:49,380 --> 00:28:52,480
show you numb hitch my kit

649
00:28:50,470 --> 00:28:54,210
anyway now I'll never work it'll never

650
00:28:52,480 --> 00:28:58,120
work you'll never get it working

651
00:28:54,210 --> 00:28:59,679
challenge accepted I had to buy half the

652
00:28:58,120 --> 00:29:02,080
car to actually work out what those five

653
00:28:59,679 --> 00:29:03,580
bloody messages were to then work out

654
00:29:02,080 --> 00:29:05,710
how to get it working but it will now

655
00:29:03,580 --> 00:29:07,928
work as an operational head unit without

656
00:29:05,710 --> 00:29:10,090
the rest of the vehicle you can still do

657
00:29:07,929 --> 00:29:13,090
the tack over the personal area network

658
00:29:10,090 --> 00:29:15,100
by tethering it's here phone and then

659
00:29:13,090 --> 00:29:17,320
tell anything back across and you can

660
00:29:15,100 --> 00:29:19,149
play around with a file system if you

661
00:29:17,320 --> 00:29:20,918
want to do it be my guest

662
00:29:19,150 --> 00:29:22,900
just don't delete any of your files

663
00:29:20,919 --> 00:29:26,280
because I don't have access to it if you

664
00:29:22,900 --> 00:29:29,799
break it there's no way to put it back

665
00:29:26,280 --> 00:29:32,139
this is what it looks like when it's set

666
00:29:29,799 --> 00:29:37,210
up you've got it in the real down the

667
00:29:32,140 --> 00:29:38,950
bottom there finally thank yous the grim

668
00:29:37,210 --> 00:29:40,360
cyber team for their inspiration in the

669
00:29:38,950 --> 00:29:44,350
first place car hacking village in

670
00:29:40,360 --> 00:29:46,209
America Steve Lord 44 crew and Cooper

671
00:29:44,350 --> 00:29:48,340
and everyone for being here letting me

672
00:29:46,210 --> 00:29:51,730
be here and if you love turning up but

673
00:29:48,340 --> 00:29:55,689
now on to the the fun stuff which is the

674
00:29:51,730 --> 00:30:07,780
causing and stuff so have you all got

675
00:29:55,690 --> 00:30:09,100
the stuff plugged into your laptop so if

676
00:30:07,780 --> 00:30:10,809
you get a serial port running you should

677
00:30:09,100 --> 00:30:13,289
get some output like this if you press H

678
00:30:10,809 --> 00:30:13,289
for help

679
00:30:13,590 --> 00:30:19,750
it will then you then have to set up the

680
00:30:17,320 --> 00:30:24,490
serial ports the SOP and speed by doing

681
00:30:19,750 --> 00:30:29,490
capo s4 and Inter L gives you a carriage

682
00:30:24,490 --> 00:30:29,490
return and then oh can actually start

683
00:30:29,580 --> 00:30:36,600
spewing data which you should be doing

684
00:30:32,260 --> 00:30:39,250
but it's gone to sleep so if I undo that

685
00:30:36,600 --> 00:30:42,370
so if you now watch as it Scrolls past

686
00:30:39,250 --> 00:30:46,450
you've got T two one seven eight and

687
00:30:42,370 --> 00:30:48,549
then I number two one seven is actually

688
00:30:46,450 --> 00:30:51,100
the message that it sends out to the

689
00:30:48,549 --> 00:30:54,460
little sub cluster so tell it what the

690
00:30:51,100 --> 00:30:58,230
speed is so what are you doing this if

691
00:30:54,460 --> 00:30:58,230
you watch the front here

692
00:30:58,679 --> 00:31:17,049
six eight seven zero zero one e and

693
00:31:11,039 --> 00:31:19,239
hopefully when I hit enter the roof

694
00:31:17,049 --> 00:31:21,039
count was doing 50 mile-an-hour and the

695
00:31:19,239 --> 00:31:26,079
note the speedos doing 50 mile on the

696
00:31:21,039 --> 00:31:28,179
roof count that was doing 4000rpm so it

697
00:31:26,079 --> 00:31:31,479
should swing across if you sit in the

698
00:31:28,179 --> 00:31:32,709
right text if you play with that text

699
00:31:31,479 --> 00:31:39,729
you will make it go to different values

700
00:31:32,709 --> 00:31:47,679
and so instead of 7f if I do knowing if

701
00:31:39,729 --> 00:31:48,940
I went up to just over 5000 rpm on the

702
00:31:47,679 --> 00:31:52,389
left hand side and it was still doing

703
00:31:48,940 --> 00:31:55,329
50-mile now on the other side but you

704
00:31:52,389 --> 00:31:57,549
can send whatever you want on the Python

705
00:31:55,329 --> 00:32:03,969
script it makes it go into stupid disco

706
00:31:57,549 --> 00:32:06,969
mode and I need to start up my VM so if

707
00:32:03,969 --> 00:32:08,589
you show you that one because I don't

708
00:32:06,969 --> 00:32:27,549
have Python in Windows because it's just

709
00:32:08,589 --> 00:32:29,168
a pain just longhand serial port don't

710
00:32:27,549 --> 00:32:39,190
try and use SL can because it just

711
00:32:29,169 --> 00:32:41,259
doesn't work 99% of the time so Python

712
00:32:39,190 --> 00:32:42,869
on here on my machine mute actually need

713
00:32:41,259 --> 00:32:48,839
to be sued okay so you get it working

714
00:32:42,869 --> 00:32:48,839
which can be a pain but

715
00:32:49,230 --> 00:32:52,289
[Music]

716
00:32:53,830 --> 00:33:08,678
so if you look through the script it

717
00:33:04,480 --> 00:33:10,029
puzzled Jude and is everyone

718
00:33:08,679 --> 00:33:12,970
successfully playing around with the

719
00:33:10,029 --> 00:33:14,590
clusters everything working if you want

720
00:33:12,970 --> 00:33:23,049
some other message IDs to play around

721
00:33:14,590 --> 00:33:25,749
with Oh b6 o f6 128 217 and I think 218

722
00:33:23,049 --> 00:33:27,070
will do other things I could leave you

723
00:33:25,749 --> 00:33:30,070
to find him yourself but you'll be there

724
00:33:27,070 --> 00:33:37,629
all day because it takes an Obi Obi

725
00:33:30,070 --> 00:33:40,450
takes o f6 207 to 1 827 I think also do

726
00:33:37,629 --> 00:33:42,580
something one of them makes it new disco

727
00:33:40,450 --> 00:33:44,350
mode so all the warning lights go on or

728
00:33:42,580 --> 00:33:47,019
off depending which bit you actually

729
00:33:44,350 --> 00:33:50,199
play with if you want a way of fuzzing a

730
00:33:47,019 --> 00:33:52,359
cluster very easily go through the 64

731
00:33:50,200 --> 00:33:58,450
bit space by going through every bit so

732
00:33:52,359 --> 00:34:00,178
go 1 2 4 8 16 32 64 128 - 5 6 all the

733
00:33:58,450 --> 00:34:03,039
way up to 2 ^ 63

734
00:34:00,179 --> 00:34:04,899
you'll be there forever if you try and

735
00:34:03,039 --> 00:34:08,319
walk every combination of two to power

736
00:34:04,899 --> 00:34:11,710
64 because 2 to the power of 32 is 4.2

737
00:34:08,319 --> 00:34:15,099
billion I can't remember what ^ 64 is

738
00:34:11,710 --> 00:34:19,389
but it's a bloody big number and bear in

739
00:34:15,099 --> 00:34:23,230
mind you have to do that 2048 times you

740
00:34:19,389 --> 00:34:25,359
peer a week or possibly even further if

741
00:34:23,230 --> 00:34:28,059
anyone hasn't got one a little PCBs and

742
00:34:25,359 --> 00:34:29,859
once one give me a shout you can make

743
00:34:28,059 --> 00:34:32,349
your own little cannibal I can adapter

744
00:34:29,859 --> 00:34:35,440
with it it's the same hardware that's on

745
00:34:32,349 --> 00:34:37,419
the back of the cluster but as opposed

746
00:34:35,440 --> 00:34:39,730
to it's on the back of clusters on one

747
00:34:37,418 --> 00:34:42,219
side this is on both sides so just give

748
00:34:39,730 --> 00:34:44,260
me a shout wave I won't charge you for

749
00:34:42,219 --> 00:34:47,500
it you can make a can adaptor for lesson

750
00:34:44,260 --> 00:34:50,770
5 pounds so you can have a play yourself

751
00:34:47,500 --> 00:34:53,969
at home later don't break your own car

752
00:34:50,770 --> 00:34:57,640
and if you do you didn't blame me

753
00:34:53,969 --> 00:34:59,890
it's about 5 past 12 now it's probably

754
00:34:57,640 --> 00:35:01,868
about time to pack up if we can please

755
00:34:59,890 --> 00:35:02,930
can you leave the cables and the

756
00:35:01,869 --> 00:35:06,079
clusters and things on

757
00:35:02,930 --> 00:35:06,669
desk and I will pack mores and she's

758
00:35:06,079 --> 00:35:08,990
gone

759
00:35:06,670 --> 00:35:11,930
any questions feel free to get in

760
00:35:08,990 --> 00:35:14,410
contact me offline through my Twitter or

761
00:35:11,930 --> 00:35:16,940
through my email address or my website

762
00:35:14,410 --> 00:35:19,848
if you want one of these

763
00:35:16,940 --> 00:35:24,559
PCBs let me know I still have some left

764
00:35:19,849 --> 00:35:26,900
I will do I will put them on my website

765
00:35:24,559 --> 00:35:28,940
within the next week it will take me a

766
00:35:26,900 --> 00:35:33,890
couple of days to do it there will be in

767
00:35:28,940 --> 00:35:37,069
PDF format probably but everything that

768
00:35:33,890 --> 00:35:39,308
is used in on my get up anyway so it's

769
00:35:37,069 --> 00:35:39,308
there

