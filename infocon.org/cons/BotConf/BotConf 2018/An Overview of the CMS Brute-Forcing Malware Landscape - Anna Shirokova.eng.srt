1
00:00:00,230 --> 00:00:10,110
there you go the floor is yours alright

2
00:00:04,339 --> 00:00:13,980
hello everybody thank you for coming I

3
00:00:10,110 --> 00:00:17,609
hope you guys more energized that's for

4
00:00:13,980 --> 00:00:20,789
the coffee break I'm very excited to be

5
00:00:17,609 --> 00:00:23,279
here today I've been watching vodka

6
00:00:20,789 --> 00:00:25,500
videos for quite a while already and if

7
00:00:23,279 --> 00:00:27,779
a year ago someone told me that I'm

8
00:00:25,500 --> 00:00:30,599
going to be here as a speaker I would

9
00:00:27,779 --> 00:00:35,519
never believe it so but I'm here and my

10
00:00:30,599 --> 00:00:37,739
talk has quite a long name but in the

11
00:00:35,520 --> 00:00:41,010
night nutshell I'm going to speak about

12
00:00:37,739 --> 00:00:44,339
malware which is capable to launch

13
00:00:41,010 --> 00:00:48,000
brute-forcing attacks against content

14
00:00:44,340 --> 00:00:51,360
management systems so let me introduce

15
00:00:48,000 --> 00:00:55,620
myself and people who were doing this

16
00:00:51,360 --> 00:00:58,379
research my name is Anna and my

17
00:00:55,620 --> 00:01:01,800
colleague and co-author of this research

18
00:00:58,379 --> 00:01:05,099
Veronica Valero's we are both threat

19
00:01:01,800 --> 00:01:08,450
researchers from CT a cognitive threat

20
00:01:05,099 --> 00:01:11,250
analytics this is the group within Cisco

21
00:01:08,450 --> 00:01:15,299
which is applying machine learning

22
00:01:11,250 --> 00:01:19,020
algorithms to in order to find malicious

23
00:01:15,299 --> 00:01:24,270
activities and anomalies on the network

24
00:01:19,020 --> 00:01:27,509
so me and Veronica are basically looking

25
00:01:24,270 --> 00:01:31,020
at the output of the traffic the network

26
00:01:27,509 --> 00:01:34,520
traffic and classify malware and study

27
00:01:31,020 --> 00:01:38,490
malware as well I would like to thank

28
00:01:34,520 --> 00:01:42,479
also sebastian garcia and stratosphere

29
00:01:38,490 --> 00:01:45,140
IPS project for providing data sets for

30
00:01:42,479 --> 00:01:51,390
the malware we're going to discuss today

31
00:01:45,140 --> 00:01:53,880
so let's define the scope I divided the

32
00:01:51,390 --> 00:01:57,479
presentation into two parts the first

33
00:01:53,880 --> 00:01:59,939
part is going to be the overview of

34
00:01:57,479 --> 00:02:02,100
brute-forcing malware this is essential

35
00:01:59,939 --> 00:02:05,250
to understand the scale of the problem

36
00:02:02,100 --> 00:02:07,890
and the second part is going to be a

37
00:02:05,250 --> 00:02:11,940
deep dive on the Trojan and botnet

38
00:02:07,890 --> 00:02:13,680
called satyr bots today we're not going

39
00:02:11,940 --> 00:02:16,530
to talk about reverse

40
00:02:13,680 --> 00:02:19,079
we did not reverse the binaries there

41
00:02:16,530 --> 00:02:21,180
are two things why not first it was

42
00:02:19,079 --> 00:02:23,250
already done by other researchers so we

43
00:02:21,180 --> 00:02:26,670
didn't want to reinvent the wheel let's

44
00:02:23,250 --> 00:02:28,590
say and second this is kind of out of

45
00:02:26,670 --> 00:02:31,230
scope for us because we are studying

46
00:02:28,590 --> 00:02:34,349
malware behavior on the network so we

47
00:02:31,230 --> 00:02:39,018
were mostly curious how malware behaves

48
00:02:34,349 --> 00:02:41,879
in the long term running in a sandbox

49
00:02:39,019 --> 00:02:44,760
we're also a little bit narrow down the

50
00:02:41,879 --> 00:02:48,388
scope on focusing mostly on WordPress

51
00:02:44,760 --> 00:02:50,849
sites because this is the most popular

52
00:02:48,389 --> 00:02:53,220
content management system out there it's

53
00:02:50,849 --> 00:02:56,760
like more than 18 million sites built

54
00:02:53,220 --> 00:02:59,819
with WordPress and also the Bodnar that

55
00:02:56,760 --> 00:03:01,679
we were studying we observe the lead was

56
00:02:59,819 --> 00:03:04,108
brute-forcing wordpress sites so that

57
00:03:01,680 --> 00:03:07,340
was our goal so brute-forcing is

58
00:03:04,109 --> 00:03:11,340
basically they attack which is trying to

59
00:03:07,340 --> 00:03:14,370
break the authentication system and the

60
00:03:11,340 --> 00:03:18,030
wordpress authentication system is work

61
00:03:14,370 --> 00:03:23,370
based form based I'm sorry so you need

62
00:03:18,030 --> 00:03:26,010
to put the username and password so in

63
00:03:23,370 --> 00:03:28,650
order to login there is another way how

64
00:03:26,010 --> 00:03:33,590
you can authenticate yourself by using

65
00:03:28,650 --> 00:03:38,359
the XML remote procedure call where the

66
00:03:33,590 --> 00:03:41,280
XML data transferred over the HTTP and

67
00:03:38,359 --> 00:03:44,010
this feature is implemented in a

68
00:03:41,280 --> 00:03:46,620
WordPress by default it's not primarily

69
00:03:44,010 --> 00:03:49,649
useful authentication but it requires

70
00:03:46,620 --> 00:03:52,169
username and password so as I said

71
00:03:49,650 --> 00:03:55,739
brute-forcing is trying to break in the

72
00:03:52,169 --> 00:03:58,319
authentication method and with this we

73
00:03:55,739 --> 00:04:01,709
divided brute-forcing and tags into two

74
00:03:58,319 --> 00:04:04,530
parts the first part is vertical

75
00:04:01,709 --> 00:04:09,659
brute-force attack where the one

76
00:04:04,530 --> 00:04:12,269
infected host is using dictionary like

77
00:04:09,659 --> 00:04:15,599
list of passwords and it's trying them

78
00:04:12,269 --> 00:04:18,149
all against one website and the

79
00:04:15,599 --> 00:04:21,930
horizontal brute force attack is where

80
00:04:18,149 --> 00:04:24,359
the infected host has let's say list of

81
00:04:21,930 --> 00:04:26,460
sites for brute forcing and has only one

82
00:04:24,360 --> 00:04:27,240
password so it goes and try this

83
00:04:26,460 --> 00:04:31,849
password

84
00:04:27,240 --> 00:04:34,710
to all of the sites only once so to

85
00:04:31,849 --> 00:04:37,740
understand the problem I'd like to

86
00:04:34,710 --> 00:04:40,198
introduce you the overview of brute

87
00:04:37,740 --> 00:04:44,310
force in malware and I'd like to start

88
00:04:40,199 --> 00:04:46,759
with the year 2009 this is the first

89
00:04:44,310 --> 00:04:49,530
record that we were able to find

90
00:04:46,759 --> 00:04:54,270
regarding the distributed brute forcing

91
00:04:49,530 --> 00:04:56,818
attacks it was reported on the sands

92
00:04:54,270 --> 00:04:59,880
blog post the personal experience of the

93
00:04:56,819 --> 00:05:02,789
user who obtained the small PHP script

94
00:04:59,880 --> 00:05:07,380
which was taking three parameters like

95
00:05:02,789 --> 00:05:09,449
curl to perform HTTP HTTP requests then

96
00:05:07,380 --> 00:05:11,969
the parameter for passwords and the

97
00:05:09,449 --> 00:05:15,780
third four sides and launched the brute

98
00:05:11,970 --> 00:05:19,800
forcing I need to remind you that the

99
00:05:15,780 --> 00:05:22,289
WordPress was created in 2003 and I'm

100
00:05:19,800 --> 00:05:27,780
pretty sure there were attempts to brute

101
00:05:22,289 --> 00:05:30,509
force it but we were able to find the

102
00:05:27,780 --> 00:05:33,869
earliest record of the documentation of

103
00:05:30,509 --> 00:05:37,409
the attack in 2009 so if you guys have

104
00:05:33,870 --> 00:05:39,990
the earliest data please share that

105
00:05:37,409 --> 00:05:44,070
would be really nice the next year I'd

106
00:05:39,990 --> 00:05:47,669
like to Qatar is year 2012 and it

107
00:05:44,070 --> 00:05:51,650
brought us stands inca today guys from

108
00:05:47,669 --> 00:05:53,370
ESET is going to cover that in details

109
00:05:51,650 --> 00:05:58,620
we were curious

110
00:05:53,370 --> 00:06:02,250
Stingo was discovered in 2017 but was

111
00:05:58,620 --> 00:06:04,919
operated since 2012 we were curious in

112
00:06:02,250 --> 00:06:06,930
particular in the one of the plugin it

113
00:06:04,919 --> 00:06:09,000
was using it's a modular botnet and it

114
00:06:06,930 --> 00:06:12,030
uses the breed plug-in which is

115
00:06:09,000 --> 00:06:14,880
basically able to launch the

116
00:06:12,030 --> 00:06:18,780
distribution air attacks against Joomla

117
00:06:14,880 --> 00:06:22,979
and WordPress sites so the next year I

118
00:06:18,780 --> 00:06:29,638
brought us for disco also known as VP

119
00:06:22,979 --> 00:06:34,199
cracker and for disco was the campaign

120
00:06:29,639 --> 00:06:36,750
which got the great coverage in media it

121
00:06:34,199 --> 00:06:39,479
was reported it was like the first big

122
00:06:36,750 --> 00:06:41,069
attack that scale and there was

123
00:06:39,479 --> 00:06:45,839
targeting Windows machines

124
00:06:41,069 --> 00:06:47,669
and obtaining the list of passwords for

125
00:06:45,839 --> 00:06:51,210
brute-forcing from the common control

126
00:06:47,669 --> 00:06:53,969
and the username for brute-forcing were

127
00:06:51,210 --> 00:06:55,859
hard coded in binaries the other thing

128
00:06:53,969 --> 00:06:59,399
interesting about horodyski though is

129
00:06:55,860 --> 00:07:02,699
that sometimes it was delivering PHP

130
00:06:59,399 --> 00:07:05,599
backdoor called fireless men and that is

131
00:07:02,699 --> 00:07:08,430
the small redirector which was doing the

132
00:07:05,599 --> 00:07:10,649
scan on a background of the user agent

133
00:07:08,430 --> 00:07:12,449
and if the requirements met it was

134
00:07:10,649 --> 00:07:15,839
redirecting users to the sticks

135
00:07:12,449 --> 00:07:19,680
exploited also they hacked by for disk

136
00:07:15,839 --> 00:07:22,889
of wordpress sites when used by the

137
00:07:19,680 --> 00:07:25,860
black hole exploited which was reported

138
00:07:22,889 --> 00:07:28,229
by several other researchers and as well

139
00:07:25,860 --> 00:07:32,189
as the steel rod botnet which was using

140
00:07:28,229 --> 00:07:35,878
wordpress sites to deliver spam so this

141
00:07:32,189 --> 00:07:39,119
is all for this 2013 and the next year

142
00:07:35,879 --> 00:07:43,099
is 2014 which brought us my am the first

143
00:07:39,119 --> 00:07:45,870
this malware was repost reported by the

144
00:07:43,099 --> 00:07:49,339
security researchers operated under the

145
00:07:45,870 --> 00:07:53,059
handle malware must die and then the

146
00:07:49,339 --> 00:07:55,620
researchers from Yandex did a great

147
00:07:53,059 --> 00:08:00,059
research on them I am and they published

148
00:07:55,620 --> 00:08:04,879
a paper in Virus Bulletin so maíam is

149
00:08:00,059 --> 00:08:09,059
actually targeting Linux web servers and

150
00:08:04,879 --> 00:08:11,879
Miami had like around 6 plugin which all

151
00:08:09,059 --> 00:08:14,279
of them designed for brute-forcing from

152
00:08:11,879 --> 00:08:17,069
different services like from ftp

153
00:08:14,279 --> 00:08:20,189
services do the crawling and parsing and

154
00:08:17,069 --> 00:08:22,620
also perform brute forcing of wordpress

155
00:08:20,189 --> 00:08:24,870
sites it is also interesting that

156
00:08:22,620 --> 00:08:27,839
researchers mentioned in a paper that

157
00:08:24,870 --> 00:08:31,019
they found out that my am links with for

158
00:08:27,839 --> 00:08:34,588
disco the next year i'm going to cover

159
00:08:31,019 --> 00:08:37,620
is going to be 2015 and it brought us

160
00:08:34,589 --> 00:08:41,130
actually free interesting malware's

161
00:08:37,620 --> 00:08:45,000
the first is Astra and it was reported

162
00:08:41,130 --> 00:08:47,339
by the researcher from vivid security

163
00:08:45,000 --> 00:08:49,439
who was personally experienced the

164
00:08:47,339 --> 00:08:53,040
brute-forcing attack on his personal

165
00:08:49,439 --> 00:08:54,750
WordPress site he was he noticed that

166
00:08:53,040 --> 00:08:56,969
the whole IP addresses

167
00:08:54,750 --> 00:09:02,130
attacking his side actually belongs to

168
00:08:56,970 --> 00:09:04,980
devices and he devices of the Astra

169
00:09:02,130 --> 00:09:08,070
routers modems he started to investigate

170
00:09:04,980 --> 00:09:10,500
and he found out that all of them were

171
00:09:08,070 --> 00:09:13,710
having the default passwords which

172
00:09:10,500 --> 00:09:16,290
apparently was abused by some group of

173
00:09:13,710 --> 00:09:19,550
malicious actors and who launched some

174
00:09:16,290 --> 00:09:22,260
piece of malware which launched them the

175
00:09:19,550 --> 00:09:25,140
distributed brute-forcing attack against

176
00:09:22,260 --> 00:09:27,270
wordpress sites it is also interesting

177
00:09:25,140 --> 00:09:30,120
that at the same time Brian Krebs

178
00:09:27,270 --> 00:09:32,340
published the blog post about the

179
00:09:30,120 --> 00:09:36,660
leaders called hacking group which were

180
00:09:32,340 --> 00:09:39,270
using DDoS to to knock in offline lots

181
00:09:36,660 --> 00:09:41,910
of websites and it was the link between

182
00:09:39,270 --> 00:09:44,430
the actual devices and default passwords

183
00:09:41,910 --> 00:09:46,800
and leisure squat as well well

184
00:09:44,430 --> 00:09:50,010
unfortunately researchers did not pull

185
00:09:46,800 --> 00:09:53,010
published which malware was responsible

186
00:09:50,010 --> 00:09:54,210
for the brute forcing as well so we are

187
00:09:53,010 --> 00:09:56,730
not aware of that

188
00:09:54,210 --> 00:10:03,570
so the second malware which also

189
00:09:56,730 --> 00:10:05,730
appeared to be in 2015 was discovered by

190
00:10:03,570 --> 00:10:08,280
Veronica Valera's she was actually

191
00:10:05,730 --> 00:10:11,100
studying under meta and Gomera botnet

192
00:10:08,280 --> 00:10:13,860
she let it run in the sandbox for 30

193
00:10:11,100 --> 00:10:16,380
days and she found out that in like

194
00:10:13,860 --> 00:10:18,930
after 14 days the behavior of the

195
00:10:16,380 --> 00:10:20,820
malware changed the second payload was

196
00:10:18,930 --> 00:10:21,870
delivered and she called she named it as

197
00:10:20,820 --> 00:10:25,170
a CMS catcher

198
00:10:21,870 --> 00:10:29,040
she was actually presenting these on the

199
00:10:25,170 --> 00:10:31,050
board corn from 2015 so this new payload

200
00:10:29,040 --> 00:10:33,660
was responsible for the brute forcing

201
00:10:31,050 --> 00:10:37,349
the obtains the list of passwords from

202
00:10:33,660 --> 00:10:39,689
the bot master and it was launched the

203
00:10:37,350 --> 00:10:43,140
brute forcing attack with the default

204
00:10:39,690 --> 00:10:46,290
credentials admin admin and for the four

205
00:10:43,140 --> 00:10:50,910
days of observing the activity the board

206
00:10:46,290 --> 00:10:53,640
tried to begin in 200,000 sites which is

207
00:10:50,910 --> 00:10:57,240
pretty aggressive and the last more

208
00:10:53,640 --> 00:11:01,020
where that happened to be in 2015 is a

209
00:10:57,240 --> 00:11:04,800
ransomware trawl - after decrypting user

210
00:11:01,020 --> 00:11:05,980
users for the users files it didn't stop

211
00:11:04,800 --> 00:11:07,930
here it

212
00:11:05,980 --> 00:11:13,590
surely obtaining several other payloads

213
00:11:07,930 --> 00:11:16,660
and one of them was CMS Brut this is the

214
00:11:13,590 --> 00:11:18,820
malware which was contacting the it's

215
00:11:16,660 --> 00:11:21,520
common and control servers in the Tor

216
00:11:18,820 --> 00:11:24,400
network obtained a list of password and

217
00:11:21,520 --> 00:11:26,370
launched the brute forcing attack so

218
00:11:24,400 --> 00:11:30,510
this is all what I'm going to cover in

219
00:11:26,370 --> 00:11:33,250
2015 and the next and the last year is

220
00:11:30,510 --> 00:11:38,530
2016 which brought us to you interesting

221
00:11:33,250 --> 00:11:41,860
events first there was a discovery one

222
00:11:38,530 --> 00:11:45,329
unknown ISP provider which was

223
00:11:41,860 --> 00:11:50,380
responsible for 1.65 million

224
00:11:45,330 --> 00:11:53,230
brute-forcing attacks daily so this is

225
00:11:50,380 --> 00:11:56,140
actually the whole the the traffic that

226
00:11:53,230 --> 00:11:58,750
was coming from this is P is actually

227
00:11:56,140 --> 00:12:01,689
more than all route first traffic coming

228
00:11:58,750 --> 00:12:04,930
from the OVH go dairy and Rostelecom and

229
00:12:01,690 --> 00:12:06,970
at the same time researchers from world

230
00:12:04,930 --> 00:12:09,939
defense published the blog post about

231
00:12:06,970 --> 00:12:14,080
botnet called chicken Kiev which was

232
00:12:09,940 --> 00:12:18,100
using wordpress sites for delivering the

233
00:12:14,080 --> 00:12:21,760
malware and apparently the they linked

234
00:12:18,100 --> 00:12:23,470
this activity with the unknown ISP

235
00:12:21,760 --> 00:12:27,569
responsible for the lots of

236
00:12:23,470 --> 00:12:29,110
brute-forcing attacks so we can see that

237
00:12:27,570 --> 00:12:30,220
brute-forcing attacks are very

238
00:12:29,110 --> 00:12:32,440
straightforward

239
00:12:30,220 --> 00:12:34,240
they have only one goal to login to you

240
00:12:32,440 --> 00:12:38,290
know to get the valid credentials and

241
00:12:34,240 --> 00:12:42,550
that's it they are automated like as we

242
00:12:38,290 --> 00:12:45,400
can see in terms of the unknown IPS 1.65

243
00:12:42,550 --> 00:12:48,069
million attacks per day and it still

244
00:12:45,400 --> 00:12:50,860
works so the second part of my

245
00:12:48,070 --> 00:12:56,290
presentation is going to be about the

246
00:12:50,860 --> 00:12:59,530
satyr boat botnet I want to say a little

247
00:12:56,290 --> 00:13:02,860
bit about the set up how we launched

248
00:12:59,530 --> 00:13:08,560
like launched the botnet the binaries

249
00:13:02,860 --> 00:13:10,840
these we used simple VM and we let it

250
00:13:08,560 --> 00:13:14,469
sit in there they bought for four days

251
00:13:10,840 --> 00:13:17,410
until we actually got blocked and with

252
00:13:14,470 --> 00:13:19,480
no user interaction and we installed the

253
00:13:17,410 --> 00:13:23,079
BitTorrent client because other

254
00:13:19,480 --> 00:13:25,810
bought is not functional so Saturn

255
00:13:23,079 --> 00:13:31,138
bought is not something new actually it

256
00:13:25,810 --> 00:13:33,670
was discovered in 2013 and this is the

257
00:13:31,139 --> 00:13:35,470
basically post from the foreign world

258
00:13:33,670 --> 00:13:37,300
where the user is saying well my

259
00:13:35,470 --> 00:13:40,720
girlfriend download something from the

260
00:13:37,300 --> 00:13:44,079
torrent and she's infected and this is

261
00:13:40,720 --> 00:13:48,820
the detection this how these binaries

262
00:13:44,079 --> 00:13:51,339
were detected in 2003 but I have an

263
00:13:48,820 --> 00:13:54,399
access to the virus total intelligence

264
00:13:51,339 --> 00:13:58,420
and the same boat is actually detecting

265
00:13:54,399 --> 00:14:00,720
in 2017 as a starter boat satyr bot is a

266
00:13:58,420 --> 00:14:03,910
modular botnet it has four modules

267
00:14:00,720 --> 00:14:05,350
backdoor downloader web crawler and

268
00:14:03,910 --> 00:14:10,750
brute force err and we're going to

269
00:14:05,350 --> 00:14:13,829
mostly focus today on the last two the

270
00:14:10,750 --> 00:14:17,470
infection starts when the user is

271
00:14:13,829 --> 00:14:22,029
searching for pirate software or movies

272
00:14:17,470 --> 00:14:24,370
in search engines and he might ended up

273
00:14:22,029 --> 00:14:27,670
on the compromised sites hosting

274
00:14:24,370 --> 00:14:30,459
infected by a turbo torrent after the

275
00:14:27,670 --> 00:14:32,949
downloading the torrent file in case of

276
00:14:30,459 --> 00:14:35,829
the movie the fault that comes with the

277
00:14:32,949 --> 00:14:39,130
free files movie codec pack and text

278
00:14:35,829 --> 00:14:41,469
file and in a text file it said the

279
00:14:39,130 --> 00:14:44,589
instruction to run the codec pack in

280
00:14:41,470 --> 00:14:46,420
order to watch movie correctly and when

281
00:14:44,589 --> 00:14:50,260
the user run the codec pack

282
00:14:46,420 --> 00:14:52,870
thus a turbo DLL loaded and the error

283
00:14:50,260 --> 00:14:55,600
message popped up but at the same at

284
00:14:52,870 --> 00:14:57,790
that time the host become infected by

285
00:14:55,600 --> 00:15:00,940
the subtle board and becomes the part of

286
00:14:57,790 --> 00:15:03,279
the satyr both network after that the

287
00:15:00,940 --> 00:15:08,800
crawling starts it was reported before

288
00:15:03,279 --> 00:15:11,589
that both is using free search engines

289
00:15:08,800 --> 00:15:14,469
to find the list of sites it is

290
00:15:11,589 --> 00:15:17,649
performing this these free search

291
00:15:14,470 --> 00:15:20,430
engines are being Google and Yandex so

292
00:15:17,649 --> 00:15:24,100
what is using the combination of words

293
00:15:20,430 --> 00:15:26,349
to find the list of sites and then to

294
00:15:24,100 --> 00:15:29,780
try and route force them so this is the

295
00:15:26,350 --> 00:15:34,490
search how the search looks like in

296
00:15:29,780 --> 00:15:36,260
Bing and it's we were curious if all the

297
00:15:34,490 --> 00:15:38,360
search engines are having the same list

298
00:15:36,260 --> 00:15:41,330
of words being searched

299
00:15:38,360 --> 00:15:45,530
so we since the boat is communicating in

300
00:15:41,330 --> 00:15:49,580
HTTP we will just get all flows to these

301
00:15:45,530 --> 00:15:52,780
searches and extracting the words and we

302
00:15:49,580 --> 00:15:55,400
found out that in Bing and in Google

303
00:15:52,780 --> 00:15:58,040
both is searching pretty much the same

304
00:15:55,400 --> 00:16:01,630
list of words so for example the top

305
00:15:58,040 --> 00:16:07,490
five search words in being are the

306
00:16:01,630 --> 00:16:10,939
beauty then report data Google and in

307
00:16:07,490 --> 00:16:15,140
Google's Beauty data scheme report

308
00:16:10,940 --> 00:16:18,200
Google kind of same and Yandex

309
00:16:15,140 --> 00:16:20,600
apparently stands out and Yandex both is

310
00:16:18,200 --> 00:16:22,550
searching combination of letters so here

311
00:16:20,600 --> 00:16:25,370
is the small snippet the list is

312
00:16:22,550 --> 00:16:27,680
actually longer after the board acquires

313
00:16:25,370 --> 00:16:31,880
the list of password sorry and a list of

314
00:16:27,680 --> 00:16:33,319
sites it's try it tries them for the its

315
00:16:31,880 --> 00:16:37,850
check in the framework they're running

316
00:16:33,320 --> 00:16:40,460
so in our case we observed only that bot

317
00:16:37,850 --> 00:16:42,890
is checking if sites are running

318
00:16:40,460 --> 00:16:46,520
WordPress or not it is performing get

319
00:16:42,890 --> 00:16:49,040
request to this size and after the

320
00:16:46,520 --> 00:16:53,660
successful reside result found there

321
00:16:49,040 --> 00:16:56,870
brute-forcing starts it was reported

322
00:16:53,660 --> 00:17:00,910
before as well that the boat is at

323
00:16:56,870 --> 00:17:04,430
hacking sites using only one password

324
00:17:00,910 --> 00:17:08,270
and attacking them only once so one

325
00:17:04,430 --> 00:17:11,360
password trying to brute force ID only

326
00:17:08,270 --> 00:17:14,510
ones yes indeed we observe this behavior

327
00:17:11,359 --> 00:17:19,879
as well also the attack happens to be

328
00:17:14,510 --> 00:17:22,010
with the simple yet the post request to

329
00:17:19,880 --> 00:17:26,060
the admin panel where the bot is trying

330
00:17:22,010 --> 00:17:29,900
to log in and also it is using the XML

331
00:17:26,060 --> 00:17:32,210
RPC and specifically the col vp get user

332
00:17:29,900 --> 00:17:36,560
blogs so here in this example you can

333
00:17:32,210 --> 00:17:38,960
see there is the host name used as a

334
00:17:36,560 --> 00:17:40,310
domain name as a username and the

335
00:17:38,960 --> 00:17:43,370
password is magic

336
00:17:40,310 --> 00:17:47,450
so the bodies as was reported before

337
00:17:43,370 --> 00:17:50,510
using the only one password yes we saw

338
00:17:47,450 --> 00:17:53,300
it we call this we call this a standard

339
00:17:50,510 --> 00:17:55,790
credential combination so the main name

340
00:17:53,300 --> 00:17:56,000
is a username and one password yes I saw

341
00:17:55,790 --> 00:17:58,129
it

342
00:17:56,000 --> 00:18:01,220
but we also saw the non-standard

343
00:17:58,130 --> 00:18:05,900
credential combination used so in this

344
00:18:01,220 --> 00:18:08,990
case you can see that the name of the

345
00:18:05,900 --> 00:18:12,140
site is something something product a

346
00:18:08,990 --> 00:18:14,390
now something rule and the parameter

347
00:18:12,140 --> 00:18:16,940
that body is using as a username is

348
00:18:14,390 --> 00:18:19,250
different as well as the password change

349
00:18:16,940 --> 00:18:22,850
since this all examples are coming from

350
00:18:19,250 --> 00:18:26,360
the one data set which was like four

351
00:18:22,850 --> 00:18:29,179
days of capture it clearly we can see

352
00:18:26,360 --> 00:18:31,340
that the body's changing the passwords

353
00:18:29,180 --> 00:18:32,930
this example is in particular

354
00:18:31,340 --> 00:18:35,840
interesting because of two things

355
00:18:32,930 --> 00:18:37,940
I'm a native Russian speaker and Boudica

356
00:18:35,840 --> 00:18:41,629
now means what a key a No and the

357
00:18:37,940 --> 00:18:43,760
password is swimming and I'm not sure if

358
00:18:41,630 --> 00:18:45,230
there was some logic behind of it or

359
00:18:43,760 --> 00:18:48,320
it's just the coincidence

360
00:18:45,230 --> 00:18:50,780
and the second thing interesting about

361
00:18:48,320 --> 00:18:52,879
it is that the username that what is

362
00:18:50,780 --> 00:18:54,760
trying to login is actual a real

363
00:18:52,880 --> 00:19:00,170
username its

364
00:18:54,760 --> 00:19:04,060
we suspect that bot is using user name

365
00:19:00,170 --> 00:19:06,800
user in enumeration scan where the

366
00:19:04,060 --> 00:19:10,129
script is basically scanning by

367
00:19:06,800 --> 00:19:12,409
numerical user ID try to reveal real

368
00:19:10,130 --> 00:19:17,110
user names so this one is actually a

369
00:19:12,410 --> 00:19:20,330
real user name we also found out that

370
00:19:17,110 --> 00:19:23,060
both is trying to brute force one

371
00:19:20,330 --> 00:19:25,580
website more than one time so here is

372
00:19:23,060 --> 00:19:29,240
the Romanian side a 2 p.m. brute force

373
00:19:25,580 --> 00:19:31,550
with a password maketo and at 6 p.m. the

374
00:19:29,240 --> 00:19:34,960
same side good first for the password

375
00:19:31,550 --> 00:19:38,750
system we were curious if the bot is

376
00:19:34,960 --> 00:19:41,690
using some well-known password

377
00:19:38,750 --> 00:19:45,380
dictionary so we extracted all passwords

378
00:19:41,690 --> 00:19:47,630
from the from the capture and we kind of

379
00:19:45,380 --> 00:19:49,910
did the visualization and we thought

380
00:19:47,630 --> 00:19:51,030
that maybe the most tried once is going

381
00:19:49,910 --> 00:19:54,240
to be a

382
00:19:51,030 --> 00:19:56,670
mean we were hoping but even from these

383
00:19:54,240 --> 00:19:59,460
two visualization you can see that the

384
00:19:56,670 --> 00:20:03,090
most one try DiSpirito store Yamaha

385
00:19:59,460 --> 00:20:06,330
which is not I mean unfortunately so we

386
00:20:03,090 --> 00:20:09,530
decided to do the small breakdown of the

387
00:20:06,330 --> 00:20:13,800
passwords and here you can see the top

388
00:20:09,530 --> 00:20:16,050
tried passwords and indeed the pair

389
00:20:13,800 --> 00:20:18,510
cross was used around fifty thousand

390
00:20:16,050 --> 00:20:21,270
time in fact for the four days of

391
00:20:18,510 --> 00:20:25,080
capture we were able to extract more

392
00:20:21,270 --> 00:20:28,800
than 500 different passwords and they

393
00:20:25,080 --> 00:20:30,780
are not listed in any known dictionary

394
00:20:28,800 --> 00:20:32,970
what password dictionaries so we assumed

395
00:20:30,780 --> 00:20:36,960
that it was specifically crafted by

396
00:20:32,970 --> 00:20:38,550
attacker for this bot we also found out

397
00:20:36,960 --> 00:20:41,160
that the boat is actually trying to

398
00:20:38,550 --> 00:20:43,220
brute force everything so here is like

399
00:20:41,160 --> 00:20:47,760
we saw that it tries to brute-force

400
00:20:43,220 --> 00:20:50,760
Twitter and snapchat and gif he so it's

401
00:20:47,760 --> 00:20:53,850
it's very its brute forcing actually

402
00:20:50,760 --> 00:20:55,620
absolutely everything we were wondering

403
00:20:53,850 --> 00:20:58,800
maybe that the attack was targeting

404
00:20:55,620 --> 00:21:03,270
specific country we didn't back break

405
00:20:58,800 --> 00:21:05,790
down on the G oh geez and the attack is

406
00:21:03,270 --> 00:21:09,030
actually distributed it's not targeting

407
00:21:05,790 --> 00:21:12,600
any specific country the most targeted

408
00:21:09,030 --> 00:21:14,730
TLD is calm and it might the high number

409
00:21:12,600 --> 00:21:17,699
might explains that lots of users

410
00:21:14,730 --> 00:21:21,710
hosting their blogs on their

411
00:21:17,700 --> 00:21:23,970
wordpress.com so since the bot is

412
00:21:21,710 --> 00:21:26,040
basically brute forcing everything that

413
00:21:23,970 --> 00:21:28,020
my explains that number but the

414
00:21:26,040 --> 00:21:33,330
breakdown on the country T of these you

415
00:21:28,020 --> 00:21:40,980
can see that there is no attack against

416
00:21:33,330 --> 00:21:42,750
any specific country in here so when we

417
00:21:40,980 --> 00:21:46,500
started to look at the solder board we

418
00:21:42,750 --> 00:21:49,650
had around for IPS of the common control

419
00:21:46,500 --> 00:21:53,400
service we use Mantegna to visualize and

420
00:21:49,650 --> 00:21:55,620
potentially find other Intel and we

421
00:21:53,400 --> 00:21:58,710
ended up with that graph it's not even

422
00:21:55,620 --> 00:22:00,510
worth to show because it's so big and we

423
00:21:58,710 --> 00:22:03,180
also extracted some other useful

424
00:22:00,510 --> 00:22:04,470
information out there so for example we

425
00:22:03,180 --> 00:22:08,130
notice that the

426
00:22:04,470 --> 00:22:11,360
change the changes in the URL path here

427
00:22:08,130 --> 00:22:15,780
you can see this is the path from the

428
00:22:11,360 --> 00:22:19,309
URLs from the 2017 16 and 17 and the

429
00:22:15,780 --> 00:22:21,870
year 15 and 16 are pretty much the same

430
00:22:19,309 --> 00:22:25,230
except the the main name is different

431
00:22:21,870 --> 00:22:29,189
but in 2017 the path completely changed

432
00:22:25,230 --> 00:22:30,990
and the version became 3 we also found

433
00:22:29,190 --> 00:22:33,090
out that one of the common and control

434
00:22:30,990 --> 00:22:37,260
servers were linked to the email and in

435
00:22:33,090 --> 00:22:38,939
fact it's only one common in control

436
00:22:37,260 --> 00:22:42,539
server which were linked to email we

437
00:22:38,940 --> 00:22:44,909
didn't find any other information we

438
00:22:42,539 --> 00:22:47,010
were curious how often the bot is tried

439
00:22:44,909 --> 00:22:50,580
to connect to the C&C service as well

440
00:22:47,010 --> 00:22:52,700
and I did a little connection sequence

441
00:22:50,580 --> 00:22:57,059
for you so when you run this other board

442
00:22:52,700 --> 00:23:00,000
there are lots of BitTorrent the torrent

443
00:22:57,059 --> 00:23:03,240
traffic and the advertisement and then

444
00:23:00,000 --> 00:23:05,549
all connection that goes and the bot

445
00:23:03,240 --> 00:23:08,730
performs the connectivity check to

446
00:23:05,549 --> 00:23:12,418
Google and I right after it contacts the

447
00:23:08,730 --> 00:23:16,549
first CNC in fact it is sending get

448
00:23:12,419 --> 00:23:19,740
request to be C&C every two hours and

449
00:23:16,549 --> 00:23:22,379
supposed see a post request every 10

450
00:23:19,740 --> 00:23:24,900
seconds right after the crawling stars

451
00:23:22,380 --> 00:23:28,350
bought is searching combination of words

452
00:23:24,900 --> 00:23:31,770
in search engines and then contacts the

453
00:23:28,350 --> 00:23:36,299
second C&C the response come it comes in

454
00:23:31,770 --> 00:23:38,429
the DNS text record which is encoded so

455
00:23:36,299 --> 00:23:40,770
in fact we observed for the four days of

456
00:23:38,429 --> 00:23:45,210
capture or the connection like DNS

457
00:23:40,770 --> 00:23:47,700
request to this CNC only once and there

458
00:23:45,210 --> 00:23:50,340
are right after the first C&C contacted

459
00:23:47,700 --> 00:23:53,280
so we assumed that the text records

460
00:23:50,340 --> 00:23:55,590
which is encoded actually contains the

461
00:23:53,280 --> 00:23:59,789
location on the third common and control

462
00:23:55,590 --> 00:24:02,309
server the third CNC is heavily used for

463
00:23:59,789 --> 00:24:04,379
reporting only the bolt is sending only

464
00:24:02,309 --> 00:24:08,158
post requests to read every 16 minutes

465
00:24:04,380 --> 00:24:10,770
and then brute-forcing starts and then

466
00:24:08,159 --> 00:24:12,750
we also saw the 4 C&C which was

467
00:24:10,770 --> 00:24:15,899
conducted during the fourth days of

468
00:24:12,750 --> 00:24:18,210
capture only twice and both of the time

469
00:24:15,899 --> 00:24:23,070
time the delivers

470
00:24:18,210 --> 00:24:25,110
and I want to mention that the third and

471
00:24:23,070 --> 00:24:28,020
fourth CNC are sharing the same IP

472
00:24:25,110 --> 00:24:31,919
address so since we use a multi go we

473
00:24:28,020 --> 00:24:36,210
extracted all of the common in control

474
00:24:31,920 --> 00:24:39,120
service for all of these years and we

475
00:24:36,210 --> 00:24:42,300
noticed some pattern in there we break

476
00:24:39,120 --> 00:24:44,399
it down into groups so for example here

477
00:24:42,300 --> 00:24:47,070
you can see that the we actually called

478
00:24:44,400 --> 00:24:49,950
it lazy admin approach because you can

479
00:24:47,070 --> 00:24:53,010
clearly see that the this was an attempt

480
00:24:49,950 --> 00:24:55,710
to name the infrastructure somehow so

481
00:24:53,010 --> 00:25:00,860
for example in the fourth group there

482
00:24:55,710 --> 00:25:04,050
are these domains which are used for the

483
00:25:00,860 --> 00:25:07,320
which are hard-coded the second one is

484
00:25:04,050 --> 00:25:10,860
the ones which delivering encoded text

485
00:25:07,320 --> 00:25:13,080
record and basically contains the

486
00:25:10,860 --> 00:25:15,840
location of the third common in control

487
00:25:13,080 --> 00:25:17,639
the slave ones are those ones which used

488
00:25:15,840 --> 00:25:20,129
for the reporting with the boat sending

489
00:25:17,640 --> 00:25:21,720
on the post request to it and the bruins

490
00:25:20,130 --> 00:25:26,550
is just the ones which are connecting to

491
00:25:21,720 --> 00:25:29,250
the binary delivering or the torrent

492
00:25:26,550 --> 00:25:32,370
trackers we also we are able to obtain

493
00:25:29,250 --> 00:25:36,390
the rest of the domains they are not

494
00:25:32,370 --> 00:25:41,270
that clearly named but still has some

495
00:25:36,390 --> 00:25:45,600
specific words keep repeating among them

496
00:25:41,270 --> 00:25:48,030
ok so after all of that you probably

497
00:25:45,600 --> 00:25:52,830
wondering why should I care I don't have

498
00:25:48,030 --> 00:25:56,460
a word precise nor do I but think about

499
00:25:52,830 --> 00:25:59,610
the biggest scale of the problem we saw

500
00:25:56,460 --> 00:26:04,020
that word print like any size is most of

501
00:25:59,610 --> 00:26:09,209
the time the initial starting point of

502
00:26:04,020 --> 00:26:11,010
any attack and one infected site can in

503
00:26:09,210 --> 00:26:15,990
fact thousands of users

504
00:26:11,010 --> 00:26:18,870
so imagine thousand infected sites can

505
00:26:15,990 --> 00:26:22,250
infect hundred thousands of users so the

506
00:26:18,870 --> 00:26:26,780
problem is so it's kind of like a big

507
00:26:22,250 --> 00:26:31,620
pool for attackers and also the

508
00:26:26,780 --> 00:26:34,399
anonymity so let's conclude the

509
00:26:31,620 --> 00:26:37,919
presentation today we found out that

510
00:26:34,400 --> 00:26:40,320
WordPress the content management system

511
00:26:37,920 --> 00:26:42,420
including WordPress probably brute force

512
00:26:40,320 --> 00:26:46,590
since the very beginning of their

513
00:26:42,420 --> 00:26:49,950
creation the attacks is still there

514
00:26:46,590 --> 00:26:54,600
they still works and it's still used by

515
00:26:49,950 --> 00:26:57,120
attackers the infected sites or just in

516
00:26:54,600 --> 00:26:59,159
general site is an important starting

517
00:26:57,120 --> 00:27:05,550
point of any infrastructure of the

518
00:26:59,160 --> 00:27:08,360
malware and we also found that not that

519
00:27:05,550 --> 00:27:11,580
brute forcing is not really very much

520
00:27:08,360 --> 00:27:15,149
researched we saw dozens of blog post

521
00:27:11,580 --> 00:27:17,820
and it's a very valuable Intel about the

522
00:27:15,150 --> 00:27:20,070
brute forcing but we did not see and

523
00:27:17,820 --> 00:27:25,500
find any extensive research in this

524
00:27:20,070 --> 00:27:27,510
topic so we also the we did not measure

525
00:27:25,500 --> 00:27:30,210
the successful rate and it's kind of

526
00:27:27,510 --> 00:27:33,059
really hard for us which is fall down to

527
00:27:30,210 --> 00:27:34,860
our future work as well as we are

528
00:27:33,059 --> 00:27:37,080
curious to find out how often the

529
00:27:34,860 --> 00:27:40,889
password changed and then we're also

530
00:27:37,080 --> 00:27:45,230
interested if those successfully hacked

531
00:27:40,890 --> 00:27:49,620
sites which malware use them in the next

532
00:27:45,230 --> 00:27:52,890
in their malicious purposes so that's

533
00:27:49,620 --> 00:27:55,530
all for today for me these data sets

534
00:27:52,890 --> 00:27:57,809
released on the stratosphere IPS that

535
00:27:55,530 --> 00:28:01,050
org you can search it as well as other

536
00:27:57,809 --> 00:28:04,170
other data there is a broad Putin Argus

537
00:28:01,050 --> 00:28:07,919
output and P caps and DNS traffic

538
00:28:04,170 --> 00:28:10,470
everything and yeah I'm happy here to

539
00:28:07,920 --> 00:28:13,010
answer your questions you have one thank

540
00:28:10,470 --> 00:28:13,010
you thank you

541
00:28:17,380 --> 00:28:24,790
are there any questions for Ana come on

542
00:28:22,340 --> 00:28:24,790
don't be shy

543
00:28:27,580 --> 00:28:32,510
hi thank you for your talk you presented

544
00:28:30,830 --> 00:28:36,409
an interesting technique in which the

545
00:28:32,510 --> 00:28:39,740
malware goes to the Frisian C's server

546
00:28:36,410 --> 00:28:41,930
in order to get a specific domain in

547
00:28:39,740 --> 00:28:45,080
which you should get his txt record and

548
00:28:41,930 --> 00:28:49,240
then follow on non what in your opinion

549
00:28:45,080 --> 00:28:49,240
is the reason for using this technique

550
00:28:49,660 --> 00:28:55,460
sorry can you please probably repeat

551
00:28:53,720 --> 00:28:57,620
because I yes

552
00:28:55,460 --> 00:29:00,350
showed an interesting technique in which

553
00:28:57,620 --> 00:29:02,510
the malware it goes to the first command

554
00:29:00,350 --> 00:29:04,760
and control server in order to find the

555
00:29:02,510 --> 00:29:08,420
domain in which he will get his txt

556
00:29:04,760 --> 00:29:10,310
record AHA ok then we'll follow for how

557
00:29:08,420 --> 00:29:14,030
would you explain the usage for this

558
00:29:10,310 --> 00:29:15,740
technique why is it necessary I'm

559
00:29:14,030 --> 00:29:19,510
actually I've never thought about it to

560
00:29:15,740 --> 00:29:22,490
be honest it's actually a question but

561
00:29:19,510 --> 00:29:25,490
maybe maybe it's just trying to avoid

562
00:29:22,490 --> 00:29:29,780
somehow the detection because Norman but

563
00:29:25,490 --> 00:29:34,040
I'm actually not sure I I'm sorry I need

564
00:29:29,780 --> 00:29:40,010
to think about it thanks any other

565
00:29:34,040 --> 00:29:45,490
questions No so thank you again Anna

566
00:29:40,010 --> 00:29:45,490
thank you to be here

