1
00:00:05,180 --> 00:00:12,629
good evening my name is Olivia Stan and

2
00:00:09,480 --> 00:00:14,420
I'm leading the Google antabuse research

3
00:00:12,630 --> 00:00:17,369
team and today with Oren from checkpoint

4
00:00:14,420 --> 00:00:19,770
we're going to tell you about how we

5
00:00:17,369 --> 00:00:23,460
hunted down good again and how we took

6
00:00:19,770 --> 00:00:25,140
it down eventually so what is good again

7
00:00:23,460 --> 00:00:27,810
good Egan was one of the largest

8
00:00:25,140 --> 00:00:30,679
escalation of last year it is of

9
00:00:27,810 --> 00:00:34,379
interest because it was the first

10
00:00:30,679 --> 00:00:36,870
large-scale odd stealing malware which

11
00:00:34,380 --> 00:00:39,989
me take it a turning point we believe in

12
00:00:36,870 --> 00:00:42,629
the version of Mauer and we have a

13
00:00:39,989 --> 00:00:45,538
Content over million Google account who

14
00:00:42,629 --> 00:00:47,010
are affected by this botnet so what is

15
00:00:45,539 --> 00:00:48,690
odd very briefly for those who don't

16
00:00:47,010 --> 00:00:50,879
know how many of you know what all it is

17
00:00:48,690 --> 00:00:53,539
can you raise your hand only half of it

18
00:00:50,879 --> 00:00:55,949
okay so just very briefly code is a

19
00:00:53,539 --> 00:00:58,770
specification which has been used more

20
00:00:55,949 --> 00:01:00,690
and more and the idea is a lot of your

21
00:00:58,770 --> 00:01:03,149
of your account has been used by other

22
00:01:00,690 --> 00:01:05,908
apps for identifications for example

23
00:01:03,149 --> 00:01:07,680
Twitter Linkedin Google or Facebook I

24
00:01:05,909 --> 00:01:09,030
using it and the idea is when you

25
00:01:07,680 --> 00:01:10,740
connect to another services you don't

26
00:01:09,030 --> 00:01:13,380
want to give the password or you want to

27
00:01:10,740 --> 00:01:15,119
restrict the ability of people to use a

28
00:01:13,380 --> 00:01:17,670
service so for example you want to only

29
00:01:15,119 --> 00:01:19,890
have an account an app to read your

30
00:01:17,670 --> 00:01:22,189
Twitter timeline and not put on your

31
00:01:19,890 --> 00:01:24,270
behalf so to have those password less

32
00:01:22,189 --> 00:01:27,330
authorization and delegation mechanisms

33
00:01:24,270 --> 00:01:30,270
the specification is called old and old

34
00:01:27,330 --> 00:01:31,650
token have been used by any by very

35
00:01:30,270 --> 00:01:34,079
large providers and they are also used

36
00:01:31,650 --> 00:01:36,869
in Android when you want to request

37
00:01:34,079 --> 00:01:39,869
access to one of the account variable on

38
00:01:36,869 --> 00:01:41,909
the end on the phone and obviously for

39
00:01:39,869 --> 00:01:43,640
Google account as well so that's what

40
00:01:41,909 --> 00:01:45,890
all it is and so this is a password less

41
00:01:43,640 --> 00:01:50,729
delegation mechanism which is used

42
00:01:45,890 --> 00:01:53,880
universally now I would type so briefly

43
00:01:50,729 --> 00:01:56,520
what what happened in about about two

44
00:01:53,880 --> 00:01:58,589
years ago around March there was an hour

45
00:01:56,520 --> 00:02:01,860
an adware called snippy

46
00:01:58,590 --> 00:02:04,140
snappy sorry which was discovered by

47
00:02:01,860 --> 00:02:06,299
checkpoint and this malware is relevant

48
00:02:04,140 --> 00:02:07,840
because it was the first one to

49
00:02:06,299 --> 00:02:10,509
weaponize it

50
00:02:07,840 --> 00:02:13,030
exploit which were used originally used

51
00:02:10,508 --> 00:02:14,589
by the young teachers community through

52
00:02:13,030 --> 00:02:17,020
the phone and to do ads and

53
00:02:14,590 --> 00:02:19,420
customizations and social exist or

54
00:02:17,020 --> 00:02:21,190
unlocking the phone and so there was the

55
00:02:19,420 --> 00:02:23,350
first one and the practice fear of

56
00:02:21,190 --> 00:02:25,740
what's going to come a few months after

57
00:02:23,350 --> 00:02:29,620
that a company called cheetah mobile

58
00:02:25,740 --> 00:02:33,310
uncover a large malware family Cole goes

59
00:02:29,620 --> 00:02:34,900
push and goes push is known because they

60
00:02:33,310 --> 00:02:36,750
innovated in the space of Android

61
00:02:34,900 --> 00:02:40,330
malware by providing

62
00:02:36,750 --> 00:02:42,220
persistency across reboots

63
00:02:40,330 --> 00:02:44,680
but also flash so what they would do is

64
00:02:42,220 --> 00:02:47,620
they would patch recovery system to

65
00:02:44,680 --> 00:02:51,220
enable a persistence whoo resetting the

66
00:02:47,620 --> 00:02:53,500
default systems settings and then a year

67
00:02:51,220 --> 00:02:56,290
after that and that's the main event

68
00:02:53,500 --> 00:02:57,910
we're going to describe today good again

69
00:02:56,290 --> 00:03:00,760
use your face again

70
00:02:57,910 --> 00:03:02,470
discovered by checkpoint and goodie can

71
00:03:00,760 --> 00:03:05,079
innovate as we said because they are

72
00:03:02,470 --> 00:03:07,540
using now old tokens to do some of

73
00:03:05,080 --> 00:03:10,120
fortunate abuse and then if you week

74
00:03:07,540 --> 00:03:11,739
after a few days actually after it has

75
00:03:10,120 --> 00:03:14,140
been discovered and we tried to

76
00:03:11,739 --> 00:03:15,760
collaborate with checkpoint we were able

77
00:03:14,140 --> 00:03:17,670
to take down good again and we're going

78
00:03:15,760 --> 00:03:19,929
to tell you about this period of time

79
00:03:17,670 --> 00:03:22,390
before we get started and we delve into

80
00:03:19,930 --> 00:03:25,239
the teacher on how Corrigan works let's

81
00:03:22,390 --> 00:03:26,890
provide a very rough overview of why it

82
00:03:25,239 --> 00:03:28,660
works because it's a very pieces complex

83
00:03:26,890 --> 00:03:30,670
piece of software so just to give you a

84
00:03:28,660 --> 00:03:35,410
rough idea of what it look like

85
00:03:30,670 --> 00:03:39,070
first good ghost good Egan is known to

86
00:03:35,410 --> 00:03:41,980
take a known ATK and we packaged it with

87
00:03:39,070 --> 00:03:44,140
extra stuff I suppose have been merry

88
00:03:41,980 --> 00:03:46,238
shoes and then they push it through

89
00:03:44,140 --> 00:03:49,329
social engineering or other channels to

90
00:03:46,239 --> 00:03:51,580
the users opening the Christian this

91
00:03:49,330 --> 00:03:53,470
piece of malware would register to a

92
00:03:51,580 --> 00:03:56,530
command control for the registration

93
00:03:53,470 --> 00:03:59,049
systems and then go and connect to the

94
00:03:56,530 --> 00:04:01,269
exploit server and the exposure will

95
00:03:59,049 --> 00:04:03,430
return back the needed exploit to route

96
00:04:01,269 --> 00:04:06,970
the phone after that it's going to

97
00:04:03,430 --> 00:04:08,769
connect to a fraudulent app or add

98
00:04:06,970 --> 00:04:11,560
related command control which are you

99
00:04:08,769 --> 00:04:14,260
what to performance abuse and finally it

100
00:04:11,560 --> 00:04:16,988
would either do attempt to do placed or

101
00:04:14,260 --> 00:04:18,969
fake comment and install or will do some

102
00:04:16,988 --> 00:04:20,219
sort of ad injection into the device

103
00:04:18,970 --> 00:04:22,500
showing pop-up

104
00:04:20,220 --> 00:04:25,560
for ads which is not Google related but

105
00:04:22,500 --> 00:04:27,840
they been doing a few ads networks so

106
00:04:25,560 --> 00:04:30,720
that basically nutshell how quick and

107
00:04:27,840 --> 00:04:33,299
works so today we're going to cover five

108
00:04:30,720 --> 00:04:34,800
point or rank is going to start by

109
00:04:33,300 --> 00:04:36,570
telling you about how the infection

110
00:04:34,800 --> 00:04:39,210
works and we're at the mechanical detail

111
00:04:36,570 --> 00:04:42,599
behind the infections and when we count

112
00:04:39,210 --> 00:04:45,060
house checkpoint discovered the backend

113
00:04:42,600 --> 00:04:46,860
infrastructure behind good again then I

114
00:04:45,060 --> 00:04:48,660
come back and will tell you how they

115
00:04:46,860 --> 00:04:50,750
monetize and how they were using the

116
00:04:48,660 --> 00:04:53,520
malware to make money we will talk about

117
00:04:50,750 --> 00:04:56,160
who were the affected devices based of

118
00:04:53,520 --> 00:05:02,630
our telemetry and finally how we were

119
00:04:56,160 --> 00:05:02,630
able to take it down all right thank you

120
00:05:02,960 --> 00:05:10,409
okay so in order for us to understand

121
00:05:06,540 --> 00:05:12,900
Google again as a botnet we first need

122
00:05:10,410 --> 00:05:17,270
to understand Google again as a Trojan

123
00:05:12,900 --> 00:05:20,669
so as the android client of this pot net

124
00:05:17,270 --> 00:05:25,070
so the golden kill chain is comprised of

125
00:05:20,669 --> 00:05:27,570
several key steps the first of which is

126
00:05:25,070 --> 00:05:31,070
decoding the payload this is a payload

127
00:05:27,570 --> 00:05:34,980
that is embedded into the Google again

128
00:05:31,070 --> 00:05:37,290
apk once decoded among other fins this

129
00:05:34,980 --> 00:05:41,100
payload is responsible for downloading

130
00:05:37,290 --> 00:05:44,910
dynamically downloading a rootkit this

131
00:05:41,100 --> 00:05:48,900
rootkit is used to root the device and

132
00:05:44,910 --> 00:05:52,640
if successful goal again is now free to

133
00:05:48,900 --> 00:05:56,250
install its persistence eke it utils

134
00:05:52,640 --> 00:05:58,919
most interesting of which is a YouTube

135
00:05:56,250 --> 00:06:04,440
that enables Google again to infect the

136
00:05:58,919 --> 00:06:08,310
local Google Play process ok so starting

137
00:06:04,440 --> 00:06:12,150
with the payload decryption so typically

138
00:06:08,310 --> 00:06:15,660
the payload would be in one of one of go

139
00:06:12,150 --> 00:06:18,599
against assets the SS is typically named

140
00:06:15,660 --> 00:06:22,110
close dot PNG and these less to say this

141
00:06:18,600 --> 00:06:25,320
is not a PNG this is in fact another apk

142
00:06:22,110 --> 00:06:28,289
more precisely it's a zip containing a

143
00:06:25,320 --> 00:06:32,260
Dex so in Android executable and these

144
00:06:28,289 --> 00:06:36,130
specs is X or encrypted

145
00:06:32,260 --> 00:06:41,110
so this is the file structure of off

146
00:06:36,130 --> 00:06:43,750
said closed dot PNG so you have the

147
00:06:41,110 --> 00:06:46,720
payload and prepended to the payload you

148
00:06:43,750 --> 00:06:49,600
have the xor key so that's ten bytes of

149
00:06:46,720 --> 00:06:52,300
X sort key that are used in a loop and

150
00:06:49,600 --> 00:06:54,160
you have a header and a footer the

151
00:06:52,300 --> 00:06:58,620
header and the footer contain the same

152
00:06:54,160 --> 00:07:03,220
values five bytes each but in SWAT order

153
00:06:58,620 --> 00:07:06,430
and before starting to decrypt the

154
00:07:03,220 --> 00:07:08,980
payload it is checking that fell one

155
00:07:06,430 --> 00:07:12,280
equals when well one and well two equals

156
00:07:08,980 --> 00:07:15,370
well two so this is some kind of weird

157
00:07:12,280 --> 00:07:18,789
and primitive checksum and then it

158
00:07:15,370 --> 00:07:21,700
decrypts the actual payload so this is a

159
00:07:18,790 --> 00:07:26,640
Python code that emulate this

160
00:07:21,700 --> 00:07:31,630
description you can see that the key is

161
00:07:26,640 --> 00:07:36,520
within the within the PNG and that's

162
00:07:31,630 --> 00:07:40,690
just a simple sore algorithm and once

163
00:07:36,520 --> 00:07:42,700
we've decoded this payload we can now

164
00:07:40,690 --> 00:07:45,520
download the rootkit

165
00:07:42,700 --> 00:07:47,830
so what is going and using for a rootkit

166
00:07:45,520 --> 00:07:52,330
did they develop any of their own

167
00:07:47,830 --> 00:07:56,830
exploits no no time to do that they just

168
00:07:52,330 --> 00:08:00,120
used some third party service kingroot

169
00:07:56,830 --> 00:08:03,039
this is a very famous very famous

170
00:08:00,120 --> 00:08:05,200
routing solution in android don't think

171
00:08:03,040 --> 00:08:07,540
there's any need to introduce it to

172
00:08:05,200 --> 00:08:10,930
anyone that's that's familiar with the

173
00:08:07,540 --> 00:08:14,410
Android ecosystem and the exploits that

174
00:08:10,930 --> 00:08:21,390
were Ravine this rootkit were relevant

175
00:08:14,410 --> 00:08:24,280
for Android between three and four okay

176
00:08:21,390 --> 00:08:28,000
say we have successfully rooted the

177
00:08:24,280 --> 00:08:29,500
device now we are free to install the

178
00:08:28,000 --> 00:08:32,500
persistence ticket what does the

179
00:08:29,500 --> 00:08:34,120
persistent think it does a couple of

180
00:08:32,500 --> 00:08:35,860
things so there are a couple of

181
00:08:34,120 --> 00:08:38,200
different utils within the persistence

182
00:08:35,860 --> 00:08:40,120
ticket they are all written into the

183
00:08:38,200 --> 00:08:42,400
system partition of course you cannot

184
00:08:40,120 --> 00:08:43,590
write into the system partition in

185
00:08:42,400 --> 00:08:46,050
Android unless

186
00:08:43,590 --> 00:08:48,660
root we did not enumerate all the

187
00:08:46,050 --> 00:08:55,439
different details but interestingly you

188
00:08:48,660 --> 00:09:00,030
can see this data LS util which is the

189
00:08:55,440 --> 00:09:02,820
SU binary and its installed and then its

190
00:09:00,030 --> 00:09:05,310
permissions are changed and frozen so

191
00:09:02,820 --> 00:09:09,200
that the SU binary would be encapsulated

192
00:09:05,310 --> 00:09:12,689
just for the Google again malware to use

193
00:09:09,200 --> 00:09:14,640
another interesting util is the is the

194
00:09:12,690 --> 00:09:17,070
inject injection model that we will talk

195
00:09:14,640 --> 00:09:20,250
about soon and another interesting

196
00:09:17,070 --> 00:09:24,240
feature is patching the install recovery

197
00:09:20,250 --> 00:09:28,950
script so this was first done by Bible

198
00:09:24,240 --> 00:09:30,990
against predecessor go school it was

199
00:09:28,950 --> 00:09:34,560
considered a relatively new technique

200
00:09:30,990 --> 00:09:40,430
and it enables to survive factory reset

201
00:09:34,560 --> 00:09:43,969
so very very annoying for infected users

202
00:09:40,430 --> 00:09:47,640
okay once we have all the tools in place

203
00:09:43,970 --> 00:09:49,710
we can move into the fun part which is

204
00:09:47,640 --> 00:09:51,840
injecting code into the google play

205
00:09:49,710 --> 00:09:54,480
process how does that work

206
00:09:51,840 --> 00:09:57,350
so the injector model of Google again is

207
00:09:54,480 --> 00:10:01,020
using the Peter s + VL open approach

208
00:09:57,350 --> 00:10:05,070
this is a very common approach among

209
00:10:01,020 --> 00:10:09,480
power users in Android and it uses it to

210
00:10:05,070 --> 00:10:13,740
inject a shared objects IG p LD the

211
00:10:09,480 --> 00:10:16,770
names are terrible this IPL D is in of

212
00:10:13,740 --> 00:10:19,470
itself another loader but this time it

213
00:10:16,770 --> 00:10:21,590
loads it dynamically loads into the

214
00:10:19,470 --> 00:10:26,780
google play process and additional decks

215
00:10:21,590 --> 00:10:29,310
so text is code written in Java

216
00:10:26,780 --> 00:10:31,380
gonnigan developers would prefer

217
00:10:29,310 --> 00:10:34,829
developing their code most of their code

218
00:10:31,380 --> 00:10:38,670
in Java so this text contains a

219
00:10:34,830 --> 00:10:41,370
broadcast receiver broadcast receivers

220
00:10:38,670 --> 00:10:43,439
are basically Android listeners that

221
00:10:41,370 --> 00:10:46,230
listen to different system events or

222
00:10:43,440 --> 00:10:49,920
events from different apps so this

223
00:10:46,230 --> 00:10:52,680
receiver was listening to power events

224
00:10:49,920 --> 00:10:55,670
devices connected to charger or a

225
00:10:52,680 --> 00:10:59,160
disconnected connectivity event

226
00:10:55,670 --> 00:11:01,410
Wi-Fi etc and screen on screen off

227
00:10:59,160 --> 00:11:01,890
events why does it care about these

228
00:11:01,410 --> 00:11:05,100
events

229
00:11:01,890 --> 00:11:08,220
it doesn't these are just random events

230
00:11:05,100 --> 00:11:11,280
that enable it to arbitrarily wake up

231
00:11:08,220 --> 00:11:14,880
what does it do once it wakes up it

232
00:11:11,280 --> 00:11:18,270
downloads yet another Dex this Dex is

233
00:11:14,880 --> 00:11:20,540
the real moneymaker and it's and it

234
00:11:18,270 --> 00:11:25,170
contains the actual implementation of

235
00:11:20,540 --> 00:11:32,310
the fraud logic that would be that would

236
00:11:25,170 --> 00:11:35,339
be appended to Google place code so the

237
00:11:32,310 --> 00:11:37,829
injection model that they used was also

238
00:11:35,340 --> 00:11:40,800
not code that they developed themselves

239
00:11:37,830 --> 00:11:43,860
this is open source code that you can

240
00:11:40,800 --> 00:11:47,729
find in different github repositories

241
00:11:43,860 --> 00:11:49,560
and in many Chinese blogs so you can see

242
00:11:47,730 --> 00:11:52,830
that you have some kind of helper method

243
00:11:49,560 --> 00:11:56,550
that you can provide an app it will give

244
00:11:52,830 --> 00:12:00,270
you the PID and then you use this PID to

245
00:11:56,550 --> 00:12:04,859
inject a shared object just like googan

246
00:12:00,270 --> 00:12:06,810
does cool now that we have a basic

247
00:12:04,860 --> 00:12:09,390
concept of the inner working of

248
00:12:06,810 --> 00:12:14,369
Goolagong let's talk a little bit about

249
00:12:09,390 --> 00:12:16,189
how we discovered okay so our first

250
00:12:14,370 --> 00:12:22,050
encounter meant with GU again

251
00:12:16,190 --> 00:12:24,210
was with a patient zero device that's

252
00:12:22,050 --> 00:12:27,839
was a that was a customer device

253
00:12:24,210 --> 00:12:30,360
infected with a GU again dropper and we

254
00:12:27,839 --> 00:12:33,540
found several interesting i/o sees that

255
00:12:30,360 --> 00:12:37,560
make us made us look into this specific

256
00:12:33,540 --> 00:12:42,360
binary most of them were related to

257
00:12:37,560 --> 00:12:45,119
dropping or to rooting and among them

258
00:12:42,360 --> 00:12:48,089
was this not non interesting string over

259
00:12:45,120 --> 00:12:51,690
C a just read ready so some kind of

260
00:12:48,089 --> 00:12:55,560
reference to an in-memory database seems

261
00:12:51,690 --> 00:12:59,150
completely boring but on the same time

262
00:12:55,560 --> 00:13:02,640
unique enough to use that to find our

263
00:12:59,150 --> 00:13:03,990
Goolagong samples so we thought we would

264
00:13:02,640 --> 00:13:06,930
do just that

265
00:13:03,990 --> 00:13:09,279
so we've searched for the string in all

266
00:13:06,930 --> 00:13:12,758
kind of places also in Google

267
00:13:09,279 --> 00:13:16,029
and we found this blog so this is a

268
00:13:12,759 --> 00:13:18,990
Chinese coding blog and this specific

269
00:13:16,029 --> 00:13:24,189
post is talking about how to configure a

270
00:13:18,990 --> 00:13:27,160
proxy good enough it has a reference to

271
00:13:24,189 --> 00:13:31,180
our string and lo will be lo and behold

272
00:13:27,160 --> 00:13:36,029
it also has credentials to the to the

273
00:13:31,180 --> 00:13:39,819
proxy we're configuring since we had

274
00:13:36,029 --> 00:13:43,689
since we had the IP of the first proxy

275
00:13:39,819 --> 00:13:46,589
that go again is talking to we were able

276
00:13:43,689 --> 00:13:50,649
to try these credentials and

277
00:13:46,589 --> 00:13:55,449
conveniently enough they worked so this

278
00:13:50,649 --> 00:13:57,699
proxy was in fact a load balancer use to

279
00:13:55,449 --> 00:14:00,639
balance load for the whole googling and

280
00:13:57,699 --> 00:14:05,290
campaign and it enumerates the different

281
00:14:00,639 --> 00:14:07,389
go against servers awesome so now that

282
00:14:05,290 --> 00:14:09,610
we have this information and we have

283
00:14:07,389 --> 00:14:12,129
reverse-engineered more and more samples

284
00:14:09,610 --> 00:14:15,240
we were able to get a picture of what

285
00:14:12,129 --> 00:14:19,750
the GU again botnet actually looks like

286
00:14:15,240 --> 00:14:23,649
and this is a simplified version so you

287
00:14:19,750 --> 00:14:27,579
can see that we have Amazon servers and

288
00:14:23,649 --> 00:14:30,879
we have Chinese servers after we've

289
00:14:27,579 --> 00:14:33,849
started the takedown operation we've goo

290
00:14:30,879 --> 00:14:35,939
with Google a lot of the Amazon's server

291
00:14:33,850 --> 00:14:39,550
started disappearing and the whole

292
00:14:35,939 --> 00:14:42,790
botnet immigrated to Chinese servers but

293
00:14:39,550 --> 00:14:48,579
we will describe we will describe how

294
00:14:42,790 --> 00:14:52,420
the botnet work when both when both geo

295
00:14:48,579 --> 00:14:54,910
locations existed so let's try to look

296
00:14:52,420 --> 00:14:57,459
at the goog and kill chain again this

297
00:14:54,910 --> 00:15:00,069
time former in network perspective so we

298
00:14:57,459 --> 00:15:03,989
have an infected device this device is

299
00:15:00,069 --> 00:15:06,579
registering to the go again botnet

300
00:15:03,990 --> 00:15:10,269
delivering interesting metadata about

301
00:15:06,579 --> 00:15:13,089
itself build bla bla bla and then it

302
00:15:10,269 --> 00:15:15,389
moved to talk with the Chinese server so

303
00:15:13,089 --> 00:15:18,910
it's talking with this resource GG view

304
00:15:15,389 --> 00:15:22,540
which delivers a dynamic link to the

305
00:15:18,910 --> 00:15:27,010
exploit kit once exploited

306
00:15:22,540 --> 00:15:28,990
it's talking to the IG q the IG curious

307
00:15:27,010 --> 00:15:32,100
is on the same server

308
00:15:28,990 --> 00:15:35,440
this resource is in charge of delivering

309
00:15:32,100 --> 00:15:39,040
the dynamic libraries that will be

310
00:15:35,440 --> 00:15:41,890
injected into Google Play and the

311
00:15:39,040 --> 00:15:44,170
service is also in charge of delivering

312
00:15:41,890 --> 00:15:47,500
the actual fraud commands

313
00:15:44,170 --> 00:15:49,150
so what apks should be downloaded what

314
00:15:47,500 --> 00:15:52,890
comments should be made in google play

315
00:15:49,150 --> 00:15:55,930
stuff that you I will explain more about

316
00:15:52,890 --> 00:16:00,490
and an interesting feature is that when

317
00:15:55,930 --> 00:16:03,250
the botnet has started to evolve we had

318
00:16:00,490 --> 00:16:08,820
a dedicated service that's only doing

319
00:16:03,250 --> 00:16:12,310
fraud and igq was only in charge of of

320
00:16:08,820 --> 00:16:17,020
injected libraries so we see that

321
00:16:12,310 --> 00:16:22,089
they're getting more speciality with

322
00:16:17,020 --> 00:16:30,970
their services that's about it ready to

323
00:16:22,090 --> 00:16:34,680
talk about money so as I mentioned we we

324
00:16:30,970 --> 00:16:36,850
looked at the phone module so we after

325
00:16:34,680 --> 00:16:45,459
checkpoint founded malware as they reach

326
00:16:36,850 --> 00:16:47,770
out to us we believe stealing or token

327
00:16:45,460 --> 00:16:49,540
and you should look into it because it's

328
00:16:47,770 --> 00:16:51,699
about the millions of course we went

329
00:16:49,540 --> 00:16:54,250
into escalation mode and we were

330
00:16:51,700 --> 00:16:56,620
collaborating and so we spend a lot of

331
00:16:54,250 --> 00:16:58,900
time try to understand what were they

332
00:16:56,620 --> 00:17:00,370
were doing with the tokens because the

333
00:16:58,900 --> 00:17:01,840
token you have uninsured rate phone a

334
00:17:00,370 --> 00:17:04,000
very powerful you can use them for many

335
00:17:01,840 --> 00:17:05,230
many things it turned out the only

336
00:17:04,000 --> 00:17:08,200
things they were carrying about was

337
00:17:05,230 --> 00:17:10,630
making money most specifically they were

338
00:17:08,200 --> 00:17:12,370
doing two things the first one they were

339
00:17:10,630 --> 00:17:13,720
trying to do AB boosting so it's

340
00:17:12,369 --> 00:17:16,899
directly relevant to what they are

341
00:17:13,720 --> 00:17:19,210
trying to basically sell installs and

342
00:17:16,900 --> 00:17:22,390
ratings to some of their clients and

343
00:17:19,210 --> 00:17:25,390
they were also doing ad injection in the

344
00:17:22,390 --> 00:17:27,850
center they had a way to trigger pop-ups

345
00:17:25,390 --> 00:17:29,860
into your phone and we're going to talk

346
00:17:27,849 --> 00:17:32,679
about how they were being able to do

347
00:17:29,860 --> 00:17:33,879
both of those so for the Play Store are

348
00:17:32,680 --> 00:17:35,950
boosting this is the one we understand

349
00:17:33,880 --> 00:17:39,280
the best because we had the most

350
00:17:35,950 --> 00:17:39,810
around it say basically do something

351
00:17:39,280 --> 00:17:43,270
like that

352
00:17:39,810 --> 00:17:45,040
they take the odd token and the reason

353
00:17:43,270 --> 00:17:47,020
why they wanted to use them whilst to

354
00:17:45,040 --> 00:17:48,760
interact with the Play Store on your

355
00:17:47,020 --> 00:17:51,430
Android phone when you would pass an app

356
00:17:48,760 --> 00:17:53,020
in store you actually do not we don't

357
00:17:51,430 --> 00:17:54,970
have your credential on your phone we

358
00:17:53,020 --> 00:17:56,920
have this long-term token and we

359
00:17:54,970 --> 00:17:59,050
exchange it and we basically go in the

360
00:17:56,920 --> 00:18:00,040
App Store when you click on it on the

361
00:17:59,050 --> 00:18:01,870
Play Store you click install and

362
00:18:00,040 --> 00:18:05,889
basically download the app and do this

363
00:18:01,870 --> 00:18:07,389
sort of altercations they were providing

364
00:18:05,890 --> 00:18:09,940
to that client what we call a full

365
00:18:07,390 --> 00:18:11,920
package which is a fake install some

366
00:18:09,940 --> 00:18:13,300
reviews so not all of them are which

367
00:18:11,920 --> 00:18:15,130
review but they were having

368
00:18:13,300 --> 00:18:17,110
accessibility to the reviews and ratings

369
00:18:15,130 --> 00:18:19,420
review will be like great the app or

370
00:18:17,110 --> 00:18:21,070
something like that and also a search

371
00:18:19,420 --> 00:18:24,010
term so what they were trying to do is

372
00:18:21,070 --> 00:18:28,419
search for specific keyword I say

373
00:18:24,010 --> 00:18:30,250
battery saver and then scroll pretend to

374
00:18:28,420 --> 00:18:31,540
be a click and then use install and then

375
00:18:30,250 --> 00:18:33,580
leave a review so that's what they were

376
00:18:31,540 --> 00:18:36,040
trying to do in a nutshell and what you

377
00:18:33,580 --> 00:18:38,560
see on the last screen is if you were to

378
00:18:36,040 --> 00:18:40,270
get your phone being infected by good

379
00:18:38,560 --> 00:18:43,120
again you will get those icon who would

380
00:18:40,270 --> 00:18:46,090
pop up and they will look like what

381
00:18:43,120 --> 00:18:47,560
people might expect so for example here

382
00:18:46,090 --> 00:18:49,330
two of them were inserting something

383
00:18:47,560 --> 00:18:51,490
which would look like a Game Center it's

384
00:18:49,330 --> 00:18:53,679
a obviously not a real Game Center but

385
00:18:51,490 --> 00:18:55,920
they try to appear as an issues as

386
00:18:53,680 --> 00:18:58,570
possible so the user is not triggered by

387
00:18:55,920 --> 00:19:01,240
yeah and so it was all done very very

388
00:18:58,570 --> 00:19:04,600
quietly to try to not raise user

389
00:19:01,240 --> 00:19:08,290
awareness so another thing which

390
00:19:04,600 --> 00:19:10,209
actually took us even if you a long time

391
00:19:08,290 --> 00:19:12,879
to figure out even after the tectum was

392
00:19:10,210 --> 00:19:15,430
done was to understand why in hell with

393
00:19:12,880 --> 00:19:16,540
a neat job try to talk it so one thing

394
00:19:15,430 --> 00:19:19,090
we didn't make sense at the beginning

395
00:19:16,540 --> 00:19:21,040
was you have to do the food from the

396
00:19:19,090 --> 00:19:24,840
device so what would you go to the point

397
00:19:21,040 --> 00:19:27,280
of extras writing the talking out of the

398
00:19:24,840 --> 00:19:29,260
of the phone and put it into the cloud

399
00:19:27,280 --> 00:19:30,910
and that was a reason why we keep

400
00:19:29,260 --> 00:19:33,670
investigating until we had some sort of

401
00:19:30,910 --> 00:19:35,770
satisfying answer after looking and also

402
00:19:33,670 --> 00:19:40,000
doing better how it worked we figure out

403
00:19:35,770 --> 00:19:42,490
that it's probably because the token has

404
00:19:40,000 --> 00:19:45,580
a way for them to mail a device so in

405
00:19:42,490 --> 00:19:47,980
the last few years we've made a lot of

406
00:19:45,580 --> 00:19:49,750
progress on the press for to detect very

407
00:19:47,980 --> 00:19:51,670
efficiently fake installs

408
00:19:49,750 --> 00:19:53,590
a lot of people try to do you know a SEO

409
00:19:51,670 --> 00:19:55,690
application search optimization which is

410
00:19:53,590 --> 00:19:58,929
basically try to alternate your

411
00:19:55,690 --> 00:20:01,780
competitions who various means and so we

412
00:19:58,930 --> 00:20:03,730
have built a lot of Defense's based on

413
00:20:01,780 --> 00:20:05,560
machine learning and also your sticks to

414
00:20:03,730 --> 00:20:07,570
actually detect those things so as a

415
00:20:05,560 --> 00:20:11,350
result they grow more and more desperate

416
00:20:07,570 --> 00:20:12,970
so their plan is now to attempt to

417
00:20:11,350 --> 00:20:14,439
masquerade as a real user and the

418
00:20:12,970 --> 00:20:17,920
easiest way for them to do that at that

419
00:20:14,440 --> 00:20:21,250
point is to be on a real phone with real

420
00:20:17,920 --> 00:20:23,800
user data on the real app and so the

421
00:20:21,250 --> 00:20:25,330
point is to try to trigger their plan

422
00:20:23,800 --> 00:20:27,040
was to trigger the insert from the Play

423
00:20:25,330 --> 00:20:29,320
Store or appearing to coming from the

424
00:20:27,040 --> 00:20:31,420
real app on the Play Store on the device

425
00:20:29,320 --> 00:20:34,139
and do this so that's why we believe

426
00:20:31,420 --> 00:20:37,540
that we're going after the entree token

427
00:20:34,140 --> 00:20:39,850
it's a way you do this kind of abuse is

428
00:20:37,540 --> 00:20:41,379
in four stages the first one is you take

429
00:20:39,850 --> 00:20:43,240
the account database which is on your

430
00:20:41,380 --> 00:20:45,430
phone and it's protected and you should

431
00:20:43,240 --> 00:20:47,140
not be have access to it except if you

432
00:20:45,430 --> 00:20:50,320
wrote and that's where and the rootkit

433
00:20:47,140 --> 00:20:52,660
thing where you basically do a cat and

434
00:20:50,320 --> 00:20:53,770
they get all the token and all the

435
00:20:52,660 --> 00:20:55,150
things there might be other things like

436
00:20:53,770 --> 00:20:56,800
every time you had an account to your

437
00:20:55,150 --> 00:20:59,020
Android phone like Facebook and so forth

438
00:20:56,800 --> 00:21:01,570
they also in the database so they create

439
00:20:59,020 --> 00:21:04,150
they take all the databases and then

440
00:21:01,570 --> 00:21:06,159
they basically perform sql-like query on

441
00:21:04,150 --> 00:21:08,620
it and what they're looking for is very

442
00:21:06,160 --> 00:21:10,270
specifically Android Market I want to

443
00:21:08,620 --> 00:21:13,330
write a cure which are the one you need

444
00:21:10,270 --> 00:21:14,710
for specifically doing to play play

445
00:21:13,330 --> 00:21:16,300
abuse so they're not working for

446
00:21:14,710 --> 00:21:18,580
Facebook or any other country has is

447
00:21:16,300 --> 00:21:21,190
just looking for those then when the

448
00:21:18,580 --> 00:21:22,780
house was token they go to the good

449
00:21:21,190 --> 00:21:25,210
Eagan command control server and say hey

450
00:21:22,780 --> 00:21:28,930
here's all my parameters and please tell

451
00:21:25,210 --> 00:21:30,880
me what to do so basically it's a

452
00:21:28,930 --> 00:21:32,020
two-way process so they send a request

453
00:21:30,880 --> 00:21:34,180
which actually contained a lot of

454
00:21:32,020 --> 00:21:36,160
information way more than we were

455
00:21:34,180 --> 00:21:39,610
expecting at the beginning like I am ie

456
00:21:36,160 --> 00:21:41,830
I am a CI a full mag from model to token

457
00:21:39,610 --> 00:21:44,590
as we mentioned the Android version the

458
00:21:41,830 --> 00:21:47,740
phone carriers country zi is a public IP

459
00:21:44,590 --> 00:21:49,270
a lot of information that you which has

460
00:21:47,740 --> 00:21:53,400
no business to be there because it's not

461
00:21:49,270 --> 00:21:56,410
directly used but they do that and then

462
00:21:53,400 --> 00:21:57,880
weirdly enough the server's not only

463
00:21:56,410 --> 00:22:00,550
tell you which app to download from the

464
00:21:57,880 --> 00:22:02,560
Play Store also with just search them to

465
00:22:00,550 --> 00:22:02,980
use and if you need to put a rating and

466
00:22:02,560 --> 00:22:06,220
what will be

467
00:22:02,980 --> 00:22:08,860
writing under comment but also what fun

468
00:22:06,220 --> 00:22:11,620
information to spoof and that was a very

469
00:22:08,860 --> 00:22:12,729
very wet point for why because you

470
00:22:11,620 --> 00:22:15,129
already have the phone so the phone

471
00:22:12,730 --> 00:22:17,710
knows who it is so we should just be who

472
00:22:15,130 --> 00:22:20,970
it is and if it was not the case so we

473
00:22:17,710 --> 00:22:23,650
were very puzzled by that and after

474
00:22:20,970 --> 00:22:28,390
looking more into what happened we

475
00:22:23,650 --> 00:22:30,700
figured out that some of the the fake

476
00:22:28,390 --> 00:22:32,260
install we saw from good against x2

477
00:22:30,700 --> 00:22:34,660
server-side telemetry were actually

478
00:22:32,260 --> 00:22:38,620
coming from devices which are not rooted

479
00:22:34,660 --> 00:22:42,490
like Nexus 5 and we literally had

480
00:22:38,620 --> 00:22:44,049
someone giving us access to the phone

481
00:22:42,490 --> 00:22:45,580
physically and also we need the forensic

482
00:22:44,049 --> 00:22:47,020
analysis of the phone and it was not

483
00:22:45,580 --> 00:22:49,899
written it was not compromised in any

484
00:22:47,020 --> 00:22:53,440
way so what happened is they try to

485
00:22:49,900 --> 00:22:56,380
increase the pool of device they had by

486
00:22:53,440 --> 00:22:59,470
having a another way to infect the other

487
00:22:56,380 --> 00:23:01,870
devices with non-root up but who will be

488
00:22:59,470 --> 00:23:03,370
able to do the effect request so what

489
00:23:01,870 --> 00:23:04,689
the reason was they were except writing

490
00:23:03,370 --> 00:23:07,270
the token and all the informations of

491
00:23:04,690 --> 00:23:09,190
the phone was oh we know this user and

492
00:23:07,270 --> 00:23:12,370
we can create this realistic profile so

493
00:23:09,190 --> 00:23:14,140
you can make this fake HTTP request from

494
00:23:12,370 --> 00:23:16,899
this app which word side loaded from

495
00:23:14,140 --> 00:23:19,960
another store so the phone we got was a

496
00:23:16,900 --> 00:23:20,440
nexus it's way like a phone with Android

497
00:23:19,960 --> 00:23:22,120
511

498
00:23:20,440 --> 00:23:24,370
and the both it was not rooted but hard

499
00:23:22,120 --> 00:23:26,530
side loaded up and those up were making

500
00:23:24,370 --> 00:23:29,110
HTTP requests to the Play Store with

501
00:23:26,530 --> 00:23:30,520
information so the reason why we believe

502
00:23:29,110 --> 00:23:32,260
they were putting all this information

503
00:23:30,520 --> 00:23:34,629
to the cloud was to try to diversify the

504
00:23:32,260 --> 00:23:38,429
pull off of device because I realized it

505
00:23:34,630 --> 00:23:42,700
cannot root anything above on read for

506
00:23:38,429 --> 00:23:45,040
so when you're on the phone and you need

507
00:23:42,700 --> 00:23:47,500
to token what you do is you do the auto

508
00:23:45,040 --> 00:23:50,440
connections and so basically what it

509
00:23:47,500 --> 00:23:51,790
does is it converts your long-term token

510
00:23:50,440 --> 00:23:53,490
the one you have on your phone to a

511
00:23:51,790 --> 00:23:55,389
short turn token which is used to do

512
00:23:53,490 --> 00:23:57,960
communication with the player so

513
00:23:55,390 --> 00:24:00,010
basically it's exchanging this and

514
00:23:57,960 --> 00:24:01,809
whilst it was some confusion at the

515
00:24:00,010 --> 00:24:03,129
beginning after investigating we

516
00:24:01,809 --> 00:24:04,629
realized that the only things that we're

517
00:24:03,130 --> 00:24:07,540
doing is trying to get a token to do

518
00:24:04,630 --> 00:24:09,910
play abuse and this abuse is hard-coded

519
00:24:07,540 --> 00:24:11,620
will pretty sure it's the case and then

520
00:24:09,910 --> 00:24:14,200
with that when they have this

521
00:24:11,620 --> 00:24:16,129
information they actually use injections

522
00:24:14,200 --> 00:24:18,110
that was described by Oren

523
00:24:16,130 --> 00:24:21,590
- actually the instrument and make the

524
00:24:18,110 --> 00:24:24,740
Playstore go enjoy search query as a

525
00:24:21,590 --> 00:24:28,669
user we do go to the app pretend to

526
00:24:24,740 --> 00:24:31,430
click on it and then insert the app with

527
00:24:28,670 --> 00:24:32,900
a package manager which is stumble on

528
00:24:31,430 --> 00:24:35,180
one straight platform and then

529
00:24:32,900 --> 00:24:36,860
optionally sometimes it would like a

530
00:24:35,180 --> 00:24:38,810
derating like you know five out of five

531
00:24:36,860 --> 00:24:40,370
great app or it might be in other

532
00:24:38,810 --> 00:24:43,159
languages and they will do that quite a

533
00:24:40,370 --> 00:24:46,879
bit but basically how it works and how

534
00:24:43,160 --> 00:24:49,010
they were using the old token so again

535
00:24:46,880 --> 00:24:52,220
that's a new trend that we haven't

536
00:24:49,010 --> 00:24:54,290
observed yet but and to give you an idea

537
00:24:52,220 --> 00:24:56,480
of how it works that's basically what

538
00:24:54,290 --> 00:24:59,120
you get you basically create a HTTP

539
00:24:56,480 --> 00:25:01,730
request and the request contains a ton

540
00:24:59,120 --> 00:25:03,139
of information including the token you

541
00:25:01,730 --> 00:25:04,910
need and that's your form of

542
00:25:03,140 --> 00:25:08,450
authentication so basically the token is

543
00:25:04,910 --> 00:25:10,460
used as a way for us to know which user

544
00:25:08,450 --> 00:25:12,410
it is and to ensure that the user would

545
00:25:10,460 --> 00:25:15,050
not eat or at the content so forth and

546
00:25:12,410 --> 00:25:17,660
it's all based on HTTP HTTP request

547
00:25:15,050 --> 00:25:20,750
right very standard what's interesting

548
00:25:17,660 --> 00:25:22,760
about this abuse is what we didn't know

549
00:25:20,750 --> 00:25:25,610
about coolican specifically at a time

550
00:25:22,760 --> 00:25:28,820
when it started we had a lot of defense

551
00:25:25,610 --> 00:25:31,070
in place and all the fake control were

552
00:25:28,820 --> 00:25:32,419
already discounted and then we came back

553
00:25:31,070 --> 00:25:35,240
and we cleaned up everything else

554
00:25:32,420 --> 00:25:38,600
including we did suspend see happened

555
00:25:35,240 --> 00:25:39,830
the developer which were abusive so they

556
00:25:38,600 --> 00:25:41,860
were they were the one benefiting

557
00:25:39,830 --> 00:25:45,439
information I had no values for the user

558
00:25:41,860 --> 00:25:47,120
and so we suspend z-zap as well so there

559
00:25:45,440 --> 00:25:49,880
was at the end of the escalation no

560
00:25:47,120 --> 00:25:53,719
impact on the Play Store and no game

561
00:25:49,880 --> 00:25:56,330
ranking we also observed in some of the

562
00:25:53,720 --> 00:25:58,820
sample as injections we see don't know

563
00:25:56,330 --> 00:26:00,620
which network it is and I can explain

564
00:25:58,820 --> 00:26:03,649
why this is what you see so what

565
00:26:00,620 --> 00:26:05,479
happened is as they abused the root

566
00:26:03,650 --> 00:26:08,090
privileges to insert themselves into the

567
00:26:05,480 --> 00:26:11,420
accessibility we showed you to overlay

568
00:26:08,090 --> 00:26:13,760
the UI with whatever you want and what

569
00:26:11,420 --> 00:26:15,830
they were doing is we're popping up with

570
00:26:13,760 --> 00:26:17,360
app so you seen you see on the left side

571
00:26:15,830 --> 00:26:19,159
is a screenshot of a real phone where we

572
00:26:17,360 --> 00:26:22,340
actually tested the system and try to

573
00:26:19,160 --> 00:26:24,050
see where it was going and it's really

574
00:26:22,340 --> 00:26:25,429
hard to know who is behind it because

575
00:26:24,050 --> 00:26:27,310
there is a lot of attribution washing

576
00:26:25,430 --> 00:26:29,160
which means they goes from many many

577
00:26:27,310 --> 00:26:30,780
measurement platform

578
00:26:29,160 --> 00:26:33,300
to measure the flick right and this goes

579
00:26:30,780 --> 00:26:36,629
to a ton of a direct chains so we can't

580
00:26:33,300 --> 00:26:40,080
tell for sure who was behind it but they

581
00:26:36,630 --> 00:26:41,790
were advertising legitimate apps so it

582
00:26:40,080 --> 00:26:43,649
means that someone from those app were

583
00:26:41,790 --> 00:26:45,600
buying in good fight install or

584
00:26:43,650 --> 00:26:49,470
promotion and as a result we're getting

585
00:26:45,600 --> 00:26:51,300
in so from a botnet so hopefully we were

586
00:26:49,470 --> 00:26:53,640
able to remove it and so they're now

587
00:26:51,300 --> 00:26:56,280
getting install which are legitimate

588
00:26:53,640 --> 00:27:00,240
from a user and so obvious but also for

589
00:26:56,280 --> 00:27:02,520
those publishers thanks to the telemetry

590
00:27:00,240 --> 00:27:06,480
of greeghan itself we look at what they

591
00:27:02,520 --> 00:27:08,580
had and we believe they were making some

592
00:27:06,480 --> 00:27:10,200
time 35 million clicks a day that mean

593
00:27:08,580 --> 00:27:12,300
that five million soldiers been thirty

594
00:27:10,200 --> 00:27:14,010
five million clicks some of them

595
00:27:12,300 --> 00:27:15,930
actually come from other channel as we

596
00:27:14,010 --> 00:27:17,700
mentioned those were legitimate apps so

597
00:27:15,930 --> 00:27:19,410
they may have like you know so Iceland

598
00:27:17,700 --> 00:27:20,310
might be the boutique and stuff at the

599
00:27:19,410 --> 00:27:22,200
move might be

600
00:27:20,310 --> 00:27:24,090
advertisement on the website or might be

601
00:27:22,200 --> 00:27:27,930
other stuff we're not sure so it's

602
00:27:24,090 --> 00:27:30,780
basically the volume way we saw in term

603
00:27:27,930 --> 00:27:33,420
of affected devices

604
00:27:30,780 --> 00:27:35,550
it's very standard in terms of phone

605
00:27:33,420 --> 00:27:38,040
makers the only thing to point out for

606
00:27:35,550 --> 00:27:41,180
people who are not familiar with Indian

607
00:27:38,040 --> 00:27:44,879
market Micromax is very very popular

608
00:27:41,180 --> 00:27:46,260
filmmaker both in India in Asia and so

609
00:27:44,880 --> 00:27:47,700
it's not surprising so it's a very

610
00:27:46,260 --> 00:27:52,980
normal distribution you would expect

611
00:27:47,700 --> 00:27:55,380
into emerging country and as we said the

612
00:27:52,980 --> 00:27:58,830
exploit heat only worked for Android 3

613
00:27:55,380 --> 00:28:00,870
and 4 so we only saw Android versions

614
00:27:58,830 --> 00:28:03,330
which were KitKat and jellybean they

615
00:28:00,870 --> 00:28:04,830
make up for everything we did found

616
00:28:03,330 --> 00:28:06,840
extra devices that we say which were

617
00:28:04,830 --> 00:28:09,360
like 5 and above thanks to the telemetry

618
00:28:06,840 --> 00:28:11,760
but they were not infected by by

619
00:28:09,360 --> 00:28:13,139
Corrigan itself in terms of the

620
00:28:11,760 --> 00:28:16,440
distribution of where those device come

621
00:28:13,140 --> 00:28:19,050
from 90% of those come from India and

622
00:28:16,440 --> 00:28:22,320
the top 8 country make up for 50% of the

623
00:28:19,050 --> 00:28:25,409
infections because Europe and North

624
00:28:22,320 --> 00:28:26,909
America have a more recent devices that

625
00:28:25,410 --> 00:28:30,360
were not so much affected so we

626
00:28:26,910 --> 00:28:33,780
basically they're mainly untouched so

627
00:28:30,360 --> 00:28:37,740
how do we clean up this to do this we

628
00:28:33,780 --> 00:28:39,060
had to do a two-pronged approach so

629
00:28:37,740 --> 00:28:40,890
first thing we have to do is work with

630
00:28:39,060 --> 00:28:42,210
third party including shadow server to

631
00:28:40,890 --> 00:28:44,280
be able to

632
00:28:42,210 --> 00:28:46,080
sinkholes the domain so we have is

633
00:28:44,280 --> 00:28:48,210
related the sample and then we work to

634
00:28:46,080 --> 00:28:50,580
make sure we had all the domains and we

635
00:28:48,210 --> 00:28:51,240
work to to make sure those domain were

636
00:28:50,580 --> 00:28:53,490
sinkhole

637
00:28:51,240 --> 00:28:56,060
so we prevent the acceleration of the

638
00:28:53,490 --> 00:28:58,730
token do remember here that we cannot

639
00:28:56,060 --> 00:29:02,340
for people who didn't have trusted boot

640
00:28:58,730 --> 00:29:03,690
asking them to do factories that would

641
00:29:02,340 --> 00:29:05,879
not have done anything because of the

642
00:29:03,690 --> 00:29:08,340
persistence mechanism so we had to have

643
00:29:05,880 --> 00:29:10,860
a way to prevent the filtration of the

644
00:29:08,340 --> 00:29:12,179
token because any other rumination

645
00:29:10,860 --> 00:29:14,340
mechanism on the valve would have failed

646
00:29:12,180 --> 00:29:17,640
so we first started to do this tech down

647
00:29:14,340 --> 00:29:19,290
and I we said it was during Thanksgiving

648
00:29:17,640 --> 00:29:23,640
week so a lot of people were out the

649
00:29:19,290 --> 00:29:25,080
silver able to work with major with all

650
00:29:23,640 --> 00:29:28,010
the people in Italy which would be

651
00:29:25,080 --> 00:29:31,560
involved including DNS sorry domain

652
00:29:28,010 --> 00:29:32,760
satyrs and shadow surveillance the

653
00:29:31,560 --> 00:29:34,889
people to actually come up with the

654
00:29:32,760 --> 00:29:37,410
strategy with sinkholes the domain was

655
00:29:34,890 --> 00:29:39,450
step one and the second step is we

656
00:29:37,410 --> 00:29:41,850
revoked all the tokens we had a little

657
00:29:39,450 --> 00:29:44,850
token effected so we basically for

658
00:29:41,850 --> 00:29:46,550
security measure remove all of them if

659
00:29:44,850 --> 00:29:49,320
you want to see the synchro deficiency

660
00:29:46,550 --> 00:29:51,659
this validate why it was so important

661
00:29:49,320 --> 00:29:56,100
over the last year we blocked over 15

662
00:29:51,660 --> 00:29:57,720
million attempt of token expressions it

663
00:29:56,100 --> 00:29:59,340
doesn't mean there is 50 million people

664
00:29:57,720 --> 00:30:00,720
infected by query can just means that

665
00:29:59,340 --> 00:30:03,120
those device members had been wake up

666
00:30:00,720 --> 00:30:04,710
and then they would send it again and

667
00:30:03,120 --> 00:30:07,290
people can't really remove it because

668
00:30:04,710 --> 00:30:09,510
doctor is that so they know by just just

669
00:30:07,290 --> 00:30:13,710
decided that they would keep the phone

670
00:30:09,510 --> 00:30:16,140
anyway and so about 50 millions of those

671
00:30:13,710 --> 00:30:18,000
token have been stopped and as the

672
00:30:16,140 --> 00:30:23,400
distribution matched very closely the

673
00:30:18,000 --> 00:30:28,170
one we observed from the initial wave we

674
00:30:23,400 --> 00:30:29,670
also had a huge sweat in in March when

675
00:30:28,170 --> 00:30:31,710
we look at the temperature sinkhole we

676
00:30:29,670 --> 00:30:34,740
see this you jump and you're like oh my

677
00:30:31,710 --> 00:30:37,020
god something is happening coolican is

678
00:30:34,740 --> 00:30:39,150
back and they're like 100,000 minion

679
00:30:37,020 --> 00:30:41,040
token exercises per day what happens

680
00:30:39,150 --> 00:30:42,960
just as the synchrony annulled it was

681
00:30:41,040 --> 00:30:45,120
changed by shadow server and so in

682
00:30:42,960 --> 00:30:48,060
reality stayed active but this is just

683
00:30:45,120 --> 00:30:49,800
blocks with effective at the moment one

684
00:30:48,060 --> 00:30:51,179
thing we want to point out and that's

685
00:30:49,800 --> 00:30:52,889
very important for people who reach out

686
00:30:51,180 --> 00:30:55,200
to us or if you reach out when it is a

687
00:30:52,890 --> 00:30:57,389
big company try to honest

688
00:30:55,200 --> 00:31:00,120
that when we try to notify our user it's

689
00:30:57,389 --> 00:31:02,340
very difficult when you have 2 1 million

690
00:31:00,120 --> 00:31:03,629
people that they've been in fact that

691
00:31:02,340 --> 00:31:06,059
you have to make sure aids in their

692
00:31:03,630 --> 00:31:08,070
language and be you able to reach so

693
00:31:06,059 --> 00:31:10,529
reaching out user is not that easy we

694
00:31:08,070 --> 00:31:12,840
use the combination of a notification

695
00:31:10,529 --> 00:31:15,840
unfold sending an email to the account

696
00:31:12,840 --> 00:31:18,389
or sending an SMS and we had to

697
00:31:15,840 --> 00:31:20,760
translate of course the notification in

698
00:31:18,389 --> 00:31:22,049
many many languages as well as the

699
00:31:20,760 --> 00:31:24,000
support page because people will be

700
00:31:22,049 --> 00:31:25,590
concerned and you don't want to create

701
00:31:24,000 --> 00:31:26,909
panic you want to say to people hey we

702
00:31:25,590 --> 00:31:29,730
know about this your account has been

703
00:31:26,909 --> 00:31:31,440
compromised it is ok here is what

704
00:31:29,730 --> 00:31:33,210
happened she's what you can do here's

705
00:31:31,440 --> 00:31:33,990
what's not going to work and she's what

706
00:31:33,210 --> 00:31:36,510
you should do

707
00:31:33,990 --> 00:31:40,470
and so the notification of the user is

708
00:31:36,510 --> 00:31:41,820
forced to hide the sport of the as a

709
00:31:40,470 --> 00:31:43,409
takedown it's not like the technical

710
00:31:41,820 --> 00:31:44,820
means when you work with people who

711
00:31:43,409 --> 00:31:47,580
knows about botnet and are very

712
00:31:44,820 --> 00:31:50,090
efficient it's very in a way easy

713
00:31:47,580 --> 00:31:52,710
because you work for Hmong peers

714
00:31:50,090 --> 00:31:54,629
notifying user at scare has been a huge

715
00:31:52,710 --> 00:31:57,029
challenge and making sure that people

716
00:31:54,630 --> 00:32:00,779
understand and conduct proper decision

717
00:31:57,029 --> 00:32:02,490
was very important so take away about

718
00:32:00,779 --> 00:32:06,630
this investigation

719
00:32:02,490 --> 00:32:09,029
a if you haven't the main takeaway for

720
00:32:06,630 --> 00:32:11,610
you guys who work on botnet is we

721
00:32:09,029 --> 00:32:12,899
believe old baseball net is an emerging

722
00:32:11,610 --> 00:32:14,519
threat and you're going to see more of

723
00:32:12,899 --> 00:32:17,129
those so if you don't know what old is

724
00:32:14,519 --> 00:32:19,740
you should look at it will expect it to

725
00:32:17,130 --> 00:32:22,230
also target additional services for all

726
00:32:19,740 --> 00:32:24,659
the reason a lot of people use old now

727
00:32:22,230 --> 00:32:26,130
to delegate access password less access

728
00:32:24,659 --> 00:32:28,080
to the app so if you have an app to do

729
00:32:26,130 --> 00:32:32,190
that you should be careful about it

730
00:32:28,080 --> 00:32:33,178
because what happened second is and we

731
00:32:32,190 --> 00:32:34,950
know that the first time we do it

732
00:32:33,179 --> 00:32:36,750
publicly on record but we love to

733
00:32:34,950 --> 00:32:38,820
collaborate with everyone so if you are

734
00:32:36,750 --> 00:32:40,950
aware of the botnet on Android or

735
00:32:38,820 --> 00:32:43,350
malware or chosen banking on Android and

736
00:32:40,950 --> 00:32:45,210
you want to talk to us or on desktop or

737
00:32:43,350 --> 00:32:47,549
on anything please come and work with us

738
00:32:45,210 --> 00:32:49,289
we love to collaborate security is the

739
00:32:47,549 --> 00:32:51,450
responsibility of all of us and there is

740
00:32:49,289 --> 00:32:54,200
no way one company can secure the

741
00:32:51,450 --> 00:32:56,549
Internet but at least we can so please

742
00:32:54,200 --> 00:32:59,279
reach out anytime you want

743
00:32:56,549 --> 00:33:01,168
and finally we really grateful of

744
00:32:59,279 --> 00:33:02,730
everyone who work with checkpoint and

745
00:33:01,169 --> 00:33:05,399
Google to help us to do the takedown

746
00:33:02,730 --> 00:33:06,779
very efficiently there are people which

747
00:33:05,399 --> 00:33:07,780
are not there today but really

748
00:33:06,779 --> 00:33:10,330
participated

749
00:33:07,780 --> 00:33:11,860
helped including shadow server very

750
00:33:10,330 --> 00:33:17,620
active people Avengers Thanksgiving

751
00:33:11,860 --> 00:33:19,000
works so we hope you enjoy joke and

752
00:33:17,620 --> 00:33:21,659
we're going to take a question but we're

753
00:33:19,000 --> 00:33:21,660
going to take them offline

754
00:33:26,710 --> 00:33:33,869
[Music]

