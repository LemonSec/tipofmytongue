1
00:00:02,000 --> 00:00:05,040
let's be fair yeah it's on

2
00:00:05,040 --> 00:00:05,920
okay

3
00:00:05,920 --> 00:00:07,839
so the goal here is to present a use

4
00:00:07,839 --> 00:00:09,280
case um

5
00:00:09,280 --> 00:00:11,759
based on the conference of yesterday on

6
00:00:11,759 --> 00:00:14,799
cubot on how to find the devices which

7
00:00:14,799 --> 00:00:18,720
have a upl.php file exposed

8
00:00:18,720 --> 00:00:20,560
only if my company is doing internet

9
00:00:20,560 --> 00:00:21,920
scanning

10
00:00:21,920 --> 00:00:23,199
200

11
00:00:23,199 --> 00:00:26,560
ports scan monthly and we also scan urls

12
00:00:26,560 --> 00:00:27,920
and you will see this is really the

13
00:00:27,920 --> 00:00:31,359
interesting part here we scan 300

14
00:00:31,359 --> 00:00:33,120
million euros per month

15
00:00:33,120 --> 00:00:35,120
and growing and we do tagging and

16
00:00:35,120 --> 00:00:37,920
classification classification of

17
00:00:37,920 --> 00:00:39,040
devices

18
00:00:39,040 --> 00:00:41,120
the detection here is based on finding

19
00:00:41,120 --> 00:00:42,960
open web directories and being able of

20
00:00:42,960 --> 00:00:44,800
course to to find

21
00:00:44,800 --> 00:00:46,719
file names exposed

22
00:00:46,719 --> 00:00:49,440
uh if we do a search for the last seven

23
00:00:49,440 --> 00:00:51,120
months of data because we store seven

24
00:00:51,120 --> 00:00:52,480
months of data

25
00:00:52,480 --> 00:00:54,800
uh there is more than eleven thousand

26
00:00:54,800 --> 00:00:57,120
devices which have a upl.php file

27
00:00:57,120 --> 00:00:59,680
exposed

28
00:00:59,680 --> 00:01:01,280
you can query it from the command line

29
00:01:01,280 --> 00:01:02,719
there is an open source tool for that

30
00:01:02,719 --> 00:01:05,600
with a splunk like syntax and the id

31
00:01:05,600 --> 00:01:07,680
here is to find the number of unique

32
00:01:07,680 --> 00:01:10,400
hostnames which are exposing upload php

33
00:01:10,400 --> 00:01:14,799
file so let's show the demo

34
00:01:14,799 --> 00:01:16,640
okay

35
00:01:16,640 --> 00:01:19,439
auto is there

36
00:01:20,400 --> 00:01:23,200
pop okay so

37
00:01:23,200 --> 00:01:25,920
the command line is running and it will

38
00:01:25,920 --> 00:01:28,240
just spit out the numbers the name of

39
00:01:28,240 --> 00:01:30,720
the unicos names which are exposed with

40
00:01:30,720 --> 00:01:33,280
a upl.php file

41
00:01:33,280 --> 00:01:35,520
uh in fact it will spit out for two

42
00:01:35,520 --> 00:01:37,759
minutes so i will have to

43
00:01:37,759 --> 00:01:39,280
to cut it at some point because i don't

44
00:01:39,280 --> 00:01:41,200
have two minutes

45
00:01:41,200 --> 00:01:43,280
but yeah

46
00:01:43,280 --> 00:01:46,880
that's the the idea here

47
00:01:47,520 --> 00:01:49,840
in the end it's more than ten thousand

48
00:01:49,840 --> 00:01:53,520
unique house names with this query

49
00:01:53,520 --> 00:01:55,759
the next question is how many of them

50
00:01:55,759 --> 00:01:58,240
are compromised well having a upload php

51
00:01:58,240 --> 00:02:01,759
is already a by size but sign of course

52
00:02:01,759 --> 00:02:03,439
with the splunk like syntax we can do

53
00:02:03,439 --> 00:02:05,040
correlation

54
00:02:05,040 --> 00:02:07,439
we extract in fact the list of ip

55
00:02:07,439 --> 00:02:09,598
addresses hosting the file we dedupe the

56
00:02:09,598 --> 00:02:12,640
ip address and we run a second search

57
00:02:12,640 --> 00:02:15,280
adding the tag compromise stating the

58
00:02:15,280 --> 00:02:18,480
device has been compromised and again we

59
00:02:18,480 --> 00:02:21,120
research the unique number of hostname

60
00:02:21,120 --> 00:02:25,959
in the end is more than 1600

61
00:02:26,000 --> 00:02:28,879
unicos names which have been found

62
00:02:28,879 --> 00:02:30,800
but well we should consider all of them

63
00:02:30,800 --> 00:02:32,080
as compromised

64
00:02:32,080 --> 00:02:34,160
how do we detect simple pattern matching

65
00:02:34,160 --> 00:02:36,720
in html content and some other

66
00:02:36,720 --> 00:02:38,080
heuristics

67
00:02:38,080 --> 00:02:41,440
for example just one ip address

68
00:02:41,440 --> 00:02:43,920
and you see it has been hacked by bomber

69
00:02:43,920 --> 00:02:48,000
cyber army indus tech well this is a

70
00:02:48,000 --> 00:02:49,760
compromised device

71
00:02:49,760 --> 00:02:52,080
thank you

72
00:02:52,080 --> 00:02:54,480
thank you

73
00:02:58,879 --> 00:03:03,319
okay thank you next speaker

74
00:03:09,040 --> 00:03:12,560
and the video is still running

75
00:03:12,879 --> 00:03:16,518
can you stop me

76
00:03:31,360 --> 00:03:34,159
well hi everybody um

77
00:03:34,159 --> 00:03:35,920
sorry i couldn't come up with a better

78
00:03:35,920 --> 00:03:39,599
title so i stole this tweet from 2015

79
00:03:39,599 --> 00:03:43,120
after my lightning talk that i gave

80
00:03:43,120 --> 00:03:46,480
so i just took that as a title

81
00:03:46,480 --> 00:03:46,790
um

82
00:03:46,790 --> 00:03:48,000
[Music]

83
00:03:48,000 --> 00:03:50,879
this is my huma who am i slight so for

84
00:03:50,879 --> 00:03:53,439
those who maybe attend their first the

85
00:03:53,439 --> 00:03:55,120
first podcast here

86
00:03:55,120 --> 00:03:56,879
who haven't seen me speaking

87
00:03:56,879 --> 00:03:58,640
actually i need to update that slide

88
00:03:58,640 --> 00:04:00,640
pretty soon because in a couple months

89
00:04:00,640 --> 00:04:02,159
i'll be working

90
00:04:02,159 --> 00:04:05,680
for swiss post for uh 15 years

91
00:04:05,680 --> 00:04:06,959
and

92
00:04:06,959 --> 00:04:08,799
why am i still working at swisspost

93
00:04:08,799 --> 00:04:10,640
because as you can see on the slide i

94
00:04:10,640 --> 00:04:12,879
can pretty much do what i like to do and

95
00:04:12,879 --> 00:04:14,959
what i enjoy doing

96
00:04:14,959 --> 00:04:17,680
and another reason is because i can

97
00:04:17,680 --> 00:04:19,519
attend every bot conf i've been to

98
00:04:19,519 --> 00:04:22,240
everybody conf and i can talk about

99
00:04:22,240 --> 00:04:25,120
whatever i like whatever i want to share

100
00:04:25,120 --> 00:04:27,440
so for the first couple of editions i've

101
00:04:27,440 --> 00:04:29,680
been talking about palma cup malware

102
00:04:29,680 --> 00:04:32,240
about net

103
00:04:32,720 --> 00:04:34,880
i've been talking about sysmon for a few

104
00:04:34,880 --> 00:04:36,160
years

105
00:04:36,160 --> 00:04:38,240
and giving a few lightning talks in

106
00:04:38,240 --> 00:04:40,720
between and then the last year i was

107
00:04:40,720 --> 00:04:43,840
talking about desktop group

108
00:04:44,000 --> 00:04:46,160
and this is actually a slide from the

109
00:04:46,160 --> 00:04:49,040
latest desktop group presentation so

110
00:04:49,040 --> 00:04:51,600
basically it's showing a pattern i talk

111
00:04:51,600 --> 00:04:52,560
uh

112
00:04:52,560 --> 00:04:54,960
a couple bot columns about the topic and

113
00:04:54,960 --> 00:04:57,759
then like two three years later some

114
00:04:57,759 --> 00:05:00,080
cool company comes out with a report and

115
00:05:00,080 --> 00:05:02,960
like wow they have so much more insight

116
00:05:02,960 --> 00:05:05,440
and i can show so much more what's going

117
00:05:05,440 --> 00:05:07,919
on behind the scenes that i didn't

118
00:05:07,919 --> 00:05:10,479
get access or i didn't have the data

119
00:05:10,479 --> 00:05:13,039
for anything

120
00:05:13,199 --> 00:05:14,080
so

121
00:05:14,080 --> 00:05:16,160
earlier this year i finally got around

122
00:05:16,160 --> 00:05:18,479
to put out a blog post

123
00:05:18,479 --> 00:05:21,199
basically just linking everything

124
00:05:21,199 --> 00:05:24,160
publicly available about desktop group

125
00:05:24,160 --> 00:05:27,039
and also linking a

126
00:05:27,039 --> 00:05:29,039
link to my

127
00:05:29,039 --> 00:05:30,720
invitation google group for

128
00:05:30,720 --> 00:05:32,880
collaboration

129
00:05:32,880 --> 00:05:35,680
here a little bit bigger so basically in

130
00:05:35,680 --> 00:05:38,000
2018 about over four years ago we

131
00:05:38,000 --> 00:05:39,840
started tracking desktop group at twist

132
00:05:39,840 --> 00:05:40,960
post

133
00:05:40,960 --> 00:05:45,360
in 2019 the first spot conf talk in 2020

134
00:05:45,360 --> 00:05:48,160
i was giving an online talk at reversing

135
00:05:48,160 --> 00:05:50,080
and in 2021

136
00:05:50,080 --> 00:05:52,240
group ib and orange cert prepared a

137
00:05:52,240 --> 00:05:54,000
really great thread report but

138
00:05:54,000 --> 00:05:56,160
unfortunately it cannot be published yet

139
00:05:56,160 --> 00:05:57,280
so

140
00:05:57,280 --> 00:05:59,520
i'm waiting for that and then earlier

141
00:05:59,520 --> 00:06:02,240
this year swift added desktop group as

142
00:06:02,240 --> 00:06:04,319
an alias to a thread actor that they

143
00:06:04,319 --> 00:06:07,039
track and publish

144
00:06:07,039 --> 00:06:08,319
so um

145
00:06:08,319 --> 00:06:10,800
as you see uh the pattern i'm talking

146
00:06:10,800 --> 00:06:12,960
about desktop group for a couple years

147
00:06:12,960 --> 00:06:15,360
and then a really great report gets

148
00:06:15,360 --> 00:06:17,280
written but it's not published yet so

149
00:06:17,280 --> 00:06:19,039
i'm really waiting

150
00:06:19,039 --> 00:06:21,199
that it comes out and

151
00:06:21,199 --> 00:06:24,000
it will be quite quite good and actually

152
00:06:24,000 --> 00:06:25,360
one of the later

153
00:06:25,360 --> 00:06:27,759
uh lightning talks we'll talk about a

154
00:06:27,759 --> 00:06:30,080
different topic about that subgroup so

155
00:06:30,080 --> 00:06:32,479
looking forward to that you go

156
00:06:32,479 --> 00:06:34,400
time's up and that's it thank you oh

157
00:06:34,400 --> 00:06:37,638
good timing

158
00:06:52,240 --> 00:06:55,240
is

159
00:07:03,440 --> 00:07:06,759
that's interesting

160
00:07:28,840 --> 00:07:32,919
okay um

161
00:07:56,720 --> 00:07:59,440
hey everyone um my name is ivan i work

162
00:07:59,440 --> 00:08:02,000
for kaspersky and this presentation is

163
00:08:02,000 --> 00:08:03,759
obviously supported 100

164
00:08:03,759 --> 00:08:05,199
by my employer and everything i say

165
00:08:05,199 --> 00:08:08,160
represent their position on the subject

166
00:08:08,160 --> 00:08:09,280
so

167
00:08:09,280 --> 00:08:11,440
one thing i've been doing for a while is

168
00:08:11,440 --> 00:08:13,039
every time i see promoted content on

169
00:08:13,039 --> 00:08:15,599
twitter i would block the person that

170
00:08:15,599 --> 00:08:17,199
the account from which this content

171
00:08:17,199 --> 00:08:18,639
originates from this is just because i

172
00:08:18,639 --> 00:08:20,479
don't like advertising like every normal

173
00:08:20,479 --> 00:08:21,520
person

174
00:08:21,520 --> 00:08:24,960
and in 2018 i actually shared my blog

175
00:08:24,960 --> 00:08:26,639
list on twitter

176
00:08:26,639 --> 00:08:28,720
and i expected people would share their

177
00:08:28,720 --> 00:08:30,400
own as well and would merge them and get

178
00:08:30,400 --> 00:08:32,000
like a twitter free

179
00:08:32,000 --> 00:08:34,320
an advertising free twitter environment

180
00:08:34,320 --> 00:08:36,320
so i didn't never get any pr any pull

181
00:08:36,320 --> 00:08:38,479
requests but some people used it which

182
00:08:38,479 --> 00:08:41,039
was pretty cool

183
00:08:41,039 --> 00:08:43,200
and yeah i kind of forgot about it until

184
00:08:43,200 --> 00:08:45,120
recently

185
00:08:45,120 --> 00:08:47,440
a conversation on twitter showed to me

186
00:08:47,440 --> 00:08:48,880
that a number of people were doing the

187
00:08:48,880 --> 00:08:50,800
same and it kind of reignited my

188
00:08:50,800 --> 00:08:53,279
interest in crowdsourcing the global

189
00:08:53,279 --> 00:08:54,959
destruction of

190
00:08:54,959 --> 00:08:56,720
advertisers on twitter and forth

191
00:08:56,720 --> 00:08:58,560
bringing the destruction of twitter's

192
00:08:58,560 --> 00:08:59,839
business model

193
00:08:59,839 --> 00:09:01,680
the issue is

194
00:09:01,680 --> 00:09:04,399
since the new design that was released i

195
00:09:04,399 --> 00:09:07,680
think probably around 2019 or 2020 the

196
00:09:07,680 --> 00:09:09,600
feature that allowed you to export block

197
00:09:09,600 --> 00:09:11,920
lists in csv or import them was actually

198
00:09:11,920 --> 00:09:13,279
removed which kind of makes sense

199
00:09:13,279 --> 00:09:14,560
because twitter really really doesn't

200
00:09:14,560 --> 00:09:16,560
want doing this

201
00:09:16,560 --> 00:09:18,560
so where is the feature to export block

202
00:09:18,560 --> 00:09:20,240
lists not there anymore

203
00:09:20,240 --> 00:09:22,880
and if you deep dive dive deep enough in

204
00:09:22,880 --> 00:09:23,600
the

205
00:09:23,600 --> 00:09:25,519
the documentation you will find that you

206
00:09:25,519 --> 00:09:27,440
know they admit that they kind of took

207
00:09:27,440 --> 00:09:29,120
this away and now if you want to do the

208
00:09:29,120 --> 00:09:31,120
same thing then what you should do is do

209
00:09:31,120 --> 00:09:33,440
a gdpr request get your data and then

210
00:09:33,440 --> 00:09:35,120
you will find it uh somewhere else so i

211
00:09:35,120 --> 00:09:36,480
was like okay fine

212
00:09:36,480 --> 00:09:38,480
let's jdpr

213
00:09:38,480 --> 00:09:39,360
um

214
00:09:39,360 --> 00:09:41,279
so it turns out that yeah you do get

215
00:09:41,279 --> 00:09:43,120
your block list that way it's not json

216
00:09:43,120 --> 00:09:45,040
format it's kind of weird to parse but

217
00:09:45,040 --> 00:09:46,959
you can do it but also looking at the

218
00:09:46,959 --> 00:09:49,120
data it also turns out that you have a

219
00:09:49,120 --> 00:09:51,839
file called personalization.js where you

220
00:09:51,839 --> 00:09:53,680
get this very interesting list like it's

221
00:09:53,680 --> 00:09:56,080
about a list of 750 accounts for me at

222
00:09:56,080 --> 00:09:56,959
least

223
00:09:56,959 --> 00:09:58,959
that are like accounts that twitter

224
00:09:58,959 --> 00:10:00,800
thinks i might be interested in seeing

225
00:10:00,800 --> 00:10:02,640
promoted content from so i'm like okay

226
00:10:02,640 --> 00:10:04,320
that's interesting maybe i should just

227
00:10:04,320 --> 00:10:06,480
block them preemptively right

228
00:10:06,480 --> 00:10:07,519
so

229
00:10:07,519 --> 00:10:08,720
what i did

230
00:10:08,720 --> 00:10:10,720
since of course we cannot import block

231
00:10:10,720 --> 00:10:12,320
list anymore you can only export them or

232
00:10:12,320 --> 00:10:14,160
get access to them what i did i created

233
00:10:14,160 --> 00:10:15,600
a twitter script

234
00:10:15,600 --> 00:10:17,600
that allows you to export and import

235
00:10:17,600 --> 00:10:20,160
block list using the twitter api and my

236
00:10:20,160 --> 00:10:22,000
suggestion is that you kind of use it

237
00:10:22,000 --> 00:10:23,360
you'll need to get api keys but it's

238
00:10:23,360 --> 00:10:25,040
kind of doable

239
00:10:25,040 --> 00:10:28,079
you do this send me a pr you import my

240
00:10:28,079 --> 00:10:29,600
blog list to your account and then you

241
00:10:29,600 --> 00:10:32,880
know everyone lives happily ever after

242
00:10:32,880 --> 00:10:33,839
but

243
00:10:33,839 --> 00:10:35,600
it could actually be better and what i'm

244
00:10:35,600 --> 00:10:37,839
talking about is what i would like to do

245
00:10:37,839 --> 00:10:40,160
is actually create a web app because

246
00:10:40,160 --> 00:10:41,839
getting keys is a bit annoying so you

247
00:10:41,839 --> 00:10:44,240
just go to a web page click login with

248
00:10:44,240 --> 00:10:46,240
twitter and then i would steal your

249
00:10:46,240 --> 00:10:48,160
block list you would get mine for free i

250
00:10:48,160 --> 00:10:50,800
would merge them manually and yeah every

251
00:10:50,800 --> 00:10:52,399
time there's an update you would get it

252
00:10:52,399 --> 00:10:53,360
and

253
00:10:53,360 --> 00:10:54,560
the reason why i'm not going to do it

254
00:10:54,560 --> 00:10:56,320
right now is that i think this is what's

255
00:10:56,320 --> 00:10:58,959
going to happen thank you very much

256
00:10:58,959 --> 00:11:01,839
thank you

257
00:11:10,640 --> 00:11:12,160
thank you

258
00:11:12,160 --> 00:11:13,839
so maybe he'll get some time for the

259
00:11:13,839 --> 00:11:15,760
demo

260
00:11:15,760 --> 00:11:18,480
if he's nice

261
00:11:24,079 --> 00:11:27,040
oh yeah i i haven't got yours okay so

262
00:11:27,040 --> 00:11:29,040
we're moving to number five and i'll get

263
00:11:29,040 --> 00:11:32,000
you just after

264
00:11:39,680 --> 00:11:42,720
there you go

265
00:11:42,720 --> 00:11:45,600
yay hello everyone so i'm remy from los

266
00:11:45,600 --> 00:11:48,720
atmos long and today i'm i'm just

267
00:11:48,720 --> 00:11:51,600
disconnected like every other french

268
00:11:51,600 --> 00:11:55,760
about beauty so let's find out why so uh

269
00:11:55,760 --> 00:11:58,079
i'm a developer so the standard

270
00:11:58,079 --> 00:12:01,040
application 3r model is very simple your

271
00:12:01,040 --> 00:12:03,839
view controller model and then you have

272
00:12:03,839 --> 00:12:06,240
the client that requests the app and

273
00:12:06,240 --> 00:12:09,120
then you have the dba request

274
00:12:09,120 --> 00:12:11,839
so uh you have the http call then the

275
00:12:11,839 --> 00:12:14,880
controller then the api more db stuff

276
00:12:14,880 --> 00:12:19,040
and it get backs the json or ml file and

277
00:12:19,040 --> 00:12:22,079
converts it to html

278
00:12:22,079 --> 00:12:23,839
then why

279
00:12:23,839 --> 00:12:27,440
do we have some quota for the request

280
00:12:27,440 --> 00:12:30,880
api and it's not available in the web

281
00:12:30,880 --> 00:12:32,880
july because

282
00:12:32,880 --> 00:12:35,440
you talk to the controller and it's

283
00:12:35,440 --> 00:12:38,959
supposed to go to the api so

284
00:12:38,959 --> 00:12:40,240
know what

285
00:12:40,240 --> 00:12:42,720
what do you have to do so

286
00:12:42,720 --> 00:12:44,720
i could clone the

287
00:12:44,720 --> 00:12:48,480
web gui and make the controller myself

288
00:12:48,480 --> 00:12:52,000
using the api or maybe someone in the

289
00:12:52,000 --> 00:12:53,120
assembly

290
00:12:53,120 --> 00:12:54,240
have

291
00:12:54,240 --> 00:12:56,880
something like that so if you are

292
00:12:56,880 --> 00:13:00,160
interested to contribute or

293
00:13:00,160 --> 00:13:01,519
you have it

294
00:13:01,519 --> 00:13:04,160
please contact me thank you

295
00:13:04,160 --> 00:13:07,399
thank you

296
00:13:10,720 --> 00:13:15,240
so i'm going to download an email

297
00:13:27,839 --> 00:13:31,240
just a second

298
00:13:35,600 --> 00:13:36,290
austin

299
00:13:36,290 --> 00:13:39,360
[Music]

300
00:13:39,440 --> 00:13:44,000
should we care about formula injection

301
00:13:47,760 --> 00:13:51,199
is that steroids or

302
00:13:51,360 --> 00:13:54,360
people

303
00:14:02,000 --> 00:14:05,040
okay this should work

304
00:14:13,199 --> 00:14:16,760
there you go

305
00:14:26,000 --> 00:14:27,519
all right hello everyone my name is

306
00:14:27,519 --> 00:14:29,279
austin terczyk

307
00:14:29,279 --> 00:14:30,800
so while i'm not doing stuff with into a

308
00:14:30,800 --> 00:14:32,399
steelers and malware's i do a lot with

309
00:14:32,399 --> 00:14:34,800
about web application bug hunting so

310
00:14:34,800 --> 00:14:36,160
this brings up the question should we

311
00:14:36,160 --> 00:14:38,240
actually care about formula injections

312
00:14:38,240 --> 00:14:39,600
before we actually talk about whether or

313
00:14:39,600 --> 00:14:41,199
not we should care let's talk about what

314
00:14:41,199 --> 00:14:43,760
it is um according to osp it's a csv

315
00:14:43,760 --> 00:14:45,680
injection and it occurs when a website

316
00:14:45,680 --> 00:14:48,800
embeds untrusted input into csv files

317
00:14:48,800 --> 00:14:51,199
now this doesn't bother much for a csv

318
00:14:51,199 --> 00:14:52,959
file but when it opened in excel or

319
00:14:52,959 --> 00:14:54,800
whatnot it can be a problem so let's

320
00:14:54,800 --> 00:14:55,680
talk about what are some of the

321
00:14:55,680 --> 00:14:58,000
potential impacts first off we have data

322
00:14:58,000 --> 00:14:59,519
x filtration

323
00:14:59,519 --> 00:15:01,279
given that we can put in formulas we can

324
00:15:01,279 --> 00:15:03,360
easily start pulling out data worst case

325
00:15:03,360 --> 00:15:04,800
scenario however it comes to things like

326
00:15:04,800 --> 00:15:06,639
data manipulation and remote code

327
00:15:06,639 --> 00:15:08,880
execution we can leverage public

328
00:15:08,880 --> 00:15:10,079
public

329
00:15:10,079 --> 00:15:11,519
exploits as well as in windows

330
00:15:11,519 --> 00:15:14,639
environments dynamic data exchanges

331
00:15:14,639 --> 00:15:16,320
what's even worse we can also manipulate

332
00:15:16,320 --> 00:15:20,320
data a lot of csv files are used as a

333
00:15:20,320 --> 00:15:22,399
as logging in some situations and when

334
00:15:22,399 --> 00:15:23,839
opened in the wrong tools that can be

335
00:15:23,839 --> 00:15:26,000
problematic so should we care about

336
00:15:26,000 --> 00:15:28,160
these yes i'm not just saying this is

337
00:15:28,160 --> 00:15:29,440
somebody who's lost a lot of money in

338
00:15:29,440 --> 00:15:30,720
bug bounty programs because these

339
00:15:30,720 --> 00:15:33,279
weren't considered valid

340
00:15:33,279 --> 00:15:34,560
let's talk about some of the excuses

341
00:15:34,560 --> 00:15:36,399
i've seen in the past and why i don't

342
00:15:36,399 --> 00:15:37,759
think they're that good

343
00:15:37,759 --> 00:15:39,680
i really see this as an excel flaw feels

344
00:15:39,680 --> 00:15:41,519
like a cheap cop-out because i feel like

345
00:15:41,519 --> 00:15:43,199
an xss that only affects internet

346
00:15:43,199 --> 00:15:45,440
explorer mozilla firefox is just as much

347
00:15:45,440 --> 00:15:47,199
of an issue but developers don't feel

348
00:15:47,199 --> 00:15:49,279
bad about fixing those

349
00:15:49,279 --> 00:15:51,040
essential another one this is

350
00:15:51,040 --> 00:15:52,160
effectively something that can be

351
00:15:52,160 --> 00:15:53,600
duplicated by emailing someone a

352
00:15:53,600 --> 00:15:56,399
malicious csv again very true

353
00:15:56,399 --> 00:15:57,600
big difference here though is that

354
00:15:57,600 --> 00:15:58,959
they're using an application they can

355
00:15:58,959 --> 00:16:00,800
trust imagine if every time they opened

356
00:16:00,800 --> 00:16:02,560
a tool that they use every day it just

357
00:16:02,560 --> 00:16:04,720
downloaded malware

358
00:16:04,720 --> 00:16:06,160
none of us windows users know what

359
00:16:06,160 --> 00:16:09,279
that's like um following that client's

360
00:16:09,279 --> 00:16:10,639
reading is csv and interpreting the

361
00:16:10,639 --> 00:16:12,240
content as commands are misinterpreting

362
00:16:12,240 --> 00:16:14,720
the file format i absolutely agree

363
00:16:14,720 --> 00:16:16,800
csv files should just be a flat text

364
00:16:16,800 --> 00:16:19,360
file unfortunately microsoft apple and

365
00:16:19,360 --> 00:16:20,959
some versions of linux have decided that

366
00:16:20,959 --> 00:16:22,800
whenever we want to open up a csv file

367
00:16:22,800 --> 00:16:24,800
we get to use their fund libre tool or

368
00:16:24,800 --> 00:16:27,600
we get to use microsoft office

369
00:16:27,600 --> 00:16:29,040
and we have to make a lot of changes if

370
00:16:29,040 --> 00:16:30,880
we don't want to and finally any

371
00:16:30,880 --> 00:16:32,800
mitigation mitigation on our back end

372
00:16:32,800 --> 00:16:34,160
would be it would have a limited

373
00:16:34,160 --> 00:16:35,519
effectiveness and would force us to

374
00:16:35,519 --> 00:16:37,040
modify the data this would break the

375
00:16:37,040 --> 00:16:38,880
workflow for users manipulating the csv

376
00:16:38,880 --> 00:16:40,880
files with safe software this is one i

377
00:16:40,880 --> 00:16:42,480
got recently

378
00:16:42,480 --> 00:16:44,399
and again i stand that in any other

379
00:16:44,399 --> 00:16:46,560
situation you don't really we wouldn't

380
00:16:46,560 --> 00:16:48,320
really care about breaking the workflow

381
00:16:48,320 --> 00:16:50,480
i've never met an admin who was

382
00:16:50,480 --> 00:16:52,000
unwilling to update a cross-site

383
00:16:52,000 --> 00:16:54,000
scripting or an sql injection simply

384
00:16:54,000 --> 00:16:56,800
because it would break the workflow

385
00:16:56,800 --> 00:16:58,000
so

386
00:16:58,000 --> 00:16:59,360
i wouldn't get up here and say that we

387
00:16:59,360 --> 00:17:01,040
should actually do something about these

388
00:17:01,040 --> 00:17:02,720
without talking about the mitigations

389
00:17:02,720 --> 00:17:04,160
easiest way is remove those first

390
00:17:04,160 --> 00:17:06,079
characters um

391
00:17:06,079 --> 00:17:08,160
we can also look at owasp's

392
00:17:08,160 --> 00:17:10,079
recommendations for more thorough and if

393
00:17:10,079 --> 00:17:11,520
you're not going to fix it at least tell

394
00:17:11,520 --> 00:17:13,359
your uh users that there's a potential

395
00:17:13,359 --> 00:17:15,199
vulnerability that could allow them to

396
00:17:15,199 --> 00:17:16,400
they could allow threat actors to

397
00:17:16,400 --> 00:17:18,720
install malware through their

398
00:17:18,720 --> 00:17:20,400
trusted applications

399
00:17:20,400 --> 00:17:21,760
so the last six seconds you have

400
00:17:21,760 --> 00:17:22,959
questions comments concerns your

401
00:17:22,959 --> 00:17:24,160
developer who wants to yell at me

402
00:17:24,160 --> 00:17:25,199
because you're now going to get these

403
00:17:25,199 --> 00:17:26,720
vulnerabilities feel free to message me

404
00:17:26,720 --> 00:17:28,559
on any of these things thank you thank

405
00:17:28,559 --> 00:17:31,559
you

406
00:17:34,880 --> 00:17:39,799
okay now we're back to number six

407
00:17:46,799 --> 00:17:47,840
okay

408
00:17:47,840 --> 00:17:50,720
there we go number six because max it's

409
00:17:50,720 --> 00:17:54,440
max okay

410
00:18:04,960 --> 00:18:06,799
almost

411
00:18:06,799 --> 00:18:10,520
it does on the beamer

412
00:18:15,200 --> 00:18:20,200
it's this thing stupid thing

413
00:18:29,760 --> 00:18:31,520
better

414
00:18:31,520 --> 00:18:34,000
you got it

415
00:18:39,280 --> 00:18:41,760
thank you oh that should be the begin

416
00:18:41,760 --> 00:18:43,840
for this evening i figured third time on

417
00:18:43,840 --> 00:18:46,000
stage would give me access to eric's

418
00:18:46,000 --> 00:18:48,480
computer

419
00:18:48,720 --> 00:18:50,960
thank you

420
00:18:50,960 --> 00:18:53,120
so i wanted to talk about my binary

421
00:18:53,120 --> 00:18:54,559
analysis course

422
00:18:54,559 --> 00:18:56,880
first question is obviously what is it

423
00:18:56,880 --> 00:18:59,360
it's a public and free course that i

424
00:18:59,360 --> 00:19:01,840
wrote over the past roughly four years

425
00:19:01,840 --> 00:19:04,720
i've been iteratively updating it with

426
00:19:04,720 --> 00:19:07,360
blog posts and it should provide you

427
00:19:07,360 --> 00:19:09,520
with conceptual insights

428
00:19:09,520 --> 00:19:11,760
with the help of practical cases

429
00:19:11,760 --> 00:19:13,600
i think the cases that were showcased

430
00:19:13,600 --> 00:19:15,840
the past days during qualcomm are great

431
00:19:15,840 --> 00:19:17,440
for learning as well

432
00:19:17,440 --> 00:19:20,080
but obviously some steps are skipped and

433
00:19:20,080 --> 00:19:22,320
not everything is written out in full

434
00:19:22,320 --> 00:19:24,720
whereas everything is written out in

435
00:19:24,720 --> 00:19:25,919
full here

436
00:19:25,919 --> 00:19:27,120
so

437
00:19:27,120 --> 00:19:28,240
if you're interested in reverse

438
00:19:28,240 --> 00:19:30,480
engineering automating

439
00:19:30,480 --> 00:19:33,120
some stuff then you can check this out

440
00:19:33,120 --> 00:19:34,640
and it has background information

441
00:19:34,640 --> 00:19:36,799
conceptual explanations has practical

442
00:19:36,799 --> 00:19:39,039
cases to keep you somewhat entertained i

443
00:19:39,039 --> 00:19:40,000
hope

444
00:19:40,000 --> 00:19:42,160
there's more analysis automation scripts

445
00:19:42,160 --> 00:19:44,400
and some tips to write reports because

446
00:19:44,400 --> 00:19:45,760
at the end of the day you need to report

447
00:19:45,760 --> 00:19:48,080
what you're writing on

448
00:19:48,080 --> 00:19:50,480
a few excerpts i

449
00:19:50,480 --> 00:19:53,919
wrote a script well multiple ones

450
00:19:53,919 --> 00:19:56,080
my latest one is regarding stack strings

451
00:19:56,080 --> 00:19:59,120
and how to deal with them in jira

452
00:19:59,120 --> 00:20:01,440
it's based on an existing one and i

453
00:20:01,440 --> 00:20:02,720
rewrote this

454
00:20:02,720 --> 00:20:05,039
and improved it and then i have an

455
00:20:05,039 --> 00:20:07,120
example from the xor

456
00:20:07,120 --> 00:20:08,640
ddos tool

457
00:20:08,640 --> 00:20:10,640
which i think somebody presented about

458
00:20:10,640 --> 00:20:14,080
today as well or at least mentioned

459
00:20:14,080 --> 00:20:16,400
where i decrypt the array

460
00:20:16,400 --> 00:20:18,799
that they use with strings

461
00:20:18,799 --> 00:20:20,880
do note the java extensions at the end

462
00:20:20,880 --> 00:20:23,120
as i'll return to that

463
00:20:23,120 --> 00:20:24,640
and then there's the

464
00:20:24,640 --> 00:20:28,320
amade stealer where there is a automated

465
00:20:28,320 --> 00:20:30,080
string decryption

466
00:20:30,080 --> 00:20:31,840
where you get the comments in the

467
00:20:31,840 --> 00:20:34,400
overview as well from jira around the

468
00:20:34,400 --> 00:20:36,000
left hand side you have the original on

469
00:20:36,000 --> 00:20:37,440
the right hand side it's both running

470
00:20:37,440 --> 00:20:38,559
the script

471
00:20:38,559 --> 00:20:40,000
so

472
00:20:40,000 --> 00:20:41,760
for those wondering where might you find

473
00:20:41,760 --> 00:20:42,559
it

474
00:20:42,559 --> 00:20:44,880
it's on my website it's available

475
00:20:44,880 --> 00:20:47,280
for well anyone there are no ads or

476
00:20:47,280 --> 00:20:48,799
blogs or anything

477
00:20:48,799 --> 00:20:50,480
if you have any questions suggestions or

478
00:20:50,480 --> 00:20:51,760
simply want to state how much you

479
00:20:51,760 --> 00:20:54,240
dislike java whereas i like it

480
00:20:54,240 --> 00:20:56,080
you can reach out to me twitter linkedin

481
00:20:56,080 --> 00:20:58,080
or telegram or shout out to me at the

482
00:20:58,080 --> 00:20:59,360
gala

483
00:20:59,360 --> 00:21:01,679
anything should work thank you

484
00:21:01,679 --> 00:21:02,560
thank you

485
00:21:02,560 --> 00:21:09,629
[Applause]

486
00:21:10,480 --> 00:21:11,919
okay

487
00:21:11,919 --> 00:21:14,880
you go you go

488
00:21:14,880 --> 00:21:17,840
version two

489
00:21:20,400 --> 00:21:24,320
he did two versions of a lightning talk

490
00:21:24,320 --> 00:21:26,559
great

491
00:21:27,120 --> 00:21:29,280
okay so hello everyone my name is igor

492
00:21:29,280 --> 00:21:31,760
rifley i work for orange cyber defense

493
00:21:31,760 --> 00:21:33,919
it's a computer emergency response team

494
00:21:33,919 --> 00:21:36,559
and i'm currently mainly focused on

495
00:21:36,559 --> 00:21:39,280
threat intelligence but i formerly did

496
00:21:39,280 --> 00:21:41,120
some incident treatments also for this

497
00:21:41,120 --> 00:21:43,520
company so what i want to talk this

498
00:21:43,520 --> 00:21:46,159
evening is about uh three samples that

499
00:21:46,159 --> 00:21:48,400
were observed in one of our engagement

500
00:21:48,400 --> 00:21:51,039
and they were related to this uh desktop

501
00:21:51,039 --> 00:21:53,440
group uh intrusion set that tom talked

502
00:21:53,440 --> 00:21:55,760
about a little bit earlier so i just

503
00:21:55,760 --> 00:21:58,159
want to share some details with you so

504
00:21:58,159 --> 00:21:59,840
they were

505
00:21:59,840 --> 00:22:02,559
they use they mainly use a lot of uh

506
00:22:02,559 --> 00:22:04,320
this package i mean it's a packer made

507
00:22:04,320 --> 00:22:07,120
with auto it to drop some file like nano

508
00:22:07,120 --> 00:22:09,600
car rat or to drop some meter printer

509
00:22:09,600 --> 00:22:11,360
and what you can see there that they try

510
00:22:11,360 --> 00:22:14,000
to mimic some kind of vlc or java

511
00:22:14,000 --> 00:22:16,640
application and they yes you can see

512
00:22:16,640 --> 00:22:18,400
that when you uncompress

513
00:22:18,400 --> 00:22:22,480
because it's uh basically sorry um

514
00:22:22,480 --> 00:22:24,080
a compressed file you can see that there

515
00:22:24,080 --> 00:22:25,039
is

516
00:22:25,039 --> 00:22:28,799
more than 100 megabyte file outside even

517
00:22:28,799 --> 00:22:31,760
if the origin file is over two megabytes

518
00:22:31,760 --> 00:22:33,679
so uh how they did that is just that

519
00:22:33,679 --> 00:22:36,640
they put in the auto with script some

520
00:22:36,640 --> 00:22:38,400
garbage block of comments and they

521
00:22:38,400 --> 00:22:40,720
repeated more than 400 types so it's

522
00:22:40,720 --> 00:22:43,039
quite simple uh but it's quite effective

523
00:22:43,039 --> 00:22:44,960
in fact it means that for some same

524
00:22:44,960 --> 00:22:47,360
boxer endpoint security products it just

525
00:22:47,360 --> 00:22:50,400
uh for me to analyze two big files so

526
00:22:50,400 --> 00:22:53,039
it's just a yes a big picture how the

527
00:22:53,039 --> 00:22:55,120
packer works so it's something very

528
00:22:55,120 --> 00:22:57,840
basic i mean they are just uh extract

529
00:22:57,840 --> 00:23:00,320
file uh run legit autoit interpreter

530
00:23:00,320 --> 00:23:02,799
they have some encrypted payload they

531
00:23:02,799 --> 00:23:04,640
have scheduled tasks for persistence and

532
00:23:04,640 --> 00:23:07,600
they copyright svcs because the packer

533
00:23:07,600 --> 00:23:11,360
is designed to load net assembly so uh

534
00:23:11,360 --> 00:23:12,960
the last part of the of this lighting

535
00:23:12,960 --> 00:23:14,720
talk is about the encryption key because

536
00:23:14,720 --> 00:23:17,039
they copied some come from

537
00:23:17,039 --> 00:23:19,679
yes github as all mario devs do and all

538
00:23:19,679 --> 00:23:22,080
devs do and but what they did is i guess

539
00:23:22,080 --> 00:23:24,720
they build a kind of builder and they

540
00:23:24,720 --> 00:23:28,799
uh push an encryption key in utf-16 and

541
00:23:28,799 --> 00:23:31,360
but what they fail to do is that they

542
00:23:31,360 --> 00:23:34,159
keep the str parameter in the call to

543
00:23:34,159 --> 00:23:37,440
dll call it's then of using wster for

544
00:23:37,440 --> 00:23:39,840
wide string so what happened is that

545
00:23:39,840 --> 00:23:41,919
with the original

546
00:23:41,919 --> 00:23:45,840
binary key with 30 bytes of utf-16 using

547
00:23:45,840 --> 00:23:46,720
this

548
00:23:46,720 --> 00:23:49,200
parameter it means that it extract all

549
00:23:49,200 --> 00:23:52,799
those 30 nc char but in fact over 30

550
00:23:52,799 --> 00:23:55,360
bytes key you have 29 bytes are just

551
00:23:55,360 --> 00:23:57,600
useless because they are all replaced by

552
00:23:57,600 --> 00:24:00,960
a question mark which is 3f in fact so

553
00:24:00,960 --> 00:24:02,159
um

554
00:24:02,159 --> 00:24:03,600
i you have

555
00:24:03,600 --> 00:24:05,840
malware ashes feel free to ask some of

556
00:24:05,840 --> 00:24:08,080
the samples are on

557
00:24:08,080 --> 00:24:10,480
virustotal and i will be very interested

558
00:24:10,480 --> 00:24:12,559
if some of you have already encountered

559
00:24:12,559 --> 00:24:14,640
some kind of packer so thanks to all of

560
00:24:14,640 --> 00:24:16,640
you

561
00:24:16,640 --> 00:24:19,799
thank you

562
00:24:27,760 --> 00:24:31,240
right on time

563
00:24:32,000 --> 00:24:34,960
show the pdf

564
00:24:41,279 --> 00:24:44,159
hi everyone and so i'm here to present

565
00:24:44,159 --> 00:24:48,320
to you my school last year project so

566
00:24:48,320 --> 00:24:49,679
my name is tom

567
00:24:49,679 --> 00:24:52,240
and so quick disclaimer everything that

568
00:24:52,240 --> 00:24:53,919
you're going to see is basically a

569
00:24:53,919 --> 00:24:55,840
lesser version of

570
00:24:55,840 --> 00:24:57,440
third party sky tools

571
00:24:57,440 --> 00:24:59,440
basically homemade version because we

572
00:24:59,440 --> 00:25:02,159
like to do it our way and

573
00:25:02,159 --> 00:25:03,679
still i think it can be interesting to

574
00:25:03,679 --> 00:25:04,720
see like the

575
00:25:04,720 --> 00:25:06,480
way we do it

576
00:25:06,480 --> 00:25:08,799
so quite a complicated

577
00:25:08,799 --> 00:25:11,600
thing to just tell that so botnet

578
00:25:11,600 --> 00:25:13,919
tracker is a software something that we

579
00:25:13,919 --> 00:25:16,080
want to do to

580
00:25:16,080 --> 00:25:17,679
make an in-between

581
00:25:17,679 --> 00:25:20,640
um between long-term sandboxing and

582
00:25:20,640 --> 00:25:24,240
actual like just occasional c2 polling

583
00:25:24,240 --> 00:25:26,960
so we want to follow a c2 we want

584
00:25:26,960 --> 00:25:29,600
together as iocs and the idea is that

585
00:25:29,600 --> 00:25:30,960
we can just

586
00:25:30,960 --> 00:25:35,200
um use botnet tracker so quick id

587
00:25:35,200 --> 00:25:37,440
so you're the users

588
00:25:37,440 --> 00:25:39,760
there's like a master

589
00:25:39,760 --> 00:25:42,320
computer which is well we named it

590
00:25:42,320 --> 00:25:45,279
asgard which is a django application

591
00:25:45,279 --> 00:25:46,480
um

592
00:25:46,480 --> 00:25:48,640
and you want to actually

593
00:25:48,640 --> 00:25:50,720
have some bots exchanging with the c2

594
00:25:50,720 --> 00:25:52,880
panels on the right side

595
00:25:52,880 --> 00:25:55,120
so the c2 have obviously some

596
00:25:55,120 --> 00:25:57,600
infected machine that they control

597
00:25:57,600 --> 00:26:00,000
and you're just going to reverse the

598
00:26:00,000 --> 00:26:02,480
script once well reverse the malware

599
00:26:02,480 --> 00:26:05,279
once and then emulate it with a python

600
00:26:05,279 --> 00:26:08,080
crypt and then just exchange it exchange

601
00:26:08,080 --> 00:26:10,400
with the c2 panel to get the lastest

602
00:26:10,400 --> 00:26:15,039
iocs and well updates possibly

603
00:26:15,039 --> 00:26:18,080
so well what do we actually have so we

604
00:26:18,080 --> 00:26:18,960
have

605
00:26:18,960 --> 00:26:22,240
10 fully implemented bots and now i'm

606
00:26:22,240 --> 00:26:24,640
going to show you right after two silent

607
00:26:24,640 --> 00:26:26,960
bots meaning that we

608
00:26:26,960 --> 00:26:29,200
they can't actually be

609
00:26:29,200 --> 00:26:30,960
they aren't listed in the panel

610
00:26:30,960 --> 00:26:34,640
interface as we exploited the

611
00:26:34,640 --> 00:26:35,600
panel

612
00:26:35,600 --> 00:26:36,720
protocol

613
00:26:36,720 --> 00:26:38,400
and we have three remote configuration

614
00:26:38,400 --> 00:26:40,400
extractor like just

615
00:26:40,400 --> 00:26:42,320
getting all the info from the

616
00:26:42,320 --> 00:26:43,919
malware panel

617
00:26:43,919 --> 00:26:46,159
one utility library you

618
00:26:46,159 --> 00:26:48,400
being used for to like decompre

619
00:26:48,400 --> 00:26:51,039
decompress data or compress it or do

620
00:26:51,039 --> 00:26:53,919
some hashes so basically maldek but

621
00:26:53,919 --> 00:26:55,600
like homemade

622
00:26:55,600 --> 00:26:58,640
and like we worked uh so as a school

623
00:26:58,640 --> 00:27:02,000
project only on uh 13 panel sources

624
00:27:02,000 --> 00:27:05,440
here an excerpt of the like three months

625
00:27:05,440 --> 00:27:06,400
of work

626
00:27:06,400 --> 00:27:08,720
uh red line the keyboard i'm a day etc i

627
00:27:08,720 --> 00:27:11,120
don't have much time i didn't hesitate

628
00:27:11,120 --> 00:27:14,880
to come uh to talk about it after talk

629
00:27:14,880 --> 00:27:18,080
so our main uh problems and or we dealt

630
00:27:18,080 --> 00:27:21,279
with that with them or not so

631
00:27:21,279 --> 00:27:23,039
we wanted to have some panels to

632
00:27:23,039 --> 00:27:25,440
exchange with to test our products so we

633
00:27:25,440 --> 00:27:28,080
actually did like some sort of

634
00:27:28,080 --> 00:27:30,640
panel tracker based on public feed and

635
00:27:30,640 --> 00:27:31,919
web scraping

636
00:27:31,919 --> 00:27:33,679
and some but were really hard to

637
00:27:33,679 --> 00:27:35,200
implement but we did it quite

638
00:27:35,200 --> 00:27:36,960
realistically doing screenshots and

639
00:27:36,960 --> 00:27:38,880
everything and so well malware

640
00:27:38,880 --> 00:27:39,919
everything

641
00:27:39,919 --> 00:27:41,360
not we we couldn't follow everything

642
00:27:41,360 --> 00:27:42,960
that we wanted

643
00:27:42,960 --> 00:27:44,480
anyway so

644
00:27:44,480 --> 00:27:47,200
we have quite loads of ambition and want

645
00:27:47,200 --> 00:27:49,279
to go on with this project

646
00:27:49,279 --> 00:27:51,120
and it's going to be open source quite

647
00:27:51,120 --> 00:27:53,840
soon we hope so do not hesitate to

648
00:27:53,840 --> 00:27:54,799
come

649
00:27:54,799 --> 00:27:56,559
if you are interested or want to work

650
00:27:56,559 --> 00:27:57,679
with it

651
00:27:57,679 --> 00:27:59,679
and lastly before finishing and giving

652
00:27:59,679 --> 00:28:01,520
up on this

653
00:28:01,520 --> 00:28:03,760
we're organizing it

654
00:28:03,760 --> 00:28:06,159
based on malware analysis so

655
00:28:06,159 --> 00:28:09,039
soon come and sponsor if you want to

656
00:28:09,039 --> 00:28:12,039
thanks

657
00:28:17,360 --> 00:28:20,240
so he actually hacked my uh

658
00:28:20,240 --> 00:28:23,880
lineup okay

659
00:28:38,320 --> 00:28:40,559
thank you

660
00:28:40,559 --> 00:28:42,480
hi everyone i'm constantine from

661
00:28:42,480 --> 00:28:44,399
proofpoint i'm in threat research

662
00:28:44,399 --> 00:28:47,840
and i do ddx or we are doing ddx which

663
00:28:47,840 --> 00:28:49,600
stands for detection detonation and

664
00:28:49,600 --> 00:28:51,360
config extraction

665
00:28:51,360 --> 00:28:53,760
and i want to explain quickly what is

666
00:28:53,760 --> 00:28:55,840
this to you

667
00:28:55,840 --> 00:28:58,159
so email is still number one entry point

668
00:28:58,159 --> 00:29:00,320
for actors we see urls we see

669
00:29:00,320 --> 00:29:02,080
attachments we see also malwareless

670
00:29:02,080 --> 00:29:03,520
scams which

671
00:29:03,520 --> 00:29:04,799
lead to

672
00:29:04,799 --> 00:29:07,840
customers bleeding so um

673
00:29:07,840 --> 00:29:09,840
on the slide you can see a

674
00:29:09,840 --> 00:29:12,720
exemplary attack chain you have an email

675
00:29:12,720 --> 00:29:14,720
that leads to a pdf

676
00:29:14,720 --> 00:29:17,679
which has a bitly url in it which

677
00:29:17,679 --> 00:29:19,679
redirects to a

678
00:29:19,679 --> 00:29:21,679
file sharing site which downloads a

679
00:29:21,679 --> 00:29:24,000
password-protected raw archive

680
00:29:24,000 --> 00:29:26,159
this case the password is in the pdf but

681
00:29:26,159 --> 00:29:28,399
it could also be in the

682
00:29:28,399 --> 00:29:30,240
email and

683
00:29:30,240 --> 00:29:32,080
in the end it leads to bandwidth malware

684
00:29:32,080 --> 00:29:33,679
installed on the host

685
00:29:33,679 --> 00:29:35,840
so you have complex attacks chains with

686
00:29:35,840 --> 00:29:38,159
multiple steps until the actual malware

687
00:29:38,159 --> 00:29:40,240
is dropped and those are hard to

688
00:29:40,240 --> 00:29:43,039
automate but not impossible

689
00:29:43,039 --> 00:29:44,720
so i hope you are familiar with the

690
00:29:44,720 --> 00:29:47,600
concept of the pyramid of pain if not i

691
00:29:47,600 --> 00:29:50,240
don't have the time to explain it but it

692
00:29:50,240 --> 00:29:52,320
would be best to have a detection in

693
00:29:52,320 --> 00:29:53,760
place for

694
00:29:53,760 --> 00:29:55,360
the green part which is

695
00:29:55,360 --> 00:29:56,480
the malware

696
00:29:56,480 --> 00:29:59,200
and blue is the detection so like it

697
00:29:59,200 --> 00:30:00,799
would be best to detect bandwidth

698
00:30:00,799 --> 00:30:03,360
malware and extract the config

699
00:30:03,360 --> 00:30:04,159
but

700
00:30:04,159 --> 00:30:05,919
because the detonation which is the

701
00:30:05,919 --> 00:30:07,360
right part

702
00:30:07,360 --> 00:30:09,600
of the full attack chain is really hard

703
00:30:09,600 --> 00:30:12,240
to automate and it can break in multiple

704
00:30:12,240 --> 00:30:13,279
steps

705
00:30:13,279 --> 00:30:15,039
it's also good to have detection in

706
00:30:15,039 --> 00:30:17,360
place for the other pieces so for the

707
00:30:17,360 --> 00:30:19,360
bitly url redirecting to the password

708
00:30:19,360 --> 00:30:23,039
protected raw for the pdf and also for

709
00:30:23,039 --> 00:30:24,480
the email of course

710
00:30:24,480 --> 00:30:26,240
so

711
00:30:26,240 --> 00:30:28,399
those are lower in the pyramid of pain

712
00:30:28,399 --> 00:30:29,440
but

713
00:30:29,440 --> 00:30:31,520
yeah also useful

714
00:30:31,520 --> 00:30:33,840
for us

715
00:30:34,480 --> 00:30:36,480
if we look more into detail

716
00:30:36,480 --> 00:30:37,840
you will see that yeah there are

717
00:30:37,840 --> 00:30:40,399
elements in the email that you can flag

718
00:30:40,399 --> 00:30:42,559
there are elements in the pdf that you

719
00:30:42,559 --> 00:30:45,360
can flag and of course you can extract

720
00:30:45,360 --> 00:30:47,440
the configuration from the bandwidth

721
00:30:47,440 --> 00:30:52,240
malware which you have classified before

722
00:30:52,480 --> 00:30:55,600
so two points to remember here first is

723
00:30:55,600 --> 00:30:57,519
that not always

724
00:30:57,519 --> 00:30:58,640
the best

725
00:30:58,640 --> 00:31:00,720
the highest detection at the pyramid of

726
00:31:00,720 --> 00:31:03,440
pain is the best you also need

727
00:31:03,440 --> 00:31:05,919
lower detection and the second point is

728
00:31:05,919 --> 00:31:07,919
that yeah

729
00:31:07,919 --> 00:31:09,840
such an attack chain it's only an

730
00:31:09,840 --> 00:31:12,080
example of course it's hard to detonate

731
00:31:12,080 --> 00:31:13,519
until the end so

732
00:31:13,519 --> 00:31:15,279
if something breaks in the detonation

733
00:31:15,279 --> 00:31:17,519
it's also good to have detection in

734
00:31:17,519 --> 00:31:20,640
place in previous stages

735
00:31:20,640 --> 00:31:21,840
okay

736
00:31:21,840 --> 00:31:24,000
bonus slide

737
00:31:24,000 --> 00:31:26,480
if you have the config extract it from

738
00:31:26,480 --> 00:31:28,880
the final malware you can also

739
00:31:28,880 --> 00:31:31,279
create network signatures of course

740
00:31:31,279 --> 00:31:33,679
as you have seen we also extracted the

741
00:31:33,679 --> 00:31:36,720
um encryption key the aes information so

742
00:31:36,720 --> 00:31:38,880
we were also able to decrypt the network

743
00:31:38,880 --> 00:31:42,640
traffic and yeah if a sample is free

744
00:31:42,640 --> 00:31:44,320
in ocean data

745
00:31:44,320 --> 00:31:46,880
then it goes into et open which is free

746
00:31:46,880 --> 00:31:49,600
and you can every everyone can use it

747
00:31:49,600 --> 00:31:51,010
thanks thank you

748
00:31:51,010 --> 00:31:58,080
[Applause]

749
00:31:58,080 --> 00:32:03,279
okay nice talk he's not here for eric

750
00:32:09,910 --> 00:32:13,279
[Applause]

751
00:32:13,279 --> 00:32:16,159
hello everyone i'm fred i'm part of the

752
00:32:16,159 --> 00:32:18,320
the organizing committee

753
00:32:18,320 --> 00:32:20,320
and previously in charge of the

754
00:32:20,320 --> 00:32:21,519
recordings

755
00:32:21,519 --> 00:32:24,480
so i'm here to previously yeah

756
00:32:24,480 --> 00:32:26,960
previously

757
00:32:27,039 --> 00:32:30,320
i'm here to answer martin questions so

758
00:32:30,320 --> 00:32:33,519
where's my 2019 video

759
00:32:33,519 --> 00:32:35,919
so in fact i have all the videos all the

760
00:32:35,919 --> 00:32:37,519
recording

761
00:32:37,519 --> 00:32:39,919
but we had some issue

762
00:32:39,919 --> 00:32:43,120
with uh our chip life bike to record to

763
00:32:43,120 --> 00:32:45,200
stream and so on

764
00:32:45,200 --> 00:32:48,640
so finally we had this setup

765
00:32:48,640 --> 00:32:51,279
but we had some issue so mainly with a

766
00:32:51,279 --> 00:32:52,720
usb

767
00:32:52,720 --> 00:32:56,240
bandwidth issue some cpu

768
00:32:56,240 --> 00:32:58,399
burning and so on

769
00:32:58,399 --> 00:33:00,960
and now we have a new solution thanks to

770
00:33:00,960 --> 00:33:03,679
paul what i think is no longer here so

771
00:33:03,679 --> 00:33:05,679
it's working a lot now

772
00:33:05,679 --> 00:33:06,799
and

773
00:33:06,799 --> 00:33:09,919
finally just to answer to martin

774
00:33:09,919 --> 00:33:12,960
maybe in 2023 we'll have your video

775
00:33:12,960 --> 00:33:14,720
uploaded online

776
00:33:14,720 --> 00:33:16,450
thanks

777
00:33:16,450 --> 00:33:24,240
[Applause]

778
00:33:24,240 --> 00:33:26,559
maybe

779
00:33:27,120 --> 00:33:30,720
even you want to do your demo

780
00:33:30,720 --> 00:33:33,120
on it

781
00:33:36,720 --> 00:33:37,519
so

782
00:33:37,519 --> 00:33:38,880
so i i can

783
00:33:38,880 --> 00:33:40,640
group the jury to decide who gets the

784
00:33:40,640 --> 00:33:43,640
gift

785
00:33:55,440 --> 00:33:57,840
oh cool

786
00:34:00,240 --> 00:34:02,559
okay so basically

787
00:34:02,559 --> 00:34:05,519
uh this is the file personalization.js i

788
00:34:05,519 --> 00:34:07,679
was mentioning earlier and what i did is

789
00:34:07,679 --> 00:34:10,239
i just extracted all the accounts and

790
00:34:10,239 --> 00:34:12,879
put them into a txt file now the issue

791
00:34:12,879 --> 00:34:14,960
is twitter's api will not let you block

792
00:34:14,960 --> 00:34:16,560
account by handle but instead you need

793
00:34:16,560 --> 00:34:18,800
to have an account idea so

794
00:34:18,800 --> 00:34:20,399
this is a bit of scripting you have to

795
00:34:20,399 --> 00:34:22,879
do right there so i created this block

796
00:34:22,879 --> 00:34:25,119
and roll script here

797
00:34:25,119 --> 00:34:26,960
and in order to use it you will need to

798
00:34:26,960 --> 00:34:29,440
have a few keys now don't bother copying

799
00:34:29,440 --> 00:34:31,040
those because i'm going to revoke them

800
00:34:31,040 --> 00:34:33,760
the second i get off the stage

801
00:34:33,760 --> 00:34:37,040
so these ones uh you can create them

802
00:34:37,040 --> 00:34:37,839
when

803
00:34:37,839 --> 00:34:40,079
you log into the twitter developer

804
00:34:40,079 --> 00:34:41,760
dashboard so just create an app there

805
00:34:41,760 --> 00:34:43,599
create copy the tokens

806
00:34:43,599 --> 00:34:44,879
and then the first time you run the

807
00:34:44,879 --> 00:34:47,119
script then you will get an

808
00:34:47,119 --> 00:34:49,520
an invite i would say where

809
00:34:49,520 --> 00:34:51,119
like i'm going to do i'm going to do

810
00:34:51,119 --> 00:34:52,000
this

811
00:34:52,000 --> 00:34:53,760
i'm going to

812
00:34:53,760 --> 00:34:55,359
do it like this so i have this generate

813
00:34:55,359 --> 00:34:57,760
option which takes a list of handles and

814
00:34:57,760 --> 00:35:00,480
creates a csv file that can import

815
00:35:00,480 --> 00:35:03,280
and since here my app is not authorized

816
00:35:03,280 --> 00:35:04,720
and when you launch the script for the

817
00:35:04,720 --> 00:35:07,839
first time then you get to copy the this

818
00:35:07,839 --> 00:35:09,040
url

819
00:35:09,040 --> 00:35:11,359
uh you need to go online like do

820
00:35:11,359 --> 00:35:13,359
something like this you authorize the

821
00:35:13,359 --> 00:35:14,400
app

822
00:35:14,400 --> 00:35:16,640
and then you copy a pin code and this is

823
00:35:16,640 --> 00:35:19,119
the only time that you have to do this

824
00:35:19,119 --> 00:35:21,200
uh hopefully this this is the

825
00:35:21,200 --> 00:35:23,440
most streamline i was able to to do for

826
00:35:23,440 --> 00:35:25,599
this process unfortunately but uh

827
00:35:25,599 --> 00:35:26,720
hopefully

828
00:35:26,720 --> 00:35:28,720
in the future this can be improved uh

829
00:35:28,720 --> 00:35:30,960
and then you just copy those parameters

830
00:35:30,960 --> 00:35:33,200
and put them in the script

831
00:35:33,200 --> 00:35:35,119
and then you're set forever so let me

832
00:35:35,119 --> 00:35:38,160
just replace this

833
00:35:38,880 --> 00:35:41,359
like that

834
00:35:41,680 --> 00:35:42,640
okay

835
00:35:42,640 --> 00:35:45,200
and meanwhile uh if you go back to the

836
00:35:45,200 --> 00:35:48,400
the list uh if i go to my uh

837
00:35:48,400 --> 00:35:50,960
output file which was test.csv then you

838
00:35:50,960 --> 00:35:52,640
would get a file like this that actually

839
00:35:52,640 --> 00:35:54,800
contains the proper csv file in the

840
00:35:54,800 --> 00:35:56,560
former format that twitter actually

841
00:35:56,560 --> 00:35:57,680
accepts

842
00:35:57,680 --> 00:36:00,000
and then you have another option which

843
00:36:00,000 --> 00:36:03,040
let me remove the file

844
00:36:03,760 --> 00:36:05,440
the other option would be to export a

845
00:36:05,440 --> 00:36:07,040
block list and the way you would do this

846
00:36:07,040 --> 00:36:09,200
is minus e or minus my

847
00:36:09,200 --> 00:36:12,200
export

848
00:36:16,240 --> 00:36:18,000
and then normally

849
00:36:18,000 --> 00:36:20,320
yeah a super annoying program never buy

850
00:36:20,320 --> 00:36:21,680
it

851
00:36:21,680 --> 00:36:23,839
yeah there you go so here i export my

852
00:36:23,839 --> 00:36:27,799
blog list and then again

853
00:36:28,240 --> 00:36:30,079
you would get everything like the way

854
00:36:30,079 --> 00:36:31,920
you expect and now the final thing would

855
00:36:31,920 --> 00:36:33,920
be you just have the final

856
00:36:33,920 --> 00:36:36,320
flag which would be a minus i or dash

857
00:36:36,320 --> 00:36:38,079
dash import

858
00:36:38,079 --> 00:36:39,839
which you would point to this new csv

859
00:36:39,839 --> 00:36:41,599
file that you created and then it would

860
00:36:41,599 --> 00:36:43,040
import the block list now i'm not going

861
00:36:43,040 --> 00:36:44,800
to do this on stage because twitter's

862
00:36:44,800 --> 00:36:46,320
api is quite restrictive when it comes

863
00:36:46,320 --> 00:36:47,920
to importing blocks

864
00:36:47,920 --> 00:36:50,560
you can only get them get 50 of them per

865
00:36:50,560 --> 00:36:51,839
15 minutes

866
00:36:51,839 --> 00:36:53,599
which is a bit annoying to be honest but

867
00:36:53,599 --> 00:36:55,040
at the same time it's like you don't

868
00:36:55,040 --> 00:36:56,240
really need those accounts to be blocked

869
00:36:56,240 --> 00:36:57,520
right now so you can just launch the

870
00:36:57,520 --> 00:36:58,800
script come back tomorrow and have

871
00:36:58,800 --> 00:36:59,920
everything blocked

872
00:36:59,920 --> 00:37:01,839
so again everything everything is on

873
00:37:01,839 --> 00:37:04,000
github including my own blog list so

874
00:37:04,000 --> 00:37:05,839
feel free to check it out and

875
00:37:05,839 --> 00:37:07,520
submit here on thank you very much for

876
00:37:07,520 --> 00:37:08,190
the extra time

877
00:37:08,190 --> 00:37:15,680
[Applause]

878
00:37:15,680 --> 00:37:18,399
thank you

