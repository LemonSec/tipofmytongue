1
00:00:30,480 --> 00:00:32,000
bring tonight a small consulting

2
00:00:32,000 --> 00:00:33,920
practice too

3
00:00:33,920 --> 00:00:35,680
and this talk isn't the most technical

4
00:00:35,680 --> 00:00:37,440
talk right it absolutely isn't but we're

5
00:00:37,440 --> 00:00:38,640
going to talk about something that to me

6
00:00:38,640 --> 00:00:39,840
is kind of important and i'm going to

7
00:00:39,840 --> 00:00:41,360
take a second to talk about why that's

8
00:00:41,360 --> 00:00:43,360
important and i've spoken at a lot of

9
00:00:43,360 --> 00:00:45,520
conferences i spoke here uh probably

10
00:00:45,520 --> 00:00:46,960
about five years ago i spent the last

11
00:00:46,960 --> 00:00:48,879
couple years outside of washington dc

12
00:00:48,879 --> 00:00:52,239
we're now back in arizona

13
00:00:52,719 --> 00:00:54,800
but what happened was a buddy of mine

14
00:00:54,800 --> 00:00:56,719
this is a last summer a buddy of mine

15
00:00:56,719 --> 00:00:59,600
came to me and i've never spent in any

16
00:00:59,600 --> 00:01:00,800
talk i've ever done i've never spent

17
00:01:00,800 --> 00:01:02,559
like the first two minutes talking about

18
00:01:02,559 --> 00:01:04,000
why i made a talk i just kind of get up

19
00:01:04,000 --> 00:01:05,438
here and start talking and go right into

20
00:01:05,438 --> 00:01:07,040
it but this time's a little bit

21
00:01:07,040 --> 00:01:08,880
different so a buddy of mine came to me

22
00:01:08,880 --> 00:01:11,119
he works for a um an agency that i will

23
00:01:11,119 --> 00:01:13,360
not name and what happened is he

24
00:01:13,360 --> 00:01:14,799
messaged me and he's like hey i want to

25
00:01:14,799 --> 00:01:16,159
talk to you about a wireless issue i

26
00:01:16,159 --> 00:01:16,960
have

27
00:01:16,960 --> 00:01:18,799
to see if you can help me with that i'm

28
00:01:18,799 --> 00:01:20,320
like yeah no let's talk and i had an

29
00:01:20,320 --> 00:01:22,240
idea of what it might be and then when

30
00:01:22,240 --> 00:01:23,680
he actually when we got together and we

31
00:01:23,680 --> 00:01:25,360
talked i was actually like dead wrong

32
00:01:25,360 --> 00:01:26,640
right he was something completely

33
00:01:26,640 --> 00:01:28,159
different

34
00:01:28,159 --> 00:01:30,320
and what it was was

35
00:01:30,320 --> 00:01:32,320
he had a confidential informant someone

36
00:01:32,320 --> 00:01:33,840
who was working with a very very

37
00:01:33,840 --> 00:01:36,000
dangerous very very dangerous group that

38
00:01:36,000 --> 00:01:38,000
i think everyone in here agreed is a bad

39
00:01:38,000 --> 00:01:39,520
group

40
00:01:39,520 --> 00:01:41,600
and he was meeting with this informant

41
00:01:41,600 --> 00:01:43,439
and then leaving and going back to his

42
00:01:43,439 --> 00:01:45,520
job back to his normal life

43
00:01:45,520 --> 00:01:47,600
and he was worried about being followed

44
00:01:47,600 --> 00:01:49,759
from meeting with his informant and he

45
00:01:49,759 --> 00:01:51,680
seriously he did not care about his own

46
00:01:51,680 --> 00:01:53,360
health he thought like no i can protect

47
00:01:53,360 --> 00:01:54,880
myself he was worried about his

48
00:01:54,880 --> 00:01:56,240
informant he was worried that if someone

49
00:01:56,240 --> 00:01:58,479
followed him after meeting his informant

50
00:01:58,479 --> 00:02:00,479
figured out where he worked

51
00:02:00,479 --> 00:02:02,240
that now it would go very very poorly

52
00:02:02,240 --> 00:02:03,439
for that informant right he was worried

53
00:02:03,439 --> 00:02:05,600
about the informant's physical safety

54
00:02:05,600 --> 00:02:07,280
and he had heard me years ago speak

55
00:02:07,280 --> 00:02:08,639
about wireless and talk about the

56
00:02:08,639 --> 00:02:10,399
concept of using wireless to help tell

57
00:02:10,399 --> 00:02:12,400
if you were being followed and so he's

58
00:02:12,400 --> 00:02:14,239
like yeah so he went to his agency's

59
00:02:14,239 --> 00:02:15,680
technical people and said do you have

60
00:02:15,680 --> 00:02:17,840
anything like this and they said no

61
00:02:17,840 --> 00:02:19,280
and so now he's reaching out to me do

62
00:02:19,280 --> 00:02:20,879
you know of anything like this and i'm

63
00:02:20,879 --> 00:02:22,560
like no but i'm like you know what this

64
00:02:22,560 --> 00:02:23,840
is actually kind of a cool little

65
00:02:23,840 --> 00:02:26,000
project and so i'll work on it i said if

66
00:02:26,000 --> 00:02:27,520
you don't mind it's

67
00:02:27,520 --> 00:02:29,040
may take me like a month or two to knock

68
00:02:29,040 --> 00:02:30,080
this out because it's going to be my

69
00:02:30,080 --> 00:02:32,000
free time but i'll start trying to work

70
00:02:32,000 --> 00:02:33,440
for it and try to figure something out

71
00:02:33,440 --> 00:02:34,480
and so

72
00:02:34,480 --> 00:02:36,959
that's where this talk is coming from

73
00:02:36,959 --> 00:02:38,879
and so before i'm like as i'm working on

74
00:02:38,879 --> 00:02:40,480
it i'm like wow this kind of my this

75
00:02:40,480 --> 00:02:42,000
might make an interesting conference

76
00:02:42,000 --> 00:02:44,720
talk and then the next thought is okay

77
00:02:44,720 --> 00:02:46,400
number one would anyone care right would

78
00:02:46,400 --> 00:02:47,680
it be relevant would anyone care would

79
00:02:47,680 --> 00:02:49,599
it be interesting and i thought yeah i

80
00:02:49,599 --> 00:02:50,959
met that bar

81
00:02:50,959 --> 00:02:52,480
and now the next bar was kind of a

82
00:02:52,480 --> 00:02:54,800
depressing one the next bar was could it

83
00:02:54,800 --> 00:02:57,280
potentially be used to do any harm right

84
00:02:57,280 --> 00:02:59,280
anytime you start talking about wireless

85
00:02:59,280 --> 00:03:00,560
you start thinking about invading

86
00:03:00,560 --> 00:03:02,319
people's privacy right you start

87
00:03:02,319 --> 00:03:04,319
thinking about like stalking and things

88
00:03:04,319 --> 00:03:06,159
like that and stalking is horrible right

89
00:03:06,159 --> 00:03:07,760
it just kind of ruins people's life when

90
00:03:07,760 --> 00:03:09,519
it's going on and this is where the

91
00:03:09,519 --> 00:03:11,200
depressing part came and i realized that

92
00:03:11,200 --> 00:03:12,800
number one the way this was designed

93
00:03:12,800 --> 00:03:14,400
that no it really couldn't be used like

94
00:03:14,400 --> 00:03:16,400
that it was only designed to try to tell

95
00:03:16,400 --> 00:03:18,480
if you were being followed and the

96
00:03:18,480 --> 00:03:20,640
second part is damn this is last summer

97
00:03:20,640 --> 00:03:21,920
this is a little bit before like the

98
00:03:21,920 --> 00:03:23,840
apple air tag and now an iphone kind of

99
00:03:23,840 --> 00:03:25,120
tells you if there's an air tag that's

100
00:03:25,120 --> 00:03:26,799
been following you around

101
00:03:26,799 --> 00:03:28,720
but this is before that and when you

102
00:03:28,720 --> 00:03:31,120
start looking at the amount of apps

103
00:03:31,120 --> 00:03:33,280
designed to spy on people and follow

104
00:03:33,280 --> 00:03:35,840
them and tracking devices on cars versus

105
00:03:35,840 --> 00:03:37,280
the amount that's out there that's

106
00:03:37,280 --> 00:03:38,720
trying to detect

107
00:03:38,720 --> 00:03:40,080
when someone gets so desperate they're

108
00:03:40,080 --> 00:03:41,599
coming to my butt to try to help them

109
00:03:41,599 --> 00:03:43,120
out with this problem you start

110
00:03:43,120 --> 00:03:44,480
realizing that yeah i think this is

111
00:03:44,480 --> 00:03:45,680
worth talking about there because we

112
00:03:45,680 --> 00:03:47,200
need more things like that you know the

113
00:03:47,200 --> 00:03:49,040
iphone trying to let you know if there's

114
00:03:49,040 --> 00:03:50,879
an air tag following you was a great

115
00:03:50,879 --> 00:03:52,879
start but at least like hey let's start

116
00:03:52,879 --> 00:03:54,239
throwing some stuff out in here and see

117
00:03:54,239 --> 00:03:56,319
what ideas we can kind of come up with

118
00:03:56,319 --> 00:03:57,920
and that's where this talk is coming out

119
00:03:57,920 --> 00:03:58,959
of

120
00:03:58,959 --> 00:04:00,720
so plenty about that we're going to talk

121
00:04:00,720 --> 00:04:02,480
about the methodology

122
00:04:02,480 --> 00:04:05,040
about the hardware about the software

123
00:04:05,040 --> 00:04:06,799
and then a few issues that i ran into i

124
00:04:06,799 --> 00:04:08,720
was doing it and how i figured out a way

125
00:04:08,720 --> 00:04:10,480
to solve them not saying it's the best

126
00:04:10,480 --> 00:04:12,159
way saying it was the way that kind of

127
00:04:12,159 --> 00:04:15,680
my mind worked and it seemed to work

128
00:04:15,680 --> 00:04:17,759
so this is a technical conference right

129
00:04:17,759 --> 00:04:20,079
so if i sit here and say sdr

130
00:04:20,079 --> 00:04:21,358
you know we all think of like

131
00:04:21,358 --> 00:04:23,360
software-defined radio right i was just

132
00:04:23,360 --> 00:04:24,800
down in the vendor hall we had like a

133
00:04:24,800 --> 00:04:26,400
nice little radio display right there in

134
00:04:26,400 --> 00:04:29,120
the radio village very very cool

135
00:04:29,120 --> 00:04:30,560
but anyone who's kind of maybe a little

136
00:04:30,560 --> 00:04:32,400
more old school or involved in

137
00:04:32,400 --> 00:04:34,080
tradecraft and certain things like that

138
00:04:34,080 --> 00:04:35,919
right you think surveillance detection

139
00:04:35,919 --> 00:04:38,400
route right and it's just as basic

140
00:04:38,400 --> 00:04:40,720
sometimes as like switching lanes and

141
00:04:40,720 --> 00:04:41,840
seeing if anyone else behind you

142
00:04:41,840 --> 00:04:44,000
switches lanes right can be getting off

143
00:04:44,000 --> 00:04:45,759
the highway

144
00:04:45,759 --> 00:04:47,440
and then getting back on the highway

145
00:04:47,440 --> 00:04:48,639
right and telling who got off with you

146
00:04:48,639 --> 00:04:50,400
who got off right and that's you know i

147
00:04:50,400 --> 00:04:52,479
kind of chose this uh

148
00:04:52,479 --> 00:04:54,800
this map for this because anyone who's

149
00:04:54,800 --> 00:04:56,720
kind of lived in that world and spent

150
00:04:56,720 --> 00:04:59,199
any time in washington dc you realize

151
00:04:59,199 --> 00:05:01,039
the beltway is set up to be one giant

152
00:05:01,039 --> 00:05:02,560
surveillance detection route right there

153
00:05:02,560 --> 00:05:04,400
is no denying it it's just the way that

154
00:05:04,400 --> 00:05:06,000
it's set up

155
00:05:06,000 --> 00:05:08,000
and so my buddy he knows this tradecraft

156
00:05:08,000 --> 00:05:09,360
he knows this tradecraft frankly better

157
00:05:09,360 --> 00:05:11,039
than i do but he was looking for

158
00:05:11,039 --> 00:05:12,560
something a little more technical right

159
00:05:12,560 --> 00:05:14,160
kind of like a more technical method to

160
00:05:14,160 --> 00:05:16,400
help him out and method man if by some

161
00:05:16,400 --> 00:05:18,800
miracle you ever see this i am so sorry

162
00:05:18,800 --> 00:05:20,240
for using a picture of you where you

163
00:05:20,240 --> 00:05:22,800
look so soft right like i just wanted

164
00:05:22,800 --> 00:05:24,639
something with his name on it like all

165
00:05:24,639 --> 00:05:26,080
the respect in the world i know this

166
00:05:26,080 --> 00:05:27,600
isn't the best pick but it had your name

167
00:05:27,600 --> 00:05:30,240
on it so i'm sorry he did a fox sitcom

168
00:05:30,240 --> 00:05:32,000
called methane and red with red man some

169
00:05:32,000 --> 00:05:34,720
of this he brought on himself

170
00:05:34,720 --> 00:05:36,160
so

171
00:05:36,160 --> 00:05:37,840
one option to kind of figure out and try

172
00:05:37,840 --> 00:05:39,360
to accomplish this

173
00:05:39,360 --> 00:05:41,039
is to look for persistent digital

174
00:05:41,039 --> 00:05:42,639
signatures and this is what i mean by

175
00:05:42,639 --> 00:05:43,680
that

176
00:05:43,680 --> 00:05:46,400
go to starbucks and grab a drink

177
00:05:46,400 --> 00:05:48,720
go hit a gas station top off the gas

178
00:05:48,720 --> 00:05:50,400
tank now go to a bookstore if you can

179
00:05:50,400 --> 00:05:52,800
find one post up for a few minutes read

180
00:05:52,800 --> 00:05:55,199
a magazine and then take a look and see

181
00:05:55,199 --> 00:05:57,680
what digital signals that i see at all

182
00:05:57,680 --> 00:05:59,440
three locations right if i saw a device

183
00:05:59,440 --> 00:06:01,440
at all three of those locations

184
00:06:01,440 --> 00:06:02,960
could be an indication that potentially

185
00:06:02,960 --> 00:06:04,880
i'm being followed and this is kind of

186
00:06:04,880 --> 00:06:06,800
the the methodology that he had heard me

187
00:06:06,800 --> 00:06:08,560
speak about years ago he just couldn't

188
00:06:08,560 --> 00:06:10,160
find anything that actually implemented

189
00:06:10,160 --> 00:06:12,479
it and his technical people for his

190
00:06:12,479 --> 00:06:13,759
agency couldn't either and like i said

191
00:06:13,759 --> 00:06:15,440
i'm like shoot i'll give it a try right

192
00:06:15,440 --> 00:06:17,360
let's do it

193
00:06:17,360 --> 00:06:18,800
so what we're going to do is accomplish

194
00:06:18,800 --> 00:06:21,039
this by passively detecting wireless and

195
00:06:21,039 --> 00:06:23,039
bluetooth devices that we observe around

196
00:06:23,039 --> 00:06:25,680
us 100 passive this doesn't do anything

197
00:06:25,680 --> 00:06:27,120
to try to connect to them try to follow

198
00:06:27,120 --> 00:06:29,199
them nothing like that at all 100

199
00:06:29,199 --> 00:06:30,800
passive there are some things we could

200
00:06:30,800 --> 00:06:32,560
do that are close to passive that

201
00:06:32,560 --> 00:06:34,000
honestly wouldn't probably get us in

202
00:06:34,000 --> 00:06:35,759
trouble or detected but i wanted to keep

203
00:06:35,759 --> 00:06:38,160
this 100 passive

204
00:06:38,160 --> 00:06:40,560
the devices could be part of an active

205
00:06:40,560 --> 00:06:42,319
network connection you know we have a

206
00:06:42,319 --> 00:06:44,000
lot of now vehicles that are giving out

207
00:06:44,000 --> 00:06:45,680
wireless and so people's devices will be

208
00:06:45,680 --> 00:06:47,120
connecting to that so we need to look at

209
00:06:47,120 --> 00:06:48,880
that but we also need to be looking out

210
00:06:48,880 --> 00:06:50,319
for vehicles that are not part of an

211
00:06:50,319 --> 00:06:52,400
active connection but are therefore

212
00:06:52,400 --> 00:06:53,840
looking for an active connection or

213
00:06:53,840 --> 00:06:54,880
they're looking for networks that

214
00:06:54,880 --> 00:06:58,400
they've connected to historically

215
00:06:58,400 --> 00:07:01,360
so hardware right keep it cheap stuff

216
00:07:01,360 --> 00:07:02,960
that probably a lot of us have sitting

217
00:07:02,960 --> 00:07:05,280
around anyway and it started off for me

218
00:07:05,280 --> 00:07:07,039
with a raspberry pi because i have a

219
00:07:07,039 --> 00:07:08,800
closet full of raspberry pies for some

220
00:07:08,800 --> 00:07:10,000
reason right there's like two of them

221
00:07:10,000 --> 00:07:12,160
that i actually used but i had two

222
00:07:12,160 --> 00:07:14,400
raspberry pi 3s that are like still in a

223
00:07:14,400 --> 00:07:16,479
box you know never been touched i'm like

224
00:07:16,479 --> 00:07:18,800
sweet here we go so i made a one for him

225
00:07:18,800 --> 00:07:20,240
and one for me just kind of testing him

226
00:07:20,240 --> 00:07:22,240
out certain things like that so once

227
00:07:22,240 --> 00:07:24,000
again this is hardware and it's not the

228
00:07:24,000 --> 00:07:25,039
only thing you could usually use a

229
00:07:25,039 --> 00:07:26,479
beaglebone or a lot of other type of

230
00:07:26,479 --> 00:07:27,919
stuff too but this is what i had

231
00:07:27,919 --> 00:07:30,800
available for free a lot of us probably

232
00:07:30,800 --> 00:07:32,880
have alpha wi-fi cards or other quality

233
00:07:32,880 --> 00:07:34,960
wi-fi cards available for two when i

234
00:07:34,960 --> 00:07:36,240
started working on this project and i

235
00:07:36,240 --> 00:07:39,120
had like six seven alphas probably but i

236
00:07:39,120 --> 00:07:41,120
went to the kismet the wireless software

237
00:07:41,120 --> 00:07:42,479
we're going to talk about in a second

238
00:07:42,479 --> 00:07:44,800
they run a very very good discord server

239
00:07:44,800 --> 00:07:46,639
i went to the kismet discord center and

240
00:07:46,639 --> 00:07:48,560
i asked them like hey what is in

241
00:07:48,560 --> 00:07:50,319
everyone's opinion kind of the best card

242
00:07:50,319 --> 00:07:52,160
out there and it was fairly universal

243
00:07:52,160 --> 00:07:53,599
for this model right here you see the

244
00:07:53,599 --> 00:07:55,759
awso36

245
00:07:55,759 --> 00:07:58,879
very very good 2.4 5 gig and 5 gigahertz

246
00:07:58,879 --> 00:08:00,800
both very very good range

247
00:08:00,800 --> 00:08:02,639
the form factor honestly isn't my

248
00:08:02,639 --> 00:08:04,560
favorite i like the old style better but

249
00:08:04,560 --> 00:08:06,319
it comes with like a 3 foot usb

250
00:08:06,319 --> 00:08:07,840
extension cord so it actually makes it

251
00:08:07,840 --> 00:08:09,280
far more usable so it doesn't have to be

252
00:08:09,280 --> 00:08:10,639
like sticking right out of the side if

253
00:08:10,639 --> 00:08:13,840
you don't want it to be

254
00:08:14,160 --> 00:08:15,599
for a power source since this was

255
00:08:15,599 --> 00:08:16,879
designed to be used in a vehicle

256
00:08:16,879 --> 00:08:17,919
honestly i could have just gone

257
00:08:17,919 --> 00:08:19,120
cigarette lighter but i wanted to make

258
00:08:19,120 --> 00:08:20,720
it a little more portable than that kind

259
00:08:20,720 --> 00:08:22,879
of you'll see like self-contained when

260
00:08:22,879 --> 00:08:24,319
it looks like a tangled mess and a

261
00:08:24,319 --> 00:08:26,960
little pelican case but it's a uh just

262
00:08:26,960 --> 00:08:28,400
like a little anchor battery pack and

263
00:08:28,400 --> 00:08:29,680
now i switched to a more powerful

264
00:08:29,680 --> 00:08:32,320
battery pack a a cheap little battery

265
00:08:32,320 --> 00:08:33,679
pack that i had just like a normal

266
00:08:33,679 --> 00:08:35,200
anchor like probably even smaller than

267
00:08:35,200 --> 00:08:36,958
this will power up with the pi with the

268
00:08:36,958 --> 00:08:39,519
wi-fi for i think it was just under

269
00:08:39,519 --> 00:08:41,039
eight hours so it was like seven hours

270
00:08:41,039 --> 00:08:43,440
and 50 minutes then i got another more

271
00:08:43,440 --> 00:08:45,519
uh beefy or battery pack and it'll power

272
00:08:45,519 --> 00:08:48,720
it for about 24 hours

273
00:08:49,279 --> 00:08:50,640
the one thing that i didn't have that i

274
00:08:50,640 --> 00:08:52,880
had to buy was a screen like a little

275
00:08:52,880 --> 00:08:54,720
screen for my pie and they have a bunch

276
00:08:54,720 --> 00:08:56,000
of different form factors right they

277
00:08:56,000 --> 00:08:57,360
have like seven inch screens they have a

278
00:08:57,360 --> 00:08:59,200
tiny little ones like this i just got

279
00:08:59,200 --> 00:09:00,480
the tiny little one with the case i

280
00:09:00,480 --> 00:09:04,080
think it was like 22 23 off amazon

281
00:09:04,080 --> 00:09:06,000
i put the screen on installed the

282
00:09:06,000 --> 00:09:08,080
drivers on the pi screen worked great it

283
00:09:08,080 --> 00:09:10,240
was perfect then i started testing it

284
00:09:10,240 --> 00:09:12,000
and like an hour or two later i noticed

285
00:09:12,000 --> 00:09:14,000
wait a second i'm not seeing bluetooth

286
00:09:14,000 --> 00:09:15,360
anymore

287
00:09:15,360 --> 00:09:17,040
i tried to troubleshoot it yeah you know

288
00:09:17,040 --> 00:09:18,800
what blew the image away reinstalled the

289
00:09:18,800 --> 00:09:20,959
image bluetooth works now great went

290
00:09:20,959 --> 00:09:22,399
through everything installed the drivers

291
00:09:22,399 --> 00:09:24,160
for the screen and now it killed the

292
00:09:24,160 --> 00:09:26,240
bluetooth and so i realized that the

293
00:09:26,240 --> 00:09:27,519
drivers for this screen were actually

294
00:09:27,519 --> 00:09:29,279
killing the bluetooth i googled it was

295
00:09:29,279 --> 00:09:30,640
like a well-known issue and no one

296
00:09:30,640 --> 00:09:32,560
seemed to have a fix for it so at that

297
00:09:32,560 --> 00:09:34,080
point i'm like well i can try to

298
00:09:34,080 --> 00:09:36,160
troubleshoot this or i can spend like

299
00:09:36,160 --> 00:09:37,920
three dollars on amazon for a little

300
00:09:37,920 --> 00:09:40,240
bluetooth usb adapter and just solve

301
00:09:40,240 --> 00:09:42,640
this problem so yeah big surprise which

302
00:09:42,640 --> 00:09:44,880
way i went right so this worked fine

303
00:09:44,880 --> 00:09:46,000
with the pi and it added in the

304
00:09:46,000 --> 00:09:47,680
bluetooth capabilities and saved me from

305
00:09:47,680 --> 00:09:49,519
linux troubleshooting because ain't no

306
00:09:49,519 --> 00:09:52,320
one got time for all that

307
00:09:52,320 --> 00:09:53,120
all right so that was kind of the

308
00:09:53,120 --> 00:09:54,959
hardware side of it what about the

309
00:09:54,959 --> 00:09:57,200
software side all completely free all

310
00:09:57,200 --> 00:09:58,800
open source right and what it starts and

311
00:09:58,800 --> 00:10:00,959
it ends with kismet if you played with

312
00:10:00,959 --> 00:10:03,519
wireless before kismet is fantastic you

313
00:10:03,519 --> 00:10:04,959
know the new version is even quite a bit

314
00:10:04,959 --> 00:10:06,640
better than the old version if you

315
00:10:06,640 --> 00:10:08,079
haven't you're interested in wireless

316
00:10:08,079 --> 00:10:10,720
it's a great place to start totally free

317
00:10:10,720 --> 00:10:13,360
open source does a ton of great stuff it

318
00:10:13,360 --> 00:10:15,839
can try to detect wireless attacks tries

319
00:10:15,839 --> 00:10:17,760
to automatically capture like handshakes

320
00:10:17,760 --> 00:10:21,200
from wpk certain things like that it uh

321
00:10:21,200 --> 00:10:23,440
it can try to detect drones which is

322
00:10:23,440 --> 00:10:24,560
kind of limited because a lot of the

323
00:10:24,560 --> 00:10:26,480
newer ones right they don't use like the

324
00:10:26,480 --> 00:10:28,079
you know the new dgis and stuff don't

325
00:10:28,079 --> 00:10:29,680
use wi-fi anymore they use kind of a

326
00:10:29,680 --> 00:10:32,000
little custom protocol but it has all of

327
00:10:32,000 --> 00:10:34,160
these really really amazing features and

328
00:10:34,160 --> 00:10:35,760
it's not just wi-fi or bluetooth it's

329
00:10:35,760 --> 00:10:37,920
zigbee it's sdr it's all this and i'm

330
00:10:37,920 --> 00:10:40,160
using like none of the cool features

331
00:10:40,160 --> 00:10:42,240
it's such amazing software and i'm using

332
00:10:42,240 --> 00:10:44,640
none what i'm using is the fact that by

333
00:10:44,640 --> 00:10:46,399
default everything it's sniffing

334
00:10:46,399 --> 00:10:47,760
everything it's detecting and it's all

335
00:10:47,760 --> 00:10:49,760
completely passive it's all writing it

336
00:10:49,760 --> 00:10:52,079
down to a sqlite database the file

337
00:10:52,079 --> 00:10:54,320
extension is a dot kismet file but it's

338
00:10:54,320 --> 00:10:56,560
actually a sqlite database

339
00:10:56,560 --> 00:10:58,720
you can have it generate pcaps and other

340
00:10:58,720 --> 00:11:00,480
things as well there's uh there's

341
00:11:00,480 --> 00:11:03,040
actually no need to because if you're

342
00:11:03,040 --> 00:11:04,560
trying to do that on the fly live as

343
00:11:04,560 --> 00:11:05,680
you're capturing it's more

344
00:11:05,680 --> 00:11:07,120
computationally expensive right it's

345
00:11:07,120 --> 00:11:08,640
more horsepower to try to be capturing

346
00:11:08,640 --> 00:11:10,640
in that format and if you capture it in

347
00:11:10,640 --> 00:11:12,880
the sqlite database it does such a good

348
00:11:12,880 --> 00:11:14,560
job at capturing that that you can

349
00:11:14,560 --> 00:11:16,399
actually take and generate a pcap from

350
00:11:16,399 --> 00:11:18,560
that after the fact so there's really

351
00:11:18,560 --> 00:11:19,920
like i said you can just kind of capture

352
00:11:19,920 --> 00:11:21,600
the sqlite database and then if you need

353
00:11:21,600 --> 00:11:22,399
to

354
00:11:22,399 --> 00:11:25,680
do anything else off of that

355
00:11:25,760 --> 00:11:27,519
everything else is just python or shell

356
00:11:27,519 --> 00:11:29,120
scripts right it really is and you can

357
00:11:29,120 --> 00:11:31,920
see my shoddy python code i made the

358
00:11:31,920 --> 00:11:34,560
github live yesterday it's i'm not a

359
00:11:34,560 --> 00:11:36,480
professional programmer right i would

360
00:11:36,480 --> 00:11:38,240
never insult programmers by calling

361
00:11:38,240 --> 00:11:39,600
myself one

362
00:11:39,600 --> 00:11:41,600
i can write what i consider ugly but

363
00:11:41,600 --> 00:11:43,920
functional python code that helps me

364
00:11:43,920 --> 00:11:45,680
helps my friends helps my teammates

365
00:11:45,680 --> 00:11:47,600
right that's really kind of what it is

366
00:11:47,600 --> 00:11:49,600
so i try to comment things and make my

367
00:11:49,600 --> 00:11:51,200
code as easy to manipulate and

368
00:11:51,200 --> 00:11:53,120
understand as possible and you know

369
00:11:53,120 --> 00:11:54,560
rather than trying to maybe make it a

370
00:11:54,560 --> 00:11:56,800
super elegant and concise just because

371
00:11:56,800 --> 00:11:58,399
number one it's easier for me to kind of

372
00:11:58,399 --> 00:12:00,000
troubleshoot and maintain and switch up

373
00:12:00,000 --> 00:12:01,519
later and i think it makes it easier for

374
00:12:01,519 --> 00:12:04,320
other people as well

375
00:12:04,800 --> 00:12:06,800
any time right

376
00:12:06,800 --> 00:12:08,320
any time you're going to speak and i

377
00:12:08,320 --> 00:12:10,320
speak all the time i'm a sans instructor

378
00:12:10,320 --> 00:12:11,760
i've spoken a lot of conferences i've

379
00:12:11,760 --> 00:12:13,839
done all that any time you go to speak

380
00:12:13,839 --> 00:12:16,079
right the imposter syndrome kicks in you

381
00:12:16,079 --> 00:12:17,360
know you start asking yourself like you

382
00:12:17,360 --> 00:12:18,959
know who the heck am i to be doing this

383
00:12:18,959 --> 00:12:20,639
you know and everything else and

384
00:12:20,639 --> 00:12:21,920
especially when you're going to write

385
00:12:21,920 --> 00:12:23,440
python code

386
00:12:23,440 --> 00:12:24,800
you know when you start i've had to

387
00:12:24,800 --> 00:12:26,720
testify in court before based on python

388
00:12:26,720 --> 00:12:28,639
code i wrote for forensics and it was

389
00:12:28,639 --> 00:12:30,560
like wow you know like everyone in the

390
00:12:30,560 --> 00:12:31,920
court's gonna like know like the judge

391
00:12:31,920 --> 00:12:33,519
is gonna call me out for like the crappy

392
00:12:33,519 --> 00:12:35,279
way that i handled a format string or

393
00:12:35,279 --> 00:12:37,760
something you know

394
00:12:37,760 --> 00:12:39,680
and everything went fine but it's like

395
00:12:39,680 --> 00:12:42,000
still it's you know so i try to remind

396
00:12:42,000 --> 00:12:44,160
myself right like perfect is the enemy

397
00:12:44,160 --> 00:12:45,440
of good right you don't worry about it

398
00:12:45,440 --> 00:12:46,560
just get something out there doesn't

399
00:12:46,560 --> 00:12:48,399
mean you don't do the best you can and

400
00:12:48,399 --> 00:12:50,160
you try to just like you know take a

401
00:12:50,160 --> 00:12:52,160
dump and then throw it out there but

402
00:12:52,160 --> 00:12:53,680
also like i said just throw something

403
00:12:53,680 --> 00:12:55,200
out there right and i love that quote

404
00:12:55,200 --> 00:12:56,959
too by robert watson watt and he was the

405
00:12:56,959 --> 00:12:59,120
gentleman who was designed with um

406
00:12:59,120 --> 00:13:00,560
trying to set up the air defense system

407
00:13:00,560 --> 00:13:02,320
in london during world war ii to protect

408
00:13:02,320 --> 00:13:04,000
him from the air raids and it's a little

409
00:13:04,000 --> 00:13:05,519
bit of a depressing quote but give them

410
00:13:05,519 --> 00:13:07,040
the third best option to go with the

411
00:13:07,040 --> 00:13:08,720
second best comes too late and the best

412
00:13:08,720 --> 00:13:10,079
never comes

413
00:13:10,079 --> 00:13:11,920
anyone who's been doing most things for

414
00:13:11,920 --> 00:13:13,200
a while kind of realizes that's

415
00:13:13,200 --> 00:13:16,639
unfortunately very very true

416
00:13:16,639 --> 00:13:18,320
so we talked about this by default

417
00:13:18,320 --> 00:13:20,560
kismet starts up a new sql live file

418
00:13:20,560 --> 00:13:22,160
every single time you start it it's got

419
00:13:22,160 --> 00:13:24,720
that kismet extension so what our python

420
00:13:24,720 --> 00:13:26,240
code does we always have it spit out to

421
00:13:26,240 --> 00:13:27,839
the same directory and i've got the

422
00:13:27,839 --> 00:13:29,440
python code when you actually start up

423
00:13:29,440 --> 00:13:32,240
the program because kismet i wrote i um

424
00:13:32,240 --> 00:13:33,839
i set kismet up to start up as soon as

425
00:13:33,839 --> 00:13:35,519
the box boots up or like 30 seconds

426
00:13:35,519 --> 00:13:37,440
after boot up so then whenever you run

427
00:13:37,440 --> 00:13:38,959
this code that we're going to see to

428
00:13:38,959 --> 00:13:40,800
kind of tell if you're being followed it

429
00:13:40,800 --> 00:13:42,480
goes to that directory and it grabs the

430
00:13:42,480 --> 00:13:44,320
very newest kismet file and that's what

431
00:13:44,320 --> 00:13:48,519
it starts incorporating as a source

432
00:13:51,440 --> 00:13:53,279
all right so now what about the

433
00:13:53,279 --> 00:13:55,040
methodology right kind of the fun part

434
00:13:55,040 --> 00:13:58,639
there absolutely were some puzzles here

435
00:13:59,519 --> 00:14:00,480
so

436
00:14:00,480 --> 00:14:02,720
to see if there's any wi-fi or bluetooth

437
00:14:02,720 --> 00:14:04,560
devices currently in the area which i

438
00:14:04,560 --> 00:14:06,959
also saw five to ten minutes ago 10 to

439
00:14:06,959 --> 00:14:09,360
15 minutes ago and 15 to 20 minutes ago

440
00:14:09,360 --> 00:14:10,880
right because conceptually i thought

441
00:14:10,880 --> 00:14:12,959
like you go to location a then you go to

442
00:14:12,959 --> 00:14:15,680
location b and you go to location c

443
00:14:15,680 --> 00:14:16,800
and you do that but when you try to

444
00:14:16,800 --> 00:14:18,800
start executing you realize now you kind

445
00:14:18,800 --> 00:14:20,399
of actually needs to be rolling right it

446
00:14:20,399 --> 00:14:21,519
kind of does need to be rolling

447
00:14:21,519 --> 00:14:22,639
especially if you're going to be driving

448
00:14:22,639 --> 00:14:24,639
around certain things like that we need

449
00:14:24,639 --> 00:14:26,959
that to constantly turn over

450
00:14:26,959 --> 00:14:28,720
if there are if there are any devices

451
00:14:28,720 --> 00:14:30,720
that i'm seeing right now that i also

452
00:14:30,720 --> 00:14:33,199
saw five to 10 minutes ago 10 to 15

453
00:14:33,199 --> 00:14:35,680
minutes ago or 15 to 20 minutes ago

454
00:14:35,680 --> 00:14:37,279
fire me an alert give me a little bit of

455
00:14:37,279 --> 00:14:39,120
information is it wi-fi access point is

456
00:14:39,120 --> 00:14:41,279
it a wi-fi device is it bluetooth low

457
00:14:41,279 --> 00:14:43,839
energy what are we actually looking for

458
00:14:43,839 --> 00:14:45,279
and right now you see this and you're

459
00:14:45,279 --> 00:14:47,120
like wait a second so you're telling me

460
00:14:47,120 --> 00:14:49,839
all the data's dumped in a database

461
00:14:49,839 --> 00:14:51,199
and now you want like this is the

462
00:14:51,199 --> 00:14:53,440
world's simplest sql query right show me

463
00:14:53,440 --> 00:14:55,120
anything i'm seeing right now

464
00:14:55,120 --> 00:14:56,800
that is in the database in this time

465
00:14:56,800 --> 00:14:58,560
range or this time range or this time

466
00:14:58,560 --> 00:15:01,040
range we actually can't do that though

467
00:15:01,040 --> 00:15:03,440
we really can't it's not solvable with a

468
00:15:03,440 --> 00:15:05,920
simple sql query because at least in the

469
00:15:05,920 --> 00:15:08,079
normalized there's a lot of data in the

470
00:15:08,079 --> 00:15:10,399
sqlite database in json there's a lot of

471
00:15:10,399 --> 00:15:12,480
like nested json that we kind of need to

472
00:15:12,480 --> 00:15:14,399
step down too and we'll see an example

473
00:15:14,399 --> 00:15:16,560
of that in a few slides but as far as

474
00:15:16,560 --> 00:15:18,079
the fields that are normalized for

475
00:15:18,079 --> 00:15:19,680
everything that it's seeing like a wi-fi

476
00:15:19,680 --> 00:15:21,680
access point or a wi-fi client or

477
00:15:21,680 --> 00:15:23,360
bluetooth low energy whatever it is

478
00:15:23,360 --> 00:15:24,160
there

479
00:15:24,160 --> 00:15:27,279
for a mac address it has the first time

480
00:15:27,279 --> 00:15:29,199
that it detected that and it has the

481
00:15:29,199 --> 00:15:30,959
most recent time that it detected that

482
00:15:30,959 --> 00:15:32,000
but it doesn't have everything in

483
00:15:32,000 --> 00:15:33,040
between

484
00:15:33,040 --> 00:15:34,560
so it's not just as simple as saying

485
00:15:34,560 --> 00:15:36,480
show me everything now and then show me

486
00:15:36,480 --> 00:15:37,839
everything five to ten you know that

487
00:15:37,839 --> 00:15:39,199
kind of that we can't solve that in a

488
00:15:39,199 --> 00:15:41,120
query but there is a solution and once

489
00:15:41,120 --> 00:15:42,240
again i'm not saying this is the only

490
00:15:42,240 --> 00:15:43,759
way to do it i'm just saying it's the

491
00:15:43,759 --> 00:15:45,519
way that my mind kind of thought to do

492
00:15:45,519 --> 00:15:47,920
it and it's to start making lists so

493
00:15:47,920 --> 00:15:49,920
like i said i have kismet set up to

494
00:15:49,920 --> 00:15:51,600
automatically fire off his suit right

495
00:15:51,600 --> 00:15:54,240
after the box boots up

496
00:15:54,240 --> 00:15:55,839
when you actually go to execute this

497
00:15:55,839 --> 00:15:57,920
code and i'll show you my laughable gui

498
00:15:57,920 --> 00:15:59,199
like you'll have to take off your masks

499
00:15:59,199 --> 00:16:00,800
you're laughing so hard on my horrible

500
00:16:00,800 --> 00:16:02,639
horrible user interface

501
00:16:02,639 --> 00:16:05,120
but if you uh

502
00:16:05,120 --> 00:16:06,959
if when that code starts up it goes into

503
00:16:06,959 --> 00:16:09,600
that kismet.kismet file and it says okay

504
00:16:09,600 --> 00:16:11,040
give me a list of all the devices that i

505
00:16:11,040 --> 00:16:14,160
saw five to 10 minutes ago last 10 to 15

506
00:16:14,160 --> 00:16:16,000
15 to 20 and it takes those and it puts

507
00:16:16,000 --> 00:16:17,600
them in a list

508
00:16:17,600 --> 00:16:19,680
now it initializes a list of current

509
00:16:19,680 --> 00:16:21,680
devices that i'm kind of seeing around

510
00:16:21,680 --> 00:16:22,399
me

511
00:16:22,399 --> 00:16:24,959
and now every minute i add any devices

512
00:16:24,959 --> 00:16:27,199
that i'm seeing into that current device

513
00:16:27,199 --> 00:16:28,480
list

514
00:16:28,480 --> 00:16:30,160
like i said this needs to be rolling if

515
00:16:30,160 --> 00:16:31,360
you're going to be using it on like a

516
00:16:31,360 --> 00:16:33,519
two hour drive or something so every

517
00:16:33,519 --> 00:16:36,800
five minutes we take the current list

518
00:16:36,800 --> 00:16:38,480
and now we make that the new five to ten

519
00:16:38,480 --> 00:16:40,079
minute list

520
00:16:40,079 --> 00:16:41,839
the old five to ten minute list becomes

521
00:16:41,839 --> 00:16:44,240
the 10 to 15 minute list so on we drop

522
00:16:44,240 --> 00:16:46,800
the 15 to 20 and that just continues on

523
00:16:46,800 --> 00:16:48,240
a loop because at every minute it's

524
00:16:48,240 --> 00:16:50,000
looking for new devices every five

525
00:16:50,000 --> 00:16:51,680
minutes it kind of rolls over and does

526
00:16:51,680 --> 00:16:53,440
that like i said not saying it's the

527
00:16:53,440 --> 00:16:54,880
best way to do it it was the way that

528
00:16:54,880 --> 00:16:58,399
kind of my mind thought to do it

529
00:16:58,399 --> 00:17:00,079
every minute we grabbed the devices that

530
00:17:00,079 --> 00:17:01,680
have been seen in the previous 60

531
00:17:01,680 --> 00:17:03,600
seconds see if any of them are in the 5

532
00:17:03,600 --> 00:17:06,319
to 10 10 to 15 or 15 20 minute list and

533
00:17:06,319 --> 00:17:09,520
print an alert to the screen if so

534
00:17:09,520 --> 00:17:10,720
so

535
00:17:10,720 --> 00:17:12,559
we don't want to alert on ourselves

536
00:17:12,559 --> 00:17:14,400
right yeah it's like just kind of like

537
00:17:14,400 --> 00:17:15,919
common sense and if you've ever like

538
00:17:15,919 --> 00:17:17,039
played in this role in the signals

539
00:17:17,039 --> 00:17:18,799
intelligence she stuff and you know like

540
00:17:18,799 --> 00:17:21,039
if we all were meeting together before

541
00:17:21,039 --> 00:17:23,119
we were gonna like go do a mission what

542
00:17:23,119 --> 00:17:24,400
we would all do right as we would all

543
00:17:24,400 --> 00:17:25,599
like okay does everyone have their own

544
00:17:25,599 --> 00:17:26,959
devices they're gonna take with them

545
00:17:26,959 --> 00:17:28,880
right now and turned on everyone got

546
00:17:28,880 --> 00:17:31,360
that okay cool now i'm gonna basically

547
00:17:31,360 --> 00:17:33,360
push a button and make an ignore list of

548
00:17:33,360 --> 00:17:35,600
every device that i'm seeing so far and

549
00:17:35,600 --> 00:17:37,280
now that's basically going to be a list

550
00:17:37,280 --> 00:17:39,440
of devices whatever else that i don't

551
00:17:39,440 --> 00:17:40,960
care about going forward right that way

552
00:17:40,960 --> 00:17:43,280
we don't alert on ourselves so we added

553
00:17:43,280 --> 00:17:45,600
in the same functionality right at any

554
00:17:45,600 --> 00:17:48,160
point you can create or delete an ignore

555
00:17:48,160 --> 00:17:50,320
list of every mac address that you've

556
00:17:50,320 --> 00:17:52,480
seen in that latest kismet file and so

557
00:17:52,480 --> 00:17:53,600
that way like i said if you're going to

558
00:17:53,600 --> 00:17:55,039
be driving somewhere and once you're

559
00:17:55,039 --> 00:17:56,080
there then now is when you're going to

560
00:17:56,080 --> 00:17:59,039
kind of get worried you can fire this up

561
00:17:59,039 --> 00:18:00,799
let it go on your whole drive there and

562
00:18:00,799 --> 00:18:02,640
now when you start getting close you can

563
00:18:02,640 --> 00:18:04,080
create that ignore list of everything

564
00:18:04,080 --> 00:18:05,360
you've seen so far because you don't

565
00:18:05,360 --> 00:18:07,600
really care about that so once again not

566
00:18:07,600 --> 00:18:09,039
saying that was the only way but this is

567
00:18:09,039 --> 00:18:10,480
pretty standard and kind of the signals

568
00:18:10,480 --> 00:18:12,080
intelligence and certain like that world

569
00:18:12,080 --> 00:18:14,000
so we definitely needed to add in this

570
00:18:14,000 --> 00:18:16,720
functionality

571
00:18:16,960 --> 00:18:17,760
so

572
00:18:17,760 --> 00:18:19,760
wait a second how do you do all this on

573
00:18:19,760 --> 00:18:21,520
a tiny touch screen alright imagine

574
00:18:21,520 --> 00:18:22,799
you're driving

575
00:18:22,799 --> 00:18:24,240
right to do something and now you have

576
00:18:24,240 --> 00:18:26,000
this like tiny little like you know

577
00:18:26,000 --> 00:18:27,919
three and a half inch raspberry pi touch

578
00:18:27,919 --> 00:18:28,960
screen

579
00:18:28,960 --> 00:18:30,720
and let's be honest what do we need

580
00:18:30,720 --> 00:18:33,039
right this needs to be like the world's

581
00:18:33,039 --> 00:18:36,240
ugliest most basic fisher-price my first

582
00:18:36,240 --> 00:18:39,039
gui like that's what we need here so

583
00:18:39,039 --> 00:18:40,640
like don't laugh

584
00:18:40,640 --> 00:18:42,320
just kidding you can totally laugh like

585
00:18:42,320 --> 00:18:43,600
i would lose respect for you if you

586
00:18:43,600 --> 00:18:46,000
didn't laugh but this is kind of the uh

587
00:18:46,000 --> 00:18:47,919
you know get a you know what's sad you

588
00:18:47,919 --> 00:18:49,440
know what's sad i think i was sober when

589
00:18:49,440 --> 00:18:51,440
i wrote most of this like that's

590
00:18:51,440 --> 00:18:53,200
i wish i could at least tell you like

591
00:18:53,200 --> 00:18:55,120
listen i was three old fashioned zinn

592
00:18:55,120 --> 00:18:57,360
right don't judge me too harshly

593
00:18:57,360 --> 00:18:59,280
but i actually think i was sober not i

594
00:18:59,280 --> 00:19:00,720
wasn't sober for like a lot of the code

595
00:19:00,720 --> 00:19:03,280
but for this part i actually think i was

596
00:19:03,280 --> 00:19:05,360
but i mean like i said seriously think

597
00:19:05,360 --> 00:19:06,720
about it like i said if you're driving

598
00:19:06,720 --> 00:19:08,480
around in certain things like that this

599
00:19:08,480 --> 00:19:10,000
is the best way that i can think of on

600
00:19:10,000 --> 00:19:11,520
the screen you know taking more time in

601
00:19:11,520 --> 00:19:12,880
it i'd probably

602
00:19:12,880 --> 00:19:14,080
maybe make something a little more

603
00:19:14,080 --> 00:19:16,400
elegant but i mean even with my big

604
00:19:16,400 --> 00:19:18,160
finger you know i can still kind of sit

605
00:19:18,160 --> 00:19:19,760
there with a little stylus or something

606
00:19:19,760 --> 00:19:21,919
and i can still hit the buttons to check

607
00:19:21,919 --> 00:19:23,520
the status what it does it just pops

608
00:19:23,520 --> 00:19:25,440
open a little window and it checks to

609
00:19:25,440 --> 00:19:26,799
make sure that you have a wireless

610
00:19:26,799 --> 00:19:28,480
device that's in monitor mode right we

611
00:19:28,480 --> 00:19:29,600
have to be able to put it in monitor

612
00:19:29,600 --> 00:19:31,280
mode to do this and it checks to make

613
00:19:31,280 --> 00:19:33,360
sure kismet is running if it detects

614
00:19:33,360 --> 00:19:35,440
those things it displays that knowledge

615
00:19:35,440 --> 00:19:37,039
in green if it doesn't detect those

616
00:19:37,039 --> 00:19:38,799
things it displays in red so checking

617
00:19:38,799 --> 00:19:40,640
status kind of does that just makes it

618
00:19:40,640 --> 00:19:42,400
very very simple green or red to know

619
00:19:42,400 --> 00:19:44,320
that everything is good to go create

620
00:19:44,320 --> 00:19:46,720
ignore list delete ignore lists and then

621
00:19:46,720 --> 00:19:48,799
run chasing your tail which is just the

622
00:19:48,799 --> 00:19:51,760
the name that i called my python code so

623
00:19:51,760 --> 00:19:53,520
world's ugliest gooey i know all right

624
00:19:53,520 --> 00:19:56,160
back to the uh sorry

625
00:19:56,160 --> 00:19:57,120
sorry

626
00:19:57,120 --> 00:19:59,200
so now the fun part time for some field

627
00:19:59,200 --> 00:20:00,640
testing right time for some field

628
00:20:00,640 --> 00:20:01,679
testing

629
00:20:01,679 --> 00:20:04,000
so what i did is this had been working

630
00:20:04,000 --> 00:20:06,960
great in the office or at my house and

631
00:20:06,960 --> 00:20:08,400
so now hey let's take it out in the

632
00:20:08,400 --> 00:20:09,919
middle of nowhere start turning on some

633
00:20:09,919 --> 00:20:11,840
devices and start seeing what happens

634
00:20:11,840 --> 00:20:13,679
and it's actually like a year ago when i

635
00:20:13,679 --> 00:20:16,080
was living in washington dc it's easier

636
00:20:16,080 --> 00:20:17,600
said to done like to go out in the

637
00:20:17,600 --> 00:20:19,120
middle of nowhere right but that's one

638
00:20:19,120 --> 00:20:21,120
advantage of arizona i can very very

639
00:20:21,120 --> 00:20:22,480
easily go on the middle of nowhere

640
00:20:22,480 --> 00:20:24,720
there's a big desert all around us so i

641
00:20:24,720 --> 00:20:26,080
went to the middle of nowhere no one

642
00:20:26,080 --> 00:20:27,520
else around me started turning on some

643
00:20:27,520 --> 00:20:30,159
devices and i saw a squat

644
00:20:30,159 --> 00:20:31,679
right everything was working fine as i

645
00:20:31,679 --> 00:20:33,440
was testing it before but when i took in

646
00:20:33,440 --> 00:20:35,840
the middle of nowhere i saw nothing i'm

647
00:20:35,840 --> 00:20:37,200
like okay

648
00:20:37,200 --> 00:20:39,679
so but i was still capturing the data so

649
00:20:39,679 --> 00:20:41,520
i went back home

650
00:20:41,520 --> 00:20:43,360
i took the data that i had captured

651
00:20:43,360 --> 00:20:45,840
converted it to a pcap vial the akisma

652
00:20:45,840 --> 00:20:47,280
gives those utilities right there it's

653
00:20:47,280 --> 00:20:48,559
very very simple

654
00:20:48,559 --> 00:20:50,559
and i loaded it up in wireshark and this

655
00:20:50,559 --> 00:20:52,480
is what i saw right

656
00:20:52,480 --> 00:20:54,960
and i played with wireless before and so

657
00:20:54,960 --> 00:20:57,280
i knew that right modern devices for the

658
00:20:57,280 --> 00:20:59,280
past you know several years now start

659
00:20:59,280 --> 00:21:01,039
trying to randomize a mac address is

660
00:21:01,039 --> 00:21:03,760
like a safety sake right i knew

661
00:21:03,760 --> 00:21:06,640
mac address randomization was a thing

662
00:21:06,640 --> 00:21:09,440
i had no idea it was so frequent though

663
00:21:09,440 --> 00:21:12,000
this is two devices

664
00:21:12,000 --> 00:21:14,480
this is two devices in a very very short

665
00:21:14,480 --> 00:21:16,480
period of time and if you look on the

666
00:21:16,480 --> 00:21:19,120
very very far right right you see the

667
00:21:19,120 --> 00:21:21,440
ssid that they're probing for

668
00:21:21,440 --> 00:21:24,159
that's all the same network

669
00:21:24,159 --> 00:21:26,159
this is two devices

670
00:21:26,159 --> 00:21:29,120
using a different mac every single probe

671
00:21:29,120 --> 00:21:31,280
request looking for a network like

672
00:21:31,280 --> 00:21:32,799
that's crazy

673
00:21:32,799 --> 00:21:34,400
right that's absolutely crazy like i

674
00:21:34,400 --> 00:21:36,720
said i knew mac randomization is a thing

675
00:21:36,720 --> 00:21:38,080
normally i'm pacing all over the place

676
00:21:38,080 --> 00:21:39,679
but the microphone's right here i guess

677
00:21:39,679 --> 00:21:41,360
i could hold it but

678
00:21:41,360 --> 00:21:43,200
but yeah like i said it was just way way

679
00:21:43,200 --> 00:21:44,880
worse than i thought and it's like okay

680
00:21:44,880 --> 00:21:46,000
well

681
00:21:46,000 --> 00:21:46,720
i

682
00:21:46,720 --> 00:21:48,240
i need to compensate for this somehow

683
00:21:48,240 --> 00:21:49,120
right there's a couple different

684
00:21:49,120 --> 00:21:51,039
strategies here but i wanted to try to

685
00:21:51,039 --> 00:21:52,640
keep it to the passive one right that's

686
00:21:52,640 --> 00:21:54,640
why i want to try to keep this 100

687
00:21:54,640 --> 00:21:56,840
passive if at all possible and it

688
00:21:56,840 --> 00:21:59,520
was so the logic to look for mac

689
00:21:59,520 --> 00:22:01,600
addresses needs to be in place because

690
00:22:01,600 --> 00:22:03,120
once again right what happens if someone

691
00:22:03,120 --> 00:22:05,440
following you has their phone hooked up

692
00:22:05,440 --> 00:22:07,120
to their car wi-fi that's a very very

693
00:22:07,120 --> 00:22:08,880
common feature now well now the mac's

694
00:22:08,880 --> 00:22:10,240
not moving around right the mac is

695
00:22:10,240 --> 00:22:12,320
pretty stable so we need that mac

696
00:22:12,320 --> 00:22:13,919
address functionality for something that

697
00:22:13,919 --> 00:22:15,760
either doesn't spoof

698
00:22:15,760 --> 00:22:17,440
or is actually part of an active

699
00:22:17,440 --> 00:22:20,080
connection right we need that

700
00:22:20,080 --> 00:22:22,080
but now we're going to have to also add

701
00:22:22,080 --> 00:22:23,760
in some functionality to look for things

702
00:22:23,760 --> 00:22:26,080
that aren't part of an active network

703
00:22:26,080 --> 00:22:28,000
connection right and so therefore it's

704
00:22:28,000 --> 00:22:29,760
like all right well a wireless device by

705
00:22:29,760 --> 00:22:31,200
default right if it's not part of an

706
00:22:31,200 --> 00:22:32,559
active connection it's going to be

707
00:22:32,559 --> 00:22:34,000
looking for an active connection right

708
00:22:34,000 --> 00:22:36,000
what have i connected to before you know

709
00:22:36,000 --> 00:22:38,240
what have i connected to in the past

710
00:22:38,240 --> 00:22:39,440
it's going to be looking for those so

711
00:22:39,440 --> 00:22:41,760
let's try to use that

712
00:22:41,760 --> 00:22:44,080
so kismet normalizes some fields in the

713
00:22:44,080 --> 00:22:45,919
database but it's honestly not mini but

714
00:22:45,919 --> 00:22:47,679
as i said earlier there's a lot more

715
00:22:47,679 --> 00:22:50,159
kind of in a json blobs

716
00:22:50,159 --> 00:22:52,159
and so there you can see there the raw

717
00:22:52,159 --> 00:22:54,880
device json actually having it walk down

718
00:22:54,880 --> 00:22:56,960
it's nested json so that's the code i

719
00:22:56,960 --> 00:22:59,120
have dot 11 device

720
00:22:59,120 --> 00:23:01,520
down to there to the probed ssid record

721
00:23:01,520 --> 00:23:03,200
and then the name of actually the probed

722
00:23:03,200 --> 00:23:05,840
ssid and so this is actually the network

723
00:23:05,840 --> 00:23:07,919
names that they're looking for so now

724
00:23:07,919 --> 00:23:10,480
even if a device

725
00:23:10,480 --> 00:23:12,480
is constantly rotating its mac every

726
00:23:12,480 --> 00:23:14,480
time it's looking for the network i'm

727
00:23:14,480 --> 00:23:16,480
also monitoring for what networks it's

728
00:23:16,480 --> 00:23:18,720
looking for and i will start to use that

729
00:23:18,720 --> 00:23:20,960
same exact methodology i don't care what

730
00:23:20,960 --> 00:23:23,360
the mac is if i see a device look for

731
00:23:23,360 --> 00:23:25,760
you know samsung smart home now and then

732
00:23:25,760 --> 00:23:27,600
five ten minutes now in 10 to 15 minutes

733
00:23:27,600 --> 00:23:29,360
to now now i'm still going to alert on

734
00:23:29,360 --> 00:23:30,559
that we're still going to trigger on

735
00:23:30,559 --> 00:23:32,320
that so now i kind of have both bases

736
00:23:32,320 --> 00:23:33,600
covered if it's part of an active

737
00:23:33,600 --> 00:23:37,200
connection or not

738
00:23:37,200 --> 00:23:38,880
and to put a bow on this now we need to

739
00:23:38,880 --> 00:23:40,640
add this capability into our ignore

740
00:23:40,640 --> 00:23:42,559
lists too right before our ignore lists

741
00:23:42,559 --> 00:23:44,559
were only based off mac addresses so now

742
00:23:44,559 --> 00:23:46,480
when we have the ignore list we fire off

743
00:23:46,480 --> 00:23:48,240
both the mac addresses

744
00:23:48,240 --> 00:23:49,760
and the networks that they were looking

745
00:23:49,760 --> 00:23:51,520
for as well

746
00:23:51,520 --> 00:23:53,440
let's take a look at what this will look

747
00:23:53,440 --> 00:23:57,600
like actually to a user on the screen

748
00:23:57,840 --> 00:23:59,919
all right so you see started up there

749
00:23:59,919 --> 00:24:01,279
the date time

750
00:24:01,279 --> 00:24:03,840
says 308 max added to the ignore list

751
00:24:03,840 --> 00:24:05,360
right they were kind of loaded in there

752
00:24:05,360 --> 00:24:09,200
and 27 probed ssids right so 27 names of

753
00:24:09,200 --> 00:24:10,880
network that were loaded in

754
00:24:10,880 --> 00:24:12,480
it says the name of the logging file

755
00:24:12,480 --> 00:24:14,240
this is all written to a log file too so

756
00:24:14,240 --> 00:24:15,679
i'm going to kind of go back after the

757
00:24:15,679 --> 00:24:17,840
fact and see what happens and now it

758
00:24:17,840 --> 00:24:19,520
just kind of runs right now it just kind

759
00:24:19,520 --> 00:24:21,039
of goes like i said every minute it's

760
00:24:21,039 --> 00:24:23,039
checking it's updating and then every

761
00:24:23,039 --> 00:24:26,879
five minutes those lists roll over

762
00:24:26,960 --> 00:24:27,679
so

763
00:24:27,679 --> 00:24:29,200
this was uh this is running at my home

764
00:24:29,200 --> 00:24:30,960
so you have like a bunch of bluetooth

765
00:24:30,960 --> 00:24:32,880
low energy from a lot of home automation

766
00:24:32,880 --> 00:24:34,320
stuff that's why you see it kind of

767
00:24:34,320 --> 00:24:36,240
littered with there but now after

768
00:24:36,240 --> 00:24:37,600
running this for a little bit all of a

769
00:24:37,600 --> 00:24:39,200
sudden either one of my neighbors

770
00:24:39,200 --> 00:24:40,480
something like that turned on a new

771
00:24:40,480 --> 00:24:42,000
device someone came over to visit

772
00:24:42,000 --> 00:24:43,760
something but now all of a sudden we had

773
00:24:43,760 --> 00:24:45,840
a new device pop up right and it was

774
00:24:45,840 --> 00:24:48,559
probing for samsung smart right they're

775
00:24:48,559 --> 00:24:50,880
probing for that wi-fi network so we see

776
00:24:50,880 --> 00:24:52,240
it there yeah there's a new probe for

777
00:24:52,240 --> 00:24:55,919
that and it's in the 5-10 minute list

778
00:24:55,919 --> 00:24:57,520
and then after a few minutes it was also

779
00:24:57,520 --> 00:25:00,240
in the 10 to 15-minute list

780
00:25:00,240 --> 00:25:01,520
and then after a little bit was also in

781
00:25:01,520 --> 00:25:03,520
the 15 to 20 minute list this is after

782
00:25:03,520 --> 00:25:05,200
running for probably like half an hour

783
00:25:05,200 --> 00:25:06,400
and then it's not kind of like a new

784
00:25:06,400 --> 00:25:07,679
device like i said either one of my

785
00:25:07,679 --> 00:25:09,360
neighbors turned on something new

786
00:25:09,360 --> 00:25:10,720
someone came over to visit him or

787
00:25:10,720 --> 00:25:12,080
something but it stayed there for a

788
00:25:12,080 --> 00:25:12,840
while

789
00:25:12,840 --> 00:25:15,840
right so nothing fancy it was just

790
00:25:15,840 --> 00:25:17,360
trying to like okay let's see if we can

791
00:25:17,360 --> 00:25:19,120
effectively do something to try to make

792
00:25:19,120 --> 00:25:20,720
this happen

793
00:25:20,720 --> 00:25:22,640
this is the mvp version this is what it

794
00:25:22,640 --> 00:25:24,640
looks like as i was testing and i mean

795
00:25:24,640 --> 00:25:26,880
mvp here not like the sport context of

796
00:25:26,880 --> 00:25:28,559
like most viable player i mean like the

797
00:25:28,559 --> 00:25:30,559
business context right minimum viable

798
00:25:30,559 --> 00:25:33,200
product this is me but before i'm really

799
00:25:33,200 --> 00:25:35,840
worried about like form factor like as

800
00:25:35,840 --> 00:25:37,840
fancy as i got you can see the antennas

801
00:25:37,840 --> 00:25:39,039
out of the sticking out of the side

802
00:25:39,039 --> 00:25:40,559
there right actually drilled a hole like

803
00:25:40,559 --> 00:25:43,279
a boss but now before i like spent a ton

804
00:25:43,279 --> 00:25:45,440
of time on form factor and customizing

805
00:25:45,440 --> 00:25:47,679
and 3d printing in any of that right

806
00:25:47,679 --> 00:25:49,360
like i actually wanted to make sure that

807
00:25:49,360 --> 00:25:51,679
it looked good and then i'm like all

808
00:25:51,679 --> 00:25:53,440
right cool like now i'm going to make it

809
00:25:53,440 --> 00:25:55,919
look really really good before my talk

810
00:25:55,919 --> 00:25:57,440
and then last week happened and last

811
00:25:57,440 --> 00:25:59,440
week was crazy i was working paris hours

812
00:25:59,440 --> 00:26:01,600
all week long getting up at midnight and

813
00:26:01,600 --> 00:26:02,720
so this

814
00:26:02,720 --> 00:26:04,559
this is as far as i got is actually

815
00:26:04,559 --> 00:26:06,480
trying to make a little bit better right

816
00:26:06,480 --> 00:26:08,240
you can see down there the the wi-fi

817
00:26:08,240 --> 00:26:09,279
card in there i haven't even had a

818
00:26:09,279 --> 00:26:11,360
chance to drill the holes yet the the

819
00:26:11,360 --> 00:26:13,120
power pack that power pack is actually

820
00:26:13,120 --> 00:26:14,880
outstanding it's called as storm i got

821
00:26:14,880 --> 00:26:16,400
it as part of the kickstarter it's a

822
00:26:16,400 --> 00:26:18,320
really really good one but like i said i

823
00:26:18,320 --> 00:26:19,840
even had a bigger one that i got from

824
00:26:19,840 --> 00:26:21,520
amazon and that would power this for

825
00:26:21,520 --> 00:26:23,200
about 24 hours which is way more than

826
00:26:23,200 --> 00:26:25,120
anyone needs like i said even a small

827
00:26:25,120 --> 00:26:26,640
battery pack was powering it for like

828
00:26:26,640 --> 00:26:28,559
seven eight hours which is most of what

829
00:26:28,559 --> 00:26:31,120
people need

830
00:26:32,080 --> 00:26:34,080
so what about the path forward here

831
00:26:34,080 --> 00:26:34,960
right

832
00:26:34,960 --> 00:26:36,559
the path forward what can kind of do if

833
00:26:36,559 --> 00:26:37,600
this is a

834
00:26:37,600 --> 00:26:39,520
interesting to anyone if anyone likes it

835
00:26:39,520 --> 00:26:40,880
you know just kind of going forward what

836
00:26:40,880 --> 00:26:42,559
kind of add-on well number one we can

837
00:26:42,559 --> 00:26:44,400
start adding on more wi-fi adapters

838
00:26:44,400 --> 00:26:45,840
right now i've only messed with one or

839
00:26:45,840 --> 00:26:48,960
two of them tops but you know it's

840
00:26:48,960 --> 00:26:50,720
having one wireless adapter on two

841
00:26:50,720 --> 00:26:52,320
megahertz isn't bad because you know you

842
00:26:52,320 --> 00:26:54,000
only have like not too many channels but

843
00:26:54,000 --> 00:26:55,120
then when you start adding in five

844
00:26:55,120 --> 00:26:56,559
gigahertz right there's a lot of

845
00:26:56,559 --> 00:26:58,720
channels up there and so having multiple

846
00:26:58,720 --> 00:27:00,159
wireless cards you're gonna be better at

847
00:27:00,159 --> 00:27:02,480
picking stuff up so that would be one

848
00:27:02,480 --> 00:27:05,120
protocol adding more wireless protocols

849
00:27:05,120 --> 00:27:06,720
all right right now it's doing uh it's

850
00:27:06,720 --> 00:27:09,440
doing wi-fi and it's doing bluetooth

851
00:27:09,440 --> 00:27:10,480
but

852
00:27:10,480 --> 00:27:11,600
you know there's other things that we

853
00:27:11,600 --> 00:27:13,120
could be doing i've seen some research

854
00:27:13,120 --> 00:27:15,039
out there for a few years on um like

855
00:27:15,039 --> 00:27:17,840
tpms sensors little low tire low

856
00:27:17,840 --> 00:27:19,279
pressure sensors and tires i've seen

857
00:27:19,279 --> 00:27:21,200
some stuff on that they go a little bit

858
00:27:21,200 --> 00:27:22,480
further than you think they would and

859
00:27:22,480 --> 00:27:24,000
some other things

860
00:27:24,000 --> 00:27:26,399
gps tracking right that would be a big

861
00:27:26,399 --> 00:27:28,480
one to kind of add the gps capability in

862
00:27:28,480 --> 00:27:29,919
here that'd be pretty simple to start

863
00:27:29,919 --> 00:27:31,840
logging that too to when you went back

864
00:27:31,840 --> 00:27:33,440
kind of after the fact and analyzed

865
00:27:33,440 --> 00:27:34,880
where you were when you started to see

866
00:27:34,880 --> 00:27:36,640
certain things for the first time i

867
00:27:36,640 --> 00:27:37,760
think that's kind of like one of the

868
00:27:37,760 --> 00:27:39,760
natural next steps

869
00:27:39,760 --> 00:27:41,520
and then just some generic kind of post

870
00:27:41,520 --> 00:27:43,200
capture log analysis like i said

871
00:27:43,200 --> 00:27:45,279
everything it sees i spit out into a log

872
00:27:45,279 --> 00:27:47,039
an additional log file in addition to

873
00:27:47,039 --> 00:27:49,120
obviously the kismit log itself so

874
00:27:49,120 --> 00:27:51,200
especially adding in a gps being able to

875
00:27:51,200 --> 00:27:52,880
after the fact generator port of what

876
00:27:52,880 --> 00:27:55,039
you saw where you saw certain things

877
00:27:55,039 --> 00:27:57,520
like that on a journey in a nice usable

878
00:27:57,520 --> 00:27:59,440
easy format that

879
00:27:59,440 --> 00:28:01,520
kept you from having to do it manually i

880
00:28:01,520 --> 00:28:02,640
think would probably be one of the first

881
00:28:02,640 --> 00:28:04,000
things that i would add in from this

882
00:28:04,000 --> 00:28:06,559
point as well

883
00:28:06,640 --> 00:28:08,240
if you want to check it out

884
00:28:08,240 --> 00:28:10,640
the presentation's right there said a

885
00:28:10,640 --> 00:28:14,080
bitly vscc underscore cyt

886
00:28:14,080 --> 00:28:17,840
cyt is chasing your tail right if i uh i

887
00:28:17,840 --> 00:28:19,440
tried for cyt but someone had already

888
00:28:19,440 --> 00:28:21,679
taken that bitly so it's cc for cactus

889
00:28:21,679 --> 00:28:24,320
con underscore chasing your tail

890
00:28:24,320 --> 00:28:26,640
and the code if you want to laugh at it

891
00:28:26,640 --> 00:28:29,279
is right there my github name is azmat

892
00:28:29,279 --> 00:28:30,960
it's uh chasing underscore your tail i

893
00:28:30,960 --> 00:28:32,559
had someone like two nights ago asked me

894
00:28:32,559 --> 00:28:33,840
for my github

895
00:28:33,840 --> 00:28:35,840
name and i'm like yeah it's it's a z mad

896
00:28:35,840 --> 00:28:37,279
i'm like if you see like that i have

897
00:28:37,279 --> 00:28:39,600
like a little badge for being an arctic

898
00:28:39,600 --> 00:28:41,679
code contributor somehow but the python

899
00:28:41,679 --> 00:28:43,039
code looks like it's not even worth the

900
00:28:43,039 --> 00:28:44,640
tape that it's saved on like you're in

901
00:28:44,640 --> 00:28:46,000
the right place

902
00:28:46,000 --> 00:28:49,760
you're absolutely in the right place

903
00:28:49,919 --> 00:28:52,000
if you like the wireless stuff seriously

904
00:28:52,000 --> 00:28:54,240
check out kismet it is fantastic it runs

905
00:28:54,240 --> 00:28:56,240
on like all sorts of different things

906
00:28:56,240 --> 00:28:58,480
it's all linux based unfortunately i've

907
00:28:58,480 --> 00:29:00,159
spoken on wireless before to kind of

908
00:29:00,159 --> 00:29:01,600
less technical crowds than this and

909
00:29:01,600 --> 00:29:03,120
sometimes i show them some things and i

910
00:29:03,120 --> 00:29:05,120
get people that are like oh my god this

911
00:29:05,120 --> 00:29:06,399
is amazing i'm gonna do whatever it

912
00:29:06,399 --> 00:29:07,600
takes tell me what i need to buy i'm

913
00:29:07,600 --> 00:29:08,720
like the good news is you don't need to

914
00:29:08,720 --> 00:29:10,159
buy anything right it's just all in

915
00:29:10,159 --> 00:29:11,840
linux not windows they're like okay i've

916
00:29:11,840 --> 00:29:13,279
got a linux person just like tell me

917
00:29:13,279 --> 00:29:14,559
what i need to buy

918
00:29:14,559 --> 00:29:16,240
and it's like nah really there's nothing

919
00:29:16,240 --> 00:29:18,399
to buy it's you just gotta get at least

920
00:29:18,399 --> 00:29:20,480
not afraid of linux and after like the

921
00:29:20,480 --> 00:29:21,760
same thing and seriously i've had this

922
00:29:21,760 --> 00:29:23,279
conversation like a dozen times i'm not

923
00:29:23,279 --> 00:29:25,440
even exaggerating right and after like

924
00:29:25,440 --> 00:29:27,600
three rounds of that it goes from like i

925
00:29:27,600 --> 00:29:28,880
will do anything until they're like

926
00:29:28,880 --> 00:29:30,480
faking a phone call right like oh hey my

927
00:29:30,480 --> 00:29:32,480
wife's calling see you later good talk

928
00:29:32,480 --> 00:29:34,640
like yeah no it's but seriously like i

929
00:29:34,640 --> 00:29:36,559
said kismet is fantastic for pi for

930
00:29:36,559 --> 00:29:38,960
computer for whatever the discord on

931
00:29:38,960 --> 00:29:40,640
there was very very good a lot of

932
00:29:40,640 --> 00:29:42,399
knowledge on there you know trying to

933
00:29:42,399 --> 00:29:44,159
willing to help people getting started

934
00:29:44,159 --> 00:29:46,320
and certain things like that

935
00:29:46,320 --> 00:29:48,000
so if you like more wireless kismet if

936
00:29:48,000 --> 00:29:49,279
you like privacy right and it's not like

937
00:29:49,279 --> 00:29:51,039
a salesman hey if you like privacy you

938
00:29:51,039 --> 00:29:53,279
know everyone likes privacy right but

939
00:29:53,279 --> 00:29:54,799
seriously i could hear from the wi-fi

940
00:29:54,799 --> 00:29:56,080
component you know you probably already

941
00:29:56,080 --> 00:29:57,440
checked out kismet but if you're here

942
00:29:57,440 --> 00:29:59,200
for kind of like the privacy aspect of

943
00:29:59,200 --> 00:30:02,240
it sansa one you know as nasty as covet

944
00:30:02,240 --> 00:30:03,840
has been at least there's been a couple

945
00:30:03,840 --> 00:30:05,360
kind of bright spots coming out of it

946
00:30:05,360 --> 00:30:06,320
one time

947
00:30:06,320 --> 00:30:08,080
and one of the ones is all the sans

948
00:30:08,080 --> 00:30:10,080
summits have basically gone free now for

949
00:30:10,080 --> 00:30:11,760
the past year for forensics for counter

950
00:30:11,760 --> 00:30:13,760
thread intel for some other things and

951
00:30:13,760 --> 00:30:15,600
uh coming up in april the stan's ocean

952
00:30:15,600 --> 00:30:17,360
summit right i've spoken the last couple

953
00:30:17,360 --> 00:30:18,559
years i don't think i'll be speaking

954
00:30:18,559 --> 00:30:20,320
this year but i'll be involved in it but

955
00:30:20,320 --> 00:30:21,760
they usually have some pretty good talks

956
00:30:21,760 --> 00:30:23,440
on not only open source intelligence but

957
00:30:23,440 --> 00:30:25,360
there's also some privacy theme talks as

958
00:30:25,360 --> 00:30:27,039
well so and they have the historical

959
00:30:27,039 --> 00:30:28,080
ones all up there that are there to

960
00:30:28,080 --> 00:30:30,080
watch for free too so like i said if

961
00:30:30,080 --> 00:30:31,600
you're here for kind of like the privacy

962
00:30:31,600 --> 00:30:33,120
kind of aspect of this talk if that's

963
00:30:33,120 --> 00:30:34,960
what's relevant to your interest

964
00:30:34,960 --> 00:30:36,399
there's probably a couple talks there

965
00:30:36,399 --> 00:30:38,320
that you'll like and it's free i think

966
00:30:38,320 --> 00:30:40,399
it's uh in the past last year was two

967
00:30:40,399 --> 00:30:42,080
days i think this year it's going to be

968
00:30:42,080 --> 00:30:43,919
one day but it's going to be like all

969
00:30:43,919 --> 00:30:46,000
day long like they're starting up on

970
00:30:46,000 --> 00:30:47,440
european time

971
00:30:47,440 --> 00:30:49,279
and having stuff for that and then like

972
00:30:49,279 --> 00:30:51,200
rolling all the way through like the u.s

973
00:30:51,200 --> 00:30:53,279
time and stuff like that so yeah i think

974
00:30:53,279 --> 00:30:54,640
at that point it's like technically a

975
00:30:54,640 --> 00:30:56,159
marathon like we're raising money or

976
00:30:56,159 --> 00:30:57,679
something

977
00:30:57,679 --> 00:30:59,919
all right special thanks to right to

978
00:30:59,919 --> 00:31:01,840
mike kershaw he's the uh he's the

979
00:31:01,840 --> 00:31:04,080
developer of kismet i had a couple

980
00:31:04,080 --> 00:31:05,360
questions and i was working on this and

981
00:31:05,360 --> 00:31:06,480
i could reach out to him and he was

982
00:31:06,480 --> 00:31:08,399
nothing but super helpful and like i

983
00:31:08,399 --> 00:31:09,679
said talking about like don't even waste

984
00:31:09,679 --> 00:31:11,200
your time doing a p cap right you can do

985
00:31:11,200 --> 00:31:12,320
it after the fact it's just

986
00:31:12,320 --> 00:31:14,159
computationally expensive for no reason

987
00:31:14,159 --> 00:31:15,360
whatsoever

988
00:31:15,360 --> 00:31:16,880
and then i think two of the the biggest

989
00:31:16,880 --> 00:31:19,679
kind of wireless gurus that i know

990
00:31:19,679 --> 00:31:22,320
dominic white singh on twitter i'm uh

991
00:31:22,320 --> 00:31:23,600
i miss you brother i'm hoping to get

992
00:31:23,600 --> 00:31:25,360
back to the u.s this year for black hat

993
00:31:25,360 --> 00:31:27,600
defcon he's a south african based and

994
00:31:27,600 --> 00:31:29,279
then uh josh wright you know another

995
00:31:29,279 --> 00:31:31,360
kind of wi-fi guru when i have a

996
00:31:31,360 --> 00:31:32,799
question about something you know before

997
00:31:32,799 --> 00:31:33,919
you um

998
00:31:33,919 --> 00:31:35,679
before you even start down a road to

999
00:31:35,679 --> 00:31:37,200
something it's nice sometimes to talk to

1000
00:31:37,200 --> 00:31:38,399
someone just to make sure like hey this

1001
00:31:38,399 --> 00:31:40,320
is what i'm thinking of doing

1002
00:31:40,320 --> 00:31:42,480
does this pass a smell test to you right

1003
00:31:42,480 --> 00:31:44,559
or even just as important right like why

1004
00:31:44,559 --> 00:31:45,919
am i going to spend time doing this if

1005
00:31:45,919 --> 00:31:47,600
someone else has done it before you know

1006
00:31:47,600 --> 00:31:49,039
are you aware of someone else kind of

1007
00:31:49,039 --> 00:31:51,840
completing a similar project in the past

1008
00:31:51,840 --> 00:31:53,519
if so i won't even kind of go down that

1009
00:31:53,519 --> 00:31:55,200
road right

1010
00:31:55,200 --> 00:31:57,039
so and that was it i told you i wouldn't

1011
00:31:57,039 --> 00:31:58,480
keep you all late right

1012
00:31:58,480 --> 00:32:00,320
told you was running long so thank you

1013
00:32:00,320 --> 00:32:02,340
all so much it was fantastic

1014
00:32:02,340 --> 00:32:07,840
[Applause]

1015
00:32:07,840 --> 00:32:09,279
i'll be around right after this but if

1016
00:32:09,279 --> 00:32:10,880
anyone has any question right now feel

1017
00:32:10,880 --> 00:32:13,880
free

1018
00:32:14,000 --> 00:32:15,120
right i think i'm supposed to like toss

1019
00:32:15,120 --> 00:32:16,240
this or something but there's no need to

1020
00:32:16,240 --> 00:32:17,279
go for it

1021
00:32:17,279 --> 00:32:18,880
you can talk you have my pro oh you

1022
00:32:18,880 --> 00:32:20,080
actually want to catch it you want me to

1023
00:32:20,080 --> 00:32:22,159
toss it damn i should have warmed up or

1024
00:32:22,159 --> 00:32:23,919
something you got to warn me next time

1025
00:32:23,919 --> 00:32:25,840
oh that was a beautiful toss

1026
00:32:25,840 --> 00:32:28,240
um so you're saying uh that there's a

1027
00:32:28,240 --> 00:32:30,720
database right a sqlite database so if

1028
00:32:30,720 --> 00:32:32,880
you're in a very heavily populated area

1029
00:32:32,880 --> 00:32:35,279
for a few hours what's the size

1030
00:32:35,279 --> 00:32:36,480
constraints that you're going to fault

1031
00:32:36,480 --> 00:32:38,960
you'll find with that sqlite database

1032
00:32:38,960 --> 00:32:40,240
yeah it's a great question so the

1033
00:32:40,240 --> 00:32:41,600
question was if you're in a very very

1034
00:32:41,600 --> 00:32:43,120
heavy populated area it was like does

1035
00:32:43,120 --> 00:32:44,799
that sequel light database get out of

1036
00:32:44,799 --> 00:32:46,720
control it really didn't seem to believe

1037
00:32:46,720 --> 00:32:48,480
it or not it really didn't and i was

1038
00:32:48,480 --> 00:32:50,399
running this for a decent amount kind of

1039
00:32:50,399 --> 00:32:52,559
a long period of time i never had an

1040
00:32:52,559 --> 00:32:54,159
issue with it getting too big or meeting

1041
00:32:54,159 --> 00:32:55,440
up with x-fil

1042
00:32:55,440 --> 00:32:57,120
it's not going to be

1043
00:32:57,120 --> 00:32:58,720
super tiny

1044
00:32:58,720 --> 00:33:00,880
because like i said the data is granular

1045
00:33:00,880 --> 00:33:02,559
enough to generate a pcap afterwards

1046
00:33:02,559 --> 00:33:04,320
which is like it's not saying something

1047
00:33:04,320 --> 00:33:06,559
so i think i would design it probably

1048
00:33:06,559 --> 00:33:08,799
slightly differently if i was planning

1049
00:33:08,799 --> 00:33:12,000
on leaving it somewhere for you know 24

1050
00:33:12,000 --> 00:33:13,679
hours or more at a time i'd probably

1051
00:33:13,679 --> 00:33:15,200
decide to automatically roll over

1052
00:33:15,200 --> 00:33:17,120
restart at the end of the day but when i

1053
00:33:17,120 --> 00:33:18,480
was testing the battery life i would

1054
00:33:18,480 --> 00:33:19,919
have this thing running for seven hours

1055
00:33:19,919 --> 00:33:22,480
with no issue so yeah and i apologize

1056
00:33:22,480 --> 00:33:24,720
for not remembering like the exact size

1057
00:33:24,720 --> 00:33:26,399
but i never ran into an issue with it

1058
00:33:26,399 --> 00:33:27,760
but like i said it's not like you know

1059
00:33:27,760 --> 00:33:29,600
16k or something because there's

1060
00:33:29,600 --> 00:33:31,600
actually a lot of data in there so

1061
00:33:31,600 --> 00:33:32,640
no

1062
00:33:32,640 --> 00:33:33,840
oh right there

1063
00:33:33,840 --> 00:33:35,519
short toss you got to toss it too i

1064
00:33:35,519 --> 00:33:36,720
tossed it you got to toss it come on

1065
00:33:36,720 --> 00:33:39,279
there

1066
00:33:39,279 --> 00:33:41,039
thank you fascinating talk especially

1067
00:33:41,039 --> 00:33:42,880
considering you could trace the ssids

1068
00:33:42,880 --> 00:33:44,080
back to the people who might be

1069
00:33:44,080 --> 00:33:45,360
surveilling you

1070
00:33:45,360 --> 00:33:47,679
um i did have a question about mac

1071
00:33:47,679 --> 00:33:50,559
randomization um do the ouis

1072
00:33:50,559 --> 00:33:52,320
ultimately when they do that do they

1073
00:33:52,320 --> 00:33:55,039
trace back to the same vendor um i would

1074
00:33:55,039 --> 00:33:56,880
assume they do but i don't know

1075
00:33:56,880 --> 00:33:58,159
yeah that's a great question as far as

1076
00:33:58,159 --> 00:34:00,399
the mac addresses and it's going to vary

1077
00:34:00,399 --> 00:34:02,640
between different devices but if you

1078
00:34:02,640 --> 00:34:04,960
look at that that is a smorgasbord this

1079
00:34:04,960 --> 00:34:06,720
was two devices

1080
00:34:06,720 --> 00:34:08,079
and yeah i know it's an absolute

1081
00:34:08,079 --> 00:34:09,599
smorgasbord of stuff out there so i

1082
00:34:09,599 --> 00:34:11,199
think it's going to randomize for in

1083
00:34:11,199 --> 00:34:12,800
this case you know these devices i think

1084
00:34:12,800 --> 00:34:14,079
for others they might stick to their

1085
00:34:14,079 --> 00:34:15,839
ouis to try to be a little more well

1086
00:34:15,839 --> 00:34:17,918
maintained you know and honestly too

1087
00:34:17,918 --> 00:34:19,520
like i said my goal is to keep this

1088
00:34:19,520 --> 00:34:21,280
passive

1089
00:34:21,280 --> 00:34:23,359
but let's be real right if i was like

1090
00:34:23,359 --> 00:34:26,239
seriously concerned about um trying to

1091
00:34:26,239 --> 00:34:27,839
which is another possible path forward

1092
00:34:27,839 --> 00:34:28,719
right and then one in there that i

1093
00:34:28,719 --> 00:34:30,639
didn't mention one possible path forward

1094
00:34:30,639 --> 00:34:32,079
right is if someone's following you

1095
00:34:32,079 --> 00:34:33,359
trying to figure out who it was that was

1096
00:34:33,359 --> 00:34:34,560
following you

1097
00:34:34,560 --> 00:34:36,480
and if the ssid they were probing for

1098
00:34:36,480 --> 00:34:38,560
was unique enough that's possible i one

1099
00:34:38,560 --> 00:34:40,480
time i was i was speaking to a

1100
00:34:40,480 --> 00:34:43,040
government agency on um dark web

1101
00:34:43,040 --> 00:34:45,918
the dark web ooh scary

1102
00:34:45,918 --> 00:34:48,960
i was speaking on the dark web and uh at

1103
00:34:48,960 --> 00:34:50,800
break one time one of my buddies was

1104
00:34:50,800 --> 00:34:53,119
there and he came up to me he's like hey

1105
00:34:53,119 --> 00:34:55,760
you were in seattle last month and you

1106
00:34:55,760 --> 00:34:57,440
were staying at the marriott hotel

1107
00:34:57,440 --> 00:35:00,079
downtown right by there and i'm like

1108
00:35:00,079 --> 00:35:01,920
yes i was all right second grade rules

1109
00:35:01,920 --> 00:35:03,040
right i'm like a second grade teacher

1110
00:35:03,040 --> 00:35:04,480
though show your work all right there's

1111
00:35:04,480 --> 00:35:05,599
a few different ways you could have

1112
00:35:05,599 --> 00:35:07,200
figured this out how did you actually

1113
00:35:07,200 --> 00:35:09,359
show your work and what it was was i was

1114
00:35:09,359 --> 00:35:11,440
i was teaching i had my um little mifi

1115
00:35:11,440 --> 00:35:12,880
that's sitting in my backpack right now

1116
00:35:12,880 --> 00:35:14,160
i had that on that was my internet

1117
00:35:14,160 --> 00:35:15,920
source and if you think about it like if

1118
00:35:15,920 --> 00:35:18,079
you look up linksys and wiggle there's

1119
00:35:18,079 --> 00:35:19,359
going to be a million of it right grab a

1120
00:35:19,359 --> 00:35:21,599
snickers no luck but aren't our myfi's

1121
00:35:21,599 --> 00:35:22,880
and certain things like that oftentimes

1122
00:35:22,880 --> 00:35:26,079
a very unique name like verizon 650 lima

1123
00:35:26,079 --> 00:35:27,839
you know six foxtrot charlie that's a

1124
00:35:27,839 --> 00:35:30,240
very very unique name and my buddy saw

1125
00:35:30,240 --> 00:35:31,920
that's what i was using for my wi-fi he

1126
00:35:31,920 --> 00:35:33,440
put it into wiggle and he saw the

1127
00:35:33,440 --> 00:35:34,880
different places where my thing had been

1128
00:35:34,880 --> 00:35:36,400
spotted before including the previous

1129
00:35:36,400 --> 00:35:37,359
month

1130
00:35:37,359 --> 00:35:38,960
you know they're in seattle so there's

1131
00:35:38,960 --> 00:35:41,839
some deon d anonymization with this two

1132
00:35:41,839 --> 00:35:44,160
aspect and so like i said i kept this

1133
00:35:44,160 --> 00:35:46,960
100 passive on purpose if i was willing

1134
00:35:46,960 --> 00:35:50,160
to trade some of that passive nature

1135
00:35:50,160 --> 00:35:52,320
it would almost likely never be found

1136
00:35:52,320 --> 00:35:54,480
out and what would happen was at that

1137
00:35:54,480 --> 00:35:56,000
point if i saw someone probing for

1138
00:35:56,000 --> 00:35:57,359
something what would we do we would

1139
00:35:57,359 --> 00:35:59,119
mimic that ssid

1140
00:35:59,119 --> 00:36:00,560
we wouldn't actually serve them up a

1141
00:36:00,560 --> 00:36:02,640
real active connection but at that point

1142
00:36:02,640 --> 00:36:05,280
that we would serve them up the ssid

1143
00:36:05,280 --> 00:36:06,480
they were looking for they would

1144
00:36:06,480 --> 00:36:08,560
de-anonymize with a mac address

1145
00:36:08,560 --> 00:36:10,240
and so if i wanted to find out number

1146
00:36:10,240 --> 00:36:12,320
one a unique ssid probe we can start to

1147
00:36:12,320 --> 00:36:13,920
look for and figure out where they're at

1148
00:36:13,920 --> 00:36:15,440
and like i said if i was willing to

1149
00:36:15,440 --> 00:36:16,960
trade and they wouldn't make a real

1150
00:36:16,960 --> 00:36:18,480
connection so the odds are they would

1151
00:36:18,480 --> 00:36:20,320
never even know that happened if i was

1152
00:36:20,320 --> 00:36:22,160
willing to trade like i said being 100

1153
00:36:22,160 --> 00:36:23,520
passive for that we could even figure

1154
00:36:23,520 --> 00:36:25,680
that out a little bit more so but yeah

1155
00:36:25,680 --> 00:36:26,960
like i said that's two devices and

1156
00:36:26,960 --> 00:36:28,880
that's a smorgasbord so good question

1157
00:36:28,880 --> 00:36:30,000
great question

1158
00:36:30,000 --> 00:36:31,680
anyone else

1159
00:36:31,680 --> 00:36:32,720
all right it's lunch time getting that

1160
00:36:32,720 --> 00:36:34,480
guy there are a couple that came in oh

1161
00:36:34,480 --> 00:36:35,680
i'm sorry

1162
00:36:35,680 --> 00:36:36,800
that's right

1163
00:36:36,800 --> 00:36:38,160
i tried to get you all the lunch i

1164
00:36:38,160 --> 00:36:40,880
failed one of the questions is could the

1165
00:36:40,880 --> 00:36:43,680
hardware for detecting other phones

1166
00:36:43,680 --> 00:36:45,520
looking for wi-fi networks be in the

1167
00:36:45,520 --> 00:36:48,000
phone if so could the code be in a phone

1168
00:36:48,000 --> 00:36:48,880
app

1169
00:36:48,880 --> 00:36:51,040
so could it be in the app like so the

1170
00:36:51,040 --> 00:36:52,720
hardware looking for phones become the

1171
00:36:52,720 --> 00:36:54,960
phone right my mind just exploded for

1172
00:36:54,960 --> 00:36:56,480
the wireless now it's a great question

1173
00:36:56,480 --> 00:36:57,920
for the wireless you got to be able to

1174
00:36:57,920 --> 00:36:59,520
put this in monitor mode right you have

1175
00:36:59,520 --> 00:37:01,359
to basically convince it like listen

1176
00:37:01,359 --> 00:37:03,440
wi-fi card you've been working hard

1177
00:37:03,440 --> 00:37:05,440
connecting all these networks for me

1178
00:37:05,440 --> 00:37:06,960
why don't you just basically take the

1179
00:37:06,960 --> 00:37:09,599
next hour off you know go smoke a giant

1180
00:37:09,599 --> 00:37:10,480
bowl

1181
00:37:10,480 --> 00:37:12,240
and don't even worry about connecting to

1182
00:37:12,240 --> 00:37:13,599
the network just kind of look for what's

1183
00:37:13,599 --> 00:37:15,280
floating through the air right and

1184
00:37:15,280 --> 00:37:16,720
that's very very difficult to do on

1185
00:37:16,720 --> 00:37:18,560
windows systems and it's very very

1186
00:37:18,560 --> 00:37:19,920
difficult to do with the embedded

1187
00:37:19,920 --> 00:37:21,680
hardware in a device like you can't take

1188
00:37:21,680 --> 00:37:23,760
the wi-fi card to say can't right i

1189
00:37:23,760 --> 00:37:25,520
don't like to speak in absolutes

1190
00:37:25,520 --> 00:37:26,880
but you don't really want to take the

1191
00:37:26,880 --> 00:37:28,800
wi-fi card in like a raspberry pi and

1192
00:37:28,800 --> 00:37:30,240
try to convert that into monitor mode

1193
00:37:30,240 --> 00:37:31,839
that's why we add on the second wi-fi

1194
00:37:31,839 --> 00:37:33,920
card so usually in my wi-fi testing

1195
00:37:33,920 --> 00:37:36,160
you're not using the built-in wireless

1196
00:37:36,160 --> 00:37:37,680
to do certain things like this for

1197
00:37:37,680 --> 00:37:39,599
monitor mode you're actually putting in

1198
00:37:39,599 --> 00:37:41,440
an external one and doing it so great

1199
00:37:41,440 --> 00:37:42,640
question

1200
00:37:42,640 --> 00:37:44,640
and then another question is could this

1201
00:37:44,640 --> 00:37:47,200
be adapted to identify apple air tags

1202
00:37:47,200 --> 00:37:48,640
that are repeatedly could this be

1203
00:37:48,640 --> 00:37:50,400
invented by app layer tags and certain

1204
00:37:50,400 --> 00:37:52,800
things like that absolutely absolutely

1205
00:37:52,800 --> 00:37:54,640
it would um you would have to like i

1206
00:37:54,640 --> 00:37:56,720
said it's a matter of kismet is so good

1207
00:37:56,720 --> 00:37:58,079
about incorporating different types of

1208
00:37:58,079 --> 00:37:59,359
radio you know different types of

1209
00:37:59,359 --> 00:38:02,079
spectrum the sdr and things with this i

1210
00:38:02,079 --> 00:38:04,000
just kept it to wi-fi and bluetooth but

1211
00:38:04,000 --> 00:38:05,280
like i said that would absolutely be one

1212
00:38:05,280 --> 00:38:06,640
of the path forward like i said one of

1213
00:38:06,640 --> 00:38:08,079
the first parts one of the first parts

1214
00:38:08,079 --> 00:38:10,160
my brian went to was um

1215
00:38:10,160 --> 00:38:11,839
it was kind of like tpms low pressure

1216
00:38:11,839 --> 00:38:13,920
sensors and tires but other anything

1217
00:38:13,920 --> 00:38:15,760
basically the wireless if kismet can

1218
00:38:15,760 --> 00:38:17,440
ingest it we could actually add this

1219
00:38:17,440 --> 00:38:19,440
into it so

1220
00:38:19,440 --> 00:38:20,480
awesome

1221
00:38:20,480 --> 00:38:22,160
all right i'm six foot four i'm really

1222
00:38:22,160 --> 00:38:23,520
easy to spot if you have any questions

1223
00:38:23,520 --> 00:38:24,800
hit me up thank you all very much

1224
00:38:24,800 --> 00:38:28,119
appreciate it

1225
00:38:54,720 --> 00:38:56,799
you

