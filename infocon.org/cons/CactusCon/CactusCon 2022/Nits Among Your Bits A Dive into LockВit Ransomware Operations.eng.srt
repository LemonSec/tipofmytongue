1
00:00:07,600 --> 00:00:11,360
okay uh hello everyone uh thanks for

2
00:00:11,360 --> 00:00:14,920
joining my talk today at cactus con

3
00:00:14,920 --> 00:00:18,160
uh i'm going to talk about ransomware

4
00:00:18,160 --> 00:00:21,680
yes unfortunately it's still number one

5
00:00:21,680 --> 00:00:25,359
thread and still there are quite a lot

6
00:00:25,359 --> 00:00:28,560
of ransomware attack nowadays

7
00:00:28,560 --> 00:00:30,400
and today we are going

8
00:00:30,400 --> 00:00:33,760
to focus on log bit ransomware one of

9
00:00:33,760 --> 00:00:36,000
the most active

10
00:00:36,000 --> 00:00:38,480
uh ransomware gangs or ransomware

11
00:00:38,480 --> 00:00:40,160
service programs

12
00:00:40,160 --> 00:00:41,840
if you prefer

13
00:00:41,840 --> 00:00:45,039
uh so my talk is titled needs ammonia

14
00:00:45,039 --> 00:00:46,000
beats

15
00:00:46,000 --> 00:00:47,920
a dive into log bit transformer

16
00:00:47,920 --> 00:00:49,120
operations

17
00:00:49,120 --> 00:00:53,600
very soon you'll learn why it has

18
00:00:53,600 --> 00:00:56,399
such an interesting name

19
00:00:56,399 --> 00:00:59,359
okay i think we're ready to start

20
00:00:59,359 --> 00:01:01,840
uh first of all just

21
00:01:01,840 --> 00:01:04,720
a few words about me

22
00:01:04,720 --> 00:01:07,760
my name is alex guten i'm

23
00:01:07,760 --> 00:01:08,799
head of

24
00:01:08,799 --> 00:01:10,960
global different team

25
00:01:10,960 --> 00:01:12,960
at group ib

26
00:01:12,960 --> 00:01:15,840
so we are responding to various

27
00:01:15,840 --> 00:01:17,920
cybersecurity incidents all around the

28
00:01:17,920 --> 00:01:20,159
globe we have

29
00:01:20,159 --> 00:01:22,880
dedicated teams in europe in middle east

30
00:01:22,880 --> 00:01:24,240
in asia

31
00:01:24,240 --> 00:01:26,880
and of course in russia

32
00:01:26,880 --> 00:01:29,360
uh personally i'm doing digital

33
00:01:29,360 --> 00:01:32,640
forensics and instant response for 10

34
00:01:32,640 --> 00:01:35,439
years already

35
00:01:35,600 --> 00:01:39,119
i love intelligence-driven approach very

36
00:01:39,119 --> 00:01:41,520
much so that's why

37
00:01:41,520 --> 00:01:44,159
i'm talking about tactics techniques and

38
00:01:44,159 --> 00:01:46,560
procedures of various protectors very

39
00:01:46,560 --> 00:01:48,240
often so

40
00:01:48,240 --> 00:01:50,000
my team me

41
00:01:50,000 --> 00:01:52,720
and our colleagues all around the globe

42
00:01:52,720 --> 00:01:55,439
can be ready such attacks can understand

43
00:01:55,439 --> 00:01:57,600
how to properly respond to such

44
00:01:57,600 --> 00:02:00,479
incidents and how to build proper

45
00:02:00,479 --> 00:02:03,759
detections so they can detect in time

46
00:02:03,759 --> 00:02:05,600
and they can prevent

47
00:02:05,600 --> 00:02:07,360
such attacks and

48
00:02:07,360 --> 00:02:09,520
at least prevent

49
00:02:09,520 --> 00:02:13,520
ganks from ransomware deployment

50
00:02:14,560 --> 00:02:17,120
i offered a few books

51
00:02:17,120 --> 00:02:19,440
maybe you even are aware of some of them

52
00:02:19,440 --> 00:02:21,599
for example windows friendly cookbook

53
00:02:21,599 --> 00:02:24,239
practical mobile forensics and of course

54
00:02:24,239 --> 00:02:26,239
quite a few

55
00:02:26,239 --> 00:02:29,120
of blog posts and various research

56
00:02:29,120 --> 00:02:32,560
papers you can find it at group ib site

57
00:02:32,560 --> 00:02:33,680
and

58
00:02:33,680 --> 00:02:36,800
for example if you google my name and

59
00:02:36,800 --> 00:02:39,120
you add the effect to it you can find a

60
00:02:39,120 --> 00:02:40,080
lot of

61
00:02:40,080 --> 00:02:42,879
stuff as well also currently i'm working

62
00:02:42,879 --> 00:02:44,560
on a new book

63
00:02:44,560 --> 00:02:47,599
called instant response in the age of

64
00:02:47,599 --> 00:02:49,519
ransomware attack

65
00:02:49,519 --> 00:02:52,160
uh it's gonna be is going to be released

66
00:02:52,160 --> 00:02:53,840
very soon so

67
00:02:53,840 --> 00:02:58,080
if you're interested in such materials

68
00:02:58,080 --> 00:02:59,519
you can just

69
00:02:59,519 --> 00:03:01,760
follow my twitter for example

70
00:03:01,760 --> 00:03:03,760
i'm trying to collect certificates just

71
00:03:03,760 --> 00:03:04,400
like

72
00:03:04,400 --> 00:03:06,000
many fellow

73
00:03:06,000 --> 00:03:08,000
instant responders and security

74
00:03:08,000 --> 00:03:10,800
professionals currently i'm holding gcfa

75
00:03:10,800 --> 00:03:13,840
gcti and mcfe

76
00:03:13,840 --> 00:03:14,640
okay

77
00:03:14,640 --> 00:03:16,959
more than enough about me

78
00:03:16,959 --> 00:03:20,319
let's keep going and start discussing

79
00:03:20,319 --> 00:03:23,360
our main topic log bit

80
00:03:23,360 --> 00:03:25,599
okay so let's start

81
00:03:25,599 --> 00:03:27,200
from the overview

82
00:03:27,200 --> 00:03:30,959
so first of all log bit is a ransomware

83
00:03:30,959 --> 00:03:32,959
as a service problem

84
00:03:32,959 --> 00:03:33,760
so

85
00:03:33,760 --> 00:03:36,239
there can be quite a few

86
00:03:36,239 --> 00:03:37,920
different affiliates

87
00:03:37,920 --> 00:03:39,440
who may just

88
00:03:39,440 --> 00:03:41,280
borrow

89
00:03:41,280 --> 00:03:42,560
ransomware

90
00:03:42,560 --> 00:03:44,080
from this program

91
00:03:44,080 --> 00:03:47,599
and then they may use various tactics

92
00:03:47,599 --> 00:03:49,760
techniques and procedures we'll discuss

93
00:03:49,760 --> 00:03:52,640
all these in details during this talk

94
00:03:52,640 --> 00:03:55,519
and finally they'll deploy ransomware

95
00:03:55,519 --> 00:03:56,480
also

96
00:03:56,480 --> 00:03:58,080
as

97
00:03:58,080 --> 00:03:59,040
many

98
00:03:59,040 --> 00:04:01,360
ransomware affiliates nowadays extra

99
00:04:01,360 --> 00:04:03,920
trade data as well logweight provides

100
00:04:03,920 --> 00:04:06,239
their own dedicated leak site so

101
00:04:06,239 --> 00:04:10,400
accelerated data can be posted on it and

102
00:04:10,400 --> 00:04:13,360
they can show it to their victims

103
00:04:13,360 --> 00:04:15,920
or threaten their victims then yet they

104
00:04:15,920 --> 00:04:19,680
don't pay when they will definitely

105
00:04:19,680 --> 00:04:22,800
publish the whole dataset they executed

106
00:04:22,800 --> 00:04:24,000
so

107
00:04:24,000 --> 00:04:25,199
in fact this

108
00:04:25,199 --> 00:04:28,400
ransomware service program started back

109
00:04:28,400 --> 00:04:30,880
in 2019

110
00:04:30,880 --> 00:04:32,800
first

111
00:04:32,800 --> 00:04:35,360
ransomware sample

112
00:04:35,360 --> 00:04:37,759
detected in the wild

113
00:04:37,759 --> 00:04:40,800
encrypted files and added abcd extension

114
00:04:40,800 --> 00:04:44,080
to them but it still

115
00:04:44,080 --> 00:04:45,600
works and

116
00:04:45,600 --> 00:04:48,720
there are still quite a few of attacks

117
00:04:48,720 --> 00:04:51,759
perform this ransomware nowadays

118
00:04:51,759 --> 00:04:53,759
usually log bit extension is added to

119
00:04:53,759 --> 00:04:57,680
encrypted files and what's more in june

120
00:04:57,680 --> 00:05:00,240
2021 we saw

121
00:05:00,240 --> 00:05:03,440
a new version of log bit so called log

122
00:05:03,440 --> 00:05:06,720
bit 2.0

123
00:05:06,720 --> 00:05:09,280
as i already mentioned

124
00:05:09,280 --> 00:05:12,160
these guys and their affiliates of

125
00:05:12,160 --> 00:05:14,320
course they focus on double extortion so

126
00:05:14,320 --> 00:05:16,240
they not only deplora and somewhere

127
00:05:16,240 --> 00:05:17,840
enterprise-wide

128
00:05:17,840 --> 00:05:20,160
but they also

129
00:05:20,160 --> 00:05:21,919
extra trade data

130
00:05:21,919 --> 00:05:24,320
before ransomware deployment of course

131
00:05:24,320 --> 00:05:26,320
it's not in every incident in some

132
00:05:26,320 --> 00:05:28,320
instance they just skip it and don't

133
00:05:28,320 --> 00:05:31,280
accelerate in data but still in many

134
00:05:31,280 --> 00:05:33,680
instances we faced and we responded to

135
00:05:33,680 --> 00:05:37,840
they excited data and they even have

136
00:05:37,840 --> 00:05:40,240
custom tools for date acceleration we'll

137
00:05:40,240 --> 00:05:41,199
discuss

138
00:05:41,199 --> 00:05:44,080
such tools later

139
00:05:44,080 --> 00:05:46,800
okay so if we are talking about numbers

140
00:05:46,800 --> 00:05:49,840
even based on information provided on

141
00:05:49,840 --> 00:05:53,680
their dedicated leak site since log bit

142
00:05:53,680 --> 00:05:57,919
2 release they performed more than 300

143
00:05:57,919 --> 00:05:59,120
of attacks

144
00:05:59,120 --> 00:06:01,840
so quite a lot of and of course there

145
00:06:01,840 --> 00:06:03,520
are attacks the

146
00:06:03,520 --> 00:06:05,680
information about those

147
00:06:05,680 --> 00:06:09,280
were not posted on tls so

148
00:06:09,280 --> 00:06:11,759
in reality the number of attacks

149
00:06:11,759 --> 00:06:12,960
even

150
00:06:12,960 --> 00:06:16,000
bigger than 300

151
00:06:16,000 --> 00:06:18,800
and talking about ransom demands it can

152
00:06:18,800 --> 00:06:21,280
be very different up to

153
00:06:21,280 --> 00:06:24,639
50 millions but in some cases it can be

154
00:06:24,639 --> 00:06:27,919
for example thirty thousand dollars or

155
00:06:27,919 --> 00:06:30,319
one hundred thousand dollars so

156
00:06:30,319 --> 00:06:32,080
when some demands are different depends

157
00:06:32,080 --> 00:06:35,280
on the company and log bit attack

158
00:06:35,280 --> 00:06:38,160
uh really different companies because

159
00:06:38,160 --> 00:06:40,639
the main idea behind it is

160
00:06:40,639 --> 00:06:42,720
they have different affiliates

161
00:06:42,720 --> 00:06:45,440
affairs have different capabilities and

162
00:06:45,440 --> 00:06:46,880
of course

163
00:06:46,880 --> 00:06:49,199
they attack different companies

164
00:06:49,199 --> 00:06:51,360
okay let's move forward

165
00:06:51,360 --> 00:06:54,800
so let's start from the initial axis and

166
00:06:54,800 --> 00:06:56,479
here we have

167
00:06:56,479 --> 00:06:58,800
the answer to

168
00:06:58,800 --> 00:07:01,440
uh the question that you may have why

169
00:07:01,440 --> 00:07:03,840
this stock is called needs among the

170
00:07:03,840 --> 00:07:04,800
beats

171
00:07:04,800 --> 00:07:06,720
so two main

172
00:07:06,720 --> 00:07:09,120
initial access technique they use

173
00:07:09,120 --> 00:07:12,800
is compromising vpn credentials they can

174
00:07:12,800 --> 00:07:15,199
buy it they can

175
00:07:15,199 --> 00:07:17,199
exploit public-facing application

176
00:07:17,199 --> 00:07:20,080
everybody remember i think pulse secure

177
00:07:20,080 --> 00:07:24,960
and vulnerability in photogate that was

178
00:07:24,960 --> 00:07:27,360
really really often

179
00:07:27,360 --> 00:07:29,840
used by lockwood affiliates and many

180
00:07:29,840 --> 00:07:32,400
other ransomware at the service program

181
00:07:32,400 --> 00:07:35,599
affiliates and of course rdp

182
00:07:35,599 --> 00:07:38,000
these guys

183
00:07:38,000 --> 00:07:41,199
perform brute force attacks and they

184
00:07:41,199 --> 00:07:44,400
rely on some vulnerabilities and rdp to

185
00:07:44,400 --> 00:07:46,960
gain initial access so

186
00:07:46,960 --> 00:07:50,638
talking about our needs

187
00:07:50,720 --> 00:07:52,080
here is why

188
00:07:52,080 --> 00:07:56,560
this talk was named like this because

189
00:07:56,560 --> 00:07:59,039
during the analysis of threat actor

190
00:07:59,039 --> 00:08:00,080
slang

191
00:08:00,080 --> 00:08:02,080
we found out that

192
00:08:02,080 --> 00:08:03,280
they call

193
00:08:03,280 --> 00:08:06,479
then they use compromise vpn account

194
00:08:06,479 --> 00:08:07,759
to

195
00:08:07,759 --> 00:08:10,240
gain initial access to the compromise

196
00:08:10,240 --> 00:08:11,599
network

197
00:08:11,599 --> 00:08:13,360
they call it

198
00:08:13,360 --> 00:08:16,000
and they want their virtual machine to

199
00:08:16,000 --> 00:08:19,039
be into the network they call it to neat

200
00:08:19,039 --> 00:08:20,560
into the network

201
00:08:20,560 --> 00:08:21,360
so

202
00:08:21,360 --> 00:08:22,800
they put

203
00:08:22,800 --> 00:08:25,120
they get vpn access they put their

204
00:08:25,120 --> 00:08:26,960
virtual machine with all those pin

205
00:08:26,960 --> 00:08:29,280
testing tools like metasploit cobble

206
00:08:29,280 --> 00:08:30,960
strike

207
00:08:30,960 --> 00:08:34,240
crack crap map exec and all that

208
00:08:34,240 --> 00:08:36,240
and start their post exploitation

209
00:08:36,240 --> 00:08:38,839
activities or they just

210
00:08:38,839 --> 00:08:41,599
perform a brute force attack

211
00:08:41,599 --> 00:08:45,600
against 3dp get the password or acquire

212
00:08:45,600 --> 00:08:48,640
both rtp access or vpn access from

213
00:08:48,640 --> 00:08:49,680
initial

214
00:08:49,680 --> 00:08:52,240
access brokers and then perform their

215
00:08:52,240 --> 00:08:54,560
post exploitation activities so quite

216
00:08:54,560 --> 00:08:57,680
simple these two techniques are the most

217
00:08:57,680 --> 00:08:58,640
common

218
00:08:58,640 --> 00:09:00,720
for log bit ransomware

219
00:09:00,720 --> 00:09:03,279
but it's not all

220
00:09:03,279 --> 00:09:05,760
they are trying to expand their

221
00:09:05,760 --> 00:09:07,600
capabilities

222
00:09:07,600 --> 00:09:09,040
and

223
00:09:09,040 --> 00:09:13,120
here are two messages from very popular

224
00:09:13,120 --> 00:09:16,080
forum that is used by

225
00:09:16,080 --> 00:09:18,399
various right actors including

226
00:09:18,399 --> 00:09:20,160
ransomware gangs

227
00:09:20,160 --> 00:09:23,760
the firm is called xss dot is

228
00:09:23,760 --> 00:09:26,000
and here are two messages so

229
00:09:26,000 --> 00:09:28,640
in the first message uh

230
00:09:28,640 --> 00:09:31,120
log bits up that's the official account

231
00:09:31,120 --> 00:09:33,279
that is used by

232
00:09:33,279 --> 00:09:35,360
uh logbit ransomware the service program

233
00:09:35,360 --> 00:09:37,200
runner

234
00:09:37,200 --> 00:09:41,440
he asked if anybody can provide him the

235
00:09:41,440 --> 00:09:43,519
contacts

236
00:09:43,519 --> 00:09:44,320
of

237
00:09:44,320 --> 00:09:46,880
the owner of trigbot

238
00:09:46,880 --> 00:09:48,839
and the second message

239
00:09:48,839 --> 00:09:50,640
he

240
00:09:50,640 --> 00:09:54,000
posts about that he's still looking for

241
00:09:54,000 --> 00:09:56,959
contacts of trickbot creators so what

242
00:09:56,959 --> 00:09:58,480
does it mean

243
00:09:58,480 --> 00:09:59,760
uh

244
00:09:59,760 --> 00:10:01,440
lockpit

245
00:10:01,440 --> 00:10:03,600
wants to expand

246
00:10:03,600 --> 00:10:06,000
its capabilities and to expand its

247
00:10:06,000 --> 00:10:08,399
affiliate capabilities for initial

248
00:10:08,399 --> 00:10:10,880
access so they already have experience

249
00:10:10,880 --> 00:10:12,399
with exploiting public facing

250
00:10:12,399 --> 00:10:14,079
applications they already have

251
00:10:14,079 --> 00:10:16,720
experience with brute force and rdp they

252
00:10:16,720 --> 00:10:19,040
have experience with using compromised

253
00:10:19,040 --> 00:10:20,720
vpn accounts

254
00:10:20,720 --> 00:10:22,720
to gain initial access but

255
00:10:22,720 --> 00:10:25,680
uh there are other ways for example

256
00:10:25,680 --> 00:10:28,240
spearfusion with malicious attachments

257
00:10:28,240 --> 00:10:31,760
to infect victims with bots like cubot

258
00:10:31,760 --> 00:10:35,360
trig bot iced id and all that and for

259
00:10:35,360 --> 00:10:36,880
example

260
00:10:36,880 --> 00:10:39,600
another competitor to be

261
00:10:39,600 --> 00:10:42,560
the most active group is conti and this

262
00:10:42,560 --> 00:10:45,600
group is using trigbot and bazaar

263
00:10:45,600 --> 00:10:50,079
and cubot and icd and so log bit uh

264
00:10:50,079 --> 00:10:51,040
wants

265
00:10:51,040 --> 00:10:53,600
uh its affiliates to have similar

266
00:10:53,600 --> 00:10:56,720
capabilities so most likely likely in

267
00:10:56,720 --> 00:10:59,680
the nearest future we'll see that

268
00:10:59,680 --> 00:11:00,560
even

269
00:11:00,560 --> 00:11:03,600
more diverse initial access techniques

270
00:11:03,600 --> 00:11:06,800
are used by this protector including

271
00:11:06,800 --> 00:11:09,760
spearfishing emails including

272
00:11:09,760 --> 00:11:12,880
uh delivery of trick board bazaar load

273
00:11:12,880 --> 00:11:15,839
and all that

274
00:11:16,480 --> 00:11:17,440
okay

275
00:11:17,440 --> 00:11:19,440
once the protectors

276
00:11:19,440 --> 00:11:20,720
got access

277
00:11:20,720 --> 00:11:23,920
to the compromise network while vpn is

278
00:11:23,920 --> 00:11:27,680
one thing they can use their uh own

279
00:11:27,680 --> 00:11:29,600
virtual virtual machines with better

280
00:11:29,600 --> 00:11:32,079
stools scanf vulnerabilities for example

281
00:11:32,079 --> 00:11:34,000
discuss it later

282
00:11:34,000 --> 00:11:35,200
but

283
00:11:35,200 --> 00:11:36,320
let's say

284
00:11:36,320 --> 00:11:39,519
they got to the network uh using rdp

285
00:11:39,519 --> 00:11:41,760
brute force and potentially they already

286
00:11:41,760 --> 00:11:44,640
have some elevated credentials because

287
00:11:44,640 --> 00:11:47,120
very common talking about

288
00:11:47,120 --> 00:11:49,040
such attacks then

289
00:11:49,040 --> 00:11:50,800
ransomware affiliates attack public

290
00:11:50,800 --> 00:11:52,800
facing rdp service

291
00:11:52,800 --> 00:11:54,000
they may

292
00:11:54,000 --> 00:11:54,880
get

293
00:11:54,880 --> 00:11:57,200
for example administrator accounts that

294
00:11:57,200 --> 00:11:59,519
already have local administrative

295
00:11:59,519 --> 00:12:01,279
privileges so they

296
00:12:01,279 --> 00:12:04,639
can use quite a lot of tools

297
00:12:04,639 --> 00:12:06,959
for post exploitation already because

298
00:12:06,959 --> 00:12:09,439
they have

299
00:12:09,519 --> 00:12:12,240
their feet on the land they have access

300
00:12:12,240 --> 00:12:15,279
to at least one server and maybe

301
00:12:15,279 --> 00:12:19,279
that's kind of terminal server and even

302
00:12:19,279 --> 00:12:23,120
uh guys with domain admin accounts may

303
00:12:23,120 --> 00:12:27,040
usually hang on these or for example

304
00:12:27,040 --> 00:12:29,519
uh this initially accessed

305
00:12:29,519 --> 00:12:30,959
administrative account that's

306
00:12:30,959 --> 00:12:33,600
administrator account then the network

307
00:12:33,600 --> 00:12:35,760
may have the same password for local

308
00:12:35,760 --> 00:12:37,440
administrator account and the same

309
00:12:37,440 --> 00:12:40,079
account name for the whole network so

310
00:12:40,079 --> 00:12:42,399
they can start moving laterally

311
00:12:42,399 --> 00:12:43,839
immediately

312
00:12:43,839 --> 00:12:45,440
but still

313
00:12:45,440 --> 00:12:48,160
many networks and many servers they have

314
00:12:48,160 --> 00:12:50,800
at least some security controls

315
00:12:50,800 --> 00:12:53,440
implemented and at least some security

316
00:12:53,440 --> 00:12:56,720
products installed so in most cases to

317
00:12:56,720 --> 00:12:57,680
drop

318
00:12:57,680 --> 00:13:00,240
more tools for post exploitation for

319
00:13:00,240 --> 00:13:03,600
example to dump credentials to start

320
00:13:03,600 --> 00:13:06,320
scanning network to start active

321
00:13:06,320 --> 00:13:08,959
directory reconnaissance they need to

322
00:13:08,959 --> 00:13:11,440
disable such tools so

323
00:13:11,440 --> 00:13:12,800
if we are talking about log bit

324
00:13:12,800 --> 00:13:16,560
affiliates they very often use various

325
00:13:16,560 --> 00:13:19,040
rootkit detection tools so originally

326
00:13:19,040 --> 00:13:21,680
these tools

327
00:13:21,680 --> 00:13:23,279
were aimed at

328
00:13:23,279 --> 00:13:24,639
defending

329
00:13:24,639 --> 00:13:27,680
the host or finding abnormal or

330
00:13:27,680 --> 00:13:29,519
malicious activity

331
00:13:29,519 --> 00:13:30,720
but

332
00:13:30,720 --> 00:13:34,480
in the hands of red actors such tools

333
00:13:34,480 --> 00:13:36,240
can be used to

334
00:13:36,240 --> 00:13:39,680
bypass defenses to evade defenses so

335
00:13:39,680 --> 00:13:42,000
uh if you're talking about log bit quite

336
00:13:42,000 --> 00:13:44,079
common tools are the following so first

337
00:13:44,079 --> 00:13:46,000
of all heron

338
00:13:46,000 --> 00:13:49,920
h rs word then process hacker and pc

339
00:13:49,920 --> 00:13:52,000
hunter some of these tools for example

340
00:13:52,000 --> 00:13:54,720
protest hacker and pc hunter

341
00:13:54,720 --> 00:13:57,040
are quite common for various groups for

342
00:13:57,040 --> 00:13:59,360
example especially those who are focused

343
00:13:59,360 --> 00:14:01,199
on other people's faults

344
00:14:01,199 --> 00:14:04,639
like dharma like phobos and all that

345
00:14:04,639 --> 00:14:06,399
uh if we are talking about her own

346
00:14:06,399 --> 00:14:09,920
interest work it's quite uncommon tools

347
00:14:09,920 --> 00:14:12,160
with asian origin

348
00:14:12,160 --> 00:14:15,839
but again if we are focusing on

349
00:14:15,839 --> 00:14:18,399
underground forums and all this we

350
00:14:18,399 --> 00:14:20,639
may notice that

351
00:14:20,639 --> 00:14:23,440
the person behind log bits

352
00:14:23,440 --> 00:14:26,079
account log beats up

353
00:14:26,079 --> 00:14:28,959
in some thread he posted that

354
00:14:28,959 --> 00:14:32,000
now he is living in china so maybe due

355
00:14:32,000 --> 00:14:33,519
to this fact

356
00:14:33,519 --> 00:14:34,399
uh

357
00:14:34,399 --> 00:14:38,320
arsenal of uh their affiliates uh

358
00:14:38,320 --> 00:14:40,160
includes some tools

359
00:14:40,160 --> 00:14:43,920
that are usually used in china or other

360
00:14:43,920 --> 00:14:45,839
asian countries

361
00:14:45,839 --> 00:14:47,760
okay let's move forward

362
00:14:47,760 --> 00:14:51,199
of course anti-root kit tools are not

363
00:14:51,199 --> 00:14:53,839
the only tools that are used to for

364
00:14:53,839 --> 00:14:56,720
defense evasion

365
00:14:57,519 --> 00:14:59,839
just like many other

366
00:14:59,839 --> 00:15:01,680
ransomware as a service program

367
00:15:01,680 --> 00:15:02,959
affiliates

368
00:15:02,959 --> 00:15:06,240
logbed affiliates use various scripts

369
00:15:06,240 --> 00:15:09,920
uh to disable antivirus software

370
00:15:09,920 --> 00:15:13,519
uh in some cases it's just one liner

371
00:15:13,519 --> 00:15:15,199
like you can see on the slide for

372
00:15:15,199 --> 00:15:19,680
example to disable a set they use wmic

373
00:15:19,680 --> 00:15:21,720
and try to

374
00:15:21,720 --> 00:15:23,760
uninstall it

375
00:15:23,760 --> 00:15:26,880
and another example with windows

376
00:15:26,880 --> 00:15:30,240
defender this time protectors attempted

377
00:15:30,240 --> 00:15:34,560
to use powershell to disable it

378
00:15:34,560 --> 00:15:37,519
in other cases there may be

379
00:15:37,519 --> 00:15:41,440
page files that include quite a few

380
00:15:41,440 --> 00:15:43,920
antivirus software vendors so in some

381
00:15:43,920 --> 00:15:47,199
cases uh threat actors may use more

382
00:15:47,199 --> 00:15:50,000
opportunistic approach so they not

383
00:15:50,000 --> 00:15:52,800
target on specific antivirus software

384
00:15:52,800 --> 00:15:55,279
that is installed and they don't perform

385
00:15:55,279 --> 00:15:57,360
any reconnaissance for example with the

386
00:15:57,360 --> 00:16:00,079
same process hacker they may just look

387
00:16:00,079 --> 00:16:03,360
through running processes to identify

388
00:16:03,360 --> 00:16:05,839
uh which antivirus software installed

389
00:16:05,839 --> 00:16:07,519
and try to

390
00:16:07,519 --> 00:16:09,600
disable this antivirus software they

391
00:16:09,600 --> 00:16:12,000
just just may have a batch file that

392
00:16:12,000 --> 00:16:14,079
tries to disable

393
00:16:14,079 --> 00:16:15,040
almost

394
00:16:15,040 --> 00:16:16,639
any possible

395
00:16:16,639 --> 00:16:19,279
antivirus software products so that's

396
00:16:19,279 --> 00:16:21,600
another approach they may be used so it

397
00:16:21,600 --> 00:16:25,440
depends on the affiliates of course

398
00:16:26,720 --> 00:16:29,680
and one more thing

399
00:16:29,680 --> 00:16:32,800
apart from disabling

400
00:16:32,800 --> 00:16:34,839
antivirus

401
00:16:34,839 --> 00:16:36,639
protectors may

402
00:16:36,639 --> 00:16:37,920
try to

403
00:16:37,920 --> 00:16:40,560
make instant response or forensic

404
00:16:40,560 --> 00:16:42,480
analysis or instant investigation more

405
00:16:42,480 --> 00:16:44,000
complex because

406
00:16:44,000 --> 00:16:46,800
especially in our recent incident

407
00:16:46,800 --> 00:16:48,480
response engagement

408
00:16:48,480 --> 00:16:51,199
the third actors attempted to

409
00:16:51,199 --> 00:16:54,079
wipe folders with their tools so for

410
00:16:54,079 --> 00:16:56,399
example they

411
00:16:56,399 --> 00:16:58,000
wanted to

412
00:16:58,000 --> 00:16:59,279
they wanted

413
00:16:59,279 --> 00:17:01,199
c windows temp

414
00:17:01,199 --> 00:17:03,120
to be their staging folder there they

415
00:17:03,120 --> 00:17:04,959
drop all their tool set tools for

416
00:17:04,959 --> 00:17:08,799
exaggeration tools for network scanning

417
00:17:08,799 --> 00:17:09,599
uh

418
00:17:09,599 --> 00:17:10,480
some

419
00:17:10,480 --> 00:17:12,799
parts of post exploitation frameworks

420
00:17:12,799 --> 00:17:14,000
and all that

421
00:17:14,000 --> 00:17:16,720
and once they perform these activities

422
00:17:16,720 --> 00:17:19,359
they just wiped the contents of these so

423
00:17:19,359 --> 00:17:21,760
you won't find files sometimes you can

424
00:17:21,760 --> 00:17:23,039
recover it

425
00:17:23,039 --> 00:17:24,959
sometimes you can just

426
00:17:24,959 --> 00:17:27,599
extract this information

427
00:17:27,599 --> 00:17:29,600
from various forensic active artifacts

428
00:17:29,600 --> 00:17:32,080
like m cache sim cache some windows

429
00:17:32,080 --> 00:17:34,080
event logs and all that

430
00:17:34,080 --> 00:17:36,720
but still you won't find the files

431
00:17:36,720 --> 00:17:37,840
next thing

432
00:17:37,840 --> 00:17:41,679
uh as they move literally quite heavily

433
00:17:41,679 --> 00:17:42,559
so

434
00:17:42,559 --> 00:17:45,200
you can usually find quite a lot of

435
00:17:45,200 --> 00:17:46,960
valuable information

436
00:17:46,960 --> 00:17:50,559
in windows event log files and

437
00:17:50,559 --> 00:17:53,360
they want to clean

438
00:17:53,360 --> 00:17:55,360
such locks as well so as you can see on

439
00:17:55,360 --> 00:17:58,720
the slides there are quite simple power

440
00:17:58,720 --> 00:18:02,480
shell while uh one liners so first one

441
00:18:02,480 --> 00:18:05,840
was used by logbit affiliates to

442
00:18:05,840 --> 00:18:07,039
wipe

443
00:18:07,039 --> 00:18:07,840
uh

444
00:18:07,840 --> 00:18:10,400
the staging folder that they

445
00:18:10,400 --> 00:18:13,360
stored all their toolset and the second

446
00:18:13,360 --> 00:18:14,880
is uh

447
00:18:14,880 --> 00:18:17,600
to clean the event logs because they

448
00:18:17,600 --> 00:18:20,480
don't want instant responders to track

449
00:18:20,480 --> 00:18:22,960
their activities and they want the life

450
00:18:22,960 --> 00:18:26,000
of instant respond responders be more

451
00:18:26,000 --> 00:18:29,720
complicated unfortunately

452
00:18:30,559 --> 00:18:32,480
okay

453
00:18:32,480 --> 00:18:34,720
credential access

454
00:18:34,720 --> 00:18:37,520
of course in some cases

455
00:18:37,520 --> 00:18:40,880
protectors may ex have access to

456
00:18:40,880 --> 00:18:43,760
elevated credentials immediately

457
00:18:43,760 --> 00:18:44,640
uh

458
00:18:44,640 --> 00:18:46,559
for example if they boot first local

459
00:18:46,559 --> 00:18:48,400
administrator account

460
00:18:48,400 --> 00:18:52,160
but still they need more because they

461
00:18:52,160 --> 00:18:54,799
want to move laterally

462
00:18:54,799 --> 00:18:58,160
that's why they need

463
00:18:58,160 --> 00:18:59,919
in perfect world they need the main

464
00:18:59,919 --> 00:19:02,080
admin account or at least

465
00:19:02,080 --> 00:19:04,720
local admin account that has the same

466
00:19:04,720 --> 00:19:06,640
username and the same password on

467
00:19:06,640 --> 00:19:08,400
various hosts

468
00:19:08,400 --> 00:19:10,720
uh lockwood affiliates still use memory

469
00:19:10,720 --> 00:19:13,360
cards just like many other ransomware

470
00:19:13,360 --> 00:19:14,400
gangs

471
00:19:14,400 --> 00:19:17,760
this tool is really really easy

472
00:19:17,760 --> 00:19:20,799
can be really really easy detected but

473
00:19:20,799 --> 00:19:23,039
as we already discussed

474
00:19:23,039 --> 00:19:26,559
in many cases protectors disable

475
00:19:26,559 --> 00:19:29,600
antivirus software and other security

476
00:19:29,600 --> 00:19:31,760
controls so they can

477
00:19:31,760 --> 00:19:33,760
easily use

478
00:19:33,760 --> 00:19:35,679
any hacking tool

479
00:19:35,679 --> 00:19:38,720
for credential dumping and all that so

480
00:19:38,720 --> 00:19:39,520
they

481
00:19:39,520 --> 00:19:42,880
use this capability and this opportunity

482
00:19:42,880 --> 00:19:46,799
and still uh vc mimikaze very often uh

483
00:19:46,799 --> 00:19:49,679
they may rene rename it for example

484
00:19:49,679 --> 00:19:52,919
to mimi.xy for

485
00:19:52,919 --> 00:19:57,679
x64 or x86 dot xz or just one dot xz it

486
00:19:57,679 --> 00:19:59,679
depends on the affiliates but still

487
00:19:59,679 --> 00:20:03,039
because it's widely used

488
00:20:03,360 --> 00:20:04,640
what else

489
00:20:04,640 --> 00:20:07,760
they also use various tools

490
00:20:07,760 --> 00:20:09,919
by neurosoft

491
00:20:09,919 --> 00:20:12,159
so some examples include

492
00:20:12,159 --> 00:20:14,640
internet explorer pass view router pass

493
00:20:14,640 --> 00:20:17,120
view web browser pass view mail pass

494
00:20:17,120 --> 00:20:19,600
view and many many others so usually

495
00:20:19,600 --> 00:20:22,400
they just drop an archive that includes

496
00:20:22,400 --> 00:20:24,400
all these tools that are downloaded from

497
00:20:24,400 --> 00:20:26,799
the official news website

498
00:20:26,799 --> 00:20:29,760
and they run it in a very optimistic

499
00:20:29,760 --> 00:20:31,840
manner they

500
00:20:31,840 --> 00:20:33,520
don't know

501
00:20:33,520 --> 00:20:36,159
what kind of credentials

502
00:20:36,159 --> 00:20:38,880
can be captured they just run everything

503
00:20:38,880 --> 00:20:40,480
and collect

504
00:20:40,480 --> 00:20:42,960
and excel trade all information that is

505
00:20:42,960 --> 00:20:45,039
collected and then they're thinking

506
00:20:45,039 --> 00:20:46,080
about

507
00:20:46,080 --> 00:20:48,559
which passwords and which account can be

508
00:20:48,559 --> 00:20:49,600
used

509
00:20:49,600 --> 00:20:51,280
in the future during their post

510
00:20:51,280 --> 00:20:54,080
exploitation routine

511
00:20:54,080 --> 00:20:55,520
uh

512
00:20:55,520 --> 00:20:58,000
one more thing is just regular

513
00:20:58,000 --> 00:21:01,039
legitimate tools they can

514
00:21:01,039 --> 00:21:04,960
transfer such tools from the c2 or they

515
00:21:04,960 --> 00:21:07,760
may use just building tools like for

516
00:21:07,760 --> 00:21:10,159
example tuscan gel that can be used to

517
00:21:10,159 --> 00:21:11,679
dump or sauce

518
00:21:11,679 --> 00:21:13,919
or they can use sprouts down to double

519
00:21:13,919 --> 00:21:15,520
sauce or they

520
00:21:15,520 --> 00:21:16,559
may

521
00:21:16,559 --> 00:21:18,480
abuse other living of the land

522
00:21:18,480 --> 00:21:20,720
techniques to dump it

523
00:21:20,720 --> 00:21:21,520
so

524
00:21:21,520 --> 00:21:25,360
uh techniques for credential access are

525
00:21:25,360 --> 00:21:28,799
quite plain and quite simple but still

526
00:21:28,799 --> 00:21:31,600
very very effective especially if

527
00:21:31,600 --> 00:21:34,080
the threat actors disabled antivirus

528
00:21:34,080 --> 00:21:37,120
software already

529
00:21:37,919 --> 00:21:39,760
okay let's move forward

530
00:21:39,760 --> 00:21:40,559
and

531
00:21:40,559 --> 00:21:44,320
talk a bit about reconnaissance

532
00:21:44,320 --> 00:21:46,320
just like other protectors that are

533
00:21:46,320 --> 00:21:50,480
focused on rdp access or vpn access

534
00:21:50,480 --> 00:21:53,520
log with affiliates use various network

535
00:21:53,520 --> 00:21:54,799
scanners

536
00:21:54,799 --> 00:21:57,919
during almost any intrusion so very

537
00:21:57,919 --> 00:22:00,159
popular examples include soft perfect

538
00:22:00,159 --> 00:22:02,880
network scanner i think this network

539
00:22:02,880 --> 00:22:04,559
scanner is

540
00:22:04,559 --> 00:22:08,000
the most popular network scanner among

541
00:22:08,000 --> 00:22:11,120
all ransomware gangs that are operating

542
00:22:11,120 --> 00:22:14,240
nowadays other examples include advanced

543
00:22:14,240 --> 00:22:17,360
ip scanner angry ap scanner and advanced

544
00:22:17,360 --> 00:22:20,320
sport scanner so these scanners can be

545
00:22:20,320 --> 00:22:22,559
downloaded freely from the internet in

546
00:22:22,559 --> 00:22:25,600
some cases threat actors use

547
00:22:25,600 --> 00:22:27,360
build in

548
00:22:27,360 --> 00:22:29,760
capabilities like web browsers to

549
00:22:29,760 --> 00:22:32,080
download it from the official website

550
00:22:32,080 --> 00:22:33,840
especially when they are talking about

551
00:22:33,840 --> 00:22:35,679
rdp access

552
00:22:35,679 --> 00:22:39,039
uh enel brood a quite popular tool for

553
00:22:39,039 --> 00:22:41,039
performing brute force attack against

554
00:22:41,039 --> 00:22:43,280
rtp servers

555
00:22:43,280 --> 00:22:45,520
of course it's used

556
00:22:45,520 --> 00:22:48,559
for obtaining the initial access but

557
00:22:48,559 --> 00:22:50,960
it's not

558
00:22:50,960 --> 00:22:52,480
the only thing

559
00:22:52,480 --> 00:22:54,480
for attackers use it for

560
00:22:54,480 --> 00:22:57,360
uh another thing uh as they already have

561
00:22:57,360 --> 00:22:58,960
some credentials for example they have

562
00:22:58,960 --> 00:23:01,039
administrator account or some other

563
00:23:01,039 --> 00:23:03,840
account and they want to check if it's

564
00:23:03,840 --> 00:23:06,720
wedded on other hosts internet so they

565
00:23:06,720 --> 00:23:09,360
maybe they don't need to dump more

566
00:23:09,360 --> 00:23:12,400
credentials and they may use

567
00:23:12,400 --> 00:23:14,640
already compromised accounts to move

568
00:23:14,640 --> 00:23:17,200
laterally and to deploy ransomware so

569
00:23:17,200 --> 00:23:19,760
quite easy so that's why anal root can

570
00:23:19,760 --> 00:23:22,320
be used on initially compromised host to

571
00:23:22,320 --> 00:23:23,520
check

572
00:23:23,520 --> 00:23:25,679
these accounts

573
00:23:25,679 --> 00:23:26,799
again as

574
00:23:26,799 --> 00:23:29,520
they may already get some

575
00:23:29,520 --> 00:23:30,960
credentials

576
00:23:30,960 --> 00:23:32,720
they may dump some credentials via

577
00:23:32,720 --> 00:23:35,039
mimikats they can brute force some

578
00:23:35,039 --> 00:23:37,760
credentials again there is another tool

579
00:23:37,760 --> 00:23:40,400
we observed them to use for credentials

580
00:23:40,400 --> 00:23:42,159
checking this why

581
00:23:42,159 --> 00:23:45,279
this time this was abusing smb and it's

582
00:23:45,279 --> 00:23:46,960
very popular and called handwork

583
00:23:46,960 --> 00:23:49,039
assembly autobrood

584
00:23:49,039 --> 00:23:50,400
so

585
00:23:50,400 --> 00:23:53,440
again one more tool for testing obtained

586
00:23:53,440 --> 00:23:54,799
credentials

587
00:23:54,799 --> 00:23:55,679
and

588
00:23:55,679 --> 00:23:58,640
another tool i think

589
00:23:58,640 --> 00:24:00,960
anybody who's involved in penetration

590
00:24:00,960 --> 00:24:02,960
tests in the red teaming

591
00:24:02,960 --> 00:24:06,320
is well aware about it is bloodhound and

592
00:24:06,320 --> 00:24:07,919
especially

593
00:24:07,919 --> 00:24:10,240
uh the part of it that's called that's

594
00:24:10,240 --> 00:24:12,000
called shophound

595
00:24:12,000 --> 00:24:15,440
that's used uh by logbait affiliates to

596
00:24:15,440 --> 00:24:17,679
find religious relationships within an

597
00:24:17,679 --> 00:24:18,640
active

598
00:24:18,640 --> 00:24:21,679
directory environment and discard the

599
00:24:21,679 --> 00:24:23,679
attack paths so

600
00:24:23,679 --> 00:24:26,960
where they need to get to to

601
00:24:26,960 --> 00:24:30,400
dump elevated credentials they need for

602
00:24:30,400 --> 00:24:32,080
proper lateral movement data

603
00:24:32,080 --> 00:24:33,600
exfiltration

604
00:24:33,600 --> 00:24:36,799
and of course ransomware deployment

605
00:24:36,799 --> 00:24:38,400
so as you can see

606
00:24:38,400 --> 00:24:41,039
uh protectors use quite a few tools of

607
00:24:41,039 --> 00:24:43,919
course not of all these tools will be

608
00:24:43,919 --> 00:24:46,640
used in just one attack it based on

609
00:24:46,640 --> 00:24:47,760
various

610
00:24:47,760 --> 00:24:49,840
instant response engagements

611
00:24:49,840 --> 00:24:51,440
we had

612
00:24:51,440 --> 00:24:54,320
okay let's move forward lateral movement

613
00:24:54,320 --> 00:24:55,360
once

614
00:24:55,360 --> 00:24:58,480
fret actors got initial access

615
00:24:58,480 --> 00:25:02,240
once they got elevated accounts and

616
00:25:02,240 --> 00:25:04,880
and they already

617
00:25:04,880 --> 00:25:08,640
uh perform basic reconnaissance

618
00:25:08,640 --> 00:25:09,600
oh

619
00:25:09,600 --> 00:25:12,000
in some cases they already know quite a

620
00:25:12,000 --> 00:25:14,240
lot about the network they are ready to

621
00:25:14,240 --> 00:25:18,400
move later so first of all they used rdp

622
00:25:18,400 --> 00:25:21,200
even if they got initial access via rdp

623
00:25:21,200 --> 00:25:23,520
they can still use it to jump from one

624
00:25:23,520 --> 00:25:25,360
host to another

625
00:25:25,360 --> 00:25:28,960
this type of access is extremely common

626
00:25:28,960 --> 00:25:31,760
and many protectors including lock but

627
00:25:31,760 --> 00:25:35,039
affiliates they even have batch files

628
00:25:35,039 --> 00:25:37,840
they can execute remotely for example

629
00:25:37,840 --> 00:25:40,400
yps exec

630
00:25:40,400 --> 00:25:44,080
to enable rdp and remote hosts and they

631
00:25:44,080 --> 00:25:46,159
really love it and they use it very

632
00:25:46,159 --> 00:25:47,200
often

633
00:25:47,200 --> 00:25:49,440
of course plus exploitation frameworks

634
00:25:49,440 --> 00:25:55,120
metasploit cobble strike crack map exec

635
00:25:55,360 --> 00:25:57,840
very important point here regarding all

636
00:25:57,840 --> 00:26:00,320
these so of course they use cobble

637
00:26:00,320 --> 00:26:02,720
strike and metasploit quite often crap

638
00:26:02,720 --> 00:26:05,840
map exec it's not that popular but still

639
00:26:05,840 --> 00:26:08,559
we observed some incidents where the

640
00:26:08,559 --> 00:26:11,840
affiliates use this framework

641
00:26:11,840 --> 00:26:13,919
but what's more important is

642
00:26:13,919 --> 00:26:17,760
mainly they focus on vpn and rtp access

643
00:26:17,760 --> 00:26:19,520
so

644
00:26:19,520 --> 00:26:20,799
they may

645
00:26:20,799 --> 00:26:22,480
not use it

646
00:26:22,480 --> 00:26:25,679
very extensively instead they may uh

647
00:26:25,679 --> 00:26:26,559
just

648
00:26:26,559 --> 00:26:29,600
use rtp to move laterally and then uh

649
00:26:29,600 --> 00:26:32,480
they may choose one or two servers there

650
00:26:32,480 --> 00:26:35,360
they'll execute cable strike beacon and

651
00:26:35,360 --> 00:26:38,159
use it for redundant text so for example

652
00:26:38,159 --> 00:26:40,880
this server may be even not encrypted by

653
00:26:40,880 --> 00:26:42,159
ransomware

654
00:26:42,159 --> 00:26:43,039
and

655
00:26:43,039 --> 00:26:44,960
maybe instant responders or system

656
00:26:44,960 --> 00:26:46,960
administrators of the company they may

657
00:26:46,960 --> 00:26:49,679
just keep it thinking that

658
00:26:49,679 --> 00:26:52,240
protectors didn't do anything malicious

659
00:26:52,240 --> 00:26:53,279
on that

660
00:26:53,279 --> 00:26:56,480
and such servers with beacons they may

661
00:26:56,480 --> 00:26:59,520
allow for attackers to resell access or

662
00:26:59,520 --> 00:27:01,760
just get back

663
00:27:01,760 --> 00:27:02,799
to

664
00:27:02,799 --> 00:27:05,039
ask for ransom again

665
00:27:05,039 --> 00:27:06,400
or

666
00:27:06,400 --> 00:27:07,840
just to

667
00:27:07,840 --> 00:27:10,400
deploy ransomware again if the victim

668
00:27:10,400 --> 00:27:11,760
refused to pay

669
00:27:11,760 --> 00:27:13,760
so that's very important thing even if

670
00:27:13,760 --> 00:27:15,440
you don't see

671
00:27:15,440 --> 00:27:18,240
any evidence of cobalt strike usage make

672
00:27:18,240 --> 00:27:21,200
sure you connected data from as much

673
00:27:21,200 --> 00:27:24,159
hosts as possible and you are sure that

674
00:27:24,159 --> 00:27:27,039
the fractal actors didn't use it

675
00:27:27,039 --> 00:27:28,559
uh

676
00:27:28,559 --> 00:27:30,960
next thing is putting

677
00:27:30,960 --> 00:27:33,440
nowadays log bits also provides linux

678
00:27:33,440 --> 00:27:35,279
version to its affiliates so they need

679
00:27:35,279 --> 00:27:37,840
to move laterally not only in windows

680
00:27:37,840 --> 00:27:38,960
environment

681
00:27:38,960 --> 00:27:41,760
but in many cases they need to get from

682
00:27:41,760 --> 00:27:43,919
windows environment to linux environment

683
00:27:43,919 --> 00:27:46,159
and they need tools

684
00:27:46,159 --> 00:27:48,640
for this so based on our experience and

685
00:27:48,640 --> 00:27:50,640
our instant response engagements we

686
00:27:50,640 --> 00:27:52,960
absorb that the fret actors use put it

687
00:27:52,960 --> 00:27:53,919
to

688
00:27:53,919 --> 00:27:56,960
perform sage connections to linux hosts

689
00:27:56,960 --> 00:27:59,919
and deploy log bit

690
00:27:59,919 --> 00:28:03,039
and of course again as we already talked

691
00:28:03,039 --> 00:28:08,000
about vpn access uh and that protectors

692
00:28:08,000 --> 00:28:11,039
prefer to knit into the network

693
00:28:11,039 --> 00:28:14,880
of course they use various

694
00:28:14,880 --> 00:28:18,080
vulnerabilities especially tunnel blue s

695
00:28:18,080 --> 00:28:20,960
and b ghosts and zero log on to

696
00:28:20,960 --> 00:28:23,520
move laterally once they get vpn access

697
00:28:23,520 --> 00:28:26,000
and once they put their

698
00:28:26,000 --> 00:28:26,799
uh

699
00:28:26,799 --> 00:28:28,799
pen tests and virtual machine into the

700
00:28:28,799 --> 00:28:31,799
network

701
00:28:32,720 --> 00:28:35,120
let's uh talk a bit about redundant

702
00:28:35,120 --> 00:28:37,679
access separately a bit

703
00:28:37,679 --> 00:28:39,200
so first of all

704
00:28:39,200 --> 00:28:41,600
in almost any instant response

705
00:28:41,600 --> 00:28:43,600
engagements with

706
00:28:43,600 --> 00:28:46,399
lobbied we observed that the threat

707
00:28:46,399 --> 00:28:47,679
actors

708
00:28:47,679 --> 00:28:51,039
used legitimate remote access tools

709
00:28:51,039 --> 00:28:51,919
so

710
00:28:51,919 --> 00:28:54,880
some trivial examples include any desk

711
00:28:54,880 --> 00:28:57,760
but in some cases they may use very

712
00:28:57,760 --> 00:29:00,559
uncommon and

713
00:29:00,559 --> 00:29:01,760
hardly

714
00:29:01,760 --> 00:29:03,039
detectable

715
00:29:03,039 --> 00:29:07,120
tools like remote desktop plus

716
00:29:07,120 --> 00:29:09,679
again if we are talking about networks

717
00:29:09,679 --> 00:29:11,440
the

718
00:29:11,440 --> 00:29:15,120
company use one or maybe a few

719
00:29:15,120 --> 00:29:17,679
are rdp servers and protectors may for

720
00:29:17,679 --> 00:29:21,440
example create additional accounts

721
00:29:21,440 --> 00:29:24,640
and if such servers

722
00:29:24,640 --> 00:29:25,520
are

723
00:29:25,520 --> 00:29:27,840
public are still public facing after the

724
00:29:27,840 --> 00:29:29,679
incident then the threat actors

725
00:29:29,679 --> 00:29:31,840
especially if the victim refuses to pay

726
00:29:31,840 --> 00:29:34,559
they may use such service to get back

727
00:29:34,559 --> 00:29:36,240
into the network and perform post

728
00:29:36,240 --> 00:29:37,840
exploitation

729
00:29:37,840 --> 00:29:40,240
again and deploy ransomware or extra

730
00:29:40,240 --> 00:29:44,000
trade data one more time so fdp is one

731
00:29:44,000 --> 00:29:46,240
of the most common

732
00:29:46,240 --> 00:29:49,840
and most popular building tools that are

733
00:29:49,840 --> 00:29:54,399
used by various protectors and just like

734
00:29:54,399 --> 00:29:56,240
i already mentioned

735
00:29:56,240 --> 00:29:59,279
cobblestrike a very very very popular to

736
00:29:59,279 --> 00:30:01,919
amount any ransomware

737
00:30:01,919 --> 00:30:03,120
affiliates

738
00:30:03,120 --> 00:30:04,320
so

739
00:30:04,320 --> 00:30:07,200
this is used quite often and again as i

740
00:30:07,200 --> 00:30:09,760
mentioned on the previous slide they may

741
00:30:09,760 --> 00:30:12,559
execute beacon on just one server and

742
00:30:12,559 --> 00:30:14,080
use this beacon

743
00:30:14,080 --> 00:30:18,000
uh to get back to the network if

744
00:30:18,000 --> 00:30:20,080
the company started remediation process

745
00:30:20,080 --> 00:30:21,200
for example

746
00:30:21,200 --> 00:30:25,120
and blocks vpn accounts blocked

747
00:30:25,120 --> 00:30:28,000
public facing rdp access and all that

748
00:30:28,000 --> 00:30:30,799
they still may use that small common

749
00:30:30,799 --> 00:30:32,480
strike beacon on one of the servers to

750
00:30:32,480 --> 00:30:35,640
get back

751
00:30:36,240 --> 00:30:38,080
okay so

752
00:30:38,080 --> 00:30:40,799
one of two main goals of the thread

753
00:30:40,799 --> 00:30:43,279
actors is data acceleration

754
00:30:43,279 --> 00:30:44,080
uh

755
00:30:44,080 --> 00:30:46,559
protectors use various tools uh in some

756
00:30:46,559 --> 00:30:49,520
cases and they used even web browser but

757
00:30:49,520 --> 00:30:51,520
usually we are talking about web browser

758
00:30:51,520 --> 00:30:54,080
thread actors don't trade a lot of data

759
00:30:54,080 --> 00:30:56,480
using the browsers they may accelerate

760
00:30:56,480 --> 00:30:59,679
for example as elsa's dump they created

761
00:30:59,679 --> 00:31:02,799
or some or things like that if we are

762
00:31:02,799 --> 00:31:06,080
talking about accentuation of large data

763
00:31:06,080 --> 00:31:09,360
sets like 10 gigabytes 100 gigabytes

764
00:31:09,360 --> 00:31:11,279
uh that's

765
00:31:11,279 --> 00:31:12,559
very common

766
00:31:12,559 --> 00:31:15,840
for my ransomware fees to execute

767
00:31:15,840 --> 00:31:18,320
large datasets they use appropriate

768
00:31:18,320 --> 00:31:20,559
tools so first tool we observed was

769
00:31:20,559 --> 00:31:22,559
filezilla

770
00:31:22,559 --> 00:31:25,039
absolutely legitimate tool

771
00:31:25,039 --> 00:31:27,760
of course configured

772
00:31:27,760 --> 00:31:30,399
to transfer data to attack a control

773
00:31:30,399 --> 00:31:31,600
server

774
00:31:31,600 --> 00:31:35,039
next tool that's very important among

775
00:31:35,039 --> 00:31:36,240
a lot of

776
00:31:36,240 --> 00:31:38,320
different protectors

777
00:31:38,320 --> 00:31:39,070
are we will

778
00:31:39,070 --> 00:31:41,519
[Music]

779
00:31:41,519 --> 00:31:44,240
and many others hive

780
00:31:44,240 --> 00:31:45,600
is

781
00:31:45,600 --> 00:31:47,279
win scp

782
00:31:47,279 --> 00:31:49,840
block better figure is used as well and

783
00:31:49,840 --> 00:31:52,799
the most interesting tool that is used

784
00:31:52,799 --> 00:31:56,240
nowadays by the threat actor is stillbit

785
00:31:56,240 --> 00:31:58,159
it's custom tool

786
00:31:58,159 --> 00:32:01,840
that's provided to log bit affiliates

787
00:32:01,840 --> 00:32:05,279
as part of ransomware service program so

788
00:32:05,279 --> 00:32:06,480
they

789
00:32:06,480 --> 00:32:10,159
may use not only ransomware but also a

790
00:32:10,159 --> 00:32:12,880
stealer that can automate

791
00:32:12,880 --> 00:32:15,679
their acceleration activities

792
00:32:15,679 --> 00:32:19,200
and make life of affiliates much easier

793
00:32:19,200 --> 00:32:22,480
let's focus on it a bit so

794
00:32:22,480 --> 00:32:26,159
as you already noticed i think

795
00:32:26,159 --> 00:32:27,679
blockbit

796
00:32:27,679 --> 00:32:30,399
ransomware service program runners they

797
00:32:30,399 --> 00:32:31,279
like

798
00:32:31,279 --> 00:32:33,840
to provide comparison tables to their

799
00:32:33,840 --> 00:32:35,600
potential affiliates these tables are

800
00:32:35,600 --> 00:32:38,480
located on their official dedicated link

801
00:32:38,480 --> 00:32:41,679
site so both for log bits and four steel

802
00:32:41,679 --> 00:32:42,399
bit

803
00:32:42,399 --> 00:32:45,279
so they claim that their ransomware is

804
00:32:45,279 --> 00:32:48,000
the fastest in the business and their

805
00:32:48,000 --> 00:32:50,399
stealer is the fastest in the business

806
00:32:50,399 --> 00:32:51,440
as well

807
00:32:51,440 --> 00:32:53,679
another very interesting thing

808
00:32:53,679 --> 00:32:57,519
they can notice uh on this screenshot

809
00:32:57,519 --> 00:32:59,440
is

810
00:32:59,440 --> 00:33:01,840
log bit provides

811
00:33:01,840 --> 00:33:04,799
other means that

812
00:33:04,799 --> 00:33:07,760
his affiliates or other ransomware sort

813
00:33:07,760 --> 00:33:10,159
of program affiliates use as you can see

814
00:33:10,159 --> 00:33:11,840
it's our clone

815
00:33:11,840 --> 00:33:12,720
and

816
00:33:12,720 --> 00:33:15,519
also you can see that there are a few

817
00:33:15,519 --> 00:33:17,679
examples of

818
00:33:17,679 --> 00:33:18,799
common

819
00:33:18,799 --> 00:33:21,279
cloud services that are used by many

820
00:33:21,279 --> 00:33:23,200
ransomware adservers program affiliates

821
00:33:23,200 --> 00:33:26,960
it's yandex it's mega it's mail.ru it's

822
00:33:26,960 --> 00:33:29,279
pcloud so all these pieces of

823
00:33:29,279 --> 00:33:31,760
information are very important as well

824
00:33:31,760 --> 00:33:34,720
so you can use it to focus your

825
00:33:34,720 --> 00:33:37,360
detection capabilities so to focus on

826
00:33:37,360 --> 00:33:40,480
during instant response engagement so

827
00:33:40,480 --> 00:33:41,200
uh

828
00:33:41,200 --> 00:33:43,440
getting back to stillbit and some

829
00:33:43,440 --> 00:33:46,080
highlights we saw first of all files and

830
00:33:46,080 --> 00:33:47,600
folders for acceleration may be

831
00:33:47,600 --> 00:33:51,360
specified by affiliates so it

832
00:33:51,360 --> 00:33:53,600
they can use various

833
00:33:53,600 --> 00:33:56,399
command line arguments that help them to

834
00:33:56,399 --> 00:33:58,720
choose how exactly

835
00:33:58,720 --> 00:34:01,360
acceleration process will be

836
00:34:01,360 --> 00:34:04,320
so of course uh they can configure which

837
00:34:04,320 --> 00:34:06,960
files of all for example system files

838
00:34:06,960 --> 00:34:09,359
and systems and system folders may be

839
00:34:09,359 --> 00:34:12,079
skipped during exfiltration process also

840
00:34:12,079 --> 00:34:13,440
as some

841
00:34:13,440 --> 00:34:15,760
organization may have

842
00:34:15,760 --> 00:34:18,560
good detection capabilities

843
00:34:18,560 --> 00:34:20,800
affiliates may specify the amount of

844
00:34:20,800 --> 00:34:23,599
data to be extra traded over 15 seconds

845
00:34:23,599 --> 00:34:26,560
so this can help them to avoid detection

846
00:34:26,560 --> 00:34:28,639
and of course just like log bit

847
00:34:28,639 --> 00:34:32,639
ransomware itself still beat can detect

848
00:34:32,639 --> 00:34:35,280
itself after excitation process is

849
00:34:35,280 --> 00:34:38,480
finished so we already learned that

850
00:34:38,480 --> 00:34:41,280
affiliates tend to delete everything

851
00:34:41,280 --> 00:34:44,320
from their staging folders they tend to

852
00:34:44,320 --> 00:34:46,960
remove windows event log and of course

853
00:34:46,960 --> 00:34:48,639
tools that are provided

854
00:34:48,639 --> 00:34:49,520
by

855
00:34:49,520 --> 00:34:51,520
uh log bits

856
00:34:51,520 --> 00:34:52,719
runner

857
00:34:52,719 --> 00:34:54,719
they

858
00:34:54,719 --> 00:34:56,399
allow

859
00:34:56,399 --> 00:34:59,440
affiliates to remove these tools

860
00:34:59,440 --> 00:35:03,160
themselves as well

861
00:35:03,680 --> 00:35:06,400
as i already mentioned uh

862
00:35:06,400 --> 00:35:08,160
log bits have

863
00:35:08,160 --> 00:35:09,359
its own

864
00:35:09,359 --> 00:35:12,079
dedicated link site so here is a

865
00:35:12,079 --> 00:35:14,960
screenshot from this site

866
00:35:14,960 --> 00:35:18,720
usually there is some information about

867
00:35:18,720 --> 00:35:20,880
compromised companies or at least they

868
00:35:20,880 --> 00:35:24,560
claim they compromise these companies

869
00:35:24,560 --> 00:35:27,440
and there is a timer

870
00:35:27,440 --> 00:35:29,200
after this

871
00:35:29,200 --> 00:35:31,839
data that was exfiltrated if it was

872
00:35:31,839 --> 00:35:33,520
accelerated to be published on the

873
00:35:33,520 --> 00:35:35,520
website if

874
00:35:35,520 --> 00:35:37,599
the victim won't pay

875
00:35:37,599 --> 00:35:40,400
so quite common many ransomware gangs

876
00:35:40,400 --> 00:35:42,720
have this site and as i already

877
00:35:42,720 --> 00:35:44,800
mentioned very important and interesting

878
00:35:44,800 --> 00:35:47,040
thing is condition for partners and

879
00:35:47,040 --> 00:35:50,000
contacts as ransomware service programs

880
00:35:50,000 --> 00:35:52,720
were banned from popular

881
00:35:52,720 --> 00:35:54,160
hacking forums

882
00:35:54,160 --> 00:35:56,960
nowadays some protectors

883
00:35:56,960 --> 00:35:59,760
publish information and contacts for

884
00:35:59,760 --> 00:36:03,200
their potential affiliates just on their

885
00:36:03,200 --> 00:36:06,640
own dedicated link site

886
00:36:08,160 --> 00:36:11,280
so ransomware deployment once post

887
00:36:11,280 --> 00:36:13,760
exploitation is finished they have

888
00:36:13,760 --> 00:36:16,079
proper credentials uh

889
00:36:16,079 --> 00:36:18,480
backups are removed

890
00:36:18,480 --> 00:36:21,920
and uh everything else is performed

891
00:36:21,920 --> 00:36:23,040
properly

892
00:36:23,040 --> 00:36:25,520
uh ransomware affiliates logbed

893
00:36:25,520 --> 00:36:27,520
affiliates they are ready to deploy

894
00:36:27,520 --> 00:36:30,079
ransomware in some cases the process is

895
00:36:30,079 --> 00:36:32,240
quite straightforward they just jump

896
00:36:32,240 --> 00:36:35,599
from one host to another using rdp copy

897
00:36:35,599 --> 00:36:38,079
runs away and secure executable and

898
00:36:38,079 --> 00:36:42,240
double click it so it will run

899
00:36:42,240 --> 00:36:45,599
in other cases they may copy

900
00:36:45,599 --> 00:36:48,480
executable on the target hosts

901
00:36:48,480 --> 00:36:51,520
and then use ps exec to execute it a

902
00:36:51,520 --> 00:36:55,680
very common techniques used by many many

903
00:36:55,680 --> 00:36:56,720
uh

904
00:36:56,720 --> 00:36:58,640
ransomware affiliates not on the log

905
00:36:58,640 --> 00:36:59,680
base

906
00:36:59,680 --> 00:37:00,560
and

907
00:37:00,560 --> 00:37:03,280
one thing that's less popular but still

908
00:37:03,280 --> 00:37:06,480
used is group policy modification

909
00:37:06,480 --> 00:37:07,760
so

910
00:37:07,760 --> 00:37:09,599
this allows

911
00:37:09,599 --> 00:37:11,359
a lot bit affiliates

912
00:37:11,359 --> 00:37:14,000
to automatically create scheduled tasks

913
00:37:14,000 --> 00:37:16,400
on remote hosts that will execute a

914
00:37:16,400 --> 00:37:18,079
piece of ransomware

915
00:37:18,079 --> 00:37:21,040
what's more important this is a built-in

916
00:37:21,040 --> 00:37:22,640
capability

917
00:37:22,640 --> 00:37:24,240
in log bits so

918
00:37:24,240 --> 00:37:28,640
even if uh ransomware affiliates are not

919
00:37:28,640 --> 00:37:31,440
uh very good in active directory

920
00:37:31,440 --> 00:37:34,320
configuration they still can use this

921
00:37:34,320 --> 00:37:36,480
piece of ransomware they just need to

922
00:37:36,480 --> 00:37:38,800
execute it on a domain controller for

923
00:37:38,800 --> 00:37:42,640
example and ransomware they will do all

924
00:37:42,640 --> 00:37:45,599
the job for them

925
00:37:45,599 --> 00:37:49,119
so let's finish

926
00:37:49,119 --> 00:37:52,160
the stock with some highlights of log

927
00:37:52,160 --> 00:37:54,240
bit 2.0

928
00:37:54,240 --> 00:37:56,640
so of course it removes shadow copies

929
00:37:56,640 --> 00:37:59,520
just like any other ransomware but using

930
00:37:59,520 --> 00:38:02,640
two methods by the way using vss admin

931
00:38:02,640 --> 00:38:04,960
and using wmic

932
00:38:04,960 --> 00:38:06,000
uh

933
00:38:06,000 --> 00:38:07,839
files encrypted with

934
00:38:07,839 --> 00:38:10,160
as128

935
00:38:10,160 --> 00:38:14,000
in cbc mode so if

936
00:38:14,640 --> 00:38:17,119
you don't have access to private key

937
00:38:17,119 --> 00:38:18,800
then unfortunately

938
00:38:18,800 --> 00:38:23,040
it's impossible to decrypt files

939
00:38:23,280 --> 00:38:26,800
ransomware may mount and encrypt data on

940
00:38:26,800 --> 00:38:28,000
file shares

941
00:38:28,000 --> 00:38:29,280
so

942
00:38:29,280 --> 00:38:30,880
if there are some

943
00:38:30,880 --> 00:38:33,119
network shares then

944
00:38:33,119 --> 00:38:35,520
if proper

945
00:38:35,520 --> 00:38:36,400
things

946
00:38:36,400 --> 00:38:40,079
are in command line with which

947
00:38:40,079 --> 00:38:41,760
the ransomware

948
00:38:41,760 --> 00:38:43,680
is executed then

949
00:38:43,680 --> 00:38:46,079
network shares can be mounted and then

950
00:38:46,079 --> 00:38:48,880
encrypted as well as and as i already

951
00:38:48,880 --> 00:38:50,480
mentioned uh

952
00:38:50,480 --> 00:38:52,079
it may create

953
00:38:52,079 --> 00:38:54,079
group policy object for cell

954
00:38:54,079 --> 00:38:56,640
distribution first of all and it's not

955
00:38:56,640 --> 00:38:57,839
all because

956
00:38:57,839 --> 00:38:59,040
it can add

957
00:38:59,040 --> 00:39:02,000
other very important from protect this

958
00:39:02,000 --> 00:39:04,560
point of view things for example

959
00:39:04,560 --> 00:39:07,280
a batch script to stop various services

960
00:39:07,280 --> 00:39:11,200
and processes both antivirus and some

961
00:39:11,200 --> 00:39:14,400
processes that for example

962
00:39:14,400 --> 00:39:17,359
lock the files from encryption

963
00:39:17,359 --> 00:39:20,720
and it can add a group policy that will

964
00:39:20,720 --> 00:39:23,440
disable windows defender

965
00:39:23,440 --> 00:39:25,760
finally just like steel bit it may

966
00:39:25,760 --> 00:39:29,839
remove itself after execution

967
00:39:30,160 --> 00:39:31,839
so that's it

968
00:39:31,839 --> 00:39:33,119
i hope

969
00:39:33,119 --> 00:39:35,599
this talk

970
00:39:35,599 --> 00:39:37,359
was quite

971
00:39:37,359 --> 00:39:38,960
interesting for you

972
00:39:38,960 --> 00:39:41,040
and you will use

973
00:39:41,040 --> 00:39:43,040
information on tactic techniques and

974
00:39:43,040 --> 00:39:46,720
procedures described in

975
00:39:46,800 --> 00:39:49,040
in your instant response engagement and

976
00:39:49,040 --> 00:39:52,000
to tune your detection logic

977
00:39:52,000 --> 00:39:54,960
still if you have any questions

978
00:39:54,960 --> 00:39:57,520
i'll be online and

979
00:39:57,520 --> 00:39:59,680
are ready to answer all of them in

980
00:39:59,680 --> 00:40:03,879
discord thank you

981
00:40:35,119 --> 00:40:37,200
you

