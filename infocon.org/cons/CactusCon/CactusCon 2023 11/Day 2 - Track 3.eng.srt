1
00:00:37,680 --> 00:00:40,559
so if anybody here has American Family

2
00:00:40,559 --> 00:00:43,640
Insurance they will give you a discount

3
00:00:43,640 --> 00:00:46,739
on your home insurance if you utilize

4
00:00:46,739 --> 00:00:49,440
their hedge Smart Home Solution it has

5
00:00:49,440 --> 00:00:51,300
like sensors that are supposed to like

6
00:00:51,300 --> 00:00:53,399
protect the house so that's their

7
00:00:53,399 --> 00:00:57,239
rationalization for providing a discount

8
00:00:57,239 --> 00:00:59,760
all the same I did find another

9
00:00:59,760 --> 00:01:02,879
authentication issue this vendor is

10
00:01:02,879 --> 00:01:06,240
using a legacy oauth flow type of

11
00:01:06,240 --> 00:01:10,439
password I have the page here from the

12
00:01:10,439 --> 00:01:12,860
oau

13
00:01:13,680 --> 00:01:14,520
th

14
00:01:14,520 --> 00:01:17,400
this was one of their first revisions of

15
00:01:17,400 --> 00:01:20,400
authentication and it has since been

16
00:01:20,400 --> 00:01:24,000
deprecated they have the newer version

17
00:01:24,000 --> 00:01:26,820
of oauth that's released and this is not

18
00:01:26,820 --> 00:01:29,640
part of it so if people are using the

19
00:01:29,640 --> 00:01:32,119
password Grant type for authentication

20
00:01:32,119 --> 00:01:35,360
you're out of spec oauth does not

21
00:01:35,360 --> 00:01:37,280
appreciate that

22
00:01:37,280 --> 00:01:40,079
and showing that once again in mob SF

23
00:01:40,079 --> 00:01:43,439
this is the HTTP tools for the traffic

24
00:01:43,439 --> 00:01:46,320
that my hedge system

25
00:01:46,320 --> 00:01:49,200
produced and I just scroll down to the

26
00:01:49,200 --> 00:01:51,840
oauth Token that was generated and you

27
00:01:51,840 --> 00:01:55,740
can see the password Grant type in the

28
00:01:55,740 --> 00:01:57,840
packet there

29
00:01:57,840 --> 00:02:00,540
another thing I'm going to prep for my

30
00:02:00,540 --> 00:02:02,939
next slide I'll go ahead and talk about

31
00:02:02,939 --> 00:02:07,619
it now you see a list of endpoints that

32
00:02:07,619 --> 00:02:10,500
were targeted for this product and each

33
00:02:10,500 --> 00:02:12,959
of these endpoints are

34
00:02:12,959 --> 00:02:16,020
branded of course I don't see American

35
00:02:16,020 --> 00:02:20,160
family as a name or hedge as a name

36
00:02:20,160 --> 00:02:23,280
instead when I look at what traffic was

37
00:02:23,280 --> 00:02:25,640
generated of Interest here are different

38
00:02:25,640 --> 00:02:28,620
sensors that are being pulled different

39
00:02:28,620 --> 00:02:30,420
interactions with the smart home it's

40
00:02:30,420 --> 00:02:33,480
all with the NEOS endpoint

41
00:02:33,480 --> 00:02:35,879
so at this point I'm concerned I thought

42
00:02:35,879 --> 00:02:38,280
I bought or received a product from

43
00:02:38,280 --> 00:02:40,440
American family but there's this

44
00:02:40,440 --> 00:02:44,099
endpoint of Neos that I am talking to

45
00:02:44,099 --> 00:02:45,900
so I did a Google search of what's going

46
00:02:45,900 --> 00:02:48,480
on here why is my American Family system

47
00:02:48,480 --> 00:02:52,140
talking to NEOS I see where

48
00:02:52,140 --> 00:02:54,540
in my Google search results that

49
00:02:54,540 --> 00:02:58,080
American family has partnered with a UK

50
00:02:58,080 --> 00:03:01,560
company called Neos so when I received

51
00:03:01,560 --> 00:03:04,739
this hedge branded product what I

52
00:03:04,739 --> 00:03:08,040
actually received was a product from the

53
00:03:08,040 --> 00:03:12,079
UK a company called Neos

54
00:03:12,239 --> 00:03:15,120
moving along to the third vendor and

55
00:03:15,120 --> 00:03:17,099
this is actually the big reveal so I

56
00:03:17,099 --> 00:03:19,200
kind of went with like the lowest

57
00:03:19,200 --> 00:03:21,599
findings to the most severe findings and

58
00:03:21,599 --> 00:03:24,120
this is the big to do for my

59
00:03:24,120 --> 00:03:26,700
presentation today

60
00:03:26,700 --> 00:03:29,700
Defender camera that's the third vendor

61
00:03:29,700 --> 00:03:35,480
they have no auth on an endpoint

62
00:03:35,879 --> 00:03:38,519
this is a endpoint that produces

63
00:03:38,519 --> 00:03:41,459
thumbnail images as a response so if I

64
00:03:41,459 --> 00:03:43,319
was to generate traffic which I hope to

65
00:03:43,319 --> 00:03:45,900
do if I have time here and

66
00:03:45,900 --> 00:03:48,780
capture that URL send it to anybody here

67
00:03:48,780 --> 00:03:51,659
you could click on the URL kick off in

68
00:03:51,659 --> 00:03:54,659
your browser and download the thumbnail

69
00:03:54,659 --> 00:03:57,840
direct to you without having my username

70
00:03:57,840 --> 00:04:00,420
or password no auth on the endpoint

71
00:04:00,420 --> 00:04:04,339
that's my big finding for today

72
00:04:04,440 --> 00:04:06,840
unfortunately that's not supposed to be

73
00:04:06,840 --> 00:04:07,680
the case

74
00:04:07,680 --> 00:04:09,180
Defender camera has pretty good

75
00:04:09,180 --> 00:04:11,220
documentation available and their

76
00:04:11,220 --> 00:04:15,720
documentation describes a token is

77
00:04:15,720 --> 00:04:17,820
authenticate all the sessions as you

78
00:04:17,820 --> 00:04:20,279
would expect so this is a diagram

79
00:04:20,279 --> 00:04:23,040
showing that in the center is where each

80
00:04:23,040 --> 00:04:25,080
of your interactions should start with a

81
00:04:25,080 --> 00:04:27,720
token and then from the right hand side

82
00:04:27,720 --> 00:04:29,580
there's all the endpoints you would

83
00:04:29,580 --> 00:04:31,800
expect for their camera system whether

84
00:04:31,800 --> 00:04:34,919
it's playing back real-time video or

85
00:04:34,919 --> 00:04:36,900
reviewing the archived

86
00:04:36,900 --> 00:04:39,540
alerts that they've stored

87
00:04:39,540 --> 00:04:43,259
so I will go into the

88
00:04:43,259 --> 00:04:47,160
mob SF once again and show the traffic

89
00:04:47,160 --> 00:04:50,419
that was generated for Defender camera

90
00:04:50,419 --> 00:04:55,020
and this is the interaction with the

91
00:04:55,020 --> 00:04:56,940
endpoint that doesn't have auth

92
00:04:56,940 --> 00:05:00,479
so while I'm here once again I want to

93
00:05:00,479 --> 00:05:03,180
highlight how there's a list of

94
00:05:03,180 --> 00:05:05,220
endpoints that this system is

95
00:05:05,220 --> 00:05:07,259
communicating with once again it was

96
00:05:07,259 --> 00:05:09,840
Defender camera that I purchased and

97
00:05:09,840 --> 00:05:13,259
installed I don't see Defender brand

98
00:05:13,259 --> 00:05:15,360
listed on any of these endpoints once

99
00:05:15,360 --> 00:05:18,360
again so I'm left wondering what are

100
00:05:18,360 --> 00:05:20,940
these endpoints that I'm sending my

101
00:05:20,940 --> 00:05:22,800
video footage to

102
00:05:22,800 --> 00:05:27,120
I see easy for ipcloud and imou

103
00:05:27,120 --> 00:05:28,639
so I Googled

104
00:05:28,639 --> 00:05:31,979
ez4ipcloud to see what that is

105
00:05:31,979 --> 00:05:34,860
and I find that there's yet another

106
00:05:34,860 --> 00:05:38,460
product yet another vendor involved this

107
00:05:38,460 --> 00:05:41,880
time it's dawa

108
00:05:41,880 --> 00:05:45,180
going back to my slides now

109
00:05:45,180 --> 00:05:47,280
I didn't see Defender so unlike in the

110
00:05:47,280 --> 00:05:48,720
American Family where I could clearly

111
00:05:48,720 --> 00:05:49,860
see that they had announced a

112
00:05:49,860 --> 00:05:52,560
partnership and had that arrangement in

113
00:05:52,560 --> 00:05:54,780
my Google search I didn't see that with

114
00:05:54,780 --> 00:05:56,520
this product so I'm still left wondering

115
00:05:56,520 --> 00:05:59,820
what is happening I did additional

116
00:05:59,820 --> 00:06:03,060
research on the imou dawa brand and I

117
00:06:03,060 --> 00:06:07,199
see in 2014 dawa launched a IMO you

118
00:06:07,199 --> 00:06:10,440
brand targeted at the US so this is what

119
00:06:10,440 --> 00:06:13,740
was their effort to bring their products

120
00:06:13,740 --> 00:06:16,699
to the U.S

121
00:06:17,639 --> 00:06:19,440
I'm still confused so I decided to go to

122
00:06:19,440 --> 00:06:22,280
chat GTP

123
00:06:22,380 --> 00:06:24,060
opular place to go to ask these

124
00:06:24,060 --> 00:06:26,160
questions right so I asked that chat bot

125
00:06:26,160 --> 00:06:28,560
please explain to me the corporate

126
00:06:28,560 --> 00:06:31,979
relationship of Defender camera in dawa

127
00:06:31,979 --> 00:06:35,340
chat GTP says Defender camera and dawa

128
00:06:35,340 --> 00:06:38,280
are both companies that specialize in

129
00:06:38,280 --> 00:06:40,139
the manufacturer and distribution of

130
00:06:40,139 --> 00:06:41,460
security cameras

131
00:06:41,460 --> 00:06:44,759
well done chat GTP I agree that's

132
00:06:44,759 --> 00:06:46,860
exactly what I expected

133
00:06:46,860 --> 00:06:49,319
however their corporate relationship is

134
00:06:49,319 --> 00:06:51,840
not one of direct ownership or

135
00:06:51,840 --> 00:06:55,020
partnership and I can't agree with that

136
00:06:55,020 --> 00:06:59,280
chat GTB I have the device in my house

137
00:06:59,280 --> 00:07:02,039
it's clearly labeled Defender camera

138
00:07:02,039 --> 00:07:04,800
from Canada they like to promote how

139
00:07:04,800 --> 00:07:06,539
they're a Canadian based company

140
00:07:06,539 --> 00:07:09,419
but everything I capture in my security

141
00:07:09,419 --> 00:07:12,120
research shows that it's a dawa product

142
00:07:12,120 --> 00:07:13,440
so there's got to be some kind of

143
00:07:13,440 --> 00:07:15,060
partnership relationship between these

144
00:07:15,060 --> 00:07:16,860
two

145
00:07:16,860 --> 00:07:21,120
why does dawa sound familiar so at the

146
00:07:21,120 --> 00:07:22,740
same time I was doing my security

147
00:07:22,740 --> 00:07:24,240
research

148
00:07:24,240 --> 00:07:26,280
there was news

149
00:07:26,280 --> 00:07:30,360
out and about of the FCC Banning

150
00:07:30,360 --> 00:07:33,979
Chinese surveillance cameras

151
00:07:34,080 --> 00:07:40,020
FCC says ZTE Yahweh hickvision dawa

152
00:07:40,020 --> 00:07:42,139
these brands

153
00:07:42,139 --> 00:07:45,539
are a unacceptable national security

154
00:07:45,539 --> 00:07:47,460
threat

155
00:07:47,460 --> 00:07:50,220
dawa has a response to the FCC

156
00:07:50,220 --> 00:07:53,099
statements if you go to dawa's website

157
00:07:53,099 --> 00:07:56,340
their statement in response is dawa's

158
00:07:56,340 --> 00:07:59,220
products all remain authorized at this

159
00:07:59,220 --> 00:08:02,039
time and therefore there is no liability

160
00:08:02,039 --> 00:08:06,599
for an integrator selling dawa products

161
00:08:06,599 --> 00:08:08,120
in the US

162
00:08:08,120 --> 00:08:10,740
integrators should not sell products for

163
00:08:10,740 --> 00:08:13,199
public safety security of government

164
00:08:13,199 --> 00:08:15,960
facilities physical surveillance of

165
00:08:15,960 --> 00:08:17,280
critical infrastructure or other

166
00:08:17,280 --> 00:08:19,560
national security purposes so the key

167
00:08:19,560 --> 00:08:23,759
for this content that I'm sharing is I'm

168
00:08:23,759 --> 00:08:26,039
left under the impression that Defender

169
00:08:26,039 --> 00:08:30,180
is an integrator of dawa products

170
00:08:30,180 --> 00:08:33,059
as a security professional I've had 20

171
00:08:33,059 --> 00:08:35,399
years in this industry I was not able to

172
00:08:35,399 --> 00:08:37,620
discern that before I bought this

173
00:08:37,620 --> 00:08:39,860
product

174
00:08:40,140 --> 00:08:43,580
a little concerning for me

175
00:08:44,039 --> 00:08:46,020
I'm going to move on to the responsible

176
00:08:46,020 --> 00:08:48,060
disclosure effort on my part I did send

177
00:08:48,060 --> 00:08:50,040
all these security findings to each of

178
00:08:50,040 --> 00:08:51,420
these vendors and I'm going to present

179
00:08:51,420 --> 00:08:53,100
their responses now

180
00:08:53,100 --> 00:08:56,279
Alfred camera says our most recent app

181
00:08:56,279 --> 00:08:58,380
version has enforced a more secure

182
00:08:58,380 --> 00:09:00,779
credential protection and optimized the

183
00:09:00,779 --> 00:09:02,760
permissions

184
00:09:02,760 --> 00:09:06,180
so let's go into mob SF

185
00:09:06,180 --> 00:09:11,820
mop SF is pretty handy in providing a

186
00:09:11,820 --> 00:09:13,620
diff or compare

187
00:09:13,620 --> 00:09:16,620
I have been watching Alfred camera to

188
00:09:16,620 --> 00:09:18,440
see exactly what they're changing

189
00:09:18,440 --> 00:09:21,600
fortunately this company is quite active

190
00:09:21,600 --> 00:09:24,240
in their development so kudos to them

191
00:09:24,240 --> 00:09:27,899
for producing revisions to their product

192
00:09:27,899 --> 00:09:31,200
I have each of those mobile app versions

193
00:09:31,200 --> 00:09:33,899
that have been reviewed in my tool here

194
00:09:33,899 --> 00:09:36,480
they offer a compare feature I'm just

195
00:09:36,480 --> 00:09:38,700
going to kick off the compare between

196
00:09:38,700 --> 00:09:41,399
the latest version and the first version

197
00:09:41,399 --> 00:09:44,279
during my testing mob SF kicks back this

198
00:09:44,279 --> 00:09:47,160
handy report and I can scroll down a

199
00:09:47,160 --> 00:09:50,100
little bit right here it tells me what's

200
00:09:50,100 --> 00:09:51,959
changed

201
00:09:51,959 --> 00:09:54,899
there has been zero changes from the

202
00:09:54,899 --> 00:09:56,700
first version I tested to the recent

203
00:09:56,700 --> 00:09:58,680
version

204
00:09:58,680 --> 00:10:00,779
additionally if I go back to the network

205
00:10:00,779 --> 00:10:04,260
traffic that I showed at first

206
00:10:04,260 --> 00:10:09,060
we see that the Legacy Google auth

207
00:10:09,060 --> 00:10:12,120
for this issue still exists they still

208
00:10:12,120 --> 00:10:13,860
generate that call out

209
00:10:13,860 --> 00:10:15,600
so

210
00:10:15,600 --> 00:10:18,300
I'm not sure what they changed

211
00:10:18,300 --> 00:10:20,339
um I did Android testing I have an

212
00:10:20,339 --> 00:10:22,260
Android device that's the operating

213
00:10:22,260 --> 00:10:24,959
system that I'm interested in maybe they

214
00:10:24,959 --> 00:10:26,760
made a bunch of changes on the iPhone

215
00:10:26,760 --> 00:10:28,680
version they do have an iPhone version

216
00:10:28,680 --> 00:10:30,899
so if you have that version of the

217
00:10:30,899 --> 00:10:33,180
product maybe it's been hardened I did

218
00:10:33,180 --> 00:10:35,480
not test it so I can't say

219
00:10:35,480 --> 00:10:39,240
moving on to hedge or Neos

220
00:10:39,240 --> 00:10:42,240
they have a bug Bounty program on hacker

221
00:10:42,240 --> 00:10:44,760
one with 1000 active researchers and

222
00:10:44,760 --> 00:10:46,980
they can assure me they have tested the

223
00:10:46,980 --> 00:10:48,420
scenario

224
00:10:48,420 --> 00:10:50,940
I believe that they are active on hacker

225
00:10:50,940 --> 00:10:52,500
one

226
00:10:52,500 --> 00:10:55,019
I'm convinced so I'm gonna switch hats

227
00:10:55,019 --> 00:10:58,500
I'm gonna put on my Enterprise hat and

228
00:10:58,500 --> 00:11:02,519
think of a security architect

229
00:11:02,519 --> 00:11:05,220
on the infosec team we get a large stack

230
00:11:05,220 --> 00:11:09,000
of to do for our team and we can't do it

231
00:11:09,000 --> 00:11:11,820
all we have to prioritize each of those

232
00:11:11,820 --> 00:11:14,100
efforts for the team focusing on what is

233
00:11:14,100 --> 00:11:16,019
the highest risk

234
00:11:16,019 --> 00:11:18,240
if they have an active hacker one

235
00:11:18,240 --> 00:11:20,519
Community sending them zero days and all

236
00:11:20,519 --> 00:11:23,640
kinds of severe findings maybe my

237
00:11:23,640 --> 00:11:27,060
finding was like a lower risk

238
00:11:27,060 --> 00:11:29,660
perhaps

239
00:11:30,899 --> 00:11:33,480
moving on to the third vendor this is

240
00:11:33,480 --> 00:11:35,040
Defender camera this is the one that had

241
00:11:35,040 --> 00:11:37,380
no auth on their endpoint I'm really

242
00:11:37,380 --> 00:11:39,420
invested in hearing from them I'd like

243
00:11:39,420 --> 00:11:43,560
to see them have a response for my issue

244
00:11:43,560 --> 00:11:46,140
I used every Avenue to communicate with

245
00:11:46,140 --> 00:11:47,220
the company

246
00:11:47,220 --> 00:11:49,500
one of the options available on their

247
00:11:49,500 --> 00:11:52,620
website is their chat interface so I

248
00:11:52,620 --> 00:11:54,720
kicked off the chat interface and I

249
00:11:54,720 --> 00:11:55,620
asked the customer support

250
00:11:55,620 --> 00:11:58,800
representative how can I share my

251
00:11:58,800 --> 00:12:00,899
security research with you and get it to

252
00:12:00,899 --> 00:12:02,279
the right person

253
00:12:02,279 --> 00:12:04,140
they stated

254
00:12:04,140 --> 00:12:07,740
we do not have an infosec

255
00:12:07,740 --> 00:12:10,279
Department

256
00:12:12,000 --> 00:12:14,459
I didn't leave it at that I'm going to

257
00:12:14,459 --> 00:12:17,160
keep on these people to try to get some

258
00:12:17,160 --> 00:12:18,720
kind of response

259
00:12:18,720 --> 00:12:21,899
I went to osin efforts for this company

260
00:12:21,899 --> 00:12:25,620
and I tracked down a live person at

261
00:12:25,620 --> 00:12:27,000
their corporate headquarters

262
00:12:27,000 --> 00:12:29,779
called them up had a direct phone call

263
00:12:29,779 --> 00:12:33,360
with one of their employees

264
00:12:33,360 --> 00:12:36,300
their statement over the phone was all

265
00:12:36,300 --> 00:12:38,339
of our emails do get sent to the

266
00:12:38,339 --> 00:12:40,860
appropriate department so

267
00:12:40,860 --> 00:12:43,139
reading between the lines in all my

268
00:12:43,139 --> 00:12:45,120
interactions with this company and

269
00:12:45,120 --> 00:12:47,940
considering what I discovered on the

270
00:12:47,940 --> 00:12:49,800
ocean efforts

271
00:12:49,800 --> 00:12:52,620
there's only 30 people who show up at

272
00:12:52,620 --> 00:12:53,519
their corporate headquarters

273
00:12:53,519 --> 00:12:55,620
approximately 30.

274
00:12:55,620 --> 00:12:57,540
it's a small group

275
00:12:57,540 --> 00:13:00,000
I'm asking a lot maybe that they have

276
00:13:00,000 --> 00:13:02,220
security

277
00:13:02,220 --> 00:13:05,940
aware security informed staff to be able

278
00:13:05,940 --> 00:13:07,380
to work with

279
00:13:07,380 --> 00:13:09,899
unfortunately that's where I'm left with

280
00:13:09,899 --> 00:13:12,480
on Defender camera

281
00:13:12,480 --> 00:13:15,180
on to the recommendations

282
00:13:15,180 --> 00:13:17,339
for blue team recommendations I always

283
00:13:17,339 --> 00:13:19,920
like to encourage owasp this is

284
00:13:19,920 --> 00:13:21,779
specifically like developing a mobile

285
00:13:21,779 --> 00:13:23,639
app if you want to harden that and

286
00:13:23,639 --> 00:13:25,740
protect it from attacks follow the

287
00:13:25,740 --> 00:13:29,399
mobile app top 10. and of course what

288
00:13:29,399 --> 00:13:31,800
I've done a lot of reviews on in this

289
00:13:31,800 --> 00:13:34,680
presentation is API interactions so

290
00:13:34,680 --> 00:13:38,279
there's an API top 10 as well

291
00:13:38,279 --> 00:13:40,380
the issues that I discovered a lot of

292
00:13:40,380 --> 00:13:43,200
them are authentication issues if you

293
00:13:43,200 --> 00:13:45,740
follow the news there are authentication

294
00:13:45,740 --> 00:13:49,500
issues being announced as breaches

295
00:13:49,500 --> 00:13:52,740
throughout the news today so

296
00:13:52,740 --> 00:13:54,779
if you're going to harden your

297
00:13:54,779 --> 00:13:56,519
environment against authentication

298
00:13:56,519 --> 00:13:59,459
issues I would suggest the gold standard

299
00:13:59,459 --> 00:14:02,579
Fido is the best option that you could

300
00:14:02,579 --> 00:14:05,639
engage with for authentication today

301
00:14:05,639 --> 00:14:07,980
so if you follow this link you'll see my

302
00:14:07,980 --> 00:14:12,180
recommendation for fixing auth issues

303
00:14:12,180 --> 00:14:15,000
in line with auth issues is an API

304
00:14:15,000 --> 00:14:16,019
Gateway

305
00:14:16,019 --> 00:14:18,300
if you were to utilize an APA Gateway

306
00:14:18,300 --> 00:14:20,339
product for all your API endpoints

307
00:14:20,339 --> 00:14:23,339
that'll ensure consistency on those

308
00:14:23,339 --> 00:14:27,180
endpoints so like I saw with no auth

309
00:14:27,180 --> 00:14:30,360
this kind of approach to hardening an

310
00:14:30,360 --> 00:14:31,860
environment will ensure that you have

311
00:14:31,860 --> 00:14:34,620
authentication authorization on each of

312
00:14:34,620 --> 00:14:36,240
those interactions

313
00:14:36,240 --> 00:14:39,360
and then in front of an API Gateway a

314
00:14:39,360 --> 00:14:42,420
WAAF it'll drop off all the low level

315
00:14:42,420 --> 00:14:44,339
attacks and noise that we get on the

316
00:14:44,339 --> 00:14:44,530
internet

317
00:14:44,530 --> 00:14:46,320
[Music]

318
00:14:46,320 --> 00:14:48,120
red team recommendations

319
00:14:48,120 --> 00:14:49,620
at this point I need to put out the

320
00:14:49,620 --> 00:14:50,699
disclaimer

321
00:14:50,699 --> 00:14:52,380
get permission

322
00:14:52,380 --> 00:14:54,600
in writing authorization to do your

323
00:14:54,600 --> 00:14:55,680
testing

324
00:14:55,680 --> 00:15:00,360
I did only my systems only my data if

325
00:15:00,360 --> 00:15:02,579
you want to enumerate to other people's

326
00:15:02,579 --> 00:15:04,920
content you need permission to do that

327
00:15:04,920 --> 00:15:06,360
type of a test

328
00:15:06,360 --> 00:15:08,940
buzzing is the best way to do the

329
00:15:08,940 --> 00:15:10,920
enumeration and burp is the gold

330
00:15:10,920 --> 00:15:13,139
standard to do that type of testing

331
00:15:13,139 --> 00:15:16,920
however if I go back to mob SF HTTP

332
00:15:16,920 --> 00:15:19,260
tools that we've been in we have send to

333
00:15:19,260 --> 00:15:23,180
fuzzer right here as an option

334
00:15:25,260 --> 00:15:27,300
as we saw with the Google authentication

335
00:15:27,300 --> 00:15:30,779
endpoint there are Legacy API endpoints

336
00:15:30,779 --> 00:15:34,139
as a red team effort you can Target the

337
00:15:34,139 --> 00:15:36,839
older Legacy endpoints a lot of times

338
00:15:36,839 --> 00:15:40,860
that's just like V3 V2 in the URL just

339
00:15:40,860 --> 00:15:42,600
drop it down a value and see if you get

340
00:15:42,600 --> 00:15:44,880
a response a lot of times those older

341
00:15:44,880 --> 00:15:48,920
endpoints were deprecated for a reason

342
00:15:49,139 --> 00:15:53,040
additionally if you populate your API

343
00:15:53,040 --> 00:15:55,260
calls into Postman it's really easy to

344
00:15:55,260 --> 00:15:57,000
drop off the authentication and send

345
00:15:57,000 --> 00:15:59,459
that out as a response if you get a

346
00:15:59,459 --> 00:16:01,860
response that means no auth that's why

347
00:16:01,860 --> 00:16:03,899
what I did for Defender

348
00:16:03,899 --> 00:16:06,300
you can also fudge the access token

349
00:16:06,300 --> 00:16:09,000
values and see if it still works that

350
00:16:09,000 --> 00:16:10,320
would mean that they're not actually

351
00:16:10,320 --> 00:16:11,880
validating the token they're just

352
00:16:11,880 --> 00:16:15,240
checking for the presence of the token

353
00:16:15,240 --> 00:16:18,480
an issue we see in some apis today is

354
00:16:18,480 --> 00:16:20,339
excessive data

355
00:16:20,339 --> 00:16:22,440
if you watch your network traffic and

356
00:16:22,440 --> 00:16:24,540
see a massive amount of traffic returned

357
00:16:24,540 --> 00:16:26,160
in an API call

358
00:16:26,160 --> 00:16:28,019
they're probably not needing all that

359
00:16:28,019 --> 00:16:30,540
traffic it's just shoving way too much

360
00:16:30,540 --> 00:16:32,639
in the response and you can go through

361
00:16:32,639 --> 00:16:34,380
and see what surprises are in that

362
00:16:34,380 --> 00:16:37,620
excessive data returned

363
00:16:37,620 --> 00:16:40,699
XML there's a lot of XML vulnerabilities

364
00:16:40,699 --> 00:16:44,519
if you switch your content hype header

365
00:16:44,519 --> 00:16:47,880
from application Json most of what we

366
00:16:47,880 --> 00:16:50,100
see today is application Json in this

367
00:16:50,100 --> 00:16:52,620
editor switch it to XML

368
00:16:52,620 --> 00:16:55,139
if everything still works you've

369
00:16:55,139 --> 00:16:58,380
unlocked the ability to launch the XML

370
00:16:58,380 --> 00:16:59,730
attacks

371
00:16:59,730 --> 00:17:01,199
[Music]

372
00:17:01,199 --> 00:17:04,260
smart home recommendation I had three

373
00:17:04,260 --> 00:17:06,359
Smart Home Products in my house

374
00:17:06,359 --> 00:17:09,179
I was disappointed with all three

375
00:17:09,179 --> 00:17:11,040
I'm not going to have a real good

376
00:17:11,040 --> 00:17:13,980
recommendation here reconsider maybe uh

377
00:17:13,980 --> 00:17:15,839
take that smart home equipment you have

378
00:17:15,839 --> 00:17:17,939
and like shove it in a corner that you

379
00:17:17,939 --> 00:17:20,099
never go to

380
00:17:20,099 --> 00:17:21,900
definitely don't have it in like the

381
00:17:21,900 --> 00:17:24,839
populated place popular discussion area

382
00:17:24,839 --> 00:17:28,319
of your home I would not do that

383
00:17:28,319 --> 00:17:31,380
and I want to highlight your home Wi-Fi

384
00:17:31,380 --> 00:17:33,660
changing changes a lot of people like to

385
00:17:33,660 --> 00:17:36,660
recommend that you adjust your

386
00:17:36,660 --> 00:17:40,260
SSID settings create a guest SSID that's

387
00:17:40,260 --> 00:17:42,900
all fine it's not a silver bullet

388
00:17:42,900 --> 00:17:44,760
it's not going to resolve the findings

389
00:17:44,760 --> 00:17:47,460
I'm discussing today

390
00:17:47,460 --> 00:17:50,640
what would work is looking at your DNS

391
00:17:50,640 --> 00:17:52,919
logs

392
00:17:52,919 --> 00:17:56,400
I have 20 000 entries in my DNS log

393
00:17:56,400 --> 00:17:59,580
every day at my house

394
00:17:59,580 --> 00:18:03,918
have fun looking through that

395
00:18:04,380 --> 00:18:07,020
a more realistic recommendation is the

396
00:18:07,020 --> 00:18:08,940
Mozilla Foundation they have a website

397
00:18:08,940 --> 00:18:11,640
privacy not included it's really easy to

398
00:18:11,640 --> 00:18:14,039
see either thumbs up on products or

399
00:18:14,039 --> 00:18:16,380
thumbs down on products unfortunately

400
00:18:16,380 --> 00:18:19,080
it's not extensive I do recommend that

401
00:18:19,080 --> 00:18:20,640
for like friends and family it's an easy

402
00:18:20,640 --> 00:18:23,520
way to get some advice I wish that they

403
00:18:23,520 --> 00:18:25,440
would populate it a bit more so that

404
00:18:25,440 --> 00:18:26,160
it's

405
00:18:26,160 --> 00:18:28,980
exclusive of all the products but

406
00:18:28,980 --> 00:18:32,400
it's my go-to for now resources this is

407
00:18:32,400 --> 00:18:34,440
all the resources that I have enjoy

408
00:18:34,440 --> 00:18:37,260
everybody can read that right

409
00:18:37,260 --> 00:18:39,840
okay how about this instead I've put

410
00:18:39,840 --> 00:18:42,780
this on a GitHub so feel free to visit

411
00:18:42,780 --> 00:18:45,179
my GitHub and I'll be able to update

412
00:18:45,179 --> 00:18:48,020
content and make improvements on that

413
00:18:48,020 --> 00:18:50,340
[Music]

414
00:18:50,340 --> 00:18:52,799
okay we have plenty of time I did well

415
00:18:52,799 --> 00:18:55,980
so at this time I am going to go into

416
00:18:55,980 --> 00:18:59,179
the lab and kick the tires on each of

417
00:18:59,179 --> 00:19:02,700
the tools that I suggested so starting

418
00:19:02,700 --> 00:19:05,100
with mob SF

419
00:19:05,100 --> 00:19:07,679
like I say this is the landing page that

420
00:19:07,679 --> 00:19:09,000
you'll see when you first get it up and

421
00:19:09,000 --> 00:19:12,780
running and it'll kick off a static scan

422
00:19:12,780 --> 00:19:16,140
I have done that for multiple

423
00:19:16,140 --> 00:19:18,900
applications already so I can show any

424
00:19:18,900 --> 00:19:21,780
of these static reports

425
00:19:21,780 --> 00:19:24,720
and you'll be able to see how it quickly

426
00:19:24,720 --> 00:19:27,419
gives you a score so if you're new to

427
00:19:27,419 --> 00:19:29,520
this process like I was this is pretty

428
00:19:29,520 --> 00:19:33,419
intuitive to get started and if you

429
00:19:33,419 --> 00:19:34,799
scroll down you'll see some like the

430
00:19:34,799 --> 00:19:38,360
permission stuff that I commented on so

431
00:19:38,360 --> 00:19:43,039
has response right away for you to start

432
00:19:43,039 --> 00:19:45,480
researching your different products it

433
00:19:45,480 --> 00:19:47,940
has malware analysis so if you have any

434
00:19:47,940 --> 00:19:50,280
malware that's tied to mobile apps it'll

435
00:19:50,280 --> 00:19:52,140
highlight that it has some of the

436
00:19:52,140 --> 00:19:54,539
resources that identified in in the app

437
00:19:54,539 --> 00:19:56,700
so URLs database

438
00:19:56,700 --> 00:19:58,799
strings hard-coded secrets that's all

439
00:19:58,799 --> 00:20:03,299
listed on Mob SF in your first scan

440
00:20:03,299 --> 00:20:06,240
it is a bit of a step one step two you

441
00:20:06,240 --> 00:20:08,340
want to do a static scan on anything

442
00:20:08,340 --> 00:20:11,039
that you're testing because the next

443
00:20:11,039 --> 00:20:13,980
step is the dynamic analyzer

444
00:20:13,980 --> 00:20:15,720
the only

445
00:20:15,720 --> 00:20:17,880
results that you'll see in here to start

446
00:20:17,880 --> 00:20:19,799
a dynamic scan against are going to be

447
00:20:19,799 --> 00:20:21,360
those that you've ran a stack scan

448
00:20:21,360 --> 00:20:24,600
against so step one step two

449
00:20:24,600 --> 00:20:28,140
to run your first Dynamic scan you need

450
00:20:28,140 --> 00:20:30,960
ginymotion up and running so as I stated

451
00:20:30,960 --> 00:20:34,020
have that installed and

452
00:20:34,020 --> 00:20:37,679
launch your first virtual device if you

453
00:20:37,679 --> 00:20:40,740
follow the steps that I ran through at

454
00:20:40,740 --> 00:20:42,179
the beginning you'll see that I

455
00:20:42,179 --> 00:20:45,059
recommended pixel 3 as the device you

456
00:20:45,059 --> 00:20:47,340
install so you just choose the pixel 3

457
00:20:47,340 --> 00:20:49,919
and hit next next that's going to boot

458
00:20:49,919 --> 00:20:51,900
up a

459
00:20:51,900 --> 00:20:55,799
Android virtual machine so this is the

460
00:20:55,799 --> 00:20:58,799
pixel 3 already booted up I've done a

461
00:20:58,799 --> 00:21:01,080
little bit of hand waving because

462
00:21:01,080 --> 00:21:04,559
a lot of this turns on processing to get

463
00:21:04,559 --> 00:21:06,780
something installed and running so I'm

464
00:21:06,780 --> 00:21:08,640
speeding it up for us

465
00:21:08,640 --> 00:21:11,520
this is responsive just like any Android

466
00:21:11,520 --> 00:21:14,400
OS that you've worked with so now that

467
00:21:14,400 --> 00:21:17,520
that's running and ready I can go back

468
00:21:17,520 --> 00:21:21,780
to mob SF and choose the mobasify that's

469
00:21:21,780 --> 00:21:25,080
going to install Frida and prepare your

470
00:21:25,080 --> 00:21:26,520
virtual machine for your security

471
00:21:26,520 --> 00:21:28,440
testing

472
00:21:28,440 --> 00:21:30,840
and then

473
00:21:30,840 --> 00:21:34,440
once that's done it'll be in the dynamic

474
00:21:34,440 --> 00:21:36,419
scan section so this is what it looks

475
00:21:36,419 --> 00:21:38,539
like when you're in the dynamic scanner

476
00:21:38,539 --> 00:21:42,299
you start instrumentation so I'm going

477
00:21:42,299 --> 00:21:45,600
to kick this off it does take a while to

478
00:21:45,600 --> 00:21:47,520
make these things happen so this is my

479
00:21:47,520 --> 00:21:48,380
mod

480
00:21:48,380 --> 00:21:51,720
mob SF service that's running you can

481
00:21:51,720 --> 00:21:55,740
watch it doing its preparation for the

482
00:21:55,740 --> 00:21:58,440
testing when it's done it's going to

483
00:21:58,440 --> 00:22:00,780
start up

484
00:22:00,780 --> 00:22:01,980
that

485
00:22:01,980 --> 00:22:05,880
so this is the process of mob SF running

486
00:22:05,880 --> 00:22:09,120
Dynamic scans it has launched the app

487
00:22:09,120 --> 00:22:12,539
for me this is my live live camera feed

488
00:22:12,539 --> 00:22:14,520
that I have set up for this

489
00:22:14,520 --> 00:22:17,520
demonstration

490
00:22:18,360 --> 00:22:21,299
it is processing a bit

491
00:22:21,299 --> 00:22:24,179
I'm going to go to a few other

492
00:22:24,179 --> 00:22:26,840
tools while it's churning

493
00:22:26,840 --> 00:22:29,580
jadx is one of the other tools that I

494
00:22:29,580 --> 00:22:30,919
recommended this is once again

495
00:22:30,919 --> 00:22:34,860
decompiling a mobile app it has a simple

496
00:22:34,860 --> 00:22:37,620
GUI so you just come in and open files

497
00:22:37,620 --> 00:22:40,440
find your

498
00:22:40,440 --> 00:22:42,299
mobile app that you want to do testing

499
00:22:42,299 --> 00:22:45,120
for and it'll kick out the code I've

500
00:22:45,120 --> 00:22:49,799
already located a file of Interest this

501
00:22:49,799 --> 00:22:54,179
is the defender mobile app and

502
00:22:54,179 --> 00:22:57,539
I've already discovered some interesting

503
00:22:57,539 --> 00:23:00,000
values that

504
00:23:00,000 --> 00:23:03,360
Defender has added into their code so I

505
00:23:03,360 --> 00:23:05,460
don't know if this is readable but

506
00:23:05,460 --> 00:23:06,960
there's a word in there I was not

507
00:23:06,960 --> 00:23:10,760
familiar with so I Googled that

508
00:23:10,799 --> 00:23:14,640
and it is a

509
00:23:14,640 --> 00:23:17,760
slang for their culture

510
00:23:17,760 --> 00:23:20,039
so I didn't know that before I started

511
00:23:20,039 --> 00:23:20,940
this testing I wanted something

512
00:23:20,940 --> 00:23:25,020
additionally I have a unique character

513
00:23:25,020 --> 00:23:26,940
here that I didn't know what it said so

514
00:23:26,940 --> 00:23:29,580
I Googled that as well

515
00:23:29,580 --> 00:23:31,200
Nihao

516
00:23:31,200 --> 00:23:34,140
I see what you did there

517
00:23:34,140 --> 00:23:37,380
so that's jadx it'll help you

518
00:23:37,380 --> 00:23:39,539
um parse what the developers are doing

519
00:23:39,539 --> 00:23:41,760
can find some of their techniques and

520
00:23:41,760 --> 00:23:45,059
Trends and their style of coding this

521
00:23:45,059 --> 00:23:47,340
specific file that I'm highlighting here

522
00:23:47,340 --> 00:23:50,220
does demonstrate how

523
00:23:50,220 --> 00:23:53,760
the defender camera creates an

524
00:23:53,760 --> 00:23:55,620
authentication token

525
00:23:55,620 --> 00:23:58,320
the authentication token for Defender

526
00:23:58,320 --> 00:24:01,020
camera is not oauth that region of the

527
00:24:01,020 --> 00:24:03,419
world doesn't use some of the same

528
00:24:03,419 --> 00:24:06,120
standards and processes that we use so

529
00:24:06,120 --> 00:24:07,860
it is

530
00:24:07,860 --> 00:24:09,559
access Keys

531
00:24:09,559 --> 00:24:13,980
aksk that's the authentication of choice

532
00:24:13,980 --> 00:24:17,120
for that region

533
00:24:17,460 --> 00:24:20,760
additionally you'll see different

534
00:24:20,760 --> 00:24:22,320
ciphers

535
00:24:22,320 --> 00:24:25,860
than normal so if you were to follow in

536
00:24:25,860 --> 00:24:28,140
my footsteps with Defender there's a bit

537
00:24:28,140 --> 00:24:29,100
of a

538
00:24:29,100 --> 00:24:32,280
learning curve and deciphering the

539
00:24:32,280 --> 00:24:35,580
authentication and ciphers that they use

540
00:24:35,580 --> 00:24:38,520
but for what I'm showing of The Defender

541
00:24:38,520 --> 00:24:40,020
app

542
00:24:40,020 --> 00:24:42,600
they do have their username and their

543
00:24:42,600 --> 00:24:44,280
method of

544
00:24:44,280 --> 00:24:47,159
encrypting their token so if somebody

545
00:24:47,159 --> 00:24:49,980
wanted to try to enumerate to different

546
00:24:49,980 --> 00:24:53,159
users you could follow this code to

547
00:24:53,159 --> 00:24:56,760
create a token that would work for

548
00:24:56,760 --> 00:24:58,559
a username that you might be able to

549
00:24:58,559 --> 00:24:59,820
guess

550
00:24:59,820 --> 00:25:03,600
so going back to

551
00:25:03,600 --> 00:25:06,900
oh my mob SF

552
00:25:06,900 --> 00:25:08,460
environment

553
00:25:08,460 --> 00:25:12,480
we can see if it is more responsive now

554
00:25:12,480 --> 00:25:15,120
still churning I don't know oh it says

555
00:25:15,120 --> 00:25:17,700
no internet no

556
00:25:17,700 --> 00:25:19,020
should have tested that a little bit

557
00:25:19,020 --> 00:25:21,960
more I guess so it doesn't seem like

558
00:25:21,960 --> 00:25:24,659
it's going to be something I can

559
00:25:24,659 --> 00:25:28,260
demonstrate the full extent of today

560
00:25:28,260 --> 00:25:31,679
I do want to describe a little bit the

561
00:25:31,679 --> 00:25:34,980
process of testing for dynamic

562
00:25:34,980 --> 00:25:38,400
in mob SF you want to click through all

563
00:25:38,400 --> 00:25:41,100
the features of the mobile app so what

564
00:25:41,100 --> 00:25:43,679
you're doing is generating each of the

565
00:25:43,679 --> 00:25:47,520
API calls that the product uses so

566
00:25:47,520 --> 00:25:50,159
whether it's the change password feature

567
00:25:50,159 --> 00:25:53,039
within the app or

568
00:25:53,039 --> 00:25:55,020
reviewing events that have happened

569
00:25:55,020 --> 00:25:57,659
historically you want to navigate each

570
00:25:57,659 --> 00:26:00,900
of those options because behind the

571
00:26:00,900 --> 00:26:04,860
scenes mob SF is capturing what it sees

572
00:26:04,860 --> 00:26:06,840
of Interest so once you've done that

573
00:26:06,840 --> 00:26:08,700
full process which clearly I wasn't able

574
00:26:08,700 --> 00:26:10,740
to do during this demonstration but once

575
00:26:10,740 --> 00:26:13,200
you do you can come back and choose the

576
00:26:13,200 --> 00:26:15,539
generate report that's the key process

577
00:26:15,539 --> 00:26:18,720
in Dynamic testing so at this point it

578
00:26:18,720 --> 00:26:20,700
is going to start churning again I'll go

579
00:26:20,700 --> 00:26:23,159
back to the service where it shows us

580
00:26:23,159 --> 00:26:26,100
the output of the log and it's going to

581
00:26:26,100 --> 00:26:27,360
take a while on that I'm going to move

582
00:26:27,360 --> 00:26:30,240
on to yet another

583
00:26:30,240 --> 00:26:33,240
tool that I use for testing this is my

584
00:26:33,240 --> 00:26:35,460
Postman efforts so in here I've

585
00:26:35,460 --> 00:26:37,620
populated each of the API calls that I

586
00:26:37,620 --> 00:26:40,620
used in my testing and from here I was

587
00:26:40,620 --> 00:26:44,100
able to modify each of the values

588
00:26:44,100 --> 00:26:46,440
whether it was headers or parameters or

589
00:26:46,440 --> 00:26:51,120
the body and try like no auth so if I

590
00:26:51,120 --> 00:26:54,000
come to one that does have auth maybe so

591
00:26:54,000 --> 00:26:56,340
you just go to the auth tab and delete

592
00:26:56,340 --> 00:26:58,320
that token

593
00:26:58,320 --> 00:27:01,260
set it to nothing

594
00:27:01,260 --> 00:27:03,179
and give it a go

595
00:27:03,179 --> 00:27:05,279
that would be the process of using

596
00:27:05,279 --> 00:27:08,460
Postman you want to have it working and

597
00:27:08,460 --> 00:27:10,679
then start to make changes and revisions

598
00:27:10,679 --> 00:27:13,020
and see if you've broke it in an

599
00:27:13,020 --> 00:27:15,679
interesting way

600
00:27:16,200 --> 00:27:19,140
so going back to

601
00:27:19,140 --> 00:27:22,620
my mob SF report yep so I waited long

602
00:27:22,620 --> 00:27:25,080
enough for it to churn to build out this

603
00:27:25,080 --> 00:27:27,480
is this report so I showed earlier the

604
00:27:27,480 --> 00:27:30,120
static report and all the values and

605
00:27:30,120 --> 00:27:32,400
content that it would provide once again

606
00:27:32,400 --> 00:27:35,580
here's the HTTP tools that I spent most

607
00:27:35,580 --> 00:27:36,720
of my time

608
00:27:36,720 --> 00:27:39,000
wait

609
00:27:39,000 --> 00:27:41,580
um demonstrating today there's also

610
00:27:41,580 --> 00:27:44,520
application data this is a useful option

611
00:27:44,520 --> 00:27:47,100
within mob SF if you click through to

612
00:27:47,100 --> 00:27:51,179
this it'll download a complete Archive

613
00:27:51,179 --> 00:27:54,000
of the content whether it's cache

614
00:27:54,000 --> 00:27:55,980
content or

615
00:27:55,980 --> 00:27:59,120
database files that it found of interest

616
00:27:59,120 --> 00:28:01,260
you could

617
00:28:01,260 --> 00:28:05,580
install a database tool to inspect the

618
00:28:05,580 --> 00:28:07,620
content do queries against what they've

619
00:28:07,620 --> 00:28:11,940
populated so these to the start HTTP

620
00:28:11,940 --> 00:28:14,460
tools and application data both of those

621
00:28:14,460 --> 00:28:16,980
are useful

622
00:28:16,980 --> 00:28:19,020
additional steps that you can take on

623
00:28:19,020 --> 00:28:22,740
Mob SF to find the security flaws that

624
00:28:22,740 --> 00:28:24,419
you're hunting

625
00:28:24,419 --> 00:28:28,200
so at this point I think I will move to

626
00:28:28,200 --> 00:28:31,200
the free stuff so I do want to

627
00:28:31,200 --> 00:28:33,659
give away everything I've brought

628
00:28:33,659 --> 00:28:37,020
no for those in in person today I have a

629
00:28:37,020 --> 00:28:38,580
bunch of stickers I don't want to bring

630
00:28:38,580 --> 00:28:42,000
any back with me so take them all I also

631
00:28:42,000 --> 00:28:45,600
have Bitcoin why not Bitcoin so it's

632
00:28:45,600 --> 00:28:48,179
just a gimmick's not candy there isn't

633
00:28:48,179 --> 00:28:49,740
chocolate in there I'm gonna put these

634
00:28:49,740 --> 00:28:51,539
up front and feel free to come and get

635
00:28:51,539 --> 00:28:53,658
them

636
00:28:54,419 --> 00:28:56,220
oh

637
00:28:56,220 --> 00:28:59,840
lost my Bitcoin

638
00:29:01,620 --> 00:29:04,740
okay and we will take questions does

639
00:29:04,740 --> 00:29:07,020
anybody have questions for me sure go

640
00:29:07,020 --> 00:29:07,679
ahead

641
00:29:07,679 --> 00:29:09,900
so I'm curious first off thank you very

642
00:29:09,900 --> 00:29:11,700
much for what you do I think uh this

643
00:29:11,700 --> 00:29:13,440
security analysis is incredibly

644
00:29:13,440 --> 00:29:14,640
important

645
00:29:14,640 --> 00:29:18,179
um I'm curious uh this is obviously from

646
00:29:18,179 --> 00:29:20,039
a very technical analyzing the data

647
00:29:20,039 --> 00:29:22,140
that's flowing over there do you know of

648
00:29:22,140 --> 00:29:24,299
studies that are being done on once the

649
00:29:24,299 --> 00:29:27,659
data gets to whatever the authorized

650
00:29:27,659 --> 00:29:30,480
partner is for the data where that data

651
00:29:30,480 --> 00:29:32,580
is going from there like like

652
00:29:32,580 --> 00:29:34,440
who we detect who they're sharing that

653
00:29:34,440 --> 00:29:37,080
data with what what other partners they

654
00:29:37,080 --> 00:29:39,179
have that are getting

655
00:29:39,179 --> 00:29:42,419
that is the topic of interest for me

656
00:29:42,419 --> 00:29:45,659
um I saw in my testing

657
00:29:45,659 --> 00:29:47,640
multiple

658
00:29:47,640 --> 00:29:49,260
Partnerships

659
00:29:49,260 --> 00:29:52,320
that I didn't anticipate so I am

660
00:29:52,320 --> 00:29:55,140
confident that

661
00:29:55,140 --> 00:29:57,419
the interesting

662
00:29:57,419 --> 00:30:01,320
pictures images audio sensor content

663
00:30:01,320 --> 00:30:04,320
that I'm generating at my house is going

664
00:30:04,320 --> 00:30:06,419
elsewhere

665
00:30:06,419 --> 00:30:10,100
I don't have a good answer on tracking

666
00:30:10,100 --> 00:30:13,200
where all it goes I would love to see

667
00:30:13,200 --> 00:30:14,480
efforts

668
00:30:14,480 --> 00:30:18,059
exposing what is occurring specifically

669
00:30:18,059 --> 00:30:20,399
for consumers

670
00:30:20,399 --> 00:30:22,860
um I feel like as we bring these

671
00:30:22,860 --> 00:30:24,840
products into our house we're losing

672
00:30:24,840 --> 00:30:27,600
control of some of what we're generating

673
00:30:27,600 --> 00:30:31,140
what I expect is mine specifically if I

674
00:30:31,140 --> 00:30:34,260
had a camera inside my house

675
00:30:34,260 --> 00:30:36,000
I feel like that's very personal content

676
00:30:36,000 --> 00:30:38,039
and I'm not comfortable

677
00:30:38,039 --> 00:30:40,080
if there's an agreement that I'm not

678
00:30:40,080 --> 00:30:42,240
aware of to share that elsewhere

679
00:30:42,240 --> 00:30:45,360
so I definitely agree it's a worthwhile

680
00:30:45,360 --> 00:30:49,919
Pursuit I did not undertake it so

681
00:30:49,919 --> 00:30:52,380
maybe somebody else here feel free to

682
00:30:52,380 --> 00:30:54,659
pull apart what I've presented if there

683
00:30:54,659 --> 00:30:58,440
are issues flaws I'm not a glass Cannon

684
00:30:58,440 --> 00:31:00,320
I'm not going to fall apart if somebody

685
00:31:00,320 --> 00:31:03,360
points out failures that I made so if

686
00:31:03,360 --> 00:31:04,799
anybody has a better response to this

687
00:31:04,799 --> 00:31:07,500
question or wants to

688
00:31:07,500 --> 00:31:09,659
harass what I've presented today feel

689
00:31:09,659 --> 00:31:11,840
free

690
00:31:12,240 --> 00:31:14,100
oh go ahead

691
00:31:14,100 --> 00:31:17,059
shout out

692
00:31:18,419 --> 00:31:20,220
hello there we go

693
00:31:20,220 --> 00:31:22,080
hey thank you for this this is great

694
00:31:22,080 --> 00:31:23,460
presentation

695
00:31:23,460 --> 00:31:26,580
um I I think the uh the assumption that

696
00:31:26,580 --> 00:31:28,860
our data is going elsewhere is pretty

697
00:31:28,860 --> 00:31:30,299
much a safe assumption for anything we

698
00:31:30,299 --> 00:31:31,559
bring into our homes and our home

699
00:31:31,559 --> 00:31:33,659
networks or our businesses so thank you

700
00:31:33,659 --> 00:31:35,700
for highlighting that my questions

701
00:31:35,700 --> 00:31:36,960
around

702
00:31:36,960 --> 00:31:39,419
um in your research have you found any

703
00:31:39,419 --> 00:31:42,600
consumer grade products or consumer

704
00:31:42,600 --> 00:31:45,600
grade brands that maybe we might have in

705
00:31:45,600 --> 00:31:49,020
our homes that help in that API proxy or

706
00:31:49,020 --> 00:31:52,320
that WAFF type mentality I I know in

707
00:31:52,320 --> 00:31:54,659
corporate we we have big expensive

708
00:31:54,659 --> 00:31:56,520
technologies that do that but anything

709
00:31:56,520 --> 00:31:58,740
making that transition to the to the

710
00:31:58,740 --> 00:32:01,620
home would be interesting I agree that

711
00:32:01,620 --> 00:32:03,960
would be interesting unfortunately I

712
00:32:03,960 --> 00:32:07,080
only found problems I did not I did not

713
00:32:07,080 --> 00:32:09,659
find answers I know that there are

714
00:32:09,659 --> 00:32:13,200
hobbyists that flash their smart home

715
00:32:13,200 --> 00:32:16,679
equipment and build out custom

716
00:32:16,679 --> 00:32:19,919
tools to drive their home automation

717
00:32:19,919 --> 00:32:22,679
that's a big environment and hobbyist

718
00:32:22,679 --> 00:32:26,220
that you can get into I have not so

719
00:32:26,220 --> 00:32:28,020
hopefully somebody else has better

720
00:32:28,020 --> 00:32:31,740
response to that than I do

721
00:32:31,740 --> 00:32:34,399
go ahead

722
00:32:34,460 --> 00:32:37,580
for me today

723
00:32:37,580 --> 00:32:40,020
was thank you for your talk

724
00:32:40,020 --> 00:32:42,960
um you mentioned that a lot of um

725
00:32:42,960 --> 00:32:45,899
security uh situations like this are

726
00:32:45,899 --> 00:32:48,000
being advertised as breaches there was

727
00:32:48,000 --> 00:32:50,940
one big one for a subsidiary of anchor

728
00:32:50,940 --> 00:32:53,220
in December I wasn't sure if you looked

729
00:32:53,220 --> 00:32:54,899
at that as a case study as a part of

730
00:32:54,899 --> 00:32:57,419
this presentation and I noticed one of

731
00:32:57,419 --> 00:32:59,220
the responses that some of these

732
00:32:59,220 --> 00:33:01,200
companies are having is just saying

733
00:33:01,200 --> 00:33:03,179
these are features and then making them

734
00:33:03,179 --> 00:33:05,039
optional

735
00:33:05,039 --> 00:33:07,440
um one of the issues seemed to be very

736
00:33:07,440 --> 00:33:09,240
similar to what the defender brand

737
00:33:09,240 --> 00:33:11,100
camera was and I'm curious as your

738
00:33:11,100 --> 00:33:13,860
thoughts regarding what these companies

739
00:33:13,860 --> 00:33:15,419
should be doing in response to these

740
00:33:15,419 --> 00:33:17,460
should they be making them optional if

741
00:33:17,460 --> 00:33:18,720
they don't know how to immediately

742
00:33:18,720 --> 00:33:20,580
address the problems

743
00:33:20,580 --> 00:33:22,860
um I'm curious as to

744
00:33:22,860 --> 00:33:27,120
I believe I'm aware of the breach that

745
00:33:27,120 --> 00:33:28,919
you referenced

746
00:33:28,919 --> 00:33:29,700
um

747
00:33:29,700 --> 00:33:34,740
and in response to how we should be

748
00:33:34,740 --> 00:33:37,580
reacting

749
00:33:39,179 --> 00:33:42,299
I would hope that there are Partnerships

750
00:33:42,299 --> 00:33:43,679
that they can seek out because I know

751
00:33:43,679 --> 00:33:45,779
that there's plenty of vendors that

752
00:33:45,779 --> 00:33:48,299
offer support and assistance

753
00:33:48,299 --> 00:33:51,840
and could resolve a lot of what I found

754
00:33:51,840 --> 00:33:54,299
so whether you have

755
00:33:54,299 --> 00:33:57,360
a fleet of infosec professionals within

756
00:33:57,360 --> 00:34:00,779
your organization or not you can find an

757
00:34:00,779 --> 00:34:01,620
answer

758
00:34:01,620 --> 00:34:04,500
it's just prioritizing that for your

759
00:34:04,500 --> 00:34:07,679
company right whether it's a bank or an

760
00:34:07,679 --> 00:34:10,080
iot vendor maybe they don't see

761
00:34:10,080 --> 00:34:12,060
themselves as

762
00:34:12,060 --> 00:34:14,760
Security Experts Security Professionals

763
00:34:14,760 --> 00:34:17,820
and they don't have that mindset

764
00:34:17,820 --> 00:34:19,379
um if you're producing a product that

765
00:34:19,379 --> 00:34:21,239
communicates over the internet

766
00:34:21,239 --> 00:34:24,659
you need to develop that as a mindset

767
00:34:24,659 --> 00:34:26,760
you need to have either a resource you

768
00:34:26,760 --> 00:34:30,619
can go to a VAR a

769
00:34:31,320 --> 00:34:34,020
vendor of some sort

770
00:34:34,020 --> 00:34:36,540
um or bring it in-house but like I say

771
00:34:36,540 --> 00:34:38,940
if you only have 30 people at your

772
00:34:38,940 --> 00:34:40,859
corporate headquarters you probably

773
00:34:40,859 --> 00:34:42,780
aren't going to be able to pull that

774
00:34:42,780 --> 00:34:45,239
trigger but one way or another I don't

775
00:34:45,239 --> 00:34:47,280
feel like

776
00:34:47,280 --> 00:34:49,800
simply hand waving it away

777
00:34:49,800 --> 00:34:53,940
is a reasonable response we shouldn't

778
00:34:53,940 --> 00:34:55,800
tolerate that as end users of these

779
00:34:55,800 --> 00:34:56,699
products

780
00:34:56,699 --> 00:34:58,920
we should be able to step away

781
00:34:58,920 --> 00:35:01,859
from those choices when we're purchasing

782
00:35:01,859 --> 00:35:04,380
these products or interacting with a

783
00:35:04,380 --> 00:35:08,640
bank it's difficult to say drop what

784
00:35:08,640 --> 00:35:10,560
you've done and go to something else but

785
00:35:10,560 --> 00:35:12,320
are

786
00:35:12,320 --> 00:35:14,339
interactions with the businesses we

787
00:35:14,339 --> 00:35:17,599
choose makes a difference I guess

788
00:35:17,880 --> 00:35:22,140
anyone else we have a couple others

789
00:35:22,140 --> 00:35:24,599
uh testing oh it does work

790
00:35:24,599 --> 00:35:27,359
um so you mentioned Mozilla has this uh

791
00:35:27,359 --> 00:35:29,579
sparsely populated database where they

792
00:35:29,579 --> 00:35:30,960
actually mentioned the products and

793
00:35:30,960 --> 00:35:33,540
thumbs up thumbs down and I'm also

794
00:35:33,540 --> 00:35:35,220
saying that you have great information

795
00:35:35,220 --> 00:35:36,839
in your talk

796
00:35:36,839 --> 00:35:41,339
is there a way or a mechanism to link

797
00:35:41,339 --> 00:35:42,900
those two

798
00:35:42,900 --> 00:35:45,240
um certainly there is yeah so if you go

799
00:35:45,240 --> 00:35:47,520
to the Mozilla Foundation privacy not

800
00:35:47,520 --> 00:35:50,099
included they do have options for people

801
00:35:50,099 --> 00:35:53,359
to get involved So I myself should

802
00:35:53,359 --> 00:35:55,980
pursue that effort and share what I've

803
00:35:55,980 --> 00:35:58,560
discovered with them that would be a

804
00:35:58,560 --> 00:36:00,839
reasonable effort on my part

805
00:36:00,839 --> 00:36:02,339
um

806
00:36:02,339 --> 00:36:04,680
to do for me

807
00:36:04,680 --> 00:36:07,260
in the mini hats that I wear I I should

808
00:36:07,260 --> 00:36:09,119
take that on and others should as well

809
00:36:09,119 --> 00:36:12,300
if we participate in privacy not

810
00:36:12,300 --> 00:36:15,180
included it'll just make it better so

811
00:36:15,180 --> 00:36:17,280
thanks for mentioning that I I think

812
00:36:17,280 --> 00:36:18,960
that it's worthwhile

813
00:36:18,960 --> 00:36:21,900
and just maybe one idea I just got it

814
00:36:21,900 --> 00:36:24,119
now so it's Half Baked but you know how

815
00:36:24,119 --> 00:36:26,160
everyone goes to Amazon even if they're

816
00:36:26,160 --> 00:36:27,780
not going to buy from Amazon and they

817
00:36:27,780 --> 00:36:29,400
look at the reviews and things like that

818
00:36:29,400 --> 00:36:32,400
so what if there was a magic phrase like

819
00:36:32,400 --> 00:36:35,040
privacy not included or something that

820
00:36:35,040 --> 00:36:37,680
if I did an Amazon search I would see

821
00:36:37,680 --> 00:36:41,339
everyone adding that phrase to point to

822
00:36:41,339 --> 00:36:44,160
the Mozilla site or something I don't

823
00:36:44,160 --> 00:36:46,500
know just maybe it would work

824
00:36:46,500 --> 00:36:50,000
I agree I think it would work

825
00:36:50,160 --> 00:36:52,859
yeah browser extension sure we had a

826
00:36:52,859 --> 00:36:54,119
question from the chat

827
00:36:54,119 --> 00:36:56,339
um kilo asks did you try reaching

828
00:36:56,339 --> 00:36:59,040
reaching out to dawa

829
00:36:59,040 --> 00:37:01,940
what was oh yeah

830
00:37:01,940 --> 00:37:06,240
so I prepared a response for this

831
00:37:06,240 --> 00:37:09,300
as a security researcher

832
00:37:09,300 --> 00:37:11,579
I felt it was best to contact the

833
00:37:11,579 --> 00:37:15,180
company that I purchased a product from

834
00:37:15,180 --> 00:37:19,380
I certainly saw that Defender and dawa

835
00:37:19,380 --> 00:37:21,240
were partnering

836
00:37:21,240 --> 00:37:24,000
in the traffic that I captured but I

837
00:37:24,000 --> 00:37:26,839
didn't see proof of that in any type of

838
00:37:26,839 --> 00:37:29,640
news article press release

839
00:37:29,640 --> 00:37:33,000
so I felt like that would be a

840
00:37:33,000 --> 00:37:35,520
challenging conversation to approach

841
00:37:35,520 --> 00:37:37,619
dawa and say

842
00:37:37,619 --> 00:37:41,160
I haven't purchased your product

843
00:37:41,160 --> 00:37:43,260
I have no

844
00:37:43,260 --> 00:37:45,900
Financial investment in this

845
00:37:45,900 --> 00:37:48,180
conversation but I want you to know it

846
00:37:48,180 --> 00:37:49,980
was a lot more comfortable for me to

847
00:37:49,980 --> 00:37:52,440
contact Defender who I did purchase a

848
00:37:52,440 --> 00:37:53,820
product from who they could look in

849
00:37:53,820 --> 00:37:56,520
their database and see my history of

850
00:37:56,520 --> 00:37:58,619
business that I've done with them and

851
00:37:58,619 --> 00:38:01,380
have that conversation with

852
00:38:01,380 --> 00:38:03,960
the defender brand instead of the doll

853
00:38:03,960 --> 00:38:05,220
wall brand

854
00:38:05,220 --> 00:38:07,740
also it's a little intimidating to me to

855
00:38:07,740 --> 00:38:11,280
approach a company that isn't native to

856
00:38:11,280 --> 00:38:15,300
my language and my uh culture so I know

857
00:38:15,300 --> 00:38:17,460
that there is culture differences with

858
00:38:17,460 --> 00:38:20,099
that region of the world and I would

859
00:38:20,099 --> 00:38:22,920
hate to misstep

860
00:38:22,920 --> 00:38:25,380
and do a faux pas with that interaction

861
00:38:25,380 --> 00:38:28,320
I guess I'm not informed enough to

862
00:38:28,320 --> 00:38:31,880
approach that sensitive conversation

863
00:38:39,619 --> 00:38:43,079
so my question is probably got a lot of

864
00:38:43,079 --> 00:38:44,940
judgment call I guess based upon your

865
00:38:44,940 --> 00:38:48,260
let's do it yeah how do you go about

866
00:38:48,260 --> 00:38:51,119
accepting the risk or rejecting the risk

867
00:38:51,119 --> 00:38:53,520
of keeping these devices in your

868
00:38:53,520 --> 00:38:56,339
environment because as you mentioned you

869
00:38:56,339 --> 00:38:59,000
get an insurance

870
00:38:59,000 --> 00:39:01,800
Kickback kind of sort of so you have

871
00:39:01,800 --> 00:39:04,200
this tough decision of do I keep this

872
00:39:04,200 --> 00:39:06,660
thing that is going to leak all kinds of

873
00:39:06,660 --> 00:39:08,820
my data out there and everybody's going

874
00:39:08,820 --> 00:39:10,440
to be able to buy it like police or

875
00:39:10,440 --> 00:39:12,119
anybody else or the Chinese government

876
00:39:12,119 --> 00:39:16,079
or whomever how do you decide the value

877
00:39:16,079 --> 00:39:21,359
of your insurance Kickback versus the

878
00:39:21,359 --> 00:39:23,280
leaking of data and the unlikelihood

879
00:39:23,280 --> 00:39:25,380
that it will be used versus you know how

880
00:39:25,380 --> 00:39:27,780
do you personally decide that stuff and

881
00:39:27,780 --> 00:39:28,980
it you know for everybody it's going to

882
00:39:28,980 --> 00:39:30,839
be different but I'm just curious how

883
00:39:30,839 --> 00:39:32,060
you go about it

884
00:39:32,060 --> 00:39:35,520
so I I hope American family is not

885
00:39:35,520 --> 00:39:38,940
watching so

886
00:39:39,359 --> 00:39:40,020
um

887
00:39:40,020 --> 00:39:44,099
if anybody's done the uh

888
00:39:44,099 --> 00:39:48,240
car monitoring where they track your

889
00:39:48,240 --> 00:39:50,160
behaviors of driving

890
00:39:50,160 --> 00:39:51,839
um

891
00:39:51,839 --> 00:39:53,760
these organizations are just checking

892
00:39:53,760 --> 00:39:55,260
for the presence

893
00:39:55,260 --> 00:39:59,460
of these tools these products so on

894
00:39:59,460 --> 00:40:02,220
American family I don't have to have

895
00:40:02,220 --> 00:40:05,400
that in the center of my room right I

896
00:40:05,400 --> 00:40:06,060
can

897
00:40:06,060 --> 00:40:10,740
put it out in a shed miles away from my

898
00:40:10,740 --> 00:40:11,640
home

899
00:40:11,640 --> 00:40:13,440
and American family doesn't know any

900
00:40:13,440 --> 00:40:16,200
different right as long as the sensors

901
00:40:16,200 --> 00:40:18,060
aren't trickering for all kinds of

902
00:40:18,060 --> 00:40:20,520
problems you know fire or water American

903
00:40:20,520 --> 00:40:23,460
families happy that I've installed the

904
00:40:23,460 --> 00:40:26,099
product and it's live

905
00:40:26,099 --> 00:40:28,500
um so unfortunately it's probably not

906
00:40:28,500 --> 00:40:32,040
the most ethical response to what you're

907
00:40:32,040 --> 00:40:36,180
saying but I'm not gonna put it in my

908
00:40:36,180 --> 00:40:37,980
living room where we have all kinds of

909
00:40:37,980 --> 00:40:39,900
family interactions

910
00:40:39,900 --> 00:40:41,760
I'm not going to choose that and I

911
00:40:41,760 --> 00:40:43,200
wouldn't recommend other people choose

912
00:40:43,200 --> 00:40:45,359
that find a place in your home that's

913
00:40:45,359 --> 00:40:46,680
out of the way

914
00:40:46,680 --> 00:40:47,339
um

915
00:40:47,339 --> 00:40:50,760
now if it's not a kickback on your home

916
00:40:50,760 --> 00:40:52,020
insurance

917
00:40:52,020 --> 00:40:56,820
I would say reconsider using the product

918
00:40:56,820 --> 00:40:58,800
are you in a place where you absolutely

919
00:40:58,800 --> 00:41:02,220
need to monitor your couch

920
00:41:02,220 --> 00:41:04,140
or your kitchen table

921
00:41:04,140 --> 00:41:06,599
I mean if that's your situation then by

922
00:41:06,599 --> 00:41:09,119
all means find a product and

923
00:41:09,119 --> 00:41:11,579
make that happen for yourself but I'm

924
00:41:11,579 --> 00:41:13,260
not in that situation I don't need

925
00:41:13,260 --> 00:41:15,900
24-hour surveillance of those parts of

926
00:41:15,900 --> 00:41:17,940
my house so I'll just choose not to

927
00:41:17,940 --> 00:41:19,740
engage the product

928
00:41:19,740 --> 00:41:21,180
um

929
00:41:21,180 --> 00:41:22,800
I do

930
00:41:22,800 --> 00:41:25,140
feel privileged to be able to run this

931
00:41:25,140 --> 00:41:27,660
test and have the opportunity to find

932
00:41:27,660 --> 00:41:31,200
the issues and know what I bought the

933
00:41:31,200 --> 00:41:32,880
defender brand which I thought was a

934
00:41:32,880 --> 00:41:35,460
Canadian product is actually dawa

935
00:41:35,460 --> 00:41:38,160
driving that product not everybody's

936
00:41:38,160 --> 00:41:39,119
going to have that opportunity

937
00:41:39,119 --> 00:41:41,460
unfortunately so I do feel like there's

938
00:41:41,460 --> 00:41:43,200
a number of people who are buying

939
00:41:43,200 --> 00:41:45,359
consumer grade products and just are

940
00:41:45,359 --> 00:41:46,980
completely unaware of what they brought

941
00:41:46,980 --> 00:41:49,520
into their home

942
00:41:50,220 --> 00:41:51,900
I don't know where we're at on time

943
00:41:51,900 --> 00:41:55,020
we've been watching

944
00:41:55,020 --> 00:41:56,940
yeah and there is free stuff I want to

945
00:41:56,940 --> 00:41:58,619
give people opportunity to come to the

946
00:41:58,619 --> 00:42:00,359
front and get all this stuff so I don't

947
00:42:00,359 --> 00:42:02,160
have to bring it home so thanks

948
00:42:02,160 --> 00:42:05,480
everybody appreciate the time

949
00:42:13,860 --> 00:42:15,800
[Music]

950
00:42:15,800 --> 00:42:18,300
very interested in this type of stuff

951
00:42:18,300 --> 00:42:19,500
yeah

952
00:42:19,500 --> 00:42:21,200
um

953
00:42:21,200 --> 00:42:24,379
of course

954
00:42:30,690 --> 00:42:33,420
[Music]

955
00:42:33,420 --> 00:42:35,180
thank you

956
00:42:35,180 --> 00:42:38,310
[Music]

957
00:42:39,780 --> 00:42:42,020
foreign

958
00:43:28,520 --> 00:43:31,520
thank you

959
00:43:40,859 --> 00:43:43,859
foreign

960
00:44:00,300 --> 00:44:03,649
[Music]

961
00:44:12,780 --> 00:44:15,780
foreign

962
00:44:44,339 --> 00:44:47,339
foreign

963
00:44:51,470 --> 00:45:30,109
[Music]

964
00:45:34,859 --> 00:45:37,859
foreign

965
00:45:38,880 --> 00:46:18,060
[Music]

966
00:46:21,740 --> 00:46:23,580
thank you

967
00:46:23,580 --> 00:46:54,038
[Music]

968
00:46:57,619 --> 00:46:59,550
thank you

969
00:46:59,550 --> 00:47:18,110
[Music]

970
00:47:23,040 --> 00:47:25,250
foreign

971
00:47:25,250 --> 00:47:28,550
[Music]

972
00:47:40,620 --> 00:47:43,759
[Music]

973
00:48:00,900 --> 00:48:02,400
bring

974
00:48:02,400 --> 00:48:04,079
guys let's go and kick things off here

975
00:48:04,079 --> 00:48:07,200
so uh this is building the canary token

976
00:48:07,200 --> 00:48:09,599
to monitor Windows process execution and

977
00:48:09,599 --> 00:48:12,060
we've got Casey Smith and Jacob Tory

978
00:48:12,060 --> 00:48:15,319
thank you guys thank you

979
00:48:18,060 --> 00:48:20,299
coming

980
00:48:21,660 --> 00:48:23,760
um it's a little easier so I'm the guy

981
00:48:23,760 --> 00:48:26,339
flying the F-16 actually in Phoenix

982
00:48:26,339 --> 00:48:27,960
um a couple years ago I got to fly an

983
00:48:27,960 --> 00:48:29,520
F-16 around Phoenix screaming through

984
00:48:29,520 --> 00:48:31,920
the Canyons scared some guy who was on

985
00:48:31,920 --> 00:48:33,720
his like Pond boat fishing so he

986
00:48:33,720 --> 00:48:35,640
actually fell into like almost off the

987
00:48:35,640 --> 00:48:38,220
boat we came through 500 knots 300 feet

988
00:48:38,220 --> 00:48:40,140
off the ground and scared him

989
00:48:40,140 --> 00:48:42,660
um so we are actually the entirety of

990
00:48:42,660 --> 00:48:44,640
the budding think slab so it's a small

991
00:48:44,640 --> 00:48:46,859
kind of research organization within the

992
00:48:46,859 --> 00:48:48,660
larger kind of Product Company of things

993
00:48:48,660 --> 00:48:51,300
we focus on Research learning and

994
00:48:51,300 --> 00:48:53,579
teaching so one of our big things that

995
00:48:53,579 --> 00:48:55,500
we do to give back to the community is

996
00:48:55,500 --> 00:48:59,160
thinkscapes so we review between two and

997
00:48:59,160 --> 00:49:01,140
four thousand presentations talks and

998
00:49:01,140 --> 00:49:03,060
papers in the information security both

999
00:49:03,060 --> 00:49:05,339
academic and kind of hacker industry

1000
00:49:05,339 --> 00:49:07,740
every quarter and then we look at ones

1001
00:49:07,740 --> 00:49:09,000
that either indicate something that's

1002
00:49:09,000 --> 00:49:10,980
like brand new and emerging or something

1003
00:49:10,980 --> 00:49:12,480
that's showing some huge amount of

1004
00:49:12,480 --> 00:49:14,280
momentum and then we publish that for

1005
00:49:14,280 --> 00:49:17,040
free at thinks.com TS there's also an

1006
00:49:17,040 --> 00:49:19,440
audio podcast of it so that's something

1007
00:49:19,440 --> 00:49:20,940
that you know we try to do by giving

1008
00:49:20,940 --> 00:49:22,619
back because there's so many talks going

1009
00:49:22,619 --> 00:49:24,540
on I think is an average of four to

1010
00:49:24,540 --> 00:49:26,220
seven conferences every day of the year

1011
00:49:26,220 --> 00:49:28,319
so it's really hard to go into all of

1012
00:49:28,319 --> 00:49:30,839
them so we take that fire hose and try

1013
00:49:30,839 --> 00:49:32,940
to help parse out what's invaluable

1014
00:49:32,940 --> 00:49:35,280
we're both in Colorado we enjoy the

1015
00:49:35,280 --> 00:49:36,660
outdoors though it is kind of nice to

1016
00:49:36,660 --> 00:49:38,520
have no snow on the ground and the sun

1017
00:49:38,520 --> 00:49:40,800
while we're here so we do appreciate

1018
00:49:40,800 --> 00:49:43,020
that so today we're going to talk a

1019
00:49:43,020 --> 00:49:44,280
little bit about kind of the canary

1020
00:49:44,280 --> 00:49:46,140
tokens history background for those who

1021
00:49:46,140 --> 00:49:48,960
aren't familiar our research approach

1022
00:49:48,960 --> 00:49:51,780
and then get into the specifics of the

1023
00:49:51,780 --> 00:49:53,760
sensitive command execution and then

1024
00:49:53,760 --> 00:49:55,260
talk a little bit about kind of the

1025
00:49:55,260 --> 00:49:57,420
challenges of being both like

1026
00:49:57,420 --> 00:49:59,520
researchers that are releasing a product

1027
00:49:59,520 --> 00:50:02,040
that has like support and users and all

1028
00:50:02,040 --> 00:50:03,300
of that type of challenge which is

1029
00:50:03,300 --> 00:50:04,800
something that a lot of times you don't

1030
00:50:04,800 --> 00:50:06,960
get you know before this I was purely in

1031
00:50:06,960 --> 00:50:09,480
research I do an experiment I give a

1032
00:50:09,480 --> 00:50:11,099
talk and I drop it and go on to the next

1033
00:50:11,099 --> 00:50:13,920
thing and so I'd leave a trail of dying

1034
00:50:13,920 --> 00:50:16,140
off and decrepit GitHub repositories

1035
00:50:16,140 --> 00:50:17,940
that no one ever looked at rather than

1036
00:50:17,940 --> 00:50:20,099
leaving kind of products in my midst so

1037
00:50:20,099 --> 00:50:21,720
it's a very challenging thing kind of

1038
00:50:21,720 --> 00:50:24,420
exciting just to see as well so Canary

1039
00:50:24,420 --> 00:50:27,060
tokens are ideas these are subsystem

1040
00:50:27,060 --> 00:50:29,040
Level kind of Honey pots or honey tokens

1041
00:50:29,040 --> 00:50:31,380
so it's not a full system it's something

1042
00:50:31,380 --> 00:50:33,960
that is either accessed or used or

1043
00:50:33,960 --> 00:50:36,359
opened that then alerts and so our idea

1044
00:50:36,359 --> 00:50:37,920
is we want to make it super low cost

1045
00:50:37,920 --> 00:50:39,660
both in terms of money so they're free

1046
00:50:39,660 --> 00:50:41,819
but also in terms of your time as a

1047
00:50:41,819 --> 00:50:43,079
Defender so you don't want to have to be

1048
00:50:43,079 --> 00:50:44,819
thinking about it there's no maintenance

1049
00:50:44,819 --> 00:50:46,260
you just drop these all over your

1050
00:50:46,260 --> 00:50:48,720
environment you forget you have them and

1051
00:50:48,720 --> 00:50:50,880
then you get an email or an alert saying

1052
00:50:50,880 --> 00:50:52,980
hey someone just use your AWS Keys you

1053
00:50:52,980 --> 00:50:54,720
sprinkled around like that's a bad thing

1054
00:50:54,720 --> 00:50:56,880
go figure out what's going on and so

1055
00:50:56,880 --> 00:50:58,740
they're all really simple and that's

1056
00:50:58,740 --> 00:51:00,119
something we really focus on is making

1057
00:51:00,119 --> 00:51:01,980
these things we don't want to make it a

1058
00:51:01,980 --> 00:51:03,660
big hurdle to get it out the door so we

1059
00:51:03,660 --> 00:51:05,040
try to make it as simple as possible

1060
00:51:05,040 --> 00:51:07,740
they alert on access we have various

1061
00:51:07,740 --> 00:51:10,680
Primitives DNS HTTP Etc and they're

1062
00:51:10,680 --> 00:51:13,319
they're pretty effective and you kind of

1063
00:51:13,319 --> 00:51:14,640
forget about them until they alert and

1064
00:51:14,640 --> 00:51:17,040
then you're like wow that's great

1065
00:51:17,040 --> 00:51:18,599
um so like real quick this is kind of

1066
00:51:18,599 --> 00:51:19,520
what it looks like you go to

1067
00:51:19,520 --> 00:51:21,839
canarytokens.org you can all hope this

1068
00:51:21,839 --> 00:51:23,160
is all open source you can host this

1069
00:51:23,160 --> 00:51:25,319
yourself it's um if you want to

1070
00:51:25,319 --> 00:51:27,000
um we host one as well there's a bunch

1071
00:51:27,000 --> 00:51:28,859
of different types of tokens

1072
00:51:28,859 --> 00:51:30,780
um you go and create one and then you

1073
00:51:30,780 --> 00:51:32,700
know so this is what we're going to show

1074
00:51:32,700 --> 00:51:34,079
you is getting something that's saying

1075
00:51:34,079 --> 00:51:37,260
hey you know Casey just executed NL test

1076
00:51:37,260 --> 00:51:39,420
on the system so who here knows what

1077
00:51:39,420 --> 00:51:41,280
nltest does

1078
00:51:41,280 --> 00:51:43,500
who here runs it every day

1079
00:51:43,500 --> 00:51:45,599
great no one so the idea is we want to

1080
00:51:45,599 --> 00:51:47,400
be able to look for those people that

1081
00:51:47,400 --> 00:51:48,960
are running those because we find that

1082
00:51:48,960 --> 00:51:51,480
there's a very specific type of user

1083
00:51:51,480 --> 00:51:52,920
that uses these commands and they're

1084
00:51:52,920 --> 00:51:55,140
generally malicious and so if we can

1085
00:51:55,140 --> 00:51:57,420
trigger that that's great and so you

1086
00:51:57,420 --> 00:52:00,180
also see here that the channel is DNS

1087
00:52:00,180 --> 00:52:01,740
um so we were looking at how we might be

1088
00:52:01,740 --> 00:52:03,720
able to report this out and we wanted to

1089
00:52:03,720 --> 00:52:05,339
make sure that we could fit into your

1090
00:52:05,339 --> 00:52:08,099
organization and so we thought HTTP may

1091
00:52:08,099 --> 00:52:09,839
be blocked or maybe there's some proxy

1092
00:52:09,839 --> 00:52:11,579
or be more difficult to configure but

1093
00:52:11,579 --> 00:52:13,200
pretty much every organization allows

1094
00:52:13,200 --> 00:52:15,300
you to resolve DNS even if it is

1095
00:52:15,300 --> 00:52:17,280
captured within your organization so

1096
00:52:17,280 --> 00:52:18,180
that's what we're going to see you're

1097
00:52:18,180 --> 00:52:19,559
going to see a lot of work going down

1098
00:52:19,559 --> 00:52:22,140
the road about how we had to use the DNS

1099
00:52:22,140 --> 00:52:24,180
as a channel to be able to commute this

1100
00:52:24,180 --> 00:52:26,099
alert app

1101
00:52:26,099 --> 00:52:28,200
and then you know attackers use it you

1102
00:52:28,200 --> 00:52:30,059
get alerted so this was kind of like a

1103
00:52:30,059 --> 00:52:32,339
very simple thing AWS keys are probably

1104
00:52:32,339 --> 00:52:35,220
our most popular token so we vend AWS

1105
00:52:35,220 --> 00:52:37,440
keys from our organization's account so

1106
00:52:37,440 --> 00:52:39,540
you're not exposing yourself to risk you

1107
00:52:39,540 --> 00:52:41,460
put these on your CTO laptop your Dev

1108
00:52:41,460 --> 00:52:43,680
laptop and if an attacker gets on that

1109
00:52:43,680 --> 00:52:45,540
computer they kind of have to go try it

1110
00:52:45,540 --> 00:52:46,800
because they're like oh this must be

1111
00:52:46,800 --> 00:52:48,300
something good in there and the moment

1112
00:52:48,300 --> 00:52:50,640
they do you get an alert on it and what

1113
00:52:50,640 --> 00:52:53,339
we found as we started deploying this is

1114
00:52:53,339 --> 00:52:54,960
that we actually get like tweets from

1115
00:52:54,960 --> 00:52:56,819
red teamers to say now when I'm on an

1116
00:52:56,819 --> 00:53:00,000
organization if I see AWS creds I

1117
00:53:00,000 --> 00:53:01,920
probably will just skip it unless I

1118
00:53:01,920 --> 00:53:03,839
really need to so you kind of win either

1119
00:53:03,839 --> 00:53:06,000
way bad attackers get caught really

1120
00:53:06,000 --> 00:53:08,460
early Savvy attackers can't really move

1121
00:53:08,460 --> 00:53:10,020
through your network very smoothly and

1122
00:53:10,020 --> 00:53:11,520
they have to like leave stuff on the

1123
00:53:11,520 --> 00:53:13,079
table because they're worried about this

1124
00:53:13,079 --> 00:53:16,140
being a lie so that's something that we

1125
00:53:16,140 --> 00:53:17,760
found you know is really works out

1126
00:53:17,760 --> 00:53:19,619
pretty well and we had a red team of our

1127
00:53:19,619 --> 00:53:21,480
own infrastructure we gave them access

1128
00:53:21,480 --> 00:53:23,400
to a computer as if they had found some

1129
00:53:23,400 --> 00:53:25,140
way to breach our perimeter and they

1130
00:53:25,140 --> 00:53:26,040
didn't really do anything because they

1131
00:53:26,040 --> 00:53:27,780
were freaked out that everything on our

1132
00:53:27,780 --> 00:53:29,280
network was fake and that all the data

1133
00:53:29,280 --> 00:53:30,780
was also fake and so they just kind of

1134
00:53:30,780 --> 00:53:33,059
sat there paralyzed and that's a win for

1135
00:53:33,059 --> 00:53:34,680
us as well right you know even if we're

1136
00:53:34,680 --> 00:53:36,119
you know you know we're not getting the

1137
00:53:36,119 --> 00:53:38,040
alerts immediately we're just stopping

1138
00:53:38,040 --> 00:53:41,240
them from achieving their goals

1139
00:53:41,540 --> 00:53:44,280
just a step back as well I think it's

1140
00:53:44,280 --> 00:53:45,540
really important to talk about our

1141
00:53:45,540 --> 00:53:47,099
approach to research because a lot of

1142
00:53:47,099 --> 00:53:48,960
times you see people present something

1143
00:53:48,960 --> 00:53:50,640
and you just think wow these are these

1144
00:53:50,640 --> 00:53:52,680
brilliant people that always win and

1145
00:53:52,680 --> 00:53:55,020
they're always at these conferences how

1146
00:53:55,020 --> 00:53:57,180
come they get to do it and I don't and I

1147
00:53:57,180 --> 00:53:59,040
want to highlight the fact that there's

1148
00:53:59,040 --> 00:54:01,319
a lot of skeletons behind this thing

1149
00:54:01,319 --> 00:54:03,839
failed IDs which we'll talk about and

1150
00:54:03,839 --> 00:54:05,940
this is kind of how I kind of saw this

1151
00:54:05,940 --> 00:54:07,440
process and this is for a lot of my

1152
00:54:07,440 --> 00:54:08,880
ideas right I start off with some idea

1153
00:54:08,880 --> 00:54:10,680
it's like this bubble you don't want to

1154
00:54:10,680 --> 00:54:12,359
touch it you don't want to prick it it's

1155
00:54:12,359 --> 00:54:14,040
beautiful and then you just have this

1156
00:54:14,040 --> 00:54:15,359
bubbling you carry it around in your

1157
00:54:15,359 --> 00:54:17,099
mind for a few days you Daydream of

1158
00:54:17,099 --> 00:54:19,140
maybe not winning the Nobel Prize but at

1159
00:54:19,140 --> 00:54:20,520
least like oh people are going to want

1160
00:54:20,520 --> 00:54:22,260
to talk to me and I'm going to have all

1161
00:54:22,260 --> 00:54:23,640
these you know interviews on the news

1162
00:54:23,640 --> 00:54:25,859
and I'm going to be famous and then you

1163
00:54:25,859 --> 00:54:26,880
realize well actually I don't know

1164
00:54:26,880 --> 00:54:28,740
anything about Windows I run Linux at

1165
00:54:28,740 --> 00:54:30,240
home so how am I going to get this idea

1166
00:54:30,240 --> 00:54:31,319
and then

1167
00:54:31,319 --> 00:54:33,359
you present this idea to people and

1168
00:54:33,359 --> 00:54:34,380
they're like well that won't work or

1169
00:54:34,380 --> 00:54:35,760
that won't work or that won't work and

1170
00:54:35,760 --> 00:54:37,319
your poor little bubble has just been

1171
00:54:37,319 --> 00:54:39,540
poked all over and then if you do the

1172
00:54:39,540 --> 00:54:41,339
work you slowly get back up and then

1173
00:54:41,339 --> 00:54:43,140
hopefully you're fairly happy where you

1174
00:54:43,140 --> 00:54:45,420
are in reality I haven't won the Nobel

1175
00:54:45,420 --> 00:54:47,339
Prize yet I'm not doing any interviews

1176
00:54:47,339 --> 00:54:48,900
on the news but I'm pretty happy that we

1177
00:54:48,900 --> 00:54:50,819
got this thing over the line and so I do

1178
00:54:50,819 --> 00:54:52,680
want to highlight there's a lot of work

1179
00:54:52,680 --> 00:54:55,260
and a lot of failure here not just hey

1180
00:54:55,260 --> 00:54:57,359
look at that so everyone can do this

1181
00:54:57,359 --> 00:54:59,460
type of stuff it's not just uh you know

1182
00:54:59,460 --> 00:55:02,339
you were you were born into it

1183
00:55:02,339 --> 00:55:04,500
um and a lot of it also comes from

1184
00:55:04,500 --> 00:55:05,880
collaboration and that's something we've

1185
00:55:05,880 --> 00:55:07,319
been spending a lot of time with even

1186
00:55:07,319 --> 00:55:09,720
before the pandemic we're a remote first

1187
00:55:09,720 --> 00:55:11,040
company

1188
00:55:11,040 --> 00:55:12,960
um we have huge time zone swings the

1189
00:55:12,960 --> 00:55:14,579
company's based in South Africa actually

1190
00:55:14,579 --> 00:55:16,380
flew in yesterday from South Africa so

1191
00:55:16,380 --> 00:55:18,780
I'm pretty tired right now

1192
00:55:18,780 --> 00:55:21,359
um and trying to be able to manage like

1193
00:55:21,359 --> 00:55:23,220
there's good pockets of people all

1194
00:55:23,220 --> 00:55:25,440
across the world how do we without you

1195
00:55:25,440 --> 00:55:26,880
know making them stay up late or us

1196
00:55:26,880 --> 00:55:28,920
getting up early be able to collaborate

1197
00:55:28,920 --> 00:55:30,420
and work on these types of research

1198
00:55:30,420 --> 00:55:33,300
projects I'm in an asynchronous way you

1199
00:55:33,300 --> 00:55:35,819
know facilitating that failure is okay

1200
00:55:35,819 --> 00:55:37,500
and so now Casey's going to talk you

1201
00:55:37,500 --> 00:55:39,359
through about the specifics of today's

1202
00:55:39,359 --> 00:55:41,280
new token and kind of from the idea

1203
00:55:41,280 --> 00:55:43,619
Generation all the stumbling blocks

1204
00:55:43,619 --> 00:55:46,740
along the way towards where we're at

1205
00:55:46,740 --> 00:55:48,240
awesome thanks just a quick show of

1206
00:55:48,240 --> 00:55:49,500
hands how many folks have created a

1207
00:55:49,500 --> 00:55:51,059
canary token and detonated before some

1208
00:55:51,059 --> 00:55:52,980
folks have seen okay oh those are new so

1209
00:55:52,980 --> 00:55:54,420
awesome

1210
00:55:54,420 --> 00:55:57,540
um so this the idea was we wanted to

1211
00:55:57,540 --> 00:55:58,619
create something that was really simple

1212
00:55:58,619 --> 00:56:00,540
like if somebody runs a command I want

1213
00:56:00,540 --> 00:56:02,160
an alert I don't want to deploy an agent

1214
00:56:02,160 --> 00:56:05,640
a driver a sensor uh and so you know

1215
00:56:05,640 --> 00:56:07,020
you're thinking of environments where

1216
00:56:07,020 --> 00:56:08,640
you may not be able to install software

1217
00:56:08,640 --> 00:56:10,740
or Legacy systems so that was sort of

1218
00:56:10,740 --> 00:56:12,480
the outcome we wanted is could we create

1219
00:56:12,480 --> 00:56:14,280
this easy way to say if someone runs who

1220
00:56:14,280 --> 00:56:16,740
am I on my build system nobody should be

1221
00:56:16,740 --> 00:56:18,540
running that uh you know we get an

1222
00:56:18,540 --> 00:56:20,700
output so or some of these rare commands

1223
00:56:20,700 --> 00:56:23,040
like k-list or NL tests and some of

1224
00:56:23,040 --> 00:56:23,880
these commands that we'll talk about

1225
00:56:23,880 --> 00:56:26,400
that we see inside of ransomware reports

1226
00:56:26,400 --> 00:56:28,619
so in almost every ransomware report we

1227
00:56:28,619 --> 00:56:30,960
were seeing things like a sequence of

1228
00:56:30,960 --> 00:56:32,760
commands that attackers are running on

1229
00:56:32,760 --> 00:56:34,440
Windows machines and many of them are

1230
00:56:34,440 --> 00:56:36,119
rarely used day to day by the average

1231
00:56:36,119 --> 00:56:38,220
Windows user and so you started to think

1232
00:56:38,220 --> 00:56:39,780
like well how that's really a good idea

1233
00:56:39,780 --> 00:56:42,300
but how do you actually create the alert

1234
00:56:42,300 --> 00:56:46,319
that's simple and easy to deploy and so

1235
00:56:46,319 --> 00:56:47,880
some of you you are familiar with dfir

1236
00:56:47,880 --> 00:56:49,800
report and they publish a lot of reports

1237
00:56:49,800 --> 00:56:51,359
on ransomware attacks and you can see an

1238
00:56:51,359 --> 00:56:52,800
example here on the right this was from

1239
00:56:52,800 --> 00:56:56,460
the quantum attack and you see attackers

1240
00:56:56,460 --> 00:56:57,960
they get on a box and they run these

1241
00:56:57,960 --> 00:56:59,540
batch scripts they run like command

1242
00:56:59,540 --> 00:57:02,220
ipconfig system info net config then you

1243
00:57:02,220 --> 00:57:03,660
start getting and get into these other

1244
00:57:03,660 --> 00:57:05,460
ones that are more odd like NL test

1245
00:57:05,460 --> 00:57:10,140
domain uh domain trust or net view local

1246
00:57:10,140 --> 00:57:12,359
admins commands that may not be normally

1247
00:57:12,359 --> 00:57:14,280
run day to day

1248
00:57:14,280 --> 00:57:16,260
and here's another one from I think this

1249
00:57:16,260 --> 00:57:18,119
was the Bumblebee uh ransomware attack

1250
00:57:18,119 --> 00:57:20,700
and so there's NL test again so that was

1251
00:57:20,700 --> 00:57:21,960
like our first candidate we thought we

1252
00:57:21,960 --> 00:57:23,940
how would we even know if NL test was

1253
00:57:23,940 --> 00:57:26,880
running on a system and more important

1254
00:57:26,880 --> 00:57:28,559
under what conditions does someone

1255
00:57:28,559 --> 00:57:31,260
legitimately run NL test so it's pretty

1256
00:57:31,260 --> 00:57:32,940
clear uh you've probably seen those

1257
00:57:32,940 --> 00:57:34,500
behaviors where there's the sequences of

1258
00:57:34,500 --> 00:57:36,420
commands some of them are interesting

1259
00:57:36,420 --> 00:57:38,280
some of them are run all the time but

1260
00:57:38,280 --> 00:57:39,900
how can we create a really quick alert

1261
00:57:39,900 --> 00:57:43,319
uh using a canary token to detect when

1262
00:57:43,319 --> 00:57:45,780
NL test for example runs

1263
00:57:45,780 --> 00:57:48,180
so we started just prototyping and

1264
00:57:48,180 --> 00:57:49,500
experimenting and I would say one thing

1265
00:57:49,500 --> 00:57:51,300
in research that's really helpful is

1266
00:57:51,300 --> 00:57:53,160
just to start trying things because

1267
00:57:53,160 --> 00:57:54,780
sometimes we get stuck and we have ideas

1268
00:57:54,780 --> 00:57:56,520
in our mind and actually when you start

1269
00:57:56,520 --> 00:57:58,559
actually building and testing things you

1270
00:57:58,559 --> 00:58:00,300
start to see what works and starts to

1271
00:58:00,300 --> 00:58:01,920
shape and form your ideas a little bit

1272
00:58:01,920 --> 00:58:03,599
better rather than just theorizing about

1273
00:58:03,599 --> 00:58:04,800
something may not work because in

1274
00:58:04,800 --> 00:58:06,720
reality you tested it and it may

1275
00:58:06,720 --> 00:58:09,480
actually work quite well so I've got a

1276
00:58:09,480 --> 00:58:11,339
lot of slides from the Skunk Works book

1277
00:58:11,339 --> 00:58:13,020
the uh that's the have blue which is the

1278
00:58:13,020 --> 00:58:14,520
early prototype to the stealth fighter

1279
00:58:14,520 --> 00:58:16,079
so if you haven't seen some of those

1280
00:58:16,079 --> 00:58:17,339
images before

1281
00:58:17,339 --> 00:58:19,079
so now let's talk about our like our

1282
00:58:19,079 --> 00:58:21,059
idea to delivery so we have this neat

1283
00:58:21,059 --> 00:58:23,880
idea but how do we go from I want to

1284
00:58:23,880 --> 00:58:25,740
detect a command to something actually

1285
00:58:25,740 --> 00:58:28,079
published on the website and deployed in

1286
00:58:28,079 --> 00:58:29,819
organizations

1287
00:58:29,819 --> 00:58:31,680
so we really worked with two constraints

1288
00:58:31,680 --> 00:58:33,480
we had a constraint that it needs to be

1289
00:58:33,480 --> 00:58:35,339
very easy like other Canary tokens like

1290
00:58:35,339 --> 00:58:37,440
if you create a word doc you just create

1291
00:58:37,440 --> 00:58:39,180
the word documentary token and if it is

1292
00:58:39,180 --> 00:58:41,460
ever open you get the alert and it also

1293
00:58:41,460 --> 00:58:43,319
needs to be low false positive rate so

1294
00:58:43,319 --> 00:58:44,579
we wanted to say we don't want to put

1295
00:58:44,579 --> 00:58:45,900
something out there that creates a bunch

1296
00:58:45,900 --> 00:58:48,660
of noise a bunch of alerts that uh The

1297
00:58:48,660 --> 00:58:50,880
Defenders might stop responding to or

1298
00:58:50,880 --> 00:58:52,559
just not pay attention to

1299
00:58:52,559 --> 00:58:54,299
so those were the two boundaries now

1300
00:58:54,299 --> 00:58:55,740
we're not talking here about replacing

1301
00:58:55,740 --> 00:58:58,200
EDR behavioral detection Sim we're just

1302
00:58:58,200 --> 00:59:00,480
talking about a really lightweight uh

1303
00:59:00,480 --> 00:59:03,599
High Fidelity alert of a command so

1304
00:59:03,599 --> 00:59:07,079
the first attempt was this dos key Alias

1305
00:59:07,079 --> 00:59:08,640
we kind of had this idea like if

1306
00:59:08,640 --> 00:59:11,339
somebody runs NL test just shut down the

1307
00:59:11,339 --> 00:59:12,599
computer you know like a little bit

1308
00:59:12,599 --> 00:59:14,160
extreme but just like theorizing and so

1309
00:59:14,160 --> 00:59:15,480
how many of you have ever used doskey

1310
00:59:15,480 --> 00:59:18,480
before anyone okay some of you so this

1311
00:59:18,480 --> 00:59:19,799
is actually a really cool way it's

1312
00:59:19,799 --> 00:59:21,660
actually documented well on Microsoft

1313
00:59:21,660 --> 00:59:24,540
you can create aliases for commands so

1314
00:59:24,540 --> 00:59:26,640
you can say I just want to type the

1315
00:59:26,640 --> 00:59:29,040
letter n and then the document and it

1316
00:59:29,040 --> 00:59:31,319
opens notepad so it's actually pretty

1317
00:59:31,319 --> 00:59:33,660
close to what we wanted here and so we

1318
00:59:33,660 --> 00:59:35,339
created this prototype where we said all

1319
00:59:35,339 --> 00:59:37,440
right well let's just try and see if we

1320
00:59:37,440 --> 00:59:40,200
can run uh scheduled tasks and then

1321
00:59:40,200 --> 00:59:42,180
notepad runs we actually got it to work

1322
00:59:42,180 --> 00:59:44,160
so that so you could experiment with

1323
00:59:44,160 --> 00:59:45,480
that there's a little bit of escaping

1324
00:59:45,480 --> 00:59:46,920
sequencing here but the idea is you

1325
00:59:46,920 --> 00:59:50,520
could create a SCH task Alias and then

1326
00:59:50,520 --> 00:59:52,559
somebody runs that command instead of

1327
00:59:52,559 --> 00:59:54,540
running scheduled tasks it would go off

1328
00:59:54,540 --> 00:59:57,420
and run uh notepad or more interestingly

1329
00:59:57,420 --> 00:59:59,640
if you uh create the Alias with like

1330
00:59:59,640 --> 01:00:01,859
shell pipes you could say run schedule

1331
01:00:01,859 --> 01:00:03,900
tasks but over in another thread or

1332
01:00:03,900 --> 01:00:06,180
whatever another component run notepad

1333
01:00:06,180 --> 01:00:07,859
so the attacker would still get the

1334
01:00:07,859 --> 01:00:09,960
output from schedule tasks and notepad

1335
01:00:09,960 --> 01:00:11,220
would run in the background was actually

1336
01:00:11,220 --> 01:00:12,780
really a good candidate for us because

1337
01:00:12,780 --> 01:00:14,880
we didn't want to tip off the attacker

1338
01:00:14,880 --> 01:00:16,920
hey you just ran scheduled tasks and it

1339
01:00:16,920 --> 01:00:20,220
was not scheduled tasks so

1340
01:00:20,220 --> 01:00:23,160
well this was our first fail so I was

1341
01:00:23,160 --> 01:00:24,540
really excited about this I was like

1342
01:00:24,540 --> 01:00:26,099
this is it this is going to be the one

1343
01:00:26,099 --> 01:00:28,140
super easy how hard could this be and

1344
01:00:28,140 --> 01:00:29,940
then you start trying to use it when you

1345
01:00:29,940 --> 01:00:31,740
come in on an RDP session and you start

1346
01:00:31,740 --> 01:00:34,380
to realize these dos key macros don't

1347
01:00:34,380 --> 01:00:36,480
transfer to other users and they're not

1348
01:00:36,480 --> 01:00:38,700
Global and so it really didn't fit our

1349
01:00:38,700 --> 01:00:41,220
constraints of easy to use uh didn't

1350
01:00:41,220 --> 01:00:43,140
really fit the constraint of like

1351
01:00:43,140 --> 01:00:45,420
um monitoring every user on the system

1352
01:00:45,420 --> 01:00:46,500
so

1353
01:00:46,500 --> 01:00:48,599
we decided to table it go back to the

1354
01:00:48,599 --> 01:00:51,299
drawing board try something else

1355
01:00:51,299 --> 01:00:53,400
so the other thing we tried then was I

1356
01:00:53,400 --> 01:00:54,480
don't know if you're familiar with this

1357
01:00:54,480 --> 01:00:56,280
but in Windows you can attach an event

1358
01:00:56,280 --> 01:00:58,380
to a SK uh

1359
01:00:58,380 --> 01:01:00,240
um you can attach a scheduled task to an

1360
01:01:00,240 --> 01:01:03,900
event ID so 4688 events and windows are

1361
01:01:03,900 --> 01:01:06,059
process monitoring process execution so

1362
01:01:06,059 --> 01:01:10,020
if somebody runs NL test then you can

1363
01:01:10,020 --> 01:01:12,660
take that event ID and you know execute

1364
01:01:12,660 --> 01:01:13,740
a command

1365
01:01:13,740 --> 01:01:15,059
some of you have seen that if you go

1366
01:01:15,059 --> 01:01:16,500
into like Event Viewer you can right

1367
01:01:16,500 --> 01:01:19,020
click a specific event you're interested

1368
01:01:19,020 --> 01:01:21,480
in and say attach a task to this and a

1369
01:01:21,480 --> 01:01:22,920
lot of actually attackers have used this

1370
01:01:22,920 --> 01:01:26,640
as a persistence mechanism so but it

1371
01:01:26,640 --> 01:01:29,220
again wasn't great because it wasn't

1372
01:01:29,220 --> 01:01:30,740
really easy to deploy that

1373
01:01:30,740 --> 01:01:33,599
organizational wide it was super noisy

1374
01:01:33,599 --> 01:01:35,940
because it was like per event ID not per

1375
01:01:35,940 --> 01:01:38,819
executable and so too many moving parts

1376
01:01:38,819 --> 01:01:40,140
we spent a lot of time trying to get

1377
01:01:40,140 --> 01:01:41,760
that to work only to realize it's not

1378
01:01:41,760 --> 01:01:43,319
going to work for us so get the Tommy

1379
01:01:43,319 --> 01:01:46,319
Boy frustration there so we we like this

1380
01:01:46,319 --> 01:01:48,720
phrase I first heard this uh term from a

1381
01:01:48,720 --> 01:01:50,520
teacher actually in Nebraska and she

1382
01:01:50,520 --> 01:01:52,500
coined this term as first attempts in

1383
01:01:52,500 --> 01:01:55,260
learning fail so expect to fail a lot in

1384
01:01:55,260 --> 01:01:56,760
research and don't

1385
01:01:56,760 --> 01:01:58,680
um don't let that block you or don't

1386
01:01:58,680 --> 01:02:00,780
like take that in terms of like I'm not

1387
01:02:00,780 --> 01:02:02,160
going to accomplish this but definitely

1388
01:02:02,160 --> 01:02:04,020
look into why it failed and how you

1389
01:02:04,020 --> 01:02:06,000
might pivot but definitely there's a lot

1390
01:02:06,000 --> 01:02:07,799
of failures that happen along the way

1391
01:02:07,799 --> 01:02:09,960
some of the other things we tried was

1392
01:02:09,960 --> 01:02:12,540
wmi we tried some further event log

1393
01:02:12,540 --> 01:02:16,020
processing none of it our constraints

1394
01:02:16,020 --> 01:02:17,760
so we decided to take a different

1395
01:02:17,760 --> 01:02:19,319
approach and this has really helped me

1396
01:02:19,319 --> 01:02:21,299
over the years is when you're stuck on a

1397
01:02:21,299 --> 01:02:22,559
problem is to try and take a different

1398
01:02:22,559 --> 01:02:24,839
frame or different perspective so one of

1399
01:02:24,839 --> 01:02:26,760
my favorite questions uh I used to do

1400
01:02:26,760 --> 01:02:28,619
red teaming was what would a developer

1401
01:02:28,619 --> 01:02:30,480
do how would a developer solve this

1402
01:02:30,480 --> 01:02:31,380
problem because a lot of times

1403
01:02:31,380 --> 01:02:33,599
developers have really cool tools or

1404
01:02:33,599 --> 01:02:35,640
scripts or concepts that may help us

1405
01:02:35,640 --> 01:02:38,339
either as an attack or a Defender and

1406
01:02:38,339 --> 01:02:39,839
then of course pivoting back again and

1407
01:02:39,839 --> 01:02:41,280
saying you know what would an attacker

1408
01:02:41,280 --> 01:02:43,799
do here how would an attacker get an

1409
01:02:43,799 --> 01:02:46,799
alert any time of command ran

1410
01:02:46,799 --> 01:02:48,420
so that got me thinking a little bit

1411
01:02:48,420 --> 01:02:49,740
have I seen something like that before

1412
01:02:49,740 --> 01:02:51,000
and sure enough

1413
01:02:51,000 --> 01:02:53,880
in 2018 adver Mo so a huge shout out to

1414
01:02:53,880 --> 01:02:56,220
admir he posted this blog about a

1415
01:02:56,220 --> 01:02:58,200
Windows uh registry key called image

1416
01:02:58,200 --> 01:03:00,119
file execution options

1417
01:03:00,119 --> 01:03:01,859
and it's actually a feature that's used

1418
01:03:01,859 --> 01:03:04,079
for grab some water real quick it's

1419
01:03:04,079 --> 01:03:05,160
actually a feature that's used for

1420
01:03:05,160 --> 01:03:07,200
debugging and so we can actually

1421
01:03:07,200 --> 01:03:10,140
repurpose this but this met our criteria

1422
01:03:10,140 --> 01:03:12,240
so image file execution options allow

1423
01:03:12,240 --> 01:03:15,599
you to say when this command runs do

1424
01:03:15,599 --> 01:03:17,280
something else now primarily that's used

1425
01:03:17,280 --> 01:03:19,260
for debugging or instrumentation but

1426
01:03:19,260 --> 01:03:21,660
odvar was using it in his blogs with a

1427
01:03:21,660 --> 01:03:24,420
detection by Auto runs

1428
01:03:24,420 --> 01:03:25,980
but then you have this moment where like

1429
01:03:25,980 --> 01:03:27,420
this totally works so we actually had

1430
01:03:27,420 --> 01:03:29,940
like our our first prototype where I can

1431
01:03:29,940 --> 01:03:31,799
run a command and something runs in the

1432
01:03:31,799 --> 01:03:33,660
background so like this was a really

1433
01:03:33,660 --> 01:03:35,220
basic example like just send a canary

1434
01:03:35,220 --> 01:03:38,099
token alert so a lot more work to go but

1435
01:03:38,099 --> 01:03:40,020
at this point we felt like we had at

1436
01:03:40,020 --> 01:03:41,819
least a glimmer of hope now it actually

1437
01:03:41,819 --> 01:03:43,319
sat for

1438
01:03:43,319 --> 01:03:44,880
I don't know maybe two or three weeks we

1439
01:03:44,880 --> 01:03:46,319
actually got to a point where we just

1440
01:03:46,319 --> 01:03:48,900
put this on the shelf and then we came

1441
01:03:48,900 --> 01:03:50,280
back to it so sometimes that's another

1442
01:03:50,280 --> 01:03:52,559
useful technique in research keep some

1443
01:03:52,559 --> 01:03:54,119
good documentation because you may find

1444
01:03:54,119 --> 01:03:56,220
something in another domain and think oh

1445
01:03:56,220 --> 01:03:58,440
that solves that problem I was working

1446
01:03:58,440 --> 01:04:00,839
on a few weeks ago so that happened in

1447
01:04:00,839 --> 01:04:02,520
this case as well

1448
01:04:02,520 --> 01:04:04,380
so if you're curious about this

1449
01:04:04,380 --> 01:04:06,599
particular registry key we'll do a deep

1450
01:04:06,599 --> 01:04:08,640
dive here in a moment but it allows you

1451
01:04:08,640 --> 01:04:11,339
to monitor in a process exits so

1452
01:04:11,339 --> 01:04:14,099
NL test runs and then you run a command

1453
01:04:14,099 --> 01:04:15,839
in the background so we started

1454
01:04:15,839 --> 01:04:18,180
prototyping some things

1455
01:04:18,180 --> 01:04:20,400
I want to run NL test and then I want it

1456
01:04:20,400 --> 01:04:23,220
to run NS lookup and the NS lookup runs

1457
01:04:23,220 --> 01:04:25,200
a canary token alert and then we know

1458
01:04:25,200 --> 01:04:26,940
that somebody has ran the command or

1459
01:04:26,940 --> 01:04:29,040
maybe NL test runs and then I run a

1460
01:04:29,040 --> 01:04:31,700
Powershell script in the background so

1461
01:04:31,700 --> 01:04:34,020
we started trying this but it started

1462
01:04:34,020 --> 01:04:36,059
failing again another fail so we were

1463
01:04:36,059 --> 01:04:37,740
trying to make it Dynamic so we would

1464
01:04:37,740 --> 01:04:40,260
say like when NL test runs I want to

1465
01:04:40,260 --> 01:04:41,880
collect some environment variables so

1466
01:04:41,880 --> 01:04:44,700
username computer name the unique string

1467
01:04:44,700 --> 01:04:46,619
of the token so it would do a DNS lookup

1468
01:04:46,619 --> 01:04:47,940
you need to have this nice alert that

1469
01:04:47,940 --> 01:04:51,000
has the username and the computer and a

1470
01:04:51,000 --> 01:04:53,280
specific token ID that you had created

1471
01:04:53,280 --> 01:04:55,500
but if it wasn't working I was creating

1472
01:04:55,500 --> 01:04:56,940
this in a Jacob was testing and he's

1473
01:04:56,940 --> 01:04:58,980
like all I'm seeing is the username but

1474
01:04:58,980 --> 01:05:00,720
there's these random parameters in front

1475
01:05:00,720 --> 01:05:02,339
just integers

1476
01:05:02,339 --> 01:05:05,480
so it turns out

1477
01:05:06,540 --> 01:05:09,660
that the percent C is a reserved

1478
01:05:09,660 --> 01:05:12,780
character for this uh process monitored

1479
01:05:12,780 --> 01:05:14,160
so we were running this weird Collision

1480
01:05:14,160 --> 01:05:16,319
where instead of interpolating that as

1481
01:05:16,319 --> 01:05:18,059
the computer name like we wanted in an

1482
01:05:18,059 --> 01:05:19,799
environment variable it was like a

1483
01:05:19,799 --> 01:05:21,480
status code associated with the process

1484
01:05:21,480 --> 01:05:24,000
exit and so that wasn't going to work at

1485
01:05:24,000 --> 01:05:26,460
all another fail we couldn't use NS

1486
01:05:26,460 --> 01:05:27,359
lookup

1487
01:05:27,359 --> 01:05:30,000
and so what we had to switch to was we

1488
01:05:30,000 --> 01:05:31,260
had to find a way to take that

1489
01:05:31,260 --> 01:05:33,119
information and encode it in Powershell

1490
01:05:33,119 --> 01:05:35,640
and pipe it out over a DNS query and

1491
01:05:35,640 --> 01:05:37,079
Jacob wrote most of that piece I'll turn

1492
01:05:37,079 --> 01:05:38,040
it over to him and let him talk about

1493
01:05:38,040 --> 01:05:41,400
how we encoded the data into DNS

1494
01:05:41,400 --> 01:05:43,440
so we wanted to make sure is that you

1495
01:05:43,440 --> 01:05:45,720
could push this one token out across

1496
01:05:45,720 --> 01:05:47,520
your entire organization and not have to

1497
01:05:47,520 --> 01:05:49,980
get one uniquely for every computer so

1498
01:05:49,980 --> 01:05:51,180
we wanted to be able to dynamically

1499
01:05:51,180 --> 01:05:52,680
connect the username and the computer

1500
01:05:52,680 --> 01:05:56,099
name and then push that out over DNS so

1501
01:05:56,099 --> 01:05:57,900
we had done some of this in the past so

1502
01:05:57,900 --> 01:06:00,119
this is from the generic DNS token

1503
01:06:00,119 --> 01:06:02,400
documentation where essentially you can

1504
01:06:02,400 --> 01:06:06,420
base 32 and code any arbitrary string so

1505
01:06:06,420 --> 01:06:08,400
base 32 if you're not familiar like I

1506
01:06:08,400 --> 01:06:10,799
wasn't until I read this is like base64

1507
01:06:10,799 --> 01:06:12,900
it's a little bit less efficient but

1508
01:06:12,900 --> 01:06:15,000
it's case insensitive and so domain

1509
01:06:15,000 --> 01:06:17,099
names are also case insensitive and so

1510
01:06:17,099 --> 01:06:18,180
this is basically a way that you could

1511
01:06:18,180 --> 01:06:20,099
just pack any information you have to

1512
01:06:20,099 --> 01:06:21,599
split it up because the domain names

1513
01:06:21,599 --> 01:06:23,520
have to be less or subdomains have to be

1514
01:06:23,520 --> 01:06:26,280
less than 64 bytes and then you can kind

1515
01:06:26,280 --> 01:06:28,079
of append this G in there and then that

1516
01:06:28,079 --> 01:06:30,000
will give you on a generic DNS token

1517
01:06:30,000 --> 01:06:32,220
that information so we were thinking

1518
01:06:32,220 --> 01:06:34,099
okay maybe we can do something like that

1519
01:06:34,099 --> 01:06:36,480
and create a way to be able to encode

1520
01:06:36,480 --> 01:06:39,000
the computer name and the username along

1521
01:06:39,000 --> 01:06:40,559
with that so that would be able to kind

1522
01:06:40,559 --> 01:06:42,299
of keep that generic push it out across

1523
01:06:42,299 --> 01:06:43,859
the entire organization

1524
01:06:43,859 --> 01:06:46,319
so we pretty quickly ran into issues

1525
01:06:46,319 --> 01:06:49,038
where there's either

1526
01:08:32,640 --> 01:08:34,819
foreign

1527
01:14:17,040 --> 01:14:19,260
add some additional context in the memo

1528
01:14:19,260 --> 01:14:20,940
field so that you know how to respond if

1529
01:14:20,940 --> 01:14:23,040
this alert ever fires so we create an

1530
01:14:23,040 --> 01:14:24,480
email we create a memo and then we

1531
01:14:24,480 --> 01:14:25,920
Define the executable so here we're

1532
01:14:25,920 --> 01:14:28,260
saying when NL test runs we want an

1533
01:14:28,260 --> 01:14:31,739
alert that contains that memo field

1534
01:14:31,739 --> 01:14:34,739
and then our site will create a registry

1535
01:14:34,739 --> 01:14:37,020
file for you so a DOT reg file you can

1536
01:14:37,020 --> 01:14:39,000
download the reg file and then import it

1537
01:14:39,000 --> 01:14:40,500
so let's take a look at what's happening

1538
01:14:40,500 --> 01:14:42,199
like what are we changing on the system

1539
01:14:42,199 --> 01:14:45,360
it's actually really easy uh in terms of

1540
01:14:45,360 --> 01:14:46,860
there's really three registry keys that

1541
01:14:46,860 --> 01:14:48,239
are set and I'll break these down in

1542
01:14:48,239 --> 01:14:49,800
future slides but essentially we're

1543
01:14:49,800 --> 01:14:51,900
going to set an image file execution

1544
01:14:51,900 --> 01:14:53,640
option that's going to match the name of

1545
01:14:53,640 --> 01:14:55,620
the executable so if attackers are

1546
01:14:55,620 --> 01:14:57,659
renaming files and running them these

1547
01:14:57,659 --> 01:14:59,219
alerts won't fire but if attackers are

1548
01:14:59,219 --> 01:15:01,020
renaming files in your environment there

1549
01:15:01,020 --> 01:15:02,520
may be other problems happening as well

1550
01:15:02,520 --> 01:15:04,980
so then we're going to also set up NL

1551
01:15:04,980 --> 01:15:06,600
test and we're going to set a flag and

1552
01:15:06,600 --> 01:15:09,480
then the actual command that uh actually

1553
01:15:09,480 --> 01:15:12,540
you know reduces the user and hostname

1554
01:15:12,540 --> 01:15:15,179
down to a DNS query so we use resolve

1555
01:15:15,179 --> 01:15:18,000
DNS name and Powershell

1556
01:15:18,000 --> 01:15:19,679
so the technique first of all you're

1557
01:15:19,679 --> 01:15:21,239
going to turn on the silent process

1558
01:15:21,239 --> 01:15:23,580
monitoring exit and you're going to set

1559
01:15:23,580 --> 01:15:25,679
the flag with 200 and that it just

1560
01:15:25,679 --> 01:15:27,960
enables that when you actually run this

1561
01:15:27,960 --> 01:15:29,640
command something will run in the

1562
01:15:29,640 --> 01:15:32,580
background there's three options for

1563
01:15:32,580 --> 01:15:35,159
that reporting mode uh and so we're

1564
01:15:35,159 --> 01:15:37,380
actually using reporting mode number one

1565
01:15:37,380 --> 01:15:40,140
which is launch a process so this thing

1566
01:15:40,140 --> 01:15:42,120
runs then do something else those of you

1567
01:15:42,120 --> 01:15:43,620
who do like red teaming and offensive

1568
01:15:43,620 --> 01:15:45,420
research I think you might find a local

1569
01:15:45,420 --> 01:15:47,940
dump interesting like process runs and

1570
01:15:47,940 --> 01:15:49,679
exits and before it exits it takes a

1571
01:15:49,679 --> 01:15:50,760
memory capture but we're not going to

1572
01:15:50,760 --> 01:15:51,960
talk about that today we're focusing

1573
01:15:51,960 --> 01:15:54,060
just on the launch a process you can

1574
01:15:54,060 --> 01:15:56,699
also notify the user and so you can mask

1575
01:15:56,699 --> 01:15:58,199
those if you wanted to combine some of

1576
01:15:58,199 --> 01:15:59,880
those so like a little pop-up we decided

1577
01:15:59,880 --> 01:16:01,380
not to do that

1578
01:16:01,380 --> 01:16:03,120
and then this was really the heart of

1579
01:16:03,120 --> 01:16:05,699
the alert is when your command that

1580
01:16:05,699 --> 01:16:08,400
you've identified runs specify this

1581
01:16:08,400 --> 01:16:10,380
command line and so this will allow us

1582
01:16:10,380 --> 01:16:13,560
to run our Powershell resolve DNS to the

1583
01:16:13,560 --> 01:16:15,900
canary token ID

1584
01:16:15,900 --> 01:16:17,340
and so what we've been able to do here

1585
01:16:17,340 --> 01:16:20,400
is really take an attacker or debug uh

1586
01:16:20,400 --> 01:16:22,380
technique and then use it to silently

1587
01:16:22,380 --> 01:16:24,719
alert when that executable runs and this

1588
01:16:24,719 --> 01:16:26,460
is what the alert would look like in an

1589
01:16:26,460 --> 01:16:28,980
email you would actually be able to see

1590
01:16:28,980 --> 01:16:30,659
inside of there the memo field your

1591
01:16:30,659 --> 01:16:33,000
token reminder you would see the source

1592
01:16:33,000 --> 01:16:34,800
IP now remember that Source IP is going

1593
01:16:34,800 --> 01:16:36,780
to be where the DNS lookup came from so

1594
01:16:36,780 --> 01:16:38,159
it's not as reliable as far as that's

1595
01:16:38,159 --> 01:16:40,679
not from the host DNS has a lot of

1596
01:16:40,679 --> 01:16:43,199
fragmented paths it can take but what's

1597
01:16:43,199 --> 01:16:45,600
important is inside of the actual alert

1598
01:16:45,600 --> 01:16:47,960
here at the bottom you can actually see

1599
01:16:47,960 --> 01:16:50,520
uh the username that executed the

1600
01:16:50,520 --> 01:16:52,560
command and the hostname and we've

1601
01:16:52,560 --> 01:16:54,780
compressed or reduced any of the

1602
01:16:54,780 --> 01:16:57,000
internet Echoes so to speaks like Jacob

1603
01:16:57,000 --> 01:16:58,260
talked about there's a way that we can

1604
01:16:58,260 --> 01:17:00,900
reduce the the noise so you get just a

1605
01:17:00,900 --> 01:17:02,150
single alert

1606
01:17:02,150 --> 01:17:03,480
[Music]

1607
01:17:03,480 --> 01:17:05,580
if you wanted to confirm this or if you

1608
01:17:05,580 --> 01:17:07,620
wanted to validate execution using other

1609
01:17:07,620 --> 01:17:09,840
systems or cross verify there are

1610
01:17:09,840 --> 01:17:12,000
windows 4688 events or you can see the

1611
01:17:12,000 --> 01:17:13,640
ID in L test

1612
01:17:13,640 --> 01:17:15,420
these would be things you would need to

1613
01:17:15,420 --> 01:17:17,219
configure independent of the token these

1614
01:17:17,219 --> 01:17:19,440
are just ideas for incident responders

1615
01:17:19,440 --> 01:17:20,699
and other research that you might want

1616
01:17:20,699 --> 01:17:22,020
to look at

1617
01:17:22,020 --> 01:17:23,340
the other thing that's interesting is

1618
01:17:23,340 --> 01:17:26,820
when silent process monitor exit runs or

1619
01:17:26,820 --> 01:17:28,800
process exit monitor runs it creates an

1620
01:17:28,800 --> 01:17:31,920
event ID 3000 in the application log so

1621
01:17:31,920 --> 01:17:33,120
this is also another really good

1622
01:17:33,120 --> 01:17:34,980
indicator that this technique is being

1623
01:17:34,980 --> 01:17:37,320
used either by you or by an attacker for

1624
01:17:37,320 --> 01:17:39,600
persistence or by a developer just

1625
01:17:39,600 --> 01:17:41,280
debugging some process you kind of have

1626
01:17:41,280 --> 01:17:42,960
to know the differences within your own

1627
01:17:42,960 --> 01:17:45,560
organization

1628
01:17:45,659 --> 01:17:47,760
in order to run this you do need to be

1629
01:17:47,760 --> 01:17:49,080
administrator because we're changing the

1630
01:17:49,080 --> 01:17:51,719
local machine part of the registry uh

1631
01:17:51,719 --> 01:17:54,120
after you run the command you can reuse

1632
01:17:54,120 --> 01:17:56,820
this reg file on multiple machines and

1633
01:17:56,820 --> 01:17:58,440
any execution will then give you the

1634
01:17:58,440 --> 01:18:00,360
username and hostname over DNS we talked

1635
01:18:00,360 --> 01:18:02,520
about that

1636
01:18:02,520 --> 01:18:05,520
now what makes a good candidate exe so

1637
01:18:05,520 --> 01:18:07,800
really they're short run so things like

1638
01:18:07,800 --> 01:18:11,280
who am I in L test k-list one thing I

1639
01:18:11,280 --> 01:18:12,420
want to call out here that's important

1640
01:18:12,420 --> 01:18:13,679
is the program doesn't need to be

1641
01:18:13,679 --> 01:18:15,239
present on the machine so let's say your

1642
01:18:15,239 --> 01:18:18,719
organization never uses PS exec so one

1643
01:18:18,719 --> 01:18:21,120
use case for this is you can create this

1644
01:18:21,120 --> 01:18:23,820
uh sensitive command token for PS exec

1645
01:18:23,820 --> 01:18:26,100
and if PS exec ever shows up anywhere in

1646
01:18:26,100 --> 01:18:27,420
your network you'll get an alert now

1647
01:18:27,420 --> 01:18:29,280
whether that's sanctioned used by an

1648
01:18:29,280 --> 01:18:30,840
admin but you may want to know about

1649
01:18:30,840 --> 01:18:33,120
that so as long as it matches the file

1650
01:18:33,120 --> 01:18:34,500
name you would actually be alerted to

1651
01:18:34,500 --> 01:18:36,659
that so without any any third-party

1652
01:18:36,659 --> 01:18:38,040
software being installed sometimes you

1653
01:18:38,040 --> 01:18:39,360
have systems in an environment that are

1654
01:18:39,360 --> 01:18:40,620
Legacy or they've gone out of support

1655
01:18:40,620 --> 01:18:42,900
you may not be able to install software

1656
01:18:42,900 --> 01:18:44,760
but you still need a like a high

1657
01:18:44,760 --> 01:18:46,739
fidelity alert on some system like if

1658
01:18:46,739 --> 01:18:49,199
someone runs NL test from our MRI

1659
01:18:49,199 --> 01:18:51,179
machine we may want to know about that

1660
01:18:51,179 --> 01:18:52,560
or you know the other environments that

1661
01:18:52,560 --> 01:18:54,300
may not be able to install third-party

1662
01:18:54,300 --> 01:18:57,120
software on Windows systems it could be

1663
01:18:57,120 --> 01:18:58,739
a use case we're also open to hearing

1664
01:18:58,739 --> 01:19:00,960
about use cases that you are using in

1665
01:19:00,960 --> 01:19:02,040
your environments as well so we

1666
01:19:02,040 --> 01:19:03,960
encourage you to test this

1667
01:19:03,960 --> 01:19:06,179
so again the same registry file will run

1668
01:19:06,179 --> 01:19:09,480
or work across multiple systems and it's

1669
01:19:09,480 --> 01:19:11,880
just a lightweight alert not trying to

1670
01:19:11,880 --> 01:19:15,179
replace or uh you know substitute

1671
01:19:15,179 --> 01:19:16,920
anti-malware techniques but you could

1672
01:19:16,920 --> 01:19:18,900
use EDR to Baseline and say how

1673
01:19:18,900 --> 01:19:20,460
frequently does this particular command

1674
01:19:20,460 --> 01:19:22,080
run

1675
01:19:22,080 --> 01:19:24,179
all right so we've been talking a lot so

1676
01:19:24,179 --> 01:19:27,179
let's do a quick demo so I'll kind of

1677
01:19:27,179 --> 01:19:28,260
walk you through this so you can see

1678
01:19:28,260 --> 01:19:29,200
what it looks like

1679
01:19:29,200 --> 01:19:31,739
[Music]

1680
01:19:31,739 --> 01:19:35,280
so here we'll start by

1681
01:19:35,280 --> 01:19:38,100
looking at a threat report so we read

1682
01:19:38,100 --> 01:19:40,140
the threat report and we see NL tests

1683
01:19:40,140 --> 01:19:42,239
all over the place so we're going to go

1684
01:19:42,239 --> 01:19:44,159
ahead and spot the command of interest

1685
01:19:44,159 --> 01:19:46,980
and we can see in our test it doesn't

1686
01:19:46,980 --> 01:19:48,600
get the command line parameters as well

1687
01:19:48,600 --> 01:19:50,159
just remember this is just the execution

1688
01:19:50,159 --> 01:19:52,140
of that process

1689
01:19:52,140 --> 01:19:53,580
and then we go in and create the

1690
01:19:53,580 --> 01:19:55,199
sensitive command token we've got a

1691
01:19:55,199 --> 01:19:57,120
bunch of other tokens out there

1692
01:19:57,120 --> 01:19:59,280
and inside of this token we'll add our

1693
01:19:59,280 --> 01:20:02,280
email address we'll add our memo field

1694
01:20:02,280 --> 01:20:04,320
to remind us what happens when this

1695
01:20:04,320 --> 01:20:06,120
particular alert fires

1696
01:20:06,120 --> 01:20:09,600
and then we'll specify the process that

1697
01:20:09,600 --> 01:20:11,940
we want to monitor now we've had some

1698
01:20:11,940 --> 01:20:14,460
feedback on this for now right now it's

1699
01:20:14,460 --> 01:20:17,760
just a single process per token so

1700
01:20:17,760 --> 01:20:20,760
run NL test create the token now we've

1701
01:20:20,760 --> 01:20:22,500
got our registry file we can go ahead

1702
01:20:22,500 --> 01:20:25,440
and download the registry

1703
01:20:25,440 --> 01:20:27,239
and from here

1704
01:20:27,239 --> 01:20:28,800
we can then go to the machine and I'll

1705
01:20:28,800 --> 01:20:31,320
just run a quick check running in L test

1706
01:20:31,320 --> 01:20:34,260
we're not going to see any activity yet

1707
01:20:34,260 --> 01:20:36,600
have it installed it no alerts going to

1708
01:20:36,600 --> 01:20:39,540
fire yet so once we're ready to import

1709
01:20:39,540 --> 01:20:42,540
this registry file

1710
01:20:42,540 --> 01:20:43,980
go ahead and just import it from the

1711
01:20:43,980 --> 01:20:46,140
downloads folder

1712
01:20:46,140 --> 01:20:47,640
same command again requires

1713
01:20:47,640 --> 01:20:49,440
administrative rights just pass the

1714
01:20:49,440 --> 01:20:51,000
registry file name you could rename that

1715
01:20:51,000 --> 01:20:52,679
file too the unique name doesn't doesn't

1716
01:20:52,679 --> 01:20:54,480
matter what matters is the contents of

1717
01:20:54,480 --> 01:20:56,219
the file

1718
01:20:56,219 --> 01:20:58,739
go ahead and run NL test

1719
01:20:58,739 --> 01:21:00,840
even with just a help

1720
01:21:00,840 --> 01:21:03,000
in the background what happened was on

1721
01:21:03,000 --> 01:21:04,860
this website you can go to manage token

1722
01:21:04,860 --> 01:21:06,600
some people will bookmark this we can

1723
01:21:06,600 --> 01:21:08,820
see now we've got a trigger alert

1724
01:21:08,820 --> 01:21:10,440
and we can actually go in and look at

1725
01:21:10,440 --> 01:21:12,239
the incident in our website we've got

1726
01:21:12,239 --> 01:21:14,820
some GPS data about where the source IP

1727
01:21:14,820 --> 01:21:17,040
was so again not always indicative of

1728
01:21:17,040 --> 01:21:19,620
where that host was so we've got some

1729
01:21:19,620 --> 01:21:22,280
good information that this particular

1730
01:21:22,280 --> 01:21:24,659
executable was run and we can actually

1731
01:21:24,659 --> 01:21:27,000
see there's our cactuscon Windows 11 our

1732
01:21:27,000 --> 01:21:29,159
users mobile we could validate that on

1733
01:21:29,159 --> 01:21:31,020
this host just by running again who am I

1734
01:21:31,020 --> 01:21:33,179
there's the hostname as well just to

1735
01:21:33,179 --> 01:21:35,100
validate that that was that host that

1736
01:21:35,100 --> 01:21:37,679
command so that's kind of the idea you

1737
01:21:37,679 --> 01:21:40,140
deploy that registry key somebody runs

1738
01:21:40,140 --> 01:21:43,580
that command you get a tip off

1739
01:21:43,620 --> 01:21:46,320
all right

1740
01:21:46,320 --> 01:21:48,960
so we're kind of wrapping up here so I

1741
01:21:48,960 --> 01:21:50,340
want to just kind of recap some of the

1742
01:21:50,340 --> 01:21:52,500
closing thoughts here we've got

1743
01:21:52,500 --> 01:21:54,239
um you know we can repurpose this

1744
01:21:54,239 --> 01:21:56,100
developer attacker technique that was

1745
01:21:56,100 --> 01:21:57,540
used for persistence or malware

1746
01:21:57,540 --> 01:22:00,780
execution create one registry key deploy

1747
01:22:00,780 --> 01:22:02,520
it to many machines and dynamically over

1748
01:22:02,520 --> 01:22:04,560
time resolve a username and computer

1749
01:22:04,560 --> 01:22:06,960
name so I'd love for people to test it

1750
01:22:06,960 --> 01:22:08,340
and give us feedback how it works we've

1751
01:22:08,340 --> 01:22:10,679
had really positive feedback so far and

1752
01:22:10,679 --> 01:22:12,060
we're curious how other people might use

1753
01:22:12,060 --> 01:22:14,400
it or ways we can continue to improve

1754
01:22:14,400 --> 01:22:16,920
this token

1755
01:22:16,920 --> 01:22:18,960
huge shout out to the team again when we

1756
01:22:18,960 --> 01:22:21,780
talk about going from this concept of we

1757
01:22:21,780 --> 01:22:23,280
want to run this command to get an alert

1758
01:22:23,280 --> 01:22:25,080
actually putting it on the website

1759
01:22:25,080 --> 01:22:27,360
creating the registry file team effort

1760
01:22:27,360 --> 01:22:29,040
so a huge shout out to the other folks

1761
01:22:29,040 --> 01:22:30,840
on our uh engineering team that helped

1762
01:22:30,840 --> 01:22:32,760
us land this one

1763
01:22:32,760 --> 01:22:35,159
a few resources that we like that our

1764
01:22:35,159 --> 01:22:36,960
team's learning organization so we like

1765
01:22:36,960 --> 01:22:39,060
to read a lot of books and resources

1766
01:22:39,060 --> 01:22:41,219
some that I've put here there's a Blog

1767
01:22:41,219 --> 01:22:42,900
write up about this token creating it

1768
01:22:42,900 --> 01:22:45,780
and other use cases if you want to read

1769
01:22:45,780 --> 01:22:47,699
more about that some of the books that

1770
01:22:47,699 --> 01:22:49,500
we like skunk works or write kind of

1771
01:22:49,500 --> 01:22:51,659
crazy or loon shots these are some

1772
01:22:51,659 --> 01:22:53,280
really good books about the intersection

1773
01:22:53,280 --> 01:22:56,040
of research and engineering and other

1774
01:22:56,040 --> 01:22:57,840
domains not necessarily cyber security

1775
01:22:57,840 --> 01:23:01,739
so we got through that in good timing so

1776
01:23:01,739 --> 01:23:03,360
I want to then open it up here and see

1777
01:23:03,360 --> 01:23:05,219
if there's any questions or comments or

1778
01:23:05,219 --> 01:23:08,460
feedback at this point so

1779
01:23:08,460 --> 01:23:11,060
question

1780
01:23:11,159 --> 01:23:13,759
nope

1781
01:23:19,679 --> 01:23:21,480
um do you know how to get the original

1782
01:23:21,480 --> 01:23:23,940
host that made a DNS request

1783
01:23:23,940 --> 01:23:25,920
from uh from our from our Command or

1784
01:23:25,920 --> 01:23:27,239
from just like

1785
01:23:27,239 --> 01:23:29,760
um like the history of the lookup

1786
01:23:29,760 --> 01:23:32,460
uh I guess just in general like that um

1787
01:23:32,460 --> 01:23:35,040
that Source IP just shows the DNS server

1788
01:23:35,040 --> 01:23:36,480
I was wondering if there's any other

1789
01:23:36,480 --> 01:23:38,460
analytics you could do

1790
01:23:38,460 --> 01:23:40,860
um to get the original host it could it

1791
01:23:40,860 --> 01:23:43,020
would depend um but since since it's

1792
01:23:43,020 --> 01:23:44,780
coming back to us uh on our

1793
01:23:44,780 --> 01:23:46,679
canarytokens.org where that command it's

1794
01:23:46,679 --> 01:23:48,780
it's hard to see where that originated

1795
01:23:48,780 --> 01:23:50,400
from so we really just see the source IP

1796
01:23:50,400 --> 01:23:51,840
of the DNS server I don't know if you've

1797
01:23:51,840 --> 01:23:53,400
seen something in your in your

1798
01:23:53,400 --> 01:23:55,020
organization depending on how you set up

1799
01:23:55,020 --> 01:23:56,580
if you're running something like Cisco

1800
01:23:56,580 --> 01:23:58,620
umbrella and you're putting all the DNS

1801
01:23:58,620 --> 01:24:00,480
through if you were able to look at that

1802
01:24:00,480 --> 01:24:02,580
request and you know the command you see

1803
01:24:02,580 --> 01:24:03,780
that trigger and you're like oh which

1804
01:24:03,780 --> 01:24:05,219
computer was that I mean your office

1805
01:24:05,219 --> 01:24:06,960
you're gonna get the computer name then

1806
01:24:06,960 --> 01:24:09,000
you can use a passive DNS lookup and say

1807
01:24:09,000 --> 01:24:12,300
which IP address looked up that and then

1808
01:24:12,300 --> 01:24:13,920
you can be able to go and get more more

1809
01:24:13,920 --> 01:24:16,199
data but that depends on how your

1810
01:24:16,199 --> 01:24:18,060
organization is set up if everyone is

1811
01:24:18,060 --> 01:24:20,340
using whatever their favorite DNS server

1812
01:24:20,340 --> 01:24:21,960
is you're going to lose that ability to

1813
01:24:21,960 --> 01:24:23,820
get that visibility so you'd have to go

1814
01:24:23,820 --> 01:24:25,679
off of computer name

1815
01:24:25,679 --> 01:24:29,480
thanks good question

1816
01:24:30,840 --> 01:24:32,100
just a quick question about

1817
01:24:32,100 --> 01:24:33,659
operationalizing this on The Blue Team

1818
01:24:33,659 --> 01:24:34,980
side I'm wondering if you can deploy

1819
01:24:34,980 --> 01:24:37,380
that registry file via GPO or something

1820
01:24:37,380 --> 01:24:39,120
similar okay yes absolutely absolutely

1821
01:24:39,120 --> 01:24:41,520
yeah whatever whatever a GPO is a common

1822
01:24:41,520 --> 01:24:42,540
feedback we've heard as far as

1823
01:24:42,540 --> 01:24:44,100
deployment across multiple sites so the

1824
01:24:44,100 --> 01:24:45,540
question was you know could we use GPO

1825
01:24:45,540 --> 01:24:47,040
to deploy that register key absolutely

1826
01:24:47,040 --> 01:24:49,400
yep

1827
01:24:50,580 --> 01:24:52,080
are you guys thinking about implementing

1828
01:24:52,080 --> 01:24:54,659
like DNS or TLS so you know it could

1829
01:24:54,659 --> 01:24:57,000
actually uh you know obfuscate some of

1830
01:24:57,000 --> 01:24:58,560
that information from the user side and

1831
01:24:58,560 --> 01:25:00,300
whatnot

1832
01:25:00,300 --> 01:25:02,340
yeah so we've had to implement it so our

1833
01:25:02,340 --> 01:25:04,560
like main product at thinks is

1834
01:25:04,560 --> 01:25:06,300
essentially like a full system Honeypot

1835
01:25:06,300 --> 01:25:08,580
and that communicates over DNS to make

1836
01:25:08,580 --> 01:25:09,780
it very easy to deploy in your

1837
01:25:09,780 --> 01:25:11,280
environment without having to worry

1838
01:25:11,280 --> 01:25:13,440
about opening up ports and that supports

1839
01:25:13,440 --> 01:25:15,480
both DNS and DNS

1840
01:25:15,480 --> 01:25:17,820
um it's more about your organization as

1841
01:25:17,820 --> 01:25:19,440
some organizations just don't want that

1842
01:25:19,440 --> 01:25:20,820
because they want to be able to kind of

1843
01:25:20,820 --> 01:25:22,380
man in the middle and do you know DNS

1844
01:25:22,380 --> 01:25:23,940
reputation management

1845
01:25:23,940 --> 01:25:25,920
um so certainly something we could do

1846
01:25:25,920 --> 01:25:27,360
um and it's something that you know as

1847
01:25:27,360 --> 01:25:29,400
an organization you could have configure

1848
01:25:29,400 --> 01:25:31,739
your your OS to do that

1849
01:25:31,739 --> 01:25:34,560
um but uh yeah this is the most flexible

1850
01:25:34,560 --> 01:25:36,540
again that was a trade-off between HTTP

1851
01:25:36,540 --> 01:25:39,540
would be really easy DNS hopefully more

1852
01:25:39,540 --> 01:25:40,920
widely available yeah I was just

1853
01:25:40,920 --> 01:25:42,000
thinking about deploying this to like

1854
01:25:42,000 --> 01:25:43,679
work from home people where they you

1855
01:25:43,679 --> 01:25:45,540
know they're using their own stuff

1856
01:25:45,540 --> 01:25:46,920
yeah it's a really good question

1857
01:25:46,920 --> 01:25:48,300
something we could dive into more for

1858
01:25:48,300 --> 01:25:50,699
sure that's good

1859
01:25:50,699 --> 01:25:54,500
other questions comments

1860
01:25:56,100 --> 01:25:57,120
okay

1861
01:25:57,120 --> 01:26:00,920
wait oh sorry another question here

1862
01:26:06,000 --> 01:26:08,880
um it's uh where's that registry key go

1863
01:26:08,880 --> 01:26:10,860
on the system is it easy to keep track

1864
01:26:10,860 --> 01:26:12,900
of sure yeah it's a good question so the

1865
01:26:12,900 --> 01:26:14,040
question was where does the registry key

1866
01:26:14,040 --> 01:26:16,739
go let me uh let me jump to that back to

1867
01:26:16,739 --> 01:26:18,540
the actual

1868
01:26:18,540 --> 01:26:20,460
let me jump to that slide and show you

1869
01:26:20,460 --> 01:26:24,000
the uh we can look at the key real quick

1870
01:26:24,000 --> 01:26:26,699
it creates three keys I think they're

1871
01:26:26,699 --> 01:26:29,760
all in the same issue there yeah the

1872
01:26:29,760 --> 01:26:31,139
first one so the first one we'll go into

1873
01:26:31,139 --> 01:26:33,000
here you can see it goes into HQ local

1874
01:26:33,000 --> 01:26:35,159
machine under image file execution

1875
01:26:35,159 --> 01:26:38,340
options it's just the the binary name

1876
01:26:38,340 --> 01:26:40,620
that you're interested in and then so

1877
01:26:40,620 --> 01:26:43,860
the second two parameters go under a key

1878
01:26:43,860 --> 01:26:46,320
called Silent process exit and so that's

1879
01:26:46,320 --> 01:26:48,120
where you actually have the reporting

1880
01:26:48,120 --> 01:26:49,800
mode and the command you want to run

1881
01:26:49,800 --> 01:26:51,840
when that runs so between those two keys

1882
01:26:51,840 --> 01:26:53,820
and you could easily just remove those

1883
01:26:53,820 --> 01:26:55,560
two keys and then you've removed the

1884
01:26:55,560 --> 01:26:58,320
this particular token yep good question

1885
01:26:58,320 --> 01:27:01,280
thanks yep

1886
01:27:01,980 --> 01:27:05,040
question in the back

1887
01:27:05,040 --> 01:27:06,719
Karma

1888
01:27:06,719 --> 01:27:09,780
so you would

1889
01:27:09,780 --> 01:27:13,620
um for DNS options well so like so

1890
01:27:13,620 --> 01:27:15,179
um we have clients that run multiple

1891
01:27:15,179 --> 01:27:16,860
domains so like we have multiple sites

1892
01:27:16,860 --> 01:27:18,480
multiple domains that sort of thing are

1893
01:27:18,480 --> 01:27:19,500
just thinking like so you're only

1894
01:27:19,500 --> 01:27:21,900
collecting like hostname

1895
01:27:21,900 --> 01:27:22,920
um you're not really collecting like

1896
01:27:22,920 --> 01:27:26,580
what domain a particular machine's on

1897
01:27:26,580 --> 01:27:28,040
um I mean have you thought about

1898
01:27:28,040 --> 01:27:29,760
implementing I understand you're kind of

1899
01:27:29,760 --> 01:27:32,340
limited on your DNS request but

1900
01:27:32,340 --> 01:27:34,440
it yeah it's a good it's a good question

1901
01:27:34,440 --> 01:27:36,120
yeah I mean you could do one that one

1902
01:27:36,120 --> 01:27:39,060
one idea would be a token per domain uh

1903
01:27:39,060 --> 01:27:40,500
and then make sure that in that memo

1904
01:27:40,500 --> 01:27:42,420
field you would say this is for you know

1905
01:27:42,420 --> 01:27:44,219
the West the East but but right now

1906
01:27:44,219 --> 01:27:45,780
correct it just gets the host name so

1907
01:27:45,780 --> 01:27:47,460
there would be a risk of if you have

1908
01:27:47,460 --> 01:27:49,080
host names in different parts of the

1909
01:27:49,080 --> 01:27:51,000
organization you could have collisions

1910
01:27:51,000 --> 01:27:52,800
there so if that's the case possibly

1911
01:27:52,800 --> 01:27:54,900
create other tokens or ensure you add

1912
01:27:54,900 --> 01:27:56,880
some context to that memo field

1913
01:27:56,880 --> 01:27:58,679
yeah it's a good question I think I mean

1914
01:27:58,679 --> 01:28:01,560
there is also there's engineering wise I

1915
01:28:01,560 --> 01:28:02,760
think there should be enough space if

1916
01:28:02,760 --> 01:28:04,320
you wanted to we could add another fee

1917
01:28:04,320 --> 01:28:05,699
like you could add another field in

1918
01:28:05,699 --> 01:28:07,260
front of the computer name username that

1919
01:28:07,260 --> 01:28:09,420
would be the domain name as well if that

1920
01:28:09,420 --> 01:28:11,100
was something that was

1921
01:28:11,100 --> 01:28:13,320
um yeah because my great feedback my

1922
01:28:13,320 --> 01:28:15,719
thought was like okay so we could embed

1923
01:28:15,719 --> 01:28:19,800
other variables possibly into that DNS

1924
01:28:19,800 --> 01:28:21,719
request and maybe have it read out so

1925
01:28:21,719 --> 01:28:24,300
yeah so the DNS like the generic DNS

1926
01:28:24,300 --> 01:28:25,800
allows you to put kind of generic data

1927
01:28:25,800 --> 01:28:27,120
in there and then we kind of you know

1928
01:28:27,120 --> 01:28:29,100
specialize that just to make the the

1929
01:28:29,100 --> 01:28:31,500
look of it whereas you know separate row

1930
01:28:31,500 --> 01:28:32,940
and the alert

1931
01:28:32,940 --> 01:28:34,139
um but that would be something that you

1932
01:28:34,139 --> 01:28:36,300
could add more to if you wanted to

1933
01:28:36,300 --> 01:28:38,040
um and definitely something it's all on

1934
01:28:38,040 --> 01:28:40,080
GitHub we'd love a pull request to add

1935
01:28:40,080 --> 01:28:41,760
that information as well

1936
01:28:41,760 --> 01:28:42,719
um if that's something that you're

1937
01:28:42,719 --> 01:28:44,880
looking for or if that's a use case that

1938
01:28:44,880 --> 01:28:46,139
we start hearing we look at you know

1939
01:28:46,139 --> 01:28:47,880
adding that as an optional feature as

1940
01:28:47,880 --> 01:28:50,060
well

1941
01:28:50,880 --> 01:28:52,880
foreign

1942
01:28:52,880 --> 01:28:55,020
all right well we'll be around for the

1943
01:28:55,020 --> 01:28:56,580
rest of the day so there's other

1944
01:28:56,580 --> 01:28:58,199
questions or we'll we can step out in

1945
01:28:58,199 --> 01:28:59,639
the hallway to the next room can get

1946
01:28:59,639 --> 01:29:01,139
ready for the next talk but uh thank you

1947
01:29:01,139 --> 01:29:02,340
so much for your time and look forward

1948
01:29:02,340 --> 01:29:04,940
to your feedback

1949
01:29:09,150 --> 01:29:14,900
[Music]

1950
01:29:14,900 --> 01:29:20,599
is good yeah I mean it's about 40 yeah

1951
01:46:49,820 --> 01:46:53,420
this thing sounds loud

1952
01:46:54,470 --> 01:47:01,860
[Music]

1953
01:47:02,219 --> 01:47:04,199
we're good

1954
01:47:04,199 --> 01:47:06,060
morning can you hear me okay everybody

1955
01:47:06,060 --> 01:47:09,540
yeah right on my name is Vincent my talk

1956
01:47:09,540 --> 01:47:13,580
is titled I came in like a wrecking ball

1957
01:47:14,940 --> 01:47:16,980
this talk is rated R because at some

1958
01:47:16,980 --> 01:47:20,119
point I'm going to drop an F-bomb

1959
01:47:20,639 --> 01:47:22,560
like to remind you that some things in

1960
01:47:22,560 --> 01:47:24,000
my talk would be considered criminal

1961
01:47:24,000 --> 01:47:25,320
activity should you not have the

1962
01:47:25,320 --> 01:47:27,780
permission from your targets

1963
01:47:27,780 --> 01:47:29,639
who am I

1964
01:47:29,639 --> 01:47:31,800
I'm a penetration tester I'm a small

1965
01:47:31,800 --> 01:47:34,619
business owner I'm an Air Force veteran

1966
01:47:34,619 --> 01:47:36,840
and when I'm not in front of a computer

1967
01:47:36,840 --> 01:47:38,400
I'm probably out in the desert training

1968
01:47:38,400 --> 01:47:41,460
for 100 mile ultra marathons

1969
01:47:41,460 --> 01:47:43,020
things are important to know about me

1970
01:47:43,020 --> 01:47:45,119
are that I've been in tech for over 30

1971
01:47:45,119 --> 01:47:46,139
years

1972
01:47:46,139 --> 01:47:47,760
I've been running a small technology

1973
01:47:47,760 --> 01:47:49,800
business for the last 20 years

1974
01:47:49,800 --> 01:47:52,139
it started off as a break fix it company

1975
01:47:52,139 --> 01:47:54,840
and about 10 years ago Cloud started

1976
01:47:54,840 --> 01:47:56,639
eating into that Revenue model and I

1977
01:47:56,639 --> 01:47:58,380
pivoted into security

1978
01:47:58,380 --> 01:48:00,960
I took the oscp course fell in love with

1979
01:48:00,960 --> 01:48:02,580
hacking and I've been doing that ever

1980
01:48:02,580 --> 01:48:04,820
since

1981
01:48:05,159 --> 01:48:06,179
so

1982
01:48:06,179 --> 01:48:08,280
this talks about my Adventures while

1983
01:48:08,280 --> 01:48:10,860
working with small businesses if you

1984
01:48:10,860 --> 01:48:13,320
think about big businesses

1985
01:48:13,320 --> 01:48:15,239
they have layers and layers of security

1986
01:48:15,239 --> 01:48:17,159
you know they have a sock they do

1987
01:48:17,159 --> 01:48:18,780
continuous phone scans they have red

1988
01:48:18,780 --> 01:48:21,540
teaming exercises pen tests they got big

1989
01:48:21,540 --> 01:48:23,460
bags of money and they throw it at that

1990
01:48:23,460 --> 01:48:26,040
problem small businesses are the little

1991
01:48:26,040 --> 01:48:28,580
hanging fruit

1992
01:48:28,619 --> 01:48:30,900
so it's story time

1993
01:48:30,900 --> 01:48:33,300
I always wonder what it's like

1994
01:48:33,300 --> 01:48:35,520
um to set up the infrastructure and to

1995
01:48:35,520 --> 01:48:38,639
hide your tracks as a malicious actor

1996
01:48:38,639 --> 01:48:40,920
um so big picture would be I would

1997
01:48:40,920 --> 01:48:42,900
probably want to hack some Wi-Fi because

1998
01:48:42,900 --> 01:48:45,480
privacy vpns

1999
01:48:45,480 --> 01:48:47,940
hack some servers set up C2

2000
01:48:47,940 --> 01:48:50,340
infrastructure and then go after my

2001
01:48:50,340 --> 01:48:52,199
target

2002
01:48:52,199 --> 01:48:53,820
so on my wish list I want some fake

2003
01:48:53,820 --> 01:48:55,739
accounts I want some burner laptops

2004
01:48:55,739 --> 01:48:58,199
won't burner phones for your stolen

2005
01:48:58,199 --> 01:49:00,179
Wi-Fi and then I'm going to use tour and

2006
01:49:00,179 --> 01:49:04,860
Tails and that privacy VPN

2007
01:49:04,860 --> 01:49:07,260
so privacy vpns are like we've got your

2008
01:49:07,260 --> 01:49:08,880
back we don't keep logs we're not

2009
01:49:08,880 --> 01:49:11,760
turning you over to law enforcement this

2010
01:49:11,760 --> 01:49:13,080
may

2011
01:49:13,080 --> 01:49:15,719
disagree with that uh this guy from low

2012
01:49:15,719 --> 01:49:18,300
set got popped because he was hacking

2013
01:49:18,300 --> 01:49:20,820
from his home and and uh hide my ass

2014
01:49:20,820 --> 01:49:24,060
sent the logs to the feds

2015
01:49:24,060 --> 01:49:26,280
um and then I was Googling around and

2016
01:49:26,280 --> 01:49:28,260
it's like can law enforcement get past a

2017
01:49:28,260 --> 01:49:29,880
VPN and the thing that stood out to me

2018
01:49:29,880 --> 01:49:31,560
was that

2019
01:49:31,560 --> 01:49:33,719
if you're in your home

2020
01:49:33,719 --> 01:49:36,239
and you're on tour and you're on a VPN

2021
01:49:36,239 --> 01:49:38,280
they can't see into that traffic but

2022
01:49:38,280 --> 01:49:40,619
they know you're using that and so with

2023
01:49:40,619 --> 01:49:42,719
the uh the VPN in particular they could

2024
01:49:42,719 --> 01:49:44,520
grab the IPS and then they could find

2025
01:49:44,520 --> 01:49:45,780
the provider and they can go twist the

2026
01:49:45,780 --> 01:49:48,119
arm of the provider so just a reminder

2027
01:49:48,119 --> 01:49:51,980
packing is a crime and don't do that

2028
01:49:52,139 --> 01:49:53,880
um I had this idea that I was going to

2029
01:49:53,880 --> 01:49:56,159
get a privacy VPN and I thought it would

2030
01:49:56,159 --> 01:49:58,020
be really cool to get a hardware wallet

2031
01:49:58,020 --> 01:49:59,940
and throw some crypto on it and then use

2032
01:49:59,940 --> 01:50:03,239
that to buy the VPN service

2033
01:50:03,239 --> 01:50:04,860
uh so I've never played with one of

2034
01:50:04,860 --> 01:50:06,060
these and I thought it'd be real really

2035
01:50:06,060 --> 01:50:07,920
cool for the talk so I fired it up and

2036
01:50:07,920 --> 01:50:09,600
you install the firmware and in many

2037
01:50:09,600 --> 01:50:12,060
many steps later this thing is set up

2038
01:50:12,060 --> 01:50:13,860
then I needed to figure out how I was

2039
01:50:13,860 --> 01:50:16,560
going to get crypto on this thing

2040
01:50:16,560 --> 01:50:18,840
and in my car I found this Starbucks

2041
01:50:18,840 --> 01:50:20,880
gift card that was like seven years old

2042
01:50:20,880 --> 01:50:23,699
and I checked the balance of that 25 and

2043
01:50:23,699 --> 01:50:25,440
VPN service was like 12. so I'm like

2044
01:50:25,440 --> 01:50:27,600
that works and I found this website

2045
01:50:27,600 --> 01:50:30,179
where you could trade that gift card for

2046
01:50:30,179 --> 01:50:31,500
Bitcoin

2047
01:50:31,500 --> 01:50:33,300
and I was like yeah this is great this

2048
01:50:33,300 --> 01:50:35,580
is working out like I want it right

2049
01:50:35,580 --> 01:50:37,199
so it turns out when I actually signed

2050
01:50:37,199 --> 01:50:39,179
up and I tried to do this it wanted my

2051
01:50:39,179 --> 01:50:41,639
ID it actually wanted me to send them a

2052
01:50:41,639 --> 01:50:44,100
copy of my driver's license and I was

2053
01:50:44,100 --> 01:50:46,500
like and then so I tried to get other

2054
01:50:46,500 --> 01:50:48,780
you know ways of getting Bitcoin and I

2055
01:50:48,780 --> 01:50:50,100
kept running into this thing and

2056
01:50:50,100 --> 01:50:51,840
basically what I'm running into is know

2057
01:50:51,840 --> 01:50:53,820
your customer and this is for anti-money

2058
01:50:53,820 --> 01:50:55,020
laundering

2059
01:50:55,020 --> 01:50:57,540
and at that point I felt like if I took

2060
01:50:57,540 --> 01:51:00,300
this to the next level well that kind of

2061
01:51:00,300 --> 01:51:02,900
describes it

2062
01:51:05,159 --> 01:51:09,480
so in a contest of opsec I was thinking

2063
01:51:09,480 --> 01:51:11,280
that is bad opsec I'm drawing attention

2064
01:51:11,280 --> 01:51:12,900
to myself and that is the opposite of

2065
01:51:12,900 --> 01:51:14,460
what I want to do

2066
01:51:14,460 --> 01:51:16,500
so I went back to my friends at molvat

2067
01:51:16,500 --> 01:51:18,659
because I love movad they take cash and

2068
01:51:18,659 --> 01:51:21,119
I think that's hilarious you take cash

2069
01:51:21,119 --> 01:51:23,219
you stick it in an envelope and you mail

2070
01:51:23,219 --> 01:51:25,260
it to Sweden and they give you VPN

2071
01:51:25,260 --> 01:51:27,780
service after about a week

2072
01:51:27,780 --> 01:51:29,280
yeah

2073
01:51:29,280 --> 01:51:30,960
so at this point I'm gonna go get an

2074
01:51:30,960 --> 01:51:33,060
account on mail.com now I'm not going to

2075
01:51:33,060 --> 01:51:35,219
fish from here because mail.com gets

2076
01:51:35,219 --> 01:51:37,260
gets quarantined but I'm going to use

2077
01:51:37,260 --> 01:51:39,239
this as a backup account and you can use

2078
01:51:39,239 --> 01:51:42,119
a really shitty disposable email like

2079
01:51:42,119 --> 01:51:45,420
that one from this website as the backup

2080
01:51:45,420 --> 01:51:47,820
email for mail.com

2081
01:51:47,820 --> 01:51:50,040
so you set it up and then they say hey

2082
01:51:50,040 --> 01:51:51,360
thanks for signing up

2083
01:51:51,360 --> 01:51:52,560
the next thing I'm going to do is I'm

2084
01:51:52,560 --> 01:51:53,760
going to go to LinkedIn and I'm going to

2085
01:51:53,760 --> 01:51:56,400
go to outlook.com now within the last

2086
01:51:56,400 --> 01:51:59,340
three months these two companies who are

2087
01:51:59,340 --> 01:52:01,199
owned by Microsoft

2088
01:52:01,199 --> 01:52:03,600
are now requiring an actual phone number

2089
01:52:03,600 --> 01:52:05,760
so you could basically just use an email

2090
01:52:05,760 --> 01:52:07,139
address and they would let you sit up

2091
01:52:07,139 --> 01:52:09,179
but you know it turns out that they want

2092
01:52:09,179 --> 01:52:10,860
to stop fake accounts and I've got a

2093
01:52:10,860 --> 01:52:12,239
[ __ ] ton of them

2094
01:52:12,239 --> 01:52:13,860
um

2095
01:52:13,860 --> 01:52:15,420
and so you need an actual phone number

2096
01:52:15,420 --> 01:52:17,159
so it can't be Google Voice it can't be

2097
01:52:17,159 --> 01:52:20,520
VoIP so then I really wanted to go down

2098
01:52:20,520 --> 01:52:22,380
this rabbit hole and so I went on eBay

2099
01:52:22,380 --> 01:52:25,199
and I bought an unlocked iPhone

2100
01:52:25,199 --> 01:52:29,040
so iPhone once Wi-Fi it wants an email

2101
01:52:29,040 --> 01:52:30,719
address and at that point I was like if

2102
01:52:30,719 --> 01:52:32,580
I set this up in my house they're

2103
01:52:32,580 --> 01:52:34,139
probably going to grab my SSID they're

2104
01:52:34,139 --> 01:52:35,280
going to send it back to the Mothership

2105
01:52:35,280 --> 01:52:37,980
again thinking about opsec

2106
01:52:37,980 --> 01:52:40,199
um and ultimately what I wanted to do is

2107
01:52:40,199 --> 01:52:42,719
I had this 99 cent mint mobile trial

2108
01:52:42,719 --> 01:52:44,340
where I can have seven days with an

2109
01:52:44,340 --> 01:52:45,719
actual phone number where I can set up a

2110
01:52:45,719 --> 01:52:48,420
[ __ ] ton of accounts in seven days

2111
01:52:48,420 --> 01:52:50,460
um but then I ran into this chicken and

2112
01:52:50,460 --> 01:52:52,500
egg situation where

2113
01:52:52,500 --> 01:52:54,960
in order to get the mint Mobile card

2114
01:52:54,960 --> 01:52:57,060
activated I needed the mint mobile app

2115
01:52:57,060 --> 01:52:59,040
in order to get the app I needed to get

2116
01:52:59,040 --> 01:53:00,900
in the Apple Store and in order to get

2117
01:53:00,900 --> 01:53:02,400
at the Apple Store I needed a phone

2118
01:53:02,400 --> 01:53:03,840
number

2119
01:53:03,840 --> 01:53:06,300
at that point I started questioning am I

2120
01:53:06,300 --> 01:53:09,540
really a hacker because

2121
01:53:09,540 --> 01:53:12,060
I got an iPhone and really I should have

2122
01:53:12,060 --> 01:53:13,380
got an Android it would have made it a

2123
01:53:13,380 --> 01:53:14,639
lot easier and I'm questioning my

2124
01:53:14,639 --> 01:53:17,400
choices because I am an iPhone user Mac

2125
01:53:17,400 --> 01:53:19,619
OS is my daily driver and sometimes I

2126
01:53:19,619 --> 01:53:23,059
use Nano instead of VI

2127
01:53:23,100 --> 01:53:26,520
so I'm sorry [ __ ] off hey first have fun

2128
01:53:26,520 --> 01:53:29,040
so

2129
01:53:29,040 --> 01:53:31,440
in the end I used another burner phone

2130
01:53:31,440 --> 01:53:33,840
that I bought in 2013 to go to Defcon

2131
01:53:33,840 --> 01:53:35,460
because hackers are scary and you need a

2132
01:53:35,460 --> 01:53:37,500
burner phone to Defcon and I installed

2133
01:53:37,500 --> 01:53:39,119
the mint Mobile on that and I ended up

2134
01:53:39,119 --> 01:53:41,040
getting it set up

2135
01:53:41,040 --> 01:53:43,860
so now I want to hack some Wi-Fi and

2136
01:53:43,860 --> 01:53:45,480
because sometimes I call myself a

2137
01:53:45,480 --> 01:53:48,000
security researcher

2138
01:53:48,000 --> 01:53:50,280
I fired up my flipper zero and I was

2139
01:53:50,280 --> 01:53:51,719
like I just got this a couple of months

2140
01:53:51,719 --> 01:53:53,100
ago and I'm like how cool would that to

2141
01:53:53,100 --> 01:53:55,500
be able to use this in my talk but it

2142
01:53:55,500 --> 01:53:58,020
turns out the Wi-Fi Dev board only talks

2143
01:53:58,020 --> 01:54:00,540
2.4 gigahertz so if I want to go hack

2144
01:54:00,540 --> 01:54:02,520
Wi-Fi back in the 90s then this is

2145
01:54:02,520 --> 01:54:06,119
awesome but that doesn't do me any good

2146
01:54:06,119 --> 01:54:08,639
so I fired up the Wi-Fi pineapple and if

2147
01:54:08,639 --> 01:54:10,139
you don't know what a pineapple is it

2148
01:54:10,139 --> 01:54:11,880
really automates the process of hacking

2149
01:54:11,880 --> 01:54:13,800
Wi-Fi and it's awesome

2150
01:54:13,800 --> 01:54:16,820
um oh I don't know what that is

2151
01:54:19,080 --> 01:54:21,600
so if you've never used a pineapple

2152
01:54:21,600 --> 01:54:23,400
you put it in Recon mode and two minutes

2153
01:54:23,400 --> 01:54:24,840
is a really good number because it'll go

2154
01:54:24,840 --> 01:54:26,400
out there it'll grab access points and

2155
01:54:26,400 --> 01:54:28,500
it'll grab connect devices any shorter

2156
01:54:28,500 --> 01:54:30,060
than that and you probably won't get a

2157
01:54:30,060 --> 01:54:31,560
lot of connected devices any longer than

2158
01:54:31,560 --> 01:54:32,760
that you're just going to curate more

2159
01:54:32,760 --> 01:54:35,040
information uh so I let this go for two

2160
01:54:35,040 --> 01:54:36,960
minutes I get an access point I get a

2161
01:54:36,960 --> 01:54:39,300
couple of connected devices and then

2162
01:54:39,300 --> 01:54:40,739
what we want to do is we want to start a

2163
01:54:40,739 --> 01:54:42,000
capture and we're looking for the

2164
01:54:42,000 --> 01:54:43,739
handshake

2165
01:54:43,739 --> 01:54:46,320
so at this point you could hit the D

2166
01:54:46,320 --> 01:54:49,199
auth button not a lawyer think hitting

2167
01:54:49,199 --> 01:54:51,119
the d off button without permission is a

2168
01:54:51,119 --> 01:54:53,100
crime

2169
01:54:53,100 --> 01:54:54,540
um but if you really just want to

2170
01:54:54,540 --> 01:54:55,980
capture handshakes you can go early in

2171
01:54:55,980 --> 01:54:57,540
the morning and you can hang out when

2172
01:54:57,540 --> 01:54:58,860
everybody comes into the office you're

2173
01:54:58,860 --> 01:55:00,540
going to capture those handshakes

2174
01:55:00,540 --> 01:55:02,820
so I get my handshake

2175
01:55:02,820 --> 01:55:05,580
I download the pcap uh we run this

2176
01:55:05,580 --> 01:55:08,580
utility to convert it to hashcat

2177
01:55:08,580 --> 01:55:09,480
if you didn't know what you're looking

2178
01:55:09,480 --> 01:55:11,340
for you could go to hashcad examplesite

2179
01:55:11,340 --> 01:55:13,080
we would find out that it is version or

2180
01:55:13,080 --> 01:55:15,960
mode 2500

2181
01:55:15,960 --> 01:55:18,600
and 2500 is deprecated and they say 22

2182
01:55:18,600 --> 01:55:20,280
000 and 22 000 doesn't work I can tell

2183
01:55:20,280 --> 01:55:22,500
you that and you can do deprecated check

2184
01:55:22,500 --> 01:55:24,360
disable and if they have a really shitty

2185
01:55:24,360 --> 01:55:27,300
password which they did we crack it

2186
01:55:27,300 --> 01:55:30,239
so at that point we've got you know kind

2187
01:55:30,239 --> 01:55:32,400
of where we're gonna hack from and we're

2188
01:55:32,400 --> 01:55:33,840
looking for infrastructure so I'm ready

2189
01:55:33,840 --> 01:55:34,980
for my attack

2190
01:55:34,980 --> 01:55:37,560
and now I'm looking on the internet and

2191
01:55:37,560 --> 01:55:39,179
this is literally last week I found log

2192
01:55:39,179 --> 01:55:41,100
4J so there's no shortage of [ __ ] on the

2193
01:55:41,100 --> 01:55:42,719
internet that I can compromise and make

2194
01:55:42,719 --> 01:55:45,540
my C2 server and if there wasn't log4j

2195
01:55:45,540 --> 01:55:47,400
there's always WordPress I love

2196
01:55:47,400 --> 01:55:49,080
WordPress

2197
01:55:49,080 --> 01:55:52,440
you should all run WordPress

2198
01:55:52,440 --> 01:55:54,179
so at this point this is how I felt like

2199
01:55:54,179 --> 01:55:55,500
I'm in the middle of this and I've got

2200
01:55:55,500 --> 01:55:58,199
my C2 infrastructure I'm going to start

2201
01:55:58,199 --> 01:55:59,820
my phishing campaign

2202
01:55:59,820 --> 01:56:03,060
now I run phishing campaigns for offense

2203
01:56:03,060 --> 01:56:05,400
and defense and on the defensive side

2204
01:56:05,400 --> 01:56:07,380
it's simulation right so these are kind

2205
01:56:07,380 --> 01:56:09,000
of like the you know the ghetto fish

2206
01:56:09,000 --> 01:56:10,820
it's like you know here's this you know

2207
01:56:10,820 --> 01:56:13,860
LDH instead of DHL email and click this

2208
01:56:13,860 --> 01:56:15,480
link

2209
01:56:15,480 --> 01:56:19,080
and I uh I find that clients really

2210
01:56:19,080 --> 01:56:20,460
don't understand the importance of this

2211
01:56:20,460 --> 01:56:21,719
and this is literally their security

2212
01:56:21,719 --> 01:56:24,119
education uh somebody in the company got

2213
01:56:24,119 --> 01:56:26,100
fished and then they said oh we want you

2214
01:56:26,100 --> 01:56:28,440
to run simulation and so instead of

2215
01:56:28,440 --> 01:56:30,179
running an actual you know training

2216
01:56:30,179 --> 01:56:31,679
program they just sent out this email it

2217
01:56:31,679 --> 01:56:33,360
says over the past few months we've been

2218
01:56:33,360 --> 01:56:35,460
running an internal fishing campaign has

2219
01:56:35,460 --> 01:56:36,719
been brought to my attention that we've

2220
01:56:36,719 --> 01:56:38,400
had some pretty close calls so

2221
01:56:38,400 --> 01:56:40,739
continuing that education is don't click

2222
01:56:40,739 --> 01:56:42,300
on links can't [ __ ] make this up

2223
01:56:42,300 --> 01:56:45,060
seriously and then this is the kind of

2224
01:56:45,060 --> 01:56:46,800
you know low budget fish there's this

2225
01:56:46,800 --> 01:56:48,540
guy Stephen and he clicks on this thing

2226
01:56:48,540 --> 01:56:50,580
it's a financials report now the funny

2227
01:56:50,580 --> 01:56:52,380
thing is Steven isn't in the finance

2228
01:56:52,380 --> 01:56:54,300
department so Steven snowsy and nobody

2229
01:56:54,300 --> 01:56:55,440
picked up on that it's not my

2230
01:56:55,440 --> 01:56:58,219
responsibility to knock on them

2231
01:56:58,219 --> 01:57:00,360
so and then here's more security

2232
01:57:00,360 --> 01:57:02,340
education bad email that was opened by

2233
01:57:02,340 --> 01:57:06,119
Stephen he's received his hundred lashes

2234
01:57:06,119 --> 01:57:08,100
on the offhand side

2235
01:57:08,100 --> 01:57:10,380
I'm trying to win

2236
01:57:10,380 --> 01:57:12,060
and lately there have been a lot of

2237
01:57:12,060 --> 01:57:14,159
obstacles that have I'm encountering

2238
01:57:14,159 --> 01:57:16,080
they keep trying to stop how I'm doing

2239
01:57:16,080 --> 01:57:17,099
it

2240
01:57:17,099 --> 01:57:19,800
leave me alone Mark of the web is one of

2241
01:57:19,800 --> 01:57:20,940
those things if you don't know what that

2242
01:57:20,940 --> 01:57:23,900
is if you send a document through email

2243
01:57:23,900 --> 01:57:26,099
Microsoft will stamp this at the bottom

2244
01:57:26,099 --> 01:57:27,540
it says this file came from another

2245
01:57:27,540 --> 01:57:29,820
computer it might be blocked to protect

2246
01:57:29,820 --> 01:57:31,320
this computer what that means for me is

2247
01:57:31,320 --> 01:57:33,540
no more macros

2248
01:57:33,540 --> 01:57:35,639
turns out you can pack that up into an

2249
01:57:35,639 --> 01:57:37,260
ISO file and if you don't know what an

2250
01:57:37,260 --> 01:57:39,300
ISO file is it's a single electronic

2251
01:57:39,300 --> 01:57:40,980
file that contains the identical content

2252
01:57:40,980 --> 01:57:43,560
of an optical disk so you take a DVD you

2253
01:57:43,560 --> 01:57:45,060
stick it in your computer you rip it

2254
01:57:45,060 --> 01:57:47,460
it's an IMG file or it's an ISO file and

2255
01:57:47,460 --> 01:57:49,080
this is not an original thought I stole

2256
01:57:49,080 --> 01:57:51,000
this from apts turns out they're pretty

2257
01:57:51,000 --> 01:57:52,679
clever

2258
01:57:52,679 --> 01:57:54,780
so we take that document and we pack it

2259
01:57:54,780 --> 01:57:57,480
into an ISO file and when we send it it

2260
01:57:57,480 --> 01:57:59,400
gets the mark of the web but it doesn't

2261
01:57:59,400 --> 01:58:01,920
impact its ability as an ISO file so

2262
01:58:01,920 --> 01:58:03,960
when you mount that

2263
01:58:03,960 --> 01:58:06,239
we look at the file and there's no Mark

2264
01:58:06,239 --> 01:58:08,099
of the web which means I have macros

2265
01:58:08,099 --> 01:58:10,639
again thank you

2266
01:58:10,739 --> 01:58:14,718
I started looking into Microsoft Word

2267
01:58:15,300 --> 01:58:18,480
and I was curious what is a docx and it

2268
01:58:18,480 --> 01:58:20,760
turns out a docx is a collection of

2269
01:58:20,760 --> 01:58:23,400
files and I started reading up on this

2270
01:58:23,400 --> 01:58:25,800
and it turns out you can add files to

2271
01:58:25,800 --> 01:58:27,780
this collection what was of interest to

2272
01:58:27,780 --> 01:58:30,540
me is we could add some footer files to

2273
01:58:30,540 --> 01:58:33,599
this and in this footer file what we see

2274
01:58:33,599 --> 01:58:37,920
is we can add an image reference to this

2275
01:58:37,920 --> 01:58:39,840
so I have this pointed to my attacking

2276
01:58:39,840 --> 01:58:42,840
server where I've got some hosted PHP

2277
01:58:42,840 --> 01:58:44,820
this is my ghetto PHP it's basically

2278
01:58:44,820 --> 01:58:47,400
pulling user agent information and if we

2279
01:58:47,400 --> 01:58:49,500
just hit this straight up we see date

2280
01:58:49,500 --> 01:58:52,080
stamp IP address and then Windows 10

2281
01:58:52,080 --> 01:58:54,420
architecture 64-bit and the running

2282
01:58:54,420 --> 01:58:57,239
Firefox and you know I have this going

2283
01:58:57,239 --> 01:58:59,040
into a file so if I fish a bunch of

2284
01:58:59,040 --> 01:59:00,900
users I can just see this in a list and

2285
01:59:00,900 --> 01:59:02,520
see who did bad things

2286
01:59:02,520 --> 01:59:04,199
um if I didn't care about my client I

2287
01:59:04,199 --> 01:59:06,239
could use webhook.site it will basically

2288
01:59:06,239 --> 01:59:07,800
do the same thing without you having to

2289
01:59:07,800 --> 01:59:09,719
host your own infrastructure I care

2290
01:59:09,719 --> 01:59:11,760
about my clients I don't send their [ __ ]

2291
01:59:11,760 --> 01:59:13,800
to the internet but basically this is

2292
01:59:13,800 --> 01:59:15,360
what we get the same thing user agent

2293
01:59:15,360 --> 01:59:17,040
information

2294
01:59:17,040 --> 01:59:19,440
and you're like so what I know it's in

2295
01:59:19,440 --> 01:59:20,699
the logs right we can get that

2296
01:59:20,699 --> 01:59:22,860
information from the logs so I decided

2297
01:59:22,860 --> 01:59:25,980
to weaponize it and I Incorporated a UNC

2298
01:59:25,980 --> 01:59:27,960
path now if you don't know what a UNC

2299
01:59:27,960 --> 01:59:29,580
path is you're in a corporate

2300
01:59:29,580 --> 01:59:31,980
environment and you map network drives

2301
01:59:31,980 --> 01:59:33,480
if that's a Windows system that's

2302
01:59:33,480 --> 01:59:35,639
mapping through a UNC path

2303
01:59:35,639 --> 01:59:37,260
and so we make this change in the two

2304
01:59:37,260 --> 01:59:39,060
locations

2305
01:59:39,060 --> 01:59:41,460
I want to do a quick sidebar

2306
01:59:41,460 --> 01:59:44,340
so sometimes I want to make a logo

2307
01:59:44,340 --> 01:59:45,780
and

2308
01:59:45,780 --> 01:59:48,000
Adobe has this website and you can

2309
01:59:48,000 --> 01:59:49,440
create logos in like five minutes for

2310
01:59:49,440 --> 01:59:51,540
free and I say my awesome business is

2311
01:59:51,540 --> 01:59:53,460
called conspiracy Inc and My slogan is

2312
01:59:53,460 --> 01:59:55,560
Birds aren't real and then it will

2313
01:59:55,560 --> 01:59:58,020
generate this nice little logo

2314
01:59:58,020 --> 02:00:00,360
foreign

2315
02:00:00,360 --> 02:00:02,340
game on and the reason why I brought

2316
02:00:02,340 --> 02:00:05,219
that up is when I'm fishing

2317
02:00:05,219 --> 02:00:07,139
I want to make a nice signature block

2318
02:00:07,139 --> 02:00:09,780
and if you put that logo in the bottom

2319
02:00:09,780 --> 02:00:11,340
of that signature block your click rate

2320
02:00:11,340 --> 02:00:13,380
goes through the roof it's crazy

2321
02:00:13,380 --> 02:00:16,199
and so I start my fishing campaign and

2322
02:00:16,199 --> 02:00:18,840
we were testing proof point and my

2323
02:00:18,840 --> 02:00:21,540
attachment went into the sandbox now

2324
02:00:21,540 --> 02:00:23,280
what it does in the sandbox is it takes

2325
02:00:23,280 --> 02:00:25,679
that document it opens it up it's if it

2326
02:00:25,679 --> 02:00:27,900
explodes and if it doesn't then it sends

2327
02:00:27,900 --> 02:00:29,880
it off to the Izzard this actually went

2328
02:00:29,880 --> 02:00:31,739
through proof point which is amazing to

2329
02:00:31,739 --> 02:00:33,919
me

2330
02:00:34,020 --> 02:00:35,699
and then what happens is it starts

2331
02:00:35,699 --> 02:00:37,860
raining hashes no egress rules for those

2332
02:00:37,860 --> 02:00:39,599
of you running firewalls

2333
02:00:39,599 --> 02:00:40,800
um

2334
02:00:40,800 --> 02:00:42,540
more hashes

2335
02:00:42,540 --> 02:00:45,060
and so let me ask you a question what is

2336
02:00:45,060 --> 02:00:46,739
more impactful

2337
02:00:46,739 --> 02:00:49,619
this pie chart that is critical high

2338
02:00:49,619 --> 02:00:51,000
medium

2339
02:00:51,000 --> 02:00:53,340
and low vulnerabilities

2340
02:00:53,340 --> 02:00:55,500
or the fact that your [ __ ] user

2341
02:00:55,500 --> 02:00:58,199
responded to the attacker because they

2342
02:00:58,199 --> 02:01:00,119
didn't think it was sus when they opened

2343
02:01:00,119 --> 02:01:03,259
up a black Word document

2344
02:01:03,300 --> 02:01:05,639
so he says hello there are no company

2345
02:01:05,639 --> 02:01:07,320
name part numbers anywhere in this email

2346
02:01:07,320 --> 02:01:09,239
or attachment please provide readable

2347
02:01:09,239 --> 02:01:10,679
inquiry it's that [ __ ] guy Stephen

2348
02:01:10,679 --> 02:01:11,410
again

2349
02:01:11,410 --> 02:01:15,389
[Laughter]

2350
02:01:15,420 --> 02:01:16,860
so another thing I want to talk about

2351
02:01:16,860 --> 02:01:19,759
are shortcuts

2352
02:01:20,460 --> 02:01:21,900
so I started playing around with this

2353
02:01:21,900 --> 02:01:24,300
last year so this is a shortcut and you

2354
02:01:24,300 --> 02:01:25,980
know it's a little image and it's got a

2355
02:01:25,980 --> 02:01:28,699
an arrow

2356
02:01:30,930 --> 02:01:32,099
[Music]

2357
02:01:32,099 --> 02:01:33,599
so if we look inside of this it's

2358
02:01:33,599 --> 02:01:35,580
basically a file that ends in dot URL

2359
02:01:35,580 --> 02:01:38,219
and there's a reference for Icon file

2360
02:01:38,219 --> 02:01:39,780
and that's basically what renders that

2361
02:01:39,780 --> 02:01:42,840
little image now it's the act of opening

2362
02:01:42,840 --> 02:01:44,820
up to that location that causes it to

2363
02:01:44,820 --> 02:01:45,900
look for the image so you don't have to

2364
02:01:45,900 --> 02:01:47,880
click on it

2365
02:01:47,880 --> 02:01:50,340
so I change this I point it to my

2366
02:01:50,340 --> 02:01:52,080
attacking server

2367
02:01:52,080 --> 02:01:54,000
I fire up responder which is a man in

2368
02:01:54,000 --> 02:01:55,800
the middle tool

2369
02:01:55,800 --> 02:01:58,320
and I test it and I get a hash

2370
02:01:58,320 --> 02:02:02,040
so I packed that up into an ISO file

2371
02:02:02,040 --> 02:02:04,080
turns out over the last few months

2372
02:02:04,080 --> 02:02:05,699
they've caught on to this and they've

2373
02:02:05,699 --> 02:02:07,860
started blocking ISO files from being

2374
02:02:07,860 --> 02:02:12,500
added as attachments so I zipped it up

2375
02:02:13,040 --> 02:02:16,080
when you double click on the zip file it

2376
02:02:16,080 --> 02:02:18,960
actually looks inside the ISO file so it

2377
02:02:18,960 --> 02:02:21,060
just sends the hash and if it didn't it

2378
02:02:21,060 --> 02:02:22,320
would matter because when you mount it

2379
02:02:22,320 --> 02:02:25,280
it sends the hash

2380
02:02:25,500 --> 02:02:27,719
so I've got my technique worked out and

2381
02:02:27,719 --> 02:02:30,719
now I want to start a phishing campaign

2382
02:02:30,719 --> 02:02:33,179
so I fire up responder

2383
02:02:33,179 --> 02:02:35,040
and then I ask for a quote please quote

2384
02:02:35,040 --> 02:02:37,199
the following attached items and then I

2385
02:02:37,199 --> 02:02:38,400
get hashes

2386
02:02:38,400 --> 02:02:40,199
and I got a hash

2387
02:02:40,199 --> 02:02:43,080
and I love ashes

2388
02:02:43,080 --> 02:02:47,099
now I want to talk about proof point

2389
02:02:47,099 --> 02:02:48,540
sit in front of my computer the other

2390
02:02:48,540 --> 02:02:49,440
day

2391
02:02:49,440 --> 02:02:51,000
and I got my proof Point quarantine

2392
02:02:51,000 --> 02:02:53,040
digest it shows up every day at the same

2393
02:02:53,040 --> 02:02:54,480
time

2394
02:02:54,480 --> 02:02:56,280
and I realized that I've stopped looking

2395
02:02:56,280 --> 02:02:58,440
to see where it was coming from and I

2396
02:02:58,440 --> 02:02:59,520
was like um

2397
02:02:59,520 --> 02:03:03,119
I got an idea so I cloned the page

2398
02:03:03,119 --> 02:03:05,639
and I took all the links and have it

2399
02:03:05,639 --> 02:03:07,619
pointing to my phishing server

2400
02:03:07,619 --> 02:03:09,960
and then I copied that into an email

2401
02:03:09,960 --> 02:03:12,179
and I sent it out to all the clients

2402
02:03:12,179 --> 02:03:14,040
that we manage

2403
02:03:14,040 --> 02:03:18,840
I fished 137 users

2404
02:03:18,840 --> 02:03:21,860
I'm a bad man

2405
02:03:23,219 --> 02:03:26,480
got lots of hashes

2406
02:03:26,760 --> 02:03:29,219
I'm obsessed with ashes

2407
02:03:29,219 --> 02:03:30,480
and the reason why is because I like

2408
02:03:30,480 --> 02:03:33,300
password cracking okay

2409
02:03:33,300 --> 02:03:36,239
so password complexity in Windows upper

2410
02:03:36,239 --> 02:03:38,460
character lowercase number special

2411
02:03:38,460 --> 02:03:42,119
characters not good enough and so I find

2412
02:03:42,119 --> 02:03:43,920
that uh in the environments that we work

2413
02:03:43,920 --> 02:03:46,199
in I can crack about

2414
02:03:46,199 --> 02:03:48,360
um five to ten percent of the hashes and

2415
02:03:48,360 --> 02:03:49,920
I'm using like I don't know

2416
02:03:49,920 --> 02:03:53,040
five-year-old GPU single one really not

2417
02:03:53,040 --> 02:03:54,179
hard

2418
02:03:54,179 --> 02:03:55,440
what I'm going to do next is I'm going

2419
02:03:55,440 --> 02:03:56,699
to take that information I'm going to

2420
02:03:56,699 --> 02:03:58,739
spray the environment with it now what's

2421
02:03:58,739 --> 02:04:00,119
really interesting is they have a seam

2422
02:04:00,119 --> 02:04:01,679
in this environment and it didn't detect

2423
02:04:01,679 --> 02:04:03,780
it I'm like hello is anybody home it's

2424
02:04:03,780 --> 02:04:05,219
like

2425
02:04:05,219 --> 02:04:08,880
and so I find a user where I get a hit

2426
02:04:08,880 --> 02:04:11,340
um and there's this domain controller

2427
02:04:11,340 --> 02:04:13,679
so I look and I see if there's anything

2428
02:04:13,679 --> 02:04:15,420
that we mount an accounting stands out

2429
02:04:15,420 --> 02:04:17,760
to me that's very interesting

2430
02:04:17,760 --> 02:04:19,619
um and then I find accounts payable and

2431
02:04:19,619 --> 02:04:21,840
then I find this AP passwords I like it

2432
02:04:21,840 --> 02:04:23,460
when you got passwords

2433
02:04:23,460 --> 02:04:26,280
and so then I find uh this document

2434
02:04:26,280 --> 02:04:27,900
where they've got all their shipping

2435
02:04:27,900 --> 02:04:30,179
information and and passwords and all

2436
02:04:30,179 --> 02:04:31,920
the account stuff and I'm like

2437
02:04:31,920 --> 02:04:34,020
and so

2438
02:04:34,020 --> 02:04:34,800
um

2439
02:04:34,800 --> 02:04:38,099
I want to talk about me and my shadow

2440
02:04:38,099 --> 02:04:40,440
so I might find myself in a situation

2441
02:04:40,440 --> 02:04:44,520
where I want to RDP into a desktop and

2442
02:04:44,520 --> 02:04:46,380
I've done this before and basically I

2443
02:04:46,380 --> 02:04:48,239
just wait until the users aren't in the

2444
02:04:48,239 --> 02:04:49,440
office

2445
02:04:49,440 --> 02:04:51,719
um but I found out about Shadow mode and

2446
02:04:51,719 --> 02:04:53,540
so you can enable this in the registry

2447
02:04:53,540 --> 02:04:56,040
and then when you see that a user is

2448
02:04:56,040 --> 02:04:58,980
connected you can execute Shadow mode

2449
02:04:58,980 --> 02:05:01,099
with no consent prompt so if you've ever

2450
02:05:01,099 --> 02:05:03,540
jumped into a system with a user on it

2451
02:05:03,540 --> 02:05:05,159
it'll actually prompt it and saying you

2452
02:05:05,159 --> 02:05:06,840
know maybe even your own user account is

2453
02:05:06,840 --> 02:05:08,340
trying to connect to this system no

2454
02:05:08,340 --> 02:05:10,139
consent prompt makes that go away and

2455
02:05:10,139 --> 02:05:11,520
what you can do is you can literally

2456
02:05:11,520 --> 02:05:13,380
view everything they're doing like their

2457
02:05:13,380 --> 02:05:16,139
Wells Fargo login or like this general

2458
02:05:16,139 --> 02:05:19,020
ledger account breakdown

2459
02:05:19,020 --> 02:05:22,280
and then heads exploded

2460
02:05:22,320 --> 02:05:23,520
so

2461
02:05:23,520 --> 02:05:26,099
if you are old enough you will know that

2462
02:05:26,099 --> 02:05:29,040
Defender is a video game and not an

2463
02:05:29,040 --> 02:05:30,840
antivirus solution

2464
02:05:30,840 --> 02:05:33,179
and sometimes I need to prove this and

2465
02:05:33,179 --> 02:05:35,580
so I had this client that I picked up

2466
02:05:35,580 --> 02:05:38,099
and uh they were saying we use Defender

2467
02:05:38,099 --> 02:05:39,840
and I was like okay well I'm going to

2468
02:05:39,840 --> 02:05:42,119
prove to you why that's a bad idea

2469
02:05:42,119 --> 02:05:45,119
so I drop uh interpreter shell on the

2470
02:05:45,119 --> 02:05:46,679
systems this file contains a virus

2471
02:05:46,679 --> 02:05:48,179
that's good

2472
02:05:48,179 --> 02:05:50,580
so then I convert that shell to hex and

2473
02:05:50,580 --> 02:05:52,500
I drop that hex on the system and the

2474
02:05:52,500 --> 02:05:55,020
defender doesn't detect it so then I use

2475
02:05:55,020 --> 02:05:56,520
a technique called process injection

2476
02:05:56,520 --> 02:05:58,739
specifically process hollowing so you're

2477
02:05:58,739 --> 02:06:00,360
basically parting the memory on an

2478
02:06:00,360 --> 02:06:02,400
existing process like Google Chrome and

2479
02:06:02,400 --> 02:06:03,719
then you're injecting the Shell Code

2480
02:06:03,719 --> 02:06:04,920
straight into memory so it's not

2481
02:06:04,920 --> 02:06:06,599
touching the disk

2482
02:06:06,599 --> 02:06:08,400
next thing that happens is I get a shell

2483
02:06:08,400 --> 02:06:09,420
back

2484
02:06:09,420 --> 02:06:11,040
and then so I pings with the environment

2485
02:06:11,040 --> 02:06:13,260
and then I start Port scanning and I'm

2486
02:06:13,260 --> 02:06:15,659
like defender's a bad idea so another

2487
02:06:15,659 --> 02:06:18,060
thing that I need to prove is that you

2488
02:06:18,060 --> 02:06:20,400
should not give your users local admin

2489
02:06:20,400 --> 02:06:22,500
and I run into this all the time and

2490
02:06:22,500 --> 02:06:24,360
it's typically the engineers and the

2491
02:06:24,360 --> 02:06:27,239
developers that are like oh man shit's

2492
02:06:27,239 --> 02:06:29,400
gonna break we need this and really if

2493
02:06:29,400 --> 02:06:30,540
you're going to do this right you should

2494
02:06:30,540 --> 02:06:32,219
give them a privileged account local

2495
02:06:32,219 --> 02:06:34,380
machine and then let them move back and

2496
02:06:34,380 --> 02:06:36,659
forth but have them always operate as a

2497
02:06:36,659 --> 02:06:39,840
regular user and so to prove this I

2498
02:06:39,840 --> 02:06:43,199
enabled W digest so basically I'm on a

2499
02:06:43,199 --> 02:06:45,179
system I have local admin I enable W

2500
02:06:45,179 --> 02:06:47,400
digest and basically what this does is

2501
02:06:47,400 --> 02:06:49,500
it stores clear text credentials in

2502
02:06:49,500 --> 02:06:50,699
memory

2503
02:06:50,699 --> 02:06:53,940
so this is uh you can go into task

2504
02:06:53,940 --> 02:06:55,920
manager and you can create a dump file

2505
02:06:55,920 --> 02:06:57,360
from lsas

2506
02:06:57,360 --> 02:06:59,580
except it didn't work so within the last

2507
02:06:59,580 --> 02:07:01,440
few months they've actually they've

2508
02:07:01,440 --> 02:07:02,820
sewed this hole up and I'm like that's

2509
02:07:02,820 --> 02:07:04,860
all right I got other techniques

2510
02:07:04,860 --> 02:07:07,080
so I go to proc dump and it says error

2511
02:07:07,080 --> 02:07:10,199
writing dump file I'm like interesting

2512
02:07:10,199 --> 02:07:12,719
so I do volume Shadow copy create it

2513
02:07:12,719 --> 02:07:15,060
says invalid command so they are

2514
02:07:15,060 --> 02:07:16,800
stopping me

2515
02:07:16,800 --> 02:07:18,119
and then I'm like all right fine I'm

2516
02:07:18,119 --> 02:07:19,860
going to use process injection

2517
02:07:19,860 --> 02:07:22,380
I get my shell back

2518
02:07:22,380 --> 02:07:24,840
and I ran that as system but I wasn't

2519
02:07:24,840 --> 02:07:26,460
system when I got this and I'm like man

2520
02:07:26,460 --> 02:07:28,800
they're really like sewing up my holes I

2521
02:07:28,800 --> 02:07:29,820
don't know what's going on and then I'm

2522
02:07:29,820 --> 02:07:32,840
like wow wow sad

2523
02:07:33,239 --> 02:07:35,159
and then my imposter syndrome kicked in

2524
02:07:35,159 --> 02:07:38,639
like am I really a hacker I suck when

2525
02:07:38,639 --> 02:07:39,780
are people going to figure out that I'm

2526
02:07:39,780 --> 02:07:41,760
a fraud and I'm not the only person in

2527
02:07:41,760 --> 02:07:43,440
this room that has imposter syndrome and

2528
02:07:43,440 --> 02:07:45,239
we know somebody that recommended a book

2529
02:07:45,239 --> 02:07:47,460
for me called The Secret thoughts of a

2530
02:07:47,460 --> 02:07:49,139
successful woman it's not about women

2531
02:07:49,139 --> 02:07:51,119
it's about imposter syndrome I recommend

2532
02:07:51,119 --> 02:07:52,980
this book and I thought it was really

2533
02:07:52,980 --> 02:07:54,239
funny it was sitting on my bookshelf

2534
02:07:54,239 --> 02:07:56,219
next to adversarial trade craft and

2535
02:07:56,219 --> 02:07:57,960
cyber security so while I'm working on

2536
02:07:57,960 --> 02:07:59,520
being a better hacker I'm also working

2537
02:07:59,520 --> 02:08:02,480
on being better me

2538
02:08:03,239 --> 02:08:06,980
but now I feel like we're keeping score

2539
02:08:07,739 --> 02:08:10,139
George's getting angry

2540
02:08:10,139 --> 02:08:12,239
and so I get this idea that I'm going to

2541
02:08:12,239 --> 02:08:14,280
schedule a task I'm going to run that

2542
02:08:14,280 --> 02:08:16,440
scheduled task as system and I'm going

2543
02:08:16,440 --> 02:08:18,420
to do that process injection

2544
02:08:18,420 --> 02:08:20,580
and so then I get back a shell as NT

2545
02:08:20,580 --> 02:08:22,260
Authority system

2546
02:08:22,260 --> 02:08:24,420
I run creds all and I get that clear

2547
02:08:24,420 --> 02:08:26,520
text credential and then I prove this is

2548
02:08:26,520 --> 02:08:28,080
why you shouldn't give your users local

2549
02:08:28,080 --> 02:08:29,639
admin because if you do I'm going to

2550
02:08:29,639 --> 02:08:30,980
wreck your [ __ ]

2551
02:08:30,980 --> 02:08:33,840
and in my game I get points back so [ __ ]

2552
02:08:33,840 --> 02:08:36,020
him

2553
02:08:36,719 --> 02:08:39,719
so sometimes I'm asked to remain in the

2554
02:08:39,719 --> 02:08:41,880
environment persistence uh so that you

2555
02:08:41,880 --> 02:08:43,739
know hack into the environment we want

2556
02:08:43,739 --> 02:08:44,940
you to stay

2557
02:08:44,940 --> 02:08:47,340
and so this is some ghetto Powershell

2558
02:08:47,340 --> 02:08:50,900
that's basically a reverse shell

2559
02:08:51,500 --> 02:08:54,360
test it and I get a shell back

2560
02:08:54,360 --> 02:08:56,219
so then I'm going to convert it to an

2561
02:08:56,219 --> 02:08:59,460
exe with PS to EXE

2562
02:08:59,460 --> 02:09:02,400
and I get detected by bitdefender and

2563
02:09:02,400 --> 02:09:05,040
I'm like ah okay how about a download

2564
02:09:05,040 --> 02:09:06,780
and execute so I'm going to basically

2565
02:09:06,780 --> 02:09:08,580
download my shell into memory and

2566
02:09:08,580 --> 02:09:11,820
execute it so that actually works

2567
02:09:11,820 --> 02:09:14,159
so I make that the file that I'm going

2568
02:09:14,159 --> 02:09:15,840
to turn into an executable

2569
02:09:15,840 --> 02:09:18,300
and that works and sitting on the disk

2570
02:09:18,300 --> 02:09:22,500
and so I test it and I get my shell back

2571
02:09:22,500 --> 02:09:24,179
so now I'm going to schedule it every

2572
02:09:24,179 --> 02:09:25,920
hour it's going to hit the schedule task

2573
02:09:25,920 --> 02:09:27,119
and I'm going to get a shell back so

2574
02:09:27,119 --> 02:09:28,619
even if you knock me out I'm coming back

2575
02:09:28,619 --> 02:09:29,639
in

2576
02:09:29,639 --> 02:09:31,739
and we test it and then sure enough I'm

2577
02:09:31,739 --> 02:09:32,520
in

2578
02:09:32,520 --> 02:09:35,159
and you're like that was lame anyways

2579
02:09:35,159 --> 02:09:36,840
kind of lame so I'm going to do

2580
02:09:36,840 --> 02:09:38,520
something called rid hijacking rid

2581
02:09:38,520 --> 02:09:40,320
stands for relative ID

2582
02:09:40,320 --> 02:09:42,780
uh so I created this user account when I

2583
02:09:42,780 --> 02:09:46,560
was on this system asp.net 4.0 now I was

2584
02:09:46,560 --> 02:09:48,179
a system administrator for a long time

2585
02:09:48,179 --> 02:09:50,940
and there is an asp net account if I saw

2586
02:09:50,940 --> 02:09:52,800
4.0 I wouldn't think twice and I

2587
02:09:52,800 --> 02:09:54,179
certainly wouldn't delete it because I

2588
02:09:54,179 --> 02:09:56,880
would be afraid it would break [ __ ]

2589
02:09:56,880 --> 02:09:58,080
foreign

2590
02:09:58,080 --> 02:10:00,300
so then what I want is the Sid the

2591
02:10:00,300 --> 02:10:01,920
security identifier for this account and

2592
02:10:01,920 --> 02:10:04,860
users start in 1008 administrator is

2593
02:10:04,860 --> 02:10:06,540
500.

2594
02:10:06,540 --> 02:10:09,239
so we need to convert this to hex and

2595
02:10:09,239 --> 02:10:12,780
then I need to run regedit as system so

2596
02:10:12,780 --> 02:10:14,940
I run process exec on command prompt

2597
02:10:14,940 --> 02:10:17,340
which lets me uh run at a system and

2598
02:10:17,340 --> 02:10:19,500
then I get regedit and the reason why is

2599
02:10:19,500 --> 02:10:21,900
I want to get to the Sam portion of the

2600
02:10:21,900 --> 02:10:24,599
registry so what I'm identifying here is

2601
02:10:24,599 --> 02:10:27,780
the admin account and we see 01 F4 and

2602
02:10:27,780 --> 02:10:29,219
and then basically what we're going to

2603
02:10:29,219 --> 02:10:30,780
do is we're going to take the ASP net

2604
02:10:30,780 --> 02:10:34,320
account which is 03 F 0 and we're going

2605
02:10:34,320 --> 02:10:36,119
to change that to match the

2606
02:10:36,119 --> 02:10:38,760
administrator account

2607
02:10:38,760 --> 02:10:40,500
basically just showing you the keyword

2608
02:10:40,500 --> 02:10:42,599
where that's taking place

2609
02:10:42,599 --> 02:10:45,360
when we log in we check the

2610
02:10:45,360 --> 02:10:47,099
administrator's account and the only one

2611
02:10:47,099 --> 02:10:49,800
you see in there is the administrator

2612
02:10:49,800 --> 02:10:51,900
but because we did this little magic in

2613
02:10:51,900 --> 02:10:53,400
the registry we can execute

2614
02:10:53,400 --> 02:10:55,020
administrative command so we can look

2615
02:10:55,020 --> 02:10:56,699
like a user but we're actually an admin

2616
02:10:56,699 --> 02:10:59,460
so I created a counter and I would like

2617
02:10:59,460 --> 02:11:01,080
to update this because within the last

2618
02:11:01,080 --> 02:11:02,940
couple of months Microsoft has actually

2619
02:11:02,940 --> 02:11:05,040
sewed up this hole in Windows 10 still

2620
02:11:05,040 --> 02:11:08,159
works in all the server versions

2621
02:11:08,159 --> 02:11:09,719
another thing we can do is something

2622
02:11:09,719 --> 02:11:11,400
called sticky keys

2623
02:11:11,400 --> 02:11:13,679
basically it's accessibility option so

2624
02:11:13,679 --> 02:11:16,800
you uh you're blind like me

2625
02:11:16,800 --> 02:11:18,900
you get to the you know the login prompt

2626
02:11:18,900 --> 02:11:21,060
you hit shift five times can't see I

2627
02:11:21,060 --> 02:11:22,619
need to put my glass back down

2628
02:11:22,619 --> 02:11:25,320
um and it'll activate accessibility

2629
02:11:25,320 --> 02:11:29,040
options and this is actually Seth c.exe

2630
02:11:29,040 --> 02:11:31,320
so first thing we need to do is we need

2631
02:11:31,320 --> 02:11:33,480
to take ownership of this file and then

2632
02:11:33,480 --> 02:11:36,119
we need to modify Access Control

2633
02:11:36,119 --> 02:11:38,280
because I like my clients I make backup

2634
02:11:38,280 --> 02:11:39,780
copies of the files that I'm messing

2635
02:11:39,780 --> 02:11:40,860
with

2636
02:11:40,860 --> 02:11:42,840
um but then I tried to copy command.exe

2637
02:11:42,840 --> 02:11:44,520
and I get access tonight I'm like that's

2638
02:11:44,520 --> 02:11:46,920
interesting that's that's something new

2639
02:11:46,920 --> 02:11:48,780
um so I do this little trick where I'm

2640
02:11:48,780 --> 02:11:50,880
elevating the system and I try again and

2641
02:11:50,880 --> 02:11:53,520
I get access denied now the reason why I

2642
02:11:53,520 --> 02:11:55,199
bring this up is I've been doing this

2643
02:11:55,199 --> 02:11:56,340
for a while and a lot of things change

2644
02:11:56,340 --> 02:11:58,380
over time my goal remains the same and

2645
02:11:58,380 --> 02:12:00,239
specifically with this I want to use

2646
02:12:00,239 --> 02:12:02,099
sticky keys so I'm going to try to

2647
02:12:02,099 --> 02:12:03,480
figure out another way to do this and

2648
02:12:03,480 --> 02:12:05,699
actually figured out a better way we can

2649
02:12:05,699 --> 02:12:07,380
uh first thing we need to do is we need

2650
02:12:07,380 --> 02:12:10,560
to disable AV and then what we can do is

2651
02:12:10,560 --> 02:12:13,860
we can enable debugger mode on set C and

2652
02:12:13,860 --> 02:12:16,560
execute command prompt

2653
02:12:16,560 --> 02:12:18,480
basically what happens is now when we

2654
02:12:18,480 --> 02:12:20,219
get to the login prompt we hit shift

2655
02:12:20,219 --> 02:12:22,199
five times we get a command prompt that

2656
02:12:22,199 --> 02:12:24,420
opens before we even logged in and if we

2657
02:12:24,420 --> 02:12:26,400
do a who am I we're NT Authority system

2658
02:12:26,400 --> 02:12:27,659
so you don't even have to have any

2659
02:12:27,659 --> 02:12:29,460
accounts on here you can start creating

2660
02:12:29,460 --> 02:12:33,139
accounts and not even be logged in yet

2661
02:12:33,300 --> 02:12:35,520
so now I want to get to some stories

2662
02:12:35,520 --> 02:12:38,280
about clients but it turns out if your

2663
02:12:38,280 --> 02:12:39,900
clients come to your contacts they get a

2664
02:12:39,900 --> 02:12:41,099
little unhappy when you start talking

2665
02:12:41,099 --> 02:12:43,699
[ __ ] about them

2666
02:12:44,340 --> 02:12:46,679
so I decided to recreate this one with a

2667
02:12:46,679 --> 02:12:47,940
different name but it's basically the

2668
02:12:47,940 --> 02:12:50,360
same story

2669
02:12:51,900 --> 02:12:54,360
so our Target is nordtech.com not my

2670
02:12:54,360 --> 02:12:55,920
client found this domain name it looked

2671
02:12:55,920 --> 02:12:57,239
good

2672
02:12:57,239 --> 02:13:00,659
go to D Hash D hashed is a large data

2673
02:13:00,659 --> 02:13:03,599
breach collection and I pay 150 a year

2674
02:13:03,599 --> 02:13:05,639
and it's probably one of the better ones

2675
02:13:05,639 --> 02:13:06,960
that I think

2676
02:13:06,960 --> 02:13:09,540
um so I do a search for nordtech.com and

2677
02:13:09,540 --> 02:13:12,300
I get 154 hits and basically I'm getting

2678
02:13:12,300 --> 02:13:14,760
uh usernames email addresses sometimes

2679
02:13:14,760 --> 02:13:16,139
I'm getting phone numbers I'm getting

2680
02:13:16,139 --> 02:13:18,360
password hashes and clear text passwords

2681
02:13:18,360 --> 02:13:19,980
sometimes

2682
02:13:19,980 --> 02:13:22,739
so I find Nico Bianchi and I get his

2683
02:13:22,739 --> 02:13:23,639
hash

2684
02:13:23,639 --> 02:13:25,920
and I take the hashes that I find and I

2685
02:13:25,920 --> 02:13:28,619
crack them and Nico is pizza pass one

2686
02:13:28,619 --> 02:13:31,400
that's good

2687
02:13:31,560 --> 02:13:32,699
so

2688
02:13:32,699 --> 02:13:36,239
nerdtech.com is using office 365.

2689
02:13:36,239 --> 02:13:38,340
and because they're not using MFA and

2690
02:13:38,340 --> 02:13:41,099
Nico likes to reuse that password I get

2691
02:13:41,099 --> 02:13:43,139
into Nico's mailbox the first thing I do

2692
02:13:43,139 --> 02:13:44,639
is I fish everybody in the company

2693
02:13:44,639 --> 02:13:47,540
because why not

2694
02:13:48,599 --> 02:13:50,280
then the next thing I find is I'm

2695
02:13:50,280 --> 02:13:51,780
digging through Nico's mailbox and I

2696
02:13:51,780 --> 02:13:54,599
find an open VPN connection pack no MFA

2697
02:13:54,599 --> 02:13:56,699
no passphrase so I get into their

2698
02:13:56,699 --> 02:13:58,260
environment and I start enumerating

2699
02:13:58,260 --> 02:14:00,300
their environment and there's heads

2700
02:14:00,300 --> 02:14:02,599
explode

2701
02:14:02,639 --> 02:14:04,199
okay

2702
02:14:04,199 --> 02:14:06,239
now I want to talk about building a

2703
02:14:06,239 --> 02:14:08,639
better password

2704
02:14:08,639 --> 02:14:11,940
that is a hell of a password that is a

2705
02:14:11,940 --> 02:14:15,599
really strong PS word 2008 password and

2706
02:14:15,599 --> 02:14:18,800
you should lock that up in a vault

2707
02:14:19,079 --> 02:14:21,000
enumerating my client's environment and

2708
02:14:21,000 --> 02:14:24,480
I find this SQL Server 2016.

2709
02:14:24,480 --> 02:14:26,940
I'd already compromised the user so I

2710
02:14:26,940 --> 02:14:28,320
looked to see if there were any shares

2711
02:14:28,320 --> 02:14:30,000
that I could Mount and I found this E2

2712
02:14:30,000 --> 02:14:31,679
shop system if you're familiar with job

2713
02:14:31,679 --> 02:14:34,500
boss I think this is the same company

2714
02:14:34,500 --> 02:14:37,320
um and as I was digging through

2715
02:14:37,320 --> 02:14:41,280
um I found this DB scripts folder

2716
02:14:41,280 --> 02:14:44,699
under DB scripts I find user.sql

2717
02:14:44,699 --> 02:14:46,980
and then I find a couple of accounts

2718
02:14:46,980 --> 02:14:49,440
that get created with this script and

2719
02:14:49,440 --> 02:14:53,520
there's that really strong PS word 2008

2720
02:14:53,520 --> 02:14:54,960
it's like you came up with that great

2721
02:14:54,960 --> 02:14:56,699
password and you just set it out in the

2722
02:14:56,699 --> 02:15:00,079
open for everybody to find it

2723
02:15:00,599 --> 02:15:02,340
I get most of my exercise these days

2724
02:15:02,340 --> 02:15:06,440
from shaking my head and disbelief

2725
02:15:06,480 --> 02:15:08,940
soyuz Microsoft SQL Server client

2726
02:15:08,940 --> 02:15:11,940
connect to the server I enable XP

2727
02:15:11,940 --> 02:15:14,880
command shell I run a who am I I'm NT

2728
02:15:14,880 --> 02:15:17,099
service Microsoft SQL Server

2729
02:15:17,099 --> 02:15:19,860
I do a who am I slash priv and the thing

2730
02:15:19,860 --> 02:15:21,540
that stands out to me is Essie

2731
02:15:21,540 --> 02:15:23,820
impersonate privilege if you're a hacker

2732
02:15:23,820 --> 02:15:25,739
you know about Prince buffer and that's

2733
02:15:25,739 --> 02:15:27,719
what you're looking for right there I

2734
02:15:27,719 --> 02:15:29,460
tend to not like to download things off

2735
02:15:29,460 --> 02:15:30,659
the internet that I really don't

2736
02:15:30,659 --> 02:15:32,760
understand too well and execute them in

2737
02:15:32,760 --> 02:15:34,739
my environment so I just said hey if I

2738
02:15:34,739 --> 02:15:36,239
were a bad person this would be my next

2739
02:15:36,239 --> 02:15:39,060
step my actual Next Step was I tried to

2740
02:15:39,060 --> 02:15:40,920
push a reverse shell to the system and I

2741
02:15:40,920 --> 02:15:42,420
was able to get one on there but when I

2742
02:15:42,420 --> 02:15:45,000
exit executed it said the file contains

2743
02:15:45,000 --> 02:15:47,639
a virus account you got me there

2744
02:15:47,639 --> 02:15:50,219
uh so next thing I did was I wanted to

2745
02:15:50,219 --> 02:15:51,719
connect to this database and I wanted to

2746
02:15:51,719 --> 02:15:54,599
dump some tables so I'm using squish SQL

2747
02:15:54,599 --> 02:15:57,659
Server shell and I dumped the user code

2748
02:15:57,659 --> 02:16:00,540
database which has hashes

2749
02:16:00,540 --> 02:16:02,099
um and then I got somebody important in

2750
02:16:02,099 --> 02:16:03,540
the company just to be like hey I found

2751
02:16:03,540 --> 02:16:05,760
your account

2752
02:16:05,760 --> 02:16:07,739
um and yeah explosions there's lots of

2753
02:16:07,739 --> 02:16:10,519
explosions in my talk

2754
02:16:10,860 --> 02:16:12,599
so as a bonus prize I wanted to show

2755
02:16:12,599 --> 02:16:16,320
Insider threat now in this company

2756
02:16:16,320 --> 02:16:18,719
they actually have their users

2757
02:16:18,719 --> 02:16:20,820
restricted to users they're nobody runs

2758
02:16:20,820 --> 02:16:24,540
as a as a local admin like that's good

2759
02:16:24,540 --> 02:16:27,000
but Heidi SQL is a client and they make

2760
02:16:27,000 --> 02:16:29,460
a portable version and so you can launch

2761
02:16:29,460 --> 02:16:31,739
an executable as a low privileged user

2762
02:16:31,739 --> 02:16:34,558
in this environment so basically uh

2763
02:16:34,558 --> 02:16:37,019
malicious Insider finds this and says

2764
02:16:37,019 --> 02:16:38,519
how can I connect to this so they use

2765
02:16:38,519 --> 02:16:41,820
Heidi SQL they connect to the server

2766
02:16:41,820 --> 02:16:44,760
and then they get into the databases and

2767
02:16:44,760 --> 02:16:47,218
then they find the user code database so

2768
02:16:47,218 --> 02:16:48,840
I was looking I'm like what designates

2769
02:16:48,840 --> 02:16:50,218
an admin

2770
02:16:50,218 --> 02:16:53,040
in you know in this E2 application and

2771
02:16:53,040 --> 02:16:54,718
basically it's just this group code that

2772
02:16:54,718 --> 02:16:56,398
says admin

2773
02:16:56,398 --> 02:16:58,859
so I send an email to my client hey can

2774
02:16:58,859 --> 02:17:00,599
you create a regular user account for me

2775
02:17:00,599 --> 02:17:03,179
in E2 and he says does it need any

2776
02:17:03,179 --> 02:17:04,799
special permission or anything or is it

2777
02:17:04,799 --> 02:17:07,620
just to see if you can hack into it and

2778
02:17:07,620 --> 02:17:09,299
I was like [ __ ] I already broke into it

2779
02:17:09,299 --> 02:17:12,740
I just want to show you impacts you know

2780
02:17:13,740 --> 02:17:15,359
so I go in there and here's my account

2781
02:17:15,359 --> 02:17:17,459
it's got sales is the group code I

2782
02:17:17,459 --> 02:17:18,840
change it to admin it turned out there

2783
02:17:18,840 --> 02:17:20,820
was another field it was group code ID

2784
02:17:20,820 --> 02:17:23,760
and I needed to change it to this and

2785
02:17:23,760 --> 02:17:25,920
now I have full rights to their E2

2786
02:17:25,920 --> 02:17:27,718
application and this is everything like

2787
02:17:27,718 --> 02:17:30,179
I could have increased my pay I could

2788
02:17:30,179 --> 02:17:32,398
change anything and everything and they

2789
02:17:32,398 --> 02:17:35,299
thought that was a big deal

2790
02:17:36,420 --> 02:17:40,320
all right last one D hashed domain admin

2791
02:17:40,320 --> 02:17:42,420
I told you about this already D hash is

2792
02:17:42,420 --> 02:17:45,299
a large breach collection I run this in

2793
02:17:45,299 --> 02:17:48,359
front of every engagement so I find this

2794
02:17:48,359 --> 02:17:51,420
it at company name and I've got a clear

2795
02:17:51,420 --> 02:17:54,240
text credential so I start trying to

2796
02:17:54,240 --> 02:17:55,740
credential stuff everywhere and I can't

2797
02:17:55,740 --> 02:17:57,540
find a place where this works and like

2798
02:17:57,540 --> 02:17:58,679
okay

2799
02:17:58,679 --> 02:18:00,660
but sometimes I feel like I'm building a

2800
02:18:00,660 --> 02:18:01,620
puzzle

2801
02:18:01,620 --> 02:18:03,478
and this seems like an important piece

2802
02:18:03,478 --> 02:18:05,398
to me so I take that piece and I stick

2803
02:18:05,398 --> 02:18:07,740
it over in this pile

2804
02:18:07,740 --> 02:18:09,599
the next thing I do is I'm scanning the

2805
02:18:09,599 --> 02:18:11,398
environment and I'm looking for SMB

2806
02:18:11,398 --> 02:18:14,519
signing and this one server was set to

2807
02:18:14,519 --> 02:18:16,379
false which is really interesting

2808
02:18:16,379 --> 02:18:18,240
because through group policy they were

2809
02:18:18,240 --> 02:18:20,340
actually pushing out signing to be

2810
02:18:20,340 --> 02:18:22,200
enabled and for some reason it didn't

2811
02:18:22,200 --> 02:18:24,240
stick on this system this is the reason

2812
02:18:24,240 --> 02:18:27,859
why you should audit your environments

2813
02:18:27,959 --> 02:18:31,019
again another piece oh sorry SMB signing

2814
02:18:31,019 --> 02:18:34,019
if you don't know what this is is a

2815
02:18:34,019 --> 02:18:36,179
is a protocol in SMB and basically if

2816
02:18:36,179 --> 02:18:38,820
you tamper with SMB it will know and

2817
02:18:38,820 --> 02:18:40,620
it'll drop the traffic

2818
02:18:40,620 --> 02:18:42,120
um and I'd like to do man in the middle

2819
02:18:42,120 --> 02:18:43,740
attacks if you're using responder but

2820
02:18:43,740 --> 02:18:46,019
you can't use responder basically

2821
02:18:46,019 --> 02:18:47,760
um but that seemed like another piece of

2822
02:18:47,760 --> 02:18:48,718
the puzzle because I couldn't do

2823
02:18:48,718 --> 02:18:51,558
anything with that yet

2824
02:18:52,500 --> 02:18:55,799
then I found this ahp page-wide color

2825
02:18:55,799 --> 02:18:58,920
flow and if you know me you know I love

2826
02:18:58,920 --> 02:19:00,120
copiers

2827
02:19:00,120 --> 02:19:02,459
I love copiers a lot because they do

2828
02:19:02,459 --> 02:19:04,379
scan to file and scan to email and there

2829
02:19:04,379 --> 02:19:06,000
are credentials that are associated with

2830
02:19:06,000 --> 02:19:07,799
that and and typically I get in and I

2831
02:19:07,799 --> 02:19:09,718
harvest those credentials

2832
02:19:09,718 --> 02:19:10,580
foreign

2833
02:19:10,580 --> 02:19:13,080
so I go to Google and usually the

2834
02:19:13,080 --> 02:19:14,760
password's like one one one or one two

2835
02:19:14,760 --> 02:19:17,160
three four five six uh turns out this

2836
02:19:17,160 --> 02:19:18,959
one's actually pretty good you have to

2837
02:19:18,959 --> 02:19:21,540
set the password at the time uh you fire

2838
02:19:21,540 --> 02:19:22,740
up the printer

2839
02:19:22,740 --> 02:19:24,359
but then I remember that piece of that

2840
02:19:24,359 --> 02:19:25,859
puzzle that I had where I find that it

2841
02:19:25,859 --> 02:19:29,960
company name and it got me logged in

2842
02:19:30,359 --> 02:19:32,459
so they're doing siander file and this

2843
02:19:32,459 --> 02:19:34,200
is where it was pointing to

2844
02:19:34,200 --> 02:19:36,840
and I fired up responder

2845
02:19:36,840 --> 02:19:39,718
and I point it to my attacking server

2846
02:19:39,718 --> 02:19:42,898
I hit verify access and I don't get any

2847
02:19:42,898 --> 02:19:44,099
connection and I'm like well that's

2848
02:19:44,099 --> 02:19:45,240
weird

2849
02:19:45,240 --> 02:19:48,058
so I fire up netcat and I see that I get

2850
02:19:48,058 --> 02:19:49,680
a connection and what I realized is they

2851
02:19:49,680 --> 02:19:53,820
had smb1 turned off so good for them

2852
02:19:53,820 --> 02:19:55,500
so I pointed it to my other attacking

2853
02:19:55,500 --> 02:19:57,120
server where I've got Metasploit set up

2854
02:19:57,120 --> 02:19:59,340
I hit verify access

2855
02:19:59,340 --> 02:20:02,820
and I capture the scanner account hash

2856
02:20:02,820 --> 02:20:04,680
and I tried to crack it and I was

2857
02:20:04,680 --> 02:20:07,020
unsuccessful

2858
02:20:07,020 --> 02:20:08,939
then I remembered my puzzle and I

2859
02:20:08,939 --> 02:20:10,680
remember that SMB signing except for

2860
02:20:10,680 --> 02:20:12,300
false

2861
02:20:12,300 --> 02:20:13,800
and then I realized I could do a relay

2862
02:20:13,800 --> 02:20:15,000
attack

2863
02:20:15,000 --> 02:20:17,280
so I'm basically relaying from that

2864
02:20:17,280 --> 02:20:20,760
scanner that hash through my system to

2865
02:20:20,760 --> 02:20:23,399
that server where SMB signing is set to

2866
02:20:23,399 --> 02:20:25,560
false and what I'm hoping to get is a

2867
02:20:25,560 --> 02:20:27,300
dump of the Sam database that local Sam

2868
02:20:27,300 --> 02:20:28,740
database

2869
02:20:28,740 --> 02:20:32,100
so I fire up ntlm relay X

2870
02:20:32,100 --> 02:20:34,140
and then I get the local administrator

2871
02:20:34,140 --> 02:20:36,420
account and hash for that system

2872
02:20:36,420 --> 02:20:38,760
so I fire up PS exec and I pass that

2873
02:20:38,760 --> 02:20:40,800
hash and in the bottom you see that I'm

2874
02:20:40,800 --> 02:20:42,780
system 32 which means I have a shell on

2875
02:20:42,780 --> 02:20:44,520
that box

2876
02:20:44,520 --> 02:20:46,439
because they thought oh it's going to

2877
02:20:46,439 --> 02:20:48,000
slow things down with all the traffic

2878
02:20:48,000 --> 02:20:50,160
going back and forth

2879
02:20:50,160 --> 02:20:53,359
you should all do that by the way

2880
02:20:54,180 --> 02:20:55,800
I want to point out that this is server

2881
02:20:55,800 --> 02:20:59,520
2016 and the reason why is because I

2882
02:20:59,520 --> 02:21:01,380
could run proc dump on this again

2883
02:21:01,380 --> 02:21:03,780
there's an inconsistent inconsistency

2884
02:21:03,780 --> 02:21:06,060
between the operating systems and I

2885
02:21:06,060 --> 02:21:07,439
don't know why but I assume they're

2886
02:21:07,439 --> 02:21:09,479
eventually going to catch up but I'm

2887
02:21:09,479 --> 02:21:11,100
going to try it and if it works it does

2888
02:21:11,100 --> 02:21:13,500
and so in this case it did and so I dump

2889
02:21:13,500 --> 02:21:15,300
to this dump file

2890
02:21:15,300 --> 02:21:16,560
and then because they're not running

2891
02:21:16,560 --> 02:21:18,120
endpoint protection I could download

2892
02:21:18,120 --> 02:21:20,819
mimikats straight to the system and I

2893
02:21:20,819 --> 02:21:23,460
pointed it to that dump file

2894
02:21:23,460 --> 02:21:25,140
and then I get

2895
02:21:25,140 --> 02:21:29,399
the domain administrator hash

2896
02:21:29,399 --> 02:21:30,840
so I think I know where the domain

2897
02:21:30,840 --> 02:21:32,580
controller at this is at this point I

2898
02:21:32,580 --> 02:21:35,880
think it's on one 143 but I do a lookup

2899
02:21:35,880 --> 02:21:38,580
and I confirm that so I point crack map

2900
02:21:38,580 --> 02:21:40,920
exec with that username and that hash

2901
02:21:40,920 --> 02:21:42,899
bottom right hand corner says pone which

2902
02:21:42,899 --> 02:21:44,520
means I just compromised the entire

2903
02:21:44,520 --> 02:21:46,200
domain

2904
02:21:46,200 --> 02:21:50,160
boom so

2905
02:21:50,760 --> 02:21:52,560
I've given a similar talk over the last

2906
02:21:52,560 --> 02:21:54,000
three years and at the end of it I try

2907
02:21:54,000 --> 02:21:55,620
to offer Solutions

2908
02:21:55,620 --> 02:21:57,120
I feel like I'm offering the same

2909
02:21:57,120 --> 02:22:00,420
Solutions I really do like gamify

2910
02:22:00,420 --> 02:22:01,620
security

2911
02:22:01,620 --> 02:22:03,240
you got to get your users engaged

2912
02:22:03,240 --> 02:22:04,920
because if you don't get them engaged

2913
02:22:04,920 --> 02:22:06,120
they don't give a [ __ ] they're like not

2914
02:22:06,120 --> 02:22:07,319
my computer I don't care if we get

2915
02:22:07,319 --> 02:22:08,340
ransomware and I'm just going to go home

2916
02:22:08,340 --> 02:22:09,720
everything's gonna be cool

2917
02:22:09,720 --> 02:22:12,020
password managers huge got to do that

2918
02:22:12,020 --> 02:22:14,280
multi-factor authentication a lot of

2919
02:22:14,280 --> 02:22:15,840
times I get stopped by that if you just

2920
02:22:15,840 --> 02:22:17,100
had that

2921
02:22:17,100 --> 02:22:19,620
um get rid of Av go to EDR set it up

2922
02:22:19,620 --> 02:22:21,060
correctly please

2923
02:22:21,060 --> 02:22:23,700
um and then same basically giant log

2924
02:22:23,700 --> 02:22:25,859
aggregate Triggers on things like what I

2925
02:22:25,859 --> 02:22:27,540
was doing and in that one case it didn't

2926
02:22:27,540 --> 02:22:29,220
which is really weird

2927
02:22:29,220 --> 02:22:30,899
um

2928
02:22:30,899 --> 02:22:33,060
again been making these recommendations

2929
02:22:33,060 --> 02:22:34,500
and don't feel like that moves the

2930
02:22:34,500 --> 02:22:36,780
needle a lot something that seems to

2931
02:22:36,780 --> 02:22:38,220
have worked really well is actually

2932
02:22:38,220 --> 02:22:41,160
collaborating with the internal team so

2933
02:22:41,160 --> 02:22:42,780
when a company finds out that a pen

2934
02:22:42,780 --> 02:22:45,660
tester is coming in everybody in like it

2935
02:22:45,660 --> 02:22:47,460
and security gets nervous they're like

2936
02:22:47,460 --> 02:22:49,439
who's going to unearth our skeletons and

2937
02:22:49,439 --> 02:22:51,359
yeah but we're on the same side we're

2938
02:22:51,359 --> 02:22:53,280
all trying to achieve the same goal and

2939
02:22:53,280 --> 02:22:55,200
so basically I go in and I say yeah I'm

2940
02:22:55,200 --> 02:22:56,640
going to come in I'm going to do some

2941
02:22:56,640 --> 02:22:58,140
things and I'm going to find some things

2942
02:22:58,140 --> 02:22:59,939
but then at that point we're going to

2943
02:22:59,939 --> 02:23:01,200
work together and then we're going to

2944
02:23:01,200 --> 02:23:03,420
start testing your controls

2945
02:23:03,420 --> 02:23:05,880
and and they've they're like oh that's

2946
02:23:05,880 --> 02:23:08,220
cool like he wants to help us he doesn't

2947
02:23:08,220 --> 02:23:10,500
want to you know make us look bad which

2948
02:23:10,500 --> 02:23:12,420
is really my goal

2949
02:23:12,420 --> 02:23:14,939
um so with that I'm gonna call it the

2950
02:23:14,939 --> 02:23:16,140
end

2951
02:23:16,140 --> 02:23:18,840
I'm gonna throw it out for questions

2952
02:23:18,840 --> 02:23:23,060
comments feedback and then say thank you

2953
02:23:30,420 --> 02:23:32,899
question

2954
02:23:33,780 --> 02:23:35,939
shortest time I think you like so when

2955
02:23:35,939 --> 02:23:39,080
when you get hurt on the news

2956
02:23:39,780 --> 02:23:41,899
um

2957
02:23:44,460 --> 02:23:46,020
no matter your idea how quick or how

2958
02:23:46,020 --> 02:23:47,160
long it takes you

2959
02:23:47,160 --> 02:23:48,240
can see in a bit you always still trying

2960
02:23:48,240 --> 02:23:51,319
to bring that Circle back okay

2961
02:23:52,340 --> 02:23:55,740
to talk about defense or is it kind of

2962
02:23:55,740 --> 02:23:57,720
like depending on if it takes the whole

2963
02:23:57,720 --> 02:23:59,220
time to do the offensive end

2964
02:23:59,220 --> 02:24:04,519
is it like a hey guys yeah different

2965
02:24:04,560 --> 02:24:07,560
sometimes

2966
02:24:09,060 --> 02:24:10,920
I'm not sure I understand the question I

2967
02:24:10,920 --> 02:24:12,960
mean so like you're saying like if I had

2968
02:24:12,960 --> 02:24:14,399
a short period of time and I finished up

2969
02:24:14,399 --> 02:24:15,660
the engagement and there's extra time

2970
02:24:15,660 --> 02:24:18,060
the company hired you for if a company

2971
02:24:18,060 --> 02:24:19,800
hired you for two weeks and it took you

2972
02:24:19,800 --> 02:24:21,120
a week and a half or maybe like the full

2973
02:24:21,120 --> 02:24:23,760
two weeks to get to root admin

2974
02:24:23,760 --> 02:24:25,080
um would you Circle back like hey guys

2975
02:24:25,080 --> 02:24:26,040
you know what I have another company I'm

2976
02:24:26,040 --> 02:24:27,300
doing another pen test for here next

2977
02:24:27,300 --> 02:24:29,040
week but let's link up like in a month

2978
02:24:29,040 --> 02:24:30,540
and then we can talk on the defensive

2979
02:24:30,540 --> 02:24:31,500
side

2980
02:24:31,500 --> 02:24:33,000
does that make more sense yeah it does

2981
02:24:33,000 --> 02:24:35,939
and typically I have time for reporting

2982
02:24:35,939 --> 02:24:37,920
and so if there's if they want more

2983
02:24:37,920 --> 02:24:39,660
engagement time then they can have that

2984
02:24:39,660 --> 02:24:40,979
and then it just pushes out the record

2985
02:24:40,979 --> 02:24:43,439
reporting but I packed that in and then

2986
02:24:43,439 --> 02:24:44,580
the other thing too is like if I get

2987
02:24:44,580 --> 02:24:46,140
into an environment and I compromise

2988
02:24:46,140 --> 02:24:47,220
quickly

2989
02:24:47,220 --> 02:24:49,500
uh back in the day I would just wrap it

2990
02:24:49,500 --> 02:24:51,479
up and say hey look I won you suck um

2991
02:24:51,479 --> 02:24:53,220
but now what I do is I actually will

2992
02:24:53,220 --> 02:24:55,020
keep digging and try to uncover as much

2993
02:24:55,020 --> 02:24:57,420
as possible so The Insider threat thing

2994
02:24:57,420 --> 02:24:59,040
that was one of those where I was like I

2995
02:24:59,040 --> 02:25:00,540
still have time I'm going to show them

2996
02:25:00,540 --> 02:25:04,580
as much damage as I can possibly show

2997
02:25:05,100 --> 02:25:07,640
yes sir

2998
02:25:12,540 --> 02:25:15,540
um I've heard before that like

2999
02:25:15,540 --> 02:25:17,939
common and relatively simple opsec

3000
02:25:17,939 --> 02:25:19,140
practice

3001
02:25:19,140 --> 02:25:20,760
um for like making purchases with

3002
02:25:20,760 --> 02:25:22,740
cryptocurrency kind of a workaround for

3003
02:25:22,740 --> 02:25:26,819
kyc is chain hopping so like if you

3004
02:25:26,819 --> 02:25:28,680
purchase Bitcoin you exchange it for

3005
02:25:28,680 --> 02:25:30,060
Monero bounce it through a couple of

3006
02:25:30,060 --> 02:25:31,439
wallets bring it back out to bitcoin

3007
02:25:31,439 --> 02:25:33,359
make your purchase did this come up

3008
02:25:33,359 --> 02:25:34,800
during your research was there a reason

3009
02:25:34,800 --> 02:25:36,660
you elected not to use it yes [ __ ]

3010
02:25:36,660 --> 02:25:38,399
around and find out I mean that's like

3011
02:25:38,399 --> 02:25:40,680
literally like okay I just felt like if

3012
02:25:40,680 --> 02:25:41,819
you're doing that you're gonna draw

3013
02:25:41,819 --> 02:25:43,500
attention to yourself and and as a

3014
02:25:43,500 --> 02:25:45,000
person who's giving a talk I don't have

3015
02:25:45,000 --> 02:25:47,819
any interest in that okay seriously yeah

3016
02:25:47,819 --> 02:25:49,859
but yeah yeah yeah because that's my

3017
02:25:49,859 --> 02:25:51,479
crypto expert right there and this dude

3018
02:25:51,479 --> 02:25:52,859
was like oh you could totally do that

3019
02:25:52,859 --> 02:25:54,540
and I was like yeah

3020
02:25:54,540 --> 02:25:56,160
I don't know

3021
02:25:56,160 --> 02:25:57,240
all right

3022
02:25:57,240 --> 02:25:59,640
yes sir

3023
02:25:59,640 --> 02:26:02,220
so you mentioned um with the EDR making

3024
02:26:02,220 --> 02:26:03,660
sure you configure properly are there

3025
02:26:03,660 --> 02:26:05,700
any defaults that you're particularly

3026
02:26:05,700 --> 02:26:07,140
fond of that you're willing to share I

3027
02:26:07,140 --> 02:26:09,540
will have you talk to Michael

3028
02:26:09,540 --> 02:26:11,760
I'm not on that side of the house that's

3029
02:26:11,760 --> 02:26:14,520
your guy I just know that I like I did

3030
02:26:14,520 --> 02:26:15,899
an engagement where I was testing the

3031
02:26:15,899 --> 02:26:18,140
satellite

3032
02:26:20,939 --> 02:26:23,780
really quiet

3033
02:26:27,560 --> 02:26:29,819
I'm like is there anybody listening I

3034
02:26:29,819 --> 02:26:33,060
don't know yeah

3035
02:26:35,720 --> 02:26:38,819
yes sir

3036
02:26:38,819 --> 02:26:42,240
is there a way is there a way to

3037
02:26:42,240 --> 02:26:43,439
configure

3038
02:26:43,439 --> 02:26:45,899
uh Defender so that it is effective or

3039
02:26:45,899 --> 02:26:47,100
are you saying even with the correct

3040
02:26:47,100 --> 02:26:48,660
configuration just

3041
02:26:48,660 --> 02:26:51,899
um by the way Defender not Defender ATP

3042
02:26:51,899 --> 02:26:54,359
yeah Defender ATP I believe is legit

3043
02:26:54,359 --> 02:26:55,140
right

3044
02:26:55,140 --> 02:26:57,720
right yeah but I mean I don't

3045
02:26:57,720 --> 02:26:59,760
it's funny like Defenders stop stuff and

3046
02:26:59,760 --> 02:27:01,140
I'm like seriously and then it doesn't

3047
02:27:01,140 --> 02:27:02,580
stop other stuff and I'm like seriously

3048
02:27:02,580 --> 02:27:03,859
like

3049
02:27:03,859 --> 02:27:05,939
but typically like if I know what

3050
02:27:05,939 --> 02:27:07,620
they're running I will go get that and

3051
02:27:07,620 --> 02:27:09,300
then I will test against it so like I

3052
02:27:09,300 --> 02:27:11,100
gave a talk previously where Weber was

3053
02:27:11,100 --> 02:27:12,660
the thing and like Weber you go on the

3054
02:27:12,660 --> 02:27:13,740
Internet it's like web Roots awesome

3055
02:27:13,740 --> 02:27:15,660
whoever it sucks I actually haven't

3056
02:27:15,660 --> 02:27:17,460
tested it in a while uh bitdefender's

3057
02:27:17,460 --> 02:27:19,500
another one where it detects some stuff

3058
02:27:19,500 --> 02:27:20,819
and not other stuff and it's getting

3059
02:27:20,819 --> 02:27:22,260
better I mean all of it I think is

3060
02:27:22,260 --> 02:27:23,760
getting better but

3061
02:27:23,760 --> 02:27:26,520
a Defender anything in memory seems to

3062
02:27:26,520 --> 02:27:28,580
work

3063
02:27:29,819 --> 02:27:31,800
he asked if Defender was ever going to

3064
02:27:31,800 --> 02:27:33,240
be good or what's the right way to set

3065
02:27:33,240 --> 02:27:34,920
that up and I think in conjunction with

3066
02:27:34,920 --> 02:27:36,600
an EDR is the right way to do that if

3067
02:27:36,600 --> 02:27:38,040
you're if you're gonna you can't solely

3068
02:27:38,040 --> 02:27:41,420
rely on it just period you can't

3069
02:27:44,819 --> 02:27:46,200
I have a question uh you mentioned

3070
02:27:46,200 --> 02:27:48,600
password managers um some could argue

3071
02:27:48,600 --> 02:27:50,640
that that's another Treasure Trove of

3072
02:27:50,640 --> 02:27:52,319
information you're right

3073
02:27:52,319 --> 02:27:54,660
um so which one do you personally

3074
02:27:54,660 --> 02:27:57,359
recommend or I'm not telling it

3075
02:27:57,359 --> 02:27:58,260
yeah

3076
02:27:58,260 --> 02:28:01,560
given last passes last I was gonna say

3077
02:28:01,560 --> 02:28:02,880
yeah

3078
02:28:02,880 --> 02:28:06,780
but like what's the Open Source One yeah

3079
02:28:06,780 --> 02:28:08,819
yeah but like he pass like I've seen

3080
02:28:08,819 --> 02:28:10,560
people do buffer overflows and keep ass

3081
02:28:10,560 --> 02:28:12,420
I'm like okay that's not good

3082
02:28:12,420 --> 02:28:14,220
um I don't know I mean I just use one

3083
02:28:14,220 --> 02:28:16,020
and I hope I'm crossing my fingers but

3084
02:28:16,020 --> 02:28:18,300
it's better than me trying to remember

3085
02:28:18,300 --> 02:28:20,100
you know all of those passwords and all

3086
02:28:20,100 --> 02:28:22,020
my passwords are really long I mean so

3087
02:28:22,020 --> 02:28:23,399
you just gotta have faith I guess I

3088
02:28:23,399 --> 02:28:24,260
don't know

3089
02:28:24,260 --> 02:28:26,040
I don't know

3090
02:28:26,040 --> 02:28:28,080
there's this book on Amazon that says my

3091
02:28:28,080 --> 02:28:30,500
passwords

3092
02:28:33,660 --> 02:28:35,280
this will be a group collaboration if

3093
02:28:35,280 --> 02:28:36,540
anybody's got an idea on the password

3094
02:28:36,540 --> 02:28:38,100
manager thing I'm open for suggestions

3095
02:28:38,100 --> 02:28:41,780
too it's just I'm just going to say

3096
02:28:46,680 --> 02:28:48,300
as an instant responder I'd recommend

3097
02:28:48,300 --> 02:28:50,540
spreadsheets

3098
02:28:50,540 --> 02:28:54,620
as a pen tester I would too

3099
02:28:55,260 --> 02:28:56,660
much

3100
02:28:56,660 --> 02:28:59,040
I really like it when you pass or

3101
02:28:59,040 --> 02:29:00,540
protectively like I'm not gonna crack

3102
02:29:00,540 --> 02:29:02,840
that

3103
02:29:08,160 --> 02:29:11,600
all right thank you very much

3104
02:29:17,160 --> 02:29:20,359
I came in way early too

3105
02:29:21,600 --> 02:29:23,300
that was hot

3106
02:29:23,300 --> 02:29:26,479
what's up

3107
02:42:20,100 --> 02:42:23,100
foreign

3108
02:42:27,420 --> 02:42:30,319
foreign

3109
02:42:56,340 --> 02:42:58,460
thank you

3110
02:42:58,700 --> 02:43:06,499
[Music]

3111
02:43:43,920 --> 02:43:46,920
foreign

3112
02:44:09,960 --> 02:44:12,199
foreign

3113
02:44:28,490 --> 02:44:31,830
[Music]

3114
02:44:40,740 --> 02:44:43,740
foreign

3115
02:45:12,060 --> 02:45:15,060
foreign

3116
02:45:19,660 --> 02:45:45,780
[Music]

3117
02:45:45,780 --> 02:45:47,340
foreign

3118
02:45:47,340 --> 02:46:16,520
[Music]

3119
02:46:16,520 --> 02:46:19,070
foreign foreign

3120
02:46:19,070 --> 02:46:53,409
[Music]

3121
02:46:55,819 --> 02:46:57,720
thank you

3122
02:46:57,720 --> 02:47:00,720
foreign

3123
02:47:03,760 --> 02:47:51,000
[Music]

3124
02:47:51,000 --> 02:47:53,430
foreign

3125
02:47:53,430 --> 02:48:00,530
[Music]

3126
02:48:32,640 --> 02:48:35,779
[Music]

3127
02:48:40,380 --> 02:48:44,490
[Music]

3128
02:48:45,720 --> 02:48:48,720
foreign

3129
02:49:04,710 --> 02:49:09,429
[Music]

3130
02:49:15,720 --> 02:49:18,090
foreign

3131
02:49:18,090 --> 02:49:21,469
[Music]

3132
02:49:28,770 --> 02:49:31,979
[Music]

3133
02:49:45,960 --> 02:49:48,960
foreign

3134
02:49:51,040 --> 02:49:56,840
[Music]

3135
02:50:00,720 --> 02:50:03,859
[Music]

3136
02:50:22,840 --> 02:50:25,930
[Music]

3137
02:50:29,640 --> 02:50:32,599
foreign

3138
02:51:04,800 --> 02:51:07,800
foreign

3139
02:51:17,200 --> 02:51:24,819
[Music]

3140
02:51:35,640 --> 02:51:37,880
foreign

3141
02:52:08,980 --> 02:52:12,090
[Music]

3142
02:52:16,100 --> 02:52:19,100
thank you

3143
02:52:46,810 --> 02:52:50,150
[Music]

3144
02:52:59,100 --> 02:53:02,100
foreign

3145
02:53:12,899 --> 02:53:15,740
foreign

3146
02:53:37,980 --> 02:53:53,330
[Music]

3147
02:53:56,180 --> 02:53:58,180
thank you

3148
02:53:58,180 --> 02:54:16,200
[Music]

3149
02:54:16,200 --> 02:54:19,200
foreign

3150
02:54:21,420 --> 02:54:24,420
foreign

3151
02:54:25,470 --> 02:54:51,540
[Music]

3152
02:54:51,540 --> 02:54:54,540
foreign

3153
02:54:58,160 --> 02:55:22,140
[Music]

3154
02:55:22,140 --> 02:55:23,680
foreign

3155
02:55:23,680 --> 02:55:52,700
[Music]

3156
02:55:57,359 --> 02:56:00,359
foreign

3157
02:56:01,490 --> 02:56:18,940
[Music]

3158
02:56:27,220 --> 02:56:30,359
[Music]

3159
02:56:33,420 --> 02:56:36,420
foreign

3160
02:56:51,030 --> 02:56:54,189
[Music]

3161
02:56:58,790 --> 02:57:02,899
[Music]

3162
02:57:11,700 --> 02:57:14,700
foreign

3163
02:57:23,120 --> 02:57:27,840
[Music]

3164
02:57:36,500 --> 02:57:39,879
[Music]

3165
02:57:47,170 --> 02:57:48,960
[Music]

3166
02:57:48,960 --> 02:57:51,199
foreign

3167
02:58:09,440 --> 02:58:15,249
[Music]

3168
02:58:19,130 --> 02:58:22,269
[Music]

3169
02:58:41,760 --> 02:58:44,000
foreign

3170
02:59:19,979 --> 02:59:22,880
foreign

3171
02:59:35,600 --> 02:59:43,209
[Music]

3172
02:59:48,359 --> 02:59:51,359
foreign

3173
03:00:27,370 --> 03:00:30,499
[Music]

3174
03:00:40,260 --> 03:00:43,260
foreign

3175
03:01:05,200 --> 03:01:08,529
[Music]

3176
03:01:18,479 --> 03:01:21,380
foreign

3177
03:01:48,720 --> 03:01:51,720
foreign

3178
03:01:56,370 --> 03:02:22,380
[Music]

3179
03:02:22,380 --> 03:02:25,380
foreign

3180
03:02:28,480 --> 03:02:52,500
[Music]

3181
03:02:52,500 --> 03:02:55,500
foreign

3182
03:02:55,790 --> 03:02:58,999
[Music]

3183
03:03:02,540 --> 03:03:04,470
thank you

3184
03:03:04,470 --> 03:03:22,958
[Music]

3185
03:03:25,460 --> 03:03:28,480
foreign foreign

3186
03:03:28,480 --> 03:04:03,660
[Music]

3187
03:04:03,660 --> 03:04:06,660
foreign

3188
03:04:07,790 --> 03:04:37,240
[Music]

3189
03:04:43,140 --> 03:04:45,520
foreign

3190
03:04:45,520 --> 03:04:48,659
[Music]

3191
03:04:51,720 --> 03:04:54,720
foreign

3192
03:05:07,450 --> 03:05:12,489
[Music]

3193
03:05:17,800 --> 03:05:21,199
[Music]

3194
03:05:30,000 --> 03:05:33,000
foreign

3195
03:05:41,420 --> 03:05:46,140
[Music]

3196
03:05:54,810 --> 03:05:58,180
[Music]

3197
03:06:05,480 --> 03:06:07,200
[Music]

3198
03:06:07,200 --> 03:06:09,319
thank you

3199
03:06:27,750 --> 03:06:33,559
[Music]

3200
03:06:37,430 --> 03:06:40,569
[Music]

3201
03:06:44,760 --> 03:06:45,910
foreign

3202
03:06:45,910 --> 03:06:49,080
[Music]

3203
03:06:59,560 --> 03:07:02,639
[Music]

3204
03:07:48,120 --> 03:07:50,240
thank you

3205
03:07:53,710 --> 03:08:01,509
[Music]

3206
03:08:06,600 --> 03:08:09,600
foreign

3207
03:08:45,670 --> 03:08:48,809
[Music]

3208
03:09:09,660 --> 03:09:11,899
foreign

3209
03:09:23,350 --> 03:09:26,850
[Music]

3210
03:09:35,819 --> 03:09:38,819
foreign

3211
03:10:07,020 --> 03:10:10,020
foreign

3212
03:10:14,670 --> 03:10:50,290
[Music]

3213
03:10:51,020 --> 03:10:52,290
thank you

3214
03:10:52,290 --> 03:11:04,140
[Music]

3215
03:11:04,140 --> 03:11:07,140
foreign

3216
03:11:09,960 --> 03:11:12,960
foreign

3217
03:11:14,090 --> 03:11:41,040
[Music]

3218
03:11:41,040 --> 03:11:43,880
thank you

3219
03:11:46,790 --> 03:11:50,269
[Music]

3220
03:11:51,020 --> 03:11:54,080
thank you

3221
03:11:58,780 --> 03:12:17,239
[Music]

3222
03:12:20,779 --> 03:12:22,750
thank you

3223
03:12:22,750 --> 03:12:45,960
[Music]

3224
03:12:45,960 --> 03:12:48,450
foreign

3225
03:12:48,450 --> 03:12:51,769
[Music]

3226
03:13:03,820 --> 03:13:06,958
[Music]

3227
03:13:27,650 --> 03:13:29,580
[Music]

3228
03:13:29,580 --> 03:13:31,819
foreign

3229
03:13:35,400 --> 03:13:39,510
[Music]

3230
03:13:59,730 --> 03:14:03,540
[Music]

3231
03:14:03,540 --> 03:14:06,540
foreign

3232
03:14:13,110 --> 03:14:16,479
[Music]

3233
03:14:23,780 --> 03:14:26,989
[Music]

3234
03:14:46,060 --> 03:14:51,859
[Music]

3235
03:14:55,770 --> 03:14:58,879
[Music]

3236
03:15:18,240 --> 03:15:21,020
foreign

3237
03:15:24,450 --> 03:15:27,549
[Music]

3238
03:16:11,160 --> 03:16:12,010
foreign

3239
03:16:12,010 --> 03:16:19,809
[Music]

3240
03:16:32,040 --> 03:16:34,279
foreign

3241
03:17:11,600 --> 03:17:14,600
thank you

3242
03:17:41,630 --> 03:17:44,939
[Music]

3243
03:17:44,939 --> 03:17:47,180
foreign

3244
03:18:07,080 --> 03:18:10,080
foreign

3245
03:18:32,980 --> 03:18:43,500
[Music]

3246
03:18:43,500 --> 03:18:44,400
foreign

3247
03:18:44,400 --> 03:19:11,100
[Music]

3248
03:19:11,100 --> 03:19:14,100
foreign

3249
03:19:17,080 --> 03:19:43,380
[Music]

3250
03:19:43,380 --> 03:19:44,380
foreign

3251
03:19:44,380 --> 03:20:17,040
[Music]

3252
03:20:17,040 --> 03:20:20,040
foreign

3253
03:20:21,590 --> 03:20:47,100
[Music]

3254
03:20:47,100 --> 03:20:50,100
foreign

3255
03:20:53,100 --> 03:21:13,870
[Music]

3256
03:21:22,120 --> 03:21:25,259
[Music]

3257
03:21:28,319 --> 03:21:31,319
foreign

3258
03:21:45,960 --> 03:21:49,099
[Music]

3259
03:21:53,700 --> 03:21:57,809
[Music]

3260
03:21:59,520 --> 03:22:01,700
foreign

3261
03:22:18,030 --> 03:22:22,750
[Music]

3262
03:22:28,439 --> 03:22:31,410
foreign

3263
03:22:31,410 --> 03:22:34,789
[Music]

3264
03:22:42,080 --> 03:22:45,319
[Music]

3265
03:23:00,240 --> 03:23:02,359
thank you

3266
03:23:04,350 --> 03:23:10,179
[Music]

3267
03:23:14,040 --> 03:23:17,179
[Music]

3268
03:23:35,160 --> 03:23:36,160
foreign

3269
03:23:36,160 --> 03:23:39,250
[Music]

3270
03:23:42,750 --> 03:23:45,860
[Music]

3271
03:24:09,359 --> 03:24:12,359
foreign

3272
03:24:30,500 --> 03:24:38,120
[Music]

3273
03:24:48,899 --> 03:24:51,899
foreign

3274
03:25:14,520 --> 03:25:17,669
[Music]

3275
03:25:21,320 --> 03:25:25,410
[Music]

3276
03:25:29,540 --> 03:25:32,540
thank you

3277
03:25:59,940 --> 03:26:03,450
[Music]

3278
03:26:09,180 --> 03:26:12,180
foreign

3279
03:26:25,380 --> 03:26:28,380
foreign

3280
03:26:51,280 --> 03:27:00,899
[Music]

3281
03:27:00,899 --> 03:27:02,700
foreign

3282
03:27:02,700 --> 03:27:29,399
[Music]

3283
03:27:29,399 --> 03:27:32,399
foreign

3284
03:27:35,390 --> 03:28:01,800
[Music]

3285
03:28:01,800 --> 03:28:02,680
foreign

3286
03:28:02,680 --> 03:28:35,340
[Music]

3287
03:28:35,340 --> 03:28:36,890
foreign

3288
03:28:36,890 --> 03:29:05,909
[Music]

3289
03:29:09,840 --> 03:29:11,400
foreign

3290
03:29:11,400 --> 03:29:28,350
[Music]

3291
03:29:40,420 --> 03:29:43,569
[Music]

3292
03:29:46,620 --> 03:29:49,620
foreign

3293
03:30:04,250 --> 03:30:07,399
[Music]

3294
03:30:12,000 --> 03:30:16,110
[Music]

3295
03:30:24,840 --> 03:30:27,840
foreign

3296
03:30:36,330 --> 03:30:41,049
[Music]

3297
03:30:49,720 --> 03:30:53,090
[Music]

3298
03:31:00,380 --> 03:31:02,100
[Music]

3299
03:31:02,100 --> 03:31:05,100
foreign

3300
03:31:22,660 --> 03:31:28,459
[Music]

3301
03:31:32,340 --> 03:31:35,479
[Music]

3302
03:31:39,720 --> 03:31:41,899
foreign

3303
03:32:36,479 --> 03:32:38,720
foreign

3304
03:32:48,580 --> 03:32:56,419
[Music]

3305
03:33:01,560 --> 03:33:04,560
foreign

3306
03:33:55,140 --> 03:33:57,260
thank you

3307
03:34:18,410 --> 03:34:21,750
[Music]

3308
03:34:27,479 --> 03:34:30,479
foreign

3309
03:34:59,279 --> 03:35:01,520
foreign

3310
03:35:09,580 --> 03:35:24,219
[Music]

3311
03:35:28,920 --> 03:35:31,920
foreign

3312
03:35:32,990 --> 03:36:00,199
[Music]

3313
03:36:04,920 --> 03:36:07,920
foreign

3314
03:36:09,000 --> 03:36:35,700
[Music]

3315
03:36:35,700 --> 03:36:38,700
foreign

3316
03:36:41,690 --> 03:37:17,640
[Music]

3317
03:37:17,640 --> 03:37:20,640
foreign

3318
03:37:21,000 --> 03:37:50,469
[Music]

3319
03:37:56,399 --> 03:37:58,730
foreign

3320
03:37:58,730 --> 03:38:01,859
[Music]

3321
03:38:05,279 --> 03:38:08,279
foreign

3322
03:38:22,550 --> 03:38:25,699
[Music]

3323
03:38:31,010 --> 03:38:34,409
[Music]

3324
03:38:35,640 --> 03:38:38,640
foreign

3325
03:38:54,630 --> 03:38:59,349
[Music]

3326
03:39:01,859 --> 03:39:04,040
foreign

3327
03:39:08,020 --> 03:39:11,389
[Music]

3328
03:39:18,690 --> 03:39:21,899
[Music]

3329
03:39:34,630 --> 03:39:36,239
[Music]

3330
03:39:36,239 --> 03:39:39,239
foreign

3331
03:39:40,960 --> 03:39:46,759
[Music]

3332
03:39:50,640 --> 03:39:53,779
[Music]

3333
03:40:12,770 --> 03:40:15,849
[Music]

3334
03:40:54,960 --> 03:40:57,199
foreign

3335
03:41:06,920 --> 03:41:14,719
[Music]

3336
03:41:19,920 --> 03:41:22,920
foreign

3337
03:41:58,890 --> 03:42:02,019
[Music]

3338
03:42:11,700 --> 03:42:14,700
foreign

3339
03:42:36,560 --> 03:42:40,060
[Music]

3340
03:42:55,140 --> 03:42:57,319
thank you

3341
03:43:27,880 --> 03:43:38,750
[Music]

3342
03:43:39,479 --> 03:43:41,510
foreign

3343
03:43:41,510 --> 03:44:06,000
[Music]

3344
03:44:06,000 --> 03:44:09,000
foreign

3345
03:44:11,220 --> 03:44:14,220
foreign

3346
03:44:15,290 --> 03:44:41,340
[Music]

3347
03:44:41,340 --> 03:44:44,340
foreign

3348
03:44:47,980 --> 03:45:11,939
[Music]

3349
03:45:11,939 --> 03:45:13,510
foreign

3350
03:45:13,510 --> 03:45:42,000
[Music]

3351
03:45:42,000 --> 03:45:45,000
foreign

3352
03:45:48,010 --> 03:46:04,979
[Music]

3353
03:46:17,030 --> 03:46:20,169
[Music]

3354
03:46:23,100 --> 03:46:26,100
foreign

3355
03:46:40,850 --> 03:46:44,009
[Music]

3356
03:46:48,610 --> 03:46:52,719
[Music]

3357
03:47:01,500 --> 03:47:04,500
foreign

3358
03:47:12,940 --> 03:47:17,660
[Music]

3359
03:47:26,320 --> 03:47:29,690
[Music]

3360
03:47:36,990 --> 03:47:40,199
[Music]

3361
03:47:56,040 --> 03:47:58,160
thank you

3362
03:47:59,260 --> 03:48:05,069
[Music]

3363
03:48:08,960 --> 03:48:12,089
[Music]

3364
03:48:16,260 --> 03:48:19,260
foreign

3365
03:48:31,070 --> 03:48:34,149
[Music]

3366
03:49:13,260 --> 03:49:16,160
foreign

3367
03:49:25,230 --> 03:49:33,039
[Music]

3368
03:49:43,680 --> 03:49:46,680
foreign

3369
03:50:16,200 --> 03:50:19,200
foreign

3370
03:50:54,840 --> 03:50:58,360
[Music]

3371
03:51:04,080 --> 03:51:07,080
foreign

3372
03:51:35,340 --> 03:51:38,340
foreign

3373
03:51:46,190 --> 03:52:21,799
[Music]

3374
03:52:22,279 --> 03:52:23,810
thank you

3375
03:52:23,810 --> 03:52:33,799
[Music]

3376
03:52:34,460 --> 03:52:38,640
foreign foreign

3377
03:52:42,290 --> 03:53:12,300
[Music]

3378
03:53:12,300 --> 03:53:15,300
foreign

3379
03:53:18,300 --> 03:54:12,300
[Music]

3380
03:54:12,300 --> 03:54:15,300
foreign

3381
03:54:18,280 --> 03:54:27,070
[Music]

3382
03:54:35,330 --> 03:54:38,469
[Music]

3383
03:54:59,150 --> 03:55:01,140
[Music]

3384
03:55:01,140 --> 03:55:03,800
foreign

3385
03:55:07,610 --> 03:55:11,019
[Music]

3386
03:55:16,500 --> 03:55:19,500
foreign

3387
03:55:31,240 --> 03:55:35,958
[Music]

3388
03:55:44,620 --> 03:55:47,999
[Music]

3389
03:55:50,220 --> 03:55:53,220
foreign

3390
03:55:55,290 --> 03:55:58,509
[Music]

3391
03:56:17,560 --> 03:56:20,399
[Music]

3392
03:56:20,399 --> 03:56:22,580
foreign

3393
03:56:27,250 --> 03:56:30,389
[Music]

3394
03:56:56,100 --> 03:56:59,100
foreign

3395
03:57:26,819 --> 03:57:29,119
foreign

3396
03:57:43,720 --> 03:57:51,329
[Music]

3397
03:57:56,520 --> 03:57:59,520
foreign

3398
03:58:34,510 --> 03:58:38,600
[Music]

3399
03:58:48,420 --> 03:58:51,260
foreign

3400
03:59:13,320 --> 03:59:16,660
[Music]

3401
03:59:22,380 --> 03:59:25,380
foreign

3402
03:59:53,640 --> 03:59:56,599
foreign

3403
04:00:04,490 --> 04:00:19,128
[Music]

3404
04:00:23,819 --> 04:00:26,819
foreign

3405
04:00:27,900 --> 04:00:53,880
[Music]

3406
04:00:53,880 --> 04:00:56,880
foreign

3407
04:01:00,590 --> 04:01:24,720
[Music]

3408
04:01:24,720 --> 04:01:26,180
foreign

3409
04:01:26,180 --> 04:01:30,660
[Music]

3410
04:01:30,660 --> 04:01:33,660
foreign

3411
04:01:36,600 --> 04:02:13,040
[Music]

3412
04:02:13,880 --> 04:02:15,910
thank you

3413
04:02:15,910 --> 04:02:31,128
[Music]

3414
04:02:36,000 --> 04:02:38,250
foreign

3415
04:02:38,250 --> 04:02:41,569
[Music]

3416
04:02:53,640 --> 04:02:56,779
[Music]

3417
04:03:17,460 --> 04:03:20,609
[Music]

3418
04:03:25,210 --> 04:03:29,320
[Music]

3419
04:03:30,540 --> 04:03:33,500
foreign

3420
04:03:49,540 --> 04:03:54,260
[Music]

3421
04:03:56,699 --> 04:03:58,880
foreign

3422
04:04:02,930 --> 04:04:06,299
[Music]

3423
04:04:13,600 --> 04:04:16,809
[Music]

3424
04:04:36,000 --> 04:04:38,540
foreign

3425
04:04:38,540 --> 04:04:41,669
[Music]

3426
04:04:45,550 --> 04:04:48,689
[Music]

3427
04:05:07,670 --> 04:05:10,760
[Music]

3428
04:05:38,779 --> 04:05:42,140
thank you

3429
04:05:53,279 --> 04:05:55,520
foreign

3430
04:06:01,820 --> 04:06:09,628
[Music]

3431
04:06:20,460 --> 04:06:22,580
thank you

3432
04:06:53,790 --> 04:06:56,929
[Music]

3433
04:06:59,960 --> 04:07:03,019
thank you

3434
04:07:27,479 --> 04:07:29,599
thank you

3435
04:07:31,610 --> 04:07:34,959
[Music]

3436
04:07:57,180 --> 04:08:00,180
foreign

3437
04:08:22,790 --> 04:08:33,660
[Music]

3438
04:08:34,380 --> 04:08:36,410
foreign

3439
04:08:36,410 --> 04:09:01,430
[Music]

3440
04:09:06,120 --> 04:09:09,120
foreign

3441
04:09:10,200 --> 04:09:36,180
[Music]

3442
04:09:36,180 --> 04:09:39,180
foreign

3443
04:09:42,890 --> 04:10:20,540
[Music]

3444
04:10:20,540 --> 04:10:23,400
thank you

3445
04:10:23,400 --> 04:10:36,840
[Music]

3446
04:10:36,840 --> 04:10:39,840
foreign

3447
04:10:42,910 --> 04:11:03,680
[Music]

3448
04:11:11,940 --> 04:11:15,079
[Music]

3449
04:11:18,120 --> 04:11:21,120
foreign

3450
04:11:35,760 --> 04:11:38,909
[Music]

3451
04:11:43,530 --> 04:11:47,620
[Music]

3452
04:11:49,080 --> 04:11:51,920
foreign

3453
04:12:07,840 --> 04:12:12,560
[Music]

3454
04:12:18,840 --> 04:12:21,230
foreign

3455
04:12:21,230 --> 04:12:24,600
[Music]

3456
04:12:31,900 --> 04:12:35,109
[Music]

3457
04:12:49,380 --> 04:12:52,380
foreign

3458
04:12:54,180 --> 04:12:59,979
[Music]

3459
04:13:03,850 --> 04:13:06,989
[Music]

3460
04:13:25,980 --> 04:13:29,059
[Music]

3461
04:13:32,819 --> 04:13:35,000
foreign

3462
04:14:06,660 --> 04:14:09,080
foreign

3463
04:14:20,130 --> 04:14:27,929
[Music]

3464
04:14:40,199 --> 04:14:42,439
foreign

3465
04:15:12,090 --> 04:15:15,229
[Music]

3466
04:15:19,160 --> 04:15:22,160
thank you

3467
04:15:49,740 --> 04:15:53,270
[Music]

3468
04:15:58,979 --> 04:16:01,979
foreign

3469
04:16:15,180 --> 04:16:18,180
foreign

3470
04:16:41,090 --> 04:16:51,959
[Music]

3471
04:16:52,620 --> 04:16:54,720
foreign

3472
04:16:54,720 --> 04:17:19,729
[Music]

3473
04:17:24,479 --> 04:17:27,479
foreign

3474
04:17:28,500 --> 04:17:55,199
[Music]

3475
04:17:55,199 --> 04:17:58,199
foreign

3476
04:18:01,190 --> 04:18:43,669
[Music]

3477
04:18:47,180 --> 04:18:49,170
thank you

3478
04:18:49,170 --> 04:19:07,739
[Music]

3479
04:19:12,479 --> 04:19:14,870
foreign

3480
04:19:14,870 --> 04:19:18,189
[Music]

3481
04:19:30,240 --> 04:19:33,389
[Music]

3482
04:19:54,060 --> 04:19:57,219
[Music]

3483
04:20:01,820 --> 04:20:05,930
[Music]

3484
04:20:11,460 --> 04:20:13,640
foreign

3485
04:20:26,150 --> 04:20:30,869
[Music]

3486
04:20:37,140 --> 04:20:39,530
foreign

3487
04:20:39,530 --> 04:20:42,899
[Music]

3488
04:20:50,200 --> 04:20:53,409
[Music]

3489
04:21:07,319 --> 04:21:09,439
thank you

3490
04:21:12,470 --> 04:21:18,299
[Music]

3491
04:21:22,150 --> 04:21:25,299
[Music]

3492
04:21:30,600 --> 04:21:33,790
[Music]

3493
04:21:44,880 --> 04:21:47,060
foreign

3494
04:22:17,100 --> 04:22:20,100
foreign

3495
04:22:38,440 --> 04:22:46,249
[Music]

3496
04:22:47,699 --> 04:22:50,699
foreign

3497
04:23:36,500 --> 04:23:39,500
thank you

3498
04:24:08,050 --> 04:24:10,380
[Music]

3499
04:24:10,380 --> 04:24:12,679
foreign

3500
04:24:33,479 --> 04:24:36,479
foreign

3501
04:24:59,400 --> 04:25:09,960
[Music]

3502
04:25:09,960 --> 04:25:10,820
foreign

3503
04:25:10,820 --> 04:25:38,029
[Music]

3504
04:25:42,720 --> 04:25:45,720
foreign

3505
04:25:46,800 --> 04:26:14,009
[Music]

3506
04:26:18,720 --> 04:26:21,090
foreign

3507
04:26:21,090 --> 04:26:49,979
[Music]

3508
04:26:53,939 --> 04:26:56,939
foreign

3509
04:26:57,080 --> 04:27:25,500
[Music]

3510
04:27:25,500 --> 04:27:28,500
foreign

3511
04:27:31,490 --> 04:27:40,280
[Music]

3512
04:27:48,540 --> 04:27:51,679
[Music]

3513
04:28:12,370 --> 04:28:14,279
[Music]

3514
04:28:14,279 --> 04:28:17,060
foreign

3515
04:28:20,120 --> 04:28:24,229
[Music]

3516
04:28:29,699 --> 04:28:32,659
foreign

3517
04:28:44,450 --> 04:28:49,170
[Music]

3518
04:28:57,840 --> 04:29:01,209
[Music]

3519
04:29:06,239 --> 04:29:08,500
foreign

3520
04:29:08,500 --> 04:29:11,719
[Music]

3521
04:29:31,500 --> 04:29:33,450
foreign

3522
04:29:33,450 --> 04:29:36,599
[Music]

3523
04:29:40,460 --> 04:29:43,599
[Music]

3524
04:30:02,580 --> 04:30:05,670
[Music]

3525
04:30:33,680 --> 04:30:36,739
thank you

3526
04:30:40,080 --> 04:30:42,199
thank you

3527
04:30:56,730 --> 04:31:04,539
[Music]

3528
04:31:09,720 --> 04:31:12,720
foreign

3529
04:31:48,700 --> 04:31:51,829
[Music]

3530
04:32:12,720 --> 04:32:14,840
thank you

3531
04:32:26,530 --> 04:32:29,889
[Music]

3532
04:32:35,580 --> 04:32:38,580
foreign

3533
04:33:06,840 --> 04:33:09,799
foreign

3534
04:33:17,700 --> 04:33:32,339
[Music]

3535
04:33:37,080 --> 04:33:40,080
foreign

3536
04:33:41,110 --> 04:34:07,799
[Music]

3537
04:34:07,799 --> 04:34:10,799
foreign

3538
04:34:13,199 --> 04:34:16,199
foreign

3539
04:34:17,118 --> 04:34:56,278
[Music]

3540
04:35:00,259 --> 04:35:01,810
thank you

3541
04:35:01,810 --> 04:35:31,680
[Music]

3542
04:35:31,680 --> 04:35:34,680
foreign

3543
04:35:37,820 --> 04:35:58,589
[Music]

3544
04:36:06,848 --> 04:36:09,979
[Music]

3545
04:36:13,020 --> 04:36:16,020
foreign

3546
04:36:30,669 --> 04:36:33,819
[Music]

3547
04:36:38,419 --> 04:36:42,529
[Music]

3548
04:36:43,259 --> 04:36:46,259
foreign

3549
04:37:02,750 --> 04:37:07,469
[Music]

3550
04:37:09,958 --> 04:37:12,141
foreign

3551
04:37:16,140 --> 04:37:19,508
[Music]

3552
04:37:26,810 --> 04:37:30,019
[Music]

3553
04:37:43,919 --> 04:37:46,919
foreign

3554
04:37:49,080 --> 04:37:54,880
[Music]

3555
04:37:58,758 --> 04:38:01,898
[Music]

3556
04:39:02,820 --> 04:39:05,820
foreign

3557
04:39:15,040 --> 04:39:22,840
[Music]

3558
04:39:33,660 --> 04:39:36,259
thank you

3559
04:40:07,000 --> 04:40:10,110
[Music]

3560
04:40:14,240 --> 04:40:17,240
thank you

3561
04:40:44,830 --> 04:40:48,179
[Music]

3562
04:40:53,878 --> 04:40:56,878
foreign

3563
04:41:10,378 --> 04:41:13,378
foreign

3564
04:41:36,000 --> 04:41:46,869
[Music]

3565
04:41:47,580 --> 04:41:49,630
foreign

3566
04:41:49,630 --> 04:42:14,640
[Music]

3567
04:42:19,320 --> 04:42:22,320
foreign

3568
04:42:23,410 --> 04:42:50,100
[Music]

3569
04:42:50,100 --> 04:42:53,100
foreign

3570
04:42:56,100 --> 04:43:38,569
[Music]

3571
04:43:42,020 --> 04:43:44,080
thank you

3572
04:43:44,080 --> 04:44:02,639
[Music]

3573
04:44:07,378 --> 04:44:09,780
foreign

3574
04:44:09,780 --> 04:44:16,890
[Music]

3575
04:44:25,150 --> 04:44:28,289
[Music]

3576
04:44:46,130 --> 04:44:52,119
[Music]

3577
04:44:56,730 --> 04:45:00,840
[Music]

3578
04:45:06,360 --> 04:45:08,540
foreign

3579
04:45:21,050 --> 04:45:25,770
[Music]

3580
04:45:32,638 --> 04:45:34,440
foreign

3581
04:45:34,440 --> 04:45:37,809
[Music]

3582
04:45:45,110 --> 04:45:48,319
[Music]

3583
04:46:02,580 --> 04:46:05,540
foreign

3584
04:46:07,390 --> 04:46:13,200
[Music]

3585
04:46:17,070 --> 04:46:20,200
[Music]

3586
04:46:25,520 --> 04:46:28,709
[Music]

3587
04:46:31,680 --> 04:46:34,680
foreign

3588
04:46:39,190 --> 04:46:42,270
[Music]

3589
04:47:15,000 --> 04:47:17,120
thank you

3590
04:47:33,340 --> 04:47:41,139
[Music]

3591
04:47:53,400 --> 04:47:55,638
foreign

3592
04:48:11,700 --> 04:48:14,760
all right uh welcome everyone to our uh

3593
04:48:14,760 --> 04:48:16,860
two o'clock uh session here on track

3594
04:48:16,860 --> 04:48:19,500
three this is uh security operations

3595
04:48:19,500 --> 04:48:22,138
with Velociraptor please give a warm

3596
04:48:22,138 --> 04:48:24,120
welcome to Whitney champion and Eric

3597
04:48:24,120 --> 04:48:25,920
capuano

3598
04:48:25,920 --> 04:48:28,160
foreign

3599
04:48:29,240 --> 04:48:32,409
[Applause]

3600
04:48:38,718 --> 04:48:41,580
you all carving out the time to come and

3601
04:48:41,580 --> 04:48:43,860
uh sit here and hear our talk here

3602
04:48:43,860 --> 04:48:45,718
um if you've uh if you followed Recon or

3603
04:48:45,718 --> 04:48:47,458
Whitney and I for any amount of time you

3604
04:48:47,458 --> 04:48:49,138
know that not only are we big fans of

3605
04:48:49,138 --> 04:48:50,760
velociraptor we're actually big fans of

3606
04:48:50,760 --> 04:48:52,378
Open Source Tools in general right

3607
04:48:52,378 --> 04:48:53,878
especially those that don't have the

3608
04:48:53,878 --> 04:48:55,440
marketing budgets to go out there and

3609
04:48:55,440 --> 04:48:56,820
compete with the guys that are running

3610
04:48:56,820 --> 04:48:59,280
black cat booths right so Velociraptor

3611
04:48:59,280 --> 04:49:00,240
is kind of near and dear to our heart

3612
04:49:00,240 --> 04:49:01,320
for a lot of reasons and we're going to

3613
04:49:01,320 --> 04:49:02,458
talk about some of those reasons here

3614
04:49:02,458 --> 04:49:03,780
today

3615
04:49:03,780 --> 04:49:05,580
um so uh without further Ado I'll go

3616
04:49:05,580 --> 04:49:08,040
over a quick intro so my name is Eric

3617
04:49:08,040 --> 04:49:10,500
capuano I'm a co-founder of Recon

3618
04:49:10,500 --> 04:49:12,360
infosec I do a couple of things as well

3619
04:49:12,360 --> 04:49:14,458
in the deeper Community I teach uh for

3620
04:49:14,458 --> 04:49:16,740
Sans and the digital forensics track and

3621
04:49:16,740 --> 04:49:18,660
uh some black hat stuff each year which

3622
04:49:18,660 --> 04:49:20,400
we have a lot of fun doing

3623
04:49:20,400 --> 04:49:21,660
um but one of the other things on this

3624
04:49:21,660 --> 04:49:22,920
slide that I like to call some attention

3625
04:49:22,920 --> 04:49:25,200
to some folks are familiar with opensock

3626
04:49:25,200 --> 04:49:26,940
is actually something that Whitney and I

3627
04:49:26,940 --> 04:49:29,400
kind of uh built over a couple of years

3628
04:49:29,400 --> 04:49:32,160
a lot of labor of love but one of the

3629
04:49:32,160 --> 04:49:33,840
things we love about open stock is it's

3630
04:49:33,840 --> 04:49:35,820
uh first of all it's a blue team CTF and

3631
04:49:35,820 --> 04:49:37,980
it's a very very big one we run it at

3632
04:49:37,980 --> 04:49:39,900
Defcon just about every year and we've

3633
04:49:39,900 --> 04:49:41,700
run it uh many other events including

3634
04:49:41,700 --> 04:49:45,000
cactuscon back in 2019 which I've got to

3635
04:49:45,000 --> 04:49:47,520
First give a quick hat tip we've we are

3636
04:49:47,520 --> 04:49:49,680
such big fans of cactus cotton for a lot

3637
04:49:49,680 --> 04:49:51,000
of reasons

3638
04:49:51,000 --> 04:49:54,900
um but but uh I would say personally one

3639
04:49:54,900 --> 04:49:56,940
of the reasons I I love Cactus con is

3640
04:49:56,940 --> 04:49:59,760
because of the uh the concentration of

3641
04:49:59,760 --> 04:50:01,378
up and coming folks that you meet here

3642
04:50:01,378 --> 04:50:03,060
right there's a lot of conferences to go

3643
04:50:03,060 --> 04:50:05,280
to where it's just there's just a whole

3644
04:50:05,280 --> 04:50:06,958
lot of I've been in this space for 10

3645
04:50:06,958 --> 04:50:08,340
years and you know I do all these things

3646
04:50:08,340 --> 04:50:10,500
that's great and all but I love seeing

3647
04:50:10,500 --> 04:50:12,060
the high school students the college

3648
04:50:12,060 --> 04:50:13,500
students the folks that are trying to

3649
04:50:13,500 --> 04:50:15,660
break into this space cactuscon just

3650
04:50:15,660 --> 04:50:17,760
brings those folks in droves and that's

3651
04:50:17,760 --> 04:50:19,200
where I feel like I can come and show up

3652
04:50:19,200 --> 04:50:20,878
and have some awesome conversations that

3653
04:50:20,878 --> 04:50:22,200
might actually move the needle for

3654
04:50:22,200 --> 04:50:23,940
somebody trying to get a foot in this

3655
04:50:23,940 --> 04:50:25,680
space and so I love cactuscon because

3656
04:50:25,680 --> 04:50:27,180
they really are doing a lot of things

3657
04:50:27,180 --> 04:50:28,860
well and that's one of them

3658
04:50:28,860 --> 04:50:30,780
um so that's me in a nutshell let me

3659
04:50:30,780 --> 04:50:32,400
hand it off to the actual Magician on

3660
04:50:32,400 --> 04:50:34,680
stage here when with me

3661
04:50:34,680 --> 04:50:36,660
which button do I push

3662
04:50:36,660 --> 04:50:39,718
the big one sweet

3663
04:50:39,718 --> 04:50:41,820
um I'm Whitney Champion I see a lot of

3664
04:50:41,820 --> 04:50:43,920
familiar faces in here which is awesome

3665
04:50:43,920 --> 04:50:45,718
um I'm the lead architect and co-founder

3666
04:50:45,718 --> 04:50:48,780
uh as well at Recon infosec

3667
04:50:48,780 --> 04:50:51,420
um formerly uh Red Hat Booz Allen and

3668
04:50:51,420 --> 04:50:52,560
spey War

3669
04:50:52,560 --> 04:50:53,820
um some of you may be familiar with

3670
04:50:53,820 --> 04:50:56,760
hacker tracker that was my brainchild of

3671
04:50:56,760 --> 04:50:59,218
almost 11 years ago now I was really

3672
04:50:59,218 --> 04:51:01,080
excited to see Cactus Connor this year

3673
04:51:01,080 --> 04:51:02,878
which was pretty awesome

3674
04:51:02,878 --> 04:51:04,860
um you may or may not have seen my Angry

3675
04:51:04,860 --> 04:51:06,060
stickers floating around the community

3676
04:51:06,060 --> 04:51:08,718
from time

3677
04:51:08,878 --> 04:51:12,240
um and as Eric mentioned uh opensock has

3678
04:51:12,240 --> 04:51:13,740
been a labor of love for us for the last

3679
04:51:13,740 --> 04:51:15,958
few years so I appreciate those of you

3680
04:51:15,958 --> 04:51:17,638
that have joined us at some of our

3681
04:51:17,638 --> 04:51:19,160
events

3682
04:51:19,160 --> 04:51:22,620
I would be remiss not to mention what is

3683
04:51:22,620 --> 04:51:24,480
recon who is Recon

3684
04:51:24,480 --> 04:51:25,798
um so we are a managed detection

3685
04:51:25,798 --> 04:51:27,240
response provider based out of Austin

3686
04:51:27,240 --> 04:51:28,440
Texas

3687
04:51:28,440 --> 04:51:29,940
um and in a sea of companies that

3688
04:51:29,940 --> 04:51:31,680
provide protection response one of the

3689
04:51:31,680 --> 04:51:32,400
things that we like to think

3690
04:51:32,400 --> 04:51:34,920
differentiates us is I've got a team of

3691
04:51:34,920 --> 04:51:35,940
some of the best and brightest

3692
04:51:35,940 --> 04:51:37,200
practitioners that I've had the pleasure

3693
04:51:37,200 --> 04:51:39,120
of working with in my career in cyber

3694
04:51:39,120 --> 04:51:41,400
security folks like Whitney Andrew cook

3695
04:51:41,400 --> 04:51:42,958
you might have heard from uh yesterday

3696
04:51:42,958 --> 04:51:45,420
talking about open Ai and chat GPT and

3697
04:51:45,420 --> 04:51:47,160
the use of security operations Marcus

3698
04:51:47,160 --> 04:51:48,840
Guevara gave a talk earlier today about

3699
04:51:48,840 --> 04:51:51,600
moving forward in memory forensics and

3700
04:51:51,600 --> 04:51:52,920
that's the kind of folks that we bring

3701
04:51:52,920 --> 04:51:54,958
together to offer a pretty top-notch

3702
04:51:54,958 --> 04:51:56,878
manage protection response capability uh

3703
04:51:56,878 --> 04:51:58,260
so if anybody in the room or listening

3704
04:51:58,260 --> 04:52:00,120
to the stream is looking for MDR

3705
04:52:00,120 --> 04:52:02,100
Provider from folks that do this stuff

3706
04:52:02,100 --> 04:52:03,840
night and day eat sleep and breathe it

3707
04:52:03,840 --> 04:52:06,420
that's who we are so let me give you a

3708
04:52:06,420 --> 04:52:07,500
quick agenda of what we're going to talk

3709
04:52:07,500 --> 04:52:09,480
about here today so first of all I'm

3710
04:52:09,480 --> 04:52:10,680
going to give a really quick brief

3711
04:52:10,680 --> 04:52:13,200
overview of what is Velociraptor right

3712
04:52:13,200 --> 04:52:14,940
it's been around a little while now so I

3713
04:52:14,940 --> 04:52:16,680
think Folks at least you've heard of it

3714
04:52:16,680 --> 04:52:18,420
maybe but I'm going to give a quick

3715
04:52:18,420 --> 04:52:20,280
overview before we dive into some of the

3716
04:52:20,280 --> 04:52:22,378
real awesome capabilities that this open

3717
04:52:22,378 --> 04:52:25,378
source free tool has provided to The

3718
04:52:25,378 --> 04:52:27,360
Blue Team community and then we're going

3719
04:52:27,360 --> 04:52:28,320
to get into some of those specific

3720
04:52:28,320 --> 04:52:30,120
capabilities that I think really are a

3721
04:52:30,120 --> 04:52:31,920
force multiplier not only for security

3722
04:52:31,920 --> 04:52:33,780
teams but even folks that are kind of

3723
04:52:33,780 --> 04:52:35,820
that dual hat like well I'm the it and

3724
04:52:35,820 --> 04:52:37,620
the security person okay you're gonna

3725
04:52:37,620 --> 04:52:39,480
love Velociraptor even more and I'm

3726
04:52:39,480 --> 04:52:41,218
going to show you some reasons why so

3727
04:52:41,218 --> 04:52:42,540
we'll get into some things like how you

3728
04:52:42,540 --> 04:52:44,638
can use it to deploy and monitor your

3729
04:52:44,638 --> 04:52:47,580
other agents right your EDR your AV your

3730
04:52:47,580 --> 04:52:49,080
log shipping agent whatever that is

3731
04:52:49,080 --> 04:52:51,120
Velociraptor can help you orchestrate

3732
04:52:51,120 --> 04:52:52,740
and manage those things we'll also get

3733
04:52:52,740 --> 04:52:54,540
into some of the magic that happens on

3734
04:52:54,540 --> 04:52:56,638
the server side of velociraptor where I

3735
04:52:56,638 --> 04:52:58,320
can say hey go do a thing on my

3736
04:52:58,320 --> 04:53:00,060
endpoints but then bring that stuff back

3737
04:53:00,060 --> 04:53:02,760
and then do more with that data at the

3738
04:53:02,760 --> 04:53:04,980
server side like enrichment alerting and

3739
04:53:04,980 --> 04:53:06,718
all kinds of good stuff as well and then

3740
04:53:06,718 --> 04:53:08,160
of course let's get into visibility of

3741
04:53:08,160 --> 04:53:09,900
our endpoints interrogation of our

3742
04:53:09,900 --> 04:53:11,580
endpoints looking for threat actors

3743
04:53:11,580 --> 04:53:13,200
right things of that nature and then

3744
04:53:13,200 --> 04:53:14,638
some of the other cool things that a lot

3745
04:53:14,638 --> 04:53:15,900
of folks don't realize we can do a

3746
04:53:15,900 --> 04:53:18,060
velociraptor like real-time event

3747
04:53:18,060 --> 04:53:20,340
generation right actually generating

3748
04:53:20,340 --> 04:53:22,138
Telemetry and shipping that Telemetry

3749
04:53:22,138 --> 04:53:23,820
back which is especially important to

3750
04:53:23,820 --> 04:53:25,560
instant responders especially like if

3751
04:53:25,560 --> 04:53:27,540
you're like me I'm a consultant I drop

3752
04:53:27,540 --> 04:53:28,798
into an environment I've never seen

3753
04:53:28,798 --> 04:53:30,718
before I don't have a seam set up

3754
04:53:30,718 --> 04:53:31,980
somewhere and guess what the customer

3755
04:53:31,980 --> 04:53:34,080
doesn't either and so I can use

3756
04:53:34,080 --> 04:53:35,760
Velociraptor to very quickly start

3757
04:53:35,760 --> 04:53:37,260
generating the Telemetry I care about

3758
04:53:37,260 --> 04:53:39,660
and already centralizing it so it's like

3759
04:53:39,660 --> 04:53:42,480
having a seam in a split second we'll

3760
04:53:42,480 --> 04:53:43,798
talk about threat hunt detection and

3761
04:53:43,798 --> 04:53:45,540
then of course instant response when it

3762
04:53:45,540 --> 04:53:48,120
hits the fan Velociraptor is just about

3763
04:53:48,120 --> 04:53:49,798
all you need to get in there find the

3764
04:53:49,798 --> 04:53:52,020
threat actor contain and even remediate

3765
04:53:52,020 --> 04:53:53,940
so as you can see here it's a full

3766
04:53:53,940 --> 04:53:55,798
spectrum tool it the only limit to what

3767
04:53:55,798 --> 04:53:58,138
it can do is your imagination so really

3768
04:53:58,138 --> 04:54:00,000
briefly what is it

3769
04:54:00,000 --> 04:54:01,320
um so I actually stole this slide from

3770
04:54:01,320 --> 04:54:03,120
Mike Cohen who's actually the original

3771
04:54:03,120 --> 04:54:05,340
author and creator of velociraptor so

3772
04:54:05,340 --> 04:54:06,540
this is pulled from one of his decks

3773
04:54:06,540 --> 04:54:07,740
because it's just a great illustration

3774
04:54:07,740 --> 04:54:10,320
of how simple it really is Velociraptor

3775
04:54:10,320 --> 04:54:12,780
folks is a very simple Standalone binary

3776
04:54:12,780 --> 04:54:16,320
that you can use to spin up a server and

3777
04:54:16,320 --> 04:54:17,940
then that same binary can then be

3778
04:54:17,940 --> 04:54:19,378
distributed across all of your your

3779
04:54:19,378 --> 04:54:20,958
clients your endpoints in your network

3780
04:54:20,958 --> 04:54:24,060
and within minutes you have a server

3781
04:54:24,060 --> 04:54:26,218
client distribution sort of architecture

3782
04:54:26,218 --> 04:54:28,620
where you can issue hunts you know

3783
04:54:28,620 --> 04:54:31,138
pullback data pull back sorry pull back

3784
04:54:31,138 --> 04:54:33,298
triage forensic data you name it lots of

3785
04:54:33,298 --> 04:54:34,440
lots of powerful things you can do with

3786
04:54:34,440 --> 04:54:36,540
it but the the power of it is that

3787
04:54:36,540 --> 04:54:38,580
server client sort of relationship right

3788
04:54:38,580 --> 04:54:39,958
because there's a lot of things you can

3789
04:54:39,958 --> 04:54:41,340
use already well why not just use

3790
04:54:41,340 --> 04:54:43,138
Powershell for that right there's some

3791
04:54:43,138 --> 04:54:44,820
really cool Powershell Frameworks like

3792
04:54:44,820 --> 04:54:46,798
Kanza and others I can do the same thing

3793
04:54:46,798 --> 04:54:49,138
with right sure if you're inside that

3794
04:54:49,138 --> 04:54:51,000
Network and you can hit those endpoints

3795
04:54:51,000 --> 04:54:53,040
yes things like Powershell get the job

3796
04:54:53,040 --> 04:54:54,958
done but see I don't have that luxury

3797
04:54:54,958 --> 04:54:56,700
right I drop into a customer environment

3798
04:54:56,700 --> 04:54:58,138
I don't have a foothold there I don't

3799
04:54:58,138 --> 04:55:01,138
have a system I can run queries from but

3800
04:55:01,138 --> 04:55:02,340
all I have to do is hand them this

3801
04:55:02,340 --> 04:55:04,138
Velociraptor agent say here just install

3802
04:55:04,138 --> 04:55:05,580
this and I'm going to do the rest

3803
04:55:05,580 --> 04:55:07,440
because it's going to connect back to my

3804
04:55:07,440 --> 04:55:10,080
server basically giving me a blue team

3805
04:55:10,080 --> 04:55:12,240
C2 shell folks that's what this is right

3806
04:55:12,240 --> 04:55:15,000
I'm gonna have an agent with system

3807
04:55:15,000 --> 04:55:17,280
level privileges on that box I can do

3808
04:55:17,280 --> 04:55:19,200
anything I need to do from an IR our

3809
04:55:19,200 --> 04:55:21,600
threat hunt you name it perspective so

3810
04:55:21,600 --> 04:55:23,878
incredibly powerful stuff you're

3811
04:55:23,878 --> 04:55:25,440
probably thinking okay well how complex

3812
04:55:25,440 --> 04:55:27,718
and difficult is this to get set up and

3813
04:55:27,718 --> 04:55:29,580
running it couldn't have been easier

3814
04:55:29,580 --> 04:55:31,500
right a little bit of background Mike

3815
04:55:31,500 --> 04:55:33,660
Cohen before he created Velociraptor was

3816
04:55:33,660 --> 04:55:35,400
also on the team that that created

3817
04:55:35,400 --> 04:55:36,958
Google rapid response if you're familiar

3818
04:55:36,958 --> 04:55:39,000
with gur right gur was incredible and

3819
04:55:39,000 --> 04:55:40,740
still is don't get me wrong one of the

3820
04:55:40,740 --> 04:55:42,780
downsides to girl though was it was like

3821
04:55:42,780 --> 04:55:44,160
well yeah it's great and it's powerful

3822
04:55:44,160 --> 04:55:46,200
but you kind of need a devops magician

3823
04:55:46,200 --> 04:55:47,638
to get that thing up and running and

3824
04:55:47,638 --> 04:55:50,040
keep it happy and healthy Mike said you

3825
04:55:50,040 --> 04:55:51,298
know what we could do this easier

3826
04:55:51,298 --> 04:55:53,520
simpler let's get less barriers in the

3827
04:55:53,520 --> 04:55:55,680
way of our blue team when you see how

3828
04:55:55,680 --> 04:55:57,480
easy it is to fire up a velociraptor

3829
04:55:57,480 --> 04:55:59,638
server and then run that client you're

3830
04:55:59,638 --> 04:56:01,020
going to think you did it wrong it was

3831
04:56:01,020 --> 04:56:03,840
just like wow I'm done that's it yes so

3832
04:56:03,840 --> 04:56:05,458
once you get that thing set up you fire

3833
04:56:05,458 --> 04:56:07,560
off that that executable which by the

3834
04:56:07,560 --> 04:56:09,360
way the executable that you use to run

3835
04:56:09,360 --> 04:56:11,340
the server is the exact same executable

3836
04:56:11,340 --> 04:56:12,840
you push to your clients just running

3837
04:56:12,840 --> 04:56:14,580
under a different configuration like

3838
04:56:14,580 --> 04:56:16,378
it's that easy so I could walk into a

3839
04:56:16,378 --> 04:56:17,638
customer environment with a thumb drive

3840
04:56:17,638 --> 04:56:20,160
with one EXE on it and have a full

3841
04:56:20,160 --> 04:56:21,560
Velociraptor

3842
04:56:21,560 --> 04:56:24,060
deployment up and running so once you

3843
04:56:24,060 --> 04:56:25,320
fire that thing up and you get it up and

3844
04:56:25,320 --> 04:56:27,180
running in your environment you'll log

3845
04:56:27,180 --> 04:56:29,520
into the web UI here and it's very

3846
04:56:29,520 --> 04:56:30,718
simple very easy to kind of navigate

3847
04:56:30,718 --> 04:56:32,340
this so what you see here is for

3848
04:56:32,340 --> 04:56:33,660
instance this is a list of all the

3849
04:56:33,660 --> 04:56:35,160
clients that are checking into my

3850
04:56:35,160 --> 04:56:36,958
Velociraptor server and they are

3851
04:56:36,958 --> 04:56:39,660
connected in real time right so if I

3852
04:56:39,660 --> 04:56:41,638
issue a command to one or a thousand

3853
04:56:41,638 --> 04:56:43,680
systems that execution is happening

3854
04:56:43,680 --> 04:56:45,718
immediately right so it's very

3855
04:56:45,718 --> 04:56:48,480
asynchronous real-time communication and

3856
04:56:48,480 --> 04:56:49,560
a couple things you can see on this

3857
04:56:49,560 --> 04:56:51,000
slide for instance you got just basic

3858
04:56:51,000 --> 04:56:53,580
information like the host name of the

3859
04:56:53,580 --> 04:56:55,560
system the full quality a full qualified

3860
04:56:55,560 --> 04:56:58,020
domain name the OS version the patch

3861
04:56:58,020 --> 04:56:59,940
level what have you some labels which

3862
04:56:59,940 --> 04:57:01,378
actually plays a pretty important part

3863
04:57:01,378 --> 04:57:03,298
as well because I can tag certain

3864
04:57:03,298 --> 04:57:05,520
systems with certain labels that help me

3865
04:57:05,520 --> 04:57:08,340
Target hunts or Target some of my maybe

3866
04:57:08,340 --> 04:57:10,680
more sysadmin-like work like I want to

3867
04:57:10,680 --> 04:57:12,298
push system onto these systems but not

3868
04:57:12,298 --> 04:57:14,638
these systems and so on and so forth so

3869
04:57:14,638 --> 04:57:16,740
really cool really basic uh client view

3870
04:57:16,740 --> 04:57:18,360
there but let's say I wanted to drill

3871
04:57:18,360 --> 04:57:20,100
into one of my those clients like I'm

3872
04:57:20,100 --> 04:57:22,080
going to pick on this system here and I

3873
04:57:22,080 --> 04:57:23,700
can just simply click in on this

3874
04:57:23,700 --> 04:57:25,680
client's ID and then now what I'm

3875
04:57:25,680 --> 04:57:28,260
looking at here is a deeper dive kind of

3876
04:57:28,260 --> 04:57:31,080
overview of that particular system and

3877
04:57:31,080 --> 04:57:32,940
this is where you name it your your

3878
04:57:32,940 --> 04:57:34,798
imagination is the only limit of what I

3879
04:57:34,798 --> 04:57:36,780
can do to this machine so what I could

3880
04:57:36,780 --> 04:57:38,878
do is I could drill down to a shell on

3881
04:57:38,878 --> 04:57:41,280
that box run secure Powershell CMD

3882
04:57:41,280 --> 04:57:43,378
whatever bash on your Linux boxes or

3883
04:57:43,378 --> 04:57:44,878
what have you I can drive I can dive

3884
04:57:44,878 --> 04:57:46,560
into the file system you name it now I'm

3885
04:57:46,560 --> 04:57:47,638
going to show you a lot of that stuff

3886
04:57:47,638 --> 04:57:49,378
later so I'm going to kind of keep going

3887
04:57:49,378 --> 04:57:51,718
here for for a sake of time but uh let

3888
04:57:51,718 --> 04:57:53,520
me uh hand over to Whitney to talk about

3889
04:57:53,520 --> 04:57:57,540
some of the more uh it slash security

3890
04:57:57,540 --> 04:57:59,820
related functions like being able to

3891
04:57:59,820 --> 04:58:01,798
manage other security agents with

3892
04:58:01,798 --> 04:58:04,638
velociraptor

3893
04:58:04,740 --> 04:58:07,820
um so one of the things

3894
04:58:08,370 --> 04:58:10,560
[Music]

3895
04:58:10,560 --> 04:58:12,240
one of the things that we do a lot of at

3896
04:58:12,240 --> 04:58:14,940
Recon uh as Eric mentioned we are an MDR

3897
04:58:14,940 --> 04:58:16,798
so we obviously do a lot of agent

3898
04:58:16,798 --> 04:58:19,020
orchestration and as any of you in the

3899
04:58:19,020 --> 04:58:20,458
field know that is

3900
04:58:20,458 --> 04:58:23,580
not always the most fun task at hand uh

3901
04:58:23,580 --> 04:58:25,378
but Velociraptor actually makes this

3902
04:58:25,378 --> 04:58:27,298
pretty painless

3903
04:58:27,298 --> 04:58:28,260
um so

3904
04:58:28,260 --> 04:58:31,138
um in this example we're going to deploy

3905
04:58:31,138 --> 04:58:33,540
sysmon to all our window systems and

3906
04:58:33,540 --> 04:58:35,760
Velociraptor already comes with a ton of

3907
04:58:35,760 --> 04:58:37,740
artifacts already built into it so the

3908
04:58:37,740 --> 04:58:39,420
cisma and CIS internals artifact has

3909
04:58:39,420 --> 04:58:42,120
already bundled up with Velociraptor

3910
04:58:42,120 --> 04:58:45,180
when you deploy it which is super great

3911
04:58:45,180 --> 04:58:47,340
um so we in in our case you can deploy

3912
04:58:47,340 --> 04:58:49,200
this one when logbeat file beat as Eric

3913
04:58:49,200 --> 04:58:52,200
mentioned an ADR tool anything you want

3914
04:58:52,200 --> 04:58:53,400
to deploy to

3915
04:58:53,400 --> 04:58:55,560
five systems to five thousand systems

3916
04:58:55,560 --> 04:58:56,940
you can do it with the click of a button

3917
04:58:56,940 --> 04:58:59,280
so in this example we're going to deploy

3918
04:58:59,280 --> 04:59:03,480
the sysmon to all of our Windows systems

3919
04:59:03,480 --> 04:59:04,740
um

3920
04:59:04,740 --> 04:59:08,040
you can pick more than 100 or excuse me

3921
04:59:08,040 --> 04:59:09,480
more than one artifact to run against

3922
04:59:09,480 --> 04:59:11,878
any any hunt that you can figure but in

3923
04:59:11,878 --> 04:59:13,200
this case we're just going to grab the

3924
04:59:13,200 --> 04:59:15,440
sysmon the scissors hurdles

3925
04:59:15,440 --> 04:59:18,958
artifact and so Velociraptor has this

3926
04:59:18,958 --> 04:59:22,560
really cool ability which in go ahead

3927
04:59:22,560 --> 04:59:24,840
and so aptly named tools but um

3928
04:59:24,840 --> 04:59:26,280
essentially

3929
04:59:26,280 --> 04:59:28,798
at all than a taller than at all

3930
04:59:28,798 --> 04:59:31,260
um but what it does is basically the

3931
04:59:31,260 --> 04:59:34,440
tools artifact says that hey you can go

3932
04:59:34,440 --> 04:59:36,900
grab the binary or the config file or

3933
04:59:36,900 --> 04:59:39,060
whatever it is you need to deploy XYZ on

3934
04:59:39,060 --> 04:59:40,980
a system and it pulls it down locally

3935
04:59:40,980 --> 04:59:42,840
and serves it up on the same

3936
04:59:42,840 --> 04:59:44,160
Velociraptor instance that you're

3937
04:59:44,160 --> 04:59:47,458
running so the client system or your

3938
04:59:47,458 --> 04:59:49,798
endpoint doesn't have to go out and grab

3939
04:59:49,798 --> 04:59:51,360
it from somewhere else that may or may

3940
04:59:51,360 --> 04:59:53,040
not be blocked on the network so it's

3941
04:59:53,040 --> 04:59:55,260
already going to take advantage of the

3942
04:59:55,260 --> 04:59:56,638
connection that it's already got with

3943
04:59:56,638 --> 04:59:59,160
Velociraptor at that time pull that down

3944
04:59:59,160 --> 05:00:01,138
onto the endpoint and deploy it from

3945
05:00:01,138 --> 05:00:02,100
there

3946
05:00:02,100 --> 05:00:04,680
um the other Advantage is that if you're

3947
05:00:04,680 --> 05:00:06,000
going to go run this again if you need

3948
05:00:06,000 --> 05:00:07,740
to do an update it'll cache that on the

3949
05:00:07,740 --> 05:00:09,060
endpoint so it doesn't have to go

3950
05:00:09,060 --> 05:00:12,060
re-download anything redeploy Etc

3951
05:00:12,060 --> 05:00:15,440
so it makes it super simple

3952
05:00:17,940 --> 05:00:20,040
um but obviously we don't want to have

3953
05:00:20,040 --> 05:00:21,780
to go and do this to every endpoint we

3954
05:00:21,780 --> 05:00:23,520
don't want to go run a hunt every time

3955
05:00:23,520 --> 05:00:25,680
we want to deploy this either so the

3956
05:00:25,680 --> 05:00:27,660
cool thing about Velociraptor is it has

3957
05:00:27,660 --> 05:00:29,340
this thing called client event

3958
05:00:29,340 --> 05:00:30,840
monitoring which some of you may be

3959
05:00:30,840 --> 05:00:33,120
familiar with

3960
05:00:33,120 --> 05:00:34,020
um

3961
05:00:34,020 --> 05:00:35,940
so basically it's a certain and forget

3962
05:00:35,940 --> 05:00:39,298
it method to deploy uh XYZ to any

3963
05:00:39,298 --> 05:00:41,040
endpoint that checks in with a label of

3964
05:00:41,040 --> 05:00:43,378
your choosing so in our case Recon 99

3965
05:00:43,378 --> 05:00:45,660
we're going to want to deploy sysmon to

3966
05:00:45,660 --> 05:00:47,280
all the windows systems with this label

3967
05:00:47,280 --> 05:00:49,020
every time they check them for the first

3968
05:00:49,020 --> 05:00:51,298
time and then continue to monitor that

3969
05:00:51,298 --> 05:00:54,298
as we go so say a system sysmon just

3970
05:00:54,298 --> 05:00:57,900
drops off for some reason or adversary X

3971
05:00:57,900 --> 05:01:00,000
goes and kills this month well guess

3972
05:01:00,000 --> 05:01:01,500
what 10 minutes later is going to come

3973
05:01:01,500 --> 05:01:03,298
right back because we told it to and we

3974
05:01:03,298 --> 05:01:05,638
don't have to do anything

3975
05:01:05,638 --> 05:01:08,520
um so in our case like I said Recon 99

3976
05:01:08,520 --> 05:01:10,378
we're gonna kick off this artifact

3977
05:01:10,378 --> 05:01:11,820
that's going to run in the background of

3978
05:01:11,820 --> 05:01:14,760
velociraptor every X minutes

3979
05:01:14,760 --> 05:01:17,160
continuously

3980
05:01:17,160 --> 05:01:20,760
so this is an example of that artifact

3981
05:01:20,760 --> 05:01:22,820
um

3982
05:01:24,420 --> 05:01:25,798
so this is what the artifact actually

3983
05:01:25,798 --> 05:01:27,780
looks like and before I go any further

3984
05:01:27,780 --> 05:01:29,760
into this if you how many of you have

3985
05:01:29,760 --> 05:01:32,878
messed with Velociraptor before

3986
05:01:32,878 --> 05:01:35,218
okay so only a handful of you probably

3987
05:01:35,218 --> 05:01:37,200
even know what vql is so it's yet

3988
05:01:37,200 --> 05:01:38,760
another query language for those of you

3989
05:01:38,760 --> 05:01:40,138
who are already fatigued with query

3990
05:01:40,138 --> 05:01:42,900
languages so that's fun it is not for

3991
05:01:42,900 --> 05:01:44,400
the faint of heart but it is super

3992
05:01:44,400 --> 05:01:46,378
powerful if you under wield it and in

3993
05:01:46,378 --> 05:01:49,440
this case this artifact is another

3994
05:01:49,440 --> 05:01:51,360
artifact within an artifact with an

3995
05:01:51,360 --> 05:01:54,180
artifact so this one is a client event

3996
05:01:54,180 --> 05:01:56,760
artifact as I mentioned it's going to

3997
05:01:56,760 --> 05:01:58,440
check every 10 minutes in this case

3998
05:01:58,440 --> 05:02:00,298
against all of these systems that have

3999
05:02:00,298 --> 05:02:02,638
the label Recon 99 it's going to say is

4000
05:02:02,638 --> 05:02:05,580
this a Windows system yes okay kick off

4001
05:02:05,580 --> 05:02:07,798
this other artifact every 10 minutes and

4002
05:02:07,798 --> 05:02:09,420
so the artifacts that it's going to kick

4003
05:02:09,420 --> 05:02:11,820
off is this one right here which maybe

4004
05:02:11,820 --> 05:02:14,340
are a little harder to read but as I

4005
05:02:14,340 --> 05:02:15,180
said

4006
05:02:15,180 --> 05:02:18,298
um if we want to get this more on a box

4007
05:02:18,298 --> 05:02:20,280
you obviously don't want to keep

4008
05:02:20,280 --> 05:02:21,900
deploying it over and over again you

4009
05:02:21,900 --> 05:02:24,180
want to say hey is this here or not is

4010
05:02:24,180 --> 05:02:25,798
it running yes or no so what this

4011
05:02:25,798 --> 05:02:27,420
artifact is going to do it's going to do

4012
05:02:27,420 --> 05:02:28,980
a couple of things one it's going to see

4013
05:02:28,980 --> 05:02:31,860
is this is one service there if it's not

4014
05:02:31,860 --> 05:02:33,600
okay go deploy this artifact that

4015
05:02:33,600 --> 05:02:35,458
deploys this one it's going to pull down

4016
05:02:35,458 --> 05:02:37,440
this is internal system on artifact and

4017
05:02:37,440 --> 05:02:40,260
kick it off they're good to go

4018
05:02:40,260 --> 05:02:42,240
um if it's if the service is not there

4019
05:02:42,240 --> 05:02:44,040
it's going to say hey I assume this one

4020
05:02:44,040 --> 05:02:45,540
is not installed

4021
05:02:45,540 --> 05:02:47,760
um or if the service is there it's good

4022
05:02:47,760 --> 05:02:50,040
I'm so backwards

4023
05:02:50,040 --> 05:02:52,260
it's going to make sure that the process

4024
05:02:52,260 --> 05:02:54,240
is running if the process is not running

4025
05:02:54,240 --> 05:02:56,218
but the service is there it's going to

4026
05:02:56,218 --> 05:02:58,020
assume that it's available but something

4027
05:02:58,020 --> 05:03:00,000
stopped it so maybe an attacker maybe an

4028
05:03:00,000 --> 05:03:01,620
I.T person maybe somebody just doesn't

4029
05:03:01,620 --> 05:03:03,420
want this one on their box we've had

4030
05:03:03,420 --> 05:03:05,340
that happen plenty of times we're going

4031
05:03:05,340 --> 05:03:07,080
to say hey go turn it back on because we

4032
05:03:07,080 --> 05:03:08,940
want the Telemetry from your system

4033
05:03:08,940 --> 05:03:10,920
so it's going to kick that off and if

4034
05:03:10,920 --> 05:03:12,780
everything's hunky-dory you're going to

4035
05:03:12,780 --> 05:03:14,218
just get it okay and it's just going to

4036
05:03:14,218 --> 05:03:15,420
skip right over it and it's not going to

4037
05:03:15,420 --> 05:03:16,980
do anything on your endpoint unless

4038
05:03:16,980 --> 05:03:18,420
something goes wrong so that's what

4039
05:03:18,420 --> 05:03:20,458
you're going to see here is it's just

4040
05:03:20,458 --> 05:03:21,900
checking every 10 minutes and it says

4041
05:03:21,900 --> 05:03:26,480
okay we're good to go Watchdog yeah

4042
05:03:28,320 --> 05:03:30,780
um so we've gone over a client event

4043
05:03:30,780 --> 05:03:32,580
monitoring and so some of you have

4044
05:03:32,580 --> 05:03:34,980
probably used that before but now we're

4045
05:03:34,980 --> 05:03:37,860
going to dig into scheduled hunts and

4046
05:03:37,860 --> 05:03:39,660
server event monitoring

4047
05:03:39,660 --> 05:03:41,638
because this is where Velociraptor

4048
05:03:41,638 --> 05:03:43,560
really allows us to do some powerful

4049
05:03:43,560 --> 05:03:45,900
stuff as Eric mentioned and most of you

4050
05:03:45,900 --> 05:03:48,000
who have used Velociraptor may or may

4051
05:03:48,000 --> 05:03:49,138
not know that

4052
05:03:49,138 --> 05:03:50,520
um

4053
05:03:50,520 --> 05:03:52,680
the server events are where we can

4054
05:03:52,680 --> 05:03:55,020
actually do further manipulation with

4055
05:03:55,020 --> 05:03:56,280
any kind of data that we bring back

4056
05:03:56,280 --> 05:03:57,900
server-side versus having to push

4057
05:03:57,900 --> 05:04:01,400
anything else out to your endpoints

4058
05:04:02,100 --> 05:04:04,740
so um how many of you have used

4059
05:04:04,740 --> 05:04:07,138
Velociraptor during an IR or for triage

4060
05:04:07,138 --> 05:04:09,540
collections or anything like that

4061
05:04:09,540 --> 05:04:11,878
got a couple hands

4062
05:04:11,878 --> 05:04:14,280
um we use this a ton during our IRS

4063
05:04:14,280 --> 05:04:16,020
almost exclusively

4064
05:04:16,020 --> 05:04:16,680
um

4065
05:04:16,680 --> 05:04:18,900
and one of the artifacts that we rely on

4066
05:04:18,900 --> 05:04:21,060
heavily is an artifact called Cape files

4067
05:04:21,060 --> 05:04:22,920
and if you're not familiar with cape

4068
05:04:22,920 --> 05:04:25,138
it's a triage tool written by Eric

4069
05:04:25,138 --> 05:04:27,660
Zimmerman the tool itself is not open

4070
05:04:27,660 --> 05:04:30,900
source but the excuse me but the list of

4071
05:04:30,900 --> 05:04:32,760
files that at targets are open source

4072
05:04:32,760 --> 05:04:34,200
and they're on GitHub which is awesome

4073
05:04:34,200 --> 05:04:37,500
because this artifact can go pull down

4074
05:04:37,500 --> 05:04:39,420
that list of files and then we run it on

4075
05:04:39,420 --> 05:04:41,340
endpoint and it says hey go grab all

4076
05:04:41,340 --> 05:04:42,900
these important files all these event

4077
05:04:42,900 --> 05:04:45,660
logs uh the mft whatever we need to do

4078
05:04:45,660 --> 05:04:47,878
for an incident it can go grab it bundle

4079
05:04:47,878 --> 05:04:51,958
it up and um zip it up and then ship it

4080
05:04:51,958 --> 05:04:53,940
off to wherever we want it to ship

4081
05:04:53,940 --> 05:04:56,340
so our server event

4082
05:04:56,340 --> 05:04:57,180
um

4083
05:04:57,180 --> 05:04:59,160
if you see if you can see where it's

4084
05:04:59,160 --> 05:05:00,900
pointed the Green Arrow is pointing to

4085
05:05:00,900 --> 05:05:02,280
where the server monitoring gets

4086
05:05:02,280 --> 05:05:04,500
configured you can add a server event to

4087
05:05:04,500 --> 05:05:06,420
run consistently on the back end and

4088
05:05:06,420 --> 05:05:08,160
Velociraptor and it will sit there and

4089
05:05:08,160 --> 05:05:11,700
watch for an artifact to get kicked off

4090
05:05:11,700 --> 05:05:13,700
so in this example

4091
05:05:13,700 --> 05:05:17,218
you give it an artifact name regex and

4092
05:05:17,218 --> 05:05:18,718
it's going to look for whatever name you

4093
05:05:18,718 --> 05:05:20,160
give it so in our case it's going to be

4094
05:05:20,160 --> 05:05:21,500
looking for

4095
05:05:21,500 --> 05:05:25,260
the cake files artifact name and so

4096
05:05:25,260 --> 05:05:27,298
every time we collect the cape files on

4097
05:05:27,298 --> 05:05:29,280
an endpoint it says hey I know that I'm

4098
05:05:29,280 --> 05:05:30,600
supposed to go do something with this

4099
05:05:30,600 --> 05:05:33,480
bundle it up zip it and in our case this

4100
05:05:33,480 --> 05:05:35,040
particular artifact is going to upload

4101
05:05:35,040 --> 05:05:37,740
it to S3 for further processing

4102
05:05:37,740 --> 05:05:39,480
um Eric and I gave a talk a couple years

4103
05:05:39,480 --> 05:05:41,820
ago at one of the Sans deeper Summits

4104
05:05:41,820 --> 05:05:44,820
that goes over our whole IR process in a

4105
05:05:44,820 --> 05:05:47,760
lot more depth that we use to do exactly

4106
05:05:47,760 --> 05:05:50,040
this ship it off to S3 and then continue

4107
05:05:50,040 --> 05:05:51,420
to do

4108
05:05:51,420 --> 05:05:53,940
um around plazo log a timeline against

4109
05:05:53,940 --> 05:05:56,180
it and then kick it off to time sketch

4110
05:05:56,180 --> 05:06:00,740
and that's on our Recon GitHub

4111
05:06:01,680 --> 05:06:03,840
and this is where it gets really cool

4112
05:06:03,840 --> 05:06:05,878
because say you're monitoring a few

4113
05:06:05,878 --> 05:06:07,620
thousand endpoints or tens of thousands

4114
05:06:07,620 --> 05:06:09,480
of endpoints and you want to maintain

4115
05:06:09,480 --> 05:06:11,700
some kind of inventory or a cmdb against

4116
05:06:11,700 --> 05:06:12,958
everything that you're running or

4117
05:06:12,958 --> 05:06:15,180
looking at or keeping track of you can

4118
05:06:15,180 --> 05:06:17,700
do that at scale super easily with a

4119
05:06:17,700 --> 05:06:19,440
velociraptor

4120
05:06:19,440 --> 05:06:21,360
foreign

4121
05:06:21,360 --> 05:06:23,760
so you can take all of the data from all

4122
05:06:23,760 --> 05:06:25,920
of these endpoints have it get collected

4123
05:06:25,920 --> 05:06:27,298
continuously in the background by

4124
05:06:27,298 --> 05:06:29,160
Velociraptor on the server side you

4125
05:06:29,160 --> 05:06:30,718
don't have to touch a thing and it can

4126
05:06:30,718 --> 05:06:32,420
just get shipped up to a database

4127
05:06:32,420 --> 05:06:35,700
anywhere of your choosing

4128
05:06:35,700 --> 05:06:38,218
so this is an example of a server event

4129
05:06:38,218 --> 05:06:41,340
artifact so you can set a schedule or

4130
05:06:41,340 --> 05:06:43,440
you can set a different kind of trigger

4131
05:06:43,440 --> 05:06:45,540
this one in particular will get kicked

4132
05:06:45,540 --> 05:06:47,280
off at 3am and it's going to say hey I'm

4133
05:06:47,280 --> 05:06:49,200
going to run this artifact against all

4134
05:06:49,200 --> 05:06:52,080
these Windows systems and this schedule

4135
05:06:52,080 --> 05:06:52,860
um

4136
05:06:52,860 --> 05:06:54,780
I'm going to create a hunt that runs

4137
05:06:54,780 --> 05:06:57,540
this artifact and it will do that weekly

4138
05:06:57,540 --> 05:06:59,700
or bi-weekly or however often you want

4139
05:06:59,700 --> 05:07:02,280
to get kicked off

4140
05:07:02,280 --> 05:07:04,320
and then we've got another server

4141
05:07:04,320 --> 05:07:07,020
artifact that's going to be watching for

4142
05:07:07,020 --> 05:07:08,820
that hunt to get kicked off

4143
05:07:08,820 --> 05:07:10,560
and it's going to take the data from

4144
05:07:10,560 --> 05:07:11,878
that hunt and it's going to ship it

4145
05:07:11,878 --> 05:07:14,040
straight into a mySQL database or your

4146
05:07:14,040 --> 05:07:16,980
cmdb for example so you can collect the

4147
05:07:16,980 --> 05:07:18,360
services that there's already all these

4148
05:07:18,360 --> 05:07:20,160
artifacts that Velociraptor has bundled

4149
05:07:20,160 --> 05:07:23,458
up with it like services and users and

4150
05:07:23,458 --> 05:07:25,860
um installed applications or network

4151
05:07:25,860 --> 05:07:27,718
information all of these things that are

4152
05:07:27,718 --> 05:07:30,000
being gathered about your inventory can

4153
05:07:30,000 --> 05:07:32,580
now immediately populate a mySQL

4154
05:07:32,580 --> 05:07:34,680
database or in this case they can go to

4155
05:07:34,680 --> 05:07:36,298
elastic they can go to splog they can go

4156
05:07:36,298 --> 05:07:38,638
to postgres sqlite S3 wherever you want

4157
05:07:38,638 --> 05:07:41,458
to ship them to do further analysis or

4158
05:07:41,458 --> 05:07:44,580
have an up-to-date by the hour by the

4159
05:07:44,580 --> 05:07:46,260
minute inventory of everything going on

4160
05:07:46,260 --> 05:07:50,000
in all these systems at any given time

4161
05:07:50,610 --> 05:07:53,638
[Music]

4162
05:07:53,638 --> 05:07:55,260
um and then the other thing I wanted to

4163
05:07:55,260 --> 05:07:57,420
touch on uh this is

4164
05:07:57,420 --> 05:07:59,638
less security related but it is

4165
05:07:59,638 --> 05:08:01,080
something to be mindful of when you're

4166
05:08:01,080 --> 05:08:02,638
running velociraptor in an environment

4167
05:08:02,638 --> 05:08:04,138
that needs to be up and available and

4168
05:08:04,138 --> 05:08:06,240
quick and snappy at all times if you're

4169
05:08:06,240 --> 05:08:07,920
running this with tens and thousands of

4170
05:08:07,920 --> 05:08:08,878
clients

4171
05:08:08,878 --> 05:08:11,340
um you will start to if anybody knows

4172
05:08:11,340 --> 05:08:13,560
what's behind Velociraptor it's flat

4173
05:08:13,560 --> 05:08:15,540
files which is awesome because one you

4174
05:08:15,540 --> 05:08:17,520
don't have to maintain another elastic

4175
05:08:17,520 --> 05:08:18,958
instance you don't have to maintain

4176
05:08:18,958 --> 05:08:20,520
another database anywhere it's a lot

4177
05:08:20,520 --> 05:08:22,320
smaller footprint but you will

4178
05:08:22,320 --> 05:08:24,798
accumulate a lot of clients over time

4179
05:08:24,798 --> 05:08:27,180
especially if you're doing IRS a lot of

4180
05:08:27,180 --> 05:08:28,500
those are going to fall off over time

4181
05:08:28,500 --> 05:08:29,340
and they're not even going to be

4182
05:08:29,340 --> 05:08:31,340
checking in anymore so a good way to

4183
05:08:31,340 --> 05:08:34,860
kind of keep it small or smaller anyway

4184
05:08:34,860 --> 05:08:39,180
is to kind of do a cleanup periodically

4185
05:08:39,180 --> 05:08:41,520
because otherwise it's got a lot more

4186
05:08:41,520 --> 05:08:45,000
data to turn through so you can schedule

4187
05:08:45,000 --> 05:08:47,580
hey I want to delete all clients that

4188
05:08:47,580 --> 05:08:49,320
haven't checked in the last 90 or 60

4189
05:08:49,320 --> 05:08:51,540
days or whatever whatever it is you want

4190
05:08:51,540 --> 05:08:53,218
and any of the artifacts that were

4191
05:08:53,218 --> 05:08:54,900
associated with those if you wish to not

4192
05:08:54,900 --> 05:08:56,218
keep them because all it's doing is

4193
05:08:56,218 --> 05:08:58,378
accumulating space

4194
05:08:58,378 --> 05:09:00,660
and so you will see those server events

4195
05:09:00,660 --> 05:09:02,458
happening it keeps a real-time log of

4196
05:09:02,458 --> 05:09:04,320
all that so you can it's still auditable

4197
05:09:04,320 --> 05:09:06,180
and all that so you know what's happened

4198
05:09:06,180 --> 05:09:08,940
when and you can see all that in the

4199
05:09:08,940 --> 05:09:11,420
same pane

4200
05:09:14,180 --> 05:09:18,120
all right so uh so let's uh let's let's

4201
05:09:18,120 --> 05:09:20,580
get into more of the security-minded uh

4202
05:09:20,580 --> 05:09:22,260
capabilities

4203
05:09:22,260 --> 05:09:23,638
um and and we are still keeping this

4204
05:09:23,638 --> 05:09:24,780
kind of high level right because we've

4205
05:09:24,780 --> 05:09:26,400
given some pretty deep talks on

4206
05:09:26,400 --> 05:09:28,798
forensics incident response and we'll

4207
05:09:28,798 --> 05:09:30,480
we'll plug those at the end here but

4208
05:09:30,480 --> 05:09:31,980
let's keep it kind of high level some of

4209
05:09:31,980 --> 05:09:34,260
the things that everybody needs right

4210
05:09:34,260 --> 05:09:36,180
um so everybody needs visibility into

4211
05:09:36,180 --> 05:09:37,920
what's going on in endpoints right it

4212
05:09:37,920 --> 05:09:39,180
doesn't matter who you are how big or

4213
05:09:39,180 --> 05:09:40,920
small your network is this is a this is

4214
05:09:40,920 --> 05:09:43,260
a key thing capability to have and so

4215
05:09:43,260 --> 05:09:44,820
let me talk about some ways that you can

4216
05:09:44,820 --> 05:09:46,860
use Velociraptor to not only have

4217
05:09:46,860 --> 05:09:49,260
real-time streaming visibility but also

4218
05:09:49,260 --> 05:09:50,700
the ability to do point in time

4219
05:09:50,700 --> 05:09:53,100
interrogation of each and all of your

4220
05:09:53,100 --> 05:09:55,440
endpoints so you've seen this screen

4221
05:09:55,440 --> 05:09:57,060
here before this is just that simple

4222
05:09:57,060 --> 05:09:59,700
screen that said I I drilled in on one

4223
05:09:59,700 --> 05:10:01,440
of my systems one of my endpoints that's

4224
05:10:01,440 --> 05:10:03,540
checking in the Velociraptor and you can

4225
05:10:03,540 --> 05:10:05,040
see at the top of the screen here which

4226
05:10:05,040 --> 05:10:07,080
endpoint that is it's just this desktop

4227
05:10:07,080 --> 05:10:09,000
here okay cool but let's say you know

4228
05:10:09,000 --> 05:10:10,860
what I got a quick Powershell command I

4229
05:10:10,860 --> 05:10:12,120
just want to run against that endpoint

4230
05:10:12,120 --> 05:10:14,280
maybe to you know figure out who last

4231
05:10:14,280 --> 05:10:16,320
logged on or whatever okay I can click

4232
05:10:16,320 --> 05:10:18,420
right here click shell and that's going

4233
05:10:18,420 --> 05:10:21,000
to offer to me a number of different uh

4234
05:10:21,000 --> 05:10:22,740
command shells or command interpreters

4235
05:10:22,740 --> 05:10:24,480
here uh Powershell is a good one for

4236
05:10:24,480 --> 05:10:26,160
those of you that are Savvy with uh the

4237
05:10:26,160 --> 05:10:28,020
power and flexibility of Powershell and

4238
05:10:28,020 --> 05:10:29,820
this is just a basic example of hey git

4239
05:10:29,820 --> 05:10:31,440
process right so show me all the running

4240
05:10:31,440 --> 05:10:33,360
processes on this box and there you have

4241
05:10:33,360 --> 05:10:34,500
it there's your response your your

4242
05:10:34,500 --> 05:10:36,180
response all right now you're probably

4243
05:10:36,180 --> 05:10:37,798
sitting here thinking okay I can do this

4244
05:10:37,798 --> 05:10:40,740
with my EDR I can do this with okay got

4245
05:10:40,740 --> 05:10:44,400
it yes this tool is free right and it's

4246
05:10:44,400 --> 05:10:46,200
also very very secure because it's

4247
05:10:46,200 --> 05:10:48,480
running locally on that box so it's not

4248
05:10:48,480 --> 05:10:50,520
like I'm running a remote tool or

4249
05:10:50,520 --> 05:10:52,200
anything like that it's sending it down

4250
05:10:52,200 --> 05:10:53,638
to that endpoint it's running with

4251
05:10:53,638 --> 05:10:55,080
system privileges so there's nothing I

4252
05:10:55,080 --> 05:10:57,600
can't do right and so uh a pretty

4253
05:10:57,600 --> 05:10:59,100
awesome way to kind of get down there

4254
05:10:59,100 --> 05:11:00,840
and say hey if there's an adversary on

4255
05:11:00,840 --> 05:11:02,160
this box I just want to ask some quick

4256
05:11:02,160 --> 05:11:03,780
questions to see what's going on I can

4257
05:11:03,780 --> 05:11:05,520
do that but okay that's pretty basic

4258
05:11:05,520 --> 05:11:07,200
let's keep going show me show me some

4259
05:11:07,200 --> 05:11:09,000
real impressive stuff here all right how

4260
05:11:09,000 --> 05:11:11,638
about this how often have you uh I just

4261
05:11:11,638 --> 05:11:12,780
noticed my error rows are a little

4262
05:11:12,780 --> 05:11:14,520
misaligned here but how often had you

4263
05:11:14,520 --> 05:11:15,900
have you maybe been working a little

4264
05:11:15,900 --> 05:11:17,400
fishing case or something you're like

4265
05:11:17,400 --> 05:11:18,958
gosh if I could just reach down into

4266
05:11:18,958 --> 05:11:22,440
that endpoint and grab that Excel file I

4267
05:11:22,440 --> 05:11:24,298
could know right away was this like a

4268
05:11:24,298 --> 05:11:26,700
bad thing or was this a not so bad thing

4269
05:11:26,700 --> 05:11:28,680
right and that's a non-trivial operation

4270
05:11:28,680 --> 05:11:30,540
right like you have the ability to reach

4271
05:11:30,540 --> 05:11:31,920
into any endpoint in your network and

4272
05:11:31,920 --> 05:11:33,958
just grab a file maybe you do with an

4273
05:11:33,958 --> 05:11:36,000
expensive tool but this free one does it

4274
05:11:36,000 --> 05:11:38,040
too so this option this uh thing I'm

4275
05:11:38,040 --> 05:11:39,840
pointing at up here the VFS is the

4276
05:11:39,840 --> 05:11:41,700
virtual file system Explorer what I can

4277
05:11:41,700 --> 05:11:43,500
do is I can drill down into the file

4278
05:11:43,500 --> 05:11:45,540
system of any system in my network and

4279
05:11:45,540 --> 05:11:46,860
you can see here on the left hand side

4280
05:11:46,860 --> 05:11:48,900
kind of the the drill down so I've gone

4281
05:11:48,900 --> 05:11:51,298
into the C drive down into the user's

4282
05:11:51,298 --> 05:11:53,280
location and maybe we got this user here

4283
05:11:53,280 --> 05:11:55,500
is that Peter Gibbons and and you know

4284
05:11:55,500 --> 05:11:57,360
maybe Peter opened up a suspicious file

4285
05:11:57,360 --> 05:11:59,940
today that came to him via email and we

4286
05:11:59,940 --> 05:12:01,138
saw that it was dropped into his

4287
05:12:01,138 --> 05:12:02,638
downloads or whatever and I just want to

4288
05:12:02,638 --> 05:12:03,840
keep my hands on it right so I can do

4289
05:12:03,840 --> 05:12:05,520
some analysis well there it is I'm

4290
05:12:05,520 --> 05:12:06,840
looking at the contents of this file

4291
05:12:06,840 --> 05:12:09,298
system and uh and if I there's a file of

4292
05:12:09,298 --> 05:12:10,700
Interest like maybe this

4293
05:12:10,700 --> 05:12:12,718
webshellmaster.zip or whatever you like

4294
05:12:12,718 --> 05:12:14,700
okay let's grab it there it is I just

4295
05:12:14,700 --> 05:12:16,138
click download from the client it's

4296
05:12:16,138 --> 05:12:18,000
going to fetch it off that endpoint ship

4297
05:12:18,000 --> 05:12:19,980
it up to Velociraptor and then hold it

4298
05:12:19,980 --> 05:12:21,958
there for me it's going to generate some

4299
05:12:21,958 --> 05:12:24,420
hashes so maybe that's all I needed I

4300
05:12:24,420 --> 05:12:25,680
just needed those hashes because I'll

4301
05:12:25,680 --> 05:12:27,240
just go ask buyers total what this is

4302
05:12:27,240 --> 05:12:29,458
right but no I want the file itself well

4303
05:12:29,458 --> 05:12:30,840
no problem I'll just click this little

4304
05:12:30,840 --> 05:12:32,580
download icon it's going to download it

4305
05:12:32,580 --> 05:12:35,040
to my analysis workstation from the

4306
05:12:35,040 --> 05:12:36,540
Velociraptor server so I can get

4307
05:12:36,540 --> 05:12:38,820
anything off this box one Z two Z's one

4308
05:12:38,820 --> 05:12:40,740
file here or what have you and uh and

4309
05:12:40,740 --> 05:12:42,000
that's cool right that's that's that's

4310
05:12:42,000 --> 05:12:43,680
not terrible

4311
05:12:43,680 --> 05:12:45,420
um where else that gets to be pretty uh

4312
05:12:45,420 --> 05:12:47,340
pretty interesting is for those of you

4313
05:12:47,340 --> 05:12:48,660
that have some digital forensics

4314
05:12:48,660 --> 05:12:50,520
background you know there's a lot of

4315
05:12:50,520 --> 05:12:52,440
very juicy artifacts on the file system

4316
05:12:52,440 --> 05:12:54,120
they can answer some really important

4317
05:12:54,120 --> 05:12:56,638
questions like what did this user do in

4318
05:12:56,638 --> 05:12:59,040
a Powershell session yesterday right so

4319
05:12:59,040 --> 05:13:00,780
for instance and sorry for the

4320
05:13:00,780 --> 05:13:02,520
transition here from the light mode to

4321
05:13:02,520 --> 05:13:04,798
the dark mode screenshots I was building

4322
05:13:04,798 --> 05:13:06,240
this deck at two different points in

4323
05:13:06,240 --> 05:13:08,160
time but uh and hopefully that's not

4324
05:13:08,160 --> 05:13:09,958
impossible to see here but for instance

4325
05:13:09,958 --> 05:13:11,580
in this example what I've done is I've

4326
05:13:11,580 --> 05:13:14,100
drilled in on like uh our really really

4327
05:13:14,100 --> 05:13:15,600
favorite uh one of our favorite

4328
05:13:15,600 --> 05:13:17,280
Powershell artifacts the Powershell

4329
05:13:17,280 --> 05:13:19,200
transcript logs so I've drilled into

4330
05:13:19,200 --> 05:13:21,540
this Powershell transcript here uh for

4331
05:13:21,540 --> 05:13:23,340
this particular user and what it's well

4332
05:13:23,340 --> 05:13:25,560
what it's essentially telling me is line

4333
05:13:25,560 --> 05:13:27,360
by line every you know last Powershell

4334
05:13:27,360 --> 05:13:29,040
command that was run the results of

4335
05:13:29,040 --> 05:13:30,660
those Powershell activities but again

4336
05:13:30,660 --> 05:13:32,520
just the the power and flexibility of

4337
05:13:32,520 --> 05:13:33,718
being able to reach into the file system

4338
05:13:33,718 --> 05:13:36,000
and look at files and because this is a

4339
05:13:36,000 --> 05:13:37,560
clear text file I didn't need to

4340
05:13:37,560 --> 05:13:39,000
download it to look into it uh

4341
05:13:39,000 --> 05:13:40,740
Velociraptor rendered the clear text

4342
05:13:40,740 --> 05:13:42,420
right there for me I could also have

4343
05:13:42,420 --> 05:13:44,940
chosen to you look at it in a hex editor

4344
05:13:44,940 --> 05:13:46,980
built right into the web UI of

4345
05:13:46,980 --> 05:13:49,320
velociraptor so so many cool things that

4346
05:13:49,320 --> 05:13:50,820
we could do there hey but it's not

4347
05:13:50,820 --> 05:13:53,100
limited to the file system it treats the

4348
05:13:53,100 --> 05:13:55,200
registry the exact same way so I can

4349
05:13:55,200 --> 05:13:56,760
browse that system's registry hives

4350
05:13:56,760 --> 05:13:58,860
right here just drill down to the

4351
05:13:58,860 --> 05:14:00,660
particular key of interest in this case

4352
05:14:00,660 --> 05:14:01,920
I'm just showing you one of the

4353
05:14:01,920 --> 05:14:04,680
well-known kind of iocs if you're ever

4354
05:14:04,680 --> 05:14:06,600
if you've ever chased down uh CIS and

4355
05:14:06,600 --> 05:14:08,040
turtles Tools in your environment like

4356
05:14:08,040 --> 05:14:10,680
PS exec you know there's a registry key

4357
05:14:10,680 --> 05:14:12,540
that you can use to go hunt for it that

4358
05:14:12,540 --> 05:14:14,700
Eula accepted key now this isn't as

4359
05:14:14,700 --> 05:14:16,378
exciting this is the EULA accepted for

4360
05:14:16,378 --> 05:14:18,600
sysmon but again I can browse down to

4361
05:14:18,600 --> 05:14:20,878
that registry location with ease okay

4362
05:14:20,878 --> 05:14:22,260
cool but that's a bit manual that's

4363
05:14:22,260 --> 05:14:23,580
generally not the way we're doing things

4364
05:14:23,580 --> 05:14:26,160
but I can if I need to now let's say I

4365
05:14:26,160 --> 05:14:27,600
wanted to run some of those fancy

4366
05:14:27,600 --> 05:14:30,060
artifact hunts against that individual

4367
05:14:30,060 --> 05:14:32,040
system all I'd have to do here in the

4368
05:14:32,040 --> 05:14:34,080
context of that machine click on

4369
05:14:34,080 --> 05:14:36,240
collected and from that screen I can

4370
05:14:36,240 --> 05:14:38,700
kick off a hunt against this one system

4371
05:14:38,700 --> 05:14:40,620
and this is generally the way you're

4372
05:14:40,620 --> 05:14:42,000
going to operate with Velociraptor

4373
05:14:42,000 --> 05:14:43,920
because I'm going to tell you yes I

4374
05:14:43,920 --> 05:14:45,540
could run a Powershell command to list

4375
05:14:45,540 --> 05:14:48,120
processes that's not very exciting and

4376
05:14:48,120 --> 05:14:49,980
it's also a little noisy because I just

4377
05:14:49,980 --> 05:14:51,240
created noise on that endpoint

4378
05:14:51,240 --> 05:14:52,980
Powershell logs and all kinds of stuff

4379
05:14:52,980 --> 05:14:55,280
so let's do this a little bit more

4380
05:14:55,280 --> 05:14:57,298
clever let's take a more clever approach

4381
05:14:57,298 --> 05:14:58,980
here so here what I'm going to do is I'm

4382
05:14:58,980 --> 05:15:00,240
going to run a hunt on this machine let

4383
05:15:00,240 --> 05:15:01,560
me see my zoom's going to work the way I

4384
05:15:01,560 --> 05:15:02,878
expect no it's not

4385
05:15:02,878 --> 05:15:04,320
um if I'm going to run a hunt here to

4386
05:15:04,320 --> 05:15:06,120
get all the running processes on this

4387
05:15:06,120 --> 05:15:08,160
system there's a built-in artifact

4388
05:15:08,160 --> 05:15:09,600
that's going to do a much better job

4389
05:15:09,600 --> 05:15:11,760
than a Powershell command that artifact

4390
05:15:11,760 --> 05:15:14,400
is called Windows system PS list and

4391
05:15:14,400 --> 05:15:16,320
what I want to kind of highlight here is

4392
05:15:16,320 --> 05:15:18,360
let me switch on my my magnifier I want

4393
05:15:18,360 --> 05:15:20,280
to highlight kind of the the little

4394
05:15:20,280 --> 05:15:23,638
preview you get here of the uh artifact

4395
05:15:23,638 --> 05:15:27,120
itself if I can figure out my uh

4396
05:15:27,120 --> 05:15:30,298
PowerPoint is hard but um

4397
05:15:30,298 --> 05:15:33,420
uh this guy right here is he gonna do it

4398
05:15:33,420 --> 05:15:36,480
there we go okay so this is just a

4399
05:15:36,480 --> 05:15:38,218
simple breakdown of kind of the vql for

4400
05:15:38,218 --> 05:15:40,378
this basic PS list so let me tell you

4401
05:15:40,378 --> 05:15:41,820
why this is a better idea than just

4402
05:15:41,820 --> 05:15:43,560
running git process because not only is

4403
05:15:43,560 --> 05:15:44,520
he going to get a list of all the

4404
05:15:44,520 --> 05:15:46,920
running processes but it's also going to

4405
05:15:46,920 --> 05:15:49,138
enrich that information by hey go ahead

4406
05:15:49,138 --> 05:15:50,700
and hash the executable as well while

4407
05:15:50,700 --> 05:15:52,500
you're at it and hey while we're here

4408
05:15:52,500 --> 05:15:54,120
let's run authentic code against those

4409
05:15:54,120 --> 05:15:55,320
exes and let's make sure they're

4410
05:15:55,320 --> 05:15:57,240
digitally signed by trusted Publishers

4411
05:15:57,240 --> 05:15:58,920
Etc et cetera et cetera that's a lot

4412
05:15:58,920 --> 05:16:00,240
more valuable to me as a threat Hunter

4413
05:16:00,240 --> 05:16:02,400
than just say show me running processes

4414
05:16:02,400 --> 05:16:04,320
no show me the running processes get

4415
05:16:04,320 --> 05:16:05,520
their hashes and check their code

4416
05:16:05,520 --> 05:16:07,560
signing status because when I run that

4417
05:16:07,560 --> 05:16:09,958
across a hundred machines or a thousand

4418
05:16:09,958 --> 05:16:12,120
machines that's giving me the context I

4419
05:16:12,120 --> 05:16:13,620
need to very quickly filter for the

4420
05:16:13,620 --> 05:16:16,080
stuff I'm probably looking for unsigned

4421
05:16:16,080 --> 05:16:18,540
strange locations you know Etc et cetera

4422
05:16:18,540 --> 05:16:19,620
et cetera so

4423
05:16:19,620 --> 05:16:22,200
um so yeah PS list a much cleaner

4424
05:16:22,200 --> 05:16:24,060
smoother and more powerful approach to

4425
05:16:24,060 --> 05:16:27,240
basic questions like running processes

4426
05:16:27,240 --> 05:16:28,740
um so this is just showing you kind of

4427
05:16:28,740 --> 05:16:30,298
the output of running that hunt against

4428
05:16:30,298 --> 05:16:32,520
a single system down here in the bottom

4429
05:16:32,520 --> 05:16:34,440
we have kind of in a notebook view

4430
05:16:34,440 --> 05:16:36,240
there's your answer by the way there's

4431
05:16:36,240 --> 05:16:38,340
all the running processes on the system

4432
05:16:38,340 --> 05:16:40,560
you've got the name of the process

4433
05:16:40,560 --> 05:16:42,480
you've got the uh full path to the

4434
05:16:42,480 --> 05:16:44,700
executable hey there's that md5 hash

4435
05:16:44,700 --> 05:16:46,920
right tell say no more let's just copy

4436
05:16:46,920 --> 05:16:48,240
paste that into virus total see what

4437
05:16:48,240 --> 05:16:49,920
we're looking at here authenticode

4438
05:16:49,920 --> 05:16:52,320
status trusted untrusted I could have

4439
05:16:52,320 --> 05:16:53,580
probably just filtered by that because

4440
05:16:53,580 --> 05:16:55,100
let's be honest folks

4441
05:16:55,100 --> 05:16:58,560
99.7 or more percent of uh malware it's

4442
05:16:58,560 --> 05:16:59,940
not going to be carrying a valid digital

4443
05:16:59,940 --> 05:17:01,860
code signing certificate so hey I could

4444
05:17:01,860 --> 05:17:04,260
edit this notebook uh filter out to show

4445
05:17:04,260 --> 05:17:06,000
me all the untrusted processes that's

4446
05:17:06,000 --> 05:17:07,138
going to reduce the noise here

4447
05:17:07,138 --> 05:17:09,240
significantly I'm going to find evil

4448
05:17:09,240 --> 05:17:11,878
much faster and by the way there is uh

4449
05:17:11,878 --> 05:17:13,440
evil stuff happening in this screenshot

4450
05:17:13,440 --> 05:17:14,820
and you don't have to be a rocket

4451
05:17:14,820 --> 05:17:16,200
scientist to find it with what I just

4452
05:17:16,200 --> 05:17:18,360
told you right these two untrusted

4453
05:17:18,360 --> 05:17:20,100
entries right here if you look at those

4454
05:17:20,100 --> 05:17:23,280
uh paths hey that looks Shady right I

4455
05:17:23,280 --> 05:17:24,420
don't know if you can see it as clearly

4456
05:17:24,420 --> 05:17:26,160
but you've got an executable running out

4457
05:17:26,160 --> 05:17:28,138
of the users update a local temp and

4458
05:17:28,138 --> 05:17:31,320
you've also got this dot DAT file being

4459
05:17:31,320 --> 05:17:32,940
executed which is also kind of strange

4460
05:17:32,940 --> 05:17:35,280
but anyway just uh showcasing the the

4461
05:17:35,280 --> 05:17:36,840
value of the notebooks and what we can

4462
05:17:36,840 --> 05:17:39,480
do here but uh but let's keep going so

4463
05:17:39,480 --> 05:17:41,280
um another basic artifact that I could I

4464
05:17:41,280 --> 05:17:42,840
could fire off against this one system

4465
05:17:42,840 --> 05:17:45,120
or a thousand systems is show me all the

4466
05:17:45,120 --> 05:17:46,378
programs that have been installed on

4467
05:17:46,378 --> 05:17:48,660
this all right that sounds a bit trivial

4468
05:17:48,660 --> 05:17:51,000
who cares right uh you care whenever a

4469
05:17:51,000 --> 05:17:53,160
manage engine exploit drops right you

4470
05:17:53,160 --> 05:17:54,660
care whenever there's a new critical

4471
05:17:54,660 --> 05:17:56,760
zero day in Adobe Reader it's a pretty

4472
05:17:56,760 --> 05:17:58,440
cool tool to be able to execute across

4473
05:17:58,440 --> 05:18:00,660
your environment give me all programs

4474
05:18:00,660 --> 05:18:02,458
installed on all systems and then I'm

4475
05:18:02,458 --> 05:18:03,900
going to bring back that notebook here

4476
05:18:03,900 --> 05:18:06,480
and I'm going to filter for Adobe Reader

4477
05:18:06,480 --> 05:18:08,340
version blah blah blah right or manage

4478
05:18:08,340 --> 05:18:09,240
engine

4479
05:18:09,240 --> 05:18:10,680
et cetera et cetera et cetera right and

4480
05:18:10,680 --> 05:18:12,420
now this is kind of neat to do against

4481
05:18:12,420 --> 05:18:14,160
one system generally this is something

4482
05:18:14,160 --> 05:18:16,740
I'd like to do against all systems and

4483
05:18:16,740 --> 05:18:18,660
then to Whitney's magic is bring all

4484
05:18:18,660 --> 05:18:20,580
that data back and just feed it into a

4485
05:18:20,580 --> 05:18:23,340
database right and have a constant you

4486
05:18:23,340 --> 05:18:25,260
know snapshot point in time of all

4487
05:18:25,260 --> 05:18:27,120
software across all systems in your

4488
05:18:27,120 --> 05:18:28,980
environment so that when the zero day

4489
05:18:28,980 --> 05:18:32,040
drops you're not manually now Scavenging

4490
05:18:32,040 --> 05:18:33,718
to figure out where that software may be

4491
05:18:33,718 --> 05:18:35,520
in your network you know I could just go

4492
05:18:35,520 --> 05:18:37,138
query right here and I'm going to know

4493
05:18:37,138 --> 05:18:39,000
exactly which systems have that software

4494
05:18:39,000 --> 05:18:41,100
in my environment so pretty cool but

4495
05:18:41,100 --> 05:18:42,360
this is just showing you manually what

4496
05:18:42,360 --> 05:18:43,920
that would what those results here look

4497
05:18:43,920 --> 05:18:45,780
like in the names of software the

4498
05:18:45,780 --> 05:18:47,820
versions when it was installed all that

4499
05:18:47,820 --> 05:18:49,620
kind of good stuff all right cool but

4500
05:18:49,620 --> 05:18:50,940
this is the approach we're going to take

4501
05:18:50,940 --> 05:18:52,560
right so I'm going to run a hunt here

4502
05:18:52,560 --> 05:18:54,958
across all my systems in my environment

4503
05:18:54,958 --> 05:18:57,298
to get all the software bring that back

4504
05:18:57,298 --> 05:18:59,160
this is just showing you kind of how

4505
05:18:59,160 --> 05:19:00,958
that artifact is structured it's reading

4506
05:19:00,958 --> 05:19:02,520
from the registry where the installed

4507
05:19:02,520 --> 05:19:04,500
programs live and it's going to bring

4508
05:19:04,500 --> 05:19:07,260
that stuff back and uh and this is going

4509
05:19:07,260 --> 05:19:09,718
to Showcase here kind of the power of

4510
05:19:09,718 --> 05:19:12,480
the hunt manager so up till this point

4511
05:19:12,480 --> 05:19:13,920
I've been talking to you if I was going

4512
05:19:13,920 --> 05:19:16,020
to drill down into a single system okay

4513
05:19:16,020 --> 05:19:18,000
sometimes that's what you're doing most

4514
05:19:18,000 --> 05:19:19,620
of the time from a threat hunt or

4515
05:19:19,620 --> 05:19:22,138
perspective I'm I'm constantly looking

4516
05:19:22,138 --> 05:19:24,840
out across all the systems so this

4517
05:19:24,840 --> 05:19:27,180
screen here you can kinda to make out

4518
05:19:27,180 --> 05:19:29,700
here what what menu item I'm drilled in

4519
05:19:29,700 --> 05:19:31,320
on this little Crosshair that's the hunt

4520
05:19:31,320 --> 05:19:33,000
manager this is where I'm going to go in

4521
05:19:33,000 --> 05:19:35,040
to build a hunt that I'm going to run

4522
05:19:35,040 --> 05:19:37,798
across a whole a whole set of systems it

4523
05:19:37,798 --> 05:19:39,718
could be a subset it could be all of

4524
05:19:39,718 --> 05:19:42,000
them and I'm going to say hey go get all

4525
05:19:42,000 --> 05:19:43,798
the software installed across all the

4526
05:19:43,798 --> 05:19:46,080
systems now as you can imagine I'm about

4527
05:19:46,080 --> 05:19:48,660
to receive probably tens if not hundreds

4528
05:19:48,660 --> 05:19:50,280
of thousands of rows of data back right

4529
05:19:50,280 --> 05:19:51,718
nothing you're going to be sifting

4530
05:19:51,718 --> 05:19:54,480
through using Excel or something so to

4531
05:19:54,480 --> 05:19:56,100
kind of showcase what we would do with

4532
05:19:56,100 --> 05:19:58,560
all that data when it comes back I

4533
05:19:58,560 --> 05:20:00,420
expand on this in another talk I'll drop

4534
05:20:00,420 --> 05:20:02,040
a link at the end but basically this is

4535
05:20:02,040 --> 05:20:03,480
where the power of the notebook comes

4536
05:20:03,480 --> 05:20:05,340
into play so what you're able to see up

4537
05:20:05,340 --> 05:20:08,580
here or hopefully see is um yeah you

4538
05:20:08,580 --> 05:20:10,080
can't see that at all probably at least

4539
05:20:10,080 --> 05:20:11,878
not in the back but what you've got here

4540
05:20:11,878 --> 05:20:13,920
is a little notebook if you've ever

4541
05:20:13,920 --> 05:20:15,718
worked with like a python notebooks it's

4542
05:20:15,718 --> 05:20:17,638
very familiar but uh what I'm basically

4543
05:20:17,638 --> 05:20:19,080
doing is I'm saying hey look take all

4544
05:20:19,080 --> 05:20:20,878
those hundreds of thousands of rows and

4545
05:20:20,878 --> 05:20:23,218
I want to group and stack okay so if

4546
05:20:23,218 --> 05:20:25,798
it's Adobe Reader version 4.0 I don't

4547
05:20:25,798 --> 05:20:28,020
care if that's on you know 400 systems

4548
05:20:28,020 --> 05:20:29,878
just tell me it's on 400 systems right

4549
05:20:29,878 --> 05:20:32,280
so now what I can do is I can group and

4550
05:20:32,280 --> 05:20:34,378
stack all that software and then sort by

4551
05:20:34,378 --> 05:20:36,540
least prevalent show me the most rare

4552
05:20:36,540 --> 05:20:38,700
occurrence of a particular software in

4553
05:20:38,700 --> 05:20:40,260
my environment that's where you find

4554
05:20:40,260 --> 05:20:42,718
things like uh TeamViewer that your it

4555
05:20:42,718 --> 05:20:44,520
folks are using that they shouldn't be

4556
05:20:44,520 --> 05:20:46,378
or that's where you find you know the

4557
05:20:46,378 --> 05:20:49,560
the copy of uh of uh in map or whatever

4558
05:20:49,560 --> 05:20:51,900
because it's not on 500 systems it's on

4559
05:20:51,900 --> 05:20:54,120
Two And so that lease prevalence kind of

4560
05:20:54,120 --> 05:20:55,680
plays an interesting uh role there in

4561
05:20:55,680 --> 05:20:56,878
looking for things you probably don't

4562
05:20:56,878 --> 05:20:58,260
want happening

4563
05:20:58,260 --> 05:21:00,540
but okay cool that's all that's all uh

4564
05:21:00,540 --> 05:21:02,700
still pretty uh pretty pretty basic

4565
05:21:02,700 --> 05:21:04,440
stuff so let's get into

4566
05:21:04,440 --> 05:21:06,240
um real time real-time Eventing

4567
05:21:06,240 --> 05:21:08,580
real-time uh detection capabilities and

4568
05:21:08,580 --> 05:21:10,020
the ability to kind of forward logs

4569
05:21:10,020 --> 05:21:11,638
right because we all know we can do this

4570
05:21:11,638 --> 05:21:13,200
with a whole variety of different tools

4571
05:21:13,200 --> 05:21:15,360
but as I mentioned Velociraptor is a

4572
05:21:15,360 --> 05:21:16,920
Swiss army knife they could do a lot of

4573
05:21:16,920 --> 05:21:18,240
things that a lot of folks don't realize

4574
05:21:18,240 --> 05:21:19,980
so let me Let Me Shine some light on

4575
05:21:19,980 --> 05:21:21,060
that as well

4576
05:21:21,060 --> 05:21:24,718
so there are a lot of what we call kind

4577
05:21:24,718 --> 05:21:27,480
of uh Eventing style artifacts meaning

4578
05:21:27,480 --> 05:21:30,060
it's not a one-time fired off and then

4579
05:21:30,060 --> 05:21:32,280
just get some results back no it's an

4580
05:21:32,280 --> 05:21:34,560
ongoing never-ending I want you to

4581
05:21:34,560 --> 05:21:36,900
constantly generate events for a

4582
05:21:36,900 --> 05:21:38,760
particular thing like when processes

4583
05:21:38,760 --> 05:21:41,160
launch on this box or when DNS queries

4584
05:21:41,160 --> 05:21:42,840
are made and it's a never-ending thing

4585
05:21:42,840 --> 05:21:44,760
it runs always and it's constantly

4586
05:21:44,760 --> 05:21:48,240
feeding data back to Velociraptor which

4587
05:21:48,240 --> 05:21:50,400
is not something you want to do for all

4588
05:21:50,400 --> 05:21:52,680
things all the time but in an IR you

4589
05:21:52,680 --> 05:21:54,360
certainly probably want that data right

4590
05:21:54,360 --> 05:21:56,218
so for instance if I walk into an

4591
05:21:56,218 --> 05:21:58,080
environment there's no seam there's no

4592
05:21:58,080 --> 05:22:01,260
EDR there's no sysmon all right well I'm

4593
05:22:01,260 --> 05:22:02,700
at least going to get Velociraptor on

4594
05:22:02,700 --> 05:22:04,500
those boxes turn on some of these

4595
05:22:04,500 --> 05:22:07,320
Eventing style artifacts so that from

4596
05:22:07,320 --> 05:22:09,660
this point forward I have a real-time

4597
05:22:09,660 --> 05:22:11,760
stream of process creation DNS queries

4598
05:22:11,760 --> 05:22:13,440
network connections you name it all of

4599
05:22:13,440 --> 05:22:16,798
it and so it's a poor man's scene and

4600
05:22:16,798 --> 05:22:19,560
and forgive my uh but uh it's it's a way

4601
05:22:19,560 --> 05:22:21,840
to just get real-time visibility from

4602
05:22:21,840 --> 05:22:24,240
this point moving forward and there's a

4603
05:22:24,240 --> 05:22:25,920
lot of these so I'm kind of using up

4604
05:22:25,920 --> 05:22:28,860
here on the example um we've got a DNS

4605
05:22:28,860 --> 05:22:31,440
Eventing artifact that's watching the uh

4606
05:22:31,440 --> 05:22:33,600
the Windows Event Trace logs and it's

4607
05:22:33,600 --> 05:22:35,280
basically just going to package up all

4608
05:22:35,280 --> 05:22:36,840
the DNS queries and it's going to feed

4609
05:22:36,840 --> 05:22:38,520
those up to me but there's many others

4610
05:22:38,520 --> 05:22:40,440
like for instance process creation which

4611
05:22:40,440 --> 05:22:42,900
if you've ever worked with uh cisma logs

4612
05:22:42,900 --> 05:22:44,520
or your EDR logs you probably already

4613
05:22:44,520 --> 05:22:46,680
know process creation is kind of where

4614
05:22:46,680 --> 05:22:48,900
it's at right there's so much I can find

4615
05:22:48,900 --> 05:22:50,940
out about an environment by just looking

4616
05:22:50,940 --> 05:22:53,638
at the process creation Telemetry I

4617
05:22:53,638 --> 05:22:54,600
don't even care if they're walking

4618
05:22:54,600 --> 05:22:56,700
around with a Windows zero day and

4619
05:22:56,700 --> 05:22:58,320
they're doing memory only malware okay

4620
05:22:58,320 --> 05:23:00,540
great but there will always be some sort

4621
05:23:00,540 --> 05:23:01,920
of process creation that's going to help

4622
05:23:01,920 --> 05:23:03,900
shine a light on what's Happening and so

4623
05:23:03,900 --> 05:23:05,458
I love the fact that with no other

4624
05:23:05,458 --> 05:23:07,200
tooling no other sensors no other

4625
05:23:07,200 --> 05:23:09,120
capabilities I can get Velociraptor on

4626
05:23:09,120 --> 05:23:10,500
the box and start bringing in process

4627
05:23:10,500 --> 05:23:13,080
tracking logs across this environment so

4628
05:23:13,080 --> 05:23:14,700
it's really really cool stuff but hey

4629
05:23:14,700 --> 05:23:17,520
can't cismon do all that yes we all

4630
05:23:17,520 --> 05:23:19,500
probably are familiar with sysmon and

4631
05:23:19,500 --> 05:23:20,940
how awesome it is well you already know

4632
05:23:20,940 --> 05:23:23,100
that we can deploy sysmon with

4633
05:23:23,100 --> 05:23:24,900
Velociraptor but where do I send those

4634
05:23:24,900 --> 05:23:26,760
logs right I don't have a seam I just

4635
05:23:26,760 --> 05:23:28,680
walked in this network yesterday there's

4636
05:23:28,680 --> 05:23:30,298
no Splunk there's no open search or

4637
05:23:30,298 --> 05:23:32,700
elasticsearch or whatever okay well I

4638
05:23:32,700 --> 05:23:35,700
can at least ship those cisball logs via

4639
05:23:35,700 --> 05:23:37,920
Velociraptor to the Velociraptor server

4640
05:23:37,920 --> 05:23:39,840
and so there's an artifact for that as

4641
05:23:39,840 --> 05:23:41,940
well Windows is internal system on log

4642
05:23:41,940 --> 05:23:44,280
forward so it does require obviously

4643
05:23:44,280 --> 05:23:46,378
sysmon to be on the box but it will

4644
05:23:46,378 --> 05:23:48,298
check to make sure that it is and if

4645
05:23:48,298 --> 05:23:50,400
it's not it can deploy it and then once

4646
05:23:50,400 --> 05:23:51,780
it's there and running all right now

4647
05:23:51,780 --> 05:23:53,520
let's start scooping up those logs and

4648
05:23:53,520 --> 05:23:55,860
shipping them up to uh the server that's

4649
05:23:55,860 --> 05:23:57,480
going to include your process tracking

4650
05:23:57,480 --> 05:23:59,040
your network connections your files

4651
05:23:59,040 --> 05:24:01,020
being created your process is being

4652
05:24:01,020 --> 05:24:03,000
accessed like processes accessing other

4653
05:24:03,000 --> 05:24:05,340
processes create remote thread you name

4654
05:24:05,340 --> 05:24:06,958
it all the things that you want as a

4655
05:24:06,958 --> 05:24:09,480
threat Hunter we can just start shipping

4656
05:24:09,480 --> 05:24:11,638
that Telemetry in real time using

4657
05:24:11,638 --> 05:24:13,260
nothing but Velociraptor now let me be

4658
05:24:13,260 --> 05:24:15,240
clear let me throw out a disclaimer am I

4659
05:24:15,240 --> 05:24:16,680
saying that you can go get rid of your

4660
05:24:16,680 --> 05:24:18,120
log aggregation tool because

4661
05:24:18,120 --> 05:24:20,040
Velociraptor could do it not at all

4662
05:24:20,040 --> 05:24:21,540
that's not what I'm saying saying

4663
05:24:21,540 --> 05:24:23,280
because this is something you use in a

4664
05:24:23,280 --> 05:24:25,378
pinch when you have nothing else but no

4665
05:24:25,378 --> 05:24:27,420
for a longer term solution you use Big

4666
05:24:27,420 --> 05:24:28,920
Data Systems that were designed for that

4667
05:24:28,920 --> 05:24:30,900
right I'm just saying that if all else

4668
05:24:30,900 --> 05:24:33,000
fails you've got nothing else to to use

4669
05:24:33,000 --> 05:24:36,060
this is better than nothing for sure and

4670
05:24:36,060 --> 05:24:37,740
so here's an example by the way so I've

4671
05:24:37,740 --> 05:24:40,020
enabled in this environment I've enabled

4672
05:24:40,020 --> 05:24:42,240
the uh the shipping of process tracking

4673
05:24:42,240 --> 05:24:45,378
logs being generated by uh um

4674
05:24:45,378 --> 05:24:48,000
Velociraptor specifically so no sysmon

4675
05:24:48,000 --> 05:24:49,980
at all and so it's just showing me a

4676
05:24:49,980 --> 05:24:52,620
real-time stream of process was launched

4677
05:24:52,620 --> 05:24:54,900
oh and it's enriching that by giving me

4678
05:24:54,900 --> 05:24:57,718
a a call chain so it's saying yeah SBC

4679
05:24:57,718 --> 05:24:59,878
host launched but here is its parent and

4680
05:24:59,878 --> 05:25:01,798
here is its parent so I'm getting like

4681
05:25:01,798 --> 05:25:04,620
uh ancestry right which as a threat

4682
05:25:04,620 --> 05:25:06,660
Hunter I can make some really important

4683
05:25:06,660 --> 05:25:08,520
determinations by knowing the

4684
05:25:08,520 --> 05:25:10,200
parent-child relationships of these

4685
05:25:10,200 --> 05:25:12,718
processes how did it come to launch is

4686
05:25:12,718 --> 05:25:14,400
that the parent that I should expect to

4687
05:25:14,400 --> 05:25:16,680
see for SVC host et cetera et cetera et

4688
05:25:16,680 --> 05:25:18,298
cetera right so right there without

4689
05:25:18,298 --> 05:25:20,100
knowing anything about Velociraptor

4690
05:25:20,100 --> 05:25:22,440
that's built in you just turn it on and

4691
05:25:22,440 --> 05:25:24,660
it's flowing right so that's kind of

4692
05:25:24,660 --> 05:25:26,820
cool now this is a similar example but

4693
05:25:26,820 --> 05:25:29,160
showing cisma logs being shipped it's

4694
05:25:29,160 --> 05:25:31,560
virtually you know identical thing but

4695
05:25:31,560 --> 05:25:33,660
I'm using the the added power of system

4696
05:25:33,660 --> 05:25:35,700
on but there it is right it's going to

4697
05:25:35,700 --> 05:25:38,218
flow in real time stream of those events

4698
05:25:38,218 --> 05:25:39,480
in this case these are network

4699
05:25:39,480 --> 05:25:41,400
connections being made another variable

4700
05:25:41,400 --> 05:25:43,920
very valuable thing to have in an IR all

4701
05:25:43,920 --> 05:25:45,298
right we've got to look for the beacon

4702
05:25:45,298 --> 05:25:46,440
right we've got to look for the

4703
05:25:46,440 --> 05:25:48,060
suspicious X fill or whatever it is

4704
05:25:48,060 --> 05:25:50,340
network connections can obviously uh get

4705
05:25:50,340 --> 05:25:51,840
us some quick wins there

4706
05:25:51,840 --> 05:25:54,480
but now let's shift gears um here even

4707
05:25:54,480 --> 05:25:56,458
more let's get a little bit deeper into

4708
05:25:56,458 --> 05:25:58,440
threat hunting and actual threat

4709
05:25:58,440 --> 05:26:00,240
detection because everything else I've

4710
05:26:00,240 --> 05:26:01,378
just shown you you're like well great

4711
05:26:01,378 --> 05:26:03,900
but what if I don't know what what good

4712
05:26:03,900 --> 05:26:06,240
and bad is I see this Telemetry but I'm

4713
05:26:06,240 --> 05:26:07,378
not sure if that's good I don't know if

4714
05:26:07,378 --> 05:26:09,060
that's bad I'm about to show you some

4715
05:26:09,060 --> 05:26:12,360
easy ways to find the evil in uh in some

4716
05:26:12,360 --> 05:26:14,458
pretty automated ways

4717
05:26:14,458 --> 05:26:16,920
all right so it just so happens that

4718
05:26:16,920 --> 05:26:19,440
Velociraptor also has

4719
05:26:19,440 --> 05:26:22,620
threat detection capable Eventing uh

4720
05:26:22,620 --> 05:26:24,420
type artifacts meaning not only is it

4721
05:26:24,420 --> 05:26:26,218
generating Telemetry for what's

4722
05:26:26,218 --> 05:26:28,320
happening but it's already looking for

4723
05:26:28,320 --> 05:26:29,940
some evil things that it knows are evil

4724
05:26:29,940 --> 05:26:31,798
right this one example I'm zero and in

4725
05:26:31,798 --> 05:26:33,900
on here is uh kerberosting right which

4726
05:26:33,900 --> 05:26:36,900
is a very very uh clever uh sort of

4727
05:26:36,900 --> 05:26:38,580
credential theft technique that you see

4728
05:26:38,580 --> 05:26:39,900
a lot of adversaries using nowadays

4729
05:26:39,900 --> 05:26:42,120
because blue teams are oblivious to it

4730
05:26:42,120 --> 05:26:44,700
right but it's a well-known signature

4731
05:26:44,700 --> 05:26:45,718
it's a well-known detection

4732
05:26:45,718 --> 05:26:47,940
unfortunately not a lot of folks are are

4733
05:26:47,940 --> 05:26:49,260
leveraging it it's built into

4734
05:26:49,260 --> 05:26:50,878
Velociraptor so I could fire off this

4735
05:26:50,878 --> 05:26:52,740
Eventing artifact and it will from that

4736
05:26:52,740 --> 05:26:55,500
point forward start looking for signs of

4737
05:26:55,500 --> 05:26:57,600
a potential Kerberos attack happening in

4738
05:26:57,600 --> 05:26:59,878
my environment right and so there's many

4739
05:26:59,878 --> 05:27:01,320
others I didn't want to kind of expand

4740
05:27:01,320 --> 05:27:02,820
on all of them but this is a decent

4741
05:27:02,820 --> 05:27:05,458
example of uh one that exists so threat

4742
05:27:05,458 --> 05:27:07,620
detection just built in just happening

4743
05:27:07,620 --> 05:27:09,958
right uh now am I saying then that

4744
05:27:09,958 --> 05:27:12,840
Velociraptor can replace your EDR no

4745
05:27:12,840 --> 05:27:15,180
why not both right this is just another

4746
05:27:15,180 --> 05:27:17,400
tool in your toolbox but Velociraptor

4747
05:27:17,400 --> 05:27:18,958
can help babysit your EDR I can tell you

4748
05:27:18,958 --> 05:27:20,820
that much all right but let me show you

4749
05:27:20,820 --> 05:27:22,378
another uh I'm going to throw in another

4750
05:27:22,378 --> 05:27:24,180
tool here but it's just too good not to

4751
05:27:24,180 --> 05:27:26,580
mention so I'm a huge fan of a tool

4752
05:27:26,580 --> 05:27:28,680
called Hayabusa if you've ever used

4753
05:27:28,680 --> 05:27:30,420
chainsaw you're familiar with the

4754
05:27:30,420 --> 05:27:33,420
concept what Hayabusa does is you

4755
05:27:33,420 --> 05:27:36,000
execute it against like an entire folder

4756
05:27:36,000 --> 05:27:37,798
of Windows event logs and what it's

4757
05:27:37,798 --> 05:27:39,360
going to do is it's going to rip through

4758
05:27:39,360 --> 05:27:41,340
them looking for well-known threats

4759
05:27:41,340 --> 05:27:43,440
based on well-known Sigma Sigma

4760
05:27:43,440 --> 05:27:45,420
signatures as well as some built-in

4761
05:27:45,420 --> 05:27:47,160
threat detections well when I first

4762
05:27:47,160 --> 05:27:49,378
learned about Hayabusa I said this is

4763
05:27:49,378 --> 05:27:51,900
incredible time to Velociraptor it so

4764
05:27:51,900 --> 05:27:53,760
what we did is we wrote an artifact that

4765
05:27:53,760 --> 05:27:55,920
would take Hayabusa push it down to the

4766
05:27:55,920 --> 05:27:57,958
endpoint run it against the event logs

4767
05:27:57,958 --> 05:28:00,180
just bring me back the threats

4768
05:28:00,180 --> 05:28:02,878
which threats all of them anything that

4769
05:28:02,878 --> 05:28:04,500
matches a well-known you know threat

4770
05:28:04,500 --> 05:28:06,298
that's been published up to Sigma it's

4771
05:28:06,298 --> 05:28:08,040
going to bring me back so in a way what

4772
05:28:08,040 --> 05:28:09,360
I'm doing here is I'm going into an

4773
05:28:09,360 --> 05:28:11,100
environment that had no seam had no

4774
05:28:11,100 --> 05:28:13,440
threat detection and I'm gonna get a

4775
05:28:13,440 --> 05:28:16,080
retroactive window into all detectable

4776
05:28:16,080 --> 05:28:18,240
threats at least with whatever logs are

4777
05:28:18,240 --> 05:28:20,580
available still on those endpoints

4778
05:28:20,580 --> 05:28:21,900
um so what we're going to do here is

4779
05:28:21,900 --> 05:28:23,458
we're going to run that against a number

4780
05:28:23,458 --> 05:28:25,980
of endpoints and here's a just a preview

4781
05:28:25,980 --> 05:28:27,780
into that artifact some of the

4782
05:28:27,780 --> 05:28:29,940
parameters that it's going to ask for uh

4783
05:28:29,940 --> 05:28:31,200
fairly straightforward you can even

4784
05:28:31,200 --> 05:28:33,420
leave the defaults and uh and just fire

4785
05:28:33,420 --> 05:28:35,638
away this is what it kind of looks like

4786
05:28:35,638 --> 05:28:37,080
I'm stepping through what it looks like

4787
05:28:37,080 --> 05:28:39,060
to kind of create and then launch a hunt

4788
05:28:39,060 --> 05:28:41,940
so this is where you would fill in the

4789
05:28:41,940 --> 05:28:44,340
variables the parameters for hey yes

4790
05:28:44,340 --> 05:28:47,100
normalize those logs to UTC oh and by

4791
05:28:47,100 --> 05:28:49,138
the way update to the latest Sigma rules

4792
05:28:49,138 --> 05:28:51,060
before you before you go looking for

4793
05:28:51,060 --> 05:28:52,680
threats right and some other cool things

4794
05:28:52,680 --> 05:28:54,718
that we can do in here but really all I

4795
05:28:54,718 --> 05:28:57,540
care about is this this is the response

4796
05:28:57,540 --> 05:29:00,180
so when it does this across 100 systems

4797
05:29:00,180 --> 05:29:02,400
it's going to bring back hundreds of

4798
05:29:02,400 --> 05:29:04,560
thousands of rows and I'm going to use a

4799
05:29:04,560 --> 05:29:06,540
notebook to sort and filter show me just

4800
05:29:06,540 --> 05:29:08,280
the critical threats all right now show

4801
05:29:08,280 --> 05:29:10,260
me the highs right and what we're seeing

4802
05:29:10,260 --> 05:29:11,580
here actually is a pretty interesting

4803
05:29:11,580 --> 05:29:14,458
output this was uh some really really

4804
05:29:14,458 --> 05:29:16,980
juicy uh true positives on Cobalt strike

4805
05:29:16,980 --> 05:29:18,540
service installations across multiple

4806
05:29:18,540 --> 05:29:20,760
systems folks I did not need a fancy

4807
05:29:20,760 --> 05:29:23,160
seam to find this right hayabus is a

4808
05:29:23,160 --> 05:29:24,600
free and open source Tool uh

4809
05:29:24,600 --> 05:29:25,980
Velociraptor is a free and open source

4810
05:29:25,980 --> 05:29:27,360
tool you put them together magic happens

4811
05:29:27,360 --> 05:29:29,700
this is how you can drop into a customer

4812
05:29:29,700 --> 05:29:31,798
environment without spending an arm and

4813
05:29:31,798 --> 05:29:34,820
a leg on EDR and find threats in minutes

4814
05:29:34,820 --> 05:29:37,200
folks like so obviously would I rather

4815
05:29:37,200 --> 05:29:40,138
have a scene yes but being realistic

4816
05:29:40,138 --> 05:29:42,600
this is the next best thing

4817
05:29:42,600 --> 05:29:45,060
um if you don't

4818
05:29:45,060 --> 05:29:46,920
um and this is just a a preview by the

4819
05:29:46,920 --> 05:29:48,480
way for anyone here that's like he said

4820
05:29:48,480 --> 05:29:50,160
this word he said Sigma I don't know

4821
05:29:50,160 --> 05:29:52,138
what that is that's that's that's uh

4822
05:29:52,138 --> 05:29:53,940
foreign to me um folks this is another

4823
05:29:53,940 --> 05:29:55,440
resource you've absolutely got to have

4824
05:29:55,440 --> 05:29:57,540
in your toolbox uh I wish I had more

4825
05:29:57,540 --> 05:29:59,520
time to just talk about Sigma but just

4826
05:29:59,520 --> 05:30:01,080
throwing up a link up here on the slide

4827
05:30:01,080 --> 05:30:04,260
here Sigma is a phenomenal uh seem

4828
05:30:04,260 --> 05:30:07,378
agnostic threat rule sort of repository

4829
05:30:07,378 --> 05:30:09,240
right so if there's a threat that's been

4830
05:30:09,240 --> 05:30:11,458
researched there's a sigma rule for it

4831
05:30:11,458 --> 05:30:13,560
so um this is one of the coolest

4832
05:30:13,560 --> 05:30:15,298
resources that you could use to get up

4833
05:30:15,298 --> 05:30:17,280
to speed really quickly on how we detect

4834
05:30:17,280 --> 05:30:18,780
threat actors

4835
05:30:18,780 --> 05:30:20,040
um you can go into the sigma project

4836
05:30:20,040 --> 05:30:22,138
here and what I've what I've put up here

4837
05:30:22,138 --> 05:30:23,458
on the screen which I'm sure is probably

4838
05:30:23,458 --> 05:30:25,680
impossible to see it at certain

4839
05:30:25,680 --> 05:30:27,420
distances in the room here is basically

4840
05:30:27,420 --> 05:30:29,820
the raw Sigma rule that was responsible

4841
05:30:29,820 --> 05:30:31,620
for finding Cobalt strike in this

4842
05:30:31,620 --> 05:30:33,420
environment so if I was curious as a

4843
05:30:33,420 --> 05:30:35,820
responder like okay it says it found

4844
05:30:35,820 --> 05:30:37,740
Cobalt strike but how what does that

4845
05:30:37,740 --> 05:30:40,260
mean I can just go look at the sigma

4846
05:30:40,260 --> 05:30:42,120
rule that's that's that's tied to that

4847
05:30:42,120 --> 05:30:44,100
detection say okay so it was looking for

4848
05:30:44,100 --> 05:30:46,580
service with these well-known

4849
05:30:46,580 --> 05:30:49,138
matching these well-known uh patterns

4850
05:30:49,138 --> 05:30:50,940
and signatures and so on and so forth so

4851
05:30:50,940 --> 05:30:52,200
there's no there's no black magic

4852
05:30:52,200 --> 05:30:54,480
there's no invisible or black box here

4853
05:30:54,480 --> 05:30:56,520
that I can't look inside of it's all

4854
05:30:56,520 --> 05:30:59,760
based on well-known uh well-documented

4855
05:30:59,760 --> 05:31:03,120
um uh capabilities here

4856
05:31:03,120 --> 05:31:04,500
um here's another cool one that I love

4857
05:31:04,500 --> 05:31:05,580
to show off

4858
05:31:05,580 --> 05:31:06,298
um

4859
05:31:06,298 --> 05:31:08,700
so uh let's say I wanted to hunt for

4860
05:31:08,700 --> 05:31:10,500
especially if I if I see something like

4861
05:31:10,500 --> 05:31:12,180
this I got Cobalt striking environment

4862
05:31:12,180 --> 05:31:14,340
ooh scary scary right Cobalt strike

4863
05:31:14,340 --> 05:31:17,160
beacons a pretty pretty uh solid memory

4864
05:31:17,160 --> 05:31:18,958
resonant malware can be tough to hunt

4865
05:31:18,958 --> 05:31:20,820
for without good telemetry

4866
05:31:20,820 --> 05:31:24,500
but if you've got a way to scan memory

4867
05:31:24,500 --> 05:31:26,940
across every system in your environment

4868
05:31:26,940 --> 05:31:29,280
for a well-known tool like Cobalt strike

4869
05:31:29,280 --> 05:31:31,138
then even that can't hide from you right

4870
05:31:31,138 --> 05:31:32,520
and that sounds like an expensive

4871
05:31:32,520 --> 05:31:34,440
capability right and and sure it could

4872
05:31:34,440 --> 05:31:36,958
be your EDR can do this Philosoraptor

4873
05:31:36,958 --> 05:31:40,138
can do this very well as well so what we

4874
05:31:40,138 --> 05:31:42,120
can do here is we can run a Yara scan

4875
05:31:42,120 --> 05:31:44,580
for anything under the Sun but Cobalt

4876
05:31:44,580 --> 05:31:46,200
strike there are so many well-known

4877
05:31:46,200 --> 05:31:47,878
signatures for Cobalt strike in Yara

4878
05:31:47,878 --> 05:31:50,820
repositories Google Just Dropped a Bomb

4879
05:31:50,820 --> 05:31:52,920
by the way if you've uh followed the the

4880
05:31:52,920 --> 05:31:55,080
I forget the uh the specific team at

4881
05:31:55,080 --> 05:31:56,458
Google that did this but they just

4882
05:31:56,458 --> 05:31:58,080
dropped a huge repository of cobalt

4883
05:31:58,080 --> 05:31:59,580
strike signatures of like every major

4884
05:31:59,580 --> 05:32:02,218
version going back years so you could

4885
05:32:02,218 --> 05:32:03,240
take these collections these

4886
05:32:03,240 --> 05:32:05,280
repositories plug it into Velociraptor

4887
05:32:05,280 --> 05:32:07,798
and say all right hunt for Cobalt strike

4888
05:32:07,798 --> 05:32:09,120
in my environment and what the

4889
05:32:09,120 --> 05:32:11,100
Velociraptor agent is going to do is

4890
05:32:11,100 --> 05:32:12,958
it's going to scan memory of every one

4891
05:32:12,958 --> 05:32:14,878
of your systems hitting every process is

4892
05:32:14,878 --> 05:32:16,560
this a beacon is this a beacon is this a

4893
05:32:16,560 --> 05:32:18,958
beacon and Magic's gonna come back if

4894
05:32:18,958 --> 05:32:20,400
you've got beacons you're going to find

4895
05:32:20,400 --> 05:32:21,660
them

4896
05:32:21,660 --> 05:32:23,340
um and uh and it's pretty awesome how it

4897
05:32:23,340 --> 05:32:24,958
goes about it so I'm showing you here

4898
05:32:24,958 --> 05:32:26,580
this is the artifact we'd use Windows

4899
05:32:26,580 --> 05:32:29,100
detection Yara process right and it will

4900
05:32:29,100 --> 05:32:30,900
take any ER signature you give to it

4901
05:32:30,900 --> 05:32:33,240
what I love about this artifact by the

4902
05:32:33,240 --> 05:32:36,240
way is if you do not provide a signature

4903
05:32:36,240 --> 05:32:40,798
it defaults to Cobalt strike Beacon

4904
05:32:40,798 --> 05:32:43,680
case closed right like okay uh sure that

4905
05:32:43,680 --> 05:32:46,138
looks good to me run it folks I have

4906
05:32:46,138 --> 05:32:47,940
found Cobalt strike more times than I

4907
05:32:47,940 --> 05:32:50,520
care to count with not even changing

4908
05:32:50,520 --> 05:32:52,020
anything on this screen and just sitting

4909
05:32:52,020 --> 05:32:54,360
yeah go ahead run this so that built-in

4910
05:32:54,360 --> 05:32:56,340
signature right there will find probably

4911
05:32:56,340 --> 05:32:58,680
nine if not more out of ten uh instances

4912
05:32:58,680 --> 05:33:01,138
of a Cobalt strike Beacon but the sky's

4913
05:33:01,138 --> 05:33:03,120
the limit on you could feed this I could

4914
05:33:03,120 --> 05:33:05,638
take a uh a Yar signature hosted on

4915
05:33:05,638 --> 05:33:08,100
GitHub take the raw URL for it and just

4916
05:33:08,100 --> 05:33:09,660
paste that into the screen and it's

4917
05:33:09,660 --> 05:33:11,218
going to pull that down and use it in

4918
05:33:11,218 --> 05:33:13,200
the hunt as well or an entire collection

4919
05:33:13,200 --> 05:33:15,298
of signatures you name it and yes by the

4920
05:33:15,298 --> 05:33:17,340
way if you're wondering yes not only can

4921
05:33:17,340 --> 05:33:18,958
it do y'all against memory can do Yar

4922
05:33:18,958 --> 05:33:20,700
against the file system there's there's

4923
05:33:20,700 --> 05:33:23,700
nothing it really can't do and this is

4924
05:33:23,700 --> 05:33:25,560
just showcasing to you just like Sigma

4925
05:33:25,560 --> 05:33:27,060
you don't need to recreate the wheel

4926
05:33:27,060 --> 05:33:28,920
here folks you don't have to have your

4927
05:33:28,920 --> 05:33:31,138
own custom curated collection of Yara

4928
05:33:31,138 --> 05:33:32,458
rules folks they're all over the

4929
05:33:32,458 --> 05:33:33,958
Internet so I could just simply go to

4930
05:33:33,958 --> 05:33:36,420
GitHub y'all rules repository here uh

4931
05:33:36,420 --> 05:33:38,700
posted by virus total and I can just

4932
05:33:38,700 --> 05:33:40,080
pick one of these categories like

4933
05:33:40,080 --> 05:33:42,298
malware and then feed that to this

4934
05:33:42,298 --> 05:33:44,340
artifact and now it's using that malware

4935
05:33:44,340 --> 05:33:46,620
signature Set uh to hunt for things in

4936
05:33:46,620 --> 05:33:48,000
my environment

4937
05:33:48,000 --> 05:33:50,400
now let's say in all my hunting

4938
05:33:50,400 --> 05:33:53,160
I have found some uh some iocs right

4939
05:33:53,160 --> 05:33:55,378
okay so I know what the suspicious files

4940
05:33:55,378 --> 05:33:57,000
are I know what the suspicious process

4941
05:33:57,000 --> 05:33:59,820
name is it would be really cool okay if

4942
05:33:59,820 --> 05:34:02,100
I could say uh hunt across my entire

4943
05:34:02,100 --> 05:34:04,020
network for any other systems that

4944
05:34:04,020 --> 05:34:06,420
exhibit that behavior right it sounds

4945
05:34:06,420 --> 05:34:08,760
trivial it's not unless you're properly

4946
05:34:08,760 --> 05:34:10,620
tooled for it right if you've got a seam

4947
05:34:10,620 --> 05:34:13,080
sure if you've got EDR sure but what if

4948
05:34:13,080 --> 05:34:16,500
I'm running it for a city right uh you

4949
05:34:16,500 --> 05:34:18,000
know then you're strapped for you're

4950
05:34:18,000 --> 05:34:19,138
strapped for Budget your strap a

4951
05:34:19,138 --> 05:34:21,000
resource Velociraptor would allow me to

4952
05:34:21,000 --> 05:34:23,280
hunt across all my systems for a file on

4953
05:34:23,280 --> 05:34:25,138
the file system for a running process

4954
05:34:25,138 --> 05:34:27,780
and it will do it in seconds maybe

4955
05:34:27,780 --> 05:34:30,958
minutes tops against 50 000 systems

4956
05:34:30,958 --> 05:34:32,878
right so for instance in this example

4957
05:34:32,878 --> 05:34:35,400
here I've got a couple of file names of

4958
05:34:35,400 --> 05:34:36,600
interest and these were by the way

4959
05:34:36,600 --> 05:34:38,878
pulled from a previous slide that were

4960
05:34:38,878 --> 05:34:41,218
deemed to be Cobalt strike uh uh or I'm

4961
05:34:41,218 --> 05:34:43,680
sorry unsigned untrusted processes got

4962
05:34:43,680 --> 05:34:45,900
it so okay cool I found them on that one

4963
05:34:45,900 --> 05:34:47,700
system but they may be on other systems

4964
05:34:47,700 --> 05:34:49,680
so with this artifact I'm about to hunt

4965
05:34:49,680 --> 05:34:51,120
for the presence of of this file

4966
05:34:51,120 --> 05:34:53,878
anywhere on any of my systems and that

4967
05:34:53,878 --> 05:34:55,980
hunt will run in a matter of minutes

4968
05:34:55,980 --> 05:34:57,958
tops and it's going to come back with

4969
05:34:57,958 --> 05:35:00,420
yep these four systems right here also

4970
05:35:00,420 --> 05:35:03,000
have those iocs on them I could do this

4971
05:35:03,000 --> 05:35:04,440
with processes Services anything

4972
05:35:04,440 --> 05:35:06,420
register Keys you name it all the above

4973
05:35:06,420 --> 05:35:08,280
right furthermore I can say hey if you

4974
05:35:08,280 --> 05:35:09,660
find it go ahead and upload it or go

4975
05:35:09,660 --> 05:35:11,400
ahead and hash it right and then when

4976
05:35:11,400 --> 05:35:13,260
you upload it and hash it I could have a

4977
05:35:13,260 --> 05:35:15,060
server side artifact that says now go

4978
05:35:15,060 --> 05:35:16,798
enrich that information with open source

4979
05:35:16,798 --> 05:35:19,798
intelligence virus total or echo echo

4980
05:35:19,798 --> 05:35:21,780
Trail or whatever you know threat Intel

4981
05:35:21,780 --> 05:35:23,520
sources you have Velociraptor can

4982
05:35:23,520 --> 05:35:25,260
interface with it and can go and enrich

4983
05:35:25,260 --> 05:35:26,940
that so your analyst is sitting there

4984
05:35:26,940 --> 05:35:29,580
with data in hand decision enablement

4985
05:35:29,580 --> 05:35:31,500
data about what what's going on here and

4986
05:35:31,500 --> 05:35:33,600
what we need to do with it

4987
05:35:33,600 --> 05:35:35,340
um so this is just an example of the

4988
05:35:35,340 --> 05:35:36,600
results that would come back from that

4989
05:35:36,600 --> 05:35:39,120
artifact looking for those files here's

4990
05:35:39,120 --> 05:35:40,680
where I could very quickly and easily

4991
05:35:40,680 --> 05:35:43,560
see yes here's those two files here's

4992
05:35:43,560 --> 05:35:45,540
the system that they're on you know go

4993
05:35:45,540 --> 05:35:47,760
get the data right go seize that system

4994
05:35:47,760 --> 05:35:49,080
take your forensics Acquisitions

4995
05:35:49,080 --> 05:35:51,360
whatever it is you need to do which is

4996
05:35:51,360 --> 05:35:54,540
the next and last topic folks let's talk

4997
05:35:54,540 --> 05:35:56,638
about how we can use Velociraptor when

4998
05:35:56,638 --> 05:35:58,260
you know there's a threat actor in the

4999
05:35:58,260 --> 05:36:00,718
network knocking things over and causing

5000
05:36:00,718 --> 05:36:03,500
some causing some Havoc

5001
05:36:03,500 --> 05:36:07,138
oh yeah okay so and by the way if I move

5002
05:36:07,138 --> 05:36:09,060
quickly through this last section I have

5003
05:36:09,060 --> 05:36:10,560
no fear I'm going to close out with a

5004
05:36:10,560 --> 05:36:11,878
couple links that you can go if you

5005
05:36:11,878 --> 05:36:13,020
really want to know more about IR

5006
05:36:13,020 --> 05:36:14,820
Velociraptor we talk about it

5007
05:36:14,820 --> 05:36:17,000
extensively in another talk as well

5008
05:36:17,000 --> 05:36:19,500
so here's another cool trick that if you

5009
05:36:19,500 --> 05:36:20,760
have a seam you're like yeah I can do

5010
05:36:20,760 --> 05:36:23,218
this All right but what if I knew all

5011
05:36:23,218 --> 05:36:24,958
right we've got a compromised account in

5012
05:36:24,958 --> 05:36:27,298
our Network you know Paula James Denard

5013
05:36:27,298 --> 05:36:29,520
he got fished gave up his credentials to

5014
05:36:29,520 --> 05:36:30,900
a threat actor they came in through the

5015
05:36:30,900 --> 05:36:32,520
VPN and now who knows what they're doing

5016
05:36:32,520 --> 05:36:34,320
they're moving around as James denark

5017
05:36:34,320 --> 05:36:36,180
well with a seam I can quickly find out

5018
05:36:36,180 --> 05:36:37,920
everywhere that James denard's logged on

5019
05:36:37,920 --> 05:36:40,440
what do I do if I don't have a seam I

5020
05:36:40,440 --> 05:36:41,760
can make a similar query using

5021
05:36:41,760 --> 05:36:44,458
Velociraptor I can ask Velociraptor to

5022
05:36:44,458 --> 05:36:46,378
query every system in my environment

5023
05:36:46,378 --> 05:36:49,080
using this particular artifact here show

5024
05:36:49,080 --> 05:36:51,000
me everywhere this user has logged on to

5025
05:36:51,000 --> 05:36:52,980
a system it's a simple action actually

5026
05:36:52,980 --> 05:36:54,298
it's just going to go through the event

5027
05:36:54,298 --> 05:36:55,920
logs on all those systems looking for

5028
05:36:55,920 --> 05:36:59,638
logon events by that by that user right

5029
05:36:59,638 --> 05:37:01,320
um and so this is just kind of walking

5030
05:37:01,320 --> 05:37:02,520
through some of the details and

5031
05:37:02,520 --> 05:37:04,020
parameters of that artifact not super

5032
05:37:04,020 --> 05:37:06,000
important I actually didn't change

5033
05:37:06,000 --> 05:37:08,458
anything in these except for telling it

5034
05:37:08,458 --> 05:37:10,620
which username I'm looking for James

5035
05:37:10,620 --> 05:37:13,500
Denard all right go get the goods so

5036
05:37:13,500 --> 05:37:14,700
here it is this is where it's coming

5037
05:37:14,700 --> 05:37:16,980
back and saying all right James Denard

5038
05:37:16,980 --> 05:37:20,040
has logged on to every one of these

5039
05:37:20,040 --> 05:37:22,440
systems right I even get the logon type

5040
05:37:22,440 --> 05:37:24,540
the event code that it pulled back the

5041
05:37:24,540 --> 05:37:26,580
source IP of that logon

5042
05:37:26,580 --> 05:37:28,740
I now know the scope of my intrusion

5043
05:37:28,740 --> 05:37:30,718
James Denard should only be logging into

5044
05:37:30,718 --> 05:37:33,180
it13 what's he doing on all these other

5045
05:37:33,180 --> 05:37:35,218
systems I now know these are the systems

5046
05:37:35,218 --> 05:37:36,660
I need to go put hands on I need to

5047
05:37:36,660 --> 05:37:37,980
start pulling triage Acquisitions

5048
05:37:37,980 --> 05:37:39,660
because these are now in scope of my

5049
05:37:39,660 --> 05:37:41,340
intrusion once again if you're thinking

5050
05:37:41,340 --> 05:37:42,660
to yourself yeah this sounds like what a

5051
05:37:42,660 --> 05:37:44,638
seam does you bet how much does a seam

5052
05:37:44,638 --> 05:37:46,740
cost

5053
05:37:46,740 --> 05:37:48,000
and that's only if you're thinking about

5054
05:37:48,000 --> 05:37:50,940
the dollars how much does a seam cost in

5055
05:37:50,940 --> 05:37:54,060
Manpower woman power in my case um how

5056
05:37:54,060 --> 05:37:55,138
much does it cost you know it's it's

5057
05:37:55,138 --> 05:37:57,480
expensive this is an immediate

5058
05:37:57,480 --> 05:37:59,940
instantaneous free 99 tool that can do

5059
05:37:59,940 --> 05:38:02,458
this as well if it's all you've got hey

5060
05:38:02,458 --> 05:38:03,840
how about this all right so we've

5061
05:38:03,840 --> 05:38:05,218
determined these systems are popped

5062
05:38:05,218 --> 05:38:06,840
these systems are compromised I know

5063
05:38:06,840 --> 05:38:08,340
I've got a compromised account hopping

5064
05:38:08,340 --> 05:38:09,718
around wouldn't it be cool if I could

5065
05:38:09,718 --> 05:38:11,700
just like quarantine them prevent the

5066
05:38:11,700 --> 05:38:13,620
damage stop the bleeding Velociraptor

5067
05:38:13,620 --> 05:38:15,780
can do that too so this little button up

5068
05:38:15,780 --> 05:38:17,458
here see I'm drilled in on this system

5069
05:38:17,458 --> 05:38:19,740
sal06 this little button right here

5070
05:38:19,740 --> 05:38:21,240
looks like a little little doctor's

5071
05:38:21,240 --> 05:38:23,520
toolkit you click that you're about to

5072
05:38:23,520 --> 05:38:25,980
quarantine that box and you can even say

5073
05:38:25,980 --> 05:38:27,900
pop this message up on the system

5074
05:38:27,900 --> 05:38:29,280
because your user is going to be a

5075
05:38:29,280 --> 05:38:31,138
little upset when this happens I can't

5076
05:38:31,138 --> 05:38:32,580
reach my internet I can't reach the

5077
05:38:32,580 --> 05:38:35,160
email okay the message pops up hey this

5078
05:38:35,160 --> 05:38:36,780
system's got active malware on it please

5079
05:38:36,780 --> 05:38:38,580
contact the security team here's what

5080
05:38:38,580 --> 05:38:39,600
happens when you do this

5081
05:38:39,600 --> 05:38:40,798
[Music]

5082
05:38:40,798 --> 05:38:42,298
um it's going to push firewall rules to

5083
05:38:42,298 --> 05:38:43,740
that endpoint that disallow

5084
05:38:43,740 --> 05:38:46,440
communication with anything other than

5085
05:38:46,440 --> 05:38:48,958
the Velociraptor server so I stay

5086
05:38:48,958 --> 05:38:51,298
connected as the instant responder I can

5087
05:38:51,298 --> 05:38:53,100
still hunt interrogate pull data back

5088
05:38:53,100 --> 05:38:54,660
but it's not communicating with anything

5089
05:38:54,660 --> 05:38:56,878
else for any other reason so that's kind

5090
05:38:56,878 --> 05:38:59,280
of cool now of course I probably want to

5091
05:38:59,280 --> 05:39:01,798
do this systematically if I've got 14

5092
05:39:01,798 --> 05:39:03,840
affected systems in my environment I

5093
05:39:03,840 --> 05:39:05,760
don't want to quarantine them one at a

5094
05:39:05,760 --> 05:39:07,260
time because what am I doing I'm

5095
05:39:07,260 --> 05:39:09,120
signaling to the adversary when these

5096
05:39:09,120 --> 05:39:11,458
beacons start dropping uh oh they're on

5097
05:39:11,458 --> 05:39:13,620
to me so I'm going to run a hunt across

5098
05:39:13,620 --> 05:39:15,240
all the systems with a label of

5099
05:39:15,240 --> 05:39:17,340
compromised quarantine them all

5100
05:39:17,340 --> 05:39:19,080
instantaneously the threat actor won't

5101
05:39:19,080 --> 05:39:20,878
even have time to respond to react to

5102
05:39:20,878 --> 05:39:22,798
that suddenly all of their shells are

5103
05:39:22,798 --> 05:39:24,780
gone all their beacons are are stopped

5104
05:39:24,780 --> 05:39:27,060
that gives me time that gives me back

5105
05:39:27,060 --> 05:39:29,160
the upper hand of being able to perform

5106
05:39:29,160 --> 05:39:32,520
an actual eradication versus a chase

5107
05:39:32,520 --> 05:39:34,320
chase the you know whack the mole kind

5108
05:39:34,320 --> 05:39:36,298
of uh response activity

5109
05:39:36,298 --> 05:39:37,500
um so pretty straightforward here I'm

5110
05:39:37,500 --> 05:39:38,580
just showing you some of the details of

5111
05:39:38,580 --> 05:39:40,138
the quarantine artifact I could even

5112
05:39:40,138 --> 05:39:41,820
customize those firewall rules that it's

5113
05:39:41,820 --> 05:39:43,200
going to push maybe there's somewhere

5114
05:39:43,200 --> 05:39:45,120
else I wanted to be able to talk to like

5115
05:39:45,120 --> 05:39:46,798
uh some kind of triage server or

5116
05:39:46,798 --> 05:39:48,600
something I can I can add that in here

5117
05:39:48,600 --> 05:39:50,458
and then fire that off and boom those

5118
05:39:50,458 --> 05:39:52,440
systems are compromised but this right

5119
05:39:52,440 --> 05:39:54,180
here folks this is Whitney's already

5120
05:39:54,180 --> 05:39:55,620
touched on this but one of the things I

5121
05:39:55,620 --> 05:39:57,600
love love love about velociraptor in an

5122
05:39:57,600 --> 05:39:59,520
IR perspective is you know we all need

5123
05:39:59,520 --> 05:40:01,260
the forensic data right I've got to do a

5124
05:40:01,260 --> 05:40:02,760
deep dive to figure out what happened

5125
05:40:02,760 --> 05:40:04,860
how did it happen root cause the whole

5126
05:40:04,860 --> 05:40:07,320
nine well because of the awesomeness of

5127
05:40:07,320 --> 05:40:09,420
Cape files which is an open source

5128
05:40:09,420 --> 05:40:11,760
project of all those juicy forensic

5129
05:40:11,760 --> 05:40:13,260
artifacts we know and love well

5130
05:40:13,260 --> 05:40:15,060
Velociraptor can read those and so

5131
05:40:15,060 --> 05:40:16,620
Velociraptor can retrieve all those

5132
05:40:16,620 --> 05:40:18,718
files upload them up to my Velociraptor

5133
05:40:18,718 --> 05:40:20,580
server and now I have what I need on

5134
05:40:20,580 --> 05:40:22,620
that endpoint to get my forensic

5135
05:40:22,620 --> 05:40:26,040
investigation done so without going too

5136
05:40:26,040 --> 05:40:27,540
deep into this it's just an awesome

5137
05:40:27,540 --> 05:40:30,540
artifact that goes and gets a whole lot

5138
05:40:30,540 --> 05:40:32,160
of awesome stuff even if you don't know

5139
05:40:32,160 --> 05:40:34,378
what you need it knows right there's

5140
05:40:34,378 --> 05:40:35,638
some really cool artifacts you can use

5141
05:40:35,638 --> 05:40:37,200
if you don't know any better the Sans

5142
05:40:37,200 --> 05:40:39,000
triage artifact is uh really well

5143
05:40:39,000 --> 05:40:40,920
curated by several of us at the Sans

5144
05:40:40,920 --> 05:40:43,200
deeper faculty uh but you can just fire

5145
05:40:43,200 --> 05:40:44,940
that off it's going to go and get things

5146
05:40:44,940 --> 05:40:45,840
that you probably didn't even know

5147
05:40:45,840 --> 05:40:48,000
existed on that system and then if you

5148
05:40:48,000 --> 05:40:49,980
know what to do with those files

5149
05:40:49,980 --> 05:40:50,820
um you're going to get some pretty

5150
05:40:50,820 --> 05:40:52,560
eye-opening uh perspective into what

5151
05:40:52,560 --> 05:40:54,240
happened on that machine and the real

5152
05:40:54,240 --> 05:40:56,878
magic is finding a way to ship that data

5153
05:40:56,878 --> 05:40:59,040
off to process it generate your

5154
05:40:59,040 --> 05:41:01,080
timelines and we give an awesome talk

5155
05:41:01,080 --> 05:41:03,840
about how we do that using Velociraptor

5156
05:41:03,840 --> 05:41:06,360
plazo and time sketch in another talk

5157
05:41:06,360 --> 05:41:09,180
I'll drop a link here on the slide but I

5158
05:41:09,180 --> 05:41:10,138
want to make sure we have time for

5159
05:41:10,138 --> 05:41:12,718
questions folks so thank you so much if

5160
05:41:12,718 --> 05:41:14,218
anybody has any questions we're happy to

5161
05:41:14,218 --> 05:41:17,280
hang out uh or chat with you in Discord

5162
05:41:17,280 --> 05:41:18,840
foreign

5163
05:41:18,840 --> 05:41:21,500
yes

5164
05:41:22,138 --> 05:41:24,920
yes so as hello hello hello

5165
05:41:24,920 --> 05:41:28,980
uh so as a proud gcih holder I find

5166
05:41:28,980 --> 05:41:31,740
myself thinking when will the curriculum

5167
05:41:31,740 --> 05:41:34,138
move away from netcat to things like

5168
05:41:34,138 --> 05:41:36,600
Velociraptor okay that's a that's a good

5169
05:41:36,600 --> 05:41:39,540
question so um so I'm not going to speak

5170
05:41:39,540 --> 05:41:41,878
in any official capacity for for Sans

5171
05:41:41,878 --> 05:41:44,160
okay but I will say this

5172
05:41:44,160 --> 05:41:45,420
um we are already incorporating

5173
05:41:45,420 --> 05:41:47,580
velociraptor in several of our forensics

5174
05:41:47,580 --> 05:41:49,320
courses right now

5175
05:41:49,320 --> 05:41:52,080
um so we you know Sans is very cautious

5176
05:41:52,080 --> 05:41:54,060
in waiting to make sure that a new and

5177
05:41:54,060 --> 05:41:55,620
emerging tool isn't going to just

5178
05:41:55,620 --> 05:41:57,780
disappear tomorrow because we don't want

5179
05:41:57,780 --> 05:41:58,920
to arm you with something that's

5180
05:41:58,920 --> 05:42:01,280
volatile and gonna disappear

5181
05:42:01,280 --> 05:42:03,660
I'm sorry Velociraptor has kind of

5182
05:42:03,660 --> 05:42:05,700
demonstrated it's it's here to stay so

5183
05:42:05,700 --> 05:42:09,360
it's in multiple courses now you bet

5184
05:42:09,360 --> 05:42:10,638
yes

5185
05:42:10,638 --> 05:42:13,320
big talk my understanding is that the

5186
05:42:13,320 --> 05:42:16,080
client is multi-platform works on Linux

5187
05:42:16,080 --> 05:42:18,480
works on Mac is the tool as effective

5188
05:42:18,480 --> 05:42:20,218
with those other platforms that's a

5189
05:42:20,218 --> 05:42:21,718
fantastic question so I'm going to

5190
05:42:21,718 --> 05:42:22,980
restate what he said for anybody that's

5191
05:42:22,980 --> 05:42:25,080
curious Velociraptor is a cross-platform

5192
05:42:25,080 --> 05:42:27,000
tool it's written in golang so it's

5193
05:42:27,000 --> 05:42:29,520
easily uh compiled in Mac OS Windows

5194
05:42:29,520 --> 05:42:32,760
analytics it even unsupported will run

5195
05:42:32,760 --> 05:42:34,860
on a few other uh Nix Unix based

5196
05:42:34,860 --> 05:42:37,378
platforms but the good question was is

5197
05:42:37,378 --> 05:42:39,420
it as effective on those other platforms

5198
05:42:39,420 --> 05:42:42,240
okay the short answer is it definitely

5199
05:42:42,240 --> 05:42:44,638
excels on Windows overall I will say

5200
05:42:44,638 --> 05:42:47,100
that much however there are lots of

5201
05:42:47,100 --> 05:42:50,100
built-in Linux and Mac OS artifacts so

5202
05:42:50,100 --> 05:42:52,500
it is it's it's very effective on those

5203
05:42:52,500 --> 05:42:54,060
other platforms as well but if I had

5204
05:42:54,060 --> 05:42:56,580
like a pie chart of its coverage Windows

5205
05:42:56,580 --> 05:42:58,620
would dominate for sure but it's it's

5206
05:42:58,620 --> 05:43:00,240
certainly capable in the other two as

5207
05:43:00,240 --> 05:43:03,200
well yeah

5208
05:43:03,298 --> 05:43:05,340
I was gonna say it is open source so

5209
05:43:05,340 --> 05:43:06,840
that's one of the benefits is we've

5210
05:43:06,840 --> 05:43:10,200
we've run into similar issues and so you

5211
05:43:10,200 --> 05:43:11,700
can always contribute things back so

5212
05:43:11,700 --> 05:43:13,020
we've filled some of the gaps that we

5213
05:43:13,020 --> 05:43:14,878
found for Linux and Mac endpoints as

5214
05:43:14,878 --> 05:43:16,260
well and push them back to the community

5215
05:43:16,260 --> 05:43:18,480
so you can do the same thing if you run

5216
05:43:18,480 --> 05:43:23,340
into that and vice versa yeah

5217
05:43:23,760 --> 05:43:26,040
so I have a couple questions the first

5218
05:43:26,040 --> 05:43:28,138
question um can you do like add-ons to

5219
05:43:28,138 --> 05:43:30,180
the to the environment can you add like

5220
05:43:30,180 --> 05:43:32,718
a virus total or other tools into

5221
05:43:32,718 --> 05:43:35,340
Velociraptor to help with the endpoint

5222
05:43:35,340 --> 05:43:36,958
detection or incident response

5223
05:43:36,958 --> 05:43:39,360
absolutely so uh so to answer that

5224
05:43:39,360 --> 05:43:41,340
specific question that specific example

5225
05:43:41,340 --> 05:43:42,360
so

5226
05:43:42,360 --> 05:43:43,860
um

5227
05:43:43,860 --> 05:43:45,780
um Wes Lambert actually contributed an

5228
05:43:45,780 --> 05:43:47,760
artifact to Velociraptor that it's a

5229
05:43:47,760 --> 05:43:49,620
server-side artifact that will take

5230
05:43:49,620 --> 05:43:51,600
anything uh that can generate a hash

5231
05:43:51,600 --> 05:43:54,298
like for instance the PS list so PS list

5232
05:43:54,298 --> 05:43:55,798
brings back process information

5233
05:43:55,798 --> 05:43:58,020
including hashes you can immediately

5234
05:43:58,020 --> 05:43:59,878
feed that to a server-side artifact that

5235
05:43:59,878 --> 05:44:01,920
will do a virus total enrichment and say

5236
05:44:01,920 --> 05:44:03,780
if this hash is known to be malware by

5237
05:44:03,780 --> 05:44:05,700
virus total then let's do something with

5238
05:44:05,700 --> 05:44:07,378
that right so that something could be

5239
05:44:07,378 --> 05:44:08,940
alert the sock if you want to get

5240
05:44:08,940 --> 05:44:10,740
aggressive it could be go down and

5241
05:44:10,740 --> 05:44:12,120
terminate that entire process chain

5242
05:44:12,120 --> 05:44:15,420
right and so yes you can do enrichments

5243
05:44:15,420 --> 05:44:18,420
to anything with an API you can teach

5244
05:44:18,420 --> 05:44:20,878
Velociraptor to hit that API bring back

5245
05:44:20,878 --> 05:44:22,558
enrichment data and then do something

5246
05:44:22,558 --> 05:44:25,260
further with it you bet also um another

5247
05:44:25,260 --> 05:44:27,120
question is about like Matrix do you

5248
05:44:27,120 --> 05:44:30,120
have any like data or or uh open source

5249
05:44:30,120 --> 05:44:33,900
Matrix to see what Velociraptor can do

5250
05:44:33,900 --> 05:44:37,580
in a sense if it's if it's a caching

5251
05:44:37,580 --> 05:44:40,320
indicators of compromise or if it's not

5252
05:44:40,320 --> 05:44:43,260
able to catch any like a detect action

5253
05:44:43,260 --> 05:44:45,360
covered cover coverage Matrix so that's

5254
05:44:45,360 --> 05:44:46,920
a really good question but I wanna I

5255
05:44:46,920 --> 05:44:47,700
wanna

5256
05:44:47,700 --> 05:44:49,920
um I want to kind of re rephrase

5257
05:44:49,920 --> 05:44:51,718
something so I would not put

5258
05:44:51,718 --> 05:44:55,980
velociraptor in the same camp as true

5259
05:44:55,980 --> 05:44:59,400
detection tools like AV EDR and things

5260
05:44:59,400 --> 05:45:01,440
like that which those tools can easily

5261
05:45:01,440 --> 05:45:03,240
be measured against like a miter attack

5262
05:45:03,240 --> 05:45:05,638
Matrix coverage map

5263
05:45:05,638 --> 05:45:07,440
it wouldn't be a fair assessment to put

5264
05:45:07,440 --> 05:45:09,058
velociraptor in that category because it

5265
05:45:09,058 --> 05:45:10,860
wasn't it's in true intended purpose

5266
05:45:10,860 --> 05:45:12,240
it's true intended purpose was to give

5267
05:45:12,240 --> 05:45:14,820
you that real-time ability to reach into

5268
05:45:14,820 --> 05:45:16,920
endpoints to get information it just so

5269
05:45:16,920 --> 05:45:18,780
happens that it can produce Telemetry

5270
05:45:18,780 --> 05:45:22,260
but that's not its Ultra strong suit so

5271
05:45:22,260 --> 05:45:24,000
it would it would look miserable if you

5272
05:45:24,000 --> 05:45:26,160
did try to make a a coverage map for

5273
05:45:26,160 --> 05:45:28,378
detection because it's not meant to be a

5274
05:45:28,378 --> 05:45:30,240
detection tool we just like to share

5275
05:45:30,240 --> 05:45:32,218
that it can be if that's all you have

5276
05:45:32,218 --> 05:45:33,900
but no it would probably not do

5277
05:45:33,900 --> 05:45:36,718
phenomenal against an EDR tool in in

5278
05:45:36,718 --> 05:45:40,580
span of detection coverage yeah yeah

5279
05:45:40,580 --> 05:45:43,200
you bet you bet and we'll also folks

5280
05:45:43,200 --> 05:45:44,580
we'll we'll happily hang out in the

5281
05:45:44,580 --> 05:45:45,958
Discord as well if you want to shoot us

5282
05:45:45,958 --> 05:45:47,940
a text question uh thanks so much for

5283
05:45:47,940 --> 05:45:49,080
having us

5284
05:45:49,080 --> 05:45:52,080
foreign

5285
05:45:53,700 --> 05:45:58,599
[Music]

5286
05:46:30,000 --> 05:46:31,378
yeah is this like the first time you

5287
05:46:31,378 --> 05:46:34,280
volunteered have you done before

5288
05:46:44,070 --> 05:46:53,150
[Music]

5289
05:47:11,260 --> 05:47:14,600
[Music]

5290
05:47:20,280 --> 05:47:22,760
foreign

5291
05:47:36,540 --> 05:47:39,540
foreign

5292
05:48:02,420 --> 05:48:13,289
[Music]

5293
05:48:13,920 --> 05:48:16,050
foreign

5294
05:48:16,050 --> 05:48:56,718
[Music]

5295
05:48:56,718 --> 05:48:59,540
thank you

5296
05:48:59,540 --> 05:49:02,970
[Music]

5297
05:49:04,860 --> 05:49:05,940
all right guys we're gonna go ahead and

5298
05:49:05,940 --> 05:49:07,558
get started here this is Chris Brewer

5299
05:49:07,558 --> 05:49:10,100
and we have sniper incident response

5300
05:49:10,100 --> 05:49:12,860
thank you drew

5301
05:49:12,860 --> 05:49:15,420
thanks everybody for coming this

5302
05:49:15,420 --> 05:49:16,980
afternoon I know it's like late in the

5303
05:49:16,980 --> 05:49:18,600
afternoon it's a little bit warm in this

5304
05:49:18,600 --> 05:49:20,458
room too that's gonna be my feedback for

5305
05:49:20,458 --> 05:49:22,260
cactus conflicts like this room needs

5306
05:49:22,260 --> 05:49:24,000
more air conditioning but today we're

5307
05:49:24,000 --> 05:49:25,320
talking about sniper instant response

5308
05:49:25,320 --> 05:49:27,240
this this talk is going to be a little

5309
05:49:27,240 --> 05:49:29,340
bit heavier on methodology and like the

5310
05:49:29,340 --> 05:49:31,680
way you can do this and how you can move

5311
05:49:31,680 --> 05:49:33,958
forward and do that fun stuff but first

5312
05:49:33,958 --> 05:49:35,638
let's start out with an agenda here

5313
05:49:35,638 --> 05:49:38,218
typical BuzzFeed style headlines I'm

5314
05:49:38,218 --> 05:49:39,718
going to start out with a shocking

5315
05:49:39,718 --> 05:49:41,400
statement to draw you in get you

5316
05:49:41,400 --> 05:49:43,138
interested here we're going to cover

5317
05:49:43,138 --> 05:49:45,180
some Core Concepts like the foundations

5318
05:49:45,180 --> 05:49:47,878
of instant response foundations of

5319
05:49:47,878 --> 05:49:49,740
forensics I do have a couple of

5320
05:49:49,740 --> 05:49:51,840
questions for the audience and just a

5321
05:49:51,840 --> 05:49:53,340
heads up I have some Starbucks gift

5322
05:49:53,340 --> 05:49:55,860
cards so if you answer first got 10 gift

5323
05:49:55,860 --> 05:49:58,138
card for you as we go through we're

5324
05:49:58,138 --> 05:49:59,580
gonna talk about the concept of the idea

5325
05:49:59,580 --> 05:50:01,980
of the big four and I'll get to those in

5326
05:50:01,980 --> 05:50:03,298
a second that's kind of the whole cross

5327
05:50:03,298 --> 05:50:05,458
the whole idea for this one and then

5328
05:50:05,458 --> 05:50:07,798
we'll cover ways to get answers quickly

5329
05:50:07,798 --> 05:50:10,558
finding quick wins and inside of an

5330
05:50:10,558 --> 05:50:11,878
environment whether if you're doing

5331
05:50:11,878 --> 05:50:13,980
instant response for a client or if

5332
05:50:13,980 --> 05:50:15,240
you've got your stock you're doing stuff

5333
05:50:15,240 --> 05:50:17,100
internal I'll show you ways to get

5334
05:50:17,100 --> 05:50:19,440
answers really quick really fun really

5335
05:50:19,440 --> 05:50:21,120
fast ways and then I'm going to wrap up

5336
05:50:21,120 --> 05:50:24,180
here with by far my favorite case I have

5337
05:50:24,180 --> 05:50:26,638
ever worked in the last 12 years of

5338
05:50:26,638 --> 05:50:29,040
doing infosec wrap up with a case study

5339
05:50:29,040 --> 05:50:31,620
that was really really really fun

5340
05:50:31,620 --> 05:50:33,240
shocking statement

5341
05:50:33,240 --> 05:50:35,160
many incident response investigations

5342
05:50:35,160 --> 05:50:39,958
can be solved Within 72 hours three days

5343
05:50:39,958 --> 05:50:41,520
now a lot of you are probably thinking

5344
05:50:41,520 --> 05:50:44,700
no that's not possible it is I'll show

5345
05:50:44,700 --> 05:50:46,458
you how sometimes it takes the client

5346
05:50:46,458 --> 05:50:48,780
five six days because they're slow and

5347
05:50:48,780 --> 05:50:50,040
it takes that long to get us the data

5348
05:50:50,040 --> 05:50:52,200
but once we're rolling once we're in

5349
05:50:52,200 --> 05:50:54,360
there and actually investigating we're

5350
05:50:54,360 --> 05:50:56,580
getting these big four questions solved

5351
05:50:56,580 --> 05:50:58,920
maybe not a complete investigation but

5352
05:50:58,920 --> 05:51:01,138
we've solved a lot of the key pieces for

5353
05:51:01,138 --> 05:51:02,280
that

5354
05:51:02,280 --> 05:51:03,718
but starting out with some really

5355
05:51:03,718 --> 05:51:05,820
foundational background the whole idea

5356
05:51:05,820 --> 05:51:07,320
what this was based on is a thing called

5357
05:51:07,320 --> 05:51:09,718
sniper forensics and sniper friends

5358
05:51:09,718 --> 05:51:11,820
which was probably created eight nine

5359
05:51:11,820 --> 05:51:13,620
maybe ten years back by my buddy Chris

5360
05:51:13,620 --> 05:51:16,558
poke and Chris was at trustwave when he

5361
05:51:16,558 --> 05:51:19,020
came up with this idea and infosec like

5362
05:51:19,020 --> 05:51:21,600
forensics what we do really is a new

5363
05:51:21,600 --> 05:51:24,718
field still right early 2000s that

5364
05:51:24,718 --> 05:51:26,580
wasn't really a thing there wasn't very

5365
05:51:26,580 --> 05:51:28,378
many instant responders there wasn't

5366
05:51:28,378 --> 05:51:30,958
many forensic people it's like starting

5367
05:51:30,958 --> 05:51:34,080
to build out 2005 2006 2008 and still at

5368
05:51:34,080 --> 05:51:35,218
that time people were doing like a

5369
05:51:35,218 --> 05:51:37,138
shotgun blast right you're going out to

5370
05:51:37,138 --> 05:51:38,820
a customer site you're doing the shotgun

5371
05:51:38,820 --> 05:51:39,780
you're getting like a bunch of

5372
05:51:39,780 --> 05:51:41,400
everything out there and you're looking

5373
05:51:41,400 --> 05:51:43,020
at a lot of stuff that didn't matter so

5374
05:51:43,020 --> 05:51:44,280
Chris came up with this concept of

5375
05:51:44,280 --> 05:51:46,798
taking a targeted deliberate approach to

5376
05:51:46,798 --> 05:51:48,660
a forensic investigation being a sniper

5377
05:51:48,660 --> 05:51:50,580
with what you're doing just like any

5378
05:51:50,580 --> 05:51:52,080
concept there's some kind of key pieces

5379
05:51:52,080 --> 05:51:53,520
here you've got to have that

5380
05:51:53,520 --> 05:51:56,458
investigation plan you can't go into an

5381
05:51:56,458 --> 05:51:57,900
investigation without having to plan in

5382
05:51:57,900 --> 05:51:59,040
place you're just going to struggle

5383
05:51:59,040 --> 05:52:00,240
you're going to stumble you're not going

5384
05:52:00,240 --> 05:52:02,160
to make an idea of what's Happening

5385
05:52:02,160 --> 05:52:04,200
uh you're gonna apply that Sound Logic

5386
05:52:04,200 --> 05:52:05,760
some of these are probably familiar to

5387
05:52:05,760 --> 05:52:08,280
you Occam low card Alexa principle

5388
05:52:08,280 --> 05:52:09,780
probably have not heard of before we'll

5389
05:52:09,780 --> 05:52:11,458
talk about those in a second

5390
05:52:11,458 --> 05:52:13,020
you're going to extract what needs to be

5391
05:52:13,020 --> 05:52:16,320
extracted ignore the rest I was doing a

5392
05:52:16,320 --> 05:52:19,980
Insider threat case for a company and it

5393
05:52:19,980 --> 05:52:22,558
was the the lady had exfiltrated data

5394
05:52:22,558 --> 05:52:24,480
supposedly from her company and was

5395
05:52:24,480 --> 05:52:27,120
going to start a new one and for

5396
05:52:27,120 --> 05:52:29,820
whatever reason she agreed to let us

5397
05:52:29,820 --> 05:52:31,860
look at her personal G drive on a zoom

5398
05:52:31,860 --> 05:52:33,780
call with her lawyers and then the

5399
05:52:33,780 --> 05:52:36,058
council we were supporting so we hop on

5400
05:52:36,058 --> 05:52:38,160
there I'm targeted right I'm extracted

5401
05:52:38,160 --> 05:52:39,360
only to be extracted I only look at

5402
05:52:39,360 --> 05:52:40,558
domain controllers I don't need to look

5403
05:52:40,558 --> 05:52:42,900
at other stuff I'm focused on I need to

5404
05:52:42,900 --> 05:52:45,120
focus on so I hop into her G Drive look

5405
05:52:45,120 --> 05:52:47,218
in there she we're on the phone we're on

5406
05:52:47,218 --> 05:52:49,680
the video call and she's admin I can't

5407
05:52:49,680 --> 05:52:51,000
steal anything nothing happened nothing

5408
05:52:51,000 --> 05:52:52,920
nothing nothing and we're looking in

5409
05:52:52,920 --> 05:52:54,660
there okay sure enough G Drive pretty

5410
05:52:54,660 --> 05:52:56,520
empty Google history things like that

5411
05:52:56,520 --> 05:52:59,280
click over on your trash can

5412
05:52:59,280 --> 05:53:00,900
all of her stuff is there that she

5413
05:53:00,900 --> 05:53:03,180
deleted that she said she didn't steal I

5414
05:53:03,180 --> 05:53:04,378
felt a little bit bad for her because

5415
05:53:04,378 --> 05:53:06,058
when that came out there it was really

5416
05:53:06,058 --> 05:53:07,620
obvious that she was guilty and she

5417
05:53:07,620 --> 05:53:09,058
started like breaking down crying and

5418
05:53:09,058 --> 05:53:10,680
things like that but that's the whole

5419
05:53:10,680 --> 05:53:12,480
idea we're caring about only the fun

5420
05:53:12,480 --> 05:53:13,980
things only things that matter for an

5421
05:53:13,980 --> 05:53:15,420
investigation

5422
05:53:15,420 --> 05:53:17,520
and again allowing the data to provide

5423
05:53:17,520 --> 05:53:20,040
the answers it is really cool to do an

5424
05:53:20,040 --> 05:53:21,718
investigation to be like oh it's China

5425
05:53:21,718 --> 05:53:25,138
it's apt it's North Korea it's Iran it's

5426
05:53:25,138 --> 05:53:27,420
the Canadians whoever it happens to be

5427
05:53:27,420 --> 05:53:29,820
and that's not usually how it works we

5428
05:53:29,820 --> 05:53:31,138
got to let the Data Drive our

5429
05:53:31,138 --> 05:53:32,638
investigations we can't jump to

5430
05:53:32,638 --> 05:53:34,320
conclusions we've got to let the data

5431
05:53:34,320 --> 05:53:36,540
drive us for where we're trying to go

5432
05:53:36,540 --> 05:53:38,878
so some of those guiding principles

5433
05:53:38,878 --> 05:53:41,280
the foundation principles low Card

5434
05:53:41,280 --> 05:53:43,200
Exchange principle right every contact

5435
05:53:43,200 --> 05:53:45,120
by a criminal leaves a trace here's one

5436
05:53:45,120 --> 05:53:46,200
of those questions I give a Starbucks

5437
05:53:46,200 --> 05:53:48,298
card for

5438
05:53:48,298 --> 05:53:49,680
when the police department I was

5439
05:53:49,680 --> 05:53:50,760
actually talking to one of my buddies

5440
05:53:50,760 --> 05:53:52,500
from law enforcement when they go in and

5441
05:53:52,500 --> 05:53:54,298
they're like doing an examination for a

5442
05:53:54,298 --> 05:53:56,760
burglary scene for a house what's one of

5443
05:53:56,760 --> 05:53:58,020
the first places they dust for

5444
05:53:58,020 --> 05:53:59,400
fingerprints

5445
05:53:59,400 --> 05:54:00,540
go ahead

5446
05:54:00,540 --> 05:54:02,400
doors are good Joe's good choice that's

5447
05:54:02,400 --> 05:54:04,620
not the first

5448
05:54:04,620 --> 05:54:06,718
that's first

5449
05:54:06,718 --> 05:54:08,580
something your mom tells you to do when

5450
05:54:08,580 --> 05:54:11,240
you leave a room

5451
05:54:13,280 --> 05:54:15,058
right here

5452
05:54:15,058 --> 05:54:16,920
come on down it'll be like uh The Price

5453
05:54:16,920 --> 05:54:19,080
is Right

5454
05:54:19,080 --> 05:54:21,000
what's the second place I don't know if

5455
05:54:21,000 --> 05:54:22,378
anybody's gonna get this so we'll throw

5456
05:54:22,378 --> 05:54:24,540
out a couple answers

5457
05:54:24,540 --> 05:54:25,760
go ahead

5458
05:54:25,760 --> 05:54:28,440
that's a good guess it is really random

5459
05:54:28,440 --> 05:54:30,600
it is random like that that's another

5460
05:54:30,600 --> 05:54:32,580
guess true

5461
05:54:32,580 --> 05:54:35,240
that's think you're getting closer

5462
05:54:35,240 --> 05:54:37,620
who says refrigerator

5463
05:54:37,620 --> 05:54:39,900
there you go that that is actually the

5464
05:54:39,900 --> 05:54:41,638
second place they dust I don't know why

5465
05:54:41,638 --> 05:54:43,680
I got a Starbucks card for you when I

5466
05:54:43,680 --> 05:54:45,240
come down

5467
05:54:45,240 --> 05:54:47,340
they go down there and the bad guys are

5468
05:54:47,340 --> 05:54:49,080
hungry they got the munchies whatever it

5469
05:54:49,080 --> 05:54:51,240
is and they'll open your fridge and

5470
05:54:51,240 --> 05:54:53,218
drink your milk so take away from that

5471
05:54:53,218 --> 05:54:54,780
is if your house gets broken into you

5472
05:54:54,780 --> 05:54:56,160
you're probably going to want to trash

5473
05:54:56,160 --> 05:54:57,420
all the food in your fridge because you

5474
05:54:57,420 --> 05:55:00,600
have no idea who's ate what inside of

5475
05:55:00,600 --> 05:55:02,717
them

5476
05:55:04,020 --> 05:55:06,000
another one Occam's razor

5477
05:55:06,000 --> 05:55:07,980
simplest explanation is often the right

5478
05:55:07,980 --> 05:55:10,620
one very simple concept let the data be

5479
05:55:10,620 --> 05:55:12,600
the data and a new one that you might

5480
05:55:12,600 --> 05:55:15,180
not have heard of before Alexi principle

5481
05:55:15,180 --> 05:55:16,740
this is one of the guiding facts from

5482
05:55:16,740 --> 05:55:19,138
when Pogue came up with his sniper

5483
05:55:19,138 --> 05:55:21,240
forensics idea there's four kind of big

5484
05:55:21,240 --> 05:55:23,218
questions for here what questions are

5485
05:55:23,218 --> 05:55:24,660
you trying to answer

5486
05:55:24,660 --> 05:55:27,420
what data do you need to answer that

5487
05:55:27,420 --> 05:55:29,218
question how do you analyze that data is

5488
05:55:29,218 --> 05:55:30,420
it using the Velociraptor like the

5489
05:55:30,420 --> 05:55:32,580
previous talk or whatever it is and what

5490
05:55:32,580 --> 05:55:34,620
does that data tell you foundational

5491
05:55:34,620 --> 05:55:36,958
questions foundational ideas behind

5492
05:55:36,958 --> 05:55:38,700
instant response and forensics that are

5493
05:55:38,700 --> 05:55:39,840
kind of The Guiding principles for

5494
05:55:39,840 --> 05:55:40,680
everything we're going to talk about

5495
05:55:40,680 --> 05:55:42,540
here

5496
05:55:42,540 --> 05:55:44,218
so we've had a problem

5497
05:55:44,218 --> 05:55:47,340
a lot of people are still doing

5498
05:55:47,340 --> 05:55:49,378
the one host at a time approach the

5499
05:55:49,378 --> 05:55:52,200
current way of investigating is slow one

5500
05:55:52,200 --> 05:55:53,638
host at a time is fine if you've got

5501
05:55:53,638 --> 05:55:55,920
three hosts to look at you can do triage

5502
05:55:55,920 --> 05:55:58,558
three to five hours per host but that

5503
05:55:58,558 --> 05:56:00,540
doesn't scale what if you have 500 hosts

5504
05:56:00,540 --> 05:56:03,840
a thousand hosts 5 000 hosts you can't

5505
05:56:03,840 --> 05:56:05,280
do one at a time because you're going to

5506
05:56:05,280 --> 05:56:08,160
miss those fast those quick wins who are

5507
05:56:08,160 --> 05:56:09,958
doing an investigation so I was thinking

5508
05:56:09,958 --> 05:56:10,920
about this like what can we do

5509
05:56:10,920 --> 05:56:12,420
differently how can we kind of solve

5510
05:56:12,420 --> 05:56:15,180
this and really doing that one at a time

5511
05:56:15,180 --> 05:56:16,440
approach and the way we're kind of

5512
05:56:16,440 --> 05:56:18,000
conducting the incident response and

5513
05:56:18,000 --> 05:56:20,520
investigations we weren't prioritizing

5514
05:56:20,520 --> 05:56:22,620
the questions that Council or the

5515
05:56:22,620 --> 05:56:25,440
c-suite the lawyers or the execs cared

5516
05:56:25,440 --> 05:56:27,480
about for an investigation those guys

5517
05:56:27,480 --> 05:56:29,218
lawyers especially always care about

5518
05:56:29,218 --> 05:56:30,600
data exfiltration right because they

5519
05:56:30,600 --> 05:56:31,920
gotta wonder if they have to make notice

5520
05:56:31,920 --> 05:56:33,600
to the public they've got California

5521
05:56:33,600 --> 05:56:35,520
privacy laws they've got gdpr they've

5522
05:56:35,520 --> 05:56:37,680
got all that stuff to worry about so

5523
05:56:37,680 --> 05:56:39,360
when we're doing instant response with

5524
05:56:39,360 --> 05:56:41,878
unit 42 the lawyers are our clients

5525
05:56:41,878 --> 05:56:42,958
basically those are the guys that we

5526
05:56:42,958 --> 05:56:43,980
work for we want to make the lawyers

5527
05:56:43,980 --> 05:56:46,138
happy so we weren't prioritizing their

5528
05:56:46,138 --> 05:56:47,580
questions like okay we need to come up

5529
05:56:47,580 --> 05:56:49,620
with a better way of doing this

5530
05:56:49,620 --> 05:56:52,500
and that's kind of where sniper instant

5531
05:56:52,500 --> 05:56:54,600
response came from is the fast targeted

5532
05:56:54,600 --> 05:56:57,180
hunting of data out there we're going to

5533
05:56:57,180 --> 05:56:59,160
prior to our prioritize answering the

5534
05:56:59,160 --> 05:57:01,020
big four questions and I'll get to those

5535
05:57:01,020 --> 05:57:02,520
big four questions in a minute I'm going

5536
05:57:02,520 --> 05:57:03,600
to allude to them a couple more times

5537
05:57:03,600 --> 05:57:05,340
just to tease it a little bit that's

5538
05:57:05,340 --> 05:57:06,900
where this kind of concept came up

5539
05:57:06,900 --> 05:57:08,458
because we weren't doing things right so

5540
05:57:08,458 --> 05:57:10,200
let's come up with an idea

5541
05:57:10,200 --> 05:57:12,058
we're going to task our analysts or our

5542
05:57:12,058 --> 05:57:14,160
Consultants your sock staff with

5543
05:57:14,160 --> 05:57:15,718
answering the big four questions right

5544
05:57:15,718 --> 05:57:17,340
we're going to give them to each one of

5545
05:57:17,340 --> 05:57:18,780
those people and make them a case lead

5546
05:57:18,780 --> 05:57:21,420
or a work stream lead for that I am huge

5547
05:57:21,420 --> 05:57:23,580
on empowering my team we'll have a team

5548
05:57:23,580 --> 05:57:25,138
of eight or nine ten people it doesn't

5549
05:57:25,138 --> 05:57:27,298
matter what your title is you can be a

5550
05:57:27,298 --> 05:57:28,680
stock level one person you could be

5551
05:57:28,680 --> 05:57:30,360
somebody on the cert you could be an

5552
05:57:30,360 --> 05:57:32,638
associate consultant or a principal it

5553
05:57:32,638 --> 05:57:34,260
doesn't matter you can be a lead on a

5554
05:57:34,260 --> 05:57:35,760
case I'm huge on that I don't care what

5555
05:57:35,760 --> 05:57:37,798
your title is you can be elite so doing

5556
05:57:37,798 --> 05:57:39,298
this I'm empowering my team I'm getting

5557
05:57:39,298 --> 05:57:41,160
buy-in from them they are enthusiastic

5558
05:57:41,160 --> 05:57:42,840
about solving the problems they're about

5559
05:57:42,840 --> 05:57:44,100
enthusiastic about solving the case

5560
05:57:44,100 --> 05:57:46,500
they've got that responsibility and

5561
05:57:46,500 --> 05:57:48,000
they're like really motivated from that

5562
05:57:48,000 --> 05:57:49,440
so we assigned these work stream leads

5563
05:57:49,440 --> 05:57:51,298
to those big four questions

5564
05:57:51,298 --> 05:57:52,680
and then again just like with

5565
05:57:52,680 --> 05:57:54,540
Velociraptor some other tools out there

5566
05:57:54,540 --> 05:57:57,360
we're looking at multiple hosts at once

5567
05:57:57,360 --> 05:57:59,400
to drive the investigation forward to

5568
05:57:59,400 --> 05:58:01,680
get those quick wins to make Council

5569
05:58:01,680 --> 05:58:03,600
happy to make the client happy to get

5570
05:58:03,600 --> 05:58:06,360
stuff solved in that 72 hours

5571
05:58:06,360 --> 05:58:09,180
so the big four all right questions are

5572
05:58:09,180 --> 05:58:10,920
the answer there's actually a great book

5573
05:58:10,920 --> 05:58:12,058
called questions are the answer if

5574
05:58:12,058 --> 05:58:13,558
you've never read it highly recommend

5575
05:58:13,558 --> 05:58:15,660
that's kind of what jogged my mind to

5576
05:58:15,660 --> 05:58:16,860
kind of think of this and kind of

5577
05:58:16,860 --> 05:58:18,540
discover come up with a way to talk

5578
05:58:18,540 --> 05:58:22,020
about this itself so the big four what

5579
05:58:22,020 --> 05:58:23,218
did they take

5580
05:58:23,218 --> 05:58:25,138
every case we care about data

5581
05:58:25,138 --> 05:58:27,058
exfiltration there may not be data

5582
05:58:27,058 --> 05:58:29,520
exfiltration on every engagement but we

5583
05:58:29,520 --> 05:58:31,200
always care about that because that's

5584
05:58:31,200 --> 05:58:32,580
going to make legal notice we have to

5585
05:58:32,580 --> 05:58:33,780
know if stuff is going to be posted on

5586
05:58:33,780 --> 05:58:35,660
the dark web it's leaked on telegram

5587
05:58:35,660 --> 05:58:37,680
intellectual property things like that

5588
05:58:37,680 --> 05:58:39,958
especially Drew who worked at a big

5589
05:58:39,958 --> 05:58:41,280
construction engineering company before

5590
05:58:41,280 --> 05:58:42,540
in the past and we cared about

5591
05:58:42,540 --> 05:58:44,340
intellectual property being stolen by

5592
05:58:44,340 --> 05:58:46,440
China

5593
05:58:46,440 --> 05:58:48,240
I'll leave it at that for for the

5594
05:58:48,240 --> 05:58:51,540
comment but uh what did they take are

5595
05:58:51,540 --> 05:58:53,458
they still here this is the idea about

5596
05:58:53,458 --> 05:58:56,218
persistence is the bad guy still inside

5597
05:58:56,218 --> 05:58:58,260
of my environment I need to know that

5598
05:58:58,260 --> 05:59:00,000
that's a big question I have to solve

5599
05:59:00,000 --> 05:59:01,558
that's going to be my drivers for the

5600
05:59:01,558 --> 05:59:02,940
case

5601
05:59:02,940 --> 05:59:05,458
where do they go this is the lateral

5602
05:59:05,458 --> 05:59:07,740
movement question are they on one host

5603
05:59:07,740 --> 05:59:09,780
are they on Two Hosts are they on 60

5604
05:59:09,780 --> 05:59:13,260
hosts just about every single case I

5605
05:59:13,260 --> 05:59:15,540
have ever worked there's been lateral

5606
05:59:15,540 --> 05:59:18,180
movement it may be only to one host but

5607
05:59:18,180 --> 05:59:19,440
the bad guys are going to get in there

5608
05:59:19,440 --> 05:59:21,298
they're going to look around they're

5609
05:59:21,298 --> 05:59:22,920
going to do Discovery they're going to

5610
05:59:22,920 --> 05:59:24,360
move laterally through the environment

5611
05:59:24,360 --> 05:59:25,980
touching other things

5612
05:59:25,980 --> 05:59:27,958
one of the cases that I worked was in

5613
05:59:27,958 --> 05:59:30,180
the middle of Illinois middle of nowhere

5614
05:59:30,180 --> 05:59:33,000
one stoplight Town it was corn fields

5615
05:59:33,000 --> 05:59:34,860
everywhere the stoplight had the gas

5616
05:59:34,860 --> 05:59:36,480
station had the restaurant there was

5617
05:59:36,480 --> 05:59:37,680
nothing there we had to drive about 45

5618
05:59:37,680 --> 05:59:39,900
minutes into the client site to do an

5619
05:59:39,900 --> 05:59:41,280
engagement

5620
05:59:41,280 --> 05:59:42,780
um but the bad guy got in through open

5621
05:59:42,780 --> 05:59:45,540
RDP really weak credentials bad guy got

5622
05:59:45,540 --> 05:59:47,280
in there did lateral movement to one box

5623
05:59:47,280 --> 05:59:49,440
off back over the reason he hopped back

5624
05:59:49,440 --> 05:59:50,820
over because that boxy compromise was

5625
05:59:50,820 --> 05:59:52,500
their rdb server was their Exchange

5626
05:59:52,500 --> 05:59:53,878
Server which is also their file server

5627
05:59:53,878 --> 05:59:55,200
so we had everything as soon as he got

5628
05:59:55,200 --> 05:59:57,540
in there but a really fun case I felt

5629
05:59:57,540 --> 05:59:59,160
like Mike Rowe from Dirty Jobs because

5630
05:59:59,160 --> 06:00:00,718
we got in like the farm country and I

5631
06:00:00,718 --> 06:00:02,700
got to go up to the silos and get a tour

5632
06:00:02,700 --> 06:00:04,138
of the farm and stuff like that so it

5633
06:00:04,138 --> 06:00:05,940
was a really fun memorable case but

5634
06:00:05,940 --> 06:00:07,440
where did they go there's always going

5635
06:00:07,440 --> 06:00:09,660
to be lateral movement and the fourth

5636
06:00:09,660 --> 06:00:12,240
question is how they get in that's that

5637
06:00:12,240 --> 06:00:14,760
identifying patient zero idea or that

5638
06:00:14,760 --> 06:00:16,378
concept behind it

5639
06:00:16,378 --> 06:00:18,180
I've actually prioritized these

5640
06:00:18,180 --> 06:00:20,340
questions up here in kind of order of

5641
06:00:20,340 --> 06:00:22,260
importance sometimes when you're doing

5642
06:00:22,260 --> 06:00:24,660
an investigation or working in a sock or

5643
06:00:24,660 --> 06:00:25,980
security whatever

5644
06:00:25,980 --> 06:00:27,718
you might prioritize that how they get

5645
06:00:27,718 --> 06:00:29,700
in first but really you're kind of

5646
06:00:29,700 --> 06:00:31,320
working backwards when you do that I'll

5647
06:00:31,320 --> 06:00:32,700
kind of explain that as we kind of go

5648
06:00:32,700 --> 06:00:34,260
through so these are kind of order

5649
06:00:34,260 --> 06:00:36,360
priority what do they take and are they

5650
06:00:36,360 --> 06:00:38,280
still here a kind of one in one but I

5651
06:00:38,280 --> 06:00:39,780
had to put a two in there so they're

5652
06:00:39,780 --> 06:00:41,520
kind of two priority things but yeah

5653
06:00:41,520 --> 06:00:43,020
that's kind of the order of importance

5654
06:00:43,020 --> 06:00:44,700
for those

5655
06:00:44,700 --> 06:00:46,680
so what we do we have this concept

5656
06:00:46,680 --> 06:00:48,480
there's gonna be a lot of a team themes

5657
06:00:48,480 --> 06:00:50,878
here so if you're a kid in the 80s and

5658
06:00:50,878 --> 06:00:53,040
watched a team on TV you're welcome if

5659
06:00:53,040 --> 06:00:54,900
you have never watched it go check it

5660
06:00:54,900 --> 06:00:57,420
out as a fantastic TV show but the idea

5661
06:00:57,420 --> 06:00:59,218
of a strike team a team of people who

5662
06:00:59,218 --> 06:01:01,200
are skilled and into response and

5663
06:01:01,200 --> 06:01:03,000
they're used for the first three days of

5664
06:01:03,000 --> 06:01:05,160
an investigation and the thing that we

5665
06:01:05,160 --> 06:01:07,860
run into a lot is people do forensics

5666
06:01:07,860 --> 06:01:10,440
they go through and approach a case as

5667
06:01:10,440 --> 06:01:12,000
forensics and forensics is not his

5668
06:01:12,000 --> 06:01:14,100
response instant response is finding

5669
06:01:14,100 --> 06:01:16,080
those quick answers I don't need to look

5670
06:01:16,080 --> 06:01:18,240
at top to bottom every single thing on a

5671
06:01:18,240 --> 06:01:20,218
host to solve the problem remember those

5672
06:01:20,218 --> 06:01:22,440
four big questions so we're looking at

5673
06:01:22,440 --> 06:01:25,200
that fast triage fast analysis of data

5674
06:01:25,200 --> 06:01:27,480
focusing on those quick wins that is

5675
06:01:27,480 --> 06:01:29,700
going to solve the case for us and also

5676
06:01:29,700 --> 06:01:31,080
creating something called a hunt plan

5677
06:01:31,080 --> 06:01:32,520
which I'll show you an example of in a

5678
06:01:32,520 --> 06:01:34,020
minute and answering those big four

5679
06:01:34,020 --> 06:01:36,240
questions if you've watched 18 before

5680
06:01:36,240 --> 06:01:38,638
right they roll into a site there's some

5681
06:01:38,638 --> 06:01:40,200
sob story from somebody who's hurting

5682
06:01:40,200 --> 06:01:42,900
the family or whatever it is and they

5683
06:01:42,900 --> 06:01:45,420
win and they do the job keep bad guy out

5684
06:01:45,420 --> 06:01:47,340
and then they leave they don't stick

5685
06:01:47,340 --> 06:01:48,780
around for the law enforcement they

5686
06:01:48,780 --> 06:01:50,820
don't stick around for the trial and the

5687
06:01:50,820 --> 06:01:53,760
judge and all the court things and stuff

5688
06:01:53,760 --> 06:01:55,080
like that so think about the Strike Team

5689
06:01:55,080 --> 06:01:57,360
if you do this idea for your work as

5690
06:01:57,360 --> 06:01:59,520
you're going in and moving fast and

5691
06:01:59,520 --> 06:02:01,558
getting out and leaving before Decker

5692
06:02:01,558 --> 06:02:03,298
whoever happens to be is going to arrest

5693
06:02:03,298 --> 06:02:05,940
you from the military

5694
06:02:05,940 --> 06:02:08,638
so step one like I said an investigation

5695
06:02:08,638 --> 06:02:10,980
plan having a plan in place really keeps

5696
06:02:10,980 --> 06:02:13,138
that investigation focused you've got to

5697
06:02:13,138 --> 06:02:14,760
write down your goals what are you

5698
06:02:14,760 --> 06:02:16,440
trying to solve is it data exfiltration

5699
06:02:16,440 --> 06:02:19,080
is a ransomware case is it Insider

5700
06:02:19,080 --> 06:02:20,760
threat is extortion Whatever It Is Write

5701
06:02:20,760 --> 06:02:22,740
down those goals focus on what the

5702
06:02:22,740 --> 06:02:24,480
client Council maybe your executive

5703
06:02:24,480 --> 06:02:25,920
staff is telling you what do they need

5704
06:02:25,920 --> 06:02:27,540
answers for because again you're trying

5705
06:02:27,540 --> 06:02:29,400
to make your boss happy so make sure you

5706
06:02:29,400 --> 06:02:31,620
prioritize their questions too and then

5707
06:02:31,620 --> 06:02:33,540
know what the answers look like for your

5708
06:02:33,540 --> 06:02:36,360
investigation have a clear criteria have

5709
06:02:36,360 --> 06:02:38,638
a way for answering those and sometimes

5710
06:02:38,638 --> 06:02:40,138
sometimes when we're doing stuff that

5711
06:02:40,138 --> 06:02:41,940
question four because of client

5712
06:02:41,940 --> 06:02:44,458
remediation things like that we can't

5713
06:02:44,458 --> 06:02:45,780
find patient zero because they've

5714
06:02:45,780 --> 06:02:47,638
overwritten a box they've restored from

5715
06:02:47,638 --> 06:02:49,740
backups or whatever it happens to be so

5716
06:02:49,740 --> 06:02:51,540
if that is show the negative evidence

5717
06:02:51,540 --> 06:02:54,058
say hey we've traced this back as far as

5718
06:02:54,058 --> 06:02:56,520
we can with lateral movement the iocs

5719
06:02:56,520 --> 06:02:58,440
things like that and that it ends right

5720
06:02:58,440 --> 06:03:00,480
here and one of my favorite phrases when

5721
06:03:00,480 --> 06:03:02,458
I'm writing reports is saying based on

5722
06:03:02,458 --> 06:03:04,740
the available evidence which gets me out

5723
06:03:04,740 --> 06:03:05,878
of trouble with the lawyers things like

5724
06:03:05,878 --> 06:03:07,200
that so that's going to be your get out

5725
06:03:07,200 --> 06:03:09,000
of jail free card so why can't you find

5726
06:03:09,000 --> 06:03:10,020
it it's because based on the available

5727
06:03:10,020 --> 06:03:12,180
evidence it's not there so have that

5728
06:03:12,180 --> 06:03:14,280
investigation plan write this down ahead

5729
06:03:14,280 --> 06:03:15,600
of time if you're working as a case lead

5730
06:03:15,600 --> 06:03:17,040
if you're working as a sock lead or

5731
06:03:17,040 --> 06:03:17,940
things like that and you've got

5732
06:03:17,940 --> 06:03:19,798
something major happening come up with

5733
06:03:19,798 --> 06:03:21,180
your investigation plan write down your

5734
06:03:21,180 --> 06:03:22,500
goals write down what you're trying to

5735
06:03:22,500 --> 06:03:23,638
solve

5736
06:03:23,638 --> 06:03:26,100
the first 36 hours of Investigation

5737
06:03:26,100 --> 06:03:28,378
here's how we prioritize stuff here's

5738
06:03:28,378 --> 06:03:30,120
what we do we build out our

5739
06:03:30,120 --> 06:03:31,798
investigation plan we deploy tools

5740
06:03:31,798 --> 06:03:33,958
collect evidence a lot of times when

5741
06:03:33,958 --> 06:03:35,700
responding to client sites they don't

5742
06:03:35,700 --> 06:03:38,820
have EDR they don't have xdr they don't

5743
06:03:38,820 --> 06:03:40,558
have any of the advanced stuff sometimes

5744
06:03:40,558 --> 06:03:42,000
they do sometimes they don't it really

5745
06:03:42,000 --> 06:03:44,160
depends so it might be deploying tools

5746
06:03:44,160 --> 06:03:45,480
it might be collecting the evidence and

5747
06:03:45,480 --> 06:03:47,820
then we're going to prioritize finding

5748
06:03:47,820 --> 06:03:49,138
that persistence finding that

5749
06:03:49,138 --> 06:03:50,400
exfiltration that's what you do the

5750
06:03:50,400 --> 06:03:53,458
first 36 hours of a case it's really fun

5751
06:03:53,458 --> 06:03:54,958
if you're going out to a client site

5752
06:03:54,958 --> 06:03:57,000
because you're like the heroes for them

5753
06:03:57,000 --> 06:03:58,080
you get to wear like a little Superman

5754
06:03:58,080 --> 06:03:59,700
cape and things like that because you're

5755
06:03:59,700 --> 06:04:00,660
out there and they're excited that

5756
06:04:00,660 --> 06:04:02,160
you're here like okay save us save us

5757
06:04:02,160 --> 06:04:04,740
figure everything out and the first 36

5758
06:04:04,740 --> 06:04:07,378
hours for us as instant responders is we

5759
06:04:07,378 --> 06:04:09,120
don't usually sleep very much from the

5760
06:04:09,120 --> 06:04:10,920
first day or so kind of run on coffee

5761
06:04:10,920 --> 06:04:12,600
and Red Bull to keep us going things

5762
06:04:12,600 --> 06:04:14,340
like that as we kind of do that but

5763
06:04:14,340 --> 06:04:16,980
again identifying the exploitation one

5764
06:04:16,980 --> 06:04:19,260
of the other cases I was working at uh

5765
06:04:19,260 --> 06:04:21,000
we're there rolling out to the client

5766
06:04:21,000 --> 06:04:23,520
side on site bad guy had tried to come

5767
06:04:23,520 --> 06:04:25,138
of their tracks a little bit they'd ran

5768
06:04:25,138 --> 06:04:26,400
CCleaner if you're familiar with that

5769
06:04:26,400 --> 06:04:28,260
they've kind of cleared the event logs

5770
06:04:28,260 --> 06:04:30,058
things like that we know there is data X

5771
06:04:30,058 --> 06:04:31,798
folks that's what the case was 30 000

5772
06:04:31,798 --> 06:04:33,298
extortion demand but we didn't know what

5773
06:04:33,298 --> 06:04:35,160
they took so we're hopping on there and

5774
06:04:35,160 --> 06:04:36,780
I'll get to that in a second or hopping

5775
06:04:36,780 --> 06:04:39,180
on there and sure enough the usn journal

5776
06:04:39,180 --> 06:04:40,500
one of my favorite places to look for

5777
06:04:40,500 --> 06:04:43,138
data Expo bad guy had creatively named

5778
06:04:43,138 --> 06:04:45,660
their exfiltration folder as it's not

5779
06:04:45,660 --> 06:04:47,458
stuff it was another s word but it was

5780
06:04:47,458 --> 06:04:50,458
stuff to steal was his Expo folder so it

5781
06:04:50,458 --> 06:04:52,980
made it really really really easy to

5782
06:04:52,980 --> 06:04:54,240
figure out what they took off the

5783
06:04:54,240 --> 06:04:55,558
environment and inside there there's

5784
06:04:55,558 --> 06:04:57,240
thousands thousands of Records so

5785
06:04:57,240 --> 06:04:59,700
Council was super happy client was super

5786
06:04:59,700 --> 06:05:01,320
happy because we had identified all this

5787
06:05:01,320 --> 06:05:03,600
stuff and it was important data was tax

5788
06:05:03,600 --> 06:05:05,940
records pii Phi things like that so

5789
06:05:05,940 --> 06:05:07,920
first 36 hours

5790
06:05:07,920 --> 06:05:09,840
first 36 hours right the investigation

5791
06:05:09,840 --> 06:05:11,160
plan we kind of came up with this I

5792
06:05:11,160 --> 06:05:12,958
talked about this a little bit we've got

5793
06:05:12,958 --> 06:05:14,340
those four big questions there in the

5794
06:05:14,340 --> 06:05:16,080
yellow sticky note side what they take

5795
06:05:16,080 --> 06:05:17,700
are they still here where'd they go

5796
06:05:17,700 --> 06:05:19,680
how'd they get in pretty much every case

5797
06:05:19,680 --> 06:05:21,480
that we work there's going to be some

5798
06:05:21,480 --> 06:05:24,840
sort of hunting EDR they might be using

5799
06:05:24,840 --> 06:05:28,020
I don't know Carbon black crowdstrike

5800
06:05:28,020 --> 06:05:30,058
Palo Alto stuff whatever it happens to

5801
06:05:30,058 --> 06:05:31,138
be we're gonna be hunting through the

5802
06:05:31,138 --> 06:05:32,100
data we're gonna be hunting for that

5803
06:05:32,100 --> 06:05:34,020
Expo hunting for the persistence hunting

5804
06:05:34,020 --> 06:05:35,458
for a lot of movement we're going to

5805
06:05:35,458 --> 06:05:36,900
have firewall logs pretty much every

5806
06:05:36,900 --> 06:05:38,760
company has got a firewall maybe a great

5807
06:05:38,760 --> 06:05:40,620
firewall maybe a terrible firewall but

5808
06:05:40,620 --> 06:05:42,240
they've got a firewall of some sort so

5809
06:05:42,240 --> 06:05:43,200
we're going to look at those firewall

5810
06:05:43,200 --> 06:05:44,458
logs we're gonna get those quick wins

5811
06:05:44,458 --> 06:05:45,660
again we're going to look for the

5812
06:05:45,660 --> 06:05:47,458
foreign IPS we're going to look for

5813
06:05:47,458 --> 06:05:49,440
large data transfers a great thing to do

5814
06:05:49,440 --> 06:05:50,700
if you don't have an alert like this set

5815
06:05:50,700 --> 06:05:53,280
up based on your firewall if you average

5816
06:05:53,280 --> 06:05:55,440
100 gigs a day and all of a sudden you

5817
06:05:55,440 --> 06:05:57,420
see a spike of 175

5818
06:05:57,420 --> 06:05:59,700
what happened why is that like that that

5819
06:05:59,700 --> 06:06:01,620
might be a good indicator that data just

5820
06:06:01,620 --> 06:06:03,780
left your network so Baseline your

5821
06:06:03,780 --> 06:06:05,160
firewall as you kind of go through those

5822
06:06:05,160 --> 06:06:07,138
things and then easy wins here right

5823
06:06:07,138 --> 06:06:09,360
foreign IP addresses abnormal Port

5824
06:06:09,360 --> 06:06:11,100
connections why is the bad guy

5825
06:06:11,100 --> 06:06:13,378
connecting on Port 1337 I don't think

5826
06:06:13,378 --> 06:06:14,638
that's probably going to be expected to

5827
06:06:14,638 --> 06:06:16,558
run inside your environment or if you're

5828
06:06:16,558 --> 06:06:20,280
an old school gamer Port 666 Doom right

5829
06:06:20,280 --> 06:06:22,440
Old School Doom servers why is that

5830
06:06:22,440 --> 06:06:24,480
running out there and then full disk

5831
06:06:24,480 --> 06:06:26,580
analysis I say full disk analysis but

5832
06:06:26,580 --> 06:06:28,200
we're not going through and analyzing

5833
06:06:28,200 --> 06:06:30,180
the full disk I'm pulling out those key

5834
06:06:30,180 --> 06:06:32,218
artifacts I'm using Zimmerman tools or

5835
06:06:32,218 --> 06:06:34,138
something similar to that red Ripper or

5836
06:06:34,138 --> 06:06:36,000
whatever it happens to be to pull out

5837
06:06:36,000 --> 06:06:38,340
the stuff I care about again targeted

5838
06:06:38,340 --> 06:06:40,500
narrow focus of the stuff that matters

5839
06:06:40,500 --> 06:06:42,540
for an investigation

5840
06:06:42,540 --> 06:06:44,520
kind of diving a little bit deeper into

5841
06:06:44,520 --> 06:06:46,558
this talking about the Hunts plan

5842
06:06:46,558 --> 06:06:49,020
this is how we break it out I've got the

5843
06:06:49,020 --> 06:06:50,520
little arrows the little flow charts for

5844
06:06:50,520 --> 06:06:52,500
you to look at but again I'm starting

5845
06:06:52,500 --> 06:06:54,360
with the critical stuff that I care

5846
06:06:54,360 --> 06:06:56,520
about pretty much every case that we

5847
06:06:56,520 --> 06:06:58,680
work at unit 42 and things bad guys can

5848
06:06:58,680 --> 06:07:00,480
end up on a domain controller so that's

5849
06:07:00,480 --> 06:07:02,040
a fantastic way to start your

5850
06:07:02,040 --> 06:07:03,840
investigation start at the domain

5851
06:07:03,840 --> 06:07:05,520
controller look for that persistence

5852
06:07:05,520 --> 06:07:07,200
look for that access and then work your

5853
06:07:07,200 --> 06:07:09,540
way backwards don't start randomly

5854
06:07:09,540 --> 06:07:12,298
analyzing Joe's laptop and hoping that

5855
06:07:12,298 --> 06:07:13,680
the bad guy happened to be on there be

5856
06:07:13,680 --> 06:07:15,120
targeted be focused with what you're

5857
06:07:15,120 --> 06:07:16,200
trying to do

5858
06:07:16,200 --> 06:07:18,360
same with your file servers if you have

5859
06:07:18,360 --> 06:07:19,558
critical data you've got the crown

5860
06:07:19,558 --> 06:07:21,180
jewels you've got the KFC secret recipe

5861
06:07:21,180 --> 06:07:22,920
sitting out there start with that data

5862
06:07:22,920 --> 06:07:24,900
set too bad guys are probably the after

5863
06:07:24,900 --> 06:07:27,180
that stuff your remote access servers

5864
06:07:27,180 --> 06:07:28,680
those are another great thing to look at

5865
06:07:28,680 --> 06:07:30,780
for as you kind of go through and look

5866
06:07:30,780 --> 06:07:33,320
for those things

5867
06:07:34,440 --> 06:07:36,660
so finding xfill

5868
06:07:36,660 --> 06:07:38,878
our screen is kind of small

5869
06:07:38,878 --> 06:07:40,740
so this slide might be a little bit hard

5870
06:07:40,740 --> 06:07:41,878
to read but I'll kind of talk through

5871
06:07:41,878 --> 06:07:43,920
this a little bit for you too but host

5872
06:07:43,920 --> 06:07:46,320
based X fill this is one of our work

5873
06:07:46,320 --> 06:07:48,718
stream leads that we work streams that

5874
06:07:48,718 --> 06:07:50,400
we talk about that we assign a lead to

5875
06:07:50,400 --> 06:07:54,120
and xfill is fun Expo is great to

5876
06:07:54,120 --> 06:07:56,638
discover it's great to find oftentimes

5877
06:07:56,638 --> 06:07:57,480
when we're dealing with like a

5878
06:07:57,480 --> 06:08:00,000
ransomware case or things like that bad

5879
06:08:00,000 --> 06:08:01,680
guys are pretty noisy and they leave

5880
06:08:01,680 --> 06:08:04,798
behind a lot of artifacts this is not an

5881
06:08:04,798 --> 06:08:06,660
all-encompassing list of every single

5882
06:08:06,660 --> 06:08:08,280
file artifact that can be found on

5883
06:08:08,280 --> 06:08:10,620
Windows these are the ones that I can

5884
06:08:10,620 --> 06:08:13,680
look at move through really quickly to

5885
06:08:13,680 --> 06:08:15,718
get those quick answers those quick wins

5886
06:08:15,718 --> 06:08:17,940
this is not a full disk analysis it's

5887
06:08:17,940 --> 06:08:20,458
not a full forensic analysis this is an

5888
06:08:20,458 --> 06:08:22,260
instant response triage

5889
06:08:22,260 --> 06:08:24,660
looking for those quick wins looking for

5890
06:08:24,660 --> 06:08:26,160
those quick answers that I can give to

5891
06:08:26,160 --> 06:08:28,378
the client that can go to the council

5892
06:08:28,378 --> 06:08:31,680
so browser history you'd be surprised at

5893
06:08:31,680 --> 06:08:33,958
how many times bad guys go to like send

5894
06:08:33,958 --> 06:08:36,840
space or files.io or drop me files and

5895
06:08:36,840 --> 06:08:38,638
they're just uploading data out through

5896
06:08:38,638 --> 06:08:41,040
the browser happens a lot talk about

5897
06:08:41,040 --> 06:08:43,020
that a lot in a little bit process

5898
06:08:43,020 --> 06:08:45,360
execution seven zip utilities bad guys

5899
06:08:45,360 --> 06:08:47,760
usually they'll have a box that we call

5900
06:08:47,760 --> 06:08:50,340
staging server and they'll acquire data

5901
06:08:50,340 --> 06:08:51,900
from like your file shares whatever and

5902
06:08:51,900 --> 06:08:53,400
drop it on the staging box and then

5903
06:08:53,400 --> 06:08:56,580
compress it somehow so WinZip 7-Zip FTP

5904
06:08:56,580 --> 06:08:58,260
utilities things like that great things

5905
06:08:58,260 --> 06:08:59,940
to hunt for great things to look at

5906
06:08:59,940 --> 06:09:02,218
really quickly same with your jump list

5907
06:09:02,218 --> 06:09:03,958
your recent docs some of these artifacts

5908
06:09:03,958 --> 06:09:05,280
are probably really familiar to you as

5909
06:09:05,280 --> 06:09:07,920
well but another fun one that I don't

5910
06:09:07,920 --> 06:09:10,020
think we check often enough especially

5911
06:09:10,020 --> 06:09:11,700
if we're looking for new access to

5912
06:09:11,700 --> 06:09:13,680
shares is that network access share the

5913
06:09:13,680 --> 06:09:16,200
event ID 5140 that usually pops up when

5914
06:09:16,200 --> 06:09:17,820
a new access is created to a shared that

5915
06:09:17,820 --> 06:09:18,780
somebody hasn't really created or

5916
06:09:18,780 --> 06:09:20,638
connected to before so really quick

5917
06:09:20,638 --> 06:09:22,020
weight if you're using Velociraptor or

5918
06:09:22,020 --> 06:09:23,520
something like that kick that in there

5919
06:09:23,520 --> 06:09:25,260
as event ID maybe that make that as an

5920
06:09:25,260 --> 06:09:27,240
indicator something weird's happening

5921
06:09:27,240 --> 06:09:29,480
same with your user assist the scrum

5922
06:09:29,480 --> 06:09:31,860
scrum is really fun too because that's

5923
06:09:31,860 --> 06:09:33,298
going to show you sometimes your inbound

5924
06:09:33,298 --> 06:09:35,760
outbound bytes sent and out of the

5925
06:09:35,760 --> 06:09:37,440
network I think a lot of folks don't

5926
06:09:37,440 --> 06:09:39,298
look at that one that's a really cool

5927
06:09:39,298 --> 06:09:41,638
one to look at Windows registry typed

5928
06:09:41,638 --> 06:09:43,378
paths are huge I'll show you an example

5929
06:09:43,378 --> 06:09:46,020
of that in a minute again Windows

5930
06:09:46,020 --> 06:09:47,160
registry is also going to show your

5931
06:09:47,160 --> 06:09:49,740
process execution stuff like that

5932
06:09:49,740 --> 06:09:51,840
so Expo statistics this actually comes

5933
06:09:51,840 --> 06:09:54,480
from the unit 42 data on average we work

5934
06:09:54,480 --> 06:09:57,120
about 1500 cases a year so we're pretty

5935
06:09:57,120 --> 06:09:59,400
busy over the last about three and a

5936
06:09:59,400 --> 06:10:00,600
half years we've probably worked over

5937
06:10:00,600 --> 06:10:03,480
1200 ransomware specific cases so

5938
06:10:03,480 --> 06:10:04,500
everything from the full blown

5939
06:10:04,500 --> 06:10:06,360
investigations and negotiations with bad

5940
06:10:06,360 --> 06:10:08,458
guys stuff like that and this is

5941
06:10:08,458 --> 06:10:09,958
actually some of our Excel statistics

5942
06:10:09,958 --> 06:10:11,878
coming right from our data sets for what

5943
06:10:11,878 --> 06:10:13,798
we're seeing and this stuff will be in a

5944
06:10:13,798 --> 06:10:15,840
report coming up I think in March April

5945
06:10:15,840 --> 06:10:18,000
time frame too but the bad guys are

5946
06:10:18,000 --> 06:10:19,920
pretty typical they're pretty static

5947
06:10:19,920 --> 06:10:22,440
with what they do Services Mega right P

5948
06:10:22,440 --> 06:10:24,240
Cloud drop me files I mentioned those

5949
06:10:24,240 --> 06:10:25,980
OneDrive Google Drive

5950
06:10:25,980 --> 06:10:29,100
tools bad guys love our clone I'll show

5951
06:10:29,100 --> 06:10:30,840
you an example of that in a second but

5952
06:10:30,840 --> 06:10:32,878
our clone is huge our clones all the

5953
06:10:32,878 --> 06:10:36,058
time when SCP filezilla cloud services

5954
06:10:36,058 --> 06:10:38,520
tool magazine pcloud amp things like

5955
06:10:38,520 --> 06:10:40,320
that but the bad guys are using these

5956
06:10:40,320 --> 06:10:41,940
tools and this is consistent pretty much

5957
06:10:41,940 --> 06:10:43,740
across every case that we work that has

5958
06:10:43,740 --> 06:10:45,360
exfiltration this is how they're doing

5959
06:10:45,360 --> 06:10:46,740
it

5960
06:10:46,740 --> 06:10:49,740
so our clone quick fact if you have a

5961
06:10:49,740 --> 06:10:51,780
case and you have data exfiltration look

5962
06:10:51,780 --> 06:10:55,798
for this arclone.com file inside that is

5963
06:10:55,798 --> 06:10:57,058
most likely going to be the bad guys

5964
06:10:57,058 --> 06:10:58,980
exfiltration IP address where they expel

5965
06:10:58,980 --> 06:11:00,480
the data it's gonna be the bad guy's

5966
06:11:00,480 --> 06:11:03,240
username bad guy's password

5967
06:11:03,240 --> 06:11:05,340
so if you have that data

5968
06:11:05,340 --> 06:11:08,100
in theory you could connect to that

5969
06:11:08,100 --> 06:11:10,260
server now that's a gray area a little

5970
06:11:10,260 --> 06:11:11,638
bit according to law because you don't

5971
06:11:11,638 --> 06:11:13,860
have explicit access to say you can

5972
06:11:13,860 --> 06:11:15,000
connect to it so maybe use your

5973
06:11:15,000 --> 06:11:17,160
neighbor's Wi-Fi when you connect to

5974
06:11:17,160 --> 06:11:18,958
that one or whatever it happens to be

5975
06:11:18,958 --> 06:11:21,120
but yeah check for those arcloan.com

5976
06:11:21,120 --> 06:11:22,860
files you see them left behind all the

5977
06:11:22,860 --> 06:11:24,660
time bad guys are lazy and they leave

5978
06:11:24,660 --> 06:11:27,240
them there for us

5979
06:11:27,240 --> 06:11:28,320
so let's talk a little bit about

5980
06:11:28,320 --> 06:11:30,360
persistence here how the bad guys

5981
06:11:30,360 --> 06:11:32,700
maintain their access and ways we can

5982
06:11:32,700 --> 06:11:35,700
kind of find that really quickly so the

5983
06:11:35,700 --> 06:11:37,980
are they still here we're extreme this

5984
06:11:37,980 --> 06:11:40,020
is one of the ones that I usually run

5985
06:11:40,020 --> 06:11:41,520
myself when I'm working on cases because

5986
06:11:41,520 --> 06:11:43,500
I think this is the most fun one and

5987
06:11:43,500 --> 06:11:44,400
this is the one that's going to get us

5988
06:11:44,400 --> 06:11:46,440
the fastest answers on a case a lot of

5989
06:11:46,440 --> 06:11:48,360
times especially when we're looking at

5990
06:11:48,360 --> 06:11:50,458
process execution right your sim cash

5991
06:11:50,458 --> 06:11:53,160
amcash recent apps prefetch users user

5992
06:11:53,160 --> 06:11:54,900
assist things like that

5993
06:11:54,900 --> 06:11:57,180
when you know what bad stuff looks like

5994
06:11:57,180 --> 06:11:59,100
when you've been looking at a system so

5995
06:11:59,100 --> 06:12:01,260
many times bad stuff really stands out

5996
06:12:01,260 --> 06:12:04,558
right why is there stuff running from C

5997
06:12:04,558 --> 06:12:06,958
perflog see program data app data local

5998
06:12:06,958 --> 06:12:08,638
temp whatever it happens to be for those

5999
06:12:08,638 --> 06:12:10,440
directories so you're able to look at

6000
06:12:10,440 --> 06:12:12,600
those executions and be like that's bad

6001
06:12:12,600 --> 06:12:14,638
you see like single name executables

6002
06:12:14,638 --> 06:12:18,058
one.exe m.bat 2.exe whatever it happens

6003
06:12:18,058 --> 06:12:20,218
to be or if it's a really lazy threat

6004
06:12:20,218 --> 06:12:21,900
actor you might see mimikas.exe or

6005
06:12:21,900 --> 06:12:23,700
lasagna.exe whatever it happens to be

6006
06:12:23,700 --> 06:12:25,680
but you'll see that stuff happening in

6007
06:12:25,680 --> 06:12:28,558
there run Keys your registry your auto

6008
06:12:28,558 --> 06:12:30,840
runs startup folders looking for those

6009
06:12:30,840 --> 06:12:34,500
uh abnormal entries trickbot emotec iced

6010
06:12:34,500 --> 06:12:37,260
ID those are pretty easy to spot once

6011
06:12:37,260 --> 06:12:38,940
you've looked at them once there is a

6012
06:12:38,940 --> 06:12:40,440
lot of static artifacts a lot of like

6013
06:12:40,440 --> 06:12:43,260
things that are in there you'll see like

6014
06:12:43,260 --> 06:12:45,718
a legitimate exe with some of the random

6015
06:12:45,718 --> 06:12:47,040
dll in there be like okay what's

6016
06:12:47,040 --> 06:12:48,540
happening that doesn't make sense that

6017
06:12:48,540 --> 06:12:49,860
shouldn't belong there it's running out

6018
06:12:49,860 --> 06:12:51,240
of the wrong directory it's running out

6019
06:12:51,240 --> 06:12:52,920
of the wrong place

6020
06:12:52,920 --> 06:12:54,780
same with your scheduled task win logon

6021
06:12:54,780 --> 06:12:57,660
Registries what I'm doing this when I'm

6022
06:12:57,660 --> 06:12:59,218
looking for persistence

6023
06:12:59,218 --> 06:13:01,440
I've done this persistent search for

6024
06:13:01,440 --> 06:13:03,120
5000 hosts before and it took me about

6025
06:13:03,120 --> 06:13:04,138
an hour

6026
06:13:04,138 --> 06:13:07,138
it goes really really fast when you know

6027
06:13:07,138 --> 06:13:08,280
what you're looking for because I don't

6028
06:13:08,280 --> 06:13:09,780
care about the other stuff on the system

6029
06:13:09,780 --> 06:13:12,000
I only care about solving this one

6030
06:13:12,000 --> 06:13:15,840
question so this idea of doing sniper's

6031
06:13:15,840 --> 06:13:17,458
response it doesn't really matter how

6032
06:13:17,458 --> 06:13:20,040
big your data set gets it's really quick

6033
06:13:20,040 --> 06:13:22,378
and the other nice thing about this is

6034
06:13:22,378 --> 06:13:24,120
we're actually I'll talk about this in a

6035
06:13:24,120 --> 06:13:25,138
minute too but we're actually kind of

6036
06:13:25,138 --> 06:13:27,360
cue seeing ourselves as we go because

6037
06:13:27,360 --> 06:13:29,100
we're rerunning searches we're running

6038
06:13:29,100 --> 06:13:30,540
queries things like that through the

6039
06:13:30,540 --> 06:13:33,840
edrs whatever happened to have in place

6040
06:13:33,840 --> 06:13:35,878
some persistent mechanisms this again

6041
06:13:35,878 --> 06:13:37,920
comes from the unit 42 data sets things

6042
06:13:37,920 --> 06:13:38,878
like that

6043
06:13:38,878 --> 06:13:42,120
scheduled tasks job schedule tasks

6044
06:13:42,120 --> 06:13:43,980
um really common things we've got these

6045
06:13:43,980 --> 06:13:46,138
Maps miter if you want to take the time

6046
06:13:46,138 --> 06:13:48,420
to look those up on your own to creating

6047
06:13:48,420 --> 06:13:50,700
accounts we see that a lot a lot of

6048
06:13:50,700 --> 06:13:51,900
times the bad guys are a little bit

6049
06:13:51,900 --> 06:13:53,458
creative they might name like

6050
06:13:53,458 --> 06:13:57,600
domain name Dash help desk or Drew's

6051
06:13:57,600 --> 06:14:00,420
Bike Shop Dash it support whatever it

6052
06:14:00,420 --> 06:14:02,218
happens to be bad guys are really

6053
06:14:02,218 --> 06:14:03,240
creative with that stuff and they'll

6054
06:14:03,240 --> 06:14:04,320
create those accounts make them look

6055
06:14:04,320 --> 06:14:07,080
legitimate same with like the privileged

6056
06:14:07,080 --> 06:14:08,878
account adding like a normal user

6057
06:14:08,878 --> 06:14:10,138
getting added to a privileged account

6058
06:14:10,138 --> 06:14:12,360
like administrators things like that we

6059
06:14:12,360 --> 06:14:13,860
set quite often

6060
06:14:13,860 --> 06:14:16,620
along with those run keys and things and

6061
06:14:16,620 --> 06:14:18,480
then also web shelves

6062
06:14:18,480 --> 06:14:20,340
web shells are so common especially with

6063
06:14:20,340 --> 06:14:22,138
all the on-prem exchange stuff that

6064
06:14:22,138 --> 06:14:24,840
happened this past 12 months or so proxy

6065
06:14:24,840 --> 06:14:27,000
cell approx not shell half-n all that

6066
06:14:27,000 --> 06:14:29,580
fun stuff we saw China Chopper so much

6067
06:14:29,580 --> 06:14:31,860
those bad guys are dropping web shells

6068
06:14:31,860 --> 06:14:33,798
on there using that to maintain access

6069
06:14:33,798 --> 06:14:37,200
if you're doing a e-commerce breach a

6070
06:14:37,200 --> 06:14:38,878
web compromise or things like that I

6071
06:14:38,878 --> 06:14:40,200
guarantee you there's more than one web

6072
06:14:40,200 --> 06:14:41,878
show on the host so if you're doing

6073
06:14:41,878 --> 06:14:44,100
those investigations look carefully

6074
06:14:44,100 --> 06:14:45,058
because they're going to be more than

6075
06:14:45,058 --> 06:14:46,620
one my record

6076
06:14:46,620 --> 06:14:49,680
is 62 web shells found on one domain and

6077
06:14:49,680 --> 06:14:51,420
that is just a bajillion and I have to

6078
06:14:51,420 --> 06:14:53,580
admit that was my own my own website

6079
06:14:53,580 --> 06:14:56,700
that I hosted that got compromised

6080
06:14:56,700 --> 06:14:59,760
but uh that happened 62 web shells out

6081
06:14:59,760 --> 06:15:01,680
there and again modifying system

6082
06:15:01,680 --> 06:15:04,020
processes Windows Services things like

6083
06:15:04,020 --> 06:15:05,100
that

6084
06:15:05,100 --> 06:15:07,200
so command and control pieces post

6085
06:15:07,200 --> 06:15:09,058
exploitation tools Cobalt strike we've

6086
06:15:09,058 --> 06:15:10,558
talked about metasploy

6087
06:15:10,558 --> 06:15:11,878
if you talked to me like eight years ago

6088
06:15:11,878 --> 06:15:13,620
medicine was like the thing it was like

6089
06:15:13,620 --> 06:15:15,360
big popular everybody's using Metasploit

6090
06:15:15,360 --> 06:15:19,200
medicine died out quite a bit uh so uh

6091
06:15:19,200 --> 06:15:20,580
sliver out there I saw Bishop Fox

6092
06:15:20,580 --> 06:15:22,020
outside

6093
06:15:22,020 --> 06:15:23,700
um we've seen sliver on quite a few

6094
06:15:23,700 --> 06:15:25,980
cases it started appearing for us about

6095
06:15:25,980 --> 06:15:28,680
August of last year 2022. we're starting

6096
06:15:28,680 --> 06:15:31,080
to see that run across cases bad guys

6097
06:15:31,080 --> 06:15:32,878
are definitely pivoting to it we've seen

6098
06:15:32,878 --> 06:15:34,440
some ransomware operators doing it we've

6099
06:15:34,440 --> 06:15:36,240
seen some apt people using it so

6100
06:15:36,240 --> 06:15:38,100
something to be on the lookout for

6101
06:15:38,100 --> 06:15:40,340
the way that we've detected it is

6102
06:15:40,340 --> 06:15:42,480
sometimes we've gotten lucky because we

6103
06:15:42,480 --> 06:15:44,218
actually caught the down low cradle the

6104
06:15:44,218 --> 06:15:45,900
Powershell command because the bat the

6105
06:15:45,900 --> 06:15:47,940
user the endpoints had command line

6106
06:15:47,940 --> 06:15:49,020
auditing on there so you're able to see

6107
06:15:49,020 --> 06:15:51,120
them downloading it directly the first

6108
06:15:51,120 --> 06:15:52,558
time I saw it I'm like what in the world

6109
06:15:52,558 --> 06:15:53,638
is this thing I've never heard of it

6110
06:15:53,638 --> 06:15:55,200
before and actually hopped on Google I'm

6111
06:15:55,200 --> 06:15:56,100
like oh

6112
06:15:56,100 --> 06:15:58,200
it's a new command and control thing

6113
06:15:58,200 --> 06:16:01,320
Bert rattel is like the the thing that's

6114
06:16:01,320 --> 06:16:03,360
in media people talk about it even if we

6115
06:16:03,360 --> 06:16:06,360
do how to blog about it and honestly

6116
06:16:06,360 --> 06:16:08,340
we've only seen not a handful of cases

6117
06:16:08,340 --> 06:16:11,760
cases I've seen it on the attackers that

6118
06:16:11,760 --> 06:16:14,940
were using it were apt very skilled very

6119
06:16:14,940 --> 06:16:16,458
technical

6120
06:16:16,458 --> 06:16:19,500
very uh very targeted what they're

6121
06:16:19,500 --> 06:16:21,780
trying to do one of the ones that was

6122
06:16:21,780 --> 06:16:23,400
probably the most popular

6123
06:16:23,400 --> 06:16:25,080
it part of this is Publix you could

6124
06:16:25,080 --> 06:16:26,400
probably Google and fill in the blanks

6125
06:16:26,400 --> 06:16:29,700
but was a a large

6126
06:16:29,700 --> 06:16:31,680
I don't know City municipality on the

6127
06:16:31,680 --> 06:16:33,180
East Coast that we supported we worked

6128
06:16:33,180 --> 06:16:34,680
an investigation for

6129
06:16:34,680 --> 06:16:35,940
and

6130
06:16:35,940 --> 06:16:37,558
it was a ransomer case and things like

6131
06:16:37,558 --> 06:16:38,700
that and that's kind of the first place

6132
06:16:38,700 --> 06:16:40,680
where we solve your Patel being used

6133
06:16:40,680 --> 06:16:43,740
but very popular thing

6134
06:16:43,740 --> 06:16:45,480
um administrative tools commonly abused

6135
06:16:45,480 --> 06:16:47,280
by the bad guys any desk connectwise

6136
06:16:47,280 --> 06:16:48,420
screen connect

6137
06:16:48,420 --> 06:16:51,739
those types of things are fun

6138
06:16:52,620 --> 06:16:54,600
one of the things that we've seen quite

6139
06:16:54,600 --> 06:16:57,540
a bit of is the threat actors leveraging

6140
06:16:57,540 --> 06:16:58,980
these tools

6141
06:16:58,980 --> 06:17:00,718
instead of dropping Cobalt strike

6142
06:17:00,718 --> 06:17:02,820
instead of dropping the other tools

6143
06:17:02,820 --> 06:17:04,020
because they're using these legitimate

6144
06:17:04,020 --> 06:17:06,058
tools to maintain access

6145
06:17:06,058 --> 06:17:07,558
and they're hoping they can kind of fly

6146
06:17:07,558 --> 06:17:09,360
under the radar for your detections

6147
06:17:09,360 --> 06:17:11,160
things like that

6148
06:17:11,160 --> 06:17:13,440
so it's important if you're working in

6149
06:17:13,440 --> 06:17:14,520
your sock

6150
06:17:14,520 --> 06:17:16,440
security team things like that know what

6151
06:17:16,440 --> 06:17:18,958
your expected administrative tools are

6152
06:17:18,958 --> 06:17:20,580
so if you see when these things pop up

6153
06:17:20,580 --> 06:17:22,920
like okay who did that why is it

6154
06:17:22,920 --> 06:17:26,160
happening to an investigation there

6155
06:17:26,160 --> 06:17:29,218
so hours 36 through 52

6156
06:17:29,218 --> 06:17:30,660
by this time

6157
06:17:30,660 --> 06:17:31,980
you should have regular updates with

6158
06:17:31,980 --> 06:17:33,240
your council with your c-suite you

6159
06:17:33,240 --> 06:17:34,558
probably got a war room going if you're

6160
06:17:34,558 --> 06:17:36,600
working internally uh you should ensure

6161
06:17:36,600 --> 06:17:37,860
that those command control pieces are

6162
06:17:37,860 --> 06:17:38,700
blocked because you've already

6163
06:17:38,700 --> 06:17:39,780
identified those through that

6164
06:17:39,780 --> 06:17:41,400
persistence hunt

6165
06:17:41,400 --> 06:17:43,500
you're going to continue hunting hunting

6166
06:17:43,500 --> 06:17:45,298
doesn't stop just because you've solved

6167
06:17:45,298 --> 06:17:47,100
some of the things that first three days

6168
06:17:47,100 --> 06:17:49,500
of this case of this work as new hosts

6169
06:17:49,500 --> 06:17:50,878
are coming online we're still hunting

6170
06:17:50,878 --> 06:17:52,980
through that new data sets

6171
06:17:52,980 --> 06:17:54,958
you can identify all the systems with

6172
06:17:54,958 --> 06:17:56,580
the interactive access by the threat

6173
06:17:56,580 --> 06:17:58,200
actor

6174
06:17:58,200 --> 06:17:59,878
so where'd they go

6175
06:17:59,878 --> 06:18:01,798
this is where we use the questions from

6176
06:18:01,798 --> 06:18:03,120
are they still here right because we've

6177
06:18:03,120 --> 06:18:05,458
solved a lot of stuff we hunted for iocs

6178
06:18:05,458 --> 06:18:07,020
we've identified those additional

6179
06:18:07,020 --> 06:18:09,000
compromise hosts we've identified

6180
06:18:09,000 --> 06:18:10,440
already hey

6181
06:18:10,440 --> 06:18:12,120
we're up to 50 compromise those because

6182
06:18:12,120 --> 06:18:15,240
we found malware on 50 boxes

6183
06:18:15,240 --> 06:18:16,440
so we're going to kind of continue that

6184
06:18:16,440 --> 06:18:17,820
we've identified the compromised

6185
06:18:17,820 --> 06:18:19,260
accounts because those malware does this

6186
06:18:19,260 --> 06:18:21,180
magically appear had it been dropped

6187
06:18:21,180 --> 06:18:23,160
there by an account SMB or RDP whatever

6188
06:18:23,160 --> 06:18:24,480
happens to be

6189
06:18:24,480 --> 06:18:25,860
and we're going to kind of sweet for

6190
06:18:25,860 --> 06:18:27,360
those

6191
06:18:27,360 --> 06:18:29,160
the nice thing

6192
06:18:29,160 --> 06:18:32,160
about Windows is it tracks lateral

6193
06:18:32,160 --> 06:18:34,500
movement pretty well your event logs are

6194
06:18:34,500 --> 06:18:35,520
going to be key for these there's an

6195
06:18:35,520 --> 06:18:36,780
example of that code that you can have

6196
06:18:36,780 --> 06:18:38,340
through really quickly

6197
06:18:38,340 --> 06:18:40,798
looking for those Network shares looking

6198
06:18:40,798 --> 06:18:42,718
for that registry data things like that

6199
06:18:42,718 --> 06:18:45,798
as you kind of Move Along

6200
06:18:45,958 --> 06:18:47,458
um one of the things that we see a lot

6201
06:18:47,458 --> 06:18:49,620
too is still like the RDP tunnels so

6202
06:18:49,620 --> 06:18:51,660
you're looking for a logon type tens and

6203
06:18:51,660 --> 06:18:53,100
you're looking to security event log and

6204
06:18:53,100 --> 06:18:56,400
it's got 127001 as the source ip'd like

6205
06:18:56,400 --> 06:18:58,980
that doesn't work most likely bad guys

6206
06:18:58,980 --> 06:19:00,660
got an RDP tunnel from their system

6207
06:19:00,660 --> 06:19:02,580
coming in through that box there's a

6208
06:19:02,580 --> 06:19:03,780
chance that might have been patient zero

6209
06:19:03,780 --> 06:19:04,740
two because that's their commanded

6210
06:19:04,740 --> 06:19:06,600
control C uh box that they're kind of

6211
06:19:06,600 --> 06:19:08,900
moving in through the environment

6212
06:19:08,900 --> 06:19:11,580
so some quick tips for examining event

6213
06:19:11,580 --> 06:19:14,580
logs Zimmerman stuff log parts or

6214
06:19:14,580 --> 06:19:16,440
nearsoft power cell Velociraptor is

6215
06:19:16,440 --> 06:19:17,760
great at this

6216
06:19:17,760 --> 06:19:19,860
but what the challenge that we have is

6217
06:19:19,860 --> 06:19:21,480
if you don't have an EDR you don't have

6218
06:19:21,480 --> 06:19:23,240
an xdr you don't have a two out in place

6219
06:19:23,240 --> 06:19:25,378
hopefully you've got log forwarding

6220
06:19:25,378 --> 06:19:26,760
going on hopefully you've got something

6221
06:19:26,760 --> 06:19:28,138
where you're collecting all your logs in

6222
06:19:28,138 --> 06:19:29,820
the central Repository

6223
06:19:29,820 --> 06:19:31,558
but you need to get those into a tool to

6224
06:19:31,558 --> 06:19:33,540
look at them one of the newest tools

6225
06:19:33,540 --> 06:19:34,740
that's out there that's actually worked

6226
06:19:34,740 --> 06:19:36,180
really well we've used this in the past

6227
06:19:36,180 --> 06:19:39,000
too is chainsaw so I it's not chainsaw

6228
06:19:39,000 --> 06:19:40,680
talk but check it out there's the GitHub

6229
06:19:40,680 --> 06:19:42,480
link there go Google it go look it up it

6230
06:19:42,480 --> 06:19:43,680
works really well you can take all your

6231
06:19:43,680 --> 06:19:45,900
mat logs you can run yard rules you know

6232
06:19:45,900 --> 06:19:47,160
Sigma stuff you can like pull out those

6233
06:19:47,160 --> 06:19:49,200
key artifacts and get those quick wins

6234
06:19:49,200 --> 06:19:52,558
you can use log parser 2.2

6235
06:19:52,558 --> 06:19:55,378
I think four years ago at cactuscon

6236
06:19:55,378 --> 06:19:57,240
um Mary degrazia was speaking here and

6237
06:19:57,240 --> 06:19:58,920
she was talking about log parser and

6238
06:19:58,920 --> 06:20:00,240
like the way she was using it things

6239
06:20:00,240 --> 06:20:02,458
like that so check out that old talk the

6240
06:20:02,458 --> 06:20:05,400
locker 2.2 lets you kind of query all

6241
06:20:05,400 --> 06:20:07,020
the event logs and queries or specific

6242
06:20:07,020 --> 06:20:09,058
event IDs and things like that because

6243
06:20:09,058 --> 06:20:11,280
just loading up an event log in like log

6244
06:20:11,280 --> 06:20:13,138
Explorer or just the windows and that

6245
06:20:13,138 --> 06:20:15,420
log viewer it's a pain what's that data

6246
06:20:15,420 --> 06:20:16,320
set you've got to be able to look

6247
06:20:16,320 --> 06:20:17,878
through that in Mass

6248
06:20:17,878 --> 06:20:20,638
and the very worst way to do this but it

6249
06:20:20,638 --> 06:20:22,378
works is to use powershelles convert it

6250
06:20:22,378 --> 06:20:25,620
to a CSV and then grep across that data

6251
06:20:25,620 --> 06:20:28,558
not the prettiest not fastest but if

6252
06:20:28,558 --> 06:20:29,760
you're in a crunch and that's all you

6253
06:20:29,760 --> 06:20:30,480
have

6254
06:20:30,480 --> 06:20:33,920
you can do it like that as well

6255
06:20:36,540 --> 06:20:37,798
first things we've seen with our case

6256
06:20:37,798 --> 06:20:39,900
data from the bad guys and stuff like

6257
06:20:39,900 --> 06:20:42,138
that

6258
06:20:44,520 --> 06:20:46,500
talking about Discovery right

6259
06:20:46,500 --> 06:20:48,780
bad guys get into an environment and

6260
06:20:48,780 --> 06:20:50,520
they want to know what's there they want

6261
06:20:50,520 --> 06:20:51,840
to know what's around

6262
06:20:51,840 --> 06:20:53,580
Advanced ip scanner Advanced Sports

6263
06:20:53,580 --> 06:20:57,000
scanner we see this all the time 80 find

6264
06:20:57,000 --> 06:20:59,160
really often too

6265
06:20:59,160 --> 06:21:00,540
so bad guys are doing that

6266
06:21:00,540 --> 06:21:01,860
reconnaissance just like anybody else

6267
06:21:01,860 --> 06:21:03,540
they're hopping in there

6268
06:21:03,540 --> 06:21:05,940
they're looking around so looking for

6269
06:21:05,940 --> 06:21:07,920
those key artifacts again you're

6270
06:21:07,920 --> 06:21:09,900
speeding up your investigation

6271
06:21:09,900 --> 06:21:12,298
who am I command I think it was Marcus's

6272
06:21:12,298 --> 06:21:13,558
talk earlier today was talking about

6273
06:21:13,558 --> 06:21:15,240
that one hard to call correctly

6274
06:21:15,240 --> 06:21:17,638
bad guys use this all the time it's so

6275
06:21:17,638 --> 06:21:18,900
silly that they still type this in

6276
06:21:18,900 --> 06:21:20,160
because that's every stock in the world

6277
06:21:20,160 --> 06:21:22,320
has a detection for this but they do it

6278
06:21:22,320 --> 06:21:24,780
they type that stuff in there

6279
06:21:24,780 --> 06:21:26,638
so credential access this is what

6280
06:21:26,638 --> 06:21:27,900
they're using this is what we see

6281
06:21:27,900 --> 06:21:30,298
mimikats lasagna we see that all the

6282
06:21:30,298 --> 06:21:33,058
time impact it proc dump we see quite a

6283
06:21:33,058 --> 06:21:35,160
bit as well

6284
06:21:35,160 --> 06:21:36,540
um and then leveraging the post

6285
06:21:36,540 --> 06:21:38,280
exploitation kits cobot strike whatever

6286
06:21:38,280 --> 06:21:40,860
one of the things that we just saw

6287
06:21:40,860 --> 06:21:42,600
really recently like within the last

6288
06:21:42,600 --> 06:21:44,580
week uh there's an apt group called

6289
06:21:44,580 --> 06:21:46,020
scattered spider you can go Google that

6290
06:21:46,020 --> 06:21:47,520
there's some stuff out there

6291
06:21:47,520 --> 06:21:50,700
but they're using magnets Ram capture

6292
06:21:50,700 --> 06:21:53,760
and dropping that onto a host grabbing

6293
06:21:53,760 --> 06:21:55,200
the RAM and then it's doing strings on

6294
06:21:55,200 --> 06:21:56,160
it and pulling out the clear Tech

6295
06:21:56,160 --> 06:21:57,540
credentials I thought it was really

6296
06:21:57,540 --> 06:21:59,458
creative because some of the edrs don't

6297
06:21:59,458 --> 06:22:00,958
pick that up they don't look at as movie

6298
06:22:00,958 --> 06:22:03,000
Castle lasagna like oh

6299
06:22:03,000 --> 06:22:04,860
creative that was fun from the bad guy's

6300
06:22:04,860 --> 06:22:06,180
perspective

6301
06:22:06,180 --> 06:22:07,980
stuff like that we're seeing still right

6302
06:22:07,980 --> 06:22:09,660
now

6303
06:22:09,660 --> 06:22:11,878
kind of getting closer to the hours 52

6304
06:22:11,878 --> 06:22:14,400
through 72. you've got a lot of your

6305
06:22:14,400 --> 06:22:16,320
stuff answered you've got a lot of your

6306
06:22:16,320 --> 06:22:19,040
questions solved this is really about

6307
06:22:19,040 --> 06:22:21,420
tracing that lateral movement backwards

6308
06:22:21,420 --> 06:22:23,638
trying to work backwards trying to find

6309
06:22:23,638 --> 06:22:25,860
patients zero if you've looked at this

6310
06:22:25,860 --> 06:22:29,520
and you've said hey they got in through

6311
06:22:29,520 --> 06:22:31,620
proxy shell they don't have any patched

6312
06:22:31,620 --> 06:22:32,878
Exchange Server those types of things

6313
06:22:32,878 --> 06:22:34,558
right patch that stuff as soon as you

6314
06:22:34,558 --> 06:22:35,940
can because they get compromised again

6315
06:22:35,940 --> 06:22:37,980
this log forward log for J however you

6316
06:22:37,980 --> 06:22:39,958
want to pronounce that one patch that

6317
06:22:39,958 --> 06:22:42,000
stuff we said we saw so many cases like

6318
06:22:42,000 --> 06:22:43,020
that

6319
06:22:43,020 --> 06:22:45,120
um if data was exfiltrated and you found

6320
06:22:45,120 --> 06:22:47,580
that and you do not have legal counsel

6321
06:22:47,580 --> 06:22:48,740
involved

6322
06:22:48,740 --> 06:22:51,360
absolutely highly recommend bringing in

6323
06:22:51,360 --> 06:22:53,580
breach Council there's a couple reasons

6324
06:22:53,580 --> 06:22:55,080
for that if you bring in breach Council

6325
06:22:55,080 --> 06:22:56,700
now you're going to have a privileged

6326
06:22:56,700 --> 06:22:58,500
investigation with whatever IR firm

6327
06:22:58,500 --> 06:22:59,580
comes in there and you're covered from

6328
06:22:59,580 --> 06:23:01,620
that legal perspective really really

6329
06:23:01,620 --> 06:23:04,138
really recommend bringing them in if

6330
06:23:04,138 --> 06:23:05,580
there's data exploration involved

6331
06:23:05,580 --> 06:23:06,900
because they're going to help you cover

6332
06:23:06,900 --> 06:23:10,200
they're going to help you be more more

6333
06:23:10,200 --> 06:23:12,540
covered as far as like lawsuits and

6334
06:23:12,540 --> 06:23:13,920
whatever happens they can walk you

6335
06:23:13,920 --> 06:23:15,240
through the process for that type of

6336
06:23:15,240 --> 06:23:17,458
stuff

6337
06:23:17,458 --> 06:23:19,558
so finding patient zero

6338
06:23:19,558 --> 06:23:22,798
finding patient zero is really the

6339
06:23:22,798 --> 06:23:24,718
ultimate answer it comes to itself when

6340
06:23:24,718 --> 06:23:26,058
you solve these other three questions

6341
06:23:26,058 --> 06:23:28,320
you've traced that lateral movement

6342
06:23:28,320 --> 06:23:30,000
backwards that first compromised host

6343
06:23:30,000 --> 06:23:32,458
you've identified all that persistence

6344
06:23:32,458 --> 06:23:34,020
all of that malware and you're doing

6345
06:23:34,020 --> 06:23:36,058
your timeline analysis so if your

6346
06:23:36,058 --> 06:23:37,378
timeline analysis you've got your first

6347
06:23:37,378 --> 06:23:39,298
compromised toast at I don't know

6348
06:23:39,298 --> 06:23:41,878
December 6th 12 p.m your next toast that

6349
06:23:41,878 --> 06:23:43,558
was compromised wasn't until the 8th

6350
06:23:43,558 --> 06:23:46,080
most likely that 12-6 host was probably

6351
06:23:46,080 --> 06:23:48,958
patient zero or very close to it again

6352
06:23:48,958 --> 06:23:50,638
you kind of track that back as far as

6353
06:23:50,638 --> 06:23:53,160
you can again patient zero is probably

6354
06:23:53,160 --> 06:23:55,080
the last question that we try and solve

6355
06:23:55,080 --> 06:23:56,340
because it really kind of comes clear

6356
06:23:56,340 --> 06:23:58,860
when we solve those other three big

6357
06:23:58,860 --> 06:24:00,718
questions that counts on those folks

6358
06:24:00,718 --> 06:24:02,958
care about

6359
06:24:03,420 --> 06:24:04,798
oops

6360
06:24:04,798 --> 06:24:07,260
so some key takeaways right

6361
06:24:07,260 --> 06:24:08,878
attackers are looking for those quick

6362
06:24:08,878 --> 06:24:11,100
wins this is off of our this is based

6363
06:24:11,100 --> 06:24:12,718
off of our case data on the cases we've

6364
06:24:12,718 --> 06:24:15,420
worked 70 of the cases that we saw this

6365
06:24:15,420 --> 06:24:17,700
year have that they got 1500 or so or

6366
06:24:17,700 --> 06:24:20,820
fishing or software vulnerability bad

6367
06:24:20,820 --> 06:24:24,058
guys aren't doing stealthy stuff they're

6368
06:24:24,058 --> 06:24:27,360
not really Advanced they're not really

6369
06:24:27,360 --> 06:24:30,240
doing like a lot of like the new stuff

6370
06:24:30,240 --> 06:24:32,160
out there they're taking advantage of

6371
06:24:32,160 --> 06:24:34,020
the no next points they're taking

6372
06:24:34,020 --> 06:24:36,058
advantage of users they're taking

6373
06:24:36,058 --> 06:24:37,740
advantage of

6374
06:24:37,740 --> 06:24:40,320
just that normal stuff that we see we do

6375
06:24:40,320 --> 06:24:42,420
see some Brute Force stuff occasionally

6376
06:24:42,420 --> 06:24:44,520
we do see some of those like initial

6377
06:24:44,520 --> 06:24:46,378
access Brokers right previously

6378
06:24:46,378 --> 06:24:48,058
compromised hosts bad guy goes silent

6379
06:24:48,058 --> 06:24:49,620
for six months sells access in the dark

6380
06:24:49,620 --> 06:24:51,780
web to somebody else for 500 bucks or

6381
06:24:51,780 --> 06:24:53,218
whatever it is

6382
06:24:53,218 --> 06:24:55,680
but most often it's from these very

6383
06:24:55,680 --> 06:24:58,620
Basics very easy ideas of what they're

6384
06:24:58,620 --> 06:24:59,940
doing

6385
06:24:59,940 --> 06:25:02,700
fishing not only email phishing but also

6386
06:25:02,700 --> 06:25:05,040
like MFA exhaustion you probably have

6387
06:25:05,040 --> 06:25:06,480
heard of like the OCTA stuff that

6388
06:25:06,480 --> 06:25:08,760
happened right the octopus stuff we

6389
06:25:08,760 --> 06:25:10,920
worked a lot of those cases and it was

6390
06:25:10,920 --> 06:25:12,480
really fun from the bad guys perspective

6391
06:25:12,480 --> 06:25:13,980
really creative of what they're doing

6392
06:25:13,980 --> 06:25:16,260
but again low Tech didn't cause them

6393
06:25:16,260 --> 06:25:18,000
much they stood up a website they sent

6394
06:25:18,000 --> 06:25:19,980
out some MFA prompts to users they did a

6395
06:25:19,980 --> 06:25:22,020
fish and got in they're not really

6396
06:25:22,020 --> 06:25:23,700
stealthy most of the people that most of

6397
06:25:23,700 --> 06:25:24,540
the bad guys that you're going to

6398
06:25:24,540 --> 06:25:26,100
encounter is your Enterprises at your

6399
06:25:26,100 --> 06:25:28,680
jobs that you're gonna work are not the

6400
06:25:28,680 --> 06:25:30,900
Chinese apt they're not the Iranian apt

6401
06:25:30,900 --> 06:25:33,840
they're the low level easy to track easy

6402
06:25:33,840 --> 06:25:36,920
to identify folks

6403
06:25:36,958 --> 06:25:39,180
so I'm gonna do a really quick thing

6404
06:25:39,180 --> 06:25:40,798
here before I get to the next slide uh

6405
06:25:40,798 --> 06:25:42,000
what about new data this is one of the

6406
06:25:42,000 --> 06:25:43,558
common questions that I get when we talk

6407
06:25:43,558 --> 06:25:46,138
about this idea this methodology again

6408
06:25:46,138 --> 06:25:48,058
it's not a one-time search it's

6409
06:25:48,058 --> 06:25:50,218
reiterative as you get new hosts as you

6410
06:25:50,218 --> 06:25:52,020
get new assets inside the organization

6411
06:25:52,020 --> 06:25:54,298
you're going to rerun these searches and

6412
06:25:54,298 --> 06:25:55,620
like I said before

6413
06:25:55,620 --> 06:25:58,080
re-running these searches doesn't take

6414
06:25:58,080 --> 06:26:00,180
that long it can be done really quickly

6415
06:26:00,180 --> 06:26:02,878
so again maybe an hour

6416
06:26:02,878 --> 06:26:05,340
maybe two if you're not really super

6417
06:26:05,340 --> 06:26:07,740
familiar with a lot of these things

6418
06:26:07,740 --> 06:26:09,840
but it goes really fast

6419
06:26:09,840 --> 06:26:12,360
again focusing on what they take are

6420
06:26:12,360 --> 06:26:13,860
they still here where did they go and

6421
06:26:13,860 --> 06:26:15,600
how they get in those are the big four

6422
06:26:15,600 --> 06:26:16,740
questions that's going to drive an

6423
06:26:16,740 --> 06:26:19,260
investigation and if you are working on

6424
06:26:19,260 --> 06:26:22,260
the proactive side CSO side DC so

6425
06:26:22,260 --> 06:26:23,458
whatever happens to be in your building

6426
06:26:23,458 --> 06:26:25,860
on instant response plans considering

6427
06:26:25,860 --> 06:26:27,480
having this idea for your instant

6428
06:26:27,480 --> 06:26:28,798
response plan too because that's really

6429
06:26:28,798 --> 06:26:30,540
going to help you cover yourselves as an

6430
06:26:30,540 --> 06:26:31,980
organization for what you're trying to

6431
06:26:31,980 --> 06:26:33,240
do

6432
06:26:33,240 --> 06:26:34,980
so I'm going to do a quick sidebar and

6433
06:26:34,980 --> 06:26:36,298
not talk about tech stuff for a second

6434
06:26:36,298 --> 06:26:37,920
because I think this is super important

6435
06:26:37,920 --> 06:26:39,900
and I think this is something that

6436
06:26:39,900 --> 06:26:42,540
really helps us as investigators as

6437
06:26:42,540 --> 06:26:44,940
security responders as kind of being out

6438
06:26:44,940 --> 06:26:46,138
there and part of that has to do with

6439
06:26:46,138 --> 06:26:48,540
your mindset right Carol dweck has a

6440
06:26:48,540 --> 06:26:49,980
great book called mindset that's out

6441
06:26:49,980 --> 06:26:51,600
there on Amazon recommend reading that

6442
06:26:51,600 --> 06:26:53,638
one but it's tough right when we're

6443
06:26:53,638 --> 06:26:54,840
doing instant response when you're

6444
06:26:54,840 --> 06:26:56,100
working in a sock you're going to have

6445
06:26:56,100 --> 06:26:57,900
to work weekends you're going to get a

6446
06:26:57,900 --> 06:26:59,638
call up Friday night at 10 pm you might

6447
06:26:59,638 --> 06:27:01,260
be out at the movies dinner or whatever

6448
06:27:01,260 --> 06:27:03,240
it is it's going to happen you're gonna

6449
06:27:03,240 --> 06:27:04,378
have to work Christmas you're gonna have

6450
06:27:04,378 --> 06:27:05,878
to work Thanksgiving it at some point in

6451
06:27:05,878 --> 06:27:06,920
your career it's going to hit you

6452
06:27:06,920 --> 06:27:09,240
hopefully when you get older and in your

6453
06:27:09,240 --> 06:27:10,440
career for a long time you can push it

6454
06:27:10,440 --> 06:27:11,878
off to the new folks and they have to

6455
06:27:11,878 --> 06:27:12,840
suffer and you don't get to do it

6456
06:27:12,840 --> 06:27:15,000
anymore but it's going to happen so your

6457
06:27:15,000 --> 06:27:16,860
mindset is really really important with

6458
06:27:16,860 --> 06:27:19,020
what we do and what I'd like to tell my

6459
06:27:19,020 --> 06:27:21,180
team I like to tell folks I work with is

6460
06:27:21,180 --> 06:27:23,040
failures it's not a big deal if you mess

6461
06:27:23,040 --> 06:27:24,840
up it's just an opportunity to learn

6462
06:27:24,840 --> 06:27:27,000
opportunity to get better opportunity to

6463
06:27:27,000 --> 06:27:29,040
improve yourself same idea with

6464
06:27:29,040 --> 06:27:31,080
challenges challenges are just an

6465
06:27:31,080 --> 06:27:32,638
opportunity to learn opportunity to be a

6466
06:27:32,638 --> 06:27:34,500
better person better investigator a

6467
06:27:34,500 --> 06:27:36,480
better human as you go through so don't

6468
06:27:36,480 --> 06:27:37,860
shy away from those things when those

6469
06:27:37,860 --> 06:27:39,180
things come up at work those things come

6470
06:27:39,180 --> 06:27:41,040
up in life and you may not be

6471
06:27:41,040 --> 06:27:43,558
comfortable with it go for it yours can

6472
06:27:43,558 --> 06:27:45,240
be better at the end of the day and my

6473
06:27:45,240 --> 06:27:46,620
takeaway for that is be comfortable with

6474
06:27:46,620 --> 06:27:47,760
the uncomfortable

6475
06:27:47,760 --> 06:27:49,378
seems really Common Sense public

6476
06:27:49,378 --> 06:27:51,180
speaking is terrifying for a lot of

6477
06:27:51,180 --> 06:27:53,100
folks when I started I was terrified

6478
06:27:53,100 --> 06:27:54,600
like I get up here my hands are shake

6479
06:27:54,600 --> 06:27:56,700
and all that stuff and the more I did it

6480
06:27:56,700 --> 06:27:58,798
the more comfortable I got with it but

6481
06:27:58,798 --> 06:27:59,878
be comfortable with the uncomfortable

6482
06:27:59,878 --> 06:28:01,080
it's kind of work through that and the

6483
06:28:01,080 --> 06:28:03,298
last thing here is that flexibility when

6484
06:28:03,298 --> 06:28:05,340
you're working an investigation you all

6485
06:28:05,340 --> 06:28:06,958
have the same goal you want to find out

6486
06:28:06,958 --> 06:28:08,340
what happened you want to kick the bad

6487
06:28:08,340 --> 06:28:10,138
guy out you want to solve it there's

6488
06:28:10,138 --> 06:28:11,580
going to be multiple plans to achieve

6489
06:28:11,580 --> 06:28:13,320
the same goal be flexible with how

6490
06:28:13,320 --> 06:28:14,820
you're approaching it don't be so rigid

6491
06:28:14,820 --> 06:28:16,260
that you're going to be like it's my way

6492
06:28:16,260 --> 06:28:18,000
or nothing's gonna work be flexible

6493
06:28:18,000 --> 06:28:19,138
because you're on the same team you're

6494
06:28:19,138 --> 06:28:20,700
all trying to call solve the same

6495
06:28:20,700 --> 06:28:22,020
problem

6496
06:28:22,020 --> 06:28:23,700
planning ahead going back to that

6497
06:28:23,700 --> 06:28:25,558
investigation plan plan ahead for what

6498
06:28:25,558 --> 06:28:26,940
your onsite is going to look like plan

6499
06:28:26,940 --> 06:28:28,138
ahead with how you're going to interact

6500
06:28:28,138 --> 06:28:29,878
with a client plan ahead with those

6501
06:28:29,878 --> 06:28:31,378
proposed questions that you think can be

6502
06:28:31,378 --> 06:28:33,360
faced with and again ask questions

6503
06:28:33,360 --> 06:28:36,058
listen and observe with what council's

6504
06:28:36,058 --> 06:28:37,500
telling you the client's telling you

6505
06:28:37,500 --> 06:28:39,240
what you're seeing on sites be observant

6506
06:28:39,240 --> 06:28:41,700
ask questions listen listening is a huge

6507
06:28:41,700 --> 06:28:43,138
thing because a lot of times the clients

6508
06:28:43,138 --> 06:28:44,700
will say something you might just

6509
06:28:44,700 --> 06:28:45,840
problem a little bit and then they open

6510
06:28:45,840 --> 06:28:47,458
up a lot more for what they're trying to

6511
06:28:47,458 --> 06:28:49,378
tell you

6512
06:28:49,378 --> 06:28:50,940
so I've got

6513
06:28:50,940 --> 06:28:53,280
about 10 minutes left okay

6514
06:28:53,280 --> 06:28:56,520
let's talk about my favorite case ever

6515
06:28:56,520 --> 06:28:58,920
and this title is absolutely appropriate

6516
06:28:58,920 --> 06:29:01,500
appropriate how to fail at everything

6517
06:29:01,500 --> 06:29:02,878
and still not get fired from your job

6518
06:29:02,878 --> 06:29:04,500
this has this has to do with the CSO at

6519
06:29:04,500 --> 06:29:05,638
this company

6520
06:29:05,638 --> 06:29:07,320
so let's start with a little bit of

6521
06:29:07,320 --> 06:29:08,520
background here

6522
06:29:08,520 --> 06:29:10,798
this was a very very very large

6523
06:29:10,798 --> 06:29:13,320
financial company on the East Coast it's

6524
06:29:13,320 --> 06:29:15,000
not experienced it was not Equifax so it

6525
06:29:15,000 --> 06:29:16,740
wasn't one of those people but they had

6526
06:29:16,740 --> 06:29:18,120
over a billion dollars in Revenue

6527
06:29:18,120 --> 06:29:20,280
companies been around forever so that's

6528
06:29:20,280 --> 06:29:21,600
the background that's as much as I can

6529
06:29:21,600 --> 06:29:22,920
give without giving away who the client

6530
06:29:22,920 --> 06:29:24,360
was for this

6531
06:29:24,360 --> 06:29:26,160
with some scopy notes they had an

6532
06:29:26,160 --> 06:29:28,200
on-prem exchange we got called in

6533
06:29:28,200 --> 06:29:29,700
because they were experiencing Brute

6534
06:29:29,700 --> 06:29:31,080
Force attacks leading to account

6535
06:29:31,080 --> 06:29:33,480
lockouts things like that this occurred

6536
06:29:33,480 --> 06:29:35,760
around April 10th as your show or and we

6537
06:29:35,760 --> 06:29:37,378
we started doing the investigation we

6538
06:29:37,378 --> 06:29:39,600
talked to them like okay you guys got 3

6539
06:29:39,600 --> 06:29:41,218
000 endpoints it's a mixture of Windows

6540
06:29:41,218 --> 06:29:43,980
Linux Unix they had a developer team

6541
06:29:43,980 --> 06:29:46,260
that was outsourced to India so we've

6542
06:29:46,260 --> 06:29:48,298
got multiple Geographic locations now

6543
06:29:48,298 --> 06:29:50,458
and we went out on site to the client's

6544
06:29:50,458 --> 06:29:52,920
place about on the East Coast we had a

6545
06:29:52,920 --> 06:29:54,240
couple people on site we had three folks

6546
06:29:54,240 --> 06:29:55,320
roll out on site we had three folks

6547
06:29:55,320 --> 06:29:57,120
supporting remotely from the office not

6548
06:29:57,120 --> 06:29:58,860
a huge team about six people total here

6549
06:29:58,860 --> 06:30:00,958
and that's how we kind of started the

6550
06:30:00,958 --> 06:30:02,458
investigation started digging into those

6551
06:30:02,458 --> 06:30:03,900
exchange law and started digging into

6552
06:30:03,900 --> 06:30:05,520
what happens

6553
06:30:05,520 --> 06:30:07,378
so we started looking at that we

6554
06:30:07,378 --> 06:30:09,420
confirmed hey yeah there's a Brute Force

6555
06:30:09,420 --> 06:30:10,798
it was originating from the IP address

6556
06:30:10,798 --> 06:30:13,620
owned by Chupa or vulture.com vulture is

6557
06:30:13,620 --> 06:30:14,878
fantastic I use them all the time for

6558
06:30:14,878 --> 06:30:16,320
hosting my other websites and stuff too

6559
06:30:16,320 --> 06:30:18,120
that's where the bad guys pivoting or

6560
06:30:18,120 --> 06:30:20,458
using their staging boxes

6561
06:30:20,458 --> 06:30:23,160
we saw a couple successful logons uh

6562
06:30:23,160 --> 06:30:25,260
from that outsourced it support to

6563
06:30:25,260 --> 06:30:27,240
corporate mailboxes so now okay not only

6564
06:30:27,240 --> 06:30:29,160
you have Brute Force but now we've got

6565
06:30:29,160 --> 06:30:31,138
confirmed account compromise of the

6566
06:30:31,138 --> 06:30:33,240
change okay cool typical investigation

6567
06:30:33,240 --> 06:30:34,980
typical stuff

6568
06:30:34,980 --> 06:30:37,260
when we were looking at this we found

6569
06:30:37,260 --> 06:30:39,240
out that that third party in India was

6570
06:30:39,240 --> 06:30:42,420
using VPN but their VPN was just soft

6571
06:30:42,420 --> 06:30:44,638
based tokens no hardware token nothing

6572
06:30:44,638 --> 06:30:46,138
pushed their phones anything like that

6573
06:30:46,138 --> 06:30:48,120
and what we discovered was that

6574
06:30:48,120 --> 06:30:50,280
third-party company in India was a

6575
06:30:50,280 --> 06:30:52,200
source of the compromise and they

6576
06:30:52,200 --> 06:30:54,480
supported thousands of other clients

6577
06:30:54,480 --> 06:30:57,058
this is a huge huge company so most

6578
06:30:57,058 --> 06:30:59,400
likely that third-party company they had

6579
06:30:59,400 --> 06:31:00,780
lots of Downstream victims as well

6580
06:31:00,780 --> 06:31:02,878
that's where this breach started

6581
06:31:02,878 --> 06:31:05,160
I was like okay cool we solved it we

6582
06:31:05,160 --> 06:31:06,420
solved how the account happened we

6583
06:31:06,420 --> 06:31:08,340
solved it was accessed but right here

6584
06:31:08,340 --> 06:31:10,320
we're on site let's look let's look at

6585
06:31:10,320 --> 06:31:11,820
the data sets let's be focused let's be

6586
06:31:11,820 --> 06:31:14,340
targeted okay they got VPN let's look in

6587
06:31:14,340 --> 06:31:16,020
those VPN logs right I'm not looking at

6588
06:31:16,020 --> 06:31:17,580
domain controllers yet I'm not looking

6589
06:31:17,580 --> 06:31:19,020
at file servers or web servers I'm going

6590
06:31:19,020 --> 06:31:20,580
to be focused entirely with my Approach

6591
06:31:20,580 --> 06:31:23,280
started looking at the VPN logs and sure

6592
06:31:23,280 --> 06:31:25,500
enough that vulture IP address was

6593
06:31:25,500 --> 06:31:28,040
connecting in as well so now we've got

6594
06:31:28,040 --> 06:31:30,540
more of a problem not only as an

6595
06:31:30,540 --> 06:31:32,340
exchange compromise now we've got bad

6596
06:31:32,340 --> 06:31:34,200
guy connecting into the client's

6597
06:31:34,200 --> 06:31:35,940
environment

6598
06:31:35,940 --> 06:31:37,798
so we applied that sniperous response

6599
06:31:37,798 --> 06:31:39,540
methodology right we dealt our

6600
06:31:39,540 --> 06:31:40,798
investigation plan here's what we're

6601
06:31:40,798 --> 06:31:42,420
trying to solve we're identifying those

6602
06:31:42,420 --> 06:31:44,280
key artifacts we're hunting that lateral

6603
06:31:44,280 --> 06:31:46,200
movement or identifying persistence

6604
06:31:46,200 --> 06:31:48,920
patient zero and right about this time

6605
06:31:48,920 --> 06:31:51,600
legal counsel we are working with one

6606
06:31:51,600 --> 06:31:53,160
firm and the client brought in another

6607
06:31:53,160 --> 06:31:54,840
firm with a different partner different

6608
06:31:54,840 --> 06:31:56,878
legal counsel as well that term that

6609
06:31:56,878 --> 06:31:58,620
they brought in was like one of the top

6610
06:31:58,620 --> 06:32:00,058
three firms in the world like if I said

6611
06:32:00,058 --> 06:32:01,320
their name you know who it is I'm not

6612
06:32:01,320 --> 06:32:03,120
gonna say their name but they rolled out

6613
06:32:03,120 --> 06:32:04,558
on site too and they brought in like 25

6614
06:32:04,558 --> 06:32:06,780
people so we got our team of three there

6615
06:32:06,780 --> 06:32:09,360
on site and we're like okay but we had

6616
06:32:09,360 --> 06:32:10,740
that like we're a startup we're trying

6617
06:32:10,740 --> 06:32:12,298
to like make ourselves look good so we

6618
06:32:12,298 --> 06:32:13,500
had like that little competitive thing

6619
06:32:13,500 --> 06:32:14,878
going on

6620
06:32:14,878 --> 06:32:16,558
we started looking at the data started

6621
06:32:16,558 --> 06:32:18,000
kind of going through this

6622
06:32:18,000 --> 06:32:20,580
and we started to see lots of activity

6623
06:32:20,580 --> 06:32:22,680
in the logs loss of activity from the

6624
06:32:22,680 --> 06:32:24,180
vpns loss of activity from the

6625
06:32:24,180 --> 06:32:26,218
connection logs things like that United

6626
06:32:26,218 --> 06:32:28,020
States India and Netherlands Australia

6627
06:32:28,020 --> 06:32:30,540
Germany stuff at the bottom really

6628
06:32:30,540 --> 06:32:33,480
caught our attention Iran right why why

6629
06:32:33,480 --> 06:32:36,298
are they connecting to a U.S company U.S

6630
06:32:36,298 --> 06:32:37,980
financial company in the first place

6631
06:32:37,980 --> 06:32:40,320
what's going on here so we started

6632
06:32:40,320 --> 06:32:42,480
digging into this started doing our

6633
06:32:42,480 --> 06:32:43,920
tracking the lateral movement started

6634
06:32:43,920 --> 06:32:45,840
identifying compromised accounts started

6635
06:32:45,840 --> 06:32:47,400
kind of digging into what was happening

6636
06:32:47,400 --> 06:32:49,500
and one of the compromise accounts that

6637
06:32:49,500 --> 06:32:51,660
we found we're going to call him Sharma

6638
06:32:51,660 --> 06:32:53,638
that that's not their name that's a

6639
06:32:53,638 --> 06:32:55,558
redacted name but that that's what we're

6640
06:32:55,558 --> 06:32:57,360
going to call this person and we see

6641
06:32:57,360 --> 06:32:58,980
them coming in from different hosts in

6642
06:32:58,980 --> 06:33:01,500
the vpm logs most of the hosts looked

6643
06:33:01,500 --> 06:33:02,878
legitimate because they had like the

6644
06:33:02,878 --> 06:33:04,020
company name at the front there which

6645
06:33:04,020 --> 06:33:06,360
says rejected and then there was this

6646
06:33:06,360 --> 06:33:07,500
one box that they connected in from

6647
06:33:07,500 --> 06:33:09,780
named Alex PC which is like that doesn't

6648
06:33:09,780 --> 06:33:12,660
match that that's not the client's stuff

6649
06:33:12,660 --> 06:33:14,400
so our Focus we're narrow with our

6650
06:33:14,400 --> 06:33:16,320
investigation right we're caring about

6651
06:33:16,320 --> 06:33:18,480
this one thing right now remember the

6652
06:33:18,480 --> 06:33:20,040
other IR firms there with 25 folks

6653
06:33:20,040 --> 06:33:21,058
they're like deploying all sorts of

6654
06:33:21,058 --> 06:33:22,500
tools and setting up things and like

6655
06:33:22,500 --> 06:33:24,000
doing all the stuff and we're digging on

6656
06:33:24,000 --> 06:33:25,440
this like we gotta lead we're gonna

6657
06:33:25,440 --> 06:33:28,138
chase this and see where it goes

6658
06:33:28,138 --> 06:33:30,298
so Alex PC we started digging into that

6659
06:33:30,298 --> 06:33:32,280
tracing where that Alex PC connected to

6660
06:33:32,280 --> 06:33:33,780
tracing that Sharma account working

6661
06:33:33,780 --> 06:33:36,298
backwards we started seeing hey back

6662
06:33:36,298 --> 06:33:38,160
guys dropping all sorts of tools PS exec

6663
06:33:38,160 --> 06:33:42,058
Powershell mimikats WinRAR and m.bat m

6664
06:33:42,058 --> 06:33:43,980
dot zip and we're starting seeing that

6665
06:33:43,980 --> 06:33:45,420
hey as soon as this dude connected

6666
06:33:45,420 --> 06:33:47,820
within that first 24 hours

6667
06:33:47,820 --> 06:33:50,580
they had domain admin credentials

6668
06:33:50,580 --> 06:33:53,218
they had created persistence they hadn't

6669
06:33:53,218 --> 06:33:55,138
made a new account called help desk so

6670
06:33:55,138 --> 06:33:58,260
this this attacker within 24 hours they

6671
06:33:58,260 --> 06:33:59,760
owned everything inside the network they

6672
06:33:59,760 --> 06:34:01,920
were really fast at what they did maybe

6673
06:34:01,920 --> 06:34:04,920
not the most skilled attacker but as far

6674
06:34:04,920 --> 06:34:07,980
as speed they were fast they they were

6675
06:34:07,980 --> 06:34:09,900
there they compromised the window the

6676
06:34:09,900 --> 06:34:12,420
windows environment Linux Unix servers

6677
06:34:12,420 --> 06:34:14,280
as well as we kind of went through that

6678
06:34:14,280 --> 06:34:15,780
and we started seeing some of the

6679
06:34:15,780 --> 06:34:16,620
lateral movement I was talking about

6680
06:34:16,620 --> 06:34:18,718
those type URLs remember for tracking

6681
06:34:18,718 --> 06:34:19,920
lateral movement getting those quick

6682
06:34:19,920 --> 06:34:22,260
wins in there and we see them connecting

6683
06:34:22,260 --> 06:34:24,718
to the C dollar sign share really

6684
06:34:24,718 --> 06:34:26,218
obvious stuff when you start digging

6685
06:34:26,218 --> 06:34:28,260
into this but we don't have an EDR we

6686
06:34:28,260 --> 06:34:29,820
don't have an xdr deployed we're being

6687
06:34:29,820 --> 06:34:30,900
focused with our approach we're

6688
06:34:30,900 --> 06:34:31,860
collecting things that we care about

6689
06:34:31,860 --> 06:34:34,080
looking at that data and then solving

6690
06:34:34,080 --> 06:34:35,340
the case and one things that made me

6691
06:34:35,340 --> 06:34:36,058
laugh

6692
06:34:36,058 --> 06:34:38,160
is that top entry there they're

6693
06:34:38,160 --> 06:34:40,798
searching live.com they're basically

6694
06:34:40,798 --> 06:34:43,440
looking for ways to use remote

6695
06:34:43,440 --> 06:34:46,020
Powershell to connect to the M3 Office

6696
06:34:46,020 --> 06:34:47,820
365 security Center

6697
06:34:47,820 --> 06:34:49,740
so bad guy didn't know how to do it so

6698
06:34:49,740 --> 06:34:52,260
they're Googling it basically on the

6699
06:34:52,260 --> 06:34:53,760
client's environment looking for stuff

6700
06:34:53,760 --> 06:34:56,218
which was really funny to see

6701
06:34:56,218 --> 06:34:58,558
uh so at this time we're chasing them

6702
06:34:58,558 --> 06:34:59,760
we're looking at stuff and we've

6703
06:34:59,760 --> 06:35:01,680
identified pretty significant impact

6704
06:35:01,680 --> 06:35:03,780
inside the clients environment uh we

6705
06:35:03,780 --> 06:35:05,580
identified 43 compromised accounts which

6706
06:35:05,580 --> 06:35:08,100
is a ton uh we found that the bad guy

6707
06:35:08,100 --> 06:35:09,958
had actually captured the shared secrets

6708
06:35:09,958 --> 06:35:11,760
for the routers and switches

6709
06:35:11,760 --> 06:35:13,138
so now my networking instruct

6710
06:35:13,138 --> 06:35:15,298
infrastructure is compromised we found

6711
06:35:15,298 --> 06:35:16,740
out the golden tickets right on the

6712
06:35:16,740 --> 06:35:18,718
domain controllers compromised we found

6713
06:35:18,718 --> 06:35:20,100
out that they got the SSH keys on the

6714
06:35:20,100 --> 06:35:22,080
Unix and Linux environment compromise

6715
06:35:22,080 --> 06:35:24,120
top to bottom that third-party

6716
06:35:24,120 --> 06:35:25,680
development team compromise top to

6717
06:35:25,680 --> 06:35:28,620
bottom uh we actually saw that one of

6718
06:35:28,620 --> 06:35:31,378
the data centers that the client was

6719
06:35:31,378 --> 06:35:34,080
using the data center admin had like a

6720
06:35:34,080 --> 06:35:35,520
shared account that he used for all of

6721
06:35:35,520 --> 06:35:36,900
his other customers inside the data

6722
06:35:36,900 --> 06:35:39,360
center that got compromised as well so

6723
06:35:39,360 --> 06:35:41,160
now there's potentially another several

6724
06:35:41,160 --> 06:35:43,860
hundred Downstream victims from this one

6725
06:35:43,860 --> 06:35:47,218
and on top of that

6726
06:35:47,218 --> 06:35:49,260
there was other partner victims from

6727
06:35:49,260 --> 06:35:50,760
this company that the bad guy is

6728
06:35:50,760 --> 06:35:52,860
pivoting into so we've got potentially

6729
06:35:52,860 --> 06:35:55,080
thousands of Downstream victims from

6730
06:35:55,080 --> 06:35:57,780
this attack and at the same time Drew I

6731
06:35:57,780 --> 06:35:58,798
don't know if you were there at that

6732
06:35:58,798 --> 06:36:01,138
time but one of my friends had another

6733
06:36:01,138 --> 06:36:03,600
dim Place defense industrial based place

6734
06:36:03,600 --> 06:36:05,520
was under attack by the same threat

6735
06:36:05,520 --> 06:36:08,820
group ab235 at this exact same time so

6736
06:36:08,820 --> 06:36:10,620
we were cooperatively sharing threat

6737
06:36:10,620 --> 06:36:11,940
intelligence back and forth like hey we

6738
06:36:11,940 --> 06:36:13,440
saw this we saw this did you see that

6739
06:36:13,440 --> 06:36:15,000
and we're kind of building on each other

6740
06:36:15,000 --> 06:36:16,500
for what we were doing we're kind of

6741
06:36:16,500 --> 06:36:18,958
going through that it's a really huge

6742
06:36:18,958 --> 06:36:22,200
thing really interesting here when we

6743
06:36:22,200 --> 06:36:24,360
started showing this impact this goes to

6744
06:36:24,360 --> 06:36:27,000
the CSO for why they were struggling and

6745
06:36:27,000 --> 06:36:28,920
why they're having such a hard time as

6746
06:36:28,920 --> 06:36:30,240
we're telling the Seesaw what happens

6747
06:36:30,240 --> 06:36:32,340
and he was giving executive briefings to

6748
06:36:32,340 --> 06:36:34,200
the board and he was telling the board

6749
06:36:34,200 --> 06:36:36,480
oh no big deal we're not compromised

6750
06:36:36,480 --> 06:36:38,400
nothing to worry about nothing going on

6751
06:36:38,400 --> 06:36:39,240
here

6752
06:36:39,240 --> 06:36:42,000
don't worry about anything and we're

6753
06:36:42,000 --> 06:36:43,500
getting really frustrated with the CSO

6754
06:36:43,500 --> 06:36:44,820
because we're talking to the sock we're

6755
06:36:44,820 --> 06:36:46,558
talking to their security team and the

6756
06:36:46,558 --> 06:36:48,240
CSO has just not taking anything

6757
06:36:48,240 --> 06:36:50,458
seriously so he was totally failing at

6758
06:36:50,458 --> 06:36:52,620
his job besides the I.T hygiene stuff

6759
06:36:52,620 --> 06:36:55,798
with no MFA on the VPN openc shares all

6760
06:36:55,798 --> 06:36:57,120
that fun stuff but he was totally

6761
06:36:57,120 --> 06:37:00,058
failing that at his job here so we're

6762
06:37:00,058 --> 06:37:01,260
kind of going back and looking through

6763
06:37:01,260 --> 06:37:03,180
this remember that Alex PC box I told

6764
06:37:03,180 --> 06:37:04,620
you about

6765
06:37:04,620 --> 06:37:06,780
how often to show it on right nothing

6766
06:37:06,780 --> 06:37:08,700
special typed it in

6767
06:37:08,700 --> 06:37:11,218
and sure enough it popped up and sure

6768
06:37:11,218 --> 06:37:14,100
enough it had metisplay Pro with a

6769
06:37:14,100 --> 06:37:15,900
self-signed cert and this is where the

6770
06:37:15,900 --> 06:37:17,218
attacker messed up

6771
06:37:17,218 --> 06:37:20,520
the attacker had that self-signed shirt

6772
06:37:20,520 --> 06:37:23,040
and they used their hacker handle

6773
06:37:23,040 --> 06:37:26,820
so his handle was his Twitter profile

6774
06:37:26,820 --> 06:37:29,280
his Facebook his Google Plus and Google

6775
06:37:29,280 --> 06:37:31,798
Plus was a thing so now I had like real

6776
06:37:31,798 --> 06:37:33,958
attribution which never happens with a

6777
06:37:33,958 --> 06:37:36,180
case real attribution I got the dude's

6778
06:37:36,180 --> 06:37:38,340
face I got his picture and we're looking

6779
06:37:38,340 --> 06:37:40,440
at we called him unibrow that was his

6780
06:37:40,440 --> 06:37:42,718
nickname for us but we that's what we

6781
06:37:42,718 --> 06:37:44,040
talked that's what we found we're

6782
06:37:44,040 --> 06:37:46,020
looking at him and we were looking at

6783
06:37:46,020 --> 06:37:47,878
his tweet activity and sure enough like

6784
06:37:47,878 --> 06:37:50,160
when he was attacking us

6785
06:37:50,160 --> 06:37:52,798
his tweets stopped and prior to that he

6786
06:37:52,798 --> 06:37:54,780
was an active Twitter user we saw the

6787
06:37:54,780 --> 06:37:57,240
patient zero his tweet stopped and like

6788
06:37:57,240 --> 06:37:59,218
nothing happened after that but he was

6789
06:37:59,218 --> 06:38:01,620
kind of dumb kind of kind of not smart

6790
06:38:01,620 --> 06:38:03,120
because he was posting where he was

6791
06:38:03,120 --> 06:38:05,280
where he was traveling he was from Iran

6792
06:38:05,280 --> 06:38:07,860
originally but he didn't happen to be

6793
06:38:07,860 --> 06:38:09,660
there at this time he actually happened

6794
06:38:09,660 --> 06:38:12,000
to be in Italy which if you're familiar

6795
06:38:12,000 --> 06:38:14,160
with like extradition ideas and things

6796
06:38:14,160 --> 06:38:15,540
like that Italy is a company that

6797
06:38:15,540 --> 06:38:17,400
extradites so we started working with

6798
06:38:17,400 --> 06:38:18,660
law enforcement that started talking to

6799
06:38:18,660 --> 06:38:21,360
our friends uh Secret Service FBI things

6800
06:38:21,360 --> 06:38:22,680
like that kind of talking to them with

6801
06:38:22,680 --> 06:38:24,298
what happens and

6802
06:38:24,298 --> 06:38:26,700
this is like where it gets even more

6803
06:38:26,700 --> 06:38:29,160
interesting we told Council not the

6804
06:38:29,160 --> 06:38:30,058
council we were working with the

6805
06:38:30,058 --> 06:38:32,520
in-house Council for this lawyer

6806
06:38:32,520 --> 06:38:34,798
hey you are top to bottom compromise bad

6807
06:38:34,798 --> 06:38:36,958
guy is reading all of your emails

6808
06:38:36,958 --> 06:38:39,058
do not put our daily updates out there

6809
06:38:39,058 --> 06:38:40,980
we're using out of band communication

6810
06:38:40,980 --> 06:38:42,660
reason personal gmails for that type of

6811
06:38:42,660 --> 06:38:45,180
stuff and we discovered that in-house

6812
06:38:45,180 --> 06:38:48,058
counsel was putting all of our daily uh

6813
06:38:48,058 --> 06:38:50,820
Point updates on their SharePoint server

6814
06:38:50,820 --> 06:38:52,500
and we're looking at the SharePoint

6815
06:38:52,500 --> 06:38:55,740
server and we saw the bad guy reading

6816
06:38:55,740 --> 06:38:59,458
our daily updates for the investigation

6817
06:38:59,458 --> 06:39:01,500
which was just terrible but on top of

6818
06:39:01,500 --> 06:39:03,480
that it gets worse this thread group

6819
06:39:03,480 --> 06:39:05,100
when we're talking law enforcement they

6820
06:39:05,100 --> 06:39:07,200
were known to support Hezbollah so

6821
06:39:07,200 --> 06:39:10,138
terrorist related on top of that

6822
06:39:10,138 --> 06:39:12,298
the in-house Council decided to upload

6823
06:39:12,298 --> 06:39:13,860
all of our personal contact information

6824
06:39:13,860 --> 06:39:15,540
to sharepoints

6825
06:39:15,540 --> 06:39:18,180
we saw the threat actor looking at our

6826
06:39:18,180 --> 06:39:19,920
information my name my personal cell

6827
06:39:19,920 --> 06:39:21,958
phone and I'm not making this up

6828
06:39:21,958 --> 06:39:24,180
when we saw that pretty much the same

6829
06:39:24,180 --> 06:39:25,980
day our phones were ringing off the hook

6830
06:39:25,980 --> 06:39:29,520
30 to 40 50 spam calls a day coming in

6831
06:39:29,520 --> 06:39:31,500
because we think the bad guys here got

6832
06:39:31,500 --> 06:39:33,058
bored and like ah you guys aren't

6833
06:39:33,058 --> 06:39:34,200
catching us we're seeing all your

6834
06:39:34,200 --> 06:39:35,580
updates they're just gonna mess with us

6835
06:39:35,580 --> 06:39:37,558
and that went on for a solid year I

6836
06:39:37,558 --> 06:39:38,878
never changed my number and it's kind of

6837
06:39:38,878 --> 06:39:41,040
blocked everything eventually that that

6838
06:39:41,040 --> 06:39:43,558
happened all the time which was crazy

6839
06:39:43,558 --> 06:39:45,900
I've never had that happen before lesson

6840
06:39:45,900 --> 06:39:47,520
learned from my side I never give

6841
06:39:47,520 --> 06:39:49,138
counsel in my personal sell anymore I

6842
06:39:49,138 --> 06:39:51,360
give them a Google number so take that

6843
06:39:51,360 --> 06:39:53,400
advice as you go through but one of the

6844
06:39:53,400 --> 06:39:55,440
nice things about this like we got that

6845
06:39:55,440 --> 06:39:58,020
attribution we got that bad guy activity

6846
06:39:58,020 --> 06:40:00,780
we kind of identified who they were and

6847
06:40:00,780 --> 06:40:03,000
we were talking with law enforcement and

6848
06:40:03,000 --> 06:40:05,218
part of that thing was

6849
06:40:05,218 --> 06:40:07,980
hey we grabbed him he was in Rome

6850
06:40:07,980 --> 06:40:09,780
it probably was not like this picture

6851
06:40:09,780 --> 06:40:12,600
but that's what's in my head

6852
06:40:12,600 --> 06:40:14,940
van pulls up throw a hood over your head

6853
06:40:14,940 --> 06:40:16,440
and shove you in there and you're at

6854
06:40:16,440 --> 06:40:17,760
some Detention Center down the road

6855
06:40:17,760 --> 06:40:19,680
that's what I thought happened that

6856
06:40:19,680 --> 06:40:21,180
makes it worthwhile for me was like hey

6857
06:40:21,180 --> 06:40:22,920
you got us I got you you're in prison

6858
06:40:22,920 --> 06:40:25,080
now craziest story I've ever worked

6859
06:40:25,080 --> 06:40:27,420
Casey's case that's the summary that's

6860
06:40:27,420 --> 06:40:29,280
the idea of sniper instant response

6861
06:40:29,280 --> 06:40:32,040
focusing on those big four questions you

6862
06:40:32,040 --> 06:40:33,240
could find the slides I'm gonna upload

6863
06:40:33,240 --> 06:40:35,218
them to GitHub pretty much uh maybe

6864
06:40:35,218 --> 06:40:37,500
tomorrow or so I'm on LinkedIn

6865
06:40:37,500 --> 06:40:39,840
Twitter handle if you guys are

6866
06:40:39,840 --> 06:40:42,000
interested in working you need a job or

6867
06:40:42,000 --> 06:40:43,620
interested in switching over to unit 42

6868
06:40:43,620 --> 06:40:46,400
we are hiring we have lots of open roles

6869
06:40:46,400 --> 06:40:48,840
specifically on the proactive advisement

6870
06:40:48,840 --> 06:40:50,820
side GRC stuff we've got a lot of open

6871
06:40:50,820 --> 06:40:52,860
positions over there uh we're going to

6872
06:40:52,860 --> 06:40:54,120
be building our threat intelligence team

6873
06:40:54,120 --> 06:40:55,558
even more we have some new openings

6874
06:40:55,558 --> 06:40:57,958
coming up this year so lots of fun stuff

6875
06:40:57,958 --> 06:41:00,610
coming up and that wraps it up for me

6876
06:41:00,610 --> 06:41:03,709
[Music]

6877
06:41:10,320 --> 06:41:11,878
questions

6878
06:41:11,878 --> 06:41:14,420
yeah

6879
06:41:16,200 --> 06:41:18,900
testing um four years ago I worked for a

6880
06:41:18,900 --> 06:41:22,500
company that got hit with ransomware

6881
06:41:22,500 --> 06:41:24,440
um multinational company

6882
06:41:24,440 --> 06:41:27,298
walked in the morning about 10 a.m all

6883
06:41:27,298 --> 06:41:29,700
of our service got encrypted uh at the

6884
06:41:29,700 --> 06:41:31,440
local site

6885
06:41:31,440 --> 06:41:33,480
um and you talk about going through the

6886
06:41:33,480 --> 06:41:35,400
logs and looking things like that how do

6887
06:41:35,400 --> 06:41:37,458
you do that when everything is encrypted

6888
06:41:37,458 --> 06:41:39,958
generally speaking the event logs don't

6889
06:41:39,958 --> 06:41:42,058
get locked up generally speaking of that

6890
06:41:42,058 --> 06:41:43,798
logs are left behind

6891
06:41:43,798 --> 06:41:45,360
um your recycle bin usually doesn't

6892
06:41:45,360 --> 06:41:46,920
encrypt it as well so

6893
06:41:46,920 --> 06:41:48,480
maybe hide all your secret documents in

6894
06:41:48,480 --> 06:41:49,558
the recycle bin because the bad guy's

6895
06:41:49,558 --> 06:41:50,940
never going to see them in there yeah

6896
06:41:50,940 --> 06:41:52,378
generally speaking the event log is left

6897
06:41:52,378 --> 06:41:53,458
and then there's some other places that

6898
06:41:53,458 --> 06:41:54,900
we can check from forensics decide that

6899
06:41:54,900 --> 06:41:56,580
some stuff that's left over

6900
06:41:56,580 --> 06:41:58,080
I think the worst ones for that is like

6901
06:41:58,080 --> 06:42:00,540
if it's uh esxi hosts or they actually

6902
06:42:00,540 --> 06:42:02,760
encrypt the whole images then you're out

6903
06:42:02,760 --> 06:42:04,558
of luck a lot of times but yeah

6904
06:42:04,558 --> 06:42:05,760
generally speak a little stuff is Left

6905
06:42:05,760 --> 06:42:08,057
Behind

6906
06:42:09,958 --> 06:42:12,920
oh

6907
06:42:16,080 --> 06:42:18,240
um I was interested in the line around

6908
06:42:18,240 --> 06:42:20,580
50 hours after you get started you're

6909
06:42:20,580 --> 06:42:22,440
stopping C2 that's command and control

6910
06:42:22,440 --> 06:42:23,580
right

6911
06:42:23,580 --> 06:42:26,040
uh why not stop the bleeding as soon as

6912
06:42:26,040 --> 06:42:28,680
you can so sometimes we can do that but

6913
06:42:28,680 --> 06:42:29,878
what we want to do is we want to

6914
06:42:29,878 --> 06:42:31,440
identify all of their persistence

6915
06:42:31,440 --> 06:42:34,020
mechanisms before we cut one off so we

6916
06:42:34,020 --> 06:42:36,298
cut off one of them they might go dark

6917
06:42:36,298 --> 06:42:37,920
on us and we won't identify the other

6918
06:42:37,920 --> 06:42:39,360
ones as quickly as we can so we kind of

6919
06:42:39,360 --> 06:42:41,520
want to understand that entire scope and

6920
06:42:41,520 --> 06:42:43,860
then cut it off as quickly as we can and

6921
06:42:43,860 --> 06:42:46,138
depending on the situation depending on

6922
06:42:46,138 --> 06:42:47,580
the client and what their needs are

6923
06:42:47,580 --> 06:42:49,500
sometimes we've actually advised like

6924
06:42:49,500 --> 06:42:51,240
school districts universities stuff they

6925
06:42:51,240 --> 06:42:52,260
actually have cut off the internet

6926
06:42:52,260 --> 06:42:54,540
entirely as soon as we're engaged and

6927
06:42:54,540 --> 06:42:56,218
then they have no access and we'll do

6928
06:42:56,218 --> 06:42:57,840
our investigation for a week or so and

6929
06:42:57,840 --> 06:42:59,580
kind of go through it like that that's

6930
06:42:59,580 --> 06:43:02,100
typically the process

6931
06:43:02,100 --> 06:43:04,500
I have just one more yeah as you're

6932
06:43:04,500 --> 06:43:06,480
trying to work that fast is there any

6933
06:43:06,480 --> 06:43:08,638
contention with trying to also have

6934
06:43:08,638 --> 06:43:10,680
evidence that can be usable later in

6935
06:43:10,680 --> 06:43:11,638
court

6936
06:43:11,638 --> 06:43:13,620
so a lot of the forensic artifacts are

6937
06:43:13,620 --> 06:43:15,180
we're not like trampling on any evidence

6938
06:43:15,180 --> 06:43:16,798
we're still collecting it things like

6939
06:43:16,798 --> 06:43:18,480
that and then after our like Strike Team

6940
06:43:18,480 --> 06:43:20,340
comes in we'll still have a whole team

6941
06:43:20,340 --> 06:43:21,600
of folks that do the traditional

6942
06:43:21,600 --> 06:43:23,580
forensics that go through and build out

6943
06:43:23,580 --> 06:43:25,798
all the normal timelines of the old like

6944
06:43:25,798 --> 06:43:27,298
normal like executive reporting for

6945
06:43:27,298 --> 06:43:28,980
Council and stuff like that so we'll

6946
06:43:28,980 --> 06:43:30,900
still have all that stuff the whole idea

6947
06:43:30,900 --> 06:43:32,580
of this is just going in there getting

6948
06:43:32,580 --> 06:43:34,200
those quick wins then passing that off

6949
06:43:34,200 --> 06:43:35,340
to the forensic team so they can go and

6950
06:43:35,340 --> 06:43:37,820
do their thing

6951
06:43:42,190 --> 06:43:45,080
[Music]

6952
06:43:45,080 --> 06:43:48,480
so on the on the metric slide there you

6953
06:43:48,480 --> 06:43:50,520
had all of your cases there together how

6954
06:43:50,520 --> 06:43:52,200
does it change

6955
06:43:52,200 --> 06:43:54,260
um whether it be phishing versus

6956
06:43:54,260 --> 06:43:56,280
vulnerability when it comes to just

6957
06:43:56,280 --> 06:43:57,718
ransomware

6958
06:43:57,718 --> 06:43:59,520
a lot of it

6959
06:43:59,520 --> 06:44:01,558
doesn't change really a lot of their

6960
06:44:01,558 --> 06:44:03,600
tactics are pretty static for what they

6961
06:44:03,600 --> 06:44:05,160
do because a lot of these threat groups

6962
06:44:05,160 --> 06:44:06,718
they actually will have like Conti is a

6963
06:44:06,718 --> 06:44:08,458
famous example right the Conti Playbook

6964
06:44:08,458 --> 06:44:10,320
was leaked online you go Google that

6965
06:44:10,320 --> 06:44:11,638
it's out there on GitHub and places too

6966
06:44:11,638 --> 06:44:13,740
the right actors that we see they

6967
06:44:13,740 --> 06:44:15,240
usually have these standard playbooks

6968
06:44:15,240 --> 06:44:16,320
that they follow

6969
06:44:16,320 --> 06:44:18,180
the ones that don't follow the script

6970
06:44:18,180 --> 06:44:21,360
are either like the Newbie hackers that

6971
06:44:21,360 --> 06:44:22,798
just grab all the tools in the world and

6972
06:44:22,798 --> 06:44:23,878
drop stuff on there and hope something

6973
06:44:23,878 --> 06:44:26,040
works or the really stealthy state

6974
06:44:26,040 --> 06:44:28,080
sponsored folks they kind of go on their

6975
06:44:28,080 --> 06:44:29,700
own script but the typical stuff the

6976
06:44:29,700 --> 06:44:31,980
majority of the cases you work they are

6977
06:44:31,980 --> 06:44:33,840
pretty standardized as far as tooling as

6978
06:44:33,840 --> 06:44:35,218
far as what they do as far as what we

6979
06:44:35,218 --> 06:44:37,400
see

6980
06:44:42,420 --> 06:44:44,180
um

6981
06:44:44,180 --> 06:44:47,700
uh great talk thank you um what we you

6982
06:44:47,700 --> 06:44:49,080
were referring to is a lot of

6983
06:44:49,080 --> 06:44:51,240
conventional kind of incident response

6984
06:44:51,240 --> 06:44:53,878
work nowadays with the cloud do you see

6985
06:44:53,878 --> 06:44:55,740
how much of a shift do you see and I

6986
06:44:55,740 --> 06:44:58,440
know it's going to be it depends but the

6987
06:44:58,440 --> 06:45:01,740
cloud surface provides a whole new

6988
06:45:01,740 --> 06:45:04,558
attack Vector that is sort of relatively

6989
06:45:04,558 --> 06:45:07,080
Unknown by your conventional IR teams do

6990
06:45:07,080 --> 06:45:09,900
you see more and more exfiltration and

6991
06:45:09,900 --> 06:45:11,340
abuse on that front

6992
06:45:11,340 --> 06:45:13,320
a lot of the cloud cases that we work

6993
06:45:13,320 --> 06:45:16,980
are really basic right we're seeing a

6994
06:45:16,980 --> 06:45:19,500
lot of like either S3 compromises uh

6995
06:45:19,500 --> 06:45:21,540
exposed buckets things like that or

6996
06:45:21,540 --> 06:45:22,680
secret key access where somebody

6997
06:45:22,680 --> 06:45:24,180
accidentally uploaded to GitHub things

6998
06:45:24,180 --> 06:45:26,040
like that but usually when the bad guy

6999
06:45:26,040 --> 06:45:27,780
gets into a cloud environment like AWS

7000
06:45:27,780 --> 06:45:29,520
specifically we're seeing this coin

7001
06:45:29,520 --> 06:45:32,458
miners being dropped so nothing like as

7002
06:45:32,458 --> 06:45:33,958
far as persistent access goes or things

7003
06:45:33,958 --> 06:45:35,218
like that it's just like your basic hey

7004
06:45:35,218 --> 06:45:37,080
I want to make some money I want to drop

7005
06:45:37,080 --> 06:45:38,820
some coin monitors and and run up your

7006
06:45:38,820 --> 06:45:40,378
AWS bill for you

7007
06:45:40,378 --> 06:45:42,180
Cloud stuff though on the top of that

7008
06:45:42,180 --> 06:45:44,580
cloud analysis really comes down to this

7009
06:45:44,580 --> 06:45:46,200
log analysis because all of your tools

7010
06:45:46,200 --> 06:45:48,600
out there guard Duty netflow data things

7011
06:45:48,600 --> 06:45:50,100
like that it still comes down to log

7012
06:45:50,100 --> 06:45:51,480
analysis and you can still apply the

7013
06:45:51,480 --> 06:45:53,458
same idea the methodology just getting

7014
06:45:53,458 --> 06:45:55,138
those quick wins knowing what that evil

7015
06:45:55,138 --> 06:45:56,820
looks like and pulling it out really

7016
06:45:56,820 --> 06:45:59,058
fast

7017
06:46:03,360 --> 06:46:05,458
oh no

7018
06:46:05,458 --> 06:46:09,557
sweet awesome yeah thanks for all coming

7019
06:46:22,720 --> 06:46:25,929
[Music]

7020
06:46:33,950 --> 06:46:52,189
[Music]

7021
06:46:53,878 --> 06:46:56,878
foreign

7022
06:46:57,950 --> 06:47:25,159
[Music]

7023
06:47:28,978 --> 06:47:30,640
foreign

7024
06:47:30,640 --> 06:48:01,130
[Music]

7025
06:48:01,798 --> 06:48:04,798
foreign

7026
06:48:08,220 --> 06:48:30,660
[Music]

7027
06:48:30,660 --> 06:48:33,660
foreign

7028
06:48:33,970 --> 06:48:37,179
[Music]

7029
06:48:40,760 --> 06:48:42,640
thank you

7030
06:48:42,640 --> 06:48:51,430
[Music]

7031
06:48:59,690 --> 06:49:02,829
[Music]

7032
06:49:16,740 --> 06:49:18,920
thank you

7033
06:49:21,620 --> 06:49:26,668
[Music]

7034
06:49:31,270 --> 06:49:35,369
[Music]

7035
06:49:40,920 --> 06:49:43,760
foreign

7036
06:49:55,600 --> 06:50:00,309
[Music]

7037
06:50:08,980 --> 06:50:12,349
[Music]

7038
06:50:17,520 --> 06:50:19,650
foreign

7039
06:50:19,650 --> 06:50:22,859
[Music]

7040
06:50:41,920 --> 06:50:44,760
[Music]

7041
06:50:44,760 --> 06:50:46,940
foreign

7042
06:50:51,610 --> 06:50:54,749
[Music]

7043
06:51:13,730 --> 06:51:16,810
[Music]

7044
06:51:20,580 --> 06:51:23,360
foreign

7045
06:51:46,920 --> 06:51:49,100
foreign

7046
06:51:51,320 --> 06:51:53,580
okay cool

7047
06:51:53,580 --> 06:51:56,760
all right yeah welcome everyone uh so my

7048
06:51:56,760 --> 06:51:58,620
name is Philip a little bit about me

7049
06:51:58,620 --> 06:52:01,200
like any good employee I derive my

7050
06:52:01,200 --> 06:52:03,660
identity via that of my employer so I

7051
06:52:03,660 --> 06:52:05,820
work for this company data theorem uh

7052
06:52:05,820 --> 06:52:07,500
you can tell because of the ostentatious

7053
06:52:07,500 --> 06:52:09,180
logo that I'm placed at the bottom of

7054
06:52:09,180 --> 06:52:10,978
each and every one of these slides so

7055
06:52:10,978 --> 06:52:12,958
hopefully you won't forget we do like

7056
06:52:12,958 --> 06:52:15,420
application security uh

7057
06:52:15,420 --> 06:52:17,820
good company I like it I'm also an

7058
06:52:17,820 --> 06:52:20,218
operating systems nerd so I spend an

7059
06:52:20,218 --> 06:52:23,400
inordinate amount of my life building a

7060
06:52:23,400 --> 06:52:26,400
hobby OS that no one but me is ever

7061
06:52:26,400 --> 06:52:28,740
going to use but it's a it's a fun and

7062
06:52:28,740 --> 06:52:30,660
rewarding Hobby and it'll be useful for

7063
06:52:30,660 --> 06:52:33,000
some vets uh here and there

7064
06:52:33,000 --> 06:52:35,520
I Almost Do a stock analysis nerd so at

7065
06:52:35,520 --> 06:52:37,740
work I do a lot of binary analysis which

7066
06:52:37,740 --> 06:52:39,718
is a really kind of you know fun and

7067
06:52:39,718 --> 06:52:42,120
rewarding part of the job like scanning

7068
06:52:42,120 --> 06:52:43,860
tens of thousands of iOS applications

7069
06:52:43,860 --> 06:52:46,860
for security vulnerabilities at scale

7070
06:52:46,860 --> 06:52:50,700
um so yeah that's that's not really what

7071
06:52:50,700 --> 06:52:51,900
we're going to be talking about today

7072
06:52:51,900 --> 06:52:53,700
paging all hackers virtual memory

7073
06:52:53,700 --> 06:52:55,200
attacks we're going to be talking about

7074
06:52:55,200 --> 06:52:56,878
memory

7075
06:52:56,878 --> 06:52:58,860
um so if you already kind of know some

7076
06:52:58,860 --> 06:53:00,660
stuff about virtual memory try to just

7077
06:53:00,660 --> 06:53:02,700
you know put that to one side we're

7078
06:53:02,700 --> 06:53:04,440
going to kind of Start From First

7079
06:53:04,440 --> 06:53:06,958
principles and try and see like why this

7080
06:53:06,958 --> 06:53:08,940
is useful what problems it'll kind of

7081
06:53:08,940 --> 06:53:11,400
help us solve uh so if you imagine all

7082
06:53:11,400 --> 06:53:13,620
the ram that's installed in the computer

7083
06:53:13,620 --> 06:53:16,320
it's like a big list of bytes and it's

7084
06:53:16,320 --> 06:53:17,878
byte addressed and so what that means is

7085
06:53:17,878 --> 06:53:19,378
that you know the very first byte it's

7086
06:53:19,378 --> 06:53:21,660
gonna be byte address zero all the way

7087
06:53:21,660 --> 06:53:24,058
up to address however many uh bytes you

7088
06:53:24,058 --> 06:53:25,920
have installed in the machine

7089
06:53:25,920 --> 06:53:28,200
okay so let's pretend we are the

7090
06:53:28,200 --> 06:53:30,180
operating system and like the user as

7091
06:53:30,180 --> 06:53:31,978
double clicked a program or something

7092
06:53:31,978 --> 06:53:34,200
has happened for some reason we want to

7093
06:53:34,200 --> 06:53:36,780
load a program into memory well okay our

7094
06:53:36,780 --> 06:53:38,700
memory is you know nice and free there's

7095
06:53:38,700 --> 06:53:40,620
nothing occupying it so we could just

7096
06:53:40,620 --> 06:53:43,260
pick any location and slide it in all

7097
06:53:43,260 --> 06:53:44,700
right user double click something else

7098
06:53:44,700 --> 06:53:46,740
once again we've got tons of free space

7099
06:53:46,740 --> 06:53:48,298
nothing really stopping us from just

7100
06:53:48,298 --> 06:53:50,400
picking any location we just load it no

7101
06:53:50,400 --> 06:53:52,978
worries okay here's where our problems

7102
06:53:52,978 --> 06:53:54,840
begin the user has double clicked a

7103
06:53:54,840 --> 06:53:56,940
third program and we actually do have

7104
06:53:56,940 --> 06:53:59,160
enough memory free memory to fulfill

7105
06:53:59,160 --> 06:54:01,320
this request but it's not contiguous you

7106
06:54:01,320 --> 06:54:02,940
know the memory has become fragmented

7107
06:54:02,940 --> 06:54:04,620
across the address space

7108
06:54:04,620 --> 06:54:06,540
and we don't really have a good strategy

7109
06:54:06,540 --> 06:54:08,940
for dealing with this problem uh this is

7110
06:54:08,940 --> 06:54:10,320
the first problem with a kind of bear

7111
06:54:10,320 --> 06:54:11,878
approach to Ram it's memory

7112
06:54:11,878 --> 06:54:13,978
fragmentation and no you know good

7113
06:54:13,978 --> 06:54:15,718
recourse

7114
06:54:15,718 --> 06:54:16,860
all right

7115
06:54:16,860 --> 06:54:19,920
going on to our second problem think

7116
06:54:19,920 --> 06:54:22,080
about uh those two programs loaded into

7117
06:54:22,080 --> 06:54:24,298
memory again and maybe the first program

7118
06:54:24,298 --> 06:54:26,100
is doing something really sensitive you

7119
06:54:26,100 --> 06:54:27,840
know it's got some user passwords in

7120
06:54:27,840 --> 06:54:31,320
memory or some private Keys uh just all

7121
06:54:31,320 --> 06:54:33,000
kinds of sensitive data that we really

7122
06:54:33,000 --> 06:54:35,458
don't want falling into the wrong hands

7123
06:54:35,458 --> 06:54:37,558
uh okay over here on the right we have

7124
06:54:37,558 --> 06:54:39,660
the wrong hands and what this program

7125
06:54:39,660 --> 06:54:42,120
can do is it can just you know read all

7126
06:54:42,120 --> 06:54:44,340
of memory from beginning to end uh

7127
06:54:44,340 --> 06:54:45,840
scanning it for you know strings or

7128
06:54:45,840 --> 06:54:47,218
Secrets or credentials or whatever it

7129
06:54:47,218 --> 06:54:49,260
likes and there's absolutely nothing

7130
06:54:49,260 --> 06:54:51,240
stopping it uh from doing this there's

7131
06:54:51,240 --> 06:54:53,638
no concept of memory protection

7132
06:54:53,638 --> 06:54:55,620
and not only can It Read any memory it

7133
06:54:55,620 --> 06:54:57,840
likes to uh it can also write to memory

7134
06:54:57,840 --> 06:54:59,638
which is really scary because it can

7135
06:54:59,638 --> 06:55:01,798
just like inject a key logger into any

7136
06:55:01,798 --> 06:55:03,478
program and there's nothing you can do

7137
06:55:03,478 --> 06:55:05,638
about this

7138
06:55:05,638 --> 06:55:08,458
and lastly you know another problem I I

7139
06:55:08,458 --> 06:55:10,080
thought I would throw in is see we've

7140
06:55:10,080 --> 06:55:11,340
got those three programs loaded into

7141
06:55:11,340 --> 06:55:13,138
memory and then you want to load another

7142
06:55:13,138 --> 06:55:15,420
one uh we're under high memory pressure

7143
06:55:15,420 --> 06:55:17,700
and again we don't have a good strategy

7144
06:55:17,700 --> 06:55:19,260
to deal with this you know how do we

7145
06:55:19,260 --> 06:55:21,298
free up more memory uh so that we can

7146
06:55:21,298 --> 06:55:22,860
continue operating and not just totally

7147
06:55:22,860 --> 06:55:24,660
lock up

7148
06:55:24,660 --> 06:55:26,638
okay so of course there is a solution to

7149
06:55:26,638 --> 06:55:28,200
this problem it's not new it's from the

7150
06:55:28,200 --> 06:55:30,840
70s it's called paging now first things

7151
06:55:30,840 --> 06:55:32,218
first let's get our definitions straight

7152
06:55:32,218 --> 06:55:33,840
there's several kinds of paging we're

7153
06:55:33,840 --> 06:55:36,058
not going to be talking about uh what

7154
06:55:36,058 --> 06:55:37,860
we're talking about is this fundamental

7155
06:55:37,860 --> 06:55:40,320
kind of CPU level memory virtualization

7156
06:55:40,320 --> 06:55:42,660
technique and so what that means is that

7157
06:55:42,660 --> 06:55:45,298
when the CPU is dealing with memory no

7158
06:55:45,298 --> 06:55:46,978
longer is it talking directly to memory

7159
06:55:46,978 --> 06:55:48,120
instead it's like this kind of

7160
06:55:48,120 --> 06:55:50,218
abstracted idea of memory there's some

7161
06:55:50,218 --> 06:55:52,620
layers in between that enables us to do

7162
06:55:52,620 --> 06:55:55,440
some really cool stuff

7163
06:55:55,440 --> 06:55:57,420
um so the outline of today's talk just

7164
06:55:57,420 --> 06:55:58,920
to give you a sense of kind of where

7165
06:55:58,920 --> 06:56:00,360
things are going to be going uh we're

7166
06:56:00,360 --> 06:56:01,740
going to do some background on you know

7167
06:56:01,740 --> 06:56:04,020
what is paging virtual memory uh how

7168
06:56:04,020 --> 06:56:06,000
does it work and then of course this is

7169
06:56:06,000 --> 06:56:08,040
a cyber security conference so we're

7170
06:56:08,040 --> 06:56:09,420
also going to be talking about some

7171
06:56:09,420 --> 06:56:11,160
security defenses that are built on top

7172
06:56:11,160 --> 06:56:13,440
of paging as well as some attacks that

7173
06:56:13,440 --> 06:56:15,540
you can carry out on this sort of CPU

7174
06:56:15,540 --> 06:56:17,820
level infrastructure I've also got a

7175
06:56:17,820 --> 06:56:21,540
couple of demos which is always fun

7176
06:56:21,540 --> 06:56:24,120
um hopefully they'll go well but uh

7177
06:56:24,120 --> 06:56:26,458
we'll roll with it either way

7178
06:56:26,458 --> 06:56:27,540
um

7179
06:56:27,540 --> 06:56:29,340
one of them is in Ubuntu and then

7180
06:56:29,340 --> 06:56:31,440
another is kind of in this uh homegrown

7181
06:56:31,440 --> 06:56:32,760
OS that I've been working on for a

7182
06:56:32,760 --> 06:56:35,179
number of years

7183
06:56:35,218 --> 06:56:37,378
and then paging just to point out it is

7184
06:56:37,378 --> 06:56:40,138
this kind of you know uh

7185
06:56:40,138 --> 06:56:42,900
it's not kind of specific to any one

7186
06:56:42,900 --> 06:56:44,700
instruction set architecture it's like

7187
06:56:44,700 --> 06:56:46,920
this generic concept I will be throwing

7188
06:56:46,920 --> 06:56:49,978
in the occasional x8664 or arm 64

7189
06:56:49,978 --> 06:56:52,680
specific detail but I'll I'll do my best

7190
06:56:52,680 --> 06:56:54,660
to call those out as they happen and the

7191
06:56:54,660 --> 06:56:57,420
concepts do carry over

7192
06:56:57,420 --> 06:57:00,120
okay so going into exactly you know how

7193
06:57:00,120 --> 06:57:01,978
this works uh kind of what the Core

7194
06:57:01,978 --> 06:57:05,160
Concepts are so the central idea with

7195
06:57:05,160 --> 06:57:07,080
paging is that no longer do we have this

7196
06:57:07,080 --> 06:57:09,298
just undifferentiated stream of bytes

7197
06:57:09,298 --> 06:57:12,660
instead we split up the uh physical

7198
06:57:12,660 --> 06:57:15,120
address space into these chunks that are

7199
06:57:15,120 --> 06:57:16,798
called frames and each of these frames

7200
06:57:16,798 --> 06:57:18,600
they all have a constant size uh

7201
06:57:18,600 --> 06:57:20,458
classically it's four kilobytes but it

7202
06:57:20,458 --> 06:57:21,600
doesn't have to be we'll do four

7203
06:57:21,600 --> 06:57:24,660
kilobytes because uh it's easy

7204
06:57:24,660 --> 06:57:25,260
um

7205
06:57:25,260 --> 06:57:27,540
and then paging also introduces this

7206
06:57:27,540 --> 06:57:29,760
concept of virtual Ram so we have the

7207
06:57:29,760 --> 06:57:31,320
physical RAM that's literally like the

7208
06:57:31,320 --> 06:57:33,540
you know the sticks of dims that are

7209
06:57:33,540 --> 06:57:35,160
installed in your machine and then

7210
06:57:35,160 --> 06:57:36,718
virtual Ram is just this kind of

7211
06:57:36,718 --> 06:57:39,420
conceptual abstract idea and it has

7212
06:57:39,420 --> 06:57:41,760
those same four kilobyte chunks but

7213
06:57:41,760 --> 06:57:43,440
instead of being called frames they're

7214
06:57:43,440 --> 06:57:45,478
called pages

7215
06:57:45,478 --> 06:57:47,280
um and each of those pages of course is

7216
06:57:47,280 --> 06:57:49,020
going to refer to some segment of

7217
06:57:49,020 --> 06:57:51,000
addresses you know this page I've picked

7218
06:57:51,000 --> 06:57:53,820
out is all of the bytes from address Ox

7219
06:57:53,820 --> 06:57:57,420
7000 to Ox 8000 and now here's like the

7220
06:57:57,420 --> 06:58:00,540
the central trick of paging is that you

7221
06:58:00,540 --> 06:58:02,760
can set things up such that when the CPU

7222
06:58:02,760 --> 06:58:04,740
tries to access any of the addresses

7223
06:58:04,740 --> 06:58:06,240
within this page

7224
06:58:06,240 --> 06:58:08,760
it'll instead be rerouted to a different

7225
06:58:08,760 --> 06:58:10,978
physical frame

7226
06:58:10,978 --> 06:58:14,280
um in this case Ox 4000 to 5000 of

7227
06:58:14,280 --> 06:58:15,780
course this is arbitrary I can wrap

7228
06:58:15,780 --> 06:58:18,120
things any way I like uh you know nine

7229
06:58:18,120 --> 06:58:19,558
thousand to eight thousand or I could do

7230
06:58:19,558 --> 06:58:21,478
what's called an identity map and have

7231
06:58:21,478 --> 06:58:22,920
the virtual addresses and the physical

7232
06:58:22,920 --> 06:58:26,100
addresses be exactly the same

7233
06:58:26,100 --> 06:58:27,840
one more really important part of this

7234
06:58:27,840 --> 06:58:29,940
is that I can set permissions on each

7235
06:58:29,940 --> 06:58:32,040
page so I can say okay this page you

7236
06:58:32,040 --> 06:58:33,240
know you're not allowed to write to it

7237
06:58:33,240 --> 06:58:35,820
it's only readable or uh of course it

7238
06:58:35,820 --> 06:58:37,440
can be rewrite as well

7239
06:58:37,440 --> 06:58:39,360
or this page can only be accessed by the

7240
06:58:39,360 --> 06:58:41,218
kernel it can't be accessed from user

7241
06:58:41,218 --> 06:58:42,180
space

7242
06:58:42,180 --> 06:58:44,638
and this is a really powerful primitive

7243
06:58:44,638 --> 06:58:45,958
that allows you to build some really

7244
06:58:45,958 --> 06:58:49,500
cool stuff and we do and uh we'll take a

7245
06:58:49,500 --> 06:58:51,120
look at that so of course the way this

7246
06:58:51,120 --> 06:58:53,580
works is no longer is the CPU wired you

7247
06:58:53,580 --> 06:58:55,798
know directly to Ram there's now an

7248
06:58:55,798 --> 06:58:57,240
intermediary called the memory

7249
06:58:57,240 --> 06:58:59,700
management unit or the mmu so anytime

7250
06:58:59,700 --> 06:59:01,620
the CPU tries to access and address

7251
06:59:01,620 --> 06:59:03,958
rather than going to ram it'll go to go

7252
06:59:03,958 --> 06:59:06,718
to the mmu the mmu will consult these

7253
06:59:06,718 --> 06:59:07,978
data structures that the operating

7254
06:59:07,978 --> 06:59:10,320
system has set up to you know tell it

7255
06:59:10,320 --> 06:59:12,360
about what address what physical frame

7256
06:59:12,360 --> 06:59:14,458
this address maps to it'll check like

7257
06:59:14,458 --> 06:59:16,558
the permissions are okay if everything

7258
06:59:16,558 --> 06:59:18,780
is hunky-dory it'll go ahead and fulfill

7259
06:59:18,780 --> 06:59:20,520
the request you know send it to RAM and

7260
06:59:20,520 --> 06:59:23,280
return the data and if not it'll handle

7261
06:59:23,280 --> 06:59:25,080
the error and we'll take a small look at

7262
06:59:25,080 --> 06:59:27,540
that later as well

7263
06:59:27,540 --> 06:59:29,280
okay so of course we're going to need

7264
06:59:29,280 --> 06:59:31,500
some kind of bookkeeping to keep track

7265
06:59:31,500 --> 06:59:34,320
of like okay what frame does this page

7266
06:59:34,320 --> 06:59:36,600
map to what are the permissions on it as

7267
06:59:36,600 --> 06:59:39,240
it turns out the bookkeeping for every

7268
06:59:39,240 --> 06:59:41,580
physical page I'm sorry every frame or

7269
06:59:41,580 --> 06:59:43,200
page that you want to keep track of

7270
06:59:43,200 --> 06:59:46,558
takes up exactly eight bytes so we need

7271
06:59:46,558 --> 06:59:50,638
eight bytes of storage uh to describe

7272
06:59:50,638 --> 06:59:54,120
4096 bytes of address space

7273
06:59:54,120 --> 06:59:56,120
um

7274
06:59:57,298 --> 06:59:59,400
so one way that you might think of doing

7275
06:59:59,400 --> 07:00:01,440
this is like all right we need eight

7276
07:00:01,440 --> 07:00:04,138
bytes for every you know four kilobyte

7277
07:00:04,138 --> 07:00:05,878
chunk of address space can we just have

7278
07:00:05,878 --> 07:00:08,040
a really big list of all the frames that

7279
07:00:08,040 --> 07:00:09,478
we have in memory and what all of their

7280
07:00:09,478 --> 07:00:10,740
properties are

7281
07:00:10,740 --> 07:00:12,840
this is kind of the naive approach of

7282
07:00:12,840 --> 07:00:14,160
how you might keep track of all the

7283
07:00:14,160 --> 07:00:17,340
memory in the system and uh This falls

7284
07:00:17,340 --> 07:00:18,780
apart pretty quickly because if you

7285
07:00:18,780 --> 07:00:21,540
think about it if I have a 4096 byte

7286
07:00:21,540 --> 07:00:24,000
four kilobyte chunk of memory and I need

7287
07:00:24,000 --> 07:00:26,100
eight bytes to keep track of it that's a

7288
07:00:26,100 --> 07:00:30,240
factor of 512. so we're spending a 512

7289
07:00:30,240 --> 07:00:33,000
of our memory just to do bookkeeping on

7290
07:00:33,000 --> 07:00:37,020
memory itself now maybe one 512 doesn't

7291
07:00:37,020 --> 07:00:39,298
sound like a lot maybe it does but the

7292
07:00:39,298 --> 07:00:41,100
thing is if you have a different virtual

7293
07:00:41,100 --> 07:00:43,020
address space for every process running

7294
07:00:43,020 --> 07:00:45,180
in the operating system as soon as you

7295
07:00:45,180 --> 07:00:48,360
hit 512 processes you've blown your

7296
07:00:48,360 --> 07:00:50,400
entire memory budget just on bookkeeping

7297
07:00:50,400 --> 07:00:52,620
memory itself so this is not going to

7298
07:00:52,620 --> 07:00:54,058
work we need something better we need

7299
07:00:54,058 --> 07:00:55,500
something more efficient that allows us

7300
07:00:55,500 --> 07:00:57,958
to you know kind of officially track the

7301
07:00:57,958 --> 07:01:00,298
address space without spending too much

7302
07:01:00,298 --> 07:01:02,878
on just this sort of uh accounting

7303
07:01:02,878 --> 07:01:05,120
information

7304
07:01:05,580 --> 07:01:07,500
all right so the path here is going to

7305
07:01:07,500 --> 07:01:09,058
be we're going to look at you know not

7306
07:01:09,058 --> 07:01:10,680
the naive approach but in fact how it

7307
07:01:10,680 --> 07:01:12,298
does work the efficient data structure

7308
07:01:12,298 --> 07:01:14,700
and this will kind of lead us in a

7309
07:01:14,700 --> 07:01:16,020
roundabout way to the First Security

7310
07:01:16,020 --> 07:01:17,760
defense that we'll talk about built on

7311
07:01:17,760 --> 07:01:20,218
top of paging

7312
07:01:20,218 --> 07:01:22,378
okay so the way that it actually works

7313
07:01:22,378 --> 07:01:24,180
the kind of cool efficient way is you

7314
07:01:24,180 --> 07:01:26,638
still have this you know table of

7315
07:01:26,638 --> 07:01:28,138
multiple entries Each of which is eight

7316
07:01:28,138 --> 07:01:30,600
bytes but instead of that table being as

7317
07:01:30,600 --> 07:01:32,280
big as you know the number of frames

7318
07:01:32,280 --> 07:01:33,478
that you need to keep track of based on

7319
07:01:33,478 --> 07:01:34,878
how much RAM is installed in the system

7320
07:01:34,878 --> 07:01:37,700
instead that table is exactly

7321
07:01:37,700 --> 07:01:41,760
512 uh entries wide and each of those

7322
07:01:41,760 --> 07:01:43,740
entries of course is eight bytes meaning

7323
07:01:43,740 --> 07:01:46,440
that this whole table 512 entries very

7324
07:01:46,440 --> 07:01:48,420
kind of it's very neat and tidy it fits

7325
07:01:48,420 --> 07:01:51,478
in exactly one frame or one page this is

7326
07:01:51,478 --> 07:01:53,638
called the page mapping level one and

7327
07:01:53,638 --> 07:01:55,440
since each of these entries in the page

7328
07:01:55,440 --> 07:01:57,120
describes four kilobytes of address

7329
07:01:57,120 --> 07:01:59,040
space it means that the page mapping

7330
07:01:59,040 --> 07:02:02,420
level one with its 512 entries describes

7331
07:02:02,420 --> 07:02:05,580
uh two megabytes of address space so it

7332
07:02:05,580 --> 07:02:08,580
takes up uh four kilobytes of accounting

7333
07:02:08,580 --> 07:02:10,020
but it lets you describe two megabytes

7334
07:02:10,020 --> 07:02:11,280
of address space

7335
07:02:11,280 --> 07:02:13,740
okay two megabytes of course isn't going

7336
07:02:13,740 --> 07:02:15,360
to get us very far so where do we go

7337
07:02:15,360 --> 07:02:16,978
from here well we have a page mapping

7338
07:02:16,978 --> 07:02:19,138
level two it's the same idea everything

7339
07:02:19,138 --> 07:02:21,718
is eight bytes there's 512 entries it

7340
07:02:21,718 --> 07:02:24,180
fits in a frame once again but instead

7341
07:02:24,180 --> 07:02:25,920
of each of those entries describing a

7342
07:02:25,920 --> 07:02:28,020
four kilobyte frame each of those

7343
07:02:28,020 --> 07:02:30,360
entries is now describing an entire page

7344
07:02:30,360 --> 07:02:33,058
mapping level one so rather than mapping

7345
07:02:33,058 --> 07:02:35,580
two megabytes of address space I'm doing

7346
07:02:35,580 --> 07:02:38,760
two megabytes times 512 or a gigabyte of

7347
07:02:38,760 --> 07:02:41,580
address space is that okay if that's all

7348
07:02:41,580 --> 07:02:43,260
making sense uh that's really good

7349
07:02:43,260 --> 07:02:44,820
because we just continue the trick again

7350
07:02:44,820 --> 07:02:47,520
there's a page mapping level three 512

7351
07:02:47,520 --> 07:02:49,920
entries each are eight bytes and each

7352
07:02:49,920 --> 07:02:51,478
describes a page mapping level two

7353
07:02:51,478 --> 07:02:53,458
meaning that a page is mapping level

7354
07:02:53,458 --> 07:02:55,558
three gets you the ability to describe

7355
07:02:55,558 --> 07:02:58,620
512 gigabytes of address space and then

7356
07:02:58,620 --> 07:03:01,080
it thankfully it stops here there's one

7357
07:03:01,080 --> 07:03:03,180
more level the page mapping level for

7358
07:03:03,180 --> 07:03:05,940
exact same idea we just go one level up

7359
07:03:05,940 --> 07:03:08,878
and this lets us talk about 256

7360
07:03:08,878 --> 07:03:11,940
terabytes of virtual address space

7361
07:03:11,940 --> 07:03:15,478
so thankfully it ends here the CPU uh

7362
07:03:15,478 --> 07:03:17,458
sets up the page mapping level for I'm

7363
07:03:17,458 --> 07:03:19,200
sorry the OS sets up the page mapping

7364
07:03:19,200 --> 07:03:21,718
level for hands it off to the CPU and

7365
07:03:21,718 --> 07:03:23,340
then it can get to work you know we

7366
07:03:23,340 --> 07:03:24,600
don't have to deal with more tables

7367
07:03:24,600 --> 07:03:26,400
actually that's not true Intel has a

7368
07:03:26,400 --> 07:03:28,138
thing with five level tables I don't

7369
07:03:28,138 --> 07:03:29,820
think they've actually produced any CPUs

7370
07:03:29,820 --> 07:03:32,280
that do this but uh it exists anyway

7371
07:03:32,280 --> 07:03:34,620
we're not going to worry about that

7372
07:03:34,620 --> 07:03:38,100
um okay so hold on initially we just had

7373
07:03:38,100 --> 07:03:40,020
that you know big list sure it was kind

7374
07:03:40,020 --> 07:03:40,920
of

7375
07:03:40,920 --> 07:03:44,520
um maybe expensive but it was quite

7376
07:03:44,520 --> 07:03:46,740
kind of compact we just had one list to

7377
07:03:46,740 --> 07:03:48,058
keep track of now we've got these like

7378
07:03:48,058 --> 07:03:50,580
recursive you know nested tables this

7379
07:03:50,580 --> 07:03:52,500
seems like a lot more bookkeeping how is

7380
07:03:52,500 --> 07:03:54,298
this kind of helping us with our memory

7381
07:03:54,298 --> 07:03:56,100
budget well there's a really important

7382
07:03:56,100 --> 07:03:58,260
trick here and that is holes are allowed

7383
07:03:58,260 --> 07:04:00,298
so you don't actually need to flesh out

7384
07:04:00,298 --> 07:04:02,340
all the levels of all of those tables

7385
07:04:02,340 --> 07:04:03,958
you only need to keep track of the

7386
07:04:03,958 --> 07:04:06,478
memory that you actually care to access

7387
07:04:06,478 --> 07:04:08,340
so we only store bookkeeping for the

7388
07:04:08,340 --> 07:04:10,500
memory that's actually in use another

7389
07:04:10,500 --> 07:04:12,360
way of visualizing this is I've got that

7390
07:04:12,360 --> 07:04:13,798
you know whole page mapping level four

7391
07:04:13,798 --> 07:04:15,478
the recursive structure but if I don't

7392
07:04:15,478 --> 07:04:17,280
care about some region of the address

7393
07:04:17,280 --> 07:04:18,900
space I don't need to allocate the

7394
07:04:18,900 --> 07:04:20,760
memory to keep track of those tables I

7395
07:04:20,760 --> 07:04:22,080
can just you know they just won't be

7396
07:04:22,080 --> 07:04:23,638
there and those addresses you won't be

7397
07:04:23,638 --> 07:04:25,020
able to talk about them

7398
07:04:25,020 --> 07:04:27,360
uh so it's pretty cool

7399
07:04:27,360 --> 07:04:30,000
now the way that this works when the mmu

7400
07:04:30,000 --> 07:04:31,620
you know you give it an address and then

7401
07:04:31,620 --> 07:04:33,240
it's going to like consult those tables

7402
07:04:33,240 --> 07:04:36,360
to find out uh the information in those

7403
07:04:36,360 --> 07:04:37,620
data structures that we just looked at

7404
07:04:37,620 --> 07:04:39,840
how does it actually know where to look

7405
07:04:39,840 --> 07:04:42,298
well the virtual address itself the you

7406
07:04:42,298 --> 07:04:45,298
know the kind of pointer in in uh

7407
07:04:45,298 --> 07:04:47,400
regular parlance any memory address that

7408
07:04:47,400 --> 07:04:49,440
you're using uh in regular programming

7409
07:04:49,440 --> 07:04:52,080
it's actually a sort of a sort of code

7410
07:04:52,080 --> 07:04:54,360
so it's not of course actually an

7411
07:04:54,360 --> 07:04:56,760
address in Ram as we've seen it's

7412
07:04:56,760 --> 07:04:59,638
instead an instruction to the mmu on how

7413
07:04:59,638 --> 07:05:01,500
you're going to Traverse these data

7414
07:05:01,500 --> 07:05:03,360
structures to find the information about

7415
07:05:03,360 --> 07:05:04,978
what frame it's mapped to

7416
07:05:04,978 --> 07:05:07,860
uh so the top 16 bits this is a 64-bit

7417
07:05:07,860 --> 07:05:10,138
address expressed in binary and I've

7418
07:05:10,138 --> 07:05:11,400
just color coded what each of these

7419
07:05:11,400 --> 07:05:13,320
regions mean so the top 16 bits are

7420
07:05:13,320 --> 07:05:14,700
unused we'll come back to those later

7421
07:05:14,700 --> 07:05:17,718
and the next sections of nine bits each

7422
07:05:17,718 --> 07:05:21,000
describe you know what kind of index in

7423
07:05:21,000 --> 07:05:22,860
each of those levels of tables should be

7424
07:05:22,860 --> 07:05:24,718
accessed in order to find out the

7425
07:05:24,718 --> 07:05:26,580
information about that frame so the top

7426
07:05:26,580 --> 07:05:28,378
nine bits are you know the index into

7427
07:05:28,378 --> 07:05:30,180
the page mapping level four next line

7428
07:05:30,180 --> 07:05:32,040
bits page mapping level three etc etc

7429
07:05:32,040 --> 07:05:34,558
and then those bottom 12 bits are the

7430
07:05:34,558 --> 07:05:36,718
offset into the physical frame that you

7431
07:05:36,718 --> 07:05:38,218
want to you know of the memory of the

7432
07:05:38,218 --> 07:05:40,620
real Ram that you want to access

7433
07:05:40,620 --> 07:05:42,958
I think this is quite useful to kind of

7434
07:05:42,958 --> 07:05:44,638
work it out you know on paper per se

7435
07:05:44,638 --> 07:05:46,740
with uh with a real address so this is

7436
07:05:46,740 --> 07:05:49,440
just a made-up pointer uh we can express

7437
07:05:49,440 --> 07:05:51,058
it in binary and do those same

7438
07:05:51,058 --> 07:05:52,740
color-coded divisions that we did a

7439
07:05:52,740 --> 07:05:54,958
moment ago and we can count out you know

7440
07:05:54,958 --> 07:05:56,700
we can see okay this is accessing the

7441
07:05:56,700 --> 07:05:58,200
zero with index and the page mapping

7442
07:05:58,200 --> 07:06:00,240
level four zero with index in the third

7443
07:06:00,240 --> 07:06:01,920
table the third index and the page

7444
07:06:01,920 --> 07:06:04,378
mapping level two you get the idea and

7445
07:06:04,378 --> 07:06:07,500
then finally 324 bytes into that

7446
07:06:07,500 --> 07:06:10,280
physical frame

7447
07:06:10,378 --> 07:06:12,240
okay I want to do this with one more

7448
07:06:12,240 --> 07:06:14,040
address this is like a typical kind of

7449
07:06:14,040 --> 07:06:16,080
Kernel mode address that you might be

7450
07:06:16,080 --> 07:06:17,700
familiar with if you've seen like kernel

7451
07:06:17,700 --> 07:06:19,080
addresses and then they have all the F's

7452
07:06:19,080 --> 07:06:21,298
at the beginning why is that we'll take

7453
07:06:21,298 --> 07:06:23,700
a look but exact same idea those top 16

7454
07:06:23,700 --> 07:06:26,100
bits are unused and then we have all

7455
07:06:26,100 --> 07:06:27,840
those indexes that we can Traverse to

7456
07:06:27,840 --> 07:06:29,638
find out the information the bookkeeping

7457
07:06:29,638 --> 07:06:31,320
information for what physical frame this

7458
07:06:31,320 --> 07:06:33,298
refers to

7459
07:06:33,298 --> 07:06:36,540
okay so a moment ago all those High 16

7460
07:06:36,540 --> 07:06:39,478
bits were zeros and now in the second

7461
07:06:39,478 --> 07:06:42,000
example they're all ones what what's the

7462
07:06:42,000 --> 07:06:43,860
deal there well there's actually a rule

7463
07:06:43,860 --> 07:06:45,900
here it's mandated by the architecture

7464
07:06:45,900 --> 07:06:48,840
on x8664 at least that you need to take

7465
07:06:48,840 --> 07:06:51,298
this High bit in that first cluster of

7466
07:06:51,298 --> 07:06:53,340
nine bits and then copy it as a sign

7467
07:06:53,340 --> 07:06:57,120
extension uh to the high 16 bits and

7468
07:06:57,120 --> 07:06:59,940
there's a really kind of cool uh

7469
07:06:59,940 --> 07:07:01,620
implication of this

7470
07:07:01,620 --> 07:07:04,500
so what this means is that on x8664

7471
07:07:04,500 --> 07:07:07,138
you're actually pretty Limited in the

7472
07:07:07,138 --> 07:07:08,878
addresses that in the in the yeah in the

7473
07:07:08,878 --> 07:07:10,320
memory addresses that it's possible to

7474
07:07:10,320 --> 07:07:12,718
talk about so it's only possible to

7475
07:07:12,718 --> 07:07:15,058
refer to all the memory addresses for

7476
07:07:15,058 --> 07:07:17,638
those High 16 bits or zeros and all the

7477
07:07:17,638 --> 07:07:19,740
memory addresses or those High 16 bits

7478
07:07:19,740 --> 07:07:21,478
are ones

7479
07:07:21,478 --> 07:07:23,458
um so we have a 64-bit address but

7480
07:07:23,458 --> 07:07:26,100
functionally we only have 48 bits that

7481
07:07:26,100 --> 07:07:28,138
we can use to actually you know work

7482
07:07:28,138 --> 07:07:29,580
with real memory addresses to address

7483
07:07:29,580 --> 07:07:33,180
bits of the uh well address space

7484
07:07:33,180 --> 07:07:33,780
um

7485
07:07:33,780 --> 07:07:35,638
and this is it's actually pretty

7486
07:07:35,638 --> 07:07:37,680
remarkable how small this is compared to

7487
07:07:37,680 --> 07:07:39,718
how big the 64-bit address space really

7488
07:07:39,718 --> 07:07:42,180
is so again all the addresses where

7489
07:07:42,180 --> 07:07:45,478
those top 16 bits or zeros that's 128

7490
07:07:45,478 --> 07:07:47,580
terabytes of possible addresses

7491
07:07:47,580 --> 07:07:49,680
uh all the addresses for those High bits

7492
07:07:49,680 --> 07:07:51,900
are ones that's another 128 terabytes

7493
07:07:51,900 --> 07:07:54,298
but there's this massive really

7494
07:07:54,298 --> 07:07:56,280
gargantuan region in the Middle where

7495
07:07:56,280 --> 07:07:58,378
those High 16 bits are some combination

7496
07:07:58,378 --> 07:08:00,958
of zeros and ones and it's impossible to

7497
07:08:00,958 --> 07:08:02,280
refer to these in that region it's

7498
07:08:02,280 --> 07:08:05,520
actually 16 million terabytes

7499
07:08:05,520 --> 07:08:06,120
um

7500
07:08:06,120 --> 07:08:08,638
and in the classic you know uh 48-bit

7501
07:08:08,638 --> 07:08:10,260
addressing scheme that we use today

7502
07:08:10,260 --> 07:08:13,020
again it's totally inaccessible so as I

7503
07:08:13,020 --> 07:08:15,600
mentioned Intel uh has like a white

7504
07:08:15,600 --> 07:08:19,080
paper for using another nine bits uh to

7505
07:08:19,080 --> 07:08:21,298
expand the usable region

7506
07:08:21,298 --> 07:08:23,760
um but no one needs those today we'll

7507
07:08:23,760 --> 07:08:26,218
get there someday but uh 256 terabytes

7508
07:08:26,218 --> 07:08:27,660
is more than enough for anything we do

7509
07:08:27,660 --> 07:08:29,878
today

7510
07:08:29,878 --> 07:08:31,620
okay so this raises the question is

7511
07:08:31,620 --> 07:08:33,600
there anything we can do with these

7512
07:08:33,600 --> 07:08:35,160
unused bits can we put them to some use

7513
07:08:35,160 --> 07:08:37,620
to like you know increase user

7514
07:08:37,620 --> 07:08:40,860
engagement or drive ad Revenue uh well

7515
07:08:40,860 --> 07:08:43,378
actually yes not that but yes

7516
07:08:43,378 --> 07:08:44,638
um

7517
07:08:44,638 --> 07:08:46,680
so this is our first kind of security

7518
07:08:46,680 --> 07:08:49,798
defense also that was the kind of theory

7519
07:08:49,798 --> 07:08:51,600
heavy portion of the talk so thank you

7520
07:08:51,600 --> 07:08:53,520
everyone uh for sticking with me

7521
07:08:53,520 --> 07:08:55,558
so the idea here is that rather than

7522
07:08:55,558 --> 07:08:57,120
just having those kind of useless High

7523
07:08:57,120 --> 07:08:58,320
16 bits that aren't really doing

7524
07:08:58,320 --> 07:09:01,798
anything for us we can instead put some

7525
07:09:01,798 --> 07:09:04,260
kind of security information in those so

7526
07:09:04,260 --> 07:09:05,458
this is the idea with pointer

7527
07:09:05,458 --> 07:09:08,218
authentication we use those High 16 bits

7528
07:09:08,218 --> 07:09:11,340
to store a a context value and a

7529
07:09:11,340 --> 07:09:13,260
cryptographic kind of digest that's

7530
07:09:13,260 --> 07:09:16,440
computed from all these other values and

7531
07:09:16,440 --> 07:09:18,000
effectively what this means is that it's

7532
07:09:18,000 --> 07:09:20,040
really difficult to forge pointers if

7533
07:09:20,040 --> 07:09:21,420
you're trying to carry out some kind of

7534
07:09:21,420 --> 07:09:23,760
uh you know you're trying to execute

7535
07:09:23,760 --> 07:09:24,718
code that you shouldn't be able to

7536
07:09:24,718 --> 07:09:25,860
execute you're trying to jump somewhere

7537
07:09:25,860 --> 07:09:27,478
you shouldn't be able to jump you need

7538
07:09:27,478 --> 07:09:29,340
to construct a pointer to do that but

7539
07:09:29,340 --> 07:09:30,900
the pointers are signed and you're not

7540
07:09:30,900 --> 07:09:33,180
able to you know sign them yourself uh

7541
07:09:33,180 --> 07:09:34,378
that's a lot trickier this was

7542
07:09:34,378 --> 07:09:37,558
introduced in arm 8.3

7543
07:09:37,558 --> 07:09:38,878
um

7544
07:09:38,878 --> 07:09:41,340
it's like been in iPhones for a few

7545
07:09:41,340 --> 07:09:43,200
years and now some Android socs as well

7546
07:09:43,200 --> 07:09:45,900
it's neat

7547
07:09:45,900 --> 07:09:47,340
um and one thing that's cool about this

7548
07:09:47,340 --> 07:09:49,500
is it means that if you look at a sign

7549
07:09:49,500 --> 07:09:51,900
pointer it's no longer a valid memory

7550
07:09:51,900 --> 07:09:54,478
address uh well actually they were never

7551
07:09:54,478 --> 07:09:55,860
valid memory addresses because they

7552
07:09:55,860 --> 07:09:57,420
don't actually refer to Ram but you know

7553
07:09:57,420 --> 07:09:59,340
what I mean I digress

7554
07:09:59,340 --> 07:10:00,120
um

7555
07:10:00,120 --> 07:10:02,160
yeah they're now this kind of garbled

7556
07:10:02,160 --> 07:10:03,840
value because they have this crypto

7557
07:10:03,840 --> 07:10:05,340
signature tucked onto them which I

7558
07:10:05,340 --> 07:10:08,040
thought was cool the first time I saw it

7559
07:10:08,040 --> 07:10:10,440
okay so you might ask like why pack what

7560
07:10:10,440 --> 07:10:12,478
is what is it kind of doing and it's an

7561
07:10:12,478 --> 07:10:14,040
extra defensive mechanism so the threat

7562
07:10:14,040 --> 07:10:16,378
model here is someone has already you

7563
07:10:16,378 --> 07:10:18,558
know not code execution but they're

7564
07:10:18,558 --> 07:10:21,718
messing with stack frames or uh you know

7565
07:10:21,718 --> 07:10:22,798
they're doing something and you don't

7566
07:10:22,798 --> 07:10:24,000
want them to be able to construct

7567
07:10:24,000 --> 07:10:25,978
pointers uh and jump to arbitrary

7568
07:10:25,978 --> 07:10:27,298
locations

7569
07:10:27,298 --> 07:10:28,978
um so it's just a kind of an extra

7570
07:10:28,978 --> 07:10:30,660
barrier in the way of someone who's

7571
07:10:30,660 --> 07:10:33,478
trying to uh do remote code execution

7572
07:10:33,478 --> 07:10:35,520
and in particular it's intended to make

7573
07:10:35,520 --> 07:10:37,558
return oriented programming harder to

7574
07:10:37,558 --> 07:10:39,540
achieve so if you're not familiar with

7575
07:10:39,540 --> 07:10:41,218
uh return oriented programming that's

7576
07:10:41,218 --> 07:10:42,958
fine I've got this really kind of simple

7577
07:10:42,958 --> 07:10:45,360
diagram to illustrate the idea this is

7578
07:10:45,360 --> 07:10:47,420
you know um

7579
07:10:47,420 --> 07:10:50,218
don't take this too seriously but the

7580
07:10:50,218 --> 07:10:52,378
idea is okay

7581
07:10:52,378 --> 07:10:54,240
the system that I'm trying to attack has

7582
07:10:54,240 --> 07:10:56,100
enough Protections in place to where I

7583
07:10:56,100 --> 07:10:58,378
can't just you know write shell codes

7584
07:10:58,378 --> 07:11:01,260
somewhere uh so the idea is it's pretty

7585
07:11:01,260 --> 07:11:04,620
clever uh there's code that exists in

7586
07:11:04,620 --> 07:11:06,600
the binary that I can just rearrange in

7587
07:11:06,600 --> 07:11:08,700
kind of clever ways to achieve some goal

7588
07:11:08,700 --> 07:11:10,378
so I've got two functions that just

7589
07:11:10,378 --> 07:11:12,478
exist they're innocuous it's you know

7590
07:11:12,478 --> 07:11:14,760
part of the kind of trusted code the

7591
07:11:14,760 --> 07:11:17,638
first one uh accepts a known binary the

7592
07:11:17,638 --> 07:11:19,798
second one read some user input and then

7593
07:11:19,798 --> 07:11:21,478
prints it

7594
07:11:21,478 --> 07:11:23,520
um but the idea with return oriented

7595
07:11:23,520 --> 07:11:25,200
programming is that you can rearrange

7596
07:11:25,200 --> 07:11:27,180
these things to do new and scary things

7597
07:11:27,180 --> 07:11:29,280
in this example of course it's reading

7598
07:11:29,280 --> 07:11:32,160
some user input and then executing it

7599
07:11:32,160 --> 07:11:32,760
um

7600
07:11:32,760 --> 07:11:34,860
and the idea with pack is that if these

7601
07:11:34,860 --> 07:11:36,958
pointers are signed you know if you take

7602
07:11:36,958 --> 07:11:38,218
one from the wrong place it's not going

7603
07:11:38,218 --> 07:11:41,820
to be valid and uh this won't work

7604
07:11:41,820 --> 07:11:44,700
okay so you might ask well hold on if

7605
07:11:44,700 --> 07:11:46,378
all that I need to compute this crypto

7606
07:11:46,378 --> 07:11:48,120
signature is just what's available in

7607
07:11:48,120 --> 07:11:50,638
the pointer uh can't I just compute this

7608
07:11:50,638 --> 07:11:53,218
signature myself well no I you know

7609
07:11:53,218 --> 07:11:55,020
oversimplified a bit I put in the slide

7610
07:11:55,020 --> 07:11:56,820
because someone called me out

7611
07:11:56,820 --> 07:11:59,580
um you there's an extra piece of

7612
07:11:59,580 --> 07:12:00,958
information that's factored into the

7613
07:12:00,958 --> 07:12:02,340
signature that's stored in kernel space

7614
07:12:02,340 --> 07:12:04,378
and you know it's not accessible uh well

7615
07:12:04,378 --> 07:12:06,180
okay can I just Brute Force these

7616
07:12:06,180 --> 07:12:08,040
signatures when you can but every time

7617
07:12:08,040 --> 07:12:09,958
you try to do reference one the mmu will

7618
07:12:09,958 --> 07:12:12,058
cross your program so it's a pretty slow

7619
07:12:12,058 --> 07:12:16,020
way to uh uh try and gain code execution

7620
07:12:16,020 --> 07:12:17,580
and depending on the environment of

7621
07:12:17,580 --> 07:12:18,840
course you know crossing the program

7622
07:12:18,840 --> 07:12:20,580
every time you get it wrong it might not

7623
07:12:20,580 --> 07:12:23,100
be a good option

7624
07:12:23,100 --> 07:12:25,020
now of course pack is not kind of

7625
07:12:25,020 --> 07:12:28,020
invaluable uh you can find what's called

7626
07:12:28,020 --> 07:12:30,420
a signing Gadget to get around it so

7627
07:12:30,420 --> 07:12:32,218
this is quite funny this is a snippet of

7628
07:12:32,218 --> 07:12:34,978
assembly again in some trusted code but

7629
07:12:34,978 --> 07:12:36,958
what you'll notice is what this code

7630
07:12:36,958 --> 07:12:38,760
does if you kind of extract you know

7631
07:12:38,760 --> 07:12:41,638
just the right piece of it is it reads a

7632
07:12:41,638 --> 07:12:44,400
pointer from a memory location it signs

7633
07:12:44,400 --> 07:12:46,260
it and then it stores it back in memory

7634
07:12:46,260 --> 07:12:48,058
so if you can find one of these you can

7635
07:12:48,058 --> 07:12:50,100
just sign pointers kind of at will and

7636
07:12:50,100 --> 07:12:51,420
you know you're done you don't have to

7637
07:12:51,420 --> 07:12:53,878
worry about pack anymore

7638
07:12:53,878 --> 07:12:56,700
okay attack number one take over via

7639
07:12:56,700 --> 07:12:58,740
page mapping level one entry

7640
07:12:58,740 --> 07:13:00,718
so in that kind of series of tables that

7641
07:13:00,718 --> 07:13:02,040
we looked at before we had the page

7642
07:13:02,040 --> 07:13:03,660
mapping level four it was the most

7643
07:13:03,660 --> 07:13:06,120
significant 256 terabytes of address

7644
07:13:06,120 --> 07:13:08,580
space then 512 gigabytes one gigabyte

7645
07:13:08,580 --> 07:13:10,798
all the way down to the measly little

7646
07:13:10,798 --> 07:13:13,920
page mapping level one entry which Maps

7647
07:13:13,920 --> 07:13:15,718
four kilobytes of address space so it's

7648
07:13:15,718 --> 07:13:17,540
easily kind of the you know least

7649
07:13:17,540 --> 07:13:20,700
significant uh piece of this

7650
07:13:20,700 --> 07:13:22,080
infrastructure

7651
07:13:22,080 --> 07:13:24,058
and so you might think like okay well if

7652
07:13:24,058 --> 07:13:25,680
an attacker gains access to a page

7653
07:13:25,680 --> 07:13:27,240
mapping level one entry it's only four

7654
07:13:27,240 --> 07:13:29,520
kilobytes no big deal well actually it's

7655
07:13:29,520 --> 07:13:31,500
completely game over because what an

7656
07:13:31,500 --> 07:13:33,420
attacker can do is take this physical

7657
07:13:33,420 --> 07:13:36,298
frame field uh and just override it and

7658
07:13:36,298 --> 07:13:38,520
in doing so they can change you know

7659
07:13:38,520 --> 07:13:39,958
what piece of the address space that

7660
07:13:39,958 --> 07:13:41,638
page mapping level one is referring to

7661
07:13:41,638 --> 07:13:44,820
and scan all the physical memory so you

7662
07:13:44,820 --> 07:13:46,620
know completely game over uh if an

7663
07:13:46,620 --> 07:13:48,058
attacker gains access to a page mapping

7664
07:13:48,058 --> 07:13:50,218
level one entry

7665
07:13:50,218 --> 07:13:53,400
and I'd like to do a demo of this

7666
07:13:53,400 --> 07:13:55,080
um so

7667
07:13:55,080 --> 07:13:57,180
gaining access to a page mapping level

7668
07:13:57,180 --> 07:13:58,620
one entry is something that an operating

7669
07:13:58,620 --> 07:14:01,320
system should never allow you to do so I

7670
07:14:01,320 --> 07:14:03,120
had to get a little bit creative with

7671
07:14:03,120 --> 07:14:05,218
how I was going to demo this uh normally

7672
07:14:05,218 --> 07:14:06,780
you would need like I don't know some

7673
07:14:06,780 --> 07:14:09,420
kind of zero day or you know patch the

7674
07:14:09,420 --> 07:14:12,240
OS to do something naughty I went with

7675
07:14:12,240 --> 07:14:13,920
the patch the OS to do something naughty

7676
07:14:13,920 --> 07:14:16,500
root and I used my own hobby OS for this

7677
07:14:16,500 --> 07:14:17,820
just because it was kind of quick and

7678
07:14:17,820 --> 07:14:20,400
easy for me to uh to do but don't let

7679
07:14:20,400 --> 07:14:22,200
that put you off the concepts are

7680
07:14:22,200 --> 07:14:23,700
completely General it's nothing special

7681
07:14:23,700 --> 07:14:26,280
about my OS it's just what I'm using as

7682
07:14:26,280 --> 07:14:27,958
a test bed

7683
07:14:27,958 --> 07:14:29,820
all right

7684
07:14:29,820 --> 07:14:31,978
so I'm going to boot up my OS in an

7685
07:14:31,978 --> 07:14:34,218
emulator

7686
07:14:35,580 --> 07:14:37,260
I'm gonna go full screen

7687
07:14:37,260 --> 07:14:39,420
the bootloader is pink for technical

7688
07:14:39,420 --> 07:14:41,899
reasons

7689
07:14:43,680 --> 07:14:45,958
cool actually I just triggered a bug

7690
07:14:45,958 --> 07:14:48,540
that was my bad

7691
07:14:48,540 --> 07:14:52,200
sorry I uh there's a bug where if I give

7692
07:14:52,200 --> 07:14:54,900
PS2 Mouse input too early the mouse just

7693
07:14:54,900 --> 07:14:56,878
totally breaks so I jiggled the mouse a

7694
07:14:56,878 --> 07:14:58,260
little bit out of nervousness as it was

7695
07:14:58,260 --> 07:15:00,360
pooping up and uh then I couldn't move

7696
07:15:00,360 --> 07:15:01,740
the cursor anyway hopefully that is

7697
07:15:01,740 --> 07:15:04,138
fixed now excellent also I was worried

7698
07:15:04,138 --> 07:15:06,360
about this the backgrounds are randomly

7699
07:15:06,360 --> 07:15:08,400
generated and sometimes they get a bit

7700
07:15:08,400 --> 07:15:10,260
garish so I'm just gonna

7701
07:15:10,260 --> 07:15:12,958
yeah yeah that's all right okay I'm

7702
07:15:12,958 --> 07:15:15,360
gonna open up this program I've written

7703
07:15:15,360 --> 07:15:16,860
called exploit actually first things

7704
07:15:16,860 --> 07:15:18,540
first I'm going to open up the notepad

7705
07:15:18,540 --> 07:15:21,360
and I'll get some secret into memory so

7706
07:15:21,360 --> 07:15:22,378
my

7707
07:15:22,378 --> 07:15:24,420
secret password

7708
07:15:24,420 --> 07:15:26,458
over there so there's some sensitive

7709
07:15:26,458 --> 07:15:28,558
data just sitting around in memory

7710
07:15:28,558 --> 07:15:31,740
all right let's open up our exploit

7711
07:15:31,740 --> 07:15:34,260
and now what this does on launch is it

7712
07:15:34,260 --> 07:15:36,120
you know it uses this back door that

7713
07:15:36,120 --> 07:15:38,280
I've built in it requests a page mapping

7714
07:15:38,280 --> 07:15:40,080
level one from the kernel and the kernel

7715
07:15:40,080 --> 07:15:41,940
like a dummy has you know given it out

7716
07:15:41,940 --> 07:15:44,760
uh and this attacker program is now

7717
07:15:44,760 --> 07:15:46,378
going to abuse this page mapping level

7718
07:15:46,378 --> 07:15:48,780
one entry to do a full physical memory

7719
07:15:48,780 --> 07:15:51,540
scan of old Ram in the system and it's

7720
07:15:51,540 --> 07:15:53,160
going to be specifically looking for

7721
07:15:53,160 --> 07:15:54,420
strings of course you could do anything

7722
07:15:54,420 --> 07:15:56,160
at this point again it's game over but

7723
07:15:56,160 --> 07:15:57,540
it's going to be looking for Strings and

7724
07:15:57,540 --> 07:15:59,760
printing them out in this window over on

7725
07:15:59,760 --> 07:16:00,600
the left

7726
07:16:00,600 --> 07:16:02,760
so I'm gonna hit this big scary button

7727
07:16:02,760 --> 07:16:04,920
scan memory

7728
07:16:04,920 --> 07:16:07,260
uh and we should see some strings yeah

7729
07:16:07,260 --> 07:16:09,180
appearing over on the left so a lot of

7730
07:16:09,180 --> 07:16:12,180
this is like you know string tables uh

7731
07:16:12,180 --> 07:16:14,400
symbol tables from loaded programs even

7732
07:16:14,400 --> 07:16:17,400
unloaded programs uh but somewhere in

7733
07:16:17,400 --> 07:16:19,558
there eventually we're going to find the

7734
07:16:19,558 --> 07:16:21,360
data that I've entered into this notepad

7735
07:16:21,360 --> 07:16:24,620
over on the right

7736
07:16:25,200 --> 07:16:26,878
cool so this normally takes like a few

7737
07:16:26,878 --> 07:16:29,760
minutes to run so I'm I'm not gonna have

7738
07:16:29,760 --> 07:16:32,580
you sit here as we trust me it's bad

7739
07:16:32,580 --> 07:16:34,638
um

7740
07:16:34,798 --> 07:16:36,298
all right

7741
07:16:36,298 --> 07:16:40,260
Defense number two aslr what is that

7742
07:16:40,260 --> 07:16:42,360
um so going back to this kind of setup

7743
07:16:42,360 --> 07:16:44,400
that we have with three programs loaded

7744
07:16:44,400 --> 07:16:46,200
into memory

7745
07:16:46,200 --> 07:16:48,420
um if we imagine oh yeah so one thing I

7746
07:16:48,420 --> 07:16:50,520
want to point out here is say we've got

7747
07:16:50,520 --> 07:16:52,200
you know some amount of physical RAM

7748
07:16:52,200 --> 07:16:54,540
installed in the system going up to you

7749
07:16:54,540 --> 07:16:58,260
know this is a a few kilobytes of ram

7750
07:16:58,260 --> 07:17:01,080
um but with paging it's really easy and

7751
07:17:01,080 --> 07:17:03,600
natural to make a program think that

7752
07:17:03,600 --> 07:17:05,820
it's loaded you know way higher than the

7753
07:17:05,820 --> 07:17:07,138
amount of physical RAM we actually have

7754
07:17:07,138 --> 07:17:08,700
installed in the system really natural

7755
07:17:08,700 --> 07:17:11,700
trick and even if we have you know

7756
07:17:11,700 --> 07:17:13,620
multiple programs that are all loaded

7757
07:17:13,620 --> 07:17:15,660
into memory we can make them all think

7758
07:17:15,660 --> 07:17:17,040
they're loaded at some high memory

7759
07:17:17,040 --> 07:17:19,138
address even the same address again a

7760
07:17:19,138 --> 07:17:21,540
very natural trick to do with paging so

7761
07:17:21,540 --> 07:17:23,940
this idea of stable load addresses

7762
07:17:23,940 --> 07:17:25,978
but we can ask ourselves are stable load

7763
07:17:25,978 --> 07:17:27,958
addresses such a good thing sure they

7764
07:17:27,958 --> 07:17:30,240
seem convenient and they are but they

7765
07:17:30,240 --> 07:17:31,620
have a kind of nasty security

7766
07:17:31,620 --> 07:17:34,200
implication as well with that Rob attack

7767
07:17:34,200 --> 07:17:36,600
that we looked at a few minutes ago that

7768
07:17:36,600 --> 07:17:38,218
relied on the attacker being able to

7769
07:17:38,218 --> 07:17:40,200
know okay this function is at that

7770
07:17:40,200 --> 07:17:42,120
memory address that function is at this

7771
07:17:42,120 --> 07:17:44,580
other memory address uh and if we have

7772
07:17:44,580 --> 07:17:46,200
stable load addresses the attacker is

7773
07:17:46,200 --> 07:17:47,340
always going to know where these things

7774
07:17:47,340 --> 07:17:49,740
are laid out in memory

7775
07:17:49,740 --> 07:17:53,160
so around like 30 years ago people got

7776
07:17:53,160 --> 07:17:55,500
this great idea of randomizing the

7777
07:17:55,500 --> 07:17:57,478
offset into virtual memory where our

7778
07:17:57,478 --> 07:17:58,978
program is loaded every time it's

7779
07:17:58,978 --> 07:18:00,840
launched and this makes it more

7780
07:18:00,840 --> 07:18:02,700
difficult for the attacker to you know

7781
07:18:02,700 --> 07:18:05,218
get to the things they want to get to

7782
07:18:05,218 --> 07:18:07,260
this is an idea called address-based

7783
07:18:07,260 --> 07:18:09,298
layout randomization or aslr and it's

7784
07:18:09,298 --> 07:18:11,458
just a de facto security practice in

7785
07:18:11,458 --> 07:18:15,298
every contemporary OS not mine so we'll

7786
07:18:15,298 --> 07:18:17,940
get there someday but

7787
07:18:17,940 --> 07:18:19,860
um all right moving on to attack number

7788
07:18:19,860 --> 07:18:22,200
two dirty cow

7789
07:18:22,200 --> 07:18:23,638
and again the path here is going to be

7790
07:18:23,638 --> 07:18:25,260
we're going to do a little bit of

7791
07:18:25,260 --> 07:18:27,478
background on page faults then we're

7792
07:18:27,478 --> 07:18:29,160
going to look at this cool feature that

7793
07:18:29,160 --> 07:18:31,558
we can do called cow and then we'll take

7794
07:18:31,558 --> 07:18:34,260
a look at the attack itself dirty cow

7795
07:18:34,260 --> 07:18:36,000
okay how many times has this happened to

7796
07:18:36,000 --> 07:18:37,680
you you're you know running some program

7797
07:18:37,680 --> 07:18:39,600
you're doing some really awesome

7798
07:18:39,600 --> 07:18:41,400
computation and then right at the

7799
07:18:41,400 --> 07:18:43,020
critical moment you get this message

7800
07:18:43,020 --> 07:18:45,360
segmentation fault what does that mean

7801
07:18:45,360 --> 07:18:47,280
and you know why is it stopping me from

7802
07:18:47,280 --> 07:18:49,500
doing the things I want to do uh well

7803
07:18:49,500 --> 07:18:50,580
before I move on any further

7804
07:18:50,580 --> 07:18:52,798
segmentation is like a precursor to

7805
07:18:52,798 --> 07:18:55,020
paging you can just read paging Vault

7806
07:18:55,020 --> 07:18:57,360
here it's effectively synonymous the

7807
07:18:57,360 --> 07:19:00,058
terminology is confusing uh We've

7808
07:19:00,058 --> 07:19:02,280
accessed some invalid memory and the OS

7809
07:19:02,280 --> 07:19:04,320
has decided to kill our program maybe

7810
07:19:04,320 --> 07:19:06,058
we've like dereferenced the null pointer

7811
07:19:06,058 --> 07:19:08,760
there's some something wrong somewhere

7812
07:19:08,760 --> 07:19:11,638
and we can ask ourselves well why does

7813
07:19:11,638 --> 07:19:13,558
dereferencing the null pointer actually

7814
07:19:13,558 --> 07:19:16,020
cause a crash what's up with that

7815
07:19:16,020 --> 07:19:17,580
yeah so we can ask ourselves why does

7816
07:19:17,580 --> 07:19:19,080
this crash I've written a tiny bit of C

7817
07:19:19,080 --> 07:19:20,638
here to just you know demonstrate the

7818
07:19:20,638 --> 07:19:22,740
core of this idea

7819
07:19:22,740 --> 07:19:24,900
um I don't really recommend anyone

7820
07:19:24,900 --> 07:19:26,878
writes more Scene than this this is

7821
07:19:26,878 --> 07:19:28,378
probably four or five lines that's

7822
07:19:28,378 --> 07:19:30,540
probably the limit but it's useful for

7823
07:19:30,540 --> 07:19:33,420
illustration so here we're you know uh

7824
07:19:33,420 --> 07:19:34,978
just de-referencing the null pointer and

7825
07:19:34,978 --> 07:19:36,420
writing some data to it and again the

7826
07:19:36,420 --> 07:19:38,540
question is why does this crash

7827
07:19:38,540 --> 07:19:42,360
well the virtual address for you know

7828
07:19:42,360 --> 07:19:44,040
address zero there's nothing special

7829
07:19:44,040 --> 07:19:45,600
about it it's just a virtual address

7830
07:19:45,600 --> 07:19:47,580
like any other and just like every other

7831
07:19:47,580 --> 07:19:50,040
virtual address it has you know this

7832
07:19:50,040 --> 07:19:52,020
decomposition and we can follow those

7833
07:19:52,020 --> 07:19:55,740
page tables and uh read what's been set

7834
07:19:55,740 --> 07:19:57,840
up there and what you'll find is that

7835
07:19:57,840 --> 07:20:00,298
operating systems actually intentionally

7836
07:20:00,298 --> 07:20:02,100
mark this page as you know not readable

7837
07:20:02,100 --> 07:20:03,958
not writable not executable just

7838
07:20:03,958 --> 07:20:06,000
unmapped and this is actually a feature

7839
07:20:06,000 --> 07:20:09,000
this is intended to help you catch bugs

7840
07:20:09,000 --> 07:20:10,378
because you know if you're doing

7841
07:20:10,378 --> 07:20:11,760
something with a null pointer you've

7842
07:20:11,760 --> 07:20:13,978
probably gone wrong uh and I think it's

7843
07:20:13,978 --> 07:20:15,840
it's really cool that there's no magic

7844
07:20:15,840 --> 07:20:18,240
here it's uh just just a kind of cool

7845
07:20:18,240 --> 07:20:20,520
trick that people put in to catch this

7846
07:20:20,520 --> 07:20:23,218
common failure scenario

7847
07:20:23,218 --> 07:20:25,378
and what's really cool is that it

7848
07:20:25,378 --> 07:20:27,058
doesn't have nothing is mandating that

7849
07:20:27,058 --> 07:20:28,680
the no pointer is set up this way so

7850
07:20:28,680 --> 07:20:30,058
this is a screenshot from a binary

7851
07:20:30,058 --> 07:20:31,620
analysis tool that I maintain at work

7852
07:20:31,620 --> 07:20:34,920
and you can see that in a binary

7853
07:20:34,920 --> 07:20:36,718
before it's loaded it'll give

7854
07:20:36,718 --> 07:20:38,458
instructions to the OS of like what

7855
07:20:38,458 --> 07:20:40,440
memory mappings it should set up this is

7856
07:20:40,440 --> 07:20:42,780
a mac o and Macos have this segment page

7857
07:20:42,780 --> 07:20:45,058
zero and so this binary is telling the

7858
07:20:45,058 --> 07:20:47,100
OS hey when you load me into memory when

7859
07:20:47,100 --> 07:20:49,740
you launch me uh set up this whole

7860
07:20:49,740 --> 07:20:52,320
bottom region of the address space call

7861
07:20:52,320 --> 07:20:53,878
it page zero and just give it no

7862
07:20:53,878 --> 07:20:55,680
permissions again this is like an

7863
07:20:55,680 --> 07:20:57,138
intentional thing that people are doing

7864
07:20:57,138 --> 07:20:59,580
to prevent you from kind of shooting

7865
07:20:59,580 --> 07:21:01,798
yourself in the foot and what I think is

7866
07:21:01,798 --> 07:21:04,138
fun is that if you want to you can

7867
07:21:04,138 --> 07:21:05,700
create a binary that doesn't have this

7868
07:21:05,700 --> 07:21:07,260
page zero segment or that has different

7869
07:21:07,260 --> 07:21:08,878
permissions on it and then you can just

7870
07:21:08,878 --> 07:21:10,620
read and write to the no pointer at will

7871
07:21:10,620 --> 07:21:13,200
I'm not sure why you would do this aside

7872
07:21:13,200 --> 07:21:15,900
from you know laughs but you can which

7873
07:21:15,900 --> 07:21:18,378
is cool

7874
07:21:19,020 --> 07:21:22,200
okay so going back to this uh idea that

7875
07:21:22,200 --> 07:21:24,120
we saw segmentation fault the OS has

7876
07:21:24,120 --> 07:21:26,160
killed our program we can go a little

7877
07:21:26,160 --> 07:21:27,780
bit deeper like what is going on here

7878
07:21:27,780 --> 07:21:29,878
the OS has killed our program but how

7879
07:21:29,878 --> 07:21:31,680
did we even know that something has gone

7880
07:21:31,680 --> 07:21:33,600
wrong

7881
07:21:33,600 --> 07:21:36,420
well if we access some invalid memory

7882
07:21:36,420 --> 07:21:38,820
address what's going to happen is the

7883
07:21:38,820 --> 07:21:41,940
CPU is going to stop and jump to some

7884
07:21:41,940 --> 07:21:43,920
you know pre-selected code that the

7885
07:21:43,920 --> 07:21:45,478
operating system is set up called an

7886
07:21:45,478 --> 07:21:47,400
exception Handler so anytime you access

7887
07:21:47,400 --> 07:21:49,558
an invalid address the CPU will jump to

7888
07:21:49,558 --> 07:21:51,840
its exception Handler uh it'll have like

7889
07:21:51,840 --> 07:21:54,120
uh an error code that discriminates on

7890
07:21:54,120 --> 07:21:56,040
what kind of error happened this is used

7891
07:21:56,040 --> 07:21:57,660
for all kinds of things this is like if

7892
07:21:57,660 --> 07:22:00,360
you try to divide divide by zero uh yeah

7893
07:22:00,360 --> 07:22:02,878
if you access invalid memory

7894
07:22:02,878 --> 07:22:05,458
um various other failure cases

7895
07:22:05,458 --> 07:22:08,280
and the OS then gets to decide what to

7896
07:22:08,280 --> 07:22:10,080
do here so the in the example we looked

7897
07:22:10,080 --> 07:22:11,820
at the OS uses this as an opportunity

7898
07:22:11,820 --> 07:22:13,978
it's like okay you've accessed some bad

7899
07:22:13,978 --> 07:22:15,478
memory I'm just going to stop you from

7900
07:22:15,478 --> 07:22:17,710
running I'm going to kill the process

7901
07:22:17,710 --> 07:22:18,540
[Music]

7902
07:22:18,540 --> 07:22:19,620
um

7903
07:22:19,620 --> 07:22:23,040
okay moving on to cow so

7904
07:22:23,040 --> 07:22:24,840
maybe you're familiar with fork the

7905
07:22:24,840 --> 07:22:27,420
system call that when you execute it it

7906
07:22:27,420 --> 07:22:29,760
creates like a duplicate of your process

7907
07:22:29,760 --> 07:22:31,378
and all of its you know address space

7908
07:22:31,378 --> 07:22:33,840
and uh everything else and then the only

7909
07:22:33,840 --> 07:22:35,700
kind of difference between these two

7910
07:22:35,700 --> 07:22:38,040
processes is the return value of fork

7911
07:22:38,040 --> 07:22:39,900
itself and this is how you know okay am

7912
07:22:39,900 --> 07:22:41,878
I the one that called fork or am I that

7913
07:22:41,878 --> 07:22:44,580
new process that started up

7914
07:22:44,580 --> 07:22:47,218
and so when Fork runs you know all of

7915
07:22:47,218 --> 07:22:49,620
the address space mappings that are in

7916
07:22:49,620 --> 07:22:51,180
the parent process are going to need to

7917
07:22:51,180 --> 07:22:54,120
be duplicated uh into the child and this

7918
07:22:54,120 --> 07:22:56,458
is pretty expensive it can really you

7919
07:22:56,458 --> 07:22:59,820
know Fork is not the best idea

7920
07:22:59,820 --> 07:23:01,978
unfortunately we're stuck with it and

7921
07:23:01,978 --> 07:23:03,180
this is just one of the reasons it's

7922
07:23:03,180 --> 07:23:05,218
really expensive there's a number of

7923
07:23:05,218 --> 07:23:07,138
others that I won't go into now but um

7924
07:23:07,138 --> 07:23:09,958
yeah we've we've got to use it so is

7925
07:23:09,958 --> 07:23:11,340
there any way since we're stuck with it

7926
07:23:11,340 --> 07:23:12,780
is there any way we can make it faster

7927
07:23:12,780 --> 07:23:14,458
is there any way we can make Fork less

7928
07:23:14,458 --> 07:23:15,478
painful

7929
07:23:15,478 --> 07:23:19,080
well not all of these memory regions are

7930
07:23:19,080 --> 07:23:21,120
going to change the code segment for

7931
07:23:21,120 --> 07:23:23,040
example it's read-only we don't need to

7932
07:23:23,040 --> 07:23:24,958
duplicate the memory we can just have

7933
07:23:24,958 --> 07:23:27,600
you know one mapping and then

7934
07:23:27,600 --> 07:23:29,700
set up that you know the same frame in

7935
07:23:29,700 --> 07:23:32,520
both virtual address spaces again a very

7936
07:23:32,520 --> 07:23:33,958
natural trick to do with the

7937
07:23:33,958 --> 07:23:35,458
infrastructure that paging provides for

7938
07:23:35,458 --> 07:23:37,200
you

7939
07:23:37,200 --> 07:23:38,760
but it would be nice if we could do even

7940
07:23:38,760 --> 07:23:40,620
more and of course there is this idea

7941
07:23:40,620 --> 07:23:41,940
called cow

7942
07:23:41,940 --> 07:23:44,580
so the idea here is that of course these

7943
07:23:44,580 --> 07:23:46,080
processes the parent and child they're

7944
07:23:46,080 --> 07:23:47,400
going to do different things you know

7945
07:23:47,400 --> 07:23:48,540
they're going to allocate differently

7946
07:23:48,540 --> 07:23:51,240
but we don't know up front what they're

7947
07:23:51,240 --> 07:23:52,798
going to do differently we don't know

7948
07:23:52,798 --> 07:23:55,500
kind of uh where the allocations are

7949
07:23:55,500 --> 07:23:56,940
going to be different and the heaps of

7950
07:23:56,940 --> 07:23:59,298
these are you know split up into Pages

7951
07:23:59,298 --> 07:24:02,280
like anything else and so we can do a

7952
07:24:02,280 --> 07:24:03,718
really cool trick here

7953
07:24:03,718 --> 07:24:06,540
uh yeah so right

7954
07:24:06,540 --> 07:24:09,120
some pages may change in the child some

7955
07:24:09,120 --> 07:24:11,520
pages may change in the parent but we

7956
07:24:11,520 --> 07:24:13,920
don't know you know prefactor what's

7957
07:24:13,920 --> 07:24:15,540
going to change so we need some kind of

7958
07:24:15,540 --> 07:24:17,520
system that's going to allow us to react

7959
07:24:17,520 --> 07:24:20,280
uh dynamically

7960
07:24:20,280 --> 07:24:22,740
so the trick here uh it's just a hack

7961
07:24:22,740 --> 07:24:25,920
but it is cool prior to the fork you

7962
07:24:25,920 --> 07:24:27,298
know you've got a heap it's got a bunch

7963
07:24:27,298 --> 07:24:29,400
of writable pages and then when you call

7964
07:24:29,400 --> 07:24:31,860
Fork we can downgrade all of those pages

7965
07:24:31,860 --> 07:24:33,360
to read only

7966
07:24:33,360 --> 07:24:36,000
okay how does that help us well when

7967
07:24:36,000 --> 07:24:37,500
someone tries to write to one of those

7968
07:24:37,500 --> 07:24:39,058
pages because they're you know doing a

7969
07:24:39,058 --> 07:24:40,860
new Heap allocation uh in the child or

7970
07:24:40,860 --> 07:24:42,718
in the parent or wherever

7971
07:24:42,718 --> 07:24:45,420
we'll jump to that page fault Handler

7972
07:24:45,420 --> 07:24:47,400
that we had to look at a moment ago you

7973
07:24:47,400 --> 07:24:48,660
know before when we looked at this it

7974
07:24:48,660 --> 07:24:50,580
was like hey hey you're doing an invalid

7975
07:24:50,580 --> 07:24:53,040
memory invalid memory access I'm going

7976
07:24:53,040 --> 07:24:55,080
to kill the program but that's not all

7977
07:24:55,080 --> 07:24:56,940
we can do we can actually use it as a

7978
07:24:56,940 --> 07:24:58,920
springboard for features so in this case

7979
07:24:58,920 --> 07:25:01,320
we can say okay okay we're in this

7980
07:25:01,320 --> 07:25:03,298
special case where we forked and then we

7981
07:25:03,298 --> 07:25:05,580
downgraded to read only and now you're

7982
07:25:05,580 --> 07:25:08,280
you know accessing it again and what we

7983
07:25:08,280 --> 07:25:10,500
can do is we can use the opportunity to

7984
07:25:10,500 --> 07:25:12,660
create a copy just of this page that's

7985
07:25:12,660 --> 07:25:15,540
been changed so the memory between the

7986
07:25:15,540 --> 07:25:17,458
parent and child is shared until it's

7987
07:25:17,458 --> 07:25:19,740
proven that it can't be shared this idea

7988
07:25:19,740 --> 07:25:21,798
is called copy on write or cow an

7989
07:25:21,798 --> 07:25:24,540
important performance optimization that

7990
07:25:24,540 --> 07:25:26,878
makes Fork kind of usable

7991
07:25:26,878 --> 07:25:29,160
um and dirty cow it's a it's an

7992
07:25:29,160 --> 07:25:31,920
implementation flaw in linux's version

7993
07:25:31,920 --> 07:25:34,260
of cow and what's crazy about this is it

7994
07:25:34,260 --> 07:25:37,378
persisted for 10 years uh and from the

7995
07:25:37,378 --> 07:25:38,820
commit messages it seems like I actually

7996
07:25:38,820 --> 07:25:40,500
knew about this you know 10 years in the

7997
07:25:40,500 --> 07:25:42,540
past uh I don't know why they didn't fix

7998
07:25:42,540 --> 07:25:43,798
it I'm sure there's some history there

7999
07:25:43,798 --> 07:25:44,940
but

8000
07:25:44,940 --> 07:25:48,958
um yeah it uh was pretty pretty bad it

8001
07:25:48,958 --> 07:25:50,760
allowed an attacker to overwrite code of

8002
07:25:50,760 --> 07:25:53,160
set uid root binaries so again just a

8003
07:25:53,160 --> 07:25:54,840
game over scenario it allowed you to

8004
07:25:54,840 --> 07:25:56,218
write memory that only should be

8005
07:25:56,218 --> 07:25:57,540
readable

8006
07:25:57,540 --> 07:25:59,040
um pretty pretty scary but it's fixed

8007
07:25:59,040 --> 07:26:01,620
now so Smiles all around

8008
07:26:01,620 --> 07:26:02,820
um

8009
07:26:02,820 --> 07:26:05,638
all right Defense number three NX or no

8010
07:26:05,638 --> 07:26:06,958
execute

8011
07:26:06,958 --> 07:26:08,760
okay so if we think about the address

8012
07:26:08,760 --> 07:26:10,740
space mappings of a process there's some

8013
07:26:10,740 --> 07:26:12,478
stuff that's going to be common amongst

8014
07:26:12,478 --> 07:26:14,040
every process you've got a code segment

8015
07:26:14,040 --> 07:26:15,840
you've got some static data you've got a

8016
07:26:15,840 --> 07:26:17,340
heap you've got a stack you've got a no

8017
07:26:17,340 --> 07:26:19,740
page as well I didn't bother visualizing

8018
07:26:19,740 --> 07:26:22,200
that here but we all know it's there

8019
07:26:22,200 --> 07:26:23,160
um

8020
07:26:23,160 --> 07:26:25,200
and the stack if we kind of blow that up

8021
07:26:25,200 --> 07:26:27,298
you know increase the the detail there

8022
07:26:27,298 --> 07:26:29,400
it's composed of a number of Stack

8023
07:26:29,400 --> 07:26:31,378
frames and each of these stack frames

8024
07:26:31,378 --> 07:26:33,180
has a base pointer within them which is

8025
07:26:33,180 --> 07:26:34,620
going to kind of point in this neat

8026
07:26:34,620 --> 07:26:37,260
fashion up to the the stack frame that

8027
07:26:37,260 --> 07:26:39,540
you know it came from the caller of

8028
07:26:39,540 --> 07:26:40,978
whatever function we're executing at the

8029
07:26:40,978 --> 07:26:42,058
moment

8030
07:26:42,058 --> 07:26:43,920
this is like the Happy path this is what

8031
07:26:43,920 --> 07:26:45,360
we like to see these are you know

8032
07:26:45,360 --> 07:26:46,620
well-formed stack frames with

8033
07:26:46,620 --> 07:26:48,420
well-formed base pointers that point

8034
07:26:48,420 --> 07:26:51,240
nicely up a chain uh and then the code

8035
07:26:51,240 --> 07:26:54,120
again what we like to see is the code is

8036
07:26:54,120 --> 07:26:56,280
kind of jumping you know all over itself

8037
07:26:56,280 --> 07:26:58,378
so the arrows look a bit funky but this

8038
07:26:58,378 --> 07:27:00,360
is good like all the code is you know in

8039
07:27:00,360 --> 07:27:01,740
the code segment that was set up by the

8040
07:27:01,740 --> 07:27:03,780
binary everything is happy

8041
07:27:03,780 --> 07:27:06,360
but one classic attack is if an attacker

8042
07:27:06,360 --> 07:27:08,160
is able to overflow one of these

8043
07:27:08,160 --> 07:27:10,440
variables uh in a stack frame it can

8044
07:27:10,440 --> 07:27:12,000
overwrite that base pointer and that

8045
07:27:12,000 --> 07:27:14,160
return address and then jump out of the

8046
07:27:14,160 --> 07:27:15,240
code segment into some

8047
07:27:15,240 --> 07:27:17,700
attacker-controlled uh like Shell Code

8048
07:27:17,700 --> 07:27:19,740
that they've set up in the Heap

8049
07:27:19,740 --> 07:27:23,280
classic buffer overflow attack

8050
07:27:23,280 --> 07:27:25,138
so to help mitigate this paging

8051
07:27:25,138 --> 07:27:27,120
infrastructure has given us a new tool

8052
07:27:27,120 --> 07:27:29,160
there's a new bit that was added it's

8053
07:27:29,160 --> 07:27:31,378
called the no execute bit and we can set

8054
07:27:31,378 --> 07:27:33,540
this bit on all of the pages in the Heap

8055
07:27:33,540 --> 07:27:36,000
and stock and now if this no execute bit

8056
07:27:36,000 --> 07:27:38,940
is set the CP the mmu rather will just

8057
07:27:38,940 --> 07:27:42,240
not allow you to execute any code that

8058
07:27:42,240 --> 07:27:43,680
is in a place where it's not supposed to

8059
07:27:43,680 --> 07:27:45,718
be executable totally neuters this kind

8060
07:27:45,718 --> 07:27:47,580
of attack

8061
07:27:47,580 --> 07:27:49,978
um there are legitimate cases where you

8062
07:27:49,978 --> 07:27:52,978
would want to you know dynamically

8063
07:27:52,978 --> 07:27:54,780
generate some code you know on the Heap

8064
07:27:54,780 --> 07:27:56,760
and then jump to it the classic example

8065
07:27:56,760 --> 07:27:59,218
is just in time compilation which is

8066
07:27:59,218 --> 07:28:00,240
super important of course for web

8067
07:28:00,240 --> 07:28:03,120
browsers Etc so there are kind of you

8068
07:28:03,120 --> 07:28:04,920
know affordances that are made to allow

8069
07:28:04,920 --> 07:28:07,080
Jets to continue to work but nonetheless

8070
07:28:07,080 --> 07:28:10,378
very important uh security tool

8071
07:28:10,378 --> 07:28:12,360
yeah so this actually is architecture

8072
07:28:12,360 --> 07:28:14,760
dependent uh but it's available in you

8073
07:28:14,760 --> 07:28:17,600
know the major ones

8074
07:28:17,820 --> 07:28:20,100
all right attack number three tlb info

8075
07:28:20,100 --> 07:28:20,878
leak

8076
07:28:20,878 --> 07:28:22,138
so we're going to do a little bit of

8077
07:28:22,138 --> 07:28:23,820
background on page swaps and cache

8078
07:28:23,820 --> 07:28:25,798
latencies and that'll lead us to uh the

8079
07:28:25,798 --> 07:28:28,040
info leak itself

8080
07:28:28,040 --> 07:28:31,378
so one kind of failure case is we have

8081
07:28:31,378 --> 07:28:33,120
all of our physical memory and all of it

8082
07:28:33,120 --> 07:28:35,520
is in use everything is allocated uh

8083
07:28:35,520 --> 07:28:37,320
okay how do we deal with this can we

8084
07:28:37,320 --> 07:28:39,120
create more space somehow well yes we

8085
07:28:39,120 --> 07:28:40,558
can there's a trick we can do we can

8086
07:28:40,558 --> 07:28:42,360
pick a page maybe or a frame rather

8087
07:28:42,360 --> 07:28:44,458
maybe one that hasn't been accessed in

8088
07:28:44,458 --> 07:28:46,740
some time and we can say okay we're

8089
07:28:46,740 --> 07:28:48,360
going to copy all of your contents to

8090
07:28:48,360 --> 07:28:50,160
disk and then we're going to do the same

8091
07:28:50,160 --> 07:28:51,780
thing we did with copy on right where we

8092
07:28:51,780 --> 07:28:54,058
mark it as like not accessible then when

8093
07:28:54,058 --> 07:28:56,340
someone tries to access it we will you

8094
07:28:56,340 --> 07:28:58,260
know go back into that exception Handler

8095
07:28:58,260 --> 07:29:00,120
we'll say like oh okay you know I'm

8096
07:29:00,120 --> 07:29:02,400
doing something special here we can read

8097
07:29:02,400 --> 07:29:04,558
it back from disk and this allows us to

8098
07:29:04,558 --> 07:29:07,440
kind of create more space for ourselves

8099
07:29:07,440 --> 07:29:09,900
uh this is called page swapping and it

8100
07:29:09,900 --> 07:29:11,218
leads us to this kind of really cool

8101
07:29:11,218 --> 07:29:14,638
conceptual idea which is that Ram just

8102
07:29:14,638 --> 07:29:17,400
becomes like another layer of caching so

8103
07:29:17,400 --> 07:29:18,840
you have the really fast and small

8104
07:29:18,840 --> 07:29:20,878
caches on die and then you have Ram

8105
07:29:20,878 --> 07:29:22,260
which is like you know bigger and slower

8106
07:29:22,260 --> 07:29:24,298
and then the hard drive is what

8107
07:29:24,298 --> 07:29:26,040
represents your kind of true memory

8108
07:29:26,040 --> 07:29:27,780
limit because you can just keep swapping

8109
07:29:27,780 --> 07:29:29,760
out you know as long as you like of

8110
07:29:29,760 --> 07:29:31,620
course this isn't totally true we still

8111
07:29:31,620 --> 07:29:34,020
care about Ram uh but it's a neat idea

8112
07:29:34,020 --> 07:29:36,558
nonetheless

8113
07:29:37,558 --> 07:29:39,660
okay so this

8114
07:29:39,660 --> 07:29:41,760
memory access diagram that we had a look

8115
07:29:41,760 --> 07:29:44,340
at before you know the CPU requests an

8116
07:29:44,340 --> 07:29:46,320
address and then it goes to the mmu the

8117
07:29:46,320 --> 07:29:48,240
mmu consults of what those paging

8118
07:29:48,240 --> 07:29:49,860
structures and then finally it goes to

8119
07:29:49,860 --> 07:29:51,958
Ram the thing is accessing all those

8120
07:29:51,958 --> 07:29:53,280
structures you know we've got multiple

8121
07:29:53,280 --> 07:29:54,958
levels to walk through that's a lot of

8122
07:29:54,958 --> 07:29:57,180
pointers uh for the mmu to walk every

8123
07:29:57,180 --> 07:29:59,520
time we need to access an address and

8124
07:29:59,520 --> 07:30:02,100
it's expensive so many years ago CPU

8125
07:30:02,100 --> 07:30:04,020
designers added an optimization to this

8126
07:30:04,020 --> 07:30:07,080
there's instead this new very fast on

8127
07:30:07,080 --> 07:30:09,420
die cache called the tlb so anytime the

8128
07:30:09,420 --> 07:30:11,700
mmu does the work of like taking this

8129
07:30:11,700 --> 07:30:13,798
address and then figuring out where it

8130
07:30:13,798 --> 07:30:16,080
maps to it'll cache the result in this

8131
07:30:16,080 --> 07:30:19,020
tlb uh and then when you ask for that

8132
07:30:19,020 --> 07:30:21,660
same address again it can just say oh I

8133
07:30:21,660 --> 07:30:22,920
know where this address is I've seen it

8134
07:30:22,920 --> 07:30:26,340
recently I'll pull it from the tlb cache

8135
07:30:26,340 --> 07:30:28,920
and this is great it's very fast the

8136
07:30:28,920 --> 07:30:32,878
problem well problem is that it's very

8137
07:30:32,878 --> 07:30:33,840
fast

8138
07:30:33,840 --> 07:30:36,120
and what this means is that an attacker

8139
07:30:36,120 --> 07:30:38,040
can use it as a side Channel they can

8140
07:30:38,040 --> 07:30:39,780
time how long memory addresses are

8141
07:30:39,780 --> 07:30:42,058
taking and you know from that they're

8142
07:30:42,058 --> 07:30:44,458
able to infer okay was it in the tlb was

8143
07:30:44,458 --> 07:30:47,878
it not and via some Blackmagic which I

8144
07:30:47,878 --> 07:30:50,040
have no idea how it works this actually

8145
07:30:50,040 --> 07:30:53,878
allows you to read crypto Secrets insane

8146
07:30:53,878 --> 07:30:56,160
um it seems like the people who did this

8147
07:30:56,160 --> 07:30:58,320
came up with two names for the

8148
07:30:58,320 --> 07:31:00,180
vulnerability so

8149
07:31:00,180 --> 07:31:01,860
I don't know which one

8150
07:31:01,860 --> 07:31:04,558
to to say uh I think they just you know

8151
07:31:04,558 --> 07:31:05,878
thought of both and then they were like

8152
07:31:05,878 --> 07:31:07,860
oh we can't how are we going to choose

8153
07:31:07,860 --> 07:31:09,660
between these two so they just use both

8154
07:31:09,660 --> 07:31:12,120
good for them anyway TL bleed and

8155
07:31:12,120 --> 07:31:14,070
translation leak a side buffer

8156
07:31:14,070 --> 07:31:15,780
[Music]

8157
07:31:15,780 --> 07:31:19,740
all right attack number four row hammer

8158
07:31:19,740 --> 07:31:21,660
so I'd like to give a quick demo just to

8159
07:31:21,660 --> 07:31:23,100
drive home this concept of process

8160
07:31:23,100 --> 07:31:24,540
isolation actually I shouldn't have

8161
07:31:24,540 --> 07:31:28,580
killed this uh no worries

8162
07:31:30,180 --> 07:31:32,780
so every process in an operating system

8163
07:31:32,780 --> 07:31:35,280
gets its own address space you know its

8164
07:31:35,280 --> 07:31:37,020
own set of kind of mappings of where

8165
07:31:37,020 --> 07:31:39,180
things are and I can't access the memory

8166
07:31:39,180 --> 07:31:41,760
of other processes this is a super

8167
07:31:41,760 --> 07:31:43,920
important characteristic uh of paging

8168
07:31:43,920 --> 07:31:45,420
you know one of the main justifications

8169
07:31:45,420 --> 07:31:47,760
for why we do this is memory isolation

8170
07:31:47,760 --> 07:31:50,400
between processes

8171
07:31:50,400 --> 07:31:52,200
um so I've got this program that I've

8172
07:31:52,200 --> 07:31:53,280
made this virtual address space

8173
07:31:53,280 --> 07:31:54,840
visualizer

8174
07:31:54,840 --> 07:31:56,940
and if we load a program like I'll open

8175
07:31:56,940 --> 07:31:58,680
Doom here

8176
07:31:58,680 --> 07:32:00,660
and we can see you know when Doom loads

8177
07:32:00,660 --> 07:32:02,280
we've got this new address space that's

8178
07:32:02,280 --> 07:32:04,020
popped up and it's got all the regions

8179
07:32:04,020 --> 07:32:05,458
you know you would expect it's got a

8180
07:32:05,458 --> 07:32:07,138
code segment oh

8181
07:32:07,138 --> 07:32:09,478
the virtual address space visualizer

8182
07:32:09,478 --> 07:32:12,478
just crashed that's the fun of hobby OS

8183
07:32:12,478 --> 07:32:15,478
let's see if I reopen that

8184
07:32:15,478 --> 07:32:17,160
okay

8185
07:32:17,160 --> 07:32:19,440
I'll try to make this quick

8186
07:32:19,440 --> 07:32:21,058
um yeah we've got the code segment we've

8187
07:32:21,058 --> 07:32:22,200
got a

8188
07:32:22,200 --> 07:32:25,020
a heap a stack and then some other

8189
07:32:25,020 --> 07:32:26,700
things which are more OS specific like

8190
07:32:26,700 --> 07:32:28,680
that seven megabyte region is a is a

8191
07:32:28,680 --> 07:32:30,120
frame buffer that it's using to talk to

8192
07:32:30,120 --> 07:32:32,160
the window manager the 64 megabyte

8193
07:32:32,160 --> 07:32:34,978
region is a IPC delivery space the

8194
07:32:34,978 --> 07:32:36,718
details aren't important uh what is

8195
07:32:36,718 --> 07:32:38,580
important is that every process is

8196
07:32:38,580 --> 07:32:40,020
isolated

8197
07:32:40,020 --> 07:32:41,820
um

8198
07:32:41,820 --> 07:32:44,360
okay

8199
07:32:44,860 --> 07:32:48,060
[Music]

8200
07:32:48,660 --> 07:32:51,180
so the memory on a chip it's basically

8201
07:32:51,180 --> 07:32:53,458
just a huge collection of capacitors

8202
07:32:53,458 --> 07:32:55,978
just a huge grid of capacitors that can

8203
07:32:55,978 --> 07:32:57,840
either be you know charge high or charge

8204
07:32:57,840 --> 07:32:59,700
low and this represents whether the bit

8205
07:32:59,700 --> 07:33:01,680
is one or zero of course

8206
07:33:01,680 --> 07:33:03,840
and any capacitor if you don't kind of

8207
07:33:03,840 --> 07:33:05,700
chop it up with more electricity it'll

8208
07:33:05,700 --> 07:33:08,160
naturally leak so all of your Ones Will

8209
07:33:08,160 --> 07:33:10,260
Decay to zeros

8210
07:33:10,260 --> 07:33:13,138
so what memory controllers do is every

8211
07:33:13,138 --> 07:33:16,080
memory refresh interval normally 64

8212
07:33:16,080 --> 07:33:18,958
milliseconds it'll just juice up all of

8213
07:33:18,958 --> 07:33:21,240
the capacitors so that the one stay ones

8214
07:33:21,240 --> 07:33:24,298
uh and nothing kind of decays

8215
07:33:24,298 --> 07:33:25,200
um

8216
07:33:25,200 --> 07:33:27,478
okay one more detail is that if you want

8217
07:33:27,478 --> 07:33:28,798
to read a particular memory address

8218
07:33:28,798 --> 07:33:30,780
because of the way the circuitry works

8219
07:33:30,780 --> 07:33:33,058
it goes through this procedure where it

8220
07:33:33,058 --> 07:33:36,540
discharges all of the capacitors in the

8221
07:33:36,540 --> 07:33:38,458
the same row as the memory addresses

8222
07:33:38,458 --> 07:33:39,840
you're trying to read then it'll read

8223
07:33:39,840 --> 07:33:41,638
the value that you that you want to read

8224
07:33:41,638 --> 07:33:44,400
and then it'll recharge all of those

8225
07:33:44,400 --> 07:33:45,540
capacitors

8226
07:33:45,540 --> 07:33:47,760
and what some researchers found in like

8227
07:33:47,760 --> 07:33:50,940
2014 is that if you're able to do this

8228
07:33:50,940 --> 07:33:52,620
you know reading this row which does the

8229
07:33:52,620 --> 07:33:55,020
discharge and then the recharge uh

8230
07:33:55,020 --> 07:33:57,718
thousands of times before uh the memory

8231
07:33:57,718 --> 07:33:59,520
controller has a chance to do that

8232
07:33:59,520 --> 07:34:01,680
refresh thing where it'll you know pump

8233
07:34:01,680 --> 07:34:04,080
up all the voltage levels you can cause

8234
07:34:04,080 --> 07:34:06,958
a bit in an adjacent row to discharge

8235
07:34:06,958 --> 07:34:09,478
and flip from a one to a zero or from a

8236
07:34:09,478 --> 07:34:11,820
zero to a one if uh the gym is doing

8237
07:34:11,820 --> 07:34:13,740
some weird thing where ones are low

8238
07:34:13,740 --> 07:34:16,020
anyway details

8239
07:34:16,020 --> 07:34:17,040
um

8240
07:34:17,040 --> 07:34:19,138
this is terrifying

8241
07:34:19,138 --> 07:34:23,280
because what if those two lines in the

8242
07:34:23,280 --> 07:34:26,400
dim are actually referring to the memory

8243
07:34:26,400 --> 07:34:28,978
of two separate processes so I'm doing a

8244
07:34:28,978 --> 07:34:31,260
bunch of reads in one process and this

8245
07:34:31,260 --> 07:34:33,240
is causing a right somewhere else it's

8246
07:34:33,240 --> 07:34:36,120
really bad it violates some core and

8247
07:34:36,120 --> 07:34:39,000
variants that about both paging and RAM

8248
07:34:39,000 --> 07:34:41,340
itself so the paging invariant is that

8249
07:34:41,340 --> 07:34:42,958
accessing memory in one address space

8250
07:34:42,958 --> 07:34:45,298
doesn't you know cause anything funky in

8251
07:34:45,298 --> 07:34:47,280
other address spaces and it also

8252
07:34:47,280 --> 07:34:49,400
violates random variants so

8253
07:34:49,400 --> 07:34:52,020
assessing and address only accesses one

8254
07:34:52,020 --> 07:34:54,900
address and reads don't cause rights all

8255
07:34:54,900 --> 07:34:56,820
of these are broken terrifying attack

8256
07:34:56,820 --> 07:35:00,478
and uh first publicized in 2014 and

8257
07:35:00,478 --> 07:35:02,340
people had a lot of fun kind of carrying

8258
07:35:02,340 --> 07:35:05,160
out row Hammer it's called row Hammer

8259
07:35:05,160 --> 07:35:07,200
um in a variety of contacts like you

8260
07:35:07,200 --> 07:35:09,600
know in browsers on smartphones anywhere

8261
07:35:09,600 --> 07:35:10,860
you can think of

8262
07:35:10,860 --> 07:35:12,780
this was caused by the way because the

8263
07:35:12,780 --> 07:35:14,820
dim manufacturers kept trying to cram

8264
07:35:14,820 --> 07:35:17,160
more and more capacitors uh into you

8265
07:35:17,160 --> 07:35:18,420
know very small spaces to increase

8266
07:35:18,420 --> 07:35:20,520
memory densities but then you get these

8267
07:35:20,520 --> 07:35:22,200
kind of circuit level interference

8268
07:35:22,200 --> 07:35:24,680
problems

8269
07:35:24,958 --> 07:35:27,660
okay so one really scary attack that you

8270
07:35:27,660 --> 07:35:29,160
can do this was demonstrated by Google

8271
07:35:29,160 --> 07:35:32,160
project zero in 2015 is that if the bit

8272
07:35:32,160 --> 07:35:34,558
you're able to flip via this attack

8273
07:35:34,558 --> 07:35:36,840
is in one of those page mapping level

8274
07:35:36,840 --> 07:35:39,360
one entries you can carry out that full

8275
07:35:39,360 --> 07:35:41,340
physical memory takeover that I demoed

8276
07:35:41,340 --> 07:35:42,958
earlier

8277
07:35:42,958 --> 07:35:43,978
um

8278
07:35:43,978 --> 07:35:46,500
so I'd like to give a demo uh of a bro

8279
07:35:46,500 --> 07:35:48,718
hammer now this is not in my OS it's in

8280
07:35:48,718 --> 07:35:50,400
Ubuntu

8281
07:35:50,400 --> 07:35:53,280
um and

8282
07:35:53,280 --> 07:35:55,080
I left the machine at home I have a

8283
07:35:55,080 --> 07:35:57,660
video hope that's okay with everyone

8284
07:35:57,660 --> 07:35:58,680
um

8285
07:35:58,680 --> 07:36:01,020
so I'm going to pull that up

8286
07:36:01,020 --> 07:36:04,440
okay so this demo is real and by that I

8287
07:36:04,440 --> 07:36:06,718
mean it's real so don't take it too

8288
07:36:06,718 --> 07:36:08,700
seriously the attack is real but I gave

8289
07:36:08,700 --> 07:36:11,280
a lot of help here I did things like uh

8290
07:36:11,280 --> 07:36:13,320
I increased the memory refresh interval

8291
07:36:13,320 --> 07:36:15,600
from 64 milliseconds to an absurdly high

8292
07:36:15,600 --> 07:36:17,878
value giving myself you know tons of

8293
07:36:17,878 --> 07:36:19,978
time to trigger thousands and thousands

8294
07:36:19,978 --> 07:36:21,840
of those reads across a row to give

8295
07:36:21,840 --> 07:36:23,400
myself the best chances of triggering

8296
07:36:23,400 --> 07:36:25,500
rip flips I also gave myself rude

8297
07:36:25,500 --> 07:36:26,820
privileges when I was carrying out this

8298
07:36:26,820 --> 07:36:30,360
attack uh so yeah don't don't take it

8299
07:36:30,360 --> 07:36:32,580
too seriously but it is cool so here

8300
07:36:32,580 --> 07:36:34,260
I've got a program

8301
07:36:34,260 --> 07:36:35,820
um if you can't read the code it's fine

8302
07:36:35,820 --> 07:36:37,740
it doesn't do anything interesting it

8303
07:36:37,740 --> 07:36:39,780
just presents a black screen and then it

8304
07:36:39,780 --> 07:36:42,718
refreshes that black screen in a loop

8305
07:36:42,718 --> 07:36:45,958
so I am going to play this welcome to my

8306
07:36:45,958 --> 07:36:47,940
shirt oh no that's not what that's

8307
07:36:47,940 --> 07:36:50,520
supposed to be okay that's really bad

8308
07:36:50,520 --> 07:36:53,478
um well

8309
07:36:53,580 --> 07:36:55,798
no worries

8310
07:36:55,798 --> 07:36:57,600
okay I'm going to launch this program I

8311
07:36:57,600 --> 07:36:58,920
hope this video is what I think it is

8312
07:36:58,920 --> 07:37:00,780
but I really don't know uh we're gonna

8313
07:37:00,780 --> 07:37:03,180
find out together

8314
07:37:03,180 --> 07:37:04,860
um it launches a black screen and then

8315
07:37:04,860 --> 07:37:06,478
in another process

8316
07:37:06,478 --> 07:37:10,458
I'm just going to be hammering addresses

8317
07:37:10,860 --> 07:37:13,260
and if we're lucky which we are because

8318
07:37:13,260 --> 07:37:16,440
this is a pre-recorded demo

8319
07:37:16,440 --> 07:37:18,180
we're going to be able to cause some bit

8320
07:37:18,180 --> 07:37:20,160
flips uh that should have a visible

8321
07:37:20,160 --> 07:37:23,638
effect in this black frame buffer so

8322
07:37:23,638 --> 07:37:26,100
I don't know are you able to see like

8323
07:37:26,100 --> 07:37:28,620
little white dots uh showing up in this

8324
07:37:28,620 --> 07:37:30,298
black frame buffer I don't know if it

8325
07:37:30,298 --> 07:37:31,740
kind of shows at a distance but they're

8326
07:37:31,740 --> 07:37:33,360
there it's fine

8327
07:37:33,360 --> 07:37:35,400
um so this is actually you know I'm

8328
07:37:35,400 --> 07:37:37,320
doing reads somewhere else and it's

8329
07:37:37,320 --> 07:37:39,540
causing pixels to flip and what's really

8330
07:37:39,540 --> 07:37:41,638
cool about this is you know pixels are

8331
07:37:41,638 --> 07:37:43,740
three or four byte values so depending

8332
07:37:43,740 --> 07:37:45,958
on what bit gets flipped exactly these

8333
07:37:45,958 --> 07:37:47,340
won't just flip from black to white

8334
07:37:47,340 --> 07:37:48,958
they'll flip from like you know maybe

8335
07:37:48,958 --> 07:37:51,660
you'll get a bit that's a bit yellow a

8336
07:37:51,660 --> 07:37:54,000
pixel can be like a bit red uh which I

8337
07:37:54,000 --> 07:37:55,740
thought was a fun thing I wasn't

8338
07:37:55,740 --> 07:37:59,580
expecting as I carried out this attack

8339
07:37:59,580 --> 07:38:02,540
okay

8340
07:38:03,900 --> 07:38:05,878
all right so in review we've talked

8341
07:38:05,878 --> 07:38:08,400
about paging you know how it works why

8342
07:38:08,400 --> 07:38:09,958
we have it we've talked a bit about the

8343
07:38:09,958 --> 07:38:11,820
implementation of it as well

8344
07:38:11,820 --> 07:38:13,020
and then we've looked at some security

8345
07:38:13,020 --> 07:38:14,820
defenses that are built directly on top

8346
07:38:14,820 --> 07:38:17,100
of paging you know pack aslr the no

8347
07:38:17,100 --> 07:38:18,920
execute bit process isolation

8348
07:38:18,920 --> 07:38:21,718
fundamental uh security techniques which

8349
07:38:21,718 --> 07:38:24,000
are directly enabled with pretty much no

8350
07:38:24,000 --> 07:38:26,760
extra work by this really cool idea and

8351
07:38:26,760 --> 07:38:28,260
also some attacks that you can carry out

8352
07:38:28,260 --> 07:38:30,600
on paging uh the physical memory

8353
07:38:30,600 --> 07:38:32,820
takeover via an attacker controlled page

8354
07:38:32,820 --> 07:38:35,878
mapping level one entry we saw the you

8355
07:38:35,878 --> 07:38:37,500
know performance feature of copy on

8356
07:38:37,500 --> 07:38:39,718
write and how implementation flaws can

8357
07:38:39,718 --> 07:38:41,340
lead to really bad attacker scenarios

8358
07:38:41,340 --> 07:38:43,798
like dirty cow we got a bit of a look at

8359
07:38:43,798 --> 07:38:45,718
uh sort of non-security features like

8360
07:38:45,718 --> 07:38:47,580
page swapping and how some of the

8361
07:38:47,580 --> 07:38:49,320
infrastructure there allows attackers to

8362
07:38:49,320 --> 07:38:51,958
leak data in the tlb and finally we uh

8363
07:38:51,958 --> 07:38:54,120
took a look together at a row Hammer

8364
07:38:54,120 --> 07:38:56,280
demo which was not the video I intended

8365
07:38:56,280 --> 07:38:59,580
it to be but hey it all worked out fine

8366
07:38:59,580 --> 07:39:01,500
um okay well thank you all for the

8367
07:39:01,500 --> 07:39:02,520
attention

8368
07:39:02,520 --> 07:39:05,840
uh any questions

8369
07:39:07,680 --> 07:39:10,100
sure

8370
07:39:10,500 --> 07:39:13,280
oh

8371
07:39:13,740 --> 07:39:16,320
thank you is there any way to like

8372
07:39:16,320 --> 07:39:18,718
reliably control row hammer or is it

8373
07:39:18,718 --> 07:39:20,218
just sort of like you're hammering a

8374
07:39:20,218 --> 07:39:21,780
bunch of addresses and hoping you get

8375
07:39:21,780 --> 07:39:22,920
lucky

8376
07:39:22,920 --> 07:39:25,138
yeah it's a good question

8377
07:39:25,138 --> 07:39:28,440
so the thing is some addresses depending

8378
07:39:28,440 --> 07:39:30,478
on you know the the exact dim that

8379
07:39:30,478 --> 07:39:32,280
you've got some addresses are going to

8380
07:39:32,280 --> 07:39:34,020
be kind of more vulnerable to bit flips

8381
07:39:34,020 --> 07:39:36,058
than others so when I did this demo I

8382
07:39:36,058 --> 07:39:37,860
did like a prior analysis of all the

8383
07:39:37,860 --> 07:39:39,600
physical memory in the system and I saw

8384
07:39:39,600 --> 07:39:41,280
like okay this Region's vulnerable that

8385
07:39:41,280 --> 07:39:43,500
Region's vulnerable but even if you know

8386
07:39:43,500 --> 07:39:46,020
up front Okay this is like susceptible

8387
07:39:46,020 --> 07:39:48,360
to flips more than this other piece it's

8388
07:39:48,360 --> 07:39:50,940
still kind of probabilistic

8389
07:39:50,940 --> 07:39:53,940
um so yeah you won't know for sure you

8390
07:39:53,940 --> 07:39:55,860
won't reliably be able to flip this

8391
07:39:55,860 --> 07:39:58,020
exact bit you have to get lucky you have

8392
07:39:58,020 --> 07:40:00,478
to try a few times maybe the heap's not

8393
07:40:00,478 --> 07:40:02,878
in the right set as well uh it's not

8394
07:40:02,878 --> 07:40:05,400
super targeted or reliable in that sense

8395
07:40:05,400 --> 07:40:07,200
but it is you know perfectly good enough

8396
07:40:07,200 --> 07:40:11,058
to carry out all kinds of crazy attacks

8397
07:40:16,080 --> 07:40:18,180
okay cool well thank you all for your

8398
07:40:18,180 --> 07:40:20,420
attention

8399
07:40:24,460 --> 07:40:27,649
[Music]

8400
07:40:37,700 --> 07:40:40,760
thank you

8401
07:40:41,420 --> 07:40:44,559
[Music]

8402
07:40:49,900 --> 07:40:53,029
[Music]

8403
07:40:54,000 --> 07:40:56,660
foreign

8404
07:41:03,540 --> 07:41:06,630
[Music]

8405
07:41:10,130 --> 07:41:13,240
[Music]

8406
07:41:42,298 --> 07:41:45,260
foreign

8407
07:41:57,690 --> 07:42:05,500
[Music]

8408
07:42:10,620 --> 07:42:13,620
foreign

8409
07:42:49,660 --> 07:42:52,770
[Music]

8410
07:43:04,260 --> 07:43:06,377
thank you

8411
07:43:27,490 --> 07:43:30,859
[Music]

8412
07:43:40,740 --> 07:43:43,638
foreign

8413
07:44:10,978 --> 07:44:13,978
foreign

8414
07:44:18,660 --> 07:44:44,760
[Music]

8415
07:44:44,760 --> 07:44:47,760
foreign

8416
07:44:50,770 --> 07:45:24,300
[Music]

8417
07:45:24,920 --> 07:45:26,760
thank you

8418
07:45:26,760 --> 07:45:54,259
[Music]

8419
07:45:54,978 --> 07:45:56,760
thank you

8420
07:45:56,760 --> 07:45:59,760
foreign

8421
07:46:02,770 --> 07:46:32,580
[Music]

8422
07:46:32,580 --> 07:46:35,580
foreign

8423
07:46:38,790 --> 07:46:55,759
[Music]

8424
07:47:07,810 --> 07:47:10,949
[Music]

8425
07:47:13,978 --> 07:47:16,978
foreign

8426
07:47:31,630 --> 07:47:34,779
[Music]

8427
07:47:39,390 --> 07:47:43,489
[Music]

8428
07:47:44,700 --> 07:47:47,700
foreign

8429
07:48:03,710 --> 07:48:08,430
[Music]

8430
07:48:10,920 --> 07:48:13,100
foreign

8431
07:48:17,100 --> 07:48:20,469
[Music]

8432
07:48:27,770 --> 07:48:30,979
[Music]

8433
07:48:42,180 --> 07:48:44,420
foreign

8434
07:48:50,040 --> 07:48:55,840
[Music]

8435
07:48:59,760 --> 07:49:02,859
[Music]

8436
07:49:21,850 --> 07:49:24,930
[Music]

8437
07:49:28,680 --> 07:49:31,580
foreign

8438
07:50:03,840 --> 07:50:06,080
foreign

8439
07:50:16,010 --> 07:50:23,819
[Music]

8440
07:50:38,040 --> 07:50:41,040
foreign

8441
07:51:07,970 --> 07:51:11,069
[Music]

8442
07:51:15,500 --> 07:51:18,500
thank you

8443
07:51:37,860 --> 07:51:40,100
foreign

8444
07:51:45,610 --> 07:51:49,139
[Music]

8445
07:52:07,680 --> 07:52:10,680
foreign

8446
07:52:36,960 --> 07:52:43,558
[Music]

8447
07:52:43,558 --> 07:52:44,660
foreign

8448
07:52:44,660 --> 07:53:14,940
[Music]

8449
07:53:14,940 --> 07:53:17,940
foreign

8450
07:53:21,070 --> 07:53:47,520
[Music]

8451
07:53:47,520 --> 07:53:48,370
foreign

8452
07:53:48,370 --> 07:54:21,000
[Music]

8453
07:54:21,000 --> 07:54:22,580
foreign

8454
07:54:22,580 --> 07:54:55,558
[Music]

8455
07:54:55,558 --> 07:54:57,090
foreign

8456
07:54:57,090 --> 07:55:14,059
[Music]

8457
07:55:32,280 --> 07:55:35,280
foreign

8458
07:55:49,940 --> 07:55:53,090
[Music]

8459
07:55:57,690 --> 07:56:01,800
[Music]

8460
07:56:10,558 --> 07:56:13,558
foreign

8461
07:56:22,020 --> 07:56:26,740
[Music]

8462
07:56:35,400 --> 07:56:38,779
[Music]

8463
07:56:46,070 --> 07:56:49,290
[Music]

8464
07:56:57,600 --> 07:57:00,260
foreign

8465
07:57:08,340 --> 07:57:14,150
[Music]

8466
07:57:18,030 --> 07:57:21,168
[Music]

8467
07:57:40,150 --> 07:57:43,229
[Music]

8468
07:58:10,458 --> 07:58:13,458
thank you

8469
07:58:28,740 --> 07:58:30,978
foreign

8470
07:58:34,300 --> 07:58:42,110
[Music]

8471
07:58:52,740 --> 07:58:55,740
foreign

8472
07:59:25,320 --> 07:59:28,320
foreign

8473
08:00:03,920 --> 08:00:07,440
[Music]

8474
08:00:13,138 --> 08:00:16,138
foreign

8475
08:00:44,398 --> 08:00:47,398
foreign

8476
08:00:55,270 --> 08:01:09,910
[Music]

8477
08:01:13,680 --> 08:01:15,380
foreign

8478
08:01:15,380 --> 08:01:44,638
[Music]

8479
08:01:44,638 --> 08:01:47,638
foreign

8480
08:01:51,370 --> 08:02:33,839
[Music]

8481
08:02:37,280 --> 08:02:39,298
thank you

8482
08:02:39,298 --> 08:02:40,880
foreign

8483
08:02:40,880 --> 08:03:09,360
[Music]

8484
08:03:09,360 --> 08:03:12,360
foreign

8485
08:03:15,390 --> 08:03:36,139
[Music]

8486
08:03:44,410 --> 08:03:47,560
[Music]

8487
08:03:50,580 --> 08:03:53,580
foreign

8488
08:04:08,230 --> 08:04:11,389
[Music]

8489
08:04:15,990 --> 08:04:20,099
[Music]

8490
08:04:21,780 --> 08:04:23,958
foreign

8491
08:04:40,320 --> 08:04:45,040
[Music]

8492
08:04:51,298 --> 08:04:53,710
foreign

8493
08:04:53,710 --> 08:04:57,079
[Music]

8494
08:05:04,370 --> 08:05:07,590
[Music]

8495
08:05:23,218 --> 08:05:26,218
foreign

8496
08:05:26,650 --> 08:05:32,450
[Music]

8497
08:05:36,330 --> 08:05:39,469
[Music]

8498
08:05:58,978 --> 08:06:01,760
foreign

8499
08:06:27,180 --> 08:06:27,760
foreign

8500
08:06:27,760 --> 08:06:30,870
[Music]

8501
08:06:52,790 --> 08:07:00,410
[Music]

8502
08:07:01,920 --> 08:07:04,920
foreign

8503
08:07:52,040 --> 08:07:55,040
thank you

8504
08:08:15,600 --> 08:08:18,600
foreign

8505
08:08:22,400 --> 08:08:25,740
[Music]

8506
08:08:47,638 --> 08:08:50,638
foreign

8507
08:09:13,570 --> 08:09:24,439
[Music]

8508
08:09:25,080 --> 08:09:27,190
foreign

8509
08:09:27,190 --> 08:09:52,209
[Music]

8510
08:09:57,000 --> 08:10:00,000
foreign

8511
08:10:00,980 --> 08:10:27,660
[Music]

8512
08:10:27,660 --> 08:10:30,660
foreign

8513
08:10:33,670 --> 08:10:40,160
[Music]

8514
08:10:44,298 --> 08:10:45,680
thank you

8515
08:10:45,680 --> 08:11:03,898
[Music]

8516
08:11:03,898 --> 08:11:08,040
foreign foreign

8517
08:11:11,250 --> 08:11:39,660
[Music]

8518
08:11:39,660 --> 08:11:42,660
foreign

8519
08:11:45,670 --> 08:11:50,649
[Music]

8520
08:12:02,720 --> 08:12:05,859
[Music]

8521
08:12:20,160 --> 08:12:22,398
foreign

8522
08:12:26,530 --> 08:12:29,689
[Music]

8523
08:12:34,300 --> 08:12:38,399
[Music]

8524
08:12:47,160 --> 08:12:50,160
foreign

8525
08:12:58,620 --> 08:13:03,340
[Music]

8526
08:13:12,010 --> 08:13:15,379
[Music]

8527
08:13:22,680 --> 08:13:24,420
[Music]

8528
08:13:24,420 --> 08:13:26,660
foreign

8529
08:13:38,610 --> 08:13:41,740
[Music]

8530
08:13:44,950 --> 08:13:50,750
[Music]

8531
08:13:54,630 --> 08:13:57,769
[Music]

8532
08:14:01,978 --> 08:14:03,070
foreign

8533
08:14:03,070 --> 08:14:06,279
[Music]

8534
08:14:16,760 --> 08:14:19,840
[Music]

8535
08:14:58,978 --> 08:15:01,218
foreign

8536
08:15:10,870 --> 08:15:18,709
[Music]

8537
08:15:23,820 --> 08:15:26,820
foreign

8538
08:16:02,880 --> 08:16:06,009
[Music]

8539
08:16:26,878 --> 08:16:29,000
thank you

8540
08:16:40,700 --> 08:16:44,049
[Music]

8541
08:16:59,160 --> 08:17:01,280
thank you

8542
08:17:31,870 --> 08:17:41,458
[Music]

8543
08:17:41,458 --> 08:17:43,300
foreign

8544
08:17:43,300 --> 08:18:10,509
[Music]

8545
08:18:14,458 --> 08:18:15,980
foreign

8546
08:18:15,980 --> 08:18:45,958
[Music]

8547
08:18:45,958 --> 08:18:48,958
foreign

8548
08:18:51,970 --> 08:19:15,958
[Music]

8549
08:19:15,958 --> 08:19:17,490
foreign

8550
08:19:17,490 --> 08:19:45,958
[Music]

8551
08:19:45,958 --> 08:19:48,958
foreign

8552
08:19:52,000 --> 08:20:08,969
[Music]

8553
08:20:21,020 --> 08:20:24,150
[Music]

8554
08:20:27,180 --> 08:20:30,180
foreign

8555
08:20:44,850 --> 08:20:47,989
[Music]

8556
08:20:53,300 --> 08:20:56,709
[Music]

8557
08:20:57,898 --> 08:21:00,898
foreign

8558
08:21:16,920 --> 08:21:21,639
[Music]

8559
08:21:27,298 --> 08:21:30,298
foreign

8560
08:21:30,310 --> 08:21:33,679
[Music]

8561
08:21:40,980 --> 08:21:44,189
[Music]

8562
08:21:58,500 --> 08:22:01,500
foreign

8563
08:22:03,260 --> 08:22:09,070
[Music]

8564
08:22:12,930 --> 08:22:16,069
[Music]

8565
08:22:21,410 --> 08:22:24,569
[Music]

8566
08:22:35,398 --> 08:22:38,360
foreign

8567
08:23:25,260 --> 08:23:28,260
foreign

8568
08:23:29,220 --> 08:23:37,029
[Music]

8569
08:23:42,120 --> 08:23:45,120
foreign

8570
08:24:34,080 --> 08:24:36,860
foreign

8571
08:24:58,820 --> 08:25:02,349
[Music]

8572
08:25:17,398 --> 08:25:20,058
foreign

8573
08:25:50,180 --> 08:26:01,049
[Music]

8574
08:26:01,680 --> 08:26:03,800
foreign

8575
08:26:03,800 --> 08:26:28,809
[Music]

8576
08:26:33,540 --> 08:26:36,540
foreign

8577
08:26:37,580 --> 08:27:04,320
[Music]

8578
08:27:04,320 --> 08:27:07,320
foreign

8579
08:27:08,580 --> 08:27:10,270
foreign

8580
08:27:10,270 --> 08:27:38,878
[Music]

8581
08:27:38,878 --> 08:27:41,058
foreign

8582
08:27:47,860 --> 08:28:09,600
[Music]

8583
08:28:09,600 --> 08:28:12,600
foreign

8584
08:28:13,600 --> 08:28:27,269
[Music]

8585
08:28:39,320 --> 08:28:42,459
[Music]

8586
08:28:45,360 --> 08:28:48,360
foreign

8587
08:29:03,140 --> 08:29:06,299
[Music]

8588
08:29:10,900 --> 08:29:15,009
[Music]

8589
08:29:23,760 --> 08:29:26,760
foreign

8590
08:29:35,230 --> 08:29:39,950
[Music]

8591
08:29:48,610 --> 08:29:51,990
[Music]

8592
08:29:59,280 --> 08:30:02,500
[Music]

8593
08:30:22,320 --> 08:30:24,230
foreign

8594
08:30:24,230 --> 08:30:27,380
[Music]

8595
08:30:31,240 --> 08:30:33,180
[Music]

8596
08:30:33,180 --> 08:30:35,360
foreign

8597
08:30:53,360 --> 08:30:56,439
[Music]

8598
08:31:32,398 --> 08:31:34,638
foreign

8599
08:31:47,510 --> 08:31:55,320
[Music]

8600
08:32:00,360 --> 08:32:03,360
foreign

8601
08:32:39,480 --> 08:32:42,610
[Music]

8602
08:32:46,020 --> 08:32:48,138
thank you

8603
08:33:17,140 --> 08:33:20,649
[Music]

8604
08:33:26,340 --> 08:33:29,340
foreign

8605
08:33:53,398 --> 08:33:55,638
foreign

8606
08:34:08,480 --> 08:34:21,840
[Music]

8607
08:34:21,840 --> 08:34:24,840
foreign

8608
08:34:28,590 --> 08:34:52,558
[Music]

8609
08:34:52,558 --> 08:34:55,558
foreign

8610
08:34:55,890 --> 08:35:19,978
[Music]

8611
08:35:19,978 --> 08:35:22,978
foreign

8612
08:35:27,780 --> 08:35:30,170
foreign

8613
08:35:30,170 --> 08:35:59,059
[Music]

8614
08:35:59,760 --> 08:36:02,760
foreign

8615
08:36:06,160 --> 08:36:41,070
[Music]

8616
08:36:41,958 --> 08:36:45,020
thank you

8617
08:36:57,630 --> 08:37:00,759
[Music]

8618
08:37:21,450 --> 08:37:23,398
[Music]

8619
08:37:23,398 --> 08:37:25,638
foreign

8620
08:37:29,200 --> 08:37:33,310
[Music]

8621
08:37:38,820 --> 08:37:41,820
foreign

8622
08:37:53,530 --> 08:37:58,249
[Music]

8623
08:38:06,920 --> 08:38:10,289
[Music]

8624
08:38:13,080 --> 08:38:15,320
foreign

8625
08:38:17,580 --> 08:38:20,799
[Music]

8626
08:38:33,530 --> 08:38:36,660
[Music]

8627
08:38:40,620 --> 08:38:42,530
thank you

8628
08:38:42,530 --> 08:38:45,660
[Music]

8629
08:38:49,540 --> 08:38:52,679
[Music]

8630
08:39:11,660 --> 08:39:14,750
[Music]

8631
08:39:50,398 --> 08:39:53,398
foreign

8632
08:40:06,000 --> 08:40:13,619
[Music]

8633
08:40:18,780 --> 08:40:21,780
foreign

8634
08:41:35,610 --> 08:41:38,820
[Music]

8635
08:41:38,820 --> 08:41:41,000
foreign

8636
08:41:44,638 --> 08:41:47,638
foreign

8637
08:42:16,440 --> 08:42:18,680
foreign

8638
08:42:26,780 --> 08:43:02,399
[Music]

8639
08:43:03,080 --> 08:43:04,400
thank you

8640
08:43:04,400 --> 08:43:16,200
[Music]

8641
08:43:16,200 --> 08:43:19,200
foreign

8642
08:43:22,880 --> 08:44:00,529
[Music]

8643
08:44:02,540 --> 08:44:05,540
thank you

8644
08:44:10,890 --> 08:45:03,859
[Music]

8645
08:45:15,930 --> 08:45:19,069
[Music]

8646
08:45:22,080 --> 08:45:25,080
foreign

8647
08:45:36,660 --> 08:45:39,440
foreign

8648
08:45:39,740 --> 08:45:42,899
[Music]

8649
08:45:47,510 --> 08:45:51,609
[Music]

8650
08:46:05,638 --> 08:46:08,638
foreign

8651
08:46:11,830 --> 08:46:16,549
[Music]

8652
08:46:25,220 --> 08:46:28,589
[Music]

8653
08:46:35,890 --> 08:46:37,620
[Music]

8654
08:46:37,620 --> 08:46:39,860
foreign

8655
08:46:58,170 --> 08:47:03,979
[Music]

8656
08:47:07,840 --> 08:47:10,990
[Music]

8657
08:47:20,398 --> 08:47:22,520
thank you

8658
08:47:29,970 --> 08:47:33,049
[Music]

8659
08:47:36,550 --> 08:47:39,660
[Music]

8660
08:48:12,000 --> 08:48:15,000
foreign

8661
08:48:24,120 --> 08:48:31,918
[Music]

8662
08:48:42,718 --> 08:48:45,718
foreign

8663
08:49:23,360 --> 08:49:26,360
thank you

8664
08:49:53,760 --> 08:49:56,638
[Music]

8665
08:49:56,638 --> 08:49:59,638
foreign

8666
08:50:19,500 --> 08:50:22,500
foreign

8667
08:50:45,080 --> 08:50:55,950
[Music]

8668
08:50:56,700 --> 08:50:58,710
foreign

8669
08:50:58,710 --> 08:51:23,719
[Music]

8670
08:51:28,620 --> 08:51:31,620
foreign

8671
08:51:32,490 --> 08:51:59,160
[Music]

8672
08:51:59,160 --> 08:52:00,760
foreign

8673
08:52:00,760 --> 08:52:47,649
[Music]

8674
08:52:51,260 --> 08:52:53,160
thank you

8675
08:52:53,160 --> 08:53:11,720
[Music]

8676
08:53:16,440 --> 08:53:18,860
foreign

8677
08:53:18,860 --> 08:53:22,179
[Music]

8678
08:53:56,160 --> 08:54:01,209
[Music]

8679
08:54:05,810 --> 08:54:09,919
[Music]

8680
08:54:15,420 --> 08:54:17,660
foreign

8681
08:54:30,140 --> 08:54:34,849
[Music]

8682
08:54:40,500 --> 08:54:43,500
foreign

8683
08:54:43,520 --> 08:54:46,889
[Music]

8684
08:54:54,190 --> 08:54:57,399
[Music]

8685
08:55:08,580 --> 08:55:10,760
foreign

8686
08:55:16,460 --> 08:55:22,289
[Music]

8687
08:55:26,160 --> 08:55:29,279
[Music]

8688
08:55:48,270 --> 08:55:51,349
[Music]

8689
08:56:25,740 --> 08:56:27,860
thank you

8690
08:56:42,420 --> 08:56:50,239
[Music]

8691
08:56:55,260 --> 08:56:58,260
foreign

8692
08:58:00,058 --> 08:58:02,478
foreign

8693
08:58:12,040 --> 08:58:15,560
[Music]

8694
08:58:21,298 --> 08:58:24,298
foreign

8695
08:58:52,558 --> 08:58:55,558
foreign

8696
08:59:03,390 --> 08:59:18,029
[Music]

8697
08:59:22,740 --> 08:59:25,740
foreign

8698
08:59:26,800 --> 08:59:50,999
[Music]

8699
08:59:51,000 --> 08:59:53,510
foreign

8700
08:59:53,510 --> 08:59:59,458
[Music]

8701
08:59:59,458 --> 09:00:02,458
foreign

8702
09:00:02,800 --> 09:00:29,979
[Music]

8703
09:00:34,920 --> 09:00:37,920
foreign

8704
09:00:39,990 --> 09:01:05,959
[Music]

8705
09:01:06,660 --> 09:01:09,660
foreign

8706
09:01:11,470 --> 09:01:35,458
[Music]

8707
09:01:35,458 --> 09:01:37,160
foreign

8708
09:01:37,160 --> 09:01:40,459
[Music]

8709
09:01:41,520 --> 09:01:43,760
foreign

8710
09:01:52,530 --> 09:01:55,668
[Music]

8711
09:02:14,470 --> 09:02:18,298
[Music]

8712
09:02:18,298 --> 09:02:21,138
foreign

8713
09:02:24,110 --> 09:02:28,220
[Music]

8714
09:02:48,440 --> 09:02:52,260
[Music]

8715
09:02:52,260 --> 09:02:55,260
foreign

8716
09:03:01,820 --> 09:03:05,200
[Music]

8717
09:03:12,490 --> 09:03:15,729
[Music]

8718
09:03:31,378 --> 09:03:34,378
foreign

8719
09:03:34,760 --> 09:03:40,570
[Music]

8720
09:03:44,450 --> 09:03:47,589
[Music]

8721
09:04:06,570 --> 09:04:09,660
[Music]

8722
09:04:13,160 --> 09:04:16,270
[Music]

8723
09:04:46,920 --> 09:04:49,920
foreign

8724
09:05:00,720 --> 09:05:08,529
[Music]

8725
09:05:20,760 --> 09:05:23,478
foreign

8726
09:05:44,930 --> 09:05:48,080
[Music]

8727
09:05:51,718 --> 09:05:54,718
foreign

8728
09:06:30,519 --> 09:06:33,858
[Music]

8729
09:06:39,598 --> 09:06:41,839
foreign

8730
09:07:06,598 --> 09:07:08,898
foreign

8731
09:07:21,690 --> 09:07:35,160
[Music]

8732
09:07:35,160 --> 09:07:38,160
foreign

8733
09:07:41,800 --> 09:08:12,309
[Music]

8734
09:08:15,680 --> 09:08:17,790
thank you

8735
09:08:17,790 --> 09:08:36,309
[Music]

8736
09:08:40,980 --> 09:08:43,379
foreign

8737
09:08:43,379 --> 09:09:12,269
[Music]

8738
09:09:12,960 --> 09:09:15,960
foreign

8739
09:09:19,370 --> 09:09:47,820
[Music]

8740
09:09:47,820 --> 09:09:50,820
foreign

8741
09:09:53,790 --> 09:10:02,559
[Music]

8742
09:10:10,839 --> 09:10:13,979
[Music]

8743
09:10:34,660 --> 09:10:36,540
[Music]

8744
09:10:36,540 --> 09:10:39,378
foreign

8745
09:10:42,410 --> 09:10:46,519
[Music]

8746
09:10:52,019 --> 09:10:55,019
foreign

8747
09:11:06,739 --> 09:11:11,459
[Music]

8748
09:11:20,129 --> 09:11:23,499
[Music]

8749
09:11:28,680 --> 09:11:30,790
foreign

8750
09:11:30,790 --> 09:11:34,010
[Music]

8751
09:11:46,739 --> 09:11:49,869
[Music]

8752
09:11:53,070 --> 09:11:55,860
[Music]

8753
09:11:55,860 --> 09:11:58,860
foreign

8754
09:12:02,750 --> 09:12:05,889
[Music]

8755
09:12:58,019 --> 09:13:01,019
foreign

8756
09:13:19,210 --> 09:13:26,828
[Music]

8757
09:13:39,122 --> 09:13:41,238
thank you

8758
09:14:10,030 --> 09:14:13,129
[Music]

8759
09:14:18,258 --> 09:14:21,258
thank you

8760
09:14:48,820 --> 09:14:52,169
[Music]

8761
09:14:57,898 --> 09:15:00,898
foreign

8762
09:15:29,699 --> 09:15:31,937
foreign

8763
09:15:39,989 --> 09:16:16,699
[Music]

8764
09:16:16,699 --> 09:16:19,757
thank you

8765
09:16:24,100 --> 09:16:30,057
[Music]

8766
09:16:30,057 --> 09:16:33,057
foreign

8767
09:16:36,089 --> 09:17:00,057
[Music]

8768
09:17:00,057 --> 09:17:01,690
foreign

8769
09:17:01,690 --> 09:17:18,570
[Music]

8770
09:17:22,218 --> 09:17:24,100
thank you

8771
09:17:24,100 --> 09:17:42,559
[Music]

8772
09:17:46,282 --> 09:17:48,070
thank you

8773
09:17:48,070 --> 09:18:12,057
[Music]

8774
09:18:12,057 --> 09:18:13,769
foreign

8775
09:18:13,769 --> 09:18:20,858
[Music]

8776
09:18:29,140 --> 09:18:32,279
[Music]

8777
09:18:52,960 --> 09:18:56,110
[Music]

8778
09:19:00,720 --> 09:19:04,819
[Music]

8779
09:19:06,057 --> 09:19:08,299
foreign

8780
09:19:25,040 --> 09:19:29,760
[Music]

8781
09:19:32,220 --> 09:19:34,400
foreign

8782
09:19:38,430 --> 09:19:41,800
[Music]

8783
09:19:49,100 --> 09:19:52,309
[Music]

8784
09:20:03,480 --> 09:20:05,720
foreign

8785
09:20:11,370 --> 09:20:17,190
[Music]

8786
09:20:21,050 --> 09:20:24,189
[Music]

8787
09:20:29,540 --> 09:20:32,690
[Music]

8788
09:20:43,680 --> 09:20:45,916
foreign

8789
09:21:20,700 --> 09:21:22,820
thank you

8790
09:21:37,520 --> 09:21:45,149
[Music]

8791
09:21:50,340 --> 09:21:53,340
foreign

8792
09:22:42,900 --> 09:22:45,560
foreign

8793
09:23:06,950 --> 09:23:10,469
[Music]

8794
09:23:19,436 --> 09:23:22,436
foreign

8795
09:23:50,640 --> 09:23:53,640
foreign

8796
09:23:58,290 --> 09:24:24,360
[Music]

8797
09:24:24,360 --> 09:24:25,980
foreign

8798
09:24:25,980 --> 09:24:56,880
[Music]

8799
09:24:56,880 --> 09:24:57,710
foreign

8800
09:24:57,710 --> 09:25:23,880
[Music]

8801
09:25:23,880 --> 09:25:26,880
foreign

8802
09:25:29,820 --> 09:25:32,820
foreign

8803
09:25:34,900 --> 09:26:00,869
[Music]

8804
09:26:01,500 --> 09:26:04,500
foreign

8805
09:26:06,370 --> 09:26:30,416
[Music]

8806
09:26:30,416 --> 09:26:32,070
foreign

8807
09:26:32,070 --> 09:26:35,370
[Music]

8808
09:26:36,300 --> 09:26:39,300
foreign

8809
09:26:47,440 --> 09:26:50,569
[Music]

8810
09:27:11,270 --> 09:27:14,420
[Music]

8811
09:27:19,020 --> 09:27:23,130
[Music]

8812
09:27:23,880 --> 09:27:26,880
foreign

8813
09:27:43,350 --> 09:27:48,070
[Music]

8814
09:27:53,756 --> 09:27:56,730
foreign

8815
09:27:56,730 --> 09:28:00,109
[Music]

8816
09:28:07,400 --> 09:28:10,609
[Music]

8817
09:28:24,900 --> 09:28:27,900
foreign

8818
09:28:29,670 --> 09:28:35,500
[Music]

8819
09:28:39,360 --> 09:28:42,489
[Music]

8820
09:28:47,800 --> 09:28:50,999
[Music]

8821
09:29:02,040 --> 09:29:04,220
foreign

8822
09:29:34,256 --> 09:29:37,256
foreign

8823
09:29:55,640 --> 09:30:03,449
[Music]

8824
09:30:03,776 --> 09:30:06,200
foreign

8825
09:30:53,300 --> 09:30:56,300
thank you

8826
09:31:05,880 --> 09:31:08,880
foreign

8827
09:31:25,250 --> 09:31:28,760
[Music]

8828
09:31:43,680 --> 09:31:46,160
foreign

8829
09:32:16,600 --> 09:32:24,600
[Music]

8830
09:32:25,436 --> 09:32:28,020
foreign

8831
09:32:28,020 --> 09:32:55,229
[Music]

8832
09:32:59,936 --> 09:33:02,936
foreign

8833
09:33:04,000 --> 09:33:54,660
[Music]

8834
09:33:54,660 --> 09:33:57,660
foreign

8835
09:34:00,700 --> 09:34:25,149
[Music]

8836
09:34:25,700 --> 09:34:28,020
foreign

8837
09:34:28,020 --> 09:34:31,229
[Music]

8838
09:34:34,820 --> 09:34:36,720
thank you

8839
09:34:36,720 --> 09:34:53,669
[Music]

8840
09:34:56,936 --> 09:34:59,720
foreign

8841
09:35:03,360 --> 09:35:05,740
foreign

8842
09:35:05,740 --> 09:35:08,890
[Music]

8843
09:35:29,560 --> 09:35:32,720
[Music]

8844
09:35:37,320 --> 09:35:41,430
[Music]

8845
09:35:50,220 --> 09:35:53,220
foreign

8846
09:36:01,650 --> 09:36:06,370
[Music]

8847
09:36:09,776 --> 09:36:11,960
foreign

8848
09:36:15,040 --> 09:36:18,410
[Music]

8849
09:36:25,700 --> 09:36:28,920
[Music]

8850
09:36:44,580 --> 09:36:47,580
foreign

8851
09:36:47,970 --> 09:36:53,779
[Music]

8852
09:36:57,660 --> 09:37:00,799
[Music]

8853
09:37:19,780 --> 09:37:22,869
[Music]

8854
09:38:14,130 --> 09:38:21,738
[Music]

8855
09:38:22,320 --> 09:38:24,436
thank you

8856
09:38:26,880 --> 09:38:29,880
foreign

8857
09:39:05,900 --> 09:39:09,029
[Music]

8858
09:39:18,840 --> 09:39:21,079
foreign

8859
09:39:43,730 --> 09:39:47,069
[Music]

8860
09:39:52,800 --> 09:39:55,800
foreign

8861
09:40:26,756 --> 09:40:29,756
foreign

8862
09:40:34,900 --> 09:41:13,540
[Music]

8863
09:41:16,880 --> 09:41:19,010
thank you

8864
09:41:19,010 --> 09:41:36,840
[Music]

8865
09:41:36,840 --> 09:41:38,590
foreign

8866
09:41:38,590 --> 09:42:18,960
[Music]

8867
09:42:18,960 --> 09:42:20,510
foreign

8868
09:42:20,510 --> 09:42:49,529
[Music]

8869
09:42:54,240 --> 09:42:57,240
foreign

8870
09:42:58,330 --> 09:43:11,979
[Music]

8871
09:43:24,050 --> 09:43:27,189
[Music]

8872
09:43:30,596 --> 09:43:33,596
foreign

8873
09:43:47,860 --> 09:43:51,019
[Music]

8874
09:43:55,620 --> 09:43:59,730
[Music]

8875
09:44:08,460 --> 09:44:11,460
foreign

8876
09:44:19,950 --> 09:44:24,668
[Music]

8877
09:44:33,340 --> 09:44:36,710
[Music]

8878
09:44:44,010 --> 09:44:45,776
[Music]

8879
09:44:45,776 --> 09:44:48,776
foreign

8880
09:44:59,950 --> 09:45:03,079
[Music]

8881
09:45:06,280 --> 09:45:12,099
[Music]

8882
09:45:15,960 --> 09:45:19,099
[Music]

8883
09:45:23,276 --> 09:45:26,276
foreign

8884
09:45:44,670 --> 09:45:47,780
[Music]

8885
09:46:16,800 --> 09:46:19,640
foreign

8886
09:46:32,240 --> 09:46:40,039
[Music]

8887
09:46:45,180 --> 09:46:48,180
foreign

8888
09:47:24,200 --> 09:47:27,310
[Music]

8889
09:47:38,700 --> 09:47:40,820
thank you

8890
09:48:02,020 --> 09:48:05,380
[Music]

8891
09:48:11,096 --> 09:48:14,096
foreign

8892
09:48:42,900 --> 09:48:45,140
foreign

8893
09:48:53,200 --> 09:49:22,839
[Music]

8894
09:49:23,720 --> 09:49:25,310
thank you

8895
09:49:25,310 --> 09:49:43,320
[Music]

8896
09:49:43,320 --> 09:49:46,320
foreign

8897
09:49:49,300 --> 09:50:31,780
[Music]

8898
09:50:35,720 --> 09:50:37,310
thank you

8899
09:50:37,310 --> 09:50:52,680
[Music]

8900
09:50:52,680 --> 09:50:53,800
foreign

8901
09:50:53,800 --> 09:51:22,850
[Music]

8902
09:51:24,540 --> 09:51:26,980
foreign

8903
09:51:26,980 --> 09:51:30,269
[Music]

8904
09:51:42,350 --> 09:51:45,489
[Music]

8905
09:52:06,170 --> 09:52:09,320
[Music]

8906
09:52:13,930 --> 09:52:18,040
[Music]

8907
09:52:19,320 --> 09:52:21,500
foreign

8908
09:52:38,260 --> 09:52:42,969
[Music]

8909
09:52:45,480 --> 09:52:47,660
foreign

8910
09:52:51,640 --> 09:52:55,010
[Music]

8911
09:53:02,310 --> 09:53:05,519
[Music]

8912
09:53:19,860 --> 09:53:22,460
foreign

8913
09:53:24,580 --> 09:53:30,400
[Music]

8914
09:53:34,270 --> 09:53:37,399
[Music]

8915
09:53:42,710 --> 09:53:45,900
[Music]

8916
09:53:56,390 --> 09:53:59,470
[Music]

8917
09:54:03,240 --> 09:54:05,416
foreign

8918
09:54:38,340 --> 09:54:40,579
foreign

8919
09:54:50,540 --> 09:54:58,359
[Music]

8920
09:55:09,180 --> 09:55:11,300
thank you

8921
09:55:49,756 --> 09:55:52,756
thank you

8922
09:56:14,520 --> 09:56:16,700
foreign

8923
09:56:20,150 --> 09:56:23,679
[Music]

8924
09:56:45,900 --> 09:56:48,900
foreign

8925
09:57:11,500 --> 09:57:22,020
[Music]

8926
09:57:22,020 --> 09:57:22,930
foreign

8927
09:57:22,930 --> 09:57:50,139
[Music]

8928
09:57:53,936 --> 09:57:55,610
foreign

8929
09:57:55,610 --> 09:58:25,560
[Music]

8930
09:58:25,560 --> 09:58:27,180
foreign

8931
09:58:27,180 --> 09:58:55,560
[Music]

8932
09:58:55,560 --> 09:58:57,120
foreign

8933
09:58:57,120 --> 09:59:30,840
[Music]

8934
09:59:30,840 --> 09:59:33,840
foreign

8935
09:59:34,930 --> 09:59:48,599
[Music]

8936
10:00:00,650 --> 10:00:03,779
[Music]

8937
10:00:06,840 --> 10:00:09,840
foreign

8938
10:00:24,470 --> 10:00:27,629
[Music]

8939
10:00:32,230 --> 10:00:36,339
[Music]

8940
10:00:38,040 --> 10:00:40,220
foreign

8941
10:00:56,560 --> 10:01:01,280
[Music]

8942
10:01:06,900 --> 10:01:09,900
foreign

8943
10:01:09,940 --> 10:01:13,319
[Music]

8944
10:01:20,610 --> 10:01:23,830
[Music]

8945
10:01:34,980 --> 10:01:37,160
foreign

8946
10:01:42,880 --> 10:01:48,689
[Music]

8947
10:01:52,570 --> 10:01:55,709
[Music]

8948
10:02:15,000 --> 10:02:17,776
foreign

8949
10:02:47,880 --> 10:02:50,880
foreign

8950
10:03:09,030 --> 10:03:16,650
[Music]

8951
10:03:27,416 --> 10:03:30,416
foreign

8952
10:03:59,820 --> 10:04:02,820
foreign

8953
10:04:38,460 --> 10:04:40,800
[Music]

8954
10:04:40,800 --> 10:04:42,980
foreign

8955
10:05:03,900 --> 10:05:06,900
foreign

8956
10:05:29,810 --> 10:05:40,320
[Music]

8957
10:05:40,320 --> 10:05:41,230
foreign

8958
10:05:41,230 --> 10:06:08,439
[Music]

8959
10:06:13,200 --> 10:06:16,200
foreign

8960
10:06:17,220 --> 10:06:43,916
[Music]

8961
10:06:43,916 --> 10:06:46,916
foreign

8962
10:06:49,860 --> 10:06:51,500
foreign

8963
10:06:51,500 --> 10:07:20,390
[Music]

8964
10:07:21,060 --> 10:07:24,060
foreign

8965
10:07:27,490 --> 10:07:56,449
[Music]

8966
10:08:01,200 --> 10:08:03,570
foreign

8967
10:08:03,570 --> 10:08:06,879
[Music]

8968
10:08:18,950 --> 10:08:22,100
[Music]

8969
10:08:42,780 --> 10:08:44,700
[Music]

8970
10:08:44,700 --> 10:08:47,700
foreign

8971
10:08:50,530 --> 10:08:54,640
[Music]

8972
10:09:14,860 --> 10:09:18,660
[Music]

8973
10:09:18,660 --> 10:09:21,660
foreign

8974
10:09:28,250 --> 10:09:31,620
[Music]

8975
10:09:38,920 --> 10:09:42,129
[Music]

8976
10:09:57,776 --> 10:10:00,776
foreign

8977
10:10:01,190 --> 10:10:06,989
[Music]

8978
10:10:10,870 --> 10:10:14,009
[Music]

8979
10:10:33,596 --> 10:10:35,776
foreign

8980
10:11:13,800 --> 10:11:15,916
thank you

8981
10:11:27,330 --> 10:11:34,949
[Music]

8982
10:11:45,596 --> 10:11:48,596
foreign

8983
10:12:19,110 --> 10:12:22,220
[Music]

8984
10:12:25,276 --> 10:12:28,276
thank you

8985
10:12:56,940 --> 10:13:00,279
[Music]

8986
10:13:06,000 --> 10:13:09,000
foreign

8987
10:13:37,800 --> 10:13:40,040
foreign

8988
10:13:48,110 --> 10:14:19,980
[Music]

8989
10:14:19,980 --> 10:14:22,980
foreign

8990
10:14:23,530 --> 10:14:50,276
[Music]

8991
10:14:50,276 --> 10:14:51,800
foreign

8992
10:14:51,800 --> 10:14:56,160
[Music]

8993
10:14:56,160 --> 10:14:59,160
foreign

8994
10:14:59,510 --> 10:15:21,859
[Music]

8995
10:15:24,000 --> 10:15:25,620
foreign

8996
10:15:25,620 --> 10:15:28,620
foreign

8997
10:15:32,220 --> 10:15:55,380
[Music]

8998
10:15:55,380 --> 10:15:58,380
foreign

8999
10:15:59,530 --> 10:16:29,000
[Music]

9000
10:16:37,230 --> 10:16:40,399
[Music]

9001
10:16:43,860 --> 10:16:46,860
foreign

9002
10:17:01,080 --> 10:17:04,230
[Music]

9003
10:17:09,540 --> 10:17:12,940
[Music]

9004
10:17:21,660 --> 10:17:24,660
foreign

9005
10:17:33,160 --> 10:17:37,879
[Music]

9006
10:17:46,550 --> 10:17:49,919
[Music]

9007
10:17:57,220 --> 10:17:58,980
[Music]

9008
10:17:58,980 --> 10:18:01,220
foreign

9009
10:18:19,490 --> 10:18:25,309
[Music]

9010
10:18:29,170 --> 10:18:32,309
[Music]

9011
10:18:41,460 --> 10:18:44,360
foreign

9012
10:18:51,300 --> 10:18:54,379
[Music]

9013
10:19:30,060 --> 10:19:32,299
foreign

9014
10:19:45,450 --> 10:19:53,250
[Music]

9015
10:19:58,380 --> 10:20:01,380
foreign

9016
10:20:37,410 --> 10:20:40,549
[Music]

9017
10:20:50,400 --> 10:20:52,520
thank you

9018
10:21:15,240 --> 10:21:18,629
[Music]

9019
10:21:33,660 --> 10:21:35,776
thank you

9020
10:22:06,410 --> 10:22:17,279
[Music]

9021
10:22:17,936 --> 10:22:20,040
foreign

9022
10:22:20,040 --> 10:22:44,580
[Music]

9023
10:22:44,580 --> 10:22:47,580
foreign

9024
10:22:50,520 --> 10:23:06,020
[Music]

9025
10:23:06,080 --> 10:23:08,550
thank you

9026
10:23:08,550 --> 10:23:20,520
[Music]

9027
10:23:20,520 --> 10:23:23,520
foreign

9028
10:23:26,510 --> 10:23:50,460
[Music]

9029
10:23:50,460 --> 10:23:52,030
foreign

9030
10:23:52,030 --> 10:24:25,020
[Music]

9031
10:24:25,020 --> 10:24:26,540
foreign

9032
10:24:26,540 --> 10:24:43,509
[Music]

9033
10:24:55,560 --> 10:24:58,699
[Music]

9034
10:25:01,740 --> 10:25:04,740
foreign

9035
10:25:19,380 --> 10:25:22,540
[Music]

9036
10:25:27,140 --> 10:25:31,250
[Music]

9037
10:25:40,020 --> 10:25:42,680
foreign

9038
10:25:51,470 --> 10:25:56,190
[Music]

9039
10:26:04,850 --> 10:26:08,220
[Music]

9040
10:26:15,520 --> 10:26:18,729
[Music]

9041
10:26:34,500 --> 10:26:36,620
thank you

9042
10:26:37,790 --> 10:26:43,610
[Music]

9043
10:26:47,490 --> 10:26:50,619
[Music]

9044
10:26:54,840 --> 10:26:57,840
foreign

9045
10:27:09,600 --> 10:27:12,680
[Music]

9046
10:27:47,096 --> 10:27:49,220
thank you

9047
10:28:03,760 --> 10:28:11,569
[Music]

9048
10:28:16,740 --> 10:28:19,740
foreign

9049
10:28:55,720 --> 10:28:58,849
[Music]

9050
10:29:19,620 --> 10:29:22,340
foreign

9051
10:29:33,370 --> 10:29:36,889
[Music]

9052
10:29:51,960 --> 10:29:54,080
thank you

9053
10:30:24,710 --> 10:30:33,596
[Music]

9054
10:30:33,596 --> 10:30:35,840
foreign

9055
10:30:36,140 --> 10:31:03,349
[Music]

9056
10:31:03,840 --> 10:31:06,840
foreign

9057
10:31:08,820 --> 10:31:39,329
[Music]

9058
10:31:42,860 --> 10:31:44,810
thank you

9059
10:31:44,810 --> 10:32:08,756
[Music]

9060
10:32:08,756 --> 10:32:10,330
foreign

9061
10:32:10,330 --> 10:32:44,096
[Music]

9062
10:32:44,096 --> 10:32:47,096
foreign

9063
10:32:48,140 --> 10:33:01,790
[Music]

9064
10:33:13,860 --> 10:33:17,010
[Music]

9065
10:33:20,040 --> 10:33:23,040
foreign

9066
10:33:37,680 --> 10:33:40,839
[Music]

9067
10:33:45,440 --> 10:33:49,550
[Music]

9068
10:33:58,320 --> 10:34:01,320
foreign

9069
10:34:09,770 --> 10:34:14,479
[Music]

9070
10:34:23,150 --> 10:34:26,529
[Music]

9071
10:34:33,820 --> 10:34:37,040
[Music]

9072
10:34:52,860 --> 10:34:54,980
thank you

9073
10:34:56,090 --> 10:35:01,899
[Music]

9074
10:35:05,780 --> 10:35:08,919
[Music]

9075
10:35:13,140 --> 10:35:16,140
foreign

9076
10:35:27,900 --> 10:35:30,989
[Music]

9077
10:36:05,400 --> 10:36:07,520
thank you

9078
10:36:22,060 --> 10:36:29,859
[Music]

9079
10:36:42,120 --> 10:36:44,360
foreign

9080
10:37:13,020 --> 10:37:16,020
foreign

9081
10:37:51,850 --> 10:37:55,020
[Music]

9082
10:37:55,020 --> 10:37:57,255
foreign

9083
10:38:17,096 --> 10:38:20,096
foreign

9084
10:38:43,020 --> 10:38:53,580
[Music]

9085
10:38:53,580 --> 10:38:54,450
foreign

9086
10:38:54,450 --> 10:39:21,659
[Music]

9087
10:39:26,400 --> 10:39:29,400
foreign

9088
10:39:30,430 --> 10:40:03,060
[Music]

9089
10:40:03,060 --> 10:40:04,710
foreign

9090
10:40:04,710 --> 10:40:33,600
[Music]

9091
10:40:34,500 --> 10:40:37,500
foreign

9092
10:40:40,700 --> 10:41:16,520
[Music]

9093
10:41:16,520 --> 10:41:19,520
thank you

9094
10:41:32,170 --> 10:41:35,309
[Music]

9095
10:41:55,980 --> 10:41:57,960
[Music]

9096
10:41:57,960 --> 10:42:00,620
foreign

9097
10:42:03,750 --> 10:42:07,849
[Music]

9098
10:42:13,320 --> 10:42:16,320
foreign

9099
10:42:28,070 --> 10:42:32,780
[Music]

9100
10:42:41,460 --> 10:42:44,830
[Music]

9101
10:42:47,096 --> 10:42:50,096
foreign

9102
10:42:52,130 --> 10:42:55,339
[Music]

9103
10:43:14,880 --> 10:43:17,070
foreign

9104
10:43:17,070 --> 10:43:20,199
[Music]

9105
10:43:24,080 --> 10:43:27,219
[Music]

9106
10:43:32,520 --> 10:43:35,729
[Music]

9107
10:43:52,980 --> 10:43:55,936
foreign

9108
10:44:24,960 --> 10:44:27,960
foreign

9109
10:44:40,540 --> 10:44:48,160
[Music]

9110
10:44:53,340 --> 10:44:56,340
foreign

9111
10:45:32,320 --> 10:45:35,430
[Music]

9112
10:45:58,020 --> 10:46:01,020
foreign

9113
10:46:10,150 --> 10:46:13,480
[Music]

9114
10:46:19,200 --> 10:46:22,200
foreign

9115
10:46:53,276 --> 10:46:56,276
foreign

9116
10:47:01,320 --> 10:47:27,416
[Music]

9117
10:47:27,416 --> 10:47:30,416
foreign

9118
10:47:33,430 --> 10:48:15,940
[Music]

9119
10:48:19,460 --> 10:48:21,420
thank you

9120
10:48:21,420 --> 10:48:39,900
[Music]

9121
10:48:43,880 --> 10:48:45,416
thank you

9122
10:48:45,416 --> 10:48:46,930
foreign

9123
10:48:46,930 --> 10:49:33,910
[Music]

9124
10:49:34,820 --> 10:49:37,880
thank you

9125
10:49:39,100 --> 10:49:42,180
[Music]

9126
10:49:50,470 --> 10:49:53,599
[Music]

9127
10:49:56,700 --> 10:49:59,700
foreign

9128
10:50:12,400 --> 10:50:17,440
[Music]

9129
10:50:22,050 --> 10:50:26,149
[Music]

9130
10:50:34,980 --> 10:50:37,980
foreign

9131
10:50:46,370 --> 10:50:51,089
[Music]

9132
10:50:59,760 --> 10:51:03,129
[Music]

9133
10:51:10,430 --> 10:51:12,180
[Music]

9134
10:51:12,180 --> 10:51:14,416
foreign

9135
10:51:32,700 --> 10:51:38,498
[Music]

9136
10:51:42,380 --> 10:51:45,519
[Music]

9137
10:51:49,740 --> 10:51:51,979
foreign

9138
10:52:04,510 --> 10:52:07,589
[Music]

9139
10:52:46,500 --> 10:52:49,500
foreign

9140
10:52:58,660 --> 10:53:06,460
[Music]

9141
10:53:11,580 --> 10:53:14,580
foreign

9142
10:53:50,620 --> 10:53:53,730
[Music]

9143
10:54:21,776 --> 10:54:24,776
foreign

9144
10:54:28,280 --> 10:54:31,799
[Music]

9145
10:54:37,500 --> 10:54:40,500
foreign

9146
10:55:09,300 --> 10:55:11,480
foreign

9147
10:55:19,620 --> 10:55:34,269
[Music]

9148
10:55:39,000 --> 10:55:42,000
foreign

9149
10:55:43,040 --> 10:56:07,080
[Music]

9150
10:56:07,080 --> 10:56:10,080
foreign

9151
10:56:15,000 --> 10:56:18,000
foreign

9152
10:56:19,040 --> 10:56:58,199
[Music]

9153
10:57:02,000 --> 10:57:03,730
thank you

9154
10:57:03,730 --> 10:57:26,880
[Music]

9155
10:57:26,880 --> 10:57:29,880
foreign

9156
10:57:31,040 --> 10:57:55,080
[Music]

9157
10:57:55,080 --> 10:57:57,620
thank you

9158
10:58:08,770 --> 10:58:11,920
[Music]

9159
10:58:14,936 --> 10:58:17,936
foreign

9160
10:58:32,590 --> 10:58:35,740
[Music]

9161
10:58:40,350 --> 10:58:44,460
[Music]

9162
10:58:53,220 --> 10:58:55,880
foreign

9163
10:59:04,680 --> 10:59:09,400
[Music]

9164
10:59:18,060 --> 10:59:21,430
[Music]

9165
10:59:28,730 --> 10:59:31,939
[Music]

9166
10:59:40,256 --> 10:59:43,256
foreign

9167
10:59:51,000 --> 10:59:56,830
[Music]

9168
11:00:00,680 --> 11:00:03,819
[Music]

9169
11:00:08,040 --> 11:00:11,040
foreign

9170
11:00:22,810 --> 11:00:25,890
[Music]

9171
11:01:11,460 --> 11:01:13,580
thank you

9172
11:01:16,970 --> 11:01:24,779
[Music]

9173
11:01:29,936 --> 11:01:32,936
foreign

9174
11:02:22,560 --> 11:02:25,220
foreign

9175
11:02:46,580 --> 11:02:50,099
[Music]

9176
11:03:05,040 --> 11:03:08,040
foreign

9177
11:03:37,930 --> 11:03:46,800
[Music]

9178
11:03:46,800 --> 11:03:49,350
foreign

9179
11:03:49,350 --> 11:04:16,080
[Music]

9180
11:04:16,080 --> 11:04:19,080
foreign

9181
11:04:22,030 --> 11:04:37,540
[Music]

9182
11:04:38,180 --> 11:04:40,060
thank you

9183
11:04:40,060 --> 11:04:57,960
[Music]

9184
11:04:57,960 --> 11:04:59,620
foreign

9185
11:04:59,620 --> 11:05:28,510
[Music]

9186
11:05:29,340 --> 11:05:32,340
foreign

9187
11:05:35,610 --> 11:06:10,519
[Music]

9188
11:06:10,820 --> 11:06:13,820
thank you

9189
11:06:27,070 --> 11:06:30,209
[Music]

9190
11:06:50,890 --> 11:06:52,916
[Music]

9191
11:06:52,916 --> 11:06:55,640
foreign

9192
11:06:59,350 --> 11:07:02,760
[Music]

9193
11:07:11,520 --> 11:07:14,520
foreign

9194
11:07:22,980 --> 11:07:27,699
[Music]

9195
11:07:36,360 --> 11:07:39,739
[Music]

9196
11:07:43,380 --> 11:07:45,560
foreign

9197
11:07:47,030 --> 11:07:50,250
[Music]

9198
11:08:10,080 --> 11:08:11,980
thank you

9199
11:08:11,980 --> 11:08:15,109
[Music]

9200
11:08:18,990 --> 11:08:22,129
[Music]

9201
11:08:41,110 --> 11:08:44,199
[Music]

9202
11:08:47,936 --> 11:08:50,900
foreign

9203
11:09:35,450 --> 11:09:43,068
[Music]

9204
11:09:43,500 --> 11:09:45,740
foreign

9205
11:09:48,060 --> 11:09:51,060
foreign

9206
11:10:27,230 --> 11:10:30,359
[Music]

9207
11:10:42,060 --> 11:10:45,060
foreign

9208
11:11:05,610 --> 11:11:09,139
[Music]

9209
11:11:24,180 --> 11:11:26,300
thank you

9210
11:11:56,960 --> 11:12:06,540
[Music]

9211
11:12:06,540 --> 11:12:08,390
foreign

9212
11:12:08,390 --> 11:12:35,599
[Music]

9213
11:12:40,320 --> 11:12:43,320
foreign

9214
11:12:44,370 --> 11:13:11,040
[Music]

9215
11:13:11,040 --> 11:13:14,040
foreign

9216
11:13:17,060 --> 11:13:41,040
[Music]

9217
11:13:41,040 --> 11:13:42,580
foreign

9218
11:13:42,580 --> 11:14:16,256
[Music]

9219
11:14:16,256 --> 11:14:19,256
foreign

9220
11:14:20,390 --> 11:14:34,059
[Music]

9221
11:14:46,110 --> 11:14:49,260
[Music]

9222
11:14:52,256 --> 11:14:55,256
foreign

9223
11:15:09,930 --> 11:15:13,089
[Music]

9224
11:15:17,690 --> 11:15:21,800
[Music]

9225
11:15:30,596 --> 11:15:32,720
thank you

9226
11:15:42,020 --> 11:15:46,740
[Music]

9227
11:15:55,400 --> 11:15:58,779
[Music]

9228
11:16:06,070 --> 11:16:09,290
[Music]

9229
11:16:28,436 --> 11:16:30,620
foreign

9230
11:16:31,020 --> 11:16:34,149
[Music]

9231
11:16:38,040 --> 11:16:41,169
[Music]

9232
11:17:00,150 --> 11:17:03,230
[Music]

9233
11:17:42,360 --> 11:17:44,596
foreign

9234
11:17:54,300 --> 11:18:02,119
[Music]

9235
11:18:12,900 --> 11:18:15,020
thank you

9236
11:18:46,270 --> 11:18:49,399
[Music]

9237
11:18:53,540 --> 11:18:56,540
thank you

9238
11:19:23,920 --> 11:19:27,240
[Music]

9239
11:19:27,240 --> 11:19:29,479
foreign

9240
11:19:49,380 --> 11:19:52,380
foreign

9241
11:20:15,270 --> 11:20:25,800
[Music]

9242
11:20:25,800 --> 11:20:26,690
foreign

9243
11:20:26,690 --> 11:21:14,879
[Music]

9244
11:21:15,320 --> 11:21:16,890
thank you

9245
11:21:16,890 --> 11:21:29,340
[Music]

9246
11:21:29,340 --> 11:21:32,340
foreign

9247
11:21:35,370 --> 11:22:41,400
[Music]

9248
11:22:41,400 --> 11:22:44,400
foreign

9249
11:22:47,360 --> 11:22:56,160
[Music]

9250
11:23:04,410 --> 11:23:07,559
[Music]

9251
11:23:28,240 --> 11:23:30,180
[Music]

9252
11:23:30,180 --> 11:23:33,080
foreign

9253
11:23:35,990 --> 11:23:40,100
[Music]

9254
11:23:45,596 --> 11:23:47,840
foreign

9255
11:24:00,320 --> 11:24:05,040
[Music]

9256
11:24:13,710 --> 11:24:17,080
[Music]

9257
11:24:19,256 --> 11:24:22,256
foreign

9258
11:24:24,370 --> 11:24:27,589
[Music]

9259
11:24:46,650 --> 11:24:49,436
[Music]

9260
11:24:49,436 --> 11:24:51,620
foreign

9261
11:24:56,330 --> 11:24:59,469
[Music]

9262
11:25:04,810 --> 11:25:07,979
[Music]

9263
11:25:18,450 --> 11:25:21,539
[Music]

9264
11:25:25,256 --> 11:25:28,220
foreign

9265
11:25:57,240 --> 11:25:59,479
foreign

9266
11:26:12,790 --> 11:26:20,410
[Music]

9267
11:26:25,560 --> 11:26:28,560
foreign

9268
11:27:03,610 --> 11:27:06,699
[Music]

9269
11:27:17,580 --> 11:27:19,700
thank you

9270
11:27:42,400 --> 11:27:45,739
[Music]

9271
11:27:51,480 --> 11:27:54,480
foreign

9272
11:28:22,740 --> 11:28:25,740
foreign

9273
11:28:33,570 --> 11:28:48,209
[Music]

9274
11:28:52,916 --> 11:28:55,916
foreign

9275
11:28:56,980 --> 11:29:22,980
[Music]

9276
11:29:22,980 --> 11:29:25,980
foreign

9277
11:29:29,670 --> 11:30:12,150
[Music]

9278
11:30:15,500 --> 11:30:17,640
thank you

9279
11:30:17,640 --> 11:30:19,180
foreign

9280
11:30:19,180 --> 11:30:52,980
[Music]

9281
11:30:52,980 --> 11:30:55,980
foreign

9282
11:30:57,000 --> 11:31:14,440
[Music]

9283
11:31:22,690 --> 11:31:25,859
[Music]

9284
11:31:28,860 --> 11:31:31,860
foreign

9285
11:31:46,540 --> 11:31:49,690
[Music]

9286
11:31:54,300 --> 11:31:58,399
[Music]

9287
11:32:07,140 --> 11:32:10,040
foreign

9288
11:32:18,620 --> 11:32:23,339
[Music]

9289
11:32:32,010 --> 11:32:35,379
[Music]

9290
11:32:42,680 --> 11:32:44,460
[Music]

9291
11:32:44,460 --> 11:32:47,460
foreign

9292
11:33:04,950 --> 11:33:10,769
[Music]

9293
11:33:14,630 --> 11:33:17,769
[Music]

9294
11:33:21,960 --> 11:33:23,080
foreign

9295
11:33:23,080 --> 11:33:26,279
[Music]

9296
11:33:36,760 --> 11:33:39,839
[Music]

9297
11:34:15,776 --> 11:34:18,020
foreign

9298
11:34:31,090 --> 11:34:38,710
[Music]

9299
11:34:43,860 --> 11:34:46,860
foreign

9300
11:35:35,880 --> 11:35:38,000
thank you

9301
11:36:00,690 --> 11:36:04,050
[Music]

9302
11:36:09,776 --> 11:36:12,776
foreign

9303
11:36:41,580 --> 11:36:43,820
foreign

9304
11:36:51,870 --> 11:37:06,509
[Music]

9305
11:37:11,220 --> 11:37:14,220
foreign

9306
11:37:15,280 --> 11:37:41,276
[Music]

9307
11:37:41,276 --> 11:37:44,276
foreign

9308
11:37:47,980 --> 11:38:12,000
[Music]

9309
11:38:12,000 --> 11:38:13,570
foreign

9310
11:38:13,570 --> 11:38:30,449
[Music]

9311
11:38:34,276 --> 11:38:35,980
thank you

9312
11:38:35,980 --> 11:39:11,220
[Music]

9313
11:39:11,220 --> 11:39:14,220
foreign

9314
11:39:15,300 --> 11:39:32,769
[Music]

9315
11:39:40,990 --> 11:39:44,150
[Music]

9316
11:39:47,220 --> 11:39:50,220
foreign

9317
11:40:04,840 --> 11:40:07,990
[Music]

9318
11:40:12,600 --> 11:40:16,710
[Music]

9319
11:40:17,936 --> 11:40:20,936
foreign

9320
11:40:36,930 --> 11:40:41,639
[Music]

9321
11:40:44,160 --> 11:40:46,340
foreign

9322
11:40:50,310 --> 11:40:53,680
[Music]

9323
11:41:00,980 --> 11:41:04,189
[Music]

9324
11:41:15,360 --> 11:41:16,850
foreign

9325
11:41:16,850 --> 11:41:20,040
[Music]

9326
11:41:23,250 --> 11:41:29,070
[Music]

9327
11:41:32,950 --> 11:41:36,070
[Music]

9328
11:41:55,060 --> 11:41:58,140
[Music]

9329
11:42:32,580 --> 11:42:34,700
thank you

9330
11:42:49,400 --> 11:42:57,029
[Music]

9331
11:43:02,160 --> 11:43:05,160
foreign

9332
11:43:41,170 --> 11:43:44,309
[Music]

9333
11:43:54,776 --> 11:43:57,380
foreign

9334
11:44:18,820 --> 11:44:22,349
[Music]

9335
11:44:37,436 --> 11:44:39,560
thank you

9336
11:45:10,170 --> 11:45:18,180
[Music]

9337
11:45:19,020 --> 11:45:21,255
foreign

9338
11:45:21,600 --> 11:45:54,240
[Music]

9339
11:45:54,240 --> 11:45:57,240
foreign

9340
11:45:57,580 --> 11:46:30,240
[Music]

9341
11:46:30,240 --> 11:46:31,870
foreign

9342
11:46:31,870 --> 11:47:09,660
[Music]

9343
11:47:09,660 --> 11:47:10,780
foreign

9344
11:47:10,780 --> 11:47:36,820
[Music]

9345
11:47:41,520 --> 11:47:43,950
foreign

9346
11:47:43,950 --> 11:47:47,250
[Music]

9347
11:48:23,140 --> 11:48:26,300
[Music]

9348
11:48:30,900 --> 11:48:35,010
[Music]

9349
11:48:43,800 --> 11:48:46,460
foreign

9350
11:48:55,230 --> 11:48:59,949
[Music]

9351
11:49:06,240 --> 11:49:08,610
foreign

9352
11:49:08,610 --> 11:49:11,989
[Music]

9353
11:49:19,280 --> 11:49:22,500
[Music]

9354
11:49:36,416 --> 11:49:39,416
foreign

9355
11:49:41,550 --> 11:49:47,359
[Music]

9356
11:49:51,240 --> 11:49:54,379
[Music]

9357
11:49:59,680 --> 11:50:02,839
[Music]

9358
11:50:13,360 --> 11:50:16,440
[Music]

9359
11:50:20,220 --> 11:50:23,180
foreign

9360
11:50:54,060 --> 11:50:56,479
foreign

9361
11:51:07,510 --> 11:51:15,319
[Music]

9362
11:51:25,980 --> 11:51:28,980
foreign

9363
11:51:58,500 --> 11:52:01,500
foreign

9364
11:52:37,140 --> 11:52:39,480
[Music]

9365
11:52:39,480 --> 11:52:41,660
foreign

9366
11:53:02,580 --> 11:53:05,580
foreign

9367
11:53:28,480 --> 11:53:39,000
[Music]

9368
11:53:39,000 --> 11:53:39,900
foreign

9369
11:53:39,900 --> 11:54:06,596
[Music]

9370
11:54:06,596 --> 11:54:09,596
foreign

9371
11:54:12,590 --> 11:54:37,276
[Music]

9372
11:54:37,276 --> 11:54:38,936
foreign

9373
11:54:38,936 --> 11:54:39,880
foreign

9374
11:54:39,880 --> 11:54:57,250
[Music]

