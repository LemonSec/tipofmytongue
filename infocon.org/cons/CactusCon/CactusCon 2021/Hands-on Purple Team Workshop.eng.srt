1
00:00:02,320 --> 00:00:04,720
hey everyone

2
00:00:03,040 --> 00:00:06,160
alex here no it's been more than a week

3
00:00:04,720 --> 00:00:07,359
and a half since cactus con

4
00:00:06,160 --> 00:00:09,200
we were just given a copy of the

5
00:00:07,359 --> 00:00:10,719
hands-on purple team workshop

6
00:00:09,200 --> 00:00:12,079
conducted by george archias during the

7
00:00:10,719 --> 00:00:12,879
con and wanted to share the recording

8
00:00:12,080 --> 00:00:14,799
with you

9
00:00:12,880 --> 00:00:16,320
as a heads up the workshop was conducted

10
00:00:14,799 --> 00:00:18,080
on virtual machines provisioned in

11
00:00:16,320 --> 00:00:19,840
george's environment and thus are

12
00:00:18,080 --> 00:00:21,278
unavailable after the con but we still

13
00:00:19,840 --> 00:00:22,560
wanted to make sure that the material

14
00:00:21,279 --> 00:00:24,160
and the presentation was available to

15
00:00:22,560 --> 00:00:27,840
anybody who wants it

16
00:00:24,160 --> 00:00:27,840
so without further ado take it away

17
00:00:28,840 --> 00:00:35,040
george

18
00:00:31,439 --> 00:00:38,480
all right so welcome welcome welcome

19
00:00:35,040 --> 00:00:41,680
we are officially starting this is

20
00:00:38,480 --> 00:00:44,879
the hands-on purple team workshop

21
00:00:41,680 --> 00:00:47,680
for cactus khan what an awesome con

22
00:00:44,879 --> 00:00:48,480
we're almost at the end of it it's it's

23
00:00:47,680 --> 00:00:51,600
been awesome

24
00:00:48,480 --> 00:00:54,959
uh we did a talk earlier today saw some

25
00:00:51,600 --> 00:00:56,480
great talks um a lot of chatting on

26
00:00:54,960 --> 00:00:59,440
discord as well

27
00:00:56,480 --> 00:01:01,120
um so welcome thank you all for coming i

28
00:00:59,440 --> 00:01:03,760
am george ortiz

29
00:01:01,120 --> 00:01:05,840
and this is our hands-on purple team

30
00:01:03,760 --> 00:01:06,640
workshop we also have tim schultz he's

31
00:01:05,840 --> 00:01:09,439
hiding

32
00:01:06,640 --> 00:01:10,880
he's not showing his uh his video but

33
00:01:09,439 --> 00:01:13,679
he's gonna be helping me

34
00:01:10,880 --> 00:01:14,479
there you there there's tim uh tim just

35
00:01:13,680 --> 00:01:17,280
joined us

36
00:01:14,479 --> 00:01:18,400
um from sandia and before that he was

37
00:01:17,280 --> 00:01:21,520
with mitre

38
00:01:18,400 --> 00:01:23,280
he's our adversary emulation lead so

39
00:01:21,520 --> 00:01:24,640
excited to have him on board today is

40
00:01:23,280 --> 00:01:26,560
his sixth day

41
00:01:24,640 --> 00:01:28,400
we we're making him work six days in a

42
00:01:26,560 --> 00:01:29,439
row it's a it's a bad start tim i'm

43
00:01:28,400 --> 00:01:32,560
sorry we normally

44
00:01:29,439 --> 00:01:35,679
don't do this but yeah we're here it's

45
00:01:32,560 --> 00:01:37,360
it's all for cactus con so here we go um

46
00:01:35,680 --> 00:01:39,520
i'm george as i mentioned i'm the chief

47
00:01:37,360 --> 00:01:43,200
technology officer at scythe

48
00:01:39,520 --> 00:01:44,720
also a co-author of the purple team

49
00:01:43,200 --> 00:01:46,720
exercise framework which is what we're

50
00:01:44,720 --> 00:01:50,399
going to talk about here

51
00:01:46,720 --> 00:01:54,560
other projects c2 matrix uh cvss

52
00:01:50,399 --> 00:01:57,280
version 3 and version 3.1 epss a

53
00:01:54,560 --> 00:01:58,399
framework for thread led pen testing and

54
00:01:57,280 --> 00:02:00,880
i am part of

55
00:01:58,399 --> 00:02:02,799
issa i'm a fellow there as well as the

56
00:02:00,880 --> 00:02:06,079
national security institute

57
00:02:02,799 --> 00:02:08,479
prior to scythe i worked for 10 years

58
00:02:06,079 --> 00:02:09,519
running the offensive security team at

59
00:02:08,479 --> 00:02:11,599
city

60
00:02:09,520 --> 00:02:13,599
um lots of experience there and

61
00:02:11,599 --> 00:02:15,839
enterprise was a ton of fun

62
00:02:13,599 --> 00:02:16,959
love everyone there i also teach for

63
00:02:15,840 --> 00:02:18,720
sans

64
00:02:16,959 --> 00:02:20,720
i'm not sure if you all saw we just gave

65
00:02:18,720 --> 00:02:24,000
away a bunch of sans stuff a

66
00:02:20,720 --> 00:02:28,319
full sans course and um

67
00:02:24,000 --> 00:02:30,319
a four month access to network so that

68
00:02:28,319 --> 00:02:33,119
was during the q a of our talk

69
00:02:30,319 --> 00:02:36,000
should come out if you weren't there um

70
00:02:33,120 --> 00:02:37,840
i'm also the author of security 564

71
00:02:36,000 --> 00:02:39,840
which is right team exercises and

72
00:02:37,840 --> 00:02:42,080
adversary emulation

73
00:02:39,840 --> 00:02:43,920
let me check discord i'm still having

74
00:02:42,080 --> 00:02:46,000
the same issue i click on the link in my

75
00:02:43,920 --> 00:02:49,200
email asked me to join a meeting

76
00:02:46,000 --> 00:02:50,160
um okay i am sorry i cannot help you

77
00:02:49,200 --> 00:02:52,640
right now

78
00:02:50,160 --> 00:02:53,760
everyone else is on right you're all on

79
00:02:52,640 --> 00:02:57,679
you can hear me

80
00:02:53,760 --> 00:03:00,319
okay um hands-on workshop format

81
00:02:57,680 --> 00:03:01,120
so there's two ways you can do this you

82
00:03:00,319 --> 00:03:03,200
can

83
00:03:01,120 --> 00:03:04,720
watch this for like five minutes and

84
00:03:03,200 --> 00:03:05,359
i'll walk you through and just go do the

85
00:03:04,720 --> 00:03:08,879
hands-on

86
00:03:05,360 --> 00:03:12,239
part or you can watch me for

87
00:03:08,879 --> 00:03:14,560
like 40 minutes kind of give a brief on

88
00:03:12,239 --> 00:03:15,760
what we'll be doing and then go do it

89
00:03:14,560 --> 00:03:19,280
either way you have

90
00:03:15,760 --> 00:03:20,959
two hours with this environment it is a

91
00:03:19,280 --> 00:03:23,519
relatively new lab environment it's

92
00:03:20,959 --> 00:03:25,440
hosted on vmware learning platform

93
00:03:23,519 --> 00:03:26,799
which is nice because i can create the

94
00:03:25,440 --> 00:03:30,159
lab one time

95
00:03:26,799 --> 00:03:32,560
and then you all get your own labs

96
00:03:30,159 --> 00:03:33,519
so your environment your environment and

97
00:03:32,560 --> 00:03:36,879
your environment

98
00:03:33,519 --> 00:03:39,440
are all the same but different

99
00:03:36,879 --> 00:03:40,159
oh there we go you're on yes awesome

100
00:03:39,440 --> 00:03:41,760
welcome

101
00:03:40,159 --> 00:03:43,440
uh i was worried about you but i

102
00:03:41,760 --> 00:03:46,399
couldn't stop you know

103
00:03:43,440 --> 00:03:47,200
um the lab environment allows you to

104
00:03:46,400 --> 00:03:49,519
play

105
00:03:47,200 --> 00:03:51,599
the role of cyber threat intelligence

106
00:03:49,519 --> 00:03:54,480
red team and blue team

107
00:03:51,599 --> 00:03:55,518
um this is an intro to purple team lab

108
00:03:54,480 --> 00:03:59,599
so if you're here

109
00:03:55,519 --> 00:04:01,519
expecting to write like custom system on

110
00:03:59,599 --> 00:04:02,720
and send them over splunk you're gonna

111
00:04:01,519 --> 00:04:05,200
be interested in

112
00:04:02,720 --> 00:04:06,959
our intermediate workshop not in this

113
00:04:05,200 --> 00:04:08,079
one however this one's still cool

114
00:04:06,959 --> 00:04:10,560
because

115
00:04:08,080 --> 00:04:12,159
we are going to emulate some real threat

116
00:04:10,560 --> 00:04:14,000
actors we've seen in the wild

117
00:04:12,159 --> 00:04:16,159
particularly two that are going after

118
00:04:14,000 --> 00:04:17,519
hospitals and that's not cool and that's

119
00:04:16,160 --> 00:04:20,959
why we are doing them

120
00:04:17,519 --> 00:04:22,639
because like who goes after hospitals

121
00:04:20,959 --> 00:04:24,080
during coven you know who goes after

122
00:04:22,639 --> 00:04:26,800
hospitals at any time

123
00:04:24,080 --> 00:04:28,320
but yeah we don't like them um so we're

124
00:04:26,800 --> 00:04:30,720
gonna learn how they operate

125
00:04:28,320 --> 00:04:32,800
and then we are going to emulate those

126
00:04:30,720 --> 00:04:34,800
same adversaries so that you can

127
00:04:32,800 --> 00:04:36,880
uh figure out how to defend against them

128
00:04:34,800 --> 00:04:37,840
those two are called orange worm and

129
00:04:36,880 --> 00:04:40,159
ryuk

130
00:04:37,840 --> 00:04:41,599
sure you've heard of at least one of

131
00:04:40,160 --> 00:04:42,960
those in the news

132
00:04:41,600 --> 00:04:45,280
so i'm going to introduce some of the

133
00:04:42,960 --> 00:04:46,960
concepts oh it says three hours we do

134
00:04:45,280 --> 00:04:50,000
not have three hours

135
00:04:46,960 --> 00:04:53,440
two hours total time sorry

136
00:04:50,000 --> 00:04:56,639
there you go oh my gosh google

137
00:04:53,440 --> 00:04:59,680
why do you do this two hours total time

138
00:04:56,639 --> 00:05:00,720
um self-paced there's a manual i'm gonna

139
00:04:59,680 --> 00:05:03,280
walk you through it

140
00:05:00,720 --> 00:05:04,880
you have four systems a windows member

141
00:05:03,280 --> 00:05:06,320
server you log in with it which is

142
00:05:04,880 --> 00:05:07,120
called unicorn because we're the

143
00:05:06,320 --> 00:05:09,680
unicorns

144
00:05:07,120 --> 00:05:11,520
and we love our brand um that's a

145
00:05:09,680 --> 00:05:13,199
windows member server

146
00:05:11,520 --> 00:05:14,639
and then there's the site attack

147
00:05:13,199 --> 00:05:17,199
platform there

148
00:05:14,639 --> 00:05:18,000
is the sand slingshot c2 matrix edition

149
00:05:17,199 --> 00:05:20,479
that's a virtua

150
00:05:18,000 --> 00:05:22,479
that's a uh vm that we give out for free

151
00:05:20,479 --> 00:05:24,159
and you can actually download that one

152
00:05:22,479 --> 00:05:26,800
um right now it's really the only one

153
00:05:24,160 --> 00:05:28,479
that you can download after the workshop

154
00:05:26,800 --> 00:05:30,320
um and it has a bunch of c2s

155
00:05:28,479 --> 00:05:31,359
pre-installed including vector which

156
00:05:30,320 --> 00:05:33,120
we're going to use here

157
00:05:31,360 --> 00:05:34,400
and there's a domain controller because

158
00:05:33,120 --> 00:05:35,039
how many of you operate in an

159
00:05:34,400 --> 00:05:37,198
environment

160
00:05:35,039 --> 00:05:38,159
that doesn't have a domain controller

161
00:05:37,199 --> 00:05:41,039
right

162
00:05:38,160 --> 00:05:42,240
so um what are you doing here you're

163
00:05:41,039 --> 00:05:43,840
learning you're going to learn by

164
00:05:42,240 --> 00:05:46,320
listening by seeing and by

165
00:05:43,840 --> 00:05:47,840
doing all in your own environment if you

166
00:05:46,320 --> 00:05:50,320
trust that environment

167
00:05:47,840 --> 00:05:51,359
nice job i worked really hard and making

168
00:05:50,320 --> 00:05:53,520
it hard to trash

169
00:05:51,360 --> 00:05:54,400
but if you did hey we're all breakers so

170
00:05:53,520 --> 00:05:56,960
that's awesome

171
00:05:54,400 --> 00:05:57,840
but you won't affect anyone else which

172
00:05:56,960 --> 00:05:59,840
is great

173
00:05:57,840 --> 00:06:01,119
doesn't affect anyone's else learning

174
00:05:59,840 --> 00:06:02,719
ability um

175
00:06:01,120 --> 00:06:04,160
and really the whole reason that we do

176
00:06:02,720 --> 00:06:05,120
this is for you to be able to take this

177
00:06:04,160 --> 00:06:07,759
back to work

178
00:06:05,120 --> 00:06:08,800
um for you to understand the value in

179
00:06:07,759 --> 00:06:12,479
purple teaming

180
00:06:08,800 --> 00:06:14,639
and in working together across silos and

181
00:06:12,479 --> 00:06:17,360
within other teams in your organization

182
00:06:14,639 --> 00:06:18,080
we also made a framework available for

183
00:06:17,360 --> 00:06:20,160
free

184
00:06:18,080 --> 00:06:22,000
that you can download and go through and

185
00:06:20,160 --> 00:06:24,080
of course you can get some cpe credits

186
00:06:22,000 --> 00:06:26,160
because i know some of you all need that

187
00:06:24,080 --> 00:06:27,359
and that's totally fine we'll give you

188
00:06:26,160 --> 00:06:29,600
some cpes

189
00:06:27,360 --> 00:06:30,880
at the end once you're done we don't

190
00:06:29,600 --> 00:06:33,039
just give them for free

191
00:06:30,880 --> 00:06:34,960
right um if not we're not allowed to

192
00:06:33,039 --> 00:06:38,960
give them so

193
00:06:34,960 --> 00:06:38,960
um let me jump over to that

194
00:06:39,759 --> 00:06:43,039
oh my gosh so many windows are open all

195
00:06:42,639 --> 00:06:45,919
right

196
00:06:43,039 --> 00:06:47,680
so you should have received an email

197
00:06:45,919 --> 00:06:49,599
that looks like this

198
00:06:47,680 --> 00:06:51,120
vmware learning platform user

199
00:06:49,599 --> 00:06:53,120
entitlement created or something

200
00:06:51,120 --> 00:06:55,960
different i actually created this

201
00:06:53,120 --> 00:06:58,720
but um it's called events it's from

202
00:06:55,960 --> 00:07:00,960
events.i o and it says dear user

203
00:06:58,720 --> 00:07:02,960
entitlement with quick launch url

204
00:07:00,960 --> 00:07:04,799
created regards the site team or

205
00:07:02,960 --> 00:07:07,840
something to that nature

206
00:07:04,800 --> 00:07:08,639
and if you click on that you're going to

207
00:07:07,840 --> 00:07:11,359
be taken

208
00:07:08,639 --> 00:07:13,199
to another screen the actual email

209
00:07:11,360 --> 00:07:15,199
subject thank you nicholas is

210
00:07:13,199 --> 00:07:16,720
purple team workshop vmware learning

211
00:07:15,199 --> 00:07:18,720
platform class started

212
00:07:16,720 --> 00:07:21,440
thank you see i run these workshops and

213
00:07:18,720 --> 00:07:23,199
i actually don't add myself as a user so

214
00:07:21,440 --> 00:07:25,039
i don't know what the user sees

215
00:07:23,199 --> 00:07:31,599
and then i remember and i go back and do

216
00:07:25,039 --> 00:07:34,719
this um

217
00:07:31,599 --> 00:07:35,199
so this once you click on it it's from

218
00:07:34,720 --> 00:07:38,400
events

219
00:07:35,199 --> 00:07:40,360
at site.io um or at least that's what it

220
00:07:38,400 --> 00:07:41,599
looks like it's really from

221
00:07:40,360 --> 00:07:43,840
learningplatform.vmware.com

222
00:07:41,599 --> 00:07:46,159
if you're looking that deep um but

223
00:07:43,840 --> 00:07:46,799
anyway you click on it and you're taken

224
00:07:46,160 --> 00:07:50,000
to this

225
00:07:46,800 --> 00:07:50,960
screen and here you're gonna see time

226
00:07:50,000 --> 00:07:52,560
remaining

227
00:07:50,960 --> 00:07:54,239
mine's a little different because like i

228
00:07:52,560 --> 00:07:55,039
said i'm different and i did it

229
00:07:54,240 --> 00:07:57,280
differently

230
00:07:55,039 --> 00:07:58,560
but let me walk you through this so if

231
00:07:57,280 --> 00:07:59,359
you're going to do your own hands-on

232
00:07:58,560 --> 00:08:01,599
thing

233
00:07:59,360 --> 00:08:03,360
let me at least tell you a little bit

234
00:08:01,599 --> 00:08:05,039
about vmware learning platform

235
00:08:03,360 --> 00:08:07,599
assuming this the first time you've used

236
00:08:05,039 --> 00:08:08,639
it over on the left you have your

237
00:08:07,599 --> 00:08:10,479
consoles

238
00:08:08,639 --> 00:08:14,080
when you click on consoles you will see

239
00:08:10,479 --> 00:08:16,639
two of them unicorn and sand slingshot

240
00:08:14,080 --> 00:08:17,520
mostly everything here that we walk you

241
00:08:16,639 --> 00:08:20,879
through

242
00:08:17,520 --> 00:08:23,039
is on unicorn this

243
00:08:20,879 --> 00:08:24,240
is the console you can then close it and

244
00:08:23,039 --> 00:08:26,560
see a nice

245
00:08:24,240 --> 00:08:28,000
more sized console in the middle you

246
00:08:26,560 --> 00:08:28,800
have your console i'll talk about that

247
00:08:28,000 --> 00:08:31,759
in a second

248
00:08:28,800 --> 00:08:32,719
and in the right you have your manual so

249
00:08:31,759 --> 00:08:34,959
your manual

250
00:08:32,719 --> 00:08:36,399
you should read we're all in infosec we

251
00:08:34,958 --> 00:08:39,199
must love to read

252
00:08:36,399 --> 00:08:40,880
uh tells you a little bit about uh this

253
00:08:39,200 --> 00:08:42,880
portion of the lab

254
00:08:40,880 --> 00:08:44,800
and it goes through does an intro to

255
00:08:42,880 --> 00:08:47,279
command and control

256
00:08:44,800 --> 00:08:48,959
and then you set up a scenario where you

257
00:08:47,279 --> 00:08:50,720
create your own campaign

258
00:08:48,959 --> 00:08:52,640
and as you go through it you're gonna

259
00:08:50,720 --> 00:08:54,160
create command and control you're gonna

260
00:08:52,640 --> 00:08:56,080
create a payload

261
00:08:54,160 --> 00:08:57,839
then you're going to do some detection

262
00:08:56,080 --> 00:09:00,959
you know the blue team side

263
00:08:57,839 --> 00:09:04,320
some wire shark then you're going to do

264
00:09:00,959 --> 00:09:04,959
some uh cti you're going to read a

265
00:09:04,320 --> 00:09:08,000
little about

266
00:09:04,959 --> 00:09:09,680
orange worm etc and you go through step

267
00:09:08,000 --> 00:09:11,120
by step you can also hit this little

268
00:09:09,680 --> 00:09:12,719
window here on the right

269
00:09:11,120 --> 00:09:14,160
and just go you're going to do some

270
00:09:12,720 --> 00:09:17,360
sysmon so

271
00:09:14,160 --> 00:09:21,120
um we we will be using all offs

272
00:09:17,360 --> 00:09:23,200
uh sysmon modular we also have swift on

273
00:09:21,120 --> 00:09:25,519
securities if you prefer that one

274
00:09:23,200 --> 00:09:26,399
um and then we'll execute some other

275
00:09:25,519 --> 00:09:28,720
campaigns

276
00:09:26,399 --> 00:09:30,720
etc etc but you get it right you like

277
00:09:28,720 --> 00:09:32,000
hint next next next next next

278
00:09:30,720 --> 00:09:33,600
and then when you get all the way at the

279
00:09:32,000 --> 00:09:34,640
end it's gonna tell you how to get your

280
00:09:33,600 --> 00:09:37,120
cpes

281
00:09:34,640 --> 00:09:38,560
and share on social media because we

282
00:09:37,120 --> 00:09:41,600
love you and we want you to

283
00:09:38,560 --> 00:09:44,640
share this with us now

284
00:09:41,600 --> 00:09:45,839
in the middle is the console the console

285
00:09:44,640 --> 00:09:46,640
is where you're going to do most of your

286
00:09:45,839 --> 00:09:48,880
work

287
00:09:46,640 --> 00:09:50,319
so this is a standard windows console

288
00:09:48,880 --> 00:09:50,959
note that the time is completely

289
00:09:50,320 --> 00:09:55,040
different than

290
00:09:50,959 --> 00:09:56,560
any time ever hit control delete up on

291
00:09:55,040 --> 00:09:58,560
the top you see it right here

292
00:09:56,560 --> 00:09:59,920
and then you need to log in what is the

293
00:09:58,560 --> 00:10:02,560
password

294
00:09:59,920 --> 00:10:03,599
nobody knows but if you click on notes

295
00:10:02,560 --> 00:10:06,800
it's going to tell you

296
00:10:03,600 --> 00:10:09,839
again everyone listening

297
00:10:06,800 --> 00:10:10,800
all right got your attention the

298
00:10:09,839 --> 00:10:12,560
passwords

299
00:10:10,800 --> 00:10:15,599
for everything you're gonna need in this

300
00:10:12,560 --> 00:10:15,920
lab is up on the notes you see right

301
00:10:15,600 --> 00:10:18,560
here

302
00:10:15,920 --> 00:10:19,839
notes click on it you see a username and

303
00:10:18,560 --> 00:10:21,839
the password to log

304
00:10:19,839 --> 00:10:23,360
in as well as the username and the

305
00:10:21,839 --> 00:10:26,880
password for site and

306
00:10:23,360 --> 00:10:27,360
vector scythe is your attack platform

307
00:10:26,880 --> 00:10:29,839
vector

308
00:10:27,360 --> 00:10:31,040
is your tracking platform so you log in

309
00:10:29,839 --> 00:10:34,399
with student you hit

310
00:10:31,040 --> 00:10:36,800
enter and you are in this environment

311
00:10:34,399 --> 00:10:38,959
has multiple virtual machines

312
00:10:36,800 --> 00:10:43,120
that it's right here it tells you look

313
00:10:38,959 --> 00:10:45,839
you're on unicorn it's on 196 192 168020

314
00:10:43,120 --> 00:10:46,720
there's a dc a domain controller is an

315
00:10:45,839 --> 00:10:48,720
attack server

316
00:10:46,720 --> 00:10:49,760
there's also the sans slingshot c2

317
00:10:48,720 --> 00:10:51,760
matrix edition

318
00:10:49,760 --> 00:10:53,680
that has a bunch of other c2s that you

319
00:10:51,760 --> 00:10:55,600
can play with as well

320
00:10:53,680 --> 00:10:56,880
really up to you we walk you through a

321
00:10:55,600 --> 00:11:00,640
lot of this right

322
00:10:56,880 --> 00:11:03,760
so that's the most important part

323
00:11:00,640 --> 00:11:07,680
now if you need help

324
00:11:03,760 --> 00:11:11,040
you can message us on chat

325
00:11:07,680 --> 00:11:11,920
or on q a in zoom that's why we're using

326
00:11:11,040 --> 00:11:14,719
zoom

327
00:11:11,920 --> 00:11:16,000
we had we opened this up to i think 100

328
00:11:14,720 --> 00:11:18,320
or so people

329
00:11:16,000 --> 00:11:20,160
more than discord accepts so that's why

330
00:11:18,320 --> 00:11:23,920
we are not using discord

331
00:11:20,160 --> 00:11:24,399
discord only accepts i believe it's 50

332
00:11:23,920 --> 00:11:28,240
people

333
00:11:24,399 --> 00:11:32,000
so if you have questions let us know

334
00:11:28,240 --> 00:11:35,279
because we can actually see your screens

335
00:11:32,000 --> 00:11:36,959
see over here we see everyone's console

336
00:11:35,279 --> 00:11:39,600
and i can search through anyone's

337
00:11:36,959 --> 00:11:42,719
console so if you have questions

338
00:11:39,600 --> 00:11:45,839
i can go and find you i can

339
00:11:42,720 --> 00:11:47,120
get access to your console and i can

340
00:11:45,839 --> 00:11:49,519
actually take over it

341
00:11:47,120 --> 00:11:51,360
to help you through it tim is also on

342
00:11:49,519 --> 00:11:54,000
and he can help you as well

343
00:11:51,360 --> 00:11:55,200
so anyone that needs help you can send

344
00:11:54,000 --> 00:11:58,240
the panelists

345
00:11:55,200 --> 00:12:02,639
a question through chat again that's

346
00:11:58,240 --> 00:12:02,639
zoom chat or zoom q a

347
00:12:03,440 --> 00:12:07,279
should we have two or four vms in our

348
00:12:05,440 --> 00:12:10,959
environment well yes you can only see

349
00:12:07,279 --> 00:12:12,160
two but yes there are four you only have

350
00:12:10,959 --> 00:12:15,279
access to two

351
00:12:12,160 --> 00:12:17,519
and that is because it's by design

352
00:12:15,279 --> 00:12:20,000
so the domain controller you should be

353
00:12:17,519 --> 00:12:23,360
able to get to

354
00:12:20,000 --> 00:12:24,079
we'll see um and the site server you

355
00:12:23,360 --> 00:12:25,839
don't have access

356
00:12:24,079 --> 00:12:27,199
to a server itself you have access to

357
00:12:25,839 --> 00:12:29,839
the web application

358
00:12:27,200 --> 00:12:31,760
so there are four vms they're all up you

359
00:12:29,839 --> 00:12:34,959
can try pinging them

360
00:12:31,760 --> 00:12:36,839
um and confirm that they're they're

361
00:12:34,959 --> 00:12:40,479
there right so if you ping

362
00:12:36,839 --> 00:12:43,120
192. you missed the login credentials i

363
00:12:40,480 --> 00:12:43,680
knew it someone was gonna do this all

364
00:12:43,120 --> 00:12:45,600
right

365
00:12:43,680 --> 00:12:46,800
one more time where are the login

366
00:12:45,600 --> 00:12:49,839
credentials

367
00:12:46,800 --> 00:12:50,560
anyone notes right up here where it says

368
00:12:49,839 --> 00:12:53,680
notes

369
00:12:50,560 --> 00:12:55,199
there username password credentials also

370
00:12:53,680 --> 00:12:56,079
when you are going through this i think

371
00:12:55,200 --> 00:12:59,120
it's like step

372
00:12:56,079 --> 00:13:00,880
four it also tells you the credentials i

373
00:12:59,120 --> 00:13:01,680
think like step 20 also tells your

374
00:13:00,880 --> 00:13:03,680
credentials

375
00:13:01,680 --> 00:13:06,160
but i knew i knew that question was

376
00:13:03,680 --> 00:13:09,519
going to come it's that's 100 chance

377
00:13:06,160 --> 00:13:12,639
so notes there there it is there there

378
00:13:09,519 --> 00:13:14,560
all right so

379
00:13:12,639 --> 00:13:16,240
everyone good everyone that's going to

380
00:13:14,560 --> 00:13:18,399
go on their own good

381
00:13:16,240 --> 00:13:19,760
you can also leave me on i'll talk for

382
00:13:18,399 --> 00:13:24,240
like the next

383
00:13:19,760 --> 00:13:26,240
40 minutes i'm gonna go very quick um

384
00:13:24,240 --> 00:13:27,680
but yeah you should you should be set up

385
00:13:26,240 --> 00:13:29,920
and ready to go so

386
00:13:27,680 --> 00:13:31,599
um what are we learning here what are we

387
00:13:29,920 --> 00:13:32,399
learning today we are learning about

388
00:13:31,600 --> 00:13:34,079
purple teaming

389
00:13:32,399 --> 00:13:35,680
what is purple teaming i keep hearing it

390
00:13:34,079 --> 00:13:37,920
isn't that just when the red and the

391
00:13:35,680 --> 00:13:40,399
blue team work together george

392
00:13:37,920 --> 00:13:40,959
why is there a whole workshop on this um

393
00:13:40,399 --> 00:13:44,480
yes

394
00:13:40,959 --> 00:13:46,399
and no um well we'll show you we'll show

395
00:13:44,480 --> 00:13:48,079
you what we have experienced when trying

396
00:13:46,399 --> 00:13:49,920
to get red and blue to work together

397
00:13:48,079 --> 00:13:52,479
i'll also cover some ethical hacking

398
00:13:49,920 --> 00:13:55,599
evolution so if you're new to infosec

399
00:13:52,480 --> 00:13:58,880
welcome we love you all

400
00:13:55,600 --> 00:14:00,720
we are very very inclusive we allow

401
00:13:58,880 --> 00:14:02,720
anyone into our community so if you're

402
00:14:00,720 --> 00:14:06,720
new and you've never done anything

403
00:14:02,720 --> 00:14:08,720
um in red or blue that's completely fine

404
00:14:06,720 --> 00:14:09,760
we're going to walk you through stay and

405
00:14:08,720 --> 00:14:10,959
listen

406
00:14:09,760 --> 00:14:12,880
we're also going to introduce our

407
00:14:10,959 --> 00:14:13,599
frameworks because when you go and you

408
00:14:12,880 --> 00:14:16,959
tell

409
00:14:13,600 --> 00:14:18,240
either a client or your boss like hey we

410
00:14:16,959 --> 00:14:19,839
should do purple teaming

411
00:14:18,240 --> 00:14:21,199
they're going to say okay what is that

412
00:14:19,839 --> 00:14:22,639
and then you say look there's a

413
00:14:21,199 --> 00:14:24,959
framework around and there's a

414
00:14:22,639 --> 00:14:26,639
methodology it's documented and look at

415
00:14:24,959 --> 00:14:29,279
the value that you can do

416
00:14:26,639 --> 00:14:30,320
then that kind of gets you off started

417
00:14:29,279 --> 00:14:33,439
in the right foot

418
00:14:30,320 --> 00:14:34,079
um that's from some experience um i've

419
00:14:33,440 --> 00:14:36,959
had

420
00:14:34,079 --> 00:14:37,920
uh in enterprise trying to you know move

421
00:14:36,959 --> 00:14:40,319
our

422
00:14:37,920 --> 00:14:42,079
industry forward then we're gonna cover

423
00:14:40,320 --> 00:14:43,519
cyber threat intelligence see a lot of

424
00:14:42,079 --> 00:14:45,040
people think purple teaming is red and

425
00:14:43,519 --> 00:14:46,800
blue

426
00:14:45,040 --> 00:14:48,399
um we also cover cyber threat

427
00:14:46,800 --> 00:14:49,920
intelligence which is very important

428
00:14:48,399 --> 00:14:52,959
then we're going to cover preparing for

429
00:14:49,920 --> 00:14:54,719
an exercise executing an exercise

430
00:14:52,959 --> 00:14:56,560
and doing lessons learned and then of

431
00:14:54,720 --> 00:14:57,040
course at the end you'll have about an

432
00:14:56,560 --> 00:14:59,839
hour

433
00:14:57,040 --> 00:15:01,199
if you hear me and don't multitask

434
00:14:59,839 --> 00:15:04,399
you'll have about an hour which is

435
00:15:01,199 --> 00:15:04,399
enough to get through everything

436
00:15:04,480 --> 00:15:08,720
so what is a purple team it's a virtual

437
00:15:06,560 --> 00:15:10,399
team i actually only know two companies

438
00:15:08,720 --> 00:15:12,240
that have dedicated purple teams

439
00:15:10,399 --> 00:15:14,560
i'm sure that this will continue to

440
00:15:12,240 --> 00:15:16,560
evolve and there will be organizations

441
00:15:14,560 --> 00:15:18,000
hiring actual purple teemos which is

442
00:15:16,560 --> 00:15:19,680
really cool um

443
00:15:18,000 --> 00:15:21,680
but to get there you kind of need to

444
00:15:19,680 --> 00:15:23,439
understand some other

445
00:15:21,680 --> 00:15:25,680
things in information security for

446
00:15:23,440 --> 00:15:27,920
example cyber threat intelligence

447
00:15:25,680 --> 00:15:28,800
that's the team that understands your

448
00:15:27,920 --> 00:15:31,279
threat model

449
00:15:28,800 --> 00:15:32,240
understands what attackers are likely to

450
00:15:31,279 --> 00:15:35,360
target you

451
00:15:32,240 --> 00:15:38,560
and investigate them they understand

452
00:15:35,360 --> 00:15:41,360
the adversary behaviors the tactics

453
00:15:38,560 --> 00:15:42,160
techniques and procedures then you have

454
00:15:41,360 --> 00:15:43,839
your red team

455
00:15:42,160 --> 00:15:45,680
a lot of people know this one right the

456
00:15:43,839 --> 00:15:47,600
offensive team they're in charge of

457
00:15:45,680 --> 00:15:49,680
emulating adversaries

458
00:15:47,600 --> 00:15:50,800
and then your blue team and i know none

459
00:15:49,680 --> 00:15:53,758
of you are hired to be

460
00:15:50,800 --> 00:15:54,079
a blue team this is a catch-all phrase

461
00:15:53,759 --> 00:15:55,600
it's

462
00:15:54,079 --> 00:15:57,120
anyone that does defense all the

463
00:15:55,600 --> 00:15:59,680
defenders

464
00:15:57,120 --> 00:16:01,920
security operations center hunt teams

465
00:15:59,680 --> 00:16:03,680
digital forensics and incident response

466
00:16:01,920 --> 00:16:05,439
managed security service providers

467
00:16:03,680 --> 00:16:09,599
manage detection response

468
00:16:05,440 --> 00:16:12,240
you're all blue so how hard can this be

469
00:16:09,600 --> 00:16:13,440
we take red we mix it with blue we make

470
00:16:12,240 --> 00:16:16,560
them work together

471
00:16:13,440 --> 00:16:17,199
pretty easy right or we let mike tyson

472
00:16:16,560 --> 00:16:19,518
tell us

473
00:16:17,199 --> 00:16:21,359
how to make this happen right red and

474
00:16:19,519 --> 00:16:24,560
blue just work together right

475
00:16:21,360 --> 00:16:26,399
now kith right

476
00:16:24,560 --> 00:16:28,239
really this is what we think will happen

477
00:16:26,399 --> 00:16:31,680
you get your offensive team you get your

478
00:16:28,240 --> 00:16:33,839
blue team you put them in a room and

479
00:16:31,680 --> 00:16:35,758
look at all these smiling faces

480
00:16:33,839 --> 00:16:38,800
everyone's just getting along

481
00:16:35,759 --> 00:16:40,639
being all collaborative right wrong

482
00:16:38,800 --> 00:16:42,800
generally not what happens generally

483
00:16:40,639 --> 00:16:46,079
you're gonna have some pre-existing

484
00:16:42,800 --> 00:16:48,079
um emotions going on people not liking

485
00:16:46,079 --> 00:16:50,160
each other is very very typical

486
00:16:48,079 --> 00:16:51,120
so it really complicates what you're

487
00:16:50,160 --> 00:16:53,199
trying to do

488
00:16:51,120 --> 00:16:54,240
and that's why we're here now if you've

489
00:16:53,199 --> 00:16:56,479
never seen this

490
00:16:54,240 --> 00:16:58,399
we were actually or maybe you missed our

491
00:16:56,480 --> 00:16:59,360
talk we actually did a whole hour talk

492
00:16:58,399 --> 00:17:02,480
at cactus con

493
00:16:59,360 --> 00:17:05,199
on this exact test case because

494
00:17:02,480 --> 00:17:06,319
one particular uh client that we've done

495
00:17:05,199 --> 00:17:09,039
purple teammate

496
00:17:06,319 --> 00:17:11,039
with allowed us to share what we did we

497
00:17:09,039 --> 00:17:13,199
did a six-week exercise with them

498
00:17:11,039 --> 00:17:14,959
week one we did a baseline just

499
00:17:13,199 --> 00:17:16,959
understood their controls

500
00:17:14,959 --> 00:17:18,160
because we were also being blue team

501
00:17:16,959 --> 00:17:19,360
there

502
00:17:18,160 --> 00:17:21,839
then we started with a low

503
00:17:19,359 --> 00:17:24,479
sophistication actor and worked our way

504
00:17:21,839 --> 00:17:26,240
up week over week and they told us we

505
00:17:24,480 --> 00:17:28,079
want you to improve our security but do

506
00:17:26,240 --> 00:17:30,080
not spend any money on technology how

507
00:17:28,079 --> 00:17:32,080
many times have you heard that right

508
00:17:30,080 --> 00:17:34,000
and it's completely possible when you

509
00:17:32,080 --> 00:17:37,280
focus on people and process

510
00:17:34,000 --> 00:17:40,080
which is what purple team does so

511
00:17:37,280 --> 00:17:40,720
um what did we do oh oh hit the wrong

512
00:17:40,080 --> 00:17:43,678
one

513
00:17:40,720 --> 00:17:46,160
so we went in we emulated a whole bunch

514
00:17:43,679 --> 00:17:46,480
of threat actors and they did not detect

515
00:17:46,160 --> 00:17:50,400
us

516
00:17:46,480 --> 00:17:52,799
at all 94 94

517
00:17:50,400 --> 00:17:54,400
not detected rate not even locally no

518
00:17:52,799 --> 00:17:58,240
local logging nothing

519
00:17:54,400 --> 00:18:00,240
they did catch uh three various uh

520
00:17:58,240 --> 00:18:01,840
test cases which were around scheduled

521
00:18:00,240 --> 00:18:05,200
tasks which was good

522
00:18:01,840 --> 00:18:07,600
and then one test case was blocked then

523
00:18:05,200 --> 00:18:09,120
through only enabling telemetry things

524
00:18:07,600 --> 00:18:10,320
like sysmon which you're going to learn

525
00:18:09,120 --> 00:18:13,439
about today

526
00:18:10,320 --> 00:18:14,879
and creating some logic on their sim

527
00:18:13,440 --> 00:18:18,240
which was event sentry

528
00:18:14,880 --> 00:18:21,440
we were able to detect 64 percent

529
00:18:18,240 --> 00:18:22,160
of these adversary behaviors so that's

530
00:18:21,440 --> 00:18:24,240
pretty good

531
00:18:22,160 --> 00:18:25,520
especially with zero dollar spent in

532
00:18:24,240 --> 00:18:28,960
technology

533
00:18:25,520 --> 00:18:31,440
can we download the manual um you can't

534
00:18:28,960 --> 00:18:32,880
but someone actually already grabbed it

535
00:18:31,440 --> 00:18:36,720
and put it on github

536
00:18:32,880 --> 00:18:38,640
i'm gonna share that with you on um

537
00:18:36,720 --> 00:18:40,080
i'll i'll share with it i'll share with

538
00:18:38,640 --> 00:18:42,080
you when i'm done speaking

539
00:18:40,080 --> 00:18:44,159
um but yeah someone already copied and

540
00:18:42,080 --> 00:18:47,760
pasted every single page onto github

541
00:18:44,160 --> 00:18:50,160
um so how did we get here

542
00:18:47,760 --> 00:18:51,520
well if you've ever done offensive

543
00:18:50,160 --> 00:18:55,440
security

544
00:18:51,520 --> 00:18:57,120
or ethical hacking um then

545
00:18:55,440 --> 00:18:58,960
you probably started doing vulnerability

546
00:18:57,120 --> 00:19:00,559
scanning which is totally fine

547
00:18:58,960 --> 00:19:02,480
this is important to know what

548
00:19:00,559 --> 00:19:02,879
vulnerabilities exist in your perimeter

549
00:19:02,480 --> 00:19:06,080
and

550
00:19:02,880 --> 00:19:07,679
your internal network but nessus and

551
00:19:06,080 --> 00:19:10,320
rapid7 and

552
00:19:07,679 --> 00:19:11,200
uh you know all the other vendors right

553
00:19:10,320 --> 00:19:13,439
qualis

554
00:19:11,200 --> 00:19:14,400
sorry i'm not saying anyone's better or

555
00:19:13,440 --> 00:19:18,880
worse

556
00:19:14,400 --> 00:19:21,200
they provide very long reports and

557
00:19:18,880 --> 00:19:23,200
you are overwhelmed uh my previous

558
00:19:21,200 --> 00:19:25,840
employer had 1.2 million

559
00:19:23,200 --> 00:19:26,799
internal systems imagine how many

560
00:19:25,840 --> 00:19:28,399
vulnerabilities

561
00:19:26,799 --> 00:19:30,639
we would have when we ran a

562
00:19:28,400 --> 00:19:32,720
vulnerability scan right yeah i'm not

563
00:19:30,640 --> 00:19:35,840
going to confirm or deny the number

564
00:19:32,720 --> 00:19:37,840
but yeah it was up there so

565
00:19:35,840 --> 00:19:39,678
um you then have vulnerability

566
00:19:37,840 --> 00:19:43,199
assessment you have people actually

567
00:19:39,679 --> 00:19:44,480
looking at those results verifying

568
00:19:43,200 --> 00:19:46,880
vulnerabilities exist

569
00:19:44,480 --> 00:19:49,200
calculating cvss scores and before you

570
00:19:46,880 --> 00:19:52,000
all give me crap about cvss

571
00:19:49,200 --> 00:19:54,480
make sure you calculate the temporal

572
00:19:52,000 --> 00:19:56,480
environmental score for your environment

573
00:19:54,480 --> 00:19:57,520
of course the base scores are going to

574
00:19:56,480 --> 00:20:01,360
be uneven

575
00:19:57,520 --> 00:20:02,799
their base scores then we figured out

576
00:20:01,360 --> 00:20:05,280
that we can actually

577
00:20:02,799 --> 00:20:06,799
exploit vulnerabilities and gain access

578
00:20:05,280 --> 00:20:09,918
to these systems

579
00:20:06,799 --> 00:20:10,400
through penetration testing so we did

580
00:20:09,919 --> 00:20:13,280
that

581
00:20:10,400 --> 00:20:13,840
and that also brings a lot of value and

582
00:20:13,280 --> 00:20:17,840
then we

583
00:20:13,840 --> 00:20:19,439
saw that malicious actors

584
00:20:17,840 --> 00:20:21,760
weren't just getting in through

585
00:20:19,440 --> 00:20:22,720
technology flaws they were getting in

586
00:20:21,760 --> 00:20:26,480
through

587
00:20:22,720 --> 00:20:29,760
phishing social engineering

588
00:20:26,480 --> 00:20:32,480
right and we realized that

589
00:20:29,760 --> 00:20:33,520
we needed to test people process and

590
00:20:32,480 --> 00:20:36,799
technology

591
00:20:33,520 --> 00:20:38,320
not just technology so we did some zero

592
00:20:36,799 --> 00:20:40,158
knowledge of red team engagements

593
00:20:38,320 --> 00:20:41,678
looking at the organization holistically

594
00:20:40,159 --> 00:20:44,480
and guess what we got in

595
00:20:41,679 --> 00:20:45,520
yeah we got in every single time 100

596
00:20:44,480 --> 00:20:47,120
success rate

597
00:20:45,520 --> 00:20:48,639
dropped the report over on the blue

598
00:20:47,120 --> 00:20:50,879
team's desk and say

599
00:20:48,640 --> 00:20:51,760
you need to get better we'll be back in

600
00:20:50,880 --> 00:20:53,520
a year

601
00:20:51,760 --> 00:20:54,879
and uh hopefully you're improved because

602
00:20:53,520 --> 00:20:58,158
this was easy

603
00:20:54,880 --> 00:21:00,400
and that was a problem that ego right um

604
00:20:58,159 --> 00:21:01,360
so we figured out that if we actually

605
00:21:00,400 --> 00:21:03,760
work together

606
00:21:01,360 --> 00:21:05,918
with the blue team and show them how the

607
00:21:03,760 --> 00:21:06,960
red team operates or an adversary

608
00:21:05,919 --> 00:21:09,840
operates

609
00:21:06,960 --> 00:21:10,720
then we can more efficiently and

610
00:21:09,840 --> 00:21:15,039
effectively

611
00:21:10,720 --> 00:21:15,760
fix issues and then instead of just

612
00:21:15,039 --> 00:21:18,320
going full

613
00:21:15,760 --> 00:21:19,520
cyber like my friend jake williams likes

614
00:21:18,320 --> 00:21:21,360
to say

615
00:21:19,520 --> 00:21:22,559
how about we actually emulate

616
00:21:21,360 --> 00:21:26,080
adversaries that are

617
00:21:22,559 --> 00:21:28,799
likely to attack us and

618
00:21:26,080 --> 00:21:29,120
yeah i gave you a whole maturity model

619
00:21:28,799 --> 00:21:31,280
but

620
00:21:29,120 --> 00:21:32,799
just really at the highest level

621
00:21:31,280 --> 00:21:34,399
currently a lot of organizations are

622
00:21:32,799 --> 00:21:36,879
only using cves

623
00:21:34,400 --> 00:21:37,919
common vulnerabilities and exposures to

624
00:21:36,880 --> 00:21:41,679
identify

625
00:21:37,919 --> 00:21:43,120
methods in you need to evolve to tactics

626
00:21:41,679 --> 00:21:44,640
techniques and procedures those

627
00:21:43,120 --> 00:21:49,039
adversary behaviors

628
00:21:44,640 --> 00:21:52,080
also after what we saw in december 2020

629
00:21:49,039 --> 00:21:54,240
right with fireeye microsoft

630
00:21:52,080 --> 00:21:55,360
solarwinds right all these organizations

631
00:21:54,240 --> 00:21:57,679
getting breached

632
00:21:55,360 --> 00:21:59,199
we pretty much have determined that

633
00:21:57,679 --> 00:22:01,440
everyone's going to get breached

634
00:21:59,200 --> 00:22:02,720
right if the ones with the most budget

635
00:22:01,440 --> 00:22:05,760
aren't uh

636
00:22:02,720 --> 00:22:07,280
aren't able to prevent an attack

637
00:22:05,760 --> 00:22:08,879
neither will the ones with less budget

638
00:22:07,280 --> 00:22:10,720
right and i worked in organization i had

639
00:22:08,880 --> 00:22:13,440
a pretty big budget

640
00:22:10,720 --> 00:22:14,799
and we knew that eventually someone was

641
00:22:13,440 --> 00:22:15,600
going to get in and the question is what

642
00:22:14,799 --> 00:22:18,639
do you do then

643
00:22:15,600 --> 00:22:19,360
how do you detect and respond to a

644
00:22:18,640 --> 00:22:23,120
breach

645
00:22:19,360 --> 00:22:26,479
instead of always trying to prevent it

646
00:22:23,120 --> 00:22:28,959
so red teamers are

647
00:22:26,480 --> 00:22:30,159
uh the people you can't automate a red

648
00:22:28,960 --> 00:22:32,720
team by the way

649
00:22:30,159 --> 00:22:33,919
see some uh some new products out there

650
00:22:32,720 --> 00:22:36,240
like red team

651
00:22:33,919 --> 00:22:38,000
automation yeah you can't really

652
00:22:36,240 --> 00:22:40,080
automate a red team because

653
00:22:38,000 --> 00:22:41,360
red team is people just like you can't

654
00:22:40,080 --> 00:22:43,918
emulate uh

655
00:22:41,360 --> 00:22:44,399
or uh automate a blue team right you

656
00:22:43,919 --> 00:22:47,840
need

657
00:22:44,400 --> 00:22:50,000
people um so why not train them up right

658
00:22:47,840 --> 00:22:51,520
um i like the red team journal shout out

659
00:22:50,000 --> 00:22:53,919
to them they're back

660
00:22:51,520 --> 00:22:54,879
um they've been posting some great stuff

661
00:22:53,919 --> 00:22:57,440
and what

662
00:22:54,880 --> 00:22:59,280
they say is that the red team red

663
00:22:57,440 --> 00:23:00,720
teaming is the practice of looking at a

664
00:22:59,280 --> 00:23:01,678
problem or situation from the

665
00:23:00,720 --> 00:23:03,840
perspective of an

666
00:23:01,679 --> 00:23:06,080
adversary and that's kind of like a

667
00:23:03,840 --> 00:23:09,760
holistic view of an organization

668
00:23:06,080 --> 00:23:11,360
testing assumptions emulating ttps

669
00:23:09,760 --> 00:23:12,799
going after people process and

670
00:23:11,360 --> 00:23:15,120
technology

671
00:23:12,799 --> 00:23:16,639
that's what the red team is and if we're

672
00:23:15,120 --> 00:23:18,719
going to talk about red teaming we have

673
00:23:16,640 --> 00:23:21,039
to talk about blue teaming

674
00:23:18,720 --> 00:23:22,159
who are the blue team the blue team are

675
00:23:21,039 --> 00:23:24,640
the defenders

676
00:23:22,159 --> 00:23:26,559
and they are tasked with identifying

677
00:23:24,640 --> 00:23:30,000
containing and eradicating

678
00:23:26,559 --> 00:23:33,678
attacks 24 hours a day

679
00:23:30,000 --> 00:23:36,720
seven days a week right i

680
00:23:33,679 --> 00:23:37,600
specifically love the blue team because

681
00:23:36,720 --> 00:23:39,840
i was a blue team

682
00:23:37,600 --> 00:23:41,678
i worked in a security operations center

683
00:23:39,840 --> 00:23:42,320
and i remember when i had to do shift

684
00:23:41,679 --> 00:23:46,159
work from

685
00:23:42,320 --> 00:23:47,279
7 00 pm to 7 00 am i remember getting

686
00:23:46,159 --> 00:23:49,760
calls about

687
00:23:47,279 --> 00:23:52,240
customers being breached and a lot of

688
00:23:49,760 --> 00:23:55,279
panic on the other side it's hard

689
00:23:52,240 --> 00:23:57,200
so shout out to all the blue teamers

690
00:23:55,279 --> 00:23:59,039
and when you look at what blue team does

691
00:23:57,200 --> 00:24:00,960
we can actually break this down in three

692
00:23:59,039 --> 00:24:02,559
things and i'm looking at the right side

693
00:24:00,960 --> 00:24:03,039
of my slide here if you're following

694
00:24:02,559 --> 00:24:04,960
along

695
00:24:03,039 --> 00:24:07,039
and that is the first thing is you got

696
00:24:04,960 --> 00:24:08,799
to log something you you have to have

697
00:24:07,039 --> 00:24:11,279
visibility

698
00:24:08,799 --> 00:24:13,360
so you want to log relevant events that

699
00:24:11,279 --> 00:24:15,919
are occurring on your systems

700
00:24:13,360 --> 00:24:17,760
locally first right that's like your

701
00:24:15,919 --> 00:24:19,840
first area where you'll see something

702
00:24:17,760 --> 00:24:20,960
and then send them to a central log

703
00:24:19,840 --> 00:24:23,840
aggregator

704
00:24:20,960 --> 00:24:25,600
then look at all those logs and do some

705
00:24:23,840 --> 00:24:28,799
sort of security logic

706
00:24:25,600 --> 00:24:29,678
and then be able to alert create some

707
00:24:28,799 --> 00:24:32,000
severity

708
00:24:29,679 --> 00:24:32,799
when i see these patterns occurring

709
00:24:32,000 --> 00:24:34,559
that's bad

710
00:24:32,799 --> 00:24:36,000
when i see these patterns that's a

711
00:24:34,559 --> 00:24:38,720
normal user right

712
00:24:36,000 --> 00:24:40,080
and then respond so you need a process

713
00:24:38,720 --> 00:24:41,919
for that you need people

714
00:24:40,080 --> 00:24:43,760
and you might want to try to automate

715
00:24:41,919 --> 00:24:46,640
some of this right

716
00:24:43,760 --> 00:24:48,400
so that is what the blue team is and

717
00:24:46,640 --> 00:24:50,960
then adversary emulation

718
00:24:48,400 --> 00:24:52,159
is a type of red team exercise where the

719
00:24:50,960 --> 00:24:54,400
red team emulates

720
00:24:52,159 --> 00:24:56,400
how an adversary operates following

721
00:24:54,400 --> 00:24:58,400
those same ttp's

722
00:24:56,400 --> 00:25:00,240
that the real adversaries have done you

723
00:24:58,400 --> 00:25:03,440
can do this in a

724
00:25:00,240 --> 00:25:06,159
blind or zero knowledge engagement

725
00:25:03,440 --> 00:25:06,960
often called red teaming or a full

726
00:25:06,159 --> 00:25:09,360
knowledge

727
00:25:06,960 --> 00:25:11,120
also known as purple teaming so that's

728
00:25:09,360 --> 00:25:14,559
what we're going to talk about here

729
00:25:11,120 --> 00:25:16,639
now i do want to comment that all

730
00:25:14,559 --> 00:25:18,639
offensive security or ethical hacking

731
00:25:16,640 --> 00:25:22,240
has been traditionally called

732
00:25:18,640 --> 00:25:23,679
is about providing value

733
00:25:22,240 --> 00:25:25,440
it's all about providing value you

734
00:25:23,679 --> 00:25:26,320
weren't hired to just break into the

735
00:25:25,440 --> 00:25:29,760
company

736
00:25:26,320 --> 00:25:32,960
you were hired to

737
00:25:29,760 --> 00:25:32,960
actually provide some value

738
00:25:33,279 --> 00:25:37,600
i pressed something and i don't know if

739
00:25:34,720 --> 00:25:40,840
i broke something um

740
00:25:37,600 --> 00:25:42,399
where's my chat y'all can still see this

741
00:25:40,840 --> 00:25:45,918
right

742
00:25:42,400 --> 00:25:48,320
all right i think so y'all there

743
00:25:45,919 --> 00:25:49,919
yes awesome thank you nicholas someone's

744
00:25:48,320 --> 00:25:51,520
quick and paying attention

745
00:25:49,919 --> 00:25:53,600
um everyone else is already on their

746
00:25:51,520 --> 00:25:57,520
lives i guess oh or not listen

747
00:25:53,600 --> 00:26:00,240
which is sad so let's move towards a

748
00:25:57,520 --> 00:26:01,200
purple team and that is those are

749
00:26:00,240 --> 00:26:03,039
unicorns

750
00:26:01,200 --> 00:26:04,400
we love them they're they're the best

751
00:26:03,039 --> 00:26:06,559
mascot ever

752
00:26:04,400 --> 00:26:08,400
so again a purple team exercise a

753
00:26:06,559 --> 00:26:10,559
virtual functional team

754
00:26:08,400 --> 00:26:11,600
where everyone's working together at the

755
00:26:10,559 --> 00:26:14,639
highest level

756
00:26:11,600 --> 00:26:16,719
imagine everyone in a room imagine

757
00:26:14,640 --> 00:26:19,840
everyone in a room i can't wait

758
00:26:16,720 --> 00:26:21,440
to see people again um so

759
00:26:19,840 --> 00:26:23,520
you have your cyber throne intelligence

760
00:26:21,440 --> 00:26:25,520
people say hey there's this threat

761
00:26:23,520 --> 00:26:27,840
out there that has the capability and an

762
00:26:25,520 --> 00:26:30,240
opportunity to attack our organization

763
00:26:27,840 --> 00:26:31,600
these are the ttps then your red team

764
00:26:30,240 --> 00:26:33,440
comes in

765
00:26:31,600 --> 00:26:34,799
with their ego checked at the door

766
00:26:33,440 --> 00:26:38,000
saying yes this

767
00:26:34,799 --> 00:26:39,679
is the adversary emulation plan this

768
00:26:38,000 --> 00:26:41,840
is what we're gonna do then you have a

769
00:26:39,679 --> 00:26:44,799
tabletop discussion oh my gosh

770
00:26:41,840 --> 00:26:46,240
you have to talk to other humans yes

771
00:26:44,799 --> 00:26:50,240
that's how we collaborate

772
00:26:46,240 --> 00:26:53,039
so you talk um you say okay well

773
00:26:50,240 --> 00:26:54,320
this ttp let's just say a spear phishing

774
00:26:53,039 --> 00:26:56,240
email with an

775
00:26:54,320 --> 00:26:58,158
excel attachment right just

776
00:26:56,240 --> 00:26:59,200
hypothetically not like it happens every

777
00:26:58,159 --> 00:27:02,640
day

778
00:26:59,200 --> 00:27:06,080
what would block that well maybe

779
00:27:02,640 --> 00:27:07,919
um our anti-spam solution right or we

780
00:27:06,080 --> 00:27:09,120
use proof poi right and shout out to

781
00:27:07,919 --> 00:27:11,600
proof point love you all

782
00:27:09,120 --> 00:27:12,479
you all are awesome um maybe they will

783
00:27:11,600 --> 00:27:14,399
block this

784
00:27:12,480 --> 00:27:15,679
and then if they don't then it's gonna

785
00:27:14,400 --> 00:27:18,480
get into

786
00:27:15,679 --> 00:27:20,480
our email server and then exchange might

787
00:27:18,480 --> 00:27:21,600
catch this but maybe it won't and then

788
00:27:20,480 --> 00:27:23,679
the end user

789
00:27:21,600 --> 00:27:25,039
would they detect this maybe they would

790
00:27:23,679 --> 00:27:26,320
maybe they'll alert us maybe they'll

791
00:27:25,039 --> 00:27:29,279
follow a process

792
00:27:26,320 --> 00:27:30,480
maybe they'll report this and then we

793
00:27:29,279 --> 00:27:32,799
would look into it

794
00:27:30,480 --> 00:27:34,399
and see that's a malicious excel file

795
00:27:32,799 --> 00:27:35,039
and work with proofpoint to catch it

796
00:27:34,399 --> 00:27:37,439
next time

797
00:27:35,039 --> 00:27:40,240
but also make sure that no one else in

798
00:27:37,440 --> 00:27:41,840
the organization received the same email

799
00:27:40,240 --> 00:27:43,919
and if they did we can remove it from

800
00:27:41,840 --> 00:27:45,678
their inboxes and then we can do

801
00:27:43,919 --> 00:27:47,600
forensics on the file

802
00:27:45,679 --> 00:27:49,360
see if it's calling home or where it's

803
00:27:47,600 --> 00:27:51,918
calling home to

804
00:27:49,360 --> 00:27:54,240
see if anyone's open there already right

805
00:27:51,919 --> 00:27:56,159
great great tabletop hypothetically all

806
00:27:54,240 --> 00:27:59,440
those things could occur

807
00:27:56,159 --> 00:28:01,039
and then you do it then you actually do

808
00:27:59,440 --> 00:28:03,360
it your red team will say all right this

809
00:28:01,039 --> 00:28:06,158
is how you create a malicious

810
00:28:03,360 --> 00:28:07,840
excel file and this is how you email it

811
00:28:06,159 --> 00:28:09,440
and everyone watches the red team do

812
00:28:07,840 --> 00:28:10,799
their thing and the red team's awesome

813
00:28:09,440 --> 00:28:11,919
and you're gonna learn and it's gonna be

814
00:28:10,799 --> 00:28:15,279
fantastic

815
00:28:11,919 --> 00:28:17,760
then when that is executed

816
00:28:15,279 --> 00:28:18,640
the blue team gets to work and they look

817
00:28:17,760 --> 00:28:20,799
for those

818
00:28:18,640 --> 00:28:22,159
indicators that something weird is going

819
00:28:20,799 --> 00:28:23,840
on on their network

820
00:28:22,159 --> 00:28:25,279
and they show it to the red team and now

821
00:28:23,840 --> 00:28:27,360
the red team is learning

822
00:28:25,279 --> 00:28:28,559
and also the cyber threat intelligence

823
00:28:27,360 --> 00:28:31,120
team is learning and

824
00:28:28,559 --> 00:28:32,480
any spectators are like well look we

825
00:28:31,120 --> 00:28:36,639
caught some stuff that's

826
00:28:32,480 --> 00:28:38,960
awesome or maybe you realize that

827
00:28:36,640 --> 00:28:40,159
you didn't catch something and then what

828
00:28:38,960 --> 00:28:42,320
do you do well

829
00:28:40,159 --> 00:28:44,080
then you figure out how to catch it

830
00:28:42,320 --> 00:28:44,799
right now you understand how that attack

831
00:28:44,080 --> 00:28:46,480
works

832
00:28:44,799 --> 00:28:48,240
you want to first log something locally

833
00:28:46,480 --> 00:28:52,080
then send it to a log aggregator

834
00:28:48,240 --> 00:28:54,000
and then over to uh

835
00:28:52,080 --> 00:28:55,360
an actual alert and then a response and

836
00:28:54,000 --> 00:28:56,799
then people know what to do and then you

837
00:28:55,360 --> 00:28:58,559
repeat this over and over

838
00:28:56,799 --> 00:29:00,559
it's fantastic it's so much fun i love

839
00:28:58,559 --> 00:29:03,039
purple singing so when do you do these

840
00:29:00,559 --> 00:29:04,960
purple team exercises

841
00:29:03,039 --> 00:29:06,320
and really exercises i was thinking

842
00:29:04,960 --> 00:29:08,960
about this the other day

843
00:29:06,320 --> 00:29:10,480
um a lot of our talking is around doing

844
00:29:08,960 --> 00:29:12,960
a purple team exercise and then

845
00:29:10,480 --> 00:29:14,240
operationalizing it so in this case it's

846
00:29:12,960 --> 00:29:16,240
a purple team exercise

847
00:29:14,240 --> 00:29:18,000
when should you do it well maybe when

848
00:29:16,240 --> 00:29:20,880
there's a new kill chain out there

849
00:29:18,000 --> 00:29:21,440
or a new attack chain maybe there is a

850
00:29:20,880 --> 00:29:24,880
um

851
00:29:21,440 --> 00:29:28,399
a recent attack that we saw in the news

852
00:29:24,880 --> 00:29:30,159
uh maybe a gregor right or maybe rick we

853
00:29:28,399 --> 00:29:30,879
heard about that hospital that guy hit

854
00:29:30,159 --> 00:29:33,039
right

855
00:29:30,880 --> 00:29:34,399
will that work in our organization cesos

856
00:29:33,039 --> 00:29:36,000
get that question all the time

857
00:29:34,399 --> 00:29:37,600
well let's test it that's a great time

858
00:29:36,000 --> 00:29:40,240
to do a purple team engagement

859
00:29:37,600 --> 00:29:41,840
or maybe there's some new ttps you

860
00:29:40,240 --> 00:29:43,120
haven't tested before you're not sure if

861
00:29:41,840 --> 00:29:44,959
you have coverage

862
00:29:43,120 --> 00:29:46,639
or maybe after a red team engagement or

863
00:29:44,960 --> 00:29:47,360
maybe before a red team engagement or

864
00:29:46,640 --> 00:29:49,360
prep

865
00:29:47,360 --> 00:29:51,199
really anytime you want to foster some

866
00:29:49,360 --> 00:29:54,080
collaboration

867
00:29:51,200 --> 00:29:55,600
so whenever you do pitch this whether

868
00:29:54,080 --> 00:29:57,439
you're a consulting company and you're

869
00:29:55,600 --> 00:30:00,158
pitching this out to a client

870
00:29:57,440 --> 00:30:01,440
or you're you work internally maybe

871
00:30:00,159 --> 00:30:03,039
you're part of the blue team you're part

872
00:30:01,440 --> 00:30:06,559
of the red team you're part of cti

873
00:30:03,039 --> 00:30:09,520
maybe you're just an engineer that does

874
00:30:06,559 --> 00:30:10,080
um windows operations right it doesn't

875
00:30:09,520 --> 00:30:14,158
matter

876
00:30:10,080 --> 00:30:17,120
all of you can be part of purple team

877
00:30:14,159 --> 00:30:18,000
and the way to pitch this is with a

878
00:30:17,120 --> 00:30:20,158
framework

879
00:30:18,000 --> 00:30:21,919
so the one we are going to go over is

880
00:30:20,159 --> 00:30:23,919
the purple team exercise framework which

881
00:30:21,919 --> 00:30:25,760
specializes in this in particular

882
00:30:23,919 --> 00:30:27,360
we also look at the testing framework

883
00:30:25,760 --> 00:30:29,279
which is minor attack

884
00:30:27,360 --> 00:30:30,879
but there's others right there's a cyber

885
00:30:29,279 --> 00:30:32,640
kill chain from lockheed martin there's

886
00:30:30,880 --> 00:30:33,279
a unified cyber kill chain from paul

887
00:30:32,640 --> 00:30:35,840
polls

888
00:30:33,279 --> 00:30:36,559
and if you worked in financials then you

889
00:30:35,840 --> 00:30:38,639
have

890
00:30:36,559 --> 00:30:41,520
a bunch of regulators right if you're

891
00:30:38,640 --> 00:30:44,960
working a large global financial

892
00:30:41,520 --> 00:30:47,279
i know who you are you have like

893
00:30:44,960 --> 00:30:48,960
35 regulators that want you to do this

894
00:30:47,279 --> 00:30:49,360
and there's a bunch of regulation around

895
00:30:48,960 --> 00:30:51,760
it

896
00:30:49,360 --> 00:30:52,479
um actually because of all that i helped

897
00:30:51,760 --> 00:30:54,399
co-author

898
00:30:52,480 --> 00:30:56,240
the framework for regulatory use of pen

899
00:30:54,399 --> 00:30:57,199
testing in the financial services

900
00:30:56,240 --> 00:30:59,200
industry which

901
00:30:57,200 --> 00:31:00,559
just resulted in another framework being

902
00:30:59,200 --> 00:31:02,559
published

903
00:31:00,559 --> 00:31:05,519
so the cyber kill chain's easy this one

904
00:31:02,559 --> 00:31:08,399
a lot of senior management knows

905
00:31:05,519 --> 00:31:11,120
you've all seen this right how attackers

906
00:31:08,399 --> 00:31:13,360
work they do reconnaissance then they

907
00:31:11,120 --> 00:31:15,120
weaponize they they create a payload

908
00:31:13,360 --> 00:31:17,519
they deliver that payload they get

909
00:31:15,120 --> 00:31:18,799
access by exploiting something then

910
00:31:17,519 --> 00:31:21,200
installs their

911
00:31:18,799 --> 00:31:22,080
stager and it sets up some command and

912
00:31:21,200 --> 00:31:23,919
control

913
00:31:22,080 --> 00:31:25,600
and then somehow they jump from command

914
00:31:23,919 --> 00:31:26,240
and control all the way to action on

915
00:31:25,600 --> 00:31:27,918
objectives

916
00:31:26,240 --> 00:31:29,279
which isn't really what happens that's

917
00:31:27,919 --> 00:31:30,399
why we don't like the cyber kill chain

918
00:31:29,279 --> 00:31:32,159
but at a high level

919
00:31:30,399 --> 00:31:33,760
it's seven steps it was kind of easy to

920
00:31:32,159 --> 00:31:37,360
explain to senior management

921
00:31:33,760 --> 00:31:39,600
this is what attackers do back in 2011.

922
00:31:37,360 --> 00:31:42,479
now what do we use minor attack and this

923
00:31:39,600 --> 00:31:45,199
is the mandatory miter attack

924
00:31:42,480 --> 00:31:46,720
slide if i don't have this slide i

925
00:31:45,200 --> 00:31:48,480
actually get fined

926
00:31:46,720 --> 00:31:50,960
do you all know that i'm just kidding

927
00:31:48,480 --> 00:31:54,000
but most everyone has miter attack

928
00:31:50,960 --> 00:31:56,559
uh or has heard of mitre attack so

929
00:31:54,000 --> 00:31:57,919
attack is adversary tactics techniques

930
00:31:56,559 --> 00:32:00,158
and common knowledge

931
00:31:57,919 --> 00:32:02,320
on the top you have your tactics these

932
00:32:00,159 --> 00:32:04,720
are high level attacker goals

933
00:32:02,320 --> 00:32:06,559
and then you have your techniques if you

934
00:32:04,720 --> 00:32:07,519
click on the techniques now you get sub

935
00:32:06,559 --> 00:32:10,000
techniques

936
00:32:07,519 --> 00:32:11,279
and if you click on those sub techniques

937
00:32:10,000 --> 00:32:13,519
then you get procedures

938
00:32:11,279 --> 00:32:17,200
which is how those are performed and

939
00:32:13,519 --> 00:32:18,159
there's 584 of these i might have

940
00:32:17,200 --> 00:32:21,200
counted

941
00:32:18,159 --> 00:32:23,600
um and yeah there's it's great

942
00:32:21,200 --> 00:32:25,519
it's it's they say it's common knowledge

943
00:32:23,600 --> 00:32:27,600
it's actually a common language

944
00:32:25,519 --> 00:32:29,679
it allows cyber threat intelligence

945
00:32:27,600 --> 00:32:32,000
teams to work with forensics teams

946
00:32:29,679 --> 00:32:33,519
to work with blue teams to work with red

947
00:32:32,000 --> 00:32:35,519
teams it's it's great

948
00:32:33,519 --> 00:32:36,640
so i did say minor attack i'm going to

949
00:32:35,519 --> 00:32:40,559
take a break

950
00:32:36,640 --> 00:32:40,559
and just have a little drink

951
00:32:41,440 --> 00:32:45,519
all right here we go so what are we

952
00:32:44,320 --> 00:32:47,360
going through we're going over

953
00:32:45,519 --> 00:32:48,960
the purple team exercise framework and

954
00:32:47,360 --> 00:32:50,080
we are going to be speeding this up so

955
00:32:48,960 --> 00:32:52,399
if you have questions

956
00:32:50,080 --> 00:32:53,519
ask them over on the chat i see the chat

957
00:32:52,399 --> 00:32:56,799
here i see

958
00:32:53,519 --> 00:32:57,919
uh robert rodriguez laughed at my uh

959
00:32:56,799 --> 00:32:59,760
minor attack joke

960
00:32:57,919 --> 00:33:01,440
that's great thank you at least i know

961
00:32:59,760 --> 00:33:03,279
there's one person out there

962
00:33:01,440 --> 00:33:04,960
that found this amusing and made it

963
00:33:03,279 --> 00:33:08,000
worth my while

964
00:33:04,960 --> 00:33:10,559
roles and responsibilities in a

965
00:33:08,000 --> 00:33:12,159
purple team the most important role is

966
00:33:10,559 --> 00:33:13,440
an exercise coordinator this is the

967
00:33:12,159 --> 00:33:16,080
person that's gonna plan

968
00:33:13,440 --> 00:33:17,519
everything out and yeah sure you might

969
00:33:16,080 --> 00:33:19,199
be the one with the idea

970
00:33:17,519 --> 00:33:20,960
guess what you're the one that's the

971
00:33:19,200 --> 00:33:22,320
exercise coordinator for the first

972
00:33:20,960 --> 00:33:24,559
purple team exercise

973
00:33:22,320 --> 00:33:25,439
that's completely fine just know it's a

974
00:33:24,559 --> 00:33:27,120
ton of work

975
00:33:25,440 --> 00:33:28,559
you're gonna have to work with other

976
00:33:27,120 --> 00:33:31,678
teams and get them

977
00:33:28,559 --> 00:33:34,080
all into your idea of doing this

978
00:33:31,679 --> 00:33:35,200
it's tough i've been there but it's okay

979
00:33:34,080 --> 00:33:38,158
it's an important role

980
00:33:35,200 --> 00:33:39,200
then you have sponsors your head of uh

981
00:33:38,159 --> 00:33:41,360
security

982
00:33:39,200 --> 00:33:42,880
your cso whatever you call in your

983
00:33:41,360 --> 00:33:43,600
company you have cyber threat

984
00:33:42,880 --> 00:33:46,000
intelligence

985
00:33:43,600 --> 00:33:47,199
you have managers you need managers see

986
00:33:46,000 --> 00:33:50,240
the managers

987
00:33:47,200 --> 00:33:52,880
do schedules and assign tasks

988
00:33:50,240 --> 00:33:53,760
to the attendees you don't want a task

989
00:33:52,880 --> 00:33:55,039
to sign

990
00:33:53,760 --> 00:33:56,879
on the day that you're doing your

991
00:33:55,039 --> 00:33:59,519
exercise right

992
00:33:56,880 --> 00:34:00,480
so sponsors are very important you need

993
00:33:59,519 --> 00:34:02,240
to convince them

994
00:34:00,480 --> 00:34:04,240
about purple teaming and telling them

995
00:34:02,240 --> 00:34:05,279
that this is very high value

996
00:34:04,240 --> 00:34:06,559
and they're going to approve the

997
00:34:05,279 --> 00:34:08,000
exercise they're going to prove the

998
00:34:06,559 --> 00:34:09,839
goals and the scope

999
00:34:08,000 --> 00:34:11,520
and a little bit of budget eventually

1000
00:34:09,839 --> 00:34:14,879
we'll be able to travel again

1001
00:34:11,520 --> 00:34:15,359
imagine meeting your uh your coworkers

1002
00:34:14,879 --> 00:34:17,440
right

1003
00:34:15,359 --> 00:34:18,480
anyone that changed jobs in the past

1004
00:34:17,440 --> 00:34:20,639
year has

1005
00:34:18,480 --> 00:34:21,679
probably not met their co-workers that's

1006
00:34:20,639 --> 00:34:24,800
very sad

1007
00:34:21,679 --> 00:34:25,440
we should fly and visit everyone and you

1008
00:34:24,800 --> 00:34:28,159
know be

1009
00:34:25,440 --> 00:34:28,960
humans again um anyone know what movie

1010
00:34:28,159 --> 00:34:32,079
that's from

1011
00:34:28,960 --> 00:34:34,320
first person to reply i'll uh i'll i'll

1012
00:34:32,079 --> 00:34:35,520
send you to the swag store

1013
00:34:34,320 --> 00:34:38,159
because i don't know if we have slag

1014
00:34:35,520 --> 00:34:41,440
anymore uh but

1015
00:34:38,159 --> 00:34:42,480
yeah yeah you need sponsors then as you

1016
00:34:41,440 --> 00:34:46,399
have sponsors you

1017
00:34:42,480 --> 00:34:48,960
also need uh time requirements

1018
00:34:46,399 --> 00:34:50,078
so prep probably takes the longest part

1019
00:34:48,960 --> 00:34:53,199
of the time

1020
00:34:50,079 --> 00:34:54,399
um and then the exercise could be a few

1021
00:34:53,199 --> 00:34:56,799
hours there we go

1022
00:34:54,399 --> 00:34:58,000
and a nose nicholas knows that was jerry

1023
00:34:56,800 --> 00:35:02,400
maguire

1024
00:34:58,000 --> 00:35:04,079
fantastic um so time requirements prep

1025
00:35:02,400 --> 00:35:06,160
generally you'll take a lot we'll talk

1026
00:35:04,079 --> 00:35:08,000
about prep in a bit but you can run a

1027
00:35:06,160 --> 00:35:09,359
purple team exercise in a couple hours

1028
00:35:08,000 --> 00:35:11,200
you can run in a day

1029
00:35:09,359 --> 00:35:12,480
or you can do a six week long one like

1030
00:35:11,200 --> 00:35:15,439
we did um

1031
00:35:12,480 --> 00:35:17,119
but you know probably start small if you

1032
00:35:15,440 --> 00:35:18,079
go and ask for an entire week of

1033
00:35:17,119 --> 00:35:20,800
everyone have their

1034
00:35:18,079 --> 00:35:22,079
normal jobs just to do um some

1035
00:35:20,800 --> 00:35:24,000
experimental thing

1036
00:35:22,079 --> 00:35:26,320
probably won't sell well maybe if you

1037
00:35:24,000 --> 00:35:28,560
say hey i just need four hours

1038
00:35:26,320 --> 00:35:30,400
or six hours of someone's day that'll

1039
00:35:28,560 --> 00:35:32,640
probably work a little better

1040
00:35:30,400 --> 00:35:34,079
then cyber threat intelligence extremely

1041
00:35:32,640 --> 00:35:36,319
important in purple teaming

1042
00:35:34,079 --> 00:35:38,320
this came from katie nichols and cody

1043
00:35:36,320 --> 00:35:42,160
thomas they used to work with

1044
00:35:38,320 --> 00:35:44,560
tim over at mitre they have since left

1045
00:35:42,160 --> 00:35:45,598
but this was an amazing presentation

1046
00:35:44,560 --> 00:35:48,078
i've actually taken it

1047
00:35:45,599 --> 00:35:49,680
and really used it in the framework from

1048
00:35:48,079 --> 00:35:50,800
the cyber throne intelligence side and

1049
00:35:49,680 --> 00:35:51,279
if you don't have someone inside for

1050
00:35:50,800 --> 00:35:53,040
thrive

1051
00:35:51,280 --> 00:35:55,119
intelligence guess what that's probably

1052
00:35:53,040 --> 00:35:56,000
you you need to understand your

1053
00:35:55,119 --> 00:35:57,359
organization

1054
00:35:56,000 --> 00:35:59,680
if you're a consultant you need to

1055
00:35:57,359 --> 00:36:01,839
understand your target organization

1056
00:35:59,680 --> 00:36:03,359
then you need to identify adversaries

1057
00:36:01,839 --> 00:36:05,839
that have the capability

1058
00:36:03,359 --> 00:36:07,279
and opportunity to attack your

1059
00:36:05,839 --> 00:36:10,078
organization

1060
00:36:07,280 --> 00:36:12,240
or your clients organization then once

1061
00:36:10,079 --> 00:36:13,119
you identify that so we're doing

1062
00:36:12,240 --> 00:36:16,479
hospitals

1063
00:36:13,119 --> 00:36:18,240
because hospitals need help

1064
00:36:16,480 --> 00:36:19,520
we're going to identify adversaries that

1065
00:36:18,240 --> 00:36:21,520
are targeting hospitals

1066
00:36:19,520 --> 00:36:22,960
orange worm and ryuk then we're going to

1067
00:36:21,520 --> 00:36:25,119
gather threat intelligence you're going

1068
00:36:22,960 --> 00:36:27,920
to do that you're going to extract ttps

1069
00:36:25,119 --> 00:36:28,480
analyze and organize those ttps also

1070
00:36:27,920 --> 00:36:31,040
known as

1071
00:36:28,480 --> 00:36:33,280
adversary behaviors create a plan and

1072
00:36:31,040 --> 00:36:34,880
then emulate the adversary

1073
00:36:33,280 --> 00:36:36,720
so when we talk about cyber threat

1074
00:36:34,880 --> 00:36:38,160
intelligence a lot of people think of

1075
00:36:36,720 --> 00:36:40,560
indicators of compromise

1076
00:36:38,160 --> 00:36:42,078
as like a hash value you know kind of

1077
00:36:40,560 --> 00:36:44,000
like antivirus you give it a

1078
00:36:42,079 --> 00:36:45,440
bad file and you'll catch it and it'll

1079
00:36:44,000 --> 00:36:48,160
it'll block it right

1080
00:36:45,440 --> 00:36:49,839
cool um no we're talking about adversary

1081
00:36:48,160 --> 00:36:52,078
behaviors here ttps

1082
00:36:49,839 --> 00:36:54,000
actual procedures we can also talk about

1083
00:36:52,079 --> 00:36:55,599
tools there's a ton of tools i'll give

1084
00:36:54,000 --> 00:36:57,359
you some resources there

1085
00:36:55,599 --> 00:36:58,800
but that's really what we want to

1086
00:36:57,359 --> 00:37:00,960
extract

1087
00:36:58,800 --> 00:37:02,800
so here's an example of a fireeye report

1088
00:37:00,960 --> 00:37:05,359
i'm sure you've all heard of fireeye

1089
00:37:02,800 --> 00:37:06,880
um if not definitely google them and see

1090
00:37:05,359 --> 00:37:09,279
what's going on over there

1091
00:37:06,880 --> 00:37:11,359
um this was a report on a particular

1092
00:37:09,280 --> 00:37:13,280
threat actor saying that they were using

1093
00:37:11,359 --> 00:37:14,078
a particular payload called auto it

1094
00:37:13,280 --> 00:37:15,920
downloader

1095
00:37:14,079 --> 00:37:17,680
it retrieved an executed additional

1096
00:37:15,920 --> 00:37:20,800
powershell from some

1097
00:37:17,680 --> 00:37:22,560
uh https site on port 8080. wow that is

1098
00:37:20,800 --> 00:37:23,520
one sentence that gives us a lot of

1099
00:37:22,560 --> 00:37:26,078
information

1100
00:37:23,520 --> 00:37:26,800
auto id that's a software powershell

1101
00:37:26,079 --> 00:37:31,440
that is

1102
00:37:26,800 --> 00:37:34,800
a technique and https

1103
00:37:31,440 --> 00:37:36,079
that's an application protocol and an ip

1104
00:37:34,800 --> 00:37:37,920
address that doesn't matter

1105
00:37:36,079 --> 00:37:39,839
we're not going to use that same ip but

1106
00:37:37,920 --> 00:37:41,520
it does tell us it's going over 8080 it

1107
00:37:39,839 --> 00:37:43,279
tells us it's going over tls

1108
00:37:41,520 --> 00:37:44,560
that's great information to have so if

1109
00:37:43,280 --> 00:37:45,119
you're going to emulate this thread

1110
00:37:44,560 --> 00:37:48,000
actor

1111
00:37:45,119 --> 00:37:49,599
you're going to set up a c2 on port 8080

1112
00:37:48,000 --> 00:37:51,680
with https

1113
00:37:49,599 --> 00:37:52,800
and it's going to serve powershell

1114
00:37:51,680 --> 00:37:56,480
payloads

1115
00:37:52,800 --> 00:37:58,000
right yeah so it's does take a little

1116
00:37:56,480 --> 00:38:00,079
learning curve to get to a point where

1117
00:37:58,000 --> 00:38:00,560
you can read a cyber threat intel report

1118
00:38:00,079 --> 00:38:03,200
like this

1119
00:38:00,560 --> 00:38:04,240
and extract it but it's okay we're gonna

1120
00:38:03,200 --> 00:38:06,160
help you out

1121
00:38:04,240 --> 00:38:08,240
the other thing is attack navigator i

1122
00:38:06,160 --> 00:38:11,440
love attack navigator

1123
00:38:08,240 --> 00:38:12,319
it is a web app that actually i'll just

1124
00:38:11,440 --> 00:38:15,440
do this live

1125
00:38:12,320 --> 00:38:17,280
because why not attack navigator

1126
00:38:15,440 --> 00:38:19,680
this attack navigator will give a second

1127
00:38:17,280 --> 00:38:21,920
to load you can create a new

1128
00:38:19,680 --> 00:38:23,359
layer here we're going to do enterprise

1129
00:38:21,920 --> 00:38:27,040
and it gives you

1130
00:38:23,359 --> 00:38:29,920
the miter attack uh

1131
00:38:27,040 --> 00:38:32,000
matrix and up here in the selection tool

1132
00:38:29,920 --> 00:38:34,079
you can actually pick different tools

1133
00:38:32,000 --> 00:38:35,680
i don't think they have orange worm on

1134
00:38:34,079 --> 00:38:38,320
here do they have orange worm they might

1135
00:38:35,680 --> 00:38:41,359
have orange worm

1136
00:38:38,320 --> 00:38:43,040
excuse me well oh there we go oh my gosh

1137
00:38:41,359 --> 00:38:44,078
this is horrible look what they have for

1138
00:38:43,040 --> 00:38:47,040
orange worm like

1139
00:38:44,079 --> 00:38:48,240
nothing yeah we're gonna that was a

1140
00:38:47,040 --> 00:38:50,960
really bad example

1141
00:38:48,240 --> 00:38:52,078
sorry let's pick uh i know apt-19 has a

1142
00:38:50,960 --> 00:38:54,560
few there we go

1143
00:38:52,079 --> 00:38:56,240
all right apt-19 there we go we have

1144
00:38:54,560 --> 00:38:59,759
some uh

1145
00:38:56,240 --> 00:39:01,359
some ttps used by apt uh 19.

1146
00:38:59,760 --> 00:39:03,119
so it's very useful it gives you a

1147
00:39:01,359 --> 00:39:05,200
little plan it kind of analyzed and

1148
00:39:03,119 --> 00:39:06,880
organized this for you

1149
00:39:05,200 --> 00:39:08,960
but you can also pull this out and put

1150
00:39:06,880 --> 00:39:10,240
it in a table format right

1151
00:39:08,960 --> 00:39:12,400
if you're going to pitch this to a

1152
00:39:10,240 --> 00:39:12,959
senior manager you say hey we're going

1153
00:39:12,400 --> 00:39:15,520
to

1154
00:39:12,960 --> 00:39:17,280
emulate orange worm this is what they do

1155
00:39:15,520 --> 00:39:19,920
these are their objectives this is

1156
00:39:17,280 --> 00:39:21,040
what they do for command and control etc

1157
00:39:19,920 --> 00:39:23,040
we actually do this

1158
00:39:21,040 --> 00:39:24,880
we do this for free it's a blog series

1159
00:39:23,040 --> 00:39:27,200
called threat thursdays

1160
00:39:24,880 --> 00:39:29,200
we introduce an adversary we then

1161
00:39:27,200 --> 00:39:30,480
consume cyber threat intelligence we map

1162
00:39:29,200 --> 00:39:32,560
it to mitre attack

1163
00:39:30,480 --> 00:39:33,599
we present and share an adversary

1164
00:39:32,560 --> 00:39:35,359
emulation plan

1165
00:39:33,599 --> 00:39:37,839
it's actually the largest public

1166
00:39:35,359 --> 00:39:39,680
repository of adversary emulation plans

1167
00:39:37,839 --> 00:39:41,279
then we emulate the adversary and we

1168
00:39:39,680 --> 00:39:44,560
cover how to defend it

1169
00:39:41,280 --> 00:39:47,839
all available for free and uh for

1170
00:39:44,560 --> 00:39:48,799
your reading purposes so check out that

1171
00:39:47,839 --> 00:39:50,720
blog post

1172
00:39:48,800 --> 00:39:52,560
i hear uh tim's working on an awesome

1173
00:39:50,720 --> 00:39:54,799
one for next week

1174
00:39:52,560 --> 00:39:56,160
this is orange worm so we did the same

1175
00:39:54,800 --> 00:39:58,079
for orange worm we were helping

1176
00:39:56,160 --> 00:40:00,078
hospitals out doing some

1177
00:39:58,079 --> 00:40:01,200
alliances with them and trying to get

1178
00:40:00,079 --> 00:40:03,040
them to

1179
00:40:01,200 --> 00:40:04,319
not fall for ransomware and for these

1180
00:40:03,040 --> 00:40:06,720
attacks

1181
00:40:04,319 --> 00:40:07,599
so this is a group uh targeting a number

1182
00:40:06,720 --> 00:40:10,240
of healthcare

1183
00:40:07,599 --> 00:40:11,920
organizations the c2 they used were

1184
00:40:10,240 --> 00:40:14,879
application layer protocols

1185
00:40:11,920 --> 00:40:18,079
fallback channels they used sign binary

1186
00:40:14,880 --> 00:40:21,119
proxy execution through run dll32

1187
00:40:18,079 --> 00:40:21,680
they did uh simple command line and

1188
00:40:21,119 --> 00:40:24,800
command

1189
00:40:21,680 --> 00:40:26,480
on windows command shell etc it's a nice

1190
00:40:24,800 --> 00:40:29,119
little plan

1191
00:40:26,480 --> 00:40:31,040
then you need to figure out logistics

1192
00:40:29,119 --> 00:40:32,240
nowadays you're doing everything virtual

1193
00:40:31,040 --> 00:40:35,040
so whenever you do go

1194
00:40:32,240 --> 00:40:36,319
to physical come back to this slide um

1195
00:40:35,040 --> 00:40:38,640
target systems we

1196
00:40:36,319 --> 00:40:40,400
do recommend you do all of this in

1197
00:40:38,640 --> 00:40:43,118
production

1198
00:40:40,400 --> 00:40:44,000
yes in production i'm not gonna ask what

1199
00:40:43,119 --> 00:40:46,480
movie this is

1200
00:40:44,000 --> 00:40:47,280
because everyone's seen this movie right

1201
00:40:46,480 --> 00:40:49,119
um

1202
00:40:47,280 --> 00:40:50,720
and the reason we say in production is

1203
00:40:49,119 --> 00:40:52,640
because in production is where your

1204
00:40:50,720 --> 00:40:54,799
security tools are

1205
00:40:52,640 --> 00:40:56,400
right no stock analyst is looking at

1206
00:40:54,800 --> 00:40:57,760
that non-prod environment

1207
00:40:56,400 --> 00:41:00,079
probably doesn't even have security

1208
00:40:57,760 --> 00:41:01,280
tools so either create some product new

1209
00:41:00,079 --> 00:41:02,720
production systems

1210
00:41:01,280 --> 00:41:04,960
and then ensure you have all the

1211
00:41:02,720 --> 00:41:06,720
security tools on there

1212
00:41:04,960 --> 00:41:09,359
these are your antivirus tools your

1213
00:41:06,720 --> 00:41:10,480
edr's your forensics tools your image

1214
00:41:09,359 --> 00:41:12,078
acquisition

1215
00:41:10,480 --> 00:41:14,079
figure out how to do live forensics

1216
00:41:12,079 --> 00:41:16,560
right and then

1217
00:41:14,079 --> 00:41:18,880
the flow of traffic make sure that these

1218
00:41:16,560 --> 00:41:21,759
systems and these accounts have

1219
00:41:18,880 --> 00:41:24,000
uh email that they have access to the

1220
00:41:21,760 --> 00:41:25,760
internet etc

1221
00:41:24,000 --> 00:41:27,280
you might want to create new accounts

1222
00:41:25,760 --> 00:41:28,000
say if you're doing things like lateral

1223
00:41:27,280 --> 00:41:31,119
movement

1224
00:41:28,000 --> 00:41:32,800
or uh dumping credentials you might not

1225
00:41:31,119 --> 00:41:34,640
want to share someone's real credentials

1226
00:41:32,800 --> 00:41:36,319
in front of everyone so you might have

1227
00:41:34,640 --> 00:41:37,520
to request new accounts make sure those

1228
00:41:36,319 --> 00:41:39,759
new accounts have emails and

1229
00:41:37,520 --> 00:41:41,759
internet access then attack

1230
00:41:39,760 --> 00:41:43,839
infrastructure it's a lot of fun this is

1231
00:41:41,760 --> 00:41:46,000
generally done by the red team

1232
00:41:43,839 --> 00:41:47,359
here you choose your external hosting

1233
00:41:46,000 --> 00:41:51,079
provider you know

1234
00:41:47,359 --> 00:41:54,078
aws azure lenode

1235
00:41:51,079 --> 00:41:56,160
digitalocean whatever you prefer create

1236
00:41:54,079 --> 00:41:59,359
your virtual machines there

1237
00:41:56,160 --> 00:42:01,440
create some outbound ip addresses allow

1238
00:41:59,359 --> 00:42:02,400
your red team resources to connect to

1239
00:42:01,440 --> 00:42:04,640
them

1240
00:42:02,400 --> 00:42:06,240
and then you build out your command and

1241
00:42:04,640 --> 00:42:07,920
control infrastructure

1242
00:42:06,240 --> 00:42:09,118
your phishing sites whatever it is

1243
00:42:07,920 --> 00:42:10,800
you're doing if you're going to be

1244
00:42:09,119 --> 00:42:12,400
sending emails you might have to create

1245
00:42:10,800 --> 00:42:14,880
an email service

1246
00:42:12,400 --> 00:42:17,280
or an s70p server i recommend you just

1247
00:42:14,880 --> 00:42:18,079
use like office 365 or something like

1248
00:42:17,280 --> 00:42:19,920
that

1249
00:42:18,079 --> 00:42:22,480
then you need to purchase domains

1250
00:42:19,920 --> 00:42:25,200
generate tls certificates

1251
00:42:22,480 --> 00:42:26,800
set up domain fronting and relays and

1252
00:42:25,200 --> 00:42:28,879
redirects etc

1253
00:42:26,800 --> 00:42:30,720
but then what you actually need to do is

1254
00:42:28,880 --> 00:42:32,400
test those payloads

1255
00:42:30,720 --> 00:42:34,078
as a red teamer you want to make sure

1256
00:42:32,400 --> 00:42:36,319
that all those payloads

1257
00:42:34,079 --> 00:42:38,720
when executed communicate back to your

1258
00:42:36,319 --> 00:42:40,800
command and control

1259
00:42:38,720 --> 00:42:43,279
so if you don't know what tool to use

1260
00:42:40,800 --> 00:42:46,240
check out the cd2 matrix the c2 matrix

1261
00:42:43,280 --> 00:42:48,640
has 65 command and control

1262
00:42:46,240 --> 00:42:49,680
frameworks in there it's a free resource

1263
00:42:48,640 --> 00:42:52,879
that we created

1264
00:42:49,680 --> 00:42:54,399
about a year and a half ago with bryson

1265
00:42:52,880 --> 00:42:57,440
and adam machinshe

1266
00:42:54,400 --> 00:42:59,200
um so you could check that out we also

1267
00:42:57,440 --> 00:43:00,640
have a virtual machine

1268
00:42:59,200 --> 00:43:02,640
that's one of the ones that you're going

1269
00:43:00,640 --> 00:43:04,640
to be using here of course

1270
00:43:02,640 --> 00:43:06,799
follow us on twitter so that you get

1271
00:43:04,640 --> 00:43:08,319
updates when new c2s are out

1272
00:43:06,800 --> 00:43:10,960
let me go show you that real quick

1273
00:43:08,319 --> 00:43:14,160
because i like that live demos

1274
00:43:10,960 --> 00:43:16,720
so c2matrix.com you click on this big

1275
00:43:14,160 --> 00:43:19,200
red matrix thing

1276
00:43:16,720 --> 00:43:21,279
and it takes you to a google sheet yes

1277
00:43:19,200 --> 00:43:22,640
this is a google sheet

1278
00:43:21,280 --> 00:43:25,200
over here you have the name of the

1279
00:43:22,640 --> 00:43:28,078
various different c2s there's a ton of

1280
00:43:25,200 --> 00:43:31,200
them then their license their price

1281
00:43:28,079 --> 00:43:34,160
their githubs their twitter accounts

1282
00:43:31,200 --> 00:43:34,960
then who evaluated it and as you go over

1283
00:43:34,160 --> 00:43:36,960
on the right

1284
00:43:34,960 --> 00:43:38,880
you learn a lot more about these c2s

1285
00:43:36,960 --> 00:43:39,760
like what server language they are what

1286
00:43:38,880 --> 00:43:41,520
implants

1287
00:43:39,760 --> 00:43:43,359
or how do they create their implants are

1288
00:43:41,520 --> 00:43:46,640
they multi-user you know

1289
00:43:43,359 --> 00:43:49,279
putting the team and red team um

1290
00:43:46,640 --> 00:43:50,640
implants for windows linux or mac then

1291
00:43:49,280 --> 00:43:51,680
you head over here and you see the

1292
00:43:50,640 --> 00:43:53,520
channels

1293
00:43:51,680 --> 00:43:55,440
channels are communication channels it's

1294
00:43:53,520 --> 00:43:58,160
for your c2

1295
00:43:55,440 --> 00:43:59,119
most use http but you'll see some pretty

1296
00:43:58,160 --> 00:44:02,879
cool stuff like

1297
00:43:59,119 --> 00:44:07,119
dns over http anyone monitoring that

1298
00:44:02,880 --> 00:44:10,319
um icmp ftp right there's a whole bunch

1299
00:44:07,119 --> 00:44:13,280
of different channels there like smb

1300
00:44:10,319 --> 00:44:15,920
etc then you go through and there's a

1301
00:44:13,280 --> 00:44:19,119
bunch of other capabilities for these

1302
00:44:15,920 --> 00:44:20,880
so a lot lots of uh tools available

1303
00:44:19,119 --> 00:44:22,480
a lot of these are free there's also

1304
00:44:20,880 --> 00:44:25,520
some detection tools

1305
00:44:22,480 --> 00:44:26,319
like their charm fingerprint um net

1306
00:44:25,520 --> 00:44:28,960
witness

1307
00:44:26,319 --> 00:44:28,960
etc

1308
00:44:30,079 --> 00:44:33,119
what we're going to use in this lab is

1309
00:44:31,760 --> 00:44:35,119
scythe scythe is

1310
00:44:33,119 --> 00:44:36,400
the one sponsoring this so as you can

1311
00:44:35,119 --> 00:44:38,079
imagine

1312
00:44:36,400 --> 00:44:39,520
all of these virtual machines you have

1313
00:44:38,079 --> 00:44:41,280
access to um

1314
00:44:39,520 --> 00:44:42,880
might cost a little bit of money so

1315
00:44:41,280 --> 00:44:45,040
thank you scythe for it

1316
00:44:42,880 --> 00:44:46,000
full disclosure i'm the chief technology

1317
00:44:45,040 --> 00:44:47,680
officer there

1318
00:44:46,000 --> 00:44:49,760
the reason we're using site is because

1319
00:44:47,680 --> 00:44:51,440
it's an enterprise-grade platform and we

1320
00:44:49,760 --> 00:44:52,319
believe that mostly enterprises are

1321
00:44:51,440 --> 00:44:55,119
going into

1322
00:44:52,319 --> 00:44:57,119
purple teaming so when you want to

1323
00:44:55,119 --> 00:44:57,839
emulate a particular threat you want to

1324
00:44:57,119 --> 00:45:00,400
do so

1325
00:44:57,839 --> 00:45:02,160
consistently and reliably this is a

1326
00:45:00,400 --> 00:45:03,680
platform that allows you to do that

1327
00:45:02,160 --> 00:45:06,319
you're going to be able to use that

1328
00:45:03,680 --> 00:45:08,560
shortly has some features

1329
00:45:06,319 --> 00:45:09,680
lots of features lots of integrations

1330
00:45:08,560 --> 00:45:12,000
lots of reports

1331
00:45:09,680 --> 00:45:13,279
lots of automation like i said not going

1332
00:45:12,000 --> 00:45:14,319
to make this a sales pitch

1333
00:45:13,280 --> 00:45:16,640
you're going to play with this in a

1334
00:45:14,319 --> 00:45:17,359
minute then you want to create some

1335
00:45:16,640 --> 00:45:19,200
playbooks

1336
00:45:17,359 --> 00:45:20,720
you create some of these campaigns ahead

1337
00:45:19,200 --> 00:45:22,399
of time and then

1338
00:45:20,720 --> 00:45:23,680
figure out how to execute them well

1339
00:45:22,400 --> 00:45:25,599
we're going to create something that

1340
00:45:23,680 --> 00:45:27,440
uses https

1341
00:45:25,599 --> 00:45:29,119
and then where it has a 10 second

1342
00:45:27,440 --> 00:45:30,319
heartbeat then we're going to create

1343
00:45:29,119 --> 00:45:34,240
orangeworm remember

1344
00:45:30,319 --> 00:45:36,960
orangeworm uses run dll32 for execution

1345
00:45:34,240 --> 00:45:37,680
well how do we do that we can also use

1346
00:45:36,960 --> 00:45:40,960
powershell

1347
00:45:37,680 --> 00:45:42,560
to download rhea the sock team also

1348
00:45:40,960 --> 00:45:46,800
needs some prep

1349
00:45:42,560 --> 00:45:49,359
shout out to um threat hunter playbook

1350
00:45:46,800 --> 00:45:50,560
excellent playbook of things that blue

1351
00:45:49,359 --> 00:45:53,598
teams do

1352
00:45:50,560 --> 00:45:55,440
um but the blue team also should verify

1353
00:45:53,599 --> 00:45:57,920
that the attack infrastructure is

1354
00:45:55,440 --> 00:46:01,040
accessible and things like that

1355
00:45:57,920 --> 00:46:04,240
the deferred team anyone in defer so

1356
00:46:01,040 --> 00:46:07,279
you should probably open up a case um

1357
00:46:04,240 --> 00:46:09,200
and list it as an exercise because are

1358
00:46:07,280 --> 00:46:11,839
you allowed to pull memory from any

1359
00:46:09,200 --> 00:46:14,078
machine at any given time i hope not

1360
00:46:11,839 --> 00:46:15,520
um there should be some controls around

1361
00:46:14,079 --> 00:46:18,160
that right um so

1362
00:46:15,520 --> 00:46:19,839
open up a case say that's an exercise

1363
00:46:18,160 --> 00:46:21,920
and make sure that your forensics tools

1364
00:46:19,839 --> 00:46:25,200
are deployed on those systems

1365
00:46:21,920 --> 00:46:27,920
why we've done many exercises where

1366
00:46:25,200 --> 00:46:29,919
because of licensing you don't have your

1367
00:46:27,920 --> 00:46:31,359
image acquisition tools on the target

1368
00:46:29,920 --> 00:46:35,839
systems

1369
00:46:31,359 --> 00:46:38,640
then finally it's time for the exercise

1370
00:46:35,839 --> 00:46:40,160
kick it off have a sponsor go there and

1371
00:46:38,640 --> 00:46:43,359
motivate the attendees

1372
00:46:40,160 --> 00:46:46,799
you have all come here today

1373
00:46:43,359 --> 00:46:49,279
because you are the best at what you do

1374
00:46:46,800 --> 00:46:50,400
however as an information security

1375
00:46:49,280 --> 00:46:52,800
organization

1376
00:46:50,400 --> 00:46:54,079
we operate under assumed breach we know

1377
00:46:52,800 --> 00:46:56,560
no matter what we do

1378
00:46:54,079 --> 00:46:57,200
we're gonna get breach so we want you to

1379
00:46:56,560 --> 00:46:59,359
train

1380
00:46:57,200 --> 00:47:01,520
and train against real adversary

1381
00:46:59,359 --> 00:47:02,960
behavior we want you all to collaborate

1382
00:47:01,520 --> 00:47:06,400
and learn from each other

1383
00:47:02,960 --> 00:47:09,280
because you are our best line of defense

1384
00:47:06,400 --> 00:47:10,720
please use this time wisely and then you

1385
00:47:09,280 --> 00:47:13,119
begin your exercise

1386
00:47:10,720 --> 00:47:14,160
your cyber threat intel person presents

1387
00:47:13,119 --> 00:47:16,560
an adversary

1388
00:47:14,160 --> 00:47:18,799
this adversary is likely to attack us

1389
00:47:16,560 --> 00:47:20,160
they have the opportunity the intent and

1390
00:47:18,800 --> 00:47:22,160
the capability

1391
00:47:20,160 --> 00:47:24,480
these are their ttps these are their

1392
00:47:22,160 --> 00:47:26,319
behaviors and then you can dive into

1393
00:47:24,480 --> 00:47:28,000
each ttp a little more

1394
00:47:26,319 --> 00:47:30,160
what is the behavior what is the

1395
00:47:28,000 --> 00:47:31,839
procedure what tool did they use

1396
00:47:30,160 --> 00:47:33,598
what's the attack vector how do they

1397
00:47:31,839 --> 00:47:36,799
deliver it what privilege do they

1398
00:47:33,599 --> 00:47:38,640
gain then you have a tabletop discussion

1399
00:47:36,800 --> 00:47:40,559
the sock is going to say well we think

1400
00:47:38,640 --> 00:47:41,759
that this can be caught like this this

1401
00:47:40,559 --> 00:47:45,280
and that

1402
00:47:41,760 --> 00:47:47,760
the hunt team will say well if we know

1403
00:47:45,280 --> 00:47:49,599
um if they execute that power shell with

1404
00:47:47,760 --> 00:47:51,680
that base64 encoding

1405
00:47:49,599 --> 00:47:53,359
we'll catch that that's in our run bug

1406
00:47:51,680 --> 00:47:55,040
and then the deferred team will say well

1407
00:47:53,359 --> 00:47:57,759
as long as the sock tells

1408
00:47:55,040 --> 00:47:59,680
us that their that system needs to be

1409
00:47:57,760 --> 00:48:00,480
investigated we'll go investigate them

1410
00:47:59,680 --> 00:48:03,359
for sure

1411
00:48:00,480 --> 00:48:04,559
we will find that they use run dll32 to

1412
00:48:03,359 --> 00:48:07,200
execute this

1413
00:48:04,559 --> 00:48:08,400
great fantastic you're all already

1414
00:48:07,200 --> 00:48:11,598
working together

1415
00:48:08,400 --> 00:48:12,720
red team do your thing they go they show

1416
00:48:11,599 --> 00:48:16,079
their screen

1417
00:48:12,720 --> 00:48:17,040
this is how this ttp works and provide

1418
00:48:16,079 --> 00:48:18,720
all that information

1419
00:48:17,040 --> 00:48:21,279
yeah i know red team's not used to doing

1420
00:48:18,720 --> 00:48:23,680
that huh give them your attacker ip

1421
00:48:21,280 --> 00:48:24,960
give them the machine you compromised

1422
00:48:23,680 --> 00:48:28,160
provide the exact time

1423
00:48:24,960 --> 00:48:30,559
show what you did right come on red team

1424
00:48:28,160 --> 00:48:31,200
share your information then the sock

1425
00:48:30,559 --> 00:48:33,119
hunt team

1426
00:48:31,200 --> 00:48:36,240
defer the blue team goes and they do

1427
00:48:33,119 --> 00:48:38,000
their thing they also share their screen

1428
00:48:36,240 --> 00:48:39,279
and of course monitor the time during

1429
00:48:38,000 --> 00:48:42,240
this because you need

1430
00:48:39,280 --> 00:48:44,960
you need to flow this right once they do

1431
00:48:42,240 --> 00:48:46,399
find it hopefully they found something

1432
00:48:44,960 --> 00:48:48,800
they share their screen now it's the

1433
00:48:46,400 --> 00:48:49,920
time for cti and red team to learn from

1434
00:48:48,800 --> 00:48:51,760
the blue team

1435
00:48:49,920 --> 00:48:53,520
what just happened how long did it take

1436
00:48:51,760 --> 00:48:54,160
you to detect that when did the alert

1437
00:48:53,520 --> 00:48:56,720
come in

1438
00:48:54,160 --> 00:48:57,279
one time we were doing one of these we

1439
00:48:56,720 --> 00:49:00,480
actually

1440
00:48:57,280 --> 00:49:01,680
started on purpose with atp we knew

1441
00:49:00,480 --> 00:49:06,119
would alert

1442
00:49:01,680 --> 00:49:08,480
but not be prevented and within about

1443
00:49:06,119 --> 00:49:11,920
35 seconds from

1444
00:49:08,480 --> 00:49:16,079
us getting the shell it popped up

1445
00:49:11,920 --> 00:49:18,720
in the sock's main dashboard it was like

1446
00:49:16,079 --> 00:49:19,200
what look how fast and of course if you

1447
00:49:18,720 --> 00:49:21,359
work in

1448
00:49:19,200 --> 00:49:22,558
sock you know how long that takes right

1449
00:49:21,359 --> 00:49:26,240
for like a

1450
00:49:22,559 --> 00:49:27,359
outbound proxy log to go into a log

1451
00:49:26,240 --> 00:49:30,319
aggregator

1452
00:49:27,359 --> 00:49:31,759
do all the uh analytics and then pop up

1453
00:49:30,319 --> 00:49:33,920
it was a great win

1454
00:49:31,760 --> 00:49:35,040
so document those document the results

1455
00:49:33,920 --> 00:49:37,280
document the good

1456
00:49:35,040 --> 00:49:39,200
document the bad don't skip either of

1457
00:49:37,280 --> 00:49:41,920
those both are important

1458
00:49:39,200 --> 00:49:43,520
and then see if you can do any

1459
00:49:41,920 --> 00:49:46,000
short-term adjustments

1460
00:49:43,520 --> 00:49:47,359
see if you can engineer any sort of

1461
00:49:46,000 --> 00:49:49,440
detection

1462
00:49:47,359 --> 00:49:51,440
document anything that you couldn't fix

1463
00:49:49,440 --> 00:49:53,200
and then either repeat that ttp or move

1464
00:49:51,440 --> 00:49:55,760
on to the next one

1465
00:49:53,200 --> 00:49:56,720
then one of the tools we love using for

1466
00:49:55,760 --> 00:49:59,839
love using for

1467
00:49:56,720 --> 00:50:00,879
tracking this is called vector vector is

1468
00:49:59,839 --> 00:50:04,160
a free tool

1469
00:50:00,880 --> 00:50:05,839
you can download at vector.io i use in

1470
00:50:04,160 --> 00:50:07,680
my red team class it's awesome on the

1471
00:50:05,839 --> 00:50:09,200
left you have the red team details

1472
00:50:07,680 --> 00:50:11,359
on the right you have the blue team

1473
00:50:09,200 --> 00:50:14,399
details so in this case

1474
00:50:11,359 --> 00:50:17,040
um this is what anti-malware service

1475
00:50:14,400 --> 00:50:18,480
i guess they're shut down the service

1476
00:50:17,040 --> 00:50:20,480
was there any detection when your

1477
00:50:18,480 --> 00:50:22,480
windows defender went down

1478
00:50:20,480 --> 00:50:24,839
and then you can fill that out that yeah

1479
00:50:22,480 --> 00:50:26,000
it was detected or no it was not

1480
00:50:24,839 --> 00:50:27,759
detected

1481
00:50:26,000 --> 00:50:29,040
and then once you're done with all of

1482
00:50:27,760 --> 00:50:31,760
this you're going to have

1483
00:50:29,040 --> 00:50:33,279
pretty reports if you use vector but

1484
00:50:31,760 --> 00:50:34,640
you're going to have lessons learned

1485
00:50:33,280 --> 00:50:36,319
every exercise you're going to learn

1486
00:50:34,640 --> 00:50:39,359
something so

1487
00:50:36,319 --> 00:50:40,000
document all that stuff and this is

1488
00:50:39,359 --> 00:50:41,598
really the job

1489
00:50:40,000 --> 00:50:43,280
of the exercise coordinator that's why i

1490
00:50:41,599 --> 00:50:44,160
said try not to be the exercise

1491
00:50:43,280 --> 00:50:46,960
coordinator if you're

1492
00:50:44,160 --> 00:50:48,078
also another role it's a lot of work

1493
00:50:46,960 --> 00:50:51,599
trust me

1494
00:50:48,079 --> 00:50:52,960
um so yeah that's it enough of me

1495
00:50:51,599 --> 00:50:54,640
talking i told you it was only going to

1496
00:50:52,960 --> 00:50:55,359
be like 40 minutes i went a little bit

1497
00:50:54,640 --> 00:51:00,400
over

1498
00:50:55,359 --> 00:51:04,160
um so now it's time to start your lab

1499
00:51:00,400 --> 00:51:07,520
any questions let me pull up uh

1500
00:51:04,160 --> 00:51:11,040
our chat let me pull up our

1501
00:51:07,520 --> 00:51:14,319
q a i'm starting my lab because i

1502
00:51:11,040 --> 00:51:15,520
left it you should have got an email

1503
00:51:14,319 --> 00:51:16,800
seems straightforward it is

1504
00:51:15,520 --> 00:51:17,839
straightforward we made this

1505
00:51:16,800 --> 00:51:19,760
straightforward

1506
00:51:17,839 --> 00:51:21,759
will the slides be made available yep

1507
00:51:19,760 --> 00:51:25,760
the slides and recording of this are

1508
00:51:21,760 --> 00:51:28,319
all available all right so

1509
00:51:25,760 --> 00:51:29,599
just to kick this off control delete

1510
00:51:28,319 --> 00:51:31,200
right up here

1511
00:51:29,599 --> 00:51:34,079
what is the power squared how do you

1512
00:51:31,200 --> 00:51:37,118
find the password in the notes

1513
00:51:34,079 --> 00:51:40,960
student student then

1514
00:51:37,119 --> 00:51:43,280
you read read page one read page two

1515
00:51:40,960 --> 00:51:45,440
read page three when you get to page

1516
00:51:43,280 --> 00:51:51,839
four oh my gosh i did not type the word

1517
00:51:45,440 --> 00:51:51,839
student correctly there we go

1518
00:51:52,080 --> 00:51:55,880
[Music]

1519
00:51:53,520 --> 00:51:57,440
the website for tracking is called

1520
00:51:55,880 --> 00:52:01,599
vector.io

1521
00:51:57,440 --> 00:52:05,040
almost you had a extra o there

1522
00:52:01,599 --> 00:52:08,720
um you open up uh

1523
00:52:05,040 --> 00:52:09,839
chrome here are the two links where you

1524
00:52:08,720 --> 00:52:13,680
need to go to

1525
00:52:09,839 --> 00:52:19,839
scythe and yes i did not

1526
00:52:13,680 --> 00:52:19,839
buy a certificate for this

1527
00:52:21,040 --> 00:52:24,640
and then what's the username and the

1528
00:52:22,640 --> 00:52:26,000
password you click on notes i'm

1529
00:52:24,640 --> 00:52:27,520
literally not going to tell you the

1530
00:52:26,000 --> 00:52:29,440
username and password

1531
00:52:27,520 --> 00:52:30,960
so you don't ask later you click on

1532
00:52:29,440 --> 00:52:34,319
notes right up here

1533
00:52:30,960 --> 00:52:36,480
notes notes notes notes

1534
00:52:34,319 --> 00:52:38,000
notes what's the username and password

1535
00:52:36,480 --> 00:52:40,800
notes

1536
00:52:38,000 --> 00:52:41,680
all right cool um one more time no

1537
00:52:40,800 --> 00:52:43,680
you're good

1538
00:52:41,680 --> 00:52:45,440
sorry i told you i'm exciting it's

1539
00:52:43,680 --> 00:52:45,919
actually in the instructions oh my gosh

1540
00:52:45,440 --> 00:52:49,520
yes it

1541
00:52:45,920 --> 00:52:50,240
is right like no one should ask me the

1542
00:52:49,520 --> 00:52:52,880
question

1543
00:52:50,240 --> 00:52:56,799
but everyone asks a question thank you

1544
00:52:52,880 --> 00:52:56,800
see oh no i typed it wrong

1545
00:52:57,040 --> 00:53:05,520
oh no what's going on

1546
00:53:00,960 --> 00:53:08,960
oh i'm spelling it wrong unicorn

1547
00:53:05,520 --> 00:53:11,119
oh my gosh that scared me all right

1548
00:53:08,960 --> 00:53:14,559
there we go

1549
00:53:11,119 --> 00:53:16,319
um there is no more lab time i'm sorry

1550
00:53:14,559 --> 00:53:18,079
i actually already messed up i'm gonna

1551
00:53:16,319 --> 00:53:22,000
haven't even told my boss

1552
00:53:18,079 --> 00:53:23,920
um we actually only had two hours

1553
00:53:22,000 --> 00:53:24,960
because it's all computing in some cloud

1554
00:53:23,920 --> 00:53:28,000
environment somewhere

1555
00:53:24,960 --> 00:53:29,680
out in the cloud right um so

1556
00:53:28,000 --> 00:53:31,839
we were supposed to do two hours i

1557
00:53:29,680 --> 00:53:35,040
messed up time zones so you actually got

1558
00:53:31,839 --> 00:53:36,400
four hours of this um i extended it so

1559
00:53:35,040 --> 00:53:39,040
you're good like

1560
00:53:36,400 --> 00:53:40,720
your time you everyone should have at

1561
00:53:39,040 --> 00:53:43,440
least an hour and five minutes

1562
00:53:40,720 --> 00:53:43,439
five nimitz

1563
00:53:45,920 --> 00:53:49,359
so what happens when i get super excited

1564
00:53:48,000 --> 00:53:53,280
you should all have

1565
00:53:49,359 --> 00:53:55,440
at least an hour and five minutes less

1566
00:53:53,280 --> 00:53:57,599
all right and of course we're gonna have

1567
00:53:55,440 --> 00:53:58,960
a whole bunch more of workshops

1568
00:53:57,599 --> 00:54:01,599
we actually have an intermediate

1569
00:53:58,960 --> 00:54:04,720
workshop but anyway

1570
00:54:01,599 --> 00:54:07,920
we're over here on the site dashboard

1571
00:54:04,720 --> 00:54:11,279
and literally follow along the

1572
00:54:07,920 --> 00:54:12,480
instructions um you're gonna create a

1573
00:54:11,280 --> 00:54:15,440
new campaign

1574
00:54:12,480 --> 00:54:17,119
yes we made this very easy you can be a

1575
00:54:15,440 --> 00:54:19,200
red teamer in no time

1576
00:54:17,119 --> 00:54:20,720
just by following these instructions

1577
00:54:19,200 --> 00:54:21,759
right and you're gonna go through it i'm

1578
00:54:20,720 --> 00:54:24,399
not gonna do it for you

1579
00:54:21,760 --> 00:54:25,520
you're gonna do it but if you have

1580
00:54:24,400 --> 00:54:29,680
questions

1581
00:54:25,520 --> 00:54:33,200
you can send me a direct message

1582
00:54:29,680 --> 00:54:37,200
on chat or on

1583
00:54:33,200 --> 00:54:40,240
yeah just you soon um

1584
00:54:37,200 --> 00:54:43,279
now if you are stuck if anything breaks

1585
00:54:40,240 --> 00:54:45,040
let me know if you used your real name

1586
00:54:43,280 --> 00:54:48,559
which i think everyone did

1587
00:54:45,040 --> 00:54:52,480
i can find your console and i can go

1588
00:54:48,559 --> 00:54:55,280
into your console and help you out

1589
00:54:52,480 --> 00:54:55,920
what is the password for the vm are you

1590
00:54:55,280 --> 00:54:59,200
serious

1591
00:54:55,920 --> 00:55:01,680
okay you are kidding thank god all right

1592
00:54:59,200 --> 00:55:02,319
thank you you're funny you're funny all

1593
00:55:01,680 --> 00:55:04,799
right

1594
00:55:02,319 --> 00:55:05,359
anyway i'm going to shut up now and take

1595
00:55:04,799 --> 00:55:08,079
a breath

1596
00:55:05,359 --> 00:55:09,839
as you've seen i have not break in like

1597
00:55:08,079 --> 00:55:13,359
55 minutes

1598
00:55:09,839 --> 00:55:16,400
so enjoy enjoy the workshop

1599
00:55:13,359 --> 00:55:17,200
break stuff be a red team or be a blue

1600
00:55:16,400 --> 00:55:20,880
teamer

1601
00:55:17,200 --> 00:55:22,078
uh emulate orange worm and react

1602
00:55:20,880 --> 00:55:24,240
and let us know if you have any

1603
00:55:22,079 --> 00:55:27,440
questions it's meant to be

1604
00:55:24,240 --> 00:55:28,479
fun and yes you can go on and do

1605
00:55:27,440 --> 00:55:32,240
whatever you want

1606
00:55:28,480 --> 00:55:36,960
you can create any campaign you want

1607
00:55:32,240 --> 00:55:40,879
you can be be the bad guys

1608
00:55:36,960 --> 00:55:43,920
and go through and make some cool stuff

1609
00:55:40,880 --> 00:55:45,119
um get public for the manual i'm gonna

1610
00:55:43,920 --> 00:55:48,319
post that right now

1611
00:55:45,119 --> 00:55:49,359
let me stop my share so i can use my

1612
00:55:48,319 --> 00:55:52,400
google

1613
00:55:49,359 --> 00:55:56,240
um uh

1614
00:55:52,400 --> 00:56:02,000
who posted that this was andy

1615
00:55:56,240 --> 00:56:06,799
andy what's his name cipher suffer

1616
00:56:02,000 --> 00:56:06,799
except for fish found it here you go

1617
00:56:06,960 --> 00:56:13,359
boom um and this is an official this

1618
00:56:11,280 --> 00:56:14,960
like someone took this workshop

1619
00:56:13,359 --> 00:56:17,119
they wanted the manual i told them i

1620
00:56:14,960 --> 00:56:17,920
couldn't extract it or i can but it's an

1621
00:56:17,119 --> 00:56:20,079
xml

1622
00:56:17,920 --> 00:56:21,280
they didn't want xml so they literally

1623
00:56:20,079 --> 00:56:24,160
just copy and pasted it

1624
00:56:21,280 --> 00:56:24,160
and there you have it

1625
00:56:28,079 --> 00:56:31,280
all right i'm gonna turn off my camera

1626
00:56:30,160 --> 00:56:41,680
and shut up and

1627
00:56:31,280 --> 00:56:41,680
let you all have some fun enjoy

