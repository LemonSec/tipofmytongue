1
00:00:03,760 --> 00:00:07,720
hello cactus con alex here again to

2
00:00:05,839 --> 00:00:10,320
introduce our final talk

3
00:00:07,720 --> 00:00:11,200
mqtt or message queuing telemetry

4
00:00:10,320 --> 00:00:13,519
transport

5
00:00:11,200 --> 00:00:15,360
tiny protocol big vulnerabilities

6
00:00:13,519 --> 00:00:17,039
presented to us by tracy martin who's a

7
00:00:15,360 --> 00:00:18,240
principal security engineer at a really

8
00:00:17,039 --> 00:00:19,439
big bookstore

9
00:00:18,240 --> 00:00:21,759
don't forget to stick around after the

10
00:00:19,439 --> 00:00:23,600
talk for a live q a and after that

11
00:00:21,760 --> 00:00:25,199
please hang out and stay for a while and

12
00:00:23,600 --> 00:00:26,480
enjoy our closing ceremonies

13
00:00:25,199 --> 00:00:27,680
i appreciate you sticking with us and

14
00:00:26,480 --> 00:00:28,720
hope everyone had a really wonderful

15
00:00:27,680 --> 00:00:31,840
cactus con

16
00:00:28,720 --> 00:00:31,840
take it away tracy

17
00:00:37,360 --> 00:00:40,640
hello cactuscon thank you so much for

18
00:00:39,840 --> 00:00:43,360
taking time

19
00:00:40,640 --> 00:00:44,399
out of your saturday to join me in this

20
00:00:43,360 --> 00:00:47,039
presentation

21
00:00:44,399 --> 00:00:47,440
on the internet of things a protocol

22
00:00:47,039 --> 00:00:50,800
called

23
00:00:47,440 --> 00:00:53,680
mqtt this tiny protocol with big

24
00:00:50,800 --> 00:00:53,680
vulnerabilities

25
00:00:55,280 --> 00:00:58,399
a little bit about me for those of you

26
00:00:57,920 --> 00:01:01,280
who

27
00:00:58,399 --> 00:01:03,440
are repeat cactus con attendees you may

28
00:01:01,280 --> 00:01:06,159
recognize me from last year

29
00:01:03,440 --> 00:01:08,560
where i did an ocean talk on nation

30
00:01:06,159 --> 00:01:12,640
state grooming in social media

31
00:01:08,560 --> 00:01:15,759
that is one of my many facets i suppose

32
00:01:12,640 --> 00:01:17,600
my newest skill set is in the internet

33
00:01:15,759 --> 00:01:18,640
of things i'm a principal security

34
00:01:17,600 --> 00:01:20,240
engineer

35
00:01:18,640 --> 00:01:22,479
for a really big bookstore that you

36
00:01:20,240 --> 00:01:26,880
might have heard of i've worked

37
00:01:22,479 --> 00:01:29,520
in security for about 20 years now

38
00:01:26,880 --> 00:01:31,759
doing a bunch of different things i was

39
00:01:29,520 --> 00:01:33,280
in the military for a while

40
00:01:31,759 --> 00:01:35,360
i've worked at a couple different

41
00:01:33,280 --> 00:01:37,920
companies like microsoft and google

42
00:01:35,360 --> 00:01:40,000
doing everything from incident response

43
00:01:37,920 --> 00:01:43,600
to product security

44
00:01:40,000 --> 00:01:46,399
i have also started a conference

45
00:01:43,600 --> 00:01:47,280
up in seattle that some of you may have

46
00:01:46,399 --> 00:01:48,960
been to

47
00:01:47,280 --> 00:01:51,439
it's called defence you should check us

48
00:01:48,960 --> 00:01:53,679
out on twitter and hopefully once this

49
00:01:51,439 --> 00:01:54,079
pandemic is under control we'll all be

50
00:01:53,680 --> 00:01:57,680
back

51
00:01:54,079 --> 00:02:01,119
to doing in-person conferences again

52
00:01:57,680 --> 00:02:04,960
i'm also a us air force veteran i spent

53
00:02:01,119 --> 00:02:08,000
a lot of time not just active duty but

54
00:02:04,960 --> 00:02:10,560
doing work for the us army doing work

55
00:02:08,000 --> 00:02:11,440
for nato i spent about a third of my

56
00:02:10,560 --> 00:02:14,959
adult life

57
00:02:11,440 --> 00:02:15,359
overseas uh doing counterintelligence

58
00:02:14,959 --> 00:02:18,640
work

59
00:02:15,360 --> 00:02:21,760
in belgium so i've done a lot of really

60
00:02:18,640 --> 00:02:23,519
random stuff so you'll notice that my

61
00:02:21,760 --> 00:02:26,879
hobbies include ocean

62
00:02:23,520 --> 00:02:28,160
someday i uh i hope to get a full-time

63
00:02:26,879 --> 00:02:30,720
job doing just

64
00:02:28,160 --> 00:02:32,319
research in osan but hasn't been in the

65
00:02:30,720 --> 00:02:34,800
cards for a while now

66
00:02:32,319 --> 00:02:35,518
uh i also dabble in photography that's

67
00:02:34,800 --> 00:02:38,560
my

68
00:02:35,519 --> 00:02:39,920
back up retirement job for when i burn

69
00:02:38,560 --> 00:02:42,319
out of it

70
00:02:39,920 --> 00:02:43,040
and then i spend a lot of time raising

71
00:02:42,319 --> 00:02:46,079
my small

72
00:02:43,040 --> 00:02:47,679
toddler who has decided to give up sleep

73
00:02:46,080 --> 00:02:49,440
for new year so

74
00:02:47,680 --> 00:02:51,280
we haven't slept in a really long time

75
00:02:49,440 --> 00:02:52,239
in my household i'm told that gets

76
00:02:51,280 --> 00:02:55,920
better but

77
00:02:52,239 --> 00:02:58,159
so far i'm not seeing it finally

78
00:02:55,920 --> 00:02:59,280
really important disclaimer down at the

79
00:02:58,159 --> 00:03:00,799
bottom

80
00:02:59,280 --> 00:03:02,879
you'll notice that i don't include my

81
00:03:00,800 --> 00:03:04,480
employer's name in here

82
00:03:02,879 --> 00:03:06,159
not that it's terribly difficult to find

83
00:03:04,480 --> 00:03:08,079
out but it's very important that you

84
00:03:06,159 --> 00:03:10,159
know that the views expressed in this

85
00:03:08,080 --> 00:03:11,440
presentation are mine they're not my

86
00:03:10,159 --> 00:03:12,959
employers

87
00:03:11,440 --> 00:03:15,359
if you find something that you disagree

88
00:03:12,959 --> 00:03:18,000
with or that you think is stupid

89
00:03:15,360 --> 00:03:20,239
feel confident that you are disagreeing

90
00:03:18,000 --> 00:03:22,080
with me or you think i am stupid and not

91
00:03:20,239 --> 00:03:25,519
my employer

92
00:03:22,080 --> 00:03:25,519
all right let's get started

93
00:03:26,239 --> 00:03:29,840
so first of all what is the internet of

94
00:03:29,280 --> 00:03:32,879
things

95
00:03:29,840 --> 00:03:34,959
i know we hear a lot about this concept

96
00:03:32,879 --> 00:03:37,280
it's all over the news

97
00:03:34,959 --> 00:03:39,599
if you're following any type of security

98
00:03:37,280 --> 00:03:42,239
talk this will probably come up

99
00:03:39,599 --> 00:03:44,079
maybe you yourself are struggling with

100
00:03:42,239 --> 00:03:45,120
what types of devices you want in your

101
00:03:44,080 --> 00:03:47,680
home

102
00:03:45,120 --> 00:03:49,680
what types of internet of things

103
00:03:47,680 --> 00:03:53,120
applications you have that make your

104
00:03:49,680 --> 00:03:55,840
jobs and days easier

105
00:03:53,120 --> 00:03:56,720
the internet of things is a really broad

106
00:03:55,840 --> 00:03:58,840
category

107
00:03:56,720 --> 00:04:00,080
you can find everything from

108
00:03:58,840 --> 00:04:02,000
microcontrollers

109
00:04:00,080 --> 00:04:03,760
all the way up to what we would have

110
00:04:02,000 --> 00:04:06,080
considered fully fledged computers

111
00:04:03,760 --> 00:04:09,200
probably even 10 years ago

112
00:04:06,080 --> 00:04:12,640
working in hospital situations like mris

113
00:04:09,200 --> 00:04:15,280
pacemakers even light bulbs in your home

114
00:04:12,640 --> 00:04:15,920
baby monitors the internet of things is

115
00:04:15,280 --> 00:04:19,040
really a

116
00:04:15,920 --> 00:04:20,159
huge variety of different types of

117
00:04:19,040 --> 00:04:21,840
devices

118
00:04:20,160 --> 00:04:24,160
the idea though is that there are

119
00:04:21,839 --> 00:04:26,000
physical things that interact with the

120
00:04:24,160 --> 00:04:27,600
internet so physical things meaning

121
00:04:26,000 --> 00:04:29,360
their sensors their cameras

122
00:04:27,600 --> 00:04:31,440
there's something you can put your hands

123
00:04:29,360 --> 00:04:33,600
on that do a function in the physical

124
00:04:31,440 --> 00:04:35,680
world

125
00:04:33,600 --> 00:04:39,759
so the technology around this has been

126
00:04:35,680 --> 00:04:42,800
about a hundred billion dollars for 2017

127
00:04:39,759 --> 00:04:43,680
that's a lot if you have been around it

128
00:04:42,800 --> 00:04:46,479
and computing

129
00:04:43,680 --> 00:04:48,960
you'll see that this is very similar to

130
00:04:46,479 --> 00:04:50,800
the 90s.com era

131
00:04:48,960 --> 00:04:53,280
where there's this technology seems to

132
00:04:50,800 --> 00:04:56,240
be proliferating like crazy

133
00:04:53,280 --> 00:04:59,280
in fact in 2025 they're estimating that

134
00:04:56,240 --> 00:05:01,919
it'll be around 1.6 trillion dollars

135
00:04:59,280 --> 00:05:03,758
so that's that's a lot of money a lot of

136
00:05:01,919 --> 00:05:06,320
technology and of course

137
00:05:03,759 --> 00:05:07,120
if you are in security you'll realize

138
00:05:06,320 --> 00:05:09,280
that anytime

139
00:05:07,120 --> 00:05:10,720
technology bounds ahead this quickly

140
00:05:09,280 --> 00:05:14,320
there are bound to be

141
00:05:10,720 --> 00:05:17,360
security issues all right

142
00:05:14,320 --> 00:05:20,080
so what is mqtt

143
00:05:17,360 --> 00:05:20,880
message queuing telemetry transport it's

144
00:05:20,080 --> 00:05:22,880
basically

145
00:05:20,880 --> 00:05:24,199
a standard that they developed in order

146
00:05:22,880 --> 00:05:27,199
to facilitate

147
00:05:24,199 --> 00:05:29,919
communications with

148
00:05:27,199 --> 00:05:31,440
networks that don't always have

149
00:05:29,919 --> 00:05:33,919
guaranteed connectivity

150
00:05:31,440 --> 00:05:35,840
guaranteed reliability maybe they have

151
00:05:33,919 --> 00:05:38,799
wonky bandwidth

152
00:05:35,840 --> 00:05:41,599
low power low energy devices that may

153
00:05:38,800 --> 00:05:43,360
come on and offline sporadically

154
00:05:41,600 --> 00:05:44,639
it's designed for devices that have a

155
00:05:43,360 --> 00:05:47,680
small footprint

156
00:05:44,639 --> 00:05:49,360
it's designed for applications where

157
00:05:47,680 --> 00:05:51,199
you're not always going to be able to

158
00:05:49,360 --> 00:05:52,080
connect to a server or connect to

159
00:05:51,199 --> 00:05:56,400
another machine

160
00:05:52,080 --> 00:05:59,520
even on the network so its history is

161
00:05:56,400 --> 00:06:02,400
that it was designed to support

162
00:05:59,520 --> 00:06:04,560
oil rigs that were out at sea and had a

163
00:06:02,400 --> 00:06:05,039
requirement to communicate back to home

164
00:06:04,560 --> 00:06:07,440
base

165
00:06:05,039 --> 00:06:08,318
with things like the amount of oil they

166
00:06:07,440 --> 00:06:10,319
had

167
00:06:08,319 --> 00:06:13,520
been able to get the manufacturing

168
00:06:10,319 --> 00:06:16,080
status of the devices on the rig

169
00:06:13,520 --> 00:06:16,799
humidity motion sensing a bunch of

170
00:06:16,080 --> 00:06:19,120
different

171
00:06:16,800 --> 00:06:20,720
metrics that they needed to be pushed

172
00:06:19,120 --> 00:06:23,120
back to home base

173
00:06:20,720 --> 00:06:24,400
from these oil rigs that sat out in the

174
00:06:23,120 --> 00:06:26,720
middle of nowhere

175
00:06:24,400 --> 00:06:28,799
with very limited connectivity there's

176
00:06:26,720 --> 00:06:30,479
there's not a lot of wi-fi hot spots out

177
00:06:28,800 --> 00:06:33,600
in the middle of the ocean

178
00:06:30,479 --> 00:06:35,840
so they created mqtt so that

179
00:06:33,600 --> 00:06:37,280
if you were on a satellite link like

180
00:06:35,840 --> 00:06:39,679
many of these were

181
00:06:37,280 --> 00:06:41,198
and your connection was very lossy and

182
00:06:39,680 --> 00:06:43,680
you didn't have a lot of

183
00:06:41,199 --> 00:06:46,319
bandwidth and there's a potential that

184
00:06:43,680 --> 00:06:48,560
you could be on and offline sporadically

185
00:06:46,319 --> 00:06:51,039
all of these things were built into the

186
00:06:48,560 --> 00:06:52,720
way mqtt functioned

187
00:06:51,039 --> 00:06:55,280
but what they didn't think about was

188
00:06:52,720 --> 00:06:57,280
security and the reason is you can

189
00:06:55,280 --> 00:06:58,719
pretty much guarantee that if you're out

190
00:06:57,280 --> 00:07:00,638
in the middle of the ocean

191
00:06:58,720 --> 00:07:02,639
and you've managed to climb all the way

192
00:07:00,639 --> 00:07:05,440
up there on that oil rig

193
00:07:02,639 --> 00:07:07,599
odds are pretty good you are authorized

194
00:07:05,440 --> 00:07:08,000
to be there and any device that you put

195
00:07:07,599 --> 00:07:10,400
on

196
00:07:08,000 --> 00:07:12,560
the oil rig was at least put there by an

197
00:07:10,400 --> 00:07:13,440
authorized person even if the device

198
00:07:12,560 --> 00:07:16,560
itself

199
00:07:13,440 --> 00:07:17,919
was not authorized so mqtt was never

200
00:07:16,560 --> 00:07:20,960
really designed

201
00:07:17,919 --> 00:07:21,599
to have security much like http before

202
00:07:20,960 --> 00:07:24,080
it

203
00:07:21,599 --> 00:07:25,440
it was designed to allow trusted parties

204
00:07:24,080 --> 00:07:27,520
to communicate

205
00:07:25,440 --> 00:07:28,639
well now obviously the landscape has

206
00:07:27,520 --> 00:07:32,479
changed so

207
00:07:28,639 --> 00:07:34,400
this presents a couple of challenges

208
00:07:32,479 --> 00:07:36,800
so beyond the challenges though why

209
00:07:34,400 --> 00:07:38,719
would we use mqtt if it wasn't

210
00:07:36,800 --> 00:07:41,520
built to have security what makes it

211
00:07:38,720 --> 00:07:43,680
still a valuable protocol today

212
00:07:41,520 --> 00:07:45,520
the cool thing about mqtt is it's an

213
00:07:43,680 --> 00:07:49,360
it's very scalable

214
00:07:45,520 --> 00:07:51,359
so it has a bunch of brokers that

215
00:07:49,360 --> 00:07:53,280
can fail over seamlessly you don't have

216
00:07:51,360 --> 00:07:55,360
to designate one is primary and one is

217
00:07:53,280 --> 00:07:56,159
secondary you don't have to mess with a

218
00:07:55,360 --> 00:07:59,120
lot of

219
00:07:56,160 --> 00:07:59,759
load balancers or traffic shapers it

220
00:07:59,120 --> 00:08:02,960
just

221
00:07:59,759 --> 00:08:05,440
works it's also packet agnostic meaning

222
00:08:02,960 --> 00:08:06,638
whatever technology you have on the

223
00:08:05,440 --> 00:08:08,960
other end

224
00:08:06,639 --> 00:08:11,120
as long as it will fit in the mqtt

225
00:08:08,960 --> 00:08:12,960
packet you can shove that data in there

226
00:08:11,120 --> 00:08:14,960
and it'll be carried along

227
00:08:12,960 --> 00:08:16,080
just like a mail person is delivering

228
00:08:14,960 --> 00:08:19,280
packages

229
00:08:16,080 --> 00:08:20,719
it's also really reliable unlike http or

230
00:08:19,280 --> 00:08:22,799
even sms

231
00:08:20,720 --> 00:08:25,120
that require both the server and the

232
00:08:22,800 --> 00:08:29,039
client to be online at the same time

233
00:08:25,120 --> 00:08:30,639
mqtt allows the client to send a message

234
00:08:29,039 --> 00:08:32,479
and wait for the server to come back

235
00:08:30,639 --> 00:08:33,039
online and then validate that that

236
00:08:32,479 --> 00:08:36,240
message

237
00:08:33,039 --> 00:08:37,838
actually got received by the broker

238
00:08:36,240 --> 00:08:40,000
it doesn't which means it doesn't depend

239
00:08:37,839 --> 00:08:42,640
on both of them being online at the same

240
00:08:40,000 --> 00:08:43,760
time and you can imagine in these very

241
00:08:42,640 --> 00:08:46,880
far-flung

242
00:08:43,760 --> 00:08:48,399
industrial areas the odds are you're

243
00:08:46,880 --> 00:08:50,720
going to have a situation

244
00:08:48,399 --> 00:08:51,600
where your broker or your client may be

245
00:08:50,720 --> 00:08:53,519
disconnected

246
00:08:51,600 --> 00:08:54,959
at the same time so it's really

247
00:08:53,519 --> 00:08:57,600
important to have a communication

248
00:08:54,959 --> 00:08:59,359
protocol that isn't bound to that

249
00:08:57,600 --> 00:09:01,200
it's also really efficient it was

250
00:08:59,360 --> 00:09:03,200
designed to operate on micro

251
00:09:01,200 --> 00:09:04,560
microcontrollers and things that don't

252
00:09:03,200 --> 00:09:06,320
have a big code

253
00:09:04,560 --> 00:09:08,399
footprint that don't have a lot of

254
00:09:06,320 --> 00:09:08,800
processing power maybe don't even have a

255
00:09:08,399 --> 00:09:11,920
big

256
00:09:08,800 --> 00:09:13,120
battery these devices are intended to

257
00:09:11,920 --> 00:09:15,920
stay out in the field

258
00:09:13,120 --> 00:09:18,160
sometimes for 10 years without being

259
00:09:15,920 --> 00:09:19,279
updated to run on a single battery for

260
00:09:18,160 --> 00:09:22,079
10 years

261
00:09:19,279 --> 00:09:24,640
so this protocol had to have a very low

262
00:09:22,080 --> 00:09:24,640
overhead

263
00:09:24,880 --> 00:09:29,600
so we've kind of touched on this a

264
00:09:27,040 --> 00:09:31,680
little bit but just some key concepts to

265
00:09:29,600 --> 00:09:33,600
kind of put in the back of your brain

266
00:09:31,680 --> 00:09:35,199
and don't worry i have a bunch of

267
00:09:33,600 --> 00:09:36,959
scenarios and a bunch of

268
00:09:35,200 --> 00:09:39,120
graphics that i think will make this a

269
00:09:36,959 --> 00:09:41,599
little clearer but just for now let's

270
00:09:39,120 --> 00:09:44,320
get some vocabulary out of the way

271
00:09:41,600 --> 00:09:45,519
so a publisher a publisher just like in

272
00:09:44,320 --> 00:09:48,560
other contexts

273
00:09:45,519 --> 00:09:50,640
is somebody who sends a message

274
00:09:48,560 --> 00:09:52,000
so if you think about this as the

275
00:09:50,640 --> 00:09:54,240
physical devices

276
00:09:52,000 --> 00:09:56,640
on your network your light bulbs your

277
00:09:54,240 --> 00:09:58,720
cameras uh the welding equipment in

278
00:09:56,640 --> 00:10:01,519
industrial applications

279
00:09:58,720 --> 00:10:03,360
cars all of these things that want to

280
00:10:01,519 --> 00:10:06,160
say something to another thing

281
00:10:03,360 --> 00:10:07,440
are publishers a broker sits in the

282
00:10:06,160 --> 00:10:09,439
middle of that and you can have

283
00:10:07,440 --> 00:10:11,920
one to n brokers so you can have

284
00:10:09,440 --> 00:10:14,560
multiple brokers that sit in the middle

285
00:10:11,920 --> 00:10:15,279
and they take these messages and they

286
00:10:14,560 --> 00:10:17,760
sort of do

287
00:10:15,279 --> 00:10:19,040
like the old telephone switchboard

288
00:10:17,760 --> 00:10:22,800
operation where they go

289
00:10:19,040 --> 00:10:25,839
okay this is a message on the

290
00:10:22,800 --> 00:10:27,760
home light bulbs topic who subscribed to

291
00:10:25,839 --> 00:10:29,519
that topic and they forwarded on to all

292
00:10:27,760 --> 00:10:31,360
the interested parties

293
00:10:29,519 --> 00:10:33,680
and the subscriber is the person on the

294
00:10:31,360 --> 00:10:36,240
other end of that

295
00:10:33,680 --> 00:10:36,719
protocol that is interested in that

296
00:10:36,240 --> 00:10:39,279
topic

297
00:10:36,720 --> 00:10:41,519
so that would be your smart home app or

298
00:10:39,279 --> 00:10:45,040
maybe a manufacturing app for a car

299
00:10:41,519 --> 00:10:47,200
or a factory and then topics are just

300
00:10:45,040 --> 00:10:50,000
categories of information so if you can

301
00:10:47,200 --> 00:10:52,079
think of it almost like a file system

302
00:10:50,000 --> 00:10:53,200
a better file system than mine because

303
00:10:52,079 --> 00:10:56,239
my file system

304
00:10:53,200 --> 00:10:57,760
is always always in disorganization but

305
00:10:56,240 --> 00:10:58,480
for people who are really good at file

306
00:10:57,760 --> 00:11:00,160
systems

307
00:10:58,480 --> 00:11:02,399
you have your route and then under there

308
00:11:00,160 --> 00:11:03,760
maybe you have your movies and then

309
00:11:02,399 --> 00:11:06,560
under that you have

310
00:11:03,760 --> 00:11:07,200
tv and under that you have documents and

311
00:11:06,560 --> 00:11:09,359
it's this

312
00:11:07,200 --> 00:11:11,519
bucket of things that people are

313
00:11:09,360 --> 00:11:14,399
interested in learning about so

314
00:11:11,519 --> 00:11:16,640
let's do a really basic example this is

315
00:11:14,399 --> 00:11:19,920
based on something that i did as one of

316
00:11:16,640 --> 00:11:23,040
my first iot projects

317
00:11:19,920 --> 00:11:24,240
my cat if any of you have had the

318
00:11:23,040 --> 00:11:26,719
misfortune

319
00:11:24,240 --> 00:11:28,640
of being on a web call with me you have

320
00:11:26,720 --> 00:11:32,079
definitely seen her butt

321
00:11:28,640 --> 00:11:35,120
because she is super obnoxious

322
00:11:32,079 --> 00:11:37,599
about being right up in my face

323
00:11:35,120 --> 00:11:38,240
all the time and she cries about

324
00:11:37,600 --> 00:11:40,320
everything

325
00:11:38,240 --> 00:11:41,839
all the time she's fine we've taken her

326
00:11:40,320 --> 00:11:43,519
to the vet she's just really noisy

327
00:11:41,839 --> 00:11:46,240
that's kind of her thing

328
00:11:43,519 --> 00:11:47,279
but the problem is i often don't realize

329
00:11:46,240 --> 00:11:49,680
her water dish

330
00:11:47,279 --> 00:11:51,200
is out of water because she cries over

331
00:11:49,680 --> 00:11:53,439
everything so it's really hard to figure

332
00:11:51,200 --> 00:11:55,440
out what she's specifically crying over

333
00:11:53,440 --> 00:11:56,959
and her water dish sits in a back part

334
00:11:55,440 --> 00:11:58,000
of our home that i don't really go to a

335
00:11:56,959 --> 00:11:59,760
lot

336
00:11:58,000 --> 00:12:01,360
mainly to keep it away from the toddler

337
00:11:59,760 --> 00:12:04,480
that i mentioned before

338
00:12:01,360 --> 00:12:07,839
so i got an ir sensor that i

339
00:12:04,480 --> 00:12:09,440
put on an arduino and it basically just

340
00:12:07,839 --> 00:12:11,839
measures the distance from the top of

341
00:12:09,440 --> 00:12:14,000
her water bowl to the bottom

342
00:12:11,839 --> 00:12:15,200
and if it hits water great if it goes

343
00:12:14,000 --> 00:12:18,880
below a certain distance

344
00:12:15,200 --> 00:12:20,800
then it sends me an alert so that's the

345
00:12:18,880 --> 00:12:22,320
publisher right the distance publisher

346
00:12:20,800 --> 00:12:24,880
so you have sensors

347
00:12:22,320 --> 00:12:26,079
and you can have let's say ir sensors

348
00:12:24,880 --> 00:12:27,760
motion sensors

349
00:12:26,079 --> 00:12:29,920
all of my sensors of all my different

350
00:12:27,760 --> 00:12:31,680
things would be in my sensors topic

351
00:12:29,920 --> 00:12:33,120
and then the ones that measure distance

352
00:12:31,680 --> 00:12:35,680
would publish to sensors

353
00:12:33,120 --> 00:12:37,600
slash distance that message would go to

354
00:12:35,680 --> 00:12:39,599
the broker the broker would look up well

355
00:12:37,600 --> 00:12:41,440
there's an app on tracy's iphone that's

356
00:12:39,600 --> 00:12:43,040
interested in knowing the distance

357
00:12:41,440 --> 00:12:45,200
between the top of the water dish

358
00:12:43,040 --> 00:12:46,880
and the bottom of the water dish and it

359
00:12:45,200 --> 00:12:47,920
would send that message to the

360
00:12:46,880 --> 00:12:49,680
subscriber

361
00:12:47,920 --> 00:12:51,760
and you'll notice there's a database at

362
00:12:49,680 --> 00:12:54,719
the bottom part of this this is not

363
00:12:51,760 --> 00:12:58,240
technically part of the official mqtt

364
00:12:54,720 --> 00:13:01,040
spec but it's almost always used in

365
00:12:58,240 --> 00:13:02,399
modern implementations of mqtt just as a

366
00:13:01,040 --> 00:13:07,439
way of storing and

367
00:13:02,399 --> 00:13:09,200
processing large volumes of message data

368
00:13:07,440 --> 00:13:11,680
all right so that was a really really

369
00:13:09,200 --> 00:13:14,560
simple version of

370
00:13:11,680 --> 00:13:15,519
a home automation service with mqtt

371
00:13:14,560 --> 00:13:18,719
enabled

372
00:13:15,519 --> 00:13:20,079
but what are some of the other use cases

373
00:13:18,720 --> 00:13:23,040
that mqtt

374
00:13:20,079 --> 00:13:24,239
exists in we mentioned oil rigs not a

375
00:13:23,040 --> 00:13:27,360
lot of us will probably

376
00:13:24,240 --> 00:13:28,880
have a huge opportunity to interact with

377
00:13:27,360 --> 00:13:31,279
oil rigs

378
00:13:28,880 --> 00:13:33,200
but i bet if you start to look you'll

379
00:13:31,279 --> 00:13:35,760
start to notice that mqtt

380
00:13:33,200 --> 00:13:36,880
is kind of everywhere it's weirdly

381
00:13:35,760 --> 00:13:39,120
ubiquitous

382
00:13:36,880 --> 00:13:40,399
for a protocol that not many people know

383
00:13:39,120 --> 00:13:43,680
about

384
00:13:40,399 --> 00:13:46,959
so here are some use cases that are

385
00:13:43,680 --> 00:13:48,000
i think interesting many of you will

386
00:13:46,959 --> 00:13:51,199
have heard of connected

387
00:13:48,000 --> 00:13:53,519
cars um if you can imagine that you have

388
00:13:51,199 --> 00:13:55,839
a car that's driving around maybe it's

389
00:13:53,519 --> 00:13:58,959
not in cellular service it doesn't

390
00:13:55,839 --> 00:14:02,560
have wi-fi it can't connect to a server

391
00:13:58,959 --> 00:14:04,719
it goes into a parking garage so mqtt

392
00:14:02,560 --> 00:14:06,800
is great because it doesn't require that

393
00:14:04,720 --> 00:14:07,680
car to be within a communications

394
00:14:06,800 --> 00:14:10,000
distance

395
00:14:07,680 --> 00:14:12,160
of any kind of service so you can

396
00:14:10,000 --> 00:14:14,320
imagine that the car

397
00:14:12,160 --> 00:14:15,199
would be able to publish to topics like

398
00:14:14,320 --> 00:14:17,920
speed or

399
00:14:15,199 --> 00:14:20,240
fuel level or oil life and there can be

400
00:14:17,920 --> 00:14:22,319
a subscriber like the app on my phone

401
00:14:20,240 --> 00:14:23,600
that predicts when my car will need

402
00:14:22,320 --> 00:14:25,279
maintenance or

403
00:14:23,600 --> 00:14:26,880
sends these messages to my insurance

404
00:14:25,279 --> 00:14:28,800
broker to let them know that i drive

405
00:14:26,880 --> 00:14:31,040
like a mad person

406
00:14:28,800 --> 00:14:32,479
and the reason mqtt is great is because

407
00:14:31,040 --> 00:14:34,399
traditional

408
00:14:32,480 --> 00:14:36,639
technology communication protocols like

409
00:14:34,399 --> 00:14:39,199
http or sms

410
00:14:36,639 --> 00:14:39,680
really fall apart if both client and

411
00:14:39,199 --> 00:14:42,240
server

412
00:14:39,680 --> 00:14:45,839
aren't online at the same time mqtt

413
00:14:42,240 --> 00:14:45,839
doesn't have that problem

414
00:14:46,240 --> 00:14:50,320
all right home automation this is

415
00:14:47,920 --> 00:14:52,479
probably the quintessential use case for

416
00:14:50,320 --> 00:14:54,880
all iot right your smart lights

417
00:14:52,480 --> 00:14:56,160
your smart lights maybe they publish to

418
00:14:54,880 --> 00:14:57,680
a topic like home

419
00:14:56,160 --> 00:14:59,680
lights you want to know whether the

420
00:14:57,680 --> 00:15:01,519
light bulb is on or off

421
00:14:59,680 --> 00:15:03,760
if you're really fancy you want to know

422
00:15:01,519 --> 00:15:06,880
if your light bulb is red or blue

423
00:15:03,760 --> 00:15:08,560
or green and your phone is the

424
00:15:06,880 --> 00:15:10,160
subscriber to that topic because it

425
00:15:08,560 --> 00:15:10,959
needs to know whether the light bulb is

426
00:15:10,160 --> 00:15:13,519
on or off

427
00:15:10,959 --> 00:15:16,160
so that it can also act as a publisher

428
00:15:13,519 --> 00:15:18,560
and send a message to your phone to your

429
00:15:16,160 --> 00:15:21,519
light bulb that says hey you're off i

430
00:15:18,560 --> 00:15:21,518
need you to turn on

431
00:15:21,600 --> 00:15:26,440
all right industrial iot applications

432
00:15:24,320 --> 00:15:29,680
such as smart grid

433
00:15:26,440 --> 00:15:32,800
manufacturing car manufacturing

434
00:15:29,680 --> 00:15:35,439
any kind of wind turbine factory

435
00:15:32,800 --> 00:15:38,479
these are really common use cases for

436
00:15:35,440 --> 00:15:40,880
mqtt for a lot of the same reasons

437
00:15:38,480 --> 00:15:42,480
many of these devices are legacy devices

438
00:15:40,880 --> 00:15:44,240
they operate on a small

439
00:15:42,480 --> 00:15:46,320
footprint you're dealing with a heat

440
00:15:44,240 --> 00:15:49,839
sensor or a motion sensor

441
00:15:46,320 --> 00:15:52,880
or a wind turbine sensor that may have

442
00:15:49,839 --> 00:15:53,680
fractional computing power so mqtt is a

443
00:15:52,880 --> 00:15:57,120
really

444
00:15:53,680 --> 00:15:58,319
good way to get these messages across

445
00:15:57,120 --> 00:15:59,920
the cool thing is that it allows

446
00:15:58,320 --> 00:16:01,199
interconnected factories to predict

447
00:15:59,920 --> 00:16:04,000
maintenance issues

448
00:16:01,199 --> 00:16:05,199
so if i am let's say measuring the

449
00:16:04,000 --> 00:16:07,360
vibration

450
00:16:05,199 --> 00:16:09,359
on a wind turbine and suddenly the

451
00:16:07,360 --> 00:16:11,040
vibration goes up by 30 percent

452
00:16:09,360 --> 00:16:12,480
i know that i should take that turbine

453
00:16:11,040 --> 00:16:14,079
offline for maintenance

454
00:16:12,480 --> 00:16:15,600
sooner rather than later before

455
00:16:14,079 --> 00:16:17,599
something goes terribly wrong and it

456
00:16:15,600 --> 00:16:19,600
breaks the turbine

457
00:16:17,600 --> 00:16:21,600
um it can also help when you're doing

458
00:16:19,600 --> 00:16:23,680
connected factories because if you've

459
00:16:21,600 --> 00:16:25,600
ever seen i love lucy where the factory

460
00:16:23,680 --> 00:16:27,839
backs up and everything is terrible

461
00:16:25,600 --> 00:16:29,759
you can predict that in you know the

462
00:16:27,839 --> 00:16:30,959
fourth process of manufacturing

463
00:16:29,759 --> 00:16:32,480
something is broken

464
00:16:30,959 --> 00:16:36,479
i want to go ahead and stop the entire

465
00:16:32,480 --> 00:16:38,320
factory line until i can fix that

466
00:16:36,480 --> 00:16:41,120
all right so we've learned about what

467
00:16:38,320 --> 00:16:43,759
mqtt is and what mqtt

468
00:16:41,120 --> 00:16:45,839
does now let's put on our security hat

469
00:16:43,759 --> 00:16:47,360
and talk about the types of attacks we

470
00:16:45,839 --> 00:16:50,240
worry about

471
00:16:47,360 --> 00:16:51,600
so if any of you are old like me and

472
00:16:50,240 --> 00:16:54,160
you've been around

473
00:16:51,600 --> 00:16:54,959
i.t for a while a lot of these will

474
00:16:54,160 --> 00:16:57,600
probably

475
00:16:54,959 --> 00:16:59,599
seem really familiar to you because

476
00:16:57,600 --> 00:17:03,040
they're very reminiscent of

477
00:16:59,600 --> 00:17:05,919
sort of the early internet

478
00:17:03,040 --> 00:17:07,678
much like http mqtt was just not

479
00:17:05,919 --> 00:17:09,520
designed with security in mind so we

480
00:17:07,679 --> 00:17:12,240
have a lot of the same problems

481
00:17:09,520 --> 00:17:13,679
with a few unique twists so there's

482
00:17:12,240 --> 00:17:17,120
denial of service

483
00:17:13,679 --> 00:17:19,600
there's poor off n there's poor auth z

484
00:17:17,119 --> 00:17:20,239
software vulnerabilities and the overall

485
00:17:19,599 --> 00:17:22,399
transport

486
00:17:20,240 --> 00:17:24,720
security between the broker and the

487
00:17:22,400 --> 00:17:24,720
client

488
00:17:25,679 --> 00:17:31,120
all right so denial of service

489
00:17:29,120 --> 00:17:32,399
this is a little bit different in mqtt

490
00:17:31,120 --> 00:17:34,159
you can obviously have a more

491
00:17:32,400 --> 00:17:35,760
traditional denial of service attack

492
00:17:34,160 --> 00:17:38,320
where you just flood the network

493
00:17:35,760 --> 00:17:39,360
but what's really interesting about mqtt

494
00:17:38,320 --> 00:17:42,320
is because

495
00:17:39,360 --> 00:17:43,360
the broker exists as a central point of

496
00:17:42,320 --> 00:17:45,760
failure

497
00:17:43,360 --> 00:17:46,559
you can actually use a rogue client to

498
00:17:45,760 --> 00:17:48,640
consume

499
00:17:46,559 --> 00:17:50,960
all of the broker resources by just

500
00:17:48,640 --> 00:17:52,559
sending a ton of requests to the broker

501
00:17:50,960 --> 00:17:54,240
if you can think about it you know if

502
00:17:52,559 --> 00:17:55,840
you have three kids and one of them is

503
00:17:54,240 --> 00:17:57,200
constantly screaming at you you're gonna

504
00:17:55,840 --> 00:17:58,320
pay more attention to the kid that's

505
00:17:57,200 --> 00:18:01,360
screaming

506
00:17:58,320 --> 00:18:04,240
so what happens is then the broker can't

507
00:18:01,360 --> 00:18:06,879
respond to authorized client requests

508
00:18:04,240 --> 00:18:09,039
the other interesting thing is the mqtt

509
00:18:06,880 --> 00:18:11,360
is often designed to not allow

510
00:18:09,039 --> 00:18:13,200
two devices with the same client id to

511
00:18:11,360 --> 00:18:15,439
connect to the same broker

512
00:18:13,200 --> 00:18:17,200
and since client ids are usually pretty

513
00:18:15,440 --> 00:18:18,320
easy to guess they're usually based on

514
00:18:17,200 --> 00:18:21,120
serial number

515
00:18:18,320 --> 00:18:22,720
or a very sort of easily incremented

516
00:18:21,120 --> 00:18:24,559
default username

517
00:18:22,720 --> 00:18:25,840
it can be really easy to spoof a client

518
00:18:24,559 --> 00:18:28,080
id and bump

519
00:18:25,840 --> 00:18:29,120
actual authorized devices off the

520
00:18:28,080 --> 00:18:31,520
network

521
00:18:29,120 --> 00:18:33,600
you can also try to just sort of spam

522
00:18:31,520 --> 00:18:36,480
the topic list so let's say that

523
00:18:33,600 --> 00:18:36,959
you have an industrial iot situation

524
00:18:36,480 --> 00:18:40,559
where

525
00:18:36,960 --> 00:18:43,840
the topic turn off the

526
00:18:40,559 --> 00:18:45,678
nuclear power reactor is active and only

527
00:18:43,840 --> 00:18:47,520
two or three things have access to that

528
00:18:45,679 --> 00:18:49,280
because obviously that's very sensitive

529
00:18:47,520 --> 00:18:50,960
well if i just keep spamming that topic

530
00:18:49,280 --> 00:18:52,559
and saying hey i'd like to subscribe hey

531
00:18:50,960 --> 00:18:54,320
i'd like to subscribe hey i'd like to

532
00:18:52,559 --> 00:18:56,799
publish hey i'd like to publish

533
00:18:54,320 --> 00:18:57,439
eventually i can overwhelm the mqtt

534
00:18:56,799 --> 00:18:59,440
broker

535
00:18:57,440 --> 00:19:01,200
just by trying to filter out all those

536
00:18:59,440 --> 00:19:04,640
bad requests

537
00:19:01,200 --> 00:19:07,039
the other thing is mqtt just like

538
00:19:04,640 --> 00:19:09,039
http or any other protocol can be

539
00:19:07,039 --> 00:19:12,240
vulnerable to malform packets

540
00:19:09,039 --> 00:19:14,799
because of the way that it processes

541
00:19:12,240 --> 00:19:15,520
any kind of data this can be really hard

542
00:19:14,799 --> 00:19:19,039
to detect

543
00:19:15,520 --> 00:19:19,039
really hard to defend against

544
00:19:19,760 --> 00:19:24,559
poor authentication so if you spin up an

545
00:19:22,880 --> 00:19:26,960
mqtt broker

546
00:19:24,559 --> 00:19:28,160
most of the common ones don't require

547
00:19:26,960 --> 00:19:31,440
any authentication at

548
00:19:28,160 --> 00:19:33,760
all um if they do support it you have to

549
00:19:31,440 --> 00:19:35,679
turn it on as a secondary feature

550
00:19:33,760 --> 00:19:38,320
and it's usually username and password

551
00:19:35,679 --> 00:19:40,559
which is sent in the clear

552
00:19:38,320 --> 00:19:41,360
username and client ids are pretty

553
00:19:40,559 --> 00:19:44,480
easily

554
00:19:41,360 --> 00:19:45,918
guessable it'll be like philips hue

555
00:19:44,480 --> 00:19:48,559
and then followed by the last four of

556
00:19:45,919 --> 00:19:52,320
its serial number or

557
00:19:48,559 --> 00:19:54,080
ir sensor 1 ir sensor 2 ir sensor 3

558
00:19:52,320 --> 00:19:55,840
things like that that are pretty easy to

559
00:19:54,080 --> 00:19:57,918
know or guess

560
00:19:55,840 --> 00:20:00,000
and there's also this problem of default

561
00:19:57,919 --> 00:20:01,200
device certificates or repeated device

562
00:20:00,000 --> 00:20:03,679
certificates

563
00:20:01,200 --> 00:20:05,760
in a perfect world certificates are

564
00:20:03,679 --> 00:20:07,600
better than username and password but if

565
00:20:05,760 --> 00:20:08,240
you give everybody the same username and

566
00:20:07,600 --> 00:20:10,000
password

567
00:20:08,240 --> 00:20:11,600
that's not so good well if you give

568
00:20:10,000 --> 00:20:13,919
everybody the same certificate

569
00:20:11,600 --> 00:20:16,399
it's basically the same problem and

570
00:20:13,919 --> 00:20:18,320
unfortunately when you're manufacturing

571
00:20:16,400 --> 00:20:19,440
hundreds of thousands or even millions

572
00:20:18,320 --> 00:20:22,158
of devices

573
00:20:19,440 --> 00:20:24,799
it can be a certificate nightmare to

574
00:20:22,159 --> 00:20:27,039
manage and distribute and revoke

575
00:20:24,799 --> 00:20:28,879
individual device certificates so many

576
00:20:27,039 --> 00:20:34,158
manufacturers use

577
00:20:28,880 --> 00:20:37,280
one certificate for all of their devices

578
00:20:34,159 --> 00:20:38,320
poor authorization so in a perfect world

579
00:20:37,280 --> 00:20:40,399
you would set

580
00:20:38,320 --> 00:20:42,158
your publish and subscribe topics to

581
00:20:40,400 --> 00:20:43,520
only the devices that needed to publish

582
00:20:42,159 --> 00:20:46,400
or subscribe right

583
00:20:43,520 --> 00:20:48,000
i would only want my light bulbs to

584
00:20:46,400 --> 00:20:50,799
publish to the home

585
00:20:48,000 --> 00:20:52,159
light bulbs topic i don't really want my

586
00:20:50,799 --> 00:20:55,600
light bulbs to publish

587
00:20:52,159 --> 00:20:58,240
to the home refrigerator

588
00:20:55,600 --> 00:20:58,959
turn off topic right that's that's not

589
00:20:58,240 --> 00:21:01,200
something that's

590
00:20:58,960 --> 00:21:02,159
useful and it shouldn't happen but

591
00:21:01,200 --> 00:21:04,960
unfortunately

592
00:21:02,159 --> 00:21:06,880
in a lot of mqtt instances it's very

593
00:21:04,960 --> 00:21:08,960
easy to just say anybody can publish

594
00:21:06,880 --> 00:21:10,960
anybody's subscribe and there's not a

595
00:21:08,960 --> 00:21:12,000
lot of great controls around device

596
00:21:10,960 --> 00:21:14,320
segregation

597
00:21:12,000 --> 00:21:16,240
there's also a lot of support for wild

598
00:21:14,320 --> 00:21:18,879
cards which is really great for example

599
00:21:16,240 --> 00:21:21,520
if i wanted to be able to subscribe to

600
00:21:18,880 --> 00:21:23,919
all the sensors in my home i could just

601
00:21:21,520 --> 00:21:26,960
subscribe to home slash sensors

602
00:21:23,919 --> 00:21:30,080
and then slash

603
00:21:26,960 --> 00:21:33,280
pound rather than doing home

604
00:21:30,080 --> 00:21:36,799
sensors light bulbs home sensors slash

605
00:21:33,280 --> 00:21:38,720
ir detect home slash sensor dash motion

606
00:21:36,799 --> 00:21:40,480
so it it's a useful thing but

607
00:21:38,720 --> 00:21:42,880
unfortunately it means that it can be

608
00:21:40,480 --> 00:21:44,480
really easy to enumerate topics over

609
00:21:42,880 --> 00:21:47,760
things that i shouldn't actually be able

610
00:21:44,480 --> 00:21:47,760
to publish or subscribe to

611
00:21:48,080 --> 00:21:51,760
and then finally software

612
00:21:49,440 --> 00:21:54,400
vulnerabilities so mqtt

613
00:21:51,760 --> 00:21:56,240
like any other software package has

614
00:21:54,400 --> 00:22:00,240
vulnerabilities in it

615
00:21:56,240 --> 00:22:03,440
we are now on mqtt version

616
00:22:00,240 --> 00:22:05,919
5 but most places are still running mqtt

617
00:22:03,440 --> 00:22:06,960
version 3.x

618
00:22:05,919 --> 00:22:08,559
and there's been a lot of

619
00:22:06,960 --> 00:22:10,799
vulnerabilities discovered in those

620
00:22:08,559 --> 00:22:11,678
application packages and the problem is

621
00:22:10,799 --> 00:22:13,760
that many of these

622
00:22:11,679 --> 00:22:15,919
don't get updated so you can think of

623
00:22:13,760 --> 00:22:18,158
something that's so central to your

624
00:22:15,919 --> 00:22:19,919
communications network that kind of sits

625
00:22:18,159 --> 00:22:22,240
out there and never gets updated which

626
00:22:19,919 --> 00:22:24,000
causes a huge vulnerability

627
00:22:22,240 --> 00:22:26,240
when you figure that if you can control

628
00:22:24,000 --> 00:22:28,400
the broker you can control the world

629
00:22:26,240 --> 00:22:29,840
and then also device side software

630
00:22:28,400 --> 00:22:31,679
vulnerabilities so many

631
00:22:29,840 --> 00:22:33,678
of these devices are cheaply

632
00:22:31,679 --> 00:22:34,640
manufactured they don't have good code

633
00:22:33,679 --> 00:22:38,559
quality

634
00:22:34,640 --> 00:22:41,919
they're used from open source or

635
00:22:38,559 --> 00:22:44,000
other sort of semi-questionable

636
00:22:41,919 --> 00:22:45,760
repositories without understanding

637
00:22:44,000 --> 00:22:48,000
either how they work together

638
00:22:45,760 --> 00:22:49,200
or how they're actually implemented in

639
00:22:48,000 --> 00:22:52,400
the device

640
00:22:49,200 --> 00:22:53,200
um and then also a lot of devices don't

641
00:22:52,400 --> 00:22:57,120
have any

642
00:22:53,200 --> 00:22:58,640
actual device side security so

643
00:22:57,120 --> 00:23:01,039
the certificates that i mentioned

644
00:22:58,640 --> 00:23:03,440
earlier are often just stored in the

645
00:23:01,039 --> 00:23:05,360
file system without encryption

646
00:23:03,440 --> 00:23:07,280
making it really easy to just grab that

647
00:23:05,360 --> 00:23:08,959
certificate and impersonate an

648
00:23:07,280 --> 00:23:10,879
authorized device and it's

649
00:23:08,960 --> 00:23:12,480
almost impossible to tell the difference

650
00:23:10,880 --> 00:23:14,480
between that device with a stolen

651
00:23:12,480 --> 00:23:18,080
certificate and an authorized device

652
00:23:14,480 --> 00:23:20,400
with the exact same certificate

653
00:23:18,080 --> 00:23:21,120
transport security so as i mentioned

654
00:23:20,400 --> 00:23:23,760
mqtt

655
00:23:21,120 --> 00:23:24,158
doesn't natively support encryption you

656
00:23:23,760 --> 00:23:26,799
can

657
00:23:24,159 --> 00:23:29,919
add it you can do tls which is what many

658
00:23:26,799 --> 00:23:32,000
of the providers do now

659
00:23:29,919 --> 00:23:34,000
but unfortunately many of the devices

660
00:23:32,000 --> 00:23:36,640
are low compute low bandwidth

661
00:23:34,000 --> 00:23:38,799
so it becomes really challenging to do a

662
00:23:36,640 --> 00:23:42,000
fully featured cipher suite

663
00:23:38,799 --> 00:23:44,240
to make encryption that's worthwhile

664
00:23:42,000 --> 00:23:46,080
and a lot of times the problem is they

665
00:23:44,240 --> 00:23:46,640
try to do lightweight implementations

666
00:23:46,080 --> 00:23:48,879
and

667
00:23:46,640 --> 00:23:50,080
lightweight in crypto world is usually a

668
00:23:48,880 --> 00:23:53,200
pseudonym for

669
00:23:50,080 --> 00:23:55,279
less good not always but often times

670
00:23:53,200 --> 00:23:56,559
and they also have something called

671
00:23:55,279 --> 00:23:58,559
insufficient entropy

672
00:23:56,559 --> 00:23:59,918
if those of you who are smarter than me

673
00:23:58,559 --> 00:24:01,840
have done a lot more

674
00:23:59,919 --> 00:24:03,440
studying of cryptography you'll notice

675
00:24:01,840 --> 00:24:05,918
that many of the cryptographic

676
00:24:03,440 --> 00:24:07,679
algorithms require a seed value

677
00:24:05,919 --> 00:24:09,600
and depending on the randomness of your

678
00:24:07,679 --> 00:24:12,400
seed value that can affect how

679
00:24:09,600 --> 00:24:13,520
cryptographically secure the actual

680
00:24:12,400 --> 00:24:16,640
certificate or

681
00:24:13,520 --> 00:24:17,279
or encryption algorithm ends up being so

682
00:24:16,640 --> 00:24:19,520
a lot of these

683
00:24:17,279 --> 00:24:20,559
manufacturers use their serial number

684
00:24:19,520 --> 00:24:23,039
for example

685
00:24:20,559 --> 00:24:25,120
and if my serial number is one two three

686
00:24:23,039 --> 00:24:27,279
and my next one is one two three four

687
00:24:25,120 --> 00:24:29,279
it becomes really easy to predict what

688
00:24:27,279 --> 00:24:30,960
that random value is and then much

689
00:24:29,279 --> 00:24:33,440
easier to crack the encryption that goes

690
00:24:30,960 --> 00:24:36,640
along with it

691
00:24:33,440 --> 00:24:39,120
so what's the problem well a lot of mqtt

692
00:24:36,640 --> 00:24:40,799
instances are exposed on the world wide

693
00:24:39,120 --> 00:24:43,360
web you can find them

694
00:24:40,799 --> 00:24:45,440
using pretty commonly known software

695
00:24:43,360 --> 00:24:47,039
like showdown

696
00:24:45,440 --> 00:24:48,640
and then you can connect to them and see

697
00:24:47,039 --> 00:24:50,799
what you can see um

698
00:24:48,640 --> 00:24:51,760
when i was a little girl there used to

699
00:24:50,799 --> 00:24:53,440
be this song

700
00:24:51,760 --> 00:24:55,120
a sailor went to sea to see what he

701
00:24:53,440 --> 00:24:56,720
could cc and

702
00:24:55,120 --> 00:24:58,479
oftentimes i feel like that when i'm

703
00:24:56,720 --> 00:24:58,880
doing any kind of scan on the internet

704
00:24:58,480 --> 00:25:02,159
or

705
00:24:58,880 --> 00:25:05,840
sufficiently large segment of my

706
00:25:02,159 --> 00:25:08,000
private ip space so it's kind of scary

707
00:25:05,840 --> 00:25:08,959
and terrifying and awful what you can

708
00:25:08,000 --> 00:25:12,159
find if you just

709
00:25:08,960 --> 00:25:13,919
kind of look so

710
00:25:12,159 --> 00:25:15,919
here's what i found i did the scan a

711
00:25:13,919 --> 00:25:18,799
couple months ago not surprising

712
00:25:15,919 --> 00:25:20,480
um the biggest sort of area of this is

713
00:25:18,799 --> 00:25:22,080
in china there are huge device

714
00:25:20,480 --> 00:25:24,559
manufacturers in shinzon

715
00:25:22,080 --> 00:25:26,240
and other areas um i think it's

716
00:25:24,559 --> 00:25:27,120
important to note that many of these are

717
00:25:26,240 --> 00:25:29,919
probably test

718
00:25:27,120 --> 00:25:30,719
devices so it's not as bleak as maybe it

719
00:25:29,919 --> 00:25:33,120
could be

720
00:25:30,720 --> 00:25:35,120
but many of these are things that you

721
00:25:33,120 --> 00:25:36,158
wouldn't necessarily want connected to

722
00:25:35,120 --> 00:25:39,840
the world wide web

723
00:25:36,159 --> 00:25:41,440
cameras um industrial sensors things

724
00:25:39,840 --> 00:25:43,439
like that you can kind of

725
00:25:41,440 --> 00:25:45,440
you can do this on your own showdown you

726
00:25:43,440 --> 00:25:46,080
get a certain number of free searches

727
00:25:45,440 --> 00:25:48,000
but

728
00:25:46,080 --> 00:25:49,678
it's really really interesting to kind

729
00:25:48,000 --> 00:25:52,000
of look around and see

730
00:25:49,679 --> 00:25:53,039
what is on the public internet uh

731
00:25:52,000 --> 00:25:55,200
unencrypted

732
00:25:53,039 --> 00:25:57,840
sometimes no username and password it's

733
00:25:55,200 --> 00:25:59,600
uh it can be kind of terrifying

734
00:25:57,840 --> 00:26:01,840
and showdown's great don't get me wrong

735
00:25:59,600 --> 00:26:04,879
i i like showdan a lot

736
00:26:01,840 --> 00:26:07,279
but i am cheap and i don't want to pay

737
00:26:04,880 --> 00:26:08,159
full price for subscription my manager

738
00:26:07,279 --> 00:26:10,159
said no

739
00:26:08,159 --> 00:26:11,520
so i got to thinking after you know i

740
00:26:10,159 --> 00:26:14,000
exhausted my

741
00:26:11,520 --> 00:26:15,440
i don't know how many it is uh freeze

742
00:26:14,000 --> 00:26:17,679
showdown search

743
00:26:15,440 --> 00:26:19,440
limits and i said well i'd really like

744
00:26:17,679 --> 00:26:21,440
to do some more scanning but

745
00:26:19,440 --> 00:26:23,360
i'm i'm out of showdown search credits

746
00:26:21,440 --> 00:26:25,039
so surely there's got to be a way to do

747
00:26:23,360 --> 00:26:27,199
this with another tool

748
00:26:25,039 --> 00:26:29,840
and at first i looked into nmap which is

749
00:26:27,200 --> 00:26:31,760
great but unfortunately

750
00:26:29,840 --> 00:26:33,279
not really great for scanning a large

751
00:26:31,760 --> 00:26:34,879
portion of ips

752
00:26:33,279 --> 00:26:36,880
and then i found this tool called mass

753
00:26:34,880 --> 00:26:39,679
scan

754
00:26:36,880 --> 00:26:40,880
mass scan is like nmap on steroids it's

755
00:26:39,679 --> 00:26:43,520
fantastic

756
00:26:40,880 --> 00:26:44,480
it uses basically the same in-map um

757
00:26:43,520 --> 00:26:47,918
syntax

758
00:26:44,480 --> 00:26:51,440
but it can scan legitimately the entire

759
00:26:47,919 --> 00:26:53,679
internet uh it's really fast it's

760
00:26:51,440 --> 00:26:55,440
really i found it to be really reliable

761
00:26:53,679 --> 00:26:57,919
i've had a lot of fun with this tool

762
00:26:55,440 --> 00:26:59,840
i highly highly recommend that you go

763
00:26:57,919 --> 00:27:04,000
download it and play with it

764
00:26:59,840 --> 00:27:06,240
um here's the link to the github

765
00:27:04,000 --> 00:27:07,120
if you used in-map at all in the past

766
00:27:06,240 --> 00:27:09,360
this tool will be

767
00:27:07,120 --> 00:27:10,639
really familiar to you it allows you to

768
00:27:09,360 --> 00:27:12,719
scan on any port

769
00:27:10,640 --> 00:27:14,159
for any protocol it has a bunch of other

770
00:27:12,720 --> 00:27:16,400
features that i won't go into

771
00:27:14,159 --> 00:27:19,360
but super recommend you throw it on your

772
00:27:16,400 --> 00:27:19,360
lab and check it out

773
00:27:19,679 --> 00:27:23,840
this is the portion of the program where

774
00:27:21,840 --> 00:27:27,039
i am obliged to

775
00:27:23,840 --> 00:27:29,360
give you a good faith warning just

776
00:27:27,039 --> 00:27:32,000
because you can scan the entire internet

777
00:27:29,360 --> 00:27:33,918
doesn't mean you should uh i got a lot

778
00:27:32,000 --> 00:27:35,440
of flack uh the last time i gave this

779
00:27:33,919 --> 00:27:38,159
talk because people go uh

780
00:27:35,440 --> 00:27:38,880
i've scanned anything i want to scan and

781
00:27:38,159 --> 00:27:41,039
that is

782
00:27:38,880 --> 00:27:43,120
absolutely you're right however you

783
00:27:41,039 --> 00:27:45,279
should know that in many jurisdictions

784
00:27:43,120 --> 00:27:47,039
that is not entirely legal

785
00:27:45,279 --> 00:27:49,440
depending on your licensure and

786
00:27:47,039 --> 00:27:52,480
certifications it's not entirely ethical

787
00:27:49,440 --> 00:27:55,679
within the terms of certification boards

788
00:27:52,480 --> 00:27:57,360
so please only scan things that you are

789
00:27:55,679 --> 00:27:58,880
authorized to scan

790
00:27:57,360 --> 00:28:02,320
remember that certain parts of the

791
00:27:58,880 --> 00:28:05,120
internet like say election systems um

792
00:28:02,320 --> 00:28:05,918
don't really react well to being scanned

793
00:28:05,120 --> 00:28:09,039
and can

794
00:28:05,919 --> 00:28:09,679
unfortunately especially in the latest

795
00:28:09,039 --> 00:28:11,360
climate

796
00:28:09,679 --> 00:28:14,320
get you a visit from folks that you

797
00:28:11,360 --> 00:28:16,158
definitely do not want to talk to

798
00:28:14,320 --> 00:28:17,520
but hypothetically if you worked for a

799
00:28:16,159 --> 00:28:20,240
huge company

800
00:28:17,520 --> 00:28:22,320
with a huge presence that owned maybe

801
00:28:20,240 --> 00:28:24,640
half the ip space in the world

802
00:28:22,320 --> 00:28:28,320
mass scan would be a great tool because

803
00:28:24,640 --> 00:28:28,320
you have a lot of space to roam

804
00:28:28,399 --> 00:28:34,959
so this is i just grabbed a

805
00:28:31,520 --> 00:28:38,559
um a screen capture off of my my box

806
00:28:34,960 --> 00:28:39,440
so i started mass scan up um randomized

807
00:28:38,559 --> 00:28:42,639
the hosts

808
00:28:39,440 --> 00:28:46,720
i started doing skeleton scan um

809
00:28:42,640 --> 00:28:50,480
two ports basically 1883

810
00:28:46,720 --> 00:28:53,520
which is the mqtt unencrypted port and

811
00:28:50,480 --> 00:28:54,480
then 8883 which is the mqtt over ssl

812
00:28:53,520 --> 00:28:58,080
port

813
00:28:54,480 --> 00:29:01,279
um you'll notice this number

814
00:28:58,080 --> 00:29:04,960
here um is not

815
00:29:01,279 --> 00:29:08,000
65 000 because apparently

816
00:29:04,960 --> 00:29:08,720
when subnetting typos make a really big

817
00:29:08,000 --> 00:29:11,840
difference

818
00:29:08,720 --> 00:29:14,559
and sometimes if you make a typo instead

819
00:29:11,840 --> 00:29:16,879
of scanning 65 000 hosts

820
00:29:14,559 --> 00:29:17,840
you end up scanning around 16 million

821
00:29:16,880 --> 00:29:20,960
hosts

822
00:29:17,840 --> 00:29:21,918
so uh yeah that happened but you know

823
00:29:20,960 --> 00:29:23,840
shame on me

824
00:29:21,919 --> 00:29:25,120
uh that should not have happened so i

825
00:29:23,840 --> 00:29:28,240
did get a lot of really

826
00:29:25,120 --> 00:29:31,439
interesting um

827
00:29:28,240 --> 00:29:32,640
hits back uh probably not places that i

828
00:29:31,440 --> 00:29:36,080
should have been looking but

829
00:29:32,640 --> 00:29:40,320
you know stuff happens um

830
00:29:36,080 --> 00:29:42,080
so of the 16 million i only got 225 000

831
00:29:40,320 --> 00:29:43,760
hosts that squawked back to me on those

832
00:29:42,080 --> 00:29:45,199
ports which isn't a lot but i mean it's

833
00:29:43,760 --> 00:29:46,640
a pretty significant amount

834
00:29:45,200 --> 00:29:49,360
it means they at least have that port

835
00:29:46,640 --> 00:29:51,600
open and of those um

836
00:29:49,360 --> 00:29:53,039
open ports if you go all the way down

837
00:29:51,600 --> 00:29:56,240
you'll see that i got about a

838
00:29:53,039 --> 00:29:59,279
thousand hosts that were

839
00:29:56,240 --> 00:30:01,039
replying back on mqtt port 1883 which

840
00:29:59,279 --> 00:30:02,640
means they weren't using any kind of

841
00:30:01,039 --> 00:30:04,480
encryption it was completely in the

842
00:30:02,640 --> 00:30:06,320
clear

843
00:30:04,480 --> 00:30:07,679
i tend to find that if you haven't

844
00:30:06,320 --> 00:30:08,000
bothered to enable encryption you

845
00:30:07,679 --> 00:30:09,760
probably

846
00:30:08,000 --> 00:30:11,840
haven't bothered to enable username and

847
00:30:09,760 --> 00:30:13,120
password off uh it's probably a default

848
00:30:11,840 --> 00:30:15,439
configuration

849
00:30:13,120 --> 00:30:17,600
thrown out to the wild so those are the

850
00:30:15,440 --> 00:30:19,120
hosts that are really

851
00:30:17,600 --> 00:30:21,279
really vulnerable and those are the

852
00:30:19,120 --> 00:30:22,000
hosts that i want to go after if i'm

853
00:30:21,279 --> 00:30:24,399
doing

854
00:30:22,000 --> 00:30:26,080
a scan especially if i'm sort of going

855
00:30:24,399 --> 00:30:27,678
for the lower hanging fruit

856
00:30:26,080 --> 00:30:29,678
so what i was able to do is write a

857
00:30:27,679 --> 00:30:32,480
script using pajo mqtt

858
00:30:29,679 --> 00:30:33,679
to find connectable hosts within that

859
00:30:32,480 --> 00:30:36,799
scanned list

860
00:30:33,679 --> 00:30:38,720
that allowed a connection code of zero

861
00:30:36,799 --> 00:30:40,720
now there's some other stuff you can do

862
00:30:38,720 --> 00:30:43,840
with the other connection codes and

863
00:30:40,720 --> 00:30:45,279
that's definitely worthwhile but i had a

864
00:30:43,840 --> 00:30:48,399
limited time to do this

865
00:30:45,279 --> 00:30:49,840
and limited sort of scope so i wanted to

866
00:30:48,399 --> 00:30:51,120
make sure i focused on things that were

867
00:30:49,840 --> 00:30:53,840
easy to find

868
00:30:51,120 --> 00:30:55,360
easy to exploit so i'm going for

869
00:30:53,840 --> 00:30:57,120
connection code 0 because that means

870
00:30:55,360 --> 00:30:59,039
that i connected with no username no

871
00:30:57,120 --> 00:31:03,120
password no encryption

872
00:30:59,039 --> 00:31:05,600
which is for my purposes really good

873
00:31:03,120 --> 00:31:06,879
so now i've got this list that'll allow

874
00:31:05,600 --> 00:31:09,519
me to connect and

875
00:31:06,880 --> 00:31:10,000
i could have stayed in pajo and ptt and

876
00:31:09,519 --> 00:31:11,760
sort of

877
00:31:10,000 --> 00:31:14,320
fiddled about with it to see what i

878
00:31:11,760 --> 00:31:17,360
could find but i actually stumbled

879
00:31:14,320 --> 00:31:18,240
on this great tool from akamai called

880
00:31:17,360 --> 00:31:21,760
mqtt

881
00:31:18,240 --> 00:31:24,240
pwn and it has the most awesome

882
00:31:21,760 --> 00:31:25,519
set of sort of pre-configured almost

883
00:31:24,240 --> 00:31:28,320
metasploit like

884
00:31:25,519 --> 00:31:30,559
modules that allow you to do everything

885
00:31:28,320 --> 00:31:31,120
from credential brute forcing to topic

886
00:31:30,559 --> 00:31:33,918
in

887
00:31:31,120 --> 00:31:34,158
numeration to client reconnaissance it's

888
00:31:33,919 --> 00:31:36,559
an

889
00:31:34,159 --> 00:31:38,640
awesome package highly recommend it it

890
00:31:36,559 --> 00:31:41,120
comes in its own docker container

891
00:31:38,640 --> 00:31:42,960
it's fantastic so i was able to use that

892
00:31:41,120 --> 00:31:45,918
and i connected to

893
00:31:42,960 --> 00:31:47,600
just a few of those things that i had

894
00:31:45,919 --> 00:31:49,600
found the ones that looked interesting

895
00:31:47,600 --> 00:31:50,959
and this is just a snapshot it goes on

896
00:31:49,600 --> 00:31:53,360
for quite a ways

897
00:31:50,960 --> 00:31:55,039
i didn't want to show anything terribly

898
00:31:53,360 --> 00:31:58,479
um

899
00:31:55,039 --> 00:31:59,840
obvious or terribly insecure

900
00:31:58,480 --> 00:32:01,679
because i didn't want to sort of name

901
00:31:59,840 --> 00:32:03,199
and shame these folks um

902
00:32:01,679 --> 00:32:04,799
but you can see that i was able to

903
00:32:03,200 --> 00:32:06,159
connect to the syst broker and basically

904
00:32:04,799 --> 00:32:07,200
there's a bunch of topics that i can

905
00:32:06,159 --> 00:32:10,640
subscribe to

906
00:32:07,200 --> 00:32:12,320
underneath the sysbroker it allows me to

907
00:32:10,640 --> 00:32:13,760
access a lot of information on this

908
00:32:12,320 --> 00:32:16,879
particular mqtt

909
00:32:13,760 --> 00:32:18,320
broker with no username no password no

910
00:32:16,880 --> 00:32:21,679
encryption so that

911
00:32:18,320 --> 00:32:22,639
if you think of the use cases we spoke

912
00:32:21,679 --> 00:32:26,799
about earlier

913
00:32:22,640 --> 00:32:29,200
imagine i'm a car manufacturer that now

914
00:32:26,799 --> 00:32:31,200
has mqtt exposed to the web

915
00:32:29,200 --> 00:32:32,799
and suddenly i can connect to your car

916
00:32:31,200 --> 00:32:34,080
and tell it to turn off because it's out

917
00:32:32,799 --> 00:32:36,320
of fuel or

918
00:32:34,080 --> 00:32:38,000
you know tell it to pull into a

919
00:32:36,320 --> 00:32:38,399
maintenance station because it's oil is

920
00:32:38,000 --> 00:32:39,919
too

921
00:32:38,399 --> 00:32:42,000
dirty there's a lot of really

922
00:32:39,919 --> 00:32:45,200
interesting things that you can think of

923
00:32:42,000 --> 00:32:47,440
as you go down this now at the risk of

924
00:32:45,200 --> 00:32:48,320
sounding hyperbolic i want to point out

925
00:32:47,440 --> 00:32:52,480
that most

926
00:32:48,320 --> 00:32:54,720
implementations you'll see of mqtt in

927
00:32:52,480 --> 00:32:57,279
more advanced sort of scenarios like the

928
00:32:54,720 --> 00:32:59,200
connected car like the connected factory

929
00:32:57,279 --> 00:33:00,559
aren't default out of the box no

930
00:32:59,200 --> 00:33:03,760
username no encryption

931
00:33:00,559 --> 00:33:05,678
sort of scenarios so i don't want it to

932
00:33:03,760 --> 00:33:07,200
seem like it's really super easy to go

933
00:33:05,679 --> 00:33:08,399
take over a bunch of cars that's not

934
00:33:07,200 --> 00:33:10,240
what i'm saying

935
00:33:08,399 --> 00:33:12,479
i am saying though that are there are

936
00:33:10,240 --> 00:33:14,320
many especially legacy factories or

937
00:33:12,480 --> 00:33:17,039
legacy implementations of this

938
00:33:14,320 --> 00:33:17,760
protocol that simply aren't secured and

939
00:33:17,039 --> 00:33:19,360
somebody

940
00:33:17,760 --> 00:33:20,879
somewhere put them on the internet and

941
00:33:19,360 --> 00:33:22,799
then forgot about them

942
00:33:20,880 --> 00:33:24,320
so you i think if you dig you'll find

943
00:33:22,799 --> 00:33:26,080
some really interesting use cases for

944
00:33:24,320 --> 00:33:29,360
this

945
00:33:26,080 --> 00:33:30,480
all right so we've talked a lot about

946
00:33:29,360 --> 00:33:33,918
what mqtt

947
00:33:30,480 --> 00:33:36,480
is and sort of the vulnerabilities and

948
00:33:33,919 --> 00:33:38,159
issues with it we've found a bunch of

949
00:33:36,480 --> 00:33:38,960
mqtt brokers that are out on the

950
00:33:38,159 --> 00:33:40,559
internet

951
00:33:38,960 --> 00:33:42,559
with no username no password no

952
00:33:40,559 --> 00:33:45,600
encryption

953
00:33:42,559 --> 00:33:47,519
and i could talk to you today about the

954
00:33:45,600 --> 00:33:48,799
power plants that run mqtt

955
00:33:47,519 --> 00:33:51,120
and how terrible it would be to take

956
00:33:48,799 --> 00:33:52,240
those over or the wind turbines that run

957
00:33:51,120 --> 00:33:53,840
mqtt

958
00:33:52,240 --> 00:33:55,440
and how awful it would be if one of

959
00:33:53,840 --> 00:33:58,720
those got taken over

960
00:33:55,440 --> 00:33:59,519
or broken or taken offline but i really

961
00:33:58,720 --> 00:34:01,760
want to focus

962
00:33:59,519 --> 00:34:02,720
today on something that i think you'll

963
00:34:01,760 --> 00:34:04,840
find

964
00:34:02,720 --> 00:34:06,399
even more interesting and even more

965
00:34:04,840 --> 00:34:09,199
important

966
00:34:06,399 --> 00:34:11,759
friends i would like to introduce you to

967
00:34:09,199 --> 00:34:14,719
the internet of cows

968
00:34:11,760 --> 00:34:15,839
remember when i said earlier that iot is

969
00:34:14,719 --> 00:34:18,158
exploding

970
00:34:15,839 --> 00:34:19,599
there is so much technology that is in

971
00:34:18,159 --> 00:34:20,320
the internet of things it's almost

972
00:34:19,599 --> 00:34:23,760
impossible

973
00:34:20,320 --> 00:34:26,399
to keep track of it well we've connected

974
00:34:23,760 --> 00:34:27,919
cows to the internet

975
00:34:26,399 --> 00:34:30,319
we've connected sensors in their

976
00:34:27,918 --> 00:34:32,560
stomachs and sensors and their tails and

977
00:34:30,320 --> 00:34:34,000
sensors in their colors that allow us to

978
00:34:32,560 --> 00:34:36,639
drive them from remote

979
00:34:34,000 --> 00:34:37,119
offices it's kind of crazy if you think

980
00:34:36,639 --> 00:34:39,679
about

981
00:34:37,119 --> 00:34:41,359
how connected something like the average

982
00:34:39,679 --> 00:34:43,520
cow is

983
00:34:41,359 --> 00:34:45,040
now imagine and this is an actual

984
00:34:43,520 --> 00:34:46,000
scenario there's an actual product that

985
00:34:45,040 --> 00:34:47,918
does this

986
00:34:46,000 --> 00:34:50,159
imagine you have a scenario with a bunch

987
00:34:47,918 --> 00:34:52,879
of free-range cattle that have

988
00:34:50,159 --> 00:34:54,320
collars that allow you to geo-fence them

989
00:34:52,879 --> 00:34:56,960
tell them when to come back

990
00:34:54,320 --> 00:34:57,760
to the barn tell them where they can

991
00:34:56,960 --> 00:34:59,440
roam

992
00:34:57,760 --> 00:35:01,359
they shock them as they go too far

993
00:34:59,440 --> 00:35:04,240
outside the geo-fencing

994
00:35:01,359 --> 00:35:04,720
uh coordinates now imagine if i was able

995
00:35:04,240 --> 00:35:07,919
to

996
00:35:04,720 --> 00:35:10,720
take over that mqtt broker in the middle

997
00:35:07,920 --> 00:35:12,480
and i could shock the cows and i could

998
00:35:10,720 --> 00:35:13,759
drive them into other places that were

999
00:35:12,480 --> 00:35:15,280
not in the geofence

1000
00:35:13,760 --> 00:35:16,800
i could have them break out of their

1001
00:35:15,280 --> 00:35:20,160
pens and run down

1002
00:35:16,800 --> 00:35:22,560
pedestrians so imagine if you will

1003
00:35:20,160 --> 00:35:23,839
the internet of zombie cows and i think

1004
00:35:22,560 --> 00:35:26,640
you'll start to see

1005
00:35:23,839 --> 00:35:27,359
the really interesting use cases that

1006
00:35:26,640 --> 00:35:30,400
can

1007
00:35:27,359 --> 00:35:34,640
evolve from mqtt that is not

1008
00:35:30,400 --> 00:35:34,640
properly installed and properly secured

1009
00:35:35,119 --> 00:35:38,640
the good news is much of this is moving

1010
00:35:37,200 --> 00:35:41,439
to the cloud

1011
00:35:38,640 --> 00:35:41,839
as everyone knows if it's in the cloud

1012
00:35:41,440 --> 00:35:45,040
it's

1013
00:35:41,839 --> 00:35:46,240
awesome uh with the good news is that

1014
00:35:45,040 --> 00:35:49,119
with that migration

1015
00:35:46,240 --> 00:35:49,839
a lot of default security things are

1016
00:35:49,119 --> 00:35:53,280
becoming

1017
00:35:49,839 --> 00:35:55,279
commonplace like tls ssl

1018
00:35:53,280 --> 00:35:58,480
most of the cloud vendors won't allow

1019
00:35:55,280 --> 00:35:59,359
you to use no auth you have to use tls

1020
00:35:58,480 --> 00:36:00,880
for

1021
00:35:59,359 --> 00:36:02,319
the majority of cloud vendors there's

1022
00:36:00,880 --> 00:36:03,280
some that still allow username and

1023
00:36:02,320 --> 00:36:05,680
password

1024
00:36:03,280 --> 00:36:07,680
um there's also a lot more detection and

1025
00:36:05,680 --> 00:36:09,839
automation behind the behavior so in the

1026
00:36:07,680 --> 00:36:12,160
scenario like i talked about earlier

1027
00:36:09,839 --> 00:36:13,839
if i suddenly have a bunch of cows that

1028
00:36:12,160 --> 00:36:14,399
are sending a lot more data than they

1029
00:36:13,839 --> 00:36:16,640
used to

1030
00:36:14,400 --> 00:36:17,760
i can have a detection anomaly service

1031
00:36:16,640 --> 00:36:19,279
behind the broker

1032
00:36:17,760 --> 00:36:21,920
that goes ah that's not quite right

1033
00:36:19,280 --> 00:36:23,760
maybe we should look into that

1034
00:36:21,920 --> 00:36:26,240
there's also a lot better

1035
00:36:23,760 --> 00:36:28,400
implementations of tls and ssl

1036
00:36:26,240 --> 00:36:30,799
specifically designed for iot use cases

1037
00:36:28,400 --> 00:36:33,599
so you have entire teams of engineers

1038
00:36:30,800 --> 00:36:35,440
working on making tls lighter weight and

1039
00:36:33,599 --> 00:36:36,800
faster and lower overhead

1040
00:36:35,440 --> 00:36:38,480
specifically for these constrained

1041
00:36:36,800 --> 00:36:40,640
devices

1042
00:36:38,480 --> 00:36:42,560
it's also easier because many of the

1043
00:36:40,640 --> 00:36:44,960
cloud providers allow you to integrate

1044
00:36:42,560 --> 00:36:47,200
into their existing identity providers

1045
00:36:44,960 --> 00:36:48,000
making those per-device policies that we

1046
00:36:47,200 --> 00:36:52,240
talked about

1047
00:36:48,000 --> 00:36:53,920
so much so much easier um

1048
00:36:52,240 --> 00:36:56,240
for those of us who've been around a

1049
00:36:53,920 --> 00:36:57,920
little while i think you'll notice that

1050
00:36:56,240 --> 00:36:58,720
the cloud is just another person's

1051
00:36:57,920 --> 00:37:00,640
server

1052
00:36:58,720 --> 00:37:01,919
so while there's many good things about

1053
00:37:00,640 --> 00:37:04,960
moving to the cloud

1054
00:37:01,920 --> 00:37:07,359
there are some downsides uh you

1055
00:37:04,960 --> 00:37:08,000
typically cloud providers want to make

1056
00:37:07,359 --> 00:37:10,560
it as easy

1057
00:37:08,000 --> 00:37:12,160
as possible for people to onboard to

1058
00:37:10,560 --> 00:37:14,799
their cloud service providers so they

1059
00:37:12,160 --> 00:37:18,319
make the environment highly customizable

1060
00:37:14,800 --> 00:37:19,760
which means that users can onboard to

1061
00:37:18,320 --> 00:37:21,680
the cloud but they can also do some

1062
00:37:19,760 --> 00:37:23,920
really stupid stuff

1063
00:37:21,680 --> 00:37:24,960
now with the power and scale of the

1064
00:37:23,920 --> 00:37:27,599
cloud

1065
00:37:24,960 --> 00:37:29,920
more devices are connecting to a cloud

1066
00:37:27,599 --> 00:37:30,480
service provider versus being segmented

1067
00:37:29,920 --> 00:37:32,079
into

1068
00:37:30,480 --> 00:37:33,680
their own networks and with any

1069
00:37:32,079 --> 00:37:35,520
connection there's the potential for

1070
00:37:33,680 --> 00:37:37,359
interception or breakage

1071
00:37:35,520 --> 00:37:39,280
it's just expanding that threat

1072
00:37:37,359 --> 00:37:41,359
footprint even further

1073
00:37:39,280 --> 00:37:42,880
systems also often aren't designed with

1074
00:37:41,359 --> 00:37:46,078
the appropriate redundancy

1075
00:37:42,880 --> 00:37:49,040
so you have to keep in mind that

1076
00:37:46,079 --> 00:37:50,560
many of these iot device manufacturers

1077
00:37:49,040 --> 00:37:53,279
or factories

1078
00:37:50,560 --> 00:37:54,160
are used to sort of being on their own

1079
00:37:53,280 --> 00:37:56,000
and off

1080
00:37:54,160 --> 00:37:57,598
sort of in their own physical space

1081
00:37:56,000 --> 00:37:59,520
where everybody in

1082
00:37:57,599 --> 00:38:01,280
their network was trusted because you

1083
00:37:59,520 --> 00:38:02,160
had physical barriers that separated

1084
00:38:01,280 --> 00:38:04,000
them

1085
00:38:02,160 --> 00:38:05,680
many times when they move to the cloud

1086
00:38:04,000 --> 00:38:07,440
they they forget to do a lot of the

1087
00:38:05,680 --> 00:38:11,040
redundancy steps you'd see in a more

1088
00:38:07,440 --> 00:38:11,040
traditional it environment

1089
00:38:11,520 --> 00:38:15,599
all right so that is pretty much

1090
00:38:13,520 --> 00:38:18,480
everything on mqtt

1091
00:38:15,599 --> 00:38:19,040
uh just some takeaways so it's a

1092
00:38:18,480 --> 00:38:21,680
lightweight

1093
00:38:19,040 --> 00:38:23,759
widely adopted protocol for iot messages

1094
00:38:21,680 --> 00:38:26,399
that uses publish and subscribe

1095
00:38:23,760 --> 00:38:27,680
it's often insecure it's often

1096
00:38:26,400 --> 00:38:30,640
misconfigured

1097
00:38:27,680 --> 00:38:32,000
and it's pretty much everywhere you look

1098
00:38:30,640 --> 00:38:33,598
after this presentation

1099
00:38:32,000 --> 00:38:35,119
i guarantee you're going to start to see

1100
00:38:33,599 --> 00:38:37,440
it everywhere

1101
00:38:35,119 --> 00:38:38,720
by default it has no authentication and

1102
00:38:37,440 --> 00:38:41,040
even with authentication

1103
00:38:38,720 --> 00:38:42,078
doesn't support native encryption when

1104
00:38:41,040 --> 00:38:44,240
deploying

1105
00:38:42,079 --> 00:38:45,119
um you have to utilize either encryption

1106
00:38:44,240 --> 00:38:46,799
over the wire

1107
00:38:45,119 --> 00:38:48,320
or on the device to protect things like

1108
00:38:46,800 --> 00:38:50,960
username and password

1109
00:38:48,320 --> 00:38:52,960
and digital certificates and it's also

1110
00:38:50,960 --> 00:38:54,320
really important but really hard to have

1111
00:38:52,960 --> 00:38:56,400
tightly controlled per device

1112
00:38:54,320 --> 00:38:58,400
certificates and per device apples

1113
00:38:56,400 --> 00:39:00,800
so that's many of the areas where you'll

1114
00:38:58,400 --> 00:39:03,280
find that you can get a foothold

1115
00:39:00,800 --> 00:39:05,520
is by compromising a device and stealing

1116
00:39:03,280 --> 00:39:08,400
a certificate or compromising a device

1117
00:39:05,520 --> 00:39:10,240
and being able to impersonate another

1118
00:39:08,400 --> 00:39:12,640
device or impersonate an authorized

1119
00:39:10,240 --> 00:39:12,640
device

1120
00:39:13,200 --> 00:39:17,919
thank you so much for taking an hour out

1121
00:39:16,000 --> 00:39:19,119
of your saturday to come and learn about

1122
00:39:17,920 --> 00:39:21,040
iot with me

1123
00:39:19,119 --> 00:39:23,599
for those of you who know me you'll know

1124
00:39:21,040 --> 00:39:26,240
that i'm a bit new to the iot space

1125
00:39:23,599 --> 00:39:27,680
so i'm really excited to start sharing

1126
00:39:26,240 --> 00:39:29,680
everything i'm learning

1127
00:39:27,680 --> 00:39:31,118
with folks who may not have been exposed

1128
00:39:29,680 --> 00:39:33,598
to it i know that

1129
00:39:31,119 --> 00:39:35,280
until probably six months ago i hadn't

1130
00:39:33,599 --> 00:39:36,880
been exposed to a lot of this so i'm

1131
00:39:35,280 --> 00:39:40,320
super excited about it

1132
00:39:36,880 --> 00:39:42,240
i hope you will be too at the top is my

1133
00:39:40,320 --> 00:39:43,839
very neglected website that i keep

1134
00:39:42,240 --> 00:39:46,078
meaning to actually

1135
00:39:43,839 --> 00:39:47,839
do something with it's basically got the

1136
00:39:46,079 --> 00:39:49,599
slides of my talks and that's it but

1137
00:39:47,839 --> 00:39:51,839
someday i'm going to write something

1138
00:39:49,599 --> 00:39:53,760
amazing it's just today is not that day

1139
00:39:51,839 --> 00:39:56,400
but check it out all the slides will be

1140
00:39:53,760 --> 00:39:58,400
uploaded there um that's the link to

1141
00:39:56,400 --> 00:40:00,480
mass scan and mqtt pwn

1142
00:39:58,400 --> 00:40:02,960
both freely available highly recommend

1143
00:40:00,480 --> 00:40:05,760
you check them out super awesome tools

1144
00:40:02,960 --> 00:40:07,760
um and then the last link is if you want

1145
00:40:05,760 --> 00:40:09,839
to play with this at home

1146
00:40:07,760 --> 00:40:12,079
you can roll your own mqtt broker and

1147
00:40:09,839 --> 00:40:13,359
kind of see how to configure it and how

1148
00:40:12,079 --> 00:40:15,359
to attack it

1149
00:40:13,359 --> 00:40:16,640
the instructables link at the bottom has

1150
00:40:15,359 --> 00:40:18,640
a way to do that

1151
00:40:16,640 --> 00:40:20,078
on your own i think it's a really really

1152
00:40:18,640 --> 00:40:21,520
well written tutorial

1153
00:40:20,079 --> 00:40:24,079
it helped me a lot when i was getting

1154
00:40:21,520 --> 00:40:26,880
some of my iot stuff off the ground

1155
00:40:24,079 --> 00:40:27,359
love it if you follow me on twitter i

1156
00:40:26,880 --> 00:40:29,920
post

1157
00:40:27,359 --> 00:40:31,598
somewhat about iot and mostly about

1158
00:40:29,920 --> 00:40:34,000
other things but

1159
00:40:31,599 --> 00:40:34,960
i if those of you who know me i worked

1160
00:40:34,000 --> 00:40:36,800
at twitter for

1161
00:40:34,960 --> 00:40:38,079
a brief period so now i guess i'm

1162
00:40:36,800 --> 00:40:41,440
addicted to the platform

1163
00:40:38,079 --> 00:40:43,680
and i have to stay there so i will hang

1164
00:40:41,440 --> 00:40:44,160
out afterwards for any questions feel

1165
00:40:43,680 --> 00:40:47,200
free

1166
00:40:44,160 --> 00:40:48,720
to hit me up on twitter or find me at

1167
00:40:47,200 --> 00:40:50,640
the cons whenever we get

1168
00:40:48,720 --> 00:40:53,839
back to real life thanks so much and

1169
00:40:50,640 --> 00:40:53,839
have a good weekend

1170
00:41:12,079 --> 00:41:14,160
you

