1
00:00:00,000 --> 00:00:05,380
yeah good afternoon everybody but I
longer talking gives it all away in the

2
00:00:05,380 --> 00:00:09,460
next couple of minutes I will talk about
how it is possible to the activator

3
00:00:09,460 --> 00:00:12,440
point protection software in
unauthorized manner

4
00:00:12,440 --> 00:00:19,210
actually I will talk about to less
regarded security issues that's we've

5
00:00:19,210 --> 00:00:25,730
financed occasionally in this kind of
software but also other software

6
00:00:25,730 --> 00:00:33,649
products some information about my needs
but here I am interested in I T security

7
00:00:33,649 --> 00:00:39,379
yes it's a very long time to study
computer science at the University of an

8
00:00:39,379 --> 00:00:44,718
since 2007 I work as a Nazi Security
Council for us

9
00:00:44,719 --> 00:00:53,120
Mallaig security company Germany called
sis the agenda of my talk is this first

10
00:00:53,120 --> 00:00:58,050
I want to interviews what extent for
protection software it actually is what

11
00:00:58,050 --> 00:01:03,828
its role in ninety security and I want
to talk about the two less regard it's

12
00:01:03,829 --> 00:01:09,380
less regard to security issues that sell
my colleague and I am actually found

13
00:01:09,380 --> 00:01:15,100
again in the beginning of 2015 then I
want to talk about some use cases and a

14
00:01:15,100 --> 00:01:20,820
texan are you regarding these less
regarding security issues and how they

15
00:01:20,820 --> 00:01:28,740
may be exploited by now hope that I can
show you a life demo and afterwards

16
00:01:28,740 --> 00:01:33,000
there are some conclusions and
recommendations and I think there will

17
00:01:33,000 --> 00:01:42,070
be plenty of time for Q&A you so when I
talk about endpoint security software in

18
00:01:42,070 --> 00:01:48,539
this talk I think of something like this
can see you on this picture so and

19
00:01:48,540 --> 00:01:52,899
protection software is actually salt
about this running with higher

20
00:01:52,899 --> 00:01:58,840
privileges on that point systems what
i'm talking points I mainly mean

21
00:01:58,840 --> 00:02:01,130
alliances yeah

22
00:02:01,130 --> 00:02:07,429
computer networks or services the
purpose of this kind of softer actually

23
00:02:07,430 --> 00:02:12,610
is to prevent attacks running against
your and points that you have it your

24
00:02:12,610 --> 00:02:17,800
corporate network for example governor
network so generally speaking and

25
00:02:17,800 --> 00:02:24,440
protection software is just one type of
security control to protect I T systems

26
00:02:24,440 --> 00:02:29,560
as already mentioned for example client
services teams from different threats

27
00:02:29,560 --> 00:02:35,610
and the corresponding I T security risks
typical features are and protection

28
00:02:35,610 --> 00:02:40,819
software products are anti virus and
malware detection so the classic

29
00:02:40,819 --> 00:02:44,069
antivirus software it's running on line
services

30
00:02:44,069 --> 00:02:49,030
a table and one prediction software but
endpoint detection software nowadays

31
00:02:49,030 --> 00:02:52,950
also has many more features than we had
to borrow some hella detection there is

32
00:02:52,950 --> 00:02:58,768
for example application control so you
can do application whitelisting you find

33
00:02:58,769 --> 00:03:05,829
it only specific application software is
allowed to exit actually running on a

34
00:03:05,829 --> 00:03:12,060
specific client or server system you can
also do device control so for example

35
00:03:12,060 --> 00:03:18,840
you can control the use of devices on
popular example I use be mass storage

36
00:03:18,840 --> 00:03:24,859
device since I'm so that you cannot
simply sticking a USB flash drive copy

37
00:03:24,859 --> 00:03:27,980
all the cost of the hardest and
takeaways they'd excellent recent stuff

38
00:03:27,980 --> 00:03:30,359
like that or another popular

39
00:03:30,360 --> 00:03:39,670
issue is still file or so prices still
have a firewire a built-in

40
00:03:39,670 --> 00:03:46,339
extensive fire while he was by himself
or ExpressCard and there are still some

41
00:03:46,340 --> 00:03:53,710
text now you can use firewire rather
well and and publishing software also

42
00:03:53,710 --> 00:03:59,180
has filed all functionality built in
most of the products in order to protect

43
00:03:59,180 --> 00:04:04,250
your system from network based attacks
are to contain I'm going to take that

44
00:04:04,250 --> 00:04:08,070
just started on your client's system and
you want them elsewhere too

45
00:04:08,070 --> 00:04:13,019
contained on this system it's currently
running and freelance network

46
00:04:13,020 --> 00:04:17,640
communications system said it just
cannot spread that easily for example

47
00:04:19,738 --> 00:04:27,380
out what's my 12 years mainly about it
is password protection feature of some

48
00:04:27,380 --> 00:04:32,730
protection software products has
replaced protection is actually

49
00:04:32,730 --> 00:04:38,130
implemented soon set of restrictions on
different management functionalities are

50
00:04:38,130 --> 00:04:43,180
all features that are provided by an
protection software answer this

51
00:04:43,180 --> 00:04:47,610
protection is implemented in order to
reduce the risk of unauthorized Auton

52
00:04:47,610 --> 00:04:53,530
intended changes in the functioning of
the endpoint protection software so if

53
00:04:53,530 --> 00:04:59,010
you think a corporate network you don't
want I want everybody to change the file

54
00:04:59,010 --> 00:05:04,650
will release on that point or antivirus
updates or stuff like that and that's

55
00:05:04,650 --> 00:05:11,229
what's the best protection is actually
for and restricting administrative

56
00:05:11,229 --> 00:05:15,190
access generally is a good idea
especially when it comes to security

57
00:05:15,190 --> 00:05:22,020
because everybody can change anything on
a system well there is no security at

58
00:05:22,020 --> 00:05:26,260
all and in order to access and use
protected medicine functionalities

59
00:05:26,260 --> 00:05:32,900
protection software products usually
passport so what we have here in our

60
00:05:32,900 --> 00:05:36,219
paper based authentication is because
they are both symbols to him

61
00:05:36,220 --> 00:05:42,410
announce the most manufacturers of this
kind of stuff to do it this way and in

62
00:05:42,410 --> 00:05:47,810
this talk I will present their products
all three different gender as a ski

63
00:05:47,810 --> 00:05:56,140
pants on and we have found some security
issues and here's an example of

64
00:05:56,140 --> 00:06:02,550
Kaspersky Endpoint Security 10 and
protection and how you can change the

65
00:06:02,550 --> 00:06:06,430
settings and protect all operations are
selectively always some of the

66
00:06:06,430 --> 00:06:11,770
operations and this protection so
prevents as mentioned before unintended

67
00:06:11,770 --> 00:06:20,219
or unauthorized changes to the software
at all and I want to talk about to less

68
00:06:20,220 --> 00:06:26,370
regard to security issues so security
vulnerabilities I will present here are

69
00:06:26,370 --> 00:06:31,460
not big one so it's no remote code
execution from anywhere in the world but

70
00:06:31,460 --> 00:06:37,880
locally exploitable security issues and
that's why they unless we got it but in

71
00:06:37,880 --> 00:06:43,880
my opinion they shoot get more attention
because in some attack scenarios the

72
00:06:43,880 --> 00:06:48,060
exploit ability of these less guarded
security issues make a difference

73
00:06:48,060 --> 00:06:55,590
answer to security issues i want to talk
about our first authentication bypass

74
00:06:55,590 --> 00:06:57,789
all abilities and seconds

75
00:06:57,790 --> 00:07:02,510
be insufficient protection of user
credentials and concerning

76
00:07:02,510 --> 00:07:05,510
authentication authentication bypass all
abilities

77
00:07:06,160 --> 00:07:11,760
especially talk about local attack
scenarios in non network software

78
00:07:11,760 --> 00:07:16,599
features for example the management of
locally installed software products like

79
00:07:16,600 --> 00:07:21,990
in this case for the protection software
but you can also think of local

80
00:07:21,990 --> 00:07:27,400
exploitable education by possible
penalties in other products every

81
00:07:27,400 --> 00:07:37,370
application that has won a public sample
our passwords saved by God to

82
00:07:37,370 --> 00:07:42,290
synchronize database locally and if they
if there are any issues concerning the

83
00:07:42,290 --> 00:07:50,170
authentication yeah actually is a
critical security issue and the seconds

84
00:07:50,170 --> 00:07:57,020
to talk about is insufficient protection
of human potential and there are

85
00:07:57,020 --> 00:08:03,609
actually many ways in sufficiently
protect user credentials software for

86
00:08:03,610 --> 00:08:07,700
example store in that case clear text
passwords that's not recommended for

87
00:08:07,700 --> 00:08:12,539
obvious reasons or you can use
cryptographically week one-way hash

88
00:08:12,540 --> 00:08:16,830
functions with all the salt because this
also helps in a terrorism attack

89
00:08:16,830 --> 00:08:23,099
scenarios to profit from exploitable
condition or the use of symmetric

90
00:08:23,100 --> 00:08:29,090
cryptographic Cyprus with a single hard
coded key for all installations so if

91
00:08:29,090 --> 00:08:38,750
the manufacturer has only one from
Target Field implemented or one of its

92
00:08:38,750 --> 00:08:46,730
products and an attacker has to do the
work one time and he can exploit these

93
00:08:46,730 --> 00:08:51,710
securities you every time he sees it and
once there is a tool available on the

94
00:08:51,710 --> 00:08:57,910
Internet has to have the capabilities to
do that Elias by myself he just uses

95
00:08:58,910 --> 00:09:04,100
available software and exploit it and
another common issue concerning its

96
00:09:04,100 --> 00:09:11,490
surface protection of our information
this means that so I T system for

97
00:09:11,490 --> 00:09:16,470
example client system everybody who has
access to this system is able to reach

98
00:09:16,470 --> 00:09:20,980
the peso information no matter if it's
clear text or its encrypted or up the

99
00:09:20,980 --> 00:09:26,620
skaters in a way but it's also six
security issue

100
00:09:26,620 --> 00:09:32,110
ok so now some details about the
authentication bypass vulnerability in

101
00:09:32,110 --> 00:09:39,630
this talk by possibility allow us an
attacker Texas and use functionality of

102
00:09:39,630 --> 00:09:44,470
the system without completing of aquatic
vegetation step in the attended way of

103
00:09:44,470 --> 00:09:51,340
the X Factor so concerning has been
based authentication mechanisms being

104
00:09:51,340 --> 00:09:56,270
able to use and password for example
there are no password at all in order to

105
00:09:56,270 --> 00:10:01,520
look into a system is a classic example
of this volatility type and there are

106
00:10:01,520 --> 00:10:05,829
you from the root causes for this
vulnerability time for instance in

107
00:10:05,830 --> 00:10:10,450
proper input validation so for
subsequent injection vulnerabilities or

108
00:10:10,450 --> 00:10:15,790
more general do while they sing all
secure and design principles and four

109
00:10:15,790 --> 00:10:25,500
letter example hear ya on this light
there's security problem we have found

110
00:10:25,500 --> 00:10:28,570
in different employee protection
software products but it's also in many

111
00:10:28,570 --> 00:10:31,850
other products actually an exploitable

112
00:10:31,850 --> 00:10:38,000
local access to a low platelets to the
left so I will explain the scenario

113
00:10:38,000 --> 00:10:44,370
humans on slide yeah we have actually
two processes one on the left your name

114
00:10:44,370 --> 00:10:48,760
product service running with high user
privileges I feel it's the main above

115
00:10:48,760 --> 00:10:53,880
call it and on the riots you have a low
privileged user process your cold

116
00:10:53,880 --> 00:10:56,300
throughout you I am so it's

117
00:10:56,300 --> 00:11:02,349
user interfaces user and this process is
running in a low privileged to train

118
00:11:02,350 --> 00:11:10,880
with religious so what the service does
is it performs task with high privileges

119
00:11:10,880 --> 00:11:14,800
for example change the configuration of
the product label features of the

120
00:11:14,800 --> 00:11:19,770
product or disabled features of the
product and Waterloo privileged process

121
00:11:19,770 --> 00:11:24,510
does is it so its status information to
the end user it handles either direction

122
00:11:24,510 --> 00:11:29,600
for us all to you I stuff and in some
cases

123
00:11:29,600 --> 00:11:35,420
pieces it also danced user
authentication and yeah well that's an

124
00:11:35,420 --> 00:11:41,900
obvious mom that's a sickness and
security problem you can exploit in many

125
00:11:41,900 --> 00:11:51,630
scenarios and that's actually while they
secure design principles of stuff like

126
00:11:51,630 --> 00:11:58,720
that in local privileged domain that's
just does not belong there so if

127
00:11:58,720 --> 00:12:04,870
authentication is done within a process
that runs or can be running a contest of

128
00:12:04,870 --> 00:12:11,070
a little privileged user it can be and
Elias sounds in most cases also many

129
00:12:11,070 --> 00:12:21,280
police and in order to buy a house
education but only has to fire the

130
00:12:21,280 --> 00:12:22,170
corresponding

131
00:12:22,170 --> 00:12:27,410
authentication said they'd always
returns true for example by comparing

132
00:12:27,410 --> 00:12:32,350
the correct person with itself or just
by modifying the control flow of the

133
00:12:32,350 --> 00:12:36,930
actual program and the consequence of
this is dad's protected features can be

134
00:12:36,930 --> 00:12:41,500
used in the right way in case of the
airport protection software as we will

135
00:12:41,500 --> 00:12:50,769
see later so here's here's what it looks
like during runtime concerning the

136
00:12:50,769 --> 00:12:56,230
example given point security team yeah I
have closed about this so what's the

137
00:12:56,230 --> 00:12:59,430
interesting part and actually the
fallibility

138
00:12:59,430 --> 00:13:06,329
made in this scenario well I already
comparison is done within processes

139
00:13:06,329 --> 00:13:13,589
running the context of those privileged
user to process called in this case and

140
00:13:13,589 --> 00:13:20,870
as we can see here it's just to default
string on parity in that is used and

141
00:13:20,870 --> 00:13:25,720
what is actually compared to the case of
Kaspersky Kaspersky products are tested

142
00:13:25,720 --> 00:13:32,110
he also to be fired has values actually
drawn sword Mb 5 has values in this case

143
00:13:32,110 --> 00:13:43,170
and products the only five film
generated for a string but was UTF 16

144
00:13:43,170 --> 00:13:48,069
little endian encoded actually without
attorney so just some technical details

145
00:13:48,070 --> 00:13:55,339
is important for example if someone
wants to check the complexity of the

146
00:13:55,339 --> 00:13:57,089
password 01 sassy

147
00:13:57,089 --> 00:14:01,339
continues in this scenario for example
for protecting the medicine

148
00:14:01,339 --> 00:14:07,010
functionality is in compliance with the
corporates as for policy at least that's

149
00:14:07,010 --> 00:14:17,370
something I actually finding products
and the next one ability that's also

150
00:14:17,889 --> 00:14:21,769
regarding an underestimate it is the
insufficient protection of using

151
00:14:21,769 --> 00:14:26,439
credentials and this can also be
exploited in different ways and one

152
00:14:26,439 --> 00:14:32,368
example was actually using md5 hash
values unsalted so if a user has access

153
00:14:32,369 --> 00:14:38,480
to information that are not required to
perform his task it is used as security

154
00:14:38,480 --> 00:14:43,540
issue because the principle of least
privilege and furthermore gift

155
00:14:43,540 --> 00:14:48,660
accessible user credentials only
protected insufficient it's definitely

156
00:14:48,660 --> 00:14:55,040
is a security issue because then the
user or attack Iran malware actually

157
00:14:55,040 --> 00:15:02,389
benefit from the axis and recover
password information for example or you

158
00:15:02,389 --> 00:15:07,399
passed a Haltech so whatever is suitable
in different scenarios and in case of

159
00:15:07,399 --> 00:15:13,119
the test them protection software
products I will talk about here for

160
00:15:13,119 --> 00:15:18,189
information both both accessible by low
prevalence do this and it was also

161
00:15:18,189 --> 00:15:23,379
insufficiently protected announce the
consequences of this is that protected

162
00:15:23,379 --> 00:15:32,290
features can be used in unauthorized way
and example elf enterprise security tend

163
00:15:32,290 --> 00:15:36,868
to fall to test it

164
00:15:36,869 --> 00:15:42,579
compression products in this case the
password was stored as well on solid 25

165
00:15:42,579 --> 00:15:48,729
has value and you can see the actual
registry well you're worried about the

166
00:15:48,730 --> 00:15:53,220
registry key is by default readable by
every user so you don't have to have

167
00:15:53,220 --> 00:15:58,669
them instead of fries or something like
that so everybody just can't look at the

168
00:15:58,669 --> 00:16:06,529
registry if he's able to record their
tour that extra expect this information

169
00:16:06,529 --> 00:16:10,889
performing offline attack at home or
using a tracking cluster

170
00:16:10,889 --> 00:16:17,350
is a stolen car if he's able to crack
the password he can also attack the peso

171
00:16:17,350 --> 00:16:21,199
peso thanks Jason and managed by
protection so that all the teachers in

172
00:16:21,199 --> 00:16:28,368
unauthorized way but that's the hard way
to do it's even more easier in a few

173
00:16:28,369 --> 00:16:37,129
minutes but you can also be extracted as
low privileged user from the memory of

174
00:16:37,129 --> 00:16:38,679
the process

175
00:16:38,679 --> 00:16:43,540
ATP during runtime so there's a
possibility to perform the so-called

176
00:16:43,540 --> 00:16:49,160
offline attack but just extracted
formation take it home or even someone

177
00:16:49,160 --> 00:16:55,669
else put in the clouds to sign up
historic guessing attacks you can also

178
00:16:55,669 --> 00:17:02,109
extract information directly from the
memory in this case from still has to

179
00:17:02,109 --> 00:17:08,029
have a secondary attack's but we'll see
later on that sometimes you will get

180
00:17:08,029 --> 00:17:13,689
information that you can directly use
for further test scenarios and general

181
00:17:13,689 --> 00:17:17,559
use of cryptographic one-way hash
functions that are cryptographically we

182
00:17:17,559 --> 00:17:22,879
like amplifier actually what he's
without assault allows an attacker to

183
00:17:22,880 --> 00:17:26,959
perform rather fish and password
guessing attacks using precomputed

184
00:17:26,959 --> 00:17:34,210
attorneys for supplemental tables 25 can
also be calculated rather fast on modern

185
00:17:34,210 --> 00:17:43,279
CPUs and GPUs so using md5 today is not
recommended for example a screenshot

186
00:17:43,279 --> 00:17:54,059
from the registry editor for this case
and was told there is just 95 has value

187
00:17:54,059 --> 00:17:58,590
unsalted you can give you were they
would cracking tools on the river has

188
00:17:58,590 --> 00:18:00,639
cats or whatever you like

189
00:18:00,639 --> 00:18:09,340
ok so what are they actually use cases
and the texting oreos let's be guarded

190
00:18:09,340 --> 00:18:14,559
security issues when I came up with
actually to the first of these cases bad

191
00:18:14,559 --> 00:18:15,480
guys doing

192
00:18:15,480 --> 00:18:19,960
at things for fun and profit and the
next one is good guys doing bad things

193
00:18:19,960 --> 00:18:26,370
with permission for fun and profit for
example sentences like security

194
00:18:26,370 --> 00:18:33,250
consultants in both cases bad things are
done actually you want to avoid bad

195
00:18:33,250 --> 00:18:37,090
things when it comes to your corporate
network two systems you're responsible

196
00:18:37,090 --> 00:18:44,830
for so yeah if these vulnerabilities
will let us in the future but actually

197
00:18:44,830 --> 00:18:50,679
they seemed to prevail and we find that
actually once in a whiles every every

198
00:18:50,680 --> 00:18:56,030
two or three years the same thing just
in a different products and what are the

199
00:18:56,030 --> 00:19:03,180
attack scenarios one is that's a little
prove it disables features of the iPod

200
00:19:03,180 --> 00:19:08,480
protection software just not perform
Melissa sections so something of an

201
00:19:08,480 --> 00:19:15,280
insider attack you have some body and
your company with regular exercise too I

202
00:19:15,280 --> 00:19:19,790
T systems that he says to me is handling
matters centers and protection software

203
00:19:19,790 --> 00:19:21,850
in place to acquire it

204
00:19:21,850 --> 00:19:27,240
different kinds of threats and detector
is able to simply disable you were

205
00:19:27,240 --> 00:19:32,390
employed protection software in with a
mouse click and then kept reform is

206
00:19:32,390 --> 00:19:40,940
malicious actions and you don't see
anything if everything goes the worst

207
00:19:40,940 --> 00:19:43,940
way and tell second scenario is

208
00:19:44,490 --> 00:19:48,559
you don't have a user about you have
mail well that is executed in the

209
00:19:48,559 --> 00:19:53,928
context of a local issues within your
corporate network and he had his noble

210
00:19:53,929 --> 00:19:58,980
attempt to actually the same as an
interactive user clicking the mouse or

211
00:19:58,980 --> 00:20:04,240
typing some keys on a keyboard and then
we can actually also just deactivate you

212
00:20:04,240 --> 00:20:07,890
want protection software not authorize
the matter and that perform for the

213
00:20:07,890 --> 00:20:13,150
malicious task without any intervention
from the security code controlled

214
00:20:13,150 --> 00:20:20,780
protection software and he wasn't a real
example from my day-to-day work as pen

215
00:20:20,780 --> 00:20:26,870
tester Security Essentials and
protection software can be really

216
00:20:26,870 --> 00:20:32,399
annoying for me and my colleagues and
sometimes it can also be a show-stopper

217
00:20:32,400 --> 00:20:40,870
because if we are able to gather
credentials by other means and we are

218
00:20:40,870 --> 00:20:50,370
able to exorcist it is just not enough
when launching attacks and state some

219
00:20:50,370 --> 00:20:57,489
point because two successful login is
not a guarantee that you can also

220
00:20:57,490 --> 00:20:58,910
extracts

221
00:20:58,910 --> 00:21:07,030
filtrate interesting information by
using interesting tools so the profit

222
00:21:07,030 --> 00:21:13,899
for an attacker also a pen tester is
rather limited so sometimes I just

223
00:21:13,900 --> 00:21:18,960
cannot take the next step or take the
next hop network because I want

224
00:21:18,960 --> 00:21:24,020
protection stopping me and that's what
it's for Italy that's a good thing but

225
00:21:24,020 --> 00:21:31,540
because of these left we got its
security issues or an attacker is able

226
00:21:31,540 --> 00:21:34,670
to just deactivate protection software
features

227
00:21:35,270 --> 00:21:41,940
rather simply about conflict continued
with his malicious toss and of course

228
00:21:41,940 --> 00:21:48,010
there's also anti virus isolation
techniques but I was a virgin Ricky

229
00:21:48,010 --> 00:21:54,390
time-consuming and I think they have the
expertise in security just completely

230
00:21:54,390 --> 00:22:01,990
are selectively as I want can save
precious time so concerning the password

231
00:22:01,990 --> 00:22:06,820
protection management functionality it
is also interesting to see as only

232
00:22:06,820 --> 00:22:12,950
mention if they use passports are
compliance to even pass boat policies

233
00:22:12,950 --> 00:22:22,440
for example company I just keep his
assessment for it out one hopes to a

234
00:22:22,440 --> 00:22:26,030
result is that in most cases to use
passports to protect these

235
00:22:26,030 --> 00:22:31,330
administrative management features I
don't comply with other active password

236
00:22:31,330 --> 00:22:36,389
policies for example a director in the
Windows Active Directory environment so

237
00:22:36,390 --> 00:22:42,430
actually the peasants used to protect
administrative features are much much

238
00:22:42,430 --> 00:22:48,730
weaker than the default passwords that
are required by every corporate network

239
00:22:48,730 --> 00:22:54,100
and that's i think is rather interesting
and absolutely everything I mean like

240
00:22:54,100 --> 00:23:02,550
Alex ok and this table you can see there
are some of the effective protection

241
00:23:02,550 --> 00:23:08,200
software products my colleagues and I
have tested in the beginning of 2015

242
00:23:08,200 --> 00:23:13,940
these are examples we have

243
00:23:14,640 --> 00:23:21,970
vis-a-vis for but this list is nothing
but complete so they're also products

244
00:23:21,970 --> 00:23:26,160
other when their state health the same
unless we got his security issues at the

245
00:23:26,160 --> 00:23:28,820
door just exploded in the same way

246
00:23:28,820 --> 00:23:36,909
ok and what we have actually done is we
have written some proof of concept works

247
00:23:36,910 --> 00:23:41,990
for all of the facts other products such
as shown in the table was born I just

248
00:23:41,990 --> 00:23:44,570
want to demonstrate the security issue
alive

249
00:23:44,570 --> 00:23:51,460
hopefully with example office to
prosecute GMT we have written to load

250
00:23:51,460 --> 00:23:57,860
and unload cast and get these proven
scorer software constitute proof of

251
00:23:57,860 --> 00:24:02,409
concept hospital is simply a loader
technically with some patching

252
00:24:02,410 --> 00:24:04,620
functionality and it works as follows

253
00:24:04,620 --> 00:24:13,620
following these steps at first it finds
the executable file called EVP that it

254
00:24:13,620 --> 00:24:17,419
just creates a new instance of the
process is a key with a specific command

255
00:24:17,420 --> 00:24:22,620
line arguments show with the exit
function that is triggered and the exit

256
00:24:22,620 --> 00:24:29,290
exit functions just shuts down the
Endpoint Protection completely the next

257
00:24:29,290 --> 00:24:33,879
step is to pitch the password based
authentication of the process so that

258
00:24:33,880 --> 00:24:38,060
any password is considered correct or
actually that's no password is required

259
00:24:38,060 --> 00:24:44,879
in order to treat this functionality and
the loss of his to stop the process and

260
00:24:44,880 --> 00:24:52,760
continue its execution not only so this
line at the next load I have shown the

261
00:24:52,760 --> 00:24:57,639
most important parts of the source code
of the proof of concept celtic symbol

262
00:24:57,639 --> 00:25:06,079
and at what they see source code else's
just before steps I just mentioned or so

263
00:25:06,079 --> 00:25:13,559
finds the executable file them on this
proof-of-concept altitudes implemented

264
00:25:13,559 --> 00:25:18,509
as a loser level the banner issue on top
of that way so we make use of the

265
00:25:18,509 --> 00:25:19,349
windows

266
00:25:19,349 --> 00:25:25,039
AP functionality or to patch their
target prices during runtime and do what

267
00:25:25,039 --> 00:25:34,269
they want because there's a few bands
that's a simple thing to do if it is

268
00:25:34,269 --> 00:25:40,700
possible to close to handle to process
and lets the process continue its work

269
00:25:40,700 --> 00:25:45,499
ok so now I will try to show a lifetime

270
00:26:02,210 --> 00:26:18,390
what I want to exploit that's a command
line

271
00:27:09,720 --> 00:27:53,570
always started operations when I
honestly have a look at all the other

272
00:27:53,570 --> 00:28:11,570
features also maybe I will just show
heart you can deactivate or disabled

273
00:28:11,570 --> 00:28:18,740
protection completely in this case ok so
as you can see I'm running Endpoint

274
00:28:18,740 --> 00:28:33,570
Security 10 this case Windows seven so I
can and we can also have a look at my

275
00:28:33,570 --> 00:28:40,399
privileges so it's a German also helps
the user I'm currently locked in an ass

276
00:28:40,400 --> 00:28:46,520
is only the default limited windows
using a member of the group

277
00:28:46,520 --> 00:28:52,990
have a look at the Windows services
rallying there should be something from

278
00:28:52,990 --> 00:29:00,380
Kaspersky Endpoint Security Service is
running so that's running with high

279
00:29:00,380 --> 00:29:05,580
privileges in a high privilege to me for
example the GUI we have here is lower

280
00:29:05,580 --> 00:29:20,240
running in the context of my user also
if I run the ATP executable here this is

281
00:29:20,240 --> 00:29:33,170
also running in the context of Milo
privileged user so concepts offer to

282
00:29:33,170 --> 00:29:43,030
actually come online now to unload cast
in this example we see here is still

283
00:29:43,030 --> 00:29:51,020
running five percenter some windows are
popping up here after all put off our to

284
00:29:51,020 --> 00:30:02,980
look here is gone at least a GUI and if
we have a look at the start and services

285
00:30:02,980 --> 00:30:07,640
it shall be any ski service anymore

286
00:30:18,260 --> 00:30:23,200
ok

287
00:30:25,530 --> 00:30:31,560
anymore

288
00:30:43,570 --> 00:31:28,250
containing what appeared he was just a
simple horse containing a payload that

289
00:31:28,250 --> 00:31:32,120
automatically deactivates the endpoint
protection software and has to grow its

290
00:31:32,120 --> 00:31:38,030
star's editorial code does not start
automatically because my system uses

291
00:31:38,030 --> 00:31:44,389
default settings concerning Micro
security for Microsoft Office and I have

292
00:31:44,390 --> 00:31:50,250
to activate it really gets you nowhere
Security Essentials when we do targeted

293
00:31:50,250 --> 00:31:55,030
attacks we also found that users if they
are presented with the correct or an

294
00:31:55,030 --> 00:32:00,649
interesting option and they are rather
willing to activate active content

295
00:32:00,650 --> 00:32:09,510
contained in the document and then
actually better things may happen so

296
00:32:09,510 --> 00:32:20,170
yeah that's just ask he is gone again we
should have some messages from here that

297
00:32:20,170 --> 00:32:24,800
we should reactivate Kaspersky Endpoint
Security is still some windows messages

298
00:32:24,800 --> 00:32:31,030
and what I programs here is just a proof
of concept about you on so that just as

299
00:32:31,030 --> 00:32:34,540
dead if you can read this message
message it's already too late because at

300
00:32:34,540 --> 00:32:41,460
this point lol well actually has every
code execution will the privileges after

301
00:32:41,460 --> 00:32:48,630
currently locked in use her ok so this
was just a quick demo concerning

302
00:32:48,630 --> 00:32:57,160
products and have to say my back up here
in the slides so just a

303
00:32:57,160 --> 00:33:00,750
password-protected features actually if
you want to use the command line

304
00:33:00,750 --> 00:33:11,290
interface you can set the password also
welcome online or you are interactively

305
00:33:11,290 --> 00:33:17,490
prompted but when I did the concept of
the tool is I just changed the control

306
00:33:17,490 --> 00:33:21,270
flow in such a way that we never people
reach this pass for prom and it's just

307
00:33:21,270 --> 00:33:27,830
txt waits for example protection using
text function or scared or whatever you

308
00:33:27,830 --> 00:33:31,810
want you not authorized way ok and this
was just the output of the proof of

309
00:33:31,810 --> 00:33:36,970
concepts offer to all following the four
steps I mentioned all year and at the

310
00:33:36,970 --> 00:33:40,390
same is also true for other products for
example

311
00:33:41,140 --> 00:33:45,560
the manufacturer rose in the same way
but he was interesting difference

312
00:33:45,560 --> 00:33:50,020
because concerning the pun us all their
products we've tested we were able to

313
00:33:50,020 --> 00:33:57,190
also extracts the correct password is
actually asking for from the memory so

314
00:33:57,190 --> 00:34:04,400
here they don't even use has incredibly
one-way has to protect credentials are

315
00:34:04,400 --> 00:34:10,600
intended to protect administrative
management features but they just made

316
00:34:10,600 --> 00:34:17,080
available in a low privileged user
context in clear text and the same is

317
00:34:17,080 --> 00:34:23,199
also true for the Bulldogs products
we've tested you can also just catch the

318
00:34:23,199 --> 00:34:27,830
past based authentication as a liberal
she was arrested elsewhere and by

319
00:34:27,830 --> 00:34:34,100
positing that way and you can also
extract the correct password please text

320
00:34:34,100 --> 00:34:40,540
so yeah but with less regard to
securities mentioned earlier

321
00:34:41,480 --> 00:34:45,860
science authentication bypass on the
other side insufficiently protected

322
00:34:45,860 --> 00:34:52,909
credentials could be found in these
employ protection software products can

323
00:34:52,909 --> 00:34:58,410
actually be used to deactivate security
features in unauthorized manner

324
00:34:58,410 --> 00:35:15,230
ok sort of conclusion is that this kind
of attack is actually possible it's

325
00:35:15,230 --> 00:35:26,430
actually a couple of model the products
we analyzed in this case it wasn't until

326
00:35:26,430 --> 00:35:32,819
2015 concerning had a look at other
products and I also know of someone

327
00:35:32,820 --> 00:35:35,950
products that are selectively affected
by these vulnerable

328
00:35:35,950 --> 00:35:41,649
he's cannot talk about our security
issues like authentication by

329
00:35:41,650 --> 00:35:48,440
possibilities concerning local attack
scenarios in my opinion also get more

330
00:35:48,440 --> 00:35:54,660
attention because in some attack
scenarios yeah they are a crucial step

331
00:35:54,660 --> 00:36:01,990
to cause more damage because if I'm able
to get rabate nine-point protection

332
00:36:01,990 --> 00:36:08,089
software and I was able to get along
information from some other source I can

333
00:36:08,089 --> 00:36:13,920
log into the system yet to rate all
protection features absolute some

334
00:36:13,920 --> 00:36:21,070
interesting hacking tools what's up baby
cuts some potentials in active

335
00:36:21,070 --> 00:36:27,690
directories and take over the lead
actors to Active Directory monuments for

336
00:36:27,690 --> 00:36:35,200
example okay and yeah another conclusion
is that any security-related toss shoots

337
00:36:35,200 --> 00:36:43,270
if possible performed more trustworthy
allotment so not so privileged user

338
00:36:43,270 --> 00:36:52,089
processes where actual mail there is
access to or malicious users have access

339
00:36:52,089 --> 00:36:58,680
to come back to this illustration here a
good idea is just to do he's

340
00:36:58,680 --> 00:37:06,029
authentication and other high privilege
or other sensitive to use it to me in

341
00:37:06,030 --> 00:37:06,740
this way

342
00:37:06,740 --> 00:37:14,279
ok here are some general recommendations
for people developing software like that

343
00:37:14,280 --> 00:37:19,089
or general terms speaking for all I T
security systems always consider

344
00:37:19,089 --> 00:37:22,430
trusting I see I T security because
oftentimes

345
00:37:23,609 --> 00:37:28,660
security is just so you have to know
your trust remains its Russ boundaries

346
00:37:28,660 --> 00:37:31,120
trust relationships

347
00:37:31,120 --> 00:37:38,540
and another recommendation is do not
assume too much because if you have too

348
00:37:38,540 --> 00:37:47,580
many assumptions about Jesus more excuse
me while in office software component in

349
00:37:47,580 --> 00:37:55,190
reality there are many are some steps
just don't hope through your product may

350
00:37:55,190 --> 00:38:00,430
be vulnerable to specific attacks and
another channel recommendation is

351
00:38:00,430 --> 00:38:03,049
properly protect your personal
information

352
00:38:03,050 --> 00:38:08,650
mainly restricted access to information
but there were clear text Hairston

353
00:38:08,650 --> 00:38:13,650
cryptic whatever Julie parties are
solely use cryptographically kids

354
00:38:13,650 --> 00:38:18,630
graphically secure standardized with
them with a suitable configuration so my

355
00:38:18,630 --> 00:38:22,600
recommendation here is the path of
peacekeeping operations function too

356
00:38:22,600 --> 00:38:29,060
well up to date one way has to do with
them

357
00:38:29,060 --> 00:38:34,460
many rounds that just makes it very hard
for an attacker who has access to has to

358
00:38:34,460 --> 00:38:39,280
pay as much information to be covered
through text passwords and that's also

359
00:38:39,280 --> 00:38:43,860
good idea in general to follow the
principle of least privilege I know it's

360
00:38:43,860 --> 00:38:46,860
hard sometimes but I think it's worth
the effort

361
00:38:47,380 --> 00:38:54,060
ok here's some references to first as a
people from 2012 is just about the same

362
00:38:54,060 --> 00:39:00,390
topic back then I have the same kind of
all abilities plus we gotta bilities

363
00:39:00,390 --> 00:39:10,670
office gas micro so also rather easily
deactivate Google without any further

364
00:39:10,670 --> 00:39:14,180
privileges in unauthorized way and there
are some security advisories were

365
00:39:14,180 --> 00:39:19,350
released this year are concerned the
software products protection software

366
00:39:19,350 --> 00:39:26,089
products from the manufacturer this
regard to security and Kaspersky ok and

367
00:39:26,090 --> 00:39:30,100
that's it thank you very much for your
tensions and I think we're still have

368
00:39:30,100 --> 00:39:31,500
some time for Q&A

369
00:39:31,500 --> 00:40:36,110
some time for questions sometimes
overlooked but you can design principle

370
00:40:36,110 --> 00:40:40,080
or violation of securities I'm
principles actually rather many software

371
00:40:40,080 --> 00:40:42,799
products

372
00:40:42,800 --> 00:41:02,060
say they don't feel nothing I could talk
about the best of their products that do

373
00:41:02,060 --> 00:41:06,540
it the correct way where you are for
example have to wake of privilege as a

374
00:41:06,540 --> 00:41:09,020
Windows user

375
00:41:09,020 --> 00:41:15,170
that's one other way to do it correctly
but I just can't imagine the products

376
00:41:15,900 --> 00:41:26,540
questions questions sorry

377
00:41:32,339 --> 00:41:56,538
did you experience talking to locally
managed the research we did order

378
00:41:56,539 --> 00:42:00,930
security assessments actually we just
had a look at the local authentication

379
00:42:00,930 --> 00:42:06,479
features but you're right there also
will be managed and protection software

380
00:42:06,479 --> 00:42:11,368
products that you will not indication on
suicide for example but we don't have a

381
00:42:11,369 --> 00:42:25,229
look at these answers to know why I'm
asking is are there any alerts if you on

382
00:42:25,229 --> 00:42:32,399
the server side of the local sometimes
there are but then it's a matter of how

383
00:42:32,400 --> 00:42:37,999
people are reacting to these kinds of
alarms and actually the case of malware

384
00:42:37,999 --> 00:42:44,149
if you just temporarily disable security
control do you think actually tried to

385
00:42:44,150 --> 00:42:49,499
data dilemma astronauts you just don't
care if you had a text was rated the

386
00:42:49,499 --> 00:42:56,828
damage is done thanks

387
00:42:56,829 --> 00:43:09,299
the questions one person from me I think
companies like has been as key should

388
00:43:09,299 --> 00:43:12,299
know better so the question remains

389
00:43:12,960 --> 00:43:17,040
yes there is a saying you shouldn't
attribute to malice what can readily be

390
00:43:17,040 --> 00:43:22,420
explained by stupidity but they should
know better what your explanation

391
00:43:22,420 --> 00:43:31,680
actually I don't know its security costs
money I don't think that's the main

392
00:43:31,680 --> 00:43:36,980
exploration and for me that we just see
the same security vulnerabilities over

393
00:43:36,980 --> 00:43:42,560
and over again because as a company like
a Kaspersky where you have installed

394
00:43:42,560 --> 00:43:58,450
software which is privileged on a high
percentage of the world's computers but

395
00:43:58,450 --> 00:44:05,060
conspiracy theories but but another
problem is as I mentioned in the story

396
00:44:05,060 --> 00:44:12,099
the security issues I presented here
they are regarded less less regard for a

397
00:44:12,099 --> 00:44:17,170
reason because i text areas are rather
limited and just be a ski area followed

398
00:44:17,170 --> 00:44:24,990
in use they also have other security
issues they should 6446 these issues

399
00:44:24,990 --> 00:44:29,930
we've reported issues in February this
year I think of March and they were

400
00:44:29,930 --> 00:44:34,960
fixed to her but they also have other
security issues the big one smoker

401
00:44:34,960 --> 00:44:42,619
execution reported in the last couple of
weeks but I don't I don't have an

402
00:44:42,619 --> 00:44:46,119
explanation why the software quality
actually concerning security features is

403
00:44:46,119 --> 00:44:58,540
rather go especially from security
companies may be further discussion and

404
00:44:58,540 --> 00:44:59,599
thank you for the top

