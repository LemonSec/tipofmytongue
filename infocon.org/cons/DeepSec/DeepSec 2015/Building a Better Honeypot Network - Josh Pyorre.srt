1
00:00:00,000 --> 00:00:08,220
hello so I am just curious I am a
security researcher at OpenDNS has now

2
00:00:08,220 --> 00:00:14,190
purchased by Cisco so I guess I work
there too and I used to be a threat

3
00:00:14,190 --> 00:00:18,448
analyst at nasa about five years where i
hope i helped to build a security

4
00:00:18,449 --> 00:00:23,300
operation center and then initially as
an analyst at the moved into a role or I

5
00:00:23,300 --> 00:00:29,580
was returned to predict threats to the
eighth in the agency it was a threat

6
00:00:29,580 --> 00:00:34,769
analyst at man you don't talk to your
office now so let me go back to menu for

7
00:00:34,770 --> 00:00:42,390
almost a year so I'm going to be talking
about some any part in helping organize

8
00:00:42,390 --> 00:00:46,410
them to get some actionable information
from them I only have a few honey pots

9
00:00:46,410 --> 00:00:51,179
that I'm working with 44 the moment and
there are more having but the one stop

10
00:00:51,180 --> 00:00:57,879
talking about it as a stage one and a
malware honey pot and one involving gas

11
00:00:57,879 --> 00:01:06,060
tanks which sprinkle and scared honey
parts so the SSH one is actually using

12
00:01:06,060 --> 00:01:11,070
this one called calorie which is a fork
of hippocampus and interaction honey pot

13
00:01:11,070 --> 00:01:15,758
where people attackers can correct in
thinking they're associating into a UNIX

14
00:01:15,759 --> 00:01:19,770
or Linux system keeper has some
limitations that didn't like such as

15
00:01:19,770 --> 00:01:27,070
only two user accounts are and password
combinations are allowed and to add more

16
00:01:27,070 --> 00:01:32,250
more user accounts you have to watch
your off logs and then get all those

17
00:01:32,250 --> 00:01:37,380
user passwords and add those as users to
compose also some other limitations I

18
00:01:37,380 --> 00:01:42,520
don't like so the person who will carry
did a good job of fixing some of the

19
00:01:42,520 --> 00:01:48,630
limitations of h2 log files which is a
difference when kept 001 of

20
00:01:48,630 --> 00:01:53,320
which is a JSON the file which is great
for importing into certain databases and

21
00:01:53,320 --> 00:01:56,258
also a lot of clout they both have
slightly different information which I

22
00:01:56,259 --> 00:02:04,469
make you self and my network that a
building great session files this isn't

23
00:02:04,469 --> 00:02:09,780
new this is what kept it does as well as
beads on it basically record as the

24
00:02:09,780 --> 00:02:13,959
everything that a person who is aged
into the system

25
00:02:13,959 --> 00:02:18,030
record everything that a date and you
can replace those files back using a

26
00:02:18,030 --> 00:02:24,549
Python script that's included system
administrative stuff I said iptables

27
00:02:24,549 --> 00:02:32,390
rule to send port 22 traffic Kerry and I
do my admin account to a different port

28
00:02:32,390 --> 00:02:38,809
people seem to like 2222 I just chose
the next one up for some reason this is

29
00:02:38,810 --> 00:02:43,610
if this is just a few of what it looks
like when you run that play a log python

30
00:02:43,610 --> 00:02:47,940
script that will replay a session you
discussed what's

31
00:02:48,920 --> 00:02:52,298
attacker is doing it in this case they
have logged in and doing a double you

32
00:02:52,299 --> 00:02:57,700
get to this IP address this file called
Lynn under and they're downloading it

33
00:02:57,700 --> 00:03:02,358
you can make certain commands available
to the attacker or you can put fake

34
00:03:02,359 --> 00:03:08,660
commands and there this is it's cool to
have this but it does not totally useful

35
00:03:08,660 --> 00:03:12,319
especially if you have hundreds of
tacker attackers agency here they're

36
00:03:12,319 --> 00:03:16,679
trying to run the command and in the
changing the permissions on the file and

37
00:03:16,680 --> 00:03:18,100
then they try to run it again

38
00:03:18,100 --> 00:03:23,370
are not able to cuz it's a sandbox
environment but there's this can take a

39
00:03:23,370 --> 00:03:27,540
while to get intelligence from that if
you want that IP address information

40
00:03:27,540 --> 00:03:31,519
you've got a copy and paste into Word of
your threatened held out for more

41
00:03:31,519 --> 00:03:37,970
research platform is it can take a lot
of work so diana is another

42
00:03:37,970 --> 00:03:45,320
bottom using it it's meant to capture
hours what to get the copy of the power

43
00:03:45,320 --> 00:03:48,980
on the system so that you can analyze it
it rights to see Twilight database as

44
00:03:48,980 --> 00:03:54,280
opposed to text files like the last
honey pot this is just a little viewer

45
00:03:54,280 --> 00:03:57,860
you know you can see there are a lot of
options so this is still in progress I'm

46
00:03:57,860 --> 00:04:02,450
actually working on getting the data I
want out of diana in a way that I want

47
00:04:02,450 --> 00:04:06,570
it so that it could be useful and
actions upon but you can see those a lot

48
00:04:06,570 --> 00:04:14,989
of a lot of stuff to work with its power
into a folder so you can just grab that

49
00:04:14,990 --> 00:04:19,470
now where it's a nice unless you have a
hundred honey pots or thousand honey

50
00:04:19,470 --> 00:04:25,320
pots little bit more difficult which I
address you must be talking about using

51
00:04:25,320 --> 00:04:29,050
comp that's one of the ones I'm using
which is a state honey pollinate

52
00:04:29,050 --> 00:04:35,280
imitates industrial control systems best
not to install this on may be the same

53
00:04:35,280 --> 00:04:39,750
server as your SSH key part because it's
supposed to be a hardware device of some

54
00:04:39,750 --> 00:04:46,010
sort of talk more about that soon and
then I'm using a spot which this article

55
00:04:46,010 --> 00:04:50,180
by trying but this paper by Trend Micro
is pretty interesting but it's about

56
00:04:50,180 --> 00:04:57,100
sensors inside gas tanks that are used
to report the temperature so you can

57
00:04:57,100 --> 00:05:03,990
connect in and issue a very small subset
of commands to maybe bullet think that

58
00:05:03,990 --> 00:05:07,529
it's too cool and their habit heat up or
something like that that's the idea

59
00:05:07,529 --> 00:05:14,039
at least this is a scan of one of my
body parts I'm using it a lot of ports

60
00:05:14,039 --> 00:05:18,639
are open FTP it's just an optimistic
directed a cessation of course and a

61
00:05:18,639 --> 00:05:22,369
bunch of other ones that are available
for exploitation and they all have their

62
00:05:22,369 --> 00:05:27,899
own difference and boxes on them all
configured in the different ways that

63
00:05:27,899 --> 00:05:33,449
are configured and it's all kind of a
pain to some of the obstacles but I'm

64
00:05:33,449 --> 00:05:39,709
like I'm just mentioned installation is
is a pain they're all different they

65
00:05:39,709 --> 00:05:43,689
write a different kind of dog clothes
different places they're open source

66
00:05:43,689 --> 00:05:50,309
projects and the majority of cases so
you have to learn each one and how to

67
00:05:50,309 --> 00:05:54,119
work with these one you can get all your
information from just one honey pot and

68
00:05:54,119 --> 00:05:57,739
be done without that it's better to have
more for more context

69
00:05:58,419 --> 00:06:03,119
diana is pretty picky eaters like a
bunch of up to 12 for it doesn't like 64

70
00:06:03,119 --> 00:06:13,459
bit Ubuntu Linux so campaign so honey
pot networks this is this one here is

71
00:06:13,459 --> 00:06:18,329
one that's actually was influential I
saw this and I was like this is great

72
00:06:18,329 --> 00:06:24,239
and this was gonna do with a while I was
playing with this one and it's like i

73
00:06:24,239 --> 00:06:30,279
named Jason just trust at that stream
which is a company in the Bay Area

74
00:06:30,279 --> 00:06:34,929
California funny actually used to own
the demand for Xtreme dot com before

75
00:06:34,929 --> 00:06:42,119
they were company gave it up which is
done anyway it just shows you the main

76
00:06:42,119 --> 00:06:47,789
screen shows you a map which one is
probably familiar with and that little

77
00:06:47,789 --> 00:06:52,979
attack stats top-to-bottom but if you go
away from this page and come back it's

78
00:06:52,979 --> 00:06:58,549
not persistent little dot showing you
where the attacks came from go away and

79
00:06:58,549 --> 00:07:03,248
wait for new attacks to come in as other
features such as you can deploy a

80
00:07:03,249 --> 00:07:07,169
different kind of such as really easily
by clicking on the deploy option at the

81
00:07:07,169 --> 00:07:10,948
top and you can choose what you want
what kind of honey pot or do you wanna

82
00:07:10,949 --> 00:07:13,880
snort or a circle IDs

83
00:07:13,880 --> 00:07:17,770
and it gives us some stats and has been
improved upon so it's getting better and

84
00:07:17,770 --> 00:07:24,270
better but for example I stopped IP
address I could copied and pasted into

85
00:07:24,270 --> 00:07:28,000
whatever I used for research see why are
you so many attacks from there I could

86
00:07:28,000 --> 00:07:31,660
I'm not as not giving me it's giving me
a summary but it's not giving me

87
00:07:31,660 --> 00:07:35,750
actually intelligent information as of
yet but I want intelligent information I

88
00:07:35,750 --> 00:07:40,320
gotta use my my brain four-story use all
the analysts that are working with me

89
00:07:40,320 --> 00:07:48,190
they have not studied the most common
feature seems to be the purpose of honey

90
00:07:48,190 --> 00:07:53,280
pots which I actually find to be mostly
useless they look really fantastic but

91
00:07:53,280 --> 00:07:58,950
what do you do with it so there's a lot
of little dots coming from China or

92
00:07:58,950 --> 00:08:05,719
wherever this one's called though i più
if you have a check the site you can

93
00:08:05,720 --> 00:08:12,160
help you sounds as it shoots because I
was gonna set that up in Miami but I

94
00:08:12,160 --> 00:08:18,000
decided the time so we were more than
this we want to be like this guy like

95
00:08:18,000 --> 00:08:23,700
this is Brian Krebs he's a author and a
lot of bloggers in america

96
00:08:24,270 --> 00:08:28,530
hopefully public about it is often the
first response first place that people

97
00:08:28,530 --> 00:08:34,179
go for information because he's so close
to the data to the attacking information

98
00:08:34,179 --> 00:08:39,270
like he he focuses mainly on ATM
skimming and point of sale malware but

99
00:08:39,270 --> 00:08:46,829
he also did I i hopefully he learned
Russian infiltrator carding forums and

100
00:08:46,830 --> 00:08:52,790
disrupted them by by reporting on them
of course got death threats against 911

101
00:08:52,790 --> 00:08:56,650
calls to his house with SWAT team shows
up as practical jokes because of it but

102
00:08:56,650 --> 00:09:04,370
he's worked hard to get get close to the
source of information so that the rest

103
00:09:04,370 --> 00:09:08,940
of us in the Investec community can be
on top of things at least a little bit

104
00:09:08,940 --> 00:09:14,030
we're still a little bit behind though I
feel like this character I don't know

105
00:09:14,030 --> 00:09:22,430
this I had the show is called Mr robot
show actor plays a hacker it's it's one

106
00:09:22,430 --> 00:09:24,790
of the better versions of TV hacking
that i've seen

107
00:09:24,790 --> 00:09:25,020
but

108
00:09:25,020 --> 00:09:30,880
you know you wanna know what the hackers
thinking wanna be like what will it be

109
00:09:30,880 --> 00:09:35,340
like these guys we want to know what
they're thinking these these are wanted

110
00:09:35,340 --> 00:09:43,920
in the USA these people for state
sponsored attacks over 200 you know but

111
00:09:43,920 --> 00:09:48,560
we want to know what what is the going
out there what kind of things to the

112
00:09:48,560 --> 00:09:55,739
problems that we have a really work in
the past so deal with a lot of reports

113
00:09:55,740 --> 00:09:59,720
from the government at least I have
still do in my position but in previous

114
00:09:59,720 --> 00:10:04,340
position that would deal with open eyes
open

115
00:10:04,340 --> 00:10:09,150
reports and also more secret and depend
on clearance levels but it's all the

116
00:10:09,150 --> 00:10:14,689
same really same data different format
and the thing about it it's really

117
00:10:14,690 --> 00:10:21,200
annoying as I received reports like this
with Excel spreadsheets full of

118
00:10:21,200 --> 00:10:24,840
thousands of demands tens of thousands
of demands and it's like they are

119
00:10:24,840 --> 00:10:27,680
divided at all I've gone through them
and seeing the legitimate demands such

120
00:10:27,680 --> 00:10:32,479
as microsoft.com google.com it's almost
as if they are as capturing something on

121
00:10:32,480 --> 00:10:37,930
their sensors that they have in their
places and just link it delivering you a

122
00:10:37,930 --> 00:10:42,180
whole bunch of crap that you can't you
have to go back to yourself and your

123
00:10:42,180 --> 00:10:46,680
assuming these reports are designed so
that you don't have to have to work too

124
00:10:46,680 --> 00:10:52,430
hard but you do we also work with
reports this is a good report on the apt

125
00:10:52,430 --> 00:10:57,599
one but a video on this this report
that's what they're calling it was this

126
00:10:57,600 --> 00:11:05,110
report came out after was already you
know in systems doing things for quite a

127
00:11:05,110 --> 00:11:11,160
long time so it's old data but as a
threat analyst or someone who works in

128
00:11:11,160 --> 00:11:14,850
that kind of position using your reading
these reports in like oh I don't have

129
00:11:14,850 --> 00:11:18,100
all these domains block there I don't
have information on this domain so I'm

130
00:11:18,100 --> 00:11:24,110
gonna put them in my the single or
whatever it's really probably useless

131
00:11:24,110 --> 00:11:31,500
but that's what we have to work off of
another report just you know this was

132
00:11:31,500 --> 00:11:32,830
about

133
00:11:32,830 --> 00:11:38,730
as you see bob but it's late late when
you get it even if it's on the day that

134
00:11:38,730 --> 00:11:44,540
you get it is marking stuff a lot of
times I read through reports and this is

135
00:11:44,540 --> 00:11:47,660
really interesting I haven't heard about
this or this is a new take on this

136
00:11:47,660 --> 00:11:52,949
malware variant and that I get to the
end it's like install our product if you

137
00:11:52,950 --> 00:11:58,060
want to have it work for you know no
malware on your system and I'm just

138
00:11:58,060 --> 00:12:02,660
realized I wasted like an hour of my
life so there's other ways this other

139
00:12:02,660 --> 00:12:07,670
feeds you can do like this is just
google google search for a cure which is

140
00:12:07,670 --> 00:12:11,740
more entertaining than anything else you
get things like this which is a terrible

141
00:12:11,740 --> 00:12:19,730
show but it's whatever so I also have
this is just a screenshot of my RSS feed

142
00:12:19,730 --> 00:12:24,530
all this data is very useful apps though
some blogs I follow that are on point

143
00:12:24,530 --> 00:12:28,680
there like they know they have
information as it comes out but it's

144
00:12:28,680 --> 00:12:33,729
still too late in the case of most
agencies most organizations what we

145
00:12:33,730 --> 00:12:37,550
actually won just have actionable
intelligence and when I predict the

146
00:12:37,550 --> 00:12:41,209
future just a bit you know at least or
as much as you can you want to know

147
00:12:41,210 --> 00:12:44,760
what's gonna happen before it's gonna
happen based on events current events

148
00:12:44,760 --> 00:12:52,400
based on what kind of industry you
working this management issues with his

149
00:12:52,400 --> 00:12:56,900
honey pots pots by the way our way to
get closer to the attacker and get some

150
00:12:56,900 --> 00:13:01,560
actual actual intelligence that you can
use before it becomes a threat inside

151
00:13:01,560 --> 00:13:04,569
the environment

152
00:13:04,570 --> 00:13:08,660
the state is available in all your honey
pot so you have a thousand honey pots

153
00:13:08,660 --> 00:13:14,780
out there so that's great you got a lot
of stuff all over the world it's all

154
00:13:14,780 --> 00:13:20,730
your log files and all your databases
hours in there to get all that stuff but

155
00:13:20,730 --> 00:13:26,190
you can just go SCPs copied over from
these systems and then start analyzing

156
00:13:26,190 --> 00:13:31,250
it and then take precautions but that's
gonna take a long time and a lot of

157
00:13:31,250 --> 00:13:35,960
people doing a lot of things a lot of
research it's better to do this

158
00:13:35,960 --> 00:13:39,930
programmatically if you can so working

159
00:13:39,930 --> 00:13:44,649
to try to change the way that that works
the structure of the system and building

160
00:13:44,649 --> 00:13:49,080
like this my home server actually is in
Virginia right now that I have its own

161
00:13:49,080 --> 00:13:56,610
AWS I actually keep wiping it and doing
it so you'll see some changes as I'm

162
00:13:56,610 --> 00:14:03,190
moving forward this is the active work
in progress and when I get to the end

163
00:14:03,190 --> 00:14:07,100
you'll see that it's available to
everyone but I have a very sunny spots

164
00:14:07,100 --> 00:14:11,610
all over the world I divide them up at
Khambhat and gas particularly running

165
00:14:11,610 --> 00:14:14,690
separate from the SSH and Diana honey
pots

166
00:14:15,470 --> 00:14:19,870
glass top I haven't mentioned that one
yet but I'm using a bunch of other parts

167
00:14:19,870 --> 00:14:24,300
of exploring but you want to separate
them like on pot and got a spot should

168
00:14:24,300 --> 00:14:29,479
be on physical systems best tires that
causes cheap you could theoretically

169
00:14:29,480 --> 00:14:34,100
leave it places like hotels in the
secret place to stash it I wouldn't

170
00:14:34,100 --> 00:14:42,800
recommend that you can do whatever you
want within reason and recitation today

171
00:14:42,800 --> 00:14:48,270
I have those running in the Amazon Web
Services Web servers running on VP ESAs

172
00:14:48,270 --> 00:14:55,760
I've got one physical system at home
runs it but it's good to divide them up

173
00:14:55,760 --> 00:15:01,020
because someone connecting into comp is
going to be able to easily figure out

174
00:15:01,020 --> 00:15:10,140
that it's the connecting to internet
connected heater or centrifuge they will

175
00:15:10,140 --> 00:15:16,550
be a little suspicious if it's on Amazon
Web Services you know I have analysis

176
00:15:16,550 --> 00:15:19,779
scripts running on this honey pots I
have a very minimal I'll have to

177
00:15:20,320 --> 00:15:25,340
at the moment I wanted to be the
activity of the processor focused on

178
00:15:25,340 --> 00:15:31,200
Sunday pots and giving the attackers
what they deserve what they need

179
00:15:31,920 --> 00:15:37,099
i block / running which takes a lot of
processing power but I'm using to

180
00:15:37,100 --> 00:15:42,350
further processing there and it sends
stuff over a style which goes to the

181
00:15:42,350 --> 00:15:46,360
server which is listening on a stool
have a listen to ports one port for lock

182
00:15:46,360 --> 00:15:54,050
stock stuff for elasticsearch database
and then 14 files being transferred to

183
00:15:54,050 --> 00:15:58,390
have read its which is just using a data
brokers all that it is pushed in this

184
00:15:58,390 --> 00:16:04,449
kind of handed over to lock / again I
have more further filtering on the lock

185
00:16:04,450 --> 00:16:11,830
stash incidents to send it where is to
go so that I have depending on where

186
00:16:11,830 --> 00:16:15,900
things are being sent to have analysis
scripts I have multiple ones wanting to

187
00:16:15,900 --> 00:16:20,480
do various things with a different kind
of any pots and then depending on what I

188
00:16:20,480 --> 00:16:27,240
do with each other since dr. among ODP
for Intel intelligence or search for

189
00:16:27,240 --> 00:16:33,700
hopefully pretty dashboard and telling
that to have kept on running

190
00:16:34,210 --> 00:16:37,610
looking at last week search which is
like a free version Splunk elasticsearch

191
00:16:37,610 --> 00:16:41,740
monologues that whole package deal you
run them separately but they work well

192
00:16:41,740 --> 00:16:45,790
together I am using plastic which is a
python framework for Web developments

193
00:16:45,790 --> 00:16:51,180
kind of very basic and simple to
preserve my results and it's new to me

194
00:16:51,180 --> 00:16:58,319
so when you see what it looks like
you'll see that its goals were is easy

195
00:16:58,320 --> 00:17:01,730
installation secure communication using
a stun a lot of one any attackers at a

196
00:17:01,730 --> 00:17:04,939
karate pots knowing there's something
else going out i mean of course that

197
00:17:04,939 --> 00:17:09,360
they get out of a honeypot there are
ways there's a there's something about

198
00:17:09,359 --> 00:17:12,359
getting out of a

199
00:17:13,470 --> 00:17:19,179
sshit plots it running with what the
system is running clock stash and

200
00:17:19,179 --> 00:17:25,270
actually infiltrating getting into the
elasticsearch database but I didn't talk

201
00:17:25,270 --> 00:17:28,270
about that

202
00:17:28,789 --> 00:17:32,840
automatic and central analysis and I
don't want to be done by a person for

203
00:17:32,840 --> 00:17:38,030
the most part I'd like to buy computers
so easy installation I had this one

204
00:17:38,030 --> 00:17:47,168
setup script you to run on the server
and when you run it it creates this it

205
00:17:47,169 --> 00:17:52,059
does its thing installing everything and
it creates a tarball that you would copy

206
00:17:52,059 --> 00:17:56,450
over to clients and I can improve upon
this I can follow the pattern of modern

207
00:17:56,450 --> 00:18:01,270
network I don't want to copy exactly
what I want to build my own thing and

208
00:18:01,270 --> 00:18:04,740
then later on I'll move it over to
something like what he's doing but for

209
00:18:04,740 --> 00:18:08,330
now it's you you copy this over to this
the systems and it takes care of

210
00:18:08,330 --> 00:18:13,629
everything you need so I'm their clients
I had these two script writing I've got

211
00:18:13,630 --> 00:18:15,039
to get our info

212
00:18:15,039 --> 00:18:21,020
this takes the shot 56 hashes from any
malware that is found from tyre near or

213
00:18:21,020 --> 00:18:26,860
SSH or anything really that it's pulled
down onto the system by attacker

214
00:18:26,860 --> 00:18:31,549
it just saves the information to a file
which lock / process is incensed over to

215
00:18:31,549 --> 00:18:37,090
the server and have repeatedly why I
mean it's cool to be able to play that

216
00:18:37,090 --> 00:18:43,340
old python script and watch it you can
show people what people are typing speed

217
00:18:43,340 --> 00:18:48,168
up slow down but I had a script that
automatically just say to text file so

218
00:18:48,169 --> 00:18:52,360
you can do further analysis on those
actually on this text files have to sit

219
00:18:52,360 --> 00:18:56,590
there reading them all time this is what
it looks like last text files at the

220
00:18:56,590 --> 00:19:02,100
same thing you were saying before this
is a progression this is it just takes a

221
00:19:02,100 --> 00:19:05,939
screenshot screenshot but i text shot

222
00:19:05,940 --> 00:19:11,419
and then we can get information that I P
out by doing this

223
00:19:12,090 --> 00:19:16,860
natural language processing with Python
or something like that look at the iPad

224
00:19:16,860 --> 00:19:22,729
IPA actually will show you the startled
i version looking at this and another

225
00:19:22,730 --> 00:19:31,480
way I can see that I he belongs to ISP
in china there's a vast belongs to and I

226
00:19:31,480 --> 00:19:38,750
can see that there's some files
associated with his IP in the past the

227
00:19:38,750 --> 00:19:42,059
server actions a compound over this
already but as total sense to log stash

228
00:19:42,059 --> 00:19:47,690
that's the logo black South Africans
also and this is a little piece of my my

229
00:19:47,690 --> 00:19:52,990
filter file that takes all the data and
filters it don't have to try to figure

230
00:19:52,990 --> 00:19:58,059
it out because you can look through my
code files already passed this is

231
00:19:58,059 --> 00:20:03,070
actually almost server all the files
they get pushed into this folder files

232
00:20:03,070 --> 00:20:09,580
and coming and I have a comp log of a
calorie JSON and log file that have

233
00:20:09,580 --> 00:20:14,168
power from honey pot that's the 246
think I actually just going over this

234
00:20:14,169 --> 00:20:19,460
again but actually it so they the
analysis folder this is Alton Ellis this

235
00:20:19,460 --> 00:20:24,960
I have all these Python scripts that
I've written some API keys are currently

236
00:20:24,960 --> 00:20:32,690
I'm using to third-party tools and
opened a test so its third party but

237
00:20:32,690 --> 00:20:36,850
investigators I like a it's a tool that
we haven't opened it s I'm using that

238
00:20:36,850 --> 00:20:41,289
they use virustotal use their API its
interpretation but there's more stuff

239
00:20:41,289 --> 00:20:45,419
coming that I'm working on my I wanna
make it so it's free

240
00:20:45,419 --> 00:20:49,490
there's something that costs money and
make it so you can get analysis for free

241
00:20:49,490 --> 00:20:54,769
basically told AAP I read those houses
and sent into various total gets back to

242
00:20:54,769 --> 00:21:00,340
results and any resulting gets it pushes
them onto the MongoDB for analysis

243
00:21:01,399 --> 00:21:07,129
the compound reader reads combat log
sends information off to investigate

244
00:21:07,129 --> 00:21:10,949
gets information on that I'm only
getting the most the most minimal amount

245
00:21:10,950 --> 00:21:15,890
data and asks who is information or a
proof of concept I can get more

246
00:21:15,890 --> 00:21:20,700
information I can get things like
co-anchoring domains or IP addresses

247
00:21:20,700 --> 00:21:24,570
their contacted at the exact same time
that that demands typically contacted

248
00:21:24,570 --> 00:21:35,550
logical that I have a calorie log
analysis and I have a jackass popular to

249
00:21:35,550 --> 00:21:40,970
treat those logs and looks up
information on various sites actual

250
00:21:40,970 --> 00:21:46,890
special things well I kind of cover the
peristyle API OpenDNS investigate a

251
00:21:46,890 --> 00:21:52,810
total of 43 be plenty for calls per
minute if you pay you can do almost

252
00:21:52,810 --> 00:21:57,470
unlimited I don't think we've hit the
limit when working when we do it a lot

253
00:21:57,470 --> 00:22:03,280
I'm working on sale being able to send
your stuff your mouth where and your

254
00:22:03,280 --> 00:22:07,820
information to your own personal cuckoo
Sandbox is an hour analysis mbox which

255
00:22:07,820 --> 00:22:13,610
is awesome and open source and I think
if you're working in an environment

256
00:22:13,610 --> 00:22:18,110
where you need to keep your stuff secret
especially if you're you have your honey

257
00:22:18,110 --> 00:22:26,760
pots and your own IP space in cats stuff
destined for your industry it's nice to

258
00:22:26,760 --> 00:22:31,050
be able to keep that stuff private but
you can also send it out to the public

259
00:22:31,050 --> 00:22:37,370
as a public one called malware mal WR
dot com which is basically the same box

260
00:22:37,370 --> 00:22:44,520
even sent to a central private analysis
to them as well just looking at the

261
00:22:44,520 --> 00:22:48,590
investigator for this is kind of
whatever saying this is a IP address

262
00:22:48,590 --> 00:22:54,389
that someone who connected in called out
to this that w get this or what I don't

263
00:22:54,390 --> 00:22:59,900
get it and I just got some the AAS
information and this is a really basic

264
00:22:59,900 --> 00:23:04,520
the creation data that I P I can get a
lot more than that but just to show you

265
00:23:04,520 --> 00:23:09,280
a look at it looking at it investigate
you can see that the same informations a

266
00:23:09,280 --> 00:23:12,260
little bit prettier but I'll have to
copy that tasted in

267
00:23:12,260 --> 00:23:20,310
and go search it out and looking at this
is another IP that's an IP connecting in

268
00:23:20,310 --> 00:23:26,050
here you see the username and the
password is called us to see it but it's

269
00:23:26,050 --> 00:23:32,710
not it's not yet providing information
that's totally useful I i have been able

270
00:23:32,710 --> 00:23:37,800
to find patterns with certain passwords
that are used that have associated

271
00:23:37,800 --> 00:23:44,100
activities without him there's a scene
in the past what's really interesting is

272
00:23:44,100 --> 00:23:47,469
also actually no passwords that are
associated with certain kind of botnets

273
00:23:47,470 --> 00:23:51,440
that are constantly trying to connect in
I can see there's some other information

274
00:23:51,440 --> 00:24:00,060
I can see what other i likey ranges that
have a domain is running on them and I

275
00:24:00,060 --> 00:24:07,480
can do some more more data from that so
you need to get a visual stuff still man

276
00:24:07,480 --> 00:24:11,240
who loves to have a dashboard I chose
actually searched for ugliest dashboard

277
00:24:11,240 --> 00:24:18,070
is pretty ugly I don't know if it's from
the USA but never been with USA

278
00:24:18,070 --> 00:24:21,120
government but the US government is
really good at making a look at a sports

279
00:24:21,120 --> 00:24:27,590
that in this is insert my dashboard is
not pretty but it's still a work in

280
00:24:27,590 --> 00:24:32,780
progress should be able to search so
you'll see the threat Matt not managed

281
00:24:32,780 --> 00:24:36,410
it really needs the street map very
important to them they need him see

282
00:24:36,410 --> 00:24:42,440
where what countries are attacking that
were put on the wall so I have a threat

283
00:24:42,440 --> 00:24:47,170
not this is kind of looks like my my
preliminary dashboard you can see I've

284
00:24:47,170 --> 00:24:52,550
gotta count SSH connections at this time
I took the screenshot and I gasped

285
00:24:52,550 --> 00:24:57,310
connections can't get this kind of pie
chart i've got more information that

286
00:24:57,310 --> 00:25:02,320
actually had a quite a bit more since
then see where they're coming from this

287
00:25:02,320 --> 00:25:07,169
still isn't the coolest stuff in my
opinion this is this is handy but it's

288
00:25:07,170 --> 00:25:15,020
really mostly use this to me I can
search Splunk like interface the three

289
00:25:15,020 --> 00:25:18,200
spot and see

290
00:25:19,720 --> 00:25:24,820
whatever I filter large stashes all
depending on how you feel to block / and

291
00:25:24,820 --> 00:25:28,070
this kind of a girl over this is the
second this is a quick view of this the

292
00:25:28,070 --> 00:25:30,260
basic and tell the way it looks

293
00:25:30,260 --> 00:25:35,010
you can see connections and so far it's
really just who is information that's

294
00:25:35,010 --> 00:25:42,720
all about it but of course I got bored
and I i can get the information from the

295
00:25:42,720 --> 00:25:48,659
get requests I can see kind of like a
follow TCP streams of format like you do

296
00:25:48,659 --> 00:25:52,970
with Wireshark if you ever work with
Wireshark can see what they're getting

297
00:25:52,970 --> 00:25:58,220
and so you can analyze this file and
progress are still dying every day

298
00:25:58,220 --> 00:26:04,309
trying to optimize not such a lot nicer
pasady unless there's actually a great

299
00:26:04,309 --> 00:26:08,428
free passes the eye test tool that you
can run against systemic safe stop to a

300
00:26:08,429 --> 00:26:13,520
text file or to database although you
don't necessarily need it because you

301
00:26:13,520 --> 00:26:17,520
have someone in the call out your gonna
have that information if you doing

302
00:26:17,520 --> 00:26:24,000
various kinds of intelligence gathering
malware analysis that that the website

303
00:26:24,000 --> 00:26:30,090
match.com or cuckoo sandbox ability to
download malware having done that yet

304
00:26:30,090 --> 00:26:32,889
because I've been working on other
things but you should be able to

305
00:26:32,890 --> 00:26:36,309
download all malware from all the honey
pots and know where it came from which

306
00:26:36,309 --> 00:26:40,049
honey pot so you can analyze why it's on
that honey pot not on the other one

307
00:26:40,049 --> 00:26:47,240
quiet on this Windows honey pot not this
Linux one or make sense but he's gonna

308
00:26:47,240 --> 00:26:49,409
get all that stuff from the server

309
00:26:49,409 --> 00:26:53,580
not from anybody should never have to go
into that at all except to make sure

310
00:26:53,580 --> 00:26:59,049
that they have a read of disk space or
something like that and this is this is

311
00:26:59,049 --> 00:27:03,179
the biggest working on right now is
doing Dr images cause I am trying to

312
00:27:03,179 --> 00:27:07,429
compartmentalize the installations
wanted to make it easier than it already

313
00:27:07,429 --> 00:27:13,559
is I want to be able to turn them on and
off at the button press so working

314
00:27:13,559 --> 00:27:18,980
towards that and that may be replayed a
lot of CSI cyber style in this episode

315
00:27:18,980 --> 00:27:22,070
they have green code looking for Petco

316
00:27:22,070 --> 00:27:28,780
code so it is the right code so that
means they found the bad malware so it's

317
00:27:28,780 --> 00:27:36,889
actually not too hard to implement just
you know this is why more excited about

318
00:27:36,890 --> 00:27:42,230
his real analysis but it requires a lot
of processing brain processing before

319
00:27:42,230 --> 00:27:59,430
you get a python processing I love this
if this is just taking into exile the

320
00:27:59,430 --> 00:28:04,930
whole thing but assuming that you can
see this is a PivotTable way so you can

321
00:28:04,930 --> 00:28:14,760
see who's the biggest offender that's
China but 534 at the time I took this

322
00:28:14,760 --> 00:28:23,530
looking at the next you can see charts
you know my ass who's the biggest

323
00:28:23,530 --> 00:28:29,920
offender and I think that's Charter
Communications this stuff can be

324
00:28:29,920 --> 00:28:33,170
generated dynamically for your dashboard

325
00:28:33,170 --> 00:28:40,250
it's very useful to see the best thing
about like this in getting pictures like

326
00:28:40,250 --> 00:28:44,570
this is if you have happened to install
your honey pots in your IP space and you

327
00:28:44,570 --> 00:28:49,350
work in aerospace or something like that
you can and you're watching current

328
00:28:49,350 --> 00:28:54,310
events maybe there's a new era space
thing out there and all of a sudden

329
00:28:54,310 --> 00:28:59,280
bunch of new attacks come from a certain
country then you can use that in the

330
00:28:59,280 --> 00:29:02,870
near future threat analysis and prepare
for things in the future that's that's

331
00:29:02,870 --> 00:29:09,560
what I'm going for here this is even
more the same as a time series analysis

332
00:29:09,560 --> 00:29:15,389
if you can call eight times with events
current events and your industry then

333
00:29:15,390 --> 00:29:19,260
you are way ahead of the game than most
people you're not looking at all data

334
00:29:19,260 --> 00:29:21,720
you looking at fresh data and you're
actually able to look into the future

335
00:29:21,720 --> 00:29:28,390
and see what's about to happen this is
just a quick little video of analysis

336
00:29:28,390 --> 00:29:32,320
script I wrote to the show some
different things you can do i mean this

337
00:29:32,320 --> 00:29:36,320
is an IM programmatically during those
Excel spreadsheets basically instead of

338
00:29:36,320 --> 00:29:40,990
doing them any of that was a unique
eyepiece you can get the summary edit

339
00:29:40,990 --> 00:29:49,640
this is like the pivot table there's the
top but I P account right there 534 does

340
00:29:49,640 --> 00:29:53,550
that it has said there should be you can
set estado generate basically

341
00:29:54,690 --> 00:30:00,260
applaud it secret plots ugly plots in
this case but there's a way to raise the

342
00:30:00,260 --> 00:30:04,370
bigger prettier is just a time series
analysis and see what's happening at

343
00:30:04,370 --> 00:30:07,370
certain types

344
00:30:09,250 --> 00:30:20,200
times based on location Ave the most
active one is in Brazil right now I

345
00:30:20,200 --> 00:30:25,110
don't know why I need to figure out why
it's more active than other ones don't

346
00:30:25,110 --> 00:30:35,280
know why it's busy busy based on what's
happening in the world so I wonder what

347
00:30:35,280 --> 00:30:38,899
kind of malware I have based on the type
of honey pot and wide base of the time

348
00:30:38,900 --> 00:30:45,590
defense I keep reiterating that but I
think it's very important and I want

349
00:30:45,590 --> 00:30:49,720
lots more data so I'm just installing
more and more honey pots the current

350
00:30:49,720 --> 00:30:55,860
modifications beyond that I talked about
here as I do a lot of programming

351
00:30:55,860 --> 00:31:02,780
reading books like particle data
analysis compartmentalizing these honey

352
00:31:02,780 --> 00:31:08,300
pots of their separate and more unique
you have to go into some of these and

353
00:31:08,300 --> 00:31:14,540
configure them to the environment there
in like a spot has to be you need to say

354
00:31:14,540 --> 00:31:18,680
it's a certain gas station of certain
time gas station exxon and exxon doesn't

355
00:31:18,680 --> 00:31:19,309
exist

356
00:31:19,309 --> 00:31:24,950
someone's gonna catch on a smart I'm
adding just just as of yesterday the

357
00:31:24,950 --> 00:31:28,450
ability to differentiate the clients
because I think that's that's a really

358
00:31:28,450 --> 00:31:37,159
big feature that should be there
organizing done it better recognition

359
00:31:37,159 --> 00:31:44,519
just looking for patterns big big and
small stuff with that data so it's kinda

360
00:31:44,519 --> 00:31:49,779
closer look at the laptop as a staging
into one of my honey pots and on the

361
00:31:49,779 --> 00:31:55,679
right is the dashboard life running and
typing whatever passes right I but you

362
00:31:55,679 --> 00:32:01,190
can see here that it's popped up at the
map and then second pops up with what

363
00:32:01,190 --> 00:32:06,600
SSH connection so that's cool tell that
to the system to the port that's running

364
00:32:06,600 --> 00:32:13,209
out for gas plot and this was actually
kinda interesting pops obviously there's

365
00:32:13,210 --> 00:32:17,830
two connections but I didn't do too
added 10 just tell it in disconnected

366
00:32:17,830 --> 00:32:22,149
Council one connection but at the bottom
it just was a coincidence someone from

367
00:32:22,149 --> 00:32:28,580
South America happened to try out the
exact same time political thought I was

368
00:32:28,580 --> 00:32:33,610
dead wrong or something and this is kind
of looks like I showed you the

369
00:32:33,610 --> 00:32:36,610
screenshots but has to walk through real
quick

370
00:32:37,490 --> 00:32:45,299
you can see the these are the qualities
EP stream view of what they're doing

371
00:32:45,299 --> 00:32:54,408
with a SSH this is from shld lot of
getting lifespan related stuff as we are

372
00:32:54,409 --> 00:33:02,509
successful at this age connections and
some other patterns on the passwords

373
00:33:02,509 --> 00:33:09,679
based on location like that that was
really interesting but on some stuff

374
00:33:09,679 --> 00:33:14,869
about that but I R you can get the Excel
spreadsheet data CSV file so you can be

375
00:33:14,869 --> 00:33:18,600
the data center I wouldn't recommend
doing this blanket sending it to people

376
00:33:18,600 --> 00:33:22,860
like everyone does nowadays don't be a
part of the problem but if you wanna

377
00:33:22,860 --> 00:33:26,899
provide good stuff to people you can
call outside addresses and it's not very

378
00:33:26,899 --> 00:33:29,750
much stuff because like I said I wipe it
and reload it all the time

379
00:33:29,750 --> 00:33:35,280
as I prove the system and I'm our
founding fathers total this gives you

380
00:33:35,280 --> 00:33:41,680
the information found based on malware
I'm adding in the ability to send stuff

381
00:33:41,680 --> 00:33:44,640
of Aristotle although that's not always
the best idea if you want to keep

382
00:33:44,640 --> 00:33:49,050
something private but you can see where
there's a lot of stuff cosmetics system

383
00:33:49,050 --> 00:33:56,649
is a software that they just try to take
over Linux system but school to see that

384
00:33:56,650 --> 00:34:01,270
and this system is an AWS to
specifically pot so that sent out

385
00:34:01,270 --> 00:34:06,480
information if I put it in my
organization maybe I'll see some of the

386
00:34:06,480 --> 00:34:09,969
kind of malware because they want
something else

387
00:34:09,969 --> 00:34:14,750
compound and gas spot gas prior to
starting this connection attempts here

388
00:34:14,750 --> 00:34:19,610
but those actual commands types as only
about if you download the manual is not

389
00:34:19,610 --> 00:34:29,540
very easy thing to play with and so that
if you wanna get a copy of it before you

390
00:34:29,540 --> 00:34:31,679
download play with it do whatever you
want with it

391
00:34:31,679 --> 00:34:38,270
open source I have investigated
fortunately is aid thing but I'm adding

392
00:34:38,270 --> 00:34:44,139
as many things I can to replicate that I
mean it while I work there I over did I

393
00:34:44,139 --> 00:34:48,679
say you should you should always be able
to get the stuff without paying for it

394
00:34:48,679 --> 00:34:53,800
is great because you can get a better
quality service but I want you to be

395
00:34:53,800 --> 00:34:57,300
able to put this in your environment and
get the data that you need to do your

396
00:34:57,300 --> 00:35:03,060
job and make their environment safer so
that's it you have any questions

397
00:35:06,780 --> 00:35:13,040
trust you know the intelligent running
up to project is available and get ya

398
00:35:13,040 --> 00:35:25,210
uses Python 2.73% and you're happy to
accept requests against other inclusions

399
00:35:25,210 --> 00:35:39,060
question we have plenty of time for
questions one of the problems problems

400
00:35:39,060 --> 00:35:45,180
by rail from tobacco or his deploying
honey pots you mentioned Amazon Cloud

401
00:35:45,180 --> 00:35:49,160
Services a space where you gonna have
some of your reports regarding I always

402
00:35:49,160 --> 00:35:53,859
end here from my research works for a
week over to put an Amazon comes back as

403
00:35:53,860 --> 00:35:59,550
he takes it out of our network from
otherwise be so that you can specify you

404
00:35:59,550 --> 00:36:04,760
can actually you can ask Amazon tell
them that you have a network that you

405
00:36:04,760 --> 00:36:05,950
are doing this

406
00:36:05,950 --> 00:36:12,359
that's actually a WSN since I was using
my company's account and we have a

407
00:36:12,360 --> 00:36:17,680
certain network that they will leave us
alone no matter what they see which is

408
00:36:17,680 --> 00:36:18,700
nice

409
00:36:18,700 --> 00:36:25,089
also have beyond that I have UPS's like
digital ocean $5 a system super cheap

410
00:36:25,090 --> 00:36:31,860
they don't care what's on the system and
I can tell cuz I see fishing village all

411
00:36:31,860 --> 00:36:37,390
the time but a WIC can you can you can
have that if you want it doesn't cost

412
00:36:37,390 --> 00:36:42,379
anything to you they just be bought as
constituting more

413
00:36:43,500 --> 00:36:52,090
AWS is not recommended actually it's
expensive questions

414
00:36:54,440 --> 00:37:06,619
plenty of time to come talk to me if you
have any questions diet other stuff I

415
00:37:06,619 --> 00:37:11,250
like talk about security operations
centers and intrusion detection things

416
00:37:11,250 --> 00:37:16,740
like that you'll be around the speakers
tonight I'll be here for its own till

417
00:37:16,740 --> 00:37:26,319
tomorrow the end so to come up with
questions or questioned while they're

418
00:37:26,319 --> 00:37:30,500
also analyzing them that up there are
some that are analyzing unit at the

419
00:37:30,500 --> 00:37:36,390
Royal failing commands on some stuff
like this or strange behavior which will

420
00:37:36,390 --> 00:37:43,310
see what the factor doing our securities
worrisome behavior of some attack us we

421
00:37:43,310 --> 00:37:52,980
are you thought about what the fuck are
they doing interesting stuff come

422
00:37:52,980 --> 00:37:59,410
sometimes its parts but I have actually
seen someone who who was gotten into the

423
00:37:59,410 --> 00:38:05,319
system and they are typing away at
almost it's almost like they are they

424
00:38:05,319 --> 00:38:10,319
have a script that's public very likely
like state sponsored actors day I mean

425
00:38:10,319 --> 00:38:17,970
the low-level say this is China's
example the level workers I just usually

426
00:38:17,970 --> 00:38:22,118
not the ones who are the super technical
they're just copying and pasting

427
00:38:22,119 --> 00:38:25,569
commands or just typing what they see
that they go through a list and I

428
00:38:25,569 --> 00:38:31,089
watched them do that it's really
interesting and it gives you an idea of

429
00:38:31,089 --> 00:38:34,950
the structure that they're working with
the people who are running the malware

430
00:38:34,950 --> 00:38:37,529
probably not as a staging in order

431
00:38:37,530 --> 00:38:41,510
people running SSH pots or so

