1
00:00:06,250 --> 00:00:06,900
by law

2
00:00:06,900 --> 00:00:09,920
one a thank you for coming to our talk
about

3
00:00:09,920 --> 00:00:12,990
circa it's great to be back here after
three-year

4
00:00:12,990 --> 00:00:16,720
three years back in 2008 well we just a

5
00:00:16,720 --> 00:00:20,320
had just receive their funding we Matt

6
00:00:20,320 --> 00:00:23,890
don't mine and I were here too announce
our plans and

7
00:00:23,890 --> 00:00:27,220
solace solicit for IDS and

8
00:00:27,220 --> 00:00:31,500
so three years later and seemed like a
good moment to come back and

9
00:00:31,500 --> 00:00:36,750
tell you about what we're doing now and
where we are a

10
00:00:36,750 --> 00:00:41,170
doesn't view that attendant air and
finance stock yesterday

11
00:00:41,170 --> 00:00:44,720
I'll be they might have heard

12
00:00:44,720 --> 00:00:48,460
pretty pessimistic story about how IDS
is doing

13
00:00:48,460 --> 00:00:51,600
and it

14
00:00:51,600 --> 00:00:56,160
and about especially as detection
accuracy I'm not quite as

15
00:00:56,160 --> 00:00:59,470
has mistake although there are
definitely some issues

16
00:00:59,470 --> 00:01:03,580
but there is a bit has been a lot of
progress

17
00:01:03,580 --> 00:01:10,340
um the stock is

18
00:01:10,340 --> 00:01:13,520
from Eric leblanc here and myself Victor

19
00:01:13,520 --> 00:01:17,850
to your the let me quickly interviews
Eric

20
00:01:17,850 --> 00:01:22,020
air kisses security and officers
professional since the end of the 21st

21
00:01:22,020 --> 00:01:22,770
century

22
00:01:22,770 --> 00:01:26,259
yes created has been the lead up to and
you firewall

23
00:01:26,260 --> 00:01:29,420
a and enterprise

24
00:01:29,420 --> 00:01:33,880
the a project and is creating it and
identity based enterprise firewall

25
00:01:33,880 --> 00:01:37,009
eric is a long-term print contributor to
%uh

26
00:01:37,010 --> 00:01:40,659
netfilter the packet filtering framework
for

27
00:01:40,659 --> 00:01:44,229
Linux and a

28
00:01:44,229 --> 00:01:47,700
are things he has made major
contributions to you lock

29
00:01:47,700 --> 00:01:50,979
to userspace logging daemon is a

30
00:01:50,979 --> 00:01:54,690
frequent speaker a French free software
and security call Frances

31
00:01:54,690 --> 00:01:59,220
and also writes articles and specialized
Press like limits magazine France

32
00:01:59,220 --> 00:02:02,548
a yes for example being the main artery
of the net

33
00:02:02,549 --> 00:02:06,760
specific special that filter issue it
was also the cofounder

34
00:02:06,760 --> 00:02:11,360
of I and L you all company where he was
a city O

35
00:02:11,360 --> 00:02:14,379
to build enterprise-grade network
appliances based on

36
00:02:14,379 --> 00:02:18,129
and you firewall areas though that

37
00:02:18,129 --> 00:02:21,388
feel as security consultant a.m.

38
00:02:21,389 --> 00:02:26,459
free and security software and he worked
jointly 40 as F on

39
00:02:26,459 --> 00:02:30,989
among other things and for a I as a he
is the maintainer of the packwood

40
00:02:30,989 --> 00:02:34,870
excision system and are in line and IPS
support

41
00:02:34,870 --> 00:02:37,879
over about myself

42
00:02:37,879 --> 00:02:41,849
and lead developer of here kinda a some
people may

43
00:02:41,849 --> 00:02:45,488
know me a other projects which is shamir
it's a

44
00:02:45,489 --> 00:02:49,279
firewall front and for for for iPad
tables

45
00:02:49,279 --> 00:02:53,760
a but most people front as it is for

46
00:02:53,760 --> 00:02:57,239
which is the mostly the english-speaking
people

47
00:02:57,239 --> 00:03:00,790
work with sort in line for years as a
developer and

48
00:03:00,790 --> 00:03:03,828
a also as a contractor I've done lots

49
00:03:03,829 --> 00:03:08,959
awesome work on snort a in late 2007

50
00:03:08,959 --> 00:03:12,889
about four years ago asserted working on
a little

51
00:03:12,889 --> 00:03:16,019
multi-threaded packet forwarding program

52
00:03:16,019 --> 00:03:19,650
and got a little a controlling here we
are

53
00:03:19,650 --> 00:03:23,349
so

54
00:03:23,349 --> 00:03:27,989
the next forty to 45 minutes we'll only
talking about Cirque outta

55
00:03:27,989 --> 00:03:31,209
a well I will sell tell you quickly
about

56
00:03:31,209 --> 00:03:35,519
what's your cat is a who bill said why
we build it

57
00:03:35,519 --> 00:03:39,769
how it works what makes it great I'll be
highlighting some

58
00:03:39,769 --> 00:03:42,900
major features after that Eric will

59
00:03:42,900 --> 00:03:46,439
um will be showing some recent advances
in circa

60
00:03:46,439 --> 00:03:50,189
other a and how it deals with SSL and
TLS traffic

61
00:03:50,189 --> 00:03:54,578
there's a lot of things going on in this
area especially

62
00:03:54,579 --> 00:03:58,239
a I'm from the Netherlands and as a
Dutch guy

63
00:03:58,239 --> 00:04:02,409
I don't like being reminded of DigiNotar

64
00:04:02,409 --> 00:04:05,439
the the

65
00:04:05,439 --> 00:04:08,480
certificate authority that was hacked
and

66
00:04:08,480 --> 00:04:12,209
terrible show some things that we can

67
00:04:12,209 --> 00:04:15,779
her help their it going today a

68
00:04:15,779 --> 00:04:20,279
as owes the definitely a topic that's
hard for an IDS in general but

69
00:04:20,280 --> 00:04:24,080
we can do so interesting things there so
after

70
00:04:24,080 --> 00:04:27,289
eric's down with that I will be
returning and

71
00:04:27,289 --> 00:04:30,690
to the stage and a tell you about file
extraction

72
00:04:30,690 --> 00:04:37,280
one of the new features were working on
insert Cup

73
00:04:37,280 --> 00:04:41,020
so what is certain to sir got is a
network

74
00:04:41,020 --> 00:04:44,359
intrusion detection and prevention
system or

75
00:04:44,360 --> 00:04:48,889
really engine it's really an engine but
people are so

76
00:04:48,889 --> 00:04:52,229
used to use saying system that up

77
00:04:52,229 --> 00:04:56,099
weak-kneed kind of just keep using it as
well but

78
00:04:56,099 --> 00:05:00,080
really sorry pat on its own is is a only
have limited use your

79
00:05:00,080 --> 00:05:03,758
supposed to use them much larger
eco-system of

80
00:05:03,759 --> 00:05:07,030
tools to do complete detection in your
network

81
00:05:07,030 --> 00:05:10,090
circuit is open source with most of its
codes

82
00:05:10,090 --> 00:05:16,409
gplv2 and some parts under a BSD license

83
00:05:16,409 --> 00:05:19,650
so it kinda works by looking at network
traffic me

84
00:05:19,650 --> 00:05:23,590
it inspect suspected a.m. it

85
00:05:23,590 --> 00:05:26,629
its against known bat

86
00:05:26,629 --> 00:05:30,639
which means we use signatures heavily in
addition to this we

87
00:05:30,639 --> 00:05:34,669
we detect all kinds of anomalies during
parsing and decoding of the traffic

88
00:05:34,669 --> 00:05:39,219
and so we can detect that as well

89
00:05:39,220 --> 00:05:42,449
your car uses start second-tier language
a.m.

90
00:05:42,449 --> 00:05:45,539
so existing rules are generally
supported

91
00:05:45,539 --> 00:05:51,068
but I'll go into morse more details
later

92
00:05:51,069 --> 00:05:54,729
circa is bill by us here but

93
00:05:54,729 --> 00:05:57,960
also buy a whole other product people
its the

94
00:05:57,960 --> 00:06:02,169
development is a organized around the
open information security foundation

95
00:06:02,169 --> 00:06:03,000
which is a

96
00:06:03,000 --> 00:06:06,240
us-based nonprofit and it's funded by

97
00:06:06,240 --> 00:06:09,310
the US Department of Homeland Security

98
00:06:09,310 --> 00:06:14,360
also known as DHS that's pretty much
dollars with the funding to do something

99
00:06:14,360 --> 00:06:15,050
good with it

100
00:06:15,050 --> 00:06:19,199
with no specific deliverables so sorry
Kat is what we

101
00:06:19,199 --> 00:06:24,069
we're doing a using this funding we've
been able to

102
00:06:24,069 --> 00:06:27,610
pay developers the to work on it

103
00:06:27,610 --> 00:06:32,330
and also we have spent some up for
funding on other

104
00:06:32,330 --> 00:06:36,438
development like we've

105
00:06:36,439 --> 00:06:39,539
we've developed or or we have ass I for
every stitch

106
00:06:39,539 --> 00:06:43,250
you know might know from obscurity to
write a specific

107
00:06:43,250 --> 00:06:48,979
security where its DP lot personal ivory

108
00:06:48,979 --> 00:06:52,180
a.m. another example above using this
funding

109
00:06:52,180 --> 00:06:55,800
to the support other projects is the we

110
00:06:55,800 --> 00:06:59,270
hat did some funding of the barnyard to
to

111
00:06:59,270 --> 00:07:03,580
which include for work

112
00:07:03,580 --> 00:07:08,349
to include starts am tool which start
time is a tool to

113
00:07:08,349 --> 00:07:11,969
the send block commands to your firewall
based on

114
00:07:11,969 --> 00:07:15,650
start rules or sir cuddles

115
00:07:15,650 --> 00:07:19,530
a so we are funding but a for the longer
term where

116
00:07:19,530 --> 00:07:22,749
looking at vendors to

117
00:07:22,749 --> 00:07:26,090
to support the project and

118
00:07:26,090 --> 00:07:31,050
we formed a consortium where companies
that have an interest or stay cancer

119
00:07:31,050 --> 00:07:32,830
catholic and

120
00:07:32,830 --> 00:07:36,318
can support us and usually they sported
by cash or day

121
00:07:36,319 --> 00:07:40,169
supported using or having us exit

122
00:07:40,169 --> 00:07:44,810
giving us access to software developers
to help us build things

123
00:07:44,810 --> 00:07:48,599
and this is a slight what's up some
other companies that are

124
00:07:48,599 --> 00:07:52,449
helping us currently

125
00:07:52,449 --> 00:07:58,590
a

126
00:07:58,590 --> 00:08:01,689
so others at a Cirque at work as an IDS

127
00:08:01,689 --> 00:08:05,249
well the first thing is we process

128
00:08:05,249 --> 00:08:09,020
packets so we need to be able to see
packets own network IDS

129
00:08:09,020 --> 00:08:13,188
you usually plays in the network and in
the switch network that sir

130
00:08:13,189 --> 00:08:16,949
its is always a challenge to get get
packets to to IDS

131
00:08:16,949 --> 00:08:20,219
so usually use you control your

132
00:08:20,219 --> 00:08:24,020
your compare your switches to you you
some kind of special importance and all

133
00:08:24,020 --> 00:08:26,189
the traffic to your ideas

134
00:08:26,189 --> 00:08:29,520
so wanted you've done that the idea sees
the packet

135
00:08:29,520 --> 00:08:32,890
and it needs to try to understand that
so

136
00:08:32,890 --> 00:08:36,968
for it is it starts the coating them

137
00:08:36,969 --> 00:08:40,690
up good takes a the backup are

138
00:08:40,690 --> 00:08:44,340
the it parses the IP header a is Red
Hatters

139
00:08:44,340 --> 00:08:47,570
IP headers disappear headers and

140
00:08:47,570 --> 00:08:50,970
at some point when this is all done
circle no

141
00:08:50,970 --> 00:08:55,270
all about packet some packets are
fragmented

142
00:08:55,270 --> 00:08:59,360
like Aaron also showed in this

143
00:08:59,360 --> 00:09:04,780
as talk yesterday a.m. but we have a
defragmentation engine so

144
00:09:04,780 --> 00:09:08,140
that's taken care of

145
00:09:08,140 --> 00:09:11,270
for TCP packets after decoding stage we

146
00:09:11,270 --> 00:09:14,910
role start reconstructing due to be
sessions

147
00:09:14,910 --> 00:09:17,939
reassembling the

148
00:09:17,940 --> 00:09:21,150
the data layer and

149
00:09:21,150 --> 00:09:24,180
to find all kinds of anomalies like

150
00:09:24,180 --> 00:09:28,360
retransmissions with different data and
and opens for

151
00:09:28,360 --> 00:09:33,380
other things so at the end of this stage
we have a reassembled stream

152
00:09:33,380 --> 00:09:36,990
that isn't can be inspected a.m.

153
00:09:36,990 --> 00:09:40,530
but we do more with reassemble stream

154
00:09:40,530 --> 00:09:44,569
we go to a we have a and advance

155
00:09:44,570 --> 00:09:47,730
it's the parser and and other few other
horses like

156
00:09:47,730 --> 00:09:51,600
the TLS parser Eric will be speaking
about

157
00:09:51,600 --> 00:09:55,360
and what we do base under

158
00:09:55,360 --> 00:10:00,240
resemble data is recall start to fall a
sin to be session

159
00:10:00,240 --> 00:10:05,570
a this is done in the state for way so
every

160
00:10:05,570 --> 00:10:09,480
nude new data just updates the state and
we keep a state of the entire

161
00:10:09,480 --> 00:10:12,710
its DP session so if that's all

162
00:10:12,710 --> 00:10:16,200
completely then we're ready to do
detection

163
00:10:16,200 --> 00:10:19,310
in detection States both are all

164
00:10:19,310 --> 00:10:22,600
the packet the stream and the state are
expected against the rules

165
00:10:22,600 --> 00:10:26,150
the rules here are this the signatures
as you may noted from

166
00:10:26,150 --> 00:10:29,810
from snort but also a all our on

167
00:10:29,810 --> 00:10:32,890
all the anomalies we detect during
parsing and decoding

168
00:10:32,890 --> 00:10:37,530
a are exposed to the ruling which are
you can

169
00:10:37,530 --> 00:10:40,680
have rules that do specific matching of

170
00:10:40,680 --> 00:10:45,130
on diesel nominees so in detection

171
00:10:45,130 --> 00:10:48,490
the at so if the detection

172
00:10:48,490 --> 00:10:51,600
finds alerts or

173
00:10:51,600 --> 00:10:56,990
find rules that Matt alerts go to the
output stage which is the final stage

174
00:10:56,990 --> 00:11:00,390
hear an alert this process various up
with plugins

175
00:11:00,390 --> 00:11:03,990
the most simple one is is a a snort

176
00:11:03,990 --> 00:11:07,180
likes fast law but we also support

177
00:11:07,180 --> 00:11:11,740
prelude and unified to to support all
kinds of other

178
00:11:11,740 --> 00:11:15,000
tools that are

179
00:11:15,000 --> 00:11:22,000
available

180
00:11:22,260 --> 00:11:25,260
so we can also work as an IPS a

181
00:11:25,260 --> 00:11:28,660
big difference there is that instead of
just detection we can do

182
00:11:28,660 --> 00:11:33,449
prevention IIPs modus supposed to be in
line so you

183
00:11:33,450 --> 00:11:36,720
the the IPS gets in between

184
00:11:36,720 --> 00:11:40,160
do various hosts

185
00:11:40,160 --> 00:11:44,150
and in general it will pretty much work
the same way

186
00:11:44,150 --> 00:11:47,209
internally as the IDS however

187
00:11:47,210 --> 00:11:50,530
we do some other things like

188
00:11:50,530 --> 00:11:53,819
normalization of especially ACP streams
there is some love

189
00:11:53,820 --> 00:11:56,970
anomalies a any vision possibilities

190
00:11:56,970 --> 00:12:00,110
like Aaron discussed yesterday which are

191
00:12:00,110 --> 00:12:03,200
a week we can remove from string

192
00:12:03,200 --> 00:12:08,510
so thats then we really all 30 packets
on the network

193
00:12:08,510 --> 00:12:11,800
a.m.

194
00:12:11,800 --> 00:12:15,870
of course to rules can be set to

195
00:12:15,870 --> 00:12:19,920
drop based dropped packets and streams
based on

196
00:12:19,920 --> 00:12:26,920
a the two matches in rules

197
00:12:27,730 --> 00:12:33,110
so there IDS is it love limitations

198
00:12:33,110 --> 00:12:36,260
it's a it has Eve up 3

199
00:12:36,260 --> 00:12:39,620
it has even beat been declared dead by
Gartner

200
00:12:39,620 --> 00:12:43,650
at the researchers a but we feel it's
far from that

201
00:12:43,650 --> 00:12:48,939
there are some issues like Aaron
discussed yesterday

202
00:12:48,940 --> 00:12:53,870
the first problem we have with IDS is
that it's fairly easy to overwhelm it

203
00:12:53,870 --> 00:12:58,520
usually an IDS is is sitting on a a SPAN
port in a switch

204
00:12:58,520 --> 00:13:02,260
and usually does re: many occasions this
spam portis

205
00:13:02,260 --> 00:13:06,189
does not have the full capacity to a.m.

206
00:13:06,190 --> 00:13:09,830
some get all the Packers on a fully
loaded switch to do

207
00:13:09,830 --> 00:13:13,100
idea so there's the first problem love

208
00:13:13,100 --> 00:13:16,570
packet loss another reason

209
00:13:16,570 --> 00:13:21,540
ideas assert easy to overwhelm is
because ideas operations are quite

210
00:13:21,540 --> 00:13:24,849
CPU intensive and expenses

211
00:13:24,850 --> 00:13:28,600
and IDSs to keep and internal
representation up about dozens or

212
00:13:28,600 --> 00:13:30,970
hundreds or even thousands oppose

213
00:13:30,970 --> 00:13:34,790
and their network activity so if you for
example take a 10

214
00:13:34,790 --> 00:13:38,060
10 gigabit network you could be up
talking about

215
00:13:38,060 --> 00:13:41,170
about 15 million packets a second that
needs to be

216
00:13:41,170 --> 00:13:44,470
need to be compared and parson and

217
00:13:44,470 --> 00:13:48,560
you would inspect them for example
against 10,000 or 15,000

218
00:13:48,560 --> 00:13:51,570
rules so it's quite easy to see it that

219
00:13:51,570 --> 00:13:54,780
just these numbers will lead you to

220
00:13:54,780 --> 00:13:58,589
very heavy hardware requirements not
everyone has it so

221
00:13:58,590 --> 00:14:02,270
packet loss is always the problem

222
00:14:02,270 --> 00:14:05,300
a different problem is what we call
impedance mismatch

223
00:14:05,300 --> 00:14:08,820
this is this issue I'll

224
00:14:08,820 --> 00:14:12,330
is also that some attention

225
00:14:12,330 --> 00:14:16,380
other name ATT's advance vision
techniques

226
00:14:16,380 --> 00:14:20,750
so what it means is and it's in part the
same thing that erin was discussing

227
00:14:20,750 --> 00:14:21,940
yesterday's

228
00:14:21,940 --> 00:14:25,720
that there is ambiguities in the network
traffic and the way

229
00:14:25,720 --> 00:14:28,950
OS's and programs are handling this
equities

230
00:14:28,950 --> 00:14:32,580
and the ideas has to make a choice

231
00:14:32,580 --> 00:14:37,680
like would what what way to you

232
00:14:37,680 --> 00:14:42,100
interpreter traffic so for example

233
00:14:42,100 --> 00:14:45,800
Aaron discuss differences but between
between Apache and I

234
00:14:45,800 --> 00:14:51,200
yes web servers or even the petty and on
Windows and apache on UNIX

235
00:14:51,200 --> 00:14:54,340
but differences like this exist every
layer

236
00:14:54,340 --> 00:14:57,780
we're looking at and usually get worse

237
00:14:57,780 --> 00:15:01,209
the higher you get have an example here

238
00:15:01,210 --> 00:15:04,900
this is a table at took from Ryan
barnett's tactical

239
00:15:04,900 --> 00:15:08,940
web application security blog it shows
what the ideas I

240
00:15:08,940 --> 00:15:13,910
years or less has to do with right
investigate a simple question

241
00:15:13,910 --> 00:15:18,250
how does the weather application
responded receives multiple para meterse

242
00:15:18,250 --> 00:15:21,680
a city permit is with the same name but
different values

243
00:15:21,680 --> 00:15:24,920
and as you can see do

244
00:15:24,920 --> 00:15:29,170
results by dis the satisfying

245
00:15:29,170 --> 00:15:32,550
this is just one list of frameworks

246
00:15:32,550 --> 00:15:37,080
web application frameworks and many many
have all kinds of different ways of

247
00:15:37,080 --> 00:15:38,370
interpreting

248
00:15:38,370 --> 00:15:42,510
and this is what we're seeing all over
the place it's just

249
00:15:42,510 --> 00:15:47,410
quite a mess

250
00:15:47,410 --> 00:15:50,610
also exist discern obvious problem in
ideas

251
00:15:50,610 --> 00:15:54,080
with had problems with bordered due to

252
00:15:54,080 --> 00:15:57,440
for rules or the engines

253
00:15:57,440 --> 00:16:00,780
not being able to exposing of

254
00:16:00,780 --> 00:16:04,640
specific specific enough offers

255
00:16:04,640 --> 00:16:08,100
an example of a buffer here would be a
your your

256
00:16:08,100 --> 00:16:11,360
its 2 p.m. et or something like that so
if you

257
00:16:11,360 --> 00:16:15,270
if you try to match on something that's
not specifically

258
00:16:15,270 --> 00:16:19,319
exposed body ideas and in you'll have to
be

259
00:16:19,320 --> 00:16:23,310
creating the rules and often this leads
to you false positives

260
00:16:23,310 --> 00:16:26,900
was no -0 obviously an even bigger
problem

261
00:16:26,900 --> 00:16:29,950
they can again come from bad rules come
from

262
00:16:29,950 --> 00:16:33,210
engine box that do for

263
00:16:33,210 --> 00:16:37,530
normalization missing decoding

264
00:16:37,530 --> 00:16:40,560
and of course packet loss is a major
issue for

265
00:16:40,560 --> 00:16:45,180
false negatives and other resource
starvation issues where you would

266
00:16:45,180 --> 00:16:48,570
overwhelm ideas so it kinda spec
everything

267
00:16:48,570 --> 00:16:52,050
is a big issue so that last thing I want

268
00:16:52,050 --> 00:16:55,730
to mention about limitations is
encryption

269
00:16:55,730 --> 00:16:59,610
obviously encryption is hard for an IDS
because usually you can at

270
00:16:59,610 --> 00:17:02,980
the crypt the packets or decisions and

271
00:17:02,980 --> 00:17:06,809
with its the s and associates traffic

272
00:17:06,809 --> 00:17:10,639
for example this a big problem

273
00:17:10,640 --> 00:17:13,939
there are some as %uh the critter
options

274
00:17:13,939 --> 00:17:17,260
but circa at least doesn't

275
00:17:17,260 --> 00:17:21,640
do support that directly

276
00:17:21,640 --> 00:17:28,329
so what does so we gotta do to deal with
this or also known as major features

277
00:17:28,329 --> 00:17:32,100
I'll well the first thing is that sir
cuddle

278
00:17:32,100 --> 00:17:35,380
really help you get the most your
hardware so

279
00:17:35,380 --> 00:17:38,510
we are using multi-threading we're
sporting

280
00:17:38,510 --> 00:17:41,640
out of the box hard for capture cards

281
00:17:41,640 --> 00:17:46,230
we're experimenting with you
acceleration

282
00:17:46,230 --> 00:17:49,670
the second thing is circa uses up
ultimate

283
00:17:49,670 --> 00:17:52,670
automatic protocol detection for
higher-level protocols

284
00:17:52,670 --> 00:17:56,460
just PSL go more into these

285
00:17:56,460 --> 00:17:59,690
effortlessly we support

286
00:17:59,690 --> 00:18:03,620
large IP blacklist there's a lot of
information out there in

287
00:18:03,620 --> 00:18:07,020
on the internet on IP addresses and the
IDS is

288
00:18:07,020 --> 00:18:10,600
is an interesting place to you to use it

289
00:18:10,600 --> 00:18:14,080
and we have very thorough

290
00:18:14,080 --> 00:18:18,760
its the inspection logging ACP's
obviously one of the more important

291
00:18:18,760 --> 00:18:22,590
protocols so multi-threading

292
00:18:22,590 --> 00:18:26,290
want to go radius well to you circa was
meant to make

293
00:18:26,290 --> 00:18:29,909
threaded the reasons probably for pretty
obvious

294
00:18:29,910 --> 00:18:33,320
your smartphone nowadays usually has a
dual-core

295
00:18:33,320 --> 00:18:37,050
your next might have a quad-core a

296
00:18:37,050 --> 00:18:40,320
server with two quad-core boxes and
hyper-threading

297
00:18:40,320 --> 00:18:44,120
which leads to 16 logical sea views

298
00:18:44,120 --> 00:18:48,780
are already quite to you intel has a 10
core CRM

299
00:18:48,780 --> 00:18:52,379
with with hyperthreading enabled its 20
threats

300
00:18:52,380 --> 00:18:56,150
AMD just 16 core Opteron and Tyler

301
00:18:56,150 --> 00:18:59,260
which not everyone might know has it

302
00:18:59,260 --> 00:19:02,570
CPU's with 64 and 100 course

303
00:19:02,570 --> 00:19:05,929
so using that is yes

304
00:19:05,930 --> 00:19:09,060
over trying to really exploiters hard

305
00:19:09,060 --> 00:19:13,030
hardware features is high on their list

306
00:19:13,030 --> 00:19:16,190
circa is a highly modular training
design

307
00:19:16,190 --> 00:19:19,670
which allows us to experimental up with
all kinds of

308
00:19:19,670 --> 00:19:23,200
trading configurations from a completely
single thread

309
00:19:23,200 --> 00:19:26,510
model where we just run one single
thread

310
00:19:26,510 --> 00:19:30,000
or to you many hundreds of threats

311
00:19:30,000 --> 00:19:33,270
there is a paper in which people

312
00:19:33,270 --> 00:19:37,120
esoteric how to end a somehow managed to
get it their hands on him

313
00:19:37,120 --> 00:19:41,080
box with 576 course in it

314
00:19:41,080 --> 00:19:45,320
ended worked with Cirque had just use
them all

315
00:19:45,320 --> 00:19:49,020
sadly day didn't really investigate the
scaling date this compared

316
00:19:49,020 --> 00:19:53,020
to snort which was an unfair comparison
they just ran one store

317
00:19:53,020 --> 00:19:56,370
one or but it was called

318
00:19:56,370 --> 00:19:59,990
just to see actually work

319
00:19:59,990 --> 00:20:03,730
so far from our experiment appears that
flow-based

320
00:20:03,730 --> 00:20:07,660
load balancing threats is performing the
best

321
00:20:07,660 --> 00:20:10,720
and we can do this with a single back
inputs

322
00:20:10,720 --> 00:20:14,960
searchers Lippi kept

323
00:20:14,960 --> 00:20:17,970
which tenders use it over all the other
threats for

324
00:20:17,970 --> 00:20:21,980
for the processing or weekend use

325
00:20:21,980 --> 00:20:25,540
for example the F ring i connect
acquisition and

326
00:20:25,540 --> 00:20:29,950
X expose multiple readers

327
00:20:29,950 --> 00:20:33,200
so we can have load balancing in the
kernel itself

328
00:20:33,200 --> 00:20:37,800
in userspace the next version we're
expecting to have the same

329
00:20:37,800 --> 00:20:41,700
support for days cards

330
00:20:41,700 --> 00:20:48,090
apathetic parts

331
00:20:48,090 --> 00:20:52,189
talking about capture card and

332
00:20:52,190 --> 00:20:56,080
nap attack are two were and this is
already working

333
00:20:56,080 --> 00:20:59,860
never take is what we're working on
currently to get integrated

334
00:20:59,860 --> 00:21:03,300
desire usually very expensive cards

335
00:21:03,300 --> 00:21:07,570
think they started ten to twenty
thousand euros or dollars

336
00:21:07,570 --> 00:21:10,629
sure but

337
00:21:10,630 --> 00:21:13,740
day are really required

338
00:21:13,740 --> 00:21:17,010
few want high-speed packet capture and

339
00:21:17,010 --> 00:21:21,070
in general what they do is have YouTube
offers to you

340
00:21:21,070 --> 00:21:24,780
to minimize packet loss all kinds of
things

341
00:21:24,780 --> 00:21:28,080
so not everyone has a deep pockets for
those cards so

342
00:21:28,080 --> 00:21:31,080
the F ring performance

343
00:21:31,080 --> 00:21:35,550
equivalent it works all kinds of
hardware but has a special support for

344
00:21:35,550 --> 00:21:37,030
certain types of

345
00:21:37,030 --> 00:21:43,430
network cards

346
00:21:43,430 --> 00:21:47,110
you generation like to mention we're

347
00:21:47,110 --> 00:21:53,110
experimenting with this it and markedly
using to create a framework for it

348
00:21:53,110 --> 00:21:57,100
the dick potential

349
00:21:57,100 --> 00:22:00,270
the chief you is very appealing it's
very very fast in

350
00:22:00,270 --> 00:22:03,530
if you missed you

351
00:22:03,530 --> 00:22:07,180
get it operated right

352
00:22:07,180 --> 00:22:11,030
but it turns out to be lot harder than
we anticipated

353
00:22:11,030 --> 00:22:15,129
and hope so we have an implementation
and it does work

354
00:22:15,130 --> 00:22:18,280
however it is slower than our CPU
implementation with

355
00:22:18,280 --> 00:22:23,160
kind of defeats its purpose so where
actually in touch with video

356
00:22:23,160 --> 00:22:29,330
to train improve things and

357
00:22:29,330 --> 00:22:34,000
open cialis is is one of the things we
want to be looking at

358
00:22:34,000 --> 00:22:37,440
& Co's the the platform independence

359
00:22:37,440 --> 00:22:41,930
grew to like API

360
00:22:41,930 --> 00:22:46,640
it is supported by MD for example as
well with the ATI cards

361
00:22:46,640 --> 00:22:49,960
and Intel even has some support for it

362
00:22:49,960 --> 00:22:53,580
and just yesterday and and some still

363
00:22:53,580 --> 00:22:57,120
little bit fake birthday in style not
some

364
00:22:57,120 --> 00:23:00,970
if you like hardware that's supposed to
be like

365
00:23:00,970 --> 00:23:05,580
like that deep you

366
00:23:05,580 --> 00:23:09,020
did is supposed to be

367
00:23:09,020 --> 00:23:12,830
working like like with open CO or could
I think

368
00:23:12,830 --> 00:23:15,970
and its has like 50 course or more

369
00:23:15,970 --> 00:23:19,600
and but it's still little thing but
there's a lot of movement in this area

370
00:23:19,600 --> 00:23:23,910
where you would offload certain tar
types

371
00:23:23,910 --> 00:23:27,440
operations to specific hardware but

372
00:23:27,440 --> 00:23:34,440
programming is it is quite heart

373
00:23:38,500 --> 00:23:42,890
so one of the features I mention was
high level protocol detection

374
00:23:42,890 --> 00:23:46,260
and says been especially helpful in
detecting

375
00:23:46,260 --> 00:23:50,140
well where the idea is that we have
special code

376
00:23:50,140 --> 00:23:54,190
that allows us to detect a protocol on

377
00:23:54,190 --> 00:23:57,570
independent sports and for example

378
00:23:57,570 --> 00:24:00,770
previously you would have a rule and
snort that

379
00:24:00,770 --> 00:24:05,120
would probably look something like this:
with

380
00:24:05,120 --> 00:24:08,250
if you would be looking at XP traffic

381
00:24:08,250 --> 00:24:12,010
so it's be SB ports the variable hear
dat

382
00:24:12,010 --> 00:24:16,280
controls with which or we would be
looking usually set to something like

383
00:24:16,280 --> 00:24:19,350
80 81 a few others but

384
00:24:19,350 --> 00:24:22,470
if you would be out of luck if the

385
00:24:22,470 --> 00:24:27,470
malware or whatever your matching
against is on a different port

386
00:24:27,470 --> 00:24:32,040
so what we're we have extended the
language to you

387
00:24:32,040 --> 00:24:35,540
be able to say alert on its DP which

388
00:24:35,540 --> 00:24:39,620
means we'll be relying on our radical
detection

389
00:24:39,620 --> 00:24:43,730
and detecting can be a any for

390
00:24:43,730 --> 00:24:48,440
is a sec this is actually helps
especially malware detection

391
00:24:48,440 --> 00:24:53,200
enormously because a lot of malware uses

392
00:24:53,200 --> 00:24:57,990
a city traffic for commander control and
they often use of courts

393
00:24:57,990 --> 00:25:01,620
so non standard ports and we've seen
much

394
00:25:01,620 --> 00:25:08,620
much better detection rates because this

395
00:25:10,660 --> 00:25:14,650
high-speed IP matching is one of the
things I mentioned

396
00:25:14,650 --> 00:25:18,670
you know the emerging threats project
they have enormous lists of

397
00:25:18,670 --> 00:25:22,410
known that IP address is compromised
suspected

398
00:25:22,410 --> 00:25:26,040
Russian business network all kinds of
things

399
00:25:26,040 --> 00:25:29,730
and previously you could you had to
choose between a few

400
00:25:29,730 --> 00:25:34,600
up to those rule sets to be really

401
00:25:34,600 --> 00:25:38,000
using me you know performance efficient
way

402
00:25:38,000 --> 00:25:41,940
so we have created special module in our
code to you

403
00:25:41,940 --> 00:25:45,830
just be able to low the mall and

404
00:25:45,830 --> 00:25:50,639
get alerted or drop even

405
00:25:50,640 --> 00:25:55,350
the hosts if one of your hosts contact
contacting such a

406
00:25:55,350 --> 00:26:01,130
blacklisted up

407
00:26:01,130 --> 00:26:08,130
this is all a software yes

408
00:26:11,310 --> 00:26:13,429
like already mentioned RHCP

409
00:26:13,430 --> 00:26:16,500
parsing is now with live 8 CP

410
00:26:16,500 --> 00:26:19,620
library written by every stitch who is

411
00:26:19,620 --> 00:26:24,640
you out there about security in
currently working on Iran be another

412
00:26:24,640 --> 00:26:28,030
were were web publication viable so

413
00:26:28,030 --> 00:26:32,310
because a city is so important we
figured we'd get help from someone that

414
00:26:32,310 --> 00:26:33,510
really really knows

415
00:26:33,510 --> 00:26:36,730
what he's doing ACP so this is a library

416
00:26:36,730 --> 00:26:39,800
wrote for us constructs a

417
00:26:39,800 --> 00:26:42,990
full state up the ACP session

418
00:26:42,990 --> 00:26:47,070
that we constantly updated can't recall
transactions

419
00:26:47,070 --> 00:26:50,669
and it allows us to do for example file
extraction

420
00:26:50,670 --> 00:26:54,820
I'll get into that later lib ACP

421
00:26:54,820 --> 00:26:57,879
is available outside of circus to peel

422
00:26:57,880 --> 00:27:02,810
licensed Liberian dollar versions and
newer versions are even Apache License

423
00:27:02,810 --> 00:27:03,460
owns

424
00:27:03,460 --> 00:27:07,510
even more liberal to integrate into any
tool you want

425
00:27:07,510 --> 00:27:12,020
and

426
00:27:12,020 --> 00:27:15,160
wanna things we do with it is a simple
request lover

427
00:27:15,160 --> 00:27:18,360
that for example should be

428
00:27:18,360 --> 00:27:21,420
an example here so the

429
00:27:21,420 --> 00:27:24,420
this is on a single line normally

430
00:27:24,420 --> 00:27:28,110
it's a simple log that's kinda
resembling the information

431
00:27:28,110 --> 00:27:31,700
an Apache access log for example has
just

432
00:27:31,700 --> 00:27:36,390
shows that for everything its quite
useful to see what's going on in your

433
00:27:36,390 --> 00:27:36,870
network

434
00:27:36,870 --> 00:27:41,290
eric's

435
00:27:41,290 --> 00:27:46,860
next hello

436
00:27:46,860 --> 00:27:51,410
compared to present you to disappoint
Srikanta and

437
00:27:51,410 --> 00:27:55,390
tunis as Russian by vetoes on the
petition

438
00:27:55,390 --> 00:28:00,400
your which is supported by sorry to top
in a position to us too interesting

439
00:28:00,400 --> 00:28:01,150
features

440
00:28:01,150 --> 00:28:04,810
she's Department of Sport because I
automatic detection

441
00:28:04,810 --> 00:28:07,919
on just button mashing to find occur

442
00:28:07,920 --> 00:28:11,400
and this weekend do not for

443
00:28:11,400 --> 00:28:15,780
on jus the dedicated care world but we
can use too much

444
00:28:15,780 --> 00:28:18,790
specific part of packet

445
00:28:18,790 --> 00:28:24,020
file are in the city we've got it a key
was too much

446
00:28:24,020 --> 00:28:28,300
you worry all too much cookies and
missus

447
00:28:28,300 --> 00:28:31,900
the same for to this report which has

448
00:28:31,900 --> 00:28:34,930
some keywords is risk it was a

449
00:28:34,930 --> 00:28:37,990
we can be used inning chinensis

450
00:28:37,990 --> 00:28:42,960
Pacifica to addition was composed of
magical progress can see

451
00:28:42,960 --> 00:28:46,300
on the slide watches

452
00:28:46,300 --> 00:28:49,810
2s supporting circuit that shit terrace

453
00:28:49,810 --> 00:28:54,570
on shake rosso would you not date reaped
truckee just analyzed are shaped by

454
00:28:54,570 --> 00:29:00,610
pitching every packet and checking every
message indicating every message to be

455
00:29:00,610 --> 00:29:01,430
able to know

456
00:29:01,430 --> 00:29:05,160
we ship it to pick a stock exchange
which perimeters

457
00:29:05,160 --> 00:29:08,330
agree I use to in

458
00:29:08,330 --> 00:29:15,100
assisted listening position we decide to

459
00:29:15,100 --> 00:29:18,310
2g a own security

460
00:29:18,310 --> 00:29:23,110
noted Prosser for mysterious shake the
point was not to use

461
00:29:23,110 --> 00:29:27,910
up unnecessary directly necessary to
repeat we want to be able to

462
00:29:27,910 --> 00:29:32,560
occurred to tested to be a book like you
talked with it

463
00:29:32,560 --> 00:29:36,159
for the opportu to have some event

464
00:29:36,160 --> 00:29:40,340
with it too and early detection
Palatinate

465
00:29:40,340 --> 00:29:44,490
to level on cover down this occurred as
being

466
00:29:44,490 --> 00:29:47,840
developed from scratch by ship for you
which is working from

467
00:29:47,840 --> 00:29:50,920
I this issue should finish work on six
which has a/c

468
00:29:50,920 --> 00:29:54,430
and yet

469
00:29:54,430 --> 00:29:57,600
repeat with security in mind first pets
yes

470
00:29:57,600 --> 00:30:01,250
make some legit some although critics I
miss somebody to

471
00:30:01,250 --> 00:30:04,560
on this first occurred to me about to

472
00:30:04,560 --> 00:30:09,070
to buried date kiwi fruit resist to

473
00:30:09,070 --> 00:30:14,510
attack of like that but

474
00:30:14,510 --> 00:30:18,270
what can we do with weakness

475
00:30:18,270 --> 00:30:21,690
to this report first thing is the same

476
00:30:21,690 --> 00:30:25,250
thing that to show you in a shitty p you
can just say

477
00:30:25,250 --> 00:30:29,120
I left on TDs instead of saying

478
00:30:29,120 --> 00:30:32,910
at F-twenty CP which would give you some
very

479
00:30:32,910 --> 00:30:36,340
advantages because in the default
anymore

480
00:30:36,340 --> 00:30:40,180
a.m. I people with us don't specifically
any port

481
00:30:40,180 --> 00:30:44,540
need DTC Parkway samper and this way

482
00:30:44,540 --> 00:30:47,700
you you just can't mall through

483
00:30:47,700 --> 00:30:51,990
Studi might give us a whole list can
detect and identify as a pushover

484
00:30:51,990 --> 00:30:56,440
control and cologne channel which is
done on some units were port

485
00:30:56,440 --> 00:31:00,490
are using to test you can detect it I'll
for example today some

486
00:31:00,490 --> 00:31:04,460
generous certificate but I used but you
want to block

487
00:31:04,460 --> 00:31:07,840
whenever advantages

488
00:31:07,840 --> 00:31:10,890
a using precipitation you know is that

489
00:31:10,890 --> 00:31:14,760
you'll limit the last to the current
political

490
00:31:14,760 --> 00:31:18,410
you don't try to to do so pattern
matching

491
00:31:18,410 --> 00:31:21,680
some been a mystery if it's not to this

492
00:31:21,680 --> 00:31:25,780
you could ever match was a powerful much
from something like 5

493
00:31:25,780 --> 00:31:29,090
a like we have in the produce

494
00:31:29,090 --> 00:31:32,270
talking about yes Asian a

495
00:31:32,270 --> 00:31:35,290
UN is it too much but you should check

496
00:31:35,290 --> 00:31:38,600
this puzzle on some juice butter

497
00:31:38,600 --> 00:31:41,670
having five would be very strange

498
00:31:41,670 --> 00:31:44,860
and by doing this we just

499
00:31:44,860 --> 00:31:48,670
run Senate rules I'll the good for the
girl

500
00:31:48,670 --> 00:31:52,440
which means that we know it's way too
analyzed fresh each

501
00:31:52,440 --> 00:31:55,650
a none

502
00:31:55,650 --> 00:31:59,150
a all like it but just on I can't
believe the correct protocol

503
00:31:59,150 --> 00:32:03,100
doing this you'll meet the number of
packets allies we've signatures

504
00:32:03,100 --> 00:32:07,290
on bus which was a performance away this
on as you know

505
00:32:07,290 --> 00:32:11,450
the phosphatases when important

506
00:32:11,450 --> 00:32:15,350
what are the trunk too well supported by
tear this

507
00:32:15,350 --> 00:32:19,510
we've got to discussion which bus were
put to a special

508
00:32:19,510 --> 00:32:23,950
using then shake that the subject with
you which is doing is trying much in the

509
00:32:23,950 --> 00:32:24,460
city

510
00:32:24,460 --> 00:32:28,170
subject got terrorists wielding

511
00:32:28,170 --> 00:32:32,040
which I'll dunno used on a string much

512
00:32:32,040 --> 00:32:35,750
I'll such get situated got more to come

513
00:32:35,750 --> 00:32:39,100
she's grown to work in progress and

514
00:32:39,100 --> 00:32:44,190
which is good evolution every discovery
pollution data

515
00:32:44,190 --> 00:32:47,440
what what we can we do we but for
example

516
00:32:47,440 --> 00:32:51,730
lets up us classical I'll

517
00:32:51,730 --> 00:32:55,510
sittings with company running some solos

518
00:32:55,510 --> 00:32:58,970
I'll having its own official BK should
as

519
00:32:58,970 --> 00:33:02,400
Isla Fisher pick a every certificate

520
00:33:02,400 --> 00:33:06,230
fall also was up to be sign with this
pick a

521
00:33:06,230 --> 00:33:10,020
if we don't have that we have something
rug but has been deployed

522
00:33:10,020 --> 00:33:13,760
on the network his own and mister talk
about us not put the corset

523
00:33:13,760 --> 00:33:16,860
get we should have in our database or
loss

524
00:33:16,860 --> 00:33:21,190
she's achille Westport some sometimes
some

525
00:33:21,190 --> 00:33:24,480
some some ice that which should be
stopped

526
00:33:24,480 --> 00:33:29,480
to do so sleazy we just

527
00:33:29,480 --> 00:33:32,880
which is to annihilate we've put it in
his protocol

528
00:33:32,880 --> 00:33:36,700
where do these for any flow and
direction to also follows

529
00:33:36,700 --> 00:33:39,830
dole also those for you my neighbor am

530
00:33:39,830 --> 00:33:44,230
the match is done if the use or do in
above

531
00:33:44,230 --> 00:33:47,750
others news just certificate is not well
one window

532
00:33:47,750 --> 00:33:51,190
is perceived bus that's mean a
certificate which is useful but

533
00:33:51,190 --> 00:33:54,620
status shake is not something that has
been made but all

534
00:33:54,620 --> 00:33:58,010
owns certificate authority she's

535
00:33:58,010 --> 00:34:01,310
simple to write just have to know we're
such a dirty

536
00:34:01,310 --> 00:34:06,010
got summary security features but is
provided by this

537
00:34:06,010 --> 00:34:09,260
system

538
00:34:09,260 --> 00:34:13,530
buys other example that can be provided

539
00:34:13,530 --> 00:34:17,140
this one is one of them mean much
efficient be doing

540
00:34:17,139 --> 00:34:20,290
said on to this report is to detective

541
00:34:20,290 --> 00:34:24,080
miss much between the certificate
provided

542
00:34:24,080 --> 00:34:28,580
under such a total a key west may be
substituted

543
00:34:28,580 --> 00:34:32,199
for example it is well known that good
come

544
00:34:32,200 --> 00:34:36,629
is sin by Google internet to 2g should
not sign but do you know to

545
00:34:36,629 --> 00:34:40,250
sorry for that and

546
00:34:40,250 --> 00:34:43,668
if we did take this is something you
really bad this weekend

547
00:34:43,668 --> 00:34:46,719
the past month highs on for make and

548
00:34:46,720 --> 00:34:50,850
see you choose should drop not left
brooklyn global packet

549
00:34:50,850 --> 00:34:55,199
if in your folks connect to something
but she's

550
00:34:55,200 --> 00:34:59,640
in this subject good cook but which is
in fact

551
00:34:59,640 --> 00:35:02,859
not sign civics this discussion

552
00:35:02,859 --> 00:35:06,220
much before davis wanted just outside

553
00:35:06,220 --> 00:35:09,690
go certificate authority in this case
would love the packet

554
00:35:09,690 --> 00:35:13,260
a good connection but we knew it not be

555
00:35:13,260 --> 00:35:16,890
you will be able to check but you such a
key test but you'll

556
00:35:16,890 --> 00:35:19,970
play on to decide on it hoping that
connect outside to

557
00:35:19,970 --> 00:35:24,300
a hoax overselling invited good outcome
certificate

558
00:35:24,300 --> 00:35:29,050
sorry use for fishing of you think that

559
00:35:29,050 --> 00:35:32,490
met I felt sorry for this weekend event

560
00:35:32,490 --> 00:35:35,820
Turpin has been Act two a certificate
which has been act

561
00:35:35,820 --> 00:35:39,740
and this football for that weekend as we
are doing something mention

562
00:35:39,740 --> 00:35:43,510
can do it more country say okay device
you are doing

563
00:35:43,510 --> 00:35:48,170
is something coming from 1800 I want to
look the picket

564
00:35:48,170 --> 00:35:52,120
okay I don't become a phishing
protection but which bed I think I some

565
00:35:52,120 --> 00:35:56,390
certificate to touch it

566
00:35:56,390 --> 00:36:00,410
okay the which friends some to
intimidation

567
00:36:00,410 --> 00:36:03,740
on the obvious to this report for
example we're just

568
00:36:03,740 --> 00:36:07,990
much do much just just not going to
mention the first certificate with you

569
00:36:07,990 --> 00:36:08,790
not

570
00:36:08,790 --> 00:36:11,830
a well not able to do much in

571
00:36:11,830 --> 00:36:14,880
were such a change because you got us so

572
00:36:14,880 --> 00:36:19,890
gonna have some skate which emerges a
soup certificate authority

573
00:36:19,890 --> 00:36:23,720
but she's already processed by the
paperback am

574
00:36:23,720 --> 00:36:27,410
was just missing is a on is working
world's

575
00:36:27,410 --> 00:36:30,740
and the some tech solution it shows the
switch

576
00:36:30,740 --> 00:36:33,960
should I have miss morrison available a

577
00:36:33,960 --> 00:36:37,990
the same thing is is true for some key
was assessed in missing

578
00:36:37,990 --> 00:36:41,990
for example we can shake the
cryptographic algorithm

579
00:36:41,990 --> 00:36:45,420
which is use to to do but a less

580
00:36:45,420 --> 00:36:48,840
to to use the in tennis but

581
00:36:48,840 --> 00:36:52,300
but she's can be a useful for example
you've got to attack

582
00:36:52,300 --> 00:36:55,859
by a ratio which is being discussed

583
00:36:55,859 --> 00:36:58,980
lately and each way it was a

584
00:36:58,980 --> 00:37:03,030
working well made emerging protocol on
some windows

585
00:37:03,030 --> 00:37:06,380
by using a virus and with

586
00:37:06,380 --> 00:37:10,930
by doing this weekend we could shake but
protocol are not being done with it from

587
00:37:10,930 --> 00:37:11,810
what we what

588
00:37:11,810 --> 00:37:15,109
what we expect a secret ceremony in the
political used

589
00:37:15,109 --> 00:37:19,049
all I can do the same with guess size
which is related to a security

590
00:37:19,050 --> 00:37:23,740
to YouTube in

591
00:37:23,740 --> 00:37:26,910
a perfect iraqi and the different
parameters

592
00:37:26,910 --> 00:37:30,430
on this less point in assistantship Otis

593
00:37:30,430 --> 00:37:35,759
to some statistical study for example
being about whether I shove certificate

594
00:37:35,760 --> 00:37:38,780
but we we detect when you change

595
00:37:38,780 --> 00:37:41,900
but between permit

596
00:37:41,900 --> 00:37:45,460
snow to depends on especially towards
that

597
00:37:45,460 --> 00:37:52,460
look at that time by Google not come a
certificate authority

598
00:37:55,140 --> 00:38:02,140
expecting

599
00:38:11,800 --> 00:38:12,410
section

600
00:38:12,410 --> 00:38:18,319
is what we're currently working on in

601
00:38:18,320 --> 00:38:21,370
my opinion very exciting future

602
00:38:21,370 --> 00:38:24,460
although we have limited to STP
currently

603
00:38:24,460 --> 00:38:28,430
working SMTP as well the idea is pretty
simple

604
00:38:28,430 --> 00:38:32,529
we check DTC today ACP sessions in a
very detailed

605
00:38:32,530 --> 00:38:36,030
way so if their is a file download or
upload

606
00:38:36,030 --> 00:38:39,740
we pretty much know exactly where it is
in the stream

607
00:38:39,740 --> 00:38:46,740
so lineup extracted weekend xx from get
requests for example but also from

608
00:38:47,170 --> 00:38:52,100
both question but request a

609
00:38:52,100 --> 00:38:56,930
skid

610
00:38:56,930 --> 00:39:01,129
so what we can do is

611
00:39:01,130 --> 00:39:05,530
just pretty much threw up the files into
a directory

612
00:39:05,530 --> 00:39:08,960
and we put in a little metafile which

613
00:39:08,960 --> 00:39:12,180
has a more information about it I'll
show that later

614
00:39:12,180 --> 00:39:16,350
but dropping it into a directory

615
00:39:16,350 --> 00:39:20,920
will enable you to you have third-party
tools like an anti-virus

616
00:39:20,920 --> 00:39:24,420
or you could check md5 checksum

617
00:39:24,420 --> 00:39:27,650
where you can to check you could send it
to some said

618
00:39:27,650 --> 00:39:30,960
or something Iran malware if it's
inexcusable

619
00:39:30,960 --> 00:39:35,000
so it will allow you to

620
00:39:35,000 --> 00:39:39,840
easily do more detection you

621
00:39:39,840 --> 00:39:43,600
would with just looking at network
traffic itself

622
00:39:43,600 --> 00:39:48,670
but we didn't wouldn't stop there we
really only started because

623
00:39:48,670 --> 00:39:52,520
the interesting thing for me at least is
where

624
00:39:52,520 --> 00:39:56,000
magic comes in a medic is not

625
00:39:56,000 --> 00:39:59,700
real magic of course but it's you slip
magic

626
00:39:59,700 --> 00:40:03,220
to determine file types live magic

627
00:40:03,220 --> 00:40:07,120
my own know it or you might not know
that you know it's what powers the file

628
00:40:07,120 --> 00:40:07,839
command

629
00:40:07,840 --> 00:40:13,450
in UNIX or Linux it it is commanded you
can use to determine almost any file

630
00:40:13,450 --> 00:40:14,240
type

631
00:40:14,240 --> 00:40:18,660
see what it is to

632
00:40:18,660 --> 00:40:22,190
to really get to the power of this unit

633
00:40:22,190 --> 00:40:25,590
we need to do Royce engines ruling which
is

634
00:40:25,590 --> 00:40:32,090
tensions and world discuss next little
bit about search out a ruling which

635
00:40:32,090 --> 00:40:35,200
it's a subset superset up to start
language

636
00:40:35,200 --> 00:40:39,080
we left out all kinds of things nobody
uses no

637
00:40:39,080 --> 00:40:43,440
rules at actually uses and we added some
new things like to TLS work

638
00:40:43,440 --> 00:40:47,160
and like the section things

639
00:40:47,160 --> 00:40:50,160
holding talking about well this is

640
00:40:50,160 --> 00:40:53,470
very simple snort rule there's

641
00:40:53,470 --> 00:40:57,700
has been a few in Eric's examples
already saw

642
00:40:57,700 --> 00:41:01,040
skip that part soda

643
00:41:01,040 --> 00:41:05,220
rule extensions for

644
00:41:05,220 --> 00:41:09,700
file magic for fast search in the first
one is

645
00:41:09,700 --> 00:41:14,100
file magic and what it does it sense
file

646
00:41:14,100 --> 00:41:17,270
or the file is interpreted with

647
00:41:17,270 --> 00:41:20,400
live magic live magic will tell us in a
string

648
00:41:20,400 --> 00:41:24,960
what the type of file is and for example
we will tell us that

649
00:41:24,960 --> 00:41:27,970
file is inexcusable for MS Windows and

650
00:41:27,970 --> 00:41:31,130
you could create a rule like this that i
won

651
00:41:31,130 --> 00:41:37,220
want to see an alert if we see a Windows
don't

652
00:41:37,220 --> 00:41:40,760
the next option is file store command
for

653
00:41:40,760 --> 00:41:44,070
file store keyword and it will do
nothing

654
00:41:44,070 --> 00:41:47,480
for detection will only say if the rule
actually matches

655
00:41:47,480 --> 00:41:50,920
story filed today s we can inspect it
for dare

656
00:41:50,920 --> 00:41:57,430
outside of circa the third

657
00:41:57,430 --> 00:42:00,589
rule keyword is the file ext

658
00:42:00,590 --> 00:42:04,610
keyword and its very simple just matches
on

659
00:42:04,610 --> 00:42:08,060
extension that is claimed a

660
00:42:08,060 --> 00:42:12,140
into request so you download a file or
you upload the file you give up

661
00:42:12,140 --> 00:42:16,259
file name: it might not match

662
00:42:16,260 --> 00:42:19,750
the actual file type: and this is what
you can see here in the rule

663
00:42:19,750 --> 00:42:23,070
we we match on a file that has a deep

664
00:42:23,070 --> 00:42:27,100
jpg extension so we expected defect file

665
00:42:27,100 --> 00:42:30,100
but into well magic you see

666
00:42:30,100 --> 00:42:33,180
with the exclamation mark that the
roulette is

667
00:42:33,180 --> 00:42:37,290
if it's not actually it jpg file and

668
00:42:37,290 --> 00:42:42,350
this as very useful use cases I think

669
00:42:42,350 --> 00:42:46,630
finally we also add a file name which is
just simple

670
00:42:46,630 --> 00:42:51,540
a simple file name it so if you have
some kind of naming scheme where

671
00:42:51,540 --> 00:42:55,150
everything does secret has secrets in it
in its name then

672
00:42:55,150 --> 00:42:59,770
you could match on it here so

673
00:42:59,770 --> 00:43:03,050
a real example so you have a web server
and

674
00:43:03,050 --> 00:43:07,730
you only accept PDF applies to it and
your user interface make sure that

675
00:43:07,730 --> 00:43:11,690
normal users will not be sending in PDS

676
00:43:11,690 --> 00:43:15,550
so if if you would see in file that's
not a PDF

677
00:43:15,550 --> 00:43:19,700
that a blow that someone is by passing
your user interface and trying

678
00:43:19,700 --> 00:43:24,790
something funny well you can see

679
00:43:24,790 --> 00:43:28,759
a more detailed rule on how we would
prevent or alert on that

680
00:43:28,760 --> 00:43:31,890
so we have a rule that is on a sleepy

681
00:43:31,890 --> 00:43:35,680
it comes in from the outside world to
our web server

682
00:43:35,680 --> 00:43:39,230
it is to the server posts

683
00:43:39,230 --> 00:43:42,350
re both request in STP its to uploader

684
00:43:42,350 --> 00:43:46,970
PhD and if I was not a PDF documents

685
00:43:46,970 --> 00:43:51,290
we alert and we store to file for it
further inspection

686
00:43:51,290 --> 00:43:55,420
as an extra check I also created the
same rule

687
00:43:55,420 --> 00:43:58,650
but they're not on the file type but on
the file extension so if the file

688
00:43:58,650 --> 00:44:00,530
extension is not PDF

689
00:44:00,530 --> 00:44:05,450
and something is going on as well

690
00:44:05,450 --> 00:44:11,000
another example I think you would want
to know if your private keys are

691
00:44:11,000 --> 00:44:14,790
being upload or download somewhere by
accident

692
00:44:14,790 --> 00:44:17,790
so this will match on it are as a
private key

693
00:44:17,790 --> 00:44:22,340
you could even leave out Dr is a are and
it will mention any type of private key

694
00:44:22,340 --> 00:44:23,150
if

695
00:44:23,150 --> 00:44:26,710
you would have on

696
00:44:26,710 --> 00:44:30,530
you could also of course toward this
file and if it's not yours

697
00:44:30,530 --> 00:44:34,120
you now have it what's can be used for
interesting things

698
00:44:34,120 --> 00:44:37,299
but thats

699
00:44:37,300 --> 00:44:42,290
that's for you to decide so one final
example here

700
00:44:42,290 --> 00:44:46,190
my girlfriends user photographer

701
00:44:46,190 --> 00:44:49,880
and art photo foot curvy artists

702
00:44:49,880 --> 00:44:53,780
ever and she has a Canon cameras uses
the RAW format for

703
00:44:53,780 --> 00:44:57,880
pop top quality of the files but you
will never she never wants to send those

704
00:44:57,880 --> 00:44:59,070
to anyone

705
00:44:59,070 --> 00:45:02,310
she wants a princes and another file
type:

706
00:45:02,310 --> 00:45:06,400
or if he has a modification over files
in Photoshop

707
00:45:06,400 --> 00:45:10,300
she will never want to use said anyone
Photoshop file but

708
00:45:10,300 --> 00:45:14,730
a simpler file because if photography
the number of prints that are

709
00:45:14,730 --> 00:45:18,230
publicly available really determines the
price level of your

710
00:45:18,230 --> 00:45:22,040
photos so its is really your secret

711
00:45:22,040 --> 00:45:25,770
secret source files kinda so this would
be to you

712
00:45:25,770 --> 00:45:31,560
rules that would drop any outgoing

713
00:45:31,560 --> 00:45:35,400
uploads for Canon raw files

714
00:45:35,400 --> 00:45:39,620
or for Photoshop images and I'm still
trying to convince her to use game

715
00:45:39,620 --> 00:45:46,509
and a game forgives you would have a
similar rule

716
00:45:46,510 --> 00:45:51,250
so the files stored to disk it's just
dumb thing is simple directory

717
00:45:51,250 --> 00:45:54,500
with a metafile the metafile looks
pretty much like this you have a

718
00:45:54,500 --> 00:45:55,790
timestamp

719
00:45:55,790 --> 00:46:00,509
a source appease et cetera and file name
as it was claimed

720
00:46:00,510 --> 00:46:04,630
it in the request and a magic which is
in this case

721
00:46:04,630 --> 00:46:07,920
inexcusable for Windows a

722
00:46:07,920 --> 00:46:13,430
and the file size is also interesting

723
00:46:13,430 --> 00:46:16,580
we have some limitations currently its
work in progress code I

724
00:46:16,580 --> 00:46:19,859
I meant to you haven't committed to
publicly available get

725
00:46:19,859 --> 00:46:23,359
three but just fail to do that

726
00:46:23,359 --> 00:46:27,299
so it should be they're probably next
week limitations obviously protocols

727
00:46:27,300 --> 00:46:28,570
only a sleepy now

728
00:46:28,570 --> 00:46:31,840
and later SMTP we have no plans for
other

729
00:46:31,840 --> 00:46:35,710
articles yet storage limits currently

730
00:46:35,710 --> 00:46:38,920
II Rep large test and doing it

731
00:46:38,920 --> 00:46:42,440
thousand files on my desk which is kinda
too much

732
00:46:42,440 --> 00:46:46,330
even if you want to delete them and
Microsoft is making things hard for us

733
00:46:46,330 --> 00:46:48,690
because most files have

734
00:46:48,690 --> 00:46:53,120
them their magic on this started to file
where you can determine what files

735
00:46:53,120 --> 00:46:56,750
but Microsoft Office files you can
recognize them

736
00:46:56,750 --> 00:47:01,250
decided to file but whether or not it's
a Word or Excel or whatever file is

737
00:47:01,250 --> 00:47:06,670
on the end of the file which makes
inspecting is very hard

738
00:47:06,670 --> 00:47:10,760
I'll wrapping up are development cycle
is

739
00:47:10,760 --> 00:47:14,430
but to monthly we just had a release
last week

740
00:47:14,430 --> 00:47:17,740
our next one will be probably in January
a

741
00:47:17,740 --> 00:47:21,320
the development priorities are
determined on public brainstorm sessions

742
00:47:21,320 --> 00:47:24,190
where everyone can come and have their
say

743
00:47:24,190 --> 00:47:27,460
last one was it rate in September and

744
00:47:27,460 --> 00:47:31,260
before that ours a San Francisco with a
public road map

745
00:47:31,260 --> 00:47:36,339
doctor kerr et cetera to you so you can
see what we're working on

746
00:47:36,339 --> 00:47:40,690
if you're interested you can you at vice
you to use the source but you can also

747
00:47:40,690 --> 00:47:42,030
use Debian you been to

748
00:47:42,030 --> 00:47:45,910
for Dora although the persons are
slightly outdated or you can use a more

749
00:47:45,910 --> 00:47:47,310
specific security

750
00:47:47,310 --> 00:47:51,660
union or so thick distribution

751
00:47:51,660 --> 00:47:55,000
thank you for your attention I'd be
happy to answer any question

