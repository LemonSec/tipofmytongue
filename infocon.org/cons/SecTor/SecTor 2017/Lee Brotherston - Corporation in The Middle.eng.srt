1
00:00:04,570 --> 00:00:11,080
my name is<font color="#E5E5E5"> Libra Thurston</font><font color="#CCCCCC"> and this is my</font>

2
00:00:07,600 --> 00:00:12,820
talk corporation in<font color="#E5E5E5"> the middle by trade</font>

3
00:00:11,080 --> 00:00:15,549
I'm a security<font color="#E5E5E5"> person I'm a consultant</font>

4
00:00:12,820 --> 00:00:19,530
at Leviathan security and in the evening

5
00:00:15,549 --> 00:00:22,000
I<font color="#E5E5E5"> upset my isp by doing things like this</font>

6
00:00:19,530 --> 00:00:24,550
this talk is<font color="#E5E5E5"> really spawned from me</font>

7
00:00:22,000 --> 00:00:27,880
noticing a quite minor piece of man in

8
00:00:24,550 --> 00:00:30,279
the middle going on on my account by my

9
00:00:27,880 --> 00:00:31,929
<font color="#CCCCCC">ISP and then I dug further and further</font>

10
00:00:30,279 --> 00:00:34,210
<font color="#E5E5E5">and kept finding more and more data and</font>

11
00:00:31,929 --> 00:00:36,280
digging more until the point that it

12
00:00:34,210 --> 00:00:38,739
grew<font color="#CCCCCC"> into talk so that's kind of where</font>

13
00:00:36,280 --> 00:00:40,210
this came from if you don't have the

14
00:00:38,739 --> 00:00:43,899
same<font color="#E5E5E5"> ISP as me that</font><font color="#CCCCCC"> doesn't really</font>

15
00:00:40,210 --> 00:00:45,640
matter because a lot of this is generic

16
00:00:43,899 --> 00:00:49,870
if you<font color="#E5E5E5"> think you've</font><font color="#CCCCCC"> been man in the</font>

17
00:00:45,640 --> 00:00:52,480
<font color="#E5E5E5">middle by your isp by an employer if you</font>

18
00:00:49,870 --> 00:00:54,399
are under<font color="#E5E5E5"> attack from some government</font>

19
00:00:52,480 --> 00:00:56,410
you<font color="#E5E5E5"> know a lot of the principles remain</font>

20
00:00:54,399 --> 00:00:58,120
the same although<font color="#CCCCCC"> i wouldn't take this</font>

21
00:00:56,410 --> 00:00:59,769
as the complete way to protect yourself

22
00:00:58,120 --> 00:01:02,050
against the state-sponsored attack by

23
00:00:59,769 --> 00:01:04,750
any means some<font color="#E5E5E5"> of the techniques</font>

24
00:01:02,050 --> 00:01:07,000
described in<font color="#E5E5E5"> this are the same or very</font>

25
00:01:04,750 --> 00:01:09,189
similar to<font color="#E5E5E5"> those described in fin fly</font>

26
00:01:07,000 --> 00:01:10,479
and some of the ones that Snowden

27
00:01:09,189 --> 00:01:12,880
uncovered some of these signals

28
00:01:10,479 --> 00:01:13,900
intelligence agencies using again I'm

29
00:01:12,880 --> 00:01:16,720
sure<font color="#CCCCCC"> they're using something more</font>

30
00:01:13,900 --> 00:01:18,670
advanced as well but you know just<font color="#CCCCCC"> for</font>

31
00:01:16,720 --> 00:01:20,770
context and why it might be<font color="#E5E5E5"> relevant and</font>

32
00:01:18,670 --> 00:01:22,689
one disclaimer in case you didn't notice

33
00:01:20,770 --> 00:01:24,490
I'm British so I will repeatedly say

34
00:01:22,689 --> 00:01:26,880
<font color="#CCCCCC">route or not router just so you can</font>

35
00:01:24,490 --> 00:01:30,070
mentally translate that for yourselves

36
00:01:26,880 --> 00:01:32,649
so wise man in the<font color="#E5E5E5"> middle interesting</font>

37
00:01:30,070 --> 00:01:35,079
<font color="#E5E5E5">versus everything else if anyone's done</font>

38
00:01:32,650 --> 00:01:37,210
application testing penetration testing

39
00:01:35,079 --> 00:01:39,220
or anything of that ilk<font color="#E5E5E5"> you will know</font>

40
00:01:37,210 --> 00:01:40,750
that you have<font color="#CCCCCC"> a target you have a</font>

41
00:01:39,220 --> 00:01:42,820
specified IP address you have a

42
00:01:40,750 --> 00:01:44,350
specified application of version you

43
00:01:42,820 --> 00:01:46,600
have a specific hardware platform or

44
00:01:44,350 --> 00:01:49,059
something that you're<font color="#CCCCCC"> going after you</font>

45
00:01:46,600 --> 00:01:51,939
focus in on that look for weaknesses and

46
00:01:49,060 --> 00:01:53,049
attempt to work out what it's doing with

47
00:01:51,939 --> 00:01:55,570
man-in-the-middle attacks you don't

48
00:01:53,049 --> 00:01:57,729
quite<font color="#E5E5E5"> have the same thing because you're</font>

49
00:01:55,570 --> 00:02:00,939
passing data in and out of a system or

50
00:01:57,729 --> 00:02:03,820
through a system and you don't know what

51
00:02:00,939 --> 00:02:07,210
that system is or even<font color="#CCCCCC"> where it is so</font>

52
00:02:03,820 --> 00:02:09,880
all you<font color="#CCCCCC"> can do is look what changes in</font>

53
00:02:07,210 --> 00:02:11,170
the data or facets of the data as it's

54
00:02:09,880 --> 00:02:14,440
coming in and out the system and try to

55
00:02:11,170 --> 00:02:16,030
infer things from<font color="#CCCCCC"> that so nearly</font>

56
00:02:14,440 --> 00:02:17,500
everything<font color="#CCCCCC"> that takes place in here is</font>

57
00:02:16,030 --> 00:02:21,100
based on my home connection

58
00:02:17,500 --> 00:02:23,410
behind my<font color="#CCCCCC"> isp to a VPS I have elsewhere</font>

59
00:02:21,100 --> 00:02:24,670
on the internet and then looking<font color="#E5E5E5"> at</font>

60
00:02:23,410 --> 00:02:28,299
what's happened in the data in between

61
00:02:24,670 --> 00:02:31,239
the two so I went specifically looking

62
00:02:28,300 --> 00:02:32,830
for man-in-the-middle attacks but most

63
00:02:31,240 --> 00:02:34,990
people are that's not how<font color="#CCCCCC"> people spend</font>

64
00:02:32,830 --> 00:02:36,730
their day on their connections there are

65
00:02:34,990 --> 00:02:38,230
three main ways that people notice an

66
00:02:36,730 --> 00:02:41,079
attack when they're not specifically

67
00:02:38,230 --> 00:02:43,299
looking for it number one you've

68
00:02:41,080 --> 00:02:45,940
<font color="#E5E5E5">probably all seen a thousand times it's</font>

69
00:02:43,300 --> 00:02:49,620
the<font color="#E5E5E5"> sum application has cryptography in</font>

70
00:02:45,940 --> 00:02:52,420
it and signatures break the overall

71
00:02:49,620 --> 00:02:54,250
cryptography breaks by virtue of

72
00:02:52,420 --> 00:02:56,850
something changing in the<font color="#E5E5E5"> middle is what</font>

73
00:02:54,250 --> 00:02:59,260
it's designed to do this example is

74
00:02:56,850 --> 00:03:01,510
Google being visited by IP address

75
00:02:59,260 --> 00:03:03,190
instead of my name the host name doesn't

76
00:03:01,510 --> 00:03:04,780
match the ssl cert and it immediately

77
00:03:03,190 --> 00:03:07,900
notifies you that there's<font color="#CCCCCC"> something</font>

78
00:03:04,780 --> 00:03:09,640
going on in the middle the next is a

79
00:03:07,900 --> 00:03:11,200
variation on that theme it's not

80
00:03:09,640 --> 00:03:14,350
deliberately letting you know but

81
00:03:11,200 --> 00:03:16,179
something has changed payload arriving

82
00:03:14,350 --> 00:03:18,519
at<font color="#E5E5E5"> an</font><font color="#CCCCCC"> application and it doesn't know</font>

83
00:03:16,180 --> 00:03:21,160
how to<font color="#E5E5E5"> process it in this case it's just</font>

84
00:03:18,520 --> 00:03:22,510
failing not particularly<font color="#E5E5E5"> gracefully but</font>

85
00:03:21,160 --> 00:03:24,430
it can still be a sign that something's

86
00:03:22,510 --> 00:03:27,190
happening in<font color="#E5E5E5"> the middle modifying</font>

87
00:03:24,430 --> 00:03:30,040
connections and causing problems the

88
00:03:27,190 --> 00:03:32,079
third one is<font color="#CCCCCC"> the spidey sense or the</font>

89
00:03:30,040 --> 00:03:35,500
<font color="#E5E5E5">Rogers injected a great big banner at</font>

90
00:03:32,080 --> 00:03:36,910
the top of my<font color="#CCCCCC"> webpage anyone who is a</font>

91
00:03:35,500 --> 00:03:39,340
customer<font color="#E5E5E5"> Rogers has probably seen this</font>

92
00:03:36,910 --> 00:03:41,200
before and I should be clear this isn't

93
00:03:39,340 --> 00:03:43,269
me having a digger Rogers this<font color="#E5E5E5"> is just</font>

94
00:03:41,200 --> 00:03:45,790
<font color="#CCCCCC">the data I have access to because miii</font>

95
00:03:43,269 --> 00:03:48,430
speak this happens<font color="#E5E5E5"> on a lot of others</font>

96
00:03:45,790 --> 00:03:51,578
too oh and I do have<font color="#CCCCCC"> more bandwidth now</font>

97
00:03:48,430 --> 00:03:53,260
country<font color="#E5E5E5"> to that warning at all so this</font>

98
00:03:51,579 --> 00:03:56,230
happens when someone hits<font color="#CCCCCC"> seventy-five</font>

99
00:03:53,260 --> 00:03:58,328
<font color="#CCCCCC">percent of their bandwidth allocation a</font>

100
00:03:56,230 --> 00:04:00,100
pretty normal thing and it's just a

101
00:03:58,329 --> 00:04:01,660
drive business is to reduce support

102
00:04:00,100 --> 00:04:04,540
calls about people wondering why they're

103
00:04:01,660 --> 00:04:07,600
getting extra billing and it's to upsell

104
00:04:04,540 --> 00:04:09,609
to their lines so that's sort of

105
00:04:07,600 --> 00:04:11,079
<font color="#CCCCCC">motivation behind it but</font><font color="#E5E5E5"> there are two</font>

106
00:04:09,610 --> 00:04:12,370
observations in this that trouble me

107
00:04:11,079 --> 00:04:14,650
straight off the bat before I even

108
00:04:12,370 --> 00:04:17,440
looked at anything technical look at the

109
00:04:14,650 --> 00:04:19,120
URL that one still says<font color="#E5E5E5"> sector dossier I</font>

110
00:04:17,440 --> 00:04:21,190
haven't<font color="#E5E5E5"> been redirected to something</font>

111
00:04:19,120 --> 00:04:22,600
<font color="#E5E5E5">else it hasn't been messed with it just</font>

112
00:04:21,190 --> 00:04:25,790
<font color="#E5E5E5">went through and was presented as part</font>

113
00:04:22,600 --> 00:04:28,640
<font color="#CCCCCC">of the page the second thing is</font>

114
00:04:25,790 --> 00:04:30,860
that it's not just<font color="#CCCCCC"> an intercepted page</font>

115
00:04:28,640 --> 00:04:33,650
it's a portion<font color="#CCCCCC"> of the page and the</font>

116
00:04:30,860 --> 00:04:34,970
original<font color="#E5E5E5"> content stall loads below these</font>

117
00:04:33,650 --> 00:04:37,609
are<font color="#E5E5E5"> really important points that we'll</font>

118
00:04:34,970 --> 00:04:39,260
come back to in a minute so when I first

119
00:04:37,610 --> 00:04:42,380
saw this my reaction overall was

120
00:04:39,260 --> 00:04:45,020
something<font color="#E5E5E5"> like this and then I sat down</font>

121
00:04:42,380 --> 00:04:48,170
<font color="#E5E5E5">for a little while and I kind of got</font>

122
00:04:45,020 --> 00:04:50,719
over that and moved on to the second

123
00:04:48,170 --> 00:04:53,810
stage in man-in-the-middle grief I

124
00:04:50,720 --> 00:04:56,360
wanted to know<font color="#E5E5E5"> how what where why all</font>

125
00:04:53,810 --> 00:04:59,240
the usual questions my inference was

126
00:04:56,360 --> 00:05:01,790
probably that it was something something

127
00:04:59,240 --> 00:05:04,670
simple they were rewriting<font color="#E5E5E5"> DNS they were</font>

128
00:05:01,790 --> 00:05:06,500
hijacking dns and giving false responses

129
00:05:04,670 --> 00:05:08,660
they were using something like a captive

130
00:05:06,500 --> 00:05:10,310
portal transparent proxy or something

131
00:05:08,660 --> 00:05:12,790
like that in the way but<font color="#E5E5E5"> there's only</font>

132
00:05:10,310 --> 00:05:17,270
<font color="#E5E5E5">one way to answer</font><font color="#CCCCCC"> a question like that</font>

133
00:05:12,790 --> 00:05:20,030
capture all the packets so we turn to

134
00:05:17,270 --> 00:05:21,950
packet sniffing as we often do anyone

135
00:05:20,030 --> 00:05:23,299
that's<font color="#CCCCCC"> looking to do this</font><font color="#E5E5E5"> I would really</font>

136
00:05:21,950 --> 00:05:24,969
recommend that you don't sit on<font color="#E5E5E5"> your</font>

137
00:05:23,300 --> 00:05:27,020
localhost and just spin up wireshark

138
00:05:24,970 --> 00:05:29,060
there's a lot<font color="#CCCCCC"> more</font><font color="#E5E5E5"> information to be had</font>

139
00:05:27,020 --> 00:05:31,940
if<font color="#CCCCCC"> you can get a</font><font color="#E5E5E5"> lot closer to the</font>

140
00:05:29,060 --> 00:05:33,770
source of the pack is so what I did<font color="#E5E5E5"> got</font>

141
00:05:31,940 --> 00:05:37,340
<font color="#CCCCCC">nitha tap I put it between my little</font>

142
00:05:33,770 --> 00:05:40,669
consumer device and my personal edge

143
00:05:37,340 --> 00:05:44,060
device put the rubbishy consumer device

144
00:05:40,670 --> 00:05:47,510
into bridging mode that way the ether

145
00:05:44,060 --> 00:05:48,830
taps it's outside of NAT firewalls Wi-Fi

146
00:05:47,510 --> 00:05:50,420
networks all the different things<font color="#CCCCCC"> that</font>

147
00:05:48,830 --> 00:05:52,340
can mess with the packets it's as close

148
00:05:50,420 --> 00:05:54,350
as raw as I'm going<font color="#E5E5E5"> to get because I do</font>

149
00:05:52,340 --> 00:05:58,219
not have anything to sniff docsis or

150
00:05:54,350 --> 00:06:00,740
anything like that at<font color="#E5E5E5"> which point we can</font>

151
00:05:58,220 --> 00:06:02,900
just<font color="#E5E5E5"> fire up TCP dump or</font><font color="#CCCCCC"> T shark or</font>

152
00:06:00,740 --> 00:06:06,020
whatever you like personally I'd avoid

153
00:06:02,900 --> 00:06:07,580
Wireshark it's a great tool but not for

154
00:06:06,020 --> 00:06:10,190
life sniffing is much better for their

155
00:06:07,580 --> 00:06:12,409
post-mortem analysis if use something

156
00:06:10,190 --> 00:06:14,450
like TCP dump or Wireshark you can spin

157
00:06:12,410 --> 00:06:16,460
up multiple processes because<font color="#CCCCCC"> Anita tab</font>

158
00:06:14,450 --> 00:06:18,200
has two cables one for incoming and one

159
00:06:16,460 --> 00:06:20,210
for outgoing this gives<font color="#E5E5E5"> you all</font>

160
00:06:18,200 --> 00:06:22,729
performance games gains so you can run

161
00:06:20,210 --> 00:06:24,859
<font color="#E5E5E5">it on terrible hardware like I did you</font>

162
00:06:22,730 --> 00:06:26,810
can run a process on each core you can

163
00:06:24,860 --> 00:06:29,360
<font color="#CCCCCC">have two buffers fit in and out and you</font>

164
00:06:26,810 --> 00:06:31,490
can<font color="#E5E5E5"> write</font><font color="#CCCCCC"> two files to two</font><font color="#E5E5E5"> disks making</font>

165
00:06:29,360 --> 00:06:32,780
the use of your leftover rubbishy

166
00:06:31,490 --> 00:06:35,240
equipment you've got in the basement

167
00:06:32,780 --> 00:06:37,880
also<font color="#CCCCCC"> writing to two files gives you some</font>

168
00:06:35,240 --> 00:06:39,060
<font color="#E5E5E5">really useful data because you have a</font>

169
00:06:37,880 --> 00:06:41,610
file for in and a

170
00:06:39,060 --> 00:06:43,500
out and you no longer have to rely on IP

171
00:06:41,610 --> 00:06:45,240
address or mac address to determine the

172
00:06:43,500 --> 00:06:47,910
direction of data is flowing you have an

173
00:06:45,240 --> 00:06:50,160
in file and an out file often this isn't

174
00:06:47,910 --> 00:06:52,230
important but man-in-the-middle often

175
00:06:50,160 --> 00:06:54,120
involves spoofed packets so no direct

176
00:06:52,230 --> 00:06:57,030
<font color="#E5E5E5">everything going is going is really</font>

177
00:06:54,120 --> 00:06:58,830
important the other thing we need to

178
00:06:57,030 --> 00:07:00,809
<font color="#E5E5E5">remember</font><font color="#CCCCCC"> is that we have two states in</font>

179
00:06:58,830 --> 00:07:02,700
this scenario<font color="#E5E5E5"> that I'm looking at we</font>

180
00:07:00,810 --> 00:07:05,130
have the state<font color="#E5E5E5"> of things being injected</font>

181
00:07:02,700 --> 00:07:07,139
into the header of the<font color="#CCCCCC"> pages and other</font>

182
00:07:05,130 --> 00:07:10,950
which<font color="#E5E5E5"> I'm going to deem nominally is</font>

183
00:07:07,139 --> 00:07:13,320
clean and<font color="#CCCCCC"> the best</font><font color="#E5E5E5"> thing about this is</font>

184
00:07:10,950 --> 00:07:14,969
we can decide which state<font color="#CCCCCC"> we're in at</font>

185
00:07:13,320 --> 00:07:16,979
the beginning<font color="#E5E5E5"> of the month I'm in clean</font>

186
00:07:14,970 --> 00:07:18,660
state then I jack up my bandwidth usage

187
00:07:16,979 --> 00:07:20,400
hit the limits and I can force myself

188
00:07:18,660 --> 00:07:22,440
into the state where I know I'm going to

189
00:07:20,400 --> 00:07:24,960
<font color="#E5E5E5">be injected this is really good because</font>

190
00:07:22,440 --> 00:07:28,260
I have two known states that I can

191
00:07:24,960 --> 00:07:30,388
compare to each other so quick rundown

192
00:07:28,260 --> 00:07:31,770
of tools you've<font color="#E5E5E5"> probably seen a bunch of</font>

193
00:07:30,389 --> 00:07:33,900
<font color="#E5E5E5">them but it's really worth going over</font>

194
00:07:31,770 --> 00:07:37,320
anyway TCP dump is pretty much the

195
00:07:33,900 --> 00:07:40,138
staple in you know unix command line

196
00:07:37,320 --> 00:07:42,930
packet dumping why shark as i mentioned

197
00:07:40,139 --> 00:07:43,860
great for reading reading files in it

198
00:07:42,930 --> 00:07:46,320
doesn't awful lot to do with

199
00:07:43,860 --> 00:07:47,760
reconstruction of packets reconstruction

200
00:07:46,320 --> 00:07:50,700
of<font color="#CCCCCC"> TCP streams and all that sort of</font>

201
00:07:47,760 --> 00:07:53,969
thing decoding protocols<font color="#CCCCCC"> T shark is</font>

202
00:07:50,700 --> 00:07:55,950
pretty much command line Wireshark but

203
00:07:53,970 --> 00:07:58,800
it's got nicer output than TCP dump more

204
00:07:55,950 --> 00:08:01,320
configurable output so it lends itself

205
00:07:58,800 --> 00:08:04,979
really nicely to gripping and walking

206
00:08:01,320 --> 00:08:07,169
<font color="#E5E5E5">and all that good stuff merge cap does</font>

207
00:08:04,979 --> 00:08:09,719
what it says emerges to pcap files

208
00:08:07,169 --> 00:08:11,460
together which is<font color="#E5E5E5"> really useful when</font>

209
00:08:09,720 --> 00:08:13,910
you're capturing in and out<font color="#E5E5E5"> to separate</font>

210
00:08:11,460 --> 00:08:17,159
files to get that one file to analyze

211
00:08:13,910 --> 00:08:18,900
TCP splice is the reverse you give it

212
00:08:17,160 --> 00:08:22,620
time periods and it cuts some carved

213
00:08:18,900 --> 00:08:24,210
pieces out of pcap files<font color="#CCCCCC"> I use this</font>

214
00:08:22,620 --> 00:08:26,490
because<font color="#E5E5E5"> i was doing multiple days at a</font>

215
00:08:24,210 --> 00:08:27,719
time impact capture and you don't want

216
00:08:26,490 --> 00:08:30,360
<font color="#CCCCCC">to</font><font color="#E5E5E5"> look at multiple days of package</font>

217
00:08:27,720 --> 00:08:33,780
after you want to<font color="#E5E5E5"> look at</font><font color="#CCCCCC"> 15</font><font color="#E5E5E5"> seconds or</font>

218
00:08:30,360 --> 00:08:36,000
something in<font color="#CCCCCC"> wireshark</font><font color="#E5E5E5"> tcp trace is</font>

219
00:08:33,780 --> 00:08:37,559
really good for doing analytical work it

220
00:08:36,000 --> 00:08:39,510
can<font color="#CCCCCC"> look at round trip times window</font>

221
00:08:37,559 --> 00:08:41,760
sizes throughput that sort of thing so

222
00:08:39,510 --> 00:08:43,740
if<font color="#CCCCCC"> your think that someone's tampering</font>

223
00:08:41,760 --> 00:08:47,459
with bandwidth and that sort of thing

224
00:08:43,740 --> 00:08:49,350
that<font color="#E5E5E5"> is very useful cap</font><font color="#CCCCCC"> TCP is another</font>

225
00:08:47,459 --> 00:08:51,579
analytical tool but it<font color="#E5E5E5"> focuses more on</font>

226
00:08:49,350 --> 00:08:53,380
drawing graphs some

227
00:08:51,580 --> 00:08:56,200
that<font color="#CCCCCC"> actually I found really useful in</font>

228
00:08:53,380 --> 00:08:57,310
the early stages<font color="#E5E5E5"> of this because when</font>

229
00:08:56,200 --> 00:08:58,810
you're<font color="#E5E5E5"> looking at a screen full of</font>

230
00:08:57,310 --> 00:09:02,109
numbers there's nothing like a graph to

231
00:08:58,810 --> 00:09:05,109
see a great big peak to go and look at n

232
00:09:02,110 --> 00:09:07,480
top is not a security tool at all it's

233
00:09:05,110 --> 00:09:09,430
just<font color="#CCCCCC"> for doing auditing IP connections</font>

234
00:09:07,480 --> 00:09:10,960
but<font color="#E5E5E5"> it's great because it gives you the</font>

235
00:09:09,430 --> 00:09:12,609
top talkers on your network the top

236
00:09:10,960 --> 00:09:15,100
destinations the<font color="#E5E5E5"> top protocols and other</font>

237
00:09:12,610 --> 00:09:17,920
useful information like that p captive

238
00:09:15,100 --> 00:09:21,130
is something that the eff wrote and you

239
00:09:17,920 --> 00:09:22,810
take<font color="#CCCCCC"> to pcap files it dips</font><font color="#E5E5E5"> the two dumps</font>

240
00:09:21,130 --> 00:09:26,340
a load about put out and you<font color="#CCCCCC"> can see the</font>

241
00:09:22,810 --> 00:09:30,520
<font color="#E5E5E5">difference in started in comparisons and</font>

242
00:09:26,340 --> 00:09:32,140
snort<font color="#CCCCCC"> oh sorry tcp flow</font><font color="#E5E5E5"> tcp</font><font color="#CCCCCC"> for breaks</font>

243
00:09:30,520 --> 00:09:34,930
into individual streams or connections

244
00:09:32,140 --> 00:09:37,780
and snore is a well-known our own source

245
00:09:34,930 --> 00:09:39,640
<font color="#E5E5E5">IDs product but it can take P caps as</font>

246
00:09:37,780 --> 00:09:41,500
inputs plus the rules can be user

247
00:09:39,640 --> 00:09:44,830
configurable so if you're<font color="#CCCCCC"> looking for</font>

248
00:09:41,500 --> 00:09:46,390
specific 2 3 4 20 things you can start

249
00:09:44,830 --> 00:09:48,040
throwing rules<font color="#E5E5E5"> into snort reading the</font>

250
00:09:46,390 --> 00:09:49,480
pcap so making it generate the alerts

251
00:09:48,040 --> 00:09:52,300
for you instead of<font color="#E5E5E5"> having to manually</font>

252
00:09:49,480 --> 00:09:54,690
grab a bunch of files so that all said

253
00:09:52,300 --> 00:09:56,890
let's get<font color="#E5E5E5"> on with sniffing some stuff</font>

254
00:09:54,690 --> 00:10:00,480
this is my attempt<font color="#E5E5E5"> to save you from</font>

255
00:09:56,890 --> 00:10:00,480
reading TCP dump<font color="#E5E5E5"> output on a projector</font>

256
00:10:00,750 --> 00:10:05,680
this is what a proper HTTP connection

257
00:10:03,640 --> 00:10:09,160
should look like the three-way handshake

258
00:10:05,680 --> 00:10:12,160
the syn syn<font color="#CCCCCC"> ACK</font><font color="#E5E5E5"> and act then a client</font>

259
00:10:09,160 --> 00:10:14,199
HTTP<font color="#E5E5E5"> request the HTTP response header</font>

260
00:10:12,160 --> 00:10:15,819
and the beginning of the data and then

261
00:10:14,200 --> 00:10:19,170
more data more data more data until the

262
00:10:15,820 --> 00:10:21,400
end of<font color="#E5E5E5"> the connection that's normal and</font>

263
00:10:19,170 --> 00:10:23,439
that's what we'd expect and that's what

264
00:10:21,400 --> 00:10:27,760
I<font color="#E5E5E5"> did see during the phase of not being</font>

265
00:10:23,440 --> 00:10:31,420
intercepted next I started sniffing the

266
00:10:27,760 --> 00:10:32,800
client is my laptop<font color="#E5E5E5"> oh sorry the ether</font>

267
00:10:31,420 --> 00:10:35,079
tap that was sniffing my laptop and the

268
00:10:32,800 --> 00:10:37,599
<font color="#E5E5E5">server is a VPS I have out on</font><font color="#CCCCCC"> the</font>

269
00:10:35,080 --> 00:10:40,020
<font color="#E5E5E5">internet start a packet dump on</font><font color="#CCCCCC"> the two</font>

270
00:10:37,600 --> 00:10:43,020
and then compare<font color="#E5E5E5"> them with pcap diff</font>

271
00:10:40,020 --> 00:10:45,490
having got that to narrow down the exact

272
00:10:43,020 --> 00:10:47,710
few packets<font color="#E5E5E5"> I should be looking at I</font>

273
00:10:45,490 --> 00:10:49,720
then did manual checking in wireshark or

274
00:10:47,710 --> 00:10:52,660
<font color="#CCCCCC">T shark or whatever I had to hand at the</font>

275
00:10:49,720 --> 00:10:55,780
time it starts normally you have a syn

276
00:10:52,660 --> 00:10:57,400
packet just like you would expect<font color="#E5E5E5"> and a</font>

277
00:10:55,780 --> 00:10:59,730
syn ACK so that's looking good so far

278
00:10:57,400 --> 00:11:02,010
and then the<font color="#CCCCCC"> ACK</font>

279
00:10:59,730 --> 00:11:03,449
and that's great<font color="#E5E5E5"> so the TCP handshakes</font>

280
00:11:02,010 --> 00:11:05,970
been established between the<font color="#E5E5E5"> two and</font>

281
00:11:03,449 --> 00:11:09,479
nothing seems to have gone awry so next

282
00:11:05,970 --> 00:11:12,540
I send an HTTP request but the server

283
00:11:09,480 --> 00:11:14,930
doesn't see that so my packet went

284
00:11:12,540 --> 00:11:19,079
somewhere and<font color="#E5E5E5"> I'm not quite sure where</font>

285
00:11:14,930 --> 00:11:21,930
next the<font color="#CCCCCC"> services a reset push ack which</font>

286
00:11:19,079 --> 00:11:24,089
closes the connection so purely from the

287
00:11:21,930 --> 00:11:25,920
service point of view it sees that the

288
00:11:24,089 --> 00:11:27,660
<font color="#CCCCCC">TCP connection has been torn down it</font>

289
00:11:25,920 --> 00:11:29,160
thinks from me because this packet has

290
00:11:27,660 --> 00:11:31,589
been spoofed<font color="#E5E5E5"> to come from my IP address</font>

291
00:11:29,160 --> 00:11:35,910
it also has the correct sequence numbers

292
00:11:31,589 --> 00:11:38,459
and<font color="#E5E5E5"> TCP flags notice that is a reset</font>

293
00:11:35,910 --> 00:11:39,899
packet not a thin packet the important

294
00:11:38,459 --> 00:11:41,550
<font color="#CCCCCC">thing with this is that resets don't</font>

295
00:11:39,899 --> 00:11:44,670
cause the server to produce any

296
00:11:41,550 --> 00:11:46,079
<font color="#E5E5E5">acknowledgement so I as a client will</font>

297
00:11:44,670 --> 00:11:48,510
<font color="#CCCCCC">not get any okay you close the</font>

298
00:11:46,079 --> 00:11:50,370
connection package from<font color="#E5E5E5"> the server which</font>

299
00:11:48,510 --> 00:11:51,899
is obviously a giveaway and there's

300
00:11:50,370 --> 00:11:54,000
<font color="#E5E5E5">something else for whatever's in the</font>

301
00:11:51,899 --> 00:11:57,930
middle<font color="#E5E5E5"> having to suppress so I didn't</font>

302
00:11:54,000 --> 00:12:00,810
send that next quizzically enough i get

303
00:11:57,930 --> 00:12:03,329
an HTTP response and it claims to be

304
00:12:00,810 --> 00:12:06,209
from the server but the server<font color="#E5E5E5"> has no</font>

305
00:12:03,329 --> 00:12:09,239
knowledge of this HTTP response so let

306
00:12:06,209 --> 00:12:11,819
<font color="#E5E5E5">me just summarize really quickly I have</font>

307
00:12:09,240 --> 00:12:13,589
a packet suppressed in some way there's

308
00:12:11,819 --> 00:12:18,630
a package spoofed<font color="#E5E5E5"> to come from</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> and</font>

309
00:12:13,589 --> 00:12:20,010
it's packaged spoofed<font color="#E5E5E5"> to me so</font><font color="#CCCCCC"> that was</font>

310
00:12:18,630 --> 00:12:23,449
kind of what's happening in a connection

311
00:12:20,010 --> 00:12:26,310
level what do I get on the data level

312
00:12:23,449 --> 00:12:29,519
well it<font color="#E5E5E5"> looks like a relatively simple</font>

313
00:12:26,310 --> 00:12:31,739
HTTP response there are a few things<font color="#E5E5E5"> to</font>

314
00:12:29,519 --> 00:12:33,600
note though notice how there's<font color="#E5E5E5"> no</font>

315
00:12:31,740 --> 00:12:36,300
service string in there you would

316
00:12:33,600 --> 00:12:37,860
normally get<font color="#CCCCCC"> Apache engine X I is</font>

317
00:12:36,300 --> 00:12:42,449
something<font color="#E5E5E5"> like that but that's not</font>

318
00:12:37,860 --> 00:12:44,550
present notice also the cache control

319
00:12:42,449 --> 00:12:46,319
and the pragma that's in red does to

320
00:12:44,550 --> 00:12:49,290
<font color="#E5E5E5">make sure that this page is absolutely</font>

321
00:12:46,319 --> 00:12:51,779
must not be cached ever by browser by

322
00:12:49,290 --> 00:12:54,300
proxy or anything like that remember how

323
00:12:51,779 --> 00:12:56,430
I said the content loaded before this is

324
00:12:54,300 --> 00:12:59,760
really important to that if that cash

325
00:12:56,430 --> 00:13:01,800
<font color="#E5E5E5">wasn't there</font><font color="#CCCCCC"> my browser would cash that</font>

326
00:12:59,760 --> 00:13:03,720
banner as the<font color="#CCCCCC"> sector page and when it</font>

327
00:13:01,800 --> 00:13:05,490
tries to reload<font color="#CCCCCC"> the other content at</font><font color="#E5E5E5"> the</font>

328
00:13:03,720 --> 00:13:07,319
bottom I would<font color="#E5E5E5"> just get the banner over</font>

329
00:13:05,490 --> 00:13:08,939
and over and over<font color="#E5E5E5"> again so they need</font><font color="#CCCCCC"> to</font>

330
00:13:07,319 --> 00:13:10,439
make<font color="#CCCCCC"> sure it's not cached also it's</font>

331
00:13:08,939 --> 00:13:12,140
really handy but it doesn't<font color="#E5E5E5"> end up in my</font>

332
00:13:10,439 --> 00:13:14,520
temporary files

333
00:13:12,140 --> 00:13:17,520
the other parts in red are<font color="#CCCCCC"> the important</font>

334
00:13:14,520 --> 00:13:19,680
bits<font color="#E5E5E5"> too as you'd expect it's a bunch of</font>

335
00:13:17,520 --> 00:13:21,210
JavaScript that's used to<font color="#E5E5E5"> insert the</font>

336
00:13:19,680 --> 00:13:23,339
banner at the top and there's a no

337
00:13:21,210 --> 00:13:24,630
script that loads a frame to<font color="#E5E5E5"> put the</font>

338
00:13:23,340 --> 00:13:27,000
banner at the top for people that don't

339
00:13:24,630 --> 00:13:31,110
run JavaScript or that would be the<font color="#CCCCCC"> case</font>

340
00:13:27,000 --> 00:13:34,740
if<font color="#CCCCCC"> the no script didn't 404 which is</font>

341
00:13:31,110 --> 00:13:37,650
<font color="#E5E5E5">brilliant the other thing to know here</font>

342
00:13:34,740 --> 00:13:39,960
is it's pretty compact there's<font color="#CCCCCC"> nothing</font>

343
00:13:37,650 --> 00:13:41,370
really extraneous in there there's not a

344
00:13:39,960 --> 00:13:43,790
lot of white space or anything like that

345
00:13:41,370 --> 00:13:45,870
and it all fits inside a single packet

346
00:13:43,790 --> 00:13:47,370
personally I'm assuming that it fits

347
00:13:45,870 --> 00:13:49,140
inside a single packet because then

348
00:13:47,370 --> 00:13:51,990
whatever's in the middle doesn't have<font color="#E5E5E5"> to</font>

349
00:13:49,140 --> 00:13:53,670
cope with maintaining a full TCP session

350
00:13:51,990 --> 00:13:56,520
with me tracking<font color="#E5E5E5"> session numbers and</font>

351
00:13:53,670 --> 00:13:59,400
flags and all this sort of stuff so

352
00:13:56,520 --> 00:14:00,900
that's<font color="#E5E5E5"> kind of secondary the banner we</font>

353
00:13:59,400 --> 00:14:02,550
kind of know what that is<font color="#E5E5E5"> and we could</font>

354
00:14:00,900 --> 00:14:05,189
talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> how terrible the javascript</font>

355
00:14:02,550 --> 00:14:07,050
is some<font color="#CCCCCC"> other point one of the things</font>

356
00:14:05,190 --> 00:14:10,620
that doesn't<font color="#E5E5E5"> dress me though is if it's</font>

357
00:14:07,050 --> 00:14:12,660
legal I'm not<font color="#E5E5E5"> a lawyer but this is from</font>

358
00:14:10,620 --> 00:14:16,290
the Telecommunications Act and to me it

359
00:14:12,660 --> 00:14:18,510
sounds<font color="#E5E5E5"> like the</font><font color="#CCCCCC"> CRTC doesn't love this I</font>

360
00:14:16,290 --> 00:14:21,290
could be<font color="#CCCCCC"> Miss misunderstanding</font><font color="#E5E5E5"> though</font>

361
00:14:18,510 --> 00:14:24,750
but anyway let's get back to analysis

362
00:14:21,290 --> 00:14:26,490
let's look a packet headers a lot of the

363
00:14:24,750 --> 00:14:29,340
packet header has to stay the same if

364
00:14:26,490 --> 00:14:30,990
you mess with IP addresses when spoofing

365
00:14:29,340 --> 00:14:33,030
<font color="#E5E5E5">the packets if you mess with sequence</font>

366
00:14:30,990 --> 00:14:35,190
numbers if you<font color="#CCCCCC"> miss mess with the</font><font color="#E5E5E5"> TCP</font>

367
00:14:33,030 --> 00:14:37,890
flags and you'd these things can cause a

368
00:14:35,190 --> 00:14:39,120
connection to go wrong if midstream you

369
00:14:37,890 --> 00:14:41,189
start<font color="#CCCCCC"> getting things with the wrong</font>

370
00:14:39,120 --> 00:14:42,540
sequence number they'll be ignored if

371
00:14:41,190 --> 00:14:44,130
you get things with the wrong port

372
00:14:42,540 --> 00:14:45,810
numbers<font color="#CCCCCC"> L would seem to be</font><font color="#E5E5E5"> part of</font>

373
00:14:44,130 --> 00:14:47,670
another<font color="#E5E5E5"> stream and if they're different</font>

374
00:14:45,810 --> 00:14:49,890
IP addresses then they're just<font color="#E5E5E5"> something</font>

375
00:14:47,670 --> 00:14:51,479
completely different so you would<font color="#CCCCCC"> think</font>

376
00:14:49,890 --> 00:14:54,600
there isn't much analysis there but

377
00:14:51,480 --> 00:14:56,070
there<font color="#E5E5E5"> is one</font><font color="#CCCCCC"> thing I noticed</font><font color="#E5E5E5"> is no</font>

378
00:14:54,600 --> 00:14:58,620
matter a host on visiting on the

379
00:14:56,070 --> 00:15:02,450
<font color="#CCCCCC">Internet this spoof packets always have</font>

380
00:14:58,620 --> 00:15:04,980
the same TTL that's the time to live

381
00:15:02,450 --> 00:15:07,980
therefore I'm guessing that<font color="#E5E5E5"> it has the</font>

382
00:15:04,980 --> 00:15:09,840
<font color="#E5E5E5">same TTL at the start place and traces</font>

383
00:15:07,980 --> 00:15:12,360
the same network path to get to me every

384
00:15:09,840 --> 00:15:14,220
time now I thought I could detect this

385
00:15:12,360 --> 00:15:18,120
and use this<font color="#E5E5E5"> as a method to detecting</font>

386
00:15:14,220 --> 00:15:19,950
packets of<font color="#E5E5E5"> spooked package I could</font>

387
00:15:18,120 --> 00:15:21,600
compare the syn<font color="#E5E5E5"> ACK from the true server</font>

388
00:15:19,950 --> 00:15:23,760
to the injected packet and look for the

389
00:15:21,600 --> 00:15:25,490
changing<font color="#CCCCCC"> ttls and say great this is</font>

390
00:15:23,760 --> 00:15:26,910
injected package

391
00:15:25,490 --> 00:15:28,800
unfortunately there are these things

392
00:15:26,910 --> 00:15:30,150
called load balancers which are<font color="#E5E5E5"> kind of</font>

393
00:15:28,800 --> 00:15:32,459
business approved man-in-the-middle

394
00:15:30,150 --> 00:15:34,770
devices and they do the same things

395
00:15:32,460 --> 00:15:38,280
because they warm start<font color="#E5E5E5"> TCP connections</font>

396
00:15:34,770 --> 00:15:39,990
they often<font color="#E5E5E5"> do very similar stuff they</font>

397
00:15:38,280 --> 00:15:41,640
have their own<font color="#CCCCCC"> ttls and</font><font color="#E5E5E5"> I started</font>

398
00:15:39,990 --> 00:15:45,990
flagging up all sorts of amazon boxes

399
00:15:41,640 --> 00:15:47,550
and yeah that was wrong so oh and I

400
00:15:45,990 --> 00:15:49,500
can't do<font color="#CCCCCC"> it on the hard-coded TTL</font>

401
00:15:47,550 --> 00:15:52,319
because that's not really a generic

402
00:15:49,500 --> 00:15:54,420
detection signature that's<font color="#E5E5E5"> just a way to</font>

403
00:15:52,320 --> 00:15:56,340
spot this one instance<font color="#E5E5E5"> I would only have</font>

404
00:15:54,420 --> 00:15:58,140
to move one hop within my own network

405
00:15:56,340 --> 00:15:59,790
and that would break let alone if my

406
00:15:58,140 --> 00:16:02,850
eyes p starts messing with their network

407
00:15:59,790 --> 00:16:04,410
or something like that<font color="#CCCCCC"> I started looking</font>

408
00:16:02,850 --> 00:16:07,590
elsewhere and noticed<font color="#E5E5E5"> that the do not</font>

409
00:16:04,410 --> 00:16:09,600
fragment bit is never ever said that's

410
00:16:07,590 --> 00:16:12,540
not unique lots<font color="#E5E5E5"> of other packets don't</font>

411
00:16:09,600 --> 00:16:14,670
set the the do not fragment but it is

412
00:16:12,540 --> 00:16:16,560
something that<font color="#E5E5E5"> is always the case so we</font>

413
00:16:14,670 --> 00:16:19,079
can add that as a sort of secondary

414
00:16:16,560 --> 00:16:20,760
check if we get another signature the

415
00:16:19,080 --> 00:16:23,910
one thing<font color="#E5E5E5"> I did see though was that the</font>

416
00:16:20,760 --> 00:16:26,430
<font color="#CCCCCC">TCP window</font><font color="#E5E5E5"> size is set and it's not in</font>

417
00:16:23,910 --> 00:16:29,579
third it's not negotiated it's set in

418
00:16:26,430 --> 00:16:31,140
the header 2-1 I searched my packet

419
00:16:29,580 --> 00:16:33,540
<font color="#CCCCCC">dumps I don't have a whole lot of</font>

420
00:16:31,140 --> 00:16:36,300
packets that do TCP window size one and

421
00:16:33,540 --> 00:16:38,490
I have even<font color="#E5E5E5"> less that never have that do</font>

422
00:16:36,300 --> 00:16:41,630
not fragment bit set to give you idea

423
00:16:38,490 --> 00:16:44,880
how few only<font color="#E5E5E5"> injected package did this</font>

424
00:16:41,630 --> 00:16:47,939
so so<font color="#E5E5E5"> let's have a look you can write a</font>

425
00:16:44,880 --> 00:16:50,400
simple rule in TCP done those are<font color="#CCCCCC"> the</font>

426
00:16:47,940 --> 00:16:52,470
two statements and I run it over the

427
00:16:50,400 --> 00:16:55,230
capture packets that I'd acquired a few

428
00:16:52,470 --> 00:16:57,840
<font color="#E5E5E5">days and it seemed to match near enough</font>

429
00:16:55,230 --> 00:16:59,250
and so I did the same<font color="#CCCCCC"> in why she'll just</font>

430
00:16:57,840 --> 00:17:00,690
to check I wasn't doing something silly

431
00:16:59,250 --> 00:17:03,000
and TCP dump and there wasn't some

432
00:17:00,690 --> 00:17:06,510
interpretation going on and it works

433
00:17:03,000 --> 00:17:09,030
right and why shark too so I give the

434
00:17:06,510 --> 00:17:11,220
next logical thing I wrote a snort wall

435
00:17:09,030 --> 00:17:13,770
so my<font color="#CCCCCC"> IDs can start shouting at me any</font>

436
00:17:11,220 --> 00:17:17,130
<font color="#CCCCCC">time</font><font color="#E5E5E5"> someone starts injecting packets at</font>

437
00:17:13,770 --> 00:17:18,750
least using this technique I ran it over

438
00:17:17,130 --> 00:17:22,020
my packet dumps at home it's

439
00:17:18,750 --> 00:17:23,670
approximately 30 million packets it have

440
00:17:22,020 --> 00:17:26,099
a hundred<font color="#E5E5E5"> percent success rate no false</font>

441
00:17:23,670 --> 00:17:27,840
positives I'm not<font color="#E5E5E5"> saying it's perfect</font>

442
00:17:26,099 --> 00:17:30,169
but I'm willing to<font color="#CCCCCC"> live with those</font>

443
00:17:27,839 --> 00:17:30,169
ratios

444
00:17:31,000 --> 00:17:35,510
okay i will<font color="#CCCCCC"> give the</font><font color="#E5E5E5"> disclaimer though</font>

445
00:17:33,440 --> 00:17:37,970
that if<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> fearful of a signals</font>

446
00:17:35,510 --> 00:17:40,340
intelligence agency malicious government

447
00:17:37,970 --> 00:17:41,840
or someone else looking at you you

448
00:17:40,340 --> 00:17:43,549
probably<font color="#E5E5E5"> don't want</font><font color="#CCCCCC"> to rely on</font><font color="#E5E5E5"> this is</font>

449
00:17:41,840 --> 00:17:44,689
your method of packet injection you

450
00:17:43,549 --> 00:17:49,580
probably want something<font color="#CCCCCC"> a little</font><font color="#E5E5E5"> more</font>

451
00:17:44,690 --> 00:17:51,889
robust but so i moved to fun with

452
00:17:49,580 --> 00:17:53,389
firewalls and<font color="#E5E5E5"> i'm not referring to</font>

453
00:17:51,889 --> 00:17:54,740
putting those filters into firewalls

454
00:17:53,389 --> 00:17:56,269
just to<font color="#E5E5E5"> straight-up block injected</font>

455
00:17:54,740 --> 00:17:58,750
packets although that might be fun<font color="#CCCCCC"> I'm</font>

456
00:17:56,269 --> 00:18:02,510
talking<font color="#CCCCCC"> about the fun I had with files</font>

457
00:17:58,750 --> 00:18:06,049
so the first thing<font color="#E5E5E5"> I did was sit on my</font>

458
00:18:02,510 --> 00:18:08,899
server and block syn ack packets by

459
00:18:06,049 --> 00:18:10,820
blocking syn ack packets<font color="#E5E5E5"> I can see if my</font>

460
00:18:08,899 --> 00:18:15,678
sin is enough to trigger packet

461
00:18:10,820 --> 00:18:19,070
injection back nothing happened so my

462
00:18:15,679 --> 00:18:21,590
inference here is that the whatever

463
00:18:19,070 --> 00:18:23,480
device is injecting packets is tracking

464
00:18:21,590 --> 00:18:25,459
my session more closely than looking for

465
00:18:23,480 --> 00:18:27,470
the outbound sin it's actually looking

466
00:18:25,460 --> 00:18:35,510
to<font color="#E5E5E5"> make sure there's a negotiation and</font>

467
00:18:27,470 --> 00:18:38,539
that holds true sorry if you undo the

468
00:18:35,510 --> 00:18:41,750
firewall rule and allow the syn<font color="#CCCCCC"> ack to</font>

469
00:18:38,539 --> 00:18:44,600
the server so the server sorry allow the

470
00:18:41,750 --> 00:18:47,659
server to send a syn ack back then the

471
00:18:44,600 --> 00:18:49,730
connection completes so we know that

472
00:18:47,659 --> 00:18:52,760
they're following<font color="#E5E5E5"> the TCP handshake it's</font>

473
00:18:49,730 --> 00:18:54,950
not just the sim packet I tried blocking

474
00:18:52,760 --> 00:18:56,779
the reset push back to the server so

475
00:18:54,950 --> 00:18:58,760
that its connection didn't get reset at

476
00:18:56,779 --> 00:19:01,220
its end so it would carry on with the

477
00:18:58,760 --> 00:19:03,350
transaction<font color="#E5E5E5"> with me and the server does</font>

478
00:19:01,220 --> 00:19:05,870
carry on and in fact it races the system

479
00:19:03,350 --> 00:19:09,649
for responses<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the winner is whoever</font>

480
00:19:05,870 --> 00:19:12,500
gets the packet to me<font color="#E5E5E5"> first the downside</font>

481
00:19:09,649 --> 00:19:15,379
is we know that this<font color="#E5E5E5"> box is in between</font>

482
00:19:12,500 --> 00:19:17,419
<font color="#E5E5E5">me and the server so it's closer it has</font>

483
00:19:15,380 --> 00:19:19,669
less hops and it's presumably within my

484
00:19:17,419 --> 00:19:25,010
isp's network so guess who's going<font color="#E5E5E5"> to</font>

485
00:19:19,669 --> 00:19:27,649
<font color="#E5E5E5">win the race so we've kind of negotiated</font>

486
00:19:25,010 --> 00:19:30,139
kind of understand now<font color="#E5E5E5"> exactly how the</font>

487
00:19:27,649 --> 00:19:32,268
interception works at an IP packet layer

488
00:19:30,139 --> 00:19:35,580
we know<font color="#E5E5E5"> that the</font><font color="#CCCCCC"> tcp state is being</font>

489
00:19:32,269 --> 00:19:38,049
tracked but there's<font color="#E5E5E5"> more</font>

490
00:19:35,580 --> 00:19:41,049
we've got to<font color="#CCCCCC"> go</font><font color="#E5E5E5"> back and look at how the</font>

491
00:19:38,049 --> 00:19:43,480
injection work works remember<font color="#E5E5E5"> that the</font>

492
00:19:41,049 --> 00:19:46,720
rendered page loaded under the banner at

493
00:19:43,480 --> 00:19:49,059
the top that's important<font color="#E5E5E5"> because that</font>

494
00:19:46,720 --> 00:19:53,169
means<font color="#E5E5E5"> that whatever system it is knows</font>

495
00:19:49,059 --> 00:19:56,289
to inject and then not inject a page it

496
00:19:53,169 --> 00:19:58,480
<font color="#E5E5E5">has to have a concept of knowing that</font><font color="#CCCCCC"> I</font>

497
00:19:56,289 --> 00:20:00,400
have<font color="#CCCCCC"> visited that</font><font color="#E5E5E5"> page and got the</font>

498
00:19:58,480 --> 00:20:02,289
banner and I visited again and I should

499
00:20:00,400 --> 00:20:06,309
be<font color="#E5E5E5"> presented the real page so it has a</font>

500
00:20:02,289 --> 00:20:09,280
state in that sense also<font color="#E5E5E5"> I</font><font color="#CCCCCC"> observed that</font>

501
00:20:06,309 --> 00:20:11,440
it only injects on certain things apps

502
00:20:09,280 --> 00:20:13,840
on my laptop the talk back to home using

503
00:20:11,440 --> 00:20:16,030
HTTP but were not web browsing so say

504
00:20:13,840 --> 00:20:19,539
they fetch a file<font color="#CCCCCC"> over xml / fetch an</font>

505
00:20:16,030 --> 00:20:21,850
<font color="#CCCCCC">xml file over HTTP did not get injected</font>

506
00:20:19,539 --> 00:20:24,850
if you looked on that page or the<font color="#CCCCCC"> images</font>

507
00:20:21,850 --> 00:20:26,350
<font color="#E5E5E5">loaded so it didn't inject images that</font>

508
00:20:24,850 --> 00:20:29,918
means it has a concept of knowing an

509
00:20:26,350 --> 00:20:33,580
injectable file or URL versus a non

510
00:20:29,919 --> 00:20:35,409
injectable one that means that<font color="#E5E5E5"> the</font>

511
00:20:33,580 --> 00:20:37,210
device has deeper than IP header

512
00:20:35,409 --> 00:20:40,870
knowledge we're now getting towards

513
00:20:37,210 --> 00:20:42,850
payload knowledge let's just revisit

514
00:20:40,870 --> 00:20:47,549
this flight again especially as I spin

515
00:20:42,850 --> 00:20:50,980
so I'm<font color="#E5E5E5"> putting it together the request</font>

516
00:20:47,549 --> 00:20:53,379
the reset happens after the HTTP request

517
00:20:50,980 --> 00:20:54,880
is known so they know what URL I'm

518
00:20:53,380 --> 00:20:57,130
requesting remember that's not just the

519
00:20:54,880 --> 00:21:01,480
<font color="#E5E5E5">hostname that's the full URL with the</font>

520
00:20:57,130 --> 00:21:05,950
file however that's actually not enough

521
00:21:01,480 --> 00:21:07,630
because if any of you use web apps you

522
00:21:05,950 --> 00:21:11,620
all know that<font color="#CCCCCC"> the extension on the end</font>

523
00:21:07,630 --> 00:21:14,220
so<font color="#CCCCCC"> you have example.com / something</font><font color="#E5E5E5"> jpg</font>

524
00:21:11,620 --> 00:21:16,989
that doesn't mean it has to be a JPEG

525
00:21:14,220 --> 00:21:20,559
you can have PHP files that return

526
00:21:16,990 --> 00:21:22,780
images the file extension does not

527
00:21:20,559 --> 00:21:24,580
determine how your browser handles file

528
00:21:22,780 --> 00:21:27,399
it's not like<font color="#E5E5E5"> a file on your desktop</font>

529
00:21:24,580 --> 00:21:29,320
where it has a file association what

530
00:21:27,400 --> 00:21:31,539
does<font color="#E5E5E5"> that is the mime type or</font><font color="#CCCCCC"> the</font>

531
00:21:29,320 --> 00:21:33,158
content type from the header the

532
00:21:31,539 --> 00:21:37,179
interesting<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> is that the mime type</font>

533
00:21:33,159 --> 00:21:38,710
and content type occur here after

534
00:21:37,179 --> 00:21:42,370
they've already decided to<font color="#E5E5E5"> inject the</font>

535
00:21:38,710 --> 00:21:44,890
packet so they've made a decision to

536
00:21:42,370 --> 00:21:46,310
inject a packet based on the URL so they

537
00:21:44,890 --> 00:21:48,590
<font color="#E5E5E5">know that that URL can be</font>

538
00:21:46,310 --> 00:21:52,040
but they have not waited to see what the

539
00:21:48,590 --> 00:21:54,080
<font color="#CCCCCC">content type comes back that means they</font>

540
00:21:52,040 --> 00:21:57,560
have prior knowledge of<font color="#E5E5E5"> that content</font>

541
00:21:54,080 --> 00:22:00,139
type and having prior knowledge of the

542
00:21:57,560 --> 00:22:02,210
content type pushes us that little bit

543
00:22:00,140 --> 00:22:04,990
<font color="#CCCCCC">further into the this isn't just IP</font>

544
00:22:02,210 --> 00:22:08,420
packets we're<font color="#E5E5E5"> getting into payload data</font>

545
00:22:04,990 --> 00:22:11,900
just to show you this is a<font color="#E5E5E5"> normal header</font>

546
00:22:08,420 --> 00:22:14,750
see the content type<font color="#E5E5E5"> ok to inject bit</font>

547
00:22:11,900 --> 00:22:16,970
there if that was image jpg or something

548
00:22:14,750 --> 00:22:19,610
it wouldn't be touched so they they

549
00:22:16,970 --> 00:22:23,150
already know the content type to<font color="#CCCCCC"> the URL</font>

550
00:22:19,610 --> 00:22:26,179
i was visiting in advance now this

551
00:22:23,150 --> 00:22:28,940
starts<font color="#CCCCCC"> to ring bells off in my mind</font>

552
00:22:26,180 --> 00:22:32,690
because I saw things<font color="#E5E5E5"> earlier on that I'd</font>

553
00:22:28,940 --> 00:22:35,270
sort<font color="#E5E5E5"> of discounted some pages for</font>

554
00:22:32,690 --> 00:22:37,220
example Google got<font color="#E5E5E5"> injected</font><font color="#CCCCCC"> straightaway</font>

555
00:22:35,270 --> 00:22:41,780
the banner went there the first time I

556
00:22:37,220 --> 00:22:44,420
<font color="#CCCCCC">visited it some of</font><font color="#E5E5E5"> them didn't some of</font>

557
00:22:41,780 --> 00:22:46,730
them<font color="#E5E5E5"> I went to and then revisited and it</font>

558
00:22:44,420 --> 00:22:50,390
came<font color="#E5E5E5"> up on the second dry and so I tried</font>

559
00:22:46,730 --> 00:22:52,640
this out I went to pages that i have

560
00:22:50,390 --> 00:22:56,180
<font color="#CCCCCC">been</font><font color="#E5E5E5"> going to regularly and they inject</font>

561
00:22:52,640 --> 00:22:58,310
first try I went to<font color="#E5E5E5"> pages but common</font>

562
00:22:56,180 --> 00:23:00,230
pages that i haven't<font color="#E5E5E5"> been to in quite</font>

563
00:22:58,310 --> 00:23:02,690
some time<font color="#E5E5E5"> and they were injected on the</font>

564
00:23:00,230 --> 00:23:04,340
second try now I made sure was a common

565
00:23:02,690 --> 00:23:05,810
page so it<font color="#E5E5E5"> wasn't something like it</font>

566
00:23:04,340 --> 00:23:08,629
hasn't been indexed by some crawler or

567
00:23:05,810 --> 00:23:10,190
something so like Cisco<font color="#CCCCCC"> calm pretty sure</font>

568
00:23:08,630 --> 00:23:15,970
most companies will have heard of that

569
00:23:10,190 --> 00:23:18,920
it's not going to be missed by robot so

570
00:23:15,970 --> 00:23:22,460
that leads me to something<font color="#E5E5E5"> else more</font>

571
00:23:18,920 --> 00:23:24,260
tests I wanted<font color="#E5E5E5"> to discover this semi</font>

572
00:23:22,460 --> 00:23:26,630
passively because I didn't want to go

573
00:23:24,260 --> 00:23:28,640
probing my IP network I didn't want<font color="#CCCCCC"> to</font>

574
00:23:26,630 --> 00:23:30,530
do something illegal I didn't want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> go</font>

575
00:23:28,640 --> 00:23:31,970
prodding their boxes and like I said

576
00:23:30,530 --> 00:23:34,550
half<font color="#E5E5E5"> the fun of the mountain the middle</font>

577
00:23:31,970 --> 00:23:36,770
stuff is observing the changes but I

578
00:23:34,550 --> 00:23:39,770
didn't<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to understand what they were</font>

579
00:23:36,770 --> 00:23:44,480
doing and how and where and all that

580
00:23:39,770 --> 00:23:51,560
sort of stuff so I I set up a web server

581
00:23:44,480 --> 00:23:56,970
on my VPS and I decided to<font color="#E5E5E5"> pre cash if I</font>

582
00:23:51,560 --> 00:23:58,740
<font color="#E5E5E5">could the URLs so during my state of</font>

583
00:23:56,970 --> 00:24:00,750
clean connection and not injected

584
00:23:58,740 --> 00:24:03,090
connection I put a rewrite on a web

585
00:24:00,750 --> 00:24:05,429
server that<font color="#CCCCCC"> goes to a PHP file all that</font>

586
00:24:03,090 --> 00:24:09,899
does<font color="#CCCCCC"> he says whatever URL I visit on</font>

587
00:24:05,429 --> 00:24:11,640
this server goes to this PHP file I set

588
00:24:09,900 --> 00:24:14,970
<font color="#CCCCCC">that PHP file to set a header of not</font>

589
00:24:11,640 --> 00:24:18,150
caching and I set it<font color="#CCCCCC"> to return a file</font>

590
00:24:14,970 --> 00:24:20,940
every time and then I hit random URL so

591
00:24:18,150 --> 00:24:24,870
it can be example.com / the date / the

592
00:24:20,940 --> 00:24:27,390
time / whatever<font color="#E5E5E5"> but the point is I make</font>

593
00:24:24,870 --> 00:24:29,520
it unique I visit it exactly one time

594
00:24:27,390 --> 00:24:33,179
and I take a note of when I visited that

595
00:24:29,520 --> 00:24:35,460
one time the plan is then when i<font color="#E5E5E5"> get to</font>

596
00:24:33,179 --> 00:24:38,130
hitting my bandwidth limit<font color="#E5E5E5"> i visit each</font>

597
00:24:35,460 --> 00:24:41,730
of those<font color="#CCCCCC"> urls in turn i see which ones</font>

598
00:24:38,130 --> 00:24:44,990
get injected maths can then tell me how

599
00:24:41,730 --> 00:24:49,409
long<font color="#E5E5E5"> they're holding this cache of URL</font>

600
00:24:44,990 --> 00:24:51,030
to inject ability list and<font color="#CCCCCC"> i can know</font>

601
00:24:49,409 --> 00:24:53,580
how long they've essentially got<font color="#E5E5E5"> my</font>

602
00:24:51,030 --> 00:24:59,100
browser history but<font color="#CCCCCC"> i didn't</font><font color="#E5E5E5"> want to</font>

603
00:24:53,580 --> 00:25:00,809
<font color="#E5E5E5">leave it just of that because i don't</font>

604
00:24:59,100 --> 00:25:02,939
want the excuse that hey we use a

605
00:25:00,809 --> 00:25:05,158
crawler it's just indexed you know we

606
00:25:02,940 --> 00:25:07,500
pulled it from google or whatever so we

607
00:25:05,159 --> 00:25:09,900
did the<font color="#E5E5E5"> same again but I go</font><font color="#CCCCCC"> an htaccess</font>

608
00:25:07,500 --> 00:25:12,360
file on<font color="#E5E5E5"> Sony my IP address can access</font>

609
00:25:09,900 --> 00:25:15,240
this and I didn't<font color="#E5E5E5"> put any DNS entry I</font>

610
00:25:12,360 --> 00:25:17,549
put a static entry in etc hosts this way

611
00:25:15,240 --> 00:25:21,900
the only way to notice that is to be

612
00:25:17,549 --> 00:25:23,460
watching<font color="#CCCCCC"> my connection the spoiler is is</font>

613
00:25:21,900 --> 00:25:27,570
sniffed by the way just in case you

614
00:25:23,460 --> 00:25:33,179
think about<font color="#E5E5E5"> it so I waited for my</font>

615
00:25:27,570 --> 00:25:38,158
results and I got nothing this is my

616
00:25:33,179 --> 00:25:40,140
document it's not complicated I don't

617
00:25:38,159 --> 00:25:43,620
<font color="#CCCCCC">think it</font><font color="#E5E5E5"> could get misinterpreted for</font>

618
00:25:40,140 --> 00:25:46,950
anything yeah I didn't really know what

619
00:25:43,620 --> 00:25:51,600
<font color="#CCCCCC">happened and then I tried something I am</font>

620
00:25:46,950 --> 00:25:55,340
I did that and suddenly the next month

621
00:25:51,600 --> 00:25:58,289
when I tried it it did get intercepted

622
00:25:55,340 --> 00:26:01,260
just to drive home this point I keep

623
00:25:58,289 --> 00:26:03,990
making it's not<font color="#E5E5E5"> just IP headers it's not</font>

624
00:26:01,260 --> 00:26:06,510
just HTTP headers that's document

625
00:26:03,990 --> 00:26:09,770
content that means they're making

626
00:26:06,510 --> 00:26:12,500
decisions based on document content

627
00:26:09,770 --> 00:26:15,920
<font color="#E5E5E5">stop the network they've associated that</font>

628
00:26:12,500 --> 00:26:17,750
with the URL that URL is associated with

629
00:26:15,920 --> 00:26:19,730
my IP address because I'm<font color="#E5E5E5"> pretty sure</font>

630
00:26:17,750 --> 00:26:21,410
they'd be injecting on cisco.com and

631
00:26:19,730 --> 00:26:24,710
other big sites if it was a generic

632
00:26:21,410 --> 00:26:26,240
sites our customers have been<font color="#E5E5E5"> too so</font>

633
00:26:24,710 --> 00:26:30,470
they have quite<font color="#E5E5E5"> a bit of information on</font>

634
00:26:26,240 --> 00:26:32,390
me would anyone like to take a stab at a

635
00:26:30,470 --> 00:26:38,180
guess how<font color="#CCCCCC"> long they retain that</font>

636
00:26:32,390 --> 00:26:42,380
information for so bearing in mind this

637
00:26:38,180 --> 00:26:44,180
is not<font color="#E5E5E5"> to give you important alerts this</font>

638
00:26:42,380 --> 00:26:47,780
is you've gone over your bandwidth would

639
00:26:44,180 --> 00:26:50,570
you like to buy more I would<font color="#E5E5E5"> think I</font>

640
00:26:47,780 --> 00:26:53,180
don't know I visit most sites I hit more

641
00:26:50,570 --> 00:26:57,159
than two pages on them in an hour maybe

642
00:26:53,180 --> 00:26:59,750
<font color="#E5E5E5">a day try 30 days retention which is</font>

643
00:26:57,160 --> 00:27:02,990
pretty ridiculous and when you consider

644
00:26:59,750 --> 00:27:04,460
the size of the subscriber base I hate

645
00:27:02,990 --> 00:27:09,560
to think<font color="#CCCCCC"> how much data that is</font>

646
00:27:04,460 --> 00:27:11,690
aggregated so i'll come back to<font color="#E5E5E5"> this</font><font color="#CCCCCC"> i</font>

647
00:27:09,560 --> 00:27:16,570
wanted to get back to mapping the

648
00:27:11,690 --> 00:27:18,650
network because i like being a pain so i

649
00:27:16,570 --> 00:27:20,810
didn't want<font color="#CCCCCC"> to send any direct probes</font>

650
00:27:18,650 --> 00:27:22,430
again don't want to be breaking laws

651
00:27:20,810 --> 00:27:24,200
probing networks doing anything like

652
00:27:22,430 --> 00:27:25,760
<font color="#E5E5E5">that</font><font color="#CCCCCC"> i just want to monitor the traffic</font>

653
00:27:24,200 --> 00:27:29,750
or differences in traffic between two

654
00:27:25,760 --> 00:27:33,590
endpoints I I own so what<font color="#E5E5E5"> do</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> use the</font>

655
00:27:29,750 --> 00:27:35,120
tool of<font color="#CCCCCC"> choice traceroute ish so for a</font>

656
00:27:33,590 --> 00:27:37,600
really quick recap because<font color="#E5E5E5"> I'm sure you</font>

657
00:27:35,120 --> 00:27:40,250
will know how it works<font color="#E5E5E5"> but traceroute</font>

658
00:27:37,600 --> 00:27:41,810
send a packet with<font color="#CCCCCC"> a TTL of</font><font color="#E5E5E5"> one it</font>

659
00:27:40,250 --> 00:27:43,790
expires at the<font color="#E5E5E5"> first hop you get an</font>

660
00:27:41,810 --> 00:27:45,530
expiring send it back of the TTL of<font color="#E5E5E5"> two</font>

661
00:27:43,790 --> 00:27:49,580
it goes down<font color="#E5E5E5"> to</font><font color="#CCCCCC"> one on the next stop you</font>

662
00:27:45,530 --> 00:27:51,110
get an expiry etc etc we've all<font color="#E5E5E5"> use</font>

663
00:27:49,580 --> 00:27:52,490
trades through anyone<font color="#E5E5E5"> that's done any</font>

664
00:27:51,110 --> 00:27:56,540
<font color="#E5E5E5">kind of sees happening on that work work</font>

665
00:27:52,490 --> 00:28:01,550
network work will have there are<font color="#CCCCCC"> some</font>

666
00:27:56,540 --> 00:28:03,889
conflicts in there are c99 1393 says the

667
00:28:01,550 --> 00:28:06,710
traceroute should be ICMP and that's

668
00:28:03,890 --> 00:28:07,910
what windows uses linux uses UDP by

669
00:28:06,710 --> 00:28:10,010
default and they're a bunch of other

670
00:28:07,910 --> 00:28:11,750
traceroutes out there but really all you

671
00:28:10,010 --> 00:28:14,090
<font color="#CCCCCC">need to remember is that trace route is</font>

672
00:28:11,750 --> 00:28:17,270
<font color="#CCCCCC">ttls the rest of it is kind of secondary</font>

673
00:28:14,090 --> 00:28:19,850
and the TTL is just an 8-bit field in an

674
00:28:17,270 --> 00:28:21,860
IP header know in a TCP header or UDP

675
00:28:19,850 --> 00:28:22,719
header in the IP header<font color="#E5E5E5"> that means you</font>

676
00:28:21,860 --> 00:28:25,240
can have any

677
00:28:22,720 --> 00:28:28,690
as long as<font color="#CCCCCC"> it's IP encapsulated you can</font>

678
00:28:25,240 --> 00:28:32,380
trace route on ipsec GRE tunnels<font color="#E5E5E5"> tcp</font>

679
00:28:28,690 --> 00:28:36,159
whatever so bearing that in mind we pick

680
00:28:32,380 --> 00:28:41,020
tcp trace through why because HTTPS is

681
00:28:36,159 --> 00:28:45,789
TCP and if i trace route on UDP ICMP and

682
00:28:41,020 --> 00:28:48,450
<font color="#CCCCCC">tcp traceroute on any random port I get</font>

683
00:28:45,789 --> 00:28:54,190
the same route if i trace route on 80<font color="#CCCCCC"> i</font>

684
00:28:48,450 --> 00:28:55,630
get a different<font color="#E5E5E5"> route so do you remember</font>

685
00:28:54,190 --> 00:28:57,460
a<font color="#E5E5E5"> few years ago when there were those</font>

686
00:28:55,630 --> 00:29:01,330
rumors about the signals intelligence

687
00:28:57,460 --> 00:29:05,530
secret room<font color="#CCCCCC"> in a certain IP made me</font>

688
00:29:01,330 --> 00:29:08,139
think of<font color="#CCCCCC"> it anyway so i am pretty</font>

689
00:29:05,530 --> 00:29:12,460
certain I've accounted for what is<font color="#E5E5E5"> p is</font>

690
00:29:08,140 --> 00:29:13,900
often use to to dissuade users from

691
00:29:12,460 --> 00:29:17,140
complaining<font color="#CCCCCC"> about traceroutes and things</font>

692
00:29:13,900 --> 00:29:19,960
the<font color="#CCCCCC"> whole oh well you know dynamic</font>

693
00:29:17,140 --> 00:29:23,159
routing blah blah<font color="#CCCCCC"> blah the root on the</font>

694
00:29:19,960 --> 00:29:25,330
<font color="#E5E5E5">left was consistent it was consistent on</font>

695
00:29:23,159 --> 00:29:27,250
every type of way<font color="#CCCCCC"> of taking tracer</font><font color="#E5E5E5"> I</font>

696
00:29:25,330 --> 00:29:29,830
<font color="#E5E5E5">could find the one on the right was</font>

697
00:29:27,250 --> 00:29:31,840
consistent for weeks using<font color="#E5E5E5"> TCP</font>

698
00:29:29,830 --> 00:29:34,750
traceroute I'm pretty sure that's<font color="#CCCCCC"> not</font>

699
00:29:31,840 --> 00:29:37,449
rooting fluctuations these timeouts

700
00:29:34,750 --> 00:29:39,610
happen every single<font color="#CCCCCC"> time that's not just</font>

701
00:29:37,450 --> 00:29:42,460
a<font color="#CCCCCC"> shonky connection and we can use that</font>

702
00:29:39,610 --> 00:29:46,959
and<font color="#CCCCCC"> I will produce you the world's</font>

703
00:29:42,460 --> 00:29:49,240
cheapest port scanner you do a<font color="#E5E5E5"> TCP trace</font>

704
00:29:46,960 --> 00:29:52,179
route for just those two hops on every

705
00:29:49,240 --> 00:29:55,870
single port and write it to a log then

706
00:29:52,179 --> 00:29:56,890
you grab four stars it's<font color="#E5E5E5"> very simple but</font>

707
00:29:55,870 --> 00:29:57,789
it does tell you what they're

708
00:29:56,890 --> 00:29:59,440
intercepting what they're not

709
00:29:57,789 --> 00:30:01,299
intercepting at least what they're

710
00:29:59,440 --> 00:30:04,780
intercepting and not intercepting using

711
00:30:01,299 --> 00:30:05,799
that technique to be fair<font color="#CCCCCC"> I then</font>

712
00:30:04,780 --> 00:30:07,149
actually had to go and trace through

713
00:30:05,799 --> 00:30:11,379
anything we stars because you've flagged

714
00:30:07,150 --> 00:30:13,720
up four or five ports but three or four

715
00:30:11,380 --> 00:30:16,090
of<font color="#E5E5E5"> those were being blocked hence the</font>

716
00:30:13,720 --> 00:30:17,590
<font color="#E5E5E5">timeouts they're blocking</font><font color="#CCCCCC"> netbios and I</font>

717
00:30:16,090 --> 00:30:19,120
think sequel and a couple of others that

718
00:30:17,590 --> 00:30:22,149
have been<font color="#E5E5E5"> used by worms and things so I</font>

719
00:30:19,120 --> 00:30:24,549
guess<font color="#CCCCCC"> that's kind of okay so it's port</font>

720
00:30:22,150 --> 00:30:26,880
80<font color="#E5E5E5"> that's intercepted and at this point</font>

721
00:30:24,549 --> 00:30:29,379
i went to go to my next stage of in

722
00:30:26,880 --> 00:30:33,299
investigation and wouldn't<font color="#CCCCCC"> you know the</font>

723
00:30:29,380 --> 00:30:33,299
<font color="#CCCCCC">ifp changed its network</font>

724
00:30:33,929 --> 00:30:42,850
but it's<font color="#E5E5E5"> not all bad news because</font><font color="#CCCCCC"> they</font>

725
00:30:37,419 --> 00:30:44,590
<font color="#E5E5E5">changed it to this see here's the fun</font>

726
00:30:42,850 --> 00:30:47,649
part not only does<font color="#CCCCCC"> he not</font><font color="#E5E5E5"> time out</font>

727
00:30:44,590 --> 00:30:50,740
anymore it's got more hops and you know

728
00:30:47,650 --> 00:30:53,980
what more hops means more TTL decrements

729
00:30:50,740 --> 00:30:56,110
as it passes through this is<font color="#E5E5E5"> really</font>

730
00:30:53,980 --> 00:31:00,820
useful because my cheap and nasty port

731
00:30:56,110 --> 00:31:03,539
scanner can get cheaper<font color="#CCCCCC"> and nastier now</font>

732
00:31:00,820 --> 00:31:05,830
you can just end map with a fixed TTL

733
00:31:03,539 --> 00:31:08,289
capture the packets at the other end and

734
00:31:05,830 --> 00:31:10,840
<font color="#CCCCCC">just look at which ones have a big TTL</font>

735
00:31:08,289 --> 00:31:12,960
and which have a small TTL the ones<font color="#E5E5E5"> with</font>

736
00:31:10,840 --> 00:31:15,549
the smaller TTL they got intercepted

737
00:31:12,960 --> 00:31:19,179
though the spoiler is it is still 80 but

738
00:31:15,549 --> 00:31:23,490
there we go and I<font color="#CCCCCC"> still have I still now</font>

739
00:31:19,179 --> 00:31:26,320
know that<font color="#CCCCCC"> it reversed another network</font>

740
00:31:23,490 --> 00:31:29,679
but<font color="#E5E5E5"> that's part of the story on the on</font>

741
00:31:26,320 --> 00:31:32,649
the the probing the network you've got

742
00:31:29,679 --> 00:31:34,299
which interface it uses to you see

743
00:31:32,650 --> 00:31:36,809
normally<font color="#CCCCCC"> when you trace route you expect</font>

744
00:31:34,299 --> 00:31:40,059
to see this interface as the reply and

745
00:31:36,809 --> 00:31:41,590
that is normally what you<font color="#E5E5E5"> get but that's</font>

746
00:31:40,059 --> 00:31:43,840
because your trace routing the nice way

747
00:31:41,590 --> 00:31:47,860
without using silly things like<font color="#E5E5E5"> I ended</font>

748
00:31:43,840 --> 00:31:50,350
up doing<font color="#E5E5E5"> because is that interface used</font>

749
00:31:47,860 --> 00:31:53,740
because it's the incoming interface of

750
00:31:50,350 --> 00:31:55,299
your packet that expired is it the

751
00:31:53,740 --> 00:31:57,460
interface<font color="#CCCCCC"> is used because it's default</font>

752
00:31:55,299 --> 00:31:59,980
interface is it the interface is used

753
00:31:57,460 --> 00:32:04,330
because it<font color="#CCCCCC"> is the outgoing packet for</font>

754
00:31:59,980 --> 00:32:06,970
the expiry notification normally you

755
00:32:04,330 --> 00:32:10,110
can't tell because it would<font color="#CCCCCC"> be all three</font>

756
00:32:06,970 --> 00:32:12,520
and you don't<font color="#CCCCCC"> know which one is picked</font>

757
00:32:10,110 --> 00:32:14,139
so you can turn to our season look at

758
00:32:12,520 --> 00:32:16,480
this and the best thing<font color="#E5E5E5"> about our seas</font>

759
00:32:14,140 --> 00:32:18,750
is there so random<font color="#E5E5E5"> because they disagree</font>

760
00:32:16,480 --> 00:32:21,130
contradict each other and ambiguous

761
00:32:18,750 --> 00:32:22,809
luckily<font color="#E5E5E5"> what this means is all the</font>

762
00:32:21,130 --> 00:32:24,039
vendor implementations are two and they

763
00:32:22,809 --> 00:32:25,299
all do different things<font color="#E5E5E5"> and you can</font>

764
00:32:24,039 --> 00:32:28,830
trick different devices in different

765
00:32:25,299 --> 00:32:31,510
ways<font color="#E5E5E5"> so we use this to get information</font>

766
00:32:28,830 --> 00:32:35,320
we can look to capture this address or

767
00:32:31,510 --> 00:32:38,740
this address maybe<font color="#E5E5E5"> I spoof a packet from</font>

768
00:32:35,320 --> 00:32:41,950
me I send a packet from me but I spoof

769
00:32:38,740 --> 00:32:43,899
it<font color="#E5E5E5"> to come from my server to a target</font>

770
00:32:41,950 --> 00:32:45,809
the target doesn't really matter it's

771
00:32:43,899 --> 00:32:48,520
<font color="#CCCCCC">like sending a packet to Google or some</font>

772
00:32:45,809 --> 00:32:50,440
but this changes what the source address

773
00:32:48,520 --> 00:32:54,190
<font color="#E5E5E5">what the source interface was of the</font>

774
00:32:50,440 --> 00:32:56,559
packet at a physical<font color="#CCCCCC"> level and at an IP</font>

775
00:32:54,190 --> 00:32:59,530
level because my server is now the

776
00:32:56,559 --> 00:33:02,590
source so guess which interface the

777
00:32:59,530 --> 00:33:06,580
packet comes from not the one facing my

778
00:33:02,590 --> 00:33:09,490
desktop you can do the same<font color="#E5E5E5"> traceroute</font>

779
00:33:06,580 --> 00:33:11,080
backwards from my server like that you

780
00:33:09,490 --> 00:33:13,059
can do it doing things like coming

781
00:33:11,080 --> 00:33:15,100
backwards from my server and setting the

782
00:33:13,059 --> 00:33:17,020
source port<font color="#E5E5E5"> to 80 and the destination</font>

783
00:33:15,100 --> 00:33:19,928
port to a high port so it<font color="#E5E5E5"> looks</font><font color="#CCCCCC"> like the</font>

784
00:33:17,020 --> 00:33:22,210
returning packet from an HTTP connection

785
00:33:19,929 --> 00:33:24,340
you can put a knack flag on there or<font color="#E5E5E5"> a</font>

786
00:33:22,210 --> 00:33:26,010
cynic flag so it looks like part of a

787
00:33:24,340 --> 00:33:29,290
handshake so it follows the right route

788
00:33:26,010 --> 00:33:32,530
by using this you can get the replies to

789
00:33:29,290 --> 00:33:33,940
pretty much all the interfaces if you

790
00:33:32,530 --> 00:33:36,639
want to try this at<font color="#CCCCCC"> home you can</font><font color="#E5E5E5"> do</font>

791
00:33:33,940 --> 00:33:40,960
<font color="#E5E5E5">something like this Scotty is a packet</font>

792
00:33:36,640 --> 00:33:43,870
crafting library for python unless you

793
00:33:40,960 --> 00:33:46,059
just spoof arbitrary packets this is a

794
00:33:43,870 --> 00:33:49,989
one line command that will spoof packets

795
00:33:46,059 --> 00:33:53,649
for a 30 hop traceroute see the TTL 130

796
00:33:49,990 --> 00:33:55,540
that does<font color="#CCCCCC"> ttls from 1 through 2 30 you</font>

797
00:33:53,650 --> 00:33:57,910
set the source and<font color="#E5E5E5"> destination that you</font>

798
00:33:55,540 --> 00:34:00,730
would like and you have to make<font color="#CCCCCC"> sure you</font>

799
00:33:57,910 --> 00:34:02,890
set the MAC<font color="#E5E5E5"> addresses because you are no</font>

800
00:34:00,730 --> 00:34:04,510
longer sending a packet that's valid on

801
00:34:02,890 --> 00:34:07,510
your network so you have to make<font color="#CCCCCC"> sure</font>

802
00:34:04,510 --> 00:34:10,359
that your default gateway gets it via

803
00:34:07,510 --> 00:34:11,350
layer 2 doesn't<font color="#E5E5E5"> matter about the source</font>

804
00:34:10,359 --> 00:34:13,029
cuz you're not actually getting<font color="#E5E5E5"> the</font>

805
00:34:11,350 --> 00:34:15,219
reply to capturing those on the server

806
00:34:13,030 --> 00:34:19,030
on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> internet the rest of it is normal</font>

807
00:34:15,219 --> 00:34:23,500
stuff setting interfaces ports etc so

808
00:34:19,030 --> 00:34:27,250
talking<font color="#E5E5E5"> about that I HP Network you can</font>

809
00:34:23,500 --> 00:34:30,550
take a normal traceroute think you can

810
00:34:27,250 --> 00:34:33,100
then take my<font color="#E5E5E5"> other trade route and then</font>

811
00:34:30,550 --> 00:34:34,600
you can<font color="#E5E5E5"> apply everything I was just</font>

812
00:34:33,100 --> 00:34:37,868
saying about traceroute<font color="#E5E5E5"> spoofed</font>

813
00:34:34,600 --> 00:34:39,850
traceroutes and<font color="#CCCCCC"> a get acquire all those</font>

814
00:34:37,869 --> 00:34:41,350
IP addresses for the<font color="#E5E5E5"> rooters because</font>

815
00:34:39,850 --> 00:34:43,179
really you're treating them as to

816
00:34:41,350 --> 00:34:45,250
interface devices at this point and<font color="#E5E5E5"> you</font>

817
00:34:43,179 --> 00:34:48,070
can map out the whole network and<font color="#CCCCCC"> I have</font>

818
00:34:45,250 --> 00:34:50,560
done but it I've not got it<font color="#E5E5E5"> here because</font>

819
00:34:48,070 --> 00:34:52,869
<font color="#E5E5E5">the IP</font><font color="#CCCCCC"> address is on this just</font><font color="#E5E5E5"> a</font>

820
00:34:50,560 --> 00:34:54,969
cluttered mess of horrible but the point

821
00:34:52,869 --> 00:34:56,050
<font color="#E5E5E5">is you can map the network out but</font>

822
00:34:54,969 --> 00:34:58,149
that's not<font color="#E5E5E5"> really the whole picture</font>

823
00:34:56,050 --> 00:34:59,079
because when you really want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> know</font>

824
00:34:58,150 --> 00:35:01,329
<font color="#E5E5E5">what packet and jack</font>

825
00:34:59,079 --> 00:35:05,019
happening not just look at the rooters

826
00:35:01,329 --> 00:35:06,940
so one thing<font color="#CCCCCC"> I carefully omitted earlier</font>

827
00:35:05,019 --> 00:35:12,189
was in their scripts they make a little

828
00:35:06,940 --> 00:35:14,829
tiny slip-up and state the IP addresses

829
00:35:12,190 --> 00:35:19,450
of the server both inside and outside in

830
00:35:14,829 --> 00:35:21,759
the<font color="#CCCCCC"> JavaScript so the external web</font>

831
00:35:19,450 --> 00:35:25,779
server is easy you can trace for<font color="#E5E5E5"> it rude</font>

832
00:35:21,759 --> 00:35:28,630
to it it is connected<font color="#CCCCCC"> here the internal</font>

833
00:35:25,779 --> 00:35:30,160
one is RC 1918 address space so that's

834
00:35:28,630 --> 00:35:32,650
off on some private internal management

835
00:35:30,160 --> 00:35:34,359
<font color="#E5E5E5">land but we still</font><font color="#CCCCCC"> don't know where it's</font>

836
00:35:32,650 --> 00:35:36,670
injecting because that's the interface

837
00:35:34,359 --> 00:35:39,190
used by the device to<font color="#CCCCCC"> provide a web page</font>

838
00:35:36,670 --> 00:35:44,739
that's the IP<font color="#CCCCCC"> address that it sends the</font>

839
00:35:39,190 --> 00:35:48,569
<font color="#CCCCCC">data to but we have that fixed TTL it</font>

840
00:35:44,739 --> 00:35:51,729
came out as 123 every time now most os's

841
00:35:48,569 --> 00:35:55,089
use round numbers or at least hex round

842
00:35:51,729 --> 00:35:58,359
numbers so 32 64 128 there they pretty

843
00:35:55,089 --> 00:36:00,519
much the core default TTL to have on an

844
00:35:58,359 --> 00:36:02,680
OS so bearing on working on the

845
00:36:00,519 --> 00:36:05,948
assumption that they probably<font color="#E5E5E5"> are using</font>

846
00:36:02,680 --> 00:36:09,098
a default TTL you can make a random

847
00:36:05,949 --> 00:36:11,920
guess well if I'm<font color="#E5E5E5"> getting one that's 123</font>

848
00:36:09,099 --> 00:36:14,829
as my TTL I can pretty much guarantee

849
00:36:11,920 --> 00:36:16,959
<font color="#CCCCCC">that it's 128 they're using quick bit of</font>

850
00:36:14,829 --> 00:36:20,259
subtraction and you know exactly<font color="#CCCCCC"> how</font>

851
00:36:16,959 --> 00:36:23,019
many hops in they<font color="#CCCCCC"> are also i have just</font>

852
00:36:20,259 --> 00:36:25,660
skipped<font color="#CCCCCC"> heads</font><font color="#E5E5E5"> i did that wrong that</font>

853
00:36:23,019 --> 00:36:29,999
isn't it they left in the script this is

854
00:36:25,660 --> 00:36:32,140
server and the management<font color="#CCCCCC"> lan and then</font>

855
00:36:29,999 --> 00:36:34,868
that is where the injections happening

856
00:36:32,140 --> 00:36:36,999
just through taking<font color="#E5E5E5"> away the TT l's from</font>

857
00:36:34,869 --> 00:36:39,430
the default etl and you know that that's

858
00:36:36,999 --> 00:36:41,078
where the injections happening really<font color="#CCCCCC"> i</font>

859
00:36:39,430 --> 00:36:43,419
should have done<font color="#CCCCCC"> a much better test if</font>

860
00:36:41,079 --> 00:36:46,029
I'd have thought this through I would

861
00:36:43,420 --> 00:36:47,920
have<font color="#E5E5E5"> done this I would have written</font>

862
00:36:46,029 --> 00:36:49,359
something to do an HTTP request that

863
00:36:47,920 --> 00:36:51,910
there's a handshake and then sends the

864
00:36:49,359 --> 00:36:54,699
HTTP<font color="#CCCCCC"> requests with increasing TTL until</font>

865
00:36:51,910 --> 00:36:56,410
the server gets a reset but I was not

866
00:36:54,699 --> 00:37:00,519
that smart and hindsight is

867
00:36:56,410 --> 00:37:03,609
<font color="#CCCCCC">twenty-twenty anyway let's move on is</font>

868
00:37:00,519 --> 00:37:05,729
this something<font color="#E5E5E5"> that's purely to me or</font>

869
00:37:03,609 --> 00:37:09,279
can this technique be used elsewhere

870
00:37:05,729 --> 00:37:10,549
does it apply to other other

871
00:37:09,279 --> 00:37:15,260
environments

872
00:37:10,550 --> 00:37:17,870
I went home to the UK who have a

873
00:37:15,260 --> 00:37:20,210
government-mandated filter content

874
00:37:17,870 --> 00:37:23,420
filter on certain websites if you

875
00:37:20,210 --> 00:37:25,070
connect via British Telecom this is the

876
00:37:23,420 --> 00:37:27,230
way you get to the Pirate Bay on a

877
00:37:25,070 --> 00:37:30,350
completely different IP address and a

878
00:37:27,230 --> 00:37:32,030
different route in the middle as it

879
00:37:30,350 --> 00:37:34,400
happens the<font color="#E5E5E5"> same happens if you try to</font>

880
00:37:32,030 --> 00:37:37,280
go to the tour website and a few other

881
00:37:34,400 --> 00:37:39,830
ones and then I went<font color="#E5E5E5"> to the US and was</font>

882
00:37:37,280 --> 00:37:43,250
in a<font color="#CCCCCC"> Merry it which was on a road runner</font>

883
00:37:39,830 --> 00:37:44,960
network and that happened and I have no

884
00:37:43,250 --> 00:37:46,130
<font color="#CCCCCC">idea</font><font color="#E5E5E5"> why and I didn't even</font><font color="#CCCCCC"> dig into that</font>

885
00:37:44,960 --> 00:37:48,920
<font color="#CCCCCC">because I wasn't there</font><font color="#E5E5E5"> long but the</font>

886
00:37:46,130 --> 00:37:51,260
<font color="#E5E5E5">point is it's pretty easy to detect when</font>

887
00:37:48,920 --> 00:37:52,910
HTTP is being treated differently and

888
00:37:51,260 --> 00:37:54,860
when it's<font color="#E5E5E5"> not a hot one or two right</font>

889
00:37:52,910 --> 00:37:56,240
next to you it's not something on your

890
00:37:54,860 --> 00:37:57,710
network doing it that's something

891
00:37:56,240 --> 00:37:59,029
happening<font color="#CCCCCC"> at a provider and if you can</font>

892
00:37:57,710 --> 00:38:03,680
repeat<font color="#E5E5E5"> it over and over again there's</font>

893
00:37:59,030 --> 00:38:06,290
probably a reason so back to<font color="#CCCCCC"> the topic</font>

894
00:38:03,680 --> 00:38:08,660
at hand I want you to see what I could

895
00:38:06,290 --> 00:38:10,730
see from the injected p injected pages

896
00:38:08,660 --> 00:38:16,509
both the headers and the scripts and see

897
00:38:10,730 --> 00:38:19,190
what we can work out so here<font color="#CCCCCC"> is header</font>

898
00:38:16,510 --> 00:38:21,410
from one of the pages that got injected

899
00:38:19,190 --> 00:38:24,440
there are a few things<font color="#E5E5E5"> to notice there</font>

900
00:38:21,410 --> 00:38:27,379
is a server string and that looks<font color="#E5E5E5"> like a</font>

901
00:38:24,440 --> 00:38:29,750
manufacturer name so we'll just bear

902
00:38:27,380 --> 00:38:31,700
that one in<font color="#E5E5E5"> my new sec I just want to go</font>

903
00:38:29,750 --> 00:38:36,290
<font color="#E5E5E5">on a brief tangent to talk about HTTP</font>

904
00:38:31,700 --> 00:38:38,509
recon HTTP recon is an app<font color="#CCCCCC"> that profiles</font>

905
00:38:36,290 --> 00:38:41,300
web servers and it does in a very unique

906
00:38:38,510 --> 00:38:42,650
way it looks at the headers<font color="#E5E5E5"> but it</font>

907
00:38:41,300 --> 00:38:44,420
<font color="#E5E5E5">doesn't trust things like the server</font>

908
00:38:42,650 --> 00:38:47,150
<font color="#E5E5E5">string it looks at the order that the</font>

909
00:38:44,420 --> 00:38:49,520
head has come in because there is no

910
00:38:47,150 --> 00:38:52,670
rule that says content length has to

911
00:38:49,520 --> 00:38:54,380
come above connection different servers

912
00:38:52,670 --> 00:38:58,340
have different implementations some of

913
00:38:54,380 --> 00:38:59,720
<font color="#E5E5E5">them Amit entire head is entirely the</font>

914
00:38:58,340 --> 00:39:02,150
other thing is<font color="#E5E5E5"> if you look at cache</font>

915
00:38:59,720 --> 00:39:04,669
control within<font color="#CCCCCC"> any one header fields</font>

916
00:39:02,150 --> 00:39:08,660
come in different orders so you can<font color="#E5E5E5"> use</font>

917
00:39:04,670 --> 00:39:10,640
HTTP recon to look at something and work

918
00:39:08,660 --> 00:39:12,470
out<font color="#E5E5E5"> what the server it is without having</font>

919
00:39:10,640 --> 00:39:14,600
to rely on<font color="#E5E5E5"> any strings coming back</font>

920
00:39:12,470 --> 00:39:16,759
purely how it performs on a header basis

921
00:39:14,600 --> 00:39:19,460
but I didn't<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> probe anything</font>

922
00:39:16,760 --> 00:39:22,010
remember luckily they give an offline

923
00:39:19,460 --> 00:39:24,980
database so you can do a manual painful

924
00:39:22,010 --> 00:39:26,480
all now this isn't enough to get it you

925
00:39:24,980 --> 00:39:28,070
need to get other pages you need to get

926
00:39:26,480 --> 00:39:31,580
<font color="#CCCCCC">a response</font><font color="#E5E5E5"> redirect or something like</font>

927
00:39:28,070 --> 00:39:33,200
that luckily as I mentioned earlier they

928
00:39:31,580 --> 00:39:36,230
forget to forgot to include the no

929
00:39:33,200 --> 00:39:39,560
script page so i have a 404 as well from

930
00:39:36,230 --> 00:39:42,380
when I had no script running again same

931
00:39:39,560 --> 00:39:45,140
vendor as same ordering on the<font color="#CCCCCC"> cache</font>

932
00:39:42,380 --> 00:39:47,090
<font color="#E5E5E5">control and all that sort of thing so I</font>

933
00:39:45,140 --> 00:39:49,609
managed to look it up and I can profile

934
00:39:47,090 --> 00:39:52,760
what the server is and the<font color="#CCCCCC"> Shocker is</font>

935
00:39:49,610 --> 00:39:54,920
<font color="#CCCCCC">it's Apache there was some more hints in</font>

936
00:39:52,760 --> 00:40:00,470
the<font color="#E5E5E5"> script they put a copyright Perth</font>

937
00:39:54,920 --> 00:40:03,500
tech at the top that's handy um they

938
00:40:00,470 --> 00:40:05,750
have those<font color="#CCCCCC"> too you're at those two web</font>

939
00:40:03,500 --> 00:40:08,600
server addresses also they gave this

940
00:40:05,750 --> 00:40:10,910
commented out display URL which looks

941
00:40:08,600 --> 00:40:12,589
like a URL that may or may<font color="#CCCCCC"> not go</font>

942
00:40:10,910 --> 00:40:15,850
together with the manufacturer name that

943
00:40:12,590 --> 00:40:18,440
<font color="#E5E5E5">I just noticed so let's go to their site</font>

944
00:40:15,850 --> 00:40:21,170
their site says bandwidth usage

945
00:40:18,440 --> 00:40:25,490
notifications that sounds like we could

946
00:40:21,170 --> 00:40:27,140
<font color="#E5E5E5">be on to some kind of winner um they</font>

947
00:40:25,490 --> 00:40:30,529
they<font color="#E5E5E5"> don't publish their customer list</font>

948
00:40:27,140 --> 00:40:32,480
they do have a news list but it doesn't

949
00:40:30,530 --> 00:40:35,150
mention customers and I look to<font color="#CCCCCC"> my eyes</font>

950
00:40:32,480 --> 00:40:37,580
peas<font color="#E5E5E5"> web page and they don't publish who</font>

951
00:40:35,150 --> 00:40:39,560
they partner with a GI I should revise

952
00:40:37,580 --> 00:40:41,210
that neither of them say anymore they

953
00:40:39,560 --> 00:40:42,380
did both mention each other in<font color="#E5E5E5"> the past</font>

954
00:40:41,210 --> 00:40:46,220
but they've taken that down<font color="#CCCCCC"> for some</font>

955
00:40:42,380 --> 00:40:48,230
<font color="#CCCCCC">reason the one thing</font><font color="#E5E5E5"> I will of me is I</font>

956
00:40:46,220 --> 00:40:52,220
forgot to screen grab that so I can't go

957
00:40:48,230 --> 00:40:55,190
back so<font color="#E5E5E5"> that's my big learning anyway if</font>

958
00:40:52,220 --> 00:40:57,500
we look elsewhere this company does do a

959
00:40:55,190 --> 00:41:02,420
bunch of<font color="#E5E5E5"> different products and many of</font>

960
00:40:57,500 --> 00:41:04,070
them have good intense there are things

961
00:41:02,420 --> 00:41:06,980
<font color="#CCCCCC">like</font><font color="#E5E5E5"> doing amber alerts in web pages and</font>

962
00:41:04,070 --> 00:41:09,830
that sort of<font color="#CCCCCC"> stuff but the one common</font>

963
00:41:06,980 --> 00:41:11,360
thread across all of them is that<font color="#CCCCCC"> you</font>

964
00:41:09,830 --> 00:41:12,650
probably need to<font color="#E5E5E5"> man in the middle and</font>

965
00:41:11,360 --> 00:41:14,060
packet inject for nearly all their

966
00:41:12,650 --> 00:41:15,230
services so I think it's<font color="#CCCCCC"> probably a</font>

967
00:41:14,060 --> 00:41:19,759
shared platform with slightly different

968
00:41:15,230 --> 00:41:22,490
uses like a revenue extenders search in

969
00:41:19,760 --> 00:41:25,940
half enhancement monetization not using

970
00:41:22,490 --> 00:41:28,520
DNS cough advertising cuff I don't know

971
00:41:25,940 --> 00:41:30,470
if Rogers uses this one but it<font color="#E5E5E5"> is a</font>

972
00:41:28,520 --> 00:41:32,770
thing<font color="#E5E5E5"> and it exists on the platform that</font>

973
00:41:30,470 --> 00:41:32,770
they use

974
00:41:32,780 --> 00:41:37,980
also<font color="#E5E5E5"> I noticed that it doesn't appear</font><font color="#CCCCCC"> in</font>

975
00:41:36,150 --> 00:41:40,080
archive.org so I can go and<font color="#E5E5E5"> look at the</font>

976
00:41:37,980 --> 00:41:41,730
old pages which is interesting because

977
00:41:40,080 --> 00:41:44,700
they don't prohibit looking at those

978
00:41:41,730 --> 00:41:46,230
pages in robots.txt and archive.org say

979
00:41:44,700 --> 00:41:48,899
on the front of their page we only

980
00:41:46,230 --> 00:41:51,660
remove pages if they're not<font color="#E5E5E5"> if they're</font>

981
00:41:48,900 --> 00:41:53,660
in the robot stop text or use explicitly

982
00:41:51,660 --> 00:41:57,690
come to us and ask for it to be removed

983
00:41:53,660 --> 00:42:00,839
just say so wondered if anyone else use

984
00:41:57,690 --> 00:42:07,620
this and into my twitter feed pop this I

985
00:42:00,840 --> 00:42:10,620
thought<font color="#E5E5E5"> maybe they do ahem I can't say</font>

986
00:42:07,620 --> 00:42:12,180
for sure that Comcast are using this but

987
00:42:10,620 --> 00:42:14,400
I can say for sure from looking at the

988
00:42:12,180 --> 00:42:17,750
web page<font color="#CCCCCC"> that they</font><font color="#E5E5E5"> are a customer of the</font>

989
00:42:14,400 --> 00:42:22,290
same company not to mention i found this

990
00:42:17,750 --> 00:42:25,290
note the URL so bulletin is the internal

991
00:42:22,290 --> 00:42:26,820
name for this system so they use the

992
00:42:25,290 --> 00:42:29,190
same<font color="#E5E5E5"> system that Rogers is doing so it's</font>

993
00:42:26,820 --> 00:42:30,720
entirely possible that's true but

994
00:42:29,190 --> 00:42:31,830
looking at this and this only happened a

995
00:42:30,720 --> 00:42:34,169
couple of<font color="#CCCCCC"> weeks ago</font><font color="#E5E5E5"> when I was preparing</font>

996
00:42:31,830 --> 00:42:39,060
for<font color="#CCCCCC"> this presentation I noticed</font>

997
00:42:34,170 --> 00:42:40,890
something I noticed this so that goes

998
00:42:39,060 --> 00:42:42,779
from you're not just<font color="#CCCCCC"> looking at IP</font>

999
00:42:40,890 --> 00:42:44,279
headers you're not just looking at HTTP

1000
00:42:42,780 --> 00:42:47,100
headers you're not just looking at

1001
00:42:44,280 --> 00:42:50,760
document history oh you've tied it to my

1002
00:42:47,100 --> 00:42:53,670
account<font color="#E5E5E5"> not my IP address my account I'm</font>

1003
00:42:50,760 --> 00:42:57,390
getting<font color="#E5E5E5"> to the point of being a little</font>

1004
00:42:53,670 --> 00:42:58,830
concerned about<font color="#E5E5E5"> this so you probably</font>

1005
00:42:57,390 --> 00:43:02,190
know the answer<font color="#CCCCCC"> to this</font><font color="#E5E5E5"> but why am I</font>

1006
00:42:58,830 --> 00:43:03,990
bothered<font color="#CCCCCC"> data gathering changing data</font>

1007
00:43:02,190 --> 00:43:05,400
and the fact you've got a lot of context

1008
00:43:03,990 --> 00:43:07,589
in correlation<font color="#CCCCCC"> that you could draw from</font>

1009
00:43:05,400 --> 00:43:11,340
these let me just illustrate that with

1010
00:43:07,590 --> 00:43:15,420
something this<font color="#E5E5E5"> is a slide that the eff</font>

1011
00:43:11,340 --> 00:43:17,730
did and they brought it out when there

1012
00:43:15,420 --> 00:43:21,060
was all the talk about the metadata

1013
00:43:17,730 --> 00:43:23,070
collection from verizon<font color="#CCCCCC"> I'm not going</font>

1014
00:43:21,060 --> 00:43:24,930
<font color="#E5E5E5">into</font><font color="#CCCCCC"> that that's a whole other topic but</font>

1015
00:43:23,070 --> 00:43:26,730
the<font color="#E5E5E5"> point is that you don't actually</font>

1016
00:43:24,930 --> 00:43:28,319
need<font color="#CCCCCC"> to go into</font><font color="#E5E5E5"> a whole lot</font><font color="#CCCCCC"> of detail to</font>

1017
00:43:26,730 --> 00:43:31,590
<font color="#CCCCCC">be able</font><font color="#E5E5E5"> to put</font><font color="#CCCCCC"> a picture together about</font>

1018
00:43:28,320 --> 00:43:33,600
someone and if you've got a rolling

1019
00:43:31,590 --> 00:43:35,610
30-day history on someone at that<font color="#E5E5E5"> time</font>

1020
00:43:33,600 --> 00:43:37,650
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> probably put quite a lot</font>

1021
00:43:35,610 --> 00:43:40,170
together now this is about cell phones

1022
00:43:37,650 --> 00:43:43,590
so granted this does not pertain

1023
00:43:40,170 --> 00:43:45,280
directly to this but bearing in mind

1024
00:43:43,590 --> 00:43:47,869
what<font color="#E5E5E5"> we say</font>

1025
00:43:45,280 --> 00:43:51,650
let's take a quick<font color="#CCCCCC"> look at an HTTP</font>

1026
00:43:47,869 --> 00:43:54,080
header<font color="#E5E5E5"> you have got between that get</font>

1027
00:43:51,650 --> 00:43:56,810
<font color="#CCCCCC">request on the</font><font color="#E5E5E5"> host the entire URL of</font>

1028
00:43:54,080 --> 00:43:59,779
what I'm visiting a news region you have

1029
00:43:56,810 --> 00:44:02,779
<font color="#CCCCCC">both my OS and the browser I'm using and</font>

1030
00:43:59,780 --> 00:44:04,820
the version that i'm<font color="#CCCCCC"> using the accept</font>

1031
00:44:02,780 --> 00:44:07,940
language will tell you what language I'm

1032
00:44:04,820 --> 00:44:10,910
speaking cookies will<font color="#CCCCCC"> come back to</font>

1033
00:44:07,940 --> 00:44:12,530
cookies and<font color="#E5E5E5"> it's modified since is meant</font>

1034
00:44:10,910 --> 00:44:15,259
for cash control but what<font color="#E5E5E5"> that tells</font>

1035
00:44:12,530 --> 00:44:17,240
someone sniffing is the last date that I

1036
00:44:15,260 --> 00:44:18,740
<font color="#E5E5E5">went to a page because my browser is</font>

1037
00:44:17,240 --> 00:44:21,859
asking if the page has changed since

1038
00:44:18,740 --> 00:44:26,270
then so I know whether to load a new

1039
00:44:21,859 --> 00:44:29,869
<font color="#E5E5E5">copy or use the cache copy going back</font><font color="#CCCCCC"> to</font>

1040
00:44:26,270 --> 00:44:33,770
cookies cookies are rightly incredibly

1041
00:44:29,869 --> 00:44:35,720
useful for tracking someone because the

1042
00:44:33,770 --> 00:44:37,759
combination cookies that<font color="#CCCCCC"> you have is</font>

1043
00:44:35,720 --> 00:44:41,000
pretty unique and there were documents

1044
00:44:37,760 --> 00:44:43,730
that came out in light of the Snowden

1045
00:44:41,000 --> 00:44:45,710
stuff but we're saying about how

1046
00:44:43,730 --> 00:44:47,930
different signals intelligence agencies

1047
00:44:45,710 --> 00:44:50,510
around the world were quite interested

1048
00:44:47,930 --> 00:44:52,310
in cookies because advertising networks

1049
00:44:50,510 --> 00:44:55,070
<font color="#E5E5E5">push so hard to get cookies on your</font>

1050
00:44:52,310 --> 00:44:57,950
machine unique cookies that track you

1051
00:44:55,070 --> 00:45:00,530
the through cookies alone you can quite

1052
00:44:57,950 --> 00:45:02,118
accurately track an individual tie this

1053
00:45:00,530 --> 00:45:04,730
with the other info and you get quite a

1054
00:45:02,119 --> 00:45:08,089
good quite a good picture of what's

1055
00:45:04,730 --> 00:45:11,980
<font color="#CCCCCC">going on so it brings me</font><font color="#E5E5E5"> to another</font>

1056
00:45:08,089 --> 00:45:15,020
question what<font color="#E5E5E5"> could possibly go wrong</font>

1057
00:45:11,980 --> 00:45:20,960
especially to arbitrary things together

1058
00:45:15,020 --> 00:45:23,630
going<font color="#E5E5E5"> wrong see um because it's just</font>

1059
00:45:20,960 --> 00:45:25,640
messaging right it's<font color="#CCCCCC"> just a banner I'm</font>

1060
00:45:23,630 --> 00:45:28,130
all think<font color="#E5E5E5"> of it this way what if my</font><font color="#CCCCCC"> ihp</font>

1061
00:45:25,640 --> 00:45:30,770
was malicious for some reason what if

1062
00:45:28,130 --> 00:45:35,359
<font color="#E5E5E5">they were coerced by a third party or</font>

1063
00:45:30,770 --> 00:45:37,880
just a rogue member of staff they could

1064
00:45:35,359 --> 00:45:40,310
misuse this platform think about when

1065
00:45:37,880 --> 00:45:42,050
you go to https sites<font color="#CCCCCC"> okay this room a</font>

1066
00:45:40,310 --> 00:45:43,910
bigger the exact the exception to<font color="#CCCCCC"> the</font>

1067
00:45:42,050 --> 00:45:47,270
<font color="#CCCCCC">rule</font><font color="#E5E5E5"> think about when everyone else goes</font>

1068
00:45:43,910 --> 00:45:49,730
to https sites who types<font color="#CCCCCC"> https colon</font>

1069
00:45:47,270 --> 00:45:51,970
slash slash or who goes to the HTTP one

1070
00:45:49,730 --> 00:45:55,730
and lets it bounce you to the<font color="#E5E5E5"> HTTPS one</font>

1071
00:45:51,970 --> 00:45:59,259
has anyone seen<font color="#E5E5E5"> Moxie's</font><font color="#CCCCCC"> SSL scrip it</font>

1072
00:45:55,730 --> 00:46:04,430
does it takes advantage<font color="#CCCCCC"> of exactly this</font>

1073
00:45:59,260 --> 00:46:06,860
ssl strip you go to the HDTV site<font color="#CCCCCC"> it we</font>

1074
00:46:04,430 --> 00:46:10,819
change is all the links to http so it

1075
00:46:06,860 --> 00:46:11,930
never bounces<font color="#E5E5E5"> you to https so consider</font>

1076
00:46:10,820 --> 00:46:14,510
for a second that there's someone

1077
00:46:11,930 --> 00:46:16,190
malicious on this box what if<font color="#E5E5E5"> they took</font>

1078
00:46:14,510 --> 00:46:17,900
control of the management<font color="#E5E5E5"> console and</font>

1079
00:46:16,190 --> 00:46:21,380
instead of injecting ads<font color="#E5E5E5"> we're injecting</font>

1080
00:46:17,900 --> 00:46:22,730
malware or<font color="#CCCCCC"> javascript exploits or or the</font>

1081
00:46:21,380 --> 00:46:24,770
<font color="#E5E5E5">sort of thing that you hear about</font>

1082
00:46:22,730 --> 00:46:27,560
oppressive regimes doing where they put

1083
00:46:24,770 --> 00:46:29,180
up fake adobe acrobat updates and drop

1084
00:46:27,560 --> 00:46:32,029
malware on a box or something like that

1085
00:46:29,180 --> 00:46:34,899
and<font color="#E5E5E5"> actually start to build up a botnet</font>

1086
00:46:32,030 --> 00:46:37,910
or own people in the traditional way

1087
00:46:34,900 --> 00:46:39,650
well it's not<font color="#CCCCCC"> like you know management</font>

1088
00:46:37,910 --> 00:46:45,859
<font color="#E5E5E5">boxes</font><font color="#CCCCCC"> I left kicking around the internet</font>

1089
00:46:39,650 --> 00:46:48,500
is it they don't do<font color="#CCCCCC"> that much so Rogers</font>

1090
00:46:45,860 --> 00:46:50,420
didn't do this I've got<font color="#E5E5E5"> to be fair</font><font color="#CCCCCC"> to</font>

1091
00:46:48,500 --> 00:46:52,100
them on that and this isn't

1092
00:46:50,420 --> 00:46:54,710
representative there are actually<font color="#CCCCCC"> more</font>

1093
00:46:52,100 --> 00:46:57,200
<font color="#CCCCCC">than that but my geoip database put</font>

1094
00:46:54,710 --> 00:47:00,920
multiple people in the same place this

1095
00:46:57,200 --> 00:47:04,069
is actually 40 nodes about a 50-50 split

1096
00:47:00,920 --> 00:47:06,890
between injection nodes and management

1097
00:47:04,070 --> 00:47:09,790
notes and it's ridiculously simple to

1098
00:47:06,890 --> 00:47:13,700
find all these anyone heard a showdown

1099
00:47:09,790 --> 00:47:19,520
right<font color="#E5E5E5"> okay showdown server colon perf</font>

1100
00:47:13,700 --> 00:47:21,710
tech because they set their own they set

1101
00:47:19,520 --> 00:47:23,180
their own string in<font color="#CCCCCC"> the web in the web</font>

1102
00:47:21,710 --> 00:47:26,990
server so<font color="#CCCCCC"> you can search for it pretty</font>

1103
00:47:23,180 --> 00:47:29,330
easily they are in North America they

1104
00:47:26,990 --> 00:47:32,509
are in Europe they are<font color="#E5E5E5"> in Asia so</font>

1105
00:47:29,330 --> 00:47:34,850
<font color="#E5E5E5">they're there around the world and you</font>

1106
00:47:32,510 --> 00:47:37,760
know they tend to be inside isp networks

1107
00:47:34,850 --> 00:47:40,520
and just for the the sake of being fair

1108
00:47:37,760 --> 00:47:41,990
I'm talking about Rogers I found<font color="#CCCCCC"> them</font><font color="#E5E5E5"> on</font>

1109
00:47:40,520 --> 00:47:46,370
bail<font color="#CCCCCC"> on shore networks looking at this</font>

1110
00:47:41,990 --> 00:47:48,500
way too so there<font color="#E5E5E5"> you go that's why I was</font>

1111
00:47:46,370 --> 00:47:51,230
<font color="#E5E5E5">just saying we've got the showdown query</font>

1112
00:47:48,500 --> 00:47:55,880
know exactly complex<font color="#CCCCCC"> no</font><font color="#E5E5E5"> teach you've got</font>

1113
00:47:51,230 --> 00:47:59,530
200 200 HTTP<font color="#E5E5E5"> oks and some</font><font color="#CCCCCC"> 40 for 40 40</font>

1114
00:47:55,880 --> 00:48:02,420
<font color="#E5E5E5">injectors the one with the not exactly</font>

1115
00:47:59,530 --> 00:48:05,780
hiding it title of<font color="#E5E5E5"> bullet in the system</font>

1116
00:48:02,420 --> 00:48:07,130
console are the management consoles it's

1117
00:48:05,780 --> 00:48:09,119
pretty easy for<font color="#E5E5E5"> anyone to go and</font>

1118
00:48:07,130 --> 00:48:13,119
enumerate those and start look

1119
00:48:09,119 --> 00:48:17,890
so having done this what did<font color="#E5E5E5"> I learn</font>

1120
00:48:13,119 --> 00:48:19,869
well I<font color="#CCCCCC"> learnt stuff I learned that I</font>

1121
00:48:17,890 --> 00:48:23,589
make a bunch<font color="#E5E5E5"> of mistakes but</font><font color="#CCCCCC"> mistakes</font>

1122
00:48:19,869 --> 00:48:26,859
how we learn and so so here<font color="#E5E5E5"> are some</font>

1123
00:48:23,589 --> 00:48:29,859
things<font color="#E5E5E5"> i learned i learn the contrary to</font>

1124
00:48:26,859 --> 00:48:31,558
my previous misconceptions the united

1125
00:48:29,859 --> 00:48:36,670
states patent and trademark office is

1126
00:48:31,559 --> 00:48:38,319
awesome it is<font color="#E5E5E5"> awesome because companies</font>

1127
00:48:36,670 --> 00:48:41,050
like to see<font color="#CCCCCC"> each other over intellectual</font>

1128
00:48:38,319 --> 00:48:42,369
property rights because they like to see

1129
00:48:41,050 --> 00:48:44,710
<font color="#E5E5E5">each other over intellectual property</font>

1130
00:48:42,369 --> 00:48:48,309
rights they like to<font color="#E5E5E5"> patent everything</font>

1131
00:48:44,710 --> 00:48:53,079
and who are flex patents google patent

1132
00:48:48,309 --> 00:48:54,400
search like spans so let's go<font color="#CCCCCC"> back and</font>

1133
00:48:53,079 --> 00:48:57,579
see if we can<font color="#E5E5E5"> work out all the devices</font>

1134
00:48:54,400 --> 00:49:00,609
without poking anything okay oh good

1135
00:48:57,579 --> 00:49:02,680
there's a hint on the website that could

1136
00:49:00,609 --> 00:49:04,839
<font color="#CCCCCC">be useful so you can go into</font><font color="#E5E5E5"> a search</font>

1137
00:49:02,680 --> 00:49:06,430
and Google patent search is fantastic it

1138
00:49:04,839 --> 00:49:09,460
would have saved<font color="#E5E5E5"> me days of packet</font>

1139
00:49:06,430 --> 00:49:11,020
dumping my internet legs here's

1140
00:49:09,460 --> 00:49:16,680
something that describes intercepting

1141
00:49:11,020 --> 00:49:18,670
HTTP on the wire within a nice big um

1142
00:49:16,680 --> 00:49:22,149
but<font color="#CCCCCC"> I don't think</font><font color="#E5E5E5"> they're write-ups as</font>

1143
00:49:18,670 --> 00:49:26,020
good as<font color="#CCCCCC"> mine</font><font color="#E5E5E5"> but hey it would have saved</font>

1144
00:49:22,150 --> 00:49:29,920
me<font color="#E5E5E5"> a lot of time the other thing is an</font>

1145
00:49:26,020 --> 00:49:32,170
<font color="#CCCCCC">internet advertising</font><font color="#E5E5E5"> system and the bit</font>

1146
00:49:29,920 --> 00:49:35,650
<font color="#E5E5E5">I find interesting is this advertising</font>

1147
00:49:32,170 --> 00:49:37,270
content exists yes edit the<font color="#E5E5E5"> web page so</font>

1148
00:49:35,650 --> 00:49:42,190
that's not add injection that's kind of

1149
00:49:37,270 --> 00:49:45,160
AB stealing and replacing but most of

1150
00:49:42,190 --> 00:49:48,579
all I<font color="#CCCCCC"> learned</font><font color="#E5E5E5"> something about business</font>

1151
00:49:45,160 --> 00:49:53,649
motivations and I got my own razor that

1152
00:49:48,579 --> 00:49:56,410
<font color="#CCCCCC">I stole from</font><font color="#E5E5E5"> Hamlin because i thought i</font>

1153
00:49:53,650 --> 00:49:58,540
was going down the big trap of some

1154
00:49:56,410 --> 00:49:59,950
hardcore elite hacker man in the

1155
00:49:58,540 --> 00:50:03,369
middling me when there was actually a

1156
00:49:59,950 --> 00:50:05,290
fairly innocent business reason for

1157
00:50:03,369 --> 00:50:07,180
having it despite the fact that<font color="#E5E5E5"> i don't</font>

1158
00:50:05,290 --> 00:50:10,420
like the retention the meddling the

1159
00:50:07,180 --> 00:50:13,000
profiling and everything else it doesn't

1160
00:50:10,420 --> 00:50:17,230
<font color="#CCCCCC">make</font><font color="#E5E5E5"> it right but it does show that it's</font>

1161
00:50:13,000 --> 00:50:18,770
not originally what I thought so that's

1162
00:50:17,230 --> 00:50:21,890
kind of where I<font color="#CCCCCC"> am</font>

1163
00:50:18,770 --> 00:50:23,690
with what<font color="#E5E5E5"> I had to present but I would</font>

1164
00:50:21,890 --> 00:50:25,279
love<font color="#CCCCCC"> to take some questions</font><font color="#E5E5E5"> or if not</font>

1165
00:50:23,690 --> 00:50:36,680
i'll be at<font color="#CCCCCC"> the reception if anyone wants</font>

1166
00:50:25,280 --> 00:50:40,640
to stop me in chat thank you no

1167
00:50:36,680 --> 00:50:48,109
questions got<font color="#E5E5E5"> away with it oh sorry</font>

1168
00:50:40,640 --> 00:50:50,180
there at high the only thing I<font color="#E5E5E5"> found so</font>

1169
00:50:48,110 --> 00:50:52,570
far<font color="#CCCCCC"> sorry the question</font><font color="#E5E5E5"> was were there</font>

1170
00:50:50,180 --> 00:50:54,830
any countermeasures to protect yourself

1171
00:50:52,570 --> 00:50:56,990
there's two areas of protecting yourself

1172
00:50:54,830 --> 00:50:58,700
there's being a server that's having its

1173
00:50:56,990 --> 00:51:01,580
clients injected and being the client

1174
00:50:58,700 --> 00:51:03,500
the<font color="#CCCCCC"> client that's</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> rule simple as it</font>

1175
00:51:01,580 --> 00:51:05,840
is is the closest thing I've<font color="#CCCCCC"> got the</font>

1176
00:51:03,500 --> 00:51:08,480
problem<font color="#E5E5E5"> is</font><font color="#CCCCCC"> you can't</font><font color="#E5E5E5"> block by IP by TTL</font>

1177
00:51:05,840 --> 00:51:12,230
by ports because you end up blocking

1178
00:51:08,480 --> 00:51:15,470
legitimate traffic or they're too easy

1179
00:51:12,230 --> 00:51:17,810
to evade that was the<font color="#CCCCCC"> best indicator I</font>

1180
00:51:15,470 --> 00:51:20,240
had or like everyone has been saying for

1181
00:51:17,810 --> 00:51:22,700
the past few months crypto crypto crypto

1182
00:51:20,240 --> 00:51:26,350
because if it's encrypted you can't mess

1183
00:51:22,700 --> 00:51:28,490
with it from a server point of view I

1184
00:51:26,350 --> 00:51:30,529
don't<font color="#E5E5E5"> think you can block but you can</font>

1185
00:51:28,490 --> 00:51:32,689
definitely profile it you can look<font color="#CCCCCC"> for</font>

1186
00:51:30,530 --> 00:51:35,480
the resets coming abnormally not many

1187
00:51:32,690 --> 00:51:39,860
<font color="#CCCCCC">people go three-way handshake three-way</font>

1188
00:51:35,480 --> 00:51:42,530
handshake reset with no data so it

1189
00:51:39,860 --> 00:51:44,470
doesn't give<font color="#E5E5E5"> you a definitive but it's</font>

1190
00:51:42,530 --> 00:51:48,760
definitely something you could look for

1191
00:51:44,470 --> 00:51:48,759
that's as good as answers like outside

1192
00:51:48,820 --> 00:51:52,780
anyone else oh yeah

1193
00:51:57,449 --> 00:52:05,229
no I didn't I I specifically<font color="#E5E5E5"> looked for</font>

1194
00:52:00,609 --> 00:52:07,989
that I did see some on the<font color="#E5E5E5"> cell phone</font>

1195
00:52:05,229 --> 00:52:10,209
network which I didn't look<font color="#E5E5E5"> at properly</font>

1196
00:52:07,989 --> 00:52:12,759
though I'm going to caveat this really

1197
00:52:10,209 --> 00:52:15,098
heavily with that was on a blackberry

1198
00:52:12,759 --> 00:52:17,049
and<font color="#CCCCCC"> blackberries connect using the best</font>

1199
00:52:15,099 --> 00:52:18,459
service so it by design has a

1200
00:52:17,049 --> 00:52:19,959
man-in-the-middle connection so<font color="#E5E5E5"> I</font>

1201
00:52:18,459 --> 00:52:28,259
actually think that one was sort of

1202
00:52:19,959 --> 00:52:28,259
innocent yes sir yes

1203
00:52:32,650 --> 00:52:53,440
yeah<font color="#E5E5E5"> yeah sorry what was that bleep Ian</font>

1204
00:52:42,339 --> 00:52:55,839
oh yeah if you use a VPN yeah yeah you

1205
00:52:53,440 --> 00:52:58,359
<font color="#E5E5E5">can use a VPN a VPN would bypass this</font>

1206
00:52:55,839 --> 00:53:00,549
the only thing I would say is that

1207
00:52:58,359 --> 00:53:04,900
you're sort<font color="#E5E5E5"> of moving the problem in a</font>

1208
00:53:00,549 --> 00:53:06,730
way in so far as if you use a VPN then

1209
00:53:04,900 --> 00:53:08,799
there's<font color="#E5E5E5"> nothing to say that your VPN is</font>

1210
00:53:06,730 --> 00:53:10,390
that wherever your VPN is terminated the

1211
00:53:08,799 --> 00:53:13,839
<font color="#CCCCCC">its onward</font><font color="#E5E5E5"> connections are not suffering</font>

1212
00:53:10,390 --> 00:53:15,549
a similar thing this isn't<font color="#E5E5E5"> a conclusive</font>

1213
00:53:13,839 --> 00:53:19,720
the only way to do it this is just an

1214
00:53:15,549 --> 00:53:21,009
example of the one I saw but yeah you

1215
00:53:19,720 --> 00:53:22,868
could do that I would have made this one

1216
00:53:21,010 --> 00:53:24,730
but<font color="#CCCCCC"> it wouldn't guarantee you end-to-end</font>

1217
00:53:22,869 --> 00:53:26,799
connectivity you actually need crypto to

1218
00:53:24,730 --> 00:53:35,619
be able<font color="#E5E5E5"> to go from one end to the other</font>

1219
00:53:26,799 --> 00:53:37,589
completely yeah I did try to contact

1220
00:53:35,619 --> 00:53:40,680
them I haven't heard anything<font color="#E5E5E5"> back here</font>

1221
00:53:37,589 --> 00:53:48,549
sorry the question was did the<font color="#CCCCCC"> CRTC</font><font color="#E5E5E5"> know</font>

1222
00:53:40,680 --> 00:53:54,520
yeah and<font color="#E5E5E5"> I did actually well I</font><font color="#CCCCCC"> saw him</font>

1223
00:53:48,549 --> 00:53:57,279
on Twitter does<font color="#E5E5E5"> that count no I've have</font>

1224
00:53:54,520 --> 00:54:00,849
mentioned it to Michael guys<font color="#E5E5E5"> daya and he</font>

1225
00:53:57,279 --> 00:54:02,529
said he hasn't seen the details but yeah

1226
00:54:00,849 --> 00:54:05,710
he's an example of someone that senior

1227
00:54:02,529 --> 00:54:10,210
and he said he's glad the talk is being

1228
00:54:05,710 --> 00:54:11,829
had but uh you know that's good but I

1229
00:54:10,210 --> 00:54:13,720
don't<font color="#E5E5E5"> think I'm going to necessarily</font>

1230
00:54:11,829 --> 00:54:19,450
have anyone fighting my corner like that

1231
00:54:13,720 --> 00:54:24,419
at any<font color="#E5E5E5"> time soon yeah cool we're done</font>

1232
00:54:19,450 --> 00:54:24,419
<font color="#E5E5E5">then we'll do beer perfect thank you</font>

