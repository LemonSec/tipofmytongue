1
00:00:02,520 --> 00:00:07,259
hello<font color="#E5E5E5"> everyone and thank you for</font>

2
00:00:04,770 --> 00:00:09,000
<font color="#CCCCCC">attending my presentation for the next</font>

3
00:00:07,259 --> 00:00:11,610
hour we're<font color="#CCCCCC"> going to be looking</font><font color="#E5E5E5"> at ways</font>

4
00:00:09,000 --> 00:00:13,709
that we<font color="#E5E5E5"> can achieve</font><font color="#CCCCCC"> scalable threat</font>

5
00:00:11,610 --> 00:00:15,930
detection and response so performing

6
00:00:13,709 --> 00:00:17,580
effective detection and response in

7
00:00:15,930 --> 00:00:19,770
large environments and environments

8
00:00:17,580 --> 00:00:22,139
where sophisticated threat actors are

9
00:00:19,770 --> 00:00:23,759
active we're<font color="#E5E5E5"> going to start by looking</font>

10
00:00:22,140 --> 00:00:26,010
at some of<font color="#CCCCCC"> the ways that traditional</font>

11
00:00:23,760 --> 00:00:27,840
approaches to this fails so these will

12
00:00:26,010 --> 00:00:29,550
probably be similar to what you

13
00:00:27,840 --> 00:00:31,170
currently<font color="#E5E5E5"> do or hopefully what you did</font>

14
00:00:29,550 --> 00:00:32,940
in the past and you're moving<font color="#E5E5E5"> to some</font>

15
00:00:31,170 --> 00:00:34,620
more of these scalable ways but we want

16
00:00:32,940 --> 00:00:36,150
to<font color="#E5E5E5"> see how I are and detection was</font>

17
00:00:34,620 --> 00:00:38,040
traditionally done and then we want<font color="#E5E5E5"> to</font>

18
00:00:36,150 --> 00:00:40,230
<font color="#CCCCCC">be able to see how can we change that to</font>

19
00:00:38,040 --> 00:00:42,600
meet the<font color="#CCCCCC"> needs of modern networks and</font>

20
00:00:40,230 --> 00:00:44,099
investigations will then look at some<font color="#CCCCCC"> of</font>

21
00:00:42,600 --> 00:00:46,350
the questions that are needed for

22
00:00:44,100 --> 00:00:48,809
effective detection and response so if

23
00:00:46,350 --> 00:00:51,149
you're on an incident handling team or

24
00:00:48,809 --> 00:00:52,949
if you're bringing<font color="#E5E5E5"> in a team like a</font>

25
00:00:51,149 --> 00:00:55,200
third party to do I are for you these

26
00:00:52,950 --> 00:00:56,880
<font color="#CCCCCC">are questions they need answered so if</font>

27
00:00:55,200 --> 00:00:58,770
you can't answer those currently if you

28
00:00:56,880 --> 00:01:01,440
can't answer them fully then don't

29
00:00:58,770 --> 00:01:03,180
expect to receive effective response and

30
00:01:01,440 --> 00:01:05,280
so we're going to want<font color="#CCCCCC"> to change our</font>

31
00:01:03,180 --> 00:01:07,439
networks and argument them to be able<font color="#E5E5E5"> to</font>

32
00:01:05,280 --> 00:01:09,299
actually answer those questions and get

33
00:01:07,439 --> 00:01:10,439
the data and<font color="#E5E5E5"> then we'll obviously spend</font>

34
00:01:09,299 --> 00:01:11,819
a lot of time talking about<font color="#CCCCCC"> how do we</font>

35
00:01:10,439 --> 00:01:15,240
actually implement that and what does<font color="#CCCCCC"> it</font>

36
00:01:11,819 --> 00:01:17,490
look like for those<font color="#CCCCCC"> that haven't met</font>

37
00:01:15,240 --> 00:01:19,740
before my name is<font color="#CCCCCC"> Andrew case so I spent</font>

38
00:01:17,490 --> 00:01:21,929
a good bit of<font color="#CCCCCC"> time on open source tool</font>

39
00:01:19,740 --> 00:01:24,149
development on volatility and registry

40
00:01:21,929 --> 00:01:26,729
decoder one of the co-authors of<font color="#CCCCCC"> the art</font>

41
00:01:24,149 --> 00:01:28,499
of memory forensics in the past I<font color="#CCCCCC"> don't</font>

42
00:01:26,729 --> 00:01:30,630
do them as<font color="#E5E5E5"> much anymore but for several</font>

43
00:01:28,499 --> 00:01:32,848
years I worked on insider threat

44
00:01:30,630 --> 00:01:34,649
investigations so dealing<font color="#E5E5E5"> with companies</font>

45
00:01:32,849 --> 00:01:36,420
<font color="#CCCCCC">that were being ripped off by an</font>

46
00:01:34,649 --> 00:01:38,189
employee or<font color="#E5E5E5"> contractor or something</font>

47
00:01:36,420 --> 00:01:39,810
along those lines we had to figure<font color="#CCCCCC"> out</font>

48
00:01:38,189 --> 00:01:41,818
what did they actually<font color="#E5E5E5"> do what did they</font>

49
00:01:39,810 --> 00:01:44,310
what did they take how did they do it

50
00:01:41,819 --> 00:01:46,619
those investigations really didn't have

51
00:01:44,310 --> 00:01:49,109
to scale one<font color="#CCCCCC"> or two people stealing some</font>

52
00:01:46,619 --> 00:01:51,569
data isn't going to require analysis of

53
00:01:49,109 --> 00:01:53,130
hundreds of machines but then if with

54
00:01:51,569 --> 00:01:56,279
what I do now when we're doing<font color="#E5E5E5"> I are</font>

55
00:01:53,130 --> 00:01:58,169
these are require lots of scale<font color="#CCCCCC"> and lots</font>

56
00:01:56,279 --> 00:01:59,700
of analysis and so what we want to<font color="#E5E5E5"> do is</font>

57
00:01:58,169 --> 00:02:01,649
figure out when we're on large networks

58
00:01:59,700 --> 00:02:03,869
we have hundreds of machines thousands

59
00:02:01,649 --> 00:02:05,099
<font color="#E5E5E5">of machines how can we effectively deal</font>

60
00:02:03,869 --> 00:02:07,499
with that many machines how do we scale

61
00:02:05,099 --> 00:02:08,819
our operations and then we'll also see

62
00:02:07,499 --> 00:02:10,619
it gets very challenging when<font color="#CCCCCC"> you're</font>

63
00:02:08,818 --> 00:02:12,359
dealing with what i would call skilled

64
00:02:10,619 --> 00:02:13,980
attackers because they don't want you to

65
00:02:12,360 --> 00:02:14,960
find them they're going<font color="#E5E5E5"> to work in ways</font>

66
00:02:13,980 --> 00:02:16,579
that trigger

67
00:02:14,960 --> 00:02:18,050
tional forensic simply won't find them

68
00:02:16,580 --> 00:02:21,590
so you have to innovate what you're

69
00:02:18,050 --> 00:02:24,170
doing and if we look at these ways of

70
00:02:21,590 --> 00:02:25,820
traditional detection<font color="#CCCCCC"> and response they</font>

71
00:02:24,170 --> 00:02:28,220
really<font color="#E5E5E5"> don't work and they fall flat on</font>

72
00:02:25,820 --> 00:02:30,320
several fronts the first one is that<font color="#CCCCCC"> if</font>

73
00:02:28,220 --> 00:02:32,390
you<font color="#E5E5E5"> look at I are from from several</font>

74
00:02:30,320 --> 00:02:34,519
<font color="#CCCCCC">years</font><font color="#E5E5E5"> ago you're only looking at a</font>

75
00:02:32,390 --> 00:02:36,230
handful of systems the attackers got on

76
00:02:34,520 --> 00:02:38,060
one system they then pivoted to the

77
00:02:36,230 --> 00:02:40,040
<font color="#E5E5E5">system with that had all the critical</font>

78
00:02:38,060 --> 00:02:41,360
data on it and then they took it<font color="#E5E5E5"> and so</font>

79
00:02:40,040 --> 00:02:42,950
when you were doing your incident

80
00:02:41,360 --> 00:02:44,390
response and when you were trying<font color="#E5E5E5"> to</font>

81
00:02:42,950 --> 00:02:46,579
figure<font color="#CCCCCC"> out</font><font color="#E5E5E5"> where should I focus my</font>

82
00:02:44,390 --> 00:02:48,519
detection<font color="#E5E5E5"> for where the attackers will</font>

83
00:02:46,580 --> 00:02:50,660
most likely go it wasn't that<font color="#E5E5E5"> difficult</font>

84
00:02:48,520 --> 00:02:52,730
versus with modern networks it's

85
00:02:50,660 --> 00:02:54,410
obviously much different the other thing

86
00:02:52,730 --> 00:02:57,079
<font color="#E5E5E5">and we'll see quite a few</font><font color="#CCCCCC"> examples of</font>

87
00:02:54,410 --> 00:02:58,250
this is the way in the past attackers

88
00:02:57,080 --> 00:03:00,410
really didn't do a whole lot of anti

89
00:02:58,250 --> 00:03:02,540
forensics or if they did it was kind of

90
00:03:00,410 --> 00:03:03,950
a red flag that<font color="#E5E5E5"> hey an attacker was here</font>

91
00:03:02,540 --> 00:03:05,630
so you could<font color="#E5E5E5"> figure out not only did</font>

92
00:03:03,950 --> 00:03:07,130
they do anti forensics you could go back

93
00:03:05,630 --> 00:03:09,769
<font color="#CCCCCC">and find what they were trying</font><font color="#E5E5E5"> to hide</font>

94
00:03:07,130 --> 00:03:11,780
so it was not not particularly<font color="#E5E5E5"> effective</font>

95
00:03:09,770 --> 00:03:14,810
and so doing traditional response and

96
00:03:11,780 --> 00:03:16,790
working on traditional detection was

97
00:03:14,810 --> 00:03:19,580
fairly straightforward I really wasn't

98
00:03:16,790 --> 00:03:22,010
that difficult but if<font color="#E5E5E5"> we look at the</font>

99
00:03:19,580 --> 00:03:24,110
cases<font color="#CCCCCC"> that many of us work one now you</font>

100
00:03:22,010 --> 00:03:26,000
have the the possibility when you walk

101
00:03:24,110 --> 00:03:27,950
into an environment<font color="#CCCCCC"> and look at what</font><font color="#E5E5E5"> the</font>

102
00:03:26,000 --> 00:03:29,750
attackers were doing there's tens of

103
00:03:27,950 --> 00:03:31,850
systems hundreds of system thousands of

104
00:03:29,750 --> 00:03:33,680
systems that might be in scope these

105
00:03:31,850 --> 00:03:34,910
<font color="#E5E5E5">systems are not all in one</font><font color="#CCCCCC"> place they're</font>

106
00:03:33,680 --> 00:03:36,830
going<font color="#E5E5E5"> to be spread across networks</font>

107
00:03:34,910 --> 00:03:38,420
spread across the<font color="#E5E5E5"> world and we're not</font>

108
00:03:36,830 --> 00:03:40,820
<font color="#E5E5E5">just</font><font color="#CCCCCC"> dealing</font><font color="#E5E5E5"> with one type of device</font>

109
00:03:38,420 --> 00:03:43,070
anymore it's not<font color="#E5E5E5"> a Windows desktop</font>

110
00:03:40,820 --> 00:03:45,230
somewhere with a linux<font color="#CCCCCC"> server we see all</font>

111
00:03:43,070 --> 00:03:46,820
the operating<font color="#E5E5E5"> systems spread out and we</font>

112
00:03:45,230 --> 00:03:48,980
see them all across different types of

113
00:03:46,820 --> 00:03:51,620
hardware devices as well and so we'll

114
00:03:48,980 --> 00:03:53,780
we'll talk a lot<font color="#CCCCCC"> about how can we narrow</font>

115
00:03:51,620 --> 00:03:56,060
down what our scope is how can<font color="#CCCCCC"> we narrow</font>

116
00:03:53,780 --> 00:03:58,130
down what to focus on but to do that we

117
00:03:56,060 --> 00:04:00,200
need a lot put in place before<font color="#E5E5E5"> the</font>

118
00:03:58,130 --> 00:04:02,990
actual incident happens and before we

119
00:04:00,200 --> 00:04:04,369
<font color="#E5E5E5">really want to start good detection and</font>

120
00:04:02,990 --> 00:04:06,590
then the<font color="#E5E5E5"> other thing as I mentioned</font><font color="#CCCCCC"> is a</font>

121
00:04:04,370 --> 00:04:08,300
big pain<font color="#E5E5E5"> point is the way modern</font>

122
00:04:06,590 --> 00:04:09,950
attackers work they're not just looking

123
00:04:08,300 --> 00:04:11,930
<font color="#E5E5E5">for</font><font color="#CCCCCC"> one system if you look at the tool</font>

124
00:04:09,950 --> 00:04:13,489
sets they use they have scale as a

125
00:04:11,930 --> 00:04:15,470
feature so if they<font color="#CCCCCC"> want to rapidly</font>

126
00:04:13,490 --> 00:04:17,390
compromised hundreds or thousands<font color="#E5E5E5"> of</font>

127
00:04:15,470 --> 00:04:19,250
systems d.school the tools have the

128
00:04:17,390 --> 00:04:21,529
ability<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that and then the tools</font>

129
00:04:19,250 --> 00:04:23,810
are very anti forensics minded as well

130
00:04:21,529 --> 00:04:27,500
so if you perform traditional forensics

131
00:04:23,810 --> 00:04:28,610
you're not going to find them<font color="#E5E5E5"> and if we</font>

132
00:04:27,500 --> 00:04:29,770
<font color="#CCCCCC">look</font><font color="#E5E5E5"> at this anti</font>

133
00:04:28,610 --> 00:04:32,330
friends extent a little bit of<font color="#E5E5E5"> death</font>

134
00:04:29,770 --> 00:04:33,740
what you'll see is that the attackers

135
00:04:32,330 --> 00:04:35,780
are the first thing they're doing<font color="#E5E5E5"> is</font>

136
00:04:33,740 --> 00:04:38,150
operating in memory if you look at how

137
00:04:35,780 --> 00:04:40,039
antivirus and your security endpoint

138
00:04:38,150 --> 00:04:41,900
agents work they're looking<font color="#CCCCCC"> essentially</font>

139
00:04:40,039 --> 00:04:43,669
for activity on disk they're going<font color="#E5E5E5"> to</font>

140
00:04:41,900 --> 00:04:45,888
<font color="#E5E5E5">look for files on disk and the AV will</font>

141
00:04:43,669 --> 00:04:47,840
scan them they'll look a file will get

142
00:04:45,889 --> 00:04:50,060
downloaded and before the AV lets you

143
00:04:47,840 --> 00:04:51,560
use it it will scan<font color="#CCCCCC"> it same thing</font>

144
00:04:50,060 --> 00:04:53,389
security agents work very similarly

145
00:04:51,560 --> 00:04:55,909
they're looking<font color="#CCCCCC"> for malware</font><font color="#E5E5E5"> on disk they</font>

146
00:04:53,389 --> 00:04:57,319
want to perform their analysis on it

147
00:04:55,909 --> 00:04:58,969
they<font color="#E5E5E5"> are going to monitor some of the</font>

148
00:04:57,319 --> 00:05:01,250
api's they'll go a little bit beyond

149
00:04:58,969 --> 00:05:02,750
what<font color="#E5E5E5"> AV does but when malware's</font><font color="#CCCCCC"> in</font>

150
00:05:01,250 --> 00:05:05,330
memory all of that still gets bypassed

151
00:05:02,750 --> 00:05:06,979
and so when you have attackers working

152
00:05:05,330 --> 00:05:09,109
in memory you don't have anything on

153
00:05:06,979 --> 00:05:10,849
disk I'm<font color="#E5E5E5"> not talking about file list</font>

154
00:05:09,110 --> 00:05:12,590
malware where the malware rights to say

155
00:05:10,849 --> 00:05:15,050
the registry or some other file and then

156
00:05:12,590 --> 00:05:17,119
loads at a tricky way this is now where

157
00:05:15,050 --> 00:05:18,710
that literally never touches<font color="#CCCCCC"> the disk if</font>

158
00:05:17,120 --> 00:05:20,389
you reboot the machine that's infected

159
00:05:18,710 --> 00:05:22,758
the malware goes away and<font color="#E5E5E5"> doesn't come</font>

160
00:05:20,389 --> 00:05:24,740
<font color="#CCCCCC">back did anyone read the capper ski</font>

161
00:05:22,759 --> 00:05:27,409
report from last year when their network

162
00:05:24,740 --> 00:05:28,729
got completely compromised so I would

163
00:05:27,409 --> 00:05:29,870
recommend<font color="#CCCCCC"> reading that if you're at this</font>

164
00:05:28,729 --> 00:05:32,508
conference you would definitely<font color="#CCCCCC"> enjoy</font>

165
00:05:29,870 --> 00:05:34,339
that report her<font color="#E5E5E5"> persky's network full</font>

166
00:05:32,509 --> 00:05:35,810
network was compromised the attackers

167
00:05:34,339 --> 00:05:38,599
took everything kaprisky cared about

168
00:05:35,810 --> 00:05:41,270
source code signatures all the<font color="#E5E5E5"> above and</font>

169
00:05:38,599 --> 00:05:43,159
if you read the attack report is very

170
00:05:41,270 --> 00:05:44,628
<font color="#CCCCCC">detailed and it says the</font><font color="#E5E5E5"> reason the</font>

171
00:05:43,159 --> 00:05:46,819
attackers were here the reason we didn't

172
00:05:44,629 --> 00:05:48,349
detect him is because the malware that

173
00:05:46,819 --> 00:05:50,300
loaded on our critical servers was

174
00:05:48,349 --> 00:05:51,860
memory only so there was a system

175
00:05:50,300 --> 00:05:54,949
somewhere that no one cared about that

176
00:05:51,860 --> 00:05:57,050
<font color="#E5E5E5">system had</font><font color="#CCCCCC"> a registry persistence on it</font>

177
00:05:54,949 --> 00:05:58,849
so that system wrote had Mauer on<font color="#E5E5E5"> the</font>

178
00:05:57,050 --> 00:06:00,259
disk but then that<font color="#E5E5E5"> system would attack</font>

179
00:05:58,849 --> 00:06:02,180
all the other machines across the

180
00:06:00,259 --> 00:06:04,159
network and so I guarantee<font color="#E5E5E5"> every Network</font>

181
00:06:02,180 --> 00:06:06,169
has at least one machine everyone<font color="#E5E5E5"> that</font>

182
00:06:04,159 --> 00:06:07,339
has been forgotten about but your

183
00:06:06,169 --> 00:06:08,719
critical systems that you're actually

184
00:06:07,339 --> 00:06:10,939
going to<font color="#E5E5E5"> look at and you're going to</font>

185
00:06:08,719 --> 00:06:13,039
<font color="#E5E5E5">investigate there was nothing</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> disk</font>

186
00:06:10,939 --> 00:06:14,449
that malware would attack them over the

187
00:06:13,039 --> 00:06:16,490
network it would use stolen credentials

188
00:06:14,449 --> 00:06:18,349
it would load the malware directly into

189
00:06:16,490 --> 00:06:20,779
memory and so that was Cooper skis

190
00:06:18,349 --> 00:06:23,029
excuse or reason why the attackers were

191
00:06:20,779 --> 00:06:24,409
so successful against them versus if any

192
00:06:23,029 --> 00:06:25,669
type of memory forensics would have been

193
00:06:24,409 --> 00:06:27,949
done on those systems they would have

194
00:06:25,669 --> 00:06:29,900
<font color="#CCCCCC">found it right away and in</font><font color="#E5E5E5"> almost every</font>

195
00:06:27,949 --> 00:06:31,819
investigation that we do now the

196
00:06:29,900 --> 00:06:34,400
attackers are only in memory there's

197
00:06:31,819 --> 00:06:36,589
very little if anything left on disk and

198
00:06:34,400 --> 00:06:39,049
then if you do have malware that writes

199
00:06:36,589 --> 00:06:40,669
to disk or that<font color="#E5E5E5"> D your traditional live</font>

200
00:06:39,050 --> 00:06:42,169
I our tools will look for so you're

201
00:06:40,669 --> 00:06:44,389
going to<font color="#E5E5E5"> run a live I our tool</font>

202
00:06:42,169 --> 00:06:46,248
for processes and network connections

203
00:06:44,389 --> 00:06:48,469
and get a file listing and look for

204
00:06:46,249 --> 00:06:50,960
logged in users the way those tools work

205
00:06:48,469 --> 00:06:52,939
are<font color="#CCCCCC"> they're dependent on the system ap</font>

206
00:06:50,960 --> 00:06:54,799
<font color="#CCCCCC">is so I'm</font><font color="#E5E5E5"> not going to name tools and</font>

207
00:06:52,939 --> 00:06:56,509
shame them but this<font color="#E5E5E5"> is true of any live</font>

208
00:06:54,800 --> 00:06:57,860
<font color="#E5E5E5">I our tool that's out there whether you</font>

209
00:06:56,509 --> 00:06:59,900
download it<font color="#E5E5E5"> from the internet whether</font>

210
00:06:57,860 --> 00:07:01,639
you write it yourself whether it runs in

211
00:06:59,900 --> 00:07:03,948
user land whether it runs in the<font color="#E5E5E5"> colonel</font>

212
00:07:01,639 --> 00:07:06,139
all of those are relying on<font color="#CCCCCC"> AP is</font><font color="#E5E5E5"> that</font>

213
00:07:03,949 --> 00:07:07,490
the operating system provides and the

214
00:07:06,139 --> 00:07:09,949
first thing<font color="#CCCCCC"> that malware does when it</font>

215
00:07:07,490 --> 00:07:11,810
loads is hooks those AP<font color="#E5E5E5"> is so you asked</font>

216
00:07:09,949 --> 00:07:13,490
for the list of processes and you see

217
00:07:11,810 --> 00:07:15,620
all the processes<font color="#CCCCCC"> that are running</font>

218
00:07:13,490 --> 00:07:17,060
except<font color="#E5E5E5"> for the malware you asked for the</font>

219
00:07:15,620 --> 00:07:18,680
list of network connections and you see

220
00:07:17,060 --> 00:07:20,659
all the network connections that are

221
00:07:18,680 --> 00:07:21,949
active<font color="#E5E5E5"> except for the malware and then I</font>

222
00:07:20,659 --> 00:07:23,990
can name the 30 other things that

223
00:07:21,949 --> 00:07:25,219
malware is going to hook as well and so

224
00:07:23,990 --> 00:07:26,960
when you read these reports where

225
00:07:25,219 --> 00:07:28,939
companies are compromised<font color="#E5E5E5"> for years</font>

226
00:07:26,960 --> 00:07:30,020
before detection and the malware is

227
00:07:28,939 --> 00:07:31,939
there and they say well<font color="#E5E5E5"> why couldn't you</font>

228
00:07:30,020 --> 00:07:33,529
see the malware it's because it's

229
00:07:31,939 --> 00:07:35,419
literally impossible to see it on<font color="#E5E5E5"> the</font>

230
00:07:33,529 --> 00:07:37,159
live system really the<font color="#E5E5E5"> only thing you</font>

231
00:07:35,419 --> 00:07:39,438
can do at that point is memory forensics

232
00:07:37,159 --> 00:07:40,998
and if you ask industry-wide how many

233
00:07:39,439 --> 00:07:43,580
people go around<font color="#E5E5E5"> doing memory forensics</font>

234
00:07:40,999 --> 00:07:44,990
on machines some people do it some

235
00:07:43,580 --> 00:07:47,120
people have teams<font color="#E5E5E5"> that do it some people</font>

236
00:07:44,990 --> 00:07:49,639
bring in third parties to do it but it's

237
00:07:47,120 --> 00:07:51,460
not a commonly thing done thing everyone

238
00:07:49,639 --> 00:07:54,139
gets<font color="#E5E5E5"> pentest not everyone's going to</font>

239
00:07:51,460 --> 00:07:57,589
proactively do memory analysis on their

240
00:07:54,139 --> 00:07:59,719
critical systems and then the other

241
00:07:57,589 --> 00:08:01,759
issue here when we try to apply that

242
00:07:59,719 --> 00:08:04,550
traditional forensics is the notion<font color="#CCCCCC"> of</font>

243
00:08:01,759 --> 00:08:06,560
scale defenders tools do not scale very

244
00:08:04,550 --> 00:08:09,560
well there's not<font color="#E5E5E5"> a lot of tools to</font>

245
00:08:06,560 --> 00:08:11,839
really deep dive<font color="#E5E5E5"> assist a large number</font>

246
00:08:09,560 --> 00:08:14,539
of systems to a great degree but the

247
00:08:11,839 --> 00:08:15,979
attackers do have this ability I have<font color="#CCCCCC"> a</font>

248
00:08:14,539 --> 00:08:18,050
short list here I could have filled many

249
00:08:15,979 --> 00:08:20,419
slides with it if you look at<font color="#CCCCCC"> PowerShell</font>

250
00:08:18,050 --> 00:08:22,370
if you look at the ability to remotely

251
00:08:20,419 --> 00:08:24,469
push out group policy remotely scheduled

252
00:08:22,370 --> 00:08:26,360
tasks on<font color="#CCCCCC"> Windows the attacker tool sets</font>

253
00:08:24,469 --> 00:08:28,399
take advantage of all<font color="#E5E5E5"> of this they have</font>

254
00:08:26,360 --> 00:08:30,020
compromised domain admin credentials at

255
00:08:28,399 --> 00:08:32,529
that<font color="#E5E5E5"> point they can run powershell</font>

256
00:08:30,020 --> 00:08:34,399
scripts on every resource on<font color="#CCCCCC"> the network</font>

257
00:08:32,529 --> 00:08:37,578
<font color="#CCCCCC">Mannion had an interesting report</font>

258
00:08:34,399 --> 00:08:39,229
recently where a threat group was they

259
00:08:37,578 --> 00:08:40,848
compromised<font color="#E5E5E5"> the domain controller and</font>

260
00:08:39,229 --> 00:08:42,560
then they were pushing our group policy

261
00:08:40,849 --> 00:08:44,060
that installed ransomware so literally

262
00:08:42,559 --> 00:08:46,369
every machine and the network will be

263
00:08:44,059 --> 00:08:48,859
infected overnight with ransomware once

264
00:08:46,370 --> 00:08:51,019
that happens that's attackers being able

265
00:08:48,860 --> 00:08:52,790
to compromise<font color="#CCCCCC"> your entire network in</font>

266
00:08:51,019 --> 00:08:54,140
minutes there's no equivalent of<font color="#E5E5E5"> that on</font>

267
00:08:52,790 --> 00:08:54,680
the defender side there's<font color="#E5E5E5"> nothing</font>

268
00:08:54,140 --> 00:08:56,569
commercial

269
00:08:54,680 --> 00:08:58,790
<font color="#E5E5E5">open source anything that you can run</font>

270
00:08:56,570 --> 00:09:00,890
that says these<font color="#CCCCCC"> 10,000 machines that I</font>

271
00:08:58,790 --> 00:09:02,569
can contact are completely secure and

272
00:09:00,890 --> 00:09:04,399
there's no malware on them so we're

273
00:09:02,570 --> 00:09:08,270
definitely at a disadvantage when we're

274
00:09:04,399 --> 00:09:10,810
<font color="#E5E5E5">working with this how many people</font><font color="#CCCCCC"> are</font>

275
00:09:08,270 --> 00:09:13,610
have heard of our<font color="#CCCCCC"> seen</font><font color="#E5E5E5"> powershell</font><font color="#CCCCCC"> empire</font>

276
00:09:10,810 --> 00:09:15,079
only a handful of people so this<font color="#CCCCCC"> is one</font>

277
00:09:13,610 --> 00:09:17,060
of<font color="#E5E5E5"> the tools that should scare you this</font>

278
00:09:15,080 --> 00:09:20,120
is probably<font color="#E5E5E5"> the best open source free</font>

279
00:09:17,060 --> 00:09:22,069
tool that exemplifies a lot of this so

280
00:09:20,120 --> 00:09:24,080
as I said PowerShell is open source you

281
00:09:22,070 --> 00:09:25,220
<font color="#E5E5E5">can go download it from github on the</font>

282
00:09:24,080 --> 00:09:27,470
website there<font color="#E5E5E5"> is a number of</font>

283
00:09:25,220 --> 00:09:29,810
presentations from the author but if you

284
00:09:27,470 --> 00:09:31,459
read some of this it should<font color="#E5E5E5"> not make you</font>

285
00:09:29,810 --> 00:09:34,459
feel good from a defender standpoint

286
00:09:31,459 --> 00:09:36,349
this slide jumped everything<font color="#CCCCCC"> that</font>

287
00:09:34,459 --> 00:09:39,079
PowerShell Empire is going to do on the

288
00:09:36,350 --> 00:09:40,610
network is encrypted it works as all

289
00:09:39,080 --> 00:09:43,399
<font color="#CCCCCC">PowerShell agents but</font><font color="#E5E5E5"> it doesn't</font>

290
00:09:40,610 --> 00:09:45,080
<font color="#E5E5E5">actually run powershell exe it's</font>

291
00:09:43,399 --> 00:09:46,370
reimplemented a lot of what we see in

292
00:09:45,080 --> 00:09:47,930
malware so it has key logging

293
00:09:46,370 --> 00:09:50,240
capabilities it has screenshot

294
00:09:47,930 --> 00:09:52,279
capabilities it also<font color="#E5E5E5"> has a port of</font><font color="#CCCCCC"> Mimi</font>

295
00:09:50,240 --> 00:09:55,070
cats if you're not<font color="#E5E5E5"> familiar with Mimi</font>

296
00:09:52,279 --> 00:09:56,660
cats it allows for extraction of all of

297
00:09:55,070 --> 00:09:59,000
the clear text passwords as well as

298
00:09:56,660 --> 00:10:01,130
hashed passwords on your machine we had

299
00:09:59,000 --> 00:10:02,779
a client recently where Mimi cats was

300
00:10:01,130 --> 00:10:04,100
run on the domain controller so at that

301
00:10:02,779 --> 00:10:05,959
point you might as well<font color="#E5E5E5"> just rebuild the</font>

302
00:10:04,100 --> 00:10:08,660
network because the attackers have

303
00:10:05,959 --> 00:10:09,949
everything and so PowerShell Empire is a

304
00:10:08,660 --> 00:10:11,930
really good example of this<font color="#E5E5E5"> and so if</font>

305
00:10:09,950 --> 00:10:13,310
you<font color="#CCCCCC"> think your endpoints are secure now</font>

306
00:10:11,930 --> 00:10:16,160
or if you want<font color="#E5E5E5"> to see how would my</font>

307
00:10:13,310 --> 00:10:17,689
endpoint stand up to a real attack

308
00:10:16,160 --> 00:10:19,430
that's only going to be operated through

309
00:10:17,690 --> 00:10:21,950
memory this is a great<font color="#E5E5E5"> way to do it it's</font>

310
00:10:19,430 --> 00:10:23,300
an open source tool get a test system

311
00:10:21,950 --> 00:10:25,310
that matches what's in your environment

312
00:10:23,300 --> 00:10:26,930
and see if your endpoint<font color="#CCCCCC"> agent see if</font>

313
00:10:25,310 --> 00:10:29,150
you're a VC if your network censors

314
00:10:26,930 --> 00:10:30,349
actually pick up on any<font color="#E5E5E5"> of this because</font>

315
00:10:29,150 --> 00:10:32,360
<font color="#E5E5E5">this is what attackers you're using</font>

316
00:10:30,350 --> 00:10:34,520
they're not obviously using PowerShell

317
00:10:32,360 --> 00:10:36,260
Empire directly but they reimplemented

318
00:10:34,520 --> 00:10:39,079
the same things in<font color="#E5E5E5"> their own tool sets</font>

319
00:10:36,260 --> 00:10:41,329
and this is not something completely new

320
00:10:39,079 --> 00:10:43,670
mature / inside and<font color="#CCCCCC"> Metis Wade has had</font>

321
00:10:41,329 --> 00:10:47,270
this since around two thousand six maybe

322
00:10:43,670 --> 00:10:49,760
2007 being able to perform a tax only in

323
00:10:47,270 --> 00:10:51,800
memory with meterpreter it will read

324
00:10:49,760 --> 00:10:53,480
<font color="#CCCCCC">dll's and code that is going to use over</font>

325
00:10:51,800 --> 00:10:55,069
the network<font color="#E5E5E5"> that will be loaded directly</font>

326
00:10:53,480 --> 00:10:56,870
into memory and so<font color="#E5E5E5"> that's another</font>

327
00:10:55,070 --> 00:10:59,180
situation where if you walk up to the

328
00:10:56,870 --> 00:11:00,529
machine<font color="#E5E5E5"> and you pull the plug you turn</font>

329
00:10:59,180 --> 00:11:02,479
that machine off and you don't<font color="#CCCCCC"> have the</font>

330
00:11:00,529 --> 00:11:06,260
memory simple then all that evidence

331
00:11:02,480 --> 00:11:07,910
went away and we see a lot of issues on

332
00:11:06,260 --> 00:11:09,860
the network as well

333
00:11:07,910 --> 00:11:11,540
one thing we see a lot is the<font color="#E5E5E5"> network</font>

334
00:11:09,860 --> 00:11:13,130
censors that people have installed

335
00:11:11,540 --> 00:11:15,439
they're<font color="#E5E5E5"> really just looking for known</font>

336
00:11:13,130 --> 00:11:17,180
malicious websites or domains that gets

337
00:11:15,440 --> 00:11:19,100
a little bit into threat Intel which is

338
00:11:17,180 --> 00:11:20,989
a whole different talk but it's<font color="#E5E5E5"> very</font>

339
00:11:19,100 --> 00:11:22,940
difficult<font color="#E5E5E5"> if all you can detect on the</font>

340
00:11:20,990 --> 00:11:24,140
network are things that are known bad is

341
00:11:22,940 --> 00:11:26,330
if you're<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first company that's</font>

342
00:11:24,140 --> 00:11:27,740
attacked if it's a targeted attack then

343
00:11:26,330 --> 00:11:29,780
obviously there's not going to be

344
00:11:27,740 --> 00:11:31,070
anything in the database there and then

345
00:11:29,780 --> 00:11:32,720
we still see companies still trying to

346
00:11:31,070 --> 00:11:35,210
do full network capture so they'll give

347
00:11:32,720 --> 00:11:37,220
us<font color="#E5E5E5"> a huge hard drive of peak apps and</font>

348
00:11:35,210 --> 00:11:39,110
say what's there that's a lot<font color="#E5E5E5"> to process</font>

349
00:11:37,220 --> 00:11:41,450
it's a most of it's going to be

350
00:11:39,110 --> 00:11:42,980
encrypted many websites or SSL by

351
00:11:41,450 --> 00:11:45,260
default so we'll see that there's

352
00:11:42,980 --> 00:11:49,460
smarter ways to capture network data and

353
00:11:45,260 --> 00:11:51,140
manage it and so what I want to<font color="#E5E5E5"> do is</font>

354
00:11:49,460 --> 00:11:52,850
<font color="#E5E5E5">look at some of the questions that we</font>

355
00:11:51,140 --> 00:11:54,590
commonly asked our clients during

356
00:11:52,850 --> 00:11:56,810
incident response it's not<font color="#E5E5E5"> just</font><font color="#CCCCCC"> us but</font>

357
00:11:54,590 --> 00:11:58,940
every<font color="#CCCCCC"> other I our organization as well</font>

358
00:11:56,810 --> 00:12:00,560
if you're on an internal team these are

359
00:11:58,940 --> 00:12:03,170
questions that you<font color="#CCCCCC"> should be asking</font>

360
00:12:00,560 --> 00:12:06,439
during response and there's two reasons

361
00:12:03,170 --> 00:12:08,689
for<font color="#CCCCCC"> this these questions or they have</font>

362
00:12:06,440 --> 00:12:10,910
two purposes one is we want<font color="#E5E5E5"> to be able</font>

363
00:12:08,690 --> 00:12:12,680
to scale down an investigation if we

364
00:12:10,910 --> 00:12:14,780
know that one machine is compromised or

365
00:12:12,680 --> 00:12:16,760
we get one sort of indicator of badness

366
00:12:14,780 --> 00:12:18,319
that we want to<font color="#E5E5E5"> check for we don't want</font>

367
00:12:16,760 --> 00:12:20,360
to have to look at every machine in our

368
00:12:18,320 --> 00:12:22,550
environment we want to have logging in

369
00:12:20,360 --> 00:12:24,680
place we want to have historical data so

370
00:12:22,550 --> 00:12:26,540
that we can say out<font color="#CCCCCC"> of the ten thousand</font>

371
00:12:24,680 --> 00:12:28,189
machines in our environment there's ten

372
00:12:26,540 --> 00:12:30,110
of them that probably talked to this bad

373
00:12:28,190 --> 00:12:32,030
domain and so then we can deep dive

374
00:12:30,110 --> 00:12:33,830
those ten systems that's a reasonable

375
00:12:32,030 --> 00:12:35,660
approach to take versus we're going to

376
00:12:33,830 --> 00:12:37,280
do manual forensics on ten thousand

377
00:12:35,660 --> 00:12:39,560
machines which just doesn't work no one

378
00:12:37,280 --> 00:12:41,959
can do that so as I'm<font color="#E5E5E5"> going</font><font color="#CCCCCC"> through</font>

379
00:12:39,560 --> 00:12:43,099
these questions be thinking<font color="#CCCCCC"> about not</font>

380
00:12:41,960 --> 00:12:44,660
going to make anyone raise hands

381
00:12:43,100 --> 00:12:46,670
obviously but can you answer these

382
00:12:44,660 --> 00:12:49,219
questions in your<font color="#E5E5E5"> own environment if you</font>

383
00:12:46,670 --> 00:12:51,170
can for how long so this first<font color="#E5E5E5"> one if I</font>

384
00:12:49,220 --> 00:12:53,420
tell<font color="#CCCCCC"> you</font><font color="#E5E5E5"> malicious website</font><font color="#CCCCCC"> calm is</font>

385
00:12:51,170 --> 00:12:55,339
hosting malware and we want to know did

386
00:12:53,420 --> 00:12:57,500
anyone in<font color="#E5E5E5"> your environment visit that</font>

387
00:12:55,340 --> 00:12:59,120
website if you can tell me<font color="#CCCCCC"> that</font><font color="#E5E5E5"> well how</font>

388
00:12:57,500 --> 00:13:01,010
<font color="#CCCCCC">long can you tell me that for can you</font>

389
00:12:59,120 --> 00:13:03,290
say<font color="#E5E5E5"> only for the last hour can you tell</font>

390
00:13:01,010 --> 00:13:04,910
<font color="#E5E5E5">me up to a year ago what</font><font color="#CCCCCC"> level can</font><font color="#E5E5E5"> you</font>

391
00:13:03,290 --> 00:13:06,650
tell me currently and what level are you

392
00:13:04,910 --> 00:13:08,630
comfortable<font color="#CCCCCC"> with if you think it's</font>

393
00:13:06,650 --> 00:13:10,430
longer or right now you only<font color="#CCCCCC"> have say</font>

394
00:13:08,630 --> 00:13:11,960
web logs for a week that's<font color="#E5E5E5"> probably not</font>

395
00:13:10,430 --> 00:13:14,930
good enough most people don't detect

396
00:13:11,960 --> 00:13:16,730
every breach that they have within a

397
00:13:14,930 --> 00:13:18,620
week a couple<font color="#E5E5E5"> months would be better</font>

398
00:13:16,730 --> 00:13:20,360
some companies are really paranoid and

399
00:13:18,620 --> 00:13:21,350
keep it longer but then you<font color="#E5E5E5"> get into</font>

400
00:13:20,360 --> 00:13:22,970
legal issues because then

401
00:13:21,350 --> 00:13:24,680
all open to discovery so there's a lot

402
00:13:22,970 --> 00:13:26,240
<font color="#E5E5E5">to think about but these are questions</font>

403
00:13:24,680 --> 00:13:28,219
that you definitely want to be able to

404
00:13:26,240 --> 00:13:30,380
answer the other thing to think about is

405
00:13:28,220 --> 00:13:32,660
what coverage do you have so if<font color="#E5E5E5"> I</font><font color="#CCCCCC"> ask</font>

406
00:13:30,380 --> 00:13:35,030
you which of<font color="#E5E5E5"> your employees visited a</font>

407
00:13:32,660 --> 00:13:36,770
malicious website how full of an answer

408
00:13:35,030 --> 00:13:38,180
<font color="#E5E5E5">can you give me is it just</font><font color="#CCCCCC"> people at the</font>

409
00:13:36,770 --> 00:13:40,280
main office can<font color="#E5E5E5"> you tell me about all</font>

410
00:13:38,180 --> 00:13:43,040
<font color="#E5E5E5">your offices around the world what if</font>

411
00:13:40,280 --> 00:13:44,839
<font color="#E5E5E5">someone was using their phone obviously</font>

412
00:13:43,040 --> 00:13:46,640
connected to the the company<font color="#CCCCCC"> network</font>

413
00:13:44,840 --> 00:13:48,260
what about<font color="#CCCCCC"> travelling people if you have</font>

414
00:13:46,640 --> 00:13:50,030
sales teams if<font color="#E5E5E5"> you have marketing teams</font>

415
00:13:48,260 --> 00:13:52,430
are they forced to go<font color="#CCCCCC"> back through the</font>

416
00:13:50,030 --> 00:13:54,260
VPN how complete of an answer<font color="#E5E5E5"> can you</font>

417
00:13:52,430 --> 00:13:58,209
give me<font color="#CCCCCC"> just based on knowing this</font>

418
00:13:54,260 --> 00:13:58,210
website and<font color="#E5E5E5"> just based on your web logs</font>

419
00:14:09,790 --> 00:14:13,430
yeah we're going<font color="#E5E5E5"> to actually go through</font>

420
00:14:11,570 --> 00:14:18,020
all the tools and stuff all open source

421
00:14:13,430 --> 00:14:19,550
tools so yeah so so again we wanted you

422
00:14:18,020 --> 00:14:20,960
want to be able to answer how long could

423
00:14:19,550 --> 00:14:22,910
you go back<font color="#CCCCCC"> and answer these questions</font>

424
00:14:20,960 --> 00:14:25,070
for<font color="#E5E5E5"> and how complete would your answers</font>

425
00:14:22,910 --> 00:14:27,110
be and it becomes an issue if<font color="#CCCCCC"> you say</font>

426
00:14:25,070 --> 00:14:29,120
<font color="#CCCCCC">for instance I</font><font color="#E5E5E5"> can tell you about all</font><font color="#CCCCCC"> my</font>

427
00:14:27,110 --> 00:14:31,100
people that have a desktop<font color="#E5E5E5"> incomes the</font>

428
00:14:29,120 --> 00:14:33,590
office every<font color="#CCCCCC"> day but I can't give you</font><font color="#E5E5E5"> an</font>

429
00:14:31,100 --> 00:14:34,880
instant answer for my salespeople what

430
00:14:33,590 --> 00:14:36,320
does that mean do we<font color="#CCCCCC"> have to bring all</font>

431
00:14:34,880 --> 00:14:38,090
their laptops in do we have to bring<font color="#E5E5E5"> all</font>

432
00:14:36,320 --> 00:14:39,860
their devices in and analyze them if

433
00:14:38,090 --> 00:14:41,480
<font color="#E5E5E5">this is really malicious</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> where if</font>

434
00:14:39,860 --> 00:14:43,010
it's targeted to your company you

435
00:14:41,480 --> 00:14:44,780
probably<font color="#E5E5E5"> do because you can't just hope</font>

436
00:14:43,010 --> 00:14:46,340
that oh well the guy in accounting was

437
00:14:44,780 --> 00:14:47,900
targeted<font color="#E5E5E5"> and we figured</font><font color="#CCCCCC"> that out and</font>

438
00:14:46,340 --> 00:14:49,430
let's just<font color="#E5E5E5"> assume that no one that</font>

439
00:14:47,900 --> 00:14:51,890
travels was targeted by it<font color="#E5E5E5"> that doesn't</font>

440
00:14:49,430 --> 00:14:54,439
<font color="#E5E5E5">it doesn't work in the real world so the</font>

441
00:14:51,890 --> 00:14:56,300
fuller fuller coverage is the the

442
00:14:54,440 --> 00:14:59,600
quicker is going to be and the more<font color="#E5E5E5"> we</font>

443
00:14:56,300 --> 00:15:01,520
can<font color="#E5E5E5"> scale our analysis so again one</font>

444
00:14:59,600 --> 00:15:04,520
question is what web site was visited by

445
00:15:01,520 --> 00:15:06,439
malicious users on the DNS side what

446
00:15:04,520 --> 00:15:08,750
about<font color="#E5E5E5"> just the main resolution so if I</font>

447
00:15:06,440 --> 00:15:10,670
tell you<font color="#E5E5E5"> or if I</font><font color="#CCCCCC"> ask you how many people</font>

448
00:15:08,750 --> 00:15:13,340
in your organization resolve bad domain

449
00:15:10,670 --> 00:15:14,870
org can you tell<font color="#E5E5E5"> me that same thing how</font>

450
00:15:13,340 --> 00:15:16,880
long does that<font color="#E5E5E5"> go back what's your</font>

451
00:15:14,870 --> 00:15:19,130
coverage like can you tell me which

452
00:15:16,880 --> 00:15:20,780
users downloaded certain files we see

453
00:15:19,130 --> 00:15:22,790
this all the time we're particularly

454
00:15:20,780 --> 00:15:24,470
like with malicious advertising networks

455
00:15:22,790 --> 00:15:27,230
it doesn't even<font color="#E5E5E5"> have to be a targeted</font>

456
00:15:24,470 --> 00:15:29,540
attack but we know<font color="#CCCCCC"> if a certain user was</font>

457
00:15:27,230 --> 00:15:31,100
redirected to a flash file of some type

458
00:15:29,540 --> 00:15:32,930
or a<font color="#E5E5E5"> javascript file of some type</font>

459
00:15:31,100 --> 00:15:34,620
everyone in the organization is going to

460
00:15:32,930 --> 00:15:36,060
be on the same browser version

461
00:15:34,620 --> 00:15:38,220
one person got exploited it's very

462
00:15:36,060 --> 00:15:39,660
likely the next person got exploited so

463
00:15:38,220 --> 00:15:41,460
now instead of having<font color="#CCCCCC"> to check say the</font>

464
00:15:39,660 --> 00:15:43,560
browser history of every user on<font color="#CCCCCC"> the</font>

465
00:15:41,460 --> 00:15:46,230
network we just go to the web blog say

466
00:15:43,560 --> 00:15:49,969
which employs downloaded this file and

467
00:15:46,230 --> 00:15:52,230
<font color="#E5E5E5">that's where</font><font color="#CCCCCC"> we pivot our analysis to</font>

468
00:15:49,970 --> 00:15:54,030
same<font color="#CCCCCC"> thing when we're looking at lateral</font>

469
00:15:52,230 --> 00:15:55,890
movement essentially do you have net

470
00:15:54,030 --> 00:15:58,199
flow can you tell me which systems did

471
00:15:55,890 --> 00:16:00,240
an internal system connect to when

472
00:15:58,200 --> 00:16:01,830
attackers got on a system initially

473
00:16:00,240 --> 00:16:03,690
where did they pivot around the network

474
00:16:01,830 --> 00:16:05,910
if you can't answer that it becomes very

475
00:16:03,690 --> 00:16:07,920
<font color="#E5E5E5">hard because then your scope is well the</font>

476
00:16:05,910 --> 00:16:09,150
attackers could have moved anywhere and

477
00:16:07,920 --> 00:16:11,510
unfortunately we do with those

478
00:16:09,150 --> 00:16:13,800
situations a lot another<font color="#E5E5E5"> one which is</font>

479
00:16:11,510 --> 00:16:16,290
unfortunately people don't always

480
00:16:13,800 --> 00:16:18,359
include this in their response plans but

481
00:16:16,290 --> 00:16:20,310
let's say<font color="#E5E5E5"> Bob's account was compromised</font>

482
00:16:18,360 --> 00:16:22,380
<font color="#E5E5E5">who clicked on a fishing link his</font>

483
00:16:20,310 --> 00:16:24,089
machines infected where else did that

484
00:16:22,380 --> 00:16:26,040
account go around the network did he log

485
00:16:24,090 --> 00:16:27,870
<font color="#E5E5E5">into any internal web applications that</font>

486
00:16:26,040 --> 00:16:30,689
he talked<font color="#CCCCCC"> to any vendor portals it's not</font>

487
00:16:27,870 --> 00:16:32,460
<font color="#E5E5E5">just about direct logins</font><font color="#CCCCCC"> to Windows</font>

488
00:16:30,690 --> 00:16:34,140
servers around the network it's every

489
00:16:32,460 --> 00:16:36,120
resource that those attackers now have

490
00:16:34,140 --> 00:16:38,040
access to that<font color="#E5E5E5"> they didn't before and</font>

491
00:16:36,120 --> 00:16:40,200
then if we look on the disk there's a

492
00:16:38,040 --> 00:16:42,689
<font color="#E5E5E5">lot we want to answer as well if I tell</font>

493
00:16:40,200 --> 00:16:44,550
<font color="#E5E5E5">you that malware exe has a static way</font>

494
00:16:42,690 --> 00:16:46,710
that we can detect<font color="#E5E5E5"> it it's going to make</font>

495
00:16:44,550 --> 00:16:48,870
a<font color="#E5E5E5"> certain registry key in the registry</font>

496
00:16:46,710 --> 00:16:50,580
where it stores its data well how

497
00:16:48,870 --> 00:16:52,620
quickly can<font color="#CCCCCC"> you scan</font><font color="#E5E5E5"> that across your</font>

498
00:16:50,580 --> 00:16:54,360
network if you have<font color="#CCCCCC"> 10,000</font><font color="#E5E5E5"> machines and</font>

499
00:16:52,620 --> 00:16:56,460
I give you the registry key is it going

500
00:16:54,360 --> 00:16:57,720
to<font color="#CCCCCC"> take you 10 minutes and hours they're</font>

501
00:16:56,460 --> 00:16:58,530
going to be something manual are you

502
00:16:57,720 --> 00:17:01,080
going to start putting<font color="#E5E5E5"> together</font>

503
00:16:58,530 --> 00:17:02,459
powershell scripts on the fly how quick

504
00:17:01,080 --> 00:17:03,840
<font color="#CCCCCC">can you take those indicators and</font>

505
00:17:02,460 --> 00:17:05,520
actually sweep your network with them

506
00:17:03,840 --> 00:17:07,590
<font color="#E5E5E5">because it's not</font><font color="#CCCCCC"> going to be scalable</font>

507
00:17:05,520 --> 00:17:09,359
unless your answer is certainly under a

508
00:17:07,589 --> 00:17:11,909
day<font color="#E5E5E5"> something like an hour to would be</font>

509
00:17:09,359 --> 00:17:14,040
much nicer and then when<font color="#CCCCCC"> we get into</font>

510
00:17:11,910 --> 00:17:16,290
malware that has the<font color="#E5E5E5"> entire forensics</font>

511
00:17:14,040 --> 00:17:17,849
capabilities that's when it starts<font color="#E5E5E5"> to</font>

512
00:17:16,290 --> 00:17:20,069
get difficult as well because it<font color="#E5E5E5"> becomes</font>

513
00:17:17,849 --> 00:17:21,659
very very tool specific so if<font color="#E5E5E5"> we look at</font>

514
00:17:20,069 --> 00:17:23,760
this last<font color="#E5E5E5"> one which is something we</font>

515
00:17:21,660 --> 00:17:25,860
commonly see there is a keylogger on the

516
00:17:23,760 --> 00:17:29,129
machine it writes to a hard-coded file

517
00:17:25,859 --> 00:17:30,780
path of<font color="#CCCCCC"> c operations log and this file</font>

518
00:17:29,130 --> 00:17:32,790
is hidden from the live system so you

519
00:17:30,780 --> 00:17:35,520
can't<font color="#CCCCCC"> just browse to it with say</font>

520
00:17:32,790 --> 00:17:37,110
<font color="#CCCCCC">explorer you can't use</font><font color="#E5E5E5"> powershell to try</font>

521
00:17:35,520 --> 00:17:39,180
to read the file system and<font color="#E5E5E5"> find the</font>

522
00:17:37,110 --> 00:17:41,129
file if if the<font color="#E5E5E5"> file is not there</font>

523
00:17:39,180 --> 00:17:42,720
obviously<font color="#CCCCCC"> it won't be found but</font><font color="#E5E5E5"> if it is</font>

524
00:17:41,130 --> 00:17:44,850
<font color="#E5E5E5">there the malware is going to be hiding</font>

525
00:17:42,720 --> 00:17:46,710
it it does<font color="#E5E5E5"> not exist on the live machine</font>

526
00:17:44,850 --> 00:17:48,209
so at<font color="#E5E5E5"> this point you</font><font color="#CCCCCC"> have to ask</font>

527
00:17:46,710 --> 00:17:50,580
yourself<font color="#CCCCCC"> ok well how</font>

528
00:17:48,210 --> 00:17:52,770
that malware hiding if it's hooking an

529
00:17:50,580 --> 00:17:54,899
<font color="#E5E5E5">API in user land then maybe I could use</font>

530
00:17:52,770 --> 00:17:56,429
the sleuth kit to look for it there's

531
00:17:54,899 --> 00:17:58,709
plenty<font color="#CCCCCC"> of tools that</font><font color="#E5E5E5"> use the sleuth kit</font>

532
00:17:56,429 --> 00:18:01,169
in<font color="#CCCCCC"> the background the sleuth kit parses</font>

533
00:17:58,710 --> 00:18:03,360
ntfs<font color="#E5E5E5"> on disk it doesn't call the api's</font>

534
00:18:01,169 --> 00:18:05,070
for it so that might be one way to find

535
00:18:03,360 --> 00:18:06,539
the file but<font color="#E5E5E5"> what if our</font><font color="#CCCCCC"> malware's</font>

536
00:18:05,070 --> 00:18:08,908
operating in the colonel let's say it

537
00:18:06,539 --> 00:18:10,649
hooks the NTFS driver then<font color="#E5E5E5"> anything</font>

538
00:18:08,909 --> 00:18:12,120
running in the kernel or user lands not

539
00:18:10,649 --> 00:18:14,639
going to see the file either<font color="#E5E5E5"> because the</font>

540
00:18:12,120 --> 00:18:16,709
sleuth gets going to parse that ntfs on

541
00:18:14,640 --> 00:18:18,570
disk but the NTFS data that's being

542
00:18:16,710 --> 00:18:20,039
presented is controlled by the malware's

543
00:18:18,570 --> 00:18:21,899
kernel driver and then at that point

544
00:18:20,039 --> 00:18:23,760
there's no way to find it on<font color="#CCCCCC"> the live</font>

545
00:18:21,899 --> 00:18:25,260
system and as you might guess we have to

546
00:18:23,760 --> 00:18:27,330
do memory forensics to go back<font color="#CCCCCC"> and</font>

547
00:18:25,260 --> 00:18:28,679
figure out it's there or we have to<font color="#CCCCCC"> get</font>

548
00:18:27,330 --> 00:18:30,360
<font color="#E5E5E5">a disk image and look that way but</font>

549
00:18:28,679 --> 00:18:31,770
that's<font color="#E5E5E5"> slow and and we're trying to</font>

550
00:18:30,360 --> 00:18:34,020
scale here we certainly don't<font color="#E5E5E5"> want to</font>

551
00:18:31,770 --> 00:18:35,250
pull disk images so again if you can't

552
00:18:34,020 --> 00:18:36,658
answer all these questions or if you

553
00:18:35,250 --> 00:18:38,730
don't<font color="#E5E5E5"> know what the</font><font color="#CCCCCC"> answers are to these</font>

554
00:18:36,659 --> 00:18:41,669
questions and you have an incident<font color="#E5E5E5"> or</font>

555
00:18:38,730 --> 00:18:43,799
you just want to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able to perform what</font>

556
00:18:41,669 --> 00:18:45,240
i would call effective detection if you

557
00:18:43,799 --> 00:18:47,158
can't answer all of these you definitely

558
00:18:45,240 --> 00:18:48,990
have some gaps and this is two slides of

559
00:18:47,159 --> 00:18:56,399
100 that I could make if I really wanted

560
00:18:48,990 --> 00:18:57,899
<font color="#CCCCCC">to expand this all the way out so when</font>

561
00:18:56,399 --> 00:18:59,969
we<font color="#E5E5E5"> talk about effective detection</font>

562
00:18:57,899 --> 00:19:02,549
response<font color="#E5E5E5"> there's a few requirements that</font>

563
00:18:59,970 --> 00:19:04,649
we need one is what I'll call visibility

564
00:19:02,549 --> 00:19:06,570
being<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to monitor actions that we</font>

565
00:19:04,649 --> 00:19:08,549
care about across the entire environment

566
00:19:06,570 --> 00:19:10,139
again if you tell me<font color="#E5E5E5"> we have</font><font color="#CCCCCC"> great</font>

567
00:19:08,549 --> 00:19:11,700
visibility in the data centers but we

568
00:19:10,140 --> 00:19:13,740
have no idea<font color="#CCCCCC"> what those people</font><font color="#E5E5E5"> in sales</font>

569
00:19:11,700 --> 00:19:15,059
do well there's a gap there right and

570
00:19:13,740 --> 00:19:16,740
there's companies that do that<font color="#E5E5E5"> whether</font>

571
00:19:15,059 --> 00:19:18,299
it's for budgeting reasons whether it's

572
00:19:16,740 --> 00:19:19,380
just they haven't<font color="#E5E5E5"> got around to it yet</font>

573
00:19:18,299 --> 00:19:21,510
whether they didn't think<font color="#E5E5E5"> it was</font>

574
00:19:19,380 --> 00:19:22,919
important the attackers know what's

575
00:19:21,510 --> 00:19:24,629
there when they're inside your network

576
00:19:22,919 --> 00:19:26,940
it's not<font color="#E5E5E5"> that hard for them to figure</font>

577
00:19:24,630 --> 00:19:28,529
out this network is monitored this one

578
00:19:26,940 --> 00:19:30,210
isn't or their security here their

579
00:19:28,529 --> 00:19:32,100
security not here and<font color="#E5E5E5"> you can probably</font>

580
00:19:30,210 --> 00:19:33,630
<font color="#E5E5E5">guess where they're going to pivot to so</font>

581
00:19:32,100 --> 00:19:35,699
wherever that gap is that's the first

582
00:19:33,630 --> 00:19:37,470
<font color="#E5E5E5">place the attackers are going to go it</font>

583
00:19:35,700 --> 00:19:39,299
also makes<font color="#E5E5E5"> it very hard when you say</font>

584
00:19:37,470 --> 00:19:41,130
when you're<font color="#E5E5E5"> in a large environment and</font>

585
00:19:39,299 --> 00:19:43,049
you want to be<font color="#E5E5E5"> able to say we're sure</font>

586
00:19:41,130 --> 00:19:44,220
that<font color="#CCCCCC"> we've contained this breach we're</font>

587
00:19:43,049 --> 00:19:45,779
sure<font color="#CCCCCC"> that the malware's gone we show</font>

588
00:19:44,220 --> 00:19:47,429
that the attackers are out if you<font color="#E5E5E5"> don't</font>

589
00:19:45,779 --> 00:19:48,870
have visibility everywhere you really

590
00:19:47,429 --> 00:19:50,460
can't answer that question you can say

591
00:19:48,870 --> 00:19:51,899
they're out of<font color="#E5E5E5"> this one data center or</font>

592
00:19:50,460 --> 00:19:54,240
they're<font color="#CCCCCC"> out of</font><font color="#E5E5E5"> this one office but</font>

593
00:19:51,899 --> 00:19:55,408
without full visibility it's hard to do

594
00:19:54,240 --> 00:19:58,049
<font color="#CCCCCC">that you're definitely not giving</font><font color="#E5E5E5"> a</font>

595
00:19:55,409 --> 00:20:00,120
complete answer another big thing here

596
00:19:58,049 --> 00:20:01,650
is a historical data so we'll see<font color="#CCCCCC"> how we</font>

597
00:20:00,120 --> 00:20:03,840
can log data that

598
00:20:01,650 --> 00:20:05,970
in weeks or months ago when you're doing

599
00:20:03,840 --> 00:20:08,280
<font color="#CCCCCC">ir if data is not there you can't</font>

600
00:20:05,970 --> 00:20:09,780
magically make it reappear if it wasn't

601
00:20:08,280 --> 00:20:12,180
logged if that action<font color="#E5E5E5"> is in storage</font>

602
00:20:09,780 --> 00:20:14,129
somewhere even<font color="#CCCCCC"> the best investigators</font>

603
00:20:12,180 --> 00:20:15,900
can't help you in that situation<font color="#E5E5E5"> so we</font>

604
00:20:14,130 --> 00:20:18,240
want to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure that all of that</font><font color="#E5E5E5"> data</font>

605
00:20:15,900 --> 00:20:19,980
is being logged and then the other<font color="#CCCCCC"> thing</font>

606
00:20:18,240 --> 00:20:22,260
is<font color="#E5E5E5"> going through our acquisition and</font>

607
00:20:19,980 --> 00:20:24,330
analysis processes so that we don't get

608
00:20:22,260 --> 00:20:26,310
fooled by anti forensics if your whole

609
00:20:24,330 --> 00:20:28,530
idea of going to a<font color="#CCCCCC"> machine to see if</font>

610
00:20:26,310 --> 00:20:30,480
there is malware is run<font color="#CCCCCC"> your life I our</font>

611
00:20:28,530 --> 00:20:32,730
tool and then look at<font color="#E5E5E5"> all the output it</font>

612
00:20:30,480 --> 00:20:34,620
gets that that's<font color="#E5E5E5"> not going to work this</font>

613
00:20:32,730 --> 00:20:36,690
doesn't<font color="#CCCCCC"> work anymore there's also issues</font>

614
00:20:34,620 --> 00:20:38,370
on the network where you can miss them

615
00:20:36,690 --> 00:20:47,580
<font color="#CCCCCC">our as well so we want to</font><font color="#E5E5E5"> make sure that</font>

616
00:20:38,370 --> 00:20:48,840
we have full coverage so the first thing

617
00:20:47,580 --> 00:20:51,199
we need to do on the endpoints is

618
00:20:48,840 --> 00:20:53,850
actually log events that we care about

619
00:20:51,200 --> 00:20:55,770
at a minimum we need logins and log loss

620
00:20:53,850 --> 00:20:57,389
it's very<font color="#E5E5E5"> hard to track where attackers</font>

621
00:20:55,770 --> 00:20:59,910
moved if you can't figure out who logged

622
00:20:57,390 --> 00:21:01,590
into machines and when<font color="#CCCCCC"> versus again if</font>

623
00:20:59,910 --> 00:21:03,510
<font color="#E5E5E5">we say that Bob clicked the fishing link</font>

624
00:21:01,590 --> 00:21:05,459
and the attackers got on this machine

625
00:21:03,510 --> 00:21:06,960
once the malware was loaded and then<font color="#E5E5E5"> we</font>

626
00:21:05,460 --> 00:21:08,610
have<font color="#E5E5E5"> logged in and log off records all</font>

627
00:21:06,960 --> 00:21:10,560
we have<font color="#E5E5E5"> to do</font><font color="#CCCCCC"> is consult those records</font>

628
00:21:08,610 --> 00:21:12,629
to say<font color="#E5E5E5"> from when the malware was</font>

629
00:21:10,560 --> 00:21:15,149
installed till we remove that malware

630
00:21:12,630 --> 00:21:16,770
where all did<font color="#CCCCCC"> Bob login to and if</font><font color="#E5E5E5"> we see</font>

631
00:21:15,150 --> 00:21:18,780
anything suspicious if it's a domain

632
00:21:16,770 --> 00:21:21,389
controller the exchange server anywhere

633
00:21:18,780 --> 00:21:23,310
besides where<font color="#E5E5E5"> Bob should be accessing we</font>

634
00:21:21,390 --> 00:21:24,540
know<font color="#CCCCCC"> that was the attackers and</font><font color="#E5E5E5"> also if</font>

635
00:21:23,310 --> 00:21:26,129
you have an employee assuming they're

636
00:21:24,540 --> 00:21:27,360
not in on<font color="#CCCCCC"> it most of the</font><font color="#E5E5E5"> time they're</font>

637
00:21:26,130 --> 00:21:28,800
cooperative and they can say I logged

638
00:21:27,360 --> 00:21:31,139
into the server logged<font color="#E5E5E5"> into this server</font>

639
00:21:28,800 --> 00:21:32,700
I have no idea<font color="#CCCCCC"> why</font><font color="#E5E5E5"> my account was used</font>

640
00:21:31,140 --> 00:21:34,410
on these other resources and that's

641
00:21:32,700 --> 00:21:36,390
where you pivot your analysis because

642
00:21:34,410 --> 00:21:38,970
again we want<font color="#E5E5E5"> to scale we don't want to</font>

643
00:21:36,390 --> 00:21:40,620
go on a<font color="#E5E5E5"> dis efficient expedition or a</font>

644
00:21:38,970 --> 00:21:42,060
hunting expedition trying to find every

645
00:21:40,620 --> 00:21:43,860
machine in the environment<font color="#E5E5E5"> seeing if</font>

646
00:21:42,060 --> 00:21:46,590
it's compromised we want to follow the

647
00:21:43,860 --> 00:21:48,149
attackers exactly where they went same

648
00:21:46,590 --> 00:21:51,149
thing with<font color="#E5E5E5"> the user account and group</font>

649
00:21:48,150 --> 00:21:53,820
creation this is where attackers will

650
00:21:51,150 --> 00:21:54,810
leave back door<font color="#CCCCCC"> counsel in</font><font color="#E5E5E5"> the system it</font>

651
00:21:53,820 --> 00:21:56,730
kind of<font color="#E5E5E5"> makes sense right because</font>

652
00:21:54,810 --> 00:21:58,919
eventually the attackers will get caught

653
00:21:56,730 --> 00:22:01,380
we'll figure out that bob was a user who

654
00:21:58,920 --> 00:22:03,060
had his credentials compromised and then

655
00:22:01,380 --> 00:22:04,530
we'll make<font color="#E5E5E5"> Bob changes password or in</font>

656
00:22:03,060 --> 00:22:06,300
some cases will delete his entire

657
00:22:04,530 --> 00:22:08,250
account but and you think at that point

658
00:22:06,300 --> 00:22:09,419
well maybe the attackers are gone but

659
00:22:08,250 --> 00:22:10,980
<font color="#E5E5E5">unfortunately they have all these</font>

660
00:22:09,420 --> 00:22:12,840
backdoor accounts around the network

661
00:22:10,980 --> 00:22:14,610
these<font color="#CCCCCC"> will often be put in the local</font>

662
00:22:12,840 --> 00:22:16,470
admin group if we're talking

663
00:22:14,610 --> 00:22:18,059
windows machines and then the attackers

664
00:22:16,470 --> 00:22:19,530
are back to having full access to your

665
00:22:18,059 --> 00:22:21,780
network and<font color="#E5E5E5"> so if you don't have this</font>

666
00:22:19,530 --> 00:22:24,770
type of auditing again you're not really

667
00:22:21,780 --> 00:22:27,389
doing full analysis or full forensics I

668
00:22:24,770 --> 00:22:29,129
have<font color="#E5E5E5"> in the desirable column because</font>

669
00:22:27,390 --> 00:22:30,929
they they're a little more intensive

670
00:22:29,130 --> 00:22:33,630
they can take more space it's also takes

671
00:22:30,929 --> 00:22:35,790
a little bit to get to configure these

672
00:22:33,630 --> 00:22:37,980
correctly but being<font color="#E5E5E5"> able to see process</font>

673
00:22:35,790 --> 00:22:40,559
creation in termination so on<font color="#CCCCCC"> Windows</font>

674
00:22:37,980 --> 00:22:42,720
you can tell the event logs to have

675
00:22:40,559 --> 00:22:44,730
process auditing that will log every

676
00:22:42,720 --> 00:22:46,500
process that starts along<font color="#CCCCCC"> with the time</font>

677
00:22:44,730 --> 00:22:48,630
it start the user<font color="#CCCCCC"> that started it and</font>

678
00:22:46,500 --> 00:22:50,280
the command line options you can do the

679
00:22:48,630 --> 00:22:51,960
<font color="#E5E5E5">same exact thing on linux and mac with</font>

680
00:22:50,280 --> 00:22:53,970
audit d so if you want<font color="#E5E5E5"> to</font><font color="#CCCCCC"> know</font>

681
00:22:51,960 --> 00:22:56,580
<font color="#E5E5E5">everything that ran on my linux server</font>

682
00:22:53,970 --> 00:22:58,080
you have audit d enabled as it says at

683
00:22:56,580 --> 00:23:00,120
the bottom this needs to be centralized

684
00:22:58,080 --> 00:23:02,610
the first thing attackers are going to

685
00:23:00,120 --> 00:23:04,199
do<font color="#E5E5E5"> is clear those log files so don't</font>

686
00:23:02,610 --> 00:23:06,360
expect you have a<font color="#E5E5E5"> machine compromised</font>

687
00:23:04,200 --> 00:23:08,130
then go look for the log files on the

688
00:23:06,360 --> 00:23:09,750
local disk and expect to really find

689
00:23:08,130 --> 00:23:11,640
what the attackers did again you're

690
00:23:09,750 --> 00:23:13,110
<font color="#E5E5E5">going to find all the log entries except</font>

691
00:23:11,640 --> 00:23:14,970
<font color="#CCCCCC">for those related to the attackers</font>

692
00:23:13,110 --> 00:23:16,530
<font color="#E5E5E5">versus if they're centralized somewhere</font>

693
00:23:14,970 --> 00:23:18,630
you have<font color="#CCCCCC"> a secure server they're being</font>

694
00:23:16,530 --> 00:23:20,639
written to this not only gets around the

695
00:23:18,630 --> 00:23:22,470
<font color="#E5E5E5">anti forensics it also allows you to</font>

696
00:23:20,640 --> 00:23:24,210
query it and so then we can say it's

697
00:23:22,470 --> 00:23:26,190
literally it's one query and most

698
00:23:24,210 --> 00:23:29,040
interfaces for these logs to say where

699
00:23:26,190 --> 00:23:31,140
did<font color="#E5E5E5"> Bob login or this user account ABC</font>

700
00:23:29,040 --> 00:23:32,460
123 was created how many machines was

701
00:23:31,140 --> 00:23:33,960
that created on because now we know

702
00:23:32,460 --> 00:23:35,850
<font color="#E5E5E5">those are compromised and we need to go</font>

703
00:23:33,960 --> 00:23:37,890
<font color="#CCCCCC">back and clean them up versus having</font><font color="#E5E5E5"> to</font>

704
00:23:35,850 --> 00:23:39,899
go<font color="#CCCCCC"> around the entire network looking at</font>

705
00:23:37,890 --> 00:23:42,330
user account information to<font color="#E5E5E5"> figure out</font>

706
00:23:39,900 --> 00:23:45,210
what's their process creation in

707
00:23:42,330 --> 00:23:48,210
termination does have some a<font color="#E5E5E5"> few</font>

708
00:23:45,210 --> 00:23:49,919
downsides to it one is attackers rename

709
00:23:48,210 --> 00:23:52,110
executables a lot we see in particular

710
00:23:49,919 --> 00:23:54,179
<font color="#E5E5E5">where they rename executables to one</font>

711
00:23:52,110 --> 00:23:57,780
character executable so you'll have a

712
00:23:54,179 --> 00:23:59,190
exe and<font color="#E5E5E5"> vix ence XD so when you see the</font>

713
00:23:57,780 --> 00:24:00,750
fact that those ran you know that

714
00:23:59,190 --> 00:24:02,580
obviously<font color="#CCCCCC"> that's malware it's something</font>

715
00:24:00,750 --> 00:24:05,040
suspicious but you don't exactly know

716
00:24:02,580 --> 00:24:07,168
what it is another thing we see is where

717
00:24:05,040 --> 00:24:09,210
command shell or<font color="#E5E5E5"> powershell is used and</font>

718
00:24:07,169 --> 00:24:10,380
all you see is command<font color="#E5E5E5"> that exe was run</font>

719
00:24:09,210 --> 00:24:12,570
or powershell was wrong it doesn't

720
00:24:10,380 --> 00:24:14,070
really tell you what happened one thing

721
00:24:12,570 --> 00:24:15,899
that<font color="#E5E5E5"> can help here</font><font color="#CCCCCC"> and that's very very</font>

722
00:24:14,070 --> 00:24:18,540
<font color="#CCCCCC">useful especially if you're in a windows</font>

723
00:24:15,900 --> 00:24:20,669
environment is SCCM how many people are

724
00:24:18,540 --> 00:24:22,110
using SCCM it's probably<font color="#CCCCCC"> not under NDA</font>

725
00:24:20,669 --> 00:24:23,730
<font color="#E5E5E5">okay so a lot of people are using that</font>

726
00:24:22,110 --> 00:24:25,199
if you weren't one of the people<font color="#CCCCCC"> that</font>

727
00:24:23,730 --> 00:24:27,160
<font color="#E5E5E5">raised your hand you can see the value</font>

728
00:24:25,200 --> 00:24:29,580
there SCCM is

729
00:24:27,160 --> 00:24:32,590
crucial in many cases that we do with

730
00:24:29,580 --> 00:24:34,090
SCCM enabled for every executable<font color="#CCCCCC"> that</font>

731
00:24:32,590 --> 00:24:35,949
runs you're going to get<font color="#E5E5E5"> the full path</font>

732
00:24:34,090 --> 00:24:37,990
of where it ran from you're going to get

733
00:24:35,950 --> 00:24:39,640
the sha-1 hash of the executable you're

734
00:24:37,990 --> 00:24:41,860
going to get the user at<font color="#E5E5E5"> rena's and so</font>

735
00:24:39,640 --> 00:24:43,930
on the thing we really<font color="#E5E5E5"> like is not only</font>

736
00:24:41,860 --> 00:24:46,689
does it give us<font color="#E5E5E5"> a list of every process</font>

737
00:24:43,930 --> 00:24:48,430
that ran along with its path that sha-1

738
00:24:46,690 --> 00:24:51,940
hash is very helpful<font color="#E5E5E5"> because let's say</font><font color="#CCCCCC"> i</font>

739
00:24:48,430 --> 00:24:55,000
take mimi cats and rename<font color="#CCCCCC"> it to w exe</font>

740
00:24:51,940 --> 00:24:56,470
and then run w exe<font color="#E5E5E5"> i don't really know</font>

741
00:24:55,000 --> 00:24:58,750
what that<font color="#CCCCCC"> is just from looking at the</font>

742
00:24:56,470 --> 00:25:00,700
name but<font color="#E5E5E5"> I can take the sha-1 hash out</font>

743
00:24:58,750 --> 00:25:02,620
<font color="#CCCCCC">of the SCCM records and Google</font><font color="#E5E5E5"> that</font>

744
00:25:00,700 --> 00:25:04,120
virustotal<font color="#E5E5E5"> is going to find it is going</font>

745
00:25:02,620 --> 00:25:05,770
to show up on all these download pages

746
00:25:04,120 --> 00:25:07,780
so now I know exactly<font color="#E5E5E5"> what that</font>

747
00:25:05,770 --> 00:25:09,670
executable is and that's one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the ways</font>

748
00:25:07,780 --> 00:25:11,800
we've been able<font color="#CCCCCC"> to track back these</font>

749
00:25:09,670 --> 00:25:13,570
these weird leading tools these rename

750
00:25:11,800 --> 00:25:15,669
tools back<font color="#CCCCCC"> to what they actually work</font>

751
00:25:13,570 --> 00:25:17,409
and<font color="#E5E5E5"> obviously you want as much context</font>

752
00:25:15,670 --> 00:25:21,790
as possible when you're working<font color="#E5E5E5"> in these</font>

753
00:25:17,410 --> 00:25:23,230
these real investigations another thing

754
00:25:21,790 --> 00:25:24,700
we need<font color="#E5E5E5"> to be able to join the endpoints</font>

755
00:25:23,230 --> 00:25:27,520
is memory forensics so I've mentioned

756
00:25:24,700 --> 00:25:29,800
this a few times but your live tools are

757
00:25:27,520 --> 00:25:32,440
very susceptible to Mauer interference

758
00:25:29,800 --> 00:25:34,540
we've done plenty of demos other people

759
00:25:32,440 --> 00:25:36,820
have videos online as well where<font color="#CCCCCC"> you run</font>

760
00:25:34,540 --> 00:25:38,770
every live tool possible you then load

761
00:25:36,820 --> 00:25:40,240
the malware and everything disappears

762
00:25:38,770 --> 00:25:41,980
from the<font color="#E5E5E5"> live system it's not in the</font>

763
00:25:40,240 --> 00:25:45,250
process<font color="#E5E5E5"> list you don't see an explorer</font>

764
00:25:41,980 --> 00:25:46,570
so doing live analysis is it<font color="#E5E5E5"> basically</font>

765
00:25:45,250 --> 00:25:48,400
means you don't<font color="#E5E5E5"> want to find the malware</font>

766
00:25:46,570 --> 00:25:49,689
I'm sure it fixes a check box somewhere

767
00:25:48,400 --> 00:25:51,940
but you're not actually going to find

768
00:25:49,690 --> 00:25:54,370
the infection so instead by doing memory

769
00:25:51,940 --> 00:25:56,410
forensics you're not susceptible to that

770
00:25:54,370 --> 00:25:58,149
type of interference your memory

771
00:25:56,410 --> 00:26:00,370
forensics tool is going to look directly

772
00:25:58,150 --> 00:26:02,140
in RAM and it's going to reconstruct the

773
00:26:00,370 --> 00:26:04,209
data on its own it's not going to call a

774
00:26:02,140 --> 00:26:06,160
live<font color="#E5E5E5"> API is to do it you can also do</font>

775
00:26:04,210 --> 00:26:08,590
memory forensics offline so completely

776
00:26:06,160 --> 00:26:10,750
away<font color="#CCCCCC"> from any type of malware and</font>

777
00:26:08,590 --> 00:26:13,570
interference on your forensics machine

778
00:26:10,750 --> 00:26:15,790
memory forensics can also scale much

779
00:26:13,570 --> 00:26:18,220
better than live analysis or or

780
00:26:15,790 --> 00:26:19,810
traditional forensics with memory

781
00:26:18,220 --> 00:26:21,880
forensics you obviously don't have disk

782
00:26:19,810 --> 00:26:24,100
images you don't even need to pull any

783
00:26:21,880 --> 00:26:25,780
files from disk in memory you'll have

784
00:26:24,100 --> 00:26:27,520
the file artifacts that you care<font color="#CCCCCC"> about</font>

785
00:26:25,780 --> 00:26:29,020
plus you'll have all<font color="#CCCCCC"> the information</font>

786
00:26:27,520 --> 00:26:31,180
that's in memory<font color="#E5E5E5"> that's not available</font>

787
00:26:29,020 --> 00:26:33,129
<font color="#CCCCCC">through api's and so if</font><font color="#E5E5E5"> you look at</font>

788
00:26:31,180 --> 00:26:34,690
volatility which we'll talk about<font color="#E5E5E5"> it's</font>

789
00:26:33,130 --> 00:26:36,790
an open source framework for memory

790
00:26:34,690 --> 00:26:39,720
forensics used by thousands of

791
00:26:36,790 --> 00:26:41,190
investigators it has over 250 plugins

792
00:26:39,720 --> 00:26:43,409
so if you look<font color="#E5E5E5"> at your live tools they</font>

793
00:26:41,190 --> 00:26:44,760
maybe have<font color="#CCCCCC"> ten columns of output 20</font>

794
00:26:43,409 --> 00:26:47,010
columns of output they can show you

795
00:26:44,760 --> 00:26:48,750
<font color="#E5E5E5">because that's what Windows or Linux or</font>

796
00:26:47,010 --> 00:26:50,730
Mac makes available through the<font color="#E5E5E5"> api's</font>

797
00:26:48,750 --> 00:26:52,679
<font color="#E5E5E5">versus once you have a memory capture</font>

798
00:26:50,730 --> 00:26:54,480
it's literally anything loaded into<font color="#E5E5E5"> Ram</font>

799
00:26:52,679 --> 00:26:57,960
if you can write a script to find it

800
00:26:54,480 --> 00:26:59,970
then you can automatically recover it so

801
00:26:57,960 --> 00:27:01,830
between logging on the endpoints<font color="#E5E5E5"> and</font>

802
00:26:59,970 --> 00:27:03,690
logging all<font color="#CCCCCC"> the data we talked</font><font color="#E5E5E5"> about on</font>

803
00:27:01,830 --> 00:27:05,820
<font color="#CCCCCC">the last slide and between</font><font color="#E5E5E5"> having memory</font>

804
00:27:03,690 --> 00:27:07,320
forensics available we can start to do

805
00:27:05,820 --> 00:27:11,070
some some actually effective and

806
00:27:07,320 --> 00:27:13,260
scalable detection and response have

807
00:27:11,070 --> 00:27:15,299
some<font color="#CCCCCC"> examples here of automating some</font>

808
00:27:13,260 --> 00:27:17,429
interesting log analysis these<font color="#E5E5E5"> are</font>

809
00:27:15,299 --> 00:27:19,260
things that many<font color="#E5E5E5"> companies run again</font>

810
00:27:17,429 --> 00:27:21,750
there could be a whole hour talk just<font color="#E5E5E5"> on</font>

811
00:27:19,260 --> 00:27:24,510
<font color="#E5E5E5">this but things that I know have caught</font>

812
00:27:21,750 --> 00:27:25,970
at attacks that were active in

813
00:27:24,510 --> 00:27:28,830
environments things that caught his

814
00:27:25,970 --> 00:27:30,750
historical breaches at companies so once

815
00:27:28,830 --> 00:27:33,360
we have all that data from our event

816
00:27:30,750 --> 00:27:35,460
logs put into a database if you can

817
00:27:33,360 --> 00:27:38,250
answer these three questions or if these

818
00:27:35,460 --> 00:27:39,600
would pop out automatically for you you

819
00:27:38,250 --> 00:27:41,880
would catch a<font color="#E5E5E5"> lot of attacks that we've</font>

820
00:27:39,600 --> 00:27:43,530
seen so why did<font color="#E5E5E5"> Bob who's an accounting</font>

821
00:27:41,880 --> 00:27:45,390
<font color="#E5E5E5">log</font><font color="#CCCCCC"> into a</font><font color="#E5E5E5"> domain controller while you</font>

822
00:27:43,530 --> 00:27:47,760
<font color="#E5E5E5">log</font><font color="#CCCCCC"> into the</font><font color="#E5E5E5"> exchange</font><font color="#CCCCCC"> server why did</font><font color="#E5E5E5"> you</font>

823
00:27:45,390 --> 00:27:49,530
log into anything but is desktop that

824
00:27:47,760 --> 00:27:52,049
something is very<font color="#E5E5E5"> easy to automate and</font>

825
00:27:49,530 --> 00:27:54,720
most analysis engines where users should

826
00:27:52,049 --> 00:27:57,240
be these engines can also learn to some

827
00:27:54,720 --> 00:27:58,679
sense you can say Bob for the<font color="#CCCCCC"> last three</font>

828
00:27:57,240 --> 00:28:00,720
<font color="#CCCCCC">years that</font><font color="#E5E5E5"> he's been employed has only</font>

829
00:27:58,679 --> 00:28:02,370
logged<font color="#E5E5E5"> into these two systems yesterday</font>

830
00:28:00,720 --> 00:28:04,740
he logged<font color="#E5E5E5"> into this third system why is</font>

831
00:28:02,370 --> 00:28:06,539
that it's<font color="#E5E5E5"> probably because the attackers</font>

832
00:28:04,740 --> 00:28:08,100
have its credentials now and are<font color="#CCCCCC"> moving</font>

833
00:28:06,539 --> 00:28:09,840
around the other thing this<font color="#E5E5E5"> kind of</font>

834
00:28:08,100 --> 00:28:11,639
catches is those insider threats we used

835
00:28:09,840 --> 00:28:13,230
to deal<font color="#E5E5E5"> with</font><font color="#CCCCCC"> Bob used to be a great</font>

836
00:28:11,640 --> 00:28:14,760
employee he now wants to<font color="#E5E5E5"> rip off the</font>

837
00:28:13,230 --> 00:28:16,350
company<font color="#E5E5E5"> so he's moving around the</font>

838
00:28:14,760 --> 00:28:19,289
network to find data he wants to take

839
00:28:16,350 --> 00:28:21,059
many times your insider threats look

840
00:28:19,289 --> 00:28:23,309
exactly like attackers when you're doing

841
00:28:21,059 --> 00:28:25,168
forensics same with the other ones why

842
00:28:23,309 --> 00:28:27,658
is a network it meant logging in outside

843
00:28:25,169 --> 00:28:29,220
of weird<font color="#E5E5E5"> time frames why do users have</font>

844
00:28:27,659 --> 00:28:31,530
privileges they shouldn't we see that a

845
00:28:29,220 --> 00:28:33,419
<font color="#CCCCCC">lot especially with end users getting</font>

846
00:28:31,530 --> 00:28:35,520
compromised the attackers will get on

847
00:28:33,419 --> 00:28:37,679
the machine that end user<font color="#E5E5E5"> that employee</font>

848
00:28:35,520 --> 00:28:39,570
is not a local<font color="#E5E5E5"> admit they're running</font>

849
00:28:37,679 --> 00:28:41,640
with limited privileges the attackers

850
00:28:39,570 --> 00:28:43,799
then escalate privileges and now you see

851
00:28:41,640 --> 00:28:45,419
where these users who definitely should

852
00:28:43,799 --> 00:28:47,280
not be domain admins suddenly have

853
00:28:45,419 --> 00:28:48,990
processes running as domain admins and

854
00:28:47,280 --> 00:28:50,789
this is<font color="#CCCCCC"> something that the event logs</font>

855
00:28:48,990 --> 00:28:52,830
can track directly for you when those

856
00:28:50,789 --> 00:28:54,570
privilege escalations happen you then

857
00:28:52,830 --> 00:28:57,480
have them logged out somewhere securely

858
00:28:54,570 --> 00:28:59,460
and it shows up<font color="#E5E5E5"> right away and then</font><font color="#CCCCCC"> same</font>

859
00:28:57,480 --> 00:29:02,100
<font color="#E5E5E5">idea with memory forensics we want to</font>

860
00:28:59,460 --> 00:29:03,570
replace<font color="#E5E5E5"> our live by our artifacts so we</font>

861
00:29:02,100 --> 00:29:06,149
want<font color="#E5E5E5"> to replace running those live by</font>

862
00:29:03,570 --> 00:29:07,500
our tools by doing memory forensics by

863
00:29:06,149 --> 00:29:09,570
doing<font color="#E5E5E5"> that we're going to get the speed</font>

864
00:29:07,500 --> 00:29:12,059
advantage and we're also not going to be

865
00:29:09,570 --> 00:29:13,320
susceptible to anti forensics so we<font color="#E5E5E5"> can</font>

866
00:29:12,059 --> 00:29:15,899
do this on<font color="#E5E5E5"> your end points you</font><font color="#CCCCCC"> have a</font>

867
00:29:13,320 --> 00:29:17,760
really<font color="#CCCCCC"> good chance of detecting breaches</font>

868
00:29:15,899 --> 00:29:20,489
as they happen when network when

869
00:29:17,760 --> 00:29:24,779
attackers get in your environment and we

870
00:29:20,490 --> 00:29:27,450
can get the detection way earlier when

871
00:29:24,779 --> 00:29:29,580
<font color="#CCCCCC">we move to response it becomes really</font>

872
00:29:27,450 --> 00:29:31,289
straightforward as well again we know

873
00:29:29,580 --> 00:29:32,970
that one machine was compromised that's

874
00:29:31,289 --> 00:29:34,980
why we're doing<font color="#E5E5E5"> our investigation we</font>

875
00:29:32,970 --> 00:29:36,149
<font color="#E5E5E5">have thousands of machines potentially</font>

876
00:29:34,980 --> 00:29:38,220
though where the attackers could have

877
00:29:36,149 --> 00:29:40,289
moved how do we<font color="#E5E5E5"> pick where to pivot our</font>

878
00:29:38,220 --> 00:29:43,049
investigation well we can start with the

879
00:29:40,289 --> 00:29:44,490
event logs we can say the attackers got

880
00:29:43,049 --> 00:29:46,830
on<font color="#E5E5E5"> this machine at this date at a</font>

881
00:29:44,490 --> 00:29:48,809
certain time all forensics artifacts are

882
00:29:46,830 --> 00:29:50,939
<font color="#E5E5E5">time-stamped down to the second that</font>

883
00:29:48,809 --> 00:29:52,408
they happen so we can say the Mauer got

884
00:29:50,940 --> 00:29:54,750
on this machine at this second on this

885
00:29:52,409 --> 00:29:57,090
day well tell me everything in the event

886
00:29:54,750 --> 00:29:59,370
logs that happened within a day of that

887
00:29:57,090 --> 00:30:01,470
we can filter down to<font color="#E5E5E5"> that one machine</font>

888
00:29:59,370 --> 00:30:02,729
at first we can see what systems were

889
00:30:01,470 --> 00:30:04,590
accessed from that machine on the

890
00:30:02,730 --> 00:30:06,090
network we can see which user accounts

891
00:30:04,590 --> 00:30:07,889
on that machine were then used around

892
00:30:06,090 --> 00:30:09,928
the network and we know where to pivot

893
00:30:07,889 --> 00:30:11,789
we<font color="#CCCCCC"> can also use things like our SCCM</font>

894
00:30:09,929 --> 00:30:13,440
records to say what was actually run on

895
00:30:11,789 --> 00:30:14,940
that system do we sing that cat do we

896
00:30:13,440 --> 00:30:16,590
<font color="#CCCCCC">see nmap do we see other types of</font>

897
00:30:14,940 --> 00:30:18,029
reconnaissance tools we get a pretty

898
00:30:16,590 --> 00:30:20,459
good<font color="#E5E5E5"> idea of what the attackers were</font>

899
00:30:18,029 --> 00:30:22,799
doing that last part of course assumes

900
00:30:20,460 --> 00:30:24,510
they run executables on the machine if

901
00:30:22,799 --> 00:30:26,399
they have memory only malware that's

902
00:30:24,510 --> 00:30:27,990
<font color="#E5E5E5">where memory forensics comes in as soon</font>

903
00:30:26,399 --> 00:30:29,610
as we know a machine is compromised or

904
00:30:27,990 --> 00:30:31,110
we want to deeply investigate it the

905
00:30:29,610 --> 00:30:33,000
first thing you do<font color="#CCCCCC"> is walk up and take a</font>

906
00:30:31,110 --> 00:30:34,678
memory capture and then from<font color="#E5E5E5"> there</font>

907
00:30:33,000 --> 00:30:36,389
<font color="#CCCCCC">you're not only going to find malware on</font>

908
00:30:34,679 --> 00:30:38,490
disk through memory you're also<font color="#CCCCCC"> going to</font>

909
00:30:36,389 --> 00:30:39,840
<font color="#E5E5E5">find that memory only malware you'll be</font>

910
00:30:38,490 --> 00:30:41,250
able to find a lot<font color="#E5E5E5"> of things that your</font>

911
00:30:39,840 --> 00:30:43,439
agents can't tell you so if the

912
00:30:41,250 --> 00:30:45,690
attackers were using<font color="#E5E5E5"> PowerShell if they</font>

913
00:30:43,440 --> 00:30:47,669
were using command esc that's<font color="#E5E5E5"> going to</font>

914
00:30:45,690 --> 00:30:49,830
<font color="#E5E5E5">be left around in memory you'll have no</font>

915
00:30:47,669 --> 00:30:51,450
record of<font color="#E5E5E5"> it anywhere else and then data</font>

916
00:30:49,830 --> 00:30:53,970
that's just hanging out<font color="#CCCCCC"> in memory that</font>

917
00:30:51,450 --> 00:30:55,889
the api's don't know about so again if

918
00:30:53,970 --> 00:30:58,139
the attackers ran some tools those tools

919
00:30:55,889 --> 00:31:00,600
terminated after they were after they

920
00:30:58,139 --> 00:31:02,070
ran that's not going to be<font color="#E5E5E5"> available on</font>

921
00:31:00,600 --> 00:31:03,870
the live system where with memory

922
00:31:02,070 --> 00:31:06,889
forensics we can go back<font color="#CCCCCC"> and get all of</font>

923
00:31:03,870 --> 00:31:06,889
the historical information

924
00:31:07,010 --> 00:31:11,700
so at this<font color="#E5E5E5"> point we can really scale our</font>

925
00:31:09,690 --> 00:31:13,890
<font color="#CCCCCC">in paint our end point based response</font>

926
00:31:11,700 --> 00:31:16,020
will know exactly which machines to look

927
00:31:13,890 --> 00:31:17,850
at<font color="#E5E5E5"> we'll have time stamped activity of</font>

928
00:31:16,020 --> 00:31:19,980
everything they did and we have memory

929
00:31:17,850 --> 00:31:21,780
forensics behind us that's going to find

930
00:31:19,980 --> 00:31:24,090
the malware no matter how advanced it is

931
00:31:21,780 --> 00:31:26,760
and then we<font color="#E5E5E5"> can take that malware out of</font>

932
00:31:24,090 --> 00:31:28,260
memory we can put<font color="#E5E5E5"> it in a sandbox we can</font>

933
00:31:26,760 --> 00:31:30,360
reverse engineer it we can figure out

934
00:31:28,260 --> 00:31:32,610
okay what registry keys might it right

935
00:31:30,360 --> 00:31:34,260
to if its memory only what does<font color="#E5E5E5"> that</font>

936
00:31:32,610 --> 00:31:36,090
look like in memory<font color="#E5E5E5"> how is it injecting</font>

937
00:31:34,260 --> 00:31:37,740
<font color="#E5E5E5">its code where is it injecting its code</font>

938
00:31:36,090 --> 00:31:40,439
and then we can build indicators<font color="#CCCCCC"> to</font>

939
00:31:37,740 --> 00:31:42,330
compromise and then if you have again

940
00:31:40,440 --> 00:31:44,070
<font color="#CCCCCC">10,000 systems in your network and you</font>

941
00:31:42,330 --> 00:31:46,110
have some way<font color="#E5E5E5"> to sweep that all of those</font>

942
00:31:44,070 --> 00:31:48,149
systems looking for these indicators you

943
00:31:46,110 --> 00:31:50,399
can<font color="#E5E5E5"> narrow down say the 10,000 possible</font>

944
00:31:48,150 --> 00:31:52,050
systems to maybe the three or four that

945
00:31:50,400 --> 00:31:54,090
the attackers move to even if the

946
00:31:52,050 --> 00:31:56,070
attacker moved to 100 out of 10,000

947
00:31:54,090 --> 00:31:57,480
that's much nicer to know than having to

948
00:31:56,070 --> 00:32:01,800
kind of guess at what machines they

949
00:31:57,480 --> 00:32:03,120
might go on<font color="#E5E5E5"> and then where this really</font>

950
00:32:01,800 --> 00:32:05,399
brings us is not<font color="#E5E5E5"> only do we have</font>

951
00:32:03,120 --> 00:32:07,110
effective detection response we can also

952
00:32:05,400 --> 00:32:09,090
do threat hunting I know thread hunting

953
00:32:07,110 --> 00:32:10,590
is a buzzword the marketing people have

954
00:32:09,090 --> 00:32:12,959
<font color="#E5E5E5">picked it up which means it'll die soon</font>

955
00:32:10,590 --> 00:32:14,429
but<font color="#E5E5E5"> it's a really effective technique</font>

956
00:32:12,960 --> 00:32:16,200
people have<font color="#CCCCCC"> been doing</font><font color="#E5E5E5"> it a long time</font>

957
00:32:14,430 --> 00:32:18,330
<font color="#E5E5E5">before the marketing community figured</font>

958
00:32:16,200 --> 00:32:19,950
out what it was and the<font color="#E5E5E5"> idea what thread</font>

959
00:32:18,330 --> 00:32:21,840
hunting is you go<font color="#E5E5E5"> to your critical</font>

960
00:32:19,950 --> 00:32:23,310
machines you go to the machines that you

961
00:32:21,840 --> 00:32:25,080
<font color="#CCCCCC">definitely don't</font><font color="#E5E5E5"> want compromise your</font>

962
00:32:23,310 --> 00:32:27,270
domain controllers your exchange servers

963
00:32:25,080 --> 00:32:30,179
your source code servers everything that

964
00:32:27,270 --> 00:32:31,440
if it showed up on say WikiLeaks or

965
00:32:30,180 --> 00:32:33,300
paste bin it would be really bad for

966
00:32:31,440 --> 00:32:35,100
your<font color="#E5E5E5"> company or for a competitor got it</font>

967
00:32:33,300 --> 00:32:36,960
and so with thread hunting you're going

968
00:32:35,100 --> 00:32:39,419
to those critical systems and you're

969
00:32:36,960 --> 00:32:41,040
<font color="#E5E5E5">doing proactive analysis you're pulling</font>

970
00:32:39,420 --> 00:32:42,690
the event logs out of<font color="#E5E5E5"> your centralized</font>

971
00:32:41,040 --> 00:32:44,550
device you're getting a memory capture

972
00:32:42,690 --> 00:32:45,600
you're doing very deep memory forensics

973
00:32:44,550 --> 00:32:47,310
you're looking at everything possible

974
00:32:45,600 --> 00:32:49,020
<font color="#E5E5E5">that you can figure out through memory</font>

975
00:32:47,310 --> 00:32:51,360
you're looking for anomalous event logs

976
00:32:49,020 --> 00:32:53,040
and once you do that you'll know if the

977
00:32:51,360 --> 00:32:55,229
machine is compromised or not it's<font color="#E5E5E5"> not</font>

978
00:32:53,040 --> 00:32:57,240
like pen testing or red teaming which is

979
00:32:55,230 --> 00:32:58,560
kind<font color="#E5E5E5"> of a guest red teaming says we have</font>

980
00:32:57,240 --> 00:33:01,680
these applications they're vulnerable

981
00:32:58,560 --> 00:33:03,240
attackers might get in<font color="#E5E5E5"> this way thread</font>

982
00:33:01,680 --> 00:33:04,980
hunting says attackers are here or

983
00:33:03,240 --> 00:33:07,440
<font color="#CCCCCC">mauers here here's exactly where it is</font>

984
00:33:04,980 --> 00:33:08,970
now you need<font color="#CCCCCC"> to get</font><font color="#E5E5E5"> rid</font><font color="#CCCCCC"> of it</font><font color="#E5E5E5"> so if you</font>

985
00:33:07,440 --> 00:33:10,770
look at<font color="#E5E5E5"> where the real security</font>

986
00:33:08,970 --> 00:33:11,910
conscious companies are<font color="#E5E5E5"> going where</font>

987
00:33:10,770 --> 00:33:13,830
companies that take security very

988
00:33:11,910 --> 00:33:15,990
seriously are going they're doing<font color="#CCCCCC"> this</font>

989
00:33:13,830 --> 00:33:17,820
thread hunting all the time I know

990
00:33:15,990 --> 00:33:19,830
several companies that are on

991
00:33:17,820 --> 00:33:21,030
quarterly schedules for thread hunting

992
00:33:19,830 --> 00:33:22,740
throughout their environment they bring

993
00:33:21,030 --> 00:33:24,629
in third parties there's companies that

994
00:33:22,740 --> 00:33:26,310
have<font color="#CCCCCC"> 24 7 thread hunting teams that</font>

995
00:33:24,630 --> 00:33:28,110
they've hired if you're<font color="#E5E5E5"> not</font><font color="#CCCCCC"> doing this</font>

996
00:33:26,310 --> 00:33:29,639
especially if you're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to have</font>

997
00:33:28,110 --> 00:33:31,649
skilled attackers your environment if

998
00:33:29,640 --> 00:33:33,210
you have any type of nation state level

999
00:33:31,650 --> 00:33:35,040
threat you're going to miss<font color="#CCCCCC"> something</font>

1000
00:33:33,210 --> 00:33:37,410
because the automated tools really<font color="#E5E5E5"> just</font>

1001
00:33:35,040 --> 00:33:39,629
can't keep up<font color="#E5E5E5"> with how sophisticated the</font>

1002
00:33:37,410 --> 00:33:40,980
attackers are if you're<font color="#E5E5E5"> not convinced of</font>

1003
00:33:39,630 --> 00:33:43,020
thread hunting<font color="#E5E5E5"> I have the reference at</font>

1004
00:33:40,980 --> 00:33:44,280
the<font color="#E5E5E5"> end I did a talk at a different</font>

1005
00:33:43,020 --> 00:33:46,139
conference that showed you all the

1006
00:33:44,280 --> 00:33:47,610
information you're going<font color="#E5E5E5"> to miss and all</font>

1007
00:33:46,140 --> 00:33:48,960
the ways will get compromised and never

1008
00:33:47,610 --> 00:33:51,090
find out about it if<font color="#E5E5E5"> you're not doing</font>

1009
00:33:48,960 --> 00:33:53,070
threat hunting so you can watch<font color="#E5E5E5"> that to</font>

1010
00:33:51,090 --> 00:33:54,990
be convinced but after that you're going

1011
00:33:53,070 --> 00:33:57,530
to<font color="#E5E5E5"> follow a very similar flow to what we</font>

1012
00:33:54,990 --> 00:33:57,530
just<font color="#E5E5E5"> talked about</font>

1013
00:34:05,350 --> 00:34:09,250
and then the next<font color="#E5E5E5"> thing we</font><font color="#CCCCCC"> want to do is</font>

1014
00:34:07,450 --> 00:34:11,080
<font color="#E5E5E5">have effective detection and response on</font>

1015
00:34:09,250 --> 00:34:13,510
the network because the endpoints are

1016
00:34:11,080 --> 00:34:15,520
obviously a big part of this story but

1017
00:34:13,510 --> 00:34:17,710
the endpoints don't have everything the

1018
00:34:15,520 --> 00:34:19,300
place<font color="#E5E5E5"> that has the the truth data the</font>

1019
00:34:17,710 --> 00:34:20,918
place that tells you<font color="#E5E5E5"> everywhere the</font>

1020
00:34:19,300 --> 00:34:23,139
attackers went around the network and

1021
00:34:20,918 --> 00:34:25,719
what they did that's<font color="#E5E5E5"> going to come from</font>

1022
00:34:23,139 --> 00:34:27,820
the network<font color="#E5E5E5"> if you have net flow my</font>

1023
00:34:25,719 --> 00:34:29,649
third bullet here you can see every

1024
00:34:27,820 --> 00:34:31,600
machine that an internal machine talk to

1025
00:34:29,649 --> 00:34:32,859
you can say<font color="#CCCCCC"> okay it should talk to</font><font color="#E5E5E5"> this</font>

1026
00:34:31,600 --> 00:34:34,659
machine<font color="#E5E5E5"> it shouldn't talk to this one</font>

1027
00:34:32,859 --> 00:34:36,909
why was it talking<font color="#CCCCCC"> to a certain machine</font>

1028
00:34:34,659 --> 00:34:38,530
you can<font color="#E5E5E5"> then go do forensics on that</font>

1029
00:34:36,909 --> 00:34:40,540
machine i was talking to and this is

1030
00:34:38,530 --> 00:34:41,919
data<font color="#CCCCCC"> that you you can't reconstruct even</font>

1031
00:34:40,540 --> 00:34:43,449
if you have memory forensics even if you

1032
00:34:41,918 --> 00:34:45,190
have dis forensics if you're trying to

1033
00:34:43,449 --> 00:34:47,168
look at<font color="#E5E5E5"> network connections from weeks</font>

1034
00:34:45,190 --> 00:34:48,790
<font color="#E5E5E5">ago or months ago that's not going to</font><font color="#CCCCCC"> be</font>

1035
00:34:47,168 --> 00:34:50,259
on the<font color="#E5E5E5"> endpoint anymore but if you have</font>

1036
00:34:48,790 --> 00:34:52,119
<font color="#E5E5E5">your net flow log you can keep</font><font color="#CCCCCC"> that</font>

1037
00:34:50,260 --> 00:34:53,980
indefinitely and so it's one of the

1038
00:34:52,119 --> 00:34:55,690
<font color="#E5E5E5">first things that when we're doing</font>

1039
00:34:53,980 --> 00:34:57,310
incident response we want to be able to

1040
00:34:55,690 --> 00:34:58,840
say where did<font color="#CCCCCC"> this machine talk on the</font>

1041
00:34:57,310 --> 00:35:00,759
network where did<font color="#E5E5E5"> it make its request to</font>

1042
00:34:58,840 --> 00:35:02,680
and then we can start to<font color="#CCCCCC"> build a pattern</font>

1043
00:35:00,760 --> 00:35:05,080
of how those attackers work and we<font color="#CCCCCC"> can</font>

1044
00:35:02,680 --> 00:35:07,330
start to again focus our investigations

1045
00:35:05,080 --> 00:35:09,100
so that we can scale because we only

1046
00:35:07,330 --> 00:35:11,770
want to investigate a machine deeply if

1047
00:35:09,100 --> 00:35:13,868
we know it was compromised so net flow

1048
00:35:11,770 --> 00:35:15,850
is one we can also work at the protocol

1049
00:35:13,869 --> 00:35:18,700
levels how many<font color="#E5E5E5"> people have</font><font color="#CCCCCC"> heard of</font>

1050
00:35:15,850 --> 00:35:20,049
<font color="#E5E5E5">passive DNS at least a couple how many</font>

1051
00:35:18,700 --> 00:35:23,649
people<font color="#E5E5E5"> implement it that I've heard of</font>

1052
00:35:20,050 --> 00:35:26,250
<font color="#CCCCCC">it only a couple so passive DNS is by</font>

1053
00:35:23,650 --> 00:35:29,260
far the cheapest and most effective

1054
00:35:26,250 --> 00:35:31,090
technology or process you<font color="#CCCCCC"> can do for</font>

1055
00:35:29,260 --> 00:35:34,359
network security and for detection of

1056
00:35:31,090 --> 00:35:36,250
actual threats it's cheap<font color="#E5E5E5"> because it's a</font>

1057
00:35:34,359 --> 00:35:38,799
passive sensor so all you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> is a</font>

1058
00:35:36,250 --> 00:35:40,450
network tap in<font color="#E5E5E5"> its recording data and</font>

1059
00:35:38,800 --> 00:35:42,520
it's<font color="#E5E5E5"> really effective because what it's</font>

1060
00:35:40,450 --> 00:35:44,350
doing is you're not<font color="#E5E5E5"> getting a full pcap</font>

1061
00:35:42,520 --> 00:35:46,359
instead what you're getting are the

1062
00:35:44,350 --> 00:35:49,330
replies in the<font color="#E5E5E5"> requests that go</font><font color="#CCCCCC"> out to a</font>

1063
00:35:46,359 --> 00:35:50,799
<font color="#E5E5E5">DNS server so malware has to look up the</font>

1064
00:35:49,330 --> 00:35:53,109
server that it wants<font color="#CCCCCC"> to contact before</font>

1065
00:35:50,800 --> 00:35:54,970
it can send data the browser has to look

1066
00:35:53,109 --> 00:35:57,340
up the domain name<font color="#E5E5E5"> of a malicious</font>

1067
00:35:54,970 --> 00:35:59,230
website before it can talk to it by

1068
00:35:57,340 --> 00:36:01,060
doing<font color="#E5E5E5"> passive DNS you're recording all</font>

1069
00:35:59,230 --> 00:36:03,010
of<font color="#E5E5E5"> that flow through your environment</font>

1070
00:36:01,060 --> 00:36:04,840
and<font color="#E5E5E5"> this is where for my questions</font>

1071
00:36:03,010 --> 00:36:08,080
earlier you get to a place<font color="#CCCCCC"> where you can</font>

1072
00:36:04,840 --> 00:36:10,450
say ABC 123 calm is bad it's hosting

1073
00:36:08,080 --> 00:36:13,150
malware if any machine talked to<font color="#E5E5E5"> that</font>

1074
00:36:10,450 --> 00:36:15,009
website we know it's compromised well if

1075
00:36:13,150 --> 00:36:17,710
you have these passive DNS records you

1076
00:36:15,010 --> 00:36:18,910
can<font color="#E5E5E5"> then ask you can query that database</font>

1077
00:36:17,710 --> 00:36:20,859
to say which machines

1078
00:36:18,910 --> 00:36:22,720
my environment resolved that domain and

1079
00:36:20,859 --> 00:36:24,520
then again you go from<font color="#E5E5E5"> 10,000 machines</font>

1080
00:36:22,720 --> 00:36:26,680
to the handful that maybe talk to it

1081
00:36:24,520 --> 00:36:29,319
another thing<font color="#CCCCCC"> you can do here is build</font>

1082
00:36:26,680 --> 00:36:31,509
what domains map to over time especially

1083
00:36:29,319 --> 00:36:33,910
when<font color="#E5E5E5"> you're dealing with dynamic dns</font>

1084
00:36:31,510 --> 00:36:35,500
providers you'll have a domain<font color="#CCCCCC"> that has</font>

1085
00:36:33,910 --> 00:36:37,029
a very short time to live it's going to

1086
00:36:35,500 --> 00:36:39,280
change the IP address it points to

1087
00:36:37,030 --> 00:36:40,900
constantly it's not enough to just block

1088
00:36:39,280 --> 00:36:43,390
the IP address<font color="#E5E5E5"> that it's currently at</font>

1089
00:36:40,900 --> 00:36:45,460
when you start<font color="#E5E5E5"> your investigation versus</font>

1090
00:36:43,390 --> 00:36:47,200
if you have passive DNS you'll see every

1091
00:36:45,460 --> 00:36:49,599
IP address that that<font color="#E5E5E5"> hosts results you</font>

1092
00:36:47,200 --> 00:36:50,859
over time and every IP address that it

1093
00:36:49,599 --> 00:36:52,690
results you inside<font color="#CCCCCC"> of your own</font>

1094
00:36:50,859 --> 00:36:54,640
environment so at that point you can

1095
00:36:52,690 --> 00:36:56,559
block all of those IP addresses you<font color="#CCCCCC"> can</font>

1096
00:36:54,640 --> 00:36:58,750
search your<font color="#E5E5E5"> web proxy logs or your net</font>

1097
00:36:56,559 --> 00:37:00,970
flow for access<font color="#CCCCCC"> to all of those IP</font>

1098
00:36:58,750 --> 00:37:02,559
addresses<font color="#E5E5E5"> and then again you have the</font>

1099
00:37:00,970 --> 00:37:04,390
complete picture of what<font color="#E5E5E5"> happened you</font>

1100
00:37:02,559 --> 00:37:06,339
don't<font color="#CCCCCC"> just have a kind</font><font color="#E5E5E5"> of tunnel vision</font>

1101
00:37:04,390 --> 00:37:07,868
about one<font color="#E5E5E5"> infection you have the</font>

1102
00:37:06,339 --> 00:37:10,150
complete picture of what happened<font color="#CCCCCC"> inside</font>

1103
00:37:07,869 --> 00:37:12,760
<font color="#E5E5E5">your entire environment so if you don't</font>

1104
00:37:10,150 --> 00:37:13,750
have passive DNS I mean unless you<font color="#CCCCCC"> just</font>

1105
00:37:12,760 --> 00:37:16,329
haven't heard of it there's really no

1106
00:37:13,750 --> 00:37:18,130
excuse not to do it it's very cheap very

1107
00:37:16,329 --> 00:37:20,109
effective it's one of the<font color="#E5E5E5"> things where</font>

1108
00:37:18,130 --> 00:37:22,150
we can do very very<font color="#E5E5E5"> quick incident</font>

1109
00:37:20,109 --> 00:37:24,190
response if it's there and it's<font color="#E5E5E5"> really</font>

1110
00:37:22,150 --> 00:37:25,779
relied on from every instant response

1111
00:37:24,190 --> 00:37:28,150
person I know at every company that

1112
00:37:25,779 --> 00:37:29,380
<font color="#E5E5E5">works as a consultant I know which one</font>

1113
00:37:28,150 --> 00:37:31,390
of<font color="#E5E5E5"> the first things when people go work</font>

1114
00:37:29,380 --> 00:37:33,400
at a company on<font color="#CCCCCC"> the IR team if they</font>

1115
00:37:31,390 --> 00:37:34,450
<font color="#E5E5E5">don't have passed a DNS they all get it</font>

1116
00:37:33,400 --> 00:37:36,250
<font color="#E5E5E5">worked they all work to get it</font>

1117
00:37:34,450 --> 00:37:38,189
implemented because it makes response

1118
00:37:36,250 --> 00:37:40,660
very very effective if you have it

1119
00:37:38,190 --> 00:37:42,700
another thing that a<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> places will</font>

1120
00:37:40,660 --> 00:37:45,759
record again we don't<font color="#E5E5E5"> want full pcap are</font>

1121
00:37:42,700 --> 00:37:47,200
the HTTP requests and responses so

1122
00:37:45,760 --> 00:37:50,260
obviously if you have an<font color="#CCCCCC"> ssl connection</font>

1123
00:37:47,200 --> 00:37:52,328
<font color="#E5E5E5">so i go to my banking website that's</font>

1124
00:37:50,260 --> 00:37:54,940
<font color="#E5E5E5">going to be caught in passive DNS that</font>

1125
00:37:52,329 --> 00:37:57,160
will you the domain name<font color="#CCCCCC"> of my bank will</font>

1126
00:37:54,940 --> 00:37:59,020
be recorded but unfortunately we're not

1127
00:37:57,160 --> 00:38:01,899
going to break SSL in most cases so that

1128
00:37:59,020 --> 00:38:04,450
<font color="#E5E5E5">won't be recorded out but in the cases</font>

1129
00:38:01,900 --> 00:38:06,609
<font color="#CCCCCC">where it's not SSL a lot of malware does</font>

1130
00:38:04,450 --> 00:38:09,399
not use SSL a lot of websites don't use

1131
00:38:06,609 --> 00:38:11,500
SSL yet if we can record those requests

1132
00:38:09,400 --> 00:38:13,240
and responses we can figure out exactly

1133
00:38:11,500 --> 00:38:14,920
what led<font color="#CCCCCC"> to a machine being compromised</font>

1134
00:38:13,240 --> 00:38:16,959
so we'll see where user<font color="#CCCCCC"> request a</font>

1135
00:38:14,920 --> 00:38:19,420
website will then see a request to a

1136
00:38:16,960 --> 00:38:21,190
malicious advertisement server that

1137
00:38:19,420 --> 00:38:23,740
malicious advertisement server will then

1138
00:38:21,190 --> 00:38:25,839
download<font color="#CCCCCC"> a JavaScript or a flash file</font>

1139
00:38:23,740 --> 00:38:27,609
that exploits the machine none of that

1140
00:38:25,839 --> 00:38:29,680
chaining together would be possible if

1141
00:38:27,609 --> 00:38:31,569
<font color="#CCCCCC">we didn't have these logs but when we</font>

1142
00:38:29,680 --> 00:38:32,379
have these logs we can see exactly how

1143
00:38:31,569 --> 00:38:34,960
that flow goes

1144
00:38:32,380 --> 00:38:36,549
we can then assuming the advertisement

1145
00:38:34,960 --> 00:38:37,990
server was compromised<font color="#CCCCCC"> and it wasn't</font>

1146
00:38:36,549 --> 00:38:39,759
<font color="#E5E5E5">meant to be malicious we can try to get</font>

1147
00:38:37,990 --> 00:38:42,220
that fixed<font color="#E5E5E5"> and then we can also use that</font>

1148
00:38:39,759 --> 00:38:44,079
to search the web proxy logs to see who

1149
00:38:42,220 --> 00:38:46,509
else contacted that domain who else was

1150
00:38:44,079 --> 00:38:48,759
sent through that flow something we see

1151
00:38:46,509 --> 00:38:51,910
very often is a malicious advertisement

1152
00:38:48,759 --> 00:38:53,289
server will have 5 10 or<font color="#E5E5E5"> more servers</font>

1153
00:38:51,910 --> 00:38:55,868
where it's actually hosting the exploit

1154
00:38:53,289 --> 00:38:57,819
so if you look<font color="#E5E5E5"> at that one response or</font>

1155
00:38:55,869 --> 00:38:59,710
the kind of what's on disk on that one

1156
00:38:57,819 --> 00:39:01,420
user's machine and you block<font color="#CCCCCC"> that one</font>

1157
00:38:59,710 --> 00:39:03,279
domain well you've missed the other<font color="#E5E5E5"> nine</font>

1158
00:39:01,420 --> 00:39:05,769
and then your next user comes along and

1159
00:39:03,279 --> 00:39:07,450
gets to<font color="#E5E5E5"> the second IP address or the</font>

1160
00:39:05,769 --> 00:39:09,819
second domain hosting to exploit and

1161
00:39:07,450 --> 00:39:11,259
they get compromised as well versus when

1162
00:39:09,819 --> 00:39:12,849
you have these full records you'll you

1163
00:39:11,259 --> 00:39:14,349
really understand the flow that led<font color="#CCCCCC"> to</font>

1164
00:39:12,849 --> 00:39:16,299
that exploit and you can block it

1165
00:39:14,349 --> 00:39:17,769
correctly because<font color="#E5E5E5"> again we want to be</font>

1166
00:39:16,299 --> 00:39:19,660
scalable and we want to be effective we

1167
00:39:17,769 --> 00:39:23,859
don't want to fix one<font color="#E5E5E5"> infection to</font><font color="#CCCCCC"> 10</font>

1168
00:39:19,660 --> 00:39:25,480
minutes<font color="#E5E5E5"> later have another one and so</font>

1169
00:39:23,859 --> 00:39:27,279
once we have these technologies and

1170
00:39:25,480 --> 00:39:29,500
places we have net flow we're recording

1171
00:39:27,279 --> 00:39:31,990
HTTP requests and replies we have

1172
00:39:29,500 --> 00:39:33,549
passive DNS implemented detection

1173
00:39:31,990 --> 00:39:35,470
becomes pretty interesting we can

1174
00:39:33,549 --> 00:39:36,819
obviously apply thread<font color="#CCCCCC"> in two thousand</font>

1175
00:39:35,470 --> 00:39:38,618
<font color="#E5E5E5">thread intelligence to it we can look</font>

1176
00:39:36,819 --> 00:39:41,680
for bad domains being resolved we can

1177
00:39:38,619 --> 00:39:43,660
look for IP addresses coming back on the

1178
00:39:41,680 --> 00:39:46,269
<font color="#CCCCCC">resolution of a name but there's also a</font>

1179
00:39:43,660 --> 00:39:47,980
lot<font color="#CCCCCC"> of analysis we can</font><font color="#E5E5E5"> do ourselves I</font>

1180
00:39:46,269 --> 00:39:50,799
have the two most powerful ones here

1181
00:39:47,980 --> 00:39:52,390
once you get passive DNS going I would

1182
00:39:50,799 --> 00:39:54,700
want to know every time<font color="#E5E5E5"> a newly</font>

1183
00:39:52,390 --> 00:39:55,960
registered domain as result because if

1184
00:39:54,700 --> 00:39:58,450
you're a legitimate<font color="#CCCCCC"> company you don't</font>

1185
00:39:55,960 --> 00:40:00,640
register your LLC<font color="#CCCCCC"> and your</font><font color="#E5E5E5"> website and</font>

1186
00:39:58,450 --> 00:40:01,990
go public all in<font color="#E5E5E5"> the same day versus if</font>

1187
00:40:00,640 --> 00:40:04,029
you're a malware author you're going to

1188
00:40:01,990 --> 00:40:05,680
register 100 domains at once because

1189
00:40:04,029 --> 00:40:07,930
your previous hundred are now blocked

1190
00:40:05,680 --> 00:40:09,339
going to register 100 at once you're

1191
00:40:07,930 --> 00:40:11,200
then going to push your malware out to

1192
00:40:09,339 --> 00:40:13,420
it and then the employees of<font color="#CCCCCC"> the company</font>

1193
00:40:11,200 --> 00:40:15,879
that<font color="#CCCCCC"> you're trying to</font><font color="#E5E5E5"> protect everyone</font>

1194
00:40:13,420 --> 00:40:17,319
in<font color="#E5E5E5"> the room they're going to resolve a</font>

1195
00:40:15,880 --> 00:40:18,789
domain<font color="#CCCCCC"> that was registered five minutes</font>

1196
00:40:17,319 --> 00:40:21,038
ago or an hour<font color="#CCCCCC"> ago that just really</font>

1197
00:40:18,789 --> 00:40:22,990
<font color="#CCCCCC">doesn't happen with legitimate companies</font>

1198
00:40:21,039 --> 00:40:25,480
so this<font color="#E5E5E5"> is something by having passive</font>

1199
00:40:22,990 --> 00:40:27,430
DNS that you can query for you can also

1200
00:40:25,480 --> 00:40:29,589
look for resolution of dynamic dns

1201
00:40:27,430 --> 00:40:31,509
providers these are basically malware

1202
00:40:29,589 --> 00:40:33,759
hosting farms<font color="#E5E5E5"> I don't know what else</font><font color="#CCCCCC"> to</font>

1203
00:40:31,509 --> 00:40:36,009
call them use very high up very

1204
00:40:33,759 --> 00:40:38,019
frequently by malware and so we want to

1205
00:40:36,009 --> 00:40:40,089
<font color="#E5E5E5">know anytime there's a domain that's</font>

1206
00:40:38,019 --> 00:40:41,859
result off of one of those providers and

1207
00:40:40,089 --> 00:40:45,250
this will lead you<font color="#CCCCCC"> to a lot of malware</font>

1208
00:40:41,859 --> 00:40:46,380
it will lead you to<font color="#CCCCCC"> a lot of very fishy</font>

1209
00:40:45,250 --> 00:40:48,780
behavior if it's

1210
00:40:46,380 --> 00:40:50,250
actually malware itself you'll see users

1211
00:40:48,780 --> 00:40:51,690
going to domains they probably shouldn't

1212
00:40:50,250 --> 00:40:53,010
you'll see where malicious

1213
00:40:51,690 --> 00:40:54,990
advertisements are loading on your

1214
00:40:53,010 --> 00:40:56,430
<font color="#E5E5E5">network there's a lot you can glean just</font>

1215
00:40:54,990 --> 00:40:58,080
from these two queries and obviously

1216
00:40:56,430 --> 00:41:00,870
there's a lot<font color="#CCCCCC"> more you can</font><font color="#E5E5E5"> do as well on</font>

1217
00:40:58,080 --> 00:41:03,330
the HTTP side one thing we run a lot is

1218
00:41:00,870 --> 00:41:05,190
looking for unusual user agents so now

1219
00:41:03,330 --> 00:41:07,170
we're will have they'll try to look like

1220
00:41:05,190 --> 00:41:08,910
<font color="#E5E5E5">Internet Explorer Firefox but they'll</font>

1221
00:41:07,170 --> 00:41:10,320
have very they'll have hard-coded user

1222
00:41:08,910 --> 00:41:12,629
agents so that's one<font color="#CCCCCC"> way we can find</font>

1223
00:41:10,320 --> 00:41:14,160
<font color="#CCCCCC">them you'll also see malware that puts</font>

1224
00:41:12,630 --> 00:41:16,170
like the name of the malware in the user

1225
00:41:14,160 --> 00:41:18,420
agent which is a huge red flag that<font color="#CCCCCC"> it's</font>

1226
00:41:16,170 --> 00:41:21,270
not something normal so those are going

1227
00:41:18,420 --> 00:41:22,800
to filter directly out as well and then

1228
00:41:21,270 --> 00:41:24,720
we<font color="#E5E5E5"> also look for file downloads it's</font>

1229
00:41:22,800 --> 00:41:26,340
very easy to look for file extensions to

1230
00:41:24,720 --> 00:41:28,220
look through the responses to see when

1231
00:41:26,340 --> 00:41:30,510
certain file types are being downloaded

1232
00:41:28,220 --> 00:41:33,180
you'd be surprised how many people will

1233
00:41:30,510 --> 00:41:34,740
still download a dot exe file and then

1234
00:41:33,180 --> 00:41:36,750
<font color="#E5E5E5">double-click it because some email told</font>

1235
00:41:34,740 --> 00:41:38,700
them to and so we can find<font color="#E5E5E5"> that very</font>

1236
00:41:36,750 --> 00:41:41,190
very<font color="#E5E5E5"> quickly by going through the HTTP</font>

1237
00:41:38,700 --> 00:41:44,220
data then I mentioned<font color="#E5E5E5"> before with with</font>

1238
00:41:41,190 --> 00:41:45,900
net flow this<font color="#E5E5E5"> is going to save us in</font>

1239
00:41:44,220 --> 00:41:47,129
<font color="#E5E5E5">many cases especially when the attackers</font>

1240
00:41:45,900 --> 00:41:49,830
are moving laterally when they're

1241
00:41:47,130 --> 00:41:51,150
bouncing between systems it's just I'm

1242
00:41:49,830 --> 00:41:53,400
going to call it impossible in large

1243
00:41:51,150 --> 00:41:54,780
networks to to<font color="#E5E5E5"> really have a good</font><font color="#CCCCCC"> idea</font>

1244
00:41:53,400 --> 00:41:56,370
<font color="#E5E5E5">of everywhere they went if you don't</font>

1245
00:41:54,780 --> 00:42:06,900
<font color="#E5E5E5">have that network flow that you can</font>

1246
00:41:56,370 --> 00:42:08,460
track around yeah<font color="#E5E5E5"> I was just using like</font>

1247
00:42:06,900 --> 00:42:10,020
a general<font color="#E5E5E5"> term as long as you get</font><font color="#CCCCCC"> the</font>

1248
00:42:08,460 --> 00:42:16,440
same data back i don't really doesn't

1249
00:42:10,020 --> 00:42:21,570
matter how you get it no just use it as

1250
00:42:16,440 --> 00:42:23,130
<font color="#E5E5E5">just use it as like a general term so</font>

1251
00:42:21,570 --> 00:42:24,390
once we have those detection

1252
00:42:23,130 --> 00:42:26,700
capabilities once we have all that

1253
00:42:24,390 --> 00:42:29,910
monitoring and logging in place our

1254
00:42:26,700 --> 00:42:32,430
response becomes pretty simple so Bob

1255
00:42:29,910 --> 00:42:36,149
again gets his machine infected it was

1256
00:42:32,430 --> 00:42:37,500
infected<font color="#E5E5E5"> with malware from ABC XYZ we</font>

1257
00:42:36,150 --> 00:42:39,150
know we have<font color="#CCCCCC"> to investigate</font><font color="#E5E5E5"> Bob's</font>

1258
00:42:37,500 --> 00:42:40,860
machine we know we have<font color="#CCCCCC"> to look</font><font color="#E5E5E5"> at his</font>

1259
00:42:39,150 --> 00:42:42,840
account see where it logged into and so

1260
00:42:40,860 --> 00:42:45,510
on but what<font color="#E5E5E5"> about everyone else on the</font>

1261
00:42:42,840 --> 00:42:46,800
network was this how did Bob get there

1262
00:42:45,510 --> 00:42:48,660
was just targeted to our environment

1263
00:42:46,800 --> 00:42:50,370
that Bob send the link to anyone else

1264
00:42:48,660 --> 00:42:51,960
not knowing what he<font color="#CCCCCC"> was doing how do</font><font color="#E5E5E5"> we</font>

1265
00:42:50,370 --> 00:42:54,060
figure out<font color="#E5E5E5"> where this infection spread</font>

1266
00:42:51,960 --> 00:42:55,500
well we want to<font color="#E5E5E5"> know which other systems</font>

1267
00:42:54,060 --> 00:42:58,350
resolve the domain we can do that

1268
00:42:55,500 --> 00:42:59,890
<font color="#CCCCCC">because we</font><font color="#E5E5E5"> have passive DNS we want to</font>

1269
00:42:58,350 --> 00:43:02,410
know the IP addresses at this

1270
00:42:59,890 --> 00:43:04,720
result you so again passive DNS will

1271
00:43:02,410 --> 00:43:07,029
answer that<font color="#E5E5E5"> for us we have the HTTP logs</font>

1272
00:43:04,720 --> 00:43:08,379
to know not<font color="#E5E5E5"> only did someone resolve the</font>

1273
00:43:07,029 --> 00:43:09,880
domain but did they actually<font color="#E5E5E5"> make the</font>

1274
00:43:08,380 --> 00:43:12,069
request and get the response back from

1275
00:43:09,880 --> 00:43:13,900
the server and then as we saw in<font color="#CCCCCC"> the</font>

1276
00:43:12,069 --> 00:43:15,700
<font color="#E5E5E5">last slide Bob keeps getting his machine</font>

1277
00:43:13,900 --> 00:43:17,829
infected so we want<font color="#E5E5E5"> to know where else</font>

1278
00:43:15,700 --> 00:43:19,960
did Bob talk to what other internal

1279
00:43:17,829 --> 00:43:22,000
internal resources that's lateral

1280
00:43:19,960 --> 00:43:23,950
movement by the attackers and also

1281
00:43:22,000 --> 00:43:26,079
external resources did<font color="#E5E5E5"> the attackers get</font>

1282
00:43:23,950 --> 00:43:27,460
on Bob's machine and start exfiltrating

1283
00:43:26,079 --> 00:43:29,589
data so we want<font color="#E5E5E5"> to see where those</font>

1284
00:43:27,460 --> 00:43:32,680
outbound connections went we can do all

1285
00:43:29,589 --> 00:43:34,690
of this pretty easily at least the

1286
00:43:32,680 --> 00:43:36,640
response might be<font color="#E5E5E5"> hard and difficult but</font>

1287
00:43:34,690 --> 00:43:38,440
getting the initial data to answer some

1288
00:43:36,640 --> 00:43:39,940
of these questions is just<font color="#CCCCCC"> a query in</font>

1289
00:43:38,440 --> 00:43:43,299
the database that's storing everything

1290
00:43:39,940 --> 00:43:45,400
that we've logged and then when<font color="#E5E5E5"> we look</font>

1291
00:43:43,299 --> 00:43:46,990
<font color="#E5E5E5">at thread hunting on the network it's</font>

1292
00:43:45,400 --> 00:43:48,640
pretty straightforward once you have all

1293
00:43:46,990 --> 00:43:50,859
the data there you can take those

1294
00:43:48,640 --> 00:43:53,170
detection stages and do them proactively

1295
00:43:50,859 --> 00:43:55,119
you can run queries you can script out

1296
00:43:53,170 --> 00:43:56,769
custom queries you can look at recent

1297
00:43:55,119 --> 00:43:59,230
data that's gone through the environment

1298
00:43:56,769 --> 00:44:00,549
you<font color="#CCCCCC"> can do a manual review of historical</font>

1299
00:43:59,230 --> 00:44:02,589
data so if you're worried about a

1300
00:44:00,549 --> 00:44:04,359
particular user<font color="#E5E5E5"> or particular servers</font>

1301
00:44:02,589 --> 00:44:06,640
that you have you<font color="#CCCCCC"> have all of this great</font>

1302
00:44:04,359 --> 00:44:08,980
network data available to to leverage

1303
00:44:06,640 --> 00:44:10,930
and then I put<font color="#CCCCCC"> some examples here of</font>

1304
00:44:08,980 --> 00:44:13,119
where statistical analysis becomes

1305
00:44:10,930 --> 00:44:15,759
really powerful<font color="#E5E5E5"> and so if you say you</font>

1306
00:44:13,119 --> 00:44:17,440
have 5,000 10,000<font color="#E5E5E5"> employees what were</font>

1307
00:44:15,759 --> 00:44:19,210
the domains that were resolved by less

1308
00:44:17,440 --> 00:44:21,789
than 100 of those people less than 50 of

1309
00:44:19,210 --> 00:44:23,859
those people if you have the list<font color="#E5E5E5"> of IP</font>

1310
00:44:21,789 --> 00:44:26,049
addresses that they spoke to<font color="#E5E5E5"> why out of</font>

1311
00:44:23,859 --> 00:44:28,839
your entire environment did one employee

1312
00:44:26,049 --> 00:44:30,700
<font color="#CCCCCC">talk to this one IP address and when you</font>

1313
00:44:28,839 --> 00:44:32,740
start to do those types of analysis you

1314
00:44:30,700 --> 00:44:34,808
find things<font color="#E5E5E5"> that manually reviewing logs</font>

1315
00:44:32,740 --> 00:44:37,240
you would kind of be lost in the noise

1316
00:44:34,809 --> 00:44:39,339
you wouldn't have this this context

1317
00:44:37,240 --> 00:44:41,258
about<font color="#E5E5E5"> it and it's something that again</font>

1318
00:44:39,339 --> 00:44:43,538
if you're the if your environment or

1319
00:44:41,259 --> 00:44:44,980
your employee is the first one<font color="#CCCCCC"> to get a</font>

1320
00:44:43,539 --> 00:44:46,569
piece of malware or your employee the

1321
00:44:44,980 --> 00:44:48,579
one is the one that's targeted there's

1322
00:44:46,569 --> 00:44:51,220
no threat Intel that's going to save you

1323
00:44:48,579 --> 00:44:53,019
because the vendors that provide that

1324
00:44:51,220 --> 00:44:55,269
won't have seen it before<font color="#CCCCCC"> but this type</font>

1325
00:44:53,019 --> 00:44:57,250
of analysis can really make these these

1326
00:44:55,269 --> 00:44:58,720
oddities in these outliers stand out and

1327
00:44:57,250 --> 00:45:02,799
that's<font color="#CCCCCC"> what</font><font color="#E5E5E5"> you want to focus your</font>

1328
00:44:58,720 --> 00:45:04,118
threat hunting so<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> going to assume</font>

1329
00:45:02,799 --> 00:45:06,099
you've implemented everything I<font color="#CCCCCC"> just</font>

1330
00:45:04,119 --> 00:45:08,230
talked about<font color="#E5E5E5"> on all these slides so at</font>

1331
00:45:06,099 --> 00:45:10,720
<font color="#E5E5E5">this point we can do effective detection</font>

1332
00:45:08,230 --> 00:45:12,640
and response we have full visibility on

1333
00:45:10,720 --> 00:45:14,348
our end points and the network we have

1334
00:45:12,640 --> 00:45:17,170
all the historical data we want we have

1335
00:45:14,349 --> 00:45:18,759
event logs we have AV logs other things

1336
00:45:17,170 --> 00:45:21,039
I didn't<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about that that run on the</font>

1337
00:45:18,759 --> 00:45:22,960
<font color="#E5E5E5">endpoint we also have plenty of network</font>

1338
00:45:21,039 --> 00:45:24,849
data that's captured in a historical

1339
00:45:22,960 --> 00:45:26,259
fashion and then when a<font color="#CCCCCC"> machine is</font>

1340
00:45:24,849 --> 00:45:28,059
compromised or we want to do threat

1341
00:45:26,259 --> 00:45:30,549
hunting and see is there any malware on

1342
00:45:28,059 --> 00:45:32,920
the machine we have proper acquisition

1343
00:45:30,549 --> 00:45:35,170
procedures and analysis processes to do

1344
00:45:32,920 --> 00:45:37,089
that we can pull memory from a<font color="#E5E5E5"> machine</font>

1345
00:45:35,170 --> 00:45:38,950
that's going to defeat the anti

1346
00:45:37,089 --> 00:45:40,839
forensics it's going to tell us not only

1347
00:45:38,950 --> 00:45:42,578
<font color="#E5E5E5">about malware on disk but also about</font>

1348
00:45:40,839 --> 00:45:45,400
malware in memory and we're certainly

1349
00:45:42,579 --> 00:45:47,049
<font color="#E5E5E5">going to find even the most advanced</font>

1350
00:45:45,400 --> 00:45:53,259
attackers that we see out there in the

1351
00:45:47,049 --> 00:45:55,150
wild and so the results of this are our

1352
00:45:53,259 --> 00:45:56,349
threat detection actually finds threats

1353
00:45:55,150 --> 00:45:57,549
we're not just running a bunch<font color="#E5E5E5"> of</font>

1354
00:45:56,349 --> 00:46:00,400
sensors and have a bunch<font color="#CCCCCC"> of agents</font>

1355
00:45:57,549 --> 00:46:02,049
installed not<font color="#E5E5E5"> doing much so by doing</font>

1356
00:46:00,400 --> 00:46:04,359
this we're<font color="#E5E5E5"> going to find the actual</font>

1357
00:46:02,049 --> 00:46:06,069
threats in our environment once it's

1358
00:46:04,359 --> 00:46:07,480
detected it's not where everyone's

1359
00:46:06,069 --> 00:46:09,460
wondering what to do we have very

1360
00:46:07,480 --> 00:46:11,140
actionable data that we can query we

1361
00:46:09,460 --> 00:46:13,569
have<font color="#E5E5E5"> timeline data so we can see the</font>

1362
00:46:11,140 --> 00:46:15,400
events as they happen in order we have

1363
00:46:13,569 --> 00:46:17,349
the ability to<font color="#E5E5E5"> do deep memory forensics</font>

1364
00:46:15,400 --> 00:46:19,329
we can pull that malware out of memory

1365
00:46:17,349 --> 00:46:21,460
even<font color="#E5E5E5"> if it wasn't written to disk we can</font>

1366
00:46:19,329 --> 00:46:22,809
build indicators for it we can sweep

1367
00:46:21,460 --> 00:46:25,660
across<font color="#CCCCCC"> the network looking for those</font>

1368
00:46:22,809 --> 00:46:27,519
indicators and again the response it's

1369
00:46:25,660 --> 00:46:29,230
not instant it's not it's still<font color="#E5E5E5"> not easy</font>

1370
00:46:27,519 --> 00:46:31,000
you<font color="#E5E5E5"> need some skilled people doing it</font>

1371
00:46:29,230 --> 00:46:32,950
but it's possible at this point and

1372
00:46:31,000 --> 00:46:34,329
<font color="#E5E5E5">we're not going to do response and</font>

1373
00:46:32,950 --> 00:46:36,189
containment and then a couple days later

1374
00:46:34,329 --> 00:46:38,230
the malware's back where the attackers

1375
00:46:36,190 --> 00:46:39,430
are back because we<font color="#E5E5E5"> missed something and</font>

1376
00:46:38,230 --> 00:46:43,059
that's one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the goals that we want to</font>

1377
00:46:39,430 --> 00:46:44,440
have so some<font color="#CCCCCC"> of the tools that are</font>

1378
00:46:43,059 --> 00:46:46,720
commonly used<font color="#E5E5E5"> for this these are all</font>

1379
00:46:44,440 --> 00:46:49,269
open source tools you can go download

1380
00:46:46,720 --> 00:46:50,740
them for log aggregation this tool

1381
00:46:49,269 --> 00:46:53,319
called great log is pretty cool it's

1382
00:46:50,740 --> 00:46:55,598
<font color="#E5E5E5">it's not</font><font color="#CCCCCC"> ten years old or anything</font><font color="#E5E5E5"> it's</font>

1383
00:46:53,319 --> 00:46:57,130
kind of new but it's really<font color="#E5E5E5"> nice so all</font>

1384
00:46:55,599 --> 00:46:58,630
your logs in there has a very queryable

1385
00:46:57,130 --> 00:47:00,759
interface it understands some of the

1386
00:46:58,630 --> 00:47:02,650
protocols by default for memory

1387
00:47:00,759 --> 00:47:04,299
forensics there's volatility as I<font color="#CCCCCC"> said</font>

1388
00:47:02,650 --> 00:47:07,509
this is used by thousands of

1389
00:47:04,299 --> 00:47:09,369
investigators around the world very very

1390
00:47:07,509 --> 00:47:11,680
<font color="#E5E5E5">powerful platform for memory forensics</font>

1391
00:47:09,369 --> 00:47:13,809
across Windows Linux Mac Android and so

1392
00:47:11,680 --> 00:47:15,460
on<font color="#CCCCCC"> for</font><font color="#E5E5E5"> network capture I'm not going</font><font color="#CCCCCC"> to</font>

1393
00:47:13,809 --> 00:47:17,410
start like a religious war but<font color="#CCCCCC"> Braugher</font>

1394
00:47:15,460 --> 00:47:19,000
<font color="#E5E5E5">suricata will meet your needs some</font>

1395
00:47:17,410 --> 00:47:20,859
people are very<font color="#E5E5E5"> particular to the one</font>

1396
00:47:19,000 --> 00:47:22,480
they like check out the one you like and

1397
00:47:20,859 --> 00:47:24,430
see what<font color="#E5E5E5"> works in your environment and</font>

1398
00:47:22,480 --> 00:47:25,609
then you also<font color="#E5E5E5"> have the elk stack which</font>

1399
00:47:24,430 --> 00:47:27,649
if you do

1400
00:47:25,609 --> 00:47:29,390
any type of forensics or<font color="#E5E5E5"> IR and you</font>

1401
00:47:27,650 --> 00:47:31,460
haven't<font color="#E5E5E5"> seen the elk stack this blog</font>

1402
00:47:29,390 --> 00:47:33,410
post here is really good there's all

1403
00:47:31,460 --> 00:47:35,180
sorts of videos about it online it's a

1404
00:47:33,410 --> 00:47:37,848
very powerful<font color="#E5E5E5"> way to get all of your</font>

1405
00:47:35,180 --> 00:47:38,899
data together filter out and query just

1406
00:47:37,849 --> 00:47:49,430
what you want and then have it

1407
00:47:38,900 --> 00:47:51,499
visualized in a nice way no no so these

1408
00:47:49,430 --> 00:47:53,239
are these are the tools that we normally

1409
00:47:51,499 --> 00:47:54,828
<font color="#CCCCCC">see for these type of operations these</font>

1410
00:47:53,239 --> 00:47:56,839
are the tools we've seen<font color="#E5E5E5"> used at scale</font>

1411
00:47:54,829 --> 00:47:59,480
it will definitely<font color="#CCCCCC"> work in any</font>

1412
00:47:56,839 --> 00:48:05,089
reasonable network environment that you

1413
00:47:59,480 --> 00:48:07,670
might need to<font color="#E5E5E5"> defend so is the end of my</font>

1414
00:48:05,089 --> 00:48:09,799
<font color="#E5E5E5">slides i think i</font><font color="#CCCCCC"> have like nine ten</font>

1415
00:48:07,670 --> 00:48:12,259
minutes<font color="#E5E5E5"> left okay so are there any</font>

1416
00:48:09,799 --> 00:48:13,849
questions<font color="#E5E5E5"> or comments yeah one</font><font color="#CCCCCC"> thing if</font>

1417
00:48:12,259 --> 00:48:15,859
you notice in the slides<font color="#E5E5E5"> I had places</font>

1418
00:48:13,849 --> 00:48:17,869
with like a number in brackets that was

1419
00:48:15,859 --> 00:48:20,150
<font color="#E5E5E5">referring to these links so rather than</font>

1420
00:48:17,869 --> 00:48:23,930
fill the slides with links always just

1421
00:48:20,150 --> 00:48:29,109
put<font color="#E5E5E5"> him at</font><font color="#CCCCCC"> the end but but otherwise are</font>

1422
00:48:23,930 --> 00:48:29,109
there any<font color="#E5E5E5"> questions or comments</font><font color="#CCCCCC"> okay</font>

1423
00:48:35,569 --> 00:48:40,430
so question would be when you go on

1424
00:48:38,900 --> 00:48:42,680
these engagements as an alternative

1425
00:48:40,430 --> 00:48:46,098
passive DNS how many companies do<font color="#E5E5E5"> you</font>

1426
00:48:42,680 --> 00:48:48,078
find actually logging like using their

1427
00:48:46,099 --> 00:48:49,519
dns server to actually log stuff<font color="#CCCCCC"> i know</font>

1428
00:48:48,079 --> 00:48:51,279
in my experience I've always gotten

1429
00:48:49,519 --> 00:48:53,808
pushback about performance performance

1430
00:48:51,279 --> 00:48:55,940
in the<font color="#CCCCCC"> Windows environment it's it's</font>

1431
00:48:53,809 --> 00:48:57,410
pretty flexible even on like what side

1432
00:48:55,940 --> 00:48:59,569
of the request you actually want to<font color="#E5E5E5"> log</font>

1433
00:48:57,410 --> 00:49:01,160
but I mean I agree the Pasadena's that

1434
00:48:59,569 --> 00:49:04,009
was<font color="#E5E5E5"> the route we went ultimately because</font>

1435
00:49:01,160 --> 00:49:06,859
put a tap in and admins can shut<font color="#CCCCCC"> up but</font>

1436
00:49:04,009 --> 00:49:08,959
yes it was so putting the tap ins a lot

1437
00:49:06,859 --> 00:49:11,390
less intrusive I'm not fully sure of

1438
00:49:08,959 --> 00:49:12,828
everything windows will log I don't know

1439
00:49:11,390 --> 00:49:14,749
if you<font color="#E5E5E5"> can get like the optional records</font>

1440
00:49:12,829 --> 00:49:16,369
or how deep the logging is with passive

1441
00:49:14,749 --> 00:49:19,549
DNS you can obviously<font color="#E5E5E5"> get the entire</font>

1442
00:49:16,369 --> 00:49:21,199
protocol the other thing<font color="#CCCCCC"> is many</font>

1443
00:49:19,549 --> 00:49:23,029
networks we go in<font color="#E5E5E5"> and</font><font color="#CCCCCC"> fortunately</font><font color="#E5E5E5"> don't</font>

1444
00:49:21,199 --> 00:49:24,410
they have their internal dns server but

1445
00:49:23,029 --> 00:49:26,479
they don't<font color="#CCCCCC"> actually block external dns</font>

1446
00:49:24,410 --> 00:49:28,729
and<font color="#E5E5E5"> so you'll miss</font><font color="#CCCCCC"> that if you're on the</font>

1447
00:49:26,479 --> 00:49:30,529
microsoft server versus the sensor<font color="#CCCCCC"> we'll</font>

1448
00:49:28,729 --> 00:49:32,390
just see hey this is dns i'm going to

1449
00:49:30,529 --> 00:49:36,609
log it so you definitely seen those

1450
00:49:32,390 --> 00:49:36,609
those issues as well<font color="#CCCCCC"> the gadget thanks</font>

1451
00:49:40,890 --> 00:49:46,290
any other questions either so we make

1452
00:49:44,670 --> 00:49:48,810
use of a<font color="#E5E5E5"> solution where we're able to do</font>

1453
00:49:46,290 --> 00:49:50,940
full memory dumps<font color="#E5E5E5"> and so forth from any</font>

1454
00:49:48,810 --> 00:49:52,980
workstation in our<font color="#CCCCCC"> environment one of</font>

1455
00:49:50,940 --> 00:49:54,480
the<font color="#E5E5E5"> questions I have for you is</font><font color="#CCCCCC"> that if</font>

1456
00:49:52,980 --> 00:49:56,220
you got an agent that's already set up

1457
00:49:54,480 --> 00:49:58,290
so<font color="#E5E5E5"> you can pull a memory dump right over</font>

1458
00:49:56,220 --> 00:49:59,669
the network<font color="#CCCCCC"> at any</font><font color="#E5E5E5"> given time do you</font>

1459
00:49:58,290 --> 00:50:01,590
still feel like there's an actual chance

1460
00:49:59,670 --> 00:50:03,240
<font color="#CCCCCC">that information</font><font color="#E5E5E5"> that's within the dump</font>

1461
00:50:01,590 --> 00:50:05,070
itself may actually be filtered out

1462
00:50:03,240 --> 00:50:07,470
before it makes it to whatever<font color="#E5E5E5"> you're</font>

1463
00:50:05,070 --> 00:50:09,540
<font color="#E5E5E5">using</font><font color="#CCCCCC"> um it depends</font><font color="#E5E5E5"> how that how that</font>

1464
00:50:07,470 --> 00:50:11,580
acquisition tool works so there's some

1465
00:50:09,540 --> 00:50:14,040
it really depends<font color="#CCCCCC"> there</font><font color="#E5E5E5"> some tools that</font>

1466
00:50:11,580 --> 00:50:15,360
try<font color="#E5E5E5"> to hook certain methods so there's</font>

1467
00:50:14,040 --> 00:50:17,820
malware for instance<font color="#E5E5E5"> like if you</font>

1468
00:50:15,360 --> 00:50:19,230
hibernate say a laptop that's going to

1469
00:50:17,820 --> 00:50:20,850
notify all the processes that<font color="#E5E5E5"> the</font>

1470
00:50:19,230 --> 00:50:22,560
<font color="#CCCCCC">machines</font><font color="#E5E5E5"> Harbor nating and then malware</font>

1471
00:50:20,850 --> 00:50:24,180
will scrub a telephoto memory we've seen

1472
00:50:22,560 --> 00:50:26,640
other malware we've only seen proof of

1473
00:50:24,180 --> 00:50:27,930
concept malware try to hook their ranges

1474
00:50:26,640 --> 00:50:30,150
like we r memory is it's a tool called

1475
00:50:27,930 --> 00:50:33,089
dementia it's like an<font color="#CCCCCC"> open-source anti</font>

1476
00:50:30,150 --> 00:50:34,260
forensics tool those tools are<font color="#CCCCCC"> they're</font>

1477
00:50:33,090 --> 00:50:35,850
interesting from<font color="#E5E5E5"> like a research</font>

1478
00:50:34,260 --> 00:50:37,740
perspective but when you use them in<font color="#E5E5E5"> the</font>

1479
00:50:35,850 --> 00:50:40,049
wild<font color="#E5E5E5"> so they'll say like I hit a process</font>

1480
00:50:37,740 --> 00:50:41,640
I was running but in in order to hide

1481
00:50:40,050 --> 00:50:43,200
that process they had to start a service

1482
00:50:41,640 --> 00:50:44,790
which loaded a kernel driver which left

1483
00:50:43,200 --> 00:50:46,109
all these other artifacts in memory<font color="#E5E5E5"> so</font>

1484
00:50:44,790 --> 00:50:48,420
they<font color="#E5E5E5"> might hide the fact that this one</font>

1485
00:50:46,110 --> 00:50:50,220
process was there<font color="#E5E5E5"> initially but you're</font>

1486
00:50:48,420 --> 00:50:52,590
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to find the anti forensics tool</font>

1487
00:50:50,220 --> 00:50:53,730
and then if you deeply if you deeply no

1488
00:50:52,590 --> 00:50:55,290
memory forensics you're just going to go

1489
00:50:53,730 --> 00:50:56,370
find whatever they were trying to<font color="#E5E5E5"> screw</font>

1490
00:50:55,290 --> 00:50:58,529
up anyway they're probably be some

1491
00:50:56,370 --> 00:51:00,210
artifacts around so dementia was<font color="#E5E5E5"> the</font>

1492
00:50:58,530 --> 00:51:02,910
most thorough I've ever seen whether

1493
00:51:00,210 --> 00:51:04,170
real cases<font color="#E5E5E5"> open source whatever but even</font>

1494
00:51:02,910 --> 00:51:05,339
it had a loaded<font color="#E5E5E5"> driver and everything</font>

1495
00:51:04,170 --> 00:51:07,670
else so<font color="#CCCCCC"> you could still find</font><font color="#E5E5E5"> it in</font>

1496
00:51:05,340 --> 00:51:07,670
<font color="#E5E5E5">memory</font>

1497
00:51:14,110 --> 00:51:18,920
given the<font color="#CCCCCC"> amount of cheap and</font><font color="#E5E5E5"> free</font>

1498
00:51:16,790 --> 00:51:21,080
certificates available there to threat

1499
00:51:18,920 --> 00:51:24,380
actors do you recommend that businesses

1500
00:51:21,080 --> 00:51:26,330
implement SSL decryption it's<font color="#E5E5E5"> definitely</font>

1501
00:51:24,380 --> 00:51:28,160
helpful you'll you'll hit some

1502
00:51:26,330 --> 00:51:30,259
scalability issues with how<font color="#CCCCCC"> fast they</font>

1503
00:51:28,160 --> 00:51:32,029
can decrypt and everything and you can

1504
00:51:30,260 --> 00:51:34,190
also have applications not use it<font color="#E5E5E5"> like</font>

1505
00:51:32,030 --> 00:51:35,690
there's malware that just you know like

1506
00:51:34,190 --> 00:51:36,740
you need that you<font color="#E5E5E5"> need that there you</font>

1507
00:51:35,690 --> 00:51:37,760
<font color="#E5E5E5">need their certificate right basically</font>

1508
00:51:36,740 --> 00:51:39,830
<font color="#E5E5E5">so you're gonna have to block traffic</font>

1509
00:51:37,760 --> 00:51:42,020
based on not being able to<font color="#E5E5E5"> decrypt it</font>

1510
00:51:39,830 --> 00:51:43,450
where most people will just kind of fail

1511
00:51:42,020 --> 00:51:46,490
through and let the traffic pass through

1512
00:51:43,450 --> 00:51:47,750
so it's nice<font color="#E5E5E5"> but you're in most cases</font>

1513
00:51:46,490 --> 00:51:51,080
you're going to end up catching your

1514
00:51:47,750 --> 00:51:52,790
employees traffic which which can be

1515
00:51:51,080 --> 00:51:54,080
valuable<font color="#E5E5E5"> versus the malware can kind of</font>

1516
00:51:52,790 --> 00:51:56,440
work around<font color="#E5E5E5"> it anyway from what i've</font>

1517
00:51:54,080 --> 00:51:56,440
seen so

