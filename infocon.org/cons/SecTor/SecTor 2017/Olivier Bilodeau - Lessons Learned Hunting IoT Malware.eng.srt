1
00:00:02,659 --> 00:00:09,030
hello everyone let's last session of<font color="#E5E5E5"> the</font>

2
00:00:06,120 --> 00:00:10,949
<font color="#CCCCCC">day last session</font><font color="#E5E5E5"> of sector so I hope</font>

3
00:00:09,030 --> 00:00:13,110
you'll<font color="#E5E5E5"> find this enjoyable</font><font color="#CCCCCC"> and you'll</font>

4
00:00:10,949 --> 00:00:16,289
learn something<font color="#CCCCCC"> and you'll have the</font>

5
00:00:13,110 --> 00:00:19,590
desire to go and do some hunting<font color="#E5E5E5"> on your</font>

6
00:00:16,289 --> 00:00:22,470
own<font color="#E5E5E5"> afterwards so what is this all about</font>

7
00:00:19,590 --> 00:00:25,470
<font color="#CCCCCC">well Internet of Things malware is very</font>

8
00:00:22,470 --> 00:00:28,110
trendy<font color="#CCCCCC"> right now yeah</font><font color="#E5E5E5"> you know Brian</font>

9
00:00:25,470 --> 00:00:30,479
Krebs got attacked and<font color="#E5E5E5"> the he actually a</font>

10
00:00:28,110 --> 00:00:33,260
<font color="#CCCCCC">cam I removed his support for him and</font>

11
00:00:30,480 --> 00:00:35,520
now he's protected by Google against

12
00:00:33,260 --> 00:00:39,210
distributed denial service attack

13
00:00:35,520 --> 00:00:41,100
he's been commenting on IOT malware for

14
00:00:39,210 --> 00:00:43,800
a long time I have screenshots later for

15
00:00:41,100 --> 00:00:47,370
stuff<font color="#CCCCCC"> that is more than a year old so</font>

16
00:00:43,800 --> 00:00:52,440
because<font color="#E5E5E5"> of this attack and also the news</font>

17
00:00:47,370 --> 00:00:55,949
breaking<font color="#CCCCCC"> OVH 1.5 terabyte per second</font>

18
00:00:52,440 --> 00:01:01,379
DDoS<font color="#CCCCCC"> here we have a screenshot of one</font>

19
00:00:55,950 --> 00:01:04,339
terabyte attack from OVH<font color="#CCCCCC"> CTO so this is</font>

20
00:01:01,379 --> 00:01:07,889
this<font color="#E5E5E5"> is real and he attributed it to</font>

21
00:01:04,339 --> 00:01:10,350
cameras and DVRs<font color="#CCCCCC"> so because he is on the</font>

22
00:01:07,889 --> 00:01:12,240
receiving<font color="#E5E5E5"> end of the DDoS</font><font color="#CCCCCC"> he</font><font color="#E5E5E5"> is able</font><font color="#CCCCCC"> to</font>

23
00:01:10,350 --> 00:01:13,678
you know poke the IP address<font color="#E5E5E5"> and look</font>

24
00:01:12,240 --> 00:01:16,829
<font color="#E5E5E5">what kind of device and</font><font color="#CCCCCC"> try to</font>

25
00:01:13,679 --> 00:01:19,819
fingerprint them so he attributed more

26
00:01:16,829 --> 00:01:22,770
<font color="#E5E5E5">than a hundred and almost</font><font color="#CCCCCC"> 150,000</font>

27
00:01:19,819 --> 00:01:26,399
devices that were<font color="#CCCCCC"> able to send up</font>

28
00:01:22,770 --> 00:01:29,279
<font color="#E5E5E5">upwards of 1.5 terabyte bit terabit per</font>

29
00:01:26,399 --> 00:01:31,409
second of traffic which is really

30
00:01:29,279 --> 00:01:33,389
getting out of hand it is it's<font color="#E5E5E5"> crazy no</font>

31
00:01:31,409 --> 00:01:37,590
one can<font color="#E5E5E5"> withstand that amount of traffic</font>

32
00:01:33,389 --> 00:01:40,439
<font color="#E5E5E5">you know so this is what this is</font><font color="#CCCCCC"> about</font>

33
00:01:37,590 --> 00:01:43,979
looking at this<font color="#CCCCCC"> situation the security</font>

34
00:01:40,439 --> 00:01:47,999
landscape around<font color="#E5E5E5"> this topic this area</font>

35
00:01:43,979 --> 00:01:51,479
I've been studying this IOT thing from a

36
00:01:47,999 --> 00:01:54,208
malware perspective since late 2014<font color="#CCCCCC"> I</font>

37
00:01:51,479 --> 00:02:00,060
did a presentation on Internet of Things

38
00:01:54,209 --> 00:02:01,590
threat<font color="#E5E5E5"> last May at the</font><font color="#CCCCCC"> atl second we we</font>

39
00:02:00,060 --> 00:02:05,609
were<font color="#E5E5E5"> lucky enough when I was working at</font>

40
00:02:01,590 --> 00:02:08,340
ESET to actually have samples<font color="#E5E5E5"> of of IOT</font>

41
00:02:05,609 --> 00:02:11,008
malware and so we work from<font color="#E5E5E5"> the samples</font>

42
00:02:08,340 --> 00:02:13,010
<font color="#E5E5E5">but now that I work at ghost cure and</font>

43
00:02:11,008 --> 00:02:14,958
not an AV company

44
00:02:13,010 --> 00:02:17,689
having access<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> binary files is</font>

45
00:02:14,959 --> 00:02:21,290
harder now we shifted our approach<font color="#E5E5E5"> and</font>

46
00:02:17,689 --> 00:02:23,900
we now<font color="#CCCCCC"> Pro proactively collect live</font>

47
00:02:21,290 --> 00:02:27,980
<font color="#CCCCCC">real-world things so I'll talk about</font>

48
00:02:23,900 --> 00:02:30,590
<font color="#E5E5E5">that today</font><font color="#CCCCCC"> here's our agenda for today</font>

49
00:02:27,980 --> 00:02:32,060
so<font color="#CCCCCC"> where we're gonna see the problem</font>

50
00:02:30,590 --> 00:02:35,120
area of IOT malware

51
00:02:32,060 --> 00:02:37,340
how to collect those threats<font color="#E5E5E5"> honey pots</font>

52
00:02:35,120 --> 00:02:39,829
<font color="#E5E5E5">which is the solution to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> threat</font>

53
00:02:37,340 --> 00:02:41,450
collection<font color="#CCCCCC"> will see some reverse</font>

54
00:02:39,829 --> 00:02:45,769
engineering challenges specifically

55
00:02:41,450 --> 00:02:47,569
<font color="#E5E5E5">related to IOT</font><font color="#CCCCCC"> malware data analysis</font>

56
00:02:45,769 --> 00:02:49,579
<font color="#E5E5E5">techniques when you have any pots you</font>

57
00:02:47,569 --> 00:02:52,129
have tons<font color="#E5E5E5"> of logs and I'll go through</font>

58
00:02:49,579 --> 00:02:54,530
our tools<font color="#E5E5E5"> for data analysis will see</font>

59
00:02:52,129 --> 00:02:56,388
some our samples so in my abstract you

60
00:02:54,530 --> 00:02:59,980
saw that I we will cover<font color="#E5E5E5"> three case</font>

61
00:02:56,389 --> 00:03:02,900
studies today<font color="#E5E5E5"> of real-world IOT malware</font>

62
00:02:59,980 --> 00:03:06,679
<font color="#CCCCCC">we'll talk about the future</font><font color="#E5E5E5"> and take</font>

63
00:03:02,900 --> 00:03:08,930
away<font color="#E5E5E5"> so Who am I to speak about all that</font>

64
00:03:06,680 --> 00:03:10,849
<font color="#CCCCCC">I'm a cyber security researcher</font><font color="#E5E5E5"> at both</font>

65
00:03:08,930 --> 00:03:14,000
secure I used to do my<font color="#CCCCCC"> own</font><font color="#E5E5E5"> research at</font>

66
00:03:10,849 --> 00:03:16,099
ESET for three years before<font color="#E5E5E5"> that I was</font><font color="#CCCCCC"> i</font>

67
00:03:14,000 --> 00:03:19,400
also lecture that you<font color="#CCCCCC"> know ets</font>

68
00:03:16,099 --> 00:03:22,429
university in montreal<font color="#CCCCCC"> what qualifies me</font>

69
00:03:19,400 --> 00:03:25,940
to looking at IOD malware well IOT is

70
00:03:22,430 --> 00:03:28,250
embedded devices so I used to do<font color="#CCCCCC"> be a</font>

71
00:03:25,940 --> 00:03:29,810
developer on Linux systems and a network

72
00:03:28,250 --> 00:03:32,239
<font color="#E5E5E5">administrator and then the next</font>

73
00:03:29,810 --> 00:03:34,129
assignment so for me this type<font color="#CCCCCC"> of</font><font color="#E5E5E5"> threat</font>

74
00:03:32,239 --> 00:03:35,900
makes a lot more sense<font color="#E5E5E5"> from a reverse</font>

75
00:03:34,129 --> 00:03:37,399
engineering standpoint<font color="#E5E5E5"> then actually</font>

76
00:03:35,900 --> 00:03:41,389
<font color="#CCCCCC">Windows malware because I'm a lot more</font>

77
00:03:37,400 --> 00:03:45,169
familiar<font color="#E5E5E5"> with this</font><font color="#CCCCCC"> I also do security</font>

78
00:03:41,389 --> 00:03:47,569
for fun out<font color="#CCCCCC"> of office hour I</font><font color="#E5E5E5"> co-founded</font>

79
00:03:45,169 --> 00:03:50,359
<font color="#CCCCCC">mantri hack which is a hands-on security</font>

80
00:03:47,569 --> 00:03:53,418
workshop where<font color="#CCCCCC"> we</font><font color="#E5E5E5"> train on real CTF</font>

81
00:03:50,359 --> 00:03:58,400
exercises<font color="#E5E5E5"> every month every turn Monday</font>

82
00:03:53,419 --> 00:04:00,349
of every month<font color="#E5E5E5"> and I'm also on</font><font color="#CCCCCC"> the</font>

83
00:03:58,400 --> 00:04:03,799
<font color="#CCCCCC">council of the</font><font color="#E5E5E5"> North</font><font color="#CCCCCC"> SEC security</font>

84
00:04:00,349 --> 00:04:05,388
conference<font color="#E5E5E5"> in Montreal which is a kind</font>

85
00:04:03,799 --> 00:04:07,959
<font color="#CCCCCC">of a conference and capture the flag</font>

86
00:04:05,389 --> 00:04:10,040
<font color="#CCCCCC">competition at the same time both of</font>

87
00:04:07,959 --> 00:04:12,199
initiatives are easy to find<font color="#E5E5E5"> in Google</font>

88
00:04:10,040 --> 00:04:16,010
<font color="#E5E5E5">and I advise</font><font color="#CCCCCC"> you to come</font><font color="#E5E5E5"> and participate</font>

89
00:04:12,199 --> 00:04:18,650
<font color="#E5E5E5">I spoke at 44 con this year at Virus</font>

90
00:04:16,010 --> 00:04:23,599
Bulletin<font color="#CCCCCC"> last year but compter become</font>

91
00:04:18,649 --> 00:04:25,969
<font color="#E5E5E5">Def Con so I</font><font color="#CCCCCC"> I'm used to do that</font><font color="#E5E5E5"> what is</font>

92
00:04:23,599 --> 00:04:26,719
the problem area what are the specifics

93
00:04:25,969 --> 00:04:29,420
of the<font color="#CCCCCC"> I</font>

94
00:04:26,720 --> 00:04:32,120
<font color="#E5E5E5">see behind the height you know the</font>

95
00:04:29,420 --> 00:04:34,250
buzzwords<font color="#E5E5E5"> and the headlines</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> we're</font>

96
00:04:32,120 --> 00:04:38,000
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> embedded systems with</font>

97
00:04:34,250 --> 00:04:41,240
small CPU memory and cheap<font color="#CCCCCC"> so there the</font>

98
00:04:38,000 --> 00:04:43,400
cost to build<font color="#E5E5E5"> them must be low and the</font>

99
00:04:41,240 --> 00:04:45,770
cost<font color="#E5E5E5"> for the software side of it also</font>

100
00:04:43,400 --> 00:04:47,989
<font color="#E5E5E5">must</font><font color="#CCCCCC"> be low</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> also thinking</font>

101
00:04:45,770 --> 00:04:50,330
<font color="#E5E5E5">about support costs so they don't want</font>

102
00:04:47,990 --> 00:04:52,790
to have a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> cause of all what is</font>

103
00:04:50,330 --> 00:04:54,520
that the<font color="#CCCCCC"> password on the device so</font>

104
00:04:52,790 --> 00:04:57,910
they're really<font color="#E5E5E5"> focusing on low cost</font>

105
00:04:54,520 --> 00:05:00,109
technology and structure price structure

106
00:04:57,910 --> 00:05:02,440
<font color="#E5E5E5">we're talking about something network</font>

107
00:05:00,110 --> 00:05:05,510
either Bluetooth Wi-Fi or Ethernet

108
00:05:02,440 --> 00:05:07,040
<font color="#E5E5E5">generally running Linux and for me the</font>

109
00:05:05,510 --> 00:05:09,560
most important aspect through my

110
00:05:07,040 --> 00:05:11,030
<font color="#CCCCCC">research and my</font><font color="#E5E5E5"> knowledge that</font><font color="#CCCCCC"> I've</font>

111
00:05:09,560 --> 00:05:16,000
gathered over<font color="#E5E5E5"> the last few years</font><font color="#CCCCCC"> and</font>

112
00:05:11,030 --> 00:05:18,679
<font color="#E5E5E5">that is the the lack</font><font color="#CCCCCC"> of a UI the no</font>

113
00:05:16,000 --> 00:05:21,370
<font color="#E5E5E5">general-purpose UI you usually have a</font>

114
00:05:18,680 --> 00:05:25,370
web interface but there's no like come

115
00:05:21,370 --> 00:05:28,070
desktop UI if you want the really

116
00:05:25,370 --> 00:05:30,140
problematic<font color="#E5E5E5"> IOT so it's not the</font>

117
00:05:28,070 --> 00:05:32,120
Bluetooth one it's not this one who will

118
00:05:30,140 --> 00:05:35,270
participate<font color="#CCCCCC"> in a botnet</font><font color="#E5E5E5"> you know you're</font>

119
00:05:32,120 --> 00:05:37,870
you're<font color="#CCCCCC"> not camera but the light bulb</font>

120
00:05:35,270 --> 00:05:40,940
which is controllable the Bluetooth

121
00:05:37,870 --> 00:05:43,370
doesn't expose telnet<font color="#E5E5E5"> or SSH</font><font color="#CCCCCC"> it's not</font>

122
00:05:40,940 --> 00:05:46,400
reachable from the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> so it's not</font>

123
00:05:43,370 --> 00:05:48,350
the this these type of<font color="#E5E5E5"> devices that are</font>

124
00:05:46,400 --> 00:05:50,299
really problematic<font color="#E5E5E5"> the ones which are</font>

125
00:05:48,350 --> 00:05:53,600
problematic<font color="#E5E5E5"> exposed telnet or SSH</font>

126
00:05:50,300 --> 00:05:56,810
they have a full user land<font color="#E5E5E5"> so</font><font color="#CCCCCC"> busybox</font>

127
00:05:53,600 --> 00:05:59,540
which is a complete shell<font color="#E5E5E5"> where you can</font>

128
00:05:56,810 --> 00:06:03,160
do ping and<font color="#CCCCCC"> W get and run commands and</font>

129
00:05:59,540 --> 00:06:05,990
Linux user<font color="#CCCCCC"> LAN it usually has default</font>

130
00:06:03,160 --> 00:06:09,110
global credentials so<font color="#CCCCCC"> an</font><font color="#E5E5E5"> min and min can</font>

131
00:06:05,990 --> 00:06:11,180
get you in<font color="#E5E5E5"> the these type of systems as</font>

132
00:06:09,110 --> 00:06:13,790
opposed to per device generated

133
00:06:11,180 --> 00:06:16,790
credentials<font color="#E5E5E5"> so the the industry for the</font>

134
00:06:13,790 --> 00:06:19,430
Wi-Fi access word for<font color="#CCCCCC"> example they now</font>

135
00:06:16,790 --> 00:06:21,169
generate a password custom to each

136
00:06:19,430 --> 00:06:23,870
router<font color="#E5E5E5"> so they have this process in</font>

137
00:06:21,169 --> 00:06:26,719
place but for<font color="#E5E5E5"> the N min it's still and</font>

138
00:06:23,870 --> 00:06:28,880
min<font color="#E5E5E5"> and min that gets you in so again</font>

139
00:06:26,720 --> 00:06:30,700
<font color="#CCCCCC">this is problematic</font><font color="#E5E5E5"> because the the list</font>

140
00:06:28,880 --> 00:06:33,980
of password you have<font color="#E5E5E5"> to try to</font>

141
00:06:30,700 --> 00:06:37,270
compromise<font color="#CCCCCC"> the device which</font><font color="#E5E5E5"> was not the</font>

142
00:06:33,980 --> 00:06:40,430
password<font color="#E5E5E5"> was not changed is really</font><font color="#CCCCCC"> short</font>

143
00:06:37,270 --> 00:06:41,990
<font color="#CCCCCC">the the problematic devices are also the</font>

144
00:06:40,430 --> 00:06:44,540
that can be plugged<font color="#E5E5E5"> on it on the</font>

145
00:06:41,990 --> 00:06:46,670
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> and specifically the ones that</font>

146
00:06:44,540 --> 00:06:48,770
can be<font color="#CCCCCC"> plugged backwards</font><font color="#E5E5E5"> on the</font><font color="#CCCCCC"> internet</font>

147
00:06:46,670 --> 00:06:50,840
<font color="#E5E5E5">a lot</font><font color="#CCCCCC"> of people will say oh</font><font color="#E5E5E5"> I need</font><font color="#CCCCCC"> to</font>

148
00:06:48,770 --> 00:06:52,880
<font color="#E5E5E5">access</font><font color="#CCCCCC"> my IP camera from the</font><font color="#E5E5E5"> internet</font>

149
00:06:50,840 --> 00:06:55,190
<font color="#E5E5E5">let's just put a switch there instead of</font>

150
00:06:52,880 --> 00:06:57,590
<font color="#E5E5E5">an app router plug it in there and so</font><font color="#CCCCCC"> it</font>

151
00:06:55,190 --> 00:06:59,510
kind of was<font color="#CCCCCC"> not thought to be deployed</font>

152
00:06:57,590 --> 00:07:01,429
that way but people<font color="#CCCCCC"> actually deploy it</font>

153
00:06:59,510 --> 00:07:03,909
that way because<font color="#E5E5E5"> they can and because</font>

154
00:07:01,430 --> 00:07:07,970
they<font color="#E5E5E5"> don't understand the</font><font color="#CCCCCC"> consequences</font>

155
00:07:03,910 --> 00:07:11,900
<font color="#CCCCCC">the</font><font color="#E5E5E5"> when I mean a general-purpose</font><font color="#CCCCCC"> UI</font><font color="#E5E5E5"> I</font>

156
00:07:07,970 --> 00:07:15,860
<font color="#E5E5E5">mean not the web</font><font color="#CCCCCC"> interface or</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> mobile</font>

157
00:07:11,900 --> 00:07:19,849
<font color="#CCCCCC">interface</font><font color="#E5E5E5"> or completely or the lack of</font>

158
00:07:15,860 --> 00:07:22,100
an interface<font color="#E5E5E5"> completely so it's not it's</font>

159
00:07:19,850 --> 00:07:24,470
problematic<font color="#CCCCCC"> because</font><font color="#E5E5E5"> you cannot really</font>

160
00:07:22,100 --> 00:07:26,750
investigate an<font color="#CCCCCC"> hour incident without a</font>

161
00:07:24,470 --> 00:07:29,390
user<font color="#CCCCCC"> interface you need some sort</font><font color="#E5E5E5"> of way</font>

162
00:07:26,750 --> 00:07:31,190
<font color="#CCCCCC">to be at the same privilege level of the</font>

163
00:07:29,390 --> 00:07:33,880
malware<font color="#E5E5E5"> and understand what's going on</font>

164
00:07:31,190 --> 00:07:39,020
<font color="#CCCCCC">traced it</font><font color="#E5E5E5"> debug it and stuff like that</font>

165
00:07:33,880 --> 00:07:41,960
<font color="#E5E5E5">so the lack also a general</font><font color="#CCCCCC"> uui has</font>

166
00:07:39,020 --> 00:07:44,390
implications<font color="#E5E5E5"> like that you cannot run</font>

167
00:07:41,960 --> 00:07:46,940
third-party software on an IOT device

168
00:07:44,390 --> 00:07:49,580
it's really a wall garden<font color="#E5E5E5"> stack</font>

169
00:07:46,940 --> 00:07:51,140
controlled by the device maker which

170
00:07:49,580 --> 00:07:55,280
means that there is no<font color="#CCCCCC"> endpoint security</font>

171
00:07:51,140 --> 00:07:59,990
software<font color="#E5E5E5"> I know people like</font><font color="#CCCCCC"> to bash on</font>

172
00:07:55,280 --> 00:08:03,289
<font color="#E5E5E5">AV like it's the trend for</font><font color="#CCCCCC"> the last ten</font>

173
00:07:59,990 --> 00:08:05,360
years<font color="#CCCCCC"> but people</font><font color="#E5E5E5"> still pay</font><font color="#CCCCCC"> for AV NJ and</font>

174
00:08:03,290 --> 00:08:07,370
should still pay for<font color="#E5E5E5"> it it is important</font>

175
00:08:05,360 --> 00:08:10,520
because every day they<font color="#E5E5E5"> find and they</font>

176
00:08:07,370 --> 00:08:12,170
collect the malware sample so the the AV

177
00:08:10,520 --> 00:08:14,299
<font color="#E5E5E5">that you run on</font><font color="#CCCCCC"> your desktop will</font>

178
00:08:12,170 --> 00:08:16,990
actually collect files that are similar

179
00:08:14,300 --> 00:08:19,700
looking to clean not clean files but

180
00:08:16,990 --> 00:08:23,810
potentially malicious files<font color="#E5E5E5"> and a human</font>

181
00:08:19,700 --> 00:08:25,969
will analyze them<font color="#E5E5E5"> this is the the basis</font>

182
00:08:23,810 --> 00:08:28,040
of the the fight against the<font color="#E5E5E5"> malware</font>

183
00:08:25,970 --> 00:08:30,320
because the<font color="#E5E5E5"> industry then shares all the</font>

184
00:08:28,040 --> 00:08:33,200
samples between<font color="#E5E5E5"> them through</font><font color="#CCCCCC"> virustotal</font>

185
00:08:30,320 --> 00:08:34,760
or other private<font color="#E5E5E5"> means which means</font><font color="#CCCCCC"> that</font>

186
00:08:33,200 --> 00:08:36,830
if there is no<font color="#CCCCCC"> third-party security</font>

187
00:08:34,760 --> 00:08:39,289
software on your IOT device there's no

188
00:08:36,830 --> 00:08:42,530
one who is<font color="#CCCCCC"> actually collecting the</font>

189
00:08:39,289 --> 00:08:47,390
samples<font color="#E5E5E5"> and we are in the dark</font><font color="#CCCCCC"> if you</font>

190
00:08:42,530 --> 00:08:49,520
want so because of these things our

191
00:08:47,390 --> 00:08:51,890
investigation on IOT is very different

192
00:08:49,520 --> 00:08:54,939
than your<font color="#CCCCCC"> usual desktop mobile</font><font color="#E5E5E5"> or</font>

193
00:08:51,890 --> 00:08:58,480
<font color="#E5E5E5">server-side threats where you all have</font>

194
00:08:54,940 --> 00:09:01,320
collection<font color="#CCCCCC"> also a</font><font color="#E5E5E5"> collection of samples</font>

195
00:08:58,480 --> 00:09:04,030
through security<font color="#CCCCCC"> software you also</font>

196
00:09:01,320 --> 00:09:07,690
understand mobile you also bring<font color="#E5E5E5"> the</font>

197
00:09:04,030 --> 00:09:10,030
malware<font color="#E5E5E5"> in you interact</font><font color="#CCCCCC"> with a webpage</font>

198
00:09:07,690 --> 00:09:13,330
usually and you will infect<font color="#CCCCCC"> yourself</font>

199
00:09:10,030 --> 00:09:15,300
that way<font color="#CCCCCC"> on</font><font color="#E5E5E5"> Io</font><font color="#CCCCCC"> T there is</font><font color="#E5E5E5"> no UI so</font><font color="#CCCCCC"> that</font>

200
00:09:13,330 --> 00:09:17,680
bad stuff needs<font color="#E5E5E5"> to reach in via</font>

201
00:09:15,300 --> 00:09:21,329
administrative channels like telnet or

202
00:09:17,680 --> 00:09:25,089
SSH as<font color="#CCCCCC"> we as I previously</font><font color="#E5E5E5"> mentioned and</font>

203
00:09:21,330 --> 00:09:27,900
<font color="#CCCCCC">however malware specific threats</font><font color="#E5E5E5"> will</font>

204
00:09:25,090 --> 00:09:31,870
also<font color="#E5E5E5"> affect servers</font><font color="#CCCCCC"> due to this</font>

205
00:09:27,900 --> 00:09:35,470
particularities<font color="#CCCCCC"> we'll see examples later</font>

206
00:09:31,870 --> 00:09:37,960
about<font color="#E5E5E5"> that so our first problems that we</font>

207
00:09:35,470 --> 00:09:40,630
<font color="#E5E5E5">are going to analyze today is having</font>

208
00:09:37,960 --> 00:09:45,460
access<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> binary samples so since</font>

209
00:09:40,630 --> 00:09:47,830
there is no<font color="#CCCCCC"> general-purpose</font><font color="#E5E5E5"> interface</font>

210
00:09:45,460 --> 00:09:49,540
<font color="#E5E5E5">how can you do a malware investigation</font>

211
00:09:47,830 --> 00:09:52,480
and actually try to understand what's

212
00:09:49,540 --> 00:09:55,420
going<font color="#CCCCCC"> on</font><font color="#E5E5E5"> well you can solder a serial</font>

213
00:09:52,480 --> 00:09:56,980
port<font color="#CCCCCC"> you</font><font color="#E5E5E5"> are sorry uart port on the on</font>

214
00:09:55,420 --> 00:10:00,099
the router that<font color="#CCCCCC"> you're trying</font><font color="#E5E5E5"> this is</font>

215
00:09:56,980 --> 00:10:01,990
for example<font color="#CCCCCC"> a tp-link router and then</font>

216
00:10:00,100 --> 00:10:05,470
<font color="#E5E5E5">you will get a root shell from that</font>

217
00:10:01,990 --> 00:10:07,780
access<font color="#CCCCCC"> but</font><font color="#E5E5E5"> this requires actual hardware</font>

218
00:10:05,470 --> 00:10:09,940
<font color="#E5E5E5">and it doesn't scale you cannot do</font>

219
00:10:07,780 --> 00:10:10,990
<font color="#CCCCCC">large-scale collection or analysis if</font>

220
00:10:09,940 --> 00:10:14,770
you have to do this

221
00:10:10,990 --> 00:10:19,170
all<font color="#CCCCCC"> the time</font><font color="#E5E5E5"> and also</font><font color="#CCCCCC"> it won't</font><font color="#E5E5E5"> work on</font>

222
00:10:14,770 --> 00:10:22,140
hardened devices like<font color="#E5E5E5"> ATM</font><font color="#CCCCCC"> point-of-sales</font>

223
00:10:19,170 --> 00:10:25,750
systems which<font color="#E5E5E5"> are have temper evident</font>

224
00:10:22,140 --> 00:10:28,240
protections so it's not<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that</font>

225
00:10:25,750 --> 00:10:31,510
<font color="#E5E5E5">is scalable if we want to do large-scale</font>

226
00:10:28,240 --> 00:10:34,030
<font color="#E5E5E5">study of IOT malware we can ask nicely</font>

227
00:10:31,510 --> 00:10:35,770
for<font color="#E5E5E5"> files but the problem with</font><font color="#CCCCCC"> that is</font>

228
00:10:34,030 --> 00:10:39,040
<font color="#CCCCCC">people</font><font color="#E5E5E5"> don't even realize or know they</font>

229
00:10:35,770 --> 00:10:43,090
are infected<font color="#CCCCCC"> again</font><font color="#E5E5E5"> because they they ran</font>

230
00:10:39,040 --> 00:10:45,370
the the only<font color="#CCCCCC"> way they</font><font color="#E5E5E5"> get notified if</font>

231
00:10:43,090 --> 00:10:48,580
they are<font color="#E5E5E5"> infected through IOT malware is</font>

232
00:10:45,370 --> 00:10:50,320
<font color="#CCCCCC">their</font><font color="#E5E5E5"> internet runs slowly</font><font color="#CCCCCC"> or the ISP</font>

233
00:10:48,580 --> 00:10:51,820
tells them you are<font color="#CCCCCC"> infected</font><font color="#E5E5E5"> and tells</font>

234
00:10:50,320 --> 00:10:55,600
them to unplug everything<font color="#E5E5E5"> and plug</font>

235
00:10:51,820 --> 00:10:57,970
things back<font color="#E5E5E5"> one item at a</font><font color="#CCCCCC"> time and then</font>

236
00:10:55,600 --> 00:11:00,880
try<font color="#CCCCCC"> to investigate what's going on there</font>

237
00:10:57,970 --> 00:11:04,030
so extraction requires specialized

238
00:11:00,880 --> 00:11:06,130
<font color="#E5E5E5">knowledge</font><font color="#CCCCCC"> I was after</font><font color="#E5E5E5"> a talk I did at</font>

239
00:11:04,030 --> 00:11:08,199
Virus Bulletin someone saw<font color="#E5E5E5"> it online and</font>

240
00:11:06,130 --> 00:11:11,140
he<font color="#E5E5E5"> actually shipped me</font>

241
00:11:08,200 --> 00:11:13,000
router<font color="#E5E5E5"> at my house where I did the</font>

242
00:11:11,140 --> 00:11:16,390
extraction<font color="#E5E5E5"> and try to find if there was</font>

243
00:11:13,000 --> 00:11:20,650
a malware<font color="#E5E5E5"> on it so this again</font><font color="#CCCCCC"> is not a</font>

244
00:11:16,390 --> 00:11:22,000
process<font color="#E5E5E5"> that scales</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> well so finding</font>

245
00:11:20,650 --> 00:11:24,400
<font color="#E5E5E5">a way</font><font color="#CCCCCC"> in again</font>

246
00:11:22,000 --> 00:11:26,770
as I previously<font color="#E5E5E5"> mentioned most malware</font>

247
00:11:24,400 --> 00:11:29,020
gets<font color="#CCCCCC"> sent via telnet or SSH and the four</font>

248
00:11:26,770 --> 00:11:31,180
<font color="#E5E5E5">creds so you can always reuse that path</font>

249
00:11:29,020 --> 00:11:33,280
<font color="#E5E5E5">but</font><font color="#CCCCCC"> the problem is</font><font color="#E5E5E5"> that it could be</font>

250
00:11:31,180 --> 00:11:35,620
tampered with<font color="#CCCCCC"> they since you run at the</font>

251
00:11:33,280 --> 00:11:37,470
same privilege level as<font color="#E5E5E5"> them it's not</font>

252
00:11:35,620 --> 00:11:40,300
something that<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> guarantee that</font>

253
00:11:37,470 --> 00:11:43,990
<font color="#E5E5E5">you you are not</font><font color="#CCCCCC"> being lied to if you</font>

254
00:11:40,300 --> 00:11:46,569
want and it's illegal<font color="#CCCCCC"> so if I would hunt</font>

255
00:11:43,990 --> 00:11:49,860
<font color="#E5E5E5">malware samples on</font><font color="#CCCCCC"> the Internet</font><font color="#E5E5E5"> connect</font>

256
00:11:46,570 --> 00:11:52,150
on telnet<font color="#E5E5E5"> machines and try to extract</font>

257
00:11:49,860 --> 00:11:54,580
<font color="#E5E5E5">processes and see if they are clean or</font>

258
00:11:52,150 --> 00:11:57,040
<font color="#CCCCCC">malware</font><font color="#E5E5E5"> this is not something</font><font color="#CCCCCC"> I'm</font>

259
00:11:54,580 --> 00:12:00,480
<font color="#CCCCCC">willing to do unfortunately but</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> could</font>

260
00:11:57,040 --> 00:12:03,219
be done<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> also something that the</font>

261
00:12:00,480 --> 00:12:06,910
<font color="#E5E5E5">security industry does is hunting on</font>

262
00:12:03,220 --> 00:12:09,160
virustotal so you run<font color="#CCCCCC"> yarra rules</font><font color="#E5E5E5"> which</font>

263
00:12:06,910 --> 00:12:11,199
specific characteristic of the stuff you

264
00:12:09,160 --> 00:12:13,000
are<font color="#E5E5E5"> trying to find and you upload them</font>

265
00:12:11,200 --> 00:12:14,800
on<font color="#E5E5E5"> virustotal virus will automatically</font>

266
00:12:13,000 --> 00:12:16,810
run<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Ray error rules on all the new</font>

267
00:12:14,800 --> 00:12:18,760
samples in their huge collection and you

268
00:12:16,810 --> 00:12:21,400
<font color="#E5E5E5">can also do reach row hunting which is</font>

269
00:12:18,760 --> 00:12:25,000
another feature for the paying customer

270
00:12:21,400 --> 00:12:27,370
of virus<font color="#CCCCCC"> total which allows you to run</font>

271
00:12:25,000 --> 00:12:29,680
in right<font color="#E5E5E5"> arrow goes on older sample but</font>

272
00:12:27,370 --> 00:12:31,960
<font color="#E5E5E5">it relies on individuals that are</font>

273
00:12:29,680 --> 00:12:33,790
submitting samples so people with their

274
00:12:31,960 --> 00:12:36,850
specialized knowledge that we mentioned

275
00:12:33,790 --> 00:12:37,390
previously<font color="#CCCCCC"> then uploading the files to</font>

276
00:12:36,850 --> 00:12:41,110
<font color="#CCCCCC">virustotal</font>

277
00:12:37,390 --> 00:12:43,780
so in reality<font color="#E5E5E5"> what happens is</font><font color="#CCCCCC"> that we we</font>

278
00:12:41,110 --> 00:12:46,660
we noticed that<font color="#E5E5E5"> no one was actively</font>

279
00:12:43,780 --> 00:12:49,510
<font color="#E5E5E5">sharing very different or</font><font color="#CCCCCC"> interesting</font>

280
00:12:46,660 --> 00:12:51,760
samples on<font color="#CCCCCC"> VT</font><font color="#E5E5E5"> it was always it was kind</font>

281
00:12:49,510 --> 00:12:53,439
<font color="#E5E5E5">of a feedback loop</font><font color="#CCCCCC"> echo-chamber</font>

282
00:12:51,760 --> 00:12:55,600
if you would see a blog post about

283
00:12:53,440 --> 00:12:58,630
lizard squad then you would see a ton of

284
00:12:55,600 --> 00:13:00,370
lizard squad samples all compiled with

285
00:12:58,630 --> 00:13:02,020
different<font color="#CCCCCC"> timestamps so they're actually</font>

286
00:13:00,370 --> 00:13:04,060
the same<font color="#CCCCCC"> thing or someone</font><font color="#E5E5E5"> added a</font>

287
00:13:02,020 --> 00:13:05,890
feature removed another feature<font color="#E5E5E5"> nothing</font>

288
00:13:04,060 --> 00:13:08,229
really<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> nothing new that</font>

289
00:13:05,890 --> 00:13:12,400
<font color="#E5E5E5">would stand out</font><font color="#CCCCCC"> always the same the same</font>

290
00:13:08,230 --> 00:13:15,400
type<font color="#CCCCCC"> of things on virustotal</font>

291
00:13:12,400 --> 00:13:17,290
what we've<font color="#E5E5E5"> tried somewhat successfully</font>

292
00:13:15,400 --> 00:13:19,900
was to look specifically for elf

293
00:13:17,290 --> 00:13:21,709
binaries<font color="#E5E5E5"> that are of the</font><font color="#CCCCCC"> mips</font><font color="#E5E5E5"> or arm</font>

294
00:13:19,900 --> 00:13:23,600
architectures but again

295
00:13:21,710 --> 00:13:26,240
and we had tons of<font color="#E5E5E5"> files and mostly</font><font color="#CCCCCC"> all</font>

296
00:13:23,600 --> 00:13:28,250
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same and you</font><font color="#CCCCCC"> had to go through LS</font>

297
00:13:26,240 --> 00:13:28,700
you know binary and realize oh this is

298
00:13:28,250 --> 00:13:30,680
just

299
00:13:28,700 --> 00:13:35,990
LS it's not malware<font color="#E5E5E5"> you have no</font>

300
00:13:30,680 --> 00:13:39,500
indication otherwise so the solution to

301
00:13:35,990 --> 00:13:43,730
<font color="#E5E5E5">this problem</font><font color="#CCCCCC"> that we we are believing in</font>

302
00:13:39,500 --> 00:13:46,250
it at ghost cure is actually honey pots

303
00:13:43,730 --> 00:13:47,930
the problem with honey pots is that they

304
00:13:46,250 --> 00:13:50,020
are complex<font color="#E5E5E5"> so what</font><font color="#CCCCCC"> are honey pots</font>

305
00:13:47,930 --> 00:13:53,060
quickly<font color="#E5E5E5"> it's the system that</font><font color="#CCCCCC"> lures</font>

306
00:13:50,020 --> 00:13:53,720
attackers<font color="#E5E5E5"> and to showing how they</font>

307
00:13:53,060 --> 00:13:57,079
operate

308
00:13:53,720 --> 00:13:58,520
including the files that<font color="#E5E5E5"> the the that</font>

309
00:13:57,080 --> 00:14:01,550
<font color="#E5E5E5">the</font><font color="#CCCCCC"> bad guys will upload on your</font>

310
00:13:58,520 --> 00:14:04,730
<font color="#CCCCCC">honeypot</font><font color="#E5E5E5"> so we decided to choose a</font>

311
00:14:01,550 --> 00:14:06,589
honeypot<font color="#CCCCCC"> a different type of kind</font><font color="#E5E5E5"> of</font>

312
00:14:04,730 --> 00:14:08,690
<font color="#E5E5E5">choices that</font><font color="#CCCCCC"> we have in front</font><font color="#E5E5E5"> of us is</font>

313
00:14:06,590 --> 00:14:10,910
do we do a hard bear<font color="#E5E5E5"> a</font><font color="#CCCCCC"> hardware-based</font>

314
00:14:08,690 --> 00:14:12,440
<font color="#CCCCCC">one</font><font color="#E5E5E5"> since we are dealing with IOT we</font>

315
00:14:10,910 --> 00:14:15,170
could emulate the whole thing with<font color="#E5E5E5"> the</font>

316
00:14:12,440 --> 00:14:17,360
hardware but<font color="#E5E5E5"> quickly as everyone here</font>

317
00:14:15,170 --> 00:14:19,579
will probably<font color="#E5E5E5"> come to the same</font>

318
00:14:17,360 --> 00:14:21,320
conclusion quickly is the<font color="#E5E5E5"> maintenance</font>

319
00:14:19,580 --> 00:14:22,700
the<font color="#E5E5E5"> monitoring and geographic</font>

320
00:14:21,320 --> 00:14:24,440
limitations<font color="#E5E5E5"> because when you study</font>

321
00:14:22,700 --> 00:14:26,300
malware it's<font color="#CCCCCC"> interesting to see what's</font>

322
00:14:24,440 --> 00:14:29,960
<font color="#E5E5E5">going on in Brazil versus Russia</font><font color="#CCCCCC"> and</font>

323
00:14:26,300 --> 00:14:34,459
stuff<font color="#E5E5E5"> like that</font><font color="#CCCCCC"> it makes it's not really</font>

324
00:14:29,960 --> 00:14:36,320
<font color="#E5E5E5">interesting also the when evaluating</font>

325
00:14:34,460 --> 00:14:39,620
software it's not all perfect because

326
00:14:36,320 --> 00:14:40,520
it's<font color="#E5E5E5"> arguably slower slower sorry it can</font>

327
00:14:39,620 --> 00:14:42,410
be fingerprinted

328
00:14:40,520 --> 00:14:47,900
so<font color="#CCCCCC"> fingerprinting means that someone</font>

329
00:14:42,410 --> 00:14:49,640
could know<font color="#E5E5E5"> that or make your system tell</font>

330
00:14:47,900 --> 00:14:51,890
<font color="#E5E5E5">that it's a honeypot so it's not the</font>

331
00:14:49,640 --> 00:14:53,569
real thing<font color="#E5E5E5"> so you can always find one</font>

332
00:14:51,890 --> 00:14:55,069
way one bit that<font color="#E5E5E5"> it will be different</font>

333
00:14:53,570 --> 00:14:57,470
<font color="#CCCCCC">than</font><font color="#E5E5E5"> the headers or stuff</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> that</font>

334
00:14:55,070 --> 00:14:59,990
<font color="#CCCCCC">will allow you to</font><font color="#E5E5E5"> detect that you are</font>

335
00:14:57,470 --> 00:15:02,750
actually dealing with<font color="#E5E5E5"> a software based</font>

336
00:14:59,990 --> 00:15:04,580
<font color="#E5E5E5">on it but so this is definitely a caveat</font>

337
00:15:02,750 --> 00:15:07,370
the advantage<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> have right now is</font>

338
00:15:04,580 --> 00:15:10,460
no one is expecting to<font color="#E5E5E5"> be trapped in a</font>

339
00:15:07,370 --> 00:15:12,740
honeypot<font color="#E5E5E5"> so we kind of see little</font>

340
00:15:10,460 --> 00:15:15,620
honeypot detection techniques but we

341
00:15:12,740 --> 00:15:19,160
still saw some as I will touch on<font color="#E5E5E5"> later</font>

342
00:15:15,620 --> 00:15:22,040
<font color="#CCCCCC">so soft woman is just more flexible</font>

343
00:15:19,160 --> 00:15:25,520
<font color="#E5E5E5">cheaper can be deployed</font><font color="#CCCCCC"> on the cloud so</font>

344
00:15:22,040 --> 00:15:27,439
it's<font color="#E5E5E5"> pretty obvious at this time</font><font color="#CCCCCC"> there</font>

345
00:15:25,520 --> 00:15:30,079
are<font color="#E5E5E5"> types of honeypot low interaction</font>

346
00:15:27,440 --> 00:15:32,690
and high interaction the low interaction

347
00:15:30,080 --> 00:15:34,800
doesn't<font color="#E5E5E5"> give you a real shell access</font><font color="#CCCCCC"> it</font>

348
00:15:32,690 --> 00:15:37,320
gives you kind<font color="#E5E5E5"> of a lexer</font>

349
00:15:34,800 --> 00:15:41,010
stuff is emulated<font color="#E5E5E5"> so you can always find</font>

350
00:15:37,320 --> 00:15:43,050
ways<font color="#CCCCCC"> so since the - or the busybox</font>

351
00:15:41,010 --> 00:15:45,209
environment is a<font color="#E5E5E5"> very rich common</font>

352
00:15:43,050 --> 00:15:48,000
<font color="#E5E5E5">environment there's always ways that the</font>

353
00:15:45,209 --> 00:15:49,560
malware can try to<font color="#E5E5E5"> use boolean logic and</font>

354
00:15:48,000 --> 00:15:51,750
stuff like that that<font color="#E5E5E5"> the honeypot needs</font>

355
00:15:49,560 --> 00:15:53,670
to mimic<font color="#E5E5E5"> so it's kind of an arm arms</font>

356
00:15:51,750 --> 00:15:55,320
race<font color="#CCCCCC"> you look at your logs</font><font color="#E5E5E5"> and you</font>

357
00:15:53,670 --> 00:15:57,060
realize oh I need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> support this</font>

358
00:15:55,320 --> 00:16:00,810
feature<font color="#E5E5E5"> because this</font><font color="#CCCCCC"> malware is trying</font>

359
00:15:57,060 --> 00:16:04,680
to use it<font color="#E5E5E5"> and we will see later</font><font color="#CCCCCC"> the type</font>

360
00:16:00,810 --> 00:16:07,279
of logs that<font color="#E5E5E5"> we're gathering and you'll</font>

361
00:16:04,680 --> 00:16:10,560
see why I mean<font color="#E5E5E5"> you need a good lecture</font>

362
00:16:07,279 --> 00:16:13,760
<font color="#CCCCCC">but compared to a high interaction</font>

363
00:16:10,560 --> 00:16:16,979
honeypot<font color="#CCCCCC"> they are a lot less</font><font color="#E5E5E5"> attention</font>

364
00:16:13,760 --> 00:16:20,040
<font color="#CCCCCC">needy you don't you</font><font color="#E5E5E5"> can forget</font><font color="#CCCCCC"> about</font>

365
00:16:16,980 --> 00:16:23,670
them for<font color="#CCCCCC"> weeks</font><font color="#E5E5E5"> and you</font><font color="#CCCCCC"> your you won't</font>

366
00:16:20,040 --> 00:16:25,290
actually run<font color="#E5E5E5"> elf binaries and</font><font color="#CCCCCC"> infect the</font>

367
00:16:23,670 --> 00:16:27,390
cloud architecture that<font color="#CCCCCC"> you are</font><font color="#E5E5E5"> running</font>

368
00:16:25,290 --> 00:16:32,010
<font color="#E5E5E5">it on so it's kind of feels a lot</font><font color="#CCCCCC"> safer</font>

369
00:16:27,390 --> 00:16:34,170
to<font color="#CCCCCC"> use this type of</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> epod so you'll</font>

370
00:16:32,010 --> 00:16:37,649
have less chance of becoming part of the

371
00:16:34,170 --> 00:16:39,750
problem so we<font color="#E5E5E5"> decided now that</font><font color="#CCCCCC"> we</font>

372
00:16:37,649 --> 00:16:42,209
decided<font color="#E5E5E5"> on a low interaction honeypot we</font>

373
00:16:39,750 --> 00:16:43,800
actually<font color="#E5E5E5"> decided to build kind of a set</font>

374
00:16:42,209 --> 00:16:48,510
of<font color="#E5E5E5"> components that we hooked together</font>

375
00:16:43,800 --> 00:16:53,990
for the for a honeypot<font color="#CCCCCC"> so we have a real</font>

376
00:16:48,510 --> 00:16:57,089
<font color="#E5E5E5">Linux qmu infected</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> which runs the</font>

377
00:16:53,990 --> 00:17:00,570
<font color="#E5E5E5">ARM architecture</font><font color="#CCCCCC"> so we are</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to put</font>

378
00:16:57,089 --> 00:17:03,329
<font color="#CCCCCC">in there real binary files that will get</font>

379
00:17:00,570 --> 00:17:05,339
executed<font color="#CCCCCC"> we put that in front of</font><font color="#E5E5E5"> a</font>

380
00:17:03,329 --> 00:17:07,559
man-in-the-middle proxy<font color="#E5E5E5"> and these</font>

381
00:17:05,339 --> 00:17:09,418
components<font color="#CCCCCC"> will</font><font color="#E5E5E5"> be developed later we</font>

382
00:17:07,559 --> 00:17:11,579
use<font color="#CCCCCC"> IP tables to forward the things to</font>

383
00:17:09,419 --> 00:17:15,000
the different port<font color="#E5E5E5"> that we need so we we</font>

384
00:17:11,579 --> 00:17:17,609
<font color="#CCCCCC">actually hide SSH and then route SSH</font>

385
00:17:15,000 --> 00:17:19,530
through the<font color="#CCCCCC"> Cowie</font><font color="#E5E5E5"> low interaction</font>

386
00:17:17,609 --> 00:17:23,129
honeypot so that our real<font color="#CCCCCC"> SSH is still</font>

387
00:17:19,530 --> 00:17:26,428
available<font color="#E5E5E5"> to the system but a fake SSH</font>

388
00:17:23,130 --> 00:17:28,380
is running on port 22 we there's a typo

389
00:17:26,429 --> 00:17:30,720
in<font color="#E5E5E5"> there it's dumb cap we use dumb cap</font>

390
00:17:28,380 --> 00:17:33,179
to do a full packet capture of the whole

391
00:17:30,720 --> 00:17:34,740
environment<font color="#E5E5E5"> so in case something is</font>

392
00:17:33,179 --> 00:17:35,730
missing in the logs or<font color="#E5E5E5"> we're not sure</font>

393
00:17:34,740 --> 00:17:37,800
what's happening are we being

394
00:17:35,730 --> 00:17:40,590
fingerprinted<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> always go and have</font>

395
00:17:37,800 --> 00:17:42,809
the raw<font color="#E5E5E5"> data in the log</font><font color="#CCCCCC"> the full packet</font>

396
00:17:40,590 --> 00:17:44,730
capture environment and so this is in a

397
00:17:42,809 --> 00:17:47,100
<font color="#CCCCCC">nutshell the</font><font color="#E5E5E5"> environment that we've</font>

398
00:17:44,730 --> 00:17:48,240
<font color="#E5E5E5">built all of</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> open source and</font>

399
00:17:47,100 --> 00:17:50,908
free<font color="#CCCCCC"> software</font>

400
00:17:48,240 --> 00:17:52,679
<font color="#CCCCCC">that's the component we decided to</font><font color="#E5E5E5"> use</font>

401
00:17:50,909 --> 00:17:55,019
<font color="#CCCCCC">dump cap for the packet capture</font><font color="#E5E5E5"> it's</font>

402
00:17:52,679 --> 00:17:59,190
kind of a TCP dump but made<font color="#CCCCCC"> by the</font>

403
00:17:55,019 --> 00:18:02,639
Wireshark project<font color="#E5E5E5"> better</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> more modern</font>

404
00:17:59,190 --> 00:18:05,399
text user interface and it has<font color="#E5E5E5"> privilege</font>

405
00:18:02,639 --> 00:18:09,479
separation so you less chances of being

406
00:18:05,399 --> 00:18:11,189
and<font color="#CCCCCC"> exploited we use</font><font color="#E5E5E5"> Q mu plus a Debian</font>

407
00:18:09,480 --> 00:18:13,320
based image for the the<font color="#CCCCCC"> armed</font>

408
00:18:11,190 --> 00:18:18,659
environment<font color="#E5E5E5"> so the Debian image is a</font>

409
00:18:13,320 --> 00:18:20,908
girl's arm images which is<font color="#CCCCCC"> a full</font><font color="#E5E5E5"> Linux</font>

410
00:18:18,659 --> 00:18:23,789
system<font color="#E5E5E5"> if you want on the</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> ARM</font>

411
00:18:20,909 --> 00:18:26,580
architecture<font color="#E5E5E5"> we decided to go with a</font>

412
00:18:23,789 --> 00:18:28,980
<font color="#CCCCCC">carry for the honeypot now talk a bit</font>

413
00:18:26,580 --> 00:18:30,720
more about curry for<font color="#E5E5E5"> the HTTP</font>

414
00:18:28,980 --> 00:18:32,519
<font color="#CCCCCC">man-in-the-middle we use men in the</font>

415
00:18:30,720 --> 00:18:34,740
<font color="#E5E5E5">middle proxy this is the component that</font>

416
00:18:32,519 --> 00:18:36,059
is not strictly<font color="#CCCCCC"> required but for one</font><font color="#E5E5E5"> of</font>

417
00:18:34,740 --> 00:18:38,940
our investigation<font color="#E5E5E5"> that I'll cover later</font>

418
00:18:36,059 --> 00:18:40,320
<font color="#E5E5E5">was required so this is why I stick it</font>

419
00:18:38,940 --> 00:18:44,639
in there since it's part of our<font color="#E5E5E5"> system</font>

420
00:18:40,320 --> 00:18:46,918
<font color="#CCCCCC">and we needed the the honeypot to be</font>

421
00:18:44,639 --> 00:18:49,289
standalone<font color="#E5E5E5"> and what I mean</font><font color="#CCCCCC"> by that is if</font>

422
00:18:46,919 --> 00:18:51,330
<font color="#E5E5E5">my honey pot ever gets compromised</font><font color="#CCCCCC"> I</font>

423
00:18:49,289 --> 00:18:54,240
didn't want the bad actors to be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

424
00:18:51,330 --> 00:18:56,340
<font color="#CCCCCC">trace it to trace it back to me so I</font>

425
00:18:54,240 --> 00:18:57,869
<font color="#E5E5E5">needed it to be like</font><font color="#CCCCCC"> throwaway like if</font>

426
00:18:56,340 --> 00:18:59,639
something goes<font color="#CCCCCC"> wrong I delete it</font><font color="#E5E5E5"> and</font>

427
00:18:57,869 --> 00:19:01,799
never existed and this is another

428
00:18:59,639 --> 00:19:04,709
another reason why<font color="#E5E5E5"> you want that is</font><font color="#CCCCCC"> that</font>

429
00:19:01,799 --> 00:19:08,220
<font color="#CCCCCC">maybe that the provider hosting your</font>

430
00:19:04,710 --> 00:19:10,169
cloud instance will you probably<font color="#CCCCCC"> more or</font>

431
00:19:08,220 --> 00:19:13,590
less breach the term of service with

432
00:19:10,169 --> 00:19:15,659
them by doing<font color="#E5E5E5"> that so in case something</font>

433
00:19:13,590 --> 00:19:18,629
happens then you do not lose all<font color="#E5E5E5"> your</font>

434
00:19:15,659 --> 00:19:21,960
<font color="#E5E5E5">files and you still have</font><font color="#CCCCCC"> your stuff so</font>

435
00:19:18,629 --> 00:19:24,119
the idea of<font color="#CCCCCC"> standalone is really no no</font>

436
00:19:21,960 --> 00:19:26,970
pushing back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the mothership we I</font>

437
00:19:24,119 --> 00:19:29,970
always fetch<font color="#E5E5E5"> stuff with SSH keys and</font>

438
00:19:26,970 --> 00:19:31,649
fetched dialogues and the<font color="#CCCCCC"> pcaps daily</font>

439
00:19:29,970 --> 00:19:33,919
and so if it ever blow up

440
00:19:31,649 --> 00:19:38,908
I just recreate<font color="#CCCCCC"> another one so it's a</font>

441
00:19:33,919 --> 00:19:41,669
develops if you want strategy I<font color="#CCCCCC"> guess</font><font color="#E5E5E5"> we</font>

442
00:19:38,909 --> 00:19:44,340
evaluated a few honeypot<font color="#E5E5E5"> so there was a</font>

443
00:19:41,669 --> 00:19:48,899
<font color="#E5E5E5">curry capo curry is actually a fork of</font>

444
00:19:44,340 --> 00:19:52,168
capo<font color="#CCCCCC"> hornet honey D curry is a</font><font color="#E5E5E5"> built</font><font color="#CCCCCC"> in</font>

445
00:19:48,899 --> 00:19:54,389
Python based on the twisted framework so

446
00:19:52,169 --> 00:19:56,909
<font color="#E5E5E5">as synchronous i/o and all the fancy</font>

447
00:19:54,389 --> 00:20:00,029
fast stuff

448
00:19:56,909 --> 00:20:01,890
it includes an emulated file system<font color="#E5E5E5"> and</font>

449
00:20:00,029 --> 00:20:04,440
you can<font color="#CCCCCC"> modify the output of the</font>

450
00:20:01,890 --> 00:20:06,780
commands that are emulated really easily

451
00:20:04,440 --> 00:20:09,360
it's all text files on a specific

452
00:20:06,780 --> 00:20:11,010
<font color="#CCCCCC">directory</font><font color="#E5E5E5"> so it's it's really easy</font><font color="#CCCCCC"> to</font>

453
00:20:09,360 --> 00:20:13,229
<font color="#E5E5E5">make it look like a router because</font>

454
00:20:11,010 --> 00:20:16,370
<font color="#E5E5E5">initially</font><font color="#CCCCCC"> it will</font><font color="#E5E5E5"> look like</font><font color="#CCCCCC"> a server</font><font color="#E5E5E5"> but</font>

455
00:20:13,230 --> 00:20:19,800
you<font color="#CCCCCC"> can make</font><font color="#E5E5E5"> it look like a router or</font><font color="#CCCCCC"> a</font>

456
00:20:16,370 --> 00:20:22,229
insulin pump<font color="#E5E5E5"> if you want</font><font color="#CCCCCC"> it's actively</font>

457
00:20:19,800 --> 00:20:24,930
maintained and has a nice log replay

458
00:20:22,230 --> 00:20:28,580
mechanism where you<font color="#E5E5E5"> see actual typing of</font>

459
00:20:24,930 --> 00:20:32,070
the<font color="#CCCCCC"> command</font><font color="#E5E5E5"> in real time on the SSH</font>

460
00:20:28,580 --> 00:20:33,960
<font color="#CCCCCC">interface</font><font color="#E5E5E5"> so it's kind of you you</font><font color="#CCCCCC"> get</font>

461
00:20:32,070 --> 00:20:35,909
kind of a nice feeling you<font color="#E5E5E5"> you</font><font color="#CCCCCC"> get to</font>

462
00:20:33,960 --> 00:20:37,560
see oh is it a script<font color="#E5E5E5"> or a human</font>

463
00:20:35,910 --> 00:20:39,870
interacting with my<font color="#E5E5E5"> system which is</font>

464
00:20:37,560 --> 00:20:43,740
which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> kind of cool</font><font color="#CCCCCC"> since it's over</font>

465
00:20:39,870 --> 00:20:46,169
<font color="#E5E5E5">SSH your packet capture is useless</font><font color="#CCCCCC"> so</font>

466
00:20:43,740 --> 00:20:48,630
<font color="#CCCCCC">that the fact of having</font><font color="#E5E5E5"> that log is</font>

467
00:20:46,170 --> 00:20:51,180
<font color="#E5E5E5">actually quite necessary</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> only</font>

468
00:20:48,630 --> 00:20:53,520
disadvantage of<font color="#CCCCCC"> Carrie was that it</font>

469
00:20:51,180 --> 00:20:56,550
didn't do<font color="#E5E5E5"> telnet didn't support telnet</font>

470
00:20:53,520 --> 00:20:59,940
<font color="#E5E5E5">but for our investigation</font><font color="#CCCCCC"> it was it was</font>

471
00:20:56,550 --> 00:21:02,399
key<font color="#E5E5E5"> so what I decided to do is during</font>

472
00:20:59,940 --> 00:21:04,320
<font color="#E5E5E5">the holiday season last year</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font>

473
00:21:02,400 --> 00:21:06,630
<font color="#CCCCCC">there's less management and you get to</font>

474
00:21:04,320 --> 00:21:08,550
<font color="#E5E5E5">choose what</font><font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to do more</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so I</font>

475
00:21:06,630 --> 00:21:11,040
decided<font color="#E5E5E5"> hey I'll implement telnet</font>

476
00:21:08,550 --> 00:21:16,379
support for the carry project and this

477
00:21:11,040 --> 00:21:19,620
<font color="#E5E5E5">is what I did I got merged</font><font color="#CCCCCC"> a few months</font>

478
00:21:16,380 --> 00:21:22,130
ago by the<font color="#E5E5E5"> maintainer</font><font color="#CCCCCC"> of curry so it's</font>

479
00:21:19,620 --> 00:21:25,110
go secures contribution to the<font color="#CCCCCC"> community</font>

480
00:21:22,130 --> 00:21:27,060
<font color="#E5E5E5">and it's nice</font><font color="#CCCCCC"> because now since</font><font color="#E5E5E5"> its</font>

481
00:21:25,110 --> 00:21:29,070
upstream<font color="#E5E5E5"> everyone benefits from it and</font>

482
00:21:27,060 --> 00:21:32,340
it's<font color="#E5E5E5"> actually maintained by more than</font>

483
00:21:29,070 --> 00:21:34,590
<font color="#E5E5E5">just</font><font color="#CCCCCC"> me now so it</font><font color="#E5E5E5"> took</font><font color="#CCCCCC"> quite some work</font>

484
00:21:32,340 --> 00:21:38,070
<font color="#E5E5E5">because of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> way twisted works and</font>

485
00:21:34,590 --> 00:21:41,189
it's still not perfect but it's cool<font color="#CCCCCC"> and</font>

486
00:21:38,070 --> 00:21:43,470
since The Cribs<font color="#E5E5E5"> story broke out everyone</font>

487
00:21:41,190 --> 00:21:45,810
is talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> running</font><font color="#CCCCCC"> carry</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> a</font>

488
00:21:43,470 --> 00:21:48,690
<font color="#E5E5E5">telnet to see what what is going on with</font>

489
00:21:45,810 --> 00:21:51,419
the<font color="#E5E5E5"> IOT DDoS malware so I mean this is</font>

490
00:21:48,690 --> 00:21:52,800
pretty<font color="#E5E5E5"> good timing right here some</font>

491
00:21:51,420 --> 00:21:55,380
mistakes<font color="#E5E5E5"> that we've made through our</font>

492
00:21:52,800 --> 00:21:57,570
components that<font color="#E5E5E5"> we chose I started using</font>

493
00:21:55,380 --> 00:21:59,700
darker because containers are cool and

494
00:21:57,570 --> 00:22:02,240
<font color="#CCCCCC">you need that</font><font color="#E5E5E5"> I want it to</font><font color="#CCCCCC"> be like the</font>

495
00:21:59,700 --> 00:22:06,450
cool kids<font color="#E5E5E5"> but it turned out that some</font>

496
00:22:02,240 --> 00:22:08,970
<font color="#E5E5E5">VPS are using openvz which pretty much</font>

497
00:22:06,450 --> 00:22:11,730
is<font color="#E5E5E5"> in conflict with</font><font color="#CCCCCC"> the the the</font><font color="#E5E5E5"> features</font>

498
00:22:08,970 --> 00:22:14,910
<font color="#CCCCCC">required by docker to</font><font color="#E5E5E5"> do proper name</font>

499
00:22:11,730 --> 00:22:15,350
spacing<font color="#E5E5E5"> also other VPS is that older</font>

500
00:22:14,910 --> 00:22:17,270
<font color="#CCCCCC">current</font>

501
00:22:15,350 --> 00:22:18,678
that were not supported so it turned out

502
00:22:17,270 --> 00:22:22,129
that<font color="#CCCCCC"> I needed to support two different</font>

503
00:22:18,679 --> 00:22:23,809
<font color="#CCCCCC">sets of services one that were darker</font>

504
00:22:22,130 --> 00:22:26,720
eyes and other that weren't darker eyes

505
00:22:23,809 --> 00:22:28,428
and since the machines<font color="#CCCCCC"> are standalone</font>

506
00:22:26,720 --> 00:22:32,690
<font color="#E5E5E5">and I can always</font><font color="#CCCCCC"> delete it and</font><font color="#E5E5E5"> create</font>

507
00:22:28,429 --> 00:22:37,330
another one<font color="#CCCCCC"> I decided</font><font color="#E5E5E5"> just that's let's</font>

508
00:22:32,690 --> 00:22:37,330
forget isolation and just go Yolo mode

509
00:22:37,419 --> 00:22:41,720
<font color="#CCCCCC">so this was a mistake as I lost</font><font color="#E5E5E5"> quite</font>

510
00:22:40,340 --> 00:22:43,668
some<font color="#E5E5E5"> time in there and I found some</font>

511
00:22:41,720 --> 00:22:47,600
limitation on darker and stuff<font color="#E5E5E5"> but it</font>

512
00:22:43,669 --> 00:22:50,270
should<font color="#CCCCCC"> be better soon for the HTTP</font>

513
00:22:47,600 --> 00:22:53,480
<font color="#CCCCCC">man-in-the-middle</font><font color="#E5E5E5"> we had a choice</font><font color="#CCCCCC"> so one</font>

514
00:22:50,270 --> 00:22:55,820
of<font color="#E5E5E5"> them our does sucks proxy HTTP</font>

515
00:22:53,480 --> 00:22:57,650
traffic through a socks proxy<font color="#E5E5E5"> so this is</font>

516
00:22:55,820 --> 00:22:59,450
kind of<font color="#E5E5E5"> a very specific</font><font color="#CCCCCC"> use case</font><font color="#E5E5E5"> well</font>

517
00:22:57,650 --> 00:23:01,909
<font color="#E5E5E5">where I want to connect at the end of</font>

518
00:22:59,450 --> 00:23:04,940
the<font color="#E5E5E5"> socks tunnel and then man in the</font>

519
00:23:01,909 --> 00:23:09,260
middle<font color="#E5E5E5"> this so that I can intercept and</font>

520
00:23:04,940 --> 00:23:11,450
have the raw HTTP traffic<font color="#CCCCCC"> I evaluated</font>

521
00:23:09,260 --> 00:23:14,090
better cap<font color="#E5E5E5"> and</font><font color="#CCCCCC"> man-in-the-middle proxy</font>

522
00:23:11,450 --> 00:23:16,039
some friends<font color="#E5E5E5"> of the pen test community</font>

523
00:23:14,090 --> 00:23:19,039
told<font color="#E5E5E5"> me better cap isn't is very very</font>

524
00:23:16,039 --> 00:23:22,429
good so you gotta try<font color="#CCCCCC"> that I patched</font><font color="#E5E5E5"> a</font>

525
00:23:19,039 --> 00:23:24,980
better cap first they bling HSTs bypass

526
00:23:22,429 --> 00:23:27,320
because<font color="#E5E5E5"> HSTs relies on a</font><font color="#CCCCCC"> DNS trick and</font>

527
00:23:24,980 --> 00:23:29,419
since I'm<font color="#CCCCCC"> in a</font><font color="#E5E5E5"> sucks proxy</font><font color="#CCCCCC"> I cannot</font>

528
00:23:27,320 --> 00:23:31,820
trick the<font color="#CCCCCC"> DNS because the</font><font color="#E5E5E5"> DNS is</font>

529
00:23:29,419 --> 00:23:35,419
actually performed on the client<font color="#CCCCCC"> end of</font>

530
00:23:31,820 --> 00:23:38,450
the tunnel which I<font color="#CCCCCC"> don't control and I</font>

531
00:23:35,419 --> 00:23:40,340
<font color="#E5E5E5">notice after</font><font color="#CCCCCC"> my patching I mean patching</font>

532
00:23:38,450 --> 00:23:43,039
I mean I like I added eight comments

533
00:23:40,340 --> 00:23:45,980
somewhere<font color="#CCCCCC"> in a big if</font><font color="#E5E5E5"> it should have</font>

534
00:23:43,039 --> 00:23:49,549
<font color="#E5E5E5">been an option it was just not an option</font>

535
00:23:45,980 --> 00:23:52,010
so I notice<font color="#E5E5E5"> it kept crashing after</font><font color="#CCCCCC"> a few</font>

536
00:23:49,549 --> 00:23:54,110
days but even<font color="#CCCCCC"> if it</font><font color="#E5E5E5"> would crash I</font>

537
00:23:52,010 --> 00:23:56,120
wouldn't mind<font color="#CCCCCC"> that much the real problem</font>

538
00:23:54,110 --> 00:23:58,309
with better cap for my<font color="#CCCCCC"> use case was that</font>

539
00:23:56,120 --> 00:24:01,039
there is<font color="#CCCCCC"> no</font><font color="#E5E5E5"> way to have the the</font>

540
00:23:58,309 --> 00:24:04,340
unencrypted traffic<font color="#CCCCCC"> other than in a free</font>

541
00:24:01,039 --> 00:24:06,320
form text format<font color="#E5E5E5"> so</font><font color="#CCCCCC"> for me when I wanted</font>

542
00:24:04,340 --> 00:24:09,110
<font color="#CCCCCC">to man in the</font><font color="#E5E5E5"> middle traffic for months</font>

543
00:24:06,320 --> 00:24:12,379
and I want to be<font color="#CCCCCC"> able to do</font><font color="#E5E5E5"> analysis on</font>

544
00:24:09,110 --> 00:24:16,209
the<font color="#E5E5E5"> flow that gets and</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> request the</font>

545
00:24:12,380 --> 00:24:19,730
structured data<font color="#CCCCCC"> it was</font><font color="#E5E5E5"> not an</font><font color="#CCCCCC"> option</font><font color="#E5E5E5"> so</font>

546
00:24:16,210 --> 00:24:22,370
really<font color="#E5E5E5"> bad</font><font color="#CCCCCC"> choice I I switched</font><font color="#E5E5E5"> to manual</font>

547
00:24:19,730 --> 00:24:24,140
proxy<font color="#E5E5E5"> it's stable it's been running</font><font color="#CCCCCC"> for</font>

548
00:24:22,370 --> 00:24:26,809
months in some instances without<font color="#CCCCCC"> any</font>

549
00:24:24,140 --> 00:24:28,640
crashing the problem with<font color="#E5E5E5"> it is and I</font>

550
00:24:26,809 --> 00:24:30,530
understand<font color="#E5E5E5"> now why my friend became</font>

551
00:24:28,640 --> 00:24:32,270
<font color="#E5E5E5">me a better cap is that</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> doesn't do</font>

552
00:24:30,530 --> 00:24:35,090
iptables on its own you<font color="#E5E5E5"> need to be able</font>

553
00:24:32,270 --> 00:24:37,309
<font color="#E5E5E5">to manage the firewall yourself and this</font>

554
00:24:35,090 --> 00:24:41,030
guy is<font color="#CCCCCC"> not very good network admin so I</font>

555
00:24:37,309 --> 00:24:44,299
understand why now<font color="#CCCCCC"> it comes with a</font>

556
00:24:41,030 --> 00:24:46,280
library<font color="#CCCCCC"> which does the parsing and it</font>

557
00:24:44,299 --> 00:24:48,320
extract the<font color="#E5E5E5"> data for you the file format</font>

558
00:24:46,280 --> 00:24:51,770
is quite simple it's<font color="#CCCCCC"> not</font><font color="#E5E5E5"> Jason but</font>

559
00:24:48,320 --> 00:24:54,200
almost<font color="#E5E5E5"> and it's not pickle a</font><font color="#CCCCCC"> Python</font>

560
00:24:51,770 --> 00:24:56,929
pickle so it's it's more secure<font color="#E5E5E5"> which is</font>

561
00:24:54,200 --> 00:24:59,660
<font color="#E5E5E5">very interesting</font><font color="#CCCCCC"> like the library to</font>

562
00:24:56,929 --> 00:25:01,460
parcel the logs is so high level<font color="#E5E5E5"> that</font>

563
00:24:59,660 --> 00:25:03,890
even non-technical people<font color="#E5E5E5"> at work</font>

564
00:25:01,460 --> 00:25:06,679
<font color="#CCCCCC">actually we're doing the</font><font color="#E5E5E5"> the</font>

565
00:25:03,890 --> 00:25:09,020
intelligence and extraction<font color="#E5E5E5"> of what is</font>

566
00:25:06,679 --> 00:25:11,150
the content<font color="#E5E5E5"> of the data so it's really</font>

567
00:25:09,020 --> 00:25:13,820
well done

568
00:25:11,150 --> 00:25:16,490
for the full packet captured<font color="#E5E5E5"> I already</font>

569
00:25:13,820 --> 00:25:18,290
told you<font color="#CCCCCC"> about these another</font><font color="#E5E5E5"> nice trick</font>

570
00:25:16,490 --> 00:25:20,600
<font color="#CCCCCC">yeah do automatic rotation of your logs</font>

571
00:25:18,290 --> 00:25:23,090
of course<font color="#E5E5E5"> so that they don't go to grow</font>

572
00:25:20,600 --> 00:25:25,159
too<font color="#CCCCCC"> big another trick is to move a</font>

573
00:25:23,090 --> 00:25:26,870
switch to a non-standard port and filter

574
00:25:25,160 --> 00:25:29,450
it<font color="#CCCCCC"> out otherwise you have a feedback</font>

575
00:25:26,870 --> 00:25:32,090
<font color="#E5E5E5">loop effect</font><font color="#CCCCCC"> of when you pull your pcap</font>

576
00:25:29,450 --> 00:25:35,600
or your logs<font color="#E5E5E5"> they go in SSH and if you</font>

577
00:25:32,090 --> 00:25:36,740
dump SSH<font color="#E5E5E5"> your pcap will just grow grow</font>

578
00:25:35,600 --> 00:25:38,120
<font color="#CCCCCC">and grow and grow</font><font color="#E5E5E5"> and you don't</font>

579
00:25:36,740 --> 00:25:40,179
understand why and<font color="#E5E5E5"> at some point you're</font>

580
00:25:38,120 --> 00:25:43,909
like this anymore

581
00:25:40,179 --> 00:25:46,520
<font color="#CCCCCC">so filter</font><font color="#E5E5E5"> out your real SSH which is</font>

582
00:25:43,910 --> 00:25:48,799
hidden away<font color="#CCCCCC"> the reverse engineering</font>

583
00:25:46,520 --> 00:25:50,840
problems<font color="#E5E5E5"> the biggest problem regarding</font>

584
00:25:48,799 --> 00:25:52,730
reverse engineering the IOT malware is

585
00:25:50,840 --> 00:25:56,990
when we're dealing with statically

586
00:25:52,730 --> 00:26:00,559
linked<font color="#E5E5E5"> stripped binaries so</font><font color="#CCCCCC"> what are</font>

587
00:25:56,990 --> 00:26:02,840
these specific<font color="#E5E5E5"> type of F by elf binaries</font>

588
00:26:00,559 --> 00:26:05,540
<font color="#E5E5E5">is that you have no imports so</font>

589
00:26:02,840 --> 00:26:07,909
everything is more or less<font color="#E5E5E5"> in</font><font color="#CCCCCC"> line</font>

590
00:26:05,540 --> 00:26:09,740
inside<font color="#E5E5E5"> the binary which makes the file</font>

591
00:26:07,910 --> 00:26:12,470
larger but it means<font color="#E5E5E5"> that it will run</font><font color="#CCCCCC"> on</font>

592
00:26:09,740 --> 00:26:14,390
any<font color="#E5E5E5"> Linux kernel because Linux is bad</font>

593
00:26:12,470 --> 00:26:15,440
word at the<font color="#E5E5E5"> Cisco level the next is</font>

594
00:26:14,390 --> 00:26:19,549
backward compatible

595
00:26:15,440 --> 00:26:21,559
<font color="#E5E5E5">until like I don't even know it's it's</font>

596
00:26:19,549 --> 00:26:25,460
old<font color="#E5E5E5"> enough</font><font color="#CCCCCC"> that it runs on</font><font color="#E5E5E5"> everywhere</font>

597
00:26:21,559 --> 00:26:28,070
but the<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> the more or</font><font color="#E5E5E5"> less what is</font>

598
00:26:25,460 --> 00:26:30,320
bundled in<font color="#E5E5E5"> together is the C</font><font color="#CCCCCC"> library</font><font color="#E5E5E5"> and</font>

599
00:26:28,070 --> 00:26:32,418
the C<font color="#CCCCCC"> library can be quite huge even on</font>

600
00:26:30,320 --> 00:26:34,970
embedded system<font color="#E5E5E5"> we're talking like</font>

601
00:26:32,419 --> 00:26:38,030
<font color="#E5E5E5">around a</font><font color="#CCCCCC"> hundred</font><font color="#E5E5E5"> and thirty K of code</font>

602
00:26:34,970 --> 00:26:41,510
pure code which is a lot of code if you

603
00:26:38,030 --> 00:26:44,480
<font color="#E5E5E5">think</font><font color="#CCCCCC"> about it the this assembler</font>

604
00:26:41,510 --> 00:26:46,750
<font color="#E5E5E5">doesn't help much</font><font color="#CCCCCC"> so just to give you a</font>

605
00:26:44,480 --> 00:26:49,460
sense<font color="#E5E5E5"> of what you have to deal with</font><font color="#CCCCCC"> is</font>

606
00:26:46,750 --> 00:26:50,900
these are<font color="#E5E5E5"> all functions you have no idea</font>

607
00:26:49,460 --> 00:26:52,790
what they do you<font color="#E5E5E5"> have no debugging</font>

608
00:26:50,900 --> 00:26:55,820
symbols and so you will<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to reverse</font>

609
00:26:52,790 --> 00:26:57,620
engineer<font color="#E5E5E5"> from the start to up to</font><font color="#CCCCCC"> each</font>

610
00:26:55,820 --> 00:27:01,340
function to understand what what it is

611
00:26:57,620 --> 00:27:03,739
<font color="#E5E5E5">doing so this is 33 function out of 500</font>

612
00:27:01,340 --> 00:27:05,360
so this is only<font color="#E5E5E5"> a subset of what you</font>

613
00:27:03,740 --> 00:27:08,570
would actually have to<font color="#E5E5E5"> reverse engineer</font>

614
00:27:05,360 --> 00:27:11,780
<font color="#E5E5E5">and it's not simple code to analyze this</font>

615
00:27:08,570 --> 00:27:15,169
<font color="#E5E5E5">is</font><font color="#CCCCCC"> an example</font><font color="#E5E5E5"> these are all every box is</font>

616
00:27:11,780 --> 00:27:19,310
a function and<font color="#E5E5E5"> this is the printf family</font>

617
00:27:15,170 --> 00:27:21,710
of calls<font color="#E5E5E5"> and so if we explode the V</font>

618
00:27:19,310 --> 00:27:24,860
printf graph you<font color="#CCCCCC"> have a graph like</font><font color="#E5E5E5"> this</font>

619
00:27:21,710 --> 00:27:28,220
<font color="#E5E5E5">again</font><font color="#CCCCCC"> all the</font><font color="#E5E5E5"> boxes are functions and if</font>

620
00:27:24,860 --> 00:27:30,320
we go deeper and look<font color="#E5E5E5"> into one function</font>

621
00:27:28,220 --> 00:27:33,530
how does it look like and assembly it's

622
00:27:30,320 --> 00:27:35,570
like this so this is<font color="#CCCCCC"> the V F printf</font>

623
00:27:33,530 --> 00:27:37,820
function<font color="#E5E5E5"> and you need to reverse</font>

624
00:27:35,570 --> 00:27:39,830
<font color="#E5E5E5">engineer all of this without any symbols</font>

625
00:27:37,820 --> 00:27:43,189
<font color="#E5E5E5">to finally understand that you reverse</font>

626
00:27:39,830 --> 00:27:45,830
engineer printf<font color="#E5E5E5"> so this is really not</font>

627
00:27:43,190 --> 00:27:51,230
scalable<font color="#CCCCCC"> at all you need to focus on the</font>

628
00:27:45,830 --> 00:27:53,000
malware code of course<font color="#CCCCCC"> so the ecosystem</font>

629
00:27:51,230 --> 00:27:55,460
<font color="#E5E5E5">makes it even worse for reverse</font>

630
00:27:53,000 --> 00:27:58,040
engineering<font color="#CCCCCC"> because the the</font><font color="#E5E5E5"> C library</font>

631
00:27:55,460 --> 00:28:00,500
<font color="#E5E5E5">are always changing so</font><font color="#CCCCCC"> the compiled</font>

632
00:27:58,040 --> 00:28:04,129
<font color="#CCCCCC">libraries changed based on compiler</font><font color="#E5E5E5"> and</font>

633
00:28:00,500 --> 00:28:06,350
<font color="#E5E5E5">C library there are little</font><font color="#CCCCCC"> Ida flirt</font>

634
00:28:04,130 --> 00:28:08,570
signatures<font color="#E5E5E5"> so the Ida flirt support is</font>

635
00:28:06,350 --> 00:28:13,520
<font color="#E5E5E5">really good on Windows and on server</font>

636
00:28:08,570 --> 00:28:16,520
<font color="#E5E5E5">side Linux of the x86 GCC variants but</font>

637
00:28:13,520 --> 00:28:18,350
otherwise<font color="#E5E5E5"> there are not a lot</font><font color="#CCCCCC"> of</font>

638
00:28:16,520 --> 00:28:20,150
signatures<font color="#E5E5E5"> available and you</font><font color="#CCCCCC"> can have</font>

639
00:28:18,350 --> 00:28:23,240
various<font color="#E5E5E5"> C libraries for the embedded</font>

640
00:28:20,150 --> 00:28:26,900
system you see<font color="#CCCCCC"> let's see eg</font><font color="#E5E5E5"> Lib C JFC</font>

641
00:28:23,240 --> 00:28:28,370
<font color="#E5E5E5">muzzle and stuff like that at first what</font>

642
00:28:26,900 --> 00:28:30,110
I<font color="#CCCCCC"> tried to do is to match this cause</font>

643
00:28:28,370 --> 00:28:33,260
when an<font color="#E5E5E5"> Ida script which is linked in</font>

644
00:28:30,110 --> 00:28:35,719
<font color="#E5E5E5">the slide will be available for you but</font>

645
00:28:33,260 --> 00:28:37,129
as<font color="#CCCCCC"> you saw the</font><font color="#E5E5E5"> sis calls are too</font>

646
00:28:35,720 --> 00:28:39,320
<font color="#CCCCCC">low-level</font><font color="#E5E5E5"> so you still need</font><font color="#CCCCCC"> to</font>

647
00:28:37,130 --> 00:28:41,510
<font color="#CCCCCC">reverse-engineer all that code</font><font color="#E5E5E5"> there is</font>

648
00:28:39,320 --> 00:28:43,790
a little<font color="#E5E5E5"> hint about the position of the</font>

649
00:28:41,510 --> 00:28:48,080
code<font color="#E5E5E5"> that can help you you know you try</font>

650
00:28:43,790 --> 00:28:50,960
to find the the address<font color="#E5E5E5"> space where it's</font>

651
00:28:48,080 --> 00:28:53,060
actually library code and not the<font color="#CCCCCC"> the</font>

652
00:28:50,960 --> 00:28:55,160
main program but still this could be

653
00:28:53,060 --> 00:28:57,860
further<font color="#CCCCCC"> office catered</font><font color="#E5E5E5"> or</font>

654
00:28:55,160 --> 00:29:01,070
made harder for you if the bad guys will

655
00:28:57,860 --> 00:29:05,600
ever<font color="#E5E5E5"> know that</font><font color="#CCCCCC"> we use that</font><font color="#E5E5E5"> tree</font><font color="#CCCCCC"> so still</font>

656
00:29:01,070 --> 00:29:07,460
too much<font color="#E5E5E5"> code to re so what I recommend</font>

657
00:29:05,600 --> 00:29:08,990
<font color="#E5E5E5">people doing is you reproduce the</font>

658
00:29:07,460 --> 00:29:12,350
environment<font color="#E5E5E5"> out of the strings that you</font>

659
00:29:08,990 --> 00:29:15,050
<font color="#E5E5E5">have access</font><font color="#CCCCCC"> to so or the target</font><font color="#E5E5E5"> the</font>

660
00:29:12,350 --> 00:29:17,360
targeted device<font color="#E5E5E5"> so architecture</font><font color="#CCCCCC"> Lipsy</font>

661
00:29:15,050 --> 00:29:19,310
and compiler version<font color="#CCCCCC"> you build the same</font>

662
00:29:17,360 --> 00:29:21,229
libraries with symbol<font color="#E5E5E5"> under</font><font color="#CCCCCC"> the same</font>

663
00:29:19,310 --> 00:29:23,210
conditions so one of the best<font color="#E5E5E5"> tool</font>

664
00:29:21,230 --> 00:29:25,370
chains to do that is that<font color="#E5E5E5"> open wrt</font>

665
00:29:23,210 --> 00:29:29,120
<font color="#E5E5E5">ecosystem which a lot</font><font color="#CCCCCC"> of the bad guy</font>

666
00:29:25,370 --> 00:29:31,070
target<font color="#CCCCCC"> because it runs everywhere and</font>

667
00:29:29,120 --> 00:29:35,419
then you use bin diff which is now free

668
00:29:31,070 --> 00:29:37,730
from<font color="#CCCCCC"> google</font><font color="#E5E5E5"> to map the library function</font>

669
00:29:35,420 --> 00:29:41,120
and<font color="#CCCCCC"> you can then focus on the the</font>

670
00:29:37,730 --> 00:29:43,850
malware code<font color="#E5E5E5"> so it sounds</font><font color="#CCCCCC"> complicated</font>

671
00:29:41,120 --> 00:29:47,540
but<font color="#E5E5E5"> it's actually</font><font color="#CCCCCC"> pretty easy and</font><font color="#E5E5E5"> I'll</font>

672
00:29:43,850 --> 00:29:50,300
show you what what this gives<font color="#E5E5E5"> is so on</font>

673
00:29:47,540 --> 00:29:52,850
one<font color="#CCCCCC"> hand you have</font><font color="#E5E5E5"> the function that is</font>

674
00:29:50,300 --> 00:29:54,980
sub and<font color="#E5E5E5"> an address whatever you don't</font>

675
00:29:52,850 --> 00:29:56,780
understand<font color="#E5E5E5"> and on the other end</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> your</font>

676
00:29:54,980 --> 00:29:59,180
binary<font color="#E5E5E5"> that you added the symbols to it</font>

677
00:29:56,780 --> 00:30:03,170
and you can see that the similarity is

678
00:29:59,180 --> 00:30:07,310
99%<font color="#CCCCCC"> the confidence that</font><font color="#E5E5E5"> the similarity</font>

679
00:30:03,170 --> 00:30:10,970
is<font color="#CCCCCC"> not wrong is 99%</font><font color="#E5E5E5"> and the function is</font>

680
00:30:07,310 --> 00:30:14,600
named<font color="#E5E5E5"> V</font><font color="#CCCCCC"> F</font><font color="#E5E5E5"> printf internal so you can</font>

681
00:30:10,970 --> 00:30:16,400
mass import the symbol into your your

682
00:30:14,600 --> 00:30:19,010
<font color="#E5E5E5">eider samples that you're working</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> and</font>

683
00:30:16,400 --> 00:30:21,350
with this then<font color="#CCCCCC"> own</font><font color="#E5E5E5"> the only remaining</font>

684
00:30:19,010 --> 00:30:23,629
<font color="#E5E5E5">functions that are called sub with an</font>

685
00:30:21,350 --> 00:30:25,879
address will be the<font color="#E5E5E5"> functions that you</font>

686
00:30:23,630 --> 00:30:28,280
<font color="#CCCCCC">need</font><font color="#E5E5E5"> to look at the malware code so this</font>

687
00:30:25,880 --> 00:30:30,470
mapped out the<font color="#E5E5E5"> whole seed library for</font>

688
00:30:28,280 --> 00:30:34,129
you<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> you need to do that with</font>

689
00:30:30,470 --> 00:30:38,540
other big libraries like for instance<font color="#CCCCCC"> if</font>

690
00:30:34,130 --> 00:30:41,030
<font color="#E5E5E5">your malware supports HTTP it most</font>

691
00:30:38,540 --> 00:30:43,129
likely either has a proxy or<font color="#E5E5E5"> has open</font>

692
00:30:41,030 --> 00:30:46,370
SSL bundled in then you will<font color="#CCCCCC"> need</font><font color="#E5E5E5"> to do</font>

693
00:30:43,130 --> 00:30:51,200
the same<font color="#E5E5E5"> thing with open SSL</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> this</font>

694
00:30:46,370 --> 00:30:55,129
example<font color="#E5E5E5"> it was a</font><font color="#CCCCCC"> UC Lib</font><font color="#E5E5E5"> C 0.9 2033 from</font>

695
00:30:51,200 --> 00:30:59,270
the open W<font color="#E5E5E5"> 2 chain you this is the Linux</font>

696
00:30:55,130 --> 00:31:01,880
moose<font color="#E5E5E5"> malware</font><font color="#CCCCCC"> I was able to import</font><font color="#E5E5E5"> more</font>

697
00:30:59,270 --> 00:31:05,900
<font color="#CCCCCC">than 225 functions</font><font color="#E5E5E5"> with high confidence</font>

698
00:31:01,880 --> 00:31:07,310
high<font color="#CCCCCC"> similarity so other reverse</font>

699
00:31:05,900 --> 00:31:08,410
engineering problems that you can

700
00:31:07,310 --> 00:31:11,379
encounter is

701
00:31:08,410 --> 00:31:13,180
the constraint of the<font color="#E5E5E5"> Enver the</font>

702
00:31:11,380 --> 00:31:15,880
environment where the mower<font color="#E5E5E5"> is running</font>

703
00:31:13,180 --> 00:31:17,800
makes it<font color="#E5E5E5"> that you cannot do easy</font>

704
00:31:15,880 --> 00:31:19,720
dynamic analysis<font color="#E5E5E5"> so if it's not</font>

705
00:31:17,800 --> 00:31:23,470
something<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you could emulate easily</font>

706
00:31:19,720 --> 00:31:26,200
using<font color="#CCCCCC"> qmu then it's a lot</font><font color="#E5E5E5"> harder to be</font>

707
00:31:23,470 --> 00:31:27,910
<font color="#CCCCCC">able to to</font><font color="#E5E5E5"> analyze and then</font><font color="#CCCCCC"> you need</font><font color="#E5E5E5"> to</font>

708
00:31:26,200 --> 00:31:30,970
engage<font color="#E5E5E5"> with</font><font color="#CCCCCC"> people specialized in</font>

709
00:31:27,910 --> 00:31:34,480
embedded system<font color="#E5E5E5"> developments development</font>

710
00:31:30,970 --> 00:31:36,670
sorry<font color="#CCCCCC"> and right now it's</font><font color="#E5E5E5"> not that</font><font color="#CCCCCC"> bad</font>

711
00:31:34,480 --> 00:31:40,060
<font color="#E5E5E5">because there's not a lot of anti debug</font>

712
00:31:36,670 --> 00:31:42,490
and anti analysis focus by<font color="#E5E5E5"> the bad guys</font>

713
00:31:40,060 --> 00:31:45,370
<font color="#E5E5E5">but I'm sure as more researcher will get</font>

714
00:31:42,490 --> 00:31:48,820
into this game<font color="#E5E5E5"> the thing things will</font>

715
00:31:45,370 --> 00:31:51,580
change will get worse another<font color="#CCCCCC"> problem</font>

716
00:31:48,820 --> 00:31:56,560
that because it's a lessons<font color="#E5E5E5"> learned talk</font>

717
00:31:51,580 --> 00:31:59,080
you know<font color="#E5E5E5"> is on data analysis so the the</font>

718
00:31:56,560 --> 00:32:01,030
size the volume of the<font color="#E5E5E5"> data is really</font>

719
00:31:59,080 --> 00:32:02,800
important you<font color="#E5E5E5"> get scan as soon as you</font>

720
00:32:01,030 --> 00:32:05,620
put a telnet<font color="#E5E5E5"> out there you get scan</font>

721
00:32:02,800 --> 00:32:07,720
within<font color="#E5E5E5"> a few minutes</font><font color="#CCCCCC"> and all</font><font color="#E5E5E5"> the time so</font>

722
00:32:05,620 --> 00:32:09,909
you<font color="#E5E5E5"> will have large peak apps a lot of</font>

723
00:32:07,720 --> 00:32:11,680
logs<font color="#CCCCCC"> I've been collecting</font><font color="#E5E5E5"> them for</font>

724
00:32:09,910 --> 00:32:14,320
<font color="#CCCCCC">months which doesn't</font><font color="#E5E5E5"> help the size</font>

725
00:32:11,680 --> 00:32:16,150
problem and I distributed it<font color="#CCCCCC"> I</font>

726
00:32:14,320 --> 00:32:19,240
distributed the environment in several

727
00:32:16,150 --> 00:32:22,000
countries<font color="#CCCCCC"> what we decided</font><font color="#E5E5E5"> to do and we</font>

728
00:32:19,240 --> 00:32:26,590
kind of experimented but<font color="#E5E5E5"> finally if</font>

729
00:32:22,000 --> 00:32:28,840
doing<font color="#E5E5E5"> in reality is we use a centralized</font>

730
00:32:26,590 --> 00:32:31,959
single server who pulls all the files on

731
00:32:28,840 --> 00:32:34,480
<font color="#CCCCCC">it and then we use a ipython notebook</font><font color="#E5E5E5"> as</font>

732
00:32:31,960 --> 00:32:37,660
a collaborative<font color="#E5E5E5"> IDE ipython notebook is</font>

733
00:32:34,480 --> 00:32:39,910
a web interface<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that runs an</font>

734
00:32:37,660 --> 00:32:43,570
ipython kernel<font color="#E5E5E5"> so it's kind of a code</font>

735
00:32:39,910 --> 00:32:45,160
block that<font color="#CCCCCC"> you can a rich red hole</font>

736
00:32:43,570 --> 00:32:46,750
environment where you can you know

737
00:32:45,160 --> 00:32:48,520
control and<font color="#CCCCCC"> taurine</font><font color="#E5E5E5"> it will run the</font>

738
00:32:46,750 --> 00:32:50,830
Python code<font color="#CCCCCC"> that is in</font><font color="#E5E5E5"> there and so to</font>

739
00:32:48,520 --> 00:32:53,470
<font color="#CCCCCC">show</font><font color="#E5E5E5"> you the output</font><font color="#CCCCCC"> right below which is</font>

740
00:32:50,830 --> 00:32:55,480
good<font color="#CCCCCC"> because then I could do with the</font>

741
00:32:53,470 --> 00:33:00,280
interns like a try<font color="#CCCCCC"> this block of code</font>

742
00:32:55,480 --> 00:33:02,110
<font color="#E5E5E5">and and an experiment with them Python</font>

743
00:33:00,280 --> 00:33:03,690
is not has<font color="#E5E5E5"> not the reputation of being</font>

744
00:33:02,110 --> 00:33:06,479
<font color="#CCCCCC">the most scalable thing out there but</font>

745
00:33:03,690 --> 00:33:10,800
there are<font color="#E5E5E5"> scalable libraries available</font>

746
00:33:06,480 --> 00:33:14,920
<font color="#CCCCCC">pandas numpy scifi</font><font color="#E5E5E5"> are are some of them</font>

747
00:33:10,800 --> 00:33:20,169
for<font color="#CCCCCC"> example</font><font color="#E5E5E5"> reading and writing CSV file</font>

748
00:33:14,920 --> 00:33:21,539
<font color="#E5E5E5">the library from</font><font color="#CCCCCC"> panda is insanely</font>

749
00:33:20,170 --> 00:33:25,679
faster than

750
00:33:21,539 --> 00:33:29,070
using the built-in Python<font color="#CCCCCC"> one</font><font color="#E5E5E5"> I also</font>

751
00:33:25,679 --> 00:33:33,119
tend to paralyze all the<font color="#E5E5E5"> CPU or</font><font color="#CCCCCC"> hi-oh</font>

752
00:33:29,070 --> 00:33:35,609
<font color="#E5E5E5">every task using an independent script</font>

753
00:33:33,119 --> 00:33:37,918
which I call from the ipython<font color="#E5E5E5"> kernel and</font>

754
00:33:35,609 --> 00:33:39,720
I used new parallel<font color="#E5E5E5"> the new parallel is</font>

755
00:33:37,919 --> 00:33:41,940
like<font color="#E5E5E5"> X</font><font color="#CCCCCC"> args for those who are</font><font color="#E5E5E5"> not</font>

756
00:33:39,720 --> 00:33:43,799
familiar<font color="#E5E5E5"> with it but it</font><font color="#CCCCCC"> just it finds</font>

757
00:33:41,940 --> 00:33:46,440
out<font color="#E5E5E5"> how many cores you have and it will</font>

758
00:33:43,799 --> 00:33:48,929
automatically do a job<font color="#E5E5E5"> per core without</font>

759
00:33:46,440 --> 00:33:51,779
having you type<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> so it's really</font>

760
00:33:48,929 --> 00:33:55,259
<font color="#E5E5E5">really cool to</font><font color="#CCCCCC"> do what I do with it</font><font color="#E5E5E5"> is</font>

761
00:33:51,779 --> 00:33:57,690
<font color="#E5E5E5">at mighty shark log analysis</font><font color="#CCCCCC"> so I have</font>

762
00:33:55,259 --> 00:33:59,879
<font color="#E5E5E5">one-liners with</font><font color="#CCCCCC"> t shark</font><font color="#E5E5E5"> who extract</font><font color="#CCCCCC"> the</font>

763
00:33:57,690 --> 00:34:03,419
<font color="#E5E5E5">data I'm interested</font><font color="#CCCCCC"> in collected through</font>

764
00:33:59,879 --> 00:34:05,908
parallel so I actually<font color="#E5E5E5"> crunch 12 a</font><font color="#CCCCCC"> pcap</font>

765
00:34:03,419 --> 00:34:07,889
at the same time and it will<font color="#E5E5E5"> do the</font>

766
00:34:05,909 --> 00:34:11,780
reordering<font color="#E5E5E5"> of the log and all that good</font>

767
00:34:07,889 --> 00:34:14,578
<font color="#CCCCCC">stuff for you free for</font><font color="#E5E5E5"> free</font><font color="#CCCCCC"> so I use</font>

768
00:34:11,780 --> 00:34:17,369
specific<font color="#CCCCCC"> tools of specific data</font><font color="#E5E5E5"> t shark</font>

769
00:34:14,579 --> 00:34:19,919
for pcap the manual proxy library for

770
00:34:17,369 --> 00:34:21,929
the manual<font color="#E5E5E5"> proxy logs of course in the</font>

771
00:34:19,918 --> 00:34:24,929
future slide I have a lot of ideas

772
00:34:21,929 --> 00:34:31,040
<font color="#CCCCCC">because I know it's pretty</font><font color="#E5E5E5"> medieval or</font>

773
00:34:24,929 --> 00:34:33,540
<font color="#CCCCCC">low-level</font><font color="#E5E5E5"> type stuff right now</font><font color="#CCCCCC"> so let me</font>

774
00:34:31,040 --> 00:34:38,639
get<font color="#CCCCCC"> into story time</font>

775
00:34:33,540 --> 00:34:42,529
three<font color="#CCCCCC"> cases of IOT malware</font><font color="#E5E5E5"> stories first</font>

776
00:34:38,639 --> 00:34:45,389
is a<font color="#E5E5E5"> MIPS wrapper so a dropper in the</font>

777
00:34:42,530 --> 00:34:47,790
traditional malware is a piece<font color="#E5E5E5"> of code</font>

778
00:34:45,389 --> 00:34:49,799
<font color="#CCCCCC">that doesn't</font><font color="#E5E5E5"> reveal any intention so</font>

779
00:34:47,790 --> 00:34:51,599
that you're not you<font color="#CCCCCC"> don't know what the</font>

780
00:34:49,799 --> 00:34:54,599
malware actually does all<font color="#CCCCCC"> it does it it</font>

781
00:34:51,599 --> 00:34:56,700
fetches the<font color="#E5E5E5"> net</font><font color="#CCCCCC"> the next stage of the of</font>

782
00:34:54,599 --> 00:34:58,530
the<font color="#E5E5E5"> malware which is good because it</font>

783
00:34:56,699 --> 00:35:01,439
<font color="#E5E5E5">usually avoids</font><font color="#CCCCCC"> a honeypot</font><font color="#E5E5E5"> which is</font>

784
00:34:58,530 --> 00:35:04,170
exactly what happens in<font color="#E5E5E5"> our case so it's</font>

785
00:35:01,440 --> 00:35:06,630
a short binary code which<font color="#E5E5E5"> is probably</font>

786
00:35:04,170 --> 00:35:09,480
written<font color="#E5E5E5"> by hand whose goal is</font><font color="#CCCCCC"> to avoid</font>

787
00:35:06,630 --> 00:35:11,700
<font color="#E5E5E5">the low interaction honeypot it's this</font>

788
00:35:09,480 --> 00:35:17,579
is all of<font color="#E5E5E5"> it like this is really really</font>

789
00:35:11,700 --> 00:35:22,410
small<font color="#CCCCCC"> what it does is it creates a</font>

790
00:35:17,579 --> 00:35:25,950
socket connects to an IP port it will

791
00:35:22,410 --> 00:35:29,368
<font color="#CCCCCC">loop there's a one important loop in</font>

792
00:35:25,950 --> 00:35:32,129
there<font color="#CCCCCC"> it will do a receive and then</font><font color="#E5E5E5"> I</font>

793
00:35:29,369 --> 00:35:35,370
write on a file descriptor<font color="#E5E5E5"> and then it</font>

794
00:35:32,130 --> 00:35:40,920
will close and<font color="#E5E5E5"> that's it so it's really</font>

795
00:35:35,370 --> 00:35:45,210
really<font color="#CCCCCC"> lean code</font><font color="#E5E5E5"> but of course</font><font color="#CCCCCC"> oh this</font>

796
00:35:40,920 --> 00:35:47,070
is what it<font color="#E5E5E5"> does</font><font color="#CCCCCC"> weather is good well not</font>

797
00:35:45,210 --> 00:35:50,100
good but the reason<font color="#E5E5E5"> this</font><font color="#CCCCCC"> thing exists is</font>

798
00:35:47,070 --> 00:35:55,200
because<font color="#CCCCCC"> it bypasses my honeypot</font><font color="#E5E5E5"> my honey</font>

799
00:35:50,100 --> 00:35:57,360
pot does not execute<font color="#E5E5E5"> native elf binaries</font>

800
00:35:55,200 --> 00:36:03,330
this is the reason why you go<font color="#CCCCCC"> with a low</font>

801
00:35:57,360 --> 00:36:05,700
interaction one<font color="#E5E5E5"> and so this is why they</font>

802
00:36:03,330 --> 00:36:08,730
are<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> that so what I</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to do now</font>

803
00:36:05,700 --> 00:36:11,250
is to<font color="#CCCCCC"> actually when I get a dropper</font><font color="#E5E5E5"> drop</font>

804
00:36:08,730 --> 00:36:13,590
at the<font color="#CCCCCC"> same time I should look at</font><font color="#E5E5E5"> the</font>

805
00:36:11,250 --> 00:36:15,450
sample<font color="#E5E5E5"> find the IP and then connect and</font>

806
00:36:13,590 --> 00:36:17,610
download<font color="#CCCCCC"> the file to</font><font color="#E5E5E5"> have the stage</font><font color="#CCCCCC"> to</font>

807
00:36:15,450 --> 00:36:20,790
which I haven't done because I've been

808
00:36:17,610 --> 00:36:22,110
focusing on the other stories<font color="#E5E5E5"> but this</font>

809
00:36:20,790 --> 00:36:27,810
is something<font color="#CCCCCC"> that we'll see in the</font>

810
00:36:22,110 --> 00:36:30,980
future<font color="#CCCCCC"> slide let me show you oh this is</font>

811
00:36:27,810 --> 00:36:30,980
not gonna work

812
00:36:37,320 --> 00:36:42,420
so let me<font color="#CCCCCC"> show you a replay of that log</font>

813
00:36:40,320 --> 00:36:44,490
so well<font color="#E5E5E5"> I what</font><font color="#CCCCCC"> you saw is the</font><font color="#E5E5E5"> binary</font>

814
00:36:42,420 --> 00:36:47,460
file<font color="#CCCCCC"> but now I'll show you the the way</font>

815
00:36:44,490 --> 00:36:55,529
<font color="#CCCCCC">that</font><font color="#E5E5E5"> the malware the the the infection</font>

816
00:36:47,460 --> 00:36:57,810
<font color="#CCCCCC">happens so</font><font color="#E5E5E5"> whoops so this is the the the</font>

817
00:36:55,530 --> 00:37:00,660
tool I was talking to you about earlier

818
00:36:57,810 --> 00:37:02,490
play log which which takes the the log

819
00:37:00,660 --> 00:37:04,830
file<font color="#CCCCCC"> the binary log file of the</font><font color="#E5E5E5"> curry</font>

820
00:37:02,490 --> 00:37:07,979
system and<font color="#CCCCCC"> will</font><font color="#E5E5E5"> replay it realistically</font>

821
00:37:04,830 --> 00:37:10,470
there's a bit<font color="#CCCCCC"> of a glitch inside because</font>

822
00:37:07,980 --> 00:37:13,050
it<font color="#E5E5E5"> curry doesn't do well there the pipe</font>

823
00:37:10,470 --> 00:37:16,350
redirection<font color="#CCCCCC"> of files but you'll see</font>

824
00:37:13,050 --> 00:37:18,330
anyway<font color="#CCCCCC"> what the operator is doing so</font>

825
00:37:16,350 --> 00:37:20,040
they got a shell the echo welcome so

826
00:37:18,330 --> 00:37:22,290
this is part of their fingerprinting of

827
00:37:20,040 --> 00:37:24,480
the environment<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they are in they</font>

828
00:37:22,290 --> 00:37:30,860
will try to CD into<font color="#E5E5E5"> temp which will fail</font>

829
00:37:24,480 --> 00:37:30,860
<font color="#E5E5E5">they then try to echo going too fast</font>

830
00:37:34,460 --> 00:37:42,780
<font color="#CCCCCC">alright so the it completed okay</font><font color="#E5E5E5"> so what</font>

831
00:37:41,010 --> 00:37:46,320
they do here is is<font color="#E5E5E5"> quite interesting so</font>

832
00:37:42,780 --> 00:37:49,590
<font color="#E5E5E5">this is in line data transfer so instead</font>

833
00:37:46,320 --> 00:37:51,630
of<font color="#CCCCCC"> doing W get to fetch a binary file</font>

834
00:37:49,590 --> 00:37:54,060
which is something that<font color="#CCCCCC"> calories support</font>

835
00:37:51,630 --> 00:37:56,400
<font color="#E5E5E5">carry will automatically set aside</font>

836
00:37:54,060 --> 00:37:58,620
anything<font color="#CCCCCC"> that is that you try to</font><font color="#E5E5E5"> W get</font>

837
00:37:56,400 --> 00:38:01,050
for you to<font color="#CCCCCC"> analyze so what they've</font><font color="#E5E5E5"> done</font>

838
00:37:58,620 --> 00:38:03,630
instead is<font color="#E5E5E5"> they</font><font color="#CCCCCC"> pass the data in line</font>

839
00:38:01,050 --> 00:38:07,140
and they test it<font color="#E5E5E5"> first so they use echo</font>

840
00:38:03,630 --> 00:38:10,680
-<font color="#CCCCCC"> E and X file</font><font color="#E5E5E5"> and they realize</font><font color="#CCCCCC"> ok this</font>

841
00:38:07,140 --> 00:38:13,560
<font color="#E5E5E5">works</font><font color="#CCCCCC"> so gathering this output it says</font>

842
00:38:10,680 --> 00:38:16,589
<font color="#CCCCCC">ok I can infect this environment</font><font color="#E5E5E5"> so I</font>

843
00:38:13,560 --> 00:38:19,140
will<font color="#E5E5E5"> continue so the RM files that don't</font>

844
00:38:16,590 --> 00:38:21,290
exist<font color="#E5E5E5"> but it's not really important they</font>

845
00:38:19,140 --> 00:38:26,460
touch a file and<font color="#E5E5E5"> they make</font><font color="#CCCCCC"> it executable</font>

846
00:38:21,290 --> 00:38:29,970
<font color="#CCCCCC">right here SMUD and then you see that</font>

847
00:38:26,460 --> 00:38:32,670
the echo file transfer<font color="#E5E5E5"> will happen so</font>

848
00:38:29,970 --> 00:38:35,640
and for no newline and<font color="#CCCCCC"> E for evaluate</font>

849
00:38:32,670 --> 00:38:38,430
the backslash<font color="#E5E5E5"> something and then it will</font>

850
00:38:35,640 --> 00:38:40,350
redirect it<font color="#CCCCCC"> to draw</font><font color="#E5E5E5"> now there is a few</font>

851
00:38:38,430 --> 00:38:42,359
output glitches there shouldn't be two

852
00:38:40,350 --> 00:38:44,640
backslashes<font color="#CCCCCC"> and you shouldn't see the</font>

853
00:38:42,360 --> 00:38:47,490
elf header<font color="#E5E5E5"> here it should all be hidden</font>

854
00:38:44,640 --> 00:38:49,970
and<font color="#CCCCCC"> filesystem</font><font color="#E5E5E5"> artifacts and</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font>

855
00:38:47,490 --> 00:38:52,459
console but these are the

856
00:38:49,970 --> 00:38:54,439
glitches<font color="#CCCCCC"> I mentioned you earlier so now</font>

857
00:38:52,460 --> 00:38:56,869
<font color="#CCCCCC">you see that the whole binary file is</font>

858
00:38:54,440 --> 00:38:59,390
all in there and<font color="#CCCCCC"> then at the end it will</font>

859
00:38:56,869 --> 00:39:01,430
try to execute<font color="#E5E5E5"> it but because of the</font>

860
00:38:59,390 --> 00:39:02,660
constraint of<font color="#E5E5E5"> our environment it will</font>

861
00:39:01,430 --> 00:39:05,540
say<font color="#CCCCCC"> command not</font><font color="#E5E5E5"> found and it will</font>

862
00:39:02,660 --> 00:39:08,330
actually<font color="#CCCCCC"> not</font><font color="#E5E5E5"> execute it</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is cool</font>

863
00:39:05,540 --> 00:39:10,490
because you see that the evolution of

864
00:39:08,330 --> 00:39:13,340
the bad guys that<font color="#CCCCCC"> now</font><font color="#E5E5E5"> know or realize</font>

865
00:39:10,490 --> 00:39:16,339
that they need to<font color="#E5E5E5"> use stagers like they</font>

866
00:39:13,340 --> 00:39:17,990
do<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the windows world for years so</font>

867
00:39:16,340 --> 00:39:21,140
this<font color="#E5E5E5"> is the investigation is to be</font>

868
00:39:17,990 --> 00:39:22,939
continued<font color="#CCCCCC"> I focused on Linux moves more</font>

869
00:39:21,140 --> 00:39:25,069
which I'm I'm<font color="#E5E5E5"> coming up lately</font>

870
00:39:22,940 --> 00:39:27,440
I noticed that malware must die did a

871
00:39:25,070 --> 00:39:28,790
blog post<font color="#E5E5E5"> this week on a similar dropper</font>

872
00:39:27,440 --> 00:39:31,250
<font color="#E5E5E5">I don't think it is the same one because</font>

873
00:39:28,790 --> 00:39:32,990
they<font color="#CCCCCC"> talked about</font><font color="#E5E5E5"> strings specific</font>

874
00:39:31,250 --> 00:39:35,599
strings that and this sample<font color="#CCCCCC"> has</font>

875
00:39:32,990 --> 00:39:38,149
absolutely no strings<font color="#E5E5E5"> in it it's all</font>

876
00:39:35,599 --> 00:39:41,530
except the<font color="#E5E5E5"> sections strings which are</font>

877
00:39:38,150 --> 00:39:43,970
standard<font color="#E5E5E5"> but it could be the same thing</font>

878
00:39:41,530 --> 00:39:46,160
<font color="#E5E5E5">another case I wanted to talk about is</font>

879
00:39:43,970 --> 00:39:49,939
lizard squad so linear lizard squad is

880
00:39:46,160 --> 00:39:52,910
actually detected by<font color="#E5E5E5"> antivirus as gasket</font>

881
00:39:49,940 --> 00:39:56,740
malware and lizard squad is famous for

882
00:39:52,910 --> 00:40:00,049
their use of<font color="#E5E5E5"> the kind of fancy lizard</font>

883
00:39:56,740 --> 00:40:02,149
<font color="#E5E5E5">image so this is a blackhat hacking</font>

884
00:40:00,050 --> 00:40:04,670
group<font color="#E5E5E5"> lots of distributed and I have</font>

885
00:40:02,150 --> 00:40:07,250
service attack<font color="#CCCCCC"> as it's the guys that did</font>

886
00:40:04,670 --> 00:40:10,970
the a PlayStation Network and<font color="#E5E5E5"> Xbox</font><font color="#CCCCCC"> Live</font>

887
00:40:07,250 --> 00:40:13,490
<font color="#CCCCCC">takedown in 2014 and they did bomb</font>

888
00:40:10,970 --> 00:40:16,220
threats also<font color="#CCCCCC"> to prominent people like a</font>

889
00:40:13,490 --> 00:40:19,939
vice president of Sony Pictures<font color="#CCCCCC"> or Sony</font>

890
00:40:16,220 --> 00:40:21,830
and<font color="#E5E5E5"> PlayStation</font><font color="#CCCCCC"> they said that</font><font color="#E5E5E5"> he was</font>

891
00:40:19,940 --> 00:40:24,560
<font color="#E5E5E5">carrying a bomb and so they landed the</font>

892
00:40:21,830 --> 00:40:27,250
plane and it<font color="#E5E5E5"> was a mess</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this</font>

893
00:40:24,560 --> 00:40:29,720
attracted them a lot of<font color="#CCCCCC"> law-enforcement</font>

894
00:40:27,250 --> 00:40:31,190
<font color="#E5E5E5">interaction and they were arrested</font><font color="#CCCCCC"> in</font>

895
00:40:29,720 --> 00:40:33,859
August of 2015

896
00:40:31,190 --> 00:40:35,960
well six<font color="#E5E5E5"> of them but again on Twitter</font>

897
00:40:33,859 --> 00:40:39,109
they always say hahaha<font color="#CCCCCC"> you never took us</font>

898
00:40:35,960 --> 00:40:41,570
down we<font color="#CCCCCC"> are you know more</font><font color="#E5E5E5"> than</font><font color="#CCCCCC"> just</font>

899
00:40:39,109 --> 00:40:44,450
people we are something greater or

900
00:40:41,570 --> 00:40:46,880
something<font color="#E5E5E5"> so I define them as little</font>

901
00:40:44,450 --> 00:40:50,060
<font color="#E5E5E5">cyber Rascals</font><font color="#CCCCCC"> so they're not</font><font color="#E5E5E5"> they're</font>

902
00:40:46,880 --> 00:40:51,859
more annoying than<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> but with the</font>

903
00:40:50,060 --> 00:40:52,279
latest<font color="#CCCCCC"> DDoS it's more complicated</font><font color="#E5E5E5"> than</font>

904
00:40:51,859 --> 00:40:53,930
that

905
00:40:52,280 --> 00:40:56,660
<font color="#E5E5E5">but what is interesting me more than</font>

906
00:40:53,930 --> 00:40:58,609
<font color="#E5E5E5">that is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the when I realize that</font>

907
00:40:56,660 --> 00:41:01,339
<font color="#E5E5E5">they are running all this on</font><font color="#CCCCCC"> hacked</font>

908
00:40:58,609 --> 00:41:02,690
routers<font color="#E5E5E5"> home routers which is the</font>

909
00:41:01,339 --> 00:41:05,509
malware part

910
00:41:02,690 --> 00:41:09,230
so when I was tracking<font color="#E5E5E5"> this</font><font color="#CCCCCC"> tread I</font>

911
00:41:05,510 --> 00:41:12,050
realized that the source<font color="#E5E5E5"> code for gasket</font>

912
00:41:09,230 --> 00:41:13,880
was leaked<font color="#E5E5E5"> and that there is a ton of</font>

913
00:41:12,050 --> 00:41:17,000
version so pal but either

914
00:41:13,880 --> 00:41:19,460
<font color="#CCCCCC">Katyn are all kind of modifications on</font>

915
00:41:17,000 --> 00:41:21,260
<font color="#CCCCCC">the same hour</font><font color="#E5E5E5"> then there is probably</font><font color="#CCCCCC"> a</font>

916
00:41:19,460 --> 00:41:23,870
ton of other as the source is public

917
00:41:21,260 --> 00:41:27,110
<font color="#E5E5E5">what it does is it has a telnet scanner</font>

918
00:41:23,870 --> 00:41:30,080
<font color="#E5E5E5">UDP TCP junk and hold flooding mechanism</font>

919
00:41:27,110 --> 00:41:32,690
and it supports a<font color="#CCCCCC"> lot of architectures</font>

920
00:41:30,080 --> 00:41:37,750
super<font color="#CCCCCC"> H which</font><font color="#E5E5E5"> is like architecture for</font>

921
00:41:32,690 --> 00:41:45,380
<font color="#E5E5E5">oh I'm sorry that's why no one is</font>

922
00:41:37,750 --> 00:41:52,490
<font color="#CCCCCC">laughing</font><font color="#E5E5E5"> at my pictures I'm really sorry</font>

923
00:41:45,380 --> 00:41:55,340
<font color="#CCCCCC">okay so this is quad the lizard yeah</font>

924
00:41:52,490 --> 00:41:59,479
PlayStation Network Xbox<font color="#CCCCCC"> Live cyber</font>

925
00:41:55,340 --> 00:42:04,040
Rascals<font color="#E5E5E5"> and</font><font color="#CCCCCC"> crabs</font><font color="#E5E5E5"> who published in</font>

926
00:41:59,480 --> 00:42:07,340
January last<font color="#E5E5E5"> year that they were it</font><font color="#CCCCCC"> was</font>

927
00:42:04,040 --> 00:42:10,300
an embedded system malware the different

928
00:42:07,340 --> 00:42:12,770
strain of<font color="#E5E5E5"> malware that</font><font color="#CCCCCC"> I looked at</font><font color="#E5E5E5"> and</font>

929
00:42:10,300 --> 00:42:14,360
so the architecture<font color="#CCCCCC"> I was going to say</font>

930
00:42:12,770 --> 00:42:16,370
super<font color="#CCCCCC"> H which is</font><font color="#E5E5E5"> interesting cause it</font>

931
00:42:14,360 --> 00:42:18,230
only runs<font color="#CCCCCC"> in</font><font color="#E5E5E5"> like Toshiba cameras or</font>

932
00:42:16,370 --> 00:42:20,480
stuff like<font color="#CCCCCC"> that really rare architecture</font>

933
00:42:18,230 --> 00:42:24,350
either has really bad support for it

934
00:42:20,480 --> 00:42:26,720
<font color="#CCCCCC">mips</font><font color="#E5E5E5"> arm x86 PowerPC so you see x86 so</font>

935
00:42:24,350 --> 00:42:29,569
this<font color="#CCCCCC"> thread will also infect servers</font>

936
00:42:26,720 --> 00:42:33,259
which means that we're not<font color="#E5E5E5"> when we're</font>

937
00:42:29,570 --> 00:42:35,090
saying that it's hacked home routers

938
00:42:33,260 --> 00:42:38,570
we're kind of being<font color="#E5E5E5"> misleading here</font>

939
00:42:35,090 --> 00:42:40,130
we're attacking embedded<font color="#CCCCCC"> Linux</font><font color="#E5E5E5"> not even</font>

940
00:42:38,570 --> 00:42:42,770
embedded<font color="#E5E5E5"> why attacking Linux system</font>

941
00:42:40,130 --> 00:42:45,260
which has a telnet<font color="#CCCCCC"> open and we</font>

942
00:42:42,770 --> 00:42:47,390
credentials so the the in the server

943
00:42:45,260 --> 00:42:48,920
source code we can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> that they assume</font>

944
00:42:47,390 --> 00:42:51,020
though<font color="#CCCCCC"> that they will</font><font color="#E5E5E5"> infect embedded</font>

945
00:42:48,920 --> 00:42:53,000
systems because they stated<font color="#E5E5E5"> in a new</font>

946
00:42:51,020 --> 00:42:55,600
version<font color="#CCCCCC"> that it now have refrigerator</font>

947
00:42:53,000 --> 00:42:57,980
support<font color="#E5E5E5"> they're kind of proud of that</font>

948
00:42:55,600 --> 00:43:00,290
the attack vectors that<font color="#E5E5E5"> they use a shell</font>

949
00:42:57,980 --> 00:43:02,450
<font color="#E5E5E5">shock</font><font color="#CCCCCC"> ssh credential brute-force telnet</font>

950
00:43:00,290 --> 00:43:05,180
credential brute force<font color="#E5E5E5"> here's an example</font>

951
00:43:02,450 --> 00:43:08,899
of the shell shock<font color="#CCCCCC"> so it</font><font color="#E5E5E5"> uses it relies</font>

952
00:43:05,180 --> 00:43:11,690
on a CGI bin<font color="#CCCCCC"> that will</font><font color="#E5E5E5"> eventually call</font>

953
00:43:08,900 --> 00:43:15,110
bash and they do the<font color="#CCCCCC"> the famous</font><font color="#E5E5E5"> shell</font>

954
00:43:11,690 --> 00:43:16,460
shock signature here<font color="#E5E5E5"> and the payload is</font>

955
00:43:15,110 --> 00:43:20,060
a double you get of a<font color="#E5E5E5"> screen</font>

956
00:43:16,460 --> 00:43:21,980
interestingly the script will download<font color="#CCCCCC"> w</font>

957
00:43:20,060 --> 00:43:24,860
get all of the different<font color="#CCCCCC"> malware samples</font>

958
00:43:21,980 --> 00:43:26,780
and<font color="#CCCCCC"> will try to</font><font color="#E5E5E5"> execute all</font><font color="#CCCCCC"> of them so</font>

959
00:43:24,860 --> 00:43:28,730
from<font color="#E5E5E5"> a malware analysis perspective this</font>

960
00:43:26,780 --> 00:43:31,220
<font color="#E5E5E5">is great because</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> get to choose what</font>

961
00:43:28,730 --> 00:43:33,470
binary<font color="#E5E5E5"> I will reverse engineer Sam if</font>

962
00:43:31,220 --> 00:43:35,450
I'm<font color="#E5E5E5"> more familiar with arm</font><font color="#CCCCCC"> I choose to</font>

963
00:43:33,470 --> 00:43:37,009
analyze<font color="#E5E5E5"> the arm binary if I'm more</font>

964
00:43:35,450 --> 00:43:40,129
<font color="#E5E5E5">familiar with</font><font color="#CCCCCC"> MIPS the miss my enemy or</font>

965
00:43:37,010 --> 00:43:41,540
even x86<font color="#E5E5E5"> because of the way they</font>

966
00:43:40,130 --> 00:43:43,610
distribute their their thing they

967
00:43:41,540 --> 00:43:46,180
<font color="#E5E5E5">download all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the code</font><font color="#CCCCCC"> that they</font><font color="#E5E5E5"> have</font>

968
00:43:43,610 --> 00:43:49,310
ever<font color="#E5E5E5"> built and they try to</font><font color="#CCCCCC"> run all of</font><font color="#E5E5E5"> it</font>

969
00:43:46,180 --> 00:43:51,589
we've studied other variants<font color="#E5E5E5"> some with</font>

970
00:43:49,310 --> 00:43:53,810
HTTP support some with<font color="#E5E5E5"> CloudFlare</font>

971
00:43:51,590 --> 00:43:58,610
protection bypasses here's the

972
00:43:53,810 --> 00:44:00,950
<font color="#E5E5E5">CloudFlare bypass code pretty complex it</font>

973
00:43:58,610 --> 00:44:03,590
has<font color="#CCCCCC"> a lecture that will emulate the</font>

974
00:44:00,950 --> 00:44:06,649
<font color="#E5E5E5">JavaScript challenge that is in the</font>

975
00:44:03,590 --> 00:44:08,240
<font color="#CCCCCC">CloudFlare defensive mechanism</font><font color="#E5E5E5"> of course</font>

976
00:44:06,650 --> 00:44:09,860
as soon<font color="#CCCCCC"> as</font><font color="#E5E5E5"> cloud</font><font color="#CCCCCC"> service aware of that</font>

977
00:44:08,240 --> 00:44:11,620
they can<font color="#E5E5E5"> change the</font><font color="#CCCCCC"> algorithm and they</font>

978
00:44:09,860 --> 00:44:15,440
will probably<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to really implement</font>

979
00:44:11,620 --> 00:44:17,450
<font color="#E5E5E5">their their support of it but anyway so</font>

980
00:44:15,440 --> 00:44:19,280
what is it sophisticated well they were

981
00:44:17,450 --> 00:44:21,230
<font color="#E5E5E5">their database with League the path</font>

982
00:44:19,280 --> 00:44:23,480
their passwords were stored in plain

983
00:44:21,230 --> 00:44:25,580
text for the lizard<font color="#CCCCCC"> stresser service so</font>

984
00:44:23,480 --> 00:44:27,850
they're not like it doesn't<font color="#E5E5E5"> seem all</font>

985
00:44:25,580 --> 00:44:31,009
that coordinated or sophisticated

986
00:44:27,850 --> 00:44:34,700
<font color="#CCCCCC">there's the the convenient control</font>

987
00:44:31,010 --> 00:44:37,490
mechanism is via IRC you can log in and

988
00:44:34,700 --> 00:44:41,680
participate and list the<font color="#CCCCCC"> amount of bots</font>

989
00:44:37,490 --> 00:44:44,540
so here<font color="#E5E5E5"> the this server had</font><font color="#CCCCCC"> 2000 bots</font>

990
00:44:41,680 --> 00:44:48,440
<font color="#E5E5E5">you can see the</font><font color="#CCCCCC"> buck masters</font><font color="#E5E5E5"> and you can</font>

991
00:44:44,540 --> 00:44:51,529
see them chat which<font color="#E5E5E5"> is again not that</font>

992
00:44:48,440 --> 00:44:53,660
<font color="#E5E5E5">good</font><font color="#CCCCCC"> from an operation standpoint the</font>

993
00:44:51,530 --> 00:44:57,160
targets<font color="#E5E5E5"> that at the time</font><font color="#CCCCCC"> that I studied</font>

994
00:44:53,660 --> 00:44:58,670
this<font color="#CCCCCC"> we're all gamer related targets</font><font color="#E5E5E5"> so</font>

995
00:44:57,160 --> 00:45:01,399
DSL lines

996
00:44:58,670 --> 00:45:03,020
<font color="#E5E5E5">game hosting company Blizzard and stuff</font>

997
00:45:01,400 --> 00:45:05,540
like that<font color="#E5E5E5"> so they were trying to win a</font>

998
00:45:03,020 --> 00:45:09,740
<font color="#E5E5E5">game by</font><font color="#CCCCCC"> DDoS saying</font><font color="#E5E5E5"> the opponent pretty</font>

999
00:45:05,540 --> 00:45:11,870
much so to wrap up<font color="#CCCCCC"> lizard squad</font><font color="#E5E5E5"> since</font>

1000
00:45:09,740 --> 00:45:14,600
<font color="#CCCCCC">their source</font><font color="#E5E5E5"> code was leaked it is very</font>

1001
00:45:11,870 --> 00:45:17,060
prevalent<font color="#E5E5E5"> and now operated by numerous</font>

1002
00:45:14,600 --> 00:45:21,170
unrelated actors and<font color="#CCCCCC"> it's still focused</font>

1003
00:45:17,060 --> 00:45:23,900
very much on DDoS and effective Linux

1004
00:45:21,170 --> 00:45:27,020
moves<font color="#E5E5E5"> so Linux mousse is a stealthy but</font>

1005
00:45:23,900 --> 00:45:28,910
who monetizes<font color="#E5E5E5"> its activities by selling</font>

1006
00:45:27,020 --> 00:45:30,099
fraudulent<font color="#E5E5E5"> followers on Instagram</font>

1007
00:45:28,910 --> 00:45:32,618
Twitter YouTube and

1008
00:45:30,099 --> 00:45:35,499
social networks<font color="#E5E5E5"> so it's very different</font>

1009
00:45:32,619 --> 00:45:37,720
<font color="#E5E5E5">than the</font><font color="#CCCCCC"> other it</font><font color="#E5E5E5"> doesn't have x86 code</font>

1010
00:45:35,499 --> 00:45:38,709
at all<font color="#E5E5E5"> so they definitely want to stay</font>

1011
00:45:37,720 --> 00:45:41,439
under<font color="#CCCCCC"> the radar</font>

1012
00:45:38,710 --> 00:45:43,150
there is no persistence<font color="#CCCCCC"> so if you reboot</font>

1013
00:45:41,440 --> 00:45:45,670
your<font color="#CCCCCC"> router</font><font color="#E5E5E5"> you are no longer infected</font>

1014
00:45:43,150 --> 00:45:47,529
anymore but they entered via<font color="#E5E5E5"> we</font>

1015
00:45:45,670 --> 00:45:51,400
credentials on telnet so they can still

1016
00:45:47,529 --> 00:45:53,499
reinfect you at<font color="#E5E5E5"> another point in time</font><font color="#CCCCCC"> we</font>

1017
00:45:51,400 --> 00:45:55,690
I published an extensive<font color="#E5E5E5"> report when I</font>

1018
00:45:53,499 --> 00:45:58,899
was working at ESET<font color="#E5E5E5"> on Linux moves that</font>

1019
00:45:55,690 --> 00:46:02,019
was really technical<font color="#CCCCCC"> building upon our</font>

1020
00:45:58,900 --> 00:46:05,229
2015<font color="#E5E5E5"> report we decided to do</font><font color="#CCCCCC"> a step</font>

1021
00:46:02,019 --> 00:46:11,078
further<font color="#E5E5E5"> and this is why I had</font><font color="#CCCCCC"> HTTPS</font>

1022
00:46:05,229 --> 00:46:13,808
<font color="#CCCCCC">man-in-the-middle attack in built in the</font>

1023
00:46:11,079 --> 00:46:15,970
honeypot system the the<font color="#CCCCCC"> way that they do</font>

1024
00:46:13,809 --> 00:46:18,130
the<font color="#E5E5E5"> social media interactions is through</font>

1025
00:46:15,970 --> 00:46:20,259
a socks proxy<font color="#CCCCCC"> so the sax proxy is the</font>

1026
00:46:18,130 --> 00:46:22,509
middle layer<font color="#E5E5E5"> so he said that TCP is</font>

1027
00:46:20,259 --> 00:46:24,759
<font color="#CCCCCC">end-to-end</font><font color="#E5E5E5"> with the through the infected</font>

1028
00:46:22,509 --> 00:46:26,019
<font color="#CCCCCC">host</font><font color="#E5E5E5"> sucks proxy is kind of a</font><font color="#CCCCCC"> virtual</font>

1029
00:46:24,759 --> 00:46:28,839
tunnel<font color="#E5E5E5"> which will go</font><font color="#CCCCCC"> through the</font>

1030
00:46:26,019 --> 00:46:32,859
targeted social network and they had

1031
00:46:28,839 --> 00:46:34,839
<font color="#CCCCCC">HTTP</font><font color="#E5E5E5"> running on top of the</font><font color="#CCCCCC"> socks tunnel</font>

1032
00:46:32,859 --> 00:46:37,058
<font color="#E5E5E5">which means that I couldn't see what</font>

1033
00:46:34,839 --> 00:46:38,890
they were doing<font color="#CCCCCC"> I saw because</font><font color="#E5E5E5"> of the C</font>

1034
00:46:37,059 --> 00:46:43,450
name<font color="#E5E5E5"> of the certificates</font><font color="#CCCCCC"> that they were</font>

1035
00:46:38,890 --> 00:46:45,098
reaching<font color="#E5E5E5"> out to Instagram Facebook</font><font color="#CCCCCC"> and</font>

1036
00:46:43,450 --> 00:46:47,078
stuff<font color="#E5E5E5"> like that I had</font><font color="#CCCCCC"> hostname in</font><font color="#E5E5E5"> this</font>

1037
00:46:45,099 --> 00:46:48,489
<font color="#CCCCCC">yen because this isn't clear text</font><font color="#E5E5E5"> but I</font>

1038
00:46:47,079 --> 00:46:51,130
couldn't see how they were interacting

1039
00:46:48,489 --> 00:46:53,049
<font color="#E5E5E5">who is buying who are the fake accounts</font>

1040
00:46:51,130 --> 00:46:56,650
and<font color="#E5E5E5"> stuff like that so what we</font><font color="#CCCCCC"> did is</font>

1041
00:46:53,049 --> 00:47:02,529
through<font color="#CCCCCC"> our man-in-the-middle</font><font color="#E5E5E5"> we you see</font>

1042
00:46:56,650 --> 00:47:05,140
the<font color="#E5E5E5"> week the</font><font color="#CCCCCC"> lightish purple and this</font><font color="#E5E5E5"> is</font>

1043
00:47:02,529 --> 00:47:07,479
where we terminated<font color="#E5E5E5"> at</font><font color="#CCCCCC"> the after</font><font color="#E5E5E5"> the</font>

1044
00:47:05,140 --> 00:47:09,969
infected host the the<font color="#CCCCCC"> ssl connection and</font>

1045
00:47:07,479 --> 00:47:13,989
we recreated a new one with the targeted

1046
00:47:09,969 --> 00:47:16,450
social<font color="#CCCCCC"> network we used certificates that</font>

1047
00:47:13,989 --> 00:47:19,180
were<font color="#E5E5E5"> mimicking security appliances</font>

1048
00:47:16,450 --> 00:47:20,859
<font color="#E5E5E5">because I was thinking they probably got</font>

1049
00:47:19,180 --> 00:47:22,839
errors all the time<font color="#E5E5E5"> because it's a</font>

1050
00:47:20,859 --> 00:47:25,660
<font color="#E5E5E5">button it on the internet with thousands</font>

1051
00:47:22,839 --> 00:47:27,960
<font color="#E5E5E5">of infected hosts so if I I I say I'm a</font>

1052
00:47:25,660 --> 00:47:30,368
blue coat or I say I'm a checkpoint

1053
00:47:27,960 --> 00:47:32,289
<font color="#E5E5E5">next-gen something probably that they</font>

1054
00:47:30,369 --> 00:47:34,900
will just click oh yeah it's<font color="#CCCCCC"> ok it's ok</font>

1055
00:47:32,289 --> 00:47:37,960
I need<font color="#CCCCCC"> to I need to</font><font color="#E5E5E5"> do my but net thing</font>

1056
00:47:34,900 --> 00:47:40,089
and that<font color="#CCCCCC"> bet worked</font><font color="#E5E5E5"> so I had clear text</font>

1057
00:47:37,960 --> 00:47:43,990
traffic of all of the interactions of

1058
00:47:40,089 --> 00:47:46,090
the<font color="#E5E5E5"> button app so we did this</font><font color="#CCCCCC"> attack for</font>

1059
00:47:43,990 --> 00:47:47,529
and we have a publication ready for

1060
00:47:46,090 --> 00:47:49,180
<font color="#E5E5E5">blackhat Europe in two weeks</font>

1061
00:47:47,530 --> 00:47:51,070
unfortunately I cannot

1062
00:47:49,180 --> 00:47:53,680
it's embargoed so I cannot disclose<font color="#E5E5E5"> more</font>

1063
00:47:51,070 --> 00:47:55,240
<font color="#E5E5E5">here but what we have</font><font color="#CCCCCC"> found out is that</font>

1064
00:47:53,680 --> 00:47:58,000
<font color="#E5E5E5">they're running a stealthy and</font>

1065
00:47:55,240 --> 00:47:59,979
profitable but<font color="#E5E5E5"> net while advertising</font><font color="#CCCCCC"> the</font>

1066
00:47:58,000 --> 00:48:02,470
services on the clear web so<font color="#CCCCCC"> they really</font>

1067
00:47:59,980 --> 00:48:06,160
sell directly to customer even<font color="#CCCCCC"> though</font>

1068
00:48:02,470 --> 00:48:09,310
it's an<font color="#E5E5E5"> illegal operation</font><font color="#CCCCCC"> and they sell</font>

1069
00:48:06,160 --> 00:48:11,529
the the follows or the likes to normal

1070
00:48:09,310 --> 00:48:15,700
<font color="#E5E5E5">people we studied like who was buying</font>

1071
00:48:11,530 --> 00:48:18,790
and we<font color="#E5E5E5"> found like models singers you</font>

1072
00:48:15,700 --> 00:48:22,270
know musicians<font color="#E5E5E5"> and stuff like that</font><font color="#CCCCCC"> the</font>

1073
00:48:18,790 --> 00:48:24,190
paper is<font color="#E5E5E5"> a go market when greed for fame</font>

1074
00:48:22,270 --> 00:48:28,330
benefits<font color="#E5E5E5"> a large scale but net and it</font>

1075
00:48:24,190 --> 00:48:30,310
will be released<font color="#CCCCCC"> also on our blog and as</font>

1076
00:48:28,330 --> 00:48:32,319
a PDF format<font color="#CCCCCC"> so there will</font><font color="#E5E5E5"> be a talk and</font>

1077
00:48:30,310 --> 00:48:34,990
all of that<font color="#E5E5E5"> so I encourage you</font><font color="#CCCCCC"> to look</font>

1078
00:48:32,320 --> 00:48:37,660
that<font color="#CCCCCC"> up in two</font><font color="#E5E5E5"> weeks</font>

1079
00:48:34,990 --> 00:48:39,729
future<font color="#CCCCCC"> work around the honeypot well for</font>

1080
00:48:37,660 --> 00:48:41,859
me the most interesting<font color="#E5E5E5"> from a technical</font>

1081
00:48:39,730 --> 00:48:43,480
standpoint is I want to<font color="#CCCCCC"> be able to</font>

1082
00:48:41,860 --> 00:48:45,820
collect<font color="#CCCCCC"> the</font><font color="#E5E5E5"> stage two samples</font>

1083
00:48:43,480 --> 00:48:49,720
automatically so I'm thinking of using

1084
00:48:45,820 --> 00:48:51,700
qmu in<font color="#CCCCCC"> its bin for map mode to be able</font>

1085
00:48:49,720 --> 00:48:54,879
<font color="#E5E5E5">to</font><font color="#CCCCCC"> run the elf with just the right</font>

1086
00:48:51,700 --> 00:48:57,220
<font color="#E5E5E5">amount</font><font color="#CCCCCC"> of user code so that it will it</font>

1087
00:48:54,880 --> 00:48:59,770
will obey<font color="#E5E5E5"> the</font><font color="#CCCCCC"> SIS calls that I saw in</font>

1088
00:48:57,220 --> 00:49:01,480
the samples that<font color="#E5E5E5"> I've analyzed</font><font color="#CCCCCC"> I want to</font>

1089
00:48:59,770 --> 00:49:04,240
emulate more type<font color="#E5E5E5"> of devices I'm</font>

1090
00:49:01,480 --> 00:49:06,250
thinking like<font color="#CCCCCC"> Fox net</font><font color="#E5E5E5"> SSH for example</font>

1091
00:49:04,240 --> 00:49:08,740
with the<font color="#CCCCCC"> backdoor key and see if</font>

1092
00:49:06,250 --> 00:49:10,510
someone's abusing it stuff like<font color="#CCCCCC"> that I</font>

1093
00:49:08,740 --> 00:49:15,129
want to<font color="#E5E5E5"> make it harder to fingerprint</font>

1094
00:49:10,510 --> 00:49:17,140
<font color="#E5E5E5">thank you</font><font color="#CCCCCC"> on the data analysis side</font><font color="#E5E5E5"> I</font>

1095
00:49:15,130 --> 00:49:20,950
want to<font color="#E5E5E5"> improve the visualization and</font>

1096
00:49:17,140 --> 00:49:23,170
data analysis pipeline<font color="#CCCCCC"> I need some</font>

1097
00:49:20,950 --> 00:49:26,529
<font color="#E5E5E5">either</font><font color="#CCCCCC"> Splunk or elk</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> gorillas</font>

1098
00:49:23,170 --> 00:49:31,090
something like that<font color="#E5E5E5"> i</font><font color="#CCCCCC"> andrew case stock</font>

1099
00:49:26,530 --> 00:49:32,740
this<font color="#E5E5E5"> morning</font><font color="#CCCCCC"> spoke</font><font color="#E5E5E5"> said that he was more</font>

1100
00:49:31,090 --> 00:49:35,230
encouraging me<font color="#CCCCCC"> to use the Splunk stack</font>

1101
00:49:32,740 --> 00:49:36,129
at a<font color="#E5E5E5"> sorry the</font><font color="#CCCCCC"> gorilla or elk stack</font>

1102
00:49:35,230 --> 00:49:38,080
<font color="#CCCCCC">instead of salon</font>

1103
00:49:36,130 --> 00:49:39,970
<font color="#CCCCCC">i still haven't</font><font color="#E5E5E5"> decided yet</font><font color="#CCCCCC"> if you have</font>

1104
00:49:38,080 --> 00:49:41,799
an<font color="#E5E5E5"> opinion on that or do similar work</font>

1105
00:49:39,970 --> 00:49:45,040
please come<font color="#E5E5E5"> and let me know</font>

1106
00:49:41,800 --> 00:49:46,390
I found<font color="#E5E5E5"> that elk was a lot of manual</font>

1107
00:49:45,040 --> 00:49:48,160
configuration and I'm sure that the

1108
00:49:46,390 --> 00:49:51,160
security<font color="#CCCCCC"> community could share some</font>

1109
00:49:48,160 --> 00:49:54,040
configs to save time for the<font color="#CCCCCC"> pcap</font>

1110
00:49:51,160 --> 00:49:56,319
analysis<font color="#E5E5E5"> I want to use</font><font color="#CCCCCC"> aol's Malo which</font>

1111
00:49:54,040 --> 00:49:57,670
is an amazing<font color="#CCCCCC"> product that</font><font color="#E5E5E5"> I've used</font><font color="#CCCCCC"> at</font>

1112
00:49:56,320 --> 00:49:59,680
<font color="#CCCCCC">ESET</font><font color="#E5E5E5"> at the time</font>

1113
00:49:57,670 --> 00:50:02,020
but I haven't<font color="#E5E5E5"> got the</font><font color="#CCCCCC"> time to</font><font color="#E5E5E5"> build</font><font color="#CCCCCC"> that</font>

1114
00:49:59,680 --> 00:50:04,629
into our system<font color="#E5E5E5"> and I want</font><font color="#CCCCCC"> to try</font>

1115
00:50:02,020 --> 00:50:07,900
<font color="#CCCCCC">ipython built-in</font><font color="#E5E5E5"> parallelization</font><font color="#CCCCCC"> API</font>

1116
00:50:04,630 --> 00:50:11,830
which also should improve the

1117
00:50:07,900 --> 00:50:14,920
man-in-the-middle proxy log analysis<font color="#CCCCCC"> for</font>

1118
00:50:11,830 --> 00:50:17,290
reverse<font color="#CCCCCC"> engineering I have the I hope</font><font color="#E5E5E5"> to</font>

1119
00:50:14,920 --> 00:50:19,630
be able<font color="#E5E5E5"> to build a</font><font color="#CCCCCC"> cert signature so</font>

1120
00:50:17,290 --> 00:50:22,390
that<font color="#E5E5E5"> more embedded devices architecture</font>

1121
00:50:19,630 --> 00:50:24,340
compilers and<font color="#E5E5E5"> C libraries are supported</font>

1122
00:50:22,390 --> 00:50:27,339
<font color="#E5E5E5">of course this will probably slow down</font>

1123
00:50:24,340 --> 00:50:30,190
<font color="#E5E5E5">the the either automatic loading process</font>

1124
00:50:27,340 --> 00:50:32,320
<font color="#E5E5E5">if it tries all of them but</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> we</font>

1125
00:50:30,190 --> 00:50:34,420
can strike a balance<font color="#E5E5E5"> between like</font><font color="#CCCCCC"> you</font>

1126
00:50:32,320 --> 00:50:37,180
put yourself into embedded reversing

1127
00:50:34,420 --> 00:50:39,550
mode and then try some<font color="#E5E5E5"> something</font><font color="#CCCCCC"> like</font>

1128
00:50:37,180 --> 00:50:41,919
<font color="#CCCCCC">that we'll see how that</font><font color="#E5E5E5"> goes</font>

1129
00:50:39,550 --> 00:50:47,200
it's I<font color="#E5E5E5"> would love to do that in the next</font>

1130
00:50:41,920 --> 00:50:50,860
<font color="#CCCCCC">six months</font><font color="#E5E5E5"> or something and last future</font>

1131
00:50:47,200 --> 00:50:54,279
slide if<font color="#CCCCCC"> you want is I would like</font><font color="#E5E5E5"> to fix</font>

1132
00:50:50,860 --> 00:50:56,620
the actual problem<font color="#E5E5E5"> as you saw it's not</font>

1133
00:50:54,280 --> 00:50:58,870
complicated<font color="#CCCCCC"> we're talking about</font><font color="#E5E5E5"> default</font>

1134
00:50:56,620 --> 00:51:03,910
credential and<font color="#E5E5E5"> expose management</font>

1135
00:50:58,870 --> 00:51:06,490
services<font color="#CCCCCC"> so the vendors should do per</font>

1136
00:51:03,910 --> 00:51:09,009
device credential big it can even be<font color="#CCCCCC"> the</font>

1137
00:51:06,490 --> 00:51:11,470
MAC address<font color="#CCCCCC"> of the thing if it's written</font>

1138
00:51:09,010 --> 00:51:13,300
on it I mean I don't mind also<font color="#E5E5E5"> if it's</font>

1139
00:51:11,470 --> 00:51:15,399
written the password on the device

1140
00:51:13,300 --> 00:51:17,920
because we're talking<font color="#E5E5E5"> you know but net</font>

1141
00:51:15,400 --> 00:51:20,410
<font color="#CCCCCC">large-scale automated there's no manual</font>

1142
00:51:17,920 --> 00:51:25,720
people doing any of<font color="#E5E5E5"> that</font><font color="#CCCCCC"> stuff well not</font>

1143
00:51:20,410 --> 00:51:27,790
at the honeypot<font color="#CCCCCC"> I monitored and</font><font color="#E5E5E5"> and be</font>

1144
00:51:25,720 --> 00:51:30,669
careful<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the default management and</font>

1145
00:51:27,790 --> 00:51:32,890
telnet<font color="#CCCCCC"> I if the if the</font><font color="#E5E5E5"> DDoS situation</font>

1146
00:51:30,670 --> 00:51:34,930
<font color="#CCCCCC">continued to be as bad as it is lately</font>

1147
00:51:32,890 --> 00:51:37,089
like<font color="#E5E5E5"> with Tera Byte DDoS I'm pretty sure</font>

1148
00:51:34,930 --> 00:51:38,859
that ISP we'll just seal telnet<font color="#E5E5E5"> off the</font>

1149
00:51:37,090 --> 00:51:40,510
internet<font color="#E5E5E5"> and maybe they</font><font color="#CCCCCC"> should do that</font>

1150
00:51:38,860 --> 00:51:44,050
<font color="#CCCCCC">you know I know we hate it like as</font>

1151
00:51:40,510 --> 00:51:46,000
technologists<font color="#CCCCCC"> to have a band</font><font color="#E5E5E5"> day like</font>

1152
00:51:44,050 --> 00:51:48,910
that<font color="#CCCCCC"> but I I</font><font color="#E5E5E5"> think the situation is</font>

1153
00:51:46,000 --> 00:51:52,240
getting so so bad that at some<font color="#CCCCCC"> point it</font>

1154
00:51:48,910 --> 00:51:54,069
will<font color="#E5E5E5"> be available for consumer put</font>

1155
00:51:52,240 --> 00:51:55,569
password on your<font color="#E5E5E5"> devices even</font><font color="#CCCCCC"> if you</font>

1156
00:51:54,070 --> 00:51:57,670
have to write<font color="#E5E5E5"> it</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> and I post it on</font>

1157
00:51:55,570 --> 00:52:00,160
the device<font color="#E5E5E5"> itself but again you know I</font>

1158
00:51:57,670 --> 00:52:02,500
know<font color="#E5E5E5"> my audience is not consumers so I'm</font>

1159
00:52:00,160 --> 00:52:07,240
talking in we're talking in<font color="#E5E5E5"> our echo</font>

1160
00:52:02,500 --> 00:52:08,980
chamber again<font color="#CCCCCC"> take away is IOT</font><font color="#E5E5E5"> is</font>

1161
00:52:07,240 --> 00:52:10,359
insecure<font color="#E5E5E5"> but it can be fixed for</font><font color="#CCCCCC"> the</font>

1162
00:52:08,980 --> 00:52:10,960
low-hanging fruit problems like I just

1163
00:52:10,360 --> 00:52:13,240
<font color="#E5E5E5">said</font>

1164
00:52:10,960 --> 00:52:15,010
I want to<font color="#E5E5E5"> continue actively</font><font color="#CCCCCC"> collecting</font>

1165
00:52:13,240 --> 00:52:17,379
and analyzing<font color="#CCCCCC"> samples to know in advance</font>

1166
00:52:15,010 --> 00:52:20,880
what's coming next<font color="#E5E5E5"> so to be you know one</font>

1167
00:52:17,380 --> 00:52:24,300
step ahead of what<font color="#CCCCCC"> the embedded in</font><font color="#E5E5E5"> our</font>

1168
00:52:20,880 --> 00:52:27,250
community is doing<font color="#CCCCCC"> and so this is it</font>

1169
00:52:24,300 --> 00:52:28,750
thank you<font color="#CCCCCC"> for your patience</font><font color="#E5E5E5"> in your time</font>

1170
00:52:27,250 --> 00:52:30,840
through this last presentation of<font color="#E5E5E5"> the</font>

1171
00:52:28,750 --> 00:52:30,840
<font color="#CCCCCC">day</font>

