1
00:00:18,050 --> 00:00:21,079
[Music]

2
00:00:35,120 --> 00:00:38,760
can you hear me

3
00:00:48,320 --> 00:00:50,559
now

4
00:00:51,680 --> 00:00:54,719
let me put it

5
00:00:56,079 --> 00:00:59,039
behind

6
00:00:59,039 --> 00:01:01,039
if you can put it in

7
00:01:01,039 --> 00:01:03,600
like somewhere

8
00:01:03,600 --> 00:01:05,840
hello everyone uh

9
00:01:05,840 --> 00:01:08,240
i'm the first one that is going to speak

10
00:01:08,240 --> 00:01:10,240
in english sorry for

11
00:01:10,240 --> 00:01:11,600
not being

12
00:01:11,600 --> 00:01:14,479
not being fluent in bulgarian although i

13
00:01:14,479 --> 00:01:16,240
did my masters in here the only

14
00:01:16,240 --> 00:01:20,400
bulgarian that i know is dubra and uh

15
00:01:20,400 --> 00:01:21,759
sorry about that

16
00:01:21,759 --> 00:01:23,040
so

17
00:01:23,040 --> 00:01:24,159
my

18
00:01:24,159 --> 00:01:27,360
talk is charge my car for free forever

19
00:01:27,360 --> 00:01:30,400
uh who am i i'm uh i was senior

20
00:01:30,400 --> 00:01:32,240
penetration desert pentax partners a

21
00:01:32,240 --> 00:01:35,119
deal yesterday today i'm starting my new

22
00:01:35,119 --> 00:01:37,600
role as a cto on a startup that i'm

23
00:01:37,600 --> 00:01:40,479
helping secure which is called remo

24
00:01:40,479 --> 00:01:43,759
i'm mostly interested in researching api

25
00:01:43,759 --> 00:01:45,759
and iot api

26
00:01:45,759 --> 00:01:49,040
devices and web application security and

27
00:01:49,040 --> 00:01:51,200
i'm finishing my phd developing a

28
00:01:51,200 --> 00:01:53,840
machine learning

29
00:01:53,840 --> 00:01:56,079
algorithm that will find low hanging

30
00:01:56,079 --> 00:01:58,799
fruits and apis you can also find me and

31
00:01:58,799 --> 00:02:00,960
please follow me on twitter and if

32
00:02:00,960 --> 00:02:03,360
stickers

33
00:02:03,360 --> 00:02:06,399
so today's talk is going to be about ev

34
00:02:06,399 --> 00:02:07,520
chargers

35
00:02:07,520 --> 00:02:09,758
and electric vehicles in general the

36
00:02:09,758 --> 00:02:12,400
electric vehicles can be split into two

37
00:02:12,400 --> 00:02:15,840
categories the one category is tesla

38
00:02:15,840 --> 00:02:17,840
and the other category is pretty much

39
00:02:17,840 --> 00:02:19,680
everything else if you are an elon musk

40
00:02:19,680 --> 00:02:21,120
fanboy

41
00:02:21,120 --> 00:02:22,800
this is not going to be about tesla so

42
00:02:22,800 --> 00:02:24,879
you can live right now

43
00:02:24,879 --> 00:02:26,800
the car industry is focused on electric

44
00:02:26,800 --> 00:02:29,360
vehicles uh bulgarian government i also

45
00:02:29,360 --> 00:02:31,440
know that is following the eu charges

46
00:02:31,440 --> 00:02:34,080
and they are trying to stop selling

47
00:02:34,080 --> 00:02:38,319
petrol and diesel vehicles until 2030

48
00:02:38,319 --> 00:02:40,480
there are right now more than three and

49
00:02:40,480 --> 00:02:42,560
a half million electric vehicles in the

50
00:02:42,560 --> 00:02:44,800
world and it's projected to be more than

51
00:02:44,800 --> 00:02:46,800
five million electric vehicles in the

52
00:02:46,800 --> 00:02:50,640
world by end of next year the av

53
00:02:50,640 --> 00:02:52,000
chargers

54
00:02:52,000 --> 00:02:54,080
is a booming market it has a lot of

55
00:02:54,080 --> 00:02:56,640
competition it has smart devices and

56
00:02:56,640 --> 00:02:58,159
whenever you see smart it means

57
00:02:58,159 --> 00:02:59,360
something else you're going to see it on

58
00:02:59,360 --> 00:03:01,280
the next slide

59
00:03:01,280 --> 00:03:03,440
it will keep growing to the millions the

60
00:03:03,440 --> 00:03:06,400
plan is to have one charger for each

61
00:03:06,400 --> 00:03:09,120
household which means a lot of smart

62
00:03:09,120 --> 00:03:10,560
devices

63
00:03:10,560 --> 00:03:13,040
and there are 23 startups in the field

64
00:03:13,040 --> 00:03:14,959
in addition to the big players which is

65
00:03:14,959 --> 00:03:18,480
abb teslin everyone else

66
00:03:18,480 --> 00:03:20,400
also hippo and slow whenever an

67
00:03:20,400 --> 00:03:22,800
appliance is described as being smart it

68
00:03:22,800 --> 00:03:25,519
means vulnerable and it means you will

69
00:03:25,519 --> 00:03:28,720
be able to hack it

70
00:03:28,720 --> 00:03:30,640
the ev charges categories are the home

71
00:03:30,640 --> 00:03:33,200
chargers which is on home installation

72
00:03:33,200 --> 00:03:35,280
every appliance has access to the land

73
00:03:35,280 --> 00:03:36,400
networks

74
00:03:36,400 --> 00:03:39,680
it's usually lower about 20 kilowatts

75
00:03:39,680 --> 00:03:41,840
per hour than public charges which is

76
00:03:41,840 --> 00:03:44,159
the other category

77
00:03:44,159 --> 00:03:46,080
it's the category it's the charges that

78
00:03:46,080 --> 00:03:47,440
you are going to see at the public

79
00:03:47,440 --> 00:03:49,760
roadside uh they're fast chargers that

80
00:03:49,760 --> 00:03:52,640
are up to half a megawatt they have ocpi

81
00:03:52,640 --> 00:03:54,159
in their connection which is going we

82
00:03:54,159 --> 00:03:56,400
are going to see what the cpi means

83
00:03:56,400 --> 00:03:59,830
and the accounts can work globally

84
00:03:59,830 --> 00:04:01,040
[Applause]

85
00:04:01,040 --> 00:04:04,879
quote that the global levy fleet in 2020

86
00:04:04,879 --> 00:04:06,640
is going to

87
00:04:06,640 --> 00:04:09,519
it is consuming as much as belgium

88
00:04:09,519 --> 00:04:12,400
belgium and in 2030 it's going to

89
00:04:12,400 --> 00:04:14,959
consume pretty much as much as europe

90
00:04:14,959 --> 00:04:17,358
consumes

91
00:04:17,358 --> 00:04:19,680
electricity wise

92
00:04:19,680 --> 00:04:20,959
all the attacks that we are going to see

93
00:04:20,959 --> 00:04:22,000
in here

94
00:04:22,000 --> 00:04:24,080
are cloud-based attacks we there's no

95
00:04:24,080 --> 00:04:25,840
hardware

96
00:04:25,840 --> 00:04:28,240
hacking there's no mumbo jumbo there's

97
00:04:28,240 --> 00:04:30,800
no buffer overflows so if if that floats

98
00:04:30,800 --> 00:04:34,240
your boat unfortunately i'm not your man

99
00:04:34,240 --> 00:04:35,280
so

100
00:04:35,280 --> 00:04:37,040
what we are doing in cloud

101
00:04:37,040 --> 00:04:39,919
api what we are doing in api hacking

102
00:04:39,919 --> 00:04:42,960
it's a set of low hanging fruits

103
00:04:42,960 --> 00:04:46,240
when you're building apis you have to

104
00:04:46,240 --> 00:04:48,479
at least fix the low hanging fruits and

105
00:04:48,479 --> 00:04:50,240
then the medium hiking fruits as we're

106
00:04:50,240 --> 00:04:52,240
going to see later down the road you're

107
00:04:52,240 --> 00:04:55,040
going to see that most of most of the

108
00:04:55,040 --> 00:04:57,120
issues are

109
00:04:57,120 --> 00:04:58,800
rush to market

110
00:04:58,800 --> 00:05:00,160
issues and you have to know that

111
00:05:00,160 --> 00:05:02,639
authorization is not authentication and

112
00:05:02,639 --> 00:05:05,039
if you don't know it someone is going to

113
00:05:05,039 --> 00:05:07,440
hack you

114
00:05:07,759 --> 00:05:09,280
all attack like the stock are

115
00:05:09,280 --> 00:05:11,440
cloud-based as i said there's no fiscal

116
00:05:11,440 --> 00:05:14,160
access required most of the hiking was

117
00:05:14,160 --> 00:05:15,840
done from my

118
00:05:15,840 --> 00:05:17,039
house

119
00:05:17,039 --> 00:05:19,199
in greece and the charges were based

120
00:05:19,199 --> 00:05:22,080
either in the uk or the in the us

121
00:05:22,080 --> 00:05:23,440
most of them are really low hanging

122
00:05:23,440 --> 00:05:24,960
fruits it's a good direct object

123
00:05:24,960 --> 00:05:26,960
reference or standard authorization by

124
00:05:26,960 --> 00:05:29,280
buses or even no authentication at all

125
00:05:29,280 --> 00:05:32,160
because who needs authentication

126
00:05:32,160 --> 00:05:33,520
and

127
00:05:33,520 --> 00:05:36,400
all the issues found are logic flows

128
00:05:36,400 --> 00:05:38,479
there's no injection no sql injection no

129
00:05:38,479 --> 00:05:39,919
xss as

130
00:05:39,919 --> 00:05:42,400
this kind of testing on without

131
00:05:42,400 --> 00:05:44,080
authorization as we saw in the previous

132
00:05:44,080 --> 00:05:46,400
talk could be breaking the cma

133
00:05:46,400 --> 00:05:48,639
cma means computer misuse act and you

134
00:05:48,639 --> 00:05:50,479
would be committing a crime

135
00:05:50,479 --> 00:05:53,759
also whoever wants to start cloud

136
00:05:53,759 --> 00:05:56,479
api testing you are not going to get any

137
00:05:56,479 --> 00:05:58,880
cve at all unfortunately

138
00:05:58,880 --> 00:06:00,800
uh i can tell you a lot of stories we

139
00:06:00,800 --> 00:06:01,520
have

140
00:06:01,520 --> 00:06:04,799
ended up owning

141
00:06:04,840 --> 00:06:06,560
505

142
00:06:06,560 --> 00:06:09,039
million routers and we didn't get a cv

143
00:06:09,039 --> 00:06:12,479
because we did it over a cloud

144
00:06:13,120 --> 00:06:14,800
what we're going to see in this talk

145
00:06:14,800 --> 00:06:16,400
api's missing authentication which is

146
00:06:16,400 --> 00:06:18,080
ridiculous api is checking for

147
00:06:18,080 --> 00:06:20,240
authentication and not authorization

148
00:06:20,240 --> 00:06:22,800
apis allowing you to upgrade yourself to

149
00:06:22,800 --> 00:06:25,120
admin while you are a user and api that

150
00:06:25,120 --> 00:06:27,120
leak everything because you know just a

151
00:06:27,120 --> 00:06:29,840
static key

152
00:06:30,160 --> 00:06:32,479
this is a third-party backend cloud as

153
00:06:32,479 --> 00:06:34,479
we're going to see

154
00:06:34,479 --> 00:06:36,720
we ended up owning a cloud

155
00:06:36,720 --> 00:06:40,000
infrastructure that was not only

156
00:06:40,000 --> 00:06:42,240
handling ev chargers but it was also

157
00:06:42,240 --> 00:06:43,360
handling

158
00:06:43,360 --> 00:06:46,160
a million other devices this is the case

159
00:06:46,160 --> 00:06:50,800
for many chinese branded clouds

160
00:06:50,800 --> 00:06:54,160
as i told you cmi and crime alert api

161
00:06:54,160 --> 00:06:57,440
research is really really tricky

162
00:06:57,440 --> 00:07:00,160
try as hard as you can to never ever

163
00:07:00,160 --> 00:07:02,560
interact with a device you don't own

164
00:07:02,560 --> 00:07:04,960
if you mistakenly do it notify the

165
00:07:04,960 --> 00:07:07,280
vendor immediately

166
00:07:07,280 --> 00:07:09,120
if you're taking

167
00:07:09,120 --> 00:07:11,199
the platform admin you are breaking the

168
00:07:11,199 --> 00:07:14,560
cma you have to be 100 sure that you

169
00:07:14,560 --> 00:07:16,319
know what you you're doing or you will

170
00:07:16,319 --> 00:07:20,800
end up in a really difficult situation

171
00:07:21,280 --> 00:07:22,319
sorry

172
00:07:22,319 --> 00:07:25,280
so what are the goals for this talk when

173
00:07:25,280 --> 00:07:27,919
we are attacking a charger we the bare

174
00:07:27,919 --> 00:07:30,000
minimum is to control other devices that

175
00:07:30,000 --> 00:07:33,840
you're you don't own so start stop

176
00:07:33,840 --> 00:07:36,160
the pii link pi stands for personal

177
00:07:36,160 --> 00:07:38,800
identifier information we have to know

178
00:07:38,800 --> 00:07:42,000
other users email name and location

179
00:07:42,000 --> 00:07:45,039
medium level means that uh flash you can

180
00:07:45,039 --> 00:07:46,879
flash the firmware so you can break the

181
00:07:46,879 --> 00:07:49,759
device or pivot to the network and the

182
00:07:49,759 --> 00:07:50,800
total

183
00:07:50,800 --> 00:07:53,120
home run is platform admin so you have

184
00:07:53,120 --> 00:07:55,440
access to everything

185
00:07:55,440 --> 00:07:57,199
i was going to start with the home

186
00:07:57,199 --> 00:07:58,720
chargers

187
00:07:58,720 --> 00:08:00,080
unfortunately

188
00:08:00,080 --> 00:08:02,720
on besides doubling and besides sofia i

189
00:08:02,720 --> 00:08:05,440
wanted to present a new charger cloud

190
00:08:05,440 --> 00:08:06,319
that

191
00:08:06,319 --> 00:08:08,160
i also owned

192
00:08:08,160 --> 00:08:11,599
but it's still not fixed and if i was

193
00:08:11,599 --> 00:08:13,440
going to present it i would be dropping

194
00:08:13,440 --> 00:08:15,680
a zero day which is

195
00:08:15,680 --> 00:08:18,879
bad and the crime i was told

196
00:08:18,879 --> 00:08:20,240
so

197
00:08:20,240 --> 00:08:22,240
yeah unfortunately we're going to name

198
00:08:22,240 --> 00:08:23,759
it chargerx

199
00:08:23,759 --> 00:08:26,319
it was disclosed four months ago it's

200
00:08:26,319 --> 00:08:28,400
still vulnerable it has two and a half

201
00:08:28,400 --> 00:08:30,639
thousand installation we have platform

202
00:08:30,639 --> 00:08:32,479
running there we can access everything

203
00:08:32,479 --> 00:08:34,559
we can delete everything

204
00:08:34,559 --> 00:08:38,479
but it's going to be still chargerx

205
00:08:38,479 --> 00:08:40,479
let's get a couple of things also out of

206
00:08:40,479 --> 00:08:42,479
the way the first one is russia incident

207
00:08:42,479 --> 00:08:44,560
i don't know if you saw the

208
00:08:44,560 --> 00:08:47,440
the news uh the ukrainian

209
00:08:47,440 --> 00:08:48,160
uh

210
00:08:48,160 --> 00:08:51,360
the vendor has disabled all the ev

211
00:08:51,360 --> 00:08:53,839
charging stations that was owned

212
00:08:53,839 --> 00:08:57,040
this was not a hack this was a vendor

213
00:08:57,040 --> 00:08:59,040
changing their own

214
00:08:59,040 --> 00:09:02,320
devices it disabled all chargers in an

215
00:09:02,320 --> 00:09:04,720
m11 highway which sent peter's book to

216
00:09:04,720 --> 00:09:05,839
moscow

217
00:09:05,839 --> 00:09:09,040
rendering every chart every travel

218
00:09:09,040 --> 00:09:10,959
impossible

219
00:09:10,959 --> 00:09:12,640
the second thing

220
00:09:12,640 --> 00:09:14,640
i have an alibi for both of them first

221
00:09:14,640 --> 00:09:15,839
of all

222
00:09:15,839 --> 00:09:19,360
is the electric car charging that was

223
00:09:19,360 --> 00:09:21,680
found on the isle of wight

224
00:09:21,680 --> 00:09:23,040
it was a hack

225
00:09:23,040 --> 00:09:24,720
it was pretty similar to the idols that

226
00:09:24,720 --> 00:09:27,200
i was going to present there

227
00:09:27,200 --> 00:09:29,279
all the chargers were showing

228
00:09:29,279 --> 00:09:32,640
porn and poor messages

229
00:09:32,640 --> 00:09:34,560
there is an active investigation on that

230
00:09:34,560 --> 00:09:37,279
and from what i know they're going to

231
00:09:37,279 --> 00:09:40,080
find whoever did it

232
00:09:40,080 --> 00:09:42,320
this is the first charger that we're

233
00:09:42,320 --> 00:09:43,440
going to

234
00:09:43,440 --> 00:09:46,320
present it's called project tv or 80s or

235
00:09:46,320 --> 00:09:49,760
senzen grovat it was one of the worst it

236
00:09:49,760 --> 00:09:51,760
had the department of uh

237
00:09:51,760 --> 00:09:53,839
transport approval department transport

238
00:09:53,839 --> 00:09:55,839
approves what you can install on your

239
00:09:55,839 --> 00:09:57,680
home in the uk

240
00:09:57,680 --> 00:09:58,880
gravatt

241
00:09:58,880 --> 00:10:01,760
growat cloud had a huge number of

242
00:10:01,760 --> 00:10:05,040
devices like over three millions that

243
00:10:05,040 --> 00:10:07,040
were not only limited to the charger

244
00:10:07,040 --> 00:10:09,200
there were also photovoltaic there were

245
00:10:09,200 --> 00:10:11,279
also kettles there were a lot of things

246
00:10:11,279 --> 00:10:13,120
that were controlled by that

247
00:10:13,120 --> 00:10:14,160
uh

248
00:10:14,160 --> 00:10:15,920
cloud

249
00:10:15,920 --> 00:10:18,720
growth and then are both china-based

250
00:10:18,720 --> 00:10:21,279
companies

251
00:10:21,440 --> 00:10:23,200
as you're going to see

252
00:10:23,200 --> 00:10:25,360
you can see in here that there was not

253
00:10:25,360 --> 00:10:27,200
indication or authorization or

254
00:10:27,200 --> 00:10:29,680
authorization on any call it was just

255
00:10:29,680 --> 00:10:33,760
the first login and then it was just

256
00:10:33,760 --> 00:10:35,600
you were passing the charge id you could

257
00:10:35,600 --> 00:10:37,519
change the charger id that were

258
00:10:37,519 --> 00:10:41,200
consecutive numbers so you can easily

259
00:10:41,200 --> 00:10:42,880
brute force everything

260
00:10:42,880 --> 00:10:44,720
what we got was full functionality on

261
00:10:44,720 --> 00:10:47,680
all devices lock and lock we could

262
00:10:47,680 --> 00:10:50,079
remote firmware update there was no

263
00:10:50,079 --> 00:10:52,240
signature check so we could

264
00:10:52,240 --> 00:10:54,560
pivot into the internal network we could

265
00:10:54,560 --> 00:10:56,959
pivot into internal networks of

266
00:10:56,959 --> 00:10:59,600
companies that had data installed

267
00:10:59,600 --> 00:11:02,880
obviously there was a pii lake there was

268
00:11:02,880 --> 00:11:05,680
you could break and never

269
00:11:05,680 --> 00:11:08,000
start it again and we also got platform

270
00:11:08,000 --> 00:11:11,519
admin also what whatever is in red

271
00:11:11,519 --> 00:11:14,000
in there is a crime it's a break of the

272
00:11:14,000 --> 00:11:16,040
cma you should never do it

273
00:11:16,040 --> 00:11:17,120
[Applause]

274
00:11:17,120 --> 00:11:17,839
so

275
00:11:17,839 --> 00:11:20,560
uh how did this disclosure go

276
00:11:20,560 --> 00:11:22,399
they did not respond for weeks they only

277
00:11:22,399 --> 00:11:24,240
responded when they asked they were

278
00:11:24,240 --> 00:11:26,880
asked by the bbc they eventually fixed

279
00:11:26,880 --> 00:11:28,959
it after first

280
00:11:28,959 --> 00:11:30,720
saying they fixed it but it was not

281
00:11:30,720 --> 00:11:31,600
fixed

282
00:11:31,600 --> 00:11:34,240
and they fixed it with a state sls login

283
00:11:34,240 --> 00:11:36,959
so they have no cookie no authorization

284
00:11:36,959 --> 00:11:38,720
authentication at all you just send the

285
00:11:38,720 --> 00:11:41,279
authentication and then somehow it works

286
00:11:41,279 --> 00:11:43,040
i didn't want to look

287
00:11:43,040 --> 00:11:45,839
at at all afterwards because frankly it

288
00:11:45,839 --> 00:11:47,920
was a really really bad platform i'm

289
00:11:47,920 --> 00:11:52,639
giving them a fail f minus really bad

290
00:11:52,639 --> 00:11:54,639
second one is the biggest of the home

291
00:11:54,639 --> 00:11:58,000
chargers it's called evbox

292
00:11:58,000 --> 00:12:00,720
it has a global install uh base of over

293
00:12:00,720 --> 00:12:03,360
200 000 charging points they're based in

294
00:12:03,360 --> 00:12:05,600
amsterdam they're obviously department

295
00:12:05,600 --> 00:12:07,600
of trust mod approved and they're

296
00:12:07,600 --> 00:12:12,240
acquired by nz for 300 million

297
00:12:12,240 --> 00:12:13,200
pounds

298
00:12:13,200 --> 00:12:15,440
i had a really good api everything

299
00:12:15,440 --> 00:12:17,760
checked there was no obvious issues so i

300
00:12:17,760 --> 00:12:20,800
was really desperate

301
00:12:20,800 --> 00:12:23,519
can anyone find what the issue is as you

302
00:12:23,519 --> 00:12:24,560
can see

303
00:12:24,560 --> 00:12:26,720
when you're editing your profile

304
00:12:26,720 --> 00:12:29,680
you're also passing the roles so if you

305
00:12:29,680 --> 00:12:31,680
go to the roles and say

306
00:12:31,680 --> 00:12:33,279
i don't know i'm an admin or i'm a

307
00:12:33,279 --> 00:12:34,560
tenant that means

308
00:12:34,560 --> 00:12:37,120
we end up having a full

309
00:12:37,120 --> 00:12:39,839
platform admin with access to everything

310
00:12:39,839 --> 00:12:42,399
all the users all the pii

311
00:12:42,399 --> 00:12:43,360
so

312
00:12:43,360 --> 00:12:45,839
you had total compromise of everything

313
00:12:45,839 --> 00:12:48,000
there was pii leakage you had all admin

314
00:12:48,000 --> 00:12:50,000
functionality you could log in to

315
00:12:50,000 --> 00:12:51,440
servers

316
00:12:51,440 --> 00:12:53,839
it was a really really bad situation

317
00:12:53,839 --> 00:12:56,079
from a really minor thing we got

318
00:12:56,079 --> 00:12:57,270
platform admin

319
00:12:57,270 --> 00:12:58,639
[Applause]

320
00:12:58,639 --> 00:13:00,959
uh they were really really good they

321
00:13:00,959 --> 00:13:03,279
responded in two hours they fixed in 24

322
00:13:03,279 --> 00:13:04,480
hours they double checked that

323
00:13:04,480 --> 00:13:05,920
everything was fixed they had an

324
00:13:05,920 --> 00:13:07,920
excellent response i'm giving

325
00:13:07,920 --> 00:13:10,240
they were a really

326
00:13:10,240 --> 00:13:12,000
probably the best

327
00:13:12,000 --> 00:13:14,079
disclosure that i ever made that i did a

328
00:13:14,079 --> 00:13:15,600
lot of disclosures in the past couple of

329
00:13:15,600 --> 00:13:16,880
years

330
00:13:16,880 --> 00:13:19,040
third one is the wall box it has around

331
00:13:19,040 --> 00:13:20,880
100 000 users they are based in

332
00:13:20,880 --> 00:13:23,200
barcelona they merged with a capital

333
00:13:23,200 --> 00:13:24,639
acquisition corp

334
00:13:24,639 --> 00:13:25,680
and they

335
00:13:25,680 --> 00:13:28,320
they raised 300 million

336
00:13:28,320 --> 00:13:30,079
uh dollars

337
00:13:30,079 --> 00:13:32,480
they had a lot of second

338
00:13:32,480 --> 00:13:34,079
actually they had six different

339
00:13:34,079 --> 00:13:35,680
instances of uh

340
00:13:35,680 --> 00:13:38,240
second level either which means that you

341
00:13:38,240 --> 00:13:40,639
could just pass charger ids which is

342
00:13:40,639 --> 00:13:43,199
consecutive numbers and you will end up

343
00:13:43,199 --> 00:13:45,360
with total control over all charges you

344
00:13:45,360 --> 00:13:47,040
could lock and lock

345
00:13:47,040 --> 00:13:49,279
there was no way to firmware update

346
00:13:49,279 --> 00:13:51,839
unfortunately so there's no platform

347
00:13:51,839 --> 00:13:54,880
admin and there's no pii liquids

348
00:13:54,880 --> 00:13:56,399
they responded

349
00:13:56,399 --> 00:13:57,360
really

350
00:13:57,360 --> 00:13:59,440
the next day they fixed it in a couple

351
00:13:59,440 --> 00:14:00,880
of days

352
00:14:00,880 --> 00:14:04,639
and after i reject and re-engage after a

353
00:14:04,639 --> 00:14:06,959
month because i found the second issue

354
00:14:06,959 --> 00:14:09,680
which was the same as the first one

355
00:14:09,680 --> 00:14:11,760
which seems to really bad for them

356
00:14:11,760 --> 00:14:13,279
because they didn't actually fix the

357
00:14:13,279 --> 00:14:15,040
underlying cost but they fixed just the

358
00:14:15,040 --> 00:14:17,040
costs that were just the issue that was

359
00:14:17,040 --> 00:14:18,800
reported

360
00:14:18,800 --> 00:14:19,920
they fixed it

361
00:14:19,920 --> 00:14:22,079
on a couple of days again

362
00:14:22,079 --> 00:14:24,320
they wanted to engage

363
00:14:24,320 --> 00:14:25,440
so that

364
00:14:25,440 --> 00:14:28,000
i could check them the company that i

365
00:14:28,000 --> 00:14:29,839
worked for could check them but they

366
00:14:29,839 --> 00:14:32,480
also wanted an nda so yeah i'm not going

367
00:14:32,480 --> 00:14:35,279
to sign an mba because

368
00:14:35,279 --> 00:14:36,480
i don't like

369
00:14:36,480 --> 00:14:38,399
being forced to

370
00:14:38,399 --> 00:14:40,720
to sign nda so not great not terrible

371
00:14:40,720 --> 00:14:43,680
that they did what they could

372
00:14:43,680 --> 00:14:46,079
the eo charger is probably

373
00:14:46,079 --> 00:14:49,120
the first one that we took a look at

374
00:14:49,120 --> 00:14:51,680
it's right now and 20 000

375
00:14:51,680 --> 00:14:54,959
users estimated they're based in london

376
00:14:54,959 --> 00:14:58,079
they had typical rust to market issues i

377
00:14:58,079 --> 00:15:00,320
had the raspberry pi as the base which

378
00:15:00,320 --> 00:15:01,600
can be easily rooted there is no

379
00:15:01,600 --> 00:15:04,639
bootloader security the recovery of full

380
00:15:04,639 --> 00:15:06,480
source code and by full source code i

381
00:15:06,480 --> 00:15:08,720
mean two python scripts

382
00:15:08,720 --> 00:15:11,279
that had hard-coded credentials full

383
00:15:11,279 --> 00:15:13,199
documentation because i didn't want to

384
00:15:13,199 --> 00:15:14,880
understand python i just read the

385
00:15:14,880 --> 00:15:18,800
comments and it was there as you can see

386
00:15:18,800 --> 00:15:20,399
you can see that they have everything

387
00:15:20,399 --> 00:15:22,959
they have a static key in there and

388
00:15:22,959 --> 00:15:25,600
i ended up we could fully decrypt

389
00:15:25,600 --> 00:15:27,279
everything you can

390
00:15:27,279 --> 00:15:29,680
take control of everything

391
00:15:29,680 --> 00:15:31,920
you could mimic the server and make a

392
00:15:31,920 --> 00:15:34,880
botnet because why not

393
00:15:34,880 --> 00:15:37,040
you could you didn't need to reflash

394
00:15:37,040 --> 00:15:38,720
because you couldn't say that from now

395
00:15:38,720 --> 00:15:41,040
on i'm the server you're going to do

396
00:15:41,040 --> 00:15:42,720
what i say so

397
00:15:42,720 --> 00:15:45,680
they pii leak they credentially leaked

398
00:15:45,680 --> 00:15:47,920
we got the platform admin we got a lot

399
00:15:47,920 --> 00:15:50,800
of different stuff

400
00:15:50,880 --> 00:15:53,120
they responded in a timely fashion they

401
00:15:53,120 --> 00:15:55,279
worked it hard into

402
00:15:55,279 --> 00:15:57,360
moving away from the raspberry p model

403
00:15:57,360 --> 00:15:59,120
and moving to somewhere else but their

404
00:15:59,120 --> 00:16:00,639
new

405
00:16:00,639 --> 00:16:04,000
and improved iom eo mini uses a

406
00:16:04,000 --> 00:16:06,800
raspberry p again because

407
00:16:06,800 --> 00:16:09,839
why not you know

408
00:16:11,360 --> 00:16:13,600
i'm going to say that i'm not a hardware

409
00:16:13,600 --> 00:16:16,959
expert so this is from people who know

410
00:16:16,959 --> 00:16:19,680
what raspberry how easy raspberry p is

411
00:16:19,680 --> 00:16:22,320
to be hacked there is a valid prototype

412
00:16:22,320 --> 00:16:24,800
it is a valid prototype device it's not

413
00:16:24,800 --> 00:16:26,480
a good idea to put the raspberry pi in

414
00:16:26,480 --> 00:16:28,560
production it allows an easy extraction

415
00:16:28,560 --> 00:16:30,480
of full stored data because it has an sd

416
00:16:30,480 --> 00:16:32,639
card obviously it's easily rootable and

417
00:16:32,639 --> 00:16:34,320
there is no way to have a secure

418
00:16:34,320 --> 00:16:36,720
bootloader i know that raspberry p is

419
00:16:36,720 --> 00:16:39,440
trying to solve that but until now there

420
00:16:39,440 --> 00:16:41,199
is no easy way of having a secure

421
00:16:41,199 --> 00:16:42,800
bootloader

422
00:16:42,800 --> 00:16:44,000
moving by

423
00:16:44,000 --> 00:16:46,399
moving next to the public chargers

424
00:16:46,399 --> 00:16:47,920
we're going to have charge point charge

425
00:16:47,920 --> 00:16:50,399
bond is one of the biggest after tesla

426
00:16:50,399 --> 00:16:51,759
and abb

427
00:16:51,759 --> 00:16:54,880
public tax providers in the world

428
00:16:54,880 --> 00:16:58,160
it has 114

429
00:16:58,160 --> 00:17:00,800
number of spots which is close to half a

430
00:17:00,800 --> 00:17:02,639
million charges because as you can see

431
00:17:02,639 --> 00:17:04,799
each spot has three to six

432
00:17:04,799 --> 00:17:06,480
chargers

433
00:17:06,480 --> 00:17:09,599
and it has its head a publicly explode

434
00:17:09,599 --> 00:17:11,359
exposed and authenticated graphql

435
00:17:11,359 --> 00:17:13,919
endpoint with introspection enabled it

436
00:17:13,919 --> 00:17:16,079
was potentially leaking their full

437
00:17:16,079 --> 00:17:18,720
schema he wanted no authentication at

438
00:17:18,720 --> 00:17:20,400
all but

439
00:17:20,400 --> 00:17:21,760
as i said before

440
00:17:21,760 --> 00:17:24,000
you cannot try and access things that

441
00:17:24,000 --> 00:17:25,599
you don't don't because you are

442
00:17:25,599 --> 00:17:27,359
committing a crime

443
00:17:27,359 --> 00:17:29,919
uh the api the research is really tricky

444
00:17:29,919 --> 00:17:31,520
because you know it is there you can

445
00:17:31,520 --> 00:17:33,039
access it but the moment that you're

446
00:17:33,039 --> 00:17:34,480
accessing something if you don't don't

447
00:17:34,480 --> 00:17:36,000
you're committing a crime so don't do

448
00:17:36,000 --> 00:17:37,440
that

449
00:17:37,440 --> 00:17:39,440
the bad thing is that charge point

450
00:17:39,440 --> 00:17:41,120
responded in an hour they fixed it on

451
00:17:41,120 --> 00:17:42,480
the same day they had an excellent

452
00:17:42,480 --> 00:17:44,080
response they acknowledged that there

453
00:17:44,080 --> 00:17:46,559
was an issue in there and they said that

454
00:17:46,559 --> 00:17:48,559
okay you could have access it and i

455
00:17:48,559 --> 00:17:50,720
wouldn't we wouldn't press charges to

456
00:17:50,720 --> 00:17:51,440
you

457
00:17:51,440 --> 00:17:53,520
so i'm giving them the first i'm giving

458
00:17:53,520 --> 00:17:55,760
them the gold medal but unfortunately i

459
00:17:55,760 --> 00:17:59,039
didn't have all the data so this is they

460
00:17:59,039 --> 00:18:01,360
acknowledged it but i didn't actually

461
00:18:01,360 --> 00:18:02,960
hack it

462
00:18:02,960 --> 00:18:04,480
now moving

463
00:18:04,480 --> 00:18:06,880
next to potential issues and how these

464
00:18:06,880 --> 00:18:08,960
things can be weaponized

465
00:18:08,960 --> 00:18:11,200
there is the ocpi which is the open

466
00:18:11,200 --> 00:18:13,039
charge point protocol which is an

467
00:18:13,039 --> 00:18:14,480
application protocol

468
00:18:14,480 --> 00:18:17,520
that all public chargers can

469
00:18:17,520 --> 00:18:20,559
connect to each other and use

470
00:18:20,559 --> 00:18:22,640
their own

471
00:18:22,640 --> 00:18:25,600
accounts to other protocols they have a

472
00:18:25,600 --> 00:18:28,240
protocol which is called roaming there's

473
00:18:28,240 --> 00:18:29,440
connection between providers and

474
00:18:29,440 --> 00:18:31,600
manufacturers which means that if you

475
00:18:31,600 --> 00:18:34,000
find a vulnerability in one platform it

476
00:18:34,000 --> 00:18:37,840
will lead to everyone being vulnerable

477
00:18:37,840 --> 00:18:39,760
much like the mobile network it's called

478
00:18:39,760 --> 00:18:41,840
roaming so let's say if you find

479
00:18:41,840 --> 00:18:43,440
something in search point you will be

480
00:18:43,440 --> 00:18:46,960
able to hack every other platform that

481
00:18:46,960 --> 00:18:49,520
is connected with ocpi what you could do

482
00:18:49,520 --> 00:18:51,520
is steal energy have someone else pay

483
00:18:51,520 --> 00:18:54,480
for it you could obviously pii leak

484
00:18:54,480 --> 00:18:56,640
you could deny service legitimate users

485
00:18:56,640 --> 00:18:59,360
because you could stop make them stop

486
00:18:59,360 --> 00:19:02,400
charging and it gets way worse so even

487
00:19:02,400 --> 00:19:04,160
worse potential issues

488
00:19:04,160 --> 00:19:05,520
is uh

489
00:19:05,520 --> 00:19:07,760
this is a really nice page that's a

490
00:19:07,760 --> 00:19:11,360
whole scenario it was presented by

491
00:19:11,360 --> 00:19:14,400
willem westerhoff i hope i pronounced it

492
00:19:14,400 --> 00:19:16,559
correctly it was an attack based on

493
00:19:16,559 --> 00:19:18,160
photovoltaic vulnerabilities that can

494
00:19:18,160 --> 00:19:21,120
potentially destabilize the power grid

495
00:19:21,120 --> 00:19:24,080
and we're going to take it uh from

496
00:19:24,080 --> 00:19:25,840
another point of view

497
00:19:25,840 --> 00:19:26,960
and

498
00:19:26,960 --> 00:19:28,880
you know

499
00:19:28,880 --> 00:19:30,880
the thing with pyruvates in europe is

500
00:19:30,880 --> 00:19:31,679
that

501
00:19:31,679 --> 00:19:33,600
when we in greece or you in bulgaria

502
00:19:33,600 --> 00:19:35,600
need more power we're going to get

503
00:19:35,600 --> 00:19:36,880
you're going to get from grace we're

504
00:19:36,880 --> 00:19:39,600
going to get from bulgaria or macedonia

505
00:19:39,600 --> 00:19:42,000
or you know they are interconnected

506
00:19:42,000 --> 00:19:43,520
nations are constantly exporting and

507
00:19:43,520 --> 00:19:46,480
importing power so that

508
00:19:46,480 --> 00:19:50,000
they help each other during crisis times

509
00:19:50,000 --> 00:19:51,280
so for

510
00:19:51,280 --> 00:19:53,280
the william scenario the whole scenario

511
00:19:53,280 --> 00:19:55,600
instead of limiting the pv power or

512
00:19:55,600 --> 00:19:57,919
limited we're gonna see at another talk

513
00:19:57,919 --> 00:20:00,320
you're gonna see on defcon this year

514
00:20:00,320 --> 00:20:02,880
we're gonna maximize the need for power

515
00:20:02,880 --> 00:20:04,960
so everyone making a cup of tea at

516
00:20:04,960 --> 00:20:08,080
halftime during the world cup match is

517
00:20:08,080 --> 00:20:11,120
something that the power grid

518
00:20:11,120 --> 00:20:13,520
operators are prepared for but they're

519
00:20:13,520 --> 00:20:16,400
not prepared for the chargers to be on

520
00:20:16,400 --> 00:20:18,159
off and on again

521
00:20:18,159 --> 00:20:18,840
it

522
00:20:18,840 --> 00:20:20,320
will uh

523
00:20:20,320 --> 00:20:22,240
gain a lot of power

524
00:20:22,240 --> 00:20:26,799
and it could potentially block out uh

525
00:20:26,799 --> 00:20:29,919
power grids and if you also put a keep

526
00:20:29,919 --> 00:20:31,760
in mind that you can

527
00:20:31,760 --> 00:20:34,480
with the pii leak know where

528
00:20:34,480 --> 00:20:37,600
its charger is located for this to work

529
00:20:37,600 --> 00:20:39,360
unfortunately you need to be connected

530
00:20:39,360 --> 00:20:41,120
to the chargers you cannot

531
00:20:41,120 --> 00:20:42,640
you have to have a car connected to the

532
00:20:42,640 --> 00:20:45,200
charger you cannot say the charger take

533
00:20:45,200 --> 00:20:47,200
as much power as you need so this kind

534
00:20:47,200 --> 00:20:48,400
of attack

535
00:20:48,400 --> 00:20:50,720
would need to take place

536
00:20:50,720 --> 00:20:52,960
in the evening

537
00:20:52,960 --> 00:20:56,190
any questions thanks for listening

538
00:20:56,190 --> 00:20:56,530
[Applause]

539
00:20:56,530 --> 00:21:01,280
[Music]

540
00:21:01,280 --> 00:21:02,480
no questions

541
00:21:02,480 --> 00:21:05,280
excellent oh

542
00:21:08,000 --> 00:21:09,120
is there a

543
00:21:09,120 --> 00:21:11,440
database or some list of

544
00:21:11,440 --> 00:21:13,679
providers where we can check whether

545
00:21:13,679 --> 00:21:17,320
they have uh

546
00:21:26,000 --> 00:21:28,400
this is a broader

547
00:21:28,400 --> 00:21:29,520
iot

548
00:21:29,520 --> 00:21:31,600
devices question

549
00:21:31,600 --> 00:21:34,640
what i usually say is you have to

550
00:21:34,640 --> 00:21:37,440
to consider when you buy an iot device

551
00:21:37,440 --> 00:21:40,080
to buy something from a well reputable

552
00:21:40,080 --> 00:21:41,840
company

553
00:21:41,840 --> 00:21:44,559
vulnerabilities are going to happen the

554
00:21:44,559 --> 00:21:45,760
thing is

555
00:21:45,760 --> 00:21:48,320
you want a company that will stand by

556
00:21:48,320 --> 00:21:49,360
the

557
00:21:49,360 --> 00:21:51,600
vulnerability fix it as soon as possible

558
00:21:51,600 --> 00:21:56,000
acknowledge it and push an update to you

559
00:21:56,000 --> 00:21:57,039
so

560
00:21:57,039 --> 00:21:58,960
yes there is the cv database that you

561
00:21:58,960 --> 00:22:02,080
can see who has what there is also the

562
00:22:02,080 --> 00:22:04,960
iot database that you can see

563
00:22:04,960 --> 00:22:07,120
their

564
00:22:07,120 --> 00:22:08,640
their fcc

565
00:22:08,640 --> 00:22:09,840
and what

566
00:22:09,840 --> 00:22:12,960
they're composed from but usually i'm

567
00:22:12,960 --> 00:22:15,039
just saying if you know the company go

568
00:22:15,039 --> 00:22:17,200
with it don't go with a random chinese

569
00:22:17,200 --> 00:22:20,200
company

570
00:22:23,490 --> 00:22:26,589
[Applause]

571
00:22:28,320 --> 00:22:30,640
if you own the device

572
00:22:30,640 --> 00:22:34,240
you can do it whatever you want so if

573
00:22:34,240 --> 00:22:36,080
no i i have bought

574
00:22:36,080 --> 00:22:38,400
the company that i work for bought

575
00:22:38,400 --> 00:22:40,480
each of the device so we could prove

576
00:22:40,480 --> 00:22:42,720
that we could break it without breaking

577
00:22:42,720 --> 00:22:45,039
the law if you and the device and i

578
00:22:45,039 --> 00:22:47,039
break it i obviously break the law but

579
00:22:47,039 --> 00:22:49,120
if i own the device

580
00:22:49,120 --> 00:22:51,200
then i'm not breaking the law

581
00:22:51,200 --> 00:22:53,600
if if i take platform admin so i have

582
00:22:53,600 --> 00:22:56,880
access to pii and

583
00:22:56,880 --> 00:22:59,120
interact with a device that you own then

584
00:22:59,120 --> 00:23:00,960
i break the law

585
00:23:00,960 --> 00:23:02,960
unfortunately the cma i'm talking about

586
00:23:02,960 --> 00:23:04,400
the uk law and here but i don't know

587
00:23:04,400 --> 00:23:06,320
about bulgaria i don't know

588
00:23:06,320 --> 00:23:08,320
and the greek law says that if you

589
00:23:08,320 --> 00:23:10,559
access something that you don't own you

590
00:23:10,559 --> 00:23:11,919
break the law

591
00:23:11,919 --> 00:23:14,720
it's a little bit not a little bit a lot

592
00:23:14,720 --> 00:23:18,159
outdated and we and a lot of lobbying is

593
00:23:18,159 --> 00:23:20,320
happening so that we can change that but

594
00:23:20,320 --> 00:23:22,400
until then unfortunately

595
00:23:22,400 --> 00:23:23,840
it is what it is and

596
00:23:23,840 --> 00:23:26,080
i cannot tell you to commit a crime

597
00:23:26,080 --> 00:23:30,000
i'm telling you not to commit a crime

598
00:23:30,000 --> 00:23:32,480
any other

599
00:23:34,960 --> 00:23:37,360
for the questions admin platform

600
00:23:37,360 --> 00:23:41,120
especially for the home chargers

601
00:23:41,600 --> 00:23:44,000
can you a little bit what

602
00:23:44,000 --> 00:23:46,480
the manufacturer vendor purpose having

603
00:23:46,480 --> 00:23:47,919
concentrated

604
00:23:47,919 --> 00:23:50,720
in database

605
00:23:50,720 --> 00:23:51,760
with

606
00:23:51,760 --> 00:23:52,480
all

607
00:23:52,480 --> 00:23:56,000
phone chargers connected

608
00:23:56,720 --> 00:23:58,320
this is

609
00:23:58,320 --> 00:24:01,440
again let's look at the iot level i'm

610
00:24:01,440 --> 00:24:03,679
going to look at the iot level

611
00:24:03,679 --> 00:24:06,000
if you remember

612
00:24:06,000 --> 00:24:08,480
10 years ago when we were installing our

613
00:24:08,480 --> 00:24:11,679
own iot cameras we were saying now we

614
00:24:11,679 --> 00:24:14,960
need to port forward our routers to do

615
00:24:14,960 --> 00:24:17,279
something which you and me we could do

616
00:24:17,279 --> 00:24:19,440
it but my mother

617
00:24:19,440 --> 00:24:21,120
no my mother could do it

618
00:24:21,120 --> 00:24:23,760
my father who is that literate

619
00:24:23,760 --> 00:24:26,000
couldn't do it so they say you don't

620
00:24:26,000 --> 00:24:28,400
need any more we are going to punch

621
00:24:28,400 --> 00:24:30,320
through your router and

622
00:24:30,320 --> 00:24:33,520
just by using our apis and our

623
00:24:33,520 --> 00:24:35,200
application our mobile application you

624
00:24:35,200 --> 00:24:38,400
will be able to control your uh

625
00:24:38,400 --> 00:24:39,760
your device

626
00:24:39,760 --> 00:24:41,279
that's the case from the chargers they

627
00:24:41,279 --> 00:24:43,440
install it and they just want to have an

628
00:24:43,440 --> 00:24:46,159
easy way in and an easy way out which is

629
00:24:46,159 --> 00:24:48,320
also an easy way and an easy way out for

630
00:24:48,320 --> 00:24:49,760
anyone who is

631
00:24:49,760 --> 00:24:51,830
i don't know a hacker

632
00:24:51,830 --> 00:24:53,279
[Applause]

633
00:24:53,279 --> 00:24:55,200
did that answer okay

634
00:24:55,200 --> 00:24:57,279
anyone else

635
00:24:57,279 --> 00:24:58,810
thank you

636
00:24:58,810 --> 00:25:03,839
[Applause]

637
00:25:21,120 --> 00:25:23,199
you

