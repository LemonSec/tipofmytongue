1
00:00:04,470 --> 00:00:08,230
thank you thank you so much so and first

2
00:00:08,230 --> 00:00:12,280
of all hello to the amazing Portuguese

3
00:00:12,280 --> 00:00:14,379
intersect community it's a pleasure to

4
00:00:14,379 --> 00:00:17,260
speak here and the very first thing that

5
00:00:17,260 --> 00:00:19,300
I want to say is like thanks a lot to

6
00:00:19,300 --> 00:00:21,070
all the organizers you are doing an

7
00:00:21,070 --> 00:00:23,699
amazing job thank you so much

8
00:00:23,699 --> 00:00:26,980
all right and to kick it off yeah it's

9
00:00:26,980 --> 00:00:30,550
about pentas deep dive we are looking at

10
00:00:30,550 --> 00:00:32,920
a cloud backup software maybe you read

11
00:00:32,920 --> 00:00:38,200
it already on the schedule just to tell

12
00:00:38,200 --> 00:00:40,989
you a little bit about me so I'm a

13
00:00:40,989 --> 00:00:42,730
technical project manager team lead at

14
00:00:42,730 --> 00:00:44,920
Cobalt we are fantastic as a service

15
00:00:44,920 --> 00:00:48,370
company so we are doing penthouse using

16
00:00:48,370 --> 00:00:50,109
a freelancer network of around about

17
00:00:50,109 --> 00:00:54,489
like 270 pen testers and I'm one of them

18
00:00:54,489 --> 00:00:57,250
like in my free time I'm doing pen

19
00:00:57,250 --> 00:00:59,500
testing in my day to day I'm leading the

20
00:00:59,500 --> 00:01:03,039
operations department and yeah I'm also

21
00:01:03,039 --> 00:01:05,140
an information security researcher I'm a

22
00:01:05,140 --> 00:01:07,600
pen tester I'm a public speaker I'm

23
00:01:07,600 --> 00:01:08,799
usually speaking at emphasized

24
00:01:08,799 --> 00:01:12,220
conferences sharing my research yeah and

25
00:01:12,220 --> 00:01:13,960
I have around about like nine years

26
00:01:13,960 --> 00:01:16,840
experience in information security so

27
00:01:16,840 --> 00:01:20,110
and let's see what is on our to-do list

28
00:01:20,110 --> 00:01:22,689
so on our to-do list today is since it's

29
00:01:22,689 --> 00:01:24,610
like the whole story of a pen test it

30
00:01:24,610 --> 00:01:26,920
start with the scope it continues with

31
00:01:26,920 --> 00:01:27,790
reconnaissance

32
00:01:27,790 --> 00:01:29,829
then it goes to the exploitation part

33
00:01:29,829 --> 00:01:32,380
the fun part and looking a little bit

34
00:01:32,380 --> 00:01:34,240
into remediation this will be a little

35
00:01:34,240 --> 00:01:37,329
bit more generic and then I'll keep it

36
00:01:37,329 --> 00:01:39,100
open for questions and I hope you do

37
00:01:39,100 --> 00:01:42,159
have some so let's start with the

38
00:01:42,159 --> 00:01:43,509
disclaimer that's the boring part I'm

39
00:01:43,509 --> 00:01:43,990
sorry

40
00:01:43,990 --> 00:01:47,100
so cobalt doesn't share any

41
00:01:47,100 --> 00:01:49,540
vulnerability information or publishes

42
00:01:49,540 --> 00:01:51,130
any vulnerability for information the

43
00:01:51,130 --> 00:01:52,810
following content that you'll see is all

44
00:01:52,810 --> 00:01:54,969
my research and is not associated to

45
00:01:54,969 --> 00:01:58,090
COBOL at all the company that I'll talk

46
00:01:58,090 --> 00:02:01,780
about like in the next few seconds was

47
00:02:01,780 --> 00:02:04,390
contacted and they have access to all

48
00:02:04,390 --> 00:02:05,439
vulnerability details

49
00:02:05,439 --> 00:02:06,789
unfortunately they didn't really care

50
00:02:06,789 --> 00:02:09,580
that much so I didn't get a read

51
00:02:09,580 --> 00:02:12,580
received nobody replied so responsible

52
00:02:12,580 --> 00:02:13,800
disclosure was attempt

53
00:02:13,800 --> 00:02:16,680
unfortunately it didn't work away so

54
00:02:16,680 --> 00:02:19,710
let's have a look at the scope and we

55
00:02:19,710 --> 00:02:22,320
are talking about a vulnerable limited

56
00:02:22,320 --> 00:02:24,570
so that vulnerable limited is a company

57
00:02:24,570 --> 00:02:27,690
they deployed AWS their internal network

58
00:02:27,690 --> 00:02:33,120
in AWS like most of my clients nowadays

59
00:02:33,120 --> 00:02:35,010
they really like to go into cloud

60
00:02:35,010 --> 00:02:36,750
because of cloud a sip close cool

61
00:02:36,750 --> 00:02:39,870
everybody loved that and it also easy to

62
00:02:39,870 --> 00:02:42,210
manage you can like scale as we grow and

63
00:02:42,210 --> 00:02:43,380
stuff like that you don't have to buy

64
00:02:43,380 --> 00:02:45,570
servers that's all the stuff that you

65
00:02:45,570 --> 00:02:48,690
have to buy stuff and you have put money

66
00:02:48,690 --> 00:02:52,290
on it that's really cool on AWS so the

67
00:02:52,290 --> 00:02:54,170
client was particularly interested and

68
00:02:54,170 --> 00:03:00,120
yeah checking out if or assuming I'm

69
00:03:00,120 --> 00:03:00,890
sorry

70
00:03:00,890 --> 00:03:03,600
assuming that attackers gain access

71
00:03:03,600 --> 00:03:05,910
through a compromised web server like

72
00:03:05,910 --> 00:03:07,680
yeah the web application there that can

73
00:03:07,680 --> 00:03:09,240
be anything that can be an online shop

74
00:03:09,240 --> 00:03:12,330
that can be no idea in newspaper sites

75
00:03:12,330 --> 00:03:15,300
or some content management system maybe

76
00:03:15,300 --> 00:03:17,610
like a bird press or something so and

77
00:03:17,610 --> 00:03:20,430
imagine that gets now compromised that

78
00:03:20,430 --> 00:03:22,950
web server is deployed on your internal

79
00:03:22,950 --> 00:03:26,130
network so and externally reachable so

80
00:03:26,130 --> 00:03:28,860
with access on that on their web server

81
00:03:28,860 --> 00:03:30,630
you can now like spread out through the

82
00:03:30,630 --> 00:03:33,120
whole internal network so it's

83
00:03:33,120 --> 00:03:34,470
essentially an internal network

84
00:03:34,470 --> 00:03:38,340
assessment on the cloud basically so and

85
00:03:38,340 --> 00:03:40,590
the goal of the assessment was to get

86
00:03:40,590 --> 00:03:43,860
access to sensitive data as always so on

87
00:03:43,860 --> 00:03:45,780
how do you do that you start with recon

88
00:03:45,780 --> 00:03:47,550
sense and the one thing that is pretty

89
00:03:47,550 --> 00:03:49,290
cool when you're dealing with pretty

90
00:03:49,290 --> 00:03:52,470
large internal networks you want to get

91
00:03:52,470 --> 00:03:55,560
something to look at pretty soon so you

92
00:03:55,560 --> 00:03:57,630
start of course a map I mean everybody

93
00:03:57,630 --> 00:03:59,550
starts at the end map and then you start

94
00:03:59,550 --> 00:04:01,470
with a curtain to get some screenshots

95
00:04:01,470 --> 00:04:04,140
to get like pictures that you can look

96
00:04:04,140 --> 00:04:07,050
at where you can easily spot ok that's a

97
00:04:07,050 --> 00:04:09,540
tomcat and if we see a tomcat and I

98
00:04:09,540 --> 00:04:12,030
think everybody here at rise of foster

99
00:04:12,030 --> 00:04:14,760
default credentials and the 99% of the

100
00:04:14,760 --> 00:04:16,620
case that it works

101
00:04:16,620 --> 00:04:18,660
that's it was not that easy that were at

102
00:04:18,660 --> 00:04:20,370
that time and of course we go but

103
00:04:20,370 --> 00:04:22,290
Metasploit just to go like with the

104
00:04:22,290 --> 00:04:23,790
really really really low hanging fruit

105
00:04:23,790 --> 00:04:27,590
like eternal blue usually always works

106
00:04:27,590 --> 00:04:30,919
yeah that's how it started here also and

107
00:04:30,919 --> 00:04:33,780
that's a cool map that a Croatoan

108
00:04:33,780 --> 00:04:37,740
actually then generates when you when

109
00:04:37,740 --> 00:04:39,330
you do that when you do the expert on

110
00:04:39,330 --> 00:04:42,900
the scan so it's you see like hot spots

111
00:04:42,900 --> 00:04:46,050
and they are like similar so when when

112
00:04:46,050 --> 00:04:48,630
you have Hollis your group by and you

113
00:04:48,630 --> 00:04:50,430
it's a little bit it's a little bit more

114
00:04:50,430 --> 00:04:53,760
bold here then you see they are related

115
00:04:53,760 --> 00:04:56,940
so they made my share like the same

116
00:04:56,940 --> 00:04:59,340
software components they might be able

117
00:04:59,340 --> 00:05:01,650
all it might be all tomcat servers or

118
00:05:01,650 --> 00:05:03,870
all the press servers or something so

119
00:05:03,870 --> 00:05:06,479
it's a little bit cool grouping and it

120
00:05:06,479 --> 00:05:09,650
also it's kind of fancy I mean I like it

121
00:05:09,650 --> 00:05:12,540
yeah then it gives also a little bit

122
00:05:12,540 --> 00:05:14,550
more into detail about the actual

123
00:05:14,550 --> 00:05:16,500
services that are found so you can then

124
00:05:16,500 --> 00:05:19,050
scroll through and look at the services

125
00:05:19,050 --> 00:05:22,110
and yeah that's that's the thing that

126
00:05:22,110 --> 00:05:23,030
we'll talk about today

127
00:05:23,030 --> 00:05:26,640
it's the cementum management console and

128
00:05:26,640 --> 00:05:28,200
it's a mana management console when you

129
00:05:28,200 --> 00:05:30,090
look at it I think it feels a little bit

130
00:05:30,090 --> 00:05:31,770
like like it really early days of the

131
00:05:31,770 --> 00:05:35,640
internet it could use the designer I

132
00:05:35,640 --> 00:05:40,380
think and so it's built on Apache and

133
00:05:40,380 --> 00:05:44,640
it's really really agency so and that's

134
00:05:44,640 --> 00:05:46,139
also something that expert one actually

135
00:05:46,139 --> 00:05:48,419
really does a good job at so at this

136
00:05:48,419 --> 00:05:50,490
place you like the HTTP code this place

137
00:05:50,490 --> 00:05:52,440
you this web server that is used and

138
00:05:52,440 --> 00:05:54,750
then some components that web server is

139
00:05:54,750 --> 00:05:57,510
using you can of course then dive into

140
00:05:57,510 --> 00:05:59,370
details like it captures also like the

141
00:05:59,370 --> 00:06:01,200
HTTP request headers and stuff like that

142
00:06:01,200 --> 00:06:02,669
so if you want to get a little bit more

143
00:06:02,669 --> 00:06:05,160
into that you can do that but it's not

144
00:06:05,160 --> 00:06:06,990
really needed at all that picture

145
00:06:06,990 --> 00:06:10,680
already caught my attention and now we

146
00:06:10,680 --> 00:06:13,770
have it a little bit bigger yeah so

147
00:06:13,770 --> 00:06:15,419
that's basically that's basically the

148
00:06:15,419 --> 00:06:17,880
Internet and you log in interface you

149
00:06:17,880 --> 00:06:19,080
log in under the username and a password

150
00:06:19,080 --> 00:06:21,300
and then you have some check boxes that

151
00:06:21,300 --> 00:06:22,979
you can check to automate some of the

152
00:06:22,979 --> 00:06:25,789
actions when you when you log in and

153
00:06:25,789 --> 00:06:27,810
then there are some links to they have

154
00:06:27,810 --> 00:06:29,320
forums and stuff and

155
00:06:29,320 --> 00:06:32,980
yeah that's basically blog on page so on

156
00:06:32,980 --> 00:06:34,780
just to have a little bit over this

157
00:06:34,780 --> 00:06:37,120
explanation what that actually does so

158
00:06:37,120 --> 00:06:39,490
the cement management console is

159
00:06:39,490 --> 00:06:41,950
actually yeah the management interface

160
00:06:41,950 --> 00:06:44,800
of semantical backup and some in the

161
00:06:44,800 --> 00:06:47,620
cloud backup is a software solution to

162
00:06:47,620 --> 00:06:50,920
backup your internal network to various

163
00:06:50,920 --> 00:06:53,410
cloud backup solutions like you can

164
00:06:53,410 --> 00:06:56,320
backup to s3 buckets you can backup to

165
00:06:56,320 --> 00:06:58,360
Google Cloud you can backup wherever you

166
00:06:58,360 --> 00:07:01,600
want basically and Samana is basically

167
00:07:01,600 --> 00:07:04,780
automating that so and obviously if you

168
00:07:04,780 --> 00:07:07,990
want to upload all of that data to the

169
00:07:07,990 --> 00:07:10,180
cloud you have to get that software

170
00:07:10,180 --> 00:07:13,380
access to your cloud credentials and

171
00:07:13,380 --> 00:07:15,700
that's a juicy part we'll look into that

172
00:07:15,700 --> 00:07:19,360
later so but first of all let's just

173
00:07:19,360 --> 00:07:22,120
Google so we go get a little bit for it

174
00:07:22,120 --> 00:07:25,210
and have a look or any default

175
00:07:25,210 --> 00:07:26,770
credentials because that's usually the

176
00:07:26,770 --> 00:07:28,210
first thing that you do when you see

177
00:07:28,210 --> 00:07:31,600
like an login login form and you're

178
00:07:31,600 --> 00:07:33,340
always wondering did they actually

179
00:07:33,340 --> 00:07:35,380
change the default credentials and yeah

180
00:07:35,380 --> 00:07:37,210
of course not

181
00:07:37,210 --> 00:07:39,010
so the default credentials are admin

182
00:07:39,010 --> 00:07:41,490
admin I think that's very creative and

183
00:07:41,490 --> 00:07:44,230
yeah so they also documented on their

184
00:07:44,230 --> 00:07:46,270
dock on their public documentation so

185
00:07:46,270 --> 00:07:47,800
that's pretty cool it's basically the

186
00:07:47,800 --> 00:07:50,920
first Google result so and after trying

187
00:07:50,920 --> 00:07:54,400
them out you are basically in and it

188
00:07:54,400 --> 00:07:56,650
looks like that so then you're basically

189
00:07:56,650 --> 00:07:58,690
going through that and have a little

190
00:07:58,690 --> 00:08:01,030
look about what's available here and of

191
00:08:01,030 --> 00:08:03,490
course you are looking for secret keys

192
00:08:03,490 --> 00:08:05,970
you're looking for all sorts of

193
00:08:05,970 --> 00:08:08,080
configuration files you're looking for

194
00:08:08,080 --> 00:08:10,630
features that are interesting like stuff

195
00:08:10,630 --> 00:08:13,360
like can you maybe execute comments can

196
00:08:13,360 --> 00:08:15,550
you maybe load configuration files

197
00:08:15,550 --> 00:08:18,220
what about like reporting can you export

198
00:08:18,220 --> 00:08:21,790
something or maybe CSV import export

199
00:08:21,790 --> 00:08:24,280
features can you generate PDF files

200
00:08:24,280 --> 00:08:26,050
stuff like that because you always have

201
00:08:26,050 --> 00:08:28,300
to remember that things deploy on

202
00:08:28,300 --> 00:08:32,110
Macleod and it has the ability to choir

203
00:08:32,110 --> 00:08:34,960
to speak to AWS metadata endpoint and

204
00:08:34,960 --> 00:08:37,900
then you can extract even more keys so

205
00:08:37,900 --> 00:08:39,700
even more keys then they the keys that

206
00:08:39,700 --> 00:08:41,010
you already got

207
00:08:41,010 --> 00:08:43,950
- right now so now you already have some

208
00:08:43,950 --> 00:08:46,290
cool areas secret keys you import them

209
00:08:46,290 --> 00:08:48,270
to the next tool that you that you have

210
00:08:48,270 --> 00:08:50,790
to evaluate a little bit what you have

211
00:08:50,790 --> 00:08:53,370
access to maybe those keys are now

212
00:08:53,370 --> 00:08:55,920
you're all ready to execute code if

213
00:08:55,920 --> 00:08:59,640
you're lucky in that case I was not but

214
00:08:59,640 --> 00:09:01,800
you are going of course a little bit

215
00:09:01,800 --> 00:09:03,330
further and you want to look a little

216
00:09:03,330 --> 00:09:07,500
bit what other features are available so

217
00:09:07,500 --> 00:09:10,140
when I was a cool feature that's in the

218
00:09:10,140 --> 00:09:13,890
Advanced tab of it and that feature

219
00:09:13,890 --> 00:09:16,560
allowed to execute execute comments I

220
00:09:16,560 --> 00:09:18,960
think that's some sort of debug feature

221
00:09:18,960 --> 00:09:20,550
that they want to have and it's also

222
00:09:20,550 --> 00:09:22,290
very dangerous so you see it's like

223
00:09:22,290 --> 00:09:26,270
experts only and since I'm an expert I

224
00:09:26,270 --> 00:09:30,180
looked at that of course and it's they

225
00:09:30,180 --> 00:09:33,420
also like display like behind their only

226
00:09:33,420 --> 00:09:36,360
non interactive comments all out they're

227
00:09:36,360 --> 00:09:39,090
very boring so you don't only want to

228
00:09:39,090 --> 00:09:40,860
get restricted to the comments that you

229
00:09:40,860 --> 00:09:43,950
can execute here and I was thinking okay

230
00:09:43,950 --> 00:09:48,800
what happens if a provider for an input

231
00:09:48,800 --> 00:09:50,940
yeah first of all a little bit sad

232
00:09:50,940 --> 00:09:54,030
because it didn't work that way and I

233
00:09:54,030 --> 00:09:56,400
could really only execute the comments

234
00:09:56,400 --> 00:10:00,570
that were vital sit there but there's

235
00:10:00,570 --> 00:10:04,020
always another way so what happens if

236
00:10:04,020 --> 00:10:07,800
you pipe the output of a comment into

237
00:10:07,800 --> 00:10:11,340
another comment what gets then executed

238
00:10:11,340 --> 00:10:15,390
and you see here the second comment gets

239
00:10:15,390 --> 00:10:19,050
executed so that's cool but the second

240
00:10:19,050 --> 00:10:21,080
comment is actually not even whitelisted

241
00:10:21,080 --> 00:10:24,470
so that's working now but what happens

242
00:10:24,470 --> 00:10:28,530
if you do something like that so now we

243
00:10:28,530 --> 00:10:32,070
have a cure request that requests secret

244
00:10:32,070 --> 00:10:35,400
keys of that that AWS metadata endpoint

245
00:10:35,400 --> 00:10:38,190
and that's not even allowed cool you

246
00:10:38,190 --> 00:10:40,220
can't even access people because that

247
00:10:40,220 --> 00:10:43,770
not whitelisted so now you have access

248
00:10:43,770 --> 00:10:47,040
to even more secret keys that's cool but

249
00:10:47,040 --> 00:10:49,050
you want to get code execution like real

250
00:10:49,050 --> 00:10:50,730
code execution

251
00:10:50,730 --> 00:10:54,690
and how do you do that well yeah you

252
00:10:54,690 --> 00:10:57,960
build some sort of crap comment that you

253
00:10:57,960 --> 00:11:00,420
put in front of like you echo like an A

254
00:11:00,420 --> 00:11:01,860
or something or whatever character you

255
00:11:01,860 --> 00:11:03,450
want to have something that you can just

256
00:11:03,450 --> 00:11:06,810
ignore and then you pipe private

257
00:11:06,810 --> 00:11:08,790
basically and to like something that

258
00:11:08,790 --> 00:11:11,400
tree hits your reverse shell and at that

259
00:11:11,400 --> 00:11:13,620
case it's like a Python comment I'm sure

260
00:11:13,620 --> 00:11:15,210
they're like 200 million other ways to

261
00:11:15,210 --> 00:11:16,950
do that that's just the most reliable

262
00:11:16,950 --> 00:11:19,620
and it worked perfectly so if you

263
00:11:19,620 --> 00:11:24,060
execute that you get in my shell and now

264
00:11:24,060 --> 00:11:27,560
you have basically excess code execution

265
00:11:27,560 --> 00:11:30,840
excess on that code management backup

266
00:11:30,840 --> 00:11:34,020
server and that's pretty cool now so but

267
00:11:34,020 --> 00:11:36,330
the thing is you're a little bit limited

268
00:11:36,330 --> 00:11:38,280
I mean there are default credentials

269
00:11:38,280 --> 00:11:40,860
what if somebody changes them that's

270
00:11:40,860 --> 00:11:43,410
pretty that's pretty sad and and you

271
00:11:43,410 --> 00:11:45,720
also can't really automate that attack

272
00:11:45,720 --> 00:11:50,880
that's also not cool so but maybe if

273
00:11:50,880 --> 00:11:53,580
they don't change the default

274
00:11:53,580 --> 00:11:55,320
credentials you can automate it some

275
00:11:55,320 --> 00:11:58,440
sort so there are some prerequisites

276
00:11:58,440 --> 00:12:00,240
like for example you have to know the IP

277
00:12:00,240 --> 00:12:03,000
address of the server that's also

278
00:12:03,000 --> 00:12:05,160
something which is not ideal if you want

279
00:12:05,160 --> 00:12:07,620
to automate it and recognize it you have

280
00:12:07,620 --> 00:12:10,230
to rely on that they changed actually

281
00:12:10,230 --> 00:12:12,090
that it didn't change the default

282
00:12:12,090 --> 00:12:14,100
credentials something that usually

283
00:12:14,100 --> 00:12:15,780
really works because nobody does that

284
00:12:15,780 --> 00:12:18,920
and yeah if you chained it all together

285
00:12:18,920 --> 00:12:21,930
you can basically lock somebody in

286
00:12:21,930 --> 00:12:23,460
because you can't really rely on that

287
00:12:23,460 --> 00:12:26,340
you the user that you social engineers

288
00:12:26,340 --> 00:12:29,490
actually authenticated often the cases

289
00:12:29,490 --> 00:12:32,730
that you target some sort of network

290
00:12:32,730 --> 00:12:35,640
engineer that has no simple clue about

291
00:12:35,640 --> 00:12:37,770
that service so you want to make sure

292
00:12:37,770 --> 00:12:40,770
that just by clicking on a simple link

293
00:12:40,770 --> 00:12:43,650
that network engineer with access to the

294
00:12:43,650 --> 00:12:46,260
internal network compromised the stat

295
00:12:46,260 --> 00:12:48,570
server so and you have to rely on

296
00:12:48,570 --> 00:12:50,100
default credentials now and you have to

297
00:12:50,100 --> 00:12:51,210
know the IP address

298
00:12:51,210 --> 00:12:53,820
I always then it's working really really

299
00:12:53,820 --> 00:12:56,820
really cool so the proof of concept of

300
00:12:56,820 --> 00:13:00,420
write up is available on github like not

301
00:13:00,420 --> 00:13:01,080
right now

302
00:13:01,080 --> 00:13:06,149
but seconds after their talk but now we

303
00:13:06,149 --> 00:13:07,649
are talking a little bit more about

304
00:13:07,649 --> 00:13:10,680
automating stuff so knowledge over the

305
00:13:10,680 --> 00:13:13,769
IP address now that's a little bit of a

306
00:13:13,769 --> 00:13:14,430
tricky one

307
00:13:14,430 --> 00:13:16,920
so you want to have like a proof of

308
00:13:16,920 --> 00:13:19,589
concept that scans you whole internal

309
00:13:19,589 --> 00:13:21,899
network for IP addresses or hosts that

310
00:13:21,899 --> 00:13:25,380
are active and then basically checks if

311
00:13:25,380 --> 00:13:29,120
those servers that are up are basically

312
00:13:29,120 --> 00:13:31,910
some indirect code management software

313
00:13:31,910 --> 00:13:34,620
hosting fault management software so how

314
00:13:34,620 --> 00:13:36,149
do you do that so there are some cool

315
00:13:36,149 --> 00:13:37,829
guys that really do amazing research

316
00:13:37,829 --> 00:13:41,089
around that like Skylands of matthew ohm

317
00:13:41,089 --> 00:13:43,500
they now if you own developed something

318
00:13:43,500 --> 00:13:46,079
called J as reckon that's a pretty cool

319
00:13:46,079 --> 00:13:50,250
tool and that allows using WebSockets to

320
00:13:50,250 --> 00:13:53,700
scan the internal network and you can it

321
00:13:53,700 --> 00:13:55,920
works with basically with timing timing

322
00:13:55,920 --> 00:13:59,970
attacks so you can that you can build up

323
00:13:59,970 --> 00:14:01,410
like a WebSocket connection to an

324
00:14:01,410 --> 00:14:03,990
arbitrary port and depending on how fast

325
00:14:03,990 --> 00:14:07,410
the ready the very state changes you can

326
00:14:07,410 --> 00:14:09,600
guess if that's open if that's filter or

327
00:14:09,600 --> 00:14:12,060
closed and that all you really need to

328
00:14:12,060 --> 00:14:14,880
know because once we know that service

329
00:14:14,880 --> 00:14:17,370
is actually online you can start with

330
00:14:17,370 --> 00:14:19,829
just picking any file any static file

331
00:14:19,829 --> 00:14:21,360
that you can find on that website

332
00:14:21,360 --> 00:14:23,610
maybe the logo the logo for cement that

333
00:14:23,610 --> 00:14:27,510
works just great or any other picture of

334
00:14:27,510 --> 00:14:29,040
file that is pretty unique to that

335
00:14:29,040 --> 00:14:31,410
service and then you hard-code that in

336
00:14:31,410 --> 00:14:34,620
and then you set up no idea you can set

337
00:14:34,620 --> 00:14:36,540
up like an iframe or an image tag to it

338
00:14:36,540 --> 00:14:38,670
just add like an event handler to that

339
00:14:38,670 --> 00:14:42,000
and let it call let it do something if

340
00:14:42,000 --> 00:14:44,730
it's if it creates an error or not so

341
00:14:44,730 --> 00:14:46,770
any of you do that that works pretty a

342
00:14:46,770 --> 00:14:49,170
pretty amazing and I have a little demo

343
00:14:49,170 --> 00:14:53,160
how that's working for IOT cameras I

344
00:14:53,160 --> 00:14:54,779
hope that the video is actually loading

345
00:14:54,779 --> 00:14:59,730
and it is loading nice so that's my

346
00:14:59,730 --> 00:15:03,290
prior research about IOT devices and

347
00:15:03,290 --> 00:15:05,820
that's basically me implementing that

348
00:15:05,820 --> 00:15:08,220
whole attack for IOT camera it's an HTTP

349
00:15:08,220 --> 00:15:10,860
request baseball mobility it's a common

350
00:15:10,860 --> 00:15:13,120
injection and you see now

351
00:15:13,120 --> 00:15:14,670
network is scanned in the background

352
00:15:14,670 --> 00:15:18,130
once the device is found the militias

353
00:15:18,130 --> 00:15:20,410
request is fired and now you got code

354
00:15:20,410 --> 00:15:23,440
execution let's wait a little bit until

355
00:15:23,440 --> 00:15:30,400
the tailored service is up and there you

356
00:15:30,400 --> 00:15:33,700
go so that's the cool thing now since

357
00:15:33,700 --> 00:15:35,770
when you when you keep that in mind you

358
00:15:35,770 --> 00:15:38,170
can recognize every single IOT attack

359
00:15:38,170 --> 00:15:41,380
that is like HTTP request based so like

360
00:15:41,380 --> 00:15:43,120
it's like if it's a get request if it's

361
00:15:43,120 --> 00:15:45,550
a post request doesn't really matter you

362
00:15:45,550 --> 00:15:48,310
built that using WebSockets you build

363
00:15:48,310 --> 00:15:50,529
some sort of fingerprinting in there so

364
00:15:50,529 --> 00:15:52,180
you can even have like a whole attack

365
00:15:52,180 --> 00:15:54,270
framework here you can build that for

366
00:15:54,270 --> 00:15:57,010
IOT devices like in this case it was a

367
00:15:57,010 --> 00:15:59,890
CCTV camera we can build in there like

368
00:15:59,890 --> 00:16:02,140
the cement a bear and backup management

369
00:16:02,140 --> 00:16:04,210
software and you can like if you build

370
00:16:04,210 --> 00:16:06,250
modules for that you can have a pretty

371
00:16:06,250 --> 00:16:08,320
nice attack framework where you just

372
00:16:08,320 --> 00:16:10,480
have to trick somebody to with it that

373
00:16:10,480 --> 00:16:13,480
side so and maybe you notice that in

374
00:16:13,480 --> 00:16:16,360
that in that video that's the only

375
00:16:16,360 --> 00:16:19,209
little downside of that is that once

376
00:16:19,209 --> 00:16:21,670
that scan is running if you have a large

377
00:16:21,670 --> 00:16:25,029
network that takes time so and you have

378
00:16:25,029 --> 00:16:27,730
to trick the user into actually doing

379
00:16:27,730 --> 00:16:29,920
something that doesn't bore them so you

380
00:16:29,920 --> 00:16:31,990
have to provide them a video or a song

381
00:16:31,990 --> 00:16:34,600
or something that they read imagine you

382
00:16:34,600 --> 00:16:36,130
can also combine it with a cross-site

383
00:16:36,130 --> 00:16:38,440
scripting vulnerability and combine it

384
00:16:38,440 --> 00:16:40,360
with a watering hole attack maybe you

385
00:16:40,360 --> 00:16:42,610
know that your network engineers they

386
00:16:42,610 --> 00:16:44,709
read a specific newspaper every single

387
00:16:44,709 --> 00:16:46,720
morning or something like that and you

388
00:16:46,720 --> 00:16:48,220
find a web application vulnerability

389
00:16:48,220 --> 00:16:49,839
there you inject that malicious

390
00:16:49,839 --> 00:16:52,360
JavaScript code and it's running in the

391
00:16:52,360 --> 00:16:54,450
background usually they probably won't

392
00:16:54,450 --> 00:16:57,010
finish the article in like 10 seconds

393
00:16:57,010 --> 00:17:00,400
hopefully if it's interesting so and if

394
00:17:00,400 --> 00:17:02,380
they stay long enough on that that is

395
00:17:02,380 --> 00:17:04,059
totally totally enough to scan your

396
00:17:04,059 --> 00:17:08,170
network so then getting to the

397
00:17:08,170 --> 00:17:10,929
remediation advice here I mean always

398
00:17:10,929 --> 00:17:12,400
change your default credentials I'm

399
00:17:12,400 --> 00:17:14,980
sorry that's not rocket science but it's

400
00:17:14,980 --> 00:17:16,720
pretty obvious and still people don't do

401
00:17:16,720 --> 00:17:20,020
it then the patch management policy

402
00:17:20,020 --> 00:17:22,089
would be really really helpful so if you

403
00:17:22,089 --> 00:17:23,709
deploy some weird cloud management

404
00:17:23,709 --> 00:17:25,390
software onion at work make sure that

405
00:17:25,390 --> 00:17:27,490
you actually

406
00:17:27,490 --> 00:17:29,890
that's always a nice recommendation to

407
00:17:29,890 --> 00:17:31,840
and them I think the last one is pretty

408
00:17:31,840 --> 00:17:33,850
cool that you can actually ask for pen

409
00:17:33,850 --> 00:17:37,299
test reports to every single time that

410
00:17:37,299 --> 00:17:39,970
your company purchases software or they

411
00:17:39,970 --> 00:17:43,630
want to deploy something like push push

412
00:17:43,630 --> 00:17:46,690
them and ask them for yeah the last pen

413
00:17:46,690 --> 00:17:48,580
test report did they ever do like a

414
00:17:48,580 --> 00:17:51,000
security assessment did they ever try to

415
00:17:51,000 --> 00:17:55,510
to show yeah if they actually care about

416
00:17:55,510 --> 00:17:58,210
security make it part of the whole sales

417
00:17:58,210 --> 00:18:01,240
process so if you want to if you want to

418
00:18:01,240 --> 00:18:03,160
buy a tool tell your procurement

419
00:18:03,160 --> 00:18:05,290
department if there's no painters report

420
00:18:05,290 --> 00:18:08,110
I'm sorry won't buy and that would be a

421
00:18:08,110 --> 00:18:09,400
cool cool idea already

422
00:18:09,400 --> 00:18:11,470
and then don't only request the

423
00:18:11,470 --> 00:18:12,940
panther's report send it to your

424
00:18:12,940 --> 00:18:15,160
security guys or to somebody who knows

425
00:18:15,160 --> 00:18:17,049
it and let them interpret dependents

426
00:18:17,049 --> 00:18:19,900
report if that's looking really really

427
00:18:19,900 --> 00:18:22,059
bad maybe consider another vendor there

428
00:18:22,059 --> 00:18:23,980
are so many you don't have to go with

429
00:18:23,980 --> 00:18:27,429
the first one so yeah and that's

430
00:18:27,429 --> 00:18:30,070
basically it if there are any questions

431
00:18:30,070 --> 00:18:32,400
I'm more than happy to answer them

432
00:18:32,400 --> 00:18:34,870
[Music]

433
00:18:34,870 --> 00:18:38,030
[Applause]

