1
00:00:05,690 --> 00:00:11,090
so me and Bernardo<font color="#CCCCCC"> we will talk about</font><font color="#E5E5E5"> I</font>

2
00:00:09,590 --> 00:00:13,759
would<font color="#CCCCCC"> win you would you</font><font color="#E5E5E5"> basically did</font>

3
00:00:11,090 --> 00:00:15,759
some research in in you<font color="#E5E5E5"> would based yeah</font>

4
00:00:13,759 --> 00:00:18,140
bootloaders good kids in<font color="#E5E5E5"> this case and</font>

5
00:00:15,759 --> 00:00:20,390
yeah we're<font color="#CCCCCC"> gonna talk about what</font><font color="#E5E5E5"> we did</font>

6
00:00:18,140 --> 00:00:21,949
so first<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> have an introduction we</font>

7
00:00:20,390 --> 00:00:23,539
<font color="#E5E5E5">talk about ourselves what we do who we</font>

8
00:00:21,949 --> 00:00:25,130
are<font color="#E5E5E5"> and then we're going to talk about</font>

9
00:00:23,539 --> 00:00:27,199
<font color="#CCCCCC">malware that already exists for a meta</font>

10
00:00:25,130 --> 00:00:28,698
devices and we'll talk about the boot

11
00:00:27,199 --> 00:00:31,039
process of a meta device how it works

12
00:00:28,699 --> 00:00:33,650
and<font color="#E5E5E5"> then how we gain persistence on a</font>

13
00:00:31,039 --> 00:00:35,300
<font color="#E5E5E5">better device</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> case on you good then</font>

14
00:00:33,650 --> 00:00:36,710
we're<font color="#CCCCCC"> gonna talk about writing a boot</font>

15
00:00:35,300 --> 00:00:40,129
kit and then about how you can mitigate

16
00:00:36,710 --> 00:00:40,910
and detect these type of<font color="#E5E5E5"> good kids so my</font>

17
00:00:40,129 --> 00:00:42,290
name is Vincent

18
00:00:40,910 --> 00:00:44,239
I<font color="#CCCCCC"> work in the Cape your red team we're</font>

19
00:00:42,290 --> 00:00:46,039
located in Amsterdam<font color="#CCCCCC"> I used to work as a</font>

20
00:00:44,239 --> 00:00:50,120
<font color="#CCCCCC">consultant but now I'm a happy red team</font>

21
00:00:46,039 --> 00:00:51,559
<font color="#E5E5E5">or at</font><font color="#CCCCCC"> kpn</font><font color="#E5E5E5"> yeah i'm i've also motivating</font>

22
00:00:50,120 --> 00:00:53,449
for<font color="#E5E5E5"> new amsterdam it's a community</font>

23
00:00:51,559 --> 00:00:54,829
chapter so if you<font color="#E5E5E5"> ever come by amsterdam</font>

24
00:00:53,449 --> 00:00:56,809
you have a topic<font color="#E5E5E5"> to talk about</font><font color="#CCCCCC"> feel free</font>

25
00:00:54,829 --> 00:01:02,680
<font color="#CCCCCC">to contact</font><font color="#E5E5E5"> me and we can</font><font color="#CCCCCC"> organise</font>

26
00:00:56,809 --> 00:01:05,360
something yeah so my name<font color="#E5E5E5"> is Bernardo</font>

27
00:01:02,680 --> 00:01:07,130
I'm Brazilian so I can probably give

28
00:01:05,360 --> 00:01:08,420
this talk in Portuguese but I'm gonna

29
00:01:07,130 --> 00:01:11,208
stick<font color="#CCCCCC"> to</font><font color="#E5E5E5"> English</font>

30
00:01:08,420 --> 00:01:13,160
I'm also<font color="#E5E5E5"> based in Amsterdam</font><font color="#CCCCCC"> I work for</font>

31
00:01:11,209 --> 00:01:15,890
<font color="#CCCCCC">kpn which is a telco</font><font color="#E5E5E5"> for the Cape in</font><font color="#CCCCCC"> Red</font>

32
00:01:13,160 --> 00:01:18,289
<font color="#CCCCCC">Team I'm a big</font><font color="#E5E5E5"> Brunel Asia</font><font color="#CCCCCC"> Pan you guys</font>

33
00:01:15,890 --> 00:01:20,569
know Brunel issue yeah Alicia's awesome

34
00:01:18,289 --> 00:01:22,099
and yeah sometimes<font color="#E5E5E5"> I play CTF so if the</font>

35
00:01:20,569 --> 00:01:23,959
<font color="#CCCCCC">goonies which is a Brazilian CTF team</font>

36
00:01:22,099 --> 00:01:25,580
and I'm really good at<font color="#E5E5E5"> wreaking routers</font>

37
00:01:23,959 --> 00:01:27,619
so if you need any advice on breaking

38
00:01:25,580 --> 00:01:30,470
your devices you can just ask<font color="#E5E5E5"> me so I</font>

39
00:01:27,619 --> 00:01:31,250
<font color="#E5E5E5">will</font><font color="#CCCCCC"> start</font><font color="#E5E5E5"> talking</font><font color="#CCCCCC"> about power</font><font color="#E5E5E5"> on and by</font>

40
00:01:30,470 --> 00:01:33,349
the<font color="#E5E5E5"> devices</font>

41
00:01:31,250 --> 00:01:35,599
yes<font color="#CCCCCC"> Paulie roulette it's nothing</font><font color="#E5E5E5"> new so</font>

42
00:01:33,349 --> 00:01:38,060
Mirai I think most people<font color="#E5E5E5"> heard about</font>

43
00:01:35,599 --> 00:01:40,670
Mirai which it was just like scanning

44
00:01:38,060 --> 00:01:43,310
the<font color="#CCCCCC"> internet finding devices with like</font>

45
00:01:40,670 --> 00:01:45,410
<font color="#E5E5E5">hard-coded passwords infecting them and</font>

46
00:01:43,310 --> 00:01:47,660
<font color="#CCCCCC">mirai for example it doesn't</font><font color="#E5E5E5"> care about</font>

47
00:01:45,410 --> 00:01:51,348
persistence so me ride just like

48
00:01:47,660 --> 00:01:52,729
<font color="#CCCCCC">hacker device and</font><font color="#E5E5E5"> like if it doesn't</font>

49
00:01:51,349 --> 00:01:55,310
care about<font color="#CCCCCC"> precision so if you just</font>

50
00:01:52,729 --> 00:01:57,500
reboot the device if<font color="#CCCCCC"> tomorrow is gone so</font>

51
00:01:55,310 --> 00:01:59,539
and it's so fast<font color="#CCCCCC"> for it because</font><font color="#E5E5E5"> it's</font>

52
00:01:57,500 --> 00:02:01,729
constantly scanning the<font color="#CCCCCC"> Internet so</font><font color="#E5E5E5"> far</font>

53
00:01:59,539 --> 00:02:03,470
your device<font color="#E5E5E5"> will get after you reboot</font>

54
00:02:01,729 --> 00:02:03,979
<font color="#E5E5E5">your device you get to</font><font color="#CCCCCC"> infect</font><font color="#E5E5E5"> it really</font>

55
00:02:03,470 --> 00:02:05,720
fast

56
00:02:03,979 --> 00:02:08,449
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> autumn hours like</font><font color="#E5E5E5"> Lua</font><font color="#CCCCCC"> Bhatt</font>

57
00:02:05,720 --> 00:02:11,510
<font color="#E5E5E5">was targeting also cable modems</font><font color="#CCCCCC"> I posted</font>

58
00:02:08,449 --> 00:02:14,119
a<font color="#CCCCCC"> write-up about</font><font color="#E5E5E5"> it the moon some of</font>

59
00:02:11,510 --> 00:02:16,010
those who are like the karna as well<font color="#CCCCCC"> is</font>

60
00:02:14,120 --> 00:02:17,960
<font color="#E5E5E5">really</font><font color="#CCCCCC"> interesting one which was one of</font>

61
00:02:16,010 --> 00:02:19,160
<font color="#CCCCCC">the post first malware that would try to</font>

62
00:02:17,960 --> 00:02:21,380
like scan the intern

63
00:02:19,160 --> 00:02:23,210
as a whole in<font color="#CCCCCC"> fact and by the device in</font>

64
00:02:21,380 --> 00:02:24,950
the also start scanning and like an

65
00:02:23,210 --> 00:02:27,080
anonymous research had posted all<font color="#CCCCCC"> the</font>

66
00:02:24,950 --> 00:02:29,089
results from the karna botnet so he

67
00:02:27,080 --> 00:02:31,640
created he wrote like<font color="#CCCCCC"> a paper after</font>

68
00:02:29,090 --> 00:02:32,900
infecting lots of<font color="#CCCCCC"> devices</font><font color="#E5E5E5"> mower and he</font>

69
00:02:31,640 --> 00:02:34,850
wrote a mower<font color="#CCCCCC"> that</font><font color="#E5E5E5"> wound infected</font>

70
00:02:32,900 --> 00:02:36,680
<font color="#CCCCCC">embedded devices and he wrote</font><font color="#E5E5E5"> like</font>

71
00:02:34,850 --> 00:02:40,820
started scanning the internet<font color="#E5E5E5"> with all</font>

72
00:02:36,680 --> 00:02:44,750
those<font color="#E5E5E5"> mower but</font><font color="#CCCCCC"> also like flasher dot a</font>

73
00:02:40,820 --> 00:02:47,329
and the<font color="#E5E5E5"> CIA</font><font color="#CCCCCC"> cherry blossom</font><font color="#E5E5E5"> so the flash</font>

74
00:02:44,750 --> 00:02:51,560
<font color="#CCCCCC">shot</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> which he who</font><font color="#E5E5E5"> was more something</font>

75
00:02:47,330 --> 00:02:53,150
<font color="#E5E5E5">more talk focused on German and he this</font>

76
00:02:51,560 --> 00:02:55,220
<font color="#CCCCCC">model would</font><font color="#E5E5E5"> exploit like a community</font>

77
00:02:53,150 --> 00:02:56,260
<font color="#E5E5E5">injection on dd-wrt</font><font color="#CCCCCC"> which is an</font>

78
00:02:55,220 --> 00:02:59,780
<font color="#CCCCCC">open-source</font>

79
00:02:56,260 --> 00:03:03,260
<font color="#E5E5E5">femur for like</font><font color="#CCCCCC"> routers and then it would</font>

80
00:02:59,780 --> 00:03:06,020
reflect the femur with a modified<font color="#E5E5E5"> the TT</font>

81
00:03:03,260 --> 00:03:07,910
<font color="#CCCCCC">and this modified had things like</font><font color="#E5E5E5"> Disney</font>

82
00:03:06,020 --> 00:03:10,160
<font color="#E5E5E5">we know things like that they could</font>

83
00:03:07,910 --> 00:03:12,440
sniff passwords in<font color="#CCCCCC"> plant which were</font>

84
00:03:10,160 --> 00:03:14,600
going<font color="#E5E5E5"> through playing the network in</font>

85
00:03:12,440 --> 00:03:16,370
<font color="#CCCCCC">plaintext</font><font color="#E5E5E5"> and also touch the CIA cherry</font>

86
00:03:14,600 --> 00:03:19,160
blossom which is also<font color="#E5E5E5"> interesting</font>

87
00:03:16,370 --> 00:03:21,470
it's more of an implant<font color="#CCCCCC"> than an hour so</font>

88
00:03:19,160 --> 00:03:23,450
because the CIA operates<font color="#E5E5E5"> kind of</font>

89
00:03:21,470 --> 00:03:25,370
different from NSA<font color="#CCCCCC"> NSA</font><font color="#E5E5E5"> it's more like</font>

90
00:03:23,450 --> 00:03:27,500
signals intelligence and remote things

91
00:03:25,370 --> 00:03:29,600
and the CIA<font color="#E5E5E5"> because they would just</font><font color="#CCCCCC"> go</font>

92
00:03:27,500 --> 00:03:31,640
to<font color="#E5E5E5"> your house and implant things so</font>

93
00:03:29,600 --> 00:03:34,640
which is the CIA cherry blossom<font color="#CCCCCC"> its own</font>

94
00:03:31,640 --> 00:03:38,209
vault<font color="#E5E5E5"> five WikiLeaks documents but it's</font>

95
00:03:34,640 --> 00:03:40,700
like basically<font color="#CCCCCC"> also modified dd-wrt</font><font color="#E5E5E5"> open</font>

96
00:03:38,210 --> 00:03:43,220
wrt<font color="#E5E5E5"> images with like two kids and</font>

97
00:03:40,700 --> 00:03:46,940
everything<font color="#E5E5E5"> they need to</font><font color="#CCCCCC"> infect your</font>

98
00:03:43,220 --> 00:03:48,740
<font color="#E5E5E5">embedded device</font><font color="#CCCCCC"> now I'm going to</font><font color="#E5E5E5"> talk</font>

99
00:03:46,940 --> 00:03:50,240
about<font color="#E5E5E5"> the boo-boos on</font><font color="#CCCCCC"> a meta device so</font>

100
00:03:48,740 --> 00:03:52,280
the moment you you turn on your meta

101
00:03:50,240 --> 00:03:53,840
device it jumps to<font color="#E5E5E5"> like the nor flash</font>

102
00:03:52,280 --> 00:03:56,120
<font color="#E5E5E5">and it contains some bootstrap code and</font>

103
00:03:53,840 --> 00:03:58,880
initializes from<font color="#E5E5E5"> hardware does</font><font color="#CCCCCC"> oppose a</font>

104
00:03:56,120 --> 00:04:00,380
minute on<font color="#CCCCCC"> LZ maze the yeah the</font>

105
00:03:58,880 --> 00:04:01,970
bootloader<font color="#CCCCCC"> into RAM memory and then it</font>

106
00:04:00,380 --> 00:04:04,130
jumps<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the bootloader</font>

107
00:04:01,970 --> 00:04:05,450
the bootloader<font color="#E5E5E5"> then yeah also initialize</font>

108
00:04:04,130 --> 00:04:08,390
something<font color="#E5E5E5"> so</font><font color="#CCCCCC"> hardware doesn't</font><font color="#E5E5E5"> matter</font>

109
00:04:05,450 --> 00:04:09,950
<font color="#E5E5E5">post checking and finds the kernel</font><font color="#CCCCCC"> and</font>

110
00:04:08,390 --> 00:04:12,290
<font color="#CCCCCC">decompresses the kernel into ROM memory</font>

111
00:04:09,950 --> 00:04:14,929
then jumps to<font color="#E5E5E5"> the kernel and the kernel</font>

112
00:04:12,290 --> 00:04:16,519
then takes<font color="#E5E5E5"> over and the kernel does</font><font color="#CCCCCC"> yeah</font>

113
00:04:14,930 --> 00:04:18,290
initializes some file system kernel

114
00:04:16,519 --> 00:04:20,149
modules so you<font color="#E5E5E5"> can actually mount the</font>

115
00:04:18,290 --> 00:04:22,130
<font color="#CCCCCC">filesystem of your meta device and then</font>

116
00:04:20,149 --> 00:04:24,320
runs in it on<font color="#E5E5E5"> the filesystem</font><font color="#CCCCCC"> and your</font>

117
00:04:22,130 --> 00:04:26,240
device is running and here you have a

118
00:04:24,320 --> 00:04:30,020
<font color="#E5E5E5">nice</font><font color="#CCCCCC"> graph if the bootloader</font><font color="#E5E5E5"> doesn't</font>

119
00:04:26,240 --> 00:04:32,120
pose for you<font color="#E5E5E5"> oh yeah</font><font color="#CCCCCC"> so I'm a left guy</font>

120
00:04:30,020 --> 00:04:32,630
so it's fine so here would<font color="#E5E5E5"> be some</font>

121
00:04:32,120 --> 00:04:34,310
bootstrap

122
00:04:32,630 --> 00:04:36,290
for<font color="#E5E5E5"> uh Nels emailing the bootloader and</font>

123
00:04:34,310 --> 00:04:38,540
<font color="#E5E5E5">attack jumps to the favour</font><font color="#CCCCCC"> else email</font>

124
00:04:36,290 --> 00:04:40,190
compasses<font color="#E5E5E5"> the kernel basically it</font>

125
00:04:38,540 --> 00:04:45,860
<font color="#E5E5E5">becomes the operating system and then</font>

126
00:04:40,190 --> 00:04:47,510
yeah that's<font color="#CCCCCC"> basically</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> so yeah</font><font color="#E5E5E5"> what</font>

127
00:04:45,860 --> 00:04:49,370
are the<font color="#E5E5E5"> advantages of like getting a</font>

128
00:04:47,510 --> 00:04:50,780
<font color="#E5E5E5">persistent on a boot keep level the</font>

129
00:04:49,370 --> 00:04:53,480
first thing it's<font color="#CCCCCC"> very interesting like</font>

130
00:04:50,780 --> 00:04:56,059
<font color="#CCCCCC">firmware upgrades</font><font color="#E5E5E5"> they normally want</font>

131
00:04:53,480 --> 00:04:59,180
mess with the<font color="#E5E5E5"> bootloader</font><font color="#CCCCCC"> because it's</font>

132
00:04:56,060 --> 00:05:01,160
very<font color="#CCCCCC"> easy for you to</font><font color="#E5E5E5"> mess so for example</font>

133
00:04:59,180 --> 00:05:03,350
you<font color="#E5E5E5"> have like an Asus devices</font><font color="#CCCCCC"> and links</font>

134
00:05:01,160 --> 00:05:05,180
<font color="#CCCCCC">ease</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you go to the vendor website</font>

135
00:05:03,350 --> 00:05:07,820
there's an update so I don't know crack

136
00:05:05,180 --> 00:05:09,440
you<font color="#CCCCCC"> the new vulnerability so you have to</font>

137
00:05:07,820 --> 00:05:10,849
<font color="#CCCCCC">upgrade your femur so you go to the</font>

138
00:05:09,440 --> 00:05:13,430
others website you download the<font color="#E5E5E5"> new</font>

139
00:05:10,850 --> 00:05:15,800
femur and you go to the<font color="#CCCCCC"> Browse to router</font>

140
00:05:13,430 --> 00:05:19,430
<font color="#CCCCCC">settings and you upload a new</font><font color="#E5E5E5"> femur and</font>

141
00:05:15,800 --> 00:05:21,350
<font color="#E5E5E5">if most of the times like this new femur</font>

142
00:05:19,430 --> 00:05:22,700
which only change like the partitions

143
00:05:21,350 --> 00:05:24,890
related to actually like the firmware

144
00:05:22,700 --> 00:05:27,229
<font color="#E5E5E5">file system and the bootloader won't be</font>

145
00:05:24,890 --> 00:05:28,640
changing at<font color="#E5E5E5"> all so if you have like a</font>

146
00:05:27,230 --> 00:05:30,860
persistence on the bootloader level

147
00:05:28,640 --> 00:05:33,200
<font color="#E5E5E5">someone reflexes is someone like restore</font>

148
00:05:30,860 --> 00:05:35,270
to factory default then you still<font color="#CCCCCC"> have</font>

149
00:05:33,200 --> 00:05:37,909
like that modifications on you boot

150
00:05:35,270 --> 00:05:40,280
<font color="#E5E5E5">settings and it's also very difficult to</font>

151
00:05:37,910 --> 00:05:43,070
detect<font color="#E5E5E5"> so like most security teams are</font>

152
00:05:40,280 --> 00:05:45,289
kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> not ready to the tactics</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it</font>

153
00:05:43,070 --> 00:05:47,659
also bypasses operating system<font color="#E5E5E5"> security</font>

154
00:05:45,290 --> 00:05:50,360
features which on embedded devices<font color="#E5E5E5"> cases</font>

155
00:05:47,660 --> 00:05:53,330
it's nothing soft but it's<font color="#CCCCCC"> still</font>

156
00:05:50,360 --> 00:05:55,250
bypassing it's also<font color="#E5E5E5"> very specific to</font>

157
00:05:53,330 --> 00:05:57,469
<font color="#E5E5E5">your system on chip to write a try the</font>

158
00:05:55,250 --> 00:05:59,390
bootloader<font color="#E5E5E5"> a boot kit because every</font>

159
00:05:57,470 --> 00:06:01,580
system has their own variables and you

160
00:05:59,390 --> 00:06:03,380
know their own<font color="#E5E5E5"> the chip drivers and</font>

161
00:06:01,580 --> 00:06:03,979
everything so it's it's kind<font color="#CCCCCC"> of hard to</font>

162
00:06:03,380 --> 00:06:07,430
<font color="#E5E5E5">write one</font>

163
00:06:03,980 --> 00:06:09,440
so yeah disadvantages so it's really

164
00:06:07,430 --> 00:06:12,320
cool so you have persistence sometimes

165
00:06:09,440 --> 00:06:14,480
you may<font color="#E5E5E5"> mess things so you Snowden</font>

166
00:06:12,320 --> 00:06:17,210
documents<font color="#CCCCCC"> there's like these news and I</font>

167
00:06:14,480 --> 00:06:20,090
say<font color="#E5E5E5"> accidentally</font><font color="#CCCCCC"> cause Syria internet</font>

168
00:06:17,210 --> 00:06:23,090
blackout in 2012<font color="#CCCCCC"> so what NSA</font><font color="#E5E5E5"> was doing</font>

169
00:06:20,090 --> 00:06:26,060
<font color="#CCCCCC">they</font><font color="#E5E5E5"> they like had all those implants</font>

170
00:06:23,090 --> 00:06:28,820
all those<font color="#E5E5E5"> routers</font><font color="#CCCCCC"> from switches from</font>

171
00:06:26,060 --> 00:06:30,890
Syria<font color="#E5E5E5"> and they all</font><font color="#CCCCCC"> one word</font><font color="#E5E5E5"> wanted to</font>

172
00:06:28,820 --> 00:06:33,050
like white<font color="#CCCCCC"> rap or white tapped</font><font color="#E5E5E5"> internet</font>

173
00:06:30,890 --> 00:06:34,669
<font color="#E5E5E5">they want to</font><font color="#CCCCCC"> also like real commodity</font>

174
00:06:33,050 --> 00:06:37,430
<font color="#CCCCCC">they want to see traffic</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> that</font>

175
00:06:34,670 --> 00:06:39,170
country<font color="#CCCCCC"> so there were they had issues</font>

176
00:06:37,430 --> 00:06:41,479
while upgrading the femur or<font color="#E5E5E5"> doing</font>

177
00:06:39,170 --> 00:06:43,580
<font color="#E5E5E5">something like that</font><font color="#CCCCCC"> and the device is</font>

178
00:06:41,479 --> 00:06:45,530
like the whole internet<font color="#CCCCCC"> started working</font>

179
00:06:43,580 --> 00:06:46,479
from the country<font color="#CCCCCC"> you can like you can</font>

180
00:06:45,530 --> 00:06:48,429
always blame

181
00:06:46,480 --> 00:06:51,100
other things but it's something

182
00:06:48,430 --> 00:06:53,230
difficult<font color="#E5E5E5"> for you to maintain so</font>

183
00:06:51,100 --> 00:06:55,300
<font color="#E5E5E5">everything every device is different if</font>

184
00:06:53,230 --> 00:06:58,030
you're<font color="#E5E5E5"> changing the bootloader</font><font color="#CCCCCC"> you may</font>

185
00:06:55,300 --> 00:07:01,210
<font color="#E5E5E5">brick the device so it's it's difficult</font>

186
00:06:58,030 --> 00:07:02,559
<font color="#E5E5E5">it's something more sensitive so there</font>

187
00:07:01,210 --> 00:07:03,940
<font color="#E5E5E5">are different ways</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get persistence on</font>

188
00:07:02,560 --> 00:07:05,590
a meta devices just like<font color="#E5E5E5"> on a regular</font>

189
00:07:03,940 --> 00:07:08,770
Linux system<font color="#CCCCCC"> you can change the any</font>

190
00:07:05,590 --> 00:07:10,719
<font color="#CCCCCC">script</font><font color="#E5E5E5"> so you mount mount filesystem</font><font color="#CCCCCC"> add</font>

191
00:07:08,770 --> 00:07:12,909
some code to an<font color="#E5E5E5"> inner script or you you</font>

192
00:07:10,720 --> 00:07:15,370
add a binary that gets kicked off<font color="#E5E5E5"> by in</font>

193
00:07:12,910 --> 00:07:18,490
it<font color="#E5E5E5"> you can also create a loadable kernel</font>

194
00:07:15,370 --> 00:07:22,360
module you<font color="#E5E5E5"> can modify your phi bios or</font>

195
00:07:18,490 --> 00:07:24,070
<font color="#E5E5E5">you can change MBR or</font><font color="#CCCCCC"> gbr records yeah</font>

196
00:07:22,360 --> 00:07:26,170
what we do or we'll talk about it later

197
00:07:24,070 --> 00:07:28,719
<font color="#CCCCCC">so</font><font color="#E5E5E5"> yeah we're talking</font><font color="#CCCCCC"> about boot kits</font>

198
00:07:26,170 --> 00:07:30,550
and again boot kits are nothing new<font color="#CCCCCC"> so</font>

199
00:07:28,720 --> 00:07:34,840
there<font color="#E5E5E5"> are like no boot kids so far</font>

200
00:07:30,550 --> 00:07:36,790
<font color="#E5E5E5">things like mebroot</font><font color="#CCCCCC"> Roughnecks bro</font><font color="#E5E5E5"> me</font>

201
00:07:34,840 --> 00:07:38,650
<font color="#E5E5E5">and some of those boot kids are also</font>

202
00:07:36,790 --> 00:07:40,690
targeting Linux<font color="#E5E5E5"> in the case it's the</font>

203
00:07:38,650 --> 00:07:42,099
<font color="#E5E5E5">case of</font><font color="#CCCCCC"> the old boot so if you google</font>

204
00:07:40,690 --> 00:07:44,260
<font color="#CCCCCC">online there</font><font color="#E5E5E5"> are like some write-ups</font>

205
00:07:42,100 --> 00:07:48,700
about it and people<font color="#E5E5E5"> are not exactly sure</font>

206
00:07:44,260 --> 00:07:50,770
if<font color="#E5E5E5"> it's like from apk you get you it</font>

207
00:07:48,700 --> 00:07:53,500
infects your<font color="#CCCCCC"> bootloader or if it's like</font>

208
00:07:50,770 --> 00:07:55,750
a firmware implant like the vendor was

209
00:07:53,500 --> 00:07:58,060
already infected<font color="#E5E5E5"> so if you need to</font>

210
00:07:55,750 --> 00:08:01,450
change the<font color="#E5E5E5"> bootloader thing code you</font>

211
00:07:58,060 --> 00:08:04,060
have<font color="#CCCCCC"> to have root on the device and this</font>

212
00:08:01,450 --> 00:08:06,610
<font color="#E5E5E5">was basically a modified bootloader that</font>

213
00:08:04,060 --> 00:08:08,680
would<font color="#CCCCCC"> like</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> to act as a trojan and</font>

214
00:08:06,610 --> 00:08:11,860
<font color="#E5E5E5">also it's</font><font color="#CCCCCC"> very interesting the hacking</font>

215
00:08:08,680 --> 00:08:14,050
team<font color="#E5E5E5"> UEFI so it's more like an implant</font>

216
00:08:11,860 --> 00:08:16,540
<font color="#CCCCCC">and I'm right I wrote</font><font color="#E5E5E5"> there that is</font><font color="#CCCCCC"> an</font>

217
00:08:14,050 --> 00:08:18,730
<font color="#CCCCCC">implant it and the method of infection</font>

218
00:08:16,540 --> 00:08:20,860
<font color="#CCCCCC">research because you know surgery is</font>

219
00:08:18,730 --> 00:08:24,640
like<font color="#E5E5E5"> guy working for the hacking team</font>

220
00:08:20,860 --> 00:08:27,490
<font color="#E5E5E5">and they wild like they had demos and</font>

221
00:08:24,640 --> 00:08:30,250
<font color="#CCCCCC">pox for for like their</font><font color="#E5E5E5"> client and he</font>

222
00:08:27,490 --> 00:08:32,560
would just<font color="#E5E5E5"> like</font><font color="#CCCCCC"> fool the</font><font color="#E5E5E5"> the clients and</font>

223
00:08:30,250 --> 00:08:34,830
like disable antivirus<font color="#CCCCCC"> while he was like</font>

224
00:08:32,559 --> 00:08:37,719
in fact in<font color="#E5E5E5"> devices and making them oh so</font>

225
00:08:34,830 --> 00:08:40,240
he's kind of the infection mechanism so

226
00:08:37,720 --> 00:08:41,979
the<font color="#E5E5E5"> hacking team are k-loader there's a</font>

227
00:08:40,240 --> 00:08:47,860
really cool<font color="#E5E5E5"> right up from the</font><font color="#CCCCCC"> Intel guys</font>

228
00:08:41,979 --> 00:08:50,440
<font color="#E5E5E5">what it does it puts like files why</font>

229
00:08:47,860 --> 00:08:53,080
we're loading<font color="#E5E5E5"> the</font><font color="#CCCCCC"> filesystem your NTFS</font>

230
00:08:50,440 --> 00:08:55,720
<font color="#E5E5E5">filesystem on</font><font color="#CCCCCC"> windows case it would load</font>

231
00:08:53,080 --> 00:08:57,370
a binary and if you format your<font color="#CCCCCC"> Windows</font>

232
00:08:55,720 --> 00:09:00,660
install<font color="#E5E5E5"> bf</font>

233
00:08:57,370 --> 00:09:04,000
<font color="#CCCCCC">I UEFI if it's backdoor</font><font color="#E5E5E5"> it would</font>

234
00:09:00,660 --> 00:09:06,069
<font color="#E5E5E5">download the code</font><font color="#CCCCCC"> and run again</font><font color="#E5E5E5"> so there</font>

235
00:09:04,000 --> 00:09:08,950
<font color="#E5E5E5">are like</font><font color="#CCCCCC"> different methods</font><font color="#E5E5E5"> so some</font>

236
00:09:06,070 --> 00:09:10,690
<font color="#CCCCCC">motherboards some laptops</font><font color="#E5E5E5"> they had like</font>

237
00:09:08,950 --> 00:09:13,270
some vulnerabilities for example the

238
00:09:10,690 --> 00:09:15,430
right protection<font color="#E5E5E5"> is not enabled</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you</font>

239
00:09:13,270 --> 00:09:19,150
could remotely<font color="#E5E5E5"> so if you get root on a</font>

240
00:09:15,430 --> 00:09:20,890
<font color="#CCCCCC">machine you may rewrite some variables</font>

241
00:09:19,150 --> 00:09:23,740
or something and then<font color="#E5E5E5"> you can put the</font>

242
00:09:20,890 --> 00:09:26,140
hacking team<font color="#CCCCCC"> backdoor there</font><font color="#E5E5E5"> but</font>

243
00:09:23,740 --> 00:09:28,180
sometimes when this is not<font color="#CCCCCC"> possible if</font>

244
00:09:26,140 --> 00:09:30,189
you have<font color="#CCCCCC"> physical access</font><font color="#E5E5E5"> you can open</font>

245
00:09:28,180 --> 00:09:32,319
the device and<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> dub the SPI</font><font color="#E5E5E5"> and</font>

246
00:09:30,190 --> 00:09:34,660
<font color="#E5E5E5">you can rewrite the SPI with new</font>

247
00:09:32,320 --> 00:09:39,910
settings or if the backdoor

248
00:09:34,660 --> 00:09:42,610
content so yeah<font color="#E5E5E5"> that's you I</font><font color="#CCCCCC"> thought</font>

249
00:09:39,910 --> 00:09:44,920
<font color="#E5E5E5">when you boot which we wrote it's like</font>

250
00:09:42,610 --> 00:09:46,750
kind<font color="#E5E5E5"> of like a boot keep</font><font color="#CCCCCC"> targeting your</font>

251
00:09:44,920 --> 00:09:48,400
boot<font color="#CCCCCC"> and by the</font><font color="#E5E5E5"> device is using your</font>

252
00:09:46,750 --> 00:09:51,279
<font color="#E5E5E5">boot and your boot</font><font color="#CCCCCC"> is like an</font>

253
00:09:48,400 --> 00:09:54,970
<font color="#CCCCCC">open-source</font><font color="#E5E5E5"> bootloader and we need an</font>

254
00:09:51,279 --> 00:09:56,380
initial access so we're just<font color="#E5E5E5"> like we can</font>

255
00:09:54,970 --> 00:09:58,570
<font color="#CCCCCC">infect in device if you have</font><font color="#E5E5E5"> physical</font>

256
00:09:56,380 --> 00:10:00,640
access<font color="#CCCCCC"> or we can infect the devices</font>

257
00:09:58,570 --> 00:10:02,230
remotely and we<font color="#E5E5E5"> we have like we were</font>

258
00:10:00,640 --> 00:10:03,910
<font color="#E5E5E5">thinking like about something like we</font>

259
00:10:02,230 --> 00:10:05,800
want<font color="#CCCCCC"> route on a machine</font><font color="#E5E5E5"> and we want to</font>

260
00:10:03,910 --> 00:10:08,650
change the bootloader we want to change

261
00:10:05,800 --> 00:10:11,560
this partition<font color="#E5E5E5"> so we need an initial</font>

262
00:10:08,650 --> 00:10:14,260
exploit<font color="#E5E5E5"> go back and yeah some examples</font>

263
00:10:11,560 --> 00:10:17,589
of exploits that<font color="#E5E5E5"> we can use it's like</font>

264
00:10:14,260 --> 00:10:20,589
the<font color="#E5E5E5"> Samba cry which is like if you have</font>

265
00:10:17,589 --> 00:10:23,950
<font color="#E5E5E5">if you can save a file to a Samba share</font>

266
00:10:20,589 --> 00:10:25,839
and you<font color="#E5E5E5"> can put like</font><font color="#CCCCCC"> a library there and</font>

267
00:10:23,950 --> 00:10:27,370
load command injection like ping command

268
00:10:25,839 --> 00:10:29,200
injection most routers they have like

269
00:10:27,370 --> 00:10:32,740
<font color="#CCCCCC">command injection and they also don't</font>

270
00:10:29,200 --> 00:10:34,420
segregate privileges so if you if you if

271
00:10:32,740 --> 00:10:36,790
<font color="#CCCCCC">you are able</font><font color="#E5E5E5"> to find an exploit</font><font color="#CCCCCC"> for an</font>

272
00:10:34,420 --> 00:10:39,189
<font color="#E5E5E5">embedded devices like 9 out of 10 times</font>

273
00:10:36,790 --> 00:10:45,099
<font color="#CCCCCC">its you always get root and then you can</font>

274
00:10:39,190 --> 00:10:49,330
start like gaining persistence so<font color="#E5E5E5"> Linux</font>

275
00:10:45,100 --> 00:10:51,370
kernel tried it like the MTD memory<font color="#CCCCCC"> so</font>

276
00:10:49,330 --> 00:10:53,890
you have like<font color="#E5E5E5"> the</font><font color="#CCCCCC"> flash ship</font><font color="#E5E5E5"> from your</font>

277
00:10:51,370 --> 00:10:56,770
<font color="#E5E5E5">router and the name they use it's like</font>

278
00:10:53,890 --> 00:10:58,900
memory technology device MTD it's a

279
00:10:56,770 --> 00:11:01,240
there's a filesystem<font color="#CCCCCC"> on the top of</font><font color="#E5E5E5"> Mt D</font>

280
00:10:58,900 --> 00:11:04,000
so the kernel<font color="#CCCCCC"> the Linux kernel it says</font>

281
00:11:01,240 --> 00:11:06,250
like<font color="#E5E5E5"> it defines when each partition</font>

282
00:11:04,000 --> 00:11:07,959
starts and end it's not<font color="#E5E5E5"> like you have</font><font color="#CCCCCC"> to</font>

283
00:11:06,250 --> 00:11:09,970
have<font color="#E5E5E5"> your</font><font color="#CCCCCC"> harddrive</font><font color="#E5E5E5"> and you say like</font>

284
00:11:07,959 --> 00:11:10,550
this<font color="#CCCCCC"> is starting</font><font color="#E5E5E5"> partition</font><font color="#CCCCCC"> 1 here are</font>

285
00:11:09,970 --> 00:11:13,220
the

286
00:11:10,550 --> 00:11:15,560
and here's partition<font color="#E5E5E5"> - it's not like</font>

287
00:11:13,220 --> 00:11:19,010
<font color="#E5E5E5">that it's like the colonel is defining</font>

288
00:11:15,560 --> 00:11:20,869
so if you look if<font color="#CCCCCC"> you get /proc / MTD</font>

289
00:11:19,010 --> 00:11:23,870
for example it's gonna say like from

290
00:11:20,870 --> 00:11:25,580
<font color="#E5E5E5">this offset until that offset you have</font>

291
00:11:23,870 --> 00:11:27,830
the<font color="#CCCCCC"> u-boot partition then the kernel</font>

292
00:11:25,580 --> 00:11:29,810
<font color="#CCCCCC">ruta pass art fumer and all those</font>

293
00:11:27,830 --> 00:11:31,400
partitions<font color="#CCCCCC"> and what we want to change</font>

294
00:11:29,810 --> 00:11:33,290
what we want in fact is the u-boot

295
00:11:31,400 --> 00:11:35,540
partition or the boot load partition

296
00:11:33,290 --> 00:11:39,829
which is like the first<font color="#E5E5E5"> one most of most</font>

297
00:11:35,540 --> 00:11:42,770
<font color="#E5E5E5">of the times</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> boot partition is</font>

298
00:11:39,830 --> 00:11:45,020
commonly mounted as read-only<font color="#CCCCCC"> so the MTD</font>

299
00:11:42,770 --> 00:11:47,180
<font color="#CCCCCC">0 on</font><font color="#E5E5E5"> that case on the</font><font color="#CCCCCC"> u-boot partition</font>

300
00:11:45,020 --> 00:11:49,160
<font color="#E5E5E5">it</font><font color="#CCCCCC"> smarter that's read-only</font><font color="#E5E5E5"> so we have</font>

301
00:11:47,180 --> 00:11:50,930
<font color="#E5E5E5">root</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> con on the machine</font><font color="#E5E5E5"> how can</font>

302
00:11:49,160 --> 00:11:54,380
we<font color="#E5E5E5"> change that</font><font color="#CCCCCC"> if it's read-only if the</font>

303
00:11:50,930 --> 00:11:56,810
kernel is blissfully saying this is

304
00:11:54,380 --> 00:11:58,460
read-only<font color="#CCCCCC"> you can't</font><font color="#E5E5E5"> write here so we</font>

305
00:11:56,810 --> 00:12:00,319
have to think about some way to bypass

306
00:11:58,460 --> 00:12:01,400
<font color="#CCCCCC">that so if you get the source code</font><font color="#E5E5E5"> you</font>

307
00:12:00,320 --> 00:12:04,490
see like it's ro

308
00:12:01,400 --> 00:12:08,660
there's this kernel module called<font color="#CCCCCC"> MTD</font>

309
00:12:04,490 --> 00:12:11,420
<font color="#CCCCCC">our W which is</font><font color="#E5E5E5"> basically a Linux kernel</font>

310
00:12:08,660 --> 00:12:14,510
module and I can tell the colonel<font color="#E5E5E5"> that</font>

311
00:12:11,420 --> 00:12:17,030
<font color="#E5E5E5">to like switch that flag</font><font color="#CCCCCC"> so if that</font>

312
00:12:14,510 --> 00:12:20,120
partition<font color="#E5E5E5"> was read only</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> just used</font><font color="#CCCCCC"> like</font>

313
00:12:17,030 --> 00:12:21,650
<font color="#CCCCCC">ins</font><font color="#E5E5E5"> mod I load a kernel module I'm say</font>

314
00:12:20,120 --> 00:12:23,720
like this partition is not<font color="#E5E5E5"> read only</font>

315
00:12:21,650 --> 00:12:25,610
anymore so then I can<font color="#E5E5E5"> write so if</font><font color="#CCCCCC"> we go</font>

316
00:12:23,720 --> 00:12:28,550
to<font color="#CCCCCC"> the next</font><font color="#E5E5E5"> slide this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the source</font>

317
00:12:25,610 --> 00:12:32,300
code from<font color="#E5E5E5"> empty</font><font color="#CCCCCC"> drw it is just checking</font>

318
00:12:28,550 --> 00:12:34,520
<font color="#E5E5E5">like the setting the it's just checking</font>

319
00:12:32,300 --> 00:12:36,109
<font color="#E5E5E5">how how are the flags and it's hard</font>

320
00:12:34,520 --> 00:12:39,170
coding tell you the<font color="#E5E5E5"> kernel these</font>

321
00:12:36,110 --> 00:12:41,840
partitions are I can also write on<font color="#E5E5E5"> them</font>

322
00:12:39,170 --> 00:12:44,150
<font color="#E5E5E5">so yes that's a</font><font color="#CCCCCC"> there's a bunny or</font><font color="#E5E5E5"> here</font>

323
00:12:41,840 --> 00:12:48,440
and<font color="#E5E5E5"> then to disable it</font><font color="#CCCCCC"> it doesn't an end</font>

324
00:12:44,150 --> 00:12:50,630
not so just<font color="#E5E5E5"> to unset the flag and yeah</font>

325
00:12:48,440 --> 00:12:53,930
so<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the example of if you have a</font>

326
00:12:50,630 --> 00:12:55,430
root<font color="#CCCCCC"> shell you just like F the first</font>

327
00:12:53,930 --> 00:12:57,680
<font color="#E5E5E5">thing you also need to do you will need</font>

328
00:12:55,430 --> 00:12:59,420
to cross compile this<font color="#E5E5E5"> kernel module for</font>

329
00:12:57,680 --> 00:13:01,189
<font color="#E5E5E5">your platform so if you're working from</font>

330
00:12:59,420 --> 00:13:02,240
each device little-endian<font color="#CCCCCC"> you have to</font>

331
00:13:01,190 --> 00:13:04,070
cross compile for<font color="#CCCCCC"> mips</font>

332
00:13:02,240 --> 00:13:06,380
<font color="#E5E5E5">if you're working with an arm device you</font>

333
00:13:04,070 --> 00:13:07,640
have<font color="#E5E5E5"> to cross compile for arm so you</font>

334
00:13:06,380 --> 00:13:10,070
just like insmod

335
00:13:07,640 --> 00:13:12,230
<font color="#CCCCCC">the module</font><font color="#E5E5E5"> and then there's like yeah in</font>

336
00:13:10,070 --> 00:13:14,360
small<font color="#E5E5E5"> I want a brick equals</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> because</font>

337
00:13:12,230 --> 00:13:17,090
most of the times you're<font color="#E5E5E5"> gonna mess and</font>

338
00:13:14,360 --> 00:13:19,910
then we're<font color="#CCCCCC"> gonna show you why</font><font color="#E5E5E5"> and you</font>

339
00:13:17,090 --> 00:13:22,040
just put MTD right your boot<font color="#CCCCCC"> you you</font>

340
00:13:19,910 --> 00:13:24,270
have like an image and it's just like a

341
00:13:22,040 --> 00:13:26,490
TV command so MTD right it's quite

342
00:13:24,270 --> 00:13:27,900
similar to<font color="#CCCCCC"> DD you can also use DD to</font>

343
00:13:26,490 --> 00:13:30,090
just<font color="#E5E5E5"> write to</font><font color="#CCCCCC"> that partition because</font>

344
00:13:27,900 --> 00:13:30,750
it's not with<font color="#CCCCCC"> only anymore</font><font color="#E5E5E5"> and then we</font>

345
00:13:30,090 --> 00:13:33,750
reboot the device

346
00:13:30,750 --> 00:13:39,030
so now after<font color="#CCCCCC"> the</font><font color="#E5E5E5"> day with the device</font>

347
00:13:33,750 --> 00:13:40,650
boots<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> a different bootloader</font><font color="#E5E5E5"> so</font>

348
00:13:39,030 --> 00:13:43,319
yeah now we're going to talk a bit<font color="#CCCCCC"> about</font>

349
00:13:40,650 --> 00:13:45,270
<font color="#E5E5E5">writing a</font><font color="#CCCCCC"> good kid yeah just something</font>

350
00:13:43,320 --> 00:13:46,710
<font color="#E5E5E5">we said before all hardware devices have</font>

351
00:13:45,270 --> 00:13:48,480
<font color="#CCCCCC">different settings</font><font color="#E5E5E5"> in boot loaders so</font>

352
00:13:46,710 --> 00:13:50,880
what we did we download an<font color="#E5E5E5"> open source</font>

353
00:13:48,480 --> 00:13:52,740
project<font color="#E5E5E5"> called you go small</font><font color="#CCCCCC"> you would</font>

354
00:13:50,880 --> 00:13:54,420
<font color="#E5E5E5">not and we cut and device that was</font>

355
00:13:52,740 --> 00:13:56,700
<font color="#CCCCCC">already supported so we didn't</font><font color="#E5E5E5"> have to</font>

356
00:13:54,420 --> 00:13:57,990
do any of<font color="#E5E5E5"> the hard work and also</font>

357
00:13:56,700 --> 00:14:00,330
<font color="#E5E5E5">interesting is that device is running</font>

358
00:13:57,990 --> 00:14:02,430
you boot<font color="#E5E5E5"> they yeah they have a GPL</font>

359
00:14:00,330 --> 00:14:04,470
license so it means<font color="#E5E5E5"> that if</font><font color="#CCCCCC"> you have a</font>

360
00:14:02,430 --> 00:14:06,630
device<font color="#E5E5E5"> running you would you legally</font>

361
00:14:04,470 --> 00:14:08,280
obliged to supply<font color="#CCCCCC"> the source code anyone</font>

362
00:14:06,630 --> 00:14:09,630
who is<font color="#CCCCCC"> requesting it so what</font><font color="#E5E5E5"> you could</font>

363
00:14:08,280 --> 00:14:10,770
do is you could<font color="#CCCCCC"> write a letter because</font>

364
00:14:09,630 --> 00:14:12,330
<font color="#E5E5E5">they want letters and then you could</font>

365
00:14:10,770 --> 00:14:13,980
request a source code for a device that

366
00:14:12,330 --> 00:14:15,570
runs<font color="#CCCCCC"> you boot and they might send it to</font>

367
00:14:13,980 --> 00:14:18,210
you in the<font color="#CCCCCC"> mail after</font><font color="#E5E5E5"> a year</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> two</font>

368
00:14:15,570 --> 00:14:20,280
it's very<font color="#E5E5E5"> interesting with because lots</font>

369
00:14:18,210 --> 00:14:22,680
of those vendors<font color="#E5E5E5"> like embedded</font><font color="#CCCCCC"> device</font>

370
00:14:20,280 --> 00:14:24,600
vendors<font color="#E5E5E5"> they offer the option because</font>

371
00:14:22,680 --> 00:14:26,430
they have to but you can't just download

372
00:14:24,600 --> 00:14:27,570
from their website they'd like yeah if

373
00:14:26,430 --> 00:14:29,489
you<font color="#E5E5E5"> really want the source code you have</font>

374
00:14:27,570 --> 00:14:31,200
<font color="#E5E5E5">to send us a letter like you manually</font>

375
00:14:29,490 --> 00:14:32,640
<font color="#E5E5E5">write to</font><font color="#CCCCCC"> those you</font><font color="#E5E5E5"> send us and then</font>

376
00:14:31,200 --> 00:14:33,960
we're gonna send<font color="#E5E5E5"> you the source code the</font>

377
00:14:32,640 --> 00:14:35,460
EF f also<font color="#E5E5E5"> assists you</font>

378
00:14:33,960 --> 00:14:37,260
yeah you<font color="#E5E5E5"> really want to</font><font color="#CCCCCC"> sort if you had</font>

379
00:14:35,460 --> 00:14:39,270
that<font color="#E5E5E5"> I</font><font color="#CCCCCC"> haven't issued a tab like GPL</font>

380
00:14:37,260 --> 00:14:43,170
violations you can always<font color="#E5E5E5"> also contact</font>

381
00:14:39,270 --> 00:14:45,630
<font color="#E5E5E5">yep</font><font color="#CCCCCC"> app so yeah because we are going</font><font color="#E5E5E5"> to</font>

382
00:14:43,170 --> 00:14:47,729
<font color="#E5E5E5">break</font><font color="#CCCCCC"> our device</font><font color="#E5E5E5"> may</font><font color="#CCCCCC"> be fun</font><font color="#E5E5E5"> times have a</font>

383
00:14:45,630 --> 00:14:49,470
soft<font color="#E5E5E5"> brick</font><font color="#CCCCCC"> we had to make some</font>

384
00:14:47,730 --> 00:14:50,970
preparations<font color="#E5E5E5"> to the device so</font><font color="#CCCCCC"> we have a</font>

385
00:14:49,470 --> 00:14:52,620
colleague who used to solder

386
00:14:50,970 --> 00:14:54,900
<font color="#CCCCCC">motherboards when he had a part-time job</font>

387
00:14:52,620 --> 00:14:57,450
<font color="#E5E5E5">so he can solder really well what we did</font>

388
00:14:54,900 --> 00:15:01,050
here we D solar the SPI flash chip and

389
00:14:57,450 --> 00:15:03,030
on where the the pins of the<font color="#CCCCCC"> chip where</font>

390
00:15:01,050 --> 00:15:04,770
he soldered some some wires and<font color="#E5E5E5"> then we</font>

391
00:15:03,030 --> 00:15:06,510
use<font color="#E5E5E5"> the chip programmer</font><font color="#CCCCCC"> I don't know how</font>

392
00:15:04,770 --> 00:15:09,030
you<font color="#CCCCCC"> call that a switch</font><font color="#E5E5E5"> or a chip</font>

393
00:15:06,510 --> 00:15:12,000
programmer<font color="#E5E5E5"> attribute and put it on there</font>

394
00:15:09,030 --> 00:15:13,740
<font color="#CCCCCC">so evey sweets chip</font><font color="#E5E5E5"> so when you boot on</font>

395
00:15:12,000 --> 00:15:15,150
the device it<font color="#CCCCCC"> just</font><font color="#E5E5E5"> boost regularly but</font>

396
00:15:13,740 --> 00:15:16,950
<font color="#CCCCCC">the moment when</font><font color="#E5E5E5"> we break it</font><font color="#CCCCCC"> because we</font>

397
00:15:15,150 --> 00:15:19,170
made a mistake<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> just put it in</font><font color="#CCCCCC"> a</font>

398
00:15:16,950 --> 00:15:21,900
chip programmer<font color="#CCCCCC"> like here and</font><font color="#E5E5E5"> then we</font>

399
00:15:19,170 --> 00:15:23,370
can just<font color="#CCCCCC"> put back the original</font>

400
00:15:21,900 --> 00:15:25,140
bootloader<font color="#E5E5E5"> it's also interested to</font>

401
00:15:23,370 --> 00:15:27,330
mention if<font color="#E5E5E5"> you have a hot berry pie or</font>

402
00:15:25,140 --> 00:15:29,280
if you have a big open black<font color="#E5E5E5"> so or like</font>

403
00:15:27,330 --> 00:15:31,890
<font color="#E5E5E5">an Arduino all those devices you can</font>

404
00:15:29,280 --> 00:15:33,600
interface with SPI directly so you can

405
00:15:31,890 --> 00:15:35,490
use like either a good fat you can use

406
00:15:33,600 --> 00:15:37,380
the Raspberry Pi directly and then you

407
00:15:35,490 --> 00:15:39,270
can interface with<font color="#CCCCCC"> SPI and then you can</font>

408
00:15:37,380 --> 00:15:40,830
we write as well so it's not<font color="#E5E5E5"> like you</font>

409
00:15:39,270 --> 00:15:43,140
have<font color="#CCCCCC"> to have a programmer or</font><font color="#E5E5E5"> anything</font>

410
00:15:40,830 --> 00:15:45,660
like<font color="#E5E5E5"> that this is a good one it's kind</font>

411
00:15:43,140 --> 00:15:47,250
of cheap but it<font color="#CCCCCC"> sameer on the software</font>

412
00:15:45,660 --> 00:15:49,199
might<font color="#E5E5E5"> be a bit dodgy so rather than a VM</font>

413
00:15:47,250 --> 00:15:50,520
<font color="#E5E5E5">but yeah it's really good it has a lot</font>

414
00:15:49,200 --> 00:15:53,070
of support<font color="#E5E5E5"> keeps adding new support and</font>

415
00:15:50,520 --> 00:15:56,100
it's like<font color="#E5E5E5"> 500 bucks or something</font><font color="#CCCCCC"> so why</font>

416
00:15:53,070 --> 00:15:58,110
why you boot so why did you<font color="#E5E5E5"> focus on</font>

417
00:15:56,100 --> 00:16:01,370
your boot<font color="#CCCCCC"> there's this website</font><font color="#E5E5E5"> called</font>

418
00:15:58,110 --> 00:16:03,990
<font color="#E5E5E5">wiki daddy and his website it lists like</font>

419
00:16:01,370 --> 00:16:06,150
hardware information<font color="#CCCCCC"> from like home</font>

420
00:16:03,990 --> 00:16:09,030
routers webcams and<font color="#E5E5E5"> all those things and</font>

421
00:16:06,150 --> 00:16:12,420
I did like<font color="#CCCCCC"> a quick as</font><font color="#E5E5E5"> most crapper and</font>

422
00:16:09,030 --> 00:16:15,510
like I saw that you boot is used by most

423
00:16:12,420 --> 00:16:18,060
devices or use your boot<font color="#E5E5E5"> and the second</font>

424
00:16:15,510 --> 00:16:19,920
most<font color="#E5E5E5"> used one is called CFE it's called</font>

425
00:16:18,060 --> 00:16:21,839
common firmware environment<font color="#CCCCCC"> so this</font>

426
00:16:19,920 --> 00:16:24,449
bootloader is<font color="#E5E5E5"> proprietary it from</font>

427
00:16:21,840 --> 00:16:26,310
<font color="#CCCCCC">Broadcom so mostly Broadcom devices they</font>

428
00:16:24,450 --> 00:16:27,840
have<font color="#CCCCCC"> CF e but sometimes it's also</font>

429
00:16:26,310 --> 00:16:30,119
<font color="#E5E5E5">interesting that some devices they have</font>

430
00:16:27,840 --> 00:16:32,400
<font color="#CCCCCC">like more</font><font color="#E5E5E5"> than one bootloader so they</font>

431
00:16:30,120 --> 00:16:34,860
have like CF<font color="#CCCCCC"> v and u boot at the same</font>

432
00:16:32,400 --> 00:16:37,410
time and<font color="#CCCCCC"> for example</font><font color="#E5E5E5"> some sort some</font>

433
00:16:34,860 --> 00:16:39,240
system on chip is using one and the

434
00:16:37,410 --> 00:16:42,780
other system chip is using another one

435
00:16:39,240 --> 00:16:44,790
<font color="#E5E5E5">it's also common to happen so yeah you</font>

436
00:16:42,780 --> 00:16:47,459
boot is basically on the<font color="#E5E5E5"> first entity</font>

437
00:16:44,790 --> 00:16:51,959
partition<font color="#E5E5E5"> and yeah it basically has a</font>

438
00:16:47,460 --> 00:16:53,370
code block and then defined yeah area

439
00:16:51,960 --> 00:16:55,080
for environment variables and depending

440
00:16:53,370 --> 00:16:56,520
on<font color="#E5E5E5"> your device</font><font color="#CCCCCC"> the environment variables</font>

441
00:16:55,080 --> 00:16:58,020
which<font color="#E5E5E5"> will be stored at</font><font color="#CCCCCC"> the end of the</font>

442
00:16:56,520 --> 00:17:00,360
<font color="#E5E5E5">you boot partition it's not actually a</font>

443
00:16:58,020 --> 00:17:02,189
partition but the size might be

444
00:17:00,360 --> 00:17:03,360
different so<font color="#CCCCCC"> yes some some require more</font>

445
00:17:02,190 --> 00:17:05,610
environment variables so the size might

446
00:17:03,360 --> 00:17:06,960
be smaller or<font color="#E5E5E5"> larger and then here</font><font color="#CCCCCC"> you</font>

447
00:17:05,609 --> 00:17:09,119
can<font color="#CCCCCC"> see</font><font color="#E5E5E5"> like in</font><font color="#CCCCCC"> Rodari</font><font color="#E5E5E5"> where the</font>

448
00:17:06,960 --> 00:17:10,800
environment<font color="#E5E5E5"> variables are here it's like</font>

449
00:17:09,119 --> 00:17:12,089
<font color="#E5E5E5">the data section</font><font color="#CCCCCC"> couple</font><font color="#E5E5E5"> new bytes and</font>

450
00:17:10,800 --> 00:17:13,589
here you can see<font color="#E5E5E5"> it it's a basically a</font>

451
00:17:12,089 --> 00:17:16,349
<font color="#E5E5E5">nobody separate list of environment</font>

452
00:17:13,589 --> 00:17:18,510
variables<font color="#CCCCCC"> this is what you see after and</font>

453
00:17:16,349 --> 00:17:21,030
<font color="#CCCCCC">also</font><font color="#E5E5E5"> you made decompressing</font><font color="#CCCCCC"> the u-boot</font>

454
00:17:18,510 --> 00:17:22,319
<font color="#E5E5E5">which</font><font color="#CCCCCC"> is dumped from a device</font><font color="#E5E5E5"> you can</font>

455
00:17:21,030 --> 00:17:24,180
change some environment variables here

456
00:17:22,319 --> 00:17:26,189
so<font color="#E5E5E5"> interesting one is like the</font><font color="#CCCCCC"> Borg's in</font>

457
00:17:24,180 --> 00:17:28,020
some cases you<font color="#CCCCCC"> can change in it instead</font>

458
00:17:26,190 --> 00:17:29,940
of<font color="#CCCCCC"> spikes has been in it you can change</font>

459
00:17:28,020 --> 00:17:31,740
soup in bash with<font color="#CCCCCC"> bin</font><font color="#E5E5E5"> SH you can</font><font color="#CCCCCC"> get a</font>

460
00:17:29,940 --> 00:17:33,990
root shell but at the<font color="#CCCCCC"> end here do is</font>

461
00:17:31,740 --> 00:17:35,870
like a small checksum crc32 checksum

462
00:17:33,990 --> 00:17:40,230
that checks<font color="#CCCCCC"> for the validity of your</font>

463
00:17:35,870 --> 00:17:43,080
yeah the corruption of your<font color="#E5E5E5"> virus levels</font>

464
00:17:40,230 --> 00:17:44,850
so you need to change<font color="#E5E5E5"> that as well</font><font color="#CCCCCC"> there</font>

465
00:17:43,080 --> 00:17:46,860
are<font color="#CCCCCC"> some</font><font color="#E5E5E5"> interesting functions in in</font>

466
00:17:44,850 --> 00:17:48,719
<font color="#CCCCCC">boot</font><font color="#E5E5E5"> boot you have like print n which</font>

467
00:17:46,860 --> 00:17:50,729
<font color="#CCCCCC">means the environment</font><font color="#E5E5E5"> variables TVP boot</font>

468
00:17:48,720 --> 00:17:51,299
which is<font color="#E5E5E5"> responsible for booting a</font>

469
00:17:50,730 --> 00:17:53,730
device from

470
00:17:51,299 --> 00:17:57,269
<font color="#CCCCCC">TFTP</font><font color="#E5E5E5"> and then we have the</font><font color="#CCCCCC"> f-stops wing</font>

471
00:17:53,730 --> 00:17:58,679
which is<font color="#CCCCCC"> a like</font><font color="#E5E5E5"> yeah password protection</font>

472
00:17:57,269 --> 00:18:00,659
but<font color="#CCCCCC"> not really</font><font color="#E5E5E5"> a password protection for</font>

473
00:17:58,679 --> 00:18:02,159
you good<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> have boots MD</font><font color="#E5E5E5"> which is</font>

474
00:18:00,659 --> 00:18:03,899
the first<font color="#CCCCCC"> command that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> could let</font>

475
00:18:02,159 --> 00:18:05,909
<font color="#E5E5E5">execute after</font><font color="#CCCCCC"> the device has booted</font><font color="#E5E5E5"> and</font>

476
00:18:03,899 --> 00:18:07,830
the ping command<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is just an ICMP</font>

477
00:18:05,909 --> 00:18:11,279
being comment like on your<font color="#CCCCCC"> windows</font>

478
00:18:07,830 --> 00:18:12,809
<font color="#E5E5E5">device or Linux</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> interesting is that</font>

479
00:18:11,279 --> 00:18:14,999
you boot has<font color="#CCCCCC"> a</font><font color="#E5E5E5"> scripting language which</font>

480
00:18:12,809 --> 00:18:16,710
kind of looks like bash you over here<font color="#E5E5E5"> we</font>

481
00:18:14,999 --> 00:18:19,470
have a do<font color="#CCCCCC"> good example which we will</font>

482
00:18:16,710 --> 00:18:20,879
show you<font color="#E5E5E5"> later</font><font color="#CCCCCC"> we do a ping to see if</font>

483
00:18:19,470 --> 00:18:23,009
the server IP which is an environment

484
00:18:20,879 --> 00:18:25,139
variable<font color="#CCCCCC"> is live</font><font color="#E5E5E5"> if that server is live</font>

485
00:18:23,009 --> 00:18:26,309
then it will<font color="#CCCCCC"> TFTP boot from a load</font>

486
00:18:25,139 --> 00:18:28,320
address<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is also an</font><font color="#E5E5E5"> environment</font>

487
00:18:26,309 --> 00:18:30,629
variable file called<font color="#E5E5E5"> backdoor</font><font color="#CCCCCC"> dog bin</font>

488
00:18:28,320 --> 00:18:32,129
and if it's loaded<font color="#E5E5E5"> then it will boot</font><font color="#CCCCCC"> to</font>

489
00:18:30,629 --> 00:18:34,139
load address<font color="#E5E5E5"> and you know jump to the</font>

490
00:18:32,129 --> 00:18:35,908
colonel for<font color="#E5E5E5"> backdoor</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> and if you</font>

491
00:18:34,139 --> 00:18:37,289
can't ping the device<font color="#CCCCCC"> we just put the</font>

492
00:18:35,909 --> 00:18:40,320
<font color="#CCCCCC">regular format it's already</font><font color="#E5E5E5"> on the flash</font>

493
00:18:37,289 --> 00:18:43,080
<font color="#E5E5E5">jet and print and is interesting because</font>

494
00:18:40,320 --> 00:18:44,158
yeah it does a loop<font color="#E5E5E5"> through the new byte</font>

495
00:18:43,080 --> 00:18:46,289
separated list and you<font color="#E5E5E5"> sprint</font>

496
00:18:44,159 --> 00:18:47,639
environment variables and<font color="#E5E5E5"> if you want to</font>

497
00:18:46,289 --> 00:18:49,739
add some malicious environment variables

498
00:18:47,639 --> 00:18:52,799
we want<font color="#E5E5E5"> to patch the function so that's</font>

499
00:18:49,739 --> 00:18:55,019
what we did<font color="#E5E5E5"> we wrote an extra</font><font color="#CCCCCC"> function</font>

500
00:18:52,799 --> 00:18:56,549
like a function or two and you like go

501
00:18:55,019 --> 00:18:59,070
to the<font color="#CCCCCC"> Nova's separated list and then we</font>

502
00:18:56,549 --> 00:19:00,299
we find a match for<font color="#E5E5E5"> the variable so we</font>

503
00:18:59,070 --> 00:19:01,769
have like<font color="#E5E5E5"> boot seam difference is</font>

504
00:19:00,299 --> 00:19:04,080
interesting<font color="#E5E5E5"> to</font><font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> because you can</font>

505
00:19:01,769 --> 00:19:05,909
<font color="#E5E5E5">change</font><font color="#CCCCCC"> to beam</font><font color="#E5E5E5"> bash or if yeah I think</font>

506
00:19:04,080 --> 00:19:07,889
we did<font color="#E5E5E5"> boots in D we changed it so</font><font color="#CCCCCC"> that</font>

507
00:19:05,909 --> 00:19:09,570
you can actually do<font color="#E5E5E5"> both the device so</font>

508
00:19:07,889 --> 00:19:11,309
what we do is we find<font color="#E5E5E5"> a match and see if</font>

509
00:19:09,570 --> 00:19:13,200
it wants<font color="#E5E5E5"> to pin boots in D and if it</font>

510
00:19:11,309 --> 00:19:15,359
wants<font color="#E5E5E5"> to spin boots in the you set a</font>

511
00:19:13,200 --> 00:19:17,999
flag and<font color="#E5E5E5"> then we print like the</font>

512
00:19:15,359 --> 00:19:21,418
<font color="#CCCCCC">hard-coded fake environment</font><font color="#E5E5E5"> variables</font>

513
00:19:17,999 --> 00:19:23,159
there yeah boots in<font color="#E5E5E5"> D is the first</font>

514
00:19:21,419 --> 00:19:26,100
command executed when a device boot<font color="#E5E5E5"> it's</font>

515
00:19:23,159 --> 00:19:27,570
actually a<font color="#CCCCCC"> Google</font><font color="#E5E5E5"> script command so it's</font>

516
00:19:26,100 --> 00:19:29,219
usually an environment variable but you

517
00:19:27,570 --> 00:19:32,609
<font color="#E5E5E5">can override</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> in source so what we did</font>

518
00:19:29,220 --> 00:19:34,639
we in our<font color="#E5E5E5"> boot loader we just hard-coded</font>

519
00:19:32,609 --> 00:19:37,379
<font color="#E5E5E5">the boot</font><font color="#CCCCCC"> seam the dual boot command</font>

520
00:19:34,639 --> 00:19:39,359
which we which you can see<font color="#E5E5E5"> right here is</font>

521
00:19:37,379 --> 00:19:41,699
<font color="#CCCCCC">like</font><font color="#E5E5E5"> if the find</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> config boot command</font>

522
00:19:39,359 --> 00:19:43,230
<font color="#CCCCCC">check gets</font><font color="#E5E5E5"> it from the set</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> an</font>

523
00:19:41,700 --> 00:19:44,669
environment variable<font color="#CCCCCC"> and then when</font><font color="#E5E5E5"> it's</font>

524
00:19:43,230 --> 00:19:46,080
booting the device<font color="#E5E5E5"> it gets the</font>

525
00:19:44,669 --> 00:19:47,879
environment variable and<font color="#E5E5E5"> we override it</font>

526
00:19:46,080 --> 00:19:51,090
right here<font color="#E5E5E5"> because yeah we just wanted</font>

527
00:19:47,879 --> 00:19:52,199
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> Rommel Isha's</font><font color="#E5E5E5"> do boot</font><font color="#CCCCCC"> your now</font>

528
00:19:51,090 --> 00:19:56,330
we're going to show you do booting the

529
00:19:52,200 --> 00:20:03,090
<font color="#E5E5E5">device and let's see if I can get my</font><font color="#CCCCCC"> I</font>

530
00:19:56,330 --> 00:20:10,350
<font color="#CCCCCC">upgrade over</font><font color="#E5E5E5"> here actually yeah</font>

531
00:20:03,090 --> 00:20:13,080
stuff happens<font color="#CCCCCC"> always like this okay</font><font color="#E5E5E5"> so</font>

532
00:20:10,350 --> 00:20:15,030
<font color="#E5E5E5">you see three screens here this one will</font>

533
00:20:13,080 --> 00:20:17,310
<font color="#E5E5E5">be a screen</font><font color="#CCCCCC"> session of a</font><font color="#E5E5E5"> serial</font><font color="#CCCCCC"> to the</font>

534
00:20:15,030 --> 00:20:19,399
to our<font color="#E5E5E5"> device over</font><font color="#CCCCCC"> here there's a</font>

535
00:20:17,310 --> 00:20:22,320
command<font color="#E5E5E5"> for setting up</font><font color="#CCCCCC"> a TFTP server</font><font color="#E5E5E5"> and</font>

536
00:20:19,400 --> 00:20:24,060
over here we will ping the<font color="#CCCCCC"> TFTP server</font>

537
00:20:22,320 --> 00:20:26,610
so<font color="#CCCCCC"> we will boot the device</font><font color="#E5E5E5"> and then we</font>

538
00:20:24,060 --> 00:20:28,409
<font color="#E5E5E5">will turn on you will boot the device</font>

539
00:20:26,610 --> 00:20:29,639
<font color="#E5E5E5">without having</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> service</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> so it</font>

540
00:20:28,410 --> 00:20:31,530
will boot the normal firmware on the

541
00:20:29,640 --> 00:20:33,330
chip<font color="#E5E5E5"> and then afterwards</font><font color="#CCCCCC"> we reboot the</font>

542
00:20:31,530 --> 00:20:35,370
device and<font color="#E5E5E5"> we start</font><font color="#CCCCCC"> a TCP server</font><font color="#E5E5E5"> and</font>

543
00:20:33,330 --> 00:20:41,699
then see if our device will do boot arm

544
00:20:35,370 --> 00:20:43,050
maliciously created<font color="#E5E5E5"> kernel so as you can</font>

545
00:20:41,700 --> 00:20:46,440
see<font color="#E5E5E5"> here the destination house is</font>

546
00:20:43,050 --> 00:20:51,330
unreachable<font color="#CCCCCC"> it's not yeah it's not</font><font color="#E5E5E5"> live</font>

547
00:20:46,440 --> 00:20:53,310
yet so we wait

548
00:20:51,330 --> 00:20:57,120
press<font color="#CCCCCC"> ENTER and here</font><font color="#E5E5E5"> we have like</font>

549
00:20:53,310 --> 00:20:58,950
standard open<font color="#E5E5E5"> WT and we start a TV piece</font>

550
00:20:57,120 --> 00:21:02,879
yeah the TV sir there's a sleep in there

551
00:20:58,950 --> 00:21:06,120
because<font color="#E5E5E5"> yeah we had some issues</font><font color="#CCCCCC"> now you</font>

552
00:21:02,880 --> 00:21:07,710
can see<font color="#E5E5E5"> the TV service life and we</font>

553
00:21:06,120 --> 00:21:09,000
<font color="#CCCCCC">patched the TFTP boot command so it</font>

554
00:21:07,710 --> 00:21:11,640
doesn't show<font color="#E5E5E5"> you that it's actually TV</font>

555
00:21:09,000 --> 00:21:13,980
booting<font color="#E5E5E5"> so there is a delay here</font><font color="#CCCCCC"> which</font>

556
00:21:11,640 --> 00:21:15,390
is kind of odd<font color="#E5E5E5"> but yeah not</font><font color="#CCCCCC"> a lot of</font>

557
00:21:13,980 --> 00:21:17,850
<font color="#E5E5E5">people look at the device booting on</font>

558
00:21:15,390 --> 00:21:24,210
serial so it's kind of stealthy I guess

559
00:21:17,850 --> 00:21:32,159
and<font color="#E5E5E5"> yeah successful transfer and now we</font>

560
00:21:24,210 --> 00:21:32,340
wait<font color="#CCCCCC"> and press ENTER and then there you</font>

561
00:21:32,160 --> 00:21:36,300
<font color="#E5E5E5">go</font>

562
00:21:32,340 --> 00:21:38,159
<font color="#E5E5E5">and we do buddha-dharma wishes sir and</font>

563
00:21:36,300 --> 00:21:41,220
on this specific<font color="#CCCCCC"> case</font><font color="#E5E5E5"> we're just</font>

564
00:21:38,160 --> 00:21:44,370
<font color="#CCCCCC">changing like UTC motd message of the</font>

565
00:21:41,220 --> 00:21:46,410
day<font color="#E5E5E5"> but we can change in it start new</font>

566
00:21:44,370 --> 00:21:48,300
files or anything like<font color="#E5E5E5"> that and it's</font>

567
00:21:46,410 --> 00:21:51,330
also interesting<font color="#E5E5E5"> to</font><font color="#CCCCCC"> mention that we</font><font color="#E5E5E5"> have</font>

568
00:21:48,300 --> 00:21:53,820
a server so why did we<font color="#E5E5E5"> do like we were</font>

569
00:21:51,330 --> 00:21:57,030
pinging that server so suppose<font color="#E5E5E5"> I have an</font>

570
00:21:53,820 --> 00:21:58,530
implant<font color="#CCCCCC"> at like any location on the when</font>

571
00:21:57,030 --> 00:22:01,139
<font color="#E5E5E5">you boot</font><font color="#CCCCCC"> the device that you boot</font>

572
00:21:58,530 --> 00:22:04,710
already has a TCP stack and so<font color="#E5E5E5"> you can</font>

573
00:22:01,140 --> 00:22:07,170
ping hosts and you can do like<font color="#CCCCCC"> T FTP or</font>

574
00:22:04,710 --> 00:22:09,450
<font color="#CCCCCC">you can also do FTP that we get doesn't</font>

575
00:22:07,170 --> 00:22:11,130
matter you can<font color="#E5E5E5"> prove</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> C code so you</font>

576
00:22:09,450 --> 00:22:13,800
can<font color="#E5E5E5"> do whatever you want and you also</font>

577
00:22:11,130 --> 00:22:15,900
have a to see a TCP stack so we<font color="#E5E5E5"> keep</font>

578
00:22:13,800 --> 00:22:16,649
pinging a server<font color="#E5E5E5"> we we control the</font>

579
00:22:15,900 --> 00:22:18,000
server

580
00:22:16,650 --> 00:22:20,370
and it's a malicious server<font color="#E5E5E5"> if we</font>

581
00:22:18,000 --> 00:22:22,470
suspect<font color="#E5E5E5"> that someone is</font>

582
00:22:20,370 --> 00:22:25,139
I don't know trying to<font color="#E5E5E5"> analyze</font><font color="#CCCCCC"> our our</font>

583
00:22:22,470 --> 00:22:27,360
thing<font color="#E5E5E5"> our our boot loader we can just</font>

584
00:22:25,140 --> 00:22:29,370
turn off<font color="#E5E5E5"> the server so this pink won't</font>

585
00:22:27,360 --> 00:22:30,330
succeed<font color="#CCCCCC"> and it won't download</font><font color="#E5E5E5"> the</font>

586
00:22:29,370 --> 00:22:31,949
<font color="#E5E5E5">backdoored kernel</font>

587
00:22:30,330 --> 00:22:33,540
and another<font color="#E5E5E5"> yeah it's also in your own</font>

588
00:22:31,950 --> 00:22:35,190
memory<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> don't actually write it to</font>

589
00:22:33,540 --> 00:22:36,930
<font color="#E5E5E5">the</font><font color="#CCCCCC"> ROM so if you don't want to lose</font>

590
00:22:35,190 --> 00:22:38,910
your<font color="#CCCCCC"> Ruby lead hexing tools then yeah</font>

591
00:22:36,930 --> 00:22:40,890
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a and if you</font><font color="#E5E5E5"> reboot the device</font>

592
00:22:38,910 --> 00:22:43,080
and the server is<font color="#CCCCCC"> not</font><font color="#E5E5E5"> online it</font><font color="#CCCCCC"> will</font>

593
00:22:40,890 --> 00:22:45,180
just put<font color="#E5E5E5"> the</font><font color="#CCCCCC"> regular image no nothing at</font>

594
00:22:43,080 --> 00:22:48,389
<font color="#E5E5E5">all like the part a few more partitions</font>

595
00:22:45,180 --> 00:22:49,470
<font color="#E5E5E5">there's nothing changing so yeah the</font>

596
00:22:48,390 --> 00:22:51,030
password<font color="#CCCCCC"> protection I spoke about</font>

597
00:22:49,470 --> 00:22:52,710
<font color="#CCCCCC">earlier it's like an</font><font color="#E5E5E5"> environment</font>

598
00:22:51,030 --> 00:22:54,090
variable so yeah if you run string some

599
00:22:52,710 --> 00:22:56,580
advice<font color="#CCCCCC"> after dumping</font><font color="#E5E5E5"> the flash you can</font>

600
00:22:54,090 --> 00:22:59,790
<font color="#E5E5E5">see the password</font><font color="#CCCCCC"> password sorry I</font><font color="#E5E5E5"> need</font>

601
00:22:56,580 --> 00:23:03,120
to use<font color="#CCCCCC"> echoes here it's hidden from the</font>

602
00:22:59,790 --> 00:23:06,090
user yeah<font color="#E5E5E5"> wait yeah so what we did</font><font color="#CCCCCC"> here</font>

603
00:23:03,120 --> 00:23:07,649
<font color="#CCCCCC">is that oh yeah the f-stop</font><font color="#E5E5E5"> ring is</font>

604
00:23:06,090 --> 00:23:09,510
actually<font color="#E5E5E5"> for people</font><font color="#CCCCCC"> who don't</font><font color="#E5E5E5"> want</font>

605
00:23:07,650 --> 00:23:10,650
people to<font color="#E5E5E5"> look inside the bootloader</font><font color="#CCCCCC"> so</font>

606
00:23:09,510 --> 00:23:11,700
then<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> sometimes</font><font color="#CCCCCC"> do this because</font>

607
00:23:10,650 --> 00:23:13,020
<font color="#E5E5E5">they</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> want you to get booted on the</font>

608
00:23:11,700 --> 00:23:14,550
device and if you can<font color="#E5E5E5"> change the</font>

609
00:23:13,020 --> 00:23:16,200
environment<font color="#E5E5E5"> variables for</font><font color="#CCCCCC"> boots AMD you</font>

610
00:23:14,550 --> 00:23:18,960
<font color="#E5E5E5">can get</font><font color="#CCCCCC"> rude in the device so they it's</font>

611
00:23:16,200 --> 00:23:21,360
<font color="#CCCCCC">like</font><font color="#E5E5E5"> I think tp-link has</font><font color="#CCCCCC"> a F stop string</font>

612
00:23:18,960 --> 00:23:25,680
called<font color="#E5E5E5"> TPL which is very easy but anyway</font>

613
00:23:21,360 --> 00:23:28,770
<font color="#CCCCCC">what we do here is we if</font><font color="#E5E5E5"> you feel to</font>

614
00:23:25,680 --> 00:23:30,900
<font color="#CCCCCC">enter the</font><font color="#E5E5E5"> password</font><font color="#CCCCCC"> we will wipe the</font>

615
00:23:28,770 --> 00:23:33,300
device<font color="#CCCCCC"> so we put a boot Cindy in there</font>

616
00:23:30,900 --> 00:23:36,090
<font color="#E5E5E5">like erase all we said so if you press</font>

617
00:23:33,300 --> 00:23:38,159
<font color="#E5E5E5">Enter</font><font color="#CCCCCC"> for instance and then yeah that's</font>

618
00:23:36,090 --> 00:23:40,560
<font color="#E5E5E5">not part of our password so it will wipe</font>

619
00:23:38,160 --> 00:23:43,920
the device<font color="#E5E5E5"> and we have a demo where we</font>

620
00:23:40,560 --> 00:23:48,080
do exactly<font color="#CCCCCC"> that</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> most people</font>

621
00:23:43,920 --> 00:23:52,380
<font color="#CCCCCC">we've also patched as you'll see here</font>

622
00:23:48,080 --> 00:23:54,240
yeah<font color="#CCCCCC"> showed earlier I'm gonna device</font>

623
00:23:52,380 --> 00:23:54,860
boots<font color="#CCCCCC"> everything is fine green light is</font>

624
00:23:54,240 --> 00:24:02,190
blinking

625
00:23:54,860 --> 00:24:04,050
you see<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> and it's also interesting</font>

626
00:24:02,190 --> 00:24:05,880
<font color="#E5E5E5">to mention that like this</font><font color="#CCCCCC"> is a serial</font>

627
00:24:04,050 --> 00:24:07,320
console<font color="#E5E5E5"> so when you boot</font><font color="#CCCCCC"> the device you</font>

628
00:24:05,880 --> 00:24:09,000
are<font color="#E5E5E5"> not seeing this that all you just</font>

629
00:24:07,320 --> 00:24:10,800
wait and then<font color="#CCCCCC"> you</font><font color="#E5E5E5"> connect to the web</font>

630
00:24:09,000 --> 00:24:11,820
server<font color="#E5E5E5"> so if you connect the wires and</font>

631
00:24:10,800 --> 00:24:13,500
see you if you find<font color="#CCCCCC"> the serial</font>

632
00:24:11,820 --> 00:24:16,379
<font color="#E5E5E5">connection then you actually see a</font>

633
00:24:13,500 --> 00:24:18,300
series on Syria so now we are rebooting

634
00:24:16,380 --> 00:24:19,950
the device<font color="#E5E5E5"> and it says like oh yeah</font>

635
00:24:18,300 --> 00:24:22,200
<font color="#E5E5E5">press a key and the moment you press a</font>

636
00:24:19,950 --> 00:24:25,490
key then it will wipe the device<font color="#E5E5E5"> so we</font>

637
00:24:22,200 --> 00:24:25,490
want no one to look<font color="#E5E5E5"> inside</font>

638
00:24:29,880 --> 00:24:38,710
so what we also<font color="#E5E5E5"> did to hide from strings</font>

639
00:24:34,710 --> 00:24:41,950
we get this yeah<font color="#CCCCCC"> to hide</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> swings</font>

640
00:24:38,710 --> 00:24:43,870
what we did is we<font color="#CCCCCC"> didn't</font><font color="#E5E5E5"> hard</font><font color="#CCCCCC"> code the</font>

641
00:24:41,950 --> 00:24:45,789
<font color="#CCCCCC">stop</font><font color="#E5E5E5"> string inside and we kind of did</font>

642
00:24:43,870 --> 00:24:47,678
hard<font color="#CCCCCC"> coding but</font><font color="#E5E5E5"> not as a swing but as a</font>

643
00:24:45,789 --> 00:24:49,960
string array<font color="#E5E5E5"> so when you compile this</font>

644
00:24:47,679 --> 00:24:51,820
after<font color="#E5E5E5"> doing the swing copy</font><font color="#CCCCCC"> animalic it</font>

645
00:24:49,960 --> 00:24:54,009
will<font color="#E5E5E5"> look like this it's a very simple</font>

646
00:24:51,820 --> 00:24:55,299
of skating technique<font color="#E5E5E5"> but it prevents</font>

647
00:24:54,009 --> 00:24:57,580
<font color="#CCCCCC">people home running strings and seeing</font>

648
00:24:55,299 --> 00:25:01,240
your<font color="#E5E5E5"> password it takes a little bit more</font>

649
00:24:57,580 --> 00:25:02,799
<font color="#CCCCCC">effort</font><font color="#E5E5E5"> to find out the stop string so</font>

650
00:25:01,240 --> 00:25:05,080
what we<font color="#E5E5E5"> will now</font><font color="#CCCCCC"> show you is how you</font><font color="#E5E5E5"> can</font>

651
00:25:02,799 --> 00:25:08,379
bypass the<font color="#E5E5E5"> spot string protection</font>

652
00:25:05,080 --> 00:25:10,689
<font color="#E5E5E5">because when the device boots you boot</font>

653
00:25:08,379 --> 00:25:13,389
is basically in memory and then just

654
00:25:10,690 --> 00:25:16,539
like<font color="#E5E5E5"> the between loading the kernel from</font>

655
00:25:13,389 --> 00:25:18,668
<font color="#E5E5E5">the from the flash</font><font color="#CCCCCC"> there is like a</font><font color="#E5E5E5"> small</font>

656
00:25:16,539 --> 00:25:20,379
time<font color="#CCCCCC"> frame where</font><font color="#E5E5E5"> you can i glitched data</font>

657
00:25:18,669 --> 00:25:22,210
out pin and when you can glitch the data

658
00:25:20,379 --> 00:25:23,740
out pin preventing the<font color="#CCCCCC"> Linux</font><font color="#E5E5E5"> kernel from</font>

659
00:25:22,210 --> 00:25:25,720
being loaded in memory<font color="#CCCCCC"> you can fall back</font>

660
00:25:23,740 --> 00:25:29,039
inside the bootloader<font color="#E5E5E5"> because the</font>

661
00:25:25,720 --> 00:25:32,259
bootloader<font color="#E5E5E5"> is already loaded in</font><font color="#CCCCCC"> memory</font>

662
00:25:29,039 --> 00:25:35,139
and<font color="#E5E5E5"> the blue the blue wire here is the</font>

663
00:25:32,259 --> 00:25:38,350
<font color="#E5E5E5">date out and as you can</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> just falls</font>

664
00:25:35,139 --> 00:25:40,899
back<font color="#E5E5E5"> into you would so it's kind of</font>

665
00:25:38,350 --> 00:25:43,029
useless as a password<font color="#E5E5E5"> and if your Google</font>

666
00:25:40,899 --> 00:25:44,590
<font color="#E5E5E5">if you like search for example password</font>

667
00:25:43,029 --> 00:25:45,909
protect your<font color="#E5E5E5"> boot there are gonna be</font>

668
00:25:44,590 --> 00:25:47,678
<font color="#E5E5E5">lots of reference</font><font color="#CCCCCC"> tree like yeah I just</font>

669
00:25:45,909 --> 00:25:49,690
<font color="#CCCCCC">use</font><font color="#E5E5E5"> top string but it's not like a</font>

670
00:25:47,679 --> 00:25:52,840
<font color="#E5E5E5">security feature it's just like some</font>

671
00:25:49,690 --> 00:25:55,870
kind of protection that's not like real

672
00:25:52,840 --> 00:25:58,750
ear protection<font color="#E5E5E5"> and also like some people</font>

673
00:25:55,870 --> 00:26:00,370
if some<font color="#CCCCCC"> websites</font><font color="#E5E5E5"> they use this method</font>

674
00:25:58,750 --> 00:26:02,259
<font color="#CCCCCC">for you to if</font><font color="#E5E5E5"> you need to root your</font>

675
00:26:00,370 --> 00:26:04,330
<font color="#E5E5E5">device so if you have like a webcam and</font>

676
00:26:02,259 --> 00:26:06,159
you can't get the<font color="#E5E5E5"> you boot console and</font>

677
00:26:04,330 --> 00:26:07,570
<font color="#E5E5E5">you can't get access to do because if</font>

678
00:26:06,159 --> 00:26:10,029
<font color="#E5E5E5">you have access</font><font color="#CCCCCC"> to the you boot console</font>

679
00:26:07,570 --> 00:26:11,769
you<font color="#CCCCCC"> can rewrite</font><font color="#E5E5E5"> things you can dump the</font>

680
00:26:10,029 --> 00:26:13,899
whole<font color="#CCCCCC"> femur you can do lots of</font>

681
00:26:11,769 --> 00:26:16,480
<font color="#CCCCCC">modifications and sometimes they lock</font>

682
00:26:13,899 --> 00:26:18,969
the<font color="#E5E5E5"> you boot they don't want you to mess</font>

683
00:26:16,480 --> 00:26:21,009
<font color="#CCCCCC">with the femur at all so it's like you</font>

684
00:26:18,970 --> 00:26:22,539
don't<font color="#CCCCCC"> have an option so this is like a</font>

685
00:26:21,009 --> 00:26:24,850
<font color="#E5E5E5">really simple</font><font color="#CCCCCC"> technique that you can</font><font color="#E5E5E5"> use</font>

686
00:26:22,539 --> 00:26:28,658
<font color="#E5E5E5">to bypass the</font><font color="#CCCCCC"> DES protection and then</font>

687
00:26:24,850 --> 00:26:30,100
like get to<font color="#E5E5E5"> the u-boot console so now</font>

688
00:26:28,659 --> 00:26:33,600
I'm gonna talk to<font color="#E5E5E5"> really quick about</font>

689
00:26:30,100 --> 00:26:36,309
like the<font color="#E5E5E5"> technique good kids you</font><font color="#CCCCCC"> boot</font>

690
00:26:33,600 --> 00:26:37,779
more thinking more<font color="#CCCCCC"> about like you put</font>

691
00:26:36,309 --> 00:26:40,840
but you<font color="#E5E5E5"> boot nowadays it has</font><font color="#CCCCCC"> a</font>

692
00:26:37,779 --> 00:26:42,300
reproducible builds<font color="#E5E5E5"> so what what does it</font>

693
00:26:40,840 --> 00:26:45,090
mean so if<font color="#E5E5E5"> I if I</font>

694
00:26:42,300 --> 00:26:47,340
<font color="#E5E5E5">compiled some sicko today and tomorrow I</font>

695
00:26:45,090 --> 00:26:49,139
compiled like the exactly<font color="#E5E5E5"> same code the</font>

696
00:26:47,340 --> 00:26:50,639
compiler is<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to put</font><font color="#E5E5E5"> to put</font><font color="#CCCCCC"> like</font>

697
00:26:49,140 --> 00:26:53,820
some garbage<font color="#E5E5E5"> there are things like I</font>

698
00:26:50,640 --> 00:26:58,130
don't<font color="#E5E5E5"> know</font><font color="#CCCCCC"> GCC version like sometimes</font>

699
00:26:53,820 --> 00:27:01,470
timestamps and all those information and

700
00:26:58,130 --> 00:27:03,480
<font color="#E5E5E5">you boot also</font><font color="#CCCCCC"> has</font><font color="#E5E5E5"> this issue so if you</font>

701
00:27:01,470 --> 00:27:05,580
compile it<font color="#CCCCCC"> it's gonna hard code some</font>

702
00:27:03,480 --> 00:27:08,490
dates over<font color="#E5E5E5"> there so there's this</font>

703
00:27:05,580 --> 00:27:10,169
variable called<font color="#E5E5E5"> source date epoch</font><font color="#CCCCCC"> so</font>

704
00:27:08,490 --> 00:27:12,000
it's gonna be<font color="#E5E5E5"> like a fixed date it's</font>

705
00:27:10,170 --> 00:27:13,650
<font color="#E5E5E5">gonna be like the pocket and if you</font>

706
00:27:12,000 --> 00:27:15,690
compile the same code<font color="#CCCCCC"> today and tomorrow</font>

707
00:27:13,650 --> 00:27:17,790
it's<font color="#E5E5E5"> gonna they were gonna both have the</font>

708
00:27:15,690 --> 00:27:20,280
same md5<font color="#E5E5E5"> and it's also interesting to</font>

709
00:27:17,790 --> 00:27:22,590
note<font color="#CCCCCC"> Debian for example</font><font color="#E5E5E5"> there they have</font>

710
00:27:20,280 --> 00:27:24,720
that for their packages<font color="#CCCCCC"> so there</font><font color="#E5E5E5"> are</font>

711
00:27:22,590 --> 00:27:27,720
like reproducible builds<font color="#E5E5E5"> so you can get</font>

712
00:27:24,720 --> 00:27:31,320
a source<font color="#E5E5E5"> code and</font><font color="#CCCCCC"> you can use like</font>

713
00:27:27,720 --> 00:27:33,330
compiled up with like<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> Victor's</font>

714
00:27:31,320 --> 00:27:35,550
like code that you<font color="#E5E5E5"> can just download</font>

715
00:27:33,330 --> 00:27:38,600
from from data servers<font color="#E5E5E5"> try to compile</font>

716
00:27:35,550 --> 00:27:41,580
and you can check if the DP KJ dpkg

717
00:27:38,600 --> 00:27:44,990
<font color="#E5E5E5">matches like</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> DEP</font><font color="#E5E5E5"> actually</font>

718
00:27:41,580 --> 00:27:47,790
matches with the md5<font color="#E5E5E5"> from the RM the</font>

719
00:27:44,990 --> 00:27:52,230
<font color="#CCCCCC">sha-256 it matches with the</font><font color="#E5E5E5"> one you</font>

720
00:27:47,790 --> 00:27:54,149
compiled so and<font color="#E5E5E5"> also like</font><font color="#CCCCCC"> detecting boot</font>

721
00:27:52,230 --> 00:27:56,790
<font color="#CCCCCC">kids there's this tool called a chip</font>

722
00:27:54,150 --> 00:27:58,970
sack<font color="#E5E5E5"> it's more focused on like not</font>

723
00:27:56,790 --> 00:28:02,610
focused on<font color="#E5E5E5"> your boot</font><font color="#CCCCCC"> is more like on</font>

724
00:27:58,970 --> 00:28:05,070
laptops and<font color="#E5E5E5"> it's from the Intel guys and</font>

725
00:28:02,610 --> 00:28:06,689
what it does it's like<font color="#E5E5E5"> it has a series</font>

726
00:28:05,070 --> 00:28:09,840
of checks so<font color="#E5E5E5"> it's gonna check for</font>

727
00:28:06,690 --> 00:28:12,900
<font color="#CCCCCC">example if I don't know</font><font color="#E5E5E5"> it's you can</font>

728
00:28:09,840 --> 00:28:15,240
write variables on your on your UEFI

729
00:28:12,900 --> 00:28:17,460
partition it tests like several<font color="#CCCCCC"> Perl</font>

730
00:28:15,240 --> 00:28:20,280
<font color="#CCCCCC">primate checks for example they can</font>

731
00:28:17,460 --> 00:28:21,900
detect<font color="#E5E5E5"> the</font><font color="#CCCCCC"> the boot kit from UEFI they</font>

732
00:28:20,280 --> 00:28:23,580
have like<font color="#E5E5E5"> some signature checks and some</font>

733
00:28:21,900 --> 00:28:25,230
stuff like<font color="#E5E5E5"> that and there's also this</font>

734
00:28:23,580 --> 00:28:28,199
<font color="#CCCCCC">repository which is really interesting</font>

735
00:28:25,230 --> 00:28:31,200
<font color="#E5E5E5">it's called known UEFI executables it's</font>

736
00:28:28,200 --> 00:28:34,880
also from the the Intel guys<font color="#E5E5E5"> which you</font>

737
00:28:31,200 --> 00:28:38,160
can just like get hashes from different

738
00:28:34,880 --> 00:28:41,400
motherboards or laptop like if you buy

739
00:28:38,160 --> 00:28:43,680
an asus motherboard or<font color="#CCCCCC"> absolute laptop</font>

740
00:28:41,400 --> 00:28:46,320
and<font color="#E5E5E5"> you'd like them</font><font color="#CCCCCC"> TSP i'd like the</font>

741
00:28:43,680 --> 00:28:49,560
UEFI content then you<font color="#CCCCCC"> can also compare</font>

742
00:28:46,320 --> 00:28:51,990
that with like from the<font color="#E5E5E5"> full factory</font>

743
00:28:49,560 --> 00:28:54,540
from the<font color="#CCCCCC"> dot version so it's not like</font>

744
00:28:51,990 --> 00:28:56,070
really<font color="#CCCCCC"> easy because it you can</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> take</font>

745
00:28:54,540 --> 00:28:58,590
the enemy<font color="#E5E5E5"> md5 from one</font>

746
00:28:56,070 --> 00:29:00,419
like the<font color="#CCCCCC"> md5 of the other ones you have</font>

747
00:28:58,590 --> 00:29:03,179
to<font color="#E5E5E5"> ignore like the variable partition</font>

748
00:29:00,420 --> 00:29:06,240
sometimes because it's it's<font color="#CCCCCC"> tied to like</font>

749
00:29:03,180 --> 00:29:08,520
each device<font color="#E5E5E5"> so yeah this is</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> a</font>

750
00:29:06,240 --> 00:29:11,790
<font color="#E5E5E5">screen off if you run chip sack in this</font>

751
00:29:08,520 --> 00:29:14,400
case it's on a<font color="#CCCCCC"> MacBook but it says like</font>

752
00:29:11,790 --> 00:29:16,590
a chip sack modules common<font color="#E5E5E5"> be</font><font color="#CCCCCC"> O's</font><font color="#E5E5E5"> right</font>

753
00:29:14,400 --> 00:29:19,440
<font color="#E5E5E5">protection is not enabled which means</font>

754
00:29:16,590 --> 00:29:22,230
like you may write things to the<font color="#E5E5E5"> BIOS so</font>

755
00:29:19,440 --> 00:29:25,620
it's you may need to check if you<font color="#E5E5E5"> wanna</font>

756
00:29:22,230 --> 00:29:28,770
do any hardening or<font color="#CCCCCC"> newer</font><font color="#E5E5E5"> be BIOS</font><font color="#CCCCCC"> you</font>

757
00:29:25,620 --> 00:29:30,629
can try<font color="#CCCCCC"> it and some sums to change some</font>

758
00:29:28,770 --> 00:29:32,250
<font color="#CCCCCC">settings</font><font color="#E5E5E5"> and there's also this really</font>

759
00:29:30,630 --> 00:29:34,380
<font color="#CCCCCC">interesting presentation from</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Google</font>

760
00:29:32,250 --> 00:29:37,110
security<font color="#CCCCCC"> team it's called femur biopsy</font>

761
00:29:34,380 --> 00:29:40,410
and<font color="#E5E5E5"> it's really interesting because they</font>

762
00:29:37,110 --> 00:29:41,879
mention like some some of the challenges

763
00:29:40,410 --> 00:29:44,520
<font color="#E5E5E5">and what I mentioned like firmware</font>

764
00:29:41,880 --> 00:29:46,410
granularity and visibility<font color="#E5E5E5"> very few</font>

765
00:29:44,520 --> 00:29:49,440
companies<font color="#E5E5E5"> they have visibility</font><font color="#CCCCCC"> of like</font>

766
00:29:46,410 --> 00:29:52,500
what they're like<font color="#CCCCCC"> what people</font><font color="#E5E5E5"> are</font>

767
00:29:49,440 --> 00:29:55,410
actually<font color="#E5E5E5"> running on their devices</font><font color="#CCCCCC"> and</font>

768
00:29:52,500 --> 00:29:57,690
it's it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> just that it's</font><font color="#E5E5E5"> not like</font>

769
00:29:55,410 --> 00:29:59,630
just hashing something and comparing

770
00:29:57,690 --> 00:30:02,160
hashes because like there are<font color="#E5E5E5"> different</font>

771
00:29:59,630 --> 00:30:04,200
environment variables and<font color="#E5E5E5"> you don't know</font>

772
00:30:02,160 --> 00:30:05,610
<font color="#E5E5E5">for example</font><font color="#CCCCCC"> each vendor they put that</font><font color="#E5E5E5"> on</font>

773
00:30:04,200 --> 00:30:08,430
<font color="#CCCCCC">different sections it's not like</font>

774
00:30:05,610 --> 00:30:11,760
something standard<font color="#E5E5E5"> so for example think</font>

775
00:30:08,430 --> 00:30:13,860
<font color="#CCCCCC">about like home routers and you check</font>

776
00:30:11,760 --> 00:30:15,780
the boot boot the BIOS but they like<font color="#E5E5E5"> the</font>

777
00:30:13,860 --> 00:30:18,570
<font color="#CCCCCC">bootloader partition and the bootloader</font>

778
00:30:15,780 --> 00:30:19,170
partition your<font color="#E5E5E5"> router and from another</font>

779
00:30:18,570 --> 00:30:21,060
person

780
00:30:19,170 --> 00:30:23,250
they<font color="#E5E5E5"> probably have different MAC</font>

781
00:30:21,060 --> 00:30:25,250
addresses so you have to ignore<font color="#E5E5E5"> that</font>

782
00:30:23,250 --> 00:30:29,400
section so they also<font color="#E5E5E5"> have different</font>

783
00:30:25,250 --> 00:30:31,260
<font color="#E5E5E5">settings on</font><font color="#CCCCCC"> the on the bootloader</font><font color="#E5E5E5"> so you</font>

784
00:30:29,400 --> 00:30:33,570
have to<font color="#E5E5E5"> ignore that</font><font color="#CCCCCC"> and it's not like</font>

785
00:30:31,260 --> 00:30:35,430
easy to parse that because you have<font color="#E5E5E5"> to</font>

786
00:30:33,570 --> 00:30:37,950
write<font color="#CCCCCC"> parse it for different vendors and</font>

787
00:30:35,430 --> 00:30:39,390
also like unpacking the<font color="#E5E5E5"> femur because</font>

788
00:30:37,950 --> 00:30:41,430
different femur they use different

789
00:30:39,390 --> 00:30:43,320
<font color="#CCCCCC">compression and it's not like a standard</font>

790
00:30:41,430 --> 00:30:46,800
<font color="#CCCCCC">it's that that's also</font><font color="#E5E5E5"> something that's</font>

791
00:30:43,320 --> 00:30:48,750
<font color="#E5E5E5">very difficult and like yeah there's</font>

792
00:30:46,800 --> 00:30:50,909
<font color="#CCCCCC">this</font><font color="#E5E5E5"> people talking on Twitter like</font>

793
00:30:48,750 --> 00:30:52,740
continuous assurance of<font color="#CCCCCC"> conformance is</font>

794
00:30:50,910 --> 00:30:55,080
also crucial<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> efi secure</font><font color="#E5E5E5"> boot</font>

795
00:30:52,740 --> 00:30:56,970
suddenly started silently booting<font color="#E5E5E5"> and</font>

796
00:30:55,080 --> 00:30:58,679
<font color="#CCCCCC">signing the images would you know</font><font color="#E5E5E5"> like</font>

797
00:30:56,970 --> 00:31:01,440
very<font color="#E5E5E5"> few people would just know that</font>

798
00:30:58,680 --> 00:31:03,780
<font color="#CCCCCC">because we don't have</font><font color="#E5E5E5"> inspectable</font>

799
00:31:01,440 --> 00:31:06,710
systems<font color="#E5E5E5"> so there that's</font><font color="#CCCCCC"> what however</font>

800
00:31:03,780 --> 00:31:09,180
flag<font color="#E5E5E5"> is mentioning on twitter so</font>

801
00:31:06,710 --> 00:31:09,780
sometimes we also have not so trusted

802
00:31:09,180 --> 00:31:13,020
computing

803
00:31:09,780 --> 00:31:15,870
I also own<font color="#CCCCCC"> the Snowden documents</font><font color="#E5E5E5"> there's</font>

804
00:31:13,020 --> 00:31:17,910
like some pictures of NSA actually

805
00:31:15,870 --> 00:31:20,040
intercepting packages so suppose your

806
00:31:17,910 --> 00:31:22,230
company<font color="#CCCCCC"> is buying</font><font color="#E5E5E5"> a new switch so they</font>

807
00:31:20,040 --> 00:31:23,879
were actually implanting them so they

808
00:31:22,230 --> 00:31:27,270
were intercepting the shipment<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they</font>

809
00:31:23,880 --> 00:31:29,550
<font color="#E5E5E5">were implanting them and so it's</font>

810
00:31:27,270 --> 00:31:32,370
difficult<font color="#E5E5E5"> for you</font><font color="#CCCCCC"> to know what's</font><font color="#E5E5E5"> running</font>

811
00:31:29,550 --> 00:31:34,230
on your device nowadays<font color="#E5E5E5"> so there's also</font>

812
00:31:32,370 --> 00:31:36,600
supply chain attacks<font color="#E5E5E5"> did you guys hear</font>

813
00:31:34,230 --> 00:31:39,090
about the<font color="#CCCCCC"> ccleaner hack</font><font color="#E5E5E5"> it was like last</font>

814
00:31:36,600 --> 00:31:43,320
month or was this that was really recent

815
00:31:39,090 --> 00:31:45,419
so the<font color="#CCCCCC"> ccleaner hack they</font><font color="#E5E5E5"> people say</font>

816
00:31:43,320 --> 00:31:47,510
like the experts it's<font color="#E5E5E5"> China it's always</font>

817
00:31:45,420 --> 00:31:53,220
either China or Russia<font color="#CCCCCC"> but probably fire</font>

818
00:31:47,510 --> 00:31:56,810
<font color="#E5E5E5">and China's they said that they had</font><font color="#CCCCCC"> six</font>

819
00:31:53,220 --> 00:31:59,490
<font color="#CCCCCC">lunar servers and they were selectively</font>

820
00:31:56,810 --> 00:32:03,360
<font color="#E5E5E5">infecting sending a second stage payload</font>

821
00:31:59,490 --> 00:32:05,220
depending on your<font color="#E5E5E5"> host name so if your</font>

822
00:32:03,360 --> 00:32:08,100
host<font color="#E5E5E5"> name</font><font color="#CCCCCC"> containers like for example</font>

823
00:32:05,220 --> 00:32:09,720
one<font color="#CCCCCC"> of those entries they would send you</font>

824
00:32:08,100 --> 00:32:11,730
like an additional payload which means

825
00:32:09,720 --> 00:32:14,610
you're on the<font color="#E5E5E5"> corporate network of those</font>

826
00:32:11,730 --> 00:32:17,000
companies<font color="#CCCCCC"> so if you're either running a</font>

827
00:32:14,610 --> 00:32:20,729
<font color="#CCCCCC">backdoor ccleaner from</font><font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know</font>

828
00:32:17,000 --> 00:32:23,010
<font color="#E5E5E5">VMware</font><font color="#CCCCCC"> Network or Cisco or Linksys or</font>

829
00:32:20,730 --> 00:32:25,980
<font color="#E5E5E5">d-link home network they would send</font><font color="#CCCCCC"> you</font>

830
00:32:23,010 --> 00:32:28,530
<font color="#CCCCCC">a second stage and people if you</font><font color="#E5E5E5"> stop to</font>

831
00:32:25,980 --> 00:32:31,260
think<font color="#E5E5E5"> about like</font><font color="#CCCCCC"> Linksys</font><font color="#E5E5E5"> Cisco and the</font>

832
00:32:28,530 --> 00:32:34,649
link they sell lots of like home routers

833
00:32:31,260 --> 00:32:37,020
as well<font color="#E5E5E5"> so they're actively trying to to</font>

834
00:32:34,650 --> 00:32:40,140
actually<font color="#E5E5E5"> either get source code in fact</font>

835
00:32:37,020 --> 00:32:42,330
more devices<font color="#CCCCCC"> so</font><font color="#E5E5E5"> worried if they include</font>

836
00:32:40,140 --> 00:32:44,280
like the femur<font color="#E5E5E5"> from those vendors we</font>

837
00:32:42,330 --> 00:32:47,460
have no idea<font color="#E5E5E5"> and people don't care about</font>

838
00:32:44,280 --> 00:32:48,960
checking<font color="#E5E5E5"> that at all and also like do</font>

839
00:32:47,460 --> 00:32:51,780
vendors get hacked<font color="#E5E5E5"> so this is a</font>

840
00:32:48,960 --> 00:32:54,690
screenshot from<font color="#CCCCCC"> d-link</font><font color="#E5E5E5"> Brazil and the</font>

841
00:32:51,780 --> 00:32:56,399
link<font color="#CCCCCC"> cambiar</font><font color="#E5E5E5"> and people are</font><font color="#CCCCCC"> actually</font>

842
00:32:54,690 --> 00:33:00,210
they put like<font color="#E5E5E5"> a</font><font color="#CCCCCC"> JavaScript to mine</font>

843
00:32:56,400 --> 00:33:02,130
bitcoins<font color="#E5E5E5"> on your like</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> do in Brazil</font>

844
00:33:00,210 --> 00:33:05,220
two weeks ago<font color="#CCCCCC"> yeah but like</font><font color="#E5E5E5"> last move</font>

845
00:33:02,130 --> 00:33:07,320
<font color="#E5E5E5">pretty complicated</font><font color="#CCCCCC"> so what happens here</font>

846
00:33:05,220 --> 00:33:09,660
<font color="#E5E5E5">like if you have access to the web</font>

847
00:33:07,320 --> 00:33:11,490
server<font color="#E5E5E5"> you can you can also replace the</font>

848
00:33:09,660 --> 00:33:13,740
<font color="#E5E5E5">few more</font><font color="#CCCCCC"> images and you can</font><font color="#E5E5E5"> put like</font><font color="#CCCCCC"> a</font>

849
00:33:11,490 --> 00:33:16,350
<font color="#CCCCCC">backdoor image so people who are</font>

850
00:33:13,740 --> 00:33:18,330
downloading<font color="#E5E5E5"> like images you have right</font>

851
00:33:16,350 --> 00:33:20,399
here so it's like<font color="#E5E5E5"> so easy for them that</font>

852
00:33:18,330 --> 00:33:22,389
instead of<font color="#E5E5E5"> backdoor humor they just like</font>

853
00:33:20,400 --> 00:33:26,350
like<font color="#E5E5E5"> so easy I'm going</font><font color="#CCCCCC"> to mind</font>

854
00:33:22,390 --> 00:33:28,590
crypto coins on<font color="#E5E5E5"> JavaScript and also</font>

855
00:33:26,350 --> 00:33:32,679
there's this vendor called open mesh

856
00:33:28,590 --> 00:33:34,270
<font color="#E5E5E5">because of requirements from FCC</font><font color="#CCCCCC"> so if</font>

857
00:33:32,680 --> 00:33:37,600
you're selling<font color="#CCCCCC"> a device</font><font color="#E5E5E5"> in the United</font>

858
00:33:34,270 --> 00:33:39,040
States<font color="#E5E5E5"> there are like some rules that</font>

859
00:33:37,600 --> 00:33:41,050
you have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> follow otherwise you</font><font color="#CCCCCC"> can't</font>

860
00:33:39,040 --> 00:33:43,570
sell<font color="#CCCCCC"> though</font><font color="#E5E5E5"> so if your device</font><font color="#CCCCCC"> operates</font>

861
00:33:41,050 --> 00:33:45,490
on the<font color="#E5E5E5"> 5 gigahertz frequency you have to</font>

862
00:33:43,570 --> 00:33:47,320
put some<font color="#E5E5E5"> lock down that people wouldn't</font>

863
00:33:45,490 --> 00:33:49,900
<font color="#CCCCCC">be able to</font><font color="#E5E5E5"> change to certain</font><font color="#CCCCCC"> frequencies</font>

864
00:33:47,320 --> 00:33:52,629
because<font color="#E5E5E5"> of that CC so if you don't put</font>

865
00:33:49,900 --> 00:33:54,520
<font color="#CCCCCC">lock down</font><font color="#E5E5E5"> you can get you can be sued so</font>

866
00:33:52,630 --> 00:33:56,470
as you might sue you so there's<font color="#E5E5E5"> this</font>

867
00:33:54,520 --> 00:34:01,000
vendor called open mesh<font color="#E5E5E5"> they were like</font>

868
00:33:56,470 --> 00:34:03,970
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so we need to be compliant</font><font color="#CCCCCC"> so what</font>

869
00:34:01,000 --> 00:34:06,040
we do<font color="#E5E5E5"> let's protect our you boot so open</font>

870
00:34:03,970 --> 00:34:08,949
mesh they sell like repeaters<font color="#CCCCCC"> and small</font>

871
00:34:06,040 --> 00:34:12,550
route home routers<font color="#CCCCCC"> all those</font><font color="#E5E5E5"> things so</font>

872
00:34:08,949 --> 00:34:15,489
what they did<font color="#CCCCCC"> they put like a</font><font color="#E5E5E5"> signature</font>

873
00:34:12,550 --> 00:34:17,920
<font color="#E5E5E5">so you have you can only boot sign your</font>

874
00:34:15,489 --> 00:34:19,839
boot<font color="#E5E5E5"> images so there's like there was</font>

875
00:34:17,920 --> 00:34:22,450
<font color="#E5E5E5">like this check and they were using RSA</font>

876
00:34:19,840 --> 00:34:25,660
<font color="#E5E5E5">so they had the private key and they</font>

877
00:34:22,449 --> 00:34:27,339
were signing<font color="#E5E5E5"> the new boot emoji so if</font>

878
00:34:25,659 --> 00:34:30,790
you try to modify or change anything

879
00:34:27,340 --> 00:34:32,800
over there<font color="#E5E5E5"> you can bypass that and</font>

880
00:34:30,790 --> 00:34:35,050
<font color="#E5E5E5">change your for example</font><font color="#CCCCCC"> your femur to</font>

881
00:34:32,800 --> 00:34:36,370
enable different<font color="#E5E5E5"> frequencies so</font><font color="#CCCCCC"> those</font>

882
00:34:35,050 --> 00:34:39,310
researchers<font color="#E5E5E5"> what did they do they just</font>

883
00:34:36,370 --> 00:34:41,350
because it's GPL<font color="#E5E5E5"> they</font><font color="#CCCCCC"> ask it</font><font color="#E5E5E5"> for the</font>

884
00:34:39,310 --> 00:34:43,299
source code from the<font color="#CCCCCC"> u-boot so they got</font>

885
00:34:41,350 --> 00:34:45,580
the source code<font color="#E5E5E5"> they analyzed and they</font>

886
00:34:43,300 --> 00:34:48,310
found<font color="#E5E5E5"> out</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> you'd be used</font><font color="#E5E5E5"> it be if</font>

887
00:34:45,580 --> 00:34:50,440
<font color="#E5E5E5">you</font><font color="#CCCCCC"> 0</font><font color="#E5E5E5"> the the</font><font color="#CCCCCC"> public key inside the</font>

888
00:34:48,310 --> 00:34:52,000
video boot partition<font color="#E5E5E5"> it's gonna</font><font color="#CCCCCC"> not</font>

889
00:34:50,440 --> 00:34:54,460
gonna check<font color="#E5E5E5"> it anymore it's going to put</font>

890
00:34:52,000 --> 00:34:56,560
anything you want<font color="#CCCCCC"> so it's a</font><font color="#E5E5E5"> simple hack</font>

891
00:34:54,460 --> 00:34:58,900
so if you have a root on<font color="#CCCCCC"> the device you</font>

892
00:34:56,560 --> 00:35:00,730
can<font color="#CCCCCC"> DD on this offset from the</font><font color="#E5E5E5"> signature</font>

893
00:34:58,900 --> 00:35:03,400
and because there's no signature<font color="#CCCCCC"> it's</font>

894
00:35:00,730 --> 00:35:06,070
just for backs to booting<font color="#CCCCCC"> any any you</font>

895
00:35:03,400 --> 00:35:10,150
<font color="#E5E5E5">boot image you have at all and they also</font>

896
00:35:06,070 --> 00:35:13,210
found this interesting bypass as well so

897
00:35:10,150 --> 00:35:15,160
when you<font color="#CCCCCC"> TFTP boot images</font><font color="#E5E5E5"> so they had</font>

898
00:35:13,210 --> 00:35:18,000
<font color="#CCCCCC">like these device</font><font color="#E5E5E5"> also have a heckuva</font>

899
00:35:15,160 --> 00:35:21,279
<font color="#E5E5E5">remote recovery which you can use and</font>

900
00:35:18,000 --> 00:35:25,480
like a sign it image<font color="#CCCCCC"> to</font><font color="#E5E5E5"> for to download</font>

901
00:35:21,280 --> 00:35:27,490
to boot and recover<font color="#E5E5E5"> your device so there</font>

902
00:35:25,480 --> 00:35:30,160
was a there is a stack overflow<font color="#CCCCCC"> on the</font>

903
00:35:27,490 --> 00:35:32,379
<font color="#CCCCCC">TFTP boobs</font><font color="#E5E5E5"> so when you issue a</font><font color="#CCCCCC"> TFTP boot</font>

904
00:35:30,160 --> 00:35:35,170
<font color="#E5E5E5">c'mon it's going to</font><font color="#CCCCCC"> download something</font>

905
00:35:32,380 --> 00:35:35,950
<font color="#CCCCCC">from a TFTP server</font><font color="#E5E5E5"> so it doesn't it</font>

906
00:35:35,170 --> 00:35:37,450
doesn't care<font color="#E5E5E5"> about</font>

907
00:35:35,950 --> 00:35:39,520
<font color="#E5E5E5">side of the image</font><font color="#CCCCCC"> so if you don't look</font>

908
00:35:37,450 --> 00:35:41,859
<font color="#CCCCCC">like a huge image</font><font color="#E5E5E5"> you're going</font><font color="#CCCCCC"> to</font>

909
00:35:39,520 --> 00:35:44,320
corrupt the stack<font color="#CCCCCC"> so in that</font><font color="#E5E5E5"> you can use</font>

910
00:35:41,859 --> 00:35:46,630
that to<font color="#CCCCCC"> actually fall back to the u-boot</font>

911
00:35:44,320 --> 00:35:48,280
console so they but it's more kind<font color="#E5E5E5"> of</font>

912
00:35:46,630 --> 00:35:51,130
<font color="#CCCCCC">more complicated because</font><font color="#E5E5E5"> you need a JTAG</font>

913
00:35:48,280 --> 00:35:54,400
debugger in order to do is to find this

914
00:35:51,130 --> 00:35:55,750
<font color="#E5E5E5">properly there's also some</font><font color="#CCCCCC"> really</font>

915
00:35:54,400 --> 00:35:59,710
interesting talks about the<font color="#E5E5E5"> risk you'll</font>

916
00:35:55,750 --> 00:36:01,210
guys<font color="#E5E5E5"> so about like my passing</font><font color="#CCCCCC"> security</font>

917
00:35:59,710 --> 00:36:05,050
protection so they gave<font color="#E5E5E5"> a tout recently</font>

918
00:36:01,210 --> 00:36:07,960
on<font color="#CCCCCC"> Shah and they had like a demo</font><font color="#E5E5E5"> by that</font>

919
00:36:05,050 --> 00:36:10,300
they were using glitching<font color="#CCCCCC"> to bypass</font>

920
00:36:07,960 --> 00:36:12,490
<font color="#CCCCCC">their</font><font color="#E5E5E5"> boot protections on some vendors</font>

921
00:36:10,300 --> 00:36:14,170
<font color="#E5E5E5">and they also gave some like yeah</font><font color="#CCCCCC"> this</font>

922
00:36:12,490 --> 00:36:16,410
<font color="#CCCCCC">talk to any ways pass secure boot</font><font color="#E5E5E5"> it's</font>

923
00:36:14,170 --> 00:36:18,730
really<font color="#E5E5E5"> interesting not only</font><font color="#CCCCCC"> boot but</font>

924
00:36:16,410 --> 00:36:20,220
targeting embedded devices in<font color="#CCCCCC"> general</font>

925
00:36:18,730 --> 00:36:23,950
<font color="#E5E5E5">and there's also this group called</font>

926
00:36:20,220 --> 00:36:26,490
Alexis<font color="#E5E5E5"> I left I left one research I left</font>

927
00:36:23,950 --> 00:36:29,109
research they have<font color="#E5E5E5"> all lots of</font>

928
00:36:26,490 --> 00:36:31,779
bootloader<font color="#CCCCCC"> bypasses but they're more</font>

929
00:36:29,109 --> 00:36:33,339
targeting<font color="#E5E5E5"> mobile phones so it makes</font>

930
00:36:31,780 --> 00:36:34,690
<font color="#CCCCCC">sense for for example mobile</font><font color="#E5E5E5"> phone</font>

931
00:36:33,339 --> 00:36:36,790
companies they don't<font color="#E5E5E5"> want you to like</font>

932
00:36:34,690 --> 00:36:38,859
root your device and put like crap

933
00:36:36,790 --> 00:36:41,230
<font color="#CCCCCC">because you might break</font><font color="#E5E5E5"> your device and</font>

934
00:36:38,859 --> 00:36:44,859
also<font color="#E5E5E5"> like video game companies as well</font>

935
00:36:41,230 --> 00:36:47,470
like Microsoft also like Sony<font color="#E5E5E5"> they don't</font>

936
00:36:44,859 --> 00:36:50,230
want you<font color="#E5E5E5"> to jailbreak your console</font>

937
00:36:47,470 --> 00:36:51,910
<font color="#E5E5E5">because you might run pirate content so</font>

938
00:36:50,230 --> 00:36:53,290
they like<font color="#E5E5E5"> the bootloader from those</font>

939
00:36:51,910 --> 00:36:56,230
devices<font color="#E5E5E5"> they are very secure and</font>

940
00:36:53,290 --> 00:36:59,079
nowadays<font color="#E5E5E5"> people are starting</font><font color="#CCCCCC"> to research</font>

941
00:36:56,230 --> 00:37:01,420
on those<font color="#E5E5E5"> bypasses so they can boot and</font>

942
00:36:59,079 --> 00:37:03,130
sign it code and do<font color="#E5E5E5"> wherever they want</font>

943
00:37:01,420 --> 00:37:05,200
but nowadays<font color="#E5E5E5"> for them for like home</font>

944
00:37:03,130 --> 00:37:07,510
routers for like<font color="#E5E5E5"> embedded devices in</font>

945
00:37:05,200 --> 00:37:09,069
general<font color="#E5E5E5"> we have at home there's like</font>

946
00:37:07,510 --> 00:37:11,290
they're not there's no protections at

947
00:37:09,069 --> 00:37:13,119
all so it's like a huge difference from

948
00:37:11,290 --> 00:37:16,359
<font color="#E5E5E5">those devices and like the devices we</font>

949
00:37:13,119 --> 00:37:19,109
have<font color="#E5E5E5"> at home</font><font color="#CCCCCC"> so yeah some former</font>

950
00:37:16,359 --> 00:37:22,089
security resource<font color="#CCCCCC"> there like some</font>

951
00:37:19,109 --> 00:37:24,640
<font color="#E5E5E5">websites showing how you can use TP aims</font>

952
00:37:22,089 --> 00:37:26,470
to<font color="#CCCCCC"> protect your validate for</font><font color="#E5E5E5"> example if</font>

953
00:37:24,640 --> 00:37:28,598
you have a big<font color="#E5E5E5"> ol bone black you can buy</font>

954
00:37:26,470 --> 00:37:30,879
<font color="#CCCCCC">capes</font><font color="#E5E5E5"> and you know it's like that</font><font color="#CCCCCC"> acts</font>

955
00:37:28,599 --> 00:37:33,040
like a ppm so you can have like secure

956
00:37:30,880 --> 00:37:35,260
boot on your<font color="#CCCCCC"> own or black</font><font color="#E5E5E5"> you know</font>

957
00:37:33,040 --> 00:37:37,300
<font color="#CCCCCC">BeagleBone black</font><font color="#E5E5E5"> there's also this</font>

958
00:37:35,260 --> 00:37:39,400
really<font color="#CCCCCC"> interesting book from also from</font>

959
00:37:37,300 --> 00:37:41,470
<font color="#CCCCCC">Intel guys and some other researchers</font>

960
00:37:39,400 --> 00:37:43,510
<font color="#CCCCCC">it's called book rootkit and boot</font><font color="#E5E5E5"> kits</font>

961
00:37:41,470 --> 00:37:45,220
and there's also a<font color="#E5E5E5"> few more security</font>

962
00:37:43,510 --> 00:37:47,619
training<font color="#E5E5E5"> from the Intel guys which</font><font color="#CCCCCC"> is</font>

963
00:37:45,220 --> 00:37:49,410
open source<font color="#E5E5E5"> it's on github</font><font color="#CCCCCC"> it's the day</font>

964
00:37:47,619 --> 00:37:51,900
for<font color="#CCCCCC"> example they dissect</font><font color="#E5E5E5"> the</font>

965
00:37:49,410 --> 00:37:53,759
UEFI boot kit from hacking team they

966
00:37:51,900 --> 00:37:57,360
show how you can detect that<font color="#E5E5E5"> it's also</font>

967
00:37:53,760 --> 00:37:59,520
<font color="#E5E5E5">really</font><font color="#CCCCCC"> interesting so conclusion secure</font>

968
00:37:57,360 --> 00:38:02,520
boot is important nowadays<font color="#CCCCCC"> also for</font>

969
00:37:59,520 --> 00:38:04,980
embedded<font color="#CCCCCC"> devices and we have to reduce</font>

970
00:38:02,520 --> 00:38:07,290
from<font color="#E5E5E5"> our</font><font color="#CCCCCC"> opacity which means that not</font>

971
00:38:04,980 --> 00:38:08,730
only tamper proofing because vendors

972
00:38:07,290 --> 00:38:10,830
they care too much about<font color="#CCCCCC"> temper proofing</font>

973
00:38:08,730 --> 00:38:13,380
they don't want us<font color="#CCCCCC"> to like change things</font>

974
00:38:10,830 --> 00:38:15,720
but they don't give also that<font color="#E5E5E5"> also don't</font>

975
00:38:13,380 --> 00:38:17,280
give us<font color="#CCCCCC"> ways to like verify if what we</font>

976
00:38:15,720 --> 00:38:20,160
were running is the<font color="#E5E5E5"> actual device that</font>

977
00:38:17,280 --> 00:38:21,780
suppose so the<font color="#E5E5E5"> NSA case what if NSA</font>

978
00:38:20,160 --> 00:38:24,210
<font color="#E5E5E5">intercept something how can I verify</font>

979
00:38:21,780 --> 00:38:26,130
<font color="#CCCCCC">so right there ever is like</font><font color="#E5E5E5"> DMA or like</font>

980
00:38:24,210 --> 00:38:28,080
<font color="#E5E5E5">I don't</font><font color="#CCCCCC"> know if you can plug</font><font color="#E5E5E5"> something</font>

981
00:38:26,130 --> 00:38:30,300
that's gonna<font color="#E5E5E5"> show a QR</font><font color="#CCCCCC"> code vendors are</font>

982
00:38:28,080 --> 00:38:33,569
<font color="#CCCCCC">not giving us like</font><font color="#E5E5E5"> ways easy ways</font><font color="#CCCCCC"> for us</font>

983
00:38:30,300 --> 00:38:35,640
to<font color="#E5E5E5"> verify our devices in yeah physical</font>

984
00:38:33,570 --> 00:38:36,750
impediments like having a jumper on<font color="#E5E5E5"> your</font>

985
00:38:35,640 --> 00:38:39,330
motherboard<font color="#CCCCCC"> like in the good</font><font color="#E5E5E5"> old days</font>

986
00:38:36,750 --> 00:38:40,890
<font color="#CCCCCC">have it on your embedded device</font><font color="#E5E5E5"> it's an</font>

987
00:38:39,330 --> 00:38:42,690
issue for vendors because<font color="#CCCCCC"> it just</font><font color="#E5E5E5"> cost</font>

988
00:38:40,890 --> 00:38:44,759
money<font color="#E5E5E5"> or having a having a bootloader on</font>

989
00:38:42,690 --> 00:38:47,360
<font color="#CCCCCC">a separate flash chip it's too expensive</font>

990
00:38:44,760 --> 00:38:50,190
for<font color="#E5E5E5"> them</font><font color="#CCCCCC"> and yeah</font><font color="#E5E5E5"> but a Chromebook has</font>

991
00:38:47,360 --> 00:38:52,380
<font color="#E5E5E5">on the right pin in order to write to</font>

992
00:38:50,190 --> 00:38:54,960
the Chromebook<font color="#E5E5E5"> flash memory now you have</font>

993
00:38:52,380 --> 00:38:56,790
to<font color="#CCCCCC"> actually lose some</font><font color="#E5E5E5"> screw to be able</font>

994
00:38:54,960 --> 00:38:58,500
<font color="#E5E5E5">to flash the bootloader so Chromebook is</font>

995
00:38:56,790 --> 00:38:59,670
doing this<font color="#E5E5E5"> yeah is doing this well this</font>

996
00:38:58,500 --> 00:39:02,100
<font color="#E5E5E5">is really interesting</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> yeah you</font>

997
00:38:59,670 --> 00:39:04,320
<font color="#E5E5E5">the right protector is enable so you</font>

998
00:39:02,100 --> 00:39:08,009
have to<font color="#E5E5E5"> physically remove something so</font>

999
00:39:04,320 --> 00:39:09,450
you<font color="#CCCCCC"> we also need better like reverse</font>

1000
00:39:08,010 --> 00:39:11,340
engineering efforts on bootloader

1001
00:39:09,450 --> 00:39:13,379
because people don't care about<font color="#E5E5E5"> like the</font>

1002
00:39:11,340 --> 00:39:15,660
you boot partition<font color="#CCCCCC"> period that the</font>

1003
00:39:13,380 --> 00:39:19,140
parser we need like better research on

1004
00:39:15,660 --> 00:39:36,270
this<font color="#E5E5E5"> area as</font><font color="#CCCCCC"> well and this times up like</font>

1005
00:39:19,140 --> 00:39:39,060
questions let<font color="#CCCCCC"> me get you</font><font color="#E5E5E5"> the different</font>

1006
00:39:36,270 --> 00:39:41,340
<font color="#E5E5E5">ways to to get into</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> you boot so um I</font>

1007
00:39:39,060 --> 00:39:44,310
heard you've seen the<font color="#CCCCCC"> you're connected</font>

1008
00:39:41,340 --> 00:39:48,630
through you are<font color="#E5E5E5"> yeah you can go through</font>

1009
00:39:44,310 --> 00:39:50,070
you are yeah JTAG as well<font color="#E5E5E5"> yeah if if</font>

1010
00:39:48,630 --> 00:39:52,260
<font color="#CCCCCC">JTAG is on the board then you can also</font>

1011
00:39:50,070 --> 00:39:54,750
<font color="#E5E5E5">use JPEG</font><font color="#CCCCCC"> Wolff</font><font color="#E5E5E5"> the IOT device is</font>

1012
00:39:52,260 --> 00:39:56,810
<font color="#CCCCCC">completely like off those two</font>

1013
00:39:54,750 --> 00:39:59,220
connections

1014
00:39:56,810 --> 00:40:01,170
<font color="#CCCCCC">both like the device warfare the</font>

1015
00:39:59,220 --> 00:40:02,549
<font color="#CCCCCC">manufacturers like gone the</font><font color="#E5E5E5"> boards and</font>

1016
00:40:01,170 --> 00:40:03,840
like removed those connect<font color="#CCCCCC"> okay you can</font>

1017
00:40:02,550 --> 00:40:05,130
dump the<font color="#E5E5E5"> flag if you have a root</font><font color="#CCCCCC"> shell</font>

1018
00:40:03,840 --> 00:40:07,080
minimize you can dump the<font color="#CCCCCC"> flash</font><font color="#E5E5E5"> from</font>

1019
00:40:05,130 --> 00:40:08,580
there and<font color="#E5E5E5"> also you</font><font color="#CCCCCC"> would have</font><font color="#E5E5E5"> to get</font>

1020
00:40:07,080 --> 00:40:10,410
<font color="#CCCCCC">real on there yeah if you have real</font>

1021
00:40:08,580 --> 00:40:21,330
device you can usually get access to

1022
00:40:10,410 --> 00:40:23,910
their petitions<font color="#E5E5E5"> okay okay thanks hi</font><font color="#CCCCCC"> was</font>

1023
00:40:21,330 --> 00:40:27,750
<font color="#E5E5E5">this research done</font><font color="#CCCCCC"> in the context of kpn</font>

1024
00:40:23,910 --> 00:40:30,420
or generic<font color="#E5E5E5"> your own investigation</font><font color="#CCCCCC"> or so</font>

1025
00:40:27,750 --> 00:40:32,790
yeah we<font color="#E5E5E5"> work for the red team from so we</font>

1026
00:40:30,420 --> 00:40:35,490
work for<font color="#E5E5E5"> a telco and telco has like</font>

1027
00:40:32,790 --> 00:40:37,170
<font color="#E5E5E5">network equipments so we don't we to</font>

1028
00:40:35,490 --> 00:40:40,649
test a lot<font color="#E5E5E5"> of hardware</font><font color="#CCCCCC"> for the company</font>

1029
00:40:37,170 --> 00:40:42,780
so yeah and we do<font color="#E5E5E5"> this as like an</font>

1030
00:40:40,650 --> 00:40:44,910
additional layer because<font color="#CCCCCC"> Mauer target</font>

1031
00:40:42,780 --> 00:40:46,710
<font color="#E5E5E5">targeting</font><font color="#CCCCCC"> embedded devices</font><font color="#E5E5E5"> nowadays they</font>

1032
00:40:44,910 --> 00:40:48,509
<font color="#CCCCCC">don't care about persistence</font><font color="#E5E5E5"> but there's</font>

1033
00:40:46,710 --> 00:40:50,300
<font color="#E5E5E5">going to be updated hacking and by the</font>

1034
00:40:48,510 --> 00:40:52,470
device is<font color="#E5E5E5"> going to be more</font><font color="#CCCCCC"> difficult</font><font color="#E5E5E5"> and</font>

1035
00:40:50,300 --> 00:40:54,600
like they start<font color="#E5E5E5"> thinking about</font>

1036
00:40:52,470 --> 00:40:57,390
<font color="#CCCCCC">persistence in</font><font color="#E5E5E5"> the femur level and after</font>

1037
00:40:54,600 --> 00:40:59,910
<font color="#CCCCCC">that on</font><font color="#E5E5E5"> the boot boot like</font><font color="#CCCCCC"> bootloader</font>

1038
00:40:57,390 --> 00:41:01,350
level but this was a project<font color="#CCCCCC"> yeah we did</font>

1039
00:40:59,910 --> 00:41:03,990
<font color="#CCCCCC">it in</font><font color="#E5E5E5"> your spare</font><font color="#CCCCCC"> time yeah</font><font color="#E5E5E5"> so it's like</font>

1040
00:41:01,350 --> 00:41:05,970
<font color="#CCCCCC">four we do that that's</font><font color="#E5E5E5"> like we have a</font>

1041
00:41:03,990 --> 00:41:08,040
<font color="#E5E5E5">tool kit so if we're doing red team</font>

1042
00:41:05,970 --> 00:41:10,529
engagements for example we put<font color="#E5E5E5"> an</font>

1043
00:41:08,040 --> 00:41:12,090
implant in<font color="#CCCCCC"> the network and then we</font><font color="#E5E5E5"> have</font>

1044
00:41:10,530 --> 00:41:14,310
this dual<font color="#CCCCCC"> boot thing like so it's more</font>

1045
00:41:12,090 --> 00:41:16,700
<font color="#E5E5E5">difficult</font><font color="#CCCCCC"> to detect</font><font color="#E5E5E5"> we also have like</font>

1046
00:41:14,310 --> 00:41:23,870
in-house tools for us to<font color="#CCCCCC"> test as well</font>

1047
00:41:16,700 --> 00:41:23,870
<font color="#CCCCCC">okay thank</font><font color="#E5E5E5"> you Russians</font>

1048
00:41:26,180 --> 00:41:33,120
<font color="#E5E5E5">okay that's it okay</font>

1049
00:41:28,490 --> 00:41:33,120
[Applause]

