1
00:00:06,560 --> 00:00:11,329
<font color="#E5E5E5">okay so hi everyone</font>

2
00:00:08,269 --> 00:00:13,369
<font color="#CCCCCC">I'm well that's Luis Gomes we're here to</font>

3
00:00:11,330 --> 00:00:15,859
talk<font color="#CCCCCC"> about practical</font><font color="#E5E5E5"> out-of-band data</font>

4
00:00:13,369 --> 00:00:18,829
exfiltration in 802<font color="#CCCCCC"> 11</font>

5
00:00:15,859 --> 00:00:21,349
that's Wi-Fi for ever for anyone who may

6
00:00:18,829 --> 00:00:27,349
not have<font color="#E5E5E5"> heard of it before</font>

7
00:00:21,349 --> 00:00:29,029
I pretty much have some bio things here

8
00:00:27,349 --> 00:00:32,450
<font color="#E5E5E5">mine's a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit more serious</font>

9
00:00:29,029 --> 00:00:35,180
<font color="#CCCCCC">Louise</font><font color="#E5E5E5"> she's a little</font><font color="#CCCCCC"> bit better</font><font color="#E5E5E5"> so I</font>

10
00:00:32,450 --> 00:00:38,629
work at<font color="#E5E5E5"> check marks I work at cobalt as</font>

11
00:00:35,180 --> 00:00:41,690
well<font color="#CCCCCC"> I'd co-developed airborne ng which</font>

12
00:00:38,629 --> 00:00:43,460
is a man on<font color="#CCCCCC"> the side attack tool</font><font color="#E5E5E5"> on</font>

13
00:00:41,690 --> 00:00:46,640
<font color="#E5E5E5">wireless as well</font>

14
00:00:43,460 --> 00:00:48,560
<font color="#CCCCCC">I built a couple</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> tools well actually</font>

15
00:00:46,640 --> 00:00:51,920
it<font color="#E5E5E5"> was more</font><font color="#CCCCCC"> like a module or two for</font>

16
00:00:48,560 --> 00:00:54,230
<font color="#CCCCCC">Metasploit too so I was a DEFCON</font><font color="#E5E5E5"> 25</font>

17
00:00:51,920 --> 00:00:56,450
workshop instructor I did a<font color="#E5E5E5"> workshop</font>

18
00:00:54,230 --> 00:00:59,419
<font color="#E5E5E5">about scape</font><font color="#CCCCCC"> II which</font><font color="#E5E5E5"> is also the</font>

19
00:00:56,450 --> 00:01:02,809
framework we built this tool on so

20
00:00:59,420 --> 00:01:05,119
things should<font color="#E5E5E5"> get interesting</font><font color="#CCCCCC"> and Louise</font>

21
00:01:02,809 --> 00:01:08,479
would you<font color="#E5E5E5"> like to introduce yourself</font><font color="#CCCCCC"> or</font>

22
00:01:05,119 --> 00:01:11,810
<font color="#E5E5E5">just show you the money I don't know</font><font color="#CCCCCC"> so</font>

23
00:01:08,479 --> 00:01:17,299
for me I'm currently head of security

24
00:01:11,810 --> 00:01:20,600
for OLX<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the gospel group</font><font color="#CCCCCC"> I also work</font>

25
00:01:17,299 --> 00:01:24,439
at<font color="#E5E5E5"> cobalt I started in the banking</font>

26
00:01:20,600 --> 00:01:27,350
industry or payments<font color="#E5E5E5"> industry with</font><font color="#CCCCCC"> SIDS</font>

27
00:01:24,439 --> 00:01:29,749
<font color="#CCCCCC">and then move</font><font color="#E5E5E5"> forward</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> I do a couple</font>

28
00:01:27,350 --> 00:01:32,449
<font color="#CCCCCC">of things in my life but</font><font color="#E5E5E5"> ultimately</font>

29
00:01:29,749 --> 00:01:36,740
<font color="#E5E5E5">currently I'm just doing bug bounties</font>

30
00:01:32,450 --> 00:01:40,189
<font color="#E5E5E5">shout out</font><font color="#CCCCCC"> to support</font><font color="#E5E5E5"> and also taking</font>

31
00:01:36,740 --> 00:01:42,318
<font color="#E5E5E5">care of the security</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> Alexis</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> okay</font>

32
00:01:40,189 --> 00:01:44,089
so let's get down<font color="#CCCCCC"> to business</font>

33
00:01:42,319 --> 00:01:47,240
first of all let's do just<font color="#E5E5E5"> a little bit</font>

34
00:01:44,090 --> 00:01:52,340
<font color="#E5E5E5">of an intro 802</font><font color="#CCCCCC"> or 11 has several frame</font>

35
00:01:47,240 --> 00:01:55,310
frame types there's this is the pretty

36
00:01:52,340 --> 00:01:57,380
much what the format is<font color="#CCCCCC"> when you have</font>

37
00:01:55,310 --> 00:02:00,590
the<font color="#CCCCCC"> the type and subtype actually</font>

38
00:01:57,380 --> 00:02:02,869
dictate what the type of<font color="#E5E5E5"> frame it is if</font>

39
00:02:00,590 --> 00:02:06,679
you<font color="#E5E5E5"> have control frames data frames and</font>

40
00:02:02,869 --> 00:02:09,919
there's management frames as well<font color="#CCCCCC"> what</font>

41
00:02:06,679 --> 00:02:12,290
what<font color="#E5E5E5"> prior art in data exfiltration</font><font color="#CCCCCC"> was</font>

42
00:02:09,919 --> 00:02:15,559
through out-of-band channels in 802<font color="#E5E5E5"> 11</font>

43
00:02:12,290 --> 00:02:19,340
has done is<font color="#E5E5E5"> actually good grab one of</font>

44
00:02:15,560 --> 00:02:21,460
<font color="#E5E5E5">these many fields and try to manipulate</font>

45
00:02:19,340 --> 00:02:23,470
<font color="#E5E5E5">them and insert data there</font><font color="#CCCCCC"> where</font>

46
00:02:21,460 --> 00:02:27,130
they will not be<font color="#CCCCCC"> used or would not</font><font color="#E5E5E5"> be</font>

47
00:02:23,470 --> 00:02:30,640
<font color="#E5E5E5">checked or something like</font><font color="#CCCCCC"> that so this</font>

48
00:02:27,130 --> 00:02:34,210
is pretty<font color="#CCCCCC"> much what we want to do this</font>

49
00:02:30,640 --> 00:02:37,119
is your typical 802 11 Network<font color="#E5E5E5"> you have</font>

50
00:02:34,210 --> 00:02:38,770
<font color="#CCCCCC">a Wi-Fi router you have the</font><font color="#E5E5E5"> internet on</font>

51
00:02:37,120 --> 00:02:41,890
the other end<font color="#E5E5E5"> and then you have the</font>

52
00:02:38,770 --> 00:02:44,170
devices<font color="#CCCCCC"> you have internally what we want</font>

53
00:02:41,890 --> 00:02:47,380
to do is something<font color="#E5E5E5"> like this so you drop</font>

54
00:02:44,170 --> 00:02:50,649
an implant<font color="#CCCCCC"> there's a physical</font><font color="#E5E5E5"> cable</font>

55
00:02:47,380 --> 00:02:53,859
usually it's a<font color="#E5E5E5"> cable connection on from</font>

56
00:02:50,650 --> 00:02:55,420
the<font color="#E5E5E5"> implant</font><font color="#CCCCCC"> to the router</font><font color="#E5E5E5"> and then</font>

57
00:02:53,860 --> 00:02:57,550
there's an attacker device that gets

58
00:02:55,420 --> 00:03:00,429
some kind<font color="#E5E5E5"> of signal or response or</font>

59
00:02:57,550 --> 00:03:02,890
whatever communications<font color="#E5E5E5"> through an</font>

60
00:03:00,430 --> 00:03:05,020
<font color="#E5E5E5">channel that's parallel</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the the</font>

61
00:03:02,890 --> 00:03:06,579
<font color="#E5E5E5">actual server you're trying to use what</font>

62
00:03:05,020 --> 00:03:09,550
<font color="#CCCCCC">are the benefits of this there's many</font>

63
00:03:06,580 --> 00:03:11,050
you<font color="#E5E5E5"> don't go through their IDs or IPs or</font>

64
00:03:09,550 --> 00:03:13,120
whatever you don't send packets<font color="#E5E5E5"> through</font>

65
00:03:11,050 --> 00:03:15,070
their network you can<font color="#CCCCCC"> even get</font><font color="#E5E5E5"> to a</font>

66
00:03:13,120 --> 00:03:17,530
point where the wireless implant does

67
00:03:15,070 --> 00:03:18,970
not have an IP on the network and and

68
00:03:17,530 --> 00:03:21,940
yet you can still<font color="#E5E5E5"> port scan or do</font>

69
00:03:18,970 --> 00:03:24,010
whatever you want<font color="#CCCCCC"> and</font><font color="#E5E5E5"> still</font><font color="#CCCCCC"> get</font>

70
00:03:21,940 --> 00:03:25,630
communications outside without<font color="#E5E5E5"> anyone on</font>

71
00:03:24,010 --> 00:03:28,480
the<font color="#CCCCCC"> inside having</font><font color="#E5E5E5"> any idea what's</font>

72
00:03:25,630 --> 00:03:32,109
happening<font color="#E5E5E5"> so this is pretty</font><font color="#CCCCCC"> much what we</font>

73
00:03:28,480 --> 00:03:35,679
want to do and now what's the the

74
00:03:32,110 --> 00:03:37,450
problems we might face or the<font color="#E5E5E5"> point the</font>

75
00:03:35,680 --> 00:03:39,910
real point<font color="#CCCCCC"> of this is to</font><font color="#E5E5E5"> get</font>

76
00:03:37,450 --> 00:03:43,600
communication and data across<font color="#E5E5E5"> without</font>

77
00:03:39,910 --> 00:03:46,540
being detected<font color="#E5E5E5"> so even though the prior</font>

78
00:03:43,600 --> 00:03:50,230
art has done this semi successfully the

79
00:03:46,540 --> 00:03:53,079
very first<font color="#E5E5E5"> idea or the very first</font>

80
00:03:50,230 --> 00:03:55,810
<font color="#E5E5E5">thought of how to implement</font><font color="#CCCCCC"> something</font>

81
00:03:53,080 --> 00:03:59,110
<font color="#CCCCCC">like this would probably</font><font color="#E5E5E5"> be the level</font><font color="#CCCCCC"> 0</font>

82
00:03:55,810 --> 00:04:00,820
<font color="#E5E5E5">attack which is the easy way</font><font color="#CCCCCC"> just drop a</font>

83
00:03:59,110 --> 00:04:02,800
rogue ap right so you<font color="#E5E5E5"> just drop</font>

84
00:04:00,820 --> 00:04:06,579
something<font color="#E5E5E5"> there and connect it with a</font>

85
00:04:02,800 --> 00:04:08,920
wired or<font color="#CCCCCC"> Wireless to the on scope</font><font color="#E5E5E5"> ap</font>

86
00:04:06,580 --> 00:04:11,710
let's call it that<font color="#E5E5E5"> or the target</font><font color="#CCCCCC"> ap and</font>

87
00:04:08,920 --> 00:04:13,030
then it just spins up another<font color="#E5E5E5"> AP and you</font>

88
00:04:11,710 --> 00:04:16,600
can<font color="#CCCCCC"> just connect to</font><font color="#E5E5E5"> that through your</font>

89
00:04:13,030 --> 00:04:18,880
attacker device and<font color="#E5E5E5"> why what else would</font>

90
00:04:16,600 --> 00:04:20,950
<font color="#CCCCCC">you</font><font color="#E5E5E5"> need right well there's a problem</font>

91
00:04:18,880 --> 00:04:22,750
<font color="#E5E5E5">with this approach</font><font color="#CCCCCC"> well while it's</font>

92
00:04:20,950 --> 00:04:27,310
<font color="#CCCCCC">out-of-band</font><font color="#E5E5E5"> because it's not really on</font>

93
00:04:22,750 --> 00:04:29,980
the<font color="#E5E5E5"> attack network the beacons beacon</font>

94
00:04:27,310 --> 00:04:33,910
<font color="#CCCCCC">frames sent by this ap which is in this</font>

95
00:04:29,980 --> 00:04:35,350
<font color="#E5E5E5">case the Wi-Fi pineapple will pretty</font>

96
00:04:33,910 --> 00:04:37,930
much give you away

97
00:04:35,350 --> 00:04:40,000
because the<font color="#E5E5E5"> if</font><font color="#CCCCCC"> somebody's doing defense</font>

98
00:04:37,930 --> 00:04:41,770
<font color="#E5E5E5">on the wireless side they will</font>

99
00:04:40,000 --> 00:04:43,840
immediately detect that<font color="#CCCCCC"> a new ap has</font>

100
00:04:41,770 --> 00:04:46,659
popped up and is<font color="#E5E5E5"> sending beacon probes</font>

101
00:04:43,840 --> 00:04:48,489
and sending you all these packets<font color="#E5E5E5"> to</font>

102
00:04:46,660 --> 00:04:51,400
your so that<font color="#E5E5E5"> it shows up in your device</font>

103
00:04:48,490 --> 00:04:54,670
list when you try<font color="#E5E5E5"> to connect so pretty</font>

104
00:04:51,400 --> 00:04:57,130
<font color="#E5E5E5">much this is something</font><font color="#CCCCCC"> that was the</font>

105
00:04:54,670 --> 00:05:00,250
state of<font color="#CCCCCC"> the art or</font><font color="#E5E5E5"> trying to be the</font>

106
00:04:57,130 --> 00:05:02,860
state<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the first way to do it but then</font>

107
00:05:00,250 --> 00:05:05,740
you start<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get into the more technical</font>

108
00:05:02,860 --> 00:05:08,710
<font color="#E5E5E5">things on how to hide data inside the</font>

109
00:05:05,740 --> 00:05:11,410
<font color="#E5E5E5">actual frames and now I'm going to pass</font>

110
00:05:08,710 --> 00:05:16,900
<font color="#E5E5E5">it on to</font><font color="#CCCCCC"> the wish</font><font color="#E5E5E5"> to keep going</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the</font>

111
00:05:11,410 --> 00:05:19,270
other<font color="#E5E5E5"> parts yep so what we have right</font>

112
00:05:16,900 --> 00:05:21,370
<font color="#E5E5E5">now is uh well we have some stuff right</font>

113
00:05:19,270 --> 00:05:25,840
<font color="#CCCCCC">now that is similar to what we are</font><font color="#E5E5E5"> about</font>

114
00:05:21,370 --> 00:05:29,350
<font color="#E5E5E5">to show still it's not that easy</font><font color="#CCCCCC"> for a</font>

115
00:05:25,840 --> 00:05:32,229
blue team to detect<font color="#E5E5E5"> but if the pans if</font>

116
00:05:29,350 --> 00:05:35,170
the team is one skilled enough to<font color="#CCCCCC"> if</font>

117
00:05:32,230 --> 00:05:38,140
they have enough tools<font color="#E5E5E5"> to</font><font color="#CCCCCC"> detected but</font>

118
00:05:35,170 --> 00:05:40,060
above all just the the<font color="#E5E5E5"> critical point is</font>

119
00:05:38,140 --> 00:05:42,490
is anybody<font color="#CCCCCC"> looking at what you are</font>

120
00:05:40,060 --> 00:05:44,950
trying to<font color="#E5E5E5"> send out number the I think</font>

121
00:05:42,490 --> 00:05:47,460
the famous one will be<font color="#E5E5E5"> spider</font><font color="#CCCCCC"> Labs got</font>

122
00:05:44,950 --> 00:05:50,020
one called smuggler<font color="#E5E5E5"> and there is a</font>

123
00:05:47,460 --> 00:05:54,030
<font color="#E5E5E5">patents already sore something similar</font>

124
00:05:50,020 --> 00:05:57,250
about<font color="#CCCCCC"> sonography we have exfiltration</font>

125
00:05:54,030 --> 00:06:00,130
<font color="#E5E5E5">patents on devices similar to what we</font>

126
00:05:57,250 --> 00:06:02,320
<font color="#CCCCCC">are</font><font color="#E5E5E5"> about to show and there is also the</font>

127
00:06:00,130 --> 00:06:05,170
one on the on the<font color="#E5E5E5"> left on on your left</font>

128
00:06:02,320 --> 00:06:08,050
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> that is</font><font color="#CCCCCC"> pretty much a library</font>

129
00:06:05,170 --> 00:06:11,080
<font color="#E5E5E5">that assumes that creates EDP channels</font>

130
00:06:08,050 --> 00:06:13,780
and it's similar<font color="#E5E5E5"> to ours and we're</font><font color="#CCCCCC"> gonna</font>

131
00:06:11,080 --> 00:06:16,270
<font color="#E5E5E5">show on the next slides</font><font color="#CCCCCC"> that everything</font>

132
00:06:13,780 --> 00:06:19,419
is these are nice implementations<font color="#E5E5E5"> still</font>

133
00:06:16,270 --> 00:06:22,419
flawed by design because<font color="#CCCCCC"> if you will</font>

134
00:06:19,420 --> 00:06:23,980
create an agnostic<font color="#E5E5E5"> layer but in what we</font>

135
00:06:22,420 --> 00:06:25,870
<font color="#E5E5E5">are looking for and you</font><font color="#CCCCCC"> don't look for</font>

136
00:06:23,980 --> 00:06:28,480
signatures or attacks that<font color="#E5E5E5"> are specific</font>

137
00:06:25,870 --> 00:06:30,310
using encoding or whatever<font color="#CCCCCC"> your</font><font color="#E5E5E5"> going to</font>

138
00:06:28,480 --> 00:06:32,410
think of at the end we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

139
00:06:30,310 --> 00:06:34,960
understand<font color="#E5E5E5"> that right</font><font color="#CCCCCC"> now the</font><font color="#E5E5E5"> the</font>

140
00:06:32,410 --> 00:06:37,450
<font color="#CCCCCC">critical part is most of them use either</font>

141
00:06:34,960 --> 00:06:42,099
a something<font color="#E5E5E5"> that you can detect just by</font>

142
00:06:37,450 --> 00:06:44,200
looking at<font color="#E5E5E5"> the Wireshark or cm or any</font>

143
00:06:42,100 --> 00:06:46,900
other monitoring<font color="#E5E5E5"> tool that you</font><font color="#CCCCCC"> have or B</font>

144
00:06:44,200 --> 00:06:49,120
if you<font color="#E5E5E5"> have some kind</font><font color="#CCCCCC"> of AI just</font><font color="#E5E5E5"> looking</font>

145
00:06:46,900 --> 00:06:50,710
for patterns<font color="#E5E5E5"> is gonna spike</font>

146
00:06:49,120 --> 00:06:54,580
right through<font color="#E5E5E5"> it like you're gonna see</font>

147
00:06:50,710 --> 00:06:57,370
all<font color="#E5E5E5"> the communications and don't work</font>

148
00:06:54,580 --> 00:06:59,229
because<font color="#E5E5E5"> at some point the blue team is</font>

149
00:06:57,370 --> 00:07:01,510
going<font color="#E5E5E5"> to understand that something is</font>

150
00:06:59,229 --> 00:07:05,289
off<font color="#E5E5E5"> because either a there is a like he</font>

151
00:07:01,510 --> 00:07:07,930
said<font color="#CCCCCC"> in</font><font color="#E5E5E5"> a rogue</font><font color="#CCCCCC"> ap or one ap</font><font color="#E5E5E5"> that it has</font>

152
00:07:05,290 --> 00:07:11,199
the same name<font color="#CCCCCC"> as</font><font color="#E5E5E5"> any other is sending</font>

153
00:07:07,930 --> 00:07:14,740
too much data encode the data on strange

154
00:07:11,199 --> 00:07:17,590
fields<font color="#E5E5E5"> or it's doing everything right</font>

155
00:07:14,740 --> 00:07:19,960
<font color="#E5E5E5">but</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> always the same destination</font>

156
00:07:17,590 --> 00:07:22,659
always the same fields never random

157
00:07:19,960 --> 00:07:24,719
feels always static so that is one<font color="#E5E5E5"> of</font>

158
00:07:22,660 --> 00:07:28,210
the ways that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> see that don't</font><font color="#E5E5E5"> work</font>

159
00:07:24,720 --> 00:07:30,729
well<font color="#E5E5E5"> you have one of the levels</font><font color="#CCCCCC"> that is</font>

160
00:07:28,210 --> 00:07:33,070
surely<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> wanna show okay so this</font>

161
00:07:30,729 --> 00:07:35,289
is one<font color="#CCCCCC"> of the the means that has been</font>

162
00:07:33,070 --> 00:07:37,479
have been<font color="#E5E5E5"> used before</font><font color="#CCCCCC"> to send data out</font>

163
00:07:35,290 --> 00:07:38,889
<font color="#CCCCCC">events so as I was</font><font color="#E5E5E5"> saying</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> the</font>

164
00:07:37,479 --> 00:07:43,150
problem<font color="#CCCCCC"> with the rogue ap is that it's</font>

165
00:07:38,889 --> 00:07:45,580
constantly<font color="#E5E5E5"> sending beacon frames with</font>

166
00:07:43,150 --> 00:07:48,549
<font color="#CCCCCC">the SSID</font><font color="#E5E5E5"> name so here I</font><font color="#CCCCCC"> am I am</font>

167
00:07:45,580 --> 00:07:50,830
<font color="#E5E5E5">Microsoft guests</font><font color="#CCCCCC"> Wireless so that it</font>

168
00:07:48,550 --> 00:07:52,570
will keep<font color="#CCCCCC"> sending those like 10 every</font>

169
00:07:50,830 --> 00:07:54,010
second or<font color="#CCCCCC"> something like</font><font color="#E5E5E5"> that so to make</font>

170
00:07:52,570 --> 00:07:57,610
<font color="#CCCCCC">sure that it shows up in</font><font color="#E5E5E5"> your device</font>

171
00:07:54,010 --> 00:08:00,849
list<font color="#E5E5E5"> Wi-Fi access point list</font><font color="#CCCCCC"> what some</font>

172
00:07:57,610 --> 00:08:03,310
<font color="#CCCCCC">people find</font><font color="#E5E5E5"> out namely the guys from spy</font>

173
00:08:00,850 --> 00:08:05,979
<font color="#E5E5E5">their lives is that you can actually</font>

174
00:08:03,310 --> 00:08:08,830
<font color="#CCCCCC">send just one of them and instead of</font>

175
00:08:05,979 --> 00:08:10,930
sending in an SSID<font color="#E5E5E5"> you just send data</font>

176
00:08:08,830 --> 00:08:13,359
<font color="#CCCCCC">there like basically for encoded which</font>

177
00:08:10,930 --> 00:08:15,220
is what they<font color="#CCCCCC"> did so</font><font color="#E5E5E5"> they actually</font>

178
00:08:13,360 --> 00:08:21,700
implemented it I think we can<font color="#E5E5E5"> probably</font>

179
00:08:15,220 --> 00:08:24,240
show a demo of<font color="#E5E5E5"> this</font><font color="#CCCCCC"> okay so I'm just</font>

180
00:08:21,700 --> 00:08:24,240
<font color="#E5E5E5">right</font>

181
00:08:27,980 --> 00:08:47,750
okay<font color="#E5E5E5"> everyone's read the screen</font><font color="#CCCCCC"> cause</font>

182
00:08:31,220 --> 00:08:51,920
we're gonna<font color="#E5E5E5"> yeah let's hope that's how</font>

183
00:08:47,750 --> 00:08:56,270
it's possible<font color="#CCCCCC"> to</font><font color="#E5E5E5"> read yeah okay so this</font>

184
00:08:51,920 --> 00:09:02,750
will be the the server so<font color="#E5E5E5"> you would have</font>

185
00:08:56,270 --> 00:09:05,630
<font color="#E5E5E5">to</font><font color="#CCCCCC"> set up the receiver</font><font color="#E5E5E5"> then you said the</font>

186
00:09:02,750 --> 00:09:07,910
interface name and then so on<font color="#E5E5E5"> one</font><font color="#CCCCCC"> at one</font>

187
00:09:05,630 --> 00:09:10,700
<font color="#E5E5E5">end you</font><font color="#CCCCCC"> have the server</font><font color="#E5E5E5"> and on the</font><font color="#CCCCCC"> end</font>

188
00:09:07,910 --> 00:09:12,170
<font color="#E5E5E5">there and you have the attacker</font><font color="#CCCCCC"> so what</font>

189
00:09:10,700 --> 00:09:13,910
you have is this is<font color="#E5E5E5"> the implant and</font>

190
00:09:12,170 --> 00:09:18,199
that's the other device the<font color="#CCCCCC"> attacker is</font>

191
00:09:13,910 --> 00:09:23,870
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to use to exfiltrate data</font><font color="#CCCCCC"> to in</font>

192
00:09:18,200 --> 00:09:30,320
this<font color="#E5E5E5"> case we'll see</font><font color="#CCCCCC"> very first why this</font>

193
00:09:23,870 --> 00:09:32,660
is a problem<font color="#CCCCCC"> so it</font><font color="#E5E5E5"> will try to pretty</font>

194
00:09:30,320 --> 00:09:36,560
<font color="#E5E5E5">much what it'll give me as a shell let</font>

195
00:09:32,660 --> 00:09:38,060
me just try<font color="#E5E5E5"> to</font><font color="#CCCCCC"> pull this up for you</font><font color="#E5E5E5"> okay</font>

196
00:09:36,560 --> 00:09:41,869
<font color="#CCCCCC">so pretty</font><font color="#E5E5E5"> much what they give us is a</font>

197
00:09:38,060 --> 00:09:45,500
shell<font color="#CCCCCC"> if you do LS in theory it would</font><font color="#E5E5E5"> be</font>

198
00:09:41,870 --> 00:09:54,530
getting<font color="#E5E5E5"> the let me just check for one</font>

199
00:09:45,500 --> 00:09:57,470
second<font color="#E5E5E5"> yeah right because for this to</font>

200
00:09:54,530 --> 00:10:01,250
work<font color="#E5E5E5"> every both cards have to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> at the</font>

201
00:09:57,470 --> 00:10:03,290
same<font color="#CCCCCC"> channel so since that one was</font>

202
00:10:01,250 --> 00:10:08,240
<font color="#CCCCCC">channel helping the problem will</font><font color="#E5E5E5"> gonna</font>

203
00:10:03,290 --> 00:10:11,480
work<font color="#E5E5E5"> okay so as you</font><font color="#CCCCCC"> can see</font><font color="#E5E5E5"> it got</font>

204
00:10:08,240 --> 00:10:15,770
actually a bad<font color="#E5E5E5"> command but it's fine</font>

205
00:10:11,480 --> 00:10:16,190
because<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is kind of okay</font><font color="#CCCCCC"> so now it</font>

206
00:10:15,770 --> 00:10:19,460
works

207
00:10:16,190 --> 00:10:20,540
<font color="#E5E5E5">you see LS they cannot access something</font>

208
00:10:19,460 --> 00:10:22,700
so this is actually just<font color="#CCCCCC"> the</font>

209
00:10:20,540 --> 00:10:25,699
<font color="#CCCCCC">proof-of-concept</font><font color="#E5E5E5"> code I just literally</font>

210
00:10:22,700 --> 00:10:28,280
get cloned it and try<font color="#E5E5E5"> to use it so this</font>

211
00:10:25,700 --> 00:10:30,710
<font color="#CCCCCC">is the</font><font color="#E5E5E5"> experience you have</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> LS what</font>

212
00:10:28,280 --> 00:10:32,420
it does is it<font color="#E5E5E5"> runs your command grabs</font>

213
00:10:30,710 --> 00:10:34,190
the output<font color="#CCCCCC"> wait first</font><font color="#E5E5E5"> waits for five</font>

214
00:10:32,420 --> 00:10:36,740
seconds<font color="#E5E5E5"> then sends the response back as</font>

215
00:10:34,190 --> 00:10:39,080
you can see it was just<font color="#CCCCCC"> there right</font><font color="#E5E5E5"> so</font>

216
00:10:36,740 --> 00:10:41,090
this<font color="#E5E5E5"> is the what they had right so it</font>

217
00:10:39,080 --> 00:10:41,950
doesn't<font color="#CCCCCC"> really have a problem</font><font color="#E5E5E5"> here so</font>

218
00:10:41,090 --> 00:10:44,019
let's try

219
00:10:41,950 --> 00:10:49,510
another command let<font color="#E5E5E5"> me just exit so I</font>

220
00:10:44,019 --> 00:10:51,459
can pull the screen up<font color="#CCCCCC"> so let's try a</font>

221
00:10:49,510 --> 00:10:53,889
command<font color="#E5E5E5"> that has actually a little bit</font>

222
00:10:51,459 --> 00:10:59,469
more of an<font color="#CCCCCC"> output instead</font><font color="#E5E5E5"> of just three</font>

223
00:10:53,889 --> 00:11:03,399
lines or<font color="#E5E5E5"> four yeah that's not gonna work</font>

224
00:10:59,470 --> 00:11:06,760
it's just gonna say yeah<font color="#E5E5E5"> no exception so</font>

225
00:11:03,399 --> 00:11:08,980
<font color="#E5E5E5">yeah you bite format requires zero or</font>

226
00:11:06,760 --> 00:11:10,660
<font color="#CCCCCC">something just</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> fifty fifty-five</font><font color="#E5E5E5"> okay</font>

227
00:11:08,980 --> 00:11:12,690
so this is what happens when you try to

228
00:11:10,660 --> 00:11:16,480
just<font color="#E5E5E5"> use a tool that's</font><font color="#CCCCCC"> already been</font>

229
00:11:12,690 --> 00:11:18,790
worked on this<font color="#E5E5E5"> is supposed to be</font><font color="#CCCCCC"> the</font>

230
00:11:16,480 --> 00:11:21,970
state<font color="#E5E5E5"> of the art of open source</font><font color="#CCCCCC"> event</font>

231
00:11:18,790 --> 00:11:24,760
data exfiltration<font color="#CCCCCC"> in wireless yeah so</font>

232
00:11:21,970 --> 00:11:26,260
wide well<font color="#E5E5E5"> this is what if you grab the</font>

233
00:11:24,760 --> 00:11:28,720
<font color="#E5E5E5">peak app if you are looking at at the</font>

234
00:11:26,260 --> 00:11:31,000
<font color="#E5E5E5">traffic right now</font><font color="#CCCCCC"> I don't know</font><font color="#E5E5E5"> if some</font>

235
00:11:28,720 --> 00:11:32,889
<font color="#CCCCCC">of you do blue team or not but even if</font>

236
00:11:31,000 --> 00:11:37,839
you don't do blue team like if you look

237
00:11:32,889 --> 00:11:40,449
<font color="#E5E5E5">at at the SSID on this part of your</font>

238
00:11:37,839 --> 00:11:42,100
window<font color="#E5E5E5"> tell me that if this is normal</font>

239
00:11:40,449 --> 00:11:43,510
<font color="#E5E5E5">like if you're</font><font color="#CCCCCC"> just looking at normal</font>

240
00:11:42,100 --> 00:11:47,320
patterns and<font color="#E5E5E5"> that is what we</font><font color="#CCCCCC"> are talking</font>

241
00:11:43,510 --> 00:11:51,010
<font color="#E5E5E5">about this over here</font><font color="#CCCCCC"> or on in here</font>

242
00:11:47,320 --> 00:11:53,290
depends on where you<font color="#E5E5E5"> want to look at if</font>

243
00:11:51,010 --> 00:11:55,060
you don't get spiked by this then

244
00:11:53,290 --> 00:11:57,069
something<font color="#E5E5E5"> is wrong</font><font color="#CCCCCC"> like you need to</font>

245
00:11:55,060 --> 00:11:59,649
understand<font color="#CCCCCC"> that if this is</font><font color="#E5E5E5"> your state of</font>

246
00:11:57,070 --> 00:12:01,690
<font color="#CCCCCC">the art of exfiltration then you need to</font>

247
00:11:59,649 --> 00:12:04,240
step<font color="#E5E5E5"> your game up</font><font color="#CCCCCC"> this is not</font><font color="#E5E5E5"> going to</font>

248
00:12:01,690 --> 00:12:06,970
work in any organization with proper

249
00:12:04,240 --> 00:12:09,060
<font color="#E5E5E5">we're talking about back in the</font><font color="#CCCCCC"> end of</font>

250
00:12:06,970 --> 00:12:12,699
the slides we're gonna have

251
00:12:09,060 --> 00:12:14,439
military-grade<font color="#E5E5E5"> acceleration like we're</font>

252
00:12:12,699 --> 00:12:17,729
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> when you want to do</font>

253
00:12:14,440 --> 00:12:23,019
<font color="#E5E5E5">something right not get caught with it</font>

254
00:12:17,730 --> 00:12:24,760
<font color="#E5E5E5">so normally what we are thinking is and</font>

255
00:12:23,019 --> 00:12:28,300
this<font color="#E5E5E5"> is for people that know me this</font>

256
00:12:24,760 --> 00:12:30,250
<font color="#E5E5E5">makes sense</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is you want to get</font>

257
00:12:28,300 --> 00:12:32,050
<font color="#E5E5E5">like the maximum amount of data that</font><font color="#CCCCCC"> you</font>

258
00:12:30,250 --> 00:12:35,319
<font color="#CCCCCC">can like</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> want just show that ISM</font>

259
00:12:32,050 --> 00:12:37,089
it can't like bring bring a big

260
00:12:35,319 --> 00:12:39,339
information outside<font color="#E5E5E5"> because it's limited</font>

261
00:12:37,089 --> 00:12:41,980
to to do the<font color="#E5E5E5"> sides that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can exit</font>

262
00:12:39,339 --> 00:12:43,600
rate but the thing is<font color="#E5E5E5"> we want to get all</font>

263
00:12:41,980 --> 00:12:44,560
the<font color="#CCCCCC"> things that we have there doesn't</font>

264
00:12:43,600 --> 00:12:47,260
<font color="#E5E5E5">matter if you want to just have a</font>

265
00:12:44,560 --> 00:12:49,930
foothold on the<font color="#E5E5E5"> organization it just use</font>

266
00:12:47,260 --> 00:12:52,449
as a shell<font color="#CCCCCC"> or wear whatever</font><font color="#E5E5E5"> you want but</font>

267
00:12:49,930 --> 00:12:54,729
the number one<font color="#E5E5E5"> reason why these tools</font>

268
00:12:52,449 --> 00:12:55,569
<font color="#E5E5E5">don't work is that they don't know how</font>

269
00:12:54,730 --> 00:12:57,580
to disguise

270
00:12:55,570 --> 00:12:59,980
sounds like you need<font color="#E5E5E5"> to understand</font><font color="#CCCCCC"> that</font>

271
00:12:57,580 --> 00:13:02,290
if<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to get by any AI in the</font>

272
00:12:59,980 --> 00:13:04,800
future or if you want to get by<font color="#E5E5E5"> by any</font>

273
00:13:02,290 --> 00:13:08,949
detection measure<font color="#CCCCCC"> it</font><font color="#E5E5E5"> needs to be</font>

274
00:13:04,800 --> 00:13:12,099
expected to<font color="#CCCCCC"> be</font><font color="#E5E5E5"> detected but at least act</font>

275
00:13:08,950 --> 00:13:14,860
act like<font color="#E5E5E5"> a octopus just understand what</font>

276
00:13:12,100 --> 00:13:17,770
is<font color="#CCCCCC"> the texture the feel the looks and be</font>

277
00:13:14,860 --> 00:13:20,230
like that all the<font color="#CCCCCC"> time and do not spike</font>

278
00:13:17,770 --> 00:13:23,199
any type of thresholds on patterns

279
00:13:20,230 --> 00:13:24,490
because at the<font color="#CCCCCC"> end of the day</font><font color="#E5E5E5"> and we're</font>

280
00:13:23,200 --> 00:13:26,740
going to show a little<font color="#E5E5E5"> bit of an</font>

281
00:13:24,490 --> 00:13:28,570
<font color="#E5E5E5">improvement from</font><font color="#CCCCCC"> the state of</font><font color="#E5E5E5"> the art</font>

282
00:13:26,740 --> 00:13:32,920
<font color="#E5E5E5">that they have in until we show you the</font>

283
00:13:28,570 --> 00:13:35,080
big boy<font color="#CCCCCC"> is you can really just</font><font color="#E5E5E5"> disguise</font>

284
00:13:32,920 --> 00:13:37,000
like you can take from the from<font color="#CCCCCC"> that</font>

285
00:13:35,080 --> 00:13:39,130
specific spike that<font color="#E5E5E5"> you see in the in</font>

286
00:13:37,000 --> 00:13:40,870
the SSID the exfiltration and use other

287
00:13:39,130 --> 00:13:43,150
<font color="#E5E5E5">fields like</font><font color="#CCCCCC"> he</font><font color="#E5E5E5"> showed you the fields</font>

288
00:13:40,870 --> 00:13:45,730
before<font color="#E5E5E5"> just to give an idea where you</font>

289
00:13:43,150 --> 00:13:47,709
<font color="#E5E5E5">can try to put your payloads</font><font color="#CCCCCC"> to</font>

290
00:13:45,730 --> 00:13:50,380
exfiltrate that or<font color="#CCCCCC"> just to interact</font><font color="#E5E5E5"> with</font>

291
00:13:47,710 --> 00:13:52,840
<font color="#E5E5E5">the shell but at some</font><font color="#CCCCCC"> point if if</font>

292
00:13:50,380 --> 00:13:54,820
<font color="#E5E5E5">somebody like we are presenting now in</font>

293
00:13:52,840 --> 00:13:57,040
the future<font color="#E5E5E5"> if we present in more places</font>

294
00:13:54,820 --> 00:13:59,410
<font color="#E5E5E5">then the tool becomes famous people are</font>

295
00:13:57,040 --> 00:14:02,770
going<font color="#E5E5E5"> to start looking</font><font color="#CCCCCC"> at the solution</font>

296
00:13:59,410 --> 00:14:05,260
and they're<font color="#E5E5E5"> going to create rules right</font>

297
00:14:02,770 --> 00:14:06,670
so what<font color="#CCCCCC"> we</font><font color="#E5E5E5"> going to</font><font color="#CCCCCC"> present in the end</font>

298
00:14:05,260 --> 00:14:11,290
and this is<font color="#CCCCCC"> just an improvement from</font>

299
00:14:06,670 --> 00:14:13,030
from the example before<font color="#E5E5E5"> is a way that</font>

300
00:14:11,290 --> 00:14:15,849
<font color="#E5E5E5">either if they improve doesn't matter</font>

301
00:14:13,030 --> 00:14:17,589
how how they improve it<font color="#CCCCCC"> ten or call</font>

302
00:14:15,850 --> 00:14:20,670
Watson or whatever they can<font color="#E5E5E5"> call it to</font>

303
00:14:17,590 --> 00:14:23,500
<font color="#E5E5E5">try to attract our tool we're gonna be</font>

304
00:14:20,670 --> 00:14:25,510
step ahead and just blend in more and

305
00:14:23,500 --> 00:14:28,660
<font color="#E5E5E5">blend in more to the part where you can</font>

306
00:14:25,510 --> 00:14:31,689
be exfoliating that<font color="#E5E5E5"> and not get caught</font>

307
00:14:28,660 --> 00:14:33,850
<font color="#E5E5E5">or if you want to get caught just in the</font>

308
00:14:31,690 --> 00:14:36,070
end<font color="#E5E5E5"> of the talk we I don't have nothing</font>

309
00:14:33,850 --> 00:14:39,070
<font color="#E5E5E5">programmed to dinner and you for some</font>

310
00:14:36,070 --> 00:14:41,470
numbers we<font color="#E5E5E5"> can already see some</font><font color="#CCCCCC"> kind of</font>

311
00:14:39,070 --> 00:14:44,320
detection<font color="#E5E5E5"> but until then it's</font>

312
00:14:41,470 --> 00:14:46,120
undetectable<font color="#CCCCCC"> or if</font><font color="#E5E5E5"> somebody got an ID in</font>

313
00:14:44,320 --> 00:14:50,350
the end<font color="#E5E5E5"> please feel free to break our</font>

314
00:14:46,120 --> 00:14:53,170
<font color="#CCCCCC">two here okay so let's get a little bit</font>

315
00:14:50,350 --> 00:14:55,480
<font color="#CCCCCC">into the specifics so as I told</font><font color="#E5E5E5"> you</font>

316
00:14:53,170 --> 00:14:58,800
before<font color="#E5E5E5"> the other ones use the additional</font>

317
00:14:55,480 --> 00:15:02,290
<font color="#E5E5E5">alt layers on the gyro</font><font color="#CCCCCC"> 211 frames or</font>

318
00:14:58,800 --> 00:15:05,650
replacing the SSID<font color="#CCCCCC"> field with acne the</font>

319
00:15:02,290 --> 00:15:07,719
data you wanna<font color="#E5E5E5"> exfiltrate or whatever so</font>

320
00:15:05,650 --> 00:15:08,978
let's<font color="#CCCCCC"> try something</font><font color="#E5E5E5"> different just</font><font color="#CCCCCC"> a</font>

321
00:15:07,720 --> 00:15:11,589
different<font color="#E5E5E5"> approach</font>

322
00:15:08,979 --> 00:15:13,929
let's use 802 11 data frames<font color="#E5E5E5"> they were</font>

323
00:15:11,589 --> 00:15:15,369
actually designed to<font color="#E5E5E5"> hold the data so if</font>

324
00:15:13,929 --> 00:15:17,848
you're doing<font color="#E5E5E5"> like a get request that's</font>

325
00:15:15,369 --> 00:15:21,459
where<font color="#E5E5E5"> the get requests will actually be</font>

326
00:15:17,849 --> 00:15:24,789
and they're usually encrypted because<font color="#CCCCCC"> we</font>

327
00:15:21,459 --> 00:15:28,118
usually Wi-Fi networks have encryption

328
00:15:24,789 --> 00:15:30,639
<font color="#E5E5E5">so that's you're just gonna be looking</font>

329
00:15:28,119 --> 00:15:33,969
at random data<font color="#E5E5E5"> so that doesn't matter</font>

330
00:15:30,639 --> 00:15:37,299
because<font color="#E5E5E5"> for us</font><font color="#CCCCCC"> what we</font><font color="#E5E5E5"> really want to do</font>

331
00:15:33,969 --> 00:15:39,939
<font color="#E5E5E5">is not stand out so how do we use</font><font color="#CCCCCC"> a data</font>

332
00:15:37,299 --> 00:15:42,179
frame and not stand<font color="#E5E5E5"> out that somebody's</font>

333
00:15:39,939 --> 00:15:45,819
sending something outside of<font color="#E5E5E5"> our network</font>

334
00:15:42,179 --> 00:15:48,249
<font color="#CCCCCC">well let's just take a look</font><font color="#E5E5E5"> a little bit</font>

335
00:15:45,819 --> 00:15:51,488
of a<font color="#E5E5E5"> look into what</font><font color="#CCCCCC"> the structure is</font><font color="#E5E5E5"> of</font>

336
00:15:48,249 --> 00:15:53,769
this packet so it's just this is<font color="#CCCCCC"> just a</font>

337
00:15:51,489 --> 00:15:56,919
QoS data so it has like<font color="#CCCCCC"> the data</font><font color="#E5E5E5"> over</font>

338
00:15:53,769 --> 00:16:01,149
<font color="#CCCCCC">here this</font><font color="#E5E5E5"> specific packet has a just</font><font color="#CCCCCC"> 155</font>

339
00:15:56,919 --> 00:16:02,649
and<font color="#CCCCCC"> 45 bytes of length it has some CCMP</font>

340
00:16:01,149 --> 00:16:05,439
parameters because that's the encryption

341
00:16:02,649 --> 00:16:07,089
<font color="#CCCCCC">that was used on the Wi-Fi network</font><font color="#E5E5E5"> some</font>

342
00:16:05,439 --> 00:16:09,339
<font color="#CCCCCC">addresses just</font><font color="#E5E5E5"> to know who is sending</font>

343
00:16:07,089 --> 00:16:12,009
<font color="#E5E5E5">who is</font><font color="#CCCCCC"> receiving and then there's not</font><font color="#E5E5E5"> a</font>

344
00:16:09,339 --> 00:16:15,249
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> little else</font><font color="#CCCCCC"> so it's kind of</font>

345
00:16:12,009 --> 00:16:17,919
simple<font color="#CCCCCC"> let's see what this will look</font>

346
00:16:15,249 --> 00:16:19,629
<font color="#E5E5E5">like for the attackers so they would</font>

347
00:16:17,919 --> 00:16:22,629
just<font color="#E5E5E5"> drop the implant</font><font color="#CCCCCC"> connect it to the</font>

348
00:16:19,629 --> 00:16:25,569
target<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then send the data frames up</font>

349
00:16:22,629 --> 00:16:27,429
to the other device<font color="#CCCCCC"> how is this</font>

350
00:16:25,569 --> 00:16:30,159
different<font color="#CCCCCC"> from</font><font color="#E5E5E5"> what we</font><font color="#CCCCCC"> just showed you</font>

351
00:16:27,429 --> 00:16:33,039
<font color="#CCCCCC">before well this is what the defender</font>

352
00:16:30,159 --> 00:16:35,649
sees the<font color="#CCCCCC"> the actual</font><font color="#E5E5E5"> implant what it does</font>

353
00:16:33,039 --> 00:16:37,509
is it scans<font color="#E5E5E5"> the neighborhood neighboring</font>

354
00:16:35,649 --> 00:16:39,459
a piece<font color="#E5E5E5"> picks one that set the</font>

355
00:16:37,509 --> 00:16:41,859
<font color="#CCCCCC">appropriate signal strength and then</font>

356
00:16:39,459 --> 00:16:43,598
tries<font color="#CCCCCC"> to emulate</font><font color="#E5E5E5"> that that that ap is</font>

357
00:16:41,859 --> 00:16:45,369
sending a message<font color="#CCCCCC"> to another</font><font color="#E5E5E5"> station</font>

358
00:16:43,599 --> 00:16:47,769
<font color="#E5E5E5">that's even further away</font><font color="#CCCCCC"> that you can</font>

359
00:16:45,369 --> 00:16:49,299
see so you<font color="#CCCCCC"> can just for</font><font color="#E5E5E5"> the the defender</font>

360
00:16:47,769 --> 00:16:51,099
it they can<font color="#CCCCCC"> just assume that they can</font>

361
00:16:49,299 --> 00:16:52,959
only see half<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> conversation</font>

362
00:16:51,099 --> 00:16:54,549
<font color="#E5E5E5">because they're closer to the AP</font><font color="#CCCCCC"> the</font>

363
00:16:52,959 --> 00:16:57,429
station is even further<font color="#E5E5E5"> away so they can</font>

364
00:16:54,549 --> 00:16:59,649
<font color="#CCCCCC">only</font><font color="#E5E5E5"> see half</font><font color="#CCCCCC"> of it</font><font color="#E5E5E5"> and that's like the</font>

365
00:16:57,429 --> 00:17:03,459
server talking and when the<font color="#E5E5E5"> client talks</font>

366
00:16:59,649 --> 00:17:05,169
<font color="#CCCCCC">it's the other</font><font color="#E5E5E5"> AP so the client will do</font>

367
00:17:03,459 --> 00:17:07,599
the exact same<font color="#E5E5E5"> procedure they will look</font>

368
00:17:05,169 --> 00:17:10,299
at the<font color="#CCCCCC"> airspace they will try to find a</font>

369
00:17:07,599 --> 00:17:12,490
<font color="#CCCCCC">ap to spoof</font><font color="#E5E5E5"> and then just start</font><font color="#CCCCCC"> sending</font>

370
00:17:10,299 --> 00:17:14,500
packets but there's a<font color="#E5E5E5"> little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> of</font>

371
00:17:12,490 --> 00:17:16,809
magic here like for example<font color="#E5E5E5"> how does</font>

372
00:17:14,500 --> 00:17:18,490
Wi-Fi station to know how to talk<font color="#CCCCCC"> to</font>

373
00:17:16,809 --> 00:17:20,980
Wi-Fi station<font color="#E5E5E5"> one are you using</font>

374
00:17:18,490 --> 00:17:22,060
<font color="#CCCCCC">hard-coded MAC addresses no because then</font>

375
00:17:20,980 --> 00:17:24,370
you can track me

376
00:17:22,060 --> 00:17:28,089
so how are<font color="#CCCCCC"> you figuring</font><font color="#E5E5E5"> this out well</font>

377
00:17:24,369 --> 00:17:29,860
there's some magic called<font color="#CCCCCC"> totp which is</font>

378
00:17:28,089 --> 00:17:32,260
the technology<font color="#CCCCCC"> behind</font><font color="#E5E5E5"> your Google</font>

379
00:17:29,860 --> 00:17:34,990
Authenticator codes that roll every 30

380
00:17:32,260 --> 00:17:38,860
seconds<font color="#E5E5E5"> so basically what's happening is</font>

381
00:17:34,990 --> 00:17:42,310
this<font color="#CCCCCC"> wireless implant is just sitting</font>

382
00:17:38,860 --> 00:17:44,800
there<font color="#E5E5E5"> quietly iterating its</font><font color="#CCCCCC"> TOTP</font>

383
00:17:42,310 --> 00:17:46,899
algorithm<font color="#E5E5E5"> every 30 seconds and in the</font>

384
00:17:44,800 --> 00:17:50,169
<font color="#E5E5E5">correct</font><font color="#CCCCCC"> time slot when the attackers</font>

385
00:17:46,900 --> 00:17:51,640
device tries to connect<font color="#E5E5E5"> it will see if</font>

386
00:17:50,170 --> 00:17:54,790
the MAC<font color="#CCCCCC"> address which is</font>

387
00:17:51,640 --> 00:17:57,190
deterministically generated via the<font color="#CCCCCC"> totp</font>

388
00:17:54,790 --> 00:18:00,280
secret<font color="#E5E5E5"> matches with what it's expecting</font>

389
00:17:57,190 --> 00:18:03,430
it will<font color="#CCCCCC"> send the it will accept a packet</font>

390
00:18:00,280 --> 00:18:05,830
and send the response<font color="#E5E5E5"> with another just</font>

391
00:18:03,430 --> 00:18:08,470
it will hop channels<font color="#E5E5E5"> so this is set</font><font color="#CCCCCC"> for</font>

392
00:18:05,830 --> 00:18:10,240
a default<font color="#E5E5E5"> channel of 6 if it's in</font>

393
00:18:08,470 --> 00:18:12,250
channel 6 it<font color="#E5E5E5"> will be ready to receive a</font>

394
00:18:10,240 --> 00:18:14,550
new connection at the point that it

395
00:18:12,250 --> 00:18:17,740
receives a new connection<font color="#E5E5E5"> it will just</font>

396
00:18:14,550 --> 00:18:20,379
send a handshake packet that will say<font color="#CCCCCC"> ok</font>

397
00:18:17,740 --> 00:18:22,960
this is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> the MAC</font><font color="#CCCCCC"> address I'm going to</font>

398
00:18:20,380 --> 00:18:26,170
use because<font color="#E5E5E5"> I already saw this station</font>

399
00:18:22,960 --> 00:18:30,520
this station<font color="#CCCCCC"> 2 which is an</font><font color="#E5E5E5"> actual</font>

400
00:18:26,170 --> 00:18:33,490
station<font color="#E5E5E5"> talking to a p2 neighbor a p2 so</font>

401
00:18:30,520 --> 00:18:35,560
let's just try<font color="#CCCCCC"> to spoof that</font><font color="#E5E5E5"> and now I'm</font>

402
00:18:33,490 --> 00:18:37,390
<font color="#E5E5E5">the question is and this is why we was</font>

403
00:18:35,560 --> 00:18:39,040
asking how do you detect this<font color="#E5E5E5"> the</font>

404
00:18:37,390 --> 00:18:40,860
<font color="#E5E5E5">question is how do you know when you're</font>

405
00:18:39,040 --> 00:18:45,240
trying<font color="#E5E5E5"> to protect your company which is</font>

406
00:18:40,860 --> 00:18:47,590
target<font color="#E5E5E5"> IP that a p1 from the neighbor is</font>

407
00:18:45,240 --> 00:18:52,150
talking to Wi-Fi station<font color="#E5E5E5"> 1 how do you</font>

408
00:18:47,590 --> 00:18:55,720
know if<font color="#E5E5E5"> that's a legit station or not is</font>

409
00:18:52,150 --> 00:18:58,210
<font color="#E5E5E5">that in scope</font><font color="#CCCCCC"> even yeah should you</font>

410
00:18:55,720 --> 00:19:05,470
should<font color="#CCCCCC"> you try to even track the</font>

411
00:18:58,210 --> 00:19:08,200
neighbors<font color="#CCCCCC"> av</font><font color="#E5E5E5"> I think the the</font><font color="#CCCCCC"> asymmetry</font>

412
00:19:05,470 --> 00:19:10,540
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the attack and</font><font color="#CCCCCC"> the defense on this</font>

413
00:19:08,200 --> 00:19:14,140
<font color="#E5E5E5">kind of wireless</font><font color="#CCCCCC"> exfiltration</font>

414
00:19:10,540 --> 00:19:16,450
with via<font color="#E5E5E5"> out-of-band channels is</font><font color="#CCCCCC"> it's</font>

415
00:19:14,140 --> 00:19:18,190
kind<font color="#E5E5E5"> of makes it really hard</font><font color="#CCCCCC"> for the</font>

416
00:19:16,450 --> 00:19:19,840
blue team<font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually track this because</font>

417
00:19:18,190 --> 00:19:21,040
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> just one of</font><font color="#CCCCCC"> the ways that you</font>

418
00:19:19,840 --> 00:19:23,350
<font color="#CCCCCC">can do it you</font><font color="#E5E5E5"> can do</font><font color="#CCCCCC"> it a</font><font color="#E5E5E5"> million</font>

419
00:19:21,040 --> 00:19:25,210
different<font color="#E5E5E5"> ways and if you try</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> make</font>

420
00:19:23,350 --> 00:19:27,250
the algorithm secret and that's the key

421
00:19:25,210 --> 00:19:29,890
the<font color="#E5E5E5"> secret sauce years to your solution</font>

422
00:19:27,250 --> 00:19:31,930
<font color="#CCCCCC">then once somebody buys it or picks it</font>

423
00:19:29,890 --> 00:19:33,940
up then you're done<font color="#CCCCCC"> if you actually have</font>

424
00:19:31,930 --> 00:19:35,770
something that<font color="#E5E5E5"> if you people know how it</font>

425
00:19:33,940 --> 00:19:38,950
works<font color="#E5E5E5"> and you still can't detect it</font>

426
00:19:35,770 --> 00:19:41,770
then you got something<font color="#CCCCCC"> and I think that</font>

427
00:19:38,950 --> 00:19:44,080
this is a very nice solution<font color="#CCCCCC"> it will not</font>

428
00:19:41,770 --> 00:19:46,180
<font color="#E5E5E5">work in every scenario because if you</font>

429
00:19:44,080 --> 00:19:48,070
have a Faraday cage<font color="#E5E5E5"> and</font><font color="#CCCCCC"> a very secret</font>

430
00:19:46,180 --> 00:19:49,840
underground vault<font color="#E5E5E5"> then you will not have</font>

431
00:19:48,070 --> 00:19:53,950
a neighboring<font color="#CCCCCC"> AP</font><font color="#E5E5E5"> so this will not work</font>

432
00:19:49,840 --> 00:19:55,929
<font color="#E5E5E5">right</font><font color="#CCCCCC"> but there are many ease offices in</font>

433
00:19:53,950 --> 00:19:57,280
<font color="#E5E5E5">high-rise buildings or just a</font><font color="#CCCCCC"> regular</font>

434
00:19:55,930 --> 00:19:59,290
office building<font color="#CCCCCC"> that has a lot of</font>

435
00:19:57,280 --> 00:20:01,899
<font color="#E5E5E5">neighbors and</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> a piece and then</font>

436
00:19:59,290 --> 00:20:06,120
in the<font color="#E5E5E5"> neighboring airspace so this will</font>

437
00:20:01,900 --> 00:20:09,520
<font color="#E5E5E5">probably work in 99% of the situations</font>

438
00:20:06,120 --> 00:20:14,110
which we want<font color="#E5E5E5"> to talk a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> more</font>

439
00:20:09,520 --> 00:20:16,780
about the detection<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> so most of the</font>

440
00:20:14,110 --> 00:20:19,979
times<font color="#CCCCCC"> my the exercise that</font><font color="#E5E5E5"> means you</font>

441
00:20:16,780 --> 00:20:24,160
were having for almost a year<font color="#CCCCCC"> now</font><font color="#E5E5E5"> is</font>

442
00:20:19,980 --> 00:20:26,650
either<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> I develop a way to</font><font color="#E5E5E5"> detect</font>

443
00:20:24,160 --> 00:20:29,200
it<font color="#CCCCCC"> and it tries to</font><font color="#E5E5E5"> break it like evade</font>

444
00:20:26,650 --> 00:20:34,210
it but we do that exercise<font color="#E5E5E5"> probably once</font>

445
00:20:29,200 --> 00:20:35,950
per week<font color="#E5E5E5"> so my question is for everybody</font>

446
00:20:34,210 --> 00:20:38,950
<font color="#CCCCCC">that is</font><font color="#E5E5E5"> this is a lot of</font><font color="#CCCCCC"> information for</font>

447
00:20:35,950 --> 00:20:41,920
<font color="#E5E5E5">a slide first</font><font color="#CCCCCC"> I know for a toe the thing</font>

448
00:20:38,950 --> 00:20:43,840
is this is<font color="#CCCCCC"> all the variables that</font><font color="#E5E5E5"> I got</font>

449
00:20:41,920 --> 00:20:46,180
to think<font color="#CCCCCC"> about when I'm trying</font><font color="#E5E5E5"> to detect</font>

450
00:20:43,840 --> 00:20:48,699
<font color="#CCCCCC">these</font><font color="#E5E5E5"> type of attacks</font><font color="#CCCCCC"> these are from to</font>

451
00:20:46,180 --> 00:20:50,530
<font color="#CCCCCC">our</font><font color="#E5E5E5"> expected the time is the like is</font>

452
00:20:48,700 --> 00:20:52,840
<font color="#E5E5E5">this</font><font color="#CCCCCC"> to AP's</font><font color="#E5E5E5"> talking at</font><font color="#CCCCCC"> a time there is</font>

453
00:20:50,530 --> 00:20:55,030
<font color="#E5E5E5">no one in the office or or</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> supposed</font>

454
00:20:52,840 --> 00:20:57,699
<font color="#E5E5E5">to have they are supposed to be talking</font>

455
00:20:55,030 --> 00:20:59,470
<font color="#CCCCCC">at that time</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is so many information</font>

456
00:20:57,700 --> 00:21:01,330
but this is all the vectors<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I got a</font>

457
00:20:59,470 --> 00:21:03,340
look<font color="#E5E5E5"> and then from all this type of</font>

458
00:21:01,330 --> 00:21:05,169
<font color="#CCCCCC">questions that I can ask myself to</font>

459
00:21:03,340 --> 00:21:07,060
create<font color="#CCCCCC"> a detection</font><font color="#E5E5E5"> for the type</font><font color="#CCCCCC"> of</font>

460
00:21:05,170 --> 00:21:10,390
attacks<font color="#CCCCCC"> that you see right now then we</font>

461
00:21:07,060 --> 00:21:12,669
have<font color="#E5E5E5"> different sources</font><font color="#CCCCCC"> of data sources</font>

462
00:21:10,390 --> 00:21:14,740
like can<font color="#CCCCCC"> be from the type of a situation</font>

463
00:21:12,670 --> 00:21:16,780
is trying to do<font color="#E5E5E5"> is coming from the</font>

464
00:21:14,740 --> 00:21:18,790
implant but when you're trying to

465
00:21:16,780 --> 00:21:22,110
<font color="#E5E5E5">construct the rules what you see is the</font>

466
00:21:18,790 --> 00:21:24,399
thing<font color="#E5E5E5"> over here so logical conditions to</font>

467
00:21:22,110 --> 00:21:27,010
over something that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't know if I'm</font>

468
00:21:24,400 --> 00:21:28,540
looking I'm<font color="#CCCCCC"> not even looking</font><font color="#E5E5E5"> at or</font>

469
00:21:27,010 --> 00:21:31,390
<font color="#E5E5E5">trying</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> create a logical condition</font>

470
00:21:28,540 --> 00:21:33,520
that will tell<font color="#CCCCCC"> me that the network</font>

471
00:21:31,390 --> 00:21:35,980
events that are happening will result in

472
00:21:33,520 --> 00:21:40,510
an alert is very hard because everything

473
00:21:35,980 --> 00:21:44,230
<font color="#E5E5E5">is doing is expected so I there is no</font>

474
00:21:40,510 --> 00:21:47,560
type<font color="#CCCCCC"> of a difference</font><font color="#E5E5E5"> that I can look at</font>

475
00:21:44,230 --> 00:21:49,510
a healthy communication<font color="#CCCCCC"> between two APs</font>

476
00:21:47,560 --> 00:21:51,280
and say<font color="#CCCCCC"> well this is some</font>

477
00:21:49,510 --> 00:21:53,620
yet we can detect because<font color="#E5E5E5"> this has never</font>

478
00:21:51,280 --> 00:21:56,200
happened before or I never<font color="#E5E5E5"> seen this</font>

479
00:21:53,620 --> 00:21:57,879
before<font color="#CCCCCC"> or this</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> happens from time to</font>

480
00:21:56,200 --> 00:21:59,830
time I<font color="#E5E5E5"> don't know when</font><font color="#CCCCCC"> but I should</font>

481
00:21:57,880 --> 00:22:01,450
review the event every<font color="#CCCCCC"> single time that</font>

482
00:21:59,830 --> 00:22:03,340
<font color="#E5E5E5">it happens it doesn't happen like that</font>

483
00:22:01,450 --> 00:22:07,570
<font color="#E5E5E5">the last version that we have from the</font>

484
00:22:03,340 --> 00:22:10,120
<font color="#E5E5E5">2a only adds when there is people acting</font>

485
00:22:07,570 --> 00:22:12,879
only<font color="#CCCCCC"> sends</font><font color="#E5E5E5"> package that are expected if</font>

486
00:22:10,120 --> 00:22:15,429
you look at<font color="#CCCCCC"> RFC from from the protocol</font>

487
00:22:12,880 --> 00:22:18,490
in look at our package<font color="#E5E5E5"> and then on the</font>

488
00:22:15,430 --> 00:22:19,810
end feel free<font color="#E5E5E5"> D is</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> have my cell</font>

489
00:22:18,490 --> 00:22:22,150
phone<font color="#E5E5E5"> there and you're gonna see our</font>

490
00:22:19,810 --> 00:22:24,669
last version<font color="#E5E5E5"> you can you go to the to</font>

491
00:22:22,150 --> 00:22:27,100
the<font color="#E5E5E5"> table and this is our</font><font color="#CCCCCC"> military-grade</font>

492
00:22:24,670 --> 00:22:28,510
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is an example of of a cell phone</font>

493
00:22:27,100 --> 00:22:31,000
<font color="#CCCCCC">that it has right now on</font><font color="#E5E5E5"> your hand</font>

494
00:22:28,510 --> 00:22:32,890
you<font color="#E5E5E5"> can go imagine drop the implant</font><font color="#CCCCCC"> you</font>

495
00:22:31,000 --> 00:22:34,720
don't you can go there<font color="#E5E5E5"> and check it you</font>

496
00:22:32,890 --> 00:22:37,210
drop the implant and<font color="#CCCCCC"> you go pass by the</font>

497
00:22:34,720 --> 00:22:38,770
office on<font color="#E5E5E5"> the on the street you</font><font color="#CCCCCC"> just you</font>

498
00:22:37,210 --> 00:22:41,440
can interact<font color="#E5E5E5"> with the shell and and</font>

499
00:22:38,770 --> 00:22:43,240
either if exfiltrated or<font color="#CCCCCC"> Rick on</font><font color="#E5E5E5"> the</font>

500
00:22:41,440 --> 00:22:45,190
network<font color="#E5E5E5"> from the outside like in</font>

501
00:22:43,240 --> 00:22:47,170
Starbucks<font color="#E5E5E5"> just on the</font><font color="#CCCCCC"> front of the</font>

502
00:22:45,190 --> 00:22:49,210
<font color="#CCCCCC">building and interact with it the</font>

503
00:22:47,170 --> 00:22:51,220
problem is nobody<font color="#E5E5E5"> is going to detect you</font>

504
00:22:49,210 --> 00:22:54,610
anyway because everything<font color="#CCCCCC"> that is going</font>

505
00:22:51,220 --> 00:22:56,230
<font color="#E5E5E5">out is expected so because they</font><font color="#CCCCCC"> don't</font>

506
00:22:54,610 --> 00:22:58,899
even<font color="#CCCCCC"> know that</font><font color="#E5E5E5"> is the package that are</font>

507
00:22:56,230 --> 00:23:01,840
going<font color="#E5E5E5"> out are being used to accelerate</font>

508
00:22:58,900 --> 00:23:03,850
<font color="#E5E5E5">that at all so my main slide about is</font>

509
00:23:01,840 --> 00:23:05,730
the point of<font color="#E5E5E5"> having</font><font color="#CCCCCC"> these slide is blue</font>

510
00:23:03,850 --> 00:23:09,219
<font color="#E5E5E5">teams right</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> the increase of</font>

511
00:23:05,730 --> 00:23:12,100
complexity is pretty hard<font color="#E5E5E5"> to deal with</font>

512
00:23:09,220 --> 00:23:14,530
<font color="#CCCCCC">because</font><font color="#E5E5E5"> we have more</font><font color="#CCCCCC"> and more data to</font>

513
00:23:12,100 --> 00:23:16,570
<font color="#CCCCCC">look</font><font color="#E5E5E5"> at it even</font><font color="#CCCCCC"> when you use ai</font><font color="#E5E5E5"> ai is</font>

514
00:23:14,530 --> 00:23:19,210
looking for patterns<font color="#CCCCCC"> and the guy that is</font>

515
00:23:16,570 --> 00:23:21,159
<font color="#CCCCCC">supposed to</font><font color="#E5E5E5"> be the the brain of the</font>

516
00:23:19,210 --> 00:23:24,130
operation is looking for stuff<font color="#E5E5E5"> that that</font>

517
00:23:21,160 --> 00:23:26,920
<font color="#E5E5E5">AI can't really recognize and even the</font>

518
00:23:24,130 --> 00:23:31,510
guy that<font color="#CCCCCC"> is looking</font><font color="#E5E5E5"> at events that is</font>

519
00:23:26,920 --> 00:23:34,180
supposed to to to be<font color="#E5E5E5"> detected</font><font color="#CCCCCC"> you can't</font>

520
00:23:31,510 --> 00:23:35,890
see<font color="#E5E5E5"> anything if you see the</font><font color="#CCCCCC"> eye we can</font>

521
00:23:34,180 --> 00:23:38,800
<font color="#CCCCCC">show</font><font color="#E5E5E5"> you the peak up there</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is too</font>

522
00:23:35,890 --> 00:23:40,720
much<font color="#CCCCCC"> in terms of of information on a</font>

523
00:23:38,800 --> 00:23:43,120
<font color="#E5E5E5">peak</font><font color="#CCCCCC"> app for you for for me to show you</font>

524
00:23:40,720 --> 00:23:45,220
but if you show the peak apps and you

525
00:23:43,120 --> 00:23:47,620
can<font color="#E5E5E5"> feel free to download the code and</font>

526
00:23:45,220 --> 00:23:50,290
try<font color="#E5E5E5"> to use it</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> detect it</font>

527
00:23:47,620 --> 00:23:52,360
you can't really see on the peak apps

528
00:23:50,290 --> 00:23:54,430
anything that I showed you<font color="#CCCCCC"> before that</font>

529
00:23:52,360 --> 00:23:56,830
<font color="#E5E5E5">is spiking when you go for every field</font>

530
00:23:54,430 --> 00:23:59,230
every single field and you you<font color="#E5E5E5"> can see a</font>

531
00:23:56,830 --> 00:24:02,470
<font color="#E5E5E5">difference from</font><font color="#CCCCCC"> my from your package and</font>

532
00:23:59,230 --> 00:24:04,070
<font color="#CCCCCC">Jonas package it's equal the</font><font color="#E5E5E5"> difference</font>

533
00:24:02,470 --> 00:24:06,080
is<font color="#E5E5E5"> econ</font>

534
00:24:04,070 --> 00:24:08,600
the data that is<font color="#E5E5E5"> available for your</font>

535
00:24:06,080 --> 00:24:11,149
company and<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't I'm just</font><font color="#E5E5E5"> telling hey</font>

536
00:24:08,600 --> 00:24:13,580
connect to me<font color="#E5E5E5"> hey do you want it do you</font>

537
00:24:11,150 --> 00:24:15,800
<font color="#E5E5E5">want</font><font color="#CCCCCC"> to connect to me so now he's</font><font color="#E5E5E5"> going</font>

538
00:24:13,580 --> 00:24:19,240
<font color="#E5E5E5">to show you our ultimate military-grade</font>

539
00:24:15,800 --> 00:24:28,159
<font color="#E5E5E5">and scratches or</font><font color="#CCCCCC"> anything if you're here</font>

540
00:24:19,240 --> 00:24:30,650
you know I'm here so<font color="#E5E5E5"> after the talk</font>

541
00:24:28,160 --> 00:24:34,090
please feel free I beg you just<font color="#E5E5E5"> go there</font>

542
00:24:30,650 --> 00:24:36,590
and test for<font color="#E5E5E5"> yourself</font><font color="#CCCCCC"> the execution and</font>

543
00:24:34,090 --> 00:24:38,419
try a large command stuff that you see

544
00:24:36,590 --> 00:24:40,970
that<font color="#E5E5E5"> father on the others and if you</font>

545
00:24:38,420 --> 00:24:43,790
feel<font color="#CCCCCC"> that is a weak implementation use</font>

546
00:24:40,970 --> 00:24:45,740
the we're<font color="#CCCCCC"> going to share the code</font><font color="#E5E5E5"> use it</font>

547
00:24:43,790 --> 00:24:47,360
and try<font color="#CCCCCC"> to</font><font color="#E5E5E5"> break it that's that's our</font>

548
00:24:45,740 --> 00:24:49,700
<font color="#CCCCCC">money and this will be public on a</font>

549
00:24:47,360 --> 00:24:50,270
<font color="#E5E5E5">github link that we will share with you</font>

550
00:24:49,700 --> 00:24:53,390
<font color="#CCCCCC">guys</font>

551
00:24:50,270 --> 00:24:54,590
so a pull request<font color="#E5E5E5"> is always welcome if</font>

552
00:24:53,390 --> 00:24:57,320
you<font color="#E5E5E5"> feel like there's something wrong</font>

553
00:24:54,590 --> 00:25:00,980
<font color="#CCCCCC">with it just one thing I forgot and this</font>

554
00:24:57,320 --> 00:25:03,800
is a this<font color="#CCCCCC"> is a this is</font><font color="#E5E5E5"> gonna be the</font><font color="#CCCCCC"> the</font>

555
00:25:00,980 --> 00:25:05,300
name of the tool<font color="#CCCCCC"> so stupidly I forgot to</font>

556
00:25:03,800 --> 00:25:08,000
<font color="#E5E5E5">because we are not that good in market</font>

557
00:25:05,300 --> 00:25:11,110
marketing if you<font color="#CCCCCC"> noticed I mean</font><font color="#E5E5E5"> is not</font>

558
00:25:08,000 --> 00:25:14,450
<font color="#E5E5E5">I'm trying too hard as you can see but</font>

559
00:25:11,110 --> 00:25:16,219
but anything else<font color="#E5E5E5"> just talk to us on the</font>

560
00:25:14,450 --> 00:25:18,920
on the end because<font color="#E5E5E5"> most of the talk is</font>

561
00:25:16,220 --> 00:25:20,870
<font color="#E5E5E5">pretty like it's like you actually seen</font>

562
00:25:18,920 --> 00:25:23,210
it terminal-based

563
00:25:20,870 --> 00:25:25,909
and we invite you<font color="#CCCCCC"> to</font><font color="#E5E5E5"> test it because</font>

564
00:25:23,210 --> 00:25:27,170
<font color="#E5E5E5">it's we feel that everybody is like the</font>

565
00:25:25,910 --> 00:25:29,300
best for<font color="#E5E5E5"> your talent</font>

566
00:25:27,170 --> 00:25:30,680
talking a lot and<font color="#CCCCCC"> just having too much</font>

567
00:25:29,300 --> 00:25:33,290
slides and<font color="#CCCCCC"> information and</font><font color="#E5E5E5"> you never</font>

568
00:25:30,680 --> 00:25:35,540
actually work with it<font color="#CCCCCC"> so you</font><font color="#E5E5E5"> don't you</font>

569
00:25:33,290 --> 00:25:38,210
don't<font color="#E5E5E5"> know that's bullshit analysis so</font>

570
00:25:35,540 --> 00:25:41,360
<font color="#E5E5E5">you need to you need</font><font color="#CCCCCC"> to at least</font><font color="#E5E5E5"> one</font>

571
00:25:38,210 --> 00:25:43,820
time<font color="#E5E5E5"> show people that actually works</font><font color="#CCCCCC"> so</font>

572
00:25:41,360 --> 00:25:47,300
yeah that<font color="#CCCCCC"> is why we have is there okay</font>

573
00:25:43,820 --> 00:25:49,990
<font color="#E5E5E5">so on that note I'd</font><font color="#CCCCCC"> like to jump into</font>

574
00:25:47,300 --> 00:25:52,370
<font color="#E5E5E5">the actual detection code of this this</font>

575
00:25:49,990 --> 00:25:54,710
exfiltration<font color="#E5E5E5"> that we were using before</font>

576
00:25:52,370 --> 00:25:59,149
so not actually the data ones but the

577
00:25:54,710 --> 00:26:03,710
beacon ones<font color="#E5E5E5"> so I actually have in one of</font>

578
00:25:59,150 --> 00:26:07,730
these<font color="#E5E5E5"> machines</font><font color="#CCCCCC"> I have a peak app that's</font>

579
00:26:03,710 --> 00:26:12,170
sure this is still sniffing yeah<font color="#E5E5E5"> okay</font>

580
00:26:07,730 --> 00:26:14,510
so yeah as<font color="#E5E5E5"> you can probably see there's</font>

581
00:26:12,170 --> 00:26:16,980
a peak<font color="#CCCCCC"> app here called level zero pickup</font>

582
00:26:14,510 --> 00:26:21,030
and then I'm<font color="#CCCCCC"> just gonna show</font><font color="#E5E5E5"> you</font>

583
00:26:16,980 --> 00:26:24,290
detect level<font color="#CCCCCC"> 0.5 which</font><font color="#E5E5E5"> is pretty much 13</font>

584
00:26:21,030 --> 00:26:27,180
lines of code<font color="#CCCCCC"> in scape II codes to</font>

585
00:26:24,290 --> 00:26:28,830
detect this kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> acceleration so this</font>

586
00:26:27,180 --> 00:26:36,000
is the output<font color="#E5E5E5"> of the script of the</font>

587
00:26:28,830 --> 00:26:39,120
script<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so it actually</font><font color="#E5E5E5"> found the</font>

588
00:26:36,000 --> 00:26:42,060
server responding to another<font color="#CCCCCC"> LS la or LH</font>

589
00:26:39,120 --> 00:26:44,729
or whatever and then the client sent you

590
00:26:42,060 --> 00:26:48,659
<font color="#CCCCCC">name a</font><font color="#E5E5E5"> and then you found the</font><font color="#CCCCCC"> Linux</font>

591
00:26:44,730 --> 00:26:50,880
version<font color="#E5E5E5"> of what what the implant was so</font>

592
00:26:48,660 --> 00:26:53,850
this was just<font color="#CCCCCC"> as</font><font color="#E5E5E5"> simple as</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's 13</font>

593
00:26:50,880 --> 00:26:56,940
lines of code<font color="#E5E5E5"> to detect</font><font color="#CCCCCC"> we built</font>

594
00:26:53,850 --> 00:26:59,219
something that<font color="#E5E5E5"> was similar to this but</font>

595
00:26:56,940 --> 00:27:02,430
with the assumptions that<font color="#E5E5E5"> we had for</font><font color="#CCCCCC"> our</font>

596
00:26:59,220 --> 00:27:04,680
model<font color="#E5E5E5"> so our model was if you find one</font>

597
00:27:02,430 --> 00:27:08,040
<font color="#CCCCCC">way one directional communications</font>

598
00:27:04,680 --> 00:27:11,850
<font color="#CCCCCC">between</font><font color="#E5E5E5"> an AP and a station and you</font>

599
00:27:08,040 --> 00:27:13,670
don't find the the other way<font color="#E5E5E5"> then you</font>

600
00:27:11,850 --> 00:27:17,520
<font color="#E5E5E5">will add this to our candidates</font>

601
00:27:13,670 --> 00:27:19,770
<font color="#E5E5E5">problematic</font><font color="#CCCCCC"> ap MAC address list if you</font>

602
00:27:17,520 --> 00:27:22,860
do find<font color="#E5E5E5"> it then you will remove the the</font>

603
00:27:19,770 --> 00:27:26,850
MAC<font color="#CCCCCC"> address from the list</font><font color="#E5E5E5"> we I ran that</font>

604
00:27:22,860 --> 00:27:30,919
on<font color="#E5E5E5"> a 1.5 million packets capture file</font>

605
00:27:26,850 --> 00:27:33,300
and pretty much got<font color="#CCCCCC"> 50 false positives</font>

606
00:27:30,920 --> 00:27:34,860
<font color="#CCCCCC">because I did</font><font color="#E5E5E5"> not exit rate anything I</font>

607
00:27:33,300 --> 00:27:38,220
just<font color="#CCCCCC"> ran the</font><font color="#E5E5E5"> tool it should catch</font>

608
00:27:34,860 --> 00:27:40,110
nothing and then I got 50 cases<font color="#E5E5E5"> of</font>

609
00:27:38,220 --> 00:27:42,810
exactly that scenario<font color="#E5E5E5"> I was talking you</font>

610
00:27:40,110 --> 00:27:44,399
<font color="#E5E5E5">to you about so there was an AP there</font>

611
00:27:42,810 --> 00:27:46,919
<font color="#E5E5E5">was a station</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> was too far away and</font>

612
00:27:44,400 --> 00:27:49,110
your detector didn't actually get<font color="#E5E5E5"> to the</font>

613
00:27:46,920 --> 00:27:52,190
<font color="#CCCCCC">point that</font><font color="#E5E5E5"> it saw</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> connection back</font>

614
00:27:49,110 --> 00:27:55,290
from that station<font color="#E5E5E5"> to the neighboring</font><font color="#CCCCCC"> ap</font>

615
00:27:52,190 --> 00:27:58,340
<font color="#E5E5E5">so again you're</font><font color="#CCCCCC"> welcome to start trying</font>

616
00:27:55,290 --> 00:28:03,379
<font color="#E5E5E5">to use the tool</font><font color="#CCCCCC"> I'll just demo it very</font>

617
00:27:58,340 --> 00:28:03,379
simply<font color="#CCCCCC"> over here yes</font>

618
00:28:04,520 --> 00:28:07,619
[Music]

619
00:28:12,710 --> 00:28:15,960
[Music]

620
00:28:22,850 --> 00:28:27,740
<font color="#E5E5E5">okay so at</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> point this is running</font>

621
00:28:25,190 --> 00:28:29,389
the server<font color="#CCCCCC"> it will tell you what driver</font>

622
00:28:27,740 --> 00:28:31,130
you're running because<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you've</font><font color="#E5E5E5"> ever</font>

623
00:28:29,389 --> 00:28:34,519
done anything with<font color="#E5E5E5"> wireless you will</font>

624
00:28:31,130 --> 00:28:36,200
know that<font color="#E5E5E5"> drivers suck</font><font color="#CCCCCC"> so you have to</font>

625
00:28:34,519 --> 00:28:37,970
actually code around whatever<font color="#E5E5E5"> they</font>

626
00:28:36,200 --> 00:28:41,090
decided<font color="#E5E5E5"> was right for their</font>

627
00:28:37,970 --> 00:28:43,100
<font color="#CCCCCC">implementation so what it's</font><font color="#E5E5E5"> doing right</font>

628
00:28:41,090 --> 00:28:44,539
<font color="#CCCCCC">now</font><font color="#E5E5E5"> it's actually channel hopping and</font>

629
00:28:43,100 --> 00:28:47,029
scanning<font color="#E5E5E5"> a little bit of the airwaves</font>

630
00:28:44,539 --> 00:28:50,210
<font color="#E5E5E5">and trying to see</font><font color="#CCCCCC"> what is</font><font color="#E5E5E5"> around it so</font>

631
00:28:47,029 --> 00:28:52,970
it will find something<font color="#CCCCCC"> that it will want</font>

632
00:28:50,210 --> 00:28:55,460
<font color="#CCCCCC">to spoof</font><font color="#E5E5E5"> later after it goes over the</font>

633
00:28:52,970 --> 00:28:56,960
all<font color="#CCCCCC"> of the the channels</font><font color="#E5E5E5"> the client will</font>

634
00:28:55,460 --> 00:28:58,639
do the same the problem is<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

635
00:28:56,960 --> 00:29:00,169
supposed<font color="#CCCCCC"> to be dropped</font><font color="#E5E5E5"> a long time</font>

636
00:28:58,639 --> 00:29:02,178
before<font color="#E5E5E5"> the client</font><font color="#CCCCCC"> actually goes in</font>

637
00:29:00,169 --> 00:29:05,169
<font color="#CCCCCC">exfiltrated data</font><font color="#E5E5E5"> so we have to wait a</font>

638
00:29:02,179 --> 00:29:09,559
<font color="#E5E5E5">little bit for</font><font color="#CCCCCC"> it to actually set up</font>

639
00:29:05,169 --> 00:29:13,570
<font color="#CCCCCC">everything it needs and after it does</font>

640
00:29:09,559 --> 00:29:13,570
<font color="#E5E5E5">this I can just connect to it</font>

641
00:29:24,470 --> 00:29:33,600
<font color="#E5E5E5">okay seems like it's ready so now</font><font color="#CCCCCC"> we try</font>

642
00:29:29,250 --> 00:29:35,820
<font color="#E5E5E5">it on the on the client and it does</font>

643
00:29:33,600 --> 00:29:38,100
pretty<font color="#CCCCCC"> much the same thing and tries to</font>

644
00:29:35,820 --> 00:29:41,460
<font color="#E5E5E5">find something and then it crashes</font><font color="#CCCCCC"> okay</font>

645
00:29:38,100 --> 00:29:44,189
cool<font color="#CCCCCC"> so first first mission</font><font color="#E5E5E5"> accomplished</font>

646
00:29:41,460 --> 00:29:48,680
demo fail<font color="#CCCCCC"> I actually know this</font><font color="#E5E5E5"> bug</font><font color="#CCCCCC"> I</font>

647
00:29:44,190 --> 00:29:48,680
<font color="#E5E5E5">just didn't commit</font><font color="#CCCCCC"> figs which is awesome</font>

648
00:29:50,690 --> 00:29:54,900
don't look at my code my code sucks

649
00:29:52,920 --> 00:29:55,670
<font color="#E5E5E5">please don't look at it don't</font><font color="#CCCCCC"> even look</font>

650
00:29:54,900 --> 00:29:58,380
at<font color="#CCCCCC"> it</font>

651
00:29:55,670 --> 00:30:00,900
yeah it's<font color="#E5E5E5"> that</font><font color="#CCCCCC"> bad</font>

652
00:29:58,380 --> 00:30:04,580
so please PR<font color="#E5E5E5"> you will get a link to PR</font>

653
00:30:00,900 --> 00:30:04,580
you can't complain if you<font color="#E5E5E5"> won't be out</font>

654
00:30:04,940 --> 00:30:20,600
okay<font color="#E5E5E5"> yeah okay okay so here we</font><font color="#CCCCCC"> go again</font>

655
00:30:20,660 --> 00:30:26,769
<font color="#E5E5E5">temp number</font><font color="#CCCCCC"> two</font>

656
00:30:23,680 --> 00:30:26,769
[Music]

657
00:30:30,770 --> 00:30:35,120
so if you have any questions about this

658
00:30:33,420 --> 00:30:40,740
<font color="#E5E5E5">this is your time</font>

659
00:30:35,120 --> 00:30:42,570
<font color="#E5E5E5">yep because I suck at coding I mean I'm</font>

660
00:30:40,740 --> 00:30:45,600
not a coder I'm not a<font color="#E5E5E5"> developer I just</font>

661
00:30:42,570 --> 00:30:49,050
break stuff so<font color="#E5E5E5"> yeah yeah that's it it's</font>

662
00:30:45,600 --> 00:30:50,520
like we expect ya to be expected<font color="#E5E5E5"> you</font>

663
00:30:49,050 --> 00:30:54,060
should I<font color="#CCCCCC"> don't know why you expect me to</font>

664
00:30:50,520 --> 00:30:57,720
be like<font color="#CCCCCC"> a</font><font color="#E5E5E5"> high quality coder but okay in</font>

665
00:30:54,060 --> 00:31:01,980
the future<font color="#CCCCCC"> go Ling yeah perhaps</font><font color="#E5E5E5"> if you</font>

666
00:30:57,720 --> 00:31:03,690
write it I<font color="#CCCCCC"> mean the point</font><font color="#E5E5E5"> is I</font><font color="#CCCCCC"> just</font>

667
00:31:01,980 --> 00:31:06,210
thought this up and<font color="#E5E5E5"> thought yeah maybe</font>

668
00:31:03,690 --> 00:31:07,800
<font color="#E5E5E5">you can track</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> no matter how</font><font color="#CCCCCC"> crappy</font>

669
00:31:06,210 --> 00:31:09,870
the code is and trust<font color="#E5E5E5"> me this is the</font>

670
00:31:07,800 --> 00:31:11,190
good version<font color="#E5E5E5"> of the code I will send you</font>

671
00:31:09,870 --> 00:31:20,370
a link<font color="#CCCCCC"> to make your eyes bleed if you</font>

672
00:31:11,190 --> 00:31:22,860
<font color="#E5E5E5">want yeah it's</font><font color="#CCCCCC"> just words so yeah yeah</font>

673
00:31:20,370 --> 00:31:26,159
<font color="#CCCCCC">if you work with any words</font><font color="#E5E5E5"> no see over</font>

674
00:31:22,860 --> 00:31:28,350
here<font color="#E5E5E5"> for</font><font color="#CCCCCC"> act oh yeah well you're welcome</font>

675
00:31:26,160 --> 00:31:30,270
to<font color="#E5E5E5"> write a</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> implementation because it</font>

676
00:31:28,350 --> 00:31:36,300
would could use some speed<font color="#E5E5E5"> a speed</font>

677
00:31:30,270 --> 00:31:38,040
<font color="#E5E5E5">upgrade so yeah yeah okay so that's the</font>

678
00:31:36,300 --> 00:31:40,290
connection established so now we have a

679
00:31:38,040 --> 00:31:42,480
bit<font color="#CCCCCC"> of a more flexible connection to our</font>

680
00:31:40,290 --> 00:31:47,040
<font color="#CCCCCC">Excel tration server</font><font color="#E5E5E5"> we have</font><font color="#CCCCCC"> no more</font>

681
00:31:42,480 --> 00:31:50,040
problems<font color="#CCCCCC"> with length we have</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> AK</font><font color="#E5E5E5"> that</font>

682
00:31:47,040 --> 00:31:52,110
<font color="#E5E5E5">can actually tell the server that the</font>

683
00:31:50,040 --> 00:31:54,990
client sets the server got the<font color="#E5E5E5"> request</font>

684
00:31:52,110 --> 00:31:56,580
<font color="#E5E5E5">until the the client shall let's the</font>

685
00:31:54,990 --> 00:32:00,180
server know that it<font color="#E5E5E5"> got</font><font color="#CCCCCC"> the response</font>

686
00:31:56,580 --> 00:32:04,530
<font color="#E5E5E5">this is all</font><font color="#CCCCCC"> within the 802 11 framework</font>

687
00:32:00,180 --> 00:32:06,270
so yeah<font color="#E5E5E5"> you will see the the AP again if</font>

688
00:32:04,530 --> 00:32:07,889
you go<font color="#E5E5E5"> back to the slide where you see</font>

689
00:32:06,270 --> 00:32:11,100
the<font color="#CCCCCC"> two neighboring</font><font color="#E5E5E5"> AP is talking to the</font>

690
00:32:07,890 --> 00:32:12,990
stations<font color="#E5E5E5"> that will be the the station</font>

691
00:32:11,100 --> 00:32:16,590
you will assume<font color="#E5E5E5"> that you will see acts</font>

692
00:32:12,990 --> 00:32:18,150
to the<font color="#E5E5E5"> APS right so you will see the AP</font>

693
00:32:16,590 --> 00:32:19,830
is talking to the stations<font color="#CCCCCC"> and then you</font>

694
00:32:18,150 --> 00:32:22,860
will see acts coming<font color="#E5E5E5"> to the APS but you</font>

695
00:32:19,830 --> 00:32:24,780
don't know which ones<font color="#E5E5E5"> no I'm sorry talk</font>

696
00:32:22,860 --> 00:32:26,729
to going to the stations you'll see acts

697
00:32:24,780 --> 00:32:28,620
going<font color="#E5E5E5"> to the stations because that's the</font>

698
00:32:26,730 --> 00:32:31,140
MAC<font color="#CCCCCC"> address the unique MAC address that</font>

699
00:32:28,620 --> 00:32:32,010
will that's derived<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> totp so</font>

700
00:32:31,140 --> 00:32:34,470
that's how they know<font color="#E5E5E5"> that they're</font>

701
00:32:32,010 --> 00:32:37,110
talking<font color="#E5E5E5"> to</font><font color="#CCCCCC"> each other let's</font><font color="#E5E5E5"> try the D</font>

702
00:32:34,470 --> 00:32:38,790
message command again so now as you<font color="#E5E5E5"> can</font>

703
00:32:37,110 --> 00:32:40,439
see<font color="#E5E5E5"> this won't fit</font><font color="#CCCCCC"> in a packet so it</font>

704
00:32:38,790 --> 00:32:42,360
will just be boom boom boom boom<font color="#E5E5E5"> boom</font>

705
00:32:40,440 --> 00:32:44,010
<font color="#E5E5E5">sending in everything you didn't get the</font>

706
00:32:42,360 --> 00:32:46,709
<font color="#E5E5E5">XO album resending like</font>

707
00:32:44,010 --> 00:32:49,140
trying whatever<font color="#CCCCCC"> you can still try to</font>

708
00:32:46,710 --> 00:32:52,740
track<font color="#CCCCCC"> it and you still won't be able to</font>

709
00:32:49,140 --> 00:32:55,980
<font color="#E5E5E5">so if you got</font><font color="#CCCCCC"> any ideas on how to</font><font color="#E5E5E5"> fix</font>

710
00:32:52,740 --> 00:32:57,770
this or how to track this<font color="#E5E5E5"> we're welcome</font>

711
00:32:55,980 --> 00:33:01,950
to hear your thoughts

712
00:32:57,770 --> 00:33:06,180
yes it's slow<font color="#E5E5E5"> but it works yeah it's</font>

713
00:33:01,950 --> 00:33:12,170
<font color="#CCCCCC">Python</font><font color="#E5E5E5"> so but we do have</font><font color="#CCCCCC"> over one</font>

714
00:33:06,180 --> 00:33:12,170
kilobyte<font color="#CCCCCC"> of stupid so not that limited</font>

715
00:33:17,630 --> 00:33:23,130
excuse me

716
00:33:20,330 --> 00:33:23,879
are we on questions right now<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> yeah</font>

717
00:33:23,130 --> 00:33:26,010
sure

718
00:33:23,880 --> 00:33:30,120
after that you<font color="#E5E5E5"> can go</font><font color="#CCCCCC"> to over</font><font color="#E5E5E5"> there and</font>

719
00:33:26,010 --> 00:33:32,370
<font color="#E5E5E5">play with it hello yeah</font><font color="#CCCCCC"> is this</font>

720
00:33:30,120 --> 00:33:34,709
<font color="#CCCCCC">encrypted</font><font color="#E5E5E5"> yes of course you are you're</font>

721
00:33:32,370 --> 00:33:36,479
masquerading as<font color="#CCCCCC"> WPA traffic</font>

722
00:33:34,710 --> 00:33:39,240
you just have to<font color="#E5E5E5"> encrypt how do you</font>

723
00:33:36,480 --> 00:33:41,160
detect whether<font color="#E5E5E5"> it's W you have you</font><font color="#CCCCCC"> are</font>

724
00:33:39,240 --> 00:33:43,020
<font color="#E5E5E5">you sitting the WPA oh yeah sure</font>

725
00:33:41,160 --> 00:33:45,000
<font color="#CCCCCC">definitely I mean</font><font color="#E5E5E5"> that's the we are</font>

726
00:33:43,020 --> 00:33:46,680
<font color="#E5E5E5">looking for a PS which are using</font>

727
00:33:45,000 --> 00:33:49,110
<font color="#E5E5E5">encryption so that we can actually send</font>

728
00:33:46,680 --> 00:33:51,330
random noise and not be suspicious<font color="#E5E5E5"> right</font>

729
00:33:49,110 --> 00:33:53,820
and do you<font color="#E5E5E5"> simulate the WPA handshake</font>

730
00:33:51,330 --> 00:33:56,340
<font color="#E5E5E5">for a connecting stations no because you</font>

731
00:33:53,820 --> 00:33:58,860
<font color="#E5E5E5">don't know</font><font color="#CCCCCC"> that you you may not know or</font>

732
00:33:56,340 --> 00:34:00,780
may<font color="#E5E5E5"> not have seen</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> WPA handshake</font><font color="#CCCCCC"> but</font>

733
00:33:58,860 --> 00:34:03,719
<font color="#E5E5E5">we can totally do</font><font color="#CCCCCC"> that if you want</font><font color="#E5E5E5"> to</font>

734
00:34:00,780 --> 00:34:06,240
but we won't<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able to properly do it</font>

735
00:34:03,720 --> 00:34:08,070
because if you're<font color="#CCCCCC"> on the out of scope AP</font>

736
00:34:06,240 --> 00:34:09,719
then you will have to spoof it somehow

737
00:34:08,070 --> 00:34:11,010
because you don't know the key let's

738
00:34:09,719 --> 00:34:12,870
assume that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> don't know</font><font color="#E5E5E5"> the key of</font>

739
00:34:11,010 --> 00:34:15,090
the AP you're going to spoof so the

740
00:34:12,870 --> 00:34:16,830
handshake will never work right<font color="#E5E5E5"> you know</font>

741
00:34:15,090 --> 00:34:19,110
<font color="#E5E5E5">maybe there you spoof it somehow well if</font>

742
00:34:16,830 --> 00:34:20,790
I see two<font color="#E5E5E5"> two stations talking to each</font>

743
00:34:19,110 --> 00:34:22,800
other<font color="#CCCCCC"> and they're not talking</font><font color="#E5E5E5"> to each</font>

744
00:34:20,790 --> 00:34:24,960
<font color="#E5E5E5">other that's the point you</font><font color="#CCCCCC"> just see to a</font>

745
00:34:22,800 --> 00:34:26,610
piece that<font color="#E5E5E5"> our neighboring</font><font color="#CCCCCC"> ApS that</font><font color="#E5E5E5"> are</font>

746
00:34:24,960 --> 00:34:28,440
talking<font color="#CCCCCC"> to two stations but you don't</font>

747
00:34:26,610 --> 00:34:30,600
see the traffic<font color="#E5E5E5"> back from those stations</font>

748
00:34:28,440 --> 00:34:32,580
right and this<font color="#E5E5E5"> model has been confirmed</font>

749
00:34:30,600 --> 00:34:35,759
<font color="#E5E5E5">because as I told you I ran just</font><font color="#CCCCCC"> to</font>

750
00:34:32,580 --> 00:34:38,250
capture for like six or seven<font color="#CCCCCC"> hours in</font>

751
00:34:35,760 --> 00:34:40,530
my house and it's like<font color="#E5E5E5"> just ground level</font>

752
00:34:38,250 --> 00:34:42,989
<font color="#E5E5E5">and there's a lot of stuff on the street</font>

753
00:34:40,530 --> 00:34:46,200
<font color="#E5E5E5">and offices and all that and I did see</font>

754
00:34:42,989 --> 00:34:48,120
48 or 50 devices that were in<font color="#E5E5E5"> this exact</font>

755
00:34:46,199 --> 00:34:49,290
<font color="#CCCCCC">scenario so you could see the AP talking</font>

756
00:34:48,120 --> 00:34:51,388
to them<font color="#E5E5E5"> but you couldn't see the</font>

757
00:34:49,290 --> 00:34:53,850
conversation back so that's<font color="#E5E5E5"> the model I</font>

758
00:34:51,389 --> 00:34:55,780
<font color="#E5E5E5">was trying to replicate in the packets</font>

759
00:34:53,850 --> 00:34:57,549
are<font color="#E5E5E5"> all the same size</font>

760
00:34:55,780 --> 00:34:59,440
how can they<font color="#CCCCCC"> be if you do LS then it's</font>

761
00:34:57,550 --> 00:35:01,450
just LS if you do

762
00:34:59,440 --> 00:35:03,820
<font color="#CCCCCC">bolero whatever a big command then it</font>

763
00:35:01,450 --> 00:35:06,640
will be a big packet right<font color="#E5E5E5"> so at least</font>

764
00:35:03,820 --> 00:35:09,430
at best it will have like<font color="#E5E5E5"> the size of</font>

765
00:35:06,640 --> 00:35:11,650
the block cipher<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so that's the the</font>

766
00:35:09,430 --> 00:35:13,839
<font color="#CCCCCC">only</font><font color="#E5E5E5"> thing that you can probably use to</font>

767
00:35:11,650 --> 00:35:16,420
track it yeah it matches<font color="#CCCCCC"> the multiple of</font>

768
00:35:13,840 --> 00:35:19,030
whatever the block size is<font color="#E5E5E5"> so perhaps</font>

769
00:35:16,420 --> 00:35:20,890
that's a way but I<font color="#E5E5E5"> would like</font><font color="#CCCCCC"> to see</font>

770
00:35:19,030 --> 00:35:25,890
your false positive rates on the other

771
00:35:20,890 --> 00:35:25,890
kinds of right<font color="#E5E5E5"> so yeah</font>

772
00:35:27,120 --> 00:35:36,940
anyone else<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> isn't</font><font color="#E5E5E5"> it possible to</font>

773
00:35:33,700 --> 00:35:38,200
detect by the<font color="#CCCCCC"> sunna</font><font color="#E5E5E5"> signature I was</font>

774
00:35:36,940 --> 00:35:42,250
<font color="#E5E5E5">hoping for that question</font>

775
00:35:38,200 --> 00:35:45,939
yes it is however<font color="#E5E5E5"> after talking about</font>

776
00:35:42,250 --> 00:35:48,220
<font color="#CCCCCC">this to the creator and firmware writer</font>

777
00:35:45,940 --> 00:35:50,260
for the Wi-Fi pineapple he told me that

778
00:35:48,220 --> 00:35:52,480
there's actually a trick that<font color="#E5E5E5"> you can do</font>

779
00:35:50,260 --> 00:35:54,130
which is<font color="#E5E5E5"> to modulate</font><font color="#CCCCCC"> the power level at</font>

780
00:35:52,480 --> 00:35:56,290
which you<font color="#E5E5E5"> send the packets so</font><font color="#CCCCCC"> that the</font>

781
00:35:54,130 --> 00:36:02,560
<font color="#E5E5E5">receiving end will see a fluctuating our</font>

782
00:35:56,290 --> 00:36:04,930
SSI so now what right that's<font color="#E5E5E5"> my favorite</font>

783
00:36:02,560 --> 00:36:09,400
me told me likes for the other side if

784
00:36:04,930 --> 00:36:12,129
you have like if you have<font color="#E5E5E5"> IPS in the</font>

785
00:36:09,400 --> 00:36:14,230
corner of the area<font color="#CCCCCC"> you can see if</font>

786
00:36:12,130 --> 00:36:16,510
something is inside<font color="#E5E5E5"> that's assuming that</font>

787
00:36:14,230 --> 00:36:18,280
<font color="#E5E5E5">it will spoof always the same</font><font color="#CCCCCC"> AP which</font>

788
00:36:16,510 --> 00:36:19,900
it won't<font color="#E5E5E5"> because every time you</font>

789
00:36:18,280 --> 00:36:23,830
<font color="#CCCCCC">disconnect it will scan again and say oh</font>

790
00:36:19,900 --> 00:36:25,390
now I want<font color="#E5E5E5"> to spook the other one so how</font>

791
00:36:23,830 --> 00:36:30,880
can you<font color="#CCCCCC"> actually be sure that by</font>

792
00:36:25,390 --> 00:36:33,580
detecting neighbor<font color="#E5E5E5"> a SS IDs that</font><font color="#CCCCCC"> are not</font>

793
00:36:30,880 --> 00:36:39,010
the ones<font color="#E5E5E5"> that should be inside</font><font color="#CCCCCC"> that</font>

794
00:36:33,580 --> 00:36:41,319
perimeter for example have Microsoft

795
00:36:39,010 --> 00:36:45,160
Network and you have<font color="#CCCCCC"> ApS in the corners</font>

796
00:36:41,320 --> 00:36:47,530
<font color="#CCCCCC">and if something from without being</font>

797
00:36:45,160 --> 00:36:49,210
Microsoft is transmitting inside the

798
00:36:47,530 --> 00:36:51,430
area<font color="#E5E5E5"> but how do you know that how you</font>

799
00:36:49,210 --> 00:36:54,190
distinguish the not being<font color="#CCCCCC"> microsoft's</font>

800
00:36:51,430 --> 00:36:56,049
transmitting inside the<font color="#E5E5E5"> area because if</font>

801
00:36:54,190 --> 00:36:57,880
you are<font color="#E5E5E5"> fluctuating</font><font color="#CCCCCC"> the power level then</font>

802
00:36:56,050 --> 00:37:01,660
you're getting<font color="#E5E5E5"> the RSSI for something</font>

803
00:36:57,880 --> 00:37:03,670
that's<font color="#CCCCCC"> inside</font><font color="#E5E5E5"> no it's not</font><font color="#CCCCCC"> because if I'm</font>

804
00:37:01,660 --> 00:37:06,850
sending<font color="#E5E5E5"> you at a lower power level then</font>

805
00:37:03,670 --> 00:37:08,820
the power<font color="#E5E5E5"> that won't get partners get</font>

806
00:37:06,850 --> 00:37:10,290
<font color="#E5E5E5">yeah right yeah the corners yeah</font>

807
00:37:08,820 --> 00:37:12,240
a good<font color="#E5E5E5"> point</font><font color="#CCCCCC"> yeah actually I didn't</font>

808
00:37:10,290 --> 00:37:14,460
<font color="#CCCCCC">think of that so good one</font><font color="#E5E5E5"> yeah that's</font><font color="#CCCCCC"> a</font>

809
00:37:12,240 --> 00:37:17,160
nice well I did think<font color="#CCCCCC"> of that the</font>

810
00:37:14,460 --> 00:37:18,870
<font color="#E5E5E5">problem is most of the times the we we</font>

811
00:37:17,160 --> 00:37:21,569
have some scenarios where these don't

812
00:37:18,870 --> 00:37:24,000
work like one of them was being you

813
00:37:21,570 --> 00:37:26,310
don't<font color="#CCCCCC"> need any of</font><font color="#E5E5E5"> this if you wanna</font><font color="#CCCCCC"> you</font>

814
00:37:24,000 --> 00:37:28,140
<font color="#CCCCCC">can have the implant and imagine in a</font>

815
00:37:26,310 --> 00:37:30,900
crazy scenario<font color="#CCCCCC"> silo somewhere in the</font>

816
00:37:28,140 --> 00:37:33,600
desert<font color="#CCCCCC"> and you only have one specific IP</font>

817
00:37:30,900 --> 00:37:34,650
speak speaking<font color="#E5E5E5"> to one one station then</font>

818
00:37:33,600 --> 00:37:37,080
is no noise

819
00:37:34,650 --> 00:37:39,030
it's impossible<font color="#CCCCCC"> for us to yeah that's</font>

820
00:37:37,080 --> 00:37:41,520
<font color="#E5E5E5">the part of</font><font color="#CCCCCC"> the cage yeah we</font><font color="#E5E5E5"> can</font>

821
00:37:39,030 --> 00:37:44,400
limitation<font color="#CCCCCC"> speaking on</font><font color="#E5E5E5"> your example if</font>

822
00:37:41,520 --> 00:37:47,100
we are<font color="#E5E5E5"> tracking the area on the specific</font>

823
00:37:44,400 --> 00:37:48,900
area<font color="#E5E5E5"> I just</font><font color="#CCCCCC"> don't have a</font><font color="#E5E5E5"> way to to</font>

824
00:37:47,100 --> 00:37:51,330
emulate anything because they are they

825
00:37:48,900 --> 00:37:52,770
have a concrete<font color="#CCCCCC"> whitelist</font><font color="#E5E5E5"> that's why I</font>

826
00:37:51,330 --> 00:37:56,100
had<font color="#E5E5E5"> the illogical conditions of what I</font>

827
00:37:52,770 --> 00:37:58,140
am expecting<font color="#CCCCCC"> to see the same there</font><font color="#E5E5E5"> are</font>

828
00:37:56,100 --> 00:38:02,310
some scenarios<font color="#CCCCCC"> where we can create</font><font color="#E5E5E5"> like</font>

829
00:37:58,140 --> 00:38:03,960
applicable solutions for but like in the

830
00:38:02,310 --> 00:38:06,330
<font color="#E5E5E5">future that is one of the improvements</font>

831
00:38:03,960 --> 00:38:08,220
we want to have is<font color="#CCCCCC"> like having this type</font>

832
00:38:06,330 --> 00:38:10,920
of scenario<font color="#CCCCCC"> so we can even immolate it</font>

833
00:38:08,220 --> 00:38:12,450
or or provide<font color="#E5E5E5"> some kind of something</font>

834
00:38:10,920 --> 00:38:13,650
<font color="#CCCCCC">they</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> to work</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> and yeah emulate</font>

835
00:38:12,450 --> 00:38:16,080
and test the problem is actually

836
00:38:13,650 --> 00:38:18,060
<font color="#E5E5E5">creating tests scenarios and actually</font>

837
00:38:16,080 --> 00:38:19,890
test equipment around<font color="#E5E5E5"> all that</font><font color="#CCCCCC"> so yeah</font>

838
00:38:18,060 --> 00:38:22,080
especially the<font color="#CCCCCC"> orner scenario</font><font color="#E5E5E5"> I mean I</font>

839
00:38:19,890 --> 00:38:24,810
don't even know<font color="#E5E5E5"> how I would try</font><font color="#CCCCCC"> to set</font>

840
00:38:22,080 --> 00:38:27,450
up<font color="#CCCCCC"> the</font><font color="#E5E5E5"> detectors and try to go but that</font>

841
00:38:24,810 --> 00:38:30,049
sounds like<font color="#CCCCCC"> fun so yeah yeah</font><font color="#E5E5E5"> well next</font>

842
00:38:27,450 --> 00:38:33,680
<font color="#E5E5E5">year</font><font color="#CCCCCC"> we'll have</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> like that</font><font color="#E5E5E5"> yeah</font>

843
00:38:30,050 --> 00:38:33,680
<font color="#E5E5E5">more questions there</font>

844
00:38:42,930 --> 00:38:51,040
thanks for the presentation<font color="#CCCCCC"> I would like</font>

845
00:38:46,510 --> 00:38:56,680
<font color="#CCCCCC">to know if if it</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> possible to</font><font color="#E5E5E5"> detect</font>

846
00:38:51,040 --> 00:38:57,580
through the<font color="#CCCCCC"> TOTP</font><font color="#E5E5E5"> MAC addresses so if</font>

847
00:38:56,680 --> 00:39:00,700
they are<font color="#E5E5E5"> valid</font>

848
00:38:57,580 --> 00:39:04,029
<font color="#E5E5E5">Oh</font><font color="#CCCCCC"> uy prefix</font><font color="#E5E5E5"> from the nmap prefix list</font>

849
00:39:00,700 --> 00:39:05,859
so I will select randomly<font color="#E5E5E5"> or just</font>

850
00:39:04,030 --> 00:39:07,839
deterministically through the<font color="#CCCCCC"> TOTP</font>

851
00:39:05,859 --> 00:39:09,549
secret I will<font color="#E5E5E5"> use that to pick one of</font>

852
00:39:07,839 --> 00:39:11,380
the vendors<font color="#CCCCCC"> and then use that to pick</font>

853
00:39:09,550 --> 00:39:16,570
one the rest of the termination of<font color="#E5E5E5"> the</font>

854
00:39:11,380 --> 00:39:19,410
<font color="#CCCCCC">man and if you if you guys have the</font>

855
00:39:16,570 --> 00:39:25,060
attacked installed on<font color="#E5E5E5"> that network</font>

856
00:39:19,410 --> 00:39:27,759
<font color="#E5E5E5">through through the time</font><font color="#CCCCCC"> a lot of MAC</font>

857
00:39:25,060 --> 00:39:30,190
addresses will be<font color="#E5E5E5"> detected</font><font color="#CCCCCC"> no because</font>

858
00:39:27,760 --> 00:39:31,839
<font color="#E5E5E5">yeah I've forgot to mention that part if</font>

859
00:39:30,190 --> 00:39:34,450
you<font color="#E5E5E5"> look here you will see a message</font>

860
00:39:31,839 --> 00:39:36,279
saying stopping<font color="#CCCCCC"> TOTP why because the</font>

861
00:39:34,450 --> 00:39:38,080
connection<font color="#E5E5E5"> has been initiated and now it</font>

862
00:39:36,280 --> 00:39:38,440
will stay at<font color="#E5E5E5"> the MAC addresses it was</font>

863
00:39:38,080 --> 00:39:40,810
<font color="#E5E5E5">big</font>

864
00:39:38,440 --> 00:39:42,070
<font color="#E5E5E5">because I did notice that and that's one</font>

865
00:39:40,810 --> 00:39:44,440
of<font color="#E5E5E5"> the things I fixed because</font><font color="#CCCCCC"> it</font>

866
00:39:42,070 --> 00:39:46,420
couldn't<font color="#E5E5E5"> be keeping changing VIPs their</font>

867
00:39:44,440 --> 00:39:49,240
MAC<font color="#CCCCCC"> address is every 30 seconds</font><font color="#E5E5E5"> that</font>

868
00:39:46,420 --> 00:39:50,950
<font color="#E5E5E5">would be a red flag yeah so when it gets</font>

869
00:39:49,240 --> 00:39:52,569
<font color="#E5E5E5">a connection it stops there and then</font>

870
00:39:50,950 --> 00:39:54,368
when I leave<font color="#CCCCCC"> or</font><font color="#E5E5E5"> timeout which just</font>

871
00:39:52,570 --> 00:39:55,750
happened<font color="#E5E5E5"> then it will start</font><font color="#CCCCCC"> again the</font>

872
00:39:54,369 --> 00:39:58,869
process<font color="#CCCCCC"> of scanning what is</font><font color="#E5E5E5"> what's</font>

873
00:39:55,750 --> 00:40:01,900
<font color="#E5E5E5">around it and yeah blah blah blah so you</font>

874
00:39:58,869 --> 00:40:07,420
are witnessing it right now<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> that's</font>

875
00:40:01,900 --> 00:40:13,900
why we keep the program running<font color="#E5E5E5"> your</font>

876
00:40:07,420 --> 00:40:15,700
questions<font color="#CCCCCC"> okay okay go</font><font color="#E5E5E5"> to the to the</font>

877
00:40:13,900 --> 00:40:17,440
station and just try it out on<font color="#CCCCCC"> the</font>

878
00:40:15,700 --> 00:40:20,200
mobile device<font color="#E5E5E5"> because that is the</font>

879
00:40:17,440 --> 00:40:25,930
practical<font color="#E5E5E5"> implementation err</font>

880
00:40:20,200 --> 00:40:25,930
[Applause]

