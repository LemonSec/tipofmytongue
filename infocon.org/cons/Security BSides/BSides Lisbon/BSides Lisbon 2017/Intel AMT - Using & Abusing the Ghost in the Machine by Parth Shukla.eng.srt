1
00:00:06,160 --> 00:00:13,850
thank you<font color="#CCCCCC"> everyone so my name is path I</font>

2
00:00:11,469 --> 00:00:17,509
work<font color="#E5E5E5"> on a bunch of platform security</font>

3
00:00:13,850 --> 00:00:20,480
<font color="#E5E5E5">related</font><font color="#CCCCCC"> issues so my main focus is</font><font color="#E5E5E5"> from</font>

4
00:00:17,510 --> 00:00:22,840
<font color="#E5E5E5">where things have worked on lately is</font>

5
00:00:20,480 --> 00:00:24,920
<font color="#CCCCCC">former integrity verification</font><font color="#E5E5E5"> and</font>

6
00:00:22,840 --> 00:00:26,870
<font color="#CCCCCC">firmware</font><font color="#E5E5E5"> management so the things like</font>

7
00:00:24,920 --> 00:00:29,660
patching science management<font color="#E5E5E5"> bars</font>

8
00:00:26,870 --> 00:00:32,180
passwords etc<font color="#CCCCCC"> today we'll talk about</font>

9
00:00:29,660 --> 00:00:35,690
Intel<font color="#E5E5E5"> MT have to use it and abuse it</font><font color="#CCCCCC"> as</font>

10
00:00:32,180 --> 00:00:37,039
a warning<font color="#E5E5E5"> I'm a Linux user so the</font>

11
00:00:35,690 --> 00:00:42,409
presentation<font color="#E5E5E5"> has a natural leaning</font>

12
00:00:37,039 --> 00:00:43,699
towards it<font color="#CCCCCC"> so here's what I wanted to do</font>

13
00:00:42,409 --> 00:00:46,010
when I<font color="#CCCCCC"> started working</font><font color="#E5E5E5"> this presentation</font>

14
00:00:43,699 --> 00:00:48,079
<font color="#CCCCCC">I wanted</font><font color="#E5E5E5"> to explore the best possible</font>

15
00:00:46,010 --> 00:00:49,519
attack using legitimate<font color="#CCCCCC"> AMT</font>

16
00:00:48,079 --> 00:00:52,159
functionality so I want to<font color="#E5E5E5"> highlight</font>

17
00:00:49,519 --> 00:00:53,780
<font color="#E5E5E5">that legitimate IMT functionality</font><font color="#CCCCCC"> once</font>

18
00:00:52,159 --> 00:00:56,149
<font color="#CCCCCC">I'd explored the attack</font><font color="#E5E5E5"> I wanted to then</font>

19
00:00:53,780 --> 00:00:57,739
<font color="#E5E5E5">present my story of that attempt all the</font>

20
00:00:56,149 --> 00:00:59,870
<font color="#E5E5E5">challenges roadblock encountered during</font>

21
00:00:57,739 --> 00:01:01,459
a practical attempt hopefully showcase

22
00:00:59,870 --> 00:01:04,190
the complexities involved for an

23
00:01:01,460 --> 00:01:06,100
attacker<font color="#CCCCCC"> you can decide how real how</font>

24
00:01:04,190 --> 00:01:08,570
realistic<font color="#CCCCCC"> this is for your scenarios</font>

25
00:01:06,100 --> 00:01:11,539
given the various nuances<font color="#CCCCCC"> they</font><font color="#E5E5E5"> you'll</font>

26
00:01:08,570 --> 00:01:12,919
see<font color="#E5E5E5"> I also wanted to</font><font color="#CCCCCC"> present all the</font>

27
00:01:11,540 --> 00:01:15,290
available<font color="#CCCCCC"> options for people to detect</font>

28
00:01:12,920 --> 00:01:17,150
mitigate or prevent such attacks<font color="#E5E5E5"> and</font>

29
00:01:15,290 --> 00:01:19,340
finally present<font color="#E5E5E5"> a story of how to do</font>

30
00:01:17,150 --> 00:01:20,480
forensics<font color="#CCCCCC"> if an attack does happen so</font>

31
00:01:19,340 --> 00:01:24,500
I've<font color="#E5E5E5"> got a lot of ground to</font><font color="#CCCCCC"> cover</font>

32
00:01:20,480 --> 00:01:26,780
<font color="#E5E5E5">hopefully we'll do it in an hour</font><font color="#CCCCCC"> ok</font>

33
00:01:24,500 --> 00:01:29,210
in this section we'll first start<font color="#CCCCCC"> with</font>

34
00:01:26,780 --> 00:01:31,160
background<font color="#E5E5E5"> what is Intel AMT</font><font color="#CCCCCC"> what are</font>

35
00:01:29,210 --> 00:01:33,710
its core features what are requirements

36
00:01:31,160 --> 00:01:36,619
for<font color="#E5E5E5"> using it how do you provision it</font>

37
00:01:33,710 --> 00:01:38,690
what<font color="#CCCCCC"> is provisioning</font><font color="#E5E5E5"> even mean then</font>

38
00:01:36,620 --> 00:01:40,880
we'll look at quickly<font color="#E5E5E5"> what</font><font color="#CCCCCC"> ami has</font><font color="#E5E5E5"> been</font>

39
00:01:38,690 --> 00:01:42,910
in the news<font color="#CCCCCC"> lately</font><font color="#E5E5E5"> and the open source</font>

40
00:01:40,880 --> 00:01:46,789
tools that are<font color="#CCCCCC"> available for using AMT</font>

41
00:01:42,910 --> 00:01:49,550
so what is<font color="#E5E5E5"> a empty it's designed</font><font color="#CCCCCC"> to be</font>

42
00:01:46,790 --> 00:01:52,190
an always available<font color="#E5E5E5"> solution even when</font>

43
00:01:49,550 --> 00:01:55,820
there is no OS or even when the machine

44
00:01:52,190 --> 00:01:57,800
is<font color="#CCCCCC"> off</font><font color="#E5E5E5"> the requirement is it's available</font>

45
00:01:55,820 --> 00:01:59,089
<font color="#E5E5E5">as</font><font color="#CCCCCC"> long as</font><font color="#E5E5E5"> network and power are</font>

46
00:01:57,800 --> 00:02:01,850
connected so even<font color="#CCCCCC"> though</font><font color="#E5E5E5"> the machines</font>

47
00:01:59,090 --> 00:02:06,350
off<font color="#E5E5E5"> as long as there's power and network</font>

48
00:02:01,850 --> 00:02:09,408
<font color="#E5E5E5">it's supposed to work AMT</font><font color="#CCCCCC"> is implemented</font>

49
00:02:06,350 --> 00:02:11,420
within the<font color="#E5E5E5"> management engine DME DME</font>

50
00:02:09,408 --> 00:02:13,609
runs on the chipset itself which is

51
00:02:11,420 --> 00:02:15,739
separate from main processor<font color="#CCCCCC"> talking</font>

52
00:02:13,610 --> 00:02:19,130
<font color="#E5E5E5">about DME</font><font color="#CCCCCC"> is a presentation in itself</font><font color="#E5E5E5"> so</font>

53
00:02:15,740 --> 00:02:19,640
I won't<font color="#E5E5E5"> go into</font><font color="#CCCCCC"> that too much and since</font>

54
00:02:19,130 --> 00:02:21,410
<font color="#E5E5E5">the</font><font color="#CCCCCC"> a.m.</font>

55
00:02:19,640 --> 00:02:23,540
<font color="#CCCCCC">tea is part of the</font><font color="#E5E5E5"> Emmy which is in the</font>

56
00:02:21,410 --> 00:02:26,270
chipset<font color="#E5E5E5"> it's effectively hard-coded into</font>

57
00:02:23,540 --> 00:02:27,609
<font color="#CCCCCC">hardware hopefully you</font><font color="#E5E5E5"> can see</font><font color="#CCCCCC"> why I</font>

58
00:02:26,270 --> 00:02:30,590
call<font color="#CCCCCC"> it the ghost in</font><font color="#E5E5E5"> the machine</font>

59
00:02:27,610 --> 00:02:32,510
<font color="#CCCCCC">although that title is probably more apt</font>

60
00:02:30,590 --> 00:02:34,760
for<font color="#CCCCCC"> SMM if you've heard</font><font color="#E5E5E5"> of that system</font>

61
00:02:32,510 --> 00:02:36,920
management mode<font color="#CCCCCC"> but that's a different</font>

62
00:02:34,760 --> 00:02:41,179
<font color="#CCCCCC">story anyway let's take</font><font color="#E5E5E5"> a look at the</font>

63
00:02:36,920 --> 00:02:43,549
core features of AMT AMT allows you to

64
00:02:41,180 --> 00:02:46,310
do pretty much everything as if you are

65
00:02:43,550 --> 00:02:49,610
<font color="#CCCCCC">physically present so power management</font>

66
00:02:46,310 --> 00:02:51,230
<font color="#E5E5E5">remote power on/off restart etc you can</font>

67
00:02:49,610 --> 00:02:53,360
boot off a network image<font color="#E5E5E5"> presented as a</font>

68
00:02:51,230 --> 00:02:56,329
cd-rom<font color="#E5E5E5"> or a floppy drive to the system</font>

69
00:02:53,360 --> 00:02:58,850
so<font color="#E5E5E5"> DME which is in the chipset will</font>

70
00:02:56,330 --> 00:03:01,730
present a fully emulated ID cd-rom drive

71
00:02:58,850 --> 00:03:03,370
to the system so the OS doesn't<font color="#E5E5E5"> thinks</font>

72
00:03:01,730 --> 00:03:05,660
<font color="#E5E5E5">it's a physically plugged in CD drive</font>

73
00:03:03,370 --> 00:03:08,420
<font color="#CCCCCC">using the remote floppy we can actually</font>

74
00:03:05,660 --> 00:03:10,450
<font color="#E5E5E5">even exfil data so I did that testing I</font>

75
00:03:08,420 --> 00:03:14,359
mounted a large floppy<font color="#E5E5E5"> which is a gig</font>

76
00:03:10,450 --> 00:03:19,070
<font color="#E5E5E5">1gb of floppy drive you know the</font>

77
00:03:14,360 --> 00:03:20,870
different<font color="#CCCCCC"> different sizes here</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> KVM</font>

78
00:03:19,070 --> 00:03:23,420
so you can observe<font color="#E5E5E5"> or take control</font><font color="#CCCCCC"> over</font>

79
00:03:20,870 --> 00:03:25,459
<font color="#E5E5E5">keyboard video mouse</font><font color="#CCCCCC"> as if you are</font>

80
00:03:23,420 --> 00:03:26,839
<font color="#E5E5E5">physically present again this requires</font>

81
00:03:25,459 --> 00:03:30,260
the<font color="#CCCCCC"> display to be connected</font><font color="#E5E5E5"> to the</font>

82
00:03:26,840 --> 00:03:32,690
integrated GPU<font color="#CCCCCC"> or so</font><font color="#E5E5E5"> which is usually</font>

83
00:03:30,260 --> 00:03:35,570
the<font color="#CCCCCC"> case for laptops desktops depends if</font>

84
00:03:32,690 --> 00:03:36,079
you<font color="#CCCCCC"> have a separate GPU card serial over</font>

85
00:03:35,570 --> 00:03:38,720
<font color="#E5E5E5">LAN</font>

86
00:03:36,079 --> 00:03:42,430
similar to the<font color="#CCCCCC"> CD ROM</font><font color="#E5E5E5"> a serial port</font><font color="#CCCCCC"> is</font>

87
00:03:38,720 --> 00:03:46,340
emulated by DME<font color="#CCCCCC"> this has many use cases</font>

88
00:03:42,430 --> 00:03:48,290
<font color="#E5E5E5">one core usage for managing BIOS so</font>

89
00:03:46,340 --> 00:03:50,690
since most modern<font color="#E5E5E5"> bios's allow</font>

90
00:03:48,290 --> 00:03:53,870
redirecting the screen to serial so you

91
00:03:50,690 --> 00:03:56,150
can reboot<font color="#E5E5E5"> the bars redirected to serial</font>

92
00:03:53,870 --> 00:03:59,360
and then<font color="#CCCCCC"> which for your remote you can</font>

93
00:03:56,150 --> 00:04:01,250
now see the BIOS<font color="#E5E5E5"> and manager</font><font color="#CCCCCC"> one of the</font>

94
00:03:59,360 --> 00:04:05,030
most interesting<font color="#E5E5E5"> features is the client</font>

95
00:04:01,250 --> 00:04:07,820
initiated remote access or Serie 1 use

96
00:04:05,030 --> 00:04:10,670
<font color="#CCCCCC">cases the users off-site can initiate a</font>

97
00:04:07,820 --> 00:04:14,900
remote<font color="#E5E5E5"> help at boot time it will</font><font color="#CCCCCC"> work</font>

98
00:04:10,670 --> 00:04:17,298
with<font color="#E5E5E5"> a broken OS or even with no OS so</font>

99
00:04:14,900 --> 00:04:19,910
the idea is for<font color="#E5E5E5"> AMT to connect to an</font>

100
00:04:17,298 --> 00:04:22,130
admin server when you're off premise and

101
00:04:19,910 --> 00:04:24,260
create a<font color="#E5E5E5"> tunnel for support support</font>

102
00:04:22,130 --> 00:04:25,880
personnel<font color="#E5E5E5"> to come back through so this</font>

103
00:04:24,260 --> 00:04:26,719
<font color="#E5E5E5">way you can bypass the NAT or where it</font>

104
00:04:25,880 --> 00:04:28,669
doesn't<font color="#E5E5E5"> matter</font><font color="#CCCCCC"> where you're</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> world</font>

105
00:04:26,720 --> 00:04:32,000
<font color="#E5E5E5">you connect out to an admin server and</font>

106
00:04:28,669 --> 00:04:33,479
you have a tunnel now see<font color="#CCCCCC"> a tunnel</font><font color="#E5E5E5"> can</font>

107
00:04:32,000 --> 00:04:35,999
also be set<font color="#CCCCCC"> to auto dial</font>

108
00:04:33,479 --> 00:04:38,430
at a<font color="#E5E5E5"> specified times for checking in</font>

109
00:04:35,999 --> 00:04:40,590
centrally so this could be<font color="#E5E5E5"> to check in</font>

110
00:04:38,430 --> 00:04:41,999
<font color="#E5E5E5">for new settings or it could be to make</font>

111
00:04:40,590 --> 00:04:44,698
sure<font color="#E5E5E5"> the laptop has not been marked as</font>

112
00:04:41,999 --> 00:04:45,960
stolen<font color="#CCCCCC"> so you can dial out check</font><font color="#E5E5E5"> with</font>

113
00:04:44,699 --> 00:04:46,919
<font color="#E5E5E5">your admin server is everything okay</font>

114
00:04:45,960 --> 00:04:48,508
everything<font color="#CCCCCC"> is okay okay</font>

115
00:04:46,919 --> 00:04:51,568
people can use<font color="#E5E5E5"> continue to use the</font>

116
00:04:48,509 --> 00:04:55,169
laptop<font color="#E5E5E5"> so</font><font color="#CCCCCC"> fully you've got a</font><font color="#E5E5E5"> good idea</font>

117
00:04:51,569 --> 00:04:56,849
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the core AMT capabilities next to</font>

118
00:04:55,169 --> 00:05:00,870
other requirements<font color="#E5E5E5"> for having it on your</font>

119
00:04:56,849 --> 00:05:03,498
<font color="#CCCCCC">laptop or</font><font color="#E5E5E5"> desktop so there are three</font>

120
00:05:00,870 --> 00:05:07,080
<font color="#E5E5E5">steps for being able to use AMT remotely</font>

121
00:05:03,499 --> 00:05:09,210
first is<font color="#E5E5E5"> manufacture decision second is</font>

122
00:05:07,080 --> 00:05:11,609
<font color="#E5E5E5">power setting basically in an on and off</font>

123
00:05:09,210 --> 00:05:14,279
<font color="#E5E5E5">setting in the</font><font color="#CCCCCC"> BIOS</font><font color="#E5E5E5"> menu and the last is</font>

124
00:05:11,610 --> 00:05:16,469
AMT setup itself so because of

125
00:05:14,279 --> 00:05:19,979
manufacturer decision AMT is not present

126
00:05:16,469 --> 00:05:22,349
in<font color="#E5E5E5"> most consumer devices so from my</font>

127
00:05:19,979 --> 00:05:25,318
understanding<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ME module in the AMT</font>

128
00:05:22,349 --> 00:05:26,938
module cost<font color="#E5E5E5"> extra for manufacturers in</font>

129
00:05:25,319 --> 00:05:29,490
<font color="#E5E5E5">licensing</font><font color="#CCCCCC"> fees that are include them in</font>

130
00:05:26,939 --> 00:05:31,349
consumer devices<font color="#E5E5E5"> but most business</font>

131
00:05:29,490 --> 00:05:34,710
desktops or laptops usually come with

132
00:05:31,349 --> 00:05:37,979
AMT as an add-on<font color="#E5E5E5"> and it's usually</font>

133
00:05:34,710 --> 00:05:39,870
enabled in the BIOS by default<font color="#E5E5E5"> some of</font>

134
00:05:37,979 --> 00:05:43,669
the more beefy aspect consumer devices

135
00:05:39,870 --> 00:05:45,810
<font color="#E5E5E5">also come with AMT as an add-on feature</font>

136
00:05:43,669 --> 00:05:47,339
<font color="#CCCCCC">just</font><font color="#E5E5E5"> because it's enabled in the</font><font color="#CCCCCC"> BIOS</font>

137
00:05:45,810 --> 00:05:49,229
doesn't mean it's<font color="#E5E5E5"> usable it has to be</font>

138
00:05:47,339 --> 00:05:52,199
<font color="#E5E5E5">provisioned for</font><font color="#CCCCCC"> it to be usable</font>

139
00:05:49,229 --> 00:05:54,330
what is provisioned mean here<font color="#E5E5E5"> it means</font>

140
00:05:52,199 --> 00:05:57,270
to activate any<font color="#CCCCCC"> of the AMT interfaces</font>

141
00:05:54,330 --> 00:05:59,279
for usage to do that you need<font color="#E5E5E5"> to do a</font>

142
00:05:57,270 --> 00:06:02,128
bunch of bare minimum settings that must

143
00:05:59,279 --> 00:06:04,580
be<font color="#E5E5E5"> set and the</font><font color="#CCCCCC"> process</font><font color="#E5E5E5"> of doing setting</font>

144
00:06:02,129 --> 00:06:07,289
those settings is called provisioning

145
00:06:04,580 --> 00:06:09,930
and what those settings are depends on

146
00:06:07,289 --> 00:06:11,810
how you provision it the<font color="#E5E5E5"> method which</font>

147
00:06:09,930 --> 00:06:14,520
we'll talk about<font color="#E5E5E5"> next</font>

148
00:06:11,810 --> 00:06:16,259
<font color="#CCCCCC">so let's</font><font color="#E5E5E5"> took it let's take a look at</font>

149
00:06:14,520 --> 00:06:20,099
the provisioning options the methods you

150
00:06:16,259 --> 00:06:22,860
can use to provision<font color="#E5E5E5"> an AMT so generally</font>

151
00:06:20,099 --> 00:06:26,069
speaking<font color="#CCCCCC"> there are four broad</font><font color="#E5E5E5"> ways you</font>

152
00:06:22,860 --> 00:06:27,899
can provision AMT for usage and there

153
00:06:26,069 --> 00:06:30,659
are two provisioning modes once the

154
00:06:27,899 --> 00:06:33,959
provisioning is done the provisioning

155
00:06:30,659 --> 00:06:36,330
mode a cm or CCM is meant to<font color="#CCCCCC"> reflect</font><font color="#E5E5E5"> the</font>

156
00:06:33,959 --> 00:06:38,310
level<font color="#E5E5E5"> of trust required to complete the</font>

157
00:06:36,330 --> 00:06:43,589
setup process<font color="#CCCCCC"> a cm admin control mode</font>

158
00:06:38,310 --> 00:06:45,810
CCM client control<font color="#E5E5E5"> mode note that all of</font>

159
00:06:43,589 --> 00:06:46,920
<font color="#E5E5E5">these kind of indem intermingle and can</font>

160
00:06:45,810 --> 00:06:48,720
be used in combination

161
00:06:46,920 --> 00:06:51,200
with each other so try<font color="#CCCCCC"> not to think of</font>

162
00:06:48,720 --> 00:06:54,240
them<font color="#CCCCCC"> as distinct options these</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> just</font>

163
00:06:51,200 --> 00:06:56,090
as I'll mention<font color="#E5E5E5"> in a second so local</font>

164
00:06:54,240 --> 00:06:58,590
agent<font color="#CCCCCC"> dunno s for</font><font color="#E5E5E5"> example first one</font>

165
00:06:56,090 --> 00:07:00,450
requires<font color="#CCCCCC"> Intel AMT software to be</font>

166
00:06:58,590 --> 00:07:04,560
installed and running<font color="#CCCCCC"> as root or admin</font>

167
00:07:00,450 --> 00:07:06,270
on the<font color="#E5E5E5"> box</font><font color="#CCCCCC"> you can do this via our own</font>

168
00:07:04,560 --> 00:07:08,220
custom tool as well in<font color="#CCCCCC"> that case you</font>

169
00:07:06,270 --> 00:07:10,229
<font color="#CCCCCC">obviously need admin privileges</font><font color="#E5E5E5"> and you</font>

170
00:07:08,220 --> 00:07:12,600
<font color="#CCCCCC">talked</font><font color="#E5E5E5"> to the Intel ME interface to be</font>

171
00:07:10,230 --> 00:07:15,120
able<font color="#E5E5E5"> to provision AMT this method will</font>

172
00:07:12,600 --> 00:07:16,320
put you in client<font color="#E5E5E5"> control mode which</font>

173
00:07:15,120 --> 00:07:18,090
<font color="#E5E5E5">will give you limited</font><font color="#CCCCCC"> AMD</font>

174
00:07:16,320 --> 00:07:19,500
functionalities you<font color="#CCCCCC"> can carry out</font>

175
00:07:18,090 --> 00:07:22,020
additional<font color="#E5E5E5"> steps to transition into</font>

176
00:07:19,500 --> 00:07:24,810
admin control mode but<font color="#E5E5E5"> that that's a bit</font>

177
00:07:22,020 --> 00:07:27,270
more<font color="#CCCCCC"> involved</font><font color="#E5E5E5"> but doable the second</font>

178
00:07:24,810 --> 00:07:31,200
<font color="#E5E5E5">option the remote</font><font color="#CCCCCC"> option requires pre</font>

179
00:07:27,270 --> 00:07:33,740
<font color="#CCCCCC">setup</font><font color="#E5E5E5"> at factory or</font><font color="#CCCCCC"> Y a USB to be</font>

180
00:07:31,200 --> 00:07:38,700
<font color="#E5E5E5">enabled so in that case what happens</font><font color="#CCCCCC"> is</font>

181
00:07:33,740 --> 00:07:41,700
AMT will send hello packets on<font color="#E5E5E5"> AMT LAN</font>

182
00:07:38,700 --> 00:07:43,740
are for up to<font color="#CCCCCC"> six hours after first boot</font>

183
00:07:41,700 --> 00:07:45,330
<font color="#E5E5E5">the very first time a machine is turned</font>

184
00:07:43,740 --> 00:07:50,460
on<font color="#E5E5E5"> for up to six hours it'll send</font><font color="#CCCCCC"> hallo</font>

185
00:07:45,330 --> 00:07:52,590
packets then<font color="#E5E5E5"> it'll turn</font><font color="#CCCCCC"> off that time</font>

186
00:07:50,460 --> 00:07:54,840
period<font color="#E5E5E5"> is configurable just up to 24</font>

187
00:07:52,590 --> 00:07:58,650
hours usually<font color="#CCCCCC"> so it's not a big security</font>

188
00:07:54,840 --> 00:08:00,750
<font color="#E5E5E5">flaw the responding server that responds</font>

189
00:07:58,650 --> 00:08:03,870
to the hello certificates must<font color="#E5E5E5"> present a</font>

190
00:08:00,750 --> 00:08:06,180
certificate<font color="#E5E5E5"> that's pre trusted by AMT</font>

191
00:08:03,870 --> 00:08:07,770
<font color="#E5E5E5">and</font><font color="#CCCCCC"> the trust certificate is</font>

192
00:08:06,180 --> 00:08:11,670
configurable as well again<font color="#CCCCCC"> either a</font>

193
00:08:07,770 --> 00:08:14,490
factory or<font color="#E5E5E5"> with a</font><font color="#CCCCCC"> USB key</font><font color="#E5E5E5"> third option</font>

194
00:08:11,670 --> 00:08:17,820
is USB<font color="#CCCCCC"> in that case you put a</font><font color="#E5E5E5"> set up got</font>

195
00:08:14,490 --> 00:08:19,440
bin file on a fat32 USB and configure

196
00:08:17,820 --> 00:08:24,510
<font color="#CCCCCC">AMT with it and this includes you can</font>

197
00:08:19,440 --> 00:08:26,790
configure the certificates<font color="#CCCCCC"> are trusted</font>

198
00:08:24,510 --> 00:08:28,740
as well so again<font color="#E5E5E5"> like I said that things</font>

199
00:08:26,790 --> 00:08:31,740
<font color="#E5E5E5">come in to mingle</font><font color="#CCCCCC"> you can use them with</font>

200
00:08:28,740 --> 00:08:34,919
each other and finally provision can<font color="#E5E5E5"> be</font>

201
00:08:31,740 --> 00:08:38,010
done physically why the<font color="#E5E5E5"> BIOS menu</font><font color="#CCCCCC"> this</font>

202
00:08:34,919 --> 00:08:39,179
<font color="#E5E5E5">is</font><font color="#CCCCCC"> ten easy-to-follow steps that beacon</font>

203
00:08:38,010 --> 00:08:43,919
that can be carried out<font color="#E5E5E5"> in about</font><font color="#CCCCCC"> 30</font>

204
00:08:39,179 --> 00:08:46,020
seconds<font color="#CCCCCC"> note that these</font><font color="#E5E5E5"> methods can</font><font color="#CCCCCC"> be</font>

205
00:08:43,919 --> 00:08:48,390
<font color="#CCCCCC">used to set further options even after</font>

206
00:08:46,020 --> 00:08:49,829
provisioning is technically complete the

207
00:08:48,390 --> 00:08:53,400
line between provisioning<font color="#E5E5E5"> versus</font>

208
00:08:49,830 --> 00:08:54,360
configuration is a little blurry<font color="#CCCCCC"> to be</font>

209
00:08:53,400 --> 00:08:56,250
exact

210
00:08:54,360 --> 00:08:59,250
provisioning can be considered completed

211
00:08:56,250 --> 00:09:00,910
<font color="#E5E5E5">as soon</font><font color="#CCCCCC"> as AMT exposes any of its two</font>

212
00:08:59,250 --> 00:09:02,800
<font color="#CCCCCC">interfaces for you socially</font>

213
00:09:00,910 --> 00:09:05,709
he has two interfaces<font color="#CCCCCC"> local and remote</font>

214
00:09:02,800 --> 00:09:07,329
and this<font color="#E5E5E5"> usually happens as soon</font><font color="#CCCCCC"> as you</font>

215
00:09:05,710 --> 00:09:09,430
<font color="#E5E5E5">change the default</font><font color="#CCCCCC"> password so empty has</font>

216
00:09:07,330 --> 00:09:13,530
<font color="#CCCCCC">a default</font><font color="#E5E5E5"> password is admin as soon as</font>

217
00:09:09,430 --> 00:09:19,750
you change<font color="#CCCCCC"> it empties mostly provisioned</font>

218
00:09:13,530 --> 00:09:22,150
<font color="#E5E5E5">it starts listening for API calls once</font>

219
00:09:19,750 --> 00:09:24,040
provisioning is complete<font color="#CCCCCC"> you can access</font>

220
00:09:22,150 --> 00:09:27,760
the full set of options and features<font color="#CCCCCC"> why</font>

221
00:09:24,040 --> 00:09:29,469
why are the AMT api's<font color="#CCCCCC"> but you can</font><font color="#E5E5E5"> still</font>

222
00:09:27,760 --> 00:09:31,900
<font color="#E5E5E5">use one of</font><font color="#CCCCCC"> these options to set some</font>

223
00:09:29,470 --> 00:09:34,300
other settings<font color="#E5E5E5"> it's a bit weird the way</font>

224
00:09:31,900 --> 00:09:38,740
it works anyway<font color="#E5E5E5"> that's enough on</font>

225
00:09:34,300 --> 00:09:39,910
provisioning<font color="#CCCCCC"> AMT in the news maybe some</font>

226
00:09:38,740 --> 00:09:42,940
<font color="#E5E5E5">of you have already heard of this a</font>

227
00:09:39,910 --> 00:09:45,969
couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> quick mentions first we have</font>

228
00:09:42,940 --> 00:09:49,480
the<font color="#E5E5E5"> Intel</font><font color="#CCCCCC"> sa</font><font color="#E5E5E5"> 75 escalation of privilege</font>

229
00:09:45,970 --> 00:09:51,610
vulnerability<font color="#CCCCCC"> in short this is May I</font>

230
00:09:49,480 --> 00:09:54,640
<font color="#E5E5E5">think</font><font color="#CCCCCC"> this one</font><font color="#E5E5E5"> made this year</font><font color="#CCCCCC"> in sure it</font>

231
00:09:51,610 --> 00:09:57,850
was<font color="#E5E5E5"> or maybe it was earlier in Charlie</font>

232
00:09:54,640 --> 00:10:00,610
was HTTP digest oaths for AMT could be

233
00:09:57,850 --> 00:10:02,590
bypassed<font color="#E5E5E5"> with a null or empty response</font>

234
00:10:00,610 --> 00:10:08,050
so<font color="#E5E5E5"> you just say I don't</font><font color="#CCCCCC"> have a password</font>

235
00:10:02,590 --> 00:10:10,960
<font color="#E5E5E5">for you and it goes</font><font color="#CCCCCC"> okay you're</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> MT in</font>

236
00:10:08,050 --> 00:10:12,490
in<font color="#CCCCCC"> that</font><font color="#E5E5E5"> in that case for</font><font color="#CCCCCC"> an to exploit</font>

237
00:10:10,960 --> 00:10:15,250
<font color="#CCCCCC">that obviously AMT needs to be</font>

238
00:10:12,490 --> 00:10:16,540
provisioned<font color="#CCCCCC"> and an attacker</font><font color="#E5E5E5"> needs to be</font>

239
00:10:15,250 --> 00:10:18,280
on the same network to be<font color="#E5E5E5"> able to</font>

240
00:10:16,540 --> 00:10:20,709
<font color="#CCCCCC">exploit</font><font color="#E5E5E5"> it so it's kind of</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> to</font>

241
00:10:18,280 --> 00:10:23,199
mitigating factors there<font color="#CCCCCC"> a patch is</font>

242
00:10:20,710 --> 00:10:25,810
available so if you<font color="#CCCCCC"> haven't</font><font color="#E5E5E5"> passed you</font>

243
00:10:23,200 --> 00:10:28,180
may want<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that but if you don't if</font>

244
00:10:25,810 --> 00:10:30,910
you<font color="#CCCCCC"> don't have a computer if you don't</font>

245
00:10:28,180 --> 00:10:32,560
have a lab or<font color="#E5E5E5"> or you at work you don't</font>

246
00:10:30,910 --> 00:10:34,569
have<font color="#E5E5E5"> everything that's actually</font>

247
00:10:32,560 --> 00:10:37,449
<font color="#E5E5E5">provisioning AMT then it may not</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> so</font>

248
00:10:34,570 --> 00:10:40,000
<font color="#CCCCCC">bad for you second thing is</font><font color="#E5E5E5"> the Platinum</font>

249
00:10:37,450 --> 00:10:42,580
there<font color="#CCCCCC"> is a malware developed by the</font>

250
00:10:40,000 --> 00:10:45,400
platinum group<font color="#E5E5E5"> was you seen hiding</font>

251
00:10:42,580 --> 00:10:47,320
communication from OS by using the

252
00:10:45,400 --> 00:10:49,180
serial over<font color="#E5E5E5"> land that I mentioned</font>

253
00:10:47,320 --> 00:10:54,370
earlier<font color="#E5E5E5"> so we're using serial the land</font>

254
00:10:49,180 --> 00:10:56,050
<font color="#CCCCCC">to in</font><font color="#E5E5E5"> order</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> bypass local monitoring</font>

255
00:10:54,370 --> 00:10:57,880
on the<font color="#E5E5E5"> OS so if a lot of times you have</font>

256
00:10:56,050 --> 00:10:59,380
OS level monitoring<font color="#E5E5E5"> for network packets</font>

257
00:10:57,880 --> 00:11:05,290
and they were using serial<font color="#E5E5E5"> over land via</font>

258
00:10:59,380 --> 00:11:09,790
<font color="#E5E5E5">AMT so that it couldn't be seen nice</font>

259
00:11:05,290 --> 00:11:11,920
sweating exfiltrate data<font color="#CCCCCC"> now</font><font color="#E5E5E5"> is there</font>

260
00:11:09,790 --> 00:11:13,810
more<font color="#E5E5E5"> to come</font><font color="#CCCCCC"> here in this space I</font><font color="#E5E5E5"> think</font>

261
00:11:11,920 --> 00:11:14,650
there is so there is an Emmy talk

262
00:11:13,810 --> 00:11:17,819
<font color="#CCCCCC">schedule</font>

263
00:11:14,650 --> 00:11:24,670
cat<font color="#CCCCCC"> London probably in a month</font><font color="#E5E5E5"> or so and</font>

264
00:11:17,820 --> 00:11:26,170
it's it<font color="#E5E5E5"> sounds promising</font><font color="#CCCCCC"> finally in this</font>

265
00:11:24,670 --> 00:11:28,780
<font color="#E5E5E5">section for the background section</font>

266
00:11:26,170 --> 00:11:30,790
here's quick notes on the tools that<font color="#E5E5E5"> are</font>

267
00:11:28,780 --> 00:11:34,089
<font color="#E5E5E5">available</font><font color="#CCCCCC"> everything is actually</font><font color="#E5E5E5"> in one</font>

268
00:11:30,790 --> 00:11:37,230
convenient central place<font color="#CCCCCC"> I used both of</font>

269
00:11:34,090 --> 00:11:40,560
these as well as the older mesh central

270
00:11:37,230 --> 00:11:43,600
<font color="#E5E5E5">for my attack</font><font color="#CCCCCC"> in the next next slides</font>

271
00:11:40,560 --> 00:11:48,910
<font color="#E5E5E5">it's all open</font><font color="#CCCCCC"> source it's actually</font>

272
00:11:43,600 --> 00:11:54,880
<font color="#E5E5E5">mostly developed</font><font color="#CCCCCC"> by Intel employees yeah</font>

273
00:11:48,910 --> 00:11:56,890
that's it<font color="#CCCCCC"> okay so let's go back to</font>

274
00:11:54,880 --> 00:12:00,100
<font color="#CCCCCC">looking for</font><font color="#E5E5E5"> the best practical attack</font>

275
00:11:56,890 --> 00:12:04,060
using Intel AMT now we know a<font color="#E5E5E5"> little</font><font color="#CCCCCC"> bit</font>

276
00:12:00,100 --> 00:12:05,770
<font color="#E5E5E5">about AMT itself so when I started</font>

277
00:12:04,060 --> 00:12:08,619
sexercise this is what I wanted<font color="#E5E5E5"> to</font>

278
00:12:05,770 --> 00:12:10,350
achieve<font color="#CCCCCC"> obviously when I started I</font>

279
00:12:08,620 --> 00:12:13,890
didn't<font color="#CCCCCC"> know if this was really possible</font>

280
00:12:10,350 --> 00:12:16,390
<font color="#CCCCCC">it seemed likely from</font><font color="#E5E5E5"> the documentation</font>

281
00:12:13,890 --> 00:12:19,480
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> why I start exploring the idea so</font>

282
00:12:16,390 --> 00:12:22,120
my goal was to a<font color="#E5E5E5"> control AMT be</font>

283
00:12:19,480 --> 00:12:28,570
maintained persistent access and see you

284
00:12:22,120 --> 00:12:30,790
<font color="#E5E5E5">remain stealthy in</font><font color="#CCCCCC"> the process so before</font>

285
00:12:28,570 --> 00:12:33,610
we<font color="#E5E5E5"> proceed to try achieved those goals</font>

286
00:12:30,790 --> 00:12:35,890
<font color="#CCCCCC">let's just one quick slide on what we</font>

287
00:12:33,610 --> 00:12:38,140
can do afterwards assume we've achieved

288
00:12:35,890 --> 00:12:40,689
that<font color="#E5E5E5"> what can we do next</font>

289
00:12:38,140 --> 00:12:44,230
so just so you can see an end to<font color="#E5E5E5"> end</font>

290
00:12:40,690 --> 00:12:46,660
goal here<font color="#CCCCCC"> I didn't actually</font><font color="#E5E5E5"> carry any</font><font color="#CCCCCC"> of</font>

291
00:12:44,230 --> 00:12:48,580
these out but since<font color="#E5E5E5"> there's</font><font color="#CCCCCC"> nothing</font>

292
00:12:46,660 --> 00:12:53,439
specific<font color="#CCCCCC"> to AMT this is not specific to</font>

293
00:12:48,580 --> 00:12:54,250
<font color="#CCCCCC">MT is just general exercise</font><font color="#E5E5E5"> so if you're</font>

294
00:12:53,440 --> 00:12:57,520
a standard<font color="#E5E5E5"> tracker</font>

295
00:12:54,250 --> 00:12:59,770
once you have<font color="#CCCCCC"> AMT control</font><font color="#E5E5E5"> you can use</font><font color="#CCCCCC"> it</font>

296
00:12:57,520 --> 00:13:03,010
to restart<font color="#E5E5E5"> the</font><font color="#CCCCCC"> machine boot your own</font>

297
00:12:59,770 --> 00:13:04,150
<font color="#CCCCCC">disk</font><font color="#E5E5E5"> then replace if the</font><font color="#CCCCCC"> disc is</font>

298
00:13:03,010 --> 00:13:06,730
<font color="#E5E5E5">encrypted then you can replace the</font>

299
00:13:04,150 --> 00:13:09,340
unencrypted<font color="#E5E5E5"> boot parts to</font><font color="#CCCCCC"> hijack</font><font color="#E5E5E5"> disk</font>

300
00:13:06,730 --> 00:13:11,800
encryption password<font color="#E5E5E5"> come back a few days</font>

301
00:13:09,340 --> 00:13:13,900
<font color="#CCCCCC">later use the encryption password to</font>

302
00:13:11,800 --> 00:13:15,310
replace binaries on disk<font color="#E5E5E5"> and get the</font>

303
00:13:13,900 --> 00:13:18,730
machine<font color="#CCCCCC"> to connect</font><font color="#E5E5E5"> back to your C and</font><font color="#CCCCCC"> C</font>

304
00:13:15,310 --> 00:13:20,469
<font color="#CCCCCC">you basically have route now anyone with</font>

305
00:13:18,730 --> 00:13:24,580
<font color="#E5E5E5">repeated physical access to</font><font color="#CCCCCC"> your machine</font>

306
00:13:20,470 --> 00:13:26,200
<font color="#E5E5E5">today can do this with the difference</font>

307
00:13:24,580 --> 00:13:28,240
with<font color="#CCCCCC"> am T's</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can do it with</font>

308
00:13:26,200 --> 00:13:31,899
potentially just<font color="#E5E5E5"> one-off physical acts</font>

309
00:13:28,240 --> 00:13:33,550
us the reason I put<font color="#E5E5E5"> down easy to harden</font>

310
00:13:31,899 --> 00:13:36,220
in<font color="#CCCCCC"> the difficulties because the success</font>

311
00:13:33,550 --> 00:13:38,219
here depends on<font color="#CCCCCC"> a few factors such as if</font>

312
00:13:36,220 --> 00:13:42,310
you have<font color="#E5E5E5"> secure boot</font><font color="#CCCCCC"> and/or trusted boot</font>

313
00:13:38,220 --> 00:13:43,899
<font color="#CCCCCC">being used even if some or all of those</font>

314
00:13:42,310 --> 00:13:46,149
are<font color="#E5E5E5"> being used to how the BIOS is</font>

315
00:13:43,899 --> 00:13:47,320
<font color="#CCCCCC">protected also</font><font color="#E5E5E5"> contributes we'll touch</font>

316
00:13:46,149 --> 00:13:51,940
on it again<font color="#E5E5E5"> when we talk about</font>

317
00:13:47,320 --> 00:13:54,339
<font color="#E5E5E5">mitigations later on as a sophisticated</font>

318
00:13:51,940 --> 00:13:56,380
<font color="#CCCCCC">tracker you can use AMT to restart</font>

319
00:13:54,339 --> 00:13:58,810
machine to<font color="#E5E5E5"> your own boot disk again but</font>

320
00:13:56,380 --> 00:14:00,850
at this time<font color="#E5E5E5"> you can insert a system</font>

321
00:13:58,810 --> 00:14:03,880
management<font color="#CCCCCC"> more mode</font><font color="#E5E5E5"> backdoor into the</font>

322
00:14:00,850 --> 00:14:05,649
flash<font color="#E5E5E5"> chip itself</font><font color="#CCCCCC"> since we have root</font><font color="#E5E5E5"> in</font>

323
00:14:03,880 --> 00:14:08,589
the<font color="#CCCCCC"> Box</font><font color="#E5E5E5"> we can we can talk to the flash</font>

324
00:14:05,649 --> 00:14:10,320
<font color="#CCCCCC">trip this is not as universal as it</font><font color="#E5E5E5"> as</font>

325
00:14:08,589 --> 00:14:12,820
the previous<font color="#CCCCCC"> attack standard attack</font>

326
00:14:10,320 --> 00:14:16,240
<font color="#CCCCCC">because</font><font color="#E5E5E5"> most machines severely</font><font color="#CCCCCC"> lock down</font>

327
00:14:12,820 --> 00:14:19,089
<font color="#CCCCCC">writing to the bias region</font><font color="#E5E5E5"> so that</font>

328
00:14:16,240 --> 00:14:23,110
usually complicates your<font color="#E5E5E5"> life now</font>

329
00:14:19,089 --> 00:14:25,000
did I miss a scenario<font color="#E5E5E5"> here what would</font>

330
00:14:23,110 --> 00:14:26,260
you do if you had a<font color="#E5E5E5"> empty control</font><font color="#CCCCCC"> 'once</font>

331
00:14:25,000 --> 00:14:29,730
<font color="#E5E5E5">on this machine so you can tell me</font><font color="#CCCCCC"> right</font>

332
00:14:26,260 --> 00:14:34,209
at the end<font color="#CCCCCC"> question time</font>

333
00:14:29,730 --> 00:14:37,060
<font color="#E5E5E5">all right so let's explore our first</font><font color="#CCCCCC"> aim</font>

334
00:14:34,209 --> 00:14:39,099
of<font color="#CCCCCC"> getting</font><font color="#E5E5E5"> AMT control what are our</font>

335
00:14:37,060 --> 00:14:44,439
<font color="#E5E5E5">options for provisioning AMT on a target</font>

336
00:14:39,100 --> 00:14:47,920
machine so<font color="#E5E5E5"> option a we can subvert the</font>

337
00:14:44,440 --> 00:14:49,540
supply chain the complexity is high you

338
00:14:47,920 --> 00:14:53,529
can say this<font color="#E5E5E5"> is medium depends on how</font>

339
00:14:49,540 --> 00:14:55,420
you define<font color="#E5E5E5"> it likely attacker is highly</font>

340
00:14:53,529 --> 00:14:57,910
resourced attacker<font color="#E5E5E5"> casting a wide net or</font>

341
00:14:55,420 --> 00:14:59,949
targeting someone<font color="#E5E5E5"> provisioning a method</font>

342
00:14:57,910 --> 00:15:01,660
anything you have<font color="#CCCCCC"> physical</font><font color="#E5E5E5"> access to the</font>

343
00:14:59,950 --> 00:15:03,700
<font color="#CCCCCC">machine you</font><font color="#E5E5E5"> can route remote setup you</font>

344
00:15:01,660 --> 00:15:06,029
<font color="#CCCCCC">can do USB you can do bars menu whatever</font>

345
00:15:03,700 --> 00:15:06,029
<font color="#CCCCCC">you like</font>

346
00:15:07,240 --> 00:15:13,029
the<font color="#E5E5E5"> medium you can</font><font color="#CCCCCC"> say medium here if</font>

347
00:15:10,089 --> 00:15:15,850
you think<font color="#CCCCCC"> maybe you'll maybe you'll</font>

348
00:15:13,029 --> 00:15:17,890
attack someone who's posted their laptop

349
00:15:15,850 --> 00:15:19,390
and<font color="#E5E5E5"> the lab has</font><font color="#CCCCCC"> been left</font><font color="#E5E5E5"> unattended on</font>

350
00:15:17,890 --> 00:15:20,949
the street for an hour or<font color="#E5E5E5"> so and you'll</font>

351
00:15:19,390 --> 00:15:23,589
grab it or something<font color="#E5E5E5"> and it depends on</font>

352
00:15:20,950 --> 00:15:27,670
what you define that subverting supply

353
00:15:23,589 --> 00:15:30,520
chain second<font color="#E5E5E5"> option is you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> have root</font>

354
00:15:27,670 --> 00:15:31,779
or<font color="#E5E5E5"> admin the machine already in this</font>

355
00:15:30,520 --> 00:15:34,480
case the provisioning method will<font color="#CCCCCC"> be</font>

356
00:15:31,779 --> 00:15:37,150
local agent on the OS the complexity is

357
00:15:34,480 --> 00:15:39,279
high for<font color="#CCCCCC"> well-secured OS at least</font><font color="#E5E5E5"> or</font>

358
00:15:37,150 --> 00:15:41,740
medium if you think<font color="#E5E5E5"> getting root on a</font>

359
00:15:39,279 --> 00:15:43,629
box is easy

360
00:15:41,740 --> 00:15:45,670
another reason for<font color="#E5E5E5"> highs because</font>

361
00:15:43,629 --> 00:15:48,309
provisioning while local agent will get

362
00:15:45,670 --> 00:15:52,118
<font color="#E5E5E5">you climb control mode and not admin</font>

363
00:15:48,309 --> 00:15:53,649
control mode<font color="#CCCCCC"> the likely attacker here</font>

364
00:15:52,119 --> 00:15:55,089
again is sophisticated tackle looking

365
00:15:53,649 --> 00:15:56,470
for<font color="#CCCCCC"> long term</font><font color="#E5E5E5"> persistence</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> if you</font>

366
00:15:55,089 --> 00:15:59,639
already have root in the<font color="#E5E5E5"> box you kind of</font>

367
00:15:56,470 --> 00:15:59,639
<font color="#E5E5E5">wonder why you want a Mt</font>

368
00:16:01,360 --> 00:16:05,709
both of these are<font color="#E5E5E5"> hard to carry out and</font>

369
00:16:03,309 --> 00:16:09,670
unlikely<font color="#E5E5E5"> for different reasons for the</font>

370
00:16:05,709 --> 00:16:11,050
last one physical access seems the most

371
00:16:09,670 --> 00:16:14,259
<font color="#CCCCCC">easiest to me</font>

372
00:16:11,050 --> 00:16:16,569
so complexity is low<font color="#CCCCCC"> a likely attacker</font>

373
00:16:14,259 --> 00:16:19,209
<font color="#CCCCCC">is someone who's targeting</font><font color="#E5E5E5"> you or</font>

374
00:16:16,569 --> 00:16:21,279
opportunistic<font color="#CCCCCC"> could be evil</font><font color="#E5E5E5"> made type</font>

375
00:16:19,209 --> 00:16:23,258
attack or shipment interception<font color="#E5E5E5"> the</font>

376
00:16:21,279 --> 00:16:25,600
provisioning method here is<font color="#CCCCCC"> either USB</font>

377
00:16:23,259 --> 00:16:26,829
or<font color="#CCCCCC"> pious menu so you're assuming you</font>

378
00:16:25,600 --> 00:16:31,449
don't<font color="#E5E5E5"> have written a box you can log</font>

379
00:16:26,829 --> 00:16:33,878
<font color="#CCCCCC">into the</font><font color="#E5E5E5"> machine</font><font color="#CCCCCC"> let's twinkle</font><font color="#E5E5E5"> goals</font>

380
00:16:31,449 --> 00:16:38,279
because I think physical access seems

381
00:16:33,879 --> 00:16:38,279
the most<font color="#E5E5E5"> likely most easiest to proceed</font>

382
00:16:39,329 --> 00:16:44,399
so easiest attack vector<font color="#CCCCCC"> requires</font>

383
00:16:41,740 --> 00:16:46,809
physical<font color="#CCCCCC"> access so desktops are excluded</font>

384
00:16:44,399 --> 00:16:49,929
assuming<font color="#E5E5E5"> that desktop facilities are</font>

385
00:16:46,809 --> 00:16:50,679
well secured laptops also travel and get

386
00:16:49,929 --> 00:16:52,149
<font color="#E5E5E5">left unattended</font>

387
00:16:50,679 --> 00:16:55,269
you know I assume you go out<font color="#E5E5E5"> and drink</font>

388
00:16:52,149 --> 00:16:58,120
<font color="#E5E5E5">and you leave</font><font color="#CCCCCC"> your laptop</font><font color="#E5E5E5"> in the hotel</font>

389
00:16:55,269 --> 00:17:01,149
so it seems realistic<font color="#CCCCCC"> I've written</font>

390
00:16:58,120 --> 00:17:02,740
<font color="#CCCCCC">Lenovo x1 carbon</font><font color="#E5E5E5"> 2016 here as the target</font>

391
00:17:01,149 --> 00:17:09,279
machine<font color="#E5E5E5"> but I've also tested some other</font>

392
00:17:02,740 --> 00:17:12,089
machines<font color="#CCCCCC"> ok let's talk</font><font color="#E5E5E5"> about some</font>

393
00:17:09,279 --> 00:17:14,470
<font color="#E5E5E5">assumptions so we know what</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> basis</font>

394
00:17:12,089 --> 00:17:18,069
<font color="#E5E5E5">firstly obviously the machine we target</font>

395
00:17:14,470 --> 00:17:22,029
has<font color="#CCCCCC"> to have AMT</font><font color="#E5E5E5"> next Intel empty should</font>

396
00:17:18,069 --> 00:17:24,309
not have been provisioned already<font color="#CCCCCC"> some</font>

397
00:17:22,029 --> 00:17:29,409
biases allow one provision inform the

398
00:17:24,309 --> 00:17:31,090
bias<font color="#E5E5E5"> menu</font><font color="#CCCCCC"> but others do not so if the</font>

399
00:17:29,409 --> 00:17:32,380
boss<font color="#E5E5E5"> doesn't have a password then</font>

400
00:17:31,090 --> 00:17:33,970
<font color="#CCCCCC">attacker go</font><font color="#E5E5E5"> into the BIOS</font><font color="#CCCCCC"> store and</font>

401
00:17:32,380 --> 00:17:38,470
provision the AMT<font color="#E5E5E5"> and then reprovision</font>

402
00:17:33,970 --> 00:17:40,809
it with their<font color="#E5E5E5"> own password thirdly the</font>

403
00:17:38,470 --> 00:17:42,700
<font color="#CCCCCC">meb X password which is also known as</font>

404
00:17:40,809 --> 00:17:45,760
<font color="#E5E5E5">the Emmy password should still be the</font>

405
00:17:42,700 --> 00:17:48,130
Intel default which is admin<font color="#E5E5E5"> this is</font>

406
00:17:45,760 --> 00:17:49,779
usually<font color="#E5E5E5"> the case if you buy in large</font>

407
00:17:48,130 --> 00:17:51,279
<font color="#E5E5E5">enough quantity you can ask the</font>

408
00:17:49,779 --> 00:17:54,610
<font color="#E5E5E5">manufacturer to change this to something</font>

409
00:17:51,279 --> 00:17:55,480
else<font color="#E5E5E5"> but unless you're gonna use AMT why</font>

410
00:17:54,610 --> 00:17:58,959
would you do it

411
00:17:55,480 --> 00:18:01,960
right finally either<font color="#CCCCCC"> AMT should already</font>

412
00:17:58,960 --> 00:18:04,750
<font color="#E5E5E5">be in abled or a biased password is not</font>

413
00:18:01,960 --> 00:18:07,090
<font color="#E5E5E5">set so</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can enable AMT ourselves so</font>

414
00:18:04,750 --> 00:18:09,790
observation here is HP will not let you

415
00:18:07,090 --> 00:18:12,610
enter<font color="#CCCCCC"> the AMT setup bias menu</font><font color="#E5E5E5"> without</font>

416
00:18:09,790 --> 00:18:14,020
the boss password but Lenovo will hence

417
00:18:12,610 --> 00:18:21,550
a wise<font color="#CCCCCC"> not a</font><font color="#E5E5E5"> requirement for</font><font color="#CCCCCC"> our attack</font>

418
00:18:14,020 --> 00:18:23,950
<font color="#E5E5E5">the</font><font color="#CCCCCC"> learner is what I used ok so here's</font>

419
00:18:21,550 --> 00:18:26,220
an ideal attack scenario<font color="#E5E5E5"> look for an</font>

420
00:18:23,950 --> 00:18:29,830
opportunity<font color="#CCCCCC"> or create a distraction</font>

421
00:18:26,220 --> 00:18:31,540
then since we'd like to spend<font color="#E5E5E5"> as little</font>

422
00:18:29,830 --> 00:18:34,689
<font color="#E5E5E5">time as needed</font><font color="#CCCCCC"> to provision and set up</font>

423
00:18:31,540 --> 00:18:37,780
<font color="#E5E5E5">the USP IMT we will use the USB to order</font>

424
00:18:34,690 --> 00:18:40,240
provision AMT<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> set up</font><font color="#E5E5E5"> AMT to</font>

425
00:18:37,780 --> 00:18:44,470
auto<font color="#CCCCCC"> start</font><font color="#E5E5E5"> a CR session to call out to</font>

426
00:18:40,240 --> 00:18:45,670
my command and<font color="#E5E5E5"> control server and we</font>

427
00:18:44,470 --> 00:18:47,230
should be we should<font color="#CCCCCC"> be good that's</font><font color="#E5E5E5"> it</font>

428
00:18:45,670 --> 00:18:47,680
that's<font color="#E5E5E5"> what the documentation say should</font>

429
00:18:47,230 --> 00:18:50,680
work

430
00:18:47,680 --> 00:18:52,480
let's see what what really happened<font color="#E5E5E5"> so</font>

431
00:18:50,680 --> 00:18:58,120
this is<font color="#E5E5E5"> this is the ideal do this walk</font>

432
00:18:52,480 --> 00:19:02,140
away unfortunately<font color="#E5E5E5"> there was a few</font>

433
00:18:58,120 --> 00:19:05,530
hiccups so here's what I found trying to

434
00:19:02,140 --> 00:19:07,300
do this so USB provisioning file can<font color="#CCCCCC"> be</font>

435
00:19:05,530 --> 00:19:11,920
really<font color="#CCCCCC"> easily created using the</font><font color="#E5E5E5"> open</font>

436
00:19:07,300 --> 00:19:13,510
<font color="#CCCCCC">source software I already mentioned the</font>

437
00:19:11,920 --> 00:19:15,160
USB<font color="#E5E5E5"> provisioning worked even when it</font>

438
00:19:13,510 --> 00:19:17,020
shouldn't<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it when it seemed it</font>

439
00:19:15,160 --> 00:19:18,880
shouldn't work<font color="#E5E5E5"> so</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> cases are like</font>

440
00:19:17,020 --> 00:19:21,400
it worked<font color="#CCCCCC"> even when there was a</font><font color="#E5E5E5"> pass</font>

441
00:19:18,880 --> 00:19:24,130
password set it worked<font color="#CCCCCC"> even</font><font color="#E5E5E5"> when I had</font>

442
00:19:21,400 --> 00:19:26,110
disabled<font color="#E5E5E5"> always on USB it worked</font><font color="#CCCCCC"> even</font>

443
00:19:24,130 --> 00:19:27,820
<font color="#CCCCCC">when I</font><font color="#E5E5E5"> had removed USB from the boot</font>

444
00:19:26,110 --> 00:19:34,389
<font color="#CCCCCC">priority order</font><font color="#E5E5E5"> it just worked it just</font>

445
00:19:27,820 --> 00:19:36,189
<font color="#E5E5E5">always worked but the</font><font color="#CCCCCC"> downside was</font><font color="#E5E5E5"> I</font>

446
00:19:34,390 --> 00:19:38,620
could only<font color="#E5E5E5"> set a very limited number</font><font color="#CCCCCC"> of</font>

447
00:19:36,190 --> 00:19:40,180
settings why a USB and the one setting<font color="#E5E5E5"> I</font>

448
00:19:38,620 --> 00:19:47,290
could not set that<font color="#CCCCCC"> I really wanted to</font>

449
00:19:40,180 --> 00:19:49,120
set was<font color="#CCCCCC"> ceará so but what I could set</font>

450
00:19:47,290 --> 00:19:51,310
through USB was a remote provisioning

451
00:19:49,120 --> 00:19:52,870
server which what it does is it AMT will

452
00:19:51,310 --> 00:19:54,850
call out to<font color="#CCCCCC"> a remote provisioning server</font>

453
00:19:52,870 --> 00:19:57,070
and ask for morph settings which could

454
00:19:54,850 --> 00:20:00,520
include<font color="#CCCCCC"> 0 but I can't set up</font><font color="#E5E5E5"> see her</font>

455
00:19:57,070 --> 00:20:01,780
directly so this this makes<font color="#E5E5E5"> life a</font>

456
00:20:00,520 --> 00:20:05,110
<font color="#E5E5E5">little more complicated than I wanted</font>

457
00:20:01,780 --> 00:20:07,840
but<font color="#E5E5E5"> that that's what I was stuck</font><font color="#CCCCCC"> with so</font>

458
00:20:05,110 --> 00:20:08,689
I had a couple<font color="#CCCCCC"> of options to get</font><font color="#E5E5E5"> see</font>

459
00:20:07,840 --> 00:20:11,539
where to work

460
00:20:08,690 --> 00:20:14,840
so option<font color="#CCCCCC"> eight</font><font color="#E5E5E5"> set provisioning server</font>

461
00:20:11,539 --> 00:20:17,619
<font color="#E5E5E5">via USB and use that the provisioning</font>

462
00:20:14,840 --> 00:20:19,668
server to push the<font color="#CCCCCC"> crs settings I wanted</font>

463
00:20:17,619 --> 00:20:22,220
<font color="#E5E5E5">firstly the provisioning server will</font>

464
00:20:19,669 --> 00:20:23,749
have to be on the same network<font color="#E5E5E5"> won't</font>

465
00:20:22,220 --> 00:20:25,399
work on<font color="#E5E5E5"> an external Network because</font>

466
00:20:23,749 --> 00:20:27,440
<font color="#CCCCCC">responds to how those</font><font color="#E5E5E5"> packets won't be</font>

467
00:20:25,399 --> 00:20:30,678
received by<font color="#E5E5E5"> AMT without a cor tunnel</font>

468
00:20:27,440 --> 00:20:32,479
which is<font color="#E5E5E5"> what I want to set so we'll</font>

469
00:20:30,679 --> 00:20:33,830
<font color="#E5E5E5">need to bring</font><font color="#CCCCCC"> along a Raspberry Pi or</font>

470
00:20:32,479 --> 00:20:36,289
<font color="#E5E5E5">something similar running the</font>

471
00:20:33,830 --> 00:20:37,908
provisioning server<font color="#E5E5E5"> secondly there is no</font>

472
00:20:36,289 --> 00:20:39,859
easy to use Linux<font color="#E5E5E5"> software for the</font>

473
00:20:37,909 --> 00:20:45,259
provisioning server<font color="#E5E5E5"> and I don't want to</font>

474
00:20:39,859 --> 00:20:46,879
write one<font color="#CCCCCC"> the</font><font color="#E5E5E5"> open source tool that I</font>

475
00:20:45,259 --> 00:20:48,859
mentioned<font color="#CCCCCC"> earlier is being actively</font>

476
00:20:46,879 --> 00:20:50,988
developed<font color="#CCCCCC"> and they are gonna</font><font color="#E5E5E5"> add this</font>

477
00:20:48,859 --> 00:20:53,590
functionality at some point<font color="#CCCCCC"> so I didn't</font>

478
00:20:50,989 --> 00:20:55,970
want to<font color="#E5E5E5"> double up</font><font color="#CCCCCC"> the effort</font><font color="#E5E5E5"> so option</font><font color="#CCCCCC"> B</font>

479
00:20:53,590 --> 00:20:58,668
manual setup through LAN<font color="#CCCCCC"> so there's an</font>

480
00:20:55,970 --> 00:21:01,429
increased attack timing in this case

481
00:20:58,669 --> 00:21:03,769
once the<font color="#CCCCCC"> AMT is</font><font color="#E5E5E5"> configured</font><font color="#CCCCCC"> via a USB I</font>

482
00:21:01,429 --> 00:21:07,909
would connect the<font color="#E5E5E5"> laptops land to my own</font>

483
00:21:03,769 --> 00:21:11,899
<font color="#E5E5E5">network and use</font><font color="#CCCCCC"> AMT API calls</font><font color="#E5E5E5"> to set up</font>

484
00:21:07,909 --> 00:21:14,809
<font color="#E5E5E5">zero</font><font color="#CCCCCC"> because once</font><font color="#E5E5E5"> empty is provisioned I</font>

485
00:21:11,899 --> 00:21:17,899
have full API access<font color="#E5E5E5"> this adds about</font>

486
00:21:14,809 --> 00:21:20,330
<font color="#CCCCCC">thirty seconds to the attack if API</font>

487
00:21:17,899 --> 00:21:22,939
calls are pre-scripted<font color="#CCCCCC"> or I cannot do it</font>

488
00:21:20,330 --> 00:21:26,239
about or or three minutes if you do this

489
00:21:22,940 --> 00:21:28,249
why nice<font color="#E5E5E5"> GUI so</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a video from</font>

490
00:21:26,239 --> 00:21:31,940
<font color="#E5E5E5">mesh</font><font color="#CCCCCC"> central developer on YouTube titled</font>

491
00:21:28,249 --> 00:21:34,669
<font color="#CCCCCC">mesh central to intel amt serie</font><font color="#E5E5E5"> it's</font>

492
00:21:31,940 --> 00:21:37,519
perfect title<font color="#E5E5E5"> and it shows you</font><font color="#CCCCCC"> exactly</font>

493
00:21:34,669 --> 00:21:39,440
how you<font color="#E5E5E5"> can do it using GUI</font><font color="#CCCCCC"> I ended up</font>

494
00:21:37,519 --> 00:21:40,789
going with<font color="#E5E5E5"> option</font><font color="#CCCCCC"> B which</font><font color="#E5E5E5"> is easier</font><font color="#CCCCCC"> for</font>

495
00:21:39,440 --> 00:21:43,489
now I didn't<font color="#E5E5E5"> want to rewrite what</font>

496
00:21:40,789 --> 00:21:46,609
they're gonna write<font color="#E5E5E5"> anyway in both cases</font>

497
00:21:43,489 --> 00:21:49,039
though<font color="#E5E5E5"> you need either a</font><font color="#CCCCCC"> built in</font><font color="#E5E5E5"> LAN or</font>

498
00:21:46,609 --> 00:21:54,470
native<font color="#CCCCCC"> line adapter so let's update our</font>

499
00:21:49,039 --> 00:21:55,879
<font color="#CCCCCC">assumptions slide so for our</font><font color="#E5E5E5"> attack the</font>

500
00:21:54,470 --> 00:21:58,340
<font color="#E5E5E5">machine needs to have either</font><font color="#CCCCCC"> built-in</font>

501
00:21:55,879 --> 00:22:01,699
LAN or native land adapter which<font color="#CCCCCC"> MT will</font>

502
00:21:58,340 --> 00:22:04,129
use to<font color="#CCCCCC"> listen by default</font><font color="#E5E5E5"> USB LAN adapter</font>

503
00:22:01,700 --> 00:22:07,369
will not work since AMT doesn't listen

504
00:22:04,129 --> 00:22:08,809
to<font color="#E5E5E5"> it by default so for the x1 carbon</font>

505
00:22:07,369 --> 00:22:11,599
that<font color="#CCCCCC"> I was using it</font><font color="#E5E5E5"> doesn't have</font>

506
00:22:08,809 --> 00:22:14,418
<font color="#CCCCCC">built-in</font><font color="#E5E5E5"> land but it has a custom LAN</font>

507
00:22:11,599 --> 00:22:16,729
adapter so<font color="#E5E5E5"> you can buy</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> little</font>

508
00:22:14,419 --> 00:22:18,739
adapter it plugs in and as seen as

509
00:22:16,729 --> 00:22:20,269
native by the OS<font color="#CCCCCC"> and by the system</font><font color="#E5E5E5"> and</font>

510
00:22:18,739 --> 00:22:22,260
then aim to<font color="#CCCCCC"> listens to it</font><font color="#E5E5E5"> anyway so</font>

511
00:22:20,269 --> 00:22:25,290
<font color="#CCCCCC">that's it worked out</font>

512
00:22:22,260 --> 00:22:27,420
and for my quick research I think

513
00:22:25,290 --> 00:22:30,149
<font color="#E5E5E5">generally speaking business laptops</font>

514
00:22:27,420 --> 00:22:32,420
<font color="#CCCCCC">either generally have plan or have an</font>

515
00:22:30,150 --> 00:22:34,830
adapter like the x1 to<font color="#E5E5E5"> a lab for land</font>

516
00:22:32,420 --> 00:22:39,030
because I<font color="#E5E5E5"> there's</font><font color="#CCCCCC"> they usually like</font>

517
00:22:34,830 --> 00:22:41,429
dockable stations so this still<font color="#CCCCCC"> seemed</font>

518
00:22:39,030 --> 00:22:48,260
like an acceptable Lister for

519
00:22:41,430 --> 00:22:51,180
something's to me<font color="#E5E5E5"> okay so</font><font color="#CCCCCC"> attack steps</font>

520
00:22:48,260 --> 00:22:55,560
<font color="#E5E5E5">set up USB setup command and control</font>

521
00:22:51,180 --> 00:23:00,330
server right<font color="#E5E5E5"> AMT CRS script bring LAN</font>

522
00:22:55,560 --> 00:23:03,929
adapter and cable execution<font color="#E5E5E5"> is reboot</font>

523
00:23:00,330 --> 00:23:06,270
<font color="#E5E5E5">plug in USB plug in the LAN cable</font><font color="#CCCCCC"> and</font>

524
00:23:03,930 --> 00:23:14,070
adapter<font color="#E5E5E5"> trigger script to</font><font color="#CCCCCC"> set up 0 and</font>

525
00:23:06,270 --> 00:23:16,440
then walk away results here<font color="#E5E5E5"> we are</font>

526
00:23:14,070 --> 00:23:25,189
connected<font color="#E5E5E5"> to connected into</font><font color="#CCCCCC"> the laptop</font>

527
00:23:16,440 --> 00:23:28,980
via<font color="#CCCCCC"> serie we can see that series setup</font>

528
00:23:25,190 --> 00:23:31,440
it<font color="#E5E5E5"> is configured</font><font color="#CCCCCC"> to dial</font><font color="#E5E5E5"> out to my</font>

529
00:23:28,980 --> 00:23:33,810
server every 10 seconds<font color="#E5E5E5"> and maintain a</font>

530
00:23:31,440 --> 00:23:36,660
persistent<font color="#CCCCCC"> terminal forever as soon</font><font color="#E5E5E5"> as</font>

531
00:23:33,810 --> 00:23:38,190
the connection is<font color="#E5E5E5"> established so it'll</font>

532
00:23:36,660 --> 00:23:40,470
keep trying<font color="#E5E5E5"> every 10 seconds depending</font>

533
00:23:38,190 --> 00:23:41,640
on<font color="#E5E5E5"> it the internet is up or not</font><font color="#CCCCCC"> and as</font>

534
00:23:40,470 --> 00:23:43,380
soon as it's established it will stay

535
00:23:41,640 --> 00:23:47,640
connected so<font color="#E5E5E5"> that I can tunnel back in</font>

536
00:23:43,380 --> 00:23:50,340
that's<font color="#E5E5E5"> how I'm looking at the screen in</font>

537
00:23:47,640 --> 00:23:50,970
<font color="#CCCCCC">mesh central</font><font color="#E5E5E5"> to here you can see takes</font>

538
00:23:50,340 --> 00:23:52,770
care of the rest

539
00:23:50,970 --> 00:23:58,170
I don't really have to do any<font color="#E5E5E5"> anything</font>

540
00:23:52,770 --> 00:24:00,240
advanced I even configured see<font color="#CCCCCC"> our dial</font>

541
00:23:58,170 --> 00:24:04,020
out over Wi-Fi<font color="#E5E5E5"> in case the LAN is down</font>

542
00:24:00,240 --> 00:24:05,760
in this<font color="#E5E5E5"> screenshot I'm connected to</font><font color="#CCCCCC"> a</font>

543
00:24:04,020 --> 00:24:07,650
<font color="#E5E5E5">MTV I see our tunnel which was</font>

544
00:24:05,760 --> 00:24:11,930
established<font color="#CCCCCC"> over Wi-Fi</font><font color="#E5E5E5"> so you</font><font color="#CCCCCC"> can see</font>

545
00:24:07,650 --> 00:24:15,680
wireless link is up<font color="#E5E5E5"> wired link is down</font><font color="#CCCCCC"> I</font>

546
00:24:11,930 --> 00:24:19,130
also tested<font color="#CCCCCC"> KVM</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> the Sierra tunnel</font>

547
00:24:15,680 --> 00:24:21,810
<font color="#CCCCCC">this was</font><font color="#E5E5E5"> tested</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> land only though</font>

548
00:24:19,130 --> 00:24:23,610
<font color="#CCCCCC">doing this over Wi-Fi</font><font color="#E5E5E5"> without an OS</font>

549
00:24:21,810 --> 00:24:26,129
agent or helping a Wi-Fi driver<font color="#E5E5E5"> is a bit</font>

550
00:24:23,610 --> 00:24:28,919
complicated<font color="#E5E5E5"> the way it's meant to</font><font color="#CCCCCC"> work</font>

551
00:24:26,130 --> 00:24:31,740
<font color="#CCCCCC">as AMT would hand back control of Wi-Fi</font>

552
00:24:28,920 --> 00:24:35,910
radios to the OS whenever the Wi-Fi

553
00:24:31,740 --> 00:24:41,370
driver is loaded in

554
00:24:35,910 --> 00:24:44,370
the normal use case<font color="#CCCCCC"> the Wi-Fi driver is</font>

555
00:24:41,370 --> 00:24:46,860
meant to pass the messages between<font color="#CCCCCC"> a MT</font>

556
00:24:44,370 --> 00:24:49,979
<font color="#E5E5E5">and the OS or an OS agent is meant to</font>

557
00:24:46,860 --> 00:24:51,389
take over<font color="#CCCCCC"> I didn't try this as we didn't</font>

558
00:24:49,980 --> 00:24:52,770
assume<font color="#E5E5E5"> having that level of access</font>

559
00:24:51,390 --> 00:24:54,210
access<font color="#E5E5E5"> from the beginning because</font><font color="#CCCCCC"> we</font>

560
00:24:52,770 --> 00:24:56,190
<font color="#E5E5E5">need to kind</font><font color="#CCCCCC"> of root access to be</font><font color="#E5E5E5"> able</font>

561
00:24:54,210 --> 00:24:58,080
<font color="#E5E5E5">to load our drivers but as an attacker</font>

562
00:24:56,190 --> 00:24:59,520
you<font color="#E5E5E5"> can load the correct driver or agent</font>

563
00:24:58,080 --> 00:25:00,750
once you have control<font color="#E5E5E5"> so once you have a</font>

564
00:24:59,520 --> 00:25:01,950
empty<font color="#E5E5E5"> control then you can load the</font>

565
00:25:00,750 --> 00:25:04,640
correct<font color="#E5E5E5"> drivers so you can load your own</font>

566
00:25:01,950 --> 00:25:06,750
custom OS which has the correct<font color="#CCCCCC"> driver</font>

567
00:25:04,640 --> 00:25:08,580
some of the elephant<font color="#E5E5E5"> trunk are some</font>

568
00:25:06,750 --> 00:25:10,380
function ID I did not test<font color="#E5E5E5"> so remote</font>

569
00:25:08,580 --> 00:25:13,799
mounting and booting the<font color="#E5E5E5"> disk through</font>

570
00:25:10,380 --> 00:25:15,780
<font color="#E5E5E5">mesh central it's not implemented yet</font>

571
00:25:13,799 --> 00:25:17,460
<font color="#E5E5E5">again it's active development so just</font>

572
00:25:15,780 --> 00:25:20,370
waited I'll wait a wait a bit and<font color="#E5E5E5"> I'll</font>

573
00:25:17,460 --> 00:25:21,960
show up<font color="#E5E5E5"> I did test that independently as</font>

574
00:25:20,370 --> 00:25:23,580
I mentioned earlier I'm a floppy drive

575
00:25:21,960 --> 00:25:26,059
<font color="#CCCCCC">and</font><font color="#E5E5E5"> exfilled some doubt I've just just</font>

576
00:25:23,580 --> 00:25:26,059
<font color="#E5E5E5">for the fun of it</font>

577
00:25:27,950 --> 00:25:34,260
so Wi-Fi is a bit of a limit so<font color="#E5E5E5"> AMT</font>

578
00:25:32,640 --> 00:25:37,770
seems to be most useful<font color="#E5E5E5"> when the machine</font>

579
00:25:34,260 --> 00:25:41,039
<font color="#CCCCCC">is connected to land some people do use</font>

580
00:25:37,770 --> 00:25:43,830
laptop docks<font color="#CCCCCC"> file</font><font color="#E5E5E5"> and but it's not</font>

581
00:25:41,039 --> 00:25:45,900
significantly reliable as<font color="#E5E5E5"> mentioned</font>

582
00:25:43,830 --> 00:25:51,449
before Wi-Fi control is handed<font color="#CCCCCC"> to OS</font>

583
00:25:45,900 --> 00:25:53,549
when the Wi-Fi driver loads but the

584
00:25:51,450 --> 00:25:58,320
<font color="#E5E5E5">bloated driver which comes with</font><font color="#CCCCCC"> Windows</font>

585
00:25:53,549 --> 00:26:01,830
may be the correct one by default<font color="#E5E5E5"> again</font>

586
00:25:58,320 --> 00:26:04,020
<font color="#E5E5E5">also</font><font color="#CCCCCC"> to use Wi-Fi at the profiles for</font>

587
00:26:01,830 --> 00:26:06,510
Wi-Fi must be loaded<font color="#E5E5E5"> into AMT so empty</font>

588
00:26:04,020 --> 00:26:08,429
supports up to<font color="#E5E5E5"> 16 Wi-Fi profiles the</font>

589
00:26:06,510 --> 00:26:11,640
attacker<font color="#E5E5E5"> needs to know which local ApS</font>

590
00:26:08,429 --> 00:26:15,659
are likely to be<font color="#CCCCCC"> available</font><font color="#E5E5E5"> and know the</font>

591
00:26:11,640 --> 00:26:17,850
credentials<font color="#E5E5E5"> passwords or certs to use to</font>

592
00:26:15,659 --> 00:26:22,320
connect to them so if you're<font color="#CCCCCC"> surrounded</font>

593
00:26:17,850 --> 00:26:26,399
by<font color="#CCCCCC"> well-known a a piece then you should</font>

594
00:26:22,320 --> 00:26:27,600
care about<font color="#E5E5E5"> this a bit more the boot</font>

595
00:26:26,400 --> 00:26:30,059
injection attack<font color="#E5E5E5"> I mentioned</font><font color="#CCCCCC"> earlier a</font>

596
00:26:27,600 --> 00:26:33,928
standard attacker is still possible of a

597
00:26:30,059 --> 00:26:35,520
Wi-Fi when you boot your<font color="#E5E5E5"> custom OS you</font>

598
00:26:33,929 --> 00:26:40,470
have two choices<font color="#E5E5E5"> either don't load any</font>

599
00:26:35,520 --> 00:26:42,809
Wi-Fi driver<font color="#CCCCCC"> so the Wi-Fi sorry the</font><font color="#E5E5E5"> the</font>

600
00:26:40,470 --> 00:26:44,520
<font color="#CCCCCC">radios control isn't</font><font color="#E5E5E5"> handed over the</font><font color="#CCCCCC"> US</font>

601
00:26:42,809 --> 00:26:46,889
or load the<font color="#E5E5E5"> correct driver and then</font>

602
00:26:44,520 --> 00:26:47,190
connect out through that<font color="#E5E5E5"> so either way</font>

603
00:26:46,890 --> 00:26:49,519
<font color="#E5E5E5">is fine</font>

604
00:26:47,190 --> 00:26:51,620
so as

605
00:26:49,519 --> 00:26:59,720
a driver doesn't try<font color="#CCCCCC"> to</font><font color="#E5E5E5"> take control the</font>

606
00:26:51,620 --> 00:27:02,508
<font color="#CCCCCC">radio's</font><font color="#E5E5E5"> AMT will keep working</font><font color="#CCCCCC"> for a full</font>

607
00:26:59,720 --> 00:27:04,399
<font color="#E5E5E5">list of limitations with Wi-Fi</font><font color="#CCCCCC"> there is</font>

608
00:27:02,509 --> 00:27:07,009
a<font color="#CCCCCC"> doc titled key differences between</font>

609
00:27:04,399 --> 00:27:08,059
wired and wireless<font color="#E5E5E5"> Intel AMT support so</font>

610
00:27:07,009 --> 00:27:10,580
you<font color="#CCCCCC"> can check that out if you want to</font>

611
00:27:08,059 --> 00:27:13,100
know more hopefully you've got a fair

612
00:27:10,580 --> 00:27:15,850
idea of what's involved<font color="#CCCCCC"> of using AMT for</font>

613
00:27:13,100 --> 00:27:18,469
an attack despite the Wi-Fi limitations

614
00:27:15,850 --> 00:27:20,509
<font color="#CCCCCC">it</font><font color="#E5E5E5"> definitely seems like something to be</font>

615
00:27:18,470 --> 00:27:24,169
worried about<font color="#CCCCCC"> since it has such powerful</font>

616
00:27:20,509 --> 00:27:26,139
legitimate features<font color="#CCCCCC"> this concludes the</font>

617
00:27:24,169 --> 00:27:29,360
attacker<font color="#CCCCCC"> focus side of the presentation</font>

618
00:27:26,139 --> 00:27:33,620
<font color="#CCCCCC">next</font><font color="#E5E5E5"> what can US defenders do it's kind</font>

619
00:27:29,360 --> 00:27:35,600
<font color="#CCCCCC">of what I do generally</font><font color="#E5E5E5"> defense</font><font color="#CCCCCC"> let's</font>

620
00:27:33,620 --> 00:27:41,360
<font color="#E5E5E5">look at options we have for detection</font>

621
00:27:35,600 --> 00:27:43,129
mitigation and<font color="#E5E5E5"> prevention first up how</font>

622
00:27:41,360 --> 00:27:46,250
do we detect when an attacker is<font color="#E5E5E5"> abusing</font>

623
00:27:43,129 --> 00:27:48,469
the ghost of the<font color="#E5E5E5"> machine sorry two</font>

624
00:27:46,250 --> 00:27:50,750
options<font color="#E5E5E5"> network based look for</font>

625
00:27:48,470 --> 00:27:52,370
<font color="#CCCCCC">well-known network ports</font><font color="#E5E5E5"> so remote</font>

626
00:27:50,750 --> 00:27:56,210
configuration provisional<font color="#CCCCCC"> requests</font>

627
00:27:52,370 --> 00:27:58,129
<font color="#CCCCCC">always call out to TCP 971 which</font><font color="#E5E5E5"> is</font>

628
00:27:56,210 --> 00:27:59,500
<font color="#CCCCCC">hard-coded into the Emmy</font><font color="#E5E5E5"> so you can look</font>

629
00:27:58,129 --> 00:28:02,629
for that on your network for<font color="#E5E5E5"> example</font>

630
00:27:59,500 --> 00:28:06,019
<font color="#E5E5E5">source ports for AMT initiative packets</font>

631
00:28:02,629 --> 00:28:10,549
<font color="#E5E5E5">for ease for example</font><font color="#CCCCCC"> sirrah</font><font color="#E5E5E5"> are always</font>

632
00:28:06,019 --> 00:28:12,320
<font color="#CCCCCC">between</font><font color="#E5E5E5"> 1</font><font color="#CCCCCC"> 6</font><font color="#E5E5E5"> 9 9 2</font><font color="#CCCCCC"> &</font><font color="#E5E5E5"> 1 6 9</font><font color="#CCCCCC"> 9 5</font><font color="#E5E5E5"> so these</font>

633
00:28:10,549 --> 00:28:14,480
are the posts that<font color="#E5E5E5"> are reserved for AMT</font>

634
00:28:12,320 --> 00:28:21,350
and a<font color="#CCCCCC"> hard-coded in</font><font color="#E5E5E5"> DME that cannot</font><font color="#CCCCCC"> be</font>

635
00:28:14,480 --> 00:28:23,570
<font color="#E5E5E5">changed by anyone these and the reason</font>

636
00:28:21,350 --> 00:28:26,209
<font color="#CCCCCC">for this is because</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> way the AMT</font>

637
00:28:23,570 --> 00:28:30,950
listens to API calls or listens to

638
00:28:26,210 --> 00:28:33,169
anything<font color="#CCCCCC"> sent to it is by hijacking</font><font color="#E5E5E5"> the</font>

639
00:28:30,950 --> 00:28:34,370
network adapter directly<font color="#E5E5E5"> so if every</font>

640
00:28:33,169 --> 00:28:38,480
packet that<font color="#CCCCCC"> goes</font><font color="#E5E5E5"> through a network</font>

641
00:28:34,370 --> 00:28:40,309
adapter<font color="#E5E5E5"> gets looked at by the AMT</font><font color="#CCCCCC"> and if</font>

642
00:28:38,480 --> 00:28:43,940
it matches this port<font color="#E5E5E5"> it gets grabbed</font>

643
00:28:40,309 --> 00:28:45,529
before the OS sees it<font color="#CCCCCC"> so you can't just</font>

644
00:28:43,940 --> 00:28:47,750
listen<font color="#E5E5E5"> to all ports</font><font color="#CCCCCC"> because then the OS</font>

645
00:28:45,529 --> 00:28:50,590
won't get any packets so these ports are

646
00:28:47,750 --> 00:28:50,590
<font color="#CCCCCC">hard-coded</font><font color="#E5E5E5"> for a good reason</font>

647
00:28:54,100 --> 00:28:58,439
<font color="#E5E5E5">see</font>

648
00:28:55,200 --> 00:29:03,779
connections can be<font color="#E5E5E5"> mutual TLS</font><font color="#CCCCCC"> but</font>

649
00:28:58,440 --> 00:29:05,970
they're always at least TLS so in for

650
00:29:03,779 --> 00:29:08,039
<font color="#CCCCCC">serie the way it works is server public</font>

651
00:29:05,970 --> 00:29:09,809
key is inserted<font color="#E5E5E5"> into</font><font color="#CCCCCC"> AMT a setup</font><font color="#E5E5E5"> time</font>

652
00:29:08,039 --> 00:29:13,230
like I mentioned<font color="#E5E5E5"> earlier either way USB</font>

653
00:29:09,809 --> 00:29:16,500
or factory<font color="#CCCCCC"> aim</font><font color="#E5E5E5"> T will then generate a</font>

654
00:29:13,230 --> 00:29:20,130
certificate<font color="#E5E5E5"> the private key</font><font color="#CCCCCC"> of which can</font>

655
00:29:16,500 --> 00:29:23,669
never be exported<font color="#E5E5E5"> and the server will</font>

656
00:29:20,130 --> 00:29:29,299
use that certificate<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> command and</font>

657
00:29:23,669 --> 00:29:31,679
control side<font color="#E5E5E5"> to establish trust</font><font color="#CCCCCC"> and</font>

658
00:29:29,299 --> 00:29:34,200
<font color="#E5E5E5">whenever CRI is running all inbound</font>

659
00:29:31,679 --> 00:29:40,500
<font color="#CCCCCC">network ports are closed</font><font color="#E5E5E5"> so you can't</font>

660
00:29:34,200 --> 00:29:43,260
probe<font color="#CCCCCC"> AMT</font><font color="#E5E5E5"> but if the attacker is</font><font color="#CCCCCC"> not</font>

661
00:29:40,500 --> 00:29:46,919
using<font color="#CCCCCC"> ceará</font><font color="#E5E5E5"> you can do AMT port scan</font>

662
00:29:43,260 --> 00:29:49,679
and it will respond<font color="#E5E5E5"> to 16.9 to the</font>

663
00:29:46,919 --> 00:29:52,289
problem here is can<font color="#CCCCCC"> you really distinct</font>

664
00:29:49,679 --> 00:29:57,600
<font color="#E5E5E5">distinguish between AMG traffic and OS</font>

665
00:29:52,289 --> 00:30:00,480
traffic if it's all mutual TLS<font color="#CCCCCC"> most</font>

666
00:29:57,600 --> 00:30:02,580
<font color="#E5E5E5">modern OSS hopefully shouldn't reuse AMT</font>

667
00:30:00,480 --> 00:30:04,529
ports because<font color="#CCCCCC"> is already reserved so you</font>

668
00:30:02,580 --> 00:30:07,889
should never see OS traffic coming from

669
00:30:04,529 --> 00:30:11,639
<font color="#E5E5E5">them so this</font><font color="#CCCCCC"> is detection like low-tier</font>

670
00:30:07,889 --> 00:30:13,379
<font color="#E5E5E5">is possible in my opinion and the second</font>

671
00:30:11,639 --> 00:30:18,120
option<font color="#CCCCCC"> you can do is have an OS agent</font>

672
00:30:13,380 --> 00:30:21,029
running<font color="#CCCCCC"> on your s so the OS agent can</font>

673
00:30:18,120 --> 00:30:23,070
talk to the ME interface and then query

674
00:30:21,029 --> 00:30:25,559
the state of the AMT<font color="#E5E5E5"> and say hey is this</font>

675
00:30:23,070 --> 00:30:29,340
enabled<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a provision and if it's</font>

676
00:30:25,559 --> 00:30:31,289
provision then you can have a signal if

677
00:30:29,340 --> 00:30:34,049
the attacker<font color="#E5E5E5"> already controls the OS</font>

678
00:30:31,289 --> 00:30:36,600
when your agent is running then they

679
00:30:34,049 --> 00:30:38,190
could fake the response<font color="#E5E5E5"> so the tool</font>

680
00:30:36,600 --> 00:30:40,649
needs<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be deployed</font><font color="#E5E5E5"> prior to OS</font>

681
00:30:38,190 --> 00:30:42,990
<font color="#CCCCCC">compromise so if if it's deployed at</font><font color="#E5E5E5"> a</font>

682
00:30:40,649 --> 00:30:47,549
<font color="#CCCCCC">reimage time for</font><font color="#E5E5E5"> example then you're</font>

683
00:30:42,990 --> 00:30:49,529
good for<font color="#CCCCCC"> Windows this</font><font color="#E5E5E5"> is not too</font><font color="#CCCCCC"> hard</font>

684
00:30:47,549 --> 00:30:51,510
<font color="#E5E5E5">because</font><font color="#CCCCCC"> there's an</font><font color="#E5E5E5"> existing tooling that</font>

685
00:30:49,529 --> 00:30:52,740
<font color="#CCCCCC">Intel is made available for Linux</font><font color="#E5E5E5"> a bit</font>

686
00:30:51,510 --> 00:30:56,279
of<font color="#E5E5E5"> effort because you need to write some</font>

687
00:30:52,740 --> 00:30:57,870
custom tooling as an aside<font color="#E5E5E5"> I did a</font>

688
00:30:56,279 --> 00:31:00,450
<font color="#E5E5E5">network capture of the</font><font color="#CCCCCC"> CRS sessions</font>

689
00:30:57,870 --> 00:31:02,279
<font color="#E5E5E5">using</font><font color="#CCCCCC"> a physical network tap that was</font>

690
00:31:00,450 --> 00:31:04,230
<font color="#E5E5E5">sitting between the Lenovo laptop and</font>

691
00:31:02,279 --> 00:31:06,539
the<font color="#CCCCCC"> lamb just</font><font color="#E5E5E5"> to just to see how it</font>

692
00:31:04,230 --> 00:31:07,970
worked and<font color="#E5E5E5"> I confirmed the mutual TLS</font>

693
00:31:06,539 --> 00:31:13,070
connection<font color="#E5E5E5"> I had no idea what</font>

694
00:31:07,970 --> 00:31:17,300
going on<font color="#CCCCCC"> there's also the possibility of</font>

695
00:31:13,070 --> 00:31:22,310
<font color="#E5E5E5">detection by user so custom OS boot can</font>

696
00:31:17,300 --> 00:31:24,950
be seen by a user<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> tray app</font><font color="#CCCCCC"> IMSS</font>

697
00:31:22,310 --> 00:31:27,710
will show pop up whenever<font color="#CCCCCC"> AMT is</font>

698
00:31:24,950 --> 00:31:30,500
<font color="#E5E5E5">provisioned</font><font color="#CCCCCC"> or any AMT related action is</font>

699
00:31:27,710 --> 00:31:31,760
performed<font color="#E5E5E5"> this is sometimes this app is</font>

700
00:31:30,500 --> 00:31:34,070
sometimes installed by default<font color="#E5E5E5"> by</font>

701
00:31:31,760 --> 00:31:36,110
manufacturers but obviously enterprises

702
00:31:34,070 --> 00:31:40,580
that<font color="#E5E5E5"> roll</font><font color="#CCCCCC"> their custom build</font><font color="#E5E5E5"> probably</font>

703
00:31:36,110 --> 00:31:43,250
wrote it<font color="#E5E5E5"> so it depends obviously</font><font color="#CCCCCC"> unknown</font>

704
00:31:40,580 --> 00:31:47,179
if users will even notice<font color="#CCCCCC"> or understand</font>

705
00:31:43,250 --> 00:31:49,160
<font color="#E5E5E5">what the little pop-ups mean</font><font color="#CCCCCC"> so again it</font>

706
00:31:47,180 --> 00:31:50,570
may<font color="#E5E5E5"> work in your favor may not and</font>

707
00:31:49,160 --> 00:31:51,310
finally as you<font color="#E5E5E5"> can see with</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> screen</font>

708
00:31:50,570 --> 00:31:54,080
<font color="#E5E5E5">shot</font>

709
00:31:51,310 --> 00:31:57,530
KVM<font color="#E5E5E5"> if you do a</font><font color="#CCCCCC"> KVM it will always</font>

710
00:31:54,080 --> 00:32:01,570
<font color="#CCCCCC">display</font><font color="#E5E5E5"> an animated sprite</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> screen to</font>

711
00:31:57,530 --> 00:32:01,570
warn the user<font color="#CCCCCC"> this cannot</font><font color="#E5E5E5"> be disabled</font>

712
00:32:03,670 --> 00:32:11,420
but on the other hand<font color="#E5E5E5"> if you're an</font>

713
00:32:08,900 --> 00:32:14,390
advanced attacker<font color="#E5E5E5"> you will probably try</font>

714
00:32:11,420 --> 00:32:17,630
and<font color="#E5E5E5"> do this when the user is asleep so</font>

715
00:32:14,390 --> 00:32:20,410
hopefully they<font color="#E5E5E5"> won't notice but the</font>

716
00:32:17,630 --> 00:32:23,030
possibility<font color="#CCCCCC"> remains for you</font>

717
00:32:20,410 --> 00:32:27,020
mitigations<font color="#E5E5E5"> what can you do to mitigate</font>

718
00:32:23,030 --> 00:32:29,389
such types of tax so the ideal is you

719
00:32:27,020 --> 00:32:31,100
<font color="#CCCCCC">have a verified boot</font><font color="#E5E5E5"> chain you bind the</font>

720
00:32:29,390 --> 00:32:33,920
hard drive<font color="#E5E5E5"> encryption keys against</font>

721
00:32:31,100 --> 00:32:38,899
correct<font color="#E5E5E5"> TPM</font><font color="#CCCCCC"> peace are values and you</font>

722
00:32:33,920 --> 00:32:40,400
have remote attestation<font color="#CCCCCC"> how does the</font>

723
00:32:38,900 --> 00:32:41,960
verified boot chain help<font color="#E5E5E5"> you can't</font>

724
00:32:40,400 --> 00:32:43,610
<font color="#E5E5E5">replace</font><font color="#CCCCCC"> a bootloader with a</font><font color="#E5E5E5"> malicious</font>

725
00:32:41,960 --> 00:32:45,140
bootloader<font color="#E5E5E5"> because the machine would no</font>

726
00:32:43,610 --> 00:32:47,899
longer boot and unlock the hard drive<font color="#CCCCCC"> so</font>

727
00:32:45,140 --> 00:32:49,520
<font color="#CCCCCC">the user will notice that someone's</font>

728
00:32:47,900 --> 00:32:50,620
booted a customer<font color="#E5E5E5"> OS and replaced bits</font>

729
00:32:49,520 --> 00:32:52,790
on<font color="#E5E5E5"> their disk</font>

730
00:32:50,620 --> 00:32:54,409
the reason it's<font color="#E5E5E5"> achievable for Windows</font>

731
00:32:52,790 --> 00:32:57,399
is because secure boot is supported and

732
00:32:54,410 --> 00:32:59,750
BitLocker is available which uses TPM

733
00:32:57,400 --> 00:33:01,280
making<font color="#E5E5E5"> sure is set up</font><font color="#CCCCCC"> correctly is a</font>

734
00:32:59,750 --> 00:33:04,490
different problem though especially<font color="#CCCCCC"> for</font>

735
00:33:01,280 --> 00:33:07,790
enterprises<font color="#CCCCCC"> for example BIOS pass first</font>

736
00:33:04,490 --> 00:33:11,080
don't exist on most laptops<font color="#E5E5E5"> so secure</font>

737
00:33:07,790 --> 00:33:13,370
boot can be disabled by the attacker

738
00:33:11,080 --> 00:33:16,970
using<font color="#E5E5E5"> AMT right you can boot it into the</font>

739
00:33:13,370 --> 00:33:19,340
<font color="#E5E5E5">BIOS disable secure boot but TPM bound</font>

740
00:33:16,970 --> 00:33:21,870
hard drive trypsin won't be bypassed and

741
00:33:19,340 --> 00:33:24,299
<font color="#E5E5E5">user will be notified</font><font color="#CCCCCC"> by</font>

742
00:33:21,870 --> 00:33:26,639
<font color="#CCCCCC">asked</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> recovery key for example and</font>

743
00:33:24,299 --> 00:33:30,110
whether the user how the user reacts

744
00:33:26,640 --> 00:33:30,110
really<font color="#E5E5E5"> depends on your enterprise</font>

745
00:33:30,409 --> 00:33:35,520
<font color="#CCCCCC">existing mitigations that</font><font color="#E5E5E5"> already</font><font color="#CCCCCC"> exist</font>

746
00:33:32,970 --> 00:33:39,150
is not<font color="#CCCCCC"> many people use land regularly</font>

747
00:33:35,520 --> 00:33:40,590
over<font color="#E5E5E5"> on their laptop enterprises that</font>

748
00:33:39,150 --> 00:33:43,289
<font color="#CCCCCC">only allow</font><font color="#E5E5E5"> internet access through a</font>

749
00:33:40,590 --> 00:33:46,289
proxy will be saved<font color="#E5E5E5"> as</font><font color="#CCCCCC"> Sarah won't work</font>

750
00:33:43,289 --> 00:33:50,840
<font color="#E5E5E5">wire proxy so if all your internet must</font>

751
00:33:46,289 --> 00:33:54,210
<font color="#E5E5E5">go through a proxy then Ceara won't work</font>

752
00:33:50,840 --> 00:33:55,889
with<font color="#E5E5E5"> using</font><font color="#CCCCCC"> KVM attackers can try avoid</font>

753
00:33:54,210 --> 00:33:58,169
using<font color="#CCCCCC"> KBM when they think people might</font>

754
00:33:55,890 --> 00:33:59,130
be<font color="#CCCCCC"> using the machine at night but like</font>

755
00:33:58,169 --> 00:34:03,390
as<font color="#CCCCCC"> i mentioned there's always a</font>

756
00:33:59,130 --> 00:34:06,840
<font color="#E5E5E5">possibility of discovery all right what</font>

757
00:34:03,390 --> 00:34:12,089
<font color="#E5E5E5">about finally how do you prevent all</font>

758
00:34:06,840 --> 00:34:18,029
such tax altogether by machines without

759
00:34:12,089 --> 00:34:20,250
<font color="#CCCCCC">AMD</font><font color="#E5E5E5"> unfortunately it's not as easy</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> it</font>

760
00:34:18,030 --> 00:34:22,710
sounds because buying for an<font color="#CCCCCC"> enterprise</font>

761
00:34:20,250 --> 00:34:24,629
is complicated because<font color="#E5E5E5"> mostly highly</font>

762
00:34:22,710 --> 00:34:27,480
spec machines come with a<font color="#CCCCCC"> MT by default</font>

763
00:34:24,629 --> 00:34:32,250
<font color="#E5E5E5">so you either downgrade your machine or</font>

764
00:34:27,480 --> 00:34:34,469
you put up with<font color="#CCCCCC"> AMT second options you</font>

765
00:34:32,250 --> 00:34:37,949
can<font color="#E5E5E5"> control the AMT so you get in there</font>

766
00:34:34,469 --> 00:34:40,138
yourself<font color="#E5E5E5"> first provision the AMT</font><font color="#CCCCCC"> and</font>

767
00:34:37,949 --> 00:34:44,428
once it's provisioned<font color="#E5E5E5"> and a</font><font color="#CCCCCC"> biased</font>

768
00:34:40,139 --> 00:34:46,290
password is set then you're good<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

769
00:34:44,429 --> 00:34:48,060
also<font color="#E5E5E5"> a lot of work because you need to</font>

770
00:34:46,290 --> 00:34:49,560
<font color="#E5E5E5">kind of sign up for enterprise rollout</font>

771
00:34:48,060 --> 00:34:51,418
<font color="#CCCCCC">or</font><font color="#E5E5E5"> management</font><font color="#CCCCCC"> so depending on</font><font color="#E5E5E5"> how big</font>

772
00:34:49,560 --> 00:34:54,199
your enterprises<font color="#E5E5E5"> this could become a</font>

773
00:34:51,418 --> 00:35:00,720
<font color="#CCCCCC">nightmare and the last option</font><font color="#E5E5E5"> is</font>

774
00:34:54,199 --> 00:35:04,259
disabled AMT and set<font color="#CCCCCC"> a</font><font color="#E5E5E5"> password so the</font>

775
00:35:00,720 --> 00:35:06,419
attacker cannot re-enable it now lots of

776
00:35:04,260 --> 00:35:08,339
<font color="#CCCCCC">vendors and</font><font color="#E5E5E5"> tooling means there's no</font>

777
00:35:06,420 --> 00:35:09,810
easy way<font color="#CCCCCC"> to do this for a whole fleet so</font>

778
00:35:08,339 --> 00:35:10,950
if you have a fleet of a thousands of

779
00:35:09,810 --> 00:35:12,290
machines<font color="#E5E5E5"> with different</font><font color="#CCCCCC"> vendors</font>

780
00:35:10,950 --> 00:35:14,669
different<font color="#E5E5E5"> os's</font>

781
00:35:12,290 --> 00:35:19,080
<font color="#CCCCCC">you're you're</font><font color="#E5E5E5"> in a bad</font><font color="#CCCCCC"> spot and that's</font>

782
00:35:14,670 --> 00:35:21,810
<font color="#E5E5E5">kind of where we</font><font color="#CCCCCC"> are it hasn't been</font>

783
00:35:19,080 --> 00:35:23,520
standard practice<font color="#CCCCCC"> to request the ability</font>

784
00:35:21,810 --> 00:35:27,830
to control all of these settings from

785
00:35:23,520 --> 00:35:30,930
the<font color="#E5E5E5"> OS so the tooling</font><font color="#CCCCCC"> that exists is</font>

786
00:35:27,830 --> 00:35:34,580
sparse and sort<font color="#E5E5E5"> of work sometimes sort</font>

787
00:35:30,930 --> 00:35:37,440
<font color="#E5E5E5">of doesn't</font><font color="#CCCCCC"> work and there's</font><font color="#E5E5E5"> no standard</font>

788
00:35:34,580 --> 00:35:40,529
<font color="#CCCCCC">as an aside</font><font color="#E5E5E5"> there's a fourth option</font>

789
00:35:37,440 --> 00:35:42,180
specifically full of novo<font color="#E5E5E5"> because</font><font color="#CCCCCC"> the</font>

790
00:35:40,530 --> 00:35:44,550
<font color="#E5E5E5">BIOS has</font><font color="#CCCCCC"> a setting called permanent</font>

791
00:35:42,180 --> 00:35:47,520
<font color="#CCCCCC">disable AMT I didn't try it because I</font>

792
00:35:44,550 --> 00:35:51,540
have no<font color="#E5E5E5"> idea what will happen</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it's</font>

793
00:35:47,520 --> 00:35:55,800
yeah<font color="#E5E5E5"> now the setting the bar</font><font color="#CCCCCC"> space word</font>

794
00:35:51,540 --> 00:35:58,080
again is is a<font color="#E5E5E5"> related</font><font color="#CCCCCC"> problem</font><font color="#E5E5E5"> to setting</font>

795
00:35:55,800 --> 00:36:02,520
the<font color="#E5E5E5"> AMT disabled or not a whole whole</font>

796
00:35:58,080 --> 00:36:04,290
fleet<font color="#E5E5E5"> you don't want the same password</font>

797
00:36:02,520 --> 00:36:05,910
on<font color="#E5E5E5"> your whole sleep because your</font>

798
00:36:04,290 --> 00:36:08,670
effectiveness<font color="#E5E5E5"> is kind</font><font color="#CCCCCC"> of reduce if it</font>

799
00:36:05,910 --> 00:36:11,879
leaks then the attacker knows it<font color="#CCCCCC"> so what</font>

800
00:36:08,670 --> 00:36:18,930
you<font color="#E5E5E5"> really want is unique passwords per</font>

801
00:36:11,880 --> 00:36:21,870
machine so password management<font color="#CCCCCC"> it feels</font>

802
00:36:18,930 --> 00:36:26,520
like the 90s<font color="#E5E5E5"> but that's where the biases</font>

803
00:36:21,870 --> 00:36:28,319
are so in short the<font color="#CCCCCC"> two real options you</font>

804
00:36:26,520 --> 00:36:29,940
have is to<font color="#CCCCCC"> either take</font><font color="#E5E5E5"> control yourself</font>

805
00:36:28,320 --> 00:36:35,220
or disable AMT<font color="#CCCCCC"> instead</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> Bart's</font>

806
00:36:29,940 --> 00:36:37,290
password finally obviously<font color="#E5E5E5"> need to make</font>

807
00:36:35,220 --> 00:36:41,910
sure<font color="#CCCCCC"> that the bias</font><font color="#E5E5E5"> actually respects the</font>

808
00:36:37,290 --> 00:36:43,980
<font color="#CCCCCC">disable choice the</font><font color="#E5E5E5"> disable setting there</font>

809
00:36:41,910 --> 00:36:46,080
was a bug with Lenovo to have<font color="#E5E5E5"> the</font>

810
00:36:43,980 --> 00:36:49,020
security advisory out from last year

811
00:36:46,080 --> 00:36:52,160
where AMT was set to<font color="#E5E5E5"> disabled but the</font>

812
00:36:49,020 --> 00:36:56,730
USB provisioning still worked so

813
00:36:52,160 --> 00:36:59,879
manufacturers<font color="#E5E5E5"> fixing bugs hopefully all</font>

814
00:36:56,730 --> 00:37:02,000
right so hopefully<font color="#CCCCCC"> you understand the</font>

815
00:36:59,880 --> 00:37:04,020
options<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have available as a defender</font>

816
00:37:02,000 --> 00:37:09,090
<font color="#CCCCCC">what about if you're an incident</font>

817
00:37:04,020 --> 00:37:11,460
responder what if someone takes over<font color="#CCCCCC"> MT</font>

818
00:37:09,090 --> 00:37:16,470
<font color="#E5E5E5">on</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> machine and you somehow detect</font>

819
00:37:11,460 --> 00:37:20,070
<font color="#E5E5E5">it what forensics options do you have</font><font color="#CCCCCC"> D</font>

820
00:37:16,470 --> 00:37:20,669
chipping is an option<font color="#E5E5E5"> but it's not very</font>

821
00:37:20,070 --> 00:37:23,910
scalable

822
00:37:20,670 --> 00:37:28,050
remember the<font color="#CCCCCC"> M II is within the chipset</font>

823
00:37:23,910 --> 00:37:29,910
<font color="#CCCCCC">so you could good-deed chip</font><font color="#E5E5E5"> but if you</font>

824
00:37:28,050 --> 00:37:32,690
have to do this on a large scale<font color="#CCCCCC"> it's</font>

825
00:37:29,910 --> 00:37:35,910
<font color="#E5E5E5">gonna get</font><font color="#CCCCCC"> very expensive very</font><font color="#E5E5E5"> quickly</font>

826
00:37:32,690 --> 00:37:38,310
the AMT<font color="#E5E5E5"> API without knowing the admin</font>

827
00:37:35,910 --> 00:37:40,080
password<font color="#E5E5E5"> is useless and since the</font>

828
00:37:38,310 --> 00:37:44,160
attacker has gotten before<font color="#E5E5E5"> you you don't</font>

829
00:37:40,080 --> 00:37:46,049
have<font color="#E5E5E5"> the admin password of course</font><font color="#CCCCCC"> we can</font>

830
00:37:44,160 --> 00:37:47,759
try the auth bypass vulnerability I

831
00:37:46,050 --> 00:37:49,950
mentioned

832
00:37:47,760 --> 00:37:53,200
assuming you haven't<font color="#E5E5E5"> passed it already</font>

833
00:37:49,950 --> 00:37:54,250
<font color="#CCCCCC">but you should</font><font color="#E5E5E5"> have passion right so</font>

834
00:37:53,200 --> 00:37:59,529
what are<font color="#CCCCCC"> your real options</font>

835
00:37:54,250 --> 00:38:02,589
I didn't the read the<font color="#CCCCCC"> way I explored</font>

836
00:37:59,530 --> 00:38:04,240
this is through<font color="#E5E5E5"> reality</font><font color="#CCCCCC"> where a plugin i</font>

837
00:38:02,589 --> 00:38:08,140
written<font color="#E5E5E5"> for an</font><font color="#CCCCCC"> internetwork scan at</font>

838
00:38:04,240 --> 00:38:13,450
<font color="#CCCCCC">google detected a</font><font color="#E5E5E5"> provisioned</font><font color="#CCCCCC"> AMT during</font>

839
00:38:08,140 --> 00:38:15,160
one of<font color="#E5E5E5"> the regular scans and I've been</font>

840
00:38:13,450 --> 00:38:17,379
<font color="#E5E5E5">passed</font><font color="#CCCCCC"> on unknown and when I talked to</font>

841
00:38:15,160 --> 00:38:22,359
<font color="#CCCCCC">the</font><font color="#E5E5E5"> owner</font><font color="#CCCCCC"> he said I don't know what this</font>

842
00:38:17,380 --> 00:38:23,920
<font color="#E5E5E5">is so we had found an AMT that was</font>

843
00:38:22,359 --> 00:38:26,529
provisioned<font color="#E5E5E5"> and we didn't know how to</font>

844
00:38:23,920 --> 00:38:31,990
get<font color="#CCCCCC"> into</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> so that's how</font><font color="#E5E5E5"> this whole</font>

845
00:38:26,530 --> 00:38:34,030
<font color="#CCCCCC">slide deck happened so some due</font>

846
00:38:31,990 --> 00:38:35,799
diligence first<font color="#E5E5E5"> a poly gov</font><font color="#CCCCCC"> mine check</font>

847
00:38:34,030 --> 00:38:37,390
<font color="#E5E5E5">network logs for everyone who ever</font>

848
00:38:35,800 --> 00:38:39,849
talked<font color="#CCCCCC"> to any of the AMT ports on that</font>

849
00:38:37,390 --> 00:38:41,799
machine<font color="#E5E5E5"> answer was all internal no an</font>

850
00:38:39,849 --> 00:38:42,190
IPS and people<font color="#E5E5E5"> nothing to I need</font><font color="#CCCCCC"> to</font>

851
00:38:41,800 --> 00:38:45,700
<font color="#E5E5E5">worry about</font>

852
00:38:42,190 --> 00:38:47,740
<font color="#CCCCCC">I collected a BIOS</font><font color="#E5E5E5"> dump using</font><font color="#CCCCCC"> ger</font>

853
00:38:45,700 --> 00:38:52,509
<font color="#E5E5E5">Sagar</font><font color="#CCCCCC"> is Google's Incident Response tool</font>

854
00:38:47,740 --> 00:38:55,000
it's open source<font color="#E5E5E5"> so it allows you to so</font>

855
00:38:52,510 --> 00:38:58,060
it has functionality<font color="#E5E5E5"> that we coded last</font>

856
00:38:55,000 --> 00:39:00,700
year to collect<font color="#CCCCCC"> BIOS dumps</font><font color="#E5E5E5"> from Linux</font>

857
00:38:58,060 --> 00:39:03,670
machines so I collected<font color="#CCCCCC"> a</font><font color="#E5E5E5"> BIOS dump and</font>

858
00:39:00,700 --> 00:39:05,529
verified<font color="#CCCCCC"> that by matching</font><font color="#E5E5E5"> it against the</font>

859
00:39:03,670 --> 00:39:07,990
official<font color="#CCCCCC"> BIOS that I obtained from the</font>

860
00:39:05,530 --> 00:39:09,970
vendor and taking them both apart using

861
00:39:07,990 --> 00:39:11,290
<font color="#CCCCCC">euphy extract that's</font><font color="#E5E5E5"> actually the</font>

862
00:39:09,970 --> 00:39:13,750
project<font color="#CCCCCC"> that I spent most</font><font color="#E5E5E5"> of my time on</font>

863
00:39:11,290 --> 00:39:16,359
last year<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the same</font><font color="#E5E5E5"> T stuff has</font>

864
00:39:13,750 --> 00:39:17,800
been<font color="#CCCCCC"> Merseyside work for me anyway the</font>

865
00:39:16,359 --> 00:39:19,750
<font color="#E5E5E5">results of</font><font color="#CCCCCC"> that comparison</font><font color="#E5E5E5"> was all good</font>

866
00:39:17,800 --> 00:39:22,960
<font color="#CCCCCC">I didn't see any anything</font><font color="#E5E5E5"> that would</font>

867
00:39:19,750 --> 00:39:23,859
look bad the<font color="#E5E5E5"> BIOS is matched nothing</font>

868
00:39:22,960 --> 00:39:29,280
nothing to worry about

869
00:39:23,859 --> 00:39:31,299
<font color="#E5E5E5">right things look good enough</font><font color="#CCCCCC"> to close</font>

870
00:39:29,280 --> 00:39:33,520
<font color="#E5E5E5">but you know you have this nagging</font>

871
00:39:31,300 --> 00:39:36,010
feeling<font color="#E5E5E5"> of well how does how did this</font>

872
00:39:33,520 --> 00:39:40,390
get provisioned if nothing suspicious

873
00:39:36,010 --> 00:39:42,849
has ever happened<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I reached out to</font>

874
00:39:40,390 --> 00:39:45,368
the AMT team and asked how I could do

875
00:39:42,849 --> 00:39:46,839
forensics<font color="#CCCCCC"> I had a quick meeting and</font>

876
00:39:45,369 --> 00:39:51,460
found out<font color="#CCCCCC"> that no one had asked about</font>

877
00:39:46,839 --> 00:39:56,440
<font color="#E5E5E5">this before</font><font color="#CCCCCC"> I was</font><font color="#E5E5E5"> pointed to a Windows</font>

878
00:39:51,460 --> 00:39:58,210
tool which can<font color="#CCCCCC"> be used to generate a</font>

879
00:39:56,440 --> 00:40:00,500
status report<font color="#E5E5E5"> of AMT</font>

880
00:39:58,210 --> 00:40:02,710
I asked about Linux since the

881
00:40:00,500 --> 00:40:05,300
lab<font color="#CCCCCC"> machinery detected was running Linux</font>

882
00:40:02,710 --> 00:40:08,480
<font color="#CCCCCC">and I didn't want our windows</font>

883
00:40:05,300 --> 00:40:10,070
specifically for justice but they don't

884
00:40:08,480 --> 00:40:13,430
have a Linux team<font color="#E5E5E5"> anymore</font>

885
00:40:10,070 --> 00:40:16,010
so there's nothing<font color="#E5E5E5"> for Linux and the</font>

886
00:40:13,430 --> 00:40:21,109
<font color="#E5E5E5">admin tool that I did test</font><font color="#CCCCCC"> just said</font><font color="#E5E5E5"> AMD</font>

887
00:40:16,010 --> 00:40:25,599
was provisioned<font color="#E5E5E5"> and I said I know so</font>

888
00:40:21,109 --> 00:40:28,880
this<font color="#CCCCCC"> is what I wanted</font><font color="#E5E5E5"> a Linux tool and</font>

889
00:40:25,599 --> 00:40:31,160
full AMT ordered<font color="#E5E5E5"> longer so</font><font color="#CCCCCC"> AMT has</font>

890
00:40:28,880 --> 00:40:34,390
<font color="#E5E5E5">built-in functionality that logs</font>

891
00:40:31,160 --> 00:40:37,549
everything<font color="#CCCCCC"> you do with it</font><font color="#E5E5E5"> amazing nice</font>

892
00:40:34,390 --> 00:40:39,680
if the lock can be<font color="#E5E5E5"> cleared by an admin</font>

893
00:40:37,550 --> 00:40:41,750
but when you clear the log it leaves the

894
00:40:39,680 --> 00:40:44,080
log entry<font color="#E5E5E5"> saying someone cleared it so</font>

895
00:40:41,750 --> 00:40:46,190
as long as<font color="#E5E5E5"> I can</font><font color="#CCCCCC"> get to this log</font>

896
00:40:44,080 --> 00:40:50,900
<font color="#E5E5E5">hopefully I can see if someone did</font>

897
00:40:46,190 --> 00:40:55,400
something<font color="#E5E5E5"> but</font><font color="#CCCCCC"> without any password I</font>

898
00:40:50,900 --> 00:40:57,500
have<font color="#CCCCCC"> zero access what I actually got was</font>

899
00:40:55,400 --> 00:40:59,690
the<font color="#CCCCCC"> Windows tool and as I said</font><font color="#E5E5E5"> it just</font>

900
00:40:57,500 --> 00:41:02,390
<font color="#E5E5E5">told me the AMT was provisioned and how</font>

901
00:40:59,690 --> 00:41:08,750
it was provisioned interesting but<font color="#CCCCCC"> not</font>

902
00:41:02,390 --> 00:41:11,390
enough in my<font color="#CCCCCC"> opinion so I spent some</font>

903
00:41:08,750 --> 00:41:14,990
<font color="#E5E5E5">time observing</font><font color="#CCCCCC"> the Windows tool and how</font>

904
00:41:11,390 --> 00:41:17,240
it worked<font color="#CCCCCC"> working at it I found out that</font>

905
00:41:14,990 --> 00:41:20,598
<font color="#CCCCCC">it was</font><font color="#E5E5E5"> calling get local system account</font>

906
00:41:17,240 --> 00:41:23,089
where the ME interface<font color="#E5E5E5"> the ME interface</font>

907
00:41:20,599 --> 00:41:27,140
is exposed by<font color="#CCCCCC"> a driver</font><font color="#E5E5E5"> that interfaces</font>

908
00:41:23,089 --> 00:41:29,150
with<font color="#E5E5E5"> the Intel</font><font color="#CCCCCC"> Emme what I</font><font color="#E5E5E5"> learned was</font>

909
00:41:27,140 --> 00:41:31,960
there is a built-in AMT user called<font color="#CCCCCC"> Dola</font>

910
00:41:29,150 --> 00:41:35,470
<font color="#CCCCCC">Dola</font><font color="#E5E5E5"> OS admin which has limited access</font>

911
00:41:31,960 --> 00:41:38,320
<font color="#E5E5E5">and this get local system account</font>

912
00:41:35,470 --> 00:41:41,209
<font color="#E5E5E5">retrieved the password for that user</font>

913
00:41:38,320 --> 00:41:44,420
<font color="#CCCCCC">the password is randomly</font><font color="#E5E5E5"> generated</font><font color="#CCCCCC"> at</font>

914
00:41:41,210 --> 00:41:46,820
each boot<font color="#E5E5E5"> max once every 24 hours and</font>

915
00:41:44,420 --> 00:41:48,410
the account<font color="#CCCCCC"> that account cannot be</font>

916
00:41:46,820 --> 00:41:52,280
disabled and<font color="#E5E5E5"> the password cannot be</font>

917
00:41:48,410 --> 00:41:53,750
controlled<font color="#CCCCCC"> that user doesn't</font><font color="#E5E5E5"> have</font>

918
00:41:52,280 --> 00:41:56,450
anywhere near the same<font color="#CCCCCC"> level of</font><font color="#E5E5E5"> access</font>

919
00:41:53,750 --> 00:41:58,400
as<font color="#CCCCCC"> the admin user it's meant to</font><font color="#E5E5E5"> be used</font>

920
00:41:56,450 --> 00:42:00,259
for<font color="#CCCCCC"> the OS for local provisioning</font><font color="#E5E5E5"> so</font>

921
00:41:58,400 --> 00:42:01,700
this is how when you have<font color="#E5E5E5"> an OS agent</font>

922
00:42:00,260 --> 00:42:04,640
and you try<font color="#E5E5E5"> and do a local provisioning</font>

923
00:42:01,700 --> 00:42:09,560
it uses<font color="#E5E5E5"> this user to set up move to</font>

924
00:42:04,640 --> 00:42:14,220
client<font color="#E5E5E5"> control mode so I said about</font>

925
00:42:09,560 --> 00:42:16,230
replicating<font color="#E5E5E5"> this to Linux</font><font color="#CCCCCC"> thankfully the</font>

926
00:42:14,220 --> 00:42:20,540
<font color="#E5E5E5">me interface driver is already in Linux</font>

927
00:42:16,230 --> 00:42:23,970
<font color="#CCCCCC">mainline so dev slash slash dev slash</font><font color="#E5E5E5"> ME</font>

928
00:42:20,540 --> 00:42:27,119
<font color="#CCCCCC">ME I is where you can talk to the</font><font color="#E5E5E5"> ME</font>

929
00:42:23,970 --> 00:42:29,700
interface need ioctl to talk to it<font color="#E5E5E5"> I</font>

930
00:42:27,119 --> 00:42:34,440
wrote some quick Python hack to retrieve

931
00:42:29,700 --> 00:42:37,500
the credentials doing ioctl using<font color="#E5E5E5"> Python</font>

932
00:42:34,440 --> 00:42:38,940
<font color="#E5E5E5">was not one of my best moments</font><font color="#CCCCCC"> I was</font>

933
00:42:37,500 --> 00:42:40,349
very desperate for a solution at<font color="#CCCCCC"> that</font>

934
00:42:38,940 --> 00:42:42,480
time so this this whole process<font color="#E5E5E5"> from</font>

935
00:42:40,349 --> 00:42:43,770
<font color="#CCCCCC">start to end</font><font color="#E5E5E5"> took</font><font color="#CCCCCC"> two weeks</font><font color="#E5E5E5"> and I was</font>

936
00:42:42,480 --> 00:42:45,869
getting<font color="#E5E5E5"> more and more</font><font color="#CCCCCC"> desperate</font><font color="#E5E5E5"> tomorrow</font>

937
00:42:43,770 --> 00:42:50,340
<font color="#E5E5E5">I was trying to figure out why what was</font>

938
00:42:45,869 --> 00:42:52,800
happening with this machine<font color="#CCCCCC"> I managed</font><font color="#E5E5E5"> to</font>

939
00:42:50,340 --> 00:42:56,849
<font color="#E5E5E5">get the password</font><font color="#CCCCCC"> 4.4</font><font color="#E5E5E5"> the OSS admin</font>

940
00:42:52,800 --> 00:42:58,710
account<font color="#E5E5E5"> but it didn't work</font><font color="#CCCCCC"> I read a bit</font>

941
00:42:56,849 --> 00:43:00,720
<font color="#CCCCCC">more</font><font color="#E5E5E5"> and one of the limitations of the</font>

942
00:42:58,710 --> 00:43:04,020
admin account is also<font color="#E5E5E5"> that it only works</font>

943
00:43:00,720 --> 00:43:07,439
locally so using the credentials to<font color="#E5E5E5"> call</font>

944
00:43:04,020 --> 00:43:10,009
the AMT<font color="#E5E5E5"> API over network doesn't</font><font color="#CCCCCC"> work</font>

945
00:43:07,440 --> 00:43:12,869
it seems like a good security<font color="#E5E5E5"> measure</font>

946
00:43:10,010 --> 00:43:15,630
but the OS if you remember earlier<font color="#CCCCCC"> can't</font>

947
00:43:12,869 --> 00:43:17,430
talk to the AMT directly because<font color="#E5E5E5"> the</font>

948
00:43:15,630 --> 00:43:20,390
<font color="#E5E5E5">network packets are stolen directly off</font>

949
00:43:17,430 --> 00:43:23,160
the<font color="#E5E5E5"> hardware adapter by AMT so when you</font>

950
00:43:20,390 --> 00:43:25,799
try<font color="#CCCCCC"> and talk via the OS through the</font>

951
00:43:23,160 --> 00:43:27,899
loopback address the OS never touches

952
00:43:25,800 --> 00:43:29,849
<font color="#E5E5E5">hardware and so therefore AMT never sees</font>

953
00:43:27,900 --> 00:43:33,180
those packets so you<font color="#CCCCCC"> someone have</font><font color="#E5E5E5"> to get</font>

954
00:43:29,849 --> 00:43:37,430
to hardware from<font color="#E5E5E5"> locally so this is this</font>

955
00:43:33,180 --> 00:43:38,629
<font color="#E5E5E5">is</font><font color="#CCCCCC"> where it</font><font color="#E5E5E5"> gets fun so what next</font><font color="#CCCCCC"> I</font>

956
00:43:37,430 --> 00:43:40,919
[Music]

957
00:43:38,630 --> 00:43:44,880
found out that what I needed<font color="#E5E5E5"> was the</font>

958
00:43:40,920 --> 00:43:47,099
local manageability service here so what

959
00:43:44,880 --> 00:43:51,599
it does is it exposes all the AMT never

960
00:43:47,099 --> 00:43:53,339
<font color="#CCCCCC">puts</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> localhost</font><font color="#E5E5E5"> and it's done via the</font>

961
00:43:51,599 --> 00:43:58,589
ami interface through some other api's

962
00:43:53,339 --> 00:44:01,589
so obviously there is<font color="#E5E5E5"> the software is</font>

963
00:43:58,589 --> 00:44:03,270
available<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Windows nothing for Linux</font>

964
00:44:01,589 --> 00:44:05,400
<font color="#CCCCCC">well actually not nothing for Linux</font>

965
00:44:03,270 --> 00:44:08,730
<font color="#E5E5E5">there it was open sourced</font><font color="#CCCCCC"> a few years</font>

966
00:44:05,400 --> 00:44:11,310
ago<font color="#E5E5E5"> but not maintained</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> I was able to</font>

967
00:44:08,730 --> 00:44:16,940
use it<font color="#E5E5E5"> with</font><font color="#CCCCCC"> a few</font><font color="#E5E5E5"> minor</font><font color="#CCCCCC"> adjustments and</font>

968
00:44:11,310 --> 00:44:19,920
<font color="#E5E5E5">proceed so we're</font><font color="#CCCCCC"> truing</font><font color="#E5E5E5"> AMT audit log</font>

969
00:44:16,940 --> 00:44:22,170
building<font color="#E5E5E5"> the local manageability service</font>

970
00:44:19,920 --> 00:44:24,150
on<font color="#CCCCCC"> linux required a minor fixes</font><font color="#E5E5E5"> patch</font>

971
00:44:22,170 --> 00:44:25,740
for getting it to build is part of<font color="#CCCCCC"> the</font>

972
00:44:24,150 --> 00:44:27,599
<font color="#CCCCCC">repository that's</font><font color="#E5E5E5"> being open sourced</font>

973
00:44:25,740 --> 00:44:29,729
<font color="#CCCCCC">here the bugs</font><font color="#E5E5E5"> were pretty</font>

974
00:44:27,599 --> 00:44:30,989
minor<font color="#E5E5E5"> but I didn't have anywhere to</font>

975
00:44:29,729 --> 00:44:32,489
report them since it's<font color="#E5E5E5"> not really</font>

976
00:44:30,989 --> 00:44:36,479
<font color="#CCCCCC">maintained it is it's just</font><font color="#E5E5E5"> a zip file on</font>

977
00:44:32,489 --> 00:44:38,460
<font color="#CCCCCC">a</font><font color="#E5E5E5"> website</font><font color="#CCCCCC"> not a good</font><font color="#E5E5E5"> rapper</font><font color="#CCCCCC"> I did</font>

978
00:44:36,479 --> 00:44:42,029
<font color="#CCCCCC">eventually succeed in dumping the full</font>

979
00:44:38,460 --> 00:44:44,579
audit log using<font color="#E5E5E5"> the creds through LMS so</font>

980
00:44:42,029 --> 00:44:47,999
the way it worked was<font color="#E5E5E5"> I ran my Python</font>

981
00:44:44,579 --> 00:44:50,579
hack which got me<font color="#E5E5E5"> the</font><font color="#CCCCCC"> password for the</font>

982
00:44:47,999 --> 00:44:53,339
<font color="#CCCCCC">Dola Dola OS admin account</font><font color="#E5E5E5"> then I</font>

983
00:44:50,579 --> 00:44:56,069
started<font color="#E5E5E5"> the LMS service and then I</font>

984
00:44:53,339 --> 00:44:58,499
talked<font color="#E5E5E5"> to that LMS service and supplied</font>

985
00:44:56,069 --> 00:45:01,170
the the<font color="#E5E5E5"> username and password</font><font color="#CCCCCC"> and now I</font>

986
00:44:58,499 --> 00:45:02,939
was<font color="#E5E5E5"> able to make the API calls and then</font>

987
00:45:01,170 --> 00:45:06,089
now I<font color="#E5E5E5"> can make the API call to retrieve</font>

988
00:45:02,940 --> 00:45:07,769
the<font color="#CCCCCC"> AMT</font><font color="#E5E5E5"> audit log thankfully the empty</font>

989
00:45:06,089 --> 00:45:13,558
order log was readable<font color="#E5E5E5"> by that user I</font>

990
00:45:07,769 --> 00:45:16,200
didn't have to be admin so the<font color="#E5E5E5"> audit log</font>

991
00:45:13,559 --> 00:45:19,049
records that<font color="#E5E5E5"> I did get a 64 encoded the</font>

992
00:45:16,200 --> 00:45:20,149
decoding the string<font color="#CCCCCC"> revealed it</font><font color="#E5E5E5"> was it</font>

993
00:45:19,049 --> 00:45:22,589
seemed<font color="#E5E5E5"> mostly garbage</font>

994
00:45:20,150 --> 00:45:26,729
<font color="#E5E5E5">mostly because I could see words like</font>

995
00:45:22,589 --> 00:45:27,960
admin so there was there was<font color="#CCCCCC"> some kind</font>

996
00:45:26,729 --> 00:45:30,569
<font color="#CCCCCC">of a struct here that I didn't</font>

997
00:45:27,960 --> 00:45:34,349
understand it was<font color="#CCCCCC"> there's some ASCII</font>

998
00:45:30,569 --> 00:45:36,058
readable words and some struts<font color="#CCCCCC"> no public</font>

999
00:45:34,349 --> 00:45:39,809
documentation<font color="#E5E5E5"> on</font><font color="#CCCCCC"> what that boasts</font>

1000
00:45:36,059 --> 00:45:40,619
<font color="#E5E5E5">basically for string was so Google</font>

1001
00:45:39,809 --> 00:45:44,940
failed me

1002
00:45:40,619 --> 00:45:52,380
I continued digging<font color="#E5E5E5"> I think I had a few</font>

1003
00:45:44,940 --> 00:45:54,299
more meetings<font color="#E5E5E5"> and then eventually I got</font>

1004
00:45:52,380 --> 00:45:59,819
desperate<font color="#E5E5E5"> and I started</font><font color="#CCCCCC"> reading the</font><font color="#E5E5E5"> AMT</font>

1005
00:45:54,299 --> 00:46:01,920
SDK so<font color="#CCCCCC"> AMT</font><font color="#E5E5E5"> SDK is a massive zip I think</font>

1006
00:45:59,819 --> 00:46:03,900
is 200 Meg's

1007
00:46:01,920 --> 00:46:07,469
it's meant to<font color="#E5E5E5"> contain simple code for</font>

1008
00:46:03,900 --> 00:46:10,229
all API calls<font color="#CCCCCC"> I was hoping to find hints</font>

1009
00:46:07,469 --> 00:46:12,089
<font color="#CCCCCC">on pausing the audit log records so I</font>

1010
00:46:10,229 --> 00:46:17,669
unzipped it and I went he grabbed<font color="#E5E5E5"> our</font>

1011
00:46:12,089 --> 00:46:20,130
audit log bad idea hundreds<font color="#E5E5E5"> and hundreds</font>

1012
00:46:17,670 --> 00:46:21,900
of matches I think I spent at least two

1013
00:46:20,130 --> 00:46:25,019
<font color="#E5E5E5">three days just digging</font><font color="#CCCCCC"> through the the</font>

1014
00:46:21,900 --> 00:46:28,680
<font color="#CCCCCC">MT SDK four layers</font><font color="#E5E5E5"> of indirection later</font>

1015
00:46:25,019 --> 00:46:30,089
<font color="#E5E5E5">I did</font><font color="#CCCCCC"> eventually found the strop but it</font>

1016
00:46:28,680 --> 00:46:33,839
was called<font color="#CCCCCC"> something very generic</font><font color="#E5E5E5"> it had</font>

1017
00:46:30,089 --> 00:46:36,808
nothing<font color="#E5E5E5"> to do with a</font><font color="#CCCCCC"> handheld lock but</font>

1018
00:46:33,839 --> 00:46:38,249
the reference for<font color="#E5E5E5"> that struct is in the</font>

1019
00:46:36,809 --> 00:46:39,660
repository I'm open sourcing so you

1020
00:46:38,249 --> 00:46:41,839
don't have<font color="#E5E5E5"> to spend the same amount of</font>

1021
00:46:39,660 --> 00:46:41,839
time

1022
00:46:42,540 --> 00:46:48,859
so and getting those structured occurred

1023
00:46:46,950 --> 00:46:51,779
was actually also very painful<font color="#E5E5E5"> because</font>

1024
00:46:48,859 --> 00:46:53,190
<font color="#E5E5E5">the field lens within the structs were</font>

1025
00:46:51,780 --> 00:46:55,890
being<font color="#E5E5E5"> used to indicate whether the next</font>

1026
00:46:53,190 --> 00:46:58,920
<font color="#E5E5E5">field existed so the Python</font><font color="#CCCCCC"> script that</font>

1027
00:46:55,890 --> 00:47:00,779
I wrote<font color="#E5E5E5"> to decode from basic stiffer</font>

1028
00:46:58,920 --> 00:47:03,030
<font color="#CCCCCC">four into the</font><font color="#E5E5E5"> structure and into</font>

1029
00:47:00,780 --> 00:47:04,980
<font color="#E5E5E5">something readable is which is being</font>

1030
00:47:03,030 --> 00:47:06,740
open sources it's quite painful<font color="#E5E5E5"> as</font>

1031
00:47:04,980 --> 00:47:11,520
you'll see

1032
00:47:06,740 --> 00:47:14,069
so findings this<font color="#E5E5E5"> is the spin show of the</font>

1033
00:47:11,520 --> 00:47:17,450
actual audit<font color="#E5E5E5"> log from the machine that</font>

1034
00:47:14,069 --> 00:47:17,450
took two<font color="#CCCCCC"> weeks away from me</font>

1035
00:47:19,609 --> 00:47:24,150
according to inventory<font color="#E5E5E5"> Google received</font>

1036
00:47:22,380 --> 00:47:27,960
this machine on the 27th of September

1037
00:47:24,150 --> 00:47:30,329
2016 but according<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the audit log and</font>

1038
00:47:27,960 --> 00:47:36,119
the<font color="#CCCCCC"> provision record the AMT was set up</font>

1039
00:47:30,329 --> 00:47:42,680
<font color="#E5E5E5">on the 23rd of January 2015</font><font color="#CCCCCC"> so factory</font>

1040
00:47:36,119 --> 00:47:46,079
mistake shipment interception but

1041
00:47:42,680 --> 00:47:47,640
nothing suspicious in<font color="#CCCCCC"> the audit log the</font>

1042
00:47:46,079 --> 00:47:50,099
<font color="#E5E5E5">old</font><font color="#CCCCCC"> log match the network logs that we</font>

1043
00:47:47,640 --> 00:47:52,200
detect<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we already tried so the</font>

1044
00:47:50,099 --> 00:47:54,329
external<font color="#E5E5E5"> network logs matched the audit</font>

1045
00:47:52,200 --> 00:47:56,250
<font color="#E5E5E5">the audit log from within the</font><font color="#CCCCCC"> MDM</font><font color="#E5E5E5"> he</font>

1046
00:47:54,329 --> 00:48:01,250
logged every<font color="#E5E5E5"> login attempt that</font><font color="#CCCCCC"> he had</font>

1047
00:47:56,250 --> 00:48:03,660
seen<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> ip's everything matched</font><font color="#E5E5E5"> so</font>

1048
00:48:01,250 --> 00:48:05,130
<font color="#CCCCCC">everything's good</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> safe to close</font>

1049
00:48:03,660 --> 00:48:08,910
the<font color="#CCCCCC"> investigation this is</font><font color="#E5E5E5"> this is as far</font>

1050
00:48:05,130 --> 00:48:10,950
<font color="#CCCCCC">as you go</font><font color="#E5E5E5"> guys I still had the nagging</font>

1051
00:48:08,910 --> 00:48:12,660
feeling of well still<font color="#CCCCCC"> lied doesn't</font>

1052
00:48:10,950 --> 00:48:14,609
explain<font color="#CCCCCC"> the full story right like we</font>

1053
00:48:12,660 --> 00:48:16,200
have a year gap or had how<font color="#E5E5E5"> did we get a</font>

1054
00:48:14,609 --> 00:48:21,950
machine<font color="#E5E5E5"> ship to us that was provisioned</font>

1055
00:48:16,200 --> 00:48:21,950
<font color="#E5E5E5">one year before we received it</font><font color="#CCCCCC"> so</font>

1056
00:48:30,090 --> 00:48:34,500
since we never<font color="#E5E5E5"> want to leave any leaves</font>

1057
00:48:32,340 --> 00:48:36,480
unturned<font color="#CCCCCC"> I emailed the</font><font color="#E5E5E5"> machine vendor</font>

1058
00:48:34,500 --> 00:48:42,990
asking for history before<font color="#CCCCCC"> we received it</font>

1059
00:48:36,480 --> 00:48:46,200
at Google<font color="#CCCCCC"> 26 emails and two more weeks</font>

1060
00:48:42,990 --> 00:48:49,859
later we find out the machine was

1061
00:48:46,200 --> 00:48:52,129
<font color="#CCCCCC">actually received in 2013</font><font color="#E5E5E5"> but it was</font>

1062
00:48:49,860 --> 00:48:54,660
received<font color="#E5E5E5"> as part</font><font color="#CCCCCC"> of a</font><font color="#E5E5E5"> Linux test lab</font>

1063
00:48:52,130 --> 00:48:56,700
where they were<font color="#E5E5E5"> testing the hardware to</font>

1064
00:48:54,660 --> 00:48:59,990
make sure that we could use it<font color="#E5E5E5"> therefore</font>

1065
00:48:56,700 --> 00:49:04,370
<font color="#CCCCCC">it was</font><font color="#E5E5E5"> not part of standard inventory</font>

1066
00:48:59,990 --> 00:49:08,459
<font color="#E5E5E5">and the way they used it in the test lab</font>

1067
00:49:04,370 --> 00:49:14,690
was by<font color="#E5E5E5"> setting up</font><font color="#CCCCCC"> IMT</font><font color="#E5E5E5"> and doing remote</font>

1068
00:49:08,460 --> 00:49:17,760
installs<font color="#CCCCCC"> and on the 27th of</font><font color="#E5E5E5"> September</font>

1069
00:49:14,690 --> 00:49:19,460
2016<font color="#E5E5E5"> is</font><font color="#CCCCCC"> when it was</font><font color="#E5E5E5"> no longer</font><font color="#CCCCCC"> needed in</font>

1070
00:49:17,760 --> 00:49:21,900
the<font color="#CCCCCC"> lab and it was moved</font><font color="#E5E5E5"> to normal</font>

1071
00:49:19,460 --> 00:49:23,790
inventory pool and then it was lent<font color="#E5E5E5"> out</font>

1072
00:49:21,900 --> 00:49:27,960
to someone else<font color="#E5E5E5"> and during that process</font>

1073
00:49:23,790 --> 00:49:32,910
<font color="#E5E5E5">the</font><font color="#CCCCCC"> AMT</font><font color="#E5E5E5"> was not disabled that's what my</font>

1074
00:49:27,960 --> 00:49:35,070
<font color="#CCCCCC">network scan picked up</font><font color="#E5E5E5"> so at the end it</font>

1075
00:49:32,910 --> 00:49:38,730
turned out to be<font color="#E5E5E5"> four weeks of waste for</font>

1076
00:49:35,070 --> 00:49:44,250
nothing<font color="#CCCCCC"> it's a lesson for next</font><font color="#E5E5E5"> time was</font>

1077
00:49:38,730 --> 00:49:46,110
actually inventories hard so next<font color="#E5E5E5"> time</font>

1078
00:49:44,250 --> 00:49:47,370
<font color="#E5E5E5">when I have this case I first thing I do</font>

1079
00:49:46,110 --> 00:49:49,470
is track<font color="#CCCCCC"> down what the machines been</font>

1080
00:49:47,370 --> 00:49:53,220
first because<font color="#CCCCCC"> it probably was part of</font>

1081
00:49:49,470 --> 00:49:57,839
<font color="#E5E5E5">the Linux test lab anyway that</font><font color="#CCCCCC"> concludes</font>

1082
00:49:53,220 --> 00:49:59,609
my<font color="#E5E5E5"> forensic story</font><font color="#CCCCCC"> since</font><font color="#E5E5E5"> writing this</font>

1083
00:49:57,840 --> 00:50:03,900
presentation is new things that<font color="#E5E5E5"> I've</font>

1084
00:49:59,610 --> 00:50:08,910
<font color="#E5E5E5">learned for an Intel</font><font color="#CCCCCC"> micro LMS is an</font>

1085
00:50:03,900 --> 00:50:10,500
alternative<font color="#E5E5E5"> to LMS</font><font color="#CCCCCC"> the source and</font>

1086
00:50:08,910 --> 00:50:13,069
<font color="#E5E5E5">Windows tunnel and boundaries available</font>

1087
00:50:10,500 --> 00:50:15,480
<font color="#E5E5E5">so these are actually quite quite small</font>

1088
00:50:13,070 --> 00:50:18,600
mesh commander has in save old state

1089
00:50:15,480 --> 00:50:20,250
option<font color="#E5E5E5"> which is useful for from a</font>

1090
00:50:18,600 --> 00:50:22,560
forensics perspective you can say you

1091
00:50:20,250 --> 00:50:24,420
<font color="#E5E5E5">can make all API calls</font><font color="#CCCCCC"> to empty</font><font color="#E5E5E5"> and save</font>

1092
00:50:22,560 --> 00:50:26,190
it<font color="#E5E5E5"> then you can look through it</font><font color="#CCCCCC"> yourself</font>

1093
00:50:24,420 --> 00:50:30,510
<font color="#CCCCCC">later on and try</font><font color="#E5E5E5"> and figure out if</font><font color="#CCCCCC"> that</font>

1094
00:50:26,190 --> 00:50:35,100
<font color="#CCCCCC">gives</font><font color="#E5E5E5"> you some more info and Intel is</font>

1095
00:50:30,510 --> 00:50:37,710
also now looking<font color="#CCCCCC"> at</font><font color="#E5E5E5"> exposing the audit</font>

1096
00:50:35,100 --> 00:50:40,589
log directly wired eme interface<font color="#E5E5E5"> without</font>

1097
00:50:37,710 --> 00:50:42,950
needing<font color="#CCCCCC"> user name and password to</font><font color="#E5E5E5"> access</font>

1098
00:50:40,590 --> 00:50:42,950
it

1099
00:50:44,140 --> 00:50:49,040
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> once light or quick slide on this</font>

1100
00:50:47,060 --> 00:50:51,170
<font color="#E5E5E5">recovery what are your options</font><font color="#CCCCCC"> after</font>

1101
00:50:49,040 --> 00:50:52,850
<font color="#CCCCCC">compromise in forensic is done so you</font>

1102
00:50:51,170 --> 00:50:55,390
<font color="#CCCCCC">did have a real compromise</font><font color="#E5E5E5"> you have</font>

1103
00:50:52,850 --> 00:51:01,480
finished forensics now what do you<font color="#E5E5E5"> do</font>

1104
00:50:55,390 --> 00:51:03,379
how do you<font color="#E5E5E5"> recover the machine depends</font>

1105
00:51:01,480 --> 00:51:04,940
so without knowing<font color="#E5E5E5"> the admin password</font>

1106
00:51:03,380 --> 00:51:07,370
<font color="#CCCCCC">you cannot run provision</font>

1107
00:51:04,940 --> 00:51:09,200
programmatically<font color="#E5E5E5"> with the dollar dollar</font>

1108
00:51:07,370 --> 00:51:13,310
<font color="#E5E5E5">OS admin account it does not have enough</font>

1109
00:51:09,200 --> 00:51:16,700
right<font color="#CCCCCC"> -</font><font color="#E5E5E5"> unproven so it really depends</font><font color="#CCCCCC"> on</font>

1110
00:51:13,310 --> 00:51:20,570
<font color="#E5E5E5">the vendor if they have a bias menu</font>

1111
00:51:16,700 --> 00:51:22,370
option<font color="#E5E5E5"> - unconfigured AMT or not if they</font>

1112
00:51:20,570 --> 00:51:24,640
<font color="#CCCCCC">don't then I guess you</font><font color="#E5E5E5"> have to reach out</font>

1113
00:51:22,370 --> 00:51:28,910
<font color="#E5E5E5">to them and ask</font><font color="#CCCCCC"> for something</font>

1114
00:51:24,640 --> 00:51:29,930
unfortunately this<font color="#E5E5E5"> I was</font><font color="#CCCCCC"> hoping that you</font>

1115
00:51:28,910 --> 00:51:34,759
could<font color="#CCCCCC"> do something here</font><font color="#E5E5E5"> but</font>

1116
00:51:29,930 --> 00:51:37,279
unfortunately<font color="#CCCCCC"> there isn't</font><font color="#E5E5E5"> okay so</font>

1117
00:51:34,760 --> 00:51:40,190
finally in short we can<font color="#CCCCCC"> say that</font>

1118
00:51:37,280 --> 00:51:42,980
attacking<font color="#CCCCCC"> attacked in using AMT is</font>

1119
00:51:40,190 --> 00:51:45,230
possible detection<font color="#E5E5E5"> prevention is</font>

1120
00:51:42,980 --> 00:51:48,020
difficult although mitigation is

1121
00:51:45,230 --> 00:51:50,600
achievable<font color="#CCCCCC"> and lastly forensics is</font>

1122
00:51:48,020 --> 00:51:52,880
reliable<font color="#E5E5E5"> so what I found with forensics</font>

1123
00:51:50,600 --> 00:51:57,080
team that was frustrating<font color="#CCCCCC"> I had high</font>

1124
00:51:52,880 --> 00:52:00,020
<font color="#E5E5E5">level of trust in what I got back as a</font>

1125
00:51:57,080 --> 00:52:01,370
<font color="#CCCCCC">takeaway I would highly recommend going</font>

1126
00:52:00,020 --> 00:52:03,610
<font color="#CCCCCC">through my suggestions from the</font>

1127
00:52:01,370 --> 00:52:05,900
detection mitigation prevention slides

1128
00:52:03,610 --> 00:52:08,410
to see which of<font color="#E5E5E5"> them you</font><font color="#CCCCCC"> can apply for</font>

1129
00:52:05,900 --> 00:52:10,550
<font color="#E5E5E5">your</font><font color="#CCCCCC"> own personal or company situation</font>

1130
00:52:08,410 --> 00:52:13,310
so things to look at is detection

1131
00:52:10,550 --> 00:52:15,980
<font color="#E5E5E5">network or a West level mitigation so</font>

1132
00:52:13,310 --> 00:52:17,600
start working<font color="#CCCCCC"> a verified boot it will</font>

1133
00:52:15,980 --> 00:52:19,820
help<font color="#E5E5E5"> with other attack vectors</font><font color="#CCCCCC"> - not</font>

1134
00:52:17,600 --> 00:52:21,680
<font color="#E5E5E5">just a</font><font color="#CCCCCC"> mt and lastly prevention so</font>

1135
00:52:19,820 --> 00:52:24,890
either provision<font color="#E5E5E5"> aim to yourself or</font>

1136
00:52:21,680 --> 00:52:25,910
disable<font color="#CCCCCC"> a MT set bias password</font><font color="#E5E5E5"> or don't</font>

1137
00:52:24,890 --> 00:52:29,240
<font color="#CCCCCC">buy AMT machines</font>

1138
00:52:25,910 --> 00:52:30,830
<font color="#E5E5E5">ah thank you for listening if you have</font>

1139
00:52:29,240 --> 00:52:33,129
any thoughts<font color="#CCCCCC"> on what</font><font color="#E5E5E5"> I can do next</font><font color="#CCCCCC"> happy</font>

1140
00:52:30,830 --> 00:52:33,130
to hear

1141
00:52:36,869 --> 00:52:45,579
so thank you bars anyone has any

1142
00:52:39,760 --> 00:52:47,760
questions<font color="#CCCCCC"> I have</font><font color="#E5E5E5"> to do this quick so</font><font color="#CCCCCC"> I</font>

1143
00:52:45,579 --> 00:52:50,500
<font color="#E5E5E5">can set up</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> nest egg next session</font>

1144
00:52:47,760 --> 00:52:53,200
thanks for your talk doesn't be a<font color="#CCCCCC"> knife</font>

1145
00:52:50,500 --> 00:52:55,210
question if you hijack the<font color="#CCCCCC"> amt</font><font color="#E5E5E5"> can you</font>

1146
00:52:53,200 --> 00:52:57,430
<font color="#E5E5E5">believe I the code of the emitters</font>

1147
00:52:55,210 --> 00:52:59,770
outside<font color="#CCCCCC"> EMT</font><font color="#E5E5E5"> and in particular can you</font>

1148
00:52:57,430 --> 00:53:02,828
modify<font color="#E5E5E5"> the code that</font><font color="#CCCCCC"> SGX will rely on</font>

1149
00:52:59,770 --> 00:53:04,930
like<font color="#E5E5E5"> the</font><font color="#CCCCCC"> trusted counter and the not to</font>

1150
00:53:02,829 --> 00:53:07,990
<font color="#E5E5E5">the aim do you know so the Emmy code is</font>

1151
00:53:04,930 --> 00:53:10,750
signed<font color="#E5E5E5"> so and the empty doesn't give you</font>

1152
00:53:07,990 --> 00:53:12,759
any control any API calls<font color="#E5E5E5"> no legitimate</font>

1153
00:53:10,750 --> 00:53:15,309
API calls<font color="#CCCCCC"> exists</font><font color="#E5E5E5"> to let you talk</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

1154
00:53:12,760 --> 00:53:16,660
<font color="#CCCCCC">Emmy there's no way to serve</font><font color="#E5E5E5"> bread to</font>

1155
00:53:15,309 --> 00:53:25,780
talk to the<font color="#E5E5E5"> bread HDX</font>

1156
00:53:16,660 --> 00:53:30,038
<font color="#E5E5E5">if you control the AMT no thank you what</font>

1157
00:53:25,780 --> 00:53:41,950
most question you can<font color="#E5E5E5"> always ask me</font>

1158
00:53:30,039 --> 00:53:45,609
<font color="#E5E5E5">later last question so you</font><font color="#CCCCCC"> mentioned</font>

1159
00:53:41,950 --> 00:53:48,640
<font color="#CCCCCC">that you can for example provision</font><font color="#E5E5E5"> your</font>

1160
00:53:45,609 --> 00:53:50,619
own server<font color="#E5E5E5"> and for as a mitigation</font>

1161
00:53:48,640 --> 00:53:53,410
factor<font color="#E5E5E5"> so is it</font>

1162
00:53:50,619 --> 00:53:55,630
how<font color="#E5E5E5"> does</font><font color="#CCCCCC"> AMT store</font><font color="#E5E5E5"> like variable</font>

1163
00:53:53,410 --> 00:53:57,670
settings or<font color="#E5E5E5"> everything is it possible</font>

1164
00:53:55,630 --> 00:54:00,130
for<font color="#CCCCCC"> example for me to</font><font color="#E5E5E5"> dump the SPI and</font>

1165
00:53:57,670 --> 00:54:02,319
replace like password hashes<font color="#E5E5E5"> or I</font><font color="#CCCCCC"> don't</font>

1166
00:54:00,130 --> 00:54:04,119
<font color="#E5E5E5">know replace the server so it would</font>

1167
00:54:02,319 --> 00:54:06,730
point to my own if I<font color="#CCCCCC"> have physical</font>

1168
00:54:04,119 --> 00:54:09,279
<font color="#E5E5E5">access is it possible for me to replace</font>

1169
00:54:06,730 --> 00:54:13,180
those things or<font color="#CCCCCC"> not so</font><font color="#E5E5E5"> that's actually</font>

1170
00:54:09,279 --> 00:54:14,890
multi-layered question<font color="#E5E5E5"> so variables are</font>

1171
00:54:13,180 --> 00:54:18,910
stored<font color="#E5E5E5"> as part</font><font color="#CCCCCC"> of the Emmy settings and</font>

1172
00:54:14,890 --> 00:54:20,170
that's an encrypted image<font color="#E5E5E5"> you can</font>

1173
00:54:18,910 --> 00:54:21,848
<font color="#CCCCCC">reverse-engineer it but there's no easy</font>

1174
00:54:20,170 --> 00:54:25,000
way<font color="#CCCCCC"> to do it if you</font><font color="#E5E5E5"> dump the SPI flash</font>

1175
00:54:21,849 --> 00:54:26,770
<font color="#CCCCCC">so as a setting itself</font><font color="#E5E5E5"> you can change</font>

1176
00:54:25,000 --> 00:54:27,880
that easily<font color="#E5E5E5"> you don't</font><font color="#CCCCCC"> have to go to the</font>

1177
00:54:26,770 --> 00:54:30,609
<font color="#E5E5E5">SPI flash level right</font>

1178
00:54:27,880 --> 00:54:34,180
I mean<font color="#E5E5E5"> it's through the bias menu you</font>

1179
00:54:30,609 --> 00:54:36,520
<font color="#E5E5E5">can just change it</font><font color="#CCCCCC"> as in the server</font>

1180
00:54:34,180 --> 00:54:40,328
itself the<font color="#CCCCCC"> web server itself</font><font color="#E5E5E5"> as as in</font>

1181
00:54:36,520 --> 00:54:43,299
the code<font color="#CCCCCC"> of it</font><font color="#E5E5E5"> replacing it again it's</font>

1182
00:54:40,329 --> 00:54:44,770
not really legitimately possible<font color="#E5E5E5"> so</font>

1183
00:54:43,299 --> 00:54:46,089
unless<font color="#E5E5E5"> you find a vulnerability that</font>

1184
00:54:44,770 --> 00:54:49,150
allows you<font color="#E5E5E5"> to bypass the encryption</font>

1185
00:54:46,089 --> 00:54:52,710
<font color="#E5E5E5">checks that</font><font color="#CCCCCC"> Emmy does</font>

1186
00:54:49,150 --> 00:54:54,970
so hopefully<font color="#E5E5E5"> that answers your question</font>

1187
00:54:52,710 --> 00:54:56,130
okay thank you<font color="#CCCCCC"> bars</font><font color="#E5E5E5"> thank you everyone</font>

1188
00:54:54,970 --> 00:55:00,448
<font color="#CCCCCC">thank</font><font color="#E5E5E5"> you</font>

1189
00:54:56,130 --> 00:55:00,449
[Applause]

