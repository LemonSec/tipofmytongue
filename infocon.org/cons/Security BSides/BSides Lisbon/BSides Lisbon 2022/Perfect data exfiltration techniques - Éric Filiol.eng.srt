1
00:00:01,680 --> 00:00:04,680
foreign

2
00:00:06,660 --> 00:00:08,820
so I'm very pleased to be here to

3
00:00:08,820 --> 00:00:12,000
present the it is the very last part of

4
00:00:12,000 --> 00:00:15,120
a research performed during two years

5
00:00:15,120 --> 00:00:16,940
and I would like to thank

6
00:00:16,940 --> 00:00:20,699
the besides Lisbon team for inviting me

7
00:00:20,699 --> 00:00:23,520
to to present this research work

8
00:00:23,520 --> 00:00:26,100
so it deals with how to explain trade

9
00:00:26,100 --> 00:00:29,220
data in a way that you are sure that you

10
00:00:29,220 --> 00:00:32,180
can never be detected

11
00:00:33,239 --> 00:00:36,600
so I'm sorry uh my Linus computer was

12
00:00:36,600 --> 00:00:39,120
not working with the video so there is

13
00:00:39,120 --> 00:00:41,520
one demo that I will not be able to do

14
00:00:41,520 --> 00:00:43,320
but if you are interested I can do the

15
00:00:43,320 --> 00:00:48,079
demo on my computer right after the talk

16
00:00:48,239 --> 00:00:49,700
so I probably

17
00:00:49,700 --> 00:00:53,160
agenda I will first explain the

18
00:00:53,160 --> 00:00:54,840
different state of the art and

19
00:00:54,840 --> 00:00:58,260
non-technic to exfiltrate data

20
00:00:58,260 --> 00:01:00,960
or to protect that app because the bus

21
00:01:00,960 --> 00:01:04,379
issues are connected then I will present

22
00:01:04,379 --> 00:01:08,820
how to make a malware very difficult to

23
00:01:08,820 --> 00:01:10,320
say impossible to

24
00:01:10,320 --> 00:01:11,000
um

25
00:01:11,000 --> 00:01:14,220
to analyze it is the first initial step

26
00:01:14,220 --> 00:01:17,100
in order to deploy the actual texture

27
00:01:17,100 --> 00:01:20,240
techniques and I will explain how to

28
00:01:20,240 --> 00:01:22,439
bypass all data leak prevention

29
00:01:22,439 --> 00:01:25,439
technique and I will conclude

30
00:01:25,439 --> 00:01:26,580
so

31
00:01:26,580 --> 00:01:29,820
nowadays must attack are using

32
00:01:29,820 --> 00:01:32,759
performing data exploration and for

33
00:01:32,759 --> 00:01:36,479
example logbeat 3.0 the most unknown

34
00:01:36,479 --> 00:01:39,840
case quite systematically they they put

35
00:01:39,840 --> 00:01:42,680
pressure on the victim by

36
00:01:42,680 --> 00:01:45,420
threatening to publish data that they

37
00:01:45,420 --> 00:01:48,600
have collected so it can be just a few

38
00:01:48,600 --> 00:01:51,420
credentials but it can be also a

39
00:01:51,420 --> 00:01:54,600
complete a complete database

40
00:01:54,600 --> 00:01:57,479
so depending on the the environment it

41
00:01:57,479 --> 00:01:58,920
is more or less difficult

42
00:01:58,920 --> 00:02:03,299
so the the most difficult case when you

43
00:02:03,299 --> 00:02:06,960
consider air gap environment so they are

44
00:02:06,960 --> 00:02:10,739
not connected so the some techniques are

45
00:02:10,739 --> 00:02:13,620
known but generally the the amount of

46
00:02:13,620 --> 00:02:15,959
data that you can accelerate is very

47
00:02:15,959 --> 00:02:19,920
limited and you can just enforce a very

48
00:02:19,920 --> 00:02:23,040
low data rate so it is just efficient to

49
00:02:23,040 --> 00:02:25,800
exercise for example a few credentials

50
00:02:25,800 --> 00:02:28,640
but whenever you are connected

51
00:02:28,640 --> 00:02:31,379
I mean in a network environment it's

52
00:02:31,379 --> 00:02:34,739
it's more easy and whatever may be the

53
00:02:34,739 --> 00:02:37,140
protocol considered

54
00:02:37,140 --> 00:02:38,580
so

55
00:02:38,580 --> 00:02:41,280
um but you have generally two

56
00:02:41,280 --> 00:02:44,099
um bypass the different traffic

57
00:02:44,099 --> 00:02:46,680
surveillance and in most industrial

58
00:02:46,680 --> 00:02:49,080
cases it is Data League prevention tools

59
00:02:49,080 --> 00:02:52,080
for example in Azure Microsoft Azure

60
00:02:52,080 --> 00:02:54,300
environment

61
00:02:54,300 --> 00:02:57,420
but when when you succeed it is possible

62
00:02:57,420 --> 00:03:01,319
to accelerate a large amount of data

63
00:03:01,319 --> 00:03:03,260
huge databases

64
00:03:03,260 --> 00:03:06,300
at a very high data rate acceleration

65
00:03:06,300 --> 00:03:07,500
rate

66
00:03:07,500 --> 00:03:10,560
and generally the target environment are

67
00:03:10,560 --> 00:03:13,220
the low

68
00:03:13,379 --> 00:03:18,780
or medium awareness about this and

69
00:03:18,780 --> 00:03:21,750
most dlps are not able to really

70
00:03:21,750 --> 00:03:23,239
[Music]

71
00:03:23,239 --> 00:03:26,220
prevent data exploitation

72
00:03:26,220 --> 00:03:28,980
but the aim of the talk is to show that

73
00:03:28,980 --> 00:03:32,220
even if we we would have very efficient

74
00:03:32,220 --> 00:03:36,060
DLP it will be there will be they could

75
00:03:36,060 --> 00:03:38,040
be defeated very easily

76
00:03:38,040 --> 00:03:42,299
so from the defender perspective you can

77
00:03:42,299 --> 00:03:45,480
perform two actions

78
00:03:45,480 --> 00:03:47,760
the first one is the most most common

79
00:03:47,760 --> 00:03:51,860
one you generate is an automated or

80
00:03:51,860 --> 00:03:55,459
semi-automated analysis what we call DLP

81
00:03:55,459 --> 00:03:59,640
but especially in the postmortem step

82
00:03:59,640 --> 00:04:01,700
you can be

83
00:04:01,700 --> 00:04:05,400
you can wish to perform a manual

84
00:04:05,400 --> 00:04:07,920
analysis of the document that are

85
00:04:07,920 --> 00:04:10,260
currently accelerated so we have to deal

86
00:04:10,260 --> 00:04:12,360
with these two issues and we will show

87
00:04:12,360 --> 00:04:16,459
how to solve them

88
00:04:17,399 --> 00:04:19,320
so

89
00:04:19,320 --> 00:04:21,418
from the attack of perspective once

90
00:04:21,418 --> 00:04:23,400
again he has to consider then two

91
00:04:23,400 --> 00:04:23,820
different

92
00:04:23,820 --> 00:04:25,340
[Music]

93
00:04:25,340 --> 00:04:30,770
approach or he will launch very common

94
00:04:30,770 --> 00:04:32,479
[Music]

95
00:04:32,479 --> 00:04:36,419
attacks not specifically a targeted

96
00:04:36,419 --> 00:04:37,500
attack

97
00:04:37,500 --> 00:04:39,960
because it is supposing that only

98
00:04:39,960 --> 00:04:43,160
automated detection will be in place

99
00:04:43,160 --> 00:04:48,360
or you can consider a various targeting

100
00:04:48,360 --> 00:04:51,600
attack typically apt attacks

101
00:04:51,600 --> 00:04:54,720
uh and in this case you have to consider

102
00:04:54,720 --> 00:04:56,759
that the manual analysis will be

103
00:04:56,759 --> 00:04:58,919
possible and you have to defeat it as

104
00:04:58,919 --> 00:04:59,820
well

105
00:04:59,820 --> 00:05:03,000
so in this talk we will uh I will focus

106
00:05:03,000 --> 00:05:05,160
on the connecting environment but

107
00:05:05,160 --> 00:05:07,500
everything can be applied to air gap

108
00:05:07,500 --> 00:05:10,199
environment and if you if you wish to

109
00:05:10,199 --> 00:05:12,300
have more information about the air gap

110
00:05:12,300 --> 00:05:14,520
environment I can see give you

111
00:05:14,520 --> 00:05:16,500
references

112
00:05:16,500 --> 00:05:20,340
so in fact there are as most attacks you

113
00:05:20,340 --> 00:05:22,940
are first to deploy your malware

114
00:05:22,940 --> 00:05:27,000
uh and then the malware we will be able

115
00:05:27,000 --> 00:05:30,180
to First Scott their environment make

116
00:05:30,180 --> 00:05:31,460
analysis

117
00:05:31,460 --> 00:05:34,380
uh study the environment in order to

118
00:05:34,380 --> 00:05:37,139
adapt to the environment and to prevent

119
00:05:37,139 --> 00:05:40,820
these analysis and ease detection

120
00:05:41,940 --> 00:05:43,800
and of course

121
00:05:43,800 --> 00:05:46,680
even if the malware is is cooked and

122
00:05:46,680 --> 00:05:51,360
analyzed it must not reveal the exact uh

123
00:05:51,360 --> 00:05:53,400
the actual nature of the attack it must

124
00:05:53,400 --> 00:05:57,120
pull the analyst and it will be part of

125
00:05:57,120 --> 00:05:59,880
the of the problem to solve

126
00:05:59,880 --> 00:06:02,520
so

127
00:06:02,520 --> 00:06:06,180
we have a two two-fold issues we have

128
00:06:06,180 --> 00:06:07,979
two fold issues in fact the attacker has

129
00:06:07,979 --> 00:06:11,360
to consider the different Challenge

130
00:06:11,360 --> 00:06:14,220
and the issues to solve

131
00:06:14,220 --> 00:06:16,800
so you can have semantic detection most

132
00:06:16,800 --> 00:06:19,139
of the time it is keywords

133
00:06:19,139 --> 00:06:22,800
or even Behavior profile

134
00:06:22,800 --> 00:06:25,639
the data can be

135
00:06:25,639 --> 00:06:28,199
encrypted but the encryption is very

136
00:06:28,199 --> 00:06:32,039
easy to detect I will explain why

137
00:06:32,039 --> 00:06:32,880
um

138
00:06:32,880 --> 00:06:35,819
the attacker can use an encryption key

139
00:06:35,819 --> 00:06:38,819
in order to to encrypt this data but you

140
00:06:38,819 --> 00:06:41,100
have to manage a secret key which is not

141
00:06:41,100 --> 00:06:43,199
very easy especially when you have to

142
00:06:43,199 --> 00:06:46,080
accelerate mini document

143
00:06:46,080 --> 00:06:49,860
you can be you have uh or you have to

144
00:06:49,860 --> 00:06:52,020
face the fact that for example you can

145
00:06:52,020 --> 00:06:54,780
actually trade data only through ipsec

146
00:06:54,780 --> 00:06:57,539
Channel and the attacker has not the

147
00:06:57,539 --> 00:06:59,759
control of the APC channel so how to

148
00:06:59,759 --> 00:07:02,360
extrate data

149
00:07:02,360 --> 00:07:06,060
despite the fact that there is uh such a

150
00:07:06,060 --> 00:07:09,060
protection

151
00:07:09,300 --> 00:07:12,860
if you want to accelerate many data

152
00:07:12,860 --> 00:07:15,419
techniques like steganography are not

153
00:07:15,419 --> 00:07:17,280
possible because of the embedding rate

154
00:07:17,280 --> 00:07:19,979
the acceleration rate is very very low

155
00:07:19,979 --> 00:07:22,199
less than three percent

156
00:07:22,199 --> 00:07:25,020
and you have also to consider the user's

157
00:07:25,020 --> 00:07:27,960
baby viewer because

158
00:07:27,960 --> 00:07:30,300
um the amount of data the frequency of

159
00:07:30,300 --> 00:07:33,120
acceleration can also be a detection

160
00:07:33,120 --> 00:07:35,520
criteria

161
00:07:35,520 --> 00:07:38,759
so on the defender side he has to try to

162
00:07:38,759 --> 00:07:40,800
solve all these issues but with the

163
00:07:40,800 --> 00:07:43,979
defender perspective of course

164
00:07:43,979 --> 00:07:47,039
so as far as the issue uh the fourth

165
00:07:47,039 --> 00:07:49,199
issue I will not I will not have time to

166
00:07:49,199 --> 00:07:51,539
present it but you can refer to my talk

167
00:07:51,539 --> 00:07:54,780
at cancer Quest and we have updated a

168
00:07:54,780 --> 00:07:58,080
new ipsec IO Hardware uh in order to

169
00:07:58,080 --> 00:08:00,720
adapt the attacking is still work fully

170
00:08:00,720 --> 00:08:04,880
so we can effectively accelerate data

171
00:08:04,880 --> 00:08:09,479
in order to despite the the existence of

172
00:08:09,479 --> 00:08:12,060
the ipsec channel where just to monitor

173
00:08:12,060 --> 00:08:14,220
the IPC Channel and to make a

174
00:08:14,220 --> 00:08:19,099
statistical analysis so it's possible

175
00:08:19,199 --> 00:08:20,400
so

176
00:08:20,400 --> 00:08:22,560
you can

177
00:08:22,560 --> 00:08:25,020
you can ask yourself why such a study is

178
00:08:25,020 --> 00:08:27,660
this not to to build attacks of course

179
00:08:27,660 --> 00:08:31,440
but I think the attacker perspective

180
00:08:31,440 --> 00:08:34,979
always enabled to be aware of the risk

181
00:08:34,979 --> 00:08:37,799
and to try to find Solutions

182
00:08:37,799 --> 00:08:40,320
and there are possible applications that

183
00:08:40,320 --> 00:08:43,700
are not related to attacks

184
00:08:43,700 --> 00:08:47,160
I will of course for for sake of clarity

185
00:08:47,160 --> 00:08:50,820
present unitary break but of course you

186
00:08:50,820 --> 00:08:51,779
can

187
00:08:51,779 --> 00:08:54,240
put all together to have something very

188
00:08:54,240 --> 00:08:55,920
sophisticated

189
00:08:55,920 --> 00:08:58,920
so for

190
00:08:58,920 --> 00:09:01,019
for a reason that you will well

191
00:09:01,019 --> 00:09:03,240
understand the old codes and proof of

192
00:09:03,240 --> 00:09:05,760
concepts are not public but technical

193
00:09:05,760 --> 00:09:08,399
papers explaining that will be and the

194
00:09:08,399 --> 00:09:11,220
slides will be made public

195
00:09:11,220 --> 00:09:12,300
so

196
00:09:12,300 --> 00:09:14,519
what are the different known technique

197
00:09:14,519 --> 00:09:17,760
as far as information protection is

198
00:09:17,760 --> 00:09:20,180
concerned and of course

199
00:09:20,180 --> 00:09:25,560
is related issues a data exfiltration

200
00:09:25,560 --> 00:09:28,800
in fact I I have taken the NATO

201
00:09:28,800 --> 00:09:31,019
terminology you have two ways of

202
00:09:31,019 --> 00:09:33,240
protecting information you have what we

203
00:09:33,240 --> 00:09:35,580
call Concept communication security

204
00:09:35,580 --> 00:09:37,220
so you just

205
00:09:37,220 --> 00:09:40,260
protect the information but not the fact

206
00:09:40,260 --> 00:09:41,839
that you are exchanging

207
00:09:41,839 --> 00:09:44,279
sensitive information

208
00:09:44,279 --> 00:09:47,580
so most of the time it is performed by

209
00:09:47,580 --> 00:09:51,540
cryptography but also you have to for in

210
00:09:51,540 --> 00:09:54,120
some industrial case which are very

211
00:09:54,120 --> 00:09:56,040
sensitive you have also to add physical

212
00:09:56,040 --> 00:09:57,320
security

213
00:09:57,320 --> 00:10:01,800
or even to fight against electromagnetic

214
00:10:01,800 --> 00:10:04,800
emissions

215
00:10:05,640 --> 00:10:09,360
but if you exchange encrypted data of

216
00:10:09,360 --> 00:10:12,060
course it's very easy to detect

217
00:10:12,060 --> 00:10:15,660
so the other way is to perform to add

218
00:10:15,660 --> 00:10:18,660
Transaction Transmission security you

219
00:10:18,660 --> 00:10:20,880
not only protect the information but

220
00:10:20,880 --> 00:10:23,399
also the channel the communication

221
00:10:23,399 --> 00:10:26,339
Channel it means that in fact you hide

222
00:10:26,339 --> 00:10:27,839
the fact that you are currently

223
00:10:27,839 --> 00:10:30,360
exchanging sensitive data

224
00:10:30,360 --> 00:10:33,240
so if you look at the transmission it

225
00:10:33,240 --> 00:10:35,940
looks very it is innocent looking you

226
00:10:35,940 --> 00:10:36,800
cannot

227
00:10:36,800 --> 00:10:38,940
discriminate between

228
00:10:38,940 --> 00:10:41,640
to communication one being really

229
00:10:41,640 --> 00:10:44,820
innocent the other one transmitting

230
00:10:44,820 --> 00:10:47,220
sensitive data and the most known

231
00:10:47,220 --> 00:10:51,120
technique is steganography

232
00:10:51,120 --> 00:10:54,000
so in the technique I am going to

233
00:10:54,000 --> 00:10:55,680
present to you of course which we we

234
00:10:55,680 --> 00:10:57,779
intend to combine bossages to protect

235
00:10:57,779 --> 00:10:59,700
the information but also the fact that

236
00:10:59,700 --> 00:11:04,100
we are currently exfiltrating data

237
00:11:04,920 --> 00:11:07,440
so if we compare from the technical

238
00:11:07,440 --> 00:11:09,180
point of view the difference between

239
00:11:09,180 --> 00:11:12,180
cryptography and steganography

240
00:11:12,180 --> 00:11:16,560
uh between commsec and tronsec in in

241
00:11:16,560 --> 00:11:19,200
cryptography you just transform your

242
00:11:19,200 --> 00:11:22,680
plain text into a random text and to to

243
00:11:22,680 --> 00:11:25,620
go to to be able to go back to the plain

244
00:11:25,620 --> 00:11:28,079
text you must know a secret key

245
00:11:28,079 --> 00:11:30,839
so you have issues related to Security

246
00:11:30,839 --> 00:11:34,160
Management and so on

247
00:11:34,220 --> 00:11:37,019
and of course accessing the plain text

248
00:11:37,019 --> 00:11:40,740
without the key must be complex and

249
00:11:40,740 --> 00:11:44,760
invisible in in a final time

250
00:11:44,760 --> 00:11:47,180
um on the right side you have a

251
00:11:47,180 --> 00:11:49,800
steganography so that are of course

252
00:11:49,800 --> 00:11:52,920
encrypted so it is a consec part but

253
00:11:52,920 --> 00:11:55,560
your encrypted data will be embedded in

254
00:11:55,560 --> 00:11:57,720
in a covert image

255
00:11:57,720 --> 00:12:00,779
after the the embedding it is not

256
00:12:00,779 --> 00:12:03,300
possible to it is supposed not to be

257
00:12:03,300 --> 00:12:05,040
possible to make the difference between

258
00:12:05,040 --> 00:12:08,820
the image before insertion and after

259
00:12:08,820 --> 00:12:10,980
insertion

260
00:12:10,980 --> 00:12:13,440
and after that of course the answer is

261
00:12:13,440 --> 00:12:15,480
the embedding process is also key

262
00:12:15,480 --> 00:12:17,399
secretly dependent

263
00:12:17,399 --> 00:12:21,240
then you send the image and you reverse

264
00:12:21,240 --> 00:12:23,519
all the process

265
00:12:23,519 --> 00:12:25,860
and in the history of Tourism for

266
00:12:25,860 --> 00:12:29,120
example Al-Qaeda used to

267
00:12:29,120 --> 00:12:31,279
steganography to exchange

268
00:12:31,279 --> 00:12:34,920
since the sensitive data it was a

269
00:12:34,920 --> 00:12:37,320
limited use but it is it has proven to

270
00:12:37,320 --> 00:12:39,300
be the case

271
00:12:39,300 --> 00:12:42,120
so when we compare these two techniques

272
00:12:42,120 --> 00:12:46,260
what are the relative Security in fact

273
00:12:46,260 --> 00:12:48,959
in both cases the detection is rather

274
00:12:48,959 --> 00:12:50,100
easy

275
00:12:50,100 --> 00:12:52,860
uh on the left to detect cryptography

276
00:12:52,860 --> 00:12:55,279
for example here you have a case

277
00:12:55,279 --> 00:12:59,100
of the analysis of a binary Windows

278
00:12:59,100 --> 00:13:03,360
binary file which is partly encrypted

279
00:13:03,360 --> 00:13:07,380
and we use what we call entropy entropy

280
00:13:07,380 --> 00:13:09,720
is the amount of uncertainty or

281
00:13:09,720 --> 00:13:14,339
Randomness if you prefer of data so for

282
00:13:14,339 --> 00:13:16,560
all the code which is non-encrypted the

283
00:13:16,560 --> 00:13:19,019
entropy is Resolute and whenever you

284
00:13:19,019 --> 00:13:21,360
have a peak it means yeah that you have

285
00:13:21,360 --> 00:13:26,040
a crypto and the entropy which is

286
00:13:26,040 --> 00:13:29,459
denoted by H in fact normal data

287
00:13:29,459 --> 00:13:31,139
whatever maybe the language is around

288
00:13:31,139 --> 00:13:32,160
four

289
00:13:32,160 --> 00:13:34,860
uh if you have packed compressed data

290
00:13:34,860 --> 00:13:37,620
for example packed binaries you will

291
00:13:37,620 --> 00:13:40,260
reach six and encrypted data you have

292
00:13:40,260 --> 00:13:43,139
the maximum per character eight

293
00:13:43,139 --> 00:13:46,019
so it is very easy to detect that you

294
00:13:46,019 --> 00:13:47,540
are currently transferring or

295
00:13:47,540 --> 00:13:50,060
externating

296
00:13:50,060 --> 00:13:53,459
encrypted data as far as technography is

297
00:13:53,459 --> 00:13:56,040
concerned you have on the left

298
00:13:56,040 --> 00:13:59,420
so in fact this this

299
00:13:59,420 --> 00:14:04,019
drawing shows shows two points that that

300
00:14:04,019 --> 00:14:06,839
in fact whenever you go beyond three

301
00:14:06,839 --> 00:14:09,060
percent of the export or bits for

302
00:14:09,060 --> 00:14:12,180
example the the most the least

303
00:14:12,180 --> 00:14:15,600
significant bit in a JPEG image and

304
00:14:15,600 --> 00:14:17,540
fight beyond the three percent

305
00:14:17,540 --> 00:14:20,100
uh there are efficient techniques we are

306
00:14:20,100 --> 00:14:21,899
able to detect to make the difference to

307
00:14:21,899 --> 00:14:24,060
discriminate between a normal image and

308
00:14:24,060 --> 00:14:26,339
that steganography image

309
00:14:26,339 --> 00:14:27,899
and

310
00:14:27,899 --> 00:14:31,079
if you consider the number n of the

311
00:14:31,079 --> 00:14:33,360
possible usable between order to embed

312
00:14:33,360 --> 00:14:37,260
data you can use only a square root of n

313
00:14:37,260 --> 00:14:39,959
so it means that the exfiltrating a

314
00:14:39,959 --> 00:14:42,180
large amount of data is quite impossible

315
00:14:42,180 --> 00:14:43,920
with this cryptography without being

316
00:14:43,920 --> 00:14:45,120
detected

317
00:14:45,120 --> 00:14:49,199
so even for for few a set of a few

318
00:14:49,199 --> 00:14:51,079
credentials

319
00:14:51,079 --> 00:14:53,339
the use of staggerography is not

320
00:14:53,339 --> 00:14:55,560
recommended because because you will be

321
00:14:55,560 --> 00:14:56,820
detected

322
00:14:56,820 --> 00:15:00,660
so is there another solution yes

323
00:15:00,660 --> 00:15:04,860
so it comes from what we call magicus

324
00:15:04,860 --> 00:15:06,899
cryptography and cryptology and

325
00:15:06,899 --> 00:15:09,720
Mathematics in fact it is an emerging

326
00:15:09,720 --> 00:15:12,240
field I work on this field for for many

327
00:15:12,240 --> 00:15:14,880
years and it can be defined at the

328
00:15:14,880 --> 00:15:17,420
interconnection of

329
00:15:17,420 --> 00:15:20,339
all the attack techniques

330
00:15:20,339 --> 00:15:22,380
with cryptological mathematics in order

331
00:15:22,380 --> 00:15:25,199
to enrich them each other

332
00:15:25,199 --> 00:15:28,079
so there are a lot of application a lot

333
00:15:28,079 --> 00:15:32,180
of not all not all uh

334
00:15:32,180 --> 00:15:36,120
attacks you can use it for legitimate

335
00:15:36,120 --> 00:15:38,399
protection so the development is super

336
00:15:38,399 --> 00:15:41,480
malware and you have a lot of

337
00:15:41,480 --> 00:15:44,459
mathematical theories that enable to

338
00:15:44,459 --> 00:15:48,899
build actual malware that are very

339
00:15:48,899 --> 00:15:50,639
difficult to detect not to say

340
00:15:50,639 --> 00:15:53,060
impossible

341
00:15:53,279 --> 00:15:54,839
so

342
00:15:54,839 --> 00:15:58,920
and you can also to to perform Crypt

343
00:15:58,920 --> 00:16:01,019
analysis for example to steal secret key

344
00:16:01,019 --> 00:16:03,480
you can use malware so it is the case

345
00:16:03,480 --> 00:16:06,000
where malware can be used in order to do

346
00:16:06,000 --> 00:16:08,760
what we call apply Crypt analysis

347
00:16:08,760 --> 00:16:11,760
to make Recon for example

348
00:16:11,760 --> 00:16:14,579
um thanks to to mathematical properties

349
00:16:14,579 --> 00:16:18,740
we were able to to design and build code

350
00:16:18,740 --> 00:16:22,500
that were that we are able to detect on

351
00:16:22,500 --> 00:16:24,959
which kind of processor

352
00:16:24,959 --> 00:16:27,740
um there were there were

353
00:16:27,740 --> 00:16:33,600
executed and to decide to activate uh or

354
00:16:33,600 --> 00:16:37,800
not the illegitimate the malware part

355
00:16:37,800 --> 00:16:40,620
in fact you have to compute mathematical

356
00:16:40,620 --> 00:16:42,860
functions and depending on the result

357
00:16:42,860 --> 00:16:45,800
you will know whether you are on the

358
00:16:45,800 --> 00:16:48,199
given class of

359
00:16:48,199 --> 00:16:51,480
Intel processor or arm and so on we are

360
00:16:51,480 --> 00:16:54,000
able to discriminate very precisely the

361
00:16:54,000 --> 00:16:57,899
different kind of processor families and

362
00:16:57,899 --> 00:17:02,100
ultimately it is possible to to to use

363
00:17:02,100 --> 00:17:05,579
mathematics in order to to build block

364
00:17:05,579 --> 00:17:08,459
ciphers with the trapdoors encryption

365
00:17:08,459 --> 00:17:12,799
ciphers with trap doors and in

366
00:17:12,799 --> 00:17:16,380
2019 I was a beside to present algorithm

367
00:17:16,380 --> 00:17:17,839
with propdos

368
00:17:17,839 --> 00:17:21,540
and if you want you can go to to talks

369
00:17:21,540 --> 00:17:23,280
at blackout Europe you have published

370
00:17:23,280 --> 00:17:26,099
and designed and published an algorithm

371
00:17:26,099 --> 00:17:28,740
which is very similar to the AES the

372
00:17:28,740 --> 00:17:31,320
international standard and there is a

373
00:17:31,320 --> 00:17:34,020
trapdoor and in less at 30 seconds you

374
00:17:34,020 --> 00:17:37,860
are able to break and find the key so

375
00:17:37,860 --> 00:17:39,960
malicious cryptography and Mathematics

376
00:17:39,960 --> 00:17:42,299
must be considered in cyber security

377
00:17:42,299 --> 00:17:45,179
because it is a power of mathematics and

378
00:17:45,179 --> 00:17:47,760
cryptology to the service and to the

379
00:17:47,760 --> 00:17:50,840
benefit of attackers

380
00:17:51,419 --> 00:17:54,660
so the first part is to use a malware

381
00:17:54,660 --> 00:17:59,160
but malware can be detected can be

382
00:17:59,160 --> 00:18:03,419
analyzed and the reverse engineer can

383
00:18:03,419 --> 00:18:04,880
understand

384
00:18:04,880 --> 00:18:08,580
more or less quickly what the malware

385
00:18:08,580 --> 00:18:11,700
actually do that's

386
00:18:11,700 --> 00:18:13,080
so

387
00:18:13,080 --> 00:18:16,500
the the main tool is what we call

388
00:18:16,500 --> 00:18:19,740
non-trivial denable cryptography the

389
00:18:19,740 --> 00:18:21,900
enabled cryptography is not for a long

390
00:18:21,900 --> 00:18:25,559
time but only a travel case called

391
00:18:25,559 --> 00:18:30,059
one-time pads was not until now

392
00:18:30,059 --> 00:18:32,760
so in fact it consists to to take a

393
00:18:32,760 --> 00:18:35,640
random two random sequencies random

394
00:18:35,640 --> 00:18:38,880
sequencies and adding to the text and

395
00:18:38,880 --> 00:18:41,039
you have two random sequencies each

396
00:18:41,039 --> 00:18:45,120
producing a different plain text from

397
00:18:45,120 --> 00:18:47,940
the same ciphertext but of course if you

398
00:18:47,940 --> 00:18:50,400
have a very long ciphertext it's not

399
00:18:50,400 --> 00:18:53,400
practical because you are first to embed

400
00:18:53,400 --> 00:18:56,240
the random sequence in the malware code

401
00:18:56,240 --> 00:18:59,720
so the the key will be leaked and and

402
00:18:59,720 --> 00:19:02,520
compromised during the reverse

403
00:19:02,520 --> 00:19:05,460
engineering step and it is not practical

404
00:19:05,460 --> 00:19:07,500
so

405
00:19:07,500 --> 00:19:08,880
um

406
00:19:08,880 --> 00:19:11,340
last year we have found a practical

407
00:19:11,340 --> 00:19:14,280
solution which is non-trivial and in

408
00:19:14,280 --> 00:19:16,440
fact we consider we still consider a

409
00:19:16,440 --> 00:19:18,240
ciphertext n

410
00:19:18,240 --> 00:19:20,940
a unique algorithm

411
00:19:20,940 --> 00:19:24,720
and two different plain text P1 and P2

412
00:19:24,720 --> 00:19:28,080
and we implemented the framework which

413
00:19:28,080 --> 00:19:32,039
is able to build the algorithm e on the

414
00:19:32,039 --> 00:19:35,419
fly it takes only a few seconds

415
00:19:35,419 --> 00:19:39,059
and we don't need this time very long

416
00:19:39,059 --> 00:19:41,220
keys keys as long as the cipher takes

417
00:19:41,220 --> 00:19:43,320
but very short keys

418
00:19:43,320 --> 00:19:47,640
so from 128 to 256 bits which is

419
00:19:47,640 --> 00:19:49,320
currently the standard for the key size

420
00:19:49,320 --> 00:19:51,960
in secret cryptography

421
00:19:51,960 --> 00:19:56,059
so e the algorithm e must be

422
00:19:56,059 --> 00:19:58,200
deterministic so it may be a stream

423
00:19:58,200 --> 00:20:00,299
Cipher or block Cipher we're currently

424
00:20:00,299 --> 00:20:02,820
working on Black ciphero Version

425
00:20:02,820 --> 00:20:05,960
it must be supposed to be public it

426
00:20:05,960 --> 00:20:09,360
means that even if all crypto analysts

427
00:20:09,360 --> 00:20:13,380
of the world try to analyze it it should

428
00:20:13,380 --> 00:20:15,780
be not be possible to break the

429
00:20:15,780 --> 00:20:16,799
algorithm

430
00:20:16,799 --> 00:20:19,860
and of course the the secret key is far

431
00:20:19,860 --> 00:20:22,020
smaller than the size of the ciphertext

432
00:20:22,020 --> 00:20:23,880
which is was very important condition

433
00:20:23,880 --> 00:20:26,820
for operation security

434
00:20:26,820 --> 00:20:29,880
so we discard completely one time better

435
00:20:29,880 --> 00:20:31,919
and we have the following equation from

436
00:20:31,919 --> 00:20:34,559
the same Cipher text depending on the

437
00:20:34,559 --> 00:20:38,360
key I use I will obtain two different

438
00:20:38,360 --> 00:20:40,320
plain text

439
00:20:40,320 --> 00:20:42,720
so

440
00:20:42,720 --> 00:20:45,600
it seems to be theoretical let's say how

441
00:20:45,600 --> 00:20:47,760
to apply this in our context

442
00:20:47,760 --> 00:20:49,860
and of course I have chosen two plain

443
00:20:49,860 --> 00:20:53,100
texts but could extend two three four or

444
00:20:53,100 --> 00:20:55,500
five different blend texts it can be

445
00:20:55,500 --> 00:20:57,120
generalized

446
00:20:57,120 --> 00:21:00,120
so here you have the the security

447
00:21:00,120 --> 00:21:03,120
analysis so we support that uh from the

448
00:21:03,120 --> 00:21:05,760
side vertex C we cannot guess P1 and P2

449
00:21:05,760 --> 00:21:09,299
and even if you and we have P1 we cannot

450
00:21:09,299 --> 00:21:13,620
we cannot guess P2 or conversely it is a

451
00:21:13,620 --> 00:21:15,480
security assumption and condition for

452
00:21:15,480 --> 00:21:16,679
the security

453
00:21:16,679 --> 00:21:18,960
so of course I'm going to present the

454
00:21:18,960 --> 00:21:21,419
the use in the context of malware but

455
00:21:21,419 --> 00:21:25,200
there are a lot of legitimate

456
00:21:25,200 --> 00:21:26,280
applications

457
00:21:26,280 --> 00:21:29,100
we have developed with the research and

458
00:21:29,100 --> 00:21:30,960
development company so the code

459
00:21:30,960 --> 00:21:33,179
protection not only malware but also

460
00:21:33,179 --> 00:21:35,240
also legitimate program

461
00:21:35,240 --> 00:21:37,440
anti-force the techniques and we are

462
00:21:37,440 --> 00:21:40,020
currently working on Multi Communication

463
00:21:40,020 --> 00:21:41,640
channel you have only one encrypted

464
00:21:41,640 --> 00:21:44,100
Channel but depending on the key you can

465
00:21:44,100 --> 00:21:47,460
access to one or two channels of

466
00:21:47,460 --> 00:21:49,980
communication so for the demo I will not

467
00:21:49,980 --> 00:21:52,620
be able to do it now but right after the

468
00:21:52,620 --> 00:21:55,620
talk I can online other computer I can

469
00:21:55,620 --> 00:21:57,480
show you

470
00:21:57,480 --> 00:22:00,120
so we have the application on our

471
00:22:00,120 --> 00:22:01,500
context

472
00:22:01,500 --> 00:22:03,360
we have

473
00:22:03,360 --> 00:22:06,059
a malware

474
00:22:06,059 --> 00:22:09,299
and depend encrypted malware

475
00:22:09,299 --> 00:22:11,520
and depending on the key that will be

476
00:22:11,520 --> 00:22:13,080
used

477
00:22:13,080 --> 00:22:15,140
you will either

478
00:22:15,140 --> 00:22:18,500
decrypt as a innocent looking code

479
00:22:18,500 --> 00:22:22,559
legitimate or Lane malware that will

480
00:22:22,559 --> 00:22:25,440
fool the analyst or if the condition are

481
00:22:25,440 --> 00:22:26,580
met

482
00:22:26,580 --> 00:22:30,179
with a different key it will decrypt on

483
00:22:30,179 --> 00:22:32,580
the actual malware which intend to to

484
00:22:32,580 --> 00:22:35,159
perform the real Attack it means from

485
00:22:35,159 --> 00:22:37,860
from the same code with two different

486
00:22:37,860 --> 00:22:40,860
short keys you will obtain two different

487
00:22:40,860 --> 00:22:42,840
code and of course

488
00:22:42,840 --> 00:22:46,140
the aim and the operation condition is

489
00:22:46,140 --> 00:22:47,940
to make sure that the analyst the

490
00:22:47,940 --> 00:22:50,340
reverse engineer will always have access

491
00:22:50,340 --> 00:22:52,860
only of this you will find a key you

492
00:22:52,860 --> 00:22:55,500
will find a code it will be happy okay I

493
00:22:55,500 --> 00:22:57,840
have understood the logic of the malware

494
00:22:57,840 --> 00:23:01,020
while in fact there is another logic

495
00:23:01,020 --> 00:23:02,700
so

496
00:23:02,700 --> 00:23:06,120
of course the key cannot be inside the

497
00:23:06,120 --> 00:23:06,900
code

498
00:23:06,900 --> 00:23:08,280
otherwise

499
00:23:08,280 --> 00:23:11,600
it should it will be a

500
00:23:11,600 --> 00:23:13,679
compromised during the Reuters

501
00:23:13,679 --> 00:23:14,880
engineering part

502
00:23:14,880 --> 00:23:18,240
so in fact we suppose the mode operation

503
00:23:18,240 --> 00:23:19,799
supposed to have a common component

504
00:23:19,799 --> 00:23:23,220
control and the and the the malware is

505
00:23:23,220 --> 00:23:25,320
in communication with the common and

506
00:23:25,320 --> 00:23:26,280
control

507
00:23:26,280 --> 00:23:28,320
so we have designed a very secure and

508
00:23:28,320 --> 00:23:30,600
complex communication protocol that use

509
00:23:30,600 --> 00:23:33,419
fingerprint time index type modification

510
00:23:33,419 --> 00:23:35,760
random connection environmental

511
00:23:35,760 --> 00:23:38,340
connection condition and so on and the

512
00:23:38,340 --> 00:23:40,860
malware itself never knows

513
00:23:40,860 --> 00:23:45,439
when the the right condition are met

514
00:23:47,159 --> 00:23:49,799
the malware is able to detect whether it

515
00:23:49,799 --> 00:23:51,960
is under analysis or not we have

516
00:23:51,960 --> 00:23:54,419
developed with a PhD student a lot of

517
00:23:54,419 --> 00:23:56,159
technique and you have in in the fourth

518
00:23:56,159 --> 00:23:58,740
reference at the end of the slide

519
00:23:58,740 --> 00:24:01,559
so the mlware the non-encrypted part of

520
00:24:01,559 --> 00:24:02,720
the malware

521
00:24:02,720 --> 00:24:05,520
analyze its environment is able to

522
00:24:05,520 --> 00:24:08,280
determine whether it is under analysis

523
00:24:08,280 --> 00:24:09,179
or not

524
00:24:09,179 --> 00:24:12,120
and you will send this information to

525
00:24:12,120 --> 00:24:14,159
the command and control and depending on

526
00:24:14,159 --> 00:24:16,559
the result it will of course decrypt in

527
00:24:16,559 --> 00:24:20,000
one code or another code

528
00:24:21,419 --> 00:24:23,159
and of course

529
00:24:23,159 --> 00:24:26,400
the protocol is done in such a way that

530
00:24:26,400 --> 00:24:27,860
the probability

531
00:24:27,860 --> 00:24:30,659
that the reverse engineer will access

532
00:24:30,659 --> 00:24:34,559
only to the to the wrong solution will

533
00:24:34,559 --> 00:24:37,220
tend to win

534
00:24:37,799 --> 00:24:39,059
so

535
00:24:39,059 --> 00:24:41,780
it means that now we are able to do to

536
00:24:41,780 --> 00:24:44,960
deploy a malware that

537
00:24:44,960 --> 00:24:47,640
let's say would be quite impossible to

538
00:24:47,640 --> 00:24:49,320
an original to say impossible

539
00:24:49,320 --> 00:24:52,260
now how to actually try data

540
00:24:52,260 --> 00:24:55,440
and of course the the aim for the for

541
00:24:55,440 --> 00:24:57,480
the marijuana to be detected is to hide

542
00:24:57,480 --> 00:25:02,100
the acceleration Technique we use

543
00:25:02,100 --> 00:25:05,880
the first very lame but uh

544
00:25:05,880 --> 00:25:08,039
it is lame but it is very still a very

545
00:25:08,039 --> 00:25:11,220
efficient for most dlbs I have tested

546
00:25:11,220 --> 00:25:12,720
against

547
00:25:12,720 --> 00:25:15,740
the most famous LPS that you can buy

548
00:25:15,740 --> 00:25:18,860
they were all defeated we use Simple

549
00:25:18,860 --> 00:25:21,720
metadata when you you have a digital

550
00:25:21,720 --> 00:25:24,000
document you have the data what you see

551
00:25:24,000 --> 00:25:26,820
and you have inside the file you have a

552
00:25:26,820 --> 00:25:30,419
lot of internals what we call a metadata

553
00:25:30,419 --> 00:25:32,880
you are for example old version you have

554
00:25:32,880 --> 00:25:37,820
date uh the ownership and so on

555
00:25:37,919 --> 00:25:41,120
um and most all the

556
00:25:41,120 --> 00:25:42,740
present-day

557
00:25:42,740 --> 00:25:44,820
digital format

558
00:25:44,820 --> 00:25:48,600
have a lot of metadata

559
00:25:48,600 --> 00:25:51,120
so we have a we have observed a large

560
00:25:51,120 --> 00:25:54,059
permissiveness with respect to metadata

561
00:25:54,059 --> 00:25:57,900
and it's very easy uh to to exfoliate

562
00:25:57,900 --> 00:25:59,820
data in this way

563
00:25:59,820 --> 00:26:04,200
uh regarding metadata of network network

564
00:26:04,200 --> 00:26:07,200
protocol you can see the the work of the

565
00:26:07,200 --> 00:26:09,919
Polish University Washington University

566
00:26:09,919 --> 00:26:13,140
they did a very nice work exploiting

567
00:26:13,140 --> 00:26:16,020
Network metadata but it's the same

568
00:26:16,020 --> 00:26:18,059
principle so

569
00:26:18,059 --> 00:26:20,640
I've taken just an example I've taken a

570
00:26:20,640 --> 00:26:23,100
PDF file it was a scientific publication

571
00:26:23,100 --> 00:26:26,840
I just opened with a text editor

572
00:26:26,840 --> 00:26:32,960
and I insert a text within the different

573
00:26:32,960 --> 00:26:36,900
PDF part because PDF is a language it is

574
00:26:36,900 --> 00:26:40,620
like a script of course here I have made

575
00:26:40,620 --> 00:26:43,799
the the text visible for the

576
00:26:43,799 --> 00:26:47,159
demonstration but it is a lame approach

577
00:26:47,159 --> 00:26:50,179
in fact you will have to hide it

578
00:26:50,179 --> 00:26:53,340
with the specific statistical profile we

579
00:26:53,340 --> 00:26:55,799
are going to see it right after

580
00:26:55,799 --> 00:26:58,860
and you close you save the document you

581
00:26:58,860 --> 00:27:00,659
can open the document now I layer the

582
00:27:00,659 --> 00:27:02,340
document is still working

583
00:27:02,340 --> 00:27:04,919
and you can test it against most DLP

584
00:27:04,919 --> 00:27:08,039
there is no detection at all

585
00:27:08,039 --> 00:27:11,100
even very famous DLP from very famous

586
00:27:11,100 --> 00:27:14,600
software editor

587
00:27:15,360 --> 00:27:16,559
experiment

588
00:27:16,559 --> 00:27:20,460
is very surprising but once again for me

589
00:27:20,460 --> 00:27:24,200
it's a lame very lame attack

590
00:27:24,299 --> 00:27:25,559
of course

591
00:27:25,559 --> 00:27:27,960
if you you can say okay there is

592
00:27:27,960 --> 00:27:30,360
document Integrity in place because for

593
00:27:30,360 --> 00:27:32,880
example every document cannot modify

594
00:27:32,880 --> 00:27:35,220
without triggering an alert you can

595
00:27:35,220 --> 00:27:38,400
build your own document

596
00:27:38,400 --> 00:27:41,360
it's not a problem

597
00:27:42,480 --> 00:27:44,700
so in fact

598
00:27:44,700 --> 00:27:47,880
the aim is to produce document that are

599
00:27:47,880 --> 00:27:51,260
made mimicking normal document in place

600
00:27:51,260 --> 00:27:54,179
and for this we are going to use entropy

601
00:27:54,179 --> 00:27:56,880
and statistical profile

602
00:27:56,880 --> 00:28:00,659
for example to take a text and to make

603
00:28:00,659 --> 00:28:03,120
it look like a PDF

604
00:28:03,120 --> 00:28:06,000
at least from the perspective of a

605
00:28:06,000 --> 00:28:07,980
statistical detector of course for your

606
00:28:07,980 --> 00:28:10,679
human eye you will see that it is not a

607
00:28:10,679 --> 00:28:14,279
PDF but once again most of the dlps are

608
00:28:14,279 --> 00:28:16,919
automated process

609
00:28:16,919 --> 00:28:19,500
so of course you are not going to

610
00:28:19,500 --> 00:28:22,260
actually to to mimic the statistical

611
00:28:22,260 --> 00:28:25,440
profile in such a way that it will be

612
00:28:25,440 --> 00:28:27,779
possible for the analysts to reverse the

613
00:28:27,779 --> 00:28:30,360
process so generally we use key

614
00:28:30,360 --> 00:28:31,919
dependent secret key dependent

615
00:28:31,919 --> 00:28:34,460
transformation

616
00:28:34,980 --> 00:28:37,500
so secretly means that you have Key

617
00:28:37,500 --> 00:28:41,159
Management to uh to deal with and of

618
00:28:41,159 --> 00:28:42,960
course you cannot hide the secret key

619
00:28:42,960 --> 00:28:45,480
inside the code otherwise there is a

620
00:28:45,480 --> 00:28:47,700
problem once again the key will would be

621
00:28:47,700 --> 00:28:49,440
compromised

622
00:28:49,440 --> 00:28:53,520
um you could be compromised during the

623
00:28:53,520 --> 00:28:55,140
reverse engineering part you cannot like

624
00:28:55,140 --> 00:28:58,500
run some run some ransomware usually do

625
00:28:58,500 --> 00:29:02,820
use a crypto IP API to Generate random

626
00:29:02,820 --> 00:29:04,860
keys because the attacker has to

627
00:29:04,860 --> 00:29:06,480
retrieve the document and to be able to

628
00:29:06,480 --> 00:29:10,400
to decrypt it contrary to uh

629
00:29:10,400 --> 00:29:13,820
ransomware actors

630
00:29:14,940 --> 00:29:17,400
so what about the key

631
00:29:17,400 --> 00:29:21,299
generally or secret key is a random key

632
00:29:21,299 --> 00:29:23,940
we generate a random key which is short

633
00:29:23,940 --> 00:29:27,419
enough in order to be recovered by Brute

634
00:29:27,419 --> 00:29:29,460
Force

635
00:29:29,460 --> 00:29:31,799
so we don't care about Key Management it

636
00:29:31,799 --> 00:29:33,840
is just a random key we use a Dev random

637
00:29:33,840 --> 00:29:36,260
uh

638
00:29:37,559 --> 00:29:41,520
tool and of course we have to perform a

639
00:29:41,520 --> 00:29:43,640
2 to 40

640
00:29:43,640 --> 00:29:46,080
Brute Force attack but it's not a

641
00:29:46,080 --> 00:29:48,179
problem because the work is done once

642
00:29:48,179 --> 00:29:52,140
and for all and you you get your uh you

643
00:29:52,140 --> 00:29:53,960
get the file you

644
00:29:53,960 --> 00:29:57,120
have stolen

645
00:29:57,120 --> 00:30:00,240
and two uh 40 beats is very easy now

646
00:30:00,240 --> 00:30:04,260
with a GP GPU it is quite easy to do

647
00:30:04,260 --> 00:30:07,260
so you don't have to uh to use key you

648
00:30:07,260 --> 00:30:09,600
don't have to it inside the malware code

649
00:30:09,600 --> 00:30:11,580
and you just actually write your data

650
00:30:11,580 --> 00:30:13,980
and you perform Crypt analysis of course

651
00:30:13,980 --> 00:30:15,720
if you want to do something more

652
00:30:15,720 --> 00:30:18,299
sophisticated you will use for example

653
00:30:18,299 --> 00:30:20,340
an algorithm encryption algorithm with a

654
00:30:20,340 --> 00:30:22,340
backdoor you are

655
00:30:22,340 --> 00:30:25,020
you are the only one to know the

656
00:30:25,020 --> 00:30:26,880
existence so there are plenty of

657
00:30:26,880 --> 00:30:30,179
different variant for the the encryption

658
00:30:30,179 --> 00:30:31,020
part

659
00:30:31,020 --> 00:30:33,720
of Tron transfer transformation because

660
00:30:33,720 --> 00:30:36,539
here we do not encryption once again we

661
00:30:36,539 --> 00:30:38,700
are doing we are mimicking statistical

662
00:30:38,700 --> 00:30:40,140
profile

663
00:30:40,140 --> 00:30:43,320
so and I will of course image sounds

664
00:30:43,320 --> 00:30:45,059
difficult to understand that I will show

665
00:30:45,059 --> 00:30:46,559
you a example

666
00:30:46,559 --> 00:30:49,200
so just imagine that you want to

667
00:30:49,200 --> 00:30:52,200
exfiltrate uh data which exhibit for

668
00:30:52,200 --> 00:30:54,600
example a given a statistical profile

669
00:30:54,600 --> 00:30:57,419
for example PDF PDF when you do

670
00:30:57,419 --> 00:30:59,659
statistics on PDF you have a lot of

671
00:30:59,659 --> 00:31:02,520
characteristic and any automated program

672
00:31:02,520 --> 00:31:05,159
say okay it's PDF

673
00:31:05,159 --> 00:31:09,000
and you won't for example make sure that

674
00:31:09,000 --> 00:31:12,000
your PDF will be detected by your DLP at

675
00:31:12,000 --> 00:31:15,740
the text file so it is your target data

676
00:31:15,740 --> 00:31:18,179
statistical profile

677
00:31:18,179 --> 00:31:20,340
for this you have generated to consider

678
00:31:20,340 --> 00:31:23,880
an intermediate profile

679
00:31:23,880 --> 00:31:26,539
in order to mix

680
00:31:26,539 --> 00:31:29,000
with the

681
00:31:29,000 --> 00:31:32,760
data profile and for this you have very

682
00:31:32,760 --> 00:31:35,299
useful tool which is a joint

683
00:31:35,299 --> 00:31:39,000
distribution or joint entropy profile it

684
00:31:39,000 --> 00:31:42,059
means that you have you have PDF you

685
00:31:42,059 --> 00:31:44,299
transform it depending on the secret key

686
00:31:44,299 --> 00:31:47,000
at the end you have the same information

687
00:31:47,000 --> 00:31:50,940
but which require like a text file

688
00:31:50,940 --> 00:31:53,220
and of course your DLP say okay I block

689
00:31:53,220 --> 00:31:56,399
every PDF but text is okay

690
00:31:56,399 --> 00:31:59,940
and your text will be exfiltrated

691
00:31:59,940 --> 00:32:03,059
so it's a very general approach which is

692
00:32:03,059 --> 00:32:05,820
very powerful of course depending on the

693
00:32:05,820 --> 00:32:10,399
these two these two uh

694
00:32:10,500 --> 00:32:13,740
initial and Target profile you will be

695
00:32:13,740 --> 00:32:16,860
able to build a

696
00:32:16,860 --> 00:32:18,480
the

697
00:32:18,480 --> 00:32:22,380
toaster site as you want so just a very

698
00:32:22,380 --> 00:32:24,779
simple example just imagine that you

699
00:32:24,779 --> 00:32:27,179
want to excel trade I keep text from

700
00:32:27,179 --> 00:32:31,020
text just to to keep things very clear

701
00:32:31,020 --> 00:32:33,179
just imagine that you want to absorb

702
00:32:33,179 --> 00:32:36,179
this text you want to exfiltrate this

703
00:32:36,179 --> 00:32:38,399
okay if you use for example as a target

704
00:32:38,399 --> 00:32:40,980
distribution what we call a second order

705
00:32:40,980 --> 00:32:43,740
Markov distribution will you will

706
00:32:43,740 --> 00:32:45,360
exfiltrate this

707
00:32:45,360 --> 00:32:48,179
of course I'm fully agree if you read

708
00:32:48,179 --> 00:32:49,559
this you will say there is something

709
00:32:49,559 --> 00:32:51,120
strange

710
00:32:51,120 --> 00:32:54,740
but you have to read it any automated

711
00:32:54,740 --> 00:32:57,299
process will say okay

712
00:32:57,299 --> 00:32:59,360
if you want to

713
00:32:59,360 --> 00:33:01,919
use a more sophisticated distribution

714
00:33:01,919 --> 00:33:04,320
what we called first order Markov work

715
00:33:04,320 --> 00:33:09,240
distribution you will yeah in this

716
00:33:09,240 --> 00:33:12,419
you will obtain this and we are very

717
00:33:12,419 --> 00:33:15,179
close to something which which looks

718
00:33:15,179 --> 00:33:17,840
like English

719
00:33:18,840 --> 00:33:20,760
I'm not that good in English so I could

720
00:33:20,760 --> 00:33:23,460
imagine that it is a real English maybe

721
00:33:23,460 --> 00:33:25,620
Old English but but it's English it

722
00:33:25,620 --> 00:33:27,419
looks like English

723
00:33:27,419 --> 00:33:29,580
once again because we support that only

724
00:33:29,580 --> 00:33:32,940
automated detection is in place okay

725
00:33:32,940 --> 00:33:34,799
okay but here it's very important

726
00:33:34,799 --> 00:33:37,200
because we enable to have nearly 30

727
00:33:37,200 --> 00:33:39,179
percent of NBD grade remember

728
00:33:39,179 --> 00:33:41,820
steganography at the best three percent

729
00:33:41,820 --> 00:33:43,460
here

730
00:33:43,460 --> 00:33:46,799
10 10 times more

731
00:33:46,799 --> 00:33:50,240
and of course without detection

732
00:33:51,960 --> 00:33:54,620
so

733
00:33:55,860 --> 00:33:59,640
what what happens if there is a manual

734
00:33:59,640 --> 00:34:02,820
expertise manual manual analysis of the

735
00:34:02,820 --> 00:34:04,260
text of course

736
00:34:04,260 --> 00:34:06,600
we will be detected

737
00:34:06,600 --> 00:34:08,639
by principle everything will be blocked

738
00:34:08,639 --> 00:34:12,179
in order you know to wait for the

739
00:34:12,179 --> 00:34:16,379
forensics analysis so is it possible to

740
00:34:16,379 --> 00:34:18,739
make sure that even a manual analysis

741
00:34:18,739 --> 00:34:22,280
will will defeat

742
00:34:22,280 --> 00:34:25,980
will will be defeated

743
00:34:25,980 --> 00:34:28,800
it is possible so with the same

744
00:34:28,800 --> 00:34:31,139
principle I we use more sophisticated

745
00:34:31,139 --> 00:34:33,960
distribution and I would like to show

746
00:34:33,960 --> 00:34:34,859
you

747
00:34:34,859 --> 00:34:39,239
um an example of I take on the dark web

748
00:34:39,239 --> 00:34:41,060
a critical

749
00:34:41,060 --> 00:34:45,379
database it was a database of this admin

750
00:34:45,379 --> 00:34:48,859
of that size one

751
00:34:48,859 --> 00:34:52,560
1440 and 94 bytes and the target

752
00:34:52,560 --> 00:34:55,379
distribution was a firewall load because

753
00:34:55,379 --> 00:34:59,220
General firewall logo exchange are

754
00:34:59,220 --> 00:35:02,339
are made more or less public and it was

755
00:35:02,339 --> 00:35:06,780
possible to embed this on a file of

756
00:35:06,780 --> 00:35:10,980
nearly a 9000 byte so with an embedding

757
00:35:10,980 --> 00:35:12,500
rate of

758
00:35:12,500 --> 00:35:15,599
70 percent so I hope that I will be able

759
00:35:15,599 --> 00:35:17,820
to do to show you

760
00:35:17,820 --> 00:35:19,680
as a result

761
00:35:19,680 --> 00:35:21,420
so

762
00:35:21,420 --> 00:35:21,660
[Music]

763
00:35:21,660 --> 00:35:23,660
um

764
00:35:25,800 --> 00:35:28,800
I'm sorry but okay I have just

765
00:35:28,800 --> 00:35:31,859
anonymized the the password they were in

766
00:35:31,859 --> 00:35:36,440
plane and but the the number of eggs are

767
00:35:36,440 --> 00:35:40,440
is the same as a length of the actual

768
00:35:40,440 --> 00:35:43,560
password so this database we want to

769
00:35:43,560 --> 00:35:45,300
extravitate it

770
00:35:45,300 --> 00:35:48,560
here's a result

771
00:35:50,339 --> 00:35:54,119
it looks like firewall log

772
00:35:54,119 --> 00:35:56,460
and of course I choose a firewall log

773
00:35:56,460 --> 00:35:59,339
here it is just a file but I can hide

774
00:35:59,339 --> 00:36:03,859
every line in a huge more huge

775
00:36:03,859 --> 00:36:06,900
fire log file

776
00:36:06,900 --> 00:36:09,060
and I can make sure that even the

777
00:36:09,060 --> 00:36:13,079
insertion on the bigger log file will be

778
00:36:13,079 --> 00:36:15,839
random and secretly dependent so it

779
00:36:15,839 --> 00:36:17,220
means that

780
00:36:17,220 --> 00:36:20,400
you cannot detect this

781
00:36:20,400 --> 00:36:23,700
and you can you can use

782
00:36:23,700 --> 00:36:26,540
as many

783
00:36:29,760 --> 00:36:32,160
as many different Target distribution

784
00:36:32,160 --> 00:36:34,740
you want you can add up to PDF you can

785
00:36:34,740 --> 00:36:37,339
adapt to

786
00:36:37,460 --> 00:36:40,440
any language you want

787
00:36:40,440 --> 00:36:43,020
this approach enabled to really defeat

788
00:36:43,020 --> 00:36:45,480
manual analysis people will see normal

789
00:36:45,480 --> 00:36:46,740
text

790
00:36:46,740 --> 00:36:49,560
and they will consider that this normal

791
00:36:49,560 --> 00:36:52,980
test can be can be exchanged outside and

792
00:36:52,980 --> 00:36:56,520
of course data will be exfiltrated

793
00:36:56,520 --> 00:36:59,579
so once again there are a lot of

794
00:36:59,579 --> 00:37:01,079
possibilities

795
00:37:01,079 --> 00:37:03,119
you have a quite infinite number of

796
00:37:03,119 --> 00:37:05,760
distribution initial distribution Target

797
00:37:05,760 --> 00:37:09,180
distributions and you can

798
00:37:09,180 --> 00:37:12,540
even use Tech techniques you can

799
00:37:12,540 --> 00:37:14,579
they are quite infinite number of

800
00:37:14,579 --> 00:37:17,520
solution so from a security point of

801
00:37:17,520 --> 00:37:20,040
view of course we're asking I'm

802
00:37:20,040 --> 00:37:23,099
currently working on cloud security is

803
00:37:23,099 --> 00:37:25,079
it possible to prevent this

804
00:37:25,079 --> 00:37:29,400
in fact DLP are all defeated and we can

805
00:37:29,400 --> 00:37:32,220
prove what we call probable security or

806
00:37:32,220 --> 00:37:35,760
it is provable insecurity that we cannot

807
00:37:35,760 --> 00:37:38,099
detect this

808
00:37:38,099 --> 00:37:40,800
for automated analysis

809
00:37:40,800 --> 00:37:43,260
for some cases we can record or

810
00:37:43,260 --> 00:37:45,839
transcode the file in order to to

811
00:37:45,839 --> 00:37:49,859
destroy data would be hidden inside the

812
00:37:49,859 --> 00:37:53,460
file but the last techniques were at the

813
00:37:53,460 --> 00:37:56,040
semantic level it means that even if you

814
00:37:56,040 --> 00:37:58,500
record the text you will not destroy

815
00:37:58,500 --> 00:38:01,460
this information you would have to to

816
00:38:01,460 --> 00:38:04,740
rewrite the content of the file which is

817
00:38:04,740 --> 00:38:06,300
of course impossible

818
00:38:06,300 --> 00:38:09,599
so it means that in fact we have to be

819
00:38:09,599 --> 00:38:12,359
very careful about data exfiltration

820
00:38:12,359 --> 00:38:16,339
because we must not trust

821
00:38:16,339 --> 00:38:20,460
DLP that much I do not say that you you

822
00:38:20,460 --> 00:38:23,400
you don't have to use DLP because it's

823
00:38:23,400 --> 00:38:28,020
like antivirus software there are there

824
00:38:28,020 --> 00:38:31,079
are useful for many attacks but for

825
00:38:31,079 --> 00:38:33,119
targeting attacks for very critical

826
00:38:33,119 --> 00:38:36,180
environment DLP is just a false sense of

827
00:38:36,180 --> 00:38:38,419
security

828
00:38:39,540 --> 00:38:43,140
of course DLP it is a point that we must

829
00:38:43,140 --> 00:38:47,220
also take into account DLP also use beer

830
00:38:47,220 --> 00:38:48,720
the real detection techniques for

831
00:38:48,720 --> 00:38:51,660
example the frequency where recently we

832
00:38:51,660 --> 00:38:54,420
have blocked some one employee who are

833
00:38:54,420 --> 00:38:56,700
trying to download massively that

834
00:38:56,700 --> 00:38:59,460
sensitive data and the fact that the

835
00:38:59,460 --> 00:39:01,980
download was massive on a limited period

836
00:39:01,980 --> 00:39:05,099
of time of course triggered on Earth

837
00:39:05,099 --> 00:39:10,079
so maybe frequency volume nature of that

838
00:39:10,079 --> 00:39:13,260
format of document in fact

839
00:39:13,260 --> 00:39:16,740
DLP can go beyond the simple static

840
00:39:16,740 --> 00:39:19,079
analysis of a document

841
00:39:19,079 --> 00:39:21,420
but the approach is the same instead of

842
00:39:21,420 --> 00:39:24,960
having statistical and entropy profile

843
00:39:24,960 --> 00:39:29,060
for the text you can design and and

844
00:39:29,060 --> 00:39:33,000
analyze the same for behavior and in

845
00:39:33,000 --> 00:39:35,520
this respect it is the same to bypass

846
00:39:35,520 --> 00:39:38,099
antivirus you have static detection but

847
00:39:38,099 --> 00:39:39,960
you have also Dynamic detection based on

848
00:39:39,960 --> 00:39:43,260
behaviors so whenever you understand the

849
00:39:43,260 --> 00:39:47,460
way your DLB is working you can evaluate

850
00:39:47,460 --> 00:39:50,940
the distribution you're using and mimic

851
00:39:50,940 --> 00:39:53,640
it bypass it

852
00:39:53,640 --> 00:39:56,099
most of these distribution are often

853
00:39:56,099 --> 00:40:00,480
public or known or but a malware can do

854
00:40:00,480 --> 00:40:03,119
an intelligent step during the right

855
00:40:03,119 --> 00:40:05,339
after the initial break Bridge during

856
00:40:05,339 --> 00:40:07,820
the lateral movement and of course can

857
00:40:07,820 --> 00:40:10,940
analyze through a preliminary

858
00:40:10,940 --> 00:40:14,520
identifying intelligence phase the right

859
00:40:14,520 --> 00:40:16,680
target distribution with respect to

860
00:40:16,680 --> 00:40:18,900
behaviors

861
00:40:18,900 --> 00:40:22,160
so to conclude

862
00:40:22,619 --> 00:40:26,339
once again DLP may be useful against

863
00:40:26,339 --> 00:40:31,260
basic attacks but you can honestly

864
00:40:31,260 --> 00:40:35,760
try just to use the metadata technique

865
00:40:35,760 --> 00:40:38,339
it's very surprising to see that most

866
00:40:38,339 --> 00:40:41,760
dlps are not using uh detecting them so

867
00:40:41,760 --> 00:40:44,339
far more sophisticated techniques will

868
00:40:44,339 --> 00:40:46,820
will not

869
00:40:46,859 --> 00:40:49,320
so um

870
00:40:49,320 --> 00:40:53,160
regarding apts I think that we have to

871
00:40:53,160 --> 00:40:55,380
be aware of that and

872
00:40:55,380 --> 00:40:58,320
I'm sure I'm even sure that if we have

873
00:40:58,320 --> 00:41:01,980
the ID that a few apt already maybe use

874
00:41:01,980 --> 00:41:03,960
this kind of trick

875
00:41:03,960 --> 00:41:07,099
so it means that if there is no direct

876
00:41:07,099 --> 00:41:11,220
protection we have maybe to end to to

877
00:41:11,220 --> 00:41:14,040
harden the security assessment within

878
00:41:14,040 --> 00:41:16,320
for example within Cloud the security

879
00:41:16,320 --> 00:41:19,740
architecture the data assessment

880
00:41:19,740 --> 00:41:23,460
uh recently observed that made that

881
00:41:23,460 --> 00:41:26,160
variable data of different sensibility

882
00:41:26,160 --> 00:41:28,060
level are not

883
00:41:28,060 --> 00:41:29,180
[Music]

884
00:41:29,180 --> 00:41:32,160
segregated to have a tight right

885
00:41:32,160 --> 00:41:34,500
management how many people have access

886
00:41:34,500 --> 00:41:37,680
to too many documents because the right

887
00:41:37,680 --> 00:41:42,260
the the right and ownership are not

888
00:41:42,260 --> 00:41:47,040
correctly managed so it can lower the

889
00:41:47,040 --> 00:41:49,920
issue of data exfiltration in any case

890
00:41:49,920 --> 00:41:51,599
it will not prevent it

891
00:41:51,599 --> 00:41:55,680
so that's why we I I would like to make

892
00:41:55,680 --> 00:41:58,020
you aware of the fact that it is a very

893
00:41:58,020 --> 00:42:01,619
special case of Total Security is not

894
00:42:01,619 --> 00:42:03,660
possible

895
00:42:03,660 --> 00:42:05,880
so I have finished if you have question

896
00:42:05,880 --> 00:42:07,800
once again I can do the demonstration

897
00:42:07,800 --> 00:42:11,640
for the first demo intended to to do and

898
00:42:11,640 --> 00:42:13,760
thank you for your attention

899
00:42:13,760 --> 00:42:22,129
[Applause]

900
00:42:22,580 --> 00:42:24,480
[Music]

901
00:42:24,480 --> 00:42:26,160
thank you so much for the presentation

902
00:42:26,160 --> 00:42:29,339
anyone wants to to ask questions

903
00:42:29,339 --> 00:42:32,180
to where he

904
00:42:32,220 --> 00:42:33,900
and please don't leave because the next

905
00:42:33,900 --> 00:42:35,579
session as is in video will be right

906
00:42:35,579 --> 00:42:38,000
right away

907
00:42:38,280 --> 00:42:41,240
one question over there

908
00:42:44,940 --> 00:42:47,810
okay thank you so much thank you

909
00:42:47,810 --> 00:42:51,030
[Applause]

910
00:42:51,030 --> 00:42:55,419
[Music]

