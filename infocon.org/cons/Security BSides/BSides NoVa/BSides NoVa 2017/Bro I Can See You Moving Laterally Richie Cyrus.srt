1
00:00:00,079 --> 00:00:08,130
hello<font color="#E5E5E5"> hello thanks everyone for coming</font>

2
00:00:05,069 --> 00:00:10,559
out<font color="#E5E5E5"> I want to thank b-sides Nova for</font>

3
00:00:08,130 --> 00:00:14,099
having me here on this is my first time

4
00:00:10,559 --> 00:00:15,838
as a speaker so this<font color="#E5E5E5"> is me jumping</font>

5
00:00:14,099 --> 00:00:17,910
outside there's a box and getting from

6
00:00:15,839 --> 00:00:20,580
behind the analyst keyboard and actually

7
00:00:17,910 --> 00:00:22,109
sharing some of the ideas<font color="#E5E5E5"> and things</font>

8
00:00:20,580 --> 00:00:23,759
<font color="#E5E5E5">that I've been working</font><font color="#CCCCCC"> on in the</font><font color="#E5E5E5"> in the</font>

9
00:00:22,109 --> 00:00:33,149
past and and what I plan to do in the

10
00:00:23,760 --> 00:00:36,450
future so the name of this talk is bro I

11
00:00:33,149 --> 00:00:37,920
can see you moving laterally a lot<font color="#E5E5E5"> of</font>

12
00:00:36,450 --> 00:00:39,780
<font color="#E5E5E5">people are confused about the name of</font>

13
00:00:37,920 --> 00:00:41,730
the talk it's not<font color="#E5E5E5"> about bros like an</font>

14
00:00:39,780 --> 00:00:43,530
effect<font color="#E5E5E5"> of the guys like in the gym</font>

15
00:00:41,730 --> 00:00:46,500
pumping iron<font color="#CCCCCC"> I was actually about the</font>

16
00:00:43,530 --> 00:00:51,620
security tool bro bro network security

17
00:00:46,500 --> 00:00:55,050
monitoring a little bit about myself I'm

18
00:00:51,620 --> 00:00:57,149
defender at heart i love defending<font color="#CCCCCC"> i'm</font>

19
00:00:55,050 --> 00:00:59,129
an incident responder at chicago

20
00:00:57,149 --> 00:01:01,530
mercantile exchange I'm based out of the

21
00:00:59,129 --> 00:01:04,229
New<font color="#CCCCCC"> York area but I've been working in</font>

22
00:01:01,530 --> 00:01:07,380
the DC area on to start on my career so

23
00:01:04,229 --> 00:01:10,979
I'm always tied back to DC Virginia area

24
00:01:07,380 --> 00:01:14,610
which is why I you know put him my hat

25
00:01:10,979 --> 00:01:17,729
said speak at<font color="#E5E5E5"> this conference</font><font color="#CCCCCC"> on my NSM</font>

26
00:01:14,610 --> 00:01:21,180
fanboy I love anything NSM I'll go over

27
00:01:17,729 --> 00:01:22,950
security onion which was used to<font color="#CCCCCC"> draft a</font>

28
00:01:21,180 --> 00:01:25,140
lot of this data that i had and in this

29
00:01:22,950 --> 00:01:27,600
talk and<font color="#CCCCCC"> i have a healthy obsession</font>

30
00:01:25,140 --> 00:01:30,000
sometimes unhealthy obsession with

31
00:01:27,600 --> 00:01:33,419
finding new ways to detect malicious

32
00:01:30,000 --> 00:01:35,820
activity attackers it's some people shy

33
00:01:33,420 --> 00:01:37,650
away from you know attack us ending up

34
00:01:35,820 --> 00:01:39,630
on the network and you know the<font color="#E5E5E5"> most</font>

35
00:01:37,650 --> 00:01:41,549
folks is a bad day but I see that<font color="#CCCCCC"> as an</font>

36
00:01:39,630 --> 00:01:44,579
opportunity to learn more about my

37
00:01:41,549 --> 00:01:50,840
attacker and about new ways to defend in

38
00:01:44,579 --> 00:01:50,839
general and on<font color="#CCCCCC"> Twitter</font><font color="#E5E5E5"> I'm RR Cyrus</font>

39
00:01:51,600 --> 00:01:56,649
like I said<font color="#E5E5E5"> this talk is primarily about</font>

40
00:01:54,070 --> 00:02:00,059
bro um show of hands<font color="#E5E5E5"> how many</font><font color="#CCCCCC"> people are</font>

41
00:01:56,650 --> 00:02:02,650
familiar or I've heard of bro wow great

42
00:02:00,060 --> 00:02:07,180
um so I'll go<font color="#CCCCCC"> over a little bit about</font>

43
00:02:02,650 --> 00:02:09,580
bro logs on the bro SMB analyzer which

44
00:02:07,180 --> 00:02:11,200
was introduced and bro version 2 dot<font color="#E5E5E5"> 5</font>

45
00:02:09,580 --> 00:02:13,600
which is<font color="#E5E5E5"> pretty new which is the current</font>

46
00:02:11,200 --> 00:02:15,910
version right now<font color="#E5E5E5"> and also going over</font>

47
00:02:13,600 --> 00:02:20,320
bro scripting using the bros scripting

48
00:02:15,910 --> 00:02:22,870
language to do a lot<font color="#CCCCCC"> of these things so</font>

49
00:02:20,320 --> 00:02:26,590
one issue that we have insecurity is

50
00:02:22,870 --> 00:02:28,570
that we focus<font color="#E5E5E5"> a</font><font color="#CCCCCC"> lot on trying to protect</font>

51
00:02:26,590 --> 00:02:30,940
attack us from getting inside the

52
00:02:28,570 --> 00:02:32,590
network and so there's a lot of things

53
00:02:30,940 --> 00:02:34,800
<font color="#E5E5E5">set up where you have a firewall setup</font>

54
00:02:32,590 --> 00:02:38,380
you're making sure you're logging

55
00:02:34,800 --> 00:02:40,120
activity<font color="#E5E5E5"> hidden externally when nothing</font>

56
00:02:38,380 --> 00:02:41,829
is really mentioned about when the

57
00:02:40,120 --> 00:02:44,620
attackers are in and<font color="#E5E5E5"> that's when a lot</font>

58
00:02:41,830 --> 00:02:46,870
of breaches happen where the<font color="#CCCCCC"> attacker</font>

59
00:02:44,620 --> 00:02:48,970
has a foothold in they go dark from

60
00:02:46,870 --> 00:02:50,380
analysis perspective and things are

61
00:02:48,970 --> 00:02:54,070
happening behind the scenes that we are

62
00:02:50,380 --> 00:02:57,940
able<font color="#E5E5E5"> to detect it so that's the problem</font>

63
00:02:54,070 --> 00:03:00,489
<font color="#E5E5E5">statement of my clock a particularly</font>

64
00:02:57,940 --> 00:03:02,770
lateral movement so now<font color="#E5E5E5"> they're on the</font>

65
00:03:00,490 --> 00:03:06,070
network on that might be from an<font color="#E5E5E5"> email</font>

66
00:03:02,770 --> 00:03:08,410
attachment that was you<font color="#E5E5E5"> know someone</font>

67
00:03:06,070 --> 00:03:10,750
clicked on a bypass AV and now they're

68
00:03:08,410 --> 00:03:13,120
on actual<font color="#E5E5E5"> host in the network and</font>

69
00:03:10,750 --> 00:03:15,280
they're moving from system to system to

70
00:03:13,120 --> 00:03:17,680
carry out<font color="#E5E5E5"> their our objectives wherever</font>

71
00:03:15,280 --> 00:03:21,280
it might be whether<font color="#E5E5E5"> it's gathering more</font>

72
00:03:17,680 --> 00:03:23,260
information or actually gathering you

73
00:03:21,280 --> 00:03:29,050
know secret data that they want to exfil

74
00:03:23,260 --> 00:03:30,940
out one way that attackers use one

75
00:03:29,050 --> 00:03:34,000
technique for lateral movement is

76
00:03:30,940 --> 00:03:37,989
actually SMB using the SMB<font color="#E5E5E5"> protocol that</font>

77
00:03:34,000 --> 00:03:40,270
might be to mount<font color="#CCCCCC"> window</font><font color="#E5E5E5"> shares also to</font>

78
00:03:37,989 --> 00:03:42,550
move files across the file share

79
00:03:40,270 --> 00:03:44,890
themselves because this is considered

80
00:03:42,550 --> 00:03:46,800
normal activities within the network you

81
00:03:44,890 --> 00:03:51,880
have<font color="#CCCCCC"> a bunch</font><font color="#E5E5E5"> of fire activity going on</font>

82
00:03:46,800 --> 00:03:54,190
it's enabled it's<font color="#E5E5E5"> kind of a way to blend</font>

83
00:03:51,880 --> 00:03:57,010
in with<font color="#E5E5E5"> normal traffic this you know</font>

84
00:03:54,190 --> 00:03:58,819
printer<font color="#E5E5E5"> services going on um folks</font>

85
00:03:57,010 --> 00:04:00,798
usually<font color="#E5E5E5"> host</font>

86
00:03:58,819 --> 00:04:02,958
a bunch of company files like in

87
00:04:00,799 --> 00:04:06,620
<font color="#E5E5E5">particular shares or multiple shares so</font>

88
00:04:02,959 --> 00:04:08,540
their movement using SMB is likely to<font color="#E5E5E5"> go</font>

89
00:04:06,620 --> 00:04:12,799
undetected if you're not looking for it

90
00:04:08,540 --> 00:04:15,290
a little bit about SMB protocol on this

91
00:04:12,799 --> 00:04:18,079
talk is primarily focused on SMB

92
00:04:15,290 --> 00:04:21,409
protocol to that X primarily with

93
00:04:18,079 --> 00:04:26,270
<font color="#CCCCCC">Windows 7 30 is</font><font color="#E5E5E5"> for Windows 10 and</font>

94
00:04:21,410 --> 00:04:28,669
windows 8 dot<font color="#CCCCCC"> 1 etc</font><font color="#E5E5E5"> so typically in the</font>

95
00:04:26,270 --> 00:04:32,240
past when we go about looking for

96
00:04:28,669 --> 00:04:35,930
malicious SMB activity specifically

97
00:04:32,240 --> 00:04:39,139
<font color="#E5E5E5">attackers using who's like a PS exact</font>

98
00:04:35,930 --> 00:04:41,449
and move a file from file share the file

99
00:04:39,139 --> 00:04:44,620
share computers<font color="#E5E5E5"> a computer</font><font color="#CCCCCC"> or primarily</font>

100
00:04:41,449 --> 00:04:47,660
like see dollar sign admin dollar sign

101
00:04:44,620 --> 00:04:49,280
typically<font color="#E5E5E5"> the methods used are 41 snort</font>

102
00:04:47,660 --> 00:04:53,630
you have a snort rule that might take

103
00:04:49,280 --> 00:04:56,388
the detect usage of PS exec and you know

104
00:04:53,630 --> 00:04:58,729
there's ways<font color="#CCCCCC"> to get around that and then</font>

105
00:04:56,389 --> 00:05:01,370
windows login where you have the<font color="#CCCCCC"> GPO</font>

106
00:04:58,729 --> 00:05:04,130
<font color="#E5E5E5">setting to audit for file share access</font>

107
00:05:01,370 --> 00:05:06,380
and file share objects and so those are

108
00:05:04,130 --> 00:05:09,020
<font color="#CCCCCC">some of</font><font color="#E5E5E5"> the event ID is created and so</font>

109
00:05:06,380 --> 00:05:10,219
with that because snort rules<font color="#E5E5E5"> um you</font>

110
00:05:09,020 --> 00:05:12,139
know depending on how you have our

111
00:05:10,220 --> 00:05:14,210
architecture you may miss something and

112
00:05:12,139 --> 00:05:15,919
with window logs you have to collect all

113
00:05:14,210 --> 00:05:18,349
those window logs and put them in a

114
00:05:15,919 --> 00:05:20,539
<font color="#E5E5E5">location and correlate them and generate</font>

115
00:05:18,349 --> 00:05:24,199
use cases for them and that might be

116
00:05:20,539 --> 00:05:28,159
difficult for some companies to do so

117
00:05:24,199 --> 00:05:32,539
the alternative solution is bro and so

118
00:05:28,159 --> 00:05:35,630
bro network security monitor its able to

119
00:05:32,539 --> 00:05:38,139
<font color="#E5E5E5">grab some</font><font color="#CCCCCC"> of the metadata from popular</font>

120
00:05:35,630 --> 00:05:45,139
network protocols as you may know as

121
00:05:38,139 --> 00:05:49,070
<font color="#E5E5E5">HTTP FTP rdp and so SMB was added to</font>

122
00:05:45,139 --> 00:05:51,139
that on in version 2 dot fog so you

123
00:05:49,070 --> 00:05:52,520
could grab file metadata as well on some

124
00:05:51,139 --> 00:05:55,460
of the hashes about the for some

125
00:05:52,520 --> 00:05:56,690
<font color="#E5E5E5">information about the file what kind of</font>

126
00:05:55,460 --> 00:05:59,060
file it is if there's<font color="#E5E5E5"> a Windows</font>

127
00:05:56,690 --> 00:06:00,740
executable these are things that might

128
00:05:59,060 --> 00:06:03,469
<font color="#CCCCCC">be helpful to Anna for</font><font color="#E5E5E5"> analysts to know</font>

129
00:06:00,740 --> 00:06:05,600
I'm also alerting on you have the

130
00:06:03,469 --> 00:06:08,719
<font color="#CCCCCC">ability to send a</font>

131
00:06:05,600 --> 00:06:12,710
alerts to a notice not log and your logs

132
00:06:08,720 --> 00:06:15,110
directory and a custom or a default bro

133
00:06:12,710 --> 00:06:17,299
installation and so you will look<font color="#E5E5E5"> in</font>

134
00:06:15,110 --> 00:06:19,960
that notice log for things of interest

135
00:06:17,300 --> 00:06:22,520
that are happening on the network and

136
00:06:19,960 --> 00:06:26,599
<font color="#E5E5E5">with the bro logs themselves they are</font>

137
00:06:22,520 --> 00:06:29,450
easy to pump into a sim solution or you

138
00:06:26,600 --> 00:06:30,980
can grep them you can use<font color="#CCCCCC"> tool bro cut</font>

139
00:06:29,450 --> 00:06:33,560
to make it a little bit easier<font color="#CCCCCC"> on the</font>

140
00:06:30,980 --> 00:06:38,270
eyes to grab particular information that

141
00:06:33,560 --> 00:06:41,120
is interesting to you and this<font color="#CCCCCC"> is an</font>

142
00:06:38,270 --> 00:06:44,030
example<font color="#E5E5E5"> of a prologue and so you see</font><font color="#CCCCCC"> you</font>

143
00:06:41,120 --> 00:06:48,140
have a UID and that you ID can be used

144
00:06:44,030 --> 00:06:51,109
to match multiple events across logs and

145
00:06:48,140 --> 00:06:54,830
then you have the ID original<font color="#E5E5E5"> h which is</font>

146
00:06:51,110 --> 00:06:59,090
your source ID and then the source port

147
00:06:54,830 --> 00:07:00,620
is the original underscore p seen there

148
00:06:59,090 --> 00:07:03,109
and then the protocol which you see in

149
00:07:00,620 --> 00:07:04,790
this case is UDP this is an<font color="#E5E5E5"> example of</font>

150
00:07:03,110 --> 00:07:09,800
the connection log if you've never<font color="#E5E5E5"> seen</font>

151
00:07:04,790 --> 00:07:11,930
a bro log before bro logs really are by

152
00:07:09,800 --> 00:07:15,500
default kind of difficult to<font color="#E5E5E5"> work with</font>

153
00:07:11,930 --> 00:07:17,180
especially<font color="#E5E5E5"> the way sighs the window</font><font color="#CCCCCC"> that</font>

154
00:07:15,500 --> 00:07:20,150
you<font color="#E5E5E5"> have so you</font><font color="#CCCCCC"> can use</font><font color="#E5E5E5"> something like</font>

155
00:07:17,180 --> 00:07:21,830
you could pump it through less<font color="#E5E5E5"> I mean</font>

156
00:07:20,150 --> 00:07:23,630
dash S and it might<font color="#E5E5E5"> make it a little bit</font>

157
00:07:21,830 --> 00:07:25,789
<font color="#CCCCCC">easier you can scroll across the screen</font>

158
00:07:23,630 --> 00:07:31,760
to see all the fields not in this<font color="#CCCCCC"> jumble</font>

159
00:07:25,790 --> 00:07:36,170
format so like I mentioned before with

160
00:07:31,760 --> 00:07:39,909
bro version 2 dot<font color="#E5E5E5"> 5 they enabled SMB as</font>

161
00:07:36,170 --> 00:07:43,460
a protocol and introduced the<font color="#E5E5E5"> analyzer</font>

162
00:07:39,910 --> 00:07:46,310
now it's not installed by default by the

163
00:07:43,460 --> 00:07:49,599
way so what you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to do is if</font>

164
00:07:46,310 --> 00:07:51,530
<font color="#E5E5E5">commented out and your local that bro um</font>

165
00:07:49,600 --> 00:07:54,500
file and what you have to do with

166
00:07:51,530 --> 00:07:56,900
uncomment that out and<font color="#CCCCCC"> then use pro</font>

167
00:07:54,500 --> 00:07:59,150
control to deploy that again so it's

168
00:07:56,900 --> 00:08:01,909
implemented and actually monitoring for

169
00:07:59,150 --> 00:08:04,880
that i'm<font color="#CCCCCC"> using the SMB analyzer to grab</font>

170
00:08:01,910 --> 00:08:06,800
that metadata and so some of these<font color="#CCCCCC"> are</font>

171
00:08:04,880 --> 00:08:11,540
some of the SMB logs that were

172
00:08:06,800 --> 00:08:16,190
introduced on SMB def CMD CM<font color="#E5E5E5"> CMD</font>

173
00:08:11,540 --> 00:08:18,210
dialogue some of the CM SMB commands

174
00:08:16,190 --> 00:08:21,580
<font color="#E5E5E5">that are being run</font>

175
00:08:18,210 --> 00:08:26,140
SMB file so any files moved across with

176
00:08:21,580 --> 00:08:31,530
SMB also SMB mapping on any smb3

177
00:08:26,140 --> 00:08:31,530
activity and ntlm log and RPC dialogue

178
00:08:33,780 --> 00:08:44,530
and so bro scripting is based on<font color="#E5E5E5"> C and</font>

179
00:08:40,780 --> 00:08:48,160
<font color="#E5E5E5">C++ it also has a notice framework so</font>

180
00:08:44,530 --> 00:08:50,589
what you will<font color="#E5E5E5"> see with a lot</font><font color="#CCCCCC"> of bros</font>

181
00:08:48,160 --> 00:08:52,150
scripting is that you can look at

182
00:08:50,590 --> 00:08:54,820
<font color="#E5E5E5">activity that is happening on the</font>

183
00:08:52,150 --> 00:08:57,010
network look at the logs and then create

184
00:08:54,820 --> 00:08:58,870
a script based on a<font color="#E5E5E5"> particular use case</font>

185
00:08:57,010 --> 00:09:01,150
you're trying to solve and that's what I

186
00:08:58,870 --> 00:09:05,710
<font color="#E5E5E5">did primarily and the research that I've</font>

187
00:09:01,150 --> 00:09:07,870
done so<font color="#CCCCCC"> far um a lot</font><font color="#E5E5E5"> of a lot of sock</font>

188
00:09:05,710 --> 00:09:09,820
teams would do the same thing and<font color="#E5E5E5"> it's</font>

189
00:09:07,870 --> 00:09:14,530
kind of repetitive so you would look for

190
00:09:09,820 --> 00:09:16,420
some malicious activity going on and you

191
00:09:14,530 --> 00:09:18,400
would find a way<font color="#CCCCCC"> to automate that so</font>

192
00:09:16,420 --> 00:09:21,240
that you can do some correlation between

193
00:09:18,400 --> 00:09:25,240
the<font color="#E5E5E5"> different logs maybe SMB logs and</font>

194
00:09:21,240 --> 00:09:27,370
maybe rdp logs and and then create a

195
00:09:25,240 --> 00:09:29,920
different notice that isn't built in by

196
00:09:27,370 --> 00:09:32,020
default you could do that<font color="#E5E5E5"> through the</font>

197
00:09:29,920 --> 00:09:34,510
notice framework which allows for

198
00:09:32,020 --> 00:09:38,050
alerting so once you do that it kind of

199
00:09:34,510 --> 00:09:39,850
cuts the time so you actually detect

200
00:09:38,050 --> 00:09:41,500
something malicious like pumping through

201
00:09:39,850 --> 00:09:42,970
each of those looking through each<font color="#CCCCCC"> of</font>

202
00:09:41,500 --> 00:09:44,410
those separate logs you can just go to

203
00:09:42,970 --> 00:09:46,000
the notice log and through the

204
00:09:44,410 --> 00:09:48,010
correlation there and if you want a

205
00:09:46,000 --> 00:09:49,480
background information then you could go

206
00:09:48,010 --> 00:09:52,960
into<font color="#E5E5E5"> those separate logs to get more</font>

207
00:09:49,480 --> 00:09:56,320
details and the files framework is

208
00:09:52,960 --> 00:09:59,140
something that I used<font color="#E5E5E5"> to</font><font color="#CCCCCC"> start to detect</font>

209
00:09:56,320 --> 00:10:01,510
this malicious SMB activity only because

210
00:09:59,140 --> 00:10:05,439
you want<font color="#E5E5E5"> to try to catch SMB files going</font>

211
00:10:01,510 --> 00:10:09,220
back and forth so the file framework was

212
00:10:05,440 --> 00:10:11,350
helpful<font color="#E5E5E5"> in doing so now the scripts that</font>

213
00:10:09,220 --> 00:10:13,180
I wrote i'll have the get help page for

214
00:10:11,350 --> 00:10:15,430
that it was three particular scripts

215
00:10:13,180 --> 00:10:20,099
<font color="#E5E5E5">just three use cases that</font><font color="#CCCCCC"> i found for</font>

216
00:10:15,430 --> 00:10:22,810
SMB one is if you have<font color="#CCCCCC"> an SMB file that</font>

217
00:10:20,100 --> 00:10:24,610
attacker you know they're all the system

218
00:10:22,810 --> 00:10:27,849
already inside your environment and now

219
00:10:24,610 --> 00:10:31,089
they're moving<font color="#CCCCCC"> on malicious files</font>

220
00:10:27,850 --> 00:10:33,880
between computers<font color="#CCCCCC"> mount them the file</font>

221
00:10:31,089 --> 00:10:35,680
shares so that's something that you

222
00:10:33,880 --> 00:10:38,230
would you<font color="#CCCCCC"> know have some interest in</font>

223
00:10:35,680 --> 00:10:40,660
detecting one thing one problem that's

224
00:10:38,230 --> 00:10:42,639
wrong with<font color="#CCCCCC"> that is that you have one</font>

225
00:10:40,660 --> 00:10:45,759
<font color="#CCCCCC">particular antivirus solution on your</font>

226
00:10:42,639 --> 00:10:48,639
network right and so if<font color="#CCCCCC"> that antivirus</font>

227
00:10:45,759 --> 00:10:52,269
solution mrs. that particular<font color="#E5E5E5"> binary on</font>

228
00:10:48,639 --> 00:10:55,600
that particular file then<font color="#E5E5E5"> again you're</font>

229
00:10:52,269 --> 00:10:56,860
in<font color="#E5E5E5"> the dark and so what I thought what</font>

230
00:10:55,600 --> 00:10:59,259
occurred to me was<font color="#E5E5E5"> like hey why don't</font>

231
00:10:56,860 --> 00:11:01,420
<font color="#E5E5E5">you just check the file to catch some</font>

232
00:10:59,259 --> 00:11:04,029
low-hanging fruit if there's known to be

233
00:11:01,420 --> 00:11:06,040
bad you can submit the hash to

234
00:11:04,029 --> 00:11:09,130
virustotal to see<font color="#CCCCCC"> ok what other</font>

235
00:11:06,040 --> 00:11:11,290
antivirus vendors are saying about this

236
00:11:09,130 --> 00:11:15,279
file and so what<font color="#E5E5E5"> I</font><font color="#CCCCCC"> did with this script</font>

237
00:11:11,290 --> 00:11:17,139
was that<font color="#CCCCCC"> anytime there's a file that was</font>

238
00:11:15,279 --> 00:11:20,050
transferred over SMB it'll take it will

239
00:11:17,139 --> 00:11:22,480
use the front the<font color="#CCCCCC"> file framework to grab</font>

240
00:11:20,050 --> 00:11:25,569
the hash and take the hash using

241
00:11:22,480 --> 00:11:27,100
virustotal<font color="#CCCCCC"> API with the API key and send</font>

242
00:11:25,569 --> 00:11:29,979
it to virustotal and if it comes<font color="#E5E5E5"> back</font>

243
00:11:27,100 --> 00:11:31,690
with a certain amount of positives then

244
00:11:29,980 --> 00:11:36,279
it would generate a notice to the notice

245
00:11:31,690 --> 00:11:42,370
log so that's low hanging fruit but it's

246
00:11:36,279 --> 00:11:46,180
a start right and so accessing SMB

247
00:11:42,370 --> 00:11:48,519
shears admin shares so you might have

248
00:11:46,180 --> 00:11:51,339
some administrators<font color="#CCCCCC"> that might do this</font>

249
00:11:48,519 --> 00:11:55,029
before the most part this shouldn't be

250
00:11:51,339 --> 00:11:58,089
happening so this is access to IPC

251
00:11:55,029 --> 00:12:00,689
dollar sign admin dollar sign see dollar

252
00:11:58,089 --> 00:12:04,300
sign d dollar signs for like your<font color="#CCCCCC"> drives</font>

253
00:12:00,689 --> 00:12:06,490
in a normal environment<font color="#CCCCCC"> I tested at home</font>

254
00:12:04,300 --> 00:12:09,250
and like an elaborate vironment but<font color="#CCCCCC"> your</font>

255
00:12:06,490 --> 00:12:10,720
if you have<font color="#CCCCCC"> file-sharing enabled</font>

256
00:12:09,250 --> 00:12:13,120
throughout your network you<font color="#CCCCCC"> would have a</font>

257
00:12:10,720 --> 00:12:14,500
lot<font color="#CCCCCC"> of activity between the domain</font>

258
00:12:13,120 --> 00:12:16,509
controller and maybe host on your

259
00:12:14,500 --> 00:12:17,949
network so if you want you could take

260
00:12:16,509 --> 00:12:19,810
the script<font color="#E5E5E5"> for the adventure these a</font>

261
00:12:17,949 --> 00:12:21,969
little<font color="#E5E5E5"> further and put in some white</font>

262
00:12:19,810 --> 00:12:24,849
listing for stuff that you know it's

263
00:12:21,970 --> 00:12:26,800
<font color="#E5E5E5">kind of normal but in this case this</font>

264
00:12:24,850 --> 00:12:30,579
shouldn't be happening too often and so

265
00:12:26,800 --> 00:12:34,920
<font color="#CCCCCC">anytime that occurs it will send notice</font>

266
00:12:30,579 --> 00:12:34,920
it was sent up<font color="#E5E5E5"> alert to the notice log</font>

267
00:12:36,279 --> 00:12:43,180
<font color="#E5E5E5">okay so in most environments everyone</font>

268
00:12:40,610 --> 00:12:46,850
has a naming convention similar to this

269
00:12:43,180 --> 00:12:50,449
and so what I found<font color="#E5E5E5"> interesting in the</font>

270
00:12:46,850 --> 00:12:52,939
ntlm log which I'll get into later a

271
00:12:50,449 --> 00:12:56,508
particular a particular tool that are

272
00:12:52,939 --> 00:12:58,790
that<font color="#E5E5E5"> is used by pen testers if they're</font>

273
00:12:56,509 --> 00:13:02,139
sloppy and they do not change the

274
00:12:58,790 --> 00:13:05,120
hostname of that particular distribution

275
00:13:02,139 --> 00:13:06,949
then the host name is a<font color="#E5E5E5"> random hostname</font>

276
00:13:05,120 --> 00:13:08,810
that doesn't match your company's name a

277
00:13:06,949 --> 00:13:11,449
convention<font color="#CCCCCC"> and ntlm log and that's</font>

278
00:13:08,810 --> 00:13:13,819
<font color="#E5E5E5">another way to detect some malicious</font>

279
00:13:11,449 --> 00:13:16,069
activity going on so for this is like

280
00:13:13,819 --> 00:13:19,040
hey<font color="#CCCCCC"> Sekhmet is our company name</font><font color="#E5E5E5"> and it's</font>

281
00:13:16,069 --> 00:13:21,649
a<font color="#CCCCCC"> Windows device and it's a host and</font>

282
00:13:19,040 --> 00:13:24,649
it's located<font color="#E5E5E5"> in Virginia and we gave her</font>

283
00:13:21,649 --> 00:13:28,220
the tagging ideas 001 so anything

284
00:13:24,649 --> 00:13:31,250
outside of the script basically checks

285
00:13:28,220 --> 00:13:35,959
for any ntlm from<font color="#CCCCCC"> a</font><font color="#E5E5E5"> hostname that's</font>

286
00:13:31,250 --> 00:13:39,889
outside of this naming convention and

287
00:13:35,959 --> 00:13:45,529
then we'll send it<font color="#E5E5E5"> to the notice log and</font>

288
00:13:39,889 --> 00:13:46,870
so<font color="#CCCCCC"> I'll get into a quick demo I don't</font>

289
00:13:45,529 --> 00:13:56,509
want to test the demo<font color="#E5E5E5"> gods so I</font>

290
00:13:46,870 --> 00:13:57,800
pre-recorded this<font color="#CCCCCC"> all right so give me</font>

291
00:13:56,509 --> 00:14:01,790
<font color="#CCCCCC">some background on what's going</font><font color="#E5E5E5"> on right</font>

292
00:13:57,800 --> 00:14:03,829
<font color="#E5E5E5">now so there's a maybe a penetration</font>

293
00:14:01,790 --> 00:14:07,310
tester a malicious actor that's out

294
00:14:03,829 --> 00:14:10,219
there that has compromised a system on

295
00:14:07,310 --> 00:14:11,689
the network<font color="#E5E5E5"> and now this is them going</font>

296
00:14:10,220 --> 00:14:13,220
through the process of moving laterally

297
00:14:11,689 --> 00:14:16,130
and look at the files of interest and

298
00:14:13,220 --> 00:14:18,470
moving files from system to system so

299
00:14:16,130 --> 00:14:20,990
this is<font color="#CCCCCC"> the view from the attacker side</font>

300
00:14:18,470 --> 00:14:22,370
and then it will switch<font color="#CCCCCC"> to the analyst</font>

301
00:14:20,990 --> 00:14:24,559
side where you'll get to see some<font color="#E5E5E5"> of the</font>

302
00:14:22,370 --> 00:14:26,329
prologue so the analyst doesn't have any

303
00:14:24,559 --> 00:14:27,620
background about what just happened this

304
00:14:26,329 --> 00:14:33,359
is just<font color="#E5E5E5"> a view that we're seeing from</font>

305
00:14:27,620 --> 00:14:35,790
the<font color="#E5E5E5"> attacker side yep</font>

306
00:14:33,360 --> 00:14:37,860
and so here is a remote desktop with

307
00:14:35,790 --> 00:14:40,740
some credentials that they've<font color="#CCCCCC"> had on the</font>

308
00:14:37,860 --> 00:14:44,820
network so remote desktop RDP to some

309
00:14:40,740 --> 00:14:47,940
machine on their internal network now

310
00:14:44,820 --> 00:14:49,709
you're launching sysinternals<font color="#E5E5E5"> PS exact</font>

311
00:14:47,940 --> 00:14:53,000
to kind of blend in with regular traffic

312
00:14:49,709 --> 00:14:56,130
and so they're using<font color="#E5E5E5"> pH exec to</font>

313
00:14:53,000 --> 00:14:59,070
basically you know spawn a command show

314
00:14:56,130 --> 00:15:02,790
on another box in their environment so

315
00:14:59,070 --> 00:15:07,829
you see they logged<font color="#CCCCCC"> into</font><font color="#E5E5E5"> dot 106 and now</font>

316
00:15:02,790 --> 00:15:11,969
they're<font color="#E5E5E5"> going to 1 dot 107 so this is a</font>

317
00:15:07,829 --> 00:15:14,609
PS exec service that is starting by the

318
00:15:11,970 --> 00:15:16,560
way as an as an attacker this is pretty

319
00:15:14,610 --> 00:15:17,760
noisy and a lot of attackers are moving

320
00:15:16,560 --> 00:15:20,459
away from<font color="#E5E5E5"> this so they use this stuff</font>

321
00:15:17,760 --> 00:15:21,930
like wmi exec and SMB exec and that

322
00:15:20,459 --> 00:15:27,449
could be detected to with some of the

323
00:15:21,930 --> 00:15:29,069
skills I've introduced and so they now

324
00:15:27,450 --> 00:15:30,390
are on the system they went to the

325
00:15:29,070 --> 00:15:34,140
desktop and now they're<font color="#CCCCCC"> looking for</font>

326
00:15:30,390 --> 00:15:37,829
files of interest so they<font color="#E5E5E5"> found this</font>

327
00:15:34,140 --> 00:15:39,750
daily list and check out that list<font color="#E5E5E5"> you</font>

328
00:15:37,829 --> 00:15:41,699
know there's lunch involved there's

329
00:15:39,750 --> 00:15:43,350
<font color="#E5E5E5">brief the director on bro IDs and then</font>

330
00:15:41,699 --> 00:15:45,060
well at the bottom go home and drink

331
00:15:43,350 --> 00:15:48,959
some beer because who doesn't love beer

332
00:15:45,060 --> 00:15:50,250
after a long day of work and so now

333
00:15:48,959 --> 00:15:51,329
<font color="#CCCCCC">they've jumped out of that and now</font>

334
00:15:50,250 --> 00:15:53,459
they're going<font color="#E5E5E5"> to the documents because</font>

335
00:15:51,329 --> 00:15:56,910
hey there are always<font color="#E5E5E5"> good things in the</font>

336
00:15:53,459 --> 00:15:58,500
documents folder so there's a text

337
00:15:56,910 --> 00:16:00,329
<font color="#CCCCCC">volunteer called few</font><font color="#E5E5E5"> clear location and</font>

338
00:15:58,500 --> 00:16:03,089
maybe sounds<font color="#E5E5E5"> like it might be of</font>

339
00:16:00,329 --> 00:16:05,489
interest what's in there so there's a

340
00:16:03,089 --> 00:16:08,459
business<font color="#E5E5E5"> deal going down with Bugs Bunny</font>

341
00:16:05,490 --> 00:16:11,490
and<font color="#E5E5E5"> this carrots involved and there's</font><font color="#CCCCCC"> a</font>

342
00:16:08,459 --> 00:16:13,290
location so that's something<font color="#CCCCCC"> that hey</font>

343
00:16:11,490 --> 00:16:14,910
now that attackers gain<font color="#E5E5E5"> that information</font>

344
00:16:13,290 --> 00:16:16,199
and maybe they could disrupt the deal or

345
00:16:14,910 --> 00:16:21,630
take someone out before they get to<font color="#CCCCCC"> the</font>

346
00:16:16,199 --> 00:16:25,380
deal now this<font color="#E5E5E5"> is the attacker using</font>

347
00:16:21,630 --> 00:16:30,810
xcopy to move windows windows update<font color="#E5E5E5"> exe</font>

348
00:16:25,380 --> 00:16:32,399
to the other system that 107 and you'll

349
00:16:30,810 --> 00:16:36,719
see this activity pretty<font color="#E5E5E5"> soon so they</font>

350
00:16:32,399 --> 00:16:38,430
<font color="#E5E5E5">moved it to their arm desktop right the</font>

351
00:16:36,720 --> 00:16:40,350
windows update exe de move it to the

352
00:16:38,430 --> 00:16:42,540
desktop on that same system and now

353
00:16:40,350 --> 00:16:45,529
they're going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> execute that windows</font>

354
00:16:42,540 --> 00:16:45,529
<font color="#CCCCCC">update exe</font>

355
00:16:46,690 --> 00:16:54,260
and guess what it is<font color="#E5E5E5"> Mimi cat and so</font>

356
00:16:53,060 --> 00:16:58,250
from here they're just going<font color="#E5E5E5"> to use the</font>

357
00:16:54,260 --> 00:17:02,780
<font color="#E5E5E5">mimic at school to dump some credential</font>

358
00:16:58,250 --> 00:17:06,290
information I learned a little bit about

359
00:17:02,780 --> 00:17:09,770
Mimi cats with this too<font color="#CCCCCC"> I restarted the</font>

360
00:17:06,290 --> 00:17:15,109
virtual machine before this and so the

361
00:17:09,770 --> 00:17:17,569
logon passwords like<font color="#E5E5E5"> or no because</font>

362
00:17:15,109 --> 00:17:19,790
there's no it's not cached anything the

363
00:17:17,569 --> 00:17:22,399
credentials are cash so me being a

364
00:17:19,790 --> 00:17:25,010
defender I'm always using some attacker

365
00:17:22,400 --> 00:17:27,140
to move to kind of get a wrap my mind

366
00:17:25,010 --> 00:17:29,690
around what's going on and that's<font color="#E5E5E5"> just</font>

367
00:17:27,140 --> 00:17:32,120
something interesting I learned I advise

368
00:17:29,690 --> 00:17:34,520
anyone to who's a defender to actually

369
00:17:32,120 --> 00:17:36,290
use some of these um offensive tools to

370
00:17:34,520 --> 00:17:37,760
get<font color="#E5E5E5"> a handle</font><font color="#CCCCCC"> of what attackers are</font>

371
00:17:36,290 --> 00:17:42,080
actually using or even pen testers or

372
00:17:37,760 --> 00:17:46,040
red teamers so now this<font color="#CCCCCC"> is kali linux</font>

373
00:17:42,080 --> 00:17:49,280
this is<font color="#CCCCCC"> metasploit consult they're using</font>

374
00:17:46,040 --> 00:17:51,889
the<font color="#CCCCCC"> metasploit PX exact module to do the</font>

375
00:17:49,280 --> 00:17:59,149
<font color="#E5E5E5">same thing and we'll see what that</font><font color="#CCCCCC"> looks</font>

376
00:17:51,890 --> 00:18:00,410
like surely on<font color="#CCCCCC"> an analyst side so</font>

377
00:17:59,150 --> 00:18:04,010
they're<font color="#CCCCCC"> using those same credentials</font>

378
00:18:00,410 --> 00:18:09,410
from Daffy Duck that they used<font color="#E5E5E5"> to rdp to</font>

379
00:18:04,010 --> 00:18:12,790
the other system and now this is<font color="#E5E5E5"> from</font>

380
00:18:09,410 --> 00:18:15,800
the airless slide so as an analyst bio

381
00:18:12,790 --> 00:18:19,190
find<font color="#E5E5E5"> on my bro logs let's look in the</font>

382
00:18:15,800 --> 00:18:21,940
notice log see if there's anything

383
00:18:19,190 --> 00:18:21,940
interesting there

384
00:18:25,289 --> 00:18:30,820
whoa that's pretty ugly but luckily

385
00:18:29,019 --> 00:18:34,889
enough I highlighted it so it's better

386
00:18:30,820 --> 00:18:37,960
on eyes so now you see that PS exact um

387
00:18:34,889 --> 00:18:40,719
sec exe and now submitted to virustotal

388
00:18:37,960 --> 00:18:42,970
with a hit count of three positives and

389
00:18:40,720 --> 00:18:45,729
so I only sees that like hey I want<font color="#E5E5E5"> to</font>

390
00:18:42,970 --> 00:18:51,429
see more<font color="#E5E5E5"> about this file he goes through</font>

391
00:18:45,729 --> 00:18:56,470
<font color="#E5E5E5">virustotal and looks up the hash just a</font>

392
00:18:51,429 --> 00:19:00,129
confirm that is PS exact<font color="#CCCCCC"> shots we could</font>

393
00:18:56,470 --> 00:19:02,169
<font color="#E5E5E5">be safe here and so this is just season</font>

394
00:19:00,129 --> 00:19:05,379
<font color="#CCCCCC">arm the script itself just uses the</font>

395
00:19:02,169 --> 00:19:07,809
<font color="#E5E5E5">virus total API to grab the JSON down</font>

396
00:19:05,379 --> 00:19:14,019
and parts it and then get<font color="#E5E5E5"> some of these</font>

397
00:19:07,809 --> 00:19:16,749
feels and so we want<font color="#E5E5E5"> to see what other</font>

398
00:19:14,019 --> 00:19:18,129
activity using that ID that we saw we

399
00:19:16,749 --> 00:19:22,269
want to see what other activity canceled

400
00:19:18,129 --> 00:19:26,259
<font color="#E5E5E5">in that PS exact and so you can see the</font>

401
00:19:22,269 --> 00:19:27,909
use of the admin dollar sign so you can

402
00:19:26,259 --> 00:19:31,200
call you caught the PS exact and the use

403
00:19:27,909 --> 00:19:33,039
of the admin dollar sign in that case

404
00:19:31,200 --> 00:19:37,029
now we're going<font color="#E5E5E5"> to look at the notice</font>

405
00:19:33,039 --> 00:19:41,229
log again and sure enough we see windows

406
00:19:37,029 --> 00:19:42,879
update exe that<font color="#CCCCCC"> gotta hit count of 39 we</font>

407
00:19:41,229 --> 00:19:49,629
know that as<font color="#CCCCCC"> many cats but as an analyst</font>

408
00:19:42,879 --> 00:19:50,978
he's about to have a really bad day<font color="#CCCCCC"> cuz</font>

409
00:19:49,629 --> 00:19:53,349
there's no context around that right

410
00:19:50,979 --> 00:19:59,590
<font color="#CCCCCC">just you hit count of 39 you're like oh</font>

411
00:19:53,349 --> 00:20:08,080
and yeah<font color="#CCCCCC"> Mimi cats anytime you have many</font>

412
00:19:59,590 --> 00:20:09,009
cats on your network of that day and<font color="#E5E5E5"> so</font>

413
00:20:08,080 --> 00:20:11,889
we're going to look at some of the

414
00:20:09,009 --> 00:20:16,080
activity that<font color="#CCCCCC"> I came</font><font color="#E5E5E5"> from the copying of</font>

415
00:20:11,889 --> 00:20:21,158
that Mimi cats file to the other system

416
00:20:16,080 --> 00:20:24,908
it's like a type and demos and so you

417
00:20:21,159 --> 00:20:28,950
see<font color="#CCCCCC"> the IPC um dollar signs share was</font>

418
00:20:24,909 --> 00:20:28,950
used to copy<font color="#E5E5E5"> that using xcopy</font>

419
00:20:29,580 --> 00:20:36,760
so now we're<font color="#CCCCCC"> back in the notice log and</font>

420
00:20:32,460 --> 00:20:38,640
sure enough he is exact and that PS is

421
00:20:36,760 --> 00:20:41,140
that I mean PS<font color="#CCCCCC"> exec for metasploit</font>

422
00:20:38,640 --> 00:20:44,080
created that randomized suspicious

423
00:20:41,140 --> 00:20:47,980
hostname that now if<font color="#CCCCCC"> flag said potential</font>

424
00:20:44,080 --> 00:20:51,960
rogue hostname on the network<font color="#CCCCCC"> and I</font>

425
00:20:47,980 --> 00:20:54,760
<font color="#E5E5E5">found what was interesting this is ntlm</font>

426
00:20:51,960 --> 00:20:57,280
it's<font color="#E5E5E5"> different ntlm version that's used</font>

427
00:20:54,760 --> 00:21:00,100
<font color="#CCCCCC">I think it's like version one that's</font>

428
00:20:57,280 --> 00:21:02,440
flag because initially the script was 44

429
00:21:00,100 --> 00:21:04,780
version 2 and it didn't pick<font color="#CCCCCC"> it up and</font><font color="#E5E5E5"> I</font>

430
00:21:02,440 --> 00:21:07,600
was like wondering why and I looked and

431
00:21:04,780 --> 00:21:12,670
pulled a pcap and its version<font color="#CCCCCC"> 1 which</font>

432
00:21:07,600 --> 00:21:14,770
was weird what and so you see<font color="#E5E5E5"> the use of</font>

433
00:21:12,670 --> 00:21:20,380
<font color="#E5E5E5">I can see dollar sign admin dollar side</font>

434
00:21:14,770 --> 00:21:21,760
with metasploit<font color="#CCCCCC"> Pierce exec and so now</font>

435
00:21:20,380 --> 00:21:24,880
we're just going through and getting

436
00:21:21,760 --> 00:21:28,300
some more<font color="#CCCCCC"> information</font><font color="#E5E5E5"> about the activity</font>

437
00:21:24,880 --> 00:21:34,210
that occurred from the logs themselves

438
00:21:28,300 --> 00:21:37,300
that were used in the scripts so here<font color="#CCCCCC"> we</font>

439
00:21:34,210 --> 00:21:39,400
are<font color="#E5E5E5"> going to SMB</font><font color="#CCCCCC"> are mapping log and</font>

440
00:21:37,300 --> 00:21:41,530
this gives you the idea of some of the

441
00:21:39,400 --> 00:21:47,320
shares that were don't actually use

442
00:21:41,530 --> 00:21:49,389
throughout that whole activity also<font color="#CCCCCC"> the</font>

443
00:21:47,320 --> 00:21:52,990
files log it gives the idea of what's in

444
00:21:49,390 --> 00:21:56,800
the files log um you have the name<font color="#CCCCCC"> of</font>

445
00:21:52,990 --> 00:21:59,140
<font color="#E5E5E5">the file and also the file share that</font>

446
00:21:56,800 --> 00:22:01,480
was used so<font color="#E5E5E5"> this is an SMB files log not</font>

447
00:21:59,140 --> 00:22:03,970
the general files log this<font color="#E5E5E5"> is a general</font>

448
00:22:01,480 --> 00:22:06,840
PE log right here that<font color="#E5E5E5"> tells you hey</font>

449
00:22:03,970 --> 00:22:06,840
<font color="#CCCCCC">it's a Windows executable</font>

450
00:22:13,940 --> 00:22:18,360
yes what's interesting about this is

451
00:22:16,620 --> 00:22:19,830
<font color="#E5E5E5">before this this talk is actually a</font>

452
00:22:18,360 --> 00:22:23,310
spin-off of a gold paper that I've

453
00:22:19,830 --> 00:22:25,260
written for<font color="#E5E5E5"> sands and before that I've</font>

454
00:22:23,310 --> 00:22:28,950
never worked with bro in an environment

455
00:22:25,260 --> 00:22:31,740
setting or even you know long-term this

456
00:22:28,950 --> 00:22:35,810
this paper was opportunity for me to

457
00:22:31,740 --> 00:22:38,250
actually deep dive and toubro itself and

458
00:22:35,810 --> 00:22:40,740
create some use cases<font color="#E5E5E5"> that I would use</font>

459
00:22:38,250 --> 00:22:45,150
<font color="#E5E5E5">in my own day-to-day job as an incident</font>

460
00:22:40,740 --> 00:22:48,030
responder also one<font color="#E5E5E5"> thing to note is that</font>

461
00:22:45,150 --> 00:22:51,030
from a detective<font color="#CCCCCC"> from a detection</font>

462
00:22:48,030 --> 00:22:52,830
perspective a lot<font color="#E5E5E5"> of you know you hear a</font>

463
00:22:51,030 --> 00:22:56,129
lot of<font color="#E5E5E5"> red teamers or a lot of pen sets</font>

464
00:22:52,830 --> 00:22:58,020
to say hey oh you know defenders have to

465
00:22:56,130 --> 00:23:02,100
close<font color="#CCCCCC"> up all these holes and once we're</font>

466
00:22:58,020 --> 00:23:06,450
in we're in I like to<font color="#E5E5E5"> combat that a</font>

467
00:23:02,100 --> 00:23:09,120
little bit if you're in a secure sock or

468
00:23:06,450 --> 00:23:13,080
<font color="#E5E5E5">a secure security environment and you're</font>

469
00:23:09,120 --> 00:23:15,179
very<font color="#E5E5E5"> mature you could actually kind of</font>

470
00:23:13,080 --> 00:23:16,919
raise their level<font color="#E5E5E5"> two because once that</font>

471
00:23:15,180 --> 00:23:18,420
activity is flagged and then<font color="#E5E5E5"> having</font>

472
00:23:16,920 --> 00:23:20,700
carried out all their operations that

473
00:23:18,420 --> 00:23:22,320
they wanted<font color="#E5E5E5"> to yes they're inside but</font>

474
00:23:20,700 --> 00:23:24,030
nothing has happened so if you caught

475
00:23:22,320 --> 00:23:26,730
them at the<font color="#E5E5E5"> side that hey they got you</font>

476
00:23:24,030 --> 00:23:28,410
know Pierce exact running they got Mimi

477
00:23:26,730 --> 00:23:30,000
cats running and now they just have her

478
00:23:28,410 --> 00:23:32,370
then they got the credential dumped on

479
00:23:30,000 --> 00:23:35,640
<font color="#CCCCCC">they're moving laterally you can now</font>

480
00:23:32,370 --> 00:23:38,340
detect them root them out and<font color="#E5E5E5"> when</font><font color="#CCCCCC"> you</font>

481
00:23:35,640 --> 00:23:40,920
root them out and<font color="#E5E5E5"> now</font><font color="#CCCCCC"> know hey they pick</font>

482
00:23:38,340 --> 00:23:42,840
that up and so now<font color="#CCCCCC"> the bar to entry to</font>

483
00:23:40,920 --> 00:23:45,600
come back in and get to that same step

484
00:23:42,840 --> 00:23:47,550
is a lot harder um and so<font color="#E5E5E5"> that's</font>

485
00:23:45,600 --> 00:23:50,250
something<font color="#E5E5E5"> macswan from</font><font color="#CCCCCC"> Microsoft</font>

486
00:23:47,550 --> 00:23:52,440
introduced a little while back the

487
00:23:50,250 --> 00:23:55,980
incident response pyramid and so with

488
00:23:52,440 --> 00:23:58,650
this you<font color="#CCCCCC"> can track its different steps</font>

489
00:23:55,980 --> 00:24:02,630
that these broad scripts can can be part

490
00:23:58,650 --> 00:24:06,570
of the detection part<font color="#E5E5E5"> actually tracking</font>

491
00:24:02,630 --> 00:24:09,870
adversary activity you could<font color="#E5E5E5"> use bro for</font>

492
00:24:06,570 --> 00:24:12,720
hunting with some of these SMB logs so

493
00:24:09,870 --> 00:24:15,149
it's literally<font color="#CCCCCC"> the bro detecting in this</font>

494
00:24:12,720 --> 00:24:17,990
case the attacker bro<font color="#CCCCCC"> because hey we all</font>

495
00:24:15,150 --> 00:24:17,990
like<font color="#CCCCCC"> to name attackers</font>

496
00:24:19,070 --> 00:24:25,639
and that's the<font color="#E5E5E5"> end of my talk I'll put</font>

497
00:24:21,919 --> 00:24:28,309
the slides out on my blog security never

498
00:24:25,639 --> 00:24:29,719
sleeps net<font color="#E5E5E5"> um and the scripts are in</font>

499
00:24:28,309 --> 00:24:30,918
<font color="#E5E5E5">this location so i want to take a</font>

500
00:24:29,720 --> 00:24:33,380
screenshot you<font color="#E5E5E5"> could take a screenshot</font>

501
00:24:30,919 --> 00:24:36,110
of that and you<font color="#E5E5E5"> have any questions find</font>

502
00:24:33,380 --> 00:24:39,700
me here on and my twitter handle is RR

503
00:24:36,110 --> 00:24:39,699
Cyrus thank you

