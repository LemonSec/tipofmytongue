1
00:00:30,630 --> 00:00:33,699
I'm pretty loud as it is expect to be

2
00:00:33,699 --> 00:00:34,809
too many problems with that

3
00:00:34,809 --> 00:00:39,989
all right so this is burping for joy and

4
00:00:39,989 --> 00:00:42,879
financial gain as you can imagine we're

5
00:00:42,879 --> 00:00:45,460
going to be talking about burp suite by

6
00:00:45,460 --> 00:00:48,159
the tool by port swagger I'm as far as

7
00:00:48,159 --> 00:00:49,449
kind of the title where it came from

8
00:00:49,449 --> 00:00:51,070
I've always told myself that I would

9
00:00:51,070 --> 00:00:54,070
never go to or give a talk the head for

10
00:00:54,070 --> 00:00:56,440
fun and profit in it and service is my

11
00:00:56,440 --> 00:00:57,760
way of using that without actually using

12
00:00:57,760 --> 00:01:00,339
it it's a little against myself so Who

13
00:01:00,339 --> 00:01:03,159
am I Landmaster 53 for those of you that

14
00:01:03,159 --> 00:01:05,019
are into the Twitter thing and social

15
00:01:05,019 --> 00:01:07,060
media you can usually find me by that

16
00:01:07,060 --> 00:01:09,100
handle a husband father and veteran

17
00:01:09,100 --> 00:01:12,250
those are my priorities in life a coder

18
00:01:12,250 --> 00:01:17,350
so I do some do some coding I wrote a

19
00:01:17,350 --> 00:01:19,330
tool called recon ng and a couple things

20
00:01:19,330 --> 00:01:21,400
honey badger framework I just I really

21
00:01:21,400 --> 00:01:22,720
enjoy writing code been doing it for

22
00:01:22,720 --> 00:01:23,680
most of my life it's kind of where my

23
00:01:23,680 --> 00:01:26,409
passion lies in software which is kind

24
00:01:26,409 --> 00:01:27,729
of how I got into application security

25
00:01:27,729 --> 00:01:29,079
in the first place it really was a

26
00:01:29,079 --> 00:01:31,390
natural transition for me I also

27
00:01:31,390 --> 00:01:33,759
consider myself a breaker as of next

28
00:01:33,759 --> 00:01:36,640
Tuesday I will be a freelance consultant

29
00:01:36,640 --> 00:01:39,729
working under my own company called

30
00:01:39,729 --> 00:01:42,039
practical security services currently I

31
00:01:42,039 --> 00:01:43,569
work for a company called envision which

32
00:01:43,569 --> 00:01:46,179
is a software security firm I'm a

33
00:01:46,179 --> 00:01:46,509
teacher

34
00:01:46,509 --> 00:01:48,159
independent instructor I used to teach

35
00:01:48,159 --> 00:01:50,079
for sans used to teach at blackhat so on

36
00:01:50,079 --> 00:01:51,609
and so forth but lately I've kind of

37
00:01:51,609 --> 00:01:54,249
taken training over on my own under my

38
00:01:54,249 --> 00:01:56,020
company's LLC and I teach a course

39
00:01:56,020 --> 00:01:57,909
called practical web application

40
00:01:57,909 --> 00:02:00,670
penetration testing a wapt you may have

41
00:02:00,670 --> 00:02:02,920
seen it or heard of it around so I did

42
00:02:02,920 --> 00:02:04,929
the teaching thing it is a it is a port

43
00:02:04,929 --> 00:02:07,749
swagger burp suite or port speaker

44
00:02:07,749 --> 00:02:11,410
preferred training class for Bart so

45
00:02:11,410 --> 00:02:12,610
it's on their web site and stuff if

46
00:02:12,610 --> 00:02:14,980
you're interested in that you learn a

47
00:02:14,980 --> 00:02:16,390
lot about burp in that class a whole lot

48
00:02:16,390 --> 00:02:17,860
some of the stuff we're going to talk

49
00:02:17,860 --> 00:02:19,569
about here are things that I expand on a

50
00:02:19,569 --> 00:02:21,400
little bit more in the class I'm also a

51
00:02:21,400 --> 00:02:23,590
share a blog and post things and my

52
00:02:23,590 --> 00:02:24,680
projects and everything

53
00:02:24,680 --> 00:02:31,640
at WWE three calm and I do all of this

54
00:02:31,640 --> 00:02:33,019
stuff because it's what I believe I was

55
00:02:33,019 --> 00:02:36,049
created to do and I find great joy and

56
00:02:36,049 --> 00:02:39,049
serving out my god-given purpose so

57
00:02:39,049 --> 00:02:41,000
that's why I'm here today

58
00:02:41,000 --> 00:02:43,340
alright so my outline you can see where

59
00:02:43,340 --> 00:03:34,669
you are some sort of joy or the ability

60
00:03:34,669 --> 00:03:37,280
to make more money so probably we'll see

61
00:03:37,280 --> 00:03:38,359
maybe maybe not

62
00:03:38,359 --> 00:03:41,590
so our disclaimer here

63
00:03:42,390 --> 00:03:45,609
[Music]

64
00:04:05,320 --> 00:04:08,509
[Music]

65
00:04:19,529 --> 00:04:24,810
[Music]

66
00:04:24,810 --> 00:04:27,010
I'm just going to teach you based on my

67
00:04:27,010 --> 00:04:29,140
experience and that's kind of what I'm

68
00:04:29,140 --> 00:04:31,630
here to do so naturally take that with a

69
00:04:31,630 --> 00:04:34,150
grain of salt so the first thing I want

70
00:04:34,150 --> 00:04:35,980
to talk about with embark like I said

71
00:04:35,980 --> 00:04:38,850
simple stuff

72
00:04:38,980 --> 00:04:56,989
[Music]

73
00:05:14,030 --> 00:05:17,190
[Music]

74
00:05:24,970 --> 00:05:29,120
different endpoints with intruder right

75
00:05:29,120 --> 00:05:30,590
you might want to be able to name this

76
00:05:30,590 --> 00:05:32,060
thing so later on in the week or later

77
00:05:32,060 --> 00:05:33,500
on the assessment and you go back and

78
00:05:33,500 --> 00:05:35,000
you want to reflux or relook at some of

79
00:05:35,000 --> 00:05:38,630
those results quickly and see where

80
00:05:38,630 --> 00:05:41,570
you're at so let's bounce over here to -

81
00:05:41,570 --> 00:05:43,580
burp and pone tub real quick and I'll

82
00:05:43,580 --> 00:05:45,650
kind of show you how and why I use it

83
00:05:45,650 --> 00:05:48,229
that way so phone hub is an application

84
00:05:48,229 --> 00:05:49,850
that I wrote it's the source is

85
00:05:49,850 --> 00:05:51,169
available I don't necessarily consider

86
00:05:51,169 --> 00:05:53,600
it open source in a sense that I don't

87
00:05:53,600 --> 00:05:56,270
care if you use it for personal practice

88
00:05:56,270 --> 00:05:57,860
and demonstrations and stuff like this

89
00:05:57,860 --> 00:05:59,900
but I would prefer folks not take it and

90
00:05:59,900 --> 00:06:01,130
then use it in a class or something to

91
00:06:01,130 --> 00:06:02,810
make money with it that's kind of my

92
00:06:02,810 --> 00:06:05,030
intent for it so I'm sharing the source

93
00:06:05,030 --> 00:06:07,370
code it's a flask app so it's written in

94
00:06:07,370 --> 00:06:09,440
Python and it uses some react on the

95
00:06:09,440 --> 00:06:10,760
front end and some other stuff as well

96
00:06:10,760 --> 00:06:12,919
but this will be kind of the app that we

97
00:06:12,919 --> 00:06:14,120
used to demonstrate everything that

98
00:06:14,120 --> 00:06:16,220
we're doing today all right so basically

99
00:06:16,220 --> 00:06:18,740
I've got a soap web service built into

100
00:06:18,740 --> 00:06:22,669
this thing and here it is and of course

101
00:06:22,669 --> 00:06:24,349
we want to pull down the wisdom file for

102
00:06:24,349 --> 00:06:28,550
it you have the wisdom file here and if

103
00:06:28,550 --> 00:06:30,139
you use burp then you may or may not

104
00:06:30,139 --> 00:06:32,449
have played with this extension called

105
00:06:32,449 --> 00:06:35,229
wisdom which is a really nice extension

106
00:06:35,229 --> 00:06:38,090
that will parse wisdom files and give

107
00:06:38,090 --> 00:06:40,340
you the ability to it'll create a sample

108
00:06:40,340 --> 00:06:41,900
request for the soap web service and

109
00:06:41,900 --> 00:06:43,070
then it'll give you the ability to

110
00:06:43,070 --> 00:06:44,389
interact with it floods different

111
00:06:44,389 --> 00:06:46,310
parameters and stuff like that so what

112
00:06:46,310 --> 00:06:47,750
I'm gonna do here is I'm gonna go and

113
00:06:47,750 --> 00:06:49,430
find this in my history where I loaded

114
00:06:49,430 --> 00:06:53,210
that wisdom file right click on it parse

115
00:06:53,210 --> 00:06:56,870
it and if we click over here and whizzed

116
00:06:56,870 --> 00:06:59,120
alure you'll see that now we have we

117
00:06:59,120 --> 00:07:00,860
haven't one operation in this service

118
00:07:00,860 --> 00:07:03,500
called tools okay that's here is a very

119
00:07:03,500 --> 00:07:05,150
claim very plain to seeing we can see

120
00:07:05,150 --> 00:07:08,479
this it's obvious now here if we click

121
00:07:08,479 --> 00:07:10,250
on that we have our sample recruit

122
00:07:10,250 --> 00:07:11,690
pressed we can right click it send it

123
00:07:11,690 --> 00:07:14,419
over to repeater and then here in

124
00:07:14,419 --> 00:07:16,580
repeater we have our sample request and

125
00:07:16,580 --> 00:07:18,710
now we can see here we can replay this

126
00:07:18,710 --> 00:07:20,599
we can manipulate parameters so on and

127
00:07:20,599 --> 00:07:22,500
so forth

128
00:07:22,500 --> 00:07:26,370
and then we may have 35 other operations

129
00:07:26,370 --> 00:07:28,680
that we want to do that with well if you

130
00:07:28,680 --> 00:07:32,130
look here within repeater it's just got

131
00:07:32,130 --> 00:07:33,930
this one there and if you look down

132
00:07:33,930 --> 00:07:36,510
within the service there's nothing real

133
00:07:36,510 --> 00:07:46,800
obvious with just say okay I'm dealing

134
00:07:46,800 --> 00:07:48,720
with tools info here you just double

135
00:07:48,720 --> 00:07:52,920
click the tab tools info and now you've

136
00:07:52,920 --> 00:07:54,360
got a reference that you can go back to

137
00:07:54,360 --> 00:08:01,980
it I have no idea what I'm going back to

138
00:08:01,980 --> 00:08:04,020
you I kept having to reparse wisdoms and

139
00:08:04,020 --> 00:08:05,700
re-export operations into repeater and

140
00:08:05,700 --> 00:08:07,380
so on and so forth and the ability to

141
00:08:07,380 --> 00:08:08,790
rename these tabs was just something

142
00:08:08,790 --> 00:08:09,870
that I was like you know what I don't

143
00:08:09,870 --> 00:08:11,310
know if anybody's like me and doesn't

144
00:08:11,310 --> 00:08:13,140
know about this but they need to so I'm

145
00:08:13,140 --> 00:08:14,790
gonna share it and we've done that now

146
00:08:14,790 --> 00:08:18,150
and I'm gonna prepare for a future demo

147
00:08:18,150 --> 00:08:21,480
here just by showing you or repeating

148
00:08:21,480 --> 00:08:22,530
this once and just kind of showing you

149
00:08:22,530 --> 00:08:24,810
the operation there so that's renaming

150
00:08:24,810 --> 00:08:27,360
cabs up so this next feature that's

151
00:08:27,360 --> 00:08:28,480
already built in a Berber

152
00:08:28,480 --> 00:08:31,629
[Music]

153
00:08:41,400 --> 00:08:44,480
[Music]

154
00:09:44,920 --> 00:09:46,220
[Music]

155
00:09:46,220 --> 00:09:49,200
within intruder okay so let's go ahead

156
00:09:49,200 --> 00:09:51,870
and look at this real quick if we go

157
00:09:51,870 --> 00:09:55,500
into our pone tub application the place

158
00:09:55,500 --> 00:09:57,180
I want to focus here is in our forgot

159
00:09:57,180 --> 00:10:00,180
password field so real quick to try to

160
00:10:00,180 --> 00:10:01,230
determine whether we have user

161
00:10:01,230 --> 00:10:03,660
enumeration here or not we can put in an

162
00:10:03,660 --> 00:10:07,110
obviously fake user like this it says

163
00:10:07,110 --> 00:10:09,750
user not recognized okay I already kind

164
00:10:09,750 --> 00:10:11,610
of know where this is going right and if

165
00:10:11,610 --> 00:10:16,250
I enter my actual user name what I get

166
00:10:52,040 --> 00:10:54,630
this is an actual attack that's got me

167
00:10:54,630 --> 00:10:57,710
to self a fortune five

168
00:11:00,770 --> 00:11:03,060
and all it took was being able to

169
00:11:03,060 --> 00:11:04,800
harvest that information for large

170
00:11:04,800 --> 00:11:07,470
numbers of potential user names so let's

171
00:11:07,470 --> 00:11:09,060
go in here and let's see what this looks

172
00:11:09,060 --> 00:11:11,490
like an intruder because we want to

173
00:11:11,490 --> 00:11:17,250
attack this all right so all right we

174
00:11:17,250 --> 00:11:21,690
have our base request our post let's

175
00:11:21,690 --> 00:11:23,220
right-click it we'll send it over to

176
00:11:23,220 --> 00:11:28,500
intruder positions the only position he

177
00:11:28,500 --> 00:11:31,350
wants the username here we're just

178
00:11:31,350 --> 00:11:32,940
replicating the behavior that we just

179
00:11:32,940 --> 00:11:35,250
did in the application itself and for

180
00:11:35,250 --> 00:11:37,170
our payloads I'm just gonna use a simple

181
00:11:37,170 --> 00:11:39,360
list here will type in some of the ones

182
00:11:39,360 --> 00:11:41,360
we already knew we tried to fake user

183
00:11:41,360 --> 00:11:50,060
will do Tim will do an admin will do

184
00:11:50,060 --> 00:11:58,200
hacker princess so you got some user

185
00:11:58,200 --> 00:12:00,000
names in there and we go ahead and

186
00:12:00,000 --> 00:12:01,680
actually I think we need to set this to

187
00:12:01,680 --> 00:12:03,360
follow redirects as well just because of

188
00:12:03,360 --> 00:12:06,480
the way the application behaves and then

189
00:12:06,480 --> 00:12:09,690
we'll start the attack and very quickly

190
00:12:09,690 --> 00:12:11,280
we can actually come up here and sort by

191
00:12:11,280 --> 00:12:14,370
length and see that we have this two

192
00:12:14,370 --> 00:12:15,990
four seven two four four seven two four

193
00:12:15,990 --> 00:12:17,910
four seven two four four seven and then

194
00:12:17,910 --> 00:12:20,040
a difference in size and very quickly

195
00:12:20,040 --> 00:12:30,480
based on the behavior we've already go

196
00:12:30,480 --> 00:12:32,790
in we can analyze that but the idea here

197
00:12:32,790 --> 00:12:34,650
is to talk about these rules and what

198
00:12:34,650 --> 00:12:35,790
that'll help us kind of even further

199
00:12:35,790 --> 00:12:37,800
determine this so once we have this

200
00:12:37,800 --> 00:12:39,060
information we're like okay we can

201
00:12:39,060 --> 00:12:40,710
determine which ones are valid invalid

202
00:12:40,710 --> 00:12:42,540
users but I still want that security

203
00:12:42,540 --> 00:12:45,180
question if we go into options and we

204
00:12:45,180 --> 00:12:47,850
scroll down here there's this section

205
00:12:47,850 --> 00:12:51,330
called grep extract and if we add a rule

206
00:12:51,330 --> 00:12:54,570
here what it does is his Berk will go

207
00:12:54,570 --> 00:12:57,230
ahead and make a base request

208
00:12:57,230 --> 00:13:00,230
the resulting HTML and then we can come

209
00:13:00,230 --> 00:13:01,700
down in here and find the information

210
00:13:01,700 --> 00:13:03,950
we're interested in in this particular

211
00:13:03,950 --> 00:13:05,990
case it's going to be the security

212
00:13:05,990 --> 00:13:09,440
question favorite food and if you notice

213
00:13:09,440 --> 00:13:10,730
here and this is kind of a cool feature

214
00:13:10,730 --> 00:13:13,400
in verb as you highlight this watch what

215
00:13:13,400 --> 00:13:19,460
happens up above as you highlight that

216
00:13:19,460 --> 00:13:23,950
it begins to build either deposits

217
00:13:23,950 --> 00:13:26,660
tracking that information out of the

218
00:13:26,660 --> 00:13:29,330
payload so once I do that I usually use

219
00:13:29,330 --> 00:13:30,710
regex just because I'm more comfortable

220
00:13:30,710 --> 00:13:33,110
with regex than I am string parsing you

221
00:13:33,110 --> 00:13:34,730
just select that I've got the regex

222
00:13:34,730 --> 00:13:37,070
hit okay and if I come back to my

223
00:13:37,070 --> 00:13:39,580
results what do I see

224
00:13:39,580 --> 00:13:51,110
I've now extracted that information to

225
00:13:51,110 --> 00:13:52,580
some of those and come back to this

226
00:13:52,580 --> 00:13:54,200
process and try to reset somebody's

227
00:13:54,200 --> 00:13:54,860
password

228
00:13:54,860 --> 00:13:56,420
so those grep rules are really awesome

229
00:13:56,420 --> 00:13:57,800
for a lot of different things and I

230
00:13:57,800 --> 00:14:00,080
encourage you to find interesting or to

231
00:14:00,080 --> 00:14:02,060
use them if you're trying to get data

232
00:14:02,060 --> 00:14:04,160
out of your fuzzing requests they're

233
00:14:04,160 --> 00:14:05,690
perfect that's what they're intended for

234
00:14:05,690 --> 00:14:07,400
right and we'll come back and I'll show

235
00:14:07,400 --> 00:14:09,290
you in here in towards the end of the

236
00:14:09,290 --> 00:14:10,220
talk we'll talk about some of the

237
00:14:10,220 --> 00:14:12,140
limitations of this and how we solve

238
00:14:12,140 --> 00:14:13,790
that problem as well but

239
00:14:13,790 --> 00:14:16,490
grep rules are certainly certainly worth

240
00:14:16,490 --> 00:14:19,130
taking a look at all right so let's talk

241
00:14:19,130 --> 00:14:20,570
about some of the stuff that perhaps

242
00:14:20,570 --> 00:14:23,630
isn't totally obvious within Bert oh the

243
00:14:23,630 --> 00:14:26,230
first one being

244
00:14:35,480 --> 00:14:39,419
[Music]

245
00:14:49,070 --> 00:14:52,199
[Music]

246
00:15:45,880 --> 00:15:49,120
it's not

247
00:15:50,070 --> 00:15:53,269
[Music]

248
00:16:04,870 --> 00:16:08,039
[Music]

249
00:16:30,630 --> 00:16:33,720
[Music]

250
00:16:38,560 --> 00:16:41,030
save us the couple of minutes that it

251
00:16:41,030 --> 00:16:43,760
would take to do that so super simple

252
00:16:43,760 --> 00:16:45,740
we're going to conduct a quick attack

253
00:16:45,740 --> 00:16:47,450
against the profile page so I'm gonna

254
00:16:47,450 --> 00:16:49,490
log in as me

255
00:16:49,490 --> 00:16:52,790
Tim's even a user he is okay good or the

256
00:16:52,790 --> 00:16:55,250
profile page and I had the ability to

257
00:16:55,250 --> 00:16:57,320
change my profile this is one of those

258
00:16:57,320 --> 00:16:58,310
things where if I can conduct a

259
00:16:58,310 --> 00:16:59,510
cross-site request board free attack

260
00:16:59,510 --> 00:17:02,570
against this that's pretty awesome so

261
00:17:02,570 --> 00:17:05,959
let's click Submit account information

262
00:17:05,959 --> 00:17:07,880
successfully changed great basically

263
00:17:07,880 --> 00:17:09,560
what I was just doing was this priming

264
00:17:09,560 --> 00:17:11,630
burp I want to get this request inside

265
00:17:11,630 --> 00:17:15,470
verb so that we can test for this method

266
00:17:15,470 --> 00:17:17,300
interchange so what kind of request is

267
00:17:17,300 --> 00:17:22,430
this here suppose right post request and

268
00:17:22,430 --> 00:17:23,510
obviously it'd be a little bit more

269
00:17:23,510 --> 00:17:36,410
difficult manually change it like we

270
00:17:36,410 --> 00:17:37,820
talked about or if you right click

271
00:17:37,820 --> 00:17:40,250
there's an option here change request

272
00:17:40,250 --> 00:17:42,950
method it's that simple click it and it

273
00:17:42,950 --> 00:17:45,110
does all the work for you so the way

274
00:17:45,110 --> 00:17:47,570
that you would do that is you would run

275
00:17:47,570 --> 00:17:49,190
you at first in fact I'm going to need

276
00:17:49,190 --> 00:17:51,820
I'm gonna change the request method back

277
00:17:51,820 --> 00:17:55,280
you just hit go as a post and analyze

278
00:17:55,280 --> 00:17:56,720
the response and you can see here it

279
00:17:56,720 --> 00:18:01,100
redirects back to profile 302 found you

280
00:18:01,100 --> 00:18:02,450
could follow the redirect if you wanted

281
00:18:02,450 --> 00:18:03,890
to it's just sending you right back and

282
00:18:03,890 --> 00:18:05,720
there's no error in this HTML anywhere

283
00:18:05,720 --> 00:18:08,360
then you would switch it over actually

284
00:18:08,360 --> 00:18:09,080
I'm using again

285
00:18:09,080 --> 00:18:15,590
oh that's because it was the redirect my

286
00:18:15,590 --> 00:18:17,960
bad alright so the initial post we check

287
00:18:17,960 --> 00:18:20,809
the response can we go back we changed

288
00:18:20,809 --> 00:18:22,129
the request method we do the same

289
00:18:22,129 --> 00:18:24,559
process again and if it's exactly the

290
00:18:24,559 --> 00:18:25,970
same then we know we've got the

291
00:18:25,970 --> 00:18:28,519
vulnerability right at the server still

292
00:18:28,519 --> 00:18:39,909
most important easy way to test for that

293
00:18:40,359 --> 00:18:42,919
all right so this next one it was a game

294
00:18:42,919 --> 00:18:45,390
changer for me this completely changed

295
00:18:45,390 --> 00:18:48,579
[Music]

296
00:19:01,010 --> 00:19:04,049
[Music]

297
00:19:11,550 --> 00:19:14,750
[Music]

298
00:19:36,380 --> 00:19:39,519
[Music]

299
00:19:45,610 --> 00:19:50,769
[Music]

300
00:19:58,270 --> 00:20:01,400
[Music]

301
00:20:08,760 --> 00:20:15,609
[Music]

302
00:20:38,450 --> 00:20:43,950
[Music]

303
00:20:55,190 --> 00:21:06,110
[Music]

304
00:21:06,110 --> 00:21:10,320
and there's a way to do that okay so

305
00:21:10,320 --> 00:21:12,120
what I want to do is I want to go back

306
00:21:12,120 --> 00:21:15,750
here and go back to repair to our our

307
00:21:15,750 --> 00:21:17,850
web service request that we made earlier

308
00:21:17,850 --> 00:21:18,240
because

309
00:21:18,240 --> 00:21:24,690
a really good let's go ahead and send

310
00:21:24,690 --> 00:21:27,360
this over to intruder so this is what

311
00:21:27,360 --> 00:21:29,520
you would do obviously this one right

312
00:21:29,520 --> 00:21:31,020
here is a place that we may want to foes

313
00:21:31,020 --> 00:21:33,120
that's the input parameter for this soap

314
00:21:33,120 --> 00:21:35,160
request is where that one is and we're

315
00:21:35,160 --> 00:21:36,929
going to want to fuzz that all right so

316
00:21:36,929 --> 00:21:38,370
we can right click on it and send it

317
00:21:38,370 --> 00:21:42,690
over to intruder okay and let's look at

318
00:21:42,690 --> 00:21:44,429
the positions so one of the things I

319
00:21:44,429 --> 00:22:29,790
want to point out here all these things

320
00:22:29,790 --> 00:22:31,830
pre highlighted and we just want to get

321
00:22:31,830 --> 00:22:32,850
rid of the ones that we're not

322
00:22:32,850 --> 00:22:35,490
interested in fuzzing right now so just

323
00:22:35,490 --> 00:22:37,260
clear them all out and we have the one

324
00:22:37,260 --> 00:22:39,690
left our injectable parameter now if you

325
00:22:39,690 --> 00:22:42,050
right-click anywhere within this request

326
00:22:42,050 --> 00:22:46,700
you see the option and all of its glory

327
00:22:57,950 --> 00:23:01,590
is very in a very very precise way only

328
00:23:01,590 --> 00:23:03,690
scans and things that we want to it

329
00:23:03,690 --> 00:23:05,490
reduces the amount of noise we make if

330
00:23:05,490 --> 00:23:07,920
we're trying to be stealth it reduces

331
00:23:07,920 --> 00:23:08,299
the

332
00:23:08,299 --> 00:23:15,619
dangers that we create it gives us a lot

333
00:23:15,619 --> 00:23:18,200
more control all right so let's actively

334
00:23:18,200 --> 00:23:21,859
scan this define insertion point we go

335
00:23:21,859 --> 00:23:24,229
up to the scanner we look at the queue

336
00:23:24,229 --> 00:23:25,429
and it's already finished because

337
00:23:25,429 --> 00:23:27,019
everything is local and super fast so we

338
00:23:27,019 --> 00:23:38,599
can see immediately we didn't have to

339
00:23:38,599 --> 00:23:40,369
wait for the wizard we didn't see I

340
00:23:40,369 --> 00:23:42,409
spent a lot of time manual testing and I

341
00:23:42,409 --> 00:23:44,209
will identify different parts throughout

342
00:23:44,209 --> 00:23:46,309
the application where I'm like I've been

343
00:23:46,309 --> 00:23:48,019
around long enough I know that parameter

344
00:23:48,019 --> 00:23:50,119
probably one herbal I'm gonna hit it

345
00:23:50,119 --> 00:23:52,190
with a scanner and I can use this tool

346
00:23:52,190 --> 00:23:54,320
to just hit that one without having to

347
00:23:54,320 --> 00:23:56,359
loop in the entire up at the entirety of

348
00:23:56,359 --> 00:23:58,519
the application so scanning defined

349
00:23:58,519 --> 00:24:02,229
injection points big time win okay

350
00:24:02,229 --> 00:24:04,070
alright so now let's get into some

351
00:24:04,070 --> 00:24:07,570
unintended functionality

352
00:24:07,570 --> 00:24:10,659
[Music]

353
00:24:31,130 --> 00:24:34,380
[Music]

354
00:24:38,050 --> 00:24:41,139
[Music]

355
00:25:14,780 --> 00:25:17,950
[Music]

356
00:25:56,320 --> 00:25:59,389
[Music]

357
00:26:11,880 --> 00:26:14,799
so going over here in the burp row

358
00:26:14,799 --> 00:26:16,510
actually let's go to the browser first I

359
00:26:16,510 --> 00:26:19,419
don't have TLS encryption on PO hub so

360
00:26:19,419 --> 00:26:24,760
I'm going to use my website so let's get

361
00:26:24,760 --> 00:26:27,549
rid of a GPS and just to Landmaster 53

362
00:26:27,549 --> 00:26:28,450
because remember we're taking advantage

363
00:26:28,450 --> 00:26:30,370
of default behavior and I should have

364
00:26:30,370 --> 00:26:31,980
Internet

365
00:26:31,980 --> 00:26:36,669
okay so going here into burp

366
00:26:36,669 --> 00:26:40,960
let's look at our history and what we

367
00:26:40,960 --> 00:26:43,840
should see is exactly what we do see

368
00:26:43,840 --> 00:26:46,990
which is Landmaster 53 comm says hey I

369
00:26:46,990 --> 00:26:49,330
only do under w w so it remakes the

370
00:26:49,330 --> 00:26:52,090
connection redirects over to 2w w and

371
00:26:52,090 --> 00:26:54,510
then what

372
00:26:59,400 --> 00:27:04,480
the HTTP so that's that opportunity to

373
00:27:04,480 --> 00:27:05,950
get in the middle how do we test for

374
00:27:05,950 --> 00:27:06,430
that

375
00:27:06,430 --> 00:27:09,100
well we can go over to our proxy

376
00:27:09,100 --> 00:27:12,400
settings options if you go into your

377
00:27:12,400 --> 00:27:15,280
proxy and you click Edit there's this

378
00:27:15,280 --> 00:27:26,530
ability to force the use of SSL all

379
00:27:26,530 --> 00:27:28,090
right so that's the first step in this

380
00:27:28,090 --> 00:27:31,240
once we do that we've got Bert behaving

381
00:27:31,240 --> 00:27:33,250
the way we wanted to but we're gonna get

382
00:27:33,250 --> 00:27:34,870
all these responses with references to

383
00:27:34,870 --> 00:27:37,660
HTTPS with secure cookies search secure

384
00:27:37,660 --> 00:27:39,400
flags on cookies and so on and so forth

385
00:27:39,400 --> 00:27:42,490
so if we scroll down we have this

386
00:27:42,490 --> 00:27:46,390
ability to convert HTTP to HTTP and

387
00:27:46,390 --> 00:27:51,400
remove secure flag from cookies now if

388
00:27:51,400 --> 00:27:54,030
we go back and we do this same exercise

389
00:27:54,030 --> 00:27:56,140
let me clear the history to get out any

390
00:27:56,140 --> 00:28:05,620
301 redirects we hit enter did I get a

391
00:28:05,620 --> 00:28:13,690
pop-up at all that said at this point no

392
00:28:13,690 --> 00:28:15,970
so the only visual cue is this the

393
00:28:15,970 --> 00:28:24,910
connection is not secure this traffic

394
00:28:24,910 --> 00:28:26,710
even though it was supposed to be over

395
00:28:26,710 --> 00:28:30,430
TLS okay and if we go back to h2 our

396
00:28:30,430 --> 00:28:34,050
history we can see what happened here

397
00:28:35,310 --> 00:28:37,180
actually I don't see the clear text

398
00:28:37,180 --> 00:28:38,820
maybe that's it right there

399
00:28:38,820 --> 00:28:40,810
well regardless you see it in the

400
00:28:40,810 --> 00:28:42,910
browser right it's unencrypted so there

401
00:28:42,910 --> 00:28:46,540
was a protocol designed to to protect

402
00:28:46,540 --> 00:28:49,020
against

403
00:29:18,240 --> 00:29:20,919
control and the way that we do that is

404
00:29:20,919 --> 00:29:23,590
using this TLS stripping approach right

405
00:29:23,590 --> 00:29:27,130
here okay so another another fun way to

406
00:29:27,130 --> 00:29:29,649
use burp in an unattended fashion I'm

407
00:29:29,649 --> 00:29:31,389
gonna go in here I'm gonna reset this to

408
00:29:31,389 --> 00:29:37,720
that I don't goof up future demos let's

409
00:29:37,720 --> 00:29:41,519
turn that off and uncheck these boxes

410
00:29:43,049 --> 00:29:48,809
okay so the next unintended use

411
00:30:06,830 --> 00:30:10,020
[Music]

412
00:30:23,620 --> 00:30:34,579
[Music]

413
00:31:01,240 --> 00:31:04,349
[Music]

414
00:31:27,300 --> 00:31:29,560
right so let's run through this real

415
00:31:29,560 --> 00:31:30,910
quick I'll show you what it looks like

416
00:31:30,910 --> 00:31:34,000
and it ends up being something I now use

417
00:31:34,000 --> 00:31:35,800
on every single assessment this is a

418
00:31:35,800 --> 00:31:38,050
fantastic idea so the first thing we

419
00:31:38,050 --> 00:31:40,480
want to do is is hide I only want to

420
00:31:40,480 --> 00:31:45,970
show show only where's the thing I'm

421
00:31:45,970 --> 00:31:48,100
looking for only requested items that's

422
00:31:48,100 --> 00:31:50,070
the stuff that I've actually requested

423
00:31:50,070 --> 00:31:53,220
all right so within my within my

424
00:31:53,220 --> 00:31:55,870
particular target here if I look at

425
00:31:55,870 --> 00:31:57,640
contents you could see everything that

426
00:31:57,640 --> 00:31:59,110
I've requested at this point and I'll

427
00:31:59,110 --> 00:32:00,670
add a few more of those I'll go up here

428
00:32:00,670 --> 00:32:03,610
and we'll login we already are logged in

429
00:32:03,610 --> 00:32:05,620
we'll click on a few of these either

430
00:32:05,620 --> 00:32:09,550
login we'll click on a few of these

431
00:32:09,550 --> 00:32:15,460
things artifacts tools games so we got

432
00:32:15,460 --> 00:32:17,080
we've maxed some of the application

433
00:32:17,080 --> 00:32:19,660
right so we go back here and we look and

434
00:32:19,660 --> 00:32:20,950
we can see that okay we've got a decent

435
00:32:20,950 --> 00:32:23,230
amount here what I want to do is I want

436
00:32:23,230 --> 00:32:26,920
to highlight all of these I'll go in and

437
00:32:26,920 --> 00:32:27,610
I'll highlight it

438
00:32:27,610 --> 00:32:30,520
and then now if I go up to my spider tab

439
00:32:30,520 --> 00:32:34,080
I can see that there are 39

440
00:32:39,360 --> 00:32:41,770
so we'll just let the spider do its

441
00:32:41,770 --> 00:32:45,250
thing and then of course you look at the

442
00:32:45,250 --> 00:32:46,540
forms you've already logged in so we

443
00:32:46,540 --> 00:32:49,800
don't need to spider that one again a

444
00:32:49,800 --> 00:32:51,460
registration normally we would have

445
00:32:51,460 --> 00:32:52,780
mapped this already so I'm just gonna

446
00:32:52,780 --> 00:32:54,450
ignore it login again

447
00:32:54,450 --> 00:32:56,590
registration again and so on and so

448
00:32:56,590 --> 00:32:58,780
forth so I got through spider has ran if

449
00:32:58,780 --> 00:33:01,060
I go back to my target now anything

450
00:33:01,060 --> 00:33:04,610
that's not highlighted his new as new

451
00:33:04,610 --> 00:33:07,780
[Music]

452
00:33:11,930 --> 00:33:15,049
[Music]

453
00:33:22,580 --> 00:33:24,450
[Music]

454
00:33:24,450 --> 00:33:27,580
with these now on highlighted parts I'm

455
00:33:27,580 --> 00:33:30,190
so super simple but something that's

456
00:33:30,190 --> 00:33:31,900
missing that we can now go back and add

457
00:33:31,900 --> 00:33:33,190
because of some other unattended

458
00:33:33,190 --> 00:33:35,890
features here so really like that

459
00:33:35,890 --> 00:33:37,330
capability that's something that's been

460
00:33:37,330 --> 00:33:45,310
super helpful to me okay so Burke does a

461
00:33:45,310 --> 00:33:48,540
lot of things right and I guess

462
00:34:12,690 --> 00:34:24,909
[Music]

463
00:35:18,450 --> 00:35:21,710
[Music]

464
00:35:28,500 --> 00:35:31,679
[Music]

465
00:35:34,450 --> 00:35:37,509
[Music]

466
00:36:04,890 --> 00:36:08,830
and it starts right here okay so this is

467
00:36:08,830 --> 00:36:09,100
ideal

468
00:36:09,100 --> 00:36:36,900
I do have interest so this is very very

469
00:36:39,750 --> 00:36:42,580
starting point so I wrote this script to

470
00:36:42,580 --> 00:36:44,140
kind of just give you that information

471
00:36:44,140 --> 00:36:45,850
so you can get a head start and this is

472
00:36:45,850 --> 00:36:47,680
where I'm going to develop a lot of the

473
00:36:47,680 --> 00:36:49,360
documentation for this for this

474
00:36:49,360 --> 00:36:51,940
extension out but really simple is just

475
00:36:51,940 --> 00:36:54,880
copying the code right and then you take

476
00:36:54,880 --> 00:36:56,350
it over and if you didn't notice it

477
00:36:56,350 --> 00:36:58,660
before you'll notice it now the script

478
00:36:58,660 --> 00:37:01,060
tab and I already the script in there so

479
00:37:01,060 --> 00:37:02,440
let me delete that so you have the

480
00:37:02,440 --> 00:37:06,910
script tag so I'm gonna paste my script

481
00:37:06,910 --> 00:37:08,680
in there and it does a couple of

482
00:37:08,680 --> 00:37:11,320
different things this one's pretty basic

483
00:37:11,320 --> 00:37:13,660
it just looks for a request

484
00:37:13,660 --> 00:37:15,820
it just says hey if I see a requests

485
00:37:15,820 --> 00:37:18,040
coming through the proxy then I'm going

486
00:37:18,040 --> 00:37:25,390
to do these things some information

487
00:37:25,390 --> 00:37:28,120
about what's exposed in the context of

488
00:37:28,120 --> 00:37:30,280
the script of the script er so I'm just

489
00:37:30,280 --> 00:37:31,930
going to go in repeater and I'm just

490
00:37:31,930 --> 00:37:35,560
gonna launch this thing and then under

491
00:37:35,560 --> 00:37:41,830
extender tab Python script or output you

492
00:37:41,830 --> 00:37:43,630
see this is kind of the standard out for

493
00:37:43,630 --> 00:37:46,630
our script you see all the information

494
00:37:46,630 --> 00:37:48,160
in there those of you that don't do

495
00:37:48,160 --> 00:37:49,630
Python this probably looks like a

496
00:37:49,630 --> 00:37:53,430
foreign language to you but those

497
00:38:07,930 --> 00:38:10,490
you can extend it you can play with it a

498
00:38:10,490 --> 00:38:12,950
little bit more and all your right back

499
00:38:12,950 --> 00:38:15,109
here inside of the extender tab and this

500
00:38:15,109 --> 00:38:18,770
in this UI output this UI output text

501
00:38:18,770 --> 00:38:19,670
block okay

502
00:38:19,670 --> 00:38:21,170
so that's kind of nice right now you

503
00:38:21,170 --> 00:38:22,490
have some place where you can actually

504
00:38:22,490 --> 00:38:24,800
begin to dig in to this what Python

505
00:38:24,800 --> 00:38:26,390
script er does and utilize some of its

506
00:38:26,390 --> 00:38:29,180
functionality but let's look at how we

507
00:38:29,180 --> 00:38:30,650
can actually a practically apply this

508
00:38:30,650 --> 00:38:32,030
stuff all right

509
00:38:32,030 --> 00:38:36,220
so custom passive scanning checks

510
00:38:55,340 --> 00:38:58,439
[Music]

511
00:39:27,800 --> 00:39:30,879
[Music]

512
00:39:37,730 --> 00:39:41,510
[Music]

513
00:39:44,370 --> 00:39:46,600
so let's actually take this one and see

514
00:39:46,600 --> 00:39:54,610
what that looks like copy it over write

515
00:39:54,610 --> 00:39:58,420
this in here and then we'll go in the

516
00:39:58,420 --> 00:40:02,140
application and actually those let's

517
00:40:02,140 --> 00:40:03,910
look at our vulnerabilities first I will

518
00:40:03,910 --> 00:40:05,530
go to target we'll look at issues and

519
00:40:05,530 --> 00:40:07,510
you can see this one past password

520
00:40:07,510 --> 00:40:09,340
filled with autocomplete enabled but you

521
00:40:09,340 --> 00:40:10,840
don't see anything else there do you

522
00:40:10,840 --> 00:40:11,590
don't see anything else about

523
00:40:11,590 --> 00:40:14,620
autocomplete but go here to the

524
00:40:14,620 --> 00:40:16,390
application and I go over here to

525
00:40:16,390 --> 00:40:18,400
messages this is obviously a forum

526
00:40:18,400 --> 00:40:23,800
correct what do I have there text field

527
00:40:23,800 --> 00:40:26,470
will autocomplete enabled right and if I

528
00:40:26,470 --> 00:40:30,130
go down I can look it's I've created the

529
00:40:30,130 --> 00:40:32,350
the issue to tell me to show me the

530
00:40:32,350 --> 00:40:59,170
exact on that kind of sensitive

531
00:40:59,170 --> 00:41:01,510
information right so that's just an

532
00:41:01,510 --> 00:41:03,190
example of how I use I keep that in

533
00:41:03,190 --> 00:41:04,660
there all the time and then you can

534
00:41:04,660 --> 00:41:06,610
extend this right you see I have a line

535
00:41:06,610 --> 00:41:08,440
break right here check for all the

536
00:41:08,440 --> 00:41:10,600
complete on form fields just add another

537
00:41:10,600 --> 00:41:12,770
regex

538
00:41:12,770 --> 00:41:15,829
[Music]

539
00:41:19,950 --> 00:41:22,000
but Burke would do all that for you and

540
00:41:22,000 --> 00:41:23,500
treat your issues for you so if you have

541
00:41:23,500 --> 00:41:24,790
some passive things you want to look for

542
00:41:24,790 --> 00:41:26,350
that burp isn't looking for by itself

543
00:41:26,350 --> 00:41:30,010
BAM there's a capability okay another

544
00:41:30,010 --> 00:41:32,800
way I use this is regex extraction now

545
00:41:32,800 --> 00:41:36,040
remember I was talking about the

546
00:41:36,040 --> 00:41:43,090
[Music]

547
00:42:07,309 --> 00:42:10,079
and I'll miss out on the rest of it and

548
00:42:10,079 --> 00:42:11,819
I'll show you an example of where I've

549
00:42:11,819 --> 00:42:13,380
actually ran into this where I needed

550
00:42:13,380 --> 00:42:16,230
this particular capability so let's go

551
00:42:16,230 --> 00:42:17,940
over here to in fact messages is the

552
00:42:17,940 --> 00:42:20,400
right place so say I wanted to harvest

553
00:42:20,400 --> 00:42:56,040
username Python script or we can say hey

554
00:42:56,040 --> 00:42:57,839
every time you see a request or a

555
00:42:57,839 --> 00:43:02,000
response that's coming back to a truth

556
00:43:03,109 --> 00:43:06,359
okay so let's do that real quick I'm

557
00:43:06,359 --> 00:43:08,549
going to use this particular and I think

558
00:43:08,549 --> 00:43:09,839
I've already got yeah I've already got

559
00:43:09,839 --> 00:43:12,839
this in verb so let's go to the proxy

560
00:43:12,839 --> 00:43:14,160
that's fine where that's at

561
00:43:14,160 --> 00:43:17,640
right here right click it send it over

562
00:43:17,640 --> 00:43:22,440
to intruder and so what we want to do

563
00:43:22,440 --> 00:43:24,299
here with intruder is we just want to

564
00:43:24,299 --> 00:43:27,569
cycle through all the pages right what

565
00:43:27,569 --> 00:43:28,770
we're trying to do should cycle through

566
00:43:28,770 --> 00:43:30,660
the pages here there's only two pages 0

567
00:43:30,660 --> 00:43:32,579
and 1 but there may be 35 pages then you

568
00:43:32,579 --> 00:43:34,740
never know but here we're trying to

569
00:43:34,740 --> 00:43:36,119
cycle through the pages so we'll do that

570
00:43:36,119 --> 00:43:39,180
we'll go over to payloads and since I

571
00:43:39,180 --> 00:43:40,589
already know there's only two pages will

572
00:43:40,589 --> 00:43:46,200
do a 0 a 1 and make sure I got all the

573
00:43:46,200 --> 00:43:49,279
configuration stuff here

574
00:43:49,570 --> 00:43:52,400
okay yeah so now I can go ahead and I

575
00:43:52,400 --> 00:43:57,620
can run that and I can go in here and of

576
00:43:57,620 --> 00:43:59,630
course I've got all the messages there

577
00:43:59,630 --> 00:44:01,340
now I'm going to not want to go do that

578
00:44:01,340 --> 00:44:04,100
my previous grep rule approach and kind

579
00:44:04,100 --> 00:44:05,510
of show you what that would look like so

580
00:44:05,510 --> 00:44:07,610
I'm going to my options I can do grep

581
00:44:07,610 --> 00:44:12,500
extract add and let's go down and create

582
00:44:12,500 --> 00:44:16,970
a regex for the username which would be

583
00:44:16,970 --> 00:44:21,530
inside parentheses right there these

584
00:44:21,530 --> 00:44:22,510
regex

585
00:44:22,510 --> 00:44:27,020
hit OK and my results show me one

586
00:44:27,020 --> 00:44:30,230
username but I want all five okay I want

587
00:44:30,230 --> 00:44:31,820
all five of them every time every time I

588
00:44:31,820 --> 00:44:33,440
cycle through a page and that's where

589
00:44:33,440 --> 00:44:34,940
the script comes in so what it says is

590
00:44:34,940 --> 00:44:37,190
is okay if it's a request and if it's

591
00:44:37,190 --> 00:44:39,440
coming back from it or yeah if it's not

592
00:44:39,440 --> 00:44:41,390
is request so if it's a response and

593
00:44:41,390 --> 00:44:43,640
it's coming back to the intruder tool

594
00:44:43,640 --> 00:44:46,430
then I want to run this regex and I want

595
00:44:46,430 --> 00:44:48,500
to print out the matches so let's go and

596
00:44:48,500 --> 00:44:50,120
let's grab we can actually grab our

597
00:44:50,120 --> 00:44:52,310
regex straight from our rule that we

598
00:44:52,310 --> 00:44:55,730
just created which is kind of handy I'm

599
00:44:55,730 --> 00:44:57,380
just gonna copy and paste this whole

600
00:44:57,380 --> 00:45:00,920
thing actually I probably should've did

601
00:45:00,920 --> 00:45:04,600
this bar first so let's get this first

602
00:45:04,600 --> 00:45:10,820
take our script put it in our scripture

603
00:45:10,820 --> 00:45:14,270
tab then that's good now let's go for

604
00:45:14,270 --> 00:45:19,070
fetch er regex and replace this right

605
00:45:19,070 --> 00:45:20,570
here because that's the regex we're

606
00:45:20,570 --> 00:45:24,320
looking for now our script setup let's

607
00:45:24,320 --> 00:45:29,420
go run the attack again find where I'm

608
00:45:29,420 --> 00:45:33,770
at attack

609
00:45:33,770 --> 00:45:37,850
repeat the attack repeated once again

610
00:45:37,850 --> 00:45:39,920
you see only see one there right but I

611
00:45:39,920 --> 00:45:43,460
outputted the information to here and

612
00:45:43,460 --> 00:45:46,180
what do I see

613
00:46:12,100 --> 00:46:14,220
kind of go through and pull it all back

614
00:46:14,220 --> 00:46:16,930
how am i doing on time getting there

615
00:46:16,930 --> 00:46:19,870
okay so last thing I wanted to cover I

616
00:46:19,870 --> 00:46:22,270
think it's the last one yep bypassing

617
00:46:22,270 --> 00:47:06,100
client-side animation okay

618
00:47:06,100 --> 00:47:08,710
so let's go in here and actually try to

619
00:47:08,710 --> 00:47:11,190
break into this particular application

620
00:47:11,190 --> 00:47:16,450
let's log out log in and if I do a

621
00:47:16,450 --> 00:47:18,190
username we know exists but I'd say I

622
00:47:18,190 --> 00:47:20,200
don't know the password and I hit enter

623
00:47:20,200 --> 00:47:22,060
it says invalid username and password I

624
00:47:22,060 --> 00:47:23,670
could try something else

625
00:47:23,670 --> 00:47:27,670
Tim try again Val username and password

626
00:47:27,670 --> 00:47:28,810
I could do that a whole bunch of times

627
00:47:28,810 --> 00:47:30,430
manually and it would work in the

628
00:47:30,430 --> 00:47:32,080
browser but doing that it's slow right

629
00:47:32,080 --> 00:47:33,460
we want to automate that particular

630
00:47:33,460 --> 00:47:36,850
attack so it's going to burp I'm going

631
00:47:36,850 --> 00:47:37,810
to close out these windows because

632
00:47:37,810 --> 00:47:42,130
they're annoying so we're going to burp

633
00:47:42,130 --> 00:47:45,810
our history will find that request

634
00:47:45,810 --> 00:47:48,940
there's our login request right there we

635
00:47:48,940 --> 00:47:50,920
can right-click or zoom in on a little

636
00:47:50,920 --> 00:47:52,930
bit and you can see the issue here right

637
00:47:52,930 --> 00:47:56,190
you see user name

638
00:47:58,989 --> 00:48:01,460
probably somehow involved in this anti

639
00:48:01,460 --> 00:48:04,249
automation scheme okay I could look at

640
00:48:04,249 --> 00:48:06,619
the the response to the login page

641
00:48:06,619 --> 00:48:08,180
scroll down to the bottom look at the

642
00:48:08,180 --> 00:48:09,910
JavaScript and determined very quickly

643
00:48:09,910 --> 00:48:14,269
what that logic is it's taken the nots

644
00:48:14,269 --> 00:48:23,479
and it's taken the provided password but

645
00:48:23,479 --> 00:48:24,969
if you're just doing but if you just

646
00:48:24,969 --> 00:48:27,769
make this request it's going to be

647
00:48:27,769 --> 00:48:30,079
detected as a balk so I'm gonna go and

648
00:48:30,079 --> 00:48:31,969
I'll show you this will right click it

649
00:48:31,969 --> 00:48:38,329
the request send to intruder the

650
00:48:38,329 --> 00:48:39,650
position we're interested in is the

651
00:48:39,650 --> 00:48:43,359
password let's actually clear them all

652
00:48:52,240 --> 00:48:54,560
passwords the right password by the way

653
00:48:54,560 --> 00:48:56,600
so we start the attack and we notice

654
00:48:56,600 --> 00:48:58,240
real quickly that even the right path

655
00:48:58,240 --> 00:49:00,980
none of them authenticated correctly

656
00:49:00,980 --> 00:49:02,750
all of them are exists the responses are

657
00:49:02,750 --> 00:49:04,850
exactly the same and the reason being is

658
00:49:04,850 --> 00:49:09,950
because we have bot detected right it

659
00:49:09,950 --> 00:49:12,410
didn't do the proper calculations and so

660
00:49:12,410 --> 00:49:14,360
this is a perfect opportunity for us to

661
00:49:14,360 --> 00:49:29,630
use this Python script earthing again so

662
00:49:29,630 --> 00:49:36,710
let's take our script copy it put it

663
00:49:36,710 --> 00:49:40,370
here in the scripture tab and then

664
00:49:40,370 --> 00:49:42,950
replicate this behavior again but this

665
00:49:42,950 --> 00:49:52,910
time we're going to intercept it so we

666
00:49:52,910 --> 00:49:55,550
do Tim I'm gonna make it a bad password

667
00:49:55,550 --> 00:49:58,100
and login so we have this here which

668
00:49:58,100 --> 00:49:59,900
gives me the proper nonce for this

669
00:49:59,900 --> 00:50:02,180
particular request on a right click it

670
00:50:02,180 --> 00:50:06,920
send it to intruder positions once again

671
00:50:06,920 --> 00:50:08,960
we're only interested in the password

672
00:50:08,960 --> 00:50:10,130
here because it returned the cracks of

673
00:50:10,130 --> 00:50:16,640
nice password payloads with the correct

674
00:50:16,640 --> 00:50:19,250
password another fake another fake and

675
00:50:19,250 --> 00:50:22,820
start the attack and here we can

676
00:50:22,820 --> 00:50:25,130
obviously see that when it landed on

677
00:50:25,130 --> 00:50:30,550
password it properly authenticated

678
00:50:40,019 --> 00:50:42,609
simple Python logic in the Python script

679
00:50:42,609 --> 00:50:45,039
these are these last four examples are

680
00:50:45,039 --> 00:50:46,029
common things that I come across

681
00:50:46,029 --> 00:50:58,269
actually quite a bit where TLS and

682
00:50:58,269 --> 00:50:59,890
threading and all this other stuff

683
00:50:59,890 --> 00:51:01,690
that's already built into Burke for you

684
00:51:01,690 --> 00:51:04,119
take advantage of Burke's capability use

685
00:51:04,119 --> 00:51:05,619
the Python script or stuff and make it

686
00:51:05,619 --> 00:51:07,690
easy on yourself 10 20 lines of code and

687
00:51:07,690 --> 00:51:08,979
you'll probably have what you need to

688
00:51:08,979 --> 00:51:12,489
have okay alright so that pretty much

689
00:51:12,489 --> 00:52:01,390
covers when I want to talk about I'm

690
00:52:01,390 --> 00:52:03,219
going to try to demystify that and

691
00:52:03,219 --> 00:52:05,199
create some documentation so that you

692
00:52:05,199 --> 00:52:06,219
don't have to dig through the source

693
00:52:06,219 --> 00:52:07,900
code yourself you can just come to my

694
00:52:07,900 --> 00:52:09,999
website over there and kind of see how

695
00:52:09,999 --> 00:52:12,430
to how to how to actually write those ok

696
00:52:12,430 --> 00:52:15,039
so that pretty much wraps things up if

697
00:52:15,039 --> 00:52:17,430
you

698
00:52:18,300 --> 00:52:21,469
[Music]

699
00:52:44,980 --> 00:52:48,050
[Music]

700
00:53:00,150 --> 00:53:03,249
[Music]

701
00:53:07,720 --> 00:53:10,400
we got time for questions and think

702
00:53:10,400 --> 00:53:13,240
we've got stuff to give away

703
00:53:18,310 --> 00:53:21,420
[Music]

704
00:53:28,590 --> 00:53:31,820
[Music]

705
00:53:46,710 --> 00:53:49,820
[Music]

706
00:54:54,530 --> 00:55:02,260
[Music]

707
00:55:20,070 --> 00:55:23,499
[Music]

708
00:55:31,180 --> 00:55:38,948
[Music]

