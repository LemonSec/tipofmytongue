1
00:00:00,000 --> 00:00:08,220
basically warm up the crowd one of them
is a wave and the others a chance so I

2
00:00:08,220 --> 00:00:13,410
just kind of get us in the the mood to
talk about exploit kits I'd like to try

3
00:00:13,410 --> 00:00:30,449
wave going to start over here i'm going
to run over here to pick my talents

4
00:00:30,449 --> 00:00:37,559
might work well

5
00:00:38,790 --> 00:00:45,120
ah the other is a chance and uh since
i'm talking about exploit kits i would

6
00:00:45,120 --> 00:01:09,509
like to do a chance saying exploit kits
exploit kits hit-boy picking cross that

7
00:01:09,510 --> 00:01:11,010
off my bucket list now

8
00:01:11,010 --> 00:01:19,979
well for this presentation or going I'm
going to do an introduction talk about

9
00:01:19,979 --> 00:01:27,030
exploit kit the concept talk about an
exploitative ecosystem discuss some

10
00:01:27,030 --> 00:01:34,439
common exploit kits talk about examining
exploit kit traffic and finally we'll

11
00:01:34,439 --> 00:01:43,020
discuss what should be our best defense
i currently work at palo alto networks

12
00:01:43,020 --> 00:01:49,470
reporting to which is double face of
research company also run the malware

13
00:01:49,470 --> 00:01:52,760
traffic analysis that net web site

14
00:01:52,760 --> 00:02:01,190
I speak around right diaries for the
internet storm sir and I tweet fairly

15
00:02:01,190 --> 00:02:08,000
frequently at my work underscore traffic
so first things first in order to

16
00:02:08,000 --> 00:02:12,350
understand the exploit kit concept you
have to understand that there are two

17
00:02:12,350 --> 00:02:18,230
main methods that criminals use for mass
distribution of malware the first method

18
00:02:18,230 --> 00:02:25,519
requires user action which is a vicious
man where pop-up windows during here's

19
00:02:25,520 --> 00:02:32,780
an example of malicious pan zip file
attachment you open it up and test and

20
00:02:32,780 --> 00:02:41,180
exploits or uh excel spreadsheet at all
the other one is the pop-up windows that

21
00:02:41,180 --> 00:02:47,450
you see during web browsing in either
case you have plenty of warning that

22
00:02:47,450 --> 00:02:52,429
you're going to do something wrong you
warned that this type can harm your

23
00:02:52,430 --> 00:02:58,790
computer do you really want to run that
file in the average user will their

24
00:02:58,790 --> 00:03:04,429
clicker so i will click right through
them self but still I figure anyone of

25
00:03:04,430 --> 00:03:10,580
us here in this room is smart enough to
know to understand what's going on there

26
00:03:10,580 --> 00:03:15,080
the second method happens behind the
scenes without the users knowledge and

27
00:03:15,080 --> 00:03:22,670
this is the method used by exploit kits
you take a criminal groups malware send

28
00:03:22,670 --> 00:03:28,820
it to the average users computer
behind-the-scenes scary right

29
00:03:28,820 --> 00:03:35,209
halloween is coming up next . kids
distributed Network targeting systems

30
00:03:35,209 --> 00:03:42,350
running microsoft windows to understand
the exploit kit concept we need to

31
00:03:42,350 --> 00:03:49,430
clearly define what a vulnerability and
exploit is we can find what exploited a

32
00:03:49,430 --> 00:03:54,170
vulnerability is annotated flaw in
software code that leaves it open to

33
00:03:54,170 --> 00:03:58,820
exploitation in the form of unauthorized
access or malicious babe

34
00:03:59,569 --> 00:04:07,069
is a catalog and common vulnerabilities
database CBE numbers

35
00:04:07,069 --> 00:04:12,649
here's one for adobe flash player if you
look at the definition of it or the

36
00:04:12,650 --> 00:04:18,560
description i should say adobe flash
player 21-point 0.026 an earlier allows

37
00:04:18,560 --> 00:04:23,539
remote attackers to execute arbitrary
code via unspecified vectors as

38
00:04:23,539 --> 00:04:32,240
exploited in the wild in may 2016 should
be as of may 2016 and i love this is a

39
00:04:32,240 --> 00:04:39,320
politician speak right arbitrary code
via unspecified vectors the there's

40
00:04:39,320 --> 00:04:43,520
nothing arbitrary about this code is
mouth right

41
00:04:43,520 --> 00:04:49,370
why would do what we do try to execute
arbitrary that's why do you say that an

42
00:04:49,370 --> 00:04:59,720
unspecified vectors this is exploit kits
a but view everything for these cds were

43
00:04:59,720 --> 00:05:04,190
these vulnerabilities will always see
described in that way arbitrary code via

44
00:05:04,190 --> 00:05:08,930
and specified vectors just call it what
it is now we're in this case for this

45
00:05:08,930 --> 00:05:17,180
exploit for this vulnerability via
exploit kits and exploit is a file or a

46
00:05:17,180 --> 00:05:22,550
piece of code that takes advantage of
vulnerability in an application file or

47
00:05:22,550 --> 00:05:28,970
a piece of code so i can go into a
packet capture of traffic that I've

48
00:05:28,970 --> 00:05:35,090
collected open it up in wireshark scroll
through trying to export HTTP objects

49
00:05:35,090 --> 00:05:41,388
fine a flash file export that because in
this case I know it's a flash exploit

50
00:05:41,389 --> 00:05:48,530
and there it is by itself and exploit
although it's malicious it will not

51
00:05:48,530 --> 00:05:54,530
infect your computer so for example if
you have a word document exploit that

52
00:05:54,530 --> 00:05:57,919
exploit by itself it's sitting on your
computer it

53
00:05:58,600 --> 00:06:02,830
where did that that coder that file is
not going to do anything unless it

54
00:06:02,830 --> 00:06:07,479
happens to be a word document and then
word we'll open it up and execute that

55
00:06:07,480 --> 00:06:15,460
exploit in a particular fashion so this
flash exploit that I've exported from

56
00:06:15,460 --> 00:06:19,450
wireshark from this traffic i double
click it on my desktop that's not going

57
00:06:19,450 --> 00:06:27,219
to do anything that needs to work under
a specific set of circumstances and

58
00:06:27,220 --> 00:06:32,140
exploit kits our way to do that and
exploit it is probably the best

59
00:06:32,140 --> 00:06:38,409
definition that I've seen of exploit
kits a server-based framework that uses

60
00:06:38,410 --> 00:06:42,310
exploits to take advantage of
vulnerabilities in browser based

61
00:06:42,310 --> 00:06:48,700
applications to affect the client laptop
or desktop without the users knowledge

62
00:06:48,700 --> 00:06:59,289
without any additional action by the
user except from casual web browsing so

63
00:06:59,290 --> 00:07:02,740
you might ask yourself under
vulnerabilities that exploit kits target

64
00:07:03,540 --> 00:07:10,980
anybody have any guesses flash that is
big one right now

65
00:07:11,640 --> 00:07:17,969
clashes really really big another one is
browsers internet explorer is probably

66
00:07:17,970 --> 00:07:23,940
the biggest one that's correct java
silver lights probably the third most

67
00:07:23,940 --> 00:07:32,160
popular one common i should say java in
PDF exploits those were very very common

68
00:07:32,160 --> 00:07:37,350
and exploit kits up until about a year
year and a half ago any of the current

69
00:07:37,350 --> 00:07:40,320
leading modern exploit kits that are out
there

70
00:07:40,320 --> 00:07:45,450
I've not seen java or PDF being
exploited i have seen flash almost

71
00:07:45,450 --> 00:07:50,370
across the board now browser-based
exploits pretty much internet explorer

72
00:07:50,370 --> 00:08:02,220
and to a much lesser extent microsoft
silverlight exploit kids have turned to

73
00:08:02,220 --> 00:08:07,650
a software-as-a-service model SAS
platform-as-a-service model pass

74
00:08:07,650 --> 00:08:15,570
everyone sit i call it exploit kits as a
service which that term is caught on but

75
00:08:15,570 --> 00:08:22,140
the accurate how i pronounce it eks I've
got the side for that before and i'm

76
00:08:22,140 --> 00:08:28,950
told i shouldn't say that in front of a
large crowd yelling being recorded but

77
00:08:28,950 --> 00:08:34,530
hopefully you'll see that acronym a
little bit more we should be talking

78
00:08:34,530 --> 00:08:41,370
about exploits in that war in my
personal opinion so we're renting an

79
00:08:41,370 --> 00:08:43,440
exploit kit we're not buying it

80
00:08:43,440 --> 00:08:50,250
much like yeah were software you love
for microsoft windows where we're we're

81
00:08:50,250 --> 00:08:54,840
buying the rights to run it in this case
you're just printing the surface you

82
00:08:54,840 --> 00:09:01,590
don't really get any code like you would
if you're buying microsoft windows so

83
00:09:01,590 --> 00:09:08,340
how much does it cost on April 2016 the
checkpoint blog published a study on

84
00:09:08,340 --> 00:09:14,430
nuclear export kid and in it they said
that eating exploit kits are sold in

85
00:09:14,430 --> 00:09:15,790
cyber criminal circles

86
00:09:15,790 --> 00:09:28,000
four thousand dollars month that is just
Benjamin's a date in june 2016 now we're

87
00:09:28,000 --> 00:09:32,200
don't need coffee com the security
researcher caffeine that runs outside he

88
00:09:32,200 --> 00:09:36,940
reported that neutrino exploit kit costs
seven thousand dollars a month that was

89
00:09:36,940 --> 00:09:41,800
shortly after angler exploit kit
disappeared from the exploit kit see

90
00:09:41,800 --> 00:09:44,920
which was about that price

91
00:09:44,920 --> 00:09:54,760
prior to that neutrino was costing
around 3,500 dollars a month so the

92
00:09:54,760 --> 00:10:00,550
exploit kits themselves once you are
actually able to cough up the dough and

93
00:10:00,550 --> 00:10:01,569
pay for it

94
00:10:01,570 --> 00:10:07,150
you have yourself a server and that
server in order to understand how it

95
00:10:07,150 --> 00:10:13,660
works basically when your computer
connects while web browsing to that

96
00:10:13,660 --> 00:10:19,150
server it will first to the landing page
the landing page generally for exploit

97
00:10:19,150 --> 00:10:26,410
kits tends to profile the machine to see
what's boulder war once it determines

98
00:10:26,410 --> 00:10:31,719
what is vulnerable on your machine it
will send an appropriate exploit and if

99
00:10:31,720 --> 00:10:36,730
that makes quick kit or I'm sorry if
that exploit is successful as leverage

100
00:10:36,730 --> 00:10:41,470
by the exploit kit it was in the payload
which is your malware that will infect

101
00:10:41,470 --> 00:10:47,140
your computer once again all this is
behind the seats but this is your block

102
00:10:47,140 --> 00:10:58,270
diagram of the chain of events within
the exploit king but exploit kids cannot

103
00:10:58,270 --> 00:11:02,800
exist by themselves i cannot pay seven
thousand dollars a month were neutrino

104
00:11:02,800 --> 00:11:07,540
exploit kit server have it out there and
expect people to come flocking to it to

105
00:11:07,540 --> 00:11:08,920
come get infected

106
00:11:08,920 --> 00:11:15,699
it just doesn't work that way there's an
ecosystem that exploit kits working

107
00:11:15,700 --> 00:11:20,800
through or exist in this exit this
ecosystem consists of actors in

108
00:11:20,800 --> 00:11:22,459
campaigns

109
00:11:22,460 --> 00:11:29,450
an actor is individual little group and
a particular piece of malware is the

110
00:11:29,450 --> 00:11:35,990
best way of looking at it now actors the
theater like many theaters they're good

111
00:11:35,990 --> 00:11:40,340
actors all you know the good guys which
would I presume you all of us here in

112
00:11:40,340 --> 00:11:46,790
this room and then there are the bad
guys which I recall bad actor I don't

113
00:11:46,790 --> 00:11:52,010
don't like the term bad actor is that
reminds me people like polish or George

114
00:11:52,010 --> 00:11:55,010
Clooney both are bad actors

115
00:11:55,760 --> 00:12:00,170
I mean that guy plays and seeing dumb
character in every movie and no

116
00:12:00,170 --> 00:12:08,150
particularly care for polish or either
threat actor that's what i like to call

117
00:12:08,150 --> 00:12:12,410
them if I have to call me anything other
than actor that's a common term so if

118
00:12:12,410 --> 00:12:15,410
you hear the term threat actor that's
where it's coming from

119
00:12:17,570 --> 00:12:24,170
so a campaign is a system that consists
of an exploit kit plus an infrastructure

120
00:12:24,170 --> 00:12:28,880
that directs potential victims to that
particular exploit kit so you gotta have

121
00:12:28,880 --> 00:12:33,980
a campaign setup if you have an extra
ticket and that's what some people don't

122
00:12:33,980 --> 00:12:38,570
understand you see an exploit kit and
look for next week it you think it I got

123
00:12:38,570 --> 00:12:42,800
hit by neu Trina or I get hit by rig
exploit kit and set that malware well

124
00:12:42,800 --> 00:12:46,339
just because it's for example rig
exploit kit doesn't mean that you will

125
00:12:46,340 --> 00:12:51,710
always get one particular piece of
malware you can be there are different

126
00:12:51,710 --> 00:12:55,730
campaigns that use the various exploit
kits out there and they are sending

127
00:12:55,730 --> 00:13:00,770
different pieces of malware the
different actors they're using so an

128
00:13:00,770 --> 00:13:05,360
actor can use more than one campaign to
distribute their matter where they're

129
00:13:05,360 --> 00:13:11,210
trying to push out their massive scale
and I've seen instances where campaign

130
00:13:11,210 --> 00:13:15,800
can distribute malware from more than
one actor where I've identified a

131
00:13:15,800 --> 00:13:20,209
particular campaign in one hour it's
ending one piece of now and then the

132
00:13:20,210 --> 00:13:23,000
next hour is sending something
completely different

133
00:13:23,000 --> 00:13:27,230
so that indicates that there are there
is another criminal organization that

134
00:13:27,230 --> 00:13:32,840
set up a campaign that's renting itself
out two actors who are trying to

135
00:13:32,840 --> 00:13:33,970
distribute mount

136
00:13:33,970 --> 00:13:40,029
so that it can be a very complex sort of
criminal market there you're in the

137
00:13:40,029 --> 00:13:46,029
market to trying to infect other
people's computers so in its simplest

138
00:13:46,029 --> 00:13:50,889
form the chain of events for a campaign
looks like this where you have

139
00:13:50,889 --> 00:13:56,230
compromised website and that website
will redirect traffic behind the scenes

140
00:13:56,230 --> 00:14:01,720
to an exploit kit server which is also
working behind the scenes compromised

141
00:14:01,720 --> 00:14:10,389
websites are a dime as if you look at
anybody's wishes URL feed you will see

142
00:14:10,389 --> 00:14:15,670
occasionally a good percentage of them
are they look like just regular websites

143
00:14:15,670 --> 00:14:20,050
and you check them in their legitimate
websites they're not set up specifically

144
00:14:20,050 --> 00:14:24,878
to attack anybody or to have anything
there they're just people that have a

145
00:14:24,879 --> 00:14:30,699
wordpress site on their own and forgot
to update it it got it got to only got

146
00:14:30,699 --> 00:14:35,109
compromised and sometimes you'll see
different actors compromise the same

147
00:14:35,110 --> 00:14:39,100
website you'll find injected script from
different campaigns in the same

148
00:14:39,100 --> 00:14:46,269
compromised website but in its a most
basic form any exploit kit infection

149
00:14:46,269 --> 00:14:49,720
always starts with a compromised website

150
00:14:49,720 --> 00:14:58,959
here's an example that I did last week
the website was monopoly capital . com

151
00:14:58,959 --> 00:15:02,589
which is common it may be fixed by now

152
00:15:02,589 --> 00:15:06,910
no but if you look injected script which
i have highlighted here in this slide

153
00:15:06,910 --> 00:15:14,649
from what I call the pseudo dark leach
campaign the patterns of injected script

154
00:15:14,649 --> 00:15:21,040
or common among the campaigns in this
case if you look in the span it will put

155
00:15:21,040 --> 00:15:25,420
that iframe in the negative position
relative viewable screen

156
00:15:27,400 --> 00:15:32,709
so that stuff is all happening outside
of the user and the highlighted portion

157
00:15:32,710 --> 00:15:42,820
yellows URL or landing page for the
neutrino explanation sometimes campaigns

158
00:15:42,820 --> 00:15:47,050
will use another server that will act as
a game between the compromise website

159
00:15:47,050 --> 00:15:58,270
and exploit kit sir I like to look at
the gate as that bridge troll there in

160
00:15:58,270 --> 00:15:59,470
the movie

161
00:15:59,470 --> 00:16:05,200
Monty Python and the Holy Graham so much
like in that movie that bridge troll

162
00:16:05,200 --> 00:16:10,090
that gate is going to have ask you three
questions before you can pass on to the

163
00:16:10,090 --> 00:16:21,220
exponent first question what is your
operating system so now it if you would

164
00:16:21,220 --> 00:16:23,200
say anything other than windows

165
00:16:23,200 --> 00:16:33,730
here's what happens you're not going to
that bridge if you do say windows and

166
00:16:33,730 --> 00:16:35,650
that information is readily available

167
00:16:35,650 --> 00:16:45,280
HTTP request headers you one step closer
to getting past the second question what

168
00:16:45,280 --> 00:16:53,500
is your IP address a lot of times the
campaigns will be specific to particular

169
00:16:53,500 --> 00:17:01,930
geographical area so for example if I've
got a piece of malware that is german

170
00:17:01,930 --> 00:17:06,639
language for some reason i'm choosing to
exploit kit to somehow distribute this

171
00:17:06,640 --> 00:17:12,220
on a wide scale only wanted to affect
germany i'm only going to have it in

172
00:17:12,220 --> 00:17:17,920
some way shape or form that gate will
will throw me over the bridge passage

173
00:17:17,920 --> 00:17:20,920
outside of the bridge if I'm not a
German IP

174
00:17:22,199 --> 00:17:30,179
but if I am the IP that's acceptable i
am one last step closer to getting past

175
00:17:30,179 --> 00:17:38,130
eight the last questions as you're
staring the gate down and get asked you

176
00:17:38,130 --> 00:17:51,240
set you again a lot of researchers will
try to use the same compromised website

177
00:17:51,240 --> 00:17:57,600
to generate a chain of infection track
I've run through or we're all in fact a

178
00:17:57,600 --> 00:18:01,980
loan effective host is I'm trying to
generate expected traffic in for

179
00:18:01,980 --> 00:18:07,380
infection chain and something goes wrong
hard to try to get if i tried again and

180
00:18:07,380 --> 00:18:10,860
i'm using coming from the same IP
address

181
00:18:10,860 --> 00:18:16,769
it's not going to work that expert kid
that gate in this case the gate will not

182
00:18:16,769 --> 00:18:18,389
act

183
00:18:18,389 --> 00:18:24,449
here's an example from what I call the
api test campaign it was first

184
00:18:24,450 --> 00:18:28,830
identified by malwarebytes and only 14
and is still going strong today

185
00:18:29,909 --> 00:18:35,010
here's the pattern of injected script
this particular website in this one may

186
00:18:35,010 --> 00:18:43,799
already be done is it may already be
fixed trying to say is from the eye test

187
00:18:43,799 --> 00:18:53,399
campaign highlighted in yellow are the
URLs go to the gate and then the gate

188
00:18:53,399 --> 00:18:58,199
will return if the conditions are right
it will return script that will direct

189
00:18:58,200 --> 00:19:01,620
you to the landing page of the exploit
kits kinda hard to see here

190
00:19:03,000 --> 00:19:10,860
so here's the script that is returned
now that gate is opened up outside the

191
00:19:10,860 --> 00:19:14,549
viewable a frame of the user

192
00:19:16,690 --> 00:19:22,210
in some campaigns you might see a second
or third game for you to the expert kid

193
00:19:22,210 --> 00:19:25,720
and a lot of times

194
00:19:26,710 --> 00:19:31,810
here's an example where you can see
basement is being used as eight for you

195
00:19:31,810 --> 00:19:39,220
to the second gate so pastebin URL
shorteners like goog l4l URL shortener

196
00:19:39,220 --> 00:19:44,170
I've seen those plenty of times before
although not recently but these are

197
00:19:44,170 --> 00:19:46,150
commonly abused by criminals

198
00:19:46,150 --> 00:19:50,860
the thing is uh with something like
pastebin or something like Google is

199
00:19:50,860 --> 00:19:55,300
it's pretty easy to notify those
companies and quickly clear it up

200
00:19:55,840 --> 00:20:01,929
however it's easy enough for the
criminals you back in and pull some sort

201
00:20:01,930 --> 00:20:09,820
of fraud and get more the set up another
gate through legitimate service like

202
00:20:09,820 --> 00:20:20,050
bass been or Google URL shoulder or
what-have-you common excellent kids the

203
00:20:20,050 --> 00:20:26,530
three common exploit kits that I
currently see our neutrino rig and

204
00:20:26,530 --> 00:20:35,950
magnitude at this point these are just
means the body is curious about other

205
00:20:35,950 --> 00:20:43,630
exploits angler was a big big probably
the biggest in 2015 and throughout june

206
00:20:43,630 --> 00:20:49,180
seven believe of this year it was by far
the most common one that I personally

207
00:20:49,180 --> 00:20:56,770
saw when I was generating traffic but
angler exploit kit disappeared about the

208
00:20:56,770 --> 00:21:04,150
time the criminal gang for the clerk
Trojan banking trojan was arrested by

209
00:21:04,150 --> 00:21:09,130
Russian authorities back in June nuclear
exploit kid disappeared from the scene

210
00:21:09,130 --> 00:21:15,790
in April 2016 and rumor has it that when
checkpoint released its they expose on

211
00:21:15,790 --> 00:21:18,790
nuclear exploit kit back in April the
one that I referenced earlier

212
00:21:19,879 --> 00:21:24,978
that the criminal group or the author
whoever it was fine and clear excellent

213
00:21:24,979 --> 00:21:27,379
it said that's it I'm outta here

214
00:21:27,379 --> 00:21:33,738
active shopping just quit after
literally years and years top-producing

215
00:21:33,739 --> 00:21:38,809
that particular explanation which is
interesting because now the exploit kit

216
00:21:38,809 --> 00:21:45,109
market is really not is saturated as it
was with different models of exploit kit

217
00:21:45,109 --> 00:21:51,948
as compared to 23 years ago other
exploit kits that are not quite as

218
00:21:51,949 --> 00:21:56,839
common sundown is a kind of a
Frankenstein's monster of export kids

219
00:21:56,839 --> 00:22:00,948
wear it like Rob and stole from
different exploit kits include see

220
00:22:00,949 --> 00:22:04,879
traffic from sundown and you would think
it was rigged or you would think it was

221
00:22:04,879 --> 00:22:10,039
nuclear explanation or maybe angler it
just looked a rather rather weird

222
00:22:10,039 --> 00:22:14,690
contracts like it is another one that's
still out there

223
00:22:14,690 --> 00:22:20,029
I personally have not intercepted this
but I've seen it on threat glass . com

224
00:22:20,029 --> 00:22:26,359
where there was an example there and
then you have some really really the

225
00:22:26,359 --> 00:22:32,269
limited distribution exploit kits like
kaizen which i've only seen associated

226
00:22:32,269 --> 00:22:39,440
with traffic from South Korean websites
and Palo Alto Networks has a blog entry

227
00:22:39,440 --> 00:22:45,259
about particular campaign distributing
malware that's targeted toward South

228
00:22:45,259 --> 00:22:54,469
Korean banks using this explanation so
if I'm going to examine exploit kit

229
00:22:54,469 --> 00:23:01,759
traffic i need a few things before i can
generate or cd8 to actually examine the

230
00:23:01,759 --> 00:23:06,769
expert traffic the first prerequisite if
you're going to generate explicate

231
00:23:06,769 --> 00:23:13,309
traffic is you need to stay off your
corporate network for your home network

232
00:23:13,309 --> 00:23:16,849
if you doing this home because if you
infect your computer

233
00:23:17,749 --> 00:23:22,039
there is a chance that you may get
malware that happens to check shared

234
00:23:22,039 --> 00:23:26,509
drives or they happen do you know just
start scanning through the network that

235
00:23:26,509 --> 00:23:28,039
you're currently a part of

236
00:23:28,039 --> 00:23:34,129
and trying to affect their hosts so if
you're doing this and the way I do it

237
00:23:34,129 --> 00:23:39,619
well i'm at home is I use a VPN inserts
and I went into detail on that when i

238
00:23:39,619 --> 00:23:45,019
was talking about my setup at home in
the security onion conference yesterday

239
00:23:45,019 --> 00:23:49,789
that should be available at some point
publicly check that out for Newton's

240
00:23:49,789 --> 00:23:56,149
second thing I would need to generate
expected traffic is horrible windows

241
00:23:56,149 --> 00:24:01,908
that is running an out-of-date version
of flash internet explorer silverlight

242
00:24:01,909 --> 00:24:11,570
java PDF adobe PDF reader the next thing
I need is a compromise website to kick

243
00:24:11,570 --> 00:24:15,918
off the exploit infection chain and
although i don't need a whole packet

244
00:24:15,919 --> 00:24:20,239
capture to generate the traffic i do
need to capture the traffic so i can

245
00:24:20,239 --> 00:24:22,700
actually look at it and see what happens

246
00:24:22,700 --> 00:24:30,409
so look tools I used for examining
expected traffic persons wireshark

247
00:24:30,409 --> 00:24:37,129
security onion which I talked about
yesterday and snort or suricata which

248
00:24:37,129 --> 00:24:45,019
our intrusion detection systems ideas
that programs that can that I can use to

249
00:24:45,019 --> 00:24:50,149
generate alerts on the traffic and see
what I've got here is a screenshot of

250
00:24:50,149 --> 00:24:56,149
wireshark but that's where if this is a
screenshot of security onion and I will

251
00:24:56,149 --> 00:25:01,728
be forever indebted to both of those uh
Doug birds and the crude security onion

252
00:25:01,729 --> 00:25:06,229
and the people behind wire chart because
without those I wouldn't be where I am a

253
00:25:06,229 --> 00:25:15,619
snort snorts pretty interesting because
the the the rules that they the ruleset

254
00:25:15,619 --> 00:25:21,109
i have for smart to detect stuff is a
tiered model so you've got a community

255
00:25:21,109 --> 00:25:26,658
ruleset that you don't need and want
code or anything special if you're

256
00:25:26,659 --> 00:25:31,639
setting up security onion for example I
you might be able to use the should be

257
00:25:31,639 --> 00:25:35,840
able to use the open rule set the
community rules it you can go to the

258
00:25:35,840 --> 00:25:39,799
store . or website you can register and
all you need for that i believe is just

259
00:25:39,799 --> 00:25:40,290
a valid

260
00:25:40,290 --> 00:25:45,899
email address you can get an . code and
you can have a much more robust and

261
00:25:45,900 --> 00:25:51,000
comprehensive ruleset than the community
center position and I've correspondent

262
00:25:51,000 --> 00:25:55,200
with some people through email who had
been using the open community ruleset /

263
00:25:55,200 --> 00:26:01,620
smart and I'm telling mages register the
register ruleset is only 30 days out of

264
00:26:01,620 --> 00:26:06,659
date from the subscriber ruleset where
you would have to pay money and you can

265
00:26:06,660 --> 00:26:11,820
subscribe on board and somebody was
saying I think it's somewhere around

266
00:26:11,820 --> 00:26:21,990
fifty dollars a year if i remember
correctly suricata is another ideas and

267
00:26:21,990 --> 00:26:24,720
it definitely is

268
00:26:24,720 --> 00:26:29,700
it's an ideas and it works in general
the same way as stored in that I see

269
00:26:29,700 --> 00:26:37,590
alerts from the traffic i'll generally
use the emerging threat side for

270
00:26:37,590 --> 00:26:42,480
suricata really emerging threats in
surakarta the the ruleset for emerging

271
00:26:42,480 --> 00:26:49,050
threats and so it goes with suricata
much like the smart / towels registered

272
00:26:49,050 --> 00:26:53,190
ruleset or assets go with smart it's
really they're designed to work together

273
00:26:53,190 --> 00:26:56,190
night you can mix match those but i
don't recommend it

274
00:26:58,440 --> 00:27:02,190
so for looking at individual exploit
kits first we'll look at magnitude

275
00:27:02,190 --> 00:27:08,610
magnitude is generally what I've seen
from his advertising campaigns it uses

276
00:27:08,610 --> 00:27:13,919
profiling gates and the pelo when it
sent over the network is sent in the

277
00:27:13,920 --> 00:27:19,830
clear and this is one of the few leading
exploit kids that sends its payload in

278
00:27:19,830 --> 00:27:23,699
the clear so you can actually detect
this if you're running something like

279
00:27:23,700 --> 00:27:30,150
security onion you have bro where you
can extract that exe another thing about

280
00:27:30,150 --> 00:27:31,740
magnitude from who

281
00:27:31,740 --> 00:27:38,100
proof . blog and equal 2016 they're
talking about the zero-day back then it

282
00:27:38,100 --> 00:27:44,550
was an adobe flash player zero-day 2016
10 19 and for a period of about 24 hours

283
00:27:44,550 --> 00:27:49,800
that flash exploit 10 days so it didn't
matter if your computer was fully

284
00:27:49,800 --> 00:27:52,159
passion up to date if you ran across

285
00:27:52,160 --> 00:27:56,480
exploit kit if you were wondering flash
player regardless of the version it

286
00:27:56,480 --> 00:28:03,050
would get infected in recent months
magnitude seems to be used by only one

287
00:28:03,050 --> 00:28:08,389
actor lucency and marches switch
distributing server or kerber ransomware

288
00:28:08,390 --> 00:28:10,640
my pronouncing that right

289
00:28:10,640 --> 00:28:20,960
Brant somewhere anyway here's an example
of magnitude exploit kit in wireshark

290
00:28:20,960 --> 00:28:26,330
traffic in that I can see gates there
pointing to magnitude exploit kit and

291
00:28:26,330 --> 00:28:32,210
then i can see the actual magnitude
exploit kit traffic i run it through

292
00:28:32,210 --> 00:28:36,350
security onion running the emerging
threats the circuit in the emerging

293
00:28:36,350 --> 00:28:41,750
threats pro ruleset i will find various
alerts that tell me this is magnitude

294
00:28:41,750 --> 00:28:47,210
next week in after a while if you see
this traffic often you can idea visually

295
00:28:47,210 --> 00:28:55,520
without the need for words you can also
submit p caps of exploit kit traffic

296
00:28:55,520 --> 00:29:00,740
whether you find them from my blog or
some other blog you can submit him to

297
00:29:00,740 --> 00:29:06,560
virustotal and it will run through both
snort using this more subscribers set

298
00:29:06,560 --> 00:29:15,530
and suricata using the emerging threats
Pro Set so if I were to check magnitude

299
00:29:15,530 --> 00:29:21,200
I would see both sets of words snort and
suricata and you'll see magnitude want

300
00:29:21,200 --> 00:29:29,750
to say on multiple now magnitude exploit
kit has a profile gate and there are a

301
00:29:29,750 --> 00:29:32,990
couple of blogs are we go through the
details and i'm going to get to eat in

302
00:29:32,990 --> 00:29:38,360
here but the first thing this is a the
second gate and that tried that pcap

303
00:29:38,360 --> 00:29:43,159
attract with him he had ever goes to the
third the first gate goes the second

304
00:29:43,160 --> 00:29:49,610
gate the HTTP request actually contains
the screen resolution of the computer

305
00:29:49,610 --> 00:29:54,770
the victim posts so in this case it was
1024 x 768 for the screen signs

306
00:29:56,710 --> 00:30:03,880
and then it has some code checking for
mister cee and there is a another gate

307
00:30:03,880 --> 00:30:07,390
that's not present in this traffic where
it will literally check for everything

308
00:30:07,390 --> 00:30:15,309
from wireshark to fiddler to vmware any
sort of virtual environments and not

309
00:30:15,309 --> 00:30:20,830
send you to the exploit kit it's an
extra layer of protection from the

310
00:30:20,830 --> 00:30:25,480
people running this particular campaign
to make sure that security researchers

311
00:30:25,480 --> 00:30:30,309
are trying to get through and pull
samples get exact examples of the

312
00:30:30,309 --> 00:30:40,210
traffic flash exploits are often used
among many of the major exploit kits if

313
00:30:40,210 --> 00:30:46,899
you look at traffic using wireshark
going up the tcp screen will find where

314
00:30:46,899 --> 00:30:51,399
it says x-class version in the HTTP
headers that's the version of flash of

315
00:30:51,399 --> 00:30:57,549
the victim post is running in the first
three characters the first three bites

316
00:30:57,549 --> 00:31:08,020
of this is a flash archive ZW s or CWS
are there are the ascii representations

317
00:31:08,020 --> 00:31:11,620
of the first three characters of any
flash exploit that I've seen in the past

318
00:31:11,620 --> 00:31:14,620
couple years

319
00:31:15,279 --> 00:31:31,240
that's what was running on that my
vulnerable ups it's just a browser

320
00:31:31,240 --> 00:31:36,220
header this is active axon activex
plugging so anytime flashes being used

321
00:31:36,220 --> 00:31:40,480
by this machine whether it's the exploit
or anything else is using that activex

322
00:31:40,480 --> 00:31:44,710
plugin that explains version will pop up
in the HTTP

323
00:31:48,269 --> 00:31:58,259
no problem and the executable the
malware is sent in the clear so reg

324
00:31:58,259 --> 00:32:02,969
exploit it is a mid-tier exploit kit is
picked up some steam in recent weeks

325
00:32:02,969 --> 00:32:09,899
when angler exploit kit disappeared in
June 2016 neutrino I saw neutrino

326
00:32:09,899 --> 00:32:14,609
everywhere were previously i had seen
angry ex won't get in the past couple

327
00:32:14,609 --> 00:32:15,418
weeks

328
00:32:15,419 --> 00:32:20,969
the one of the major campaigns have been
tracking the e I testing p switched from

329
00:32:20,969 --> 00:32:25,769
neutrino to rig and now it's just
running rig so I'm seeing a lot more

330
00:32:25,769 --> 00:32:28,709
rigging exploit kit in the past couple
weeks

331
00:32:28,709 --> 00:32:47,820
alrighty i test is one of the campaign's
that uses rig exploit kit so earlier

332
00:32:47,820 --> 00:32:50,820
when I said export cannot exist by
itself

333
00:32:51,539 --> 00:32:56,429
di test is just what malwarebytes first
called it when they discovered it back

334
00:32:56,429 --> 00:33:03,690
in 2014 that at the time it always had
di test is one of the strings and the

335
00:33:03,690 --> 00:33:09,869
objective coat now it doesn't but it's
still the same recognized recognizable

336
00:33:09,869 --> 00:33:15,329
pattern of injected code in that
compromised website so you can still

337
00:33:15,329 --> 00:33:20,039
identify it as what were still calling
the EEI test campaign it's the same guys

338
00:33:20,039 --> 00:33:33,239
right right that's easy i tested were
using to identify the canopy

339
00:33:34,820 --> 00:33:42,769
the payload for ring exploit kit is
obvious cated hows it obvious stated it

340
00:33:42,769 --> 00:33:46,130
is explored with an ascii string and
I'll get to that later

341
00:33:46,130 --> 00:33:54,440
so if i were to open up a pcap of
traffic exploited in this case the eye

342
00:33:54,440 --> 00:33:58,250
test campaign you've got your compromise
website you've got what we're calling

343
00:33:58,250 --> 00:34:02,840
the EEI test gate and then you've got
rig exploit kit I'm running it through

344
00:34:02,840 --> 00:34:11,089
security onion like I did before see
bunch of events or rig exploit kit

345
00:34:11,989 --> 00:34:15,379
once again i can submit the peak at
virustotal and see the same information

346
00:34:15,379 --> 00:34:23,569
so i don't need to set up a secure unit
I don't want to for whatever reason and

347
00:34:23,569 --> 00:34:29,810
interesting thing when rig exploit kit
since the payload now malware binary

348
00:34:29,810 --> 00:34:38,449
executable file windows it will have a
lot of fights are 00 so if you look in

349
00:34:38,449 --> 00:34:45,020
that area of the of the tcp stream where
all the 0 bytes represented you're going

350
00:34:45,020 --> 00:34:51,230
to see that text string over and over
and over here the problem is where does

351
00:34:51,230 --> 00:34:53,540
it start and where is it

352
00:34:53,540 --> 00:34:58,790
so the way I figure it out is that you
through the fourth bite very beginning

353
00:34:58,790 --> 00:35:08,120
is the first 00 bite in the malware
Viner so if i count back that shows k

354
00:35:08,120 --> 00:35:13,759
kappa cave I can't back for from the
capital k that is your asking string

355
00:35:13,760 --> 00:35:22,340
that they're using to explore the
binding and here's a Python script I'm

356
00:35:22,340 --> 00:35:25,670
not gonna leave it up long enough for
you guys probably the right and all them

357
00:35:25,670 --> 00:35:33,200
this stuff will be available afterwards
or you can tweet me on Twitter or email

358
00:35:33,200 --> 00:35:38,629
me at the blog address not will be more
than happy to send you the text for that

359
00:35:38,630 --> 00:35:47,150
neutrino exploit kit is currently a
top-tier exploit kit even though it was

360
00:35:47,150 --> 00:35:55,070
not as good as angry look it was now
with neutrino that currently it's the

361
00:35:55,070 --> 00:35:59,750
only leading exploit kit that i know of
right now that is a skating the payload

362
00:35:59,750 --> 00:36:05,420
using an actual encryption out i want to
say it's rc4 and they're using some sort

363
00:36:05,420 --> 00:36:07,430
of key and I don't know what it is

364
00:36:07,430 --> 00:36:13,580
so personally I don't worry about trying
to copy skate the cable i just pick it

365
00:36:13,580 --> 00:36:23,150
up from the infected host so opening a
pcap of traffic with neutrino exploit

366
00:36:23,150 --> 00:36:28,400
kid see the compromise website looks
like hit the in this case of calling it

367
00:36:28,400 --> 00:36:34,640
i I've been calling it the pseudo dark
leach campaign try to run it and

368
00:36:34,640 --> 00:36:39,259
security onion using the emerging
threats no rule set will see plenty of

369
00:36:39,260 --> 00:36:42,290
alerts that show that this is neutrino
exploit kit

370
00:36:43,970 --> 00:36:49,910
and once again i can submit to a virus
total and see the alerts there if i

371
00:36:49,910 --> 00:36:59,118
don't have access to security onion or
some other IDs in sim combination so

372
00:36:59,119 --> 00:37:03,320
neutrino exploit kit really the only
indications that your that you have that

373
00:37:03,320 --> 00:37:09,830
it's a load on a visual level is singing
the HTTP response headers that content

374
00:37:09,830 --> 00:37:16,098
type is an application / octet stream
and the content length is similar to the

375
00:37:16,099 --> 00:37:24,260
artifact that you would find that's the
actual malware on the infected host so

376
00:37:24,260 --> 00:37:29,599
what does an infection look like when
you're browsing let's take a look

377
00:37:35,270 --> 00:37:45,710
this one is not online is compromised
websites help one group so i'm sipping a

378
00:37:45,710 --> 00:37:51,230
glass of wine and smoking my cigar part
of the one percent browsing through

379
00:37:51,230 --> 00:37:58,940
trying to find what type of wine and one
this is all happening real-time one so

380
00:37:58,940 --> 00:38:03,320
you get a idea of the time it takes from
the time that you first hit optimized

381
00:38:03,320 --> 00:38:12,470
website for the time that the infection
happens and there it is

382
00:38:17,980 --> 00:38:22,090
that pop-up window doesn't happen
anymore this is a Crip Mike ransomware

383
00:38:22,090 --> 00:38:29,140
which is a i believe it's a a newer
version or another family

384
00:38:29,770 --> 00:38:38,140
prior to that was cryptic XXX all of my
letters to the editor modern bride

385
00:38:38,140 --> 00:38:51,100
magazine long so i would go through and
i would check with this particular

386
00:38:51,100 --> 00:38:57,220
ransomware mobile browser group i'll go
through find my files are encrypted find

387
00:38:57,220 --> 00:39:05,500
I have to pay Bitcoin in that I would
use your Union and wireshark to find the

388
00:39:05,500 --> 00:39:11,530
indicators compromise document that
stuff provide samples of the traffic in

389
00:39:11,530 --> 00:39:18,160
the IOC's on my website some
observations based on my research

390
00:39:18,160 --> 00:39:25,960
ransomware is currently the most common
payload for expert so if your

391
00:39:25,960 --> 00:39:30,580
grandmother is at home and saying I
didn't do anything

392
00:39:31,240 --> 00:39:36,129
my computer is infected hi it's possible
that it may have been an expected

393
00:39:36,130 --> 00:39:44,530
especially if she doesn't check your
email legitimate sites and domains are

394
00:39:44,530 --> 00:39:52,210
frequently associated with excellent
track one of the things that I've seen

395
00:39:52,210 --> 00:39:56,560
as people will block legitimate websites
the compromised website that kicks off

396
00:39:56,560 --> 00:40:01,810
the infection chain there's a technique
that exploit kits use calls domain

397
00:40:01,810 --> 00:40:06,759
shadowing where you've got a legitimate
website and they compromise their domain

398
00:40:06,760 --> 00:40:12,940
registration credentials and then they
will set up servers so newyorktimes.com

399
00:40:12,940 --> 00:40:17,080
for example not that they've actually
been compromised

400
00:40:17,080 --> 00:40:21,549
let's just say that their domain
credentials were compromised the

401
00:40:21,550 --> 00:40:25,450
criminals will use those domain
credentials to set up other servers like

402
00:40:25,450 --> 00:40:30,339
random string of characters .
newyorktimes.com and then that's your

403
00:40:30,340 --> 00:40:31,060
malicious

404
00:40:31,060 --> 00:40:37,720
and that your excellent kids
newyorktimes.com is not compromised what

405
00:40:37,720 --> 00:40:43,180
those other domains are the last thing
is exploit kit indicators are constantly

406
00:40:43,180 --> 00:40:52,450
changing so even if you block something
if you block in particular domain your

407
00:40:52,450 --> 00:40:54,549
Vblock a particular IP address

408
00:40:54,550 --> 00:41:00,850
odds are within 24 hours probably sooner
it's going to be an invalid shouldn't

409
00:41:00,850 --> 00:41:05,170
say invalid that's going to be an
ineffective way of blocking execute

410
00:41:05,170 --> 00:41:13,060
traffic so what's your best defense it's
so hard to detect and prevent this stuff

411
00:41:13,060 --> 00:41:20,500
first one is to keep your computer's
fully up-to-date fully patched easy to

412
00:41:20,500 --> 00:41:25,540
say and probably easy for everyone of us
in this room to do for our own stuff

413
00:41:25,540 --> 00:41:32,290
kind of hard for our family members to
do it hard for Grandma and Grandpa kind

414
00:41:32,290 --> 00:41:38,440
of heart or a large-scale enterprise
with hundreds of thousands of computers

415
00:41:38,440 --> 00:41:44,740
to worry about to do you can implement
browsing restrictions

416
00:41:45,460 --> 00:41:49,000
there's also group policy restrictions
that you can do that would lessen the

417
00:41:49,000 --> 00:41:52,750
chance of malware if it actually gets to
your machine through an exploitative

418
00:41:52,750 --> 00:41:54,950
being executed

419
00:41:54,950 --> 00:42:02,839
and finally threat detection prevention
and protection solutions at least in the

420
00:42:02,839 --> 00:42:09,049
enterprise environment our way that many
enterprises try to combat this threat

421
00:42:09,050 --> 00:42:15,500
for example you can go to the palo alto
dot-com website and find a bevy of

422
00:42:15,500 --> 00:42:16,970
security solutions

423
00:42:16,970 --> 00:42:21,379
I'd be remiss if I didn't mention this
since a halogen networks as people my

424
00:42:21,380 --> 00:42:28,849
trip here so to summarize we went over
the explicate concept exploit kit

425
00:42:28,849 --> 00:42:36,320
ecosystems common exploit kits examining
exploit keep traffic and your best

426
00:42:36,320 --> 00:42:44,390
effects now we can do questions however
what I would like to try is a little bit

427
00:42:44,390 --> 00:42:49,098
of expected jeopardy to kind of review
some of your children we've had and

428
00:42:49,099 --> 00:43:02,839
there are prizes so we got concepts that
means we got track so it's a somebody uh

429
00:43:02,839 --> 00:43:12,859
some I raised a hand or spice shout-out
category price is that usually answer

430
00:43:12,859 --> 00:43:21,710
traffic for 300 ok the traffic category
picture wireshark capture of traffic

431
00:43:21,710 --> 00:43:25,609
that i just presented earlier and you'll
have to tell me

432
00:43:26,180 --> 00:43:31,490
user will have to tell me what exploit
kit that was if you get it correct

433
00:43:32,170 --> 00:43:38,049
you get this land turtle device here we
go

434
00:43:39,760 --> 00:43:47,980
what exploit king is list will give him
a chance to answer

435
00:43:48,670 --> 00:43:51,849
Sen in the back you know

436
00:43:51,849 --> 00:44:25,900
yes that is growing get all right so you
had your hand up in the back

437
00:44:25,900 --> 00:44:29,349
Miller

438
00:44:29,349 --> 00:44:33,400
ah yes please

439
00:44:34,569 --> 00:44:49,720
traffic for 200 look familiar with a
that is incorrect

440
00:44:50,290 --> 00:45:00,700
sorry anybody else I user training
partner that is correct

441
00:45:28,119 --> 00:45:35,290
alright we got time for one more
question

442
00:45:36,940 --> 00:45:48,760
so I certain concepts for 300 this is
our next bike is still working

443
00:45:51,790 --> 00:46:03,460
haha i'll be very liberal with the
sensor or is something simpler in

444
00:46:03,460 --> 00:46:14,980
general share in the back going to you
yes taking advantage of vulnerability

445
00:46:15,520 --> 00:46:30,609
true true alright anyone just shot it up
behind the scenes there you go find

446
00:46:30,609 --> 00:46:34,509
seeds while web browsing without a user
actually adds kind of our that is why it

447
00:46:34,510 --> 00:46:41,140
was a three-hundred-dollar questions and
trying one more here

448
00:46:43,089 --> 00:46:58,060
dang it seems 300 commonly used in
advertising campaigns first exploit kids

449
00:46:58,060 --> 00:47:03,880
seem using exploits receiving yes you
are correct it is magnitude $300

450
00:47:03,880 --> 00:47:06,880
imaginary to the gentleman in the front
row

451
00:47:07,390 --> 00:47:24,640
alright anyone concepts 100 the answer
is 2016 00 34 this is a hundred-dollar

452
00:47:24,640 --> 00:47:32,230
questions so it's not too complicated to
say what this is not flash you're

453
00:47:32,230 --> 00:47:35,069
getting too specific

454
00:47:35,069 --> 00:47:45,209
there you go thank you i I've heard
people say all a CB 2016 00 34 they're

455
00:47:45,209 --> 00:47:50,578
describing an exploit it's like now
that's a vulnerability say CBE 2016 00

456
00:47:50,579 --> 00:47:55,650
34 exploit and then you're fine but
don't just call exploit the

457
00:47:55,650 --> 00:48:09,809
vulnerability and we'll do one more here
before i sign anyone but is next week it

458
00:48:09,809 --> 00:48:13,109
plus infrastructure that directs
potential victims to it

459
00:48:13,109 --> 00:48:17,130
there you go 200 imaginary dollars

460
00:48:18,119 --> 00:48:28,319
the gentleman who answered the question
and that's it I don't waste any more of

461
00:48:28,319 --> 00:48:32,400
you guys it's time thank you very much
for Akhenaten and very with me

