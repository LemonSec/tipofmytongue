1
00:00:00,000 --> 00:00:05,670
thank you everyone hear me alright
alright

2
00:00:07,080 --> 00:00:12,059
ok so I'm going to talk to you about a
little bit machine learning today and

3
00:00:12,059 --> 00:00:21,600
how I'm trying to make that pertain to
exploit kits at the outset I want to be

4
00:00:21,600 --> 00:00:25,380
sure i clarify that I'm not really an
expert in exploit kits

5
00:00:25,380 --> 00:00:30,299
I mean it's not like terribly
complicated stuff going on there but I

6
00:00:30,300 --> 00:00:35,880
think it's important to say that and as
much as I'm not an expert on exploit

7
00:00:35,880 --> 00:00:39,510
kits i'm less so of one on machine
learning just sort of something I've

8
00:00:39,510 --> 00:00:45,660
played around with for the last three or
four months so of course this seemed

9
00:00:45,660 --> 00:00:48,718
like a really good idea three or four
months ago but now now you get to see

10
00:00:48,719 --> 00:00:54,539
why in fact know about the stuff
something I like to do when i gave a

11
00:00:54,539 --> 00:00:57,390
talk as i like to give people a few
options so they can sort

12
00:00:57,390 --> 00:01:02,340
choose-your-own-adventure this is I
think good for the second one and then

13
00:01:02,340 --> 00:01:10,320
I've got 20 minutes to get into some
like pretty complicated topics I mean 20

14
00:01:10,320 --> 00:01:12,809
minutes 45 minutes there's never enough
time when you start talking about things

15
00:01:12,810 --> 00:01:17,189
like this so this talk scared to be high
level and hopefully give you some ideas

16
00:01:17,189 --> 00:01:22,350
but definitely not to be a record of
scientific fact these are mostly my own

17
00:01:22,350 --> 00:01:28,080
musings from the work I've done the last
few months as Mark said I'm a systems

18
00:01:28,080 --> 00:01:32,158
engineer at fireeye have been there for
about two-and-a-half years now

19
00:01:32,159 --> 00:01:36,090
before that I worked on the GE sir out
in Michigan go blue

20
00:01:36,600 --> 00:01:46,229
before that I worked as a host forensics
consultant for an undisclosed bender out

21
00:01:46,229 --> 00:01:52,200
of Boston and if anyone else has been
consulted before then you might feel

22
00:01:52,200 --> 00:01:55,920
like I do wear that the best skill I
feel like I learned as a consultant was

23
00:01:55,920 --> 00:01:59,790
that in the time it takes to get a call
to go somewhere you have to show up on

24
00:01:59,790 --> 00:02:03,930
site and be an expert and teaching
yourself on the plane what you need to

25
00:02:03,930 --> 00:02:07,950
know to sound like an expert it's a
really useful skill and

26
00:02:08,929 --> 00:02:16,219
something that that helps because it's
nice to not sound like a moron okay uh I

27
00:02:16,219 --> 00:02:21,140
work for chris sanders who already spoke
to you spoke yesterday he wrote applied

28
00:02:21,140 --> 00:02:25,879
network security monitoring and also
like to give a shout-out quickly to the

29
00:02:25,879 --> 00:02:30,649
rural tech fund which he also founded
which was a lot of great work you can

30
00:02:30,650 --> 00:02:35,599
check it out at think it's realtek fun .
organs that right Chris ok yeah so check

31
00:02:35,599 --> 00:02:40,578
that out and then I like to throw in fun
facts when I can have fun fact here is

32
00:02:40,579 --> 00:02:46,879
you'll see Jason Smith is a co-author on
this book I wouldn't go so far as to say

33
00:02:46,879 --> 00:02:53,298
Jason is my friend but one time he did
abandon me in the dark parking lot on

34
00:02:53,299 --> 00:03:01,189
the side of i-95 in Connecticut as far
as i know that was an accident okay did

35
00:03:01,189 --> 00:03:06,560
a show of hands anyone remember me
speaking last year about the digital

36
00:03:06,560 --> 00:03:08,209
Shepherd wall

37
00:03:08,209 --> 00:03:11,269
ok few people yeah

38
00:03:11,269 --> 00:03:15,829
remember remember couple you so I just
wanted to quickly provide an update that

39
00:03:15,829 --> 00:03:20,690
story because I've seen a few people
around here that have been asking me

40
00:03:20,690 --> 00:03:22,639
about it because they were really
curious to know about the exciting

41
00:03:22,639 --> 00:03:27,049
conclusion so anyways i'm just going to
go through a couple slides real quickly

42
00:03:27,049 --> 00:03:31,669
and this has nothing to do with anything
but some people were interested so

43
00:03:31,669 --> 00:03:36,319
mature quickly what we see here is my
house is the blue one in the distance

44
00:03:36,319 --> 00:03:40,879
and there's a big 50 3050 by 30-foot
wall working in the foreground they're

45
00:03:40,879 --> 00:03:45,439
very sinisterly that was my neighbor put
that up last year because didn't like

46
00:03:45,439 --> 00:03:53,900
looking at my house so someone this
really good out of control i was like on

47
00:03:53,900 --> 00:03:58,939
national news and stuff with the story
last year anyways I like stay here is

48
00:03:58,939 --> 00:04:02,478
you should never kick a man when he's
down and that is not something that

49
00:04:02,479 --> 00:04:04,450
Chris Sanders believes

50
00:04:04,450 --> 00:04:16,358
yeah thanks thanks Chris this is this
hurt a lot and okay so anyways that i

51
00:04:16,358 --> 00:04:19,930
gave this talk last year all about the
third wall what happened to be there and

52
00:04:19,930 --> 00:04:26,110
I'm if you go on google you can find all
sorts of crazy stuff about it but about

53
00:04:26,110 --> 00:04:31,600
30 days after talking here last year the
source with the situation resolved

54
00:04:31,600 --> 00:04:36,010
itself when the state of Vermont my
neighbor who is also almost the governor

55
00:04:36,010 --> 00:04:41,110
of vermont . that she needed to remove
the wall or they were going to do it for

56
00:04:41,110 --> 00:04:41,800
her

57
00:04:41,800 --> 00:04:47,380
so between up there was the last I saw
of peppered wall and that's all I'm

58
00:04:47,380 --> 00:04:48,490
going to say about that

59
00:04:48,490 --> 00:04:52,450
ok so now our story today really begins

60
00:04:53,050 --> 00:05:00,490
back when I was a lad in high school I
guess and what happened was at the time

61
00:05:00,490 --> 00:05:06,460
this was in the early nineties i really
wanted to be I guess was called like a

62
00:05:06,460 --> 00:05:11,320
hotspot dr. back then I wanted to sort
of be someone that was like dropped into

63
00:05:11,320 --> 00:05:16,659
remote areas to respond to things like
Ebola I've just always had a passion for

64
00:05:16,660 --> 00:05:21,970
infectious disease so I went to college
and I majored in biochemistry

65
00:05:22,960 --> 00:05:26,620
well i started doing that I ended up
switching to a computer science

66
00:05:26,620 --> 00:05:29,620
I'm after a while but i'm actually still
about a semester short of a biochem

67
00:05:29,620 --> 00:05:34,600
degree as part of like a biochem
education one of the things you learn a

68
00:05:34,600 --> 00:05:42,280
lot about is evolution now I personally
think that evolution is kind of top

69
00:05:42,280 --> 00:05:45,760
poorly and a lot of schools in our
country for a lot of different reasons

70
00:05:46,720 --> 00:05:50,349
so if you're not familiar with it on
just wanted to go through a couple

71
00:05:50,349 --> 00:05:54,460
things here because it sort of relates
to one talking about i think it a good

72
00:05:54,460 --> 00:05:59,620
way to think about evolution is in some
ways to see some examples that aren't

73
00:05:59,620 --> 00:06:06,970
right so before Charles Darwin there's a
guy john baptiste Lamarck and his sort

74
00:06:06,970 --> 00:06:11,380
of famous is example of how evolution
works does he believe in this idea of

75
00:06:11,380 --> 00:06:17,639
use and misuse so essentially he thought
like a wager apps sort of evolved with

76
00:06:17,639 --> 00:06:23,009
that they had to continually reach for a
the food on higher levels of trees and

77
00:06:23,009 --> 00:06:29,249
things and it was just through the act
of like one generation of things sort of

78
00:06:29,249 --> 00:06:33,930
a meeting to stretch and whatever that
the next generation of that organism

79
00:06:33,930 --> 00:06:40,620
would incorporate that and everything
would just sort of get a would adapt in

80
00:06:40,620 --> 00:06:44,039
that way not really based on anything
other than using this use the similar

81
00:06:44,039 --> 00:06:48,840
thing would be like he believed that
like if he cut off his toe and then his

82
00:06:48,840 --> 00:06:52,289
kid cut off his toe and then his kids
kitkat office know eventually you get a

83
00:06:52,289 --> 00:06:57,659
person that didn't have a toe there and
that's not how evolution works but at

84
00:06:57,659 --> 00:07:00,509
the beginning the eighteen-hundreds this
was sort of groundbreaking because he

85
00:07:00,509 --> 00:07:06,330
was trying to think about well how do
things change now Darwinian evolution is

86
00:07:06,330 --> 00:07:11,520
predicated on natural selection and this
is a really famous example that you'll

87
00:07:11,520 --> 00:07:16,469
see a lot it's sort of explains the idea
simply an elegant like and what you have

88
00:07:16,469 --> 00:07:23,909
here is this is the peppered moth which
had this this natural selection occurred

89
00:07:23,909 --> 00:07:29,370
in the industrial revolution in England
so late eighteen hundreds but what

90
00:07:29,370 --> 00:07:34,710
happened is the peppered moth sort of
started as was on the left was light and

91
00:07:34,710 --> 00:07:40,710
black speckled and that was fine before
the industrial revolution because it

92
00:07:40,710 --> 00:07:43,409
would land on trees and that camouflage
would protect it

93
00:07:43,409 --> 00:07:47,129
what happened during the industrial
revolution is that the trees there's so

94
00:07:47,129 --> 00:07:53,159
much pollution the trees were covered
with soot and ash so that the peppered

95
00:07:53,159 --> 00:07:56,399
moths could actually stand out and they
would get picked off by predators much

96
00:07:56,399 --> 00:08:01,319
more easily so what happened with a
variation in the gene pool is that

97
00:08:01,319 --> 00:08:07,529
natural selection sort of allowed the
the progression of the peppered moth

98
00:08:07,529 --> 00:08:14,039
become more solidly black because it
allowed it to evade detection by its

99
00:08:14,039 --> 00:08:18,688
predators on when it was on the sort of
ashy trees so that's like a very clear

100
00:08:18,689 --> 00:08:24,060
example of how evolution sort of works
one that's simple to understand them but

101
00:08:24,060 --> 00:08:28,259
the big thing with evolution is that
it's very incremental right so

102
00:08:28,860 --> 00:08:31,919
it's not something that happens
overnight it takes several several

103
00:08:31,919 --> 00:08:35,819
several iterations generations to be
able to accumulate these different

104
00:08:35,820 --> 00:08:41,190
changes that occur and I finally I like
to show this cause I think it's so cool

105
00:08:41,190 --> 00:08:46,200
but at moths are neat because they can
adaptively quickly to a new environment

106
00:08:46,200 --> 00:08:51,120
based on genetic variation and the
relatively short lifespan so this is the

107
00:08:51,120 --> 00:08:55,320
emperor moth i'll ask you real quickly
can anyone tell what its adaptation is

108
00:08:55,320 --> 00:08:57,720
that makes it successful here

109
00:08:57,720 --> 00:09:05,490
yeah that yeah right exactly makes the
face i'm actually better example that on

110
00:09:05,490 --> 00:09:10,470
the next page so you see here this is
the same moth but what's cool is that

111
00:09:10,470 --> 00:09:16,200
it's actually evolved to look like the
face of an owl because an hour was a

112
00:09:16,200 --> 00:09:20,070
predator of the birds that prey on the
moth so it's cares its predators away

113
00:09:20,070 --> 00:09:26,820
and it's even to the point where you can
see it's a that the spots on the wings

114
00:09:26,820 --> 00:09:29,880
look like eyes they're not perfectly
round because evolution isn't about

115
00:09:29,880 --> 00:09:30,990
perfection

116
00:09:30,990 --> 00:09:36,029
it's about being good enough so that you
can survive to reproduce another day

117
00:09:36,029 --> 00:09:44,820
which is like that's an interesting idea
but um yeah what's need to me about this

118
00:09:44,820 --> 00:09:49,470
but I just think it's amazing is you can
even see how the that's not actually

119
00:09:49,470 --> 00:09:53,010
reflected light in the spots on the
wings that's that's actually how its

120
00:09:53,010 --> 00:09:57,630
evolved to look like reflected light of
our not eyeballs which I just think is

121
00:09:57,630 --> 00:10:01,709
amazing so I love science

122
00:10:02,610 --> 00:10:08,430
so all this idea of evolution stuff I've
always I think about this a lot it's

123
00:10:08,430 --> 00:10:12,000
really like the ones I view the world
through now then on what happened a few

124
00:10:12,000 --> 00:10:18,630
months ago is there's a guy in my team
name is Dustin and I was sad for him

125
00:10:18,630 --> 00:10:24,240
because he was like on the 20-something
iteration of a rule he was writing for

126
00:10:24,240 --> 00:10:30,180
the angler exploit kit and you know
anything about exploit kits the popular

127
00:10:30,180 --> 00:10:36,209
ones will change frequently and it's a
it's hard when you're writing rules to

128
00:10:36,209 --> 00:10:39,359
detect this stuff to sort of keep up
with it

129
00:10:39,360 --> 00:10:42,420
what i have here also are just some
other exploit kits

130
00:10:42,420 --> 00:10:48,899
that was sort of popular in the last
year or two so this is what really gave

131
00:10:48,899 --> 00:10:54,089
me the idea of our thinking you know if
these exploits are changing so rapidly

132
00:10:54,089 --> 00:11:00,300
as the sort of malware authors are
trying to evade detection

133
00:11:01,079 --> 00:11:06,209
I wondered over time that is something
that could be predicted sort of like

134
00:11:06,209 --> 00:11:09,810
evolution or is it evolving in a way
that I could guess how it would change

135
00:11:09,810 --> 00:11:14,099
before changed and that was sort of the
idea behind what I was doing here with

136
00:11:14,100 --> 00:11:19,620
my research I like to give a shout-out
to the bread don't get from now where

137
00:11:19,620 --> 00:11:24,930
traffic analysis . net here because
that's where I get all my that well

138
00:11:24,930 --> 00:11:29,219
mostly all my samples from it's just
it's a great resource for people in our

139
00:11:29,220 --> 00:11:33,990
field if you're not using this site you
should be but it's just invaluable for

140
00:11:33,990 --> 00:11:40,500
studying exploit kits so definitely
check this out and just a I assume that

141
00:11:40,500 --> 00:11:47,279
most people here are familiar with
exploit kits but high-level victim

142
00:11:47,279 --> 00:11:52,230
visits a website with servers been
compromised by cybercriminals victim is

143
00:11:52,230 --> 00:11:57,720
typically redirected through various a
intermediary servers the victim lens

144
00:11:57,720 --> 00:12:02,310
that a rogue server hosting the exploit
kit exploit gathers information on the

145
00:12:02,310 --> 00:12:08,310
victim and determines the proper exploit
to deliver based on the software the

146
00:12:08,310 --> 00:12:12,540
victim is running on their machine and
exploit is then delivered based on that

147
00:12:12,540 --> 00:12:16,980
information and if it's a successful
than a malicious payload gets downloaded

148
00:12:16,980 --> 00:12:18,480
and and executed

149
00:12:18,480 --> 00:12:28,019
that's the twenty thousand foot view of
a exploit kits so I wanted to sort of

150
00:12:28,019 --> 00:12:34,769
take the idea of this in evolution and I
thought well this sounds sort of a lot

151
00:12:34,769 --> 00:12:38,910
like what I'm hearing about machine
learning on these days which is sort of

152
00:12:38,910 --> 00:12:46,139
that the new buzzword that the hot thing
so I again sort of high-level but some

153
00:12:46,139 --> 00:12:52,319
some ideas and how machine learning
works it's a it's a branch of AI but

154
00:12:52,319 --> 00:12:57,660
it's very i would say probabilistic
based approach so I also think of it as

155
00:12:57,660 --> 00:12:59,160
very analytics ish

156
00:12:59,160 --> 00:13:07,110
although i've not heard everyone refer
to it that way but machine learning it

157
00:13:07,110 --> 00:13:12,930
relies on examples and experience so
with what I'm familiar with there are

158
00:13:12,930 --> 00:13:17,939
three sort of different kinds of machine
learning and it's you know people might

159
00:13:17,939 --> 00:13:21,390
might have some other subcategories
whatever but this is sort of my

160
00:13:21,390 --> 00:13:22,350
understanding

161
00:13:22,350 --> 00:13:26,279
alright so there's reinforcement
unsupervised and supervised learning to

162
00:13:26,279 --> 00:13:31,620
give you an idea of how reinforcement
works think of chess reinforcement is

163
00:13:31,620 --> 00:13:37,769
actually a subset of supervised learning
and so when you think of chess and you

164
00:13:37,769 --> 00:13:42,810
think about a computer game that is
playing someone you know it if at the

165
00:13:42,810 --> 00:13:48,810
end of that game someone uh if the
computer loses then it can take that and

166
00:13:48,810 --> 00:13:51,060
say okay that's a bad outcome and learn
from that

167
00:13:51,060 --> 00:13:54,689
that's sort of the idea of reinforcement
if it wins and it did some right things

168
00:13:54,689 --> 00:14:00,480
it can also use that as a way to sort of
feed feed the algorithm feed itself

169
00:14:04,050 --> 00:14:12,089
thank you so uncivilized is really get
to the thing that stands out to me was

170
00:14:12,089 --> 00:14:16,740
unsupervised the idea of clustering
that's essentially you have some data

171
00:14:16,740 --> 00:14:22,350
and if you just that I really should put
up a slide for this but i didn't but

172
00:14:22,350 --> 00:14:27,390
data might clump somewhere on a graph in
different regions right you might have

173
00:14:27,390 --> 00:14:32,310
like a think of something simple like
file size or something

174
00:14:32,310 --> 00:14:36,268
the usual in America it's easy to plot
but if you see clusters of things

175
00:14:36,779 --> 00:14:41,910
today's algorithms with machine learning
are really good at recognizing that and

176
00:14:41,910 --> 00:14:45,600
deciding ok that should belong in a
special category from this other company

177
00:14:45,600 --> 00:14:49,290
thinks that's that's sort of the basis
of unsupervised learning the sort of

178
00:14:49,290 --> 00:14:54,089
thing i was doing with my example was
what's called supervised learning and

179
00:14:54,089 --> 00:14:57,750
with supervised learning the way it
works is you essentially already know

180
00:14:57,750 --> 00:15:02,459
the answer so what you have to do is you
train the data that you are looking to

181
00:15:02,459 --> 00:15:08,130
be able to detect so in my case if I've
got a bunch of exploit kits or pecans

182
00:15:08,130 --> 00:15:08,810
from exploit

183
00:15:08,810 --> 00:15:13,430
it's i can run that through bro i can
generate some data i know that with this

184
00:15:13,430 --> 00:15:18,529
particular data set that you know these
are malicious so i can use these to

185
00:15:18,529 --> 00:15:27,110
train my model and I can also then take
a benign data and sort of do the same

186
00:15:27,110 --> 00:15:30,770
thing to teach it ok this is this is
stuff that is not malicious

187
00:15:30,770 --> 00:15:36,680
so what you do with supervised learning
it's it's really a very the high-level

188
00:15:36,680 --> 00:15:40,279
simple three-step process you collect
training data you have to train a

189
00:15:40,279 --> 00:15:43,460
classifier and then you make predictions
and that's really it

190
00:15:43,460 --> 00:15:51,890
so like I said I use bro to get HTTP
proxy data and essentially what you're

191
00:15:51,890 --> 00:15:56,000
doing is you're kind of creating a
simple function you feed data into it

192
00:15:56,000 --> 00:16:00,230
and you get a label out and in my case
my label out was going to be this is

193
00:16:00,230 --> 00:16:01,940
malicious or this is benign

194
00:16:01,940 --> 00:16:08,720
ok so an example for training my data

195
00:16:08,720 --> 00:16:16,100
this was done with the magnitude exploit
kit and something you can say that this

196
00:16:16,100 --> 00:16:20,870
is a as i'm training I've got to HP
method user-agent refer cookie there's

197
00:16:20,870 --> 00:16:28,400
your I length your I string and label so
I've got to malicious samples there and

198
00:16:28,400 --> 00:16:34,189
two minutes to benign and with today's
algorithms that are available that

199
00:16:34,190 --> 00:16:36,860
really does all the stuff under the
covers and union have to be an expert

200
00:16:36,860 --> 00:16:43,880
i'm in the stuff to do you can feed this
into a into these these different

201
00:16:43,880 --> 00:16:50,300
frameworks like psychic learning and
sort of overtime with lots of samples

202
00:16:50,300 --> 00:16:58,339
train a train your program to be able to
detect you know what what malicious or

203
00:16:58,339 --> 00:17:04,280
what benign looks like so there's a
couple of issues here that I'll talk

204
00:17:04,280 --> 00:17:05,449
about quickly

205
00:17:05,449 --> 00:17:08,209
one of the things is when you're doing
like machine-learning you really want to

206
00:17:08,209 --> 00:17:12,170
keep everything in terms of numbers
because that's how sort of map happens

207
00:17:12,170 --> 00:17:17,810
right so if you have like a string like
get or post you need to somehow convert

208
00:17:17,810 --> 00:17:21,230
that to a numerical value and there's
different ways of doing that like you

209
00:17:21,230 --> 00:17:22,000
could say if you

210
00:17:22,000 --> 00:17:25,300
to get ok if it equals get that's a one
if it's something other than the get

211
00:17:25,300 --> 00:17:28,359
then it's a zero it could be that simple

212
00:17:28,359 --> 00:17:32,199
in the case of magnitude a lot of times
with the payload you're looking for a

213
00:17:32,200 --> 00:17:38,170
32a 32 character string so if you can
actually look for the length of the

214
00:17:38,170 --> 00:17:43,720
string that can be a good numerical ok
32 that's a number i can use 32 is is a

215
00:17:43,720 --> 00:17:47,920
going to be good anything other than 32
it's not going to be a it's not gonna be

216
00:17:47,920 --> 00:17:51,940
malicious and i'll talk about the
problems with your I strings in just a

217
00:17:51,940 --> 00:18:00,490
second okay so once we started
collecting start to train this data we

218
00:18:00,490 --> 00:18:10,390
need to be able to sort of have our
program do a extra execute this decision

219
00:18:10,390 --> 00:18:14,500
tree and while this looks pretty
complicated this is like literally a

220
00:18:14,500 --> 00:18:18,010
liner to a Python code that that's
really pretty basic

221
00:18:18,850 --> 00:18:23,469
so I'm just taking those uh those
classifiers i showed you from before

222
00:18:23,470 --> 00:18:29,500
those labels the the data that we feed
in and we just take it one step at a

223
00:18:29,500 --> 00:18:33,850
time so if i give it a new a new sample
this is a new log

224
00:18:33,850 --> 00:18:40,300
HTTP proxy log that comes in well first
I check you know is it i get if it's not

225
00:18:40,300 --> 00:18:44,020
a get then I know that it's benign for
this magnitude EK thing that I'm looking

226
00:18:44,020 --> 00:18:49,480
at right but if it is indeed to get then
it just goes on and it cascades on down

227
00:18:49,480 --> 00:18:53,380
until if it needs all the conditions
then we can say with a reasonable amount

228
00:18:53,380 --> 00:18:57,910
of certainty that it is in fact
malicious and that's just an example of

229
00:18:57,910 --> 00:19:02,470
how decision tree works in machine
learning and that's really what your

230
00:19:02,470 --> 00:19:06,640
goal is you're trying to get your data
into a way that you can sort of give it

231
00:19:06,640 --> 00:19:14,470
you know yes or no questions that's very
binary 10 sort of things real quickly I

232
00:19:14,470 --> 00:19:19,180
just like bag-of-words I think it's fun
to say but we have this issue with

233
00:19:19,180 --> 00:19:23,110
machine learning where he doesn't work
really well with strings so you just

234
00:19:23,110 --> 00:19:26,500
have to figure out a way to get those
strings to think of them in terms of

235
00:19:26,500 --> 00:19:32,020
numerical so like I just use the example
of the user-agent you could do something

236
00:19:32,020 --> 00:19:35,410
like okay if I know that this is a bad
user agent this one is not

237
00:19:35,410 --> 00:19:40,990
this is normal but if it was i could say
okay I'm going to assign a numerical 1

238
00:19:40,990 --> 00:19:48,970
or 0 for every that every like token in
the strength there might be things that

239
00:19:48,970 --> 00:19:55,000
are sort of contra indicators like if
it's a apple or something that you don't

240
00:19:55,000 --> 00:19:59,590
want in there you know that that's a
legit then you might just assign that to

241
00:19:59,590 --> 00:20:07,480
zero in the training data and then
quickly anaconda and Python anaconda is

242
00:20:07,480 --> 00:20:11,950
like Pippa fuse if you've used it's a
package manager for Python for

243
00:20:11,950 --> 00:20:17,650
scientific and math packages so you can
do simple commands like Conda install a

244
00:20:17,650 --> 00:20:22,600
package and the packages are things like
a numpy side-by-side kit learn which is

245
00:20:22,600 --> 00:20:28,449
what I used for my work that plot live
band is so I really good stuff and then

246
00:20:28,450 --> 00:20:30,850
finally my results

247
00:20:30,850 --> 00:20:36,820
what i have here uh just shows the
samples of the top that I tested and

248
00:20:36,820 --> 00:20:45,820
then what I found for my success rate on
the bottom so for the rig EK is like a

249
00:20:45,820 --> 00:20:50,320
thirty-four percent success rate angler
. . to two or twenty percent angler

250
00:20:50,320 --> 00:20:53,500
anger can go to hell and I knew it

251
00:20:53,500 --> 00:20:57,910
neutrino was better i think because of
the good samples i have for that and

252
00:20:57,910 --> 00:21:03,220
magnitude sort of unique thing it was a
kind of easier to detect and I think

253
00:21:03,220 --> 00:21:07,990
that's why I had some better success
there so those were sort of the results

254
00:21:07,990 --> 00:21:12,790
that I had their problems with that and
i'll talk about i just have a minute or

255
00:21:12,790 --> 00:21:18,790
two left here so this isn't anything
like scientific that I pulled out of

256
00:21:18,790 --> 00:21:22,780
this is a this is my own thing that I
want to share a sort of like a learning

257
00:21:22,780 --> 00:21:30,070
learning thing that I experienced here
and I think with with this kind of

258
00:21:30,070 --> 00:21:34,120
machine learning at least as it applies
to exploit kits and things that are

259
00:21:34,120 --> 00:21:39,520
constantly changing what happens is a
you have this problem of exponential

260
00:21:39,520 --> 00:21:43,960
decay then what that means is if we have
a false positive rate on the Left

261
00:21:43,960 --> 00:21:50,710
hundred percent and i'm not on the
x-axis we have think of it as effort

262
00:21:50,710 --> 00:21:53,560
that you put into the problem

263
00:21:53,560 --> 00:21:57,159
well with very little effort ten percent
effort we can get the false-positive

264
00:21:57,160 --> 00:22:02,620
rate down quite a bit but what happens
is you have to put a lot of effort into

265
00:22:02,620 --> 00:22:06,699
continually get that false positive rate
down and that's a problem when you're

266
00:22:06,700 --> 00:22:14,560
trying to do I think detection at scale
for for a lot of people because one

267
00:22:14,560 --> 00:22:17,350
percent of a big number is still a big
number

268
00:22:17,350 --> 00:22:20,620
so like when I'm showing rates of thirty
percent 40-percent fifty percent success

269
00:22:20,620 --> 00:22:25,689
is a step in the right direction but i
still think it's kind of terrible

270
00:22:26,320 --> 00:22:32,830
ok so i think one of my issues might
have been my sample size is likely

271
00:22:32,830 --> 00:22:40,149
problematic just pretty small already
made this point again if you don't have

272
00:22:40,150 --> 00:22:43,780
a lot to look at your board which I
don't know a lot of security

273
00:22:43,780 --> 00:22:49,120
practitioners that don't have anything
going on then you know maybe sixty

274
00:22:49,120 --> 00:22:54,760
percent rates are good for you but I
don't think it would work for me again

275
00:22:54,760 --> 00:22:57,730
this is my own thought I think that
machine learning is probably better for

276
00:22:57,730 --> 00:23:01,690
variations of incremental ed similar
patterns the problem that i saw a lot

277
00:23:01,690 --> 00:23:06,310
with exploit kits is that from one
version to another there can actually be

278
00:23:06,310 --> 00:23:06,908
a significant

279
00:23:06,909 --> 00:23:10,389
and change in the uri or something that
I'm trying to Keanu on and that makes it

280
00:23:10,389 --> 00:23:17,830
really hard to detect I saw some white
papers out there i think university

281
00:23:17,830 --> 00:23:22,720
trono chicago where they claim to have
ninety-nine percent success in detecting

282
00:23:22,720 --> 00:23:32,499
decays option but what I think this had
to do with as much of anything was a

283
00:23:32,499 --> 00:23:35,710
they were looking at specific examples
where they had the source code of the

284
00:23:35,710 --> 00:23:39,999
malware and I think they were looking at
different stages of the exploit kits for

285
00:23:39,999 --> 00:23:43,629
instance i was very interested in
looking at the final stage where we have

286
00:23:43,629 --> 00:23:46,418
malicious payload being delivered
because i spent too much time in the

287
00:23:46,419 --> 00:23:51,999
console and I know that it's really
important to the narrow in on that

288
00:23:51,999 --> 00:23:54,639
ladder stage for the guys in the console
because if you start investigating

289
00:23:54,639 --> 00:23:59,859
everything at the front end of an
exploit kit possible you know I exploit

290
00:23:59,859 --> 00:24:07,389
being deliver it's a you'll spend all
day chasing this stuff down like i said

291
00:24:07,389 --> 00:24:11,168
exponential decay might be a
deal-breaker because you're putting a

292
00:24:11,169 --> 00:24:16,119
lot of effort in to kind of tweak things
down to probably where it needs to be

293
00:24:16,119 --> 00:24:22,299
and going back the evolution idea
evolution is very incremental often

294
00:24:22,299 --> 00:24:26,499
large variance between exploit kit
samples which i think is part of the

295
00:24:26,499 --> 00:24:32,889
reasons why it didn't work as well as I
would have hoped so had to replace

296
00:24:32,889 --> 00:24:35,889
through that at the end but don't have
any questions

297
00:24:39,399 --> 00:24:43,570
excellent are there any questions

298
00:24:44,080 --> 00:24:50,499
Patrick do you have a question that you
can close to the audience or valuable

299
00:24:50,499 --> 00:24:56,889
prize and today we're going to be going
person who answers the question is going

300
00:24:56,889 --> 00:25:01,839
to get a rubber ducky actually have two
questions and we'll get a rubber ducky

301
00:25:01,839 --> 00:25:06,940
and we'll have an iOS application book
so if you have two questions

302
00:25:08,139 --> 00:25:15,459
sure uh ok there are three kinds of a
machine learning that I talked about

303
00:25:15,460 --> 00:25:22,119
give me one of the three but in the
orange rigor ok

304
00:25:26,720 --> 00:25:30,200
he said you want one more

305
00:25:30,200 --> 00:25:39,860
ok let's see this is a good one it's a
sports bar by don't care who's the

306
00:25:39,860 --> 00:25:43,010
greatest quarterback in the NFL

307
00:25:43,010 --> 00:25:45,408
great thank you ok

