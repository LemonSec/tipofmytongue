1
00:00:00,000 --> 00:00:05,910
if you have in mind the rain on
sandwiches have sandwiches r1 r2 if you

2
00:00:05,910 --> 00:00:07,259
get a meal ticket

3
00:00:07,259 --> 00:00:12,360
we have lunches and everybody think
it'll take so if you feel like coming

4
00:00:12,360 --> 00:00:14,639
out here real quick and going to get one
to come back

5
00:00:14,639 --> 00:00:18,210
that's cool i would imagine the next
time get you a break

6
00:00:18,210 --> 00:00:25,410
we won't have much left to quick pieces
of a minute trivia ticket numbers of the

7
00:00:25,410 --> 00:00:30,750
half pipe kit are posted out here right
outside this door warden already did

8
00:00:30,750 --> 00:00:37,200
anyway 96 ipod 3096 ipod three old and
then for the sake which is a kickstarter

9
00:00:37,200 --> 00:00:44,760
project to make quad 3964 5396 or so you
can stop right here to give away table

10
00:00:44,760 --> 00:00:49,320
check your numbers pick up your stuff
frequently father to redraw love playing

11
00:00:49,320 --> 00:00:50,160
stuff

12
00:00:50,160 --> 00:01:00,120
alright so it's my this X seekers just
not one last night but one of the

13
00:01:00,120 --> 00:01:05,128
speaker's here kinda blew this one of
those guys that really want to eat early

14
00:01:05,129 --> 00:01:10,799
in your career I have done I had the
fortune of meeting and language was

15
00:01:10,799 --> 00:01:15,780
which was really good but I wish it was
10 years ago because he's a really

16
00:01:15,780 --> 00:01:22,770
agreements or in and really just a
fantastic leader in this business so I

17
00:01:22,770 --> 00:01:25,770
like to present you two brothers and
running

18
00:01:29,900 --> 00:01:44,360
okay we've got some great organizer Phil
and dog and everybody looks at least my

19
00:01:44,360 --> 00:01:55,520
second time and I think my third time .
35 40 front right now and so Phil had

20
00:01:55,520 --> 00:02:00,949
the displeasure working for years so so
don't hold that against it he's he's

21
00:02:00,950 --> 00:02:02,479
really is a good guy

22
00:02:02,479 --> 00:02:08,270
ah but every year this conference gets
better and better and is testament to

23
00:02:08,270 --> 00:02:14,330
the hard work and filled all lawrence
and all the other you know folks the

24
00:02:14,330 --> 00:02:17,780
range so so it so much it

25
00:02:17,780 --> 00:02:25,370
I'm two brothers winery and . we work at
the poster child for security issues

26
00:02:25,370 --> 00:02:28,940
guesses do well what organization that
might be

27
00:02:32,840 --> 00:02:36,800
come on you can spit it out good tired
of it

28
00:02:36,800 --> 00:02:45,470
exactly we are on our job is to make
sure 2013 doesn't happen to get but but

29
00:02:45,470 --> 00:02:48,950
one of the things that we've been
working on it's just lots and lots of

30
00:02:48,950 --> 00:02:54,560
ways to tackle stuff and one of the
things unless you've been living under a

31
00:02:54,560 --> 00:03:02,150
rock right as prior speaker highlighted
right the ransomware has just absolutely

32
00:03:02,150 --> 00:03:07,070
exploded and and what we're going to
talk about this talk is yet another

33
00:03:07,070 --> 00:03:12,200
option so the prior speaker has some
great you know there was some good solid

34
00:03:12,200 --> 00:03:15,500
waves to tackle dealing with rain
somewhere

35
00:03:15,500 --> 00:03:21,860
ah but most of that stuff today is
happening at the host player and I

36
00:03:21,860 --> 00:03:26,209
thought I'd been doing this a long long
long time right

37
00:03:26,209 --> 00:03:32,120
and I like ruining bad guys days so I i
I've done red no I

38
00:03:32,120 --> 00:03:37,790
been on the office but a blue I mean
defensive much more interesting it's

39
00:03:37,790 --> 00:03:43,730
much harder and ultimately much we're
doing in my opinion and and nothing is a

40
00:03:43,730 --> 00:03:49,670
defender makes my a like ruin a bad guys
and so what we're going to talk about

41
00:03:49,670 --> 00:03:54,980
this afternoon is just someone is this
is not a syllable as I hope everybody

42
00:03:54,980 --> 00:04:00,500
who realizes despite everything under
claim that will ever happen there never

43
00:04:00,500 --> 00:04:04,879
will be a bullet it's always going to be
people possible technology what we're

44
00:04:04,879 --> 00:04:09,709
trying to do is give you some concrete
additional methods for calculus and this

45
00:04:09,709 --> 00:04:15,950
is really incredible to ride Ryan was
responding to an incident on this and it

46
00:04:15,950 --> 00:04:21,168
came up with the core of this idea that
will be talking about so ransomware

47
00:04:21,168 --> 00:04:25,580
living let me just give you a little bit
of stats so we track a lot of power so

48
00:04:25,580 --> 00:04:32,060
what I did was I went out and I gallery
sable I'm old-school reverse engineer

49
00:04:32,060 --> 00:04:37,490
guy i like to take samples and look at
and see what they're doing right and

50
00:04:37,490 --> 00:04:46,940
analyzing so this is at the end of
august over here on be your left hand

51
00:04:46,940 --> 00:04:54,770
side right those are the different hash
versions of those different pieces of

52
00:04:54,770 --> 00:04:55,700
rain somewhere

53
00:04:55,700 --> 00:05:04,460
those are just hop a on the right here
are kind of you see word cyber crime to

54
00:05:04,460 --> 00:05:06,409
get stuff

55
00:05:06,410 --> 00:05:13,250
notice that Lackey although has had more
iteration so far this year then

56
00:05:13,250 --> 00:05:17,930
everything on the cybercrime combined
right

57
00:05:17,930 --> 00:05:23,599
literally that's the root of this
problem and and ask private speaker i

58
00:05:23,599 --> 00:05:26,000
mentioned i completely agree

59
00:05:26,000 --> 00:05:29,060
I don't think this is going to get
battle before it gets worse right

60
00:05:29,060 --> 00:05:34,370
the cryptocurrency thing in particular
has really been and I and it's not that

61
00:05:34,370 --> 00:05:40,280
we can't figure out they are with crypto
currencies but amazing law lecture your

62
00:05:40,280 --> 00:05:45,950
bureaus really good at chasing money
through you know standard you know wire

63
00:05:45,950 --> 00:05:51,050
transfer and banking systems are not so
good yet at unfortunately tracing it

64
00:05:51,050 --> 00:05:56,450
through lock change can be done and then
actually plays a little bit into our

65
00:05:56,450 --> 00:05:57,590
talk here

66
00:05:57,590 --> 00:06:04,250
oh so let's talk first then about how
most of these families work and the way

67
00:06:04,250 --> 00:06:11,630
the cycle happens is the initial
installation right so whatever that that

68
00:06:11,630 --> 00:06:17,900
vehicle that the malicious software
comes in through ah he gets installed

69
00:06:17,900 --> 00:06:28,280
right loader etc pony i'm eating a lot
of these are being raised more installs

70
00:06:28,280 --> 00:06:34,640
and then most of the current rates and
where processing phase is it reaches out

71
00:06:34,640 --> 00:06:41,270
c2k when it reaches out to the sea to
once it gets that connection the c2

72
00:06:41,270 --> 00:06:46,700
server basically gives the unique ID
okay in generates and parodies of

73
00:06:46,700 --> 00:06:49,219
public/private key pair most of the rain

74
00:06:49,220 --> 00:06:54,890
we're at this point is using really
solid purple right aes or a strong in

75
00:06:54,890 --> 00:07:03,620
total and the public key gets passed
down to the to the software it then uses

76
00:07:03,620 --> 00:07:07,010
that public key to encrypt all the
violence right

77
00:07:07,010 --> 00:07:14,090
oh then it pops up its notice it says
hey you been affected you know and of

78
00:07:14,090 --> 00:07:18,799
course there's lots and lots of
variation most of them have timers the

79
00:07:18,800 --> 00:07:24,320
one we're going to look at a little more
closely one of its variants pops up or

80
00:07:24,320 --> 00:07:30,289
no images rains i just they they have
all sorts of tactics to try and they're

81
00:07:30,289 --> 00:07:36,979
trying to shock you into paying
absolutely right things like you

82
00:07:36,979 --> 00:07:40,070
absolutely anything they could do and
they're going to continue

83
00:07:41,120 --> 00:07:47,419
where they are trying to shock you into
ready because what do we do is people we

84
00:07:47,419 --> 00:07:52,219
make poor choices when we panic right
and so they're trying to get you to

85
00:07:52,220 --> 00:07:59,300
panic over out I screwed okay right ah
and you know the escalating payment

86
00:07:59,300 --> 00:08:02,300
amounts all of that is eight that you
pay

87
00:08:03,080 --> 00:08:10,400
oh and then if you pay so locking for
instance you submit that payment the

88
00:08:10,400 --> 00:08:15,919
authors right there behind that they
then have to go look off right when you

89
00:08:15,919 --> 00:08:21,979
submit your payment you have to supply
that ID is your unique ID that lets them

90
00:08:21,979 --> 00:08:28,460
know which private key is used to
encrypt your files and most incredible

91
00:08:28,460 --> 00:08:34,338
so they have to load that into download
tool and then make that available to you

92
00:08:34,339 --> 00:08:44,480
to download and then you can down arad
use that right so a good opportunity to

93
00:08:44,480 --> 00:08:49,400
that I don't see many organizations
doing here is what we're talking about

94
00:08:49,400 --> 00:08:54,829
in this talk is how do we disrupt this
more than network layer is if you can

95
00:08:54,830 --> 00:09:00,860
subvert that communications between the
installation of the c2 than the

96
00:09:00,860 --> 00:09:07,070
encryption of our house so if you need a
sinkhole if you use any of those

97
00:09:07,070 --> 00:09:11,209
techniques which I get right a lot of
these guys jumping pretty quick so

98
00:09:11,209 --> 00:09:15,469
you're going to have to be
johnny-on-the-spot keep up with that but

99
00:09:15,470 --> 00:09:21,800
subverting that see two columns is a way
to completely stop that cold and also

100
00:09:21,800 --> 00:09:26,390
know that just had somebody trying it
get so far

101
00:09:26,959 --> 00:09:33,589
ok so that we had a situation and and
Ryan's going to talk about it more

102
00:09:33,589 --> 00:09:39,560
detail are unfortunately you know we've
been tracking this very very heavily I'm

103
00:09:39,560 --> 00:09:42,369
very fortunate i was able to go out gets
you

104
00:09:42,370 --> 00:09:48,100
really really super talented folks and
they make my life easy and they do a

105
00:09:48,100 --> 00:09:53,440
really good job statement top of this
and helping us get that but prevention

106
00:09:53,440 --> 00:09:59,710
is never one percent right and so the
particular family that we're going to

107
00:09:59,710 --> 00:10:05,290
talk about today is defended from a very
old kicks off and get rights going to do

108
00:10:05,290 --> 00:10:11,680
a lot of detail your second but jigsaw
is what I would call a more typical

109
00:10:11,680 --> 00:10:16,839
evolution and I I'm hoping that this is
a up around that a lot of the bad guys

110
00:10:16,839 --> 00:10:23,770
take because the good thing about bad
guys is they tend to be lazy right and

111
00:10:23,770 --> 00:10:31,510
in the standard model here they have to
go get the key out and put it in a tool

112
00:10:31,510 --> 00:10:36,160
and put that to love you for you to
download that you can grow your stuff

113
00:10:36,160 --> 00:10:43,270
right that's happened you know you have
a script that's still out right so on

114
00:10:43,270 --> 00:10:46,120
the other hand the jigsaw family

115
00:10:46,120 --> 00:10:52,480
the authors do what I would say is more
typical of bad guys and that they

116
00:10:52,480 --> 00:11:00,970
realize wait in that white model with
all that we can just have the the matter

117
00:11:00,970 --> 00:11:07,270
itself raises where check the blockchain
make a query against the wallet and

118
00:11:07,270 --> 00:11:09,819
terminal patients with me any grip

119
00:11:09,820 --> 00:11:17,440
ok and therein lies the weakness of us
play right eye and writing talk about

120
00:11:17,440 --> 00:11:22,870
that literally the way to Salt Works is
a dozen installation he generates a

121
00:11:22,870 --> 00:11:28,000
random of watching wall lighting which
those are readily accessible that's just

122
00:11:28,000 --> 00:11:34,060
simply like all to get a fresh block
chain wallet ID so generates a wallet

123
00:11:34,060 --> 00:11:41,170
and then it instead just generates its
okies and pulls the blockchain once it

124
00:11:41,170 --> 00:11:48,520
sees value in the wallet item if they
goes ahead and sell press ok and that

125
00:11:48,520 --> 00:11:53,829
consoles like this right so last query
there's several ways

126
00:11:54,370 --> 00:12:02,950
I not only with with aa cryptocurrency
so Bitcoin there's one was called master

127
00:12:02,950 --> 00:12:10,540
blockchain ok so the point of the
cryptocurrencies is a non emanate but

128
00:12:10,540 --> 00:12:16,089
it's not to prevent people for being a
little see transactions part of the

129
00:12:16,089 --> 00:12:20,320
transparency around the particular
currency is transparency matter of fact

130
00:12:20,320 --> 00:12:26,079
there is talking on during this lot but
I was looking forward to seeing you two

131
00:12:26,079 --> 00:12:27,670
talking about

132
00:12:27,670 --> 00:12:35,170
ah analyzing the transactions and watch
right you can go out and look at the

133
00:12:35,170 --> 00:12:40,510
block chain which by the way will be
tracking how successful a lot of rain

134
00:12:40,510 --> 00:12:46,060
somewhere actors are because they put
their wallet IDs in the ransom water

135
00:12:46,060 --> 00:12:50,560
stuff all you're going to do is query
the blockchain for transactions to those

136
00:12:50,560 --> 00:12:55,359
qualities know exactly how much money
they're thinking oh and then you can see

137
00:12:55,360 --> 00:13:00,790
the transactions going from that wallet
to another Waller to another wallet till

138
00:13:00,790 --> 00:13:06,310
they consolidate so are lots of
interesting ways for figuring out who

139
00:13:06,310 --> 00:13:11,469
are the actors kind of coalescing
because interestingly enough a lot of

140
00:13:11,470 --> 00:13:16,060
the different families of rates and
where the when you follow the money

141
00:13:16,060 --> 00:13:24,459
through the blockchain transactions all
end up in the same place that's our and

142
00:13:24,459 --> 00:13:32,739
not our focus for today so Mason's query
right so at this point i think i'll let

143
00:13:32,740 --> 00:13:38,920
our Ryan picked up the the story with
what happened and and do so

144
00:13:39,459 --> 00:13:44,800
explaining on allocating the lifestyle
and takes him so what happened is we had

145
00:13:44,800 --> 00:13:49,359
a team member receiving spiritually
email that was very well-crafted and

146
00:13:49,360 --> 00:13:54,610
they click the link in an email and
eventually this downloading out of the

147
00:13:54,610 --> 00:13:58,690
machine execute so this is a very big
shots

148
00:13:58,690 --> 00:14:15,250
you can't hit man and woman about it is
me jumping i should mention Ryan's one

149
00:14:15,250 --> 00:14:21,910
of our triage and less energy user
reversing course is our problem and so a

150
00:14:21,910 --> 00:14:25,630
little background i worked in the state
of Minnesota you nighty for a couple of

151
00:14:25,630 --> 00:14:30,189
years and I've been at target for about
a year-and-a-half recent surgery

152
00:14:30,190 --> 00:14:35,860
balances so what caught my interest in
this was that we had a single host get

153
00:14:35,860 --> 00:14:40,990
infected and we were able to
successfully decrypt hope everyone would

154
00:14:40,990 --> 00:14:44,980
I don't actually I'm just gonna actually
so if it isn't ammo

155
00:14:46,390 --> 00:15:04,960
yeah almost there you go back to
studying it so i'm going to actually

156
00:15:04,960 --> 00:15:09,970
execute this wine talk a little bit just
because you see that it prints out and

157
00:15:09,970 --> 00:15:19,690
you can infect you advancing so you have
to keep this on machine we're going to

158
00:15:19,690 --> 00:15:21,340
this pop so that's it

159
00:15:21,340 --> 00:15:26,380
image can be displayed using click OK
now in the background it's going to your

160
00:15:26,380 --> 00:15:35,860
trap your files so you have a particular
version that we had you off put up a

161
00:15:35,860 --> 00:15:44,200
graphic and obviously hello embarrassing
potential yep it's an office i think the

162
00:15:44,200 --> 00:15:51,040
team member was actually conference so
when I did for this presentation is i

163
00:15:51,040 --> 00:15:54,849
just created out that image so you're
not going to see a whole lot you'll see

164
00:15:54,850 --> 00:16:00,610
the text scrolling across but you get
the gist of what happens we really try

165
00:16:00,610 --> 00:16:08,020
to everybody show inappropriate images
so this is written . net and it is

166
00:16:08,020 --> 00:16:11,990
slightly office stated basically all
function names you can really make sense

167
00:16:11,990 --> 00:16:20,270
kind of triggers . most of the functions
you can see so what I started doing Oh

168
00:16:20,270 --> 00:16:24,439
what bothers you is that ok so we had a
single host get infected and so I

169
00:16:24,440 --> 00:16:28,580
started thinking what if this would
happen in larger scale how how we

170
00:16:28,580 --> 00:16:32,959
respond as quickly because it didn't
take us some time with the blast

171
00:16:32,959 --> 00:16:37,819
occurred in imaging machine have too
many new she's possible

172
00:16:37,820 --> 00:16:41,510
yeah so we should enter tricare right
important thing to understand there's

173
00:16:41,510 --> 00:16:48,380
predators been really good because this
tool arm you know keeps the project you

174
00:16:48,380 --> 00:16:54,020
know the secret key essentially Modelo's
there's tools to go up strap the

175
00:16:54,020 --> 00:16:58,130
challenge with those that approach
writing is that you have to do a new

176
00:16:58,130 --> 00:17:03,830
version for every iteration so every
time the bad guys interracial version

177
00:17:03,830 --> 00:17:08,300
we've got to go out building corrector
right figure out ok where they storing

178
00:17:08,300 --> 00:17:13,550
the key specifically in this version
totally be preferable right be perfect

179
00:17:13,550 --> 00:17:19,369
it but to brian's point is how do we do
this bigger scale right how do we do

180
00:17:19,369 --> 00:17:25,159
this so save some people got this at
once we can encrypt a cross the entire

181
00:17:25,160 --> 00:17:31,340
day in those rather than on the Bible
basis if you build and so are there any

182
00:17:31,340 --> 00:17:35,928
so this particular piece of ransomware
this there's a lot of so when I look for

183
00:17:35,929 --> 00:17:39,770
when i'm doing analysis special and this
was like how can i exploit this piece of

184
00:17:39,770 --> 00:17:43,610
financing initiative what caught my
attention is that there is no call out

185
00:17:43,610 --> 00:17:47,689
and so when I analyze this I'll check
the network traffic see what's going on

186
00:17:47,690 --> 00:17:51,230
I didn't see you need the only option
you'll see you soon as you get a pop-up

187
00:17:51,230 --> 00:17:55,460
saying i submitted my payment so I'm
gonna go get home and see what happens

188
00:17:55,460 --> 00:18:00,410
you click that you're going to travel
that peak at capturing that yes L was

189
00:18:00,410 --> 00:18:05,300
that traffic and so what I realized this
text doesn't look like it's doing so

190
00:18:05,300 --> 00:18:11,059
friction for communication to that site
it's all this might be pretty

191
00:18:11,059 --> 00:18:15,050
straightforward as far as decrypting it
so i had to dig in to the data sembly

192
00:18:15,050 --> 00:18:18,809
figure out exactly how was working and
some things on the orders for that

193
00:18:18,809 --> 00:18:24,899
you know so after necklace counts down
in Tennessee is in an hour's time to pay

194
00:18:24,899 --> 00:18:30,689
if you don't it says delete files I
didn't confirm that it will the other

195
00:18:30,690 --> 00:18:35,309
thing to consider when you get hit with
ransomware is we know what do you do in

196
00:18:35,309 --> 00:18:36,539
that situation

197
00:18:36,539 --> 00:18:41,999
oh so this one in particular if you
restart the machine was a check that

198
00:18:41,999 --> 00:18:46,529
will check to see if you did wrong which
is a file on the system that gets

199
00:18:46,529 --> 00:18:50,639
dropped that little is just going to
check into that file check as you this

200
00:18:50,639 --> 00:18:54,959
value and then it goes on a rant so if
it detects that restart this computer is

201
00:18:54,960 --> 00:19:00,119
going to leave ten thousand files are
thousands thousands every time you reach

202
00:19:00,119 --> 00:19:08,070
there and it encrypts up to 10 million
bytes 10-10 made five so does have some

203
00:19:08,070 --> 00:19:08,999
limitations

204
00:19:08,999 --> 00:19:13,379
it's basically going through looking for
common files or docs excel backs it will

205
00:19:13,379 --> 00:19:21,779
encrypt m-files can actually switch

206
00:19:31,350 --> 00:19:41,100
so just to show you after encrypted so
the extension that it adds is no ransom

207
00:19:41,100 --> 00:19:47,668
so i'll just do a start-up one on this
you drive and see what comes up you'll

208
00:19:47,669 --> 00:19:55,740
see we're at 10,000 sorry that's the
other thing so when this team I got this

209
00:19:56,250 --> 00:20:00,120
it's not very crafty in the sense that
it like actually lock screen you could

210
00:20:00,120 --> 00:20:04,799
drink this and move it out of the way
but almost gray was basically adult

211
00:20:04,799 --> 00:20:11,789
content so you can just move down but
the thing is they want you for your

212
00:20:11,789 --> 00:20:18,000
panic such pay so here's all the
encrypted file room got 2580 it depends

213
00:20:18,000 --> 00:20:23,940
that or no ransom and so what I want to
start doing interviews like okay well

214
00:20:23,940 --> 00:20:29,070
how how did Chris well luckily for us
the address is decided to put the

215
00:20:29,070 --> 00:20:34,379
decryption key in the ransomware so all
the algorithms are all the functions

216
00:20:34,380 --> 00:20:37,830
were built into the trip I just have to
figure out hopping i'm going to get this

217
00:20:37,830 --> 00:20:45,449
to to do what I want to basically so
what what i wrote up was a little python

218
00:20:45,450 --> 00:21:03,240
script and i'm using the mini web server
it's just I wanted something really

219
00:21:03,240 --> 00:21:13,980
quick on the host that maximize the
screen rather hard and so I wanted

220
00:21:13,980 --> 00:21:18,270
something just pretty easy just testing
to start out with you at some point have

221
00:21:18,270 --> 00:21:21,780
to build something more robust some sort
of framework he'll give us more

222
00:21:21,780 --> 00:21:26,129
capability and basically what it does is
i added the hosts file to redirect

223
00:21:26,130 --> 00:21:31,740
traffic you can implement this other
ways to redirect traffic to the domain

224
00:21:31,740 --> 00:21:37,200
this and solitude which is the BTC that
locker that i owe back to the holes and

225
00:21:37,200 --> 00:21:42,790
then I created a web structure for that
so that we get asked

226
00:21:42,790 --> 00:21:52,120
across the file basically grab those
files and that Jason so so the that walk

227
00:21:52,120 --> 00:22:01,540
I uh was just one of the many publicly
available . block chain wallet right and

228
00:22:01,540 --> 00:22:08,110
so we realized with this approach is is
much more broad so over the last several

229
00:22:08,110 --> 00:22:13,540
weeks we've been testing is I have yet
to find a version of any of the there's

230
00:22:13,540 --> 00:22:18,730
several where it's already of the jigsaw
family headband or no cetera

231
00:22:19,330 --> 00:22:26,889
ah and this works for all are and what
happens is you can just say right

232
00:22:26,890 --> 00:22:29,140
redirected this case first

233
00:22:29,140 --> 00:22:34,960
this is the prototype version will have
to that's up here probably posted later

234
00:22:34,960 --> 00:22:39,040
this week which is a little more
accessible so you can run it on any

235
00:22:39,040 --> 00:22:46,240
platform so easily be directing you know
just to NS sinkhole at enterprise layer

236
00:22:46,240 --> 00:22:53,530
right to the side so just returns the
expected values for the AP is just the

237
00:22:53,530 --> 00:22:58,600
whole post and optional

238
00:22:58,600 --> 00:23:06,969
ok so it's pretty simple so the host is
infected right now right files encrypted

239
00:23:06,970 --> 00:23:20,650
so what I'll do is I'm just an
accidental py and it takes two

240
00:23:20,650 --> 00:23:37,000
parameters so x discipline the jsr is
just a unit or parameter passed just

241
00:23:37,000 --> 00:23:42,580
specify exactly i had a few others in
this program for so it will take the two

242
00:23:42,580 --> 00:23:45,580
parameters which

243
00:23:47,800 --> 00:23:53,230
it's wallet i need you saw the wall and
the amount so for this one they're

244
00:23:53,230 --> 00:23:55,750
asking for a hundred fifty dollars and
get going

245
00:23:55,750 --> 00:24:00,460
checking what this will do is it will go
to the actual value that day and then

246
00:24:00,460 --> 00:24:05,560
it's going to multiply whatever you put
in to keep that suit yet obviously

247
00:24:05,560 --> 00:24:18,100
involving culture is some change so
paste that in and then it's 0.4 will

248
00:24:18,100 --> 00:24:25,629
give us know and so then we'll execute
this so now it's listening from line for

249
00:24:25,630 --> 00:24:30,010
the request and so what we can do here
is all traitors to you can see the list

250
00:24:30,010 --> 00:24:33,850
of encrypted files was right there

251
00:24:34,510 --> 00:24:39,430
essentially the same ones that I search
for such a scare tactic red shirt is

252
00:24:39,430 --> 00:24:47,410
only got limited gene so will your house
will click this is going to go out and

253
00:24:47,410 --> 00:24:50,860
see their requests come in and it's
basically just going to grab them to the

254
00:24:50,860 --> 00:24:55,479
fields that I changed off its tricky in
the sense column and the middle attack

255
00:24:55,480 --> 00:25:01,450
it's going to grab the the the Bitcoin
value for that day that i gave it and

256
00:25:01,450 --> 00:25:06,550
then it's going to put in 0 for x and so
it ends up being over a hundred fifty

257
00:25:06,550 --> 00:25:11,290
dollars which the check in there you
know passes and so then it will call the

258
00:25:11,290 --> 00:25:15,639
encryption function which passes in the
built-in key and inserts running during

259
00:25:15,640 --> 00:25:17,050
the cooking files

260
00:25:17,050 --> 00:25:21,220
the other thing I noticed there with
this so right you you're always looking

261
00:25:21,220 --> 00:25:26,710
for mess-ups that your adversary makes
Saudi troops all the files but in the

262
00:25:26,710 --> 00:25:31,330
process and doesn't completely remove
the extension from so you're under you

263
00:25:31,330 --> 00:25:36,310
end up having that horrible ra so what
happened was the implement

264
00:25:36,310 --> 00:25:40,149
implementation prior when they removed
the extension and you said okay let's

265
00:25:40,150 --> 00:25:45,760
subtract three from it get rid of it or
they hasten to subtract four on this and

266
00:25:45,760 --> 00:25:50,530
so we didn't you stole you have one
final thing printed but you can't access

267
00:25:50,530 --> 00:25:57,320
them right so this bar right surprised
the bad guys stole code somebody else or

268
00:25:57,320 --> 00:26:02,330
maybe why it was like they stole it they
didn't understand it fully right what is

269
00:26:02,330 --> 00:26:08,809
descended from put on a three-character
extension so . what that phone right

270
00:26:08,809 --> 00:26:16,279
here you got that right and so they
didn't understand that code enough to

271
00:26:16,279 --> 00:26:21,590
remove it wanted so it just takes off
the last four pair the entire . owner

272
00:26:21,590 --> 00:26:28,399
and levels that is being surprised at
all that guy's which is the benefit for

273
00:26:28,399 --> 00:26:31,399
me because it makes my job easy have to
face

274
00:26:33,409 --> 00:26:42,679
alright so I'll just really wanted the
surgery quick so you still need to do a

275
00:26:42,679 --> 00:26:47,899
little bit of cleanup the files are not
encrypted but because of log in the code

276
00:26:47,899 --> 00:26:52,399
we're going to have to take off the rest
of that extension that's pretty easy to

277
00:26:52,399 --> 00:27:00,350
master that right so here's all files
that have been decrypted right but they

278
00:27:00,350 --> 00:27:05,449
still got the portable re extension so
again I just when I did I whipped up

279
00:27:05,450 --> 00:27:10,129
something quick to move that part so
that your files back

280
00:27:10,129 --> 00:27:17,178
the problem is that when it goes to
rename I don't know pls is generated you

281
00:27:17,179 --> 00:27:22,220
like 10 pounds the sum of the files have
been issues because it's all there so i

282
00:27:22,220 --> 00:27:27,110
just have it right out to a following
just to see which ones do action gave me

283
00:27:27,110 --> 00:27:35,689
so talk about to the deck if you would
make sense so and and as we've been

284
00:27:35,690 --> 00:27:40,700
continuing to dig it brings a part of
really what what you're hoping to pop

285
00:27:40,700 --> 00:27:47,600
this app is is to get everybody thinking
about additional attack independent

286
00:27:47,600 --> 00:27:54,799
factors on a lot of ransomware because
as machines exploded right arm is just

287
00:27:54,799 --> 00:27:58,009
continuing to go in all sorts of
directions

288
00:27:58,669 --> 00:28:04,639
we're gonna need tools like this kind of
mass built on you know the the prior

289
00:28:04,639 --> 00:28:07,629
speaker available a great example

290
00:28:07,630 --> 00:28:13,360
healthcare right where hundreds of
thousands of systems are affected and

291
00:28:13,360 --> 00:28:23,770
the longer order now the worse in terms
of impact 22 are totally legitimate

292
00:28:23,770 --> 00:28:26,770
photos fire

293
00:28:35,800 --> 00:28:54,879
alright so what we're putting up is
there we go

294
00:28:55,690 --> 00:29:00,460
ah so we create a little tool we've done
some confusion i will have enough and

295
00:29:00,460 --> 00:29:08,290
get up here shortly where again making a
little lot cleaner several and like this

296
00:29:08,290 --> 00:29:14,980
we said content here i was using mainly
work so far with the jigsaw family which

297
00:29:14,980 --> 00:29:21,910
is a bunch to be clear certainly not ask
for blocking some of the others arm but

298
00:29:21,910 --> 00:29:27,790
in the table we use it just used a
simple little dns entry in the local dns

299
00:29:27,790 --> 00:29:36,070
right windows to edit CDNs file redirect
the URL is going to loop back around

300
00:29:36,070 --> 00:29:42,490
this way back to intercept my call is it
what it expects absolutely it's often

301
00:29:42,490 --> 00:29:49,420
corrupt and what that ends up being that
is a much better way got more than one

302
00:29:49,420 --> 00:29:56,830
you saw how that actually be printed it
when we had this on natural hose on the

303
00:29:56,830 --> 00:30:03,159
encryption talk about happening i think
with the tool and it was there are four

304
00:30:03,160 --> 00:30:04,900
five six hours

305
00:30:04,900 --> 00:30:08,800
one of the issues might struggle with
any environment is getting access to

306
00:30:08,800 --> 00:30:12,790
that hosts and also ensuring that you
infect other host while you're trying to

307
00:30:12,790 --> 00:30:17,920
do so right yeah beauty of this rains
then you don't have to go to track down

308
00:30:17,920 --> 00:30:18,520
these

309
00:30:18,520 --> 00:30:24,879
descending predator this specific
version of jigsaw plus in this case our

310
00:30:24,880 --> 00:30:30,400
actual ah team member happen to be
remote right she was on a conference of

311
00:30:30,400 --> 00:30:37,570
going to happen so with this sort of
mechanism we can do redirect VPN right

312
00:30:37,570 --> 00:30:41,919
however go ahead and click the link
yellow by pinning and it will decrypt we

313
00:30:41,920 --> 00:30:45,310
should go down a little script and take
care of the rest of the cleanup and

314
00:30:45,310 --> 00:30:50,649
again that the results that much more
much more completely

315
00:30:50,650 --> 00:30:55,600
yeah question oscar fish

316
00:30:55,600 --> 00:31:00,639
yeah was their fish she's checking her
email and conference it was a pretty

317
00:31:00,640 --> 00:31:04,420
decent spearfish i would say the
Spearfish was actually higher quality

318
00:31:04,420 --> 00:31:13,360
than the ransomware maybe I'm party but
it is but they're certainly distributed

319
00:31:13,360 --> 00:31:16,360
lots of ways on this would happen

320
00:31:18,760 --> 00:31:25,960
come on lots of ways oh and then we did
the demo so longer turn again like I

321
00:31:25,960 --> 00:31:31,390
said we're gonna get it posted and it's
already in Python you know so have added

322
00:31:31,390 --> 00:31:36,040
extended oh we're going to continue to
work out you know I've been looking

323
00:31:36,040 --> 00:31:40,120
through much of the other families
receive this is more applicable all we

324
00:31:40,120 --> 00:31:45,850
can do to you again just make this a
more robust tool but again the real

325
00:31:45,850 --> 00:31:51,939
thing I I stresses taking away that kind
of approach that a lot of this malware

326
00:31:51,940 --> 00:31:59,500
can be attacked in ways where you use
our cell and and in many cases I think

327
00:31:59,500 --> 00:32:04,570
that's going to be a much more practical
approach so the next time dealing with

328
00:32:04,570 --> 00:32:08,860
one of these think about that as an
option right look at those columns is

329
00:32:08,860 --> 00:32:14,830
there a way that we can trick it to you
know as long as bad guys open retained

330
00:32:14,830 --> 00:32:19,840
private keys that are our best bet is
sinkhole is not let it communicate the

331
00:32:19,840 --> 00:32:25,929
sea to the first place that will shut
that hole for the ransomware are but

332
00:32:25,930 --> 00:32:28,990
that's a bit of you know chasing the
chasing

333
00:32:29,810 --> 00:32:35,419
see to select the opposite problematic
questions thoughts sir

334
00:32:36,050 --> 00:32:41,750
so this particular sorry

335
00:32:41,750 --> 00:32:44,750
correct

336
00:32:49,820 --> 00:32:55,730
so the great question they're absolutely
are so a lot of the a lot of the

337
00:32:55,730 --> 00:33:04,190
takedown or think doubts on the right
word a lot of the free decrypt stuff

338
00:33:04,190 --> 00:33:09,110
that's been released has been released
because what's been happening is a lot

339
00:33:09,110 --> 00:33:13,939
of our 80 players are microsoft also has
really been working hard at this are

340
00:33:13,940 --> 00:33:17,900
working with law enforcement they'll get
proof so that they can get a universal

341
00:33:17,900 --> 00:33:22,670
law enforcement can get you aren't and
take the server so they can collect the

342
00:33:22,670 --> 00:33:26,720
keys off of that but of course that's
just induce the actors that are doing

343
00:33:26,720 --> 00:33:30,740
this to you know move their hosting the
not extradition countries where you know

344
00:33:30,740 --> 00:33:34,760
we don't have law enforcement access ER
cooperating law enforcement axis i

345
00:33:34,760 --> 00:33:38,000
Guess's so they're absolutely are armed

346
00:33:39,080 --> 00:33:44,419
I haven't yet from the variant that
stores the private keys in a way that's

347
00:33:44,420 --> 00:33:49,010
publicly accessible the other thing I
have been searching for is you know

348
00:33:49,010 --> 00:33:54,890
fortunately a lot of bad guys have very
poor upset and solo commonly store the

349
00:33:54,890 --> 00:34:00,440
keys and that I think personally I think
there's a gray area where you know

350
00:34:00,440 --> 00:34:07,190
hacking is defined by the Computer Fraud
and Abuse Act is very broad right i feel

351
00:34:07,190 --> 00:34:11,120
like the letter of the early intact
rather the Computer Fraud and Abuse Act

352
00:34:11,120 --> 00:34:15,620
is if I have to authenticate with
credentials that are my credentials that

353
00:34:15,620 --> 00:34:20,719
feels like that should be where that
line is the good news is certainly in a

354
00:34:20,719 --> 00:34:26,089
lot of the cybercrime stuff they don't
put any authentication and stuff because

355
00:34:26,090 --> 00:34:30,500
they know that tends to bring any
through corporate proxies and stuff like

356
00:34:30,500 --> 00:34:31,760
that right

357
00:34:31,760 --> 00:34:37,360
ah unfortunately so far most of the
major variants of ransomware are you

358
00:34:37,360 --> 00:34:42,550
authenticated servers are but that's
another option that I I suspect we'll

359
00:34:42,550 --> 00:34:48,100
see it some point with some of the
families this continues is them just

360
00:34:48,100 --> 00:34:53,230
leaving it on if you were in the
rap/rock next door at twelve-thirty

361
00:34:53,230 --> 00:34:57,850
ready to talk about it seemed to server
you should stop in that stuff my sequel

362
00:34:57,850 --> 00:35:02,200
and there wasn't a lot of authentication
of that there's potentially ways to

363
00:35:02,200 --> 00:35:08,710
access that is authenticated personally
I would I feel like that keep me within

364
00:35:08,710 --> 00:35:14,710
the spirit of legality between my
priority is getting very better wrap

365
00:35:14,710 --> 00:35:19,900
also probably part of the approach other
questions thoughts sir

366
00:35:21,100 --> 00:35:29,589
no no no we got no reverse the whole
thing and you know

367
00:35:29,590 --> 00:35:37,360
yeah . that particular course you know I
as the speed next door correctly pointed

368
00:35:37,360 --> 00:35:45,490
out writing things sharp and dotnet and
makes it very very easy reverse so so we

369
00:35:45,490 --> 00:35:51,069
did no ransom was paid with the Intel
team quickly follows the actual decrypt

370
00:35:51,070 --> 00:35:56,860
tool for the variance so don't even pay
the ransom and we would now

371
00:35:57,400 --> 00:36:06,280
awesome so it was an individual
corporate laptop Cyrus sir

372
00:36:06,280 --> 00:36:17,380
administration initially it was
Aerosmith knew what if you just read X

373
00:36:17,380 --> 00:36:24,040
goes yeah that's just a pop-up just get
action going in that case off

374
00:36:24,040 --> 00:36:30,700
yeah but it's that's an indicator and
we're not i'm not i was unclear you know

375
00:36:30,700 --> 00:36:35,680
when i saw that was doing some of the
right is reversing on as well right

376
00:36:35,680 --> 00:36:42,190
I'm still not clear why the author pops
that up i suspect that again yet another

377
00:36:42,190 --> 00:36:48,550
kind of probably a remainder from you
know in heritage go

378
00:36:49,339 --> 00:36:54,710
another area that just was not removed
but either way is going to do that here

379
00:36:54,710 --> 00:37:07,609
is execute other questions sir I must
speak to that

380
00:37:07,609 --> 00:37:13,880
so the question take the sheet out

381
00:37:13,880 --> 00:37:18,140
oh so what did it for me was that first
of all they had all the encryption

382
00:37:18,140 --> 00:37:22,910
algorithms and there's even if i didn't
have the chi-you still solve the

383
00:37:22,910 --> 00:37:27,259
algorithms and normally when we have
seen that right cheese with it so

384
00:37:27,259 --> 00:37:32,239
seeeeemji seen the algorithms right
that's probably how people made the tool

385
00:37:32,239 --> 00:37:35,749
is the turkey out and then copied
elsewhere them and just made a

386
00:37:35,749 --> 00:37:41,660
standalone program you can also improve
interrupt the traffic don't have it

387
00:37:41,660 --> 00:37:46,759
going just the HD site that was probably
what the encrypting the traffic isn't an

388
00:37:46,759 --> 00:37:51,529
option in this case right now because
because they're making an on / API call

389
00:37:51,529 --> 00:37:58,549
to probably library they really can't
they could run it as a salad instead of

390
00:37:58,549 --> 00:38:08,479
playing cars that sites are as crazy as
well armed what you because we've got a

391
00:38:08,479 --> 00:38:15,950
query reason i think on this is become a
newer popularly right is just so much

392
00:38:15,950 --> 00:38:21,649
less work bad right with locking in
those they've got to maintain the key

393
00:38:21,650 --> 00:38:26,269
servers and all that kind of
administrative work the beauty of this

394
00:38:26,269 --> 00:38:32,058
is there literally just payment out
right and sit back and you know whole

395
00:38:32,059 --> 00:38:39,049
from wallets right even if the instance
of payment ends up being lower than

396
00:38:39,049 --> 00:38:46,579
allah ki they're still because the game
to work ratio is so much higher they

397
00:38:46,579 --> 00:38:50,660
just spamming out at that point they
don't care it's going to get some people

398
00:38:50,660 --> 00:38:56,299
and some people are going to pay on I
certainly so i did a bunch of queries

399
00:38:56,299 --> 00:38:57,430
against the

400
00:38:57,430 --> 00:39:01,629
walleye part of the interesting thing is
I haven't figured out what this

401
00:39:01,630 --> 00:39:07,630
specifically is how they are knowing
which Wallabies are being chosen right

402
00:39:07,630 --> 00:39:12,250
so that they can use those wallets to
collect the funds i haven't figured that

403
00:39:12,250 --> 00:39:15,490
composing out get this particular area

404
00:39:15,490 --> 00:39:21,700
uh-huh but oh I suspect one side do you
figure out that you probably first

405
00:39:21,700 --> 00:39:25,720
payments you know if you get the phones
faster

406
00:39:26,859 --> 00:39:56,828
sweet so interesting interesting new
angles guess you probably know that was

407
00:39:56,829 --> 00:40:03,220
in fashion because I suspect so sort of
new patient wall that i have we have

408
00:40:03,220 --> 00:40:10,750
figured out so I suspect they knew there
was an infection but if somebody was not

409
00:40:10,750 --> 00:40:15,940
right and they were not right

410
00:40:17,380 --> 00:40:23,890
no no no they got no way of knowing that
we submitted their system plus they

411
00:40:23,890 --> 00:40:31,900
watch the top of you too but that's fine
i don't mind up but that's right yeah

412
00:40:31,900 --> 00:40:40,720
right yeah right yeah there were there
were some other fun stuff in the co2

413
00:40:40,720 --> 00:40:45,790
it's the downside of using someone
else's code to do go through and

414
00:40:45,790 --> 00:40:49,509
completely understand it and you just
whip something up to change it might

415
00:40:49,510 --> 00:40:55,240
happen knows what's left over right
right yeah I interested you know it

416
00:40:55,240 --> 00:41:00,308
wouldn't surprise me and I have no
reason this is what's going on but then

417
00:41:00,309 --> 00:41:03,400
it wouldn't surprise me if whoever
actually

418
00:41:03,910 --> 00:41:08,890
this is actually getting the wallet
notification had been sweeping the boxer

419
00:41:08,890 --> 00:41:14,710
unfortunate ones writing I can totally
see that sort of shenanigans go but

420
00:41:14,710 --> 00:41:22,930
don't over should certainly back there
all over

421
00:41:22,930 --> 00:41:32,470
yeah they're all over ah certainly we're
seeing you don't still a little hot side

422
00:41:32,470 --> 00:41:38,109
private general I haven't done a lot of
you know we're still working on

423
00:41:38,109 --> 00:41:45,970
attribution at versions is hard for
getting grouping for tying actors to

424
00:41:45,970 --> 00:41:52,209
families and stuff like that but that's
not the same as knowing the right uh-huh

425
00:41:52,210 --> 00:41:55,809
certainly losing a lot of the web forums

426
00:41:55,809 --> 00:42:03,490
you know I there's I don't see how is it
going to continue to explode right there

427
00:42:03,490 --> 00:42:08,680
is currently rain somewhere source code
for sale for forty to fifty dollars

428
00:42:08,680 --> 00:42:16,270
right so when you only have to invest
forty to fifty dollars us to get rain

429
00:42:16,270 --> 00:42:19,270
somewhere and is pretty easy you know

430
00:42:19,270 --> 00:42:25,839
reach out to your bottom and install
service and get the installs how the

431
00:42:25,839 --> 00:42:31,839
successes is going to continue to drive
that which is why ultimately bought in

432
00:42:31,839 --> 00:42:35,980
throwing this out there you know this
isn't a huge deal right this is one

433
00:42:35,980 --> 00:42:40,720
family that is certainly not one of the
most prevalent families by any stretch

434
00:42:40,720 --> 00:42:46,779
our but we really were are open as much
to spark post and get thinking about

435
00:42:46,779 --> 00:42:51,730
other ways to tackle this problem
because our unto we can you know if you

436
00:42:51,730 --> 00:42:58,089
attended a Christmas stocks right so you
know about the economics right until we

437
00:42:58,089 --> 00:43:06,819
can make the payback less valuable work
is going to continue all right so that's

438
00:43:06,819 --> 00:43:11,250
the tipping point i don't know how we do
that unless you can figure out

439
00:43:11,250 --> 00:43:22,470
mass tools the kind of targets in the
first few questions or are you just ask

440
00:43:22,470 --> 00:43:30,810
where we owe these old are these get
posted on YouTube usually about a week

441
00:43:30,810 --> 00:43:37,170
out . travel right yeah i yeah

442
00:43:37,680 --> 00:43:44,549
youtube search Brian on the app you're
not aware so all of the so Adrian goes

443
00:43:44,550 --> 00:43:49,410
to pretty much every security conference
sure your business a couple but not many

444
00:43:49,410 --> 00:43:55,379
and and videos so all of these box for
all the sessions today will be able to

445
00:43:55,380 --> 00:44:00,780
freely available in so few minutes
something like I say I'm I'm definitely

446
00:44:00,780 --> 00:44:13,020
coming back then this so into completely
such aa aa sorry

447
00:44:13,020 --> 00:44:16,500
thank you for fun he okay perfect

448
00:44:16,500 --> 00:44:21,720
I don't be posting stuff on his YouTube
channel to ah but yeah it will be out

449
00:44:21,720 --> 00:44:25,200
there Sophie sighs and Gospels as you
can sorry

450
00:44:25,200 --> 00:44:33,540
thanks for your question we good right
the green shapes and we going to do so

451
00:44:33,540 --> 00:44:45,240
mods so my house I told so we have all a
couple cool

452
00:44:46,740 --> 00:44:51,089
that's right I worries

453
00:44:51,090 --> 00:45:04,500
I and my way on toys so why we're going
to come up with a question here I'm

454
00:45:04,500 --> 00:45:15,030
terrible with questions problems what
saddles most prominent principal sure

455
00:45:15,810 --> 00:45:19,410
so from the initial what was the CIA it
was that

456
00:45:20,059 --> 00:45:25,309
yes lock it is one out

457
00:45:25,309 --> 00:45:35,449
alright another question what our water
I'll the two most prominent distribution

458
00:45:35,449 --> 00:45:45,199
layers or a lot of the race yeah the
cybercrime self mentioned earlier up

459
00:45:45,199 --> 00:45:53,809
again get I is awful first are all
persons are you okay

460
00:45:56,660 --> 00:46:05,598
no but I never specific to our names I
mission sir

461
00:46:05,599 --> 00:46:09,259
Oh salad salad was on the slide

462
00:46:10,130 --> 00:46:16,069
no those are raising their families so
these are distribution channels just

463
00:46:16,069 --> 00:46:19,788
mentioned it was the past so Miami

464
00:46:19,789 --> 00:46:26,749
ah but you're not aware that you should
be aware because they are a couple of

465
00:46:26,749 --> 00:46:42,410
the things we use to distribute a lot of
today fingers all right all store I whoa

466
00:46:42,410 --> 00:46:52,729
ah alright I 1902 I specifically
measured or that I close enough

467
00:46:52,729 --> 00:47:03,859
alright so i have two more got a
question and the next one is this is a

468
00:47:03,859 --> 00:47:11,719
book find space you have read it she
just think an athlete book really

469
00:47:11,719 --> 00:47:20,150
believable so next question I don't
think we're in a sense what was the name

470
00:47:20,150 --> 00:47:28,969
of this function that performs the check
on our thousand files

471
00:47:32,180 --> 00:47:40,640
I think everyone mentioned it functions
manager when it happens when does that

472
00:47:40,640 --> 00:47:41,150
happen

473
00:47:41,150 --> 00:47:55,880
these are all right we have one more
without a really cool pics giveaway up

474
00:47:55,880 --> 00:48:02,180
what's that saying you know how many
does what is Phil's alternate full name

475
00:48:02,180 --> 00:48:15,049
haha yeah when Tamara that's going on
for a wrong five right and thank you

476
00:48:15,050 --> 00:48:18,800
very much everybody i wanna hook up
people

