1
00:00:00,000 --> 00:00:09,120
our student leaders some smart guys some
really great research was really great

2
00:00:09,120 --> 00:00:22,350
work into ICS virus authorized well John
alright thank you thank you

3
00:00:22,350 --> 00:00:27,570
so today we will talk about industrial
control system or ICS hunting industrial

4
00:00:27,570 --> 00:00:30,900
control systems just as we get started
so into a lot of intermit Oriole

5
00:00:30,900 --> 00:00:34,890
industrial control systems the type of
systems end up operating a lot of the

6
00:00:34,890 --> 00:00:39,750
infrastructure that we deal with on
databases water utilities power grids

7
00:00:39,750 --> 00:00:44,550
oil and gas refineries petrochemical
facilities just think of our devices

8
00:00:44,550 --> 00:00:48,839
these these physical rugged systems some
of them are window systems we have

9
00:00:48,840 --> 00:00:51,930
windows systems running you know the
human-machine interfaces or HM eyes

10
00:00:51,930 --> 00:00:56,100
these environments so the thing that
really sets them apart though is that

11
00:00:56,100 --> 00:01:00,210
ability to impact and control physical
environments right that sensing an

12
00:01:00,210 --> 00:01:04,439
actuated in these environments that's
really what sets them apart so I little

13
00:01:04,438 --> 00:01:09,630
intro john and i had a company called
riggers I also author the threat

14
00:01:09,630 --> 00:01:15,298
intelligence class at sands and the ICS
in response and active defense class but

15
00:01:15,299 --> 00:01:19,799
most importantly i right that the comic
pretty but it can be sized presentation

16
00:01:19,799 --> 00:01:22,799
experience that's creating presentation
yesterday

17
00:01:22,799 --> 00:01:26,159
you'll notice that you have seen little
Bobby always like put them in the slides

18
00:01:26,159 --> 00:01:30,600
throughout the material i found in my
time in the government that was really

19
00:01:30,600 --> 00:01:34,919
easy to use comics to explain complex
topics to congressman and other senior

20
00:01:34,920 --> 00:01:39,540
visuals so I continue that on a weekly
basis now John good

21
00:01:39,540 --> 00:01:43,799
hey good afternoon everybody I so I'm
done laughter Robin mentioned i'm at

22
00:01:43,799 --> 00:01:48,810
Drago's as well i'm also an avid
starbucks mug collector anybody else in

23
00:01:48,810 --> 00:01:51,810
the audience's is one of those as well I
have kind of a

24
00:01:52,980 --> 00:01:58,440
that's something i do way too much but
I've also got a pretty thorough

25
00:01:58,440 --> 00:02:03,630
background US intelligence community i
just recently left back in may for my

26
00:02:03,630 --> 00:02:07,440
backgrounds in everything from red
teaming blue teaming but actually met

27
00:02:07,440 --> 00:02:12,540
Rob we're working in the ICS space not
doing threat intelligence perfect right

28
00:02:12,540 --> 00:02:15,870
so here's we're going to talk about
today first up is going to cover three

29
00:02:15,870 --> 00:02:16,350
things

30
00:02:16,350 --> 00:02:20,489
what is that hunting how do you start
hunting and specifically why and how do

31
00:02:20,490 --> 00:02:25,020
you do it in ICS environments so for our
first little body comic little Bobby

32
00:02:25,020 --> 00:02:30,150
asks why do people try to redefine
active defense to involve intelligence

33
00:02:30,150 --> 00:02:34,770
and offensive operations and matt says
well many would like to call those types

34
00:02:34,770 --> 00:02:38,790
of operations hard to do those type
operations but if they call it active

35
00:02:38,790 --> 00:02:44,280
defense it just seems more reasonable to
books and little Bobby said we'll find

36
00:02:44,280 --> 00:02:48,570
while doing homework is now defined as
playing Minecraft and i started with

37
00:02:48,570 --> 00:02:52,769
this one specifically because with this
topic of threat hunting and threatened

38
00:02:52,770 --> 00:02:56,730
to act events in any of the words we
start doing out there is a real concern

39
00:02:56,730 --> 00:03:00,450
that we start talking and getting into
buzzword land right so you probably

40
00:03:00,450 --> 00:03:04,980
heard that being through number of
presentations day but there is real

41
00:03:04,980 --> 00:03:08,880
meaning to a lot of the words that we
use at times I find they get spun out of

42
00:03:08,880 --> 00:03:13,500
control either by vendors by folks
trying to appear to be security experts

43
00:03:13,500 --> 00:03:16,980
or just those folks getting involved in
the community

44
00:03:16,980 --> 00:03:20,790
I generally find that nobody's being
malicious buzzwords generally formed

45
00:03:20,790 --> 00:03:24,540
because people want to get involved and
do something whether on the vendor side

46
00:03:24,540 --> 00:03:29,280
or not i but we still have to be careful
forum will return today and talking to

47
00:03:29,280 --> 00:03:32,520
those terms of what they actually
represent and not that plus doubt

48
00:03:32,520 --> 00:03:35,940
concept that we might have heard over
the years now actually wrote for you to

49
00:03:35,940 --> 00:03:40,590
give it I want to do the first trivia
for today so we have the four gifts at

50
00:03:40,590 --> 00:03:41,910
the first one good

51
00:03:41,910 --> 00:03:46,290
so the first was a lockpick by south or
they were nice enough to donate so the

52
00:03:46,290 --> 00:03:50,579
first trivia question i'm actually gonna
refer to a little Bobby comics those of

53
00:03:50,580 --> 00:03:54,720
you who know Robin have seen Rob do I
have to do presentations in the past

54
00:03:54,720 --> 00:04:00,900
five if you had to guess which one would
you think Rob represents the most that

55
00:04:00,900 --> 00:04:03,630
little Bobby or the older mature Matt

56
00:04:03,630 --> 00:04:06,810
also your hand first

57
00:04:06,810 --> 00:04:14,640
perfect go ahead ya know so it was
actually modeled after myself so it's

58
00:04:14,640 --> 00:04:18,029
just get public presentations and get
involved in places sort of let your ego

59
00:04:18,029 --> 00:04:23,099
get a check I like to always return my
ego and try to be reasonable headed so I

60
00:04:23,100 --> 00:04:25,980
like refer to myself as a little Bobby
the kid that doesn't know anything since

61
00:04:25,980 --> 00:04:30,120
we're all people that are learning I
from expert there are no experts so cool

62
00:04:30,120 --> 00:04:32,460
so what is thread hunting

63
00:04:32,460 --> 00:04:36,000
I'm as we go through this here's our
next little body contact if you will and

64
00:04:36,000 --> 00:04:38,640
lobbies starting to get a little
concerned here's all this stuff about

65
00:04:38,640 --> 00:04:43,050
cyber war in my community says will
people go to war over network security

66
00:04:43,050 --> 00:04:48,090
and that says no not likely unless
there's some sort of physical grave

67
00:04:48,090 --> 00:04:52,979
damage maybe a loss of life or something
a little Bobby says well I saw experts

68
00:04:52,980 --> 00:04:54,150
saying differently

69
00:04:54,150 --> 00:04:58,409
matt said well where these experts
selling security solutions and little

70
00:04:58,410 --> 00:04:58,800
bodies

71
00:04:58,800 --> 00:05:02,970
yeah the products look really nice I and
what I wanted to know what you're

72
00:05:02,970 --> 00:05:07,530
getting into this next couple topics
especially with Red hunting is hunting

73
00:05:07,530 --> 00:05:11,580
has been around for a long time is that
human dedicated approach is actually

74
00:05:11,580 --> 00:05:15,719
searching for adversaries in your
environment over the last two years

75
00:05:15,720 --> 00:05:19,890
we've seen it sort of go fully to the
right in the sense of marketing and

76
00:05:19,890 --> 00:05:24,030
presentations and vendor products and
things like that and i just want to note

77
00:05:24,030 --> 00:05:28,260
that a lot of the folks selling
solutions have typed on hunting when it

78
00:05:28,260 --> 00:05:31,830
used to be red and tell and before that
it was just a storage platform and now

79
00:05:31,830 --> 00:05:36,330
it's hunting platform and it back and
forth we see all this jazz take place

80
00:05:36,330 --> 00:05:40,109
there's one note again that there's some
real value here that john starts going

81
00:05:40,110 --> 00:05:45,030
off with ya and liquor upset that as far
as as far as getting value of tools and

82
00:05:45,030 --> 00:05:46,859
different types of platforms

83
00:05:46,860 --> 00:05:50,520
there is definitely an advantage to
having them and going with them but at

84
00:05:50,520 --> 00:05:55,260
the same time a lot of this is a people
process so we refer to one of the first

85
00:05:55,260 --> 00:05:55,920
stone

86
00:05:55,920 --> 00:06:01,200
I think six or seven models that we're
going to use in our slides today the

87
00:06:01,200 --> 00:06:04,979
sliding scale of cybersecurity so it
just kind of walking quickly

88
00:06:05,610 --> 00:06:09,840
I'm if you start with architecture and
start with the simple hygiene facts on

89
00:06:09,840 --> 00:06:14,580
the network you're going to get a lot
more value out of doing that as far as

90
00:06:14,580 --> 00:06:16,880
being able to do that hunting later down
the road

91
00:06:16,880 --> 00:06:21,469
but it's definitely something to focus
on personal front and then kind of edge

92
00:06:21,470 --> 00:06:25,550
move across the scale you get into
passive defenses so being able to

93
00:06:25,550 --> 00:06:31,280
employee ids is IPS is different types
of platforms or systems on your network

94
00:06:31,280 --> 00:06:36,440
and be able to take advantage of
alerting data collection not then moving

95
00:06:36,440 --> 00:06:42,050
into more of the active and peace so as
your organization matures and as you

96
00:06:42,050 --> 00:06:46,730
kind of build processes get people in
place then you're able to do things like

97
00:06:46,730 --> 00:06:51,320
active defense which includes hunting
will get a little bit more interactive

98
00:06:51,320 --> 00:06:56,240
this piece here in a second but I'm for
those organizations that are able to

99
00:06:56,240 --> 00:07:00,290
kind of put all this together and do a
very good job of it and you can see

100
00:07:00,290 --> 00:07:03,710
potentially moving down the spectrum a
little bit further into actually

101
00:07:03,710 --> 00:07:08,750
generating threat intelligence but very
rarely will you ever see an organization

102
00:07:08,750 --> 00:07:10,640
going on the offensive

103
00:07:10,640 --> 00:07:13,880
it's it's it's definitely a myth

104
00:07:13,880 --> 00:07:17,300
don't say a myth but it's definitely
something that's that's kind of reached

105
00:07:17,300 --> 00:07:21,680
out in the market that isn't exactly
something that organization should do or

106
00:07:21,680 --> 00:07:26,930
or even have the resources to go as I
want to add on there as well one of the

107
00:07:26,930 --> 00:07:30,590
reasons i create a model early on paper
behind everybody interested is

108
00:07:30,590 --> 00:07:34,429
specifically to push back into the
office discussion as I've seen sort of

109
00:07:34,430 --> 00:07:37,880
the height of the community take control
of what we should be doing next the next

110
00:07:37,880 --> 00:07:42,110
gen and next next gen or whatever gym or
on all of these things were supposed to

111
00:07:42,110 --> 00:07:42,860
be doing

112
00:07:42,860 --> 00:07:46,190
I do want to note that we do forget a
lot of the basics and i usually joke

113
00:07:46,190 --> 00:07:49,850
around the key to being a security
expert is just renaming the basics and

114
00:07:49,850 --> 00:07:54,050
something sexier but really at the end
of the day we need to stay away from

115
00:07:54,050 --> 00:07:57,860
doing the stuff that doesn't return a
lot of investment for organizations

116
00:07:57,860 --> 00:08:02,150
hi there was a large company that was
compromised at some of you will know its

117
00:08:02,150 --> 00:08:03,650
name but i'll leave them out of it

118
00:08:03,650 --> 00:08:07,070
large company that was compromised that
millions of dollars loss and there was

119
00:08:07,070 --> 00:08:10,460
serious border and discussions going on
about can we go back after the

120
00:08:10,460 --> 00:08:13,099
adversaries and they decided to do so

121
00:08:13,100 --> 00:08:16,100
so there are private companies that are
starting to do the whole halfback thing

122
00:08:16,100 --> 00:08:20,930
and they spent millions of dollars to go
back after the adversaries in most of it

123
00:08:20,930 --> 00:08:24,470
actually or significant portion of it
was in legal fees just to see what they

124
00:08:24,470 --> 00:08:28,400
could and couldn't do inside combines
law but they spent a lot of time and

125
00:08:28,400 --> 00:08:30,380
money doing that and then you look

126
00:08:30,380 --> 00:08:34,490
the security organization and they had
11 people 11 people on securities that

127
00:08:34,490 --> 00:08:40,430
operate global organization and six of
the 11 or management positions so this

128
00:08:40,429 --> 00:08:44,179
is Robbie's rule of thought that if you
have more than a one-to-one ratio

129
00:08:44,179 --> 00:08:49,969
managers to analyst your breach will be
embarrassing ok so when it comes to what

130
00:08:49,970 --> 00:08:53,210
they could have been doing in terms of
security investments that they had they

131
00:08:53,210 --> 00:08:56,450
would apply to all those resources the
hiring and training the staff start

132
00:08:56,450 --> 00:08:59,540
moving along appropriately it would have
been much better for them

133
00:08:59,540 --> 00:09:03,110
one of the reasons we bring this up
today is yesterday hunting isn't active

134
00:09:03,110 --> 00:09:07,010
defense contract and even though we're
both the advocates of it i would never

135
00:09:07,010 --> 00:09:10,310
recommend to an organization that that's
the first thing you got started

136
00:09:10,310 --> 00:09:14,390
I'll get the basics done correctly make
sure passenger systems logging taking

137
00:09:14,390 --> 00:09:19,040
care of that cyber hygiene stuff you
will I but don't just jump to training

138
00:09:19,040 --> 00:09:23,480
15 people to go searching for apts your
network when you're getting hit with i

139
00:09:23,480 --> 00:09:25,940
authenticated request into your
environment

140
00:09:25,940 --> 00:09:30,110
I've seen systems that have had
unauthenticated vpns into a Windows 10

141
00:09:30,110 --> 00:09:33,800
system running powershell across the
environment while they're trying to

142
00:09:33,800 --> 00:09:37,160
deploy next-gen firewall and some other
segments the network like maybe you

143
00:09:37,160 --> 00:09:41,150
should just enable to form first and
then we'll start going along so with

144
00:09:41,150 --> 00:09:45,050
that some other models if you will a
couple more models actually three I

145
00:09:45,050 --> 00:09:50,150
think to be specific but um since the
talk is about threading like to actually

146
00:09:50,150 --> 00:09:54,470
apply some models to doing threatening
itself so how do you get started with

147
00:09:54,470 --> 00:09:58,910
Tom how do you get started down the
hunting path i had a conversation this

148
00:09:58,910 --> 00:10:03,439
afternoon somebody who's doing a little
bit of his organization and just

149
00:10:03,440 --> 00:10:06,410
listening to now trying to figure out
where to get started

150
00:10:06,410 --> 00:10:09,740
it's a very difficult process if you
don't have a lot of background and

151
00:10:09,740 --> 00:10:14,060
experience in it and part of this talk
will get into hypothesis generation to

152
00:10:14,060 --> 00:10:17,569
be able to start doing that but if you
look at applying some models to the

153
00:10:17,570 --> 00:10:22,550
actual process itself we kind of divided
about into an active defense portion

154
00:10:22,550 --> 00:10:27,469
which is more the people process which
is more the proactive means of going

155
00:10:27,470 --> 00:10:31,550
after trying to do discovery trying to
do the threat detection and then

156
00:10:31,550 --> 00:10:33,859
figuring out how to clean up and
remediate it

157
00:10:33,860 --> 00:10:38,269
preparing that with the threat
intelligence piece where there's tons of

158
00:10:38,269 --> 00:10:42,740
models available at your fingertips
these are just two that are very common

159
00:10:42,740 --> 00:10:47,060
very widely used in industry so being
able to kind of a pair of those two

160
00:10:47,060 --> 00:10:50,839
together don't rely too heavily on one
of the other is a good way to kind of

161
00:10:50,839 --> 00:10:53,060
build your process around program

162
00:10:53,060 --> 00:10:57,949
absolutely I'm i will also under way I
did not mean I model is actually paper

163
00:10:57,950 --> 00:11:02,870
really good paper in my surgery and
group to call the dye model for

164
00:11:02,870 --> 00:11:05,839
intrusion analysis it was a model we
used in the intelligence community side

165
00:11:05,839 --> 00:11:10,070
we're looking at large representations
of data across large amounts of

166
00:11:10,070 --> 00:11:13,579
intrusions and trying to find out who
wear the adversary was and what they're

167
00:11:13,579 --> 00:11:17,359
going after work very effectively still
something that we use and teach up to

168
00:11:17,360 --> 00:11:21,769
today I'm and of course you've heard the
kill chain or I will admit that when i

169
00:11:21,769 --> 00:11:25,430
made the other model the active side of
that cycle but the only reason I through

170
00:11:25,430 --> 00:11:29,209
the word cyber in there because it made
the acronym ac/dc and I thought that was

171
00:11:29,209 --> 00:11:30,140
clever

172
00:11:30,140 --> 00:11:34,760
so that's the only real reason for that
but I this aspect of seeing what's on

173
00:11:34,760 --> 00:11:39,170
the network finding it remediating it
looking into trying to uncover the

174
00:11:39,170 --> 00:11:43,910
threat not now where we usually focus
way too much on malware now is not the

175
00:11:43,910 --> 00:11:47,420
threat to human on the other side of
keyboards and threat now we're just won

176
00:11:47,420 --> 00:11:51,500
the capabilities they might or might not
deploy this good thing to keep in mind

177
00:11:51,500 --> 00:11:55,820
so when we talk about hunting it's kind
of hard not refer to David bianco at

178
00:11:55,820 --> 00:11:59,630
some point really really smart guy i
came up with this hunting maturity model

179
00:11:59,630 --> 00:12:04,699
one that I like to look back to we look
at hunting that human approach to

180
00:12:04,699 --> 00:12:10,099
finding present environment there is a
scale of maturity to it on the far

181
00:12:10,100 --> 00:12:13,970
left-hand Scott side when you're not
really hunting that's why it's level 0

182
00:12:13,970 --> 00:12:17,990
when you're not really doing any hunting
you're just replying on alerting right

183
00:12:17,990 --> 00:12:21,680
the idea says something the firewall
says something ad says something and you

184
00:12:21,680 --> 00:12:26,000
respond to it it's not hunting it's a
very reactive approach and one of the

185
00:12:26,000 --> 00:12:29,300
pitfalls in it is that you're probably
not taking a lot of data off your

186
00:12:29,300 --> 00:12:33,589
environment to begin with anyways as you
move across it you'll notice that theme

187
00:12:33,589 --> 00:12:37,430
that it's a lot of data collection
that's going on and that's where a lot

188
00:12:37,430 --> 00:12:40,339
of organizations get in trouble that's
where a lot of organizations have

189
00:12:40,339 --> 00:12:44,510
problems is how do i get all of the data
how do I get it back in my environment

190
00:12:44,510 --> 00:12:47,360
search through without paying an arm and
a leg

191
00:12:47,360 --> 00:12:50,600
and stay on top of the constantly
changing environment and industrial

192
00:12:50,600 --> 00:12:54,140
control systems will talk about later
that is probably one of the biggest

193
00:12:54,140 --> 00:12:57,560
challenges in the community is how do i
get data out of control system

194
00:12:57,560 --> 00:13:02,420
environments while respecting the safety
reliability concerns of the facility as

195
00:13:02,420 --> 00:13:05,630
we move along as well you're not only
notice that there's a higher retention

196
00:13:05,630 --> 00:13:10,790
of data and higher need for data but you
will see that you can start relying on

197
00:13:10,790 --> 00:13:15,380
indicators of compromise instead we're
just doing for the basics you move along

198
00:13:15,380 --> 00:13:19,490
to actually taking processes and models
that other people are using and

199
00:13:19,490 --> 00:13:23,300
ingesting them on your team and then at
some point actually creating the new

200
00:13:23,300 --> 00:13:29,029
analysis procedures the new analytics to
find unknown threats the last one is one

201
00:13:29,029 --> 00:13:31,730
that gives a little bit of confusion the
industry

202
00:13:31,730 --> 00:13:35,029
you'll note that it says automates the
majority of successful data analysis

203
00:13:35,029 --> 00:13:41,750
procedures there are a lot of companies
and marketing out right now trying to

204
00:13:41,750 --> 00:13:45,140
say automate all of the things that you
do for haunted just automate everything

205
00:13:45,140 --> 00:13:50,569
that's not hunting automation is very
important taunton you should be

206
00:13:50,570 --> 00:13:54,920
automated all of the things that you can
but if you are actually going through an

207
00:13:54,920 --> 00:13:58,399
automated process in itself is not
hunting because you've taken the person

208
00:13:58,399 --> 00:14:02,180
out of the loop and that's the piece
that is obviously more to it

209
00:14:02,180 --> 00:14:07,279
so in effect when you're at hmm for what
you really should be doing is figuring

210
00:14:07,279 --> 00:14:11,839
out everything that it takes you to find
the threat that you did and then

211
00:14:11,839 --> 00:14:15,620
automate that way you don't have to deal
with it on your next time

212
00:14:15,620 --> 00:14:19,970
that's actually sort of process that
it's more it's more than enabling force

213
00:14:19,970 --> 00:14:23,570
and something that allows you to create
a repetitive process them then actually

214
00:14:23,570 --> 00:14:25,160
taking over doing it for you

215
00:14:25,160 --> 00:14:29,569
and another thing that we sort of see is
a problematic is a lot of organizations

216
00:14:29,570 --> 00:14:33,740
at the shiny object syndrome right they
go to the latest newest thing and you

217
00:14:33,740 --> 00:14:36,019
walk in you'll see an organization's got
it

218
00:14:36,019 --> 00:14:39,649
renting tea but they don't have a
network operations center or they don't

219
00:14:39,649 --> 00:14:41,180
have a security operations center

220
00:14:41,180 --> 00:14:44,540
they've already jumped to the far
right-hand side of active defense if you

221
00:14:44,540 --> 00:14:49,069
will that threat hunting to be sure not
only in this model just sort of stage of

222
00:14:49,070 --> 00:14:52,430
maturity but also against that sliding
scale aspect of actually taking care of

223
00:14:52,430 --> 00:14:57,770
what's on your network so this next
slide I wrote it as a joke at first and

224
00:14:57,770 --> 00:15:00,949
then I thought was actually useful i do

225
00:15:00,950 --> 00:15:05,150
bianco anybody knows me as this pyramid
pain you've probably seen it at some

226
00:15:05,150 --> 00:15:10,010
point your life talks about hashes
domain the TTP's things you can move up

227
00:15:10,010 --> 00:15:14,900
for the pyramid pain perhaps series so i
give you the the threat hunting

228
00:15:14,900 --> 00:15:20,840
jawbreaker so the entire idea behind the
jawbreaker here is that there are at

229
00:15:20,840 --> 00:15:24,950
least five things that I see wrong and
industry today that we need to sort of

230
00:15:24,950 --> 00:15:29,630
adapt to when it comes to hunting if we
really want to embody what it means to

231
00:15:29,630 --> 00:15:34,040
be a rare hunters these four things in
addition to the fifth of the top at that

232
00:15:34,040 --> 00:15:38,569
we see problematic number one it has to
rely on people and this is really hard

233
00:15:38,570 --> 00:15:41,330
for a lot of organization understand
they'll usually try to take somebody

234
00:15:41,330 --> 00:15:42,320
that's new

235
00:15:42,320 --> 00:15:46,460
throw them into a job its threat hunting
and then be disappointed when they don't

236
00:15:46,460 --> 00:15:51,470
get a lot of value out of it really is a
specialty to do grounding you should

237
00:15:51,470 --> 00:15:53,660
have some sort of specialty that you
bring to the table

238
00:15:53,660 --> 00:15:57,620
it's responder security operations folks
somebody who knows Mac forensics your

239
00:15:57,620 --> 00:16:01,280
big mac environment somebody who knows
how to do I are across the enterprise

240
00:16:01,280 --> 00:16:05,000
someone who knows how to do similar ting
different specialties are ultimately

241
00:16:05,000 --> 00:16:09,080
coming together both red and blue team
on the same team to do this 300

242
00:16:09,080 --> 00:16:14,630
approaches the second one is your job
focuses on those human adversaries you

243
00:16:14,630 --> 00:16:18,680
should be finding them but you might not
and that's actually one of the most

244
00:16:18,680 --> 00:16:23,270
depressing aspect here so i had a
customer that set up a beautiful network

245
00:16:23,270 --> 00:16:27,500
they were doing security operations
center for a gas pipeline and it was a

246
00:16:27,500 --> 00:16:31,940
really really good environment they had
whitelisting across the environment they

247
00:16:31,940 --> 00:16:35,480
had every bit of monitoring they could
have a full packet capture from

248
00:16:35,480 --> 00:16:40,400
everywhere inside of the ICS it was a
beautiful setup and this guy had trained

249
00:16:40,400 --> 00:16:44,870
and trained and trained in ms @ eunice
that and it was by all accounts a very

250
00:16:44,870 --> 00:16:50,810
impressive organization overall and then
they saw nothing and continue to see not

251
00:16:50,810 --> 00:16:54,619
actually lock down the facility very
well inside of this combines of the ICS

252
00:16:54,620 --> 00:16:58,880
they never got to see the big bad apt
that they kept hearing about the news

253
00:16:58,880 --> 00:17:02,450
everywhere else that was almost
disheartening to that staff and it's

254
00:17:02,450 --> 00:17:07,579
also very hard to do retention of people
when someone trains up to be this threat

255
00:17:07,579 --> 00:17:09,928
hundred is written body this thing's me
awesome

256
00:17:09,929 --> 00:17:14,639
and find out that their job relies on
the adversary being there and again that

257
00:17:14,638 --> 00:17:18,898
can be sort of problematic we've seen
that even in the news where I fire fire

258
00:17:18,898 --> 00:17:22,079
is a lot of good stuff in the community
and then you see discussions about old

259
00:17:22,079 --> 00:17:25,230
LOL China's not coming after portion of
the government anymore which is

260
00:17:25,230 --> 00:17:29,279
debatable but I i was significant for
the Chinese activity falls off

261
00:17:29,279 --> 00:17:32,730
well that's gonna have a significant
impact to all the people at fireeye who

262
00:17:32,730 --> 00:17:37,110
were focusing on Chinese threats so our
adversary defender relationship is much

263
00:17:37,110 --> 00:17:41,399
more of a bi-directional relationship
than most people realize the next one

264
00:17:41,399 --> 00:17:44,908
there's I wanted to note that you need
to be open-minded but you can't be a new

265
00:17:44,909 --> 00:17:49,200
person so going back to that kind of
original discussion I don't think Fred

266
00:17:49,200 --> 00:17:52,649
country is the place to drop you and I
really think they should get familiar

267
00:17:52,649 --> 00:17:55,709
with the organization they should build
up their security skills they should

268
00:17:55,710 --> 00:17:58,919
develop a specialty find what's
interesting to them and then be able to

269
00:17:58,919 --> 00:18:04,139
come over to that style of team but they
have to be open-minded we had an analyst

270
00:18:04,139 --> 00:18:08,789
at work with us back in the intelligence
community is Lance Corporal Marine Corps

271
00:18:08,789 --> 00:18:11,399
definitely did not belong there

272
00:18:11,399 --> 00:18:15,360
final stretch of the imagination did not
belong on a team that sounds harsh but

273
00:18:15,360 --> 00:18:19,799
he was a new person and we were doing
more than stop so he went off has got

274
00:18:19,799 --> 00:18:23,129
some training dragon specialties came
back still disheartened still the new

275
00:18:23,129 --> 00:18:28,408
guy and all and also a note to you that
the questions he asked even though he

276
00:18:28,409 --> 00:18:31,860
wasn't able to investigate everything
that he was supposed to even though he

277
00:18:31,860 --> 00:18:35,428
wasn't able to uncover everything that
we needed him to do with the tools we

278
00:18:35,429 --> 00:18:40,740
add the questions he asked as that new
person was more impactful than anybody

279
00:18:40,740 --> 00:18:45,299
else in the team that open mindedness
that he had not really understanding why

280
00:18:45,299 --> 00:18:49,559
the world worked in specific ways he
started asking those questions that

281
00:18:49,559 --> 00:18:52,769
revealed adversary data we never thought
to look for so I don't want to be

282
00:18:52,769 --> 00:18:57,240
discouraging to the new folks we need
more of them we need a lot of them I

283
00:18:57,240 --> 00:19:01,499
think they have a huge value and
organization but for the benefit of your

284
00:19:01,499 --> 00:19:05,580
new folks would like to see less
plopping down Brown team to start off

285
00:19:05,580 --> 00:19:09,090
with you could always you can always
paramount you're trying to get them or

286
00:19:09,090 --> 00:19:12,240
40 so you want to get them to work with
your senior folks that have a lot of

287
00:19:12,240 --> 00:19:16,860
experience it's helpful in the shadowing
for a week or sit down on certain types

288
00:19:16,860 --> 00:19:19,669
of certain types of processes and in the
end

289
00:19:19,670 --> 00:19:25,460
process yeah absolutely i also know that
your next one there's that product

290
00:19:25,460 --> 00:19:29,270
vendors will pitch hunting but it's not
about the product it is that you can

291
00:19:29,270 --> 00:19:33,650
focus we see a lot of products in the
market right now about hunting platforms

292
00:19:33,650 --> 00:19:37,730
as an example was really no such thing
and a lot of us can sit down to like

293
00:19:37,730 --> 00:19:40,460
well there's one black friend is this
that now it's you're really just talking

294
00:19:40,460 --> 00:19:43,970
about different tools to enable data
access analytics and automation that's

295
00:19:43,970 --> 00:19:48,950
great and that's useful but really the
hunting itself is focused on that human

296
00:19:48,950 --> 00:19:52,040
person so we can relabeled things the
industry because people to use them

297
00:19:52,040 --> 00:19:55,610
that's fantastic but at its core is
remember it's always central that person

298
00:19:55,610 --> 00:19:57,500
and of course as we hit on already

299
00:19:57,500 --> 00:20:02,060
you need to rely on automation but you
can't fully automate all right so we

300
00:20:02,060 --> 00:20:08,060
start so the CISO here says a little
Bobby I need to ensure that no attacks

301
00:20:08,060 --> 00:20:12,560
occur little Bobby says cool what's the
security budget the CSO says matter now

302
00:20:12,560 --> 00:20:16,639
we have to cut it all out a little body
says well I assure you we will never see

303
00:20:16,640 --> 00:20:23,600
any attacks so when it comes to starting
to hot a lot of it is just initiating

304
00:20:23,600 --> 00:20:27,080
what you're doing but it's nice actually
have a guide approach so these next

305
00:20:27,080 --> 00:20:30,350
couple slides were going to go through
how to do hypothesis generation a

306
00:20:30,350 --> 00:20:34,310
hypothesis is nothing more than a
testable idea you come up with and it

307
00:20:34,310 --> 00:20:38,270
really is central to hunting is how you
should start a good on coming up with an

308
00:20:38,270 --> 00:20:42,230
idea of what the adversary might be
doing in your environment or where they

309
00:20:42,230 --> 00:20:43,400
might be located

310
00:20:43,400 --> 00:20:47,630
that's gonna drive how you do collection
environment and my pulling registry keys

311
00:20:47,630 --> 00:20:49,310
or mind-blowing memory samples

312
00:20:49,310 --> 00:20:52,280
well if I think that they're doing a
rootkit in the registry to remain

313
00:20:52,280 --> 00:20:53,570
persistence

314
00:20:53,570 --> 00:20:56,659
well then it's gonna be really important
to grab that registry key so we'll see

315
00:20:56,660 --> 00:20:58,400
how that sort of takes hold

316
00:20:58,400 --> 00:21:02,090
actually for me jump let's do another
out let's do another tree i'm going to

317
00:21:02,090 --> 00:21:08,449
be the true yesterday's so for those of
you I guess as anybody in anybody in the

318
00:21:08,450 --> 00:21:12,080
audience ever been involved in running
right down hunting in their environments

319
00:21:12,080 --> 00:21:13,500
showing it

320
00:21:13,500 --> 00:21:20,490
cool we got some alright so let's go
with we have listed three specific kind

321
00:21:20,490 --> 00:21:25,290
of John Rizzo of hypothesis generation
I'm Before we jump to that slide and see

322
00:21:25,290 --> 00:21:29,730
if anybody has an idea of what one of
them might be fine

323
00:21:31,620 --> 00:21:37,020
yeah alright so intelligence-driven
hunting is absolutely want one of the

324
00:21:37,020 --> 00:21:40,770
ways you can generate intelligence i
would flip it on walking one of the ways

325
00:21:40,770 --> 00:21:44,310
you can generate hypotheses we usually
usually come off of either threat

326
00:21:44,310 --> 00:21:47,820
intelligence or friendly intelligence we
often leave out that friendly construct

327
00:21:47,820 --> 00:21:52,110
if your forces your blue team are doing
something in your environment what

328
00:21:52,110 --> 00:21:56,550
they're doing and how they're doing it
might encourage you HOT differently so i

329
00:21:56,550 --> 00:22:00,389
will walk through some examples of these
coming up we'll just walk through that

330
00:22:00,390 --> 00:22:02,190
the generation aspect self

331
00:22:02,190 --> 00:22:06,420
I'm we also have the main expertise at
the end of the day there's always that

332
00:22:06,420 --> 00:22:10,950
something that hunters have experienced
beauty folks have it's kind of hard to

333
00:22:10,950 --> 00:22:15,810
put your finger on it if I would usually
rely that officers say that would be

334
00:22:15,810 --> 00:22:17,159
domain expertise

335
00:22:17,160 --> 00:22:21,240
it's something either from your past job
or your current job and over time you

336
00:22:21,240 --> 00:22:24,720
learned tradecraft you've learned
adversary capabilities even without

337
00:22:24,720 --> 00:22:28,890
intelligence without any brought to do
so you've learned something that you're

338
00:22:28,890 --> 00:22:32,820
going to bring with you and generating
hypotheses that is what i would refer to

339
00:22:32,820 --> 00:22:36,480
as domain expertise as many as an
example of that there's a guy that

340
00:22:36,480 --> 00:22:40,770
robbed and i worked with we're back in
the government who he would come sit

341
00:22:40,770 --> 00:22:44,129
down beside us as we were going through
either either looking at network traffic

342
00:22:44,130 --> 00:22:49,410
or just doing some sort of Investigation
and he'd be able to sit there and just

343
00:22:49,410 --> 00:22:53,190
kind of like tilt his head a little bit
he's like that smells like its excess

344
00:22:53,190 --> 00:22:57,840
actor or somebody who's done this in the
past and nine times out of ten the guy

345
00:22:57,840 --> 00:22:59,790
was actually right which is just odd

346
00:22:59,790 --> 00:23:03,720
he's been doing this for so long for him
it was like staring at the matrix with a

347
00:23:03,720 --> 00:23:07,590
little with the numbers and letters
falling down he would just kind of . and

348
00:23:07,590 --> 00:23:11,159
then we would start investigating down
that road but just having this people

349
00:23:11,160 --> 00:23:13,980
you guys know those people if you guys
are those people

350
00:23:13,980 --> 00:23:17,730
it's very helpful to get up and I can
share that with the rest of team sure

351
00:23:17,730 --> 00:23:21,720
that with the community that's
definitely one of the I'd say that's

352
00:23:21,720 --> 00:23:25,380
probably one of the biggest drivers for
being able to generate hypotheses and

353
00:23:25,380 --> 00:23:26,650
actually make it come true

354
00:23:26,650 --> 00:23:31,060
or be able to test it and find out that
it's actually true is actually happening

355
00:23:31,060 --> 00:23:35,200
in your environment and then the next
one I would say situation awareness and

356
00:23:35,200 --> 00:23:39,310
this is really understanding your own
organizations but i would drive you not

357
00:23:39,310 --> 00:23:42,610
to just think about tech and this is
going to come in in a big way with the

358
00:23:42,610 --> 00:23:46,929
ICS it's not just about the network's
about the overall systems and

359
00:23:46,930 --> 00:23:48,790
organizations and people around it

360
00:23:48,790 --> 00:23:52,990
do we have things going on a macro level
that are going to influence what we're

361
00:23:52,990 --> 00:23:54,100
seeing on the network

362
00:23:54,100 --> 00:23:59,709
I would indicate to you that saudi
aramco the oil and gas company in Saudi

363
00:23:59,710 --> 00:24:05,080
Arabia has a different threat landscape
than JPMorgan that's different right

364
00:24:05,080 --> 00:24:08,560
actors in capabilities different things
coming after that situational awareness

365
00:24:08,560 --> 00:24:12,610
around those things not from a threat
intelligence perspective but just from

366
00:24:12,610 --> 00:24:15,250
understand your own organization is
gonna drive how you can write these

367
00:24:15,250 --> 00:24:20,290
hypotheses I'm so let's set a couple of
these examples at the first one here is

368
00:24:20,290 --> 00:24:24,100
this threat intelligence inspired
hypotheses so maybe we've got this

369
00:24:24,100 --> 00:24:28,480
sparkling panzer group no sparkly pan is
not a real 1i just like all the little

370
00:24:28,480 --> 00:24:33,310
names always kind of like Jedi squirrel
and stuff but I sparking panda utilizing

371
00:24:33,310 --> 00:24:36,700
seychelles Basie two servers so most of
you probably don't have you ever heard

372
00:24:36,700 --> 00:24:39,700
of the country of seychelles but it's
probably not common in your environment

373
00:24:39,700 --> 00:24:43,360
so if you reached in and you found in
this intelligence report that you are

374
00:24:43,360 --> 00:24:47,979
consuming that there are seychelles
Basie two servers for this adversary it

375
00:24:47,980 --> 00:24:51,910
would be reasonable to generate
hypothesis that if seychelles are at the

376
00:24:51,910 --> 00:24:55,540
sparkling panda actors in your
environment you would expect to see I

377
00:24:55,540 --> 00:25:00,280
peas or domains and proxy logs of your
environment related to seychelles that's

378
00:25:00,280 --> 00:25:03,220
how you gonna hunt for that a little bit
differently but you've got to have that

379
00:25:03,220 --> 00:25:07,240
testing to make a hypothesis right so
it's not just a good idea very on the

380
00:25:07,240 --> 00:25:10,990
team it's actually going in testing at
that testing stage you might actually

381
00:25:10,990 --> 00:25:15,250
pull the proxy logs understand the data
flows and try to evaluate what you see

382
00:25:15,250 --> 00:25:18,670
in the environment and again this is
really where we bridge the gap that it's

383
00:25:18,670 --> 00:25:21,670
not just ir it's not just security
operations

384
00:25:21,670 --> 00:25:25,330
it's a senior individual really
understand how to explore and test a

385
00:25:25,330 --> 00:25:28,570
theory in your own environment related
to what the officer activity might be

386
00:25:29,380 --> 00:25:34,870
and that also as they also has the
technology the data to help support

387
00:25:34,870 --> 00:25:35,919
those as well

388
00:25:35,920 --> 00:25:40,180
another example with the situational
awareness inspired hypothesis so let's

389
00:25:40,180 --> 00:25:43,120
say you're so you're working for a large
company small company for that matter

390
00:25:43,120 --> 00:25:48,280
and you know there's a murderer about to
happen and your company's acquiring I a

391
00:25:48,280 --> 00:25:51,340
globally distributed company that you
know networks are going to have to be

392
00:25:51,340 --> 00:25:57,580
integrated over the next six months if
you kind of took that in that process me

393
00:25:57,580 --> 00:26:02,230
made an assumption or hypothesis that
says i'm pretty sure that whatever

394
00:26:02,230 --> 00:26:07,150
networks were taking on theirs either
re-infection in it or it's gonna it's

395
00:26:07,150 --> 00:26:10,450
gonna introduce some sort of
vulnerability to our environments and

396
00:26:10,450 --> 00:26:15,100
being able to test that by identifying
how that network is going to be attached

397
00:26:15,100 --> 00:26:19,510
to current network whether or not you're
going to be architect do reconfiguration

398
00:26:19,510 --> 00:26:23,770
but being able to identify the
checkpoints that you need the types of

399
00:26:23,770 --> 00:26:29,560
data that you need flow data to be able
to actually prove that hypothesis that

400
00:26:29,560 --> 00:26:33,490
if if something malicious going on into
the network that you're that you're

401
00:26:33,490 --> 00:26:34,870
bringing into yours

402
00:26:34,870 --> 00:26:39,969
you're going to be able to find that out
all the time then for an example of the

403
00:26:39,970 --> 00:26:41,170
domain expertise

404
00:26:41,170 --> 00:26:44,530
maybe an analyst understand industrial
control systems very well so they

405
00:26:44,530 --> 00:26:48,370
understand how they interact understand
what normal and abnormal looks like from

406
00:26:48,370 --> 00:26:52,270
that specialty that they brought the
table that domain expertise they

407
00:26:52,270 --> 00:26:56,710
generate hypotheses that there's likely
you function codes going on in something

408
00:26:56,710 --> 00:27:00,520
like your modesty c or d mp3 protocol
that was going on their environment and

409
00:27:00,520 --> 00:27:04,060
its adversary later they generate this
hypothesis that there will be abnormal

410
00:27:04,060 --> 00:27:08,139
and potentially harmful function codes
and protocols themselves that ability to

411
00:27:08,140 --> 00:27:12,130
then tested is going to require them to
know how to get data off the environment

412
00:27:12,130 --> 00:27:15,520
effectively calls impact capture
understanding protocols well enough to

413
00:27:15,520 --> 00:27:19,090
break them out asked a wireshark
bisector trying to understand it warm

414
00:27:19,090 --> 00:27:23,199
and then determining the legitimacy of
those function codes so that's sort of a

415
00:27:23,200 --> 00:27:27,070
process that they might go through maybe
think about it sounds very simplistic at

416
00:27:27,070 --> 00:27:31,450
that high-level think about all the
components that go into actually testing

417
00:27:31,450 --> 00:27:35,620
it that's where a lot of folks get sort
of in trouble and another flaw that i

418
00:27:35,620 --> 00:27:40,330
see you a lot of more junior hunters is
they'll start off thinking about the

419
00:27:40,330 --> 00:27:42,580
test weighs more than anything out

420
00:27:42,580 --> 00:27:48,158
they get so technical that they think on
proxies and they never came up with a

421
00:27:48,159 --> 00:27:51,820
really good idea about why they were
doing in the first place that a lot of

422
00:27:51,820 --> 00:27:56,139
circles can influence what governments
will call the cell floating ice cream

423
00:27:56,140 --> 00:28:00,519
cone or they do stop over and over again
it's really not benefiting anybody but

424
00:28:00,519 --> 00:28:03,220
they think they're doing the right thing
with aren't looking at ice cream cone to

425
00:28:03,220 --> 00:28:09,250
us feel good i'm so let's jump into the
ICS portion little Bobby here says is

426
00:28:09,250 --> 00:28:13,539
unfair that china is always getting
blamed for computer breeches and matt

427
00:28:13,539 --> 00:28:17,860
says yeah other countries do the same or
similar activities and you know what we

428
00:28:17,860 --> 00:28:21,879
have to keep an open mind and keep
critical of the data little body says

429
00:28:21,880 --> 00:28:26,350
okay so which country is most
responsible that it was time so I do

430
00:28:26,350 --> 00:28:29,019
want to note that you know as we start
talking about the industrial control

431
00:28:29,019 --> 00:28:33,100
system aspect one of the things that I
really want to leave you with is we do

432
00:28:33,100 --> 00:28:38,918
not fully understand the ICS threat
landscape lot reporting a lot of folks

433
00:28:38,919 --> 00:28:42,190
doing some good work in the community
who is fully don't understand what's

434
00:28:42,190 --> 00:28:45,880
going on these environments so to sort
of articulate this this usually is a

435
00:28:45,880 --> 00:28:51,039
pretty good slide to do so from the ICS
serves annual reporting can anybody pick

436
00:28:51,039 --> 00:28:54,039
out what's wrong with this first graph
or what would stick out in your mind

437
00:28:55,389 --> 00:28:59,019
exactly yeah so for the rest of the
audience would be noted was the high

438
00:28:59,019 --> 00:29:03,460
percentage of unknown every single year
with these metrics come out I wouldn't

439
00:29:03,460 --> 00:29:06,730
say that the best metrics but they are
the authoritative one the community in

440
00:29:06,730 --> 00:29:11,139
terms of a central repository every
single year the number one attack vector

441
00:29:11,139 --> 00:29:13,418
into ICS is unknown

442
00:29:13,419 --> 00:29:17,260
they have no idea how I got let alone if
they're actually cleaning it up

443
00:29:17,260 --> 00:29:19,990
correctly you didn't know what the
infection vector was it would be very

444
00:29:19,990 --> 00:29:24,429
hard to say with a matter of fact you
actually pointed out the second-highest

445
00:29:24,429 --> 00:29:27,460
attack vector into an ICS every year

446
00:29:27,460 --> 00:29:30,460
spearfishing what's wrong with that

447
00:29:31,240 --> 00:29:34,240
that's absolutely on the business side
the network we don't have email servers

448
00:29:34,240 --> 00:29:39,700
inside of skate environment so when we
see stop get into an ICS were detecting

449
00:29:39,700 --> 00:29:44,380
it in the business networks coming
through the DMZ not in the ICS itself

450
00:29:44,380 --> 00:29:48,250
and when we actually do understand what
the attack vector is something like a

451
00:29:48,250 --> 00:29:52,240
spear phishing email which we don't have
on the icsid itself as well so i would

452
00:29:52,240 --> 00:29:55,049
put off to you that even though we've
got a lot of people

453
00:29:55,049 --> 00:29:58,769
it's really good work in the community
we're not historically getting into

454
00:29:58,769 --> 00:30:02,850
those environments in collecting data
and understanding what's going on as

455
00:30:02,850 --> 00:30:06,539
another way to sort of break this down
we think of those big vendors who have

456
00:30:06,539 --> 00:30:10,649
right intelligence is not just indicated
a compromise right that understanding of

457
00:30:10,649 --> 00:30:15,418
patterns of delicious data-related
adversary intrusions I what we're seeing

458
00:30:15,419 --> 00:30:20,220
though is the big companies that are 80
companies or instant response companies

459
00:30:20,220 --> 00:30:24,299
the folks who have had access to
intrusion data into lots of companies

460
00:30:24,299 --> 00:30:28,168
they're able to extract out those
patterns knowledge in ICS there is no

461
00:30:28,169 --> 00:30:29,129
such thing

462
00:30:29,129 --> 00:30:33,539
there are no teams out there new
companies are included nobody who has a

463
00:30:33,539 --> 00:30:37,679
large repository events response data
and ICS violence community doesn't like

464
00:30:37,679 --> 00:30:42,419
to share and at the same time we have
not historically had antivirus and IDS's

465
00:30:42,419 --> 00:30:46,049
and things reporting out industrial
controls environments so none of the

466
00:30:46,049 --> 00:30:49,830
vendors actually have everything that
you would hope they would have that they

467
00:30:49,830 --> 00:30:52,109
historically have done for IT networks

468
00:30:52,109 --> 00:30:55,379
it's one of the gaps that we have one of
the reasons that threat hunting

469
00:30:55,379 --> 00:30:59,939
specifically is so important and that
open-mindedness is so important in ICS

470
00:30:59,940 --> 00:31:03,210
environments because we're coming up
against things that we do not know what

471
00:31:03,210 --> 00:31:08,429
to expect to kind of place back to the
to that sliding scale of being able to

472
00:31:08,429 --> 00:31:11,940
kind of start from the basics of the of
the architecture infrastructure peace

473
00:31:11,940 --> 00:31:16,350
and build that out so we're noticing
that it happens it's been happening for

474
00:31:16,350 --> 00:31:20,399
a long time in the i.t side but on the
OT side it's it's really becoming more

475
00:31:20,399 --> 00:31:22,110
of a

476
00:31:22,110 --> 00:31:26,580
it's the awareness is really being
raised by guessing the marketplace for

477
00:31:26,580 --> 00:31:30,809
it in certain facilities and companies
are definitely taking it on

478
00:31:30,809 --> 00:31:35,639
absolutely let's take to vacation days
that i would call height and look at

479
00:31:35,640 --> 00:31:38,520
some real ones i've got some real case
studies from instant response will take

480
00:31:38,520 --> 00:31:41,970
a look at so this one was one of the
first ones that gained a lot of media

481
00:31:41,970 --> 00:31:45,480
attention i saw 2010 could make it
through an ICS presentation without

482
00:31:45,480 --> 00:31:49,170
saying the word Stuxnet who doesn't work
you know 2010 stocks that happened in

483
00:31:49,170 --> 00:31:53,040
Iran everyone was like our state is a
thing I and people start getting

484
00:31:53,040 --> 00:31:58,559
interested so in 2011 when we heard
about potential other bridge it made

485
00:31:58,559 --> 00:32:03,600
national level news and there was this
water facility in Illinois I'm that

486
00:32:03,600 --> 00:32:07,860
potentially got optimized in the state
fusion center put out a report that said

487
00:32:07,860 --> 00:32:13,830
or Russian cyber attack took down a
water pump in Illinois which if that was

488
00:32:13,830 --> 00:32:17,580
the big bang that we were waiting for
like a single water pump feeling and

489
00:32:17,580 --> 00:32:21,960
water utility like we want
congratulations but everyone's concerned

490
00:32:21,960 --> 00:32:27,630
about it but it turns out that it was
was the contractor learned from the

491
00:32:27,630 --> 00:32:32,010
national media reporting about the
incident the contractor was the one that

492
00:32:32,010 --> 00:32:37,080
remoted in to the environment while on
vacation in Russia and remote into the

493
00:32:37,080 --> 00:32:41,460
environment and made some changes and
then like three months later the pump

494
00:32:41,460 --> 00:32:45,870
failed and so the analyst on scene were
like wow russia IP address the logs from

495
00:32:45,870 --> 00:32:48,959
three months ago and pop just failed
obviously those things are related

496
00:32:49,679 --> 00:32:54,270
I'm obviously that's a misapplication of
causal analysis they're not related but

497
00:32:54,270 --> 00:32:57,900
you can see that a lot of people wanting
to do good in these environments and

498
00:32:57,900 --> 00:33:01,980
maybe not fully understanding the
environment themselves i poured a little

499
00:33:01,980 --> 00:33:04,320
bit hyper gets pushed out there in the
community

500
00:33:04,320 --> 00:33:08,668
probably the one of the bigger cases
it's very hard to kill as the BTC

501
00:33:08,669 --> 00:33:14,820
pipeline case so in 2008 at BTC pipeline
and Turkey was attacked

502
00:33:14,820 --> 00:33:18,899
there was a attack on it was an
explosion and at the time the Turkish

503
00:33:18,900 --> 00:33:23,880
government reached out and said it was
these extremists and extremist replied

504
00:33:23,880 --> 00:33:27,480
yes it was us and then seven years later

505
00:33:27,480 --> 00:33:32,600
Bloomberg came out the big article media
said no it was a cyberattack and it was

506
00:33:32,600 --> 00:33:37,189
Russians I and the problem with that I
don't blame the reporters don't think

507
00:33:37,190 --> 00:33:41,180
they were doing necessarily hurtful
things on purpose but part of the

508
00:33:41,180 --> 00:33:44,990
problem with this was that incident
responders miss let them into believing

509
00:33:44,990 --> 00:33:48,170
that this was a thing and they didn't
understand the environments well enough

510
00:33:48,170 --> 00:33:52,490
they're not industrial control system
experts to push back on all the things

511
00:33:52,490 --> 00:33:56,420
that are being said it didn't make sense
the environment as an example the story

512
00:33:56,420 --> 00:33:59,960
goes that the adversary found
internet-connected surveillance

513
00:33:59,960 --> 00:34:02,870
equipment that was monitoring the
control system environment they

514
00:34:02,870 --> 00:34:06,199
compromised internet-connected
surveillance equipment they pivoted over

515
00:34:06,200 --> 00:34:10,040
into the control center they blocked the
satellite communications the control

516
00:34:10,040 --> 00:34:14,929
center has a backup relay they went down
to the compressor stations and they

517
00:34:14,929 --> 00:34:19,219
changed the alerting and they change the
pressure on compressor stations to allow

518
00:34:19,219 --> 00:34:24,020
the pipeline to blow up and three later
three days later it at the problem that

519
00:34:24,020 --> 00:34:27,380
story besides the fact that there's just
no way they got logs in that environment

520
00:34:28,100 --> 00:34:32,389
I wonder responder said they pulled
syslog from the type of controllers that

521
00:34:32,389 --> 00:34:36,290
were in that facility except for those
type of controllers didn't have syslog

522
00:34:36,290 --> 00:34:40,520
even as a feature you can enable until
$MONTH 2013 so definitely wasn't taking

523
00:34:40,520 --> 00:34:45,770
place in 2008 I the other thing that
really sort of setting apart was the

524
00:34:45,770 --> 00:34:49,909
Turkish government had installed the
cameras after the attack in response to

525
00:34:49,909 --> 00:34:54,109
the attack so it couldn't have been the
attack and of course we have tnt and

526
00:34:54,110 --> 00:34:57,290
benchmarks and physical cameras
understanding that extremists come up

527
00:34:57,290 --> 00:35:01,820
the pipeline but you can again see how
it's very very sort of a prolific that

528
00:35:01,820 --> 00:35:04,910
hype will generate this community very
quickly when people are interested

529
00:35:04,910 --> 00:35:07,850
obviously and things like national
infrastructure should explain what a

530
00:35:07,850 --> 00:35:11,390
cyberattack on IITs actually looks like
a little bit of repeat yesterday but

531
00:35:11,390 --> 00:35:16,190
we'll bring it to a new . I'm why
developed a model called the ICS several

532
00:35:16,190 --> 00:35:20,780
change John was doing here my curiosity
how many people know of the cyber kill

533
00:35:20,780 --> 00:35:26,690
chain the regular one yeah its
traditional other one being so all of

534
00:35:26,690 --> 00:35:29,570
these spaces all of these actions still
take place

535
00:35:29,570 --> 00:35:33,650
it's not anything magically different in
ICS environment with the exception of

536
00:35:33,650 --> 00:35:38,030
when you're actually talking about being
able to have influenced being able to

537
00:35:38,030 --> 00:35:43,310
either manipulate or take down or deny
in an actual control system you're gonna

538
00:35:43,310 --> 00:35:46,210
have to do a bit more work than just
getting foot

539
00:35:46,210 --> 00:35:50,530
getting a foothold in keeping that
foothold into an environment so the

540
00:35:50,530 --> 00:35:53,349
actual piece that we wanted to kind of
highlight is the second phase of that

541
00:35:53,349 --> 00:35:59,140
when you're actually being able to being
able to either exhale data out of an

542
00:35:59,140 --> 00:36:01,960
environment to learn about what's
happening in that when you get into

543
00:36:01,960 --> 00:36:07,060
actual control systems a lot of i should
say uh a lot of the red team's a lot of

544
00:36:07,060 --> 00:36:11,170
a lot of nation-states might not
necessarily have the expertise to go in

545
00:36:11,170 --> 00:36:15,760
and turn off the water pump i turn off a
generator just because they simply don't

546
00:36:15,760 --> 00:36:19,210
know how it works they don't know what
protocols are driving it they don't know

547
00:36:19,210 --> 00:36:22,089
what function codes are going to
actually make it turn off and what they

548
00:36:22,089 --> 00:36:25,299
don't want to do is basically just shut
everything down and lose their access so

549
00:36:25,300 --> 00:36:30,190
being able to define steps in the extra
work and just the amount of resources

550
00:36:30,190 --> 00:36:35,980
that it takes to be able to have a a an
actual defined effect in in and in ICS

551
00:36:35,980 --> 00:36:41,140
environment is very very challenging you
step through the phases of once you get

552
00:36:41,140 --> 00:36:46,480
into foothold being able to actually
develop and test your attack or be able

553
00:36:46,480 --> 00:36:51,760
to test to test what kind of effect
you're trying to have in the environment

554
00:36:51,760 --> 00:36:55,810
and then being able to actually deliver
that carry it out in a successful manner

555
00:36:55,810 --> 00:37:02,589
a lot of these environments are I would
say unstable but as a simple simple flip

556
00:37:02,589 --> 00:37:06,910
of a bit could change the entire process
what happens to change the entire

557
00:37:06,910 --> 00:37:11,379
control system itself so being able to
actually being able to actually do that

558
00:37:11,380 --> 00:37:16,570
correctly is extremely challenging and
how to add on here well we think of

559
00:37:16,570 --> 00:37:21,339
control system most people think was
very insecure you gave me control system

560
00:37:21,339 --> 00:37:24,099
i turn it off you just connect to the
network i'll turn off that that's

561
00:37:24,099 --> 00:37:28,300
entirely true i guarantee you you'll see
on a network in this environment and

562
00:37:28,300 --> 00:37:30,339
every one of you could figure out a way
to screw it

563
00:37:30,339 --> 00:37:34,450
no problem but you understand the
physical process that's going on

564
00:37:34,450 --> 00:37:37,810
understand the larger system of the
individual system is actually very

565
00:37:37,810 --> 00:37:42,190
typical especially remotely over some of
my pack so if you wanted to let's take a

566
00:37:42,190 --> 00:37:45,760
water distribution facilities example if
you wanted to take a water distribution

567
00:37:45,760 --> 00:37:50,020
facility and overflow the tanks you
might find human-machine interface that

568
00:37:50,020 --> 00:37:53,950
says like drive more water to this
location on water done and he would

569
00:37:53,950 --> 00:37:57,580
click on that is the attacker nothing
would happen you thinking like why

570
00:37:57,580 --> 00:37:58,700
wouldn't we

571
00:37:58,700 --> 00:38:02,960
because there's out two valves at that
location and their physical devices that

572
00:38:02,960 --> 00:38:05,780
are networked and they are connected to
the network and you wouldn't understand

573
00:38:05,780 --> 00:38:08,570
that without understanding the
engineering find the system and those

574
00:38:08,570 --> 00:38:12,410
altitude valves say hey there's already
too much water in the tank so have any

575
00:38:12,410 --> 00:38:14,810
more water trying to get pumped was
gonna flip the valve and it's going to

576
00:38:14,810 --> 00:38:19,099
bypass some of the location understand
that physical aspect is more engineering

577
00:38:19,099 --> 00:38:20,540
that is cyber promise

578
00:38:20,540 --> 00:38:23,690
so when necessary they've got to set
more so we think about this for a second

579
00:38:23,690 --> 00:38:28,160
I'm going to flip back and forth what
that basically says in ICS is we have an

580
00:38:28,160 --> 00:38:31,848
extended kill chain there's a longer
amount of time adversaries happen

581
00:38:31,849 --> 00:38:35,810
persist in our environment and more
steps they have to achieve to have a

582
00:38:35,810 --> 00:38:40,430
reliable effect inside of that part so
let's take a study of Ukrainians up

583
00:38:40,430 --> 00:38:43,368
being a perfect case study I was
fortunate enough to be one investigators

584
00:38:43,369 --> 00:38:46,790
on the great attack other for that i
wrote out its and that without the

585
00:38:46,790 --> 00:38:48,740
communities up and on the top there

586
00:38:48,740 --> 00:38:51,799
so what essentially happens is

587
00:38:51,800 --> 00:38:56,300
december $MONTH twenty-third 2015 a
cyberattack took down portions of

588
00:38:56,300 --> 00:39:01,190
Ukrainian power grid specifically three
different regions six months before that

589
00:39:01,190 --> 00:39:05,030
adversaries set phishing emails that did
the sort of the normal thing since

590
00:39:05,030 --> 00:39:09,530
phishing emails i had a word document
word document at macros on it

591
00:39:09,530 --> 00:39:13,339
the email was like hey guys do you want
some more features just enable macros

592
00:39:13,339 --> 00:39:16,609
and people like I told a lot more
features click and blackened degree drop

593
00:39:16,609 --> 00:39:21,259
the system likely three started wiping
off information especially related the

594
00:39:21,260 --> 00:39:25,970
user credentials associate with VBS from
there the adversaries use the VPN to get

595
00:39:25,970 --> 00:39:30,230
into the ICS environment while there
they spent the majority of that six

596
00:39:30,230 --> 00:39:34,010
months learning that environment
understanding how it works

597
00:39:34,010 --> 00:39:37,579
each one of those open air goes or
control centers had a different

598
00:39:37,579 --> 00:39:41,300
distribution management system so they
learn how to interrupt but how to

599
00:39:41,300 --> 00:39:44,810
interact on those three different
distribution management systems when it

600
00:39:44,810 --> 00:39:48,380
came time for the attack they also
identified that there are serial to

601
00:39:48,380 --> 00:39:52,640
ethernet gateways the serial internet
gateways communicate ethernet based

602
00:39:52,640 --> 00:39:56,720
protocols the control center to the
physically separated cereal running

603
00:39:56,720 --> 00:40:00,078
control system that the substations so
it acts as a bridge between the control

604
00:40:00,079 --> 00:40:04,609
center of the substation they found that
they developed malicious firmware every

605
00:40:04,609 --> 00:40:08,328
one of those devices so that when it
came time for the attack they went down

606
00:40:08,329 --> 00:40:11,360
use the distribution management system
against the ICS

607
00:40:11,360 --> 00:40:15,320
that malware that took down the power
plant got power in that environment they

608
00:40:15,320 --> 00:40:20,030
use the system itself against itself
then they blew the bridges by doing the

609
00:40:20,030 --> 00:40:24,860
firmware updates to the serial Ethernet
devices which left the responders unable

610
00:40:24,860 --> 00:40:28,310
to remotely access those controlled
environments they have sent people out

611
00:40:28,310 --> 00:40:31,730
each one of them to manually operate
portions of the grid to return

612
00:40:31,730 --> 00:40:32,870
electricity back on

613
00:40:32,870 --> 00:40:37,100
and in addition I just because why not
they went through the environment found

614
00:40:37,100 --> 00:40:41,750
network-connected ups devices and then
shut those to go offline and drop the

615
00:40:41,750 --> 00:40:46,520
interface so the power go out control
center as well and they lost the denali

616
00:40:46,520 --> 00:40:50,840
telephone service against all the call
centers so a lot of stuff going on for

617
00:40:50,840 --> 00:40:54,530
these defenders and actually responded
very well let's talk about the sort of

618
00:40:54,530 --> 00:40:59,210
the hunting aspects of it you know for
these ICS environments there's a lot of

619
00:40:59,210 --> 00:41:03,890
smaller more static environment that we
deal with data collection and good

620
00:41:03,890 --> 00:41:08,060
hypothesis generation or two of the most
important things to get through once you

621
00:41:08,060 --> 00:41:11,540
have the data there's a lot of things
that will stand out as abnormal as the

622
00:41:11,540 --> 00:41:15,980
example I in the environment if you have
black energy three deployed that

623
00:41:15,980 --> 00:41:19,610
actually made it into the ICS you'd find
that one of the first things it does is

624
00:41:19,610 --> 00:41:25,640
reach out to microsoft.com msdn com.com
things like that that all our does our

625
00:41:25,640 --> 00:41:29,810
most power does for internet checking
the problem is there's no way that would

626
00:41:29,810 --> 00:41:33,049
happen in ICS normal should have
internet checking going on inside the

627
00:41:33,050 --> 00:41:39,470
ICS we should never see being a common
is if you ever see . common is you are

628
00:41:39,470 --> 00:41:44,990
compromised forget there's your number
100 active same thing here we see is

629
00:41:44,990 --> 00:41:48,680
going over ntp but ntp network Time
Protocol right so we're trying to get

630
00:41:48,680 --> 00:41:54,470
checks accepted most ICS locations
utilize GPS isn't very high reliability

631
00:41:54,470 --> 00:41:57,890
of time synchronization we definitely
would be going to microsoft.com to get

632
00:41:57,890 --> 00:42:01,129
the time server we do an internal time
server that was likely linked up GPS

633
00:42:01,130 --> 00:42:06,560
very simple things that stand out if you
had the situation awareness for the

634
00:42:06,560 --> 00:42:08,870
domain expertise of that environment

635
00:42:08,870 --> 00:42:13,430
I in terms of the chart over here that
is a simple io chart of doing a remote

636
00:42:13,430 --> 00:42:17,690
firmware update across the control
system network is anybody or anybody

637
00:42:17,690 --> 00:42:19,810
without me explaining what control
system around

638
00:42:19,810 --> 00:42:23,680
network can you spot look for more
update right it should be kind of

639
00:42:23,680 --> 00:42:26,080
obvious and i'm going to give out
anything for this because I hope

640
00:42:26,080 --> 00:42:31,240
everyone understand that there's a big
jump in the i/o and the bandwidth on

641
00:42:31,240 --> 00:42:35,589
this network these networks are doing
things that normal enterprise networks

642
00:42:35,590 --> 00:42:40,720
do I wouldn't expect to see a controller
going out to twitter using the sides

643
00:42:40,720 --> 00:42:45,609
augusta hashtags right so it has very
set patterns and data flows and things

644
00:42:45,610 --> 00:42:50,650
that it's doing alright let's take
another one as an example for another

645
00:42:50,650 --> 00:42:54,760
case study that we have so there's a
utility one out to that had they had

646
00:42:54,760 --> 00:42:58,270
identified that can figure running on
the network just like just about every

647
00:42:58,270 --> 00:43:03,970
organization in the world they found out
they weren't able to determine the

648
00:43:03,970 --> 00:43:07,660
actual infection vector why it was there
in the first place they tried

649
00:43:07,660 --> 00:43:08,770
remediating it

650
00:43:08,770 --> 00:43:11,890
it kept coming back and they just
couldn't figure out what the heck was

651
00:43:11,890 --> 00:43:15,310
going on so as part of the process of
actually trying to help them do that

652
00:43:15,310 --> 00:43:20,680
trying to hunt we started with a
hypothesis generation so we've listed

653
00:43:20,680 --> 00:43:25,000
three up here on the board basically the
customers infecting themselves either

654
00:43:25,000 --> 00:43:28,540
the vendor was remoting in for some
reason the vendor was infected and they

655
00:43:28,540 --> 00:43:33,550
were passing that on as well or they had
or maybe they had some sort of some sort

656
00:43:33,550 --> 00:43:38,350
of transient mobile devices that were
coming they're coming and going from the

657
00:43:38,350 --> 00:43:42,880
network that were infected and I guess
based on the picture of matter cars up

658
00:43:42,880 --> 00:43:46,420
here if anybody could take a guess as to
which one of these hypothesis was

659
00:43:46,420 --> 00:43:47,260
correct

660
00:43:47,260 --> 00:43:55,540
we have a pricey but this is various
regions right yes the first ones the

661
00:43:55,540 --> 00:43:57,580
customers affected itself that's not it

662
00:43:57,580 --> 00:44:00,850
next I there's like everybody had their
hands up when we go to you in the blue

663
00:44:00,850 --> 00:44:02,259
because you're like right in front of me

664
00:44:02,260 --> 00:44:08,950
yeah that note was not the vendors so
we're gonna hold off on the great job

665
00:44:10,090 --> 00:44:13,660
so what ended up being in this
environment is it all those are very

666
00:44:13,660 --> 00:44:17,529
reasonable those happen all the time the
person's infected themselves or the

667
00:44:17,530 --> 00:44:21,850
vendors doing it we see a lot of those
infections but actually it was the fact

668
00:44:21,850 --> 00:44:25,810
that at this facility they had line
trucks that use windows XP embedded

669
00:44:25,810 --> 00:44:29,170
systems and they were connected the Y
pot and so the answer responders would

670
00:44:29,170 --> 00:44:32,890
come down remote in clean up the
conflict on the network the trucks drive

671
00:44:32,890 --> 00:44:36,730
way they clean everything up they leave
and the trucks drive back with Benny

672
00:44:36,730 --> 00:44:41,170
Hill theme song and that network right
so I was unfortunate for them but it was

673
00:44:41,170 --> 00:44:44,350
important to understand going through
that process hypothesis generation but

674
00:44:44,350 --> 00:44:47,770
not only what's most likely which these
two folks got those would be the most

675
00:44:47,770 --> 00:44:51,640
likely ones but also the type of data
and the type of collection and the type

676
00:44:51,640 --> 00:44:55,270
of logs and system analysis you would
need to determine what was the actual

677
00:44:55,270 --> 00:44:58,300
infection factor just think about what
all goes into doing that

678
00:44:58,900 --> 00:45:01,990
alright let's take another one it uses
when you see this getting my favorite

679
00:45:01,990 --> 00:45:08,979
one so we had this nordic wind bar this
wind farm somewhere in the North i was

680
00:45:08,980 --> 00:45:13,240
operating the turbines you see here
versus similar ones and each of these

681
00:45:13,240 --> 00:45:17,319
turbines they have windows embedded or
Windows systems operate and they have

682
00:45:17,320 --> 00:45:21,250
like my small terminals form and they
had this problem that they were seeing

683
00:45:21,250 --> 00:45:25,420
abnormal behavior so what was the
detection vector the Admiral behavior

684
00:45:25,420 --> 00:45:26,110
they're seeing

685
00:45:26,110 --> 00:45:31,150
well the systems were passing themselves
definitely weird right so nobody was

686
00:45:31,150 --> 00:45:34,000
initiating patching the environment yet
the system's themselves are being passed

687
00:45:34,000 --> 00:45:38,890
to maintain so these hypotheses were
generated maybe I t wasn't communicating

688
00:45:38,890 --> 00:45:41,770
to the operations technology folks
they're just going out and doing passion

689
00:45:41,770 --> 00:45:46,330
which is entirely likely or rogue
operators were patching the systems like

690
00:45:46,330 --> 00:45:50,560
that guys are breaking in and they just
wanted to be super friendly or it was

691
00:45:50,560 --> 00:45:55,240
actually the adversaries themselves not
your rogue folks inside your company i

692
00:45:55,240 --> 00:45:57,189
doing the passing the system

693
00:45:57,190 --> 00:46:00,460
ok we'll do it another one that I which
one was it

694
00:46:00,460 --> 00:46:03,520
yeah alright i was very attached
themselves

695
00:46:04,300 --> 00:46:12,430
alright well what this ended up being
was the adversaries have gotten the

696
00:46:12,430 --> 00:46:16,240
environment found out this the perfect
environment to Bitcoin mining and they

697
00:46:16,240 --> 00:46:20,109
were using the spare process-based to
Bitcoin mining on the system's and as a

698
00:46:20,110 --> 00:46:23,020
way to defend it against other
adversaries they're keeping the system

699
00:46:23,020 --> 00:46:30,190
past maintain now there's a sad part of
the outline change control copy change

700
00:46:30,190 --> 00:46:31,420
control absolutely

701
00:46:31,420 --> 00:46:36,580
I downside is despite all the
recommendations possible they decided to

702
00:46:36,580 --> 00:46:37,779
leave the atmosphere

703
00:46:37,780 --> 00:46:42,280
yeah that was what that sink in for a
second they decided that the adversaries

704
00:46:42,280 --> 00:46:43,380
packaging systems more

705
00:46:43,380 --> 00:46:47,880
effectively with less failures in the IT
department so they weapon

706
00:46:48,569 --> 00:46:53,759
don't do that alright alright so we got
another one here as well just go through

707
00:46:53,759 --> 00:46:57,869
these are closing out here this is a
naval ship this one's there's a small

708
00:46:57,869 --> 00:47:01,410
reference to the public community but
this one is not very much discussed but

709
00:47:01,410 --> 00:47:05,759
there was a non us-based naval ship that
sense of control systems that went

710
00:47:05,759 --> 00:47:10,619
offline they lost access portion control
Network I'm and so when trying to figure

711
00:47:10,619 --> 00:47:13,740
out what malware was involved in what
was causing it

712
00:47:13,740 --> 00:47:17,879
they generate hypotheses one hypothesis
was direct interaction from the

713
00:47:17,880 --> 00:47:21,119
adversary over remote connection be the
satellite communications somebody

714
00:47:21,119 --> 00:47:23,789
actually came in interactive systems
took a nap

715
00:47:23,789 --> 00:47:27,750
that's a scary thing special shit right
the second thing was that not really

716
00:47:27,750 --> 00:47:32,039
plugged into USB and infect the network
malware spreading around took down sense

717
00:47:32,039 --> 00:47:36,329
of control system and the third was at
target malware embedded in the supply

718
00:47:36,329 --> 00:47:40,289
chain right embedded in the controls
themselves finally activated so went

719
00:47:40,289 --> 00:47:43,259
through this process and what they end
up recovering this is not one that we

720
00:47:43,259 --> 00:47:46,079
actually got to be involved with but
what the end of uncovering was that it

721
00:47:46,079 --> 00:47:50,009
was just simply the operator but to
understand that they had to go in full

722
00:47:50,009 --> 00:47:53,579
registry keys they have to understand
the USB plug ins where they're being

723
00:47:53,579 --> 00:47:56,940
plugged in around the environment and
they had to track down the USB and

724
00:47:56,940 --> 00:48:00,000
figure out what our was on it so they
can analyze the initial infection vector

725
00:48:00,000 --> 00:48:03,960
again from simple hypothesis generation
each one of these are going to take you

726
00:48:03,960 --> 00:48:08,490
down a different path collection and
different path of a bizarre activity now

727
00:48:08,490 --> 00:48:12,180
once you figure out any of the ones that
we went through you can figure out

728
00:48:12,180 --> 00:48:15,808
remediation of that you can automate
that process out of either detecting or

729
00:48:15,809 --> 00:48:18,990
blocking that activity the future and
that's what a good hunter should and

730
00:48:18,990 --> 00:48:22,828
will do they automate their previous
hunt if you're that mature level so you

731
00:48:22,829 --> 00:48:26,039
have to do this every single time and
want to play whack-a-mole we want to

732
00:48:26,039 --> 00:48:29,430
continually push our security to get
better and better in our environments so

733
00:48:29,430 --> 00:48:32,879
we'll leave you with some of the sample
hypotheses I'm gonna do a recap and exit

734
00:48:32,880 --> 00:48:37,650
out here I'm going John sure so in a
nice environment and I think we

735
00:48:37,650 --> 00:48:40,950
mentioned a lot of these already but mom
in a typical control system environment

736
00:48:40,950 --> 00:48:45,480
you might not necessarily want to see
your should see internet traffic so it's

737
00:48:45,480 --> 00:48:49,109
it's a pretty simple thing to to detect
as long as you're as long as you're

738
00:48:49,109 --> 00:48:52,380
looking for your setup to do collection
and actually monitor see that's

739
00:48:52,380 --> 00:48:56,700
happening or not but it could be a very
very big indicator that something bad

740
00:48:56,700 --> 00:48:59,669
it's happening in your environment and a
pretty quick way to go back and actually

741
00:48:59,670 --> 00:49:03,000
trace it down to figure out what's going
on being . com

742
00:49:03,000 --> 00:49:08,310
ok yeah so I another one is absurd one
hypothesis i usually operate under is

743
00:49:08,310 --> 00:49:12,299
that adversaries will gravitate towards
the HMI you machine interface would be

744
00:49:12,300 --> 00:49:15,930
very difficult to learn the process the
physical things that are ongoing without

745
00:49:15,930 --> 00:49:19,890
things like engineering documents but
one easy big as a human interface it

746
00:49:19,890 --> 00:49:23,190
will show you the layout of the facility
everything that's ongoing is a water

747
00:49:23,190 --> 00:49:26,910
facilities and electric facility what
type of systems are using to get a lot

748
00:49:26,910 --> 00:49:31,078
of information and also it's not some
weird embedded system usually windows

749
00:49:31,079 --> 00:49:34,740
system that adversaries are typically
used to and that system that can

750
00:49:34,740 --> 00:49:38,669
actually interact with an operating
environment so good hypothesis is that

751
00:49:38,670 --> 00:49:44,700
if you have an infection you might want
to start at the I HMI first patching and

752
00:49:44,700 --> 00:49:47,790
updating like one of the case studies
that he said in controlled environments

753
00:49:47,790 --> 00:49:53,099
usually very very well organized and
planned out having down time in a

754
00:49:53,099 --> 00:49:57,599
production environment is usually kept
to minimal and it is done in very

755
00:49:57,599 --> 00:50:00,960
controlled manner so if you think about
catching happening updates happening

756
00:50:00,960 --> 00:50:05,310
that aren't scheduled or that either
haven't been fully tested so a lot of

757
00:50:05,310 --> 00:50:10,529
times we'll run you run order firmware
on all devices specifically because if

758
00:50:10,530 --> 00:50:13,500
you update them they might not work in
your environment so all that stuff's

759
00:50:13,500 --> 00:50:17,280
very controlled so if you're generating
hypotheses that if I see updates icy

760
00:50:17,280 --> 00:50:22,920
patches that's probably that's probably
malicious or that's something that's out

761
00:50:22,920 --> 00:50:25,980
of the normal that we should look into
another one would be an atmosphere in

762
00:50:25,980 --> 00:50:30,780
the network exfiltrating out-processed
orientated my hypothesis is I've got an

763
00:50:30,780 --> 00:50:34,109
atmosphere in the network there exhaling
out process of storing data so I'd have

764
00:50:34,109 --> 00:50:37,259
to figure out where on the network that
collects where I could actually put in

765
00:50:37,260 --> 00:50:40,589
some sort of monitoring capabilities
block packet capture flow data and then

766
00:50:40,589 --> 00:50:44,970
go through and check my process of
storing data if I'm seeing more of that

767
00:50:44,970 --> 00:50:48,419
system beginning out of communicating at
the network that processes story is

768
00:50:48,420 --> 00:50:52,170
going to tell me what everything that is
physical environments doing tell me

769
00:50:52,170 --> 00:50:55,290
things like frequency or water levels
and things like that that necessary

770
00:50:55,290 --> 00:50:59,160
would need to know if they wanted to
achieve the stage to style attack and if

771
00:50:59,160 --> 00:51:02,370
we refer back to the ICS kill chain
model

772
00:51:02,370 --> 00:51:06,150
that the first space that's built into
the second stages is doing

773
00:51:06,150 --> 00:51:08,970
reconnaissance doing your background
check and your background checks about

774
00:51:08,970 --> 00:51:12,629
doing reconnaissance and basically
learning the environment that you're in

775
00:51:12,630 --> 00:51:17,940
trying to get into a lot of times we'll
we'll go on label or will generate

776
00:51:17,940 --> 00:51:21,750
hypotheses that says wherever we keep
our engineering documents is probably

777
00:51:21,750 --> 00:51:25,560
very likely target for an adversary will
be able to set up monitoring around that

778
00:51:25,560 --> 00:51:28,770
and the interesting thing there's a lot
of environments for engineering

779
00:51:28,770 --> 00:51:32,820
documents aren't on the ICS to actually
find that your interesting documents

780
00:51:32,820 --> 00:51:36,720
could even be in contractor networks and
third-party networks so is your ICS

781
00:51:36,720 --> 00:51:40,140
security staff getting notified if the
contractor gets compromised and they

782
00:51:40,140 --> 00:51:43,109
lose engineering documents related to
your infrastructure is your integrated

783
00:51:43,110 --> 00:51:46,680
optimize how might that be affecting you
have an adversary try to come after you

784
00:51:46,680 --> 00:51:50,700
that two-stage kill chain doesn't have
to happen just in your environment so in

785
00:51:50,700 --> 00:51:54,750
recap hunting is a process of humans
actively searching for a series of

786
00:51:54,750 --> 00:51:59,040
systems it is a very human based process
their hunting itself balls not active

787
00:51:59,040 --> 00:52:03,690
defense category good threat hunting
begins with a hypothesis a testable idea

788
00:52:03,690 --> 00:52:07,320
going to drive how you do everything
else that environment and then lastly

789
00:52:07,320 --> 00:52:11,790
hunting regrets and ICS is absolutely
important not for security aspects

790
00:52:11,790 --> 00:52:15,900
necessarily but for improving the safety
reliability those operations so we have

791
00:52:15,900 --> 00:52:19,110
little Bobby here and are used this one
specifically because you're always

792
00:52:19,110 --> 00:52:22,950
concerned as a speaker what people take
away for you saying so want to know a

793
00:52:22,950 --> 00:52:25,950
little body one that he doesn't quite
take away the right thing

794
00:52:26,490 --> 00:52:31,770
little Bobby says Matt virtualized skate
a system that's like absolutely you know

795
00:52:31,770 --> 00:52:35,220
engineering work stations operating
station the actual supervisory stuff

796
00:52:35,220 --> 00:52:38,549
that's windows-based totally you
actually do that and help out its

797
00:52:38,550 --> 00:52:40,620
response help out a lot of things

798
00:52:40,620 --> 00:52:45,180
little Bobby says schools virtual state
in the cloud no that's not what I meant

799
00:52:45,180 --> 00:52:45,899
at all

800
00:52:45,900 --> 00:52:50,100
so with that I have to do one more
little Bobby is that we're giving away

801
00:52:50,100 --> 00:52:55,049
everything here matter expert says I
have to change my security fresh masses

802
00:52:55,050 --> 00:52:56,430
who called an expert

803
00:52:56,430 --> 00:53:00,899
well he did experts are people that are
recognized by the piers not necessarily

804
00:53:00,900 --> 00:53:06,810
themselves little boxes you have it also
said so as Twitter bio masses so no

805
00:53:06,810 --> 00:53:10,770
matter who tells you anything ourselves
included always be skeptical at least

806
00:53:10,770 --> 00:53:13,780
enough to go research it got a lot of
fantastic people between

807
00:53:13,780 --> 00:53:17,260
doing some great things a lot of good
research always do your own research on

808
00:53:17,260 --> 00:53:22,450
top of it though I got the car hacker's
handbook here donated by no starch press

809
00:53:22,450 --> 00:53:24,490
let's give this one away

810
00:53:24,490 --> 00:53:37,240
I name me the three types of hypotheses
that we discussed sur episode the

811
00:53:37,240 --> 00:53:42,339
manatees friendly or threat intelligence
and then the situational awareness so

812
00:53:42,340 --> 00:53:44,020
give her an applause and thank you so
much

