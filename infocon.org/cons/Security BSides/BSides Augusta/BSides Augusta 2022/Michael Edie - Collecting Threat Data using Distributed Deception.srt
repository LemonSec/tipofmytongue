1
00:00:12,240 --> 00:00:14,400
all right my check audio good

2
00:00:14,400 --> 00:00:16,800
all right awesome all right good

3
00:00:16,800 --> 00:00:18,420
afternoon welcome to besides I know this

4
00:00:18,420 --> 00:00:20,820
is like the end of day talk so hopefully

5
00:00:20,820 --> 00:00:23,699
I keep you entertained and uh don't bore

6
00:00:23,699 --> 00:00:25,199
you too much so I'm a senior security

7
00:00:25,199 --> 00:00:27,599
engineer working in the dod

8
00:00:27,599 --> 00:00:29,400
um this talk like uh was introduced as

9
00:00:29,400 --> 00:00:31,140
collecting threat data using distributed

10
00:00:31,140 --> 00:00:32,279
deception

11
00:00:32,279 --> 00:00:34,620
so who am I I've got a background in

12
00:00:34,620 --> 00:00:36,660
computer science uh spent some time in

13
00:00:36,660 --> 00:00:38,579
the military doing uh maintenance

14
00:00:38,579 --> 00:00:41,700
specifically on tank Vehicles so then I

15
00:00:41,700 --> 00:00:43,140
transitioned to cyber once the Army said

16
00:00:43,140 --> 00:00:45,180
hey we have this thing called cyber and

17
00:00:45,180 --> 00:00:46,680
we're looking for people that are

18
00:00:46,680 --> 00:00:49,200
interested in that so because I have a

19
00:00:49,200 --> 00:00:50,760
non-traditional path my nickname became

20
00:00:50,760 --> 00:00:52,200
the mechanic so you'll hear some people

21
00:00:52,200 --> 00:00:53,700
refer to me as the mechanic and that's

22
00:00:53,700 --> 00:00:55,620
that's the reason why

23
00:00:55,620 --> 00:00:57,899
um a few years ago I started this thing

24
00:00:57,899 --> 00:00:59,640
called smash the stack with a couple

25
00:00:59,640 --> 00:01:01,680
other people and I still run that to

26
00:01:01,680 --> 00:01:03,059
this day if you're familiar with over

27
00:01:03,059 --> 00:01:04,619
the wire it's kind of like that but a

28
00:01:04,619 --> 00:01:06,360
little more advanced so you can Google

29
00:01:06,360 --> 00:01:08,340
that and look that up and then I dabble

30
00:01:08,340 --> 00:01:10,380
in a little bit of cryptocurrency now

31
00:01:10,380 --> 00:01:11,700
when I'm not messing with anything

32
00:01:11,700 --> 00:01:13,380
technical I want to take a break from

33
00:01:13,380 --> 00:01:15,000
everything cyber

34
00:01:15,000 --> 00:01:17,460
I spend time with my family I'm riding

35
00:01:17,460 --> 00:01:20,759
my motorcycle or I am watching some kind

36
00:01:20,759 --> 00:01:22,979
of movie or fiction right specifically

37
00:01:22,979 --> 00:01:24,000
anime

38
00:01:24,000 --> 00:01:25,560
if you recognize any of those up there

39
00:01:25,560 --> 00:01:28,020
then you know kudos to you

40
00:01:28,020 --> 00:01:29,520
all right so we're collecting threat

41
00:01:29,520 --> 00:01:32,100
data using distributed deception what is

42
00:01:32,100 --> 00:01:34,860
threat data well threat data is anything

43
00:01:34,860 --> 00:01:38,220
like an IP address a URL malware right

44
00:01:38,220 --> 00:01:40,020
these are things that we call iocs

45
00:01:40,020 --> 00:01:43,020
that's basically threat data another way

46
00:01:43,020 --> 00:01:44,040
to put this right if there's

47
00:01:44,040 --> 00:01:45,299
non-technical people in the audience

48
00:01:45,299 --> 00:01:47,700
like a spouse or or a friend or whatever

49
00:01:47,700 --> 00:01:49,439
right if you're not into Tech think of

50
00:01:49,439 --> 00:01:51,960
it as like someone's trying to kill you

51
00:01:51,960 --> 00:01:54,060
that's threat data right you can't

52
00:01:54,060 --> 00:01:55,619
really do much with it to make it

53
00:01:55,619 --> 00:01:57,060
actionable you need to put some context

54
00:01:57,060 --> 00:01:58,259
around that

55
00:01:58,259 --> 00:01:59,880
so I'm collecting all this threat data

56
00:01:59,880 --> 00:02:01,439
and I'm storing it somewhere so we're

57
00:02:01,439 --> 00:02:02,700
going to talk about how am I collecting

58
00:02:02,700 --> 00:02:04,079
that

59
00:02:04,079 --> 00:02:05,759
the next part is this distributed

60
00:02:05,759 --> 00:02:08,520
deception piece now deception

61
00:02:08,520 --> 00:02:10,800
is I'm using a Honeypot essentially is

62
00:02:10,800 --> 00:02:12,060
what I'm doing right so there's a honey

63
00:02:12,060 --> 00:02:14,099
pot called kauri and I'm using that as

64
00:02:14,099 --> 00:02:16,260
the deception technology so threat actor

65
00:02:16,260 --> 00:02:18,000
logs into the system they think it's a

66
00:02:18,000 --> 00:02:20,220
real Linux system all the commands that

67
00:02:20,220 --> 00:02:21,660
they would do on another Linux system

68
00:02:21,660 --> 00:02:23,760
would work and I'm capturing all that

69
00:02:23,760 --> 00:02:26,099
information so they log in uh they're

70
00:02:26,099 --> 00:02:28,200
they're looking at files that see all

71
00:02:28,200 --> 00:02:29,520
that they're trying to X Bill things I

72
00:02:29,520 --> 00:02:30,840
see that they pull lender tools I'm

73
00:02:30,840 --> 00:02:32,220
capturing all of that right so they're

74
00:02:32,220 --> 00:02:33,480
being deceived into thinking in this

75
00:02:33,480 --> 00:02:35,340
actual legitimate system and the

76
00:02:35,340 --> 00:02:36,780
distributive portion of that is I'm

77
00:02:36,780 --> 00:02:38,520
putting these systems

78
00:02:38,520 --> 00:02:40,260
um all over the place so I have systems

79
00:02:40,260 --> 00:02:43,140
in Asia in the United States European

80
00:02:43,140 --> 00:02:44,459
Union

81
00:02:44,459 --> 00:02:46,319
um specifically like Finland Germany

82
00:02:46,319 --> 00:02:48,840
California for the United States and

83
00:02:48,840 --> 00:02:50,819
then India right so they're distributed

84
00:02:50,819 --> 00:02:52,560
all across the globe and they're

85
00:02:52,560 --> 00:02:54,180
collecting threat data which I explained

86
00:02:54,180 --> 00:02:55,860
earlier

87
00:02:55,860 --> 00:02:57,300
so here's the agenda for today right

88
00:02:57,300 --> 00:02:58,440
we're going to look at what's what is

89
00:02:58,440 --> 00:03:00,060
this architecture how am I collecting

90
00:03:00,060 --> 00:03:01,800
the threat data how is it distributed

91
00:03:01,800 --> 00:03:03,300
we're going to take a look at that we're

92
00:03:03,300 --> 00:03:05,220
going to look at the automations so if I

93
00:03:05,220 --> 00:03:06,840
spin up a Honeypot I'm not doing all

94
00:03:06,840 --> 00:03:08,160
these manually right think about having

95
00:03:08,160 --> 00:03:09,780
200 honeypots out there and having to

96
00:03:09,780 --> 00:03:11,580
manually configure install Linux

97
00:03:11,580 --> 00:03:13,980
configure the Honeypot whatever I'm

98
00:03:13,980 --> 00:03:15,420
using to extract data I'm configuring

99
00:03:15,420 --> 00:03:16,980
all that manually doing that 200 times

100
00:03:16,980 --> 00:03:18,900
that's you know 2022 that's not what we

101
00:03:18,900 --> 00:03:20,280
want to be doing so we're going to look

102
00:03:20,280 --> 00:03:22,140
at how do I automate all of this

103
00:03:22,140 --> 00:03:23,940
and then what are my observations this

104
00:03:23,940 --> 00:03:25,200
is probably the piece that most of you

105
00:03:25,200 --> 00:03:26,819
are interested in right how do what do

106
00:03:26,819 --> 00:03:28,140
you observing I've been doing this for

107
00:03:28,140 --> 00:03:29,700
about four years right so I started this

108
00:03:29,700 --> 00:03:31,739
a long time ago as like an individual

109
00:03:31,739 --> 00:03:33,659
research project I'm like hey I want to

110
00:03:33,659 --> 00:03:35,760
see what's happening out there yes you

111
00:03:35,760 --> 00:03:37,620
can go to you know malware archeology

112
00:03:37,620 --> 00:03:39,000
all these different sites and download

113
00:03:39,000 --> 00:03:40,200
malware

114
00:03:40,200 --> 00:03:41,640
um you can read reports but there's

115
00:03:41,640 --> 00:03:43,260
nothing better than like that primary

116
00:03:43,260 --> 00:03:45,000
research right it's like I know this

117
00:03:45,000 --> 00:03:47,159
occurs because I saw it right so that's

118
00:03:47,159 --> 00:03:48,540
kind of why I did this so it's been

119
00:03:48,540 --> 00:03:50,220
about four years and I said hey you know

120
00:03:50,220 --> 00:03:51,720
I can turn this into a talk and share

121
00:03:51,720 --> 00:03:53,400
the information with people that are

122
00:03:53,400 --> 00:03:55,319
interested so some of you may be

123
00:03:55,319 --> 00:03:56,700
interested in architecture and that's

124
00:03:56,700 --> 00:03:58,739
all you may be interested in how am I

125
00:03:58,739 --> 00:04:00,060
automating it and some of you might just

126
00:04:00,060 --> 00:04:01,980
care about hey what is he seeing

127
00:04:01,980 --> 00:04:03,120
and then we're going to look at some

128
00:04:03,120 --> 00:04:05,599
takeaways

129
00:04:05,640 --> 00:04:07,920
all right so it starts with the Honeypot

130
00:04:07,920 --> 00:04:10,080
right the deception technology every

131
00:04:10,080 --> 00:04:12,720
single Honeypot uses Kyrie which is a

132
00:04:12,720 --> 00:04:14,879
medium interaction honey pot you have

133
00:04:14,879 --> 00:04:16,798
low medium and high the higher you go

134
00:04:16,798 --> 00:04:18,358
the mean that means the more realistic

135
00:04:18,358 --> 00:04:20,579
it looks think of b-sides you find a

136
00:04:20,579 --> 00:04:22,440
laptop laying around somewhere you pick

137
00:04:22,440 --> 00:04:24,660
it up you open it up oh it's Windows 11.

138
00:04:24,660 --> 00:04:26,040
you start typing commands and they work

139
00:04:26,040 --> 00:04:28,380
the attacker scene is the same thing on

140
00:04:28,380 --> 00:04:30,979
the honey pot

141
00:04:31,080 --> 00:04:33,419
Splunk is how I extract the data so

142
00:04:33,419 --> 00:04:34,800
there's a Splunk Universal forwarder

143
00:04:34,800 --> 00:04:35,759
those of you that are familiar with

144
00:04:35,759 --> 00:04:37,979
Splunk it's the equivalent like win log

145
00:04:37,979 --> 00:04:39,600
beats or file beat it's the same thing

146
00:04:39,600 --> 00:04:40,919
right extracts the data from some

147
00:04:40,919 --> 00:04:42,900
endpoint and feeds that data to some

148
00:04:42,900 --> 00:04:44,820
centralized Sim so I'm using Splunk here

149
00:04:44,820 --> 00:04:45,840
because I have a lot of experience with

150
00:04:45,840 --> 00:04:47,759
spelunk and that's just what I use in

151
00:04:47,759 --> 00:04:49,259
this environment

152
00:04:49,259 --> 00:04:51,540
and then every single Honeypot is with a

153
00:04:51,540 --> 00:04:53,160
different provider so it's not like I

154
00:04:53,160 --> 00:04:55,860
spun up an AWS ec2 instance and they're

155
00:04:55,860 --> 00:04:57,419
all in AWS and they're in different

156
00:04:57,419 --> 00:04:59,460
regions it's a separate provider that's

157
00:04:59,460 --> 00:05:01,560
in for instance India so provider in

158
00:05:01,560 --> 00:05:03,780
India it's hosted there if it's in

159
00:05:03,780 --> 00:05:05,340
California it's a VPS provider in

160
00:05:05,340 --> 00:05:08,759
California within the United States

161
00:05:08,759 --> 00:05:10,020
um and of course like I said they're all

162
00:05:10,020 --> 00:05:12,600
running Linux either Ubuntu or Debian or

163
00:05:12,600 --> 00:05:14,220
some flavor of Linux so none of these

164
00:05:14,220 --> 00:05:17,100
are windows uh honey pots

165
00:05:17,100 --> 00:05:18,540
all right here's another one that's in

166
00:05:18,540 --> 00:05:21,300
the European Union exactly the same and

167
00:05:21,300 --> 00:05:22,979
another one in the United States so

168
00:05:22,979 --> 00:05:25,860
that's what I call layer one

169
00:05:25,860 --> 00:05:28,440
Layer Two is the seam level so all the

170
00:05:28,440 --> 00:05:30,180
data gets pulled from all those honey

171
00:05:30,180 --> 00:05:32,100
pots that's geographically dispersed or

172
00:05:32,100 --> 00:05:34,320
distributed and they get fed to a Sim

173
00:05:34,320 --> 00:05:36,660
that's in AWS

174
00:05:36,660 --> 00:05:38,820
then we have layer three which is the

175
00:05:38,820 --> 00:05:40,680
Splunk search head I use this to

176
00:05:40,680 --> 00:05:42,120
interrogate the data that's in the

177
00:05:42,120 --> 00:05:44,520
Splunk scene and then that data gets fed

178
00:05:44,520 --> 00:05:46,680
back into visualizations or any kind of

179
00:05:46,680 --> 00:05:49,919
data that I can manipulate

180
00:05:49,919 --> 00:05:52,139
and then from that Splunk search head I

181
00:05:52,139 --> 00:05:53,639
have a lot of the automations that push

182
00:05:53,639 --> 00:05:55,259
out the products right so one of the

183
00:05:55,259 --> 00:05:57,660
products is a CSV file with various

184
00:05:57,660 --> 00:06:00,120
things that we'll cover later on

185
00:06:00,120 --> 00:06:02,940
and then more recently ATT has this

186
00:06:02,940 --> 00:06:03,840
thing called

187
00:06:03,840 --> 00:06:06,780
otx or open thread exchange essentially

188
00:06:06,780 --> 00:06:08,580
what it is is if you found like malware

189
00:06:08,580 --> 00:06:10,380
or you found an IP address or some kind

190
00:06:10,380 --> 00:06:12,479
of ioc you can publish it to their site

191
00:06:12,479 --> 00:06:15,000
in the form of a pulse and the great

192
00:06:15,000 --> 00:06:16,979
thing about that is is if I found

193
00:06:16,979 --> 00:06:19,080
something and you found it that can get

194
00:06:19,080 --> 00:06:20,699
published um

195
00:06:20,699 --> 00:06:22,259
basically anyone that goes there can say

196
00:06:22,259 --> 00:06:24,360
hey three or four or five people saw the

197
00:06:24,360 --> 00:06:26,520
exact same indicator so that gives you a

198
00:06:26,520 --> 00:06:27,660
little bit more confidence that is

199
00:06:27,660 --> 00:06:30,240
probably malicious

200
00:06:30,240 --> 00:06:32,580
all right so that was the architecture

201
00:06:32,580 --> 00:06:34,380
right you can take a look at that and

202
00:06:34,380 --> 00:06:35,520
generate any questions you might have

203
00:06:35,520 --> 00:06:37,560
later

204
00:06:37,560 --> 00:06:39,060
and then so how do I automate that

205
00:06:39,060 --> 00:06:41,660
infrastructure

206
00:06:43,139 --> 00:06:45,600
as well there's three forms of

207
00:06:45,600 --> 00:06:46,979
automations the first one is Splunk

208
00:06:46,979 --> 00:06:49,020
right so Splunk has this thing where you

209
00:06:49,020 --> 00:06:50,940
can write a query let's say the query is

210
00:06:50,940 --> 00:06:53,039
hey how many domain controls do I have

211
00:06:53,039 --> 00:06:54,000
in my environment you're going to get

212
00:06:54,000 --> 00:06:55,800
some Metric back that says eight nine

213
00:06:55,800 --> 00:06:58,080
whatever that number is right let's say

214
00:06:58,080 --> 00:06:59,160
every morning you come in and you're

215
00:06:59,160 --> 00:07:01,139
tasked with running that query well

216
00:07:01,139 --> 00:07:02,880
that's that's kind of uh monotonous

217
00:07:02,880 --> 00:07:04,259
right how do we automate that Splunk

218
00:07:04,259 --> 00:07:05,940
lets you write that query you can save

219
00:07:05,940 --> 00:07:07,500
it and you can schedule it so every

220
00:07:07,500 --> 00:07:09,600
morning you come in it's already ran and

221
00:07:09,600 --> 00:07:11,039
you get your metric of course you can

222
00:07:11,039 --> 00:07:12,180
create dashboards and all kinds of

223
00:07:12,180 --> 00:07:13,860
things like that right so that's how

224
00:07:13,860 --> 00:07:15,539
that's the first type of automation that

225
00:07:15,539 --> 00:07:16,800
I'm using

226
00:07:16,800 --> 00:07:18,660
the second automation is is something

227
00:07:18,660 --> 00:07:20,160
near and dear to my heart it's called

228
00:07:20,160 --> 00:07:22,080
ansible right some of you may know it

229
00:07:22,080 --> 00:07:23,940
puppet Chef or some other tools out

230
00:07:23,940 --> 00:07:26,340
there that automate things I use this to

231
00:07:26,340 --> 00:07:28,800
deploy the Honeypot it also deploys the

232
00:07:28,800 --> 00:07:30,539
universal forwarder and any other

233
00:07:30,539 --> 00:07:32,160
configurations that I have so I

234
00:07:32,160 --> 00:07:34,080
basically run a Playbook and I have a

235
00:07:34,080 --> 00:07:35,400
Honeypot that's provisioned in a few

236
00:07:35,400 --> 00:07:37,520
minutes

237
00:07:37,620 --> 00:07:39,120
and then I have feed Generations right

238
00:07:39,120 --> 00:07:40,319
we talked about this a little bit

239
00:07:40,319 --> 00:07:42,720
earlier from the Splunk search head I

240
00:07:42,720 --> 00:07:44,819
have a git repo that has the CSV from

241
00:07:44,819 --> 00:07:46,500
two of the products and then we have the

242
00:07:46,500 --> 00:07:50,699
Alien Vault otx pulse that's created

243
00:07:50,699 --> 00:07:53,099
so don't worry about uh uh trying to

244
00:07:53,099 --> 00:07:54,180
figure out what this means or if you

245
00:07:54,180 --> 00:07:56,099
can't see it essentially what it does is

246
00:07:56,099 --> 00:07:59,880
I extract all the IP addresses from all

247
00:07:59,880 --> 00:08:01,500
the data from all the honeypots right

248
00:08:01,500 --> 00:08:03,479
these aren't IP addresses that that have

249
00:08:03,479 --> 00:08:05,580
scanned the Honeypot that have like Ping

250
00:08:05,580 --> 00:08:07,139
the Honeypot or some kind of interaction

251
00:08:07,139 --> 00:08:09,120
these are IP addresses that I've gained

252
00:08:09,120 --> 00:08:11,580
unauthorized access to any one of the

253
00:08:11,580 --> 00:08:13,259
honey pots right so that's that's the

254
00:08:13,259 --> 00:08:15,660
criteria for making the CSV list the

255
00:08:15,660 --> 00:08:17,220
other thing that I do is I enhance the

256
00:08:17,220 --> 00:08:19,319
data by adding like first time I saw

257
00:08:19,319 --> 00:08:22,800
this last time I saw it the geolocation

258
00:08:22,800 --> 00:08:23,400
um

259
00:08:23,400 --> 00:08:25,139
and I also looked at how many sensors

260
00:08:25,139 --> 00:08:27,060
have seen this particular IP address

261
00:08:27,060 --> 00:08:28,740
right so if the IP address is in there

262
00:08:28,740 --> 00:08:30,539
and it says and there's a there's a

263
00:08:30,539 --> 00:08:32,580
column that says number of sensors and

264
00:08:32,580 --> 00:08:33,958
it's three that means hey three honey

265
00:08:33,958 --> 00:08:35,339
pots I've seen this particular IP

266
00:08:35,339 --> 00:08:37,260
address and it's gain on unauthorized

267
00:08:37,260 --> 00:08:39,059
access to that system all right so I'm

268
00:08:39,059 --> 00:08:41,520
going to recap it's not scanning right

269
00:08:41,520 --> 00:08:43,860
it's not pinging it's actually landed on

270
00:08:43,860 --> 00:08:45,240
that box and performed some kind of

271
00:08:45,240 --> 00:08:47,880
execution of code

272
00:08:47,880 --> 00:08:49,140
um and then the other thing that I kind

273
00:08:49,140 --> 00:08:50,700
of did that I thought people would have

274
00:08:50,700 --> 00:08:53,399
find Value in is I took the tour exit

275
00:08:53,399 --> 00:08:54,959
node list and I said hey how many of

276
00:08:54,959 --> 00:08:56,940
these IP addresses that have done this

277
00:08:56,940 --> 00:08:58,019
bad thing

278
00:08:58,019 --> 00:09:00,899
are also a tour exit note and I put that

279
00:09:00,899 --> 00:09:01,920
as a field

280
00:09:01,920 --> 00:09:03,779
and you can see that here I'm not sure

281
00:09:03,779 --> 00:09:05,040
if you can read it or not but that's

282
00:09:05,040 --> 00:09:07,140
what it looks like the part that I have

283
00:09:07,140 --> 00:09:08,580
outlined is the time that it runs which

284
00:09:08,580 --> 00:09:11,580
is 2 am every single day over the last

285
00:09:11,580 --> 00:09:13,260
few years right

286
00:09:13,260 --> 00:09:15,720
and it generates that and then if you

287
00:09:15,720 --> 00:09:16,920
want to view it you can go into Splunk

288
00:09:16,920 --> 00:09:19,019
and also view that report and this looks

289
00:09:19,019 --> 00:09:21,740
at all the data

290
00:09:23,160 --> 00:09:24,540
this is the other product that's

291
00:09:24,540 --> 00:09:27,540
generated which is a URL feed so when

292
00:09:27,540 --> 00:09:28,920
someone logs into that system right

293
00:09:28,920 --> 00:09:30,720
whether it's automated or it's someone

294
00:09:30,720 --> 00:09:32,220
manually logging into one of those honey

295
00:09:32,220 --> 00:09:36,240
pots they reach out to pull code down

296
00:09:36,240 --> 00:09:38,339
well I capture that URL and that's

297
00:09:38,339 --> 00:09:39,839
what's that's what's generated in the

298
00:09:39,839 --> 00:09:42,660
second CSV product so that guy logs in

299
00:09:42,660 --> 00:09:43,980
they say hey I'm going to go out to my

300
00:09:43,980 --> 00:09:45,360
infrastructure that's in Russia China

301
00:09:45,360 --> 00:09:46,860
wherever it may be right could be U.S

302
00:09:46,860 --> 00:09:48,660
infrastructure as well um and let's say

303
00:09:48,660 --> 00:09:51,959
it's their you know cool C2 tool that's

304
00:09:51,959 --> 00:09:55,200
 and GZ gzipped well I capture that

305
00:09:55,200 --> 00:09:57,600
URL string that they that they use

306
00:09:57,600 --> 00:09:59,640
I put some of the same metadata around

307
00:09:59,640 --> 00:10:01,440
it that I do for the IP address field so

308
00:10:01,440 --> 00:10:03,420
first time last time number of sensors

309
00:10:03,420 --> 00:10:06,000
but I do one additional thing

310
00:10:06,000 --> 00:10:07,800
I look at the data the domain names

311
00:10:07,800 --> 00:10:09,060
that's in there and I say hey you know

312
00:10:09,060 --> 00:10:10,920
what there's an Alexa top 1 million

313
00:10:10,920 --> 00:10:12,839
domains let's pull that out

314
00:10:12,839 --> 00:10:14,760
and the reason I do that is a lot of

315
00:10:14,760 --> 00:10:16,860
people take these lists right Blacklist

316
00:10:16,860 --> 00:10:18,120
block list whatever you want to call

317
00:10:18,120 --> 00:10:19,860
them and they just put them in their IDs

318
00:10:19,860 --> 00:10:21,300
they don't filter them they don't

319
00:10:21,300 --> 00:10:22,440
sanitize them they don't look to see

320
00:10:22,440 --> 00:10:23,700
they said hey someone already did the

321
00:10:23,700 --> 00:10:25,620
work for me it should be good and you

322
00:10:25,620 --> 00:10:27,839
may think find things like 8.8.8 in

323
00:10:27,839 --> 00:10:29,100
there which you don't want to block

324
00:10:29,100 --> 00:10:30,720
right those of you that notice to

325
00:10:30,720 --> 00:10:31,920
basically Google

326
00:10:31,920 --> 00:10:34,440
so I pull it out just as kind of like a

327
00:10:34,440 --> 00:10:36,120
due diligence for people that's going to

328
00:10:36,120 --> 00:10:38,160
use this blindly

329
00:10:38,160 --> 00:10:40,200
um it's not foolproof though because a

330
00:10:40,200 --> 00:10:41,279
lot of what I've seen is not

331
00:10:41,279 --> 00:10:43,339
domain-based they're not going out to

332
00:10:43,339 --> 00:10:46,800
www.bagguy.com right slash cooltool.zip

333
00:10:46,800 --> 00:10:49,440
a lot of times it's IP based so the

334
00:10:49,440 --> 00:10:52,200
Alexa top 1 million is domains not IPS

335
00:10:52,200 --> 00:10:53,700
so I'm not going to capture the IP

336
00:10:53,700 --> 00:10:54,660
addresses that are in there that's

337
00:10:54,660 --> 00:10:56,820
potentially like Google domain or

338
00:10:56,820 --> 00:10:59,839
Microsoft infrastructure

339
00:11:00,480 --> 00:11:03,500
and this is what it looks like

340
00:11:06,959 --> 00:11:08,339
um and then now for the honey for the

341
00:11:08,339 --> 00:11:09,959
Honeypot deployments in the Splunk UF

342
00:11:09,959 --> 00:11:12,000
right I use ansible and ansible has

343
00:11:12,000 --> 00:11:13,680
something called A playbook so you can

344
00:11:13,680 --> 00:11:15,480
do individual tests or you can run a

345
00:11:15,480 --> 00:11:17,279
whole Playbook that has all the tasks

346
00:11:17,279 --> 00:11:19,140
that you want to do and there's a thing

347
00:11:19,140 --> 00:11:22,560
called roles that containerizes all all

348
00:11:22,560 --> 00:11:25,560
the things for a particular uh action

349
00:11:25,560 --> 00:11:27,240
that you want to do so I have akari

350
00:11:27,240 --> 00:11:28,860
Honeypot and I've customized the right

351
00:11:28,860 --> 00:11:30,480
so this is not a default install of

352
00:11:30,480 --> 00:11:31,700
Kyrie

353
00:11:31,700 --> 00:11:34,680
this is there's things like for instance

354
00:11:34,680 --> 00:11:36,899
when you install Kyrie it used to be

355
00:11:36,899 --> 00:11:38,640
Richard as a default user so I see

356
00:11:38,640 --> 00:11:39,959
attackers logging in and they're

357
00:11:39,959 --> 00:11:41,519
gripping for the Richard user to see if

358
00:11:41,519 --> 00:11:43,620
it's a Honeypot uh the current version

359
00:11:43,620 --> 00:11:46,200
of Kyrie has Phil as a default user so

360
00:11:46,200 --> 00:11:47,459
of course attackers are going to adapt

361
00:11:47,459 --> 00:11:48,720
and they're going to grab for the fill

362
00:11:48,720 --> 00:11:50,100
user right so I don't have any of those

363
00:11:50,100 --> 00:11:51,959
users in there I have about 10 or 20

364
00:11:51,959 --> 00:11:53,700
users that I just create and I throw

365
00:11:53,700 --> 00:11:56,160
those into the Honeypot so attacker logs

366
00:11:56,160 --> 00:11:57,959
in they grep they see a bunch of random

367
00:11:57,959 --> 00:11:59,160
users and they keep telling what they're

368
00:11:59,160 --> 00:12:00,120
doing

369
00:12:00,120 --> 00:12:01,680
so coming back to the The ansible

370
00:12:01,680 --> 00:12:04,019
Playbook there's a lot more code right

371
00:12:04,019 --> 00:12:05,940
written in yaml behind this but it

372
00:12:05,940 --> 00:12:07,140
doesn't make sense to show it if you

373
00:12:07,140 --> 00:12:08,820
want to see it after I'm going to do a

374
00:12:08,820 --> 00:12:11,220
demo of it of deploy a honey pot so you

375
00:12:11,220 --> 00:12:12,720
can see what it looks like but this is

376
00:12:12,720 --> 00:12:13,920
essentially the code in the Playbook

377
00:12:13,920 --> 00:12:15,540
that runs a bunch of other code behind

378
00:12:15,540 --> 00:12:18,019
the scenes

379
00:12:18,600 --> 00:12:19,920
all right so we're going to go into a

380
00:12:19,920 --> 00:12:21,060
quick demo

381
00:12:21,060 --> 00:12:22,320
um of what it looks like this is

382
00:12:22,320 --> 00:12:24,779
deploying uh one Honeypot so it's only

383
00:12:24,779 --> 00:12:26,519
doing the kauri deployment right this is

384
00:12:26,519 --> 00:12:28,200
not the full deployment so you can kind

385
00:12:28,200 --> 00:12:29,640
of get an idea of what it looks like if

386
00:12:29,640 --> 00:12:31,620
you've never seen ansible execute before

387
00:12:31,620 --> 00:12:34,200
this is what it looks like there's one

388
00:12:34,200 --> 00:12:36,000
particular host that is being deployed

389
00:12:36,000 --> 00:12:38,220
so where it says beer that's one host if

390
00:12:38,220 --> 00:12:40,260
it was 200 hosts there'd be 200 hosts

391
00:12:40,260 --> 00:12:42,660
lined up across there

392
00:12:42,660 --> 00:12:44,100
um those of you in artists that are like

393
00:12:44,100 --> 00:12:45,240
hey well you wouldn't do this with 200

394
00:12:45,240 --> 00:12:46,680
hosts there's a thing called ansible

395
00:12:46,680 --> 00:12:48,360
Tower and that's what you'd essentially

396
00:12:48,360 --> 00:12:51,680
use to deploy at scale

397
00:12:51,720 --> 00:12:54,000
uh if you go to Kyrie's website let's

398
00:12:54,000 --> 00:12:55,440
say you Google Kyrie right now and look

399
00:12:55,440 --> 00:12:57,180
at the installation steps there's about

400
00:12:57,180 --> 00:13:00,480
seven steps that they set up so what I

401
00:13:00,480 --> 00:13:02,700
did was I went through each step and I

402
00:13:02,700 --> 00:13:04,560
basically created an ansible task or

403
00:13:04,560 --> 00:13:06,360
rule that completed that and I added

404
00:13:06,360 --> 00:13:08,700
about one or two additional things so

405
00:13:08,700 --> 00:13:09,720
like at the end you can see it's

406
00:13:09,720 --> 00:13:11,760
checking for the SSH Port the default

407
00:13:11,760 --> 00:13:14,100
Port is quad twos I'm checking to see if

408
00:13:14,100 --> 00:13:16,380
that Port is active and that lets me

409
00:13:16,380 --> 00:13:18,240
know like hey the Honeypot got installed

410
00:13:18,240 --> 00:13:20,720
successfully

411
00:13:20,940 --> 00:13:23,040
all right so now for the the GitHub data

412
00:13:23,040 --> 00:13:24,779
feeds right so I talked about the csvs

413
00:13:24,779 --> 00:13:26,519
that are generated you have an IP CSV

414
00:13:26,519 --> 00:13:29,700
and you have a URL feed well those sit

415
00:13:29,700 --> 00:13:32,339
on the the uh the Splunk index or Splunk

416
00:13:32,339 --> 00:13:34,200
search head right how do I get those out

417
00:13:34,200 --> 00:13:36,240
so that you know other Defenders can use

418
00:13:36,240 --> 00:13:37,980
them because it does it does you no good

419
00:13:37,980 --> 00:13:39,660
if I have them and you can get access to

420
00:13:39,660 --> 00:13:41,339
them let's say you want to use them

421
00:13:41,339 --> 00:13:44,639
well what I do is I run a uh I have two

422
00:13:44,639 --> 00:13:46,260
batch scripts and it basically compares

423
00:13:46,260 --> 00:13:48,420
the CSV that gets generated by Splunk

424
00:13:48,420 --> 00:13:50,279
with whatever's in the git repo and if

425
00:13:50,279 --> 00:13:52,079
there's a difference it it commits the

426
00:13:52,079 --> 00:13:54,180
change and pushes it a GitHub so every

427
00:13:54,180 --> 00:13:55,380
single day

428
00:13:55,380 --> 00:13:57,420
um around you know sometime after two

429
00:13:57,420 --> 00:13:59,399
o'clock in the morning a new file is

430
00:13:59,399 --> 00:14:01,620
going to get pushed uh

431
00:14:01,620 --> 00:14:04,440
so you can pick that up

432
00:14:04,440 --> 00:14:06,839
and then the alien bar otx pulse same

433
00:14:06,839 --> 00:14:08,220
thing here if you can't read the URL

434
00:14:08,220 --> 00:14:09,480
obviously I can give you the slides

435
00:14:09,480 --> 00:14:10,920
after this or you can just Google it

436
00:14:10,920 --> 00:14:12,480
it's called fake Labs honeynet project

437
00:14:12,480 --> 00:14:15,720
right the great thing about the pulse on

438
00:14:15,720 --> 00:14:17,820
Alien Vault is it allows you to convert

439
00:14:17,820 --> 00:14:20,700
that CSV into other formats

440
00:14:20,700 --> 00:14:22,920
this is what it looks like on alienvault

441
00:14:22,920 --> 00:14:24,540
and remember I talked about being able

442
00:14:24,540 --> 00:14:25,620
to correlate that with other

443
00:14:25,620 --> 00:14:27,300
organizations or individuals that have

444
00:14:27,300 --> 00:14:29,579
the same findings so this is my actual

445
00:14:29,579 --> 00:14:31,019
pulse that I've submitted right based on

446
00:14:31,019 --> 00:14:33,480
the data we were talking about there's

447
00:14:33,480 --> 00:14:35,459
at least three indicators on here that

448
00:14:35,459 --> 00:14:37,579
have over 50 other

449
00:14:37,579 --> 00:14:39,899
people that have identified the same

450
00:14:39,899 --> 00:14:41,699
indicator right so I'm seeing this in my

451
00:14:41,699 --> 00:14:44,820
honey pot and you have 1978 57 and 33

452
00:14:44,820 --> 00:14:46,800
other people that have seen different IP

453
00:14:46,800 --> 00:14:50,899
address addresses doing different things

454
00:14:52,500 --> 00:14:54,120
and like I talked about right if you're

455
00:14:54,120 --> 00:14:55,740
if the CSV format isn't something for

456
00:14:55,740 --> 00:14:58,920
you uh we have open ioc

457
00:14:58,920 --> 00:15:00,779
and we also have sticks and taxi so if

458
00:15:00,779 --> 00:15:02,459
you're using misp you can convert it to

459
00:15:02,459 --> 00:15:04,500
one of those formats and and import it

460
00:15:04,500 --> 00:15:06,300
into whatever platform it is that you're

461
00:15:06,300 --> 00:15:08,599
using

462
00:15:08,940 --> 00:15:10,800
observations okay so this is the part

463
00:15:10,800 --> 00:15:12,180
that most of you probably interested in

464
00:15:12,180 --> 00:15:14,100
right what have I seen I set all this

465
00:15:14,100 --> 00:15:15,480
infrastructure up I did all the

466
00:15:15,480 --> 00:15:16,680
automations you don't care about the

467
00:15:16,680 --> 00:15:19,500
automations like what have I seen

468
00:15:19,500 --> 00:15:21,060
okay so the number one thing right we

469
00:15:21,060 --> 00:15:22,500
talked about this there was a talk this

470
00:15:22,500 --> 00:15:24,000
morning talking about like passwords

471
00:15:24,000 --> 00:15:26,399
right this thing is is Beat to Death at

472
00:15:26,399 --> 00:15:28,399
all the security conferences any web

473
00:15:28,399 --> 00:15:31,139
webinars you've watched they always talk

474
00:15:31,139 --> 00:15:33,000
about it and I think it's relevant

475
00:15:33,000 --> 00:15:35,579
because it's true right we talked about

476
00:15:35,579 --> 00:15:38,339
iot X iot all of them have default

477
00:15:38,339 --> 00:15:40,620
passwords you buy you buy uh you know

478
00:15:40,620 --> 00:15:42,839
any off-the-shelf device and it says hey

479
00:15:42,839 --> 00:15:43,920
you need to configure it it's going to

480
00:15:43,920 --> 00:15:45,360
have like whatever brand and then

481
00:15:45,360 --> 00:15:47,279
password as a password or admin admin

482
00:15:47,279 --> 00:15:48,420
right

483
00:15:48,420 --> 00:15:49,920
so out of all the data right we have

484
00:15:49,920 --> 00:15:52,079
eight million events what's like the top

485
00:15:52,079 --> 00:15:54,720
10 passwords that I've seen

486
00:15:54,720 --> 00:15:56,399
well the number one passwords one two

487
00:15:56,399 --> 00:15:58,620
three four five six all right no

488
00:15:58,620 --> 00:16:00,779
surprise there

489
00:16:00,779 --> 00:16:04,260
yeah so I did some research and I was

490
00:16:04,260 --> 00:16:05,940
like hmm I remember there was like some

491
00:16:05,940 --> 00:16:07,260
list some were published right about

492
00:16:07,260 --> 00:16:09,240
like the top 10 whatever passwords and

493
00:16:09,240 --> 00:16:11,880
it turns out that Forbes did a study of

494
00:16:11,880 --> 00:16:14,820
the 100 worst passwords in the world

495
00:16:14,820 --> 00:16:17,339
and the number one password in that list

496
00:16:17,339 --> 00:16:20,040
was one two three four five

497
00:16:20,040 --> 00:16:22,500
right one two three four five six which

498
00:16:22,500 --> 00:16:25,980
is what I have here was number two

499
00:16:25,980 --> 00:16:27,600
so it's so it's still important right we

500
00:16:27,600 --> 00:16:28,920
had we had a ton of talks that talked

501
00:16:28,920 --> 00:16:30,300
about you know admin admin password

502
00:16:30,300 --> 00:16:32,339
password and we'll see like when I when

503
00:16:32,339 --> 00:16:33,779
I go on and we start looking at some of

504
00:16:33,779 --> 00:16:35,459
the malware that I was looking at they

505
00:16:35,459 --> 00:16:37,740
have these uh like basic passwords

506
00:16:37,740 --> 00:16:39,300
hard-coded

507
00:16:39,300 --> 00:16:40,560
so they're not they're not looking for

508
00:16:40,560 --> 00:16:42,240
complex passwords they're not they're

509
00:16:42,240 --> 00:16:43,680
not having like you know we talk about a

510
00:16:43,680 --> 00:16:45,120
billion password list or whatever

511
00:16:45,120 --> 00:16:46,800
they're not they're not looking at like

512
00:16:46,800 --> 00:16:49,320
a 10 000 different passwords they have

513
00:16:49,320 --> 00:16:50,940
like 10 passwords in the list and

514
00:16:50,940 --> 00:16:51,779
they're searching for those and they're

515
00:16:51,779 --> 00:16:53,759
gaining access to systems right so I

516
00:16:53,759 --> 00:16:54,839
thought it was important to to

517
00:16:54,839 --> 00:16:57,540
communicate that here to you

518
00:16:57,540 --> 00:17:00,300
and if you like pie charts right there

519
00:17:00,300 --> 00:17:02,459
you go you know almost half

520
00:17:02,459 --> 00:17:04,679
of the passwords that I see

521
00:17:04,679 --> 00:17:08,120
one two three four five six

522
00:17:08,400 --> 00:17:09,839
okay

523
00:17:09,839 --> 00:17:11,640
all right so so what else have I seen

524
00:17:11,640 --> 00:17:15,000
iot malware right or x x iot if you will

525
00:17:15,000 --> 00:17:17,459
is basically what I see a good eighty

526
00:17:17,459 --> 00:17:19,859
percent of it is that and they're Mirai

527
00:17:19,859 --> 00:17:21,900
variance right Mariah what is that it's

528
00:17:21,900 --> 00:17:23,819
2016 was discovered basically a large

529
00:17:23,819 --> 00:17:25,740
botnet that took down a bunch of uh

530
00:17:25,740 --> 00:17:27,000
different organizations krebzone

531
00:17:27,000 --> 00:17:29,520
security is one of them uh ovh which is

532
00:17:29,520 --> 00:17:33,059
a provider over in Germany and a lot of

533
00:17:33,059 --> 00:17:35,039
the a lot of the attacks that happen

534
00:17:35,039 --> 00:17:36,419
were really collateral damage right so

535
00:17:36,419 --> 00:17:38,400
you have this huge IP space let's say

536
00:17:38,400 --> 00:17:39,780
they're targeting like the Sony network

537
00:17:39,780 --> 00:17:42,179
and some other company happened to fall

538
00:17:42,179 --> 00:17:43,919
within an IP space it was collateral

539
00:17:43,919 --> 00:17:46,500
damage it wasn't necessarily a Target so

540
00:17:46,500 --> 00:17:48,480
I see a lot of Mirai variants that Mari

541
00:17:48,480 --> 00:17:50,039
code was leaked

542
00:17:50,039 --> 00:17:51,539
and a lot of other thread actors said

543
00:17:51,539 --> 00:17:53,880
hey there's this very nice code base

544
00:17:53,880 --> 00:17:55,260
that's out there I don't have to do any

545
00:17:55,260 --> 00:17:57,960
research right I don't have a security

546
00:17:57,960 --> 00:18:00,240
team I just take this code and repackage

547
00:18:00,240 --> 00:18:02,039
it and that's what they did and you have

548
00:18:02,039 --> 00:18:04,260
a bunch of different variants

549
00:18:04,260 --> 00:18:06,840
now what I noticed is there's no

550
00:18:06,840 --> 00:18:08,160
industry standard

551
00:18:08,160 --> 00:18:10,799
for naming the variants from for Mariah

552
00:18:10,799 --> 00:18:13,440
right so let's say you know

553
00:18:13,440 --> 00:18:15,059
you decide to hey I'm going to take

554
00:18:15,059 --> 00:18:16,440
Mariah and I'm going to make it my own

555
00:18:16,440 --> 00:18:17,640
because there's some vulnerability that

556
00:18:17,640 --> 00:18:19,020
came out there and I'm just going to

557
00:18:19,020 --> 00:18:20,220
adjust the code

558
00:18:20,220 --> 00:18:21,720
and you have some string in there right

559
00:18:21,720 --> 00:18:24,539
let's say you put like Sora in there and

560
00:18:24,539 --> 00:18:26,460
somebody discovers that variant out

561
00:18:26,460 --> 00:18:28,919
there they name the variant Sora it's

562
00:18:28,919 --> 00:18:30,480
really just based on the binary name

563
00:18:30,480 --> 00:18:32,820
some particular string in there or maybe

564
00:18:32,820 --> 00:18:34,260
some output that's generated from the

565
00:18:34,260 --> 00:18:37,500
binary that's the only like way that's

566
00:18:37,500 --> 00:18:38,820
the only rhyming reason how they name

567
00:18:38,820 --> 00:18:40,200
these things

568
00:18:40,200 --> 00:18:42,059
and I picked an example to show you this

569
00:18:42,059 --> 00:18:44,220
happened uh in June of this year right

570
00:18:44,220 --> 00:18:45,480
it was discovered June of this year it's

571
00:18:45,480 --> 00:18:47,400
called the rapperbot

572
00:18:47,400 --> 00:18:49,380
um and the only reason it was named the

573
00:18:49,380 --> 00:18:51,240
rapper bot is because it drops a YouTube

574
00:18:51,240 --> 00:18:53,580
link to a rap video when it executes

575
00:18:53,580 --> 00:18:55,860
right does that look like any kind of

576
00:18:55,860 --> 00:18:57,900
like IEEE standards we're naming a

577
00:18:57,900 --> 00:18:59,220
malware no

578
00:18:59,220 --> 00:19:00,660
all right

579
00:19:00,660 --> 00:19:02,640
it uses parts of the miracode base right

580
00:19:02,640 --> 00:19:04,679
it's one of the variants

581
00:19:04,679 --> 00:19:05,640
um

582
00:19:05,640 --> 00:19:07,440
the research out there says it's just

583
00:19:07,440 --> 00:19:09,299
acquiring access right they don't see it

584
00:19:09,299 --> 00:19:10,500
doing anything malicious other than

585
00:19:10,500 --> 00:19:12,480
accumulating access

586
00:19:12,480 --> 00:19:14,039
and then there's a unique identifier if

587
00:19:14,039 --> 00:19:16,020
you run strings on the Byron it's going

588
00:19:16,020 --> 00:19:17,400
to pop this out and what it does is as

589
00:19:17,400 --> 00:19:18,900
it scans the Internet connects SSH

590
00:19:18,900 --> 00:19:21,059
servers it puts the string in there

591
00:19:21,059 --> 00:19:22,919
right so that's that's an ioc if you

592
00:19:22,919 --> 00:19:25,020
will I would use more than this as an

593
00:19:25,020 --> 00:19:28,460
ioc but that's one of them

594
00:19:28,500 --> 00:19:30,660
some other observations right as you're

595
00:19:30,660 --> 00:19:32,100
running strings or you're throwing

596
00:19:32,100 --> 00:19:33,419
things into binary ninja or either

597
00:19:33,419 --> 00:19:34,799
whatever thing you're doing if you're

598
00:19:34,799 --> 00:19:37,320
doing that I see things like this right

599
00:19:37,320 --> 00:19:40,380
cha cha sliding across SSH RN is like

600
00:19:40,380 --> 00:19:41,880
right now

601
00:19:41,880 --> 00:19:42,480
um

602
00:19:42,480 --> 00:19:43,860
so I thought that was interesting to

603
00:19:43,860 --> 00:19:45,539
share like they do have a sense of humor

604
00:19:45,539 --> 00:19:47,880
and they do put some things in here

605
00:19:47,880 --> 00:19:49,440
and then this is another thing I see

606
00:19:49,440 --> 00:19:51,059
this a lot right so there's a ton of

607
00:19:51,059 --> 00:19:52,679
pearl scripts they're they're basically

608
00:19:52,679 --> 00:19:54,660
taking the Millwork there's a site

609
00:19:54,660 --> 00:19:57,179
called um uh packet storm and there's a

610
00:19:57,179 --> 00:20:00,360
lot ton of export code there they

611
00:20:00,360 --> 00:20:01,679
download this code and they just change

612
00:20:01,679 --> 00:20:03,000
the attribution right so this was

613
00:20:03,000 --> 00:20:04,679
actually written by a group called

614
00:20:04,679 --> 00:20:06,240
millworm

615
00:20:06,240 --> 00:20:08,760
I can't remember the exact name but they

616
00:20:08,760 --> 00:20:10,380
take that same code they'll either cut

617
00:20:10,380 --> 00:20:11,880
out the header or they'll put their own

618
00:20:11,880 --> 00:20:13,500
name in there and all it does is it

619
00:20:13,500 --> 00:20:15,059
comes up it executes on your server

620
00:20:15,059 --> 00:20:16,860
connects to an RC server and then from

621
00:20:16,860 --> 00:20:18,539
that IRC server they can say hey attack

622
00:20:18,539 --> 00:20:20,940
you know Sony network or attack this

623
00:20:20,940 --> 00:20:23,100
other IP or let's say you're playing you

624
00:20:23,100 --> 00:20:24,780
know you're playing on some game server

625
00:20:24,780 --> 00:20:26,340
Quake or whatever it is and they know

626
00:20:26,340 --> 00:20:27,780
the IP address this is one of the

627
00:20:27,780 --> 00:20:29,220
reasons why people say hide your IP

628
00:20:29,220 --> 00:20:31,740
address they can have their 50 000

629
00:20:31,740 --> 00:20:33,720
different zombie computers basically

630
00:20:33,720 --> 00:20:35,039
attack your computer and that's that's

631
00:20:35,039 --> 00:20:38,000
essentially what this does

632
00:20:38,280 --> 00:20:39,360
um and then this is kind of like

633
00:20:39,360 --> 00:20:41,460
indicative of Mao uh Mariah and the

634
00:20:41,460 --> 00:20:42,780
different variants

635
00:20:42,780 --> 00:20:44,280
um essentially what this does if you

636
00:20:44,280 --> 00:20:45,720
can't read it don't worry about it it's

637
00:20:45,720 --> 00:20:47,100
trying to find a directory that it can

638
00:20:47,100 --> 00:20:48,960
enter and then it downloads every single

639
00:20:48,960 --> 00:20:51,480
architecture so it's saying hey

640
00:20:51,480 --> 00:20:54,120
um as I'm going to compromise these IP

641
00:20:54,120 --> 00:20:55,860
cameras you know the refrigerators the

642
00:20:55,860 --> 00:20:57,419
thermostats the whatever it is that's

643
00:20:57,419 --> 00:20:58,679
out there right that should or shouldn't

644
00:20:58,679 --> 00:21:00,600
be connected to the public internet I

645
00:21:00,600 --> 00:21:01,919
don't know what architecture that is I

646
00:21:01,919 --> 00:21:03,240
don't know if it's a Windows laptop

647
00:21:03,240 --> 00:21:04,799
right like as I look across this room

648
00:21:04,799 --> 00:21:06,840
like I don't know if that's a Mac laptop

649
00:21:06,840 --> 00:21:08,220
I don't know if that's Windows laptop

650
00:21:08,220 --> 00:21:09,660
that you convert it to a Linux laptop

651
00:21:09,660 --> 00:21:11,700
like I don't know what the OS is so if I

652
00:21:11,700 --> 00:21:13,440
have one piece of of software that I'm

653
00:21:13,440 --> 00:21:15,900
trying to execute it may or may not work

654
00:21:15,900 --> 00:21:18,000
but if I want to compromise everybody in

655
00:21:18,000 --> 00:21:19,679
this room I'm going to say okay what's

656
00:21:19,679 --> 00:21:21,299
what's what architectures are out there

657
00:21:21,299 --> 00:21:23,780
you have arm you have

658
00:21:23,780 --> 00:21:27,840
Intel right so x86 so what I'm going to

659
00:21:27,840 --> 00:21:28,980
do is I'm going to take every single

660
00:21:28,980 --> 00:21:30,299
architecture I can and on the screen is

661
00:21:30,299 --> 00:21:32,280
basically says power PC arm if you have

662
00:21:32,280 --> 00:21:33,360
a Raspberry Pi that's going to be arm

663
00:21:33,360 --> 00:21:35,580
architecture the M1 the new M1 Max those

664
00:21:35,580 --> 00:21:38,039
are arm right and I'm going to execute

665
00:21:38,039 --> 00:21:39,600
I'm going to download all the different

666
00:21:39,600 --> 00:21:41,100
versions that I have and execute them

667
00:21:41,100 --> 00:21:43,080
till one works and that's essentially

668
00:21:43,080 --> 00:21:44,760
what they're doing

669
00:21:44,760 --> 00:21:46,620
then we have another malware called DOTA

670
00:21:46,620 --> 00:21:48,480
malware anybody take a guess at why they

671
00:21:48,480 --> 00:21:51,380
call it DotA

672
00:21:53,400 --> 00:21:56,100
because it's called DotA

673
00:21:56,100 --> 00:21:59,280
the the tar gz is it's dota.tar.gz

674
00:21:59,280 --> 00:22:00,960
that's the only reason why they call it

675
00:22:00,960 --> 00:22:03,840
the DOTA malware right

676
00:22:03,840 --> 00:22:06,419
uh so when you extract this it's going

677
00:22:06,419 --> 00:22:07,860
to have I actually wrote a blog post on

678
00:22:07,860 --> 00:22:09,360
this so if you we're not giving my blog

679
00:22:09,360 --> 00:22:11,039
later you can look at it and I dived a

680
00:22:11,039 --> 00:22:12,600
little deeper but there's two binaries

681
00:22:12,600 --> 00:22:14,340
in there there's a 32-bit and a 64-bit

682
00:22:14,340 --> 00:22:16,320
binary called TSM that's responsible for

683
00:22:16,320 --> 00:22:17,760
going out and scanning other systems and

684
00:22:17,760 --> 00:22:19,620
compromising them

685
00:22:19,620 --> 00:22:21,000
then you have two other binaries called

686
00:22:21,000 --> 00:22:22,679
intercon and and they change the names

687
00:22:22,679 --> 00:22:24,539
up so as you get these different um

688
00:22:24,539 --> 00:22:26,159
tar.gz there'll be different names in

689
00:22:26,159 --> 00:22:27,179
there but they essentially do the same

690
00:22:27,179 --> 00:22:28,740
thing there's going to be two that go

691
00:22:28,740 --> 00:22:30,419
out and scan and capture other machines

692
00:22:30,419 --> 00:22:31,919
and there's going to be two that's

693
00:22:31,919 --> 00:22:33,780
responsible for Monero mining all right

694
00:22:33,780 --> 00:22:35,940
Monero is basically it's supposed to be

695
00:22:35,940 --> 00:22:39,720
designed to not be traceable

696
00:22:39,720 --> 00:22:41,400
and then shell scripts there's a ton of

697
00:22:41,400 --> 00:22:42,780
shell scripts that basically do the

698
00:22:42,780 --> 00:22:44,820
housekeeping responsible for executing

699
00:22:44,820 --> 00:22:46,860
the different binaries and setting up

700
00:22:46,860 --> 00:22:48,600
the crypto mining

701
00:22:48,600 --> 00:22:50,240
and then I found like this random

702
00:22:50,240 --> 00:22:52,559
obfuscated file that was on the system

703
00:22:52,559 --> 00:22:54,059
was basically basic store encoded and

704
00:22:54,059 --> 00:22:56,039
then once you decoded that it was Pearl

705
00:22:56,039 --> 00:22:57,240
obfuscated

706
00:22:57,240 --> 00:22:58,740
if you're not familiar with obfuscation

707
00:22:58,740 --> 00:23:00,960
uh think of like a string of code that

708
00:23:00,960 --> 00:23:02,700
says print hello world

709
00:23:02,700 --> 00:23:04,320
but instead of saying print hello world

710
00:23:04,320 --> 00:23:06,539
there's like 50 lines of code that

711
00:23:06,539 --> 00:23:07,799
essentially does the same thing right

712
00:23:07,799 --> 00:23:08,880
that's what they're doing is they're

713
00:23:08,880 --> 00:23:10,980
making it really hard to read what the

714
00:23:10,980 --> 00:23:12,980
code does

715
00:23:12,980 --> 00:23:15,419
and then uh here's just an example of a

716
00:23:15,419 --> 00:23:16,980
Huawei exploit right so they took the

717
00:23:16,980 --> 00:23:18,480
miracode base

718
00:23:18,480 --> 00:23:20,580
took the exploit for the Huawei for

719
00:23:20,580 --> 00:23:21,840
Huawei uh

720
00:23:21,840 --> 00:23:24,539
device and they packaged it up so what

721
00:23:24,539 --> 00:23:26,039
they're doing now is instead of using

722
00:23:26,039 --> 00:23:28,140
the password to get into a system they

723
00:23:28,140 --> 00:23:29,880
can say hey let's see if we can export a

724
00:23:29,880 --> 00:23:31,320
system using this exploit and gain

725
00:23:31,320 --> 00:23:33,539
access that way so if you have a really

726
00:23:33,539 --> 00:23:35,700
good password right you said hey I'm

727
00:23:35,700 --> 00:23:36,960
going to change the default because I

728
00:23:36,960 --> 00:23:38,820
heard I shouldn't be doing that and you

729
00:23:38,820 --> 00:23:40,679
put in a good password well they can

730
00:23:40,679 --> 00:23:42,120
still export your device this way and

731
00:23:42,120 --> 00:23:43,559
gain access and then scan the other

732
00:23:43,559 --> 00:23:45,900
systems

733
00:23:45,900 --> 00:23:47,640
here's another one I had no idea what

734
00:23:47,640 --> 00:23:49,740
total link was at first but then when I

735
00:23:49,740 --> 00:23:52,080
I Googled it I saw it was another like

736
00:23:52,080 --> 00:23:54,600
you know basically Wi-Fi router you can

737
00:23:54,600 --> 00:23:55,799
buy

738
00:23:55,799 --> 00:23:57,419
um what was interesting about this and

739
00:23:57,419 --> 00:23:59,100
kind of some feedback for Defenders out

740
00:23:59,100 --> 00:24:00,480
there that are looking at strings within

741
00:24:00,480 --> 00:24:01,679
binaries

742
00:24:01,679 --> 00:24:03,900
um so this is all plain text but if you

743
00:24:03,900 --> 00:24:07,679
xor the binary strings using the default

744
00:24:07,679 --> 00:24:09,780
Mariah code which will there's a default

745
00:24:09,780 --> 00:24:11,820
key so xor I'm not going to get into

746
00:24:11,820 --> 00:24:13,200
details of that but if you're if you're

747
00:24:13,200 --> 00:24:15,299
familiar with that basically don't just

748
00:24:15,299 --> 00:24:17,159
look at a binary that reveals strings as

749
00:24:17,159 --> 00:24:19,799
okay this is not encrypted there may be

750
00:24:19,799 --> 00:24:21,059
encrypted strings in there which there

751
00:24:21,059 --> 00:24:23,700
is this particular one revealed the

752
00:24:23,700 --> 00:24:27,919
payload for the total link exploit

753
00:24:27,960 --> 00:24:30,000
and then here's another demo right

754
00:24:30,000 --> 00:24:31,919
um so people think that a lot of the

755
00:24:31,919 --> 00:24:32,940
attacks that happen on the internet are

756
00:24:32,940 --> 00:24:35,039
all automated whether there's actual

757
00:24:35,039 --> 00:24:36,539
individual threat actors that land on

758
00:24:36,539 --> 00:24:38,460
systems and don't realize that it's a

759
00:24:38,460 --> 00:24:39,539
Honeypot

760
00:24:39,539 --> 00:24:41,460
and here's here's an example so the

761
00:24:41,460 --> 00:24:43,460
great thing about Kyrie is every single

762
00:24:43,460 --> 00:24:47,159
uh attack that happens on the system

763
00:24:47,159 --> 00:24:49,020
once they log in it records what they're

764
00:24:49,020 --> 00:24:50,580
doing and there's a tool that allows you

765
00:24:50,580 --> 00:24:52,799
to play back all of those attacks in

766
00:24:52,799 --> 00:24:54,780
real time or you can speed it up

767
00:24:54,780 --> 00:24:56,340
so just take a look at this and I'll

768
00:24:56,340 --> 00:24:59,539
kind of narrate as it goes through

769
00:25:02,400 --> 00:25:04,740
you'll you'll notice the uh command line

770
00:25:04,740 --> 00:25:06,600
when it comes up it'll say AWS that's

771
00:25:06,600 --> 00:25:07,919
that's arbitrary so I can make that

772
00:25:07,919 --> 00:25:09,600
whatever I want and I kind of made it

773
00:25:09,600 --> 00:25:11,580
look like AWS so they think that hey

774
00:25:11,580 --> 00:25:13,140
this is probably an ec2 instance or

775
00:25:13,140 --> 00:25:15,000
whatever notice that the there's no

776
00:25:15,000 --> 00:25:18,900
default uh fill or Richard user

777
00:25:18,900 --> 00:25:21,299
they're trying to basically on set the

778
00:25:21,299 --> 00:25:22,559
system up so it doesn't record their

779
00:25:22,559 --> 00:25:23,760
history

780
00:25:23,760 --> 00:25:25,140
they're checking the architecture okay

781
00:25:25,140 --> 00:25:26,820
what kernel version is it vulnerable

782
00:25:26,820 --> 00:25:29,159
some basic reconnaissance right nothing

783
00:25:29,159 --> 00:25:30,600
nothing about what they're doing right

784
00:25:30,600 --> 00:25:33,299
now is is Nate you know Advanced

785
00:25:33,299 --> 00:25:35,960
essentially

786
00:25:36,779 --> 00:25:38,460
they're checking to see you know how

787
00:25:38,460 --> 00:25:40,140
many CPUs do we have maybe I can mine

788
00:25:40,140 --> 00:25:41,880
crypto on here right there's only two

789
00:25:41,880 --> 00:25:43,740
cores on there so nothing nothing too

790
00:25:43,740 --> 00:25:45,659
fancy

791
00:25:45,659 --> 00:25:47,460
uh looking at temp directory to see if

792
00:25:47,460 --> 00:25:48,539
there's other files maybe they can

793
00:25:48,539 --> 00:25:49,919
mingle their files there and then they

794
00:25:49,919 --> 00:25:52,080
decide to go to Dev shim

795
00:25:52,080 --> 00:25:53,159
and this is where they're going to pull

796
00:25:53,159 --> 00:25:55,440
down their files

797
00:25:55,440 --> 00:25:57,480
so what's great about this is I now have

798
00:25:57,480 --> 00:25:59,400
a copy of that that

799
00:25:59,400 --> 00:26:01,020
package right whatever payload that is

800
00:26:01,020 --> 00:26:02,820
whatever tools they have in there I now

801
00:26:02,820 --> 00:26:04,440
have a copy of that that I can analyze I

802
00:26:04,440 --> 00:26:07,020
can build detections around and pass and

803
00:26:07,020 --> 00:26:07,799
share that with the rest of the

804
00:26:07,799 --> 00:26:08,940
community

805
00:26:08,940 --> 00:26:11,400
uh the other good thing about it is they

806
00:26:11,400 --> 00:26:12,840
can't use that to attack other people

807
00:26:12,840 --> 00:26:14,880
right so let's say they they pull down

808
00:26:14,880 --> 00:26:16,380
whatever nation state tool or whatever

809
00:26:16,380 --> 00:26:18,360
tool it is that they have they can't now

810
00:26:18,360 --> 00:26:20,220
take that and attack other systems so

811
00:26:20,220 --> 00:26:21,480
the great thing about running a Honeypot

812
00:26:21,480 --> 00:26:23,039
if you're talking about what are the

813
00:26:23,039 --> 00:26:24,000
risks

814
00:26:24,000 --> 00:26:25,080
um that's one of the things that Bobby

815
00:26:25,080 --> 00:26:27,120
design you cannot attack other systems

816
00:26:27,120 --> 00:26:29,279
so you'll see they'll try to execute

817
00:26:29,279 --> 00:26:30,360
um different code and they'll get

818
00:26:30,360 --> 00:26:31,679
frustrated like why isn't this working

819
00:26:31,679 --> 00:26:33,960
it's executable they'll try to download

820
00:26:33,960 --> 00:26:36,659
it again it doesn't work and then

821
00:26:36,659 --> 00:26:38,400
something that's pretty great is they

822
00:26:38,400 --> 00:26:40,260
download another set of tools right it's

823
00:26:40,260 --> 00:26:41,940
called fresh.tgz

824
00:26:41,940 --> 00:26:45,779
so I now have two copies of different uh

825
00:26:45,779 --> 00:26:48,480
different payloads if you will that this

826
00:26:48,480 --> 00:26:50,520
particular attacker has right and while

827
00:26:50,520 --> 00:26:51,600
we were going through this you notice

828
00:26:51,600 --> 00:26:52,980
that it's it's not automated right this

829
00:26:52,980 --> 00:26:54,120
is actually someone typing these

830
00:26:54,120 --> 00:26:55,740
commands

831
00:26:55,740 --> 00:26:57,000
um there's where they download the other

832
00:26:57,000 --> 00:26:58,200
tool

833
00:26:58,200 --> 00:27:00,179
and I said thank you very much

834
00:27:00,179 --> 00:27:01,799
all right they try to extract it

835
00:27:01,799 --> 00:27:04,679
extracts now if you're not familiar with

836
00:27:04,679 --> 00:27:05,940
Kyrie I'm just going to explain it real

837
00:27:05,940 --> 00:27:08,039
quick if you try to cat like a text file

838
00:27:08,039 --> 00:27:10,440
or any plain text file it'll actually

839
00:27:10,440 --> 00:27:11,940
show you the output so the attacker is

840
00:27:11,940 --> 00:27:13,799
thinking okay this works but why doesn't

841
00:27:13,799 --> 00:27:15,659
the binary work if they had a binary

842
00:27:15,659 --> 00:27:17,700
there's like a standard like output that

843
00:27:17,700 --> 00:27:20,580
it shows just by Design which is another

844
00:27:20,580 --> 00:27:23,700
signature for Kyrie or a Honeypot

845
00:27:23,700 --> 00:27:26,039
but it won't execute it and so that's

846
00:27:26,039 --> 00:27:27,419
that's the frustration I see a lot of

847
00:27:27,419 --> 00:27:29,279
times is it won't work they try try and

848
00:27:29,279 --> 00:27:30,720
they give up and leave

849
00:27:30,720 --> 00:27:33,120
right the reason he tries putty or she

850
00:27:33,120 --> 00:27:35,159
or whoever it is uh they're trying putty

851
00:27:35,159 --> 00:27:36,659
to see if okay is this a honey plot is

852
00:27:36,659 --> 00:27:37,919
it going to run any command I type it

853
00:27:37,919 --> 00:27:39,360
doesn't work so they they still believe

854
00:27:39,360 --> 00:27:41,100
it's a real system there you go they're

855
00:27:41,100 --> 00:27:42,360
getting output from when they're playing

856
00:27:42,360 --> 00:27:43,740
text files so they're like okay I can

857
00:27:43,740 --> 00:27:45,240
see the output so it's probably not a

858
00:27:45,240 --> 00:27:46,799
Honeypot and then it just eventually

859
00:27:46,799 --> 00:27:48,480
give up because they can't get anything

860
00:27:48,480 --> 00:27:50,640
to work

861
00:27:50,640 --> 00:27:53,580
cool so H2 minor this is not a Mirai

862
00:27:53,580 --> 00:27:55,140
variant this is a different kind of

863
00:27:55,140 --> 00:27:57,299
malware it essentially scans for

864
00:27:57,299 --> 00:28:00,539
vulnerable Reddit servers right

865
00:28:00,539 --> 00:28:02,100
um and then what I've noticed with a lot

866
00:28:02,100 --> 00:28:03,539
of different malware is they use Mass

867
00:28:03,539 --> 00:28:05,520
scan to scan other systems

868
00:28:05,520 --> 00:28:08,820
now what's really cool about this is

869
00:28:08,820 --> 00:28:10,440
everyone else is trying to scan the rest

870
00:28:10,440 --> 00:28:11,460
of the internet to find vulnerable

871
00:28:11,460 --> 00:28:13,200
things but if you're not familiar with

872
00:28:13,200 --> 00:28:14,640
those IP addresses those are basically

873
00:28:14,640 --> 00:28:16,740
what's called RFC 1918 or basically

874
00:28:16,740 --> 00:28:18,960
internal your internal non-routable IP

875
00:28:18,960 --> 00:28:20,039
addresses right meaning you can't

876
00:28:20,039 --> 00:28:21,480
connect to these on the Internet or you

877
00:28:21,480 --> 00:28:22,740
shouldn't be able to connect to these on

878
00:28:22,740 --> 00:28:25,080
the internet so what they're doing is

879
00:28:25,080 --> 00:28:27,120
they're saying hey I got into I got

880
00:28:27,120 --> 00:28:29,100
access to this organization what other

881
00:28:29,100 --> 00:28:31,620
internal systems are also vulnerable

882
00:28:31,620 --> 00:28:33,240
right because most people I had a

883
00:28:33,240 --> 00:28:35,520
conversation with a system administrator

884
00:28:35,520 --> 00:28:37,200
um and I was he was asking me hey why do

885
00:28:37,200 --> 00:28:39,179
I need to secure my server when we have

886
00:28:39,179 --> 00:28:41,400
a firewall IDs all this stuff on the

887
00:28:41,400 --> 00:28:42,840
outside and it's protected right

888
00:28:42,840 --> 00:28:44,820
basically you have like six dead bolts

889
00:28:44,820 --> 00:28:46,559
on your front door why do you need to

890
00:28:46,559 --> 00:28:48,600
put your your jury and your money and

891
00:28:48,600 --> 00:28:50,220
all that stuff in a safe and all the

892
00:28:50,220 --> 00:28:51,240
other stuff why can't I just leave it

893
00:28:51,240 --> 00:28:52,980
out on the kitchen counter

894
00:28:52,980 --> 00:28:55,200
and I said to him because attackers once

895
00:28:55,200 --> 00:28:56,520
they do get in or if they're already in

896
00:28:56,520 --> 00:28:58,320
or Insider attacks right we talked about

897
00:28:58,320 --> 00:28:59,580
Insider attacks and some of the other

898
00:28:59,580 --> 00:29:01,200
talks they're going to scan inside

899
00:29:01,200 --> 00:29:02,340
because they're like hey your security

900
00:29:02,340 --> 00:29:04,559
posture within your organization

901
00:29:04,559 --> 00:29:07,919
um is probably not as as uh fortified as

902
00:29:07,919 --> 00:29:10,320
the perimeter so just another example of

903
00:29:10,320 --> 00:29:12,600
why it's important to to either practice

904
00:29:12,600 --> 00:29:14,100
zero trust since that's the buzzword

905
00:29:14,100 --> 00:29:15,900
we're using that nowadays or the assume

906
00:29:15,900 --> 00:29:16,679
breach

907
00:29:16,679 --> 00:29:19,080
because once they get in how protected

908
00:29:19,080 --> 00:29:21,419
are you there right

909
00:29:21,419 --> 00:29:23,820
and then this is another example of the

910
00:29:23,820 --> 00:29:25,260
passwords that they're using so this was

911
00:29:25,260 --> 00:29:27,299
hard-coded in a shell script for that

912
00:29:27,299 --> 00:29:29,580
particular exploit right if you can't

913
00:29:29,580 --> 00:29:31,500
read it it's basically root redis Oracle

914
00:29:31,500 --> 00:29:33,539
password password with the Ampersand in

915
00:29:33,539 --> 00:29:36,240
there and a zero for the for the o

916
00:29:36,240 --> 00:29:37,860
um and it was only about 10 passwords in

917
00:29:37,860 --> 00:29:40,559
there right not 10 000 not 10 million

918
00:29:40,559 --> 00:29:41,940
right they weren't reaching out to some

919
00:29:41,940 --> 00:29:43,500
server and pulling down a password list

920
00:29:43,500 --> 00:29:45,299
it was only a handful

921
00:29:45,299 --> 00:29:47,399
and they're getting access this way

922
00:29:47,399 --> 00:29:48,659
so that's that's telling you something

923
00:29:48,659 --> 00:29:50,399
and where are they scanning internal

924
00:29:50,399 --> 00:29:52,860
servers

925
00:29:52,860 --> 00:29:55,260
other observations so like I said a lot

926
00:29:55,260 --> 00:29:56,580
of the binary strings if you're looking

927
00:29:56,580 --> 00:29:58,140
at malware samples and they're Mirai

928
00:29:58,140 --> 00:29:59,700
variants a lot of the attackers aren't

929
00:29:59,700 --> 00:30:01,440
changing the default string which is

930
00:30:01,440 --> 00:30:03,360
basically dead beef right or when you're

931
00:30:03,360 --> 00:30:05,220
looking at disassembly and binary ninja

932
00:30:05,220 --> 00:30:06,659
or Ida or whatever you're looking at it

933
00:30:06,659 --> 00:30:09,899
comes up as zero um uh 22 basically

934
00:30:09,899 --> 00:30:12,899
right so you'll see 22 if you can read C

935
00:30:12,899 --> 00:30:15,539
code that's that's basically

936
00:30:15,539 --> 00:30:16,980
the function for decrypting it

937
00:30:16,980 --> 00:30:18,659
encrypting it

938
00:30:18,659 --> 00:30:20,399
and then here's what it looks like when

939
00:30:20,399 --> 00:30:22,380
you see it in the strings right so the

940
00:30:22,380 --> 00:30:26,520
first one uh uh P mmv that usually

941
00:30:26,520 --> 00:30:29,760
decrypts to root

942
00:30:29,760 --> 00:30:32,820
so in about four or five lines of python

943
00:30:32,820 --> 00:30:35,039
you can essentially Brute Force this key

944
00:30:35,039 --> 00:30:37,740
space to figure out what um what the

945
00:30:37,740 --> 00:30:41,539
encryption what what the key is for it

946
00:30:41,940 --> 00:30:45,840
another observation is basically crypto

947
00:30:45,840 --> 00:30:47,640
mining right I saw this particular

948
00:30:47,640 --> 00:30:49,500
config in one of the binaries and I was

949
00:30:49,500 --> 00:30:51,059
trying to figure out like what does this

950
00:30:51,059 --> 00:30:53,039
user thing look like so I went out to

951
00:30:53,039 --> 00:30:54,659
the GitHub and I saw it was the wallet

952
00:30:54,659 --> 00:30:56,399
address and this is what it looks like

953
00:30:56,399 --> 00:30:58,200
in the actual binary

954
00:30:58,200 --> 00:30:59,880
so I was like okay I got the wallet

955
00:30:59,880 --> 00:31:02,039
address I found about three unique

956
00:31:02,039 --> 00:31:04,260
wallet addresses but like I said Monero

957
00:31:04,260 --> 00:31:06,480
is designed not to be traceable so if

958
00:31:06,480 --> 00:31:08,340
you take this wallet address and you

959
00:31:08,340 --> 00:31:10,620
plug it into like the Monero Explorer

960
00:31:10,620 --> 00:31:12,299
like there's a for those of you into

961
00:31:12,299 --> 00:31:14,039
crypto there's different explorers right

962
00:31:14,039 --> 00:31:16,080
so you have eth Explorer you have a a

963
00:31:16,080 --> 00:31:17,760
Bitcoin Explorer you can plug a wallet

964
00:31:17,760 --> 00:31:19,320
address in and you can see like how much

965
00:31:19,320 --> 00:31:21,240
funds are in that particular wallet well

966
00:31:21,240 --> 00:31:23,159
with Monero when you do it it says hey

967
00:31:23,159 --> 00:31:25,260
you're trying to see how much funds this

968
00:31:25,260 --> 00:31:26,880
dude has in his wallet sorry you can't

969
00:31:26,880 --> 00:31:29,340
do that right it has some quirky message

970
00:31:29,340 --> 00:31:31,080
like that

971
00:31:31,080 --> 00:31:32,279
um but the other thing that you can take

972
00:31:32,279 --> 00:31:34,140
away from this is you know by default

973
00:31:34,140 --> 00:31:36,360
TLS is disabled

974
00:31:36,360 --> 00:31:38,399
they deploy it the same way TLS is

975
00:31:38,399 --> 00:31:40,679
disabled so if you're trying to look for

976
00:31:40,679 --> 00:31:42,480
it I believe it's a 95 character string

977
00:31:42,480 --> 00:31:44,520
so you can write some snort or or

978
00:31:44,520 --> 00:31:47,220
cerakata uh rules to kind of detect this

979
00:31:47,220 --> 00:31:48,720
on The Wire

980
00:31:48,720 --> 00:31:50,220
and then a lot of the pools if you do

981
00:31:50,220 --> 00:31:51,720
want to find out how much funds they've

982
00:31:51,720 --> 00:31:54,480
accumulated over time some of the pools

983
00:31:54,480 --> 00:31:56,039
have a website tied to them you can go

984
00:31:56,039 --> 00:31:57,720
to that website and then plug in the

985
00:31:57,720 --> 00:31:59,279
wallet addressing it'll say hey they've

986
00:31:59,279 --> 00:32:00,779
made like you know ten thousand twenty

987
00:32:00,779 --> 00:32:02,340
thousand since they've started using

988
00:32:02,340 --> 00:32:04,140
that particular pool it's not how much

989
00:32:04,140 --> 00:32:05,940
they have in the wallet in aggregate

990
00:32:05,940 --> 00:32:07,559
just how much they've mined on that

991
00:32:07,559 --> 00:32:09,840
particular pool

992
00:32:09,840 --> 00:32:11,779
and then another observation is

993
00:32:11,779 --> 00:32:15,179
hard-coded user agent strings right I've

994
00:32:15,179 --> 00:32:16,980
been a part of organizations where they

995
00:32:16,980 --> 00:32:18,899
say hey let's Baseline the user age

996
00:32:18,899 --> 00:32:21,120
strings and just look for this or Cobalt

997
00:32:21,120 --> 00:32:23,100
strike has this user user agent string

998
00:32:23,100 --> 00:32:25,260
let's look for that right the the danger

999
00:32:25,260 --> 00:32:26,880
with this is let's say your organization

1000
00:32:26,880 --> 00:32:28,740
baselines your user agent strengths but

1001
00:32:28,740 --> 00:32:30,120
your user agent strings in this list

1002
00:32:30,120 --> 00:32:31,559
then this is going to fly under the

1003
00:32:31,559 --> 00:32:34,500
radar right so when you're doing things

1004
00:32:34,500 --> 00:32:35,820
like this just have a lot of other

1005
00:32:35,820 --> 00:32:37,500
things that enhances the confidence and

1006
00:32:37,500 --> 00:32:38,820
whatever detection you're building so

1007
00:32:38,820 --> 00:32:41,039
don't just look for a naked user agent

1008
00:32:41,039 --> 00:32:43,380
string as as like that's good this

1009
00:32:43,380 --> 00:32:44,820
particular malware what it does is every

1010
00:32:44,820 --> 00:32:46,440
time it goes out and scans and tries to

1011
00:32:46,440 --> 00:32:48,480
connect to another system it randomizes

1012
00:32:48,480 --> 00:32:51,860
which user agent string it uses

1013
00:32:54,299 --> 00:32:55,980
all right

1014
00:32:55,980 --> 00:32:57,899
so what's the so what what's the what's

1015
00:32:57,899 --> 00:32:59,940
the takeaway right like what's the point

1016
00:32:59,940 --> 00:33:02,340
of all of this

1017
00:33:02,340 --> 00:33:03,840
um if you're a non-tech person you

1018
00:33:03,840 --> 00:33:04,799
should be able to get something from

1019
00:33:04,799 --> 00:33:07,080
this the whole point of all this is

1020
00:33:07,080 --> 00:33:08,039
there's a lot of noise on the internet

1021
00:33:08,039 --> 00:33:10,500
right you plug a system a server let's

1022
00:33:10,500 --> 00:33:12,299
say you spin up a VPS

1023
00:33:12,299 --> 00:33:13,679
um you take your Raspberry Pi and you

1024
00:33:13,679 --> 00:33:15,539
plug it into some public facing internet

1025
00:33:15,539 --> 00:33:17,519
thing there's gonna be a ton of scans

1026
00:33:17,519 --> 00:33:19,080
most of you know this

1027
00:33:19,080 --> 00:33:20,820
all right so that's the first part a ton

1028
00:33:20,820 --> 00:33:22,080
of Internet noise

1029
00:33:22,080 --> 00:33:23,399
what are they trying to do they're

1030
00:33:23,399 --> 00:33:25,620
trying to build a botnet they're trying

1031
00:33:25,620 --> 00:33:27,419
to take over your computer to to

1032
00:33:27,419 --> 00:33:29,460
basically leverage it as a part of their

1033
00:33:29,460 --> 00:33:31,440
army your computer can be an IP camera

1034
00:33:31,440 --> 00:33:33,960
uh your smart your smart thermostat it

1035
00:33:33,960 --> 00:33:36,299
can be you know your VPS in the cloud it

1036
00:33:36,299 --> 00:33:38,820
could be a Honeypot whatever it is right

1037
00:33:38,820 --> 00:33:40,559
their goal is to capture as many

1038
00:33:40,559 --> 00:33:42,240
computers as possible and turn them into

1039
00:33:42,240 --> 00:33:43,799
zombie computers that they can basically

1040
00:33:43,799 --> 00:33:45,480
press a button and say hey all these

1041
00:33:45,480 --> 00:33:47,100
computers that I own I want them to

1042
00:33:47,100 --> 00:33:49,200
attack XYZ system

1043
00:33:49,200 --> 00:33:51,179
the other component to this is they want

1044
00:33:51,179 --> 00:33:53,159
to be able to lease that out right so

1045
00:33:53,159 --> 00:33:54,600
right now you're not using your vehicle

1046
00:33:54,600 --> 00:33:57,179
what if while your vehicle while you're

1047
00:33:57,179 --> 00:33:59,220
here at b-sides you could say hey I can

1048
00:33:59,220 --> 00:34:00,840
make money with my car because while I'm

1049
00:34:00,840 --> 00:34:03,120
at b-sides for three four hours you can

1050
00:34:03,120 --> 00:34:04,620
drive my car and I get paid you know a

1051
00:34:04,620 --> 00:34:05,580
thousand dollars for the time that you

1052
00:34:05,580 --> 00:34:06,899
have my car right that's essentially

1053
00:34:06,899 --> 00:34:08,280
what they're doing here they're saying

1054
00:34:08,280 --> 00:34:09,719
hey I'm not using this botnet I don't

1055
00:34:09,719 --> 00:34:10,918
need it for anything right now but if

1056
00:34:10,918 --> 00:34:12,899
you want to use it for a week pay me 10

1057
00:34:12,899 --> 00:34:14,940
grand and you can have it I believe the

1058
00:34:14,940 --> 00:34:17,159
business of the talk a couple talks

1059
00:34:17,159 --> 00:34:18,179
before this they talked about it was

1060
00:34:18,179 --> 00:34:20,099
like 30 an hour to rent a different

1061
00:34:20,099 --> 00:34:21,960
malware or whatever so they're basically

1062
00:34:21,960 --> 00:34:23,699
building the botnet and then making

1063
00:34:23,699 --> 00:34:26,460
money off cabinet

1064
00:34:26,460 --> 00:34:28,379
the other thing is mining there's a ton

1065
00:34:28,379 --> 00:34:30,480
of like mining like most of the malware

1066
00:34:30,480 --> 00:34:32,040
you see have a component to attack other

1067
00:34:32,040 --> 00:34:34,379
systems they have a component to

1068
00:34:34,379 --> 00:34:37,080
export other systems a ton of things but

1069
00:34:37,080 --> 00:34:39,719
the the like second second thing that I

1070
00:34:39,719 --> 00:34:41,760
see the most is

1071
00:34:41,760 --> 00:34:43,739
um kill every single other Bitcoin or

1072
00:34:43,739 --> 00:34:45,239
crypto Miner that exists on that system

1073
00:34:45,239 --> 00:34:49,739
by name I believe uh the there's one one

1074
00:34:49,739 --> 00:34:52,099
malware I saw in it I had like probably

1075
00:34:52,099 --> 00:34:55,199
50 different names for other competing

1076
00:34:55,199 --> 00:34:57,300
uh malware things that could be or

1077
00:34:57,300 --> 00:34:58,920
miners that could be in a system and it

1078
00:34:58,920 --> 00:35:00,300
kills all of those processes before it

1079
00:35:00,300 --> 00:35:02,940
runs its own so that's the second thing

1080
00:35:02,940 --> 00:35:04,560
that I see in there specifically Monero

1081
00:35:04,560 --> 00:35:07,619
I have not seen any other types I'm not

1082
00:35:07,619 --> 00:35:09,119
saying that there aren't but I haven't

1083
00:35:09,119 --> 00:35:10,859
particularly seen that I mostly see

1084
00:35:10,859 --> 00:35:13,020
Monero and the XM rig which is a public

1085
00:35:13,020 --> 00:35:16,079
uh it's an open source minor

1086
00:35:16,079 --> 00:35:17,880
and then the last thing that you can

1087
00:35:17,880 --> 00:35:19,079
take away from this right is

1088
00:35:19,079 --> 00:35:21,359
opportunistic threat actors you saw when

1089
00:35:21,359 --> 00:35:23,160
I showed you the example of like a the

1090
00:35:23,160 --> 00:35:25,560
log of someone logging in because they

1091
00:35:25,560 --> 00:35:26,760
know there's a lot of noise out there

1092
00:35:26,760 --> 00:35:28,320
and there's a ton of scans most people

1093
00:35:28,320 --> 00:35:29,520
just ignore it they're like hey it's

1094
00:35:29,520 --> 00:35:31,320
just noise everyone gets scanned it's

1095
00:35:31,320 --> 00:35:32,880
Port 22 they're going to scan it 23

1096
00:35:32,880 --> 00:35:33,780
they're going to scan it 80 they're

1097
00:35:33,780 --> 00:35:35,700
going to scan it like what's the point

1098
00:35:35,700 --> 00:35:37,320
well attackers know this and so what

1099
00:35:37,320 --> 00:35:38,400
they're going to do is they're going to

1100
00:35:38,400 --> 00:35:39,660
fly in under the radar and they're going

1101
00:35:39,660 --> 00:35:41,520
to say hey within this noise I'm going

1102
00:35:41,520 --> 00:35:43,079
to try to like use the same password

1103
00:35:43,079 --> 00:35:45,540
right admin password or whatever the

1104
00:35:45,540 --> 00:35:46,920
default passwords are and I'm gonna see

1105
00:35:46,920 --> 00:35:49,500
if I can compromise a system but they're

1106
00:35:49,500 --> 00:35:51,180
typically going to be after things like

1107
00:35:51,180 --> 00:35:52,680
intellectual property right they're

1108
00:35:52,680 --> 00:35:55,260
going to be after whatever thing that's

1109
00:35:55,260 --> 00:35:56,880
valuable there maybe they're looking for

1110
00:35:56,880 --> 00:35:58,260
you know maybe right now you're

1111
00:35:58,260 --> 00:36:00,119
connected to Wi-Fi right everybody has

1112
00:36:00,119 --> 00:36:02,220
the same password but you have open

1113
00:36:02,220 --> 00:36:04,020
share on your Windows computer and you

1114
00:36:04,020 --> 00:36:05,099
have a bunch of pictures on there you

1115
00:36:05,099 --> 00:36:06,599
probably shouldn't have on there well

1116
00:36:06,599 --> 00:36:08,040
anyone in this room that's a part of

1117
00:36:08,040 --> 00:36:09,420
that Network can see that share and

1118
00:36:09,420 --> 00:36:10,980
connect and download those pictures

1119
00:36:10,980 --> 00:36:13,380
right that's a true story happen to me

1120
00:36:13,380 --> 00:36:16,020
during a deployment I had a soldier he

1121
00:36:16,020 --> 00:36:17,579
didn't know anything about security I

1122
00:36:17,579 --> 00:36:18,900
wasn't in security at the time I was

1123
00:36:18,900 --> 00:36:21,540
still a mechanic but I was deployed and

1124
00:36:21,540 --> 00:36:22,700
yeah someone

1125
00:36:22,700 --> 00:36:25,079
basically got his pictures of his wife

1126
00:36:25,079 --> 00:36:26,400
that he had on his computer and he

1127
00:36:26,400 --> 00:36:28,079
didn't know how he just said hey someone

1128
00:36:28,079 --> 00:36:29,640
hacked my computer because my the

1129
00:36:29,640 --> 00:36:32,220
pictures ended up somewhere right so

1130
00:36:32,220 --> 00:36:33,839
these are things that uh that are

1131
00:36:33,839 --> 00:36:35,579
happening out there when you go back

1132
00:36:35,579 --> 00:36:37,079
home or when you're conversing with your

1133
00:36:37,079 --> 00:36:38,400
colleagues this is essentially what I

1134
00:36:38,400 --> 00:36:40,500
want you to kind of take away as of

1135
00:36:40,500 --> 00:36:42,060
these three things

1136
00:36:42,060 --> 00:36:43,619
here's my contact information if you

1137
00:36:43,619 --> 00:36:44,640
want to reach out if you want to

1138
00:36:44,640 --> 00:36:46,800
collaborate those Splunk queries that I

1139
00:36:46,800 --> 00:36:48,420
show if there's any Splunk experts in

1140
00:36:48,420 --> 00:36:50,160
here if you want to you know tell me how

1141
00:36:50,160 --> 00:36:51,720
you can I can optimize that a little bit

1142
00:36:51,720 --> 00:36:53,880
better or

1143
00:36:53,880 --> 00:36:55,320
um tell me how jacked up I am because

1144
00:36:55,320 --> 00:36:57,180
you could do it in like one line hey by

1145
00:36:57,180 --> 00:36:58,800
all means you know reach out to me on

1146
00:36:58,800 --> 00:37:00,480
Twitter or come down after uh because

1147
00:37:00,480 --> 00:37:02,579
I'm always willing to learn and grow all

1148
00:37:02,579 --> 00:37:06,020
right are there any questions

1149
00:37:19,200 --> 00:37:21,240
okay so the question is

1150
00:37:21,240 --> 00:37:23,160
um there's things like VM Escape right

1151
00:37:23,160 --> 00:37:25,920
where you they can exit the VM so with

1152
00:37:25,920 --> 00:37:27,780
the Honeypot can they escape from that

1153
00:37:27,780 --> 00:37:30,060
and land on a system sure there probably

1154
00:37:30,060 --> 00:37:31,980
is I'm not aware of any right now and

1155
00:37:31,980 --> 00:37:34,260
there's not been any published how I

1156
00:37:34,260 --> 00:37:35,760
mitigate that is there's there's really

1157
00:37:35,760 --> 00:37:38,520
I pull there's nothing

1158
00:37:38,520 --> 00:37:40,140
nothing of value they're going to get

1159
00:37:40,140 --> 00:37:41,640
from basically doing that right so if

1160
00:37:41,640 --> 00:37:44,099
they escape they'll land on the VM and

1161
00:37:44,099 --> 00:37:46,020
they can maybe wipe all the logs but

1162
00:37:46,020 --> 00:37:47,280
none of this infrastructure is there's

1163
00:37:47,280 --> 00:37:49,020
no attribution right so it's not

1164
00:37:49,020 --> 00:37:51,180
attributed to my my company it's not

1165
00:37:51,180 --> 00:37:52,619
attributed to

1166
00:37:52,619 --> 00:37:54,599
um you know any particular organization

1167
00:37:54,599 --> 00:37:56,640
and I'll be able to detect it rather

1168
00:37:56,640 --> 00:37:58,440
quickly just because it's the detections

1169
00:37:58,440 --> 00:38:00,119
that I have in place right so the answer

1170
00:38:00,119 --> 00:38:01,800
to your question is is anything is

1171
00:38:01,800 --> 00:38:03,660
possible Right Tavis ormondy who's the

1172
00:38:03,660 --> 00:38:05,220
guy that's like hacked a lot of things

1173
00:38:05,220 --> 00:38:06,540
that people thought wasn't hackable and

1174
00:38:06,540 --> 00:38:07,920
there's a ton of other folks that go to

1175
00:38:07,920 --> 00:38:09,599
pone to own in these competitions and

1176
00:38:09,599 --> 00:38:12,540
and you know Apple releases a new

1177
00:38:12,540 --> 00:38:14,280
product and then the next day it's owned

1178
00:38:14,280 --> 00:38:16,440
right so we know this happens

1179
00:38:16,440 --> 00:38:18,720
does that answer your question

1180
00:38:18,720 --> 00:38:22,040
okay there was another hand

1181
00:38:31,440 --> 00:38:34,500
yes so there's a ton of stuff that Kyrie

1182
00:38:34,500 --> 00:38:35,760
does by default that's signature ball

1183
00:38:35,760 --> 00:38:38,040
one of them is the process list if you

1184
00:38:38,040 --> 00:38:39,720
don't change anything it looks like it's

1185
00:38:39,720 --> 00:38:42,780
I believe it's June uh 2021 or something

1186
00:38:42,780 --> 00:38:44,640
like that so I you can edit some of the

1187
00:38:44,640 --> 00:38:45,960
files you can basically edit the source

1188
00:38:45,960 --> 00:38:47,760
code it's all in Python and I change

1189
00:38:47,760 --> 00:38:49,220
that to a different date

1190
00:38:49,220 --> 00:38:51,300
and you just have to kind of go through

1191
00:38:51,300 --> 00:38:52,680
the source code and look at it you can

1192
00:38:52,680 --> 00:38:54,900
log in yourself and see what some things

1193
00:38:54,900 --> 00:38:56,220
that are static and I believe some

1194
00:38:56,220 --> 00:38:57,420
people have written some blogs about

1195
00:38:57,420 --> 00:39:00,839
some things out there the file system by

1196
00:39:00,839 --> 00:39:03,900
default is is doesn't show a lot so you

1197
00:39:03,900 --> 00:39:06,240
have to you have to I would look at the

1198
00:39:06,240 --> 00:39:08,040
docs and I can talk to you after this if

1199
00:39:08,040 --> 00:39:09,599
you want but there's a there's a ton of

1200
00:39:09,599 --> 00:39:11,040
stuff that's signature but some of it's

1201
00:39:11,040 --> 00:39:12,599
not really worth the effort because a

1202
00:39:12,599 --> 00:39:13,680
lot of people that log in they're not

1203
00:39:13,680 --> 00:39:15,060
looking for that they're doing the easy

1204
00:39:15,060 --> 00:39:16,980
things does it have the Richard user

1205
00:39:16,980 --> 00:39:19,859
does it have the fill user is the date

1206
00:39:19,859 --> 00:39:21,839
uh you know June because when you do the

1207
00:39:21,839 --> 00:39:23,400
process list it's exactly the same every

1208
00:39:23,400 --> 00:39:25,079
single time I don't know why most people

1209
00:39:25,079 --> 00:39:28,200
don't see that but it's pretty buddy and

1210
00:39:28,200 --> 00:39:30,720
then of course like the um the the when

1211
00:39:30,720 --> 00:39:31,859
you do you name if you don't change the

1212
00:39:31,859 --> 00:39:34,020
default Kyrie has a default um like

1213
00:39:34,020 --> 00:39:35,640
kernel version that's in there so I

1214
00:39:35,640 --> 00:39:37,260
changed a lot of that and I automate it

1215
00:39:37,260 --> 00:39:38,520
so I don't have to go through and like

1216
00:39:38,520 --> 00:39:39,900
fix it so right now if I wanted to

1217
00:39:39,900 --> 00:39:41,579
change the versions on all my honey pots

1218
00:39:41,579 --> 00:39:42,780
I would just go into the ammo change

1219
00:39:42,780 --> 00:39:44,579
that particular config push it out and

1220
00:39:44,579 --> 00:39:46,940
it's done

1221
00:39:56,820 --> 00:39:58,320
um so that's done automatically yeah if

1222
00:39:58,320 --> 00:39:59,820
someone logs in I mean you can have

1223
00:39:59,820 --> 00:40:02,220
concurrent users logged in so it's not a

1224
00:40:02,220 --> 00:40:04,200
one at a time type thing right so if

1225
00:40:04,200 --> 00:40:05,460
they log in they download like a

1226
00:40:05,460 --> 00:40:07,440
gigabyte file and they come back again

1227
00:40:07,440 --> 00:40:09,780
10 hours later two days later it's hands

1228
00:40:09,780 --> 00:40:12,680
off I don't have to do anything

1229
00:40:12,720 --> 00:40:14,720
um

1230
00:40:15,540 --> 00:40:17,460
uh no I don't I don't refresh it other

1231
00:40:17,460 --> 00:40:19,380
than the normal updates to Kyrie so if

1232
00:40:19,380 --> 00:40:20,880
Kyrie has an update I'll do a get pull

1233
00:40:20,880 --> 00:40:22,740
I'll look at the change log to see

1234
00:40:22,740 --> 00:40:23,880
what's changed and then make sure

1235
00:40:23,880 --> 00:40:25,440
there's no disruption and I'll do a pull

1236
00:40:25,440 --> 00:40:27,720
and so I don't know how many people know

1237
00:40:27,720 --> 00:40:28,740
about git but basically you can pull

1238
00:40:28,740 --> 00:40:30,240
down the code it's like Download update

1239
00:40:30,240 --> 00:40:32,400
in it so other than updates no I don't I

1240
00:40:32,400 --> 00:40:34,200
don't change anything now if I see

1241
00:40:34,200 --> 00:40:36,060
there's new things that are signature I

1242
00:40:36,060 --> 00:40:37,920
will change it right so if there's if I

1243
00:40:37,920 --> 00:40:39,240
see a trend of like every time they

1244
00:40:39,240 --> 00:40:41,640
connect they do a a grip or something

1245
00:40:41,640 --> 00:40:43,079
and then they log off right away I'll

1246
00:40:43,079 --> 00:40:44,579
look and see what that thing is and then

1247
00:40:44,579 --> 00:40:46,940
I'll adjust

1248
00:40:48,240 --> 00:40:50,520
website and two questions what what are

1249
00:40:50,520 --> 00:40:53,300
you spending on the architecture

1250
00:40:53,300 --> 00:40:55,260
so this is one of the questions I

1251
00:40:55,260 --> 00:40:56,760
predicted would be asked it's less than

1252
00:40:56,760 --> 00:40:58,200
a hundred dollars right the the biggest

1253
00:40:58,200 --> 00:40:59,760
cost for me for this you can you can

1254
00:40:59,760 --> 00:41:01,079
there's a there's a company called Sky

1255
00:41:01,079 --> 00:41:03,119
silk you can run a VPS as a part of the

1256
00:41:03,119 --> 00:41:04,800
beta program it's like four bucks for

1257
00:41:04,800 --> 00:41:06,660
one VPS right and that could be a lot of

1258
00:41:06,660 --> 00:41:08,040
money for some people

1259
00:41:08,040 --> 00:41:10,200
um but the biggest cost is storage and

1260
00:41:10,200 --> 00:41:11,460
so one of the things I'm trying to do is

1261
00:41:11,460 --> 00:41:12,780
move to something called smart store

1262
00:41:12,780 --> 00:41:14,940
Splunk has a way for you to push the

1263
00:41:14,940 --> 00:41:17,880
data within Splunk to S3

1264
00:41:17,880 --> 00:41:19,859
um and that's that's really optimized

1265
00:41:19,859 --> 00:41:20,880
for things that you don't want to search

1266
00:41:20,880 --> 00:41:22,619
long term if you're doing a lot of uh

1267
00:41:22,619 --> 00:41:24,900
searches across a long length of time

1268
00:41:24,900 --> 00:41:26,220
like a month or something like that you

1269
00:41:26,220 --> 00:41:27,300
don't want to do that but if it's only

1270
00:41:27,300 --> 00:41:31,579
like 24 hours 48 hours then that's fine

1271
00:41:39,540 --> 00:41:40,920
yeah definitely

1272
00:41:40,920 --> 00:41:43,440
um in different like in the Asian region

1273
00:41:43,440 --> 00:41:45,300
there's a lot there's a lot the attacks

1274
00:41:45,300 --> 00:41:46,500
that happen over there in malware that I

1275
00:41:46,500 --> 00:41:47,760
see there I don't see in other places

1276
00:41:47,760 --> 00:41:52,380
like U.S or or the EU right I don't have

1277
00:41:52,380 --> 00:41:53,820
a large sample size that's just what

1278
00:41:53,820 --> 00:41:55,079
they've attacked and what I have

1279
00:41:55,079 --> 00:41:57,180
obviously cost is a limited factor for

1280
00:41:57,180 --> 00:41:58,079
me

1281
00:41:58,079 --> 00:42:00,300
I'd love to have more but you know

1282
00:42:00,300 --> 00:42:02,579
no one's funding the you know my

1283
00:42:02,579 --> 00:42:03,780
personal resource this is something I'm

1284
00:42:03,780 --> 00:42:07,520
doing on my own time

1285
00:42:12,060 --> 00:42:14,280
ah oh

1286
00:42:14,280 --> 00:42:16,200
um so that's easy so Splunk allows you

1287
00:42:16,200 --> 00:42:17,640
to get two types of license you can get

1288
00:42:17,640 --> 00:42:19,380
a developer license that's I believe 50

1289
00:42:19,380 --> 00:42:21,480
gigs and then one that's 10 gigs the 50

1290
00:42:21,480 --> 00:42:24,599
gig one has like this big banner across

1291
00:42:24,599 --> 00:42:26,099
that says like you're emailing all that

1292
00:42:26,099 --> 00:42:27,240
stuff and then there's one that's 10

1293
00:42:27,240 --> 00:42:29,099
gigs so I basically applied a Splunk and

1294
00:42:29,099 --> 00:42:30,780
I say hey I'm a developer because I

1295
00:42:30,780 --> 00:42:32,760
create apps

1296
00:42:32,760 --> 00:42:34,920
for the for the platform and that's how

1297
00:42:34,920 --> 00:42:36,720
I get the license the amount of data

1298
00:42:36,720 --> 00:42:38,579
that I see doesn't exceed the license

1299
00:42:38,579 --> 00:42:41,000
that I have

1300
00:42:47,820 --> 00:42:50,220
not

1301
00:42:50,220 --> 00:42:52,020
has been using

1302
00:42:52,020 --> 00:42:53,760
to cleaning up their action

1303
00:42:53,760 --> 00:42:56,839
downloading all these things

1304
00:42:57,480 --> 00:43:00,000
uh no Kyrie by Design doesn't allow that

1305
00:43:00,000 --> 00:43:01,560
to happen yeah so the whole point of it

1306
00:43:01,560 --> 00:43:03,720
is to capture those artifacts and it

1307
00:43:03,720 --> 00:43:05,160
wouldn't really be good to do that

1308
00:43:05,160 --> 00:43:06,780
because then if you created commands to

1309
00:43:06,780 --> 00:43:08,160
prevent that then they could probably

1310
00:43:08,160 --> 00:43:10,260
bypass that so yeah by Design artifact

1311
00:43:10,260 --> 00:43:12,660
gets on the box that's stuck there's

1312
00:43:12,660 --> 00:43:14,640
even mechanisms to push it to S3 and

1313
00:43:14,640 --> 00:43:16,020
these different platforms if you look at

1314
00:43:16,020 --> 00:43:17,520
the config there's like a ton of outputs

1315
00:43:17,520 --> 00:43:19,140
you can you can send it to misp you can

1316
00:43:19,140 --> 00:43:20,760
send it to virus total you can send it

1317
00:43:20,760 --> 00:43:23,220
to the honeynet project I mean there's

1318
00:43:23,220 --> 00:43:25,440
just a ton I just used a Splunk UF to

1319
00:43:25,440 --> 00:43:27,180
extract the data because I'm doing some

1320
00:43:27,180 --> 00:43:28,500
manipulations with it right like I'm

1321
00:43:28,500 --> 00:43:29,760
basically normalizing it and creating

1322
00:43:29,760 --> 00:43:31,260
different event types and all these

1323
00:43:31,260 --> 00:43:33,440
things

1324
00:43:35,339 --> 00:43:37,500
tell the box that

1325
00:43:37,500 --> 00:43:39,839
would maybe try to bypass

1326
00:43:39,839 --> 00:43:40,980
ING with notice that you're sitting

1327
00:43:40,980 --> 00:43:42,180
stuff to support

1328
00:43:42,180 --> 00:43:44,160
or notice you know maybe that's just the

1329
00:43:44,160 --> 00:43:46,339
process

1330
00:43:48,720 --> 00:43:51,540
uh no I've not I have not personally

1331
00:43:51,540 --> 00:43:53,339
seen anyone

1332
00:43:53,339 --> 00:43:55,980
um escape the the Honeypot onto the

1333
00:43:55,980 --> 00:43:57,599
whole system

1334
00:43:57,599 --> 00:43:59,640
um I mean if they did I just didn't

1335
00:43:59,640 --> 00:44:01,440
notice it but I haven't seen anything

1336
00:44:01,440 --> 00:44:03,839
suspicious with any of that obviously

1337
00:44:03,839 --> 00:44:05,220
there's no login generated if they land

1338
00:44:05,220 --> 00:44:07,319
on the system but I log everything and

1339
00:44:07,319 --> 00:44:09,480
there's there's you know access controls

1340
00:44:09,480 --> 00:44:11,040
in place so that only certain IP

1341
00:44:11,040 --> 00:44:12,780
addresses can access them right so for

1342
00:44:12,780 --> 00:44:13,920
instance my home address is the only

1343
00:44:13,920 --> 00:44:16,740
thing that can touch the AWS the Splunk

1344
00:44:16,740 --> 00:44:19,380
indexer where all the data goes and the

1345
00:44:19,380 --> 00:44:21,060
same thing with the with the honey pots

1346
00:44:21,060 --> 00:44:22,500
the only Port they can do is the

1347
00:44:22,500 --> 00:44:23,819
basically the index Port right which

1348
00:44:23,819 --> 00:44:25,920
which is uh whatever I configured it to

1349
00:44:25,920 --> 00:44:27,420
be

1350
00:44:27,420 --> 00:44:30,200
in the back

1351
00:44:38,040 --> 00:44:40,020
uh so what kind of complexity are you

1352
00:44:40,020 --> 00:44:42,440
suggesting

1353
00:44:47,160 --> 00:44:48,599
yeah that's a good idea I haven't done

1354
00:44:48,599 --> 00:44:50,640
that so some of my next steps is to add

1355
00:44:50,640 --> 00:44:52,980
like web-based honey pots to this right

1356
00:44:52,980 --> 00:44:54,839
so there's snare and tenor as a product

1357
00:44:54,839 --> 00:44:55,920
that's out there that I'm kind of

1358
00:44:55,920 --> 00:44:57,060
evaluating

1359
00:44:57,060 --> 00:44:59,099
um but that's that's a good idea as well

1360
00:44:59,099 --> 00:45:01,859
um I just haven't done that yet right

1361
00:45:01,859 --> 00:45:04,819
any other questions

1362
00:45:10,980 --> 00:45:13,440
they don't know so essentially all the

1363
00:45:13,440 --> 00:45:15,720
honey pots have Port 22 exposed so all

1364
00:45:15,720 --> 00:45:18,060
they know is that Port 22 is open and I

1365
00:45:18,060 --> 00:45:19,740
used admin and password and I got in or

1366
00:45:19,740 --> 00:45:22,079
I used Root and root and I got in and

1367
00:45:22,079 --> 00:45:23,819
then most of it's automated or if

1368
00:45:23,819 --> 00:45:25,140
they're doing it manually they're

1369
00:45:25,140 --> 00:45:26,520
they're doing their reconnaissance to

1370
00:45:26,520 --> 00:45:29,540
figure out what it is right

1371
00:45:29,700 --> 00:45:31,500
um there was there was someone I met

1372
00:45:31,500 --> 00:45:33,240
last night that talked about adding

1373
00:45:33,240 --> 00:45:35,760
honey tokens inside the honey pots right

1374
00:45:35,760 --> 00:45:37,319
so attacker lands on the box yeah that

1375
00:45:37,319 --> 00:45:38,720
was your Chris

1376
00:45:38,720 --> 00:45:41,099
basically putting like AWS tokens in

1377
00:45:41,099 --> 00:45:43,440
there or putting like brocade configs or

1378
00:45:43,440 --> 00:45:44,940
anything that would kind of entice the

1379
00:45:44,940 --> 00:45:46,800
attacker as they're looking around to

1380
00:45:46,800 --> 00:45:48,240
take those credentials and maybe you can

1381
00:45:48,240 --> 00:45:49,619
you know figure out what they're doing

1382
00:45:49,619 --> 00:45:52,140
with that and kind of do some some uh

1383
00:45:52,140 --> 00:45:53,940
analysis there so that was pretty good

1384
00:45:53,940 --> 00:45:54,720
idea I think we talked about

1385
00:45:54,720 --> 00:45:56,579
collaborating on on seeing what we could

1386
00:45:56,579 --> 00:45:58,079
do there

1387
00:45:58,079 --> 00:46:00,000
good question

1388
00:46:00,000 --> 00:46:02,640
any others

1389
00:46:02,640 --> 00:46:04,020
it's end of the day everybody's ready to

1390
00:46:04,020 --> 00:46:04,859
go home

1391
00:46:04,859 --> 00:46:06,780
parking lot Dash

1392
00:46:06,780 --> 00:46:08,640
cool all right so my name is Michael Lee

1393
00:46:08,640 --> 00:46:10,980
once again thank you uh oh yeah swag

1394
00:46:10,980 --> 00:46:14,240
swag let's see

1395
00:46:14,760 --> 00:46:18,300
okay uh

1396
00:46:20,099 --> 00:46:23,119
the question I have pre-prepared uh

1397
00:46:23,119 --> 00:46:25,740
why do I

1398
00:46:25,740 --> 00:46:28,500
filter out the Alexa top 1 million

1399
00:46:28,500 --> 00:46:31,859
domains from the URL list

1400
00:46:31,859 --> 00:46:36,560
I saw that hand black shirt go up first

1401
00:46:37,560 --> 00:46:42,500
no no not really no uh

1402
00:46:45,359 --> 00:46:46,319
oh

1403
00:46:46,319 --> 00:46:47,640
is that Daniel

1404
00:46:47,640 --> 00:46:49,859
who's who's talking

1405
00:46:49,859 --> 00:46:52,400
oh

1406
00:47:00,180 --> 00:47:04,020
no let's go back in the back

1407
00:47:04,020 --> 00:47:05,400
yeah you

1408
00:47:05,400 --> 00:47:07,400
um

1409
00:47:10,980 --> 00:47:12,960
yes there you go I mentioned that in a

1410
00:47:12,960 --> 00:47:15,000
talk so essentially people take the list

1411
00:47:15,000 --> 00:47:16,380
they'll dump it in your IDs they won't

1412
00:47:16,380 --> 00:47:17,640
check it they won't look at it and so

1413
00:47:17,640 --> 00:47:19,260
I'm kind of helping them like avoid

1414
00:47:19,260 --> 00:47:20,819
those mistakes right so I filter out the

1415
00:47:20,819 --> 00:47:22,920
Alexa top 1 million which is a list of

1416
00:47:22,920 --> 00:47:25,380
like known good or supposed to be known

1417
00:47:25,380 --> 00:47:27,060
good domains right so Google is going to

1418
00:47:27,060 --> 00:47:28,260
be in there Microsoft's going to be in

1419
00:47:28,260 --> 00:47:31,020
there you know whatever whatever you can

1420
00:47:31,020 --> 00:47:32,819
uh download that site and see what it

1421
00:47:32,819 --> 00:47:33,960
looks like

1422
00:47:33,960 --> 00:47:35,880
all right another question

1423
00:47:35,880 --> 00:47:40,200
um who remembers the IEEE RFC I

1424
00:47:40,200 --> 00:47:41,640
mentioned about those internal IP

1425
00:47:41,640 --> 00:47:44,460
addresses the 10 dots the 192. are you

1426
00:47:44,460 --> 00:47:48,200
all part of this okay go ahead

1427
00:47:49,880 --> 00:47:52,740
yes all right good

1428
00:47:52,740 --> 00:47:54,660
all right uh I just want to say thanks

1429
00:47:54,660 --> 00:47:56,040
to bsas for allowing me to speak and

1430
00:47:56,040 --> 00:47:57,180
thank you to the audience for coming and

1431
00:47:57,180 --> 00:48:00,500
listening uh have a good night

