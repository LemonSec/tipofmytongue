1
00:00:10,800 --> 00:00:12,200
right

2
00:00:12,200 --> 00:00:14,940
welcome everybody I don't know if I can

3
00:00:14,940 --> 00:00:16,859
follow that great oscent presentation

4
00:00:16,859 --> 00:00:18,539
sorry I will try not to move around too

5
00:00:18,539 --> 00:00:20,660
much

6
00:00:21,240 --> 00:00:24,960
so uh welcome I'm a

7
00:00:24,960 --> 00:00:26,519
I don't know a last minute emergency

8
00:00:26,519 --> 00:00:29,660
replacement for a a hurricane

9
00:00:29,660 --> 00:00:33,899
emergency speaker so

10
00:00:33,899 --> 00:00:36,239
Phil came Phil Plant America comes up to

11
00:00:36,239 --> 00:00:38,160
me he's like tomorrow he's like I hate

12
00:00:38,160 --> 00:00:40,620
to do this to you but I need you and I'm

13
00:00:40,620 --> 00:00:42,360
like I've been waiting my whole life for

14
00:00:42,360 --> 00:00:44,399
you to say this Phil but it turned out

15
00:00:44,399 --> 00:00:46,140
he really only wanted me to speak today

16
00:00:46,140 --> 00:00:47,640
so

17
00:00:47,640 --> 00:00:50,760
I'm here and I'm happy to be here so

18
00:00:50,760 --> 00:00:52,800
let me ask you start off by asking a

19
00:00:52,800 --> 00:00:54,360
question is anybody in here familiar

20
00:00:54,360 --> 00:00:56,340
with the Pyramid of pain

21
00:00:56,340 --> 00:00:58,440
a couple people the rest of you who are

22
00:00:58,440 --> 00:01:02,180
not why the heck are you in here

23
00:01:03,180 --> 00:01:05,580
the old talk yes yeah I don't know who

24
00:01:05,580 --> 00:01:07,200
the old talk was but sorry you're not

25
00:01:07,200 --> 00:01:08,580
getting that one

26
00:01:08,580 --> 00:01:10,140
um so that's that's okay though we'll

27
00:01:10,140 --> 00:01:12,299
talk about that um but before we get

28
00:01:12,299 --> 00:01:15,900
into that a little bit about who I am my

29
00:01:15,900 --> 00:01:18,060
name is David Bianco

30
00:01:18,060 --> 00:01:21,200
um right now I'm a security researcher

31
00:01:21,200 --> 00:01:25,020
at uh splunk's surge research team

32
00:01:25,020 --> 00:01:27,600
but I have about

33
00:01:27,600 --> 00:01:30,540
let's just leave it at over 20 years of

34
00:01:30,540 --> 00:01:33,060
experience in incident detection

35
00:01:33,060 --> 00:01:36,900
incident response a little bit of cyber

36
00:01:36,900 --> 00:01:39,119
threat intelligence mostly about how it

37
00:01:39,119 --> 00:01:40,860
relates to using it for incident

38
00:01:40,860 --> 00:01:42,840
detection incident response and threat

39
00:01:42,840 --> 00:01:44,040
hunting

40
00:01:44,040 --> 00:01:46,619
I was I like to say I was cyber security

41
00:01:46,619 --> 00:01:49,259
before there was cyber security because

42
00:01:49,259 --> 00:01:51,540
you know there wasn't we didn't even

43
00:01:51,540 --> 00:01:53,939
have the name cyber security when I

44
00:01:53,939 --> 00:01:56,220
started I started as a system

45
00:01:56,220 --> 00:01:59,700
administrator actually at when I was in

46
00:01:59,700 --> 00:02:02,759
school at University and just kind of

47
00:02:02,759 --> 00:02:05,700
grew into cyber security through from

48
00:02:05,700 --> 00:02:09,060
there so even before my 20 plus years of

49
00:02:09,060 --> 00:02:11,099
experience in cyber

50
00:02:11,099 --> 00:02:14,220
there was a let's say an unnamed number

51
00:02:14,220 --> 00:02:16,800
of years as a system administrator of

52
00:02:16,800 --> 00:02:18,840
Unix and Linux systems

53
00:02:18,840 --> 00:02:21,900
uh I spoke fun fact I spoke at the very

54
00:02:21,900 --> 00:02:24,840
first b-sides Augusta uh which I think

55
00:02:24,840 --> 00:02:28,140
was like was it 2013 I think it was a

56
00:02:28,140 --> 00:02:31,040
lot different first of all a lot smaller

57
00:02:31,040 --> 00:02:34,620
than this we didn't have like four

58
00:02:34,620 --> 00:02:36,780
tracks of talks we only had two tracks

59
00:02:36,780 --> 00:02:39,060
and we certainly did not have these

60
00:02:39,060 --> 00:02:40,260
fancy

61
00:02:40,260 --> 00:02:42,720
um badges which I which I love by the

62
00:02:42,720 --> 00:02:44,459
way these are my favorite circuit board

63
00:02:44,459 --> 00:02:47,220
badge actually we didn't have these

64
00:02:47,220 --> 00:02:49,440
fancy badges what we actually had was

65
00:02:49,440 --> 00:02:51,480
when you came in we had a red team track

66
00:02:51,480 --> 00:02:53,700
and a blue team track when you came in

67
00:02:53,700 --> 00:02:55,680
Doug Birch would punch you in the face

68
00:02:55,680 --> 00:02:58,019
and which eye was blacked would be your

69
00:02:58,019 --> 00:03:02,099
your red team or blue team Track ticket

70
00:03:02,099 --> 00:03:04,800
no I'm just joking because Doug would

71
00:03:04,800 --> 00:03:06,360
never taste such a nice guy he would

72
00:03:06,360 --> 00:03:08,459
never punch any anyone in the face it

73
00:03:08,459 --> 00:03:10,760
was Phil

74
00:03:12,540 --> 00:03:16,019
and I'm I'm also let's say a a noted

75
00:03:16,019 --> 00:03:20,580
pyramid Aficionado which gets us to my

76
00:03:20,580 --> 00:03:23,220
only actual slide for this entire talk

77
00:03:23,220 --> 00:03:26,959
the Pyramid of pain

78
00:03:27,060 --> 00:03:28,920
the idea that I want to talk to you

79
00:03:28,920 --> 00:03:31,440
about is is how I came up with this but

80
00:03:31,440 --> 00:03:34,440
first for a little over half of the

81
00:03:34,440 --> 00:03:36,000
people in the room probably I should

82
00:03:36,000 --> 00:03:38,300
talk about what it is

83
00:03:38,300 --> 00:03:40,920
very very briefly if you want the full

84
00:03:40,920 --> 00:03:43,260
right up there there's the URL here I

85
00:03:43,260 --> 00:03:44,819
promise it's a bitly linked but it's a

86
00:03:44,819 --> 00:03:46,500
totally Safe bitly Link this just goes

87
00:03:46,500 --> 00:03:49,159
to my blog

88
00:03:49,500 --> 00:03:51,959
I'll tell you shortly how I came up with

89
00:03:51,959 --> 00:03:53,700
this but basically think of the pyramid

90
00:03:53,700 --> 00:03:58,200
as a model that you can use for some of

91
00:03:58,200 --> 00:04:01,319
the different types of uh indicators or

92
00:04:01,319 --> 00:04:04,560
CTI data that you might be receiving to

93
00:04:04,560 --> 00:04:07,080
help you defend detect things on your

94
00:04:07,080 --> 00:04:09,720
networks for for defense

95
00:04:09,720 --> 00:04:12,239
and it kind of gives you

96
00:04:12,239 --> 00:04:14,939
the relative what I consider anyway the

97
00:04:14,939 --> 00:04:17,519
relative value of those different types

98
00:04:17,519 --> 00:04:21,478
of common indicator data so I value

99
00:04:21,478 --> 00:04:24,419
Things based not on how easy they are

100
00:04:24,419 --> 00:04:29,580
for me to use but how much work or how

101
00:04:29,580 --> 00:04:32,580
much pain it causes to our threat actors

102
00:04:32,580 --> 00:04:34,860
like they have in all of their attacks

103
00:04:34,860 --> 00:04:38,040
they have some type of you know

104
00:04:38,040 --> 00:04:40,320
indicators that they can't really help

105
00:04:40,320 --> 00:04:41,699
but

106
00:04:41,699 --> 00:04:44,520
but leave around like if you really want

107
00:04:44,520 --> 00:04:47,100
to get into this uh Google lecards

108
00:04:47,100 --> 00:04:49,020
exchange principle but the uh the whole

109
00:04:49,020 --> 00:04:50,580
idea is if a threat actor is doing

110
00:04:50,580 --> 00:04:52,800
something on your network they are

111
00:04:52,800 --> 00:04:54,840
leaving some kind of trace and they

112
00:04:54,840 --> 00:04:56,639
can't avoid it

113
00:04:56,639 --> 00:04:59,240
our job then is to find those traces

114
00:04:59,240 --> 00:05:01,919
notice when those traces are present in

115
00:05:01,919 --> 00:05:04,380
our Network and quickly do something

116
00:05:04,380 --> 00:05:07,080
about them so that we can interrupt

117
00:05:07,080 --> 00:05:09,180
their use of those like maybe in the

118
00:05:09,180 --> 00:05:10,860
midst of their tax cycle before they

119
00:05:10,860 --> 00:05:13,500
complete their kill chain if we're able

120
00:05:13,500 --> 00:05:15,919
to do that

121
00:05:15,919 --> 00:05:18,360
reliably especially but that means then

122
00:05:18,360 --> 00:05:20,520
if we can find that indicator they can't

123
00:05:20,520 --> 00:05:23,699
use it anymore they have to find

124
00:05:23,699 --> 00:05:26,820
something to replace what we detected

125
00:05:26,820 --> 00:05:28,259
and that's where the pain and the

126
00:05:28,259 --> 00:05:30,000
Pyramid of pain comes in because it

127
00:05:30,000 --> 00:05:32,340
means that

128
00:05:32,340 --> 00:05:34,620
not all these are

129
00:05:34,620 --> 00:05:37,139
as very difficult to replace

130
00:05:37,139 --> 00:05:40,560
like on the very bottom down here you'll

131
00:05:40,560 --> 00:05:43,139
see that the hash values

132
00:05:43,139 --> 00:05:45,419
I marked them as trivial because you

133
00:05:45,419 --> 00:05:49,139
know one bit in a giant file you get an

134
00:05:49,139 --> 00:05:51,000
entirely different hash value and that

135
00:05:51,000 --> 00:05:53,699
that's not including the fuzzy hashes by

136
00:05:53,699 --> 00:05:55,380
the way I really could have called this

137
00:05:55,380 --> 00:05:59,220
static hash values like sha-1 md5 those

138
00:05:59,220 --> 00:06:01,919
kinds of things not things like ssdeep

139
00:06:01,919 --> 00:06:04,620
or others but you make a very small

140
00:06:04,620 --> 00:06:07,380
change and they have an entirely

141
00:06:07,380 --> 00:06:09,960
different hash value sometimes these

142
00:06:09,960 --> 00:06:11,759
things are so easy to change a hash

143
00:06:11,759 --> 00:06:13,740
sometimes it even changes

144
00:06:13,740 --> 00:06:15,600
just by accident like a transmission

145
00:06:15,600 --> 00:06:18,419
error flips a bit and it's still a fine

146
00:06:18,419 --> 00:06:20,419
binary and it still works

147
00:06:20,419 --> 00:06:24,240
sometimes you will see like a threat

148
00:06:24,240 --> 00:06:28,560
actor just changes the the

149
00:06:28,560 --> 00:06:30,419
compile date because they just make a

150
00:06:30,419 --> 00:06:32,160
fresh compile before they deploy that

151
00:06:32,160 --> 00:06:35,039
changes the the hash value entirely so

152
00:06:35,039 --> 00:06:36,780
hash values by the way are kind of

153
00:06:36,780 --> 00:06:39,120
garbage for detection with a certain

154
00:06:39,120 --> 00:06:41,840
specific

155
00:06:41,940 --> 00:06:44,940
exceptions to that rule try they're

156
00:06:44,940 --> 00:06:46,740
they're low on the bottom they're on the

157
00:06:46,740 --> 00:06:48,600
bottom of the pyramid because threat

158
00:06:48,600 --> 00:06:50,220
actors don't care if you notice their

159
00:06:50,220 --> 00:06:52,440
hash value they'll just come out with a

160
00:06:52,440 --> 00:06:53,940
different one

161
00:06:53,940 --> 00:06:56,639
domain names and IP addresses the the

162
00:06:56,639 --> 00:06:58,560
next two layers are a little bit more

163
00:06:58,560 --> 00:07:01,440
it's not so difficult for a threat actor

164
00:07:01,440 --> 00:07:03,419
to control a bunch of like let's just

165
00:07:03,419 --> 00:07:06,000
say I need 10 000 IP addresses I'm going

166
00:07:06,000 --> 00:07:07,500
to keep all of them in my back pocket

167
00:07:07,500 --> 00:07:09,539
and when you

168
00:07:09,539 --> 00:07:11,940
find my one IP address I'm using for

169
00:07:11,940 --> 00:07:14,340
Tool downloads or command and control

170
00:07:14,340 --> 00:07:17,100
I'll change it no problem domain names

171
00:07:17,100 --> 00:07:18,600
are pretty much the same although you

172
00:07:18,600 --> 00:07:21,120
just you generally have to go through

173
00:07:21,120 --> 00:07:23,580
the trouble of either registering it or

174
00:07:23,580 --> 00:07:25,560
co-opting it somehow from a legitimate

175
00:07:25,560 --> 00:07:28,639
domain owner but still pretty easy

176
00:07:28,639 --> 00:07:32,039
especially for some of our threat actors

177
00:07:32,039 --> 00:07:34,860
who might be closely associated with

178
00:07:34,860 --> 00:07:36,720
their domain registrars for their

179
00:07:36,720 --> 00:07:39,080
country

180
00:07:39,720 --> 00:07:42,240
next level up we're starting to talk

181
00:07:42,240 --> 00:07:44,699
about tool marks or as I call them here

182
00:07:44,699 --> 00:07:46,860
the the network or the host artifacts

183
00:07:46,860 --> 00:07:48,840
that get left behind how do you

184
00:07:48,840 --> 00:07:50,639
establish your persistence is there a

185
00:07:50,639 --> 00:07:53,819
registry key or a certain file on the

186
00:07:53,819 --> 00:07:57,539
disk is there a certain way that you

187
00:07:57,539 --> 00:07:59,699
construct your command and control

188
00:07:59,699 --> 00:08:01,319
channels

189
00:08:01,319 --> 00:08:04,979
a user agent that you use a URL pattern

190
00:08:04,979 --> 00:08:06,479
that you construct even if it's

191
00:08:06,479 --> 00:08:08,099
randomized there might be a regular

192
00:08:08,099 --> 00:08:11,039
expression that you you go by that can

193
00:08:11,039 --> 00:08:14,099
detect it at that point you can find

194
00:08:14,099 --> 00:08:15,960
those

195
00:08:15,960 --> 00:08:19,379
and in order to fix it to so that you

196
00:08:19,379 --> 00:08:21,180
don't find that anymore they might have

197
00:08:21,180 --> 00:08:23,160
to go in and make some changes to their

198
00:08:23,160 --> 00:08:25,460
code they might be really small changes

199
00:08:25,460 --> 00:08:29,220
like renaming the um

200
00:08:29,220 --> 00:08:32,399
the registry key or changing the way

201
00:08:32,399 --> 00:08:35,039
they build their URL but they have to do

202
00:08:35,039 --> 00:08:36,779
it and then they have to recompile it

203
00:08:36,779 --> 00:08:39,659
probably retest it and redeploy it so it

204
00:08:39,659 --> 00:08:41,580
becomes a little bit annoying there if

205
00:08:41,580 --> 00:08:44,700
you force them to do that over and over

206
00:08:44,700 --> 00:08:47,519
eventually you get some experience with

207
00:08:47,519 --> 00:08:48,959
the tool

208
00:08:48,959 --> 00:08:51,060
that same tool you might see over and

209
00:08:51,060 --> 00:08:53,760
over again and you can maybe develop

210
00:08:53,760 --> 00:08:55,920
more robust detection like where's Paul

211
00:08:55,920 --> 00:08:58,019
Nelson he was talking about Yara rules

212
00:08:58,019 --> 00:08:59,220
earlier today

213
00:08:59,220 --> 00:09:01,200
you can maybe make some more robust

214
00:09:01,200 --> 00:09:03,480
detection so that no matter what small

215
00:09:03,480 --> 00:09:05,760
changes they make to the tool you can

216
00:09:05,760 --> 00:09:08,880
still reliably find it that way you've

217
00:09:08,880 --> 00:09:10,200
just told them they can't use that tool

218
00:09:10,200 --> 00:09:11,580
against you at all and they have to go

219
00:09:11,580 --> 00:09:13,560
out and either create a new tool from

220
00:09:13,560 --> 00:09:16,680
scratch or maybe acquire a new tool and

221
00:09:16,680 --> 00:09:18,839
try either way train up with it become

222
00:09:18,839 --> 00:09:22,019
proficient and that's pretty challenging

223
00:09:22,019 --> 00:09:24,360
they could do it once

224
00:09:24,360 --> 00:09:26,519
Maybe

225
00:09:26,519 --> 00:09:31,019
above that though we call it the ttps

226
00:09:31,019 --> 00:09:35,300
the tactics techniques and procedures

227
00:09:35,820 --> 00:09:38,820
if I had more space and had I thought of

228
00:09:38,820 --> 00:09:40,800
it at the time because TTP was a cool

229
00:09:40,800 --> 00:09:43,080
phrase back then I probably would have

230
00:09:43,080 --> 00:09:45,240
called it just behaviors because that's

231
00:09:45,240 --> 00:09:46,620
really what it is

232
00:09:46,620 --> 00:09:48,720
it's just the way that they're trained

233
00:09:48,720 --> 00:09:51,180
and the way that they their preferences

234
00:09:51,180 --> 00:09:55,080
mix up together to to express their

235
00:09:55,080 --> 00:09:57,240
activities on your network or on your

236
00:09:57,240 --> 00:10:00,360
systems so you find their behavior no

237
00:10:00,360 --> 00:10:02,820
matter what tools they use no matter

238
00:10:02,820 --> 00:10:04,560
what artifacts they leave behind you're

239
00:10:04,560 --> 00:10:07,560
looking at for them at a very high level

240
00:10:07,560 --> 00:10:09,540
and I will give you some examples of

241
00:10:09,540 --> 00:10:10,560
these

242
00:10:10,560 --> 00:10:13,380
um shortly but when you come to the part

243
00:10:13,380 --> 00:10:15,180
where you're attacking someone's

244
00:10:15,180 --> 00:10:18,180
training and you're saying you can't do

245
00:10:18,180 --> 00:10:19,860
things the way that you are used to

246
00:10:19,860 --> 00:10:21,720
doing them with you can't you have to

247
00:10:21,720 --> 00:10:24,839
retrain find a new method

248
00:10:24,839 --> 00:10:27,060
that's extremely tough for them

249
00:10:27,060 --> 00:10:29,940
especially if you can do that to them

250
00:10:29,940 --> 00:10:32,040
multiple times I like to say you're

251
00:10:32,040 --> 00:10:33,540
putting them on the pointy top of the

252
00:10:33,540 --> 00:10:35,339
pyramid and it's a very uncomfortable

253
00:10:35,339 --> 00:10:36,899
place

254
00:10:36,899 --> 00:10:40,160
and you've forced them to either

255
00:10:40,160 --> 00:10:43,680
retrain and change their behavior which

256
00:10:43,680 --> 00:10:46,800
if you've tried to lose weight quit

257
00:10:46,800 --> 00:10:50,399
smoking whatever you probably have an

258
00:10:50,399 --> 00:10:53,279
idea that that can be hard

259
00:10:53,279 --> 00:10:56,060
or

260
00:10:57,779 --> 00:11:00,959
you they go away

261
00:11:00,959 --> 00:11:03,480
because they're not willing to change

262
00:11:03,480 --> 00:11:06,000
so the Pyramid of pain the whole idea is

263
00:11:06,000 --> 00:11:10,260
for you to prioritize your human effort

264
00:11:10,260 --> 00:11:12,540
on things that give you the most

265
00:11:12,540 --> 00:11:15,540
potential benefit and make your systems

266
00:11:15,540 --> 00:11:20,040
most resistant to a a particular threat

267
00:11:20,040 --> 00:11:22,339
actor

268
00:11:22,920 --> 00:11:25,200
so I keep wanting to change the slide

269
00:11:25,200 --> 00:11:26,820
now but I don't actually have any other

270
00:11:26,820 --> 00:11:28,440
slides so I'm just going to put that

271
00:11:28,440 --> 00:11:30,980
thing down

272
00:11:31,380 --> 00:11:33,899
I originally published the pyramid in

273
00:11:33,899 --> 00:11:37,200
2013 the end of 2013.

274
00:11:37,200 --> 00:11:40,500
um several employers ago

275
00:11:40,500 --> 00:11:41,220
um

276
00:11:41,220 --> 00:11:43,440
but you know I kind of came up with this

277
00:11:43,440 --> 00:11:47,459
idea over several years prior to that I

278
00:11:47,459 --> 00:11:50,760
just didn't know it as a as a pyramid or

279
00:11:50,760 --> 00:11:53,880
as a model at first it was just like an

280
00:11:53,880 --> 00:11:56,519
instinct so I started at a giant company

281
00:11:56,519 --> 00:11:58,740
I won't name them

282
00:11:58,740 --> 00:12:00,600
uh we just followed the oscent

283
00:12:00,600 --> 00:12:03,420
presentation so it probably won't be

284
00:12:03,420 --> 00:12:04,860
very difficult for you guys to figure

285
00:12:04,860 --> 00:12:07,560
out who it was but

286
00:12:07,560 --> 00:12:10,740
um they had just started a new

287
00:12:10,740 --> 00:12:13,260
um a new security team for all of their

288
00:12:13,260 --> 00:12:15,779
businesses worldwide and we had a lot of

289
00:12:15,779 --> 00:12:16,519
them

290
00:12:16,519 --> 00:12:19,800
and one of the things that we started

291
00:12:19,800 --> 00:12:21,000
off with

292
00:12:21,000 --> 00:12:25,260
was a I don't know a uh a baked in set

293
00:12:25,260 --> 00:12:26,880
of threat actors that were already

294
00:12:26,880 --> 00:12:30,019
targeting the company

295
00:12:30,240 --> 00:12:32,839
we just hadn't had as much visibility

296
00:12:32,839 --> 00:12:36,000
and and response

297
00:12:36,000 --> 00:12:39,360
to to combat them as we developed over

298
00:12:39,360 --> 00:12:41,880
the next several years but what we did

299
00:12:41,880 --> 00:12:44,160
have was we had really good information

300
00:12:44,160 --> 00:12:48,899
sharing with other peers in our industry

301
00:12:48,899 --> 00:12:52,440
so we started off with our I don't know

302
00:12:52,440 --> 00:12:55,500
the baby steps of our uh intrusion

303
00:12:55,500 --> 00:12:57,240
detection our network security

304
00:12:57,240 --> 00:13:00,600
monitoring our incident response by

305
00:13:00,600 --> 00:13:03,480
taking a look at what the other peers

306
00:13:03,480 --> 00:13:06,000
were seeing in their Network they were

307
00:13:06,000 --> 00:13:08,100
doing threat Intel sharing before we had

308
00:13:08,100 --> 00:13:11,160
ice ax and things like that but this was

309
00:13:11,160 --> 00:13:13,380
basically the same almost the same thing

310
00:13:13,380 --> 00:13:16,980
as an ISAC we would we would take

311
00:13:16,980 --> 00:13:20,100
basically IP addresses domains and hash

312
00:13:20,100 --> 00:13:21,120
values

313
00:13:21,120 --> 00:13:23,639
from them against the threat actors that

314
00:13:23,639 --> 00:13:25,740
we thought were likely to come against

315
00:13:25,740 --> 00:13:27,839
us and there was a particular one that

316
00:13:27,839 --> 00:13:29,279
we were concerned about that we kept

317
00:13:29,279 --> 00:13:31,740
dealing with over and over again

318
00:13:31,740 --> 00:13:33,899
we started essentially even though it

319
00:13:33,899 --> 00:13:35,339
didn't exist yet at the bottom of the

320
00:13:35,339 --> 00:13:37,440
pyramid and every time we learned

321
00:13:37,440 --> 00:13:39,120
something new we put it back into our

322
00:13:39,120 --> 00:13:42,480
detection so that we could find it again

323
00:13:42,480 --> 00:13:45,839
this particular threat actor had a an

324
00:13:45,839 --> 00:13:48,120
implant that they used that they would

325
00:13:48,120 --> 00:13:50,760
leave behind to perform command and

326
00:13:50,760 --> 00:13:53,100
control on just you know whatever

327
00:13:53,100 --> 00:13:55,260
systems they had compromised and it was

328
00:13:55,260 --> 00:13:57,000
really interesting

329
00:13:57,000 --> 00:13:59,639
it was the core of the implant never

330
00:13:59,639 --> 00:14:02,880
really changed but it was a network

331
00:14:02,880 --> 00:14:06,180
command and control so they had a

332
00:14:06,180 --> 00:14:09,000
bolt-on like a dll that they would

333
00:14:09,000 --> 00:14:12,060
change that would change the way it it

334
00:14:12,060 --> 00:14:14,579
established its command and control over

335
00:14:14,579 --> 00:14:17,220
the internet and it would use a two-way

336
00:14:17,220 --> 00:14:19,500
command and control so typically it

337
00:14:19,500 --> 00:14:21,959
would it would set up to

338
00:14:21,959 --> 00:14:22,620
um

339
00:14:22,620 --> 00:14:25,620
sends data back and if it or sorry it

340
00:14:25,620 --> 00:14:28,620
would set up to to receive commands and

341
00:14:28,620 --> 00:14:30,600
if it connected successfully to receive

342
00:14:30,600 --> 00:14:31,860
a command it would set up another

343
00:14:31,860 --> 00:14:35,820
channel to Res to send data back so they

344
00:14:35,820 --> 00:14:38,820
had two channels for two-way

345
00:14:38,820 --> 00:14:40,440
communication

346
00:14:40,440 --> 00:14:44,459
the initial versions of this were HTTP

347
00:14:44,459 --> 00:14:47,579
based plain text HTTP and we would see

348
00:14:47,579 --> 00:14:51,480
these and we were mostly by the end at

349
00:14:51,480 --> 00:14:53,339
first detecting them on hashes or

350
00:14:53,339 --> 00:14:55,620
domains or maybe IP addresses that we

351
00:14:55,620 --> 00:14:58,079
knew were were bad from our threat

352
00:14:58,079 --> 00:15:01,380
intelligence but we collected a few

353
00:15:01,380 --> 00:15:04,740
samples from ourselves and from our our

354
00:15:04,740 --> 00:15:05,820
peers

355
00:15:05,820 --> 00:15:09,480
and I started noticing that there was

356
00:15:09,480 --> 00:15:12,420
you know random these were HTTP based so

357
00:15:12,420 --> 00:15:14,519
the URLs had kind of random looking

358
00:15:14,519 --> 00:15:16,380
pieces in them but there was a

359
00:15:16,380 --> 00:15:18,720
predictable structure and I could create

360
00:15:18,720 --> 00:15:23,120
a regular expression

361
00:15:23,339 --> 00:15:25,680
that would find them and given enough

362
00:15:25,680 --> 00:15:28,199
samples which we had I could tell you

363
00:15:28,199 --> 00:15:30,420
like for example this part of the URL

364
00:15:30,420 --> 00:15:33,660
ranged between five to eight characters

365
00:15:33,660 --> 00:15:36,360
long and it was always composed entirely

366
00:15:36,360 --> 00:15:40,440
of say uppercase letters

367
00:15:40,440 --> 00:15:43,560
so made a made a regular expression all

368
00:15:43,560 --> 00:15:45,899
of a sudden we started to be able to

369
00:15:45,899 --> 00:15:47,699
find their implant

370
00:15:47,699 --> 00:15:50,040
when it beaconed out

371
00:15:50,040 --> 00:15:52,139
and we had

372
00:15:52,139 --> 00:15:54,959
at the beginning maybe not quite 24-hour

373
00:15:54,959 --> 00:15:57,180
live coverage but we definitely had

374
00:15:57,180 --> 00:16:00,060
pager coverage and so we had the ability

375
00:16:00,060 --> 00:16:02,579
to like as soon as it beaconed out jump

376
00:16:02,579 --> 00:16:05,399
on find out what was what was up

377
00:16:05,399 --> 00:16:07,139
interdict

378
00:16:07,139 --> 00:16:09,240
cut them off and so they didn't like

379
00:16:09,240 --> 00:16:10,920
that and they were like fine we'll just

380
00:16:10,920 --> 00:16:13,500
change the way we build our URLs suckers

381
00:16:13,500 --> 00:16:16,019
and

382
00:16:16,019 --> 00:16:19,800
okay we temporarily were blinded a

383
00:16:19,800 --> 00:16:21,660
little bit but we still had a little bit

384
00:16:21,660 --> 00:16:23,940
of that domain and hash and IP address

385
00:16:23,940 --> 00:16:26,040
knowledge not to mention the knowledge

386
00:16:26,040 --> 00:16:28,620
from our peers so we were able to

387
00:16:28,620 --> 00:16:31,019
quickly adapt and find out oh they just

388
00:16:31,019 --> 00:16:33,000
changed the way like the format string

389
00:16:33,000 --> 00:16:34,860
for the way that they built their their

390
00:16:34,860 --> 00:16:37,079
URLs we can make a new regular

391
00:16:37,079 --> 00:16:39,620
expression

392
00:16:40,620 --> 00:16:42,300
and again

393
00:16:42,300 --> 00:16:45,620
started interdicting them in the middle

394
00:16:45,620 --> 00:16:48,839
the next thing they were like okay all

395
00:16:48,839 --> 00:16:52,699
right you can see the way we make our

396
00:16:52,699 --> 00:16:56,220
c2s very clever guys

397
00:16:56,220 --> 00:16:59,399
what if I encrypt it

398
00:16:59,399 --> 00:17:03,560
so started seeing SSL

399
00:17:03,779 --> 00:17:05,099
yeah that was a little bit of challenge

400
00:17:05,099 --> 00:17:07,319
at first except that we got a little bit

401
00:17:07,319 --> 00:17:09,359
lucky because

402
00:17:09,359 --> 00:17:11,400
um these were not native English

403
00:17:11,400 --> 00:17:13,679
speakers I don't know if that was a

404
00:17:13,679 --> 00:17:16,199
factor or not but when they've created

405
00:17:16,199 --> 00:17:18,000
their own

406
00:17:18,000 --> 00:17:20,819
SSL certificates they had a weird

407
00:17:20,819 --> 00:17:23,520
capitalization like a one letter that

408
00:17:23,520 --> 00:17:26,099
was not should not have been capitalized

409
00:17:26,099 --> 00:17:30,260
uh that was capitalized

410
00:17:30,360 --> 00:17:34,679
and it was like I can find that

411
00:17:34,679 --> 00:17:37,020
so we did and we started to be able to

412
00:17:37,020 --> 00:17:40,740
interdict them there now notice we

413
00:17:40,740 --> 00:17:43,980
started off with the the Intel at the

414
00:17:43,980 --> 00:17:46,500
bottom three layers domains IP addresses

415
00:17:46,500 --> 00:17:48,360
and hashes down here

416
00:17:48,360 --> 00:17:50,160
I'm pointing to it like all the people

417
00:17:50,160 --> 00:17:52,919
at YouTube can see it uh domains IP

418
00:17:52,919 --> 00:17:55,799
addresses and hashes but as soon as we

419
00:17:55,799 --> 00:17:57,900
started collecting samples and doing the

420
00:17:57,900 --> 00:17:59,940
regular expressions and the the

421
00:17:59,940 --> 00:18:02,580
examining the certificates we moved up

422
00:18:02,580 --> 00:18:05,520
into this network and host artifacts

423
00:18:05,520 --> 00:18:07,879
layer

424
00:18:09,240 --> 00:18:11,880
after that guess what

425
00:18:11,880 --> 00:18:15,080
they were like okay

426
00:18:15,299 --> 00:18:18,720
HTTP you guys are really good at it

427
00:18:18,720 --> 00:18:20,700
props to you

428
00:18:20,700 --> 00:18:23,100
what if we change to FTP

429
00:18:23,100 --> 00:18:24,720
because remember it's just a bolt-on

430
00:18:24,720 --> 00:18:27,620
whatever

431
00:18:29,039 --> 00:18:33,299
surprise to them was by the time they

432
00:18:33,299 --> 00:18:34,980
were fighting us at the network

433
00:18:34,980 --> 00:18:37,679
artifacts layer we were fighting them at

434
00:18:37,679 --> 00:18:39,539
the tools layer

435
00:18:39,539 --> 00:18:42,299
because we had enough experience with

436
00:18:42,299 --> 00:18:44,520
this tool that we noticed no matter how

437
00:18:44,520 --> 00:18:48,179
they created the connections

438
00:18:48,179 --> 00:18:50,460
the the data flowing over the

439
00:18:50,460 --> 00:18:52,500
connections was actually from the back

440
00:18:52,500 --> 00:18:55,799
end of the tool and we had identified a

441
00:18:55,799 --> 00:18:57,419
heartbeat

442
00:18:57,419 --> 00:19:00,240
that we could reliably find so as soon

443
00:19:00,240 --> 00:19:02,880
as they put out their new FTP version

444
00:19:02,880 --> 00:19:06,240
we were like we found it

445
00:19:06,240 --> 00:19:10,820
here it is jump in enter date

446
00:19:12,480 --> 00:19:15,120
I say we were at the tools level that

447
00:19:15,120 --> 00:19:16,679
was a little bit of a lie we were

448
00:19:16,679 --> 00:19:18,720
actually at the behavioral level the

449
00:19:18,720 --> 00:19:20,160
ttps

450
00:19:20,160 --> 00:19:23,220
because we had the detection there but

451
00:19:23,220 --> 00:19:25,860
guess what we also had we also had a lot

452
00:19:25,860 --> 00:19:27,840
of experience doing incident response

453
00:19:27,840 --> 00:19:30,480
with them while we were busy down here

454
00:19:30,480 --> 00:19:32,520
and they were kind of in the short term

455
00:19:32,520 --> 00:19:34,879
winning

456
00:19:34,919 --> 00:19:38,700
so we knew all about what they liked to

457
00:19:38,700 --> 00:19:41,220
do when they were in the network so we

458
00:19:41,220 --> 00:19:45,179
were able to create rules and detections

459
00:19:45,179 --> 00:19:47,220
that would find their behavior so one of

460
00:19:47,220 --> 00:19:50,400
their key behaviors was they would take

461
00:19:50,400 --> 00:19:52,200
all of the data that they were going to

462
00:19:52,200 --> 00:19:53,820
steal from around your network put it

463
00:19:53,820 --> 00:19:56,220
into one place

464
00:19:56,220 --> 00:19:59,760
and a like a data staging area on your

465
00:19:59,760 --> 00:20:01,020
network

466
00:20:01,020 --> 00:20:03,840
use the rar

467
00:20:03,840 --> 00:20:07,400
chive utility break it up into exactly

468
00:20:07,400 --> 00:20:10,200
640 megabyte chunks I never figured out

469
00:20:10,200 --> 00:20:11,820
why except if they were going to write

470
00:20:11,820 --> 00:20:14,700
it to CD-ROMs or something maybe

471
00:20:14,700 --> 00:20:16,559
could have been I mean that was a thing

472
00:20:16,559 --> 00:20:18,299
right

473
00:20:18,299 --> 00:20:21,000
um and and encrypt it

474
00:20:21,000 --> 00:20:23,880
and then they would transfer it usually

475
00:20:23,880 --> 00:20:26,700
over SMB but not always so we had a

476
00:20:26,700 --> 00:20:30,179
detection looking for encrypted raw

477
00:20:30,179 --> 00:20:32,460
files going from

478
00:20:32,460 --> 00:20:34,380
um you know across the internals of our

479
00:20:34,380 --> 00:20:35,340
Network

480
00:20:35,340 --> 00:20:37,440
because we never used them

481
00:20:37,440 --> 00:20:39,840
for legitimate business purposes

482
00:20:39,840 --> 00:20:42,480
so while they were still fighting us on

483
00:20:42,480 --> 00:20:45,419
the artifacts layer we we had brought

484
00:20:45,419 --> 00:20:47,400
the battle to the tools and the and the

485
00:20:47,400 --> 00:20:50,340
ttps and there came to be one night I I

486
00:20:50,340 --> 00:20:52,140
don't exactly know what time but it was

487
00:20:52,140 --> 00:20:53,880
well after midnight let's say two or

488
00:20:53,880 --> 00:20:57,140
three a.m because that was probably it

489
00:20:57,140 --> 00:21:01,559
where we got alerts from both

490
00:21:01,559 --> 00:21:05,460
the the FTP and the behavioral things

491
00:21:05,460 --> 00:21:08,640
and we jumped on while they were still

492
00:21:08,640 --> 00:21:11,220
copying that data from the staging point

493
00:21:11,220 --> 00:21:12,660
to the place that they were going to

494
00:21:12,660 --> 00:21:14,280
exfil it from so it was still in our

495
00:21:14,280 --> 00:21:16,980
Network they hadn't escaped with it yet

496
00:21:16,980 --> 00:21:19,500
and we were able to jump on in the

497
00:21:19,500 --> 00:21:22,860
middle of the night cut off their their

498
00:21:22,860 --> 00:21:24,720
transfer

499
00:21:24,720 --> 00:21:27,780
the pieces that they had begun to

500
00:21:27,780 --> 00:21:30,960
exfiltrate cut those off

501
00:21:30,960 --> 00:21:33,120
and all this time with all this

502
00:21:33,120 --> 00:21:35,159
experience we had with their Network C2

503
00:21:35,159 --> 00:21:37,860
we actually even had a decoder so we

504
00:21:37,860 --> 00:21:39,659
could take the pcap we were capturing

505
00:21:39,659 --> 00:21:42,539
from our NSM sensors and run it through

506
00:21:42,539 --> 00:21:44,580
the decoder and see what all they were

507
00:21:44,580 --> 00:21:47,340
doing including when they were on the

508
00:21:47,340 --> 00:21:49,860
systems typing things

509
00:21:49,860 --> 00:21:51,780
so we cut off their command and control

510
00:21:51,780 --> 00:21:54,900
node and they they fell back to their

511
00:21:54,900 --> 00:21:56,460
their backup command and control node

512
00:21:56,460 --> 00:21:57,960
and started pinging it

513
00:21:57,960 --> 00:22:00,659
it's down oh no okay but nothing else

514
00:22:00,659 --> 00:22:02,880
was down just their one control node so

515
00:22:02,880 --> 00:22:05,400
they were thinking they're watching us

516
00:22:05,400 --> 00:22:07,799
so the next thing I saw was the maybe

517
00:22:07,799 --> 00:22:09,720
the funniest thing I've ever seen in my

518
00:22:09,720 --> 00:22:12,240
professional life as they started

519
00:22:12,240 --> 00:22:14,039
um they started typing all these

520
00:22:14,039 --> 00:22:15,900
commands to see who was logged on to the

521
00:22:15,900 --> 00:22:18,240
machine the NT machine that they were on

522
00:22:18,240 --> 00:22:20,400
the Windows box like that's how I

523
00:22:20,400 --> 00:22:22,260
discovered that the Q user command

524
00:22:22,260 --> 00:22:24,900
existed by the way

525
00:22:24,900 --> 00:22:27,000
they were looking for are we being

526
00:22:27,000 --> 00:22:29,400
monitored on at the host level but they

527
00:22:29,400 --> 00:22:31,080
didn't really think about the network

528
00:22:31,080 --> 00:22:32,280
level

529
00:22:32,280 --> 00:22:34,620
and a minute or two later they logged

530
00:22:34,620 --> 00:22:37,799
off they never came back this was a

531
00:22:37,799 --> 00:22:40,580
well-funded

532
00:22:40,820 --> 00:22:43,860
state-sponsored threat actor that we

533
00:22:43,860 --> 00:22:45,840
chased off our Network

534
00:22:45,840 --> 00:22:47,700
essentially even though we hadn't again

535
00:22:47,700 --> 00:22:49,740
I hadn't created it yet by

536
00:22:49,740 --> 00:22:51,539
putting them on top of the pyramid we

537
00:22:51,539 --> 00:22:54,059
chased them up a perfect example of how

538
00:22:54,059 --> 00:22:57,120
we chased them up the pyramid over time

539
00:22:57,120 --> 00:22:58,860
and they never came back and we knew

540
00:22:58,860 --> 00:23:00,600
they never came back because we knew

541
00:23:00,600 --> 00:23:02,220
what they did when they wanted to

542
00:23:02,220 --> 00:23:04,500
maintain access and we kept seeing that

543
00:23:04,500 --> 00:23:07,500
they tried to get that access back

544
00:23:07,500 --> 00:23:09,480
but they were not never successful at

545
00:23:09,480 --> 00:23:11,100
least for the next few years until I

546
00:23:11,100 --> 00:23:13,320
left the company

547
00:23:13,320 --> 00:23:16,860
the pyramid I'd never I hadn't written

548
00:23:16,860 --> 00:23:18,659
it down at the time but a couple of

549
00:23:18,659 --> 00:23:20,520
years later

550
00:23:20,520 --> 00:23:23,520
we had we had recently created our own

551
00:23:23,520 --> 00:23:27,000
CTI team to replace my janky CSV file of

552
00:23:27,000 --> 00:23:29,280
everything we learned

553
00:23:29,280 --> 00:23:32,520
um we created a CTI team and we had a

554
00:23:32,520 --> 00:23:34,919
like a global meeting of the security

555
00:23:34,919 --> 00:23:37,260
teams coming up to headquarters because

556
00:23:37,260 --> 00:23:39,179
each of our business units had their own

557
00:23:39,179 --> 00:23:40,500
security teams

558
00:23:40,500 --> 00:23:42,960
or many of them did anyway so we had a

559
00:23:42,960 --> 00:23:45,200
big stakeholders security team meeting

560
00:23:45,200 --> 00:23:47,940
where we covered we intended to cover a

561
00:23:47,940 --> 00:23:49,860
lot of topics one of the topics we

562
00:23:49,860 --> 00:23:51,900
wanted to cover was our brand new threat

563
00:23:51,900 --> 00:23:53,820
intelligence database

564
00:23:53,820 --> 00:23:55,740
because we had

565
00:23:55,740 --> 00:24:00,000
just recently come up against the our a

566
00:24:00,000 --> 00:24:03,179
big major Milestone we had a million

567
00:24:03,179 --> 00:24:05,880
indicators in our database wait sorry

568
00:24:05,880 --> 00:24:11,280
hold on one million indicators

569
00:24:12,419 --> 00:24:14,460
which seemed so great and they were like

570
00:24:14,460 --> 00:24:16,559
so that means you you have deployed

571
00:24:16,559 --> 00:24:18,000
these all to detection right and I was

572
00:24:18,000 --> 00:24:20,700
like hold up wait stop raise your hand

573
00:24:20,700 --> 00:24:22,260
if you know why I was telling them to

574
00:24:22,260 --> 00:24:24,480
stop yeah yeah Mike does the security

575
00:24:24,480 --> 00:24:27,860
onion folks all know this

576
00:24:28,080 --> 00:24:30,960
is better you have a million indicators

577
00:24:30,960 --> 00:24:33,840
which ones are good for detection which

578
00:24:33,840 --> 00:24:36,419
ones are not big clue is I already said

579
00:24:36,419 --> 00:24:38,640
all those hashes not great for detection

580
00:24:38,640 --> 00:24:40,919
usually good for threat intelligence and

581
00:24:40,919 --> 00:24:43,919
and crawling up uh threat actors on on

582
00:24:43,919 --> 00:24:45,360
stalking them on virus total and

583
00:24:45,360 --> 00:24:48,179
whatever not so great for detection but

584
00:24:48,179 --> 00:24:49,620
I couldn't really

585
00:24:49,620 --> 00:24:51,780
figure out how to tell them this and we

586
00:24:51,780 --> 00:24:53,159
actually spent

587
00:24:53,159 --> 00:24:54,179
a

588
00:24:54,179 --> 00:24:57,360
my mind was like in my memory I think it

589
00:24:57,360 --> 00:24:58,980
was like the entire afternoon but it

590
00:24:58,980 --> 00:25:01,380
can't quite have been that much

591
00:25:01,380 --> 00:25:02,220
um

592
00:25:02,220 --> 00:25:05,400
and uh I couldn't get it across why we

593
00:25:05,400 --> 00:25:08,280
didn't just like deploy everything

594
00:25:08,280 --> 00:25:10,919
to detection so I was sitting in the

595
00:25:10,919 --> 00:25:14,039
hotel lobby bar with some of my

596
00:25:14,039 --> 00:25:15,480
teammates that night and we were going

597
00:25:15,480 --> 00:25:17,400
over to you know the meeting how we felt

598
00:25:17,400 --> 00:25:19,320
about it and I was like yeah you know

599
00:25:19,320 --> 00:25:21,900
something I just can't figure out how to

600
00:25:21,900 --> 00:25:24,299
express this so I had my laptop in my

601
00:25:24,299 --> 00:25:26,039
bag next to me and so I just pulled it

602
00:25:26,039 --> 00:25:29,100
out and it's yeah I'm drinking a beer in

603
00:25:29,100 --> 00:25:31,500
the in the lobby and I was just like I

604
00:25:31,500 --> 00:25:33,480
need to show them something so I started

605
00:25:33,480 --> 00:25:36,299
playing out I'm terrible at at Graphics

606
00:25:36,299 --> 00:25:39,900
at all so my real only real option was

607
00:25:39,900 --> 00:25:42,299
Microsoft smart art

608
00:25:42,299 --> 00:25:44,100
and so I started playing around with

609
00:25:44,100 --> 00:25:45,419
some ideas and I was like oh yeah

610
00:25:45,419 --> 00:25:48,299
pyramid a hierarchy yeah I I have a

611
00:25:48,299 --> 00:25:50,159
hierarchy in mind so I'll just put them

612
00:25:50,159 --> 00:25:53,940
in the and that is the the secret origin

613
00:25:53,940 --> 00:25:57,779
of probably the world's most famous

614
00:25:57,779 --> 00:26:01,820
piece of Microsoft smart art

615
00:26:02,460 --> 00:26:06,179
is I had I had developed this over a set

616
00:26:06,179 --> 00:26:08,039
of few years by actually interacting

617
00:26:08,039 --> 00:26:11,460
with threat actors and and seeing that

618
00:26:11,460 --> 00:26:14,340
this worked and then at one day I just

619
00:26:14,340 --> 00:26:18,179
got frustrated not being able to say how

620
00:26:18,179 --> 00:26:20,400
I was doing what we were doing and why

621
00:26:20,400 --> 00:26:22,140
and so I created the pyramid and I

622
00:26:22,140 --> 00:26:23,520
brought it into the meeting the next day

623
00:26:23,520 --> 00:26:25,980
and and that was it that was immediately

624
00:26:25,980 --> 00:26:29,100
they were like okay I got it thanks

625
00:26:29,100 --> 00:26:31,919
kind of anticlimactic end to that story

626
00:26:31,919 --> 00:26:33,900
but they were like thanks okay next item

627
00:26:33,900 --> 00:26:34,919
on the

628
00:26:34,919 --> 00:26:37,260
so I I have some stuff here to give out

629
00:26:37,260 --> 00:26:40,440
in my last couple of uh minutes some

630
00:26:40,440 --> 00:26:43,440
nice prizes from the from the conference

631
00:26:43,440 --> 00:26:44,760
sponsors

632
00:26:44,760 --> 00:26:47,159
I have uh an intrusion detection

633
00:26:47,159 --> 00:26:49,799
honeypots book Chris Sanders wrote this

634
00:26:49,799 --> 00:26:51,960
I've read it it's actually a really

635
00:26:51,960 --> 00:26:54,179
great book so I recommend it

636
00:26:54,179 --> 00:26:56,940
um also I have from

637
00:26:56,940 --> 00:27:00,059
from Southward I think right is this

638
00:27:00,059 --> 00:27:02,760
lock pick and beginning lock pick how-to

639
00:27:02,760 --> 00:27:05,000
book

640
00:27:05,760 --> 00:27:08,279
so I'm going to ask you a couple of

641
00:27:08,279 --> 00:27:10,620
questions and the first person who can

642
00:27:10,620 --> 00:27:12,960
tell me the answer can choose which one

643
00:27:12,960 --> 00:27:15,779
they want and then the second person who

644
00:27:15,779 --> 00:27:17,460
can answer my next question is to just

645
00:27:17,460 --> 00:27:19,140
get stuck with the leavings

646
00:27:19,140 --> 00:27:21,120
first question is this is actually

647
00:27:21,120 --> 00:27:25,340
pyramid of pain version two

648
00:27:25,500 --> 00:27:27,960
who can tell me the difference between

649
00:27:27,960 --> 00:27:30,240
the original pyramid of pain and pyramid

650
00:27:30,240 --> 00:27:33,679
of pain version 2.

651
00:27:39,120 --> 00:27:42,539
good answer not correct he says oh you

652
00:27:42,539 --> 00:27:45,480
must have had behaviors before ttps did

653
00:27:45,480 --> 00:27:46,980
you colors the colors were different the

654
00:27:46,980 --> 00:27:48,600
colors were different I mean technically

655
00:27:48,600 --> 00:27:51,799
yes but that's not the answer

656
00:27:52,559 --> 00:27:54,900
Point have IPS

657
00:27:54,900 --> 00:27:57,419
around did I have IPS and and hashes

658
00:27:57,419 --> 00:28:00,720
switched around no but

659
00:28:00,720 --> 00:28:05,059
good guess it's close to that

660
00:28:06,919 --> 00:28:10,080
less items in the pyramid but what was I

661
00:28:10,080 --> 00:28:12,379
missing

662
00:28:12,539 --> 00:28:15,419
it's not the ttps

663
00:28:15,419 --> 00:28:17,700
it was not the network artifacts come on

664
00:28:17,700 --> 00:28:20,880
three more at least right yes it was it

665
00:28:20,880 --> 00:28:23,820
was the hash values which which one

666
00:28:23,820 --> 00:28:26,480
would you prefer

667
00:28:27,120 --> 00:28:30,179
all right yeah the first the first

668
00:28:30,179 --> 00:28:33,000
version of the pyramid did not have hash

669
00:28:33,000 --> 00:28:34,860
values in it

670
00:28:34,860 --> 00:28:36,480
and the colors were different because

671
00:28:36,480 --> 00:28:38,400
there wasn't a blue

672
00:28:38,400 --> 00:28:41,340
so all right um the next one I don't

673
00:28:41,340 --> 00:28:44,039
really know what to to say so I'm gonna

674
00:28:44,039 --> 00:28:45,539
say

675
00:28:45,539 --> 00:28:47,400
um this is probably gonna

676
00:28:47,400 --> 00:28:49,919
really be a disaster who has the best

677
00:28:49,919 --> 00:28:52,919
use story of the Pyramid of pain who

678
00:28:52,919 --> 00:28:54,240
wants to come up and tell me how they've

679
00:28:54,240 --> 00:28:57,419
used the Pyramid of pain and in in a

680
00:28:57,419 --> 00:28:59,520
real life

681
00:28:59,520 --> 00:29:02,960
nobody oh yes

682
00:29:07,550 --> 00:29:10,760
[Music]

683
00:29:34,260 --> 00:29:36,600
that was a great that was great so for

684
00:29:36,600 --> 00:29:39,000
for everybody who didn't hear it

685
00:29:39,000 --> 00:29:42,059
that he said he he was trying to

686
00:29:42,059 --> 00:29:45,360
convince his his team to to get beyond

687
00:29:45,360 --> 00:29:48,059
the atomic indicators my words but I

688
00:29:48,059 --> 00:29:50,399
think that's this yeah and into the

689
00:29:50,399 --> 00:29:53,039
behaviors and and he used the pyramid in

690
00:29:53,039 --> 00:29:55,440
in part of his presentation to show them

691
00:29:55,440 --> 00:29:57,659
why you should do that and that's

692
00:29:57,659 --> 00:29:59,940
exactly the reason that I eventually

693
00:29:59,940 --> 00:30:02,220
published it because I wanted to we

694
00:30:02,220 --> 00:30:03,720
found it so helpful I wanted to share

695
00:30:03,720 --> 00:30:07,200
and speaking of sharing I'm kind of out

696
00:30:07,200 --> 00:30:09,240
of time now but I'm here for the rest of

697
00:30:09,240 --> 00:30:11,279
the afternoon if you are interested in

698
00:30:11,279 --> 00:30:12,899
the pyramid you want to talk more about

699
00:30:12,899 --> 00:30:14,760
war stories or if you just would like

700
00:30:14,760 --> 00:30:16,200
some cool stickers or buttons or

701
00:30:16,200 --> 00:30:18,659
whatever uh hit me up outside and I'll

702
00:30:18,659 --> 00:30:21,120
be happy to hook you up thank you very

703
00:30:21,120 --> 00:30:21,720
much

704
00:30:21,720 --> 00:30:24,720
[Applause]

705
00:30:24,720 --> 00:30:27,440
oh yeah

