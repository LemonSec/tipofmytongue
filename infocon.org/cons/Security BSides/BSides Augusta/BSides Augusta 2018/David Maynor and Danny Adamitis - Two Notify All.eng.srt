1
00:00:14,450 --> 00:00:17,570
thank you for having us besides Augusta

2
00:00:17,570 --> 00:00:19,990
we'd like to start off with a question

3
00:00:19,990 --> 00:00:22,700
do any of you want some real housewives

4
00:00:22,700 --> 00:00:26,690
of Silicon Valley no great well our

5
00:00:26,690 --> 00:00:30,410
presentation is nothing like that so

6
00:00:30,410 --> 00:00:33,020
we're gonna start off I'm have my friend

7
00:00:33,020 --> 00:00:35,870
here mr. Daniel and immitis start us off

8
00:00:35,870 --> 00:00:38,240
if you have any questions feel free to

9
00:00:38,240 --> 00:00:40,340
ask because your microphones aren't

10
00:00:40,340 --> 00:00:42,110
being recorded if you ask there's a

11
00:00:42,110 --> 00:00:43,610
question we're going to have to repeat

12
00:00:43,610 --> 00:00:45,980
it so everyone can hear it it's not that

13
00:00:45,980 --> 00:00:50,090
we're slow or that we're just slow right

14
00:00:50,090 --> 00:01:04,069
alright thank you like slide deck thank

15
00:01:04,069 --> 00:01:05,120
you everyone for coming out this morning

16
00:01:05,120 --> 00:01:07,070
first off can everyone in the back hear

17
00:01:07,070 --> 00:01:09,560
me just a quick check cool awesome

18
00:01:09,560 --> 00:01:13,310
thanks guys so as I stated previously my

19
00:01:13,310 --> 00:01:15,170
name is Danny this is David and we we're

20
00:01:15,170 --> 00:01:17,720
first Isco fellows so for those of you

21
00:01:17,720 --> 00:01:19,939
who are not familiar with Cisco belts we

22
00:01:19,939 --> 00:01:22,220
are part of the security business group

23
00:01:22,220 --> 00:01:24,170
within Cisco so I'm sure many of you

24
00:01:24,170 --> 00:01:25,820
guys are familiar with Cisco where you

25
00:01:25,820 --> 00:01:27,590
know kind of things for routers we make

26
00:01:27,590 --> 00:01:30,680
endpoint a VA we do email Tomah tree we

27
00:01:30,680 --> 00:01:33,560
have an endpoint antivirus engine we

28
00:01:33,560 --> 00:01:35,119
obviously come out with snort we just

29
00:01:35,119 --> 00:01:36,500
came out looks north three I think two

30
00:01:36,500 --> 00:01:38,119
weeks ago so that's really exciting

31
00:01:38,119 --> 00:01:40,399
yay for multi-threading and we have a

32
00:01:40,399 --> 00:01:42,530
number of security products like that so

33
00:01:42,530 --> 00:01:45,020
as a palace member extend of our job to

34
00:01:45,020 --> 00:01:46,759
feed through all these different limit

35
00:01:46,759 --> 00:01:51,290
resources such as these to help find

36
00:01:51,290 --> 00:01:53,450
some adversaries and threats to various

37
00:01:53,450 --> 00:01:55,700
networks that's kind of one of our

38
00:01:55,700 --> 00:01:57,890
really cool things about Cisco is we

39
00:01:57,890 --> 00:01:59,899
have so many different products from the

40
00:01:59,899 --> 00:02:01,759
Rocky wireless access points the

41
00:02:01,759 --> 00:02:03,920
endpoints to the firewalls it kind of

42
00:02:03,920 --> 00:02:06,380
gives us a really cool viewpoint into

43
00:02:06,380 --> 00:02:08,119
certain networks if we have all these

44
00:02:08,119 --> 00:02:10,430
things in place and that allows us to be

45
00:02:10,430 --> 00:02:12,110
able to comb through all these so trees

46
00:02:12,110 --> 00:02:13,700
and kind of string together some of

47
00:02:13,700 --> 00:02:15,560
these attacks a lot easier than

48
00:02:15,560 --> 00:02:18,350
traditional computer security products

49
00:02:18,350 --> 00:02:21,980
which may only have an antivirus type

50
00:02:21,980 --> 00:02:24,140
function or a firewall or just email

51
00:02:24,140 --> 00:02:26,870
symmetry so as you can see we have a

52
00:02:26,870 --> 00:02:28,230
number of things we poor

53
00:02:28,230 --> 00:02:29,970
all this analysis to make some really

54
00:02:29,970 --> 00:02:31,200
cool reports and some really cool

55
00:02:31,200 --> 00:02:33,560
findings so we can tell you about now

56
00:02:33,560 --> 00:02:36,269
but first before we do that we have some

57
00:02:36,269 --> 00:02:39,120
giveaways and we give ask a question and

58
00:02:39,120 --> 00:02:42,330
give away an item does anyone know or

59
00:02:42,330 --> 00:02:45,840
can anyone guess what technology none of

60
00:02:45,840 --> 00:02:49,560
these none of these socks were none of

61
00:02:49,560 --> 00:02:50,910
these cases while and today I have to do

62
00:02:50,910 --> 00:02:56,790
with I'm going to give you a clue it's

63
00:02:56,790 --> 00:03:00,569
the opposite of Wired who's the first

64
00:03:00,569 --> 00:03:01,739
one to say that who's the first one to

65
00:03:01,739 --> 00:03:04,890
say Wireless raise your hand you sir you

66
00:03:04,890 --> 00:03:11,299
win some stuff a wireless indoor panel

67
00:03:11,299 --> 00:03:18,569
congratulations who are who are the

68
00:03:18,569 --> 00:03:24,030
sponsors of these items we would like to

69
00:03:24,030 --> 00:03:26,519
thank them we think you're a luminaries

70
00:03:26,519 --> 00:03:29,760
unnamed company one so let's start with

71
00:03:29,760 --> 00:03:31,620
VP and filter if you haven't heard of it

72
00:03:31,620 --> 00:03:34,139
where were you it was all the rage in

73
00:03:34,139 --> 00:03:36,000
May it was such a rage I had to spend

74
00:03:36,000 --> 00:03:39,389
half my May in the Ukraine well that

75
00:03:39,389 --> 00:03:40,169
sounds like fun

76
00:03:40,169 --> 00:03:45,930
it really really was so a VPN filter was

77
00:03:45,930 --> 00:03:48,139
a piece of malware that we discovered on

78
00:03:48,139 --> 00:03:50,700
Soho routers Soho being small

79
00:03:50,700 --> 00:03:53,579
office/home office routers and Danny

80
00:03:53,579 --> 00:03:55,590
will walk you through kind of the the

81
00:03:55,590 --> 00:03:57,810
workflow of this interesting and

82
00:03:57,810 --> 00:04:00,930
multicolored diagram yes so for those me

83
00:04:00,930 --> 00:04:03,120
who are unfamiliar with it this was an

84
00:04:03,120 --> 00:04:04,620
advanced piece of malware that was

85
00:04:04,620 --> 00:04:06,180
actually a little different and it was

86
00:04:06,180 --> 00:04:07,739
targeting these Soho routers

87
00:04:07,739 --> 00:04:09,599
I won't array since we believe this was

88
00:04:09,599 --> 00:04:12,090
so particularly effective is because as

89
00:04:12,090 --> 00:04:13,500
you guys know most networks don't

90
00:04:13,500 --> 00:04:15,000
actually monitor these inch devices

91
00:04:15,000 --> 00:04:17,339
there is no antivirus for your router

92
00:04:17,339 --> 00:04:19,560
there's really knows a precedent for

93
00:04:19,560 --> 00:04:20,728
people to start checking these routers

94
00:04:20,728 --> 00:04:22,200
as long as the experience what's

95
00:04:22,200 --> 00:04:23,910
supposed to do they kind of just seem to

96
00:04:23,910 --> 00:04:24,960
forget about them and they way in a

97
00:04:24,960 --> 00:04:26,970
background but the very important thing

98
00:04:26,970 --> 00:04:28,949
is that they route all of your traffic

99
00:04:28,949 --> 00:04:30,419
so if you were to hypothetically

100
00:04:30,419 --> 00:04:32,669
compromised this device as was done in

101
00:04:32,669 --> 00:04:34,530
this case they would have unfettered

102
00:04:34,530 --> 00:04:37,800
access to everything I think some cases

103
00:04:37,800 --> 00:04:40,169
they really actually able to use this to

104
00:04:40,169 --> 00:04:40,569
move

105
00:04:40,569 --> 00:04:42,999
into the network picking add additional

106
00:04:42,999 --> 00:04:45,069
access to like workstations servers and

107
00:04:45,069 --> 00:04:47,619
things like that so as previously saying

108
00:04:47,619 --> 00:04:49,119
here's kind of the work pool we came up

109
00:04:49,119 --> 00:04:51,639
with um this was well wait wait we

110
00:04:51,639 --> 00:04:53,319
didn't come up with this the adversary

111
00:04:53,319 --> 00:04:54,219
came up with it

112
00:04:54,219 --> 00:04:56,979
we just documented it was just yeah we

113
00:04:56,979 --> 00:04:59,709
wrote about so we originally found our

114
00:04:59,709 --> 00:05:01,779
sample actually on virustotal at the

115
00:05:01,779 --> 00:05:03,429
time it was hanging up there I think for

116
00:05:03,429 --> 00:05:05,559
what a year or two and it was just never

117
00:05:05,559 --> 00:05:07,569
it wasn't being flagged by anyone so

118
00:05:07,569 --> 00:05:09,789
they just assumed it was benign and then

119
00:05:09,789 --> 00:05:11,860
once we start analyzing this it seemed

120
00:05:11,860 --> 00:05:13,749
that they were exploiting these routers

121
00:05:13,749 --> 00:05:16,209
think some sort of automated fashion to

122
00:05:16,209 --> 00:05:18,159
this day we still actually know how they

123
00:05:18,159 --> 00:05:19,119
were being compromised

124
00:05:19,119 --> 00:05:20,709
but just based off the breadth we're

125
00:05:20,709 --> 00:05:21,849
assuming that they could be doing

126
00:05:21,849 --> 00:05:23,649
something like just scanning for default

127
00:05:23,649 --> 00:05:25,089
admin credentials through something like

128
00:05:25,089 --> 00:05:26,860
show then there was a number of

129
00:05:26,860 --> 00:05:28,629
vulnerabilities existed for these types

130
00:05:28,629 --> 00:05:31,270
of routers such as micro Tech and as we

131
00:05:31,270 --> 00:05:32,830
kind of mentioned before people seem to

132
00:05:32,830 --> 00:05:34,569
forget about these edge devices so

133
00:05:34,569 --> 00:05:36,159
they're extremely vulnerable and after

134
00:05:36,159 --> 00:05:38,289
never patched it presents an opportunity

135
00:05:38,289 --> 00:05:39,849
in the weakness taking entry to that

136
00:05:39,849 --> 00:05:42,339
network so once this router KK's

137
00:05:42,339 --> 00:05:43,629
exploited through some sort of unknown

138
00:05:43,629 --> 00:05:45,939
means and then exhaust is first name and

139
00:05:45,939 --> 00:05:47,740
this first stage is extremely persistent

140
00:05:47,740 --> 00:05:50,379
and can live past reboot so even if

141
00:05:50,379 --> 00:05:52,240
something were to go down or if it gets

142
00:05:52,240 --> 00:05:54,969
out it can spend right back up again and

143
00:05:54,969 --> 00:05:58,029
regain exit Network once actually starts

144
00:05:58,029 --> 00:05:59,319
there and then choice and findings

145
00:05:59,319 --> 00:06:01,029
command and control server and in order

146
00:06:01,029 --> 00:06:02,499
to get a sucking stage implant

147
00:06:02,499 --> 00:06:04,599
downloaded so one of the things that was

148
00:06:04,599 --> 00:06:05,979
actually really unique about this is

149
00:06:05,979 --> 00:06:08,589
that it makes a request actually to fill

150
00:06:08,589 --> 00:06:10,389
the bucket and actually downloads an

151
00:06:10,389 --> 00:06:12,550
image so if you were a kind of a network

152
00:06:12,550 --> 00:06:14,469
admin you make say maybe it's just one

153
00:06:14,469 --> 00:06:15,969
of my employees who's kind of you know

154
00:06:15,969 --> 00:06:18,099
doing some kind of social media stuff or

155
00:06:18,099 --> 00:06:19,899
it's just maybe if it's from a peer

156
00:06:19,899 --> 00:06:21,339
department that could be legitimate your

157
00:06:21,339 --> 00:06:23,259
purpose and it would never really go

158
00:06:23,259 --> 00:06:24,939
recognized and then once it downloads

159
00:06:24,939 --> 00:06:27,909
that image and the EXIF file data they

160
00:06:27,909 --> 00:06:30,399
actually have an IP address embedded in

161
00:06:30,399 --> 00:06:32,139
there so it looks like a normal image

162
00:06:32,139 --> 00:06:33,849
it's something that would ever raise

163
00:06:33,849 --> 00:06:36,129
suspicion but within that metadata

164
00:06:36,129 --> 00:06:37,599
excellent they were then able to obtain

165
00:06:37,599 --> 00:06:40,959
that IP address if that were unable to

166
00:06:40,959 --> 00:06:42,819
work for some reason maybe they have

167
00:06:42,819 --> 00:06:44,259
some filtering in place to block these

168
00:06:44,259 --> 00:06:45,909
social media sites and then has a

169
00:06:45,909 --> 00:06:47,889
hard-coded IP address they can try to

170
00:06:47,889 --> 00:06:49,930
communicate to in order to download that

171
00:06:49,930 --> 00:06:52,719
sucking stage that stage that

172
00:06:52,719 --> 00:06:54,370
was hard-coded was call

173
00:06:54,370 --> 00:06:58,000
to know all da so that would then allow

174
00:06:58,000 --> 00:07:00,490
them to find when after a big servers

175
00:07:00,490 --> 00:07:01,900
and then it would then try it down with

176
00:07:01,900 --> 00:07:03,730
a second sanction implant which would

177
00:07:03,730 --> 00:07:05,650
thank communicate via tour and then

178
00:07:05,650 --> 00:07:07,810
would have a number of gangs and they've

179
00:07:07,810 --> 00:07:09,550
x-ray VAR some of them so let him talk

180
00:07:09,550 --> 00:07:11,920
about that but before we do that the

181
00:07:11,920 --> 00:07:14,140
title of our talk today is called to

182
00:07:14,140 --> 00:07:17,830
notify all is actual joke from the c2

183
00:07:17,830 --> 00:07:21,250
domain to know all which it's nothing

184
00:07:21,250 --> 00:07:25,840
when we uh when we took a look at it and

185
00:07:25,840 --> 00:07:27,700
it's kind of brazen for a for an

186
00:07:27,700 --> 00:07:30,160
adversary to have a domain like to know

187
00:07:30,160 --> 00:07:32,950
all has a c2 domain I mean it's kind of

188
00:07:32,950 --> 00:07:36,640
its kind of ballsy we we thought it was

189
00:07:36,640 --> 00:07:38,860
a joke at first turns out it was a joke

190
00:07:38,860 --> 00:07:41,800
so we we named our talk to notify all as

191
00:07:41,800 --> 00:07:46,090
an Amash to that but some of the modules

192
00:07:46,090 --> 00:07:47,500
that could be downloaded by a second and

193
00:07:47,500 --> 00:07:49,720
third stage involved a lot of

194
00:07:49,720 --> 00:07:51,480
man-in-the-middle activities particular

195
00:07:51,480 --> 00:07:54,310
particularly the ability to apply it as

196
00:07:54,310 --> 00:07:56,140
a cell strip and force us to sell

197
00:07:56,140 --> 00:07:58,540
downgrading on most websites or going

198
00:07:58,540 --> 00:08:00,310
through these routers so even if you

199
00:08:00,310 --> 00:08:01,750
thought you were connecting to a

200
00:08:01,750 --> 00:08:04,240
legitimate secure site it would force to

201
00:08:04,240 --> 00:08:06,100
download and then be able to inject a

202
00:08:06,100 --> 00:08:09,660
javascript payload into your response

203
00:08:09,660 --> 00:08:12,430
causing the adversary to be able to

204
00:08:12,430 --> 00:08:15,040
exploit a router another tool that was

205
00:08:15,040 --> 00:08:18,580
used in place was a binary replacement

206
00:08:18,580 --> 00:08:19,690
tool so if it looks like it was

207
00:08:19,690 --> 00:08:22,210
downloading anything that had an exe of

208
00:08:22,210 --> 00:08:24,160
any type of binary it could actually

209
00:08:24,160 --> 00:08:26,770
replace it with a Trojan version that

210
00:08:26,770 --> 00:08:29,710
would then execute when it got to the

211
00:08:29,710 --> 00:08:32,610
victim machine so these were all about

212
00:08:32,610 --> 00:08:35,380
compromising lateral movement in these

213
00:08:35,380 --> 00:08:41,140
small and medium-sized networks so this

214
00:08:41,140 --> 00:08:44,950
is obviously very bad so we wanted what

215
00:08:44,950 --> 00:08:46,540
we were hoping to do here we're kind of

216
00:08:46,540 --> 00:08:49,120
uh kind of give you a bunch of short

217
00:08:49,120 --> 00:08:50,530
overviews of things that you may have

218
00:08:50,530 --> 00:08:52,240
heard about and press but talk a little

219
00:08:52,240 --> 00:08:53,770
bit about things that you not have known

220
00:08:53,770 --> 00:08:56,470
for instance if you Google VPN filter

221
00:08:56,470 --> 00:09:00,610
and look in May of 2017 you'll find

222
00:09:00,610 --> 00:09:02,140
there's a lot of people who have cue

223
00:09:02,140 --> 00:09:07,360
naps QNAP sans devices that were

224
00:09:07,360 --> 00:09:09,649
talking about it repeatedly and they

225
00:09:09,649 --> 00:09:11,449
thought it was a crypto minor the

226
00:09:11,449 --> 00:09:15,019
footprints of BPM filter had been pretty

227
00:09:15,019 --> 00:09:17,779
much available for three years but

228
00:09:17,779 --> 00:09:19,579
nobody ever actually took time to look

229
00:09:19,579 --> 00:09:20,779
at or put it together

230
00:09:20,779 --> 00:09:23,420
what it actually meant and that was

231
00:09:23,420 --> 00:09:24,649
something that actually completely

232
00:09:24,649 --> 00:09:26,689
shocked me when we looked at the scope

233
00:09:26,689 --> 00:09:29,120
and the depth of this attack how people

234
00:09:29,120 --> 00:09:31,370
had talked about it for years but nobody

235
00:09:31,370 --> 00:09:35,269
said oh this should we should look into

236
00:09:35,269 --> 00:09:37,129
this specifically everybody assumed it

237
00:09:37,129 --> 00:09:39,290
was part of a mirai botnet turns out it

238
00:09:39,290 --> 00:09:46,279
wasn't so that is BPM filter also as

239
00:09:46,279 --> 00:09:48,740
Jenny mentioned a little earlier one of

240
00:09:48,740 --> 00:09:50,050
our biggest problems with this was

241
00:09:50,050 --> 00:09:52,160
there's not a lot of good forensics

242
00:09:52,160 --> 00:09:54,350
capabilities for routers meaning that if

243
00:09:54,350 --> 00:09:56,629
you found find a router and you lose

244
00:09:56,629 --> 00:09:59,149
power on it the first the second stage

245
00:09:59,149 --> 00:10:02,180
would just go away which music we'd

246
00:10:02,180 --> 00:10:05,240
really have to take a take heart router

247
00:10:05,240 --> 00:10:08,089
apart and basically solder JTAG on and

248
00:10:08,089 --> 00:10:10,670
download the firmware download the the

249
00:10:10,670 --> 00:10:12,589
memory while it was running be able to

250
00:10:12,589 --> 00:10:14,689
analyze the image and it's a point we

251
00:10:14,689 --> 00:10:19,339
even had a plan to play power cable and

252
00:10:19,339 --> 00:10:22,100
splice or funding generator a running

253
00:10:22,100 --> 00:10:23,600
battery into it so because I'm plug it

254
00:10:23,600 --> 00:10:26,689
from the wall and it would stay stay up

255
00:10:26,689 --> 00:10:28,129
and we'd be able to move it back to our

256
00:10:28,129 --> 00:10:30,019
office for further analysis we never

257
00:10:30,019 --> 00:10:31,970
actually had to do that but we did have

258
00:10:31,970 --> 00:10:36,620
a plan for it and if you want to take a

259
00:10:36,620 --> 00:10:38,329
look real quick these are the countries

260
00:10:38,329 --> 00:10:41,029
that were affected by BPM filter I'm not

261
00:10:41,029 --> 00:10:43,550
sure if you're a fan of geopolitics I

262
00:10:43,550 --> 00:10:46,730
know I'm not but it looks like there are

263
00:10:46,730 --> 00:10:50,600
certain certain places this is get hit

264
00:10:50,600 --> 00:10:52,429
more in other words for instance it

265
00:10:52,429 --> 00:10:54,860
doesn't look like Panama really is that

266
00:10:54,860 --> 00:10:56,720
affected kind of a little bit maybe but

267
00:10:56,720 --> 00:11:00,110
not right Huber's got no VPN filter

268
00:11:00,110 --> 00:11:02,720
that's strange let's just stare at this

269
00:11:02,720 --> 00:11:06,160
for a second ponder what this could mean

270
00:11:06,309 --> 00:11:08,690
well we're dumped Andre

271
00:11:08,690 --> 00:11:10,970
so are part of the are part of this

272
00:11:10,970 --> 00:11:14,690
investigation was to find clients that

273
00:11:14,690 --> 00:11:17,090
were infected by this and this actually

274
00:11:17,090 --> 00:11:18,740
I when I was originally giving this

275
00:11:18,740 --> 00:11:20,510
assignment said no problem easy peasy

276
00:11:20,510 --> 00:11:21,710
we'll have them all for you tomorrow

277
00:11:21,710 --> 00:11:25,550
turns out it's a lot harder than we

278
00:11:25,550 --> 00:11:27,880
thought so we actually had a brilliant

279
00:11:27,880 --> 00:11:31,250
data scientist named Nate Winslow who

280
00:11:31,250 --> 00:11:33,950
came up with a way of doing a time

281
00:11:33,950 --> 00:11:36,200
frequency analysis and mapping the

282
00:11:36,200 --> 00:11:41,450
behavior to decibels so on your x-axis

283
00:11:41,450 --> 00:11:44,990
here though that's a logarithmic lookup

284
00:11:44,990 --> 00:11:48,620
in decibel with frequency along the

285
00:11:48,620 --> 00:11:52,010
bottom of time so we were able to build

286
00:11:52,010 --> 00:11:54,260
and if you look at this you can kind of

287
00:11:54,260 --> 00:11:58,070
see a rising line that sticks out right

288
00:11:58,070 --> 00:12:00,950
in the middle throughout throughout the

289
00:12:00,950 --> 00:12:03,500
site this is how we were able to figure

290
00:12:03,500 --> 00:12:06,980
most most clients using not only Cisco

291
00:12:06,980 --> 00:12:08,600
internal telemetry for partner telemetry

292
00:12:08,600 --> 00:12:12,260
and third-party feet as well we were

293
00:12:12,260 --> 00:12:16,420
able to put together victim list of

294
00:12:16,420 --> 00:12:18,380
machines that were infected with it

295
00:12:18,380 --> 00:12:21,170
and we would see repeated patterns like

296
00:12:21,170 --> 00:12:23,060
a machine we were sure would be

297
00:12:23,060 --> 00:12:26,060
compromised with like the states - of

298
00:12:26,060 --> 00:12:29,660
this attack it would power cycle for

299
00:12:29,660 --> 00:12:32,990
some reason whatever reason it seems

300
00:12:32,990 --> 00:12:35,660
about every three weeks a device with an

301
00:12:35,660 --> 00:12:37,940
aunt with power cycles so you know you

302
00:12:37,940 --> 00:12:40,580
you would get used to it going off and

303
00:12:40,580 --> 00:12:41,810
coming back on now when it came back on

304
00:12:41,810 --> 00:12:44,780
it would act like it was stage one for a

305
00:12:44,780 --> 00:12:46,790
little while in some cases as little as

306
00:12:46,790 --> 00:12:49,190
two hours in some cases as much as four

307
00:12:49,190 --> 00:12:52,089
days before being promoted back to a

308
00:12:52,089 --> 00:12:55,940
second stage attack and this is what

309
00:12:55,940 --> 00:12:57,710
allowed us this this graph is what

310
00:12:57,710 --> 00:12:59,660
really was a breakthrough so we were

311
00:12:59,660 --> 00:13:02,480
able to take time frequency analysis

312
00:13:02,480 --> 00:13:04,910
which you don't hear a lot inside will

313
00:13:04,910 --> 00:13:08,990
work the guy that used the guy that did

314
00:13:08,990 --> 00:13:12,560
it for us is a geologist it has his PhD

315
00:13:12,560 --> 00:13:14,660
in geology and he loves time frequency

316
00:13:14,660 --> 00:13:17,480
analysis so here we go we got to use it

317
00:13:17,480 --> 00:13:20,920
in cyber so just a hand that that's

318
00:13:20,920 --> 00:13:22,660
kind of another technique that we use

319
00:13:22,660 --> 00:13:24,100
really effectively with this campaign

320
00:13:24,100 --> 00:13:26,500
but could be used for other companies or

321
00:13:26,500 --> 00:13:28,690
other researchers is that what we were

322
00:13:28,690 --> 00:13:30,430
trying to measure is to frequency and

323
00:13:30,430 --> 00:13:31,750
the rate at which something would make a

324
00:13:31,750 --> 00:13:34,029
note so if something baking's out every

325
00:13:34,029 --> 00:13:36,339
looks 8:30 sucking or maybe except every

326
00:13:36,339 --> 00:13:38,380
6 hours it kind of get a map of this

327
00:13:38,380 --> 00:13:40,540
always occurs at this time tone and you

328
00:13:40,540 --> 00:13:42,339
can kind of run some analysis a case or

329
00:13:42,339 --> 00:13:44,410
any other domains that we see are being

330
00:13:44,410 --> 00:13:46,329
requested and take seem frequency or

331
00:13:46,329 --> 00:13:47,829
with the next same kind of timeframe

332
00:13:47,829 --> 00:13:49,660
like that and if so could that

333
00:13:49,660 --> 00:13:51,399
potentially be maybe a similar domain

334
00:13:51,399 --> 00:13:53,920
excuse in another operation by the next

335
00:13:53,920 --> 00:13:55,690
same group or it could have maybe be

336
00:13:55,690 --> 00:13:57,279
some sort of backup domain to kind of

337
00:13:57,279 --> 00:13:59,199
help unravel more of the mystery behind

338
00:13:59,199 --> 00:14:00,850
it in this discover for additional

339
00:14:00,850 --> 00:14:05,769
infrastructure any questions anything

340
00:14:05,769 --> 00:14:07,810
you ever wanted to ask about VP and

341
00:14:07,810 --> 00:14:10,570
filter but never had people to ask we're

342
00:14:10,570 --> 00:14:11,110
right here

343
00:14:11,110 --> 00:14:24,310
I was hoping would be you oh I think

344
00:14:24,310 --> 00:14:33,720
what's not a picnic sniffer we believe

345
00:14:33,720 --> 00:14:36,130
we believe that our instrument and point

346
00:14:36,130 --> 00:14:38,140
distribution capabilities and models

347
00:14:38,140 --> 00:14:46,769
that we don't have the code for yes sir

348
00:14:47,600 --> 00:14:50,639
our JTAG interface is usually disabled

349
00:14:50,639 --> 00:14:53,160
until so routers it depends on the

350
00:14:53,160 --> 00:14:58,050
router sometimes if you get lucky and

351
00:14:58,050 --> 00:15:02,730
it's a strangely manufactured router put

352
00:15:02,730 --> 00:15:06,569
together by spare parts it probably

353
00:15:06,569 --> 00:15:09,720
isn't but it's one of those things where

354
00:15:09,720 --> 00:15:12,870
if you've hit a brick wall it's this is

355
00:15:12,870 --> 00:15:14,459
only only thing you have to move forward

356
00:15:14,459 --> 00:15:17,869
so you hope they don't

357
00:15:37,900 --> 00:15:40,090
so the question was if we know the

358
00:15:40,090 --> 00:15:42,130
purpose or kind of intent behind this

359
00:15:42,130 --> 00:15:44,770
particular campaign if it was

360
00:15:44,770 --> 00:15:46,630
financially motivated and it was

361
00:15:46,630 --> 00:15:48,960
motivated by maybe some sort of

362
00:15:48,960 --> 00:15:52,570
espionage for a nation-state oh wait

363
00:15:52,570 --> 00:15:55,420
paper thanks thank you yes we believe

364
00:15:55,420 --> 00:16:00,460
based on the code that we found in the

365
00:16:00,460 --> 00:16:03,220
malware we found we believed it based on

366
00:16:03,220 --> 00:16:05,320
the amount of effort that the adversary

367
00:16:05,320 --> 00:16:08,770
went to confuse attackers we also

368
00:16:08,770 --> 00:16:11,890
believe based on a second and secondary

369
00:16:11,890 --> 00:16:14,200
and tertiary follow-up modules that this

370
00:16:14,200 --> 00:16:19,050
was a an implant designed for espionage

371
00:16:19,050 --> 00:16:22,900
so think about that 500,000 small home

372
00:16:22,900 --> 00:16:25,780
routers compromised for an espionage

373
00:16:25,780 --> 00:16:30,160
like adversary which would mean why

374
00:16:30,160 --> 00:16:31,630
attack the company if you can just grab

375
00:16:31,630 --> 00:16:32,710
people's credentials when they're at

376
00:16:32,710 --> 00:16:38,520
home yes sir

377
00:16:50,690 --> 00:16:53,090
the question is when we found the type

378
00:16:53,090 --> 00:16:55,250
map was there any reason that it seems

379
00:16:55,250 --> 00:16:57,860
to be heavily focused around Italy and

380
00:16:57,860 --> 00:17:00,830
Greece I to point out again we did not

381
00:17:00,830 --> 00:17:03,069
corroborate with the adversary on this

382
00:17:03,069 --> 00:17:07,339
so unfortunately any sort of thing about

383
00:17:07,339 --> 00:17:09,349
you know move us behind that would just

384
00:17:09,349 --> 00:17:11,420
be our speculation and what we've talked

385
00:17:11,420 --> 00:17:13,790
about my expect lane just because but we

386
00:17:13,790 --> 00:17:15,290
are not being a Masseria we do not know

387
00:17:15,290 --> 00:17:16,459
what you know what they were trying to

388
00:17:16,459 --> 00:17:19,160
do now if you wanted to like get a beer

389
00:17:19,160 --> 00:17:21,709
later and hear our wild theories right

390
00:17:21,709 --> 00:17:24,040
there's this whole thing about aliens

391
00:17:24,040 --> 00:17:28,880
right but that doesn't seem to have any

392
00:17:28,880 --> 00:17:31,460
any supporting evidence whatsoever I'd

393
00:17:31,460 --> 00:17:33,980
point out the aliens theory has no

394
00:17:33,980 --> 00:17:39,110
supporting evidence however it doesn't

395
00:17:39,110 --> 00:17:42,310
snuffing before seeing it

396
00:17:58,200 --> 00:18:00,090
that's funny you say that that is

397
00:18:00,090 --> 00:18:02,039
exactly what we didn't that was kind of

398
00:18:02,039 --> 00:18:03,989
the point we were we were going for here

399
00:18:03,989 --> 00:18:05,359
it seemed like they were attacking

400
00:18:05,359 --> 00:18:09,980
everybody but broadband infrastructure

401
00:18:09,980 --> 00:18:13,590
there's a were question I think so

402
00:18:13,590 --> 00:18:26,129
last one so believe so when we couldn't

403
00:18:26,129 --> 00:18:27,929
think some tree strokes we believe it

404
00:18:27,929 --> 00:18:30,210
was associated with an OVH server

405
00:18:30,210 --> 00:18:33,539
campaign in France if you guys see

406
00:18:33,539 --> 00:18:35,879
connections to an OVH server that uses a

407
00:18:35,879 --> 00:18:37,350
let's encrypt certificate

408
00:18:37,350 --> 00:18:41,249
you should be weary and that's just in

409
00:18:41,249 --> 00:18:42,690
general that's got another thing that's

410
00:18:42,690 --> 00:18:45,720
not just for this case okay all right so

411
00:18:45,720 --> 00:18:46,859
we're gonna give away you something else

412
00:18:46,859 --> 00:18:49,169
now who knows what sicko smart install

413
00:18:49,169 --> 00:18:52,379
this alright well I'm gonna have to ask

414
00:18:52,379 --> 00:18:54,210
the simple question then who knows that

415
00:18:54,210 --> 00:18:59,100
cisco is all right cisco makes an

416
00:18:59,100 --> 00:19:02,460
operating system what is it called iOS

417
00:19:02,460 --> 00:19:04,169
who this is the first person somewhere

418
00:19:04,169 --> 00:19:06,409
over here

419
00:19:08,899 --> 00:19:12,690
you win some blue team handbooks because

420
00:19:12,690 --> 00:19:15,210
if you have cisco gear in your

421
00:19:15,210 --> 00:19:16,529
environment you should probably know

422
00:19:16,529 --> 00:19:19,379
about blue TV i don't think that's a

423
00:19:19,379 --> 00:19:22,739
good advertisement but and then what's

424
00:19:22,739 --> 00:19:24,269
not nora spider company oh it's not

425
00:19:24,269 --> 00:19:25,710
endorsed weather hopefully i'm sorry

426
00:19:25,710 --> 00:19:27,960
all right so what is this goes french

427
00:19:27,960 --> 00:19:30,090
salt I gotta be honest I've been in this

428
00:19:30,090 --> 00:19:31,649
business for 20 years right I've been

429
00:19:31,649 --> 00:19:33,600
doing security for as long as I've been

430
00:19:33,600 --> 00:19:37,679
able to drink beer and if you told me 20

431
00:19:37,679 --> 00:19:40,649
years ago Cisco would have this thing

432
00:19:40,649 --> 00:19:44,220
where you could basically deploy it once

433
00:19:44,220 --> 00:19:46,049
it was set up all of your Cisco

434
00:19:46,049 --> 00:19:49,289
equipment are you walking in or touching

435
00:19:49,289 --> 00:19:51,739
anything or even knowing passwords I

436
00:19:51,739 --> 00:19:54,359
would be horrified and I would be

437
00:19:54,359 --> 00:19:56,639
shocked and the younger somewhat more

438
00:19:56,639 --> 00:19:59,909
malicious version myself wouldn't not be

439
00:19:59,909 --> 00:20:01,619
able I could not continue myself because

440
00:20:01,619 --> 00:20:02,879
I would then be able to set up like a

441
00:20:02,879 --> 00:20:05,700
quake server not quake 3 we're talking

442
00:20:05,700 --> 00:20:08,129
about the original quake right I could

443
00:20:08,129 --> 00:20:10,600
not wait for that however

444
00:20:10,600 --> 00:20:14,260
turns out that for some reason we have

445
00:20:14,260 --> 00:20:17,470
his capability if you can read the set

446
00:20:17,470 --> 00:20:18,600
up there but it's a plug-and-play

447
00:20:18,600 --> 00:20:20,799
configuration and in the image

448
00:20:20,799 --> 00:20:23,500
management which means that hey if

449
00:20:23,500 --> 00:20:25,120
you're a really good attacker and you'd

450
00:20:25,120 --> 00:20:29,169
like to backdoor this iOS image you can

451
00:20:29,169 --> 00:20:30,760
do that and it will get deployed to

452
00:20:30,760 --> 00:20:34,240
everywhere on your aasa or ASR 9000 and

453
00:20:34,240 --> 00:20:36,730
it would be almost impossible for anyone

454
00:20:36,730 --> 00:20:40,270
to find it so it's a art install

455
00:20:40,270 --> 00:20:41,070
plug-and-play

456
00:20:41,070 --> 00:20:44,590
configuration image management provides

457
00:20:44,590 --> 00:20:47,679
zero touch and as a security person to

458
00:20:47,679 --> 00:20:51,059
phrase zero touch should make you upset

459
00:20:51,059 --> 00:20:53,890
because zero touch also it synonymous

460
00:20:53,890 --> 00:20:57,400
with things like password lists default

461
00:20:57,400 --> 00:20:59,289
login all right it's no touch it's not

462
00:20:59,289 --> 00:21:02,470
good to touch deployment for new

463
00:21:02,470 --> 00:21:04,450
switches so we're not just talking about

464
00:21:04,450 --> 00:21:07,240
well I like what mikrotik fire loss here

465
00:21:07,240 --> 00:21:09,610
or Windows boxes you should take off the

466
00:21:09,610 --> 00:21:11,860
network we're now talking about Cisco

467
00:21:11,860 --> 00:21:15,520
switches that there's not a lot of good

468
00:21:15,520 --> 00:21:18,490
for instance information in the world

469
00:21:18,490 --> 00:21:19,900
about them you pretty much have to call

470
00:21:19,900 --> 00:21:23,260
us to do forensics and also no one knows

471
00:21:23,260 --> 00:21:24,220
what they look like when they're doing

472
00:21:24,220 --> 00:21:26,409
bad things we have so many protocols on

473
00:21:26,409 --> 00:21:28,510
our routers and you're like oh god it

474
00:21:28,510 --> 00:21:30,220
looks sending out something weird on and

475
00:21:30,220 --> 00:21:31,900
you need to keep for it no no that's

476
00:21:31,900 --> 00:21:33,760
that's cisco discovery protocol that's

477
00:21:33,760 --> 00:21:35,620
that supposed to be there and everything

478
00:21:35,620 --> 00:21:37,570
you know is that this affects also the

479
00:21:37,570 --> 00:21:39,400
routers so well does me go after the

480
00:21:39,400 --> 00:21:40,030
switches

481
00:21:40,030 --> 00:21:41,260
some people you have no sense behind

482
00:21:41,260 --> 00:21:43,360
your firewall so it couldn't be a little

483
00:21:43,360 --> 00:21:46,150
bit safer but if you have a big Cisco

484
00:21:46,150 --> 00:21:48,429
router working at the ISP level that

485
00:21:48,429 --> 00:21:50,110
could also be vulnerable to the same

486
00:21:50,110 --> 00:21:52,179
type of attack and as you guys know if

487
00:21:52,179 --> 00:21:53,919
you start going after ISPs and things

488
00:21:53,919 --> 00:21:55,390
like that it can cause a lot of damage

489
00:21:55,390 --> 00:21:58,750
very very quickly this is my favorite

490
00:21:58,750 --> 00:22:01,539
sentence of the entire thing you can

491
00:22:01,539 --> 00:22:04,990
ship a switch to a location place it in

492
00:22:04,990 --> 00:22:07,419
the network powered on but no

493
00:22:07,419 --> 00:22:10,150
configuration required on the device now

494
00:22:10,150 --> 00:22:12,100
I don't know about you but for a long

495
00:22:12,100 --> 00:22:13,870
time I did penetration testing where I

496
00:22:13,870 --> 00:22:16,330
would do things like ship switches to

497
00:22:16,330 --> 00:22:19,030
places and give instructions for people

498
00:22:19,030 --> 00:22:21,220
on how to plug them in claiming I was

499
00:22:21,220 --> 00:22:23,879
from their supplier and they would do it

500
00:22:23,879 --> 00:22:26,069
but it would I would always get burned

501
00:22:26,069 --> 00:22:28,499
on the having to provide home support

502
00:22:28,499 --> 00:22:30,329
right like I would have to walk them

503
00:22:30,329 --> 00:22:34,649
through iOS CLI stuff it's not fun but

504
00:22:34,649 --> 00:22:36,179
then you bring something like this and I

505
00:22:36,179 --> 00:22:38,669
literally feel like I'm the GRU I can

506
00:22:38,669 --> 00:22:41,369
just ship something to you you plug it

507
00:22:41,369 --> 00:22:41,729
in

508
00:22:41,729 --> 00:22:46,649
I only just there's no that in between

509
00:22:46,649 --> 00:22:50,279
stuff so if we haven't if we really

510
00:22:50,279 --> 00:22:52,469
haven't sold it here Cisco smart Saul is

511
00:22:52,469 --> 00:22:56,789
a big deal for us at Cisco right there's

512
00:22:56,789 --> 00:22:58,079
all kinds of capabilities you can do

513
00:22:58,079 --> 00:23:00,899
with it and you can read them but some

514
00:23:00,899 --> 00:23:01,919
of the things we've seen we have

515
00:23:01,919 --> 00:23:04,409
literally seen people log into routers

516
00:23:04,409 --> 00:23:07,139
change running config change their boot

517
00:23:07,139 --> 00:23:12,419
images change the configure script with

518
00:23:12,419 --> 00:23:15,299
a script though TFTP down and config and

519
00:23:15,299 --> 00:23:17,669
the scary part about this is we didn't

520
00:23:17,669 --> 00:23:19,259
have any prior knowledge of this we

521
00:23:19,259 --> 00:23:21,149
literally just went through showed on to

522
00:23:21,149 --> 00:23:23,429
find these and the rule of thumb is if

523
00:23:23,429 --> 00:23:28,440
it's on showed on its exploitable say it

524
00:23:28,440 --> 00:23:31,769
with me if it's on showed on its exploit

525
00:23:31,769 --> 00:23:34,289
on that's really what we'd like you to

526
00:23:34,289 --> 00:23:39,569
take away from this talk how did it

527
00:23:39,569 --> 00:23:42,209
begin so we'd like to talk we'd like to

528
00:23:42,209 --> 00:23:44,929
talk about sexy stuff like hard

529
00:23:44,929 --> 00:23:47,429
reverse-engineered like you know bloody

530
00:23:47,429 --> 00:23:49,769
in the network knife fight with an

531
00:23:49,769 --> 00:23:51,929
adversary that we spend a lot of time on

532
00:23:51,929 --> 00:23:54,749
this what's none of that we have a

533
00:23:54,749 --> 00:23:56,759
partner go hey do you know what these IP

534
00:23:56,759 --> 00:23:59,669
addresses are we were like no they're

535
00:23:59,669 --> 00:24:01,019
like there's Cisco smart install devices

536
00:24:01,019 --> 00:24:03,089
out on the internet do you know what

537
00:24:03,089 --> 00:24:04,589
Cisco smart install is and I was like

538
00:24:04,589 --> 00:24:07,589
yeah I mean it's a smart way to install

539
00:24:07,589 --> 00:24:10,559
so won't we feature lovely feature

540
00:24:10,559 --> 00:24:13,709
they then briefed us on what was being

541
00:24:13,709 --> 00:24:16,499
done with these are like oh dear oh dear

542
00:24:16,499 --> 00:24:19,019
we have to tell somebody so callous

543
00:24:19,019 --> 00:24:20,549
itself doesn't handle these types of

544
00:24:20,549 --> 00:24:22,289
vulnerabilities we have to go to a group

545
00:24:22,289 --> 00:24:23,639
called Peter core a product security

546
00:24:23,639 --> 00:24:25,679
group who handles all of Cisco's product

547
00:24:25,679 --> 00:24:27,959
security vulnerabilities so obviously we

548
00:24:27,959 --> 00:24:30,449
walked in a very respectful manner to

549
00:24:30,449 --> 00:24:34,079
Peter and by that I mean we ran with

550
00:24:34,079 --> 00:24:35,730
hands in the air

551
00:24:35,730 --> 00:24:37,890
but screaming thank you anything strange

552
00:24:37,890 --> 00:24:40,200
I would but I'm just not feeling I'm not

553
00:24:40,200 --> 00:24:42,590
feeling manly enough for that okay well

554
00:24:42,590 --> 00:24:47,040
so this started in 2017 and peace sort

555
00:24:47,040 --> 00:24:48,630
did an advisory on it and they're like

556
00:24:48,630 --> 00:24:49,710
oh this is bad

557
00:24:49,710 --> 00:24:53,130
like Capital bad you shouldn't you

558
00:24:53,130 --> 00:24:54,690
shouldn't you shouldn't run this anymore

559
00:24:54,690 --> 00:24:57,570
so this guy Matt only if you if you

560
00:24:57,570 --> 00:24:59,850
don't follow him on Twitter but do like

561
00:24:59,850 --> 00:25:02,790
rage fests every once in a while this is

562
00:25:02,790 --> 00:25:04,470
a great guys fall we try to get a

563
00:25:04,470 --> 00:25:07,110
picture of him green raging about this

564
00:25:07,110 --> 00:25:09,030
but he refused service picture taken for

565
00:25:09,030 --> 00:25:12,900
this presentation but he even at the

566
00:25:12,900 --> 00:25:15,330
point and remember all of us work for

567
00:25:15,330 --> 00:25:17,940
Cisco so he was like come on this is

568
00:25:17,940 --> 00:25:19,500
they turned this off this isn't a big

569
00:25:19,500 --> 00:25:22,170
deal and then a bunch of new stories

570
00:25:22,170 --> 00:25:24,150
came out about how there were people

571
00:25:24,150 --> 00:25:27,420
with default route in Cisco and you

572
00:25:27,420 --> 00:25:30,660
would expect us to go no no what default

573
00:25:30,660 --> 00:25:33,750
route it's just some miscommunication

574
00:25:33,750 --> 00:25:35,520
we went dead away and went it's worse

575
00:25:35,520 --> 00:25:37,170
than the fault route there's a lot of

576
00:25:37,170 --> 00:25:38,700
things you can do with this you can't do

577
00:25:38,700 --> 00:25:44,970
with route turn it off right now this is

578
00:25:44,970 --> 00:25:47,190
kind of a big case we went the head was

579
00:25:47,190 --> 00:25:48,900
I'm not sure if you guys heard about

580
00:25:48,900 --> 00:25:51,060
this one but actually this happened in

581
00:25:51,060 --> 00:25:53,310
Russia I believe or if they actually had

582
00:25:53,310 --> 00:25:59,460
a number of Cisco routers there was a

583
00:25:59,460 --> 00:26:01,920
big I subpoenaed unnamed country expands

584
00:26:01,920 --> 00:26:04,230
nine time zones and they love to use

585
00:26:04,230 --> 00:26:06,390
Cisco routers as some of their backbone

586
00:26:06,390 --> 00:26:09,540
ISPs as a result we woke up one morning

587
00:26:09,540 --> 00:26:11,910
and we discovered a number of Cisco

588
00:26:11,910 --> 00:26:13,520
routers are being exploited via this

589
00:26:13,520 --> 00:26:16,110
picture that was embedded in some of the

590
00:26:16,110 --> 00:26:18,270
products as a result they were then able

591
00:26:18,270 --> 00:26:19,890
to gain access to a number of these

592
00:26:19,890 --> 00:26:22,200
devices and they basically deleted their

593
00:26:22,200 --> 00:26:24,570
router config files for those of you

594
00:26:24,570 --> 00:26:25,680
familiar with that they basically

595
00:26:25,680 --> 00:26:28,020
renders the router completely inoperable

596
00:26:28,020 --> 00:26:30,990
and this was a very big deal and that

597
00:26:30,990 --> 00:26:32,700
this was something that we were kind of

598
00:26:32,700 --> 00:26:34,980
yelling into the void and I know this is

599
00:26:34,980 --> 00:26:37,080
sometimes other people you know who are

600
00:26:37,080 --> 00:26:38,760
doing open source works discovered this

601
00:26:38,760 --> 00:26:41,070
really krish critical vulnerability and

602
00:26:41,070 --> 00:26:42,870
you're trying to tell people about this

603
00:26:42,870 --> 00:26:44,430
the whole series of this and that if you

604
00:26:44,430 --> 00:26:45,750
don't do this it's going to be the end

605
00:26:45,750 --> 00:26:47,730
of times and he's just falls upon deaf

606
00:26:47,730 --> 00:26:49,080
ears and so

607
00:26:49,080 --> 00:26:51,090
someone finally hears you thanks the

608
00:26:51,090 --> 00:26:52,680
wrong audience and then what they do is

609
00:26:52,680 --> 00:26:54,570
they what they used its owner ability or

610
00:26:54,570 --> 00:26:56,880
this feature if you will and they can

611
00:26:56,880 --> 00:26:59,040
use this to basically shut down internet

612
00:26:59,040 --> 00:27:01,080
routing for an entire country for I

613
00:27:01,080 --> 00:27:02,790
think what was that half a day a day

614
00:27:02,790 --> 00:27:04,950
where there was just you were not able

615
00:27:04,950 --> 00:27:06,480
to access the Internet you were not able

616
00:27:06,480 --> 00:27:08,070
to do anything and then so you can

617
00:27:08,070 --> 00:27:09,390
imagine if you're some sort of business

618
00:27:09,390 --> 00:27:12,120
and you have a downtime of 24 hours that

619
00:27:12,120 --> 00:27:13,710
can cause a substantial amount of money

620
00:27:13,710 --> 00:27:15,390
and this was something we're thinking

621
00:27:15,390 --> 00:27:17,400
you can fix it they had to try colder

622
00:27:17,400 --> 00:27:19,410
ISP but then the ice pay start getting

623
00:27:19,410 --> 00:27:20,850
flooded with phone calls about saying

624
00:27:20,850 --> 00:27:23,040
hey my Internet's not working and it's

625
00:27:23,040 --> 00:27:24,420
just perfection wakes us really back

626
00:27:24,420 --> 00:27:28,440
cycle and the worst part was we would

627
00:27:28,440 --> 00:27:31,590
get our outreach team would talk to

628
00:27:31,590 --> 00:27:33,570
reporters about this and we'll get

629
00:27:33,570 --> 00:27:35,940
described as a vulnerability as if there

630
00:27:35,940 --> 00:27:39,390
was a patch coming well it's protocol

631
00:27:39,390 --> 00:27:42,360
abuse there was no patch coming this is

632
00:27:42,360 --> 00:27:45,900
this is exactly what some engineer we

633
00:27:45,900 --> 00:27:48,210
have not met but we're currently looking

634
00:27:48,210 --> 00:27:52,710
for attended to have happen so while a

635
00:27:52,710 --> 00:27:54,300
lot of people were waiting for a patch

636
00:27:54,300 --> 00:27:56,730
to make their smart install work well we

637
00:27:56,730 --> 00:27:58,140
kept telling them you have to turn it

638
00:27:58,140 --> 00:28:04,500
off there is no working well and active

639
00:28:04,500 --> 00:28:08,940
exploitation do you oh by the way the

640
00:28:08,940 --> 00:28:12,210
gentleman that's tweeting in the upper

641
00:28:12,210 --> 00:28:13,380
right hand corner

642
00:28:13,380 --> 00:28:17,280
Omar Santos is one of the leads in our

643
00:28:17,280 --> 00:28:19,730
product security group so if Omar says

644
00:28:19,730 --> 00:28:23,760
something is bad by definition a bad

645
00:28:23,760 --> 00:28:29,480
thing any questions about smart install

646
00:28:52,590 --> 00:28:55,590
the question is if it was so easy to use

647
00:28:55,590 --> 00:28:58,540
zero touch why would this one develop

648
00:28:58,540 --> 00:29:00,070
that capability allowed to fall into

649
00:29:00,070 --> 00:29:04,679
wrong hands it was developed to work on

650
00:29:04,679 --> 00:29:07,570
intranet devices

651
00:29:07,570 --> 00:29:08,799
you were never supposed to have these

652
00:29:08,799 --> 00:29:11,530
devices facing the Internet Capitol

653
00:29:11,530 --> 00:29:14,559
internet it turns out a lot of people

654
00:29:14,559 --> 00:29:18,610
were even against our best guidance it

655
00:29:18,610 --> 00:29:24,100
was kind of a not best-case scenario you

656
00:29:24,100 --> 00:29:25,750
know how like a lot of people want to

657
00:29:25,750 --> 00:29:29,440
push best use cases this was a not best

658
00:29:29,440 --> 00:29:31,540
use case scenario so I think the

659
00:29:31,540 --> 00:29:33,370
original idea was that sometimes you

660
00:29:33,370 --> 00:29:34,809
have these big companies and they have

661
00:29:34,809 --> 00:29:36,820
understaffed IT department store they

662
00:29:36,820 --> 00:29:38,580
have people who aren't as familiar with

663
00:29:38,580 --> 00:29:41,049
proprietary cisco command line

664
00:29:41,049 --> 00:29:43,059
interfaces or things like that something

665
00:29:43,059 --> 00:29:44,350
wanted to provide some sort of solution

666
00:29:44,350 --> 00:29:46,030
that they can give to the a professor

667
00:29:46,030 --> 00:29:48,160
where he or she can things just plug in

668
00:29:48,160 --> 00:29:49,690
that router and in about five minutes

669
00:29:49,690 --> 00:29:52,000
they can get that up and running and it

670
00:29:52,000 --> 00:29:53,440
wasn't again this would we're great if

671
00:29:53,440 --> 00:29:55,000
you're on the intranet you know your

672
00:29:55,000 --> 00:29:56,740
internal network and your hand behind a

673
00:29:56,740 --> 00:29:58,809
firewall again at that point you're

674
00:29:58,809 --> 00:29:59,830
pretty safe

675
00:29:59,830 --> 00:30:01,630
it was just unfortunately some people

676
00:30:01,630 --> 00:30:03,070
were taking this device that was

677
00:30:03,070 --> 00:30:05,169
developed for an internal resource and

678
00:30:05,169 --> 00:30:06,970
using it externally and that's where

679
00:30:06,970 --> 00:30:09,400
they've been presented this issue that

680
00:30:09,400 --> 00:30:11,260
was a great question and for that you

681
00:30:11,260 --> 00:30:14,799
want to get a yes certificate to Safari

682
00:30:14,799 --> 00:30:17,500
Books one of my favorite blood providers

683
00:30:17,500 --> 00:30:20,020
they're awesome I used a long time I was

684
00:30:20,020 --> 00:30:22,059
training on the plane I was learning

685
00:30:22,059 --> 00:30:27,960
just about before you did congratulate

686
00:30:31,049 --> 00:30:33,100
all right so I think we have time for

687
00:30:33,100 --> 00:30:35,440
maybe another story or two so the next

688
00:30:35,440 --> 00:30:36,850
thing we want to talk about was coin

689
00:30:36,850 --> 00:30:39,340
hoarder for those who are unfamiliar

690
00:30:39,340 --> 00:30:40,570
with this thing we're gonna do a quick

691
00:30:40,570 --> 00:30:42,880
overview and then we're going to tell

692
00:30:42,880 --> 00:30:45,160
some of the wealth of stories we also

693
00:30:45,160 --> 00:30:47,440
have a dance that we're going to it's an

694
00:30:47,440 --> 00:30:49,570
interpretive dance of how great Bitcoin

695
00:30:49,570 --> 00:30:52,559
know and

696
00:30:52,810 --> 00:30:54,020
[Applause]

697
00:30:54,020 --> 00:30:57,480
corne Horner was the internal name we

698
00:30:57,480 --> 00:30:59,580
had for an investigation that started a

699
00:30:59,580 --> 00:31:02,690
little over three years ago or a little

700
00:31:02,690 --> 00:31:04,919
it was made public about eight months

701
00:31:04,919 --> 00:31:07,290
ago there was a joint research effort

702
00:31:07,290 --> 00:31:10,650
between Talos and the gentleman and then

703
00:31:10,650 --> 00:31:12,780
Jeremiah O'Connor who was actually the

704
00:31:12,780 --> 00:31:14,070
hero of the story and I wish he could be

705
00:31:14,070 --> 00:31:16,559
here with us today but he has to he's

706
00:31:16,559 --> 00:31:18,210
off being awesome with Bitcoin elsewhere

707
00:31:18,210 --> 00:31:21,570
he he actually brought me this

708
00:31:21,570 --> 00:31:23,190
investigation that says hey check this

709
00:31:23,190 --> 00:31:23,669
out

710
00:31:23,669 --> 00:31:26,190
I wrote a machine learning tool that

711
00:31:26,190 --> 00:31:30,750
will take domains and look for phishing

712
00:31:30,750 --> 00:31:32,940
variants of them like you know Apple

713
00:31:32,940 --> 00:31:35,970
comm right it would be a three and seven

714
00:31:35,970 --> 00:31:42,030
P so you ap 3le comm so fishing where

715
00:31:42,030 --> 00:31:43,740
specifically well on me I can't spell

716
00:31:43,740 --> 00:31:47,610
anyway yeah but so we were trying to

717
00:31:47,610 --> 00:31:51,059
figure out exactly what they were doing

718
00:31:51,059 --> 00:31:53,549
and we watched these guys and we have we

719
00:31:53,549 --> 00:31:54,780
have partners all over the world one of

720
00:31:54,780 --> 00:31:58,020
the partners we work with you Ukraine

721
00:31:58,020 --> 00:32:00,390
National Police and their cyber unit and

722
00:32:00,390 --> 00:32:03,419
they they heard about this and true

723
00:32:03,419 --> 00:32:05,910
story at the time it was not illegal to

724
00:32:05,910 --> 00:32:08,160
steal Bitcoin in the Ukraine

725
00:32:08,160 --> 00:32:11,040
there was no law yes Bitcoin that

726
00:32:11,040 --> 00:32:13,260
because it wasn't it wasn't a real thing

727
00:32:13,260 --> 00:32:15,059
let's never I was never developed before

728
00:32:15,059 --> 00:32:19,740
yeah we cared about TV because I I'm old

729
00:32:19,740 --> 00:32:20,880
and I still don't get it

730
00:32:20,880 --> 00:32:22,980
so this is one of the funny things is at

731
00:32:22,980 --> 00:32:24,210
the time we actually released this

732
00:32:24,210 --> 00:32:25,950
report I think it was actually you know

733
00:32:25,950 --> 00:32:28,110
February there was a famous story about

734
00:32:28,110 --> 00:32:30,330
the Bitcoin pizza and for those who are

735
00:32:30,330 --> 00:32:31,470
familiar with it

736
00:32:31,470 --> 00:32:34,080
some of the original Bitcoin people will

737
00:32:34,080 --> 00:32:36,210
reminisce about the good days when they

738
00:32:36,210 --> 00:32:37,650
had all these bitcoins but they were

739
00:32:37,650 --> 00:32:39,840
essentially worthless and one of the

740
00:32:39,840 --> 00:32:41,549
funny stories is at one point some guy

741
00:32:41,549 --> 00:32:43,830
actually bought two Papa John's pizzas

742
00:32:43,830 --> 00:32:48,600
for 10,000 bitcoins so at the time he

743
00:32:48,600 --> 00:32:49,650
thought this was a really good deal

744
00:32:49,650 --> 00:32:50,940
because he and think this is going

745
00:32:50,940 --> 00:32:52,200
anywhere and he's like I might as well

746
00:32:52,200 --> 00:32:53,840
cut my losses and see what I can get now

747
00:32:53,840 --> 00:32:56,700
fast forward to to mean where you guys

748
00:32:56,700 --> 00:32:58,260
know a Bitcoin was worth what

749
00:32:58,260 --> 00:33:00,929
approximately sixteen thousand dollars

750
00:33:00,929 --> 00:33:06,059
per Bitcoin times ten thousand so there

751
00:33:06,059 --> 00:33:06,700
is

752
00:33:06,700 --> 00:33:09,010
internet being internet decided it'd be

753
00:33:09,010 --> 00:33:10,690
really funny if they made fun of this

754
00:33:10,690 --> 00:33:12,340
guy and create a Twitter account and

755
00:33:12,340 --> 00:33:14,170
they tweeted up a value of those two

756
00:33:14,170 --> 00:33:14,620
peaks

757
00:33:14,620 --> 00:33:16,600
every single day and this was the value

758
00:33:16,600 --> 00:33:18,790
of those Peaks us on a day that we

759
00:33:18,790 --> 00:33:22,750
released our reports yes

760
00:33:22,750 --> 00:33:27,370
hey hope you enjoy those Peaks us how

761
00:33:27,370 --> 00:33:30,430
good could they be wait we don't have

762
00:33:30,430 --> 00:33:34,360
Papa John's fans here so this was a

763
00:33:34,360 --> 00:33:36,220
previously mentioned they developed

764
00:33:36,220 --> 00:33:38,800
these algorithm to help look for these

765
00:33:38,800 --> 00:33:40,660
people squatter domains - what would

766
00:33:40,660 --> 00:33:42,100
look like a legitimate service and

767
00:33:42,100 --> 00:33:44,110
originally the idea was can we use this

768
00:33:44,110 --> 00:33:45,850
on some of our products such as

769
00:33:45,850 --> 00:33:47,950
endpoints to look for weird connections

770
00:33:47,950 --> 00:33:50,170
to a URL can we run this over some of

771
00:33:50,170 --> 00:33:52,030
our emails on the tree to see hey can we

772
00:33:52,030 --> 00:33:53,770
use this to potentially find you know

773
00:33:53,770 --> 00:33:55,780
these spearfishing domains and block

774
00:33:55,780 --> 00:33:57,910
them before the user ever has a chance

775
00:33:57,910 --> 00:33:59,950
to click on them and then what we do is

776
00:33:59,950 --> 00:34:01,600
we kind of just have one of our internal

777
00:34:01,600 --> 00:34:03,610
clusters and we said all right looks to

778
00:34:03,610 --> 00:34:05,020
turn this algorithm on and see what

779
00:34:05,020 --> 00:34:06,610
finds and it'll kind of give us our

780
00:34:06,610 --> 00:34:08,739
output into another directory so we're

781
00:34:08,739 --> 00:34:09,850
kind of like what that run in the

782
00:34:09,850 --> 00:34:11,530
background I think for a little bit and

783
00:34:11,530 --> 00:34:13,270
we came back and we saw that it was

784
00:34:13,270 --> 00:34:14,920
hitting on these weird stuff in Google

785
00:34:14,920 --> 00:34:16,690
and we're like whoa that's weird

786
00:34:16,690 --> 00:34:18,340
Google's clearly correct and we were

787
00:34:18,340 --> 00:34:20,080
kind of you know wondering what could

788
00:34:20,080 --> 00:34:21,909
possibly happen and then we noticed

789
00:34:21,909 --> 00:34:24,070
these ad works and this is where they

790
00:34:24,070 --> 00:34:26,020
were actually purchasing so for those of

791
00:34:26,020 --> 00:34:27,730
you who are unfamiliar with a Google ad

792
00:34:27,730 --> 00:34:30,340
works I can do a quick to an overview so

793
00:34:30,340 --> 00:34:31,870
I'm sure everyone's familiar with Google

794
00:34:31,870 --> 00:34:33,969
and maybe you want to order a pizza so

795
00:34:33,969 --> 00:34:35,679
you go into Google calm and you'll type

796
00:34:35,679 --> 00:34:37,420
in the word pizza and then it will give

797
00:34:37,420 --> 00:34:38,770
you the top results based off their

798
00:34:38,770 --> 00:34:40,360
ranking algorithm well one of the things

799
00:34:40,360 --> 00:34:42,130
you can also do is purchase what they're

800
00:34:42,130 --> 00:34:44,320
calling an Edward so what that does is

801
00:34:44,320 --> 00:34:46,000
that basically promotes your search

802
00:34:46,000 --> 00:34:48,010
engine or your search website to be at

803
00:34:48,010 --> 00:34:49,750
the very top of the page so if you were

804
00:34:49,750 --> 00:34:51,969
to type in pizza and I'm in Augusta and

805
00:34:51,969 --> 00:34:53,800
I own the local pizza shop I can try to

806
00:34:53,800 --> 00:34:55,389
promote my website in order to get more

807
00:34:55,389 --> 00:34:57,130
business what they were doing is they

808
00:34:57,130 --> 00:34:59,890
were buying these works such as watching

809
00:34:59,890 --> 00:35:02,560
or Bitcoin exchange or things like that

810
00:35:02,560 --> 00:35:04,360
they would try to purchase the actual

811
00:35:04,360 --> 00:35:05,860
legitimate one and then different

812
00:35:05,860 --> 00:35:06,910
variants that could have been affected

813
00:35:06,910 --> 00:35:09,850
by users so when they click on this they

814
00:35:09,850 --> 00:35:11,470
were kind of preying on them and

815
00:35:11,470 --> 00:35:13,030
assuming that they were can actually

816
00:35:13,030 --> 00:35:14,440
look through everything they're just

817
00:35:14,440 --> 00:35:16,390
going to say okay top result click here

818
00:35:16,390 --> 00:35:18,430
and that's what they were doing and this

819
00:35:18,430 --> 00:35:19,840
is two of the examples were able to

820
00:35:19,840 --> 00:35:20,380
discover

821
00:35:20,380 --> 00:35:24,130
in the wild and these those are the

822
00:35:24,130 --> 00:35:25,780
actual ones that Jeremiah were able to

823
00:35:25,780 --> 00:35:28,930
discover right if you do some lookups on

824
00:35:28,930 --> 00:35:31,750
it you'll see quickly registered to

825
00:35:31,750 --> 00:35:34,360
hundreds of thousands of hits and like

826
00:35:34,360 --> 00:35:37,660
less than a day that's a pretty that's

827
00:35:37,660 --> 00:35:40,660
an unusual indicator for us doing

828
00:35:40,660 --> 00:35:43,060
analysis and I should know that this was

829
00:35:43,060 --> 00:35:45,340
just from our open D in Santa Fe which

830
00:35:45,340 --> 00:35:48,160
is less than 5% of all Internet activity

831
00:35:48,160 --> 00:35:50,230
so just kind of keep that in mind that

832
00:35:50,230 --> 00:35:52,810
this is less than 5% and that was still

833
00:35:52,810 --> 00:35:55,030
Andy said that wrong it's up to as much

834
00:35:55,030 --> 00:36:01,330
as 5% of the internet this is what real

835
00:36:01,330 --> 00:36:05,020
site looks like no I said I got that

836
00:36:05,020 --> 00:36:06,310
wrong this is the seat this is a

837
00:36:06,310 --> 00:36:07,780
phishing site this is why these work so

838
00:36:07,780 --> 00:36:11,020
well this is the fishing site so you're

839
00:36:11,020 --> 00:36:13,510
probably wondering how we were able to

840
00:36:13,510 --> 00:36:14,830
do this we worked with local law

841
00:36:14,830 --> 00:36:16,210
enforcement and we were able to watch

842
00:36:16,210 --> 00:36:18,940
that box very closely and we we came up

843
00:36:18,940 --> 00:36:21,160
with something very strange the people

844
00:36:21,160 --> 00:36:22,900
who are running this scam did not seem

845
00:36:22,900 --> 00:36:25,390
to know anything about code servers or

846
00:36:25,390 --> 00:36:27,840
what at one point they even hard-coded

847
00:36:27,840 --> 00:36:32,050
they're a home ISP IP address into a

848
00:36:32,050 --> 00:36:35,260
config file for a firewall rule so it

849
00:36:35,260 --> 00:36:36,790
made it very easy for the Ukrainian

850
00:36:36,790 --> 00:36:39,730
police to find them but the code itself

851
00:36:39,730 --> 00:36:42,310
was all automated all they needed you to

852
00:36:42,310 --> 00:36:45,160
do was click on one of those ads and go

853
00:36:45,160 --> 00:36:46,840
to one of these spun up sites that looks

854
00:36:46,840 --> 00:36:48,700
real and it would transfer all your wall

855
00:36:48,700 --> 00:36:51,460
information out we figured some by the

856
00:36:51,460 --> 00:36:53,140
end of it or something close to 50

857
00:36:53,140 --> 00:36:56,820
million dollars worth of Bitcoin in

858
00:36:56,820 --> 00:37:00,220
February Bitcoin money well it was

859
00:37:00,220 --> 00:37:02,500
stolen it's worth I think eighteen by

860
00:37:02,500 --> 00:37:04,810
eighteen to nineteen cents now but at

861
00:37:04,810 --> 00:37:06,760
the time Bitcoin was doing well I'm

862
00:37:06,760 --> 00:37:07,870
talking about the eighteen and nineteen

863
00:37:07,870 --> 00:37:08,680
cents

864
00:37:08,680 --> 00:37:12,730
it's at least $20 tipping cents so

865
00:37:12,730 --> 00:37:14,560
you're wondering how how could we stop

866
00:37:14,560 --> 00:37:17,560
this right and Cisco art we couldn't we

867
00:37:17,560 --> 00:37:19,780
had to go to Google and this is a result

868
00:37:19,780 --> 00:37:23,920
we actually got Google to stop accepting

869
00:37:23,920 --> 00:37:27,370
AdWords for crypto currencies while they

870
00:37:27,370 --> 00:37:29,470
tried to work out a solution for this at

871
00:37:29,470 --> 00:37:30,790
this time they don't really have a good

872
00:37:30,790 --> 00:37:33,910
solution they're working on it any day

873
00:37:33,910 --> 00:37:34,450
now

874
00:37:34,450 --> 00:37:36,790
so if you guys want to collectively join

875
00:37:36,790 --> 00:37:40,329
me and holding my breath it will any day

876
00:37:40,329 --> 00:37:42,940
now be ready to go again don't hold your

877
00:37:42,940 --> 00:37:43,329
breath

878
00:37:43,329 --> 00:37:45,309
don't tell anyone someone at speech told

879
00:37:45,309 --> 00:37:46,920
you hold your breath waiting for Google

880
00:37:46,920 --> 00:37:52,240
wall die so who's heard of Olympic

881
00:37:52,240 --> 00:37:55,960
destroyer did it destroy your Olympics

882
00:37:55,960 --> 00:37:58,359
experience now I didn't really destroy

883
00:37:58,359 --> 00:38:00,190
him was a live experience and now it's a

884
00:38:00,190 --> 00:38:01,660
problem as I'm not a big fan of the

885
00:38:01,660 --> 00:38:03,819
Olympics misses with my normal

886
00:38:03,819 --> 00:38:09,280
television schedule but then Dan had

887
00:38:09,280 --> 00:38:11,230
actually just started working at Cisco

888
00:38:11,230 --> 00:38:15,040
when this happened one member of our

889
00:38:15,040 --> 00:38:17,200
European two members of our European

890
00:38:17,200 --> 00:38:20,170
outreach team were researching this and

891
00:38:20,170 --> 00:38:21,700
found it and that were able to publish

892
00:38:21,700 --> 00:38:24,160
it quickly long before anyone else knew

893
00:38:24,160 --> 00:38:29,049
it was the thing and it had some basic

894
00:38:29,049 --> 00:38:31,299
very similar workflow to BPM filter but

895
00:38:31,299 --> 00:38:34,059
different targets it would inject a win

896
00:38:34,059 --> 00:38:36,970
logon dot exe process with either WMI or

897
00:38:36,970 --> 00:38:39,700
PS exec and it would be able to scan an

898
00:38:39,700 --> 00:38:44,020
IP subnet or do ARP lookups for other

899
00:38:44,020 --> 00:38:45,849
machines at it it would then compromise

900
00:38:45,849 --> 00:38:50,260
it and move on a little bit destroyer

901
00:38:50,260 --> 00:38:52,690
could do a lot of what all the other

902
00:38:52,690 --> 00:38:53,829
malware that we've been talking about

903
00:38:53,829 --> 00:38:55,630
you do it's still credentials from the

904
00:38:55,630 --> 00:38:59,140
browser it would steal stuff stealer

905
00:38:59,140 --> 00:38:59,770
stealer

906
00:38:59,770 --> 00:39:02,010
I'm gonna have to ask me about that I

907
00:39:02,010 --> 00:39:04,030
think that's supposed to be systems

908
00:39:04,030 --> 00:39:06,540
failure well I like stealer stealer

909
00:39:06,540 --> 00:39:08,500
right that makes you think that you're

910
00:39:08,500 --> 00:39:09,880
gonna go to a football game with the

911
00:39:09,880 --> 00:39:11,530
Steelers first up like the Pats and

912
00:39:11,530 --> 00:39:13,809
they're just gone the Russians have

913
00:39:13,809 --> 00:39:16,780
stolen the Steelers pass so it would

914
00:39:16,780 --> 00:39:18,849
actually patch one log on and show

915
00:39:18,849 --> 00:39:22,299
discovery credentials it had a wiping

916
00:39:22,299 --> 00:39:24,400
capability much like Nietzsche where the

917
00:39:24,400 --> 00:39:27,940
black energy malware from 2016 and it

918
00:39:27,940 --> 00:39:30,160
could run PSS Zak and connect two

919
00:39:30,160 --> 00:39:31,329
additional boxes with it

920
00:39:31,329 --> 00:39:34,809
pretty standard stuff and nowadays we

921
00:39:34,809 --> 00:39:37,089
have a more deep belief that these are

922
00:39:37,089 --> 00:39:40,240
all part of a larger campaign being

923
00:39:40,240 --> 00:39:44,380
perpetrated by a particular actor so the

924
00:39:44,380 --> 00:39:45,970
one thing to know about this is it was

925
00:39:45,970 --> 00:39:47,559
so particularly effective because it was

926
00:39:47,559 --> 00:39:48,349
a worm that

927
00:39:48,349 --> 00:39:50,720
release in a wild traditionally when you

928
00:39:50,720 --> 00:39:52,130
have these sorts of operations they

929
00:39:52,130 --> 00:39:54,019
actually have some sort of person or a

930
00:39:54,019 --> 00:39:55,640
group of people interacting with these

931
00:39:55,640 --> 00:39:57,410
things to try to grab some information

932
00:39:57,410 --> 00:39:59,509
this one that kinda exists they let go

933
00:39:59,509 --> 00:40:01,160
wild and then they basically just

934
00:40:01,160 --> 00:40:02,630
stepped away from it and let them do its

935
00:40:02,630 --> 00:40:04,099
thing and the next way I was just able

936
00:40:04,099 --> 00:40:05,630
to continuously try to go from one

937
00:40:05,630 --> 00:40:07,609
computer to the next computer and it was

938
00:40:07,609 --> 00:40:09,710
just wiping the Master Boot Record or to

939
00:40:09,710 --> 00:40:12,950
basically make the system inoperable and

940
00:40:12,950 --> 00:40:16,160
that brings us to bad rabbit now looking

941
00:40:16,160 --> 00:40:17,569
at this gif do you get the feeling that

942
00:40:17,569 --> 00:40:21,729
this is a mischievous and/or bad rabbit

943
00:40:24,579 --> 00:40:28,309
yeah yeah that's this my I don't do

944
00:40:28,309 --> 00:40:30,170
graphics my weight okay that could we

945
00:40:30,170 --> 00:40:32,059
talk to the graphics we can barely do

946
00:40:32,059 --> 00:40:36,019
the spelling so this a very similar

947
00:40:36,019 --> 00:40:37,729
propagation that would create a fake

948
00:40:37,729 --> 00:40:39,890
file called info pub that and it would

949
00:40:39,890 --> 00:40:43,039
scan port 139 internally so it would get

950
00:40:43,039 --> 00:40:45,259
in originally via via spearfishing and

951
00:40:45,259 --> 00:40:47,539
once it would get a foothold it would be

952
00:40:47,539 --> 00:40:48,880
able to scan internally uh

953
00:40:48,880 --> 00:40:51,499
4139 looking for additional credentials

954
00:40:51,499 --> 00:40:57,769
or opportunity to laterally move anybody

955
00:40:57,769 --> 00:41:01,660
know what the name of ms70 no 101 is

956
00:41:01,660 --> 00:41:06,019
eternal blue that's what we felt the

957
00:41:06,019 --> 00:41:07,339
rabbit should have been blue but

958
00:41:07,339 --> 00:41:10,400
apparently we don't know what we're

959
00:41:10,400 --> 00:41:14,180
talking about but after being able to

960
00:41:14,180 --> 00:41:16,400
scan for everything it could internally

961
00:41:16,400 --> 00:41:18,799
it would then use a eternal blue to try

962
00:41:18,799 --> 00:41:21,799
to move laterally so well this is

963
00:41:21,799 --> 00:41:22,309
interesting

964
00:41:22,309 --> 00:41:25,489
we have one more thing to talk about

965
00:41:25,489 --> 00:41:28,670
which is actually funny and we'll be

966
00:41:28,670 --> 00:41:31,099
able to take questions on this after the

967
00:41:31,099 --> 00:41:33,380
presentation who's who's heard of

968
00:41:33,380 --> 00:41:36,829
ccleaner alright ccleaner who is amazing

969
00:41:36,829 --> 00:41:39,499
I'm going to tell you a true story that

970
00:41:39,499 --> 00:41:41,779
we tapped around a little bit about in

971
00:41:41,779 --> 00:41:45,170
the media but we never ever really were

972
00:41:45,170 --> 00:41:47,349
real internally we have a host-based

973
00:41:47,349 --> 00:41:51,019
endpoint two lamp runs on your host that

974
00:41:51,019 --> 00:41:52,969
looks for all this type of nasty

975
00:41:52,969 --> 00:41:56,390
endpoint malware okay we actually we're

976
00:41:56,390 --> 00:41:57,979
in the process of rolling out new

977
00:41:57,979 --> 00:41:59,630
functionality and you know if you've

978
00:41:59,630 --> 00:42:00,790
ever had to write software

979
00:42:00,790 --> 00:42:04,000
functionality means bugs lots and lots

980
00:42:04,000 --> 00:42:09,220
of bugs so we got a piece of yeah we got

981
00:42:09,220 --> 00:42:11,230
binary from a partner that's like hey

982
00:42:11,230 --> 00:42:13,090
we're running your beta version

983
00:42:13,090 --> 00:42:16,180
it keeps flagging on this we looked at

984
00:42:16,180 --> 00:42:17,890
it it was signed correctly and it was

985
00:42:17,890 --> 00:42:21,040
from a vas as part of the ccleaner it's

986
00:42:21,040 --> 00:42:23,980
all family so we went like most normal

987
00:42:23,980 --> 00:42:26,080
people would alright where did our total

988
00:42:26,080 --> 00:42:29,320
break they spent three days and I cannot

989
00:42:29,320 --> 00:42:32,950
even begin to analyze how much manpower

990
00:42:32,950 --> 00:42:35,110
was spent on trying to figure out what

991
00:42:35,110 --> 00:42:39,160
about our tool was broken it turns out

992
00:42:39,160 --> 00:42:42,280
our tool was not broken at all it turns

993
00:42:42,280 --> 00:42:43,990
out our tool of sewing is exactly what

994
00:42:43,990 --> 00:42:46,240
was supposed to do that ccleaner binary

995
00:42:46,240 --> 00:42:48,070
was indeed backdoored

996
00:42:48,070 --> 00:42:50,380
so you have knocked us all over with a

997
00:42:50,380 --> 00:42:52,630
feather and there was some really

998
00:42:52,630 --> 00:42:55,090
colorful language there may have been a

999
00:42:55,090 --> 00:42:57,670
chair thrown anything stop a whole team

1000
00:42:57,670 --> 00:42:59,830
for working 72 straight hours to find a

1001
00:42:59,830 --> 00:43:02,200
book a so sorrowful logic and multiple

1002
00:43:02,200 --> 00:43:04,570
cases being escalated to us for being

1003
00:43:04,570 --> 00:43:05,980
like why are we blanking on false

1004
00:43:05,980 --> 00:43:09,700
positives there was any time to say

1005
00:43:09,700 --> 00:43:11,710
there's a kerfuffle going on but it

1006
00:43:11,710 --> 00:43:14,410
would be minor there was a bit of a

1007
00:43:14,410 --> 00:43:17,050
misunderstanding but when we finally

1008
00:43:17,050 --> 00:43:19,180
figured it out it was actually pretty

1009
00:43:19,180 --> 00:43:22,180
easy to understand we were able to work

1010
00:43:22,180 --> 00:43:26,710
with partners to get the the list of C

1011
00:43:26,710 --> 00:43:32,050
to process the copy of the c2 server was

1012
00:43:32,050 --> 00:43:34,270
downloading and we found that while

1013
00:43:34,270 --> 00:43:36,550
stage 1 was prevalent the second stage

1014
00:43:36,550 --> 00:43:37,840
that would download you'd have to be on

1015
00:43:37,840 --> 00:43:39,970
a specific whitelist from a specific

1016
00:43:39,970 --> 00:43:42,220
domain and those domains were high tech

1017
00:43:42,220 --> 00:43:44,790
companies like Cisco

1018
00:43:44,790 --> 00:43:46,840
Microsoft you had to be from one of

1019
00:43:46,840 --> 00:43:48,270
those countries to get the vaulted

1020
00:43:48,270 --> 00:43:52,000
domain thankfully us being Cisco we were

1021
00:43:52,000 --> 00:43:53,290
able to get a second piece of the

1022
00:43:53,290 --> 00:43:55,240
malware pretty easily for additional

1023
00:43:55,240 --> 00:43:57,850
reverse engineering so just in the

1024
00:43:57,850 --> 00:44:00,640
future if you're writing a PT's don't

1025
00:44:00,640 --> 00:44:03,070
don't naturally include companies that

1026
00:44:03,070 --> 00:44:06,010
have their own built in apt research

1027
00:44:06,010 --> 00:44:07,990
teams as people that should be able to

1028
00:44:07,990 --> 00:44:10,990
get second stage malware downloads but

1029
00:44:10,990 --> 00:44:12,730
that's another hearing over there the

1030
00:44:12,730 --> 00:44:14,799
the story that i want you to take away

1031
00:44:14,799 --> 00:44:17,529
this is that we built the tool to flag

1032
00:44:17,529 --> 00:44:20,229
this we deployed it but we did not trust

1033
00:44:20,229 --> 00:44:22,839
it the first hint of problems we said oh

1034
00:44:22,839 --> 00:44:25,900
well it must be a tool mistake and we

1035
00:44:25,900 --> 00:44:28,959
spent 72 hours and who knows how many

1036
00:44:28,959 --> 00:44:31,119
man hours trying to find that mistake if

1037
00:44:31,119 --> 00:44:32,529
you don't trust the tools that you're

1038
00:44:32,529 --> 00:44:34,119
using you shouldn't be using them and

1039
00:44:34,119 --> 00:44:35,650
that was a lesson that we had to learn

1040
00:44:35,650 --> 00:44:41,769
even for ourselves any questions yes

1041
00:44:41,769 --> 00:44:43,979
ma'am

1042
00:44:59,060 --> 00:45:02,199
[Music]

1043
00:45:09,820 --> 00:45:13,530
well there's a look on the bus

1044
00:45:25,380 --> 00:45:27,630
does any remember the story that I've

1045
00:45:27,630 --> 00:45:31,460
asked gave for why that happened

1046
00:45:32,030 --> 00:45:34,970
apparently ccleaner was bought from a

1047
00:45:34,970 --> 00:45:37,170
standalone company the integrated to

1048
00:45:37,170 --> 00:45:39,150
have a product line and they said that

1049
00:45:39,150 --> 00:45:41,790
the guys who did that we're now leaving

1050
00:45:41,790 --> 00:45:44,820
to start their own new company to do the

1051
00:45:44,820 --> 00:45:47,250
same thing and they bugged

1052
00:45:47,250 --> 00:45:49,740
CCleaner to advertise for their new

1053
00:45:49,740 --> 00:45:54,540
company that's so crazy I came to say it

1054
00:45:54,540 --> 00:45:56,580
without really laughing I mean it does

1055
00:45:56,580 --> 00:45:58,740
look like I'm laughing oh boy am i

1056
00:45:58,740 --> 00:46:01,140
laughing but you're absolutely right

1057
00:46:01,140 --> 00:46:04,350
ccleaner is something that traditionally

1058
00:46:04,350 --> 00:46:08,280
could be bugged and that was around the

1059
00:46:08,280 --> 00:46:10,590
beginning of the third day when people

1060
00:46:10,590 --> 00:46:13,440
started asking well what if it's

1061
00:46:13,440 --> 00:46:16,560
ccleaner and not the known good binary

1062
00:46:16,560 --> 00:46:18,780
that we've been but for the first day we

1063
00:46:18,780 --> 00:46:19,980
actually had no idea really what the

1064
00:46:19,980 --> 00:46:22,080
binary was we just knew as a binary and

1065
00:46:22,080 --> 00:46:25,500
it was a false positive and it was until

1066
00:46:25,500 --> 00:46:26,670
being the third day that people started

1067
00:46:26,670 --> 00:46:29,520
going what is this and somebody said it

1068
00:46:29,520 --> 00:46:31,890
was ccleaner and I said you know what

1069
00:46:31,890 --> 00:46:34,710
was funny about the D&C hack the bad

1070
00:46:34,710 --> 00:46:36,450
guys just ccleaner to clean up after

1071
00:46:36,450 --> 00:46:37,100
themselves

1072
00:46:37,100 --> 00:46:42,420
and that point we went oh dear I said

1073
00:46:42,420 --> 00:46:44,520
the one that was a little exactly how it

1074
00:46:44,520 --> 00:46:47,010
was said - oh oh dear

1075
00:46:47,010 --> 00:46:49,350
so I was think the one thing is I don't

1076
00:46:49,350 --> 00:46:51,000
want to harp on the best so much because

1077
00:46:51,000 --> 00:46:53,340
any sort of large company could be

1078
00:46:53,340 --> 00:46:54,690
vulnerable to these types of attacks

1079
00:46:54,690 --> 00:46:57,270
they were is just unfortunate of not

1080
00:46:57,270 --> 00:47:00,090
having you know a proper network plan or

1081
00:47:00,090 --> 00:47:01,620
network security plan in place at that

1082
00:47:01,620 --> 00:47:03,480
particular moment um this kind of

1083
00:47:03,480 --> 00:47:05,160
happened to a Cisco this could happen to

1084
00:47:05,160 --> 00:47:07,530
a Microsoft so I wouldn't say I would

1085
00:47:07,530 --> 00:47:09,810
inherently distrust any one particular

1086
00:47:09,810 --> 00:47:12,270
product but the only thing I will say if

1087
00:47:12,270 --> 00:47:14,280
you are some sort of system admin is

1088
00:47:14,280 --> 00:47:15,780
that when you're creating kind of your

1089
00:47:15,780 --> 00:47:17,400
gold image that you're gonna use across

1090
00:47:17,400 --> 00:47:19,770
multiple different workstations just ask

1091
00:47:19,770 --> 00:47:21,810
yourself is to software that the end

1092
00:47:21,810 --> 00:47:23,970
user actually needs or it's just

1093
00:47:23,970 --> 00:47:25,740
something that could be cut out or most

1094
00:47:25,740 --> 00:47:26,820
people they're going to need maybe

1095
00:47:26,820 --> 00:47:28,560
Microsoft Word or they're gonna need

1096
00:47:28,560 --> 00:47:30,330
some certain you know outlook products

1097
00:47:30,330 --> 00:47:31,980
but I picked something like this that

1098
00:47:31,980 --> 00:47:33,720
you really don't need on there you

1099
00:47:33,720 --> 00:47:35,160
shouldn't be having it on your corporate

1100
00:47:35,160 --> 00:47:37,380
network or on your corporate workstation

1101
00:47:37,380 --> 00:47:39,779
I think they expend the best way to

1102
00:47:39,779 --> 00:47:41,430
think about things and that goes across

1103
00:47:41,430 --> 00:47:43,019
multiple things in multiple different

1104
00:47:43,019 --> 00:47:58,979
products yes we actually saw that

1105
00:47:58,979 --> 00:48:02,039
technique used earlier that year in the

1106
00:48:02,039 --> 00:48:04,829
me doc Nietzsche case where for three

1107
00:48:04,829 --> 00:48:07,589
hours the update Center server for the

1108
00:48:07,589 --> 00:48:09,390
me doc accounting software was

1109
00:48:09,390 --> 00:48:13,529
redirected to a box in OVH with a let's

1110
00:48:13,529 --> 00:48:16,049
encrypt certificate so if you're

1111
00:48:16,049 --> 00:48:19,950
following along at home great OVH and

1112
00:48:19,950 --> 00:48:26,220
Nana let secret are not your friends we

1113
00:48:26,220 --> 00:48:28,410
got five minutes left she wants to ask

1114
00:48:28,410 --> 00:48:30,869
any crazy thoughts anybody want to hear

1115
00:48:30,869 --> 00:48:32,519
about what I think about what's in the

1116
00:48:32,519 --> 00:48:36,089
area 51 no area 51 is great they have

1117
00:48:36,089 --> 00:48:38,849
bad cheeseburgers no thing 60 links he

1118
00:48:38,849 --> 00:48:41,069
loves handling I don't want to say it's

1119
00:48:41,069 --> 00:48:45,239
aliens but but any other questions

1120
00:48:45,239 --> 00:48:47,219
comments suggestions will also be

1121
00:48:47,219 --> 00:48:49,019
available right after this talk if you

1122
00:48:49,019 --> 00:48:52,399
want to talk to us on one oh yes sir

1123
00:49:19,940 --> 00:49:23,090
but you got to understand the question

1124
00:49:23,090 --> 00:49:25,730
was what would you do about applications

1125
00:49:25,730 --> 00:49:28,010
in the future to keep him safe right and

1126
00:49:28,010 --> 00:49:30,050
that is an actual great question and

1127
00:49:30,050 --> 00:49:32,570
here's the problem and both of the

1128
00:49:32,570 --> 00:49:34,790
ccleaner and the Medoc case the

1129
00:49:34,790 --> 00:49:36,650
application that was distributed were

1130
00:49:36,650 --> 00:49:37,520
good

1131
00:49:37,520 --> 00:49:39,470
it was the update functionality that

1132
00:49:39,470 --> 00:49:43,040
pushed down a bad update for both of

1133
00:49:43,040 --> 00:49:43,310
them

1134
00:49:43,310 --> 00:49:46,850
so if you're looking to keep a manifest

1135
00:49:46,850 --> 00:49:49,880
of well tested and known good binaries

1136
00:49:49,880 --> 00:49:53,150
by checksum your that's only as useful

1137
00:49:53,150 --> 00:49:55,510
as a still a new update comes out

1138
00:49:55,510 --> 00:49:59,090
personally I'm a paranoid person so I

1139
00:49:59,090 --> 00:50:01,550
would disable auto update on

1140
00:50:01,550 --> 00:50:04,420
applications in general I would have a

1141
00:50:04,420 --> 00:50:06,980
isolated sandbox like environment where

1142
00:50:06,980 --> 00:50:08,870
updates are downloaded applied and

1143
00:50:08,870 --> 00:50:10,700
tested I wouldn't just test for

1144
00:50:10,700 --> 00:50:13,520
operations I would test for suspicious

1145
00:50:13,520 --> 00:50:16,100
Network behavior you're looking for

1146
00:50:16,100 --> 00:50:20,750
anomalies Network behavior after that

1147
00:50:20,750 --> 00:50:24,010
after that passes a soaking period

1148
00:50:24,010 --> 00:50:26,860
bundle it and push it via whatever

1149
00:50:26,860 --> 00:50:29,030
update message you have for your

1150
00:50:29,030 --> 00:50:32,150
organization and everybody there's so

1151
00:50:32,150 --> 00:50:34,400
many different update methodologies you

1152
00:50:34,400 --> 00:50:35,930
know take your pick but I would make

1153
00:50:35,930 --> 00:50:37,850
sure that I am the one distributing the

1154
00:50:37,850 --> 00:50:41,480
auto-update not an external vendor once

1155
00:50:41,480 --> 00:50:43,430
you have somebody that can go from your

1156
00:50:43,430 --> 00:50:46,250
box through your perimeter defense grab

1157
00:50:46,250 --> 00:50:49,460
a piece of code download locally and

1158
00:50:49,460 --> 00:50:51,200
execute it you've created basically your

1159
00:50:51,200 --> 00:50:54,140
own back door there don't create your

1160
00:50:54,140 --> 00:50:57,080
own back door so I think next what we

1161
00:50:57,080 --> 00:50:58,700
would like to do in every particular

1162
00:50:58,700 --> 00:51:01,700
ideal case however I wasn't with most

1163
00:51:01,700 --> 00:51:03,620
doors and businesses or you don't really

1164
00:51:03,620 --> 00:51:05,960
get to have that look safe so I think is

1165
00:51:05,960 --> 00:51:07,520
try to do your best to work with your

1166
00:51:07,520 --> 00:51:09,530
management with your CTO a traffic

1167
00:51:09,530 --> 00:51:11,900
policy in place to say hey if we want to

1168
00:51:11,900 --> 00:51:13,730
start any additional software you need

1169
00:51:13,730 --> 00:51:15,590
to be known that there is a potential

1170
00:51:15,590 --> 00:51:17,960
security risk there's always a greater

1171
00:51:17,960 --> 00:51:20,930
exposure because of Excel anyway what

1172
00:51:20,930 --> 00:51:22,880
we're trying to uh say that if your boss

1173
00:51:22,880 --> 00:51:24,140
comes in and tells you you need to

1174
00:51:24,140 --> 00:51:27,080
install this right now 99% of the system

1175
00:51:27,080 --> 00:51:29,210
admins are gonna say okay cool may

1176
00:51:29,210 --> 00:51:30,590
expose things where we kind of want to

1177
00:51:30,590 --> 00:51:32,300
our bus or at least I won't do my best

1178
00:51:32,300 --> 00:51:33,770
to protect some of these newer or

1179
00:51:33,770 --> 00:51:35,630
level people so that way infant those

1180
00:51:35,630 --> 00:51:37,190
fall down you're not the one holding the

1181
00:51:37,190 --> 00:51:39,230
bag you can say well my management told

1182
00:51:39,230 --> 00:51:41,060
me to do so and at least done you know

1183
00:51:41,060 --> 00:51:43,160
you're not the one who is stuck at the

1184
00:51:43,160 --> 00:51:46,670
end thank you for coming like I said

1185
00:51:46,670 --> 00:51:48,230
will be available right outside the door

1186
00:51:48,230 --> 00:51:50,180
for additional questions comments if you

1187
00:51:50,180 --> 00:51:51,650
just want to talk about other stuff

1188
00:51:51,650 --> 00:51:55,190
we'll be right outside right outside the

1189
00:51:55,190 --> 00:51:57,260
door thank you very much for coming and

1190
00:51:57,260 --> 00:51:58,860
we love feedback

1191
00:51:58,860 --> 00:52:04,199
[Applause]

