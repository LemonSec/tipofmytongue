1
00:01:46,080 --> 00:01:49,110
could've been

2
00:01:51,860 --> 00:01:54,140
rookie mic mistakes all apologies

3
00:01:54,140 --> 00:01:55,520
alright I'll go ahead and continue so

4
00:01:55,520 --> 00:01:57,620
back to the saying so you know hopefully

5
00:01:57,620 --> 00:02:00,050
I can identify some things that you know

6
00:02:00,050 --> 00:02:01,550
that maybe you even if you are as an

7
00:02:01,550 --> 00:02:02,990
organization or utilizing purple team

8
00:02:02,990 --> 00:02:04,250
that you're missing a little bit out of

9
00:02:04,250 --> 00:02:05,690
maybe some additional benefits that you

10
00:02:05,690 --> 00:02:06,860
can get for purple teaming in your

11
00:02:06,860 --> 00:02:09,770
environment or as an organization and

12
00:02:09,770 --> 00:02:11,300
answer some more things we can do with

13
00:02:11,300 --> 00:02:14,180
it to improve our team's workflows build

14
00:02:14,180 --> 00:02:15,980
a playbook for your team's to utilize

15
00:02:15,980 --> 00:02:20,540
during live ops so what is purple

16
00:02:20,540 --> 00:02:22,100
teaming right first I will start by kind

17
00:02:22,100 --> 00:02:23,210
of defining give you a little background

18
00:02:23,210 --> 00:02:24,950
of you know traditionally what purple

19
00:02:24,950 --> 00:02:26,810
teaming has been made up of and and how

20
00:02:26,810 --> 00:02:29,480
it's being done so you know purple

21
00:02:29,480 --> 00:02:31,190
teaming is done by emulating a technique

22
00:02:31,190 --> 00:02:33,830
or a series of given techniques in a

23
00:02:33,830 --> 00:02:36,200
controlled environment what that does is

24
00:02:36,200 --> 00:02:38,420
allows the team to kind of observe those

25
00:02:38,420 --> 00:02:41,150
techniques actually be able to write a

26
00:02:41,150 --> 00:02:43,190
detection for that technique or identify

27
00:02:43,190 --> 00:02:45,170
a gap where maybe maybe I don't have

28
00:02:45,170 --> 00:02:47,060
enough data being collected to capture

29
00:02:47,060 --> 00:02:48,500
and observe and write a detection or an

30
00:02:48,500 --> 00:02:50,000
analytic for this technique but

31
00:02:50,000 --> 00:02:51,800
essentially it's complete transparency

32
00:02:51,800 --> 00:02:54,830
right it is not blue versus red at all

33
00:02:54,830 --> 00:02:56,030
there's not pitted against each other

34
00:02:56,030 --> 00:02:57,920
it's essentially either you know a

35
00:02:57,920 --> 00:03:00,530
person or persons going through both of

36
00:03:00,530 --> 00:03:02,600
those functions emulating that technique

37
00:03:02,600 --> 00:03:04,880
as if you were a red teamer but at the

38
00:03:04,880 --> 00:03:06,860
same time knowing exactly what's coming

39
00:03:06,860 --> 00:03:08,450
across the wire so that you can observe

40
00:03:08,450 --> 00:03:11,120
it as a blue team or you know and then

41
00:03:11,120 --> 00:03:13,070
have the opportunity to better detect

42
00:03:13,070 --> 00:03:15,500
that technique in the future so purple

43
00:03:15,500 --> 00:03:17,959
teaming is not over seeing a red vs.

44
00:03:17,959 --> 00:03:19,760
blue exercise so you know I didn't

45
00:03:19,760 --> 00:03:21,769
research as I'm going into this talk

46
00:03:21,769 --> 00:03:22,850
kind of making sure I'm not a crazy

47
00:03:22,850 --> 00:03:25,250
person that what I think about purple

48
00:03:25,250 --> 00:03:26,870
team and how it exists and I did see a

49
00:03:26,870 --> 00:03:28,940
few times reference like you know you

50
00:03:28,940 --> 00:03:30,560
get the definition of red blue and

51
00:03:30,560 --> 00:03:32,410
purple teens and one of the things I saw

52
00:03:32,410 --> 00:03:34,610
everyone saw an article you know as the

53
00:03:34,610 --> 00:03:35,900
term mention of purple team just

54
00:03:35,900 --> 00:03:38,360
facilitating a good exercise of red

55
00:03:38,360 --> 00:03:39,650
versus blue and that's not really a

56
00:03:39,650 --> 00:03:41,720
purple teaming it is a tall purple

57
00:03:41,720 --> 00:03:44,000
teaming removes that competition factor

58
00:03:44,000 --> 00:03:45,950
and really just come combines those

59
00:03:45,950 --> 00:03:48,590
teams into making them one unit that's

60
00:03:48,590 --> 00:03:50,830
just meant to you know collaborates

61
00:03:50,830 --> 00:03:53,030
better write better detections and you

62
00:03:53,030 --> 00:03:54,950
currently have give yourself more

63
00:03:54,950 --> 00:03:56,570
coverage of these techniques than you

64
00:03:56,570 --> 00:03:58,400
currently have or maybe identify gaps

65
00:03:58,400 --> 00:03:59,540
where you're not able to have that

66
00:03:59,540 --> 00:04:03,470
coverage so yeah not necessarily I'm not

67
00:04:03,470 --> 00:04:05,209
facilitating a red versus blue we have

68
00:04:05,209 --> 00:04:05,520
white

69
00:04:05,520 --> 00:04:07,590
cell and things like that there serve

70
00:04:07,590 --> 00:04:10,640
that purpose in an exercise environment

71
00:04:10,640 --> 00:04:13,770
so just quick comparison you know Red

72
00:04:13,770 --> 00:04:15,840
Team obviously acting as the adversary

73
00:04:15,840 --> 00:04:17,640
they're all you know is to achieve

74
00:04:17,640 --> 00:04:21,060
actions on objectives and should be to

75
00:04:21,060 --> 00:04:23,180
create training for blue right so

76
00:04:23,180 --> 00:04:26,390
accurately emulate some kind of threats

77
00:04:26,390 --> 00:04:29,100
you know and try and be Blue Team Red

78
00:04:29,100 --> 00:04:31,740
Team always attempting to evade blue you

79
00:04:31,740 --> 00:04:33,450
know it's kind of I want to win I don't

80
00:04:33,450 --> 00:04:35,250
want to lose kind of thing so blue team

81
00:04:35,250 --> 00:04:37,280
traditionally the defenders in that

82
00:04:37,280 --> 00:04:39,420
equation they're gonna you know observe

83
00:04:39,420 --> 00:04:41,130
report on those techniques that they've

84
00:04:41,130 --> 00:04:42,960
seen and then they're gonna you know

85
00:04:42,960 --> 00:04:44,520
take action whatever the exercise

86
00:04:44,520 --> 00:04:45,780
outlines for what you're supposed to do

87
00:04:45,780 --> 00:04:47,550
when you observe that red activity but

88
00:04:47,550 --> 00:04:48,870
those teams are pitted against each

89
00:04:48,870 --> 00:04:51,600
other and that you know effort of I'm

90
00:04:51,600 --> 00:04:53,700
you know I'm trying to bypass you or I'm

91
00:04:53,700 --> 00:04:55,440
trying to stop everything you do or

92
00:04:55,440 --> 00:04:56,610
whatever it's kind of what purple

93
00:04:56,610 --> 00:04:59,430
teaming removes by like I said combining

94
00:04:59,430 --> 00:05:02,190
those teams into one unit one function

95
00:05:02,190 --> 00:05:05,940
right so you can either be you know

96
00:05:05,940 --> 00:05:07,770
purple team you can be the person on

97
00:05:07,770 --> 00:05:09,510
keyboard that emulates the technique and

98
00:05:09,510 --> 00:05:10,470
the one on the other side of the

99
00:05:10,470 --> 00:05:11,610
keyboard that's helping write that

100
00:05:11,610 --> 00:05:13,110
detection right so it just removes that

101
00:05:13,110 --> 00:05:15,450
competition factor it really allows you

102
00:05:15,450 --> 00:05:17,580
to thrive and getting to see everything

103
00:05:17,580 --> 00:05:19,710
that you've done on the environment has

104
00:05:19,710 --> 00:05:21,630
a red teamer or just being able to see

105
00:05:21,630 --> 00:05:23,460
that technique in full as a blue team ER

106
00:05:23,460 --> 00:05:25,710
because you fully expect it to come at

107
00:05:25,710 --> 00:05:27,390
you right like you know what techniques

108
00:05:27,390 --> 00:05:29,280
being emulated it's been identified that

109
00:05:29,280 --> 00:05:30,510
these are the techniques you're gonna

110
00:05:30,510 --> 00:05:32,220
cover in a session or an activity or

111
00:05:32,220 --> 00:05:37,710
anything like that so how is purple

112
00:05:37,710 --> 00:05:39,600
teaming done one really really important

113
00:05:39,600 --> 00:05:41,340
step purple teaming is you need to

114
00:05:41,340 --> 00:05:43,980
choose a framework so and the reason I

115
00:05:43,980 --> 00:05:45,960
say that is because you need to have

116
00:05:45,960 --> 00:05:48,330
that list of techniques that you as a

117
00:05:48,330 --> 00:05:49,800
purple team need to be able to emulate

118
00:05:49,800 --> 00:05:51,270
all right you need to be able to decide

119
00:05:51,270 --> 00:05:53,070
whether you can detect it how you detect

120
00:05:53,070 --> 00:05:56,190
it or where those gaps are and so to

121
00:05:56,190 --> 00:05:57,570
have those techniques identified

122
00:05:57,570 --> 00:05:59,040
somewhere we would utilize a framework

123
00:05:59,040 --> 00:06:01,860
for that so we use mitre attack I think

124
00:06:01,860 --> 00:06:04,590
it's the most you know cumbersome

125
00:06:04,590 --> 00:06:06,210
framework that we have out there that

126
00:06:06,210 --> 00:06:08,370
fully accurate accurately defines all

127
00:06:08,370 --> 00:06:09,210
the different techniques that are

128
00:06:09,210 --> 00:06:10,800
possible from an adversary away from

129
00:06:10,800 --> 00:06:12,680
initial access you know to exfiltration

130
00:06:12,680 --> 00:06:17,760
so mitre has over like 200 techniques so

131
00:06:17,760 --> 00:06:19,110
obviously this is not something

132
00:06:19,110 --> 00:06:20,280
you're choosing a framework and you're

133
00:06:20,280 --> 00:06:21,690
gonna go sit down and in one session

134
00:06:21,690 --> 00:06:23,550
you're gonna think that you're gonna be

135
00:06:23,550 --> 00:06:25,230
able to emulate and then write detection

136
00:06:25,230 --> 00:06:26,700
for all those techniques or write

137
00:06:26,700 --> 00:06:28,410
analytics for those techniques if it's

138
00:06:28,410 --> 00:06:29,640
something you're needing to hunt for but

139
00:06:29,640 --> 00:06:31,290
then at the same time it's something you

140
00:06:31,290 --> 00:06:33,060
can break up into different sessions and

141
00:06:33,060 --> 00:06:35,100
over time kind of achieve you know

142
00:06:35,100 --> 00:06:36,810
mapping out the entire matrix and what

143
00:06:36,810 --> 00:06:38,010
your capabilities are against those

144
00:06:38,010 --> 00:06:41,130
techniques so how do we emulate those

145
00:06:41,130 --> 00:06:42,420
techniques so there's a lot of open

146
00:06:42,420 --> 00:06:44,210
source tools out there right so there's

147
00:06:44,210 --> 00:06:48,690
PowerShell Empire and puppy & Co ADAC

148
00:06:48,690 --> 00:06:50,370
all these things have been created that

149
00:06:50,370 --> 00:06:52,500
really make it easy to facilitate you

150
00:06:52,500 --> 00:06:53,910
know you emulate an adversary it's

151
00:06:53,910 --> 00:06:55,890
something red team's used often now

152
00:06:55,890 --> 00:06:57,000
obviously there's paid tools out there

153
00:06:57,000 --> 00:06:59,040
as well it can do all this but just list

154
00:06:59,040 --> 00:07:00,300
some open source ones they're the easy

155
00:07:00,300 --> 00:07:02,730
to grab really easy to use but they are

156
00:07:02,730 --> 00:07:05,490
more manual right so then as you can see

157
00:07:05,490 --> 00:07:06,720
on that next bullet there's actually

158
00:07:06,720 --> 00:07:09,390
been a lot of development more recently

159
00:07:09,390 --> 00:07:12,090
on automating that Red Team side of it

160
00:07:12,090 --> 00:07:14,430
which it's really really helpful in an

161
00:07:14,430 --> 00:07:15,960
organization that's trying to cover a

162
00:07:15,960 --> 00:07:17,460
lot of technique so just say a small

163
00:07:17,460 --> 00:07:19,140
organization may not have the same kind

164
00:07:19,140 --> 00:07:22,530
of manpower or time to dedicate so you

165
00:07:22,530 --> 00:07:24,150
can use those frameworks to them fully

166
00:07:24,150 --> 00:07:26,220
automate at least the majority of those

167
00:07:26,220 --> 00:07:28,980
attack techniques right so we got an

168
00:07:28,980 --> 00:07:33,090
example like uber meta project you know

169
00:07:33,090 --> 00:07:36,600
miters caldera reg Red Canaries atomic

170
00:07:36,600 --> 00:07:38,640
Red Team and then in games

171
00:07:38,640 --> 00:07:41,010
Red Team automation tool so they all

172
00:07:41,010 --> 00:07:42,510
offer something a little bit different

173
00:07:42,510 --> 00:07:45,360
you know some of these are say like Red

174
00:07:45,360 --> 00:07:47,610
Team automation and the atomic Red Team

175
00:07:47,610 --> 00:07:49,590
tools are basically just sets of scripts

176
00:07:49,590 --> 00:07:52,070
and instructions on how to emulate these

177
00:07:52,070 --> 00:07:54,210
techniques in an environment where as

178
00:07:54,210 --> 00:07:57,060
the other two may come with a VM or a

179
00:07:57,060 --> 00:07:59,160
set vm's and scripts that you actually

180
00:07:59,160 --> 00:08:01,590
stand up in environment and then in that

181
00:08:01,590 --> 00:08:02,760
environment these techniques are

182
00:08:02,760 --> 00:08:03,960
emulated but essentially what that

183
00:08:03,960 --> 00:08:05,820
allows you to do is instead of having to

184
00:08:05,820 --> 00:08:08,910
manually one-by-one figure out how to

185
00:08:08,910 --> 00:08:10,950
you know kick off that technique within

186
00:08:10,950 --> 00:08:12,480
one of the manual tools like an empire

187
00:08:12,480 --> 00:08:14,340
or Co a deck or anything like that you

188
00:08:14,340 --> 00:08:15,690
actually have the ability to easily

189
00:08:15,690 --> 00:08:17,790
script those techniques just so you're

190
00:08:17,790 --> 00:08:19,680
able to observe you know what they did

191
00:08:19,680 --> 00:08:21,630
on an endpoint able to try and write

192
00:08:21,630 --> 00:08:22,980
that detection of that analytic that

193
00:08:22,980 --> 00:08:24,450
you'll need to be able to find this in

194
00:08:24,450 --> 00:08:27,870
the wild so an important part of a

195
00:08:27,870 --> 00:08:30,450
purple teaming is making this a cyclical

196
00:08:30,450 --> 00:08:33,039
process right so it's not something

197
00:08:33,039 --> 00:08:34,509
where it's throwing everything against

198
00:08:34,509 --> 00:08:35,679
the wall and see what sticks it's

199
00:08:35,679 --> 00:08:37,000
something that you need to be able to

200
00:08:37,000 --> 00:08:39,849
evaluate and measure success over time

201
00:08:39,849 --> 00:08:43,599
so an example of that would be you know

202
00:08:43,599 --> 00:08:46,089
I we did you know 20 technique first

203
00:08:46,089 --> 00:08:48,759
session that we ever did and and then

204
00:08:48,759 --> 00:08:50,500
maybe we don't ever get back to those 20

205
00:08:50,500 --> 00:08:52,300
techniques until we've you know done

206
00:08:52,300 --> 00:08:54,940
enough sessions to kind of cover every

207
00:08:54,940 --> 00:08:56,290
technique on the miter attack matrix

208
00:08:56,290 --> 00:08:57,819
right but then when we do get back to

209
00:08:57,819 --> 00:08:59,380
that set of 20 and then we're kind of

210
00:08:59,380 --> 00:09:01,360
trying to either you know revamp any

211
00:09:01,360 --> 00:09:02,829
current defections we have maybe a

212
00:09:02,829 --> 00:09:05,199
techniques been modified but it's kind

213
00:09:05,199 --> 00:09:07,060
of close to how existed before you know

214
00:09:07,060 --> 00:09:09,459
a new binary is also found to be used to

215
00:09:09,459 --> 00:09:10,959
emulate that technique or whatever in

216
00:09:10,959 --> 00:09:13,029
the wild what you should be able to do

217
00:09:13,029 --> 00:09:14,560
is measure your success and have you

218
00:09:14,560 --> 00:09:16,630
improved in your ability to detect that

219
00:09:16,630 --> 00:09:19,600
technique over time right so have I you

220
00:09:19,600 --> 00:09:20,800
know maybe when I very first started

221
00:09:20,800 --> 00:09:23,199
this I kind of had enough data to where

222
00:09:23,199 --> 00:09:25,750
I could hunt for will say some kind of

223
00:09:25,750 --> 00:09:27,940
privilege escalation technique but then

224
00:09:27,940 --> 00:09:30,160
over time what you're able to do is say

225
00:09:30,160 --> 00:09:31,300
hey you know what you know this next

226
00:09:31,300 --> 00:09:32,560
round a purple team we actually found

227
00:09:32,560 --> 00:09:34,089
out how we could automate some of that

228
00:09:34,089 --> 00:09:36,430
and we actually have a flirt now in this

229
00:09:36,430 --> 00:09:37,750
process and or when this privilege

230
00:09:37,750 --> 00:09:39,730
escalation technique is seen in our

231
00:09:39,730 --> 00:09:40,930
environment or something that so that

232
00:09:40,930 --> 00:09:43,120
you're improving on that process over

233
00:09:43,120 --> 00:09:47,560
time right so just a little map of kind

234
00:09:47,560 --> 00:09:48,819
of what you know like what this should

235
00:09:48,819 --> 00:09:50,290
look like right so the first time you're

236
00:09:50,290 --> 00:09:52,120
going in that purple team exercise your

237
00:09:52,120 --> 00:09:53,709
concentration is just on writing

238
00:09:53,709 --> 00:09:55,660
detections and analytics like I said so

239
00:09:55,660 --> 00:09:57,760
whether it's I can fully automate this

240
00:09:57,760 --> 00:09:59,949
and create an alert from my analyst in

241
00:09:59,949 --> 00:10:02,170
our network or hey you know what we have

242
00:10:02,170 --> 00:10:04,690
the data to hunt for this so I can write

243
00:10:04,690 --> 00:10:06,610
an analytic that helps us you know carve

244
00:10:06,610 --> 00:10:07,899
out some of that data that we're able to

245
00:10:07,899 --> 00:10:09,370
collect in our environment and still

246
00:10:09,370 --> 00:10:11,500
identify didn't identify just more in a

247
00:10:11,500 --> 00:10:13,870
proactive way right that's still a way

248
00:10:13,870 --> 00:10:15,639
to detect that threat as long as you do

249
00:10:15,639 --> 00:10:17,709
in those proactive measures so as you're

250
00:10:17,709 --> 00:10:19,209
writing those detections and analytics

251
00:10:19,209 --> 00:10:20,980
you know the next step would be you need

252
00:10:20,980 --> 00:10:22,750
to implement those into ops and then

253
00:10:22,750 --> 00:10:23,620
what's going to happen when you

254
00:10:23,620 --> 00:10:25,329
implement them into ops is you're going

255
00:10:25,329 --> 00:10:26,560
to have some that are probably really

256
00:10:26,560 --> 00:10:27,939
successful and some that are really

257
00:10:27,939 --> 00:10:30,040
terrible and how do you measure that

258
00:10:30,040 --> 00:10:32,199
probably by false positives and false

259
00:10:32,199 --> 00:10:34,240
negatives right so false positives being

260
00:10:34,240 --> 00:10:36,069
very easy to identify

261
00:10:36,069 --> 00:10:38,560
you know I created this the automated

262
00:10:38,560 --> 00:10:40,709
detection technique for this new hotness

263
00:10:40,709 --> 00:10:42,730
you know technique that was just

264
00:10:42,730 --> 00:10:44,290
released a few weeks ago but then when I

265
00:10:44,290 --> 00:10:46,540
find in the process is that maybe it

266
00:10:46,540 --> 00:10:48,070
closely aligns with some kind of

267
00:10:48,070 --> 00:10:49,600
administrative action or something on my

268
00:10:49,600 --> 00:10:51,160
network to where it generates a ton of

269
00:10:51,160 --> 00:10:52,960
false positive alerts right like that

270
00:10:52,960 --> 00:10:54,670
obvious action that should be refined

271
00:10:54,670 --> 00:10:56,230
and so you should take that back to

272
00:10:56,230 --> 00:10:58,870
testing so false negatives are obviously

273
00:10:58,870 --> 00:11:00,550
way harder to identify but you will

274
00:11:00,550 --> 00:11:02,860
stumble upon in your environment where

275
00:11:02,860 --> 00:11:05,770
you know maybe you've identified an

276
00:11:05,770 --> 00:11:08,080
attack of some sort and then as you're

277
00:11:08,080 --> 00:11:09,280
kind of broadening correlating data

278
00:11:09,280 --> 00:11:11,770
about that attack you find that at one

279
00:11:11,770 --> 00:11:13,390
part you know they use that privilege

280
00:11:13,390 --> 00:11:15,190
escalation technique that you thought

281
00:11:15,190 --> 00:11:17,260
you wrote a detection for or that you

282
00:11:17,260 --> 00:11:18,850
ran that hunt for and you didn't

283
00:11:18,850 --> 00:11:20,920
identify right so why didn't you

284
00:11:20,920 --> 00:11:22,240
identify it I'll be a false negative

285
00:11:22,240 --> 00:11:24,370
something where you can again kind of go

286
00:11:24,370 --> 00:11:25,990
to that next step where you take those

287
00:11:25,990 --> 00:11:27,700
those sections and analytics that you've

288
00:11:27,700 --> 00:11:29,710
written and refine them and then

289
00:11:29,710 --> 00:11:31,270
re-implement and then as soon as you

290
00:11:31,270 --> 00:11:32,410
know if you're kind of working through

291
00:11:32,410 --> 00:11:34,420
that process of refinery implementation

292
00:11:34,420 --> 00:11:36,250
then you're going back to writing new

293
00:11:36,250 --> 00:11:38,680
detection x' and new analytics and the

294
00:11:38,680 --> 00:11:40,180
reason you always circle back around to

295
00:11:40,180 --> 00:11:41,980
writing new is because things are always

296
00:11:41,980 --> 00:11:44,320
changing right like the adversary is

297
00:11:44,320 --> 00:11:46,360
trying to stay one step ahead of you so

298
00:11:46,360 --> 00:11:48,010
the adversary as soon as you know

299
00:11:48,010 --> 00:11:49,540
there's a good set of detections out

300
00:11:49,540 --> 00:11:50,890
there for a specific technique they're

301
00:11:50,890 --> 00:11:52,480
gonna modify it just a little bit and

302
00:11:52,480 --> 00:11:54,370
again in the keynote this morning they

303
00:11:54,370 --> 00:11:55,540
talked a little bit about this right

304
00:11:55,540 --> 00:11:56,710
like all I have to do is modify

305
00:11:56,710 --> 00:11:58,540
something if you're identifying a string

306
00:11:58,540 --> 00:12:00,520
of some sort that's a pretty easy change

307
00:12:00,520 --> 00:12:01,990
for an attacker to make right so you

308
00:12:01,990 --> 00:12:02,920
have to make sure that you're going

309
00:12:02,920 --> 00:12:05,140
through those constant refinement of

310
00:12:05,140 --> 00:12:07,180
those analytics and then working them

311
00:12:07,180 --> 00:12:12,670
back into your daily workflows so who

312
00:12:12,670 --> 00:12:15,160
are these purple teamers so it's kind of

313
00:12:15,160 --> 00:12:16,990
really bringing from one of my main

314
00:12:16,990 --> 00:12:20,230
points in today's talk so currently at

315
00:12:20,230 --> 00:12:22,000
least in the organization organizations

316
00:12:22,000 --> 00:12:23,410
that I've seen and then even in the

317
00:12:23,410 --> 00:12:25,060
research that I did you know kind of

318
00:12:25,060 --> 00:12:26,940
lead enough to want to talk about this

319
00:12:26,940 --> 00:12:30,490
senior security engineers Rd guys senior

320
00:12:30,490 --> 00:12:33,370
you know Tier three analysts right what

321
00:12:33,370 --> 00:12:34,840
you're not seeing here are junior

322
00:12:34,840 --> 00:12:36,790
analysts or at least not a lot they're

323
00:12:36,790 --> 00:12:38,800
rarely involved or have a very minor

324
00:12:38,800 --> 00:12:41,350
role in purple teaming usually if any

325
00:12:41,350 --> 00:12:43,540
role at all right so what I've seen a

326
00:12:43,540 --> 00:12:46,480
lot of organizations is that tier 1 or

327
00:12:46,480 --> 00:12:48,670
tier 2 guy is maybe they're doing some

328
00:12:48,670 --> 00:12:51,370
investigating there triaging alerts but

329
00:12:51,370 --> 00:12:52,810
then when we step over and we branch

330
00:12:52,810 --> 00:12:54,790
into actually leveraging these purple

331
00:12:54,790 --> 00:12:56,710
team techniques it's a couple of the

332
00:12:56,710 --> 00:12:58,600
more skilled guys in the shop that are

333
00:12:58,600 --> 00:13:00,070
going through that process fully on

334
00:13:00,070 --> 00:13:01,120
there

335
00:13:01,120 --> 00:13:03,400
you know emulating techniques writing

336
00:13:03,400 --> 00:13:04,360
detection 'he's

337
00:13:04,360 --> 00:13:06,400
kind of working that into the daily ops

338
00:13:06,400 --> 00:13:08,500
workflow and junior analysts kind of see

339
00:13:08,500 --> 00:13:10,900
almost none of that other than a new

340
00:13:10,900 --> 00:13:13,480
detection when it pops up right but what

341
00:13:13,480 --> 00:13:15,340
that does is kind of removes the ability

342
00:13:15,340 --> 00:13:17,350
for that junior analyst to understand

343
00:13:17,350 --> 00:13:19,120
that technique as well as that senior

344
00:13:19,120 --> 00:13:20,950
analyst uh so obviously a senior analyst

345
00:13:20,950 --> 00:13:22,360
has seen more that's why they should be

346
00:13:22,360 --> 00:13:23,800
running that exercise for sure they

347
00:13:23,800 --> 00:13:25,630
should be in charge of how that's going

348
00:13:25,630 --> 00:13:28,270
right but having those junior analysts

349
00:13:28,270 --> 00:13:29,650
involved is going to drastically

350
00:13:29,650 --> 00:13:33,040
drastically increase their you know

351
00:13:33,040 --> 00:13:34,690
ability to identify these techniques in

352
00:13:34,690 --> 00:13:35,680
the wild and I'm speaking from

353
00:13:35,680 --> 00:13:39,670
experience there so how is this being

354
00:13:39,670 --> 00:13:41,530
used currently in organization so it's

355
00:13:41,530 --> 00:13:43,450
not being used by all organizations

356
00:13:43,450 --> 00:13:48,100
obviously you know it's either teams

357
00:13:48,100 --> 00:13:49,990
haven't been exposed to it enough you

358
00:13:49,990 --> 00:13:52,300
know or they don't maybe see that it has

359
00:13:52,300 --> 00:13:53,770
enough value to kind of be something

360
00:13:53,770 --> 00:13:55,350
that they work into their normal flow

361
00:13:55,350 --> 00:13:58,330
you know you feel like the red team blue

362
00:13:58,330 --> 00:14:00,370
team stuff they do or the penetration

363
00:14:00,370 --> 00:14:02,380
test they do or whatever exercise that

364
00:14:02,380 --> 00:14:04,150
they do as a team are more beneficial

365
00:14:04,150 --> 00:14:05,980
than they think purple teaming are or

366
00:14:05,980 --> 00:14:07,300
maybe you know they just under exposed

367
00:14:07,300 --> 00:14:08,950
to it not aware of really benefits it'll

368
00:14:08,950 --> 00:14:11,800
offer the two main functions that I see

369
00:14:11,800 --> 00:14:15,790
it for purple team is used is either you

370
00:14:15,790 --> 00:14:17,860
know I I just want to take my current

371
00:14:17,860 --> 00:14:21,040
toolset that I have say I have sis Mon I

372
00:14:21,040 --> 00:14:23,770
have security onion I have some tools

373
00:14:23,770 --> 00:14:25,450
you know in my environment this is what

374
00:14:25,450 --> 00:14:27,400
makes up my toolset and I just need to

375
00:14:27,400 --> 00:14:29,680
throw some techniques to see what would

376
00:14:29,680 --> 00:14:31,510
this look like in my given toolset how

377
00:14:31,510 --> 00:14:33,130
would I detect it in security I mean how

378
00:14:33,130 --> 00:14:35,950
would I detect it in you know with sis

379
00:14:35,950 --> 00:14:37,330
Mon logging or anything like that right

380
00:14:37,330 --> 00:14:40,780
so that's what it's functions that can

381
00:14:40,780 --> 00:14:42,340
be really really valuable to an analyst

382
00:14:42,340 --> 00:14:43,960
especially if an analyst is new to that

383
00:14:43,960 --> 00:14:46,270
tool set right just seeing what that

384
00:14:46,270 --> 00:14:48,610
analyst should expect to see when that

385
00:14:48,610 --> 00:14:51,040
attack maybe comes across the wire but

386
00:14:51,040 --> 00:14:53,170
more what it's used for and this is

387
00:14:53,170 --> 00:14:55,780
really the power in it is used for

388
00:14:55,780 --> 00:14:57,520
writing those advanced detection zin

389
00:14:57,520 --> 00:15:00,460
analytics so not necessarily toolset

390
00:15:00,460 --> 00:15:02,290
specific you're just trying to emulate a

391
00:15:02,290 --> 00:15:03,820
technique in a controlled environment

392
00:15:03,820 --> 00:15:05,860
where you can collect as much data as

393
00:15:05,860 --> 00:15:07,780
possible about that technique and i

394
00:15:07,780 --> 00:15:09,250
gives you the ability to write as good

395
00:15:09,250 --> 00:15:10,890
of a detection as you possibly can right

396
00:15:10,890 --> 00:15:14,270
in doing that you will likely identify

397
00:15:14,270 --> 00:15:15,770
apps and your coverage right you'll say

398
00:15:15,770 --> 00:15:17,810
like I through this technique and we saw

399
00:15:17,810 --> 00:15:19,550
one kind of minor artifact was not

400
00:15:19,550 --> 00:15:21,440
something you could accurately identify

401
00:15:21,440 --> 00:15:22,970
this with and that kind of helps you

402
00:15:22,970 --> 00:15:26,030
identify those gaps in coverage so

403
00:15:26,030 --> 00:15:27,800
that's mainly what it's used for is the

404
00:15:27,800 --> 00:15:29,690
ladder to you know help you observe

405
00:15:29,690 --> 00:15:31,550
everything as that technique comes

406
00:15:31,550 --> 00:15:34,220
across the wire right that advanced you

407
00:15:34,220 --> 00:15:39,170
know a detection or analytic so purple

408
00:15:39,170 --> 00:15:41,210
teaming is not new this has been around

409
00:15:41,210 --> 00:15:43,220
for a while so funny that he mentioned

410
00:15:43,220 --> 00:15:45,230
it this morning as obviously I didn't

411
00:15:45,230 --> 00:15:46,970
slides after this morning but Dave

412
00:15:46,970 --> 00:15:49,340
Kennedy are speak or Kino speak he

413
00:15:49,340 --> 00:15:51,410
talked about this back at Nanak on like

414
00:15:51,410 --> 00:15:53,780
2014 and during right as he's leading in

415
00:15:53,780 --> 00:15:55,220
that talk about purple teaming he's

416
00:15:55,220 --> 00:15:56,840
saying you know hey this isn't new to

417
00:15:56,840 --> 00:15:58,280
him at that time either I like he had

418
00:15:58,280 --> 00:15:59,720
heard several other people talking about

419
00:15:59,720 --> 00:16:01,850
purple teaming at the time and it just

420
00:16:01,850 --> 00:16:03,770
hasn't really caught on as far as like

421
00:16:03,770 --> 00:16:05,630
enough buy-in for people really finding

422
00:16:05,630 --> 00:16:07,700
the value in it to replace the

423
00:16:07,700 --> 00:16:09,470
traditional red versus blue and stuff

424
00:16:09,470 --> 00:16:11,080
that most organizations still go through

425
00:16:11,080 --> 00:16:13,580
and there's still a function for Everest

426
00:16:13,580 --> 00:16:14,960
blue I'm not saying that there's not I

427
00:16:14,960 --> 00:16:16,850
just feel like purple teaming has

428
00:16:16,850 --> 00:16:19,280
additional benefits and kind of some

429
00:16:19,280 --> 00:16:21,910
equivalent and some trade-offs as well

430
00:16:21,910 --> 00:16:24,350
so again this is not new some things

431
00:16:24,350 --> 00:16:26,210
have definitely changed since you know

432
00:16:26,210 --> 00:16:28,490
probably the talk back at Nanak on when

433
00:16:28,490 --> 00:16:29,600
Dave talked about her when purple

434
00:16:29,600 --> 00:16:31,790
teaming first came out one of the things

435
00:16:31,790 --> 00:16:33,110
that's changed a lot is attack

436
00:16:33,110 --> 00:16:34,460
frameworks like how much attack

437
00:16:34,460 --> 00:16:37,010
frameworks have been built up that is an

438
00:16:37,010 --> 00:16:39,200
extremely useful tool right because

439
00:16:39,200 --> 00:16:41,780
without an attack framework to utilize

440
00:16:41,780 --> 00:16:43,460
saying these are the deck these are the

441
00:16:43,460 --> 00:16:45,590
techniques that I have to identify or

442
00:16:45,590 --> 00:16:47,480
that I have to map my capabilities

443
00:16:47,480 --> 00:16:49,610
against then really all it is is a

444
00:16:49,610 --> 00:16:51,530
free-for-all of you choosing what you

445
00:16:51,530 --> 00:16:54,530
see either in you know malware research

446
00:16:54,530 --> 00:16:56,240
articles anything like that as what is

447
00:16:56,240 --> 00:16:58,250
an actual technique in the wild you

448
00:16:58,250 --> 00:16:59,660
categorizing that as what you find

449
00:16:59,660 --> 00:17:01,430
important or what not and then those

450
00:17:01,430 --> 00:17:02,630
would be the techniques that you emulate

451
00:17:02,630 --> 00:17:04,250
right but you're always gonna miss

452
00:17:04,250 --> 00:17:05,780
something there so having something like

453
00:17:05,780 --> 00:17:06,319
mitre

454
00:17:06,319 --> 00:17:08,750
we've got that complete attack matrix

455
00:17:08,750 --> 00:17:10,430
built out showing all those techniques

456
00:17:10,430 --> 00:17:12,950
really helps us map our capabilities to

457
00:17:12,950 --> 00:17:14,690
that a so like you know one-for-one

458
00:17:14,690 --> 00:17:16,119
mapping

459
00:17:16,119 --> 00:17:18,140
another thing that's really changed

460
00:17:18,140 --> 00:17:19,459
since then I think is experience

461
00:17:19,459 --> 00:17:22,520
required to kind of do the red piece of

462
00:17:22,520 --> 00:17:24,319
this right I talked about a little bit

463
00:17:24,319 --> 00:17:26,329
with the automation but I mean there's a

464
00:17:26,329 --> 00:17:27,569
difference in even

465
00:17:27,569 --> 00:17:29,190
just with one of the fully automated or

466
00:17:29,190 --> 00:17:30,600
with one of the manual tools getting

467
00:17:30,600 --> 00:17:32,639
into like a PowerShell Empire having to

468
00:17:32,639 --> 00:17:34,440
learn how to use the modules like oh I

469
00:17:34,440 --> 00:17:37,500
want to use this persistence module for

470
00:17:37,500 --> 00:17:39,990
a user land and whatever right like even

471
00:17:39,990 --> 00:17:41,759
that is a little bit you know on a new

472
00:17:41,759 --> 00:17:43,259
analyst would be kind of hard to do as

473
00:17:43,259 --> 00:17:44,820
opposed to and one of the automated

474
00:17:44,820 --> 00:17:46,470
frameworks I mentioned where you

475
00:17:46,470 --> 00:17:48,870
legitimately look at I want to run this

476
00:17:48,870 --> 00:17:51,860
technique I run you know Python

477
00:17:51,860 --> 00:17:54,929
persistence bla hit enter and that

478
00:17:54,929 --> 00:17:57,090
technique is emulated on my end point

479
00:17:57,090 --> 00:17:59,460
where I'm deployed where I have my tool

480
00:17:59,460 --> 00:18:00,659
set where I'm monitoring for those

481
00:18:00,659 --> 00:18:02,820
behaviors right it's it's gotten a lot

482
00:18:02,820 --> 00:18:04,500
easier for us to do these purple team

483
00:18:04,500 --> 00:18:06,950
activities because of that effort so

484
00:18:06,950 --> 00:18:10,019
appreciates to all the the open-source

485
00:18:10,019 --> 00:18:11,309
community out there that's put all these

486
00:18:11,309 --> 00:18:12,330
tools together because they really

487
00:18:12,330 --> 00:18:13,519
really make it a lot easier for

488
00:18:13,519 --> 00:18:15,809
especially smaller teams to go through

489
00:18:15,809 --> 00:18:18,090
purple team exercise and be able to kind

490
00:18:18,090 --> 00:18:20,039
of scale that exercise and be able to

491
00:18:20,039 --> 00:18:22,590
you know launch that many techniques to

492
00:18:22,590 --> 00:18:24,299
where it really is a benefit to them and

493
00:18:24,299 --> 00:18:25,470
not something that's to have you have a

494
00:18:25,470 --> 00:18:32,129
workload so purple teaming can do even

495
00:18:32,129 --> 00:18:37,289
more right so I've already hit on this a

496
00:18:37,289 --> 00:18:38,789
little bit but I think it has just a

497
00:18:38,789 --> 00:18:40,889
huge amount of benefit to a junior

498
00:18:40,889 --> 00:18:43,529
analyst so you could not take a junior

499
00:18:43,529 --> 00:18:45,450
analyst and say you are going to go do a

500
00:18:45,450 --> 00:18:47,100
purple teaming exercise on your own

501
00:18:47,100 --> 00:18:49,080
that's not a great idea right they may

502
00:18:49,080 --> 00:18:50,490
not know how to operate in that

503
00:18:50,490 --> 00:18:51,779
environment they may not know how to

504
00:18:51,779 --> 00:18:53,070
emulate the techniques even the

505
00:18:53,070 --> 00:18:54,929
automated tool at first they may not

506
00:18:54,929 --> 00:18:56,309
know all the data that they need to

507
00:18:56,309 --> 00:18:58,919
collect but that effort being guided by

508
00:18:58,919 --> 00:19:00,570
a senior analyst does that senior

509
00:19:00,570 --> 00:19:01,799
analyst is gonna be going through these

510
00:19:01,799 --> 00:19:04,590
purple team efforts anyway can be so so

511
00:19:04,590 --> 00:19:08,070
helpful so some obvious points and I'm

512
00:19:08,070 --> 00:19:10,110
gonna go ahead and say anyway things are

513
00:19:10,110 --> 00:19:11,940
easier to identify when you've seen them

514
00:19:11,940 --> 00:19:14,190
before right I mean that's it's one of

515
00:19:14,190 --> 00:19:15,870
those muscle memory things right like

516
00:19:15,870 --> 00:19:18,600
it's if I've seen this and I've seen all

517
00:19:18,600 --> 00:19:20,429
the artifacts that could leave behind I

518
00:19:20,429 --> 00:19:21,990
probably have a better idea of how to

519
00:19:21,990 --> 00:19:23,460
react to it what other data to collect

520
00:19:23,460 --> 00:19:26,100
and all those things so train as you

521
00:19:26,100 --> 00:19:26,460
fight

522
00:19:26,460 --> 00:19:28,169
there's a reason train as you fright

523
00:19:28,169 --> 00:19:29,789
approach you know it's been so popular

524
00:19:29,789 --> 00:19:31,409
especially in the military but for so

525
00:19:31,409 --> 00:19:33,600
long right and that's because you're

526
00:19:33,600 --> 00:19:36,450
gonna fight like you train so in that

527
00:19:36,450 --> 00:19:38,519
red versus blue cyber knife fight

528
00:19:38,519 --> 00:19:40,710
environment we're like yes we get good

529
00:19:40,710 --> 00:19:41,440
training out of

530
00:19:41,440 --> 00:19:44,230
but it's very much like not a cyber

531
00:19:44,230 --> 00:19:45,639
Knife fight that you're gonna see in the

532
00:19:45,639 --> 00:19:48,700
real world it's maybe not as helpful to

533
00:19:48,700 --> 00:19:50,710
a junior analyst as saying hey you know

534
00:19:50,710 --> 00:19:52,750
outside of like did I win did I beat

535
00:19:52,750 --> 00:19:54,669
blue team can I just say that I

536
00:19:54,669 --> 00:19:56,919
successfully identified this technique

537
00:19:56,919 --> 00:19:59,740
and when I did I understood a few things

538
00:19:59,740 --> 00:20:01,419
you know like all the peripheral

539
00:20:01,419 --> 00:20:03,039
artifacts that technique might create

540
00:20:03,039 --> 00:20:05,590
and then also what this is gonna do is

541
00:20:05,590 --> 00:20:07,659
allow those operators to understand

542
00:20:07,659 --> 00:20:10,419
better like what that is involved with a

543
00:20:10,419 --> 00:20:11,919
minor attack matrix like where is this

544
00:20:11,919 --> 00:20:13,659
ad in the kill chain where does this fit

545
00:20:13,659 --> 00:20:15,730
into an attackers like what does give an

546
00:20:15,730 --> 00:20:17,320
attacker on that environment right if

547
00:20:17,320 --> 00:20:18,639
you're going through all these exercises

548
00:20:18,639 --> 00:20:21,190
it's just enabling those junior analysts

549
00:20:21,190 --> 00:20:22,419
to understand that a little bit better

550
00:20:22,419 --> 00:20:25,360
than they are when they're just told sit

551
00:20:25,360 --> 00:20:28,269
here in triage Alerts right so even if

552
00:20:28,269 --> 00:20:30,009
it's you know just semi kind of frequent

553
00:20:30,009 --> 00:20:31,929
running them through these purple team

554
00:20:31,929 --> 00:20:33,549
just has so many additional benefits for

555
00:20:33,549 --> 00:20:36,669
junior analyst I feel like it's also

556
00:20:36,669 --> 00:20:42,009
beneficial for red team so red teamers

557
00:20:42,009 --> 00:20:43,899
usually don't like to tell blue teamers

558
00:20:43,899 --> 00:20:45,549
what they're gonna do before they do it

559
00:20:45,549 --> 00:20:48,389
it's not practice that's used very much

560
00:20:48,389 --> 00:20:50,740
but it's extremely beneficial red

561
00:20:50,740 --> 00:20:54,610
teamers as well so I've been talking

562
00:20:54,610 --> 00:20:55,840
about this from a complete blue

563
00:20:55,840 --> 00:20:57,460
perspective and a lot of this talk is on

564
00:20:57,460 --> 00:20:58,690
the blue side right like on the

565
00:20:58,690 --> 00:21:00,700
traditional defender side but it can be

566
00:21:00,700 --> 00:21:02,919
really really helpful for you know that

567
00:21:02,919 --> 00:21:04,629
attacker to see hey when I throw this

568
00:21:04,629 --> 00:21:06,700
technique it actually creates this

569
00:21:06,700 --> 00:21:08,649
artifact that I never knew it created

570
00:21:08,649 --> 00:21:10,960
before it maybe if I alter that

571
00:21:10,960 --> 00:21:12,850
technique just a little bit and I

572
00:21:12,850 --> 00:21:14,830
improve on my own techniques and it's

573
00:21:14,830 --> 00:21:17,620
gonna only challenge then blue or during

574
00:21:17,620 --> 00:21:19,269
your purple team activities for you to

575
00:21:19,269 --> 00:21:21,850
write a better detection for it right so

576
00:21:21,850 --> 00:21:23,110
and you get to see those kinds of things

577
00:21:23,110 --> 00:21:24,940
as a red teamer because of the fact that

578
00:21:24,940 --> 00:21:26,860
you're also getting to kind of peek in

579
00:21:26,860 --> 00:21:28,299
on the blue side where you usually don't

580
00:21:28,299 --> 00:21:30,340
see as much you usually hit that button

581
00:21:30,340 --> 00:21:32,019
and then you either get your call back

582
00:21:32,019 --> 00:21:33,879
or you don't I kind of figure out where

583
00:21:33,879 --> 00:21:35,529
to go from there right like did it did

584
00:21:35,529 --> 00:21:36,940
it stick against the wall or not but

585
00:21:36,940 --> 00:21:38,710
being able to actually say okay I got my

586
00:21:38,710 --> 00:21:40,960
call back but then I also see all this

587
00:21:40,960 --> 00:21:42,610
additional recorded behavior that I

588
00:21:42,610 --> 00:21:43,899
never really understood them it happen

589
00:21:43,899 --> 00:21:46,000
in the background before that can be

590
00:21:46,000 --> 00:21:48,820
huge for a red teamer so another thing

591
00:21:48,820 --> 00:21:51,429
is tools so I'm not saying don't use

592
00:21:51,429 --> 00:21:53,919
tools right like red team tools are

593
00:21:53,919 --> 00:21:55,360
amazing so they

594
00:21:55,360 --> 00:21:57,549
allow us to not have to carry such a

595
00:21:57,549 --> 00:21:59,470
heavy burden of remembering every single

596
00:21:59,470 --> 00:22:02,110
thing like and they also make it much

597
00:22:02,110 --> 00:22:04,870
much more manageable to scale a red team

598
00:22:04,870 --> 00:22:06,429
engagement right because you can manage

599
00:22:06,429 --> 00:22:08,679
host so much easier inside a red team

600
00:22:08,679 --> 00:22:10,990
tool where you can kind of collaborate

601
00:22:10,990 --> 00:22:12,820
list those hosts out see what you have

602
00:22:12,820 --> 00:22:14,200
as far as permissions on how somebody

603
00:22:14,200 --> 00:22:16,030
like they serve a good purpose but what

604
00:22:16,030 --> 00:22:19,030
tools sometimes do is force those red

605
00:22:19,030 --> 00:22:21,580
teamers into that mindset of like I just

606
00:22:21,580 --> 00:22:23,080
have to point click I guess that easy

607
00:22:23,080 --> 00:22:24,880
right like I can just put in the IP that

608
00:22:24,880 --> 00:22:26,320
I know I'm supposed to be going after

609
00:22:26,320 --> 00:22:28,270
here point-and-click instead of like

610
00:22:28,270 --> 00:22:29,830
actually fully understanding what's

611
00:22:29,830 --> 00:22:32,020
going on in the background right so

612
00:22:32,020 --> 00:22:34,299
again not saying don't use tools but

613
00:22:34,299 --> 00:22:36,190
then you know just insight like this is

614
00:22:36,190 --> 00:22:37,690
really helpful to understanding what

615
00:22:37,690 --> 00:22:40,090
those tools are doing you hit enter so

616
00:22:40,090 --> 00:22:43,030
it's also beneficial to the blue team to

617
00:22:43,030 --> 00:22:44,590
have a red team or they're you know blue

618
00:22:44,590 --> 00:22:46,840
team can do this all on their own they

619
00:22:46,840 --> 00:22:48,549
can play red as well it's gonna be

620
00:22:48,549 --> 00:22:50,290
really beneficial obviously to sit right

621
00:22:50,290 --> 00:22:52,030
next to a red team or who said no I've

622
00:22:52,030 --> 00:22:54,160
done this technique before there's a few

623
00:22:54,160 --> 00:22:55,840
different ways to do it we can try them

624
00:22:55,840 --> 00:22:58,000
all see how your detection fits against

625
00:22:58,000 --> 00:22:59,620
them all modify if we need to and then

626
00:22:59,620 --> 00:23:01,419
test again right as opposed to like as

627
00:23:01,419 --> 00:23:03,130
the blue team or I'm probably gonna say

628
00:23:03,130 --> 00:23:05,290
I'm just gonna try this one technique

629
00:23:05,290 --> 00:23:06,340
that I have right here because I know I

630
00:23:06,340 --> 00:23:08,410
can emulate it once right so just very

631
00:23:08,410 --> 00:23:10,690
very beneficial for both parties with

632
00:23:10,690 --> 00:23:15,270
red team being involved all right so

633
00:23:15,270 --> 00:23:18,549
real-world examples so one of the things

634
00:23:18,549 --> 00:23:21,070
that I would like to do I'm gonna do a

635
00:23:21,070 --> 00:23:24,100
little bit of my giveaway here but the

636
00:23:24,100 --> 00:23:26,860
kind of purpose of these is to be you

637
00:23:26,860 --> 00:23:28,510
know look at it from a junior analyst

638
00:23:28,510 --> 00:23:30,070
perspective we're gonna look at maybe I

639
00:23:30,070 --> 00:23:32,890
get an alert what data would I get with

640
00:23:32,890 --> 00:23:34,809
that alert and then what am I kind of

641
00:23:34,809 --> 00:23:37,570
missing there and how maybe I wouldn't

642
00:23:37,570 --> 00:23:38,799
be missing out on that data if I

643
00:23:38,799 --> 00:23:40,240
understand the technique I understand

644
00:23:40,240 --> 00:23:41,740
maybe this additional query I need to

645
00:23:41,740 --> 00:23:43,630
run what data I need to correlate this

646
00:23:43,630 --> 00:23:45,429
that right but we'll work through and

647
00:23:45,429 --> 00:23:46,809
I'll do some giveaways as we're going

648
00:23:46,809 --> 00:23:51,040
through these slides so right we detect

649
00:23:51,040 --> 00:23:54,760
a technique so what right I have an

650
00:23:54,760 --> 00:23:57,940
alert for UAC bypass so what does that

651
00:23:57,940 --> 00:24:00,100
mean right like I'm gonna get some kind

652
00:24:00,100 --> 00:24:02,260
of alert data for some I'm guessing

653
00:24:02,260 --> 00:24:04,990
binary that attempted or successfully

654
00:24:04,990 --> 00:24:07,260
execute a UAC bypass more than likely

655
00:24:07,260 --> 00:24:09,340
does everybody know UAC

656
00:24:09,340 --> 00:24:10,660
user account control and trying to

657
00:24:10,660 --> 00:24:13,260
bypass user account control here

658
00:24:13,260 --> 00:24:16,150
okay so alert data this is not like

659
00:24:16,150 --> 00:24:18,430
specific to a certain platform at all or

660
00:24:18,430 --> 00:24:19,840
anything this is just some generalized

661
00:24:19,840 --> 00:24:23,350
what I would get for alert data in in a

662
00:24:23,350 --> 00:24:24,850
lot of tools this is mostly what you'll

663
00:24:24,850 --> 00:24:25,930
see right you're gonna get a process

664
00:24:25,930 --> 00:24:28,300
name process path paid parent process

665
00:24:28,300 --> 00:24:30,220
name maybe some command-line arguments

666
00:24:30,220 --> 00:24:32,230
signer if you're collecting that kind of

667
00:24:32,230 --> 00:24:36,580
stuff on a binary but so what right like

668
00:24:36,580 --> 00:24:39,190
if I I'm a tier one analyst and I've not

669
00:24:39,190 --> 00:24:40,570
gotten time or I've not gotten that

670
00:24:40,570 --> 00:24:43,450
exposure to say The MITRE attack or

671
00:24:43,450 --> 00:24:44,650
really getting to dive into these

672
00:24:44,650 --> 00:24:46,690
techniques at all what does this mean to

673
00:24:46,690 --> 00:24:49,060
me I can quit Google UAC bypass like

674
00:24:49,060 --> 00:24:50,740
okay cool this is a you know it's a

675
00:24:50,740 --> 00:24:52,570
privilege escalation techniques helpful

676
00:24:52,570 --> 00:24:54,400
attackers trying to escalate privilege

677
00:24:54,400 --> 00:24:57,550
but still what now right like what is my

678
00:24:57,550 --> 00:24:59,320
next step as a junior analyst if I'm

679
00:24:59,320 --> 00:25:00,940
seeing a technique in the wild that I've

680
00:25:00,940 --> 00:25:03,130
never gotten to see before

681
00:25:03,130 --> 00:25:10,810
so is Event Viewer malicious like Event

682
00:25:10,810 --> 00:25:13,210
Viewer is built-in windows process right

683
00:25:13,210 --> 00:25:14,800
it's like so is Event Viewer malicious

684
00:25:14,800 --> 00:25:16,270
because the parent process like that's

685
00:25:16,270 --> 00:25:17,580
where that came from

686
00:25:17,580 --> 00:25:19,900
launched what looks to be me me cats as

687
00:25:19,900 --> 00:25:21,520
a junior analyst I can kind understand

688
00:25:21,520 --> 00:25:23,260
that looks like me me cats to me

689
00:25:23,260 --> 00:25:24,790
does that make Event Viewer let's just

690
00:25:24,790 --> 00:25:28,030
know so can anyone tell me what the

691
00:25:28,030 --> 00:25:29,860
technique ID is the mitre attack

692
00:25:29,860 --> 00:25:35,620
technique ID or you a bypass for hold on

693
00:25:35,620 --> 00:25:42,790
this is for a wireless adapter Google is

694
00:25:42,790 --> 00:25:44,830
fine you can google it I got a few

695
00:25:44,830 --> 00:25:46,330
things to give away so I'm asking a few

696
00:25:46,330 --> 00:25:47,950
questions so you know what tell me what

697
00:25:47,950 --> 00:25:50,320
the mitre attack technique ID is for a

698
00:25:50,320 --> 00:25:59,920
UAC bypass stop with the t34 numbers yep

699
00:25:59,920 --> 00:26:04,270
one zero eight eight all right thank you

700
00:26:04,270 --> 00:26:08,740
very much perfect hey Google's our

701
00:26:08,740 --> 00:26:09,970
friend right I mean I wouldn't expect

702
00:26:09,970 --> 00:26:12,190
anyone to I have fully memorized the

703
00:26:12,190 --> 00:26:13,690
attack matrix I'm sure somebody has done

704
00:26:13,690 --> 00:26:18,340
it I have not okay so mitre attack

705
00:26:18,340 --> 00:26:21,310
technique 1088 can anyone tell me is

706
00:26:21,310 --> 00:26:22,840
anyone familiar with that technique like

707
00:26:22,840 --> 00:26:23,080
an

708
00:26:23,080 --> 00:26:26,620
show hands maybe okay so if I'm emulator

709
00:26:26,620 --> 00:26:28,269
that attack technique or if I'm actually

710
00:26:28,269 --> 00:26:30,159
executing the technique in the wild can

711
00:26:30,159 --> 00:26:31,539
you want to tell me what has to be done

712
00:26:31,539 --> 00:26:35,049
before spawning event viewer that's

713
00:26:35,049 --> 00:26:37,929
going to actually allow you to elevate

714
00:26:37,929 --> 00:26:42,909
privileges and bypass UAC guesses are

715
00:26:42,909 --> 00:26:45,330
fine too

716
00:26:45,480 --> 00:26:51,100
nope not run DLL so it's gonna be the

717
00:26:51,100 --> 00:26:54,370
addition or modification of something on

718
00:26:54,370 --> 00:27:05,340
the endpoint modification of the windows

719
00:27:05,370 --> 00:27:09,220
know starts with an R registry all right

720
00:27:09,220 --> 00:27:18,010
yeah so exactly right so it's

721
00:27:18,010 --> 00:27:20,760
modification in the Windows registry so

722
00:27:20,760 --> 00:27:23,529
it's actually specifically gonna be a

723
00:27:23,529 --> 00:27:26,850
modification to a registry key a

724
00:27:26,850 --> 00:27:29,220
modification to the registry key

725
00:27:29,220 --> 00:27:31,539
containing that MSC file shell open

726
00:27:31,539 --> 00:27:33,340
command so can be HQ current user it

727
00:27:33,340 --> 00:27:34,539
could be a couple different hives right

728
00:27:34,539 --> 00:27:37,299
but so essentially you can actually

729
00:27:37,299 --> 00:27:39,250
write looking for the modification of

730
00:27:39,250 --> 00:27:43,059
this registry key for containing the MSC

731
00:27:43,059 --> 00:27:45,130
file shell open command and you can

732
00:27:45,130 --> 00:27:47,679
actually see if we're collecting like

733
00:27:47,679 --> 00:27:49,210
just this my I'm collecting registry

734
00:27:49,210 --> 00:27:50,919
events right you can actually see now

735
00:27:50,919 --> 00:27:53,500
this registry event that exists and you

736
00:27:53,500 --> 00:27:54,909
can see process name looks like it's

737
00:27:54,909 --> 00:27:58,210
modified by PowerShell some kind of you

738
00:27:58,210 --> 00:28:00,330
know encoded command off PowerShell

739
00:28:00,330 --> 00:28:03,190
actually had made that registry

740
00:28:03,190 --> 00:28:07,120
modification right so without going

741
00:28:07,120 --> 00:28:09,370
through this specific and I'm putting

742
00:28:09,370 --> 00:28:10,809
you guys on the spot cuz obviously you

743
00:28:10,809 --> 00:28:12,039
guys didn't go through this exact

744
00:28:12,039 --> 00:28:13,450
technique yesterday if you've purple

745
00:28:13,450 --> 00:28:15,730
team did at all but without going

746
00:28:15,730 --> 00:28:17,470
through that purple team activity

747
00:28:17,470 --> 00:28:19,419
looking for this technique right like

748
00:28:19,419 --> 00:28:21,940
how would I know that how would I so you

749
00:28:21,940 --> 00:28:24,730
know if I see that alert do I think you

750
00:28:24,730 --> 00:28:26,529
know do I do process lineage on Event

751
00:28:26,529 --> 00:28:27,789
Viewer because it can come from

752
00:28:27,789 --> 00:28:29,679
something other than the process that

753
00:28:29,679 --> 00:28:31,120
actually detonated Event Viewer that

754
00:28:31,120 --> 00:28:32,799
does not matter at all

755
00:28:32,799 --> 00:28:34,210
you know the registry key could be added

756
00:28:34,210 --> 00:28:35,679
by a completely different parent process

757
00:28:35,679 --> 00:28:36,760
then calls

758
00:28:36,760 --> 00:28:39,100
Event Viewer and spawn this technique so

759
00:28:39,100 --> 00:28:40,840
you know without knowing that okay

760
00:28:40,840 --> 00:28:42,370
welcome to confirm this I should

761
00:28:42,370 --> 00:28:45,700
probably go see what file modified that

762
00:28:45,700 --> 00:28:48,430
registry key right and in doing so

763
00:28:48,430 --> 00:28:49,660
you'll be able to find out okay it's

764
00:28:49,660 --> 00:28:51,220
PowerShell so that gives you as an

765
00:28:51,220 --> 00:28:53,470
analyst a little bit better ability to

766
00:28:53,470 --> 00:28:56,770
go in and triage this alert hopefully

767
00:28:56,770 --> 00:28:58,120
this makes it sense several I'll give

768
00:28:58,120 --> 00:29:02,080
you another example here so I'm gonna

769
00:29:02,080 --> 00:29:03,760
have another alert right so I have an

770
00:29:03,760 --> 00:29:06,310
alert for regice PR thirty-two scriptlet

771
00:29:06,310 --> 00:29:10,210
execution so squid we do hopefully all

772
00:29:10,210 --> 00:29:12,790
familiar this is the fun one by Casey

773
00:29:12,790 --> 00:29:18,270
Smith or sub T with this example so

774
00:29:20,490 --> 00:29:22,630
alright again we're gonna get alert data

775
00:29:22,630 --> 00:29:24,820
so I'm gonna get processed name paid

776
00:29:24,820 --> 00:29:28,540
path command line I can write a

777
00:29:28,540 --> 00:29:31,150
detection purely basically off of this

778
00:29:31,150 --> 00:29:32,830
command line even though you have to

779
00:29:32,830 --> 00:29:34,210
worry about some string variables stuff

780
00:29:34,210 --> 00:29:37,210
that can change but so can anyone tell

781
00:29:37,210 --> 00:29:41,860
me the mitre attack technique D for red

782
00:29:41,860 --> 00:29:45,040
serve 32 for the practical packet

783
00:29:45,040 --> 00:29:47,590
analysis sorry hold on you said it first

784
00:29:47,590 --> 00:29:52,110
right yep

785
00:29:52,200 --> 00:29:55,930
here can you I'm gonna that's a so it's

786
00:29:55,930 --> 00:29:56,680
a long walk

787
00:29:56,680 --> 00:30:02,020
thanks alright so yes it's t1 107 all

788
00:30:02,020 --> 00:30:05,770
right now more advanced hopefully you're

789
00:30:05,770 --> 00:30:07,570
all on the miter attack matrix page for

790
00:30:07,570 --> 00:30:09,130
the technique ID and ready to help me

791
00:30:09,130 --> 00:30:10,330
answer this next question right now

792
00:30:10,330 --> 00:30:11,890
right like we're all there ok perfect

793
00:30:11,890 --> 00:30:13,660
we're purple teaming together okay

794
00:30:13,660 --> 00:30:18,100
kind of so what you know so what this

795
00:30:18,100 --> 00:30:19,750
technique is essentially doing is

796
00:30:19,750 --> 00:30:22,270
register 32 is loading this thing object

797
00:30:22,270 --> 00:30:24,400
DLL and allowing to execute that column

798
00:30:24,400 --> 00:30:26,020
script which is essentially just an XML

799
00:30:26,020 --> 00:30:29,080
file so whatever code is being executed

800
00:30:29,080 --> 00:30:32,200
actually lives in that file can anyone

801
00:30:32,200 --> 00:30:34,930
tell me the file path where I could go

802
00:30:34,930 --> 00:30:37,210
grab that within a short time frame and

803
00:30:37,210 --> 00:30:40,230
if after this alert

804
00:30:44,050 --> 00:30:47,470
temporary ernet files perfect exactly so

805
00:30:47,470 --> 00:30:50,680
same thing you would see if you actually

806
00:30:50,680 --> 00:30:54,400
had you know internet explorer open and

807
00:30:54,400 --> 00:30:56,080
you clicked on a binary and instead of

808
00:30:56,080 --> 00:30:59,110
clicking save you click run and that

809
00:30:59,110 --> 00:31:01,450
file has obviously temporarily saved to

810
00:31:01,450 --> 00:31:03,280
a location so that it can be executed

811
00:31:03,280 --> 00:31:04,690
right so same thing you'll actually see

812
00:31:04,690 --> 00:31:09,370
it saved in temporary internet files so

813
00:31:09,370 --> 00:31:11,550
right what else what else do we need I

814
00:31:11,550 --> 00:31:14,470
need that file probably because of the

815
00:31:14,470 --> 00:31:16,690
fact that this technique can be you know

816
00:31:16,690 --> 00:31:19,390
like utilize to write code into memory

817
00:31:19,390 --> 00:31:22,240
so if I don't have anything after this

818
00:31:22,240 --> 00:31:24,250
point that's actually on disk as that I

819
00:31:24,250 --> 00:31:25,870
can help either confirm or deny like

820
00:31:25,870 --> 00:31:28,480
what happened next you know how do I

821
00:31:28,480 --> 00:31:30,370
confirm this was malicious where do I

822
00:31:30,370 --> 00:31:33,160
see that code at you could go grab the

823
00:31:33,160 --> 00:31:33,940
file right here

824
00:31:33,940 --> 00:31:37,120
so a quick file search or if you're

825
00:31:37,120 --> 00:31:39,550
collect final events right being able to

826
00:31:39,550 --> 00:31:41,470
search for that file by file name and

827
00:31:41,470 --> 00:31:42,700
knowing that it's in the past for

828
00:31:42,700 --> 00:31:44,170
temporary internet files you don't need

829
00:31:44,170 --> 00:31:45,730
to know user specific or anything like

830
00:31:45,730 --> 00:31:47,650
that you can quickly pull that data back

831
00:31:47,650 --> 00:31:49,120
you probably likely carved it out in

832
00:31:49,120 --> 00:31:50,350
Breaux logs or something if you're

833
00:31:50,350 --> 00:31:53,950
collecting these type files so again I

834
00:31:53,950 --> 00:31:56,820
can take that and I could actually see

835
00:31:56,820 --> 00:31:59,800
OCO so this is a small section of what

836
00:31:59,800 --> 00:32:01,210
that code would look like right but then

837
00:32:01,210 --> 00:32:02,890
I can say okay well it actually did

838
00:32:02,890 --> 00:32:05,560
execute power shell temporarily I can go

839
00:32:05,560 --> 00:32:07,060
back and maybe look for this event maybe

840
00:32:07,060 --> 00:32:08,620
this event didn't alert but I can go

841
00:32:08,620 --> 00:32:11,440
back do lineage now this event kind of

842
00:32:11,440 --> 00:32:12,880
looked for what came before what came

843
00:32:12,880 --> 00:32:15,610
after so without again seeing that

844
00:32:15,610 --> 00:32:17,590
technique and seeing like all of its

845
00:32:17,590 --> 00:32:19,360
behaviors knowing the files that it

846
00:32:19,360 --> 00:32:21,340
drops or the example before the registry

847
00:32:21,340 --> 00:32:23,560
key that it creates it's kind of hard

848
00:32:23,560 --> 00:32:25,480
really hard for a junior analyst to know

849
00:32:25,480 --> 00:32:28,090
what do I do next when I get this alert

850
00:32:28,090 --> 00:32:30,220
right and so purple teaming can really

851
00:32:30,220 --> 00:32:31,900
really really drastically help them in

852
00:32:31,900 --> 00:32:33,280
understanding some of these things so

853
00:32:33,280 --> 00:32:35,710
again it's not going to be like I know

854
00:32:35,710 --> 00:32:37,990
everything because I fully executed

855
00:32:37,990 --> 00:32:39,490
purple team against a minor attack

856
00:32:39,490 --> 00:32:41,950
matrix but it does give you kind of that

857
00:32:41,950 --> 00:32:44,020
muscle memory in responding or reacting

858
00:32:44,020 --> 00:32:46,240
to some of these techniques when you

859
00:32:46,240 --> 00:32:51,670
actually see them in the wild so what

860
00:32:51,670 --> 00:32:53,650
can we and I say we as a community what

861
00:32:53,650 --> 00:32:55,720
can we do differently right so involve

862
00:32:55,720 --> 00:32:57,309
analysts of all levels

863
00:32:57,309 --> 00:32:59,919
you know pros to this obviously or that

864
00:32:59,919 --> 00:33:01,539
again I've mentioned muscle memory a few

865
00:33:01,539 --> 00:33:03,700
times but that reaction time for an

866
00:33:03,700 --> 00:33:05,559
analyst and the ability to either know

867
00:33:05,559 --> 00:33:07,899
what to do next or even be able to

868
00:33:07,899 --> 00:33:09,340
respond to this if it's something you

869
00:33:09,340 --> 00:33:10,690
need to take you know a meeting

870
00:33:10,690 --> 00:33:12,429
remediation actions on right away is

871
00:33:12,429 --> 00:33:14,080
going to be much better the second or

872
00:33:14,080 --> 00:33:15,549
third time than it was the first time

873
00:33:15,549 --> 00:33:19,570
right so you know help your analysts and

874
00:33:19,570 --> 00:33:21,759
understanding what data do I need to

875
00:33:21,759 --> 00:33:23,470
correlate right like I said before what

876
00:33:23,470 --> 00:33:25,960
registry key was dropped or modified or

877
00:33:25,960 --> 00:33:28,509
what file was created or you know what

878
00:33:28,509 --> 00:33:30,309
user logon event would have had to take

879
00:33:30,309 --> 00:33:33,039
place prior to this happening so then

880
00:33:33,039 --> 00:33:34,779
cons you know and talking about this

881
00:33:34,779 --> 00:33:36,399
with a few fellow analysts some analysts

882
00:33:36,399 --> 00:33:38,830
that are much senior to yours truly I

883
00:33:38,830 --> 00:33:42,009
kind of got the everything I'm talking

884
00:33:42,009 --> 00:33:43,480
about here with muscle memory and all

885
00:33:43,480 --> 00:33:45,039
that stuff it's kind of saving time

886
00:33:45,039 --> 00:33:47,259
right in the long run you know the time

887
00:33:47,259 --> 00:33:48,879
that it takes for your analyst to react

888
00:33:48,879 --> 00:33:50,440
to a technique the time that it takes

889
00:33:50,440 --> 00:33:52,389
you to do this or that and then the

890
00:33:52,389 --> 00:33:54,070
callin loops brought up was you know

891
00:33:54,070 --> 00:33:57,279
okay the time that your senior analysts

892
00:33:57,279 --> 00:33:59,169
are then having to invest in you know

893
00:33:59,169 --> 00:34:00,999
facilitating these exercises with junior

894
00:34:00,999 --> 00:34:03,009
analysts that they might be losing to

895
00:34:03,009 --> 00:34:05,019
time that's spent writing detection

896
00:34:05,019 --> 00:34:06,100
techniques on their own right like

897
00:34:06,100 --> 00:34:07,629
they're the experienced ones they're the

898
00:34:07,629 --> 00:34:09,429
ones that could very likely just do this

899
00:34:09,429 --> 00:34:11,379
on without involving junior analysts at

900
00:34:11,379 --> 00:34:14,079
all I would my argument to that would be

901
00:34:14,079 --> 00:34:16,359
you're probably right in the beginning

902
00:34:16,359 --> 00:34:17,829
you're gonna lose a little bit of time

903
00:34:17,829 --> 00:34:18,969
as a senior analyst and maybe the

904
00:34:18,969 --> 00:34:20,739
frequency that you're able to you know

905
00:34:20,739 --> 00:34:22,989
like maybe emulate some techniques in a

906
00:34:22,989 --> 00:34:25,359
given purple teaming activity but over

907
00:34:25,359 --> 00:34:26,949
time all you're doing is building more

908
00:34:26,949 --> 00:34:28,960
purple team alright so over time you

909
00:34:28,960 --> 00:34:31,000
will catch up that speed and probably

910
00:34:31,000 --> 00:34:32,440
eventually surpass it because you've

911
00:34:32,440 --> 00:34:34,960
created a much larger purple team right

912
00:34:34,960 --> 00:34:36,819
that has the ability to do this and

913
00:34:36,819 --> 00:34:38,139
maybe they are working on refining

914
00:34:38,139 --> 00:34:40,869
tactics and not always doing it on

915
00:34:40,869 --> 00:34:43,719
creating new but at the same time more

916
00:34:43,719 --> 00:34:45,010
people the quicker that's gonna go as

917
00:34:45,010 --> 00:34:49,869
well so I really think you can utilize

918
00:34:49,869 --> 00:34:51,579
purple team II to elevate your analyst

919
00:34:51,579 --> 00:34:53,050
right part of my time on my talk I think

920
00:34:53,050 --> 00:34:55,480
that you know it can you have to help

921
00:34:55,480 --> 00:34:57,190
your analyst grow right like you have to

922
00:34:57,190 --> 00:35:00,730
facilitate an environment where you

923
00:35:00,730 --> 00:35:02,530
allow them to engage in these activities

924
00:35:02,530 --> 00:35:04,990
and kind of alleviate that so what or

925
00:35:04,990 --> 00:35:06,940
you know that that mindset right of an

926
00:35:06,940 --> 00:35:08,710
analyst like I see this in training all

927
00:35:08,710 --> 00:35:10,690
the time I said well I enjoyed myself I

928
00:35:10,690 --> 00:35:11,270
do a

929
00:35:11,270 --> 00:35:12,920
of training and so that's one of the

930
00:35:12,920 --> 00:35:16,040
major things that I see is uh you know I

931
00:35:16,040 --> 00:35:18,110
teach someone how to see something you

932
00:35:18,110 --> 00:35:20,000
know specific to our product or not and

933
00:35:20,000 --> 00:35:22,010
the next thing I get is why do I care

934
00:35:22,010 --> 00:35:23,510
right and so you can kind of alleviate

935
00:35:23,510 --> 00:35:25,640
that by giving them the background on

936
00:35:25,640 --> 00:35:26,810
the technique that you're trying to

937
00:35:26,810 --> 00:35:29,300
teach them to identify in the wild so

938
00:35:29,300 --> 00:35:31,370
you can elevate your workforce right

939
00:35:31,370 --> 00:35:32,660
you're gonna give them that tools and

940
00:35:32,660 --> 00:35:34,430
experience by including them in this and

941
00:35:34,430 --> 00:35:36,080
then you know you're just essentially

942
00:35:36,080 --> 00:35:37,520
get them to look beyond the alert give

943
00:35:37,520 --> 00:35:39,200
them the ability to know you know what's

944
00:35:39,200 --> 00:35:40,820
my next step what do I do to correlate

945
00:35:40,820 --> 00:35:42,500
data what's you know what do I do to

946
00:35:42,500 --> 00:35:44,260
triage

947
00:35:44,260 --> 00:35:47,450
so we can also do more feel like in the

948
00:35:47,450 --> 00:35:50,270
daily operations that purple teaming can

949
00:35:50,270 --> 00:35:53,870
help us with daily ops you know testing

950
00:35:53,870 --> 00:35:55,970
these techniques I said this a little

951
00:35:55,970 --> 00:35:57,560
bit earlier you're gonna identify either

952
00:35:57,560 --> 00:35:59,990
holes that you have in coverage or you

953
00:35:59,990 --> 00:36:01,970
might also identify things that you can

954
00:36:01,970 --> 00:36:03,830
you know fully automate or things that

955
00:36:03,830 --> 00:36:05,300
are harder for you to catch but you can

956
00:36:05,300 --> 00:36:07,640
do them and hunting you know and that

957
00:36:07,640 --> 00:36:09,230
can help you build what is known as a

958
00:36:09,230 --> 00:36:12,080
heat map which in turn can help you

959
00:36:12,080 --> 00:36:18,620
build your PlayBook so in building your

960
00:36:18,620 --> 00:36:21,860
own playbook you know emulation of these

961
00:36:21,860 --> 00:36:23,480
techniques can help you build that heat

962
00:36:23,480 --> 00:36:25,580
map and I'm just piggybacking off a

963
00:36:25,580 --> 00:36:27,380
Roberto Rodriguez I don't know if you

964
00:36:27,380 --> 00:36:28,730
guys have read if you've not read how

965
00:36:28,730 --> 00:36:31,940
hot hunt team great article about Mac

966
00:36:31,940 --> 00:36:34,010
mapping your hunt team's capabilities to

967
00:36:34,010 --> 00:36:37,100
a framework such as mitre right so we

968
00:36:37,100 --> 00:36:38,810
can do the same kind of thing here and

969
00:36:38,810 --> 00:36:40,550
and I you know a little bit different

970
00:36:40,550 --> 00:36:43,340
than then Roberto when he talks about it

971
00:36:43,340 --> 00:36:45,680
but you know I'm primarily focusing on

972
00:36:45,680 --> 00:36:47,720
when I write a detection or an analytic

973
00:36:47,720 --> 00:36:49,760
do I have something that's fully

974
00:36:49,760 --> 00:36:52,070
automated as in it's gonna alert when it

975
00:36:52,070 --> 00:36:53,960
alerts I can take the response action on

976
00:36:53,960 --> 00:36:56,900
that alert or don't have something that

977
00:36:56,900 --> 00:36:57,950
maybe has a little bit of alert

978
00:36:57,950 --> 00:36:59,690
functionality but maybe we're missing

979
00:36:59,690 --> 00:37:01,610
some data to always know I have a true

980
00:37:01,610 --> 00:37:04,550
positive there do I have no detection

981
00:37:04,550 --> 00:37:06,350
functionality at all but I do collect

982
00:37:06,350 --> 00:37:07,820
enough data to where I can hunt for it

983
00:37:07,820 --> 00:37:09,640
so a lot of times this might be the case

984
00:37:09,640 --> 00:37:12,560
with things you might try and create a

985
00:37:12,560 --> 00:37:13,730
section for and they have a false

986
00:37:13,730 --> 00:37:15,560
positive like the data is there but the

987
00:37:15,560 --> 00:37:17,240
detection you write has too high of a

988
00:37:17,240 --> 00:37:19,160
false positive rate you may just have to

989
00:37:19,160 --> 00:37:21,260
do that as a proactive search and then

990
00:37:21,260 --> 00:37:23,060
either you know maybe partial data or

991
00:37:23,060 --> 00:37:24,620
you know like I think I can identify

992
00:37:24,620 --> 00:37:25,160
that

993
00:37:25,160 --> 00:37:26,390
technique but I really may not have

994
00:37:26,390 --> 00:37:28,910
enough data in general to fully

995
00:37:28,910 --> 00:37:30,380
guarantee that that's what you're seeing

996
00:37:30,380 --> 00:37:33,049
when you see it or just I don't have

997
00:37:33,049 --> 00:37:34,910
enough data you know I don't have a tool

998
00:37:34,910 --> 00:37:36,859
that even fits that mold or this

999
00:37:36,859 --> 00:37:38,059
technique of what we're trying to

1000
00:37:38,059 --> 00:37:40,720
identify wouldn't have that capability

1001
00:37:40,720 --> 00:37:43,130
so when you map those out now this is

1002
00:37:43,130 --> 00:37:45,200
just a random example of like what that

1003
00:37:45,200 --> 00:37:46,670
could look like on the miter attack

1004
00:37:46,670 --> 00:37:48,079
matrix

1005
00:37:48,079 --> 00:37:49,579
you know you've mapped those say okay

1006
00:37:49,579 --> 00:37:51,410
for these techniques I can actually I

1007
00:37:51,410 --> 00:37:53,089
have a fully automated detection in

1008
00:37:53,089 --> 00:37:55,970
which I can rely on an alert to you know

1009
00:37:55,970 --> 00:37:57,200
tell me if this is happening in my

1010
00:37:57,200 --> 00:37:59,390
environment versus you know what's more

1011
00:37:59,390 --> 00:38:01,309
manual or what am what am I not able to

1012
00:38:01,309 --> 00:38:02,720
do at all in my environment and it's

1013
00:38:02,720 --> 00:38:04,400
very very important to understand where

1014
00:38:04,400 --> 00:38:09,140
those gaps are so identifying strengths

1015
00:38:09,140 --> 00:38:10,940
and weaknesses you know it's going to

1016
00:38:10,940 --> 00:38:13,549
help you build that ops playbook so Ops

1017
00:38:13,549 --> 00:38:15,829
can't be like telling your analyst just

1018
00:38:15,829 --> 00:38:17,270
to go find what's bad on the network

1019
00:38:17,270 --> 00:38:19,460
right there should be a given set of you

1020
00:38:19,460 --> 00:38:21,470
know of instructions or you know like

1021
00:38:21,470 --> 00:38:23,359
tasks that an analyst at each level has

1022
00:38:23,359 --> 00:38:24,890
to complete each day whether that's

1023
00:38:24,890 --> 00:38:27,559
triaging alerts or hunting for something

1024
00:38:27,559 --> 00:38:30,410
or you know like collecting more data so

1025
00:38:30,410 --> 00:38:31,520
that you can dig through it and a lot

1026
00:38:31,520 --> 00:38:34,609
later on those tasks can essentially be

1027
00:38:34,609 --> 00:38:36,920
mapped out to identify they like review

1028
00:38:36,920 --> 00:38:39,079
and triage automated detection some four

1029
00:38:39,079 --> 00:38:40,640
techniques figure out a way to collect

1030
00:38:40,640 --> 00:38:43,880
that additional data so for these first

1031
00:38:43,880 --> 00:38:46,670
two specifically there should be

1032
00:38:46,670 --> 00:38:49,609
prioritization of efforts right so when

1033
00:38:49,609 --> 00:38:51,140
you're looking at alerts that I'm

1034
00:38:51,140 --> 00:38:54,529
triaging or you know techniques that I'm

1035
00:38:54,529 --> 00:38:56,809
hunting for efforts should be

1036
00:38:56,809 --> 00:38:59,569
prioritized so different techniques have

1037
00:38:59,569 --> 00:39:01,190
different severa tees have different

1038
00:39:01,190 --> 00:39:02,900
rights so it might be where an attacker

1039
00:39:02,900 --> 00:39:06,260
is at in the you know attack lifecycle

1040
00:39:06,260 --> 00:39:09,020
maybe it's more severe to me if an

1041
00:39:09,020 --> 00:39:11,569
attacker is closer to exfil than it is

1042
00:39:11,569 --> 00:39:13,279
if it's like the first execution event

1043
00:39:13,279 --> 00:39:15,440
I've seen because it's several actions

1044
00:39:15,440 --> 00:39:17,270
on objectives deep at that point right

1045
00:39:17,270 --> 00:39:22,880
or maybe it's more you know more severe

1046
00:39:22,880 --> 00:39:25,539
to me sorry if you know if it's a

1047
00:39:25,539 --> 00:39:27,589
execution of it that it is a discovery

1048
00:39:27,589 --> 00:39:29,839
because I know execution means hey

1049
00:39:29,839 --> 00:39:31,640
probably pretty close to initial access

1050
00:39:31,640 --> 00:39:33,470
malicious code getting executed in some

1051
00:39:33,470 --> 00:39:35,450
way shape or form on my box

1052
00:39:35,450 --> 00:39:37,250
whereas discovery means you know that

1053
00:39:37,250 --> 00:39:38,270
attacker is basically doing some

1054
00:39:38,270 --> 00:39:38,900
situation

1055
00:39:38,900 --> 00:39:42,260
awareness you know maybe trying to move

1056
00:39:42,260 --> 00:39:43,339
laterally or trying to discover

1057
00:39:43,339 --> 00:39:45,440
resources they have access to right but

1058
00:39:45,440 --> 00:39:47,059
either way like this is determination

1059
00:39:47,059 --> 00:39:48,410
that's made up of what's important on

1060
00:39:48,410 --> 00:39:50,240
your team and how you categorize that

1061
00:39:50,240 --> 00:39:52,460
but it's taking what's important for you

1062
00:39:52,460 --> 00:39:55,099
as techniques to identify correlating

1063
00:39:55,099 --> 00:39:56,599
that with what you do well what you

1064
00:39:56,599 --> 00:39:58,220
don't do well and that should help you

1065
00:39:58,220 --> 00:39:59,869
build your priority list right so if

1066
00:39:59,869 --> 00:40:01,430
there's some people it's very important

1067
00:40:01,430 --> 00:40:03,500
to me and it's something that I have to

1068
00:40:03,500 --> 00:40:05,390
do manually that manual piece should be

1069
00:40:05,390 --> 00:40:07,099
built into one of your higher tiered

1070
00:40:07,099 --> 00:40:09,160
analysts playbook every single day right

1071
00:40:09,160 --> 00:40:11,180
give you that you know like utmost

1072
00:40:11,180 --> 00:40:12,740
confidence and identifying those

1073
00:40:12,740 --> 00:40:17,720
techniques so let's so in a you know an

1074
00:40:17,720 --> 00:40:19,970
ideal world where I have a strongly

1075
00:40:19,970 --> 00:40:22,039
enough man's team that I can you know

1076
00:40:22,039 --> 00:40:23,839
say I could treat every technique as

1077
00:40:23,839 --> 00:40:25,640
equal you make that prioritization on

1078
00:40:25,640 --> 00:40:29,089
your own in less mature socks or teams

1079
00:40:29,089 --> 00:40:30,650
you might actually need the ability to

1080
00:40:30,650 --> 00:40:33,770
have that driven by intelligence and so

1081
00:40:33,770 --> 00:40:35,750
when I say that I'll bring up the car

1082
00:40:35,750 --> 00:40:37,880
which is the cyber analytics report

1083
00:40:37,880 --> 00:40:40,880
oh sorry repository exploration tool so

1084
00:40:40,880 --> 00:40:43,130
I'm just as an example here you know I

1085
00:40:43,130 --> 00:40:45,589
can use this to kind of map out let's

1086
00:40:45,589 --> 00:40:49,940
say I'm a financial institution and I

1087
00:40:49,940 --> 00:40:52,220
want to look at threats like Lazarus

1088
00:40:52,220 --> 00:40:54,109
group which mainly targets financial

1089
00:40:54,109 --> 00:40:56,000
institutions and what that'll do is

1090
00:40:56,000 --> 00:40:58,549
actually map out ok these are the main

1091
00:40:58,549 --> 00:41:00,319
techniques used by that adversary and

1092
00:41:00,319 --> 00:41:01,369
there's more than one that you would

1093
00:41:01,369 --> 00:41:03,319
have to do this for but just saying you

1094
00:41:03,319 --> 00:41:05,270
can use you know especially for

1095
00:41:05,270 --> 00:41:06,770
undermanned team where you kind of it's

1096
00:41:06,770 --> 00:41:08,299
hard to treat every technique as equal

1097
00:41:08,299 --> 00:41:10,700
you can use this kind of intelligence

1098
00:41:10,700 --> 00:41:13,849
driven data to help you prioritize what

1099
00:41:13,849 --> 00:41:15,470
you should behave you know as important

1100
00:41:15,470 --> 00:41:18,578
in your environment right

1101
00:41:23,170 --> 00:41:27,070
so you know I think that everyone here

1102
00:41:27,070 --> 00:41:28,780
could benefit from either you know

1103
00:41:28,780 --> 00:41:30,670
purple teaming or maybe taking purple

1104
00:41:30,670 --> 00:41:32,980
teaming efforts that you're doing and

1105
00:41:32,980 --> 00:41:35,140
you know involving those junior analysts

1106
00:41:35,140 --> 00:41:38,500
so having that cyclical process like I

1107
00:41:38,500 --> 00:41:40,000
talked about earlier to make sure that

1108
00:41:40,000 --> 00:41:41,470
you know you keep pace with your

1109
00:41:41,470 --> 00:41:43,750
adversary your adversary is always

1110
00:41:43,750 --> 00:41:46,000
always advancing their TTP's they may

1111
00:41:46,000 --> 00:41:47,650
not always use advance TTP's if you

1112
00:41:47,650 --> 00:41:49,720
don't force them to if you have you know

1113
00:41:49,720 --> 00:41:51,370
like SMB open to the Internet that's

1114
00:41:51,370 --> 00:41:53,830
pretty easy for an adversary but as you

1115
00:41:53,830 --> 00:41:55,990
force adversaries to use more advanced

1116
00:41:55,990 --> 00:41:58,930
techniques they will create new ways to

1117
00:41:58,930 --> 00:42:00,070
get into your environment and move

1118
00:42:00,070 --> 00:42:01,960
laterally in your environment to exfil

1119
00:42:01,960 --> 00:42:03,280
from your environment or whatever that

1120
00:42:03,280 --> 00:42:04,330
is right

1121
00:42:04,330 --> 00:42:07,150
and so having that like process of going

1122
00:42:07,150 --> 00:42:08,920
back through reiterating through new

1123
00:42:08,920 --> 00:42:10,630
techniques writing new detection make

1124
00:42:10,630 --> 00:42:12,700
sure that you're keeping pace and mitre

1125
00:42:12,700 --> 00:42:14,620
does a great job of keeping that updated

1126
00:42:14,620 --> 00:42:15,970
and the community is really great

1127
00:42:15,970 --> 00:42:18,010
especially all the security researchers

1128
00:42:18,010 --> 00:42:20,320
in this community about you know sharing

1129
00:42:20,320 --> 00:42:21,850
that stuff is a good squiggly-doo is a

1130
00:42:21,850 --> 00:42:23,950
good example the register of 32 attack I

1131
00:42:23,950 --> 00:42:27,280
showed where you know subti hey I found

1132
00:42:27,280 --> 00:42:28,990
this you know is what you're able to do

1133
00:42:28,990 --> 00:42:31,660
with it and then not very long after apt

1134
00:42:31,660 --> 00:42:34,360
32 being using it in real world attacks

1135
00:42:34,360 --> 00:42:36,910
like all over so really really good

1136
00:42:36,910 --> 00:42:38,830
useful of you know making sure they

1137
00:42:38,830 --> 00:42:40,300
keeping up with those techniques as they

1138
00:42:40,300 --> 00:42:43,870
get added so you know through utilizing

1139
00:42:43,870 --> 00:42:45,580
purple team your teams are gonna get a

1140
00:42:45,580 --> 00:42:47,380
you know your personnel your analysts

1141
00:42:47,380 --> 00:42:48,700
gonna get better understanding of things

1142
00:42:48,700 --> 00:42:51,490
like the attack matrix right like what

1143
00:42:51,490 --> 00:42:53,790
does this mean for an attacker if I'm in

1144
00:42:53,790 --> 00:42:55,900
you know this stage of the lifecycle

1145
00:42:55,900 --> 00:42:57,640
what does this privilege escalation

1146
00:42:57,640 --> 00:43:00,190
technique do for me you know is it hard

1147
00:43:00,190 --> 00:43:01,930
to emulate is it easier in a certain

1148
00:43:01,930 --> 00:43:03,730
environment any of those things so

1149
00:43:03,730 --> 00:43:05,290
you're you know they'll get a better

1150
00:43:05,290 --> 00:43:07,540
understanding for those manual processes

1151
00:43:07,540 --> 00:43:10,330
of how hard it is you know to go through

1152
00:43:10,330 --> 00:43:11,200
those detection zhh

1153
00:43:11,200 --> 00:43:13,600
and then how to correlate data right so

1154
00:43:13,600 --> 00:43:14,920
that's an important piece to me that I

1155
00:43:14,920 --> 00:43:16,330
think junior analysts take away from

1156
00:43:16,330 --> 00:43:18,160
this more than anything is I've seen

1157
00:43:18,160 --> 00:43:20,560
this attack before I know when this

1158
00:43:20,560 --> 00:43:22,510
happens you know it does expires II and

1159
00:43:22,510 --> 00:43:24,490
I can correlate that data that you might

1160
00:43:24,490 --> 00:43:26,290
not be able to collect in every alert

1161
00:43:26,290 --> 00:43:27,970
right like you can only put so much data

1162
00:43:27,970 --> 00:43:30,190
in an alert to give to an analyst to

1163
00:43:30,190 --> 00:43:32,050
show this is something happened and that

1164
00:43:32,050 --> 00:43:33,880
analyst has to have some way to know how

1165
00:43:33,880 --> 00:43:35,080
to go ahead and correlate those

1166
00:43:35,080 --> 00:43:37,540
techniques or sorry correlate that

1167
00:43:37,540 --> 00:43:39,369
to the technique that's been identified

1168
00:43:39,369 --> 00:43:42,970
so you know in closing here so purple

1169
00:43:42,970 --> 00:43:44,980
teaming is a practice that I think you

1170
00:43:44,980 --> 00:43:47,140
know organizations of all sizes and all

1171
00:43:47,140 --> 00:43:49,450
manpower should be at least attempting

1172
00:43:49,450 --> 00:43:52,770
to emulate or attempting to to act on

1173
00:43:52,770 --> 00:43:54,940
doing these exercises inside your

1174
00:43:54,940 --> 00:43:57,220
environments it's gonna do nothing but

1175
00:43:57,220 --> 00:43:58,930
benefit your junior analyst there's a

1176
00:43:58,930 --> 00:44:00,910
lot of you know it's really really easy

1177
00:44:00,910 --> 00:44:02,740
to get started you know you're gonna

1178
00:44:02,740 --> 00:44:04,780
improve your analyst abilities and your

1179
00:44:04,780 --> 00:44:07,000
team's capabilities overall as you not

1180
00:44:07,000 --> 00:44:08,980
only build more capable analysts but

1181
00:44:08,980 --> 00:44:10,510
better purple teamers who can do a

1182
00:44:10,510 --> 00:44:12,069
better job of keeping up with those

1183
00:44:12,069 --> 00:44:13,960
recent threats right and making sure

1184
00:44:13,960 --> 00:44:15,190
that you have detection x' you have

1185
00:44:15,190 --> 00:44:17,950
analytics to identify all of those in

1186
00:44:17,950 --> 00:44:19,300
the wild and again like the last one

1187
00:44:19,300 --> 00:44:20,890
i'll make again is very easy to get

1188
00:44:20,890 --> 00:44:23,619
started with all of the open tooling and

1189
00:44:23,619 --> 00:44:25,089
documentation kind of guidance that's

1190
00:44:25,089 --> 00:44:27,220
out there right now and so i just think

1191
00:44:27,220 --> 00:44:29,260
it's very very valuable and still pretty

1192
00:44:29,260 --> 00:44:31,740
much underutilized in most organizations

1193
00:44:31,740 --> 00:44:37,079
currently so that is all I have for you

1194
00:44:37,079 --> 00:44:39,640
so I have a couple more things of swag

1195
00:44:39,640 --> 00:44:41,230
to give away if you'll give me another

1196
00:44:41,230 --> 00:44:43,480
two minutes I just wanted to walk

1197
00:44:43,480 --> 00:44:45,220
through another couple of examples I'll

1198
00:44:45,220 --> 00:44:46,809
give some people a chance to google

1199
00:44:46,809 --> 00:44:50,829
again or maybe redeem themselves as we

1200
00:44:50,829 --> 00:44:52,390
ask a few questions here so I'll try and

1201
00:44:52,390 --> 00:44:55,270
keep these easy so who likes lateral

1202
00:44:55,270 --> 00:44:58,510
movements yeah everybody likes lateral

1203
00:44:58,510 --> 00:45:00,430
movement right how about WMI lateral

1204
00:45:00,430 --> 00:45:02,650
movement okay

1205
00:45:02,650 --> 00:45:06,430
so if we use this WMI to move laterally

1206
00:45:06,430 --> 00:45:09,160
to another endpoint what port is that

1207
00:45:09,160 --> 00:45:11,349
going to initiate with on that distant

1208
00:45:11,349 --> 00:45:17,490
endpoint a corner over there nope

1209
00:45:19,580 --> 00:45:25,400
nope nah nope not 389 not good do you

1210
00:45:25,400 --> 00:45:31,370
think you're all kind of close she know

1211
00:45:31,370 --> 00:45:36,380
so ok who said 135 first alright there

1212
00:45:36,380 --> 00:45:38,780
you are I have a USB pin for you here in

1213
00:45:38,780 --> 00:45:43,820
the front all right so let's just walk

1214
00:45:43,820 --> 00:45:45,350
through this I probably have admin right

1215
00:45:45,350 --> 00:45:47,330
if I'm utilizing or able to use WMI to

1216
00:45:47,330 --> 00:45:49,100
move laterally across environment so

1217
00:45:49,100 --> 00:45:52,550
then what Windows Event ID would I

1218
00:45:52,550 --> 00:45:56,060
expect to see for a successful admin

1219
00:45:56,060 --> 00:46:00,320
logon on that end point no so that would

1220
00:46:00,320 --> 00:46:12,200
be a successful logon no I mean you can

1221
00:46:12,200 --> 00:46:18,800
google it like I said admin logon 46:24

1222
00:46:18,800 --> 00:46:24,770
is a successful logon event 4672 perfect

1223
00:46:24,770 --> 00:46:28,130
I have a USB fan for you alright so I'll

1224
00:46:28,130 --> 00:46:29,360
go ahead and end it on this last

1225
00:46:29,360 --> 00:46:31,460
question for a nice little in-game

1226
00:46:31,460 --> 00:46:33,980
notebook what would you expect the

1227
00:46:33,980 --> 00:46:36,910
parent process to be on that end point

1228
00:46:36,910 --> 00:46:40,430
whenever it spawns that process call

1229
00:46:40,430 --> 00:46:42,230
create command or that built in

1230
00:46:42,230 --> 00:46:45,920
PowerShell WMI CIM and say i spawn calc

1231
00:46:45,920 --> 00:46:48,980
using WMI on that distant endpoint

1232
00:46:48,980 --> 00:46:56,390
what's gonna be the parent process no it

1233
00:46:56,390 --> 00:46:59,900
starts with WMI I'll give you that nope

1234
00:46:59,900 --> 00:47:01,550
not wim equipment could be used to

1235
00:47:01,550 --> 00:47:02,990
initiate this command but what's it

1236
00:47:02,990 --> 00:47:06,080
gonna look like on the dissonant who

1237
00:47:06,080 --> 00:47:09,950
just said that W my PR vs c which is w

1238
00:47:09,950 --> 00:47:12,110
my provisioning so just i like going

1239
00:47:12,110 --> 00:47:13,250
through these examples because kinda

1240
00:47:13,250 --> 00:47:14,300
what you work through things you learn

1241
00:47:14,300 --> 00:47:16,070
as a purple team ER right and you get to

1242
00:47:16,070 --> 00:47:17,600
see these techniques happen in the wild

1243
00:47:17,600 --> 00:47:19,430
you get to record all those events and

1244
00:47:19,430 --> 00:47:20,480
you get to hopefully kind of keep this

1245
00:47:20,480 --> 00:47:22,010
as knowledge or google it like everyone

1246
00:47:22,010 --> 00:47:24,380
else does so thank you guys very much I

1247
00:47:24,380 --> 00:47:25,630
appreciate you coming out to my talk

1248
00:47:25,630 --> 00:47:29,020
hope you liked it

