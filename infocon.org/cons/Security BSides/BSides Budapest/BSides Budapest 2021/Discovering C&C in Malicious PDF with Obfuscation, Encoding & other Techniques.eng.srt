1
00:00:00,000 --> 00:00:02,320
hello guys welcome aboard

2
00:00:02,320 --> 00:00:04,080
and thank you thank you thank you for

3
00:00:04,080 --> 00:00:06,640
joining us my name is felipe pierce i

4
00:00:06,640 --> 00:00:08,160
like this guys in this picture by the

5
00:00:08,160 --> 00:00:09,519
way

6
00:00:09,519 --> 00:00:11,360
yeah yeah yeah yeah so my name is

7
00:00:11,360 --> 00:00:13,440
philippe peters i've been working as a

8
00:00:13,440 --> 00:00:15,759
principal security engineer and security

9
00:00:15,759 --> 00:00:18,320
research at supernovation

10
00:00:18,320 --> 00:00:19,840
super innovation it's a brazilian

11
00:00:19,840 --> 00:00:23,359
company and the focus in uh exponential

12
00:00:23,359 --> 00:00:26,400
growing and to give a

13
00:00:26,400 --> 00:00:28,720
awesome experience to the developers guy

14
00:00:28,720 --> 00:00:30,640
you know and the peoples and i am a

15
00:00:30,640 --> 00:00:33,200
security research and instructor that's

16
00:00:33,200 --> 00:00:35,440
a hacker secure or hacker security

17
00:00:35,440 --> 00:00:37,600
wherever and uh this company is

18
00:00:37,600 --> 00:00:39,920
responsible to provide some courses of

19
00:00:39,920 --> 00:00:42,719
the uh you know fantastic and uh about

20
00:00:42,719 --> 00:00:45,840
the red team blue team and a purple team

21
00:00:45,840 --> 00:00:48,000
and another different courses right so i

22
00:00:48,000 --> 00:00:50,559
am hacking is not a crime advocate it's

23
00:00:50,559 --> 00:00:53,360
a awesome awesome awesome project and

24
00:00:53,360 --> 00:00:54,480
the

25
00:00:54,480 --> 00:00:56,960
the idea in this project and to

26
00:00:56,960 --> 00:00:58,960
you know to try explain more about this

27
00:00:58,960 --> 00:01:00,960
kind of concept

28
00:01:00,960 --> 00:01:03,520
and this culture because hacking is is

29
00:01:03,520 --> 00:01:06,640
not a crime exactly haki it's a mindset

30
00:01:06,640 --> 00:01:09,760
hacking in uh you know it's a lifestyle

31
00:01:09,760 --> 00:01:12,960
and it's about creative mind right so

32
00:01:12,960 --> 00:01:15,759
that's our idea about this project and

33
00:01:15,759 --> 00:01:17,840
i'm a part of the staff team of the deaf

34
00:01:17,840 --> 00:01:21,119
group in sao paulo and as you can see i

35
00:01:21,119 --> 00:01:23,360
love to be part of the many different

36
00:01:23,360 --> 00:01:26,159
communities because i believe this it's

37
00:01:26,159 --> 00:01:28,640
very very very important to be part of

38
00:01:28,640 --> 00:01:30,960
this community because you can share

39
00:01:30,960 --> 00:01:33,520
the knowledgement you can share you know

40
00:01:33,520 --> 00:01:35,920
the different subjects and topics you

41
00:01:35,920 --> 00:01:38,720
can give the uh the knowledgement you

42
00:01:38,720 --> 00:01:42,399
can receive as well so uh and i'm i've

43
00:01:42,399 --> 00:01:44,560
been served as a professor in some

44
00:01:44,560 --> 00:01:47,200
universities here in brazil and

45
00:01:47,200 --> 00:01:49,840
some colleges like afiyapi and mckenzie

46
00:01:49,840 --> 00:01:51,000
and

47
00:01:51,000 --> 00:01:53,439
university this kind this name of this

48
00:01:53,439 --> 00:01:54,479
university

49
00:01:54,479 --> 00:01:55,280
and

50
00:01:55,280 --> 00:01:57,920
i am founder and instructor of the the

51
00:01:57,920 --> 00:02:00,320
principal the main course in in hacker

52
00:02:00,320 --> 00:02:02,320
sake the name it's more analysis

53
00:02:02,320 --> 00:02:04,880
fundamentals right so here my contact is

54
00:02:04,880 --> 00:02:07,520
in twitter and telegram and this is my

55
00:02:07,520 --> 00:02:09,919
email if you'd like to send me a message

56
00:02:09,919 --> 00:02:12,080
to talk with me you know to share

57
00:02:12,080 --> 00:02:15,200
acknowledgement i i really appreciate

58
00:02:15,200 --> 00:02:16,720
and it's the project that i am

59
00:02:16,720 --> 00:02:18,640
participating this is my home page in my

60
00:02:18,640 --> 00:02:19,840
web page

61
00:02:19,840 --> 00:02:22,480
right so here's some open source project

62
00:02:22,480 --> 00:02:23,760
projects that i

63
00:02:23,760 --> 00:02:25,840
like and i will explain more about the

64
00:02:25,840 --> 00:02:28,560
orosec program and here i am i've been

65
00:02:28,560 --> 00:02:30,239
working you know in another different

66
00:02:30,239 --> 00:02:32,400
projects like reach it's open source to

67
00:02:32,400 --> 00:02:35,519
allows you to create and store and share

68
00:02:35,519 --> 00:02:38,080
how to make securely and some

69
00:02:38,080 --> 00:02:40,080
formulas right

70
00:02:40,080 --> 00:02:42,160
in another project spigo it's another

71
00:02:42,160 --> 00:02:45,200
open source platform it's a framework

72
00:02:45,200 --> 00:02:47,840
based on server driven ui that allows

73
00:02:47,840 --> 00:02:50,160
teams to make a change to native mobile

74
00:02:50,160 --> 00:02:52,000
or web application it's very very

75
00:02:52,000 --> 00:02:53,920
interesting in another one it's a

76
00:02:53,920 --> 00:02:56,000
charles it's another open source tool

77
00:02:56,000 --> 00:02:58,000
that are deployed quickly continually

78
00:02:58,000 --> 00:02:59,599
and securely all the teams

79
00:02:59,599 --> 00:03:01,360
simultaneously validate different

80
00:03:01,360 --> 00:03:02,959
hypotheses

81
00:03:02,959 --> 00:03:05,920
with a specific groups of users right so

82
00:03:05,920 --> 00:03:08,640
here we can find another presentations

83
00:03:08,640 --> 00:03:12,239
or talks that i did in some events and

84
00:03:12,239 --> 00:03:14,800
another in here some articles that i

85
00:03:14,800 --> 00:03:17,200
have been published if you'd like to see

86
00:03:17,200 --> 00:03:20,480
right so let's talk about our summary or

87
00:03:20,480 --> 00:03:23,360
our agenda right so first we understand

88
00:03:23,360 --> 00:03:24,560
who is

89
00:03:24,560 --> 00:03:27,120
a thread because i would like to put all

90
00:03:27,120 --> 00:03:28,000
those

91
00:03:28,000 --> 00:03:30,000
in the same page right i think it's very

92
00:03:30,000 --> 00:03:32,480
important and after that we gonna talk

93
00:03:32,480 --> 00:03:35,040
about more analysis and we we need to

94
00:03:35,040 --> 00:03:37,840
understand we go to uh understand about

95
00:03:37,840 --> 00:03:40,720
the structure of the pdf we are

96
00:03:40,720 --> 00:03:42,720
i will do the demo in the end of this

97
00:03:42,720 --> 00:03:44,799
this explanations in the end if you have

98
00:03:44,799 --> 00:03:47,040
any questions i may hope to answer to

99
00:03:47,040 --> 00:03:49,440
you right so who is

100
00:03:49,440 --> 00:03:52,400
threat it's very important thing here

101
00:03:52,400 --> 00:03:53,599
because

102
00:03:53,599 --> 00:03:56,480
in security we have many different

103
00:03:56,480 --> 00:03:59,840
explanation or you know about this uh

104
00:03:59,840 --> 00:04:02,879
word a simple word right so i like to i

105
00:04:02,879 --> 00:04:05,040
just chose one of this right based on

106
00:04:05,040 --> 00:04:07,360
according this is all right so thread is

107
00:04:07,360 --> 00:04:09,480
a definition has a

108
00:04:09,480 --> 00:04:12,640
potential cause of the incident that may

109
00:04:12,640 --> 00:04:14,640
cause arms in the system and

110
00:04:14,640 --> 00:04:15,920
organization and here we have

111
00:04:15,920 --> 00:04:17,279
interesting points

112
00:04:17,279 --> 00:04:19,199
maybe threat can be it's a software

113
00:04:19,199 --> 00:04:20,399
attack

114
00:04:20,399 --> 00:04:22,000
or a theft

115
00:04:22,000 --> 00:04:24,720
of intellectual property intensity path

116
00:04:24,720 --> 00:04:26,800
of sabotage or

117
00:04:26,800 --> 00:04:29,680
or no and information distortion are

118
00:04:29,680 --> 00:04:32,000
example of the information security

119
00:04:32,000 --> 00:04:33,040
threats

120
00:04:33,040 --> 00:04:37,759
as hazut most of the many organizations

121
00:04:37,759 --> 00:04:40,000
chose active freddie hunting to practice

122
00:04:40,000 --> 00:04:42,400
to defend their organization

123
00:04:42,400 --> 00:04:45,520
from the network uh no threat so that's

124
00:04:45,520 --> 00:04:48,479
a good point here so maybe you can think

125
00:04:48,479 --> 00:04:50,320
now so philippe so

126
00:04:50,320 --> 00:04:52,800
actually the threat it's almost

127
00:04:52,800 --> 00:04:54,000
everything

128
00:04:54,000 --> 00:04:57,600
maybe as of course related to a softers

129
00:04:57,600 --> 00:05:00,160
or attacks of course we have a physical

130
00:05:00,160 --> 00:05:02,880
attack as well so in this case is almost

131
00:05:02,880 --> 00:05:05,520
different but in the end of the day the

132
00:05:05,520 --> 00:05:08,080
concept is almost the same right we need

133
00:05:08,080 --> 00:05:11,280
we the attacker will uh

134
00:05:11,280 --> 00:05:12,720
you know

135
00:05:12,720 --> 00:05:16,000
attack something a softer or a people

136
00:05:16,000 --> 00:05:18,479
right that's a important thing here

137
00:05:18,479 --> 00:05:21,039
so so the first step when i when i need

138
00:05:21,039 --> 00:05:24,880
to when i will execute some uh analysis

139
00:05:24,880 --> 00:05:28,240
the first idea i have of course the

140
00:05:28,240 --> 00:05:30,240
asynchronous simple i because i don't

141
00:05:30,240 --> 00:05:32,479
know if malicious not right so i have a

142
00:05:32,479 --> 00:05:35,199
sample and i need to analyze this and

143
00:05:35,199 --> 00:05:38,000
the first step and the first idea is to

144
00:05:38,000 --> 00:05:40,240
identification stats because i have a

145
00:05:40,240 --> 00:05:42,000
sample i don't know if it's malicious or

146
00:05:42,000 --> 00:05:44,479
not i don't know if he's a malware or

147
00:05:44,479 --> 00:05:46,240
not or

148
00:05:46,240 --> 00:05:48,000
it is

149
00:05:48,000 --> 00:05:49,840
i don't know it's document malicious or

150
00:05:49,840 --> 00:05:52,320
not so this is a simple definition right

151
00:05:52,320 --> 00:05:53,840
malware it's a malicious software then

152
00:05:53,840 --> 00:05:57,039
maldot is a document malicious so when

153
00:05:57,039 --> 00:05:57,759
uh

154
00:05:57,759 --> 00:06:00,080
when i did identify this

155
00:06:00,080 --> 00:06:02,400
sample i can choose what the best method

156
00:06:02,400 --> 00:06:03,520
that i will

157
00:06:03,520 --> 00:06:04,639
apply

158
00:06:04,639 --> 00:06:07,039
in this binary for example this file

159
00:06:07,039 --> 00:06:09,520
right so i will use an static analysis

160
00:06:09,520 --> 00:06:11,520
for dynamic analysis right this is just

161
00:06:11,520 --> 00:06:13,759
a concept after that i will prepare a

162
00:06:13,759 --> 00:06:15,759
report because this is a very important

163
00:06:15,759 --> 00:06:18,400
step because when after this

164
00:06:18,400 --> 00:06:20,800
the iso fitted this analysis i can

165
00:06:20,800 --> 00:06:23,280
prepare a report because of course this

166
00:06:23,280 --> 00:06:25,600
is part of our job like all part of the

167
00:06:25,600 --> 00:06:28,000
room of this the analyst or the treaty

168
00:06:28,000 --> 00:06:30,080
hunter or something like that so this

169
00:06:30,080 --> 00:06:32,479
report i can present to my manager to my

170
00:06:32,479 --> 00:06:35,600
tech lead or you know whatever but i can

171
00:06:35,600 --> 00:06:37,840
uh explain all those steps that i have

172
00:06:37,840 --> 00:06:39,600
that i executed when i made this

173
00:06:39,600 --> 00:06:42,400
analysis right and but philippe if i

174
00:06:42,400 --> 00:06:45,120
have a report what can i do

175
00:06:45,120 --> 00:06:47,440
with this information so the next step

176
00:06:47,440 --> 00:06:48,880
it's very important because i can

177
00:06:48,880 --> 00:06:50,319
improve

178
00:06:50,319 --> 00:06:52,400
the defenses mechanism because the end

179
00:06:52,400 --> 00:06:56,400
of the day when you have or when you do

180
00:06:56,400 --> 00:06:58,240
these analysis you can improve your

181
00:06:58,240 --> 00:07:00,319
defense's mechanism because you will

182
00:07:00,319 --> 00:07:03,599
discover what kind of the steps or way

183
00:07:03,599 --> 00:07:05,759
the attack can use in your environment

184
00:07:05,759 --> 00:07:08,000
so if you see

185
00:07:08,000 --> 00:07:09,039
that

186
00:07:09,039 --> 00:07:11,199
attack maybe

187
00:07:11,199 --> 00:07:13,280
using the bypass technique to

188
00:07:13,280 --> 00:07:15,680
you know to

189
00:07:15,680 --> 00:07:18,319
export your firewall for example you can

190
00:07:18,319 --> 00:07:19,120
uh

191
00:07:19,120 --> 00:07:22,080
do different uh you can improve the

192
00:07:22,080 --> 00:07:24,080
better configuration you can use another

193
00:07:24,080 --> 00:07:26,800
different or the best practice you can

194
00:07:26,800 --> 00:07:28,800
uh see the configurations on the

195
00:07:28,800 --> 00:07:30,880
settings you are tools that you use or

196
00:07:30,880 --> 00:07:32,800
the product that you buy for example

197
00:07:32,800 --> 00:07:36,000
right so after that you can create the

198
00:07:36,000 --> 00:07:38,560
good word you know you know the cyber

199
00:07:38,560 --> 00:07:40,560
threatening talent can build it

200
00:07:40,560 --> 00:07:42,319
it's very interesting because so if you

201
00:07:42,319 --> 00:07:44,240
have a small company maybe it's

202
00:07:44,240 --> 00:07:46,080
impossible if you create the cyber

203
00:07:46,080 --> 00:07:48,160
threat intelligence but today we have

204
00:07:48,160 --> 00:07:49,199
many

205
00:07:49,199 --> 00:07:51,199
uh different softwares or open source

206
00:07:51,199 --> 00:07:53,759
products that can help you to build it

207
00:07:53,759 --> 00:07:57,360
you know and why you can create or why

208
00:07:57,360 --> 00:07:59,599
you you could create the sabbath threat

209
00:07:59,599 --> 00:08:02,319
intelligence because if you learn

210
00:08:02,319 --> 00:08:05,280
how this behavior of the attacker of

211
00:08:05,280 --> 00:08:07,840
course you can prepared you can prepare

212
00:08:07,840 --> 00:08:09,840
more your defenses you know the

213
00:08:09,840 --> 00:08:12,639
mechanisms this is a very important here

214
00:08:12,639 --> 00:08:15,440
and of course because the cyber threats

215
00:08:15,440 --> 00:08:16,479
or the

216
00:08:16,479 --> 00:08:18,800
you have a straining cyber

217
00:08:18,800 --> 00:08:20,080
resilience

218
00:08:20,080 --> 00:08:22,160
resilience we have we need to have this

219
00:08:22,160 --> 00:08:23,120
because

220
00:08:23,120 --> 00:08:25,680
during our presentation now probably we

221
00:08:25,680 --> 00:08:28,400
have another guy another attacker or a

222
00:08:28,400 --> 00:08:30,879
30 actor creating a new

223
00:08:30,879 --> 00:08:32,799
different attack using a different

224
00:08:32,799 --> 00:08:35,039
techniques right because of this we have

225
00:08:35,039 --> 00:08:35,919
this

226
00:08:35,919 --> 00:08:38,719
life cycle not like cycle but the cycle

227
00:08:38,719 --> 00:08:40,000
of the

228
00:08:40,000 --> 00:08:43,120
attacker phase right so you can use in

229
00:08:43,120 --> 00:08:44,880
this method

230
00:08:44,880 --> 00:08:46,160
let's talk about

231
00:08:46,160 --> 00:08:48,880
statistical so what is a static analysis

232
00:08:48,880 --> 00:08:50,640
so it's very interesting

233
00:08:50,640 --> 00:08:53,360
usually this is the first step that the

234
00:08:53,360 --> 00:08:56,240
analyst using because

235
00:08:56,240 --> 00:08:58,959
usually the statistical describe the

236
00:08:58,959 --> 00:09:01,839
process of the analysing

237
00:09:01,839 --> 00:09:04,560
a program code it means

238
00:09:04,560 --> 00:09:08,000
you have a code you can analyze all

239
00:09:08,000 --> 00:09:08,959
those

240
00:09:08,959 --> 00:09:11,519
parts of this code if part of this code

241
00:09:11,519 --> 00:09:14,240
is malicious or not or you can analyze

242
00:09:14,240 --> 00:09:17,040
the structure of this code if in this

243
00:09:17,040 --> 00:09:19,760
inside this code we have a structure if

244
00:09:19,760 --> 00:09:22,959
this instructor has called some function

245
00:09:22,959 --> 00:09:26,160
for example you can find a dll uh what

246
00:09:26,160 --> 00:09:29,120
function this this dll is calling inside

247
00:09:29,120 --> 00:09:32,240
the system operation for example and the

248
00:09:32,240 --> 00:09:34,480
program itself doesn't run at this time

249
00:09:34,480 --> 00:09:36,320
right of course the paint of the program

250
00:09:36,320 --> 00:09:39,360
that you can be used but usually it's

251
00:09:39,360 --> 00:09:41,519
this this this

252
00:09:41,519 --> 00:09:45,120
method it's more safe right because as i

253
00:09:45,120 --> 00:09:47,519
mentioned it doesn't run at this time

254
00:09:47,519 --> 00:09:50,720
you using um like a manual command to

255
00:09:50,720 --> 00:09:54,080
try to understand of this code right and

256
00:09:54,080 --> 00:09:56,959
when you talk about the dynamic analysis

257
00:09:56,959 --> 00:09:58,720
it's another part another different

258
00:09:58,720 --> 00:10:02,560
method usually it's based on solely on

259
00:10:02,560 --> 00:10:05,360
behavior it means in the interaction

260
00:10:05,360 --> 00:10:07,519
that the mower has

261
00:10:07,519 --> 00:10:10,000
when it's executed or

262
00:10:10,000 --> 00:10:13,440
made of our or more dock in this case uh

263
00:10:13,440 --> 00:10:15,200
this analysis

264
00:10:15,200 --> 00:10:16,839
also known like a

265
00:10:16,839 --> 00:10:20,480
runtimes it means you as a crypto mower

266
00:10:20,480 --> 00:10:24,320
inside a controller environment right or

267
00:10:24,320 --> 00:10:25,920
not controller environment you can use

268
00:10:25,920 --> 00:10:27,519
an asm

269
00:10:27,519 --> 00:10:30,240
tools or product maybe you can as a put

270
00:10:30,240 --> 00:10:32,560
this mower inside this this product this

271
00:10:32,560 --> 00:10:35,279
code not called this tool you can

272
00:10:35,279 --> 00:10:37,839
analysis of the behavior inside this

273
00:10:37,839 --> 00:10:39,760
contract environment right so it can be

274
00:10:39,760 --> 00:10:41,360
easily automated

275
00:10:41,360 --> 00:10:44,000
there is main sites today that already

276
00:10:44,000 --> 00:10:46,560
perform analysis of this malicious

277
00:10:46,560 --> 00:10:50,079
artifact right so using a small concept

278
00:10:50,079 --> 00:10:52,800
called syn box it's similar you have a

279
00:10:52,800 --> 00:10:54,720
virtual machine and we always put this

280
00:10:54,720 --> 00:10:56,800
model inside this virtual machine and

281
00:10:56,800 --> 00:10:59,839
after that we will see while those

282
00:10:59,839 --> 00:11:02,560
behavior this malware has inside this

283
00:11:02,560 --> 00:11:06,079
virtual machine right so let's uh let me

284
00:11:06,079 --> 00:11:08,079
see here yes

285
00:11:08,079 --> 00:11:09,040
we have

286
00:11:09,040 --> 00:11:10,880
before talk about the the physical and

287
00:11:10,880 --> 00:11:12,880
logical structure i would like to share

288
00:11:12,880 --> 00:11:15,680
something here with you about the faces

289
00:11:15,680 --> 00:11:18,000
because it's important

290
00:11:18,000 --> 00:11:19,600
if you remember

291
00:11:19,600 --> 00:11:22,240
in the beginning of this presentation

292
00:11:22,240 --> 00:11:25,440
i talked about the initiation step right

293
00:11:25,440 --> 00:11:28,560
so the idea here is to try to understand

294
00:11:28,560 --> 00:11:30,480
about this point

295
00:11:30,480 --> 00:11:32,800
so here i have many

296
00:11:32,800 --> 00:11:35,279
artifacts right i have an amazon i have

297
00:11:35,279 --> 00:11:38,399
view invoice i have a linux i have a pdf

298
00:11:38,399 --> 00:11:40,720
this is a folder not a file and i have

299
00:11:40,720 --> 00:11:43,519
here repeal docs so

300
00:11:43,519 --> 00:11:45,920
and so i have many different five years

301
00:11:45,920 --> 00:11:48,880
with different extension so what this

302
00:11:48,880 --> 00:11:51,279
what come on what comment i can use here

303
00:11:51,279 --> 00:11:54,720
to try and find any uh information about

304
00:11:54,720 --> 00:11:57,680
this file so i think many people

305
00:11:57,680 --> 00:12:00,160
know about this file command right so i

306
00:12:00,160 --> 00:12:03,760
can execute my ma file command to try

307
00:12:03,760 --> 00:12:05,839
identify what this

308
00:12:05,839 --> 00:12:08,399
sample is right so here i have an amazon

309
00:12:08,399 --> 00:12:10,959
microsoft words right

310
00:12:10,959 --> 00:12:13,040
2007

311
00:12:13,040 --> 00:12:14,079
let me

312
00:12:14,079 --> 00:12:14,880
try

313
00:12:14,880 --> 00:12:17,120
looking inside another for example view

314
00:12:17,120 --> 00:12:18,480
it's a different

315
00:12:18,480 --> 00:12:21,120
view it's a pdf file right so let me see

316
00:12:21,120 --> 00:12:25,040
here about the linux dot text maybe it's

317
00:12:25,040 --> 00:12:26,320
a text

318
00:12:26,320 --> 00:12:28,639
so in this case it's not a text it's a

319
00:12:28,639 --> 00:12:31,519
l5 so it's it's different here because i

320
00:12:31,519 --> 00:12:33,920
have a another uh

321
00:12:33,920 --> 00:12:36,160
you know interpretation here so let me

322
00:12:36,160 --> 00:12:37,519
see another

323
00:12:37,519 --> 00:12:40,880
file resume about pdf

324
00:12:40,880 --> 00:12:44,639
it's a pdf perfect so let me see here

325
00:12:44,639 --> 00:12:46,639
uh in a windows

326
00:12:46,639 --> 00:12:49,040
if i have another here i have a simple

327
00:12:49,040 --> 00:12:50,800
file simple

328
00:12:50,800 --> 00:12:52,959
so here i have a pe

329
00:12:52,959 --> 00:12:56,240
32 executable right so as you can see

330
00:12:56,240 --> 00:12:58,000
here i use it with the file command we

331
00:12:58,000 --> 00:12:59,839
have a

332
00:12:59,839 --> 00:13:02,160
identification process but

333
00:13:02,160 --> 00:13:04,160
i have we have here some inking point

334
00:13:04,160 --> 00:13:06,639
because i have i has equipped here file

335
00:13:06,639 --> 00:13:08,079
linux dot

336
00:13:08,079 --> 00:13:10,959
text but actually is not

337
00:13:10,959 --> 00:13:13,360
a text file right it is a

338
00:13:13,360 --> 00:13:15,839
file so how it's possible

339
00:13:15,839 --> 00:13:17,440
because nearly we need to understand

340
00:13:17,440 --> 00:13:20,560
about the base that's my point here when

341
00:13:20,560 --> 00:13:22,959
you execute this file command in this

342
00:13:22,959 --> 00:13:26,560
case file determine the files type but

343
00:13:26,560 --> 00:13:27,760
what is the

344
00:13:27,760 --> 00:13:29,440
actually the correct information that

345
00:13:29,440 --> 00:13:31,440
these commands are using when they

346
00:13:31,440 --> 00:13:34,240
secluded in your environment so here is

347
00:13:34,240 --> 00:13:35,760
the manual i know

348
00:13:35,760 --> 00:13:37,920
probably you don't like to read the

349
00:13:37,920 --> 00:13:39,120
manual

350
00:13:39,120 --> 00:13:40,240
not

351
00:13:40,240 --> 00:13:42,800
not only in the linux platform but you

352
00:13:42,800 --> 00:13:44,160
don't like

353
00:13:44,160 --> 00:13:45,600
to read

354
00:13:45,600 --> 00:13:48,000
any different manual i don't like by the

355
00:13:48,000 --> 00:13:49,839
way but i think i suppose that you don't

356
00:13:49,839 --> 00:13:52,639
like right so

357
00:13:52,639 --> 00:13:54,800
but here we have important information

358
00:13:54,800 --> 00:13:57,199
to understand the basis right

359
00:13:57,199 --> 00:14:00,480
here we have important information so

360
00:14:00,480 --> 00:14:02,160
let me explain more about it the mesh

361
00:14:02,160 --> 00:14:05,279
key tests are used to check for file

362
00:14:05,279 --> 00:14:07,839
with data in particular fixed

363
00:14:07,839 --> 00:14:09,040
format

364
00:14:09,040 --> 00:14:11,440
so probably we have a specific form

365
00:14:11,440 --> 00:14:14,399
specific format to try to find

366
00:14:14,399 --> 00:14:18,720
or to understand what kind of file is

367
00:14:18,720 --> 00:14:20,399
it's not of course not based on the

368
00:14:20,399 --> 00:14:22,880
extension right and here we have the

369
00:14:22,880 --> 00:14:25,920
exponential this value has a magic

370
00:14:25,920 --> 00:14:27,199
number here

371
00:14:27,199 --> 00:14:31,360
is the key right so all or

372
00:14:31,360 --> 00:14:34,639
all those file has a magic number right

373
00:14:34,639 --> 00:14:36,720
so this magic number

374
00:14:36,720 --> 00:14:40,880
right started in particular place near

375
00:14:40,880 --> 00:14:42,720
the beginning

376
00:14:42,720 --> 00:14:45,680
of the file that tells the unix

377
00:14:45,680 --> 00:14:49,120
operation system that file is a binary

378
00:14:49,120 --> 00:14:52,800
executable so here we have a simple and

379
00:14:52,800 --> 00:14:55,199
very important explanation so

380
00:14:55,199 --> 00:14:57,839
all those file has a matching number

381
00:14:57,839 --> 00:15:01,360
right and all those magic number are

382
00:15:01,360 --> 00:15:04,320
stored in particular plates near

383
00:15:04,320 --> 00:15:05,680
the beginning

384
00:15:05,680 --> 00:15:07,199
so

385
00:15:07,199 --> 00:15:07,920
but

386
00:15:07,920 --> 00:15:10,560
how it's possible to understand more

387
00:15:10,560 --> 00:15:12,399
dates so here i

388
00:15:12,399 --> 00:15:15,440
made this very interesting thing to try

389
00:15:15,440 --> 00:15:17,760
explain more about this magic number for

390
00:15:17,760 --> 00:15:21,120
you right so i downloaded the

391
00:15:21,120 --> 00:15:23,440
file

392
00:15:23,440 --> 00:15:24,560
commands

393
00:15:24,560 --> 00:15:26,240
not actually not file command i

394
00:15:26,240 --> 00:15:29,680
downloaded the database responsible to

395
00:15:29,680 --> 00:15:31,440
offering this information to the

396
00:15:31,440 --> 00:15:33,600
operational system of course when you

397
00:15:33,600 --> 00:15:36,320
have any in the in the unix platform as

398
00:15:36,320 --> 00:15:39,440
you can see here in my machine i'm using

399
00:15:39,440 --> 00:15:43,120
the this um this binary it's compiled

400
00:15:43,120 --> 00:15:44,320
inside the

401
00:15:44,320 --> 00:15:46,160
the system operation of course

402
00:15:46,160 --> 00:15:49,839
in my case i here i downloaded this

403
00:15:49,839 --> 00:15:52,800
this source code and i search and i

404
00:15:52,800 --> 00:15:54,880
download the database of the file

405
00:15:54,880 --> 00:15:57,759
command right here so let's see

406
00:15:57,759 --> 00:16:00,959
very interesting information here let me

407
00:16:00,959 --> 00:16:03,199
looking

408
00:16:03,199 --> 00:16:05,440
looking more inside the javascript

409
00:16:05,440 --> 00:16:08,320
so here we have the file of the

410
00:16:08,320 --> 00:16:10,800
javascript of course and we have the

411
00:16:10,800 --> 00:16:14,240
definitions some definitions important

412
00:16:14,240 --> 00:16:17,920
when i execute the file command and this

413
00:16:17,920 --> 00:16:21,360
file command looking inside the database

414
00:16:21,360 --> 00:16:23,040
to try find

415
00:16:23,040 --> 00:16:26,079
the magic number of the javascript file

416
00:16:26,079 --> 00:16:28,880
for example let me put here this

417
00:16:28,880 --> 00:16:31,360
information i will copy here and i

418
00:16:31,360 --> 00:16:34,560
create in this simple

419
00:16:34,720 --> 00:16:35,680
simple

420
00:16:35,680 --> 00:16:38,800
file here pdf

421
00:16:38,800 --> 00:16:42,480
pdf dot text right and i will

422
00:16:42,480 --> 00:16:44,399
right here and i will put the

423
00:16:44,399 --> 00:16:46,320
information in tomorrow

424
00:16:46,320 --> 00:16:48,720
now actually we do the different i will

425
00:16:48,720 --> 00:16:52,079
put just a mouth right and i will save

426
00:16:52,079 --> 00:16:53,199
and i you

427
00:16:53,199 --> 00:16:56,160
look the pdf right

428
00:16:56,160 --> 00:16:59,199
actually it's a text as you can see here

429
00:16:59,199 --> 00:17:02,720
right is a text but now you change this

430
00:17:02,720 --> 00:17:05,199
information in the beginning because i

431
00:17:05,199 --> 00:17:08,480
learned now oh i read i i i

432
00:17:08,480 --> 00:17:10,000
i read now this

433
00:17:10,000 --> 00:17:10,880
uh

434
00:17:10,880 --> 00:17:13,119
in the ma of the file

435
00:17:13,119 --> 00:17:15,599
that all those file has a magic number

436
00:17:15,599 --> 00:17:16,880
in the beginning

437
00:17:16,880 --> 00:17:18,559
the particular place right in the

438
00:17:18,559 --> 00:17:20,240
beginning of the fight so i will say

439
00:17:20,240 --> 00:17:24,000
here and denote when i execute the file

440
00:17:24,000 --> 00:17:25,599
take a look what happened

441
00:17:25,599 --> 00:17:27,919
this is a of course the text but in this

442
00:17:27,919 --> 00:17:30,960
case the matching number it is next

443
00:17:30,960 --> 00:17:32,840
identified by

444
00:17:32,840 --> 00:17:35,280
node.js script

445
00:17:35,280 --> 00:17:37,520
take a look i will change

446
00:17:37,520 --> 00:17:38,799
another thing

447
00:17:38,799 --> 00:17:41,919
here i will put just a simple

448
00:17:41,919 --> 00:17:44,640
sign over here and i will save again

449
00:17:44,640 --> 00:17:47,919
and let's see what happened

450
00:17:49,840 --> 00:17:52,720
it's a python street

451
00:17:52,720 --> 00:17:55,200
very interesting so let's

452
00:17:55,200 --> 00:17:57,600
change something here it's a pdf

453
00:17:57,600 --> 00:18:00,960
move to pdf on the file

454
00:18:00,960 --> 00:18:05,919
and i say more the pdf figure

455
00:18:07,039 --> 00:18:08,559
yeah

456
00:18:08,559 --> 00:18:11,039
let me change here the

457
00:18:11,039 --> 00:18:12,320
privilege

458
00:18:12,320 --> 00:18:14,880
to pdf right

459
00:18:14,880 --> 00:18:16,799
and let me

460
00:18:16,799 --> 00:18:19,520
look again it's a pdf

461
00:18:19,520 --> 00:18:21,600
right so let me

462
00:18:21,600 --> 00:18:24,799
call python here i have three affiliates

463
00:18:24,799 --> 00:18:26,480
here and

464
00:18:26,480 --> 00:18:28,400
we have a

465
00:18:28,400 --> 00:18:30,960
syntax wrong before because it's not a

466
00:18:30,960 --> 00:18:33,200
python right it's very interesting

467
00:18:33,200 --> 00:18:35,679
because it's not a python but if you see

468
00:18:35,679 --> 00:18:37,840
in the beginning so let's see here cut

469
00:18:37,840 --> 00:18:40,399
python

470
00:18:40,880 --> 00:18:43,600
take a look here there's some regex

471
00:18:43,600 --> 00:18:46,640
ah because of this because i put here

472
00:18:46,640 --> 00:18:49,360
the magic number as you can see we have

473
00:18:49,360 --> 00:18:51,919
a different hero different

474
00:18:51,919 --> 00:18:54,000
information like uh

475
00:18:54,000 --> 00:18:56,080
similar reacts you can have a reaction

476
00:18:56,080 --> 00:18:56,960
you can

477
00:18:56,960 --> 00:18:58,320
see the

478
00:18:58,320 --> 00:19:00,480
informations here that you can use here

479
00:19:00,480 --> 00:19:02,880
for example let me copy here and i will

480
00:19:02,880 --> 00:19:06,880
change one more time

481
00:19:07,039 --> 00:19:09,360
here

482
00:19:09,440 --> 00:19:11,840
right

483
00:19:13,360 --> 00:19:16,240
it's a python

484
00:19:17,440 --> 00:19:20,320
i will cut here

485
00:19:20,640 --> 00:19:24,440
and probably you see

486
00:19:27,280 --> 00:19:29,679
in this case it asks e i think it looks

487
00:19:29,679 --> 00:19:32,559
very interesting it's in this case it's

488
00:19:32,559 --> 00:19:35,360
different because

489
00:19:35,440 --> 00:19:38,960
probably we use just just only

490
00:19:38,960 --> 00:19:41,520
like a policy inside of the database

491
00:19:41,520 --> 00:19:43,440
right now the police actually it's one

492
00:19:43,440 --> 00:19:45,440
of those rules i think it's better this

493
00:19:45,440 --> 00:19:46,320
group

494
00:19:46,320 --> 00:19:49,200
right so let me change

495
00:19:49,200 --> 00:19:50,320
the last

496
00:19:50,320 --> 00:19:51,200
the

497
00:19:51,200 --> 00:19:53,840
one more and the last time here

498
00:19:53,840 --> 00:19:56,400
um oh yes

499
00:19:56,400 --> 00:19:58,240
but here i will put the

500
00:19:58,240 --> 00:20:00,960
percent pdf because this is our

501
00:20:00,960 --> 00:20:03,200
challenge here today

502
00:20:03,200 --> 00:20:05,600
and now you say here and let's see what

503
00:20:05,600 --> 00:20:06,799
happened

504
00:20:06,799 --> 00:20:07,840
whoa

505
00:20:07,840 --> 00:20:11,039
it's a pdf dark man

506
00:20:11,039 --> 00:20:13,280
but in the station it's a

507
00:20:13,280 --> 00:20:14,480
python

508
00:20:14,480 --> 00:20:15,520
so

509
00:20:15,520 --> 00:20:18,320
all those so i did it

510
00:20:18,320 --> 00:20:20,960
during this presentation basically let

511
00:20:20,960 --> 00:20:23,679
me talk with you i did it during this

512
00:20:23,679 --> 00:20:24,880
presentation

513
00:20:24,880 --> 00:20:26,559
because you need to understand all those

514
00:20:26,559 --> 00:20:27,679
bases

515
00:20:27,679 --> 00:20:30,240
as i showed during this presentation you

516
00:20:30,240 --> 00:20:31,440
see here

517
00:20:31,440 --> 00:20:32,240
uh

518
00:20:32,240 --> 00:20:34,559
we saw here actually

519
00:20:34,559 --> 00:20:37,280
the file or the identification step it's

520
00:20:37,280 --> 00:20:40,240
very very important right because you

521
00:20:40,240 --> 00:20:43,919
need to understand inside of the file

522
00:20:43,919 --> 00:20:46,480
probably you know about the file command

523
00:20:46,480 --> 00:20:49,039
but the idea is here is

524
00:20:49,039 --> 00:20:52,720
it's try to you know explain you

525
00:20:52,720 --> 00:20:54,320
what how it's

526
00:20:54,320 --> 00:20:56,559
important to understand

527
00:20:56,559 --> 00:20:58,400
all those things right

528
00:20:58,400 --> 00:21:00,640
because for example let me

529
00:21:00,640 --> 00:21:02,799
share my screen one more time with you

530
00:21:02,799 --> 00:21:07,120
here so let's let's look inside this

531
00:21:07,120 --> 00:21:09,600
one more time here

532
00:21:09,600 --> 00:21:12,240
i think you know but probably so

533
00:21:12,240 --> 00:21:15,280
maybe some people don't know right here

534
00:21:15,280 --> 00:21:18,240
let me look inside this mod here we have

535
00:21:18,240 --> 00:21:20,799
here another interesting interesting

536
00:21:20,799 --> 00:21:22,960
very interesting information

537
00:21:22,960 --> 00:21:24,080
here

538
00:21:24,080 --> 00:21:26,400
uh okay

539
00:21:26,400 --> 00:21:27,919
wolf's format

540
00:21:27,919 --> 00:21:29,919
or in this case the imagine the mesh

541
00:21:29,919 --> 00:21:32,240
with assets are used to check for fires

542
00:21:32,240 --> 00:21:34,960
with data in particular fixed form right

543
00:21:34,960 --> 00:21:37,120
i read a red red

544
00:21:37,120 --> 00:21:40,400
the canonical the canonical example of

545
00:21:40,400 --> 00:21:43,679
this binary is um binary executable

546
00:21:43,679 --> 00:21:46,080
compilot program because it's inside of

547
00:21:46,080 --> 00:21:47,760
the system approach right

548
00:21:47,760 --> 00:21:50,960
and h dot out file boots format is

549
00:21:50,960 --> 00:21:55,280
defined in elf dot h

550
00:21:55,520 --> 00:21:57,440
here's another

551
00:21:57,440 --> 00:21:59,679
format and possibly

552
00:21:59,679 --> 00:22:02,159
as a good doc h

553
00:22:02,159 --> 00:22:05,360
in the standard included directory

554
00:22:05,360 --> 00:22:09,200
so let's see because here i am i can

555
00:22:09,200 --> 00:22:13,039
see i will copy this format right so

556
00:22:13,039 --> 00:22:16,159
let's see if you

557
00:22:16,159 --> 00:22:17,120
let me

558
00:22:17,120 --> 00:22:19,200
return

559
00:22:19,200 --> 00:22:21,200
our

560
00:22:21,200 --> 00:22:23,200
yes

561
00:22:23,200 --> 00:22:24,400
locate

562
00:22:24,400 --> 00:22:26,400
this file let's see

563
00:22:26,400 --> 00:22:29,679
so this binary actually it's included

564
00:22:29,679 --> 00:22:33,440
it's in this path user include l

565
00:22:33,440 --> 00:22:38,480
right are you ready are you read here

566
00:22:39,200 --> 00:22:42,240
take a look what is important here this

567
00:22:42,240 --> 00:22:45,360
file i think you can react with it

568
00:22:45,360 --> 00:22:48,480
this file defines a standard health

569
00:22:48,480 --> 00:22:49,600
times

570
00:22:49,600 --> 00:22:52,159
so take a look what is important inside

571
00:22:52,159 --> 00:22:53,520
this file

572
00:22:53,520 --> 00:22:55,440
right so this file define the standard

573
00:22:55,440 --> 00:22:58,720
of types structures and markers right so

574
00:22:58,720 --> 00:23:00,559
here we can find

575
00:23:00,559 --> 00:23:04,480
the correct destructor of the help file

576
00:23:04,480 --> 00:23:06,799
if you wrap below if you see here you

577
00:23:06,799 --> 00:23:08,400
can see the

578
00:23:08,400 --> 00:23:10,880
the number of the beats use it write the

579
00:23:10,880 --> 00:23:12,960
words the words

580
00:23:12,960 --> 00:23:16,400
text words and here you can see the

581
00:23:16,400 --> 00:23:17,760
interesting form

582
00:23:17,760 --> 00:23:20,799
information the elf file headers i know

583
00:23:20,799 --> 00:23:22,799
this presentation it's about pdf but

584
00:23:22,799 --> 00:23:25,039
take a look about the man or the

585
00:23:25,039 --> 00:23:27,120
information that we founded

586
00:23:27,120 --> 00:23:30,000
and then we found it inside the map

587
00:23:30,000 --> 00:23:32,960
the elf file header

588
00:23:32,960 --> 00:23:33,919
okay

589
00:23:33,919 --> 00:23:37,200
this is the file the elf file had

590
00:23:37,200 --> 00:23:41,360
this appears at the start of every elf

591
00:23:41,360 --> 00:23:45,120
file it means appears at the start

592
00:23:45,120 --> 00:23:47,919
whatever start

593
00:23:47,919 --> 00:23:51,039
that is in the beginning of the

594
00:23:51,039 --> 00:23:52,799
elf fire

595
00:23:52,799 --> 00:23:54,000
what

596
00:23:54,000 --> 00:23:55,760
started in

597
00:23:55,760 --> 00:23:57,679
what start in the beginning in this case

598
00:23:57,679 --> 00:23:59,760
we have in the beginning of the l5 we

599
00:23:59,760 --> 00:24:01,760
have a

600
00:24:01,760 --> 00:24:05,840
60 bytes right of beats in this case and

601
00:24:05,840 --> 00:24:07,840
you have a this

602
00:24:07,840 --> 00:24:09,840
is structure

603
00:24:09,840 --> 00:24:13,360
60 bytes right and the first

604
00:24:13,360 --> 00:24:16,080
array of this

605
00:24:16,080 --> 00:24:19,840
bytes is called e ident and you will

606
00:24:19,840 --> 00:24:22,000
find the magic number and other

607
00:24:22,000 --> 00:24:26,400
informations inside this 16 bytes

608
00:24:26,400 --> 00:24:27,840
will you find

609
00:24:27,840 --> 00:24:29,679
all those informations

610
00:24:29,679 --> 00:24:32,240
you see so magic number and others

611
00:24:32,240 --> 00:24:34,240
information what kind of information you

612
00:24:34,240 --> 00:24:35,600
can see

613
00:24:35,600 --> 00:24:39,120
here let's see okay this field is

614
00:24:39,120 --> 00:24:40,480
fields in the

615
00:24:40,480 --> 00:24:42,159
e ident array

616
00:24:42,159 --> 00:24:44,320
you will find you identity

617
00:24:44,320 --> 00:24:47,039
you can find the file identification

618
00:24:47,039 --> 00:24:50,880
byte the first is zero the second file

619
00:24:50,880 --> 00:24:54,640
hidden file it's e the third is

620
00:24:54,640 --> 00:24:57,039
l in the four it's

621
00:24:57,039 --> 00:24:58,480
f

622
00:24:58,480 --> 00:25:00,480
i will show you another

623
00:25:00,480 --> 00:25:03,760
thing for you here let me open

624
00:25:03,760 --> 00:25:07,039
this file linux 32 right

625
00:25:07,039 --> 00:25:10,799
and let me using file i use a file right

626
00:25:10,799 --> 00:25:14,320
and if i use here x

627
00:25:14,320 --> 00:25:16,720
uh xd

628
00:25:16,720 --> 00:25:19,760
32 linux

629
00:25:19,760 --> 00:25:20,559
right

630
00:25:20,559 --> 00:25:22,720
okay no it's not

631
00:25:22,720 --> 00:25:25,200
me knows

632
00:25:25,679 --> 00:25:29,080
not you know

633
00:25:30,120 --> 00:25:33,149
[Music]

634
00:25:53,840 --> 00:25:56,960
so take a look here the four bytes

635
00:25:56,960 --> 00:25:58,400
the first is

636
00:25:58,400 --> 00:26:00,799
zero

637
00:26:01,520 --> 00:26:03,840
the second is

638
00:26:03,840 --> 00:26:04,559
e

639
00:26:04,559 --> 00:26:07,600
in this case it's e here as you can see

640
00:26:07,600 --> 00:26:11,760
but the third it's l it's l here

641
00:26:11,760 --> 00:26:12,720
right

642
00:26:12,720 --> 00:26:13,840
and four

643
00:26:13,840 --> 00:26:14,960
it's l

644
00:26:14,960 --> 00:26:17,360
you see

645
00:26:20,080 --> 00:26:22,159
you can see

646
00:26:22,159 --> 00:26:24,640
so that is important you need to

647
00:26:24,640 --> 00:26:26,960
understand this because i

648
00:26:26,960 --> 00:26:29,360
read the amount of the file and i

649
00:26:29,360 --> 00:26:31,279
reached and i found

650
00:26:31,279 --> 00:26:33,039
many informations in part of the

651
00:26:33,039 --> 00:26:35,120
structure of the file

652
00:26:35,120 --> 00:26:37,440
but if i

653
00:26:37,440 --> 00:26:39,520
didn't read if i didn't read this

654
00:26:39,520 --> 00:26:41,600
information inside the map

655
00:26:41,600 --> 00:26:43,360
you know how it's supposed to understand

656
00:26:43,360 --> 00:26:45,840
the basis of course i need to run i need

657
00:26:45,840 --> 00:26:48,640
to study i need to to read actually i

658
00:26:48,640 --> 00:26:51,679
need to study about all those pages it's

659
00:26:51,679 --> 00:26:53,279
a main point here

660
00:26:53,279 --> 00:26:55,360
when you talk about the marinades when

661
00:26:55,360 --> 00:26:58,400
you talk about the red teams fantastic

662
00:26:58,400 --> 00:27:00,640
uh defense team like a blue team or

663
00:27:00,640 --> 00:27:03,440
freddie hunting teams or sock teams or

664
00:27:03,440 --> 00:27:05,600
whatever things you need to understand

665
00:27:05,600 --> 00:27:07,120
all those

666
00:27:07,120 --> 00:27:10,559
bases right people right so

667
00:27:10,559 --> 00:27:13,919
let me turn here my presentation right

668
00:27:13,919 --> 00:27:16,400
let me return here the

669
00:27:16,400 --> 00:27:18,320
structures right so let's talk about the

670
00:27:18,320 --> 00:27:20,159
physical and logical structure about the

671
00:27:20,159 --> 00:27:22,799
pdf usually we have a four parts the

672
00:27:22,799 --> 00:27:24,799
header usually

673
00:27:24,799 --> 00:27:27,440
it's very common in whatever binary we

674
00:27:27,440 --> 00:27:29,679
have a body we have a cross reference

675
00:27:29,679 --> 00:27:33,120
table and we have a trailer right so

676
00:27:33,120 --> 00:27:36,080
this is the main implied part of the pdf

677
00:27:36,080 --> 00:27:37,520
in the beginning of the file we have a

678
00:27:37,520 --> 00:27:40,399
version number right and you have

679
00:27:40,399 --> 00:27:42,240
uh objects

680
00:27:42,240 --> 00:27:43,600
you have a

681
00:27:43,600 --> 00:27:45,039
images

682
00:27:45,039 --> 00:27:47,039
you have a cross reference table this is

683
00:27:47,039 --> 00:27:50,080
a location of the object inside

684
00:27:50,080 --> 00:27:52,880
it in the file because it's random right

685
00:27:52,880 --> 00:27:55,279
the access and we have a trailer it's a

686
00:27:55,279 --> 00:27:58,000
location of the certain objects inside

687
00:27:58,000 --> 00:27:59,279
the

688
00:27:59,279 --> 00:28:02,559
board it means you have a mainly body

689
00:28:02,559 --> 00:28:03,679
and you have

690
00:28:03,679 --> 00:28:06,240
many objects inside this body and all

691
00:28:06,240 --> 00:28:08,320
those all those objects

692
00:28:08,320 --> 00:28:10,720
is or are in this case

693
00:28:10,720 --> 00:28:12,320
are reference

694
00:28:12,320 --> 00:28:13,679
one and

695
00:28:13,679 --> 00:28:17,279
another right so let me show you the

696
00:28:17,279 --> 00:28:20,640
demo to you so i use here

697
00:28:20,640 --> 00:28:21,760
um

698
00:28:21,760 --> 00:28:24,399
some tools to help us

699
00:28:24,399 --> 00:28:27,760
in in this demo i do as a pdf id it's

700
00:28:27,760 --> 00:28:29,520
very

701
00:28:29,520 --> 00:28:33,840
too it's created by dj stevens right and

702
00:28:33,840 --> 00:28:36,320
i was equipped with linux i

703
00:28:36,320 --> 00:28:38,240
if you see here the first information

704
00:28:38,240 --> 00:28:41,520
that um we found in this demo

705
00:28:41,520 --> 00:28:43,360
as you can see here we found the header

706
00:28:43,360 --> 00:28:45,520
as i mentioned the instructor right so

707
00:28:45,520 --> 00:28:47,840
the second information here we found the

708
00:28:47,840 --> 00:28:51,039
15 objects right so we have an

709
00:28:51,039 --> 00:28:54,000
15 objects and of course we have a and

710
00:28:54,000 --> 00:28:57,279
this is the same 15 right so maybe you

711
00:28:57,279 --> 00:29:00,080
have here not made you have to

712
00:29:00,080 --> 00:29:01,760
end extremely because we have a two

713
00:29:01,760 --> 00:29:04,480
extreme and here we have a cross

714
00:29:04,480 --> 00:29:05,919
reference table

715
00:29:05,919 --> 00:29:08,799
and if you see here we have others

716
00:29:08,799 --> 00:29:10,880
important information of course all

717
00:29:10,880 --> 00:29:13,039
those informations are inside the dda

718
00:29:13,039 --> 00:29:14,720
steven's blog right you can find all

719
00:29:14,720 --> 00:29:17,679
those explanation more inside at the the

720
00:29:17,679 --> 00:29:20,080
blog page of the day students right

721
00:29:20,080 --> 00:29:23,120
but here they slash or slash phase is

722
00:29:23,120 --> 00:29:26,000
slash encrypted slash objects streaming

723
00:29:26,000 --> 00:29:29,440
slash javascript here we will find

724
00:29:29,440 --> 00:29:31,840
interesting informations all those

725
00:29:31,840 --> 00:29:34,960
informations are inside this

726
00:29:34,960 --> 00:29:38,960
mainly part of the pdf so here i have an

727
00:29:38,960 --> 00:29:41,760
important tip for you

728
00:29:41,760 --> 00:29:44,559
probably when ddh steven created this

729
00:29:44,559 --> 00:29:46,320
tool

730
00:29:46,320 --> 00:29:50,480
he studied a lot about the pdf structure

731
00:29:50,480 --> 00:29:52,320
and of course

732
00:29:52,320 --> 00:29:55,520
he analyzed it probably many hours and

733
00:29:55,520 --> 00:29:58,880
he found many information inside this

734
00:29:58,880 --> 00:30:01,440
this uh samples yes

735
00:30:01,440 --> 00:30:04,000
and when probably of course i'm you know

736
00:30:04,000 --> 00:30:05,279
supposing

737
00:30:05,279 --> 00:30:07,440
because i'm thinking the idea of the

738
00:30:07,440 --> 00:30:09,360
basis right so

739
00:30:09,360 --> 00:30:11,600
all those slashes

740
00:30:11,600 --> 00:30:13,919
are informations inside the main

741
00:30:13,919 --> 00:30:18,000
employer the main object and these tools

742
00:30:18,000 --> 00:30:20,960
only just will possible to create it

743
00:30:20,960 --> 00:30:22,399
because probably

744
00:30:22,399 --> 00:30:26,320
the dds even the main creator right

745
00:30:26,320 --> 00:30:28,159
not knew about

746
00:30:28,159 --> 00:30:30,480
how this tool works

747
00:30:30,480 --> 00:30:33,039
right or not tools but how this pdf

748
00:30:33,039 --> 00:30:36,080
works it's the main point here right so

749
00:30:36,080 --> 00:30:38,000
let's continue to see here

750
00:30:38,000 --> 00:30:40,880
and we have here one page and we can see

751
00:30:40,880 --> 00:30:43,120
here we found

752
00:30:43,120 --> 00:30:46,399
five javascript inside the pdf and we

753
00:30:46,399 --> 00:30:48,240
have an open action opening actually

754
00:30:48,240 --> 00:30:50,880
it's a very interesting point here

755
00:30:50,880 --> 00:30:53,440
if you read in the website if you if you

756
00:30:53,440 --> 00:30:55,679
read of course

757
00:30:55,679 --> 00:30:57,440
you will see the open action is

758
00:30:57,440 --> 00:31:00,000
responsible just the

759
00:31:00,000 --> 00:31:03,120
the the user don't need to click

760
00:31:03,120 --> 00:31:05,760
main times in the pdf file

761
00:31:05,760 --> 00:31:07,440
when you have this open action inside

762
00:31:07,440 --> 00:31:10,000
the pdf the only action that user needs

763
00:31:10,000 --> 00:31:12,559
to do is download the file

764
00:31:12,559 --> 00:31:14,880
for example from the email

765
00:31:14,880 --> 00:31:17,760
if user receive an email and click in

766
00:31:17,760 --> 00:31:21,120
this pdf and download it in in

767
00:31:21,120 --> 00:31:22,799
for example in the machining in the

768
00:31:22,799 --> 00:31:25,120
bitman machine or in the in their own

769
00:31:25,120 --> 00:31:27,200
machine

770
00:31:27,200 --> 00:31:29,519
because they have this this file has an

771
00:31:29,519 --> 00:31:31,919
open action when the user download this

772
00:31:31,919 --> 00:31:33,440
file

773
00:31:33,440 --> 00:31:35,840
this file will execute this open action

774
00:31:35,840 --> 00:31:38,320
in this case it was a good something

775
00:31:38,320 --> 00:31:41,600
inside the pdf right so i can suppose of

776
00:31:41,600 --> 00:31:43,200
course it has

777
00:31:43,200 --> 00:31:45,919
an open action and it have javascript

778
00:31:45,919 --> 00:31:47,600
inside the file

779
00:31:47,600 --> 00:31:51,519
and this file just have an only page

780
00:31:51,519 --> 00:31:54,159
and we have some information crypto

781
00:31:54,159 --> 00:31:55,840
probably it's

782
00:31:55,840 --> 00:31:58,320
malicious but i don't know exactly what

783
00:31:58,320 --> 00:32:00,720
is malicious but it's malicious i was

784
00:32:00,720 --> 00:32:02,640
equipped after that the pdf part and

785
00:32:02,640 --> 00:32:04,640
it's another tool created by the dj

786
00:32:04,640 --> 00:32:07,679
stevens i i set the

787
00:32:07,679 --> 00:32:09,840
the run because i would like to see all

788
00:32:09,840 --> 00:32:13,279
those information inside this pdf and

789
00:32:13,279 --> 00:32:15,760
here i will explain something to you

790
00:32:15,760 --> 00:32:18,240
as you can see here the header

791
00:32:18,240 --> 00:32:20,799
and after that you can see here the

792
00:32:20,799 --> 00:32:23,279
object the object one

793
00:32:23,279 --> 00:32:26,960
and here we have object one say catalog

794
00:32:26,960 --> 00:32:28,880
and here we can see

795
00:32:28,880 --> 00:32:30,960
the referencing

796
00:32:30,960 --> 00:32:33,039
this is here's a very interesting point

797
00:32:33,039 --> 00:32:33,919
because

798
00:32:33,919 --> 00:32:35,600
the object one

799
00:32:35,600 --> 00:32:39,120
is referring object two of the three

800
00:32:39,120 --> 00:32:43,039
object four object five six and seven

801
00:32:43,039 --> 00:32:43,919
right

802
00:32:43,919 --> 00:32:45,760
and uh

803
00:32:45,760 --> 00:32:47,679
what this means in this case what is

804
00:32:47,679 --> 00:32:49,200
what you know

805
00:32:49,200 --> 00:32:50,720
here it's interesting point do you

806
00:32:50,720 --> 00:32:53,039
remember when i i explained about the

807
00:32:53,039 --> 00:32:55,600
structure if we have we have the object

808
00:32:55,600 --> 00:32:58,000
the body inside the board we have

809
00:32:58,000 --> 00:32:59,440
objects

810
00:32:59,440 --> 00:33:00,799
reference

811
00:33:00,799 --> 00:33:03,600
or inside or located

812
00:33:03,600 --> 00:33:06,159
inside the file right so

813
00:33:06,159 --> 00:33:09,679
many many times many times no but

814
00:33:09,679 --> 00:33:12,799
all those files or those objects

815
00:33:12,799 --> 00:33:16,880
are reference one another as i will show

816
00:33:16,880 --> 00:33:18,000
you here

817
00:33:18,000 --> 00:33:20,559
so take a look in object one we have a

818
00:33:20,559 --> 00:33:22,799
javascript

819
00:33:22,799 --> 00:33:24,880
and we have an open action

820
00:33:24,880 --> 00:33:28,640
oh let me return here

821
00:33:28,640 --> 00:33:30,000
we have an object

822
00:33:30,000 --> 00:33:32,159
in this first step we it's an open

823
00:33:32,159 --> 00:33:35,200
action is these open actions

824
00:33:35,200 --> 00:33:38,880
after this action executed in the bitman

825
00:33:38,880 --> 00:33:40,399
machine

826
00:33:40,399 --> 00:33:42,399
is executed

827
00:33:42,399 --> 00:33:44,559
or will be as equipped at javascript so

828
00:33:44,559 --> 00:33:47,840
here is a evidence that is

829
00:33:47,840 --> 00:33:49,519
malicious because

830
00:33:49,519 --> 00:33:52,080
the user when downloaded the file after

831
00:33:52,080 --> 00:33:55,120
that is will be executed open action and

832
00:33:55,120 --> 00:33:57,120
after that

833
00:33:57,120 --> 00:33:59,120
is uh will be as equipped with the

834
00:33:59,120 --> 00:34:01,919
javascript right so let's continue to

835
00:34:01,919 --> 00:34:02,799
see

836
00:34:02,799 --> 00:34:06,480
so okay we have an object two three four

837
00:34:06,480 --> 00:34:09,199
five and take a look here let me return

838
00:34:09,199 --> 00:34:11,520
one more time here because i have here

839
00:34:11,520 --> 00:34:13,199
another information important

840
00:34:13,199 --> 00:34:15,199
information here

841
00:34:15,199 --> 00:34:16,480
okay

842
00:34:16,480 --> 00:34:19,199
take a look here object four

843
00:34:19,199 --> 00:34:22,079
in this case object 4 references

844
00:34:22,079 --> 00:34:23,280
uh

845
00:34:23,280 --> 00:34:25,040
object 8

846
00:34:25,040 --> 00:34:28,399
and 9 because the e4 we just have an

847
00:34:28,399 --> 00:34:29,440
object

848
00:34:29,440 --> 00:34:30,399
1

849
00:34:30,399 --> 00:34:33,359
and 2 7 but now we have an object 8 and

850
00:34:33,359 --> 00:34:35,918
nine two more objects right

851
00:34:35,918 --> 00:34:38,079
so let's continue

852
00:34:38,079 --> 00:34:40,480
object six four and here we have another

853
00:34:40,480 --> 00:34:43,280
reference object seven we have another

854
00:34:43,280 --> 00:34:46,320
reference an object thin and inside the

855
00:34:46,320 --> 00:34:49,119
objecting we have a javascript

856
00:34:49,119 --> 00:34:50,000
you see

857
00:34:50,000 --> 00:34:51,040
okay

858
00:34:51,040 --> 00:34:54,000
so and here let me put

859
00:34:54,000 --> 00:34:56,879
in object nine take a look what happened

860
00:34:56,879 --> 00:34:59,599
here we have an object four because you

861
00:34:59,599 --> 00:35:01,599
know one of these

862
00:35:01,599 --> 00:35:04,240
one another one of the another

863
00:35:04,240 --> 00:35:06,880
we have this reference between this the

864
00:35:06,880 --> 00:35:08,240
object

865
00:35:08,240 --> 00:35:10,560
and here we have another reference

866
00:35:10,560 --> 00:35:14,079
11 object 11. so we have a

867
00:35:14,079 --> 00:35:16,320
beginning this is the one object and now

868
00:35:16,320 --> 00:35:20,800
we have the one until 11 right

869
00:35:20,800 --> 00:35:21,599
but

870
00:35:21,599 --> 00:35:23,760
when we executed

871
00:35:23,760 --> 00:35:26,400
the pdf id do you remember how many

872
00:35:26,400 --> 00:35:28,880
object we have inside this file

873
00:35:28,880 --> 00:35:31,760
15. you don't need no don't forget this

874
00:35:31,760 --> 00:35:34,000
right

875
00:35:36,240 --> 00:35:38,079
here take a look

876
00:35:38,079 --> 00:35:39,920
we have the object 10

877
00:35:39,920 --> 00:35:42,400
inside objecting we have an object

878
00:35:42,400 --> 00:35:45,920
another reference object 12

879
00:35:45,920 --> 00:35:47,680
right and we have

880
00:35:47,680 --> 00:35:50,000
over here we have a javascript

881
00:35:50,000 --> 00:35:52,240
okay take a look here

882
00:35:52,240 --> 00:35:54,960
in object 11

883
00:35:54,960 --> 00:35:56,880
we have oh here we have another

884
00:35:56,880 --> 00:36:00,079
information different contain contains a

885
00:36:00,079 --> 00:36:01,280
stream

886
00:36:01,280 --> 00:36:03,040
so probably we have

887
00:36:03,040 --> 00:36:06,079
something inside this stream right

888
00:36:06,079 --> 00:36:08,640
and when we have this flag reflect the

889
00:36:08,640 --> 00:36:09,760
code

890
00:36:09,760 --> 00:36:11,839
because we need to decode the

891
00:36:11,839 --> 00:36:13,599
information right and here we have a

892
00:36:13,599 --> 00:36:16,000
length it's it's like a

893
00:36:16,000 --> 00:36:19,520
a size of this this kind of string right

894
00:36:19,520 --> 00:36:22,079
so maybe when you see here the size it's

895
00:36:22,079 --> 00:36:23,119
a small

896
00:36:23,119 --> 00:36:23,920
okay

897
00:36:23,920 --> 00:36:26,720
and in inside of object 12 we have

898
00:36:26,720 --> 00:36:29,040
another reference in object

899
00:36:29,040 --> 00:36:32,079
13 and inside it is object 13 we have

900
00:36:32,079 --> 00:36:35,760
what a javascript so let's continue to

901
00:36:35,760 --> 00:36:40,160
see what happened in here take a look

902
00:36:40,160 --> 00:36:43,920
contain streaming object 13

903
00:36:43,920 --> 00:36:46,560
and you have the same flat the code

904
00:36:46,560 --> 00:36:47,440
but

905
00:36:47,440 --> 00:36:50,560
here we have a big big size

906
00:36:50,560 --> 00:36:53,440
31 5 3 1

907
00:36:53,440 --> 00:36:54,880
one

908
00:36:54,880 --> 00:36:57,680
is a big a big size right so here maybe

909
00:36:57,680 --> 00:37:00,800
i need to looking more deeply right

910
00:37:00,800 --> 00:37:04,880
so okay and we have another object 14

911
00:37:04,880 --> 00:37:06,000
the last

912
00:37:06,000 --> 00:37:09,040
then maybe or almost the last right and

913
00:37:09,040 --> 00:37:11,280
because we have a 15 objects inside here

914
00:37:11,280 --> 00:37:14,640
and we have here the object 15 okay so

915
00:37:14,640 --> 00:37:17,119
we need to see more deeply

916
00:37:17,119 --> 00:37:19,040
of the

917
00:37:19,040 --> 00:37:22,320
13 object right so next step next next

918
00:37:22,320 --> 00:37:25,119
step here we use a good a pdr pica it's

919
00:37:25,119 --> 00:37:26,560
another tool

920
00:37:26,560 --> 00:37:29,760
actually this tool is not from the diva

921
00:37:29,760 --> 00:37:32,000
but it's another very interesting tool i

922
00:37:32,000 --> 00:37:32,800
will

923
00:37:32,800 --> 00:37:34,560
basically hear the comment i will

924
00:37:34,560 --> 00:37:38,240
execute i will collect the output

925
00:37:38,240 --> 00:37:40,800
of this sample all those information

926
00:37:40,800 --> 00:37:42,079
because i will structure this

927
00:37:42,079 --> 00:37:44,960
information here i and i will uncompress

928
00:37:44,960 --> 00:37:48,400
all this information inside this them

929
00:37:48,400 --> 00:37:51,520
dot text right

930
00:37:51,520 --> 00:37:53,599
okay i was equipped this so now we need

931
00:37:53,599 --> 00:37:54,800
to

932
00:37:54,800 --> 00:37:55,520
see

933
00:37:55,520 --> 00:37:57,839
what information we have inside this

934
00:37:57,839 --> 00:38:00,720
them and take a look what what we will

935
00:38:00,720 --> 00:38:02,640
see here i can

936
00:38:02,640 --> 00:38:03,520
see

937
00:38:03,520 --> 00:38:06,400
all those information and take a look

938
00:38:06,400 --> 00:38:07,200
here

939
00:38:07,200 --> 00:38:10,480
here we found the first technique

940
00:38:10,480 --> 00:38:13,760
used by the attacker so here we can see

941
00:38:13,760 --> 00:38:17,119
the javascript hopeful stated so

942
00:38:17,119 --> 00:38:19,520
what what the next step i need to do the

943
00:38:19,520 --> 00:38:21,680
state of this information but here the

944
00:38:21,680 --> 00:38:25,040
attacker pulls this technique

945
00:38:25,040 --> 00:38:26,960
right so i will see here some

946
00:38:26,960 --> 00:38:29,280
informations i will

947
00:38:29,280 --> 00:38:31,280
i see

948
00:38:31,280 --> 00:38:34,000
some parameters that the attacker used

949
00:38:34,000 --> 00:38:37,119
in this demo and this case so i will cop

950
00:38:37,119 --> 00:38:38,400
the code

951
00:38:38,400 --> 00:38:40,800
and i need to of course this also states

952
00:38:40,800 --> 00:38:42,240
this called it to try

953
00:38:42,240 --> 00:38:43,520
find

954
00:38:43,520 --> 00:38:46,240
some information right so i will set

955
00:38:46,240 --> 00:38:48,000
this uh

956
00:38:48,000 --> 00:38:50,079
file in html

957
00:38:50,079 --> 00:38:51,359
why

958
00:38:51,359 --> 00:38:54,400
simple because when we execute

959
00:38:54,400 --> 00:38:56,480
any web applications usually they're

960
00:38:56,480 --> 00:38:59,760
using the javascript and html and css

961
00:38:59,760 --> 00:39:02,079
and something like that right so i found

962
00:39:02,079 --> 00:39:05,040
here the evo parameter and i will using

963
00:39:05,040 --> 00:39:07,040
this evil parameter to try the software

964
00:39:07,040 --> 00:39:09,359
skate this code right so

965
00:39:09,359 --> 00:39:11,760
basically i will

966
00:39:11,760 --> 00:39:14,480
see inside this parameter and i will

967
00:39:14,480 --> 00:39:17,040
change to the document writer right

968
00:39:17,040 --> 00:39:19,119
because of the point right actually

969
00:39:19,119 --> 00:39:21,760
because i do need to i view the idea

970
00:39:21,760 --> 00:39:23,760
here is to try rate

971
00:39:23,760 --> 00:39:26,640
what information can find

972
00:39:26,640 --> 00:39:28,720
inside this

973
00:39:28,720 --> 00:39:31,680
javascript obfuscated right so take a

974
00:39:31,680 --> 00:39:35,520
look what happened here it's very very

975
00:39:35,520 --> 00:39:37,440
nice what happened here

976
00:39:37,440 --> 00:39:40,000
so after that i

977
00:39:40,000 --> 00:39:41,119
gave the

978
00:39:41,119 --> 00:39:43,040
privilege access to to access this

979
00:39:43,040 --> 00:39:46,320
information of course and i will exclude

980
00:39:46,320 --> 00:39:48,800
this payload.html

981
00:39:48,800 --> 00:39:51,760
so take a look now what happened

982
00:39:51,760 --> 00:39:54,880
here in our demo

983
00:39:54,880 --> 00:39:57,200
wow

984
00:39:57,200 --> 00:39:58,400
i will

985
00:39:58,400 --> 00:39:59,599
show you

986
00:39:59,599 --> 00:40:01,359
how you found

987
00:40:01,359 --> 00:40:04,880
the var a variable payload

988
00:40:04,880 --> 00:40:08,560
as you can see here we found a payload

989
00:40:08,560 --> 00:40:12,000
right so what what means exactly in this

990
00:40:12,000 --> 00:40:13,040
case

991
00:40:13,040 --> 00:40:15,520
we found here a payload

992
00:40:15,520 --> 00:40:17,040
malicious

993
00:40:17,040 --> 00:40:19,760
so first of all we have a pdf file

994
00:40:19,760 --> 00:40:21,520
inside the pdf file we have an open

995
00:40:21,520 --> 00:40:22,400
action

996
00:40:22,400 --> 00:40:25,680
this open action after that

997
00:40:25,680 --> 00:40:27,680
will uh

998
00:40:27,680 --> 00:40:30,000
execute the javascript

999
00:40:30,000 --> 00:40:32,000
these are scripted to us

1000
00:40:32,000 --> 00:40:34,240
what of skating

1001
00:40:34,240 --> 00:40:37,200
inside the javascript has a payload

1002
00:40:37,200 --> 00:40:39,599
payload is responsible to

1003
00:40:39,599 --> 00:40:40,960
you know

1004
00:40:40,960 --> 00:40:43,520
load this payload inside the vehicle

1005
00:40:43,520 --> 00:40:46,480
machine and this code is responsible to

1006
00:40:46,480 --> 00:40:49,040
call reverse to call back

1007
00:40:49,040 --> 00:40:52,800
to the cnc and this case right so now we

1008
00:40:52,800 --> 00:40:56,319
have a payload responsible to

1009
00:40:56,319 --> 00:40:58,480
you know load this information

1010
00:40:58,480 --> 00:41:00,880
or or to download the information to

1011
00:41:00,880 --> 00:41:02,560
download this information inside the

1012
00:41:02,560 --> 00:41:05,119
bitmain machine and this payload in this

1013
00:41:05,119 --> 00:41:07,920
case this payload as i'm showing to you

1014
00:41:07,920 --> 00:41:11,040
which will be responsible to call

1015
00:41:11,040 --> 00:41:12,800
to the cnc

1016
00:41:12,800 --> 00:41:16,000
from the attacker or the thready actor

1017
00:41:16,000 --> 00:41:17,839
so now i could

1018
00:41:17,839 --> 00:41:20,800
to finish my analysis but

1019
00:41:20,800 --> 00:41:23,440
here we have interesting point if

1020
00:41:23,440 --> 00:41:26,880
let's suppose if i have the payload i

1021
00:41:26,880 --> 00:41:29,599
you know i can try to find

1022
00:41:29,599 --> 00:41:34,480
this uh iep responsible to this

1023
00:41:34,480 --> 00:41:37,680
attacker right so after that what i see

1024
00:41:37,680 --> 00:41:40,319
so let's see what

1025
00:41:40,319 --> 00:41:43,280
kind information i can try and find so

1026
00:41:43,280 --> 00:41:45,359
i see here

1027
00:41:45,359 --> 00:41:49,119
some information right like a a percent

1028
00:41:49,119 --> 00:41:52,560
here and some numbers maybe

1029
00:41:52,560 --> 00:41:55,920
so the next step i created another file

1030
00:41:55,920 --> 00:42:00,319
here right i called it real payload

1031
00:42:00,319 --> 00:42:03,359
perfect and i would generate i i copy

1032
00:42:03,359 --> 00:42:05,040
and paste all the information inside

1033
00:42:05,040 --> 00:42:07,680
this file and i using the

1034
00:42:07,680 --> 00:42:11,599
the set to cut this percent here because

1035
00:42:11,599 --> 00:42:14,880
my idea is to try to clean

1036
00:42:14,880 --> 00:42:17,920
the file take a look at here the

1037
00:42:17,920 --> 00:42:20,960
the var you know the parameter

1038
00:42:20,960 --> 00:42:23,200
and i cut some information

1039
00:42:23,200 --> 00:42:26,720
and here i cut many others uh like a

1040
00:42:26,720 --> 00:42:29,359
slash like a percent and i copped this

1041
00:42:29,359 --> 00:42:30,560
information

1042
00:42:30,560 --> 00:42:35,599
and i arrived in a unicode hold here

1043
00:42:35,599 --> 00:42:38,160
so now i have this

1044
00:42:38,160 --> 00:42:40,880
unicode code it's another technique

1045
00:42:40,880 --> 00:42:43,200
because the attacker in this case

1046
00:42:43,200 --> 00:42:46,000
it it's of course it's it's um

1047
00:42:46,000 --> 00:42:50,240
it's not new but it's old uh the unicode

1048
00:42:50,240 --> 00:42:51,520
code based

1049
00:42:51,520 --> 00:42:54,079
on issue uh

1050
00:42:54,079 --> 00:42:58,800
ucs yes actually it's yes yes no ec2 you

1051
00:42:58,800 --> 00:43:01,440
says yes so it's unicode it's basically

1052
00:43:01,440 --> 00:43:03,760
two bytes different of the ste is

1053
00:43:03,760 --> 00:43:05,920
because it's very common now

1054
00:43:05,920 --> 00:43:06,720
so

1055
00:43:06,720 --> 00:43:09,280
uh this is here it's very interesting so

1056
00:43:09,280 --> 00:43:12,960
let's i i use in many linux platforms so

1057
00:43:12,960 --> 00:43:15,359
i will see now another platform mozilla

1058
00:43:15,359 --> 00:43:18,480
in a windows machine to show you so here

1059
00:43:18,480 --> 00:43:21,200
we have the same code right so we have a

1060
00:43:21,200 --> 00:43:24,560
key all those percent here i need to cut

1061
00:43:24,560 --> 00:43:27,680
that i did in the linux machine right so

1062
00:43:27,680 --> 00:43:30,000
i cut this information and here i have

1063
00:43:30,000 --> 00:43:31,119
the

1064
00:43:31,119 --> 00:43:32,160
pure

1065
00:43:32,160 --> 00:43:33,119
uh

1066
00:43:33,119 --> 00:43:36,880
you know pure unicode so after that so

1067
00:43:36,880 --> 00:43:38,960
do you remember i have i had a

1068
00:43:38,960 --> 00:43:41,760
javascript of stated

1069
00:43:41,760 --> 00:43:44,000
i just obfuscated this code and after

1070
00:43:44,000 --> 00:43:45,680
that i generate

1071
00:43:45,680 --> 00:43:48,480
a payload this payload

1072
00:43:48,480 --> 00:43:52,839
i found the unicode codebasin in uct in

1073
00:43:52,839 --> 00:43:54,720
in

1074
00:43:54,720 --> 00:43:58,720
c2 sorry and inside this information i

1075
00:43:58,720 --> 00:44:02,880
generate a next file docker binary using

1076
00:44:02,880 --> 00:44:05,520
this tool mozilla right

1077
00:44:05,520 --> 00:44:08,319
so after that take a look what i did i

1078
00:44:08,319 --> 00:44:11,760
using a short search it's another tool

1079
00:44:11,760 --> 00:44:14,480
provided by dj stevens i use a put an

1080
00:44:14,480 --> 00:44:17,520
extra file my file that i generated here

1081
00:44:17,520 --> 00:44:19,760
in this case and i called

1082
00:44:19,760 --> 00:44:24,480
http protocol and take a look here what

1083
00:44:24,480 --> 00:44:27,040
i found

1084
00:44:27,040 --> 00:44:30,240
basically i found the cac from the

1085
00:44:30,240 --> 00:44:31,599
attacker

1086
00:44:31,599 --> 00:44:32,560
you see

1087
00:44:32,560 --> 00:44:34,400
this attacker

1088
00:44:34,400 --> 00:44:38,240
was in this case in estonia iraq right

1089
00:44:38,240 --> 00:44:41,680
so now we finish our presentation and i

1090
00:44:41,680 --> 00:44:43,839
will show you here my

1091
00:44:43,839 --> 00:44:47,119
contacts again on the social medias and

1092
00:44:47,119 --> 00:44:50,079
just to finish the presentation so we

1093
00:44:50,079 --> 00:44:53,200
let me talk with you

1094
00:44:53,200 --> 00:44:54,079
we

1095
00:44:54,079 --> 00:44:57,119
we had a fast as simple because we have

1096
00:44:57,119 --> 00:45:00,079
a fitted file so we found

1097
00:45:00,079 --> 00:45:03,280
a javascript inside the pdf file

1098
00:45:03,280 --> 00:45:05,599
we have an open action we had an open

1099
00:45:05,599 --> 00:45:07,839
action inside this this file

1100
00:45:07,839 --> 00:45:09,200
this pdf

1101
00:45:09,200 --> 00:45:11,359
had an open action and this open action

1102
00:45:11,359 --> 00:45:15,119
called a javascript the javascript has

1103
00:45:15,119 --> 00:45:19,440
or had in this case um uh just off

1104
00:45:19,440 --> 00:45:20,480
stated

1105
00:45:20,480 --> 00:45:22,480
inside this javascript looks skate we

1106
00:45:22,480 --> 00:45:25,839
have a payload this payload

1107
00:45:25,839 --> 00:45:27,280
it will be download another bitman

1108
00:45:27,280 --> 00:45:28,240
machine

1109
00:45:28,240 --> 00:45:31,760
right and this payload has a only code

1110
00:45:31,760 --> 00:45:34,560
right it's it's old of course but

1111
00:45:34,560 --> 00:45:36,240
it is another technique

1112
00:45:36,240 --> 00:45:38,880
and and after that i generate

1113
00:45:38,880 --> 00:45:39,839
um

1114
00:45:39,839 --> 00:45:42,640
extra binary right and after that i use

1115
00:45:42,640 --> 00:45:43,760
a chore

1116
00:45:43,760 --> 00:45:47,040
to collect the http protocol to find the

1117
00:45:47,040 --> 00:45:49,920
cac up from the

1118
00:45:49,920 --> 00:45:51,680
attacker in this case a command in

1119
00:45:51,680 --> 00:45:55,040
control right responsible to set or to

1120
00:45:55,040 --> 00:45:57,839
send this attacking to the vital machine

1121
00:45:57,839 --> 00:45:59,680
so we finish our presentation if you

1122
00:45:59,680 --> 00:46:01,680
have any questions so please

1123
00:46:01,680 --> 00:46:04,000
let me know i am available to you thank

1124
00:46:04,000 --> 00:46:06,240
you one more time for stay with me

1125
00:46:06,240 --> 00:46:08,880
during this presentation so

1126
00:46:08,880 --> 00:46:10,480
again if you have any question i am

1127
00:46:10,480 --> 00:46:14,000
available available to you

