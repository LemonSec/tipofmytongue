1
00:00:00,560 --> 00:00:03,360
okay ladies and gentlemen we have the

2
00:00:03,360 --> 00:00:05,839
uh the the final

3
00:00:05,839 --> 00:00:07,759
presentation of

4
00:00:07,759 --> 00:00:12,000
b-sides 2022 kelly lemtafa

5
00:00:12,000 --> 00:00:13,920
on a subject that mark

6
00:00:13,920 --> 00:00:15,519
uh mentioned

7
00:00:15,519 --> 00:00:17,039
um

8
00:00:17,039 --> 00:00:21,520
book bounty khalil thank you

9
00:00:23,519 --> 00:00:26,320
so hello everyone and uh welcome to the

10
00:00:26,320 --> 00:00:28,400
last talk of today which is titled bug

11
00:00:28,400 --> 00:00:30,480
bounty recon the right way

12
00:00:30,480 --> 00:00:32,640
and as you may have noticed that the

13
00:00:32,640 --> 00:00:34,880
word right is between two double quotes

14
00:00:34,880 --> 00:00:35,680
so

15
00:00:35,680 --> 00:00:37,920
we will discover together in this small

16
00:00:37,920 --> 00:00:39,600
discussion or

17
00:00:39,600 --> 00:00:42,399
just small talk is it really right or

18
00:00:42,399 --> 00:00:43,680
not

19
00:00:43,680 --> 00:00:45,280
so

20
00:00:45,280 --> 00:00:48,480
who am i i'm a full-time student i have

21
00:00:48,480 --> 00:00:50,399
a bachelor in network security and

22
00:00:50,399 --> 00:00:52,000
computer systems

23
00:00:52,000 --> 00:00:54,320
from kade ayad university in my home

24
00:00:54,320 --> 00:00:56,000
country morocco

25
00:00:56,000 --> 00:00:58,079
and currently i'm following a cyber

26
00:00:58,079 --> 00:01:00,640
security master's degree at elte

27
00:01:00,640 --> 00:01:03,440
and i am a student software developer at

28
00:01:03,440 --> 00:01:04,879
ericsson

29
00:01:04,879 --> 00:01:05,840
also

30
00:01:05,840 --> 00:01:07,840
during this year i created the cyber

31
00:01:07,840 --> 00:01:10,240
security club at my university which is

32
00:01:10,240 --> 00:01:14,240
called ecsc and on my free time i love

33
00:01:14,240 --> 00:01:16,479
to do bug bounty hunting on hacker one

34
00:01:16,479 --> 00:01:18,560
and syna creatine

35
00:01:18,560 --> 00:01:19,600
so

36
00:01:19,600 --> 00:01:22,400
the first slide of this talk starts with

37
00:01:22,400 --> 00:01:23,759
three words

38
00:01:23,759 --> 00:01:26,400
understand the organization

39
00:01:26,400 --> 00:01:28,479
and when i say this i really mean it

40
00:01:28,479 --> 00:01:29,759
because you have to understand

41
00:01:29,759 --> 00:01:32,240
everything about the organization and

42
00:01:32,240 --> 00:01:34,159
who is this organization you are going

43
00:01:34,159 --> 00:01:36,320
to deal with and

44
00:01:36,320 --> 00:01:38,960
like when it was created and

45
00:01:38,960 --> 00:01:40,880
i mean i have some questions here like

46
00:01:40,880 --> 00:01:43,200
you should ask ask yourself like who is

47
00:01:43,200 --> 00:01:45,360
this company home it's working with

48
00:01:45,360 --> 00:01:47,759
where is it located and this is a very

49
00:01:47,759 --> 00:01:49,119
important question that you should

50
00:01:49,119 --> 00:01:51,200
remember because we will cover later in

51
00:01:51,200 --> 00:01:52,399
the slides

52
00:01:52,399 --> 00:01:54,560
and uh have i used this applications

53
00:01:54,560 --> 00:01:57,439
before and so on

54
00:01:57,439 --> 00:01:58,399
um

55
00:01:58,399 --> 00:02:00,479
for recon you have a lot of tools to

56
00:02:00,479 --> 00:02:02,399
play with there's wikipedia there's

57
00:02:02,399 --> 00:02:04,320
crunchbase census

58
00:02:04,320 --> 00:02:08,160
google zuma github being duckduckgo like

59
00:02:08,160 --> 00:02:10,000
literally anything that has a search bar

60
00:02:10,000 --> 00:02:11,520
on the internet can help you in this

61
00:02:11,520 --> 00:02:13,200
process

62
00:02:13,200 --> 00:02:15,040
and

63
00:02:15,040 --> 00:02:17,599
more assets equals bigger recon surface

64
00:02:17,599 --> 00:02:19,840
this is a very simple equation that you

65
00:02:19,840 --> 00:02:22,560
should put in your mind while doing

66
00:02:22,560 --> 00:02:24,959
recon

67
00:02:25,280 --> 00:02:27,920
the scope is divided into two types in

68
00:02:27,920 --> 00:02:30,480
bug bounties in general there are wide

69
00:02:30,480 --> 00:02:33,200
scope targets and small scope targets or

70
00:02:33,200 --> 00:02:34,480
programs

71
00:02:34,480 --> 00:02:36,160
so for the small scope programs they

72
00:02:36,160 --> 00:02:38,959
generally have one to five assets

73
00:02:38,959 --> 00:02:42,480
maybe more by two or three assets but

74
00:02:42,480 --> 00:02:45,120
not too much and in the other hand you

75
00:02:45,120 --> 00:02:47,760
will find the wide scope targets so they

76
00:02:47,760 --> 00:02:48,800
may

77
00:02:48,800 --> 00:02:50,879
have a lot of things that you can play

78
00:02:50,879 --> 00:02:51,840
with

79
00:02:51,840 --> 00:02:54,560
and since this talk is

80
00:02:54,560 --> 00:02:56,720
focusing on recon we will talk only

81
00:02:56,720 --> 00:02:59,760
about wide scope targets

82
00:02:59,760 --> 00:03:02,959
so the components of the wide scope are

83
00:03:02,959 --> 00:03:05,280
a lot of things like you can find sub

84
00:03:05,280 --> 00:03:07,239
domains like

85
00:03:07,239 --> 00:03:09,120
star.target.tld

86
00:03:09,120 --> 00:03:11,760
uh you may also find cidr or cdo

87
00:03:11,760 --> 00:03:14,159
notations for ip addresses

88
00:03:14,159 --> 00:03:18,560
or mobile applications like android ios

89
00:03:18,560 --> 00:03:21,599
you can even find cars that are included

90
00:03:21,599 --> 00:03:22,720
in scope

91
00:03:22,720 --> 00:03:25,040
or hardware

92
00:03:25,040 --> 00:03:27,599
and a good practical example for a wide

93
00:03:27,599 --> 00:03:30,560
scope target is tesla which has its own

94
00:03:30,560 --> 00:03:33,840
program over background platform which

95
00:03:33,840 --> 00:03:35,680
is a bug bounty platform

96
00:03:35,680 --> 00:03:38,480
and by the way for each slide where i

97
00:03:38,480 --> 00:03:40,000
referenced something you will find the

98
00:03:40,000 --> 00:03:42,239
link down below where you can just go

99
00:03:42,239 --> 00:03:45,120
and it will take you to the same page

100
00:03:45,120 --> 00:03:48,319
so why tesla has a big scope or white

101
00:03:48,319 --> 00:03:50,560
scope because as you can see here it has

102
00:03:50,560 --> 00:03:52,080
a lot of things to

103
00:03:52,080 --> 00:03:54,959
look for bugs there and uh

104
00:03:54,959 --> 00:03:57,120
they mentioned in the first line that a

105
00:03:57,120 --> 00:04:00,560
hardware product that you own or or are

106
00:04:00,560 --> 00:04:02,480
authorized to test against like a

107
00:04:02,480 --> 00:04:05,360
vehicle power wall etc so

108
00:04:05,360 --> 00:04:07,439
if you have a tesla vehicle you can

109
00:04:07,439 --> 00:04:10,000
definitely hack it if you found a bug a

110
00:04:10,000 --> 00:04:12,080
critical bug for example you may get

111
00:04:12,080 --> 00:04:15,760
fifteen thousand dollars for it

112
00:04:15,760 --> 00:04:18,959
the web section of the scope is this

113
00:04:18,959 --> 00:04:22,320
so there is a tesla.com tesla.cm

114
00:04:22,320 --> 00:04:25,520
tesla services and they even explicitly

115
00:04:25,520 --> 00:04:27,680
mentioned down below that any house

116
00:04:27,680 --> 00:04:29,840
verified to be owned or

117
00:04:29,840 --> 00:04:31,919
to be owned by tesla motors inc is

118
00:04:31,919 --> 00:04:33,680
included in scope

119
00:04:33,680 --> 00:04:37,120
domains ip space and anything that is

120
00:04:37,120 --> 00:04:38,639
explicitly

121
00:04:38,639 --> 00:04:41,520
mentioned that it's owned by tesla is

122
00:04:41,520 --> 00:04:43,520
definitely in scope

123
00:04:43,520 --> 00:04:45,759
and this is the mobile section of the

124
00:04:45,759 --> 00:04:47,520
scope they

125
00:04:47,520 --> 00:04:50,720
included the official tesla android apps

126
00:04:50,720 --> 00:04:54,880
and the official tesla ios apps

127
00:04:54,880 --> 00:04:57,120
for the small scope it's the same story

128
00:04:57,120 --> 00:04:58,320
except that

129
00:04:58,320 --> 00:05:01,440
they have a limited attack surface and

130
00:05:01,440 --> 00:05:03,120
they definitely need a different

131
00:05:03,120 --> 00:05:05,199
approach so automation might not be

132
00:05:05,199 --> 00:05:07,280
useful here

133
00:05:07,280 --> 00:05:09,440
now comes the tips and mindset part of

134
00:05:09,440 --> 00:05:12,400
the talk where am i i'm going to give

135
00:05:12,400 --> 00:05:14,080
you some tips that you should put in

136
00:05:14,080 --> 00:05:15,199
your mind

137
00:05:15,199 --> 00:05:18,479
and the first one is an answer for the

138
00:05:18,479 --> 00:05:20,639
question that i told you to remember

139
00:05:20,639 --> 00:05:24,080
where is it located about the company

140
00:05:24,080 --> 00:05:27,199
and this tip i called it a country based

141
00:05:27,199 --> 00:05:30,240
subs or subdomain brute forcing

142
00:05:30,240 --> 00:05:31,759
why you should always check out the

143
00:05:31,759 --> 00:05:33,600
origin of the company because for

144
00:05:33,600 --> 00:05:36,639
example if you have a company which is

145
00:05:36,639 --> 00:05:38,880
based in netherlands you can do

146
00:05:38,880 --> 00:05:41,199
subdomain brute forcing based on dutch

147
00:05:41,199 --> 00:05:43,680
word list or dutch words

148
00:05:43,680 --> 00:05:45,600
so

149
00:05:45,600 --> 00:05:48,000
you have the target and you can brute

150
00:05:48,000 --> 00:05:50,479
force its subdomains using dutch words

151
00:05:50,479 --> 00:05:52,320
since it look since it's located in

152
00:05:52,320 --> 00:05:53,680
netherlands

153
00:05:53,680 --> 00:05:56,080
and it is always recommended to use this

154
00:05:56,080 --> 00:05:58,080
method after gathering subdomains with

155
00:05:58,080 --> 00:06:01,039
other tools and general world lists

156
00:06:01,039 --> 00:06:03,199
i did an experiment for this

157
00:06:03,199 --> 00:06:04,080
and

158
00:06:04,080 --> 00:06:06,400
i used knockby which is a subdomain

159
00:06:06,400 --> 00:06:08,400
brute forcing tool

160
00:06:08,400 --> 00:06:10,960
that works through dictionary attack

161
00:06:10,960 --> 00:06:13,280
and it's available on github

162
00:06:13,280 --> 00:06:14,000
and

163
00:06:14,000 --> 00:06:15,840
i combined it with a

164
00:06:15,840 --> 00:06:19,120
dutch word list from the cyclists

165
00:06:19,120 --> 00:06:21,840
uh this was the first one of the tool

166
00:06:21,840 --> 00:06:24,319
using normal subdomain brute forcing

167
00:06:24,319 --> 00:06:26,240
using the default word list of the knock

168
00:06:26,240 --> 00:06:27,360
by tool

169
00:06:27,360 --> 00:06:28,560
and

170
00:06:28,560 --> 00:06:30,240
as you can see here it gave me some

171
00:06:30,240 --> 00:06:31,759
results but

172
00:06:31,759 --> 00:06:34,560
they are not really good because there's

173
00:06:34,560 --> 00:06:36,800
a lot of things that you can find

174
00:06:36,800 --> 00:06:41,280
so i added the word list using the tag w

175
00:06:41,280 --> 00:06:42,400
option

176
00:06:42,400 --> 00:06:44,319
custom word list which is in this case

177
00:06:44,319 --> 00:06:46,960
the dutch based word list

178
00:06:46,960 --> 00:06:47,919
and

179
00:06:47,919 --> 00:06:50,160
as you may notice here i got some

180
00:06:50,160 --> 00:06:51,919
different results like

181
00:06:51,919 --> 00:06:54,919
active.worksgrant.nl

182
00:06:55,680 --> 00:06:57,759
yeah i forgot to mention that works

183
00:06:57,759 --> 00:06:59,280
grant is

184
00:06:59,280 --> 00:07:02,160
a pro a target which is available on

185
00:07:02,160 --> 00:07:04,160
integrity and

186
00:07:04,160 --> 00:07:05,440
this is the

187
00:07:05,440 --> 00:07:07,680
link for the program integrity is

188
00:07:07,680 --> 00:07:12,160
another european bug bounty platform

189
00:07:12,160 --> 00:07:14,639
uh yeah and these were the subdomains

190
00:07:14,639 --> 00:07:17,280
that the two found using the other word

191
00:07:17,280 --> 00:07:21,638
list like verger dot volksgrand.nlv

192
00:07:22,080 --> 00:07:24,720
and and so on

193
00:07:24,720 --> 00:07:26,560
so yeah

194
00:07:26,560 --> 00:07:28,560
you just have to be creative and look

195
00:07:28,560 --> 00:07:30,800
for the right things in the right place

196
00:07:30,800 --> 00:07:32,960
don't do what everyone else does because

197
00:07:32,960 --> 00:07:34,880
you will not find something

198
00:07:34,880 --> 00:07:37,120
and an extra tip that it is always

199
00:07:37,120 --> 00:07:38,479
recommended to

200
00:07:38,479 --> 00:07:40,479
run sub domain enumeration

201
00:07:40,479 --> 00:07:42,400
on a big list that you already gathered

202
00:07:42,400 --> 00:07:44,479
like for example if you gathered

203
00:07:44,479 --> 00:07:46,960
subdomains using asset finders subfinder

204
00:07:46,960 --> 00:07:49,919
sublister all the tools that you know

205
00:07:49,919 --> 00:07:52,080
it is recommended to run subdomain brute

206
00:07:52,080 --> 00:07:54,800
forcing on that big list like this

207
00:07:54,800 --> 00:07:56,479
command right there

208
00:07:56,479 --> 00:08:00,319
subfinder like dl subdomains and httpx

209
00:08:00,319 --> 00:08:02,240
for resolving them

210
00:08:02,240 --> 00:08:03,199
and

211
00:08:03,199 --> 00:08:05,599
don't be like this cut right here don't

212
00:08:05,599 --> 00:08:07,680
wait for the results to come out you can

213
00:08:07,680 --> 00:08:10,160
automate this part and go take a coffee

214
00:08:10,160 --> 00:08:12,319
or go sleep then return back you will

215
00:08:12,319 --> 00:08:15,360
get your fresh new word list of the sub

216
00:08:15,360 --> 00:08:17,840
sub domains

217
00:08:17,840 --> 00:08:20,800
um next tip is about copyright recon

218
00:08:20,800 --> 00:08:23,120
which is from the big ban of recon

219
00:08:23,120 --> 00:08:24,879
himself jason haddix

220
00:08:24,879 --> 00:08:26,639
by the way make sure to follow him on

221
00:08:26,639 --> 00:08:29,599
twitter he posts some great tips

222
00:08:29,599 --> 00:08:32,799
about recon and bug bounty in general

223
00:08:32,799 --> 00:08:33,839
so

224
00:08:33,839 --> 00:08:35,120
this tip is

225
00:08:35,120 --> 00:08:36,958
specific for wide scope targets

226
00:08:36,958 --> 00:08:38,958
including the acquisitions

227
00:08:38,958 --> 00:08:41,360
and the tip is

228
00:08:41,360 --> 00:08:43,599
every website has its own copyright in

229
00:08:43,599 --> 00:08:45,920
the footer so he just grabs that

230
00:08:45,920 --> 00:08:48,399
copyright word and puts it between two

231
00:08:48,399 --> 00:08:49,680
double quotes

232
00:08:49,680 --> 00:08:53,200
minus the main domain on as a google doc

233
00:08:53,200 --> 00:08:56,480
or on bing on or anywhere

234
00:08:56,480 --> 00:08:58,959
and he finds some other interesting

235
00:08:58,959 --> 00:09:00,480
domains and sub domains that are

236
00:09:00,480 --> 00:09:03,120
controlled by the same company and he

237
00:09:03,120 --> 00:09:05,519
even mentioned that he found all market

238
00:09:05,519 --> 00:09:06,560
insights

239
00:09:06,560 --> 00:09:08,720
outdated installs of software build

240
00:09:08,720 --> 00:09:11,040
tools and more

241
00:09:11,040 --> 00:09:12,560
and

242
00:09:12,560 --> 00:09:14,880
yeah i did again an experiment over a

243
00:09:14,880 --> 00:09:17,519
tnt which has another

244
00:09:17,519 --> 00:09:19,519
program over hacker one

245
00:09:19,519 --> 00:09:22,720
and atnt is another white scope program

246
00:09:22,720 --> 00:09:24,720
so i went to their official website

247
00:09:24,720 --> 00:09:26,640
atnt.com

248
00:09:26,640 --> 00:09:29,680
and i went to the footer of the website

249
00:09:29,680 --> 00:09:31,839
as you can see here it has the copyright

250
00:09:31,839 --> 00:09:33,920
word

251
00:09:33,920 --> 00:09:37,839
so i copied this sentence right here

252
00:09:37,839 --> 00:09:40,720
which is the copyright of a tnt

253
00:09:40,720 --> 00:09:44,320
and i put it as a google door in text

254
00:09:44,320 --> 00:09:46,320
column between two double quotes the

255
00:09:46,320 --> 00:09:48,959
copyright minus atnt.com

256
00:09:48,959 --> 00:09:51,920
and i got uh some interesting results

257
00:09:51,920 --> 00:09:53,519
that you can't even tell that they are

258
00:09:53,519 --> 00:09:55,279
owned by atm t

259
00:09:55,279 --> 00:09:58,240
and uh i'm sorry if it's not visible

260
00:09:58,240 --> 00:10:02,839
like for example turn up the love.com

261
00:10:02,839 --> 00:10:06,720
yeah and yeah it is owned by atnt and if

262
00:10:06,720 --> 00:10:08,720
you found a bug there you can get paid

263
00:10:08,720 --> 00:10:10,560
for it

264
00:10:10,560 --> 00:10:12,959
uh you can also search using older

265
00:10:12,959 --> 00:10:14,480
copyright words

266
00:10:14,480 --> 00:10:17,680
just replace 2022 by 2016 and you will

267
00:10:17,680 --> 00:10:20,640
get 2016 websites

268
00:10:20,640 --> 00:10:22,720
and all their copyright equals all their

269
00:10:22,720 --> 00:10:26,240
websites equals more vulnerabilities

270
00:10:26,240 --> 00:10:27,680
why because

271
00:10:27,680 --> 00:10:29,760
all their websites use all their

272
00:10:29,760 --> 00:10:32,959
software which which have already cves

273
00:10:32,959 --> 00:10:34,000
and

274
00:10:34,000 --> 00:10:36,399
zero days or i don't know and then there

275
00:10:36,399 --> 00:10:39,200
you can find more vulnerabilities

276
00:10:39,200 --> 00:10:42,160
uh to the next step is about note-taking

277
00:10:42,160 --> 00:10:44,320
and i always

278
00:10:44,320 --> 00:10:46,720
say that taking is the golden tip of bug

279
00:10:46,720 --> 00:10:49,120
bounty you should always track your

280
00:10:49,120 --> 00:10:51,600
progress note down every small detail

281
00:10:51,600 --> 00:10:54,480
that you found and use the time tracker

282
00:10:54,480 --> 00:10:56,959
personally i use notion for note taking

283
00:10:56,959 --> 00:10:59,519
and toggle track for time tracking time

284
00:10:59,519 --> 00:11:01,040
tracking story

285
00:11:01,040 --> 00:11:01,760
and

286
00:11:01,760 --> 00:11:03,680
you are actually tricking your mind to

287
00:11:03,680 --> 00:11:06,640
see the progress and do more because

288
00:11:06,640 --> 00:11:09,040
when you find something and note it down

289
00:11:09,040 --> 00:11:11,200
if you come back later like after one

290
00:11:11,200 --> 00:11:13,600
week or two weeks or i don't know you

291
00:11:13,600 --> 00:11:15,680
will see that you did the progress and

292
00:11:15,680 --> 00:11:17,760
you can do more

293
00:11:17,760 --> 00:11:18,720
yeah

294
00:11:18,720 --> 00:11:20,880
and set for yourself some goals like for

295
00:11:20,880 --> 00:11:23,200
example this month i will hunt for 20

296
00:11:23,200 --> 00:11:24,959
hours and score 2 thousand dollars in

297
00:11:24,959 --> 00:11:26,079
bounties

298
00:11:26,079 --> 00:11:28,399
and why i said 20 hours because i guess

299
00:11:28,399 --> 00:11:29,600
it's

300
00:11:29,600 --> 00:11:30,720
a normal

301
00:11:30,720 --> 00:11:31,920
average

302
00:11:31,920 --> 00:11:34,000
free time for everyone if you're a

303
00:11:34,000 --> 00:11:36,320
full-time student or you are working in

304
00:11:36,320 --> 00:11:39,120
a company i mean five hours per week

305
00:11:39,120 --> 00:11:41,279
will be nothing

306
00:11:41,279 --> 00:11:43,839
and i did the same before the stock i

307
00:11:43,839 --> 00:11:46,399
picked the program i stick with it and i

308
00:11:46,399 --> 00:11:48,480
said that i will hunt on it minimum 20

309
00:11:48,480 --> 00:11:49,360
hours

310
00:11:49,360 --> 00:11:53,760
and the score minimum 1 000 of bounties

311
00:11:53,760 --> 00:11:56,720
and this is a glance for my notes

312
00:11:56,720 --> 00:11:59,920
i divided each week or each day what am

313
00:11:59,920 --> 00:12:02,320
i going to do choose a program set up a

314
00:12:02,320 --> 00:12:06,000
vps tools recon and use the app as a

315
00:12:06,000 --> 00:12:08,639
normal user hack and pray

316
00:12:08,639 --> 00:12:11,920
and finally notes and some takeaways i

317
00:12:11,920 --> 00:12:14,800
also wrote down some rules do not cheat

318
00:12:14,800 --> 00:12:16,079
and

319
00:12:16,079 --> 00:12:18,160
yeah just to be consistent in this

320
00:12:18,160 --> 00:12:19,600
challenge

321
00:12:19,600 --> 00:12:21,440
and this is double track

322
00:12:21,440 --> 00:12:23,360
uh actually as you can see it gives a

323
00:12:23,360 --> 00:12:24,399
pretty good

324
00:12:24,399 --> 00:12:27,360
visual analysis about what you did so

325
00:12:27,360 --> 00:12:29,279
each time when you start bug bounty you

326
00:12:29,279 --> 00:12:31,120
can just click on the play button and it

327
00:12:31,120 --> 00:12:33,839
will start recording your time when you

328
00:12:33,839 --> 00:12:36,320
finish you just click stop

329
00:12:36,320 --> 00:12:39,040
and yeah this is the project and each

330
00:12:39,040 --> 00:12:39,920
week

331
00:12:39,920 --> 00:12:42,160
and how much i did

332
00:12:42,160 --> 00:12:44,959
so the results are the following

333
00:12:44,959 --> 00:12:48,000
i spent 29 hours on that target

334
00:12:48,000 --> 00:12:50,480
and i scored only three digits i didn't

335
00:12:50,480 --> 00:12:52,639
make it to four digits which is one

336
00:12:52,639 --> 00:12:54,160
thousand dollars

337
00:12:54,160 --> 00:12:56,320
probably i lost the battle but i know

338
00:12:56,320 --> 00:13:00,639
that i will one will want war for sure

339
00:13:00,639 --> 00:13:02,880
actually i didn't lose what i actually

340
00:13:02,880 --> 00:13:05,839
want from this sprint is cash recondara

341
00:13:05,839 --> 00:13:08,639
i want knowledge i made connections with

342
00:13:08,639 --> 00:13:10,800
the triagers and i successfully managed

343
00:13:10,800 --> 00:13:13,920
my time in exams period just making mind

344
00:13:13,920 --> 00:13:16,240
that i did this while preparing for

345
00:13:16,240 --> 00:13:18,720
exams

346
00:13:19,360 --> 00:13:21,920
to another secret subdomain gathering

347
00:13:21,920 --> 00:13:25,120
trick that nobody knows about

348
00:13:25,120 --> 00:13:27,839
as you everyone knows that websites use

349
00:13:27,839 --> 00:13:30,079
https for security

350
00:13:30,079 --> 00:13:33,440
and https have a relation with ssl

351
00:13:33,440 --> 00:13:34,639
certificates

352
00:13:34,639 --> 00:13:35,600
and

353
00:13:35,600 --> 00:13:37,600
these ssl certificates have a field

354
00:13:37,600 --> 00:13:39,600
which is called subject alternative

355
00:13:39,600 --> 00:13:40,560
names

356
00:13:40,560 --> 00:13:43,199
so what is subject alternative names or

357
00:13:43,199 --> 00:13:44,079
sam

358
00:13:44,079 --> 00:13:47,199
this field lets you make or register a

359
00:13:47,199 --> 00:13:49,920
lot of domain names or ip addresses that

360
00:13:49,920 --> 00:13:52,160
are going to be secured by the same ssl

361
00:13:52,160 --> 00:13:53,360
certificate

362
00:13:53,360 --> 00:13:55,360
and for example as you can see here this

363
00:13:55,360 --> 00:13:58,320
is youtube.com certificate and if we go

364
00:13:58,320 --> 00:14:00,880
to the subject alternative names section

365
00:14:00,880 --> 00:14:03,600
you will find a very big list of domains

366
00:14:03,600 --> 00:14:05,920
that are owned by google

367
00:14:05,920 --> 00:14:07,279
and uh

368
00:14:07,279 --> 00:14:11,120
yeah like urschin.com

369
00:14:11,120 --> 00:14:13,839
who knows that urchin is owned by google

370
00:14:13,839 --> 00:14:16,480
so you can just go there and

371
00:14:16,480 --> 00:14:17,839
hack

372
00:14:17,839 --> 00:14:20,480
like it's a less crowded area and

373
00:14:20,480 --> 00:14:22,800
definitely you will find something

374
00:14:22,800 --> 00:14:24,800
and

375
00:14:24,800 --> 00:14:27,600
it is always recommended to use this for

376
00:14:27,600 --> 00:14:30,399
a very wide scope target or a target

377
00:14:30,399 --> 00:14:32,880
that lets you hack on its acquisitions

378
00:14:32,880 --> 00:14:34,880
because if you find something which is

379
00:14:34,880 --> 00:14:37,199
in a third party application or an out

380
00:14:37,199 --> 00:14:39,440
of scope application they will not pay

381
00:14:39,440 --> 00:14:40,880
you

382
00:14:40,880 --> 00:14:43,440
and you can use an ip address approach

383
00:14:43,440 --> 00:14:44,639
for this

384
00:14:44,639 --> 00:14:45,800
using

385
00:14:45,800 --> 00:14:48,399
bgp.he.net which is a search engine

386
00:14:48,399 --> 00:14:50,959
search engine for asn or autonomous

387
00:14:50,959 --> 00:14:52,560
system numbers

388
00:14:52,560 --> 00:14:54,399
and you just write the name of the

389
00:14:54,399 --> 00:14:56,399
company for example tesla and it will

390
00:14:56,399 --> 00:14:58,160
give you all of the asn that are

391
00:14:58,160 --> 00:15:00,639
registered for that company

392
00:15:00,639 --> 00:15:03,199
and you can just pick that number the

393
00:15:03,199 --> 00:15:06,720
asn and put it in aslookup.com

394
00:15:06,720 --> 00:15:09,040
and it will translate that number to a

395
00:15:09,040 --> 00:15:11,360
ip address blocks or a list of ip

396
00:15:11,360 --> 00:15:12,880
address blocks

397
00:15:12,880 --> 00:15:14,800
and for the last part you can automate

398
00:15:14,800 --> 00:15:17,440
it using your favorite language such as

399
00:15:17,440 --> 00:15:19,440
bash python

400
00:15:19,440 --> 00:15:22,560
or ruby anything that you like

401
00:15:22,560 --> 00:15:24,480
and you've got for yourself a fresh

402
00:15:24,480 --> 00:15:26,480
subdomains list that is most probably

403
00:15:26,480 --> 00:15:28,959
missed by most of the hunters you just

404
00:15:28,959 --> 00:15:30,800
pick a domain or a pro

405
00:15:30,800 --> 00:15:34,399
sub domain and start the house

406
00:15:34,399 --> 00:15:36,560
yeah this is the note that i've covered

407
00:15:36,560 --> 00:15:39,560
before

408
00:15:40,000 --> 00:15:42,720
uh so when you talk to a server it's

409
00:15:42,720 --> 00:15:45,680
like you are talking to a stranger and

410
00:15:45,680 --> 00:15:48,000
as i see right now in some eyes that you

411
00:15:48,000 --> 00:15:49,600
are confused because there's some

412
00:15:49,600 --> 00:15:51,920
chinese in the slides uh actually i

413
00:15:51,920 --> 00:15:54,240
forgot what i translated here so if

414
00:15:54,240 --> 00:15:57,279
someone is can speak chinese he will

415
00:15:57,279 --> 00:16:00,160
he can help us after the talk

416
00:16:00,160 --> 00:16:01,040
but

417
00:16:01,040 --> 00:16:02,800
why i did this actually i did it on

418
00:16:02,800 --> 00:16:05,600
purpose to make you confused so

419
00:16:05,600 --> 00:16:07,519
as you can see here this little guy is

420
00:16:07,519 --> 00:16:09,920
brute forcing a server that has asp

421
00:16:09,920 --> 00:16:12,320
files using a php word list

422
00:16:12,320 --> 00:16:14,480
so the server will actually feel like

423
00:16:14,480 --> 00:16:16,560
you felt right now when i showed the

424
00:16:16,560 --> 00:16:19,199
chinese slide it will understand nothing

425
00:16:19,199 --> 00:16:22,720
and will return just 404 not found

426
00:16:22,720 --> 00:16:24,240
results so

427
00:16:24,240 --> 00:16:26,320
you have to always fingerprint your

428
00:16:26,320 --> 00:16:28,320
server you are dealing with and know

429
00:16:28,320 --> 00:16:31,120
which technology or which language that

430
00:16:31,120 --> 00:16:32,720
it runs

431
00:16:32,720 --> 00:16:35,199
just a simple

432
00:16:35,199 --> 00:16:37,920
control you and you will find out what

433
00:16:37,920 --> 00:16:39,920
it uses or there are some extensions

434
00:16:39,920 --> 00:16:41,519
like vapolizer

435
00:16:41,519 --> 00:16:43,839
that shows a lot of

436
00:16:43,839 --> 00:16:45,519
things that are useful on the server

437
00:16:45,519 --> 00:16:47,920
like the language or

438
00:16:47,920 --> 00:16:49,600
yeah

439
00:16:49,600 --> 00:16:52,160
some wordless tips you build your own

440
00:16:52,160 --> 00:16:53,600
word lists

441
00:16:53,600 --> 00:16:55,360
don't rely on the others that already

442
00:16:55,360 --> 00:16:58,399
built and this helps a lot in the future

443
00:16:58,399 --> 00:17:00,720
save endpoints from disclosed reports

444
00:17:00,720 --> 00:17:03,600
such as hacker1 slash activity there are

445
00:17:03,600 --> 00:17:05,760
a lot of disclosed endpoints that you

446
00:17:05,760 --> 00:17:08,000
can save in a new word list

447
00:17:08,000 --> 00:17:11,039
you can always fetch pads from js files

448
00:17:11,039 --> 00:17:13,439
using for example link finder which is a

449
00:17:13,439 --> 00:17:15,760
tool that does this from github

450
00:17:15,760 --> 00:17:18,079
or you can spider the web application

451
00:17:18,079 --> 00:17:19,679
and save the output

452
00:17:19,679 --> 00:17:22,079
and the burps with professional edition

453
00:17:22,079 --> 00:17:23,520
does this

454
00:17:23,520 --> 00:17:24,959
or if you don't have burps with

455
00:17:24,959 --> 00:17:27,359
professional you can just use some tool

456
00:17:27,359 --> 00:17:29,520
on github and you will get the same

457
00:17:29,520 --> 00:17:31,360
result

458
00:17:31,360 --> 00:17:34,240
so uh

459
00:17:34,240 --> 00:17:36,160
by coincidence the previous talk was

460
00:17:36,160 --> 00:17:38,880
about injections and uh right now i will

461
00:17:38,880 --> 00:17:40,880
talk about an sql injection that i

462
00:17:40,880 --> 00:17:43,600
recent not recently but i found some

463
00:17:43,600 --> 00:17:46,240
months ago

464
00:17:46,320 --> 00:17:48,880
i just picked the target and i started

465
00:17:48,880 --> 00:17:51,280
looking for the less crowded areas and

466
00:17:51,280 --> 00:17:52,320
domains

467
00:17:52,320 --> 00:17:55,120
i put wikipedia space the name of the

468
00:17:55,120 --> 00:17:57,120
target on google

469
00:17:57,120 --> 00:17:59,200
then i went to the wikipedia page of

470
00:17:59,200 --> 00:18:02,000
that target and i searched for the list

471
00:18:02,000 --> 00:18:04,160
of acquisitions that are owned by that

472
00:18:04,160 --> 00:18:05,840
target

473
00:18:05,840 --> 00:18:07,919
you can use many other services for this

474
00:18:07,919 --> 00:18:10,000
not just wikipedia

475
00:18:10,000 --> 00:18:11,919
and i found the seed which is controlled

476
00:18:11,919 --> 00:18:13,919
by the same company say for example

477
00:18:13,919 --> 00:18:16,480
target ebcd.com

478
00:18:16,480 --> 00:18:18,559
and now let's do some subdomain

479
00:18:18,559 --> 00:18:20,640
enumeration

480
00:18:20,640 --> 00:18:23,280
and a tip for alive subdomains i

481
00:18:23,280 --> 00:18:26,080
personally use the tool https using the

482
00:18:26,080 --> 00:18:28,880
following flags

483
00:18:28,880 --> 00:18:32,720
httpx by the way is a tool that does

484
00:18:32,720 --> 00:18:36,160
http probing on a subdomains list

485
00:18:36,160 --> 00:18:38,160
so

486
00:18:38,160 --> 00:18:39,440
that's okay

487
00:18:39,440 --> 00:18:41,440
whenever it runs over

488
00:18:41,440 --> 00:18:43,520
subdomains it will check if it's alive

489
00:18:43,520 --> 00:18:45,760
or not and it's a tool by project

490
00:18:45,760 --> 00:18:48,559
discovery and it's so fast so i

491
00:18:48,559 --> 00:18:50,240
recommend using it

492
00:18:50,240 --> 00:18:52,880
and i use it with the following

493
00:18:52,880 --> 00:18:55,520
options or tags tag title for the title

494
00:18:55,520 --> 00:18:59,200
of the webpage status code of the http

495
00:18:59,200 --> 00:19:01,760
response the content length in bytes of

496
00:19:01,760 --> 00:19:04,480
the page and follow redirects if there

497
00:19:04,480 --> 00:19:06,480
are any

498
00:19:06,480 --> 00:19:08,799
so this was the output of subfinder and

499
00:19:08,799 --> 00:19:11,200
edge and httpx on the target that i

500
00:19:11,200 --> 00:19:13,280
found in the acquisitions page

501
00:19:13,280 --> 00:19:14,320
and

502
00:19:14,320 --> 00:19:16,480
as you can see in the first line of the

503
00:19:16,480 --> 00:19:19,200
output there's a subdomain which ends

504
00:19:19,200 --> 00:19:20,039
with

505
00:19:20,039 --> 00:19:22,960
index.jsp after the redirect there's a

506
00:19:22,960 --> 00:19:25,360
302 300 and 200

507
00:19:25,360 --> 00:19:27,360
so i just decided to hack on that

508
00:19:27,360 --> 00:19:29,440
subdomain

509
00:19:29,440 --> 00:19:32,000
it gave a login panel and this was the

510
00:19:32,000 --> 00:19:33,440
example of the structure of the

511
00:19:33,440 --> 00:19:35,919
subdomain and the login panel had two

512
00:19:35,919 --> 00:19:38,720
inputs username and password

513
00:19:38,720 --> 00:19:41,679
i tested everything on that login panel

514
00:19:41,679 --> 00:19:44,320
or login field like sql injection code

515
00:19:44,320 --> 00:19:46,400
injection xss

516
00:19:46,400 --> 00:19:48,480
default credentials like admin admin

517
00:19:48,480 --> 00:19:50,799
admin password but

518
00:19:50,799 --> 00:19:53,200
i wasn't really successful i also

519
00:19:53,200 --> 00:19:55,520
checked the source code of the webpage i

520
00:19:55,520 --> 00:19:57,919
read javascript files but i found

521
00:19:57,919 --> 00:19:58,960
nothing

522
00:19:58,960 --> 00:20:01,760
did i surrender of course no i went to

523
00:20:01,760 --> 00:20:03,840
the burp suite log

524
00:20:03,840 --> 00:20:05,440
this was an actual screenshot of the

525
00:20:05,440 --> 00:20:06,799
login panel

526
00:20:06,799 --> 00:20:07,679
and

527
00:20:07,679 --> 00:20:09,600
as you can see there there's a post

528
00:20:09,600 --> 00:20:11,200
request sent to

529
00:20:11,200 --> 00:20:14,320
slash a2a slash redacted slash a2a

530
00:20:14,320 --> 00:20:15,840
underscore token

531
00:20:15,840 --> 00:20:18,640
and the three parameters were user id

532
00:20:18,640 --> 00:20:22,400
password and organization

533
00:20:22,400 --> 00:20:25,520
so i sent the http request to sql map

534
00:20:25,520 --> 00:20:28,400
and i continued my testing

535
00:20:28,400 --> 00:20:30,880
and while analyzing the request on burp

536
00:20:30,880 --> 00:20:33,440
suite i noticed that there's the word

537
00:20:33,440 --> 00:20:36,159
token in the path a to a underscore

538
00:20:36,159 --> 00:20:39,200
token so there is a token exchange in

539
00:20:39,200 --> 00:20:40,000
the

540
00:20:40,000 --> 00:20:42,159
logic of the application

541
00:20:42,159 --> 00:20:44,320
so i had to understand what's going on

542
00:20:44,320 --> 00:20:46,320
so the post request gives the following

543
00:20:46,320 --> 00:20:49,760
response which was a 302 find found to

544
00:20:49,760 --> 00:20:52,000
another subdomain subdomain which is

545
00:20:52,000 --> 00:20:55,320
called a2hs.target.com

546
00:20:57,039 --> 00:21:00,559
sql map gave nothing on the first try so

547
00:21:00,559 --> 00:21:03,840
i had to continue my digging and for

548
00:21:03,840 --> 00:21:07,280
this subdomain which was a2hs.target.com

549
00:21:07,280 --> 00:21:09,440
after some redirects it gets back to the

550
00:21:09,440 --> 00:21:11,280
first subdomain with the login error

551
00:21:11,280 --> 00:21:13,200
message that your credentials are not

552
00:21:13,200 --> 00:21:15,039
valid

553
00:21:15,039 --> 00:21:17,840
sorry

554
00:21:27,120 --> 00:21:30,640
uh yeah so this is interesting the token

555
00:21:30,640 --> 00:21:32,559
is fetched from another subdomain which

556
00:21:32,559 --> 00:21:34,799
was a blank page i went to the sub

557
00:21:34,799 --> 00:21:37,440
domain and i found nothing there so most

558
00:21:37,440 --> 00:21:39,200
probably it wasn't

559
00:21:39,200 --> 00:21:41,440
an unfinished tickets by the developers

560
00:21:41,440 --> 00:21:43,520
that they just

561
00:21:43,520 --> 00:21:46,320
make that server respond with a black

562
00:21:46,320 --> 00:21:48,320
blank page but in the back end there's

563
00:21:48,320 --> 00:21:50,960
some talking processing and there's no

564
00:21:50,960 --> 00:21:52,960
trace for that subdomain on the

565
00:21:52,960 --> 00:21:56,640
javascript files of the first sub domain

566
00:21:56,640 --> 00:21:58,400
and this was the big picture of the

567
00:21:58,400 --> 00:22:01,440
logic of the panel the login panel the

568
00:22:01,440 --> 00:22:03,280
post request is sent there

569
00:22:03,280 --> 00:22:06,280
a2a.target.com

570
00:22:06,320 --> 00:22:08,960
a2a underscore token and the token is

571
00:22:08,960 --> 00:22:11,200
fetched from the second subdomain which

572
00:22:11,200 --> 00:22:12,280
was

573
00:22:12,280 --> 00:22:13,840
a2hs.target.com

574
00:22:13,840 --> 00:22:15,760
if the token is valid it will return

575
00:22:15,760 --> 00:22:17,919
back to the first subdomain and it will

576
00:22:17,919 --> 00:22:20,880
grant you access

577
00:22:20,960 --> 00:22:24,080
so this was the first url that the post

578
00:22:24,080 --> 00:22:27,280
request is sent to and i thought

579
00:22:27,280 --> 00:22:29,760
if we have a sub domain what if we just

580
00:22:29,760 --> 00:22:32,480
don't put it as a directory and see what

581
00:22:32,480 --> 00:22:33,840
will happen

582
00:22:33,840 --> 00:22:36,799
and big surprise i got a new login panel

583
00:22:36,799 --> 00:22:39,120
which looks older and i felt it was

584
00:22:39,120 --> 00:22:42,720
vulnerable to any sql injection

585
00:22:42,720 --> 00:22:45,360
same fields as the first one i inserted

586
00:22:45,360 --> 00:22:46,720
single quotes

587
00:22:46,720 --> 00:22:49,520
and same parameters as you can see test

588
00:22:49,520 --> 00:22:51,440
single quote and

589
00:22:51,440 --> 00:22:52,880
see the response

590
00:22:52,880 --> 00:22:55,840
it's a 500 internal server error so

591
00:22:55,840 --> 00:22:57,679
definitely there's an sql injection

592
00:22:57,679 --> 00:22:58,880
there

593
00:22:58,880 --> 00:23:01,919
i tried normally to craft some

594
00:23:01,919 --> 00:23:04,320
payloads but that didn't work so i just

595
00:23:04,320 --> 00:23:06,840
copied that and sent it to sql map for

596
00:23:06,840 --> 00:23:09,840
automation and after 10 minutes i was

597
00:23:09,840 --> 00:23:11,760
already in i've got the whole dump of

598
00:23:11,760 --> 00:23:13,919
the database

599
00:23:13,919 --> 00:23:15,600
so

600
00:23:15,600 --> 00:23:17,280
the form was vulnerable to any

601
00:23:17,280 --> 00:23:19,520
error-based disqual injection where the

602
00:23:19,520 --> 00:23:21,200
database sold a lot of sensitive

603
00:23:21,200 --> 00:23:22,640
information

604
00:23:22,640 --> 00:23:25,120
and i tried to escalate it to an rce

605
00:23:25,120 --> 00:23:27,280
using the oshel tag but i wasn't

606
00:23:27,280 --> 00:23:29,760
successful so i just decided to stop

607
00:23:29,760 --> 00:23:31,600
here and report the injection to the

608
00:23:31,600 --> 00:23:33,760
program

609
00:23:33,760 --> 00:23:35,840
and that was the story of how i found

610
00:23:35,840 --> 00:23:38,000
the sql injection in one hour of good

611
00:23:38,000 --> 00:23:40,480
recon here are some takeaways you should

612
00:23:40,480 --> 00:23:42,559
always think of ways that others could

613
00:23:42,559 --> 00:23:44,960
have missed don't follow the crowd

614
00:23:44,960 --> 00:23:47,039
always be unique and go to a different

615
00:23:47,039 --> 00:23:47,840
path

616
00:23:47,840 --> 00:23:50,159
burp suit on the background always helps

617
00:23:50,159 --> 00:23:52,320
so if you just go back and analyze the

618
00:23:52,320 --> 00:23:54,640
requests and the responses you will

619
00:23:54,640 --> 00:23:57,120
definitely find something which is juicy

620
00:23:57,120 --> 00:23:59,039
and can make your money

621
00:23:59,039 --> 00:24:01,600
and put more time on something only if

622
00:24:01,600 --> 00:24:04,480
you feel that it's worth it don't just

623
00:24:04,480 --> 00:24:06,640
waste time on something and

624
00:24:06,640 --> 00:24:08,400
find nothing in the end

625
00:24:08,400 --> 00:24:10,720
and automate anything that the machine

626
00:24:10,720 --> 00:24:12,640
can do for you don't be like that cat

627
00:24:12,640 --> 00:24:14,799
that i showed before

628
00:24:14,799 --> 00:24:18,000
and yeah this is the end of my talk if

629
00:24:18,000 --> 00:24:20,400
you have any questions feel free to ask

630
00:24:20,400 --> 00:24:23,039
this is my twitter handler if you have

631
00:24:23,039 --> 00:24:24,799
any question in the future don't

632
00:24:24,799 --> 00:24:28,200
hesitate to ask me thank you

633
00:24:28,200 --> 00:24:33,200
[Applause]

634
00:24:33,200 --> 00:24:34,720
do we have any

635
00:24:34,720 --> 00:24:38,159
questions for kellie

636
00:24:39,840 --> 00:24:42,720
it would appear perhaps

637
00:24:42,720 --> 00:24:43,760
not

638
00:24:43,760 --> 00:24:46,799
uh you can always ask a question uh

639
00:24:46,799 --> 00:24:48,559
when we finish if you

640
00:24:48,559 --> 00:24:53,720
catch him khalil once again thank you

