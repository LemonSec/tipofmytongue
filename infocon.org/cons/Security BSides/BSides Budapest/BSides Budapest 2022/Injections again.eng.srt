1
00:00:08,080 --> 00:00:10,960
yeah my company

2
00:00:11,280 --> 00:00:13,360
ladies and gentlemen uh our next speaker

3
00:00:13,360 --> 00:00:15,839
is mark modly he'll be asking questions

4
00:00:15,839 --> 00:00:19,359
regarding injections

5
00:00:19,359 --> 00:00:21,680
all right everybody i hope that we are

6
00:00:21,680 --> 00:00:23,920
not that tired so we could pay a little

7
00:00:23,920 --> 00:00:26,160
attention today as well at the end of

8
00:00:26,160 --> 00:00:27,199
the day

9
00:00:27,199 --> 00:00:28,840
so

10
00:00:28,840 --> 00:00:32,159
injections uh i believe that we've heard

11
00:00:32,159 --> 00:00:33,440
quite a lot

12
00:00:33,440 --> 00:00:36,480
of injections in the past two years i

13
00:00:36,480 --> 00:00:39,200
would say i guess i read more articles

14
00:00:39,200 --> 00:00:41,120
in the two years

15
00:00:41,120 --> 00:00:44,960
uh than ever before about injections but

16
00:00:44,960 --> 00:00:47,200
today we should not really talk about

17
00:00:47,200 --> 00:00:49,440
these kind of induction injections

18
00:00:49,440 --> 00:00:52,559
and have a little bit of talk

19
00:00:52,559 --> 00:00:56,800
about the ovus category injection so my

20
00:00:56,800 --> 00:00:59,520
name is mark moodley i really love to

21
00:00:59,520 --> 00:01:00,320
teach

22
00:01:00,320 --> 00:01:01,520
and

23
00:01:01,520 --> 00:01:04,559
before the actual presentation they told

24
00:01:04,559 --> 00:01:07,760
me that good presentation has got three

25
00:01:07,760 --> 00:01:10,560
key ingredients one of them that it is

26
00:01:10,560 --> 00:01:12,960
short the other one it is not really

27
00:01:12,960 --> 00:01:16,000
long and the third one that it ends soon

28
00:01:16,000 --> 00:01:19,040
so i'm going to start uh by saying that

29
00:01:19,040 --> 00:01:21,040
or promising that that i'm going to

30
00:01:21,040 --> 00:01:22,080
shorten

31
00:01:22,080 --> 00:01:24,640
my presentation in order to fit the time

32
00:01:24,640 --> 00:01:26,960
frame that we've got over here

33
00:01:26,960 --> 00:01:28,320
so

34
00:01:28,320 --> 00:01:29,920
i do not really like to talk about

35
00:01:29,920 --> 00:01:32,880
myself in these kind of situations the

36
00:01:32,880 --> 00:01:35,680
people who met me during lunch big day

37
00:01:35,680 --> 00:01:39,360
know that i'm quite talkative so after

38
00:01:39,360 --> 00:01:40,880
the

39
00:01:40,880 --> 00:01:43,200
little presentation feel free to reach

40
00:01:43,200 --> 00:01:45,439
out we could have a little talk and

41
00:01:45,439 --> 00:01:48,320
after midnight we can leave as well so

42
00:01:48,320 --> 00:01:50,960
uh besides us uh

43
00:01:50,960 --> 00:01:53,680
besides pun intended uh there is another

44
00:01:53,680 --> 00:01:55,200
company or

45
00:01:55,200 --> 00:01:57,600
i would say organization which is quite

46
00:01:57,600 --> 00:02:01,360
fond of injections and this logo should

47
00:02:01,360 --> 00:02:03,520
help us out as well

48
00:02:03,520 --> 00:02:05,040
so uh

49
00:02:05,040 --> 00:02:07,360
what is this organization

50
00:02:07,360 --> 00:02:09,840
this is called the ovas the open web

51
00:02:09,840 --> 00:02:12,959
application security project and

52
00:02:12,959 --> 00:02:14,000
they

53
00:02:14,000 --> 00:02:16,239
have quite a few

54
00:02:16,239 --> 00:02:18,879
projects i would say which i really

55
00:02:18,879 --> 00:02:22,800
adore and one of those is the overstock

56
00:02:22,800 --> 00:02:25,440
10. i really like the thread dragon

57
00:02:25,440 --> 00:02:27,599
which is a threat modeling tool provided

58
00:02:27,599 --> 00:02:31,120
by august completely free and the zed

59
00:02:31,120 --> 00:02:34,080
attack proxy codes up as well but i

60
00:02:34,080 --> 00:02:36,319
really like this project because it sums

61
00:02:36,319 --> 00:02:38,160
up the

62
00:02:38,160 --> 00:02:41,120
most recent vulnerabilities i would say

63
00:02:41,120 --> 00:02:44,319
uh and therefore

64
00:02:44,319 --> 00:02:46,720
it is always a good point to have a

65
00:02:46,720 --> 00:02:49,760
picture about the current stance of the

66
00:02:49,760 --> 00:02:52,800
i.t security or the web word i would say

67
00:02:52,800 --> 00:02:57,440
so in the most recent of us top 10

68
00:02:57,440 --> 00:03:00,400
release it was actually last year in

69
00:03:00,400 --> 00:03:02,400
2021

70
00:03:02,400 --> 00:03:05,680
we've got a completely new uh topic

71
00:03:05,680 --> 00:03:08,080
which is called injection nobody ever

72
00:03:08,080 --> 00:03:11,120
heard about it right

73
00:03:11,599 --> 00:03:15,599
no that's right who said no

74
00:03:15,599 --> 00:03:16,800
may

75
00:03:16,800 --> 00:03:20,000
the duck bee video please

76
00:03:20,000 --> 00:03:23,120
give it a so uh

77
00:03:23,120 --> 00:03:25,440
it wasn't introduced last year but it

78
00:03:25,440 --> 00:03:29,920
was introduced the year before right

79
00:03:29,920 --> 00:03:31,760
where is there was the other note coming

80
00:03:31,760 --> 00:03:33,840
from

81
00:03:33,920 --> 00:03:36,400
all right i've got a few of them so be

82
00:03:36,400 --> 00:03:37,840
prepared

83
00:03:37,840 --> 00:03:40,159
all right so it wasn't introduced in

84
00:03:40,159 --> 00:03:42,000
2017

85
00:03:42,000 --> 00:03:45,879
what year was it introduced

86
00:03:46,080 --> 00:03:48,239
uh

87
00:03:48,239 --> 00:03:50,720
no we are getting closer and closer but

88
00:03:50,720 --> 00:03:53,280
it still wasn't uh introduced in this

89
00:03:53,280 --> 00:03:56,560
year and i believe it wasn't introduced

90
00:03:56,560 --> 00:03:58,959
in this year as well but in the meantime

91
00:03:58,959 --> 00:04:01,840
you've got your duck as well so

92
00:04:01,840 --> 00:04:03,040
let's see

93
00:04:03,040 --> 00:04:04,480
uh

94
00:04:04,480 --> 00:04:06,879
was it introduced this year

95
00:04:06,879 --> 00:04:10,640
we are getting tougher and tougher

96
00:04:10,640 --> 00:04:13,200
and the answer to that is still freaking

97
00:04:13,200 --> 00:04:17,199
no so basically the injection uh was

98
00:04:17,199 --> 00:04:19,000
introduced in

99
00:04:19,000 --> 00:04:20,560
2003

100
00:04:20,560 --> 00:04:22,800
is there anybody in the audience who was

101
00:04:22,800 --> 00:04:27,400
born after this date

102
00:04:28,080 --> 00:04:29,360
ahead

103
00:04:29,360 --> 00:04:30,400
so

104
00:04:30,400 --> 00:04:33,759
as you can see if a vulnerability is

105
00:04:33,759 --> 00:04:36,800
freaking older than some of the audience

106
00:04:36,800 --> 00:04:39,520
there is something clearly going on

107
00:04:39,520 --> 00:04:40,560
right

108
00:04:40,560 --> 00:04:43,199
yeah i heard it right

109
00:04:43,199 --> 00:04:44,880
so uh

110
00:04:44,880 --> 00:04:47,040
we could talk about a lot of kinds of

111
00:04:47,040 --> 00:04:49,840
injections and

112
00:04:49,840 --> 00:04:52,080
i brought here a few

113
00:04:52,080 --> 00:04:56,479
but to be more current today we had

114
00:04:56,479 --> 00:04:58,320
pretty amazing

115
00:04:58,320 --> 00:05:00,400
actually quite amazing

116
00:05:00,400 --> 00:05:04,080
uh talks and two of them stood out for

117
00:05:04,080 --> 00:05:06,880
me uh because of the mentions of

118
00:05:06,880 --> 00:05:10,880
injections one of those was with our arp

119
00:05:10,880 --> 00:05:12,080
injection

120
00:05:12,080 --> 00:05:14,560
basically route injection and that's

121
00:05:14,560 --> 00:05:16,800
quite amazing that we talked about and

122
00:05:16,800 --> 00:05:19,199
it is still not on the slide

123
00:05:19,199 --> 00:05:21,360
the other topic that we've had

124
00:05:21,360 --> 00:05:24,479
was the first github issues

125
00:05:24,479 --> 00:05:26,639
do we remember what the issue was with

126
00:05:26,639 --> 00:05:31,199
the github i guess pipeline or runners

127
00:05:31,199 --> 00:05:34,400
what injection was there

128
00:05:34,479 --> 00:05:36,400
it was a command injection

129
00:05:36,400 --> 00:05:41,039
all right so uh we've got quite a lot

130
00:05:41,039 --> 00:05:43,120
of injections around us

131
00:05:43,120 --> 00:05:45,520
what the hell is on the screen is there

132
00:05:45,520 --> 00:05:48,719
anybody who could tell me

133
00:05:50,960 --> 00:05:52,720
go ahead

134
00:05:52,720 --> 00:05:56,000
it is actually a tree injection

135
00:05:56,000 --> 00:05:58,880
or it is called a trunk injection in

136
00:05:58,880 --> 00:06:00,000
sometimes

137
00:06:00,000 --> 00:06:02,240
so

138
00:06:02,240 --> 00:06:06,560
is there anybody who's got closer to the

139
00:06:06,560 --> 00:06:09,680
definition what injection is at freaking

140
00:06:09,680 --> 00:06:11,919
over

141
00:06:14,240 --> 00:06:16,479
i'm not surprised by the lack of fans

142
00:06:16,479 --> 00:06:19,440
over over there in the audience

143
00:06:19,440 --> 00:06:20,479
so

144
00:06:20,479 --> 00:06:22,960
what on earth are injections at all so

145
00:06:22,960 --> 00:06:25,680
basically we start to say everything is

146
00:06:25,680 --> 00:06:28,000
an injection right

147
00:06:28,000 --> 00:06:29,840
i believe that

148
00:06:29,840 --> 00:06:31,680
we do not really have

149
00:06:31,680 --> 00:06:34,400
any clear-cut definition on injection

150
00:06:34,400 --> 00:06:38,479
itself so i've came up or actually

151
00:06:38,479 --> 00:06:40,720
with the team we've came up

152
00:06:40,720 --> 00:06:41,680
with two

153
00:06:41,680 --> 00:06:44,880
those two definitions which could shed

154
00:06:44,880 --> 00:06:47,919
some light on what we call injections

155
00:06:47,919 --> 00:06:50,240
like data escaping to the contour

156
00:06:50,240 --> 00:06:52,960
control flow that's something that we

157
00:06:52,960 --> 00:06:55,520
would say that's right

158
00:06:55,520 --> 00:06:57,840
basically if we are talking about for

159
00:06:57,840 --> 00:07:00,720
example gpqr java persistence query

160
00:07:00,720 --> 00:07:04,240
language injections that's mostly true

161
00:07:04,240 --> 00:07:07,039
as well we could talk about unexpected

162
00:07:07,039 --> 00:07:08,160
input

163
00:07:08,160 --> 00:07:10,880
content or with side effects on the

164
00:07:10,880 --> 00:07:12,880
application or inside the application

165
00:07:12,880 --> 00:07:13,919
itself

166
00:07:13,919 --> 00:07:14,960
i'm

167
00:07:14,960 --> 00:07:17,599
quite all right with these definitions

168
00:07:17,599 --> 00:07:19,520
the ovus

169
00:07:19,520 --> 00:07:21,440
foundation

170
00:07:21,440 --> 00:07:24,800
uses kind of a different

171
00:07:24,800 --> 00:07:26,240
explanation

172
00:07:26,240 --> 00:07:30,000
to this topic which is injection occurs

173
00:07:30,000 --> 00:07:32,319
when untrusted data is sent to an

174
00:07:32,319 --> 00:07:35,199
interpreter as part of a command or a

175
00:07:35,199 --> 00:07:36,960
query well

176
00:07:36,960 --> 00:07:39,440
i honestly do not really like like this

177
00:07:39,440 --> 00:07:42,639
definition uh because sometimes there

178
00:07:42,639 --> 00:07:45,759
are no actual

179
00:07:45,759 --> 00:07:48,960
parser that's involved in that as we've

180
00:07:48,960 --> 00:07:52,960
seen today in the arp uh poisoning or

181
00:07:52,960 --> 00:07:55,840
the our crowd injection there is no

182
00:07:55,840 --> 00:07:59,599
actual processing there which is

183
00:07:59,599 --> 00:08:01,840
i would say different or would be

184
00:08:01,840 --> 00:08:04,560
different if we sanitize that data that

185
00:08:04,560 --> 00:08:06,240
is completely changed

186
00:08:06,240 --> 00:08:08,160
so uh

187
00:08:08,160 --> 00:08:10,720
let's agree that

188
00:08:10,720 --> 00:08:13,840
i do not really want to define injection

189
00:08:13,840 --> 00:08:16,400
itself but just last and let's agree

190
00:08:16,400 --> 00:08:18,720
that it has to do

191
00:08:18,720 --> 00:08:20,479
something at least

192
00:08:20,479 --> 00:08:23,280
with the unexpectedness of the input

193
00:08:23,280 --> 00:08:25,840
that we are working on or

194
00:08:25,840 --> 00:08:28,400
yeah it has at least side effects

195
00:08:28,400 --> 00:08:29,520
so

196
00:08:29,520 --> 00:08:30,879
of us

197
00:08:30,879 --> 00:08:34,799
uh ovas is merging topics into injection

198
00:08:34,799 --> 00:08:37,519
in the most recent change if you uh take

199
00:08:37,519 --> 00:08:40,159
a look at that i know that it is blurry

200
00:08:40,159 --> 00:08:41,919
uh but

201
00:08:41,919 --> 00:08:43,599
if you are familiar

202
00:08:43,599 --> 00:08:46,160
with the ovus topics that in that now

203
00:08:46,160 --> 00:08:48,080
you should know that basically

204
00:08:48,080 --> 00:08:50,959
cross-site scripting got merged into

205
00:08:50,959 --> 00:08:53,360
injection as well

206
00:08:53,360 --> 00:08:55,519
for me that's ca that's kind of a

207
00:08:55,519 --> 00:08:56,720
strange

208
00:08:56,720 --> 00:08:59,600
behavior or decision and let me tell you

209
00:08:59,600 --> 00:09:01,120
a little story

210
00:09:01,120 --> 00:09:02,920
in

211
00:09:02,920 --> 00:09:06,240
2002 i believe

212
00:09:06,240 --> 00:09:08,399
i i created

213
00:09:08,399 --> 00:09:10,560
a content management system because

214
00:09:10,560 --> 00:09:13,519
their php was all the rage and web 2 was

215
00:09:13,519 --> 00:09:15,680
something that everyone was like quite

216
00:09:15,680 --> 00:09:18,240
looking into and uh we were taking a

217
00:09:18,240 --> 00:09:21,200
look at that wow this new web thing is

218
00:09:21,200 --> 00:09:23,440
shiny and everything i know i'm old as

219
00:09:23,440 --> 00:09:24,800
hell and i was running with the

220
00:09:24,800 --> 00:09:27,120
dinosaurs at one point i can see from

221
00:09:27,120 --> 00:09:29,600
the eyes of the audience but yeah

222
00:09:29,600 --> 00:09:32,959
basically uh that point we were creating

223
00:09:32,959 --> 00:09:36,240
the web and we were quite fond of that

224
00:09:36,240 --> 00:09:37,760
stuff

225
00:09:37,760 --> 00:09:40,480
one day my created content management

226
00:09:40,480 --> 00:09:44,320
system was hacked by none else but my

227
00:09:44,320 --> 00:09:46,800
close friend and he told me that he's

228
00:09:46,800 --> 00:09:48,000
done that

229
00:09:48,000 --> 00:09:50,399
in a way that he was able to embed

230
00:09:50,399 --> 00:09:54,160
javascript in one of the uh codes that

231
00:09:54,160 --> 00:09:56,720
he was allowed to written because it was

232
00:09:56,720 --> 00:09:59,040
so sophisticated that it had different

233
00:09:59,040 --> 00:10:01,440
privilege levels uh administers

234
00:10:01,440 --> 00:10:05,360
administrators and content creators and

235
00:10:05,360 --> 00:10:08,640
he was able to stall the contents of my

236
00:10:08,640 --> 00:10:09,839
cookies

237
00:10:09,839 --> 00:10:12,640
and i was like all right

238
00:10:12,640 --> 00:10:16,240
back then there was no csp and

239
00:10:16,240 --> 00:10:18,720
http only cookies

240
00:10:18,720 --> 00:10:21,279
such fancy things didn't really exist

241
00:10:21,279 --> 00:10:24,640
then and basically uh we wouldn't even

242
00:10:24,640 --> 00:10:25,680
uh

243
00:10:25,680 --> 00:10:28,000
mention that

244
00:10:28,000 --> 00:10:30,959
cross site resource sharing

245
00:10:30,959 --> 00:10:32,880
who heard about those things back then

246
00:10:32,880 --> 00:10:35,200
basically those were non-existent

247
00:10:35,200 --> 00:10:36,079
and

248
00:10:36,079 --> 00:10:37,680
for me this is

249
00:10:37,680 --> 00:10:40,160
the point where i start to believe that

250
00:10:40,160 --> 00:10:42,560
injection is way broader than it should

251
00:10:42,560 --> 00:10:43,920
be so

252
00:10:43,920 --> 00:10:48,000
in 2003 the very first ovasp

253
00:10:48,000 --> 00:10:50,560
the very first over stockton uh

254
00:10:50,560 --> 00:10:53,279
mentioned the command injection flow

255
00:10:53,279 --> 00:10:56,640
the next year in 2004

256
00:10:56,640 --> 00:10:59,360
it got renamed the category post

257
00:10:59,360 --> 00:11:00,640
homelessly

258
00:11:00,640 --> 00:11:02,640
to injection flows

259
00:11:02,640 --> 00:11:04,720
because they broadened it in that year

260
00:11:04,720 --> 00:11:05,760
as well

261
00:11:05,760 --> 00:11:07,200
so

262
00:11:07,200 --> 00:11:10,160
in 2021

263
00:11:10,160 --> 00:11:12,800
it got just the category of injection

264
00:11:12,800 --> 00:11:14,959
and you could believe anything that's

265
00:11:14,959 --> 00:11:17,120
what's in there your application needs

266
00:11:17,120 --> 00:11:18,959
to be checked against the overstopped

267
00:11:18,959 --> 00:11:21,120
and issues because sometimes that's the

268
00:11:21,120 --> 00:11:23,600
criteria which is dumb in itself not to

269
00:11:23,600 --> 00:11:27,120
mention that but uh injection contains

270
00:11:27,120 --> 00:11:28,880
now almost everything that you could

271
00:11:28,880 --> 00:11:31,279
imagine we've heard today at least three

272
00:11:31,279 --> 00:11:34,480
or four topics that we're considering uh

273
00:11:34,480 --> 00:11:37,040
that could be considered as injection i

274
00:11:37,040 --> 00:11:39,040
would say so

275
00:11:39,040 --> 00:11:41,279
i've developed software quite a lot in

276
00:11:41,279 --> 00:11:43,519
my life and

277
00:11:43,519 --> 00:11:48,560
what ovasp is doing right now is similar

278
00:11:48,560 --> 00:11:51,120
when you've got a project manager who is

279
00:11:51,120 --> 00:11:53,519
unable to say no

280
00:11:53,519 --> 00:11:56,399
to new feature requests and basically

281
00:11:56,399 --> 00:11:59,279
like a snowball our injection is getting

282
00:11:59,279 --> 00:12:01,600
bigger and bigger and bigger we do not

283
00:12:01,600 --> 00:12:03,760
even know right now what injection

284
00:12:03,760 --> 00:12:06,160
consists of on on the slide we've seen

285
00:12:06,160 --> 00:12:08,560
like i don't know 10 20 or something

286
00:12:08,560 --> 00:12:11,839
like that of injections and we still

287
00:12:11,839 --> 00:12:14,320
haven't written everything over there

288
00:12:14,320 --> 00:12:16,880
there are quite a lot of things so this

289
00:12:16,880 --> 00:12:18,240
got me thinking

290
00:12:18,240 --> 00:12:20,160
what else could be considered as an

291
00:12:20,160 --> 00:12:22,800
injection which was on the overstocked

292
00:12:22,800 --> 00:12:24,399
and list quite

293
00:12:24,399 --> 00:12:25,519
recently

294
00:12:25,519 --> 00:12:29,120
and i would argue that

295
00:12:29,120 --> 00:12:31,600
what you can do you can consider

296
00:12:31,600 --> 00:12:34,480
uh xml external entity attacks as

297
00:12:34,480 --> 00:12:37,120
injections as well but of course we need

298
00:12:37,120 --> 00:12:41,519
to rename that topic into dtd injection

299
00:12:41,519 --> 00:12:42,560
because

300
00:12:42,560 --> 00:12:44,320
you are injecting

301
00:12:44,320 --> 00:12:48,399
document type definitions into that

302
00:12:49,040 --> 00:12:50,560
that's a point to that

303
00:12:50,560 --> 00:12:53,200
i would not really merge this topic into

304
00:12:53,200 --> 00:12:55,519
injection as well but

305
00:12:55,519 --> 00:12:57,279
yeah you could do so

306
00:12:57,279 --> 00:12:59,360
have you ever heard about request

307
00:12:59,360 --> 00:13:02,000
smuggling

308
00:13:02,399 --> 00:13:04,639
nice a few hands up

309
00:13:04,639 --> 00:13:07,200
all right would we rename request

310
00:13:07,200 --> 00:13:09,839
muggling into packet injection

311
00:13:09,839 --> 00:13:11,360
or something like that

312
00:13:11,360 --> 00:13:14,480
not that freaking all right

313
00:13:14,480 --> 00:13:18,000
i think this tendency really has to stop

314
00:13:18,000 --> 00:13:21,040
uh because over is just

315
00:13:21,040 --> 00:13:23,440
over populating i would say the

316
00:13:23,440 --> 00:13:26,000
injection space and i do not really like

317
00:13:26,000 --> 00:13:26,880
that

318
00:13:26,880 --> 00:13:27,839
so

319
00:13:27,839 --> 00:13:31,120
quite a while ago i was working

320
00:13:31,120 --> 00:13:34,120
with

321
00:13:35,040 --> 00:13:36,959
atelco company

322
00:13:36,959 --> 00:13:39,518
and

323
00:13:40,800 --> 00:13:42,480
they had

324
00:13:42,480 --> 00:13:45,279
different vendors to choose from

325
00:13:45,279 --> 00:13:48,320
and how do you choose a vendor in i.t

326
00:13:48,320 --> 00:13:51,199
security sometimes uh if you are

327
00:13:51,199 --> 00:13:54,000
constricted really you do not have the

328
00:13:54,000 --> 00:13:56,480
choice to choose because the space is so

329
00:13:56,480 --> 00:13:58,959
limited at the moment that basically if

330
00:13:58,959 --> 00:14:01,839
you uh get a paper that says

331
00:14:01,839 --> 00:14:04,560
that you've done the oscp then you are

332
00:14:04,560 --> 00:14:06,720
considered an expert and every word of

333
00:14:06,720 --> 00:14:10,720
yours is true no matter what

334
00:14:10,720 --> 00:14:12,160
do not blame me

335
00:14:12,160 --> 00:14:15,040
it is still a good certification and

336
00:14:15,040 --> 00:14:18,240
some certifications are pretty good but

337
00:14:18,240 --> 00:14:19,680
uh just because you've got a

338
00:14:19,680 --> 00:14:22,720
certification it does not matter uh in

339
00:14:22,720 --> 00:14:24,399
terms of real life work because

340
00:14:24,399 --> 00:14:26,720
sometimes you do not even know uh what

341
00:14:26,720 --> 00:14:29,440
you should be looking for and in this

342
00:14:29,440 --> 00:14:32,000
vendor selection process we've created

343
00:14:32,000 --> 00:14:33,120
fake

344
00:14:33,120 --> 00:14:34,079
sites

345
00:14:34,079 --> 00:14:37,120
and it wasn't for the taco company it

346
00:14:37,120 --> 00:14:38,959
was a previous project

347
00:14:38,959 --> 00:14:41,440
we created fake sites and

348
00:14:41,440 --> 00:14:43,920
basically we ordered penetration tests

349
00:14:43,920 --> 00:14:46,560
for the from the vendors and we told

350
00:14:46,560 --> 00:14:49,839
them that all right bring us everything

351
00:14:49,839 --> 00:14:52,399
from that site which is missing which is

352
00:14:52,399 --> 00:14:53,760
problematic

353
00:14:53,760 --> 00:14:55,760
and uh sadly

354
00:14:55,760 --> 00:14:59,040
but surely uh we haven't got everything

355
00:14:59,040 --> 00:15:02,160
back back that's expectable it was a

356
00:15:02,160 --> 00:15:04,959
10-day time frame and we hit so many

357
00:15:04,959 --> 00:15:07,199
bugs in there even the creators we did

358
00:15:07,199 --> 00:15:09,600
not know how many were there uh but

359
00:15:09,600 --> 00:15:12,320
there were some intentionally hidden uh

360
00:15:12,320 --> 00:15:14,480
features which were not really recovered

361
00:15:14,480 --> 00:15:16,240
then so

362
00:15:16,240 --> 00:15:17,279
i'm

363
00:15:17,279 --> 00:15:20,639
gonna take just a few minutes uh from

364
00:15:20,639 --> 00:15:23,199
your time and share you

365
00:15:23,199 --> 00:15:24,880
really just a few

366
00:15:24,880 --> 00:15:27,600
not so common injections

367
00:15:27,600 --> 00:15:29,760
so

368
00:15:30,079 --> 00:15:32,079
anybody

369
00:15:32,079 --> 00:15:34,320
does we recognize do we recognize what

370
00:15:34,320 --> 00:15:38,880
this is for or what payloads are these

371
00:15:39,440 --> 00:15:41,519
have you got the dock

372
00:15:41,519 --> 00:15:42,880
now you do

373
00:15:42,880 --> 00:15:45,839
all right so uh it's template injections

374
00:15:45,839 --> 00:15:47,120
what we

375
00:15:47,120 --> 00:15:49,279
have here better to be said it is

376
00:15:49,279 --> 00:15:52,000
server-side template injection because

377
00:15:52,000 --> 00:15:56,240
uh it is better to execute code or do

378
00:15:56,240 --> 00:15:58,000
anything on the server side because

379
00:15:58,000 --> 00:15:59,600
that's where the key that's where the

380
00:15:59,600 --> 00:16:01,920
data is and that's where the real value

381
00:16:01,920 --> 00:16:03,199
hides

382
00:16:03,199 --> 00:16:05,920
so how do we do the server side template

383
00:16:05,920 --> 00:16:08,959
injection uh with the abbreviation of

384
00:16:08,959 --> 00:16:10,560
ssdi

385
00:16:10,560 --> 00:16:13,199
so first of all we just send

386
00:16:13,199 --> 00:16:15,600
an input which should be

387
00:16:15,600 --> 00:16:16,720
rendered

388
00:16:16,720 --> 00:16:19,920
on any page or in pdf documents for

389
00:16:19,920 --> 00:16:23,279
example i really love when sites have

390
00:16:23,279 --> 00:16:26,160
pdf exports because most of them is

391
00:16:26,160 --> 00:16:30,399
using the free marker uh template engine

392
00:16:30,399 --> 00:16:32,880
and therefore if you are

393
00:16:32,880 --> 00:16:34,160
looking up

394
00:16:34,160 --> 00:16:36,240
the

395
00:16:36,240 --> 00:16:38,800
free marker template engine codes or

396
00:16:38,800 --> 00:16:41,040
exploits there is quite a bunch of them

397
00:16:41,040 --> 00:16:43,040
and you are able to execute system

398
00:16:43,040 --> 00:16:45,759
commands in there which is quite a win i

399
00:16:45,759 --> 00:16:47,120
would say

400
00:16:47,120 --> 00:16:50,560
so then just invoke the requested

401
00:16:50,560 --> 00:16:52,480
resource and when the template is

402
00:16:52,480 --> 00:16:55,600
injected basically in most of the cases

403
00:16:55,600 --> 00:16:58,720
uh we've got code execution but uh what

404
00:16:58,720 --> 00:17:02,000
we always have we are able to exfiltrate

405
00:17:02,000 --> 00:17:04,799
data from the server itself

406
00:17:04,799 --> 00:17:05,839
so

407
00:17:05,839 --> 00:17:06,959
uh

408
00:17:06,959 --> 00:17:09,039
yeah i would say that's something that

409
00:17:09,039 --> 00:17:11,359
need to be considered on and if you are

410
00:17:11,359 --> 00:17:14,079
working as a penetration tester or uh do

411
00:17:14,079 --> 00:17:17,839
you do bug bounties or even have

412
00:17:17,839 --> 00:17:21,039
some experience in like capture the

413
00:17:21,039 --> 00:17:24,000
flags ctf games i would advise

414
00:17:24,000 --> 00:17:26,559
looking on those i believe that the lead

415
00:17:26,559 --> 00:17:27,919
boys are here

416
00:17:27,919 --> 00:17:29,440
aren't they

417
00:17:29,440 --> 00:17:33,120
all right so uh please do your ctf

418
00:17:33,120 --> 00:17:36,400
chores and start your ctf team

419
00:17:36,400 --> 00:17:38,480
basically as far as i know the hungarian

420
00:17:38,480 --> 00:17:42,799
ctf teams are quite behind in the words

421
00:17:42,799 --> 00:17:46,240
order if i could say so and we need to

422
00:17:46,240 --> 00:17:47,760
work those up

423
00:17:47,760 --> 00:17:49,600
those are rocky numbers we need to pump

424
00:17:49,600 --> 00:17:51,039
that up so

425
00:17:51,039 --> 00:17:54,000
what is our next injection topic

426
00:17:54,000 --> 00:17:56,080
that i would like to talk about only

427
00:17:56,080 --> 00:17:58,320
just a little bit because it is not

428
00:17:58,320 --> 00:18:00,160
really something that most of the vap

429
00:18:00,160 --> 00:18:02,640
penetration testers would be interested

430
00:18:02,640 --> 00:18:03,280
in

431
00:18:03,280 --> 00:18:04,720
so

432
00:18:04,720 --> 00:18:09,200
have we ever heard about dln injections

433
00:18:12,000 --> 00:18:14,640
i should have gotten more ducks honestly

434
00:18:14,640 --> 00:18:17,280
this is my last lonely duck so uh be

435
00:18:17,280 --> 00:18:18,799
prepared for her

436
00:18:18,799 --> 00:18:20,080
so

437
00:18:20,080 --> 00:18:20,960
um

438
00:18:20,960 --> 00:18:24,640
we heard about dln injections before so

439
00:18:24,640 --> 00:18:25,600
uh

440
00:18:25,600 --> 00:18:28,559
dll injections is uh

441
00:18:28,559 --> 00:18:30,320
more likely

442
00:18:30,320 --> 00:18:34,880
a tool for malware harvard and in or

443
00:18:34,880 --> 00:18:36,799
privilege escalation world what you've

444
00:18:36,799 --> 00:18:38,799
used for and not like the web

445
00:18:38,799 --> 00:18:40,960
applications so

446
00:18:40,960 --> 00:18:43,679
what you do is you get the handler of a

447
00:18:43,679 --> 00:18:46,400
process and basically modify the memory

448
00:18:46,400 --> 00:18:48,080
of the process i'm not really getting

449
00:18:48,080 --> 00:18:50,240
into the details of it you are modifying

450
00:18:50,240 --> 00:18:53,200
the memory of the process and later on

451
00:18:53,200 --> 00:18:56,320
uh you are basically able to take over

452
00:18:56,320 --> 00:19:00,160
from that process or create fork a new

453
00:19:00,160 --> 00:19:03,280
process from there where

454
00:19:03,280 --> 00:19:05,600
you could work with the

455
00:19:05,600 --> 00:19:08,160
rights of the original process meaning

456
00:19:08,160 --> 00:19:11,840
that it is a tool uh which could be used

457
00:19:11,840 --> 00:19:14,080
for

458
00:19:14,480 --> 00:19:16,799
privileged pre-village escalation

459
00:19:16,799 --> 00:19:19,440
purposes sorry it is getting long for me

460
00:19:19,440 --> 00:19:22,559
as well so

461
00:19:23,360 --> 00:19:25,840
i just want to say that reflective

462
00:19:25,840 --> 00:19:28,000
loading is another topic if you are into

463
00:19:28,000 --> 00:19:31,520
dll injections it is uh getting more

464
00:19:31,520 --> 00:19:33,919
clever and clever because we need to

465
00:19:33,919 --> 00:19:36,799
avoid antiviruses and stuff

466
00:19:36,799 --> 00:19:39,520
so we do not really write on the disk

467
00:19:39,520 --> 00:19:41,280
and therefore

468
00:19:41,280 --> 00:19:44,240
we could fly under the radar uh for a

469
00:19:44,240 --> 00:19:45,440
little bit

470
00:19:45,440 --> 00:19:48,080
uh in the talk description that i've

471
00:19:48,080 --> 00:19:48,960
gave

472
00:19:48,960 --> 00:19:50,799
there is one question

473
00:19:50,799 --> 00:19:52,960
why do people dismiss

474
00:19:52,960 --> 00:19:56,000
the category of injection or injection

475
00:19:56,000 --> 00:20:00,280
as a topic any guesses

476
00:20:06,000 --> 00:20:07,120
i believe

477
00:20:07,120 --> 00:20:10,080
they do not dismiss it at all have you

478
00:20:10,080 --> 00:20:11,679
got a doc

479
00:20:11,679 --> 00:20:14,720
oh then someone is still

480
00:20:14,720 --> 00:20:16,960
obligated to have a duck in the at the

481
00:20:16,960 --> 00:20:18,159
end of the talk

482
00:20:18,159 --> 00:20:20,400
so

483
00:20:20,400 --> 00:20:22,799
people do not really dismiss

484
00:20:22,799 --> 00:20:24,960
the injection as a topic

485
00:20:24,960 --> 00:20:26,880
it just got so bright

486
00:20:26,880 --> 00:20:29,200
and basically there are

487
00:20:29,200 --> 00:20:32,960
a few hundred i would say that if we

488
00:20:32,960 --> 00:20:36,640
came together with amex injections and

489
00:20:36,640 --> 00:20:39,200
log injections and cookie injections and

490
00:20:39,200 --> 00:20:42,640
stuff that it is impossible to handle it

491
00:20:42,640 --> 00:20:45,520
as a single entity uh let me share you

492
00:20:45,520 --> 00:20:47,440
one story

493
00:20:47,440 --> 00:20:48,480
so

494
00:20:48,480 --> 00:20:49,919
a friend of mine

495
00:20:49,919 --> 00:20:52,240
uh wrote

496
00:20:52,240 --> 00:20:55,600
oh my god that was in the early days so

497
00:20:55,600 --> 00:20:57,600
even before some of the audience was

498
00:20:57,600 --> 00:20:59,520
born uh

499
00:20:59,520 --> 00:21:02,400
we had the browser engine conqueror do

500
00:21:02,400 --> 00:21:05,360
we remember that

501
00:21:05,520 --> 00:21:08,880
it's it's not a fresh one i would say uh

502
00:21:08,880 --> 00:21:11,039
you you have so basically one of my

503
00:21:11,039 --> 00:21:14,000
friend modified the browser engine and

504
00:21:14,000 --> 00:21:16,480
with each http request

505
00:21:16,480 --> 00:21:19,120
he created or sent a cookie to the

506
00:21:19,120 --> 00:21:22,080
server which contained nothing else than

507
00:21:22,080 --> 00:21:24,880
admin equals one

508
00:21:24,880 --> 00:21:27,039
so

509
00:21:27,120 --> 00:21:30,320
it's laughable it is so dumb to do

510
00:21:30,320 --> 00:21:33,600
really it it is so dumb but the results

511
00:21:33,600 --> 00:21:35,840
were

512
00:21:35,840 --> 00:21:38,480
out of this world honestly i haven't

513
00:21:38,480 --> 00:21:42,799
seen so many pages broken into by one

514
00:21:42,799 --> 00:21:46,159
odd equal or sorry a cookie by administ

515
00:21:46,159 --> 00:21:47,679
was one

516
00:21:47,679 --> 00:21:52,159
and uh the fun thing that he created uh

517
00:21:52,159 --> 00:21:54,000
i i told him that i'm going to give this

518
00:21:54,000 --> 00:21:56,320
talk and i really like this example and

519
00:21:56,320 --> 00:21:58,400
he told me that

520
00:21:58,400 --> 00:22:01,600
just for fun service he basically

521
00:22:01,600 --> 00:22:04,960
created an extension to chrome as well

522
00:22:04,960 --> 00:22:08,000
uh which does the same exact thing

523
00:22:08,000 --> 00:22:08,960
and

524
00:22:08,960 --> 00:22:10,640
he told me that

525
00:22:10,640 --> 00:22:13,120
he was able to get

526
00:22:13,120 --> 00:22:16,159
it was last week or some sum around that

527
00:22:16,159 --> 00:22:18,400
uh he was able to get an administration

528
00:22:18,400 --> 00:22:21,679
panel without logging into the system uh

529
00:22:21,679 --> 00:22:24,000
of a hungarian web shop i do not

530
00:22:24,000 --> 00:22:26,320
recommend to get around and test out

531
00:22:26,320 --> 00:22:28,559
hungary and web shops with this

532
00:22:28,559 --> 00:22:31,039
technique but well yeah

533
00:22:31,039 --> 00:22:34,799
we are here with injection topics so you

534
00:22:34,799 --> 00:22:37,360
could get administrator rights on web

535
00:22:37,360 --> 00:22:39,120
shops basically

536
00:22:39,120 --> 00:22:41,200
with a joke like this

537
00:22:41,200 --> 00:22:43,120
so

538
00:22:43,120 --> 00:22:44,240
we learned

539
00:22:44,240 --> 00:22:45,679
that

540
00:22:45,679 --> 00:22:46,880
actually

541
00:22:46,880 --> 00:22:48,960
we are really really

542
00:22:48,960 --> 00:22:50,159
behind

543
00:22:50,159 --> 00:22:52,799
in terms of understanding injection we

544
00:22:52,799 --> 00:22:57,120
do not really have a commonly acceptable

545
00:22:57,120 --> 00:22:58,960
i would say

546
00:22:58,960 --> 00:23:00,960
definition for it

547
00:23:00,960 --> 00:23:02,080
and

548
00:23:02,080 --> 00:23:05,120
right now i think the key takeaway is

549
00:23:05,120 --> 00:23:07,679
that we should not generalize

550
00:23:07,679 --> 00:23:11,200
the topics to the point of obviation is

551
00:23:11,200 --> 00:23:15,200
there any question i should answer

552
00:23:20,400 --> 00:23:23,360
if there is none i just hope that this

553
00:23:23,360 --> 00:23:25,840
talk will end the generalization of

554
00:23:25,840 --> 00:23:28,640
injection uh topics in the overstock

555
00:23:28,640 --> 00:23:31,440
then and so there will be no sequel to

556
00:23:31,440 --> 00:23:33,600
it

557
00:23:33,840 --> 00:23:36,830
mark thank you very much

558
00:23:36,830 --> 00:23:45,929
[Applause]

559
00:23:46,000 --> 00:23:47,840
i hope you've enjoyed

560
00:23:47,840 --> 00:23:49,919
who's the youngest member of the

561
00:23:49,919 --> 00:23:52,559
audience

562
00:23:57,600 --> 00:24:01,678
yeah the other extreme is also nice

563
00:24:02,880 --> 00:24:04,799
so if you've got any question or just

564
00:24:04,799 --> 00:24:06,880
want to hear some fun stories about

565
00:24:06,880 --> 00:24:11,039
injection feel free to uh reach me out

566
00:24:11,039 --> 00:24:13,600
i'm still at the conference and enjoy

567
00:24:13,600 --> 00:24:15,440
the rest of it there is one talk left as

568
00:24:15,440 --> 00:24:19,000
far as i know

