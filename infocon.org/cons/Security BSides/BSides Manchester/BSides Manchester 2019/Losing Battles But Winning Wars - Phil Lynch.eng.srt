1
00:00:05,770 --> 00:00:08,799
so good afternoon everybody and thanks

2
00:00:07,420 --> 00:00:10,120
for coming to the last talk of the day I

3
00:00:08,800 --> 00:00:12,039
know you'd all rather be in the pub

4
00:00:10,120 --> 00:00:16,299
which is exactly where I'm going to be

5
00:00:12,039 --> 00:00:20,320
after this um yeah luzhin part was

6
00:00:16,299 --> 00:00:21,789
winning wars fussing Who am I

7
00:00:20,320 --> 00:00:24,580
Phil Lynch I'm one of the management

8
00:00:21,789 --> 00:00:26,769
principles at natured and for my sense

9
00:00:24,580 --> 00:00:28,750
that means that I'm one of four managers

10
00:00:26,769 --> 00:00:31,900
responsible for the entire pentest team

11
00:00:28,750 --> 00:00:34,300
there I also manage most of nature's red

12
00:00:31,900 --> 00:00:35,980
team engagements from a rest governance

13
00:00:34,300 --> 00:00:38,620
and clients or a face and perspective

14
00:00:35,980 --> 00:00:41,500
and on occasion I still get my hands

15
00:00:38,620 --> 00:00:43,360
dirty behind the keyboard and so I'm not

16
00:00:41,500 --> 00:00:45,059
too far removed from the core face that

17
00:00:43,360 --> 00:00:47,109
I don't really know what's going on I

18
00:00:45,059 --> 00:00:49,809
have the dubious or not have also

19
00:00:47,109 --> 00:00:52,269
conducted most of the executive debriefs

20
00:00:49,809 --> 00:00:54,370
that we that we do after an engagement

21
00:00:52,269 --> 00:00:56,530
basically that means going to the senior

22
00:00:54,370 --> 00:00:59,230
management executive teams sea levels

23
00:00:56,530 --> 00:01:01,300
I'm telling them how miraculously well

24
00:00:59,230 --> 00:01:05,048
they've performed over the that

25
00:01:01,300 --> 00:01:10,119
engagement or not I never give good news

26
00:01:05,049 --> 00:01:11,380
unfortunately that's it I'm actually a

27
00:01:10,119 --> 00:01:13,450
fourth twenty four years in the Air

28
00:01:11,380 --> 00:01:15,369
Force I've got twenty five years

29
00:01:13,450 --> 00:01:19,090
experience in IT or last SEC's of which

30
00:01:15,369 --> 00:01:20,799
have been primarily in security and I'm

31
00:01:19,090 --> 00:01:22,720
also a co-author of nature's advance

32
00:01:20,799 --> 00:01:24,880
they act a simulation course which I

33
00:01:22,720 --> 00:01:29,520
also teach with some of the other guys

34
00:01:24,880 --> 00:01:31,960
from NetID so what's this all about

35
00:01:29,520 --> 00:01:34,840
so a net it should have been red team

36
00:01:31,960 --> 00:01:38,289
and for the past five years of

37
00:01:34,840 --> 00:01:39,700
effectively so all that time we've

38
00:01:38,290 --> 00:01:43,060
played obviously we've allowed quite a

39
00:01:39,700 --> 00:01:44,979
few things along the way and I apologize

40
00:01:43,060 --> 00:01:47,049
now I will try really hard not to swear

41
00:01:44,979 --> 00:01:47,829
so apologies for anybody ever

42
00:01:47,049 --> 00:01:50,439
sensibilities

43
00:01:47,829 --> 00:01:53,589
I am Scottish Ernest a bit of a sort of

44
00:01:50,439 --> 00:01:56,350
a cultural thing but most of the things

45
00:01:53,590 --> 00:01:59,259
we've learned with round because things

46
00:01:56,350 --> 00:01:59,890
go south things go wrong we up we

47
00:01:59,259 --> 00:02:01,719
are human

48
00:01:59,890 --> 00:02:03,969
by the time you've got into the middle

49
00:02:01,719 --> 00:02:07,240
of an engagement the heat of battle you

50
00:02:03,969 --> 00:02:09,190
tend to make mistakes then that's fine

51
00:02:07,240 --> 00:02:11,470
in and of itself it's not really great

52
00:02:09,190 --> 00:02:13,120
for the engagement but primarily as long

53
00:02:11,470 --> 00:02:14,260
as what we're doing is learn from those

54
00:02:13,120 --> 00:02:17,049
mistakes

55
00:02:14,260 --> 00:02:18,790
not falling at the Einstein's definition

56
00:02:17,049 --> 00:02:20,349
of insanity which is doing the same

57
00:02:18,790 --> 00:02:21,250
thing over at all them expecting a

58
00:02:20,349 --> 00:02:23,679
different result

59
00:02:21,250 --> 00:02:25,959
so what I wanted to do with you on today

60
00:02:23,680 --> 00:02:27,819
was she have some of her experiences

61
00:02:25,959 --> 00:02:30,730
where things have been less than ideal

62
00:02:27,819 --> 00:02:32,349
and have gone wrong so hopefully you'll

63
00:02:30,730 --> 00:02:33,940
be on an engagement you'll be managing

64
00:02:32,349 --> 00:02:35,679
teams and engagements whatever your role

65
00:02:33,940 --> 00:02:37,450
is and maybe you don't make the same

66
00:02:35,680 --> 00:02:40,540
mistakes so maybe your engagements are a

67
00:02:37,450 --> 00:02:44,108
little bit more successful than the ones

68
00:02:40,540 --> 00:02:46,090
who have not been so agreed and of

69
00:02:44,109 --> 00:02:47,230
course it's the bees they stopped so

70
00:02:46,090 --> 00:02:48,790
there's an appropriate number of memes

71
00:02:47,230 --> 00:02:53,858
and gifts in there because that's what

72
00:02:48,790 --> 00:02:57,159
we don't learn from our mistakes here we

73
00:02:53,859 --> 00:02:59,680
all make them and we get on an

74
00:02:57,159 --> 00:03:01,030
engagement users do weird stuff you can

75
00:02:59,680 --> 00:03:02,950
never account for everything that's

76
00:03:01,030 --> 00:03:06,060
going to come up with you on a red team

77
00:03:02,950 --> 00:03:08,768
engaging you blamed from the start

78
00:03:06,060 --> 00:03:10,870
effectively you're on the outside you've

79
00:03:08,769 --> 00:03:12,400
got a maybe access to the internal

80
00:03:10,870 --> 00:03:13,540
environment you don't know what it looks

81
00:03:12,400 --> 00:03:15,340
like you don't know what they're doing

82
00:03:13,540 --> 00:03:17,798
you can't see anything you've got no

83
00:03:15,340 --> 00:03:19,750
real idea of what's happening on the

84
00:03:17,799 --> 00:03:21,010
other side of the house you can mix and

85
00:03:19,750 --> 00:03:24,519
assumptions you can make some educated

86
00:03:21,010 --> 00:03:27,370
guesses but you never truly know what's

87
00:03:24,519 --> 00:03:30,910
going on and because of that things

88
00:03:27,370 --> 00:03:32,949
happen when they don't go the way you

89
00:03:30,910 --> 00:03:35,109
wanted them to go the way you expected

90
00:03:32,949 --> 00:03:37,510
that big or quite frankly things happen

91
00:03:35,109 --> 00:03:38,760
and you've got no idea why and what do

92
00:03:37,510 --> 00:03:40,720
we do about it

93
00:03:38,760 --> 00:03:42,970
allow them from those mistakes is

94
00:03:40,720 --> 00:03:44,530
fundamental to us becoming better at

95
00:03:42,970 --> 00:03:47,220
what we do and that's not just a red

96
00:03:44,530 --> 00:03:50,980
teaming that's the industry in general

97
00:03:47,220 --> 00:03:53,260
so it natured we're very open about any

98
00:03:50,980 --> 00:03:57,518
things that go wrong we have an or blame

99
00:03:53,260 --> 00:03:58,989
culture if somebody does something that

100
00:03:57,519 --> 00:04:01,540
they think it's a mistake the thing has

101
00:03:58,989 --> 00:04:02,680
gone wrong we open out we let the team

102
00:04:01,540 --> 00:04:04,060
know we make sure that everybody

103
00:04:02,680 --> 00:04:06,190
understands why it's happened how it

104
00:04:04,060 --> 00:04:07,690
harm and quite often we don't find out

105
00:04:06,190 --> 00:04:09,849
until right at the end of the engagement

106
00:04:07,690 --> 00:04:12,010
when we're doing the debriefs and we're

107
00:04:09,849 --> 00:04:14,260
getting the client center as to what's

108
00:04:12,010 --> 00:04:15,459
actually going on and sometimes it's

109
00:04:14,260 --> 00:04:22,270
been things that we haven't even thought

110
00:04:15,459 --> 00:04:24,130
of this sort of corazon so what we've

111
00:04:22,270 --> 00:04:27,639
learned I'll start with it we'll start

112
00:04:24,130 --> 00:04:30,419
with the famous one today and tell every

113
00:04:27,639 --> 00:04:36,009
has the viewers on fair intelligence

114
00:04:30,419 --> 00:04:41,139
snake-oil smoking medals let alberto

115
00:04:36,009 --> 00:04:43,509
magic fair intelligence-led pen testing

116
00:04:41,139 --> 00:04:45,219
requires threat intelligence and you've

117
00:04:43,509 --> 00:04:48,879
got to help your ther Intel teams

118
00:04:45,219 --> 00:04:50,830
pervade you as the red team what you

119
00:04:48,879 --> 00:04:52,930
need sort of there's two sides to it

120
00:04:50,830 --> 00:04:54,699
they provide the the client where they

121
00:04:52,930 --> 00:04:57,370
are player report ensures they are

122
00:04:54,699 --> 00:04:59,469
exposure and what they look like to

123
00:04:57,370 --> 00:05:01,449
other people in the real world but the

124
00:04:59,469 --> 00:05:03,039
digital fruit prints like and then

125
00:05:01,449 --> 00:05:04,629
there's a targeting say that we as red

126
00:05:03,039 --> 00:05:07,120
teamers want to consume in order to

127
00:05:04,629 --> 00:05:08,979
compromise the organization show them

128
00:05:07,120 --> 00:05:11,469
how this can happen through intelligence

129
00:05:08,979 --> 00:05:14,770
gathered in exercises and then

130
00:05:11,469 --> 00:05:16,150
effectively so they teach them home this

131
00:05:14,770 --> 00:05:21,849
is bad and how not to do it in the

132
00:05:16,150 --> 00:05:23,169
future so I think the most important

133
00:05:21,849 --> 00:05:25,389
thing I've learned over the years about

134
00:05:23,169 --> 00:05:30,279
the intelligence is that timing is

135
00:05:25,389 --> 00:05:32,460
crucial take the following scenarios we

136
00:05:30,279 --> 00:05:36,610
then should start an engagement I think

137
00:05:32,460 --> 00:05:40,989
one week ago threat intelligence was

138
00:05:36,610 --> 00:05:42,699
probably done in 2017 at the back end it

139
00:05:40,990 --> 00:05:43,990
should have started in March of this

140
00:05:42,699 --> 00:05:46,240
year of the engagement the actual

141
00:05:43,990 --> 00:05:48,370
operational site so if you think about

142
00:05:46,240 --> 00:05:50,770
it that their intelligence at the time

143
00:05:48,370 --> 00:05:53,379
was relevant it was good it was exactly

144
00:05:50,770 --> 00:05:55,688
what we needed six months down the line

145
00:05:53,379 --> 00:05:58,089
is it relevant as it's still useful to

146
00:05:55,689 --> 00:05:59,589
us as are empty so when we're looking at

147
00:05:58,089 --> 00:06:02,560
the target and aspects of it we're

148
00:05:59,589 --> 00:06:05,439
thinking okay the fair Intel team have

149
00:06:02,560 --> 00:06:07,389
discovered a conference and the attend

150
00:06:05,439 --> 00:06:09,099
the target company attains as conference

151
00:06:07,389 --> 00:06:11,409
regularly we're going to use that to

152
00:06:09,099 --> 00:06:13,210
create a pretext around inviting some of

153
00:06:11,409 --> 00:06:17,020
those speakers or people have spoken at

154
00:06:13,210 --> 00:06:20,229
these events back to our event except

155
00:06:17,020 --> 00:06:22,539
now that event was that happened three

156
00:06:20,229 --> 00:06:23,080
months ago that fit and tells no good to

157
00:06:22,539 --> 00:06:26,949
us anymore

158
00:06:23,080 --> 00:06:31,149
so getting threat intelligence to you at

159
00:06:26,949 --> 00:06:33,310
the right time is crucial so you need to

160
00:06:31,149 --> 00:06:36,459
be aware of delays you need to be aware

161
00:06:33,310 --> 00:06:38,019
of any pretext proposed to you through

162
00:06:36,459 --> 00:06:39,040
their intelligence that may not be

163
00:06:38,019 --> 00:06:40,900
relevant and

164
00:06:39,040 --> 00:06:43,810
if they're talking about things around

165
00:06:40,900 --> 00:06:45,700
Christmas if it's April and it's Easter

166
00:06:43,810 --> 00:06:46,990
it's fact that Santa Claus I'm coming

167
00:06:45,700 --> 00:06:48,789
along is the Easter Bunny you want to be

168
00:06:46,990 --> 00:06:50,110
talking about so you have to look at

169
00:06:48,790 --> 00:06:51,730
these things as reading you have to go

170
00:06:50,110 --> 00:06:53,350
in and make sure that it's relevant for

171
00:06:51,730 --> 00:06:55,420
what you're trying to do you can be

172
00:06:53,350 --> 00:06:57,430
creative you can use some some clever

173
00:06:55,420 --> 00:06:59,350
language within your threat Intel and

174
00:06:57,430 --> 00:07:01,240
you're targeting packs and order for it

175
00:06:59,350 --> 00:07:04,240
to become relevant at the time but it

176
00:07:01,240 --> 00:07:06,970
becomes difficult other things that

177
00:07:04,240 --> 00:07:09,730
happen over time your targets leave the

178
00:07:06,970 --> 00:07:12,760
organization they get married and hence

179
00:07:09,730 --> 00:07:14,530
their name changes they move departments

180
00:07:12,760 --> 00:07:16,900
and you're targeting HR and they're no

181
00:07:14,530 --> 00:07:19,659
in marketing or sales all of these

182
00:07:16,900 --> 00:07:21,940
things can happen and from the outside

183
00:07:19,660 --> 00:07:24,280
you can only go on the information

184
00:07:21,940 --> 00:07:26,650
you've got presented in front of you so

185
00:07:24,280 --> 00:07:28,929
what do we do about this well you

186
00:07:26,650 --> 00:07:31,000
clearly can't continually go through the

187
00:07:28,930 --> 00:07:33,100
affair and tell look where you got your

188
00:07:31,000 --> 00:07:34,960
team constantly gathering the latest and

189
00:07:33,100 --> 00:07:36,610
greatest because it's just not practical

190
00:07:34,960 --> 00:07:39,669
they've moved on to the next engagement

191
00:07:36,610 --> 00:07:43,570
they're playing it for the next test so

192
00:07:39,670 --> 00:07:46,600
what do we do what I've learned talk to

193
00:07:43,570 --> 00:07:48,070
the clients talk to them upfront ask

194
00:07:46,600 --> 00:07:49,930
them about the people that you're

195
00:07:48,070 --> 00:07:51,550
proposing a target it sounds a little

196
00:07:49,930 --> 00:07:53,050
bit alien to a lot of people who do red

197
00:07:51,550 --> 00:07:54,460
teaming because like oh you can't tell

198
00:07:53,050 --> 00:07:55,900
the client anything because they'll

199
00:07:54,460 --> 00:07:58,659
gaming you they'll use it against you

200
00:07:55,900 --> 00:08:00,549
they'll watch those accounts at some

201
00:07:58,660 --> 00:08:02,170
point you have to trust the white sale

202
00:08:00,550 --> 00:08:04,270
and by white sale for those who don't

203
00:08:02,170 --> 00:08:06,250
really understand those are the trusted

204
00:08:04,270 --> 00:08:08,590
individuals within a target organization

205
00:08:06,250 --> 00:08:09,940
that know the tests happen and they know

206
00:08:08,590 --> 00:08:12,070
that you're going to be targeting

207
00:08:09,940 --> 00:08:14,290
individuals within them and they may

208
00:08:12,070 --> 00:08:17,890
have a view on some of the pretext that

209
00:08:14,290 --> 00:08:20,440
you want to use speak to them get their

210
00:08:17,890 --> 00:08:24,280
temper make sure that if you're

211
00:08:20,440 --> 00:08:24,670
targeting Joe Bloggs in HR that you're

212
00:08:24,280 --> 00:08:27,609
blocked

213
00:08:24,670 --> 00:08:29,230
he still indeed walks in HR and maybe

214
00:08:27,610 --> 00:08:30,670
he's not on holiday for the next two

215
00:08:29,230 --> 00:08:32,440
weeks because again there's nothing

216
00:08:30,670 --> 00:08:34,720
worse than up and put a lovely pretext

217
00:08:32,440 --> 00:08:37,900
together great fashion email sender N

218
00:08:34,720 --> 00:08:39,640
and you know of office reply hi I'm in

219
00:08:37,900 --> 00:08:41,770
the galley areas and I'll be back and

220
00:08:39,640 --> 00:08:43,179
November check my tan oh and you've got

221
00:08:41,770 --> 00:08:46,270
a two-week engagement and this is ten

222
00:08:43,179 --> 00:08:48,370
mother's late what's next and these

223
00:08:46,270 --> 00:08:50,380
things happen you've just got to manage

224
00:08:48,370 --> 00:08:51,710
them but talk to the clients it's it's

225
00:08:50,380 --> 00:08:53,720
an age-old

226
00:08:51,710 --> 00:08:55,760
so a thing where you can't tell the

227
00:08:53,720 --> 00:08:56,720
client anything but there's a white sale

228
00:08:55,760 --> 00:08:59,390
there for a reason

229
00:08:56,720 --> 00:09:01,070
use them talk to them get that little

230
00:08:59,390 --> 00:09:03,260
bit of intelligence that helps the test

231
00:09:01,070 --> 00:09:04,730
run because remember they can pay a

232
00:09:03,260 --> 00:09:06,230
whole load of money for you is set and

233
00:09:04,730 --> 00:09:07,760
say well I've targeted all these

234
00:09:06,230 --> 00:09:09,500
individuals and northey's reply and

235
00:09:07,760 --> 00:09:11,360
because none of them work there anymore

236
00:09:09,500 --> 00:09:13,370
they're all on holiday or whatever and

237
00:09:11,360 --> 00:09:15,560
all they're doing is as money is

238
00:09:13,370 --> 00:09:17,510
dripping down the drain and you're

239
00:09:15,560 --> 00:09:18,949
sending emails to empty end boxes I

240
00:09:17,510 --> 00:09:20,900
didn't vote to the hump in one hug and

241
00:09:18,950 --> 00:09:29,300
they'd receive an or value in the end of

242
00:09:20,900 --> 00:09:33,770
it so all of these things have happened

243
00:09:29,300 --> 00:09:34,939
to us and because of that I know at the

244
00:09:33,770 --> 00:09:37,400
beginning of an engagement I set up

245
00:09:34,940 --> 00:09:38,720
dialogue with clients and I make sure

246
00:09:37,400 --> 00:09:40,730
they understand that when they receive

247
00:09:38,720 --> 00:09:42,860
the threat Intel report that you know we

248
00:09:40,730 --> 00:09:45,590
have a discussion around those people

249
00:09:42,860 --> 00:09:47,780
with proposing to target and they can

250
00:09:45,590 --> 00:09:49,820
then go generally without any sort of

251
00:09:47,780 --> 00:09:53,150
alarm bells going off and say how

252
00:09:49,820 --> 00:09:54,410
actually Sheila in HR and she's on

253
00:09:53,150 --> 00:09:55,790
maternity leave

254
00:09:54,410 --> 00:09:58,490
she's not gonna be in the office for the

255
00:09:55,790 --> 00:10:00,199
next four months well that's not target

256
00:09:58,490 --> 00:10:01,700
Sheila a child anymore because that's

257
00:10:00,200 --> 00:10:03,650
not gonna provide you any value and it

258
00:10:01,700 --> 00:10:05,210
saves a whole load of work up front so

259
00:10:03,650 --> 00:10:06,380
it's not it's not rocket science

260
00:10:05,210 --> 00:10:08,350
but you'll be amazed at how many people

261
00:10:06,380 --> 00:10:10,970
won't engage with the client early on

262
00:10:08,350 --> 00:10:14,990
don't wait for it to go wrong try and

263
00:10:10,970 --> 00:10:17,510
preempt it the second thing I had

264
00:10:14,990 --> 00:10:19,940
learned and being an ex-military guy you

265
00:10:17,510 --> 00:10:21,260
know I've traveled quite extensively

266
00:10:19,940 --> 00:10:24,140
around the world on hard wreck in my

267
00:10:21,260 --> 00:10:26,420
geography seems to be pretty good AM pen

268
00:10:24,140 --> 00:10:29,780
testers are geographically challenged I

269
00:10:26,420 --> 00:10:34,120
don't know what it is they don't really

270
00:10:29,780 --> 00:10:34,120
seem to understand where countries are

271
00:10:34,360 --> 00:10:39,110
it's not just news outlets the CEPA

272
00:10:37,670 --> 00:10:41,870
struggle with pain I don't know what it

273
00:10:39,110 --> 00:10:44,870
is pens here so strong so here's the

274
00:10:41,870 --> 00:10:47,330
scenario we're conducting a red team for

275
00:10:44,870 --> 00:10:49,280
an organization as players and globally

276
00:10:47,330 --> 00:10:50,500
you know let's go officers in loads of

277
00:10:49,280 --> 00:10:52,280
different countries and they want to

278
00:10:50,500 --> 00:10:54,410
test each of these countries

279
00:10:52,280 --> 00:10:57,180
individually so that they're all mark

280
00:10:54,410 --> 00:11:00,329
from the same hymn machine if you like

281
00:10:57,180 --> 00:11:02,339
scream saw their intelligence kicks in

282
00:11:00,330 --> 00:11:04,830
it's in a timely manner we've engaged

283
00:11:02,340 --> 00:11:05,850
with the the client of these targets

284
00:11:04,830 --> 00:11:09,320
violent yeah yeah

285
00:11:05,850 --> 00:11:11,910
Shawne saw box in that office brilliant

286
00:11:09,320 --> 00:11:14,880
we create a nice pretext we save an

287
00:11:11,910 --> 00:11:16,860
email will successfully feste the

288
00:11:14,880 --> 00:11:19,620
individual at the end and we got a shell

289
00:11:16,860 --> 00:11:23,030
back everybody's doing the root dance in

290
00:11:19,620 --> 00:11:25,530
the war room so because we are

291
00:11:23,030 --> 00:11:27,630
conscientious red teamers we start doing

292
00:11:25,530 --> 00:11:30,240
situational awareness we do some basic

293
00:11:27,630 --> 00:11:32,370
checks we've got a shell which means the

294
00:11:30,240 --> 00:11:34,320
IP address that the external facing

295
00:11:32,370 --> 00:11:36,420
infrastructure has has or no waitlist

296
00:11:34,320 --> 00:11:43,080
that means it belongs to them tech

297
00:11:36,420 --> 00:11:44,670
number one the target name is correct so

298
00:11:43,080 --> 00:11:46,110
that's good we know that we've targeted

299
00:11:44,670 --> 00:11:48,990
the right individual we can see his

300
00:11:46,110 --> 00:11:50,490
email address we look at the computer

301
00:11:48,990 --> 00:11:51,600
name the computer name follows the

302
00:11:50,490 --> 00:11:54,150
standard that we expect for the

303
00:11:51,600 --> 00:11:56,010
environment the domain name is correct I

304
00:11:54,150 --> 00:11:57,510
mean everything's good we're in the

305
00:11:56,010 --> 00:12:00,360
right place we can start going to town

306
00:11:57,510 --> 00:12:02,610
right well do one last check we'll just

307
00:12:00,360 --> 00:12:05,610
check the list the last time the system

308
00:12:02,610 --> 00:12:09,060
rebooted and stuff like up no that's

309
00:12:05,610 --> 00:12:10,320
interesting the times all off not just

310
00:12:09,060 --> 00:12:13,469
because it's in a foreign country it's

311
00:12:10,320 --> 00:12:15,900
off from what we expect it to be now

312
00:12:13,470 --> 00:12:17,670
it's system time account the wrong maybe

313
00:12:15,900 --> 00:12:21,480
the computer's not very well let's have

314
00:12:17,670 --> 00:12:22,979
a look now it's photos oh how else can

315
00:12:21,480 --> 00:12:27,720
we check the time let's have a look at

316
00:12:22,980 --> 00:12:30,170
the locale sales idea that's not the

317
00:12:27,720 --> 00:12:34,680
country we would expect in from a target

318
00:12:30,170 --> 00:12:38,069
so what do we do then we speak to the

319
00:12:34,680 --> 00:12:40,229
claim we believe that our target is in

320
00:12:38,070 --> 00:12:42,600
country X and we expected them to be in

321
00:12:40,230 --> 00:12:44,580
country Y can you confirm everything

322
00:12:42,600 --> 00:12:47,310
else is good apart from we only

323
00:12:44,580 --> 00:12:49,800
physically are the client runs offenses

324
00:12:47,310 --> 00:12:51,599
Mon or not subsequently what we found

325
00:12:49,800 --> 00:12:55,109
out is this individual what's between

326
00:12:51,600 --> 00:12:56,820
two different countries and we happen to

327
00:12:55,110 --> 00:13:00,390
catch him when he is not in the target

328
00:12:56,820 --> 00:13:03,390
market no need to massively panic we

329
00:13:00,390 --> 00:13:05,430
haven't committed an offense the targets

330
00:13:03,390 --> 00:13:06,870
balinese a very organisation it's just

331
00:13:05,430 --> 00:13:08,819
not in the market that we were looking

332
00:13:06,870 --> 00:13:11,130
to target at our particular time not in

333
00:13:08,820 --> 00:13:12,900
the right place so

334
00:13:11,130 --> 00:13:15,030
display I was going through a whole raft

335
00:13:12,900 --> 00:13:16,040
of checks that all red teens should be

336
00:13:15,030 --> 00:13:19,740
doing

337
00:13:16,040 --> 00:13:21,510
we still got caught by what

338
00:13:19,740 --> 00:13:23,190
fundamentally was an understanding

339
00:13:21,510 --> 00:13:26,069
between their intelligence a target

340
00:13:23,190 --> 00:13:28,350
sorry the client and others that that

341
00:13:26,070 --> 00:13:31,560
individual walked in multiple counts so

342
00:13:28,350 --> 00:13:34,350
it's something to be aware of situation

343
00:13:31,560 --> 00:13:35,910
will be honest or helped us here is the

344
00:13:34,350 --> 00:13:38,340
fact that we went to town and when

345
00:13:35,910 --> 00:13:42,300
things didn't look quite right we made a

346
00:13:38,340 --> 00:13:43,650
call and if it didn't look right we

347
00:13:42,300 --> 00:13:44,550
stopped the engagement we came out reach

348
00:13:43,650 --> 00:13:46,380
out to the client

349
00:13:44,550 --> 00:13:48,329
the last thing you want is to actually

350
00:13:46,380 --> 00:13:50,610
have targeted an individual who's in the

351
00:13:48,330 --> 00:13:53,100
wrong organization therefore you are in

352
00:13:50,610 --> 00:14:00,870
deep doo-doo at that point and you don't

353
00:13:53,100 --> 00:14:02,640
want to be there so globally you know

354
00:14:00,870 --> 00:14:03,960
the model is a big place it's easy to

355
00:14:02,640 --> 00:14:07,500
get things wrong you don't country's

356
00:14:03,960 --> 00:14:09,960
them a long way off not just a global

357
00:14:07,500 --> 00:14:14,180
problem it would appear the painters of

358
00:14:09,960 --> 00:14:14,180
local geographies not entirely agree I

359
00:14:14,840 --> 00:14:18,960
consider the following scenario we've

360
00:14:17,340 --> 00:14:22,860
been asked to conduct a physical se

361
00:14:18,960 --> 00:14:24,720
engagement against a company so we asked

362
00:14:22,860 --> 00:14:25,920
them okay what's the objectives and they

363
00:14:24,720 --> 00:14:28,050
said well we've got a client database

364
00:14:25,920 --> 00:14:29,610
but we want to see if you can beat your

365
00:14:28,050 --> 00:14:33,180
physical pediment on get into the office

366
00:14:29,610 --> 00:14:34,620
and then hopefully compromise the

367
00:14:33,180 --> 00:14:36,510
network or hopefully not compromise the

368
00:14:34,620 --> 00:14:38,010
network and get to your client database

369
00:14:36,510 --> 00:14:40,350
is there something you can do for us

370
00:14:38,010 --> 00:14:42,150
yeah of course we can't forget this done

371
00:14:40,350 --> 00:14:44,430
so we assigned it to one of our

372
00:14:42,150 --> 00:14:47,910
consultants who absolutely loves it over

373
00:14:44,430 --> 00:14:49,500
a physical se he speaks to the client he

374
00:14:47,910 --> 00:14:51,540
said can I have the pork order to Belden

375
00:14:49,500 --> 00:14:52,890
you know and the client Julie given it

376
00:14:51,540 --> 00:14:55,860
said it's in a business park

377
00:14:52,890 --> 00:14:57,360
so multi-turreted there's building he

378
00:14:55,860 --> 00:14:58,470
said and the business parks all covered

379
00:14:57,360 --> 00:15:01,410
by the same postcode

380
00:14:58,470 --> 00:15:03,030
okay he said but the names above the

381
00:15:01,410 --> 00:15:04,620
door and remember that for later because

382
00:15:03,030 --> 00:15:08,579
that's important the name was above the

383
00:15:04,620 --> 00:15:11,640
door so our consultant goes and does

384
00:15:08,580 --> 00:15:13,620
about a recon he he takes the company

385
00:15:11,640 --> 00:15:14,970
website gets the address off of it he

386
00:15:13,620 --> 00:15:16,620
puts her into Google Maps it shows

387
00:15:14,970 --> 00:15:18,330
office exactly where the client said it

388
00:15:16,620 --> 00:15:20,490
was going to be he's thinking yeah this

389
00:15:18,330 --> 00:15:23,520
was all good so he takes a drive drive

390
00:15:20,490 --> 00:15:25,589
by he has a look around if client said

391
00:15:23,520 --> 00:15:28,069
attended office space opposite some

392
00:15:25,589 --> 00:15:30,510
industrial unit so it does drive past

393
00:15:28,070 --> 00:15:33,500
multi-tenant novice oh it's good

394
00:15:30,510 --> 00:15:36,750
industrial units of current the car park

395
00:15:33,500 --> 00:15:39,300
company them above the door when are men

396
00:15:36,750 --> 00:15:42,060
so off he trots gets himself ready

397
00:15:39,300 --> 00:15:44,609
next day he sashes at the build and

398
00:15:42,060 --> 00:15:47,010
using his best physical se techniques

399
00:15:44,610 --> 00:15:48,270
which was basically he made a badge and

400
00:15:47,010 --> 00:15:50,550
then went and walked him through the

401
00:15:48,270 --> 00:15:51,810
front door it was a bit quiet in the

402
00:15:50,550 --> 00:15:53,670
office it was only one or two people

403
00:15:51,810 --> 00:15:55,500
milling about he was okay

404
00:15:53,670 --> 00:15:58,310
settled himself down in the corner

405
00:15:55,500 --> 00:16:01,440
plugged his laptop and went to town

406
00:15:58,310 --> 00:16:03,959
compromised the entire network zero to

407
00:16:01,440 --> 00:16:07,740
hero and about four hours using a

408
00:16:03,959 --> 00:16:08,660
printer it is a good consultant did a

409
00:16:07,740 --> 00:16:11,130
great job

410
00:16:08,660 --> 00:16:13,020
anyhow he's getting towards the end of

411
00:16:11,130 --> 00:16:14,880
the day in and he's thinking it's been

412
00:16:13,020 --> 00:16:17,220
real quiet yeah and one of his staff

413
00:16:14,880 --> 00:16:19,080
comes up him said look me he said I'm

414
00:16:17,220 --> 00:16:24,750
after a nearly knock off you couldn't

415
00:16:19,080 --> 00:16:27,140
lock up for me panic no mid maybe uh

416
00:16:24,750 --> 00:16:30,779
maybe I can't let them lock up for you

417
00:16:27,140 --> 00:16:33,630
I'm just leaving so as he's leavin he

418
00:16:30,779 --> 00:16:36,959
gets a phone call from the client said

419
00:16:33,630 --> 00:16:39,720
damn it said was there a reason you even

420
00:16:36,959 --> 00:16:41,849
so they don't anything today and easily

421
00:16:39,720 --> 00:16:45,380
what they said well I happened to be in

422
00:16:41,850 --> 00:16:48,200
the office he says and I haven't senior

423
00:16:45,380 --> 00:16:52,529
awkward silence

424
00:16:48,200 --> 00:16:57,149
I've been in the office all day hmm

425
00:16:52,529 --> 00:17:00,689
there's a problem sometimes things

426
00:16:57,149 --> 00:17:03,959
really don't go to plan Tom's area the

427
00:17:00,690 --> 00:17:06,350
company has two officers in a business

428
00:17:03,959 --> 00:17:09,389
park in multi-turreted buildings

429
00:17:06,349 --> 00:17:11,399
opposite industrial unit and hilariously

430
00:17:09,390 --> 00:17:14,280
saw the one Road apart and are still

431
00:17:11,400 --> 00:17:16,569
covered by the st. Paul's Court

432
00:17:14,280 --> 00:17:18,910
you cannot obtain for some of that stuff

433
00:17:16,569 --> 00:17:22,000
up and it like I said sometimes things

434
00:17:18,910 --> 00:17:24,370
just don't go to plan fortunately again

435
00:17:22,000 --> 00:17:25,990
when he got into the office the correct

436
00:17:24,369 --> 00:17:27,339
name was in the building he was on the

437
00:17:25,990 --> 00:17:29,110
right network he done his due diligence

438
00:17:27,339 --> 00:17:30,879
he's done all these checks

439
00:17:29,110 --> 00:17:32,559
he was definitely reckless and he had

440
00:17:30,880 --> 00:17:34,480
compromised the right network it was

441
00:17:32,559 --> 00:17:37,720
just from one of their small satellite

442
00:17:34,480 --> 00:17:38,920
offices that wasn't really in use but I

443
00:17:37,720 --> 00:17:40,179
think he'd give a lot of value to the

444
00:17:38,920 --> 00:17:42,190
client because the client had a lot of

445
00:17:40,179 --> 00:17:43,450
focus in their southern office and no he

446
00:17:42,190 --> 00:17:45,010
realized he could be completely

447
00:17:43,450 --> 00:17:48,340
compromised from a place that he wasn't

448
00:17:45,010 --> 00:17:52,629
invest in any security in so everybody's

449
00:17:48,340 --> 00:17:59,790
a winner except for the person that was

450
00:17:52,630 --> 00:17:59,790
going to give him the keys not great oh

451
00:18:03,270 --> 00:18:09,750
yeah

452
00:18:04,480 --> 00:18:09,750
so geography not the pen testers friend

453
00:18:10,260 --> 00:18:19,059
opps head write this this will be a

454
00:18:14,830 --> 00:18:22,178
painful slate for me personally our team

455
00:18:19,059 --> 00:18:39,879
and hopefully because it won't be

456
00:18:22,179 --> 00:18:43,780
painful for some of you guys OPSEC is

457
00:18:39,880 --> 00:18:50,620
hard things never go quite according to

458
00:18:43,780 --> 00:18:52,540
plan so we do we go to great lengths to

459
00:18:50,620 --> 00:18:54,610
make sure their objects as good as it

460
00:18:52,540 --> 00:18:58,600
possibly can be with enough red team we

461
00:18:54,610 --> 00:19:00,070
go to excruciating lengths and yet over

462
00:18:58,600 --> 00:19:02,290
the last five years there have been a

463
00:19:00,070 --> 00:19:04,840
number of occasions where when I look at

464
00:19:02,290 --> 00:19:07,600
them in the cold hard light of the slate

465
00:19:04,840 --> 00:19:10,689
in front of me I think why did we do

466
00:19:07,600 --> 00:19:13,209
some of that stuff in the bottom Lena is

467
00:19:10,690 --> 00:19:15,670
is winded on an engagement when time and

468
00:19:13,210 --> 00:19:18,580
pleasure is on when you are suddenly

469
00:19:15,670 --> 00:19:21,010
getting somewhere after many ds of

470
00:19:18,580 --> 00:19:23,260
getting nowhere the red mist comes down

471
00:19:21,010 --> 00:19:25,240
pen testers B pen testers and they just

472
00:19:23,260 --> 00:19:27,190
get on the keyboard and give it

473
00:19:25,240 --> 00:19:28,990
everything because they wanted to a good

474
00:19:27,190 --> 00:19:32,380
they want to get to the objective they

475
00:19:28,990 --> 00:19:35,770
want to provide value in the client and

476
00:19:32,380 --> 00:19:40,930
OPSEC is really hard so let's start with

477
00:19:35,770 --> 00:19:42,730
a beginning email we don't use things

478
00:19:40,930 --> 00:19:45,190
like Kingfisher than it should we don't

479
00:19:42,730 --> 00:19:46,780
do mass mail campaigns we have a

480
00:19:45,190 --> 00:19:50,440
separate offer and it does that when

481
00:19:46,780 --> 00:19:53,260
we're doing targeted attacks in an

482
00:19:50,440 --> 00:19:55,480
engagement we mean at the top end some

483
00:19:53,260 --> 00:19:58,450
send something like sex emails we don't

484
00:19:55,480 --> 00:20:00,220
send dozens of emails and throw all the

485
00:19:58,450 --> 00:20:02,350
per the wall and see what sticks

486
00:20:00,220 --> 00:20:03,760
we're very targeted in what we do so

487
00:20:02,350 --> 00:20:05,469
we've got in great pains to make sure

488
00:20:03,760 --> 00:20:07,060
that not only is the infrastructure that

489
00:20:05,470 --> 00:20:09,640
supports the pretext up and running

490
00:20:07,060 --> 00:20:11,260
looks legit we hope that emails also

491
00:20:09,640 --> 00:20:14,410
look legit and again when you do this

492
00:20:11,260 --> 00:20:16,420
globally we have interpreters who come

493
00:20:14,410 --> 00:20:18,370
in and they do the translation services

494
00:20:16,420 --> 00:20:20,530
for us and we have them do it in a way

495
00:20:18,370 --> 00:20:23,080
where it says don't just do what for

496
00:20:20,530 --> 00:20:24,460
what what this email says I wanted to

497
00:20:23,080 --> 00:20:26,679
sound exciting

498
00:20:24,460 --> 00:20:28,120
I know translators they go to work and

499
00:20:26,680 --> 00:20:29,850
they make these things look really

500
00:20:28,120 --> 00:20:32,080
beautiful and do a great job

501
00:20:29,850 --> 00:20:34,750
that's fine up to the point where one

502
00:20:32,080 --> 00:20:37,480
user very vigilant as they may be said

503
00:20:34,750 --> 00:20:40,780
hmm I didn't really expect this kind of

504
00:20:37,480 --> 00:20:43,120
email I'll send it to our em IT security

505
00:20:40,780 --> 00:20:46,120
and they can just check it out and they

506
00:20:43,120 --> 00:20:48,280
do a quick bit of reversing on the email

507
00:20:46,120 --> 00:20:51,760
they have a look at the the X handles

508
00:20:48,280 --> 00:20:53,320
and lord behold the Exeter Ginny and IP

509
00:20:51,760 --> 00:20:55,150
is pointing straight back in there it

510
00:20:53,320 --> 00:20:57,070
should IP address because when the guys

511
00:20:55,150 --> 00:20:58,510
were testing they were testing it from

512
00:20:57,070 --> 00:21:01,030
there to done for structure rather than

513
00:20:58,510 --> 00:21:04,210
doing it from a VPS in there and the

514
00:21:01,030 --> 00:21:06,580
waveone on some well sounds really beli

515
00:21:04,210 --> 00:21:08,830
basic but when you've tested the same

516
00:21:06,580 --> 00:21:11,770
email for your 50 times to make sure

517
00:21:08,830 --> 00:21:13,870
it's absolutely perfect the one time

518
00:21:11,770 --> 00:21:16,150
you're not connected to the VPS when

519
00:21:13,870 --> 00:21:18,459
you're testing it is immediately the one

520
00:21:16,150 --> 00:21:23,340
that you see yeah this is good to go and

521
00:21:18,460 --> 00:21:23,340
you get you get nailed for it it's hard

522
00:21:24,210 --> 00:21:27,760
doc you may hear if you're sending

523
00:21:26,410 --> 00:21:31,330
documents and whether it's supporting

524
00:21:27,760 --> 00:21:34,120
documents and documents to to back up

525
00:21:31,330 --> 00:21:35,919
your pretext then make sure you strip

526
00:21:34,120 --> 00:21:39,639
the metadata from it if you've created

527
00:21:35,920 --> 00:21:40,640
it using a VM that's owned by the

528
00:21:39,640 --> 00:21:44,720
corporate on it

529
00:21:40,640 --> 00:21:48,590
your own person again you thinking what

530
00:21:44,720 --> 00:21:51,590
idea does that we've done it you know

531
00:21:48,590 --> 00:21:55,220
it's over five years there's a lot of

532
00:21:51,590 --> 00:21:57,290
things can happen so again we tell you

533
00:21:55,220 --> 00:21:59,060
hopefully you remember strip the matter

534
00:21:57,290 --> 00:22:01,250
dear and they only happen the ones but

535
00:21:59,060 --> 00:22:04,810
it's always the one time that you use it

536
00:22:01,250 --> 00:22:04,810
that you don't that you don't do it

537
00:22:04,840 --> 00:22:11,060
social media well we're using social

538
00:22:08,570 --> 00:22:12,439
media not for social media purposes but

539
00:22:11,060 --> 00:22:15,110
for targeting because that's what we

540
00:22:12,440 --> 00:22:17,360
make you do don't use called personal

541
00:22:15,110 --> 00:22:19,879
accounts think of LinkedIn and who's

542
00:22:17,360 --> 00:22:21,830
viewing my profile if they see a lotta

543
00:22:19,880 --> 00:22:23,030
Healy bums pentesters looking at the

544
00:22:21,830 --> 00:22:25,790
profile and suddenly they've got an

545
00:22:23,030 --> 00:22:28,030
email or from them the job with a waddle

546
00:22:25,790 --> 00:22:31,940
waddle on a stick associated with it

547
00:22:28,030 --> 00:22:33,680
it's probably not good so use your phone

548
00:22:31,940 --> 00:22:34,820
that account use those things that

549
00:22:33,680 --> 00:22:36,800
aren't on your finger print your

550
00:22:34,820 --> 00:22:38,870
organization or your team when you're

551
00:22:36,800 --> 00:22:43,129
when you're doing your reconnaissance on

552
00:22:38,870 --> 00:22:45,139
your targets again somes obvious I'll

553
00:22:43,130 --> 00:22:46,820
just check I need enough of target I'm

554
00:22:45,140 --> 00:22:49,310
really struggling they've all gone on

555
00:22:46,820 --> 00:22:51,379
holiday I've got nobody left from Ti to

556
00:22:49,310 --> 00:22:53,419
target let me have a look at LinkedIn

557
00:22:51,380 --> 00:23:02,120
and you forget to use your non corporate

558
00:22:53,420 --> 00:23:04,610
McCain the individuals not here I'll be

559
00:23:02,120 --> 00:23:06,770
P you're in the environment you've got

560
00:23:04,610 --> 00:23:08,479
the ability to our VP table service it's

561
00:23:06,770 --> 00:23:11,780
a great it's a great thing to have if

562
00:23:08,480 --> 00:23:13,670
you've got that level of compromise now

563
00:23:11,780 --> 00:23:14,840
when you're cleaning up and it's the

564
00:23:13,670 --> 00:23:18,860
middle of the night and it's on a

565
00:23:14,840 --> 00:23:21,199
weekend and you think oh that box that

566
00:23:18,860 --> 00:23:23,270
hasn't been in is online I'll go and do

567
00:23:21,200 --> 00:23:24,380
my cleanup because I'm a good pen tester

568
00:23:23,270 --> 00:23:26,360
but I want to make sure that everything

569
00:23:24,380 --> 00:23:27,860
is clean and it's the middle of the

570
00:23:26,360 --> 00:23:30,949
night and obviously there's nobody there

571
00:23:27,860 --> 00:23:32,570
when you do RDP and it said this will

572
00:23:30,950 --> 00:23:35,680
tell many another user session do you

573
00:23:32,570 --> 00:23:38,389
want to carry on the answer is always no

574
00:23:35,680 --> 00:23:39,350
because when it's yes they're like

575
00:23:38,390 --> 00:23:43,060
something's just kicked me off my

576
00:23:39,350 --> 00:23:47,169
computer police something's happening

577
00:23:43,060 --> 00:23:48,950
real real story he's never lived it down

578
00:23:47,170 --> 00:23:50,750
basically because I won't let them

579
00:23:48,950 --> 00:23:53,570
forget I asked

580
00:23:50,750 --> 00:23:56,360
as a bar of light using your

581
00:23:53,570 --> 00:23:58,580
certificates again that the three know

582
00:23:56,360 --> 00:24:01,250
you've got multiple VP aces and you've

583
00:23:58,580 --> 00:24:02,570
got they're obviously all secured make

584
00:24:01,250 --> 00:24:05,120
sure you're not doing things that leave

585
00:24:02,570 --> 00:24:07,789
in other infrastructure names in the old

586
00:24:05,120 --> 00:24:09,889
the old names hair does it really trust

587
00:24:07,789 --> 00:24:12,890
me it's easy to do and it's happened and

588
00:24:09,890 --> 00:24:15,740
when the the blue team Aranya stuff like

589
00:24:12,890 --> 00:24:18,830
that it is not fun in the debriefs it

590
00:24:15,740 --> 00:24:22,870
does not look good but it happens so be

591
00:24:18,830 --> 00:24:22,870
careful when this stuff BAM is going on

592
00:24:24,370 --> 00:24:29,840
VPNs will love them you've compromised

593
00:24:27,530 --> 00:24:32,330
the network you've got credentials you

594
00:24:29,840 --> 00:24:35,928
discover they've got single facts of SSL

595
00:24:32,330 --> 00:24:37,490
VPN open to the world it's game over and

596
00:24:35,929 --> 00:24:40,340
you're gonna bypass all of their

597
00:24:37,490 --> 00:24:43,669
boundary controls and get your VM setup

598
00:24:40,340 --> 00:24:47,230
your VPN n brilliant I'm now a machine

599
00:24:43,669 --> 00:24:50,780
on the network I can do whatever I want

600
00:24:47,230 --> 00:24:53,360
leak hacks or box as a computer name and

601
00:24:50,780 --> 00:24:55,720
fuzzy navel as your what grip sticks out

602
00:24:53,360 --> 00:24:58,039
like the proverbial on a client network

603
00:24:55,720 --> 00:25:00,730
remember to change the things that are

604
00:24:58,039 --> 00:25:00,730
obvious

605
00:25:01,210 --> 00:25:07,130
again you don't really obvious what I'm

606
00:25:04,789 --> 00:25:09,020
saying and it is kind of obvious in the

607
00:25:07,130 --> 00:25:11,000
cold light of day but as soon as you get

608
00:25:09,020 --> 00:25:12,740
out VPN access you've got two hours left

609
00:25:11,000 --> 00:25:14,990
before the end of the engagement you've

610
00:25:12,740 --> 00:25:16,600
got to use it right they've easy to

611
00:25:14,990 --> 00:25:24,520
forget something like that

612
00:25:16,600 --> 00:25:28,399
be aware that DNS so you know that

613
00:25:24,520 --> 00:25:30,049
basically when you've got multiple

614
00:25:28,400 --> 00:25:33,350
engagements on and you using lots of

615
00:25:30,049 --> 00:25:34,970
different DNS don't share them between

616
00:25:33,350 --> 00:25:36,678
engagements now again that sounds

617
00:25:34,970 --> 00:25:39,380
obvious you should never reuse em your

618
00:25:36,679 --> 00:25:41,330
collateral if you've got a lot of

619
00:25:39,380 --> 00:25:43,220
collateral in the bank because you've

620
00:25:41,330 --> 00:25:44,960
stored an up you're getting reputation

621
00:25:43,220 --> 00:25:47,360
you did all these good things it's

622
00:25:44,960 --> 00:25:49,580
really easy to lose track tracking

623
00:25:47,360 --> 00:25:51,379
things that all the domains all the IPS

624
00:25:49,580 --> 00:25:53,178
state all the websites that you've got

625
00:25:51,380 --> 00:25:56,270
up and running for your engagements

626
00:25:53,179 --> 00:25:57,799
going forward if people aren't marking

627
00:25:56,270 --> 00:25:59,860
down what they're using when they're

628
00:25:57,799 --> 00:26:02,360
using how they're using it is it bombed

629
00:25:59,860 --> 00:26:03,678
and it has quite an overhead and it's a

630
00:26:02,360 --> 00:26:04,189
struggle for all teams that I've ever

631
00:26:03,679 --> 00:26:06,440
spoke

632
00:26:04,190 --> 00:26:09,409
- is how they hope they track the

633
00:26:06,440 --> 00:26:10,850
collateral it will get you caught in the

634
00:26:09,409 --> 00:26:14,299
end because as soon as you could put on

635
00:26:10,850 --> 00:26:16,549
your black list by company X company

636
00:26:14,299 --> 00:26:19,370
wise got the same feat and suddenly

637
00:26:16,549 --> 00:26:21,740
you're bombed before you started so

638
00:26:19,370 --> 00:26:25,158
tracking your collateral through DNS it

639
00:26:21,740 --> 00:26:26,960
is you know it's something that it's

640
00:26:25,159 --> 00:26:32,000
hard but you've got to sort of be aware

641
00:26:26,960 --> 00:26:34,429
of it on domain reputation so again we

642
00:26:32,000 --> 00:26:36,019
do things like we always bind them in

643
00:26:34,429 --> 00:26:37,190
privacy and everybody said I don't

644
00:26:36,019 --> 00:26:38,269
bother about gdpr

645
00:26:37,190 --> 00:26:41,600
fix it all that takes all that

646
00:26:38,269 --> 00:26:43,460
information now it's not global yeah if

647
00:26:41,600 --> 00:26:44,600
you ever got the option to buy it buy it

648
00:26:43,460 --> 00:26:46,519
if you don't get the option use a

649
00:26:44,600 --> 00:26:48,740
different provider you know those

650
00:26:46,519 --> 00:26:51,379
historical who has records against the

651
00:26:48,740 --> 00:26:52,970
registrant is gonna get you caught again

652
00:26:51,379 --> 00:26:54,379
maybe not in the outset maybe not in the

653
00:26:52,970 --> 00:26:56,120
LEDs but as soon as the blue team have

654
00:26:54,379 --> 00:26:57,110
got a snap they're going to use all

655
00:26:56,120 --> 00:26:59,149
their tools and they're gonna

656
00:26:57,110 --> 00:27:03,258
fingerprint you at which point it says

657
00:26:59,149 --> 00:27:05,479
kind of game over for you to be in

658
00:27:03,259 --> 00:27:08,690
Plymouth II so you've got domain

659
00:27:05,480 --> 00:27:11,179
reputation we a particular piece of

660
00:27:08,690 --> 00:27:15,379
infrastructure you using you use your

661
00:27:11,179 --> 00:27:17,750
checking it against the type of proxy

662
00:27:15,379 --> 00:27:19,189
you use a blue court for example don't

663
00:27:17,750 --> 00:27:20,570
just check it against what you think

664
00:27:19,190 --> 00:27:25,129
you're going against check it against

665
00:27:20,570 --> 00:27:27,080
all of the providers that we it may look

666
00:27:25,129 --> 00:27:28,519
good on one provider it may not look

667
00:27:27,080 --> 00:27:30,529
good another and eventually they all

668
00:27:28,519 --> 00:27:33,230
synchronize and that'll get you caught

669
00:27:30,529 --> 00:27:34,759
so you know do your due diligence it

670
00:27:33,230 --> 00:27:36,769
only takes a few minutes more to check

671
00:27:34,759 --> 00:27:38,870
against all your providers rather than

672
00:27:36,769 --> 00:27:40,639
just the one that looks good on that

673
00:27:38,870 --> 00:27:44,719
we're good to go you need to check it

674
00:27:40,639 --> 00:27:47,029
everywhere and we spoke a little bit of

675
00:27:44,720 --> 00:27:51,070
a tracking your collateral it's really

676
00:27:47,029 --> 00:27:52,850
really hard and keep all of this stuff

677
00:27:51,070 --> 00:27:54,408
you know if you've got four or five

678
00:27:52,850 --> 00:27:56,600
engagements run it and simultaneously

679
00:27:54,409 --> 00:27:57,919
who's using this website who's using

680
00:27:56,600 --> 00:27:59,928
that who's using those email addresses

681
00:27:57,919 --> 00:28:01,879
use your build miss Clavel up you've

682
00:27:59,929 --> 00:28:04,159
gotta have a reliable way of tracking it

683
00:28:01,879 --> 00:28:06,439
or your DNS names or your IP addresses

684
00:28:04,159 --> 00:28:08,750
all of that stuff and because again the

685
00:28:06,440 --> 00:28:10,519
blue teams are on it and it's hard for

686
00:28:08,750 --> 00:28:12,379
you but once they fingerprint if you

687
00:28:10,519 --> 00:28:14,240
once they've got that little thread that

688
00:28:12,379 --> 00:28:15,678
they can start tugging at it's much

689
00:28:14,240 --> 00:28:17,960
easier for them to be able to track all

690
00:28:15,679 --> 00:28:20,090
that back

691
00:28:17,960 --> 00:28:23,389
when you're using things like your WS

692
00:28:20,090 --> 00:28:25,428
you know I lacked elastic IPS by them

693
00:28:23,389 --> 00:28:27,110
the last thing you need is because you

694
00:28:25,429 --> 00:28:29,090
have to do a reboot at a sale but for

695
00:28:27,110 --> 00:28:32,209
whatever reason as you end up getting a

696
00:28:29,090 --> 00:28:35,570
definite IP address all of your c2 is

697
00:28:32,210 --> 00:28:38,029
coming back to an IP address that you no

698
00:28:35,570 --> 00:28:39,950
longer have and even what somebody else

699
00:28:38,029 --> 00:28:41,570
you know has that's not a great place to

700
00:28:39,950 --> 00:28:43,360
be and you run around like a lunatic

701
00:28:41,570 --> 00:28:47,299
trying to change all your DNS and stuff

702
00:28:43,360 --> 00:28:48,979
that's it's only for what these

703
00:28:47,299 --> 00:28:50,720
engagements cost to run and stuff it's

704
00:28:48,980 --> 00:28:56,690
not a lot of money to get em elastic I'm

705
00:28:50,720 --> 00:28:59,809
Peas so use the wheel you can and here

706
00:28:56,690 --> 00:29:02,419
here's my favorite it is my personal

707
00:28:59,809 --> 00:29:05,210
humble opinion that you cannot conduct

708
00:29:02,419 --> 00:29:07,340
proper red team's without dropping files

709
00:29:05,210 --> 00:29:10,190
to desk as a lot of people will tell you

710
00:29:07,340 --> 00:29:12,320
that it's possible we've been doing this

711
00:29:10,190 --> 00:29:14,929
a long time you can't do it reliably

712
00:29:12,320 --> 00:29:17,389
it's just not a thing but I'm not saying

713
00:29:14,929 --> 00:29:18,980
that you go and use free X's all over

714
00:29:17,389 --> 00:29:21,559
the car get environment that's know what

715
00:29:18,980 --> 00:29:24,499
I'm saying be careful about fails you

716
00:29:21,559 --> 00:29:28,070
draw and absolutely record everything

717
00:29:24,499 --> 00:29:31,159
you drop in a target environment I take

718
00:29:28,070 --> 00:29:33,710
the stamp it location and don't just do

719
00:29:31,159 --> 00:29:34,909
I please do host names because IPS can

720
00:29:33,710 --> 00:29:37,610
change in target environments but also

721
00:29:34,909 --> 00:29:40,249
even generally stay the same yeah make

722
00:29:37,610 --> 00:29:42,139
sure that any artifacts that you either

723
00:29:40,249 --> 00:29:44,720
leave or you change in the target

724
00:29:42,139 --> 00:29:46,998
environment is absolutely picked up by

725
00:29:44,720 --> 00:29:49,850
you as the team recorded and available

726
00:29:46,999 --> 00:29:52,129
immediately that the client said or we

727
00:29:49,850 --> 00:29:53,509
think we've got a real breach I need to

728
00:29:52,129 --> 00:29:55,158
know everything you've done where you've

729
00:29:53,509 --> 00:29:57,289
been what you've been doing because we

730
00:29:55,159 --> 00:29:59,119
need to remove attribution because we've

731
00:29:57,289 --> 00:30:01,999
got an incident response team at ten

732
00:29:59,119 --> 00:30:03,918
grand an hour who make spends two weeks

733
00:30:01,999 --> 00:30:05,629
chasing you around the network that's

734
00:30:03,919 --> 00:30:07,909
not good and if you can pervade that

735
00:30:05,629 --> 00:30:09,469
reliably in a short space of time you

736
00:30:07,909 --> 00:30:11,990
will get mega but any points where your

737
00:30:09,470 --> 00:30:13,369
clients and they'll love you for it not

738
00:30:11,990 --> 00:30:17,450
recall that it and not being able to

739
00:30:13,369 --> 00:30:18,799
provide it it's just not an option if

740
00:30:17,450 --> 00:30:21,019
you're doing red team engages and you

741
00:30:18,799 --> 00:30:23,149
can't pervade all of those things could

742
00:30:21,019 --> 00:30:26,090
really quickly to your clients if you're

743
00:30:23,149 --> 00:30:27,590
doing them a disservice and several

744
00:30:26,090 --> 00:30:29,449
times in the last couple years we've

745
00:30:27,590 --> 00:30:31,209
been on target and we've either

746
00:30:29,450 --> 00:30:33,400
discovered what looks like

747
00:30:31,210 --> 00:30:35,410
a breach in progress or a recent breach

748
00:30:33,400 --> 00:30:38,320
or they've had an incident happen where

749
00:30:35,410 --> 00:30:40,570
we've been on the environment and we

750
00:30:38,320 --> 00:30:42,429
have got better we've not been great at

751
00:30:40,570 --> 00:30:44,919
the start but we've really sort of

752
00:30:42,430 --> 00:30:48,130
refined our process we can now provide

753
00:30:44,920 --> 00:30:51,400
them with everything we've done in in

754
00:30:48,130 --> 00:30:53,620
really minutes and after they tell us we

755
00:30:51,400 --> 00:30:55,150
can provide all that information - and

756
00:30:53,620 --> 00:30:57,850
it's important that you're doing that

757
00:30:55,150 --> 00:30:59,740
for all of your clients and at the end

758
00:30:57,850 --> 00:31:01,840
they need it anyway because if something

759
00:30:59,740 --> 00:31:03,280
happens down the lane and you haven't

760
00:31:01,840 --> 00:31:05,470
been able to clean up because a machine

761
00:31:03,280 --> 00:31:07,600
has gone offline the user has gone to

762
00:31:05,470 --> 00:31:09,370
Barbados for a month already and taking

763
00:31:07,600 --> 00:31:11,199
a laptop with them you can't clean it up

764
00:31:09,370 --> 00:31:12,580
from now so you need to eat it comes

765
00:31:11,200 --> 00:31:14,500
back to the environment you've finished

766
00:31:12,580 --> 00:31:16,060
the engagement but the clients the

767
00:31:14,500 --> 00:31:17,950
information they need and all that they

768
00:31:16,060 --> 00:31:22,770
clean up manually it's really important

769
00:31:17,950 --> 00:31:26,590
and it will that'll do you wonders and

770
00:31:22,770 --> 00:31:28,240
it drop in files to desk have the

771
00:31:26,590 --> 00:31:30,100
ability to time stop if your turbine

772
00:31:28,240 --> 00:31:32,980
doesn't all of it you know creating that

773
00:31:30,100 --> 00:31:35,740
capability blue team's love this when

774
00:31:32,980 --> 00:31:36,790
every fails got the system created deep

775
00:31:35,740 --> 00:31:38,440
stomp on it

776
00:31:36,790 --> 00:31:40,030
they can't just track you back to

777
00:31:38,440 --> 00:31:42,250
whatever was dropped in the last two

778
00:31:40,030 --> 00:31:44,470
days they have to do a proper

779
00:31:42,250 --> 00:31:46,270
investigation and remember you're there

780
00:31:44,470 --> 00:31:48,310
to test the blue team's capabilities

781
00:31:46,270 --> 00:31:50,170
that incident response so you want to

782
00:31:48,310 --> 00:31:51,700
know how well they can do it if all they

783
00:31:50,170 --> 00:31:54,640
have to do is a quick sale - and last

784
00:31:51,700 --> 00:31:56,020
access time or last created time then

785
00:31:54,640 --> 00:31:57,460
you know you're not you're not

786
00:31:56,020 --> 00:32:06,400
stretching them you're not you're not

787
00:31:57,460 --> 00:32:11,230
giving them a proper test so what we

788
00:32:06,400 --> 00:32:12,820
found outside of the OPSEC and the the

789
00:32:11,230 --> 00:32:14,620
mistakes that have been made is we've

790
00:32:12,820 --> 00:32:18,340
got to the stage on a target environment

791
00:32:14,620 --> 00:32:20,530
where we've found the the target system

792
00:32:18,340 --> 00:32:23,530
we know who the users of the target

793
00:32:20,530 --> 00:32:26,020
system are we compromised the Machine

794
00:32:23,530 --> 00:32:28,720
the user ones or counter leash all that

795
00:32:26,020 --> 00:32:31,120
emilich come on then login a nap pod

796
00:32:28,720 --> 00:32:33,400
volume with an alcohol time 14 medals

797
00:32:31,120 --> 00:32:35,709
and you spend a week watching them

798
00:32:33,400 --> 00:32:38,230
playing bubbles and looking at really

799
00:32:35,710 --> 00:32:42,010
expensive hoses on the internet with the

800
00:32:38,230 --> 00:32:43,590
tab sat up in the corner just waiting

801
00:32:42,010 --> 00:32:46,710
for you to wait for

802
00:32:43,590 --> 00:32:49,760
click on it and it doesn't happen so we

803
00:32:46,710 --> 00:32:49,760
need the right tools for the job

804
00:32:50,960 --> 00:32:57,210
pentesters you got all of them so tool

805
00:32:54,510 --> 00:32:59,700
development because of we've run into

806
00:32:57,210 --> 00:33:01,500
situations where if we hit a better

807
00:32:59,700 --> 00:33:03,990
capability we could have saved ourselves

808
00:33:01,500 --> 00:33:06,809
lots of pain lots of heartache wasa

809
00:33:03,990 --> 00:33:08,520
grief over that you know when there

810
00:33:06,809 --> 00:33:10,950
hasn't been capability you know how guys

811
00:33:08,520 --> 00:33:12,809
have been they've been amazing they go

812
00:33:10,950 --> 00:33:15,299
back and I'll it we can't currently do

813
00:33:12,809 --> 00:33:16,500
this so let's figure out how we can do

814
00:33:15,299 --> 00:33:18,658
it and we're going to rate a tool to do

815
00:33:16,500 --> 00:33:22,710
it for us and that's you know that's

816
00:33:18,659 --> 00:33:25,320
what you want no this goes back to the

817
00:33:22,710 --> 00:33:27,000
early days and I'm sure you'll all be

818
00:33:25,320 --> 00:33:28,799
aware one of the first things that we

819
00:33:27,000 --> 00:33:31,500
run into that there wasn't really any

820
00:33:28,799 --> 00:33:34,620
tool available for was a proxy or we are

821
00:33:31,500 --> 00:33:36,330
Seto back in the day things like Empire

822
00:33:34,620 --> 00:33:38,580
I'm softly we couldn't handle proxy

823
00:33:36,330 --> 00:33:40,740
weird environment and where clients are

824
00:33:38,580 --> 00:33:45,110
slowly catching up on the security M

825
00:33:40,740 --> 00:33:47,460
sort of ramp most of them had an

826
00:33:45,110 --> 00:33:52,199
authenticated proxy and we see all the

827
00:33:47,460 --> 00:33:54,330
time so young mr. Tonga and several

828
00:33:52,200 --> 00:33:57,059
other people mr. Hardy as well and

829
00:33:54,330 --> 00:33:59,370
develop or see too many of you will be

830
00:33:57,059 --> 00:34:03,510
familiar with it it's an ongoing project

831
00:33:59,370 --> 00:34:06,860
and young mr. Rob born who's started I

832
00:34:03,510 --> 00:34:09,869
see however you rob here you go

833
00:34:06,860 --> 00:34:11,940
Rob there's a lot of Dearborn Posse to

834
00:34:09,869 --> 00:34:14,129
know and it's gone from what was

835
00:34:11,940 --> 00:34:17,070
effectively a tool that allowed the guys

836
00:34:14,129 --> 00:34:18,560
to get through proxy we are to create

837
00:34:17,070 --> 00:34:21,300
proxy we have payloads and get through

838
00:34:18,560 --> 00:34:22,739
authenticated proxies and to something

839
00:34:21,300 --> 00:34:24,990
that's now a fully fledged C to a

840
00:34:22,739 --> 00:34:27,020
framework where you know you can write

841
00:34:24,989 --> 00:34:29,368
all you don't more jewels add to it

842
00:34:27,020 --> 00:34:32,759
customize it do what you will with it

843
00:34:29,369 --> 00:34:34,050
but that was the original requirement

844
00:34:32,760 --> 00:34:35,879
that's why they were Auto only wanted to

845
00:34:34,050 --> 00:34:40,520
lay on the pile shell because back then

846
00:34:35,879 --> 00:34:40,520
pearl wasn't dead it was still a thing

847
00:34:40,909 --> 00:34:47,250
but and party to was born up so one of

848
00:34:45,540 --> 00:34:50,369
the other things that we discovered

849
00:34:47,250 --> 00:34:52,080
again you don't target and you've you've

850
00:34:50,369 --> 00:34:55,050
got the sea to channel your interactive

851
00:34:52,080 --> 00:34:57,810
PowerShell or whatever that is the soul

852
00:34:55,050 --> 00:35:00,000
still some things you can't do

853
00:34:57,810 --> 00:35:01,650
some of our target applications you

854
00:35:00,000 --> 00:35:04,230
needed to help GUI access

855
00:35:01,650 --> 00:35:07,530
that's either a thick client or it's sat

856
00:35:04,230 --> 00:35:10,170
behind a web front-end or at some and

857
00:35:07,530 --> 00:35:12,480
they created the s400 type system it's

858
00:35:10,170 --> 00:35:14,940
got some we have interface that only

859
00:35:12,480 --> 00:35:16,530
runs on the desktop decline and unless

860
00:35:14,940 --> 00:35:18,570
you can get your grubby little fingers

861
00:35:16,530 --> 00:35:20,070
on it you can't do a lot and that's

862
00:35:18,570 --> 00:35:22,380
really frustrating and when you've gone

863
00:35:20,070 --> 00:35:24,270
all the time and effort of camping on

864
00:35:22,380 --> 00:35:27,830
the user's box you can see them using it

865
00:35:24,270 --> 00:35:35,640
and you can't do anything with it so Oh

866
00:35:27,830 --> 00:35:38,009
surely we wrote on socks proxy source

867
00:35:35,640 --> 00:35:39,750
it's not due up until the point where we

868
00:35:38,010 --> 00:35:41,550
brought this the only thing we came to

869
00:35:39,750 --> 00:35:45,360
had available was the socks proxy from

870
00:35:41,550 --> 00:35:47,790
Metasploit no it was a good sock proxy

871
00:35:45,360 --> 00:35:49,740
but everybody new hope you fingerprint

872
00:35:47,790 --> 00:35:51,420
er so throw an N here and engagement

873
00:35:49,740 --> 00:35:54,180
with again you spent a lot of time

874
00:35:51,420 --> 00:35:56,790
effort and you know money get into the

875
00:35:54,180 --> 00:35:59,370
end point and then throw it and you know

876
00:35:56,790 --> 00:36:03,660
a better Metasploit cord probably not

877
00:35:59,370 --> 00:36:05,730
great so one of them guys rob Maslin and

878
00:36:03,660 --> 00:36:11,700
with help from other people and team you

879
00:36:05,730 --> 00:36:14,430
look sharp socks bombs as you can see

880
00:36:11,700 --> 00:36:16,470
you've got the attackers machine mail

881
00:36:14,430 --> 00:36:18,740
and this is all we do it allows us to

882
00:36:16,470 --> 00:36:22,649
proxy our traffic over Dorsey to comms

883
00:36:18,740 --> 00:36:25,109
to the M the infected machine at the

884
00:36:22,650 --> 00:36:27,480
other side and then we've got GUI access

885
00:36:25,110 --> 00:36:29,550
so we can run stuff from outside if

886
00:36:27,480 --> 00:36:30,870
they're using a thick client we can

887
00:36:29,550 --> 00:36:32,790
download the thick client from their

888
00:36:30,870 --> 00:36:35,700
machine we can run up on our machine and

889
00:36:32,790 --> 00:36:38,130
we can proxy it down we can and we can

890
00:36:35,700 --> 00:36:42,390
run you know like you can on any sort of

891
00:36:38,130 --> 00:36:45,300
proxy you can run proxy chains or proxy

892
00:36:42,390 --> 00:36:47,100
cap and you can use a browser you can

893
00:36:45,300 --> 00:36:48,930
use any number of tools on the endpoint

894
00:36:47,100 --> 00:36:50,370
and all it does is it just tunnels

895
00:36:48,930 --> 00:36:53,779
everything don't know the existence c2

896
00:36:50,370 --> 00:36:56,190
and you've got effect of doing access um

897
00:36:53,780 --> 00:36:58,860
sounds really billy basics it was

898
00:36:56,190 --> 00:37:00,660
actually much much harder than we ever

899
00:36:58,860 --> 00:37:04,950
thought is to be able to run the source

900
00:37:00,660 --> 00:37:07,410
proxy across the sea to comms and not to

901
00:37:04,950 --> 00:37:10,040
be visible to the other site and that's

902
00:37:07,410 --> 00:37:10,040
the beauty of it

903
00:37:11,340 --> 00:37:15,750
it's been recently updated anybody who's

904
00:37:13,440 --> 00:37:17,910
keeps up with posh develoment Portuguese

905
00:37:15,750 --> 00:37:20,880
these shark flops as bill and it's it's

906
00:37:17,910 --> 00:37:22,200
super reliable it's super fast and it's

907
00:37:20,880 --> 00:37:24,960
really it's made a massive difference

908
00:37:22,200 --> 00:37:27,660
you know using operators on now to get

909
00:37:24,960 --> 00:37:30,000
to the target application and the

910
00:37:27,660 --> 00:37:32,629
backend it's a breeze and it's really

911
00:37:30,000 --> 00:37:32,630
made a difference

912
00:37:34,400 --> 00:37:39,090
the other thing that we often have like

913
00:37:36,840 --> 00:37:40,800
I said a couple of the guys spent best

914
00:37:39,090 --> 00:37:42,420
part of a week camped on a user's

915
00:37:40,800 --> 00:37:44,340
machine the user of the target

916
00:37:42,420 --> 00:37:47,160
application and all he did was look for

917
00:37:44,340 --> 00:37:49,820
expensive houses and play bubbles it was

918
00:37:47,160 --> 00:37:53,279
an investment banker and he dead Norwalk

919
00:37:49,820 --> 00:37:54,450
whatsoever and I dread to think what

920
00:37:53,280 --> 00:37:56,550
they were paying him but looking at the

921
00:37:54,450 --> 00:37:57,930
houses he was looking at it was lots of

922
00:37:56,550 --> 00:38:02,310
money it wasn't even that good at

923
00:37:57,930 --> 00:38:04,319
bubbles we could see his desktop we

924
00:38:02,310 --> 00:38:07,529
would count there we were watch and has

925
00:38:04,320 --> 00:38:09,480
screamed the entire time and we could

926
00:38:07,530 --> 00:38:10,530
see the tab or the target application

927
00:38:09,480 --> 00:38:12,600
name Annette

928
00:38:10,530 --> 00:38:14,820
all you needed to do was click on that

929
00:38:12,600 --> 00:38:17,730
tab and with keylogger and we'd then

930
00:38:14,820 --> 00:38:19,980
socks proxy and we would be him a week

931
00:38:17,730 --> 00:38:22,290
he never would be about tab he never

932
00:38:19,980 --> 00:38:24,350
touched what effectively has job was I

933
00:38:22,290 --> 00:38:29,070
know you got a we're here

934
00:38:24,350 --> 00:38:30,500
so again mister Maslin he wrote a tool

935
00:38:29,070 --> 00:38:32,850
called power thief

936
00:38:30,500 --> 00:38:34,530
I'll apologize for the next gift is

937
00:38:32,850 --> 00:38:35,850
coming up because this is Rob Moslems

938
00:38:34,530 --> 00:38:38,490
walk and anybody who's walked with them

939
00:38:35,850 --> 00:38:40,560
the guys are genius but his ability to

940
00:38:38,490 --> 00:38:43,319
actually use computers for like things

941
00:38:40,560 --> 00:38:45,480
with words PowerPoint stock shocking the

942
00:38:43,320 --> 00:38:48,650
guy has struggled with phones and yet

943
00:38:45,480 --> 00:38:51,150
he's got massive noggin really clever

944
00:38:48,650 --> 00:38:52,920
but I'll let it run through a couple of

945
00:38:51,150 --> 00:39:00,810
times and I will explain what it's kind

946
00:38:52,920 --> 00:39:03,510
of doing I it just needs to get itself

947
00:39:00,810 --> 00:39:08,040
back to the beginning it's not a video

948
00:39:03,510 --> 00:39:08,970
is just a gif alright so the first thing

949
00:39:08,040 --> 00:39:13,710
you're going to see you're going to see

950
00:39:08,970 --> 00:39:14,939
a blows up in multiple towers that's the

951
00:39:13,710 --> 00:39:17,640
one that you're after if the user

952
00:39:14,940 --> 00:39:19,380
doesn't click on it you know you're

953
00:39:17,640 --> 00:39:21,960
going to struggle to get there there's a

954
00:39:19,380 --> 00:39:24,270
particular dpi is interested in he's

955
00:39:21,960 --> 00:39:25,090
gonna run power thief on the implant of

956
00:39:24,270 --> 00:39:27,880
sound that

957
00:39:25,090 --> 00:39:29,890
as a little other functionality you can

958
00:39:27,880 --> 00:39:32,680
see the three tabs there that are open

959
00:39:29,890 --> 00:39:35,589
he could pick any one of them choose the

960
00:39:32,680 --> 00:39:38,589
ID and dump the HTML at Fame the

961
00:39:35,590 --> 00:39:40,960
particular API or whatever ID fielding

962
00:39:38,590 --> 00:39:43,360
he wanted as you can see there the idea

963
00:39:40,960 --> 00:39:45,130
was API secret and you can dump that

964
00:39:43,360 --> 00:39:46,690
into the command line and it will pull

965
00:39:45,130 --> 00:39:48,790
that open it doesn't matter what tab

966
00:39:46,690 --> 00:39:51,340
you're viewing at the time it can

967
00:39:48,790 --> 00:39:53,259
interact with the browser and pull each

968
00:39:51,340 --> 00:39:55,360
tml back from any of the tabs that are

969
00:39:53,260 --> 00:39:57,700
open and there was a whole raft of also

970
00:39:55,360 --> 00:40:00,880
think in this case think of something

971
00:39:57,700 --> 00:40:02,799
he's using the password manager password

972
00:40:00,880 --> 00:40:04,570
managers don't work for us for key login

973
00:40:02,800 --> 00:40:06,280
because obviously it's being copy and

974
00:40:04,570 --> 00:40:07,720
pasted oh but if you can pull it back

975
00:40:06,280 --> 00:40:11,830
straight from the blows of when it's

976
00:40:07,720 --> 00:40:13,750
been entered you're then you know the

977
00:40:11,830 --> 00:40:17,350
links at the end of the presentation

978
00:40:13,750 --> 00:40:20,560
you'll be able to go Rob did a talk on

979
00:40:17,350 --> 00:40:22,720
this a year ago I think there's a blog

980
00:40:20,560 --> 00:40:25,330
the tool is available as a standalone as

981
00:40:22,720 --> 00:40:30,220
well as a mat being available for C to

982
00:40:25,330 --> 00:40:31,740
inbox and allows you to do a whole draft

983
00:40:30,220 --> 00:40:34,270
of all the stuffs it allows you to

984
00:40:31,740 --> 00:40:36,790
execute JavaScript in the window of your

985
00:40:34,270 --> 00:40:39,430
choice and stuff like that but both ADA

986
00:40:36,790 --> 00:40:41,560
desktop I told that allowed eyes to be

987
00:40:39,430 --> 00:40:44,350
able to move forward engagement without

988
00:40:41,560 --> 00:40:46,990
relying on that user so that Lisi saw

989
00:40:44,350 --> 00:40:48,490
and saw an investment banker we could

990
00:40:46,990 --> 00:40:54,580
have done less the FASTA that we were on

991
00:40:48,490 --> 00:40:56,049
his machine for he played bubbles the

992
00:40:54,580 --> 00:40:58,120
next thing we would come up against is

993
00:40:56,050 --> 00:40:59,470
again over the years our clients the

994
00:40:58,120 --> 00:41:01,960
clients that were coming up against are

995
00:40:59,470 --> 00:41:03,790
getting better the security is getting

996
00:41:01,960 --> 00:41:05,680
better and some of them that actually

997
00:41:03,790 --> 00:41:06,310
started doing their locks aggregation of

998
00:41:05,680 --> 00:41:10,919
all things

999
00:41:06,310 --> 00:41:13,420
Oh Bazaar is up we had a situation where

1000
00:41:10,920 --> 00:41:16,540
one of the guys in an environment and

1001
00:41:13,420 --> 00:41:19,210
you could not get from sale the lands

1002
00:41:16,540 --> 00:41:21,460
back to user land he could do the usual

1003
00:41:19,210 --> 00:41:24,520
things he could request SMB so I think

1004
00:41:21,460 --> 00:41:28,180
your face feels he can do HTTP so think

1005
00:41:24,520 --> 00:41:30,070
of your your web sales of the AUSA and

1006
00:41:28,180 --> 00:41:31,299
Silverland but what he couldn't do it

1007
00:41:30,070 --> 00:41:33,940
was get a shell on them because it

1008
00:41:31,300 --> 00:41:37,330
couldn't come back and it wasn't allowed

1009
00:41:33,940 --> 00:41:38,619
out to the Internet this is a bit

1010
00:41:37,330 --> 00:41:40,660
annoying because

1011
00:41:38,619 --> 00:41:42,220
and often order the good stuff who lives

1012
00:41:40,660 --> 00:41:45,970
in silver land and that's where we want

1013
00:41:42,220 --> 00:41:48,279
to get to so think back to your old

1014
00:41:45,970 --> 00:41:50,410
Metasploit days when you can't get a Reb

1015
00:41:48,279 --> 00:41:53,710
shell Watkyn because of firewall and

1016
00:41:50,410 --> 00:41:55,210
issues bane shell so Ben she'll still

1017
00:41:53,710 --> 00:42:01,779
not going to walk in this case because

1018
00:41:55,210 --> 00:42:02,819
we do want that c2 traffic so oh excuse

1019
00:42:01,779 --> 00:42:07,210
me

1020
00:42:02,819 --> 00:42:10,599
so what mr. McCloud thought was a tool

1021
00:42:07,210 --> 00:42:13,029
called P bind what this allows them to

1022
00:42:10,599 --> 00:42:15,849
do is use SMB named pipes you know not

1023
00:42:13,029 --> 00:42:17,769
rocket science but because 445 and the

1024
00:42:15,849 --> 00:42:19,779
target of the sale girl and was allowed

1025
00:42:17,769 --> 00:42:21,848
because of the failures led the favor

1026
00:42:19,779 --> 00:42:24,579
shields over there he was able to

1027
00:42:21,849 --> 00:42:27,160
connect using named pipes and then run

1028
00:42:24,579 --> 00:42:29,259
commands from that selves up from that

1029
00:42:27,160 --> 00:42:31,569
dim pipe to other servers in the

1030
00:42:29,259 --> 00:42:33,339
environment see there he can do things

1031
00:42:31,569 --> 00:42:35,200
that run an arc scan what other devices

1032
00:42:33,339 --> 00:42:37,960
are than here he could do things like

1033
00:42:35,200 --> 00:42:40,598
try and faint what ports we're open back

1034
00:42:37,960 --> 00:42:43,390
in the user land and where they were so

1035
00:42:40,599 --> 00:42:46,599
what he's able to do and I'll show you

1036
00:42:43,390 --> 00:42:48,999
here it can get any can't get out so you

1037
00:42:46,599 --> 00:42:50,769
can't get shell so P baned allows them

1038
00:42:48,999 --> 00:42:53,618
to create that named pay point of the

1039
00:42:50,769 --> 00:42:56,078
foss silver run commands against the

1040
00:42:53,619 --> 00:42:58,650
second server famed the route back out

1041
00:42:56,079 --> 00:43:01,749
through the firewall back to user land

1042
00:42:58,650 --> 00:43:04,359
and no nobody's in user land and you can

1043
00:43:01,749 --> 00:43:06,730
get information back by using the

1044
00:43:04,359 --> 00:43:10,480
running the commands in a in a post

1045
00:43:06,730 --> 00:43:13,720
rather than a pull manner and again this

1046
00:43:10,480 --> 00:43:15,970
has become really sort of useful to us

1047
00:43:13,720 --> 00:43:17,649
in those environments that are that the

1048
00:43:15,970 --> 00:43:19,118
doom over tailing them or tailing the

1049
00:43:17,650 --> 00:43:22,089
mistake again the networks were telling

1050
00:43:19,119 --> 00:43:25,239
them not to use silver land user land

1051
00:43:22,089 --> 00:43:26,799
and it just be a big flap network when

1052
00:43:25,239 --> 00:43:29,019
the segregation can then so it shows you

1053
00:43:26,799 --> 00:43:36,549
that we're still able to do a lot of

1054
00:43:29,019 --> 00:43:38,738
this so the last few slides just a

1055
00:43:36,549 --> 00:43:45,880
little bit on communication so it is

1056
00:43:38,739 --> 00:43:48,029
good to talk right it's good to talk too

1057
00:43:45,880 --> 00:43:48,029
much

1058
00:43:48,190 --> 00:43:53,060
effect of communications on any Red Team

1059
00:43:50,630 --> 00:43:54,590
engagement you've got to have constant

1060
00:43:53,060 --> 00:43:58,130
dialogue not just the ones the team

1061
00:43:54,590 --> 00:44:01,190
members but amongst the the client and

1062
00:43:58,130 --> 00:44:04,010
yourself early stages of an engagement

1063
00:44:01,190 --> 00:44:05,330
how we actually got it we got all of the

1064
00:44:04,010 --> 00:44:07,400
the guys who are on the engagement

1065
00:44:05,330 --> 00:44:09,920
together in the same room same place

1066
00:44:07,400 --> 00:44:12,650
because those early times are really

1067
00:44:09,920 --> 00:44:14,510
crucial it's when it's at its more

1068
00:44:12,650 --> 00:44:16,670
stressful you've got your fetch going in

1069
00:44:14,510 --> 00:44:18,740
you may be for shell coming back you

1070
00:44:16,670 --> 00:44:20,300
want to get processed into on a security

1071
00:44:18,740 --> 00:44:22,279
of football the environment there's a

1072
00:44:20,300 --> 00:44:23,930
lot of moving parts and trying to do

1073
00:44:22,280 --> 00:44:27,710
this from different countries definitely

1074
00:44:23,930 --> 00:44:30,470
counties different sort of cities it can

1075
00:44:27,710 --> 00:44:32,540
be quite difficult however we don't want

1076
00:44:30,470 --> 00:44:38,029
everybody camped and at nature's offices

1077
00:44:32,540 --> 00:44:40,430
all the time so those early stages are

1078
00:44:38,030 --> 00:44:42,200
critical client communication needs to

1079
00:44:40,430 --> 00:44:43,819
be sort of clearly defined so that you

1080
00:44:42,200 --> 00:44:45,710
can communicate with them there's no

1081
00:44:43,820 --> 00:44:47,180
point in saying sending them requests

1082
00:44:45,710 --> 00:44:49,880
across email when if they've got a

1083
00:44:47,180 --> 00:44:52,460
mature blue team they will be looking at

1084
00:44:49,880 --> 00:44:55,550
the cause and if they start to see red

1085
00:44:52,460 --> 00:44:57,740
team as a wad and the flag in on it or

1086
00:44:55,550 --> 00:44:59,180
you know exploit anything else to make

1087
00:44:57,740 --> 00:45:00,229
they're looking for you've got to make

1088
00:44:59,180 --> 00:45:01,879
sure that you can communicate with a

1089
00:45:00,230 --> 00:45:03,710
client and a secured manner that's not

1090
00:45:01,880 --> 00:45:08,450
going to tip anybody off if they've got

1091
00:45:03,710 --> 00:45:11,660
that level of capability um so how did

1092
00:45:08,450 --> 00:45:15,379
it be doing this so internally we use a

1093
00:45:11,660 --> 00:45:17,210
couple of tools we use this it's it's

1094
00:45:15,380 --> 00:45:18,410
called matter most there's a mile what

1095
00:45:17,210 --> 00:45:20,690
the two layers at this plunge

1096
00:45:18,410 --> 00:45:23,270
what this provides us with is the

1097
00:45:20,690 --> 00:45:25,040
ability to have em just stand up chat

1098
00:45:23,270 --> 00:45:26,600
room tape facilities you know and

1099
00:45:25,040 --> 00:45:28,220
personally pay us and supplied with

1100
00:45:26,600 --> 00:45:32,540
channels public channels that everybody

1101
00:45:28,220 --> 00:45:34,250
can use peer-to-peer and allows me as a

1102
00:45:32,540 --> 00:45:36,320
manager of the red team engagements to

1103
00:45:34,250 --> 00:45:38,060
be able to depend to all the live

1104
00:45:36,320 --> 00:45:39,860
engagements that are running but we can

1105
00:45:38,060 --> 00:45:41,720
also secure them so only the people that

1106
00:45:39,860 --> 00:45:43,190
are supposed to be on the engagement can

1107
00:45:41,720 --> 00:45:43,669
see what's happening and that that's

1108
00:45:43,190 --> 00:45:45,320
great

1109
00:45:43,670 --> 00:45:47,090
and we host all of this internal so

1110
00:45:45,320 --> 00:45:51,110
you're not putting client information up

1111
00:45:47,090 --> 00:45:52,490
on the cloud anywhere and what it means

1112
00:45:51,110 --> 00:45:54,350
is that once we've got over those

1113
00:45:52,490 --> 00:45:55,819
initial stressful part of the engagement

1114
00:45:54,350 --> 00:45:58,009
and the guys can all sort of walk from

1115
00:45:55,820 --> 00:45:59,759
home they've got a channel where that

1116
00:45:58,010 --> 00:46:01,619
they can share fails

1117
00:45:59,759 --> 00:46:04,499
Kord blocks they can do all of this

1118
00:46:01,619 --> 00:46:06,299
stuff really sort of straightforward and

1119
00:46:04,499 --> 00:46:07,888
again we've been using it about a year

1120
00:46:06,299 --> 00:46:09,779
now and it's really made a difference to

1121
00:46:07,889 --> 00:46:11,459
us and certainly as a manager that

1122
00:46:09,779 --> 00:46:18,059
allows me to keep a really close eye on

1123
00:46:11,459 --> 00:46:20,848
whether for the guys that are effective

1124
00:46:18,059 --> 00:46:22,319
knowledge field saw you running the

1125
00:46:20,849 --> 00:46:24,929
engagement you're talking everybody it's

1126
00:46:22,319 --> 00:46:28,229
all good what about getting towards the

1127
00:46:24,929 --> 00:46:30,689
end think of that large multi scenario

1128
00:46:28,229 --> 00:46:33,058
red team you may have had sex test those

1129
00:46:30,689 --> 00:46:34,319
doing it they've all got the theater

1130
00:46:33,059 --> 00:46:36,149
from the test they're all feeding it

1131
00:46:34,319 --> 00:46:40,009
back to the one pure soul who is having

1132
00:46:36,149 --> 00:46:43,589
to rate the report and you give him your

1133
00:46:40,009 --> 00:46:47,429
folder full of screenshots labeled one

1134
00:46:43,589 --> 00:46:48,689
PNG to PNG three PNG and that's not

1135
00:46:47,429 --> 00:46:50,459
going to help him when he's got like a

1136
00:46:48,689 --> 00:46:51,839
two hundred three hundred page report to

1137
00:46:50,459 --> 00:46:53,879
write and he's having to go through all

1138
00:46:51,839 --> 00:46:55,859
that stuff so how do we make that happen

1139
00:46:53,880 --> 00:46:57,329
in a way that's conducive to rate in

1140
00:46:55,859 --> 00:46:58,828
good reports because ultimately this is

1141
00:46:57,329 --> 00:47:04,380
what you've given your clients at the

1142
00:46:58,829 --> 00:47:07,409
end is good reports we use a tool that

1143
00:47:04,380 --> 00:47:09,419
allows us to collaboratively walk on the

1144
00:47:07,409 --> 00:47:10,679
same document at the same time so it

1145
00:47:09,419 --> 00:47:13,408
doesn't matter how many people are

1146
00:47:10,679 --> 00:47:15,569
involved and the log then everybody who

1147
00:47:13,409 --> 00:47:20,279
makes changes it's all recorded it's

1148
00:47:15,569 --> 00:47:21,989
called hack MD and because it's probably

1149
00:47:20,279 --> 00:47:23,880
the most important part it also allowed

1150
00:47:21,989 --> 00:47:25,949
to log log everything as I was sayin

1151
00:47:23,880 --> 00:47:28,289
earlier being able to give your clients

1152
00:47:25,949 --> 00:47:31,829
information really quickly is super

1153
00:47:28,289 --> 00:47:34,409
important and allows for the attribution

1154
00:47:31,829 --> 00:47:35,699
it's key doing the detect and response

1155
00:47:34,409 --> 00:47:39,119
because after all that's what we're

1156
00:47:35,699 --> 00:47:40,919
there to do and of course with the

1157
00:47:39,119 --> 00:47:42,839
multiple scenarios it keeps all the

1158
00:47:40,919 --> 00:47:48,209
information that everybody can walk in

1159
00:47:42,839 --> 00:47:49,919
at the same time and that is literally

1160
00:47:48,209 --> 00:47:52,348
the one thing I think we've probably

1161
00:47:49,919 --> 00:47:55,259
done in the last eight months is

1162
00:47:52,349 --> 00:47:57,149
introduced this tool we've we create a

1163
00:47:55,259 --> 00:47:58,799
framework and basically as the

1164
00:47:57,149 --> 00:48:01,219
engagements running the guys are filling

1165
00:47:58,799 --> 00:48:03,269
in this this template effectively

1166
00:48:01,219 --> 00:48:04,889
collaboratively everybody's adding bets

1167
00:48:03,269 --> 00:48:06,658
at the same time and at the end of it

1168
00:48:04,889 --> 00:48:08,999
it's almost a copy and paste and your

1169
00:48:06,659 --> 00:48:10,949
formal report template all we need to

1170
00:48:08,999 --> 00:48:13,428
add is the narrative our story of how

1171
00:48:10,949 --> 00:48:13,429
that happens

1172
00:48:13,519 --> 00:48:17,519
and the tool like I said it's fun in

1173
00:48:16,170 --> 00:48:19,859
markdown it's really straightforward

1174
00:48:17,519 --> 00:48:22,288
again we horse stuff internally the guys

1175
00:48:19,859 --> 00:48:24,058
are all access it from the VPN again

1176
00:48:22,289 --> 00:48:25,559
that doesn't matter what the tool is we

1177
00:48:24,059 --> 00:48:26,999
know that that's what's for us but if

1178
00:48:25,559 --> 00:48:29,069
you're not using something where you can

1179
00:48:26,999 --> 00:48:31,198
all rate to the same document at the

1180
00:48:29,069 --> 00:48:32,880
same time rather than one person rate

1181
00:48:31,199 --> 00:48:34,619
something then he has to read it and

1182
00:48:32,880 --> 00:48:37,319
then add has bet and so on and so forth

1183
00:48:34,619 --> 00:48:38,789
and this becomes really useful and you

1184
00:48:37,319 --> 00:48:40,469
can do all sorts of funky things that

1185
00:48:38,789 --> 00:48:42,989
you can create tables and stuff and it

1186
00:48:40,469 --> 00:48:45,989
just makes your report and therefore the

1187
00:48:42,989 --> 00:48:49,049
recording of the engagement a much much

1188
00:48:45,989 --> 00:48:51,329
better and sort of experience for the

1189
00:48:49,049 --> 00:48:52,650
test of really and you know what they're

1190
00:48:51,329 --> 00:48:54,479
all precious little flowers and they

1191
00:48:52,650 --> 00:49:00,650
need being to cuddle evident and again

1192
00:48:54,479 --> 00:49:03,689
and something that's helped them so yeah

1193
00:49:00,650 --> 00:49:05,640
like I said happy I've got some some

1194
00:49:03,690 --> 00:49:09,180
links just at the end so I'm just

1195
00:49:05,640 --> 00:49:12,989
wrapping up now read the docs is

1196
00:49:09,180 --> 00:49:14,459
something that we also use again we use

1197
00:49:12,989 --> 00:49:16,619
that for all of permanent storage of

1198
00:49:14,459 --> 00:49:18,269
information so you know stuff that we've

1199
00:49:16,619 --> 00:49:20,190
got to reuse all over and over that

1200
00:49:18,269 --> 00:49:21,448
could be security products what works

1201
00:49:20,190 --> 00:49:23,400
against them what doesn't we have a

1202
00:49:21,449 --> 00:49:25,349
repository we use read the docs it's a

1203
00:49:23,400 --> 00:49:27,809
nice easy format again we all host this

1204
00:49:25,349 --> 00:49:28,890
internally so it's never out anywhere

1205
00:49:27,809 --> 00:49:32,630
that people can get at it

1206
00:49:28,890 --> 00:49:35,308
but it's always available to the testers

1207
00:49:32,630 --> 00:49:36,809
and a couple of show notes in for those

1208
00:49:35,309 --> 00:49:39,239
of you who like to teak web screen

1209
00:49:36,809 --> 00:49:42,119
pictures of the screenshot those are the

1210
00:49:39,239 --> 00:49:44,160
tools and and if people involved along

1211
00:49:42,119 --> 00:49:46,400
with us so the twelve handles all very

1212
00:49:44,160 --> 00:49:49,558
smart people we're smarter than me and

1213
00:49:46,400 --> 00:49:52,979
they've really made a difference to our

1214
00:49:49,559 --> 00:50:02,099
red teaming oh sorry

1215
00:49:52,979 --> 00:50:05,910
trying to go back and those just a

1216
00:50:02,099 --> 00:50:07,969
couple of links there to the so those

1217
00:50:05,910 --> 00:50:13,799
tools that we use for the collaborative

1218
00:50:07,969 --> 00:50:16,799
report and at the end and just last

1219
00:50:13,799 --> 00:50:19,579
thing from me this thanks for listening

1220
00:50:16,799 --> 00:50:19,579
the Olaf cops

1221
00:50:20,660 --> 00:50:23,799
[Applause]

1222
00:50:27,270 --> 00:50:34,079
we've got time for two questions which

1223
00:50:34,890 --> 00:50:39,910
I'll hit me up in the after-party in the

1224
00:50:37,329 --> 00:50:44,069
bar come and talk to you look paint ball

1225
00:50:39,910 --> 00:50:50,259
pop and pink shirt ankles with the same

1226
00:50:44,069 --> 00:50:53,460
any quick questions no clothes that's

1227
00:50:50,260 --> 00:50:53,460
great bill thanks very much

