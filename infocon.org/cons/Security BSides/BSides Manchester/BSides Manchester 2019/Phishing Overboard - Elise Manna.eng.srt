1
00:00:03,450 --> 00:00:08,770
hi good morning everybody fishing

2
00:00:06,580 --> 00:00:11,020
overboard I'm Elise madam director of

3
00:00:08,770 --> 00:00:12,430
thread operations for Nova Coast so we

4
00:00:11,020 --> 00:00:14,379
are floating around out there and the

5
00:00:12,430 --> 00:00:16,059
sponsor booths we do have an office in

6
00:00:14,379 --> 00:00:18,130
Manchester based out of Santa Barbara

7
00:00:16,059 --> 00:00:20,740
California and the whole premise of

8
00:00:18,130 --> 00:00:21,849
where it started with this talk was to

9
00:00:20,740 --> 00:00:23,709
teach you everything I know about

10
00:00:21,850 --> 00:00:27,550
fishing and more than you probably ever

11
00:00:23,710 --> 00:00:30,010
wanted to this really ended up becoming

12
00:00:27,550 --> 00:00:32,680
how can all malicious links bypass

13
00:00:30,010 --> 00:00:34,499
security tools and all your mail malware

14
00:00:32,680 --> 00:00:38,050
sandboxes and make you pretty miserable

15
00:00:34,499 --> 00:00:42,249
with very minimal effort on part of the

16
00:00:38,050 --> 00:00:44,890
fishing criminals the obligatory BIOS

17
00:00:42,249 --> 00:00:46,179
slide I started out in the sock I worked

18
00:00:44,890 --> 00:00:48,729
for an anti-fraud company out of

19
00:00:46,179 --> 00:00:51,729
Charleston South Carolina where I dealt

20
00:00:48,729 --> 00:00:54,670
with thousands of 50 URLs a day at some

21
00:00:51,729 --> 00:00:57,489
point I just kind of cut my teeth really

22
00:00:54,670 --> 00:00:58,719
early and it was just a very good

23
00:00:57,489 --> 00:01:00,550
exposure I started learning about

24
00:00:58,719 --> 00:01:02,469
malware a little bit and it was a great

25
00:01:00,550 --> 00:01:04,059
place to start so for people that are

26
00:01:02,469 --> 00:01:06,310
looking to get into the security field

27
00:01:04,059 --> 00:01:08,140
it's a really good way to get yonce of

28
00:01:06,310 --> 00:01:11,110
exposure to the different areas of

29
00:01:08,140 --> 00:01:13,900
security and then moved over to being a

30
00:01:11,110 --> 00:01:15,940
malware analyst and it pretty much ended

31
00:01:13,900 --> 00:01:16,720
up being a better title and dealing with

32
00:01:15,940 --> 00:01:18,880
more fishing

33
00:01:16,720 --> 00:01:20,350
so it was spear fishing you'd have

34
00:01:18,880 --> 00:01:22,300
different types of payloads different

35
00:01:20,350 --> 00:01:24,789
types of URLs it's a little bit more

36
00:01:22,300 --> 00:01:26,620
exciting but for the most part I was

37
00:01:24,790 --> 00:01:28,810
still doing a lot of email header and

38
00:01:26,620 --> 00:01:30,370
plusses and those types of things

39
00:01:28,810 --> 00:01:32,050
but again you're always seeing those new

40
00:01:30,370 --> 00:01:34,870
types of attacks when you're in it every

41
00:01:32,050 --> 00:01:37,690
day and you know you just develop almost

42
00:01:34,870 --> 00:01:39,250
alongside the criminals as they create a

43
00:01:37,690 --> 00:01:40,509
new technique as they come out with

44
00:01:39,250 --> 00:01:42,970
something different as they start

45
00:01:40,510 --> 00:01:45,720
abusing something old becomes new again

46
00:01:42,970 --> 00:01:48,400
you get to see it right on the forefront

47
00:01:45,720 --> 00:01:49,630
then I became a security engineer and

48
00:01:48,400 --> 00:01:52,180
guess what

49
00:01:49,630 --> 00:01:54,940
so still dealing with a lot of

50
00:01:52,180 --> 00:01:56,920
spearfishing in this case that was Title

51
00:01:54,940 --> 00:02:00,250
I was actually doing a lot of Incident

52
00:01:56,920 --> 00:02:01,540
Response and I kept finding that my

53
00:02:00,250 --> 00:02:03,880
clients were dealing with these

54
00:02:01,540 --> 00:02:06,250
large-scale incidents they were dealing

55
00:02:03,880 --> 00:02:09,068
with reportable breaches and guess where

56
00:02:06,250 --> 00:02:11,459
they were starting malicious emails so I

57
00:02:09,068 --> 00:02:14,458
really have never gotten away from it

58
00:02:11,459 --> 00:02:17,489
and it's been interesting guns vol just

59
00:02:14,459 --> 00:02:19,560
keeps whip up with those techniques also

60
00:02:17,489 --> 00:02:22,019
frustrating because you see the same

61
00:02:19,560 --> 00:02:24,180
things working over and over again and

62
00:02:22,019 --> 00:02:26,730
nobody seems to do anything about it so

63
00:02:24,180 --> 00:02:29,129
yeah gives me a little bit of a reason

64
00:02:26,730 --> 00:02:30,869
to drink whiskey sometimes I became a

65
00:02:29,129 --> 00:02:34,048
director now I just have meetings about

66
00:02:30,870 --> 00:02:37,049
fishing so I haven't really gotten away

67
00:02:34,049 --> 00:02:39,659
from it if you can't tell by I'm from

68
00:02:37,049 --> 00:02:42,209
States I grew up in New York so I'm good

69
00:02:39,659 --> 00:02:44,340
I'm trying very hard not to speak too

70
00:02:42,209 --> 00:02:46,200
quickly right now so just wave me down

71
00:02:44,340 --> 00:02:48,900
if you can't understand a word coming

72
00:02:46,200 --> 00:02:51,358
out of my mouth I now live here in sunny

73
00:02:48,900 --> 00:02:55,139
Santa Barbara California a lot different

74
00:02:51,359 --> 00:02:57,269
no snow it's fantastic so the goals of

75
00:02:55,139 --> 00:03:00,480
this talk ultimately we're going to

76
00:02:57,269 --> 00:03:03,239
define fishing I want to teach you how

77
00:03:00,480 --> 00:03:05,760
fish will evade detection so that's

78
00:03:03,239 --> 00:03:07,200
really on your email gateway anything

79
00:03:05,760 --> 00:03:08,909
that's looking at the users inbox

80
00:03:07,200 --> 00:03:11,159
anything that's trying to scrub that

81
00:03:08,909 --> 00:03:12,840
stuff coming in the way that the most

82
00:03:11,159 --> 00:03:15,388
effective techniques that I'm still

83
00:03:12,840 --> 00:03:16,919
seeing that are gonna have a detection

84
00:03:15,389 --> 00:03:19,530
and are gonna go right into a users

85
00:03:16,919 --> 00:03:21,930
mailbox I also want to discuss some

86
00:03:19,530 --> 00:03:23,819
techniques for baiting analysis so once

87
00:03:21,930 --> 00:03:26,010
it gets into the hand of that security

88
00:03:23,819 --> 00:03:27,869
analysts and they're testing it they're

89
00:03:26,010 --> 00:03:30,599
putting in a sandbox so putting in their

90
00:03:27,870 --> 00:03:32,790
Cali VM whatever it is and maybe it

91
00:03:30,599 --> 00:03:35,280
looks soft lines looks like it's okay

92
00:03:32,790 --> 00:03:37,858
it's just going to google.com how do you

93
00:03:35,280 --> 00:03:39,120
even know if there was something bad

94
00:03:37,859 --> 00:03:40,889
there or not

95
00:03:39,120 --> 00:03:42,870
much easier to prove something's bad

96
00:03:40,889 --> 00:03:44,400
than / something's good and it's

97
00:03:42,870 --> 00:03:47,639
probably the most frustrating thing for

98
00:03:44,400 --> 00:03:50,069
an incident responder I want to discuss

99
00:03:47,639 --> 00:03:52,260
how you can have a phishing campaign see

100
00:03:50,069 --> 00:03:53,819
sticky so you know it's really for

101
00:03:52,260 --> 00:03:55,918
somebody that's more on the offensive

102
00:03:53,819 --> 00:03:58,198
side how can you have essentially

103
00:03:55,919 --> 00:04:00,449
persistence of this type of attack and

104
00:03:58,199 --> 00:04:02,699
how can you pull out the goodies in

105
00:04:00,449 --> 00:04:04,260
peace so different ways that these that

106
00:04:02,699 --> 00:04:06,810
phishing criminals will pull out the

107
00:04:04,260 --> 00:04:09,239
information I'm not going to dive too

108
00:04:06,810 --> 00:04:10,859
too much into this because there's a

109
00:04:09,239 --> 00:04:12,810
handful of techniques they're used over

110
00:04:10,859 --> 00:04:15,510
and over again and again they continue

111
00:04:12,810 --> 00:04:17,220
to work really what I'd like you to get

112
00:04:15,510 --> 00:04:19,529
away from this is if you're a Red Team

113
00:04:17,220 --> 00:04:21,180
person how is the best way if you're on

114
00:04:19,529 --> 00:04:23,200
an engagement to be able to get a fish

115
00:04:21,180 --> 00:04:25,330
through to user inboxes

116
00:04:23,200 --> 00:04:27,039
if you're a blue team how do you

117
00:04:25,330 --> 00:04:29,380
determine if something's actually an

118
00:04:27,040 --> 00:04:32,830
active fish or just the nine is a spam

119
00:04:29,380 --> 00:04:35,080
is it not if your security vendor please

120
00:04:32,830 --> 00:04:38,919
stop allowing this crap into people's

121
00:04:35,080 --> 00:04:40,750
inboxes and for users for the love of

122
00:04:38,920 --> 00:04:44,370
God stop clicking on phishing emails

123
00:04:40,750 --> 00:04:44,370
give me something else to do okay

124
00:04:45,190 --> 00:04:50,440
so defining from Google this is a very

125
00:04:48,130 --> 00:04:52,180
long verbose way of saying that is

126
00:04:50,440 --> 00:04:53,560
pretending to be a legitimate company to

127
00:04:52,180 --> 00:04:56,320
steal information from you

128
00:04:53,560 --> 00:04:58,360
for me I'm defining this for the

129
00:04:56,320 --> 00:05:00,219
purposes of this talk and something that

130
00:04:58,360 --> 00:05:02,710
doesn't drop a malware payload

131
00:05:00,220 --> 00:05:04,030
traditionally a computer virus we're

132
00:05:02,710 --> 00:05:06,310
gonna stick with kind of Perdition

133
00:05:04,030 --> 00:05:08,020
credential harvesters but that doesn't

134
00:05:06,310 --> 00:05:10,510
really mean anything I've actually seen

135
00:05:08,020 --> 00:05:11,890
fish that take a username password and

136
00:05:10,510 --> 00:05:14,920
they get really greedy and then they

137
00:05:11,890 --> 00:05:16,270
drop malware so anything's possible you

138
00:05:14,920 --> 00:05:18,490
can't just take something at face value

139
00:05:16,270 --> 00:05:22,000
so the terminology does get a little

140
00:05:18,490 --> 00:05:23,650
wishy-washy here and there so first

141
00:05:22,000 --> 00:05:25,330
we're starting out with defensive asian

142
00:05:23,650 --> 00:05:27,370
that's my tiny little disclaimer an

143
00:05:25,330 --> 00:05:29,770
upper left I am using live URLs in this

144
00:05:27,370 --> 00:05:31,210
demo some of them might be offline by

145
00:05:29,770 --> 00:05:33,909
this point now that the decks been

146
00:05:31,210 --> 00:05:36,340
created for a couple of days but I'm

147
00:05:33,910 --> 00:05:37,780
they're not all sample URLs so just be

148
00:05:36,340 --> 00:05:40,659
careful in case you're looking at Waddy

149
00:05:37,780 --> 00:05:43,630
or Kerry as I'm typing in don't do it on

150
00:05:40,660 --> 00:05:45,550
worked advice of the minimum so the

151
00:05:43,630 --> 00:05:48,340
first technique when I discussed was

152
00:05:45,550 --> 00:05:49,870
abusing the Microsoft cloud I've been

153
00:05:48,340 --> 00:05:52,090
seeing this a lot where you're seeing

154
00:05:49,870 --> 00:05:55,870
fish come on with like as your website's

155
00:05:52,090 --> 00:05:58,929
nets or different variations of

156
00:05:55,870 --> 00:06:01,750
microsoft owns legitimate domains that

157
00:05:58,930 --> 00:06:04,060
are carrying fish on them as I started

158
00:06:01,750 --> 00:06:05,410
looking more into this because to me it

159
00:06:04,060 --> 00:06:08,620
was something actually I hadn't seen

160
00:06:05,410 --> 00:06:10,300
prior to painting the last year and as I

161
00:06:08,620 --> 00:06:12,250
was reviewing it I was like okay well as

162
00:06:10,300 --> 00:06:13,780
your offers a 30-day trial of course

163
00:06:12,250 --> 00:06:15,760
that's gonna be attractive I'm gonna

164
00:06:13,780 --> 00:06:17,770
have free hosting it's gonna have a

165
00:06:15,760 --> 00:06:18,550
reputation on the domain that's gonna be

166
00:06:17,770 --> 00:06:20,969
fantastic

167
00:06:18,550 --> 00:06:22,200
nobody's gonna detect this thing

168
00:06:20,970 --> 00:06:24,600
and then I just move on to the next

169
00:06:22,200 --> 00:06:26,820
account after my 30 days when I learned

170
00:06:24,600 --> 00:06:29,400
my research is that this is technique is

171
00:06:26,820 --> 00:06:33,300
work since at least 2014 if not before

172
00:06:29,400 --> 00:06:35,489
that that is way too long for a vendor

173
00:06:33,300 --> 00:06:37,410
to not know vendor in this case

174
00:06:35,490 --> 00:06:40,400
Microsoft sorry if anybody's in the room

175
00:06:37,410 --> 00:06:42,750
that works for them that content

176
00:06:40,400 --> 00:06:44,460
stealing credentials is on their

177
00:06:42,750 --> 00:06:47,160
infrastructure that's pretending to

178
00:06:44,460 --> 00:06:49,109
being them so Microsoft knows with a

179
00:06:47,160 --> 00:06:50,670
login page looks like it knows what that

180
00:06:49,110 --> 00:06:52,560
HTML source code looks like

181
00:06:50,670 --> 00:06:54,540
and yet these pages still continue to go

182
00:06:52,560 --> 00:06:57,900
up on their infrastructure and continue

183
00:06:54,540 --> 00:07:00,150
to steal login credentials for email so

184
00:06:57,900 --> 00:07:02,099
this is kind of an example of it that

185
00:07:00,150 --> 00:07:04,169
was an actual sub domain that was used

186
00:07:02,100 --> 00:07:06,000
sometimes they'll be variations of

187
00:07:04,170 --> 00:07:08,040
office mail or something that look a

188
00:07:06,000 --> 00:07:09,960
little bit more legitimate this gets a

189
00:07:08,040 --> 00:07:12,090
little tricky if you training users to

190
00:07:09,960 --> 00:07:13,500
hover over a link and their emails which

191
00:07:12,090 --> 00:07:16,109
is often what security awareness

192
00:07:13,500 --> 00:07:19,350
training is teaching users to do and

193
00:07:16,110 --> 00:07:20,760
they're gonna say oh I know a sure we're

194
00:07:19,350 --> 00:07:22,650
going to click that thing they're gonna

195
00:07:20,760 --> 00:07:24,390
go to a page that looks like that gonna

196
00:07:22,650 --> 00:07:26,640
look exactly like their normal login

197
00:07:24,390 --> 00:07:28,200
page and the attackers happy because

198
00:07:26,640 --> 00:07:29,729
again they've got three hosts saying

199
00:07:28,200 --> 00:07:31,469
they're not having to spin up a domain

200
00:07:29,730 --> 00:07:33,390
they're not having to buy a domain from

201
00:07:31,470 --> 00:07:36,419
anything they just have this stuff ready

202
00:07:33,390 --> 00:07:38,669
at their disposal this is another

203
00:07:36,419 --> 00:07:42,150
example and I know that's a little askew

204
00:07:38,669 --> 00:07:44,240
right there abusing SharePoint so again

205
00:07:42,150 --> 00:07:47,489
how many organizations use SharePoint

206
00:07:44,240 --> 00:07:50,010
almost all of them at this point so when

207
00:07:47,490 --> 00:07:52,950
you pop a SharePoint account or office

208
00:07:50,010 --> 00:07:54,750
365 account from one organization you

209
00:07:52,950 --> 00:07:56,880
use that SharePoint account to send fish

210
00:07:54,750 --> 00:07:58,860
to other organizations maybe a business

211
00:07:56,880 --> 00:08:01,860
partner provides some legitimacy to it

212
00:07:58,860 --> 00:08:04,140
and it'll go ahead and provide a

213
00:08:01,860 --> 00:08:05,700
document that is maybe this is a one

214
00:08:04,140 --> 00:08:07,979
node example but it could be a word

215
00:08:05,700 --> 00:08:09,659
document word online Excel online you

216
00:08:07,980 --> 00:08:12,540
can do anything that can hold a

217
00:08:09,660 --> 00:08:15,030
hyperlink and it'll go past the filter

218
00:08:12,540 --> 00:08:18,450
because who blocked SharePoint comm and

219
00:08:15,030 --> 00:08:20,609
their email almost nobody so this tends

220
00:08:18,450 --> 00:08:22,349
to be a very effective technique the

221
00:08:20,610 --> 00:08:24,450
other piece is that a lot of scanning

222
00:08:22,350 --> 00:08:26,669
engines on the email gateways they don't

223
00:08:24,450 --> 00:08:29,280
really go far enough to say hey there's

224
00:08:26,669 --> 00:08:30,609
a link here let me simulate a click and

225
00:08:29,280 --> 00:08:32,708
see where that goes

226
00:08:30,610 --> 00:08:35,709
look at that reputation they're looking

227
00:08:32,708 --> 00:08:38,919
at the reputation for SharePoint or that

228
00:08:35,708 --> 00:08:41,260
subdomain and until a analyst or

229
00:08:38,919 --> 00:08:43,740
researcher has mucked that sub domain as

230
00:08:41,260 --> 00:08:46,660
compromised or potentially malicious

231
00:08:43,740 --> 00:08:48,220
virustotal and anything any threat

232
00:08:46,660 --> 00:08:50,050
intelligence students that are feeding

233
00:08:48,220 --> 00:08:54,700
phishing detection aren't going to see

234
00:08:50,050 --> 00:08:57,459
this this is another one and this is

235
00:08:54,700 --> 00:08:59,769
kind of might give you a laugh but this

236
00:08:57,459 --> 00:09:01,630
is just an office form so in this case

237
00:08:59,769 --> 00:09:05,050
your reputations based on Florence

238
00:09:01,630 --> 00:09:06,970
office comm you use any office forms in

239
00:09:05,050 --> 00:09:08,979
your organization and you don't have SSL

240
00:09:06,970 --> 00:09:10,959
inspection you're not gonna be able to

241
00:09:08,980 --> 00:09:13,930
really see that full URL in your

242
00:09:10,959 --> 00:09:15,969
firewall so you can you can't block the

243
00:09:13,930 --> 00:09:18,219
full domain or that sub domain so you

244
00:09:15,970 --> 00:09:19,870
have to allow all of your users to go to

245
00:09:18,220 --> 00:09:22,690
that fish if you can't scrub it at the

246
00:09:19,870 --> 00:09:24,519
email level now Microsoft here you can

247
00:09:22,690 --> 00:09:26,200
see there is a warning on the top saying

248
00:09:24,519 --> 00:09:28,269
hey we think this is asking for

249
00:09:26,200 --> 00:09:31,089
sensitive stuff there's a warning at the

250
00:09:28,269 --> 00:09:33,220
bottom never give out your password most

251
00:09:31,089 --> 00:09:34,690
users are not going to read that they're

252
00:09:33,220 --> 00:09:37,120
gonna just put it in they're not

253
00:09:34,690 --> 00:09:38,980
thinking about it they get a document

254
00:09:37,120 --> 00:09:41,560
maybe they're expecting a documents or

255
00:09:38,980 --> 00:09:43,930
something to that effect to put this in

256
00:09:41,560 --> 00:09:46,689
this is not the best fish in the world

257
00:09:43,930 --> 00:09:49,810
as you can see your email is one string

258
00:09:46,690 --> 00:09:52,089
it just says pass in my opinion there

259
00:09:49,810 --> 00:09:54,640
should be blocking and that's this realm

260
00:09:52,089 --> 00:09:56,920
that says if you have a strength email

261
00:09:54,640 --> 00:09:59,319
on a string pass or password in this

262
00:09:56,920 --> 00:10:01,120
page that you can't even upload this

263
00:09:59,320 --> 00:10:03,640
over to an office forums you can't

264
00:10:01,120 --> 00:10:05,709
create an office forum with those terms

265
00:10:03,640 --> 00:10:08,920
they do limit that you can't have

266
00:10:05,709 --> 00:10:11,529
password but that's easily bypassed by

267
00:10:08,920 --> 00:10:13,810
truncating it putting dots in between

268
00:10:11,529 --> 00:10:15,850
every character putting spaces between

269
00:10:13,810 --> 00:10:17,680
every character leaving a character off

270
00:10:15,850 --> 00:10:19,630
changing one doing leet-speak

271
00:10:17,680 --> 00:10:22,810
these types of things although those

272
00:10:19,630 --> 00:10:24,939
techniques will set up more alarm bells

273
00:10:22,810 --> 00:10:27,010
with more users of somebody's rushing

274
00:10:24,940 --> 00:10:29,709
which they often armed they will

275
00:10:27,010 --> 00:10:31,600
sometimes still fall for these so even

276
00:10:29,709 --> 00:10:33,310
though for the people in the room it

277
00:10:31,600 --> 00:10:35,380
might look like garbage and how could

278
00:10:33,310 --> 00:10:37,359
anyone haven't put this stuff in think

279
00:10:35,380 --> 00:10:39,459
about Suzie Q over in accounting that

280
00:10:37,360 --> 00:10:40,150
probably will and to give you a better

281
00:10:39,459 --> 00:10:44,829
idea

282
00:10:40,150 --> 00:10:47,709
effectiveness can be so similarly box

283
00:10:44,830 --> 00:10:50,080
Dropbox we transfer any type of file

284
00:10:47,710 --> 00:10:52,240
transfer site suffer from the same fate

285
00:10:50,080 --> 00:10:54,760
these can be walked down a little better

286
00:10:52,240 --> 00:10:56,980
by using web application whitelisting so

287
00:10:54,760 --> 00:10:59,170
if you're only using Dropbox in your

288
00:10:56,980 --> 00:11:01,120
organization or only using SharePoint

289
00:10:59,170 --> 00:11:04,420
then you can say well I don't want

290
00:11:01,120 --> 00:11:06,550
anyone going to wwp box comm and you

291
00:11:04,420 --> 00:11:08,620
just block it and if it sees you know

292
00:11:06,550 --> 00:11:11,410
your proxy see any traffic that looks

293
00:11:08,620 --> 00:11:13,510
like that but most times that

294
00:11:11,410 --> 00:11:15,730
whitelisting is difficult or most

295
00:11:13,510 --> 00:11:17,370
organizations have multiple file sharing

296
00:11:15,730 --> 00:11:19,510
services they use they might have

297
00:11:17,370 --> 00:11:21,280
customers of theirs or business partners

298
00:11:19,510 --> 00:11:24,210
of theirs that require them to access

299
00:11:21,280 --> 00:11:27,310
things outside of what is used in house

300
00:11:24,210 --> 00:11:29,290
an example here very similar to that one

301
00:11:27,310 --> 00:11:31,689
node example you'll see here you have

302
00:11:29,290 --> 00:11:34,420
packed up box comm so if you have any

303
00:11:31,690 --> 00:11:36,220
legitimate box stuff how do you block

304
00:11:34,420 --> 00:11:38,589
that you can't you're gonna have to do

305
00:11:36,220 --> 00:11:40,750
it by URL or have the URL flagged by

306
00:11:38,590 --> 00:11:43,120
some security tool and in this case

307
00:11:40,750 --> 00:11:45,700
again it's just a PDF most scanning

308
00:11:43,120 --> 00:11:47,560
engines aren't going to sa most because

309
00:11:45,700 --> 00:11:50,170
I'm just hedging my bets all scanning

310
00:11:47,560 --> 00:11:52,630
engines aren't you see that a PDF has an

311
00:11:50,170 --> 00:11:55,920
embedded link and it's likely not gonna

312
00:11:52,630 --> 00:11:58,390
follow it to that phishing link there

313
00:11:55,920 --> 00:12:00,310
other ways to do this are you abusing

314
00:11:58,390 --> 00:12:02,680
marketing services so things like

315
00:12:00,310 --> 00:12:04,900
Mandrell SendGrid MailChimp's that

316
00:12:02,680 --> 00:12:06,339
you've probably seen I thought I saw a

317
00:12:04,900 --> 00:12:08,439
Gartner one the other day and then I

318
00:12:06,340 --> 00:12:12,100
couldn't find the sample for this but

319
00:12:08,440 --> 00:12:14,440
that was a new one for me too so Mozilla

320
00:12:12,100 --> 00:12:17,200
is kind of nice because you see the

321
00:12:14,440 --> 00:12:18,970
domain at least in pieces at the end of

322
00:12:17,200 --> 00:12:21,430
the URL but some of these masks get

323
00:12:18,970 --> 00:12:23,560
completely tokenization or some sort of

324
00:12:21,430 --> 00:12:25,120
encoding so it will make it a little

325
00:12:23,560 --> 00:12:27,130
harder for the analyst to be able to

326
00:12:25,120 --> 00:12:29,560
determine oh is this batter this good

327
00:12:27,130 --> 00:12:31,780
then you're forced to put it into some

328
00:12:29,560 --> 00:12:34,479
sort of tool or run curl on it see where

329
00:12:31,780 --> 00:12:36,880
it goes is it redirecting where is it

330
00:12:34,480 --> 00:12:39,160
heading to does create just additional

331
00:12:36,880 --> 00:12:41,050
challenges and it also can tie up your

332
00:12:39,160 --> 00:12:44,110
workflow and it creates makes the

333
00:12:41,050 --> 00:12:46,930
analysis just flash longer I also wanted

334
00:12:44,110 --> 00:12:48,660
to touch on base tagging so this is a

335
00:12:46,930 --> 00:12:52,319
pretty creative technique

336
00:12:48,660 --> 00:12:53,819
this one actually so it'll have a tag in

337
00:12:52,319 --> 00:12:54,810
the body of the email that's just the

338
00:12:53,819 --> 00:12:57,569
base domain

339
00:12:54,810 --> 00:12:59,518
it adds the rest of the URL as a

340
00:12:57,569 --> 00:13:02,639
separate piece so when you're scanning

341
00:12:59,519 --> 00:13:04,610
engine it's looking for HTTP in that

342
00:13:02,639 --> 00:13:07,230
case it's only gonna see example.com

343
00:13:04,610 --> 00:13:09,420
it's never gonna see this it's never

344
00:13:07,230 --> 00:13:11,519
going to run anything against that full

345
00:13:09,420 --> 00:13:15,199
URL it just doesn't concatenate it it

346
00:13:11,519 --> 00:13:18,449
doesn't understand that type of split up

347
00:13:15,199 --> 00:13:20,370
I'm using example.com in this part but

348
00:13:18,449 --> 00:13:21,899
actually I've seen a lot of this using

349
00:13:20,370 --> 00:13:24,660
Google api's com

350
00:13:21,899 --> 00:13:28,019
so it'd be like fire be storage dot or

351
00:13:24,660 --> 00:13:30,029
storage Google api's and then the rest

352
00:13:28,019 --> 00:13:32,009
of the URL just goes anywhere and it'll

353
00:13:30,029 --> 00:13:34,800
go to a page or it can go to a redirect

354
00:13:32,009 --> 00:13:38,040
and send you somewhere else I'll go into

355
00:13:34,800 --> 00:13:40,469
multiple redirects a little bit later so

356
00:13:38,040 --> 00:13:41,819
this creates that full URL and I am

357
00:13:40,470 --> 00:13:43,980
referencing that bleeping computer

358
00:13:41,819 --> 00:13:47,969
articles I took those screenshots panel

359
00:13:43,980 --> 00:13:49,910
article but the you know the example is

360
00:13:47,970 --> 00:13:51,990
the same so you know you could do this

361
00:13:49,910 --> 00:13:53,969
combined with any of the other

362
00:13:51,990 --> 00:13:56,189
techniques you could use this for a box

363
00:13:53,970 --> 00:13:57,720
URL or SharePoint URL and the more

364
00:13:56,189 --> 00:13:59,040
techniques you add together

365
00:13:57,720 --> 00:14:02,610
of course the more effective your

366
00:13:59,040 --> 00:14:05,029
campaign is going to be we also have

367
00:14:02,610 --> 00:14:08,399
seen quite a few with HTML and coding

368
00:14:05,029 --> 00:14:10,649
this one kind of flummoxed ALS I was

369
00:14:08,399 --> 00:14:12,930
working with because you see a lot of

370
00:14:10,649 --> 00:14:14,850
these 60 blob most people can recognize

371
00:14:12,930 --> 00:14:16,769
that it's got two equal signs on the end

372
00:14:14,850 --> 00:14:18,959
of it half time so it's easy to

373
00:14:16,769 --> 00:14:21,209
recognize we were looking at this and I

374
00:14:18,959 --> 00:14:23,518
was like I know I figured this one out

375
00:14:21,209 --> 00:14:25,949
but I didn't know off the top of my head

376
00:14:23,519 --> 00:14:28,920
and been a while since I'd seen it this

377
00:14:25,949 --> 00:14:30,839
was actually an HTML attachment so again

378
00:14:28,920 --> 00:14:32,779
you're thinking who would open the HTML

379
00:14:30,839 --> 00:14:35,550
attachment well anyone that's ever

380
00:14:32,779 --> 00:14:37,290
received an encrypted email is gonna

381
00:14:35,550 --> 00:14:39,599
open an HTML attachment because that

382
00:14:37,290 --> 00:14:41,309
sounds a lot of those comfort so in this

383
00:14:39,600 --> 00:14:43,500
case you're scanning engines just seeing

384
00:14:41,309 --> 00:14:46,079
a bunch of characters it doesn't often

385
00:14:43,500 --> 00:14:47,370
won't know what's going on again it

386
00:14:46,079 --> 00:14:49,709
doesn't even know that there's a full

387
00:14:47,370 --> 00:14:52,430
URL just sees that it stops and it has

388
00:14:49,709 --> 00:14:54,569
random characters so it's there's very

389
00:14:52,430 --> 00:14:56,279
likelihood that a user is gonna be able

390
00:14:54,569 --> 00:14:58,229
to click this and visit through to that

391
00:14:56,279 --> 00:15:01,119
fish it's also going to be very much

392
00:14:58,230 --> 00:15:03,429
harder to you know search

393
00:15:01,119 --> 00:15:07,269
if you're doing anything endpoints and

394
00:15:03,429 --> 00:15:09,279
point same kind of applies a base64 so

395
00:15:07,269 --> 00:15:11,109
this is a payload or pen test team

396
00:15:09,279 --> 00:15:13,389
actually wrote for me for testing a

397
00:15:11,109 --> 00:15:15,669
proxy tool and I brought it to the

398
00:15:13,389 --> 00:15:17,829
provider and I said hey can you detect

399
00:15:15,669 --> 00:15:19,569
that do you know that that's a URL how

400
00:15:17,829 --> 00:15:22,388
do you detect that somebody's on a

401
00:15:19,569 --> 00:15:24,579
webpage to trigger that the proxy rule

402
00:15:22,389 --> 00:15:28,209
should be in effect is it traffic on

403
00:15:24,579 --> 00:15:30,339
port 80 is a HTTP is it that you know

404
00:15:28,209 --> 00:15:32,018
there's a DNS request somewhere how do

405
00:15:30,339 --> 00:15:34,899
you even determine it or you're looking

406
00:15:32,019 --> 00:15:36,819
for ACP in the address bar big surprise

407
00:15:34,899 --> 00:15:39,789
I've never got a response if I ever get

408
00:15:36,819 --> 00:15:41,589
one I can do follow-up but this is

409
00:15:39,789 --> 00:15:43,659
basically all the HTML source code

410
00:15:41,589 --> 00:15:45,699
needed for the page and it's gonna show

411
00:15:43,659 --> 00:15:47,859
like that to the user they're gonna

412
00:15:45,699 --> 00:15:49,419
think it's a long URL in some cases you

413
00:15:47,859 --> 00:15:51,099
would hope they think that was

414
00:15:49,419 --> 00:15:54,039
suspicious it definitely doesn't look

415
00:15:51,099 --> 00:15:55,599
like a website but you never know and

416
00:15:54,039 --> 00:15:58,089
then just another example was that where

417
00:15:55,599 --> 00:16:02,619
the base64 is actually in the body of

418
00:15:58,089 --> 00:16:04,299
the page itself not in the URL bar this

419
00:16:02,619 --> 00:16:08,649
just makes it a little trickier for ALS

420
00:16:04,299 --> 00:16:12,478
that's a pretty easy one to train on so

421
00:16:08,649 --> 00:16:15,459
talking about Google so this one is very

422
00:16:12,479 --> 00:16:17,469
effective and you can see it's very

423
00:16:15,459 --> 00:16:19,268
simple to construct so it doesn't

424
00:16:17,469 --> 00:16:21,879
require you to spin up any

425
00:16:19,269 --> 00:16:25,119
infrastructure as an attacker you just

426
00:16:21,879 --> 00:16:26,649
use Google you put the query parameter

427
00:16:25,119 --> 00:16:29,709
at the end of it and you put your

428
00:16:26,649 --> 00:16:31,779
fishing URL at the end of it now this

429
00:16:29,709 --> 00:16:33,488
one reputation because we keep coming

430
00:16:31,779 --> 00:16:35,499
back to that right a lot of standing

431
00:16:33,489 --> 00:16:37,839
engines and email gateways or looking at

432
00:16:35,499 --> 00:16:40,329
the reputation for me you feel lucky

433
00:16:37,839 --> 00:16:43,179
it's gonna look at the full URL how many

434
00:16:40,329 --> 00:16:45,459
things are gonna flag wwq Google calm as

435
00:16:43,179 --> 00:16:48,519
malicious nothing this is probably the

436
00:16:45,459 --> 00:16:50,108
most used website in the world so it's

437
00:16:48,519 --> 00:16:51,999
this one gets passed pretty much

438
00:16:50,109 --> 00:16:54,009
everything this will also get passed

439
00:16:51,999 --> 00:16:55,209
your user security training because

440
00:16:54,009 --> 00:16:57,729
they're gonna hover over that but it's

441
00:16:55,209 --> 00:16:59,319
not cool click this is nothing bad ever

442
00:16:57,729 --> 00:17:01,209
on Google that's what they're gonna

443
00:16:59,319 --> 00:17:04,990
think they're gonna go right to that

444
00:17:01,209 --> 00:17:06,398
site this is another example so I just

445
00:17:04,990 --> 00:17:08,559
redacted out the recipients email

446
00:17:06,398 --> 00:17:11,469
address but you can see that this

447
00:17:08,559 --> 00:17:12,760
actually had multiple URLs you are all

448
00:17:11,470 --> 00:17:14,709
encoded at the end of it

449
00:17:12,760 --> 00:17:16,930
then it was redirecting to another fish

450
00:17:14,709 --> 00:17:19,480
and then this was randomizing the piece

451
00:17:16,930 --> 00:17:23,140
at the end of the URL - so there were a

452
00:17:19,480 --> 00:17:24,760
lot of things going on with that one now

453
00:17:23,140 --> 00:17:27,280
when I was testing this out for the

454
00:17:24,760 --> 00:17:29,860
slides I was like okay well hoping

455
00:17:27,280 --> 00:17:32,680
Google does something about this and I

456
00:17:29,860 --> 00:17:34,899
tested it out and I always use lol - my

457
00:17:32,680 --> 00:17:36,730
testing stuff and it did bring me to a

458
00:17:34,900 --> 00:17:38,830
warning page say hey there's a redirect

459
00:17:36,730 --> 00:17:40,510
thing going on you might want to be

460
00:17:38,830 --> 00:17:43,120
aware do you really want to go to this

461
00:17:40,510 --> 00:17:44,950
site I then was resetting the password

462
00:17:43,120 --> 00:17:48,100
on my uber app as soon as they got to

463
00:17:44,950 --> 00:17:50,710
Manchester it uses this in its actual

464
00:17:48,100 --> 00:17:52,570
password resets there's no warning page

465
00:17:50,710 --> 00:17:55,870
so it brought me right to the uber

466
00:17:52,570 --> 00:17:58,810
accounts page via Google and I never got

467
00:17:55,870 --> 00:18:00,489
a pop-up like this requires more testing

468
00:17:58,810 --> 00:18:02,770
on my part to be frank that was kind of

469
00:18:00,490 --> 00:18:04,920
a new discovery for me I thought it was

470
00:18:02,770 --> 00:18:07,600
all prepared and then that happens so

471
00:18:04,920 --> 00:18:09,760
the other thing you can do is if that

472
00:18:07,600 --> 00:18:11,169
doesn't work or it is presenting that

473
00:18:09,760 --> 00:18:12,520
warning page and you're like I don't

474
00:18:11,170 --> 00:18:14,700
want to have to deal with that because

475
00:18:12,520 --> 00:18:17,320
it's gonna cut down my click rate by 50%

476
00:18:14,700 --> 00:18:19,360
you're getting just put the malicious

477
00:18:17,320 --> 00:18:21,250
document on Google Docs or Google Drive

478
00:18:19,360 --> 00:18:24,250
it works the same way as a SharePoint

479
00:18:21,250 --> 00:18:31,150
attack so I wanted to go a little into

480
00:18:24,250 --> 00:18:32,770
anti analysis I'll try not to talk too

481
00:18:31,150 --> 00:18:36,340
fast while still getting through all my

482
00:18:32,770 --> 00:18:37,660
content so geo blocking this one I just

483
00:18:36,340 --> 00:18:39,760
wanted to point out where it says the

484
00:18:37,660 --> 00:18:41,860
blocker dot PHP says a lot of times the

485
00:18:39,760 --> 00:18:44,500
Sun is inclusion I'll get into that the

486
00:18:41,860 --> 00:18:46,209
rest of that code in a second but a lot

487
00:18:44,500 --> 00:18:49,300
of times it's done through an HT access

488
00:18:46,210 --> 00:18:52,660
file or robots.txt file where it's gonna

489
00:18:49,300 --> 00:18:55,060
deny the scanning engines for security

490
00:18:52,660 --> 00:18:57,190
companies so when you are running this

491
00:18:55,060 --> 00:18:59,260
and frec bread if the threat grid IP

492
00:18:57,190 --> 00:19:01,660
address is known to the attacker all

493
00:18:59,260 --> 00:19:03,370
they do is block it give a false 404

494
00:19:01,660 --> 00:19:05,080
page the records going to show you

495
00:19:03,370 --> 00:19:07,959
before a flower page vo there's nothing

496
00:19:05,080 --> 00:19:10,330
here for the score 0 and you go about

497
00:19:07,960 --> 00:19:14,230
your day and your user that's opening

498
00:19:10,330 --> 00:19:16,510
this from home gets right into it same

499
00:19:14,230 --> 00:19:18,400
thing works for user agent blocking this

500
00:19:16,510 --> 00:19:20,200
we kind of got some weird ones on it too

501
00:19:18,400 --> 00:19:22,980
but you'll see like message Labs is

502
00:19:20,200 --> 00:19:25,919
semantics email URL

503
00:19:22,980 --> 00:19:27,450
i securities another security company so

504
00:19:25,919 --> 00:19:29,220
it's just trying to block you know

505
00:19:27,450 --> 00:19:32,309
fishtank and all these things and it

506
00:19:29,220 --> 00:19:34,140
just provides a false 404 page this is

507
00:19:32,309 --> 00:19:38,820
another example it's a little beefier

508
00:19:34,140 --> 00:19:40,740
same concept so other things and this is

509
00:19:38,820 --> 00:19:42,330
you know sorry for the defenders because

510
00:19:40,740 --> 00:19:43,410
now you're dealing with the red teamers

511
00:19:42,330 --> 00:19:45,928
in the room that are gonna think of

512
00:19:43,410 --> 00:19:48,360
these things things like hey is that

513
00:19:45,929 --> 00:19:50,190
your is the email address in the URL

514
00:19:48,360 --> 00:19:52,590
does that match somebody that that

515
00:19:50,190 --> 00:19:54,780
received it so most analysts will change

516
00:19:52,590 --> 00:19:59,459
it to something like user at example.com

517
00:19:54,780 --> 00:20:01,980
I like lol lol comm if I change that I

518
00:19:59,460 --> 00:20:04,110
might get a 404 back but if I use the

519
00:20:01,980 --> 00:20:07,230
actual recipients email address maybe

520
00:20:04,110 --> 00:20:09,870
the fish shows up in that case I've now

521
00:20:07,230 --> 00:20:11,880
doxxed my recipient's email address the

522
00:20:09,870 --> 00:20:14,070
attackers said hey this is valid because

523
00:20:11,880 --> 00:20:15,780
they had to report it to me right so you

524
00:20:14,070 --> 00:20:18,689
know that's something you tried really

525
00:20:15,780 --> 00:20:21,120
don't want to do as an analyst something

526
00:20:18,690 --> 00:20:22,980
that dies after the first view so once

527
00:20:21,120 --> 00:20:25,199
your victim has gone to it you look at

528
00:20:22,980 --> 00:20:27,230
it you think it's offline you sit back

529
00:20:25,200 --> 00:20:30,360
on your laurels that thing's alive

530
00:20:27,230 --> 00:20:32,250
tracking refers so looking at multiple

531
00:20:30,360 --> 00:20:34,139
URLs that have gone and where it's

532
00:20:32,250 --> 00:20:36,210
coming from making sure it comes from

533
00:20:34,140 --> 00:20:39,690
the lore email and is going to the N

534
00:20:36,210 --> 00:20:42,720
fish we're using iframes where the

535
00:20:39,690 --> 00:20:45,120
actual content hosted is not domain that

536
00:20:42,720 --> 00:20:48,600
you're looking at so we were kind of

537
00:20:45,120 --> 00:20:51,030
touched on fake 404s you'll have benign

538
00:20:48,600 --> 00:20:53,129
redirects so this is something where pay

539
00:20:51,030 --> 00:20:57,149
your IP address is coming from security

540
00:20:53,130 --> 00:21:00,090
company ABC and it's going to just send

541
00:20:57,150 --> 00:21:02,580
you to google.com or send you to you

542
00:21:00,090 --> 00:21:05,129
know Yahoo News or something to that

543
00:21:02,580 --> 00:21:06,809
effect you look at it and you just don't

544
00:21:05,130 --> 00:21:09,299
think twice you go on to the next thing

545
00:21:06,809 --> 00:21:11,730
everyone else from the other IP address

546
00:21:09,299 --> 00:21:13,918
can go to that fish sometimes the

547
00:21:11,730 --> 00:21:15,390
redirected PDFs that are just found out

548
00:21:13,919 --> 00:21:17,370
of an Internet so the user thinks

549
00:21:15,390 --> 00:21:19,200
nothing of what's going on they they

550
00:21:17,370 --> 00:21:21,239
were expecting a PDF and they put their

551
00:21:19,200 --> 00:21:25,559
creds in to get a PDF they get a PDF

552
00:21:21,240 --> 00:21:27,150
it'll just be a random one I won't get

553
00:21:25,559 --> 00:21:30,510
too far into this because this kind of

554
00:21:27,150 --> 00:21:32,400
lengthy topic but wild card EMS creates

555
00:21:30,510 --> 00:21:34,799
challenges for blocking on your firewall

556
00:21:32,400 --> 00:21:37,169
so if you're just block

557
00:21:34,799 --> 00:21:39,240
you know example.com or you get one

558
00:21:37,169 --> 00:21:41,730
phishing URL and so you get that first

559
00:21:39,240 --> 00:21:44,669
one you know it could be that everybody

560
00:21:41,730 --> 00:21:47,279
that visits it from the embedded link in

561
00:21:44,669 --> 00:21:49,200
the email they get a different sub

562
00:21:47,279 --> 00:21:52,080
domain every time this can be very

563
00:21:49,200 --> 00:21:54,510
tricky to block if these example.com in

564
00:21:52,080 --> 00:21:58,918
this case is a site that your company is

565
00:21:54,510 --> 00:22:01,289
actually using so layered redirects I

566
00:21:58,919 --> 00:22:03,659
just grabbed this this PayPal fish right

567
00:22:01,289 --> 00:22:06,120
off a fish tank and I used some really

568
00:22:03,659 --> 00:22:08,340
random URL shorteners but to give you an

569
00:22:06,120 --> 00:22:10,590
idea here a lot of scanning engines

570
00:22:08,340 --> 00:22:12,510
might might get to like this piece but

571
00:22:10,590 --> 00:22:15,209
they won't get all the way down there so

572
00:22:12,510 --> 00:22:17,399
that's another challenge to be faced the

573
00:22:15,210 --> 00:22:19,289
screenshots from where goes com it's one

574
00:22:17,399 --> 00:22:20,908
of my favorite tools it's just so much

575
00:22:19,289 --> 00:22:22,710
faster than using curl and double you

576
00:22:20,909 --> 00:22:24,450
get and having to do everything just use

577
00:22:22,710 --> 00:22:27,360
a web tool throw it in there see what

578
00:22:24,450 --> 00:22:28,860
the end target is so directory

579
00:22:27,360 --> 00:22:31,529
generators this is the one that's

580
00:22:28,860 --> 00:22:33,959
visiting us again basically all this

581
00:22:31,529 --> 00:22:36,419
code is on the bottom and this PHP file

582
00:22:33,960 --> 00:22:38,549
is saying every time that this is

583
00:22:36,419 --> 00:22:42,419
visited so it's usually an index dot PHP

584
00:22:38,549 --> 00:22:44,340
that's the link in the phishing email go

585
00:22:42,419 --> 00:22:47,039
ahead and take a copy of all my fishing

586
00:22:44,340 --> 00:22:50,189
files create a new directory with a

587
00:22:47,039 --> 00:22:52,049
random md5 hash copy all those files in

588
00:22:50,190 --> 00:22:54,120
there and then half the person go to

589
00:22:52,049 --> 00:22:56,190
that what happens is you had to put with

590
00:22:54,120 --> 00:22:58,500
a very full compromised web server

591
00:22:56,190 --> 00:23:00,360
because every time somebody clicks it

592
00:22:58,500 --> 00:23:03,330
there's a new directory with a whole new

593
00:23:00,360 --> 00:23:05,490
set of phishing files I may or may not

594
00:23:03,330 --> 00:23:07,949
have heard of people just filling up the

595
00:23:05,490 --> 00:23:09,330
resource limit on a web server by just

596
00:23:07,950 --> 00:23:11,760
hitting that page over and over again

597
00:23:09,330 --> 00:23:13,860
but essentially that's what that's doing

598
00:23:11,760 --> 00:23:17,669
it becomes very difficult again from a

599
00:23:13,860 --> 00:23:19,918
blocking and analysis perspective so

600
00:23:17,669 --> 00:23:21,960
other things that can be done is hiding

601
00:23:19,919 --> 00:23:25,740
your files in multiple places so a fish

602
00:23:21,960 --> 00:23:28,080
or my pop a web server some somebody's

603
00:23:25,740 --> 00:23:29,820
site and they'll put a copy and WP

604
00:23:28,080 --> 00:23:31,980
includes the admin removes it and

605
00:23:29,820 --> 00:23:33,720
there's still copying WP content maybe

606
00:23:31,980 --> 00:23:36,019
they change the redirect point to the

607
00:23:33,720 --> 00:23:38,850
one that's live some things that effect

608
00:23:36,019 --> 00:23:40,500
using a backdoor web shell they can go

609
00:23:38,850 --> 00:23:42,529
in and every time you remove the file

610
00:23:40,500 --> 00:23:45,389
they're going to put it right back up or

611
00:23:42,529 --> 00:23:45,600
doing forwarding rules this is kind of

612
00:23:45,389 --> 00:23:49,020
the

613
00:23:45,600 --> 00:23:51,780
best example of persistence in fishing I

614
00:23:49,020 --> 00:23:54,540
would say so they can intercept a

615
00:23:51,780 --> 00:23:55,980
password reset email they can intercept

616
00:23:54,540 --> 00:23:58,470
everything that that person is getting

617
00:23:55,980 --> 00:24:00,810
so the person calls the helpdesk hey I

618
00:23:58,470 --> 00:24:02,700
need to reset my password it's completed

619
00:24:00,810 --> 00:24:04,740
they're still getting every email from

620
00:24:02,700 --> 00:24:07,110
the inbox without even having to log in

621
00:24:04,740 --> 00:24:09,600
so you'll see this a lot laughter this

622
00:24:07,110 --> 00:24:11,459
the email address is popped will add

623
00:24:09,600 --> 00:24:13,290
their own email address as a forward and

624
00:24:11,460 --> 00:24:17,160
so you know if you're investigating

625
00:24:13,290 --> 00:24:18,690
these check the inbox rules and this is

626
00:24:17,160 --> 00:24:21,840
really where you're taking the stuff out

627
00:24:18,690 --> 00:24:24,540
so oftentimes that's pulling things to

628
00:24:21,840 --> 00:24:26,970
an email account so it'll be a PHP file

629
00:24:24,540 --> 00:24:29,070
and that's part of the fish there's a

630
00:24:26,970 --> 00:24:30,900
post that goes to it and just sends out

631
00:24:29,070 --> 00:24:33,270
you know it'll kind of build out the

632
00:24:30,900 --> 00:24:34,860
email usually there's falsified header

633
00:24:33,270 --> 00:24:36,660
information and it'll use that

634
00:24:34,860 --> 00:24:40,260
compromised web server to send things

635
00:24:36,660 --> 00:24:41,760
out storing text files on there and then

636
00:24:40,260 --> 00:24:43,860
they'll go back and either just pull

637
00:24:41,760 --> 00:24:46,980
down the text file of it's open Internet

638
00:24:43,860 --> 00:24:49,260
accessible or they can use a PHP or web

639
00:24:46,980 --> 00:24:51,120
shell backdoor and do this or this is

640
00:24:49,260 --> 00:24:53,580
cool if you're an analyst is sometimes

641
00:24:51,120 --> 00:24:55,290
you can actually grab that text file so

642
00:24:53,580 --> 00:24:57,480
if you can grab it before they clear it

643
00:24:55,290 --> 00:24:58,889
before an attacker clears it you can

644
00:24:57,480 --> 00:25:00,990
have a full list of people that have

645
00:24:58,890 --> 00:25:02,730
fallen for that fish including those

646
00:25:00,990 --> 00:25:05,100
that are part of your organization and

647
00:25:02,730 --> 00:25:06,150
everybody else and you can kind of go

648
00:25:05,100 --> 00:25:09,780
through that and it helps with the

649
00:25:06,150 --> 00:25:13,590
remediation process so that or one or

650
00:25:09,780 --> 00:25:16,170
over okay I already kind of covered the

651
00:25:13,590 --> 00:25:18,600
forwarding rules anyway so that's my

652
00:25:16,170 --> 00:25:20,760
last reminder is that the average time

653
00:25:18,600 --> 00:25:23,790
it takes for a Fisher even not

654
00:25:20,760 --> 00:25:26,040
sophisticated Fisher about 15 minutes to

655
00:25:23,790 --> 00:25:27,720
get in back into an account and then

656
00:25:26,040 --> 00:25:29,370
abuse an account for whatever they're in

657
00:25:27,720 --> 00:25:31,890
purposes whether it's sending more

658
00:25:29,370 --> 00:25:32,639
payloads out or sealing information from

659
00:25:31,890 --> 00:25:34,950
that Inbox

660
00:25:32,640 --> 00:25:37,320
so knowing that these things can happen

661
00:25:34,950 --> 00:25:38,640
speed up the analysis process and allow

662
00:25:37,320 --> 00:25:41,820
you to be able to remediate the

663
00:25:38,640 --> 00:25:45,030
situation much faster I guess we have 30

664
00:25:41,820 --> 00:25:55,290
seconds for questions I go through it

665
00:25:45,030 --> 00:25:57,300
all busy schedule either later in your

666
00:25:55,290 --> 00:25:58,340
email the annoying thing for me as a

667
00:25:57,300 --> 00:25:59,990
user is the

668
00:25:58,340 --> 00:26:02,240
the link is in my email when I hover

669
00:25:59,990 --> 00:26:04,010
over it just as Microsoft say Thanks

670
00:26:02,240 --> 00:26:06,470
tell me anywhere about where it's going

671
00:26:04,010 --> 00:26:09,290
right what's your opinion on that like

672
00:26:06,470 --> 00:26:12,020
obviously how much do you drop myself to

673
00:26:09,290 --> 00:26:17,149
correctly identify this patient

674
00:26:12,020 --> 00:26:20,510
specifically Microsoft so just to be

675
00:26:17,150 --> 00:26:22,550
frank so and that isn't actually

676
00:26:20,510 --> 00:26:24,440
Microsoft specific so you I'll rewrite

677
00:26:22,550 --> 00:26:26,570
creates more challenges from the user

678
00:26:24,440 --> 00:26:30,590
training perspective because of exactly

679
00:26:26,570 --> 00:26:32,389
what you're explaining and you because

680
00:26:30,590 --> 00:26:34,340
it's not a hundred it's not catching a

681
00:26:32,390 --> 00:26:37,400
hundred percent because no tool is going

682
00:26:34,340 --> 00:26:40,550
to catch a hundred percent of fish you

683
00:26:37,400 --> 00:26:42,590
kind of you lose all that ability for

684
00:26:40,550 --> 00:26:45,560
the user to defend themselves without

685
00:26:42,590 --> 00:26:48,350
deeming full protection on the other

686
00:26:45,560 --> 00:26:50,300
side of it so it's good from a metric

687
00:26:48,350 --> 00:26:51,649
perspectives that sometimes those will

688
00:26:50,300 --> 00:26:54,080
tell you when you're doing the

689
00:26:51,650 --> 00:26:55,490
investigation that you had 30 people

690
00:26:54,080 --> 00:26:56,840
click it without you having to go

691
00:26:55,490 --> 00:26:59,570
through your stand where your firewall

692
00:26:56,840 --> 00:27:02,659
logs so that effect it can be agreeing

693
00:26:59,570 --> 00:27:04,340
you know advantages but you know for the

694
00:27:02,660 --> 00:27:07,670
most part I don't find those protection

695
00:27:04,340 --> 00:27:10,149
tools to be very effective and I I'm a

696
00:27:07,670 --> 00:27:12,560
big fan of user education and training

697
00:27:10,150 --> 00:27:14,210
you know again it's not nothing's gonna

698
00:27:12,560 --> 00:27:16,970
be 100 percent but I think that there's

699
00:27:14,210 --> 00:27:18,710
a first layer of defense so anything you

700
00:27:16,970 --> 00:27:21,260
can give them that's a weapon versus

701
00:27:18,710 --> 00:27:38,270
relying on the tool to do the job is

702
00:27:21,260 --> 00:27:40,790
better in my opinion anyway else I've

703
00:27:38,270 --> 00:27:42,850
not faced it but I am familiar so I've

704
00:27:40,790 --> 00:27:45,379
seen that with SMS being the two-factor

705
00:27:42,850 --> 00:27:47,149
I've heard of it being done with other

706
00:27:45,380 --> 00:27:52,370
attacks but I haven't seen it in the

707
00:27:47,150 --> 00:27:54,680
wild myself there we go

708
00:27:52,370 --> 00:27:59,409
I know I've read the article on it but I

709
00:27:54,680 --> 00:28:00,950
haven't caught one myself waiting on it

710
00:27:59,410 --> 00:28:02,900
there we go

711
00:28:00,950 --> 00:28:04,940
there's the solution so you should

712
00:28:02,900 --> 00:28:07,190
probably have that off anyway IMAP and

713
00:28:04,940 --> 00:28:09,290
POP um nothing really good ever comes

714
00:28:07,190 --> 00:28:11,960
from that so you know it's almost

715
00:28:09,290 --> 00:28:14,389
somebody's using Thunderbird today sir

716
00:28:11,960 --> 00:28:19,880
email most enterprises probably should

717
00:28:14,390 --> 00:28:21,970
have that off anybody else okay thank

718
00:28:19,880 --> 00:28:21,970
you

