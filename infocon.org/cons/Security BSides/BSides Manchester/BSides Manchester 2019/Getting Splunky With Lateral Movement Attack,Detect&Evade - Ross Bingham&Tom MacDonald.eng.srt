1
00:00:03,300 --> 00:00:07,260
Lyra's happy days

2
00:00:05,530 --> 00:00:09,820
thanks very much for coming to our talk

3
00:00:07,260 --> 00:00:11,200
not really with these microphones at

4
00:00:09,820 --> 00:00:12,999
some point I'll inevitably move it away

5
00:00:11,200 --> 00:00:14,110
from my face and carry on talking you

6
00:00:12,999 --> 00:00:15,459
just like give us a little wave on the

7
00:00:14,110 --> 00:00:16,780
front when I would have been done that'd

8
00:00:15,459 --> 00:00:18,250
be good things we're gonna be talking

9
00:00:16,780 --> 00:00:20,050
about following on from our steel

10
00:00:18,250 --> 00:00:22,448
conside of life forever Game one

11
00:00:20,050 --> 00:00:25,029
Kerberos is attacking detecting and

12
00:00:22,449 --> 00:00:26,349
evading talk about the various parts of

13
00:00:25,029 --> 00:00:28,240
how that works within a red team life

14
00:00:26,349 --> 00:00:32,320
cycle and a segue from the red team

15
00:00:28,240 --> 00:00:34,660
United okay so this is me red team

16
00:00:32,320 --> 00:00:36,219
around principle over attitude I tend to

17
00:00:34,660 --> 00:00:39,218
do red teaming and like large

18
00:00:36,219 --> 00:00:41,260
complicated infrastructures used to be a

19
00:00:39,219 --> 00:00:43,660
sysadmin until I saw the lights in Cairo

20
00:00:41,260 --> 00:00:45,760
security did some stuff in the army

21
00:00:43,660 --> 00:00:46,828
vaguely related to this and then I've

22
00:00:45,760 --> 00:00:49,030
spoken to a couple of other places

23
00:00:46,829 --> 00:00:50,590
received and then delivered our red team

24
00:00:49,030 --> 00:00:57,250
training and I've got some generic

25
00:00:50,590 --> 00:01:00,309
search there okay red teamer attitudes

26
00:00:57,250 --> 00:01:02,379
also the world small team of users both

27
00:01:00,309 --> 00:01:03,459
my team spent a variety of engagements

28
00:01:02,379 --> 00:01:04,989
paid media our products

29
00:01:03,460 --> 00:01:07,509
technically teams ultimately reporting

30
00:01:04,989 --> 00:01:08,920
as all an engagement since they'll be

31
00:01:07,509 --> 00:01:10,150
getting a lot more involved inside which

32
00:01:08,920 --> 00:01:11,830
they all didn't say two things as well

33
00:01:10,150 --> 00:01:13,780
where we are CGI team look at here we

34
00:01:11,830 --> 00:01:16,060
could always build out of it as well and

35
00:01:13,780 --> 00:01:17,560
it's been a big deal in the world of

36
00:01:16,060 --> 00:01:19,030
detection is very unruly wakes this

37
00:01:17,560 --> 00:01:20,920
process won't come back and things like

38
00:01:19,030 --> 00:01:26,430
that video service less deeds and

39
00:01:20,920 --> 00:01:26,430
practically red team spent five years

40
00:01:26,729 --> 00:01:30,908
also so let's talk about what we're

41
00:01:29,320 --> 00:01:32,860
going to be covering in the talk and

42
00:01:30,909 --> 00:01:34,899
also more importantly like why we're

43
00:01:32,860 --> 00:01:37,539
going to be covering it and so what the

44
00:01:34,899 --> 00:01:39,850
the catalyst for this talk is we have a

45
00:01:37,540 --> 00:01:41,140
quick team they are on lateral movement

46
00:01:39,850 --> 00:01:42,520
because there's lots of different types

47
00:01:41,140 --> 00:01:45,850
and the three that we're going to focus

48
00:01:42,520 --> 00:01:47,829
on again we're using Splunk in this talk

49
00:01:45,850 --> 00:01:50,229
and the only reason we're doing that is

50
00:01:47,829 --> 00:01:51,969
good we can email info at home and

51
00:01:50,229 --> 00:01:53,710
saying hey can I have a dev license and

52
00:01:51,969 --> 00:01:55,509
they go yes and it really is that simple

53
00:01:53,710 --> 00:01:58,059
it's not Splunk up there we don't use

54
00:01:55,509 --> 00:01:59,020
bunk internally you know I think we're

55
00:01:58,060 --> 00:02:01,869
platform agnostic

56
00:01:59,020 --> 00:02:03,789
looks like we're c2 agnostic so it's not

57
00:02:01,869 --> 00:02:05,259
slumber but I'll give you a tldr and how

58
00:02:03,789 --> 00:02:06,969
we've set it up and why we've set it up

59
00:02:05,259 --> 00:02:08,590
certain ways then we're moving to the

60
00:02:06,969 --> 00:02:10,419
good stuff the attack detect and debate

61
00:02:08,590 --> 00:02:12,040
focused on PS exact that hopefully

62
00:02:10,419 --> 00:02:14,170
majority of people are familiar with

63
00:02:12,040 --> 00:02:16,390
to BMI or women from this point on and

64
00:02:14,170 --> 00:02:18,459
then T common we'll give you a Bic

65
00:02:16,390 --> 00:02:19,929
sortie ldiot but they are before we go

66
00:02:18,460 --> 00:02:21,310
into one I'm more importantly and this

67
00:02:19,930 --> 00:02:22,690
is where I'm quite quite passionate

68
00:02:21,310 --> 00:02:24,520
about like what are the key takeaways

69
00:02:22,690 --> 00:02:26,380
for your organizations whether you're on

70
00:02:24,520 --> 00:02:28,900
like the blue side the red side the

71
00:02:26,380 --> 00:02:30,430
policy side or wherever you sit in our

72
00:02:28,900 --> 00:02:32,310
industry like there's some key takeaways

73
00:02:30,430 --> 00:02:34,560
that should hopefully be relevant

74
00:02:32,310 --> 00:02:37,060
because if you're struggling for

75
00:02:34,560 --> 00:02:37,660
resources manpower time wherever it

76
00:02:37,060 --> 00:02:39,850
happens to be

77
00:02:37,660 --> 00:02:42,910
if you can't prioritize on anything just

78
00:02:39,850 --> 00:02:44,620
because you've got so much to do private

79
00:02:42,910 --> 00:02:46,920
eyes on these first because at least

80
00:02:44,620 --> 00:02:49,330
this will get you off the start line

81
00:02:46,920 --> 00:02:52,359
she'll just expand on the kind of one

82
00:02:49,330 --> 00:02:53,620
way but behind the talk has a red team

83
00:02:52,360 --> 00:02:55,860
unit loving these engagements there's

84
00:02:53,620 --> 00:02:58,570
kind of three really critical points and

85
00:02:55,860 --> 00:03:00,340
the blue team can start detainer action

86
00:02:58,570 --> 00:03:02,079
or like signature of what you're doing

87
00:03:00,340 --> 00:03:03,850
so initial execution being the first one

88
00:03:02,080 --> 00:03:05,709
going do you know maybe simulate an

89
00:03:03,850 --> 00:03:07,750
external attack occupation you're gonna

90
00:03:05,709 --> 00:03:09,850
want a plank we're so user and - you

91
00:03:07,750 --> 00:03:12,280
know downloading a file and run a

92
00:03:09,850 --> 00:03:15,400
microwave race and that's when I perform

93
00:03:12,280 --> 00:03:17,440
key significant elections on a host team

94
00:03:15,400 --> 00:03:19,510
can you know have IOC score and detect

95
00:03:17,440 --> 00:03:21,250
on similarly with assistance you're

96
00:03:19,510 --> 00:03:23,530
going to generally be dropping something

97
00:03:21,250 --> 00:03:25,750
somewhere to desk that is then gonna

98
00:03:23,530 --> 00:03:30,700
leave an ayah pigment or and I receive

99
00:03:25,750 --> 00:03:32,080
on the host you can detect over looking

100
00:03:30,700 --> 00:03:33,220
about for movement again several

101
00:03:32,080 --> 00:03:35,380
problems here you're going to have to

102
00:03:33,220 --> 00:03:37,510
make defined actions within the

103
00:03:35,380 --> 00:03:39,730
environment your and the abou team can

104
00:03:37,510 --> 00:03:45,070
aware on and such as you make your

105
00:03:39,730 --> 00:03:49,660
network connections in some places and

106
00:03:45,070 --> 00:03:53,350
just falls on from are looking it was my

107
00:03:49,660 --> 00:03:55,180
last thought and now sees that waste so

108
00:03:53,350 --> 00:03:58,930
it is a quick run down of spunk when one

109
00:03:55,180 --> 00:04:00,820
base logistic so in this throw memorize

110
00:03:58,930 --> 00:04:02,830
what you would expect it V is sponsoring

111
00:04:00,820 --> 00:04:06,010
a set new environment consumed on the

112
00:04:02,830 --> 00:04:08,260
log scale 42 from forwarder forward on

113
00:04:06,010 --> 00:04:11,048
is what runs on your workstation server

114
00:04:08,260 --> 00:04:13,179
the exactly also remote collections may

115
00:04:11,049 --> 00:04:15,459
involve almost where we want 80 volts

116
00:04:13,180 --> 00:04:22,510
forwards in the server for ingestion

117
00:04:15,459 --> 00:04:24,030
index index in trouble it basically

118
00:04:22,510 --> 00:04:25,830
organizes an index

119
00:04:24,030 --> 00:04:28,859
coming in so you may have like a Windows

120
00:04:25,830 --> 00:04:30,690
index a Linux index accessible index and

121
00:04:28,860 --> 00:04:32,940
that's basically failure events

122
00:04:30,690 --> 00:04:34,500
accordingly source types just something

123
00:04:32,940 --> 00:04:36,210
we're going to use if you want to be a

124
00:04:34,500 --> 00:04:37,590
bit more granular your section so you

125
00:04:36,210 --> 00:04:40,530
maybe want to only want to look in says

126
00:04:37,590 --> 00:04:42,000
one event maybe windows events etc you

127
00:04:40,530 --> 00:04:44,549
can do that with that and it certainly

128
00:04:42,000 --> 00:04:46,080
says again pretty much what it says is

129
00:04:44,550 --> 00:04:48,960
it's what we're gonna use to drill down

130
00:04:46,080 --> 00:04:51,330
and either do this one so just a quick

131
00:04:48,960 --> 00:04:52,919
review of first long say I will get n

132
00:04:51,330 --> 00:04:55,050
dependent on kind of price server just

133
00:04:52,919 --> 00:04:57,599
install that you've been to base and

134
00:04:55,050 --> 00:05:00,090
ESXi universal form is pushed out to our

135
00:04:57,600 --> 00:05:01,380
workstations and servers and we'll get

136
00:05:00,090 --> 00:05:02,909
cest one deployed on to those

137
00:05:01,380 --> 00:05:05,969
workstations and servers as well use for

138
00:05:02,910 --> 00:05:08,430
additional visibility and this one where

139
00:05:05,970 --> 00:05:10,650
I could contact can generally rival most

140
00:05:08,430 --> 00:05:12,600
of it okay Peggy be ours for visibility

141
00:05:10,650 --> 00:05:13,890
and endpoints and so it's definitely

142
00:05:12,600 --> 00:05:15,510
something more food is free from

143
00:05:13,890 --> 00:05:16,650
Microsoft so if you know how to deploy

144
00:05:15,510 --> 00:05:17,130
in your environment something to

145
00:05:16,650 --> 00:05:18,900
consider

146
00:05:17,130 --> 00:05:20,159
we're using special insecurities

147
00:05:18,900 --> 00:05:22,010
assessment current practice because it

148
00:05:20,160 --> 00:05:25,110
gives you a good baseline can work from

149
00:05:22,010 --> 00:05:27,180
and also practically pedesta maybe never

150
00:05:25,110 --> 00:05:28,770
been to the camera stock is the point in

151
00:05:27,180 --> 00:05:31,490
advance though the policy of on to our

152
00:05:28,770 --> 00:05:33,840
hosts windows oh the box just has a

153
00:05:31,490 --> 00:05:36,419
reasonably vanilla auditing policy the

154
00:05:33,840 --> 00:05:38,159
point really collect seven logs just

155
00:05:36,419 --> 00:05:39,719
from like a resource consumption so each

156
00:05:38,160 --> 00:05:40,800
perspective the problem with that is

157
00:05:39,720 --> 00:05:43,320
some of the key events that we're gonna

158
00:05:40,800 --> 00:05:45,720
be looking at today and for taking these

159
00:05:43,320 --> 00:05:47,700
things they aren't detected by default

160
00:05:45,720 --> 00:05:49,110
they're the box so you're not pushing

161
00:05:47,700 --> 00:05:51,120
out custom cornflake that's gonna pack

162
00:05:49,110 --> 00:05:53,070
up these you're gonna miss them there's

163
00:05:51,120 --> 00:05:55,229
one thing to be aware of and still

164
00:05:53,070 --> 00:05:58,020
blindly just push our custom contract

165
00:05:55,229 --> 00:06:00,419
and open the best which is what I done

166
00:05:58,020 --> 00:06:02,700
and chickens bone server and with about

167
00:06:00,419 --> 00:06:04,500
50 million events and pullers and so

168
00:06:02,700 --> 00:06:06,360
there's five one five six C's and

169
00:06:04,500 --> 00:06:08,190
windows event loads that basically

170
00:06:06,360 --> 00:06:11,210
anything literally and if it happens on

171
00:06:08,190 --> 00:06:14,310
a whole stationery generate loads and

172
00:06:11,210 --> 00:06:16,620
usage license fairly quickly and you

173
00:06:14,310 --> 00:06:18,930
don't do that it just a quick overview

174
00:06:16,620 --> 00:06:24,350
of a network diagram as well and you

175
00:06:18,930 --> 00:06:24,350
save if you've seen a proxy server the

176
00:06:24,380 --> 00:06:27,990
server again since in environment all

177
00:06:26,850 --> 00:06:29,700
that forward was go through that

178
00:06:27,990 --> 00:06:32,340
otherwise home since one server she

179
00:06:29,700 --> 00:06:34,380
really exists and window space Eckstein

180
00:06:32,340 --> 00:06:36,008
DC really patched Windows 10

181
00:06:34,380 --> 00:06:39,039
workstations will be configured

182
00:06:36,009 --> 00:06:41,740
December 1 microfarad or I'm sayin Ola

183
00:06:39,039 --> 00:06:44,050
on the end points in Vols got a Polish

184
00:06:41,740 --> 00:06:45,639
trust and tedamy coal or bank and the

185
00:06:44,050 --> 00:06:46,479
reason we've done that is something you

186
00:06:45,639 --> 00:06:47,770
could challenge these in better

187
00:06:46,479 --> 00:06:49,869
environments where you get really good

188
00:06:47,770 --> 00:06:51,639
visibility and one location but not

189
00:06:49,869 --> 00:06:54,430
another location so it just looks at the

190
00:06:51,639 --> 00:06:55,629
challenges hope we can partially CNT

191
00:06:54,430 --> 00:06:57,249
different things based on poor

192
00:06:55,629 --> 00:07:01,149
visibility across the waiting State not

193
00:06:57,249 --> 00:07:03,129
just one state and assign it okay good

194
00:07:01,149 --> 00:07:04,539
stuff so there's a hatred of tree

195
00:07:03,129 --> 00:07:06,999
knowledge so one understand where we are

196
00:07:04,539 --> 00:07:08,740
and the set up so let's move it to there

197
00:07:06,999 --> 00:07:11,979
three berries two types of coverage so

198
00:07:08,740 --> 00:07:14,589
SMB and the exec from PS exact report

199
00:07:11,979 --> 00:07:15,490
hopeful hi cops and we will move into we

200
00:07:14,589 --> 00:07:17,889
meet windows management instrumentation

201
00:07:15,490 --> 00:07:19,659
and distributed common object model or

202
00:07:17,889 --> 00:07:21,339
decock okay we're gonna break each one

203
00:07:19,659 --> 00:07:22,899
of those down into attack detect and

204
00:07:21,339 --> 00:07:25,120
evade the idea of the attack is like

205
00:07:22,899 --> 00:07:27,580
Lowe's low skill attacker and you know

206
00:07:25,120 --> 00:07:29,469
sort of maybe an internal in a test

207
00:07:27,580 --> 00:07:31,719
where you know stealth isn't our primary

208
00:07:29,469 --> 00:07:32,919
concern or if you've been asked by

209
00:07:31,719 --> 00:07:35,080
different intelligence that the

210
00:07:32,919 --> 00:07:37,209
regulators given to you to Rick to

211
00:07:35,080 --> 00:07:38,619
emulate a particular attacker as if

212
00:07:37,209 --> 00:07:40,029
you're doing red teaming without having

213
00:07:38,619 --> 00:07:41,919
threat intelligence in front of it

214
00:07:40,029 --> 00:07:44,439
newsflash you're not actually do mighty

215
00:07:41,919 --> 00:07:46,180
me so this is a we're going to break it

216
00:07:44,439 --> 00:07:50,110
down into high spice kill attacker those

217
00:07:46,180 --> 00:07:51,639
give us a kiss our defense okay so the

218
00:07:50,110 --> 00:07:54,249
current accesses in all the videos we

219
00:07:51,639 --> 00:07:56,979
pretty much got a low brave shell as a

220
00:07:54,249 --> 00:07:59,409
user you know whichever Joe Bloggs and

221
00:07:56,979 --> 00:08:00,818
we've got elevated creds to move

222
00:07:59,409 --> 00:08:02,709
somewhere else it doesn't make any

223
00:08:00,819 --> 00:08:04,300
difference than this talk whether its

224
00:08:02,709 --> 00:08:06,580
workstation to workstation workstation

225
00:08:04,300 --> 00:08:07,659
to server or server to server makes no

226
00:08:06,580 --> 00:08:09,308
difference because we're not worried

227
00:08:07,659 --> 00:08:11,349
about the or the targets and the

228
00:08:09,309 --> 00:08:12,759
originating source are worried about the

229
00:08:11,349 --> 00:08:14,169
underlying mechanism not what you're

230
00:08:12,759 --> 00:08:15,849
using so don't get focused too much

231
00:08:14,169 --> 00:08:17,229
whether it's a server or whether it's a

232
00:08:15,849 --> 00:08:19,839
workstation doesn't really make much

233
00:08:17,229 --> 00:08:21,998
odds with deke army duty valid primary

234
00:08:19,839 --> 00:08:23,499
user token so it's very difficult to

235
00:08:21,999 --> 00:08:25,089
pass credentials to deke on stuff

236
00:08:23,499 --> 00:08:27,519
doesn't work so you may need to look at

237
00:08:25,089 --> 00:08:30,039
using like runners or UAC me versus prep

238
00:08:27,519 --> 00:08:31,629
bypasses and slow you AK but again you

239
00:08:30,039 --> 00:08:34,360
have bypasses as plenty of them around

240
00:08:31,629 --> 00:08:36,190
and plenty of those that still work and

241
00:08:34,360 --> 00:08:37,870
we'll touch on why we need about the

242
00:08:36,190 --> 00:08:42,279
primary user to open when we get to that

243
00:08:37,870 --> 00:08:43,479
section up in so just one can a key like

244
00:08:42,279 --> 00:08:45,519
differentiation I want to make poor

245
00:08:43,479 --> 00:08:47,520
weaken it again do this as PS exact

246
00:08:45,519 --> 00:08:48,900
original or classic pairing

247
00:08:47,520 --> 00:08:51,120
you know what it's moved into is more

248
00:08:48,900 --> 00:08:53,430
like pasta actually don't see too so

249
00:08:51,120 --> 00:08:55,650
classic PS exact is this essence their

250
00:08:53,430 --> 00:08:57,150
enormous binary that's basically you

251
00:08:55,650 --> 00:08:58,949
know maybe internal pain tears back

252
00:08:57,150 --> 00:09:00,840
there you're gonna drop that on to death

253
00:08:58,950 --> 00:09:02,820
or drop on the shears quiet around the

254
00:09:00,840 --> 00:09:04,140
network nobody's sophisticated not very

255
00:09:02,820 --> 00:09:06,540
advanced apply something is probably

256
00:09:04,140 --> 00:09:08,250
gonna occur now you can start to look

257
00:09:06,540 --> 00:09:10,380
any detections for ApS effect for

258
00:09:08,250 --> 00:09:13,410
example all of the recommendations hang

259
00:09:10,380 --> 00:09:15,750
on PSX ESPC door exit get dropped on

260
00:09:13,410 --> 00:09:17,250
tissues and things like that and biggest

261
00:09:15,750 --> 00:09:19,290
problem of that is if your PS exact

262
00:09:17,250 --> 00:09:21,180
detection relies on that so you're not

263
00:09:19,290 --> 00:09:22,740
going to catch PS expectancy to it

264
00:09:21,180 --> 00:09:24,810
because I'm seating different so it's

265
00:09:22,740 --> 00:09:26,820
just something to be aware of and go

266
00:09:24,810 --> 00:09:28,709
into this we're going to be focusing on

267
00:09:26,820 --> 00:09:31,170
yes detective agency to not know the

268
00:09:28,710 --> 00:09:32,730
classic membership and another also on

269
00:09:31,170 --> 00:09:34,439
is like Saint Mary's just go on I'm

270
00:09:32,730 --> 00:09:36,210
going to be a webbed up back is there

271
00:09:34,440 --> 00:09:38,450
equal to the broad saber probably not

272
00:09:36,210 --> 00:09:38,450
anymore

273
00:09:39,080 --> 00:09:42,900
okay cool so it's a first video on

274
00:09:41,610 --> 00:09:44,850
smooth hair so I can see what's

275
00:09:42,900 --> 00:09:46,439
appearing and so we buy a local if

276
00:09:44,850 --> 00:09:49,200
she'll hair is Jason Perry's just a

277
00:09:46,440 --> 00:09:50,820
generic nobody but we do have found es

278
00:09:49,200 --> 00:09:52,500
helpdesk so digital solutions help desk

279
00:09:50,820 --> 00:09:53,910
with a password you know and the

280
00:09:52,500 --> 00:09:55,290
mechanism by which we found that doesn't

281
00:09:53,910 --> 00:09:56,819
matter reaches you're using those creds

282
00:09:55,290 --> 00:09:58,439
to go somewhere else so this is a low

283
00:09:56,820 --> 00:10:00,630
skill attacker but basically using

284
00:09:58,440 --> 00:10:02,640
Pierce exact to bootstrap a ps1 liner

285
00:10:00,630 --> 00:10:04,740
don't worry about the ps1 liner aspect

286
00:10:02,640 --> 00:10:07,110
which is just using a ps1 line is

287
00:10:04,740 --> 00:10:08,580
throughout a the speed and be it's

288
00:10:07,110 --> 00:10:10,680
easier to hook for them in splint

289
00:10:08,580 --> 00:10:12,720
rather than using like custom deals with

290
00:10:10,680 --> 00:10:14,430
various entry points and things so we're

291
00:10:12,720 --> 00:10:17,040
just focusing on the method that we're

292
00:10:14,430 --> 00:10:19,260
using to instantiate power shop okay so

293
00:10:17,040 --> 00:10:21,150
this is using SMB exact and you'll see

294
00:10:19,260 --> 00:10:23,069
immediately because could have run calc

295
00:10:21,150 --> 00:10:24,600
anything we need it to there but because

296
00:10:23,070 --> 00:10:27,270
we around the ps1 liner we receive a

297
00:10:24,600 --> 00:10:28,920
shop relatively standard but you'll

298
00:10:27,270 --> 00:10:30,870
notice there because we of the way it

299
00:10:28,920 --> 00:10:33,150
works we receive an instant system shell

300
00:10:30,870 --> 00:10:34,590
rather than going into a user process

301
00:10:33,150 --> 00:10:37,110
with another beta token it gives us a

302
00:10:34,590 --> 00:10:38,880
system token we do note as well down

303
00:10:37,110 --> 00:10:40,800
here we've got the hashes that was being

304
00:10:38,880 --> 00:10:42,930
used and then it gives you the service

305
00:10:40,800 --> 00:10:45,060
that was created then the service runs

306
00:10:42,930 --> 00:10:46,949
and then again the service is deleted

307
00:10:45,060 --> 00:10:49,170
Ross will cover a little bit more about

308
00:10:46,950 --> 00:10:51,630
that but this is fixed imposter twenty

309
00:10:49,170 --> 00:10:52,979
characters assuming you don't customize

310
00:10:51,630 --> 00:10:55,230
it because if you're not customizing

311
00:10:52,980 --> 00:11:00,030
your C two before you roll it best love

312
00:10:55,230 --> 00:11:01,350
that no just about amending section for

313
00:11:00,030 --> 00:11:02,819
PS exec generally

314
00:11:01,350 --> 00:11:04,560
on those firewalls gonna be a good place

315
00:11:02,820 --> 00:11:06,540
to start were staged in one station

316
00:11:04,560 --> 00:11:08,699
combs are really required in your

317
00:11:06,540 --> 00:11:10,319
environment and again a big focus for a

318
00:11:08,700 --> 00:11:11,700
lot of intersection PC XenDesktop

319
00:11:10,320 --> 00:11:13,230
are going to be alright understanding

320
00:11:11,700 --> 00:11:15,240
your environment so you're gonna beldo

321
00:11:13,230 --> 00:11:16,590
detections to interjections you know

322
00:11:15,240 --> 00:11:18,210
aerosol that you're going to need to

323
00:11:16,590 --> 00:11:19,140
know what's normal and your environment

324
00:11:18,210 --> 00:11:21,660
before you just go through it in

325
00:11:19,140 --> 00:11:23,430
detection zone why don't you sell all

326
00:11:21,660 --> 00:11:25,650
the lamps so work sees the WorkSafe

327
00:11:23,430 --> 00:11:27,660
don't are really legitimate and firewall

328
00:11:25,650 --> 00:11:30,120
can protect as well weapon and layer on

329
00:11:27,660 --> 00:11:31,620
it ensure you're talking pellet policies

330
00:11:30,120 --> 00:11:33,090
configure it in conjunction bill apps as

331
00:11:31,620 --> 00:11:35,130
well just ensure that's all tied don't

332
00:11:33,090 --> 00:11:36,620
work station to say over comms is

333
00:11:35,130 --> 00:11:38,790
another one you can look at and

334
00:11:36,620 --> 00:11:41,490
generally they're only over one week and

335
00:11:38,790 --> 00:11:44,280
so if you've got like hosts continually

336
00:11:41,490 --> 00:11:45,720
talking back to a superfan table if you

337
00:11:44,280 --> 00:11:46,920
can look for that and another thing

338
00:11:45,720 --> 00:11:48,810
that's gonna off the back of the cab

339
00:11:46,920 --> 00:11:50,760
wrist i think it was probably done honey

340
00:11:48,810 --> 00:11:52,229
spend seeking like quickly reply into

341
00:11:50,760 --> 00:11:54,780
your environment is for a quick when the

342
00:11:52,230 --> 00:11:57,200
blue saves with honey shears in this one

343
00:11:54,780 --> 00:12:00,540
this is what you can do is create like

344
00:11:57,200 --> 00:12:02,310
something intriguing to an attacker on

345
00:12:00,540 --> 00:12:04,349
your FS or one or whatever searches and

346
00:12:02,310 --> 00:12:06,030
we can slash backup the dual digit ever

347
00:12:04,350 --> 00:12:07,200
be accessed you can then create an alert

348
00:12:06,030 --> 00:12:10,470
on that and Splunk

349
00:12:07,200 --> 00:12:12,900
and look provide 140 events again five

350
00:12:10,470 --> 00:12:14,490
140 s will get picked up by default so

351
00:12:12,900 --> 00:12:16,290
you need your advanced auto policy and

352
00:12:14,490 --> 00:12:17,880
so you can do once you've got that

353
00:12:16,290 --> 00:12:20,219
visibility is you can anchor it nowhere

354
00:12:17,880 --> 00:12:22,200
in spoken says if this you know backup

355
00:12:20,220 --> 00:12:25,400
is accessed earlier and then you know

356
00:12:22,200 --> 00:12:27,510
that you get to go honey shear so

357
00:12:25,400 --> 00:12:29,040
detection for that's what can we do and

358
00:12:27,510 --> 00:12:29,970
first of all we can look at it so

359
00:12:29,040 --> 00:12:32,189
there's couple different things you can

360
00:12:29,970 --> 00:12:36,540
look at some work environment somebody

361
00:12:32,190 --> 00:12:39,390
not 7:45 or services installed a event

362
00:12:36,540 --> 00:12:41,699
and also go for nine six four nine four

363
00:12:39,390 --> 00:12:43,110
six nine seven events which is basically

364
00:12:41,700 --> 00:12:44,910
the same event which is they change

365
00:12:43,110 --> 00:12:46,890
depending on the boys but fundamentally

366
00:12:44,910 --> 00:12:48,930
the same the same insane and so what

367
00:12:46,890 --> 00:12:51,150
we've got here as the boasts that it

368
00:12:48,930 --> 00:12:54,120
running on the service names which is

369
00:12:51,150 --> 00:12:55,949
covered for c2 as by default

370
00:12:54,120 --> 00:12:59,550
twenty character random string so as for

371
00:12:55,950 --> 00:13:01,980
c2 IOC MSN is like fourteen character

372
00:12:59,550 --> 00:13:02,729
one and those other seaters will get

373
00:13:01,980 --> 00:13:05,910
similar

374
00:13:02,730 --> 00:13:09,090
overseas and as we can see services are

375
00:13:05,910 --> 00:13:11,430
being installed and a nice small my up

376
00:13:09,090 --> 00:13:14,430
here only fourteen coming back so that's

377
00:13:11,430 --> 00:13:16,739
a clear indication that PS exec is well

378
00:13:14,430 --> 00:13:19,290
and your environment said with classic

379
00:13:16,740 --> 00:13:20,670
PS exact as you know right index ETSU

380
00:13:19,290 --> 00:13:22,500
and running it this is install on a

381
00:13:20,670 --> 00:13:24,270
service and run it up so it's just

382
00:13:22,500 --> 00:13:28,140
slightly different actions there but you

383
00:13:24,270 --> 00:13:31,620
can see quite a nascent and sakes but it

384
00:13:28,140 --> 00:13:34,260
can also look at as 7000 events so the

385
00:13:31,620 --> 00:13:36,180
way it is exact ones that in situ so go

386
00:13:34,260 --> 00:13:37,770
ahead machine install service run the

387
00:13:36,180 --> 00:13:39,689
service delete the service before the

388
00:13:37,770 --> 00:13:41,430
works or the target machines really even

389
00:13:39,690 --> 00:13:43,620
knows what's going on well that's going

390
00:13:41,430 --> 00:13:44,910
to do it is they cause an initiate to

391
00:13:43,620 --> 00:13:46,740
log and the service Control Manager

392
00:13:44,910 --> 00:13:49,709
which is so there's in main event and

393
00:13:46,740 --> 00:13:51,360
basically resulted in a type matter as

394
00:13:49,710 --> 00:13:53,640
you can see here we've got a nice clear

395
00:13:51,360 --> 00:13:54,330
can say small list again both that you

396
00:13:53,640 --> 00:13:55,980
looking at best

397
00:13:54,330 --> 00:13:58,470
go get the service names in there as

398
00:13:55,980 --> 00:14:00,390
well and again you can see they are

399
00:13:58,470 --> 00:14:02,730
seated I receives you can rename which

400
00:14:00,390 --> 00:14:04,560
will come in that leaders might covers

401
00:14:02,730 --> 00:14:06,420
that and but again just another key not

402
00:14:04,560 --> 00:14:07,680
quite when you can do also you can then

403
00:14:06,420 --> 00:14:09,229
go there these situations based on

404
00:14:07,680 --> 00:14:11,400
what's happening in your environment so

405
00:14:09,230 --> 00:14:13,140
that's the Windows Event say two things

406
00:14:11,400 --> 00:14:14,550
a way to detect or one way to detect

407
00:14:13,140 --> 00:14:16,140
this look it's this one as well

408
00:14:14,550 --> 00:14:18,420
obviously got that in our environment we

409
00:14:16,140 --> 00:14:21,060
can look at this one event 13 and that's

410
00:14:18,420 --> 00:14:22,860
a registry of in a being modified

411
00:14:21,060 --> 00:14:24,750
so again when the service is installing

412
00:14:22,860 --> 00:14:26,160
the system already gets a view data

413
00:14:24,750 --> 00:14:27,870
services so that's kind of what we're

414
00:14:26,160 --> 00:14:30,329
looking at typical out here so we're

415
00:14:27,870 --> 00:14:33,270
looking for of include their teams and

416
00:14:30,330 --> 00:14:34,920
the services registry section and we're

417
00:14:33,270 --> 00:14:37,500
filling out calms picnic goes back again

418
00:14:34,920 --> 00:14:39,990
is another people IOC for a lot PS exact

419
00:14:37,500 --> 00:14:41,940
mo juice what it basically does is run

420
00:14:39,990 --> 00:14:43,590
command X a and then pass arguments as

421
00:14:41,940 --> 00:14:45,930
you can see the PowerShell directs again

422
00:14:43,590 --> 00:14:47,640
they passed after running that pretty

423
00:14:45,930 --> 00:14:49,260
bad guy you see they're pretty

424
00:14:47,640 --> 00:14:51,120
straightforward to see detect obviously

425
00:14:49,260 --> 00:14:52,290
can't change that again but it's just

426
00:14:51,120 --> 00:14:54,570
something you can get a quick little

427
00:14:52,290 --> 00:14:57,540
calculate pillow and get good NSA into

428
00:14:54,570 --> 00:14:59,370
what's going on in detect on it and so

429
00:14:57,540 --> 00:15:00,780
one last thing is you start seeing these

430
00:14:59,370 --> 00:15:01,980
events flying around your network wait

431
00:15:00,780 --> 00:15:03,390
what you gonna do you can maybe trying

432
00:15:01,980 --> 00:15:04,770
we're not really going to cover threat

433
00:15:03,390 --> 00:15:06,030
under this tall we've covered abhorrent

434
00:15:04,770 --> 00:15:07,260
and the cameras talk but we're just

435
00:15:06,030 --> 00:15:08,880
gonna connect quickly look at like

436
00:15:07,260 --> 00:15:10,200
trying to understand what's going on if

437
00:15:08,880 --> 00:15:11,910
you do see this it could be good on your

438
00:15:10,200 --> 00:15:15,600
network so you can look for SMB net

439
00:15:11,910 --> 00:15:17,160
phones but across and it's good point to

440
00:15:15,600 --> 00:15:19,080
me to notice emphasizing the importance

441
00:15:17,160 --> 00:15:20,670
of having like your workstation subnet

442
00:15:19,080 --> 00:15:22,500
dopants wrong your server something it

443
00:15:20,670 --> 00:15:24,060
so that I see the difference we can use

444
00:15:22,500 --> 00:15:26,670
a look-up tables in sport is there any

445
00:15:24,060 --> 00:15:27,180
problems happening between any file any

446
00:15:26,670 --> 00:15:28,979
I

447
00:15:27,180 --> 00:15:31,140
even this lookup table to those ie

448
00:15:28,980 --> 00:15:32,340
workstation subnet I we're falling so

449
00:15:31,140 --> 00:15:35,040
then you've got you can suddenly see

450
00:15:32,340 --> 00:15:37,380
Parrish exe talking across the aisle

451
00:15:35,040 --> 00:15:39,390
almost or even to the sales rep asking

452
00:15:37,380 --> 00:15:40,950
on the Box there on hey over four or

453
00:15:39,390 --> 00:15:42,750
five again just more i overseas that you

454
00:15:40,950 --> 00:15:46,650
can look at the deco and in trying Toto

455
00:15:42,750 --> 00:15:48,120
detection as well okay cool so how do we

456
00:15:46,650 --> 00:15:49,980
start evading that you know if the

457
00:15:48,120 --> 00:15:51,870
threat intelligence says you know you

458
00:15:49,980 --> 00:15:54,450
can't use more advanced techniques we

459
00:15:51,870 --> 00:15:56,460
need you to emulate sort of activist or

460
00:15:54,450 --> 00:15:58,470
something similar um how can we carry on

461
00:15:56,460 --> 00:16:00,180
using this exact to give ourselves a bit

462
00:15:58,470 --> 00:16:01,980
more time until the analyst catch up

463
00:16:00,180 --> 00:16:04,109
with us also be not familiar the term

464
00:16:01,980 --> 00:16:07,200
IOC is indicator of compromise think of

465
00:16:04,110 --> 00:16:10,170
it as like a tell and that you socket

466
00:16:07,200 --> 00:16:12,150
over top okay so I say you don't need to

467
00:16:10,170 --> 00:16:14,910
use in posh and you don't need to use

468
00:16:12,150 --> 00:16:17,579
yes exactly you can use SMB exact call

469
00:16:14,910 --> 00:16:19,560
in the ll and XE whatever you happen to

470
00:16:17,580 --> 00:16:21,900
need you know you've been involved you

471
00:16:19,560 --> 00:16:23,160
could call like HTA's or VBS or whatever

472
00:16:21,900 --> 00:16:25,500
you need basically whatever your

473
00:16:23,160 --> 00:16:27,150
execution method is you can do that down

474
00:16:25,500 --> 00:16:28,950
like map dries and we show you how to do

475
00:16:27,150 --> 00:16:30,900
map drives in a second without exposing

476
00:16:28,950 --> 00:16:33,090
them to the user which is handy

477
00:16:30,900 --> 00:16:34,770
obviously even the dimmest user will

478
00:16:33,090 --> 00:16:36,420
wonder why he's got additional map rise

479
00:16:34,770 --> 00:16:37,110
arriving in his Windows Explorer halfway

480
00:16:36,420 --> 00:16:39,930
through his day

481
00:16:37,110 --> 00:16:41,310
you can customize you know service name

482
00:16:39,930 --> 00:16:43,079
lengths and things like that and it's

483
00:16:41,310 --> 00:16:44,760
doable with the resource can ask packet

484
00:16:43,080 --> 00:16:46,740
and all that good stuff in cs:go more

485
00:16:44,760 --> 00:16:48,450
strike not sure about in you endo

486
00:16:46,740 --> 00:16:51,120
community well then the so expensive

487
00:16:48,450 --> 00:16:52,800
it's almost boot you can being a service

488
00:16:51,120 --> 00:16:54,270
is something legit to the target this is

489
00:16:52,800 --> 00:16:56,939
something there's certainly the netted

490
00:16:54,270 --> 00:16:58,770
RT were really quite aggressive on as

491
00:16:56,940 --> 00:17:00,600
soon as we gain new accesses whether

492
00:16:58,770 --> 00:17:03,810
that's a new machine new host new server

493
00:17:00,600 --> 00:17:05,579
new user a user credentials we begin

494
00:17:03,810 --> 00:17:07,500
enumeration and situational awareness

495
00:17:05,579 --> 00:17:09,659
gathering again and then feed that back

496
00:17:07,500 --> 00:17:11,250
into the cyber kill chain although we

497
00:17:09,660 --> 00:17:12,720
all hate that term actually it does work

498
00:17:11,250 --> 00:17:17,040
and there's a reason we're still using

499
00:17:12,720 --> 00:17:19,050
it in 2019 so we should know before we

500
00:17:17,040 --> 00:17:21,899
move from workstation one to workstation

501
00:17:19,050 --> 00:17:23,730
to you know whether SMB SMB comes up

502
00:17:21,900 --> 00:17:25,200
here is in use already in that

503
00:17:23,730 --> 00:17:26,849
environments because weather look to the

504
00:17:25,200 --> 00:17:28,500
event logs would've run seatbelt and all

505
00:17:26,849 --> 00:17:30,270
active circumspect rocks and got the

506
00:17:28,500 --> 00:17:31,590
system on convicts so we should know

507
00:17:30,270 --> 00:17:33,210
that what we're about to do whether it

508
00:17:31,590 --> 00:17:35,310
will blend in or whether it won't blend

509
00:17:33,210 --> 00:17:37,040
in before we run it you know the idea of

510
00:17:35,310 --> 00:17:39,649
like yoloing different and

511
00:17:37,040 --> 00:17:41,990
removal techniques around is volatile in

512
00:17:39,650 --> 00:17:43,400
my opinion and indeed we'll try not to

513
00:17:41,990 --> 00:17:44,630
use the comms back variable there's only

514
00:17:43,400 --> 00:17:46,370
a fine line to amounts of those so you

515
00:17:44,630 --> 00:17:48,470
could actually quite easily alert on the

516
00:17:46,370 --> 00:17:51,169
comms back ones you can change that in

517
00:17:48,470 --> 00:17:52,370
posh with - comes back and and indeed if

518
00:17:51,170 --> 00:17:55,520
you want to roll something different

519
00:17:52,370 --> 00:17:57,530
just edit the Edit EAPs wall before you

520
00:17:55,520 --> 00:17:59,450
will blowed it into the implant let's

521
00:17:57,530 --> 00:18:02,060
say we touched on there a service is

522
00:17:59,450 --> 00:18:04,280
created executed and then deleted again

523
00:18:02,060 --> 00:18:07,909
quite quite noisy maybe it might

524
00:18:04,280 --> 00:18:10,129
actually just be easier to use SC C to

525
00:18:07,910 --> 00:18:11,660
actually create a legit service that

526
00:18:10,130 --> 00:18:13,880
triggers a particular time or whatever

527
00:18:11,660 --> 00:18:16,670
and then don't delete it you know you'd

528
00:18:13,880 --> 00:18:18,530
se don't actually to create a legitimate

529
00:18:16,670 --> 00:18:20,540
service in a legitimate fashion rather

530
00:18:18,530 --> 00:18:22,070
than using his exact to create run and

531
00:18:20,540 --> 00:18:23,510
delete that might actually stay lower

532
00:18:22,070 --> 00:18:25,340
even though we're then leaving another

533
00:18:23,510 --> 00:18:28,910
artifact of a service on the on the

534
00:18:25,340 --> 00:18:30,740
target host okay so how do we actually

535
00:18:28,910 --> 00:18:32,930
do that then I sense import we will

536
00:18:30,740 --> 00:18:34,430
allow use and be exact to call the DLL

537
00:18:32,930 --> 00:18:36,620
will be Bob loaded here these are just

538
00:18:34,430 --> 00:18:38,990
the default options were showing with

539
00:18:36,620 --> 00:18:41,389
noting here the central one allegedly a

540
00:18:38,990 --> 00:18:43,550
super competence EDR is running on these

541
00:18:41,390 --> 00:18:46,520
machines and so here we are just

542
00:18:43,550 --> 00:18:48,470
literally uploading a proxy payload with

543
00:18:46,520 --> 00:18:50,360
proxy creds embedded in it this is where

544
00:18:48,470 --> 00:18:52,910
the map drive is done up here you can

545
00:18:50,360 --> 00:18:54,139
see if we've left in T cold on here so

546
00:18:52,910 --> 00:18:57,020
you can see where that drive letter

547
00:18:54,140 --> 00:18:57,230
would go and if you don't put t colon in

548
00:18:57,020 --> 00:18:59,180
there

549
00:18:57,230 --> 00:19:00,950
no the drive is still mapped but it

550
00:18:59,180 --> 00:19:02,810
doesn't show up in Windows Explorer ok

551
00:19:00,950 --> 00:19:04,160
so that's pretty awesome and then that

552
00:19:02,810 --> 00:19:06,139
allows you to right there in that user

553
00:19:04,160 --> 00:19:07,940
context pretty simply we then just

554
00:19:06,140 --> 00:19:10,520
simply have it uploaded the XE we then

555
00:19:07,940 --> 00:19:12,950
call the DLL call it s2 DLL with the

556
00:19:10,520 --> 00:19:15,530
entry point or void function which is

557
00:19:12,950 --> 00:19:16,880
the posh default entry point and then

558
00:19:15,530 --> 00:19:18,590
indeed you just call it the service

559
00:19:16,880 --> 00:19:20,300
where we shown actual hours to find it

560
00:19:18,590 --> 00:19:22,370
insulin or here live here we would

561
00:19:20,300 --> 00:19:24,919
clearly opening that like citrox of data

562
00:19:22,370 --> 00:19:26,570
Palo Alto global update or whatever you

563
00:19:24,920 --> 00:19:28,430
want to call it or feel involved pulse

564
00:19:26,570 --> 00:19:31,159
VPN updater because there's all sorts of

565
00:19:28,430 --> 00:19:35,900
RC rocking and rolling for them yeah who

566
00:19:31,160 --> 00:19:37,760
knew ok we happened with PS exact sort

567
00:19:35,900 --> 00:19:39,710
of that's where the TI pitch is err sort

568
00:19:37,760 --> 00:19:41,000
of like low to mid tier that's fine if

569
00:19:39,710 --> 00:19:42,260
you know many sis up means in

570
00:19:41,000 --> 00:19:44,450
particularly in like medium sized

571
00:19:42,260 --> 00:19:46,040
organizations still using peers exactly

572
00:19:44,450 --> 00:19:46,520
because they have a really embraced PS

573
00:19:46,040 --> 00:19:48,649
remote

574
00:19:46,520 --> 00:19:51,080
or anything like that so let's look at

575
00:19:48,650 --> 00:19:52,880
women double your mind and again before

576
00:19:51,080 --> 00:19:54,770
we get into a tldr and what we mean is

577
00:19:52,880 --> 00:19:56,360
this is again the current access but

578
00:19:54,770 --> 00:19:57,650
liberal abuser on a workstation but

579
00:19:56,360 --> 00:19:58,909
again we've got the helpdesk account

580
00:19:57,650 --> 00:20:01,430
through whatever mechanism doesn't

581
00:19:58,910 --> 00:20:03,050
matter and he's effectively domain

582
00:20:01,430 --> 00:20:05,360
albumen we just don't know that yet who

583
00:20:03,050 --> 00:20:06,500
nested overly permissive nested groups

584
00:20:05,360 --> 00:20:08,870
because we've never seen that before

585
00:20:06,500 --> 00:20:11,650
either okay I'm operating to do it maybe

586
00:20:08,870 --> 00:20:13,850
to move to another box via whimmy

587
00:20:11,650 --> 00:20:15,890
let's do is just do a quick tail there

588
00:20:13,850 --> 00:20:17,389
are two sip over here just didn't do a

589
00:20:15,890 --> 00:20:20,240
quick tail they are on there but winnie

590
00:20:17,390 --> 00:20:22,910
is okay so without getting massively

591
00:20:20,240 --> 00:20:26,450
wrapped into the theory of this women

592
00:20:22,910 --> 00:20:29,690
has filters which are you know run this

593
00:20:26,450 --> 00:20:32,300
when a condition of the time equals blah

594
00:20:29,690 --> 00:20:34,010
the CPU equals blah the amount of free

595
00:20:32,300 --> 00:20:36,830
memory equals blah whatever you want

596
00:20:34,010 --> 00:20:39,470
that is a query you know so it's and it

597
00:20:36,830 --> 00:20:41,689
returns true and your query is run when

598
00:20:39,470 --> 00:20:43,640
your the things you're checking for is

599
00:20:41,690 --> 00:20:46,040
run and we've got consumers which is a

600
00:20:43,640 --> 00:20:48,020
thing that runs when your filter returns

601
00:20:46,040 --> 00:20:49,340
true I know we've got a binding that

602
00:20:48,020 --> 00:20:50,600
brings them together there we've got

603
00:20:49,340 --> 00:20:52,189
things like subscriptions a lot other

604
00:20:50,600 --> 00:20:53,389
good stuff too if you want to learn a

605
00:20:52,190 --> 00:20:55,550
little bit more about the theory

606
00:20:53,390 --> 00:20:56,420
underlying whimmy and just back out some

607
00:20:55,550 --> 00:20:58,070
NCSE certs

608
00:20:56,420 --> 00:20:59,150
or if you have don't want to spend you

609
00:20:58,070 --> 00:21:01,040
know sort of two years of your life

610
00:20:59,150 --> 00:21:03,650
doing pointless certifications you could

611
00:21:01,040 --> 00:21:05,840
read mr. Kramer's astonishing 2015 white

612
00:21:03,650 --> 00:21:08,690
paper that pretty much sort of kicked

613
00:21:05,840 --> 00:21:10,879
off the whole so more common usage of

614
00:21:08,690 --> 00:21:12,350
whimmy and that's the the initial white

615
00:21:10,880 --> 00:21:14,420
paper there where it all came from and

616
00:21:12,350 --> 00:21:16,639
then everything since then and sort of

617
00:21:14,420 --> 00:21:18,350
followed on from that and I'll get on

618
00:21:16,640 --> 00:21:21,140
Syria in the evasion section there's

619
00:21:18,350 --> 00:21:23,510
also some really solid stuff from Rubin

620
00:21:21,140 --> 00:21:26,740
fuzzy sack with Mothe files that's

621
00:21:23,510 --> 00:21:29,750
really solid stuff as well next

622
00:21:26,740 --> 00:21:31,490
excellent so we've got a shell over here

623
00:21:29,750 --> 00:21:33,410
as Jason Perry again you might recognize

624
00:21:31,490 --> 00:21:35,000
him from Steele Khan and he's pretty hot

625
00:21:33,410 --> 00:21:37,250
list he's getting or getting fished all

626
00:21:35,000 --> 00:21:39,950
the time and we're going to use women to

627
00:21:37,250 --> 00:21:42,920
again execute a particular DLL okay so

628
00:21:39,950 --> 00:21:44,750
relatively standard stuff and we can see

629
00:21:42,920 --> 00:21:46,820
down here yeah X load we now get a new

630
00:21:44,750 --> 00:21:48,830
proxy implants most of these in this

631
00:21:46,820 --> 00:21:50,570
demo all proxy implants because our test

632
00:21:48,830 --> 00:21:52,220
bed has a squid proxy in it you can't

633
00:21:50,570 --> 00:21:53,720
you know workstations and stuff can talk

634
00:21:52,220 --> 00:21:55,400
straight to the internet because that

635
00:21:53,720 --> 00:21:57,490
shouldn't be a thing and I should go

636
00:21:55,400 --> 00:21:59,919
through a proxy and you can see

637
00:21:57,490 --> 00:22:01,570
I'll get a full primary toketee as that

638
00:21:59,919 --> 00:22:03,220
D s health best user that say that

639
00:22:01,570 --> 00:22:04,960
happens to be on the DC doesn't matter

640
00:22:03,220 --> 00:22:06,130
we're just looking at what Whitney looks

641
00:22:04,960 --> 00:22:07,929
like it doesn't make any odds whether

642
00:22:06,130 --> 00:22:13,230
again workstation workstation service

643
00:22:07,929 --> 00:22:13,230
server etc any questions on that

644
00:22:13,470 --> 00:22:16,419
cool

645
00:22:14,620 --> 00:22:18,850
so hopefully access one has a bunch of

646
00:22:16,419 --> 00:22:22,240
events that are specifically related to

647
00:22:18,850 --> 00:22:24,189
web native a and so we've got a one here

648
00:22:22,240 --> 00:22:26,110
which is for event consumer detection

649
00:22:24,190 --> 00:22:28,779
and so we can pretty much leverage this

650
00:22:26,110 --> 00:22:31,090
and it's a pillow web event consumer

651
00:22:28,779 --> 00:22:32,830
happening on on our endpoints as you can

652
00:22:31,090 --> 00:22:34,899
see here will be a couple of

653
00:22:32,830 --> 00:22:37,210
suspicious-looking Parsi to consumers

654
00:22:34,899 --> 00:22:39,158
office again an invasion waiver that you

655
00:22:37,210 --> 00:22:40,630
can achieve these name client blame then

656
00:22:39,159 --> 00:22:42,159
I have another thing they're doing as

657
00:22:40,630 --> 00:22:44,620
well as getting create keeping deletes

658
00:22:42,159 --> 00:22:46,179
as well and so these are like clear is

659
00:22:44,620 --> 00:22:48,539
easy pretty much you look at straight

660
00:22:46,179 --> 00:22:51,340
off the bat is to see what's going on

661
00:22:48,539 --> 00:22:53,020
again as I mentioned understand in your

662
00:22:51,340 --> 00:22:55,000
environment it's gonna be critical to

663
00:22:53,020 --> 00:22:56,590
getting reliable detection and then say

664
00:22:55,000 --> 00:22:57,490
until hosted on in the environment after

665
00:22:56,590 --> 00:22:59,049
whammy and it's right in your

666
00:22:57,490 --> 00:23:01,390
environment get it used all time then

667
00:22:59,049 --> 00:23:03,460
that's like these might not work they

668
00:23:01,390 --> 00:23:05,679
also may work we've been doing already

669
00:23:03,460 --> 00:23:08,140
middle of related attention responses

670
00:23:05,679 --> 00:23:09,399
from the end of engagement and working

671
00:23:08,140 --> 00:23:11,590
on the client and actually currently

672
00:23:09,399 --> 00:23:14,168
they had a whole bunch of em eNOS and it

673
00:23:11,590 --> 00:23:18,158
was their IT staff using WMI to throw

674
00:23:14,169 --> 00:23:19,630
each other by using WebEx account we go

675
00:23:18,159 --> 00:23:21,789
ahead seen stuff like that popped out

676
00:23:19,630 --> 00:23:23,470
and also turn on since comes an interest

677
00:23:21,789 --> 00:23:25,080
in be briefly Sibley's but you know like

678
00:23:23,470 --> 00:23:27,100
that it's my stuff's going on

679
00:23:25,080 --> 00:23:28,870
environment you're going to have a you

680
00:23:27,100 --> 00:23:30,340
know pepper problem try build a reliable

681
00:23:28,870 --> 00:23:33,850
situations when you have a bunch of

682
00:23:30,340 --> 00:23:35,309
additional nonsense going on so again

683
00:23:33,850 --> 00:23:37,779
it's the mention says phones go ahead

684
00:23:35,309 --> 00:23:38,620
event specific portrait when we thanks

685
00:23:37,779 --> 00:23:40,539
we'll get a Bigfoot

686
00:23:38,620 --> 00:23:42,908
anything here which is for film prevent

687
00:23:40,539 --> 00:23:44,470
detection again broadly similar and save

688
00:23:42,909 --> 00:23:47,169
you're gonna get from it so anyone

689
00:23:44,470 --> 00:23:49,600
events and except extra information here

690
00:23:47,169 --> 00:23:52,179
but go the dude is still which is a way

691
00:23:49,600 --> 00:23:53,439
to assess our trace you can all live on

692
00:23:52,179 --> 00:23:55,000
that as well and again it comes back to

693
00:23:53,440 --> 00:23:59,049
you when you environment post what's

694
00:23:55,000 --> 00:24:01,600
gonna basically give you reliable FCC's

695
00:23:59,049 --> 00:24:04,690
get nowhere fatigue and so yes again you

696
00:24:01,600 --> 00:24:07,350
can see you could host user so when they

697
00:24:04,690 --> 00:24:10,630
are then and creativity positive and

698
00:24:07,350 --> 00:24:11,889
it's being run also get rich

699
00:24:10,630 --> 00:24:14,230
there you may be wondering what centers

700
00:24:11,890 --> 00:24:16,630
that is basically Wendy's replacement as

701
00:24:14,230 --> 00:24:18,670
well Blake 233 I think it was but it'll

702
00:24:16,630 --> 00:24:19,960
be really clear but no vision so just

703
00:24:18,670 --> 00:24:22,450
something to be mindful of because it

704
00:24:19,960 --> 00:24:24,610
does have different things you can call

705
00:24:22,450 --> 00:24:27,580
with seven berries where everyone lives

706
00:24:24,610 --> 00:24:29,350
anything so what happens if your system

707
00:24:27,580 --> 00:24:31,210
on events are not going to be any good

708
00:24:29,350 --> 00:24:33,490
then well you can look at when if your

709
00:24:31,210 --> 00:24:34,780
PSU which is one of the core boundaries

710
00:24:33,490 --> 00:24:36,220
that when we use these to perform

711
00:24:34,780 --> 00:24:37,810
actions on a horse what is going to do

712
00:24:36,220 --> 00:24:39,610
is going to run in it and will do things

713
00:24:37,810 --> 00:24:41,860
which is what we're getting and say into

714
00:24:39,610 --> 00:24:45,010
here we can see that when we go here's

715
00:24:41,860 --> 00:24:46,330
some lower shield badness and we can

716
00:24:45,010 --> 00:24:47,500
also see the command line arguments

717
00:24:46,330 --> 00:24:48,730
going along with that so if you could

718
00:24:47,500 --> 00:24:51,250
you know when they spawn and parachute

719
00:24:48,730 --> 00:24:53,800
on involving one-liners I even do

720
00:24:51,250 --> 00:24:55,630
another maybe less obvious things Wendy

721
00:24:53,800 --> 00:24:57,610
well whatever you can start with on this

722
00:24:55,630 --> 00:24:58,840
and again comes back to as this noble

723
00:24:57,610 --> 00:25:01,870
career environment if you use web me a

724
00:24:58,840 --> 00:25:03,129
lot at administration and maybe the arc

725
00:25:01,870 --> 00:25:05,080
Explorer if you don't use with me at all

726
00:25:03,130 --> 00:25:06,490
and you know this would be good to go

727
00:25:05,080 --> 00:25:09,189
and I think you look as well as

728
00:25:06,490 --> 00:25:11,350
telemetry detection so if you do use

729
00:25:09,190 --> 00:25:12,730
weather maybe you only use it to go and

730
00:25:11,350 --> 00:25:14,260
run a batch much less reps and say

731
00:25:12,730 --> 00:25:15,880
midnight between midnight and 1:00

732
00:25:14,260 --> 00:25:17,650
you can have a speculoos events but

733
00:25:15,880 --> 00:25:19,360
maybe between 9:00 and 5:00 normally

734
00:25:17,650 --> 00:25:20,800
he's going on you can use the amateur

735
00:25:19,360 --> 00:25:22,750
detection if you start seeing when the

736
00:25:20,800 --> 00:25:24,760
events firing off you know between 95 in

737
00:25:22,750 --> 00:25:26,890
sex work you can start to look at what

738
00:25:24,760 --> 00:25:30,730
was going on we should be happening so

739
00:25:26,890 --> 00:25:34,060
you can end up on that one last thing

740
00:25:30,730 --> 00:25:36,010
you do is 468 which is process creating

741
00:25:34,060 --> 00:25:39,100
as well so again looking at when a PR

742
00:25:36,010 --> 00:25:40,600
BAC creating processes so if the other

743
00:25:39,100 --> 00:25:42,370
ones still work for you maybe that's too

744
00:25:40,600 --> 00:25:44,139
hard for you and we're looking at you

745
00:25:42,370 --> 00:25:46,600
know we're just gonna add a bit more of

746
00:25:44,140 --> 00:25:48,220
a genetic pretty here and we're back

747
00:25:46,600 --> 00:25:49,870
we've seen as parallax he's getting

748
00:25:48,220 --> 00:25:52,540
spawned also you can again use a lester

749
00:25:49,870 --> 00:25:55,570
files like of new and bad files and this

750
00:25:52,540 --> 00:25:57,760
one however sales and the exe wherever

751
00:25:55,570 --> 00:25:59,260
as you can just have that aware on those

752
00:25:57,760 --> 00:26:03,100
files in and it's doing other things

753
00:25:59,260 --> 00:26:04,870
that you know she environment ignore

754
00:26:03,100 --> 00:26:06,879
those one thing to note again Matt will

755
00:26:04,870 --> 00:26:08,979
talk about this later on in the occasion

756
00:26:06,880 --> 00:26:13,230
is decibels is dead yet so you know

757
00:26:08,980 --> 00:26:15,700
maybe situational awareness

758
00:26:13,230 --> 00:26:17,140
okay excellent so you seen on the left

759
00:26:15,700 --> 00:26:18,430
hand side and a previous screen shot and

760
00:26:17,140 --> 00:26:21,160
there's lots of mentions of their

761
00:26:18,430 --> 00:26:22,780
service that's in a wben folder has

762
00:26:21,160 --> 00:26:23,220
Windows based enterprise management they

763
00:26:22,780 --> 00:26:25,980
came from

764
00:26:23,220 --> 00:26:27,990
when in Microsoft land and DISA most we

765
00:26:25,980 --> 00:26:29,100
said is to do with images so for any

766
00:26:27,990 --> 00:26:30,780
Microsoft admins here you're probably

767
00:26:29,100 --> 00:26:32,370
familiar with them like sysprep than the

768
00:26:30,780 --> 00:26:33,720
old days now used ism to manage the

769
00:26:32,370 --> 00:26:36,299
images that use a Windows deployment

770
00:26:33,720 --> 00:26:38,340
services and such so how do we start

771
00:26:36,299 --> 00:26:39,720
evading okay if the TI says wanted to

772
00:26:38,340 --> 00:26:41,789
ramp it up a little bit okay how do we

773
00:26:39,720 --> 00:26:43,049
do that so we can actually do viola

774
00:26:41,789 --> 00:26:44,730
swimming which is pretty good so

775
00:26:43,049 --> 00:26:47,190
previously we've had to drop stuff onto

776
00:26:44,730 --> 00:26:49,530
the target and then execute okay so we

777
00:26:47,190 --> 00:26:52,140
are in a pet leaving artifacts allowing

778
00:26:49,530 --> 00:26:53,700
the stock to maybe tie hosts together

779
00:26:52,140 --> 00:26:55,140
and you can see where we've been or

780
00:26:53,700 --> 00:26:57,450
where we're planning on going based off

781
00:26:55,140 --> 00:26:58,320
houses but also we then have to clean

782
00:26:57,450 --> 00:27:01,020
that up at the end of the engagement

783
00:26:58,320 --> 00:27:03,389
which is a difficult good reminder have

784
00:27:01,020 --> 00:27:04,740
access to that host anymore or B we have

785
00:27:03,390 --> 00:27:06,900
to like lift a load of hashes in the

786
00:27:04,740 --> 00:27:08,850
report and people know what's that so

787
00:27:06,900 --> 00:27:11,520
the exceptionally talented James for

788
00:27:08,850 --> 00:27:14,250
Shaw and discovered met two GIS and then

789
00:27:11,520 --> 00:27:15,929
published tool for that so that's his

790
00:27:14,250 --> 00:27:18,390
Twitter up there supremely clever bloke

791
00:27:15,929 --> 00:27:20,070
and then we also have you Jer shelf and

792
00:27:18,390 --> 00:27:22,409
Chris Roth Susannah Soria on Twitter

793
00:27:20,070 --> 00:27:24,360
again very clever guy we can tie those

794
00:27:22,409 --> 00:27:26,909
two things together and we can now use

795
00:27:24,360 --> 00:27:28,590
file the swimming again worth noting

796
00:27:26,909 --> 00:27:30,299
that because we're going to know what's

797
00:27:28,590 --> 00:27:31,740
blending in because we've done our

798
00:27:30,299 --> 00:27:33,299
situational awareness because we are a

799
00:27:31,740 --> 00:27:34,740
professional Red Team organization

800
00:27:33,299 --> 00:27:36,690
rather than just firing things around

801
00:27:34,740 --> 00:27:38,490
randomly we know what's going to blend

802
00:27:36,690 --> 00:27:41,010
in so we know what the Winnie's

803
00:27:38,490 --> 00:27:42,900
subscriptions that already exist are so

804
00:27:41,010 --> 00:27:44,158
will now try and we control the naming

805
00:27:42,900 --> 00:27:47,429
of these whether their subscriptions

806
00:27:44,159 --> 00:27:49,440
filters or triggers and we can try and

807
00:27:47,429 --> 00:27:52,169
customize the ones that we put onto the

808
00:27:49,440 --> 00:27:53,909
target to blend in a million here and as

809
00:27:52,169 --> 00:27:56,070
your hopefully seeing that all lateral

810
00:27:53,909 --> 00:27:59,010
movement is detectable it just depends

811
00:27:56,070 --> 00:28:00,600
on how much storage you've got how good

812
00:27:59,010 --> 00:28:02,879
your level one analysts are and can you

813
00:28:00,600 --> 00:28:04,559
find the needle in the field full of

814
00:28:02,880 --> 00:28:06,419
haystacks and until you even know what

815
00:28:04,559 --> 00:28:07,649
haystack to look at it's very easy to

816
00:28:06,419 --> 00:28:09,750
find sort of when you know where you're

817
00:28:07,650 --> 00:28:11,220
meant to be looking you come back to me

818
00:28:09,750 --> 00:28:12,900
you and you've got like 30,000 endpoints

819
00:28:11,220 --> 00:28:14,460
in a hundred countries and then it

820
00:28:12,900 --> 00:28:15,650
starts to like a ramp up the complexity

821
00:28:14,460 --> 00:28:18,450
to non-trivial

822
00:28:15,650 --> 00:28:20,220
so we've also got like women implant

823
00:28:18,450 --> 00:28:22,440
from Chris hunter which I think uses the

824
00:28:20,220 --> 00:28:23,669
OS debug registry key Mussoorie he's

825
00:28:22,440 --> 00:28:25,260
actually quite like almost like a full

826
00:28:23,669 --> 00:28:28,500
implant you can upload and download

827
00:28:25,260 --> 00:28:30,390
files execute commands and stuff using

828
00:28:28,500 --> 00:28:31,980
whimmy implant it's not C 2 compatible

829
00:28:30,390 --> 00:28:33,570
at the minute - that's my knowledge we

830
00:28:31,980 --> 00:28:35,720
did know about like a cursory go at

831
00:28:33,570 --> 00:28:37,610
getting it in what if

832
00:28:35,720 --> 00:28:40,730
didn't see his intrusion operations

833
00:28:37,610 --> 00:28:42,620
course or he's also gave a workshop on

834
00:28:40,730 --> 00:28:44,570
offensive with me at steal calm and the

835
00:28:42,620 --> 00:28:46,189
slides are up on 14 of security calm

836
00:28:44,570 --> 00:28:48,350
he's a good guy knows pretty much

837
00:28:46,190 --> 00:28:50,510
everything about women and that's have

838
00:28:48,350 --> 00:28:51,949
you said earlier on we also got sim

839
00:28:50,510 --> 00:28:52,879
methods and I think generally this is

840
00:28:51,950 --> 00:28:54,650
super anyone's looking for like a

841
00:28:52,880 --> 00:28:56,270
master's thesis there's probably some

842
00:28:54,650 --> 00:28:57,860
sort of really good stuff to be loved on

843
00:28:56,270 --> 00:28:59,450
when you look into sim methods because

844
00:28:57,860 --> 00:29:02,270
it is quite a distinct architectural

845
00:28:59,450 --> 00:29:04,610
change from Winnie so not it's more than

846
00:29:02,270 --> 00:29:06,200
just web 2.0 there's very likely to be

847
00:29:04,610 --> 00:29:08,780
some good other good lateral movement

848
00:29:06,200 --> 00:29:10,390
techniques in there pendants got fifty

849
00:29:08,780 --> 00:29:12,980
fifty research time a big pretty awesome

850
00:29:10,390 --> 00:29:14,330
we can also use women to spawn something

851
00:29:12,980 --> 00:29:16,970
else okay so we're going to talk about

852
00:29:14,330 --> 00:29:19,399
diversification very briefly we talked

853
00:29:16,970 --> 00:29:21,260
on diversification quite extensively at

854
00:29:19,400 --> 00:29:23,090
stake on if we're going to use a

855
00:29:21,260 --> 00:29:24,770
technique that may get us caught why do

856
00:29:23,090 --> 00:29:26,840
we try and diversify as much as possible

857
00:29:24,770 --> 00:29:29,120
by us you are ELLs execution methods

858
00:29:26,840 --> 00:29:31,610
entry points user account user accounts

859
00:29:29,120 --> 00:29:33,260
or proxy codes we could maybe use P bind

860
00:29:31,610 --> 00:29:36,830
and will come into our people MIT is in

861
00:29:33,260 --> 00:29:38,960
a second so what we can do here is use

862
00:29:36,830 --> 00:29:40,970
file lists movie and so we're going to

863
00:29:38,960 --> 00:29:43,610
use again this is built into poverty

864
00:29:40,970 --> 00:29:45,830
tube by default again eminently

865
00:29:43,610 --> 00:29:47,120
achievable with her COBOL stripe or

866
00:29:45,830 --> 00:29:49,280
whatever particular frameworks you're

867
00:29:47,120 --> 00:29:51,110
familiar with and if you've still got

868
00:29:49,280 --> 00:29:53,299
Empire although empires allegedly dead

869
00:29:51,110 --> 00:29:55,158
you know you can use it there so here

870
00:29:53,299 --> 00:29:57,379
we're going to use women proxy payload

871
00:29:55,159 --> 00:29:58,789
plus the credentials and here we can see

872
00:29:57,380 --> 00:30:00,590
we're consumer name have made it nice

873
00:29:58,789 --> 00:30:02,658
and simple to hunt for pop see to

874
00:30:00,590 --> 00:30:04,220
consumer quantity to filter and the

875
00:30:02,659 --> 00:30:06,020
process name upon which to trigger

876
00:30:04,220 --> 00:30:07,400
there's spce host okay so without

877
00:30:06,020 --> 00:30:11,629
getting too much into Windows internals

878
00:30:07,400 --> 00:30:15,830
SPC host is always there so we can see

879
00:30:11,630 --> 00:30:19,250
here that we use will be js2 executors

880
00:30:15,830 --> 00:30:21,918
and we use this particular dot next to

881
00:30:19,250 --> 00:30:24,409
Jay s base64 string here we have got a

882
00:30:21,919 --> 00:30:26,240
plan to allow an additional option over

883
00:30:24,409 --> 00:30:28,700
here to pass different types of payloads

884
00:30:26,240 --> 00:30:30,830
in but at the minute if you want to pass

885
00:30:28,700 --> 00:30:33,409
things that are to propwash c2 implant

886
00:30:30,830 --> 00:30:36,860
in just base64 whatever you want to

887
00:30:33,409 --> 00:30:39,020
execute DLL whatever it is and basically

888
00:30:36,860 --> 00:30:40,729
for it and call it this and then this

889
00:30:39,020 --> 00:30:42,770
mechanism here will run

890
00:30:40,730 --> 00:30:45,110
ever for the command or other implants

891
00:30:42,770 --> 00:30:46,370
or other shell or other situ framework

892
00:30:45,110 --> 00:30:48,918
you wants that own concession pass

893
00:30:46,370 --> 00:30:51,139
between c2 if you want more importantly

894
00:30:48,919 --> 00:30:54,169
here we can see that this is the query

895
00:30:51,140 --> 00:30:54,590
that will cause the consumer that we've

896
00:30:54,169 --> 00:30:56,720
written

897
00:30:54,590 --> 00:30:58,668
okay so select star from win32 process

898
00:30:56,720 --> 00:31:02,630
start race where process name equals

899
00:30:58,669 --> 00:31:03,380
svchost.exe C host is running run the

900
00:31:02,630 --> 00:31:06,140
thing I want

901
00:31:03,380 --> 00:31:08,750
SVC host is always running so game on

902
00:31:06,140 --> 00:31:11,870
and we can see in this case our net 2jf

903
00:31:08,750 --> 00:31:16,610
space 64 payload now runs that's why all

904
00:31:11,870 --> 00:31:19,790
this awesome so let's have a little

905
00:31:16,610 --> 00:31:21,168
quick TLDR on P bind and don't want to

906
00:31:19,790 --> 00:31:23,210
get too much into it cuz it's kind of

907
00:31:21,169 --> 00:31:24,590
like an hour talk by itself it's made by

908
00:31:23,210 --> 00:31:26,720
a super clever guy works for us called

909
00:31:24,590 --> 00:31:29,299
Doug McLeod it's aimed to get where

910
00:31:26,720 --> 00:31:31,070
server land is extremely well segmented

911
00:31:29,299 --> 00:31:34,129
and you can't get reliable two-way comms

912
00:31:31,070 --> 00:31:35,659
in you can only get push comes on four

913
00:31:34,130 --> 00:31:38,600
four five which is kind of how it should

914
00:31:35,660 --> 00:31:41,000
be everywhere and in server land anyway

915
00:31:38,600 --> 00:31:42,860
and so will it's designed for that and

916
00:31:41,000 --> 00:31:44,510
it's erm it's like a sub implant that

917
00:31:42,860 --> 00:31:47,240
you can put into your c2 framework and

918
00:31:44,510 --> 00:31:51,830
is c2 agnostic so you can put it into CS

919
00:31:47,240 --> 00:31:53,960
innuendo wherever you need yes okay so

920
00:31:51,830 --> 00:31:56,510
at this point we've we've already back

921
00:31:53,960 --> 00:31:57,919
doored uses Romeo profile which is

922
00:31:56,510 --> 00:31:59,059
possibly quite achievable because

923
00:31:57,919 --> 00:32:00,919
they'll be stored on a file share

924
00:31:59,059 --> 00:32:02,540
somewhere and but then we wouldn't be

925
00:32:00,919 --> 00:32:05,150
able to reach into the server where the

926
00:32:02,540 --> 00:32:06,678
citrix box or the VDI session or the

927
00:32:05,150 --> 00:32:08,660
Terminal Services session is because

928
00:32:06,679 --> 00:32:10,940
that's appropriately segregated when we

929
00:32:08,660 --> 00:32:11,419
compile P bind on our windows attacking

930
00:32:10,940 --> 00:32:14,059
machine

931
00:32:11,419 --> 00:32:15,980
this key is automatically generated and

932
00:32:14,059 --> 00:32:18,200
then we can upload that into the users

933
00:32:15,980 --> 00:32:20,000
profile then go home for the day and Joe

934
00:32:18,200 --> 00:32:22,280
Bloggs comes in the next day and his

935
00:32:20,000 --> 00:32:24,290
room and profile logs on again because

936
00:32:22,280 --> 00:32:25,790
we know what these variables are we can

937
00:32:24,290 --> 00:32:28,070
then just can master them as a connect

938
00:32:25,790 --> 00:32:32,270
and it will automatically connect as we

939
00:32:28,070 --> 00:32:34,909
can see there we can now run commands in

940
00:32:32,270 --> 00:32:36,918
the context of the user which we just

941
00:32:34,910 --> 00:32:38,720
connected to and which is quite a big

942
00:32:36,919 --> 00:32:40,460
power up really because before we had no

943
00:32:38,720 --> 00:32:42,440
way of executing commands on that server

944
00:32:40,460 --> 00:32:45,020
whatsoever now we can axiu commands on

945
00:32:42,440 --> 00:32:46,549
that server as a valid user and we can

946
00:32:45,020 --> 00:32:48,320
see here we just get there pretty bumpy

947
00:32:46,549 --> 00:32:49,879
bind commands the host name and we can

948
00:32:48,320 --> 00:32:50,480
be by a commander Who am I which is

949
00:32:49,880 --> 00:32:52,340
quite good

950
00:32:50,480 --> 00:32:52,880
also what's pretty awesome is we can

951
00:32:52,340 --> 00:32:54,980
then run

952
00:32:52,880 --> 00:32:57,710
use P bind in the context of the remote

953
00:32:54,980 --> 00:32:59,420
user to run other dll's that we can

954
00:32:57,710 --> 00:33:01,490
upload rupee bind the next slice with

955
00:32:59,420 --> 00:33:03,290
the reader there and you can upload that

956
00:33:01,490 --> 00:33:05,870
they ll onto the target file system and

957
00:33:03,290 --> 00:33:07,790
then run it okay in this case here we've

958
00:33:05,870 --> 00:33:09,290
hard-coded the proc secrets in so this

959
00:33:07,790 --> 00:33:11,180
server is able to get to the internet

960
00:33:09,290 --> 00:33:13,550
but if they've got appropriate layer

961
00:33:11,180 --> 00:33:15,560
three controls because Lane seven

962
00:33:13,550 --> 00:33:17,090
controls is not enough if you've got

963
00:33:15,560 --> 00:33:19,580
then three controls to prevent servers

964
00:33:17,090 --> 00:33:23,720
talking to the internet you can use

965
00:33:19,580 --> 00:33:25,970
implant 41 here as a daisy so implant 43

966
00:33:23,720 --> 00:33:28,610
will talk back to implant 41 and then

967
00:33:25,970 --> 00:33:30,890
implant 41 talks out to the c2 proxy and

968
00:33:28,610 --> 00:33:32,360
then back out to the c2 server by

969
00:33:30,890 --> 00:33:34,280
whatever domain fronts and stuff are

970
00:33:32,360 --> 00:33:35,209
going on okay as a top tip if you have

971
00:33:34,280 --> 00:33:37,010
to seek your service talking to the

972
00:33:35,210 --> 00:33:38,840
internet it's not a good thing so that's

973
00:33:37,010 --> 00:33:41,960
why certainly on the operator side of

974
00:33:38,840 --> 00:33:44,090
life will use a workstation as an own

975
00:33:41,960 --> 00:33:45,950
good workstation to handle all the Daisy

976
00:33:44,090 --> 00:33:48,260
coms you're not familiar with how to do

977
00:33:45,950 --> 00:33:49,580
daisy chaining in posh Rob here is the

978
00:33:48,260 --> 00:33:51,890
middle of rewriting the documentation so

979
00:33:49,580 --> 00:33:53,240
he'll definitely know that them and also

980
00:33:51,890 --> 00:33:54,860
generally it's pretty simple if you've

981
00:33:53,240 --> 00:33:59,000
got the latest Potter public and the

982
00:33:54,860 --> 00:34:01,250
syntax is a thousand percent better okay

983
00:33:59,000 --> 00:34:03,890
so let's have a look at with me again so

984
00:34:01,250 --> 00:34:05,390
the to call P bind again just here

985
00:34:03,890 --> 00:34:07,040
because we we could get command

986
00:34:05,390 --> 00:34:09,020
execution in the context of all in the

987
00:34:07,040 --> 00:34:10,610
previous video or how do we started and

988
00:34:09,020 --> 00:34:12,350
enumerated us server and things like

989
00:34:10,610 --> 00:34:14,660
that so here is a proof of concept will

990
00:34:12,350 --> 00:34:16,880
just use powerup this is bundled into P

991
00:34:14,659 --> 00:34:19,549
by and already but if you want to squirt

992
00:34:16,880 --> 00:34:20,690
other system management automation dll's

993
00:34:19,550 --> 00:34:22,340
into your behind

994
00:34:20,690 --> 00:34:24,409
just open up in nanopore them if you

995
00:34:22,340 --> 00:34:26,570
feel involved and then you can you can

996
00:34:24,409 --> 00:34:28,909
pay sixty for whatever payload you'd

997
00:34:26,570 --> 00:34:30,830
like into P bind then pipe it into the

998
00:34:28,909 --> 00:34:31,790
implants you can then just call it with

999
00:34:30,830 --> 00:34:34,549
P bind

1000
00:34:31,790 --> 00:34:35,779
squirt the module name and then all of

1001
00:34:34,550 --> 00:34:37,310
the functions that would be available

1002
00:34:35,780 --> 00:34:39,350
within that partial implants are

1003
00:34:37,310 --> 00:34:40,880
available from P bind command we can see

1004
00:34:39,350 --> 00:34:43,339
there just as a proof of concept in

1005
00:34:40,880 --> 00:34:45,440
bhopal checks and you can see the power

1006
00:34:43,340 --> 00:34:48,230
up runs down the pea vine or four or

1007
00:34:45,440 --> 00:34:50,480
five using push comes only a leg three

1008
00:34:48,230 --> 00:34:52,730
point of view named pipe forwards and

1009
00:34:50,480 --> 00:34:55,130
backwards as a byte stream from outside

1010
00:34:52,730 --> 00:34:57,650
we're three point of view why that's

1011
00:34:55,130 --> 00:34:59,930
also pretty awesome is you could also

1012
00:34:57,650 --> 00:35:01,670
quite easily base64 stuff like mini cats

1013
00:34:59,930 --> 00:35:03,319
and all that good stuff and then use P

1014
00:35:01,670 --> 00:35:04,160
vine to call mimic a spreads are memory

1015
00:35:03,320 --> 00:35:05,960
hashes out memory

1016
00:35:04,160 --> 00:35:08,569
you might think that Oh PowerShell base

1017
00:35:05,960 --> 00:35:10,849
maybe Katz is dead it's like well no but

1018
00:35:08,569 --> 00:35:12,558
then also by the time we're using P bind

1019
00:35:10,849 --> 00:35:15,619
is probably against some really super

1020
00:35:12,559 --> 00:35:17,119
important production servers most large

1021
00:35:15,619 --> 00:35:19,009
organizations by the time they're

1022
00:35:17,119 --> 00:35:20,900
involved in C best few best and T best

1023
00:35:19,009 --> 00:35:23,029
Red Team your frameworks and they'll

1024
00:35:20,900 --> 00:35:24,349
have probably pretty monstrous technical

1025
00:35:23,029 --> 00:35:27,349
debt that they're afraid of changing

1026
00:35:24,349 --> 00:35:29,210
things and their systems will say must

1027
00:35:27,349 --> 00:35:31,220
be run on physical 10 must run on beams

1028
00:35:29,210 --> 00:35:33,440
must not have EDR antivirus is running

1029
00:35:31,220 --> 00:35:37,129
on it as well you know like for example

1030
00:35:33,440 --> 00:35:39,529
staff and EDR well best of luck and you

1031
00:35:37,130 --> 00:35:42,140
know so we can actually abuse that quite

1032
00:35:39,529 --> 00:35:44,269
heavily by making use of highly highly

1033
00:35:42,140 --> 00:35:46,190
secure at layer 3 but actually quite

1034
00:35:44,269 --> 00:35:48,319
poorly secured of the operating system

1035
00:35:46,190 --> 00:35:50,150
layer and things because there's no AV

1036
00:35:48,319 --> 00:35:52,339
or the AV is trivial maybe they were a

1037
00:35:50,150 --> 00:35:54,019
McAfee like old school and things like

1038
00:35:52,339 --> 00:35:55,489
that which won't provide any detection

1039
00:35:54,019 --> 00:35:56,930
whatsoever against their baby cats in

1040
00:35:55,489 --> 00:35:59,599
memory using system management

1041
00:35:56,930 --> 00:36:08,058
automation dot DLL which is what posh is

1042
00:35:59,599 --> 00:36:09,229
running ok so let's have a tea or they

1043
00:36:08,059 --> 00:36:12,229
are on decomp

1044
00:36:09,229 --> 00:36:13,759
so that's distributed common components

1045
00:36:12,229 --> 00:36:15,200
sorry I continually call the common and

1046
00:36:13,759 --> 00:36:18,140
it's absolutely not Corral's not called

1047
00:36:15,200 --> 00:36:19,910
that his component object model I could

1048
00:36:18,140 --> 00:36:21,650
give you a tldr on that but I'd quite

1049
00:36:19,910 --> 00:36:23,598
harshly recommend you get yourself a 60

1050
00:36:21,650 --> 00:36:26,660
minute to tell the are from James for

1051
00:36:23,599 --> 00:36:28,900
sure again he did talk called common 60

1052
00:36:26,660 --> 00:36:32,629
seconds which is like the authoritative

1053
00:36:28,900 --> 00:36:35,390
how come works 101 is genuinely stunning

1054
00:36:32,630 --> 00:36:37,190
you can see my were two protos arrow but

1055
00:36:35,390 --> 00:36:39,379
it is this a set of methods that

1056
00:36:37,190 --> 00:36:40,700
Microsoft products have that can expose

1057
00:36:39,380 --> 00:36:43,279
remote methods that can be called

1058
00:36:40,700 --> 00:36:45,379
through RPC music provided you've got

1059
00:36:43,279 --> 00:36:48,079
valid credentials once those methods are

1060
00:36:45,380 --> 00:36:49,880
them you can created a connection to

1061
00:36:48,079 --> 00:36:52,099
their valid CSL ID we'll go through that

1062
00:36:49,880 --> 00:36:54,079
a second lots of different methods are

1063
00:36:52,099 --> 00:36:56,420
exposed some of which are like open new

1064
00:36:54,079 --> 00:36:57,979
tab close tab all sorts of various ones

1065
00:36:56,420 --> 00:36:59,269
but some of them are like shell execute

1066
00:36:57,979 --> 00:37:01,069
and stuff like that which will give you

1067
00:36:59,269 --> 00:37:05,598
command execution in the context of the

1068
00:37:01,069 --> 00:37:07,640
current logged on user ok here we can

1069
00:37:05,599 --> 00:37:10,160
see up here we've got a cell as low

1070
00:37:07,640 --> 00:37:12,200
Priya dead and the shell as hi Priya

1071
00:37:10,160 --> 00:37:15,649
been you know it's hi Priya because Ben

1072
00:37:12,200 --> 00:37:16,558
has a star and this is built into posh

1073
00:37:15,650 --> 00:37:18,839
again this is

1074
00:37:16,559 --> 00:37:20,939
just an indication of how a lower skill

1075
00:37:18,839 --> 00:37:22,078
attacker would do it mrs. bake bake do

1076
00:37:20,939 --> 00:37:24,598
what you can guys can obviously

1077
00:37:22,079 --> 00:37:25,949
customize it in folk decomp proxy

1078
00:37:24,599 --> 00:37:27,359
payload and it's important to know that

1079
00:37:25,949 --> 00:37:29,069
you need to have a valid primary user

1080
00:37:27,359 --> 00:37:32,069
token to make use of this hence why we

1081
00:37:29,069 --> 00:37:33,869
need to have a shell as bad and you

1082
00:37:32,069 --> 00:37:37,019
can't do you can't pass credentials to

1083
00:37:33,869 --> 00:37:38,519
the Deb and plans of them work and

1084
00:37:37,019 --> 00:37:41,069
you'll scroll up here we've seen as a

1085
00:37:38,519 --> 00:37:43,348
default and a decon method here is MMC

1086
00:37:41,069 --> 00:37:44,519
20 which is Microsoft management console

1087
00:37:43,349 --> 00:37:46,380
the things you know in Active Directory

1088
00:37:44,519 --> 00:37:47,459
you manage Active Directory with like

1089
00:37:46,380 --> 00:37:50,549
Active Directory users and computers

1090
00:37:47,459 --> 00:37:52,859
that's running inside MMC biopsy and

1091
00:37:50,549 --> 00:37:55,049
that has comm methods that are able to

1092
00:37:52,859 --> 00:37:55,859
be instantiated remotely as we can see

1093
00:37:55,049 --> 00:37:58,410
here

1094
00:37:55,859 --> 00:37:59,999
MMC 20 application and then we can see

1095
00:37:58,410 --> 00:38:01,680
there there's a shell execute command

1096
00:37:59,999 --> 00:38:03,779
and that's the command that we run so

1097
00:38:01,680 --> 00:38:05,519
actually we just bootstrap to see a yes

1098
00:38:03,779 --> 00:38:06,930
one-liner but again that could have been

1099
00:38:05,519 --> 00:38:10,109
anything we needed it could be anything

1100
00:38:06,930 --> 00:38:12,029
you want it to be so that's the power of

1101
00:38:10,109 --> 00:38:13,859
that really from a deception point of

1102
00:38:12,029 --> 00:38:16,019
view quite loud though most mature

1103
00:38:13,859 --> 00:38:17,969
organizations hopefully by now attaching

1104
00:38:16,019 --> 00:38:19,649
that from a process tree in a process

1105
00:38:17,969 --> 00:38:22,229
parent point of view because what that

1106
00:38:19,650 --> 00:38:26,609
looks like on the defender side is SVC

1107
00:38:22,229 --> 00:38:30,089
host of mmm CXC pretty super weird

1108
00:38:26,609 --> 00:38:32,189
should never happen nor in all daily

1109
00:38:30,089 --> 00:38:34,709
operations what you tend to see is

1110
00:38:32,189 --> 00:38:38,729
explorador XE spawning a child process

1111
00:38:34,709 --> 00:38:40,259
of MMC dog scene as you can see nothing

1112
00:38:38,729 --> 00:38:43,739
comes back as as the user that's

1113
00:38:40,259 --> 00:38:43,920
currently locked on okay so let's do

1114
00:38:43,739 --> 00:38:45,839
that

1115
00:38:43,920 --> 00:38:47,459
manually really so we're not calling a

1116
00:38:45,839 --> 00:38:48,869
PowerShell one-liner this is how we do

1117
00:38:47,459 --> 00:38:50,189
it manually all this is available on the

1118
00:38:48,869 --> 00:38:51,809
internet and on our github

1119
00:38:50,189 --> 00:38:54,089
once I get reliable internet in this

1120
00:38:51,809 --> 00:38:56,219
building so you declare this as one

1121
00:38:54,089 --> 00:38:58,670
lining or in four separate lines my

1122
00:38:56,219 --> 00:39:01,920
simple really was spread through here

1123
00:38:58,670 --> 00:39:02,249
this is how you connect to the MMC CSL

1124
00:39:01,920 --> 00:39:04,859
ID

1125
00:39:02,249 --> 00:39:09,529
think of it as like a good and then

1126
00:39:04,859 --> 00:39:13,348
that's the command you want to run and

1127
00:39:09,529 --> 00:39:15,749
then that will then run over here we'll

1128
00:39:13,349 --> 00:39:16,709
get a new shell in a second an important

1129
00:39:15,749 --> 00:39:17,879
you'll note an important difference

1130
00:39:16,709 --> 00:39:19,678
between at the shelter we had in the

1131
00:39:17,880 --> 00:39:22,739
previous video and the shell that comes

1132
00:39:19,679 --> 00:39:24,779
in Nets so we've got a new shell here

1133
00:39:22,739 --> 00:39:26,369
but actually you'll note that then has a

1134
00:39:24,779 --> 00:39:27,869
hash sign class nothing to do with mush

1135
00:39:26,369 --> 00:39:29,590
see - that's his Sam account named

1136
00:39:27,869 --> 00:39:31,120
directory that's

1137
00:39:29,590 --> 00:39:32,740
because Ben is actually been half

1138
00:39:31,120 --> 00:39:34,540
sighing exactly enterprise administrator

1139
00:39:32,740 --> 00:39:36,490
and he is currently logged on to the

1140
00:39:34,540 --> 00:39:38,410
exchange box okay so that's pretty

1141
00:39:36,490 --> 00:39:41,439
awesome from our side because we used

1142
00:39:38,410 --> 00:39:43,060
comm with highly privileged creds but

1143
00:39:41,440 --> 00:39:44,680
actually the command is executed in the

1144
00:39:43,060 --> 00:39:46,660
context of the currently logged on user

1145
00:39:44,680 --> 00:39:49,419
which is pretty rockin and you gain a

1146
00:39:46,660 --> 00:39:51,879
primary token as him and also you then

1147
00:39:49,420 --> 00:39:55,630
go out through the proxy as him to see

1148
00:39:51,880 --> 00:39:57,190
again pretty good it's a separate

1149
00:39:55,630 --> 00:39:58,420
discussion of whether and surprise admin

1150
00:39:57,190 --> 00:40:10,240
should be allowed through the proxy of

1151
00:39:58,420 --> 00:40:12,640
course but in this case horse things as

1152
00:40:10,240 --> 00:40:14,500
MC being spawned by sec oh so that's

1153
00:40:12,640 --> 00:40:17,759
exactly what we're gonna look for here

1154
00:40:14,500 --> 00:40:20,410
and we're gonna look for that happen

1155
00:40:17,760 --> 00:40:23,590
small amount of events going on here

1156
00:40:20,410 --> 00:40:26,620
with a parent image as SVC host and it's

1157
00:40:23,590 --> 00:40:29,710
born in MMC exit another thing to know

1158
00:40:26,620 --> 00:40:30,660
here is the D combos are given an SVC

1159
00:40:29,710 --> 00:40:34,060
host

1160
00:40:30,660 --> 00:40:35,620
IMC 50 calm again actually understand

1161
00:40:34,060 --> 00:40:36,880
your environment HD come home of you

1162
00:40:35,620 --> 00:40:37,390
environment for is it normal for the

1163
00:40:36,880 --> 00:40:39,670
environment

1164
00:40:37,390 --> 00:40:42,339
SJ will consider the more sales a way to

1165
00:40:39,670 --> 00:40:46,450
move around however we have important

1166
00:40:42,340 --> 00:40:48,000
before by using be calm environment case

1167
00:40:46,450 --> 00:40:50,500
or some so again situation awareness

1168
00:40:48,000 --> 00:40:52,270
like blended with your environment don't

1169
00:40:50,500 --> 00:40:55,930
judge things going to be smart and

1170
00:40:52,270 --> 00:40:58,630
actually export yourself and so first

1171
00:40:55,930 --> 00:41:00,279
action and second reaction is looking

1172
00:40:58,630 --> 00:41:02,860
for the become launched as I mentioned

1173
00:41:00,280 --> 00:41:08,500
so as you can see here oh go ahead

1174
00:41:02,860 --> 00:41:10,870
please do L and what is good

1175
00:41:08,500 --> 00:41:13,420
so it's executing commands and you can

1176
00:41:10,870 --> 00:41:16,000
see the COS IDs and there as well so you

1177
00:41:13,420 --> 00:41:18,640
can fly on the COS IDs but they all get

1178
00:41:16,000 --> 00:41:21,370
which so again could be noisy I'm just

1179
00:41:18,640 --> 00:41:24,700
again environment most was going to be

1180
00:41:21,370 --> 00:41:26,710
normal for and so we can be born we can

1181
00:41:24,700 --> 00:41:29,069
use for scene in that event whether I

1182
00:41:26,710 --> 00:41:32,560
would already approach or detection and

1183
00:41:29,070 --> 00:41:33,850
go to the show create stuff and since I

1184
00:41:32,560 --> 00:41:36,850
wouldn't want your fate available you

1185
00:41:33,850 --> 00:41:38,740
shall create an urge to see here go you

1186
00:41:36,850 --> 00:41:40,960
know seven events coming up here the

1187
00:41:38,740 --> 00:41:43,149
reduce things post the watch

1188
00:41:40,960 --> 00:41:45,580
[Music]

1189
00:41:43,150 --> 00:41:47,020
really worth quite a tease a lot of

1190
00:41:45,580 --> 00:41:48,819
these detection Zarkana broadly similar

1191
00:41:47,020 --> 00:41:50,230
become because there is only so many

1192
00:41:48,820 --> 00:41:51,910
ways you can saturate things and do

1193
00:41:50,230 --> 00:41:53,310
things again it just depends on what's

1194
00:41:51,910 --> 00:41:58,779
going to work for your environment and

1195
00:41:53,310 --> 00:42:00,970
so again you can see become one trend

1196
00:41:58,780 --> 00:42:05,350
here as well and all the good stuff

1197
00:42:00,970 --> 00:42:07,089
that's been appointed potential IOC okay

1198
00:42:05,350 --> 00:42:08,819
awesome so if you want a bit more theory

1199
00:42:07,090 --> 00:42:11,980
and grounding on what like decom is

1200
00:42:08,820 --> 00:42:14,710
nelson enigma 0-3 accents to apply that

1201
00:42:11,980 --> 00:42:15,610
on there he came up with the idea really

1202
00:42:14,710 --> 00:42:17,410
to my knowledge

1203
00:42:15,610 --> 00:42:19,060
he's got some pretty solid walkthroughs

1204
00:42:17,410 --> 00:42:22,120
on there there's probably a really good

1205
00:42:19,060 --> 00:42:23,920
research time usage in to finding more

1206
00:42:22,120 --> 00:42:25,420
of these methods that we can instantiate

1207
00:42:23,920 --> 00:42:27,370
because lots of people are starting to

1208
00:42:25,420 --> 00:42:30,820
get detection z' for those poor those

1209
00:42:27,370 --> 00:42:32,560
here CLS ids couid be instantiated and

1210
00:42:30,820 --> 00:42:34,090
there's only a finite list most like

1211
00:42:32,560 --> 00:42:36,970
there's only a finite list of logins if

1212
00:42:34,090 --> 00:42:38,710
you still party in my case 2017 here so

1213
00:42:36,970 --> 00:42:41,649
there's only a finite list of low bins

1214
00:42:38,710 --> 00:42:43,450
that are effective so how do we if they

1215
00:42:41,650 --> 00:42:44,530
eat well then we don't use MMC 20

1216
00:42:43,450 --> 00:42:48,669
because

1217
00:42:44,530 --> 00:42:51,280
again SVC host MMC twitter mmm 0 XE

1218
00:42:48,670 --> 00:42:53,920
abnormal and so much of the detection

1219
00:42:51,280 --> 00:42:55,750
here are around presence of the abnormal

1220
00:42:53,920 --> 00:42:57,160
absence of the normal you don't know

1221
00:42:55,750 --> 00:42:58,330
what your network should look like then

1222
00:42:57,160 --> 00:43:00,580
how you gonna find it when it doesn't

1223
00:42:58,330 --> 00:43:02,650
look right so we can use different

1224
00:43:00,580 --> 00:43:06,040
methods and outlook has got some really

1225
00:43:02,650 --> 00:43:08,200
good ones Visio excel and word gentleman

1226
00:43:06,040 --> 00:43:11,050
from outflank has got notice that you

1227
00:43:08,200 --> 00:43:13,870
can use Excel M which is I think of it

1228
00:43:11,050 --> 00:43:16,270
as super old-school VBA that's not

1229
00:43:13,870 --> 00:43:19,540
technically correct but are conceptually

1230
00:43:16,270 --> 00:43:22,870
correct and that will allow you to to

1231
00:43:19,540 --> 00:43:24,730
run scripts over decomp he's got a proof

1232
00:43:22,870 --> 00:43:26,259
of concept called Excel for decomp which

1233
00:43:24,730 --> 00:43:29,050
it's got a curve ball strike script and

1234
00:43:26,260 --> 00:43:30,400
I was interested it's super slow but

1235
00:43:29,050 --> 00:43:31,630
then that's easily tweakable if you look

1236
00:43:30,400 --> 00:43:33,460
at the source and he even tells you how

1237
00:43:31,630 --> 00:43:35,290
to do it on github that's really good

1238
00:43:33,460 --> 00:43:36,850
but does require 32-bit powershell

1239
00:43:35,290 --> 00:43:39,100
process that you're sending it from and

1240
00:43:36,850 --> 00:43:41,799
also you need to be nice to be 32-bit

1241
00:43:39,100 --> 00:43:43,870
outlook on the target and 32-bit Soria

1242
00:43:41,800 --> 00:43:45,760
office on the target which is still the

1243
00:43:43,870 --> 00:43:47,650
majority because a 64-bit office is

1244
00:43:45,760 --> 00:43:48,880
earlier 365 has only been the default

1245
00:43:47,650 --> 00:43:51,100
for like three or four months now

1246
00:43:48,880 --> 00:43:53,200
they're so like 90% of the planet is

1247
00:43:51,100 --> 00:43:54,270
still running 32-bit office despite

1248
00:43:53,200 --> 00:43:57,540
having this add 60

1249
00:43:54,270 --> 00:43:59,070
Computers about ten yet they're on where

1250
00:43:57,540 --> 00:44:01,350
is it it's in the pipeline to get this

1251
00:43:59,070 --> 00:44:03,960
integrated into pasti - it's just issues

1252
00:44:01,350 --> 00:44:06,480
with size of shellcode so the staged

1253
00:44:03,960 --> 00:44:08,400
payload from cobol strike is about 800

1254
00:44:06,480 --> 00:44:12,060
bytes or so when I tried to get this

1255
00:44:08,400 --> 00:44:14,580
going for Pasha's 103 kilobytes so quite

1256
00:44:12,060 --> 00:44:16,500
quite a size difference left took like

1257
00:44:14,580 --> 00:44:18,870
three or four hours staging or byte at a

1258
00:44:16,500 --> 00:44:20,730
time over decom but no dice I thought I

1259
00:44:18,870 --> 00:44:22,589
called it quits at 3 hours

1260
00:44:20,730 --> 00:44:24,900
kind of thought my shell wasn't coming

1261
00:44:22,590 --> 00:44:26,970
in by that point so what we can do

1262
00:44:24,900 --> 00:44:29,220
though let's say we are using shallots

1263
00:44:26,970 --> 00:44:30,870
to your shell windows or Excel for decon

1264
00:44:29,220 --> 00:44:32,970
or more out working things like let's

1265
00:44:30,870 --> 00:44:35,750
say we are using that how do we ramp it

1266
00:44:32,970 --> 00:44:37,560
the complexity up again more importantly

1267
00:44:35,750 --> 00:44:39,870
remember we're going to call something

1268
00:44:37,560 --> 00:44:41,420
and it isn't going to be powers on so if

1269
00:44:39,870 --> 00:44:43,830
we're going custom because we should be

1270
00:44:41,420 --> 00:44:45,060
you know we're customizing our payloads

1271
00:44:43,830 --> 00:44:47,490
and things like that before we put them

1272
00:44:45,060 --> 00:44:49,860
on the target and whether it's an ACCI a

1273
00:44:47,490 --> 00:44:51,419
dll or whatever shell code mechanism

1274
00:44:49,860 --> 00:44:54,750
why don't we configure it to auto

1275
00:44:51,420 --> 00:44:56,880
migrate into a known good process using

1276
00:44:54,750 --> 00:45:00,090
correct migration processes you know

1277
00:44:56,880 --> 00:45:01,710
don't be using the signature ones from Z

1278
00:45:00,090 --> 00:45:03,510
you know like rewrite create remove

1279
00:45:01,710 --> 00:45:06,120
thread and things like that over playing

1280
00:45:03,510 --> 00:45:08,400
with fire maybe do some suspended RTL

1281
00:45:06,120 --> 00:45:10,410
create user thread stuff and we can also

1282
00:45:08,400 --> 00:45:12,720
spoof the parent process to try and

1283
00:45:10,410 --> 00:45:15,450
defeat a layer one and layer one unless

1284
00:45:12,720 --> 00:45:17,430
who notices that random processes have

1285
00:45:15,450 --> 00:45:20,310
child processes that don't look legit

1286
00:45:17,430 --> 00:45:22,740
and indeed we can use either features

1287
00:45:20,310 --> 00:45:25,080
over inbound wash or the ones they're

1288
00:45:22,740 --> 00:45:26,490
built into her well strike the argue

1289
00:45:25,080 --> 00:45:28,140
syntax and because I have to spoof

1290
00:45:26,490 --> 00:45:30,390
command-line arguments and there's a

1291
00:45:28,140 --> 00:45:33,240
really good talk from a guy called will

1292
00:45:30,390 --> 00:45:35,520
Burgess at MWR think you gave it a twirl

1293
00:45:33,240 --> 00:45:37,290
where's hacking fest last year about how

1294
00:45:35,520 --> 00:45:38,940
red teaming needs to mature and get

1295
00:45:37,290 --> 00:45:40,980
better at the in-memory evasion and

1296
00:45:38,940 --> 00:45:43,860
staying you know dropping beneath the

1297
00:45:40,980 --> 00:45:45,300
radar when ER comes knocking they've got

1298
00:45:43,860 --> 00:45:46,650
a proof of concept called gargoyle or

1299
00:45:45,300 --> 00:45:49,410
something similar and that's quite

1300
00:45:46,650 --> 00:45:51,450
clever stuff and indeed if we know what

1301
00:45:49,410 --> 00:45:52,799
the system on config is because we're

1302
00:45:51,450 --> 00:45:55,319
going to do situation where as when we

1303
00:45:52,800 --> 00:45:57,450
land on that end point we'll also know

1304
00:45:55,320 --> 00:45:59,400
exactly what processes this one's going

1305
00:45:57,450 --> 00:46:01,080
to alert on exactly how it's going to

1306
00:45:59,400 --> 00:46:03,050
alert on those and then we can spend the

1307
00:46:01,080 --> 00:46:05,279
time guaranteeing that we're going to

1308
00:46:03,050 --> 00:46:06,770
fit in or we could use a system on

1309
00:46:05,280 --> 00:46:07,880
whitelisted binary for example

1310
00:46:06,770 --> 00:46:09,950
one that doesn't attract as much

1311
00:46:07,880 --> 00:46:12,920
attention from sis mom you know and

1312
00:46:09,950 --> 00:46:14,450
whether that's Disney host or you know

1313
00:46:12,920 --> 00:46:15,860
some sort of relate to Windows updating

1314
00:46:14,450 --> 00:46:17,839
and things like try and blend in

1315
00:46:15,860 --> 00:46:20,690
particular if it's a well-known one that

1316
00:46:17,840 --> 00:46:24,260
the level one analyst thinks is going to

1317
00:46:20,690 --> 00:46:25,910
be legit so let's do a quick demo of

1318
00:46:24,260 --> 00:46:28,340
that then on the Left we just got the

1319
00:46:25,910 --> 00:46:32,390
output of whom I slash Paul we're gonna

1320
00:46:28,340 --> 00:46:34,490
remotely instantiate using shell execute

1321
00:46:32,390 --> 00:46:36,140
we're gonna use global protect plugin to

1322
00:46:34,490 --> 00:46:37,939
XE which is like a live actor we compile

1323
00:46:36,140 --> 00:46:39,980
back in the office so what does that

1324
00:46:37,940 --> 00:46:41,960
look like from the user side nothing is

1325
00:46:39,980 --> 00:46:44,180
the answer totally transparent you'll

1326
00:46:41,960 --> 00:46:46,250
notice we've got the no shell the reason

1327
00:46:44,180 --> 00:46:47,870
we've got no shell currently is because

1328
00:46:46,250 --> 00:46:49,370
in left in the exit we would have some

1329
00:46:47,870 --> 00:46:51,290
message boxes so we could explain to you

1330
00:46:49,370 --> 00:46:53,630
what's going on so we can see here

1331
00:46:51,290 --> 00:46:55,580
appeared of for three full full and

1332
00:46:53,630 --> 00:46:58,700
we're in the current user context of

1333
00:46:55,580 --> 00:47:00,560
Chaeronea just the user we're in trying

1334
00:46:58,700 --> 00:47:03,680
to laterally move to we're also in a

1335
00:47:00,560 --> 00:47:04,880
32-bit arch so that now you'll note the

1336
00:47:03,680 --> 00:47:06,740
shell has come in so you know been

1337
00:47:04,880 --> 00:47:09,740
through the execution process you can

1338
00:47:06,740 --> 00:47:12,229
see now we do actually have a 32-bit

1339
00:47:09,740 --> 00:47:13,759
shell as Corin and it's c-sharp or other

1340
00:47:12,230 --> 00:47:15,860
windows powershell we've talked about

1341
00:47:13,760 --> 00:47:17,120
how powershell is dead allegedly and we

1342
00:47:15,860 --> 00:47:18,800
talked about that steel comment Ben

1343
00:47:17,120 --> 00:47:20,839
Turner and Doug and Rob mustn't talk

1344
00:47:18,800 --> 00:47:22,190
about it empty size London but more

1345
00:47:20,840 --> 00:47:25,520
importantly we can see our current bid

1346
00:47:22,190 --> 00:47:28,220
is 4 3 3 4 and our current bid here is 4

1347
00:47:25,520 --> 00:47:30,950
3 3 4 which is crew it's got a pair of

1348
00:47:28,220 --> 00:47:31,490
process the 5 a 2-0 which is chrome

1349
00:47:30,950 --> 00:47:33,770
itself

1350
00:47:31,490 --> 00:47:36,529
so we've spoofed our parent process and

1351
00:47:33,770 --> 00:47:38,120
we've we're now like in a in a process

1352
00:47:36,530 --> 00:47:39,440
that looks legitimate to be making

1353
00:47:38,120 --> 00:47:40,910
network connections from a system on

1354
00:47:39,440 --> 00:47:42,800
side of life you know Google Chrome

1355
00:47:40,910 --> 00:47:45,170
making network connections it's kind of

1356
00:47:42,800 --> 00:47:47,600
expected functionality easy to blend in

1357
00:47:45,170 --> 00:47:49,850
and again if we needed to we can build

1358
00:47:47,600 --> 00:47:52,640
in some additional stuff whether we want

1359
00:47:49,850 --> 00:47:53,690
to use Outlook to spoof into so need to

1360
00:47:52,640 --> 00:47:55,520
make sure you get your architecture is

1361
00:47:53,690 --> 00:47:57,680
correct or whether you want to use any

1362
00:47:55,520 --> 00:47:59,030
other process you know making network

1363
00:47:57,680 --> 00:48:01,640
connections probably not a good choice

1364
00:47:59,030 --> 00:48:03,350
but you know stuff like Chrome Outlook

1365
00:48:01,640 --> 00:48:05,359
maybe not word and things like you can

1366
00:48:03,350 --> 00:48:06,920
you can spoof your parent process to try

1367
00:48:05,360 --> 00:48:10,430
and break the process tree tracking from

1368
00:48:06,920 --> 00:48:11,780
the layer level one of us so that's what

1369
00:48:10,430 --> 00:48:13,759
that looks like and then that gains you

1370
00:48:11,780 --> 00:48:15,320
a she D sharp shell and we're trying to

1371
00:48:13,760 --> 00:48:16,490
ramp up the complexity so we're not

1372
00:48:15,320 --> 00:48:17,990
touching system management automation

1373
00:48:16,490 --> 00:48:19,790
Tila

1374
00:48:17,990 --> 00:48:23,080
and then that sir we're game on from

1375
00:48:19,790 --> 00:48:23,080
their who successfully actually moved

1376
00:48:23,320 --> 00:48:28,460
okay so come towards the end now key

1377
00:48:26,900 --> 00:48:33,590
takeaways if you're struggling to

1378
00:48:28,460 --> 00:48:36,260
prioritize if you are not rolling like a

1379
00:48:33,590 --> 00:48:38,570
defense in depth strategy it's a matter

1380
00:48:36,260 --> 00:48:41,660
of when not if the inevitable happens

1381
00:48:38,570 --> 00:48:44,210
you know Active Directory is kind of the

1382
00:48:41,660 --> 00:48:47,450
attack surface and the workstations are

1383
00:48:44,210 --> 00:48:49,280
the way in now and we see workstation to

1384
00:48:47,450 --> 00:48:52,368
workstation communications like we do it

1385
00:48:49,280 --> 00:48:54,470
quite frequently from the blue side if

1386
00:48:52,369 --> 00:48:56,869
you you should have obviously like a CSB

1387
00:48:54,470 --> 00:48:59,240
of your workstation subnets and the CSV

1388
00:48:56,869 --> 00:49:01,369
of your service of Nets pop them into

1389
00:48:59,240 --> 00:49:03,439
Splunk as lookups and say if you ever

1390
00:49:01,369 --> 00:49:05,360
see workstations of net talking to

1391
00:49:03,440 --> 00:49:07,040
workstation subnet that's obviously not

1392
00:49:05,360 --> 00:49:09,050
a good sign very rare that should happen

1393
00:49:07,040 --> 00:49:10,040
particularly like workstation stuff net

1394
00:49:09,050 --> 00:49:12,170
in London talking to a workstation

1395
00:49:10,040 --> 00:49:13,430
subnet in Singapore you know you should

1396
00:49:12,170 --> 00:49:16,880
very rare that that's the thing

1397
00:49:13,430 --> 00:49:18,859
hopefully you know so private VLANs

1398
00:49:16,880 --> 00:49:20,480
totally gather that's quiet minister to

1399
00:49:18,860 --> 00:49:22,850
be difficult used to be a system in

1400
00:49:20,480 --> 00:49:24,800
implementing the private VLANs are scale

1401
00:49:22,850 --> 00:49:27,470
in a proper grown-up organization of

1402
00:49:24,800 --> 00:49:28,670
like 300,000 employees not a small task

1403
00:49:27,470 --> 00:49:30,140
you know everyone's getting loads of

1404
00:49:28,670 --> 00:49:32,150
overtime now that however

1405
00:49:30,140 --> 00:49:35,240
on whose firewalling is less at less

1406
00:49:32,150 --> 00:49:36,859
hard so loads of people who reach I'm

1407
00:49:35,240 --> 00:49:37,970
debrief and say hey let's do one hoot

1408
00:49:36,859 --> 00:49:39,920
firewalling they say it's impossible

1409
00:49:37,970 --> 00:49:41,540
doesn't fit the business it's a massive

1410
00:49:39,920 --> 00:49:43,160
overhead and then they forget this or

1411
00:49:41,540 --> 00:49:45,290
eighty-five to ninety percent of their

1412
00:49:43,160 --> 00:49:46,609
employees aren't actually anything

1413
00:49:45,290 --> 00:49:48,230
special whatsoever and they live in

1414
00:49:46,609 --> 00:49:50,240
Microsoft Word Microsoft Excel Microsoft

1415
00:49:48,230 --> 00:49:51,080
PowerPoint and Microsoft Outlook doing

1416
00:49:50,240 --> 00:49:54,229
nothing special

1417
00:49:51,080 --> 00:49:55,730
my aim is just any other employee so run

1418
00:49:54,230 --> 00:49:56,810
me through the thinking where on whose

1419
00:49:55,730 --> 00:49:58,880
firewalling doesn't work for them

1420
00:49:56,810 --> 00:50:00,830
absolutely does work you're just not

1421
00:49:58,880 --> 00:50:01,960
willing to put the time in the least bit

1422
00:50:00,830 --> 00:50:05,210
man enough to admit it

1423
00:50:01,960 --> 00:50:06,890
where's the other 20% of your employees

1424
00:50:05,210 --> 00:50:09,800
maybe they'd be exempt from the window

1425
00:50:06,890 --> 00:50:13,430
filing policy or you have a more more

1426
00:50:09,800 --> 00:50:15,020
granular one so I think personal thing

1427
00:50:13,430 --> 00:50:18,279
is like service minimization and on

1428
00:50:15,020 --> 00:50:20,769
whose firewalling massive massive wins

1429
00:50:18,279 --> 00:50:22,329
and again layer three segregation really

1430
00:50:20,769 --> 00:50:24,249
helps i get that by the time you're

1431
00:50:22,329 --> 00:50:26,079
going in through like you're mature

1432
00:50:24,249 --> 00:50:28,089
enough to be doing red teaming properly

1433
00:50:26,079 --> 00:50:31,059
you might have rather large technical

1434
00:50:28,089 --> 00:50:32,499
destitute early gather but when you're

1435
00:50:31,059 --> 00:50:34,180
opening new offices and building new

1436
00:50:32,499 --> 00:50:36,189
infrastructure you know you can set

1437
00:50:34,180 --> 00:50:37,479
segregation up there correctly you know

1438
00:50:36,190 --> 00:50:39,700
so going forward you're in a better

1439
00:50:37,479 --> 00:50:41,410
place and then have a rolling program to

1440
00:50:39,700 --> 00:50:44,919
fix the lack of segregation that you've

1441
00:50:41,410 --> 00:50:46,690
got on your old stuff and as I say we

1442
00:50:44,920 --> 00:50:49,930
again we say this in quite frequently

1443
00:50:46,690 --> 00:50:51,549
red teaming comes quite late in the in

1444
00:50:49,930 --> 00:50:53,649
the pyramid of assurance services

1445
00:50:51,549 --> 00:50:55,749
you know several rounds of pentest to

1446
00:50:53,650 --> 00:50:58,329
remove low-hanging fruits and several

1447
00:50:55,749 --> 00:51:00,519
rounds of ad audits like a comprehensive

1448
00:50:58,329 --> 00:51:02,380
ad units that cover the entire forests

1449
00:51:00,519 --> 00:51:03,669
not just a tiny little subdomain we

1450
00:51:02,380 --> 00:51:05,589
don't need to get into the matrice now

1451
00:51:03,670 --> 00:51:06,609
but testing things in isolation whilst

1452
00:51:05,589 --> 00:51:08,859
they're part of like a wider

1453
00:51:06,609 --> 00:51:11,680
infrastructure there's nothing good is

1454
00:51:08,859 --> 00:51:13,210
at the end of that road and again know

1455
00:51:11,680 --> 00:51:15,460
what normal looks like in your

1456
00:51:13,210 --> 00:51:17,559
environment whether it's Willie years

1457
00:51:15,460 --> 00:51:19,299
exact or decomp and obviously there's

1458
00:51:17,559 --> 00:51:20,140
other ways as well you need to know what

1459
00:51:19,299 --> 00:51:21,940
normal is

1460
00:51:20,140 --> 00:51:23,499
you don't know what normal is then how

1461
00:51:21,940 --> 00:51:24,999
can you monitor for presence of the

1462
00:51:23,499 --> 00:51:26,950
abnormal because you're you're literally

1463
00:51:24,999 --> 00:51:28,569
the black in a dark room with your hands

1464
00:51:26,950 --> 00:51:30,399
out in front of you've got no nothing to

1465
00:51:28,569 --> 00:51:34,989
base information and information to let

1466
00:51:30,400 --> 00:51:36,880
decisions on EDR again it belongs on

1467
00:51:34,989 --> 00:51:39,609
everything really and the cost

1468
00:51:36,880 --> 00:51:42,640
I appreciate the cost they're still

1469
00:51:39,609 --> 00:51:44,469
cheaper than get note and a big one for

1470
00:51:42,640 --> 00:51:46,089
me as well as an on the slides is for

1471
00:51:44,469 --> 00:51:49,269
for quite a few years now our red team

1472
00:51:46,089 --> 00:51:50,229
is have kind of like run right and then

1473
00:51:49,269 --> 00:51:51,848
the blue team has just been on the

1474
00:51:50,229 --> 00:51:53,229
receiving end of it well actually now

1475
00:51:51,849 --> 00:51:54,700
the pendulum is assigned to swing ever

1476
00:51:53,229 --> 00:51:55,779
so slightly back towards the blue side

1477
00:51:54,700 --> 00:51:57,519
yeah

1478
00:51:55,779 --> 00:51:59,319
um z script lot logging and all that

1479
00:51:57,519 --> 00:52:02,558
good stuff okay so we move to c-sharp

1480
00:51:59,319 --> 00:52:03,849
but then MZ is coming for dotnet and no

1481
00:52:02,559 --> 00:52:06,069
it's here already or certainly in beta

1482
00:52:03,849 --> 00:52:07,809
or public preview grants it'll be a bit

1483
00:52:06,069 --> 00:52:09,249
of a like most people deploy it but you

1484
00:52:07,809 --> 00:52:12,219
know it inevitably that will come again

1485
00:52:09,249 --> 00:52:14,049
a red team will need to adapt but you've

1486
00:52:12,219 --> 00:52:16,089
got deception technologies now you're

1487
00:52:14,049 --> 00:52:17,890
not making use of deception with on the

1488
00:52:16,089 --> 00:52:18,578
blue team you're doing yourselves a

1489
00:52:17,890 --> 00:52:21,279
disservice

1490
00:52:18,579 --> 00:52:23,529
whether it's elusive or honey tokens

1491
00:52:21,279 --> 00:52:25,450
honey spins you check I'll get over how

1492
00:52:23,529 --> 00:52:26,769
to do it you know you are you're losing

1493
00:52:25,450 --> 00:52:28,049
a chance to catch the lower tier

1494
00:52:26,769 --> 00:52:30,060
attacker

1495
00:52:28,050 --> 00:52:31,680
you need to make use of the fact that

1496
00:52:30,060 --> 00:52:32,850
you know your networks you know your

1497
00:52:31,680 --> 00:52:34,710
battle rhythm of your network what

1498
00:52:32,850 --> 00:52:36,390
happens week in week out better than

1499
00:52:34,710 --> 00:52:38,580
anybody when we arrived we know nothing

1500
00:52:36,390 --> 00:52:40,529
about your environment together you know

1501
00:52:38,580 --> 00:52:43,259
and then the situational begins you know

1502
00:52:40,530 --> 00:52:45,120
where your critical assets are you know

1503
00:52:43,260 --> 00:52:47,190
where the attackers will need to go from

1504
00:52:45,120 --> 00:52:49,290
the layer 3 points of view to get there

1505
00:52:47,190 --> 00:52:49,680
so plant some minefields for is on the

1506
00:52:49,290 --> 00:52:51,480
way

1507
00:52:49,680 --> 00:52:53,250
makers work harder so we can test you

1508
00:52:51,480 --> 00:52:55,860
better on the blue side because you know

1509
00:52:53,250 --> 00:52:58,050
the whole point of red TV is to validate

1510
00:52:55,860 --> 00:53:00,270
and improve the detection of response

1511
00:52:58,050 --> 00:53:02,190
capability of the blue team our entire

1512
00:53:00,270 --> 00:53:04,230
red team industry exists

1513
00:53:02,190 --> 00:53:06,690
to make the blue team better that's the

1514
00:53:04,230 --> 00:53:08,910
whole point and a big personal thing if

1515
00:53:06,690 --> 00:53:10,620
don't be the armadillo which is really

1516
00:53:08,910 --> 00:53:12,810
really rock hard on the outside but once

1517
00:53:10,620 --> 00:53:16,020
you get in is all super squishy and

1518
00:53:12,810 --> 00:53:19,049
super soft and super vulnerable yeah

1519
00:53:16,020 --> 00:53:20,759
just another thing on the early the EDR

1520
00:53:19,050 --> 00:53:22,020
say two things like visibility is just a

1521
00:53:20,760 --> 00:53:23,730
first step in protecting your

1522
00:53:22,020 --> 00:53:25,290
environment because of all you've gots

1523
00:53:23,730 --> 00:53:26,730
visibility all you're gonna do is watch

1524
00:53:25,290 --> 00:53:28,140
shows run right your network you

1525
00:53:26,730 --> 00:53:31,470
actually need to be like detect

1526
00:53:28,140 --> 00:53:33,210
erratically and detect contain eradicate

1527
00:53:31,470 --> 00:53:34,439
in the media you can't do that then you

1528
00:53:33,210 --> 00:53:36,810
are look sleep is gonna watch shows go

1529
00:53:34,440 --> 00:53:38,400
wails and so it's just like plugging in

1530
00:53:36,810 --> 00:53:40,710
a DDR isn't gonna save you you're gonna

1531
00:53:38,400 --> 00:53:42,480
need to then build on top of that EDR so

1532
00:53:40,710 --> 00:53:44,250
the bolts are alright but you know you

1533
00:53:42,480 --> 00:53:45,720
can RTFM on them find there's a blind

1534
00:53:44,250 --> 00:53:47,310
spot so you're gonna want people that

1535
00:53:45,720 --> 00:53:49,020
are confident and it's technologies

1536
00:53:47,310 --> 00:53:50,850
you're deploying so you can build a

1537
00:53:49,020 --> 00:53:52,830
custom cordon fix custom watch list for

1538
00:53:50,850 --> 00:53:55,500
black for example and then you're gonna

1539
00:53:52,830 --> 00:53:58,170
need your density contemplate boots good

1540
00:53:55,500 --> 00:54:00,090
forensics capabilities and you know

1541
00:53:58,170 --> 00:54:01,470
basically apply and when stuff goes

1542
00:54:00,090 --> 00:54:04,200
wrong because if you don't do that but

1543
00:54:01,470 --> 00:54:06,240
say you can smell it again just on

1544
00:54:04,200 --> 00:54:07,080
having the plan obviously by the time

1545
00:54:06,240 --> 00:54:08,700
you're doing red teaming you've

1546
00:54:07,080 --> 00:54:10,710
hopefully got like blue team play books

1547
00:54:08,700 --> 00:54:12,779
you know when we see malicious activity

1548
00:54:10,710 --> 00:54:15,360
who are we going to wring you know we

1549
00:54:12,780 --> 00:54:17,490
got call off contracts with their by IR

1550
00:54:15,360 --> 00:54:19,110
teams and stuff like that it's super

1551
00:54:17,490 --> 00:54:21,540
awesome when you keep the play books for

1552
00:54:19,110 --> 00:54:23,340
that on the file share like absolutely

1553
00:54:21,540 --> 00:54:25,470
thanks very much if this is a reason we

1554
00:54:23,340 --> 00:54:26,940
invented like secure password bolts we

1555
00:54:25,470 --> 00:54:28,680
can store documents in them too

1556
00:54:26,940 --> 00:54:30,120
maybe like our mission critical here but

1557
00:54:28,680 --> 00:54:32,049
we've seen play books it makes me like

1558
00:54:30,120 --> 00:54:33,848
some apps they all so impactful

1559
00:54:32,049 --> 00:54:35,349
brief so like oh and then you rang so

1560
00:54:33,849 --> 00:54:36,489
and so how do you know that it's like

1561
00:54:35,349 --> 00:54:38,439
well we were reading your email at the

1562
00:54:36,489 --> 00:54:40,660
same time and we've also used a soft

1563
00:54:38,439 --> 00:54:41,109
phone to do it and we saw you on your

1564
00:54:40,660 --> 00:54:43,420
screen

1565
00:54:41,109 --> 00:54:44,589
dialing your IR provider makes because

1566
00:54:43,420 --> 00:54:46,029
we knew you were going to do that

1567
00:54:44,589 --> 00:54:47,558
because we were also on your box looking

1568
00:54:46,029 --> 00:54:48,939
at the incident response plan so it

1569
00:54:47,559 --> 00:54:51,130
makes for some like pretty impactful

1570
00:54:48,939 --> 00:54:52,739
debriefs what regards do the basics in

1571
00:54:51,130 --> 00:55:03,130
doing well

1572
00:54:52,739 --> 00:55:04,569
one of the dependencies for decom okay

1573
00:55:03,130 --> 00:55:06,910
so just to make connect great thanks to

1574
00:55:04,569 --> 00:55:09,069
everyone on this list for either of you

1575
00:55:06,910 --> 00:55:11,319
know you know research with you that we

1576
00:55:09,069 --> 00:55:13,689
can all conserve energy and use or for

1577
00:55:11,319 --> 00:55:15,308
helping over to talk nature given to the

1578
00:55:13,689 --> 00:55:18,779
lab and stuff that we can repeal dollar

1579
00:55:15,309 --> 00:55:22,150
although tools they didn't have fun and

1580
00:55:18,779 --> 00:55:23,619
I'll say thanks to you for a reason to

1581
00:55:22,150 --> 00:55:26,619
coming lessons healers ramble on for an

1582
00:55:23,619 --> 00:55:27,880
hour and so cliche that I touched it

1583
00:55:26,619 --> 00:55:30,029
duck from that too as well forgetting

1584
00:55:27,880 --> 00:55:33,869
the migration stopped work thank you

1585
00:55:30,029 --> 00:55:33,869
that's us thanks

1586
00:55:39,319 --> 00:55:47,550
we've got a few minutes for questions if

1587
00:55:42,060 --> 00:55:49,520
anyone's got one sticky hand up no okay

1588
00:55:47,550 --> 00:55:53,280
oh here we go

1589
00:55:49,520 --> 00:55:55,710
your tracks stops your problem eating at

1590
00:55:53,280 --> 00:55:58,349
it work ever seen anybody actually

1591
00:55:55,710 --> 00:56:01,349
deploying lockdown whitelisting with

1592
00:55:58,349 --> 00:56:05,010
russia cost of the MLS or what was the

1593
00:56:01,349 --> 00:56:05,970
number one block well is he massive

1594
00:56:05,010 --> 00:56:10,650
again

1595
00:56:05,970 --> 00:56:12,899
how did stare but refuses or moon

1596
00:56:10,650 --> 00:56:15,869
impactful risk users they're probably

1597
00:56:12,900 --> 00:56:18,089
just go along so you could widest them

1598
00:56:15,869 --> 00:56:21,890
and then we ignore super spangled users

1599
00:56:18,089 --> 00:56:21,890
whether they're developing CNC like

1600
00:56:24,109 --> 00:56:29,520
maybe they have a slightly more weapons

1601
00:56:27,240 --> 00:56:31,560
free so by the singleton class we going

1602
00:56:29,520 --> 00:56:33,540
to businesses the answer if it doesn't

1603
00:56:31,560 --> 00:56:35,790
fit a visitor you're just implicitly

1604
00:56:33,540 --> 00:56:38,430
saying I am not willing to invest in I'm

1605
00:56:35,790 --> 00:56:40,500
clean and that is a good at least no big

1606
00:56:38,430 --> 00:56:43,700
Buffalo is a big nice incentive visited

1607
00:56:40,500 --> 00:56:46,710
a nightstand just all fifty blind like

1608
00:56:43,700 --> 00:56:49,319
to them whether it's a job off the

1609
00:56:46,710 --> 00:56:52,410
recruiters office matter puppets doing

1610
00:56:49,319 --> 00:56:55,440
also might not love it it's not super

1611
00:56:52,410 --> 00:56:57,598
special is very breathable and also add

1612
00:56:55,440 --> 00:56:59,460
in that ability is pretty key as well

1613
00:56:57,599 --> 00:57:01,500
like all of some businesses will focus

1614
00:56:59,460 --> 00:57:02,670
on like prevent impression well you're

1615
00:57:01,500 --> 00:57:03,930
not going to prevent profession there's

1616
00:57:02,670 --> 00:57:06,119
always gonna be you met it's coming at

1617
00:57:03,930 --> 00:57:08,730
you techniques the attackers can use

1618
00:57:06,119 --> 00:57:10,740
it's about reliable things you know hang

1619
00:57:08,730 --> 00:57:12,690
your hat on but if you can you know

1620
00:57:10,740 --> 00:57:14,189
detect contain eradicate and say you

1621
00:57:12,690 --> 00:57:15,750
know five minutes of a fresh happening

1622
00:57:14,190 --> 00:57:18,450
you're in a pretty good place is it all

1623
00:57:15,750 --> 00:57:19,440
the attacker is gonna do is like see

1624
00:57:18,450 --> 00:57:21,509
we've compromised

1625
00:57:19,440 --> 00:57:23,550
maybe perform a couple actions and in

1626
00:57:21,510 --> 00:57:25,079
the back hair again and then you know

1627
00:57:23,550 --> 00:57:26,940
you've got a are you've cloned the combs

1628
00:57:25,079 --> 00:57:29,339
URL people opt all that and then a table

1629
00:57:26,940 --> 00:57:31,890
like you know we can fiber and go again

1630
00:57:29,339 --> 00:57:34,710
so we get a good way these are the

1631
00:57:31,890 --> 00:57:36,720
analyst who is empowered to make well

1632
00:57:34,710 --> 00:57:37,680
thought of but well thought help book

1633
00:57:36,720 --> 00:57:40,109
quick decisions

1634
00:57:37,680 --> 00:57:42,569
the will cause outages is actually

1635
00:57:40,109 --> 00:57:44,970
really good flight archive metal is

1636
00:57:42,569 --> 00:57:47,220
earlier so we have a very very quick

1637
00:57:44,970 --> 00:57:49,919
user loop our ability to observe the

1638
00:57:47,220 --> 00:57:51,118
situation orientate ourselves decide

1639
00:57:49,920 --> 00:57:54,359
what we're going to do

1640
00:57:51,119 --> 00:57:56,519
and then at Arvid Institute is because

1641
00:57:54,359 --> 00:57:58,380
our mobile phone bills are 16 hours a

1642
00:57:56,519 --> 00:58:00,359
day for 30 days a week you know so we

1643
00:57:58,380 --> 00:58:01,859
are the phone all the time all day every

1644
00:58:00,359 --> 00:58:03,479
day we don't need to worry about your

1645
00:58:01,859 --> 00:58:04,950
change management change management has

1646
00:58:03,479 --> 00:58:07,229
had its place absolutely the other Duke

1647
00:58:04,950 --> 00:58:09,180
what's happened but having having it

1648
00:58:07,229 --> 00:58:11,788
three day James window to reset you know

1649
00:58:09,180 --> 00:58:13,229
upon service account password like three

1650
00:58:11,789 --> 00:58:14,849
days later you know three days is over

1651
00:58:13,229 --> 00:58:16,859
you know we are well on the way to

1652
00:58:14,849 --> 00:58:18,390
fighting half the report by that one he

1653
00:58:16,859 --> 00:58:21,119
tell me how people who are in power to

1654
00:58:18,390 --> 00:58:23,219
change creds a firewall rules and know

1655
00:58:21,119 --> 00:58:25,019
that it will make a an outage you know

1656
00:58:23,219 --> 00:58:26,729
it will knock your entire se can believe

1657
00:58:25,019 --> 00:58:28,529
often time Surya will knock them all off

1658
00:58:26,729 --> 00:58:31,680
line but it's still better than the

1659
00:58:28,529 --> 00:58:33,420
alternative so go be empowering your

1660
00:58:31,680 --> 00:58:35,969
people whose technology just warm

1661
00:58:33,420 --> 00:58:38,489
hearted people and process of other

1662
00:58:35,969 --> 00:58:40,559
people's people is hard to stand up your

1663
00:58:38,489 --> 00:58:44,329
own capabilities six years people what

1664
00:58:40,559 --> 00:58:46,619
usually processes again lots of people

1665
00:58:44,329 --> 00:58:47,940
you have to wrapped around the axle

1666
00:58:46,619 --> 00:58:49,829
about like oh we need a process with

1667
00:58:47,940 --> 00:58:51,509
this process Latin by the time we've had

1668
00:58:49,829 --> 00:58:53,670
a meeting with everyone in this job you

1669
00:58:51,509 --> 00:58:56,279
know we aren't empowering the lower

1670
00:58:53,670 --> 00:58:58,319
ranks as aware of the analysts order or

1671
00:58:56,279 --> 00:59:00,660
be like the risk owners whether it's a

1672
00:58:58,319 --> 00:59:03,329
CRO technical risk odors and supplier

1673
00:59:00,660 --> 00:59:06,058
how to juice arms great totally go out

1674
00:59:03,329 --> 00:59:08,279
being assist I've been for the still not

1675
00:59:06,059 --> 00:59:09,150
as severe as the impact of having a

1676
00:59:08,279 --> 00:59:11,789
potential compromise

1677
00:59:09,150 --> 00:59:13,319
much better to be the BBC News for you

1678
00:59:11,789 --> 00:59:14,789
you have one of your officers with

1679
00:59:13,319 --> 00:59:16,190
offline which affected some people

1680
00:59:14,789 --> 00:59:19,049
bookie airline tickets or something

1681
00:59:16,190 --> 00:59:21,390
rather than the alternative which is all

1682
00:59:19,049 --> 00:59:22,880
of my customer data was in an 80s bookid

1683
00:59:21,390 --> 00:59:26,509
ability since either posted together

1684
00:59:22,880 --> 00:59:29,700
just have capital one so you know

1685
00:59:26,509 --> 00:59:33,200
bringing this missile even there give it

1686
00:59:29,700 --> 00:59:33,200
up for for Ross and Tom making

