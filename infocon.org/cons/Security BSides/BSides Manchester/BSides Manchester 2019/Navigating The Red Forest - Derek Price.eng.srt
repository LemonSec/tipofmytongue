1
00:00:00,849 --> 00:00:09,999
I had everyone and so we're gonna go

2
00:00:06,880 --> 00:00:12,129
through navigating the red forest which

3
00:00:09,999 --> 00:00:15,810
is helping you understand how you can

4
00:00:12,129 --> 00:00:19,240
secure forests with Microsoft's es a and

5
00:00:15,810 --> 00:00:22,090
so Who am I so I'm Derrick price my

6
00:00:19,240 --> 00:00:24,698
security consultants and CC group I've

7
00:00:22,090 --> 00:00:26,230
been there for seven years and started

8
00:00:24,699 --> 00:00:28,740
off as a junior working way up starting

9
00:00:26,230 --> 00:00:31,419
off with getting things like CRT

10
00:00:28,740 --> 00:00:32,470
eventually come in getting CCTV our team

11
00:00:31,419 --> 00:00:34,840
leader so very interested in

12
00:00:32,470 --> 00:00:37,539
infrastructure which is where a lot of

13
00:00:34,840 --> 00:00:39,910
this sort of comes from a lot of people

14
00:00:37,539 --> 00:00:41,320
a lot of test involves testing Active

15
00:00:39,910 --> 00:00:43,209
Directory so it became quite an

16
00:00:41,320 --> 00:00:46,600
interesting thing for me to sort of like

17
00:00:43,210 --> 00:00:48,340
look out and investigate so the agenda

18
00:00:46,600 --> 00:00:50,949
is to go through you know what is

19
00:00:48,340 --> 00:00:53,109
Microsoft's red forest or ESEA got

20
00:00:50,949 --> 00:00:55,780
design and we've got how to build and

21
00:00:53,109 --> 00:00:58,600
all the gotchas that we've found along

22
00:00:55,780 --> 00:01:00,550
the way and how to use privileged access

23
00:00:58,600 --> 00:01:04,150
workstations and their design deployment

24
00:01:00,550 --> 00:01:08,048
and not a little bit security 101 so the

25
00:01:04,150 --> 00:01:09,909
main reason and that idiots exists is

26
00:01:08,049 --> 00:01:12,310
actually due to a lot of issues that

27
00:01:09,909 --> 00:01:14,170
people have and when they're on enter so

28
00:01:12,310 --> 00:01:17,009
anybody put you hands of your pen tester

29
00:01:14,170 --> 00:01:19,960
in the room okay quite a lot of you and

30
00:01:17,009 --> 00:01:26,079
so how many people have got da off an

31
00:01:19,960 --> 00:01:27,939
intern or job very quickly but a lot of

32
00:01:26,079 --> 00:01:30,039
the time you know you end up with you

33
00:01:27,939 --> 00:01:31,898
know da credentials and you need to be

34
00:01:30,040 --> 00:01:34,290
you look how many dimensions choices

35
00:01:31,899 --> 00:01:38,320
there are and there's an absolute

36
00:01:34,290 --> 00:01:41,649
there's so many and and a lot of times

37
00:01:38,320 --> 00:01:42,820
there's no simple fixes for them and a

38
00:01:41,649 --> 00:01:44,829
lot of time you spend talking to the

39
00:01:42,820 --> 00:01:47,949
client about how they can secure it but

40
00:01:44,829 --> 00:01:50,439
they can't change that their forest and

41
00:01:47,950 --> 00:01:52,149
you end up talking to people and having

42
00:01:50,439 --> 00:01:53,679
these sorts of questions and people that

43
00:01:52,149 --> 00:01:55,119
don't understand that directory or they

44
00:01:53,680 --> 00:01:58,689
put groups in groups within groups

45
00:01:55,119 --> 00:02:02,920
within groups or the director looks like

46
00:01:58,689 --> 00:02:06,520
a complete mess and people have left and

47
00:02:02,920 --> 00:02:07,930
people have made changes to the

48
00:02:06,520 --> 00:02:09,220
directory so that it can't be changed in

49
00:02:07,930 --> 00:02:10,420
the future that people got the reversal

50
00:02:09,220 --> 00:02:14,180
encryption and all sorts of crazy things

51
00:02:10,419 --> 00:02:19,099
turned on so Microsoft

52
00:02:14,180 --> 00:02:21,500
came up with the yes a a which is what

53
00:02:19,099 --> 00:02:23,709
this looks like so what you actually

54
00:02:21,500 --> 00:02:26,329
have is you have your normal forest

55
00:02:23,709 --> 00:02:28,340
which stays as it is but you actually

56
00:02:26,329 --> 00:02:29,780
build another separate forest which

57
00:02:28,340 --> 00:02:33,620
becomes your administrative forests

58
00:02:29,780 --> 00:02:35,540
which or yes ei what this allows you to

59
00:02:33,620 --> 00:02:39,409
do is is to have to keep your forest

60
00:02:35,540 --> 00:02:41,629
exactly as it is and Microsoft have

61
00:02:39,409 --> 00:02:43,250
absolutely used this in their own

62
00:02:41,629 --> 00:02:45,108
infrastructure so that it Microsoft are

63
00:02:43,250 --> 00:02:47,120
quite good at sort of doing what they

64
00:02:45,109 --> 00:02:48,799
say and what they do what they recommend

65
00:02:47,120 --> 00:02:51,470
so they have actually built this and it

66
00:02:48,799 --> 00:02:53,209
allows you to keep your forest as it is

67
00:02:51,470 --> 00:02:55,099
and just have this set one next to it

68
00:02:53,209 --> 00:02:59,209
there's a bit of a better diagram here

69
00:02:55,099 --> 00:03:01,608
and so you actually build your forest

70
00:02:59,209 --> 00:03:06,560
completely separate and you have what we

71
00:03:01,609 --> 00:03:09,650
constitute as tears now with tears what

72
00:03:06,560 --> 00:03:11,870
you end up with is as tier system that

73
00:03:09,650 --> 00:03:14,810
works like this so you split all your

74
00:03:11,870 --> 00:03:17,480
infrastructure up into into tiers so in

75
00:03:14,810 --> 00:03:19,819
these tier 0 you have your domain

76
00:03:17,480 --> 00:03:23,179
controllers new parameter and you also

77
00:03:19,819 --> 00:03:25,310
have your your exchange servers and your

78
00:03:23,180 --> 00:03:26,780
tr0 and then your tier one isn't

79
00:03:25,310 --> 00:03:30,049
normally the rest of your service and

80
00:03:26,780 --> 00:03:32,419
then you have your tier 2 which is

81
00:03:30,049 --> 00:03:34,099
normally your workstations now what you

82
00:03:32,419 --> 00:03:35,239
actually doing here is actually

83
00:03:34,099 --> 00:03:36,409
splitting up all the infrastructure in

84
00:03:35,239 --> 00:03:39,560
your actual having different sets of

85
00:03:36,409 --> 00:03:42,019
credentials for each one so your tier 0

86
00:03:39,560 --> 00:03:43,669
is my monitor maintained by set of

87
00:03:42,019 --> 00:03:45,049
credentials you have your tier one with

88
00:03:43,669 --> 00:03:47,329
a set of credentials you have a tier two

89
00:03:45,049 --> 00:03:49,489
and none of the tiers could talk to each

90
00:03:47,329 --> 00:03:51,470
other so your tier 0 account can't log

91
00:03:49,489 --> 00:03:53,120
into a tier 1 and your tier 1 can't log

92
00:03:51,470 --> 00:03:56,290
into tier 0 so you can't go up and down

93
00:03:53,120 --> 00:04:00,079
it's all keeping it all and sort of

94
00:03:56,290 --> 00:04:01,159
separate which allows you to have a set

95
00:04:00,079 --> 00:04:04,909
of credentials for each one on the

96
00:04:01,159 --> 00:04:06,290
separate forest now when you're coming

97
00:04:04,909 --> 00:04:07,728
to the stage where you want to design

98
00:04:06,290 --> 00:04:12,220
and you want to build this

99
00:04:07,729 --> 00:04:12,220
infrastructure you need to have some

100
00:04:22,680 --> 00:04:25,759
[Music]

101
00:04:27,940 --> 00:04:31,089
[Music]

102
00:04:52,460 --> 00:04:56,960
all the temporal differences are mine

103
00:04:59,380 --> 00:05:02,440
[Music]

104
00:05:10,890 --> 00:05:13,990
[Music]

105
00:05:19,100 --> 00:05:23,820
okay so and so when you build miss you

106
00:05:22,410 --> 00:05:25,410
have tire putting some some design

107
00:05:23,820 --> 00:05:27,030
considerations so you're gonna build

108
00:05:25,410 --> 00:05:28,170
this on all new infrastructure you don't

109
00:05:27,030 --> 00:05:30,179
want any of this infrastructure to the

110
00:05:28,170 --> 00:05:32,010
old legacy kit so you want to build this

111
00:05:30,180 --> 00:05:34,050
on new hardware needs to be in a secure

112
00:05:32,010 --> 00:05:38,700
location the recommendation for

113
00:05:34,050 --> 00:05:40,320
Microsoft is to use hyper-v and a big

114
00:05:38,700 --> 00:05:41,400
cluster you need to have separate

115
00:05:40,320 --> 00:05:44,730
storage cuz you want to keep everything

116
00:05:41,400 --> 00:05:46,979
away from your your your your old domain

117
00:05:44,730 --> 00:05:48,270
and sister to make sure nothing's ever

118
00:05:46,980 --> 00:05:50,160
attacked anymore going to in science

119
00:05:48,270 --> 00:05:52,469
business only you're not going to do

120
00:05:50,160 --> 00:05:53,430
main join this new infrastructure until

121
00:05:52,470 --> 00:05:56,310
your old domain you're gonna create a

122
00:05:53,430 --> 00:05:58,740
new a new forest and you know have a

123
00:05:56,310 --> 00:05:59,880
heavily sits very heavily segregated you

124
00:05:58,740 --> 00:06:01,740
don't want something to come in and

125
00:05:59,880 --> 00:06:03,930
attack your new shiny new administrative

126
00:06:01,740 --> 00:06:05,130
forests and so it's gonna be heavily

127
00:06:03,930 --> 00:06:06,600
segregated it's also gonna be heavily

128
00:06:05,130 --> 00:06:07,950
hardens a lot of people will have issues

129
00:06:06,600 --> 00:06:09,810
with hardening still stop people doing

130
00:06:07,950 --> 00:06:12,120
their day-to-day job or make things like

131
00:06:09,810 --> 00:06:13,380
take longer but on the red forest

132
00:06:12,120 --> 00:06:16,940
implementation you want it to be as

133
00:06:13,380 --> 00:06:19,380
secure as possible you also need to have

134
00:06:16,940 --> 00:06:21,630
the latest operating system so you need

135
00:06:19,380 --> 00:06:24,300
2019 and it also needs to be the 2016

136
00:06:21,630 --> 00:06:27,900
functionality level and 26 is a

137
00:06:24,300 --> 00:06:29,460
must-have due to the way and the all the

138
00:06:27,900 --> 00:06:32,130
all the infrastructure and all the

139
00:06:29,460 --> 00:06:33,138
trusts that you put in or or in 2016 and

140
00:06:32,130 --> 00:06:34,400
2016

141
00:06:33,139 --> 00:06:35,840
and one of the biggest design

142
00:06:34,400 --> 00:06:38,120
considerations is that you have to have

143
00:06:35,840 --> 00:06:39,409
it it has to be a one-way trust I've

144
00:06:38,120 --> 00:06:41,780
actually seen clients try to implement

145
00:06:39,410 --> 00:06:44,090
the red forest and they put in a two-way

146
00:06:41,780 --> 00:06:46,309
trust which means that the legacy olds

147
00:06:44,090 --> 00:06:47,750
main it's all happy but very easy to get

148
00:06:46,310 --> 00:06:49,460
into allows you straight into the red

149
00:06:47,750 --> 00:06:51,850
forest so you must make sure it's always

150
00:06:49,460 --> 00:06:53,960
a red part it's always a one-way trust

151
00:06:51,850 --> 00:06:56,210
now one of the biggest things that you

152
00:06:53,960 --> 00:06:57,650
could do you need to be aware of this as

153
00:06:56,210 --> 00:06:59,630
well is you don't want to be put in a

154
00:06:57,650 --> 00:07:03,080
red forest into infrastructure that is

155
00:06:59,630 --> 00:07:04,820
already and already has have lots of

156
00:07:03,080 --> 00:07:06,229
issues because you're still gonna get

157
00:07:04,820 --> 00:07:08,240
compromised so you want to be able to

158
00:07:06,229 --> 00:07:10,070
fix it I saw the low-hanging fruit to

159
00:07:08,240 --> 00:07:11,389
start with so the things we recommend to

160
00:07:10,070 --> 00:07:13,010
clients is that they you know remove the

161
00:07:11,389 --> 00:07:14,650
legacy stuff like open shares

162
00:07:13,010 --> 00:07:16,940
didn't mean oh they're must deploy lapse

163
00:07:14,650 --> 00:07:19,849
kerberos thing and you must be known to

164
00:07:16,940 --> 00:07:22,219
change or you and Kerberos tickets to

165
00:07:19,850 --> 00:07:24,620
you know use your accounts to longer and

166
00:07:22,220 --> 00:07:26,840
possibly contract get rid of NetBIOS

167
00:07:24,620 --> 00:07:28,490
over tcp/ip and ll M&R get you patched

168
00:07:26,840 --> 00:07:29,690
up today but once you've got a client in

169
00:07:28,490 --> 00:07:33,949
this position you can then help them

170
00:07:29,690 --> 00:07:36,740
sort of like deploy the red forest the

171
00:07:33,949 --> 00:07:41,419
way to build this and is to use Hyper be

172
00:07:36,740 --> 00:07:43,039
2019 it's got and it's got some nice new

173
00:07:41,419 --> 00:07:44,780
features in it it's one of the best

174
00:07:43,039 --> 00:07:46,849
parts this is it it has a proper two

175
00:07:44,780 --> 00:07:48,469
node cluster so it's very simple to

176
00:07:46,849 --> 00:07:50,120
build and very cheap to build so you can

177
00:07:48,470 --> 00:07:52,039
should probably build a red forest and

178
00:07:50,120 --> 00:07:54,650
get all the infrastructure in place for

179
00:07:52,039 --> 00:07:56,990
around about 10 to 15 grand and because

180
00:07:54,650 --> 00:07:59,690
we only need two servers now and you can

181
00:07:56,990 --> 00:08:02,570
also employ lots of features and there's

182
00:07:59,690 --> 00:08:05,090
things like shielded VMs so that they

183
00:08:02,570 --> 00:08:06,469
are encrypted on disk and help prevent

184
00:08:05,090 --> 00:08:08,090
flight baroque administrators and get

185
00:08:06,470 --> 00:08:10,880
access to virtual disks or taken into

186
00:08:08,090 --> 00:08:12,380
other environments you also going to

187
00:08:10,880 --> 00:08:14,389
need things like separate storage and

188
00:08:12,380 --> 00:08:17,419
plugged into there we're going to build

189
00:08:14,389 --> 00:08:22,970
everything on a guarded fabric and give

190
00:08:17,419 --> 00:08:24,198
extra to give us the security so once

191
00:08:22,970 --> 00:08:26,030
you've got all this infrastructure in

192
00:08:24,199 --> 00:08:27,169
place you can then start building and

193
00:08:26,030 --> 00:08:29,840
the only things you're actually required

194
00:08:27,169 --> 00:08:31,580
to do a red forest is to start with the

195
00:08:29,840 --> 00:08:32,870
domain controller and also server in

196
00:08:31,580 --> 00:08:34,189
there so that's it even you've got these

197
00:08:32,870 --> 00:08:35,150
two bits infrastructure sitting in it

198
00:08:34,190 --> 00:08:38,209
into crazy

199
00:08:35,150 --> 00:08:39,650
you can go into the just entire

200
00:08:38,208 --> 00:08:40,819
administration section if you want to

201
00:08:39,650 --> 00:08:42,650
but a lot of people just tend to

202
00:08:40,820 --> 00:08:43,990
implement the basics with the domain

203
00:08:42,650 --> 00:08:45,130
controller and also

204
00:08:43,990 --> 00:08:46,360
if you didn't want to do the

205
00:08:45,130 --> 00:08:48,820
just-in-time stuff the only stuff you've

206
00:08:46,360 --> 00:08:51,630
got to add is an SQL Server SharePoint

207
00:08:48,820 --> 00:08:53,680
Server and a Pam server with all the

208
00:08:51,630 --> 00:08:58,030
management stuff components installed so

209
00:08:53,680 --> 00:09:02,969
not too much more so how does the red

210
00:08:58,030 --> 00:09:07,000
forest actually work and so you have

211
00:09:02,970 --> 00:09:09,760
this sort of concept on the screen so it

212
00:09:07,000 --> 00:09:11,110
allows your admin forest to be on one

213
00:09:09,760 --> 00:09:15,280
side in your production for us to be on

214
00:09:11,110 --> 00:09:17,170
the other and you have so they basically

215
00:09:15,280 --> 00:09:22,150
the privileges on that so you have your

216
00:09:17,170 --> 00:09:26,860
account in your admin forest and this

217
00:09:22,150 --> 00:09:30,189
maps over using the shadow principles so

218
00:09:26,860 --> 00:09:32,170
you have your your tr0 account and you

219
00:09:30,190 --> 00:09:34,300
can map that over to a domain

220
00:09:32,170 --> 00:09:36,010
administrator or a different type of

221
00:09:34,300 --> 00:09:37,420
tiered account on the other side that

222
00:09:36,010 --> 00:09:40,210
has admin and certain parts you have

223
00:09:37,420 --> 00:09:42,459
your tier 0 user the tier 1 user and

224
00:09:40,210 --> 00:09:44,110
your tier 2 user and these are all

225
00:09:42,460 --> 00:09:45,430
mapped over you can sort of see I don't

226
00:09:44,110 --> 00:09:47,710
know how big that picture is other sort

227
00:09:45,430 --> 00:09:50,920
of quite good so you can see here you

228
00:09:47,710 --> 00:09:53,950
have your solid min and you have your

229
00:09:50,920 --> 00:09:54,910
and a lot of shadow principles here and

230
00:09:53,950 --> 00:09:56,980
we've got all the admins here and

231
00:09:54,910 --> 00:09:58,780
they're all mapped over to these objects

232
00:09:56,980 --> 00:10:00,610
here so these have all been mapped over

233
00:09:58,780 --> 00:10:06,430
and go over you can sort of see it a bit

234
00:10:00,610 --> 00:10:08,650
better in here so the sole admin here

235
00:10:06,430 --> 00:10:10,390
has had its privileges mapped over to

236
00:10:08,650 --> 00:10:12,069
the production Forest so you can see

237
00:10:10,390 --> 00:10:14,199
here that they've actually got in the

238
00:10:12,070 --> 00:10:16,600
production forest allotment but in the

239
00:10:14,200 --> 00:10:18,820
pocket do the throughout my slash all

240
00:10:16,600 --> 00:10:20,410
you can see that the domain admins is

241
00:10:18,820 --> 00:10:22,150
all tacked there with the five one two

242
00:10:20,410 --> 00:10:23,530
five one nine and everything that's in

243
00:10:22,150 --> 00:10:25,060
this sort of diagram here so you can see

244
00:10:23,530 --> 00:10:28,660
the SIDS at the end there have been

245
00:10:25,060 --> 00:10:30,219
mapped over and which is using the

246
00:10:28,660 --> 00:10:32,920
shadow at the shadow principals and

247
00:10:30,220 --> 00:10:35,350
allows the ability of you to now have

248
00:10:32,920 --> 00:10:42,130
full control over your production forest

249
00:10:35,350 --> 00:10:45,460
from your administrative Forest so now

250
00:10:42,130 --> 00:10:47,350
you build this and new production and

251
00:10:45,460 --> 00:10:49,180
this new the administrative forest

252
00:10:47,350 --> 00:10:52,420
you know how this you is it's just sort

253
00:10:49,180 --> 00:10:55,209
of sat away all secure and hardened but

254
00:10:52,420 --> 00:10:56,140
you're still using your laptop and to to

255
00:10:55,210 --> 00:10:59,260
access it

256
00:10:56,140 --> 00:11:02,230
so Microsoft came up with and privileged

257
00:10:59,260 --> 00:11:04,120
access workstations and we're gonna go

258
00:11:02,230 --> 00:11:06,790
through what it's a Paul mind you need

259
00:11:04,120 --> 00:11:08,769
one then go through why you should use a

260
00:11:06,790 --> 00:11:10,959
dedicated workstation why an

261
00:11:08,769 --> 00:11:12,640
administrative VM is bad and these have

262
00:11:10,959 --> 00:11:15,790
content regarding happening so you've

263
00:11:12,640 --> 00:11:17,079
got your nice forest all built and it's

264
00:11:15,790 --> 00:11:18,610
all hardened and all really good and

265
00:11:17,079 --> 00:11:21,189
this is the sort of extra thing you can

266
00:11:18,610 --> 00:11:23,529
do so the current threat environment

267
00:11:21,190 --> 00:11:25,269
most of our organizations is an attacker

268
00:11:23,529 --> 00:11:27,550
kept Sano or at the user's workstation

269
00:11:25,269 --> 00:11:30,940
the privilege escalates and they under

270
00:11:27,550 --> 00:11:33,699
the assets so what we recommend is is

271
00:11:30,940 --> 00:11:36,250
that you have a workstation that's in a

272
00:11:33,700 --> 00:11:37,450
position of you know what you want you

273
00:11:36,250 --> 00:11:39,279
want our separate workstation connected

274
00:11:37,450 --> 00:11:43,600
to your new red forest network which is

275
00:11:39,279 --> 00:11:44,649
a secure and you do that using and this

276
00:11:43,600 --> 00:11:46,959
for the guts of where stations that's

277
00:11:44,649 --> 00:11:49,560
how a normal attack would happen so what

278
00:11:46,959 --> 00:11:51,849
you can do here is you have an

279
00:11:49,560 --> 00:11:54,819
administrative VM which is what a lot of

280
00:11:51,850 --> 00:11:58,360
people do now in administrative vm if I

281
00:11:54,820 --> 00:12:02,199
was to compromise your user vm your user

282
00:11:58,360 --> 00:12:03,970
host does the compromise your user host

283
00:12:02,199 --> 00:12:05,380
that would give me indirect access to

284
00:12:03,970 --> 00:12:07,209
everything on your system so if your

285
00:12:05,380 --> 00:12:09,130
administrative VN lives on there I can

286
00:12:07,209 --> 00:12:10,420
get straight into a mystery to VM pull

287
00:12:09,130 --> 00:12:12,939
out the credentials you're an attacker

288
00:12:10,420 --> 00:12:16,240
system what we absolutely recommend you

289
00:12:12,940 --> 00:12:18,100
do is you have a user VM so your host

290
00:12:16,240 --> 00:12:21,970
you open your main host your booting up

291
00:12:18,100 --> 00:12:24,519
is active administrative system and it

292
00:12:21,970 --> 00:12:27,160
has a VM on top which is your users your

293
00:12:24,519 --> 00:12:29,260
user VM is having on to the simultaneous

294
00:12:27,160 --> 00:12:31,329
use so you've got your administrative

295
00:12:29,260 --> 00:12:32,890
host and your user VM if something is to

296
00:12:31,329 --> 00:12:34,660
compromise your user VM they get your

297
00:12:32,890 --> 00:12:35,740
low-level credentials they can't go

298
00:12:34,660 --> 00:12:37,750
anywhere else the sort of stuff that

299
00:12:35,740 --> 00:12:39,790
must have got a lovely zero day in

300
00:12:37,750 --> 00:12:41,110
hyper-v which you've got being a problem

301
00:12:39,790 --> 00:12:43,750
system is going after you in divide zero

302
00:12:41,110 --> 00:12:45,910
day for hyper-v so with the

303
00:12:43,750 --> 00:12:47,230
administrative host you're in a

304
00:12:45,910 --> 00:12:49,029
situation where that host that

305
00:12:47,230 --> 00:12:49,990
underlying code is completely firewalled

306
00:12:49,029 --> 00:12:51,730
off and everything and you have

307
00:12:49,990 --> 00:12:53,500
everything sort of sort of there but

308
00:12:51,730 --> 00:12:55,420
they have this user VM and it means that

309
00:12:53,500 --> 00:12:58,779
if that gets compromised you won't have

310
00:12:55,420 --> 00:12:59,920
and you know you can't leave the can't

311
00:12:58,779 --> 00:13:03,279
break out anywhere they'll get some user

312
00:12:59,920 --> 00:13:04,719
creds and that's all now and once you

313
00:13:03,279 --> 00:13:06,939
have that up and running you can then

314
00:13:04,720 --> 00:13:08,500
need to get a lot of hardening done on

315
00:13:06,940 --> 00:13:09,490
the underlying host you want this you

316
00:13:08,500 --> 00:13:10,750
want this administrative her

317
00:13:09,490 --> 00:13:13,540
to be as hard as possible and have

318
00:13:10,750 --> 00:13:16,260
little ability to get anywhere so you

319
00:13:13,540 --> 00:13:18,430
can use things like credential guard and

320
00:13:16,260 --> 00:13:21,720
so you'll want to use connect regards to

321
00:13:18,430 --> 00:13:25,060
protect credentials and so that are in

322
00:13:21,720 --> 00:13:26,320
the slot in memory and you can do that

323
00:13:25,060 --> 00:13:30,849
using the hypervisors built-in

324
00:13:26,320 --> 00:13:32,080
capabilities and you can also you know

325
00:13:30,850 --> 00:13:34,390
we also need to go down the lines of

326
00:13:32,080 --> 00:13:36,580
hardening so the biggest thing is all

327
00:13:34,390 --> 00:13:37,420
about getting your hardening really good

328
00:13:36,580 --> 00:13:39,459
you don't want something to be able to

329
00:13:37,420 --> 00:13:42,760
get onto your administrative host and

330
00:13:39,459 --> 00:13:44,170
compromise anything go go in that way so

331
00:13:42,760 --> 00:13:45,550
a lot of the things you got to do is

332
00:13:44,170 --> 00:13:48,790
lots of hard in lots of baselining

333
00:13:45,550 --> 00:13:50,290
and Microsoft actually have a list of

334
00:13:48,790 --> 00:13:52,199
hardening guides book of justice

335
00:13:50,290 --> 00:13:54,610
workstations with all the GPOs in them

336
00:13:52,200 --> 00:13:55,899
and you can also obviously employ a

337
00:13:54,610 --> 00:13:57,040
blocker so that the only things you

338
00:13:55,899 --> 00:13:58,720
should be able to really run is remote

339
00:13:57,040 --> 00:14:01,360
desktop and any powershell scripts that

340
00:13:58,720 --> 00:14:03,640
you need to get your privileges and lots

341
00:14:01,360 --> 00:14:06,610
of GPOs make sure the lights get listed

342
00:14:03,640 --> 00:14:09,250
and one of the things that one of the

343
00:14:06,610 --> 00:14:11,589
admins that who-who ever seen build this

344
00:14:09,250 --> 00:14:14,350
and they have to do they actually went

345
00:14:11,589 --> 00:14:16,089
through and did all the lul bins mmm

346
00:14:14,350 --> 00:14:18,220
attacks and they manually went through

347
00:14:16,089 --> 00:14:22,750
and create gpo's and a blockers to stop

348
00:14:18,220 --> 00:14:23,980
that from happening so once you've got

349
00:14:22,750 --> 00:14:25,300
this you now in a situation where you

350
00:14:23,980 --> 00:14:28,120
have your privileged access workstation

351
00:14:25,300 --> 00:14:30,219
you now have your production and you

352
00:14:28,120 --> 00:14:31,810
have you put your production network

353
00:14:30,220 --> 00:14:34,779
which has been left alone and you now

354
00:14:31,810 --> 00:14:36,219
have your your red forest what you then

355
00:14:34,779 --> 00:14:37,209
have to do is you start to you want them

356
00:14:36,220 --> 00:14:39,760
to be in a position where there's no

357
00:14:37,209 --> 00:14:41,920
administrators left in your production

358
00:14:39,760 --> 00:14:43,600
forest so you can start pulling people

359
00:14:41,920 --> 00:14:44,649
out you give everybody their public

360
00:14:43,600 --> 00:14:46,510
assets were stations are new set

361
00:14:44,649 --> 00:14:47,620
credentials in the red forest and it

362
00:14:46,510 --> 00:14:50,079
should get to a point where the only

363
00:14:47,620 --> 00:14:51,310
accounts that are left in your

364
00:14:50,079 --> 00:14:55,540
administrator many administrators group

365
00:14:51,310 --> 00:14:56,709
in your production one are the default

366
00:14:55,540 --> 00:14:58,660
administrator view which is gonna take

367
00:14:56,709 --> 00:15:02,739
in a safe for emergency brake lights and

368
00:14:58,660 --> 00:15:04,180
you probably your exchange a account

369
00:15:02,740 --> 00:15:07,660
which will go into wider exchange you'll

370
00:15:04,180 --> 00:15:09,459
need to stay so you've now got your if

371
00:15:07,660 --> 00:15:11,860
it if you know if your attackers on your

372
00:15:09,459 --> 00:15:13,839
network start doing all that usual

373
00:15:11,860 --> 00:15:14,920
attacks responder and the staff it's

374
00:15:13,839 --> 00:15:16,329
getting to the point where they've got

375
00:15:14,920 --> 00:15:17,380
some credentials and up onto a box and

376
00:15:16,329 --> 00:15:19,150
they do you know that I'm going off to a

377
00:15:17,380 --> 00:15:20,980
domain administrator there's actually no

378
00:15:19,150 --> 00:15:21,760
domain administrators left or if there

379
00:15:20,980 --> 00:15:23,339
is there's not going to be any

380
00:15:21,760 --> 00:15:26,350
credentials flying around for them

381
00:15:23,339 --> 00:15:27,579
and they'd have to one of the big things

382
00:15:26,350 --> 00:15:30,040
about the red forest as well is that it

383
00:15:27,579 --> 00:15:31,839
has the ability to do the time to live

384
00:15:30,040 --> 00:15:34,480
on your credentials is really small so

385
00:15:31,839 --> 00:15:36,040
when you activate your account so you

386
00:15:34,480 --> 00:15:38,499
can say it's in public for four hours

387
00:15:36,040 --> 00:15:40,419
after four hours that's it's calm and

388
00:15:38,499 --> 00:15:42,459
that allows people to very granularly

389
00:15:40,419 --> 00:15:44,739
get their access complete the task and

390
00:15:42,459 --> 00:15:46,449
then all of the credentials are expunged

391
00:15:44,739 --> 00:15:47,679
from the system so in it when an

392
00:15:46,449 --> 00:15:49,569
attacker gets on they're going to find

393
00:15:47,679 --> 00:15:51,339
it very hard to move around and also as

394
00:15:49,569 --> 00:15:53,019
the tears can if anybody wants to

395
00:15:51,339 --> 00:15:55,059
compromise anything that's his sort of

396
00:15:53,019 --> 00:15:56,799
lockdown enough in a way that if you

397
00:15:55,059 --> 00:15:58,959
were to get on a tear like the work

398
00:15:56,799 --> 00:16:00,489
station and you did get creds that

399
00:15:58,959 --> 00:16:03,219
lasted maybe 20 minutes you only be able

400
00:16:00,489 --> 00:16:04,209
to get on to your work stations you

401
00:16:03,220 --> 00:16:04,989
would be able to go any higher where I

402
00:16:04,209 --> 00:16:06,910
was a lot at the time when you're

403
00:16:04,989 --> 00:16:10,179
attacking if you know me just bounce

404
00:16:06,910 --> 00:16:15,669
straight up - and so it's in terms of

405
00:16:10,179 --> 00:16:18,519
main admin so one of the things that you

406
00:16:15,669 --> 00:16:21,910
a client will normally ask is you know

407
00:16:18,519 --> 00:16:25,119
what sort of walking are what sort of

408
00:16:21,910 --> 00:16:28,089
gotchas are there for the red forest and

409
00:16:25,119 --> 00:16:29,860
so the way exchange works is it has

410
00:16:28,089 --> 00:16:31,839
something called Universal groups that

411
00:16:29,860 --> 00:16:34,629
get created when the system gets built

412
00:16:31,839 --> 00:16:37,179
with exchanges Universal groups they

413
00:16:34,629 --> 00:16:38,350
don't shadow well and I know some of the

414
00:16:37,179 --> 00:16:40,209
some admins that I've seen do it I've

415
00:16:38,350 --> 00:16:42,759
tried but it doesn't shadow well at all

416
00:16:40,209 --> 00:16:44,529
and enterprise admins doesn't shadow

417
00:16:42,759 --> 00:16:45,999
well either and so a lot of the time

418
00:16:44,529 --> 00:16:46,899
they can normally promote themselves on

419
00:16:45,999 --> 00:16:48,249
the production for us to do the

420
00:16:46,899 --> 00:16:51,629
enterprise admin tasks and then put it

421
00:16:48,249 --> 00:16:51,629
back in the safe and change password

422
00:16:51,689 --> 00:16:57,669
the officer server needs to be

423
00:16:54,160 --> 00:16:59,169
standalone on your red forest and so

424
00:16:57,669 --> 00:17:00,669
recommend you keep that separate and

425
00:16:59,169 --> 00:17:03,730
don't have it don't start poking

426
00:17:00,669 --> 00:17:05,980
firewall holes and into your red forest

427
00:17:03,730 --> 00:17:08,289
area otherwise you end up in a situation

428
00:17:05,980 --> 00:17:12,730
where and you start to put holes on

429
00:17:08,289 --> 00:17:15,220
something that's quite secure and so the

430
00:17:12,730 --> 00:17:17,769
low bins is hard and manual and there's

431
00:17:15,220 --> 00:17:20,679
so many logins and sort of things to go

432
00:17:17,769 --> 00:17:25,870
through and harder and that it can be

433
00:17:20,679 --> 00:17:27,039
quite and quite time consuming and also

434
00:17:25,869 --> 00:17:28,388
need to make sure you put people into

435
00:17:27,039 --> 00:17:30,690
the protected user group so the pity

436
00:17:28,388 --> 00:17:33,279
people on the production and on the

437
00:17:30,690 --> 00:17:36,100
production on the red forest sorry get

438
00:17:33,279 --> 00:17:37,960
point strategies group so they don't use

439
00:17:36,100 --> 00:17:40,928
- don't leave credential flying around

440
00:17:37,960 --> 00:17:42,220
and also one of the biggest things which

441
00:17:40,929 --> 00:17:44,169
I think of few admins have come a

442
00:17:42,220 --> 00:17:45,549
cropper with is the shadow principles

443
00:17:44,169 --> 00:17:46,750
that you're using to make move York

444
00:17:45,549 --> 00:17:50,350
remove your credentials so that they

445
00:17:46,750 --> 00:17:52,030
work and shadowing over users it

446
00:17:50,350 --> 00:17:53,500
requires a functionality level of twenty

447
00:17:52,030 --> 00:17:56,020
twelve on your production for us we had

448
00:17:53,500 --> 00:17:59,559
a few issues where a user or an admin

449
00:17:56,020 --> 00:18:00,879
decided to put all this and said all the

450
00:17:59,559 --> 00:18:02,320
symmetry so intercept for structure but

451
00:18:00,880 --> 00:18:05,559
is one of his domain controllers was

452
00:18:02,320 --> 00:18:07,629
2008 and which meant is folks matter was

453
00:18:05,559 --> 00:18:11,770
2008 and it got really weird and one

454
00:18:07,630 --> 00:18:13,030
login to sound systems one of the big

455
00:18:11,770 --> 00:18:17,049
things as well that's coming through is

456
00:18:13,030 --> 00:18:19,809
Azure and jaw isn't it's quite hard to

457
00:18:17,049 --> 00:18:21,580
in so to get into your red forest and

458
00:18:19,809 --> 00:18:24,330
what mic supposed to coming up with what

459
00:18:21,580 --> 00:18:27,580
a better way to do that soon and

460
00:18:24,330 --> 00:18:30,120
and that it's actually did it end of my

461
00:18:27,580 --> 00:18:39,850
talk so has anybody got any questions

462
00:18:30,120 --> 00:18:41,799
yeah and so obviously if there's not a

463
00:18:39,850 --> 00:18:42,850
lot of people done it yet which is sort

464
00:18:41,799 --> 00:18:44,080
of the reason for the talk and not a lot

465
00:18:42,850 --> 00:18:47,139
of people have actually invented yet

466
00:18:44,080 --> 00:18:49,210
haven't seen one actual working example

467
00:18:47,140 --> 00:18:52,090
and it was a learning curve there was

468
00:18:49,210 --> 00:18:53,890
deficit issues and by the protected user

469
00:18:52,090 --> 00:18:56,530
groups wasn't put on and so there were

470
00:18:53,890 --> 00:19:01,000
leading credentials lying around on

471
00:18:56,530 --> 00:19:02,049
servers and a lot of people have to have

472
00:19:01,000 --> 00:19:03,549
to build it and make it slightly

473
00:19:02,049 --> 00:19:04,750
insecure to get stuff moved over to

474
00:19:03,549 --> 00:19:06,940
start with and see the problems with

475
00:19:04,750 --> 00:19:25,870
firewalls but I've seen seen some very

476
00:19:06,940 --> 00:19:27,070
good so the good thing about the far the

477
00:19:25,870 --> 00:19:29,020
red forest is that you build in you

478
00:19:27,070 --> 00:19:31,030
build some completely new to the side so

479
00:19:29,020 --> 00:19:35,049
you don't actually have to disturb your

480
00:19:31,030 --> 00:19:37,450
forest at all to start with so you can

481
00:19:35,049 --> 00:19:38,440
build build it get all the laptops up

482
00:19:37,450 --> 00:19:40,030
and running so you can basically have

483
00:19:38,440 --> 00:19:41,200
everybody doing it but they can also

484
00:19:40,030 --> 00:19:42,730
they can you know they still happening

485
00:19:41,200 --> 00:19:44,260
with their old sets of credentials and

486
00:19:42,730 --> 00:19:46,480
then what you slowly do is is you have

487
00:19:44,260 --> 00:19:48,140
to unpick all the tech debt that you've

488
00:19:46,480 --> 00:19:50,540
got in your production for

489
00:19:48,140 --> 00:19:52,940
you do say you met group administrators

490
00:19:50,540 --> 00:19:54,678
and you see there's 45 domain admins you

491
00:19:52,940 --> 00:19:58,460
know that's gonna take a lot of picking

492
00:19:54,679 --> 00:20:00,260
we normally see where you know I get the

493
00:19:58,460 --> 00:20:02,600
service account in there so we create

494
00:20:00,260 --> 00:20:04,010
the service account in 2013 and never

495
00:20:02,600 --> 00:20:06,439
knows what the password is for it and

496
00:20:04,010 --> 00:20:08,000
it's also running like exchange and it's

497
00:20:06,440 --> 00:20:10,250
ruining all sorts of stuff so it's a

498
00:20:08,000 --> 00:20:12,770
time consuming process to unpick but

499
00:20:10,250 --> 00:20:15,230
what you should end up with is your

500
00:20:12,770 --> 00:20:17,030
production first days as it is very nice

501
00:20:15,230 --> 00:20:19,070
and very stable and you just slowly

502
00:20:17,030 --> 00:20:20,750
unpick the administrative signs of it so

503
00:20:19,070 --> 00:20:21,770
you prefer so we take all your users out

504
00:20:20,750 --> 00:20:24,500
there in there give them the privileged

505
00:20:21,770 --> 00:20:27,260
access workstations and let them let

506
00:20:24,500 --> 00:20:28,640
them carry on and then you can start

507
00:20:27,260 --> 00:20:30,110
don't get the service accounts you know

508
00:20:28,640 --> 00:20:32,179
start with the easy ones like backups

509
00:20:30,110 --> 00:20:34,790
first a lot of the time you'll probably

510
00:20:32,179 --> 00:20:35,720
find out that most of the domain

511
00:20:34,790 --> 00:20:36,950
administrators don't need to be

512
00:20:35,720 --> 00:20:38,390
diminished administrators it was just

513
00:20:36,950 --> 00:20:40,160
easier that's what a lot of people used

514
00:20:38,390 --> 00:20:41,390
to do just go that doesn't work let me

515
00:20:40,160 --> 00:20:45,320
just provide that to a domain admin how

516
00:20:41,390 --> 00:20:49,610
it works we're all sorted so you could

517
00:20:45,320 --> 00:20:51,379
push that out to you know to get to do

518
00:20:49,610 --> 00:20:53,928
these lots of nodes to go through those

519
00:20:51,380 --> 00:20:55,100
and then to start moving stuff over but

520
00:20:53,929 --> 00:20:57,260
when you move over you should literally

521
00:20:55,100 --> 00:20:59,510
be sat with your production forest which

522
00:20:57,260 --> 00:21:00,770
is still probably got issues but you

523
00:20:59,510 --> 00:21:03,049
should have the administrative side

524
00:21:00,770 --> 00:21:05,418
happening from over your on to your

525
00:21:03,049 --> 00:21:06,590
secure side and when people are moving

526
00:21:05,419 --> 00:21:07,760
you know when things are going over

527
00:21:06,590 --> 00:21:09,949
there's you know they'll be no domain

528
00:21:07,760 --> 00:21:12,260
admin hash is running around I'm like

529
00:21:09,950 --> 00:21:14,510
responder or you know let gonna ship in

530
00:21:12,260 --> 00:21:17,600
it and an open share somewhere and if

531
00:21:14,510 --> 00:21:19,520
you've got laps employees you know if a

532
00:21:17,600 --> 00:21:23,090
user gets on one box they shouldn't be

533
00:21:19,520 --> 00:21:25,820
able to then migrate to you know 20 30

534
00:21:23,090 --> 00:21:27,740
other boxes then get stuck on one place

535
00:21:25,820 --> 00:21:29,299
and trying Icicle a will be a lot lot

536
00:21:27,740 --> 00:21:39,470
harder especially when it's time to live

537
00:21:29,299 --> 00:21:41,600
I stood one up so we haven't come across

538
00:21:39,470 --> 00:21:45,020
one where we've been Tessa who helped

539
00:21:41,600 --> 00:21:49,189
build build them but I've stood on top

540
00:21:45,020 --> 00:21:50,330
the lab environments and you know played

541
00:21:49,190 --> 00:21:51,710
with the features and seeing what

542
00:21:50,330 --> 00:21:55,149
doesn't work what does the Shadow Copy

543
00:21:51,710 --> 00:21:58,220
like Exchange is and there's no shadow

544
00:21:55,150 --> 00:22:00,050
very well and what we haven't seen I

545
00:21:58,220 --> 00:22:01,070
said is not a lot of customers or people

546
00:22:00,050 --> 00:22:02,659
that do

547
00:22:01,070 --> 00:22:04,399
becoming a lot warmer getting a lot more

548
00:22:02,660 --> 00:22:06,710
people talking about it when I go to do

549
00:22:04,400 --> 00:22:08,330
in the system all I've seen this or

550
00:22:06,710 --> 00:22:09,230
people start to become while aware of it

551
00:22:08,330 --> 00:22:11,800
but it's been out for quite a number of

552
00:22:09,230 --> 00:22:13,880
years and it's something that Microsoft

553
00:22:11,800 --> 00:22:16,010
sort of pushing a bit more now it's

554
00:22:13,880 --> 00:22:17,060
definitely this is not a lot of detail

555
00:22:16,010 --> 00:22:19,970
that most of the people that have built

556
00:22:17,060 --> 00:22:22,669
this having to build it with you know

557
00:22:19,970 --> 00:22:24,230
very little documentation and Max was

558
00:22:22,670 --> 00:22:26,630
like yes here's all the information here

559
00:22:24,230 --> 00:22:29,600
and what we what really want you to do

560
00:22:26,630 --> 00:22:31,090
is to pay 200 grand for them to come in

561
00:22:29,600 --> 00:22:48,100
and do it all for you make it look all

562
00:22:31,090 --> 00:22:51,379
lovely yeah

563
00:22:48,100 --> 00:22:53,120
so to actually build it it doesn't

564
00:22:51,380 --> 00:22:54,170
actually take that long because you need

565
00:22:53,120 --> 00:22:57,169
your built in something completely

566
00:22:54,170 --> 00:22:59,210
separate so find some tin and so

567
00:22:57,170 --> 00:23:01,040
ordering you know kit takes about a week

568
00:22:59,210 --> 00:23:02,810
it's a stand it up you and you actually

569
00:23:01,040 --> 00:23:03,260
need a domain controller and what's a

570
00:23:02,810 --> 00:23:05,389
server

571
00:23:03,260 --> 00:23:06,590
and to put you know a cluster in one

572
00:23:05,390 --> 00:23:07,540
location and the cluster in another

573
00:23:06,590 --> 00:23:09,590
location

574
00:23:07,540 --> 00:23:11,120
so once you've actually got that sort of

575
00:23:09,590 --> 00:23:12,439
stuff done you've made your forest you

576
00:23:11,120 --> 00:23:13,969
you know you don't know the DNS and all

577
00:23:12,440 --> 00:23:16,100
they are they getting it up and running

578
00:23:13,970 --> 00:23:18,830
and then you've put that trust in so

579
00:23:16,100 --> 00:23:21,169
that your production forest trusts your

580
00:23:18,830 --> 00:23:22,639
red forest it's it's not actually

581
00:23:21,170 --> 00:23:24,230
element to get into implemented you know

582
00:23:22,640 --> 00:23:25,970
you create your accounts so all nice

583
00:23:24,230 --> 00:23:28,450
simple process the hardest part of the

584
00:23:25,970 --> 00:23:30,530
red forest is to under the hip all the

585
00:23:28,450 --> 00:23:33,110
legacy stuff that's that's lying around

586
00:23:30,530 --> 00:23:34,940
on the network and that's the hard bit

587
00:23:33,110 --> 00:23:36,860
so you could tell you you could probably

588
00:23:34,940 --> 00:23:38,060
build a red forest in a month and have

589
00:23:36,860 --> 00:23:39,979
it working you know to get all the

590
00:23:38,060 --> 00:23:41,629
privileged access workstations sorted

591
00:23:39,980 --> 00:23:43,490
distribute them to everyone and give

592
00:23:41,630 --> 00:23:45,650
everybody the credentials the tier zeros

593
00:23:43,490 --> 00:23:47,300
tier 1 to tier 2 accounts get all

594
00:23:45,650 --> 00:23:49,640
pacifies in place but then you've got to

595
00:23:47,300 --> 00:23:52,490
then go right let's start removing the

596
00:23:49,640 --> 00:23:54,050
domain admins from the production forest

597
00:23:52,490 --> 00:23:55,310
let's move all the users that have got

598
00:23:54,050 --> 00:23:58,340
village assets were stations were we're

599
00:23:55,310 --> 00:24:00,500
left with 20 service accounts that you

600
00:23:58,340 --> 00:24:02,419
know probably one of them breaks payroll

601
00:24:00,500 --> 00:24:04,520
or one of the HR system relies on them

602
00:24:02,420 --> 00:24:06,170
but it's also an SQL Server password so

603
00:24:04,520 --> 00:24:07,250
it's all the tech DEP that you've got to

604
00:24:06,170 --> 00:24:09,670
unpick there's an hardest bit of a

605
00:24:07,250 --> 00:24:13,800
building it should entail on that's on

606
00:24:09,670 --> 00:24:18,979
yep it's a nice shiny tip

607
00:24:13,800 --> 00:24:18,979
[Music]

608
00:24:19,930 --> 00:24:46,250
so so that is a harder solution to

609
00:24:44,030 --> 00:24:47,750
employ or launching at you are once you

610
00:24:46,250 --> 00:24:50,300
get started you've got to be you've got

611
00:24:47,750 --> 00:24:51,680
to want to do it so the point the point

612
00:24:50,300 --> 00:24:54,139
where I've seen most places are they're

613
00:24:51,680 --> 00:24:55,790
rolling it out and even there you know

614
00:24:54,140 --> 00:24:57,050
the grow adapt to help desk to help desk

615
00:24:55,790 --> 00:24:58,820
up early Jessica were stationed with the

616
00:24:57,050 --> 00:25:00,310
tier 2 account at only intuitive account

617
00:24:58,820 --> 00:25:02,990
and they've been break sleep quite well

618
00:25:00,310 --> 00:25:04,639
you it goes it does curb a lot of bad

619
00:25:02,990 --> 00:25:07,310
habits as well so people that are like

620
00:25:04,640 --> 00:25:08,750
not liking the hardened workstations and

621
00:25:07,310 --> 00:25:10,220
stuff like that but once you've solved

622
00:25:08,750 --> 00:25:11,840
got you you group several pop in the

623
00:25:10,220 --> 00:25:13,190
Union you've got you two zeros given you

624
00:25:11,840 --> 00:25:15,110
even log on to your domain controllers

625
00:25:13,190 --> 00:25:16,310
you've got your tier ones that logs into

626
00:25:15,110 --> 00:25:18,050
all your service people get more

627
00:25:16,310 --> 00:25:19,040
accustomed to it and then you know

628
00:25:18,050 --> 00:25:21,770
they've got the per the traffic were

629
00:25:19,040 --> 00:25:23,389
station and their admin console is their

630
00:25:21,770 --> 00:25:26,150
house that one's going to a VM to do it

631
00:25:23,390 --> 00:25:27,470
so they aren't doing it all it's you are

632
00:25:26,150 --> 00:25:29,360
gonna need somebody that does understand

633
00:25:27,470 --> 00:26:03,650
it to help implement it well once you've

634
00:25:29,360 --> 00:26:04,879
got it started it's not it's not there's

635
00:26:03,650 --> 00:26:06,950
definitely an increase in if they need

636
00:26:04,880 --> 00:26:09,920
some some bright people at the top will

637
00:26:06,950 --> 00:26:10,940
help and design it but with the what did

638
00:26:09,920 --> 00:26:13,790
you say with that can you bender coming

639
00:26:10,940 --> 00:26:15,170
in the previous example you better go in

640
00:26:13,790 --> 00:26:17,960
it because because everything's

641
00:26:15,170 --> 00:26:20,300
obviously off to the sides they they can

642
00:26:17,960 --> 00:26:21,620
they can be given domain up in the

643
00:26:20,300 --> 00:26:24,110
container to do the work in infinity but

644
00:26:21,620 --> 00:26:26,330
you can speak to most products that you

645
00:26:24,110 --> 00:26:27,280
get in now don't need the main either

646
00:26:26,330 --> 00:26:28,389
they say they do

647
00:26:27,280 --> 00:26:29,560
but you can also do know you can do

648
00:26:28,390 --> 00:26:31,420
store you role based access control

649
00:26:29,560 --> 00:26:32,950
stuff a bit better you aren't going to

650
00:26:31,420 --> 00:26:33,880
need a couple of admins that understand

651
00:26:32,950 --> 00:26:36,880
this you know through and through and

652
00:26:33,880 --> 00:26:40,180
builder and debit and so I've been a

653
00:26:36,880 --> 00:26:41,410
Windows administrator before and I got

654
00:26:40,180 --> 00:26:43,570
open with him and I lapping but never

655
00:26:41,410 --> 00:26:44,890
labs not on picking a a very big domain

656
00:26:43,570 --> 00:26:46,419
but I'll played around with it and it

657
00:26:44,890 --> 00:26:49,030
didn't it didn't take the crazy amount

658
00:26:46,420 --> 00:26:50,530
of time to do it once it's done it's

659
00:26:49,030 --> 00:26:51,580
pretty much self sufficient because you

660
00:26:50,530 --> 00:27:09,850
know you got all you always stuff

661
00:26:51,580 --> 00:27:11,350
happening on one side okay I thought the

662
00:27:09,850 --> 00:27:12,730
places I've seen in employing people

663
00:27:11,350 --> 00:27:14,139
aren't people struggle to their start to

664
00:27:12,730 --> 00:27:16,000
understand it book the people that are

665
00:27:14,140 --> 00:27:26,350
then there now there's like second

666
00:27:16,000 --> 00:27:28,570
nature to them so you pillage upsets

667
00:27:26,350 --> 00:27:37,000
workstations connected to your admin

668
00:27:28,570 --> 00:27:40,389
forest you can you probably increase the

669
00:27:37,000 --> 00:27:41,560
see yeah so you can probably increase

670
00:27:40,390 --> 00:27:43,210
the security I do feel justice

671
00:27:41,560 --> 00:27:43,840
workstations in general so you could

672
00:27:43,210 --> 00:27:45,520
take it

673
00:27:43,840 --> 00:27:46,570
if you everything want to do the red

674
00:27:45,520 --> 00:27:48,340
forest you could probably take the

675
00:27:46,570 --> 00:27:50,439
privileged access workstation concept an

676
00:27:48,340 --> 00:27:51,699
employer because is quite a nice concept

677
00:27:50,440 --> 00:27:53,710
that you know your admin host and you

678
00:27:51,700 --> 00:27:55,330
use a VM which means you know you use it

679
00:27:53,710 --> 00:27:56,650
gets compromised they can't break out

680
00:27:55,330 --> 00:27:58,330
anywhere and go and get admin credit so

681
00:27:56,650 --> 00:28:00,520
you'll probably increase the security of

682
00:27:58,330 --> 00:28:03,250
that and the pillage SS workstations is

683
00:28:00,520 --> 00:28:04,420
like a separate part so people people

684
00:28:03,250 --> 00:28:07,150
can't just build the red for us and not

685
00:28:04,420 --> 00:28:08,920
use pod SS web stations but it's sort of

686
00:28:07,150 --> 00:28:10,480
like asking for trouble there and but

687
00:28:08,920 --> 00:28:12,510
you know you could definitely just the

688
00:28:10,480 --> 00:28:15,730
pillage assets which station is a full

689
00:28:12,510 --> 00:28:17,500
hardening guide on Microsoft's technical

690
00:28:15,730 --> 00:28:19,630
articles and they have like a level 1 to

691
00:28:17,500 --> 00:28:21,310
5 and level 5 is a privileged access

692
00:28:19,630 --> 00:28:23,290
workstation and it's got all the Greek

693
00:28:21,310 --> 00:28:25,450
policies in there and then it's good to

694
00:28:23,290 --> 00:28:27,629
you the bases just roll that out and

695
00:28:25,450 --> 00:28:31,470
it's got all the guides on how to orbit

696
00:28:27,630 --> 00:28:31,470
is that answer your question

697
00:28:32,810 --> 00:28:35,970
[Music]

698
00:28:45,489 --> 00:28:51,619
so with you read the forest you saw that

699
00:28:49,179 --> 00:28:52,999
you're making like a Bastian forest now

700
00:28:51,619 --> 00:28:54,230
so you do know all the extra hardening

701
00:28:52,999 --> 00:28:55,820
you're doing approved access

702
00:28:54,230 --> 00:28:59,330
workstations cause I thought that sort

703
00:28:55,820 --> 00:29:00,590
of hand in hand with it and and it's it

704
00:28:59,330 --> 00:29:02,029
is just that pointer

705
00:29:00,590 --> 00:29:03,470
I want my trust in with you and you're

706
00:29:02,029 --> 00:29:05,090
doing it in a way that you're making it

707
00:29:03,470 --> 00:29:06,350
more secure which is why Microsoft like

708
00:29:05,090 --> 00:29:07,369
ordered them read for it so it's not

709
00:29:06,350 --> 00:29:09,139
just like the one waitress that you're

710
00:29:07,369 --> 00:29:11,600
putting more a lot more effort into

711
00:29:09,139 --> 00:29:13,279
doing it you're also doing the tiers so

712
00:29:11,600 --> 00:29:14,418
you put one my trust in and you just

713
00:29:13,279 --> 00:29:15,559
have you get to some domain admin side

714
00:29:14,419 --> 00:29:17,389
over here but what they have to done

715
00:29:15,559 --> 00:29:18,980
with the preference got concepts like

716
00:29:17,389 --> 00:29:20,570
you're adding it tears in so you got

717
00:29:18,980 --> 00:29:23,029
your tier 0 for any domain controllers

718
00:29:20,570 --> 00:29:30,619
you tier ones via servers and you to

719
00:29:23,029 --> 00:29:33,019
choose view workstations it's an

720
00:29:30,619 --> 00:29:34,639
approach so the the functionality that

721
00:29:33,019 --> 00:29:37,789
you need is that shadow principles and

722
00:29:34,639 --> 00:29:39,678
you come in 2016 which is why the red

723
00:29:37,789 --> 00:29:41,480
forest has to be a 2016 because a lot of

724
00:29:39,679 --> 00:29:43,669
the features to do all the Trust's and

725
00:29:41,480 --> 00:29:46,909
the put and they and the shadow did the

726
00:29:43,669 --> 00:29:48,619
shadow principles only in 2016 and so

727
00:29:46,909 --> 00:29:51,739
that's that's the thing that comes along

728
00:29:48,619 --> 00:29:53,809
but it's more of a concept and more game

729
00:29:51,739 --> 00:29:55,489
admins not to be lazy anymore you know

730
00:29:53,809 --> 00:29:57,440
don't just log into everything with da

731
00:29:55,489 --> 00:29:59,239
logging you know make sure you use your

732
00:29:57,440 --> 00:30:00,440
tier 2 accounts and there's a lot of

733
00:29:59,239 --> 00:30:03,409
orders then you'll have to do the start

734
00:30:00,440 --> 00:30:07,100
to say why did you log into that domain

735
00:30:03,409 --> 00:30:08,869
controller with eater to account or why

736
00:30:07,100 --> 00:30:10,850
did you try to do that because it's less

737
00:30:08,869 --> 00:30:12,080
than credentials manner and so it's more

738
00:30:10,850 --> 00:30:13,699
of a concept and lots of other things so

739
00:30:12,080 --> 00:30:16,330
there's not to me and you stuff it's

740
00:30:13,700 --> 00:30:37,210
just a functionality side on one on side

741
00:30:16,330 --> 00:30:39,918
yeah questions yeah we're going free

742
00:30:37,210 --> 00:30:40,999
yeah so that's the principle that most

743
00:30:39,919 --> 00:30:41,359
people are following is to fit is to

744
00:30:40,999 --> 00:30:42,919
make

745
00:30:41,359 --> 00:30:46,399
exchange treat it like a domain

746
00:30:42,919 --> 00:30:47,749
controller because of these these these

747
00:30:46,399 --> 00:30:50,539
grew these special groups that creates

748
00:30:47,749 --> 00:30:51,610
that don't move over and they just treat

749
00:30:50,539 --> 00:30:54,250
them up it'll make the chore

750
00:30:51,610 --> 00:31:02,169
you probably can get da from exchange

751
00:30:54,250 --> 00:31:05,140
sir yeah and so you can probably pull

752
00:31:02,170 --> 00:31:07,390
out the logs using your conventional

753
00:31:05,140 --> 00:31:10,120
system if they're gonna poke a firewall

754
00:31:07,390 --> 00:31:13,090
hole just to pull out your logs should

755
00:31:10,120 --> 00:31:32,290
be the end of the world so you wouldn't

756
00:31:13,090 --> 00:31:34,629
need to produce it so you've got you've

757
00:31:32,290 --> 00:31:36,280
got all your log it happening on one

758
00:31:34,630 --> 00:31:37,480
side well there should be no credential

759
00:31:36,280 --> 00:31:49,510
you should use Windows Event log there

760
00:31:37,480 --> 00:31:50,679
have been some doubt and you see

761
00:31:49,510 --> 00:31:53,290
logarithm would sit on your production

762
00:31:50,679 --> 00:31:54,580
side not in your red forest you could

763
00:31:53,290 --> 00:31:56,110
you could you could build a separate

764
00:31:54,580 --> 00:31:57,639
same instance if he wanted to but it's

765
00:31:56,110 --> 00:31:59,260
got to eventually talk to a stock so

766
00:31:57,640 --> 00:32:01,840
it's got to be a little bit compromised

767
00:31:59,260 --> 00:32:03,429
on file rules to allow you know stuff to

768
00:32:01,840 --> 00:32:05,020
get out to get to where it's at your

769
00:32:03,429 --> 00:32:06,970
location as long as you've you know lock

770
00:32:05,020 --> 00:32:08,679
down the source destination and ports it

771
00:32:06,970 --> 00:32:13,570
should be shrinking the attack surface

772
00:32:08,679 --> 00:32:34,809
to like it's already going to see well

773
00:32:13,570 --> 00:32:46,780
finish thank you very much yes we thing

774
00:32:34,809 --> 00:32:48,070
to do certificate stuff as well yes as I

775
00:32:46,780 --> 00:32:49,480
said in like one of the things is to

776
00:32:48,070 --> 00:32:51,309
make sure your clients not got all the

777
00:32:49,480 --> 00:32:52,870
general you don't want to build this

778
00:32:51,309 --> 00:32:55,450
right amazing thing was something even

779
00:32:52,870 --> 00:32:56,949
still like you know ms 1710 the entire

780
00:32:55,450 --> 00:32:58,780
network because they're just gonna go

781
00:32:56,950 --> 00:32:59,860
around attack the whole network and go I

782
00:32:58,780 --> 00:33:00,070
didn't need to may not me because I

783
00:32:59,860 --> 00:33:01,449
could

784
00:33:00,070 --> 00:33:04,030
and everything all you know a shared

785
00:33:01,450 --> 00:33:05,920
password or a horrible open share the

786
00:33:04,030 --> 00:33:07,270
red forest is a bit like open fix open

787
00:33:05,920 --> 00:33:08,680
shares you need to go away and make sure

788
00:33:07,270 --> 00:33:09,550
you you know you get away with all stuff

789
00:33:08,680 --> 00:33:11,080
but you're right you want you want the

790
00:33:09,550 --> 00:33:12,760
low-hanging fruit to go away and then

791
00:33:11,080 --> 00:33:15,810
sit even make it even harder so it was

792
00:33:12,760 --> 00:33:15,810
to get like a beacon on a host

