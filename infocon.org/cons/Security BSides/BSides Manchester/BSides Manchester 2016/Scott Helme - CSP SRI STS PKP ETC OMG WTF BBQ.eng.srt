1
00:00:04,910 --> 00:00:09,840
so thanks very much having me<font color="#E5E5E5"> and my</font>

2
00:00:08,039 --> 00:00:11,100
cocktail today I can't take<font color="#E5E5E5"> credit for</font>

3
00:00:09,840 --> 00:00:12,840
the title<font color="#E5E5E5"> actually it was someone else's</font>

4
00:00:11,100 --> 00:00:15,149
idea but it does represent<font color="#E5E5E5"> kind of what</font>

5
00:00:12,840 --> 00:00:17,220
I want to talk<font color="#CCCCCC"> about in that kind of</font>

6
00:00:15,150 --> 00:00:19,259
nice version of this title would<font color="#CCCCCC"> be I</font>

7
00:00:17,220 --> 00:00:21,119
guess modern browser security features

8
00:00:19,259 --> 00:00:23,039
and one of the biggest problems I see

9
00:00:21,119 --> 00:00:25,830
when working with organizations is that

10
00:00:23,039 --> 00:00:26,970
often people<font color="#E5E5E5"> just don't know about all</font>

11
00:00:25,830 --> 00:00:28,109
of these acronyms we do have these

12
00:00:26,970 --> 00:00:29,310
technologies to help us secure our

13
00:00:28,109 --> 00:00:31,259
websites but people just don't<font color="#E5E5E5"> know</font>

14
00:00:29,310 --> 00:00:33,720
<font color="#CCCCCC">about them so I want</font><font color="#E5E5E5"> to do today</font><font color="#CCCCCC"> is kind</font>

15
00:00:31,259 --> 00:00:34,949
of a high-level introduction to some of

16
00:00:33,720 --> 00:00:36,600
these technologies<font color="#CCCCCC"> to tell you about</font>

17
00:00:34,949 --> 00:00:38,219
<font color="#E5E5E5">them we're not going</font><font color="#CCCCCC"> to go into them too</font>

18
00:00:36,600 --> 00:00:40,050
deeply but what I want<font color="#E5E5E5"> you to do is</font><font color="#CCCCCC"> to</font>

19
00:00:38,219 --> 00:00:41,670
go away and<font color="#CCCCCC"> think perhaps this could</font>

20
00:00:40,050 --> 00:00:45,089
help me perhaps we could<font color="#E5E5E5"> deploy this on</font>

21
00:00:41,670 --> 00:00:47,430
our site and the technologies I'm going

22
00:00:45,090 --> 00:00:51,149
to talk<font color="#E5E5E5"> about today I see is kind of the</font>

23
00:00:47,430 --> 00:00:52,379
evolution of how<font color="#E5E5E5"> security has evolved on</font>

24
00:00:51,149 --> 00:00:53,550
the<font color="#E5E5E5"> web sorry so we have typical</font>

25
00:00:52,379 --> 00:00:56,608
browsing scenario we have the browser

26
00:00:53,550 --> 00:00:58,890
talking to us so throughout the demo we

27
00:00:56,609 --> 00:01:02,070
or iOS is the<font color="#E5E5E5"> whole</font><font color="#CCCCCC"> stat so</font><font color="#E5E5E5"> we're trying</font>

28
00:00:58,890 --> 00:01:03,690
<font color="#CCCCCC">to protect our site and historically a</font>

29
00:01:02,070 --> 00:01:06,000
lot of our effort was focused on kind of

30
00:01:03,690 --> 00:01:08,160
securing the server so we patch r OS and

31
00:01:06,000 --> 00:01:10,110
our applications we make sure that only

32
00:01:08,160 --> 00:01:11,490
the correct people<font color="#E5E5E5"> have access to the</font>

33
00:01:10,110 --> 00:01:13,020
servers and there's<font color="#E5E5E5"> lots of things that</font>

34
00:01:11,490 --> 00:01:16,979
we can kind of do this end of the

35
00:01:13,020 --> 00:01:18,690
<font color="#CCCCCC">conversation and as time has gone by our</font>

36
00:01:16,980 --> 00:01:20,520
responsibility as the<font color="#E5E5E5"> host is expanded</font>

37
00:01:18,690 --> 00:01:21,360
out into the transport layer I'm sure

38
00:01:20,520 --> 00:01:23,759
all of<font color="#E5E5E5"> you heard of the Snowden</font>

39
00:01:21,360 --> 00:01:25,320
revelations and the huge push to

40
00:01:23,760 --> 00:01:27,870
encryption basically as a result of that

41
00:01:25,320 --> 00:01:29,369
in fact<font color="#E5E5E5"> I publish some research recently</font>

42
00:01:27,870 --> 00:01:30,660
that shows<font color="#CCCCCC"> that encryption is being</font>

43
00:01:29,370 --> 00:01:33,180
adopted on the web<font color="#CCCCCC"> now at a rate that</font>

44
00:01:30,660 --> 00:01:35,250
we've<font color="#E5E5E5"> never</font><font color="#CCCCCC"> seen in history so we are</font>

45
00:01:33,180 --> 00:01:36,540
extending our<font color="#E5E5E5"> responsibility kind of out</font>

46
00:01:35,250 --> 00:01:38,700
into the transport layer and we're now

47
00:01:36,540 --> 00:01:40,740
enforcing our security requirements

48
00:01:38,700 --> 00:01:41,820
there as well and what we do with the

49
00:01:40,740 --> 00:01:42,960
technologies that i'm talking about

50
00:01:41,820 --> 00:01:44,729
today's we're actually going to take

51
00:01:42,960 --> 00:01:46,020
that<font color="#E5E5E5"> one</font><font color="#CCCCCC"> step further and what we're</font>

52
00:01:44,730 --> 00:01:48,510
<font color="#CCCCCC">doing is we're actually reaching out</font>

53
00:01:46,020 --> 00:01:50,759
into the browser in an effort to secure

54
00:01:48,510 --> 00:01:52,620
this whole conversation end to end and

55
00:01:50,760 --> 00:01:54,690
we can actually control certain features

56
00:01:52,620 --> 00:01:56,250
<font color="#CCCCCC">of the browser we can configure options</font>

57
00:01:54,690 --> 00:01:58,770
within the browser and in some scenarios

58
00:01:56,250 --> 00:02:00,270
we can actually override the user if the

59
00:01:58,770 --> 00:02:01,410
user is doing something<font color="#E5E5E5"> that would be</font>

60
00:02:00,270 --> 00:02:03,210
<font color="#E5E5E5">dangerous we can actually override the</font>

61
00:02:01,410 --> 00:02:04,890
action and enforce our preferred action

62
00:02:03,210 --> 00:02:06,630
so we're basically bringing the browser

63
00:02:04,890 --> 00:02:09,119
on to our team<font color="#E5E5E5"> and it's now going to be</font>

64
00:02:06,630 --> 00:02:11,510
<font color="#CCCCCC">working alongside us to secure this</font>

65
00:02:09,119 --> 00:02:13,620
entire conversation

66
00:02:11,510 --> 00:02:15,090
now one of the things it usually happens

67
00:02:13,620 --> 00:02:16,800
when<font color="#E5E5E5"> I</font><font color="#CCCCCC"> talk about</font><font color="#E5E5E5"> all some</font><font color="#CCCCCC"> new browser</font>

68
00:02:15,090 --> 00:02:18,270
security features is that people kind of

69
00:02:16,800 --> 00:02:20,100
off for<font color="#CCCCCC"> all their eyes and think yeah</font>

70
00:02:18,270 --> 00:02:22,770
okay listen you know I bet browser

71
00:02:20,100 --> 00:02:24,600
support is terrible but browser support

72
00:02:22,770 --> 00:02:26,370
<font color="#E5E5E5">isn't terrible all the features that I'm</font>

73
00:02:24,600 --> 00:02:28,140
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> here do have pretty</font>

74
00:02:26,370 --> 00:02:29,910
mainstream support across the<font color="#E5E5E5"> browsers</font>

75
00:02:28,140 --> 00:02:31,290
I'm sure I don't need to<font color="#CCCCCC"> tell any of you</font>

76
00:02:29,910 --> 00:02:33,150
that support is better that into the

77
00:02:31,290 --> 00:02:35,429
slide than this end that's<font color="#E5E5E5"> just a given</font>

78
00:02:33,150 --> 00:02:36,870
but in a lot of the scenarios it doesn't

79
00:02:35,430 --> 00:02:38,910
<font color="#E5E5E5">actually matter it doesn't matter if</font>

80
00:02:36,870 --> 00:02:40,080
browser support isn't<font color="#E5E5E5"> widely spread you</font>

81
00:02:38,910 --> 00:02:41,190
know some of these technologies<font color="#CCCCCC"> I don't</font>

82
00:02:40,080 --> 00:02:42,570
have come about fifty sixty percent

83
00:02:41,190 --> 00:02:44,340
coverage<font color="#CCCCCC"> and mainstream browsers right</font>

84
00:02:42,570 --> 00:02:46,230
now but it<font color="#E5E5E5"> doesn't matter because the</font>

85
00:02:44,340 --> 00:02:48,090
<font color="#CCCCCC">browser's</font><font color="#E5E5E5"> at the support them well honor</font>

86
00:02:46,230 --> 00:02:50,220
them will do what they say will will act

87
00:02:48,090 --> 00:02:51,420
more securely and the browsers that

88
00:02:50,220 --> 00:02:53,370
don't support them will just carry on as

89
00:02:51,420 --> 00:02:54,720
they do now so we<font color="#E5E5E5"> can deploy these</font>

90
00:02:53,370 --> 00:02:57,030
things and it's only going to get better

91
00:02:54,720 --> 00:02:58,170
with time as support gets better and for

92
00:02:57,030 --> 00:02:59,370
<font color="#E5E5E5">one of them i'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk about we</font>

93
00:02:58,170 --> 00:03:04,530
can<font color="#CCCCCC"> actually protect people that don't</font>

94
00:02:59,370 --> 00:03:06,330
support it so the first three acronyms

95
00:03:04,530 --> 00:03:08,370
that i want to<font color="#CCCCCC"> talk about are what i</font>

96
00:03:06,330 --> 00:03:10,080
refer to as a set of security headers so

97
00:03:08,370 --> 00:03:11,250
<font color="#CCCCCC">i'm going</font><font color="#E5E5E5"> to look specifically at the</font>

98
00:03:10,080 --> 00:03:13,140
three down<font color="#E5E5E5"> the</font><font color="#CCCCCC"> left-hand side we've got</font>

99
00:03:11,250 --> 00:03:14,160
content security policy if you see me

100
00:03:13,140 --> 00:03:16,890
online you'll know I'm<font color="#E5E5E5"> a huge advocate</font>

101
00:03:14,160 --> 00:03:19,560
of CSP we've got public key pins are

102
00:03:16,890 --> 00:03:21,510
public keep inning and then strict

103
00:03:19,560 --> 00:03:25,290
Transport Security so these<font color="#E5E5E5"> are the CSP</font>

104
00:03:21,510 --> 00:03:27,179
pkp and<font color="#CCCCCC"> sts acronyms from my slide title</font>

105
00:03:25,290 --> 00:03:28,170
there are some of the security head is

106
00:03:27,180 --> 00:03:29,580
down the<font color="#CCCCCC"> right-hand</font><font color="#E5E5E5"> side</font><font color="#CCCCCC"> i'm going to</font>

107
00:03:28,170 --> 00:03:31,230
make the slides available after my talk

108
00:03:29,580 --> 00:03:33,090
so if you want to<font color="#E5E5E5"> have a look into some</font>

109
00:03:31,230 --> 00:03:34,170
more of these I've listed them up there

110
00:03:33,090 --> 00:03:35,790
as well to<font color="#E5E5E5"> see you can kind of go away</font>

111
00:03:34,170 --> 00:03:37,619
and do additional research on them as

112
00:03:35,790 --> 00:03:38,910
<font color="#CCCCCC">well but</font><font color="#E5E5E5"> I'm going to start with</font>

113
00:03:37,620 --> 00:03:42,300
something called content security policy

114
00:03:38,910 --> 00:03:44,070
and content security policy was

115
00:03:42,300 --> 00:03:45,750
originally<font color="#E5E5E5"> created to stop something</font>

116
00:03:44,070 --> 00:03:47,549
called the content injection attack or

117
00:03:45,750 --> 00:03:50,400
basically<font color="#E5E5E5"> to stop bad people putting bad</font>

118
00:03:47,550 --> 00:03:51,540
things into our websites and this is an

119
00:03:50,400 --> 00:03:53,400
example<font color="#CCCCCC"> of what a cross-site scripting</font>

120
00:03:51,540 --> 00:03:55,350
attack might look like we've got<font color="#CCCCCC"> some</font>

121
00:03:53,400 --> 00:03:57,390
HTML up there it's one<font color="#E5E5E5"> of our web pages</font>

122
00:03:55,350 --> 00:03:59,160
<font color="#CCCCCC">we don't</font><font color="#E5E5E5"> know how it doesn't matter how</font>

123
00:03:57,390 --> 00:04:00,630
but an attackers got a script tag into

124
00:03:59,160 --> 00:04:03,150
our page and<font color="#E5E5E5"> it's going</font><font color="#CCCCCC"> to load a</font>

125
00:04:00,630 --> 00:04:04,590
keylogger file into our page this<font color="#E5E5E5"> is a</font>

126
00:04:03,150 --> 00:04:06,150
cross-site scripting attack and this is

127
00:04:04,590 --> 00:04:09,030
basically<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the main things that</font>

128
00:04:06,150 --> 00:04:12,209
CSP was created to try and fight to<font color="#E5E5E5"> try</font>

129
00:04:09,030 --> 00:04:14,220
and mitigate and CSP itself like<font color="#E5E5E5"> I said</font>

130
00:04:12,209 --> 00:04:15,930
is just<font color="#CCCCCC"> a HTTP response header so if</font>

131
00:04:14,220 --> 00:04:17,608
you're<font color="#E5E5E5"> familiar with HTTP requests and</font>

132
00:04:15,930 --> 00:04:18,989
responses you'll know what response

133
00:04:17,608 --> 00:04:21,570
headers are and you can see content

134
00:04:18,988 --> 00:04:22,799
security policy is there just issued as

135
00:04:21,570 --> 00:04:25,440
another response header with the

136
00:04:22,800 --> 00:04:27,810
response so this is<font color="#CCCCCC"> all we need to do</font>

137
00:04:25,440 --> 00:04:29,460
as a host to enable CSP protection we

138
00:04:27,810 --> 00:04:31,050
just issue the CSP response header

139
00:04:29,460 --> 00:04:32,789
there's no particularly technical

140
00:04:31,050 --> 00:04:34,740
configuration to do we just issue the

141
00:04:32,790 --> 00:04:37,860
header and put the policy in that we

142
00:04:34,740 --> 00:04:39,870
want the browser to enforce now building

143
00:04:37,860 --> 00:04:41,340
<font color="#E5E5E5">the policy itself can sometimes be a</font>

144
00:04:39,870 --> 00:04:42,720
little bit tricky it can be harder than

145
00:04:41,340 --> 00:04:45,450
legacy applications but we have some

146
00:04:42,720 --> 00:04:47,610
<font color="#E5E5E5">things</font><font color="#CCCCCC"> that can help us out now the</font>

147
00:04:45,450 --> 00:04:49,530
policy itself is built of one or<font color="#CCCCCC"> more of</font>

148
00:04:47,610 --> 00:04:51,270
what<font color="#CCCCCC"> we call the CSP directives and</font>

149
00:04:49,530 --> 00:04:53,729
these basically are where<font color="#CCCCCC"> we start to</font>

150
00:04:51,270 --> 00:04:54,810
control the actions of the browsers the

151
00:04:53,730 --> 00:04:56,460
ones<font color="#E5E5E5"> I'm showing on the screen at the</font>

152
00:04:54,810 --> 00:04:58,530
<font color="#E5E5E5">minute are probably about a third of the</font>

153
00:04:56,460 --> 00:05:00,150
directives that are available<font color="#E5E5E5"> and there</font>

154
00:04:58,530 --> 00:05:01,619
were<font color="#E5E5E5"> I refer to</font><font color="#CCCCCC"> as the fetch directives</font>

155
00:05:00,150 --> 00:05:02,820
these are the ones that control<font color="#E5E5E5"> the</font>

156
00:05:01,620 --> 00:05:05,010
actions<font color="#CCCCCC"> at the</font><font color="#E5E5E5"> browser when it's going</font>

157
00:05:02,820 --> 00:05:07,230
<font color="#E5E5E5">out to fetch some kind of content to</font>

158
00:05:05,010 --> 00:05:09,570
bring back and put into<font color="#CCCCCC"> our pages and</font>

159
00:05:07,230 --> 00:05:11,010
they're fairly kind of the fairly

160
00:05:09,570 --> 00:05:13,050
self-explanatory so we have any sauce in

161
00:05:11,010 --> 00:05:14,550
the top right that details and list the

162
00:05:13,050 --> 00:05:16,890
locations the browser is permitted to

163
00:05:14,550 --> 00:05:18,510
load images from we've got the font

164
00:05:16,890 --> 00:05:20,250
sauce so you specify the font sauce

165
00:05:18,510 --> 00:05:23,610
directed and list the locations<font color="#E5E5E5"> that the</font>

166
00:05:20,250 --> 00:05:24,660
browser is allowed to load funds from so

167
00:05:23,610 --> 00:05:25,950
to show you what this looks like I've

168
00:05:24,660 --> 00:05:28,980
put together pretty much<font color="#E5E5E5"> the most basic</font>

169
00:05:25,950 --> 00:05:30,419
<font color="#E5E5E5">CSP but I can kind of think of so we</font>

170
00:05:28,980 --> 00:05:32,370
issue the content security policy header

171
00:05:30,419 --> 00:05:34,020
I put the default sauce in there that

172
00:05:32,370 --> 00:05:35,280
was on the previous slide every director

173
00:05:34,020 --> 00:05:37,109
on<font color="#E5E5E5"> the previous slide falls back to</font>

174
00:05:35,280 --> 00:05:38,250
<font color="#E5E5E5">default if it's not specified so you can</font>

175
00:05:37,110 --> 00:05:40,200
be a little bit<font color="#E5E5E5"> more relaxed in your</font>

176
00:05:38,250 --> 00:05:42,450
policy creation and I've<font color="#CCCCCC"> just said</font>

177
00:05:40,200 --> 00:05:43,860
defaults or self so that means<font color="#CCCCCC"> that by</font>

178
00:05:42,450 --> 00:05:45,180
default the browser can load content

179
00:05:43,860 --> 00:05:48,570
from my domain that's<font color="#E5E5E5"> what the self</font>

180
00:05:45,180 --> 00:05:50,010
keyword does and cdnas<font color="#CCCCCC"> com so I'm saying</font>

181
00:05:48,570 --> 00:05:52,409
you are<font color="#E5E5E5"> only permitted to load content</font>

182
00:05:50,010 --> 00:05:54,020
from these two locations content is not

183
00:05:52,410 --> 00:05:57,090
<font color="#E5E5E5">allowed to</font><font color="#CCCCCC"> be loaded from anywhere else</font>

184
00:05:54,020 --> 00:05:58,950
going back to<font color="#CCCCCC"> our evil</font><font color="#E5E5E5"> com</font><font color="#CCCCCC"> jas keylogger</font>

185
00:05:57,090 --> 00:06:00,239
we saw a few slides ago evil dot coms

186
00:05:58,950 --> 00:06:02,130
<font color="#CCCCCC">that in the whitelist so the browser</font>

187
00:06:00,240 --> 00:06:03,210
would not load that script we've

188
00:06:02,130 --> 00:06:06,270
neutralized the cross-site scripting

189
00:06:03,210 --> 00:06:07,530
threat the problem is that<font color="#E5E5E5"> you wouldn't</font>

190
00:06:06,270 --> 00:06:09,270
actually be able<font color="#E5E5E5"> to deploy that on your</font>

191
00:06:07,530 --> 00:06:10,710
<font color="#E5E5E5">site because I'm sure all of you guys</font>

192
00:06:09,270 --> 00:06:12,240
like<font color="#E5E5E5"> me load content from about a</font>

193
00:06:10,710 --> 00:06:14,400
million different<font color="#E5E5E5"> locations and have all</font>

194
00:06:12,240 --> 00:06:17,580
kinds<font color="#E5E5E5"> of crap on</font><font color="#CCCCCC"> your website so we have</font>

195
00:06:14,400 --> 00:06:19,289
to kind<font color="#E5E5E5"> of fine tune our policies so</font>

196
00:06:17,580 --> 00:06:21,030
I've<font color="#E5E5E5"> taken that policy and I've just</font>

197
00:06:19,290 --> 00:06:23,160
fine-tuned it a little bit so by default

198
00:06:21,030 --> 00:06:25,409
i said i'm happy to load any content for

199
00:06:23,160 --> 00:06:27,150
myself and<font color="#E5E5E5"> I'm doing now is I'm adding</font>

200
00:06:25,410 --> 00:06:28,590
in<font color="#E5E5E5"> the script</font><font color="#CCCCCC"> source so when you define</font>

201
00:06:27,150 --> 00:06:30,599
a new policy directive like this you

202
00:06:28,590 --> 00:06:32,429
override the default so I've had<font color="#CCCCCC"> to</font>

203
00:06:30,600 --> 00:06:34,770
specify itself again so that<font color="#CCCCCC"> I can load</font>

204
00:06:32,430 --> 00:06:37,050
scripts<font color="#CCCCCC"> for</font><font color="#E5E5E5"> myself and I've put in the</font>

205
00:06:34,770 --> 00:06:38,909
<font color="#CCCCCC">cloud flare and Google CDN tins and what</font>

206
00:06:37,050 --> 00:06:40,770
that basically allows you to do<font color="#E5E5E5"> is</font>

207
00:06:38,910 --> 00:06:42,810
script tags on<font color="#CCCCCC"> your page like that so</font>

208
00:06:40,770 --> 00:06:44,549
the browser<font color="#E5E5E5"> will go through rendering</font>

209
00:06:42,810 --> 00:06:46,320
the page<font color="#E5E5E5"> it'll come across these script</font>

210
00:06:44,550 --> 00:06:48,420
tags and it will check the hosts in the

211
00:06:46,320 --> 00:06:50,280
script tags against the script directive

212
00:06:48,420 --> 00:06:51,480
in the header and if<font color="#CCCCCC"> that host is in the</font>

213
00:06:50,280 --> 00:06:52,830
header then<font color="#E5E5E5"> the browser will load the</font>

214
00:06:51,480 --> 00:06:55,430
script if it's not then the browser will

215
00:06:52,830 --> 00:06:57,659
<font color="#E5E5E5">block the script and it will not load it</font>

216
00:06:55,430 --> 00:06:59,820
so that's the scripts and you basically

217
00:06:57,660 --> 00:07:01,110
just kind of go on fine-tuning like this

218
00:06:59,820 --> 00:07:03,110
so you can see here we've got the script

219
00:07:01,110 --> 00:07:06,060
<font color="#CCCCCC">source style</font><font color="#E5E5E5"> black male of styles from</font>

220
00:07:03,110 --> 00:07:08,100
image source child sources for things

221
00:07:06,060 --> 00:07:09,450
like iframes<font color="#E5E5E5"> it go in bed like a YouTube</font>

222
00:07:08,100 --> 00:07:13,290
<font color="#E5E5E5">video or something they typically come</font>

223
00:07:09,450 --> 00:07:14,430
in<font color="#E5E5E5"> I frames and you just kind of go</font>

224
00:07:13,290 --> 00:07:16,740
through<font color="#CCCCCC"> all of your content and white</font>

225
00:07:14,430 --> 00:07:18,660
list the locations<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> expect to</font>

226
00:07:16,740 --> 00:07:20,010
load content from and by white listing

227
00:07:18,660 --> 00:07:21,960
the locations that<font color="#E5E5E5"> we do want to load</font>

228
00:07:20,010 --> 00:07:23,039
content from we can stop content from

229
00:07:21,960 --> 00:07:26,039
being low different locations that we

230
00:07:23,040 --> 00:07:27,810
don't<font color="#E5E5E5"> want it to be lowly from so</font><font color="#CCCCCC"> this</font>

231
00:07:26,040 --> 00:07:29,130
<font color="#CCCCCC">is</font><font color="#E5E5E5"> a this is like one of the first</font>

232
00:07:27,810 --> 00:07:30,360
aspect<font color="#E5E5E5"> of CSP this is where the browser</font>

233
00:07:29,130 --> 00:07:33,659
actually goes out to<font color="#E5E5E5"> kind of fetch</font>

234
00:07:30,360 --> 00:07:35,880
content and bring it<font color="#CCCCCC"> back but there are</font>

235
00:07:33,660 --> 00:07:37,320
a lot more directed in CSP as i said i

236
00:07:35,880 --> 00:07:39,570
<font color="#E5E5E5">think the ones i showed earlier about a</font>

237
00:07:37,320 --> 00:07:41,460
third so I've kind of cherry picked

238
00:07:39,570 --> 00:07:42,570
another few here again we're not we're

239
00:07:41,460 --> 00:07:44,460
not going to<font color="#E5E5E5"> get full coverage in the</font>

240
00:07:42,570 --> 00:07:46,349
talk like this I need<font color="#E5E5E5"> the full slot to</font>

241
00:07:44,460 --> 00:07:49,229
talk<font color="#E5E5E5"> about just CSP and probably more</font>

242
00:07:46,350 --> 00:07:52,110
time so i chafe it these<font color="#CCCCCC"> 16 i quite like</font>

243
00:07:49,230 --> 00:07:55,169
these and<font color="#E5E5E5"> i really like the form action</font>

244
00:07:52,110 --> 00:07:56,250
directive now the form action directive

245
00:07:55,169 --> 00:07:57,840
which really kind of does what it says

246
00:07:56,250 --> 00:07:59,970
on<font color="#CCCCCC"> the tin again it controls where the</font>

247
00:07:57,840 --> 00:08:02,090
action for any form on<font color="#CCCCCC"> your site is</font>

248
00:07:59,970 --> 00:08:04,110
allowed<font color="#CCCCCC"> to post to and I don't know why</font>

249
00:08:02,090 --> 00:08:05,789
every time on the planet isn't using

250
00:08:04,110 --> 00:08:07,140
this because the one thing<font color="#CCCCCC"> that we</font>

251
00:08:05,790 --> 00:08:09,300
definitely<font color="#CCCCCC"> don't want to</font><font color="#E5E5E5"> happen on our</font>

252
00:08:07,140 --> 00:08:11,190
website is for a<font color="#E5E5E5"> login form to post</font>

253
00:08:09,300 --> 00:08:13,110
somewhere else when your users come to

254
00:08:11,190 --> 00:08:15,030
your website they type in their username

255
00:08:13,110 --> 00:08:17,010
and password and they hit submit do you

256
00:08:15,030 --> 00:08:18,599
actually want that form to be<font color="#CCCCCC"> able to</font>

257
00:08:17,010 --> 00:08:20,580
send that username and password

258
00:08:18,600 --> 00:08:21,870
elsewhere hopefully the<font color="#E5E5E5"> answer to</font><font color="#CCCCCC"> that</font>

259
00:08:20,580 --> 00:08:23,490
is no I always<font color="#E5E5E5"> want the username and</font>

260
00:08:21,870 --> 00:08:25,320
<font color="#E5E5E5">password to come to me and that's what</font>

261
00:08:23,490 --> 00:08:27,180
the formation directive does it stays to

262
00:08:25,320 --> 00:08:28,740
<font color="#CCCCCC">the browser these are the only locations</font>

263
00:08:27,180 --> 00:08:31,380
that you're allowed to send form data a

264
00:08:28,740 --> 00:08:32,700
CSP is issued on a per page basis you

265
00:08:31,380 --> 00:08:34,710
issue is a response header so you could

266
00:08:32,700 --> 00:08:36,719
<font color="#E5E5E5">just lock this down on your login page</font>

267
00:08:34,710 --> 00:08:39,800
if<font color="#CCCCCC"> you have forms elsewhere that are</font>

268
00:08:36,719 --> 00:08:42,270
supposed to<font color="#E5E5E5"> post the</font><font color="#CCCCCC"> third party domains</font>

269
00:08:39,799 --> 00:08:44,339
we have the frame ancestors directive

270
00:08:42,270 --> 00:08:46,560
some of you<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> philly familiar with</font>

271
00:08:44,340 --> 00:08:48,030
the the<font color="#E5E5E5"> x frame options header which</font>

272
00:08:46,560 --> 00:08:49,800
controls whether or not your site is

273
00:08:48,030 --> 00:08:51,660
allowed<font color="#CCCCCC"> to be framed by other sites so</font>

274
00:08:49,800 --> 00:08:52,529
can somebody load my site in an iframe

275
00:08:51,660 --> 00:08:53,519
in their side

276
00:08:52,529 --> 00:08:56,639
it's quite often you things like

277
00:08:53,519 --> 00:08:58,439
clickjacking attacks so if somebody on

278
00:08:56,639 --> 00:09:00,660
my site with frame ancestors if somebody

279
00:08:58,439 --> 00:09:02,189
put this iframe into their page and try

280
00:09:00,660 --> 00:09:03,810
<font color="#E5E5E5">to load my site in an iframe in their</font>

281
00:09:02,189 --> 00:09:05,579
page the browser would block it and<font color="#CCCCCC"> this</font>

282
00:09:03,810 --> 00:09:07,229
<font color="#E5E5E5">is what frame ancestors controls who is</font>

283
00:09:05,579 --> 00:09:09,149
allowed to<font color="#E5E5E5"> frame you and it's a lot</font><font color="#CCCCCC"> more</font>

284
00:09:07,230 --> 00:09:10,740
flexible than the x fo header<font color="#E5E5E5"> because</font>

285
00:09:09,149 --> 00:09:12,809
the x fo header is<font color="#E5E5E5"> an</font><font color="#CCCCCC"> on/off</font><font color="#E5E5E5"> setting</font>

286
00:09:10,740 --> 00:09:14,579
with CSP<font color="#E5E5E5"> and frame ancestors you can</font>

287
00:09:12,809 --> 00:09:16,439
actually whitelist maybe there are three

288
00:09:14,579 --> 00:09:18,959
websites that you're happy<font color="#E5E5E5"> to frame you</font>

289
00:09:16,439 --> 00:09:20,610
and then go others so you can you can

290
00:09:18,959 --> 00:09:23,008
have more flexibility they say this

291
00:09:20,610 --> 00:09:26,269
effectively deprecates x fo although<font color="#CCCCCC"> not</font>

292
00:09:23,009 --> 00:09:29,579
officially it's both are still supported

293
00:09:26,269 --> 00:09:31,529
and these two I really like blah comics

294
00:09:29,579 --> 00:09:34,680
content and or grading secure requests

295
00:09:31,529 --> 00:09:36,029
if you serve your site / https<font color="#CCCCCC"> I'm sure</font>

296
00:09:34,680 --> 00:09:38,609
many of you know<font color="#CCCCCC"> about something</font><font color="#E5E5E5"> called</font>

297
00:09:36,029 --> 00:09:40,709
mixed<font color="#E5E5E5"> content you have</font><font color="#CCCCCC"> a https page and</font>

298
00:09:38,610 --> 00:09:41,790
it tries to load a HTTP i set the

299
00:09:40,709 --> 00:09:43,170
browser<font color="#E5E5E5"> will throw up some kind of</font>

300
00:09:41,790 --> 00:09:44,610
warning it will say there's mixed

301
00:09:43,170 --> 00:09:46,579
content on this page it's a bad thing

302
00:09:44,610 --> 00:09:49,889
and it results in a bad user experience

303
00:09:46,579 --> 00:09:51,359
so on my<font color="#E5E5E5"> https site we're loading this</font>

304
00:09:49,889 --> 00:09:54,420
asset it's an image target it's got a

305
00:09:51,360 --> 00:09:56,939
HTTP source and you can use one of these

306
00:09:54,420 --> 00:09:58,649
two directives the first one<font color="#E5E5E5"> blah comics</font>

307
00:09:56,939 --> 00:10:01,889
content kind of does what it says on the

308
00:09:58,649 --> 00:10:03,300
<font color="#E5E5E5">tin it will see this HTTP source and it</font>

309
00:10:01,889 --> 00:10:05,069
will<font color="#E5E5E5"> block the image it</font><font color="#CCCCCC"> will say that's</font>

310
00:10:03,300 --> 00:10:06,899
that's mixed content I'm<font color="#CCCCCC"> just going to</font>

311
00:10:05,069 --> 00:10:08,579
block it and not load it what I prefer

312
00:10:06,899 --> 00:10:10,589
<font color="#E5E5E5">and what I use is the</font><font color="#CCCCCC"> upgrade insecure</font>

313
00:10:08,579 --> 00:10:12,989
requests so the browser<font color="#E5E5E5"> will see this</font>

314
00:10:10,589 --> 00:10:15,089
HTTP asset but<font color="#E5E5E5"> before it tries to load</font>

315
00:10:12,990 --> 00:10:18,089
it it will switch the scheme to HTTPS

316
00:10:15,089 --> 00:10:19,680
and fetch it<font color="#E5E5E5"> over HTTPS instead so we've</font>

317
00:10:18,089 --> 00:10:20,939
avoided them mixed content warning it

318
00:10:19,680 --> 00:10:23,790
can't happen now because<font color="#CCCCCC"> the browser</font>

319
00:10:20,939 --> 00:10:25,680
<font color="#E5E5E5">will default to secure now we can't</font>

320
00:10:23,790 --> 00:10:28,050
<font color="#CCCCCC">guarantee that image is available over</font>

321
00:10:25,680 --> 00:10:29,969
HTTPS because this<font color="#CCCCCC"> particular website</font>

322
00:10:28,050 --> 00:10:31,709
might not have it but at least we've

323
00:10:29,970 --> 00:10:33,600
tried<font color="#E5E5E5"> to fix the problem rather than</font>

324
00:10:31,709 --> 00:10:38,699
just blocking it or getting<font color="#E5E5E5"> a mixed</font>

325
00:10:33,600 --> 00:10:41,069
content warning in the<font color="#E5E5E5"> browser one of</font>

326
00:10:38,699 --> 00:10:44,069
the one of<font color="#CCCCCC"> the things you may kind</font><font color="#E5E5E5"> of</font>

327
00:10:41,069 --> 00:10:45,329
picked up on the whole CSP thing is you

328
00:10:44,069 --> 00:10:47,399
do have the<font color="#E5E5E5"> ability to kind of break</font>

329
00:10:45,329 --> 00:10:49,290
your website if you accidentally you

330
00:10:47,399 --> 00:10:51,149
know<font color="#E5E5E5"> mix out some sources in your</font>

331
00:10:49,290 --> 00:10:52,498
JavaScript or your styles and you don't

332
00:10:51,149 --> 00:10:54,870
load your stylesheet so your<font color="#E5E5E5"> website's</font>

333
00:10:52,499 --> 00:10:57,449
going to look pretty enough so we have a

334
00:10:54,870 --> 00:10:59,999
way of testing CSP without any risk

335
00:10:57,449 --> 00:11:01,829
whatsoever and<font color="#E5E5E5"> what we do is</font><font color="#CCCCCC"> we we</font>

336
00:10:59,999 --> 00:11:03,000
eschew exactly the same policy but we

337
00:11:01,829 --> 00:11:04,829
<font color="#E5E5E5">just change the name of the header and</font>

338
00:11:03,000 --> 00:11:06,480
I'd report only to the end so what this

339
00:11:04,829 --> 00:11:08,219
does<font color="#E5E5E5"> it sends out to the browser</font>

340
00:11:06,480 --> 00:11:10,320
and it's a to the browser<font color="#E5E5E5"> I want you to</font>

341
00:11:08,220 --> 00:11:11,850
look at this policy<font color="#CCCCCC"> and it will pop</font>

342
00:11:10,320 --> 00:11:13,380
areas in the dev console for<font color="#CCCCCC"> any things</font>

343
00:11:11,850 --> 00:11:15,149
that breach it but without actually

344
00:11:13,380 --> 00:11:17,490
taking the blocking action on the page

345
00:11:15,149 --> 00:11:19,639
so if you've accidentally wiped out all

346
00:11:17,490 --> 00:11:21,779
of your JavaScript or all of your styles

347
00:11:19,639 --> 00:11:23,100
instead of<font color="#E5E5E5"> actually blocking it and</font>

348
00:11:21,779 --> 00:11:24,360
trashing your website it'll just pop an

349
00:11:23,100 --> 00:11:25,350
arrow in the dev console<font color="#CCCCCC"> we'll look</font><font color="#E5E5E5"> at</font>

350
00:11:24,360 --> 00:11:27,149
these more closer later don't worry

351
00:11:25,350 --> 00:11:28,949
about<font color="#E5E5E5"> reading it</font><font color="#CCCCCC"> so it's a way of</font>

352
00:11:27,149 --> 00:11:30,839
deploying it without the risk so you can

353
00:11:28,949 --> 00:11:32,819
<font color="#CCCCCC">open up your website</font><font color="#E5E5E5"> deploy the CSP</font>

354
00:11:30,839 --> 00:11:34,230
report only mode and fly around<font color="#CCCCCC"> and have</font>

355
00:11:32,820 --> 00:11:35,370
a<font color="#E5E5E5"> look for any areas coming up in the</font>

356
00:11:34,230 --> 00:11:36,779
dev console maybe you've missed

357
00:11:35,370 --> 00:11:38,310
something<font color="#E5E5E5"> and you just need to make an</font>

358
00:11:36,779 --> 00:11:41,070
addition to your white list or it could

359
00:11:38,310 --> 00:11:42,689
be a genuine problem the only problem

360
00:11:41,070 --> 00:11:43,829
with that is it<font color="#E5E5E5"> doesn't really scale if</font>

361
00:11:42,690 --> 00:11:45,540
I've worked with<font color="#E5E5E5"> a couple of media</font>

362
00:11:43,829 --> 00:11:49,229
organizations that have like fifteen

363
00:11:45,540 --> 00:11:53,189
thousand page back catalogs oh oh sweat

364
00:11:49,230 --> 00:11:54,570
rubbish and you know this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> like flying</font>

365
00:11:53,190 --> 00:11:55,920
<font color="#E5E5E5">around</font><font color="#CCCCCC"> with the dev console open trying</font>

366
00:11:54,570 --> 00:11:58,829
to find these areas<font color="#E5E5E5"> it's just not going</font>

367
00:11:55,920 --> 00:12:00,899
to work but CSP can fix that as well we

368
00:11:58,829 --> 00:12:02,189
<font color="#E5E5E5">have something</font><font color="#CCCCCC"> called CSP reporting so</font>

369
00:12:00,899 --> 00:12:03,750
if you look<font color="#E5E5E5"> at this</font><font color="#CCCCCC"> header we've</font><font color="#E5E5E5"> got</font>

370
00:12:02,190 --> 00:12:06,029
another directive in here on the second

371
00:12:03,750 --> 00:12:07,290
line called the report<font color="#CCCCCC"> URI directive and</font>

372
00:12:06,029 --> 00:12:09,870
what this does it saves to the browser

373
00:12:07,290 --> 00:12:11,310
if<font color="#E5E5E5"> you come across an error why would</font>

374
00:12:09,870 --> 00:12:13,440
like you to do is<font color="#E5E5E5"> send</font><font color="#CCCCCC"> me a book report</font>

375
00:12:11,310 --> 00:12:15,060
to the address that I've specified so

376
00:12:13,440 --> 00:12:16,470
you put report you Rin I run a service

377
00:12:15,060 --> 00:12:17,849
funnily enough cold report your eye

378
00:12:16,470 --> 00:12:20,160
which is<font color="#CCCCCC"> designed specifically to</font>

379
00:12:17,850 --> 00:12:22,079
collect these reports and if something

380
00:12:20,160 --> 00:12:24,630
violates the CSP the browser will<font color="#E5E5E5"> fire a</font>

381
00:12:22,079 --> 00:12:26,849
post with JSON payload that<font color="#E5E5E5"> contains all</font>

382
00:12:24,630 --> 00:12:28,139
<font color="#E5E5E5">the details of what went wrong so you</font>

383
00:12:26,850 --> 00:12:29,790
<font color="#CCCCCC">can see here I've got</font><font color="#E5E5E5"> an example JSON</font>

384
00:12:28,139 --> 00:12:31,980
payload it gives you the document URI

385
00:12:29,790 --> 00:12:33,870
which page did this violation<font color="#CCCCCC"> happen on</font>

386
00:12:31,980 --> 00:12:35,610
I want<font color="#E5E5E5"> to know where it happened what</font>

387
00:12:33,870 --> 00:12:37,529
was violated it was a script source in

388
00:12:35,610 --> 00:12:38,940
this particular case it gives you the

389
00:12:37,529 --> 00:12:40,860
original policy because you can issue

390
00:12:38,940 --> 00:12:42,420
customized<font color="#CCCCCC"> csps in different areas of</font>

391
00:12:40,860 --> 00:12:44,370
<font color="#E5E5E5">your site with more or less protection</font>

392
00:12:42,420 --> 00:12:45,689
so it gives you the original policy back

393
00:12:44,370 --> 00:12:48,690
to know what you were<font color="#CCCCCC"> working with and</font>

394
00:12:45,690 --> 00:12:50,760
the<font color="#CCCCCC"> block</font><font color="#E5E5E5"> you are I hear evil calm so I</font>

395
00:12:48,690 --> 00:12:52,529
now know that on that particular page on

396
00:12:50,760 --> 00:12:54,389
my<font color="#CCCCCC"> site</font><font color="#E5E5E5"> there was a script tag trying to</font>

397
00:12:52,529 --> 00:12:56,339
load content from evil calm and evil

398
00:12:54,389 --> 00:12:57,420
<font color="#CCCCCC">that come isn't</font><font color="#E5E5E5"> in my white list and</font>

399
00:12:56,339 --> 00:12:59,880
again if you look at the head of here

400
00:12:57,420 --> 00:13:01,500
it's still in report only mode so<font color="#E5E5E5"> you</font>

401
00:12:59,880 --> 00:13:03,360
can use this before you actually enforce

402
00:13:01,500 --> 00:13:05,250
it to get feedback<font color="#E5E5E5"> from your visitors</font>

403
00:13:03,360 --> 00:13:07,260
and you're basically<font color="#E5E5E5"> taking all of your</font>

404
00:13:05,250 --> 00:13:08,970
visitors browsers and turning them into

405
00:13:07,260 --> 00:13:11,279
tiny little Q a bar so they're actually

406
00:13:08,970 --> 00:13:12,810
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> go and QA your website and file</font>

407
00:13:11,279 --> 00:13:13,829
really nice bug reports and John

408
00:13:12,810 --> 00:13:17,369
<font color="#E5E5E5">couldn't even get me to do that when I</font>

409
00:13:13,829 --> 00:13:19,199
worked in with him so<font color="#E5E5E5"> it's you getting</font>

410
00:13:17,370 --> 00:13:20,400
freaky<font color="#CCCCCC"> where you can actually you know</font>

411
00:13:19,199 --> 00:13:22,079
turn your<font color="#CCCCCC"> browsers</font>

412
00:13:20,400 --> 00:13:23,400
visitors browsers into little Q a box

413
00:13:22,080 --> 00:13:27,870
and actually get them to do the legwork

414
00:13:23,400 --> 00:13:29,910
for you and there's a couple<font color="#E5E5E5"> of kind of</font>

415
00:13:27,870 --> 00:13:31,290
little tricks with CSP as well you<font color="#CCCCCC"> can</font>

416
00:13:29,910 --> 00:13:33,150
issue multiple CSP<font color="#CCCCCC"> heathers so you can</font>

417
00:13:31,290 --> 00:13:34,860
lay your policy however you like you can

418
00:13:33,150 --> 00:13:36,209
have like one huge<font color="#CCCCCC"> big policy</font><font color="#E5E5E5"> or you can</font>

419
00:13:34,860 --> 00:13:37,770
have multiple policies with different

420
00:13:36,210 --> 00:13:38,670
purposes and there's<font color="#E5E5E5"> one here if</font>

421
00:13:37,770 --> 00:13:41,449
anyone's<font color="#E5E5E5"> ever been involved in a</font>

422
00:13:38,670 --> 00:13:44,280
migration of taking a site from HTTP to

423
00:13:41,450 --> 00:13:45,900
HTTPS you know that it can actually be a

424
00:13:44,280 --> 00:13:47,339
bit of<font color="#CCCCCC"> a nightmare not unfortunately</font>

425
00:13:45,900 --> 00:13:48,829
<font color="#E5E5E5">it's not just as easy as flipping the</font>

426
00:13:47,340 --> 00:13:50,970
big encryption switch and turning it on

427
00:13:48,830 --> 00:13:52,410
so one of the things that<font color="#E5E5E5"> we want to</font>

428
00:13:50,970 --> 00:13:54,150
avoid is mixed content that I touched on

429
00:13:52,410 --> 00:13:55,290
<font color="#E5E5E5">and you can use this header here so it's</font>

430
00:13:54,150 --> 00:13:57,480
a<font color="#E5E5E5"> report on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> header it's not going to</font>

431
00:13:55,290 --> 00:13:58,980
take any blocking action and the default

432
00:13:57,480 --> 00:14:01,650
source what you can actually do is just

433
00:13:58,980 --> 00:14:03,240
specify the scheme like<font color="#E5E5E5"> I have</font><font color="#CCCCCC"> here so</font>

434
00:14:01,650 --> 00:14:05,010
I'm saying by default I don't care where

435
00:14:03,240 --> 00:14:07,380
I<font color="#CCCCCC"> lord</font><font color="#E5E5E5"> anything from I just want it to</font>

436
00:14:05,010 --> 00:14:09,450
be<font color="#CCCCCC"> loaded over</font><font color="#E5E5E5"> HTTPS and then I</font>

437
00:14:07,380 --> 00:14:10,950
specified the report your I directive so

438
00:14:09,450 --> 00:14:13,290
if<font color="#E5E5E5"> anything violates this policy is</font>

439
00:14:10,950 --> 00:14:15,480
loaded over HTTP the browser will send

440
00:14:13,290 --> 00:14:16,620
you that report that we just saw so

441
00:14:15,480 --> 00:14:18,090
again you're turning<font color="#CCCCCC"> all</font><font color="#E5E5E5"> of your</font>

442
00:14:16,620 --> 00:14:19,350
visitors browsers into little QA balls

443
00:14:18,090 --> 00:14:21,660
and they're basically going to scan your

444
00:14:19,350 --> 00:14:23,190
entire website for you for free and file

445
00:14:21,660 --> 00:14:26,130
these lot reports when they find things

446
00:14:23,190 --> 00:14:27,450
that violate your policy so if you are

447
00:14:26,130 --> 00:14:29,160
going<font color="#E5E5E5"> through a migration or you're</font>

448
00:14:27,450 --> 00:14:30,510
looking<font color="#CCCCCC"> at migration use things like</font>

449
00:14:29,160 --> 00:14:32,370
this it makes<font color="#E5E5E5"> your life so much easier</font>

450
00:14:30,510 --> 00:14:34,439
just get all your visitors browsers to

451
00:14:32,370 --> 00:14:36,510
<font color="#CCCCCC">to hard work don't sit there creping</font>

452
00:14:34,440 --> 00:14:40,650
through whatever to try and find HTTP

453
00:14:36,510 --> 00:14:42,060
image tags are things you<font color="#CCCCCC"> CSP and i want</font>

454
00:14:40,650 --> 00:14:43,890
to touch on just a couple of the

455
00:14:42,060 --> 00:14:45,510
advanced features as<font color="#E5E5E5"> i said</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> definitely</font>

456
00:14:43,890 --> 00:14:48,420
dark time to talk about CSP as much

457
00:14:45,510 --> 00:14:49,650
detail as<font color="#CCCCCC"> i like but you can do things</font>

458
00:14:48,420 --> 00:14:51,800
<font color="#CCCCCC">like white listing scripts with their</font>

459
00:14:49,650 --> 00:14:53,640
hashes as well if you don't<font color="#E5E5E5"> want to</font>

460
00:14:51,800 --> 00:14:55,319
whitelist the origin<font color="#E5E5E5"> that they're being</font>

461
00:14:53,640 --> 00:14:57,210
loaded from you can just whitelist them

462
00:14:55,320 --> 00:14:59,220
using their hash you can inject nancy's

463
00:14:57,210 --> 00:15:01,320
into the script tag and into the CSP

464
00:14:59,220 --> 00:15:03,150
header so you can whitelist script tags

465
00:15:01,320 --> 00:15:06,720
or any tag that you want with a nonce as

466
00:15:03,150 --> 00:15:08,189
well CSP has a graceful fall back we've

467
00:15:06,720 --> 00:15:11,010
got three different<font color="#CCCCCC"> versions of the CSP</font>

468
00:15:08,190 --> 00:15:12,090
spec now and we can gracefully fall back

469
00:15:11,010 --> 00:15:13,110
all the way through all three of them so

470
00:15:12,090 --> 00:15:15,810
if you<font color="#E5E5E5"> want to use the latest and</font>

471
00:15:13,110 --> 00:15:17,070
greatest features from CSP three<font color="#E5E5E5"> it will</font>

472
00:15:15,810 --> 00:15:18,810
<font color="#E5E5E5">gracefully fall back</font><font color="#CCCCCC"> to browsers that</font>

473
00:15:17,070 --> 00:15:20,370
are CSP two on one complaint without

474
00:15:18,810 --> 00:15:21,900
completely breaking them so we don't

475
00:15:20,370 --> 00:15:23,670
<font color="#E5E5E5">need to worry about adding these new</font>

476
00:15:21,900 --> 00:15:25,439
features into our policies because if

477
00:15:23,670 --> 00:15:27,120
the browser doesn't understand it it

478
00:15:25,440 --> 00:15:29,010
will<font color="#E5E5E5"> just disregard it and carry on you</font>

479
00:15:27,120 --> 00:15:32,070
know so there's no worry<font color="#E5E5E5"> about kind of</font>

480
00:15:29,010 --> 00:15:33,630
supporting the older versions<font color="#E5E5E5"> and</font><font color="#CCCCCC"> path</font>

481
00:15:32,070 --> 00:15:34,290
white listing page isn't here but if I

482
00:15:33,630 --> 00:15:36,050
didn't mention

483
00:15:34,290 --> 00:15:38,310
quiet listening budget of a heart attack

484
00:15:36,050 --> 00:15:41,729
rather than<font color="#E5E5E5"> whitelisting like an entire</font>

485
00:15:38,310 --> 00:15:44,670
origin like cdnas<font color="#E5E5E5"> calm basically says I</font>

486
00:15:41,730 --> 00:15:46,079
can load any script from CDN jfcom you

487
00:15:44,670 --> 00:15:47,699
can actually drill right down into the

488
00:15:46,079 --> 00:15:49,560
specific path so if you're loading a

489
00:15:47,699 --> 00:15:50,910
particular version of angular you can

490
00:15:49,560 --> 00:15:52,469
actually whitelist the path to that

491
00:15:50,910 --> 00:15:54,600
<font color="#E5E5E5">specific version to make sure an</font>

492
00:15:52,470 --> 00:15:56,550
attacker can't load in an older version

493
00:15:54,600 --> 00:15:58,440
<font color="#E5E5E5">while loading a different script from</font>

494
00:15:56,550 --> 00:15:59,849
that host so you can be really<font color="#E5E5E5"> you know</font>

495
00:15:58,440 --> 00:16:03,389
really tight and really restricted with

496
00:15:59,850 --> 00:16:05,009
your CSP if that's what you<font color="#CCCCCC"> need touch</font>

497
00:16:03,389 --> 00:16:07,019
them the multiple policy thing don't

498
00:16:05,009 --> 00:16:09,120
worry<font color="#CCCCCC"> about having like one huge massive</font>

499
00:16:07,019 --> 00:16:12,480
big policy I see lots<font color="#E5E5E5"> of science trying</font>

500
00:16:09,120 --> 00:16:14,370
<font color="#E5E5E5">to go for crazy insane policy like on</font>

501
00:16:12,480 --> 00:16:16,170
<font color="#E5E5E5">the first deployment just turn one</font>

502
00:16:14,370 --> 00:16:19,170
feature of CSP on start out with just

503
00:16:16,170 --> 00:16:21,180
upgrading secure or just a set of pretty

504
00:16:19,170 --> 00:16:22,920
broad default sources a lot of sites

505
00:16:21,180 --> 00:16:25,290
fail on deploying<font color="#E5E5E5"> this because they try</font>

506
00:16:22,920 --> 00:16:27,509
<font color="#CCCCCC">and do literally like crazy insane</font>

507
00:16:25,290 --> 00:16:29,040
policy from the<font color="#E5E5E5"> beginning just start go</font>

508
00:16:27,509 --> 00:16:30,630
for the easy wins you know deter pick a

509
00:16:29,040 --> 00:16:32,519
<font color="#E5E5E5">couple of things enable one or two</font>

510
00:16:30,630 --> 00:16:33,870
features and build<font color="#E5E5E5"> on it and you can</font>

511
00:16:32,519 --> 00:16:35,880
issue the enforced and report only

512
00:16:33,870 --> 00:16:37,769
header at<font color="#E5E5E5"> the same time so you can have</font>

513
00:16:35,880 --> 00:16:39,060
your actual and forth policy and then

514
00:16:37,769 --> 00:16:41,130
you can deploy another policy alongside

515
00:16:39,060 --> 00:16:42,689
<font color="#CCCCCC">and</font><font color="#E5E5E5"> report only mode to say right I want</font>

516
00:16:41,130 --> 00:16:44,579
this one enforcing but I want<font color="#E5E5E5"> to get the</font>

517
00:16:42,690 --> 00:16:46,319
feedback on what<font color="#E5E5E5"> would happen if I used</font>

518
00:16:44,579 --> 00:16:47,579
this one instead so you can kind of

519
00:16:46,319 --> 00:16:50,189
iterate through different policy

520
00:16:47,579 --> 00:16:51,810
versions as well and there's<font color="#E5E5E5"> something</font>

521
00:16:50,190 --> 00:16:53,160
coming in CSP<font color="#CCCCCC"> 3 yet it's only spot in</font>

522
00:16:51,810 --> 00:16:55,410
chrome right now because strict dynamic

523
00:16:53,160 --> 00:16:56,880
and basically if you didn't want<font color="#E5E5E5"> to</font>

524
00:16:55,410 --> 00:16:58,920
whitelist all of the locations that<font color="#CCCCCC"> you</font>

525
00:16:56,880 --> 00:17:00,540
<font color="#E5E5E5">lord script from and you have a script</font>

526
00:16:58,920 --> 00:17:02,339
tag on your<font color="#E5E5E5"> page</font><font color="#CCCCCC"> you can whitelist art</font>

527
00:17:00,540 --> 00:17:03,599
script and with strict dynamic you can

528
00:17:02,339 --> 00:17:05,309
permit it to bring its dependencies in

529
00:17:03,600 --> 00:17:06,990
without having to whitelist all of the

530
00:17:05,309 --> 00:17:08,339
origins of the dependencies so it just

531
00:17:06,990 --> 00:17:10,559
<font color="#CCCCCC">makes CSP a little bit easier to</font><font color="#E5E5E5"> deploy</font>

532
00:17:08,339 --> 00:17:13,230
because you say I trust this script and

533
00:17:10,559 --> 00:17:14,790
I want<font color="#E5E5E5"> to pass up but trust on to any</font>

534
00:17:13,230 --> 00:17:16,230
dependencies that it may load without

535
00:17:14,790 --> 00:17:18,240
having to whitelist all of their origins

536
00:17:16,230 --> 00:17:20,819
or white listing them via hash or

537
00:17:18,240 --> 00:17:22,049
whatever the method so we we've realized

538
00:17:20,819 --> 00:17:23,399
that CSP was a little bit difficult to

539
00:17:22,049 --> 00:17:26,030
deploy and there are<font color="#E5E5E5"> some things coming</font>

540
00:17:23,400 --> 00:17:29,010
in the next version to make that easier

541
00:17:26,030 --> 00:17:30,540
so the one<font color="#CCCCCC"> last thing to</font><font color="#E5E5E5"> wrap up on CSP</font>

542
00:17:29,010 --> 00:17:32,940
as well<font color="#E5E5E5"> I'm sure a couple</font><font color="#CCCCCC"> upenn test</font>

543
00:17:30,540 --> 00:17:34,350
<font color="#E5E5E5">guys probably picked up on is with the</font>

544
00:17:32,940 --> 00:17:36,150
cross-site scripting we can whitelist

545
00:17:34,350 --> 00:17:37,590
the third-party origins like evil kamma

546
00:17:36,150 --> 00:17:39,840
and block the script from loading their

547
00:17:37,590 --> 00:17:41,070
the way that we get a complete kind of

548
00:17:39,840 --> 00:17:42,480
protection really against cross-site

549
00:17:41,070 --> 00:17:44,730
scripting is that inline<font color="#E5E5E5"> scripts like</font>

550
00:17:42,480 --> 00:17:46,799
this are also banned by CSP in default

551
00:17:44,730 --> 00:17:48,090
by default sorry so if you have a script

552
00:17:46,799 --> 00:17:49,770
tag<font color="#E5E5E5"> this one's not particularly</font>

553
00:17:48,090 --> 00:17:52,230
but if you have the script tag on your

554
00:17:49,770 --> 00:17:54,179
<font color="#E5E5E5">page the browser would just not execute</font>

555
00:17:52,230 --> 00:17:55,380
it full stop is inline script and the

556
00:17:54,179 --> 00:17:57,029
reason<font color="#CCCCCC"> if the browser doesn't know where</font>

557
00:17:55,380 --> 00:17:58,289
<font color="#CCCCCC">it came from the browser can't know</font>

558
00:17:57,029 --> 00:18:00,120
where the<font color="#CCCCCC"> wii's the host put that there</font>

559
00:17:58,289 --> 00:18:01,980
or there an attack upon today is just an

560
00:18:00,120 --> 00:18:04,080
inline script tag so what we have<font color="#E5E5E5"> to do</font>

561
00:18:01,980 --> 00:18:05,640
is<font color="#E5E5E5"> externalize that file into oil</font>

562
00:18:04,080 --> 00:18:07,230
externalize it into a file them and load

563
00:18:05,640 --> 00:18:08,909
it back from our domain a domain

564
00:18:07,230 --> 00:18:10,559
whatever but we're giving the browser

565
00:18:08,909 --> 00:18:14,070
the piece<font color="#CCCCCC"> of information that</font><font color="#E5E5E5"> it needs</font>

566
00:18:10,559 --> 00:18:16,740
is this host in<font color="#CCCCCC"> the whitelist you can</font>

567
00:18:14,070 --> 00:18:18,299
enable inline script in CSP if you want

568
00:18:16,740 --> 00:18:21,210
but it's one of<font color="#CCCCCC"> the biggest wins that we</font>

569
00:18:18,299 --> 00:18:23,158
have with CSP so last resort if you

570
00:18:21,210 --> 00:18:25,669
<font color="#E5E5E5">really have to enable inline script but</font>

571
00:18:23,159 --> 00:18:31,500
try not to because we lose a really good

572
00:18:25,669 --> 00:18:32,990
mitigation<font color="#E5E5E5"> for cross-site scripting so</font>

573
00:18:31,500 --> 00:18:35,730
that was a very<font color="#E5E5E5"> brief overview of CSP</font>

574
00:18:32,990 --> 00:18:38,250
the next acronym up Wiz<font color="#E5E5E5"> pkp which is</font>

575
00:18:35,730 --> 00:18:42,690
public key pinning this is another HTTP

576
00:18:38,250 --> 00:18:44,279
response header still<font color="#CCCCCC"> and pkp kind of it</font>

577
00:18:42,690 --> 00:18:45,779
helps us with the ability to come back

578
00:18:44,279 --> 00:18:46,950
something<font color="#E5E5E5"> called rogue</font><font color="#CCCCCC"> certificate so</font>

579
00:18:45,779 --> 00:18:48,330
<font color="#E5E5E5">I've got two certificates up on the</font>

580
00:18:46,950 --> 00:18:50,130
screen<font color="#CCCCCC"> here they're both issued from</font><font color="#E5E5E5"> my</font>

581
00:18:48,330 --> 00:18:51,779
domain they're both signed by a

582
00:18:50,130 --> 00:18:53,270
legitimate certificate authority and

583
00:18:51,779 --> 00:18:55,380
they're both within the validity period

584
00:18:53,270 --> 00:18:59,250
what the browser accept either one of

585
00:18:55,380 --> 00:19:01,710
these certificates is a nun disagree but

586
00:18:59,250 --> 00:19:02,909
what<font color="#CCCCCC"> if</font><font color="#E5E5E5"> this one wasn't issued to me why</font>

587
00:19:01,710 --> 00:19:04,950
if this one was issued to somebody else

588
00:19:02,909 --> 00:19:06,299
the<font color="#E5E5E5"> browser is still going to trust it</font>

589
00:19:04,950 --> 00:19:07,950
because the only three metrics that a

590
00:19:06,299 --> 00:19:09,779
browser has to look at in a certificate

591
00:19:07,950 --> 00:19:12,000
is there's a<font color="#CCCCCC"> hostname</font><font color="#E5E5E5"> correct which it</font>

592
00:19:09,779 --> 00:19:13,610
is is it signed by<font color="#E5E5E5"> a trusted CA which it</font>

593
00:19:12,000 --> 00:19:16,080
is and is<font color="#CCCCCC"> it within its validity period</font>

594
00:19:13,610 --> 00:19:17,250
so it's past those three metrics even

595
00:19:16,080 --> 00:19:18,689
though this certificate is a minus a

596
00:19:17,250 --> 00:19:20,610
rogue certificate somebody might have

597
00:19:18,690 --> 00:19:22,020
compromised the<font color="#E5E5E5"> ca start com got popped</font>

598
00:19:20,610 --> 00:19:24,689
a few<font color="#E5E5E5"> weeks back the guy tried to get</font>

599
00:19:22,020 --> 00:19:26,789
certificates for paypal<font color="#E5E5E5"> com the browser</font>

600
00:19:24,690 --> 00:19:29,370
doesn't know so what<font color="#E5E5E5"> pkp does is pkp</font>

601
00:19:26,789 --> 00:19:33,029
gives a browser<font color="#E5E5E5"> forth metric by which to</font>

602
00:19:29,370 --> 00:19:35,070
check the certificate and again pkp is

603
00:19:33,029 --> 00:19:36,570
just a HTTP response header you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> see</font>

604
00:19:35,070 --> 00:19:38,580
there the public key pins header and you

605
00:19:36,570 --> 00:19:40,020
issue the policy as the<font color="#E5E5E5"> value of the</font>

606
00:19:38,580 --> 00:19:43,320
header and send that<font color="#E5E5E5"> out with all of</font>

607
00:19:40,020 --> 00:19:45,059
your pages now fortunately<font color="#E5E5E5"> pkp is a bit</font>

608
00:19:43,320 --> 00:19:46,559
simpler than CSP these are the

609
00:19:45,059 --> 00:19:49,110
directives in<font color="#E5E5E5"> pkp so it's nice</font><font color="#CCCCCC"> and</font>

610
00:19:46,559 --> 00:19:51,000
simple we've only got<font color="#CCCCCC"> the three</font><font color="#E5E5E5"> we've</font>

611
00:19:49,110 --> 00:19:52,799
got the pin<font color="#CCCCCC"> sha-256 there which is</font><font color="#E5E5E5"> the</font>

612
00:19:51,000 --> 00:19:54,840
actual pin of<font color="#CCCCCC"> the key that we want</font><font color="#E5E5E5"> to</font>

613
00:19:52,799 --> 00:19:56,460
pin<font color="#CCCCCC"> max-age is the number of seconds</font>

614
00:19:54,840 --> 00:19:58,678
that the browser sir should cash<font color="#CCCCCC"> in for</font>

615
00:19:56,460 --> 00:20:00,960
so unlike CSP which is enforced on a per

616
00:19:58,679 --> 00:20:01,910
page basis it has no lifetime weather

617
00:20:00,960 --> 00:20:03,830
than the lifetime of the

618
00:20:01,910 --> 00:20:06,290
age pkp is actually<font color="#E5E5E5"> cached by the</font>

619
00:20:03,830 --> 00:20:08,540
browser for<font color="#CCCCCC"> the number of seconds</font><font color="#E5E5E5"> in max</font>

620
00:20:06,290 --> 00:20:09,800
age and include subdomains again it's

621
00:20:08,540 --> 00:20:11,120
pretty obvious if you<font color="#E5E5E5"> wish you this on a</font>

622
00:20:09,800 --> 00:20:12,260
<font color="#E5E5E5">host do you want to include all</font>

623
00:20:11,120 --> 00:20:15,500
subdomains underneath that particular

624
00:20:12,260 --> 00:20:18,020
<font color="#E5E5E5">host honor and this is what pkp policy</font>

625
00:20:15,500 --> 00:20:20,240
looks like so<font color="#CCCCCC"> it kind of looks a little</font>

626
00:20:18,020 --> 00:20:22,220
bit messy but<font color="#CCCCCC"> it's basically</font><font color="#E5E5E5"> just we've</font>

627
00:20:20,240 --> 00:20:24,440
got the two pinch are 256 values so

628
00:20:22,220 --> 00:20:26,930
these are<font color="#CCCCCC"> the actual two pins these two</font>

629
00:20:24,440 --> 00:20:28,370
keys that we want<font color="#E5E5E5"> to pin one is what I</font>

630
00:20:26,930 --> 00:20:29,780
refer to as the Y pin so that's the

631
00:20:28,370 --> 00:20:30,949
current pin that<font color="#CCCCCC"> you have in production</font>

632
00:20:29,780 --> 00:20:33,230
for the key that you're actually using

633
00:20:30,950 --> 00:20:35,180
and the other is the backup so it's you

634
00:20:33,230 --> 00:20:36,710
know a key in a safe somewhere that if

635
00:20:35,180 --> 00:20:38,360
your main key ever gets compromised you

636
00:20:36,710 --> 00:20:40,250
can fall to the back up and then get

637
00:20:38,360 --> 00:20:41,719
<font color="#CCCCCC">your back up out of the safe and carry</font>

638
00:20:40,250 --> 00:20:43,850
<font color="#E5E5E5">on using that and then roll your header</font>

639
00:20:41,720 --> 00:20:46,070
so you've got<font color="#E5E5E5"> to have a minimum of</font><font color="#CCCCCC"> two</font>

640
00:20:43,850 --> 00:20:47,840
but if you're<font color="#CCCCCC"> looking at pkp that the</font>

641
00:20:46,070 --> 00:20:49,730
minimum<font color="#E5E5E5"> is two it's not the maximum</font>

642
00:20:47,840 --> 00:20:52,399
people go with pkp and only have one

643
00:20:49,730 --> 00:20:54,020
backup have look<font color="#E5E5E5"> at mine</font><font color="#CCCCCC"> I have like six</font>

644
00:20:52,400 --> 00:20:55,280
backups you can have as<font color="#CCCCCC"> many backups as</font>

645
00:20:54,020 --> 00:20:57,110
you want and you<font color="#E5E5E5"> can issue as many of</font>

646
00:20:55,280 --> 00:20:58,220
these as you want so don't don't<font color="#CCCCCC"> feel</font>

647
00:20:57,110 --> 00:20:59,659
that you you know you<font color="#E5E5E5"> kind of have to</font>

648
00:20:58,220 --> 00:21:01,700
stick to the spec and just go with<font color="#CCCCCC"> the</font>

649
00:20:59,660 --> 00:21:03,170
two and then you can see include

650
00:21:01,700 --> 00:21:05,120
subdomains in the max age there<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think</font>

651
00:21:03,170 --> 00:21:07,910
<font color="#E5E5E5">I was like a month or something in</font>

652
00:21:05,120 --> 00:21:11,600
seconds and the actual pin values

653
00:21:07,910 --> 00:21:14,510
themselves the pin value itself is the

654
00:21:11,600 --> 00:21:16,250
base64 encoded version of the shower 256

655
00:21:14,510 --> 00:21:18,770
hash of something that<font color="#CCCCCC"> we call the</font>

656
00:21:16,250 --> 00:21:21,110
subject public key information basically

657
00:21:18,770 --> 00:21:22,639
just think of it as a hash of your key

658
00:21:21,110 --> 00:21:24,590
<font color="#E5E5E5">it's you know we don't need to know the</font>

659
00:21:22,640 --> 00:21:26,480
specific<font color="#CCCCCC"> details but basically we're</font>

660
00:21:24,590 --> 00:21:28,100
just hashing<font color="#CCCCCC"> bsp ki basically for</font>

661
00:21:26,480 --> 00:21:29,990
encoding it and then sticking that in

662
00:21:28,100 --> 00:21:33,409
the header so don't worry too much about

663
00:21:29,990 --> 00:21:34,970
the technicalities do the consideration

664
00:21:33,410 --> 00:21:37,400
if you want to deploy pkp is where

665
00:21:34,970 --> 00:21:39,170
you're<font color="#E5E5E5"> going to pin because</font><font color="#CCCCCC"> when we use</font>

666
00:21:37,400 --> 00:21:41,270
certificates on our websites we actually

667
00:21:39,170 --> 00:21:43,190
have a certificate chain so I've I've

668
00:21:41,270 --> 00:21:44,300
rebuilt my chain here to show you you've

669
00:21:43,190 --> 00:21:45,800
got my domain over on the<font color="#CCCCCC"> right hand</font>

670
00:21:44,300 --> 00:21:47,600
side that's signed by the let's encrypt

671
00:21:45,800 --> 00:21:50,210
intermediate certificate who r cross

672
00:21:47,600 --> 00:21:52,280
signed by the DST root and what you can

673
00:21:50,210 --> 00:21:53,960
actually do is you can pin at different

674
00:21:52,280 --> 00:21:55,010
levels you can pin your leaf like<font color="#E5E5E5"> we</font>

675
00:21:53,960 --> 00:21:56,780
call it the leaf which is the one over

676
00:21:55,010 --> 00:21:58,400
<font color="#E5E5E5">here with my domain name on or you can</font>

677
00:21:56,780 --> 00:22:01,310
<font color="#E5E5E5">pin further down the chain like the</font>

678
00:21:58,400 --> 00:22:02,930
intermediate or at the root now there

679
00:22:01,310 --> 00:22:05,179
are different considerations as pros and

680
00:22:02,930 --> 00:22:07,100
cons to<font color="#CCCCCC"> each of these if you want to pin</font>

681
00:22:05,180 --> 00:22:09,290
at the leaf you're pinning your own

682
00:22:07,100 --> 00:22:10,550
private key<font color="#CCCCCC"> so were</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> own public keys</font>

683
00:22:09,290 --> 00:22:12,200
are your own key pair so you're

684
00:22:10,550 --> 00:22:14,750
responsible for<font color="#E5E5E5"> looking after the</font>

685
00:22:12,200 --> 00:22:15,680
associated private key and the backup is

686
00:22:14,750 --> 00:22:18,260
offline

687
00:22:15,680 --> 00:22:20,510
hopefully somewhere in a safe from a USB

688
00:22:18,260 --> 00:22:21,500
<font color="#E5E5E5">Drive that nobody can get</font><font color="#CCCCCC"> access to so</font>

689
00:22:20,510 --> 00:22:22,700
what you're saying to<font color="#E5E5E5"> the browser is</font>

690
00:22:21,500 --> 00:22:24,860
this is the key that I'm currently using

691
00:22:22,700 --> 00:22:26,660
my certificate and I have<font color="#E5E5E5"> this one back</font>

692
00:22:24,860 --> 00:22:28,100
up so it should either be one of these

693
00:22:26,660 --> 00:22:30,580
<font color="#CCCCCC">two keys whenever you come to my website</font>

694
00:22:28,100 --> 00:22:33,320
we should be<font color="#CCCCCC"> using</font><font color="#E5E5E5"> one of these two keys</font>

695
00:22:30,580 --> 00:22:35,570
now<font color="#E5E5E5"> this is the most secure level to pin</font>

696
00:22:33,320 --> 00:22:38,060
up because only you have these keys

697
00:22:35,570 --> 00:22:39,470
nobody<font color="#E5E5E5"> else has these keys so nobody can</font>

698
00:22:38,060 --> 00:22:40,700
get any vogue certificates for your site

699
00:22:39,470 --> 00:22:42,830
because the browser is going to look for

700
00:22:40,700 --> 00:22:44,930
one of these two keys the problem is is

701
00:22:42,830 --> 00:22:47,540
that if you kind<font color="#E5E5E5"> of get compromised and</font>

702
00:22:44,930 --> 00:22:48,740
so on gets access to your key and you've

703
00:22:47,540 --> 00:22:51,170
not looked<font color="#E5E5E5"> after your backup or you've</font>

704
00:22:48,740 --> 00:22:52,460
lost it and you have no backup your kind

705
00:22:51,170 --> 00:22:54,470
of screws because your website is going

706
00:22:52,460 --> 00:22:57,590
to go offline<font color="#E5E5E5"> or however long you set in</font>

707
00:22:54,470 --> 00:22:59,510
<font color="#CCCCCC">max-age so what some websites do is they</font>

708
00:22:57,590 --> 00:23:01,370
pin further down the chain and you can

709
00:22:59,510 --> 00:23:03,200
pin<font color="#CCCCCC"> Italy intermediate so you could in</font>

710
00:23:01,370 --> 00:23:05,270
my scenario I could pin against the

711
00:23:03,200 --> 00:23:06,650
let's encrypt intermediate and then for

712
00:23:05,270 --> 00:23:08,420
your backup because you have to pin

713
00:23:06,650 --> 00:23:10,400
another key that's not in<font color="#E5E5E5"> the chain you</font>

714
00:23:08,420 --> 00:23:11,870
could pin against another CA so you can

715
00:23:10,400 --> 00:23:14,060
pick<font color="#CCCCCC"> tcas that you trust you say here's</font>

716
00:23:11,870 --> 00:23:15,709
my current CA so this key<font color="#CCCCCC"> should always</font>

717
00:23:14,060 --> 00:23:18,350
be in<font color="#E5E5E5"> the chain and here's my backup key</font>

718
00:23:15,710 --> 00:23:20,180
which is<font color="#E5E5E5"> another CA that I trust now the</font>

719
00:23:18,350 --> 00:23:22,340
problem<font color="#E5E5E5"> with pinning here is that now</font>

720
00:23:20,180 --> 00:23:23,900
these two cas can technically issue

721
00:23:22,340 --> 00:23:26,090
rogue certificates for you because we're

722
00:23:23,900 --> 00:23:27,530
trusting the intermediate but what we

723
00:23:26,090 --> 00:23:30,260
have done is still a massive win because

724
00:23:27,530 --> 00:23:31,970
we've gone from the 350 cas in the world

725
00:23:30,260 --> 00:23:33,950
<font color="#E5E5E5">however many there are that could issue</font>

726
00:23:31,970 --> 00:23:35,810
rogue certificates rules down to<font color="#E5E5E5"> just</font>

727
00:23:33,950 --> 00:23:37,970
these two so we've hugely reduced the

728
00:23:35,810 --> 00:23:39,800
attack surface now in that you can pick

729
00:23:37,970 --> 00:23:41,270
to reputable cas that might not be

730
00:23:39,800 --> 00:23:43,669
coerced by foreign governments things

731
00:23:41,270 --> 00:23:47,180
like that and lock your lock your<font color="#E5E5E5"> pkp</font>

732
00:23:43,670 --> 00:23:48,650
against those so if somebody pops the

733
00:23:47,180 --> 00:23:50,960
china post office and gets them<font color="#CCCCCC"> to issue</font>

734
00:23:48,650 --> 00:23:52,250
a certificate for my domain then the

735
00:23:50,960 --> 00:23:53,870
browser won't accept<font color="#E5E5E5"> it because it knows</font>

736
00:23:52,250 --> 00:23:55,970
<font color="#CCCCCC">that these are</font><font color="#E5E5E5"> the only two casi trust</font>

737
00:23:53,870 --> 00:23:57,260
to issue certificates for me the only

738
00:23:55,970 --> 00:23:59,330
problem of intermediates is that they're

739
00:23:57,260 --> 00:24:00,620
they're<font color="#CCCCCC"> not really</font><font color="#E5E5E5"> long term like you</font>

740
00:23:59,330 --> 00:24:02,060
can't<font color="#E5E5E5"> guarantee</font><font color="#CCCCCC"> that they'll be there</font>

741
00:24:00,620 --> 00:24:03,500
for a long time let's encrypt shifted

742
00:24:02,060 --> 00:24:05,750
from the x1 to the<font color="#E5E5E5"> x3 intermediate</font>

743
00:24:03,500 --> 00:24:07,070
recently broke a few things so

744
00:24:05,750 --> 00:24:09,860
intermediates can be kind of a little

745
00:24:07,070 --> 00:24:11,090
<font color="#E5E5E5">bit dynamic so what you can do is pinned</font>

746
00:24:09,860 --> 00:24:12,919
against the root because roots are much

747
00:24:11,090 --> 00:24:14,659
more<font color="#E5E5E5"> long-term it takes organizations</font>

748
00:24:12,920 --> 00:24:16,070
literally<font color="#E5E5E5"> years to get their roots into</font>

749
00:24:14,660 --> 00:24:18,140
the restore soap inning against the root

750
00:24:16,070 --> 00:24:19,639
is a little bit more reliable in that

751
00:24:18,140 --> 00:24:23,060
you know<font color="#E5E5E5"> that the roots not going to go</font>

752
00:24:19,640 --> 00:24:24,800
anywhere so<font color="#CCCCCC"> i could pin against the DST</font>

753
00:24:23,060 --> 00:24:26,540
<font color="#E5E5E5">root which is</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> let's encrypt chained</font>

754
00:24:24,800 --> 00:24:27,889
down to and then just pick another<font color="#E5E5E5"> root</font>

755
00:24:26,540 --> 00:24:29,330
certificate to pin against if you want

756
00:24:27,890 --> 00:24:29,660
and this is actually if you look at

757
00:24:29,330 --> 00:24:31,310
github

758
00:24:29,660 --> 00:24:33,590
website this<font color="#E5E5E5"> is what github do get</font><font color="#CCCCCC"> hub</font>

759
00:24:31,310 --> 00:24:35,450
<font color="#CCCCCC">pin I think it's dizzy certain verisign</font>

760
00:24:33,590 --> 00:24:36,860
so they<font color="#E5E5E5"> picked to reputable cas that</font>

761
00:24:35,450 --> 00:24:38,330
they trust and they pinned<font color="#E5E5E5"> against them</font>

762
00:24:36,860 --> 00:24:39,679
and said these<font color="#E5E5E5"> are the only two cas on</font>

763
00:24:38,330 --> 00:24:42,080
the planet<font color="#E5E5E5"> that should ever issue</font>

764
00:24:39,680 --> 00:24:43,970
certificates for github com if you see a

765
00:24:42,080 --> 00:24:46,220
certificate from another<font color="#CCCCCC"> Authority its</font>

766
00:24:43,970 --> 00:24:48,230
rogue it's not ours don't<font color="#E5E5E5"> trust it so</font>

767
00:24:46,220 --> 00:24:49,490
they can stop their users basically<font color="#CCCCCC"> we</font>

768
00:24:48,230 --> 00:24:51,950
<font color="#E5E5E5">man in the middle</font><font color="#CCCCCC"> if somebody manages to</font>

769
00:24:49,490 --> 00:24:53,750
get hold<font color="#E5E5E5"> of a trusted root cert like a</font>

770
00:24:51,950 --> 00:24:57,560
company<font color="#E5E5E5"> that recently got across signed</font>

771
00:24:53,750 --> 00:25:00,170
by<font color="#E5E5E5"> symantec and one of the other good</font>

772
00:24:57,560 --> 00:25:01,909
things with pkp is again we have<font color="#E5E5E5"> pkp</font>

773
00:25:00,170 --> 00:25:03,320
reporting and the<font color="#CCCCCC"> other</font><font color="#E5E5E5"> one as well</font>

774
00:25:01,910 --> 00:25:05,150
you'll see that I've added report only

775
00:25:03,320 --> 00:25:07,399
on to the header here so again you can

776
00:25:05,150 --> 00:25:08,480
deploy<font color="#E5E5E5"> this in report only mode</font><font color="#CCCCCC"> if you</font>

777
00:25:07,400 --> 00:25:10,100
<font color="#E5E5E5">think oh I</font><font color="#CCCCCC"> don't look</font><font color="#E5E5E5"> I'm going to turn</font>

778
00:25:08,480 --> 00:25:11,810
<font color="#E5E5E5">this on and tank my website just turn it</font>

779
00:25:10,100 --> 00:25:13,580
on the report only mode and if you get

780
00:25:11,810 --> 00:25:15,080
boatloads of areas coming in then you

781
00:25:13,580 --> 00:25:16,550
broke something and but nothing's going

782
00:25:15,080 --> 00:25:17,419
to happen there's nothing<font color="#E5E5E5"> worse than the</font>

783
00:25:16,550 --> 00:25:19,580
fact you're going to get a<font color="#E5E5E5"> lot of error</font>

784
00:25:17,420 --> 00:25:22,250
reports so i deploy in report only mode

785
00:25:19,580 --> 00:25:23,360
and enable reporting and the good thing

786
00:25:22,250 --> 00:25:24,860
<font color="#CCCCCC">with the reporting is that if somebody</font>

787
00:25:23,360 --> 00:25:26,959
<font color="#E5E5E5">does actually get a rogue certificate</font>

788
00:25:24,860 --> 00:25:28,280
signed for your site the browser will

789
00:25:26,960 --> 00:25:29,990
<font color="#E5E5E5">post a JSON payload and they actually</font>

790
00:25:28,280 --> 00:25:32,000
<font color="#E5E5E5">put the pem encoding certificate chain</font>

791
00:25:29,990 --> 00:25:33,500
in the payload so you can<font color="#E5E5E5"> actually see</font>

792
00:25:32,000 --> 00:25:36,170
who's issued it and go directly<font color="#E5E5E5"> to the</font>

793
00:25:33,500 --> 00:25:37,340
ca as soon as<font color="#E5E5E5"> it happens and say gives</font>

794
00:25:36,170 --> 00:25:39,620
<font color="#E5E5E5">you signed</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> certificate for my domain</font>

795
00:25:37,340 --> 00:25:40,669
this needs to be revoked so you can

796
00:25:39,620 --> 00:25:42,350
actually know about<font color="#E5E5E5"> these things that</font>

797
00:25:40,670 --> 00:25:43,490
<font color="#CCCCCC">are happening in</font><font color="#E5E5E5"> the wild rather than</font>

798
00:25:42,350 --> 00:25:45,199
the current situation which is<font color="#E5E5E5"> that</font>

799
00:25:43,490 --> 00:25:49,880
everybody's browsers would just carry on

800
00:25:45,200 --> 00:25:53,600
accepting the certificate so that's pkp

801
00:25:49,880 --> 00:25:54,860
is probably one of the most complex of

802
00:25:53,600 --> 00:25:57,169
the technologies<font color="#CCCCCC"> I'm talking about today</font>

803
00:25:54,860 --> 00:25:58,850
<font color="#E5E5E5">I recently did a crawl of the top 1</font>

804
00:25:57,170 --> 00:26:01,760
million sites on the planet and there's

805
00:25:58,850 --> 00:26:04,070
about 200 that huge pkp is literally a

806
00:26:01,760 --> 00:26:05,780
brand new specification and a lot<font color="#CCCCCC"> of</font>

807
00:26:04,070 --> 00:26:08,270
<font color="#E5E5E5">people are scared</font><font color="#CCCCCC"> of what we call the HP</font>

808
00:26:05,780 --> 00:26:09,530
KP gun or HP KP suicide which is

809
00:26:08,270 --> 00:26:11,270
where<font color="#E5E5E5"> you basically get your pins wrong</font>

810
00:26:09,530 --> 00:26:13,340
and then the browser can't use anything

811
00:26:11,270 --> 00:26:15,200
so it<font color="#CCCCCC"> deployment report on the mode</font>

812
00:26:13,340 --> 00:26:18,800
don't just turn these<font color="#CCCCCC"> things on always</font>

813
00:26:15,200 --> 00:26:19,940
take the safe approach next<font color="#E5E5E5"> up is</font>

814
00:26:18,800 --> 00:26:23,720
something<font color="#CCCCCC"> called strict Transport</font>

815
00:26:19,940 --> 00:26:25,730
Security now without strict Transport

816
00:26:23,720 --> 00:26:27,560
Security we're<font color="#E5E5E5"> going to look through a</font>

817
00:26:25,730 --> 00:26:30,590
basic conversation with twitter com so a

818
00:26:27,560 --> 00:26:32,120
user opens up their browser and like

819
00:26:30,590 --> 00:26:33,800
most of you guys I'm<font color="#CCCCCC"> pretty sure that</font>

820
00:26:32,120 --> 00:26:35,270
<font color="#E5E5E5">you just type in twitter com like I do</font>

821
00:26:33,800 --> 00:26:37,129
so that's<font color="#E5E5E5"> the blue bit in this request</font>

822
00:26:35,270 --> 00:26:39,950
it<font color="#E5E5E5"> user opens a browser typed in twitter</font>

823
00:26:37,130 --> 00:26:41,300
com the browser<font color="#E5E5E5"> defaults to http so the</font>

824
00:26:39,950 --> 00:26:43,070
very first thing that<font color="#E5E5E5"> the browser wants</font>

825
00:26:41,300 --> 00:26:43,340
to do is to send an insecure requested

826
00:26:43,070 --> 00:26:45,710
<font color="#E5E5E5">Twitter</font>

827
00:26:43,340 --> 00:26:48,020
calm so it sends a get request to HTTP

828
00:26:45,710 --> 00:26:50,390
twitter com and Twitter responds back

829
00:26:48,020 --> 00:26:52,670
with<font color="#E5E5E5"> a 301 redirect and says I don't</font>

830
00:26:50,390 --> 00:26:54,230
want to<font color="#E5E5E5"> talk HTTP I want to talk https</font><font color="#CCCCCC"> I</font>

831
00:26:52,670 --> 00:26:57,110
want to be secure so please come<font color="#E5E5E5"> back</font>

832
00:26:54,230 --> 00:26:58,940
over a secure connection and then the

833
00:26:57,110 --> 00:27:02,300
browser honors that request and reissues

834
00:26:58,940 --> 00:27:05,240
the same request over HTTPS now the only

835
00:27:02,300 --> 00:27:07,340
problem<font color="#CCCCCC"> is the very first request that</font>

836
00:27:05,240 --> 00:27:09,830
went<font color="#E5E5E5"> out and the redirect that came back</font>

837
00:27:07,340 --> 00:27:12,740
that told us to go to a secure protocol

838
00:27:09,830 --> 00:27:14,330
we sent over an insecure protocol so we

839
00:27:12,740 --> 00:27:15,500
said hey we need to<font color="#E5E5E5"> like secure our</font>

840
00:27:14,330 --> 00:27:17,030
conversation but we did<font color="#E5E5E5"> it over an</font>

841
00:27:15,500 --> 00:27:18,650
insecure protocol so then attack is just

842
00:27:17,030 --> 00:27:22,040
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> throw that away because</font><font color="#E5E5E5"> we're</font>

843
00:27:18,650 --> 00:27:23,780
talking HTTP and the problem with that

844
00:27:22,040 --> 00:27:25,760
<font color="#CCCCCC">I'm sure some of you heard of SSL strip</font>

845
00:27:23,780 --> 00:27:27,770
or SSL<font color="#E5E5E5"> stripping attacks is that the</font>

846
00:27:25,760 --> 00:27:29,090
attacker then jumps into the middle and

847
00:27:27,770 --> 00:27:31,370
when they see the redirect coming back

848
00:27:29,090 --> 00:27:33,590
that says go HTTPS they just throw that

849
00:27:31,370 --> 00:27:35,360
<font color="#E5E5E5">away the attacker will go back HTTPS and</font>

850
00:27:33,590 --> 00:27:38,480
fetch the<font color="#E5E5E5"> page and then answer</font><font color="#CCCCCC"> the</font>

851
00:27:35,360 --> 00:27:39,439
clients initial request over HTTP so the

852
00:27:38,480 --> 00:27:41,510
attacker literally sits in the middle

853
00:27:39,440 --> 00:27:43,520
<font color="#E5E5E5">talk to https to</font><font color="#CCCCCC"> twitter they're</font><font color="#E5E5E5"> happy</font>

854
00:27:41,510 --> 00:27:45,860
because we're talking<font color="#CCCCCC"> HTTPS</font><font color="#E5E5E5"> and my</font>

855
00:27:43,520 --> 00:27:47,450
browser never got the redirect so my

856
00:27:45,860 --> 00:27:48,649
browser is happy to keep talking HTTP

857
00:27:47,450 --> 00:27:50,630
and then the attack of literally<font color="#E5E5E5"> just</font>

858
00:27:48,650 --> 00:27:53,780
sits<font color="#E5E5E5"> in the middle and gets our entire</font>

859
00:27:50,630 --> 00:27:56,390
conversation with twitter com now<font color="#E5E5E5"> STS</font>

860
00:27:53,780 --> 00:27:58,580
fixes this and again<font color="#CCCCCC"> SDS is just another</font>

861
00:27:56,390 --> 00:28:01,370
HTTP response header that you pop into

862
00:27:58,580 --> 00:28:03,230
responses on your site so a strict

863
00:28:01,370 --> 00:28:05,479
Transport Security header and the policy

864
00:28:03,230 --> 00:28:06,530
and again I like STS because it's not

865
00:28:05,480 --> 00:28:08,660
like<font color="#E5E5E5"> complicated we only have three</font>

866
00:28:06,530 --> 00:28:10,490
<font color="#E5E5E5">directives that we can</font><font color="#CCCCCC"> use the only</font>

867
00:28:08,660 --> 00:28:12,770
actually required directive for a valid

868
00:28:10,490 --> 00:28:14,480
<font color="#CCCCCC">STS policies max-age so we have the max</font>

869
00:28:12,770 --> 00:28:16,250
age which is<font color="#E5E5E5"> again the number of seconds</font>

870
00:28:14,480 --> 00:28:18,920
<font color="#CCCCCC">that the browser should cash and apply</font>

871
00:28:16,250 --> 00:28:21,020
this policy for include subdomains does

872
00:28:18,920 --> 00:28:22,460
what it says on<font color="#CCCCCC"> the tin and I will touch</font>

873
00:28:21,020 --> 00:28:24,200
<font color="#E5E5E5">on</font><font color="#CCCCCC"> preloading later but there is one</font>

874
00:28:22,460 --> 00:28:27,230
<font color="#CCCCCC">more directive but the only required one</font>

875
00:28:24,200 --> 00:28:29,480
is max age so a valid<font color="#E5E5E5"> SDS policy can be</font>

876
00:28:27,230 --> 00:28:32,450
as simple as that this is how long we

877
00:28:29,480 --> 00:28:35,200
<font color="#E5E5E5">want to apply STS for and what STS does</font>

878
00:28:32,450 --> 00:28:38,240
once the browser receives this is stas

879
00:28:35,200 --> 00:28:41,930
never<font color="#E5E5E5"> talk HTTP to me again only ever</font>

880
00:28:38,240 --> 00:28:43,400
talk to<font color="#CCCCCC"> me over HTTPS so that's the sole</font>

881
00:28:41,930 --> 00:28:44,810
purpose<font color="#CCCCCC"> of</font><font color="#E5E5E5"> SDS there's a</font><font color="#CCCCCC"> couple of other</font>

882
00:28:43,400 --> 00:28:47,510
benefits<font color="#CCCCCC"> but this is basically</font><font color="#E5E5E5"> what we</font>

883
00:28:44,810 --> 00:28:49,310
want from sts and what happens then<font color="#E5E5E5"> once</font>

884
00:28:47,510 --> 00:28:51,320
the browser has received this strict

885
00:28:49,310 --> 00:28:52,730
Transport Security policy is that you

886
00:28:51,320 --> 00:28:54,620
open up your<font color="#E5E5E5"> browser you typing twitter</font>

887
00:28:52,730 --> 00:28:57,049
com exactly the same and the browser

888
00:28:54,620 --> 00:28:59,449
wants to default to http but we

889
00:28:57,049 --> 00:29:02,269
STS it won't the browser will<font color="#E5E5E5"> actually</font>

890
00:28:59,450 --> 00:29:04,549
block that request now<font color="#E5E5E5"> even if the user</font>

891
00:29:02,269 --> 00:29:06,200
types in HTTP colon slash slash twitter

892
00:29:04,549 --> 00:29:08,389
<font color="#E5E5E5">com if they click on a link or a</font>

893
00:29:06,200 --> 00:29:10,489
bookmark or anything it doesn't matter

894
00:29:08,389 --> 00:29:11,988
<font color="#CCCCCC">if the user tries to speak HTTP the</font>

895
00:29:10,489 --> 00:29:13,610
browser<font color="#E5E5E5"> will override them and block</font>

896
00:29:11,989 --> 00:29:15,769
their action because it knows we've

897
00:29:13,610 --> 00:29:18,168
issued an SDS policy we only want to

898
00:29:15,769 --> 00:29:20,450
speak HTTPS so we'll actually override

899
00:29:18,169 --> 00:29:22,159
any action whatsoever and force the

900
00:29:20,450 --> 00:29:24,590
request the very first request to go out

901
00:29:22,159 --> 00:29:27,139
of a https instead and what we've done

902
00:29:24,590 --> 00:29:29,029
there is basically ensure that our

903
00:29:27,139 --> 00:29:31,369
entire communication happens over<font color="#CCCCCC"> HTTPS</font>

904
00:29:29,029 --> 00:29:32,480
and sliced out the whole HTTP part which

905
00:29:31,369 --> 00:29:35,149
<font color="#CCCCCC">is where an attacker would have inserted</font>

906
00:29:32,480 --> 00:29:37,190
themselves so if<font color="#E5E5E5"> you're using HTTPS and</font>

907
00:29:35,149 --> 00:29:40,070
your<font color="#CCCCCC"> website and</font><font color="#E5E5E5"> you redirect to https</font>

908
00:29:37,190 --> 00:29:41,359
then you should be using SDS because it

909
00:29:40,070 --> 00:29:42,739
will it will get<font color="#E5E5E5"> rid of that initial</font>

910
00:29:41,359 --> 00:29:44,059
redirect which will<font color="#E5E5E5"> just save you guys</font>

911
00:29:42,739 --> 00:29:45,889
load because you're not constantly just

912
00:29:44,059 --> 00:29:47,480
redirecting browsers pointlessly but it

913
00:29:45,889 --> 00:29:49,309
also removes all these SSL stripping

914
00:29:47,480 --> 00:29:51,379
attacks the other thing that s testers

915
00:29:49,309 --> 00:29:52,789
as well is has anyone ever got a

916
00:29:51,379 --> 00:29:53,809
certificate warning in their browser I'm

917
00:29:52,789 --> 00:29:54,830
sure loads of you have you go to<font color="#E5E5E5"> a</font>

918
00:29:53,809 --> 00:29:56,450
<font color="#E5E5E5">website and it says are there's</font>

919
00:29:54,830 --> 00:29:57,799
something wrong there's a nice big shiny

920
00:29:56,450 --> 00:29:59,539
blue continue button at the bottom and

921
00:29:57,799 --> 00:30:01,249
like ninety-nine point nine percent of

922
00:29:59,539 --> 00:30:03,200
people or<font color="#E5E5E5"> like my browser's telling me</font>

923
00:30:01,249 --> 00:30:04,970
something<font color="#CCCCCC"> mayor and they</font><font color="#E5E5E5"> just mash the</font>

924
00:30:03,200 --> 00:30:08,119
button to bypass the warning and carry

925
00:30:04,970 --> 00:30:10,789
on<font color="#E5E5E5"> STS disables that it completely takes</font>

926
00:30:08,119 --> 00:30:13,100
<font color="#E5E5E5">options out if you get any error to do</font>

927
00:30:10,789 --> 00:30:15,169
with HTTPS connection and<font color="#CCCCCC"> you're an sts</font>

928
00:30:13,100 --> 00:30:17,449
host the browser is not<font color="#E5E5E5"> permitted to</font>

929
00:30:15,169 --> 00:30:18,919
allow<font color="#E5E5E5"> the user to bypass that so that's</font>

930
00:30:17,450 --> 00:30:20,629
the<font color="#CCCCCC"> other benefit</font><font color="#E5E5E5"> of SDS is that people</font>

931
00:30:18,919 --> 00:30:25,100
can't just<font color="#E5E5E5"> click through those warnings</font>

932
00:30:20,629 --> 00:30:26,629
like they always do now the next acronym

933
00:30:25,100 --> 00:30:30,340
that I want<font color="#E5E5E5"> to talk about is something</font>

934
00:30:26,629 --> 00:30:32,600
called<font color="#E5E5E5"> s RI or sub resource integrity</font>

935
00:30:30,340 --> 00:30:36,408
you'll be really happy to know that s RI

936
00:30:32,600 --> 00:30:37,969
isn't a HTTP response header and what s

937
00:30:36,409 --> 00:30:39,499
RI does is it resolves<font color="#E5E5E5"> a problem that we</font>

938
00:30:37,970 --> 00:30:41,929
have with<font color="#CCCCCC"> third party trust</font><font color="#E5E5E5"> on our</font><font color="#CCCCCC"> sighs</font>

939
00:30:39,499 --> 00:30:44,330
I mentioned<font color="#CCCCCC"> earlier about</font><font color="#E5E5E5"> the CSP bowler</font>

940
00:30:41,929 --> 00:30:46,759
the CSP policy being too basic because

941
00:30:44,330 --> 00:30:48,139
we<font color="#E5E5E5"> all load content from countless</font>

942
00:30:46,759 --> 00:30:50,720
domains from CD ends we have twitter

943
00:30:48,139 --> 00:30:52,389
widgets we embed things we we<font color="#E5E5E5"> have all</font>

944
00:30:50,720 --> 00:30:55,489
<font color="#E5E5E5">kinds of stuff loaded into our website</font>

945
00:30:52,389 --> 00:30:58,279
so my sites here nice<font color="#CCCCCC"> and secure</font><font color="#E5E5E5"> I'm</font>

946
00:30:55,489 --> 00:31:01,279
loading in<font color="#E5E5E5"> jQuery whatever from some CDN</font>

947
00:30:58,279 --> 00:31:03,379
I'm<font color="#E5E5E5"> effectively giving that CDN code</font>

948
00:31:01,279 --> 00:31:05,059
execution in my page I'm is basically i

949
00:31:03,379 --> 00:31:07,340
call it<font color="#E5E5E5"> i saw it online somewhere</font>

950
00:31:05,059 --> 00:31:08,869
consensual access s so it's saying to

951
00:31:07,340 --> 00:31:10,908
this CDN hey give<font color="#E5E5E5"> us a javascript file</font>

952
00:31:08,869 --> 00:31:12,830
and just<font color="#E5E5E5"> like plop it in my page and</font>

953
00:31:10,909 --> 00:31:14,690
trusting that<font color="#E5E5E5"> CDN to give you the</font>

954
00:31:12,830 --> 00:31:16,759
javascript file that you actually wanted

955
00:31:14,690 --> 00:31:17,749
now most of the time they<font color="#E5E5E5"> will give you</font>

956
00:31:16,759 --> 00:31:19,549
the javascript file that you actually

957
00:31:17,749 --> 00:31:21,559
wants a double<font color="#E5E5E5"> give you jquery or</font>

958
00:31:19,549 --> 00:31:23,450
whatever it is<font color="#E5E5E5"> that you're loading but</font>

959
00:31:21,559 --> 00:31:26,029
what<font color="#E5E5E5"> if the CDN is compromised what if</font>

960
00:31:23,450 --> 00:31:28,519
someone out the CDN has a bad day<font color="#E5E5E5"> and</font>

961
00:31:26,029 --> 00:31:30,889
things<font color="#CCCCCC"> you know screw you</font><font color="#E5E5E5"> guys I'm going</font>

962
00:31:28,519 --> 00:31:31,820
to put Wildcat since a jquery and you

963
00:31:30,889 --> 00:31:34,158
know completely<font color="#E5E5E5"> tanked everyone's</font>

964
00:31:31,820 --> 00:31:36,649
website they you know we're trusting

965
00:31:34,159 --> 00:31:40,999
them to do<font color="#E5E5E5"> that and what s RI does is it</font>

966
00:31:36,649 --> 00:31:42,529
removes this trust aspect so you can see

967
00:31:40,999 --> 00:31:45,559
here basic script tag we're loading

968
00:31:42,529 --> 00:31:47,809
<font color="#E5E5E5">jQuery from Sun CDN calm and s RI is</font>

969
00:31:45,559 --> 00:31:49,309
basically just two extra attributes in a

970
00:31:47,809 --> 00:31:51,049
script tag we have the<font color="#E5E5E5"> first one here</font>

971
00:31:49,309 --> 00:31:52,158
that's<font color="#CCCCCC"> cross-origin this</font><font color="#E5E5E5"> value</font><font color="#CCCCCC"> is always</font>

972
00:31:51,049 --> 00:31:54,049
anonymous don't worry about<font color="#E5E5E5"> that just</font>

973
00:31:52,159 --> 00:31:56,059
certain forget and then we have the

974
00:31:54,049 --> 00:31:58,340
integrity attribute as well and this<font color="#E5E5E5"> is</font>

975
00:31:56,059 --> 00:32:00,109
basically<font color="#E5E5E5"> just the base 64 encoded hash</font>

976
00:31:58,340 --> 00:32:02,029
of the<font color="#E5E5E5"> file that we should expect from</font>

977
00:32:00,109 --> 00:32:03,590
<font color="#E5E5E5">the CDM so what we're saying to the</font>

978
00:32:02,029 --> 00:32:05,809
browser is we want<font color="#E5E5E5"> to load jQuery from</font>

979
00:32:03,590 --> 00:32:07,728
the CDN here's<font color="#E5E5E5"> the hash of the file that</font>

980
00:32:05,809 --> 00:32:09,229
you should get from the CDM so when the

981
00:32:07,729 --> 00:32:10,909
CDN sends I filed the<font color="#CCCCCC"> browser will</font><font color="#E5E5E5"> hash</font>

982
00:32:09,229 --> 00:32:12,919
it and compare the hash to<font color="#E5E5E5"> the integrity</font>

983
00:32:10,909 --> 00:32:15,200
attribute as long as it finds a hash

984
00:32:12,919 --> 00:32:16,549
that matches we know that<font color="#CCCCCC"> the CDN hasn't</font>

985
00:32:15,200 --> 00:32:18,229
tampered with the file itself we've

986
00:32:16,549 --> 00:32:20,929
actually got the file<font color="#CCCCCC"> that we were</font>

987
00:32:18,229 --> 00:32:22,820
<font color="#CCCCCC">expecting to get now the good thing with</font>

988
00:32:20,929 --> 00:32:24,229
ssris<font color="#CCCCCC"> its set and forget you know if</font>

989
00:32:22,820 --> 00:32:26,269
you're loading a particular version of

990
00:32:24,229 --> 00:32:27,799
jQuery from a CDN that<font color="#CCCCCC"> file should never</font>

991
00:32:26,269 --> 00:32:29,210
change so we don't<font color="#CCCCCC"> need</font><font color="#E5E5E5"> to change these</font>

992
00:32:27,799 --> 00:32:31,279
once you put that script tag into the

993
00:32:29,210 --> 00:32:32,479
page you just put that script tag into

994
00:32:31,279 --> 00:32:33,830
the page and<font color="#E5E5E5"> the only time you ever need</font>

995
00:32:32,479 --> 00:32:35,419
to<font color="#E5E5E5"> do anything with it is if you want to</font>

996
00:32:33,830 --> 00:32:38,689
change the jQuery version you just

997
00:32:35,419 --> 00:32:40,309
update the hashes so<font color="#CCCCCC"> si is minimal</font>

998
00:32:38,690 --> 00:32:42,049
overhead and he gives us a lot of

999
00:32:40,309 --> 00:32:43,190
<font color="#CCCCCC">security because we can take you</font><font color="#E5E5E5"> know</font>

1000
00:32:42,049 --> 00:32:44,840
we're still trusting the CD ins to load

1001
00:32:43,190 --> 00:32:46,099
those assets but we're verifying the

1002
00:32:44,840 --> 00:32:47,599
files<font color="#E5E5E5"> that they're sending to us and</font>

1003
00:32:46,099 --> 00:32:51,080
<font color="#E5E5E5">that's the crucial part is like trust</font>

1004
00:32:47,599 --> 00:32:52,369
but verify as well dead easy to set up

1005
00:32:51,080 --> 00:32:54,019
if<font color="#E5E5E5"> you want to do it kind of at the</font>

1006
00:32:52,369 --> 00:32:55,908
command line literally just count the

1007
00:32:54,019 --> 00:32:58,940
file pipe it into I'm using openssl

1008
00:32:55,909 --> 00:33:02,059
digest<font color="#CCCCCC"> sha-256 don't forget the binary</font>

1009
00:32:58,940 --> 00:33:03,229
flag spent ages debugging<font color="#E5E5E5"> this and then</font>

1010
00:33:02,059 --> 00:33:05,269
just pipe it into some kind of basics

1011
00:33:03,229 --> 00:33:06,559
before encoding and that output there is

1012
00:33:05,269 --> 00:33:08,899
what you put into the script tag

1013
00:33:06,559 --> 00:33:11,418
prepended with sha-256 in this case and

1014
00:33:08,899 --> 00:33:13,820
if you want<font color="#E5E5E5"> to do char 384 and you can</font>

1015
00:33:11,419 --> 00:33:15,710
also do sha-512 and you can put all

1016
00:33:13,820 --> 00:33:16,970
three versions into the script tag for

1017
00:33:15,710 --> 00:33:18,409
the same file and the browser<font color="#E5E5E5"> will</font>

1018
00:33:16,970 --> 00:33:20,330
always choose the strongest hash that

1019
00:33:18,409 --> 00:33:22,549
<font color="#E5E5E5">its support so again you know old</font>

1020
00:33:20,330 --> 00:33:23,939
rubbish browsers we can<font color="#E5E5E5"> keep the</font><font color="#CCCCCC"> sha256</font>

1021
00:33:22,549 --> 00:33:25,350
hash for them there

1022
00:33:23,940 --> 00:33:26,759
using a newer better browser it will

1023
00:33:25,350 --> 00:33:29,969
pick the stronger hash to validate the

1024
00:33:26,759 --> 00:33:31,440
file against<font color="#E5E5E5"> I also have one</font><font color="#CCCCCC"> of my</font>

1025
00:33:29,970 --> 00:33:32,610
websites online way if you don't want to

1026
00:33:31,440 --> 00:33:34,529
do all this you can literally<font color="#E5E5E5"> just paste</font>

1027
00:33:32,610 --> 00:33:35,969
in the URL for<font color="#CCCCCC"> the asset and it just</font>

1028
00:33:34,529 --> 00:33:37,169
generates the full script tag with all

1029
00:33:35,970 --> 00:33:38,309
the values in for you so you don't even

1030
00:33:37,169 --> 00:33:40,649
have<font color="#E5E5E5"> to do this you could build it into</font>

1031
00:33:38,309 --> 00:33:41,908
your bill pipeline so you can

1032
00:33:40,649 --> 00:33:44,070
automatically generate these hashes of

1033
00:33:41,909 --> 00:33:44,970
files into deployments and things you

1034
00:33:44,070 --> 00:33:48,779
<font color="#E5E5E5">know there's loads of different ways to</font>

1035
00:33:44,970 --> 00:33:51,090
<font color="#E5E5E5">do this and it can look a bit messy</font>

1036
00:33:48,779 --> 00:33:52,860
that's kind of that's<font color="#CCCCCC"> the script</font><font color="#E5E5E5"> tag</font>

1037
00:33:51,090 --> 00:33:54,899
there it's only<font color="#CCCCCC"> got the shower 256 and</font>

1038
00:33:52,860 --> 00:33:57,508
384 values and I couldn't fit the 512

1039
00:33:54,899 --> 00:33:58,799
one on as well so it does make the

1040
00:33:57,509 --> 00:34:00,570
script tags a little bit bigger but

1041
00:33:58,799 --> 00:34:02,730
that's it that's sr<font color="#CCCCCC"> i fully deployed</font>

1042
00:34:00,570 --> 00:34:04,200
I've got<font color="#E5E5E5"> away</font><font color="#CCCCCC"> fetched out J profile</font>

1043
00:34:02,730 --> 00:34:06,389
generated the hashes and put them in the

1044
00:34:04,200 --> 00:34:07,799
script tag done takes<font color="#E5E5E5"> about 10 seconds</font>

1045
00:34:06,389 --> 00:34:08,819
<font color="#E5E5E5">and there's no maintenance from that</font>

1046
00:34:07,799 --> 00:34:10,679
point forwards as long as<font color="#E5E5E5"> you're</font>

1047
00:34:08,819 --> 00:34:12,270
referencing a particular version of

1048
00:34:10,679 --> 00:34:14,250
jQuery and you don't want your CDN to be

1049
00:34:12,270 --> 00:34:16,020
changing code versions and things anyway

1050
00:34:14,250 --> 00:34:19,619
because that's potentially a terrible

1051
00:34:16,020 --> 00:34:21,989
idea so back<font color="#E5E5E5"> to the original</font><font color="#CCCCCC"> third party</font>

1052
00:34:19,619 --> 00:34:25,169
trust<font color="#E5E5E5"> problem now I have my nice super</font>

1053
00:34:21,989 --> 00:34:27,000
secure website and the content will be

1054
00:34:25,168 --> 00:34:28,290
blocked it will get the file it will get

1055
00:34:27,000 --> 00:34:29,609
jquery from the CDN maybe they've

1056
00:34:28,290 --> 00:34:31,859
switched it out to be<font color="#CCCCCC"> a keylogger or</font>

1057
00:34:29,609 --> 00:34:33,989
<font color="#CCCCCC">rickroll whatever it will hash the file</font>

1058
00:34:31,859 --> 00:34:35,520
and it will say this file doesn't match

1059
00:34:33,989 --> 00:34:37,709
the hash I was expecting this<font color="#E5E5E5"> is not</font>

1060
00:34:35,520 --> 00:34:39,810
file that I wanted and it will<font color="#E5E5E5"> just</font>

1061
00:34:37,710 --> 00:34:41,668
throw it away now there is also the

1062
00:34:39,810 --> 00:34:43,529
ability to<font color="#E5E5E5"> have kind of a fallback</font>

1063
00:34:41,668 --> 00:34:45,239
mechanism if you will it was in the

1064
00:34:43,530 --> 00:34:47,520
specification so if you load this file

1065
00:34:45,239 --> 00:34:48,839
from the CDN and something happens the

1066
00:34:47,520 --> 00:34:50,190
hash doesn't match there was another

1067
00:34:48,839 --> 00:34:51,839
<font color="#E5E5E5">attribute where you could specify a</font>

1068
00:34:50,190 --> 00:34:53,970
fallback location somewhere on your own

1069
00:34:51,839 --> 00:34:56,668
site perhaps that didn't make it through

1070
00:34:53,969 --> 00:34:58,618
but what I saw there was a talk at<font color="#E5E5E5"> Def</font>

1071
00:34:56,668 --> 00:35:01,440
<font color="#E5E5E5">Con and a couple of guys have basically</font>

1072
00:34:58,619 --> 00:35:03,930
written a tiny little script that will

1073
00:35:01,440 --> 00:35:05,400
look for the events of scripts<font color="#E5E5E5"> being</font>

1074
00:35:03,930 --> 00:35:07,319
blocked with s RI and then you can just

1075
00:35:05,400 --> 00:35:08,550
load in<font color="#E5E5E5"> your own local version so it</font>

1076
00:35:07,319 --> 00:35:10,410
<font color="#E5E5E5">will say right loading from the</font><font color="#CCCCCC"> CD</font><font color="#E5E5E5"> and</font>

1077
00:35:08,550 --> 00:35:12,000
something went wrong okay Lloyd jquery

1078
00:35:10,410 --> 00:35:13,140
from my domain instead as a backup so

1079
00:35:12,000 --> 00:35:16,140
you can<font color="#E5E5E5"> I have a fallback as well with</font>

1080
00:35:13,140 --> 00:35:18,118
sr<font color="#CCCCCC"> I if the CDN you know does do</font>

1081
00:35:16,140 --> 00:35:19,710
something bad and changes the file then

1082
00:35:18,119 --> 00:35:21,660
you can also have a backup option and

1083
00:35:19,710 --> 00:35:23,460
not have to worry about your website

1084
00:35:21,660 --> 00:35:24,540
going offline which is something<font color="#E5E5E5"> that a</font>

1085
00:35:23,460 --> 00:35:25,770
lot of people worry<font color="#CCCCCC"> about but when you</font>

1086
00:35:24,540 --> 00:35:27,450
<font color="#E5E5E5">think about it if the CD hands change</font>

1087
00:35:25,770 --> 00:35:31,589
<font color="#E5E5E5">the file then you probably don't wanna</font>

1088
00:35:27,450 --> 00:35:33,990
be like carrying on anyway so what I

1089
00:35:31,589 --> 00:35:35,578
want<font color="#CCCCCC"> to do now I've got</font><font color="#E5E5E5"> I want to demo</font>

1090
00:35:33,990 --> 00:35:36,959
quite a few of<font color="#CCCCCC"> these</font><font color="#E5E5E5"> I was thinking of</font>

1091
00:35:35,579 --> 00:35:37,619
<font color="#E5E5E5">doing it throughout but I don't want to</font>

1092
00:35:36,960 --> 00:35:40,829
keep telling in

1093
00:35:37,619 --> 00:35:43,619
out the slides so I actually want<font color="#E5E5E5"> to</font>

1094
00:35:40,829 --> 00:35:45,690
demo a few of these things excuse me up

1095
00:35:43,619 --> 00:35:47,069
and<font color="#CCCCCC"> running now my twitter handle is</font>

1096
00:35:45,690 --> 00:35:48,450
<font color="#E5E5E5">that i'm going to send out a couple of</font>

1097
00:35:47,069 --> 00:35:50,730
tweets with links in for you to click<font color="#CCCCCC"> i</font>

1098
00:35:48,450 --> 00:35:52,319
would like<font color="#E5E5E5"> some of you guys to click on</font>

1099
00:35:50,730 --> 00:35:57,869
them because some of them play music so

1100
00:35:52,319 --> 00:35:59,400
make sure your device<font color="#CCCCCC"> has sound on and</font>

1101
00:35:57,869 --> 00:36:06,240
we<font color="#CCCCCC"> can actually see some of these</font><font color="#E5E5E5"> things</font>

1102
00:35:59,400 --> 00:36:10,710
in action excuse me not married he's

1103
00:36:06,240 --> 00:36:13,200
<font color="#E5E5E5">gone off yet so the first one that</font><font color="#CCCCCC"> I</font>

1104
00:36:10,710 --> 00:36:15,029
<font color="#E5E5E5">want to have a look at is going back to</font>

1105
00:36:13,200 --> 00:36:17,368
CS be here and I want to<font color="#E5E5E5"> look at a basic</font>

1106
00:36:15,029 --> 00:36:18,539
content injection attack so I'm just

1107
00:36:17,369 --> 00:36:21,359
copying a piece of JavaScript there

1108
00:36:18,539 --> 00:36:24,059
nothing particular and you know what

1109
00:36:21,359 --> 00:36:27,598
less actually I wonder if the demo gods

1110
00:36:24,059 --> 00:36:31,140
would<font color="#CCCCCC"> be nice anyone here work with</font>

1111
00:36:27,599 --> 00:36:33,390
<font color="#CCCCCC">Barclays no good i'm going to use the</font>

1112
00:36:31,140 --> 00:36:34,740
Barkers website as an example then I had

1113
00:36:33,390 --> 00:36:39,089
to change this but I did this last time

1114
00:36:34,740 --> 00:36:40,258
resume for the handle awkward and I'm

1115
00:36:39,089 --> 00:36:42,269
basically<font color="#E5E5E5"> right so I'm going</font><font color="#CCCCCC"> to go to</font>

1116
00:36:40,259 --> 00:36:43,890
<font color="#E5E5E5">the console Wow write a load of rubbish</font>

1117
00:36:42,269 --> 00:36:46,109
so ignore all those areas I don't know

1118
00:36:43,890 --> 00:36:47,400
what's wrong<font color="#CCCCCC"> with</font><font color="#E5E5E5"> their website so</font>

1119
00:36:46,109 --> 00:36:48,900
<font color="#E5E5E5">basically the piece of JavaScript I've</font>

1120
00:36:47,400 --> 00:36:50,519
just copied well I'm going<font color="#E5E5E5"> to do is I'm</font>

1121
00:36:48,900 --> 00:36:52,200
going<font color="#CCCCCC"> to paste it into</font><font color="#E5E5E5"> the console and</font>

1122
00:36:50,519 --> 00:36:53,339
allow it to run so i'm going<font color="#E5E5E5"> to paste it</font>

1123
00:36:52,200 --> 00:36:55,169
in hit enter and i'll close the console

1124
00:36:53,339 --> 00:36:58,769
so you can watch what this piece of

1125
00:36:55,170 --> 00:37:05,940
JavaScript does so<font color="#E5E5E5"> pace the script soon</font>

1126
00:36:58,769 --> 00:37:08,959
hit enter and you can now make this

1127
00:37:05,940 --> 00:37:08,960
website<font color="#CCCCCC"> to do the Harlem shake</font>

1128
00:37:09,720 --> 00:37:18,580
so when it actually fixing it just grabs

1129
00:37:16,900 --> 00:37:22,960
all the elements on the page and does

1130
00:37:18,580 --> 00:37:24,400
crazy with them so this<font color="#CCCCCC"> is this is</font>

1131
00:37:22,960 --> 00:37:25,630
basically a<font color="#CCCCCC"> content injection attack</font>

1132
00:37:24,400 --> 00:37:28,240
that's really annoying let me<font color="#E5E5E5"> just get</font>

1133
00:37:25,630 --> 00:37:29,890
rid of that who here thinks that that's

1134
00:37:28,240 --> 00:37:33,609
<font color="#E5E5E5">actually indicative of any kind of</font>

1135
00:37:29,890 --> 00:37:34,900
problem yeah<font color="#E5E5E5"> okay does I don't think</font>

1136
00:37:33,610 --> 00:37:38,230
that's not a problem because I<font color="#CCCCCC"> just did</font>

1137
00:37:34,900 --> 00:37:40,960
it<font color="#CCCCCC"> my browser and me okay that's good</font>

1138
00:37:38,230 --> 00:37:42,130
response so what I've done those<font color="#E5E5E5"> I've</font>

1139
00:37:40,960 --> 00:37:44,290
injected the content locally so

1140
00:37:42,130 --> 00:37:45,610
obviously that's only affected my copy

1141
00:37:44,290 --> 00:37:47,350
of<font color="#E5E5E5"> the page of my browser it's not</font>

1142
00:37:45,610 --> 00:37:48,670
happening to anyone else these you know

1143
00:37:47,350 --> 00:37:51,400
copies of the page and their browsers no

1144
00:37:48,670 --> 00:37:52,420
one else will see<font color="#E5E5E5"> that but me so but</font>

1145
00:37:51,400 --> 00:37:54,160
what it does indicate is the fact that

1146
00:37:52,420 --> 00:37:55,840
if you can get the content there then

1147
00:37:54,160 --> 00:37:57,460
the browser will will honor it it will

1148
00:37:55,840 --> 00:37:58,810
do what it says if<font color="#E5E5E5"> you say he's play an</font>

1149
00:37:57,460 --> 00:38:00,070
annoying song and make all the things

1150
00:37:58,810 --> 00:38:02,200
bounce around then the<font color="#E5E5E5"> browser will do</font>

1151
00:38:00,070 --> 00:38:04,690
it and<font color="#E5E5E5"> all you</font><font color="#CCCCCC"> have to do is get that</font>

1152
00:38:02,200 --> 00:38:05,950
content there now I<font color="#E5E5E5"> can't do the rest of</font>

1153
00:38:04,690 --> 00:38:09,820
<font color="#E5E5E5">the demo on the Barkers website because</font>

1154
00:38:05,950 --> 00:38:11,529
I get in a lot of trouble so fortunately

1155
00:38:09,820 --> 00:38:12,910
Troy if you don't follow<font color="#E5E5E5"> try hun he's</font>

1156
00:38:11,530 --> 00:38:14,590
another security research down in ours

1157
00:38:12,910 --> 00:38:15,730
he sell this website which is<font color="#E5E5E5"> basically</font>

1158
00:38:14,590 --> 00:38:17,760
a playground where you can actually do

1159
00:38:15,730 --> 00:38:19,780
hacky things and he gives you permission

1160
00:38:17,760 --> 00:38:22,510
so what I'm going to<font color="#E5E5E5"> try</font><font color="#CCCCCC"> an do is get</font>

1161
00:38:19,780 --> 00:38:24,190
<font color="#E5E5E5">that content into the page but without</font>

1162
00:38:22,510 --> 00:38:25,030
actually doing it myself to actually get

1163
00:38:24,190 --> 00:38:26,770
it in there and<font color="#E5E5E5"> what I'm going</font><font color="#CCCCCC"> to use</font>

1164
00:38:25,030 --> 00:38:27,880
<font color="#E5E5E5">for the first example is something</font>

1165
00:38:26,770 --> 00:38:31,870
called a<font color="#CCCCCC"> reflected cross-site scripting</font>

1166
00:38:27,880 --> 00:38:34,030
attack so if<font color="#E5E5E5"> I by reflected content</font><font color="#CCCCCC"> i</font>

1167
00:38:31,870 --> 00:38:37,180
mean if i give this website the string

1168
00:38:34,030 --> 00:38:38,710
b-sides and then hit submit the website

1169
00:38:37,180 --> 00:38:40,330
sends me the page back and<font color="#CCCCCC"> it reflected</font>

1170
00:38:38,710 --> 00:38:41,950
that content into several locations you

1171
00:38:40,330 --> 00:38:43,960
can see<font color="#CCCCCC"> it's been rendered back into the</font>

1172
00:38:41,950 --> 00:38:46,000
search box there it's been rendered into

1173
00:38:43,960 --> 00:38:47,200
the page and<font color="#E5E5E5"> it's also in the address so</font>

1174
00:38:46,000 --> 00:38:48,460
i give it<font color="#E5E5E5"> a piece of content and the</font>

1175
00:38:47,200 --> 00:38:50,859
page comes back with the content in it

1176
00:38:48,460 --> 00:38:52,840
now what if i give it<font color="#E5E5E5"> a script tag if i</font>

1177
00:38:50,860 --> 00:38:56,710
give this search box a script tag and

1178
00:38:52,840 --> 00:38:58,150
say hey here's a script tag<font color="#E5E5E5"> i'm not</font>

1179
00:38:56,710 --> 00:39:00,250
<font color="#E5E5E5">going to type it all in I've got here's</font>

1180
00:38:58,150 --> 00:39:01,930
one I prepared earlier so basically<font color="#E5E5E5"> this</font>

1181
00:39:00,250 --> 00:39:04,780
<font color="#CCCCCC">is exactly the same thing I've just put</font>

1182
00:39:01,930 --> 00:39:06,549
the search term into the URL instead and

1183
00:39:04,780 --> 00:39:09,010
what<font color="#E5E5E5"> I've done is I put some script into</font>

1184
00:39:06,550 --> 00:39:10,090
the search term so the browser has sent

1185
00:39:09,010 --> 00:39:11,590
that off to the<font color="#E5E5E5"> site and the site is</font>

1186
00:39:10,090 --> 00:39:13,270
sent the page back<font color="#E5E5E5"> and written the</font>

1187
00:39:11,590 --> 00:39:15,070
script that I gave it into the page<font color="#E5E5E5"> and</font>

1188
00:39:13,270 --> 00:39:18,070
you can see now that we've popped and a

1189
00:39:15,070 --> 00:39:19,540
word it's pretty harmless but this is a

1190
00:39:18,070 --> 00:39:22,020
reflective cross-site scripting attack

1191
00:39:19,540 --> 00:39:25,470
so now what<font color="#E5E5E5"> I can do next</font>

1192
00:39:22,020 --> 00:39:29,280
is if i take my harlem shake script and

1193
00:39:25,470 --> 00:39:31,410
pass that it instead<font color="#CCCCCC"> i can now admit</font>

1194
00:39:29,280 --> 00:39:34,680
this website do the Harlem shake<font color="#CCCCCC"> and to</font>

1195
00:39:31,410 --> 00:39:36,330
prove this<font color="#CCCCCC"> is actually real</font><font color="#E5E5E5"> I will send</font>

1196
00:39:34,680 --> 00:39:38,520
out a tweet now and I<font color="#E5E5E5"> want to hear</font>

1197
00:39:36,330 --> 00:39:43,080
someone's on tits on this device playing

1198
00:39:38,520 --> 00:39:45,540
this you can you<font color="#E5E5E5"> can click it it's fine</font>

1199
00:39:43,080 --> 00:39:50,430
nothing nothing bad will happen<font color="#E5E5E5"> just to</font>

1200
00:39:45,540 --> 00:39:51,750
click click the link so that's that's

1201
00:39:50,430 --> 00:39:53,069
reflected<font color="#E5E5E5"> cross-site scripting attack</font>

1202
00:39:51,750 --> 00:39:55,440
and this is this is<font color="#E5E5E5"> basically just a</font>

1203
00:39:53,070 --> 00:39:57,420
<font color="#E5E5E5">specially crafted URL and like song so</font>

1204
00:39:55,440 --> 00:40:00,210
one click on it on to actually hear<font color="#CCCCCC"> it</font>

1205
00:39:57,420 --> 00:40:01,590
do the thing you click on that URL and

1206
00:40:00,210 --> 00:40:03,030
then<font color="#E5E5E5"> it will render that script tag into</font>

1207
00:40:01,590 --> 00:40:04,560
the page and<font color="#E5E5E5"> your copy of the page on</font>

1208
00:40:03,030 --> 00:40:06,240
your<font color="#E5E5E5"> phone will start playing the</font>

1209
00:40:04,560 --> 00:40:10,529
annoying music and doing all the crazy

1210
00:40:06,240 --> 00:40:13,229
bounce around things there we go so it

1211
00:40:10,530 --> 00:40:14,880
definitely works and this this<font color="#CCCCCC"> is okay</font>

1212
00:40:13,230 --> 00:40:18,450
but I need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get you to actually click</font>

1213
00:40:14,880 --> 00:40:20,670
on this specially crafted link so it's

1214
00:40:18,450 --> 00:40:22,950
that that link is got the payload in it

1215
00:40:20,670 --> 00:40:24,450
that's reflected what we want and what's

1216
00:40:22,950 --> 00:40:27,450
better is a store across<font color="#E5E5E5"> site scripting</font>

1217
00:40:24,450 --> 00:40:28,649
attack and we can do this as well so on

1218
00:40:27,450 --> 00:40:32,430
this website you have<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ability to</font>

1219
00:40:28,650 --> 00:40:38,700
look<font color="#E5E5E5"> at various different cars and sorry</font>

1220
00:40:32,430 --> 00:40:43,410
I've slogged me up some reason why did I

1221
00:40:38,700 --> 00:40:46,740
set my password as password no<font color="#E5E5E5"> why's it</font>

1222
00:40:43,410 --> 00:40:52,799
locked me out<font color="#E5E5E5"> okay i'll just create a</font>

1223
00:40:46,740 --> 00:40:55,020
new fake one sorry<font color="#E5E5E5"> about that some</font>

1224
00:40:52,800 --> 00:40:55,920
reason it's troy may reset the website

1225
00:40:55,020 --> 00:40:57,570
every now and again somebody does

1226
00:40:55,920 --> 00:40:59,550
completely deletes like his entire<font color="#E5E5E5"> site</font>

1227
00:40:57,570 --> 00:41:01,100
so he has to reload it from an image

1228
00:40:59,550 --> 00:41:03,390
which means I lose my account sometimes

1229
00:41:01,100 --> 00:41:09,630
so you can go onto the<font color="#E5E5E5"> leaderboard here</font>

1230
00:41:03,390 --> 00:41:11,009
<font color="#E5E5E5">ah this is your the problem with using a</font>

1231
00:41:09,630 --> 00:41:12,300
hacky website so<font color="#E5E5E5"> you go into the</font>

1232
00:41:11,010 --> 00:41:14,490
leaderboard here and view information

1233
00:41:12,300 --> 00:41:16,140
about a particular car but what you can

1234
00:41:14,490 --> 00:41:17,879
also do is you can cast<font color="#E5E5E5"> a vote and when</font>

1235
00:41:16,140 --> 00:41:19,920
you vote it puts your name down here and

1236
00:41:17,880 --> 00:41:20,940
it also puts a comment at the bottom<font color="#CCCCCC"> so</font>

1237
00:41:19,920 --> 00:41:24,390
I'm<font color="#E5E5E5"> going to vote on one of these cars</font>

1238
00:41:20,940 --> 00:41:27,270
and<font color="#CCCCCC"> leave a comment nothing to see here</font>

1239
00:41:24,390 --> 00:41:29,549
dark and what I'm<font color="#CCCCCC"> going to do I have a</font>

1240
00:41:27,270 --> 00:41:31,830
script tag here as well i'm gonna<font color="#E5E5E5"> copy</font>

1241
00:41:29,550 --> 00:41:33,840
that script tag a pen lands the end of

1242
00:41:31,830 --> 00:41:34,860
my comment and<font color="#E5E5E5"> i'm going to vote so what</font>

1243
00:41:33,840 --> 00:41:35,880
it will now do is it will leave my

1244
00:41:34,860 --> 00:41:38,250
comment<font color="#E5E5E5"> on the bottom</font>

1245
00:41:35,880 --> 00:41:39,690
page now my comment is there but<font color="#E5E5E5"> the</font>

1246
00:41:38,250 --> 00:41:40,950
browser has also rendered that script

1247
00:41:39,690 --> 00:41:42,390
tag into the page<font color="#E5E5E5"> and it's now actually</font>

1248
00:41:40,950 --> 00:41:45,210
stored in the page this is<font color="#CCCCCC"> a persistent</font>

1249
00:41:42,390 --> 00:41:48,328
issue so what happens now if I revisit

1250
00:41:45,210 --> 00:41:51,690
that page somebody else's cross-site

1251
00:41:48,329 --> 00:41:53,160
scripting payload pops up and that

1252
00:41:51,690 --> 00:41:55,619
script tag is now actually in<font color="#CCCCCC"> that page</font>

1253
00:41:53,160 --> 00:41:57,808
permanently so there's no special or

1254
00:41:55,619 --> 00:42:02,250
crafted URL here and<font color="#E5E5E5"> I'll tweet this one</font>

1255
00:41:57,809 --> 00:42:03,420
out again another<font color="#CCCCCC"> one</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> it's</font>

1256
00:42:02,250 --> 00:42:04,980
<font color="#E5E5E5">not a crafted URL there's nothing in the</font>

1257
00:42:03,420 --> 00:42:07,319
URL at all it's literally<font color="#CCCCCC"> just that page</font>

1258
00:42:04,980 --> 00:42:08,759
and<font color="#CCCCCC"> that page now actually has that</font>

1259
00:42:07,319 --> 00:42:11,009
payload embedded into it so again if you

1260
00:42:08,759 --> 00:42:12,869
click on that<font color="#E5E5E5"> link</font><font color="#CCCCCC"> now in your browser's</font>

1261
00:42:11,009 --> 00:42:14,549
it will do that permanently until

1262
00:42:12,869 --> 00:42:16,289
somebody goes and actually delete that

1263
00:42:14,549 --> 00:42:19,079
we will get the<font color="#E5E5E5"> Harlem shake popping up</font>

1264
00:42:16,289 --> 00:42:21,240
in the background<font color="#E5E5E5"> every time and again</font>

1265
00:42:19,079 --> 00:42:22,589
this the problem here is that the

1266
00:42:21,240 --> 00:42:23,788
browser is rendering this content into

1267
00:42:22,589 --> 00:42:25,019
the page and<font color="#E5E5E5"> it's saying go and</font><font color="#CCCCCC"> respects</font>

1268
00:42:23,789 --> 00:42:26,250
<font color="#E5E5E5">this particular style sheet that does</font>

1269
00:42:25,019 --> 00:42:29,250
<font color="#E5E5E5">all the crazy animations go and fetch</font>

1270
00:42:26,250 --> 00:42:30,450
this audio clip and the browser doesn't

1271
00:42:29,250 --> 00:42:31,920
know<font color="#CCCCCC"> that it's not</font><font color="#E5E5E5"> supposed to do that</font>

1272
00:42:30,450 --> 00:42:33,779
<font color="#E5E5E5">because we put the script tag into the</font>

1273
00:42:31,920 --> 00:42:36,180
page and the browser doesn't know and

1274
00:42:33,779 --> 00:42:37,140
this<font color="#E5E5E5"> is what</font><font color="#CCCCCC"> we can fix with CSP so</font>

1275
00:42:36,180 --> 00:42:40,288
going right back to the very first

1276
00:42:37,140 --> 00:42:42,779
example when I grabbed the script there

1277
00:42:40,289 --> 00:42:44,640
<font color="#CCCCCC">I'm going</font><font color="#E5E5E5"> to go to one</font><font color="#CCCCCC"> of the sites that</font>

1278
00:42:42,779 --> 00:42:46,319
<font color="#E5E5E5">Iram so this is the site report you're</font>

1279
00:42:44,640 --> 00:42:49,170
<font color="#E5E5E5">either i mentioned i run this i deploy</font>

1280
00:42:46,319 --> 00:42:50,490
CSP on here and<font color="#E5E5E5"> what I'm going to do is</font>

1281
00:42:49,170 --> 00:42:53,069
the very first<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that I demo to you</font>

1282
00:42:50,490 --> 00:42:54,029
open the console paste<font color="#E5E5E5"> the script in and</font>

1283
00:42:53,069 --> 00:42:55,230
I'm going to<font color="#CCCCCC"> hit enter so it should</font>

1284
00:42:54,029 --> 00:42:56,849
start doing<font color="#E5E5E5"> the crazy shaky things</font>

1285
00:42:55,230 --> 00:43:00,869
because I put<font color="#E5E5E5"> the script into the</font>

1286
00:42:56,849 --> 00:43:03,269
browser but it<font color="#E5E5E5"> doesn't let me zoom in so</font>

1287
00:43:00,869 --> 00:43:04,319
you can<font color="#E5E5E5"> actually see a bit better so</font>

1288
00:43:03,269 --> 00:43:05,700
it's a seer<font color="#E5E5E5"> the some areas in the</font>

1289
00:43:04,319 --> 00:43:07,589
console now and it says refused to load

1290
00:43:05,700 --> 00:43:09,240
the style sheet from blah blah blah

1291
00:43:07,589 --> 00:43:11,670
<font color="#E5E5E5">domain because it violates the following</font>

1292
00:43:09,240 --> 00:43:12,839
content security policy directive style

1293
00:43:11,670 --> 00:43:15,029
sauce and then there's another<font color="#E5E5E5"> one down</font>

1294
00:43:12,839 --> 00:43:17,369
here refuse to load the media<font color="#E5E5E5"> because it</font>

1295
00:43:15,029 --> 00:43:18,990
violates the content security policy so

1296
00:43:17,369 --> 00:43:20,099
now<font color="#E5E5E5"> even though we've actually managed</font>

1297
00:43:18,990 --> 00:43:21,899
<font color="#CCCCCC">to get the script into the page that</font>

1298
00:43:20,099 --> 00:43:24,000
<font color="#CCCCCC">loads the style sheet and loads of media</font>

1299
00:43:21,900 --> 00:43:25,319
object the browser knows because of the

1300
00:43:24,000 --> 00:43:26,779
content security policy that I'm not

1301
00:43:25,319 --> 00:43:29,339
supposed<font color="#E5E5E5"> to be loading things from</font>

1302
00:43:26,779 --> 00:43:31,170
amazon AWS calm because<font color="#CCCCCC"> i don't let any</font>

1303
00:43:29,339 --> 00:43:32,549
content from a so<font color="#E5E5E5"> you can completely</font>

1304
00:43:31,170 --> 00:43:36,180
neutralize that attack with content

1305
00:43:32,549 --> 00:43:40,410
security policy one of the other things

1306
00:43:36,180 --> 00:43:42,149
<font color="#CCCCCC">I touched on as well was the form action</font>

1307
00:43:40,410 --> 00:43:44,269
I really like<font color="#E5E5E5"> the form action in CSP and</font>

1308
00:43:42,150 --> 00:43:47,269
<font color="#E5E5E5">honestly I</font><font color="#CCCCCC"> just think that</font><font color="#E5E5E5"> everybody</font>

1309
00:43:44,269 --> 00:43:47,269
what

1310
00:43:47,600 --> 00:43:53,220
yeah are you<font color="#E5E5E5"> hacking me while I'm on</font>

1311
00:43:49,980 --> 00:43:56,550
stage so I'm going<font color="#CCCCCC"> to go to</font><font color="#E5E5E5"> the login</font>

1312
00:43:53,220 --> 00:44:00,689
page and I'm going<font color="#E5E5E5"> to have a look at my</font>

1313
00:43:56,550 --> 00:44:03,290
login form now my login form posts as

1314
00:44:00,690 --> 00:44:06,480
you would expect back to me post to my

1315
00:44:03,290 --> 00:44:08,100
authentic logging controller what I'm

1316
00:44:06,480 --> 00:44:09,540
going<font color="#CCCCCC"> to do actually I'll just</font>

1317
00:44:08,100 --> 00:44:11,700
demonstrate that this works first so<font color="#E5E5E5"> I</font>

1318
00:44:09,540 --> 00:44:14,160
have a one password on my laptop<font color="#E5E5E5"> I use</font>

1319
00:44:11,700 --> 00:44:20,339
the password manager you all should let

1320
00:44:14,160 --> 00:44:22,020
me just<font color="#E5E5E5"> don't like that so I have a</font>

1321
00:44:20,340 --> 00:44:23,550
keyboard shortcut for one password i

1322
00:44:22,020 --> 00:44:25,020
basically press command back slash i

1323
00:44:23,550 --> 00:44:26,190
have multiple accounts for this<font color="#CCCCCC"> website</font>

1324
00:44:25,020 --> 00:44:30,140
he says which account do you<font color="#E5E5E5"> want to</font><font color="#CCCCCC"> log</font>

1325
00:44:26,190 --> 00:44:32,130
<font color="#CCCCCC">in</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> I hit Scott helmet hotmail com</font>

1326
00:44:30,140 --> 00:44:33,600
and it automatically fills in the

1327
00:44:32,130 --> 00:44:35,880
<font color="#E5E5E5">username and password and hits login for</font>

1328
00:44:33,600 --> 00:44:37,110
me so the 1password literally does paste

1329
00:44:35,880 --> 00:44:38,520
my username and password into the box

1330
00:44:37,110 --> 00:44:39,690
and say is logging with this user<font color="#E5E5E5"> name</font>

1331
00:44:38,520 --> 00:44:42,240
and password right that's how it's

1332
00:44:39,690 --> 00:44:44,280
supposed to work<font color="#CCCCCC"> but what happens if</font>

1333
00:44:42,240 --> 00:44:46,770
that log in form wasn't sending that

1334
00:44:44,280 --> 00:44:48,540
back to me maybe you know like<font color="#CCCCCC"> I say an</font>

1335
00:44:46,770 --> 00:44:50,280
employee had a bad day someone logged in

1336
00:44:48,540 --> 00:44:52,860
to maybe use<font color="#E5E5E5"> WordPress and you're</font>

1337
00:44:50,280 --> 00:44:54,000
terrible logs into your CMS and changes

1338
00:44:52,860 --> 00:44:55,530
the form you know there's a lot<font color="#E5E5E5"> of</font>

1339
00:44:54,000 --> 00:44:56,970
different<font color="#CCCCCC"> ways that this could be</font>

1340
00:44:55,530 --> 00:44:59,880
changed it doesn't<font color="#E5E5E5"> matter how it's</font>

1341
00:44:56,970 --> 00:45:01,379
changed what we want is to know that

1342
00:44:59,880 --> 00:45:03,720
it's secure if it's not so I'm going to

1343
00:45:01,380 --> 00:45:06,480
<font color="#E5E5E5">do I'm going to change I'm going to</font>

1344
00:45:03,720 --> 00:45:10,770
change the action here let's go to what

1345
00:45:06,480 --> 00:45:12,540
is this do password our PHP so does

1346
00:45:10,770 --> 00:45:14,580
everyone agree when I hit submit on this

1347
00:45:12,540 --> 00:45:17,220
<font color="#E5E5E5">form that the browser will actually post</font>

1348
00:45:14,580 --> 00:45:18,569
to evil com does anyone disagree I've

1349
00:45:17,220 --> 00:45:19,980
changed the page it says post of evil

1350
00:45:18,570 --> 00:45:21,690
com so that's what the browser's going

1351
00:45:19,980 --> 00:45:23,010
to do so he doesn't matter where this

1352
00:45:21,690 --> 00:45:25,830
change happens I know that I've just

1353
00:45:23,010 --> 00:45:27,240
done this locally but I know that I've

1354
00:45:25,830 --> 00:45:28,319
just done this locally but it doesn't

1355
00:45:27,240 --> 00:45:29,490
matter<font color="#E5E5E5"> where this change happens I'm</font>

1356
00:45:28,320 --> 00:45:31,110
going to do exactly the same thing and

1357
00:45:29,490 --> 00:45:32,759
when they hit command back slash pop up

1358
00:45:31,110 --> 00:45:34,880
my password manager and I'm going<font color="#E5E5E5"> to say</font>

1359
00:45:32,760 --> 00:45:38,070
<font color="#CCCCCC">login with this user name</font><font color="#E5E5E5"> and password</font>

1360
00:45:34,880 --> 00:45:39,300
except this time it's<font color="#CCCCCC"> not worked and you</font>

1361
00:45:38,070 --> 00:45:41,250
may have noticed a little<font color="#E5E5E5"> error popped</font>

1362
00:45:39,300 --> 00:45:43,200
up in the console over here<font color="#CCCCCC"> assuming</font><font color="#E5E5E5"> so</font>

1363
00:45:41,250 --> 00:45:44,730
you<font color="#E5E5E5"> can see that and it says</font><font color="#CCCCCC"> that the</font>

1364
00:45:43,200 --> 00:45:46,830
<font color="#E5E5E5">browser refused to send form data to</font>

1365
00:45:44,730 --> 00:45:49,470
<font color="#E5E5E5">Eagle calm because it violates following</font>

1366
00:45:46,830 --> 00:45:51,270
CSP directive form action<font color="#E5E5E5"> itself so Mike</font>

1367
00:45:49,470 --> 00:45:53,459
format can say is the only time<font color="#CCCCCC"> you ever</font>

1368
00:45:51,270 --> 00:45:55,920
send any form data is to me or don't

1369
00:45:53,460 --> 00:45:57,450
send it so in this scenario again it

1370
00:45:55,920 --> 00:45:59,700
doesn't matter who or how or why that

1371
00:45:57,450 --> 00:46:00,210
form got changed you know<font color="#E5E5E5"> that the</font>

1372
00:45:59,700 --> 00:46:01,890
browser<font color="#CCCCCC"> will</font>

1373
00:46:00,210 --> 00:46:03,660
not<font color="#E5E5E5"> post your user credentials to evil</font>

1374
00:46:01,890 --> 00:46:05,310
calm and hopefully nobody here wants

1375
00:46:03,660 --> 00:46:07,830
user credentials<font color="#E5E5E5"> to ever be posted to</font>

1376
00:46:05,310 --> 00:46:11,160
evil<font color="#E5E5E5"> calm so that's one of the</font>

1377
00:46:07,830 --> 00:46:17,819
additional things that<font color="#CCCCCC"> you can do with</font>

1378
00:46:11,160 --> 00:46:22,230
CSP as well I set up oops I<font color="#E5E5E5"> think it was</font>

1379
00:46:17,820 --> 00:46:24,270
<font color="#E5E5E5">on this URL here so just</font><font color="#CCCCCC"> to quickly show</font>

1380
00:46:22,230 --> 00:46:25,619
you what s RI looks like so I set up

1381
00:46:24,270 --> 00:46:28,410
this page on my site of the day just<font color="#E5E5E5"> to</font>

1382
00:46:25,619 --> 00:46:30,000
quickly demo this I base our to script

1383
00:46:28,410 --> 00:46:31,890
tags on the page one's got<font color="#CCCCCC"> a valid hash</font>

1384
00:46:30,000 --> 00:46:33,150
for the file from the CDN as you would

1385
00:46:31,890 --> 00:46:35,569
<font color="#E5E5E5">expect the other one has an</font>

1386
00:46:33,150 --> 00:46:37,920
intentionally invalid file hash and

1387
00:46:35,570 --> 00:46:39,180
quite<font color="#CCCCCC"> simply all the browser does when</font>

1388
00:46:37,920 --> 00:46:42,570
you load the page is it throws an error

1389
00:46:39,180 --> 00:46:44,819
in the dev console and it says failed to

1390
00:46:42,570 --> 00:46:46,650
find a valid digest for this particular

1391
00:46:44,820 --> 00:46:49,500
resource being loaded from the CDN and

1392
00:46:46,650 --> 00:46:51,000
it tells you<font color="#CCCCCC"> what the</font><font color="#E5E5E5"> hash was and it</font>

1393
00:46:49,500 --> 00:46:52,830
says it's over there the resource has

1394
00:46:51,000 --> 00:46:54,450
been blocked so we got the script back

1395
00:46:52,830 --> 00:46:56,310
from the CDM in this case<font color="#E5E5E5"> have obviously</font>

1396
00:46:54,450 --> 00:46:58,439
intentionally misconfigured the hash

1397
00:46:56,310 --> 00:46:59,759
attribute for it but<font color="#E5E5E5"> it knows the</font>

1398
00:46:58,440 --> 00:47:01,080
browser knows that something was wrong

1399
00:46:59,760 --> 00:47:03,330
this file is not<font color="#E5E5E5"> the file that we're</font>

1400
00:47:01,080 --> 00:47:05,190
expecting so it simply blocks it and<font color="#CCCCCC"> as</font>

1401
00:47:03,330 --> 00:47:06,359
I said<font color="#CCCCCC"> s</font><font color="#E5E5E5"> our eyes is just set and</font>

1402
00:47:05,190 --> 00:47:08,700
forget' if you're<font color="#E5E5E5"> putting a script tag</font>

1403
00:47:06,359 --> 00:47:12,029
or a style sheet into a page just put

1404
00:47:08,700 --> 00:47:18,540
the<font color="#E5E5E5"> utter I attributes on them am i okay</font>

1405
00:47:12,030 --> 00:47:21,240
for time can<font color="#E5E5E5"> I yeah okay oh well they're</font>

1406
00:47:18,540 --> 00:47:25,109
<font color="#E5E5E5">going to miss out they're going to miss</font>

1407
00:47:21,240 --> 00:47:29,189
out on there I have another one<font color="#E5E5E5"> here as</font>

1408
00:47:25,109 --> 00:47:30,270
well<font color="#E5E5E5"> so what I'll do I need to reload</font>

1409
00:47:29,190 --> 00:47:35,070
that<font color="#E5E5E5"> page because that's</font><font color="#CCCCCC"> going to equal</font>

1410
00:47:30,270 --> 00:47:36,990
com I just<font color="#E5E5E5"> want to show CSP reporting I</font>

1411
00:47:35,070 --> 00:47:39,150
mentioned with CSP reporting when things

1412
00:47:36,990 --> 00:47:41,430
violate your policy the browser<font color="#E5E5E5"> will</font>

1413
00:47:39,150 --> 00:47:43,170
<font color="#E5E5E5">provide that post object the JSON</font>

1414
00:47:41,430 --> 00:47:45,060
payload to you that actually happens in

1415
00:47:43,170 --> 00:47:47,070
real time as well and<font color="#E5E5E5"> this is the other</font>

1416
00:47:45,060 --> 00:47:48,180
<font color="#E5E5E5">thing i like about CSP is that someone</font>

1417
00:47:47,070 --> 00:47:50,190
successfully finds a cross-site

1418
00:47:48,180 --> 00:47:52,140
scripting exploit on your website you

1419
00:47:50,190 --> 00:47:53,820
will literally get like the first time

1420
00:47:52,140 --> 00:47:55,410
<font color="#CCCCCC">it's exploited you literally get a post</font>

1421
00:47:53,820 --> 00:47:57,170
back that says something just went wrong

1422
00:47:55,410 --> 00:47:59,250
on this page so<font color="#E5E5E5"> you actually get</font>

1423
00:47:57,170 --> 00:48:03,260
basically kind of real-time threat

1424
00:47:59,250 --> 00:48:03,260
detection almost for free with CSP and

1425
00:48:03,710 --> 00:48:07,410
this service that<font color="#E5E5E5"> I run basically just</font>

1426
00:48:05,880 --> 00:48:09,030
listens for these reports and it catches

1427
00:48:07,410 --> 00:48:12,828
them in passes them does pretty grass

1428
00:48:09,030 --> 00:48:18,170
and things but this particular page here

1429
00:48:12,829 --> 00:48:21,200
I only it looks<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> okay this page</font>

1430
00:48:18,170 --> 00:48:22,609
on my site basically has intentional

1431
00:48:21,200 --> 00:48:24,919
violation so I put things on here that

1432
00:48:22,609 --> 00:48:27,969
breach my CSP on purpose to force the

1433
00:48:24,920 --> 00:48:29,989
browser to send so if I reload this page

1434
00:48:27,969 --> 00:48:31,219
once that's reloaded the browser will

1435
00:48:29,989 --> 00:48:33,229
<font color="#E5E5E5">send the reports as you can see in the</font>

1436
00:48:31,219 --> 00:48:34,789
console if I tab back over right before

1437
00:48:33,229 --> 00:48:36,348
I can even get back<font color="#E5E5E5"> to the other tab the</font>

1438
00:48:34,789 --> 00:48:38,869
browser's already fired the post payload

1439
00:48:36,349 --> 00:48:40,039
with the<font color="#CCCCCC"> reporting that</font><font color="#E5E5E5"> stays here so</font>

1440
00:48:38,869 --> 00:48:42,079
you can<font color="#CCCCCC"> see</font><font color="#E5E5E5"> I have just loaded that page</font>

1441
00:48:40,039 --> 00:48:43,309
CSP test there's an image I'm

1442
00:48:42,079 --> 00:48:46,099
intentionally trying to load it with the

1443
00:48:43,309 --> 00:48:47,359
FTP protocol which I don't<font color="#E5E5E5"> want list so</font>

1444
00:48:46,099 --> 00:48:48,650
literally<font color="#CCCCCC"> in the time that it</font><font color="#E5E5E5"> took</font><font color="#CCCCCC"> me to</font>

1445
00:48:47,359 --> 00:48:49,819
shift from one tub to the other the

1446
00:48:48,650 --> 00:48:51,319
browser's already fired the payload

1447
00:48:49,819 --> 00:48:52,459
we've already received it parsley and

1448
00:48:51,319 --> 00:48:55,219
you know there's a problem on<font color="#E5E5E5"> your</font>

1449
00:48:52,459 --> 00:48:57,019
<font color="#E5E5E5">website in the</font><font color="#CCCCCC"> time that it took me to</font>

1450
00:48:55,219 --> 00:48:58,359
click from one tab to<font color="#CCCCCC"> the other so you</font>

1451
00:48:57,019 --> 00:49:00,799
can<font color="#E5E5E5"> literally get real time feedback</font>

1452
00:48:58,359 --> 00:49:03,558
from your content security policy when

1453
00:49:00,799 --> 00:49:05,299
it's deployed in<font color="#E5E5E5"> the wild and this the</font>

1454
00:49:03,559 --> 00:49:07,549
reason<font color="#E5E5E5"> I sell report your eye and I run</font>

1455
00:49:05,299 --> 00:49:09,469
it is because CSP reporting is

1456
00:49:07,549 --> 00:49:11,779
incredibly powerful I found so many

1457
00:49:09,469 --> 00:49:14,509
problems<font color="#E5E5E5"> on websites well we've deployed</font>

1458
00:49:11,779 --> 00:49:15,650
reporting for them and if you want if

1459
00:49:14,509 --> 00:49:17,449
you<font color="#E5E5E5"> need to sell it to the</font><font color="#CCCCCC"> business you</font>

1460
00:49:15,650 --> 00:49:19,369
can like make pretty graphs and things

1461
00:49:17,449 --> 00:49:21,920
and make it look awesome but from a

1462
00:49:19,369 --> 00:49:23,539
technical standpoint CSP reporting<font color="#E5E5E5"> is so</font>

1463
00:49:21,920 --> 00:49:25,249
valuable you can literally get real time

1464
00:49:23,539 --> 00:49:27,079
feedback from your visitors browsers

1465
00:49:25,249 --> 00:49:31,698
about what's going on in your site in

1466
00:49:27,079 --> 00:49:35,779
the wild and the last<font color="#E5E5E5"> sink so let me go</font>

1467
00:49:31,699 --> 00:49:37,339
back and just to show you how<font color="#E5E5E5"> it</font>

1468
00:49:35,779 --> 00:49:39,859
literally how easy it can be to generate

1469
00:49:37,339 --> 00:49:41,538
generate an<font color="#E5E5E5"> SR I tag I have some tools</font>

1470
00:49:39,859 --> 00:49:43,219
as loads of tools online don't feel

1471
00:49:41,539 --> 00:49:45,049
obliged to use mine but<font color="#CCCCCC"> you've literally</font>

1472
00:49:43,219 --> 00:49:47,029
just paste him that asset there you can

1473
00:49:45,049 --> 00:49:49,219
incorporate this into you know like your

1474
00:49:47,029 --> 00:49:50,209
production environments and<font color="#E5E5E5"> Italy sort</font>

1475
00:49:49,219 --> 00:49:51,440
of spits out the script tag at<font color="#E5E5E5"> the</font>

1476
00:49:50,209 --> 00:49:52,940
bottom you could just<font color="#E5E5E5"> write your own</font>

1477
00:49:51,440 --> 00:49:54,229
<font color="#E5E5E5">little script that does this you know</font>

1478
00:49:52,940 --> 00:49:55,849
scan through your<font color="#E5E5E5"> code base pull out the</font>

1479
00:49:54,229 --> 00:50:02,448
script tags and just pop them back with

1480
00:49:55,849 --> 00:50:05,119
the ESRI attributes internet so there

1481
00:50:02,449 --> 00:50:06,440
was I just out of interest actually i'm

1482
00:50:05,119 --> 00:50:11,630
just going to tweet this one as well<font color="#E5E5E5"> so</font>

1483
00:50:06,440 --> 00:50:13,609
let's see why if you<font color="#E5E5E5"> click on that one</font>

1484
00:50:11,630 --> 00:50:15,199
<font color="#CCCCCC">for me</font><font color="#E5E5E5"> hopefully what we'll be able to</font>

1485
00:50:13,609 --> 00:50:17,119
see I didn't<font color="#CCCCCC"> think about</font><font color="#E5E5E5"> this one</font>

1486
00:50:15,199 --> 00:50:18,109
actually just so you can show I can<font color="#E5E5E5"> show</font>

1487
00:50:17,119 --> 00:50:19,219
<font color="#E5E5E5">you that it's</font><font color="#CCCCCC"> definitely not faked it</font>

1488
00:50:18,109 --> 00:50:21,288
someone finds that tweet and clicks on

1489
00:50:19,219 --> 00:50:23,029
<font color="#CCCCCC">that now hopefully we should</font><font color="#E5E5E5"> see your</font>

1490
00:50:21,289 --> 00:50:24,499
actual live reports coming in just to

1491
00:50:23,029 --> 00:50:26,060
show you that it's<font color="#CCCCCC"> not a setup</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> this</font>

1492
00:50:24,499 --> 00:50:30,230
<font color="#CCCCCC">definitely</font><font color="#E5E5E5"> works</font>

1493
00:50:26,060 --> 00:50:32,930
oh there we go that's<font color="#E5E5E5"> what browser are</font>

1494
00:50:30,230 --> 00:50:37,130
you using<font color="#CCCCCC"> I doesn't know I'm one</font><font color="#E5E5E5"> chrome</font>

1495
00:50:32,930 --> 00:50:38,810
ah wonder what<font color="#E5E5E5"> browser dies is anyone</font>

1496
00:50:37,130 --> 00:50:45,560
using a weird browser that's not chrome

1497
00:50:38,810 --> 00:50:47,240
firefox safari or ie<font color="#E5E5E5"> okay that'd be</font><font color="#CCCCCC"> why</font>

1498
00:50:45,560 --> 00:50:49,100
after<font color="#E5E5E5"> look</font><font color="#CCCCCC"> up your</font><font color="#E5E5E5"> user agent</font><font color="#CCCCCC"> ways</font><font color="#E5E5E5"> to</font>

1499
00:50:47,240 --> 00:50:50,870
<font color="#E5E5E5">another but yeah that's basically it</font>

1500
00:50:49,100 --> 00:50:52,850
that's if that was an actual cross-site

1501
00:50:50,870 --> 00:50:55,009
scripting bug that was being exploited

1502
00:50:52,850 --> 00:50:56,540
and people were actually<font color="#E5E5E5"> being attacked</font>

1503
00:50:55,010 --> 00:50:57,560
by that then<font color="#E5E5E5"> that would contain all the</font>

1504
00:50:56,540 --> 00:50:59,690
information of the cross-site scripting

1505
00:50:57,560 --> 00:51:01,370
book you know<font color="#E5E5E5"> obviously it's just</font>

1506
00:50:59,690 --> 00:51:02,720
useless image reports on this one but

1507
00:51:01,370 --> 00:51:03,980
<font color="#CCCCCC">this is this is the thing</font><font color="#E5E5E5"> you can</font>

1508
00:51:02,720 --> 00:51:06,169
actually<font color="#E5E5E5"> sit there and monitor this and</font>

1509
00:51:03,980 --> 00:51:11,030
no real time and something go sideways

1510
00:51:06,170 --> 00:51:14,570
on your<font color="#E5E5E5"> website</font><font color="#CCCCCC"> and i'll leave the demos</font>

1511
00:51:11,030 --> 00:51:17,450
there actually and that's pretty much

1512
00:51:14,570 --> 00:51:18,890
<font color="#CCCCCC">everything for</font><font color="#E5E5E5"> me i'm hoping that you at</font>

1513
00:51:17,450 --> 00:51:20,060
<font color="#CCCCCC">least got enough information from these</font>

1514
00:51:18,890 --> 00:51:22,129
different technologies that you might<font color="#CCCCCC"> be</font>

1515
00:51:20,060 --> 00:51:24,200
able to<font color="#E5E5E5"> go away and</font><font color="#CCCCCC"> think can i deploy</font>

1516
00:51:22,130 --> 00:51:26,000
these can<font color="#E5E5E5"> i use them more often than not</font>

1517
00:51:24,200 --> 00:51:27,500
<font color="#E5E5E5">i find that</font><font color="#CCCCCC"> its people just don't</font><font color="#E5E5E5"> know</font>

1518
00:51:26,000 --> 00:51:29,240
<font color="#CCCCCC">about them they're not publicized widely</font>

1519
00:51:27,500 --> 00:51:31,430
so this was meant as kind of an

1520
00:51:29,240 --> 00:51:32,870
introduction hopefully to get some

1521
00:51:31,430 --> 00:51:34,399
thoughts going maybe that<font color="#CCCCCC"> you can deploy</font>

1522
00:51:32,870 --> 00:51:36,259
some of these things things like<font color="#E5E5E5"> s RI</font>

1523
00:51:34,400 --> 00:51:38,210
easy wins there's a couple of features

1524
00:51:36,260 --> 00:51:39,530
in CSP you know just go for the

1525
00:51:38,210 --> 00:51:41,390
low-hanging fruit don't go<font color="#E5E5E5"> for like</font>

1526
00:51:39,530 --> 00:51:42,950
crazy<font color="#E5E5E5"> insane policies just go for the</font>

1527
00:51:41,390 --> 00:51:44,960
low-hanging fruit and that's better<font color="#E5E5E5"> than</font>

1528
00:51:42,950 --> 00:51:47,200
where we are at the minute thank you

1529
00:51:44,960 --> 00:51:47,200
very much

