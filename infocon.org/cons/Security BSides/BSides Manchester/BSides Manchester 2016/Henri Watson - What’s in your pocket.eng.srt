1
00:00:02,520 --> 00:00:09,940
take it away wonderful so as mentioned

2
00:00:06,549 --> 00:00:13,210
the idea behind<font color="#CCCCCC"> this talk is to discuss</font>

3
00:00:09,940 --> 00:00:15,670
the data that<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> on these cards</font>

4
00:00:13,210 --> 00:00:17,730
that have just kind<font color="#E5E5E5"> of quietly crept</font>

5
00:00:15,670 --> 00:00:19,960
into our lives<font color="#E5E5E5"> over the past few years</font>

6
00:00:17,730 --> 00:00:22,119
but<font color="#E5E5E5"> before I start I should probably</font>

7
00:00:19,960 --> 00:00:25,779
<font color="#E5E5E5">introduce myself so I'm</font><font color="#CCCCCC"> currently</font>

8
00:00:22,119 --> 00:00:29,019
working in<font color="#E5E5E5"> London for a mobile payments</font>

9
00:00:25,779 --> 00:00:31,420
startup called judo payments during most

10
00:00:29,019 --> 00:00:33,580
of the year<font color="#E5E5E5"> I am a student at alberta</font>

11
00:00:31,420 --> 00:00:36,219
University up in the lovely dundee

12
00:00:33,580 --> 00:00:38,410
scotland and this year I'll be serving

13
00:00:36,219 --> 00:00:40,989
as the secretary for<font color="#CCCCCC"> the</font><font color="#E5E5E5"> ethical hacking</font>

14
00:00:38,410 --> 00:00:44,169
society and will be<font color="#E5E5E5"> organising next year</font>

15
00:00:40,989 --> 00:00:46,570
security prior<font color="#CCCCCC"> to moving to Scotland I</font>

16
00:00:44,170 --> 00:00:49,719
lived in the Dominican Republic for 13

17
00:00:46,570 --> 00:00:51,789
years<font color="#E5E5E5"> and grew</font><font color="#CCCCCC"> up there</font><font color="#E5E5E5"> and the things</font>

18
00:00:49,719 --> 00:00:55,120
<font color="#CCCCCC">that I'm interested in our</font><font color="#E5E5E5"> payments</font>

19
00:00:51,789 --> 00:00:58,020
technologies the idea<font color="#E5E5E5"> of security versus</font>

20
00:00:55,120 --> 00:01:01,718
user experience embedded devices and

21
00:00:58,020 --> 00:01:04,089
public transportation ticketing so if

22
00:01:01,719 --> 00:01:06,600
you look at<font color="#CCCCCC"> the</font><font color="#E5E5E5"> common use cases for</font>

23
00:01:04,089 --> 00:01:09,429
smart cards they're often used as

24
00:01:06,600 --> 00:01:11,919
replacements for magnetic stripe cards

25
00:01:09,430 --> 00:01:14,380
and the reason for<font color="#CCCCCC"> this is that with</font>

26
00:01:11,920 --> 00:01:16,720
magnetic stripe cards anybody can read

27
00:01:14,380 --> 00:01:19,780
or write to the cards and additionally

28
00:01:16,720 --> 00:01:22,390
they tend to<font color="#E5E5E5"> not be very durable they</font>

29
00:01:19,780 --> 00:01:26,740
might lose their encoding<font color="#E5E5E5"> and you have</font>

30
00:01:22,390 --> 00:01:29,020
to replace them more often so as a

31
00:01:26,740 --> 00:01:31,689
result smart cards very quickly grew in

32
00:01:29,020 --> 00:01:33,460
popularity because you could more or

33
00:01:31,689 --> 00:01:36,008
less trust the data that<font color="#E5E5E5"> was held on</font>

34
00:01:33,460 --> 00:01:39,280
them and hold them to a certain degree

35
00:01:36,009 --> 00:01:42,159
of security if you take a look<font color="#CCCCCC"> at your</font>

36
00:01:39,280 --> 00:01:45,130
wallet you may find a handful of these

37
00:01:42,159 --> 00:01:48,399
cards<font color="#CCCCCC"> in it you probably have a bank</font>

38
00:01:45,130 --> 00:01:50,530
card maybe you have a transit card you

39
00:01:48,399 --> 00:01:52,750
might have a student card or an office

40
00:01:50,530 --> 00:01:54,729
<font color="#E5E5E5">key that may also have smart cards</font><font color="#CCCCCC"> on</font>

41
00:01:52,750 --> 00:01:57,369
them and if you<font color="#E5E5E5"> take a</font><font color="#CCCCCC"> look at your</font>

42
00:01:54,729 --> 00:02:01,149
appliances you might have a decoder card

43
00:01:57,369 --> 00:02:03,430
in<font color="#E5E5E5"> satellite box I have a sim card</font><font color="#CCCCCC"> in</font>

44
00:02:01,149 --> 00:02:06,869
your cell phone and you may use a smart

45
00:02:03,430 --> 00:02:10,269
card to top up your electricity at home

46
00:02:06,869 --> 00:02:15,460
so basically we<font color="#CCCCCC"> are absolutely</font>

47
00:02:10,269 --> 00:02:17,830
surrounded by smart cards in 2016 but we

48
00:02:15,460 --> 00:02:20,710
perhaps haven't stopped to consider the

49
00:02:17,830 --> 00:02:23,580
implications the security<font color="#E5E5E5"> implications</font>

50
00:02:20,710 --> 00:02:25,990
that we have with these devices and

51
00:02:23,580 --> 00:02:29,470
potentially we haven't considered<font color="#E5E5E5"> what</font>

52
00:02:25,990 --> 00:02:32,350
data is held on these<font color="#E5E5E5"> cards now in</font>

53
00:02:29,470 --> 00:02:35,320
<font color="#E5E5E5">contrast to magnetic stripe cards where</font>

54
00:02:32,350 --> 00:02:37,720
you directly interact with the data on

55
00:02:35,320 --> 00:02:40,450
<font color="#E5E5E5">the card so for example this is a</font>

56
00:02:37,720 --> 00:02:43,540
magnetic stripe card being exposed to

57
00:02:40,450 --> 00:02:47,649
iron oxide and showing the ones and

58
00:02:43,540 --> 00:02:50,200
<font color="#E5E5E5">zeros</font><font color="#CCCCCC"> as gaps in the metal it's quite</font>

59
00:02:47,650 --> 00:02:53,530
<font color="#E5E5E5">impractical to directly interact with</font>

60
00:02:50,200 --> 00:02:58,149
the storage on a smart card effectively

61
00:02:53,530 --> 00:03:00,370
<font color="#E5E5E5">you have to subject it to acid in order</font>

62
00:02:58,150 --> 00:03:02,800
<font color="#CCCCCC">to analyze silicon and chances are</font>

63
00:03:00,370 --> 00:03:06,130
you're<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> damage the smart card in</font>

64
00:03:02,800 --> 00:03:08,860
the process of doing so so the chances

65
00:03:06,130 --> 00:03:12,460
of you being<font color="#E5E5E5"> able to interact</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> it</font>

66
00:03:08,860 --> 00:03:16,270
after inspecting<font color="#CCCCCC"> the smart card is quite</font>

67
00:03:12,460 --> 00:03:18,850
unlikely additionally if you sort of

68
00:03:16,270 --> 00:03:22,140
think about<font color="#E5E5E5"> it there's</font><font color="#CCCCCC"> no real data on</font>

69
00:03:18,850 --> 00:03:25,180
the smart card that you can clone um

70
00:03:22,140 --> 00:03:27,459
<font color="#E5E5E5">because when you speak</font><font color="#CCCCCC"> with a smart card</font>

71
00:03:25,180 --> 00:03:30,490
you're not necessarily interested<font color="#E5E5E5"> in the</font>

72
00:03:27,460 --> 00:03:33,010
data<font color="#E5E5E5"> itself on the smart card but rather</font>

73
00:03:30,490 --> 00:03:35,490
you're interested<font color="#E5E5E5"> in these more cards</font>

74
00:03:33,010 --> 00:03:38,079
responses to a handful of<font color="#E5E5E5"> commands</font>

75
00:03:35,490 --> 00:03:39,940
because you're not directly interacting

76
00:03:38,080 --> 00:03:42,460
with the<font color="#E5E5E5"> data as it stored on the smart</font>

77
00:03:39,940 --> 00:03:45,070
card the smart card for example might be

78
00:03:42,460 --> 00:03:46,900
<font color="#E5E5E5">doing some pre-processing on it and in</font>

79
00:03:45,070 --> 00:03:51,430
<font color="#E5E5E5">order to give it to you in a nicer</font>

80
00:03:46,900 --> 00:03:53,380
format so with<font color="#E5E5E5"> this in mind you do</font><font color="#CCCCCC"> have</font>

81
00:03:51,430 --> 00:03:56,170
to<font color="#CCCCCC"> speak with a smart card in order to</font>

82
00:03:53,380 --> 00:03:58,329
inspect its contents and you have to

83
00:03:56,170 --> 00:04:00,010
play by the smart cards rules and you

84
00:03:58,330 --> 00:04:04,120
have to use<font color="#E5E5E5"> the interfaces out it</font>

85
00:04:00,010 --> 00:04:08,140
exposes and commonly to do this you'll

86
00:04:04,120 --> 00:04:11,770
use one of<font color="#E5E5E5"> two interfaces you'll more</font>

87
00:04:08,140 --> 00:04:14,679
commonly use a contact interface so one

88
00:04:11,770 --> 00:04:17,859
of the various pinouts shown on the left

89
00:04:14,680 --> 00:04:20,590
here or you could<font color="#CCCCCC"> use NFC or contact</font>

90
00:04:17,858 --> 00:04:23,320
list in order to interact with<font color="#E5E5E5"> the smart</font>

91
00:04:20,589 --> 00:04:26,229
card so if you're speaking with a smart

92
00:04:23,320 --> 00:04:28,420
card over a contact interface that's

93
00:04:26,230 --> 00:04:32,590
<font color="#E5E5E5">defined by the ISIS specification</font>

94
00:04:28,420 --> 00:04:40,720
<font color="#CCCCCC">78 16 whereas contactless cards are</font>

95
00:04:32,590 --> 00:04:44,739
defined by 14 443 which uses 7378 16 st1

96
00:04:40,720 --> 00:04:47,350
protocol so it's effectively the same

97
00:04:44,740 --> 00:04:49,090
thing just<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you might</font><font color="#CCCCCC"> have more</font>

98
00:04:47,350 --> 00:04:53,710
interference if you have multiple cards

99
00:04:49,090 --> 00:04:56,979
in the field now the cool<font color="#CCCCCC"> thing about</font>

100
00:04:53,710 --> 00:04:59,340
this is that because<font color="#E5E5E5"> they use the</font><font color="#CCCCCC"> same</font>

101
00:04:56,980 --> 00:05:02,140
protocols just over different

102
00:04:59,340 --> 00:05:05,349
communication fields you<font color="#E5E5E5"> can share</font>

103
00:05:02,140 --> 00:05:07,240
silicon across both interfaces so here's

104
00:05:05,350 --> 00:05:10,000
an<font color="#E5E5E5"> example of a bank card where you can</font>

105
00:05:07,240 --> 00:05:12,430
see that<font color="#CCCCCC"> the wires for the contactless</font>

106
00:05:10,000 --> 00:05:15,670
interface are going<font color="#E5E5E5"> into the same chip</font>

107
00:05:12,430 --> 00:05:20,470
that<font color="#CCCCCC"> is used for the actual contact</font>

108
00:05:15,670 --> 00:05:25,300
interface and effectively smart cards

109
00:05:20,470 --> 00:05:29,830
are varyingly clever asics you have you

110
00:05:25,300 --> 00:05:34,090
know an application-specific controller

111
00:05:29,830 --> 00:05:36,969
on these cards that depending on on how

112
00:05:34,090 --> 00:05:38,859
clever the manufacturer decided they

113
00:05:36,970 --> 00:05:42,010
wanted the card to be can do a<font color="#E5E5E5"> variety</font>

114
00:05:38,860 --> 00:05:44,140
of<font color="#CCCCCC"> different things many of these smart</font>

115
00:05:42,010 --> 00:05:46,300
cards will run<font color="#CCCCCC"> Java card which is a</font>

116
00:05:44,140 --> 00:05:48,099
heavily stripped-down a java virtual

117
00:05:46,300 --> 00:05:51,220
machine it doesn't<font color="#E5E5E5"> have things like</font>

118
00:05:48,100 --> 00:05:53,380
strings and said you have to use byte

119
00:05:51,220 --> 00:05:54,940
arrays for most things and<font color="#E5E5E5"> you know</font>

120
00:05:53,380 --> 00:05:58,330
which is reasonable when you consider

121
00:05:54,940 --> 00:06:01,300
how small and how limited these chips

122
00:05:58,330 --> 00:06:03,820
are and this is the type of you'll

123
00:06:01,300 --> 00:06:07,290
you'll have<font color="#CCCCCC"> java cards in your bank</font>

124
00:06:03,820 --> 00:06:10,930
cards and<font color="#E5E5E5"> gpg cards and in various other</font>

125
00:06:07,290 --> 00:06:13,510
you know cryptographic hearts because

126
00:06:10,930 --> 00:06:17,710
these cards are able to easily perform a

127
00:06:13,510 --> 00:06:19,870
variety of cryptographic operations so

128
00:06:17,710 --> 00:06:23,979
here's an example<font color="#E5E5E5"> of a</font><font color="#CCCCCC"> visa debit</font><font color="#E5E5E5"> card</font>

129
00:06:19,870 --> 00:06:25,870
that as<font color="#E5E5E5"> mentioned is running java card</font>

130
00:06:23,980 --> 00:06:30,040
in this case it's running java card

131
00:06:25,870 --> 00:06:33,670
version 2.2 and on it is<font color="#E5E5E5"> running the</font>

132
00:06:30,040 --> 00:06:36,190
visa card manager however other smart

133
00:06:33,670 --> 00:06:38,920
cards are more purpose-built so for

134
00:06:36,190 --> 00:06:41,440
<font color="#E5E5E5">example things like a dorky don't</font>

135
00:06:38,920 --> 00:06:43,180
full Java Virtual Machine and in fact

136
00:06:41,440 --> 00:06:45,400
you may want to spend that processing

137
00:06:43,180 --> 00:06:47,110
power on other more useful things you

138
00:06:45,400 --> 00:06:50,260
might want<font color="#CCCCCC"> to get</font><font color="#E5E5E5"> more source capacity</font>

139
00:06:47,110 --> 00:06:53,950
out of it for example<font color="#CCCCCC"> okay so without</font>

140
00:06:50,260 --> 00:06:55,150
mine how do<font color="#E5E5E5"> we actually speak with a</font>

141
00:06:53,950 --> 00:06:56,680
smart card how do we get it to do

142
00:06:55,150 --> 00:06:58,659
something it's previous Lee mentioned

143
00:06:56,680 --> 00:07:01,870
you<font color="#CCCCCC"> don't just read a smart card you</font>

144
00:06:58,660 --> 00:07:04,810
have to talk<font color="#CCCCCC"> with it so you know what's</font>

145
00:07:01,870 --> 00:07:06,480
the process for doing that when you

146
00:07:04,810 --> 00:07:09,550
first<font color="#E5E5E5"> insert a smart card into a reader</font>

147
00:07:06,480 --> 00:07:11,260
you send it a reset command which asks

148
00:07:09,550 --> 00:07:13,860
the smart card to power on and to

149
00:07:11,260 --> 00:07:16,690
initialize<font color="#E5E5E5"> it it's basic memory state</font>

150
00:07:13,860 --> 00:07:19,870
after<font color="#CCCCCC"> this the card responds with a</font>

151
00:07:16,690 --> 00:07:22,719
answer to reset and basically this

152
00:07:19,870 --> 00:07:24,960
<font color="#E5E5E5">defines things like the rate at which</font>

153
00:07:22,720 --> 00:07:27,790
the smart card should reply to commands

154
00:07:24,960 --> 00:07:30,310
the protocol version transmission speed

155
00:07:27,790 --> 00:07:33,430
any error correction settings you know

156
00:07:30,310 --> 00:07:36,580
basic communication parameters here's an

157
00:07:33,430 --> 00:07:39,130
example of what that might look like<font color="#E5E5E5"> and</font>

158
00:07:36,580 --> 00:07:41,229
specifically<font color="#E5E5E5"> here's an analysis of what</font>

159
00:07:39,130 --> 00:07:43,060
all those different hex characters mean

160
00:07:41,230 --> 00:07:44,830
so you<font color="#E5E5E5"> know this defines as I mentioned</font>

161
00:07:43,060 --> 00:07:47,050
the protocol and a transmission rate

162
00:07:44,830 --> 00:07:49,120
that are used the<font color="#E5E5E5"> other kind of fun</font>

163
00:07:47,050 --> 00:07:50,800
thing about answer to resets is that

164
00:07:49,120 --> 00:07:52,240
they because they have all these

165
00:07:50,800 --> 00:07:56,350
different<font color="#E5E5E5"> parameters</font><font color="#CCCCCC"> and can vary</font>

166
00:07:52,240 --> 00:07:58,240
slightly between different cards and

167
00:07:56,350 --> 00:08:00,100
devices is that you can also<font color="#E5E5E5"> use these</font>

168
00:07:58,240 --> 00:08:02,650
to identify what kind of a card you're

169
00:08:00,100 --> 00:08:05,380
talking with so in this case this is the

170
00:08:02,650 --> 00:08:08,380
<font color="#E5E5E5">answer to reset for a united kingdom</font>

171
00:08:05,380 --> 00:08:10,480
biometric residence permit but<font color="#E5E5E5"> here are</font>

172
00:08:08,380 --> 00:08:12,969
other examples of other common answer<font color="#CCCCCC"> to</font>

173
00:08:10,480 --> 00:08:14,590
<font color="#E5E5E5">resets for you know a handful of other</font>

174
00:08:12,970 --> 00:08:18,790
cards that you might run into<font color="#E5E5E5"> in the</font>

175
00:08:14,590 --> 00:08:21,280
wild so<font color="#E5E5E5"> after you receive an answer to</font>

176
00:08:18,790 --> 00:08:23,500
reset you'll want to select an

177
00:08:21,280 --> 00:08:25,000
application on the card further this is

178
00:08:23,500 --> 00:08:27,010
where the answer to reset might be

179
00:08:25,000 --> 00:08:29,890
helpful<font color="#E5E5E5"> and that it allows you to</font>

180
00:08:27,010 --> 00:08:33,250
determine what applications might be

181
00:08:29,890 --> 00:08:35,620
<font color="#CCCCCC">available on the card just before you've</font>

182
00:08:33,250 --> 00:08:37,990
been trying<font color="#E5E5E5"> to select one the card then</font>

183
00:08:35,620 --> 00:08:41,080
says<font color="#CCCCCC"> okay cool</font><font color="#E5E5E5"> that applications loaded</font>

184
00:08:37,990 --> 00:08:43,030
you're ready to go and this sounds great

185
00:08:41,080 --> 00:08:46,240
<font color="#CCCCCC">this sounds really</font><font color="#E5E5E5"> easy pretty simple</font>

186
00:08:43,030 --> 00:08:49,390
pretty standard you know except not

187
00:08:46,240 --> 00:08:51,980
really because you know although you

188
00:08:49,390 --> 00:08:53,959
have this this wonderful flow

189
00:08:51,980 --> 00:08:57,139
some cards<font color="#E5E5E5"> are kind of rude and don't</font>

190
00:08:53,959 --> 00:08:59,660
answer to your resets so some cards will

191
00:08:57,139 --> 00:09:01,490
do this as a form of obfuscation things

192
00:08:59,660 --> 00:09:03,709
like laundry cards electricity cards and

193
00:09:01,490 --> 00:09:06,260
that if they<font color="#CCCCCC"> don't answer to your reset</font>

194
00:09:03,709 --> 00:09:10,339
then you won't know how<font color="#CCCCCC"> to speak with</font>

195
00:09:06,260 --> 00:09:12,079
them so it's secure and so when you you

196
00:09:10,339 --> 00:09:14,660
know<font color="#CCCCCC"> try to</font><font color="#E5E5E5"> do it you don't get a reply</font>

197
00:09:12,079 --> 00:09:16,729
and you know you<font color="#E5E5E5"> don't know how to</font>

198
00:09:14,660 --> 00:09:18,620
proceed but you know fine whatever let's

199
00:09:16,730 --> 00:09:20,839
assume<font color="#CCCCCC"> that you did get an answer to</font>

200
00:09:18,620 --> 00:09:23,120
reset or that you somehow otherwise<font color="#CCCCCC"> know</font>

201
00:09:20,839 --> 00:09:25,639
the transmission<font color="#CCCCCC"> writing the protocol</font>

202
00:09:23,120 --> 00:09:28,089
and all that so then how you proceed

203
00:09:25,639 --> 00:09:31,240
<font color="#E5E5E5">after selecting</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> application is</font>

204
00:09:28,089 --> 00:09:34,190
completely up to the application

205
00:09:31,240 --> 00:09:36,769
applications usually implement a handful

206
00:09:34,190 --> 00:09:40,490
of sand<font color="#E5E5E5"> or commands here are a couple</font>

207
00:09:36,769 --> 00:09:43,399
examples of them and these commands are

208
00:09:40,490 --> 00:09:45,529
<font color="#E5E5E5">defined by a specification called global</font>

209
00:09:43,399 --> 00:09:48,649
platform and<font color="#CCCCCC"> the idea behind</font><font color="#E5E5E5"> global</font>

210
00:09:45,529 --> 00:09:51,380
platform is so that smart cards are able

211
00:09:48,649 --> 00:09:53,120
to interoperate with each other and to

212
00:09:51,380 --> 00:09:56,779
enable smart cards to host multiple

213
00:09:53,120 --> 00:10:01,040
applications so you could you know in

214
00:09:56,779 --> 00:10:04,010
theory have a card that acts both as a

215
00:10:01,040 --> 00:10:08,180
sim card and as a bank card because of

216
00:10:04,010 --> 00:10:12,050
these<font color="#CCCCCC"> interop standards however it's</font>

217
00:10:08,180 --> 00:10:14,239
totally cool<font color="#CCCCCC"> to ignore these which means</font>

218
00:10:12,050 --> 00:10:17,240
that speaking with a random card is an

219
00:10:14,240 --> 00:10:19,430
absolute headache because you need<font color="#CCCCCC"> to</font>

220
00:10:17,240 --> 00:10:21,380
know what what subset of these commands

221
00:10:19,430 --> 00:10:23,269
<font color="#E5E5E5">and supports will custom commands at</font>

222
00:10:21,380 --> 00:10:26,000
sports and how it would like these

223
00:10:23,269 --> 00:10:28,880
commands to<font color="#CCCCCC"> be set to it but you know</font>

224
00:10:26,000 --> 00:10:31,040
further<font color="#E5E5E5"> on let's assume that you do know</font>

225
00:10:28,880 --> 00:10:32,839
what commands the card supports you know

226
00:10:31,040 --> 00:10:35,149
let's say that it's it's a standard that

227
00:10:32,839 --> 00:10:37,880
you're aware of or that<font color="#E5E5E5"> you sniffed the</font>

228
00:10:35,149 --> 00:10:40,120
communication going on you know while

229
00:10:37,880 --> 00:10:42,860
the card is being legitimately used and

230
00:10:40,120 --> 00:10:44,990
as a<font color="#E5E5E5"> simple example of you know</font>

231
00:10:42,860 --> 00:10:48,589
<font color="#CCCCCC">well-known a smart card specification</font>

232
00:10:44,990 --> 00:10:51,350
let's look at gsm authentication now gsm

233
00:10:48,589 --> 00:10:55,069
is a particularly good example of where

234
00:10:51,350 --> 00:10:58,430
a smart card can be useful because your

235
00:10:55,069 --> 00:11:00,529
cell phone provider wants to be able to

236
00:10:58,430 --> 00:11:03,560
securely authenticate you but<font color="#E5E5E5"> doesn't</font>

237
00:11:00,529 --> 00:11:05,510
necessarily trust your handset however

238
00:11:03,560 --> 00:11:09,079
it does trust the sim

239
00:11:05,510 --> 00:11:12,760
that it issued to you so when<font color="#E5E5E5"> you first</font>

240
00:11:09,080 --> 00:11:15,830
connect to a gsm network the cell tower

241
00:11:12,760 --> 00:11:19,250
sends a random string a nonce to your

242
00:11:15,830 --> 00:11:22,370
cell phone and at the same<font color="#CCCCCC"> time the cell</font>

243
00:11:19,250 --> 00:11:25,130
tower is aware of<font color="#CCCCCC"> a ki which is an</font>

244
00:11:22,370 --> 00:11:29,000
encryption key associated<font color="#CCCCCC"> with your</font><font color="#E5E5E5"> SIM</font>

245
00:11:25,130 --> 00:11:30,260
card now to make this a bit more

246
00:11:29,000 --> 00:11:33,440
interesting let's assume<font color="#CCCCCC"> that your SIM</font>

247
00:11:30,260 --> 00:11:36,140
card also has a pin on<font color="#CCCCCC"> it so your SIM</font>

248
00:11:33,440 --> 00:11:37,850
card is also aware<font color="#E5E5E5"> of this ki and it</font>

249
00:11:36,140 --> 00:11:42,260
also has a counter in it of how many

250
00:11:37,850 --> 00:11:48,140
<font color="#E5E5E5">times you're allowed to try a pin entry</font>

251
00:11:42,260 --> 00:11:51,620
so you tell the SIM card you know my pin

252
00:11:48,140 --> 00:11:53,860
<font color="#E5E5E5">is 1234 the SIM card says no that's</font>

253
00:11:51,620 --> 00:11:58,100
<font color="#CCCCCC">actually not the correct pin it</font>

254
00:11:53,860 --> 00:12:00,080
decreases this counter then you know try

255
00:11:58,100 --> 00:12:03,380
a different pen and it says yes that's

256
00:12:00,080 --> 00:12:06,080
<font color="#E5E5E5">fine great at which point you know the</font>

257
00:12:03,380 --> 00:12:09,170
SIM card has now authenticated use in an

258
00:12:06,080 --> 00:12:12,350
ok state to proceed and to act on your

259
00:12:09,170 --> 00:12:14,949
behalf so then the phone will ask the

260
00:12:12,350 --> 00:12:19,060
<font color="#E5E5E5">SIM card to sign this random string and</font>

261
00:12:14,950 --> 00:12:23,780
using this ki it will perform on board

262
00:12:19,060 --> 00:12:27,050
crypto and return a the signed nonce

263
00:12:23,780 --> 00:12:29,810
which the phone can then send back<font color="#E5E5E5"> to</font>

264
00:12:27,050 --> 00:12:34,490
the cell tower and demonstrate that you

265
00:12:29,810 --> 00:12:36,109
do<font color="#CCCCCC"> indeed possess the SIM card and in</font>

266
00:12:34,490 --> 00:12:39,550
<font color="#E5E5E5">this example the SIM card is</font>

267
00:12:36,110 --> 00:12:44,470
demonstrating to access control methods

268
00:12:39,550 --> 00:12:46,670
it protects both the pin and the ki

269
00:12:44,470 --> 00:12:49,490
because the sim card performs

270
00:12:46,670 --> 00:12:53,300
cryptographic operations on board the ki

271
00:12:49,490 --> 00:12:56,120
isn't exposed at all so it's not like

272
00:12:53,300 --> 00:12:59,990
when you enter your PIN the phone is now

273
00:12:56,120 --> 00:13:03,220
able<font color="#E5E5E5"> to read the ki and so this keeps it</font>

274
00:12:59,990 --> 00:13:09,170
secure unless you're able to brute-force

275
00:13:03,220 --> 00:13:12,160
DKI so one attack that you could perform

276
00:13:09,170 --> 00:13:14,860
<font color="#E5E5E5">would be to ask the SIM card to sign</font>

277
00:13:12,160 --> 00:13:17,569
multiple of these announcers<font color="#E5E5E5"> and</font>

278
00:13:14,860 --> 00:13:19,490
eventually because of a weakness in the

279
00:13:17,570 --> 00:13:21,740
<font color="#CCCCCC">algorithm that was previously</font>

280
00:13:19,490 --> 00:13:24,620
used in older<font color="#E5E5E5"> SIM cards you could then</font>

281
00:13:21,740 --> 00:13:27,680
use this to determine what the ki was

282
00:13:24,620 --> 00:13:30,110
this isn't a problem in new SIM cards

283
00:13:27,680 --> 00:13:32,180
but it used to be more of<font color="#CCCCCC"> an issue in</font>

284
00:13:30,110 --> 00:13:35,260
more developing nations I would use

285
00:13:32,180 --> 00:13:38,870
these older<font color="#E5E5E5"> SIM cards for cost reasons</font>

286
00:13:35,260 --> 00:13:42,620
now we also have smart cards in<font color="#E5E5E5"> our bank</font>

287
00:13:38,870 --> 00:13:45,560
cards which is defined by a<font color="#E5E5E5"> different</font>

288
00:13:42,620 --> 00:13:48,050
protocol called EMV and the<font color="#E5E5E5"> idea behind</font>

289
00:13:45,560 --> 00:13:50,599
this protocol is to provide a secure

290
00:13:48,050 --> 00:13:54,290
environment in a assumed hostile

291
00:13:50,600 --> 00:13:58,040
environment a same thing as with a cell

292
00:13:54,290 --> 00:14:00,349
phone<font color="#CCCCCC"> you don't</font><font color="#E5E5E5"> necessarily trust the</font>

293
00:13:58,040 --> 00:14:01,880
handset just like with a payment

294
00:14:00,350 --> 00:14:06,110
environment you don't necessarily<font color="#CCCCCC"> trust</font>

295
00:14:01,880 --> 00:14:07,399
the payments terminal additionally<font color="#CCCCCC"> the</font>

296
00:14:06,110 --> 00:14:09,589
other fun thing is that you<font color="#CCCCCC"> can have</font>

297
00:14:07,399 --> 00:14:12,050
multiple applications you know on one

298
00:14:09,589 --> 00:14:15,260
payments card this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> more commonly used</font>

299
00:14:12,050 --> 00:14:17,930
in the United States<font color="#E5E5E5"> and in continental</font>

300
00:14:15,260 --> 00:14:21,399
Europe to do things like debit cards

301
00:14:17,930 --> 00:14:25,219
that support multiple payment networks

302
00:14:21,399 --> 00:14:28,700
however you<font color="#CCCCCC"> can also use smart cards for</font>

303
00:14:25,220 --> 00:14:32,540
more generic data storage so you can use

304
00:14:28,700 --> 00:14:33,680
them for door cards student cards so on

305
00:14:32,540 --> 00:14:35,870
and so forth where you're not really

306
00:14:33,680 --> 00:14:37,670
asking<font color="#E5E5E5"> the card to perform any</font>

307
00:14:35,870 --> 00:14:40,870
cryptographic operations on your behalf

308
00:14:37,670 --> 00:14:45,010
and instead you're<font color="#CCCCCC"> just asking it to</font>

309
00:14:40,870 --> 00:14:49,209
<font color="#E5E5E5">prove that that you possess that part</font>

310
00:14:45,010 --> 00:14:51,529
now quite a few<font color="#CCCCCC"> of these cards</font><font color="#E5E5E5"> are</font>

311
00:14:49,209 --> 00:14:55,069
belong to a series called mifare

312
00:14:51,529 --> 00:14:57,350
ultralight these<font color="#E5E5E5"> aren't they my fare</font>

313
00:14:55,070 --> 00:15:00,070
series of cards generally aren't<font color="#E5E5E5"> Java</font>

314
00:14:57,350 --> 00:15:05,060
cards and instead they're custom asics

315
00:15:00,070 --> 00:15:08,720
purely for this sort<font color="#E5E5E5"> of data storage use</font>

316
00:15:05,060 --> 00:15:11,510
case and my<font color="#CCCCCC"> favorite altra</font><font color="#E5E5E5"> like cards</font>

317
00:15:08,720 --> 00:15:15,320
are mostly publicly readable and have

318
00:15:11,510 --> 00:15:18,860
very basic access control settings these

319
00:15:15,320 --> 00:15:22,490
cards<font color="#CCCCCC"> are pretty popular with disposable</font>

320
00:15:18,860 --> 00:15:27,320
or single-use tickets so above is a

321
00:15:22,490 --> 00:15:30,160
<font color="#CCCCCC">Dutch single-use real ticket and below</font>

322
00:15:27,320 --> 00:15:32,470
is a Glasgow subway single-use ticket

323
00:15:30,160 --> 00:15:36,129
and both<font color="#CCCCCC"> of these are cardboard cards</font>

324
00:15:32,470 --> 00:15:40,509
that do actually have a contactless

325
00:15:36,129 --> 00:15:43,000
smart cards in them and here is an

326
00:15:40,509 --> 00:15:45,519
example of the data held on them to the

327
00:15:43,000 --> 00:15:48,939
left is the trail card to the right<font color="#CCCCCC"> is</font>

328
00:15:45,519 --> 00:15:50,949
the<font color="#E5E5E5"> Glasgow subway card and as you can</font>

329
00:15:48,939 --> 00:15:54,459
see there's not a<font color="#E5E5E5"> whole</font><font color="#CCCCCC"> lot of storage</font>

330
00:15:50,949 --> 00:15:56,170
space on here there's<font color="#E5E5E5"> also no you know</font>

331
00:15:54,459 --> 00:15:58,930
<font color="#E5E5E5">immediately humanly readable data on</font>

332
00:15:56,170 --> 00:16:02,319
here you have to use you know binary

333
00:15:58,930 --> 00:16:08,849
<font color="#E5E5E5">data in order to keep things you know</font>

334
00:16:02,319 --> 00:16:12,699
down to a reasonable size however more

335
00:16:08,850 --> 00:16:15,069
permanent cards are mifare classic cards

336
00:16:12,699 --> 00:16:17,979
and so you'll you'll see<font color="#E5E5E5"> these in actual</font>

337
00:16:15,069 --> 00:16:22,120
plastic cards things like student cards

338
00:16:17,980 --> 00:16:25,660
<font color="#CCCCCC">or transit cards and with these you just</font>

339
00:16:22,120 --> 00:16:27,910
read sectors off the card you there's

340
00:16:25,660 --> 00:16:30,790
also some you know cryptographic

341
00:16:27,910 --> 00:16:32,980
operations that go on in<font color="#E5E5E5"> order to ensure</font>

342
00:16:30,790 --> 00:16:35,290
that<font color="#E5E5E5"> you are actually allowed to read</font>

343
00:16:32,980 --> 00:16:37,829
the different<font color="#E5E5E5"> sectors on the card or</font>

344
00:16:35,290 --> 00:16:41,259
whether you're allowed to modify them

345
00:16:37,829 --> 00:16:44,290
the way that most door cards that use

346
00:16:41,259 --> 00:16:49,870
mifare classic work is they simply read

347
00:16:44,290 --> 00:16:51,759
the sector<font color="#CCCCCC"> zero which contains a serial</font>

348
00:16:49,870 --> 00:16:54,310
number<font color="#E5E5E5"> which is written into the card at</font>

349
00:16:51,759 --> 00:16:57,819
<font color="#CCCCCC">the factory</font><font color="#E5E5E5"> and is</font><font color="#CCCCCC"> Hardware locked and</font>

350
00:16:54,310 --> 00:17:00,399
can't be modified so<font color="#CCCCCC"> in theory</font><font color="#E5E5E5"> you can't</font>

351
00:16:57,819 --> 00:17:03,929
just go<font color="#CCCCCC"> and buy a blank my favorite</font>

352
00:17:00,399 --> 00:17:08,260
classic card and change<font color="#E5E5E5"> the</font><font color="#CCCCCC"> UID on it</font>

353
00:17:03,929 --> 00:17:12,309
however you can buy these changeable UID

354
00:17:08,260 --> 00:17:16,629
my fare cards from shady websites you

355
00:17:12,309 --> 00:17:20,439
know in China<font color="#E5E5E5"> now the cool thing is some</font>

356
00:17:16,630 --> 00:17:22,240
people store data on these<font color="#E5E5E5"> cards but you</font>

357
00:17:20,439 --> 00:17:24,760
know as mentioned this this is in theory

358
00:17:22,240 --> 00:17:27,849
safe because you need the encryption

359
00:17:24,760 --> 00:17:30,850
keys to read and<font color="#CCCCCC"> write data from these</font>

360
00:17:27,849 --> 00:17:32,709
cards and in theory the card has<font color="#CCCCCC"> the</font>

361
00:17:30,850 --> 00:17:34,000
ability to say no I'm not<font color="#E5E5E5"> going to let</font>

362
00:17:32,710 --> 00:17:37,270
<font color="#E5E5E5">you read that you don't have the right</font>

363
00:17:34,000 --> 00:17:39,429
encryption key for it however these

364
00:17:37,270 --> 00:17:41,010
cards have been demonstrated<font color="#CCCCCC"> to have</font>

365
00:17:39,429 --> 00:17:43,500
pretty broken crypto

366
00:17:41,010 --> 00:17:47,550
and these exploits have been known for a

367
00:17:43,500 --> 00:17:49,590
while and this is to<font color="#E5E5E5"> the point where mxp</font>

368
00:17:47,550 --> 00:17:52,129
the manufacturer of these cards<font color="#E5E5E5"> have</font>

369
00:17:49,590 --> 00:17:56,189
said that these cards<font color="#E5E5E5"> are unsafe to use</font>

370
00:17:52,130 --> 00:18:01,260
anymore and any usage of them should<font color="#CCCCCC"> be</font>

371
00:17:56,190 --> 00:18:04,320
discontinued because you can go and just

372
00:18:01,260 --> 00:18:07,230
dump any card<font color="#E5E5E5"> that uses mifare classic</font>

373
00:18:04,320 --> 00:18:11,669
so here's an<font color="#E5E5E5"> example of my santo domingo</font>

374
00:18:07,230 --> 00:18:14,190
subway card and<font color="#CCCCCC"> i have</font><font color="#E5E5E5"> the reed keys as</font>

375
00:18:11,670 --> 00:18:16,260
well as the right keys so if i wanted to

376
00:18:14,190 --> 00:18:20,730
i could totally<font color="#CCCCCC"> just change my card</font>

377
00:18:16,260 --> 00:18:23,000
balance the fun<font color="#E5E5E5"> thing is that although</font>

378
00:18:20,730 --> 00:18:26,420
these are known to<font color="#CCCCCC"> be very vulnerable</font>

379
00:18:23,000 --> 00:18:30,120
they're still pretty commonly deployed

380
00:18:26,420 --> 00:18:32,430
the first oyster cards were mifare

381
00:18:30,120 --> 00:18:34,439
classic the scottish national

382
00:18:32,430 --> 00:18:38,160
entitlement cards are in a mifare

383
00:18:34,440 --> 00:18:39,930
classic and it's<font color="#E5E5E5"> pretty common to use</font>

384
00:18:38,160 --> 00:18:42,150
these in student cards as well<font color="#E5E5E5"> just</font>

385
00:18:39,930 --> 00:18:45,390
<font color="#CCCCCC">because they're fairly low cost and</font>

386
00:18:42,150 --> 00:18:48,450
they're pretty<font color="#E5E5E5"> easy to deploy and that</font>

387
00:18:45,390 --> 00:18:50,850
they're<font color="#CCCCCC"> very simple cards but you know</font>

388
00:18:48,450 --> 00:18:53,100
of<font color="#CCCCCC"> course not everybody uses mifare</font>

389
00:18:50,850 --> 00:18:55,889
classic some people actually listen when

390
00:18:53,100 --> 00:18:59,939
the manufacturer says hey stop giving us

391
00:18:55,890 --> 00:19:02,670
money<font color="#E5E5E5"> for these cards they're unsafe so</font>

392
00:18:59,940 --> 00:19:05,670
instead nxp says that you should use

393
00:19:02,670 --> 00:19:08,370
<font color="#E5E5E5">mifare desfire instead and this is what</font>

394
00:19:05,670 --> 00:19:10,890
modern<font color="#CCCCCC"> oyster cards use this is what</font>

395
00:19:08,370 --> 00:19:13,800
most modern transit cards will use as

396
00:19:10,890 --> 00:19:16,620
well and des fire uses an entirely new

397
00:19:13,800 --> 00:19:20,100
protocol it uses stronger cryptographic

398
00:19:16,620 --> 00:19:22,500
algorithms additionally it cleanly

399
00:19:20,100 --> 00:19:24,719
supports multiple applications and has a

400
00:19:22,500 --> 00:19:27,330
much stronger access control system

401
00:19:24,720 --> 00:19:29,190
instead of just interacting with raw

402
00:19:27,330 --> 00:19:32,820
sectors on the card as you do<font color="#E5E5E5"> with my</font>

403
00:19:29,190 --> 00:19:35,510
classic you allow the<font color="#CCCCCC"> des fire card to</font>

404
00:19:32,820 --> 00:19:38,840
manage the data sectors for you and

405
00:19:35,510 --> 00:19:41,010
handle them on a per application basis

406
00:19:38,840 --> 00:19:44,010
the other fun thing with this is<font color="#CCCCCC"> that</font>

407
00:19:41,010 --> 00:19:46,590
<font color="#E5E5E5">because of the access control system the</font>

408
00:19:44,010 --> 00:19:48,120
card issuer can say that it wants

409
00:19:46,590 --> 00:19:50,459
certain<font color="#E5E5E5"> aspects of the card to be</font>

410
00:19:48,120 --> 00:19:52,530
publicly readable so here's an example

411
00:19:50,460 --> 00:19:54,420
<font color="#CCCCCC">of an Android application that takes it</font>

412
00:19:52,530 --> 00:19:57,149
edge of this to read a handful of

413
00:19:54,420 --> 00:19:58,770
publicly<font color="#CCCCCC"> available transit cards in this</font>

414
00:19:57,150 --> 00:20:01,290
<font color="#E5E5E5">case it's reading a San Francisco</font>

415
00:19:58,770 --> 00:20:05,060
clipper card and is showing<font color="#CCCCCC"> a few of the</font>

416
00:20:01,290 --> 00:20:07,129
most<font color="#E5E5E5"> recent trips taken using the card</font>

417
00:20:05,060 --> 00:20:10,440
unfortunately Transport for London

418
00:20:07,130 --> 00:20:15,270
<font color="#E5E5E5">doesn't allow you to inspect an oyster</font>

419
00:20:10,440 --> 00:20:17,480
card but you know that this is something

420
00:20:15,270 --> 00:20:23,129
that<font color="#E5E5E5"> that's fully up to the card issuer</font>

421
00:20:17,480 --> 00:20:25,530
to decide on<font color="#E5E5E5"> unfortunately there's a way</font>

422
00:20:23,130 --> 00:20:28,350
<font color="#E5E5E5">to break into these the older versions</font>

423
00:20:25,530 --> 00:20:31,350
of these<font color="#E5E5E5"> cards through a side channel</font>

424
00:20:28,350 --> 00:20:34,800
attack you can measure the electric

425
00:20:31,350 --> 00:20:36,179
magnetic interference that's created by

426
00:20:34,800 --> 00:20:38,820
the card while<font color="#E5E5E5"> it's carrying out</font>

427
00:20:36,180 --> 00:20:42,270
cryptographic operations and you can use

428
00:20:38,820 --> 00:20:44,010
<font color="#E5E5E5">that</font><font color="#CCCCCC"> to determine its secret keys this</font>

429
00:20:42,270 --> 00:20:46,379
isn't exploitable and newer versions of

430
00:20:44,010 --> 00:20:49,110
des fire cards and so hopefully<font color="#CCCCCC"> this</font>

431
00:20:46,380 --> 00:20:51,600
should be an issue<font color="#E5E5E5"> but you know as is</font>

432
00:20:49,110 --> 00:20:53,810
the case with my<font color="#CCCCCC"> fair classics and with</font>

433
00:20:51,600 --> 00:20:56,100
older<font color="#CCCCCC"> SIM cards you know there are still</font>

434
00:20:53,810 --> 00:20:57,389
operators that choose to issue these

435
00:20:56,100 --> 00:20:59,719
cards knowing that they're vulnerable

436
00:20:57,390 --> 00:21:01,500
simply because they're cheaper

437
00:20:59,720 --> 00:21:03,840
additionally in the<font color="#E5E5E5"> United Kingdom we</font>

438
00:21:01,500 --> 00:21:06,540
have a fun transit card system called it

439
00:21:03,840 --> 00:21:10,530
so if you have a concessionary travel

440
00:21:06,540 --> 00:21:13,740
pass or if you live<font color="#CCCCCC"> in a city that is</font>

441
00:21:10,530 --> 00:21:15,990
not<font color="#E5E5E5"> London and have a smart card that</font>

442
00:21:13,740 --> 00:21:19,760
you use to<font color="#E5E5E5"> travel on</font><font color="#CCCCCC"> it will probably</font>

443
00:21:15,990 --> 00:21:23,880
have this logo somewhere on it now the

444
00:21:19,760 --> 00:21:27,240
specification supports using my favorite

445
00:21:23,880 --> 00:21:29,310
classic although you're<font color="#CCCCCC"> not supposed</font><font color="#E5E5E5"> to</font>

446
00:21:27,240 --> 00:21:31,530
use<font color="#E5E5E5"> that for newer deployments anymore</font>

447
00:21:29,310 --> 00:21:34,950
and instead<font color="#E5E5E5"> you're supposed to use my</font>

448
00:21:31,530 --> 00:21:38,460
faire des fire and it so is kind of a

449
00:21:34,950 --> 00:21:41,460
double whammy<font color="#E5E5E5"> for smart parts inside</font>

450
00:21:38,460 --> 00:21:45,480
every ticket barrier ticket vending

451
00:21:41,460 --> 00:21:50,280
machine and<font color="#E5E5E5"> ticket inspection device you</font>

452
00:21:45,480 --> 00:21:53,300
have one of<font color="#E5E5E5"> these cards and the this</font>

453
00:21:50,280 --> 00:21:58,110
card is<font color="#E5E5E5"> a secure application module</font>

454
00:21:53,300 --> 00:22:00,300
which contains a private key defined by

455
00:21:58,110 --> 00:22:03,120
it so which can be used to

456
00:22:00,300 --> 00:22:03,860
cryptographically verify the contents of

457
00:22:03,120 --> 00:22:07,340
<font color="#E5E5E5">any</font>

458
00:22:03,860 --> 00:22:10,159
given card so this is used by ticket

459
00:22:07,340 --> 00:22:13,370
barriers and ticket inspection devices

460
00:22:10,160 --> 00:22:16,190
to make sure that your tickets balance

461
00:22:13,370 --> 00:22:21,110
you know so on and so forth are valid

462
00:22:16,190 --> 00:22:26,150
and essentially the the way that this

463
00:22:21,110 --> 00:22:30,080
works is your reader speaks with your

464
00:22:26,150 --> 00:22:33,170
card reads you know the products that

465
00:22:30,080 --> 00:22:38,418
<font color="#E5E5E5">you have on the card from it and these</font>

466
00:22:33,170 --> 00:22:42,309
<font color="#E5E5E5">are signed using this the Sam card and</font>

467
00:22:38,419 --> 00:22:46,450
you're able<font color="#CCCCCC"> to securely verify that</font>

468
00:22:42,309 --> 00:22:49,340
additionally there's another popular

469
00:22:46,450 --> 00:22:52,100
transit card protocol called Calypso

470
00:22:49,340 --> 00:22:55,699
that is used in Belgium Germany France

471
00:22:52,100 --> 00:22:58,490
and Portugal which is more interesting a

472
00:22:55,700 --> 00:23:00,710
smart part of use case in that instead

473
00:22:58,490 --> 00:23:03,290
of the smart card simply storing your

474
00:23:00,710 --> 00:23:04,940
ticket data and the ticket barrier is

475
00:23:03,290 --> 00:23:07,549
responsible for validating whether

476
00:23:04,940 --> 00:23:10,570
you're allowed through the smart card is

477
00:23:07,549 --> 00:23:12,710
instead trusted and is in charge of

478
00:23:10,570 --> 00:23:14,990
determining whether you're allowed to

479
00:23:12,710 --> 00:23:17,090
conduct a journey or not and so in<font color="#E5E5E5"> this</font>

480
00:23:14,990 --> 00:23:21,440
regard the smart card is slightly

481
00:23:17,090 --> 00:23:23,149
smarter than just in it so card however

482
00:23:21,440 --> 00:23:26,059
of course<font color="#E5E5E5"> there are other applications</font>

483
00:23:23,150 --> 00:23:29,240
that smart cards are used for like

484
00:23:26,059 --> 00:23:31,549
passports and passports are fun because

485
00:23:29,240 --> 00:23:33,799
you<font color="#E5E5E5"> have sensitive data on them that has</font>

486
00:23:31,549 --> 00:23:35,809
to be<font color="#CCCCCC"> protected with some countries</font>

487
00:23:33,799 --> 00:23:38,960
passports you have fingerprint

488
00:23:35,809 --> 00:23:40,790
information<font color="#CCCCCC"> on all countries passports</font>

489
00:23:38,960 --> 00:23:43,220
you have biometric information you have

490
00:23:40,790 --> 00:23:44,928
the information<font color="#E5E5E5"> on the cover</font><font color="#CCCCCC"> page and so</font>

491
00:23:43,220 --> 00:23:46,429
be kind of terrible if you just had a

492
00:23:44,929 --> 00:23:49,490
passport in your bag and someone<font color="#E5E5E5"> was</font>

493
00:23:46,429 --> 00:23:52,610
able<font color="#E5E5E5"> to read</font><font color="#CCCCCC"> it in order to protect</font>

494
00:23:49,490 --> 00:23:55,880
against this there's a oughtn't occation

495
00:23:52,610 --> 00:23:58,549
scheme called basic access control<font color="#CCCCCC"> we're</font>

496
00:23:55,880 --> 00:24:02,059
when you read information from a

497
00:23:58,549 --> 00:24:04,340
passport you have to supply the holders

498
00:24:02,059 --> 00:24:06,950
birthday the passport number<font color="#CCCCCC"> and the</font>

499
00:24:04,340 --> 00:24:09,830
passports<font color="#E5E5E5"> expiration date and this is</font>

500
00:24:06,950 --> 00:24:13,370
why you when a passport is scanned at

501
00:24:09,830 --> 00:24:15,230
the airport you still have to scan these

502
00:24:13,370 --> 00:24:18,469
two lines at the<font color="#E5E5E5"> bottom</font>

503
00:24:15,230 --> 00:24:22,179
because that's where this information is

504
00:24:18,470 --> 00:24:26,000
contained so after extracting that

505
00:24:22,179 --> 00:24:28,730
<font color="#CCCCCC">information you can send it to</font><font color="#E5E5E5"> the</font>

506
00:24:26,000 --> 00:24:30,980
<font color="#CCCCCC">passport who then generate session keys</font>

507
00:24:28,730 --> 00:24:34,250
for you and you<font color="#CCCCCC"> can use these session</font>

508
00:24:30,980 --> 00:24:36,919
keys to securely read the holders photo

509
00:24:34,250 --> 00:24:39,260
you know the information<font color="#E5E5E5"> on the card so</font>

510
00:24:36,919 --> 00:24:40,850
on and so forth additionally for more

511
00:24:39,260 --> 00:24:43,850
sensitive information such as

512
00:24:40,850 --> 00:24:49,219
fingerprints you have extended access

513
00:24:43,850 --> 00:24:51,620
control which requires that a actual

514
00:24:49,220 --> 00:24:54,860
certificate be presented to the<font color="#CCCCCC"> passport</font>

515
00:24:51,620 --> 00:24:56,899
before it's able to<font color="#E5E5E5"> give up data and in</font>

516
00:24:54,860 --> 00:24:59,030
this sense merely possessing the

517
00:24:56,900 --> 00:25:00,260
identity document isn't enough to get

518
00:24:59,030 --> 00:25:03,549
<font color="#E5E5E5">that information you also have</font><font color="#CCCCCC"> to be</font>

519
00:25:00,260 --> 00:25:06,679
trusted by the issuer of the document

520
00:25:03,549 --> 00:25:09,830
now the information that's used for

521
00:25:06,679 --> 00:25:12,350
basic access control is all numeric data

522
00:25:09,830 --> 00:25:17,020
you know your birthday document number

523
00:25:12,350 --> 00:25:19,820
expiration date which we can brute force

524
00:25:17,020 --> 00:25:24,740
and there is a pretty interesting paper

525
00:25:19,820 --> 00:25:28,010
on this which used a webcam to<font color="#CCCCCC"> see the</font>

526
00:25:24,740 --> 00:25:30,590
cover of the exterior cover of the

527
00:25:28,010 --> 00:25:34,250
passport to determine which country

528
00:25:30,590 --> 00:25:36,770
issued it and<font color="#E5E5E5"> by with this information</font>

529
00:25:34,250 --> 00:25:40,940
you can determine certain patterns about

530
00:25:36,770 --> 00:25:43,820
passports so for<font color="#E5E5E5"> example newer American</font>

531
00:25:40,940 --> 00:25:47,059
passports tend to start their passport

532
00:25:43,820 --> 00:25:50,030
numbers at 50,000 so you know you<font color="#CCCCCC"> can</font>

533
00:25:47,059 --> 00:25:52,639
already eliminate a bunch of iterations

534
00:25:50,030 --> 00:25:54,260
with that information additionally you

535
00:25:52,640 --> 00:25:56,330
could inspect things like the wear and

536
00:25:54,260 --> 00:25:58,340
tear on the passport to figure out you

537
00:25:56,330 --> 00:26:01,970
know to kind of guess how<font color="#E5E5E5"> soon it's</font>

538
00:25:58,340 --> 00:26:04,760
going to expire now some<font color="#E5E5E5"> countries are a</font>

539
00:26:01,970 --> 00:26:08,540
bit clever about<font color="#E5E5E5"> this American passports</font>

540
00:26:04,760 --> 00:26:11,600
include a Faraday cage on their cover so

541
00:26:08,540 --> 00:26:14,840
unless<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> the passport open you're</font>

542
00:26:11,600 --> 00:26:18,469
unable<font color="#CCCCCC"> to speak with the NFC coil at the</font>

543
00:26:14,840 --> 00:26:20,570
NFC chip inside of the passport however

544
00:26:18,470 --> 00:26:23,299
you<font color="#E5E5E5"> know this is still a</font><font color="#CCCCCC"> problem with</font>

545
00:26:20,570 --> 00:26:27,040
with other countries which don't have

546
00:26:23,299 --> 00:26:28,920
<font color="#CCCCCC">shield in their passport covers right so</font>

547
00:26:27,040 --> 00:26:31,379
<font color="#E5E5E5">basically</font>

548
00:26:28,920 --> 00:26:33,630
it's pretty impractical to attack the

549
00:26:31,380 --> 00:26:35,730
smart card itself because of the

550
00:26:33,630 --> 00:26:39,390
physical security elements<font color="#E5E5E5"> involved</font>

551
00:26:35,730 --> 00:26:41,220
because of risk of damage<font color="#E5E5E5"> and because</font>

552
00:26:39,390 --> 00:26:45,270
you know<font color="#E5E5E5"> even if you do manage to</font>

553
00:26:41,220 --> 00:26:47,430
directly read the data off the EEPROM on

554
00:26:45,270 --> 00:26:49,980
the smart card you still have to figure

555
00:26:47,430 --> 00:26:51,870
<font color="#CCCCCC">out</font><font color="#E5E5E5"> how to interpret that data because</font>

556
00:26:49,980 --> 00:26:54,530
you no longer have the operating system

557
00:26:51,870 --> 00:26:58,350
on your<font color="#E5E5E5"> side</font><font color="#CCCCCC"> to help you out</font><font color="#E5E5E5"> there</font>

558
00:26:54,530 --> 00:27:00,930
instead most attacks on smart cards rely

559
00:26:58,350 --> 00:27:05,040
on broken cryptographic operations or

560
00:27:00,930 --> 00:27:08,250
they rely on side channel leaks smart

561
00:27:05,040 --> 00:27:11,940
cards run very very small and heavily

562
00:27:08,250 --> 00:27:14,430
optimized applications this<font color="#E5E5E5"> is you know</font>

563
00:27:11,940 --> 00:27:15,840
<font color="#CCCCCC">they kind of interestingly enough you</font>

564
00:27:14,430 --> 00:27:20,010
know these cards were invented in<font color="#E5E5E5"> the</font>

565
00:27:15,840 --> 00:27:23,070
70s and you know since then they haven't

566
00:27:20,010 --> 00:27:28,530
<font color="#E5E5E5">changed a whole lot so you only</font><font color="#CCCCCC"> have a</font>

567
00:27:23,070 --> 00:27:31,230
couple k of you know persistent storage

568
00:27:28,530 --> 00:27:34,020
you only have a handful of megahertz of

569
00:27:31,230 --> 00:27:35,940
processing speed and additionally you

570
00:27:34,020 --> 00:27:38,040
know<font color="#E5E5E5"> the they're very low powered</font>

571
00:27:35,940 --> 00:27:39,930
devices as well especially when<font color="#E5E5E5"> you</font>

572
00:27:38,040 --> 00:27:42,360
<font color="#E5E5E5">consider contactless cards which are</font>

573
00:27:39,930 --> 00:27:45,900
powered you know just from the induction

574
00:27:42,360 --> 00:27:47,969
field because<font color="#E5E5E5"> of this you know the very</font>

575
00:27:45,900 --> 00:27:50,070
limited scope of the operating systems

576
00:27:47,970 --> 00:27:51,900
<font color="#E5E5E5">on these cards you're kind of unlikely</font>

577
00:27:50,070 --> 00:27:54,260
to find<font color="#E5E5E5"> things like buffer overflow</font>

578
00:27:51,900 --> 00:27:57,510
attacks just because you<font color="#E5E5E5"> don't really</font>

579
00:27:54,260 --> 00:28:00,360
<font color="#E5E5E5">have</font><font color="#CCCCCC"> the space to have that much code on</font>

580
00:27:57,510 --> 00:28:02,040
these<font color="#E5E5E5"> cards but because they've</font><font color="#CCCCCC"> been</font>

581
00:28:00,360 --> 00:28:03,540
around for so long there's a lot of

582
00:28:02,040 --> 00:28:06,750
<font color="#E5E5E5">software that allows you to interact</font>

583
00:28:03,540 --> 00:28:08,220
with no smart cards so card peak is one

584
00:28:06,750 --> 00:28:12,390
of my favorite applications for doing

585
00:28:08,220 --> 00:28:14,100
this runs on Windows Linux Mac OS and it

586
00:28:12,390 --> 00:28:16,500
allows you to read both contact list and

587
00:28:14,100 --> 00:28:17,699
contact cards should you<font color="#E5E5E5"> have you know</font>

588
00:28:16,500 --> 00:28:21,060
the appropriate readers for your

589
00:28:17,700 --> 00:28:24,030
computer an XP tag info is an<font color="#E5E5E5"> Android</font>

590
00:28:21,060 --> 00:28:26,040
application that allows you to read NFC

591
00:28:24,030 --> 00:28:28,230
cards on a android phone that supports

592
00:28:26,040 --> 00:28:30,330
them it's also quite cool that it will

593
00:28:28,230 --> 00:28:33,180
attempt to interpret the contents of<font color="#E5E5E5"> the</font>

594
00:28:30,330 --> 00:28:36,090
card if it is able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> and there's also</font>

595
00:28:33,180 --> 00:28:38,400
the e subs a smart ticket checker which

596
00:28:36,090 --> 00:28:41,049
allows you to read the contents of<font color="#E5E5E5"> an it</font>

597
00:28:38,400 --> 00:28:43,779
so<font color="#E5E5E5"> card which</font><font color="#CCCCCC"> is also an</font><font color="#E5E5E5"> Android app</font>

598
00:28:41,049 --> 00:28:45,940
occasion so if you have one<font color="#CCCCCC"> of these UK</font>

599
00:28:43,779 --> 00:28:49,840
transit cards you can see what

600
00:28:45,940 --> 00:28:52,539
<font color="#CCCCCC">information is held on them but the fun</font>

601
00:28:49,840 --> 00:28:55,330
doesn't<font color="#E5E5E5"> stop there because you can also</font>

602
00:28:52,539 --> 00:28:58,809
build your own smart cards there's a

603
00:28:55,330 --> 00:29:02,619
<font color="#E5E5E5">very</font><font color="#CCCCCC"> interesting talk at defcon 21 about</font>

604
00:28:58,809 --> 00:29:06,039
these two guys who built a custom gsm

605
00:29:02,619 --> 00:29:08,889
network at tor camp and they allowed

606
00:29:06,039 --> 00:29:11,470
people to write their own applications

607
00:29:08,889 --> 00:29:15,908
to live on sim cards that they issued at

608
00:29:11,470 --> 00:29:18,580
the cap so they have on this github page

609
00:29:15,909 --> 00:29:21,369
a bunch of documentation on the Java

610
00:29:18,580 --> 00:29:23,139
card SDK how you go about loading

611
00:29:21,369 --> 00:29:26,970
applications onto smart cards how to

612
00:29:23,139 --> 00:29:29,590
test it you know all that<font color="#E5E5E5"> fun stuff a</font>

613
00:29:26,970 --> 00:29:32,019
thing to hopefully get out of this is

614
00:29:29,590 --> 00:29:33,908
<font color="#CCCCCC">that we have tiny computers in all of</font>

615
00:29:32,019 --> 00:29:36,539
<font color="#E5E5E5">our pockets you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> we have them in our</font>

616
00:29:33,909 --> 00:29:40,499
appliances they're just<font color="#E5E5E5"> absolutely</font>

617
00:29:36,539 --> 00:29:52,830
everywhere and if you say hello to them

618
00:29:40,499 --> 00:30:04,659
props will say hi back thank you yes

619
00:29:52,830 --> 00:30:07,449
<font color="#CCCCCC">okay so any questions anybody this</font>

620
00:30:04,659 --> 00:30:11,379
question is there any online tutorials

621
00:30:07,450 --> 00:30:15,759
so there are quite a few online

622
00:30:11,379 --> 00:30:19,418
resources regarding the how to read

623
00:30:15,759 --> 00:30:22,419
information on smart cards the programs

624
00:30:19,419 --> 00:30:25,450
that i mentioned do for example card

625
00:30:22,419 --> 00:30:27,249
peak is fully open source and so then

626
00:30:25,450 --> 00:30:30,220
you can go<font color="#CCCCCC"> through the source code of</font>

627
00:30:27,249 --> 00:30:32,259
that see which commands<font color="#CCCCCC"> it's sending and</font>

628
00:30:30,220 --> 00:30:35,830
get a better understanding of<font color="#CCCCCC"> how</font><font color="#E5E5E5"> it's</font>

629
00:30:32,259 --> 00:30:39,519
<font color="#E5E5E5">speaking with the cards there are also a</font>

630
00:30:35,830 --> 00:30:42,009
handful of other websites that go into

631
00:30:39,519 --> 00:30:45,129
that with more detail that'll put on

632
00:30:42,009 --> 00:30:47,669
that URL it's not up right now because

633
00:30:45,129 --> 00:30:50,918
<font color="#CCCCCC">ssh is blocked on this network i forgot</font>

634
00:30:47,669 --> 00:30:53,490
so hopefully<font color="#E5E5E5"> later this evening i'll put</font>

635
00:30:50,919 --> 00:30:53,490
<font color="#CCCCCC">that</font><font color="#E5E5E5"> up for you</font>

636
00:30:53,549 --> 00:31:04,480
nes<font color="#E5E5E5"> yeah you actually</font><font color="#CCCCCC"> so codes don't</font>

637
00:30:58,600 --> 00:31:09,129
actually still bouncing uh they can so

638
00:31:04,480 --> 00:31:14,320
for<font color="#E5E5E5"> example the</font><font color="#CCCCCC"> Glasgow subway cards do</font>

639
00:31:09,130 --> 00:31:16,029
store a balance on them and you when you

640
00:31:14,320 --> 00:31:17,830
go through a ticket barrier it goes

641
00:31:16,029 --> 00:31:20,500
through and it validates you know that

642
00:31:17,830 --> 00:31:22,799
<font color="#CCCCCC">your top-ups were legitimately signed</font>

643
00:31:20,500 --> 00:31:26,860
and then it you know deduct the balance

644
00:31:22,799 --> 00:31:29,010
but in theory because of that signature

645
00:31:26,860 --> 00:31:31,299
you can't modify your balance yourself

646
00:31:29,010 --> 00:31:36,870
whether that's actually the case or<font color="#CCCCCC"> not</font>

647
00:31:31,299 --> 00:31:40,389
<font color="#E5E5E5">I leave open to interpretation and</font>

648
00:31:36,870 --> 00:31:44,320
considering the hiepro<font color="#E5E5E5"> Hospital easy and</font>

649
00:31:40,389 --> 00:31:50,529
breathe how is it the the what article

650
00:31:44,320 --> 00:31:54,158
sorry and he from uh I'm not aware of

651
00:31:50,529 --> 00:31:57,059
what happened at Heathrow so<font color="#E5E5E5"> two</font>

652
00:31:54,159 --> 00:32:02,919
employees basically they<font color="#CCCCCC"> clone that</font>

653
00:31:57,059 --> 00:32:05,200
physical access<font color="#CCCCCC"> gosh no</font><font color="#E5E5E5"> easy to do so</font>

654
00:32:02,919 --> 00:32:08,710
depending on<font color="#CCCCCC"> the card type it can be</font>

655
00:32:05,200 --> 00:32:11,320
reasonably easy to do if it was<font color="#CCCCCC"> a mifare</font>

656
00:32:08,710 --> 00:32:15,639
classic card as<font color="#CCCCCC"> I mentioned you can bye</font>

657
00:32:11,320 --> 00:32:19,178
completely reprogrammable my fare cards

658
00:32:15,639 --> 00:32:24,120
and so you can just<font color="#CCCCCC"> use off-the-shelf</font>

659
00:32:19,179 --> 00:32:29,230
hardware you know just<font color="#E5E5E5"> a boring My Fair</font>

660
00:32:24,120 --> 00:32:31,809
writer too or sorry an NFC a like dongle

661
00:32:29,230 --> 00:32:34,000
to read the data off<font color="#CCCCCC"> the original card</font>

662
00:32:31,809 --> 00:32:37,000
break the encryption keys and then write

663
00:32:34,000 --> 00:32:40,240
it<font color="#CCCCCC"> onto the</font><font color="#E5E5E5"> new card because mifare</font>

664
00:32:37,000 --> 00:32:41,649
classic is<font color="#CCCCCC"> just data there's no</font>

665
00:32:40,240 --> 00:32:43,450
application or anything like that that

666
00:32:41,649 --> 00:32:46,360
<font color="#CCCCCC">you</font><font color="#E5E5E5"> need to clone you just need to copy</font>

667
00:32:43,450 --> 00:32:48,250
the data over but it could it's more

668
00:32:46,360 --> 00:32:56,559
difficult<font color="#E5E5E5"> for other cards like des fire</font>

669
00:32:48,250 --> 00:32:58,840
and such yes no Mikey drunkenly told me

670
00:32:56,559 --> 00:32:59,610
that he<font color="#CCCCCC"> had a question for me last</font><font color="#E5E5E5"> night</font>

671
00:32:58,840 --> 00:33:02,428
so

672
00:32:59,610 --> 00:33:05,969
<font color="#CCCCCC">cilla remember speakers but what is your</font>

673
00:33:02,429 --> 00:33:13,110
opinion of them apples gavel to my new

674
00:33:05,970 --> 00:33:17,309
smart<font color="#CCCCCC"> phone wall so the idea</font><font color="#E5E5E5"> that is</font>

675
00:33:13,110 --> 00:33:19,949
Apple for their iCloud encryption use

676
00:33:17,309 --> 00:33:22,080
smart cards in order to store the

677
00:33:19,950 --> 00:33:27,540
encryption keys that are used you<font color="#E5E5E5"> know</font>

678
00:33:22,080 --> 00:33:30,299
to secure user data and effectively if

679
00:33:27,540 --> 00:33:33,750
you think<font color="#E5E5E5"> about it smart cards are just</font>

680
00:33:30,299 --> 00:33:35,879
very cheap hardware security modules you

681
00:33:33,750 --> 00:33:37,620
can use them to store private key data

682
00:33:35,880 --> 00:33:39,390
you can use them to perform

683
00:33:37,620 --> 00:33:43,199
cryptographic operations on your behalf

684
00:33:39,390 --> 00:33:46,220
and they will not expose the private key

685
00:33:43,200 --> 00:33:47,880
data unless they're programmed to do so

686
00:33:46,220 --> 00:33:50,669
additionally one thing that's sort of

687
00:33:47,880 --> 00:33:52,590
interesting that Apple does is once they

688
00:33:50,669 --> 00:33:55,470
finish using a card they throw<font color="#E5E5E5"> it into a</font>

689
00:33:52,590 --> 00:33:58,709
shredder which is you know potentially

690
00:33:55,470 --> 00:34:01,470
<font color="#E5E5E5">overkill because the idea with the smart</font>

691
00:33:58,710 --> 00:34:03,419
card is that if you<font color="#E5E5E5"> you don't have too</font>

692
00:34:01,470 --> 00:34:05,340
many invalid pin entries or something

693
00:34:03,419 --> 00:34:07,890
like that it will block itself and

694
00:34:05,340 --> 00:34:11,779
refuse to<font color="#CCCCCC"> do anything but</font><font color="#E5E5E5"> you know I</font>

695
00:34:07,890 --> 00:34:11,780
suppose there's no harm in shredding it

696
00:34:13,730 --> 00:34:22,609
anything<font color="#E5E5E5"> else</font><font color="#CCCCCC"> okay well let's</font>

697
00:34:22,719 --> 00:34:24,779
you

