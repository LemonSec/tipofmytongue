1
00:00:03,040 --> 00:00:09,769
thanks everyone<font color="#E5E5E5"> thanks coming to watch</font>

2
00:00:06,680 --> 00:00:11,480
my talk on 21st century<font color="#CCCCCC"> war stories big</font>

3
00:00:09,769 --> 00:00:13,160
thanks to be sized to have me<font color="#CCCCCC"> back i</font>

4
00:00:11,480 --> 00:00:14,900
would say last year doing<font color="#E5E5E5"> a talk with</font>

5
00:00:13,160 --> 00:00:17,840
Dave Hardy on interactive<font color="#E5E5E5"> PowerShell</font>

6
00:00:14,900 --> 00:00:19,460
sessions with<font color="#E5E5E5"> metasploit I've tried to</font>

7
00:00:17,840 --> 00:00:21,110
make this talk for everyone so it's not

8
00:00:19,460 --> 00:00:22,850
really aimed at the it's not<font color="#E5E5E5"> just aimed</font>

9
00:00:21,110 --> 00:00:25,520
at the social engineering enthusiasts

10
00:00:22,850 --> 00:00:26,690
<font color="#E5E5E5">but also the professional Red Team ER if</font>

11
00:00:25,520 --> 00:00:31,279
you've got<font color="#CCCCCC"> any questions I've</font><font color="#E5E5E5"> grants</font>

12
00:00:26,690 --> 00:00:32,300
them at the end or a beer later so the

13
00:00:31,279 --> 00:00:33,320
talk is going<font color="#E5E5E5"> to run a little bit like</font>

14
00:00:32,299 --> 00:00:35,199
this we're going<font color="#E5E5E5"> to talk a bit about</font>

15
00:00:33,320 --> 00:00:37,370
open-source intelligence-gathering

16
00:00:35,199 --> 00:00:39,289
reconnaissance reconnaissance probably

17
00:00:37,370 --> 00:00:41,449
all the most important parts of any

18
00:00:39,289 --> 00:00:42,859
penetration<font color="#CCCCCC"> test or red team the</font>

19
00:00:41,449 --> 00:00:44,510
foundation of great success<font color="#CCCCCC"> in my</font>

20
00:00:42,859 --> 00:00:46,960
opinion and they're<font color="#CCCCCC"> talking about</font><font color="#E5E5E5"> the</font>

21
00:00:44,510 --> 00:00:49,760
current tooling in the industry

22
00:00:46,960 --> 00:00:52,429
infiltration tactics techniques and

23
00:00:49,760 --> 00:00:54,019
procedures and persistent so once you've

24
00:00:52,429 --> 00:00:56,059
got inside a network how you can<font color="#E5E5E5"> stay</font>

25
00:00:54,019 --> 00:00:57,530
inside a network reliably any lateral

26
00:00:56,059 --> 00:01:00,318
movement that you might need<font color="#E5E5E5"> to do and</font>

27
00:00:57,530 --> 00:01:01,729
then acting on your objectives then i'm

28
00:01:00,319 --> 00:01:03,799
going to<font color="#CCCCCC"> introduce them a tool like</font>

29
00:01:01,729 --> 00:01:09,860
we've written an attitude called posh<font color="#CCCCCC"> t2</font>

30
00:01:03,799 --> 00:01:11,360
and do a live demo so Who am<font color="#E5E5E5"> I so my</font>

31
00:01:09,860 --> 00:01:12,830
name is Ben Turner and for those you

32
00:01:11,360 --> 00:01:15,800
don't<font color="#E5E5E5"> know I'm a penetration tester and</font>

33
00:01:12,830 --> 00:01:21,050
<font color="#E5E5E5">Red Team ER for nessa chewed this to me</font>

34
00:01:15,800 --> 00:01:22,940
before jewelry and after a beer I've

35
00:01:21,050 --> 00:01:24,890
been through the questing<font color="#E5E5E5"> leader exams</font>

36
00:01:22,940 --> 00:01:27,620
and done my fair amount of IT health

37
00:01:24,890 --> 00:01:30,740
checks which<font color="#E5E5E5"> I think sets a good</font>

38
00:01:27,620 --> 00:01:32,840
foundation for red teaming gives you a

39
00:01:30,740 --> 00:01:35,060
good experience<font color="#CCCCCC"> on all different</font><font color="#E5E5E5"> types</font>

40
00:01:32,840 --> 00:01:37,310
of infrastructure in<font color="#E5E5E5"> endpoints and a</font>

41
00:01:35,060 --> 00:01:38,930
good general understanding of sort<font color="#E5E5E5"> of</font>

42
00:01:37,310 --> 00:01:43,190
<font color="#E5E5E5">different network topologies firewall</font>

43
00:01:38,930 --> 00:01:45,200
rules and infrastructure as of late most

44
00:01:43,190 --> 00:01:48,140
of my focus been around red teaming and

45
00:01:45,200 --> 00:01:50,300
SC and star which have also helped the

46
00:01:48,140 --> 00:01:53,360
star simulated attack specialist exam

47
00:01:50,300 --> 00:01:55,460
now for two years also not just a

48
00:01:53,360 --> 00:01:59,210
full-time hacking nerd do you like

49
00:01:55,460 --> 00:02:01,429
riding motorbikes skiing which

50
00:01:59,210 --> 00:02:03,860
apparently is not boarding but hey a

51
00:02:01,430 --> 00:02:06,200
little<font color="#E5E5E5"> bit flying drones and traveling</font>

52
00:02:03,860 --> 00:02:09,860
try not<font color="#CCCCCC"> to</font><font color="#E5E5E5"> combine</font><font color="#CCCCCC"> the two and</font><font color="#E5E5E5"> I work</font>

53
00:02:06,200 --> 00:02:12,230
for an attitude<font color="#E5E5E5"> bit of a disclaimer</font>

54
00:02:09,860 --> 00:02:13,459
about<font color="#E5E5E5"> the presentation so it reflects</font>

55
00:02:12,230 --> 00:02:15,590
<font color="#CCCCCC">real life experiences and observations</font>

56
00:02:13,459 --> 00:02:16,190
of me however some<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the customers</font>

57
00:02:15,590 --> 00:02:18,020
<font color="#CCCCCC">sensing</font>

58
00:02:16,190 --> 00:02:22,730
informations been redacted for client

59
00:02:18,020 --> 00:02:25,340
confidentiality so what<font color="#E5E5E5"> is 21st century</font>

60
00:02:22,730 --> 00:02:27,440
hacking so 21st century hacking is an

61
00:02:25,340 --> 00:02:29,510
amalgamation of social<font color="#CCCCCC"> engineering red</font>

62
00:02:27,440 --> 00:02:31,760
<font color="#E5E5E5">teaming star and see best it's the most</font>

63
00:02:29,510 --> 00:02:33,049
cutting edge of all the cutting<font color="#E5E5E5"> edge and</font>

64
00:02:31,760 --> 00:02:35,750
realistic of all the assurance services

65
00:02:33,050 --> 00:02:37,630
it brings a mix of skill sets and team

66
00:02:35,750 --> 00:02:40,730
members in order to achieve an objective

67
00:02:37,630 --> 00:02:42,200
it includes things like physical<font color="#CCCCCC"> SC USB</font>

68
00:02:40,730 --> 00:02:44,179
drop spearfishing telephone calls

69
00:02:42,200 --> 00:02:46,070
telephone social engineering hacking and

70
00:02:44,180 --> 00:02:49,220
other stuff as well it's free from

71
00:02:46,070 --> 00:02:50,600
caveat at all forms no hackers would be

72
00:02:49,220 --> 00:02:52,430
constrained it like this so why should

73
00:02:50,600 --> 00:02:54,829
we put those constraints on us as well

74
00:02:52,430 --> 00:02:56,330
and in my<font color="#CCCCCC"> opinion if you're</font><font color="#E5E5E5"> not waking</font>

75
00:02:54,830 --> 00:02:58,520
up<font color="#E5E5E5"> at 3am to check you've still got</font>

76
00:02:56,330 --> 00:03:00,280
shell inside the organization you

77
00:02:58,520 --> 00:03:02,480
haven't really experienced red team in

78
00:03:00,280 --> 00:03:04,430
what I tend not to class red teaming

79
00:03:02,480 --> 00:03:05,780
eyes is blowing the doors off a building

80
00:03:04,430 --> 00:03:08,210
and access computer systems that way

81
00:03:05,780 --> 00:03:09,800
that's more<font color="#E5E5E5"> of a military analogy and</font>

82
00:03:08,210 --> 00:03:12,620
kind<font color="#E5E5E5"> of don't think we're quite at that</font>

83
00:03:09,800 --> 00:03:15,350
level yet although I'd quite enjoy to do

84
00:03:12,620 --> 00:03:17,690
that I think the UK's slightly behind

85
00:03:15,350 --> 00:03:19,130
the curve been over to<font color="#E5E5E5"> the US</font><font color="#CCCCCC"> a little</font>

86
00:03:17,690 --> 00:03:20,630
bit to do some competence over there and

87
00:03:19,130 --> 00:03:23,299
nations are doing red teaming all the

88
00:03:20,630 --> 00:03:25,280
time I think the introduction of sort<font color="#E5E5E5"> of</font>

89
00:03:23,300 --> 00:03:27,020
see best to start to get people like

90
00:03:25,280 --> 00:03:28,610
learning about<font color="#E5E5E5"> red teaming and it's</font>

91
00:03:27,020 --> 00:03:32,140
getting<font color="#E5E5E5"> a lot more and more but I think</font>

92
00:03:28,610 --> 00:03:32,140
UK slightly behind the curve here a bit

93
00:03:32,739 --> 00:03:37,430
so basically<font color="#E5E5E5"> in a nutshell when people</font>

94
00:03:35,510 --> 00:03:38,690
<font color="#E5E5E5">ask me sort of why should</font><font color="#CCCCCC"> we do red</font>

95
00:03:37,430 --> 00:03:40,130
teaming on top of all the normal

96
00:03:38,690 --> 00:03:42,620
penetration testing and assurance

97
00:03:40,130 --> 00:03:44,780
services got this quite good little

98
00:03:42,620 --> 00:03:46,820
story and we were<font color="#E5E5E5"> in the Middle East we</font>

99
00:03:44,780 --> 00:03:48,800
were hacking a bank they do a lot of VA

100
00:03:46,820 --> 00:03:49,519
run ability analysis and pen testing of

101
00:03:48,800 --> 00:03:51,560
the<font color="#E5E5E5"> road and they've got their own</font>

102
00:03:49,519 --> 00:03:53,630
internal<font color="#E5E5E5"> pen test team so they employed</font>

103
00:03:51,560 --> 00:03:55,519
us and they said well<font color="#E5E5E5"> three</font><font color="#CCCCCC"> honest we</font>

104
00:03:53,630 --> 00:03:56,930
don't<font color="#E5E5E5"> think you're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get in we're</font>

105
00:03:55,519 --> 00:03:58,280
pretty<font color="#CCCCCC"> good and we were like oh crap</font>

106
00:03:56,930 --> 00:04:00,650
they obviously do quite a bit<font color="#E5E5E5"> of</font>

107
00:03:58,280 --> 00:04:02,300
assurance services anyway so they said

108
00:04:00,650 --> 00:04:03,769
right okay do what<font color="#CCCCCC"> you need</font><font color="#E5E5E5"> to do this</font>

109
00:04:02,300 --> 00:04:05,360
is our<font color="#CCCCCC"> bank is</font><font color="#E5E5E5"> our layout this is our</font>

110
00:04:03,769 --> 00:04:07,340
ATM machines blah blah blah<font color="#E5E5E5"> do what you</font>

111
00:04:05,360 --> 00:04:08,750
<font color="#E5E5E5">need to do</font><font color="#CCCCCC"> okay so we thought well we'll</font>

112
00:04:07,340 --> 00:04:10,190
<font color="#E5E5E5">try and attack the ATM machines not</font>

113
00:04:08,750 --> 00:04:11,870
really done an awful lot on ATM machines

114
00:04:10,190 --> 00:04:14,090
myself but treat it as any normal

115
00:04:11,870 --> 00:04:16,280
network and try and<font color="#E5E5E5"> hack</font><font color="#CCCCCC"> in so this is</font>

116
00:04:14,090 --> 00:04:18,560
<font color="#CCCCCC">the ATM machine the pictures kind of</font>

117
00:04:16,279 --> 00:04:21,440
speak for themselves<font color="#E5E5E5"> so in one of the</font>

118
00:04:18,560 --> 00:04:22,910
ATM machines inside a mall we did have

119
00:04:21,440 --> 00:04:26,510
security guards bias by the way just in

120
00:04:22,910 --> 00:04:28,970
case<font color="#E5E5E5"> but this is the back of the ATM</font>

121
00:04:26,510 --> 00:04:29,930
machine outside the ATM<font color="#CCCCCC"> machine this was</font>

122
00:04:28,970 --> 00:04:32,389
the lock that

123
00:04:29,930 --> 00:04:34,039
been ripped off it was<font color="#E5E5E5"> actually built on</font>

124
00:04:32,389 --> 00:04:36,410
wood which is quite<font color="#E5E5E5"> interesting so</font>

125
00:04:34,039 --> 00:04:37,909
pretty much<font color="#E5E5E5"> just pushed off and as you</font>

126
00:04:36,410 --> 00:04:40,759
can see there's a cisco<font color="#CCCCCC"> Rooter hanging</font>

127
00:04:37,910 --> 00:04:42,800
out the back of<font color="#CCCCCC"> it so</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> thought why</font>

128
00:04:40,759 --> 00:04:43,850
<font color="#E5E5E5">okay well it's probably over a 3g wine</font>

129
00:04:42,800 --> 00:04:45,169
or something<font color="#E5E5E5"> like it's going to be all</font>

130
00:04:43,850 --> 00:04:47,270
locked down the ports are going to be

131
00:04:45,169 --> 00:04:49,909
securely configured so we can't<font color="#E5E5E5"> just</font>

132
00:04:47,270 --> 00:04:54,139
plug in and see anything note we were

133
00:04:49,910 --> 00:04:56,240
wrong so when we plugged in didn't

134
00:04:54,139 --> 00:04:58,250
actually give a<font color="#E5E5E5"> dhcp which is fine i was</font>

135
00:04:56,240 --> 00:05:00,139
able to boot the network see what about

136
00:04:58,250 --> 00:05:01,639
plugging give herself an IP address see

137
00:05:00,139 --> 00:05:04,250
what the default gateway was add a

138
00:05:01,639 --> 00:05:05,870
default gateway start hacking the ATM

139
00:05:04,250 --> 00:05:06,860
the ATM was quite firewalled but you can

140
00:05:05,870 --> 00:05:08,360
see<font color="#CCCCCC"> all the traffic you do</font>

141
00:05:06,860 --> 00:05:10,789
man-in-the-middle attacks to see what

142
00:05:08,360 --> 00:05:12,470
traffic was happening<font color="#CCCCCC"> i could see it was</font>

143
00:05:10,789 --> 00:05:14,270
going over the network over the<font color="#E5E5E5"> 3g 4g</font>

144
00:05:12,470 --> 00:05:16,970
<font color="#E5E5E5">land back to the net back to the core</font>

145
00:05:14,270 --> 00:05:18,380
network so<font color="#CCCCCC"> i asked the guy who was with</font>

146
00:05:16,970 --> 00:05:20,360
me I said you know what's your domain

147
00:05:18,380 --> 00:05:22,789
controller for your network<font color="#E5E5E5"> and he said</font>

148
00:05:20,360 --> 00:05:24,259
it's<font color="#E5E5E5"> on this</font><font color="#CCCCCC"> assist I was like okay</font>

149
00:05:22,789 --> 00:05:26,570
which you know you won't<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to get</font>

150
00:05:24,259 --> 00:05:27,919
here<font color="#E5E5E5"> so don't worry all of our</font><font color="#CCCCCC"> our DP'd</font>

151
00:05:26,570 --> 00:05:31,520
straight<font color="#CCCCCC"> onto the domain controller</font>

152
00:05:27,919 --> 00:05:33,680
house like from in the middle of nowhere

153
00:05:31,520 --> 00:05:35,570
in the middle of a mall I can get<font color="#CCCCCC"> onto</font>

154
00:05:33,680 --> 00:05:37,190
ATM network which by just plugging in at

155
00:05:35,570 --> 00:05:39,710
the back give myself an IP and<font color="#E5E5E5"> RD peeing</font>

156
00:05:37,190 --> 00:05:43,909
<font color="#CCCCCC">onto your domain</font><font color="#E5E5E5"> controller this is what</font>

157
00:05:39,710 --> 00:05:46,698
red teaming is this was another example

158
00:05:43,909 --> 00:05:47,599
pretty much same place in Middle East

159
00:05:46,699 --> 00:05:49,370
<font color="#E5E5E5">they have these like little things</font>

160
00:05:47,599 --> 00:05:50,900
outside the malls it's basically just a

161
00:05:49,370 --> 00:05:52,610
little air cond rooms and they have

162
00:05:50,900 --> 00:05:54,830
<font color="#E5E5E5">their own self sufficient kiosk and ATM</font>

163
00:05:52,610 --> 00:05:55,940
machines another<font color="#E5E5E5"> example this is the</font>

164
00:05:54,830 --> 00:05:57,710
cupboard that<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the network</font>

165
00:05:55,940 --> 00:05:59,389
infrastructure was placed in literally

166
00:05:57,710 --> 00:06:01,280
it<font color="#E5E5E5"> was just ripped open this</font><font color="#CCCCCC"> was two</font>

167
00:05:59,389 --> 00:06:02,960
examples they even<font color="#CCCCCC"> put the IP address</font>

168
00:06:01,280 --> 00:06:07,849
<font color="#CCCCCC">and default gateway and everything for</font>

169
00:06:02,960 --> 00:06:09,289
me so that one was even easier all this

170
00:06:07,849 --> 00:06:10,370
could have been done anonymously as well

171
00:06:09,289 --> 00:06:12,320
because you could have just placed a war

172
00:06:10,370 --> 00:06:14,300
hoodie walk in<font color="#E5E5E5"> there</font><font color="#CCCCCC"> plug-in put a</font>

173
00:06:12,320 --> 00:06:16,009
wireless access point in walk out and do

174
00:06:14,300 --> 00:06:17,080
all this remotely you can have access to

175
00:06:16,009 --> 00:06:22,250
their full internal infrastructure

176
00:06:17,080 --> 00:06:23,780
really quite scary stuff so everything

177
00:06:22,250 --> 00:06:25,310
we do when we do pen testing<font color="#CCCCCC"> and red</font>

178
00:06:23,780 --> 00:06:27,169
teaming we map it back to the cyber

179
00:06:25,310 --> 00:06:29,169
attack chain this includes the

180
00:06:27,169 --> 00:06:31,669
reconnaissance phase the delivery phase

181
00:06:29,169 --> 00:06:33,560
exploitation pivoting and then acting on

182
00:06:31,669 --> 00:06:35,780
your objectives so everything in this

183
00:06:33,560 --> 00:06:38,919
presentation will hopefully map back<font color="#CCCCCC"> to</font>

184
00:06:35,780 --> 00:06:38,919
that one<font color="#E5E5E5"> of these phases</font>

185
00:06:41,880 --> 00:06:47,140
so understanding the cyber cyber threat

186
00:06:44,770 --> 00:06:49,780
is quite important and<font color="#E5E5E5"> it somehow it</font>

187
00:06:47,140 --> 00:06:52,479
gives the ability to provide risk at the

188
00:06:49,780 --> 00:06:54,190
board level so you<font color="#E5E5E5"> want to know what</font><font color="#CCCCCC"> the</font>

189
00:06:52,480 --> 00:06:55,030
threats are to your organization<font color="#CCCCCC"> and</font>

190
00:06:54,190 --> 00:06:56,710
this is where sort of threat

191
00:06:55,030 --> 00:06:58,869
intelligence reports come in and it

192
00:06:56,710 --> 00:07:00,280
plays a big role into into what we do I

193
00:06:58,870 --> 00:07:01,390
won't go with too much into threat

194
00:07:00,280 --> 00:07:04,270
intelligence because that's obviously a

195
00:07:01,390 --> 00:07:05,890
talk in itself but for me when i'm doing

196
00:07:04,270 --> 00:07:06,940
<font color="#E5E5E5">a red teaming engagement i want to know</font>

197
00:07:05,890 --> 00:07:08,380
the through actor<font color="#CCCCCC"> that they want me to</font>

198
00:07:06,940 --> 00:07:11,620
<font color="#E5E5E5">mimic that's kind of the most important</font>

199
00:07:08,380 --> 00:07:13,600
for me each through actor has different

200
00:07:11,620 --> 00:07:15,250
capabilities so if they're telling<font color="#CCCCCC"> me</font>

201
00:07:13,600 --> 00:07:18,490
they want me<font color="#E5E5E5"> to act like</font><font color="#CCCCCC"> a nation</font><font color="#E5E5E5"> stay</font><font color="#CCCCCC"> I</font>

202
00:07:15,250 --> 00:07:20,080
need to behave differently so range it

203
00:07:18,490 --> 00:07:21,460
ranges from sort<font color="#E5E5E5"> of script kiddies or</font>

204
00:07:20,080 --> 00:07:23,409
lone Wolf's which have not much

205
00:07:21,460 --> 00:07:26,109
capability at all it's easy to

206
00:07:23,410 --> 00:07:27,820
fingerprint detect and respond whereas

207
00:07:26,110 --> 00:07:30,030
<font color="#CCCCCC">nation-state is completely opposite</font><font color="#E5E5E5"> and</font>

208
00:07:27,820 --> 00:07:32,770
it's got significant capability in funds

209
00:07:30,030 --> 00:07:34,840
it's got custom cryptography protocol

210
00:07:32,770 --> 00:07:36,280
multiplexing anti detection and<font color="#E5E5E5"> zero</font>

211
00:07:34,840 --> 00:07:38,320
days and things like that<font color="#E5E5E5"> so they're</font>

212
00:07:36,280 --> 00:07:44,020
<font color="#E5E5E5">really hard to fingerprint detect and to</font>

213
00:07:38,320 --> 00:07:46,540
respond to so the reconyx is the

214
00:07:44,020 --> 00:07:47,770
reconnaissance stage week on the most

215
00:07:46,540 --> 00:07:49,720
important really and<font color="#E5E5E5"> I can't stress that</font>

216
00:07:47,770 --> 00:07:51,099
enough to anyone it's the<font color="#CCCCCC"> foundation of</font>

217
00:07:49,720 --> 00:07:52,600
great success and I like to live while

218
00:07:51,100 --> 00:07:55,660
the analogy proper planning prevents

219
00:07:52,600 --> 00:07:57,070
piss-poor performance most importantly

220
00:07:55,660 --> 00:07:58,630
the more you can find out<font color="#CCCCCC"> about</font><font color="#E5E5E5"> your</font>

221
00:07:57,070 --> 00:08:00,099
target environment the better you can

222
00:07:58,630 --> 00:08:02,020
hack it better you can weaponize your

223
00:08:00,100 --> 00:08:03,700
payload communications to be able<font color="#E5E5E5"> to</font>

224
00:08:02,020 --> 00:08:06,549
hack it in a better way and to not get

225
00:08:03,700 --> 00:08:07,990
detected basically some of the things

226
00:08:06,550 --> 00:08:10,060
that<font color="#CCCCCC"> I tend to use for doing</font>

227
00:08:07,990 --> 00:08:11,650
reconnaissance stages are multi go and

228
00:08:10,060 --> 00:08:13,090
it sort of finds<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> things on the</font>

229
00:08:11,650 --> 00:08:14,409
internet that<font color="#E5E5E5"> you might necessarily be</font>

230
00:08:13,090 --> 00:08:16,539
able to find which by doing<font color="#E5E5E5"> normal</font>

231
00:08:14,410 --> 00:08:17,890
google<font color="#E5E5E5"> hacking and things like that dns</font>

232
00:08:16,540 --> 00:08:20,170
reconnaissance is really important i'll

233
00:08:17,890 --> 00:08:22,000
come on<font color="#E5E5E5"> to that in a second even things</font>

234
00:08:20,170 --> 00:08:23,710
like who is records can give you a key

235
00:08:22,000 --> 00:08:25,540
key personnel inside<font color="#E5E5E5"> the organization</font>

236
00:08:23,710 --> 00:08:29,830
that<font color="#E5E5E5"> you might want to might want to</font>

237
00:08:25,540 --> 00:08:31,330
target other<font color="#E5E5E5"> things you can use our</font>

238
00:08:29,830 --> 00:08:34,120
media newsletters forums and white

239
00:08:31,330 --> 00:08:36,039
papers social networking is obviously a

240
00:08:34,120 --> 00:08:37,900
really really good one pamphlet access

241
00:08:36,039 --> 00:08:39,549
and people's information and people who

242
00:08:37,900 --> 00:08:43,209
work at<font color="#E5E5E5"> that organization and what they</font>

243
00:08:39,549 --> 00:08:44,800
do and what<font color="#E5E5E5"> roles they do twitter</font>

244
00:08:43,210 --> 00:08:46,690
<font color="#CCCCCC">facebook and</font><font color="#E5E5E5"> instagram also same sort of</font>

245
00:08:44,800 --> 00:08:48,459
thing github searching that's another

246
00:08:46,690 --> 00:08:50,770
great one recently we've<font color="#CCCCCC"> seen a lot of</font>

247
00:08:48,460 --> 00:08:52,990
information stored on github<font color="#E5E5E5"> and just</font>

248
00:08:50,770 --> 00:08:53,199
like not not even private get up so you

249
00:08:52,990 --> 00:08:54,790
can

250
00:08:53,200 --> 00:08:56,980
search the<font color="#CCCCCC"> gate of find the private</font><font color="#E5E5E5"> keys</font>

251
00:08:54,790 --> 00:08:59,260
passwords and they're often an exact

252
00:08:56,980 --> 00:09:00,520
replica of the organization's sort of

253
00:08:59,260 --> 00:09:02,260
<font color="#CCCCCC">application or anything so it's always</font>

254
00:09:00,520 --> 00:09:03,640
<font color="#E5E5E5">worth looking and get up just for things</font>

255
00:09:02,260 --> 00:09:05,590
like<font color="#E5E5E5"> that even though you thought out</font>

256
00:09:03,640 --> 00:09:07,630
that organization won't use<font color="#CCCCCC"> that type of</font>

257
00:09:05,590 --> 00:09:10,570
thing but they often people just put

258
00:09:07,630 --> 00:09:12,040
stuff on github<font color="#E5E5E5"> Google Maps this stuff</font>

259
00:09:10,570 --> 00:09:13,900
is quite good<font color="#E5E5E5"> as well when you're in</font>

260
00:09:12,040 --> 00:09:15,730
physical se so just finding<font color="#E5E5E5"> out where</font>

261
00:09:13,900 --> 00:09:17,140
that where they're located dropping that

262
00:09:15,730 --> 00:09:20,170
person<font color="#E5E5E5"> on the map and seeing where</font><font color="#CCCCCC"> you</font>

263
00:09:17,140 --> 00:09:21,730
can go another great great one is

264
00:09:20,170 --> 00:09:24,160
previous breaches so we<font color="#E5E5E5"> often use this</font>

265
00:09:21,730 --> 00:09:25,690
quite a lot how vibe in impound is also

266
00:09:24,160 --> 00:09:28,060
something quite a good one that links

267
00:09:25,690 --> 00:09:28,890
often<font color="#E5E5E5"> this but just looking at all the</font>

268
00:09:28,060 --> 00:09:31,479
<font color="#CCCCCC">different people</font><font color="#E5E5E5"> in the organization</font>

269
00:09:28,890 --> 00:09:33,160
using the domain name as a start point

270
00:09:31,480 --> 00:09:34,990
to look in the adobe breach gmail breach

271
00:09:33,160 --> 00:09:36,699
linkedin and that will<font color="#CCCCCC"> give you a great</font>

272
00:09:34,990 --> 00:09:38,320
start point or at least a few email

273
00:09:36,700 --> 00:09:43,140
addresses to use<font color="#E5E5E5"> before you do the</font><font color="#CCCCCC"> f</font>

274
00:09:38,320 --> 00:09:45,820
<font color="#E5E5E5">social engineering</font><font color="#CCCCCC"> also the showdown api</font>

275
00:09:43,140 --> 00:09:47,620
if you put<font color="#CCCCCC"> your customers name in the</font>

276
00:09:45,820 --> 00:09:49,810
showdown<font color="#E5E5E5"> apil often give you a vast</font>

277
00:09:47,620 --> 00:09:51,850
amount<font color="#E5E5E5"> of information about</font><font color="#CCCCCC"> what they've</font>

278
00:09:49,810 --> 00:09:53,260
got exposed on<font color="#CCCCCC"> the internet and then</font>

279
00:09:51,850 --> 00:09:57,190
also just coming<font color="#E5E5E5"> back to just normal</font>

280
00:09:53,260 --> 00:09:59,860
search engine google searching so doing

281
00:09:57,190 --> 00:10:01,240
a job recently and they said they

282
00:09:59,860 --> 00:10:02,950
weren't<font color="#E5E5E5"> very security aware so I was</font>

283
00:10:01,240 --> 00:10:04,840
like okay no problem and we're doing a

284
00:10:02,950 --> 00:10:06,430
remote sort of red team and type of

285
00:10:04,840 --> 00:10:08,680
approach we were going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do some social</font>

286
00:10:06,430 --> 00:10:10,329
engineering on against them because they

287
00:10:08,680 --> 00:10:11,680
said<font color="#E5E5E5"> they didn't</font><font color="#CCCCCC"> have much security in</font>

288
00:10:10,330 --> 00:10:13,810
implemented we were like okay<font color="#CCCCCC"> that's</font>

289
00:10:11,680 --> 00:10:15,339
fine no worries by<font color="#E5E5E5"> actually doing a bit</font>

290
00:10:13,810 --> 00:10:17,140
of a reverse lookup they were using mime

291
00:10:15,340 --> 00:10:19,270
cast and for those<font color="#E5E5E5"> you</font><font color="#CCCCCC"> don't know mine</font>

292
00:10:17,140 --> 00:10:20,800
cast is like a male security<font color="#E5E5E5"> Gary and</font>

293
00:10:19,270 --> 00:10:22,240
that's actually<font color="#E5E5E5"> really quite good it's</font>

294
00:10:20,800 --> 00:10:24,130
got a<font color="#E5E5E5"> lot of protections in place and</font>

295
00:10:22,240 --> 00:10:25,540
but<font color="#E5E5E5"> one thing I've learned from doing</font>

296
00:10:24,130 --> 00:10:26,920
the red team and I've done is that mine

297
00:10:25,540 --> 00:10:29,319
cast unless they've<font color="#CCCCCC"> got the threat</font>

298
00:10:26,920 --> 00:10:31,540
portal which replaces all the links

299
00:10:29,320 --> 00:10:33,190
within the emails if you send an

300
00:10:31,540 --> 00:10:35,140
attachment so you know a document with a

301
00:10:33,190 --> 00:10:37,180
mac or something then<font color="#E5E5E5"> you probably not</font>

302
00:10:35,140 --> 00:10:38,920
<font color="#E5E5E5">likely to get in but if you send someone</font>

303
00:10:37,180 --> 00:10:40,660
maybe a link to an attachment which is

304
00:10:38,920 --> 00:10:42,670
<font color="#CCCCCC">hosted on an Internet then that's</font>

305
00:10:40,660 --> 00:10:44,319
probably the best<font color="#CCCCCC"> bet so just having</font>

306
00:10:42,670 --> 00:10:46,180
this kind of information just from<font color="#CCCCCC"> DNS</font>

307
00:10:44,320 --> 00:10:52,480
is really valuable before you attack

308
00:10:46,180 --> 00:10:54,459
your organization so if you doing sort

309
00:10:52,480 --> 00:10:56,440
<font color="#E5E5E5">of social</font><font color="#CCCCCC"> engineering or</font><font color="#E5E5E5"> spearfishing</font>

310
00:10:54,460 --> 00:10:58,300
campaigns against an organization you

311
00:10:56,440 --> 00:11:00,040
need to know the domain obviously that

312
00:10:58,300 --> 00:11:01,750
you're<font color="#E5E5E5"> targeting and the format but once</font>

313
00:11:00,040 --> 00:11:03,790
you've got that<font color="#E5E5E5"> information tools such</font>

314
00:11:01,750 --> 00:11:05,470
as<font color="#CCCCCC"> Prowler really quite good so</font><font color="#E5E5E5"> proud</font>

315
00:11:03,790 --> 00:11:06,640
your<font color="#E5E5E5"> search is LinkedIn for all the</font>

316
00:11:05,470 --> 00:11:08,110
people<font color="#CCCCCC"> that knows about against</font>

317
00:11:06,640 --> 00:11:10,090
organization and<font color="#E5E5E5"> it will come back and</font>

318
00:11:08,110 --> 00:11:11,800
<font color="#E5E5E5">give</font><font color="#CCCCCC"> you a nice formatted list of email</font>

319
00:11:10,090 --> 00:11:14,710
addresses to use for<font color="#E5E5E5"> your spear</font><font color="#CCCCCC"> phishing</font>

320
00:11:11,800 --> 00:11:16,180
campaign simply email the harvester

321
00:11:14,710 --> 00:11:17,980
multi go<font color="#E5E5E5"> these will do that sort of</font>

322
00:11:16,180 --> 00:11:20,319
thing but we found<font color="#E5E5E5"> that proud that's</font>

323
00:11:17,980 --> 00:11:21,850
probably the best best effort this also

324
00:11:20,320 --> 00:11:23,260
previous breaches because that can just

325
00:11:21,850 --> 00:11:24,930
<font color="#E5E5E5">give you a massive list of email</font>

326
00:11:23,260 --> 00:11:27,880
addresses to use and<font color="#CCCCCC"> not all of them are</font>

327
00:11:24,930 --> 00:11:31,989
still valid but you say two-thirds

328
00:11:27,880 --> 00:11:33,520
generally are so this<font color="#E5E5E5"> is an</font><font color="#CCCCCC"> example of</font>

329
00:11:31,990 --> 00:11:35,590
prowl it's actually<font color="#E5E5E5"> a guy from</font><font color="#CCCCCC"> neta to</font>

330
00:11:33,520 --> 00:11:36,970
do wrote this and<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> really good</font>

331
00:11:35,590 --> 00:11:38,920
basically just gives you the<font color="#CCCCCC"> guy's name</font>

332
00:11:36,970 --> 00:11:41,440
what their what their role is within<font color="#E5E5E5"> the</font>

333
00:11:38,920 --> 00:11:43,180
organization and even<font color="#CCCCCC"> now</font><font color="#E5E5E5"> maps against</font>

334
00:11:41,440 --> 00:11:44,650
have I been pwned so it will give you

335
00:11:43,180 --> 00:11:46,540
<font color="#CCCCCC">all the list</font><font color="#E5E5E5"> of email addresses for the</font>

336
00:11:44,650 --> 00:11:47,620
organization and they'll say oh this one

337
00:11:46,540 --> 00:11:49,000
this one this one's already been in the

338
00:11:47,620 --> 00:11:50,860
adobe breach so then you can

339
00:11:49,000 --> 00:11:52,630
cross-reference that and again<font color="#E5E5E5"> with</font>

340
00:11:50,860 --> 00:11:54,550
adobe breach you sometimes can get the

341
00:11:52,630 --> 00:11:56,350
password back the<font color="#E5E5E5"> password isn't in</font>

342
00:11:54,550 --> 00:11:58,120
there it is encrypted or encoded should

343
00:11:56,350 --> 00:12:02,440
<font color="#CCCCCC">i say but they have passwords that have</font>

344
00:11:58,120 --> 00:12:04,840
been<font color="#E5E5E5"> reversed and what i would say is</font>

345
00:12:02,440 --> 00:12:06,730
when you target an organization think

346
00:12:04,840 --> 00:12:08,860
about what your objective is of the of

347
00:12:06,730 --> 00:12:10,570
this whole test so are you going to go

348
00:12:08,860 --> 00:12:11,650
after<font color="#E5E5E5"> their core application server or</font>

349
00:12:10,570 --> 00:12:14,110
you're<font color="#E5E5E5"> going to go after their their</font>

350
00:12:11,650 --> 00:12:16,060
banking application and because<font color="#E5E5E5"> this</font>

351
00:12:14,110 --> 00:12:17,920
might basically save you a bit<font color="#E5E5E5"> of time</font>

352
00:12:16,060 --> 00:12:19,209
once you're in so if you know you're

353
00:12:17,920 --> 00:12:21,040
going after<font color="#E5E5E5"> that certain banking</font>

354
00:12:19,210 --> 00:12:22,570
application link to you might say these

355
00:12:21,040 --> 00:12:24,370
three guys here already work on the

356
00:12:22,570 --> 00:12:26,170
application so this<font color="#E5E5E5"> is a great</font><font color="#CCCCCC"> way of</font>

357
00:12:24,370 --> 00:12:27,670
basically finding out information out

358
00:12:26,170 --> 00:12:33,189
before you go in so you don't have<font color="#E5E5E5"> to do</font>

359
00:12:27,670 --> 00:12:34,540
much lateral movement once you're in so

360
00:12:33,190 --> 00:12:35,710
it's good to<font color="#E5E5E5"> know your terminology when</font>

361
00:12:34,540 --> 00:12:37,240
you're talking<font color="#E5E5E5"> to the client or just</font>

362
00:12:35,710 --> 00:12:38,440
generally because there's a bit of<font color="#E5E5E5"> a</font>

363
00:12:37,240 --> 00:12:41,350
difference between<font color="#E5E5E5"> spam phishing and</font>

364
00:12:38,440 --> 00:12:43,090
spoofing so spam is<font color="#CCCCCC"> unsolicited bulk</font>

365
00:12:41,350 --> 00:12:45,100
email or messages irrespective<font color="#E5E5E5"> of</font>

366
00:12:43,090 --> 00:12:46,900
content and usually<font color="#CCCCCC"> like bulk</font>

367
00:12:45,100 --> 00:12:48,580
advertising that sort of thing whereas

368
00:12:46,900 --> 00:12:50,410
fishing is a type of spam but it's

369
00:12:48,580 --> 00:12:52,000
purely intended to trick the user into

370
00:12:50,410 --> 00:12:54,040
entering credentials or sensitive

371
00:12:52,000 --> 00:12:56,620
information with the intent to commit

372
00:12:54,040 --> 00:12:59,199
fraud or identity theft where spoofing

373
00:12:56,620 --> 00:13:00,550
is the forgery of email headers<font color="#E5E5E5"> so the</font>

374
00:12:59,200 --> 00:13:07,270
message appears to come from someone

375
00:13:00,550 --> 00:13:09,310
else rather<font color="#E5E5E5"> than the actual source so</font>

376
00:13:07,270 --> 00:13:11,170
what I've<font color="#CCCCCC"> been doing recently again</font>

377
00:13:09,310 --> 00:13:13,150
<font color="#E5E5E5">people who haven't probably got things</font>

378
00:13:11,170 --> 00:13:15,550
like mine cast is I've had quite a<font color="#E5E5E5"> lot</font>

379
00:13:13,150 --> 00:13:16,780
<font color="#CCCCCC">of success with spoofing emails so not</font>

380
00:13:15,550 --> 00:13:18,160
necessarily spoofing it from like

381
00:13:16,780 --> 00:13:19,870
Microsoft or anywhere like that<font color="#E5E5E5"> because</font>

382
00:13:18,160 --> 00:13:20,589
<font color="#E5E5E5">that's where stuff like SPF comes in but</font>

383
00:13:19,870 --> 00:13:22,360
actually<font color="#E5E5E5"> spoofing it</font>

384
00:13:20,590 --> 00:13:24,670
from themselves so if you're targeting a

385
00:13:22,360 --> 00:13:26,800
<font color="#E5E5E5">bank on example bank calm actually</font>

386
00:13:24,670 --> 00:13:28,390
spoofing from them so using the whois

387
00:13:26,800 --> 00:13:30,579
records to find out who the network

388
00:13:28,390 --> 00:13:32,590
admin is and then spoofing from him to

389
00:13:30,580 --> 00:13:34,870
the rest of<font color="#E5E5E5"> the company and sometimes it</font>

390
00:13:32,590 --> 00:13:37,180
has got this is just allowed in because

391
00:13:34,870 --> 00:13:38,620
the way the mail gateway<font color="#E5E5E5"> set up so it's</font>

392
00:13:37,180 --> 00:13:40,180
worth testing this out before you even

393
00:13:38,620 --> 00:13:41,620
try sort of creating your own domains

394
00:13:40,180 --> 00:13:43,329
and things like that because<font color="#CCCCCC"> it'll have</font>

395
00:13:41,620 --> 00:13:44,890
a lot of success with it and also<font color="#E5E5E5"> one</font>

396
00:13:43,330 --> 00:13:47,440
<font color="#E5E5E5">thing to know about if you can do that</font>

397
00:13:44,890 --> 00:13:49,270
<font color="#E5E5E5">you're actually from a trusted domain so</font>

398
00:13:47,440 --> 00:13:50,620
anything<font color="#CCCCCC"> that you send like hyper links</font>

399
00:13:49,270 --> 00:13:52,930
or images<font color="#E5E5E5"> it'll automatically get</font>

400
00:13:50,620 --> 00:13:54,910
downloaded in outlook so it's definitely

401
00:13:52,930 --> 00:13:59,979
worth testing before you do the stuff of

402
00:13:54,910 --> 00:14:01,930
engagement so the current tooling out

403
00:13:59,980 --> 00:14:03,850
there that i found i use in red teaming

404
00:14:01,930 --> 00:14:05,260
that's why<font color="#E5E5E5"> obviously this is probably</font>

405
00:14:03,850 --> 00:14:07,600
<font color="#CCCCCC">the biggest</font><font color="#E5E5E5"> and best</font><font color="#CCCCCC"> open-source</font>

406
00:14:05,260 --> 00:14:10,510
penetration testing framework<font color="#CCCCCC"> i wouldn't</font>

407
00:14:07,600 --> 00:14:12,190
<font color="#E5E5E5">say it's specifically ideal for red</font>

408
00:14:10,510 --> 00:14:13,810
teaming because it's quite noisy and

409
00:14:12,190 --> 00:14:16,170
it's not very stealthy it's been

410
00:14:13,810 --> 00:14:19,239
signature<font color="#CCCCCC"> do i love</font><font color="#E5E5E5"> ids and IPS products</font>

411
00:14:16,170 --> 00:14:21,520
the reverse HCBS has come on a long way

412
00:14:19,240 --> 00:14:23,110
it's now got some set timeouts and sleep

413
00:14:21,520 --> 00:14:25,090
options so you can almost use it as a

414
00:14:23,110 --> 00:14:27,280
beacon but<font color="#E5E5E5"> i still wouldn't say it's you</font>

415
00:14:25,090 --> 00:14:29,920
know<font color="#E5E5E5"> full-on</font><font color="#CCCCCC"> end-to-end</font><font color="#E5E5E5"> a very good red</font>

416
00:14:27,280 --> 00:14:32,140
teaming tool it's got some great socks

417
00:14:29,920 --> 00:14:33,969
proxy and capabilities so that's 10 to

418
00:14:32,140 --> 00:14:35,500
what i use<font color="#CCCCCC"> metasploit for so not</font>

419
00:14:33,970 --> 00:14:37,060
necessarily use it to get in or get the

420
00:14:35,500 --> 00:14:38,710
initial foothold but if<font color="#E5E5E5"> i want to sort</font>

421
00:14:37,060 --> 00:14:40,420
of use it for IDP and socks lateral

422
00:14:38,710 --> 00:14:43,360
movement that's what I use it for now

423
00:14:40,420 --> 00:14:45,310
i'll show you a<font color="#E5E5E5"> bit of this layer</font><font color="#CCCCCC"> Empire</font>

424
00:14:43,360 --> 00:14:46,780
so that's it's been quite bigger to beam

425
00:14:45,310 --> 00:14:48,520
out just over a year now think it's a

426
00:14:46,780 --> 00:14:49,720
really neat product<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I have had some</font>

427
00:14:48,520 --> 00:14:51,250
issues with it so I've tested it in

428
00:14:49,720 --> 00:14:52,570
quite a lot<font color="#CCCCCC"> of environments and there's</font>

429
00:14:51,250 --> 00:14:55,750
been a few issues where it<font color="#E5E5E5"> wouldn't go</font>

430
00:14:52,570 --> 00:14:57,850
through proxies so most of<font color="#E5E5E5"> the people I</font>

431
00:14:55,750 --> 00:14:59,290
tests are quite high profile clients so

432
00:14:57,850 --> 00:15:00,970
they generally have quite a good secure

433
00:14:59,290 --> 00:15:03,370
configuration and everything's proxied

434
00:15:00,970 --> 00:15:06,040
and<font color="#E5E5E5"> it's failed a couple of times so</font>

435
00:15:03,370 --> 00:15:07,330
I've<font color="#E5E5E5"> been a bit no bit worried about</font>

436
00:15:06,040 --> 00:15:09,130
using it you got to have confidence in

437
00:15:07,330 --> 00:15:11,530
your tools so that I sort of relate back

438
00:15:09,130 --> 00:15:13,060
to revert back to<font color="#CCCCCC"> metasploit but again</font>

439
00:15:11,530 --> 00:15:15,640
<font color="#CCCCCC">then you know</font><font color="#E5E5E5"> you're at risk of being</font>

440
00:15:13,060 --> 00:15:17,770
caught because it's quite noisy cobalt

441
00:15:15,640 --> 00:15:19,810
strike that's<font color="#E5E5E5"> a very solid and red</font>

442
00:15:17,770 --> 00:15:21,579
teaming tool that's really good it's

443
00:15:19,810 --> 00:15:24,130
quite expensive if red teaming is not

444
00:15:21,580 --> 00:15:25,930
your core sort of function within<font color="#E5E5E5"> the</font>

445
00:15:24,130 --> 00:15:27,220
organization then getting the buy-in to

446
00:15:25,930 --> 00:15:30,160
have that per license is probably quite

447
00:15:27,220 --> 00:15:31,780
expensive and<font color="#CCCCCC"> there's paschi to which</font>

448
00:15:30,160 --> 00:15:33,310
<font color="#CCCCCC">i'll come on</font><font color="#E5E5E5"> to a bit</font><font color="#CCCCCC"> later but this</font><font color="#E5E5E5"> is</font>

449
00:15:31,780 --> 00:15:34,120
a free tool that we've been<font color="#E5E5E5"> we've</font>

450
00:15:33,310 --> 00:15:35,650
written

451
00:15:34,120 --> 00:15:37,089
help with this kind of thing everything

452
00:15:35,650 --> 00:15:40,959
<font color="#E5E5E5">that I've talked about in here</font><font color="#CCCCCC"> is been</font>

453
00:15:37,089 --> 00:15:42,040
simplified to be used in that when

454
00:15:40,960 --> 00:15:43,540
you're doing this engagement you got a

455
00:15:42,040 --> 00:15:44,529
note as well that when you're doing sort

456
00:15:43,540 --> 00:15:46,029
<font color="#E5E5E5">of social engineering that swept</font><font color="#CCCCCC"> and</font>

457
00:15:44,529 --> 00:15:47,470
spearfishing you really<font color="#E5E5E5"> only going to</font>

458
00:15:46,029 --> 00:15:50,050
get one shot so you've got<font color="#E5E5E5"> to be really</font>

459
00:15:47,470 --> 00:15:54,430
really<font color="#E5E5E5"> reliable use a really reliable</font>

460
00:15:50,050 --> 00:15:55,750
tool that you know is going<font color="#E5E5E5"> to get in so</font>

461
00:15:54,430 --> 00:15:57,670
I've been doing<font color="#CCCCCC"> this then probably about</font>

462
00:15:55,750 --> 00:15:58,870
18 months now and I've had a pretty much

463
00:15:57,670 --> 00:16:00,670
one hundred percent success rate so

464
00:15:58,870 --> 00:16:02,890
every every job<font color="#E5E5E5"> I've done waved and red</font>

465
00:16:00,670 --> 00:16:05,709
teaming we've kind of got in one way or

466
00:16:02,890 --> 00:16:07,600
another I think<font color="#CCCCCC"> the success factors for</font>

467
00:16:05,710 --> 00:16:09,670
us are basically just testing the tools

468
00:16:07,600 --> 00:16:12,900
<font color="#E5E5E5">that we're using using proxy aware</font>

469
00:16:09,670 --> 00:16:15,670
payloads and basically if you aim to

470
00:16:12,900 --> 00:16:17,560
infiltrate the most secure environment

471
00:16:15,670 --> 00:16:19,870
then if it's if it's less secure than

472
00:16:17,560 --> 00:16:21,939
you it's a winner so always<font color="#E5E5E5"> aim for the</font>

473
00:16:19,870 --> 00:16:23,920
most secure don't go<font color="#E5E5E5"> out and ports like</font>

474
00:16:21,940 --> 00:16:25,570
80 80 because they're not by default

475
00:16:23,920 --> 00:16:27,910
allowed out on proxy so always ground

476
00:16:25,570 --> 00:16:31,540
<font color="#CCCCCC">port 80 or 443 make sure you</font><font color="#E5E5E5"> traffic to</font>

477
00:16:27,910 --> 00:16:32,949
encrypted that sort of thing one of the

478
00:16:31,540 --> 00:16:35,650
ways we've still been getting in with

479
00:16:32,950 --> 00:16:37,270
vba macros so it's amazing<font color="#CCCCCC"> vb imac</font><font color="#E5E5E5"> has</font>

480
00:16:35,650 --> 00:16:38,620
been<font color="#E5E5E5"> around a long time and people been</font>

481
00:16:37,270 --> 00:16:40,900
using this for social engineering

482
00:16:38,620 --> 00:16:43,750
spearfishing for ages<font color="#CCCCCC"> but it's amazing</font>

483
00:16:40,900 --> 00:16:46,000
<font color="#E5E5E5">how often people still require vba so</font>

484
00:16:43,750 --> 00:16:48,040
they won't disable it it's<font color="#E5E5E5"> really easy</font>

485
00:16:46,000 --> 00:16:50,080
to implement trusted locations with

486
00:16:48,040 --> 00:16:52,959
macros with group policy that people

487
00:16:50,080 --> 00:16:55,750
still don't tend to do it so sending a

488
00:16:52,959 --> 00:16:58,779
macro has probably been well<font color="#E5E5E5"> the most</font>

489
00:16:55,750 --> 00:17:00,490
used<font color="#E5E5E5"> I would have used also documents</font>

490
00:16:58,779 --> 00:17:02,290
with<font color="#CCCCCC"> ola objects in so you can even add</font>

491
00:17:00,490 --> 00:17:06,609
executables and things like that in word

492
00:17:02,290 --> 00:17:08,230
on office java jar files<font color="#E5E5E5"> i tend to use</font>

493
00:17:06,609 --> 00:17:10,208
<font color="#CCCCCC">these quite a lot as well but</font><font color="#E5E5E5"> i would</font>

494
00:17:08,230 --> 00:17:12,010
<font color="#CCCCCC">always</font><font color="#E5E5E5"> sign them unsigned java files</font>

495
00:17:10,209 --> 00:17:14,890
it's pretty much a no-go because by

496
00:17:12,010 --> 00:17:16,809
default on<font color="#E5E5E5"> Java</font><font color="#CCCCCC"> hi only allows signed</font>

497
00:17:14,890 --> 00:17:19,630
applets so it's fairly easy I'll stay

498
00:17:16,809 --> 00:17:21,010
fairly easy you can get assigned sign co

499
00:17:19,630 --> 00:17:24,429
signing certificate but<font color="#E5E5E5"> I'll talk</font><font color="#CCCCCC"> about</font>

500
00:17:21,010 --> 00:17:26,949
that a bit later hypertext and HTML

501
00:17:24,429 --> 00:17:28,920
applications again<font color="#E5E5E5"> these are quite</font><font color="#CCCCCC"> good</font>

502
00:17:26,949 --> 00:17:31,030
for getting inside an organization

503
00:17:28,920 --> 00:17:32,920
<font color="#E5E5E5">however i wouldn't be you know most</font>

504
00:17:31,030 --> 00:17:34,570
outlook will block these because i'll

505
00:17:32,920 --> 00:17:36,280
see it isn't executable but if you host

506
00:17:34,570 --> 00:17:38,110
it and then send the link to<font color="#E5E5E5"> it these</font>

507
00:17:36,280 --> 00:17:41,230
are ways that you bypass these sort of

508
00:17:38,110 --> 00:17:42,909
filters quite a<font color="#E5E5E5"> few recent ones a zip</font>

509
00:17:41,230 --> 00:17:44,890
file so in a zip file you can<font color="#E5E5E5"> actually</font>

510
00:17:42,910 --> 00:17:46,780
have an<font color="#E5E5E5"> lnk file which links off to</font>

511
00:17:44,890 --> 00:17:47,830
something<font color="#E5E5E5"> like powershell when they just</font>

512
00:17:46,780 --> 00:17:49,389
double click the link file

513
00:17:47,830 --> 00:17:52,178
in the short cut it just<font color="#E5E5E5"> runs PowerShell</font>

514
00:17:49,390 --> 00:17:53,919
so that's another good way and click

515
00:17:52,179 --> 00:17:55,750
once so this is really quite powerful as

516
00:17:53,919 --> 00:17:57,460
well so integrating PowerShell or

517
00:17:55,750 --> 00:17:59,970
standalone executable into a click once

518
00:17:57,460 --> 00:18:02,230
application so send<font color="#E5E5E5"> them a link sort of</font>

519
00:17:59,970 --> 00:18:03,760
saying<font color="#E5E5E5"> I'll come visit</font><font color="#CCCCCC"> this site you get</font>

520
00:18:02,230 --> 00:18:05,440
ten percent discount and when they click

521
00:18:03,760 --> 00:18:07,179
ok then it pops up like<font color="#CCCCCC"> a click once</font>

522
00:18:05,440 --> 00:18:08,350
which is all signed and they all feel

523
00:18:07,179 --> 00:18:09,880
quite fuzzy because it's got<font color="#E5E5E5"> a nice</font>

524
00:18:08,350 --> 00:18:13,269
little padlock and then they end up

525
00:18:09,880 --> 00:18:14,500
licking site cloning again if you<font color="#E5E5E5"> just</font>

526
00:18:13,269 --> 00:18:15,549
that after sort of credentials because

527
00:18:14,500 --> 00:18:17,409
they've got a lot of single factor

528
00:18:15,549 --> 00:18:19,720
systems on the<font color="#CCCCCC"> internet then</font><font color="#E5E5E5"> select site</font>

529
00:18:17,409 --> 00:18:22,210
cloning might be the way to go I've had

530
00:18:19,720 --> 00:18:23,679
<font color="#E5E5E5">a lot of success with just pure brute</font>

531
00:18:22,210 --> 00:18:25,659
force single factor systems on the

532
00:18:23,679 --> 00:18:26,710
<font color="#CCCCCC">Internet so using stuff like the adobe</font>

533
00:18:25,659 --> 00:18:28,659
breach to get the list<font color="#E5E5E5"> of email</font>

534
00:18:26,710 --> 00:18:31,179
addresses and then train maybe password

535
00:18:28,659 --> 00:18:33,429
one<font color="#E5E5E5"> january 16 these stubby things</font>

536
00:18:31,179 --> 00:18:34,870
against it only probably once or twice

537
00:18:33,429 --> 00:18:37,149
because the lockouts were they going to

538
00:18:34,870 --> 00:18:39,428
be<font color="#E5E5E5"> three but we've had a laugh success</font><font color="#CCCCCC"> i</font>

539
00:18:37,149 --> 00:18:44,799
had<font color="#E5E5E5"> one recently which was against</font>

540
00:18:39,429 --> 00:18:46,840
citrix so six users on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> internet</font><font color="#CCCCCC"> i</font>

541
00:18:44,799 --> 00:18:48,070
<font color="#CCCCCC">looked at it and</font><font color="#E5E5E5"> it basically</font><font color="#CCCCCC"> said it</font>

542
00:18:46,840 --> 00:18:49,539
was two factor authentication<font color="#CCCCCC"> before</font>

543
00:18:48,070 --> 00:18:50,830
i'll probably not even which point

544
00:18:49,539 --> 00:18:52,600
trying to brute forces before what the

545
00:18:50,830 --> 00:18:54,879
<font color="#E5E5E5">hell I've got a list I've got a password</font>

546
00:18:52,600 --> 00:18:57,279
I'll give it a<font color="#CCCCCC"> go so I brute force to</font>

547
00:18:54,880 --> 00:18:58,690
about 150 users with i think<font color="#E5E5E5"> it was</font>

548
00:18:57,279 --> 00:19:01,419
welcome one or something<font color="#E5E5E5"> like that and</font>

549
00:18:58,690 --> 00:19:02,830
basically<font color="#E5E5E5"> i was able to get in on the</font>

550
00:19:01,419 --> 00:19:04,450
internet even<font color="#E5E5E5"> though it said it was two</font>

551
00:19:02,830 --> 00:19:06,129
factor so even though it<font color="#CCCCCC"> says it to</font>

552
00:19:04,450 --> 00:19:07,269
factor you still have to put each person

553
00:19:06,130 --> 00:19:09,250
in the group<font color="#CCCCCC"> two factor authentication</font>

554
00:19:07,269 --> 00:19:10,960
so you might find you might find one

555
00:19:09,250 --> 00:19:13,929
<font color="#CCCCCC">that isn't so it's</font><font color="#E5E5E5"> always worth a go</font>

556
00:19:10,960 --> 00:19:15,549
this person<font color="#CCCCCC"> luckily for me had access to</font>

557
00:19:13,929 --> 00:19:16,870
some pretty sensitive information there

558
00:19:15,549 --> 00:19:18,908
was a nice folder called credit card

559
00:19:16,870 --> 00:19:23,289
shared data it was like oh that looks

560
00:19:18,909 --> 00:19:25,659
juicy 25,000 clear text pan numbers

561
00:19:23,289 --> 00:19:28,720
which was quite nice hanging on the

562
00:19:25,659 --> 00:19:30,279
<font color="#E5E5E5">internet of a</font><font color="#CCCCCC"> citrix</font><font color="#E5E5E5"> server not sure how</font>

563
00:19:28,720 --> 00:19:33,880
they<font color="#E5E5E5"> got away</font><font color="#CCCCCC"> with it in the terms of</font>

564
00:19:30,279 --> 00:19:35,470
<font color="#CCCCCC">PCI but there we go so just trying</font>

565
00:19:33,880 --> 00:19:37,750
things like a<font color="#CCCCCC"> brute-force attempt</font>

566
00:19:35,470 --> 00:19:39,159
against systems that should be single or

567
00:19:37,750 --> 00:19:41,110
shouldn't be<font color="#E5E5E5"> single factor is always</font>

568
00:19:39,159 --> 00:19:43,149
always worth a go but<font color="#E5E5E5"> again be quite</font>

569
00:19:41,110 --> 00:19:44,350
careful don't lock out things make<font color="#CCCCCC"> sure</font>

570
00:19:43,149 --> 00:19:46,029
any try one attempt and be quite

571
00:19:44,350 --> 00:19:50,049
stealthy if you are trying<font color="#E5E5E5"> to be</font>

572
00:19:46,029 --> 00:19:51,850
stealthy one of the most important

573
00:19:50,049 --> 00:19:54,070
things is increasing the trustworthiness

574
00:19:51,850 --> 00:19:56,469
of your links of your spear phishing

575
00:19:54,070 --> 00:19:58,178
campaigns and in the ways you can do

576
00:19:56,470 --> 00:19:59,620
<font color="#CCCCCC">that is buying stuff like code signing</font>

577
00:19:58,179 --> 00:20:01,210
searchers have talked<font color="#E5E5E5"> about so when</font>

578
00:19:59,620 --> 00:20:04,389
you're sending in a job of payload or

579
00:20:01,210 --> 00:20:06,760
code signing sir sorry or a click once

580
00:20:04,390 --> 00:20:07,929
application if it's signed again you get

581
00:20:06,760 --> 00:20:10,570
the nice green padlock and everyone

582
00:20:07,929 --> 00:20:12,370
<font color="#E5E5E5">feels warm and fuzzy also if you're sort</font>

583
00:20:10,570 --> 00:20:13,600
of sending in CVS things like that where

584
00:20:12,370 --> 00:20:14,770
you need telephone number<font color="#CCCCCC"> won't you to</font>

585
00:20:13,600 --> 00:20:16,629
purchase and burner phones from

586
00:20:14,770 --> 00:20:18,190
somewhere so you can<font color="#E5E5E5"> actually legitimize</font>

587
00:20:16,630 --> 00:20:19,600
it a bit more<font color="#E5E5E5"> and put your telephone and</font>

588
00:20:18,190 --> 00:20:22,559
mobile<font color="#CCCCCC"> number so they think</font><font color="#E5E5E5"> oh there's a</font>

589
00:20:19,600 --> 00:20:24,668
mobile number that must be must<font color="#E5E5E5"> be safe</font>

590
00:20:22,559 --> 00:20:25,870
registering a new company so we<font color="#E5E5E5"> often</font>

591
00:20:24,669 --> 00:20:27,070
register quite a lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> different new</font>

592
00:20:25,870 --> 00:20:29,049
companies when we attack in an

593
00:20:27,070 --> 00:20:31,629
organization<font color="#CCCCCC"> even sometimes if it's like</font>

594
00:20:29,049 --> 00:20:33,158
example<font color="#E5E5E5"> bank will by example bank group</font>

595
00:20:31,630 --> 00:20:34,750
or something<font color="#CCCCCC"> like that these type of</font>

596
00:20:33,159 --> 00:20:36,600
things people just see the bank in the

597
00:20:34,750 --> 00:20:39,159
title and go oh<font color="#E5E5E5"> yeah that must be safe</font>

598
00:20:36,600 --> 00:20:40,809
let's encrypt which is free so if you're

599
00:20:39,159 --> 00:20:42,640
making any websites when you excite

600
00:20:40,809 --> 00:20:45,370
cloning that's all free to you can get

601
00:20:42,640 --> 00:20:48,760
free<font color="#CCCCCC"> cells to pick 30 date so 90 days I</font>

602
00:20:45,370 --> 00:20:52,779
<font color="#CCCCCC">think and also then yeah try using very</font>

603
00:20:48,760 --> 00:20:56,169
similar domains this is it before<font color="#E5E5E5"> and</font>

604
00:20:52,779 --> 00:20:58,390
the default on<font color="#CCCCCC"> Java is high so if you</font>

605
00:20:56,169 --> 00:21:00,279
are using Java make sure you sign a code

606
00:20:58,390 --> 00:21:03,480
signing sir like here so it pops up and

607
00:21:00,279 --> 00:21:03,480
doesn't show any red errors and stuff

608
00:21:03,929 --> 00:21:08,470
another one which is<font color="#E5E5E5"> quite interesting</font>

609
00:21:06,399 --> 00:21:11,439
<font color="#E5E5E5">recently a site email reputation so</font>

610
00:21:08,470 --> 00:21:13,299
again i'm attacking quite high profile

611
00:21:11,440 --> 00:21:15,970
clients so they have quite good web

612
00:21:13,299 --> 00:21:17,379
proxy gateway filters and which probably

613
00:21:15,970 --> 00:21:19,240
have quite a lot<font color="#CCCCCC"> of threat feeds which</font>

614
00:21:17,380 --> 00:21:20,500
come from like known sources and they

615
00:21:19,240 --> 00:21:22,720
say these<font color="#E5E5E5"> are good these are bad they</font>

616
00:21:20,500 --> 00:21:25,480
<font color="#E5E5E5">block unwanted categories like hacking</font>

617
00:21:22,720 --> 00:21:27,159
things like that gmail<font color="#CCCCCC"> webmail that sort</font>

618
00:21:25,480 --> 00:21:29,320
of thing so when we're creating these

619
00:21:27,159 --> 00:21:31,630
sites on the<font color="#E5E5E5"> flying maybe like a week</font>

620
00:21:29,320 --> 00:21:33,250
before these aren't<font color="#E5E5E5"> gonna work so what</font>

621
00:21:31,630 --> 00:21:35,440
we've been having to do now<font color="#CCCCCC"> is actually</font>

622
00:21:33,250 --> 00:21:37,480
create sites you know six months 12

623
00:21:35,440 --> 00:21:38,919
months in advance of doing a test so

624
00:21:37,480 --> 00:21:41,200
<font color="#CCCCCC">that we can build it from reputation</font>

625
00:21:38,919 --> 00:21:42,940
just even<font color="#CCCCCC"> just like basic ecommerce</font>

626
00:21:41,200 --> 00:21:45,159
sites that just sell other no random

627
00:21:42,940 --> 00:21:47,049
books or something<font color="#E5E5E5"> so at least they get</font>

628
00:21:45,159 --> 00:21:48,279
<font color="#E5E5E5">a decent category and they're sort of</font>

629
00:21:47,049 --> 00:21:51,010
committed through websites and things

630
00:21:48,279 --> 00:21:53,049
like that<font color="#CCCCCC"> I've never used direct IP</font>

631
00:21:51,010 --> 00:21:54,460
addresses for CT traffic because that

632
00:21:53,049 --> 00:21:56,408
instantly will just come up as a big red

633
00:21:54,460 --> 00:22:01,210
herring with in any sort of filtering

634
00:21:56,409 --> 00:22:03,039
system also in the early days we try to

635
00:22:01,210 --> 00:22:05,140
use dynamic dns and again this is quite

636
00:22:03,039 --> 00:22:08,649
a no-no and<font color="#E5E5E5"> this is quite easily blocked</font>

637
00:22:05,140 --> 00:22:10,870
or disabled on sort<font color="#E5E5E5"> of websites and</font>

638
00:22:08,649 --> 00:22:13,260
things like that<font color="#E5E5E5"> so</font><font color="#CCCCCC"> i'd stick stickly</font>

639
00:22:10,870 --> 00:22:13,260
<font color="#CCCCCC">with that</font>

640
00:22:13,590 --> 00:22:19,510
so<font color="#CCCCCC"> cyclo cyclone and we often target a</font>

641
00:22:16,960 --> 00:22:22,720
group or users via site cloning just

642
00:22:19,510 --> 00:22:25,210
forget initials even if they use<font color="#E5E5E5"> into FA</font>

643
00:22:22,720 --> 00:22:27,610
you can sometimes basically add the step

644
00:22:25,210 --> 00:22:29,049
within the cyclone so this<font color="#CCCCCC"> is this is us</font>

645
00:22:27,610 --> 00:22:31,389
we've create a cyclone<font color="#CCCCCC"> of their citrix</font>

646
00:22:29,049 --> 00:22:33,940
system which did have to if a wide in

647
00:22:31,390 --> 00:22:35,500
the previous one but it is meant to so

648
00:22:33,940 --> 00:22:37,690
to do it legitimately we create another

649
00:22:35,500 --> 00:22:39,250
<font color="#E5E5E5">one we cite cloned and sent a link</font>

650
00:22:37,690 --> 00:22:41,140
saying oh we<font color="#E5E5E5"> just upgraded the citrix</font>

651
00:22:39,250 --> 00:22:44,260
server can everyone try and<font color="#E5E5E5"> log in and</font>

652
00:22:41,140 --> 00:22:46,360
with some nice jquery which i'm<font color="#CCCCCC"> not very</font>

653
00:22:44,260 --> 00:22:49,480
good at<font color="#E5E5E5"> but i got</font><font color="#CCCCCC"> to help me basically</font>

654
00:22:46,360 --> 00:22:51,610
you can offload the weary sends back to

655
00:22:49,480 --> 00:22:53,770
like at your own web server log so<font color="#CCCCCC"> it'll</font>

656
00:22:51,610 --> 00:22:56,320
actually pass to me creds the username

657
00:22:53,770 --> 00:22:58,840
<font color="#E5E5E5">the password and the pin at that point</font>

658
00:22:56,320 --> 00:23:00,580
you probably got about 60 seconds<font color="#E5E5E5"> to use</font>

659
00:22:58,840 --> 00:23:02,529
them credentials legitimately<font color="#CCCCCC"> on their</font>

660
00:23:00,580 --> 00:23:03,939
website and then if especially if you

661
00:23:02,529 --> 00:23:06,010
create a nice link so when they press a

662
00:23:03,940 --> 00:23:07,390
log on it does actually bypass them back

663
00:23:06,010 --> 00:23:09,460
to the fair<font color="#CCCCCC"> log on attempt of the</font>

664
00:23:07,390 --> 00:23:10,870
<font color="#E5E5E5">legitimate site so then they log in a</font>

665
00:23:09,460 --> 00:23:12,490
second<font color="#E5E5E5"> time and by that point you've</font>

666
00:23:10,870 --> 00:23:14,649
already logged in and then they log in

667
00:23:12,490 --> 00:23:16,510
and they<font color="#CCCCCC"> think nothing's wrong so this</font>

668
00:23:14,649 --> 00:23:20,080
<font color="#CCCCCC">is just another good way of</font><font color="#E5E5E5"> doing psych</font>

669
00:23:16,510 --> 00:23:22,149
cloning without raising suspicion and

670
00:23:20,080 --> 00:23:24,639
once you're on inside a Citrix

671
00:23:22,149 --> 00:23:26,320
environment is pretty perfect from a red

672
00:23:24,640 --> 00:23:27,789
team perspective because<font color="#E5E5E5"> I think</font>

673
00:23:26,320 --> 00:23:29,678
ninety-nine percent of all<font color="#E5E5E5"> Citrix</font>

674
00:23:27,789 --> 00:23:30,908
environments you can break out<font color="#CCCCCC"> up to</font>

675
00:23:29,679 --> 00:23:33,039
some sort<font color="#CCCCCC"> of</font><font color="#E5E5E5"> power shell or command</font>

676
00:23:30,909 --> 00:23:35,740
<font color="#E5E5E5">prompt so</font><font color="#CCCCCC"> I think I'll show you that a</font>

677
00:23:33,039 --> 00:23:39,419
bit later so it's a really good<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> to</font>

678
00:23:35,740 --> 00:23:39,419
<font color="#E5E5E5">get onto from a red teaming perspective</font>

679
00:23:40,500 --> 00:23:44,140
so when doing this type of engagement

680
00:23:42,610 --> 00:23:46,059
and we provide the climate some

681
00:23:44,140 --> 00:23:47,409
analytical data so a lot of management

682
00:23:46,059 --> 00:23:49,510
like graphs as you probably all know

683
00:23:47,409 --> 00:23:52,210
it's kind of management porn in their

684
00:23:49,510 --> 00:23:54,240
eyes and<font color="#CCCCCC"> I like to add the three so to</font>

685
00:23:52,210 --> 00:23:57,669
get this information I had three stages

686
00:23:54,240 --> 00:23:59,529
in my sort<font color="#E5E5E5"> of spearfishing campaign so</font>

687
00:23:57,669 --> 00:24:01,210
inside the email<font color="#CCCCCC"> life's end I'll add a</font>

688
00:23:59,529 --> 00:24:04,059
web book and the web book will have

689
00:24:01,210 --> 00:24:06,610
something<font color="#E5E5E5"> like 1.png so when I've sent</font>

690
00:24:04,059 --> 00:24:08,889
my my links so I when I've sent my first

691
00:24:06,610 --> 00:24:10,990
phase in it all if they download the

692
00:24:08,890 --> 00:24:13,090
image<font color="#E5E5E5"> I'll get a log with a unique</font>

693
00:24:10,990 --> 00:24:15,340
reference on my apache web server and I

694
00:24:13,090 --> 00:24:16,750
know that person's downloaded it so at

695
00:24:15,340 --> 00:24:18,459
that point everyone's got a unique

696
00:24:16,750 --> 00:24:20,320
reference so if i<font color="#CCCCCC"> send 10 emails in and</font>

697
00:24:18,460 --> 00:24:22,029
i get 10 unique references hit my web

698
00:24:20,320 --> 00:24:25,450
server<font color="#E5E5E5"> i know that every one of them as</font>

699
00:24:22,029 --> 00:24:26,800
at<font color="#CCCCCC"> least open that and then if I've sent</font>

700
00:24:25,450 --> 00:24:28,960
a sort of a<font color="#E5E5E5"> doc you</font>

701
00:24:26,800 --> 00:24:30,370
or something<font color="#E5E5E5"> like that in with it i will</font>

702
00:24:28,960 --> 00:24:32,440
add something like<font color="#CCCCCC"> two dot PNG when they</font>

703
00:24:30,370 --> 00:24:34,090
open the document so at that point then

704
00:24:32,440 --> 00:24:35,620
I'll know that<font color="#E5E5E5"> they've won they've</font>

705
00:24:34,090 --> 00:24:39,280
opened my email to their open the

706
00:24:35,620 --> 00:24:42,129
attachment and then three if my exploits

707
00:24:39,280 --> 00:24:43,810
been successful I love to get shell so

708
00:24:42,130 --> 00:24:46,570
then I can<font color="#E5E5E5"> then give a nice graph to say</font>

709
00:24:43,810 --> 00:24:48,580
how many emails were sent how many

710
00:24:46,570 --> 00:24:50,139
emails were opened how many documents

711
00:24:48,580 --> 00:24:52,060
were opened and how many hosts are

712
00:24:50,140 --> 00:24:53,980
compromised so this just a really nice

713
00:24:52,060 --> 00:25:00,280
graph to send back<font color="#CCCCCC"> to the client at the</font>

714
00:24:53,980 --> 00:25:01,930
end of<font color="#E5E5E5"> the engagement so</font><font color="#CCCCCC"> their UNC paths</font>

715
00:25:00,280 --> 00:25:03,430
that any lines had quite a talk on it

716
00:25:01,930 --> 00:25:05,650
and it still kinda<font color="#E5E5E5"> thinking sooner the</font>

717
00:25:03,430 --> 00:25:07,480
talk soon as well but UNC paths are

718
00:25:05,650 --> 00:25:09,880
really quite interesting<font color="#E5E5E5"> it's been</font>

719
00:25:07,480 --> 00:25:11,320
around for donkey's years but no one's

720
00:25:09,880 --> 00:25:14,230
really used it in the social engineering

721
00:25:11,320 --> 00:25:16,540
capacity so we found so you can you can

722
00:25:14,230 --> 00:25:19,300
embed basically HTML obviously within an

723
00:25:16,540 --> 00:25:21,610
email and<font color="#E5E5E5"> you can send it and if you</font>

724
00:25:19,300 --> 00:25:23,850
send an image source for example with a

725
00:25:21,610 --> 00:25:26,199
UNC path and if someone opens that

726
00:25:23,850 --> 00:25:28,060
inside a normal organization with tight

727
00:25:26,200 --> 00:25:29,200
egress filtering controls<font color="#E5E5E5"> this isn't</font>

728
00:25:28,060 --> 00:25:31,659
going<font color="#E5E5E5"> to do anything so it will</font><font color="#CCCCCC"> just</font>

729
00:25:29,200 --> 00:25:33,160
<font color="#E5E5E5">open the image will fail to load but</font>

730
00:25:31,660 --> 00:25:35,500
what<font color="#E5E5E5"> happens if you're targeting people</font>

731
00:25:33,160 --> 00:25:38,380
working from home you've got crappy sort

732
00:25:35,500 --> 00:25:40,300
of speedtouch<font color="#E5E5E5"> Reuters or sort of BT Home</font>

733
00:25:38,380 --> 00:25:42,190
Hub without any firewall this will just

734
00:25:40,300 --> 00:25:44,409
<font color="#E5E5E5">basically seamlessly go straight out if</font>

735
00:25:42,190 --> 00:25:45,580
they haven't got any no split VPNs so

736
00:25:44,410 --> 00:25:46,870
although you think you're targeting a

737
00:25:45,580 --> 00:25:48,669
really high profile client that

738
00:25:46,870 --> 00:25:50,590
definitely wouldn't work on it's worth

739
00:25:48,670 --> 00:25:52,150
<font color="#E5E5E5">trying it for them remote workers that</font>

740
00:25:50,590 --> 00:25:55,629
might not have connected<font color="#CCCCCC"> to a no split</font>

741
00:25:52,150 --> 00:25:57,100
VPN wrote a blog on it as well and why

742
00:25:55,630 --> 00:26:00,070
it's quite bad so I won't<font color="#E5E5E5"> go over it too</font>

743
00:25:57,100 --> 00:26:01,600
much but you can you don't have to embed

744
00:26:00,070 --> 00:26:03,250
it in the email itself you can also

745
00:26:01,600 --> 00:26:05,620
embed it in the document<font color="#E5E5E5"> you can either</font>

746
00:26:03,250 --> 00:26:07,750
do<font color="#E5E5E5"> this manually again</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> I'd go on</font>

747
00:26:05,620 --> 00:26:09,429
to this a bit on the blog and but or you

748
00:26:07,750 --> 00:26:10,570
can just use<font color="#E5E5E5"> the max fleet module and it</font>

749
00:26:09,430 --> 00:26:13,390
will actually end that<font color="#CCCCCC"> are you in</font><font color="#E5E5E5"> see</font>

750
00:26:10,570 --> 00:26:15,429
within within the document I haven't

751
00:26:13,390 --> 00:26:16,810
<font color="#E5E5E5">really told you what UNC does sorry so</font>

752
00:26:15,430 --> 00:26:19,480
for those you don't<font color="#CCCCCC"> know if you want</font>

753
00:26:16,810 --> 00:26:21,730
someone opens on<font color="#CCCCCC"> Windows this with a UNC</font>

754
00:26:19,480 --> 00:26:24,070
path it will try<font color="#E5E5E5"> north in</font><font color="#CCCCCC"> Takei to</font><font color="#E5E5E5"> that</font>

755
00:26:21,730 --> 00:26:25,930
end point and if port 445 zile out band

756
00:26:24,070 --> 00:26:28,060
you'll get the challenge response hash

757
00:26:25,930 --> 00:26:30,040
of that users of that user's password

758
00:26:28,060 --> 00:26:31,780
and then obviously<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then you can try</font>

759
00:26:30,040 --> 00:26:33,610
and basically attempt to offline brute

760
00:26:31,780 --> 00:26:35,680
force that try and<font color="#E5E5E5"> get the password and</font>

761
00:26:33,610 --> 00:26:38,229
then in combination with say for example

762
00:26:35,680 --> 00:26:40,210
single factor systems you might be able

763
00:26:38,230 --> 00:26:40,690
to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> to get into owa</font><font color="#CCCCCC"> anything's</font>

764
00:26:40,210 --> 00:26:42,610
all that

765
00:26:40,690 --> 00:26:43,870
oh do we were a has got a vast amount of

766
00:26:42,610 --> 00:26:45,370
information usually and people<font color="#E5E5E5"> just</font>

767
00:26:43,870 --> 00:26:47,050
leave on the internet just for ease

768
00:26:45,370 --> 00:26:50,050
really but once you've done this type of

769
00:26:47,050 --> 00:26:51,940
<font color="#CCCCCC">tack linked with UNC</font><font color="#E5E5E5"> you can then access</font>

770
00:26:50,050 --> 00:26:54,580
loads of information if<font color="#E5E5E5"> you just</font><font color="#CCCCCC"> search</font>

771
00:26:51,940 --> 00:26:56,950
<font color="#CCCCCC">for wireless on on you insert sorry on</font>

772
00:26:54,580 --> 00:26:58,090
<font color="#E5E5E5">outlook web access generally you come</font>

773
00:26:56,950 --> 00:27:00,010
back<font color="#E5E5E5"> with oh yeah this</font><font color="#CCCCCC"> is the Wi-Fi</font>

774
00:26:58,090 --> 00:27:01,360
password it's changed everyone or if you

775
00:27:00,010 --> 00:27:03,879
search for password people just store

776
00:27:01,360 --> 00:27:05,320
random passwords in there also like

777
00:27:03,880 --> 00:27:06,490
<font color="#E5E5E5">credit card information just searching</font>

778
00:27:05,320 --> 00:27:07,720
<font color="#CCCCCC">for pans and things like that you'll</font>

779
00:27:06,490 --> 00:27:10,500
<font color="#E5E5E5">find a lot of this information</font><font color="#CCCCCC"> within</font>

780
00:27:07,720 --> 00:27:13,270
owa and this is without even penetration

781
00:27:10,500 --> 00:27:18,550
penetration pended pillar penetrating

782
00:27:13,270 --> 00:27:22,420
and<font color="#E5E5E5"> web will move move on without even</font>

783
00:27:18,550 --> 00:27:23,980
access in the inside network other

784
00:27:22,420 --> 00:27:25,930
<font color="#E5E5E5">things that often on the internet are</font>

785
00:27:23,980 --> 00:27:27,130
things like link so another good one if

786
00:27:25,930 --> 00:27:28,720
you<font color="#E5E5E5"> want to sort of really social</font>

787
00:27:27,130 --> 00:27:29,980
engineer someone once you've got on to

788
00:27:28,720 --> 00:27:31,480
that single factor system and you can't

789
00:27:29,980 --> 00:27:33,190
<font color="#CCCCCC">really get anywhere you might be able to</font>

790
00:27:31,480 --> 00:27:34,330
jump on link and send them a document to

791
00:27:33,190 --> 00:27:36,010
open or send<font color="#CCCCCC"> them another attachment</font>

792
00:27:34,330 --> 00:27:40,510
because they they'll think<font color="#E5E5E5"> it's that</font>

793
00:27:36,010 --> 00:27:44,440
<font color="#E5E5E5">person also sending emails from you and</font>

794
00:27:40,510 --> 00:27:47,320
see so sorry with<font color="#CCCCCC"> UNC once you access to</font>

795
00:27:44,440 --> 00:27:49,600
owa you can<font color="#E5E5E5"> actually send an email then</font>

796
00:27:47,320 --> 00:27:51,159
from that user to the<font color="#E5E5E5"> rest of the rest</font>

797
00:27:49,600 --> 00:27:53,110
of the company<font color="#E5E5E5"> and that email is</font>

798
00:27:51,160 --> 00:27:55,480
entrusted so you can add another<font color="#E5E5E5"> UNC</font>

799
00:27:53,110 --> 00:27:58,209
path and<font color="#E5E5E5"> you get a lot more shells if</font>

800
00:27:55,480 --> 00:27:59,380
you<font color="#E5E5E5"> even do this via owa from the</font>

801
00:27:58,210 --> 00:28:01,210
internet but<font color="#E5E5E5"> you have to manually</font>

802
00:27:59,380 --> 00:28:08,140
intercept it with<font color="#CCCCCC"> burp to add the UNC</font>

803
00:28:01,210 --> 00:28:10,600
path so signing macros data and other

804
00:28:08,140 --> 00:28:11,980
<font color="#E5E5E5">adds another degree of authenticity some</font>

805
00:28:10,600 --> 00:28:15,760
exactly some examples of<font color="#E5E5E5"> what it might</font>

806
00:28:11,980 --> 00:28:17,410
send in so obviously we're 2016 everyone

807
00:28:15,760 --> 00:28:18,670
thinks it's new and different so if you

808
00:28:17,410 --> 00:28:20,380
send a document something like that

809
00:28:18,670 --> 00:28:21,790
they'll say oh this was created<font color="#CCCCCC"> with a</font>

810
00:28:20,380 --> 00:28:25,180
later version and yours you<font color="#E5E5E5"> need to</font>

811
00:28:21,790 --> 00:28:28,840
enable content about 75% users will just

812
00:28:25,180 --> 00:28:32,590
go yeah okay enable content what I quite

813
00:28:28,840 --> 00:28:35,020
like doing is sending a<font color="#E5E5E5"> CV so yeah hi</font>

814
00:28:32,590 --> 00:28:37,179
I'm after<font color="#E5E5E5"> this job of Allah is my</font><font color="#CCCCCC"> CV</font>

815
00:28:35,020 --> 00:28:39,040
having a nice little picture with some

816
00:28:37,180 --> 00:28:42,040
encoded text and<font color="#E5E5E5"> then adding an image</font>

817
00:28:39,040 --> 00:28:44,470
saying to enable a<font color="#E5E5E5"> UK encoding click</font>

818
00:28:42,040 --> 00:28:46,659
enable content then once they do that

819
00:28:44,470 --> 00:28:48,310
the image is then reverted back to the

820
00:28:46,660 --> 00:28:49,660
proper picture and they feel warm and

821
00:28:48,310 --> 00:28:51,250
fuzzy that something's happened and it

822
00:28:49,660 --> 00:28:52,570
worked so they don't think that

823
00:28:51,250 --> 00:28:54,040
anything's the various going on the

824
00:28:52,570 --> 00:28:57,689
background they<font color="#CCCCCC"> just think something</font>

825
00:28:54,040 --> 00:29:00,879
<font color="#CCCCCC">Tappin that</font><font color="#E5E5E5"> work cool it must be</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> PC</font>

826
00:28:57,690 --> 00:29:02,170
click once applications so again these

827
00:29:00,880 --> 00:29:03,580
are really good and when you're trying

828
00:29:02,170 --> 00:29:05,200
to mimic sort of things like Citrix

829
00:29:03,580 --> 00:29:06,730
because by default you have to have the

830
00:29:05,200 --> 00:29:08,830
<font color="#E5E5E5">Citrix Receiver installed on your</font>

831
00:29:06,730 --> 00:29:10,330
machine and to do that that<font color="#CCCCCC"> actually</font>

832
00:29:08,830 --> 00:29:12,280
installs either send you off to a link

833
00:29:10,330 --> 00:29:13,720
or install something on your machine so

834
00:29:12,280 --> 00:29:15,220
when they see things like install

835
00:29:13,720 --> 00:29:16,120
they're not going to think that's dodgy

836
00:29:15,220 --> 00:29:18,460
they're going to think oh yeah that's

837
00:29:16,120 --> 00:29:21,040
just<font color="#E5E5E5"> normal install it click once happy</font>

838
00:29:18,460 --> 00:29:22,660
days and if you again use a code signing

839
00:29:21,040 --> 00:29:25,360
sir it comes up and it doesn't say

840
00:29:22,660 --> 00:29:26,320
<font color="#CCCCCC">anything about red</font><font color="#E5E5E5"> note not trusted so</font>

841
00:29:25,360 --> 00:29:28,419
it's just<font color="#E5E5E5"> another good way of getting</font>

842
00:29:26,320 --> 00:29:33,040
inside an organization and this<font color="#E5E5E5"> is part</font>

843
00:29:28,420 --> 00:29:34,630
of all part of the<font color="#E5E5E5"> delivery mechanism so</font>

844
00:29:33,040 --> 00:29:36,700
what I would say is always anonymize you

845
00:29:34,630 --> 00:29:39,190
see to traffic so if you're doing it you

846
00:29:36,700 --> 00:29:41,500
know a<font color="#E5E5E5"> real engagement</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> trying to</font>

847
00:29:39,190 --> 00:29:43,390
mimic a real threat actor so you don't

848
00:29:41,500 --> 00:29:44,890
want the IP<font color="#CCCCCC"> address to come back to net</font>

849
00:29:43,390 --> 00:29:46,420
shoot because they'll just be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to do</font>

850
00:29:44,890 --> 00:29:48,250
a reverse<font color="#E5E5E5"> lookup on the IP and go that's</font>

851
00:29:46,420 --> 00:29:50,320
an attitude a<font color="#E5E5E5"> UN security testing you</font>

852
00:29:48,250 --> 00:29:51,790
really want<font color="#E5E5E5"> to mimic a real threat so</font>

853
00:29:50,320 --> 00:29:53,020
that<font color="#CCCCCC"> there I our team can work their ass</font>

854
00:29:51,790 --> 00:29:54,879
off to try and find out who's trying to

855
00:29:53,020 --> 00:29:56,500
<font color="#E5E5E5">hack them and then give a nice report at</font>

856
00:29:54,880 --> 00:29:58,330
the end to say what<font color="#CCCCCC"> we did because</font>

857
00:29:56,500 --> 00:30:00,040
that's kind of the whole the real reason

858
00:29:58,330 --> 00:30:03,820
we do a red team engagement is to test

859
00:30:00,040 --> 00:30:05,950
their defense and response capability so

860
00:30:03,820 --> 00:30:07,929
there's two ways you can anonymize your

861
00:30:05,950 --> 00:30:10,210
traffic<font color="#CCCCCC"> well two ways i'd do it you can</font>

862
00:30:07,930 --> 00:30:12,070
either create an IP table rule on some

863
00:30:10,210 --> 00:30:13,930
sort of VPS is on the internet<font color="#E5E5E5"> which</font>

864
00:30:12,070 --> 00:30:16,060
basically just forward 80 and 443 things

865
00:30:13,930 --> 00:30:17,170
like to your<font color="#CCCCCC"> c2 server so all the</font>

866
00:30:16,060 --> 00:30:18,669
traffic will<font color="#E5E5E5"> be going straight to them</font>

867
00:30:17,170 --> 00:30:20,860
by acting in the<font color="#E5E5E5"> back end going back to</font>

868
00:30:18,670 --> 00:30:22,390
sort of the<font color="#E5E5E5"> net stewed range all there's</font>

869
00:30:20,860 --> 00:30:23,889
some nice Python scripts you can write

870
00:30:22,390 --> 00:30:26,350
one of our guys wrote a nice<font color="#E5E5E5"> Python</font>

871
00:30:23,890 --> 00:30:28,270
script which basically takes it fits a

872
00:30:26,350 --> 00:30:30,459
normal web request it'll<font color="#CCCCCC"> just</font><font color="#E5E5E5"> take you</font>

873
00:30:28,270 --> 00:30:32,740
off to the website if<font color="#CCCCCC"> it's see to</font>

874
00:30:30,460 --> 00:30:37,060
traffic defined by the user agent then

875
00:30:32,740 --> 00:30:38,320
it will go after the c2 server and this

876
00:30:37,060 --> 00:30:40,899
helps when you create<font color="#CCCCCC"> an bogus websites</font>

877
00:30:38,320 --> 00:30:42,490
because if you go if you do it the other

878
00:30:40,900 --> 00:30:44,260
way we<font color="#CCCCCC"> just iptables it just send you</font>

879
00:30:42,490 --> 00:30:45,640
off to the sea to server whereas<font color="#E5E5E5"> if you</font>

880
00:30:44,260 --> 00:30:46,960
use the<font color="#E5E5E5"> Python script you can</font><font color="#CCCCCC"> actually</font>

881
00:30:45,640 --> 00:30:49,690
have it go off to your just normal

882
00:30:46,960 --> 00:30:51,960
<font color="#E5E5E5">website which has got good good</font>

883
00:30:49,690 --> 00:30:51,960
reputation

884
00:30:53,420 --> 00:30:58,220
so one day in the<font color="#E5E5E5"> red team in World I</font>

885
00:30:55,760 --> 00:31:00,320
sent my CV into the recruitment mailing

886
00:30:58,220 --> 00:31:02,000
list of a company thinking very

887
00:31:00,320 --> 00:31:04,460
pessimistically I decided to send the

888
00:31:02,000 --> 00:31:06,590
attack and go from coffee as per usual

889
00:31:04,460 --> 00:31:07,940
<font color="#E5E5E5">this is about half five at night so I</font>

890
00:31:06,590 --> 00:31:09,560
was just<font color="#E5E5E5"> about to get off just about to</font>

891
00:31:07,940 --> 00:31:14,660
go to the gym less than five minutes

892
00:31:09,560 --> 00:31:19,540
later Wendy opened my email and then she

893
00:31:14,660 --> 00:31:22,910
opened the<font color="#E5E5E5"> CV and then she enable macros</font>

894
00:31:19,540 --> 00:31:24,050
however the UNC path was blocked which

895
00:31:22,910 --> 00:31:25,460
was<font color="#CCCCCC"> fine that's no problem I've still</font>

896
00:31:24,050 --> 00:31:28,010
got a shell on her on<font color="#CCCCCC"> her machine at</font>

897
00:31:25,460 --> 00:31:31,160
this point however never fear because

898
00:31:28,010 --> 00:31:33,170
enterprise vault was here so this popped

899
00:31:31,160 --> 00:31:35,620
me domain admin credentials sent over

900
00:31:33,170 --> 00:31:39,200
unc so I was now inside the<font color="#E5E5E5"> organization</font>

901
00:31:35,620 --> 00:31:40,850
with a foothold with<font color="#CCCCCC"> domain admin</font>

902
00:31:39,200 --> 00:31:43,160
credentials sent value and see which had

903
00:31:40,850 --> 00:31:44,990
a trivial password so basically<font color="#CCCCCC"> zero</font>

904
00:31:43,160 --> 00:31:49,310
<font color="#E5E5E5">here in five minutes and I wanted</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> go</font>

905
00:31:44,990 --> 00:31:51,050
the<font color="#E5E5E5"> gym at this point basically I was</font>

906
00:31:49,310 --> 00:31:52,610
inside their organization I could access

907
00:31:51,050 --> 00:31:54,620
their datacenter i could laterally move

908
00:31:52,610 --> 00:31:56,360
to pretty much anything that was windows

909
00:31:54,620 --> 00:31:58,100
authentication with the<font color="#E5E5E5"> domain admin</font>

910
00:31:56,360 --> 00:32:00,979
credentials this really<font color="#E5E5E5"> just shows how</font>

911
00:31:58,100 --> 00:32:02,480
powerful<font color="#CCCCCC"> UNC can be again because I</font>

912
00:32:00,980 --> 00:32:04,070
didn't think UNC would work and it

913
00:32:02,480 --> 00:32:06,050
didn't on<font color="#E5E5E5"> the user that I was intending</font>

914
00:32:04,070 --> 00:32:07,310
to attack however<font color="#E5E5E5"> some random</font>

915
00:32:06,050 --> 00:32:08,930
configuration of enterprise vault

916
00:32:07,310 --> 00:32:10,580
allowed me to get the main admin

917
00:32:08,930 --> 00:32:13,070
credentials so it's<font color="#E5E5E5"> just really really</font>

918
00:32:10,580 --> 00:32:14,389
<font color="#E5E5E5">quite strange how things can happen but</font>

919
00:32:13,070 --> 00:32:18,290
always just add all these type of things

920
00:32:14,390 --> 00:32:20,360
into your weaponization phase things

921
00:32:18,290 --> 00:32:22,129
once<font color="#CCCCCC"> i was a mega</font><font color="#E5E5E5"> access to i could</font>

922
00:32:20,360 --> 00:32:25,370
screenshot I desktop see that she was on

923
00:32:22,130 --> 00:32:26,990
all our emails when<font color="#E5E5E5"> I was searching to</font>

924
00:32:25,370 --> 00:32:29,300
find some information<font color="#E5E5E5"> because this was</font>

925
00:32:26,990 --> 00:32:30,830
kind of an open objective they just said

926
00:32:29,300 --> 00:32:32,300
<font color="#CCCCCC">Devon</font><font color="#E5E5E5"> really had this pentas tub pen</font>

927
00:32:30,830 --> 00:32:33,949
testing before they just wanted us<font color="#CCCCCC"> to</font>

928
00:32:32,300 --> 00:32:36,020
know they<font color="#E5E5E5"> wanted to provide risk to the</font>

929
00:32:33,950 --> 00:32:39,920
organization so side of a little search

930
00:32:36,020 --> 00:32:42,470
around found HR payroll data looked in

931
00:32:39,920 --> 00:32:44,390
their 40 p 60s now that can't be all the

932
00:32:42,470 --> 00:32:46,250
<font color="#CCCCCC">p 60 is password protected PDF that's</font>

933
00:32:44,390 --> 00:32:48,080
<font color="#E5E5E5">fine i can't get but i can't get around</font>

934
00:32:46,250 --> 00:32:50,090
that a way i can there's John the Ripper

935
00:32:48,080 --> 00:32:53,050
<font color="#E5E5E5">got around that and then I showed them</font>

936
00:32:50,090 --> 00:32:53,050
the CEOs pay slit

937
00:32:53,460 --> 00:33:00,340
I've<font color="#E5E5E5"> had to adapt that but believe me</font>

938
00:32:55,690 --> 00:33:01,810
she ain't<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of money</font><font color="#E5E5E5"> so a shell is</font>

939
00:33:00,340 --> 00:33:03,909
only the beginning as dark operator

940
00:33:01,810 --> 00:33:06,370
would say and it really is it's great

941
00:33:03,910 --> 00:33:08,260
having 320 shells in the organization

942
00:33:06,370 --> 00:33:10,209
<font color="#CCCCCC">but you really got to act on your</font>

943
00:33:08,260 --> 00:33:12,040
objectives so once you're in that's<font color="#E5E5E5"> just</font>

944
00:33:10,210 --> 00:33:13,870
like the<font color="#E5E5E5"> starting point for me so then I</font>

945
00:33:12,040 --> 00:33:16,300
want to<font color="#E5E5E5"> actually laterally move trying</font>

946
00:33:13,870 --> 00:33:18,850
and act on my objectives and get the

947
00:33:16,300 --> 00:33:20,500
crown jewels of<font color="#CCCCCC"> the organization but</font>

948
00:33:18,850 --> 00:33:21,909
first whenever you get inside an

949
00:33:20,500 --> 00:33:25,180
organization you do some situational

950
00:33:21,910 --> 00:33:26,650
awareness so don't forget when<font color="#CCCCCC"> you do</font>

951
00:33:25,180 --> 00:33:28,450
this type of engagement you are going in

952
00:33:26,650 --> 00:33:29,440
blind you don't have a clue what you're

953
00:33:28,450 --> 00:33:32,740
going to hit and if you're<font color="#E5E5E5"> going to hit</font>

954
00:33:29,440 --> 00:33:35,230
and what you land on so you need<font color="#E5E5E5"> to be</font>

955
00:33:32,740 --> 00:33:37,240
<font color="#CCCCCC">aware of your surroundings and you want</font>

956
00:33:35,230 --> 00:33:39,190
to desktop I you on a<font color="#E5E5E5"> VDI which is a</font>

957
00:33:37,240 --> 00:33:41,860
virtual desktop are you want to laptop

958
00:33:39,190 --> 00:33:43,210
is a system going<font color="#E5E5E5"> join to a domain or is</font>

959
00:33:41,860 --> 00:33:45,310
it standalone because you might be on

960
00:33:43,210 --> 00:33:47,080
some some<font color="#CCCCCC"> guys laptop at home which you</font>

961
00:33:45,310 --> 00:33:48,639
never really intended to target so you

962
00:33:47,080 --> 00:33:50,110
need<font color="#E5E5E5"> to be you know quite savvy when you</font>

963
00:33:48,640 --> 00:33:51,160
do<font color="#E5E5E5"> this type of thing because it is you</font>

964
00:33:50,110 --> 00:33:53,699
know you could be breaking the law at

965
00:33:51,160 --> 00:33:56,080
this point you need<font color="#E5E5E5"> to ensure what OS</font>

966
00:33:53,700 --> 00:33:57,670
languages on so I was doing this

967
00:33:56,080 --> 00:33:59,080
recently I was able<font color="#E5E5E5"> to escalate</font>

968
00:33:57,670 --> 00:34:00,070
privileges but it took me<font color="#E5E5E5"> about an hour</font>

969
00:33:59,080 --> 00:34:02,949
and a half when it should took me about

970
00:34:00,070 --> 00:34:04,689
five minutes<font color="#E5E5E5"> I was on an</font><font color="#CCCCCC"> algerian pc</font><font color="#E5E5E5"> i</font>

971
00:34:02,950 --> 00:34:07,060
didn't really<font color="#E5E5E5"> take note this when I was</font>

972
00:34:04,690 --> 00:34:08,679
initially on it and I<font color="#E5E5E5"> was basically</font><font color="#CCCCCC"> able</font>

973
00:34:07,060 --> 00:34:10,719
to escalate my privileges by a service

974
00:34:08,679 --> 00:34:12,609
abuse and but I was trying<font color="#CCCCCC"> to add my use</font>

975
00:34:10,719 --> 00:34:14,199
at<font color="#CCCCCC"> the local admin group and I wouldn't</font>

976
00:34:12,610 --> 00:34:15,760
work and it must have pulled my hair

977
00:34:14,199 --> 00:34:17,350
again why does not working it I know I

978
00:34:15,760 --> 00:34:19,540
can get excellent escalation and

979
00:34:17,350 --> 00:34:21,370
privileges and because in<font color="#E5E5E5"> Algeria and</font>

980
00:34:19,540 --> 00:34:23,590
all French administrators has spent

981
00:34:21,370 --> 00:34:25,719
spelt with an EU so<font color="#CCCCCC"> its administrator's</font>

982
00:34:23,590 --> 00:34:27,280
so it basically just<font color="#E5E5E5"> you know be aware</font>

983
00:34:25,719 --> 00:34:29,319
what<font color="#E5E5E5"> machine you are and little things</font>

984
00:34:27,280 --> 00:34:30,370
that<font color="#E5E5E5"> can just hold you up and take about</font>

985
00:34:29,320 --> 00:34:32,740
an hour<font color="#E5E5E5"> of your life where you didn't</font>

986
00:34:30,370 --> 00:34:34,210
<font color="#E5E5E5">need it to and this is really important</font>

987
00:34:32,739 --> 00:34:35,739
before you lay persistence as well

988
00:34:34,210 --> 00:34:37,720
because if<font color="#E5E5E5"> that was me and I will just</font>

989
00:34:35,739 --> 00:34:40,179
<font color="#E5E5E5">lay persistent there and then and moved</font>

990
00:34:37,719 --> 00:34:44,679
out then it wouldn't work so<font color="#CCCCCC"> things</font><font color="#E5E5E5"> is</font>

991
00:34:40,179 --> 00:34:47,199
<font color="#CCCCCC">really important so which brings me on</font>

992
00:34:44,679 --> 00:34:49,509
to<font color="#E5E5E5"> another little story so we applied</font>

993
00:34:47,199 --> 00:34:51,040
<font color="#CCCCCC">for a job at a company and the top of</font>

994
00:34:49,510 --> 00:34:53,710
the CV we had a burner phone number

995
00:34:51,040 --> 00:34:56,080
which we use before so a<font color="#E5E5E5"> guy called</font>

996
00:34:53,710 --> 00:34:58,180
Michael rang the burner phone so it was

997
00:34:56,080 --> 00:34:59,500
free written in our war room and there

998
00:34:58,180 --> 00:35:00,609
was dead silence in this burner phone

999
00:34:59,500 --> 00:35:02,290
ranks it's the first time we've actually

1000
00:35:00,610 --> 00:35:04,450
have I had call<font color="#E5E5E5"> into the burner phone</font>

1001
00:35:02,290 --> 00:35:06,520
well you're<font color="#E5E5E5"> like oh that's what's that</font>

1002
00:35:04,450 --> 00:35:07,930
anyway<font color="#CCCCCC"> I was like now na UN</font>

1003
00:35:06,520 --> 00:35:09,580
he was<font color="#E5E5E5"> like no you enter and we had a</font>

1004
00:35:07,930 --> 00:35:11,770
bit of a fight and I in advance in it I

1005
00:35:09,580 --> 00:35:13,360
was unfortunate one to talk to this guy

1006
00:35:11,770 --> 00:35:15,759
anyway rings me goes oh hello hello<font color="#CCCCCC"> is</font>

1007
00:35:13,360 --> 00:35:17,350
that a common what name<font color="#CCCCCC"> is James I was</font>

1008
00:35:15,760 --> 00:35:19,210
like yeah yeah it's james said<font color="#CCCCCC"> I have</font>

1009
00:35:17,350 --> 00:35:21,490
<font color="#E5E5E5">your</font><font color="#CCCCCC"> CV and you have an issue of like</font>

1010
00:35:19,210 --> 00:35:23,440
yeah yeah<font color="#E5E5E5"> basically I couldn't upload it</font>

1011
00:35:21,490 --> 00:35:25,810
to your website so i was running if<font color="#CCCCCC"> you</font>

1012
00:35:23,440 --> 00:35:27,400
could upload it for me and he was like

1013
00:35:25,810 --> 00:35:28,840
yeah<font color="#CCCCCC"> no problem no problem he said it</font>

1014
00:35:27,400 --> 00:35:30,520
should be in PDF<font color="#E5E5E5"> I was like yeah I know</font>

1015
00:35:28,840 --> 00:35:32,590
but I couldn't I couldn't didn't<font color="#E5E5E5"> had a</font>

1016
00:35:30,520 --> 00:35:34,330
PDF it he was like<font color="#E5E5E5"> no problem</font><font color="#CCCCCC"> I can PDF</font>

1017
00:35:32,590 --> 00:35:36,070
it for you I was like great perfect I

1018
00:35:34,330 --> 00:35:37,779
like does it<font color="#E5E5E5"> show my picture by any</font>

1019
00:35:36,070 --> 00:35:39,760
chance she's like no I can't see no

1020
00:35:37,780 --> 00:35:41,140
picture I was like okay no worries is

1021
00:35:39,760 --> 00:35:42,820
there an able content button by any

1022
00:35:41,140 --> 00:35:46,569
chance yeah yeah<font color="#E5E5E5"> sure I said can you</font>

1023
00:35:42,820 --> 00:35:48,880
click that yeah no problem<font color="#CCCCCC"> flick yes we</font>

1024
00:35:46,570 --> 00:35:51,670
had a<font color="#E5E5E5"> shell I couldn't really I was a</font>

1025
00:35:48,880 --> 00:35:55,450
star so happy at that<font color="#E5E5E5"> point I guess the</font>

1026
00:35:51,670 --> 00:35:58,120
reason why I'm saying this is when we

1027
00:35:55,450 --> 00:36:00,370
got in and we<font color="#E5E5E5"> actually got shall we</font>

1028
00:35:58,120 --> 00:36:01,990
failed<font color="#E5E5E5"> to install persistence so luckily</font>

1029
00:36:00,370 --> 00:36:05,170
for us we had a great call great guy

1030
00:36:01,990 --> 00:36:07,689
called Michael so we tried on<font color="#CCCCCC"> the first</font>

1031
00:36:05,170 --> 00:36:09,220
instance we tried to install the

1032
00:36:07,690 --> 00:36:12,430
persistence within the registry but

1033
00:36:09,220 --> 00:36:14,410
because we're<font color="#E5E5E5"> on a VDI and the actual</font>

1034
00:36:12,430 --> 00:36:16,779
bat file we uploaded was in the C Drive

1035
00:36:14,410 --> 00:36:17,980
when he logged in again with a VDI

1036
00:36:16,780 --> 00:36:19,660
configuration you can have that<font color="#E5E5E5"> either</font>

1037
00:36:17,980 --> 00:36:21,430
have dedicated video so you can have a

1038
00:36:19,660 --> 00:36:23,649
random VDI and some videos can be

1039
00:36:21,430 --> 00:36:24,970
destroyed so when you logged<font color="#E5E5E5"> in day two</font>

1040
00:36:23,650 --> 00:36:27,550
we were waiting for<font color="#E5E5E5"> a shell</font><font color="#CCCCCC"> out about</font>

1041
00:36:24,970 --> 00:36:31,569
<font color="#CCCCCC">9-930 didn't get show on oh bugger why</font>

1042
00:36:27,550 --> 00:36:32,680
why not couldn't think anyway so the

1043
00:36:31,570 --> 00:36:34,270
reason was we didn't get a shells

1044
00:36:32,680 --> 00:36:36,520
because it was on the vdi so anyway we

1045
00:36:34,270 --> 00:36:38,350
sent<font color="#E5E5E5"> him another mimosa haha hi Michael</font>

1046
00:36:36,520 --> 00:36:40,120
I've updated my<font color="#E5E5E5"> CV i forgot</font><font color="#CCCCCC"> to add that</font>

1047
00:36:38,350 --> 00:36:41,740
<font color="#E5E5E5">i had disqualification at this date oh</font>

1048
00:36:40,120 --> 00:36:44,319
no<font color="#CCCCCC"> problem no problem here i'll update</font>

1049
00:36:41,740 --> 00:36:46,089
<font color="#E5E5E5">it for you bang another shell happy days</font>

1050
00:36:44,320 --> 00:36:48,010
anyway<font color="#CCCCCC"> right we got an elf assistance</font>

1051
00:36:46,090 --> 00:36:49,410
<font color="#E5E5E5">this time so we tried in storm systems a</font>

1052
00:36:48,010 --> 00:36:51,970
second time with a scheduled task

1053
00:36:49,410 --> 00:36:54,330
scheduled task with a bat file again in

1054
00:36:51,970 --> 00:36:56,470
his local profile and for some reason

1055
00:36:54,330 --> 00:36:59,529
again we don't<font color="#E5E5E5"> really know why this one</font>

1056
00:36:56,470 --> 00:37:02,259
failed come to the second day 9 930 no

1057
00:36:59,530 --> 00:37:06,130
shell no way we can't use Michael<font color="#E5E5E5"> again</font>

1058
00:37:02,260 --> 00:37:08,500
surely not anyway Michael there's a typo

1059
00:37:06,130 --> 00:37:10,960
in my CV you couldn't be the effort for

1060
00:37:08,500 --> 00:37:13,150
me<font color="#CCCCCC"> thinking half and I went by now he's</font>

1061
00:37:10,960 --> 00:37:15,550
not done it sorry<font color="#CCCCCC"> Ben sorry I was a bit</font>

1062
00:37:13,150 --> 00:37:17,800
late here we go done yes third shell

1063
00:37:15,550 --> 00:37:19,990
anyway third shell manage to install

1064
00:37:17,800 --> 00:37:21,580
persisters properly in<font color="#CCCCCC"> the registry and</font>

1065
00:37:19,990 --> 00:37:23,339
nothing touched<font color="#CCCCCC"> disk when he logged back</font>

1066
00:37:21,580 --> 00:37:26,170
out and log back in and everything<font color="#E5E5E5"> was</font>

1067
00:37:23,340 --> 00:37:27,520
persisted fine and it was great really

1068
00:37:26,170 --> 00:37:28,900
but<font color="#E5E5E5"> I'll just thought i'd share that</font>

1069
00:37:27,520 --> 00:37:30,250
story because<font color="#E5E5E5"> you know even</font><font color="#CCCCCC"> if you've</font>

1070
00:37:28,900 --> 00:37:37,210
<font color="#E5E5E5">been doing this thing a while you can</font>

1071
00:37:30,250 --> 00:37:39,510
talk basically get caught so it's really

1072
00:37:37,210 --> 00:37:41,830
really good to<font color="#E5E5E5"> know your surroundings</font>

1073
00:37:39,510 --> 00:37:45,010
you guys might<font color="#E5E5E5"> not have a guy called</font>

1074
00:37:41,830 --> 00:37:47,190
Michael<font color="#E5E5E5"> he'll just click anything so it</font>

1075
00:37:45,010 --> 00:37:51,250
<font color="#E5E5E5">is</font><font color="#CCCCCC"> four ways I reliably get persistence</font>

1076
00:37:47,190 --> 00:37:53,140
so if you're<font color="#E5E5E5"> in as a user there's the HK</font>

1077
00:37:51,250 --> 00:37:55,420
see you registry one key which<font color="#E5E5E5"> I often</font>

1078
00:37:53,140 --> 00:37:57,100
<font color="#E5E5E5">use this is fingerprint quite a lot now</font>

1079
00:37:55,420 --> 00:37:58,480
so if you took<font color="#E5E5E5"> going gets calm lacking</font>

1080
00:37:57,100 --> 00:37:59,290
think that you might be<font color="#CCCCCC"> a bit careful</font>

1081
00:37:58,480 --> 00:38:02,410
when you when you're installing

1082
00:37:59,290 --> 00:38:04,690
persistence but for the most part of

1083
00:38:02,410 --> 00:38:05,618
work and if you're running us if you've

1084
00:38:04,690 --> 00:38:07,270
actually made to escalate privileges

1085
00:38:05,619 --> 00:38:10,090
system there's a system land version of

1086
00:38:07,270 --> 00:38:13,210
it as well what's another way quite good

1087
00:38:10,090 --> 00:38:15,190
it shed your task again most times you

1088
00:38:13,210 --> 00:38:17,740
can run that as a user but<font color="#E5E5E5"> often it is</font>

1089
00:38:15,190 --> 00:38:19,240
locked down by group policy again if you

1090
00:38:17,740 --> 00:38:20,919
can escalate privileges on the on the

1091
00:38:19,240 --> 00:38:22,779
machine to install persistence you can

1092
00:38:20,920 --> 00:38:25,390
get a system level system level service

1093
00:38:22,780 --> 00:38:28,000
which is<font color="#E5E5E5"> in system and one of the most</font>

1094
00:38:25,390 --> 00:38:29,500
stealthy ways that<font color="#E5E5E5"> I find is wmi so Matt</font>

1095
00:38:28,000 --> 00:38:32,410
<font color="#CCCCCC">graber did something on this think it</font>

1096
00:38:29,500 --> 00:38:34,359
was about 9 10 months ago now you can

1097
00:38:32,410 --> 00:38:36,220
create an on startup wmi event which is

1098
00:38:34,359 --> 00:38:37,930
<font color="#E5E5E5">really stealthy not many systems would</font>

1099
00:38:36,220 --> 00:38:39,368
pick this up at all so if<font color="#CCCCCC"> Stealth's your</font>

1100
00:38:37,930 --> 00:38:43,750
approach then and that's<font color="#E5E5E5"> the way to go</font>

1101
00:38:39,369 --> 00:38:45,490
<font color="#E5E5E5">really one thing to be aware of again it</font>

1102
00:38:43,750 --> 00:38:46,480
is proxy where<font color="#CCCCCC"> I know I keep going</font><font color="#E5E5E5"> on</font>

1103
00:38:45,490 --> 00:38:48,580
about this but it's really really

1104
00:38:46,480 --> 00:38:50,290
<font color="#E5E5E5">important so if you've escalate your</font>

1105
00:38:48,580 --> 00:38:52,480
<font color="#E5E5E5">privileges system you got to remember</font>

1106
00:38:50,290 --> 00:38:54,400
<font color="#E5E5E5">that the user you're logged in as before</font>

1107
00:38:52,480 --> 00:38:56,020
you've<font color="#CCCCCC"> got the system would have proxy</font>

1108
00:38:54,400 --> 00:38:58,090
aware sort of credentials so he would<font color="#E5E5E5"> be</font>

1109
00:38:56,020 --> 00:39:01,180
allowed to go through the proxy system

1110
00:38:58,090 --> 00:39:02,590
isn't isn't a user domain domain user so

1111
00:39:01,180 --> 00:39:04,569
system wouldn't be able<font color="#E5E5E5"> to traverse out</font>

1112
00:39:02,590 --> 00:39:06,070
the proxy so when you create in your

1113
00:39:04,570 --> 00:39:07,960
payloads if you use<font color="#CCCCCC"> in stuff like</font>

1114
00:39:06,070 --> 00:39:09,550
<font color="#CCCCCC">metasploit or whatever you want to use</font>

1115
00:39:07,960 --> 00:39:11,740
to get<font color="#E5E5E5"> out you need to make sure that</font>

1116
00:39:09,550 --> 00:39:14,710
<font color="#E5E5E5">can support proxy credentials on the</font>

1117
00:39:11,740 --> 00:39:16,629
proxy and proxy URL because system won't

1118
00:39:14,710 --> 00:39:18,280
be able to find<font color="#E5E5E5"> out for you so this is</font>

1119
00:39:16,630 --> 00:39:19,930
another way which we fail before is

1120
00:39:18,280 --> 00:39:21,820
we're just<font color="#E5E5E5"> installing it thinking system</font>

1121
00:39:19,930 --> 00:39:23,500
will get out and it won't so just just

1122
00:39:21,820 --> 00:39:25,150
be aware that if you escalate privileges

1123
00:39:23,500 --> 00:39:29,190
and installing system level persistence

1124
00:39:25,150 --> 00:39:29,190
make<font color="#CCCCCC"> sure you add your proxy details</font>

1125
00:39:30,600 --> 00:39:36,360
so other post exploitation techniques I

1126
00:39:34,240 --> 00:39:39,700
use a lot is sort of cred logging and

1127
00:39:36,360 --> 00:39:42,100
credit popping so the main goal of a red

1128
00:39:39,700 --> 00:39:44,200
team engagement is to get to the

1129
00:39:42,100 --> 00:39:45,880
critical assets or applications and

1130
00:39:44,200 --> 00:39:48,520
often inside<font color="#E5E5E5"> a bank or something like</font>

1131
00:39:45,880 --> 00:39:49,750
that<font color="#E5E5E5"> it'll be on oracle so your</font>

1132
00:39:48,520 --> 00:39:52,030
credentials that you might<font color="#CCCCCC"> have got</font>

1133
00:39:49,750 --> 00:39:54,130
<font color="#E5E5E5">during the windows phase wouldn't work</font>

1134
00:39:52,030 --> 00:39:57,280
on the<font color="#E5E5E5"> oracle stuff so the way</font><font color="#CCCCCC"> i</font>

1135
00:39:54,130 --> 00:39:58,750
generally do this is by basically if the

1136
00:39:57,280 --> 00:40:00,070
guy that I've got onto is open the

1137
00:39:58,750 --> 00:40:02,020
application I want to access the

1138
00:40:00,070 --> 00:40:04,090
application so the banking application

1139
00:40:02,020 --> 00:40:05,800
often just kill the process and wait for

1140
00:40:04,090 --> 00:40:07,420
him<font color="#E5E5E5"> to log back in using a keylogger and</font>

1141
00:40:05,800 --> 00:40:09,130
that way then<font color="#E5E5E5"> I've got got the</font>

1142
00:40:07,420 --> 00:40:11,680
<font color="#E5E5E5">credentials i need to actually move on</font>

1143
00:40:09,130 --> 00:40:14,140
to the application so this is<font color="#CCCCCC"> an example</font>

1144
00:40:11,680 --> 00:40:16,480
a real world<font color="#CCCCCC"> application and using</font>

1145
00:40:14,140 --> 00:40:18,310
powershell keylogger<font color="#E5E5E5"> they see was able</font>

1146
00:40:16,480 --> 00:40:20,110
to see him go on to the banking sweet

1147
00:40:18,310 --> 00:40:22,540
enter his username and enter his

1148
00:40:20,110 --> 00:40:24,100
password I was then able to laterally

1149
00:40:22,540 --> 00:40:25,420
move to another machine with citrix and

1150
00:40:24,100 --> 00:40:33,490
log straight into that banking

1151
00:40:25,420 --> 00:40:35,920
application so which brings gone to

1152
00:40:33,490 --> 00:40:38,290
another little story so we approached a

1153
00:40:35,920 --> 00:40:40,090
guy called Andrew Andrew it was a

1154
00:40:38,290 --> 00:40:41,740
network specialist who may or may not

1155
00:40:40,090 --> 00:40:43,600
been looking to leave his current role

1156
00:40:41,740 --> 00:40:46,569
and we found<font color="#E5E5E5"> this CV was already out</font>

1157
00:40:43,600 --> 00:40:49,630
there on the internet so<font color="#CCCCCC"> we basically go</font>

1158
00:40:46,570 --> 00:40:52,960
and touch this guy over<font color="#E5E5E5"> social media and</font>

1159
00:40:49,630 --> 00:40:54,970
slightly over sold him a role the new IT

1160
00:40:52,960 --> 00:40:58,330
role was working<font color="#E5E5E5"> from home great</font>

1161
00:40:54,970 --> 00:41:00,339
salaries fifteen percent pension private

1162
00:40:58,330 --> 00:41:02,020
<font color="#E5E5E5">healthcare everything we literally just</font>

1163
00:41:00,340 --> 00:41:03,760
sold on the phone with an hour and a

1164
00:41:02,020 --> 00:41:05,080
half this recruitment like is really

1165
00:41:03,760 --> 00:41:08,020
<font color="#CCCCCC">easy i don't know i don't go into that</font>

1166
00:41:05,080 --> 00:41:10,360
to be honest all i needed to<font color="#E5E5E5"> do was</font>

1167
00:41:08,020 --> 00:41:11,860
visit a website and digitally sign my

1168
00:41:10,360 --> 00:41:13,810
agreement in principle so I said I'll

1169
00:41:11,860 --> 00:41:15,880
before I can work on<font color="#CCCCCC"> your behalf I need</font>

1170
00:41:13,810 --> 00:41:16,600
to visit<font color="#E5E5E5"> this website so that we you</font>

1171
00:41:15,880 --> 00:41:18,670
know so that I didn't do anything

1172
00:41:16,600 --> 00:41:20,890
naughty and you know I'm bound by UK law

1173
00:41:18,670 --> 00:41:22,630
so I got him to put his full name in his

1174
00:41:20,890 --> 00:41:24,879
email which is<font color="#E5E5E5"> the digital signature</font>

1175
00:41:22,630 --> 00:41:27,310
apparently and it says I agree that<font color="#CCCCCC"> this</font>

1176
00:41:24,880 --> 00:41:29,680
is<font color="#E5E5E5"> this is contractually sorry this is</font>

1177
00:41:27,310 --> 00:41:31,660
this contract shall be governed by UK

1178
00:41:29,680 --> 00:41:32,830
law so he thought<font color="#E5E5E5"> this was all good yet</font>

1179
00:41:31,660 --> 00:41:35,200
no problem I'll do that for you now<font color="#E5E5E5"> been</font>

1180
00:41:32,830 --> 00:41:36,730
because I said it was<font color="#E5E5E5"> all anonymized and</font>

1181
00:41:35,200 --> 00:41:38,710
nothing sort of showed any recruitment

1182
00:41:36,730 --> 00:41:41,920
sort of logos or anything he did this<font color="#CCCCCC"> in</font>

1183
00:41:38,710 --> 00:41:43,240
<font color="#CCCCCC">his work pc which wasn't</font><font color="#E5E5E5"> exactly what i</font>

1184
00:41:41,920 --> 00:41:44,740
wanted basically so

1185
00:41:43,240 --> 00:41:48,368
just popped up a Java applet and<font color="#E5E5E5"> he</font>

1186
00:41:44,740 --> 00:41:50,410
clicked run happy days i got my shell so

1187
00:41:48,369 --> 00:41:52,330
Michael may or may not have sent me some

1188
00:41:50,410 --> 00:41:55,618
very very harsh messages after this

1189
00:41:52,330 --> 00:41:59,080
because he found<font color="#E5E5E5"> out about what we did</font>

1190
00:41:55,619 --> 00:42:01,090
so because so much so when I got<font color="#CCCCCC"> on his</font>

1191
00:41:59,080 --> 00:42:02,170
machine he actually must have gone home

1192
00:42:01,090 --> 00:42:03,700
<font color="#CCCCCC">and told his wife about listen</font>

1193
00:42:02,170 --> 00:42:05,590
everything that you've got a new job

1194
00:42:03,700 --> 00:42:07,000
potentially he was searching to kit out

1195
00:42:05,590 --> 00:42:09,460
his home office so he's searching for

1196
00:42:07,000 --> 00:42:12,130
chairs and curries he was looking to<font color="#E5E5E5"> buy</font>

1197
00:42:09,460 --> 00:42:16,960
a printer and I did<font color="#CCCCCC"> kind of feel quite</font>

1198
00:42:12,130 --> 00:42:18,280
bad at<font color="#E5E5E5"> this point but he had the key to</font>

1199
00:42:16,960 --> 00:42:20,050
the kingdom he was pretty<font color="#E5E5E5"> much done any</font>

1200
00:42:18,280 --> 00:42:22,390
firewall switch and<font color="#CCCCCC"> Rueter within the</font>

1201
00:42:20,050 --> 00:42:23,770
organization so I didn't<font color="#CCCCCC"> have to move so</font>

1202
00:42:22,390 --> 00:42:25,660
like why I was saying back<font color="#E5E5E5"> at the start</font>

1203
00:42:23,770 --> 00:42:27,130
I picked the right guy to target I

1204
00:42:25,660 --> 00:42:29,410
didn't have<font color="#E5E5E5"> to</font><font color="#CCCCCC"> doing lateral</font><font color="#E5E5E5"> movement so</font>

1205
00:42:27,130 --> 00:42:31,119
it's fairly easy it could have<font color="#E5E5E5"> been</font>

1206
00:42:29,410 --> 00:42:32,618
worse i could have been<font color="#E5E5E5"> my mate who</font>

1207
00:42:31,119 --> 00:42:34,510
decided<font color="#E5E5E5"> to put this as</font><font color="#CCCCCC"> his linkedin</font>

1208
00:42:32,619 --> 00:42:40,030
profile could have broke his marriage up

1209
00:42:34,510 --> 00:42:42,070
button so it can always be worse so

1210
00:42:40,030 --> 00:42:43,780
lateral movement so a lateral movements

1211
00:42:42,070 --> 00:42:45,490
a key<font color="#E5E5E5"> point in the cyber kill chain and</font>

1212
00:42:43,780 --> 00:42:48,369
it's it's where you would act on<font color="#E5E5E5"> your</font>

1213
00:42:45,490 --> 00:42:50,229
objectives so<font color="#CCCCCC"> I've talked</font><font color="#E5E5E5"> about MSF</font>

1214
00:42:48,369 --> 00:42:52,510
quite a bit the socks proxy<font color="#E5E5E5"> kept</font>

1215
00:42:50,230 --> 00:42:54,100
<font color="#E5E5E5">religion</font><font color="#CCCCCC"> MSF is pretty awesome it allows</font>

1216
00:42:52,510 --> 00:42:56,109
you to sort<font color="#E5E5E5"> proxy change any of your</font>

1217
00:42:54,100 --> 00:42:59,080
tools in Windows or Linux through that

1218
00:42:56,109 --> 00:43:01,450
initial shell there's another way you

1219
00:42:59,080 --> 00:43:03,520
can do as well with CNT lamb and ssh and

1220
00:43:01,450 --> 00:43:06,009
<font color="#CCCCCC">sh proxy server but it's not quite</font><font color="#E5E5E5"> as</font>

1221
00:43:03,520 --> 00:43:08,290
cute as mass for you or another<font color="#E5E5E5"> way you</font>

1222
00:43:06,010 --> 00:43:13,660
can latch remove is using wmi<font color="#CCCCCC"> and win RM</font>

1223
00:43:08,290 --> 00:43:15,640
within within windows so citrix servers

1224
00:43:13,660 --> 00:43:18,339
are often a great target so when<font color="#E5E5E5"> i get</font>

1225
00:43:15,640 --> 00:43:20,770
<font color="#CCCCCC">on and it on my initial foothold on side</font>

1226
00:43:18,340 --> 00:43:22,570
the laptop or desktop the way often try

1227
00:43:20,770 --> 00:43:23,950
and escalate privileges is either on the

1228
00:43:22,570 --> 00:43:25,660
machine itself which sometimes<font color="#CCCCCC"> is</font><font color="#E5E5E5"> will</font>

1229
00:43:23,950 --> 00:43:28,149
lock down fairly well or often go into

1230
00:43:25,660 --> 00:43:29,950
<font color="#CCCCCC">the citrix servers so once I've gotten</font>

1231
00:43:28,150 --> 00:43:31,300
with pushy too then I'll<font color="#CCCCCC"> an install</font>

1232
00:43:29,950 --> 00:43:33,160
<font color="#CCCCCC">Matt's ploy to use the socks proxy</font>

1233
00:43:31,300 --> 00:43:35,890
capabilities and then I'll acts and I'll

1234
00:43:33,160 --> 00:43:38,470
access the<font color="#E5E5E5"> Citrix server once on the</font>

1235
00:43:35,890 --> 00:43:40,509
<font color="#CCCCCC">Citrix server so I'm</font><font color="#E5E5E5"> going to be ahead</font>

1236
00:43:38,470 --> 00:43:41,618
I'll get<font color="#E5E5E5"> on</font><font color="#CCCCCC"> to the after so this is</font><font color="#E5E5E5"> the</font>

1237
00:43:40,510 --> 00:43:43,840
socks proxy capabilities of the

1238
00:43:41,619 --> 00:43:46,720
<font color="#CCCCCC">metasploit allows you to use any</font><font color="#E5E5E5"> of your</font>

1239
00:43:43,840 --> 00:43:50,530
normal<font color="#E5E5E5"> tools so</font><font color="#CCCCCC"> you can just use Medusa</font>

1240
00:43:46,720 --> 00:43:53,140
and map rdp SMB<font color="#CCCCCC"> map so all these tools</font>

1241
00:43:50,530 --> 00:43:54,970
you can use just because proxy chains

1242
00:43:53,140 --> 00:43:56,259
allows it to go formats Floyd so it is<font color="#E5E5E5"> a</font>

1243
00:43:54,970 --> 00:43:57,430
great way you've<font color="#CCCCCC"> been able</font><font color="#E5E5E5"> to latch</font>

1244
00:43:56,260 --> 00:44:00,310
move once you've got your initial

1245
00:43:57,430 --> 00:44:02,560
foothold within max<font color="#E5E5E5"> bullying sometimes</font>

1246
00:44:00,310 --> 00:44:04,509
it's really<font color="#E5E5E5"> quite easy because people</font>

1247
00:44:02,560 --> 00:44:05,799
just have a nice pass word<font color="#CCCCCC"> doc file</font>

1248
00:44:04,510 --> 00:44:09,190
which has got<font color="#E5E5E5"> all their passwords even</font>

1249
00:44:05,800 --> 00:44:10,720
for national lottery but what<font color="#E5E5E5"> I was</font>

1250
00:44:09,190 --> 00:44:12,700
saying<font color="#CCCCCC"> before was going back to</font><font color="#E5E5E5"> lateral</font>

1251
00:44:10,720 --> 00:44:14,740
movement and<font color="#E5E5E5"> Citrix so this is an</font>

1252
00:44:12,700 --> 00:44:17,049
example so i actually<font color="#CCCCCC"> use a socks proxy</font>

1253
00:44:14,740 --> 00:44:19,180
server to rdp my connection on to citrix

1254
00:44:17,050 --> 00:44:20,680
once i<font color="#E5E5E5"> was on citrix i could access all</font>

1255
00:44:19,180 --> 00:44:21,910
the banking applications but<font color="#E5E5E5"> while</font><font color="#CCCCCC"> i</font>

1256
00:44:20,680 --> 00:44:23,799
wanted to do<font color="#E5E5E5"> was just escalate</font>

1257
00:44:21,910 --> 00:44:26,109
privileges at<font color="#CCCCCC"> this point so i was able</font>

1258
00:44:23,800 --> 00:44:29,370
to basically use the winners<font color="#E5E5E5"> explorer to</font>

1259
00:44:26,110 --> 00:44:31,810
navigate to powershell open<font color="#E5E5E5"> powershell</font>

1260
00:44:29,370 --> 00:44:33,819
because I know citrix servers are used

1261
00:44:31,810 --> 00:44:35,529
all the time people tend not to reboot

1262
00:44:33,820 --> 00:44:38,410
them so obviously for that note they're

1263
00:44:35,530 --> 00:44:39,760
probably not patched so<font color="#E5E5E5"> i used ms 1632</font>

1264
00:44:38,410 --> 00:44:41,500
which is one of the<font color="#CCCCCC"> lates privilege</font>

1265
00:44:39,760 --> 00:44:45,250
escalation vulnerabilities to allow me

1266
00:44:41,500 --> 00:44:46,510
to<font color="#E5E5E5"> go from nothing to system when</font><font color="#CCCCCC"> i was</font>

1267
00:44:45,250 --> 00:44:47,950
on<font color="#E5E5E5"> the system when i was on a system</font>

1268
00:44:46,510 --> 00:44:50,400
obviously you can dump<font color="#E5E5E5"> the clear text</font>

1269
00:44:47,950 --> 00:44:52,450
passwords out and memory of which<font color="#CCCCCC"> i did</font>

1270
00:44:50,400 --> 00:44:58,240
which was quite ironic because the

1271
00:44:52,450 --> 00:45:00,490
password<font color="#E5E5E5"> was suck at red team at this</font>

1272
00:44:58,240 --> 00:45:02,770
point this guy<font color="#E5E5E5"> that i got the password</font>

1273
00:45:00,490 --> 00:45:05,020
for was da as they will enter laps we

1274
00:45:02,770 --> 00:45:08,380
<font color="#E5E5E5">moved to the domain controller add users</font>

1275
00:45:05,020 --> 00:45:12,790
just for an<font color="#E5E5E5"> IR sort of case access other</font>

1276
00:45:08,380 --> 00:45:14,410
citrix applications<font color="#CCCCCC"> i was able to even</font>

1277
00:45:12,790 --> 00:45:16,210
log into that basically the money place

1278
00:45:14,410 --> 00:45:18,460
where you can approve and reject

1279
00:45:16,210 --> 00:45:20,500
payments from one system to another<font color="#E5E5E5"> i</font>

1280
00:45:18,460 --> 00:45:22,690
was able to download<font color="#CCCCCC"> all their PDF</font>

1281
00:45:20,500 --> 00:45:24,850
copies of all their agreements again

1282
00:45:22,690 --> 00:45:26,200
access the banking information another

1283
00:45:24,850 --> 00:45:29,110
one which is<font color="#E5E5E5"> quite interesting is the</font>

1284
00:45:26,200 --> 00:45:31,000
database stuff so sometimes<font color="#CCCCCC"> they might</font>

1285
00:45:29,110 --> 00:45:32,440
have<font color="#CCCCCC"> Imperva which logs date risk</font>

1286
00:45:31,000 --> 00:45:34,180
connections to and from a client and

1287
00:45:32,440 --> 00:45:35,980
server but what's go interest<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> r</font>

1288
00:45:34,180 --> 00:45:38,259
DP<font color="#E5E5E5"> onto the server and access it</font><font color="#CCCCCC"> via the</font>

1289
00:45:35,980 --> 00:45:39,520
MS SQL management agent that isn't

1290
00:45:38,260 --> 00:45:41,020
logged within<font color="#CCCCCC"> Imperva so that's just</font>

1291
00:45:39,520 --> 00:45:42,250
another way to think about it if you've

1292
00:45:41,020 --> 00:45:44,050
<font color="#E5E5E5">been quite stealthy and don't to get</font>

1293
00:45:42,250 --> 00:45:49,270
caught that's<font color="#CCCCCC"> a good way</font><font color="#E5E5E5"> to access the</font>

1294
00:45:44,050 --> 00:45:51,460
database so all that<font color="#CCCCCC"> is kind of how I</font>

1295
00:45:49,270 --> 00:45:53,200
would do a red teaming engagement and

1296
00:45:51,460 --> 00:45:54,880
that's kind of how we built a tool so to

1297
00:45:53,200 --> 00:45:56,410
start with<font color="#E5E5E5"> I create a wiki which had</font>

1298
00:45:54,880 --> 00:45:57,340
basically all these different tasks that

1299
00:45:56,410 --> 00:45:59,830
I would do with all these different

1300
00:45:57,340 --> 00:46:01,210
tools and I thought well when I just you

1301
00:45:59,830 --> 00:46:03,700
know create our own off the back of what

1302
00:46:01,210 --> 00:46:05,110
we did<font color="#E5E5E5"> and within powershell in</font>

1303
00:46:03,700 --> 00:46:08,549
<font color="#E5E5E5">metasploit so we created something</font>

1304
00:46:05,110 --> 00:46:10,559
called<font color="#CCCCCC"> paschi to me and Dave Hardy</font>

1305
00:46:08,549 --> 00:46:12,239
so there's<font color="#E5E5E5"> 12 reasons I</font><font color="#CCCCCC"> think you should</font>

1306
00:46:10,559 --> 00:46:14,069
<font color="#CCCCCC">probably have a look at Part C 2 and</font>

1307
00:46:12,239 --> 00:46:17,069
it's maintained free and open source

1308
00:46:14,069 --> 00:46:18,799
it's inspired by imported by the<font color="#E5E5E5"> MSF</font>

1309
00:46:17,069 --> 00:46:21,299
stuff we did back in April last year

1310
00:46:18,799 --> 00:46:23,249
it's a great way of learning<font color="#CCCCCC"> PowerShell</font>

1311
00:46:21,299 --> 00:46:24,689
and a phased approach so it doesn't just

1312
00:46:23,249 --> 00:46:25,558
<font color="#CCCCCC">Chuck you</font><font color="#E5E5E5"> in the deep end of learning</font>

1313
00:46:24,689 --> 00:46:27,178
PowerShell like you've gotta know

1314
00:46:25,559 --> 00:46:29,069
<font color="#E5E5E5">PowerShell you can just run known</font>

1315
00:46:27,179 --> 00:46:31,619
modules and command 'let's so it<font color="#E5E5E5"> is</font>

1316
00:46:29,069 --> 00:46:33,029
<font color="#E5E5E5">quite easy like</font><font color="#CCCCCC"> metasploit but also it</font>

1317
00:46:31,619 --> 00:46:35,369
allows you to get quite dirty and

1318
00:46:33,029 --> 00:46:37,319
powershell if you want to so you can

1319
00:46:35,369 --> 00:46:39,869
write your own modules and add them it

1320
00:46:37,319 --> 00:46:42,719
all uses ASM encrypted communications

1321
00:46:39,869 --> 00:46:43,979
we've added an auto kill switch so<font color="#CCCCCC"> it</font>

1322
00:46:42,719 --> 00:46:45,209
<font color="#CCCCCC">just reduces the risks or an</font>

1323
00:46:43,979 --> 00:46:46,288
organization so if you're going<font color="#E5E5E5"> to do</font>

1324
00:46:45,209 --> 00:46:48,359
this type of engagement there might be

1325
00:46:46,289 --> 00:46:49,589
worried<font color="#CCCCCC"> that what happens in four weeks</font>

1326
00:46:48,359 --> 00:46:50,880
and<font color="#E5E5E5"> you've still got a shell if I won no</font>

1327
00:46:49,589 --> 00:46:52,949
we won't because we'll have<font color="#E5E5E5"> it have a</font>

1328
00:46:50,880 --> 00:46:54,239
kill date of two weeks anything<font color="#E5E5E5"> after</font>

1329
00:46:52,949 --> 00:46:55,890
that<font color="#E5E5E5"> date will automatically get killed</font>

1330
00:46:54,239 --> 00:46:56,880
so it just reduces the risk a little bit

1331
00:46:55,890 --> 00:46:59,549
and they're probably more likely to go

1332
00:46:56,880 --> 00:47:01,339
for a red team engagement it's not<font color="#CCCCCC"> only</font>

1333
00:46:59,549 --> 00:47:03,239
red teaming you<font color="#E5E5E5"> can use on</font><font color="#CCCCCC"> pentesting</font>

1334
00:47:01,339 --> 00:47:04,739
engagement so<font color="#CCCCCC"> I use</font><font color="#E5E5E5"> it quite often now</font>

1335
00:47:03,239 --> 00:47:06,029
because if you use in<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> you'd</font>

1336
00:47:04,739 --> 00:47:08,849
have to<font color="#CCCCCC"> think about removing anything</font>

1337
00:47:06,029 --> 00:47:11,849
it's just all in memory simple to use

1338
00:47:08,849 --> 00:47:13,739
and it's really<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> to install it will</font>

1339
00:47:11,849 --> 00:47:15,569
create you<font color="#CCCCCC"> a java payload so it only</font>

1340
00:47:13,739 --> 00:47:16,949
requires java jdk if you want it to do

1341
00:47:15,569 --> 00:47:19,109
that part of<font color="#E5E5E5"> it but it's not essential</font>

1342
00:47:16,949 --> 00:47:20,729
if you<font color="#E5E5E5"> don't want to it works on</font>

1343
00:47:19,109 --> 00:47:23,939
anything from power division 2 and above

1344
00:47:20,729 --> 00:47:26,879
witches windows 7 8 10 2008-2012 and

1345
00:47:23,939 --> 00:47:28,558
plus it's fully proxy<font color="#E5E5E5"> where so it's one</font>

1346
00:47:26,880 --> 00:47:30,569
of the main<font color="#CCCCCC"> things I've tested on quite</font>

1347
00:47:28,559 --> 00:47:32,819
a few<font color="#E5E5E5"> things I like squid TMG websites</font>

1348
00:47:30,569 --> 00:47:36,058
and Palo Alto and it all works perfectly

1349
00:47:32,819 --> 00:47:38,759
it's based on customizable HTTP beacons

1350
00:47:36,059 --> 00:47:40,529
so it's not continuous<font color="#E5E5E5"> TCP stream so you</font>

1351
00:47:38,759 --> 00:47:42,509
can set the beacon to be 60 seconds five

1352
00:47:40,529 --> 00:47:45,269
minutes<font color="#E5E5E5"> two hours and it's like that and</font>

1353
00:47:42,509 --> 00:47:46,859
it's got also a jitter of ten percent so

1354
00:47:45,269 --> 00:47:49,078
if they're looking on there like

1355
00:47:46,859 --> 00:47:50,759
firewall for everything beginning at 60

1356
00:47:49,079 --> 00:47:57,719
seconds exactly this will actually add

1357
00:47:50,759 --> 00:47:59,369
ten percent jitter to counteract<font color="#CCCCCC"> that so</font>

1358
00:47:57,719 --> 00:48:00,660
it's maintainable modular and<font color="#E5E5E5"> can be</font>

1359
00:47:59,369 --> 00:48:02,699
added in<font color="#E5E5E5"> the middle of engagement so</font>

1360
00:48:00,660 --> 00:48:04,229
it's got a folder called modules so if

1361
00:48:02,699 --> 00:48:05,459
you write your<font color="#E5E5E5"> own power shell and you</font>

1362
00:48:04,229 --> 00:48:06,928
want to just add a module quickly on the

1363
00:48:05,459 --> 00:48:08,009
fly to run it on<font color="#CCCCCC"> the engagement you can</font>

1364
00:48:06,929 --> 00:48:11,429
just<font color="#CCCCCC"> drop it into the modules folder</font>

1365
00:48:08,009 --> 00:48:13,049
load module and a way to<font color="#E5E5E5"> go with from</font>

1366
00:48:11,429 --> 00:48:14,459
the communications perspective we tested

1367
00:48:13,049 --> 00:48:16,709
against fire<font color="#E5E5E5"> iron Palo Alto and web</font>

1368
00:48:14,459 --> 00:48:18,390
since we've added some image heuristics

1369
00:48:16,709 --> 00:48:21,509
so actually if you if you take the

1370
00:48:18,390 --> 00:48:22,569
traffic from from the sea to going back

1371
00:48:21,509 --> 00:48:24,640
and forth is all yours

1372
00:48:22,570 --> 00:48:26,440
<font color="#CCCCCC">load it as though the PNG images flying</font>

1373
00:48:24,640 --> 00:48:29,290
back and forth all<font color="#E5E5E5"> the data is an</font>

1374
00:48:26,440 --> 00:48:31,150
encrypted byte stream within an image so

1375
00:48:29,290 --> 00:48:32,980
it's actually<font color="#CCCCCC"> quite hard to reverse and</font>

1376
00:48:31,150 --> 00:48:34,420
get the data back out so it just<font color="#CCCCCC"> looks</font>

1377
00:48:32,980 --> 00:48:36,730
like<font color="#E5E5E5"> images basically so it's quite good</font>

1378
00:48:34,420 --> 00:48:38,620
from that point of view and then one of

1379
00:48:36,730 --> 00:48:40,630
<font color="#E5E5E5">the most important things worse is the</font>

1380
00:48:38,620 --> 00:48:41,770
detailed output you get so when you do

1381
00:48:40,630 --> 00:48:45,070
this type of engagement you need to be

1382
00:48:41,770 --> 00:48:46,600
really sort of<font color="#CCCCCC"> time-sensitive</font><font color="#E5E5E5"> so you</font>

1383
00:48:45,070 --> 00:48:48,700
need<font color="#E5E5E5"> to say exactly what you've done and</font>

1384
00:48:46,600 --> 00:48:50,259
when you've<font color="#CCCCCC"> done it so at the end of the</font>

1385
00:48:48,700 --> 00:48:52,060
engagement<font color="#E5E5E5"> you can go to their I are</font>

1386
00:48:50,260 --> 00:48:53,830
they provided a report to say<font color="#E5E5E5"> this is</font>

1387
00:48:52,060 --> 00:48:56,290
what we saw and you need to be<font color="#E5E5E5"> able to</font>

1388
00:48:53,830 --> 00:48:57,670
collaborate with yours and say no no<font color="#E5E5E5"> we</font>

1389
00:48:56,290 --> 00:48:59,980
didn't get we didn't get for all<font color="#E5E5E5"> then</font>

1390
00:48:57,670 --> 00:49:01,570
<font color="#CCCCCC">we've got</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> here and then so just a</font>

1391
00:48:59,980 --> 00:49:03,010
synchronized time source and time

1392
00:49:01,570 --> 00:49:04,540
stamping<font color="#E5E5E5"> of everything you've done is</font>

1393
00:49:03,010 --> 00:49:06,340
really important<font color="#CCCCCC"> I'll show you a demo</font>

1394
00:49:04,540 --> 00:49:08,350
<font color="#CCCCCC">laughter but that's one of the main</font>

1395
00:49:06,340 --> 00:49:12,700
<font color="#CCCCCC">things why we wrote this and it puts it</font>

1396
00:49:08,350 --> 00:49:15,250
in a nice HTML file oh sorry puts<font color="#E5E5E5"> it in</font>

1397
00:49:12,700 --> 00:49:19,089
Nice HTML file so you can provide it to

1398
00:49:15,250 --> 00:49:20,200
the customer after<font color="#E5E5E5"> as</font><font color="#CCCCCC"> well so I was</font>

1399
00:49:19,090 --> 00:49:25,420
going to do live demo but that<font color="#E5E5E5"> went</font>

1400
00:49:20,200 --> 00:49:26,919
horribly wrong so I've got video I'll

1401
00:49:25,420 --> 00:49:31,840
slip the installation to their got much

1402
00:49:26,920 --> 00:49:34,360
time so once you've installed it and

1403
00:49:31,840 --> 00:49:35,890
basically said<font color="#E5E5E5"> how it looks you wouldn't</font>

1404
00:49:34,360 --> 00:49:37,300
use an idea just usually at the top it

1405
00:49:35,890 --> 00:49:39,190
will give you five options you would use

1406
00:49:37,300 --> 00:49:41,950
the URL or DNS name you've configured

1407
00:49:39,190 --> 00:49:43,210
for your c2 server it's going<font color="#E5E5E5"> to run</font>

1408
00:49:41,950 --> 00:49:45,040
quite quick because of em it's time but

1409
00:49:43,210 --> 00:49:48,660
basically it's<font color="#CCCCCC"> an e</font><font color="#E5E5E5"> getting a shell</font><font color="#CCCCCC"> on a</font>

1410
00:49:45,040 --> 00:49:51,660
bank it's a fake<font color="#CCCCCC"> banglar</font><font color="#E5E5E5"> I've created oh</font>

1411
00:49:48,660 --> 00:49:51,660
sorry

1412
00:50:01,000 --> 00:50:17,000
no no I can't sit yeah it specially some

1413
00:50:13,820 --> 00:50:18,650
<font color="#CCCCCC">me getting a shell on a fake bank this</font>

1414
00:50:17,000 --> 00:50:19,880
is how the implant comes in it shows you

1415
00:50:18,650 --> 00:50:21,770
the encrypted key that everything is

1416
00:50:19,880 --> 00:50:24,170
encrypted with it's all stored in SQLite

1417
00:50:21,770 --> 00:50:25,910
database you<font color="#E5E5E5"> can then on the</font><font color="#CCCCCC"> left hand</font>

1418
00:50:24,170 --> 00:50:27,590
side it opens<font color="#CCCCCC"> two windows to the left</font>

1419
00:50:25,910 --> 00:50:28,670
hand side is well the output goes the

1420
00:50:27,590 --> 00:50:32,570
round side is where you input the

1421
00:50:28,670 --> 00:50:34,430
<font color="#E5E5E5">commands so get screenshots just one a</font>

1422
00:50:32,570 --> 00:50:36,350
normal function basically just a normal

1423
00:50:34,430 --> 00:50:38,029
print screen of the<font color="#E5E5E5"> desktop that you've</font>

1424
00:50:36,350 --> 00:50:43,910
compromised you can run things<font color="#E5E5E5"> like Who</font>

1425
00:50:38,030 --> 00:50:45,200
am I you read<font color="#E5E5E5"> it now I just net users</font>

1426
00:50:43,910 --> 00:50:46,609
net you know that local group

1427
00:50:45,200 --> 00:50:47,960
administrators<font color="#E5E5E5"> these general commands</font>

1428
00:50:46,609 --> 00:50:49,759
that you'd be<font color="#E5E5E5"> able to run to is like a</font>

1429
00:50:47,960 --> 00:50:51,380
command-line interface this is weakening

1430
00:50:49,760 --> 00:50:53,750
over five seconds you can set it<font color="#CCCCCC"> to two</font>

1431
00:50:51,380 --> 00:50:55,280
seconds one second or two minutes so

1432
00:50:53,750 --> 00:50:57,380
that'll be quite stealthy but for this I

1433
00:50:55,280 --> 00:50:59,630
wanted to be quite quick so the the main

1434
00:50:57,380 --> 00:51:01,340
aim of this one I<font color="#E5E5E5"> think I'll skip the</font>

1435
00:50:59,630 --> 00:51:03,440
installations this<font color="#CCCCCC"> beta just attempts to</font>

1436
00:51:01,340 --> 00:51:07,970
escalate privileges<font color="#E5E5E5"> I'm using a number</font>

1437
00:51:03,440 --> 00:51:11,540
16 32 16 32 is out there we've just

1438
00:51:07,970 --> 00:51:12,980
incorporated it into into<font color="#E5E5E5"> pasti to that</font>

1439
00:51:11,540 --> 00:51:14,779
is hopefully will show me doing that now

1440
00:51:12,980 --> 00:51:15,980
start another implant that's<font color="#E5E5E5"> just</font>

1441
00:51:14,780 --> 00:51:17,930
another way of getting another implant

1442
00:51:15,980 --> 00:51:20,359
so once you've got one again you<font color="#CCCCCC"> don't</font>

1443
00:51:17,930 --> 00:51:21,740
you're not to die or to<font color="#CCCCCC"> timeout</font><font color="#E5E5E5"> so you</font>

1444
00:51:20,359 --> 00:51:24,650
always do start another implant gives

1445
00:51:21,740 --> 00:51:26,990
you a back at one so we're<font color="#E5E5E5"> quite</font>

1446
00:51:24,650 --> 00:51:30,230
interactive it's got a helpline so just

1447
00:51:26,990 --> 00:51:32,540
type help it's literally to basically to

1448
00:51:30,230 --> 00:51:34,490
powershell scripts it's all readable you

1449
00:51:32,540 --> 00:51:35,930
can edit it it's got modules folder it's

1450
00:51:34,490 --> 00:51:37,790
fairly module know this is all the

1451
00:51:35,930 --> 00:51:39,500
modules that we put in I haven't<font color="#CCCCCC"> written</font>

1452
00:51:37,790 --> 00:51:41,119
all these by the<font color="#E5E5E5"> way and these are</font><font color="#CCCCCC"> all</font>

1453
00:51:39,500 --> 00:51:42,410
just the decent scripts that are out

1454
00:51:41,119 --> 00:51:43,820
there and command lets that already out

1455
00:51:42,410 --> 00:51:46,399
<font color="#CCCCCC">in</font><font color="#E5E5E5"> there by sort of harm</font><font color="#CCCCCC"> join matt</font>

1456
00:51:43,820 --> 00:51:47,900
<font color="#CCCCCC">graber and i wrote a few of the</font>

1457
00:51:46,400 --> 00:51:49,280
functions like get proxy because this is

1458
00:51:47,900 --> 00:51:50,750
some<font color="#E5E5E5"> of the things i'd want to do when I</font>

1459
00:51:49,280 --> 00:51:52,850
want<font color="#E5E5E5"> an engagement but it's basically</font>

1460
00:51:50,750 --> 00:51:55,010
<font color="#E5E5E5">just running basically a registry</font>

1461
00:51:52,850 --> 00:51:56,540
command at the<font color="#CCCCCC"> background everything as</font>

1462
00:51:55,010 --> 00:51:57,830
well so everything<font color="#E5E5E5"> I've written like get</font>

1463
00:51:56,540 --> 00:51:59,330
proxy it tells you exactly what the

1464
00:51:57,830 --> 00:52:00,619
command is because I want it to be quite

1465
00:51:59,330 --> 00:52:05,930
transparent I want you to learn how<font color="#E5E5E5"> to</font>

1466
00:52:00,619 --> 00:52:07,430
use PowerShell as well so crab pop is a

1467
00:52:05,930 --> 00:52:08,839
good one so that basically pops up the

1468
00:52:07,430 --> 00:52:10,730
<font color="#E5E5E5">screen on the desktop same outlook</font>

1469
00:52:08,840 --> 00:52:11,869
requires your credentials so to do

1470
00:52:10,730 --> 00:52:12,650
anything usually you need to have

1471
00:52:11,869 --> 00:52:14,720
credentials

1472
00:52:12,650 --> 00:52:16,369
and it don't know how many<font color="#CCCCCC"> times my</font>

1473
00:52:14,720 --> 00:52:17,930
machine<font color="#CCCCCC"> ask me that so it's</font><font color="#E5E5E5"> not</font>

1474
00:52:16,369 --> 00:52:21,799
<font color="#E5E5E5">something that that wouldn't be familiar</font>

1475
00:52:17,930 --> 00:52:23,240
to the person everything that<font color="#CCCCCC"> you put</font>

1476
00:52:21,799 --> 00:52:25,788
into like the<font color="#E5E5E5"> screenshots will be in</font>

1477
00:52:23,240 --> 00:52:27,078
<font color="#E5E5E5">here so this is just an example so this</font>

1478
00:52:25,789 --> 00:52:29,599
<font color="#CCCCCC">is a screenshot of the desktop that I've</font>

1479
00:52:27,079 --> 00:52:30,349
actually managed to capture you can

1480
00:52:29,599 --> 00:52:32,029
<font color="#CCCCCC">actually sit there just doing</font>

1481
00:52:30,349 --> 00:52:33,619
screenshots and often it's quite good

1482
00:52:32,029 --> 00:52:35,180
just to sit<font color="#E5E5E5"> there watching what the</font>

1483
00:52:33,619 --> 00:52:36,289
person does because they're the<font color="#E5E5E5"> person</font>

1484
00:52:35,180 --> 00:52:38,058
who knows<font color="#CCCCCC"> how to</font><font color="#E5E5E5"> use this banking</font>

1485
00:52:36,289 --> 00:52:39,920
application<font color="#E5E5E5"> I'm here coming in as an</font>

1486
00:52:38,059 --> 00:52:41,660
outsider wanting to use the application

1487
00:52:39,920 --> 00:52:43,039
I have no<font color="#E5E5E5"> idea just sitting there</font>

1488
00:52:41,660 --> 00:52:44,270
watching is often a really good way of

1489
00:52:43,039 --> 00:52:51,289
sort<font color="#E5E5E5"> of learning how to</font><font color="#CCCCCC"> use the</font>

1490
00:52:44,270 --> 00:52:53,750
application so creating a proxy payload

1491
00:52:51,289 --> 00:52:55,190
so everything like i<font color="#E5E5E5"> said is proxy aware</font>

1492
00:52:53,750 --> 00:52:56,809
but you need to be<font color="#CCCCCC"> able to tell it what</font>

1493
00:52:55,190 --> 00:52:58,400
<font color="#CCCCCC">the proxy credentials are so I'll</font>

1494
00:52:56,809 --> 00:52:59,990
<font color="#CCCCCC">escalate in previous now to system as i</font>

1495
00:52:58,400 --> 00:53:02,119
said before system wouldn't know how to

1496
00:52:59,990 --> 00:53:03,709
get out so what you<font color="#E5E5E5"> got to do is create</font>

1497
00:53:02,119 --> 00:53:05,930
a proxy payload and tell her what the

1498
00:53:03,710 --> 00:53:08,210
URL is which obviously the URL i found

1499
00:53:05,930 --> 00:53:10,069
out from the from<font color="#CCCCCC"> the registry and i've</font>

1500
00:53:08,210 --> 00:53:12,260
got the credentials now so now i can

1501
00:53:10,069 --> 00:53:22,220
create my proxy where payload and

1502
00:53:12,260 --> 00:53:23,539
hopefully exploit ms 1632 so instead of

1503
00:53:22,220 --> 00:53:26,029
touching<font color="#CCCCCC"> disk I've introduced something</font>

1504
00:53:23,539 --> 00:53:28,730
recently which is named pipes so in

1505
00:53:26,029 --> 00:53:31,910
<font color="#E5E5E5">PowerShell especially in the exploit in</font>

1506
00:53:28,730 --> 00:53:33,319
the export world where Emma<font color="#E5E5E5"> 1632 works</font>

1507
00:53:31,910 --> 00:53:35,629
as a race condition and starts a new

1508
00:53:33,319 --> 00:53:37,069
process you're only allowed one or two

1509
00:53:35,630 --> 00:53:38,720
<font color="#E5E5E5">four bits well when you create a</font>

1510
00:53:37,069 --> 00:53:40,339
PowerShell proxy payload that's bigger

1511
00:53:38,720 --> 00:53:42,348
than that so the<font color="#CCCCCC"> way I've done it is to</font>

1512
00:53:40,339 --> 00:53:44,058
set up a named pipe so exactly<font color="#E5E5E5"> what</font>

1513
00:53:42,349 --> 00:53:46,220
<font color="#E5E5E5">doing now so it sets up a local named</font>

1514
00:53:44,059 --> 00:53:48,230
pipes and powershell and then it gets

1515
00:53:46,220 --> 00:53:49,609
the data from from the name pipe and

1516
00:53:48,230 --> 00:53:51,500
that's that's allowed me to get it less

1517
00:53:49,609 --> 00:54:02,598
<font color="#CCCCCC">than 1024 bytes</font><font color="#E5E5E5"> so that's what it's</font>

1518
00:53:51,500 --> 00:54:04,510
doing yeah<font color="#E5E5E5"> hopefully I won't keep you</font>

1519
00:54:02,599 --> 00:54:13,670
much longer

1520
00:54:04,510 --> 00:54:14,869
coffee's on the<font color="#E5E5E5"> rise so it'll</font>

1521
00:54:13,670 --> 00:54:16,880
automatically loads of modules as well

1522
00:54:14,869 --> 00:54:18,260
if it knows about the module so if you

1523
00:54:16,880 --> 00:54:19,940
add one it won't automatically load it

1524
00:54:18,260 --> 00:54:21,800
so you can<font color="#CCCCCC"> just click load module and</font>

1525
00:54:19,940 --> 00:54:23,089
then either no power view ps1 or

1526
00:54:21,800 --> 00:54:25,160
whatever and there we<font color="#CCCCCC"> go we've got</font><font color="#E5E5E5"> our</font>

1527
00:54:23,089 --> 00:54:26,930
system shell there so now<font color="#E5E5E5"> I can use it</font>

1528
00:54:25,160 --> 00:54:28,848
go back up here<font color="#E5E5E5"> see all my implants on</font>

1529
00:54:26,930 --> 00:54:35,890
<font color="#E5E5E5">the right Who am I and it should then</font>

1530
00:54:28,849 --> 00:54:35,890
come over<font color="#E5E5E5"> in tell me I'm system yeah</font>

1531
00:54:37,240 --> 00:54:41,720
yeah bank system so that's me escalating

1532
00:54:40,099 --> 00:54:46,480
privileges all through a firewall

1533
00:54:41,720 --> 00:54:46,480
laterally moving and proxy<font color="#CCCCCC"> where system</font>

1534
00:54:53,650 --> 00:55:01,520
like<font color="#CCCCCC"> on yeah so this is</font><font color="#E5E5E5"> created by me</font>

1535
00:54:59,300 --> 00:55:03,589
and<font color="#E5E5E5"> Dave a laser said we want to create</font>

1536
00:55:01,520 --> 00:55:05,240
more integrate payload methods like<font color="#E5E5E5"> HD n</font>

1537
00:55:03,589 --> 00:55:07,130
click once<font color="#CCCCCC"> we want to</font><font color="#E5E5E5"> create a</font>

1538
00:55:05,240 --> 00:55:08,810
<font color="#CCCCCC">daisy-chain method so that once you're</font>

1539
00:55:07,130 --> 00:55:10,579
inside an organization not every machine

1540
00:55:08,810 --> 00:55:12,078
has to connect out it can all connect

1541
00:55:10,579 --> 00:55:14,540
out via the one the first pivot

1542
00:55:12,079 --> 00:55:15,829
basically and implement process

1543
00:55:14,540 --> 00:55:16,970
migration which we've already done now

1544
00:55:15,829 --> 00:55:19,520
so you can actually migrate to other

1545
00:55:16,970 --> 00:55:22,189
processes<font color="#E5E5E5"> I want to add more modules</font>

1546
00:55:19,520 --> 00:55:24,259
like capturing traffic autocompletes and

1547
00:55:22,190 --> 00:55:27,530
things like that feel free to do pull

1548
00:55:24,260 --> 00:55:30,170
requests it's all on github and on the

1549
00:55:27,530 --> 00:55:33,740
labs<font color="#CCCCCC"> nachi website so have a</font><font color="#E5E5E5"> look feel</font>

1550
00:55:30,170 --> 00:55:35,720
free to<font color="#E5E5E5"> hit me up just quickly this is</font>

1551
00:55:33,740 --> 00:55:37,640
the logging basically this<font color="#E5E5E5"> is our</font>

1552
00:55:35,720 --> 00:55:39,529
outputs it outputs two files it tells

1553
00:55:37,640 --> 00:55:40,910
you<font color="#CCCCCC"> exactly what implants you've got and</font>

1554
00:55:39,530 --> 00:55:42,800
what host they're on and when you got

1555
00:55:40,910 --> 00:55:44,660
them and when it last communicated and

1556
00:55:42,800 --> 00:55:46,760
alltel also tells you exactly what time

1557
00:55:44,660 --> 00:55:49,009
you ran each command and the output of

1558
00:55:46,760 --> 00:55:53,000
each command so it's great<font color="#E5E5E5"> for like a</font>

1559
00:55:49,010 --> 00:55:55,210
red team vs blue team so thank you very

1560
00:55:53,000 --> 00:55:55,210
<font color="#E5E5E5">much</font>

1561
00:55:56,190 --> 00:55:58,250
you

