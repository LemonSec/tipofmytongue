1
00:00:05,720 --> 00:00:11,309
thank you very<font color="#E5E5E5"> much so</font>

2
00:00:08,510 --> 00:00:13,889
<font color="#CCCCCC">wow this is a large audience didn't</font>

3
00:00:11,309 --> 00:00:18,270
expect this<font color="#E5E5E5"> but yeah</font><font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> cool</font><font color="#CCCCCC"> first</font>

4
00:00:13,889 --> 00:00:20,669
<font color="#E5E5E5">time</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> besides I'm</font><font color="#CCCCCC"> super fun so today</font>

5
00:00:18,270 --> 00:00:23,880
I'm going to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> talking about apt 15</font>

6
00:00:20,670 --> 00:00:25,289
also known as key chain or<font color="#E5E5E5"> Mirage</font><font color="#CCCCCC"> and</font>

7
00:00:23,880 --> 00:00:29,880
the reason I'm talking<font color="#E5E5E5"> about</font>

8
00:00:25,289 --> 00:00:31,890
<font color="#CCCCCC">EPG</font><font color="#E5E5E5"> 15 is that last year</font><font color="#CCCCCC"> NCC cyber</font>

9
00:00:29,880 --> 00:00:33,510
<font color="#E5E5E5">defense operations team were involved in</font>

10
00:00:31,890 --> 00:00:37,950
<font color="#CCCCCC">an investigation</font><font color="#E5E5E5"> that was</font><font color="#CCCCCC"> attributed to</font>

11
00:00:33,510 --> 00:00:42,989
apt<font color="#E5E5E5"> 15 and during</font><font color="#CCCCCC"> that investigation we</font>

12
00:00:37,950 --> 00:00:46,500
were able<font color="#CCCCCC"> to uncover more</font><font color="#E5E5E5"> than 200</font><font color="#CCCCCC"> C 2</font>

13
00:00:42,989 --> 00:00:48,360
commands from compromised<font color="#E5E5E5"> hosts which</font>

14
00:00:46,500 --> 00:00:50,449
gave us<font color="#E5E5E5"> a very</font><font color="#CCCCCC"> good insight into</font><font color="#E5E5E5"> the</font>

15
00:00:48,360 --> 00:00:54,840
<font color="#E5E5E5">operation of the</font><font color="#CCCCCC"> group owner</font><font color="#E5E5E5"> on a</font>

16
00:00:50,449 --> 00:00:57,870
<font color="#E5E5E5">compromised network</font><font color="#CCCCCC"> we also managed to</font>

17
00:00:54,840 --> 00:00:59,219
<font color="#E5E5E5">retrieve several back towards tools that</font>

18
00:00:57,870 --> 00:01:04,349
were used by the group which I'm going

19
00:00:59,219 --> 00:01:07,290
<font color="#E5E5E5">to discuss today</font><font color="#CCCCCC"> but before I do so</font><font color="#E5E5E5"> I'd</font>

20
00:01:04,349 --> 00:01:09,809
like first to so basically<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> first</font>

21
00:01:07,290 --> 00:01:12,119
give<font color="#CCCCCC"> a brief</font><font color="#E5E5E5"> overview of who</font><font color="#CCCCCC"> apt 15 is</font>

22
00:01:09,810 --> 00:01:16,909
for the audience here don't know<font color="#E5E5E5"> you</font>

23
00:01:12,119 --> 00:01:18,960
know what's what's apt number me<font color="#E5E5E5"> and</font>

24
00:01:16,909 --> 00:01:21,509
then I'll talk<font color="#CCCCCC"> about the case that we</font>

25
00:01:18,960 --> 00:01:25,889
were<font color="#CCCCCC"> involved in</font><font color="#E5E5E5"> and then the tools so</font>

26
00:01:21,509 --> 00:01:29,909
what was apt 15<font color="#CCCCCC"> apt 15 first came</font><font color="#E5E5E5"> into</font>

27
00:01:25,890 --> 00:01:32,180
public attention<font color="#E5E5E5"> in 2014 and that</font><font color="#CCCCCC"> was</font>

28
00:01:29,909 --> 00:01:35,340
when fire I polished the report

29
00:01:32,180 --> 00:01:40,979
<font color="#CCCCCC">operation keychain that was around the</font>

30
00:01:35,340 --> 00:01:43,320
same<font color="#E5E5E5"> time that the so the campaign</font>

31
00:01:40,979 --> 00:01:45,840
<font color="#CCCCCC">keychain was around the same time as the</font>

32
00:01:43,320 --> 00:01:48,789
g20<font color="#CCCCCC"> summit I believe at that point in</font>

33
00:01:45,840 --> 00:01:50,060
<font color="#CCCCCC">time I was during the Syrian crisis and</font>

34
00:01:48,790 --> 00:01:53,939
[Music]

35
00:01:50,060 --> 00:01:56,280
they managed<font color="#E5E5E5"> to get access to a</font><font color="#CCCCCC"> situ for</font>

36
00:01:53,939 --> 00:01:59,219
a brief period<font color="#E5E5E5"> of</font><font color="#CCCCCC"> time I believe less</font>

37
00:01:56,280 --> 00:02:01,380
than a day<font color="#E5E5E5"> and they managed to get</font>

38
00:01:59,219 --> 00:02:05,059
inside<font color="#E5E5E5"> into the</font><font color="#CCCCCC"> campaign's that were</font>

39
00:02:01,380 --> 00:02:09,478
operated<font color="#CCCCCC"> by apt 15 at the time they</font>

40
00:02:05,060 --> 00:02:12,410
managed to<font color="#E5E5E5"> get insight</font><font color="#CCCCCC"> into the tools</font>

41
00:02:09,479 --> 00:02:15,650
used<font color="#E5E5E5"> by the group and</font><font color="#CCCCCC"> they</font>

42
00:02:12,410 --> 00:02:18,650
I found out that<font color="#CCCCCC"> actually they were</font>

43
00:02:15,650 --> 00:02:21,140
targeting several ministries of Foreign

44
00:02:18,650 --> 00:02:23,030
Affairs<font color="#E5E5E5"> in this campaign in several</font>

45
00:02:21,140 --> 00:02:27,019
European countries<font color="#E5E5E5"> different industries</font>

46
00:02:23,030 --> 00:02:32,900
as well<font color="#CCCCCC"> but definitely there was a focus</font>

47
00:02:27,020 --> 00:02:34,460
on<font color="#E5E5E5"> government entities per se and they</font>

48
00:02:32,900 --> 00:02:39,380
estimated<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the group had been on</font>

49
00:02:34,460 --> 00:02:41,210
operation since at least 2010<font color="#E5E5E5"> typical</font>

50
00:02:39,380 --> 00:02:45,500
mode of operation involves<font color="#E5E5E5"> spear fishing</font>

51
00:02:41,210 --> 00:02:48,580
targets<font color="#E5E5E5"> so attachments emails to targets</font>

52
00:02:45,500 --> 00:02:51,710
<font color="#E5E5E5">look very familiar look very reasonable</font>

53
00:02:48,580 --> 00:02:54,350
<font color="#E5E5E5">and yet they would leverage typically</font>

54
00:02:51,710 --> 00:02:59,410
<font color="#CCCCCC">word vulnerabilities in order to</font>

55
00:02:54,350 --> 00:03:03,859
ultimately get the<font color="#E5E5E5"> backdoor on victims</font>

56
00:02:59,410 --> 00:03:06,799
<font color="#E5E5E5">from 2014 to 2016 nothing has</font><font color="#CCCCCC"> been</font>

57
00:03:03,860 --> 00:03:07,610
published about<font color="#E5E5E5"> apt 15 at least in the</font>

58
00:03:06,800 --> 00:03:11,620
<font color="#CCCCCC">public domain</font>

59
00:03:07,610 --> 00:03:13,970
until<font color="#E5E5E5"> Palo Alto release the blog</font><font color="#CCCCCC"> posts</font>

60
00:03:11,620 --> 00:03:15,980
<font color="#E5E5E5">discussing</font><font color="#CCCCCC"> tide pool which was a</font>

61
00:03:13,970 --> 00:03:19,490
campaign<font color="#CCCCCC"> again that was attributed to a</font>

62
00:03:15,980 --> 00:03:21,980
<font color="#CCCCCC">fifty fifteen and the campaign was</font>

63
00:03:19,490 --> 00:03:25,959
<font color="#E5E5E5">targeting several</font><font color="#CCCCCC"> Indian embassies this</font>

64
00:03:21,980 --> 00:03:28,310
time there again they were leveraging

65
00:03:25,959 --> 00:03:31,100
where its vulnerability<font color="#E5E5E5"> in order to</font>

66
00:03:28,310 --> 00:03:34,250
ultimately<font color="#E5E5E5"> launch tide pool which was a</font>

67
00:03:31,100 --> 00:03:36,200
<font color="#CCCCCC">backdoor that</font><font color="#E5E5E5"> what an evolution from</font>

68
00:03:34,250 --> 00:03:41,110
previous factors that fire<font color="#CCCCCC"> are discussed</font>

69
00:03:36,200 --> 00:03:45,200
in operation teacher so yeah typical

70
00:03:41,110 --> 00:03:48,410
vulnerabilities includes words sometimes

71
00:03:45,200 --> 00:03:51,649
<font color="#E5E5E5">even PDF reader</font><font color="#CCCCCC"> adobe PDF reader even</font>

72
00:03:48,410 --> 00:03:55,700
<font color="#CCCCCC">Java</font><font color="#E5E5E5"> so the names are you can see down</font>

73
00:03:51,650 --> 00:03:58,100
there BMW my web<font color="#E5E5E5"> PS 2005 these are the</font>

74
00:03:55,700 --> 00:04:02,359
names that<font color="#CCCCCC"> finer</font><font color="#E5E5E5"> I gave to the back</font>

75
00:03:58,100 --> 00:04:04,670
doors and I think the knees are taken

76
00:04:02,360 --> 00:04:07,670
from the debug<font color="#CCCCCC"> information inside the PE</font>

77
00:04:04,670 --> 00:04:10,040
header so the debug<font color="#CCCCCC"> director he can get</font>

78
00:04:07,670 --> 00:04:12,049
like the<font color="#CCCCCC"> path of the project in Visual</font>

79
00:04:10,040 --> 00:04:15,290
Studio<font color="#E5E5E5"> and so you can see they're like</font>

80
00:04:12,050 --> 00:04:20,070
so yeah they they named it according to

81
00:04:15,290 --> 00:04:24,030
<font color="#CCCCCC">the path</font><font color="#E5E5E5"> there so according to fire</font>

82
00:04:20,070 --> 00:04:26,610
the<font color="#CCCCCC"> camping from 2007</font><font color="#E5E5E5"> it would what was</font>

83
00:04:24,030 --> 00:04:32,309
called my<font color="#CCCCCC"> WebM BMW and then evolved into</font>

84
00:04:26,610 --> 00:04:34,530
<font color="#CCCCCC">BS 2005</font><font color="#E5E5E5"> and that continued until 2016</font>

85
00:04:32,310 --> 00:04:40,470
<font color="#E5E5E5">which was when type who was introduced</font>

86
00:04:34,530 --> 00:04:44,719
<font color="#E5E5E5">into</font><font color="#CCCCCC"> the tool set of this actor so now</font>

87
00:04:40,470 --> 00:04:47,310
<font color="#E5E5E5">so the case the case is for a global</font>

88
00:04:44,720 --> 00:04:51,660
<font color="#E5E5E5">technical and MASMA consulting company</font>

89
00:04:47,310 --> 00:04:54,750
they had offices<font color="#E5E5E5"> in the UK USA India</font>

90
00:04:51,660 --> 00:04:57,480
<font color="#E5E5E5">several places on Europe</font><font color="#CCCCCC"> defense</font>

91
00:04:54,750 --> 00:05:03,260
<font color="#E5E5E5">contractor they operated in several</font>

92
00:04:57,480 --> 00:05:10,050
sectors including<font color="#CCCCCC"> funnily cybersecurity</font>

93
00:05:03,260 --> 00:05:14,310
and the incident<font color="#E5E5E5"> basically started off</font>

94
00:05:10,050 --> 00:05:16,560
in April 2017<font color="#E5E5E5"> in April 2017 there was a</font>

95
00:05:14,310 --> 00:05:20,280
<font color="#E5E5E5">mini</font><font color="#CCCCCC"> cats alert that was caught by the</font>

96
00:05:16,560 --> 00:05:22,740
<font color="#E5E5E5">customer and they started the</font>

97
00:05:20,280 --> 00:05:27,809
investigation<font color="#E5E5E5"> because they wanna</font><font color="#CCCCCC"> they're</font>

98
00:05:22,740 --> 00:05:29,190
a they basically<font color="#CCCCCC"> flagged bimmy cats when</font>

99
00:05:27,810 --> 00:05:32,160
they started the investigation<font color="#CCCCCC"> and they</font>

100
00:05:29,190 --> 00:05:35,850
called out<font color="#CCCCCC"> the NCC</font><font color="#E5E5E5"> in May 2017 that's</font>

101
00:05:32,160 --> 00:05:40,020
when we got<font color="#E5E5E5"> involved</font><font color="#CCCCCC"> we started to look</font>

102
00:05:35,850 --> 00:05:42,720
at traces of activity<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we found that</font>

103
00:05:40,020 --> 00:05:46,710
<font color="#E5E5E5">actually the</font><font color="#CCCCCC"> active had been on the</font>

104
00:05:42,720 --> 00:05:49,290
network<font color="#E5E5E5"> since at least May 2016</font><font color="#CCCCCC"> and the</font>

105
00:05:46,710 --> 00:05:51,239
reason I'm saying<font color="#E5E5E5"> at least is that we</font>

106
00:05:49,290 --> 00:05:53,280
found that<font color="#E5E5E5"> the customer was going</font>

107
00:05:51,240 --> 00:05:56,370
through<font color="#E5E5E5"> a huge IT transformation project</font>

108
00:05:53,280 --> 00:05:58,260
during<font color="#E5E5E5"> that same period of time so it's</font>

109
00:05:56,370 --> 00:06:00,450
<font color="#E5E5E5">highly likely that a</font><font color="#CCCCCC"> lot</font><font color="#E5E5E5"> of forensic</font>

110
00:05:58,260 --> 00:06:05,340
evidence was lost<font color="#E5E5E5"> and so we couldn't</font>

111
00:06:00,450 --> 00:06:06,960
actually trace it even back further<font color="#E5E5E5"> we</font>

112
00:06:05,340 --> 00:06:10,080
continued the investigation until the

113
00:06:06,960 --> 00:06:14,000
end of June and<font color="#CCCCCC"> we found traces of data</font>

114
00:06:10,080 --> 00:06:16,500
exfiltration in April and then in June

115
00:06:14,000 --> 00:06:18,030
<font color="#CCCCCC">they asked us to stop the investigation</font>

116
00:06:16,500 --> 00:06:20,580
because<font color="#CCCCCC"> they had handle</font><font color="#E5E5E5"> over things they</font>

117
00:06:18,030 --> 00:06:25,739
<font color="#CCCCCC">could take</font><font color="#E5E5E5"> things from there so we</font><font color="#CCCCCC"> did</font>

118
00:06:20,580 --> 00:06:28,800
and then coming August<font color="#E5E5E5"> 2017 they asked</font>

119
00:06:25,740 --> 00:06:30,120
<font color="#E5E5E5">for our help again and they say well it</font>

120
00:06:28,800 --> 00:06:32,310
seems like<font color="#E5E5E5"> the attacker has been on the</font>

121
00:06:30,120 --> 00:06:32,940
<font color="#CCCCCC">network again so right after we left</font><font color="#E5E5E5"> in</font>

122
00:06:32,310 --> 00:06:35,580
June

123
00:06:32,940 --> 00:06:37,590
that I could got in again<font color="#CCCCCC"> and that's</font>

124
00:06:35,580 --> 00:06:40,320
when we<font color="#CCCCCC"> thought</font><font color="#E5E5E5"> well yeah that's why we</font>

125
00:06:37,590 --> 00:06:42,150
got<font color="#E5E5E5"> called in in</font><font color="#CCCCCC"> August</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> continued</font>

126
00:06:40,320 --> 00:06:48,110
<font color="#E5E5E5">their position till October</font><font color="#CCCCCC"> and that's</font>

127
00:06:42,150 --> 00:06:51,960
when it concluded from outside typical

128
00:06:48,110 --> 00:06:55,230
<font color="#CCCCCC">TTP</font><font color="#E5E5E5"> is for this active obviously mimic</font>

129
00:06:51,960 --> 00:06:57,000
<font color="#CCCCCC">act</font><font color="#E5E5E5"> so they use mimic apps to get domain</font>

130
00:06:55,230 --> 00:07:01,080
creds<font color="#E5E5E5"> and his main credits to move</font>

131
00:06:57,000 --> 00:07:03,150
laterally across the network<font color="#CCCCCC"> they try</font><font color="#E5E5E5"> to</font>

132
00:07:01,080 --> 00:07:06,900
<font color="#E5E5E5">use many caps to get a</font><font color="#CCCCCC"> curve</font><font color="#E5E5E5"> his golden</font>

133
00:07:03,150 --> 00:07:10,950
ticket<font color="#CCCCCC"> that didn't</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> they managed to</font>

134
00:07:06,900 --> 00:07:12,989
steal a VPN sir<font color="#E5E5E5"> for a user and use the</font>

135
00:07:10,950 --> 00:07:14,190
<font color="#E5E5E5">credits in</font><font color="#CCCCCC"> order</font><font color="#E5E5E5"> to log in and that's</font>

136
00:07:12,990 --> 00:07:17,730
how<font color="#E5E5E5"> they got in the second time around</font>

137
00:07:14,190 --> 00:07:22,860
<font color="#CCCCCC">so that's</font><font color="#E5E5E5"> when they got in after we left</font>

138
00:07:17,730 --> 00:07:27,030
the<font color="#CCCCCC"> first time they leveraged whatever</font>

139
00:07:22,860 --> 00:07:29,030
was present on the<font color="#E5E5E5"> machines so typical</font>

140
00:07:27,030 --> 00:07:32,400
tools available on<font color="#E5E5E5"> any</font><font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> Goff's</font>

141
00:07:29,030 --> 00:07:34,919
they would mount<font color="#E5E5E5"> the C dollar share on a</font>

142
00:07:32,400 --> 00:07:38,010
remote machine<font color="#E5E5E5"> copy the back door and</font>

143
00:07:34,920 --> 00:07:42,540
then remote exact the<font color="#E5E5E5"> back door and so</font>

144
00:07:38,010 --> 00:07:44,070
on<font color="#E5E5E5"> so forth</font><font color="#CCCCCC"> using domain credits what</font>

145
00:07:42,540 --> 00:07:45,690
was interesting is that they didn't stop

146
00:07:44,070 --> 00:07:49,890
there<font color="#CCCCCC"> I mean they they even</font><font color="#E5E5E5"> went further</font>

147
00:07:45,690 --> 00:07:52,440
<font color="#CCCCCC">to use tools that were in some cases</font>

148
00:07:49,890 --> 00:07:53,760
<font color="#E5E5E5">present with vanilla installations of</font>

149
00:07:52,440 --> 00:07:57,120
like<font color="#CCCCCC"> mssql</font>

150
00:07:53,760 --> 00:08:00,360
so Microsoft<font color="#E5E5E5"> SQL you get a hand utility</font>

151
00:07:57,120 --> 00:08:03,360
<font color="#CCCCCC">cool DCP</font><font color="#E5E5E5"> which is like both copy program</font>

152
00:08:00,360 --> 00:08:07,230
<font color="#E5E5E5">and that allows you to copy data out of</font>

153
00:08:03,360 --> 00:08:09,540
SQL or into<font color="#E5E5E5"> it and you can see there</font>

154
00:08:07,230 --> 00:08:11,550
this is<font color="#E5E5E5"> a decoded command from the sea</font>

155
00:08:09,540 --> 00:08:14,550
to Moby CDs and<font color="#E5E5E5"> then a select statement</font>

156
00:08:11,550 --> 00:08:20,250
there<font color="#E5E5E5"> that's actually</font><font color="#CCCCCC"> sent from the C</font>

157
00:08:14,550 --> 00:08:22,560
<font color="#E5E5E5">tool to be compromised machine they</font>

158
00:08:20,250 --> 00:08:25,669
brought in tools<font color="#E5E5E5"> whatever they wanted in</font>

159
00:08:22,560 --> 00:08:28,200
<font color="#CCCCCC">order to the job so remote exact</font>

160
00:08:25,669 --> 00:08:29,669
something called<font color="#CCCCCC"> lucky nom which is like</font>

161
00:08:28,200 --> 00:08:31,979
a vulnerability<font color="#E5E5E5"> scanning tool I</font>

162
00:08:29,669 --> 00:08:33,630
<font color="#E5E5E5">apologize</font><font color="#CCCCCC"> for many of you pentesters</font>

163
00:08:31,980 --> 00:08:39,380
<font color="#E5E5E5">will probably know these stuff I'm I'm</font>

164
00:08:33,630 --> 00:08:41,280
not so I do apologize csvde<font color="#E5E5E5"> is</font>

165
00:08:39,380 --> 00:08:45,110
apparently a tool that<font color="#E5E5E5"> allows you to</font>

166
00:08:41,280 --> 00:08:48,500
<font color="#E5E5E5">dump stuff from</font><font color="#CCCCCC"> M</font>

167
00:08:45,110 --> 00:08:51,890
<font color="#CCCCCC">abyzou Active Directory you</font><font color="#E5E5E5"> can dump</font>

168
00:08:48,500 --> 00:08:54,320
<font color="#E5E5E5">data in CSV format</font><font color="#CCCCCC"> and they</font><font color="#E5E5E5"> use that in</font>

169
00:08:51,890 --> 00:08:58,610
order<font color="#CCCCCC"> to Tom data from the</font><font color="#E5E5E5"> customers</font>

170
00:08:54,320 --> 00:09:02,149
Active Directory but they didn't<font color="#CCCCCC"> also</font>

171
00:08:58,610 --> 00:09:04,180
then stop at just<font color="#E5E5E5"> like off the shelf</font>

172
00:09:02,149 --> 00:09:06,829
tools<font color="#E5E5E5"> they created their own stuff</font>

173
00:09:04,180 --> 00:09:09,260
they've been long enough there<font color="#E5E5E5"> in order</font>

174
00:09:06,829 --> 00:09:13,670
<font color="#CCCCCC">to go back and create</font><font color="#E5E5E5"> their own stuff</font>

175
00:09:09,260 --> 00:09:16,189
and we found<font color="#CCCCCC"> three what - bespoke</font><font color="#E5E5E5"> tools</font>

176
00:09:13,670 --> 00:09:22,939
and probably<font color="#E5E5E5"> key loggers</font><font color="#CCCCCC"> that we used</font>

177
00:09:16,190 --> 00:09:26,029
<font color="#E5E5E5">using about their problem so one tool</font>

178
00:09:22,940 --> 00:09:26,660
was used in<font color="#E5E5E5"> order to enumerate Microsoft</font>

179
00:09:26,029 --> 00:09:30,589
SharePoint

180
00:09:26,660 --> 00:09:32,810
so they created dotnet tool to connect

181
00:09:30,589 --> 00:09:35,060
to SharePoint<font color="#E5E5E5"> and look for specific</font>

182
00:09:32,810 --> 00:09:37,489
project IDs<font color="#E5E5E5"> so they knew what they were</font>

183
00:09:35,060 --> 00:09:38,420
<font color="#CCCCCC">looking for</font><font color="#E5E5E5"> they had specific project</font>

184
00:09:37,490 --> 00:09:40,640
that<font color="#E5E5E5"> is they were looking for in</font>

185
00:09:38,420 --> 00:09:42,529
SharePoint<font color="#E5E5E5"> they would get the links in</font>

186
00:09:40,640 --> 00:09:44,300
SharePoint<font color="#E5E5E5"> for these documents dump them</font>

187
00:09:42,529 --> 00:09:49,370
out<font color="#E5E5E5"> and then that</font><font color="#CCCCCC"> would be insulated</font>

188
00:09:44,300 --> 00:09:52,279
<font color="#E5E5E5">another tool</font><font color="#CCCCCC"> I had been used to</font><font color="#E5E5E5"> connect</font>

189
00:09:49,370 --> 00:09:55,070
to<font color="#E5E5E5"> exchange so they had user grants</font>

190
00:09:52,279 --> 00:09:58,850
<font color="#CCCCCC">again that was specifically hard-coded</font>

191
00:09:55,070 --> 00:10:01,250
IP addresses<font color="#CCCCCC"> invited to connect to</font>

192
00:09:58,850 --> 00:10:04,070
exchange<font color="#E5E5E5"> using user creds enumerate</font>

193
00:10:01,250 --> 00:10:06,350
everything<font color="#E5E5E5"> subjects attachments body</font>

194
00:10:04,070 --> 00:10:09,199
<font color="#E5E5E5">search by everything</font><font color="#CCCCCC"> dump everything out</font>

195
00:10:06,350 --> 00:10:13,130
to a file and<font color="#E5E5E5"> then yeah they would</font>

196
00:10:09,199 --> 00:10:16,550
accelerate that<font color="#E5E5E5"> this is you can see up</font>

197
00:10:13,130 --> 00:10:19,189
<font color="#CCCCCC">there that's basically hard-coded paths</font>

198
00:10:16,550 --> 00:10:20,750
<font color="#CCCCCC">were</font><font color="#E5E5E5"> one of</font><font color="#CCCCCC"> the key loggers</font><font color="#E5E5E5"> so you can</font>

199
00:10:19,190 --> 00:10:22,579
see this is lucky his<font color="#E5E5E5"> a path so</font>

200
00:10:20,750 --> 00:10:24,380
obviously they had access to<font color="#CCCCCC"> the user</font>

201
00:10:22,579 --> 00:10:26,300
account<font color="#E5E5E5"> and then they went and built the</font>

202
00:10:24,380 --> 00:10:28,220
key logger<font color="#E5E5E5"> and then came back and</font>

203
00:10:26,300 --> 00:10:34,279
deployed it<font color="#E5E5E5"> because otherwise they won't</font>

204
00:10:28,220 --> 00:10:35,870
have access<font color="#E5E5E5"> to that path</font><font color="#CCCCCC"> typically</font>

205
00:10:34,279 --> 00:10:41,000
<font color="#CCCCCC">exfiltration</font><font color="#E5E5E5"> took place in drawer</font>

206
00:10:35,870 --> 00:10:45,440
archives<font color="#E5E5E5"> so information</font><font color="#CCCCCC"> they were after</font>

207
00:10:41,000 --> 00:10:49,130
<font color="#E5E5E5">were was yeah military projects that</font>

208
00:10:45,440 --> 00:10:52,170
<font color="#CCCCCC">apply might have been engaged</font><font color="#E5E5E5"> in emails</font>

209
00:10:49,130 --> 00:10:54,120
that were the<font color="#CCCCCC"> constants information</font>

210
00:10:52,170 --> 00:10:56,760
what was<font color="#E5E5E5"> interesting was the naming</font>

211
00:10:54,120 --> 00:11:03,240
convention used for the<font color="#E5E5E5"> up quite so you</font>

212
00:10:56,760 --> 00:11:07,280
can<font color="#E5E5E5"> see there over 331</font><font color="#CCCCCC"> 0 does anyone</font>

213
00:11:03,240 --> 00:11:07,280
want to<font color="#E5E5E5"> take any guess what this means</font>

214
00:11:09,770 --> 00:11:19,890
you know so this<font color="#E5E5E5"> is March</font><font color="#CCCCCC"> the 31st</font><font color="#E5E5E5"> our</font>

215
00:11:15,840 --> 00:11:21,780
<font color="#CCCCCC">comp number 0</font><font color="#E5E5E5"> so they that was very</font>

216
00:11:19,890 --> 00:11:24,569
<font color="#E5E5E5">handy for us in order to tell us</font>

217
00:11:21,780 --> 00:11:26,220
actually this was when they are quite

218
00:11:24,570 --> 00:11:28,650
was great to know that<font color="#CCCCCC"> the data start to</font>

219
00:11:26,220 --> 00:11:31,050
be<font color="#E5E5E5"> collected at this archive in this</font>

220
00:11:28,650 --> 00:11:32,520
<font color="#CCCCCC">date because</font><font color="#E5E5E5"> they use days and then we</font>

221
00:11:31,050 --> 00:11:34,800
<font color="#E5E5E5">come we could</font><font color="#CCCCCC"> obviously correlate that</font>

222
00:11:32,520 --> 00:11:40,140
with a timeline<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> time stamps for</font>

223
00:11:34,800 --> 00:11:43,949
when the file was created the other

224
00:11:40,140 --> 00:11:48,810
thing was they<font color="#CCCCCC"> used heavily batch files</font>

225
00:11:43,950 --> 00:11:54,210
for everything I don't know if this is

226
00:11:48,810 --> 00:11:59,939
<font color="#E5E5E5">intentional or due</font><font color="#CCCCCC"> to the weakness of</font>

227
00:11:54,210 --> 00:12:01,530
the actor<font color="#CCCCCC"> I don't know but some of the</font>

228
00:11:59,940 --> 00:12:05,100
<font color="#CCCCCC">backdoors didn't have persistence in</font>

229
00:12:01,530 --> 00:12:08,189
them<font color="#E5E5E5"> so they wouldn't persist on reboots</font>

230
00:12:05,100 --> 00:12:10,950
etc but they would go<font color="#CCCCCC"> on and create the</font>

231
00:12:08,190 --> 00:12:13,560
batch file<font color="#CCCCCC"> to create the run key for the</font>

232
00:12:10,950 --> 00:12:16,580
<font color="#E5E5E5">back doors and then execute the batch</font>

233
00:12:13,560 --> 00:12:20,849
files for the back<font color="#CCCCCC"> Thursday's to</font><font color="#E5E5E5"> persist</font>

234
00:12:16,580 --> 00:12:24,030
<font color="#CCCCCC">they</font><font color="#E5E5E5"> use that files</font><font color="#CCCCCC"> and even</font><font color="#E5E5E5"> to like run</font>

235
00:12:20,850 --> 00:12:26,010
commands<font color="#E5E5E5"> and then fight these commands</font>

236
00:12:24,030 --> 00:12:28,890
into a file and<font color="#E5E5E5"> then exfiltrate the file</font>

237
00:12:26,010 --> 00:12:32,250
<font color="#E5E5E5">so</font><font color="#CCCCCC"> i'm not sure why they</font><font color="#E5E5E5"> have really</font>

238
00:12:28,890 --> 00:12:33,750
relied on that<font color="#E5E5E5"> ones to like execute what</font>

239
00:12:32,250 --> 00:12:35,910
they wanted many of the backdoors you'll

240
00:12:33,750 --> 00:12:39,630
come<font color="#CCCCCC"> across they would take commands</font>

241
00:12:35,910 --> 00:12:42,660
<font color="#E5E5E5">execute them and then just post the</font>

242
00:12:39,630 --> 00:12:44,970
result back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the c2</font><font color="#E5E5E5"> right away they</font>

243
00:12:42,660 --> 00:12:48,120
wouldn't<font color="#CCCCCC"> just write the command to</font><font color="#E5E5E5"> a</font>

244
00:12:44,970 --> 00:12:51,030
batch file then executed and then post

245
00:12:48,120 --> 00:12:53,370
the<font color="#E5E5E5"> data back but yeah this was one like</font>

246
00:12:51,030 --> 00:12:58,650
if there was one unique attribute<font color="#E5E5E5"> about</font>

247
00:12:53,370 --> 00:13:00,150
this actor<font color="#CCCCCC"> i guess this</font><font color="#E5E5E5"> would be it the</font>

248
00:12:58,650 --> 00:13:03,540
other thing which<font color="#CCCCCC"> is interesting</font><font color="#E5E5E5"> from</font>

249
00:13:00,150 --> 00:13:05,819
the decoded commands was<font color="#E5E5E5"> i can see there</font>

250
00:13:03,540 --> 00:13:08,310
a typo to see windows

251
00:13:05,820 --> 00:13:10,830
them and they had<font color="#CCCCCC"> to fight with their</font>

252
00:13:08,310 --> 00:13:13,530
<font color="#E5E5E5">own system this gave</font><font color="#CCCCCC"> us insight into the</font>

253
00:13:10,830 --> 00:13:15,720
fact<font color="#E5E5E5"> that probably this</font><font color="#CCCCCC"> is not an</font>

254
00:13:13,530 --> 00:13:18,630
automated like server-side script that's

255
00:13:15,720 --> 00:13:20,730
just sending queries to the<font color="#CCCCCC"> backdoors</font>

256
00:13:18,630 --> 00:13:23,520
<font color="#E5E5E5">this is probably someone manually</font>

257
00:13:20,730 --> 00:13:25,140
sitting on the<font color="#E5E5E5"> other end typing commands</font>

258
00:13:23,520 --> 00:13:35,160
that<font color="#CCCCCC"> get sent to the back door</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> then</font>

259
00:13:25,140 --> 00:13:36,540
<font color="#E5E5E5">get executed so the tools I spoke</font><font color="#CCCCCC"> about</font>

260
00:13:35,160 --> 00:13:38,250
the key<font color="#CCCCCC"> loggers</font><font color="#E5E5E5"> so they had the best</font>

261
00:13:36,540 --> 00:13:40,819
<font color="#E5E5E5">book</font><font color="#CCCCCC"> to us the key loggers</font><font color="#E5E5E5"> I'm a</font><font color="#CCCCCC"> share</font>

262
00:13:38,250 --> 00:13:43,770
<font color="#CCCCCC">pointer miss exchange enumeration tools</font>

263
00:13:40,820 --> 00:13:46,790
they brought in off<font color="#CCCCCC"> the shelf tools in</font>

264
00:13:43,770 --> 00:13:51,060
order<font color="#CCCCCC"> to do the job but</font><font color="#E5E5E5"> we found three</font>

265
00:13:46,790 --> 00:13:55,170
different<font color="#CCCCCC"> backdoors on the customers</font>

266
00:13:51,060 --> 00:13:57,989
<font color="#E5E5E5">network</font><font color="#CCCCCC"> BS 2005 was perhaps one that</font><font color="#E5E5E5"> was</font>

267
00:13:55,170 --> 00:13:59,699
previously discussed<font color="#CCCCCC"> by fire but we</font>

268
00:13:57,990 --> 00:14:03,350
found it there we didn't find tide pool

269
00:13:59,700 --> 00:14:07,260
which means<font color="#CCCCCC"> probably that</font><font color="#E5E5E5"> the actor</font>

270
00:14:03,350 --> 00:14:10,200
<font color="#E5E5E5">doesn't have to stick to what's him when</font>

271
00:14:07,260 --> 00:14:12,650
they're using<font color="#E5E5E5"> the back doors they'll use</font>

272
00:14:10,200 --> 00:14:15,840
<font color="#E5E5E5">the back doors that do the job for them</font>

273
00:14:12,650 --> 00:14:18,270
meaning even though<font color="#E5E5E5"> tide pool was</font>

274
00:14:15,840 --> 00:14:21,390
released in 2016<font color="#E5E5E5"> and this was the latest</font>

275
00:14:18,270 --> 00:14:26,490
<font color="#CCCCCC">backdoor in their arsenal they didn't</font><font color="#E5E5E5"> we</font>

276
00:14:21,390 --> 00:14:29,449
didn't find<font color="#CCCCCC"> that we found bs 2005 what</font>

277
00:14:26,490 --> 00:14:33,090
was new was<font color="#E5E5E5"> two other back towards</font>

278
00:14:29,450 --> 00:14:37,260
<font color="#E5E5E5">royalty</font><font color="#CCCCCC"> law</font><font color="#E5E5E5"> in rural DNS which I'll</font>

279
00:14:33,090 --> 00:14:40,320
<font color="#E5E5E5">discuss now so royal</font><font color="#CCCCCC"> Salina</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> compile</font>

280
00:14:37,260 --> 00:14:42,569
<font color="#CCCCCC">field of 2015 and the name</font><font color="#E5E5E5"> comes from</font>

281
00:14:40,320 --> 00:14:46,980
<font color="#E5E5E5">the debug information so just following</font>

282
00:14:42,570 --> 00:14:49,260
convention here and these<font color="#E5E5E5"> were the c2 is</font>

283
00:14:46,980 --> 00:14:54,960
<font color="#E5E5E5">there what was interesting about this</font>

284
00:14:49,260 --> 00:14:59,550
backdoor is a tricot<font color="#CCCCCC"> I first time I see</font>

285
00:14:54,960 --> 00:15:02,670
this<font color="#E5E5E5"> trick which is they copied CMD into</font>

286
00:14:59,550 --> 00:15:04,140
the current working directory<font color="#E5E5E5"> and then</font>

287
00:15:02,670 --> 00:15:07,050
they would patch it<font color="#E5E5E5"> they would they</font>

288
00:15:04,140 --> 00:15:10,530
would look for<font color="#CCCCCC"> a specific string inside</font>

289
00:15:07,050 --> 00:15:14,729
<font color="#E5E5E5">CMV called</font><font color="#CCCCCC"> disable CMD and then changed</font>

290
00:15:10,530 --> 00:15:17,850
one character from<font color="#E5E5E5"> a</font><font color="#CCCCCC"> D to any does</font>

291
00:15:14,730 --> 00:15:20,210
anyone know why what<font color="#CCCCCC"> disable CMD is what</font>

292
00:15:17,850 --> 00:15:20,210
does<font color="#E5E5E5"> it do</font>

293
00:15:20,360 --> 00:15:27,270
yeah<font color="#E5E5E5"> yeah the Sun</font><font color="#CCCCCC"> exactly</font><font color="#E5E5E5"> yeah</font>

294
00:15:23,400 --> 00:15:29,699
so basically CMD when it starts it<font color="#CCCCCC"> will</font>

295
00:15:27,270 --> 00:15:33,180
<font color="#E5E5E5">check this registry key and if it's set</font>

296
00:15:29,700 --> 00:15:35,910
to<font color="#E5E5E5"> a value of</font><font color="#CCCCCC"> two I</font><font color="#E5E5E5"> believe</font><font color="#CCCCCC"> then it</font>

297
00:15:33,180 --> 00:15:37,589
<font color="#E5E5E5">exits execution and if it doesn't</font><font color="#CCCCCC"> exist</font>

298
00:15:35,910 --> 00:15:39,480
they will continue execution so you can

299
00:15:37,590 --> 00:15:41,160
step to<font color="#E5E5E5"> basically block C and D for</font>

300
00:15:39,480 --> 00:15:43,790
running on machines<font color="#E5E5E5"> by setting this</font>

301
00:15:41,160 --> 00:15:43,790
registry key

302
00:15:43,910 --> 00:15:49,560
apparently they ran<font color="#E5E5E5"> into problems before</font>

303
00:15:46,110 --> 00:15:54,390
<font color="#E5E5E5">and they rely heavily on CMD to run</font>

304
00:15:49,560 --> 00:15:55,770
their commands<font color="#E5E5E5"> so they would copy CMD</font>

305
00:15:54,390 --> 00:15:58,500
into the current working directory<font color="#CCCCCC"> patch</font>

306
00:15:55,770 --> 00:16:02,480
it and<font color="#CCCCCC"> used</font><font color="#E5E5E5"> that version instead instead</font>

307
00:15:58,500 --> 00:16:05,940
<font color="#CCCCCC">of the default CMD setting in system 32</font>

308
00:16:02,480 --> 00:16:07,530
<font color="#E5E5E5">the configuration file which included</font>

309
00:16:05,940 --> 00:16:12,750
the<font color="#E5E5E5"> C choice was typically dropped in</font>

310
00:16:07,530 --> 00:16:14,610
the temp directory<font color="#CCCCCC"> it was or encoded and</font>

311
00:16:12,750 --> 00:16:16,980
I mean at the end<font color="#E5E5E5"> of the top you'll find</font>

312
00:16:14,610 --> 00:16:19,680
<font color="#CCCCCC">the link to order like</font><font color="#E5E5E5"> scripts</font><font color="#CCCCCC"> that you</font>

313
00:16:16,980 --> 00:16:21,420
can use if you run into instances of

314
00:16:19,680 --> 00:16:23,819
this<font color="#E5E5E5"> backdoor or if you want to play</font>

315
00:16:21,420 --> 00:16:28,010
with the backdoor<font color="#CCCCCC"> and learn</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> about</font>

316
00:16:23,820 --> 00:16:32,910
it there were lots of<font color="#CCCCCC"> similarities with</font>

317
00:16:28,010 --> 00:16:34,920
<font color="#CCCCCC">BS 2005</font><font color="#E5E5E5"> and my web tip specifically the</font>

318
00:16:32,910 --> 00:16:37,380
mode<font color="#CCCCCC"> of communication so they use HTTP</font>

319
00:16:34,920 --> 00:16:41,280
and they use the<font color="#E5E5E5"> I web browser to</font>

320
00:16:37,380 --> 00:16:44,130
comment<font color="#E5E5E5"> their face to instrument</font><font color="#CCCCCC"> IV</font><font color="#E5E5E5"> so</font>

321
00:16:41,280 --> 00:16:46,170
like every HTML<font color="#E5E5E5"> files that</font><font color="#CCCCCC"> would</font><font color="#E5E5E5"> get</font>

322
00:16:44,130 --> 00:16:48,020
<font color="#E5E5E5">festival typically get cached on the</font>

323
00:16:46,170 --> 00:16:51,270
machines which is very this this is why

324
00:16:48,020 --> 00:16:53,400
we had access<font color="#E5E5E5"> to the 200 C 2</font><font color="#CCCCCC"> or more</font>

325
00:16:51,270 --> 00:16:56,970
commands<font color="#E5E5E5"> because we had so many HTML</font>

326
00:16:53,400 --> 00:16:59,490
files cached<font color="#E5E5E5"> on the compromised</font><font color="#CCCCCC"> hosts</font>

327
00:16:56,970 --> 00:17:04,560
that we took decrypted and understood

328
00:16:59,490 --> 00:17:07,949
actually what happened there<font color="#CCCCCC"> the beacon</font>

329
00:17:04,560 --> 00:17:11,909
<font color="#CCCCCC">of war oli</font><font color="#E5E5E5"> goes something like it's a</font>

330
00:17:07,949 --> 00:17:13,470
get request<font color="#E5E5E5"> starts with an ID which an</font>

331
00:17:11,910 --> 00:17:16,920
ID parameter which is<font color="#E5E5E5"> an infection</font>

332
00:17:13,470 --> 00:17:20,069
<font color="#E5E5E5">identifier followed by a page parameter</font>

333
00:17:16,920 --> 00:17:24,810
which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> hostname Zoar</font><font color="#E5E5E5"> and based</font><font color="#CCCCCC"> 82</font>

334
00:17:20,069 --> 00:17:26,790
<font color="#E5E5E5">a base64 encoded and then you get the</font>

335
00:17:24,810 --> 00:17:30,120
<font color="#CCCCCC">role parameter which is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> encryption</font>

336
00:17:26,790 --> 00:17:32,790
key so the role parameter was the<font color="#CCCCCC"> zuhr</font>

337
00:17:30,120 --> 00:17:36,379
key which<font color="#CCCCCC"> can decode</font>

338
00:17:32,790 --> 00:17:39,990
the page parameter which is<font color="#E5E5E5"> the hostname</font>

339
00:17:36,380 --> 00:17:47,040
mode of operation involves heartbeat

340
00:17:39,990 --> 00:17:51,780
<font color="#E5E5E5">which is just get requests to help the</font>

341
00:17:47,040 --> 00:17:55,290
SPX typically the<font color="#CCCCCC"> cito responds with a</font>

342
00:17:51,780 --> 00:17:58,860
number of milliseconds<font color="#E5E5E5"> for</font><font color="#CCCCCC"> the back door</font>

343
00:17:55,290 --> 00:18:02,460
<font color="#CCCCCC">to sleep and then</font><font color="#E5E5E5"> a find a flag the flag</font>

344
00:17:58,860 --> 00:18:04,439
would then tell the back door what

345
00:18:02,460 --> 00:18:07,860
should it<font color="#E5E5E5"> fetch on the second time</font><font color="#CCCCCC"> after</font>

346
00:18:04,440 --> 00:18:09,150
it sleeps so if the flag<font color="#CCCCCC"> is not set it</font>

347
00:18:07,860 --> 00:18:11,100
will just continue in the<font color="#E5E5E5"> heartbeat</font>

348
00:18:09,150 --> 00:18:14,669
operation and approaching if getting

349
00:18:11,100 --> 00:18:17,010
number of<font color="#CCCCCC"> many seconds to sleep</font><font color="#E5E5E5"> if the</font>

350
00:18:14,669 --> 00:18:19,650
flag is<font color="#E5E5E5"> set then it fetches a personal</font>

351
00:18:17,010 --> 00:18:24,379
note and<font color="#CCCCCC"> communicates perfect personal</font>

352
00:18:19,650 --> 00:18:27,540
HTML which is an HTML that will carry

353
00:18:24,380 --> 00:18:32,520
execution functions that the back door

354
00:18:27,540 --> 00:18:35,610
needs to<font color="#E5E5E5"> operate this is an example of</font>

355
00:18:32,520 --> 00:18:37,260
an inch<font color="#CCCCCC"> the ml5 retrieved from one of</font>

356
00:18:35,610 --> 00:18:43,740
the<font color="#E5E5E5"> compromise posts so you can see</font>

357
00:18:37,260 --> 00:18:47,580
<font color="#CCCCCC">there</font><font color="#E5E5E5"> prepend it to the HTML</font><font color="#CCCCCC"> base</font><font color="#E5E5E5"> with</font>

358
00:18:43,740 --> 00:18:50,960
64 encoded data<font color="#E5E5E5"> in between backward</font>

359
00:18:47,580 --> 00:18:54,149
slashes and that's basically the<font color="#E5E5E5"> command</font>

360
00:18:50,960 --> 00:18:59,160
<font color="#CCCCCC">they're not using the same zhurqi that</font>

361
00:18:54,150 --> 00:19:02,900
is in the row<font color="#E5E5E5"> parameter in the HTML</font>

362
00:18:59,160 --> 00:19:06,240
there<font color="#E5E5E5"> so I believe the first 16 bytes</font>

363
00:19:02,900 --> 00:19:08,220
<font color="#CCCCCC">would form a seat that they would use in</font>

364
00:19:06,240 --> 00:19:12,350
order<font color="#E5E5E5"> to generate the key that would</font>

365
00:19:08,220 --> 00:19:12,350
<font color="#E5E5E5">then be</font><font color="#CCCCCC"> used to decrypt</font><font color="#E5E5E5"> the commands</font>

366
00:19:13,130 --> 00:19:19,620
this is an<font color="#CCCCCC"> example</font><font color="#E5E5E5"> of a decoded command</font>

367
00:19:17,000 --> 00:19:24,059
so you<font color="#E5E5E5"> can see there it starts with an O</font>

368
00:19:19,620 --> 00:19:26,428
3<font color="#CCCCCC"> this o 3 is basically an identifier</font>

369
00:19:24,059 --> 00:19:28,770
<font color="#CCCCCC">for a function that the backdoor needs</font>

370
00:19:26,429 --> 00:19:32,790
to perform<font color="#E5E5E5"> so they had like different</font>

371
00:19:28,770 --> 00:19:35,520
hex numbers for different<font color="#E5E5E5"> operations and</font>

372
00:19:32,790 --> 00:19:39,510
then followed<font color="#CCCCCC"> by some data and</font><font color="#E5E5E5"> then a</font>

373
00:19:35,520 --> 00:19:42,929
string<font color="#CCCCCC"> and you can see @echo off CD c</font>

374
00:19:39,510 --> 00:19:46,379
<font color="#E5E5E5">windows them</font><font color="#CCCCCC"> ipconfig this is the batch</font>

375
00:19:42,929 --> 00:19:48,150
file<font color="#E5E5E5"> so they're writing this string</font>

376
00:19:46,380 --> 00:19:50,070
<font color="#CCCCCC">to a batch file and then they will</font>

377
00:19:48,150 --> 00:19:51,450
execute that<font color="#CCCCCC"> batch file in</font><font color="#E5E5E5"> order to</font>

378
00:19:50,070 --> 00:19:55,830
<font color="#E5E5E5">retrieve the commands and this is all</font>

379
00:19:51,450 --> 00:19:57,930
pipe<font color="#CCCCCC"> two in front</font><font color="#E5E5E5"> of them</font><font color="#CCCCCC"> so what was</font>

380
00:19:55,830 --> 00:20:02,010
interesting about the way<font color="#E5E5E5"> this whole</font>

381
00:19:57,930 --> 00:20:05,730
thing<font color="#CCCCCC"> works</font><font color="#E5E5E5"> is how they actually track</font>

382
00:20:02,010 --> 00:20:07,530
writing to files<font color="#CCCCCC"> so this is a write this</font>

383
00:20:05,730 --> 00:20:10,950
<font color="#E5E5E5">is not an execution function so or three</font>

384
00:20:07,530 --> 00:20:14,520
means<font color="#CCCCCC"> right to file so how do they</font><font color="#E5E5E5"> know</font>

385
00:20:10,950 --> 00:20:18,060
which file try to the<font color="#CCCCCC"> c2 will be sending</font>

386
00:20:14,520 --> 00:20:21,360
a number that they will be<font color="#E5E5E5"> using on the</font>

387
00:20:18,060 --> 00:20:23,760
server and<font color="#E5E5E5"> to track which find</font><font color="#CCCCCC"> they're</font>

388
00:20:21,360 --> 00:20:26,370
writing to<font color="#E5E5E5"> this number gets multiplied</font>

389
00:20:23,760 --> 00:20:30,379
by<font color="#CCCCCC"> a constant</font><font color="#E5E5E5"> in the backdoor and the</font>

390
00:20:26,370 --> 00:20:34,370
resulting ID number gets prepended<font color="#E5E5E5"> to</font>

391
00:20:30,380 --> 00:20:37,590
<font color="#E5E5E5">what sorry appended to till the CLI temp</font>

392
00:20:34,370 --> 00:20:40,979
dot ini so they'll<font color="#E5E5E5"> till does he like</font>

393
00:20:37,590 --> 00:20:45,540
them<font color="#E5E5E5"> and then that number dot ini</font><font color="#CCCCCC"> will</font>

394
00:20:40,980 --> 00:20:47,670
be red and then the<font color="#E5E5E5"> CN key will have the</font>

395
00:20:45,540 --> 00:20:49,860
path of the file<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the data</font><font color="#E5E5E5"> gets</font>

396
00:20:47,670 --> 00:20:53,790
written to<font color="#E5E5E5"> it's a very convoluted long</font>

397
00:20:49,860 --> 00:20:55,979
way to write or what but why are they

398
00:20:53,790 --> 00:20:58,770
<font color="#E5E5E5">going</font><font color="#CCCCCC"> through</font><font color="#E5E5E5"> this hassle so they have</font>

399
00:20:55,980 --> 00:21:02,820
<font color="#E5E5E5">other</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> BN</font><font color="#CCCCCC"> b SD b the</font><font color="#E5E5E5"> BN is the</font>

400
00:20:58,770 --> 00:21:06,930
block number yes is the block<font color="#CCCCCC"> size and T</font>

401
00:21:02,820 --> 00:21:09,090
<font color="#E5E5E5">V is the index inside the block so this</font>

402
00:21:06,930 --> 00:21:13,620
means that<font color="#E5E5E5"> they will</font><font color="#CCCCCC"> be reading that</font>

403
00:21:09,090 --> 00:21:16,919
file<font color="#E5E5E5"> and then moving the index</font><font color="#CCCCCC"> eighteen</font>

404
00:21:13,620 --> 00:21:21,030
blocks in the file<font color="#E5E5E5"> and then starting</font><font color="#CCCCCC"> to</font>

405
00:21:16,920 --> 00:21:25,410
write from<font color="#E5E5E5"> index number zero the reason</font>

406
00:21:21,030 --> 00:21:27,990
they're using this is I guess<font color="#CCCCCC"> in</font><font color="#E5E5E5"> order</font>

407
00:21:25,410 --> 00:21:29,910
<font color="#E5E5E5">to track execution to track basically</font>

408
00:21:27,990 --> 00:21:32,670
<font color="#E5E5E5">how far they've gone if the connection</font>

409
00:21:29,910 --> 00:21:36,780
drops or for some reason<font color="#E5E5E5"> you know during</font>

410
00:21:32,670 --> 00:21:39,720
the<font color="#E5E5E5"> the writing to a file or eating</font><font color="#CCCCCC"> the</font>

411
00:21:36,780 --> 00:21:41,910
reading from a file anything happens

412
00:21:39,720 --> 00:21:46,920
they<font color="#CCCCCC"> can</font><font color="#E5E5E5"> go back</font><font color="#CCCCCC"> to the ini file and</font>

413
00:21:41,910 --> 00:21:51,510
continue from<font color="#E5E5E5"> where they stopped they</font>

414
00:21:46,920 --> 00:21:55,710
used to file mapping objects for reading

415
00:21:51,510 --> 00:21:58,170
and<font color="#E5E5E5"> writing my our object is for reading</font>

416
00:21:55,710 --> 00:22:00,870
<font color="#CCCCCC">file from files so they would map the</font>

417
00:21:58,170 --> 00:22:03,660
file and then use that<font color="#E5E5E5"> handle</font>

418
00:22:00,870 --> 00:22:08,790
and the<font color="#CCCCCC"> myw object will be used for</font>

419
00:22:03,660 --> 00:22:10,020
<font color="#CCCCCC">writing and they</font><font color="#E5E5E5"> were out late</font><font color="#CCCCCC"> early</font>

420
00:22:08,790 --> 00:22:13,220
you'll find you'll see why this is

421
00:22:10,020 --> 00:22:16,710
<font color="#E5E5E5">significant or why this is important</font>

422
00:22:13,220 --> 00:22:19,230
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> briefly like some of the</font>

423
00:22:16,710 --> 00:22:24,290
functions that<font color="#E5E5E5"> the back door employees</font>

424
00:22:19,230 --> 00:22:28,320
<font color="#E5E5E5">like any back door download execute</font>

425
00:22:24,290 --> 00:22:32,280
<font color="#E5E5E5">upload data with the addition of like</font>

426
00:22:28,320 --> 00:22:34,139
matching<font color="#E5E5E5"> CMV this is like they have this</font>

427
00:22:32,280 --> 00:22:35,970
thing<font color="#CCCCCC"> that they can redo the whole</font>

428
00:22:34,140 --> 00:22:41,220
patching process again<font color="#CCCCCC"> if it didn't work</font>

429
00:22:35,970 --> 00:22:44,930
the<font color="#CCCCCC"> first time next one is BS 2005 who</font>

430
00:22:41,220 --> 00:22:48,540
found two samples or via 2005 one was

431
00:22:44,930 --> 00:22:52,590
back to the<font color="#CCCCCC"> vm</font><font color="#E5E5E5"> protect and the other was</font>

432
00:22:48,540 --> 00:22:56,430
<font color="#CCCCCC">not so the 2016 sample was backed with</font>

433
00:22:52,590 --> 00:22:58,350
being protected<font color="#E5E5E5"> and for some reason it</font>

434
00:22:56,430 --> 00:23:01,860
<font color="#E5E5E5">was used to</font><font color="#CCCCCC"> download the unpacked</font>

435
00:22:58,350 --> 00:23:06,209
version of the sample<font color="#E5E5E5"> and the unpacked</font>

436
00:23:01,860 --> 00:23:07,500
version was used<font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to execute</font><font color="#E5E5E5"> yet</font>

437
00:23:06,210 --> 00:23:09,270
they used the unpacked version

438
00:23:07,500 --> 00:23:10,950
throughout like when they moved

439
00:23:09,270 --> 00:23:13,830
laterally they would copy this unpacked

440
00:23:10,950 --> 00:23:17,100
version rather than the packed one which

441
00:23:13,830 --> 00:23:21,090
is weird

442
00:23:17,100 --> 00:23:23,730
I guess maybe for some reason<font color="#CCCCCC"> AV picked</font>

443
00:23:21,090 --> 00:23:25,280
up impact version<font color="#E5E5E5"> but it's VM protected</font>

444
00:23:23,730 --> 00:23:28,500
<font color="#CCCCCC">it's a legitimate backer I don't know</font>

445
00:23:25,280 --> 00:23:34,639
why why would they<font color="#CCCCCC"> use the unpack</font>

446
00:23:28,500 --> 00:23:36,660
version<font color="#E5E5E5"> again HTTP mode of communication</font>

447
00:23:34,640 --> 00:23:39,650
<font color="#E5E5E5">using the</font><font color="#CCCCCC"> I web browsers to</font><font color="#E5E5E5"> calm</font>

448
00:23:36,660 --> 00:23:44,850
interface so cached HTML on<font color="#CCCCCC"> the</font>

449
00:23:39,650 --> 00:23:47,460
<font color="#CCCCCC">compromised</font><font color="#E5E5E5"> toasts this is what I think</font>

450
00:23:44,850 --> 00:23:50,149
it looks like<font color="#CCCCCC"> four BS 2005 so it's</font>

451
00:23:47,460 --> 00:23:54,120
supposed<font color="#E5E5E5"> to quest instead of a get and</font>

452
00:23:50,150 --> 00:24:01,920
the data is base64 and AES encrypted

453
00:23:54,120 --> 00:24:06,320
this time<font color="#E5E5E5"> the AES</font><font color="#CCCCCC"> IV is</font><font color="#E5E5E5"> the last 16</font>

454
00:24:01,920 --> 00:24:06,320
bytes and the key is the first 16 bytes

455
00:24:06,710 --> 00:24:10,390
so this

456
00:24:08,140 --> 00:24:13,090
gives ya the IP address the<font color="#CCCCCC"> host name</font>

457
00:24:10,390 --> 00:24:15,390
and an infection<font color="#E5E5E5"> identifier when it when</font>

458
00:24:13,090 --> 00:24:15,389
it<font color="#E5E5E5"> starts</font>

459
00:24:15,870 --> 00:24:21,790
unlike<font color="#E5E5E5"> rural CLI</font>

460
00:24:18,780 --> 00:24:25,389
besito when it<font color="#E5E5E5"> responds back</font><font color="#CCCCCC"> with an</font>

461
00:24:21,790 --> 00:24:26,950
HTML<font color="#CCCCCC"> the commands are not actually</font>

462
00:24:25,390 --> 00:24:30,310
prepended to the HTML

463
00:24:26,950 --> 00:24:32,260
<font color="#CCCCCC">they are inside a view state field</font><font color="#E5E5E5"> so</font>

464
00:24:30,310 --> 00:24:34,120
they would go and read HTML find the

465
00:24:32,260 --> 00:24:36,460
view state field and look for two

466
00:24:34,120 --> 00:24:38,219
markers<font color="#CCCCCC"> and you</font><font color="#E5E5E5"> can see there they're</font>

467
00:24:36,460 --> 00:24:43,480
highlighted in and<font color="#CCCCCC"> red this</font><font color="#E5E5E5"> is like</font>

468
00:24:38,220 --> 00:24:45,460
<font color="#E5E5E5">Google</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> 2 WP 8 h but Bismarck has</font>

469
00:24:43,480 --> 00:24:47,980
changed from back door<font color="#CCCCCC"> the</font><font color="#E5E5E5"> back door</font>

470
00:24:45,460 --> 00:24:49,840
whatever<font color="#E5E5E5"> back door yeah we found like</font>

471
00:24:47,980 --> 00:24:52,030
earlier sample of<font color="#CCCCCC"> beers 2005 using</font>

472
00:24:49,840 --> 00:24:53,919
different markers but typically they

473
00:24:52,030 --> 00:24:58,120
will be<font color="#E5E5E5"> included in between markers and</font>

474
00:24:53,920 --> 00:25:06,820
the data inside is again base64 and AES

475
00:24:58,120 --> 00:25:10,679
encrypted last up is<font color="#CCCCCC"> rural</font><font color="#E5E5E5"> DNS this was</font>

476
00:25:06,820 --> 00:25:13,030
the last addition to the<font color="#E5E5E5"> tool set and</font>

477
00:25:10,680 --> 00:25:16,150
this was<font color="#CCCCCC"> interesting it was</font><font color="#E5E5E5"> quite</font>

478
00:25:13,030 --> 00:25:19,180
different from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> previous ones as you</font>

479
00:25:16,150 --> 00:25:21,880
<font color="#E5E5E5">can see there the</font><font color="#CCCCCC"> compiled it is 2017</font>

480
00:25:19,180 --> 00:25:24,130
and this is in March<font color="#E5E5E5"> it was like</font>

481
00:25:21,880 --> 00:25:26,620
basically<font color="#E5E5E5"> a few months away</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> when we</font>

482
00:25:24,130 --> 00:25:27,970
start in the investigation<font color="#E5E5E5"> or when yeah</font>

483
00:25:26,620 --> 00:25:34,959
basically<font color="#E5E5E5"> a month away from the</font><font color="#CCCCCC"> mini</font>

484
00:25:27,970 --> 00:25:39,160
caps<font color="#CCCCCC"> alerts and this one contains</font>

485
00:25:34,960 --> 00:25:41,740
persistence<font color="#E5E5E5"> so you get a service it's a</font>

486
00:25:39,160 --> 00:25:46,090
<font color="#E5E5E5">DLL it runs as a service on the SVC</font>

487
00:25:41,740 --> 00:25:49,870
hosts by default<font color="#E5E5E5"> the services NWS</font><font color="#CCCCCC"> ap</font>

488
00:25:46,090 --> 00:25:52,570
agent but that can<font color="#CCCCCC"> be changed the DLL</font>

489
00:25:49,870 --> 00:25:56,889
can take arguments<font color="#E5E5E5"> change the service</font>

490
00:25:52,570 --> 00:26:02,770
name<font color="#E5E5E5"> and it uses the NS for</font>

491
00:25:56,890 --> 00:26:05,680
communication<font color="#CCCCCC"> for some reason</font><font color="#E5E5E5"> they're</font>

492
00:26:02,770 --> 00:26:07,750
sorry<font color="#E5E5E5"> the</font><font color="#CCCCCC"> image is</font><font color="#E5E5E5"> yeah not so</font>

493
00:26:05,680 --> 00:26:14,020
aggressive the sentence that's my

494
00:26:07,750 --> 00:26:16,720
mistake<font color="#CCCCCC"> I apologize this</font><font color="#E5E5E5"> is what the</font>

495
00:26:14,020 --> 00:26:20,320
<font color="#CCCCCC">beacon looks like so</font><font color="#E5E5E5"> it's a text request</font>

496
00:26:16,720 --> 00:26:22,660
<font color="#E5E5E5">and as you can see there I've</font>

497
00:26:20,320 --> 00:26:25,000
highlighted so

498
00:26:22,660 --> 00:26:29,700
many of you might be familiar with<font color="#E5E5E5"> what</font>

499
00:26:25,000 --> 00:26:33,190
the text request format<font color="#E5E5E5"> looks like so</font>

500
00:26:29,700 --> 00:26:35,890
the<font color="#E5E5E5"> 3f there that's highlighted in red</font>

501
00:26:33,190 --> 00:26:38,320
is<font color="#CCCCCC"> basically the</font><font color="#E5E5E5"> length of the first</font>

502
00:26:35,890 --> 00:26:41,440
<font color="#E5E5E5">subdomain so the first number of</font>

503
00:26:38,320 --> 00:26:45,790
characters that should be<font color="#E5E5E5"> read and then</font>

504
00:26:41,440 --> 00:26:49,780
the second one up is 12<font color="#E5E5E5"> that's again the</font>

505
00:26:45,790 --> 00:26:53,440
length of 12 characters and then finally

506
00:26:49,780 --> 00:26:56,050
you get<font color="#E5E5E5"> a 8 which is an</font><font color="#CCCCCC"> Spurs</font><font color="#E5E5E5"> the length</font>

507
00:26:53,440 --> 00:27:02,110
of the<font color="#E5E5E5"> answers domain and then</font><font color="#CCCCCC"> comm</font>

508
00:26:56,050 --> 00:27:03,850
which is<font color="#E5E5E5"> 3 and spurs</font><font color="#CCCCCC"> DNS resolver is the</font>

509
00:27:02,110 --> 00:27:07,870
one that's<font color="#E5E5E5"> only going to</font><font color="#CCCCCC"> be able to</font>

510
00:27:03,850 --> 00:27:09,520
<font color="#E5E5E5">resolve these requests so they will the</font>

511
00:27:07,870 --> 00:27:11,919
DNS<font color="#E5E5E5"> requests</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> get passed on on and</font>

512
00:27:09,520 --> 00:27:14,220
on<font color="#E5E5E5"> until there is over for</font><font color="#CCCCCC"> word</font><font color="#E5E5E5"> that</font>

513
00:27:11,920 --> 00:27:17,970
specific domain gets<font color="#CCCCCC"> their quest</font><font color="#E5E5E5"> and</font>

514
00:27:14,220 --> 00:27:22,450
basically the data that gets sent<font color="#E5E5E5"> is</font>

515
00:27:17,970 --> 00:27:26,680
what will be decoded<font color="#CCCCCC"> or handled by the C</font>

516
00:27:22,450 --> 00:27:29,170
to the<font color="#CCCCCC"> data</font><font color="#E5E5E5"> doesn't make much sense as</font>

517
00:27:26,680 --> 00:27:35,050
<font color="#CCCCCC">you can see there it's basically</font><font color="#E5E5E5"> a</font>

518
00:27:29,170 --> 00:27:38,080
sequence<font color="#E5E5E5"> of bytes</font><font color="#CCCCCC"> you can see Oh</font><font color="#E5E5E5"> 1 2</font><font color="#CCCCCC"> 3</font><font color="#E5E5E5"> 4</font>

519
00:27:35,050 --> 00:27:39,990
<font color="#E5E5E5">5 6</font><font color="#CCCCCC"> you know you can see like a sequence</font>

520
00:27:38,080 --> 00:27:42,520
there doesn't make<font color="#E5E5E5"> much sense</font>

521
00:27:39,990 --> 00:27:44,710
<font color="#CCCCCC">unfortunately when we</font><font color="#E5E5E5"> were looking at a</font>

522
00:27:42,520 --> 00:27:47,440
sample<font color="#E5E5E5"> at the time the C toes were down</font>

523
00:27:44,710 --> 00:27:52,150
so we didn't<font color="#CCCCCC"> really make much sense out</font>

524
00:27:47,440 --> 00:27:55,120
<font color="#E5E5E5">of this</font><font color="#CCCCCC"> information but</font><font color="#E5E5E5"> it would go on</font>

525
00:27:52,150 --> 00:27:57,180
<font color="#E5E5E5">so the first request would be</font><font color="#CCCCCC"> a 5</font>

526
00:27:55,120 --> 00:28:00,909
followed<font color="#E5E5E5"> by the sequence of</font><font color="#CCCCCC"> data and</font>

527
00:27:57,180 --> 00:28:06,280
then it<font color="#E5E5E5"> will try</font><font color="#CCCCCC"> again with X instead of</font>

528
00:28:00,910 --> 00:28:08,740
5 try again with V sorry 3 and then

529
00:28:06,280 --> 00:28:11,080
based 32 in<font color="#CCCCCC"> quotes the same</font><font color="#E5E5E5"> data so the</font>

530
00:28:08,740 --> 00:28:14,650
same data the<font color="#E5E5E5"> same zeros and then 0 1 2</font>

531
00:28:11,080 --> 00:28:18,399
<font color="#CCCCCC">3</font><font color="#E5E5E5"> gets very</font><font color="#CCCCCC"> based 32 encoded and then</font>

532
00:28:14,650 --> 00:28:20,170
gets appended to<font color="#E5E5E5"> 3 and then another the</font>

533
00:28:18,400 --> 00:28:21,970
same thing again<font color="#CCCCCC"> with variants and</font><font color="#E5E5E5"> it</font>

534
00:28:20,170 --> 00:28:27,900
goes on<font color="#E5E5E5"> in like an infinity which is</font>

535
00:28:21,970 --> 00:28:27,900
trying<font color="#E5E5E5"> to</font><font color="#CCCCCC"> post this</font><font color="#E5E5E5"> request to the DNS</font>

536
00:28:29,460 --> 00:28:34,870
so this is purely here because we

537
00:28:31,930 --> 00:28:36,909
couldn't get<font color="#E5E5E5"> the C</font><font color="#CCCCCC"> 2 working</font>

538
00:28:34,870 --> 00:28:42,389
or responding to any<font color="#E5E5E5"> requests</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

539
00:28:36,909 --> 00:28:46,450
purely from<font color="#E5E5E5"> reverse engineering so if</font>

540
00:28:42,389 --> 00:28:48,729
the scene<font color="#E5E5E5"> to response they would hash</font>

541
00:28:46,450 --> 00:28:51,399
the hostname<font color="#CCCCCC"> Zoar it with a volume</font>

542
00:28:48,730 --> 00:28:55,870
serial number<font color="#E5E5E5"> and then use that as</font><font color="#CCCCCC"> a</font>

543
00:28:51,399 --> 00:28:58,719
fingerprint<font color="#CCCCCC"> for the infection they would</font>

544
00:28:55,870 --> 00:29:01,539
typically read data from<font color="#E5E5E5"> and then go on</font>

545
00:28:58,720 --> 00:29:04,870
<font color="#E5E5E5">having data from</font><font color="#CCCCCC"> c un</font><font color="#E5E5E5"> dos temp</font><font color="#CCCCCC"> esto</font><font color="#E5E5E5"> text</font>

546
00:29:01,539 --> 00:29:06,539
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> hard-coded</font><font color="#E5E5E5"> so they always read</font>

547
00:29:04,870 --> 00:29:09,939
the same file

548
00:29:06,539 --> 00:29:12,340
<font color="#CCCCCC">rc4</font><font color="#E5E5E5"> encrypt the data and</font><font color="#CCCCCC"> encode it and</font>

549
00:29:09,940 --> 00:29:17,369
then send<font color="#E5E5E5"> DNS requests with this</font>

550
00:29:12,340 --> 00:29:21,249
information here for responses received

551
00:29:17,369 --> 00:29:26,980
from the<font color="#CCCCCC"> cito then they would execute</font>

552
00:29:21,249 --> 00:29:29,590
<font color="#E5E5E5">these commands the functions of the</font>

553
00:29:26,980 --> 00:29:33,039
<font color="#CCCCCC">backdoor are very limited</font><font color="#E5E5E5"> so if only</font>

554
00:29:29,590 --> 00:29:36,820
supports execution and<font color="#CCCCCC"> some loot doesn't</font>

555
00:29:33,039 --> 00:29:38,230
upload really yeah<font color="#E5E5E5"> it reads like it</font>

556
00:29:36,820 --> 00:29:42,850
reads basically the output of the

557
00:29:38,230 --> 00:29:43,570
execution from<font color="#CCCCCC"> esta Tex encodes it and</font>

558
00:29:42,850 --> 00:29:46,449
sends it<font color="#E5E5E5"> back</font>

559
00:29:43,570 --> 00:29:48,999
so basically execute<font color="#E5E5E5"> get relief which is</font>

560
00:29:46,450 --> 00:29:51,970
the<font color="#E5E5E5"> result of the execution or download</font>

561
00:29:48,999 --> 00:29:57,820
data to a hard-coded<font color="#E5E5E5"> paths which is</font><font color="#CCCCCC"> see</font>

562
00:29:51,970 --> 00:30:01,779
when the stem<font color="#CCCCCC"> or the exe what was</font>

563
00:29:57,820 --> 00:30:06,730
interesting was they used<font color="#CCCCCC"> the same file</font>

564
00:30:01,779 --> 00:30:10,210
<font color="#E5E5E5">mapping object name in this case my W</font>

565
00:30:06,730 --> 00:30:12,490
objects which was very when I first saw

566
00:30:10,210 --> 00:30:14,200
this I was like<font color="#E5E5E5"> I saw this before where</font>

567
00:30:12,490 --> 00:30:20,100
did I<font color="#E5E5E5"> see it and</font><font color="#CCCCCC"> that was really annoyed</font>

568
00:30:14,200 --> 00:30:22,480
and so<font color="#E5E5E5"> this was a</font><font color="#CCCCCC"> very good indicator of</font>

569
00:30:20,100 --> 00:30:24,549
this is<font color="#E5E5E5"> actually the same</font><font color="#CCCCCC"> thing this is</font>

570
00:30:22,480 --> 00:30:27,490
<font color="#CCCCCC">actually the same group probably</font><font color="#E5E5E5"> even</font>

571
00:30:24,549 --> 00:30:28,869
though<font color="#E5E5E5"> they moved away from HTTP even</font>

572
00:30:27,490 --> 00:30:34,389
though they're using persistence at the

573
00:30:28,869 --> 00:30:36,699
<font color="#CCCCCC">backdoor that</font><font color="#E5E5E5"> was what gave it away</font><font color="#CCCCCC"> they</font>

574
00:30:34,389 --> 00:30:39,939
were typically again<font color="#CCCCCC"> used batch files so</font>

575
00:30:36,700 --> 00:30:43,090
this was another<font color="#CCCCCC"> thing commands</font><font color="#E5E5E5"> are</font>

576
00:30:39,940 --> 00:30:45,580
written to<font color="#E5E5E5"> our dog bath in the sea when</font>

577
00:30:43,090 --> 00:30:47,449
<font color="#E5E5E5">the stem directory you get executed and</font>

578
00:30:45,580 --> 00:30:50,810
the commands<font color="#E5E5E5"> get pipe</font>

579
00:30:47,450 --> 00:30:55,550
the result gets piped into<font color="#CCCCCC"> estopped X</font>

580
00:30:50,810 --> 00:31:01,550
which gets on each<font color="#E5E5E5"> iteration</font><font color="#CCCCCC"> read</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> see</font>

581
00:30:55,550 --> 00:31:06,560
<font color="#E5E5E5">four encoded such etc when</font><font color="#CCCCCC"> you look at</font>

582
00:31:01,550 --> 00:31:10,070
even<font color="#CCCCCC"> the function for the writing or</font>

583
00:31:06,560 --> 00:31:12,889
downloading<font color="#CCCCCC"> to files</font><font color="#E5E5E5"> you can see there</font>

584
00:31:10,070 --> 00:31:15,560
it's almost identical<font color="#CCCCCC"> so this is the</font>

585
00:31:12,890 --> 00:31:18,370
final mapping so my deputy object<font color="#CCCCCC"> howard</font>

586
00:31:15,560 --> 00:31:21,649
<font color="#CCCCCC">swiss basically so</font><font color="#E5E5E5"> it when they download</font>

587
00:31:18,370 --> 00:31:24,050
data they were try to target<font color="#CCCCCC"> e exceeds</font>

588
00:31:21,650 --> 00:31:26,630
<font color="#CCCCCC">it's the same function that droid CLI</font>

589
00:31:24,050 --> 00:31:29,270
uses when they<font color="#CCCCCC"> download data</font><font color="#E5E5E5"> are to toe</font>

590
00:31:26,630 --> 00:31:33,950
<font color="#E5E5E5">file and they're using the same</font><font color="#CCCCCC"> ini</font>

591
00:31:29,270 --> 00:31:39,020
technique as well yeah<font color="#E5E5E5"> basically exactly</font>

592
00:31:33,950 --> 00:31:41,360
<font color="#E5E5E5">the</font><font color="#CCCCCC"> same</font><font color="#E5E5E5"> so thank a PK 15 for good news</font>

593
00:31:39,020 --> 00:31:43,850
because<font color="#CCCCCC"> that was</font><font color="#E5E5E5"> very useful for</font><font color="#CCCCCC"> us to</font>

594
00:31:41,360 --> 00:31:47,419
actually<font color="#E5E5E5"> tie this sample to</font><font color="#CCCCCC"> the previous</font>

595
00:31:43,850 --> 00:31:51,379
samples<font color="#CCCCCC"> copy based on functions is</font>

596
00:31:47,420 --> 00:31:54,680
heavily actually used across different

597
00:31:51,380 --> 00:31:56,150
<font color="#CCCCCC">actors and different</font><font color="#E5E5E5"> to booster so it's</font>

598
00:31:54,680 --> 00:32:03,290
it's a good technique<font color="#CCCCCC"> generally</font><font color="#E5E5E5"> speaking</font>

599
00:31:56,150 --> 00:32:04,730
to try to find similar samples we found

600
00:32:03,290 --> 00:32:08,060
<font color="#E5E5E5">that</font><font color="#CCCCCC"> actually they didn't have any</font>

601
00:32:04,730 --> 00:32:11,210
<font color="#E5E5E5">problems investing time developing their</font>

602
00:32:08,060 --> 00:32:12,560
<font color="#E5E5E5">own tools for the target so I mean</font>

603
00:32:11,210 --> 00:32:13,550
they've been<font color="#E5E5E5"> there</font><font color="#CCCCCC"> since that</font><font color="#E5E5E5"> means to</font>

604
00:32:12,560 --> 00:32:16,129
<font color="#CCCCCC">8th 2016</font>

605
00:32:13,550 --> 00:32:19,340
why wouldn't<font color="#E5E5E5"> they they would go back</font>

606
00:32:16,130 --> 00:32:22,220
<font color="#E5E5E5">right there SharePoint or</font><font color="#CCCCCC"> Exchange</font>

607
00:32:19,340 --> 00:32:28,220
integration tools and then deploy them

608
00:32:22,220 --> 00:32:29,870
and yeah<font color="#E5E5E5"> why not probably operation and</font>

609
00:32:28,220 --> 00:32:33,530
develop and go hand in hand<font color="#E5E5E5"> for this</font>

610
00:32:29,870 --> 00:32:36,110
group so they are<font color="#E5E5E5"> not separate</font><font color="#CCCCCC"> I believe</font>

611
00:32:33,530 --> 00:32:37,820
or I<font color="#E5E5E5"> think that some in</font><font color="#CCCCCC"> Summit some</font>

612
00:32:36,110 --> 00:32:41,149
instance of actors out<font color="#CCCCCC"> there they</font>

613
00:32:37,820 --> 00:32:42,530
<font color="#CCCCCC">outsource development or develop done by</font>

614
00:32:41,150 --> 00:32:45,770
a different<font color="#CCCCCC"> group</font><font color="#E5E5E5"> and so operation</font><font color="#CCCCCC"> would</font>

615
00:32:42,530 --> 00:32:49,399
be<font color="#CCCCCC"> develop</font><font color="#E5E5E5"> and be separate but the fact</font>

616
00:32:45,770 --> 00:32:53,940
that we had this builder for the

617
00:32:49,400 --> 00:32:59,010
<font color="#E5E5E5">keylogger we had the dotnet tools</font>

618
00:32:53,940 --> 00:33:07,080
I think probably it's the<font color="#E5E5E5"> same person or</font>

619
00:32:59,010 --> 00:33:08,790
team<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> behind this</font><font color="#CCCCCC"> you can find</font>

620
00:33:07,080 --> 00:33:11,970
the decoding<font color="#E5E5E5"> scripts and yard signatures</font>

621
00:33:08,790 --> 00:33:17,990
<font color="#E5E5E5">for this group on the group's github</font>

622
00:33:11,970 --> 00:33:20,910
page and that's right

623
00:33:17,990 --> 00:33:22,980
yeah<font color="#CCCCCC"> thanks</font><font color="#E5E5E5"> to everyone who has actually</font>

624
00:33:20,910 --> 00:33:27,050
<font color="#E5E5E5">helped</font><font color="#CCCCCC"> Lister this</font><font color="#E5E5E5"> is a shout out to the</font>

625
00:33:22,980 --> 00:33:31,950
guys<font color="#E5E5E5"> in NCC</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> pops</font><font color="#CCCCCC"> IT who were very</font>

626
00:33:27,050 --> 00:33:34,830
helpful<font color="#E5E5E5"> on this operation</font><font color="#CCCCCC"> I believe are</font>

627
00:33:31,950 --> 00:33:36,980
very<font color="#CCCCCC"> early on time</font><font color="#E5E5E5"> so happy to take</font>

628
00:33:34,830 --> 00:33:36,980
questions

629
00:33:37,100 --> 00:33:42,510
superb so do we have<font color="#E5E5E5"> any</font><font color="#CCCCCC"> questions for</font>

630
00:33:39,390 --> 00:33:50,220
you<font color="#E5E5E5"> just say</font><font color="#CCCCCC"> rivets all</font><font color="#E5E5E5"> right that tries</font>

631
00:33:42,510 --> 00:33:54,450
to ring the mic up<font color="#CCCCCC"> to I'm sorry I could</font>

632
00:33:50,220 --> 00:33:58,110
have had a question<font color="#CCCCCC"> down the bar I need</font>

633
00:33:54,450 --> 00:33:59,610
to do some weight<font color="#E5E5E5"> thanks</font><font color="#CCCCCC"> Don when you're</font>

634
00:33:58,110 --> 00:34:03,080
<font color="#E5E5E5">looking at this did you get any</font>

635
00:33:59,610 --> 00:34:06,179
<font color="#CCCCCC">indication of what level</font><font color="#E5E5E5"> of automation</font>

636
00:34:03,080 --> 00:34:08,520
was there was through a lot<font color="#E5E5E5"> of</font>

637
00:34:06,180 --> 00:34:11,820
interaction with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> attackers who did</font>

638
00:34:08,520 --> 00:34:16,290
he do most<font color="#E5E5E5"> of this stuff like from</font>

639
00:34:11,820 --> 00:34:21,580
<font color="#E5E5E5">scripts</font><font color="#CCCCCC"> in automatically automation you</font>

640
00:34:16,290 --> 00:34:23,840
know obviously<font color="#E5E5E5"> on the server side yes so</font>

641
00:34:21,580 --> 00:34:26,639
[Music]

642
00:34:23,840 --> 00:34:29,610
when we were there<font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't believe we</font>

643
00:34:26,639 --> 00:34:33,150
had activity<font color="#CCCCCC"> ongoing</font><font color="#E5E5E5"> so during the times</font>

644
00:34:29,610 --> 00:34:34,740
that NCC he do one goal which is where

645
00:34:33,150 --> 00:34:38,210
we<font color="#E5E5E5"> have a couple</font><font color="#CCCCCC"> of months and then a</font>

646
00:34:34,739 --> 00:34:40,469
couple<font color="#E5E5E5"> of months</font><font color="#CCCCCC"> later so</font><font color="#E5E5E5"> two intervals</font>

647
00:34:38,210 --> 00:34:42,750
<font color="#E5E5E5">we don't think we've had a lot of</font>

648
00:34:40,469 --> 00:34:48,689
interaction when we were there with<font color="#E5E5E5"> the</font>

649
00:34:42,750 --> 00:34:50,010
<font color="#CCCCCC">attactive but I think it's hard to get</font>

650
00:34:48,690 --> 00:34:52,889
the level of automation<font color="#CCCCCC"> the fact that</font>

651
00:34:50,010 --> 00:34:57,750
<font color="#CCCCCC">they were using</font><font color="#E5E5E5"> like manual commands for</font>

652
00:34:52,889 --> 00:34:59,190
the<font color="#CCCCCC"> backdoors</font><font color="#E5E5E5"> I wouldn't say there is a</font>

653
00:34:57,750 --> 00:35:02,670
lot<font color="#CCCCCC"> of automation happening in the</font>

654
00:34:59,190 --> 00:35:03,870
background<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the server side but that's</font>

655
00:35:02,670 --> 00:35:05,660
a pure<font color="#E5E5E5"> guess because</font><font color="#CCCCCC"> I don't have</font>

656
00:35:03,870 --> 00:35:11,779
insight<font color="#CCCCCC"> into the</font><font color="#E5E5E5"> c2</font>

657
00:35:05,660 --> 00:35:20,000
I didn't get access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> sir yeah oh go</font><font color="#E5E5E5"> to</font>

658
00:35:11,779 --> 00:35:21,589
<font color="#E5E5E5">fetch my father was the environment</font>

659
00:35:20,000 --> 00:35:23,509
being attacked<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> and the</font>

660
00:35:21,589 --> 00:35:25,400
environment<font color="#E5E5E5"> because all of the</font><font color="#CCCCCC"> examples</font>

661
00:35:23,509 --> 00:35:27,170
<font color="#CCCCCC">you gave</font><font color="#E5E5E5"> there were attacking</font><font color="#CCCCCC"> windows</font>

662
00:35:25,400 --> 00:35:30,799
systems as opposed to you next<font color="#E5E5E5"> anything</font>

663
00:35:27,170 --> 00:35:32,539
else<font color="#CCCCCC"> sir so the</font><font color="#E5E5E5"> question is whether the</font>

664
00:35:30,799 --> 00:35:35,630
attacks<font color="#CCCCCC"> were</font><font color="#E5E5E5"> only focused on Windows</font>

665
00:35:32,539 --> 00:35:37,309
platforms yes<font color="#E5E5E5"> definitely yes yeah yeah</font>

666
00:35:35,630 --> 00:35:43,130
we<font color="#E5E5E5"> can find any instance of attacks on</font>

667
00:35:37,309 --> 00:35:51,230
none<font color="#E5E5E5"> Windows servers on the</font><font color="#CCCCCC"> fly</font><font color="#E5E5E5"> that's</font>

668
00:35:43,130 --> 00:35:52,910
<font color="#CCCCCC">right a bit</font><font color="#E5E5E5"> of exercise</font><font color="#CCCCCC"> morning</font><font color="#E5E5E5"> yeah if</font>

669
00:35:51,230 --> 00:35:59,539
we do fall over<font color="#CCCCCC"> everybody cheer by the</font>

670
00:35:52,910 --> 00:36:01,970
way<font color="#CCCCCC"> do you have</font><font color="#E5E5E5"> any idea the volume of</font>

671
00:35:59,539 --> 00:36:07,759
<font color="#E5E5E5">data and number of files the</font><font color="#CCCCCC"> guide sort</font>

672
00:36:01,970 --> 00:36:09,319
<font color="#E5E5E5">rated in this we do I mean I don't have</font>

673
00:36:07,759 --> 00:36:12,740
<font color="#E5E5E5">the exact</font><font color="#CCCCCC"> figures</font><font color="#E5E5E5"> off the top of my head</font>

674
00:36:09,319 --> 00:36:14,660
<font color="#CCCCCC">but</font><font color="#E5E5E5"> we definitely traced the number</font><font color="#CCCCCC"> of</font>

675
00:36:12,740 --> 00:36:19,359
<font color="#E5E5E5">points that we expect rated and the data</font>

676
00:36:14,660 --> 00:36:26,660
associated<font color="#E5E5E5"> so we're looking at emails</font>

677
00:36:19,359 --> 00:36:28,250
<font color="#CCCCCC">document network mapping information in</font>

678
00:36:26,660 --> 00:36:31,118
<font color="#E5E5E5">terms of volume</font><font color="#CCCCCC"> I don't think it was</font>

679
00:36:28,250 --> 00:36:36,650
large per se and not not huge but

680
00:36:31,119 --> 00:36:42,920
definitely important information oh not

681
00:36:36,650 --> 00:36:44,390
<font color="#E5E5E5">so far good Japanese idea</font><font color="#CCCCCC"> why the attack</font>

682
00:36:42,920 --> 00:36:46,849
was picking this target like have you

683
00:36:44,390 --> 00:36:48,740
<font color="#E5E5E5">found them other other similar related</font>

684
00:36:46,849 --> 00:36:51,980
clients is there anything in<font color="#E5E5E5"> common that</font>

685
00:36:48,740 --> 00:36:55,038
well<font color="#E5E5E5"> we think it's</font><font color="#CCCCCC"> at the</font><font color="#E5E5E5"> typical</font><font color="#CCCCCC"> I</font>

686
00:36:51,980 --> 00:36:58,339
think kind of like supply chain<font color="#E5E5E5"> so</font>

687
00:36:55,039 --> 00:36:59,930
<font color="#E5E5E5">they're after government related</font>

688
00:36:58,339 --> 00:37:02,240
information<font color="#CCCCCC"> so they went to a</font>

689
00:36:59,930 --> 00:37:04,240
<font color="#CCCCCC">contractors and they talked did that</font>

690
00:37:02,240 --> 00:37:06,740
constructor to get that information

691
00:37:04,240 --> 00:37:10,910
<font color="#CCCCCC">previously they were targeting according</font>

692
00:37:06,740 --> 00:37:15,709
to fire and Palo Alto<font color="#E5E5E5"> like government</font>

693
00:37:10,910 --> 00:37:18,109
<font color="#E5E5E5">entities so embassies etc so it looks</font>

694
00:37:15,710 --> 00:37:19,070
like<font color="#E5E5E5"> instead of</font><font color="#CCCCCC"> going directly to their</font>

695
00:37:18,109 --> 00:37:21,290
targets they're going

696
00:37:19,070 --> 00:37:22,730
<font color="#E5E5E5">through someone</font><font color="#CCCCCC"> who'll be working with</font>

697
00:37:21,290 --> 00:37:24,940
their target<font color="#CCCCCC"> you know if they get</font><font color="#E5E5E5"> the</font>

698
00:37:22,730 --> 00:37:24,940
<font color="#CCCCCC">information</font>

699
00:37:26,540 --> 00:37:30,680
thanks for presentation I<font color="#CCCCCC"> just</font><font color="#E5E5E5"> cover</font>

700
00:37:28,670 --> 00:37:34,190
that

701
00:37:30,680 --> 00:37:35,990
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> just have a small question</font><font color="#CCCCCC"> you</font>

702
00:37:34,190 --> 00:37:37,310
said that development<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> parishioner</font>

703
00:37:35,990 --> 00:37:40,339
we're going together

704
00:37:37,310 --> 00:37:42,710
so and what do you<font color="#E5E5E5"> think the code it</font>

705
00:37:40,340 --> 00:37:44,510
looks<font color="#CCCCCC"> like Bank Bank production oh they</font>

706
00:37:42,710 --> 00:37:45,860
<font color="#CCCCCC">still first-time intestine</font><font color="#E5E5E5"> and</font>

707
00:37:44,510 --> 00:37:47,750
<font color="#CCCCCC">everything because of</font><font color="#E5E5E5"> the typos and</font>

708
00:37:45,860 --> 00:37:49,250
<font color="#E5E5E5">everything</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> think there's I don't</font>

709
00:37:47,750 --> 00:37:51,790
think there's a<font color="#E5E5E5"> lot of testing happening</font>

710
00:37:49,250 --> 00:37:54,650
and this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> evidence I'd say from the</font>

711
00:37:51,790 --> 00:37:58,070
<font color="#E5E5E5">DNS there</font><font color="#CCCCCC"> Oh Indiana stamp in the fact</font>

712
00:37:54,650 --> 00:38:00,530
that they had hard-coded paths<font color="#E5E5E5"> there so</font>

713
00:37:58,070 --> 00:38:02,330
they had<font color="#CCCCCC"> like a stop text or the exe</font>

714
00:38:00,530 --> 00:38:04,520
<font color="#E5E5E5">fact that you heart go the path for you</font>

715
00:38:02,330 --> 00:38:06,830
download for<font color="#E5E5E5"> downloading a file that</font>

716
00:38:04,520 --> 00:38:08,360
means you're poking your idea<font color="#E5E5E5"> you're</font>

717
00:38:06,830 --> 00:38:10,819
basically hard coding<font color="#E5E5E5"> this and see if</font>

718
00:38:08,360 --> 00:38:13,100
seeing if it<font color="#E5E5E5"> works and</font><font color="#CCCCCC"> then yeah so I</font>

719
00:38:10,820 --> 00:38:15,950
think it's kind<font color="#E5E5E5"> of like iterative model</font>

720
00:38:13,100 --> 00:38:16,370
of<font color="#CCCCCC"> write code</font><font color="#E5E5E5"> send it out see if it</font>

721
00:38:15,950 --> 00:38:18,799
works

722
00:38:16,370 --> 00:38:21,440
<font color="#CCCCCC">yeah that that kind of mode I think so</font>

723
00:38:18,800 --> 00:38:24,050
<font color="#E5E5E5">see so there was a second if</font>

724
00:38:21,440 --> 00:38:26,870
exfiltration or second<font color="#E5E5E5"> compromised in in</font>

725
00:38:24,050 --> 00:38:30,380
the<font color="#E5E5E5"> timeline what recommendations do</font><font color="#CCCCCC"> you</font>

726
00:38:26,870 --> 00:38:32,240
make for preventing<font color="#CCCCCC"> the compromise</font><font color="#E5E5E5"> only</font>

727
00:38:30,380 --> 00:38:33,730
<font color="#CCCCCC">in terms</font><font color="#E5E5E5"> of detection rather than just</font>

728
00:38:32,240 --> 00:38:35,649
<font color="#CCCCCC">waiting for the accidents are happen</font>

729
00:38:33,730 --> 00:38:37,700
that's<font color="#E5E5E5"> a very good question</font>

730
00:38:35,650 --> 00:38:42,410
<font color="#CCCCCC">fortunately I'm not</font><font color="#E5E5E5"> the one who actually</font>

731
00:38:37,700 --> 00:38:45,020
<font color="#CCCCCC">did the</font><font color="#E5E5E5"> report and so but typically</font>

732
00:38:42,410 --> 00:38:46,850
recommendations really<font color="#E5E5E5"> for many of the</font>

733
00:38:45,020 --> 00:38:50,120
incidents<font color="#E5E5E5"> that we run into involving</font>

734
00:38:46,850 --> 00:38:52,970
<font color="#CCCCCC">patching systems making</font><font color="#E5E5E5"> sure that you</font>

735
00:38:50,120 --> 00:38:56,630
could have a good hygiene IP wise in

736
00:38:52,970 --> 00:39:00,740
<font color="#E5E5E5">your state</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> think there's</font>

737
00:38:56,630 --> 00:39:03,980
anything I mean the case<font color="#E5E5E5"> of some</font><font color="#CCCCCC"> of the</font>

738
00:39:00,740 --> 00:39:07,149
compromises<font color="#E5E5E5"> hosts were for users</font><font color="#CCCCCC"> who</font>

739
00:39:03,980 --> 00:39:07,150
were actually

740
00:39:08,200 --> 00:39:14,270
consultants<font color="#CCCCCC"> working in specific sectors</font>

741
00:39:10,960 --> 00:39:17,540
<font color="#E5E5E5">and so education for these consultants</font>

742
00:39:14,270 --> 00:39:20,180
would<font color="#E5E5E5"> have helped what what emails</font>

743
00:39:17,540 --> 00:39:21,950
should you open<font color="#CCCCCC"> who should</font><font color="#E5E5E5"> you trust you</font>

744
00:39:20,180 --> 00:39:24,120
expect me sir to be<font color="#CCCCCC"> mail that sort of</font>

745
00:39:21,950 --> 00:39:28,029
thing

746
00:39:24,120 --> 00:39:31,150
yeah<font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> obviously in terms of like</font>

747
00:39:28,030 --> 00:39:34,660
they went and they<font color="#E5E5E5"> included like IDs</font>

748
00:39:31,150 --> 00:39:37,300
<font color="#E5E5E5">firewall this standard that you</font><font color="#CCCCCC"> would</font>

749
00:39:34,660 --> 00:39:38,170
get in<font color="#CCCCCC"> their many environments</font><font color="#E5E5E5"> but that</font>

750
00:39:37,300 --> 00:39:41,140
on its own

751
00:39:38,170 --> 00:39:42,790
I don't think because that's after the

752
00:39:41,140 --> 00:39:45,910
<font color="#CCCCCC">backdoor</font><font color="#E5E5E5"> has already been on</font><font color="#CCCCCC"> the network</font>

753
00:39:42,790 --> 00:39:48,190
<font color="#E5E5E5">right so you don't want to be you</font><font color="#CCCCCC"> know</font>

754
00:39:45,910 --> 00:39:49,660
chasing<font color="#E5E5E5"> beacons you want to be</font>

755
00:39:48,190 --> 00:39:55,620
preventing the back door in the first

756
00:39:49,660 --> 00:39:57,940
place getting<font color="#E5E5E5"> on</font><font color="#CCCCCC"> snowshoes yeah hi so</font>

757
00:39:55,620 --> 00:39:59,410
I'm always interested<font color="#E5E5E5"> in</font><font color="#CCCCCC"> faces</font><font color="#E5E5E5"> on this</font>

758
00:39:57,940 --> 00:40:00,550
to Johnny involvement with law

759
00:39:59,410 --> 00:40:02,859
enforcement<font color="#E5E5E5"> with all your findings</font>

760
00:40:00,550 --> 00:40:10,420
<font color="#E5E5E5">afterwards there was definitely law</font>

761
00:40:02,860 --> 00:40:12,190
enforcement involved in this<font color="#E5E5E5"> case not</font>

762
00:40:10,420 --> 00:40:15,030
<font color="#E5E5E5">sure I can share a lot</font><font color="#CCCCCC"> of details but</font>

763
00:40:12,190 --> 00:40:17,470
yeah there<font color="#E5E5E5"> was there was involvement</font>

764
00:40:15,030 --> 00:40:20,790
<font color="#CCCCCC">there was interaction definitely because</font>

765
00:40:17,470 --> 00:40:38,980
there<font color="#E5E5E5"> is government</font><font color="#CCCCCC"> reading information</font>

766
00:40:20,790 --> 00:40:41,920
do have any more<font color="#CCCCCC"> questions</font><font color="#E5E5E5"> so we</font>

767
00:40:38,980 --> 00:40:44,470
actually so we actually<font color="#CCCCCC"> beaten</font><font color="#E5E5E5"> the actor</font>

768
00:40:41,920 --> 00:40:46,930
to the same so<font color="#E5E5E5"> the attribution was to</font>

769
00:40:44,470 --> 00:40:52,270
the same group<font color="#CCCCCC"> that we know of</font><font color="#E5E5E5"> which is</font>

770
00:40:46,930 --> 00:40:54,790
<font color="#CCCCCC">a PG</font><font color="#E5E5E5"> 15</font><font color="#CCCCCC"> fireEye when they did</font><font color="#E5E5E5"> their a</font>

771
00:40:52,270 --> 00:40:57,180
child report<font color="#E5E5E5"> they believe that the</font>

772
00:40:54,790 --> 00:40:59,560
operation or<font color="#E5E5E5"> Janita from China and</font>

773
00:40:57,180 --> 00:41:02,500
<font color="#E5E5E5">according</font><font color="#CCCCCC"> to our analysis as well from</font>

774
00:40:59,560 --> 00:41:03,820
the<font color="#E5E5E5"> SI toos we can probably make the</font>

775
00:41:02,500 --> 00:41:06,190
same conclusion that<font color="#E5E5E5"> they</font><font color="#CCCCCC"> were operating</font>

776
00:41:03,820 --> 00:41:09,460
<font color="#CCCCCC">out of</font><font color="#E5E5E5"> China as well who in China I</font>

777
00:41:06,190 --> 00:41:11,910
don't know obviously<font color="#E5E5E5"> who is who they I</font>

778
00:41:09,460 --> 00:41:11,910
<font color="#E5E5E5">don't know</font>

779
00:41:15,710 --> 00:41:24,450
<font color="#CCCCCC">code so called</font><font color="#E5E5E5"> codon and the samples</font>

780
00:41:21,020 --> 00:41:25,980
<font color="#CCCCCC">think things like HTTP</font><font color="#E5E5E5"> I web browser</font><font color="#CCCCCC"> - I</font>

781
00:41:24,450 --> 00:41:29,038
<font color="#E5E5E5">mean this is common obviously across</font>

782
00:41:25,980 --> 00:41:29,910
many malware<font color="#E5E5E5"> but the combination of</font>

783
00:41:29,039 --> 00:41:32,789
<font color="#E5E5E5">things together</font>

784
00:41:29,910 --> 00:41:34,529
well<font color="#CCCCCC"> will</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> it okay this is the same</font>

785
00:41:32,789 --> 00:41:36,270
thing<font color="#CCCCCC"> that fire</font><font color="#E5E5E5"> I talked about and</font><font color="#CCCCCC"> that</font>

786
00:41:34,529 --> 00:41:37,619
<font color="#CCCCCC">one talked about so it's probably</font><font color="#E5E5E5"> the</font>

787
00:41:36,270 --> 00:41:41,009
same<font color="#E5E5E5"> crew yeah</font>

788
00:41:37,619 --> 00:41:47,490
do we have<font color="#E5E5E5"> any more questions</font><font color="#CCCCCC"> it's okay</font>

789
00:41:41,010 --> 00:41:49,319
<font color="#E5E5E5">we've got loads of</font><font color="#CCCCCC"> time thanks very much</font>

790
00:41:47,490 --> 00:41:50,970
<font color="#CCCCCC">the presentation always</font><font color="#E5E5E5"> useful to get</font>

791
00:41:49,319 --> 00:41:52,980
<font color="#CCCCCC">them insight into what the bad guys</font><font color="#E5E5E5"> are</font>

792
00:41:50,970 --> 00:41:55,319
up<font color="#CCCCCC"> to they don't</font><font color="#E5E5E5"> seem to cover their</font>

793
00:41:52,980 --> 00:41:57,599
tracks<font color="#CCCCCC"> very well though now think they</font>

794
00:41:55,319 --> 00:42:02,819
didn't care correct<font color="#E5E5E5"> yes</font>

795
00:41:57,599 --> 00:42:05,190
there was definitely<font color="#CCCCCC"> sense of not caring</font>

796
00:42:02,819 --> 00:42:06,558
<font color="#E5E5E5">if they get caught or</font><font color="#CCCCCC"> there found that</font>

797
00:42:05,190 --> 00:42:12,029
<font color="#CCCCCC">because they came in the second time</font>

798
00:42:06,559 --> 00:42:16,770
<font color="#E5E5E5">right</font><font color="#CCCCCC"> after we left yeah I completely</font>

799
00:42:12,029 --> 00:42:20,690
there<font color="#CCCCCC"> is there's</font><font color="#E5E5E5"> a sense of trying</font><font color="#CCCCCC"> to</font>

800
00:42:16,770 --> 00:42:20,690
hide their tracks or anything like<font color="#E5E5E5"> that</font>

801
00:42:24,380 --> 00:42:28,349
<font color="#CCCCCC">do you think they knew about you you</font>

802
00:42:26,700 --> 00:42:35,520
<font color="#E5E5E5">think that when</font><font color="#CCCCCC"> you forgetting about</font><font color="#E5E5E5"> the</font>

803
00:42:28,349 --> 00:42:37,349
first time they<font color="#CCCCCC"> knew it was</font><font color="#E5E5E5"> NCC did they</font>

804
00:42:35,520 --> 00:42:40,710
know<font color="#CCCCCC"> that someone was on the network</font>

805
00:42:37,349 --> 00:42:42,660
probably<font color="#E5E5E5"> yes NCC specifically I don't</font>

806
00:42:40,710 --> 00:42:46,730
know<font color="#E5E5E5"> I was involved in</font><font color="#CCCCCC"> that sometime I</font>

807
00:42:42,660 --> 00:42:49,558
was more of the<font color="#CCCCCC"> reverse engineer so but</font>

808
00:42:46,730 --> 00:42:52,140
Rob who worked with<font color="#E5E5E5"> me</font><font color="#CCCCCC"> on this</font>

809
00:42:49,559 --> 00:42:54,240
investigation<font color="#E5E5E5"> and and Alex or not I</font>

810
00:42:52,140 --> 00:42:56,819
don't<font color="#E5E5E5"> think they're</font><font color="#CCCCCC"> here today</font><font color="#E5E5E5"> there</font>

811
00:42:54,240 --> 00:42:59,160
will<font color="#CCCCCC"> be better</font><font color="#E5E5E5"> positioned to answer that</font>

812
00:42:56,819 --> 00:43:01,109
<font color="#E5E5E5">whether they were actually they</font><font color="#CCCCCC"> think</font>

813
00:42:59,160 --> 00:43:04,288
<font color="#CCCCCC">that</font><font color="#E5E5E5"> they were NCC on the network but I</font>

814
00:43:01,109 --> 00:43:06,869
don't think they knew<font color="#E5E5E5"> someone was on the</font>

815
00:43:04,289 --> 00:43:10,920
network whether it was NCC<font color="#E5E5E5"> or not</font><font color="#CCCCCC"> I</font>

816
00:43:06,869 --> 00:43:13,740
don't<font color="#CCCCCC"> think so I'm</font><font color="#E5E5E5"> wondering how much</font>

817
00:43:10,920 --> 00:43:15,869
all the clients<font color="#CCCCCC"> thought they were in</font>

818
00:43:13,740 --> 00:43:18,538
terms of<font color="#CCCCCC"> the shock capability was it</font>

819
00:43:15,869 --> 00:43:19,350
somebody job to spot this sort of attack

820
00:43:18,539 --> 00:43:21,710
<font color="#E5E5E5">and</font>

821
00:43:19,350 --> 00:43:25,200
the reaction based on the fact that<font color="#CCCCCC"> they</font>

822
00:43:21,710 --> 00:43:26,700
<font color="#CCCCCC">watch a</font><font color="#E5E5E5"> movie</font><font color="#CCCCCC"> so again I can't really</font>

823
00:43:25,200 --> 00:43:29,490
answer that question<font color="#CCCCCC"> very because I</font>

824
00:43:26,700 --> 00:43:33,750
wasn't<font color="#E5E5E5"> involved on the customer side</font>

825
00:43:29,490 --> 00:43:38,040
very much on<font color="#E5E5E5"> on the network but I can</font>

826
00:43:33,750 --> 00:43:40,050
tell you that<font color="#CCCCCC"> I mean they</font><font color="#E5E5E5"> they had the</font>

827
00:43:38,040 --> 00:43:43,170
<font color="#E5E5E5">mini</font><font color="#CCCCCC"> cats alert and they were started</font>

828
00:43:40,050 --> 00:43:46,830
off that<font color="#CCCCCC"> alert</font><font color="#E5E5E5"> they started to triage</font>

829
00:43:43,170 --> 00:43:49,020
things but in terms<font color="#CCCCCC"> of what we found</font>

830
00:43:46,830 --> 00:43:52,170
<font color="#E5E5E5">what we find typically I mean not myself</font>

831
00:43:49,020 --> 00:43:56,280
<font color="#E5E5E5">but the instant response guys as that</font>

832
00:43:52,170 --> 00:43:58,080
many<font color="#E5E5E5"> customers will have you know nice</font>

833
00:43:56,280 --> 00:44:00,030
budgets and<font color="#E5E5E5"> they will put nice</font>

834
00:43:58,080 --> 00:44:02,910
appliances<font color="#E5E5E5"> here there but they wouldn't</font>

835
00:44:00,030 --> 00:44:07,260
<font color="#E5E5E5">have processes they wouldn't have the</font>

836
00:44:02,910 --> 00:44:09,810
proper things like who would do<font color="#CCCCCC"> what and</font>

837
00:44:07,260 --> 00:44:11,790
<font color="#E5E5E5">when this escalate through to</font><font color="#CCCCCC"> escalated</font>

838
00:44:09,810 --> 00:44:13,560
<font color="#CCCCCC">to and what should they be these kinds</font>

839
00:44:11,790 --> 00:44:16,710
of steps are<font color="#E5E5E5"> not very clear so they</font>

840
00:44:13,560 --> 00:44:19,049
would spend<font color="#E5E5E5"> money on very expensive</font><font color="#CCCCCC"> kids</font>

841
00:44:16,710 --> 00:44:22,110
<font color="#E5E5E5">but it will be useless because there</font>

842
00:44:19,050 --> 00:44:28,350
would be like no one<font color="#E5E5E5"> really looking at</font>

843
00:44:22,110 --> 00:44:30,090
this sort of<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> alright so</font><font color="#E5E5E5"> item we're</font>

844
00:44:28,350 --> 00:44:31,440
gonna set<font color="#CCCCCC"> up a defense but from my</font>

845
00:44:30,090 --> 00:44:34,260
perspective it looks like they use

846
00:44:31,440 --> 00:44:36,510
<font color="#E5E5E5">credit data techniques</font><font color="#CCCCCC"> they used a quite</font>

847
00:44:34,260 --> 00:44:38,280
<font color="#E5E5E5">dated techniques</font><font color="#CCCCCC"> they will</font><font color="#E5E5E5"> compromise</font>

848
00:44:36,510 --> 00:44:40,860
we're lucky if we're dropping binaries

849
00:44:38,280 --> 00:44:43,650
on<font color="#E5E5E5"> drive they're using DNS queries for</font>

850
00:44:40,860 --> 00:44:46,440
communications<font color="#CCCCCC"> they're using batch files</font>

851
00:44:43,650 --> 00:44:48,600
which kind of is<font color="#CCCCCC"> above the past</font><font color="#E5E5E5"> I don't</font>

852
00:44:46,440 --> 00:44:50,670
<font color="#E5E5E5">see any PowerShell staff nothing which</font>

853
00:44:48,600 --> 00:44:53,460
<font color="#E5E5E5">it would be kind of characteristic of a</font>

854
00:44:50,670 --> 00:44:58,260
modern red teaming<font color="#CCCCCC"> technique so no past</font>

855
00:44:53,460 --> 00:45:01,530
no no no I'm surprised<font color="#CCCCCC"> boy no yeah I'm</font>

856
00:44:58,260 --> 00:45:03,720
<font color="#E5E5E5">surprised for you having me code to even</font>

857
00:45:01,530 --> 00:45:09,060
quicker and at the<font color="#E5E5E5"> front we don't kind</font>

858
00:45:03,720 --> 00:45:11,339
<font color="#E5E5E5">of Sedona</font><font color="#CCCCCC"> maybe so this is one thing</font>

859
00:45:09,060 --> 00:45:14,790
like I've been so I've<font color="#E5E5E5"> been doing like</font>

860
00:45:11,340 --> 00:45:16,830
malware<font color="#E5E5E5"> for quite a long time and there</font>

861
00:45:14,790 --> 00:45:22,610
are<font color="#E5E5E5"> from my experience there are</font><font color="#CCCCCC"> these</font>

862
00:45:16,830 --> 00:45:25,230
<font color="#E5E5E5">types of new offensive techniques that</font>

863
00:45:22,610 --> 00:45:28,170
everyone starts used at certain point in

864
00:45:25,230 --> 00:45:29,670
<font color="#CCCCCC">time</font><font color="#E5E5E5"> and the whole industry</font><font color="#CCCCCC"> just rushes</font>

865
00:45:28,170 --> 00:45:31,980
to try to prevent these sort of

866
00:45:29,670 --> 00:45:32,790
techniques<font color="#E5E5E5"> and forgets about what</font>

867
00:45:31,980 --> 00:45:35,490
actually

868
00:45:32,790 --> 00:45:38,279
<font color="#E5E5E5">already you know standard stuff that's</font>

869
00:45:35,490 --> 00:45:41,850
been used for<font color="#CCCCCC"> a</font><font color="#E5E5E5"> long time</font><font color="#CCCCCC"> so in some</font>

870
00:45:38,280 --> 00:45:44,370
<font color="#CCCCCC">instances you don't need to use fancy</font>

871
00:45:41,850 --> 00:45:45,660
<font color="#E5E5E5">new offensive techniques or you know you</font>

872
00:45:44,370 --> 00:45:48,180
use the<font color="#E5E5E5"> latest get from the</font>

873
00:45:45,660 --> 00:45:49,740
<font color="#E5E5E5">sophistication or whatever you don't</font>

874
00:45:48,180 --> 00:45:51,600
sometimes need<font color="#CCCCCC"> to do any</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> stuff</font>

875
00:45:49,740 --> 00:45:52,950
it's<font color="#CCCCCC"> very simple because simply the</font>

876
00:45:51,600 --> 00:46:00,540
network with the target that<font color="#E5E5E5"> you are</font>

877
00:45:52,950 --> 00:46:02,279
<font color="#E5E5E5">interested in it's very weak hello sir</font>

878
00:46:00,540 --> 00:46:04,500
how<font color="#CCCCCC"> many of the actual</font><font color="#E5E5E5"> taser taser</font>

879
00:46:02,280 --> 00:46:09,230
turned<font color="#E5E5E5"> off anyway</font><font color="#CCCCCC"> honest early active</font>

880
00:46:04,500 --> 00:46:09,230
<font color="#E5E5E5">Martin to see if</font><font color="#CCCCCC"> it not</font><font color="#E5E5E5"> there not there</font>

881
00:46:13,340 --> 00:46:23,490
do we<font color="#E5E5E5"> have any more</font><font color="#CCCCCC"> questions</font><font color="#E5E5E5"> I feel</font>

882
00:46:19,020 --> 00:46:26,970
like<font color="#E5E5E5"> you should</font><font color="#CCCCCC"> sir showing my age of</font>

883
00:46:23,490 --> 00:46:28,350
over<font color="#E5E5E5"> that so they're in the network</font><font color="#CCCCCC"> for</font>

884
00:46:26,970 --> 00:46:30,000
quite<font color="#E5E5E5"> a while and you don't really</font>

885
00:46:28,350 --> 00:46:31,620
thought how long they're<font color="#CCCCCC"> in</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> Chris</font>

886
00:46:30,000 --> 00:46:34,680
obviously<font color="#E5E5E5"> they did a transformation</font>

887
00:46:31,620 --> 00:46:36,200
piece<font color="#CCCCCC"> you certain is just one actor was</font>

888
00:46:34,680 --> 00:46:39,509
it multiple actors in there at the time

889
00:46:36,200 --> 00:46:41,189
<font color="#E5E5E5">we think it's one from what we looked at</font>

890
00:46:39,510 --> 00:46:44,070
I mean they had<font color="#CCCCCC"> obviously a lot of</font>

891
00:46:41,190 --> 00:46:49,410
alerts and stuff but from our work

892
00:46:44,070 --> 00:46:52,640
<font color="#CCCCCC">Epping was all tied to</font><font color="#E5E5E5"> this actor so</font>

893
00:46:49,410 --> 00:46:52,640
<font color="#CCCCCC">you're doing</font><font color="#E5E5E5"> have any more questions</font>

894
00:46:52,850 --> 00:46:58,319
superb<font color="#E5E5E5"> right well that was a lot of</font>

895
00:46:55,410 --> 00:46:59,640
questions myself actually<font color="#E5E5E5"> really good</font>

896
00:46:58,320 --> 00:47:01,860
that we<font color="#E5E5E5"> have the time</font><font color="#CCCCCC"> and thank you</font><font color="#E5E5E5"> very</font>

897
00:46:59,640 --> 00:47:03,270
much ready<font color="#E5E5E5"> for that and for stand a</font>

898
00:47:01,860 --> 00:47:05,190
little<font color="#CCCCCC"> bit early that</font><font color="#E5E5E5"> definitely helps</font>

899
00:47:03,270 --> 00:47:07,259
us as we<font color="#CCCCCC"> progressed through the rest of</font>

900
00:47:05,190 --> 00:47:10,190
the day but can everybody please put the

901
00:47:07,260 --> 00:47:10,190
hands together<font color="#E5E5E5"> father</font>

