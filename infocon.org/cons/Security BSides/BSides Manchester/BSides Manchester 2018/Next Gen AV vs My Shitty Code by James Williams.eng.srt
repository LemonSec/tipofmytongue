1
00:00:05,000 --> 00:00:10,200
excellent<font color="#CCCCCC"> so yeah this</font><font color="#E5E5E5"> is next-gen</font><font color="#CCCCCC"> AV</font>

2
00:00:08,069 --> 00:00:12,090
<font color="#CCCCCC">versus my shitty code and in true form a</font>

3
00:00:10,200 --> 00:00:14,940
<font color="#CCCCCC">deaf fashion</font><font color="#E5E5E5"> I stole all of</font><font color="#CCCCCC"> this code</font>

4
00:00:12,090 --> 00:00:17,279
<font color="#E5E5E5">from</font><font color="#CCCCCC"> getup and</font><font color="#E5E5E5"> various blog posts</font><font color="#CCCCCC"> like I</font>

5
00:00:14,940 --> 00:00:19,650
say my code<font color="#CCCCCC"> it's amalgamation of other</font>

6
00:00:17,279 --> 00:00:21,630
people's code so Who am I my name's

7
00:00:19,650 --> 00:00:23,909
James<font color="#CCCCCC"> I'm a pen tester</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> a comma</font>

8
00:00:21,630 --> 00:00:24,660
<font color="#CCCCCC">new</font><font color="#E5E5E5"> pen testing red teaming not sort of</font>

9
00:00:23,910 --> 00:00:26,699
stuff

10
00:00:24,660 --> 00:00:28,560
I'm also a<font color="#CCCCCC"> Berk</font><font color="#E5E5E5"> of erinc net developer</font>

11
00:00:26,699 --> 00:00:31,710
<font color="#E5E5E5">so I did that</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> about 10</font><font color="#CCCCCC"> years before</font>

12
00:00:28,560 --> 00:00:33,660
<font color="#E5E5E5">moving into info suck so</font><font color="#CCCCCC"> what's coming</font>

13
00:00:31,710 --> 00:00:35,760
<font color="#E5E5E5">up we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> run through an</font>

14
00:00:33,660 --> 00:00:37,709
explanation and theory<font color="#E5E5E5"> of this sort of a</font>

15
00:00:35,760 --> 00:00:39,870
<font color="#E5E5E5">be bypass technique I've got a load of</font>

16
00:00:37,710 --> 00:00:42,149
demos a few bad memes and then I've got

17
00:00:39,870 --> 00:00:43,290
the tool release on github to send you

18
00:00:42,149 --> 00:00:46,079
all<font color="#CCCCCC"> the way with so you</font><font color="#E5E5E5"> can all have</font><font color="#CCCCCC"> a</font>

19
00:00:43,290 --> 00:00:48,719
play with<font color="#CCCCCC"> this</font><font color="#E5E5E5"> stuff later on so it's</font>

20
00:00:46,079 --> 00:00:50,550
probably helps if I run a demo first so

21
00:00:48,719 --> 00:00:53,340
you can<font color="#E5E5E5"> sort of see what's</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> happen</font>

22
00:00:50,550 --> 00:00:55,230
<font color="#CCCCCC">later</font><font color="#E5E5E5"> on in the talk so if any of you</font>

23
00:00:53,340 --> 00:00:56,610
<font color="#E5E5E5">saw the lightning talk version there's a</font>

24
00:00:55,230 --> 00:00:59,069
steel<font color="#CCCCCC"> comp this</font><font color="#E5E5E5"> is what the video is</font>

25
00:00:56,610 --> 00:01:01,739
<font color="#CCCCCC">from that but this is</font><font color="#E5E5E5"> silence</font><font color="#CCCCCC"> mom's</font>

26
00:00:59,070 --> 00:01:05,280
going<font color="#CCCCCC"> to there's a reason it's 32-bit</font>

27
00:01:01,739 --> 00:01:08,759
which I'll cover<font color="#CCCCCC"> later on so from the</font>

28
00:01:05,280 --> 00:01:11,280
video so the window on the<font color="#CCCCCC"> right is an</font>

29
00:01:08,760 --> 00:01:13,979
RDP session into a Windows 10 machine

30
00:01:11,280 --> 00:01:16,470
<font color="#E5E5E5">running silence</font><font color="#CCCCCC"> this is silence in full</font>

31
00:01:13,979 --> 00:01:18,450
block mode with PowerShell<font color="#E5E5E5"> allowed it's</font>

32
00:01:16,470 --> 00:01:21,479
fully patched Windows 10 Windows

33
00:01:18,450 --> 00:01:23,520
Defender is<font color="#E5E5E5"> on if you can see what's</font>

34
00:01:21,479 --> 00:01:25,740
<font color="#CCCCCC">going on the tool I'm running in the</font>

35
00:01:23,520 --> 00:01:29,520
command window is my stage for this

36
00:01:25,740 --> 00:01:32,070
<font color="#CCCCCC">product so I'm pressing</font><font color="#E5E5E5"> in a crypto key</font>

37
00:01:29,520 --> 00:01:35,460
and a<font color="#E5E5E5"> URL to a payload server which will</font>

38
00:01:32,070 --> 00:01:38,460
be covered shortly the terminal sessions

39
00:01:35,460 --> 00:01:42,030
behind the RDP is just terminal in my

40
00:01:38,460 --> 00:01:43,710
host<font color="#E5E5E5"> machine that's the sex you can see</font>

41
00:01:42,030 --> 00:01:45,659
there is the sort of old version of<font color="#E5E5E5"> the</font>

42
00:01:43,710 --> 00:01:47,070
payload gen and then this is chopping

43
00:01:45,659 --> 00:01:50,700
<font color="#E5E5E5">the</font><font color="#CCCCCC"> shellcode</font>

44
00:01:47,070 --> 00:01:54,689
<font color="#CCCCCC">into memory</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we've got the multi</font>

45
00:01:50,700 --> 00:01:56,490
handler running there<font color="#E5E5E5"> when the</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the</font>

46
00:01:54,689 --> 00:01:59,219
command and we get<font color="#CCCCCC"> a bit of a</font><font color="#E5E5E5"> session</font>

47
00:01:56,490 --> 00:02:01,979
open so that's<font color="#E5E5E5"> the tip</font><font color="#CCCCCC"> for stop with</font>

48
00:01:59,219 --> 00:02:04,320
<font color="#E5E5E5">session</font><font color="#CCCCCC"> 32-bit silence the window on</font><font color="#E5E5E5"> the</font>

49
00:02:01,979 --> 00:02:05,460
<font color="#E5E5E5">side it says inspecting because this was</font>

50
00:02:04,320 --> 00:02:08,190
a fresh install we still do the

51
00:02:05,460 --> 00:02:10,049
<font color="#CCCCCC">background</font><font color="#E5E5E5"> scanning</font><font color="#CCCCCC"> but the active</font>

52
00:02:08,190 --> 00:02:12,150
protection<font color="#E5E5E5"> is running</font>

53
00:02:10,050 --> 00:02:13,890
so yeah but<font color="#CCCCCC"> pull</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> hostname</font><font color="#E5E5E5"> out to see</font>

54
00:02:12,150 --> 00:02:16,230
you can see there's no trickery<font color="#CCCCCC"> going on</font>

55
00:02:13,890 --> 00:02:18,359
there but it is<font color="#CCCCCC"> Cylons being Microsoft</font>

56
00:02:16,230 --> 00:02:22,049
32-bit so that's what we're looking<font color="#CCCCCC"> at</font>

57
00:02:18,360 --> 00:02:23,400
here<font color="#E5E5E5"> so what just happened</font><font color="#CCCCCC"> the stage</font>

58
00:02:22,050 --> 00:02:25,230
which<font color="#E5E5E5"> I've</font><font color="#CCCCCC"> won I'm</font><font color="#E5E5E5"> calling update</font>

59
00:02:23,400 --> 00:02:27,150
<font color="#E5E5E5">service dog exe just a little bit of</font>

60
00:02:25,230 --> 00:02:28,920
<font color="#E5E5E5">OPSEC right I've fetched an</font><font color="#CCCCCC"> Aes</font>

61
00:02:27,150 --> 00:02:30,840
encrypted payload it built<font color="#E5E5E5"> it in memory</font>

62
00:02:28,920 --> 00:02:32,459
using muslin then executed it using

63
00:02:30,840 --> 00:02:33,660
reflection<font color="#CCCCCC"> a payload contain meterpreter</font>

64
00:02:32,460 --> 00:02:35,760
shell code which<font color="#E5E5E5"> was injected into</font>

65
00:02:33,660 --> 00:02:37,890
<font color="#E5E5E5">memory the stage checked it wasn't in a</font>

66
00:02:35,760 --> 00:02:39,390
sandbox<font color="#E5E5E5"> before it did any of this so if</font>

67
00:02:37,890 --> 00:02:41,100
you're in a sandbox you can just exit

68
00:02:39,390 --> 00:02:43,140
<font color="#E5E5E5">out the process and do nothing</font>

69
00:02:41,100 --> 00:02:47,460
if that's difficult<font color="#E5E5E5"> to understand I drew</font>

70
00:02:43,140 --> 00:02:49,709
you a nice<font color="#CCCCCC"> pink diagram so yeah you can</font>

71
00:02:47,460 --> 00:02:52,860
<font color="#CCCCCC">probably tell I'm not any</font><font color="#E5E5E5"> sort of artist</font>

72
00:02:49,710 --> 00:02:54,750
<font color="#E5E5E5">this is the best I could do here</font><font color="#CCCCCC"> so the</font>

73
00:02:52,860 --> 00:02:58,050
payload server on the attacker machine

74
00:02:54,750 --> 00:03:00,390
<font color="#CCCCCC">these</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> be two boxes</font><font color="#E5E5E5"> in all the demos</font>

75
00:02:58,050 --> 00:03:01,830
<font color="#E5E5E5">there one box but</font><font color="#CCCCCC"> you can paint loads</font>

76
00:03:00,390 --> 00:03:04,170
from<font color="#E5E5E5"> any way you want and you can send</font>

77
00:03:01,830 --> 00:03:06,030
shells<font color="#E5E5E5"> anywhere you want</font><font color="#CCCCCC"> so the victim</font>

78
00:03:04,170 --> 00:03:07,920
machine<font color="#E5E5E5"> over</font><font color="#CCCCCC"> on the right it fetches the</font>

79
00:03:06,030 --> 00:03:10,110
<font color="#E5E5E5">payload</font><font color="#CCCCCC"> over the network after it's</font>

80
00:03:07,920 --> 00:03:11,130
checked<font color="#CCCCCC"> it's not in some box it says</font>

81
00:03:10,110 --> 00:03:13,560
decode on here

82
00:03:11,130 --> 00:03:15,540
it does decode it also decrypt<font color="#E5E5E5"> so this</font>

83
00:03:13,560 --> 00:03:19,140
<font color="#E5E5E5">isn't me</font><font color="#CCCCCC"> mixing</font><font color="#E5E5E5"> terms of</font><font color="#CCCCCC"> it's a base64</font>

84
00:03:15,540 --> 00:03:20,910
<font color="#E5E5E5">encoded AES and so it does that it</font>

85
00:03:19,140 --> 00:03:24,269
builds<font color="#E5E5E5"> a payload it executes it using</font>

86
00:03:20,910 --> 00:03:26,400
<font color="#CCCCCC">Rozlyn</font><font color="#E5E5E5"> it then does the</font><font color="#CCCCCC"> reflective</font>

87
00:03:24,270 --> 00:03:28,620
loading shellcodes injected into memory

88
00:03:26,400 --> 00:03:30,030
<font color="#E5E5E5">then you have</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> sort of normal MSF</font>

89
00:03:28,620 --> 00:03:32,580
stagings<font color="#CCCCCC"> of the back and forth between</font>

90
00:03:30,030 --> 00:03:34,380
the the shellcode<font color="#CCCCCC"> and Metasploit and</font>

91
00:03:32,580 --> 00:03:38,070
then you get shells sent off<font color="#CCCCCC"> to the</font>

92
00:03:34,380 --> 00:03:40,230
attacker machine so the real basics of

93
00:03:38,070 --> 00:03:41,700
this it's written in c-sharp<font color="#E5E5E5"> mostly</font>

94
00:03:40,230 --> 00:03:43,109
because it's what I know<font color="#E5E5E5"> but</font><font color="#CCCCCC"> you also</font>

95
00:03:41,700 --> 00:03:44,850
get the benefits of<font color="#E5E5E5"> the flexion and</font>

96
00:03:43,110 --> 00:03:46,500
stuff like that which if people don't

97
00:03:44,850 --> 00:03:49,590
know reflection<font color="#E5E5E5"> is a way of launching</font>

98
00:03:46,500 --> 00:03:51,209
something<font color="#E5E5E5"> in memory in dotnet the</font>

99
00:03:49,590 --> 00:03:54,120
payloads are fetched over<font color="#E5E5E5"> the network</font>

100
00:03:51,209 --> 00:03:55,980
they go over<font color="#E5E5E5"> HTTP there's no reason why</font>

101
00:03:54,120 --> 00:03:58,500
you can't<font color="#CCCCCC"> use HTTP for this I've</font><font color="#E5E5E5"> just</font>

102
00:03:55,980 --> 00:04:01,109
not bothered to<font color="#CCCCCC"> set it up for us</font>

103
00:03:58,500 --> 00:04:02,880
they<font color="#CCCCCC"> Ras encrypted so it's a one-time</font>

104
00:04:01,110 --> 00:04:05,490
key<font color="#E5E5E5"> which we'll see in the</font><font color="#CCCCCC"> payload</font>

105
00:04:02,880 --> 00:04:07,260
generation stuff shortly so<font color="#E5E5E5"> even if you</font>

106
00:04:05,490 --> 00:04:10,410
grab this<font color="#E5E5E5"> off the wire without</font><font color="#CCCCCC"> the keys</font>

107
00:04:07,260 --> 00:04:13,769
on<font color="#CCCCCC"> the victim machine it's basically</font>

108
00:04:10,410 --> 00:04:15,950
<font color="#E5E5E5">useless</font><font color="#CCCCCC"> the stage</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> to touch disk this</font>

109
00:04:13,770 --> 00:04:18,060
<font color="#E5E5E5">is a completely benign payload it has</font>

110
00:04:15,950 --> 00:04:20,310
nothing in there which should trigger

111
00:04:18,060 --> 00:04:22,079
any sort<font color="#CCCCCC"> of baby product</font><font color="#E5E5E5"> if you ever get</font>

112
00:04:20,310 --> 00:04:23,889
signatures<font color="#E5E5E5"> you can just change</font><font color="#CCCCCC"> the code</font>

113
00:04:22,079 --> 00:04:24,849
<font color="#CCCCCC">got garbage in there</font>

114
00:04:23,889 --> 00:04:26,949
anything you want to<font color="#CCCCCC"> change the</font>

115
00:04:24,849 --> 00:04:29,349
signature<font color="#CCCCCC"> binary all that does is the</font>

116
00:04:26,949 --> 00:04:30,610
<font color="#E5E5E5">fetch</font><font color="#CCCCCC"> build and execute</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> all the</font>

117
00:04:29,349 --> 00:04:32,889
malicious stuff happens in what's

118
00:04:30,610 --> 00:04:34,360
<font color="#CCCCCC">fetches</font><font color="#E5E5E5"> over the</font><font color="#CCCCCC"> network the cool thing</font>

119
00:04:32,889 --> 00:04:36,669
<font color="#E5E5E5">with s whilst the stage has</font><font color="#CCCCCC"> to touch</font>

120
00:04:34,360 --> 00:04:38,439
<font color="#E5E5E5">disk the payload does not so you can</font>

121
00:04:36,669 --> 00:04:40,389
serve literally anything<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is valid</font>

122
00:04:38,439 --> 00:04:42,490
<font color="#CCCCCC">c-sharp</font><font color="#E5E5E5"> and having</font><font color="#CCCCCC"> built-in memory</font><font color="#E5E5E5"> and</font>

123
00:04:40,389 --> 00:04:43,779
executed<font color="#E5E5E5"> so once you've dropped this</font>

124
00:04:42,490 --> 00:04:45,039
stage on there I'm going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> show you</font>

125
00:04:43,779 --> 00:04:47,259
this in one of<font color="#CCCCCC"> the later videos you can</font>

126
00:04:45,039 --> 00:04:48,729
keep<font color="#E5E5E5"> using this tool to do new things so</font>

127
00:04:47,259 --> 00:04:50,139
you can<font color="#E5E5E5"> spin up a metalloid session</font>

128
00:04:48,729 --> 00:04:51,938
which gives you shell<font color="#CCCCCC"> access you can</font>

129
00:04:50,139 --> 00:04:55,120
<font color="#CCCCCC">then</font><font color="#E5E5E5"> use this tools a load of a c-sharp</font>

130
00:04:51,939 --> 00:04:56,979
code into memory<font color="#CCCCCC"> so you first mean for</font>

131
00:04:55,120 --> 00:04:59,650
the day using c-sharp debility<font color="#CCCCCC"> sharp</font>

132
00:04:56,979 --> 00:05:02,050
like<font color="#E5E5E5"> this is the inception meme people</font>

133
00:04:59,650 --> 00:05:05,318
<font color="#E5E5E5">don't know so this is where the name of</font>

134
00:05:02,050 --> 00:05:07,389
the tool come from so this is how we

135
00:05:05,319 --> 00:05:08,919
build<font color="#E5E5E5"> c-sharp in memory and I'm going to</font>

136
00:05:07,389 --> 00:05:11,680
<font color="#E5E5E5">stand here</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> wave the laser pointer</font>

137
00:05:08,919 --> 00:05:13,750
<font color="#E5E5E5">around so off the screen where you can't</font>

138
00:05:11,680 --> 00:05:15,699
see there's a bit of code that<font color="#CCCCCC"> fetches</font>

139
00:05:13,750 --> 00:05:17,289
<font color="#CCCCCC">the payload and</font><font color="#E5E5E5"> does the</font><font color="#CCCCCC"> AES decrypt I'm</font>

140
00:05:15,699 --> 00:05:20,289
not going to show<font color="#E5E5E5"> the coves</font><font color="#CCCCCC"> or a yes</font>

141
00:05:17,289 --> 00:05:22,060
decryption<font color="#E5E5E5"> it's pretty standard stuff</font>

142
00:05:20,289 --> 00:05:23,469
<font color="#CCCCCC">you're sending the IV along with the</font>

143
00:05:22,060 --> 00:05:25,749
encrypted<font color="#E5E5E5"> string and all the rest of it</font>

144
00:05:23,469 --> 00:05:27,580
<font color="#CCCCCC">if you</font><font color="#E5E5E5"> google how you do a</font><font color="#CCCCCC"> yes to work</font>

145
00:05:25,749 --> 00:05:29,229
<font color="#E5E5E5">with Python and C sharp you'll find the</font>

146
00:05:27,580 --> 00:05:32,948
same blog post I stole this chunk<font color="#E5E5E5"> of</font>

147
00:05:29,229 --> 00:05:34,839
<font color="#E5E5E5">code on so the code variable at the top</font>

148
00:05:32,949 --> 00:05:36,250
here this is the<font color="#E5E5E5"> plain</font><font color="#CCCCCC"> text code so</font>

149
00:05:34,839 --> 00:05:38,319
first of all<font color="#CCCCCC"> we Chapman are in</font><font color="#E5E5E5"> some box</font>

150
00:05:36,250 --> 00:05:40,389
which I'll cover shortly<font color="#E5E5E5"> then we fetch</font>

151
00:05:38,319 --> 00:05:42,129
<font color="#E5E5E5">the payload we decrypt it if any of</font>

152
00:05:40,389 --> 00:05:45,399
those steps fail we just exit and return

153
00:05:42,129 --> 00:05:47,259
<font color="#E5E5E5">nothing so we grab this code variable we</font>

154
00:05:45,399 --> 00:05:49,210
pass it<font color="#CCCCCC"> into the C shop syntax tree this</font>

155
00:05:47,259 --> 00:05:52,180
<font color="#E5E5E5">is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Gosling way of sort of building</font>

156
00:05:49,210 --> 00:05:53,680
<font color="#CCCCCC">code in</font><font color="#E5E5E5"> memory we need a random file</font>

157
00:05:52,180 --> 00:05:55,089
name so when you<font color="#E5E5E5"> build stuff you have to</font>

158
00:05:53,680 --> 00:05:56,469
<font color="#CCCCCC">give it an assembly name so we</font><font color="#E5E5E5"> can just</font>

159
00:05:55,089 --> 00:05:58,629
get a<font color="#CCCCCC"> random name</font><font color="#E5E5E5"> it doesn't matter what</font>

160
00:05:56,469 --> 00:06:01,300
<font color="#E5E5E5">that's called</font><font color="#CCCCCC"> and then this</font><font color="#E5E5E5"> is the</font>

161
00:05:58,629 --> 00:06:03,069
references block<font color="#E5E5E5"> so in the</font><font color="#CCCCCC"> version I'm</font>

162
00:06:01,300 --> 00:06:05,710
releasing there is another couple of

163
00:06:03,069 --> 00:06:07,930
<font color="#E5E5E5">lines in here so if you want to bring in</font>

164
00:06:05,710 --> 00:06:09,609
using statements in your payload<font color="#E5E5E5"> which</font>

165
00:06:07,930 --> 00:06:10,839
aren't part of<font color="#E5E5E5"> the standard dotnet like</font>

166
00:06:09,610 --> 00:06:13,060
also reference libraries you can

167
00:06:10,839 --> 00:06:14,740
<font color="#E5E5E5">reference them here if you don't do this</font>

168
00:06:13,060 --> 00:06:16,029
your payload won't build you<font color="#CCCCCC"> have to</font>

169
00:06:14,740 --> 00:06:17,800
reference<font color="#E5E5E5"> them through</font><font color="#CCCCCC"> muslins to be</font>

170
00:06:16,029 --> 00:06:19,810
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to say okay so I'm</font><font color="#CCCCCC"> building this</font>

171
00:06:17,800 --> 00:06:22,659
with this using<font color="#E5E5E5"> statement</font><font color="#CCCCCC"> C you</font>

172
00:06:19,810 --> 00:06:24,039
reference it here<font color="#CCCCCC"> I don't have the line</font>

173
00:06:22,659 --> 00:06:25,839
in the slides<font color="#CCCCCC"> that tells you how to do</font>

174
00:06:24,039 --> 00:06:27,339
this but it's in the code<font color="#CCCCCC"> so you can</font><font color="#E5E5E5"> go</font>

175
00:06:25,839 --> 00:06:29,469
and<font color="#CCCCCC"> just chop in whatever libraries you</font>

176
00:06:27,339 --> 00:06:32,019
<font color="#E5E5E5">need to bring in down here is where we</font>

177
00:06:29,469 --> 00:06:33,819
do the<font color="#E5E5E5"> completion so we use this</font><font color="#CCCCCC"> stock</font>

178
00:06:32,019 --> 00:06:35,280
<font color="#E5E5E5">create and we possibly sembly name the</font>

179
00:06:33,819 --> 00:06:37,290
syntax<font color="#E5E5E5"> tree the reference</font>

180
00:06:35,280 --> 00:06:38,638
is and a<font color="#E5E5E5"> couple of options basically</font>

181
00:06:37,290 --> 00:06:39,540
just saying spit<font color="#CCCCCC"> out my</font><font color="#E5E5E5"> dynamic link</font>

182
00:06:38,639 --> 00:06:42,030
library because that's what we're<font color="#E5E5E5"> going</font>

183
00:06:39,540 --> 00:06:43,800
to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> it reflection</font><font color="#E5E5E5"> and then we</font><font color="#CCCCCC"> emit</font>

184
00:06:42,030 --> 00:06:45,330
the result of the build into a memory

185
00:06:43,800 --> 00:06:47,310
stream<font color="#E5E5E5"> so for those</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> you that don't</font>

186
00:06:45,330 --> 00:06:50,909
know<font color="#CCCCCC"> a memory stream is basically a byte</font>

187
00:06:47,310 --> 00:06:52,470
<font color="#CCCCCC">array in memory in c-sharp it's slightly</font>

188
00:06:50,910 --> 00:06:53,760
more<font color="#E5E5E5"> complicated than</font><font color="#CCCCCC"> that that's</font><font color="#E5E5E5"> all</font>

189
00:06:52,470 --> 00:06:54,680
<font color="#CCCCCC">you really need to know to understand</font>

190
00:06:53,760 --> 00:06:58,320
<font color="#E5E5E5">this</font>

191
00:06:54,680 --> 00:07:00,540
so once we've<font color="#CCCCCC"> built this again</font><font color="#E5E5E5"> slightly</font>

192
00:06:58,320 --> 00:07:03,330
<font color="#CCCCCC">off the</font><font color="#E5E5E5"> screen there's a if statement</font>

193
00:07:00,540 --> 00:07:05,460
<font color="#CCCCCC">that says if the bill failed return</font><font color="#E5E5E5"> do</font>

194
00:07:03,330 --> 00:07:08,070
nothing just<font color="#E5E5E5"> drop everything</font><font color="#CCCCCC"> out the</font>

195
00:07:05,460 --> 00:07:09,539
memory caveat as you<font color="#CCCCCC"> were</font><font color="#E5E5E5"> in this else</font>

196
00:07:08,070 --> 00:07:12,690
statement<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is where we do</font><font color="#E5E5E5"> the</font>

197
00:07:09,540 --> 00:07:14,130
reflective loading so we grab<font color="#E5E5E5"> the name</font>

198
00:07:12,690 --> 00:07:15,450
we<font color="#E5E5E5"> say person</font><font color="#CCCCCC"> where</font><font color="#E5E5E5"> we move to the</font>

199
00:07:14,130 --> 00:07:16,800
<font color="#CCCCCC">beginning and a memory stream</font><font color="#E5E5E5"> just as</font>

200
00:07:15,450 --> 00:07:18,419
<font color="#E5E5E5">I'll make sure we're building from the</font>

201
00:07:16,800 --> 00:07:21,360
start<font color="#E5E5E5"> of the app otherwise things go</font>

202
00:07:18,419 --> 00:07:23,760
terribly wrong so this bit here

203
00:07:21,360 --> 00:07:25,890
<font color="#CCCCCC">inception</font><font color="#E5E5E5"> program is the</font><font color="#CCCCCC"> namespace on</font>

204
00:07:23,760 --> 00:07:27,419
the class<font color="#E5E5E5"> that we're trying to build so</font>

205
00:07:25,890 --> 00:07:30,210
I'm going<font color="#E5E5E5"> to show you the template for</font>

206
00:07:27,419 --> 00:07:32,520
<font color="#CCCCCC">this shortly</font><font color="#E5E5E5"> but this first bit on the</font>

207
00:07:30,210 --> 00:07:33,840
run method<font color="#E5E5E5"> these are the only bits that</font>

208
00:07:32,520 --> 00:07:35,969
<font color="#CCCCCC">have to match when you build your own</font>

209
00:07:33,840 --> 00:07:37,650
payloads<font color="#CCCCCC"> so the namespaces inception the</font>

210
00:07:35,970 --> 00:07:39,060
class is called program<font color="#E5E5E5"> and your entry</font>

211
00:07:37,650 --> 00:07:41,700
<font color="#CCCCCC">point into your payload is called run</font>

212
00:07:39,060 --> 00:07:43,380
that's just a public static<font color="#E5E5E5"> method any</font>

213
00:07:41,700 --> 00:07:45,510
<font color="#E5E5E5">other codes you want can be put in there</font>

214
00:07:43,380 --> 00:07:47,940
<font color="#E5E5E5">but it will call</font><font color="#CCCCCC"> run</font><font color="#E5E5E5"> and your class has</font>

215
00:07:45,510 --> 00:07:50,219
to implement<font color="#CCCCCC"> this namespace</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> just</font>

216
00:07:47,940 --> 00:07:52,260
a reflection<font color="#E5E5E5"> way of loading stuff in</font>

217
00:07:50,220 --> 00:07:55,530
memory so it's<font color="#E5E5E5"> pretty standard c-sharp</font>

218
00:07:52,260 --> 00:07:58,380
and binding<font color="#CCCCCC"> flags</font><font color="#E5E5E5"> invoke method and if</font>

219
00:07:55,530 --> 00:08:00,479
we fail<font color="#CCCCCC"> we basically do nothing</font><font color="#E5E5E5"> this</font>

220
00:07:58,380 --> 00:08:02,240
<font color="#E5E5E5">console white is in there for when I was</font>

221
00:08:00,479 --> 00:08:04,890
<font color="#CCCCCC">building this</font><font color="#E5E5E5"> and trying to do</font><font color="#CCCCCC"> debugging</font>

222
00:08:02,240 --> 00:08:06,870
this should probably be taken out<font color="#CCCCCC"> before</font>

223
00:08:04,890 --> 00:08:08,000
it's sort of used in the<font color="#E5E5E5"> wild but there</font>

224
00:08:06,870 --> 00:08:12,060
you<font color="#E5E5E5"> go it doesn't actually do anything</font>

225
00:08:08,000 --> 00:08:14,490
<font color="#CCCCCC">so that's</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> some box detection this</font>

226
00:08:12,060 --> 00:08:16,530
happens right at the start so I'm using

227
00:08:14,490 --> 00:08:17,820
the check<font color="#E5E5E5"> please scripts</font><font color="#CCCCCC"> these were</font>

228
00:08:16,530 --> 00:08:20,909
<font color="#E5E5E5">released I</font><font color="#CCCCCC"> think a couple</font><font color="#E5E5E5"> years ago</font>

229
00:08:17,820 --> 00:08:23,130
<font color="#CCCCCC">steel comm the github link</font><font color="#E5E5E5"> is there any</font>

230
00:08:20,910 --> 00:08:25,169
almost to have<font color="#CCCCCC"> a look at those</font><font color="#E5E5E5"> because</font>

231
00:08:23,130 --> 00:08:26,940
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> running this basically for debugging</font>

232
00:08:25,169 --> 00:08:29,090
testing I'm only doing<font color="#CCCCCC"> su checks at</font><font color="#E5E5E5"> the</font>

233
00:08:26,940 --> 00:08:32,159
moment so minimum<font color="#E5E5E5"> number of USB drives</font>

234
00:08:29,090 --> 00:08:34,468
<font color="#E5E5E5">install browsers nobody</font><font color="#CCCCCC"> has ever</font><font color="#E5E5E5"> used</font>

235
00:08:32,159 --> 00:08:36,780
Windows 10 with just<font color="#CCCCCC"> edged like nobody</font>

236
00:08:34,469 --> 00:08:38,640
does<font color="#E5E5E5"> that so check</font><font color="#CCCCCC"> with our install the</font>

237
00:08:36,780 --> 00:08:40,189
<font color="#E5E5E5">way if you're doing</font><font color="#CCCCCC"> that you're</font><font color="#E5E5E5"> probably</font>

238
00:08:38,640 --> 00:08:43,708
safe<font color="#E5E5E5"> in this tool at the minute</font><font color="#CCCCCC"> so</font>

239
00:08:40,190 --> 00:08:45,630
<font color="#E5E5E5">William</font><font color="#CCCCCC"> view there are</font><font color="#E5E5E5"> other checks you</font>

240
00:08:43,708 --> 00:08:47,170
can do so you can<font color="#CCCCCC"> check you on a domain</font>

241
00:08:45,630 --> 00:08:49,089
joined machine you can

242
00:08:47,170 --> 00:08:50,709
the domain<font color="#E5E5E5"> name</font><font color="#CCCCCC"> that you'll join - so if</font>

243
00:08:49,089 --> 00:08:52,899
you're<font color="#CCCCCC"> in a red</font><font color="#E5E5E5"> team gig and your domain</font>

244
00:08:50,709 --> 00:08:54,489
in scope is Acme comm you can make<font color="#E5E5E5"> sure</font>

245
00:08:52,899 --> 00:08:55,870
there's only<font color="#E5E5E5"> execute</font><font color="#CCCCCC"> on a technique on</font>

246
00:08:54,490 --> 00:08:58,839
<font color="#CCCCCC">dooming</font><font color="#E5E5E5"> that's you know that's quite</font>

247
00:08:55,870 --> 00:09:00,459
cool<font color="#CCCCCC"> it's really easy to add new</font><font color="#E5E5E5"> ones in</font>

248
00:08:58,839 --> 00:09:02,589
you literally grab the code from<font color="#CCCCCC"> the</font>

249
00:09:00,459 --> 00:09:04,689
github<font color="#CCCCCC"> copy</font><font color="#E5E5E5"> and paste the check should</font>

250
00:09:02,589 --> 00:09:06,910
want<font color="#E5E5E5"> stick them in</font><font color="#CCCCCC"> my code</font><font color="#E5E5E5"> and just make</font>

251
00:09:04,690 --> 00:09:10,149
<font color="#CCCCCC">sure they call it's really simple</font><font color="#E5E5E5"> to add</font>

252
00:09:06,910 --> 00:09:11,920
<font color="#E5E5E5">new chucks in there's about 15 or</font><font color="#CCCCCC"> 20 of</font>

253
00:09:10,149 --> 00:09:15,250
<font color="#E5E5E5">these I think</font><font color="#CCCCCC"> so</font>

254
00:09:11,920 --> 00:09:16,630
loads of<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can play with so the</font>

255
00:09:15,250 --> 00:09:19,420
payloads<font color="#CCCCCC"> this is where it gets</font>

256
00:09:16,630 --> 00:09:21,760
reasonably interesting<font color="#CCCCCC"> so this</font>

257
00:09:19,420 --> 00:09:24,250
essentially<font color="#E5E5E5"> execute arbitrary c-sharp</font>

258
00:09:21,760 --> 00:09:26,680
code in memory without<font color="#E5E5E5"> touching disk so</font>

259
00:09:24,250 --> 00:09:28,060
anything you can<font color="#CCCCCC"> do in c-sharp</font><font color="#E5E5E5"> and C</font>

260
00:09:26,680 --> 00:09:30,760
sharps kind of flavor of the month<font color="#E5E5E5"> or</font>

261
00:09:28,060 --> 00:09:32,949
<font color="#E5E5E5">the minute my team guys like you can use</font>

262
00:09:30,760 --> 00:09:35,470
this tool to<font color="#CCCCCC"> work that into memory and</font>

263
00:09:32,949 --> 00:09:37,630
bypass<font color="#CCCCCC"> anything</font><font color="#E5E5E5"> so at the minute I'm</font>

264
00:09:35,470 --> 00:09:39,459
releasing along with this<font color="#E5E5E5"> shell code</font>

265
00:09:37,630 --> 00:09:41,649
loader for 32 and<font color="#CCCCCC"> 64-bit</font><font color="#E5E5E5"> shell code</font>

266
00:09:39,459 --> 00:09:44,649
again completely stolen code this is not

267
00:09:41,649 --> 00:09:45,910
my code<font color="#E5E5E5"> modified version sharp dump so</font>

268
00:09:44,649 --> 00:09:47,589
I've got a slide on<font color="#E5E5E5"> this in a</font><font color="#CCCCCC"> minute but</font>

269
00:09:45,910 --> 00:09:50,620
<font color="#E5E5E5">this is a set of tools where we spice</font>

270
00:09:47,589 --> 00:09:52,600
<font color="#E5E5E5">backdrops it basically does a memory</font>

271
00:09:50,620 --> 00:09:53,949
dump of alsace and<font color="#E5E5E5"> then you can extract</font>

272
00:09:52,600 --> 00:09:56,320
trance using<font color="#E5E5E5"> memory capsule offline</font>

273
00:09:53,949 --> 00:09:58,810
which is kind of cool<font color="#CCCCCC"> but</font><font color="#E5E5E5"> there are no</font>

274
00:09:56,320 --> 00:10:00,970
real limitations on this<font color="#CCCCCC"> one</font><font color="#E5E5E5"> I did</font><font color="#CCCCCC"> this</font>

275
00:09:58,810 --> 00:10:02,768
a steel<font color="#CCCCCC"> core I said there may be some</font>

276
00:10:00,970 --> 00:10:04,630
<font color="#CCCCCC">issues</font><font color="#E5E5E5"> of bringing in references to sort</font>

277
00:10:02,769 --> 00:10:06,339
of use extra stuff<font color="#E5E5E5"> in using statements</font>

278
00:10:04,630 --> 00:10:09,459
<font color="#E5E5E5">that's been sold by a few Google</font>

279
00:10:06,339 --> 00:10:11,920
<font color="#E5E5E5">searches so this is ghost</font><font color="#CCCCCC"> park where</font>

280
00:10:09,459 --> 00:10:13,268
sharp dump comes from<font color="#E5E5E5"> if you guys don't</font>

281
00:10:11,920 --> 00:10:15,160
know<font color="#CCCCCC"> about</font><font color="#E5E5E5"> this check out the length</font>

282
00:10:13,269 --> 00:10:17,410
it's an<font color="#E5E5E5"> awesome set of tools so it's</font>

283
00:10:15,160 --> 00:10:19,959
basically a<font color="#E5E5E5"> c-sharp port of</font><font color="#CCCCCC"> Thomas point</font>

284
00:10:17,410 --> 00:10:21,790
<font color="#E5E5E5">a mini dump</font><font color="#CCCCCC"> but I've sort of modified it</font>

285
00:10:19,959 --> 00:10:24,849
slightly to work with this<font color="#E5E5E5"> this tool and</font>

286
00:10:21,790 --> 00:10:27,480
<font color="#E5E5E5">I will show you the</font><font color="#CCCCCC"> way I've modified</font>

287
00:10:24,850 --> 00:10:31,870
<font color="#E5E5E5">that later on if we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> time it's not</font>

288
00:10:27,480 --> 00:10:35,199
interesting to<font color="#CCCCCC"> be fair</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so the</font>

289
00:10:31,870 --> 00:10:37,510
payload builder<font color="#E5E5E5"> this is a Python it's</font>

290
00:10:35,199 --> 00:10:39,760
completely<font color="#E5E5E5"> menu driven I have to make a</font>

291
00:10:37,510 --> 00:10:41,800
choice<font color="#CCCCCC"> between</font><font color="#E5E5E5"> command-line switch is on</font>

292
00:10:39,760 --> 00:10:44,620
menus and I'm still<font color="#CCCCCC"> not sure</font><font color="#E5E5E5"> I made the</font>

293
00:10:41,800 --> 00:10:47,349
<font color="#CCCCCC">right choice when</font><font color="#E5E5E5"> you start getting into</font>

294
00:10:44,620 --> 00:10:49,060
shell code versions and template files

295
00:10:47,350 --> 00:10:52,000
the<font color="#CCCCCC"> command-line</font><font color="#E5E5E5"> switches are just</font>

296
00:10:49,060 --> 00:10:53,768
getting a little bit<font color="#E5E5E5"> unmanageable we</font>

297
00:10:52,000 --> 00:10:56,079
have a nice sort of GUI menu that<font color="#CCCCCC"> wants</font>

298
00:10:53,769 --> 00:10:58,420
you<font color="#CCCCCC"> fur</font><font color="#E5E5E5"> to make</font><font color="#CCCCCC"> selections and data in</font>

299
00:10:56,079 --> 00:11:00,209
and it spits out stuff here<font color="#CCCCCC"> so this</font>

300
00:10:58,420 --> 00:11:03,540
<font color="#E5E5E5">currently supports meterpreter</font>

301
00:11:00,210 --> 00:11:05,040
<font color="#CCCCCC">HTTP</font><font color="#E5E5E5"> shellcode only it is trivial</font><font color="#CCCCCC"> to</font>

302
00:11:03,540 --> 00:11:07,800
modify this to use any<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> other</font>

303
00:11:05,040 --> 00:11:09,240
outputs<font color="#E5E5E5"> a phantom literally all it</font><font color="#CCCCCC"> does</font>

304
00:11:07,800 --> 00:11:11,069
is call out on the shelter<font color="#E5E5E5"> myself</font>

305
00:11:09,240 --> 00:11:13,110
<font color="#CCCCCC">Bentham if some values you pass in it</font>

306
00:11:11,070 --> 00:11:17,220
gives you she'll go<font color="#E5E5E5"> back and you tidy it</font>

307
00:11:13,110 --> 00:11:19,260
up to work in c-sharp<font color="#CCCCCC"> it does</font><font color="#E5E5E5"> find in a</font>

308
00:11:17,220 --> 00:11:20,940
place essentially<font color="#E5E5E5"> so your templates for</font>

309
00:11:19,260 --> 00:11:22,860
<font color="#CCCCCC">shellcode have a tag in them so angle</font>

310
00:11:20,940 --> 00:11:24,420
<font color="#E5E5E5">bracket shell co-angler bucket and it</font>

311
00:11:22,860 --> 00:11:26,370
does find<font color="#E5E5E5"> that template take the shell</font>

312
00:11:24,420 --> 00:11:28,410
go stick it<font color="#E5E5E5"> in there and then pass it on</font>

313
00:11:26,370 --> 00:11:30,330
to<font color="#E5E5E5"> be built and encrypted we also</font>

314
00:11:28,410 --> 00:11:32,610
<font color="#E5E5E5">support custom payloads so these are</font>

315
00:11:30,330 --> 00:11:34,170
<font color="#CCCCCC">arbitrary c-sharp whatever you want</font><font color="#E5E5E5"> it</font>

316
00:11:32,610 --> 00:11:36,839
will just encrypt<font color="#CCCCCC"> it</font><font color="#E5E5E5"> and make</font><font color="#CCCCCC"> it ready</font>

317
00:11:34,170 --> 00:11:38,189
to<font color="#E5E5E5"> be ruled by</font><font color="#CCCCCC"> this tool so the one I'm</font>

318
00:11:36,839 --> 00:11:40,320
sort of releasing<font color="#CCCCCC"> with this is the port</font>

319
00:11:38,190 --> 00:11:42,630
sort of sharp dump<font color="#E5E5E5"> there's other stuff</font>

320
00:11:40,320 --> 00:11:44,580
that<font color="#E5E5E5"> I want to pour into this but if you</font>

321
00:11:42,630 --> 00:11:47,580
<font color="#E5E5E5">can</font><font color="#CCCCCC"> vice it in c-sharp you can load</font><font color="#E5E5E5"> it</font>

322
00:11:44,580 --> 00:11:50,010
this way so<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is just a quick</font><font color="#CCCCCC"> video</font>

323
00:11:47,580 --> 00:11:53,220
<font color="#E5E5E5">showing you the the payload builder in</font>

324
00:11:50,010 --> 00:11:55,110
action I've recorded all my demos<font color="#E5E5E5"> we've</font>

325
00:11:53,220 --> 00:11:55,740
got a lot like demos<font color="#CCCCCC"> are just a</font><font color="#E5E5E5"> recipe</font>

326
00:11:55,110 --> 00:11:57,930
for disaster

327
00:11:55,740 --> 00:12:00,660
so yeah you got a video<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I know is</font>

328
00:11:57,930 --> 00:12:03,089
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> work so</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is building shell</font>

329
00:12:00,660 --> 00:12:05,910
<font color="#E5E5E5">code you've</font><font color="#CCCCCC"> got to</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> asked your inner</font>

330
00:12:03,089 --> 00:12:08,300
exploit kit<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that it prompts you to</font>

331
00:12:05,910 --> 00:12:10,529
pick an options<font color="#E5E5E5"> a shell code custom help</font>

332
00:12:08,300 --> 00:12:13,439
<font color="#CCCCCC">you pick shell code it punch you if you</font>

333
00:12:10,529 --> 00:12:15,959
want 32-bit 64-bit<font color="#CCCCCC"> then it</font><font color="#E5E5E5"> will ask you</font>

334
00:12:13,440 --> 00:12:19,200
for<font color="#E5E5E5"> some variables for</font><font color="#CCCCCC"> msfn ml host help</font>

335
00:12:15,959 --> 00:12:21,060
or the template file<font color="#E5E5E5"> these are just text</font>

336
00:12:19,200 --> 00:12:22,560
<font color="#CCCCCC">files that you do</font><font color="#E5E5E5"> find and</font><font color="#CCCCCC"> play stuff on</font>

337
00:12:21,060 --> 00:12:24,810
<font color="#E5E5E5">and then it calls out on the shelter</font>

338
00:12:22,560 --> 00:12:26,760
<font color="#CCCCCC">missus venom does</font><font color="#E5E5E5"> the build and encrypt</font>

339
00:12:24,810 --> 00:12:29,189
and it spits out<font color="#CCCCCC"> the crypto key up here</font>

340
00:12:26,760 --> 00:12:31,080
<font color="#E5E5E5">this becomes part of the URL that you</font>

341
00:12:29,190 --> 00:12:33,750
<font color="#E5E5E5">pass into the into the stage each off on</font>

342
00:12:31,080 --> 00:12:36,209
disk and<font color="#E5E5E5"> then the sort of generic one</font>

343
00:12:33,750 --> 00:12:37,920
for custom templates<font color="#E5E5E5"> it doesn't know</font>

344
00:12:36,209 --> 00:12:39,270
find in a place<font color="#E5E5E5"> it doesn't know building</font>

345
00:12:37,920 --> 00:12:40,760
<font color="#E5E5E5">shell code</font><font color="#CCCCCC"> or anything like it literally</font>

346
00:12:39,270 --> 00:12:42,870
<font color="#E5E5E5">just encrypts it and gives you a key</font>

347
00:12:40,760 --> 00:12:46,620
<font color="#E5E5E5">sticks it in a format where</font><font color="#CCCCCC"> you can use</font>

348
00:12:42,870 --> 00:12:48,089
<font color="#E5E5E5">it</font><font color="#CCCCCC"> later</font><font color="#E5E5E5"> on so yeah this is that in</font>

349
00:12:46,620 --> 00:12:51,180
slightly more words

350
00:12:48,089 --> 00:12:53,220
so<font color="#E5E5E5"> shell</font><font color="#CCCCCC"> Co palos it is using the</font>

351
00:12:51,180 --> 00:12:54,779
<font color="#E5E5E5">Tirpitz shell code there's no reason why</font>

352
00:12:53,220 --> 00:12:56,940
you can't put<font color="#E5E5E5"> your own shell code in</font>

353
00:12:54,779 --> 00:12:58,620
these I<font color="#E5E5E5"> don't currently support that it</font>

354
00:12:56,940 --> 00:13:00,810
would be a very trivial effort to add a

355
00:12:58,620 --> 00:13:02,160
new menu to allow<font color="#CCCCCC"> you</font><font color="#E5E5E5"> to do that or you</font>

356
00:13:00,810 --> 00:13:03,779
can<font color="#E5E5E5"> just</font><font color="#CCCCCC"> make the custom payload with</font>

357
00:13:02,160 --> 00:13:05,189
the shell code in there<font color="#E5E5E5"> really easy so</font>

358
00:13:03,779 --> 00:13:07,920
if you want to pop calc on all your

359
00:13:05,190 --> 00:13:09,810
compromised machines you<font color="#CCCCCC"> can do that it</font>

360
00:13:07,920 --> 00:13:11,790
then<font color="#E5E5E5"> writes the shell code into a</font>

361
00:13:09,810 --> 00:13:13,119
payload template just<font color="#E5E5E5"> using basic finder</font>

362
00:13:11,790 --> 00:13:15,490
the place is encrypt

363
00:13:13,120 --> 00:13:16,960
<font color="#CCCCCC">a randomly generated key and then it</font>

364
00:13:15,490 --> 00:13:18,339
<font color="#E5E5E5">writes</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> files so in your home</font>

365
00:13:16,960 --> 00:13:20,410
directory when you set this up it

366
00:13:18,339 --> 00:13:21,910
<font color="#CCCCCC">creates a dot</font><font color="#E5E5E5"> inception folder within</font>

367
00:13:20,410 --> 00:13:24,279
there<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> Palos directory and a</font>

368
00:13:21,910 --> 00:13:26,620
<font color="#E5E5E5">payloads</font><font color="#CCCCCC"> war directory</font><font color="#E5E5E5"> payloads contains</font>

369
00:13:24,279 --> 00:13:28,480
the AES encrypted payload<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> used</font>

370
00:13:26,620 --> 00:13:30,040
later<font color="#E5E5E5"> on by the payload server payloads</font>

371
00:13:28,480 --> 00:13:31,570
<font color="#CCCCCC">wall is there so if you want to</font><font color="#E5E5E5"> do any</font>

372
00:13:30,040 --> 00:13:33,250
debugging all the stuff that<font color="#CCCCCC"> comes out</font>

373
00:13:31,570 --> 00:13:35,260
<font color="#CCCCCC">of this</font><font color="#E5E5E5"> you can access the template</font><font color="#CCCCCC"> that</font>

374
00:13:33,250 --> 00:13:37,870
it generated<font color="#E5E5E5"> before it encrypted it for</font>

375
00:13:35,260 --> 00:13:39,819
you we use the crypto key as part of<font color="#E5E5E5"> the</font>

376
00:13:37,870 --> 00:13:41,500
<font color="#CCCCCC">UML so in the silence video I was</font>

377
00:13:39,820 --> 00:13:43,270
passing in the key in the<font color="#CCCCCC"> URL</font><font color="#E5E5E5"> separately</font>

378
00:13:41,500 --> 00:13:47,529
<font color="#CCCCCC">you no longer need to do that it's the</font>

379
00:13:43,270 --> 00:13:49,270
URL slash that<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> custom payloads is a</font>

380
00:13:47,529 --> 00:13:50,770
little bit more straightforward<font color="#CCCCCC"> so we</font>

381
00:13:49,270 --> 00:13:52,360
<font color="#E5E5E5">just do a yes encrypt on the template</font>

382
00:13:50,770 --> 00:13:54,339
that<font color="#E5E5E5"> you give it it writes the encrypted</font>

383
00:13:52,360 --> 00:13:56,170
<font color="#E5E5E5">payload only there's no reason so we</font>

384
00:13:54,339 --> 00:13:57,940
write the<font color="#CCCCCC"> war payload in this case</font>

385
00:13:56,170 --> 00:13:59,890
because there's no modification and

386
00:13:57,940 --> 00:14:03,070
again we use<font color="#CCCCCC"> the key for the</font><font color="#E5E5E5"> the URL and</font>

387
00:13:59,890 --> 00:14:05,140
the payload server<font color="#E5E5E5"> so if you want to</font>

388
00:14:03,070 --> 00:14:09,550
build your<font color="#CCCCCC"> own templates</font><font color="#E5E5E5"> this is how you</font>

389
00:14:05,140 --> 00:14:12,370
do it<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> just a really</font><font color="#E5E5E5"> simple</font>

390
00:14:09,550 --> 00:14:14,079
<font color="#E5E5E5">sort of empty class that you can fill</font>

391
00:14:12,370 --> 00:14:15,460
any<font color="#E5E5E5"> of your own data so this is the bit</font>

392
00:14:14,080 --> 00:14:17,650
I was saying is important<font color="#CCCCCC"> namespace</font>

393
00:14:15,460 --> 00:14:21,550
<font color="#E5E5E5">inception class program public</font><font color="#CCCCCC"> site</font>

394
00:14:17,650 --> 00:14:23,439
<font color="#CCCCCC">voivod</font><font color="#E5E5E5"> so when you launch this on the</font>

395
00:14:21,550 --> 00:14:25,569
code is built and executed<font color="#E5E5E5"> on the on the</font>

396
00:14:23,440 --> 00:14:27,250
compromised<font color="#E5E5E5"> machine</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> method</font>

397
00:14:25,570 --> 00:14:28,630
<font color="#CCCCCC">that will get</font><font color="#E5E5E5"> called you can put any</font>

398
00:14:27,250 --> 00:14:30,910
<font color="#E5E5E5">other methods in there you want as long</font>

399
00:14:28,630 --> 00:14:32,529
<font color="#CCCCCC">as it's policy sharp and it</font><font color="#E5E5E5"> bells you</font>

400
00:14:30,910 --> 00:14:34,719
can mystic as many classes<font color="#E5E5E5"> in there as</font>

401
00:14:32,529 --> 00:14:36,580
<font color="#E5E5E5">you need to this</font><font color="#CCCCCC"> is the entry point so</font>

402
00:14:34,720 --> 00:14:38,080
call<font color="#E5E5E5"> them from there and then everything</font>

403
00:14:36,580 --> 00:14:43,529
<font color="#E5E5E5">else was just sort of magically happen</font>

404
00:14:38,080 --> 00:14:46,570
for you so we also have a payload<font color="#E5E5E5"> server</font>

405
00:14:43,529 --> 00:14:49,240
<font color="#E5E5E5">this handles the download requests from</font>

406
00:14:46,570 --> 00:14:50,800
<font color="#E5E5E5">the stage in the sort of previous</font>

407
00:14:49,240 --> 00:14:52,660
version of<font color="#E5E5E5"> this talk it was just</font><font color="#CCCCCC"> running</font>

408
00:14:50,800 --> 00:14:54,550
<font color="#E5E5E5">on</font><font color="#CCCCCC"> Python</font><font color="#E5E5E5"> simple server I've no built</font>

409
00:14:52,660 --> 00:14:57,520
<font color="#E5E5E5">upon the flask app which allows you to</font>

410
00:14:54,550 --> 00:14:59,529
<font color="#E5E5E5">do some other</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> so at the minute you</font>

411
00:14:57,520 --> 00:15:01,600
can tell<font color="#E5E5E5"> this tool the maximum number of</font>

412
00:14:59,529 --> 00:15:03,070
<font color="#CCCCCC">times a payload can be read it's</font>

413
00:15:01,600 --> 00:15:04,720
defaulting to<font color="#E5E5E5"> wall at the minute and</font>

414
00:15:03,070 --> 00:15:06,820
<font color="#E5E5E5">again there's not an option to set that</font>

415
00:15:04,720 --> 00:15:09,190
the code is<font color="#CCCCCC"> all</font><font color="#E5E5E5"> where to do it it's</font><font color="#CCCCCC"> just</font>

416
00:15:06,820 --> 00:15:10,839
a case of<font color="#E5E5E5"> building a new menu and it</font>

417
00:15:09,190 --> 00:15:13,900
supports<font color="#E5E5E5"> redirects if the payload is</font>

418
00:15:10,839 --> 00:15:15,850
fetched<font color="#CCCCCC"> more than 10</font><font color="#E5E5E5"> times</font><font color="#CCCCCC"> so let's say</font>

419
00:15:13,900 --> 00:15:17,439
<font color="#CCCCCC">you're whenever</font><font color="#E5E5E5"> Red Team engagement the</font>

420
00:15:15,850 --> 00:15:18,610
client has a pretty good blue team and

421
00:15:17,440 --> 00:15:21,040
you're<font color="#E5E5E5"> worried they might be able to</font>

422
00:15:18,610 --> 00:15:23,230
<font color="#E5E5E5">sort</font><font color="#CCCCCC"> of fetch your UAS encrypted payload</font>

423
00:15:21,040 --> 00:15:24,760
<font color="#E5E5E5">if they're monitoring command line they</font>

424
00:15:23,230 --> 00:15:26,290
have the URL<font color="#E5E5E5"> and they have the crypto</font>

425
00:15:24,760 --> 00:15:28,300
key and they can pull the page

426
00:15:26,290 --> 00:15:29,980
<font color="#CCCCCC">off the wire again maybe putting</font><font color="#E5E5E5"> the</font>

427
00:15:28,300 --> 00:15:31,750
<font color="#CCCCCC">request so they have everything</font><font color="#E5E5E5"> they</font>

428
00:15:29,980 --> 00:15:33,779
<font color="#CCCCCC">need to be</font><font color="#E5E5E5"> equipped up and find out what</font>

429
00:15:31,750 --> 00:15:35,889
you rub on<font color="#CCCCCC"> there come</font><font color="#E5E5E5"> from my system</font>

430
00:15:33,779 --> 00:15:38,019
unless you<font color="#E5E5E5"> just send them to something</font>

431
00:15:35,889 --> 00:15:39,610
<font color="#E5E5E5">else</font><font color="#CCCCCC"> so you</font><font color="#E5E5E5"> can send them to a</font>

432
00:15:38,019 --> 00:15:41,920
legitimate looking update or you can

433
00:15:39,610 --> 00:15:43,240
send<font color="#CCCCCC"> them a</font><font color="#E5E5E5"> completely benign file or</font>

434
00:15:41,920 --> 00:15:46,449
you<font color="#CCCCCC"> can issue them a redirect to</font>

435
00:15:43,240 --> 00:15:49,000
something else which I have a<font color="#E5E5E5"> video with</font>

436
00:15:46,449 --> 00:15:51,370
this coming<font color="#E5E5E5"> up so this is a flask app</font>

437
00:15:49,000 --> 00:15:53,170
it's got a sink wall like DB<font color="#CCCCCC"> back-end</font><font color="#E5E5E5"> so</font>

438
00:15:51,370 --> 00:15:55,750
the payload builder<font color="#E5E5E5"> just drops crypto</font>

439
00:15:53,170 --> 00:15:57,399
keys<font color="#CCCCCC"> and links to</font><font color="#E5E5E5"> files on disk into</font>

440
00:15:55,750 --> 00:15:59,470
sequel Lite with a number<font color="#E5E5E5"> of counts that</font>

441
00:15:57,399 --> 00:16:01,120
<font color="#E5E5E5">are allowed this reads that database and</font>

442
00:15:59,470 --> 00:16:04,029
<font color="#E5E5E5">says</font><font color="#CCCCCC"> hop this</font><font color="#E5E5E5"> has this been accessed</font>

443
00:16:01,120 --> 00:16:08,019
more than<font color="#CCCCCC"> ten</font><font color="#E5E5E5"> times no</font><font color="#CCCCCC"> okay send the</font>

444
00:16:04,029 --> 00:16:10,990
encrypted<font color="#E5E5E5"> file yes send a redirect so if</font>

445
00:16:08,019 --> 00:16:12,579
the<font color="#E5E5E5"> sound works apologies with a</font>

446
00:16:10,990 --> 00:16:14,170
slightly potato quality on the sound I

447
00:16:12,579 --> 00:16:16,239
don't<font color="#CCCCCC"> I don't have a way of recording</font>

448
00:16:14,170 --> 00:16:18,219
screens<font color="#E5E5E5"> so this is the first request and</font>

449
00:16:16,240 --> 00:16:22,509
then<font color="#E5E5E5"> the second request and you can</font>

450
00:16:18,220 --> 00:16:24,100
probably<font color="#E5E5E5"> guess where this is going there</font>

451
00:16:22,509 --> 00:16:29,380
we go sorry<font color="#CCCCCC"> I had a chance to bicker all</font>

452
00:16:24,100 --> 00:16:30,790
you all<font color="#CCCCCC"> and I went for it</font><font color="#E5E5E5"> so you can</font>

453
00:16:29,380 --> 00:16:33,579
send these<font color="#CCCCCC"> beaten like</font><font color="#E5E5E5"> you can send this</font>

454
00:16:30,790 --> 00:16:35,110
to<font color="#CCCCCC"> wherever</font><font color="#E5E5E5"> you like</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> you can be</font>

455
00:16:33,579 --> 00:16:35,829
<font color="#CCCCCC">directed to a different server or a</font>

456
00:16:35,110 --> 00:16:38,529
<font color="#E5E5E5">YouTube video</font>

457
00:16:35,829 --> 00:16:41,079
<font color="#E5E5E5">whatever</font><font color="#CCCCCC"> this that the minute is</font>

458
00:16:38,529 --> 00:16:43,089
hard-coded<font color="#CCCCCC"> in the server as a URL</font><font color="#E5E5E5"> but</font>

459
00:16:41,079 --> 00:16:47,079
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> a trivial effort to sort of make</font>

460
00:16:43,089 --> 00:16:49,029
<font color="#CCCCCC">that customizable so for theory that is</font>

461
00:16:47,079 --> 00:16:51,160
essentially it<font color="#E5E5E5"> so I'm going</font><font color="#CCCCCC"> to start</font>

462
00:16:49,029 --> 00:16:53,290
<font color="#E5E5E5">running through the demos I've got four</font>

463
00:16:51,160 --> 00:16:56,410
<font color="#E5E5E5">or five</font><font color="#CCCCCC"> different AV products with</font>

464
00:16:53,290 --> 00:16:58,870
various videos so again I have recorded

465
00:16:56,410 --> 00:17:00,880
<font color="#CCCCCC">all these demos</font><font color="#E5E5E5"> because the four were</font>

466
00:16:58,870 --> 00:17:03,880
doing live demos<font color="#CCCCCC"> and this room terrifies</font>

467
00:17:00,880 --> 00:17:05,740
me beyond<font color="#CCCCCC"> belief so the first one is</font>

468
00:17:03,880 --> 00:17:07,750
Symantec endpoint 14 and<font color="#E5E5E5"> this is their</font>

469
00:17:05,740 --> 00:17:09,549
marketing blurb it says it is the

470
00:17:07,750 --> 00:17:11,439
world's<font color="#E5E5E5"> most advanced single agent</font>

471
00:17:09,549 --> 00:17:13,119
endpoint security with<font color="#E5E5E5"> prevention</font>

472
00:17:11,439 --> 00:17:16,179
detection and<font color="#E5E5E5"> response deception and</font>

473
00:17:13,119 --> 00:17:20,109
adaptation it's a lot<font color="#E5E5E5"> of words so that's</font>

474
00:17:16,179 --> 00:17:22,419
that<font color="#E5E5E5"> source this yeah see what happens</font>

475
00:17:20,109 --> 00:17:24,809
<font color="#E5E5E5">when we run</font><font color="#CCCCCC"> this so again</font><font color="#E5E5E5"> same sort</font><font color="#CCCCCC"> of</font>

476
00:17:22,419 --> 00:17:26,980
setup<font color="#CCCCCC"> Windows 10</font><font color="#E5E5E5"> RDP</font><font color="#CCCCCC"> did</font><font color="#E5E5E5"> so on the right</font>

477
00:17:24,809 --> 00:17:29,500
this<font color="#E5E5E5"> is the</font><font color="#CCCCCC"> new way of learning the tool</font>

478
00:17:26,980 --> 00:17:32,230
just one command<font color="#E5E5E5"> you'll notice it says</font>

479
00:17:29,500 --> 00:17:34,000
<font color="#CCCCCC">no check in there</font><font color="#E5E5E5"> I've disabled some box</font>

480
00:17:32,230 --> 00:17:35,590
checks just<font color="#CCCCCC"> to sort of run this</font><font color="#E5E5E5"> in be am</font>

481
00:17:34,000 --> 00:17:38,470
because plugging in flash drives<font color="#E5E5E5"> and</font>

482
00:17:35,590 --> 00:17:39,800
installing<font color="#CCCCCC"> stuff is a bit</font><font color="#E5E5E5"> of a pain</font><font color="#CCCCCC"> so</font>

483
00:17:38,470 --> 00:17:41,960
we can run yeah

484
00:17:39,800 --> 00:17:44,840
<font color="#CCCCCC">straight away you've got</font><font color="#E5E5E5"> Michelle back</font>

485
00:17:41,960 --> 00:17:46,670
this is<font color="#CCCCCC"> sixty four-bit</font><font color="#E5E5E5"> now full 64-bit</font>

486
00:17:44,840 --> 00:17:50,600
<font color="#E5E5E5">fully establishment service session</font>

487
00:17:46,670 --> 00:17:55,000
yeah it it saw nothing it did nothing<font color="#CCCCCC"> it</font>

488
00:17:50,600 --> 00:17:55,000
has<font color="#CCCCCC"> some fancy</font><font color="#E5E5E5"> words but</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> don't go</font>

489
00:17:55,780 --> 00:17:59,420
so the next one

490
00:17:57,440 --> 00:18:01,610
<font color="#CCCCCC">saw force intercept X I</font><font color="#E5E5E5"> should probably</font>

491
00:17:59,420 --> 00:18:03,710
say<font color="#CCCCCC"> that all these products</font><font color="#E5E5E5"> they get</font>

492
00:18:01,610 --> 00:18:07,040
<font color="#E5E5E5">more</font><font color="#CCCCCC"> and more</font><font color="#E5E5E5"> next-gen as we go they all</font>

493
00:18:03,710 --> 00:18:08,480
claim to be<font color="#E5E5E5"> next-gen except ISA ISA have</font>

494
00:18:07,040 --> 00:18:09,800
a blog<font color="#CCCCCC"> post where they say we don't</font>

495
00:18:08,480 --> 00:18:11,660
<font color="#E5E5E5">believe in next-gen we've been doing</font>

496
00:18:09,800 --> 00:18:13,610
this a long<font color="#CCCCCC"> time we do the same stuff</font>

497
00:18:11,660 --> 00:18:15,980
right<font color="#E5E5E5"> so this is</font><font color="#CCCCCC"> software since a</font>

498
00:18:13,610 --> 00:18:18,580
<font color="#CCCCCC">subtext there strapline being seeing the</font>

499
00:18:15,980 --> 00:18:20,930
future<font color="#E5E5E5"> is the future</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> cybersecurity</font><font color="#CCCCCC"> so</font>

500
00:18:18,580 --> 00:18:22,550
you can probably guess what's going to

501
00:18:20,930 --> 00:18:24,530
happen at<font color="#CCCCCC"> this one by now right but so</font>

502
00:18:22,550 --> 00:18:26,990
this again for<font color="#CCCCCC"> perhaps Windows 10</font><font color="#E5E5E5"> defend</font>

503
00:18:24,530 --> 00:18:30,170
there is<font color="#CCCCCC"> our latest</font><font color="#E5E5E5"> definitions and all</font>

504
00:18:26,990 --> 00:18:33,830
the rest of it in in<font color="#CCCCCC"> so forth from</font><font color="#E5E5E5"> the</font>

505
00:18:30,170 --> 00:18:35,780
same thing and<font color="#E5E5E5"> again it's a session</font><font color="#CCCCCC"> it</font>

506
00:18:33,830 --> 00:18:38,629
says 25<font color="#E5E5E5"> in here I did a lot of testing</font>

507
00:18:35,780 --> 00:18:46,879
when I recorded<font color="#E5E5E5"> this video so yeah so</font>

508
00:18:38,630 --> 00:18:49,790
yeah<font color="#CCCCCC"> for 64-bit</font><font color="#E5E5E5"> meterpreter session so</font>

509
00:18:46,880 --> 00:18:51,500
that's that one<font color="#E5E5E5"> so this I want to just</font>

510
00:18:49,790 --> 00:18:53,090
<font color="#E5E5E5">sort of show you you can do</font><font color="#CCCCCC"> thing to</font>

511
00:18:51,500 --> 00:18:55,940
this<font color="#E5E5E5"> session it doesn't signature on</font>

512
00:18:53,090 --> 00:18:57,590
stuff once you have the<font color="#E5E5E5"> session so the</font>

513
00:18:55,940 --> 00:18:58,970
window the terminal window on the left

514
00:18:57,590 --> 00:19:01,850
is me running<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> counts</font><font color="#CCCCCC"> fire</font>

515
00:18:58,970 --> 00:19:03,470
<font color="#E5E5E5">meterpreter</font><font color="#CCCCCC"> so you have meterpreter you</font>

516
00:19:01,850 --> 00:19:05,000
can still use all<font color="#E5E5E5"> the cool tools that</font>

517
00:19:03,470 --> 00:19:06,980
you can<font color="#CCCCCC"> run emitter because he you can</font>

518
00:19:05,000 --> 00:19:09,020
do creds<font color="#E5E5E5"> or you can load mini cups you</font>

519
00:19:06,980 --> 00:19:10,490
<font color="#CCCCCC">can dump hashes there's no how she's</font><font color="#E5E5E5"> in</font>

520
00:19:09,020 --> 00:19:12,110
there because<font color="#CCCCCC"> i've not turned on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> reg</font>

521
00:19:10,490 --> 00:19:14,300
key and windows<font color="#CCCCCC"> tends to say store then</font>

522
00:19:12,110 --> 00:19:17,629
<font color="#CCCCCC">plane tax</font><font color="#E5E5E5"> but it still</font><font color="#CCCCCC"> execute</font><font color="#E5E5E5"> doesn't</font>

523
00:19:14,300 --> 00:19:19,159
signature and<font color="#CCCCCC"> anything it has so</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

524
00:19:17,630 --> 00:19:21,530
interesting<font color="#CCCCCC"> with so fast</font><font color="#E5E5E5"> other if you</font>

525
00:19:19,160 --> 00:19:23,540
could<font color="#CCCCCC"> read this but</font><font color="#E5E5E5"> it warns the fact</font>

526
00:19:21,530 --> 00:19:25,879
that<font color="#CCCCCC"> i've</font><font color="#E5E5E5"> run</font><font color="#CCCCCC"> an unsigned binary on this</font>

527
00:19:23,540 --> 00:19:27,350
host<font color="#E5E5E5"> it didn't block me running it but</font>

528
00:19:25,880 --> 00:19:31,490
it has sort of logged it that I've

529
00:19:27,350 --> 00:19:33,980
executed<font color="#CCCCCC"> in unsigned binary</font><font color="#E5E5E5"> so I guess</font>

530
00:19:31,490 --> 00:19:35,900
this<font color="#E5E5E5"> is not really done a great deal</font>

531
00:19:33,980 --> 00:19:38,510
apart from like saying I've done<font color="#E5E5E5"> it by</font>

532
00:19:35,900 --> 00:19:41,210
the point<font color="#E5E5E5"> that done is too late so</font><font color="#CCCCCC"> II</font>

533
00:19:38,510 --> 00:19:42,860
set um yeah I've not got the blurb from

534
00:19:41,210 --> 00:19:44,540
<font color="#E5E5E5">the blog if you go and have a</font><font color="#CCCCCC"> google</font>

535
00:19:42,860 --> 00:19:47,090
around<font color="#CCCCCC"> ye certain</font><font color="#E5E5E5"> next-gen they have a</font>

536
00:19:44,540 --> 00:19:48,830
<font color="#E5E5E5">very wordy blog post saying we've been</font>

537
00:19:47,090 --> 00:19:50,090
in this industry from day one and<font color="#E5E5E5"> we do</font>

538
00:19:48,830 --> 00:19:51,949
all this stuff<font color="#E5E5E5"> that</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> are now</font>

539
00:19:50,090 --> 00:19:54,750
calling<font color="#E5E5E5"> next-gen like you don't really</font>

540
00:19:51,950 --> 00:19:56,610
<font color="#E5E5E5">we don't believe in it all this kind</font>

541
00:19:54,750 --> 00:19:57,990
getting a trial for<font color="#E5E5E5"> their business</font>

542
00:19:56,610 --> 00:20:00,360
offerings is actually kind of difficult

543
00:19:57,990 --> 00:20:03,360
<font color="#CCCCCC">so</font><font color="#E5E5E5"> you only you can only really get</font>

544
00:20:00,360 --> 00:20:04,979
trials of the home user offerings<font color="#E5E5E5"> but</font>

545
00:20:03,360 --> 00:20:06,540
they do basically<font color="#E5E5E5"> the same stuff if you</font>

546
00:20:04,980 --> 00:20:08,280
look at the<font color="#CCCCCC"> tick</font><font color="#E5E5E5"> list of what they offer</font>

547
00:20:06,540 --> 00:20:09,690
they all offer the same thing that<font color="#E5E5E5"> the</font>

548
00:20:08,280 --> 00:20:11,280
<font color="#CCCCCC">home version just</font><font color="#E5E5E5"> doesn't have</font><font color="#CCCCCC"> the sort</font>

549
00:20:09,690 --> 00:20:13,799
of<font color="#E5E5E5"> management interface and all that</font>

550
00:20:11,280 --> 00:20:15,928
kind of<font color="#CCCCCC"> stuff so the demo is going to be</font>

551
00:20:13,799 --> 00:20:17,850
<font color="#CCCCCC">revista internet</font><font color="#E5E5E5"> security because of</font>

552
00:20:15,929 --> 00:20:19,679
<font color="#E5E5E5">this line</font><font color="#CCCCCC"> here which says it blocks</font>

553
00:20:17,850 --> 00:20:23,428
attacks specifically designed<font color="#E5E5E5"> to evade</font>

554
00:20:19,679 --> 00:20:29,880
<font color="#E5E5E5">empty virus detection</font><font color="#CCCCCC"> yeah so</font><font color="#E5E5E5"> that's a</font>

555
00:20:23,429 --> 00:20:31,410
<font color="#E5E5E5">butterball claim but I am pretty much</font>

556
00:20:29,880 --> 00:20:33,090
taking this as a challenge yeah like the

557
00:20:31,410 --> 00:20:37,230
more I read in the marketing with the

558
00:20:33,090 --> 00:20:39,389
<font color="#E5E5E5">boy yeah but yeah</font><font color="#CCCCCC"> there's so this just</font>

559
00:20:37,230 --> 00:20:41,700
again<font color="#E5E5E5"> does not</font><font color="#CCCCCC"> care that</font><font color="#E5E5E5"> you've just</font>

560
00:20:39,390 --> 00:20:44,130
<font color="#E5E5E5">launched</font><font color="#CCCCCC"> shell weight loss</font><font color="#E5E5E5"> over the</font>

561
00:20:41,700 --> 00:20:45,809
shell code<font color="#E5E5E5"> the reason I chose</font>

562
00:20:44,130 --> 00:20:47,580
meterpreter shell code for<font color="#E5E5E5"> this is</font>

563
00:20:45,809 --> 00:20:48,928
because<font color="#E5E5E5"> I kind of wanted these</font><font color="#CCCCCC"> things to</font>

564
00:20:47,580 --> 00:20:52,590
signature on it<font color="#CCCCCC"> I wanted to give them</font>

565
00:20:48,929 --> 00:20:54,600
every chance<font color="#E5E5E5"> of flagging this tool so if</font>

566
00:20:52,590 --> 00:20:56,459
you try and<font color="#E5E5E5"> run meterpreter just like</font>

567
00:20:54,600 --> 00:20:58,199
<font color="#E5E5E5">spam and</font><font color="#CCCCCC"> XE from MSS venom and drop it</font>

568
00:20:56,460 --> 00:21:00,179
many of<font color="#E5E5E5"> these hosts they flag instantly</font>

569
00:20:58,200 --> 00:21:03,090
you can't get it on<font color="#E5E5E5"> desk</font><font color="#CCCCCC"> it's instantly</font>

570
00:21:00,179 --> 00:21:06,929
detected<font color="#CCCCCC"> there's so this is using the</font>

571
00:21:03,090 --> 00:21:08,879
<font color="#CCCCCC">XOR</font><font color="#E5E5E5"> yeah whatever the 'flag x author</font>

572
00:21:06,929 --> 00:21:14,040
<font color="#E5E5E5">shell code in</font><font color="#CCCCCC"> the message burnham is the</font>

573
00:21:08,880 --> 00:21:15,360
<font color="#CCCCCC">32</font><font color="#E5E5E5"> bit is using shy</font><font color="#CCCCCC"> e</font><font color="#E5E5E5"> Naga encoding but</font>

574
00:21:14,040 --> 00:21:17,370
they're still signature<font color="#CCCCCC"> you can still</font>

575
00:21:15,360 --> 00:21:21,570
drop these<font color="#E5E5E5"> files on disk and they'll get</font>

576
00:21:17,370 --> 00:21:25,168
detected straightaway so ESET allows you

577
00:21:21,570 --> 00:21:29,610
to run<font color="#CCCCCC"> the</font><font color="#E5E5E5"> turbo if you try</font><font color="#CCCCCC"> and drop</font>

578
00:21:25,169 --> 00:21:31,559
into shell<font color="#CCCCCC"> summative on ESET it has a</font>

579
00:21:29,610 --> 00:21:34,649
little<font color="#E5E5E5"> bit of a moment about</font><font color="#CCCCCC"> that so</font>

580
00:21:31,559 --> 00:21:36,418
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a fully established 64-bit</font>

581
00:21:34,650 --> 00:21:38,790
meterpreter session<font color="#E5E5E5"> everyone this is</font>

582
00:21:36,419 --> 00:21:40,260
admin so we can get system<font color="#CCCCCC"> we can</font>

583
00:21:38,790 --> 00:21:41,250
<font color="#CCCCCC">automate the system using name type</font><font color="#E5E5E5"> in</font>

584
00:21:40,260 --> 00:21:43,790
<font color="#E5E5E5">memory</font>

585
00:21:41,250 --> 00:21:50,910
drop it<font color="#E5E5E5"> the shell and it doesn't work</font>

586
00:21:43,790 --> 00:21:53,340
<font color="#E5E5E5">this is unusual but try it again and</font>

587
00:21:50,910 --> 00:21:55,919
then it<font color="#E5E5E5"> Flags the fact that you've</font>

588
00:21:53,340 --> 00:22:01,860
dropped<font color="#E5E5E5"> into command shell from the tip</font>

589
00:21:55,919 --> 00:22:03,690
so what the fuck so it's a recap what

590
00:22:01,860 --> 00:22:06,000
we've done<font color="#E5E5E5"> here we've run an unsigned</font>

591
00:22:03,690 --> 00:22:07,110
binary doesn't care we've downloaded

592
00:22:06,000 --> 00:22:08,730
some randoms

593
00:22:07,110 --> 00:22:11,459
from the internet<font color="#CCCCCC"> doesn't care</font><font color="#E5E5E5"> bill</font>

594
00:22:08,730 --> 00:22:14,309
<font color="#CCCCCC">executes it launched no like bad</font>

595
00:22:11,460 --> 00:22:15,840
<font color="#CCCCCC">shellcode in memory</font><font color="#E5E5E5"> established</font><font color="#CCCCCC"> a fork</font>

596
00:22:14,309 --> 00:22:17,700
meterpreter session<font color="#CCCCCC"> it doesn't care</font>

597
00:22:15,840 --> 00:22:19,439
<font color="#CCCCCC">about any of that</font><font color="#E5E5E5"> you can go on and you</font>

598
00:22:17,700 --> 00:22:20,490
<font color="#CCCCCC">can mini carts you can dump ashes you</font>

599
00:22:19,440 --> 00:22:22,650
can do all the cool stuff<font color="#E5E5E5"> and server</font>

600
00:22:20,490 --> 00:22:24,780
that can<font color="#E5E5E5"> do</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> you can't have access to</font>

601
00:22:22,650 --> 00:22:27,690
the<font color="#E5E5E5"> system shell because that's gonna</font>

602
00:22:24,780 --> 00:22:30,090
stop the bad<font color="#CCCCCC"> guys right I have no idea</font>

603
00:22:27,690 --> 00:22:35,070
why it<font color="#E5E5E5"> Flags on this it seems</font><font color="#CCCCCC"> completely</font>

604
00:22:30,090 --> 00:22:38,040
bizarre but there we go so McAfee yeah

605
00:22:35,070 --> 00:22:39,720
<font color="#E5E5E5">this is a this is</font><font color="#CCCCCC"> another one I</font><font color="#E5E5E5"> maneuver</font>

606
00:22:38,040 --> 00:22:40,889
attacks<font color="#E5E5E5"> who advanced consolidated</font>

607
00:22:39,720 --> 00:22:43,860
endpoint defense

608
00:22:40,890 --> 00:22:48,830
the interesting bit in here in the blurb

609
00:22:43,860 --> 00:22:51,209
is this near real-time detection<font color="#CCCCCC"> mmm</font>

610
00:22:48,830 --> 00:22:55,799
detects a road a threats in<font color="#CCCCCC"> near</font>

611
00:22:51,210 --> 00:22:58,049
<font color="#CCCCCC">real-time</font><font color="#E5E5E5"> I don't know what the</font>

612
00:22:55,799 --> 00:22:59,960
<font color="#CCCCCC">definition of near is but I can you can</font>

613
00:22:58,049 --> 00:23:03,600
probably guess what's going<font color="#CCCCCC"> to happen so</font>

614
00:22:59,960 --> 00:23:07,650
<font color="#CCCCCC">this is an old video by run</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> a steel</font>

615
00:23:03,600 --> 00:23:10,020
calm so this is when<font color="#E5E5E5"> you install silence</font>

616
00:23:07,650 --> 00:23:11,580
it actually kills VirtualBox<font color="#E5E5E5"> because it</font>

617
00:23:10,020 --> 00:23:14,250
does DLL injection<font color="#E5E5E5"> and VirtualBox</font>

618
00:23:11,580 --> 00:23:15,870
doesn't like that so this<font color="#E5E5E5"> was before I</font>

619
00:23:14,250 --> 00:23:18,540
install<font color="#CCCCCC"> silence on this</font><font color="#E5E5E5"> winter machine</font>

620
00:23:15,870 --> 00:23:20,610
so this<font color="#E5E5E5"> is running it it's the latest</font>

621
00:23:18,540 --> 00:23:23,190
updates<font color="#E5E5E5"> older version of the tool but</font>

622
00:23:20,610 --> 00:23:24,990
still the same technique<font color="#CCCCCC"> this is just</font>

623
00:23:23,190 --> 00:23:27,299
rather than sending a shell from a p.m.

624
00:23:24,990 --> 00:23:29,070
so<font color="#CCCCCC"> at like from</font><font color="#E5E5E5"> RDP into those machine</font>

625
00:23:27,299 --> 00:23:32,070
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> just sending it</font><font color="#CCCCCC"> into a virtual</font>

626
00:23:29,070 --> 00:23:34,139
<font color="#CCCCCC">machine it does the same</font><font color="#E5E5E5"> thing</font>

627
00:23:32,070 --> 00:23:39,120
this one doesn't mind if you go into<font color="#E5E5E5"> the</font>

628
00:23:34,140 --> 00:23:40,830
shell yes I just<font color="#CCCCCC"> it most of these I'm</font>

629
00:23:39,120 --> 00:23:42,389
dumping out the<font color="#CCCCCC"> hostname to see</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> the</font>

630
00:23:40,830 --> 00:23:44,399
sort of see there's no trick are we

631
00:23:42,390 --> 00:23:45,900
going on but if you can't read<font color="#E5E5E5"> it trust</font>

632
00:23:44,400 --> 00:23:48,929
me there is<font color="#CCCCCC"> no trickery in these videos</font>

633
00:23:45,900 --> 00:23:52,290
so<font color="#CCCCCC"> that is McAfee and then we come to</font>

634
00:23:48,929 --> 00:23:54,900
<font color="#CCCCCC">the good one</font><font color="#E5E5E5"> so all</font><font color="#CCCCCC"> the other products</font>

635
00:23:52,290 --> 00:23:58,139
here<font color="#E5E5E5"> sort of home user business user</font>

636
00:23:54,900 --> 00:24:00,360
offerings and they all claim to<font color="#CCCCCC"> be</font>

637
00:23:58,140 --> 00:24:01,710
<font color="#E5E5E5">next-gen but they're all they're</font><font color="#CCCCCC"> all</font>

638
00:24:00,360 --> 00:24:03,120
long established<font color="#E5E5E5"> companies</font><font color="#CCCCCC"> alright</font>

639
00:24:01,710 --> 00:24:05,100
they've kind of moved in the next-gen

640
00:24:03,120 --> 00:24:07,918
market because that's<font color="#E5E5E5"> where things are</font>

641
00:24:05,100 --> 00:24:10,918
going<font color="#E5E5E5"> with</font><font color="#CCCCCC"> AV central one</font><font color="#E5E5E5"> is a</font>

642
00:24:07,919 --> 00:24:12,990
reasonably new company<font color="#E5E5E5"> they don't offer</font>

643
00:24:10,919 --> 00:24:15,660
<font color="#E5E5E5">anything over the</font><font color="#CCCCCC"> next-gen as far as I</font>

644
00:24:12,990 --> 00:24:17,190
can tell they have<font color="#CCCCCC"> old claims in there</font>

645
00:24:15,660 --> 00:24:20,760
<font color="#E5E5E5">their marketing talk lines</font><font color="#CCCCCC"> asked as</font>

646
00:24:17,190 --> 00:24:21,070
everyone else<font color="#CCCCCC"> so yeah this claims to</font>

647
00:24:20,760 --> 00:24:22,960
diff

648
00:24:21,070 --> 00:24:24,820
and every end points against every type

649
00:24:22,960 --> 00:24:25,950
of<font color="#E5E5E5"> attack as every stage in</font><font color="#CCCCCC"> the threat</font>

650
00:24:24,820 --> 00:24:29,710
<font color="#CCCCCC">lifecycle</font>

651
00:24:25,950 --> 00:24:31,059
<font color="#E5E5E5">if I were on the video</font><font color="#CCCCCC"> the trial</font><font color="#E5E5E5"> for</font>

652
00:24:29,710 --> 00:24:33,159
this you can't get one<font color="#CCCCCC"> from someone</font>

653
00:24:31,059 --> 00:24:34,960
<font color="#CCCCCC">directly I managed to get one</font><font color="#E5E5E5"> through a</font>

654
00:24:33,159 --> 00:24:37,110
slightly shady<font color="#E5E5E5"> looking South African</font>

655
00:24:34,960 --> 00:24:38,950
company who sells this on their behalf

656
00:24:37,110 --> 00:24:41,408
<font color="#E5E5E5">interestingly I'm fairly sure that</font>

657
00:24:38,950 --> 00:24:43,539
company has an XSS or now<font color="#E5E5E5"> login page</font><font color="#CCCCCC"> for</font>

658
00:24:41,409 --> 00:24:46,179
the management<font color="#CCCCCC"> wall speaks for</font><font color="#E5E5E5"> play or</font>

659
00:24:43,539 --> 00:24:49,120
any of you to tell<font color="#E5E5E5"> you about that</font><font color="#CCCCCC"> uh</font><font color="#E5E5E5"> so</font>

660
00:24:46,179 --> 00:24:50,649
when you first install this it didn't

661
00:24:49,120 --> 00:24:52,508
fly<font color="#E5E5E5"> anything around the tool didn't</font>

662
00:24:50,649 --> 00:24:54,100
catch anything<font color="#E5E5E5"> this is brilliant like</font>

663
00:24:52,509 --> 00:24:55,570
this is gonna<font color="#E5E5E5"> be an awesome video well</font>

664
00:24:54,100 --> 00:24:56,918
then I started thinking<font color="#CCCCCC"> perhaps this is</font>

665
00:24:55,570 --> 00:24:59,259
<font color="#CCCCCC">slightly too easy</font>

666
00:24:56,919 --> 00:25:01,509
so I don't<font color="#E5E5E5"> have</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> X see from</font><font color="#CCCCCC"> MSS</font><font color="#E5E5E5"> venom</font>

667
00:24:59,259 --> 00:25:03,789
<font color="#CCCCCC">dropped it on desktop</font><font color="#E5E5E5"> didn't detect it</font>

668
00:25:01,509 --> 00:25:05,799
<font color="#E5E5E5">execute it</font><font color="#CCCCCC"> instant</font><font color="#E5E5E5"> shells didn't detect</font>

669
00:25:03,789 --> 00:25:08,799
it<font color="#CCCCCC"> so there's something</font><font color="#E5E5E5"> not right</font><font color="#CCCCCC"> about</font>

670
00:25:05,799 --> 00:25:10,149
that<font color="#E5E5E5"> so I left this running on the VM</font>

671
00:25:08,799 --> 00:25:11,950
for<font color="#E5E5E5"> a couple of days thinking maybe</font>

672
00:25:10,149 --> 00:25:14,080
needs to sync<font color="#E5E5E5"> with the server download</font>

673
00:25:11,950 --> 00:25:15,639
<font color="#E5E5E5">some sort of definition files and fill</font>

674
00:25:14,080 --> 00:25:17,320
my lap and<font color="#E5E5E5"> then up to</font><font color="#CCCCCC"> two days it did</font>

675
00:25:15,639 --> 00:25:20,139
<font color="#CCCCCC">actually detect him at this point</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> was</font>

676
00:25:17,320 --> 00:25:22,299
<font color="#CCCCCC">an acci so if you install this and</font>

677
00:25:20,139 --> 00:25:24,879
expected<font color="#CCCCCC"> Zapotec</font><font color="#E5E5E5"> juice from day one it</font>

678
00:25:22,299 --> 00:25:27,990
won't do that<font color="#CCCCCC"> i don't know why but it</font>

679
00:25:24,879 --> 00:25:30,279
took at least<font color="#CCCCCC"> two days of sitting</font><font color="#E5E5E5"> there</font>

680
00:25:27,990 --> 00:25:33,700
it did not say nearly<font color="#CCCCCC"> a ton</font><font color="#E5E5E5"> I'm like</font>

681
00:25:30,279 --> 00:25:36,220
<font color="#E5E5E5">maybe it should</font><font color="#CCCCCC"> have been so this is</font>

682
00:25:33,700 --> 00:25:37,480
<font color="#CCCCCC">certainly one</font><font color="#E5E5E5"> same sort of thing I've</font>

683
00:25:36,220 --> 00:25:40,809
<font color="#CCCCCC">got a couple of</font><font color="#E5E5E5"> videos for this one</font>

684
00:25:37,480 --> 00:25:43,899
because<font color="#E5E5E5"> I expect better from the product</font>

685
00:25:40,809 --> 00:25:45,940
with this sort<font color="#E5E5E5"> of reputation so this is</font>

686
00:25:43,899 --> 00:25:47,908
the you<font color="#E5E5E5"> can probably tell what's</font><font color="#CCCCCC"> gonna</font>

687
00:25:45,940 --> 00:25:50,889
happen by this point in that's<font color="#CCCCCC"> alright</font>

688
00:25:47,909 --> 00:25:53,710
no first detected<font color="#E5E5E5"> its monitoring</font><font color="#CCCCCC"> ninety</font>

689
00:25:50,889 --> 00:25:57,070
<font color="#CCCCCC">eight</font><font color="#E5E5E5"> processors</font><font color="#CCCCCC"> ninety one services</font><font color="#E5E5E5"> we</font>

690
00:25:53,710 --> 00:25:59,679
still got a session<font color="#E5E5E5"> out of it so yeah we</font>

691
00:25:57,070 --> 00:26:01,299
can full 64-bit<font color="#E5E5E5"> shell code we can</font>

692
00:25:59,679 --> 00:26:03,340
interactive it we can do all<font color="#E5E5E5"> that kind</font>

693
00:26:01,299 --> 00:26:05,019
<font color="#E5E5E5">of stuff we can drop it</font><font color="#CCCCCC"> the shell it</font>

694
00:26:03,340 --> 00:26:09,519
doesn't care about that and<font color="#E5E5E5"> like saw</font>

695
00:26:05,019 --> 00:26:12,450
<font color="#CCCCCC">force</font><font color="#E5E5E5"> or be</font><font color="#CCCCCC"> sure whichever was yeah so</font>

696
00:26:09,519 --> 00:26:17,320
yeah called the<font color="#CCCCCC"> host name out for you</font>

697
00:26:12,450 --> 00:26:21,340
yeah<font color="#E5E5E5"> it is running on this host so what</font>

698
00:26:17,320 --> 00:26:23,230
if I told<font color="#E5E5E5"> you this gets worse so this is</font>

699
00:26:21,340 --> 00:26:25,570
a next-gen product that claims to

700
00:26:23,230 --> 00:26:27,970
<font color="#E5E5E5">prevent every kind of attack right so</font>

701
00:26:25,570 --> 00:26:29,230
getting a shell<font color="#CCCCCC"> on a box we've seen this</font>

702
00:26:27,970 --> 00:26:31,600
<font color="#E5E5E5">as silence which I'm</font><font color="#CCCCCC"> gonna cover a</font>

703
00:26:29,230 --> 00:26:33,039
little<font color="#E5E5E5"> bit in a minute</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> because they</font>

704
00:26:31,600 --> 00:26:34,780
have a shell of this<font color="#E5E5E5"> box doesn't mean I</font>

705
00:26:33,039 --> 00:26:36,700
can actually do anything<font color="#E5E5E5"> useful</font>

706
00:26:34,780 --> 00:26:40,030
with it<font color="#CCCCCC"> apothem user as a pivot point</font><font color="#E5E5E5"> if</font>

707
00:26:36,700 --> 00:26:41,650
you're<font color="#E5E5E5"> sort of blocking other stuff so</font>

708
00:26:40,030 --> 00:26:44,500
this<font color="#E5E5E5"> is the video</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the full sort of</font>

709
00:26:41,650 --> 00:26:45,880
end to end<font color="#E5E5E5"> of this tool so</font><font color="#CCCCCC"> where we're</font>

710
00:26:44,500 --> 00:26:47,830
going to start off getting<font color="#E5E5E5"> it up</font>

711
00:26:45,880 --> 00:26:49,930
meterpreter session<font color="#CCCCCC"> as we have done</font><font color="#E5E5E5"> in</font>

712
00:26:47,830 --> 00:26:53,199
all the others<font color="#CCCCCC"> so you generate it using</font>

713
00:26:49,930 --> 00:26:55,510
the nice<font color="#E5E5E5"> little menu structure here the</font>

714
00:26:53,200 --> 00:26:58,380
template path is the path<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the text</font>

715
00:26:55,510 --> 00:27:02,760
file you want to<font color="#E5E5E5"> replace</font><font color="#CCCCCC"> shellcode with</font>

716
00:26:58,380 --> 00:27:02,760
<font color="#E5E5E5">call out and generate</font><font color="#CCCCCC"> that for you</font>

717
00:27:04,500 --> 00:27:09,160
apologies this is at the two<font color="#E5E5E5"> minute long</font>

718
00:27:06,520 --> 00:27:12,550
<font color="#E5E5E5">video because I don't know how to speed</font>

719
00:27:09,160 --> 00:27:15,820
these up when you record<font color="#E5E5E5"> them</font><font color="#CCCCCC"> well yeah</font>

720
00:27:12,550 --> 00:27:17,379
<font color="#E5E5E5">do the same thing with the URL so this</font>

721
00:27:15,820 --> 00:27:18,850
is if you<font color="#E5E5E5"> can read that this is how you</font>

722
00:27:17,380 --> 00:27:28,960
call this tool you just<font color="#E5E5E5"> let you get a</font>

723
00:27:18,850 --> 00:27:31,860
<font color="#E5E5E5">URL session come in okay so now we've</font>

724
00:27:28,960 --> 00:27:33,760
<font color="#E5E5E5">got</font><font color="#CCCCCC"> a an</font><font color="#E5E5E5"> established meterpreter session</font>

725
00:27:31,860 --> 00:27:35,709
<font color="#E5E5E5">what we probably want</font><font color="#CCCCCC"> to do at this</font>

726
00:27:33,760 --> 00:27:38,950
<font color="#E5E5E5">point is start trying to dump creds from</font>

727
00:27:35,710 --> 00:27:41,590
this host there's like let's let's

728
00:27:38,950 --> 00:27:43,360
<font color="#E5E5E5">assume missus dominga host that would</font>

729
00:27:41,590 --> 00:27:47,560
like domain admins logged in<font color="#CCCCCC"> on or</font>

730
00:27:43,360 --> 00:27:51,010
something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that we can run this tool</font>

731
00:27:47,560 --> 00:27:52,690
again from our shell session<font color="#CCCCCC"> launch</font><font color="#E5E5E5"> of a</font>

732
00:27:51,010 --> 00:27:55,890
c-sharp code<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is where you're</font>

733
00:27:52,690 --> 00:27:58,810
<font color="#E5E5E5">going to see the port of sharp dump so</font>

734
00:27:55,890 --> 00:28:00,760
go back in the payload server<font color="#E5E5E5"> tailor</font>

735
00:27:58,810 --> 00:28:04,000
builder and just build the<font color="#CCCCCC"> sharp dump</font>

736
00:28:00,760 --> 00:28:05,980
<font color="#E5E5E5">payload so this is a custom payload</font><font color="#CCCCCC"> it's</font>

737
00:28:04,000 --> 00:28:10,950
yeah it doesn't<font color="#CCCCCC"> do a</font><font color="#E5E5E5"> great deal of</font><font color="#CCCCCC"> often</font>

738
00:28:05,980 --> 00:28:10,950
encrypting it so we need the crypto key

739
00:28:11,010 --> 00:28:17,190
then we<font color="#E5E5E5"> can just move on this directly</font>

740
00:28:13,590 --> 00:28:17,189
<font color="#CCCCCC">at a sports session</font>

741
00:28:21,570 --> 00:28:26,080
we get to watch<font color="#E5E5E5"> me type in</font><font color="#CCCCCC"> real-time</font>

742
00:28:23,769 --> 00:28:29,559
<font color="#E5E5E5">which</font><font color="#CCCCCC"> isn't</font><font color="#E5E5E5"> sure you all want it's a</font>

743
00:28:26,080 --> 00:28:31,928
<font color="#E5E5E5">sitting see</font><font color="#CCCCCC"> ah there we go</font>

744
00:28:29,559 --> 00:28:34,450
<font color="#E5E5E5">so this now is</font><font color="#CCCCCC"> gonna go it's made the</font>

745
00:28:31,929 --> 00:28:37,389
request<font color="#E5E5E5"> to go and crop the payload</font><font color="#CCCCCC"> it's</font>

746
00:28:34,450 --> 00:28:39,220
gonna start dumping memory from<font color="#CCCCCC"> L sauce</font>

747
00:28:37,389 --> 00:28:42,459
this takes a<font color="#E5E5E5"> little bit of time to run</font>

748
00:28:39,220 --> 00:28:44,169
this system<font color="#CCCCCC"> isn't</font><font color="#E5E5E5"> it's a brand new VM</font>

749
00:28:42,460 --> 00:28:46,169
<font color="#E5E5E5">basically that there's only one user</font><font color="#CCCCCC"> on</font>

750
00:28:44,169 --> 00:28:48,220
there there's not<font color="#E5E5E5"> a whole lot</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> on</font>

751
00:28:46,169 --> 00:28:50,409
<font color="#CCCCCC">the</font><font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> thing with</font><font color="#E5E5E5"> this is it</font>

752
00:28:48,220 --> 00:28:52,570
does kind of hang the shell a<font color="#CCCCCC"> little bit</font>

753
00:28:50,409 --> 00:28:54,549
I've got no<font color="#CCCCCC"> idea why it's in a new</font>

754
00:28:52,570 --> 00:28:57,189
process it<font color="#E5E5E5"> shouldn't have any sort of</font>

755
00:28:54,549 --> 00:28:59,200
impact<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> whole session</font><font color="#E5E5E5"> but like</font>

756
00:28:57,190 --> 00:29:00,820
when you when you<font color="#CCCCCC"> and</font><font color="#E5E5E5"> di are in a minute</font>

757
00:28:59,200 --> 00:29:03,119
it sort of lags a little bit while it

758
00:29:00,820 --> 00:29:06,279
waits<font color="#E5E5E5"> for it</font><font color="#CCCCCC"> to finish dumping memory</font>

759
00:29:03,119 --> 00:29:08,408
which<font color="#CCCCCC"> is this so</font><font color="#E5E5E5"> what this is doing</font><font color="#CCCCCC"> in</font>

760
00:29:06,279 --> 00:29:10,570
the<font color="#CCCCCC"> background is doing a memory</font><font color="#E5E5E5"> dump of</font>

761
00:29:08,409 --> 00:29:12,609
Alsace and then it's turning it into a

762
00:29:10,570 --> 00:29:15,639
gzip file renaming it with a dot<font color="#E5E5E5"> peen</font>

763
00:29:12,609 --> 00:29:18,220
extension and you can exfiltrate that to

764
00:29:15,639 --> 00:29:19,779
your local<font color="#E5E5E5"> system you can</font><font color="#CCCCCC"> look mini caps</font>

765
00:29:18,220 --> 00:29:21,369
on that memory dump<font color="#E5E5E5"> as long as it's the</font>

766
00:29:19,779 --> 00:29:23,649
same version<font color="#CCCCCC"> in architecture with</font>

767
00:29:21,369 --> 00:29:25,478
Windows 10 you<font color="#E5E5E5"> can just run mini cavity</font>

768
00:29:23,649 --> 00:29:27,039
against him in<font color="#CCCCCC"> a memory dump</font><font color="#E5E5E5"> rather than</font>

769
00:29:25,479 --> 00:29:30,369
<font color="#CCCCCC">doing it sort of</font><font color="#E5E5E5"> on the compromised</font>

770
00:29:27,039 --> 00:29:33,820
<font color="#CCCCCC">machine it's finished so if we run da</font><font color="#E5E5E5"> I</font>

771
00:29:30,369 --> 00:29:38,168
saw in the<font color="#E5E5E5"> first one is me testing this</font>

772
00:29:33,820 --> 00:29:40,450
so the debug<font color="#CCCCCC"> state64</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> ah-64</font><font color="#E5E5E5"> is the</font>

773
00:29:38,169 --> 00:29:42,070
<font color="#E5E5E5">process ID of alsace in this instance so</font>

774
00:29:40,450 --> 00:29:44,889
the second one<font color="#CCCCCC"> is the one</font><font color="#E5E5E5"> that we've</font>

775
00:29:42,070 --> 00:29:49,359
just<font color="#E5E5E5"> run so we can go and download that</font>

776
00:29:44,889 --> 00:29:53,619
<font color="#E5E5E5">file this is me failing remembering</font>

777
00:29:49,359 --> 00:29:54,580
where I am in the<font color="#CCCCCC"> filesystem</font><font color="#E5E5E5"> so what I'm</font>

778
00:29:53,619 --> 00:29:56,499
<font color="#E5E5E5">not going to show you is actually</font>

779
00:29:54,580 --> 00:29:58,449
dumping the credentials<font color="#CCCCCC"> as once you've</font>

780
00:29:56,499 --> 00:30:00,070
<font color="#E5E5E5">got the the memory dump it's it's</font>

781
00:29:58,450 --> 00:30:01,359
reasonably straightforward to just<font color="#E5E5E5"> won't</font>

782
00:30:00,070 --> 00:30:03,999
let<font color="#E5E5E5"> me cut so it doesn't really have</font>

783
00:30:01,359 --> 00:30:06,059
much<font color="#CCCCCC"> value to</font><font color="#E5E5E5"> this but so we can go and</font>

784
00:30:03,999 --> 00:30:08,789
download<font color="#E5E5E5"> this memory dump</font>

785
00:30:06,059 --> 00:30:12,269
so to summarize what's just happened

786
00:30:08,789 --> 00:30:16,720
<font color="#CCCCCC">we've run unsigned binary</font><font color="#E5E5E5"> we've</font>

787
00:30:12,269 --> 00:30:18,789
<font color="#CCCCCC">shellcode we've established</font><font color="#E5E5E5"> as</font>

788
00:30:16,720 --> 00:30:20,369
<font color="#E5E5E5">possession we've dropped into shell</font>

789
00:30:18,789 --> 00:30:22,779
we've done this on so<font color="#E5E5E5"> inviting me again</font>

790
00:30:20,369 --> 00:30:24,728
<font color="#CCCCCC">we've been lost</font><font color="#E5E5E5"> a process that is</font>

791
00:30:22,779 --> 00:30:26,499
dumping the<font color="#E5E5E5"> alsace process memory so</font>

792
00:30:24,729 --> 00:30:28,119
<font color="#CCCCCC">hell</font><font color="#E5E5E5"> sauce is a</font><font color="#CCCCCC"> privileged process right</font>

793
00:30:26,499 --> 00:30:28,850
you have to<font color="#E5E5E5"> be system to read this</font>

794
00:30:28,119 --> 00:30:30,500
memory

795
00:30:28,850 --> 00:30:33,500
so we've moved<font color="#E5E5E5"> up the system we</font><font color="#CCCCCC"> start</font>

796
00:30:30,500 --> 00:30:35,389
dumping memory<font color="#E5E5E5"> it's exceeded its</font><font color="#CCCCCC"> created</font>

797
00:30:33,500 --> 00:30:36,590
a whopping big<font color="#E5E5E5"> file on your desk and</font>

798
00:30:35,389 --> 00:30:39,949
<font color="#E5E5E5">then we've downloaded a whopping</font><font color="#CCCCCC"> big</font>

799
00:30:36,590 --> 00:30:42,529
file<font color="#CCCCCC"> sentinel</font><font color="#E5E5E5"> one doesn't care about any</font>

800
00:30:39,950 --> 00:30:45,679
<font color="#E5E5E5">of these actions absolute this whole</font>

801
00:30:42,529 --> 00:30:47,149
<font color="#CCCCCC">prevents every type of threat i mean you</font>

802
00:30:45,679 --> 00:30:48,799
can can't enjoy your<font color="#CCCCCC"> own conclusions</font>

803
00:30:47,149 --> 00:30:55,039
<font color="#E5E5E5">from</font><font color="#CCCCCC"> that but it's not prevented this</font>

804
00:30:48,799 --> 00:30:57,230
one so silence so when<font color="#CCCCCC"> I</font><font color="#E5E5E5"> did this</font><font color="#CCCCCC"> steel</font>

805
00:30:55,039 --> 00:31:00,200
calm<font color="#CCCCCC"> I'd</font><font color="#E5E5E5"> only actually built the 32-bit</font>

806
00:30:57,230 --> 00:31:02,000
<font color="#E5E5E5">version</font><font color="#CCCCCC"> of the shell</font><font color="#E5E5E5"> code launcher</font><font color="#CCCCCC"> thank</font>

807
00:31:00,200 --> 00:31:03,860
<font color="#CCCCCC">perfectly well we saw</font><font color="#E5E5E5"> the video at the</font>

808
00:31:02,000 --> 00:31:05,870
start you<font color="#CCCCCC"> can get a shell with food soup</font>

809
00:31:03,860 --> 00:31:07,908
it on silence it it doesn't care<font color="#CCCCCC"> that</font>

810
00:31:05,870 --> 00:31:09,110
you're doing<font color="#E5E5E5"> all this stuff</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it's not</font>

811
00:31:07,909 --> 00:31:11,389
<font color="#CCCCCC">quite</font><font color="#E5E5E5"> as simple as</font><font color="#CCCCCC"> that</font>

812
00:31:09,110 --> 00:31:12,939
so when I built the 64-bit<font color="#CCCCCC"> version of</font>

813
00:31:11,389 --> 00:31:15,320
this tool

814
00:31:12,940 --> 00:31:19,820
soil and<font color="#CCCCCC"> straightaway</font><font color="#E5E5E5"> and it blocks</font>

815
00:31:15,320 --> 00:31:21,860
<font color="#E5E5E5">everything instantly like so it turns</font>

816
00:31:19,820 --> 00:31:24,230
out it actually flags<font color="#CCCCCC"> on marking memory</font>

817
00:31:21,860 --> 00:31:26,029
<font color="#CCCCCC">is executable so when you run 32-bit</font>

818
00:31:24,230 --> 00:31:28,399
<font color="#CCCCCC">shellcode it's slightly</font><font color="#E5E5E5"> different to</font>

819
00:31:26,029 --> 00:31:29,899
running 64-bit<font color="#CCCCCC"> to run 64-bit you</font>

820
00:31:28,399 --> 00:31:32,209
allocate memory and your market is

821
00:31:29,899 --> 00:31:34,158
executable<font color="#E5E5E5"> marking is actually cutable</font>

822
00:31:32,210 --> 00:31:36,710
courses causes<font color="#E5E5E5"> Cylons to flag that</font>

823
00:31:34,159 --> 00:31:38,149
process and kill it it doesn't<font color="#E5E5E5"> kill the</font>

824
00:31:36,710 --> 00:31:39,620
<font color="#CCCCCC">XE that you've uploaded</font><font color="#E5E5E5"> because this</font>

825
00:31:38,149 --> 00:31:41,268
happens in a separate process but it

826
00:31:39,620 --> 00:31:44,570
does kill that process<font color="#E5E5E5"> so you can't get</font>

827
00:31:41,269 --> 00:31:47,029
<font color="#E5E5E5">a 64-bit shell by shell code</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> also</font>

828
00:31:44,570 --> 00:31:49,939
flags on else<font color="#CCCCCC"> has read so you can still</font>

829
00:31:47,029 --> 00:31:52,159
run the sharp dump direct me don't need

830
00:31:49,940 --> 00:31:53,450
<font color="#CCCCCC">a shell to do that and it</font><font color="#E5E5E5"> will start</font>

831
00:31:52,159 --> 00:31:55,190
<font color="#E5E5E5">running and it will generate an output</font>

832
00:31:53,450 --> 00:31:56,929
<font color="#E5E5E5">file but the content is absolute garbage</font>

833
00:31:55,190 --> 00:32:00,980
<font color="#E5E5E5">because silence stops it from</font><font color="#CCCCCC"> reading</font>

834
00:31:56,929 --> 00:32:04,100
else<font color="#E5E5E5"> ass</font><font color="#CCCCCC"> all this</font><font color="#E5E5E5"> 64-bit stuff that is</font>

835
00:32:00,980 --> 00:32:06,019
nice to do<font color="#E5E5E5"> silence will flag on all of</font>

836
00:32:04,100 --> 00:32:08,418
it as<font color="#E5E5E5"> far as I can tell</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it</font>

837
00:32:06,019 --> 00:32:12,049
completely<font color="#CCCCCC"> ignores 32-bit like</font><font color="#E5E5E5"> 32 bit</font>

838
00:32:08,419 --> 00:32:13,639
just doesn't<font color="#CCCCCC"> exist to silence which so</font>

839
00:32:12,049 --> 00:32:14,809
it does prevent<font color="#E5E5E5"> you getting a nice Ness</font>

840
00:32:13,639 --> 00:32:16,100
point session and it prevents you

841
00:32:14,809 --> 00:32:17,779
<font color="#E5E5E5">dropping credentials and all the rest of</font>

842
00:32:16,100 --> 00:32:20,029
it<font color="#E5E5E5"> but I can still use</font><font color="#CCCCCC"> that host as a</font>

843
00:32:17,779 --> 00:32:22,250
pivot point<font color="#E5E5E5"> I can still have shells on</font>

844
00:32:20,029 --> 00:32:24,320
that box<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you can kill</font><font color="#E5E5E5"> Cylons if you</font>

845
00:32:22,250 --> 00:32:26,000
have shell access<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> box why it's</font>

846
00:32:24,320 --> 00:32:28,070
not part of this talk but there are

847
00:32:26,000 --> 00:32:29,629
techniques<font color="#E5E5E5"> to kill</font><font color="#CCCCCC"> silence once you have</font>

848
00:32:28,070 --> 00:32:31,789
sort<font color="#E5E5E5"> of system access</font><font color="#CCCCCC"> all that</font><font color="#E5E5E5"> both on</font>

849
00:32:29,629 --> 00:32:33,259
<font color="#E5E5E5">that box in the</font><font color="#CCCCCC"> 32-bit shell you can</font>

850
00:32:31,789 --> 00:32:34,850
<font color="#E5E5E5">elevate the system using in memory</font>

851
00:32:33,259 --> 00:32:38,330
whatever<font color="#E5E5E5"> else you want</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> silence</font>

852
00:32:34,850 --> 00:32:40,189
doesn't<font color="#E5E5E5"> care</font><font color="#CCCCCC"> so if you if you try and</font>

853
00:32:38,330 --> 00:32:42,010
<font color="#E5E5E5">run this in 64-bit it's not going to</font>

854
00:32:40,190 --> 00:32:43,810
work<font color="#CCCCCC"> but if you happen to</font><font color="#E5E5E5"> have a way</font>

855
00:32:42,010 --> 00:32:45,460
killing silence then you can still get

856
00:32:43,810 --> 00:32:47,470
shells you<font color="#CCCCCC"> can kill silence you can</font>

857
00:32:45,460 --> 00:32:49,560
migrate into<font color="#CCCCCC"> a 64-bit processor full</font>

858
00:32:47,470 --> 00:32:54,310
64-bit session and you're still winning

859
00:32:49,560 --> 00:32:56,530
so that is it for<font color="#CCCCCC"> the demos</font><font color="#E5E5E5"> further work</font>

860
00:32:54,310 --> 00:32:58,870
on this<font color="#E5E5E5"> I've done</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of the stuff</font>

861
00:32:56,530 --> 00:33:00,610
that<font color="#E5E5E5"> I was</font><font color="#CCCCCC"> talking about a steal</font><font color="#E5E5E5"> con the</font>

862
00:32:58,870 --> 00:33:02,620
next thing I want<font color="#E5E5E5"> to do is add</font><font color="#CCCCCC"> post buck</font>

863
00:33:00,610 --> 00:33:05,590
<font color="#CCCCCC">support so that payload server</font><font color="#E5E5E5"> so at the</font>

864
00:33:02,620 --> 00:33:08,110
minute<font color="#E5E5E5"> it's get only</font><font color="#CCCCCC"> we could allow it</font>

865
00:33:05,590 --> 00:33:09,939
to receive files or some commands<font color="#E5E5E5"> that</font>

866
00:33:08,110 --> 00:33:12,490
opens up a<font color="#E5E5E5"> whole new world</font><font color="#CCCCCC"> of payloads</font>

867
00:33:09,940 --> 00:33:14,140
that<font color="#E5E5E5"> we can do so dumping a file on desk</font>

868
00:33:12,490 --> 00:33:16,780
for example we could<font color="#E5E5E5"> just</font><font color="#CCCCCC"> export rig</font>

869
00:33:14,140 --> 00:33:17,640
that straight back to<font color="#CCCCCC"> C</font><font color="#E5E5E5"> to just push it</font>

870
00:33:16,780 --> 00:33:21,220
so far

871
00:33:17,640 --> 00:33:22,960
more templates I've said a few<font color="#CCCCCC"> times sky</font>

872
00:33:21,220 --> 00:33:24,730
is the limit with this<font color="#E5E5E5"> if you can write</font>

873
00:33:22,960 --> 00:33:27,220
it in<font color="#E5E5E5"> c-sharp</font><font color="#CCCCCC"> you can run it using this</font>

874
00:33:24,730 --> 00:33:28,810
tool and it<font color="#CCCCCC"> will bypass AV</font><font color="#E5E5E5"> so</font>

875
00:33:27,220 --> 00:33:30,580
silence is flagging<font color="#E5E5E5"> on shellcode</font>

876
00:33:28,810 --> 00:33:32,139
execution but you can build<font color="#CCCCCC"> a bit of</font>

877
00:33:30,580 --> 00:33:34,480
shells<font color="#CCCCCC"> in c-sharp there's no reason why</font>

878
00:33:32,140 --> 00:33:36,640
<font color="#E5E5E5">you can't do that</font><font color="#CCCCCC"> test it on more</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> av</font>

879
00:33:34,480 --> 00:33:38,470
engines<font color="#E5E5E5"> the ones I've tested on are the</font>

880
00:33:36,640 --> 00:33:40,780
ones<font color="#E5E5E5"> I found that the</font><font color="#CCCCCC"> biggest sort of</font>

881
00:33:38,470 --> 00:33:43,540
market name that<font color="#CCCCCC"> claim to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> next-gen or</font>

882
00:33:40,780 --> 00:33:45,280
justify why they're not next-gen carbon

883
00:33:43,540 --> 00:33:47,139
black<font color="#E5E5E5"> CrowdStrike those sorts of things</font>

884
00:33:45,280 --> 00:33:48,399
trying<font color="#E5E5E5"> to get trials for those is</font>

885
00:33:47,140 --> 00:33:49,990
basically impossible

886
00:33:48,400 --> 00:33:52,510
<font color="#E5E5E5">I've sent a couple of requests off and</font>

887
00:33:49,990 --> 00:33:54,130
been ignored or had a sales guy asking

888
00:33:52,510 --> 00:33:56,290
<font color="#E5E5E5">me how many like hosts I want to install</font>

889
00:33:54,130 --> 00:33:57,580
this<font color="#E5E5E5"> on and trying to sell me a like</font><font color="#CCCCCC"> 500</font>

890
00:33:56,290 --> 00:33:59,680
user<font color="#E5E5E5"> license</font>

891
00:33:57,580 --> 00:34:01,480
I'm not buying if I<font color="#E5E5E5"> can</font><font color="#CCCCCC"> reduce a license</font>

892
00:33:59,680 --> 00:34:04,240
to test one tool<font color="#E5E5E5"> for five minutes</font><font color="#CCCCCC"> and</font>

893
00:34:01,480 --> 00:34:05,860
<font color="#CCCCCC">porting this to other languages so I</font>

894
00:34:04,240 --> 00:34:07,810
student still<font color="#E5E5E5"> concert this would be</font>

895
00:34:05,860 --> 00:34:09,639
<font color="#E5E5E5">awesome to buy in Java Java can do the</font>

896
00:34:07,810 --> 00:34:11,649
<font color="#E5E5E5">same</font><font color="#CCCCCC"> sort of thing of building itself in</font>

897
00:34:09,639 --> 00:34:14,560
memory so one<font color="#CCCCCC"> of them our guys</font><font color="#E5E5E5"> about</font>

898
00:34:11,649 --> 00:34:16,870
this<font color="#CCCCCC"> the Java implementation Ritchie</font>

899
00:34:14,560 --> 00:34:19,659
<font color="#E5E5E5">who's</font><font color="#CCCCCC"> our sort of head of</font><font color="#E5E5E5"> all things</font>

900
00:34:16,870 --> 00:34:21,580
Scotland<font color="#CCCCCC"> he presented this a</font><font color="#E5E5E5"> Def Con in</font>

901
00:34:19,659 --> 00:34:23,200
Glasgow<font color="#CCCCCC"> if you want to play with</font><font color="#E5E5E5"> it it</font>

902
00:34:21,580 --> 00:34:24,909
doesn't do<font color="#E5E5E5"> shell code but it does all</font>

903
00:34:23,199 --> 00:34:27,839
the sort<font color="#E5E5E5"> of building Java in memory so</font>

904
00:34:24,909 --> 00:34:32,139
that's his<font color="#E5E5E5"> get up it's an awesome tool</font>

905
00:34:27,840 --> 00:34:33,850
so how do we<font color="#E5E5E5"> protect against this well</font>

906
00:34:32,139 --> 00:34:35,649
this<font color="#CCCCCC"> is a post exploitation to a light</font>

907
00:34:33,850 --> 00:34:39,339
so avoid the initial<font color="#CCCCCC"> compromise</font>

908
00:34:35,649 --> 00:34:41,649
probably<font color="#E5E5E5"> easier said than done so what</font>

909
00:34:39,340 --> 00:34:44,050
I'm<font color="#E5E5E5"> not releasing here is like</font><font color="#CCCCCC"> Bo days</font>

910
00:34:41,649 --> 00:34:45,819
and a be no Nabisco<font color="#CCCCCC"> target say be in</font>

911
00:34:44,050 --> 00:34:48,190
<font color="#CCCCCC">anyway it's it's</font><font color="#E5E5E5"> just a way of bypassing</font>

912
00:34:45,820 --> 00:34:49,899
it there will always be a<font color="#E5E5E5"> V bypasses</font>

913
00:34:48,190 --> 00:34:51,460
this is not a new thing<font color="#CCCCCC"> it's not going</font>

914
00:34:49,899 --> 00:34:53,888
to be the<font color="#E5E5E5"> last of them</font>

915
00:34:51,460 --> 00:34:55,179
so don't rely<font color="#CCCCCC"> on a be like</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> B's</font>

916
00:34:53,889 --> 00:34:57,430
brilliant<font color="#E5E5E5"> for stopping stuff by</font>

917
00:34:55,179 --> 00:34:59,740
cryptolocker<font color="#E5E5E5"> or like no malware samples</font>

918
00:34:57,430 --> 00:35:01,089
<font color="#E5E5E5">but there will always</font><font color="#CCCCCC"> be like patient</font>

919
00:34:59,740 --> 00:35:02,740
zero<font color="#CCCCCC"> you</font><font color="#E5E5E5"> always have to have somebody</font>

920
00:35:01,089 --> 00:35:04,359
<font color="#CCCCCC">you've got wrecked</font><font color="#E5E5E5"> by something before</font>

921
00:35:02,740 --> 00:35:06,819
<font color="#E5E5E5">the signatures for it</font>

922
00:35:04,359 --> 00:35:09,098
so do you<font color="#E5E5E5"> defense-in-depth alerting on</font>

923
00:35:06,819 --> 00:35:10,720
stuff everything<font color="#CCCCCC"> I've shown you</font><font color="#E5E5E5"> if you</font>

924
00:35:09,099 --> 00:35:12,309
have decent alerting you should have at

925
00:35:10,720 --> 00:35:13,868
least detected<font color="#E5E5E5"> that</font><font color="#CCCCCC"> host being</font>

926
00:35:12,309 --> 00:35:15,579
compromised like suspicious network

927
00:35:13,869 --> 00:35:17,380
traffic<font color="#E5E5E5"> and</font><font color="#CCCCCC"> signed</font><font color="#E5E5E5"> binaries being</font><font color="#CCCCCC"> around</font>

928
00:35:15,579 --> 00:35:19,660
huge files being actual<font color="#CCCCCC"> trade</font><font color="#E5E5E5"> across the</font>

929
00:35:17,380 --> 00:35:21,069
network<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> work on all of it and send</font>

930
00:35:19,660 --> 00:35:22,149
the blue team guy out to<font color="#CCCCCC"> figure out what</font>

931
00:35:21,069 --> 00:35:25,480
the<font color="#CCCCCC"> hell's</font><font color="#E5E5E5"> going on</font><font color="#CCCCCC"> there that server</font>

932
00:35:22,150 --> 00:35:28,690
was<font color="#E5E5E5"> smoking</font><font color="#CCCCCC"> out of it so yeah there's no</font>

933
00:35:25,480 --> 00:35:31,269
real way<font color="#CCCCCC"> so</font><font color="#E5E5E5"> I'm not opposed to any of</font>

934
00:35:28,690 --> 00:35:35,170
the<font color="#E5E5E5"> AV vendors of this by the way it's</font>

935
00:35:31,269 --> 00:35:36,959
not<font color="#E5E5E5"> an exploit for</font><font color="#CCCCCC"> a V</font><font color="#E5E5E5"> if I told what</font>

936
00:35:35,170 --> 00:35:39,549
I'd have<font color="#E5E5E5"> to tell them all and it just</font>

937
00:35:36,960 --> 00:35:41,410
there's<font color="#CCCCCC"> nothing really there that needs</font>

938
00:35:39,549 --> 00:35:43,690
to be<font color="#E5E5E5"> disclosed this is just a technique</font>

939
00:35:41,410 --> 00:35:45,368
<font color="#CCCCCC">that whilst some like they should be</font>

940
00:35:43,690 --> 00:35:47,319
<font color="#E5E5E5">flagging on suspicious</font><font color="#CCCCCC"> actions like</font>

941
00:35:45,369 --> 00:35:48,759
silence for example in 64-bit<font color="#CCCCCC"> it does</font>

942
00:35:47,319 --> 00:35:51,160
quite<font color="#CCCCCC"> a good job it prevents your</font><font color="#E5E5E5"> doing</font>

943
00:35:48,759 --> 00:35:55,690
things<font color="#E5E5E5"> that like attackers will do the</font>

944
00:35:51,160 --> 00:35:58,149
others<font color="#E5E5E5"> don't so yeah this</font><font color="#CCCCCC"> is this isn't</font>

945
00:35:55,690 --> 00:35:59,619
<font color="#E5E5E5">gonna get perhaps by AV you gonna have</font>

946
00:35:58,150 --> 00:36:01,869
to put the<font color="#E5E5E5"> defense in depth stuff in</font>

947
00:35:59,619 --> 00:36:03,910
place<font color="#E5E5E5"> so the moment you've all been</font>

948
00:36:01,869 --> 00:36:05,380
waiting for<font color="#E5E5E5"> I'm sure the tool is live on</font>

949
00:36:03,910 --> 00:36:08,680
the<font color="#E5E5E5"> github it has been there for</font><font color="#CCCCCC"> a</font>

950
00:36:05,380 --> 00:36:10,450
couple<font color="#CCCCCC"> of weeks</font><font color="#E5E5E5"> it's it's stable it's</font>

951
00:36:08,680 --> 00:36:13,660
<font color="#E5E5E5">been used in the wild on some of our</font>

952
00:36:10,450 --> 00:36:16,328
engagements<font color="#E5E5E5"> there's</font><font color="#CCCCCC"> that yeah field</font>

953
00:36:13,660 --> 00:36:19,239
<font color="#CCCCCC">field feats like</font><font color="#E5E5E5"> those the slides will</font>

954
00:36:16,329 --> 00:36:21,549
be stuck on github later on this week

955
00:36:19,239 --> 00:36:22,839
<font color="#E5E5E5">probably tomorrow when I get home I'll</font>

956
00:36:21,549 --> 00:36:25,210
<font color="#CCCCCC">drop some of the videos on there as well</font>

957
00:36:22,839 --> 00:36:26,769
<font color="#E5E5E5">if you want to watch them</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> you've</font>

958
00:36:25,210 --> 00:36:28,509
got<font color="#CCCCCC"> the 32 bit shell code launcher</font>

959
00:36:26,769 --> 00:36:30,488
<font color="#CCCCCC">64-bit shot but</font><font color="#E5E5E5"> once</font><font color="#CCCCCC"> your the port of</font>

960
00:36:28,509 --> 00:36:31,989
<font color="#E5E5E5">sharp dump the readme is got the</font>

961
00:36:30,489 --> 00:36:33,970
template<font color="#E5E5E5"> in to build</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> own payloads</font>

962
00:36:31,989 --> 00:36:36,369
enough info to<font color="#CCCCCC"> get you</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> with it</font>

963
00:36:33,970 --> 00:36:37,988
<font color="#CCCCCC">it's all</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> you need a couple of</font>

964
00:36:36,369 --> 00:36:40,029
dependencies just to make the font

965
00:36:37,989 --> 00:36:42,039
colors nice and stuff like that in the

966
00:36:40,029 --> 00:36:43,599
payload builder<font color="#CCCCCC"> but that's it</font><font color="#E5E5E5"> you can go</font>

967
00:36:42,039 --> 00:36:47,140
<font color="#CCCCCC">away and start using</font><font color="#E5E5E5"> this now if you</font>

968
00:36:43,599 --> 00:36:49,119
want to that's it if you've got any

969
00:36:47,140 --> 00:36:51,129
questions shut them<font color="#E5E5E5"> out or come find</font><font color="#CCCCCC"> me</font>

970
00:36:49,119 --> 00:36:54,789
<font color="#E5E5E5">on our stand outside grab me on Twitter</font>

971
00:36:51,130 --> 00:36:57,539
<font color="#CCCCCC">yeah shut</font><font color="#E5E5E5"> my feed on it give it up</font><font color="#CCCCCC"> the</font>

972
00:36:54,789 --> 00:36:57,539
James thank you

973
00:37:01,190 --> 00:37:14,390
has anyone got<font color="#CCCCCC"> any questions if you do</font>

974
00:37:04,819 --> 00:37:16,519
<font color="#E5E5E5">I've got</font><font color="#CCCCCC"> the mic</font><font color="#E5E5E5"> if not yep don't</font><font color="#CCCCCC"> yeah</font>

975
00:37:14,390 --> 00:37:18,890
I'm just<font color="#CCCCCC"> a quick question and have you</font>

976
00:37:16,519 --> 00:37:21,288
ever actually checked or verified that

977
00:37:18,890 --> 00:37:24,650
the compilation happens<font color="#E5E5E5"> purely a memory</font>

978
00:37:21,289 --> 00:37:25,880
<font color="#E5E5E5">yeah so like identity</font><font color="#CCCCCC"> views like code on</font>

979
00:37:24,650 --> 00:37:27,910
for<font color="#E5E5E5"> example there's certain like</font>

980
00:37:25,880 --> 00:37:30,650
compiler parameters that you set like

981
00:37:27,910 --> 00:37:33,078
generating memory equals<font color="#CCCCCC"> troop but they</font>

982
00:37:30,650 --> 00:37:35,390
actually lie so they usually drop the

983
00:37:33,079 --> 00:37:38,869
c-sharp<font color="#E5E5E5"> source code to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> tempo</font>

984
00:37:35,390 --> 00:37:41,150
directory then call out CSC load the<font color="#CCCCCC"> dll</font>

985
00:37:38,869 --> 00:37:43,160
then import the DLL<font color="#E5E5E5"> into memory</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> I've</font>

986
00:37:41,150 --> 00:37:45,500
not monitored every<font color="#CCCCCC"> action that's going</font>

987
00:37:43,160 --> 00:37:48,019
on with this<font color="#CCCCCC"> so that's how like like the</font>

988
00:37:45,500 --> 00:37:51,200
<font color="#E5E5E5">other like C shots a lot like in</font><font color="#CCCCCC"> network</font>

989
00:37:48,019 --> 00:37:53,660
in yeah it's<font color="#E5E5E5"> looking up I know the sort</font>

990
00:37:51,200 --> 00:37:54,859
of<font color="#E5E5E5"> dotnet way so there's a few</font><font color="#CCCCCC"> different</font>

991
00:37:53,660 --> 00:37:57,470
ways<font color="#E5E5E5"> of building got that right you've</font>

992
00:37:54,859 --> 00:38:01,630
got msbuild and the other one the visual

993
00:37:57,470 --> 00:38:01,629
studio<font color="#E5E5E5"> users those definitely touch desk</font>

994
00:38:01,869 --> 00:38:18,259
okay well to take<font color="#CCCCCC"> a look but</font><font color="#E5E5E5"> it's one</font>

995
00:38:14,960 --> 00:38:20,930
thing I've not looked up<font color="#CCCCCC"> but I</font><font color="#E5E5E5"> guess</font>

996
00:38:18,259 --> 00:38:22,990
it's kind of doesn't<font color="#E5E5E5"> matter at</font><font color="#CCCCCC"> this</font>

997
00:38:20,930 --> 00:38:22,990
point

998
00:38:27,940 --> 00:38:34,339
Justin yeah<font color="#E5E5E5"> yeah look at you</font><font color="#CCCCCC"> she got a</font>

999
00:38:32,750 --> 00:38:36,200
link<font color="#CCCCCC"> to your</font><font color="#E5E5E5"> blog quite fiery over</font><font color="#CCCCCC"> onto</font>

1000
00:38:34,339 --> 00:38:37,730
it at<font color="#E5E5E5"> all I could love the city do it</font><font color="#CCCCCC"> -</font>

1001
00:38:36,200 --> 00:38:41,450
<font color="#CCCCCC">moans I know how she told</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> just go</font>

1002
00:38:37,730 --> 00:38:43,160
ahead I'm fairly yeah<font color="#CCCCCC"> I was under</font><font color="#E5E5E5"> the</font>

1003
00:38:41,450 --> 00:38:44,328
impression it didn't I've not seen any

1004
00:38:43,160 --> 00:38:45,500
evidence<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> does but</font><font color="#E5E5E5"> if you're</font>

1005
00:38:44,329 --> 00:38:46,670
saying<font color="#E5E5E5"> like it's calling</font><font color="#CCCCCC"> out to</font>

1006
00:38:45,500 --> 00:38:53,930
something<font color="#CCCCCC"> I didn't know</font><font color="#E5E5E5"> about the new</font>

1007
00:38:46,670 --> 00:38:55,430
<font color="#E5E5E5">and they</font><font color="#CCCCCC"> well do awesome so I'm</font><font color="#E5E5E5"> gonna</font>

1008
00:38:53,930 --> 00:38:59,868
<font color="#E5E5E5">change the slides and say it may touch</font>

1009
00:38:55,430 --> 00:39:02,569
just excellent anyone got any more

1010
00:38:59,869 --> 00:39:04,519
questions<font color="#CCCCCC"> if not</font><font color="#E5E5E5"> we've</font><font color="#CCCCCC"> got the visa</font>

1011
00:39:02,569 --> 00:39:06,410
tweet<font color="#CCCCCC"> king of the</font><font color="#E5E5E5"> Internet</font>

1012
00:39:04,519 --> 00:39:10,220
<font color="#E5E5E5">Chris Boyd in here</font><font color="#CCCCCC"> next is a coffee</font>

1013
00:39:06,410 --> 00:39:12,100
<font color="#E5E5E5">break at</font><font color="#CCCCCC"> 11</font><font color="#E5E5E5"> o'clock so yep see you guys</font>

1014
00:39:10,220 --> 00:39:14,160
<font color="#E5E5E5">in a bit thanks a lot</font>

1015
00:39:12,100 --> 00:39:14,160
you

