1
00:00:03,060 --> 00:00:09,760
good morning and welcome<font color="#CCCCCC"> to cracking the</font>

2
00:00:07,149 --> 00:00:13,480
lens<font color="#E5E5E5"> exploiting</font><font color="#CCCCCC"> HTTPS hidden attack</font>

3
00:00:09,760 --> 00:00:14,338
surface can everyone hear me okay yep

4
00:00:13,480 --> 00:00:17,320
good good

5
00:00:14,339 --> 00:00:19,990
have you ever seen a tempting<font color="#E5E5E5"> target</font><font color="#CCCCCC"> but</font>

6
00:00:17,320 --> 00:00:23,650
had to ignore<font color="#E5E5E5"> it because it wasn't quite</font>

7
00:00:19,990 --> 00:00:25,479
within<font color="#E5E5E5"> the scope of</font><font color="#CCCCCC"> your test or</font><font color="#E5E5E5"> maybe</font>

8
00:00:23,650 --> 00:00:27,549
you've seen<font color="#E5E5E5"> something that</font><font color="#CCCCCC"> wasn't scoped</font>

9
00:00:25,480 --> 00:00:29,530
<font color="#E5E5E5">but it was just really quite boring</font>

10
00:00:27,550 --> 00:00:32,710
<font color="#E5E5E5">looking and not worth wasting much</font><font color="#CCCCCC"> time</font>

11
00:00:29,530 --> 00:00:34,960
on load<font color="#CCCCCC"> balances and analytic systems</font>

12
00:00:32,710 --> 00:00:37,870
are everywhere but they're just<font color="#CCCCCC"> not very</font>

13
00:00:34,960 --> 00:00:39,339
interesting they form a lens in<font color="#CCCCCC"> front of</font>

14
00:00:37,870 --> 00:00:43,269
websites<font color="#E5E5E5"> that we're used to looking</font>

15
00:00:39,339 --> 00:00:45,579
<font color="#CCCCCC">through</font><font color="#E5E5E5"> rather than</font><font color="#CCCCCC"> app</font><font color="#E5E5E5"> in this session</font>

16
00:00:43,269 --> 00:00:47,739
<font color="#E5E5E5">I'll share with you proven techniques to</font>

17
00:00:45,579 --> 00:00:49,839
hunt these systems down<font color="#E5E5E5"> crack them open</font>

18
00:00:47,739 --> 00:00:54,068
<font color="#E5E5E5">and</font><font color="#CCCCCC"> use them as gateways into</font><font color="#E5E5E5"> our</font>

19
00:00:49,839 --> 00:00:57,670
targets infrastructure some of these

20
00:00:54,069 --> 00:00:59,550
techniques involve requests so malformed

21
00:00:57,670 --> 00:01:02,350
that they break certain security tools

22
00:00:59,550 --> 00:01:05,560
and may exploit systems that you never

23
00:01:02,350 --> 00:01:07,000
<font color="#CCCCCC">even realized existed</font><font color="#E5E5E5"> like at the start</font>

24
00:01:05,560 --> 00:01:09,520
<font color="#CCCCCC">of</font><font color="#E5E5E5"> this research I wrote a simple</font>

25
00:01:07,000 --> 00:01:11,890
payload designed to make vulnerable

26
00:01:09,520 --> 00:01:13,509
servers<font color="#E5E5E5"> send a ping back to my server</font>

27
00:01:11,890 --> 00:01:15,490
<font color="#E5E5E5">and I sent this payload to a couple of</font>

28
00:01:13,509 --> 00:01:17,920
thousand sites<font color="#CCCCCC"> and got quite a few</font>

29
00:01:15,490 --> 00:01:19,990
pingbacks but there was something

30
00:01:17,920 --> 00:01:23,409
slightly<font color="#E5E5E5"> strange about a couple of them</font>

31
00:01:19,990 --> 00:01:25,780
<font color="#CCCCCC">I noticed when I sent a payload to</font><font color="#E5E5E5"> cloud</font>

32
00:01:23,409 --> 00:01:27,579
<font color="#CCCCCC">dámelo I got a ping back from the same</font>

33
00:01:25,780 --> 00:01:30,430
location<font color="#CCCCCC"> as when I send the payload to</font>

34
00:01:27,579 --> 00:01:34,359
<font color="#E5E5E5">Inga comm which are two quite different</font>

35
00:01:30,430 --> 00:01:35,979
sites and so I did a<font color="#CCCCCC"> reverse DNS lookup</font>

36
00:01:34,359 --> 00:01:37,350
on this IP address<font color="#CCCCCC"> and I found out it</font>

37
00:01:35,979 --> 00:01:39,548
<font color="#CCCCCC">was hoped in my own ISP</font>

38
00:01:37,350 --> 00:01:41,530
which is pretty strange<font color="#CCCCCC"> you wouldn't</font>

39
00:01:39,549 --> 00:01:46,240
think that a<font color="#E5E5E5"> Russian mail server would</font>

40
00:01:41,530 --> 00:01:48,670
<font color="#E5E5E5">be hosted on a UK ISP like BT and so I</font>

41
00:01:46,240 --> 00:01:51,520
took the<font color="#E5E5E5"> request that caused that ping</font>

42
00:01:48,670 --> 00:01:52,840
back and sent it to<font color="#CCCCCC"> the repeater</font><font color="#E5E5E5"> i</font><font color="#CCCCCC"> we</font>

43
00:01:51,520 --> 00:01:55,390
sent it a few<font color="#E5E5E5"> times and noticed</font>

44
00:01:52,840 --> 00:01:57,759
<font color="#CCCCCC">something else strange</font><font color="#E5E5E5"> the response was</font>

45
00:01:55,390 --> 00:02:01,030
coming back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> me in about 52</font>

46
00:01:57,759 --> 00:02:03,969
milliseconds which<font color="#CCCCCC"> is ridiculously fast</font>

47
00:02:01,030 --> 00:02:06,189
<font color="#E5E5E5">for a request that supposedly heading</font>

48
00:02:03,969 --> 00:02:07,658
from<font color="#E5E5E5"> me in England all the</font><font color="#CCCCCC"> way to the</font>

49
00:02:06,189 --> 00:02:09,609
server in Russia and<font color="#E5E5E5"> in all the way to</font>

50
00:02:07,659 --> 00:02:13,450
the ping back serve in Ireland<font color="#CCCCCC"> and then</font>

51
00:02:09,610 --> 00:02:16,300
<font color="#E5E5E5">all the way</font><font color="#CCCCCC"> back again</font><font color="#E5E5E5"> and so I did a</font>

52
00:02:13,450 --> 00:02:16,720
couple<font color="#E5E5E5"> of trace routes one simulating a</font>

53
00:02:16,300 --> 00:02:18,250
haste

54
00:02:16,720 --> 00:02:21,550
P connection that's the one<font color="#E5E5E5"> on the left</font>

55
00:02:18,250 --> 00:02:24,610
and one<font color="#E5E5E5"> simulating a HTTP</font><font color="#CCCCCC"> s connection</font>

56
00:02:21,550 --> 00:02:26,950
<font color="#CCCCCC">and as you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> see the one simulating an</font>

57
00:02:24,610 --> 00:02:29,140
unencrypted unauthenticated connection

58
00:02:26,950 --> 00:02:34,119
is getting terminated<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the middle of</font>

59
00:02:29,140 --> 00:02:37,059
BT's infrastructure<font color="#E5E5E5"> hi</font><font color="#CCCCCC"> bTW is pretending</font>

60
00:02:34,120 --> 00:02:38,740
to be<font color="#E5E5E5"> cloud</font><font color="#CCCCCC"> doc mailed on</font><font color="#E5E5E5"> me whereas the</font>

61
00:02:37,060 --> 00:02:42,910
<font color="#E5E5E5">encrypted connection goes all the way to</font>

62
00:02:38,740 --> 00:02:45,040
the<font color="#E5E5E5"> server's actual location and that is</font>

63
00:02:42,910 --> 00:02:46,930
really<font color="#E5E5E5"> quite suspicious</font><font color="#CCCCCC"> because it</font>

64
00:02:45,040 --> 00:02:49,150
implies<font color="#E5E5E5"> the the person doing this</font>

65
00:02:46,930 --> 00:02:51,760
interception<font color="#CCCCCC"> doesn't have</font><font color="#E5E5E5"> the authority</font>

66
00:02:49,150 --> 00:02:58,380
<font color="#CCCCCC">or the</font><font color="#E5E5E5"> keys to do so because if they did</font>

67
00:02:51,760 --> 00:03:00,510
they could intercept<font color="#CCCCCC"> HTTPS as well</font><font color="#E5E5E5"> so</font>

68
00:02:58,380 --> 00:03:03,459
<font color="#E5E5E5">also there</font><font color="#CCCCCC"> was something else suspicious</font>

69
00:03:00,510 --> 00:03:05,380
<font color="#CCCCCC">the host name of the server you seen</font><font color="#E5E5E5"> the</font>

70
00:03:03,459 --> 00:03:07,450
trace<font color="#CCCCCC"> view on the left</font><font color="#E5E5E5"> where the</font>

71
00:03:05,380 --> 00:03:10,680
connection is suspiciously terminated

72
00:03:07,450 --> 00:03:12,910
<font color="#E5E5E5">was predator dot alien</font><font color="#CCCCCC"> PT code at UK</font>

73
00:03:10,680 --> 00:03:13,770
which<font color="#E5E5E5"> you can probably agree is a little</font>

74
00:03:12,910 --> 00:03:17,859
bit<font color="#E5E5E5"> Shady</font>

75
00:03:13,770 --> 00:03:20,050
now<font color="#E5E5E5"> I investigated this further and I</font>

76
00:03:17,860 --> 00:03:22,269
found out what the true purpose<font color="#CCCCCC"> of this</font>

77
00:03:20,050 --> 00:03:24,640
system<font color="#E5E5E5"> was and I found out that I could</font>

78
00:03:22,269 --> 00:03:25,989
potentially<font color="#E5E5E5"> abuse the system to hijack a</font>

79
00:03:24,640 --> 00:03:28,988
decent portion<font color="#E5E5E5"> of the Internet traffic</font>

80
00:03:25,989 --> 00:03:31,090
<font color="#E5E5E5">of all</font><font color="#CCCCCC"> BT users which was</font><font color="#E5E5E5"> cool but</font>

81
00:03:28,989 --> 00:03:33,430
<font color="#E5E5E5">that's just a distraction from the</font>

82
00:03:31,090 --> 00:03:36,370
question that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> should be asking</font><font color="#E5E5E5"> which</font>

83
00:03:33,430 --> 00:03:38,680
<font color="#CCCCCC">is given that I and many</font><font color="#E5E5E5"> other English</font>

84
00:03:36,370 --> 00:03:40,720
<font color="#E5E5E5">pen testers have been testing through an</font>

85
00:03:38,680 --> 00:03:44,500
exploitable proxy system<font color="#E5E5E5"> like this</font><font color="#CCCCCC"> I</font>

86
00:03:40,720 --> 00:03:49,060
never<font color="#E5E5E5"> even realized that it existed what</font>

87
00:03:44,500 --> 00:03:51,790
else have we<font color="#E5E5E5"> missed so first I'll talk</font>

88
00:03:49,060 --> 00:03:53,890
<font color="#CCCCCC">about how</font><font color="#E5E5E5"> to build a speculative attack</font>

89
00:03:51,790 --> 00:03:56,200
pipeline to efficiently<font color="#E5E5E5"> hunt these</font>

90
00:03:53,890 --> 00:04:00,070
<font color="#CCCCCC">systems down and initiate a conversation</font>

91
00:03:56,200 --> 00:04:01,869
with them after that<font color="#E5E5E5"> I'll talk about two</font>

92
00:04:00,070 --> 00:04:04,480
key types of attacks on<font color="#CCCCCC"> these</font><font color="#E5E5E5"> systems</font>

93
00:04:01,870 --> 00:04:06,850
one focused on targeting<font color="#E5E5E5"> fun in system</font>

94
00:04:04,480 --> 00:04:09,548
by<font color="#E5E5E5"> making the</font><font color="#CCCCCC"> miss route requests to</font>

95
00:04:06,850 --> 00:04:11,470
give us<font color="#E5E5E5"> access to internal stuff that's</font>

96
00:04:09,549 --> 00:04:13,660
meant to<font color="#E5E5E5"> be private</font><font color="#CCCCCC"> and one focused on</font>

97
00:04:11,470 --> 00:04:15,090
exploiting<font color="#E5E5E5"> back-end systems where</font><font color="#CCCCCC"> we</font>

98
00:04:13,660 --> 00:04:17,738
have to<font color="#E5E5E5"> be a little bit more creative</font>

99
00:04:15,090 --> 00:04:19,988
<font color="#E5E5E5">after that I'll do a</font><font color="#CCCCCC"> brief demo of one</font>

100
00:04:17,738 --> 00:04:25,270
of the tools I'll<font color="#CCCCCC"> be releasing and then</font>

101
00:04:19,988 --> 00:04:27,219
I'll answer five minutes of<font color="#E5E5E5"> questions so</font>

102
00:04:25,270 --> 00:04:30,248
this systems that we're<font color="#E5E5E5"> going to be</font>

103
00:04:27,220 --> 00:04:33,219
<font color="#E5E5E5">targeting are designed to</font>

104
00:04:30,249 --> 00:04:35,729
<font color="#E5E5E5">mein invisible and as such the process</font>

105
00:04:33,219 --> 00:04:39,009
that we use<font color="#CCCCCC"> to</font><font color="#E5E5E5"> interact with them is</font>

106
00:04:35,729 --> 00:04:41,258
incredibly important for<font color="#E5E5E5"> the purpose of</font>

107
00:04:39,009 --> 00:04:42,789
this research<font color="#CCCCCC"> I found them by</font><font color="#E5E5E5"> sending</font>

108
00:04:41,259 --> 00:04:45,789
payloads designed to make them send a

109
00:04:42,789 --> 00:04:48,759
ping back to my system<font color="#CCCCCC"> I either</font><font color="#E5E5E5"> either a</font>

110
00:04:45,789 --> 00:04:51,998
DNS<font color="#E5E5E5"> request or HTTP request or hopefully</font>

111
00:04:48,759 --> 00:04:55,239
<font color="#E5E5E5">but this approach to finding</font>

112
00:04:51,999 --> 00:04:56,649
vulnerabilities by causing pingbacks<font color="#E5E5E5"> has</font>

113
00:04:55,239 --> 00:04:59,109
been so effective<font color="#CCCCCC"> in recent years that</font>

114
00:04:56,649 --> 00:05:02,349
<font color="#CCCCCC">my boss made up an acronym for it</font>

115
00:04:59,109 --> 00:05:03,938
<font color="#CCCCCC">uh-oh asked so if I say Oh aster I'm</font>

116
00:05:02,349 --> 00:05:06,099
talking<font color="#CCCCCC"> about trying</font><font color="#E5E5E5"> to find</font>

117
00:05:03,939 --> 00:05:08,919
vulnerabilities<font color="#CCCCCC"> by making vulnerable</font>

118
00:05:06,099 --> 00:05:13,509
systems<font color="#E5E5E5"> trigger pingbacks</font><font color="#CCCCCC"> two systems we</font>

119
00:05:08,919 --> 00:05:15,429
<font color="#CCCCCC">control at the start</font><font color="#E5E5E5"> of this research</font><font color="#CCCCCC"> I</font>

120
00:05:13,509 --> 00:05:18,339
had no idea<font color="#E5E5E5"> whether anything was</font>

121
00:05:15,429 --> 00:05:20,529
actually going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> work so I injected my</font>

122
00:05:18,339 --> 00:05:23,199
payloads<font color="#CCCCCC"> in the laziest way possible</font><font color="#E5E5E5"> I</font>

123
00:05:20,529 --> 00:05:25,089
simply used<font color="#CCCCCC"> the hard-coded Berk match in</font>

124
00:05:23,199 --> 00:05:27,549
the place rule<font color="#E5E5E5"> to inject a request a</font>

125
00:05:25,089 --> 00:05:29,409
payload<font color="#E5E5E5"> into every request that went</font>

126
00:05:27,549 --> 00:05:32,888
through the proxy and<font color="#E5E5E5"> then I just browse</font>

127
00:05:29,409 --> 00:05:35,379
<font color="#E5E5E5">some sites and I got me a lot of</font>

128
00:05:32,889 --> 00:05:36,849
pingbacks<font color="#E5E5E5"> but it didn't get me much</font>

129
00:05:35,379 --> 00:05:38,469
useful<font color="#E5E5E5"> information</font><font color="#CCCCCC"> because it was</font>

130
00:05:36,849 --> 00:05:39,069
incredibly<font color="#CCCCCC"> difficult to correlate the</font>

131
00:05:38,469 --> 00:05:43,209
pingbacks

132
00:05:39,069 --> 00:05:46,509
from the time I<font color="#CCCCCC"> wished it was</font><font color="#E5E5E5"> really</font>

133
00:05:43,209 --> 00:05:48,309
hard<font color="#CCCCCC"> to correlate</font><font color="#E5E5E5"> the requests with the</font>

134
00:05:46,509 --> 00:05:50,709
corresponding<font color="#CCCCCC"> pingbacks because they</font>

135
00:05:48,309 --> 00:05:53,499
didn't reliably occur at the same time

136
00:05:50,709 --> 00:05:55,719
for<font color="#CCCCCC"> example here we've got one system</font>

137
00:05:53,499 --> 00:05:57,849
<font color="#CCCCCC">that due to some payload that</font><font color="#E5E5E5"> I sent</font><font color="#CCCCCC"> to</font>

138
00:05:55,719 --> 00:06:00,639
some server<font color="#CCCCCC"> I don't I don't know which</font>

139
00:05:57,849 --> 00:06:02,709
server<font color="#E5E5E5"> it's decided to ping me every 24</font>

140
00:06:00,639 --> 00:06:04,689
hours<font color="#E5E5E5"> and it kept doing this for about</font>

141
00:06:02,709 --> 00:06:06,099
<font color="#E5E5E5">one week and I never figured</font><font color="#CCCCCC"> out what</font>

142
00:06:04,689 --> 00:06:08,769
<font color="#E5E5E5">the cause of this was and I haven't been</font>

143
00:06:06,099 --> 00:06:11,319
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to replicate it since so</font><font color="#CCCCCC"> this</font>

144
00:06:08,769 --> 00:06:12,579
<font color="#CCCCCC">strategy will get you</font><font color="#E5E5E5"> information it may</font>

145
00:06:11,319 --> 00:06:16,119
be entertaining<font color="#E5E5E5"> but it won't get you</font>

146
00:06:12,579 --> 00:06:18,339
<font color="#E5E5E5">much useful information</font><font color="#CCCCCC"> to resolve this</font>

147
00:06:16,119 --> 00:06:21,819
I wrote<font color="#CCCCCC"> collaborator everywhere</font><font color="#E5E5E5"> which is</font>

148
00:06:18,339 --> 00:06:24,489
an<font color="#CCCCCC"> open-source</font><font color="#E5E5E5"> extension for for burp</font>

149
00:06:21,819 --> 00:06:27,519
suite that injects<font color="#E5E5E5"> a unique payload into</font>

150
00:06:24,489 --> 00:06:29,619
every request and it uses<font color="#E5E5E5"> the uniqueness</font>

151
00:06:27,519 --> 00:06:32,499
<font color="#E5E5E5">to automatically correlate the payload</font>

152
00:06:29,619 --> 00:06:33,069
with the<font color="#E5E5E5"> pingback and using that</font>

153
00:06:32,499 --> 00:06:35,799
extension

154
00:06:33,069 --> 00:06:38,459
<font color="#CCCCCC">I got</font><font color="#E5E5E5"> roughly half of the bounties that</font>

155
00:06:35,799 --> 00:06:42,549
<font color="#E5E5E5">I'm going to mention in its presentation</font>

156
00:06:38,459 --> 00:06:45,009
<font color="#E5E5E5">however</font><font color="#CCCCCC"> I found one server</font><font color="#E5E5E5"> where</font>

157
00:06:42,550 --> 00:06:47,860
the<font color="#E5E5E5"> vulnerability was only being found</font>

158
00:06:45,009 --> 00:06:50,710
intermittently<font color="#E5E5E5"> and that was because this</font>

159
00:06:47,860 --> 00:06:52,629
target<font color="#CCCCCC"> was using round robin DNS</font><font color="#E5E5E5"> for</font>

160
00:06:50,710 --> 00:06:54,609
load<font color="#CCCCCC"> balancing</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> only one</font><font color="#E5E5E5"> of their</font>

161
00:06:52,629 --> 00:06:58,020
five front end servers was actually

162
00:06:54,610 --> 00:07:01,599
vulnerable<font color="#E5E5E5"> because</font><font color="#CCCCCC"> we're targeting</font>

163
00:06:58,020 --> 00:07:03,969
<font color="#CCCCCC">front-end</font><font color="#E5E5E5"> service</font><font color="#CCCCCC"> like load balancers we</font>

164
00:07:01,599 --> 00:07:05,949
need to be particularly aware<font color="#CCCCCC"> of that</font>

165
00:07:03,970 --> 00:07:08,530
<font color="#E5E5E5">kind of infrastructure level stuff and</font>

166
00:07:05,949 --> 00:07:10,509
as such<font color="#CCCCCC"> you really want to hit</font><font color="#E5E5E5"> every</font>

167
00:07:08,530 --> 00:07:13,359
<font color="#CCCCCC">single public facing IP that the target</font>

168
00:07:10,509 --> 00:07:15,159
has<font color="#E5E5E5"> to do that I started using</font><font color="#CCCCCC"> masscan</font>

169
00:07:13,360 --> 00:07:16,960
<font color="#E5E5E5">and</font><font color="#CCCCCC"> eventually switch to using zed grab</font>

170
00:07:15,159 --> 00:07:20,199
because it has more useful<font color="#E5E5E5"> features</font><font color="#CCCCCC"> for</font>

171
00:07:16,960 --> 00:07:21,758
web stuff<font color="#E5E5E5"> so if you want to do a focus</font>

172
00:07:20,199 --> 00:07:24,610
<font color="#CCCCCC">toward it on a</font><font color="#E5E5E5"> particular application</font>

173
00:07:21,759 --> 00:07:25,479
then a collaborator everywhere<font color="#E5E5E5"> is the</font>

174
00:07:24,610 --> 00:07:28,150
best tool for the job

175
00:07:25,479 --> 00:07:30,280
<font color="#CCCCCC">but if you want to spray payloads over a</font>

176
00:07:28,150 --> 00:07:34,900
huge amount of infrastructure<font color="#CCCCCC"> zed grab</font>

177
00:07:30,280 --> 00:07:37,119
is what<font color="#CCCCCC"> i</font><font color="#E5E5E5"> recommend who did i target for</font>

178
00:07:34,900 --> 00:07:38,770
the purpose<font color="#E5E5E5"> of this</font><font color="#CCCCCC"> research i just</font>

179
00:07:37,120 --> 00:07:42,039
targeted<font color="#E5E5E5"> everyone that i could legally</font>

180
00:07:38,770 --> 00:07:44,948
target<font color="#E5E5E5"> which means everyone who has a</font>

181
00:07:42,039 --> 00:07:47,620
bug<font color="#CCCCCC"> bounty program and to identify that</font>

182
00:07:44,949 --> 00:07:50,940
<font color="#E5E5E5">I manually reviewed every every bug</font>

183
00:07:47,620 --> 00:07:54,009
bounty profile on<font color="#CCCCCC"> hacker 1 and bug route</font>

184
00:07:50,940 --> 00:07:55,960
and made<font color="#CCCCCC"> sure that they didn't forbid</font>

185
00:07:54,009 --> 00:07:58,270
automated testing and use<font color="#E5E5E5"> that to</font><font color="#CCCCCC"> build</font>

186
00:07:55,960 --> 00:07:59,830
a spreadsheet<font color="#E5E5E5"> of domains that I could</font>

187
00:07:58,270 --> 00:08:01,389
target<font color="#E5E5E5"> which gave</font><font color="#CCCCCC"> me a regular</font>

188
00:07:59,830 --> 00:08:03,729
<font color="#CCCCCC">expression of</font><font color="#E5E5E5"> domains I could target</font>

189
00:08:01,389 --> 00:08:06,940
<font color="#E5E5E5">which I then ran against rapid</font><font color="#CCCCCC"> sevens</font>

190
00:08:03,729 --> 00:08:10,479
<font color="#CCCCCC">projects owner database which has a list</font>

191
00:08:06,940 --> 00:08:12,550
of every<font color="#CCCCCC"> known host name so without</font>

192
00:08:10,479 --> 00:08:14,919
sending any network traffic<font color="#CCCCCC"> I was able</font>

193
00:08:12,550 --> 00:08:18,400
<font color="#CCCCCC">to generate</font><font color="#E5E5E5"> a list of</font><font color="#CCCCCC"> 3 million</font><font color="#E5E5E5"> hosts</font>

194
00:08:14,919 --> 00:08:22,380
that<font color="#E5E5E5"> i could legally try and hack which</font>

195
00:08:18,400 --> 00:08:26,080
which contained<font color="#E5E5E5"> about 50,000 web servers</font>

196
00:08:22,380 --> 00:08:29,229
now<font color="#E5E5E5"> i initially also populated this list</font>

197
00:08:26,080 --> 00:08:31,539
of targets using<font color="#E5E5E5"> reverse dns but</font><font color="#CCCCCC"> i went</font>

198
00:08:29,229 --> 00:08:33,669
<font color="#E5E5E5">into a little bit of a problem</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> the</font>

199
00:08:31,539 --> 00:08:37,929
problem is<font color="#E5E5E5"> that google has got a bug</font>

200
00:08:33,669 --> 00:08:40,588
bounty<font color="#E5E5E5"> program and certain</font><font color="#CCCCCC"> web sites out</font>

201
00:08:37,929 --> 00:08:42,939
<font color="#CCCCCC">there</font><font color="#E5E5E5"> like to spoof google's reverse dns</font>

202
00:08:40,589 --> 00:08:44,770
which means that you will end up<font color="#E5E5E5"> packing</font>

203
00:08:42,940 --> 00:08:46,570
into<font color="#E5E5E5"> websites that have got nothing to</font>

204
00:08:44,770 --> 00:08:48,459
do with<font color="#CCCCCC"> google</font><font color="#E5E5E5"> whatsoever they don't</font>

205
00:08:46,570 --> 00:08:51,760
have a bug<font color="#CCCCCC"> bounty program they're just</font>

206
00:08:48,459 --> 00:08:53,319
claiming to be Google<font color="#E5E5E5"> which is not good</font>

207
00:08:51,760 --> 00:08:55,750
I<font color="#E5E5E5"> mean you could say that they're asking</font>

208
00:08:53,320 --> 00:08:56,320
<font color="#E5E5E5">for it but it's still not go down you're</font>

209
00:08:55,750 --> 00:09:03,460
definitely<font color="#E5E5E5"> not</font>

210
00:08:56,320 --> 00:09:05,260
gonna get paid for<font color="#CCCCCC"> it now if you're</font>

211
00:09:03,460 --> 00:09:07,540
gonna send a request to 50,000<font color="#E5E5E5"> service</font>

212
00:09:05,260 --> 00:09:10,240
<font color="#CCCCCC">right you</font><font color="#E5E5E5"> might as well make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> it's a</font>

213
00:09:07,540 --> 00:09:12,250
pretty nice it's a well optimized

214
00:09:10,240 --> 00:09:14,740
request<font color="#CCCCCC"> and you</font><font color="#E5E5E5"> want to hear as much</font>

215
00:09:12,250 --> 00:09:17,340
attack surface as possible<font color="#CCCCCC"> one way of</font>

216
00:09:14,740 --> 00:09:20,410
doing<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is using</font><font color="#E5E5E5"> the max</font><font color="#CCCCCC"> for words</font>

217
00:09:17,340 --> 00:09:22,810
header which can trick trick load

218
00:09:20,410 --> 00:09:24,520
balances into<font color="#E5E5E5"> saying thinking they can't</font>

219
00:09:22,810 --> 00:09:26,800
forward a request<font color="#CCCCCC"> and have to generate</font>

220
00:09:24,520 --> 00:09:29,189
<font color="#CCCCCC">her reply</font><font color="#E5E5E5"> immediately</font>

221
00:09:26,800 --> 00:09:31,740
another useful thing is the<font color="#CCCCCC"> no transform</font>

222
00:09:29,190 --> 00:09:34,330
directive<font color="#E5E5E5"> for the cache control header</font>

223
00:09:31,740 --> 00:09:37,360
this tells load balancers please don't

224
00:09:34,330 --> 00:09:40,360
rewrite this request<font color="#E5E5E5"> in any way before</font>

225
00:09:37,360 --> 00:09:42,460
you pass it down<font color="#E5E5E5"> the chain you can also</font>

226
00:09:40,360 --> 00:09:43,810
use exported<font color="#E5E5E5"> proto to pretend that</font>

227
00:09:42,460 --> 00:09:45,700
you're using a protocol<font color="#CCCCCC"> that you're not</font>

228
00:09:43,810 --> 00:09:47,079
<font color="#E5E5E5">really using which can also confuse</font>

229
00:09:45,700 --> 00:09:50,650
servers a bit and<font color="#E5E5E5"> just hit some</font>

230
00:09:47,080 --> 00:09:53,500
interesting pieces of attack surface the

231
00:09:50,650 --> 00:09:56,380
end result of this pipeline<font color="#E5E5E5"> is that</font>

232
00:09:53,500 --> 00:09:58,780
<font color="#CCCCCC">whenever I whenever I had an idea</font><font color="#E5E5E5"> during</font>

233
00:09:56,380 --> 00:10:01,600
this research I could<font color="#E5E5E5"> spend about 30</font>

234
00:09:58,780 --> 00:10:03,100
seconds manually writing a HTTP request

235
00:10:01,600 --> 00:10:06,490
<font color="#E5E5E5">and then in the space of five minutes</font>

236
00:10:03,100 --> 00:10:10,450
<font color="#CCCCCC">send that 50,000 web servers and get the</font>

237
00:10:06,490 --> 00:10:14,260
results that<font color="#CCCCCC"> capability to</font><font color="#E5E5E5"> quickly try</font>

238
00:10:10,450 --> 00:10:15,970
out ideas<font color="#CCCCCC"> and therefore</font><font color="#E5E5E5"> make make</font>

239
00:10:14,260 --> 00:10:18,160
iterative improvements to my payload is

240
00:10:15,970 --> 00:10:20,800
a large part<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> reason</font><font color="#CCCCCC"> that this</font>

241
00:10:18,160 --> 00:10:25,240
research was so<font color="#CCCCCC"> successful and aren't so</font>

242
00:10:20,800 --> 00:10:27,490
much money<font color="#E5E5E5"> so first of all we're going</font>

243
00:10:25,240 --> 00:10:29,740
to<font color="#E5E5E5"> look at targeting things like reverse</font>

244
00:10:27,490 --> 00:10:31,180
proxies<font color="#CCCCCC"> that sit in</font><font color="#E5E5E5"> front of web</font>

245
00:10:29,740 --> 00:10:32,860
applications and we're going<font color="#CCCCCC"> to trick</font>

246
00:10:31,180 --> 00:10:34,959
them into routing our requests to

247
00:10:32,860 --> 00:10:36,280
internal<font color="#E5E5E5"> websites that</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> not meant to</font>

248
00:10:34,960 --> 00:10:40,150
<font color="#CCCCCC">be private that are not meant to be</font>

249
00:10:36,280 --> 00:10:42,280
public<font color="#E5E5E5"> this is quite like if this</font><font color="#CCCCCC"> is a</font>

250
00:10:40,150 --> 00:10:44,709
type of server scientific<font color="#E5E5E5"> quest forgery</font>

251
00:10:42,280 --> 00:10:46,810
but<font color="#E5E5E5"> it's a lot more</font><font color="#CCCCCC"> powerful than</font><font color="#E5E5E5"> normal</font>

252
00:10:44,710 --> 00:10:48,220
<font color="#CCCCCC">server-side</font><font color="#E5E5E5"> request forgery quiz because</font>

253
00:10:46,810 --> 00:10:50,469
we have a lot of control over<font color="#CCCCCC"> the</font>

254
00:10:48,220 --> 00:10:53,290
<font color="#CCCCCC">requests that gets sent to the</font><font color="#E5E5E5"> internal</font>

255
00:10:50,470 --> 00:10:56,940
service and sometimes that comes<font color="#E5E5E5"> in</font>

256
00:10:53,290 --> 00:11:00,040
extremely<font color="#E5E5E5"> useful as we'll see shortly</font>

257
00:10:56,940 --> 00:11:01,720
the simplest technique to make a load

258
00:11:00,040 --> 00:11:03,790
balancer<font color="#E5E5E5"> send a request to the wrong</font>

259
00:11:01,720 --> 00:11:06,190
<font color="#CCCCCC">location is simply to change</font><font color="#E5E5E5"> the host</font>

260
00:11:03,790 --> 00:11:08,199
header to the location<font color="#E5E5E5"> that you want</font><font color="#CCCCCC"> the</font>

261
00:11:06,190 --> 00:11:10,420
request to<font color="#CCCCCC"> be sent</font><font color="#E5E5E5"> to this is</font>

262
00:11:08,200 --> 00:11:13,120
almost exploiting intended functionality

263
00:11:10,420 --> 00:11:15,540
and this technique has been<font color="#E5E5E5"> publicly</font>

264
00:11:13,120 --> 00:11:19,410
known in some small<font color="#E5E5E5"> circles for a while</font>

265
00:11:15,540 --> 00:11:21,640
<font color="#E5E5E5">but it's been hugely underappreciated</font><font color="#CCCCCC"> I</font>

266
00:11:19,410 --> 00:11:25,390
can say that with confidence<font color="#E5E5E5"> because</font>

267
00:11:21,640 --> 00:11:28,210
using<font color="#E5E5E5"> my</font><font color="#CCCCCC"> zero line with this one payload</font>

268
00:11:25,390 --> 00:11:31,330
<font color="#CCCCCC">I was able to exploit a huge number</font><font color="#E5E5E5"> of</font>

269
00:11:28,210 --> 00:11:35,170
servers<font color="#E5E5E5"> including but not limited to 27</font>

270
00:11:31,330 --> 00:11:37,540
<font color="#E5E5E5">US Department of Defense service Oh</font><font color="#CCCCCC"> -</font>

271
00:11:35,170 --> 00:11:39,670
Yahoo -<font color="#E5E5E5"> Yahoo load balancers in about</font>

272
00:11:37,540 --> 00:11:41,560
seven other weird<font color="#E5E5E5"> Yahoo servers that</font><font color="#CCCCCC"> I</font>

273
00:11:39,670 --> 00:11:44,370
didn't<font color="#E5E5E5"> figure out what it were for my</font>

274
00:11:41,560 --> 00:11:47,859
own ISP<font color="#CCCCCC"> by</font><font color="#E5E5E5"> accident as mentioned earlier</font>

275
00:11:44,370 --> 00:11:49,840
and<font color="#E5E5E5"> also a Colombian ISP thought through</font>

276
00:11:47,860 --> 00:11:51,580
itself into the firing<font color="#E5E5E5"> line by doing DNS</font>

277
00:11:49,840 --> 00:11:57,280
poisoning<font color="#E5E5E5"> to</font><font color="#CCCCCC"> impersonate one</font><font color="#E5E5E5"> of my</font>

278
00:11:51,580 --> 00:11:58,990
targets so when we've got this

279
00:11:57,280 --> 00:12:02,199
vulnerability<font color="#CCCCCC"> what can we do with it</font>

280
00:11:58,990 --> 00:12:04,660
well here as you<font color="#CCCCCC"> can see I found a</font><font color="#E5E5E5"> yahoo</font>

281
00:12:02,200 --> 00:12:07,030
load<font color="#CCCCCC"> Hey ahoo load balancer and</font><font color="#E5E5E5"> I'm</font>

282
00:12:04,660 --> 00:12:10,209
using it to route the request<font color="#E5E5E5"> to port</font>

283
00:12:07,030 --> 00:12:12,490
8080<font color="#CCCCCC"> - on a nearby IP so the service you</font>

284
00:12:10,210 --> 00:12:16,660
<font color="#E5E5E5">can see the sponding can't be</font><font color="#CCCCCC"> accessed</font>

285
00:12:12,490 --> 00:12:18,220
directly and as you can<font color="#E5E5E5"> see you've got</font>

286
00:12:16,660 --> 00:12:20,620
<font color="#CCCCCC">this repeater to unload command line</font>

287
00:12:18,220 --> 00:12:23,470
which suggests that<font color="#CCCCCC"> this is this</font><font color="#E5E5E5"> service</font>

288
00:12:20,620 --> 00:12:25,900
is<font color="#E5E5E5"> not speaking HTTP it's probably</font>

289
00:12:23,470 --> 00:12:27,700
interpreting every each of the HTTP

290
00:12:25,900 --> 00:12:30,610
headers that that it's receiving<font color="#E5E5E5"> as a</font>

291
00:12:27,700 --> 00:12:32,500
separate command<font color="#E5E5E5"> other</font><font color="#CCCCCC"> than</font><font color="#E5E5E5"> that at</font><font color="#CCCCCC"> this</font>

292
00:12:30,610 --> 00:12:38,950
<font color="#E5E5E5">point I had pretty much no idea what the</font>

293
00:12:32,500 --> 00:12:42,340
service was however<font color="#CCCCCC"> I had an idea I</font>

294
00:12:38,950 --> 00:12:45,730
thought<font color="#E5E5E5"> I know I'll</font><font color="#CCCCCC"> change the HTTP</font>

295
00:12:42,340 --> 00:12:47,170
<font color="#CCCCCC">method from get to help it's a bit of a</font>

296
00:12:45,730 --> 00:12:49,480
long<font color="#E5E5E5"> shot but</font><font color="#CCCCCC"> I've got</font><font color="#E5E5E5"> no</font><font color="#CCCCCC"> idea what I'm</font>

297
00:12:47,170 --> 00:12:52,990
<font color="#CCCCCC">doing so hey</font><font color="#E5E5E5"> and it actually worked</font>

298
00:12:49,480 --> 00:12:55,270
it<font color="#CCCCCC"> said hi</font><font color="#E5E5E5"> there I'm an Apache traffic</font>

299
00:12:52,990 --> 00:12:56,620
server<font color="#E5E5E5"> overseer which means I'm</font>

300
00:12:55,270 --> 00:12:59,410
<font color="#CCCCCC">responsible for</font><font color="#E5E5E5"> handling the</font>

301
00:12:56,620 --> 00:13:02,110
configuration<font color="#CCCCCC"> of probably</font><font color="#E5E5E5"> a large number</font>

302
00:12:59,410 --> 00:13:03,459
of Yahoo's load balancers<font color="#E5E5E5"> also this is</font>

303
00:13:02,110 --> 00:13:06,060
how you can change configuration

304
00:13:03,460 --> 00:13:06,060
settings on me

305
00:13:06,860 --> 00:13:12,780
so now know that if<font color="#E5E5E5"> this was normal</font>

306
00:13:10,260 --> 00:13:15,780
<font color="#E5E5E5">server site request forgery</font><font color="#CCCCCC"> thought I'd</font>

307
00:13:12,780 --> 00:13:18,420
found<font color="#E5E5E5"> I wouldn't actually be able to get</font>

308
00:13:15,780 --> 00:13:20,459
and set variables on this server<font color="#E5E5E5"> because</font>

309
00:13:18,420 --> 00:13:21,959
the<font color="#E5E5E5"> syntax requires a space which</font><font color="#CCCCCC"> you</font>

310
00:13:20,460 --> 00:13:23,730
can't get with normal service<font color="#CCCCCC"> five</font>

311
00:13:21,960 --> 00:13:26,280
request forgery<font color="#E5E5E5"> but because this is</font><font color="#CCCCCC"> not</font>

312
00:13:23,730 --> 00:13:29,400
<font color="#E5E5E5">that setting variables and getting them</font>

313
00:13:26,280 --> 00:13:31,290
is actually<font color="#E5E5E5"> quite easy</font><font color="#CCCCCC"> so here we can</font>

314
00:13:29,400 --> 00:13:34,650
<font color="#E5E5E5">see I've fetched the value of proxy</font>

315
00:13:31,290 --> 00:13:39,060
conflict on email<font color="#E5E5E5"> and it's set to nobody</font>

316
00:13:34,650 --> 00:13:42,120
at Yahoo<font color="#E5E5E5"> Inc</font><font color="#CCCCCC"> com great using the ability</font>

317
00:13:39,060 --> 00:13:45,510
to set variables one thing<font color="#E5E5E5"> that I could</font>

318
00:13:42,120 --> 00:13:48,150
do was whitelist my own IP to give it

319
00:13:45,510 --> 00:13:50,850
the permission<font color="#E5E5E5"> to push items into all</font><font color="#CCCCCC"> of</font>

320
00:13:48,150 --> 00:13:52,620
Yahoo's<font color="#CCCCCC"> load balance caches which could</font>

321
00:13:50,850 --> 00:13:55,670
get me quite a lot of defacements<font color="#E5E5E5"> on</font>

322
00:13:52,620 --> 00:13:57,780
quite a few<font color="#CCCCCC"> yahoo</font><font color="#E5E5E5"> websites potentially</font>

323
00:13:55,670 --> 00:14:00,660
something else that<font color="#E5E5E5"> I could do that</font>

324
00:13:57,780 --> 00:14:03,500
<font color="#E5E5E5">would be even</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> fun</font><font color="#CCCCCC"> is in is enable</font>

325
00:14:00,660 --> 00:14:06,300
<font color="#E5E5E5">Sox</font><font color="#CCCCCC"> foxing on all of their load balances</font>

326
00:14:03,500 --> 00:14:08,880
the only issue<font color="#E5E5E5"> with that is that that</font>

327
00:14:06,300 --> 00:14:10,380
<font color="#E5E5E5">wouldn't be limited to my utter my IP so</font>

328
00:14:08,880 --> 00:14:12,060
effectively pretty much everyone would

329
00:14:10,380 --> 00:14:14,040
<font color="#E5E5E5">have access to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> Yahoo's internal</font>

330
00:14:12,060 --> 00:14:17,939
network<font color="#CCCCCC"> so will</font><font color="#E5E5E5"> probably get shot down</font>

331
00:14:14,040 --> 00:14:20,579
<font color="#E5E5E5">quite fast</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> I Eve aborted that to</font>

332
00:14:17,940 --> 00:14:22,320
Yahoo and got<font color="#E5E5E5"> fifteen thousand dollar</font>

333
00:14:20,580 --> 00:14:25,380
bounty for<font color="#E5E5E5"> it so that was cool and I</font>

334
00:14:22,320 --> 00:14:27,560
found<font color="#E5E5E5"> that issue using</font><font color="#CCCCCC"> collaborate</font>

335
00:14:25,380 --> 00:14:30,420
everywhere and they fix that pretty<font color="#E5E5E5"> fast</font>

336
00:14:27,560 --> 00:14:31,920
<font color="#CCCCCC">but a couple of</font><font color="#E5E5E5"> weeks later my pipeline</font>

337
00:14:30,420 --> 00:14:34,140
found a different server<font color="#E5E5E5"> that had the</font>

338
00:14:31,920 --> 00:14:35,939
same vulnerability<font color="#E5E5E5"> getting me another</font>

339
00:14:34,140 --> 00:14:37,890
<font color="#E5E5E5">five thousand for a total of twenty</font>

340
00:14:35,940 --> 00:14:46,830
thousand which was<font color="#E5E5E5"> really solid start to</font>

341
00:14:37,890 --> 00:14:51,120
this research<font color="#CCCCCC"> now as</font><font color="#E5E5E5"> mentioned the same</font>

342
00:14:46,830 --> 00:14:52,260
technique<font color="#E5E5E5"> also worked on my</font><font color="#CCCCCC"> ISP and it</font>

343
00:14:51,120 --> 00:14:54,810
could<font color="#E5E5E5"> be used to access</font><font color="#CCCCCC"> the</font>

344
00:14:52,260 --> 00:14:56,100
administration<font color="#E5E5E5"> panel for the pool of</font>

345
00:14:54,810 --> 00:14:58,680
proxies<font color="#CCCCCC"> that they were routing traffic</font>

346
00:14:56,100 --> 00:15:02,400
<font color="#CCCCCC">through but they don't have a bug bounty</font>

347
00:14:58,680 --> 00:15:06,030
program so<font color="#E5E5E5"> I didn't attempt to actually</font>

348
00:15:02,400 --> 00:15:07,439
<font color="#E5E5E5">break into this administration panel</font><font color="#CCCCCC"> but</font>

349
00:15:06,030 --> 00:15:09,810
what I did<font color="#E5E5E5"> want to know is what the</font>

350
00:15:07,440 --> 00:15:11,460
point<font color="#E5E5E5"> of this of this industry</font><font color="#CCCCCC"> of this</font>

351
00:15:09,810 --> 00:15:14,219
<font color="#E5E5E5">interception was and to do that I did a</font>

352
00:15:11,460 --> 00:15:15,990
trace through of the whole ipv4 space to

353
00:15:14,220 --> 00:15:19,279
work out which IPS they were targeting

354
00:15:15,990 --> 00:15:22,579
and that showed me<font color="#E5E5E5"> the rough</font>

355
00:15:19,279 --> 00:15:24,560
<font color="#E5E5E5">five</font><font color="#CCCCCC"> percent of website</font><font color="#E5E5E5"> IPS were on the</font>

356
00:15:22,579 --> 00:15:27,319
blacklist which<font color="#E5E5E5"> could</font><font color="#CCCCCC"> which meant all</font>

357
00:15:24,560 --> 00:15:30,560
<font color="#CCCCCC">traffic to them to TCP</font><font color="#E5E5E5"> port 80 was being</font>

358
00:15:27,319 --> 00:15:33,410
routed into<font color="#E5E5E5"> these proxies</font><font color="#CCCCCC"> and that</font>

359
00:15:30,560 --> 00:15:35,628
affected<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> a large number of</font><font color="#E5E5E5"> sites an</font>

360
00:15:33,410 --> 00:15:37,610
interesting side effect of<font color="#E5E5E5"> that is that</font>

361
00:15:35,629 --> 00:15:39,290
if your if your website<font color="#CCCCCC"> so IP is</font>

362
00:15:37,610 --> 00:15:42,740
blacklisted<font color="#CCCCCC"> for example just because</font>

363
00:15:39,290 --> 00:15:44,689
you're using cloud hosting then all<font color="#E5E5E5"> BT</font>

364
00:15:42,740 --> 00:15:47,749
traffic appears<font color="#E5E5E5"> to come</font><font color="#CCCCCC"> from a pool of</font>

365
00:15:44,689 --> 00:15:50,089
about<font color="#E5E5E5"> five different IPS so if you're</font>

366
00:15:47,749 --> 00:15:52,550
doing any based<font color="#E5E5E5"> any IP based access</font>

367
00:15:50,089 --> 00:15:54,350
control or you blacklist any of those

368
00:15:52,550 --> 00:15:58,540
<font color="#CCCCCC">IPS then</font><font color="#E5E5E5"> you might actually blacklist</font>

369
00:15:54,350 --> 00:16:01,699
most of the UK<font color="#CCCCCC"> so be</font><font color="#E5E5E5"> careful</font><font color="#CCCCCC"> about that</font>

370
00:15:58,540 --> 00:16:05,599
<font color="#E5E5E5">looking at what these IPS hosted I found</font>

371
00:16:01,699 --> 00:16:08,870
that I found<font color="#E5E5E5"> this behavior</font><font color="#CCCCCC"> if you try</font>

372
00:16:05,600 --> 00:16:10,639
and<font color="#E5E5E5"> access one</font><font color="#CCCCCC"> of these IPS</font><font color="#E5E5E5"> with a host</font>

373
00:16:08,870 --> 00:16:12,139
header which<font color="#E5E5E5"> they blacklisted then you</font>

374
00:16:10,639 --> 00:16:14,629
get this message<font color="#E5E5E5"> which I'm sure none</font><font color="#CCCCCC"> of</font>

375
00:16:12,139 --> 00:16:16,399
you've ever<font color="#E5E5E5"> seen before</font><font color="#CCCCCC"> which says</font>

376
00:16:14,629 --> 00:16:18,170
access<font color="#E5E5E5"> to the websites</font><font color="#CCCCCC"> listed on this</font>

377
00:16:16,399 --> 00:16:20,329
page has been blocked pursuant to orders

378
00:16:18,170 --> 00:16:23,029
of the High Court<font color="#E5E5E5"> ie as copyrighted</font>

379
00:16:20,329 --> 00:16:25,128
content on there<font color="#CCCCCC"> although I of course</font>

380
00:16:23,029 --> 00:16:28,490
it's pretty<font color="#E5E5E5"> easy to bypass that sort of</font>

381
00:16:25,129 --> 00:16:30,529
<font color="#E5E5E5">thing now so it seemed like the purpose</font>

382
00:16:28,490 --> 00:16:34,490
of this system<font color="#E5E5E5"> was just for copyright</font>

383
00:16:30,529 --> 00:16:36,199
enforcement<font color="#E5E5E5"> but when I reported this</font>

384
00:16:34,490 --> 00:16:39,529
issue to<font color="#E5E5E5"> BT I actually learned a</font><font color="#CCCCCC"> little</font>

385
00:16:36,199 --> 00:16:42,469
<font color="#CCCCCC">bit of backstory</font><font color="#E5E5E5"> this system was</font>

386
00:16:39,529 --> 00:16:44,600
originally<font color="#E5E5E5"> built as part of the as part</font>

387
00:16:42,470 --> 00:16:46,550
<font color="#CCCCCC">of the clean feed government initiative</font>

388
00:16:44,600 --> 00:16:49,069
to block<font color="#E5E5E5"> access to images of child abuse</font>

389
00:16:46,550 --> 00:16:51,500
<font color="#E5E5E5">it's just that as soon as it was built</font>

390
00:16:49,069 --> 00:16:56,300
they couldn't argue that it shouldn't<font color="#E5E5E5"> be</font>

391
00:16:51,500 --> 00:16:58,069
repurposed<font color="#E5E5E5"> to</font><font color="#CCCCCC"> block copyright abuse as I</font>

392
00:16:56,300 --> 00:17:01,040
mentioned I also exploited<font color="#E5E5E5"> a Colombian</font>

393
00:16:58,069 --> 00:17:03,589
ISP so here this happened after<font color="#CCCCCC"> the BT</font>

394
00:17:01,040 --> 00:17:05,230
incident<font color="#E5E5E5"> so it took me much less time to</font>

395
00:17:03,589 --> 00:17:08,390
figure<font color="#E5E5E5"> out what on earth was going on</font>

396
00:17:05,230 --> 00:17:10,309
here I<font color="#E5E5E5"> try to send a payload to a</font>

397
00:17:08,390 --> 00:17:13,549
different Russian<font color="#CCCCCC"> web site and I got a</font>

398
00:17:10,309 --> 00:17:16,609
ping back<font color="#E5E5E5"> funk Columbia and I knew that</font>

399
00:17:13,549 --> 00:17:18,829
<font color="#E5E5E5">had to</font><font color="#CCCCCC"> be done by DNS poisoning and I</font>

400
00:17:16,609 --> 00:17:21,678
was using<font color="#E5E5E5"> rapid</font><font color="#CCCCCC"> Evans</font><font color="#E5E5E5"> DNS database</font><font color="#CCCCCC"> so I</font>

401
00:17:18,829 --> 00:17:25,760
contacted rapid7<font color="#E5E5E5"> and they found the</font>

402
00:17:21,679 --> 00:17:28,850
responsible DNS server which is there so

403
00:17:25,760 --> 00:17:31,100
that<font color="#CCCCCC"> server if you try and access a</font>

404
00:17:28,850 --> 00:17:32,840
blacklisted<font color="#CCCCCC"> hostname will will</font><font color="#E5E5E5"> route you</font>

405
00:17:31,100 --> 00:17:34,969
through its proxy both of these<font color="#E5E5E5"> systems</font>

406
00:17:32,840 --> 00:17:38,209
<font color="#CCCCCC">a live at the moment</font><font color="#E5E5E5"> you can take a look</font>

407
00:17:34,970 --> 00:17:40,429
at them if you like this system<font color="#E5E5E5"> seemed</font>

408
00:17:38,210 --> 00:17:42,590
to be targeting image hosts and social

409
00:17:40,429 --> 00:17:45,679
networks<font color="#E5E5E5"> and once again it would block</font>

410
00:17:42,590 --> 00:17:47,658
access<font color="#CCCCCC"> to these and say you can't access</font>

411
00:17:45,679 --> 00:17:50,210
<font color="#E5E5E5">this because it may host images of child</font>

412
00:17:47,659 --> 00:17:52,960
<font color="#E5E5E5">abuse</font><font color="#CCCCCC"> and it would</font><font color="#E5E5E5"> have this</font><font color="#CCCCCC"> logo but</font>

413
00:17:50,210 --> 00:17:55,549
that's not all<font color="#E5E5E5"> this</font><font color="#CCCCCC"> system was for</font>

414
00:17:52,960 --> 00:17:58,580
because they were<font color="#CCCCCC"> also poisoning the</font><font color="#E5E5E5"> DNS</font>

415
00:17:55,549 --> 00:18:01,760
<font color="#E5E5E5">for BBC</font><font color="#CCCCCC"> decoder UK and all of his</font>

416
00:17:58,580 --> 00:18:04,520
subdomains<font color="#E5E5E5"> unfortunately I wasn't able</font>

417
00:18:01,760 --> 00:18:06,289
to<font color="#E5E5E5"> figure out why they were doing</font><font color="#CCCCCC"> this I</font>

418
00:18:04,520 --> 00:18:08,870
<font color="#E5E5E5">think they're probably targeting</font>

419
00:18:06,289 --> 00:18:10,460
specific articles on there and perhaps

420
00:18:08,870 --> 00:18:13,639
changing the content or it's<font color="#E5E5E5"> blocking</font>

421
00:18:10,460 --> 00:18:15,220
access to<font color="#E5E5E5"> them but I wasn't able to find</font>

422
00:18:13,640 --> 00:18:18,350
<font color="#E5E5E5">out which articles they were targeting</font>

423
00:18:15,220 --> 00:18:19,940
also maybe<font color="#E5E5E5"> they're not altering any</font>

424
00:18:18,350 --> 00:18:26,480
content and they're just interested in

425
00:18:19,940 --> 00:18:29,029
<font color="#CCCCCC">knowing what you're reading now thinking</font>

426
00:18:26,480 --> 00:18:31,070
that<font color="#E5E5E5"> the paler of thinking that you know</font>

427
00:18:29,029 --> 00:18:34,100
what's gonna happen<font color="#CCCCCC"> when you send one of</font>

428
00:18:31,070 --> 00:18:37,639
these<font color="#E5E5E5"> payloads is always a mistake</font><font color="#CCCCCC"> so</font>

429
00:18:34,100 --> 00:18:40,070
for<font color="#E5E5E5"> example I found 17 Yahoo servers</font>

430
00:18:37,640 --> 00:18:42,409
with the following<font color="#CCCCCC"> behavior</font><font color="#E5E5E5"> when I send</font>

431
00:18:40,070 --> 00:18:44,840
<font color="#E5E5E5">the payload like this they do miss</font>

432
00:18:42,409 --> 00:18:47,029
through the<font color="#E5E5E5"> request but they lose the</font>

433
00:18:44,840 --> 00:18:49,279
request to outage<font color="#CCCCCC"> doc the supplied</font>

434
00:18:47,029 --> 00:18:53,419
<font color="#CCCCCC">hostname</font><font color="#E5E5E5"> and they also put the</font><font color="#CCCCCC"> hostname</font>

435
00:18:49,279 --> 00:18:56,330
<font color="#E5E5E5">in the path twice I've got no idea what</font>

436
00:18:53,419 --> 00:19:00,350
the<font color="#CCCCCC"> cause of</font><font color="#E5E5E5"> a is but my job is only to</font>

437
00:18:56,330 --> 00:19:02,270
<font color="#E5E5E5">exploit it luckily now here as it is</font>

438
00:19:00,350 --> 00:19:04,699
presented<font color="#E5E5E5"> there that's not much use</font>

439
00:19:02,270 --> 00:19:06,710
because for<font color="#CCCCCC"> server-side request forgery</font>

440
00:19:04,700 --> 00:19:09,980
because<font color="#E5E5E5"> you're limited to hitting a</font><font color="#CCCCCC"> very</font>

441
00:19:06,710 --> 00:19:11,870
<font color="#CCCCCC">specific path fortunately this service</font>

442
00:19:09,980 --> 00:19:13,520
was incredibly tolerant about<font color="#E5E5E5"> what</font>

443
00:19:11,870 --> 00:19:16,340
characters you<font color="#E5E5E5"> could put in the host</font>

444
00:19:13,520 --> 00:19:18,860
<font color="#E5E5E5">header so you could put a directory</font>

445
00:19:16,340 --> 00:19:21,320
traversal sequence in the host<font color="#E5E5E5"> header</font>

446
00:19:18,860 --> 00:19:23,678
<font color="#CCCCCC">and that would</font><font color="#E5E5E5"> result in the</font><font color="#CCCCCC"> requests</font>

447
00:19:21,320 --> 00:19:26,510
<font color="#E5E5E5">that you see on on the right which</font>

448
00:19:23,679 --> 00:19:28,970
<font color="#CCCCCC">normalize us into a request to</font><font color="#E5E5E5"> the web</font>

449
00:19:26,510 --> 00:19:30,020
loop which<font color="#E5E5E5"> means it is useful so have a</font>

450
00:19:28,970 --> 00:19:32,210
site request forgery

451
00:19:30,020 --> 00:19:36,918
so I reported<font color="#CCCCCC"> that to Yahoo</font><font color="#E5E5E5"> and got</font>

452
00:19:32,210 --> 00:19:38,539
<font color="#CCCCCC">5,000 for that</font><font color="#E5E5E5"> now the key thing</font><font color="#CCCCCC"> to know</font>

453
00:19:36,919 --> 00:19:40,850
<font color="#E5E5E5">here</font><font color="#CCCCCC"> is that</font><font color="#E5E5E5"> if you didn't have wildcard</font>

454
00:19:38,539 --> 00:19:41,750
DNS setup on your<font color="#E5E5E5"> ping back server you</font>

455
00:19:40,850 --> 00:19:44,139
would<font color="#E5E5E5"> have just missed this issue</font>

456
00:19:41,750 --> 00:19:44,140
entirely

457
00:19:46,970 --> 00:19:52,530
now this payload<font color="#E5E5E5"> we finally</font><font color="#CCCCCC"> on to some</font>

458
00:19:50,130 --> 00:19:56,310
<font color="#E5E5E5">different payloads might look familiar</font>

459
00:19:52,530 --> 00:19:57,570
I used<font color="#E5E5E5"> it back in 2013</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> poison</font>

460
00:19:56,310 --> 00:19:59,820
<font color="#E5E5E5">Django's Password Reset</font>

461
00:19:57,570 --> 00:20:01,439
emails featured<font color="#E5E5E5"> in my first ever</font>

462
00:19:59,820 --> 00:20:04,620
<font color="#E5E5E5">presentation here</font>

463
00:20:01,440 --> 00:20:07,740
<font color="#CCCCCC">but</font><font color="#E5E5E5"> why found here</font><font color="#CCCCCC"> was a particular</font><font color="#E5E5E5"> US</font>

464
00:20:04,620 --> 00:20:09,090
military server which looks at the<font color="#E5E5E5"> host</font>

465
00:20:07,740 --> 00:20:11,070
header and it<font color="#CCCCCC"> whitelisted</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> hosts</font>

466
00:20:09,090 --> 00:20:13,620
<font color="#CCCCCC">setter</font><font color="#E5E5E5"> but it</font><font color="#CCCCCC"> routed the request to</font>

467
00:20:11,070 --> 00:20:15,350
whatever was spent and specified in the

468
00:20:13,620 --> 00:20:17,939
top line which I had control<font color="#E5E5E5"> over</font>

469
00:20:15,350 --> 00:20:20,189
however<font color="#E5E5E5"> I had a little bit of a problem</font>

470
00:20:17,940 --> 00:20:22,440
<font color="#E5E5E5">when I found this</font><font color="#CCCCCC"> I wanted</font><font color="#E5E5E5"> to prove I</font>

471
00:20:20,190 --> 00:20:24,290
could access<font color="#CCCCCC"> an internal service</font><font color="#E5E5E5"> to</font>

472
00:20:22,440 --> 00:20:27,150
prove this that<font color="#E5E5E5"> this was a serious issue</font>

473
00:20:24,290 --> 00:20:28,710
but I<font color="#E5E5E5"> just been told off by Yahoo for</font>

474
00:20:27,150 --> 00:20:32,030
doing an internal port scan of their

475
00:20:28,710 --> 00:20:33,990
network<font color="#E5E5E5"> and i was</font><font color="#CCCCCC"> a bit twitchy</font><font color="#E5E5E5"> about</font>

476
00:20:32,030 --> 00:20:36,450
<font color="#E5E5E5">doing the same thing on a US military</font>

477
00:20:33,990 --> 00:20:37,830
<font color="#E5E5E5">network especially</font><font color="#CCCCCC"> when</font><font color="#E5E5E5"> i was about</font><font color="#CCCCCC"> to</font>

478
00:20:36,450 --> 00:20:42,690
catch<font color="#E5E5E5"> a flight to</font><font color="#CCCCCC"> the USA to give a</font>

479
00:20:37,830 --> 00:20:45,510
presentation<font color="#CCCCCC"> so instead of doing a poor</font>

480
00:20:42,690 --> 00:20:48,000
scan<font color="#CCCCCC"> i googled a bit and</font><font color="#E5E5E5"> i found an</font>

481
00:20:45,510 --> 00:20:50,100
amazing forum post<font color="#E5E5E5"> on defense of</font><font color="#CCCCCC"> CARICOM</font>

482
00:20:48,000 --> 00:20:51,870
it says if<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> looking at this and</font>

483
00:20:50,100 --> 00:20:53,520
<font color="#E5E5E5">not on the military or DoD this won't</font>

484
00:20:51,870 --> 00:20:55,260
mean<font color="#CCCCCC"> anything to you nor</font><font color="#E5E5E5"> will you be</font>

485
00:20:53,520 --> 00:20:57,180
<font color="#E5E5E5">able to access it</font><font color="#CCCCCC"> and then it listed a</font>

486
00:20:55,260 --> 00:20:59,250
couple<font color="#CCCCCC"> of internal military websites</font>

487
00:20:57,180 --> 00:21:01,710
<font color="#E5E5E5">which I could</font><font color="#CCCCCC"> access using</font><font color="#E5E5E5"> this</font>

488
00:20:59,250 --> 00:21:04,410
<font color="#E5E5E5">vulnerability so that meant that without</font>

489
00:21:01,710 --> 00:21:06,720
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> doing any I have any internal</font>

490
00:21:04,410 --> 00:21:09,210
scanning I<font color="#CCCCCC"> prove the</font><font color="#E5E5E5"> severity of this</font>

491
00:21:06,720 --> 00:21:11,760
issue<font color="#E5E5E5"> my advice</font><font color="#CCCCCC"> is if you don't need</font><font color="#E5E5E5"> to</font>

492
00:21:09,210 --> 00:21:14,670
do an internal port scan especially with

493
00:21:11,760 --> 00:21:18,060
<font color="#E5E5E5">the bug bounty I don't bother it's just</font>

494
00:21:14,670 --> 00:21:19,560
cleaner if you don't do<font color="#E5E5E5"> that</font><font color="#CCCCCC"> or also</font><font color="#E5E5E5"> the</font>

495
00:21:18,060 --> 00:21:21,060
larger the target<font color="#CCCCCC"> company they're less</font>

496
00:21:19,560 --> 00:21:23,220
likely is that you<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> need to</font>

497
00:21:21,060 --> 00:21:27,629
because there's more people<font color="#E5E5E5"> posting</font>

498
00:21:23,220 --> 00:21:28,050
stuff on random internet forums<font color="#CCCCCC"> okay now</font>

499
00:21:27,630 --> 00:21:29,790
<font color="#CCCCCC">Oh</font>

500
00:21:28,050 --> 00:21:31,290
although the network diagram that I

501
00:21:29,790 --> 00:21:33,930
<font color="#CCCCCC">showed for</font><font color="#E5E5E5"> the section only</font><font color="#CCCCCC"> showed one</font>

502
00:21:31,290 --> 00:21:36,240
proxy server<font color="#E5E5E5"> it's possible to have</font>

503
00:21:33,930 --> 00:21:37,950
<font color="#E5E5E5">chains of proxies and if you want to</font>

504
00:21:36,240 --> 00:21:40,500
exploit a proxy in the middle of a chain

505
00:21:37,950 --> 00:21:41,970
that<font color="#E5E5E5"> can make life difficult because the</font>

506
00:21:40,500 --> 00:21:45,270
proxy at the start of<font color="#CCCCCC"> the chain might</font>

507
00:21:41,970 --> 00:21:48,030
just<font color="#CCCCCC"> chuck out your request for example</font>

508
00:21:45,270 --> 00:21:49,710
in<font color="#E5E5E5"> caps</font><font color="#CCCCCC"> Allah</font><font color="#E5E5E5"> use the host header to</font>

509
00:21:48,030 --> 00:21:51,990
work out which of the ex-fiancé<font color="#CCCCCC"> to</font><font color="#E5E5E5"> vote</font>

510
00:21:49,710 --> 00:21:53,700
<font color="#E5E5E5">to route requests to so if you change</font>

511
00:21:51,990 --> 00:21:55,140
the<font color="#E5E5E5"> host header as per the normal</font>

512
00:21:53,700 --> 00:21:57,240
<font color="#CCCCCC">attacked</font><font color="#E5E5E5"> like I've done here</font><font color="#CCCCCC"> you'll just</font>

513
00:21:55,140 --> 00:21:59,659
<font color="#CCCCCC">get a response</font><font color="#E5E5E5"> that says unrecognized</font>

514
00:21:57,240 --> 00:22:01,860
<font color="#E5E5E5">host or something like that</font>

515
00:21:59,659 --> 00:22:04,409
however I found that<font color="#E5E5E5"> they're quite</font>

516
00:22:01,860 --> 00:22:07,709
<font color="#E5E5E5">tolerant about what they allow in the</font>

517
00:22:04,409 --> 00:22:10,159
<font color="#E5E5E5">port of the Hostetter so if you send the</font>

518
00:22:07,710 --> 00:22:14,640
following<font color="#CCCCCC"> requests</font><font color="#E5E5E5"> they will route that</font>

519
00:22:10,159 --> 00:22:17,070
to the to the correct client<font color="#E5E5E5"> because</font>

520
00:22:14,640 --> 00:22:20,190
they basically<font color="#E5E5E5"> ignore everything after</font>

521
00:22:17,070 --> 00:22:22,049
the<font color="#CCCCCC"> colon however the backend one</font>

522
00:22:20,190 --> 00:22:25,049
specific back-end that<font color="#CCCCCC"> I found that was</font>

523
00:22:22,049 --> 00:22:27,389
<font color="#E5E5E5">using in</font><font color="#CCCCCC"> caps Allah use this host</font><font color="#E5E5E5"> center</font>

524
00:22:25,049 --> 00:22:29,929
to build a URL<font color="#E5E5E5"> and if you put the host</font>

525
00:22:27,390 --> 00:22:33,360
<font color="#E5E5E5">header in a URL the URL looks like that</font>

526
00:22:29,929 --> 00:22:35,820
<font color="#E5E5E5">and it gets interpreted by the client as</font>

527
00:22:33,360 --> 00:22:39,000
a<font color="#CCCCCC"> username and password or</font>

528
00:22:35,820 --> 00:22:42,000
<font color="#E5E5E5">authentication attempt to a host name of</font>

529
00:22:39,000 --> 00:22:43,530
my choice<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that gave me server side</font>

530
00:22:42,000 --> 00:22:47,159
request forgery<font color="#E5E5E5"> on that in capsule of</font>

531
00:22:43,530 --> 00:22:48,780
client<font color="#E5E5E5"> and it also revealed the</font><font color="#CCCCCC"> location</font>

532
00:22:47,159 --> 00:22:51,210
of their back-end server meaning<font color="#E5E5E5"> that I</font>

533
00:22:48,780 --> 00:22:54,990
could<font color="#E5E5E5"> talk to</font><font color="#CCCCCC"> it directly and bypass in</font>

534
00:22:51,210 --> 00:22:56,460
capsular entirely<font color="#E5E5E5"> encapsulated fixed</font>

535
00:22:54,990 --> 00:22:59,340
this<font color="#E5E5E5"> since I</font><font color="#CCCCCC"> gave the presentation in</font>

536
00:22:56,460 --> 00:23:01,260
<font color="#E5E5E5">blackhat a couple of weeks ago</font><font color="#CCCCCC"> but I'm</font>

537
00:22:59,340 --> 00:23:05,879
sure<font color="#E5E5E5"> this technique works on plenty of</font>

538
00:23:01,260 --> 00:23:08,280
<font color="#E5E5E5">other servers these vulnerabilities</font>

539
00:23:05,880 --> 00:23:11,429
<font color="#E5E5E5">aren't just caused by poor</font>

540
00:23:08,280 --> 00:23:14,280
configurations what we've<font color="#E5E5E5"> got here is</font>

541
00:23:11,429 --> 00:23:17,070
some code that<font color="#E5E5E5"> the new</font><font color="#CCCCCC"> velak was running</font>

542
00:23:14,280 --> 00:23:21,658
<font color="#E5E5E5">or on their main live</font><font color="#CCCCCC"> web site on their</font>

543
00:23:17,070 --> 00:23:22,678
load balancer<font color="#CCCCCC"> and it looks absolutely</font>

544
00:23:21,659 --> 00:23:25,620
fine

545
00:23:22,679 --> 00:23:28,590
they take the user supplied<font color="#CCCCCC"> gyro</font><font color="#E5E5E5"> and</font>

546
00:23:25,620 --> 00:23:31,889
they overwrite the host portion of that

547
00:23:28,590 --> 00:23:33,510
<font color="#CCCCCC">Yogo</font><font color="#E5E5E5"> to to the</font><font color="#CCCCCC"> hard-coded</font><font color="#E5E5E5"> value pointing</font>

548
00:23:31,890 --> 00:23:37,250
<font color="#E5E5E5">to their</font><font color="#CCCCCC"> back-end server and and they</font>

549
00:23:33,510 --> 00:23:40,320
for the request<font color="#E5E5E5"> it seems fine</font><font color="#CCCCCC"> but</font>

550
00:23:37,250 --> 00:23:43,890
<font color="#CCCCCC">unfortunately for them they were using</font>

551
00:23:40,320 --> 00:23:46,918
the server component<font color="#CCCCCC"> apache HTTP</font>

552
00:23:43,890 --> 00:23:49,380
components and that library<font color="#E5E5E5"> failed to</font>

553
00:23:46,919 --> 00:23:52,289
require<font color="#CCCCCC"> that the path of the HTTP</font>

554
00:23:49,380 --> 00:23:55,169
<font color="#E5E5E5">request starts with a forward</font><font color="#CCCCCC"> slash so</font>

555
00:23:52,289 --> 00:23:58,530
that meant if I send a malformed<font color="#E5E5E5"> illegal</font>

556
00:23:55,169 --> 00:24:02,429
HTTP request like this<font color="#CCCCCC"> then they rewrite</font>

557
00:23:58,530 --> 00:24:04,168
it like<font color="#CCCCCC"> that and they try to log on to</font>

558
00:24:02,429 --> 00:24:05,340
<font color="#CCCCCC">my server with the username of</font><font color="#E5E5E5"> the</font>

559
00:24:04,169 --> 00:24:08,760
server that<font color="#E5E5E5"> they were actually</font><font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to</font>

560
00:24:05,340 --> 00:24:12,100
connect<font color="#E5E5E5"> to so that gave me access</font><font color="#CCCCCC"> to new</font>

561
00:24:08,760 --> 00:24:14,919
<font color="#CCCCCC">Alex internal network which</font>

562
00:24:12,100 --> 00:24:17,620
some amazing<font color="#CCCCCC"> stuff on it</font><font color="#E5E5E5"> it had some</font>

563
00:24:14,919 --> 00:24:19,780
awesome<font color="#CCCCCC"> developing</font><font color="#E5E5E5"> jokes this was</font>

564
00:24:17,620 --> 00:24:21,399
playing<font color="#E5E5E5"> music and everything</font><font color="#CCCCCC"> and they</font>

565
00:24:19,780 --> 00:24:24,120
also had<font color="#CCCCCC"> some administration</font><font color="#E5E5E5"> panels that</font>

566
00:24:21,400 --> 00:24:25,720
had no authentication<font color="#E5E5E5"> on them whatsoever</font>

567
00:24:24,120 --> 00:24:28,418
<font color="#E5E5E5">so that was cool</font>

568
00:24:25,720 --> 00:24:31,720
now unfortunately New Relic don't have a

569
00:24:28,419 --> 00:24:33,280
don't pay cash bounties<font color="#CCCCCC"> but to their</font>

570
00:24:31,720 --> 00:24:35,380
<font color="#CCCCCC">credit they did</font><font color="#E5E5E5"> patch this issue</font><font color="#CCCCCC"> very</font>

571
00:24:33,280 --> 00:24:38,220
<font color="#CCCCCC">quickly on a public holiday</font><font color="#E5E5E5"> and they</font>

572
00:24:35,380 --> 00:24:40,660
also reported<font color="#E5E5E5"> this issue back</font><font color="#CCCCCC"> to apache</font>

573
00:24:38,220 --> 00:24:43,480
HTTP components where it's now been

574
00:24:40,660 --> 00:24:45,340
<font color="#CCCCCC">fixed</font><font color="#E5E5E5"> so if if you're using that library</font>

575
00:24:43,480 --> 00:24:48,539
you don't need to panic<font color="#E5E5E5"> as long as</font>

576
00:24:45,340 --> 00:24:50,709
you've kept it<font color="#E5E5E5"> fully up to</font><font color="#CCCCCC"> date</font>

577
00:24:48,539 --> 00:24:53,110
<font color="#CCCCCC">fortunately for me this technique also</font>

578
00:24:50,710 --> 00:24:54,659
worked on seven different<font color="#E5E5E5"> Yahoo servers</font>

579
00:24:53,110 --> 00:24:58,689
<font color="#E5E5E5">earning me another eight thousand</font>

580
00:24:54,659 --> 00:25:00,100
dollars for<font color="#E5E5E5"> a total of</font><font color="#CCCCCC"> thirty three</font>

581
00:24:58,690 --> 00:25:03,909
<font color="#CCCCCC">thousand which</font><font color="#E5E5E5"> is the full amount</font><font color="#CCCCCC"> that I</font>

582
00:25:00,100 --> 00:25:05,889
earned during this research<font color="#CCCCCC"> now you</font>

583
00:25:03,909 --> 00:25:08,559
might be<font color="#E5E5E5"> wondering what happened</font><font color="#CCCCCC"> to that</font>

584
00:25:05,890 --> 00:25:11,710
money<font color="#CCCCCC"> so the deal that I had with my</font>

585
00:25:08,559 --> 00:25:13,330
<font color="#E5E5E5">company was that with any bounties</font><font color="#CCCCCC"> that</font>

586
00:25:11,710 --> 00:25:17,460
I earned by accident during<font color="#E5E5E5"> the course</font>

587
00:25:13,330 --> 00:25:17,460
of<font color="#E5E5E5"> my</font><font color="#CCCCCC"> research would get spent on beer</font>

588
00:25:18,750 --> 00:25:24,309
<font color="#CCCCCC">unfortunately uh these bounties raised a</font>

589
00:25:21,610 --> 00:25:26,260
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of a</font><font color="#E5E5E5"> challenge so we decided</font>

590
00:25:24,309 --> 00:25:30,370
to<font color="#E5E5E5"> give the majority</font><font color="#CCCCCC"> to charity and</font>

591
00:25:26,260 --> 00:25:32,860
<font color="#E5E5E5">spend a small amount</font><font color="#CCCCCC"> on beer instead</font><font color="#E5E5E5"> now</font>

592
00:25:30,370 --> 00:25:36,570
the strangest behavior that I saw<font color="#CCCCCC"> I</font>

593
00:25:32,860 --> 00:25:39,549
<font color="#E5E5E5">turned this research was courtesy of a</font>

594
00:25:36,570 --> 00:25:41,710
whistleblowing website called called

595
00:25:39,549 --> 00:25:43,690
<font color="#CCCCCC">globalinx now this is a bit like</font>

596
00:25:41,710 --> 00:25:49,179
<font color="#E5E5E5">WikiLeaks except it's actually</font>

597
00:25:43,690 --> 00:25:52,090
<font color="#CCCCCC">legitimate and and here when</font><font color="#E5E5E5"> I send the</font>

598
00:25:49,179 --> 00:25:53,860
following<font color="#CCCCCC"> request</font><font color="#E5E5E5"> which is malformed</font>

599
00:25:52,090 --> 00:25:57,789
because it does not start with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> forward</font>

600
00:25:53,860 --> 00:26:00,639
<font color="#CCCCCC">slash I received about fifteen DNS</font>

601
00:25:57,789 --> 00:26:03,390
requests to my server<font color="#E5E5E5"> all in mixed case</font>

602
00:26:00,640 --> 00:26:05,980
or coming from<font color="#E5E5E5"> different IP addresses</font><font color="#CCCCCC"> Oh</font>

603
00:26:03,390 --> 00:26:08,530
which was pretty puzzling<font color="#CCCCCC"> I mean what</font>

604
00:26:05,980 --> 00:26:12,600
would cause<font color="#E5E5E5"> that eventually due to the</font>

605
00:26:08,530 --> 00:26:15,820
nature<font color="#CCCCCC"> of the website I had an idea</font>

606
00:26:12,600 --> 00:26:17,740
which<font color="#CCCCCC"> is because this is a</font>

607
00:26:15,820 --> 00:26:19,750
whistleblowing website they want to hide

608
00:26:17,740 --> 00:26:22,450
the physical location of<font color="#CCCCCC"> the back-end</font>

609
00:26:19,750 --> 00:26:24,419
server to protect it to protect<font color="#E5E5E5"> it</font><font color="#CCCCCC"> from</font>

610
00:26:22,450 --> 00:26:25,539
government raids<font color="#E5E5E5"> and that kind of stuff</font>

611
00:26:24,419 --> 00:26:28,570
<font color="#CCCCCC">so</font>

612
00:26:25,539 --> 00:26:31,658
actually the<font color="#E5E5E5"> back end is accessed</font><font color="#CCCCCC"> by the</font>

613
00:26:28,570 --> 00:26:33,279
front end as a tor<font color="#CCCCCC"> hidden service so</font>

614
00:26:31,659 --> 00:26:37,869
I've got a<font color="#E5E5E5"> server side request forgery</font>

615
00:26:33,279 --> 00:26:39,669
through tor which raises some quite

616
00:26:37,869 --> 00:26:41,918
interesting challenges when<font color="#CCCCCC"> it comes to</font>

617
00:26:39,669 --> 00:26:44,499
<font color="#CCCCCC">expert exploitation because</font><font color="#E5E5E5"> my request</font>

618
00:26:41,919 --> 00:26:47,279
being sent food tour<font color="#CCCCCC"> I don't actually</font>

619
00:26:44,499 --> 00:26:50,440
<font color="#E5E5E5">have access to any internal services</font>

620
00:26:47,279 --> 00:26:53,409
what I can do though is if I've got an

621
00:26:50,440 --> 00:26:55,539
exploit<font color="#E5E5E5"> for the tour client then I can</font>

622
00:26:53,409 --> 00:26:57,609
make them connect to my server and then

623
00:26:55,539 --> 00:27:00,309
gain control of<font color="#E5E5E5"> their</font><font color="#CCCCCC"> front-end through</font>

624
00:26:57,609 --> 00:27:02,559
that and<font color="#CCCCCC"> also because it's a</font>

625
00:27:00,309 --> 00:27:04,359
whistleblowing site<font color="#E5E5E5"> and it's using tor</font><font color="#CCCCCC"> I</font>

626
00:27:02,559 --> 00:27:06,639
could<font color="#CCCCCC"> potentially use it to quite</font>

627
00:27:04,359 --> 00:27:09,009
heavily obfuscate<font color="#E5E5E5"> an attack on someone</font>

628
00:27:06,639 --> 00:27:11,709
that<font color="#CCCCCC"> I didn't like</font><font color="#E5E5E5"> because even if they</font>

629
00:27:09,009 --> 00:27:13,419
were to<font color="#E5E5E5"> trace the attack through tor the</font>

630
00:27:11,710 --> 00:27:16,450
trail would end at a<font color="#CCCCCC"> whistleblowing</font>

631
00:27:13,419 --> 00:27:22,320
<font color="#CCCCCC">website which</font><font color="#E5E5E5"> is probably guilty</font><font color="#CCCCCC"> it's oh</font>

632
00:27:16,450 --> 00:27:22,320
right yeah that's<font color="#E5E5E5"> now be fixed oh okay</font>

633
00:27:24,840 --> 00:27:30,879
<font color="#CCCCCC">so</font><font color="#E5E5E5"> now we're gonna look at exploiting</font>

634
00:27:28,440 --> 00:27:34,200
helper systems which are generally

635
00:27:30,879 --> 00:27:38,769
located more or less<font color="#E5E5E5"> behind the server</font>

636
00:27:34,200 --> 00:27:40,570
behind application now here<font color="#CCCCCC"> unlike that</font>

637
00:27:38,769 --> 00:27:42,340
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the previous section making</font><font color="#E5E5E5"> these</font>

638
00:27:40,570 --> 00:27:44,769
systems<font color="#E5E5E5"> cause a ping back is actually</font>

639
00:27:42,340 --> 00:27:46,928
<font color="#E5E5E5">really easy</font><font color="#CCCCCC"> generally and the hard part</font>

640
00:27:44,769 --> 00:27:48,549
is<font color="#CCCCCC"> actually exploiting that for</font>

641
00:27:46,929 --> 00:27:50,019
<font color="#E5E5E5">something useful the main thing that</font>

642
00:27:48,549 --> 00:27:51,549
<font color="#E5E5E5">makes exploiting these systems</font><font color="#CCCCCC"> so</font>

643
00:27:50,019 --> 00:27:53,799
difficult<font color="#E5E5E5"> is that when we get a</font>

644
00:27:51,549 --> 00:27:56,320
<font color="#CCCCCC">server-side</font><font color="#E5E5E5"> request forgery it's blind</font>

645
00:27:53,799 --> 00:27:58,539
<font color="#CCCCCC">server side request forgery meaning that</font>

646
00:27:56,320 --> 00:28:01,269
we can't read<font color="#E5E5E5"> the response from the</font>

647
00:27:58,539 --> 00:28:04,779
internal services and we can't adapt our

648
00:28:01,269 --> 00:28:08,019
attack<font color="#E5E5E5"> based on</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> we're seeing</font><font color="#CCCCCC"> so we</font>

649
00:28:04,779 --> 00:28:10,269
<font color="#E5E5E5">have to be a bit more creative this</font>

650
00:28:08,019 --> 00:28:12,519
section<font color="#E5E5E5"> of the research was sparked by</font><font color="#CCCCCC"> a</font>

651
00:28:10,269 --> 00:28:14,349
really<font color="#E5E5E5"> old looking website that</font>

652
00:28:12,519 --> 00:28:16,779
contained a really exciting sentence<font color="#E5E5E5"> it</font>

653
00:28:14,349 --> 00:28:18,759
said the<font color="#CCCCCC"> ex rap flow file header should</font>

654
00:28:16,779 --> 00:28:20,830
contain a URL pointing to an<font color="#E5E5E5"> XML</font>

655
00:28:18,759 --> 00:28:23,889
document<font color="#CCCCCC"> specifying the features of</font><font color="#E5E5E5"> a</font>

656
00:28:20,830 --> 00:28:26,889
<font color="#E5E5E5">mobile device</font><font color="#CCCCCC"> so you</font><font color="#E5E5E5"> can access any</font>

657
00:28:23,889 --> 00:28:29,258
<font color="#E5E5E5">website and you can specify a URL in</font>

658
00:28:26,889 --> 00:28:31,988
this HTTP header<font color="#CCCCCC"> and they will in theory</font>

659
00:28:29,259 --> 00:28:34,239
fetch that euro and then pause<font color="#CCCCCC"> the</font>

660
00:28:31,989 --> 00:28:37,090
result as XML so we've got two<font color="#CCCCCC"> really</font>

661
00:28:34,239 --> 00:28:38,710
dangerous pieces of<font color="#E5E5E5"> behavior there</font><font color="#CCCCCC"> and</font>

662
00:28:37,090 --> 00:28:39,419
when I found<font color="#CCCCCC"> this I got</font><font color="#E5E5E5"> very</font><font color="#CCCCCC"> excited and</font>

663
00:28:38,710 --> 00:28:42,870
<font color="#E5E5E5">immediately</font>

664
00:28:39,420 --> 00:28:46,410
all of my targets<font color="#CCCCCC"> and within a couple of</font>

665
00:28:42,870 --> 00:28:49,290
hours<font color="#E5E5E5"> I'd got exactly no pingbacks</font><font color="#CCCCCC"> so I</font>

666
00:28:46,410 --> 00:28:51,900
was<font color="#CCCCCC"> very sad and I tweeted it and then</font>

667
00:28:49,290 --> 00:28:55,409
about<font color="#E5E5E5"> 20 hours later I got a ping back</font>

668
00:28:51,900 --> 00:28:58,980
from<font color="#E5E5E5"> Facebook so Facebook does support</font>

669
00:28:55,410 --> 00:29:02,100
<font color="#E5E5E5">this header but they fetch it about 26</font>

670
00:28:58,980 --> 00:29:05,220
<font color="#CCCCCC">hours after you use this header</font>

671
00:29:02,100 --> 00:29:08,310
fortunately for<font color="#E5E5E5"> Facebook</font><font color="#CCCCCC"> there X there</font>

672
00:29:05,220 --> 00:29:11,420
set up<font color="#CCCCCC"> their their XML parsing seems to</font>

673
00:29:08,310 --> 00:29:13,409
be fairly solid so I<font color="#E5E5E5"> wasn't able to</font>

674
00:29:11,420 --> 00:29:16,440
exploit it but the<font color="#E5E5E5"> fact that there's a</font>

675
00:29:13,410 --> 00:29:18,750
26 hour gap<font color="#E5E5E5"> in between trying each</font><font color="#CCCCCC"> stack</font>

676
00:29:16,440 --> 00:29:19,950
and getting the result made it<font color="#E5E5E5"> quite</font>

677
00:29:18,750 --> 00:29:21,540
awkward so maybe I missed something

678
00:29:19,950 --> 00:29:25,920
<font color="#E5E5E5">maybe you can exploit them and get a</font>

679
00:29:21,540 --> 00:29:27,810
decent bounty for<font color="#E5E5E5"> it fortunately there</font>

680
00:29:25,920 --> 00:29:30,870
<font color="#E5E5E5">are many other useful headers out there</font>

681
00:29:27,810 --> 00:29:33,960
that are widely<font color="#E5E5E5"> supported the most</font>

682
00:29:30,870 --> 00:29:36,330
commonly<font color="#E5E5E5"> supported useful header for</font>

683
00:29:33,960 --> 00:29:38,970
causing pingbacks<font color="#E5E5E5"> is the referer header</font>

684
00:29:36,330 --> 00:29:41,879
<font color="#E5E5E5">this really surprised</font><font color="#CCCCCC"> me a shocking</font>

685
00:29:38,970 --> 00:29:45,020
number of websites will fetch whatever

686
00:29:41,880 --> 00:29:47,550
<font color="#CCCCCC">URL you specify in the referer header I</font>

687
00:29:45,020 --> 00:29:52,860
think they must<font color="#E5E5E5"> be doing this some kind</font>

688
00:29:47,550 --> 00:29:54,330
<font color="#E5E5E5">of analytics or SEO purposes but yeah</font>

689
00:29:52,860 --> 00:29:56,000
that works on the shocking number of

690
00:29:54,330 --> 00:29:59,040
sites as I'll<font color="#CCCCCC"> show</font><font color="#E5E5E5"> you shortly</font>

691
00:29:56,000 --> 00:30:00,720
also the<font color="#CCCCCC"> x-forwarded-for header I'm sure</font>

692
00:29:59,040 --> 00:30:03,090
you're<font color="#E5E5E5"> familiar with using</font><font color="#CCCCCC"> this to spoof</font>

693
00:30:00,720 --> 00:30:04,890
your your<font color="#E5E5E5"> your IP address</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can also</font>

694
00:30:03,090 --> 00:30:06,629
put a domain name<font color="#E5E5E5"> in there and then if</font>

695
00:30:04,890 --> 00:30:08,940
they resolve that in that domain<font color="#CCCCCC"> name</font>

696
00:30:06,630 --> 00:30:11,490
<font color="#E5E5E5">that</font><font color="#CCCCCC"> will cause a ping back to your</font>

697
00:30:08,940 --> 00:30:13,230
server<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that tells you they are using</font>

698
00:30:11,490 --> 00:30:14,400
this header they trust this header and

699
00:30:13,230 --> 00:30:16,080
therefore it means maybe it's worthwhile

700
00:30:14,400 --> 00:30:20,070
spending<font color="#CCCCCC"> more time trying</font>

701
00:30:16,080 --> 00:30:21,810
<font color="#E5E5E5">I'd be spoofing attacks and similarly</font>

702
00:30:20,070 --> 00:30:23,730
<font color="#CCCCCC">that also</font><font color="#E5E5E5"> works for the</font><font color="#CCCCCC"> true client</font><font color="#E5E5E5"> IP</font>

703
00:30:21,810 --> 00:30:26,520
header and the<font color="#CCCCCC"> ex</font><font color="#E5E5E5"> VIP header which in</font>

704
00:30:23,730 --> 00:30:30,500
which are less<font color="#CCCCCC"> well-known but there's no</font>

705
00:30:26,520 --> 00:30:34,560
cost to adding extra headers<font color="#E5E5E5"> basically</font>

706
00:30:30,500 --> 00:30:37,230
also I found<font color="#CCCCCC"> in capsula for some reason</font>

707
00:30:34,560 --> 00:30:40,590
if you specify a parameter<font color="#E5E5E5"> with the same</font>

708
00:30:37,230 --> 00:30:43,020
name twice with the<font color="#E5E5E5"> same value then they</font>

709
00:30:40,590 --> 00:30:44,669
fetch that with the HTTP request<font color="#CCCCCC"> I've</font>

710
00:30:43,020 --> 00:30:46,650
got no idea<font color="#E5E5E5"> why they do it and</font><font color="#CCCCCC"> I only</font>

711
00:30:44,670 --> 00:30:48,720
found<font color="#CCCCCC"> it because a bug in my code</font><font color="#E5E5E5"> led</font>

712
00:30:46,650 --> 00:30:51,960
that<font color="#CCCCCC"> led to</font><font color="#E5E5E5"> parameters being specified</font>

713
00:30:48,720 --> 00:30:57,120
twice<font color="#E5E5E5"> but there you have it</font>

714
00:30:51,960 --> 00:30:59,760
okay so we've<font color="#CCCCCC"> got someone connecting</font><font color="#E5E5E5"> to</font>

715
00:30:57,120 --> 00:31:02,159
the<font color="#E5E5E5"> euro that we specify in them</font><font color="#CCCCCC"> afirma</font>

716
00:30:59,760 --> 00:31:04,440
header<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> well one thing</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font>

717
00:31:02,160 --> 00:31:07,050
can try<font color="#CCCCCC"> and do is trick</font><font color="#E5E5E5"> their client</font>

718
00:31:04,440 --> 00:31:10,770
into handing<font color="#CCCCCC"> UPS some credentials</font><font color="#E5E5E5"> to our</font>

719
00:31:07,050 --> 00:31:13,860
server<font color="#CCCCCC"> I</font><font color="#E5E5E5"> try this technique and it</font>

720
00:31:10,770 --> 00:31:15,480
didn't<font color="#CCCCCC"> work on any</font><font color="#E5E5E5"> of my targets but</font>

721
00:31:13,860 --> 00:31:17,490
<font color="#E5E5E5">while I was</font><font color="#CCCCCC"> trying it some random</font>

722
00:31:15,480 --> 00:31:19,290
vulnerability scanner<font color="#E5E5E5"> happened to hit my</font>

723
00:31:17,490 --> 00:31:22,380
server and<font color="#E5E5E5"> did get exploited by it and</font>

724
00:31:19,290 --> 00:31:26,190
hand<font color="#E5E5E5"> over its credentials</font><font color="#CCCCCC"> so I still</font>

725
00:31:22,380 --> 00:31:29,730
<font color="#E5E5E5">count that as a as a win also you can</font>

726
00:31:26,190 --> 00:31:31,080
try the client-side heartbleed<font color="#CCCCCC"> you can</font>

727
00:31:29,730 --> 00:31:34,410
you can try the client heartbeat

728
00:31:31,080 --> 00:31:36,480
attack<font color="#CCCCCC"> which did work on one of my</font>

729
00:31:34,410 --> 00:31:38,400
targets<font color="#E5E5E5"> so I was able</font><font color="#CCCCCC"> to take blind</font>

730
00:31:36,480 --> 00:31:40,200
server side request forgery<font color="#E5E5E5"> and use that</font>

731
00:31:38,400 --> 00:31:43,710
to read memory<font color="#E5E5E5"> from the vulnerable</font>

732
00:31:40,200 --> 00:31:46,290
<font color="#CCCCCC">server you can</font><font color="#E5E5E5"> also use various other</font>

733
00:31:43,710 --> 00:31:48,150
<font color="#E5E5E5">off the shelf tools to get more of a</font>

734
00:31:46,290 --> 00:31:50,430
feeling<font color="#E5E5E5"> for what the target is</font><font color="#CCCCCC"> actually</font>

735
00:31:48,150 --> 00:31:52,230
running<font color="#E5E5E5"> and what are they and what</font><font color="#CCCCCC"> are</font>

736
00:31:50,430 --> 00:31:54,330
<font color="#E5E5E5">the exploits you might be able</font><font color="#CCCCCC"> to do but</font>

737
00:31:52,230 --> 00:31:57,600
<font color="#CCCCCC">off-the-shelf</font><font color="#E5E5E5"> exploits are kind of</font>

738
00:31:54,330 --> 00:32:00,360
boring<font color="#CCCCCC"> what else can</font><font color="#E5E5E5"> we do well one</font>

739
00:31:57,600 --> 00:32:02,840
thing we<font color="#E5E5E5"> can do is use more</font><font color="#CCCCCC"> OS so we</font>

740
00:32:00,360 --> 00:32:06,149
found this behavior<font color="#E5E5E5"> using the</font><font color="#CCCCCC"> pingback</font>

741
00:32:02,840 --> 00:32:07,919
technique but we can also then<font color="#E5E5E5"> take say</font>

742
00:32:06,150 --> 00:32:10,350
the latest<font color="#E5E5E5"> struts</font><font color="#CCCCCC"> to remote code</font>

743
00:32:07,920 --> 00:32:12,840
execution of the week and use that to

744
00:32:10,350 --> 00:32:14,939
make<font color="#CCCCCC"> a payload that</font><font color="#E5E5E5"> makes vulnerable</font>

745
00:32:12,840 --> 00:32:16,709
service<font color="#E5E5E5"> send I think that to us</font><font color="#CCCCCC"> so then</font>

746
00:32:14,940 --> 00:32:19,170
<font color="#E5E5E5">we can make this</font><font color="#CCCCCC"> thing that's crawling</font>

747
00:32:16,710 --> 00:32:23,010
<font color="#E5E5E5">the referer header and tell that to</font>

748
00:32:19,170 --> 00:32:25,980
spray our payload<font color="#E5E5E5"> for struts across its</font>

749
00:32:23,010 --> 00:32:29,879
internal network<font color="#CCCCCC"> and</font><font color="#E5E5E5"> maybe find some</font>

750
00:32:25,980 --> 00:32:32,070
<font color="#E5E5E5">shots also some of these things that</font>

751
00:32:29,880 --> 00:32:35,190
<font color="#E5E5E5">fetch the referer header render the</font>

752
00:32:32,070 --> 00:32:36,270
<font color="#CCCCCC">webpage</font><font color="#E5E5E5"> that they visit as and they they</font>

753
00:32:35,190 --> 00:32:38,610
<font color="#E5E5E5">rendered the</font><font color="#CCCCCC"> page in a browser</font>

754
00:32:36,270 --> 00:32:41,280
environment<font color="#CCCCCC"> they even execute</font><font color="#E5E5E5"> JavaScript</font>

755
00:32:38,610 --> 00:32:43,350
<font color="#E5E5E5">on that page and</font><font color="#CCCCCC"> that means</font><font color="#E5E5E5"> that we can</font>

756
00:32:41,280 --> 00:32:45,899
<font color="#E5E5E5">make them spray cross-site scripting</font>

757
00:32:43,350 --> 00:32:48,990
payloads<font color="#E5E5E5"> across their own intranet and</font>

758
00:32:45,900 --> 00:32:50,610
<font color="#E5E5E5">if they find a vulnerability we can</font>

759
00:32:48,990 --> 00:32:53,100
inject a beef hook and effectively gain

760
00:32:50,610 --> 00:32:54,600
full access to<font color="#E5E5E5"> that internal site</font><font color="#CCCCCC"> I</font>

761
00:32:53,100 --> 00:32:57,800
think<font color="#CCCCCC"> the correct technical name for</font>

762
00:32:54,600 --> 00:33:01,740
<font color="#E5E5E5">this is blind reflected server-side XSS</font>

763
00:32:57,800 --> 00:33:05,100
<font color="#E5E5E5">also depending on how they limit cross</font>

764
00:33:01,740 --> 00:33:05,380
protocol<font color="#E5E5E5"> what cross protocol access we</font>

765
00:33:05,100 --> 00:33:07,179
can<font color="#E5E5E5"> get</font>

766
00:33:05,380 --> 00:33:10,450
cross-site scripting in local files<font color="#E5E5E5"> like</font>

767
00:33:07,180 --> 00:33:12,760
<font color="#CCCCCC">prop self</font><font color="#E5E5E5"> invite one which might give us</font>

768
00:33:10,450 --> 00:33:13,780
<font color="#CCCCCC">access to their entire file system</font><font color="#E5E5E5"> just</font>

769
00:33:12,760 --> 00:33:17,379
once again<font color="#E5E5E5"> pretty nice</font>

770
00:33:13,780 --> 00:33:20,320
in fact<font color="#E5E5E5"> if</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> rendering there's a</font>

771
00:33:17,380 --> 00:33:22,330
huge number<font color="#E5E5E5"> of</font><font color="#CCCCCC"> things that can go wrong</font>

772
00:33:20,320 --> 00:33:24,310
<font color="#CCCCCC">tons</font><font color="#E5E5E5"> and tons of</font><font color="#CCCCCC"> things and</font><font color="#E5E5E5"> to answer</font>

773
00:33:22,330 --> 00:33:26,649
<font color="#E5E5E5">all of these questions</font><font color="#CCCCCC"> my colleague</font>

774
00:33:24,310 --> 00:33:30,129
<font color="#E5E5E5">Gareth ace who's presenting later on</font>

775
00:33:26,650 --> 00:33:32,820
<font color="#CCCCCC">vote at all called hack ability this</font><font color="#E5E5E5"> is</font>

776
00:33:30,130 --> 00:33:35,160
<font color="#CCCCCC">a website that</font><font color="#E5E5E5"> you can point someone at</font>

777
00:33:32,820 --> 00:33:38,679
and it will probe their browser

778
00:33:35,160 --> 00:33:41,650
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> and observe interesting</font>

779
00:33:38,680 --> 00:33:44,170
things<font color="#CCCCCC"> about</font><font color="#E5E5E5"> that environment like what</font>

780
00:33:41,650 --> 00:33:46,420
<font color="#E5E5E5">plugins they support and whether there's</font>

781
00:33:44,170 --> 00:33:49,000
any interesting JavaScript variables

782
00:33:46,420 --> 00:33:52,540
that aren't<font color="#E5E5E5"> that normal browsers don't</font>

783
00:33:49,000 --> 00:33:55,810
<font color="#E5E5E5">have for</font><font color="#CCCCCC"> example here</font><font color="#E5E5E5"> I've I've taken</font>

784
00:33:52,540 --> 00:33:57,460
the parity<font color="#CCCCCC"> ethelia</font><font color="#E5E5E5"> wallet which is most</font>

785
00:33:55,810 --> 00:34:01,149
notable because<font color="#CCCCCC"> it got horribly happy a</font>

786
00:33:57,460 --> 00:34:03,820
couple of weeks ago<font color="#E5E5E5"> and pointed it</font><font color="#CCCCCC"> at</font>

787
00:34:01,150 --> 00:34:05,680
this<font color="#CCCCCC"> website and and and hack ability</font>

788
00:34:03,820 --> 00:34:09,549
<font color="#E5E5E5">has identified that this wallet is</font>

789
00:34:05,680 --> 00:34:12,520
injecting some extra variables and using

790
00:34:09,550 --> 00:34:15,399
those using those objects<font color="#E5E5E5"> I can get the</font>

791
00:34:12,520 --> 00:34:17,290
<font color="#CCCCCC">wallet</font><font color="#E5E5E5"> ID of the person</font><font color="#CCCCCC"> who's visiting</font>

792
00:34:15,399 --> 00:34:20,500
my website and<font color="#CCCCCC"> even initiate</font>

793
00:34:17,290 --> 00:34:23,050
transactions<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> is actually</font>

794
00:34:20,500 --> 00:34:24,570
<font color="#E5E5E5">intended functionality but hack ability</font>

795
00:34:23,050 --> 00:34:27,070
will point<font color="#E5E5E5"> it out to</font><font color="#CCCCCC"> you in a very</font>

796
00:34:24,570 --> 00:34:29,320
<font color="#E5E5E5">obvious way and it was using something</font>

797
00:34:27,070 --> 00:34:32,470
very<font color="#E5E5E5"> similar that</font><font color="#CCCCCC"> we've got remote code</font>

798
00:34:29,320 --> 00:34:34,770
execution<font color="#CCCCCC"> on Jake's browser which is</font>

799
00:34:32,469 --> 00:34:37,779
basically a Java version<font color="#E5E5E5"> of phantom</font><font color="#CCCCCC"> J's</font>

800
00:34:34,770 --> 00:34:40,230
<font color="#E5E5E5">earlier this year these environments are</font>

801
00:34:37,780 --> 00:34:42,790
often<font color="#E5E5E5"> really out of</font><font color="#CCCCCC"> date and not well</font>

802
00:34:40,230 --> 00:34:50,620
configured and this will tell you really

803
00:34:42,790 --> 00:34:52,080
<font color="#CCCCCC">easy ways of hacking them okay looks</font>

804
00:34:50,620 --> 00:34:54,520
<font color="#E5E5E5">like we've got time for</font><font color="#CCCCCC"> one final</font>

805
00:34:52,080 --> 00:34:58,740
exploit I've saved my<font color="#CCCCCC"> favorite one till</font>

806
00:34:54,520 --> 00:35:01,330
last<font color="#CCCCCC"> so here this application is not</font>

807
00:34:58,740 --> 00:35:04,680
sending<font color="#E5E5E5"> my request to the wrong location</font>

808
00:35:01,330 --> 00:35:08,980
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> I I'm getting</font><font color="#CCCCCC"> the correct response</font>

809
00:35:04,680 --> 00:35:12,490
from the server<font color="#CCCCCC"> I from this request</font><font color="#E5E5E5"> but</font>

810
00:35:08,980 --> 00:35:15,190
when I trigger that request<font color="#CCCCCC"> I also get</font>

811
00:35:12,490 --> 00:35:18,729
requests to my server like<font color="#CCCCCC"> ping backs</font>

812
00:35:15,190 --> 00:35:19,390
for random files<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is another US</font>

813
00:35:18,730 --> 00:35:22,930
military web

814
00:35:19,390 --> 00:35:25,270
of course<font color="#CCCCCC"> and just to</font><font color="#E5E5E5"> confirm exactly</font>

815
00:35:22,930 --> 00:35:27,910
<font color="#E5E5E5">what's happening I've an on</font><font color="#CCCCCC"> wises</font>

816
00:35:25,270 --> 00:35:31,060
slightly<font color="#CCCCCC"> to</font><font color="#E5E5E5"> I loaded a history of blimps</font>

817
00:35:27,910 --> 00:35:33,399
<font color="#CCCCCC">page and the server</font><font color="#E5E5E5"> and the server tried</font>

818
00:35:31,060 --> 00:35:36,910
to fetch a picture of a blimp for my

819
00:35:33,400 --> 00:35:38,950
server<font color="#CCCCCC"> we're we which was quite</font>

820
00:35:36,910 --> 00:35:42,549
mysterious<font color="#CCCCCC"> so the only</font><font color="#E5E5E5"> plausible</font>

821
00:35:38,950 --> 00:35:45,040
explanation here is that<font color="#E5E5E5"> I'm accessing</font>

822
00:35:42,550 --> 00:35:47,740
this application through a reverse proxy

823
00:35:45,040 --> 00:35:50,140
<font color="#E5E5E5">and the</font><font color="#CCCCCC"> reverse proxy is scanning</font><font color="#E5E5E5"> the</font>

824
00:35:47,740 --> 00:35:52,899
responses<font color="#E5E5E5"> and it's looking for resource</font>

825
00:35:50,140 --> 00:35:56,140
<font color="#E5E5E5">imports</font><font color="#CCCCCC"> and then when it sees one of</font>

826
00:35:52,900 --> 00:35:57,910
<font color="#E5E5E5">those it fetches</font><font color="#CCCCCC"> it presumably</font><font color="#E5E5E5"> so it can</font>

827
00:35:56,140 --> 00:36:01,569
cache it<font color="#E5E5E5"> so that the page will load</font>

828
00:35:57,910 --> 00:36:05,170
<font color="#CCCCCC">faster</font><font color="#E5E5E5"> now I wonder if I can exploit</font>

829
00:36:01,570 --> 00:36:07,390
this maybe I can<font color="#E5E5E5"> send a</font><font color="#CCCCCC"> request to the</font>

830
00:36:05,170 --> 00:36:09,910
application<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> backend that will</font>

831
00:36:07,390 --> 00:36:11,830
trick<font color="#E5E5E5"> the reverse proxy into fetching us</font>

832
00:36:09,910 --> 00:36:14,460
and sent<font color="#E5E5E5"> some sensitive internal content</font>

833
00:36:11,830 --> 00:36:21,370
<font color="#E5E5E5">and caching it and then I can grab that</font>

834
00:36:14,460 --> 00:36:23,320
<font color="#CCCCCC">out the cache so to trigger this</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> had</font>

835
00:36:21,370 --> 00:36:25,180
to<font color="#E5E5E5"> find some cross site scripting which</font>

836
00:36:23,320 --> 00:36:29,230
was surprisingly difficult<font color="#E5E5E5"> but I found</font>

837
00:36:25,180 --> 00:36:31,359
<font color="#E5E5E5">some in the end so here I send a request</font>

838
00:36:29,230 --> 00:36:34,960
using<font color="#E5E5E5"> a reflected cross-site scripting</font>

839
00:36:31,360 --> 00:36:37,900
vulnerability for triggers<font color="#E5E5E5"> that makes</font>

840
00:36:34,960 --> 00:36:40,870
the server send the following<font color="#E5E5E5"> text back</font>

841
00:36:37,900 --> 00:36:43,270
to me<font color="#E5E5E5"> which has an image import</font>

842
00:36:40,870 --> 00:36:45,970
statement which<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> server's</font><font color="#E5E5E5"> from</font>

843
00:36:43,270 --> 00:36:48,400
<font color="#CCCCCC">the proxies point of view this is</font>

844
00:36:45,970 --> 00:36:50,319
fetching<font color="#E5E5E5"> any image right it starts with</font>

845
00:36:48,400 --> 00:36:54,940
image source equals and<font color="#E5E5E5"> the file name</font>

846
00:36:50,320 --> 00:36:57,210
<font color="#E5E5E5">ends in dot</font><font color="#CCCCCC"> jpg but from the so it will</font>

847
00:36:54,940 --> 00:37:00,460
see that and try<font color="#CCCCCC"> and grab that image</font>

848
00:36:57,210 --> 00:37:02,170
from that internal server but from the

849
00:37:00,460 --> 00:37:04,600
server's point of view because<font color="#E5E5E5"> it's</font>

850
00:37:02,170 --> 00:37:07,320
<font color="#CCCCCC">running the PHP that's just fetching</font><font color="#E5E5E5"> the</font>

851
00:37:04,600 --> 00:37:09,370
index the index of that<font color="#E5E5E5"> site</font><font color="#CCCCCC"> ISO the</font>

852
00:37:07,320 --> 00:37:11,140
<font color="#E5E5E5">proxy when it saw</font><font color="#CCCCCC"> that would catch that</font>

853
00:37:09,370 --> 00:37:13,270
<font color="#E5E5E5">content and that meant</font><font color="#CCCCCC"> that I could</font><font color="#E5E5E5"> just</font>

854
00:37:11,140 --> 00:37:16,810
<font color="#E5E5E5">grab hold of that sensitive internal</font>

855
00:37:13,270 --> 00:37:18,730
page from the proxies cache so what

856
00:37:16,810 --> 00:37:20,460
we've done<font color="#CCCCCC"> here is we've escalated a</font>

857
00:37:18,730 --> 00:37:22,450
reflected cross-site scripting

858
00:37:20,460 --> 00:37:25,420
vulnerability into a<font color="#CCCCCC"> service hide</font>

859
00:37:22,450 --> 00:37:27,730
request forgery vulnerability I think

860
00:37:25,420 --> 00:37:32,800
the key problem here is<font color="#CCCCCC"> that the proxy</font>

861
00:37:27,730 --> 00:37:37,780
<font color="#E5E5E5">is caching resources on external sites</font>

862
00:37:32,800 --> 00:38:05,200
<font color="#CCCCCC">not a</font><font color="#E5E5E5"> good idea okay</font><font color="#CCCCCC"> time for a brief</font>

863
00:37:37,780 --> 00:38:12,070
live demo of<font color="#E5E5E5"> collaborate everywhere okie</font>

864
00:38:05,200 --> 00:38:14,529
<font color="#E5E5E5">Dok right</font><font color="#CCCCCC"> so here we've got but sweet</font>

865
00:38:12,070 --> 00:38:15,160
<font color="#E5E5E5">and I'm just gonna turn on</font><font color="#CCCCCC"> calibrate it</font>

866
00:38:14,530 --> 00:38:17,710
everywhere

867
00:38:15,160 --> 00:38:23,920
and as you can<font color="#E5E5E5"> see here it's works out</font>

868
00:38:17,710 --> 00:38:26,440
what my<font color="#E5E5E5"> IP czar for DNS and TCP and</font>

869
00:38:23,920 --> 00:38:29,830
that's because sometimes<font color="#CCCCCC"> my system will</font>

870
00:38:26,440 --> 00:38:31,540
cause interactions and it will otherwise

871
00:38:29,830 --> 00:38:32,980
report<font color="#E5E5E5"> these is highly exciting</font>

872
00:38:31,540 --> 00:38:34,810
vulnerabilities when they're just<font color="#E5E5E5"> been</font>

873
00:38:32,980 --> 00:38:37,390
caused by<font color="#CCCCCC"> my own system</font><font color="#E5E5E5"> and they're not</font>

874
00:38:34,810 --> 00:38:41,680
<font color="#CCCCCC">very interesting so now I'm just</font><font color="#E5E5E5"> going</font>

875
00:38:37,390 --> 00:38:44,710
to<font color="#E5E5E5"> load Firefox which is proxying</font>

876
00:38:41,680 --> 00:38:47,339
through but and this<font color="#E5E5E5"> is loading a bunch</font>

877
00:38:44,710 --> 00:38:51,280
<font color="#CCCCCC">of websites</font><font color="#E5E5E5"> like stripe Foursquare</font><font color="#CCCCCC"> or</font>

878
00:38:47,340 --> 00:38:54,720
<font color="#CCCCCC">earlex</font><font color="#E5E5E5"> Starbucks</font><font color="#CCCCCC"> a Facebook and Netflix</font>

879
00:38:51,280 --> 00:38:57,430
now what I'm showing<font color="#CCCCCC"> you here are not</font>

880
00:38:54,720 --> 00:38:59,589
vulnerabilities in these<font color="#E5E5E5"> websites these</font>

881
00:38:57,430 --> 00:39:05,589
<font color="#E5E5E5">are interesting pieces of behavior in</font>

882
00:38:59,590 --> 00:39:08,050
these<font color="#E5E5E5"> websites</font><font color="#CCCCCC"> so if we look</font><font color="#E5E5E5"> at the</font>

883
00:39:05,590 --> 00:39:11,610
proxy history we<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see if</font><font color="#E5E5E5"> you pick a</font>

884
00:39:08,050 --> 00:39:11,610
random thing here that's not<font color="#E5E5E5"> a good one</font>

885
00:39:11,970 --> 00:39:16,810
<font color="#CCCCCC">this is the</font><font color="#E5E5E5"> request that the browser</font>

886
00:39:14,770 --> 00:39:20,020
sent<font color="#E5E5E5"> and collaborate it everywhere</font><font color="#CCCCCC"> it</font>

887
00:39:16,810 --> 00:39:22,990
has rewritten it and it's injected loads

888
00:39:20,020 --> 00:39:26,770
of payloads<font color="#E5E5E5"> right it just</font><font color="#CCCCCC"> puts them</font>

889
00:39:22,990 --> 00:39:30,700
everywhere<font color="#CCCCCC"> and so that may have caused</font>

890
00:39:26,770 --> 00:39:32,110
an interaction<font color="#CCCCCC"> and if we look this</font><font color="#E5E5E5"> kind</font>

891
00:39:30,700 --> 00:39:37,899
of<font color="#CCCCCC"> results we</font><font color="#E5E5E5"> can see</font><font color="#CCCCCC"> we've got a</font><font color="#E5E5E5"> bunch</font>

892
00:39:32,110 --> 00:39:41,970
of pingbacks<font color="#E5E5E5"> so here for</font><font color="#CCCCCC"> example you</font><font color="#E5E5E5"> can</font>

893
00:39:37,900 --> 00:39:44,710
see<font color="#CCCCCC"> that stripe has fetched</font><font color="#E5E5E5"> for the URL</font>

894
00:39:41,970 --> 00:39:46,540
specified in the referer header and they

895
00:39:44,710 --> 00:39:49,300
fetched it with a user

896
00:39:46,540 --> 00:39:51,430
of<font color="#E5E5E5"> Ruby so presumably they're using Ruby</font>

897
00:39:49,300 --> 00:39:55,000
to do that and it says that happened

898
00:39:51,430 --> 00:39:58,299
after<font color="#E5E5E5"> - two seconds</font><font color="#CCCCCC"> which means</font><font color="#E5E5E5"> the time</font>

899
00:39:55,000 --> 00:40:00,970
on this<font color="#E5E5E5"> system is slightly wrong ah hey</font>

900
00:39:58,300 --> 00:40:03,550
some other systems I<font color="#CCCCCC"> sinned</font><font color="#E5E5E5"> ping back</font>

901
00:40:00,970 --> 00:40:07,870
<font color="#E5E5E5">ascend pingbacks after quite a long time</font>

902
00:40:03,550 --> 00:40:11,710
gap<font color="#CCCCCC"> so here Netflix fetched us after</font>

903
00:40:07,870 --> 00:40:15,279
nine hours<font color="#CCCCCC"> of 30 minutes and if</font><font color="#E5E5E5"> we look</font>

904
00:40:11,710 --> 00:40:19,000
at this<font color="#E5E5E5"> interestingly they claim to be</font>

905
00:40:15,280 --> 00:40:24,280
using an iPhone<font color="#CCCCCC"> but</font><font color="#E5E5E5"> they also claim</font><font color="#CCCCCC"> to</font>

906
00:40:19,000 --> 00:40:26,740
be using an x86 CPU<font color="#CCCCCC"> and so yeah</font>

907
00:40:24,280 --> 00:40:29,980
<font color="#CCCCCC">simile here we</font><font color="#E5E5E5"> can see that Facebook</font>

908
00:40:26,740 --> 00:40:35,589
have<font color="#E5E5E5"> fetched the WAP file specified in</font>

909
00:40:29,980 --> 00:40:38,860
<font color="#CCCCCC">expat profile and we also get</font><font color="#E5E5E5"> DNS</font>

910
00:40:35,590 --> 00:40:41,140
lookups<font color="#E5E5E5"> for the true client IP header</font>

911
00:40:38,860 --> 00:40:43,300
from<font color="#E5E5E5"> Starbucks</font><font color="#CCCCCC"> so we know me we can</font>

912
00:40:41,140 --> 00:40:47,799
maybe spoof our IP<font color="#E5E5E5"> on Starbucks perhaps</font>

913
00:40:43,300 --> 00:40:52,500
<font color="#E5E5E5">and</font><font color="#CCCCCC"> X VIP from stripe and exported for</font>

914
00:40:47,800 --> 00:40:52,500
from loads of people<font color="#E5E5E5"> okay</font>

915
00:41:00,480 --> 00:41:08,550
great<font color="#E5E5E5"> that's the demo now</font><font color="#CCCCCC"> how do you</font>

916
00:41:05,369 --> 00:41:09,750
<font color="#CCCCCC">educate</font><font color="#E5E5E5"> these issues well you can</font>

917
00:41:08,550 --> 00:41:12,660
replicate them using burp suite of

918
00:41:09,750 --> 00:41:13,920
course as of<font color="#E5E5E5"> the latest update the</font>

919
00:41:12,660 --> 00:41:16,970
scanner<font color="#E5E5E5"> will find most of</font><font color="#CCCCCC"> these</font>

920
00:41:13,920 --> 00:41:19,109
vulnerabilities<font color="#CCCCCC"> automatically</font>

921
00:41:16,970 --> 00:41:21,060
<font color="#CCCCCC">unfortunately you</font><font color="#E5E5E5"> can't let placate all</font>

922
00:41:19,109 --> 00:41:23,130
of these issues<font color="#E5E5E5"> using SAP because of a</font>

923
00:41:21,060 --> 00:41:24,930
known bug<font color="#E5E5E5"> but I have it on</font><font color="#CCCCCC"> good</font>

924
00:41:23,130 --> 00:41:26,880
authority that this is going to be fixed

925
00:41:24,930 --> 00:41:32,819
<font color="#CCCCCC">soon so soon you will be</font><font color="#E5E5E5"> able to use up</font>

926
00:41:26,880 --> 00:41:35,670
to find these issues<font color="#E5E5E5"> and my</font><font color="#CCCCCC"> Tim</font><font color="#E5E5E5"> MIT</font><font color="#CCCCCC"> M</font>

927
00:41:32,820 --> 00:41:39,060
proxy is a good<font color="#E5E5E5"> open source alternative</font>

928
00:41:35,670 --> 00:41:41,010
<font color="#E5E5E5">that can handle this stuff if you want</font>

929
00:41:39,060 --> 00:41:43,770
to help clients replicate it<font color="#E5E5E5"> they might</font>

930
00:41:41,010 --> 00:41:46,320
<font color="#E5E5E5">not have any of these tools so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

931
00:41:43,770 --> 00:41:49,200
do<font color="#E5E5E5"> most of them with</font><font color="#CCCCCC"> show commands</font><font color="#E5E5E5"> you</font>

932
00:41:46,320 --> 00:41:52,230
can<font color="#CCCCCC"> do the basic attacks using Co like</font>

933
00:41:49,200 --> 00:41:55,290
this for the more advanced<font color="#CCCCCC"> ones that</font>

934
00:41:52,230 --> 00:41:58,200
require<font color="#E5E5E5"> malformed tasty HTTP requests</font>

935
00:41:55,290 --> 00:42:02,579
<font color="#E5E5E5">you will need to</font><font color="#CCCCCC"> use echo</font><font color="#E5E5E5"> and then just</font>

936
00:41:58,200 --> 00:42:04,770
pipe it<font color="#CCCCCC"> into</font><font color="#E5E5E5"> n cat or open SSL</font><font color="#CCCCCC"> as</font>

937
00:42:02,579 --> 00:42:08,369
appropriate<font color="#E5E5E5"> also you might need to use</font>

938
00:42:04,770 --> 00:42:11,700
<font color="#CCCCCC">the server name or</font><font color="#E5E5E5"> option for open SSL</font>

939
00:42:08,369 --> 00:42:15,030
to<font color="#CCCCCC"> set</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> s ni feels</font><font color="#E5E5E5"> depending on if</font>

940
00:42:11,700 --> 00:42:20,129
the target<font color="#CCCCCC"> is using doubt</font><font color="#E5E5E5"> fat or they're</font>

941
00:42:15,030 --> 00:42:22,470
like<font color="#E5E5E5"> okay how do you defend against</font>

942
00:42:20,130 --> 00:42:24,390
these attacks<font color="#E5E5E5"> well as far as reverse</font>

943
00:42:22,470 --> 00:42:27,060
proxies go and load balances and<font color="#CCCCCC"> the</font>

944
00:42:24,390 --> 00:42:29,129
like<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think the important thing is to</font>

945
00:42:27,060 --> 00:42:31,740
understand these systems<font color="#E5E5E5"> are</font><font color="#CCCCCC"> designed to</font>

946
00:42:29,130 --> 00:42:36,060
proxy they're meant<font color="#E5E5E5"> to send requests to</font>

947
00:42:31,740 --> 00:42:37,979
<font color="#E5E5E5">internal servers so it only takes a tiny</font>

948
00:42:36,060 --> 00:42:40,950
tiny bug in these to make them send the

949
00:42:37,980 --> 00:42:42,960
request to<font color="#CCCCCC"> the wrong internal server as</font>

950
00:42:40,950 --> 00:42:45,328
a result the<font color="#E5E5E5"> best approach is</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> put</font>

951
00:42:42,960 --> 00:42:47,190
these in a<font color="#CCCCCC"> demilitarized zone to put</font>

952
00:42:45,329 --> 00:42:49,470
them in a network<font color="#CCCCCC"> environment in which</font>

953
00:42:47,190 --> 00:42:52,140
they do not<font color="#E5E5E5"> have</font><font color="#CCCCCC"> Network level</font><font color="#E5E5E5"> access to</font>

954
00:42:49,470 --> 00:42:53,970
<font color="#CCCCCC">any stuff that's</font><font color="#E5E5E5"> intended</font><font color="#CCCCCC"> to be private</font>

955
00:42:52,140 --> 00:42:56,339
<font color="#E5E5E5">don't put them on a system with</font>

956
00:42:53,970 --> 00:43:00,060
unauthenticated<font color="#E5E5E5"> admin panels on the same</font>

957
00:42:56,339 --> 00:43:01,619
<font color="#CCCCCC">network as for things that fetch the</font>

958
00:43:00,060 --> 00:43:03,359
referer header and the like

959
00:43:01,619 --> 00:43:06,329
it may help<font color="#E5E5E5"> to</font><font color="#CCCCCC"> think of them as</font>

960
00:43:03,359 --> 00:43:08,670
employees<font color="#E5E5E5"> that have really really</font><font color="#CCCCCC"> whole</font>

961
00:43:06,329 --> 00:43:11,569
web browsers<font color="#CCCCCC"> that never get updated</font><font color="#E5E5E5"> who</font>

962
00:43:08,670 --> 00:43:14,340
click on every link that you give them

963
00:43:11,569 --> 00:43:16,320
<font color="#E5E5E5">fortunately unlike employees they won't</font>

964
00:43:14,340 --> 00:43:19,200
<font color="#E5E5E5">plain if you put them in a sandbox</font><font color="#CCCCCC"> so</font>

965
00:43:16,320 --> 00:43:22,050
that's why I<font color="#E5E5E5"> would</font><font color="#CCCCCC"> recommend</font><font color="#E5E5E5"> do it also</font>

966
00:43:19,200 --> 00:43:23,370
<font color="#CCCCCC">if you've got a bug bounty program</font><font color="#E5E5E5"> well</font>

967
00:43:22,050 --> 00:43:25,650
if you don't<font color="#CCCCCC"> have one I recommend having</font>

968
00:43:23,370 --> 00:43:28,410
<font color="#E5E5E5">one if you've got one and</font><font color="#CCCCCC"> you don't</font>

969
00:43:25,650 --> 00:43:30,660
forbid<font color="#E5E5E5"> automated testing I've</font><font color="#CCCCCC"> probably</font>

970
00:43:28,410 --> 00:43:32,640
<font color="#CCCCCC">already tried</font><font color="#E5E5E5"> these payloads on your</font>

971
00:43:30,660 --> 00:43:35,700
site so<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can have a degree of</font>

972
00:43:32,640 --> 00:43:38,520
<font color="#E5E5E5">confidence</font><font color="#CCCCCC"> so you're</font><font color="#E5E5E5"> not so vulnerable</font>

973
00:43:35,700 --> 00:43:40,500
please don't forbid<font color="#E5E5E5"> automated testing</font>

974
00:43:38,520 --> 00:43:42,480
with with with custom tools because you

975
00:43:40,500 --> 00:43:45,720
will miss<font color="#E5E5E5"> out</font><font color="#CCCCCC"> on some really good</font><font color="#E5E5E5"> fun on</font>

976
00:43:42,480 --> 00:43:47,220
<font color="#CCCCCC">some really good vulnerabilities</font><font color="#E5E5E5"> if you</font>

977
00:43:45,720 --> 00:43:48,950
want to stop people flooding you with

978
00:43:47,220 --> 00:43:53,279
traffic you could always just forbid

979
00:43:48,950 --> 00:43:55,980
<font color="#CCCCCC">testing with off-the-shelf tools</font><font color="#E5E5E5"> okay</font>

980
00:43:53,280 --> 00:43:57,660
<font color="#E5E5E5">the three key things</font><font color="#CCCCCC"> to take away I have</font>

981
00:43:55,980 --> 00:44:00,330
a bug bounties<font color="#CCCCCC"> that enable white hat</font>

982
00:43:57,660 --> 00:44:03,270
research<font color="#CCCCCC"> at scale load balancers our</font>

983
00:44:00,330 --> 00:44:06,450
VPNs for the public and coolers<font color="#CCCCCC"> our</font>

984
00:44:03,270 --> 00:44:08,220
employees<font color="#E5E5E5"> who click I'll take five</font>

985
00:44:06,450 --> 00:44:09,839
minutes<font color="#E5E5E5"> of questions now and</font><font color="#CCCCCC"> then if</font>

986
00:44:08,220 --> 00:44:11,069
you've<font color="#CCCCCC"> got any any more after that I</font>

987
00:44:09,840 --> 00:44:13,470
feel free to come<font color="#CCCCCC"> and</font><font color="#E5E5E5"> talk to me at the</font>

988
00:44:11,070 --> 00:44:15,300
back or<font color="#E5E5E5"> send me an email don't forget to</font>

989
00:44:13,470 --> 00:44:16,250
follow me on<font color="#E5E5E5"> Twitter thank you for</font>

990
00:44:15,300 --> 00:44:19,510
listening

991
00:44:16,250 --> 00:44:19,510
[Applause]

992
00:44:23,030 --> 00:44:26,719
[Applause]

993
00:44:32,290 --> 00:44:45,170
yep<font color="#CCCCCC"> it was</font><font color="#E5E5E5"> fixed a</font><font color="#CCCCCC"> few months ago</font><font color="#E5E5E5"> it</font>

994
00:44:42,680 --> 00:44:47,899
didn't<font color="#E5E5E5"> I pretty sure it didn't get a</font><font color="#CCCCCC"> CVE</font>

995
00:44:45,170 --> 00:44:49,580
because I mean they would<font color="#CCCCCC"> argue that's</font>

996
00:44:47,900 --> 00:44:50,960
not<font color="#CCCCCC"> a</font><font color="#E5E5E5"> vulnerability it's only a</font>

997
00:44:49,580 --> 00:44:55,310
vulnerability when it's combined with

998
00:44:50,960 --> 00:45:04,280
<font color="#E5E5E5">new LX coat</font><font color="#CCCCCC"> yes</font><font color="#E5E5E5"> they it was patched a</font>

999
00:44:55,310 --> 00:45:06,850
few months ago<font color="#E5E5E5"> okay thank</font><font color="#CCCCCC"> you thank you</font>

1000
00:45:04,280 --> 00:45:06,850
<font color="#CCCCCC">very much James</font>

