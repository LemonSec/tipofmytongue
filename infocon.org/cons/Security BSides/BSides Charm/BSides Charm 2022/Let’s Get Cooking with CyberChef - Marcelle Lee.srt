1
00:00:24,560 --> 00:00:26,640
all right hello people

2
00:00:26,640 --> 00:00:29,039
i'm very happy to see you

3
00:00:29,039 --> 00:00:30,960
in person

4
00:00:30,960 --> 00:00:33,680
i've been giving presentations to like

5
00:00:33,680 --> 00:00:36,000
my computer screen for the past two

6
00:00:36,000 --> 00:00:37,440
years and

7
00:00:37,440 --> 00:00:39,600
it's really hard because you don't get

8
00:00:39,600 --> 00:00:41,840
any kind of interaction whatsoever

9
00:00:41,840 --> 00:00:45,280
so anyway i'm marcel and i'm here to

10
00:00:45,280 --> 00:00:47,039
talk to you about one of my favorite

11
00:00:47,039 --> 00:00:48,960
tools cyber chef

12
00:00:48,960 --> 00:00:51,120
this is let's get cooking with cyber

13
00:00:51,120 --> 00:00:52,480
chef so hopefully you're in the right

14
00:00:52,480 --> 00:00:53,760
room

15
00:00:53,760 --> 00:00:56,840
so so a little bit about me

16
00:00:56,840 --> 00:01:00,320
um i am pretty much at marcel lee on all

17
00:01:00,320 --> 00:01:03,440
the socials if you want to find me i

18
00:01:03,440 --> 00:01:05,040
also have my contact information at the

19
00:01:05,040 --> 00:01:07,760
end i just changed jobs like three weeks

20
00:01:07,760 --> 00:01:10,159
ago so i'm like still drinking from the

21
00:01:10,159 --> 00:01:12,799
fire hose at a company called equinix

22
00:01:12,799 --> 00:01:14,320
which is a

23
00:01:14,320 --> 00:01:16,720
really big global data center company so

24
00:01:16,720 --> 00:01:18,799
it's kind of a different environment for

25
00:01:18,799 --> 00:01:21,439
me i'm used to working for mssps but i'm

26
00:01:21,439 --> 00:01:23,840
still doing threat intel which is my

27
00:01:23,840 --> 00:01:26,720
favorite thing pretty much in the world

28
00:01:26,720 --> 00:01:29,600
i'm also an adjunct professor at umd and

29
00:01:29,600 --> 00:01:32,880
umgc if you take any classes at umgc in

30
00:01:32,880 --> 00:01:35,200
the cyber area you might come across me

31
00:01:35,200 --> 00:01:37,200
at some point in time

32
00:01:37,200 --> 00:01:39,280
all virtual of course but and then i'm

33
00:01:39,280 --> 00:01:41,520
also on the board of directors for a

34
00:01:41,520 --> 00:01:43,200
number of different organizations but

35
00:01:43,200 --> 00:01:44,479
the one that i wanted to mention

36
00:01:44,479 --> 00:01:47,360
specifically is um women's society of

37
00:01:47,360 --> 00:01:49,600
cyber jitsu which is not just for women

38
00:01:49,600 --> 00:01:52,000
despite what the name implies and i'm

39
00:01:52,000 --> 00:01:54,479
going to do a shameless plug

40
00:01:54,479 --> 00:01:56,720
for

41
00:01:56,960 --> 00:01:59,920
and i'm going to grab some water too for

42
00:01:59,920 --> 00:02:02,079
an event that we have coming up in june

43
00:02:02,079 --> 00:02:04,640
june 18th it's cyber jitsu khan it's

44
00:02:04,640 --> 00:02:06,159
going to be at

45
00:02:06,159 --> 00:02:08,000
the maritime conference center which is

46
00:02:08,000 --> 00:02:09,919
out by bwi airport it's actually a

47
00:02:09,919 --> 00:02:11,520
really cool facility that i had like

48
00:02:11,520 --> 00:02:13,920
never heard of before um so it's gonna

49
00:02:13,920 --> 00:02:16,720
be a great day i highly recommend you

50
00:02:16,720 --> 00:02:18,640
register volunteer if you want to

51
00:02:18,640 --> 00:02:22,879
sponsor if you want to all the things

52
00:02:22,879 --> 00:02:25,680
okay so a little bit about you know just

53
00:02:25,680 --> 00:02:27,840
what is a cyber security researcher it

54
00:02:27,840 --> 00:02:29,920
can mean a lot of different things

55
00:02:29,920 --> 00:02:30,720
um

56
00:02:30,720 --> 00:02:32,239
this is sort of like my joking

57
00:02:32,239 --> 00:02:33,920
interpretation of what it is you know

58
00:02:33,920 --> 00:02:36,000
the collector of shiny cyber things

59
00:02:36,000 --> 00:02:37,599
that's what i say that i do all the time

60
00:02:37,599 --> 00:02:38,640
right

61
00:02:38,640 --> 00:02:41,200
identifier cyber badness

62
00:02:41,200 --> 00:02:44,319
googler extraordinaire that is like the

63
00:02:44,319 --> 00:02:46,480
key tool that we all use right

64
00:02:46,480 --> 00:02:49,120
and an expert copy paster because that's

65
00:02:49,120 --> 00:02:52,239
also something that we do lots of

66
00:02:52,239 --> 00:02:54,480
but what is it really so it's a lot of

67
00:02:54,480 --> 00:02:56,000
different things and these are just kind

68
00:02:56,000 --> 00:02:58,480
of like a brain dump for me of of things

69
00:02:58,480 --> 00:03:01,440
that i do regularly in my day-to-day job

70
00:03:01,440 --> 00:03:03,440
right so who here does

71
00:03:03,440 --> 00:03:06,239
security research like it's her job

72
00:03:06,239 --> 00:03:07,920
a few people yeah

73
00:03:07,920 --> 00:03:10,080
anybody want to do it that doesn't do it

74
00:03:10,080 --> 00:03:12,319
right now yeah a few people i do have a

75
00:03:12,319 --> 00:03:14,640
talk um floating around out there i

76
00:03:14,640 --> 00:03:16,800
think i have it on my github

77
00:03:16,800 --> 00:03:18,400
that's called like a day in the life of

78
00:03:18,400 --> 00:03:20,080
a security researcher that kind of does

79
00:03:20,080 --> 00:03:22,480
a deep dive on this topic as opposed to

80
00:03:22,480 --> 00:03:23,840
like one slide

81
00:03:23,840 --> 00:03:26,159
so anyway but this is what i think it is

82
00:03:26,159 --> 00:03:28,159
right so you're obtaining and digesting

83
00:03:28,159 --> 00:03:30,239
threat until data from a variety of

84
00:03:30,239 --> 00:03:32,879
sources and that could be you know ocean

85
00:03:32,879 --> 00:03:34,560
human

86
00:03:34,560 --> 00:03:36,879
obviously telemetry from within your own

87
00:03:36,879 --> 00:03:38,239
company

88
00:03:38,239 --> 00:03:40,239
government sources

89
00:03:40,239 --> 00:03:42,319
the list goes on and on

90
00:03:42,319 --> 00:03:45,280
doing google dorking of course

91
00:03:45,280 --> 00:03:46,640
is a good thing i definitely learned

92
00:03:46,640 --> 00:03:48,080
some things from nick

93
00:03:48,080 --> 00:03:50,080
um and then analyzing the data that

94
00:03:50,080 --> 00:03:52,319
you're finding and identifying trends

95
00:03:52,319 --> 00:03:54,799
patterns campaigns it's like a big thing

96
00:03:54,799 --> 00:03:57,760
so say you know you you come across a

97
00:03:57,760 --> 00:04:00,000
phishing email and then you dig into it

98
00:04:00,000 --> 00:04:01,920
maybe using some of the techniques that

99
00:04:01,920 --> 00:04:03,920
nick mentioned like looking at exit data

100
00:04:03,920 --> 00:04:05,519
metadata whatever

101
00:04:05,519 --> 00:04:07,040
um and just pulling the threads to

102
00:04:07,040 --> 00:04:09,439
figure out like what is this phishing

103
00:04:09,439 --> 00:04:11,920
email representative of is it a larger

104
00:04:11,920 --> 00:04:14,640
campaign did it come from you know like

105
00:04:14,640 --> 00:04:17,199
a quack box thing or you know whatever

106
00:04:17,199 --> 00:04:18,478
so um

107
00:04:18,478 --> 00:04:20,720
i think like a natural curiosity i think

108
00:04:20,720 --> 00:04:22,240
really helps with this kind of thing

109
00:04:22,240 --> 00:04:23,360
because you do

110
00:04:23,360 --> 00:04:26,800
end up in a lot of rabbit holes which

111
00:04:26,800 --> 00:04:29,280
i got a tattoo that says

112
00:04:29,280 --> 00:04:30,800
down the rabbit hole because that's

113
00:04:30,800 --> 00:04:32,960
basically where i spend much of my life

114
00:04:32,960 --> 00:04:36,240
um anyway so and then applying

115
00:04:36,240 --> 00:04:38,160
frameworks mitre attack is obviously a

116
00:04:38,160 --> 00:04:39,759
very common one that most people are

117
00:04:39,759 --> 00:04:42,400
familiar with i use that one a lot

118
00:04:42,400 --> 00:04:45,280
um extracting indicators so what do i

119
00:04:45,280 --> 00:04:48,720
mean by indicators hashes ips domains so

120
00:04:48,720 --> 00:04:50,080
on and so forth

121
00:04:50,080 --> 00:04:51,520
and um

122
00:04:51,520 --> 00:04:53,759
and just really collecting gathering

123
00:04:53,759 --> 00:04:56,880
knowledge or creating knowledge about

124
00:04:56,880 --> 00:04:58,639
these different threats

125
00:04:58,639 --> 00:05:00,960
and creating countermeasures might be a

126
00:05:00,960 --> 00:05:02,479
part of your job that's definitely

127
00:05:02,479 --> 00:05:04,000
something that i did with my previous

128
00:05:04,000 --> 00:05:06,720
employer which was secure works and we

129
00:05:06,720 --> 00:05:08,400
would work with the countermeasure team

130
00:05:08,400 --> 00:05:09,199
to

131
00:05:09,199 --> 00:05:11,199
essentially say we identified some new

132
00:05:11,199 --> 00:05:13,199
malware or something you know how can we

133
00:05:13,199 --> 00:05:14,639
work with them to make sure that we've

134
00:05:14,639 --> 00:05:16,080
got signatures in place that are going

135
00:05:16,080 --> 00:05:18,639
to detect that um activity

136
00:05:18,639 --> 00:05:21,039
accessing exposure to your

137
00:05:21,039 --> 00:05:23,680
corporation and and then last but not

138
00:05:23,680 --> 00:05:25,680
least everybody's favorite reporting the

139
00:05:25,680 --> 00:05:27,759
findings but none of this is any good if

140
00:05:27,759 --> 00:05:30,080
you're not reporting it so

141
00:05:30,080 --> 00:05:32,400
that's a big piece

142
00:05:32,400 --> 00:05:34,880
and i want to acknowledge i did a cyber

143
00:05:34,880 --> 00:05:36,800
chef trading from matt

144
00:05:36,800 --> 00:05:39,120
weiner weiner i'm not sure how to say it

145
00:05:39,120 --> 00:05:41,360
and i think that chris sanders possibly

146
00:05:41,360 --> 00:05:42,880
actually built the course but it's

147
00:05:42,880 --> 00:05:45,360
really really good if you go to

148
00:05:45,360 --> 00:05:48,000
applied network defense you could also

149
00:05:48,000 --> 00:05:49,600
take the same course

150
00:05:49,600 --> 00:05:51,120
and you might even finish it which i

151
00:05:51,120 --> 00:05:52,400
haven't i

152
00:05:52,400 --> 00:05:55,039
had work pay for the original like six

153
00:05:55,039 --> 00:05:56,479
month period or whatever and i've been

154
00:05:56,479 --> 00:05:58,880
paying 20 a month for i have no idea how

155
00:05:58,880 --> 00:06:00,720
long and i still haven't finished it but

156
00:06:00,720 --> 00:06:02,400
anyway um

157
00:06:02,400 --> 00:06:06,359
so that's a really good class

158
00:06:06,400 --> 00:06:07,840
so um

159
00:06:07,840 --> 00:06:10,560
let's get into what is cyber chef so

160
00:06:10,560 --> 00:06:12,560
first of all who here has used cyber

161
00:06:12,560 --> 00:06:13,759
chef before

162
00:06:13,759 --> 00:06:16,000
oh good lots of you wait so why am i up

163
00:06:16,000 --> 00:06:17,199
here telling you about it you all know

164
00:06:17,199 --> 00:06:18,800
how to do this already

165
00:06:18,800 --> 00:06:22,880
um anyway cyber chef comes from gchq

166
00:06:22,880 --> 00:06:24,479
which is basically the british

167
00:06:24,479 --> 00:06:27,360
equivalent of nsa um that building there

168
00:06:27,360 --> 00:06:29,919
is referred to as the donut and

169
00:06:29,919 --> 00:06:32,319
that's their headquarters wherever in

170
00:06:32,319 --> 00:06:34,639
england

171
00:06:34,639 --> 00:06:36,240
and so there's really i mean it's one

172
00:06:36,240 --> 00:06:37,440
github project but they have two

173
00:06:37,440 --> 00:06:40,479
different links there so

174
00:06:40,479 --> 00:06:42,960
their github project and then the actual

175
00:06:42,960 --> 00:06:44,479
direct link

176
00:06:44,479 --> 00:06:46,160
to the tool

177
00:06:46,160 --> 00:06:49,120
so you can run cyber chef either locally

178
00:06:49,120 --> 00:06:50,240
or

179
00:06:50,240 --> 00:06:52,639
through the website and either way the

180
00:06:52,639 --> 00:06:55,520
operations are performed client-side so

181
00:06:55,520 --> 00:06:58,479
what you put in shouldn't be visible at

182
00:06:58,479 --> 00:07:01,280
the server side

183
00:07:01,440 --> 00:07:02,960
all right so let's talk a little bit

184
00:07:02,960 --> 00:07:04,960
about the layout

185
00:07:04,960 --> 00:07:05,919
um

186
00:07:05,919 --> 00:07:08,080
cyber chef as the name implies is all

187
00:07:08,080 --> 00:07:09,360
about like

188
00:07:09,360 --> 00:07:12,000
recipes and cooking and things like that

189
00:07:12,000 --> 00:07:14,479
in fact yesterday i was having lunch at

190
00:07:14,479 --> 00:07:16,479
like bonefish grill in

191
00:07:16,479 --> 00:07:19,759
some place but uh the waiter was looking

192
00:07:19,759 --> 00:07:21,440
at me working on my presentation and

193
00:07:21,440 --> 00:07:22,319
he's like

194
00:07:22,319 --> 00:07:25,440
oh are you a chef and i was like no and

195
00:07:25,440 --> 00:07:26,639
then i'm like but let me show you this

196
00:07:26,639 --> 00:07:27,840
really cool tool and he was just

197
00:07:27,840 --> 00:07:30,800
probably thought i was crazy anyway

198
00:07:30,800 --> 00:07:33,360
so so you have your operations section

199
00:07:33,360 --> 00:07:36,080
which is that um left-hand pane there

200
00:07:36,080 --> 00:07:38,080
and there i'm gonna as y'all show you

201
00:07:38,080 --> 00:07:39,919
many many many different operations that

202
00:07:39,919 --> 00:07:42,240
you can use then the middle pane is the

203
00:07:42,240 --> 00:07:45,759
recipe and a recipe is just basically

204
00:07:45,759 --> 00:07:48,000
some kind of

205
00:07:48,000 --> 00:07:51,120
combination of operations

206
00:07:51,120 --> 00:07:54,160
then the input output pane the baking

207
00:07:54,160 --> 00:07:56,800
piece of it

208
00:07:57,360 --> 00:07:58,560
and then

209
00:07:58,560 --> 00:08:00,639
the operations are or just all the

210
00:08:00,639 --> 00:08:02,400
things that cyber chef could do for you

211
00:08:02,400 --> 00:08:05,199
you can also favorite operations so this

212
00:08:05,199 --> 00:08:06,800
is something i recommend doing it's not

213
00:08:06,800 --> 00:08:08,479
wildly intuitive how to do it but if you

214
00:08:08,479 --> 00:08:09,840
click on the star

215
00:08:09,840 --> 00:08:12,560
next to favorites um here i'll just pull

216
00:08:12,560 --> 00:08:15,199
it up right now

217
00:08:15,759 --> 00:08:17,120
where did i put my glasses there they

218
00:08:17,120 --> 00:08:17,840
are

219
00:08:17,840 --> 00:08:19,840
so i got lasik during the pandemic

220
00:08:19,840 --> 00:08:21,759
because i really like couldn't stand

221
00:08:21,759 --> 00:08:24,479
having a foggy glasses from the mask all

222
00:08:24,479 --> 00:08:27,440
the time but now i have to wear like uh

223
00:08:27,440 --> 00:08:28,879
glasses for close up and this is the

224
00:08:28,879 --> 00:08:30,560
first time i've done a talk where i have

225
00:08:30,560 --> 00:08:32,000
like actually have to see people out

226
00:08:32,000 --> 00:08:33,839
there and see this so

227
00:08:33,839 --> 00:08:36,000
i guess i don't have to see you all but

228
00:08:36,000 --> 00:08:38,080
i want to see you

229
00:08:38,080 --> 00:08:39,279
okay

230
00:08:39,279 --> 00:08:42,640
let's make this a little bigger

231
00:08:47,440 --> 00:08:50,959
let's make it even bigger

232
00:08:52,800 --> 00:08:54,720
how's that is that right

233
00:08:54,720 --> 00:08:56,640
okay

234
00:08:56,640 --> 00:08:58,800
so the favorites um if you click on the

235
00:08:58,800 --> 00:09:00,480
star right here and you can edit

236
00:09:00,480 --> 00:09:02,480
favorites and this is how you would you

237
00:09:02,480 --> 00:09:05,360
know add delete or whatever we'll delete

238
00:09:05,360 --> 00:09:07,360
reorder and then if you wanted to add

239
00:09:07,360 --> 00:09:09,040
favorites you would just do that from

240
00:09:09,040 --> 00:09:11,760
the actual um

241
00:09:11,760 --> 00:09:14,800
operation you have an option there

242
00:09:14,800 --> 00:09:16,880
okay so that's that

243
00:09:16,880 --> 00:09:19,120
and

244
00:09:19,120 --> 00:09:21,839
the recipe part so what you see on the

245
00:09:21,839 --> 00:09:25,120
screen here is a combination of

246
00:09:25,120 --> 00:09:27,760
four different recipes right so from

247
00:09:27,760 --> 00:09:32,000
base 64 to binary reverse raw deflate

248
00:09:32,000 --> 00:09:33,600
and that's giving you some crazy output

249
00:09:33,600 --> 00:09:35,760
right but it's just an example of like

250
00:09:35,760 --> 00:09:39,680
how you can stack these operations

251
00:09:41,040 --> 00:09:44,160
and so the layout um in that recipe pane

252
00:09:44,160 --> 00:09:46,160
you have options to

253
00:09:46,160 --> 00:09:48,080
save the recipe

254
00:09:48,080 --> 00:09:49,440
load the recipe

255
00:09:49,440 --> 00:09:51,600
or just delete not really delete the

256
00:09:51,600 --> 00:09:53,519
recipe but you're deleting what's on the

257
00:09:53,519 --> 00:09:54,959
screen there

258
00:09:54,959 --> 00:09:56,880
you can also delete what's on the screen

259
00:09:56,880 --> 00:09:58,320
in the recipe section just by double

260
00:09:58,320 --> 00:10:00,320
clicking the recipe

261
00:10:00,320 --> 00:10:03,360
and then the input pane has a new tab

262
00:10:03,360 --> 00:10:05,200
and i can't even tell you how long i use

263
00:10:05,200 --> 00:10:06,560
cyber chef before i realize you could

264
00:10:06,560 --> 00:10:09,279
have multiple tabs open in there so

265
00:10:09,279 --> 00:10:11,279
just all the things you learn

266
00:10:11,279 --> 00:10:13,680
open a folder open a file you know these

267
00:10:13,680 --> 00:10:16,560
are as input of course reset the input

268
00:10:16,560 --> 00:10:18,240
screen

269
00:10:18,240 --> 00:10:20,240
and reset the layout and then on the

270
00:10:20,240 --> 00:10:23,360
output side you can save copy

271
00:10:23,360 --> 00:10:24,480
move

272
00:10:24,480 --> 00:10:26,320
to the input pane so basically what's on

273
00:10:26,320 --> 00:10:28,399
the output moves up to the input which

274
00:10:28,399 --> 00:10:29,920
is useful sometimes

275
00:10:29,920 --> 00:10:31,920
and then also you can maximize that

276
00:10:31,920 --> 00:10:33,519
output pain if you're trying to get you

277
00:10:33,519 --> 00:10:36,560
know a bigger look at it

278
00:10:37,200 --> 00:10:38,880
and then cyber chef has something that's

279
00:10:38,880 --> 00:10:41,600
called magic and

280
00:10:41,600 --> 00:10:44,000
basically it's a little like

281
00:10:44,000 --> 00:10:45,600
i don't know what is that a magic wand i

282
00:10:45,600 --> 00:10:48,720
guess um a little magic wand that lets

283
00:10:48,720 --> 00:10:50,240
you um

284
00:10:50,240 --> 00:10:52,959
kind of well let's cyber chef take a

285
00:10:52,959 --> 00:10:54,880
crack at whatever it is you're maybe

286
00:10:54,880 --> 00:10:57,839
you're trying to do right so so let's do

287
00:10:57,839 --> 00:11:01,839
a for example on that one whoops

288
00:11:02,480 --> 00:11:03,580
okay so

289
00:11:03,580 --> 00:11:05,760
[Music]

290
00:11:05,760 --> 00:11:09,600
i have an example over here

291
00:11:12,160 --> 00:11:14,800
so i'm going to copy this hash

292
00:11:14,800 --> 00:11:17,519
and throw it in the input

293
00:11:17,519 --> 00:11:20,079
and i'm running cyber chef locally here

294
00:11:20,079 --> 00:11:21,680
as you can see this is like a version

295
00:11:21,680 --> 00:11:23,680
number if this wasn't local it would

296
00:11:23,680 --> 00:11:25,839
just basically say download cyber chef

297
00:11:25,839 --> 00:11:27,680
here where the version number is but i

298
00:11:27,680 --> 00:11:29,760
like to write it locally it stores all

299
00:11:29,760 --> 00:11:30,560
your

300
00:11:30,560 --> 00:11:32,720
recipes in the cyber chef folder which

301
00:11:32,720 --> 00:11:34,399
is kind of handy because

302
00:11:34,399 --> 00:11:36,560
they're there then um forever pretty

303
00:11:36,560 --> 00:11:37,360
much

304
00:11:37,360 --> 00:11:38,320
so

305
00:11:38,320 --> 00:11:40,240
um oh and it's not going to give me the

306
00:11:40,240 --> 00:11:41,200
magic

307
00:11:41,200 --> 00:11:43,360
hold on

308
00:11:43,360 --> 00:11:45,200
let's do that

309
00:11:45,200 --> 00:11:48,160
i'll put a still

310
00:11:50,399 --> 00:11:52,320
there we go so

311
00:11:52,320 --> 00:11:54,560
it's giving me a little magic thing and

312
00:11:54,560 --> 00:11:55,519
if i

313
00:11:55,519 --> 00:11:58,079
hover over it hover over it over

314
00:11:58,079 --> 00:12:00,639
whatever i can't say it um

315
00:12:00,639 --> 00:12:03,600
uh it's telling me from hex will produce

316
00:12:03,600 --> 00:12:06,000
b-sides charm it's like a hint and i'm

317
00:12:06,000 --> 00:12:08,320
like oh okay so let me go over here and

318
00:12:08,320 --> 00:12:12,079
do from hex and lo and behold it says

319
00:12:12,079 --> 00:12:14,320
besides charm this does not always work

320
00:12:14,320 --> 00:12:15,839
and the next example i'm going to show

321
00:12:15,839 --> 00:12:19,440
you you'll see where it doesn't work

322
00:12:20,079 --> 00:12:23,079
okay

323
00:12:25,279 --> 00:12:27,600
um actually before i dive into well no

324
00:12:27,600 --> 00:12:31,200
let's go ahead and do the next example

325
00:12:32,959 --> 00:12:35,440
so we're going to start cooking

326
00:12:35,440 --> 00:12:38,720
and this is where we're going to um

327
00:12:38,720 --> 00:12:41,360
use cyber chef to analyze a hash so you

328
00:12:41,360 --> 00:12:42,639
know how sometimes you'll get like a

329
00:12:42,639 --> 00:12:44,160
list of hashes and you're like i don't

330
00:12:44,160 --> 00:12:47,040
know if this is md5 or shaw or whatever

331
00:12:47,040 --> 00:12:48,639
you know if they're not identified if

332
00:12:48,639 --> 00:12:50,079
it's long i'm like oh it's probably

333
00:12:50,079 --> 00:12:52,480
sha256 but it could be shaw one i can't

334
00:12:52,480 --> 00:12:54,800
remember exactly what they look like um

335
00:12:54,800 --> 00:12:56,800
so you can use it for that

336
00:12:56,800 --> 00:13:00,479
so let's let's try this

337
00:13:00,800 --> 00:13:02,880
i'm going to take this hash and we'd

338
00:13:02,880 --> 00:13:05,360
want to take a guess what hash that is

339
00:13:05,360 --> 00:13:07,440
what algorithm

340
00:13:07,440 --> 00:13:08,880
hold on let me put it in here so you can

341
00:13:08,880 --> 00:13:11,439
actually see it

342
00:13:13,040 --> 00:13:14,000
what

343
00:13:14,000 --> 00:13:15,839
shot 256

344
00:13:15,839 --> 00:13:17,279
i think that seems reasonable it looks

345
00:13:17,279 --> 00:13:18,560
pretty long right

346
00:13:18,560 --> 00:13:19,600
um

347
00:13:19,600 --> 00:13:20,800
so let me

348
00:13:20,800 --> 00:13:22,800
actually clear this first and then put

349
00:13:22,800 --> 00:13:25,199
this in

350
00:13:25,760 --> 00:13:27,360
okay well

351
00:13:27,360 --> 00:13:29,279
from hex is clearly not the operation

352
00:13:29,279 --> 00:13:30,720
that we want to use let's get rid of

353
00:13:30,720 --> 00:13:31,519
that

354
00:13:31,519 --> 00:13:34,160
um so let's see what cyber chefs tells

355
00:13:34,160 --> 00:13:37,440
us for the magic on this one

356
00:13:37,440 --> 00:13:38,560
and it says

357
00:13:38,560 --> 00:13:41,760
from hex will produce um something that

358
00:13:41,760 --> 00:13:44,160
i cannot possibly say so sometimes that

359
00:13:44,160 --> 00:13:46,320
magic thing is not right right it's

360
00:13:46,320 --> 00:13:48,880
thinking it's x but it's and i guess

361
00:13:48,880 --> 00:13:52,079
technically it is hex but but not uh hex

362
00:13:52,079 --> 00:13:54,320
encoding so instead we want to do an

363
00:13:54,320 --> 00:13:56,800
operation which is um

364
00:13:56,800 --> 00:14:01,040
i think it's analyze hash yes

365
00:14:01,600 --> 00:14:04,880
only because it is a british tool the

366
00:14:04,880 --> 00:14:07,279
words are british so that might be

367
00:14:07,279 --> 00:14:09,279
confusing for some people i'm like why

368
00:14:09,279 --> 00:14:11,360
do they spell analyze like that anyway

369
00:14:11,360 --> 00:14:13,279
but that's why so yes so we see here

370
00:14:13,279 --> 00:14:16,880
that the answer is indeed uh it's a

371
00:14:16,880 --> 00:14:18,880
to shaw 256. there are other

372
00:14:18,880 --> 00:14:21,040
possibilities too but i think

373
00:14:21,040 --> 00:14:23,040
generally speaking we would go with shaw

374
00:14:23,040 --> 00:14:25,760
256 and not panama

375
00:14:25,760 --> 00:14:28,560
whatever um so anyway i've never even

376
00:14:28,560 --> 00:14:30,800
heard of a of my hash

377
00:14:30,800 --> 00:14:34,079
so let's get back into this so i want to

378
00:14:34,079 --> 00:14:35,279
just kind of

379
00:14:35,279 --> 00:14:37,279
skim through some of these and just give

380
00:14:37,279 --> 00:14:38,800
you a taste of

381
00:14:38,800 --> 00:14:39,760
just the

382
00:14:39,760 --> 00:14:41,600
the breadth and

383
00:14:41,600 --> 00:14:43,680
depth of things that you can do in here

384
00:14:43,680 --> 00:14:46,720
so data formatting this is like the hex

385
00:14:46,720 --> 00:14:48,240
stuff that we've already talked about

386
00:14:48,240 --> 00:14:50,720
you could do decimal conversions

387
00:14:50,720 --> 00:14:53,440
um binary octal

388
00:14:53,440 --> 00:14:56,720
all the bases that you can think of um

389
00:14:56,720 --> 00:14:59,120
so on and so forth all kinds of things

390
00:14:59,120 --> 00:15:00,000
so

391
00:15:00,000 --> 00:15:01,519
like i don't even know what some of

392
00:15:01,519 --> 00:15:02,959
these things are and i haven't had a

393
00:15:02,959 --> 00:15:04,959
chance to like try every single thing

394
00:15:04,959 --> 00:15:06,800
it's kind of like kali linux right kelly

395
00:15:06,800 --> 00:15:08,880
has like a million tools in it and i

396
00:15:08,880 --> 00:15:10,959
personally have not tried all of them

397
00:15:10,959 --> 00:15:13,279
has anybody here tried all the tools in

398
00:15:13,279 --> 00:15:14,720
kali linux

399
00:15:14,720 --> 00:15:17,199
no no it's like impossible i think same

400
00:15:17,199 --> 00:15:19,199
thing with cyber chef so and you kind of

401
00:15:19,199 --> 00:15:21,600
have to have like a use case to to do

402
00:15:21,600 --> 00:15:23,199
these things oh one thing i want to

403
00:15:23,199 --> 00:15:26,079
mention too about cyber chef is it's

404
00:15:26,079 --> 00:15:28,240
awesome for cyber competitions does

405
00:15:28,240 --> 00:15:31,600
anybody here do cyber competitions

406
00:15:31,600 --> 00:15:33,519
really just a few people if you're not

407
00:15:33,519 --> 00:15:35,040
doing them you should be doing them

408
00:15:35,040 --> 00:15:37,680
they're so much fun but anyway it's a

409
00:15:37,680 --> 00:15:39,519
super useful tool for cyber competitions

410
00:15:39,519 --> 00:15:41,199
you can solve all kinds of challenges

411
00:15:41,199 --> 00:15:42,880
using cyber chef

412
00:15:42,880 --> 00:15:46,639
so it's like one stop shop okay so um so

413
00:15:46,639 --> 00:15:50,560
lots and lots of different kinds of um

414
00:15:50,560 --> 00:15:52,639
data formatting things there and then

415
00:15:52,639 --> 00:15:54,560
encryption and encoding like you can

416
00:15:54,560 --> 00:15:58,240
encode decode encrypt decrypt all these

417
00:15:58,240 --> 00:16:00,079
different things right so

418
00:16:00,079 --> 00:16:02,639
rc4 for example that's one that we see a

419
00:16:02,639 --> 00:16:06,079
lot like in malware activity um so this

420
00:16:06,079 --> 00:16:07,920
is pretty useful you can throw it in

421
00:16:07,920 --> 00:16:10,480
combine it with other operations xor is

422
00:16:10,480 --> 00:16:12,639
also something that we see a lot of in

423
00:16:12,639 --> 00:16:15,040
malware operations so that's another

424
00:16:15,040 --> 00:16:17,680
good one but yeah just um

425
00:16:17,680 --> 00:16:20,320
you know if you need a feed and cipher

426
00:16:20,320 --> 00:16:22,320
you could get that here i don't know why

427
00:16:22,320 --> 00:16:23,759
you would need it except for a cyber

428
00:16:23,759 --> 00:16:25,519
competition but anyway you get the idea

429
00:16:25,519 --> 00:16:26,800
i'm not going to show you every single

430
00:16:26,800 --> 00:16:30,079
one but it's very very extensive

431
00:16:30,079 --> 00:16:32,639
public key same kind of idea you can

432
00:16:32,639 --> 00:16:36,000
also do key verification in here which i

433
00:16:36,000 --> 00:16:37,759
actually just did that recently and it

434
00:16:37,759 --> 00:16:41,120
worked pretty handily so

435
00:16:41,120 --> 00:16:42,959
okay um

436
00:16:42,959 --> 00:16:45,199
arithmetic and logic so this is useful

437
00:16:45,199 --> 00:16:46,639
too um

438
00:16:46,639 --> 00:16:48,639
the xoring we already talked about but

439
00:16:48,639 --> 00:16:51,279
the ending and ordering and nodding and

440
00:16:51,279 --> 00:16:52,880
all that kind of stuff you can do in

441
00:16:52,880 --> 00:16:54,480
here you can just do straight up math

442
00:16:54,480 --> 00:16:56,480
too but i don't think i would open cyber

443
00:16:56,480 --> 00:16:58,560
chef just to do like a multiplication

444
00:16:58,560 --> 00:17:00,240
thing because google will do that for me

445
00:17:00,240 --> 00:17:02,000
i just have to say like

446
00:17:02,000 --> 00:17:02,959
um

447
00:17:02,959 --> 00:17:03,839
four

448
00:17:03,839 --> 00:17:05,679
times 20.

449
00:17:05,679 --> 00:17:07,039
this one i could actually do in my head

450
00:17:07,039 --> 00:17:07,919
but

451
00:17:07,919 --> 00:17:10,559
um oh look it's 80. yay so that's

452
00:17:10,559 --> 00:17:12,319
probably faster than launching

453
00:17:12,319 --> 00:17:13,839
uh cyber chef

454
00:17:13,839 --> 00:17:16,319
but you get the idea

455
00:17:16,319 --> 00:17:18,559
and what else

456
00:17:18,559 --> 00:17:21,520
uh networking so

457
00:17:21,520 --> 00:17:23,760
if you are aware of me at all you will

458
00:17:23,760 --> 00:17:25,599
know that my very favorite tool in the

459
00:17:25,599 --> 00:17:28,720
world is wireshark and i love network uh

460
00:17:28,720 --> 00:17:31,760
forensics it's like my favorite thing um

461
00:17:31,760 --> 00:17:33,919
so ask me questions about packets

462
00:17:33,919 --> 00:17:36,080
anytime i love that and i have managed

463
00:17:36,080 --> 00:17:37,840
to weave some wireshark into this

464
00:17:37,840 --> 00:17:40,880
demonstration so stay tuned for that

465
00:17:40,880 --> 00:17:43,039
anyway um so there's lots of things you

466
00:17:43,039 --> 00:17:45,600
can do in here networking wise

467
00:17:45,600 --> 00:17:48,000
you know doing an http request like i

468
00:17:48,000 --> 00:17:49,600
want to check out some

469
00:17:49,600 --> 00:17:52,080
website maybe and not necessarily you

470
00:17:52,080 --> 00:17:52,799
know

471
00:17:52,799 --> 00:17:56,639
go to the website i could do it here

472
00:17:56,960 --> 00:17:59,760
parsing all kinds of headers url

473
00:17:59,760 --> 00:18:01,600
encoding and decoding that's something

474
00:18:01,600 --> 00:18:02,960
you'll see a lot of

475
00:18:02,960 --> 00:18:04,799
in network traffic it's kind of nice to

476
00:18:04,799 --> 00:18:06,480
do a quick decode here

477
00:18:06,480 --> 00:18:07,840
if you need to

478
00:18:07,840 --> 00:18:08,960
um

479
00:18:08,960 --> 00:18:11,760
ip formats grouping ip addresses this is

480
00:18:11,760 --> 00:18:14,480
kind of cool so if you have like a list

481
00:18:14,480 --> 00:18:16,480
of ip addresses and you want to know

482
00:18:16,480 --> 00:18:18,880
like which ones are in which subnet or

483
00:18:18,880 --> 00:18:20,880
whatever you can do that too so that's

484
00:18:20,880 --> 00:18:22,160
kind of fun

485
00:18:22,160 --> 00:18:24,480
um well it's fun for me

486
00:18:24,480 --> 00:18:26,640
defanging you can defang

487
00:18:26,640 --> 00:18:29,440
urls and ip addresses which is super

488
00:18:29,440 --> 00:18:31,280
handy i can't even tell you like how

489
00:18:31,280 --> 00:18:34,000
many times i've like copy pasta of

490
00:18:34,000 --> 00:18:36,480
course indicators from some document

491
00:18:36,480 --> 00:18:39,039
then i put them into like notepad and

492
00:18:39,039 --> 00:18:41,360
then do a find and replace to get rid of

493
00:18:41,360 --> 00:18:44,960
you know the periods or whatever um

494
00:18:44,960 --> 00:18:48,960
super tedious this is way faster

495
00:18:48,960 --> 00:18:51,600
okay and some language things this is

496
00:18:51,600 --> 00:18:54,840
actually the shortest section i think

497
00:18:54,840 --> 00:18:57,919
um and then a zillion utilities one of

498
00:18:57,919 --> 00:19:00,160
the ones i use a lot here is removing

499
00:19:00,160 --> 00:19:02,320
null bytes so like if you're looking at

500
00:19:02,320 --> 00:19:03,120
um

501
00:19:03,120 --> 00:19:04,799
say you um

502
00:19:04,799 --> 00:19:07,120
have like a powershell script that was

503
00:19:07,120 --> 00:19:08,720
like encoded or whatever and when it

504
00:19:08,720 --> 00:19:10,960
gets decoded it's got a bunch of little

505
00:19:10,960 --> 00:19:13,039
like dots and stuff in it which is kind

506
00:19:13,039 --> 00:19:14,799
of distracting just do the removed null

507
00:19:14,799 --> 00:19:18,320
bytes and it takes care of that for you

508
00:19:18,799 --> 00:19:20,960
you can do all kinds of case things you

509
00:19:20,960 --> 00:19:22,559
can do all kinds of

510
00:19:22,559 --> 00:19:26,400
data manipulation sorting uniqueing

511
00:19:26,400 --> 00:19:28,000
heading and tailing all that kind of

512
00:19:28,000 --> 00:19:31,520
stuff so many many things there

513
00:19:31,520 --> 00:19:34,160
then date and time this is just another

514
00:19:34,160 --> 00:19:36,240
kind of useful thing

515
00:19:36,240 --> 00:19:38,559
actually good for cts also like you get

516
00:19:38,559 --> 00:19:40,400
like a unix time stamp and have to say

517
00:19:40,400 --> 00:19:43,120
like what the time is and just regular

518
00:19:43,120 --> 00:19:44,320
time

519
00:19:44,320 --> 00:19:46,960
and then extractors so this is really

520
00:19:46,960 --> 00:19:50,559
cool um say you have a big blob of text

521
00:19:50,559 --> 00:19:52,000
or whatever and you want to pull out all

522
00:19:52,000 --> 00:19:54,559
the ip addresses all the domains

523
00:19:54,559 --> 00:19:56,400
whatever it'll do that for you

524
00:19:56,400 --> 00:19:57,840
automatically

525
00:19:57,840 --> 00:19:59,120
and

526
00:19:59,120 --> 00:20:01,840
file pass so on and so forth so i like

527
00:20:01,840 --> 00:20:03,440
that a lot too

528
00:20:03,440 --> 00:20:05,679
um all kinds of compression activities

529
00:20:05,679 --> 00:20:07,600
i'll have an example of that

530
00:20:07,600 --> 00:20:09,919
then all the hashing things so many

531
00:20:09,919 --> 00:20:12,400
hashes

532
00:20:13,039 --> 00:20:15,760
and code tidy which is pretty much what

533
00:20:15,760 --> 00:20:18,720
it sounds like but if you have some ugly

534
00:20:18,720 --> 00:20:20,559
looking code it'll it'll make it look

535
00:20:20,559 --> 00:20:22,960
nicer for you

536
00:20:22,960 --> 00:20:24,640
it doesn't help like with the actual

537
00:20:24,640 --> 00:20:26,400
code if there's issues with it but it

538
00:20:26,400 --> 00:20:28,480
will make it look good and then

539
00:20:28,480 --> 00:20:30,640
forensics which is one of my favorite

540
00:20:30,640 --> 00:20:34,720
things also um some exif operations here

541
00:20:34,720 --> 00:20:36,480
so i was thinking of this when nick was

542
00:20:36,480 --> 00:20:38,320
doing his talk too so cyber chef i'm

543
00:20:38,320 --> 00:20:40,159
going to have an example for you of

544
00:20:40,159 --> 00:20:44,159
looking at the ex of data in cyber chef

545
00:20:44,159 --> 00:20:46,480
multimedia

546
00:20:46,480 --> 00:20:48,000
and i'm going to be i'm almost at the

547
00:20:48,000 --> 00:20:49,039
end of this too because i don't want to

548
00:20:49,039 --> 00:20:51,760
like go on and on with this list but um

549
00:20:51,760 --> 00:20:52,960
so many things that you can do with

550
00:20:52,960 --> 00:20:55,600
multimedia manipulating images

551
00:20:55,600 --> 00:20:57,919
adding data to images all kinds of

552
00:20:57,919 --> 00:21:01,600
things flipping images

553
00:21:01,600 --> 00:21:02,880
and

554
00:21:02,880 --> 00:21:04,559
then there's other which i'm not really

555
00:21:04,559 --> 00:21:06,080
going to get into but there's lots of

556
00:21:06,080 --> 00:21:08,559
stuff there and then flow control

557
00:21:08,559 --> 00:21:09,919
which the main thing here i think that i

558
00:21:09,919 --> 00:21:13,679
like is uh forking but um anyway so that

559
00:21:13,679 --> 00:21:16,799
gives you like a general idea of just

560
00:21:16,799 --> 00:21:18,640
like how much stuff there is in cyber

561
00:21:18,640 --> 00:21:20,400
chef it's lots right

562
00:21:20,400 --> 00:21:22,880
all right so let's get back to this

563
00:21:22,880 --> 00:21:25,200
so we did this we determined it was a

564
00:21:25,200 --> 00:21:27,600
shaw 256.

565
00:21:27,600 --> 00:21:30,480
um so the encoding and decoding i kind

566
00:21:30,480 --> 00:21:32,559
of already showed you that one but let's

567
00:21:32,559 --> 00:21:34,320
just get rid of

568
00:21:34,320 --> 00:21:37,440
this stuff which i'll do by deleting

569
00:21:37,440 --> 00:21:38,880
delete that

570
00:21:38,880 --> 00:21:41,600
and let's say we want to do

571
00:21:41,600 --> 00:21:42,840
i'll

572
00:21:42,840 --> 00:21:46,000
do besides charm because i'm super

573
00:21:46,000 --> 00:21:47,840
original like that

574
00:21:47,840 --> 00:21:49,360
20 22

575
00:21:49,360 --> 00:21:50,720
and

576
00:21:50,720 --> 00:21:53,200
we'll say we want to

577
00:21:53,200 --> 00:21:55,440
do

578
00:21:55,679 --> 00:21:57,039
um

579
00:21:57,039 --> 00:21:59,440
well let's just do rot because you know

580
00:21:59,440 --> 00:22:01,120
rod is so much fun

581
00:22:01,120 --> 00:22:03,360
and there's a little button down here

582
00:22:03,360 --> 00:22:05,280
that you can see next to the bake and

583
00:22:05,280 --> 00:22:07,679
it's auto bake so technically i will

584
00:22:07,679 --> 00:22:10,159
have auto bake turned on you usually

585
00:22:10,159 --> 00:22:12,080
want to just because then it'll do the

586
00:22:12,080 --> 00:22:13,520
things automatically without you having

587
00:22:13,520 --> 00:22:15,360
to click the bake button the exception

588
00:22:15,360 --> 00:22:17,280
to that is if you're dealing with like a

589
00:22:17,280 --> 00:22:19,919
really big input um and you might want

590
00:22:19,919 --> 00:22:21,679
to like you know

591
00:22:21,679 --> 00:22:24,320
not do auto bake because it'll be

592
00:22:24,320 --> 00:22:26,559
kind of clogging things up all right so

593
00:22:26,559 --> 00:22:27,919
let's do some

594
00:22:27,919 --> 00:22:31,280
very unique rot13 and there's our output

595
00:22:31,280 --> 00:22:33,200
right so actually it's interesting it

596
00:22:33,200 --> 00:22:34,640
doesn't do the number just does the

597
00:22:34,640 --> 00:22:36,320
words but uh that makes sense because

598
00:22:36,320 --> 00:22:39,120
it's alphabetical anyway but i like this

599
00:22:39,120 --> 00:22:41,280
also for cyber competitions because

600
00:22:41,280 --> 00:22:43,679
sometimes the cyber competition people

601
00:22:43,679 --> 00:22:45,919
will try to trick you and do like rot

602
00:22:45,919 --> 00:22:48,240
something else besides 13 right so this

603
00:22:48,240 --> 00:22:50,799
is a good way to just easily like be

604
00:22:50,799 --> 00:22:53,200
like oh is it this is it this is this

605
00:22:53,200 --> 00:22:54,000
and

606
00:22:54,000 --> 00:22:56,720
you kind of can figure it out

607
00:22:56,720 --> 00:22:58,640
okay

608
00:22:58,640 --> 00:23:01,360
so that's that

609
00:23:01,360 --> 00:23:03,840
now making http requests i did mention

610
00:23:03,840 --> 00:23:05,039
this earlier but i'm going to give you

611
00:23:05,039 --> 00:23:06,640
an example

612
00:23:06,640 --> 00:23:07,520
so

613
00:23:07,520 --> 00:23:09,280
we're going to

614
00:23:09,280 --> 00:23:13,120
load the http request recipe

615
00:23:13,120 --> 00:23:16,400
and so i'll delete that

616
00:23:16,400 --> 00:23:18,080
and

617
00:23:18,080 --> 00:23:19,440
http

618
00:23:19,440 --> 00:23:20,799
i guess i could have favorited these

619
00:23:20,799 --> 00:23:23,840
that would have made sense

620
00:23:24,960 --> 00:23:29,520
and put that in here and then i have

621
00:23:29,520 --> 00:23:31,520
i actually have a recipe

622
00:23:31,520 --> 00:23:33,440
well am i going to use it yes i will use

623
00:23:33,440 --> 00:23:36,880
a recipe for this one

624
00:23:36,880 --> 00:23:38,159
because i have a couple of other things

625
00:23:38,159 --> 00:23:40,480
we're going to do

626
00:23:40,480 --> 00:23:43,600
but the url i'm going to go to is

627
00:23:43,600 --> 00:23:45,080
ipa

628
00:23:45,080 --> 00:23:48,080
api.com which is going to give me what

629
00:23:48,080 --> 00:23:50,640
do you think

630
00:23:50,640 --> 00:23:53,440
might be addressed exactly so let's bake

631
00:23:53,440 --> 00:23:55,600
that

632
00:23:55,600 --> 00:23:59,279
and we get down here

633
00:23:59,279 --> 00:24:02,240
basically the output from that um so

634
00:24:02,240 --> 00:24:04,480
it's telling me pretty specifically i'm

635
00:24:04,480 --> 00:24:06,480
in rockville there's my zip code it's

636
00:24:06,480 --> 00:24:08,880
got a lat long all that good stuff my

637
00:24:08,880 --> 00:24:11,520
provider and of course my ip address but

638
00:24:11,520 --> 00:24:13,760
let's load a recipe here so if i click

639
00:24:13,760 --> 00:24:16,880
on load it's going to pull up

640
00:24:16,880 --> 00:24:18,799
basically all my recipes and in this

641
00:24:18,799 --> 00:24:20,240
case i want to do

642
00:24:20,240 --> 00:24:24,159
this one that i created called http ip

643
00:24:24,159 --> 00:24:25,360
defeg

644
00:24:25,360 --> 00:24:26,240
and

645
00:24:26,240 --> 00:24:28,000
the way it works is it just shows you

646
00:24:28,000 --> 00:24:30,880
like what that recipe does so basically

647
00:24:30,880 --> 00:24:33,279
it's just plugging it in and then if you

648
00:24:33,279 --> 00:24:35,360
want to share recipes with people you

649
00:24:35,360 --> 00:24:37,039
can do it like this but you can also

650
00:24:37,039 --> 00:24:39,200
just share like that link that i will

651
00:24:39,200 --> 00:24:41,760
have after i run this operation

652
00:24:41,760 --> 00:24:43,200
or recipe

653
00:24:43,200 --> 00:24:45,120
so let's load that up

654
00:24:45,120 --> 00:24:48,158
and let's bake it

655
00:24:49,679 --> 00:24:53,120
okay so i have this output of

656
00:24:53,120 --> 00:24:55,919
the defend url there really should be

657
00:24:55,919 --> 00:24:58,000
screens on both sides i guess

658
00:24:58,000 --> 00:25:00,400
anyway if you want to move it's okay

659
00:25:00,400 --> 00:25:02,400
so so let me show you a cool thing here

660
00:25:02,400 --> 00:25:05,919
that you can do so i have http requests

661
00:25:05,919 --> 00:25:08,799
i have extracting ip addresses and then

662
00:25:08,799 --> 00:25:10,799
i have defanging ip addresses those

663
00:25:10,799 --> 00:25:12,159
three different

664
00:25:12,159 --> 00:25:14,480
operations in this particular recipe

665
00:25:14,480 --> 00:25:16,400
but i can set like a break point at each

666
00:25:16,400 --> 00:25:19,440
one of these so if i break it here then

667
00:25:19,440 --> 00:25:21,200
that just shows me that the output of

668
00:25:21,200 --> 00:25:22,799
that first

669
00:25:22,799 --> 00:25:24,080
operation

670
00:25:24,080 --> 00:25:26,000
i'll let that go again and then i can

671
00:25:26,000 --> 00:25:27,919
break it here and that's going to show

672
00:25:27,919 --> 00:25:28,640
me

673
00:25:28,640 --> 00:25:31,760
the ip address before i defend it right

674
00:25:31,760 --> 00:25:34,080
so so that's a really cool function too

675
00:25:34,080 --> 00:25:36,159
and then if i wanted to like just not do

676
00:25:36,159 --> 00:25:38,080
one of those things say all right i

677
00:25:38,080 --> 00:25:40,640
don't want to defang then you click on

678
00:25:40,640 --> 00:25:42,240
that circle with a line through it and

679
00:25:42,240 --> 00:25:44,640
that just basically pulls that one out

680
00:25:44,640 --> 00:25:47,520
of the operation

681
00:25:47,760 --> 00:25:52,158
okay so let's do another example

682
00:25:52,559 --> 00:25:54,159
so qr codes

683
00:25:54,159 --> 00:25:55,120
so

684
00:25:55,120 --> 00:25:57,520
how do we see what's behind the qr code

685
00:25:57,520 --> 00:26:00,159
do we just scan it and go to the link

686
00:26:00,159 --> 00:26:01,760
that's there

687
00:26:01,760 --> 00:26:02,870
somebody please say no

688
00:26:02,870 --> 00:26:05,440
[Laughter]

689
00:26:05,440 --> 00:26:08,159
no we don't um and and i think most of

690
00:26:08,159 --> 00:26:08,880
like

691
00:26:08,880 --> 00:26:10,559
photo apps and stuff are getting better

692
00:26:10,559 --> 00:26:12,720
about like at least showing you the i or

693
00:26:12,720 --> 00:26:14,799
the domain before it just automatically

694
00:26:14,799 --> 00:26:16,880
takes you there but you can also throw a

695
00:26:16,880 --> 00:26:21,200
qr code into cyber chef so let's do that

696
00:26:21,200 --> 00:26:22,799
so i'm going to use a recipe i created

697
00:26:22,799 --> 00:26:26,240
for this which is

698
00:26:26,240 --> 00:26:28,320
just delete that

699
00:26:28,320 --> 00:26:32,399
load recipe and it's going to be

700
00:26:32,559 --> 00:26:34,799
where's my qr code oh it's right there

701
00:26:34,799 --> 00:26:35,840
at the top

702
00:26:35,840 --> 00:26:37,200
load

703
00:26:37,200 --> 00:26:38,960
so you can see i've got parsevar code

704
00:26:38,960 --> 00:26:42,880
defang url http request to something

705
00:26:42,880 --> 00:26:46,320
and that's about it so let's use

706
00:26:46,320 --> 00:26:47,360
um

707
00:26:47,360 --> 00:26:50,000
open file for our input i'm going to

708
00:26:50,000 --> 00:26:53,840
load this qr code

709
00:26:54,400 --> 00:26:57,760
and say bake

710
00:26:58,000 --> 00:27:01,200
and what we've got is output of

711
00:27:01,200 --> 00:27:03,760
said this could be malicious.xyz records

712
00:27:03,760 --> 00:27:06,480
null but let's do the points here too

713
00:27:06,480 --> 00:27:07,520
so

714
00:27:07,520 --> 00:27:10,159
we parse the qr code

715
00:27:10,159 --> 00:27:13,919
oops why does that not break though

716
00:27:14,159 --> 00:27:16,240
oh is it not doing that oh auto big

717
00:27:16,240 --> 00:27:18,240
thank you

718
00:27:18,240 --> 00:27:22,159
um okay make it again

719
00:27:22,159 --> 00:27:24,080
all right so we'll break this here and

720
00:27:24,080 --> 00:27:27,200
so we can see this is the um domain

721
00:27:27,200 --> 00:27:28,960
that's basically behind that qr code

722
00:27:28,960 --> 00:27:30,880
which is one that i literally made up of

723
00:27:30,880 --> 00:27:33,440
course this could be malicious.xyz

724
00:27:33,440 --> 00:27:35,600
and just fun fact

725
00:27:35,600 --> 00:27:38,559
helpful hint if it's dot xyz i guarantee

726
00:27:38,559 --> 00:27:40,840
you it's malicious i've never seen a

727
00:27:40,840 --> 00:27:45,120
legit.xyz domain anyway um okay so

728
00:27:45,120 --> 00:27:47,520
so we could break it there

729
00:27:47,520 --> 00:27:50,000
and then the http request i did was just

730
00:27:50,000 --> 00:27:53,440
basically an api for doing dns

731
00:27:53,440 --> 00:27:56,640
uh lookups right in an s lookup thing so

732
00:27:56,640 --> 00:27:58,080
so that gave me

733
00:27:58,080 --> 00:28:00,640
not great results because i made up the

734
00:28:00,640 --> 00:28:03,919
domain um and then of course the uh

735
00:28:03,919 --> 00:28:06,640
defending piece at the end

736
00:28:06,640 --> 00:28:08,720
so yeah so it makes it really simple to

737
00:28:08,720 --> 00:28:11,520
like kind of do a lot of things in one

738
00:28:11,520 --> 00:28:12,640
like quick

739
00:28:12,640 --> 00:28:13,520
uh

740
00:28:13,520 --> 00:28:14,960
one quick recipe

741
00:28:14,960 --> 00:28:16,799
okay so let's do another one

742
00:28:16,799 --> 00:28:20,159
how am i doing on time oh i'm good

743
00:28:20,159 --> 00:28:21,760
okay so i mentioned there would be

744
00:28:21,760 --> 00:28:24,480
wireshark in this presentation just had

745
00:28:24,480 --> 00:28:26,640
to work it in somewhere so this is like

746
00:28:26,640 --> 00:28:29,039
a totally nerdy thing that cyberchef

747
00:28:29,039 --> 00:28:31,200
does that i love because i am a packing

748
00:28:31,200 --> 00:28:32,080
nerd

749
00:28:32,080 --> 00:28:33,840
but you can extract

750
00:28:33,840 --> 00:28:37,279
uh ipe headers and i haven't seen them

751
00:28:37,279 --> 00:28:39,840
do any other header extraction but i

752
00:28:39,840 --> 00:28:41,679
feel like that's something that would be

753
00:28:41,679 --> 00:28:45,200
good um also i didn't mention but cyber

754
00:28:45,200 --> 00:28:48,640
chef is um it's a project that's in

755
00:28:48,640 --> 00:28:50,720
active development anybody can like

756
00:28:50,720 --> 00:28:52,720
contribute to it you just like fork it

757
00:28:52,720 --> 00:28:55,679
and do your thing and whatnot so um so

758
00:28:55,679 --> 00:28:57,760
that's pretty cool so you could build

759
00:28:57,760 --> 00:29:00,159
all kinds of functionality in it

760
00:29:00,159 --> 00:29:03,440
okay so let's do this one

761
00:29:03,440 --> 00:29:04,960
so what we're going to do

762
00:29:04,960 --> 00:29:07,520
is go over to wireshark

763
00:29:07,520 --> 00:29:08,720
and

764
00:29:08,720 --> 00:29:10,559
you don't really need to see that much

765
00:29:10,559 --> 00:29:12,640
what i'm doing but but essentially what

766
00:29:12,640 --> 00:29:15,440
i'm going to do here i have just a

767
00:29:15,440 --> 00:29:16,960
random capture

768
00:29:16,960 --> 00:29:18,880
and i'm going to select

769
00:29:18,880 --> 00:29:21,600
the ip

770
00:29:21,840 --> 00:29:25,600
section here and i'm going to copy

771
00:29:25,600 --> 00:29:28,480
as a hex stream

772
00:29:28,480 --> 00:29:30,480
so that's just copying like you know all

773
00:29:30,480 --> 00:29:32,480
those bytes right there

774
00:29:32,480 --> 00:29:34,399
and then let's pop that back in over

775
00:29:34,399 --> 00:29:34,740
here

776
00:29:34,740 --> 00:29:36,399
[Music]

777
00:29:36,399 --> 00:29:38,799
delete

778
00:29:38,840 --> 00:29:42,080
paste delete

779
00:29:42,080 --> 00:29:44,799
and i don't need a recipe like a whole

780
00:29:44,799 --> 00:29:48,720
full blood because it's just parse

781
00:29:49,159 --> 00:29:52,480
ipv4 header

782
00:29:52,480 --> 00:29:53,600
and

783
00:29:53,600 --> 00:29:54,720
you get

784
00:29:54,720 --> 00:29:56,399
like literally

785
00:29:56,399 --> 00:29:58,880
let me pull this up a little bit

786
00:29:58,880 --> 00:30:00,720
the different header fields and whatnot

787
00:30:00,720 --> 00:30:03,200
so if you would imagine like a tcp or an

788
00:30:03,200 --> 00:30:05,600
ip header these are this is what it

789
00:30:05,600 --> 00:30:07,440
looks like right so i told you it's

790
00:30:07,440 --> 00:30:09,120
going to be nerdy but i love this kind

791
00:30:09,120 --> 00:30:10,720
of thing and i want to build it for like

792
00:30:10,720 --> 00:30:13,760
tcp and udp and all that but i don't

793
00:30:13,760 --> 00:30:15,440
know when that's going to happen so i

794
00:30:15,440 --> 00:30:16,799
don't know about you all during the

795
00:30:16,799 --> 00:30:18,640
pandemic but

796
00:30:18,640 --> 00:30:21,279
i did a few things my hair got way

797
00:30:21,279 --> 00:30:22,960
longer so like if you saw me before it

798
00:30:22,960 --> 00:30:25,440
was much shorter i got lasik as i

799
00:30:25,440 --> 00:30:28,000
mentioned i got like five new tattoos

800
00:30:28,000 --> 00:30:30,399
because my tattoo guy was still working

801
00:30:30,399 --> 00:30:31,760
and uh

802
00:30:31,760 --> 00:30:33,760
anyway and what else did i do

803
00:30:33,760 --> 00:30:36,559
um oh yeah i started gardening like

804
00:30:36,559 --> 00:30:39,279
crazy we built an addition to our house

805
00:30:39,279 --> 00:30:41,120
our contractor built an addition to our

806
00:30:41,120 --> 00:30:42,960
house and

807
00:30:42,960 --> 00:30:45,919
and i got pandemic chickens so

808
00:30:45,919 --> 00:30:48,799
i'm like more busy doing things like not

809
00:30:48,799 --> 00:30:50,720
hands-on keys these days which is a good

810
00:30:50,720 --> 00:30:52,799
thing i didn't do this stuff before i

811
00:30:52,799 --> 00:30:53,600
think

812
00:30:53,600 --> 00:30:56,080
because i was always traveling and that

813
00:30:56,080 --> 00:30:58,480
came to a screeching halt of course so

814
00:30:58,480 --> 00:31:00,320
so yeah i think you know that was like

815
00:31:00,320 --> 00:31:03,279
an upside of the pandemic for me is just

816
00:31:03,279 --> 00:31:05,360
being able to um

817
00:31:05,360 --> 00:31:07,919
not endlessly be on the computer but

818
00:31:07,919 --> 00:31:09,360
anyway i'm also supposed to be writing a

819
00:31:09,360 --> 00:31:11,279
book i have a contract i've written like

820
00:31:11,279 --> 00:31:13,600
one and a half chapters in a year so i

821
00:31:13,600 --> 00:31:15,600
don't know when i'm going to finish that

822
00:31:15,600 --> 00:31:18,880
one day maybe it's about packet analysis

823
00:31:18,880 --> 00:31:23,360
um okay so let's see where were we

824
00:31:24,399 --> 00:31:27,600
okay so a block of ip addresses and i

825
00:31:27,600 --> 00:31:29,200
feel like this one is going to resonate

826
00:31:29,200 --> 00:31:30,799
with a lot of people

827
00:31:30,799 --> 00:31:31,519
so

828
00:31:31,519 --> 00:31:33,279
you have a report

829
00:31:33,279 --> 00:31:35,039
that somebody wrote and it has a bunch

830
00:31:35,039 --> 00:31:36,880
of indicators on it and you're like i

831
00:31:36,880 --> 00:31:40,240
need these indicators um so

832
00:31:40,240 --> 00:31:42,000
there is still going to be some copy

833
00:31:42,000 --> 00:31:44,799
pasting involved with this but it's

834
00:31:44,799 --> 00:31:47,039
definitely better than like how i ever

835
00:31:47,039 --> 00:31:49,279
did this before so

836
00:31:49,279 --> 00:31:52,240
i have up here

837
00:31:52,240 --> 00:31:54,960
where is it this one hot off the press

838
00:31:54,960 --> 00:31:57,840
fbi flash on uh black cat alpha v

839
00:31:57,840 --> 00:31:59,760
ransomware this came out this week does

840
00:31:59,760 --> 00:32:01,519
anybody get these

841
00:32:01,519 --> 00:32:04,480
fbi alerts yeah they're super useful if

842
00:32:04,480 --> 00:32:06,320
you don't get them there's a number of

843
00:32:06,320 --> 00:32:08,080
different places where you can sign up

844
00:32:08,080 --> 00:32:11,919
i'm a big fan of um the new jersey kick

845
00:32:11,919 --> 00:32:14,720
of all things like they have

846
00:32:14,720 --> 00:32:17,120
a really good service of sending out

847
00:32:17,120 --> 00:32:19,360
things like scissor reports and

848
00:32:19,360 --> 00:32:21,360
fbi reports and

849
00:32:21,360 --> 00:32:22,480
whatever

850
00:32:22,480 --> 00:32:24,000
and they also have a really good like

851
00:32:24,000 --> 00:32:25,600
repository of information about

852
00:32:25,600 --> 00:32:27,440
different threats so highly recommend

853
00:32:27,440 --> 00:32:28,880
new jersey kick

854
00:32:28,880 --> 00:32:32,320
and i'm pretty sure anybody can join um

855
00:32:32,320 --> 00:32:33,760
well i don't know if you said like

856
00:32:33,760 --> 00:32:35,240
terrorist at

857
00:32:35,240 --> 00:32:37,600
iran.com maybe they would not let you

858
00:32:37,600 --> 00:32:39,840
join i'm not sure but uh there probably

859
00:32:39,840 --> 00:32:41,840
is some level of vetting

860
00:32:41,840 --> 00:32:43,519
okay so let's see

861
00:32:43,519 --> 00:32:44,240
so

862
00:32:44,240 --> 00:32:46,480
la la la all the information and then we

863
00:32:46,480 --> 00:32:48,960
get to the indicator section

864
00:32:48,960 --> 00:32:52,640
and i want these ip addresses so i'm

865
00:32:52,640 --> 00:32:54,960
going to you know as we security

866
00:32:54,960 --> 00:32:56,720
researchers do

867
00:32:56,720 --> 00:32:58,960
copy

868
00:32:58,960 --> 00:33:02,399
and paste but instead of pasting it into

869
00:33:02,399 --> 00:33:04,240
um

870
00:33:04,240 --> 00:33:07,200
like a notepad or whatever

871
00:33:07,200 --> 00:33:08,559
i'm going to

872
00:33:08,559 --> 00:33:11,200
actually paste it into cyber chef

873
00:33:11,200 --> 00:33:12,080
and so

874
00:33:12,080 --> 00:33:13,840
look i still have a jumbled up list of

875
00:33:13,840 --> 00:33:16,640
ip addresses not fabulous right that's

876
00:33:16,640 --> 00:33:18,640
hard for me to do anything with so i'm

877
00:33:18,640 --> 00:33:20,640
going to run

878
00:33:20,640 --> 00:33:22,159
a recipe

879
00:33:22,159 --> 00:33:25,440
which is ip block

880
00:33:25,440 --> 00:33:26,320
and

881
00:33:26,320 --> 00:33:27,760
this is going to do a bunch of stuff for

882
00:33:27,760 --> 00:33:29,919
us

883
00:33:30,080 --> 00:33:32,399
and it comes out with the number 13.

884
00:33:32,399 --> 00:33:34,559
we're like what does that mean

885
00:33:34,559 --> 00:33:36,559
so i'll go through the steps for you but

886
00:33:36,559 --> 00:33:37,760
basically

887
00:33:37,760 --> 00:33:39,760
so the first thing we're going to do

888
00:33:39,760 --> 00:33:44,320
is a split so that's taking all that um

889
00:33:44,320 --> 00:33:46,720
dump of information and basically

890
00:33:46,720 --> 00:33:49,360
inserting a new line character after

891
00:33:49,360 --> 00:33:51,440
each one and you delineate

892
00:33:51,440 --> 00:33:53,840
what you know that that is going to be

893
00:33:53,840 --> 00:33:55,760
that you're using right so it could be a

894
00:33:55,760 --> 00:33:57,360
number of different things

895
00:33:57,360 --> 00:33:58,720
um

896
00:33:58,720 --> 00:33:59,679
then

897
00:33:59,679 --> 00:34:03,120
i'm going to sort it

898
00:34:03,120 --> 00:34:05,760
so now it's sorted for us

899
00:34:05,760 --> 00:34:06,559
and

900
00:34:06,559 --> 00:34:08,320
of course it still

901
00:34:08,320 --> 00:34:10,560
does it like just normal sorting number

902
00:34:10,560 --> 00:34:13,839
wise um so okay now i've got a nice list

903
00:34:13,839 --> 00:34:17,359
and okay i want to defang them

904
00:34:17,359 --> 00:34:19,520
because perhaps they're all malicious

905
00:34:19,520 --> 00:34:21,199
and i don't want to send somebody just

906
00:34:21,199 --> 00:34:23,359
you know malicious links that aren't uh

907
00:34:23,359 --> 00:34:24,399
defect

908
00:34:24,399 --> 00:34:26,320
and then the last thing that i did

909
00:34:26,320 --> 00:34:29,760
basically was account occurrences and

910
00:34:29,760 --> 00:34:31,359
this is just like doing like word count

911
00:34:31,359 --> 00:34:32,560
or something like a lot of the stuff

912
00:34:32,560 --> 00:34:34,399
you'll recognize is like command line

913
00:34:34,399 --> 00:34:37,040
kind of functions that you could run um

914
00:34:37,040 --> 00:34:38,639
and you could certainly like build

915
00:34:38,639 --> 00:34:40,239
scripts that basically do all these

916
00:34:40,239 --> 00:34:42,239
things too but it's just so convenient

917
00:34:42,239 --> 00:34:43,599
in cyber chef

918
00:34:43,599 --> 00:34:44,399
um

919
00:34:44,399 --> 00:34:47,199
so there's some regex here i am not a

920
00:34:47,199 --> 00:34:49,839
regex guru but it does give you like

921
00:34:49,839 --> 00:34:51,760
some possibilities of things that you

922
00:34:51,760 --> 00:34:52,879
could um

923
00:34:52,879 --> 00:34:53,918
plug in

924
00:34:53,918 --> 00:34:56,960
um but anyway yes and if you want to

925
00:34:56,960 --> 00:34:58,480
google like

926
00:34:58,480 --> 00:35:01,280
like ip address regex or whatever people

927
00:35:01,280 --> 00:35:02,800
have done this for you already so you

928
00:35:02,800 --> 00:35:04,240
don't have to like start from scratch

929
00:35:04,240 --> 00:35:08,960
they exist um anyway so we have

930
00:35:08,960 --> 00:35:11,760
13 ip addresses there so you get the

931
00:35:11,760 --> 00:35:14,839
idea right this whole like flow of

932
00:35:14,839 --> 00:35:18,720
things where's my water

933
00:35:26,960 --> 00:35:29,960
okay

934
00:35:32,160 --> 00:35:34,880
so now we're going to get into some some

935
00:35:34,880 --> 00:35:37,839
good stuff so

936
00:35:37,839 --> 00:35:40,880
anybody ever seen a powershell script

937
00:35:40,880 --> 00:35:43,680
that was base64 encoded that wasn't

938
00:35:43,680 --> 00:35:45,520
malicious

939
00:35:45,520 --> 00:35:47,680
yeah me either

940
00:35:47,680 --> 00:35:48,880
oh you have

941
00:35:48,880 --> 00:35:49,839
my

942
00:35:49,839 --> 00:35:51,599
engineers in

943
00:35:51,599 --> 00:35:54,000
germany

944
00:35:55,839 --> 00:35:59,440
yeah tell them not to do that

945
00:35:59,440 --> 00:36:01,680
i mean it's such an easy like uh

946
00:36:01,680 --> 00:36:03,200
countermeasure thing right like

947
00:36:03,200 --> 00:36:06,240
powershell plus base64 equals no don't

948
00:36:06,240 --> 00:36:07,920
do it

949
00:36:07,920 --> 00:36:09,680
that's a very simplistic countermeasure

950
00:36:09,680 --> 00:36:11,920
of course but um anyway so so we see

951
00:36:11,920 --> 00:36:15,680
this a lot with malicious activity um

952
00:36:15,680 --> 00:36:17,520
so in this case it's not really a very

953
00:36:17,520 --> 00:36:20,240
fancy one it's just powershell encoded

954
00:36:20,240 --> 00:36:21,440
blah

955
00:36:21,440 --> 00:36:23,760
so we're going to copy paste this into

956
00:36:23,760 --> 00:36:24,839
cyber

957
00:36:24,839 --> 00:36:28,240
chef of course

958
00:36:28,240 --> 00:36:30,480
now let me clear all that go over to my

959
00:36:30,480 --> 00:36:31,839
notes

960
00:36:31,839 --> 00:36:35,359
because this is a long one

961
00:36:37,359 --> 00:36:39,760
oops god i hate that it always does that

962
00:36:39,760 --> 00:36:41,920
no i don't want a dictionary definitely

963
00:36:41,920 --> 00:36:43,839
not for this content

964
00:36:43,839 --> 00:36:46,160
okay

965
00:36:46,800 --> 00:36:49,839
and let's pop it in

966
00:36:52,800 --> 00:36:54,560
bless you

967
00:36:54,560 --> 00:36:57,599
okay so we are going to do

968
00:36:57,599 --> 00:37:00,320
again a recipe that i built earlier

969
00:37:00,320 --> 00:37:02,560
in this case it is my

970
00:37:02,560 --> 00:37:07,320
base64 url defang recipe

971
00:37:10,079 --> 00:37:13,040
all right let's load that

972
00:37:13,040 --> 00:37:15,440
and

973
00:37:15,839 --> 00:37:17,760
again we have multiple

974
00:37:17,760 --> 00:37:20,000
operations happening in this example

975
00:37:20,000 --> 00:37:22,480
right so the first thing that we're

976
00:37:22,480 --> 00:37:24,640
going to do here is

977
00:37:24,640 --> 00:37:28,000
extract the base64 bit um

978
00:37:28,000 --> 00:37:30,240
which you know i could do manually by

979
00:37:30,240 --> 00:37:31,920
just like deleting all that kind of

980
00:37:31,920 --> 00:37:34,480
stuff but that's kind of a pain um so

981
00:37:34,480 --> 00:37:35,760
we're not doing that

982
00:37:35,760 --> 00:37:38,400
oops not that one

983
00:37:38,400 --> 00:37:40,640
and so you can see basically it's just

984
00:37:40,640 --> 00:37:42,560
gotten rid of everything that's not

985
00:37:42,560 --> 00:37:46,240
base64 encoding here

986
00:37:48,839 --> 00:37:51,440
and from there

987
00:37:51,440 --> 00:37:54,240
we are decoding this text so now we can

988
00:37:54,240 --> 00:37:56,320
see what that powershell command

989
00:37:56,320 --> 00:37:58,240
actually is right so

990
00:37:58,240 --> 00:37:59,760
essentially it's

991
00:37:59,760 --> 00:38:02,800
downloading a file from what is most

992
00:38:02,800 --> 00:38:04,640
likely a malicious website or a

993
00:38:04,640 --> 00:38:06,880
compromise website perhaps one or the

994
00:38:06,880 --> 00:38:08,160
other

995
00:38:08,160 --> 00:38:10,640
and

996
00:38:10,960 --> 00:38:14,079
then we're doing a find and replace just

997
00:38:14,079 --> 00:38:15,839
to um

998
00:38:15,839 --> 00:38:16,839
to pull

999
00:38:16,839 --> 00:38:18,400
out

1000
00:38:18,400 --> 00:38:22,960
the actual ip oh no not there hold on

1001
00:38:22,960 --> 00:38:24,800
find him replace what was i doing with

1002
00:38:24,800 --> 00:38:26,560
the find and replace here

1003
00:38:26,560 --> 00:38:28,320
i don't remember

1004
00:38:28,320 --> 00:38:30,320
something anyway

1005
00:38:30,320 --> 00:38:34,560
um and then yes

1006
00:38:34,640 --> 00:38:36,960
then we're extracting the urls

1007
00:38:36,960 --> 00:38:39,440
so there's the url that was in there and

1008
00:38:39,440 --> 00:38:41,280
then again defanging the url because

1009
00:38:41,280 --> 00:38:44,079
that's just good cyber hygiene right so

1010
00:38:44,079 --> 00:38:46,720
so that's uh the powershell one

1011
00:38:46,720 --> 00:38:50,560
and then i have another powershell one

1012
00:38:50,560 --> 00:38:53,119
so um this is a little more extensive

1013
00:38:53,119 --> 00:38:54,720
and and these are the kind of options

1014
00:38:54,720 --> 00:38:56,960
that i typically would see when i'm

1015
00:38:56,960 --> 00:38:58,800
looking at like a malicious powershell

1016
00:38:58,800 --> 00:39:00,240
script the other example was kind of

1017
00:39:00,240 --> 00:39:02,720
simplistic but we see some things

1018
00:39:02,720 --> 00:39:05,040
happening in here so we've got

1019
00:39:05,040 --> 00:39:06,880
in addition to the basics before

1020
00:39:06,880 --> 00:39:09,760
encoding you know it says here oops

1021
00:39:09,760 --> 00:39:11,520
sorry

1022
00:39:11,520 --> 00:39:14,480
from base64 string but we also have some

1023
00:39:14,480 --> 00:39:17,119
compression activity happening in here

1024
00:39:17,119 --> 00:39:18,880
so let's uh

1025
00:39:18,880 --> 00:39:22,160
take a look at this one

1026
00:39:22,480 --> 00:39:25,520
delete and delete and i could be opening

1027
00:39:25,520 --> 00:39:27,200
like new tabs like i talked about but

1028
00:39:27,200 --> 00:39:28,400
it's a little

1029
00:39:28,400 --> 00:39:30,480
cleaner for demonstration purposes if i

1030
00:39:30,480 --> 00:39:32,880
just stick with the one tab

1031
00:39:32,880 --> 00:39:34,160
okay

1032
00:39:34,160 --> 00:39:37,359
so let's copy this

1033
00:39:39,280 --> 00:39:42,280
okay

1034
00:39:42,960 --> 00:39:45,440
pop it in to cyber chef

1035
00:39:45,440 --> 00:39:48,880
and let's load our recipe

1036
00:39:49,920 --> 00:39:52,480
and let's do the basics before inflate

1037
00:39:52,480 --> 00:39:55,040
defang

1038
00:39:55,119 --> 00:39:56,200
look at whatever

1039
00:39:56,960 --> 00:40:00,640
okay so we've come up from all this with

1040
00:40:00,640 --> 00:40:04,560
a nice defend ip address which is a c2

1041
00:40:04,560 --> 00:40:07,839
right undoubtedly um so again let's kind

1042
00:40:07,839 --> 00:40:10,240
of take a look at the the different bits

1043
00:40:10,240 --> 00:40:11,520
um

1044
00:40:11,520 --> 00:40:15,359
we've got the base64 extracted there

1045
00:40:15,359 --> 00:40:20,160
now we're applying the raw inflate to it

1046
00:40:20,160 --> 00:40:24,040
oops oh no sorry

1047
00:40:24,240 --> 00:40:26,079
yes

1048
00:40:26,079 --> 00:40:27,200
oh yeah so

1049
00:40:27,200 --> 00:40:29,599
before we do the raw inflate the base64

1050
00:40:29,599 --> 00:40:31,680
looks like this which is puzzling

1051
00:40:31,680 --> 00:40:33,040
because you're like i know this is

1052
00:40:33,040 --> 00:40:35,680
base64 but why is it coming up as

1053
00:40:35,680 --> 00:40:37,280
gobbledygook if it's coming up as

1054
00:40:37,280 --> 00:40:40,720
gobbledygook it's probably because it is

1055
00:40:40,720 --> 00:40:43,599
compressed somehow so let's do a raw

1056
00:40:43,599 --> 00:40:46,240
inflate

1057
00:40:47,520 --> 00:40:49,359
and

1058
00:40:49,359 --> 00:40:50,720
then we can see

1059
00:40:50,720 --> 00:40:52,640
the whole like script here basically

1060
00:40:52,640 --> 00:40:54,000
right so

1061
00:40:54,000 --> 00:40:56,160
um we also want to

1062
00:40:56,160 --> 00:40:57,520
now

1063
00:40:57,520 --> 00:41:00,800
extract ip addresses and and then we do

1064
00:41:00,800 --> 00:41:04,160
fang them as well so what was kind of a

1065
00:41:04,160 --> 00:41:06,960
hard to process powershell script you

1066
00:41:06,960 --> 00:41:09,920
can pretty easily just dissect it using

1067
00:41:09,920 --> 00:41:11,839
cyber chef i mean i'm sure you could use

1068
00:41:11,839 --> 00:41:14,079
a python or something like that too but

1069
00:41:14,079 --> 00:41:16,880
but i like cyber chef as i've mentioned

1070
00:41:16,880 --> 00:41:17,680
um

1071
00:41:17,680 --> 00:41:19,520
did i say i like hypershaft yes i think

1072
00:41:19,520 --> 00:41:21,920
i did anyway actually one of the things

1073
00:41:21,920 --> 00:41:23,760
i think i want to start doing on my

1074
00:41:23,760 --> 00:41:25,599
github is is

1075
00:41:25,599 --> 00:41:29,119
start a repository of cyber chef recipes

1076
00:41:29,119 --> 00:41:30,640
i think that would be kind of cool i'm

1077
00:41:30,640 --> 00:41:32,880
sure other people do that too

1078
00:41:32,880 --> 00:41:34,319
although i haven't found like a ton of

1079
00:41:34,319 --> 00:41:37,760
them out there the guy matt um who was

1080
00:41:37,760 --> 00:41:39,920
the course person for that class i took

1081
00:41:39,920 --> 00:41:44,000
has a ton of different like examples um

1082
00:41:44,000 --> 00:41:45,920
but he doesn't always provide like the

1083
00:41:45,920 --> 00:41:48,480
input files so um

1084
00:41:48,480 --> 00:41:49,200
so

1085
00:41:49,200 --> 00:41:50,720
all the stuff for the most part were

1086
00:41:50,720 --> 00:41:52,800
things that i just like hunted around

1087
00:41:52,800 --> 00:41:55,520
for like a virus total or wherever

1088
00:41:55,520 --> 00:41:56,960
um okay

1089
00:41:56,960 --> 00:41:59,920
so let's see

1090
00:42:00,839 --> 00:42:05,839
okay let me go back to the deck

1091
00:42:06,160 --> 00:42:06,960
okay

1092
00:42:06,960 --> 00:42:09,440
so here's our exif data one that i said

1093
00:42:09,440 --> 00:42:13,359
we'd be doing and this is um a file

1094
00:42:13,359 --> 00:42:15,200
called dolls.jpg

1095
00:42:15,200 --> 00:42:17,280
and it's something that i created

1096
00:42:17,280 --> 00:42:20,000
for a cyber competition challenge right

1097
00:42:20,000 --> 00:42:20,800
so

1098
00:42:20,800 --> 00:42:22,960
um i'd like to take pictures of weird

1099
00:42:22,960 --> 00:42:25,200
things so i can use them for cyber

1100
00:42:25,200 --> 00:42:27,920
competitions basically so this dolls.jpg

1101
00:42:27,920 --> 00:42:31,920
has gotten a lot of a lot of use

1102
00:42:31,920 --> 00:42:33,920
anyway so

1103
00:42:33,920 --> 00:42:36,319
i think one of the things that i ask um

1104
00:42:36,319 --> 00:42:38,400
people is like where was this picture

1105
00:42:38,400 --> 00:42:42,240
taken i also asked like what's the model

1106
00:42:42,240 --> 00:42:44,880
of the camera so on and so forth so you

1107
00:42:44,880 --> 00:42:46,800
could absolutely check this out using

1108
00:42:46,800 --> 00:42:48,960
exif tool which is also one of my

1109
00:42:48,960 --> 00:42:50,880
favorite tools but you can also use

1110
00:42:50,880 --> 00:42:52,880
cyber chef for this

1111
00:42:52,880 --> 00:42:54,000
so

1112
00:42:54,000 --> 00:42:56,480
let's do that

1113
00:42:56,480 --> 00:42:59,680
all right so i'm going to open a file

1114
00:42:59,680 --> 00:43:02,680
dolls.jpg

1115
00:43:03,359 --> 00:43:05,520
and

1116
00:43:05,520 --> 00:43:07,920
we can see what magic says

1117
00:43:07,920 --> 00:43:09,760
render image will pro

1118
00:43:09,760 --> 00:43:11,760
do something let's try render image i

1119
00:43:11,760 --> 00:43:13,200
haven't actually done that i think it's

1120
00:43:13,200 --> 00:43:14,960
just going to show us the picture that

1121
00:43:14,960 --> 00:43:17,680
makes sense right

1122
00:43:20,800 --> 00:43:23,839
yes a very zoomed in version of the

1123
00:43:23,839 --> 00:43:25,920
picture i think it's even creepier now

1124
00:43:25,920 --> 00:43:29,599
we're like looking up a doll skirt

1125
00:43:30,000 --> 00:43:32,640
anyway um

1126
00:43:32,640 --> 00:43:34,960
okay so let's get rid of that recipe

1127
00:43:34,960 --> 00:43:38,880
uh so what we actually want to do is um

1128
00:43:38,880 --> 00:43:40,480
exif

1129
00:43:40,480 --> 00:43:43,280
extract exif but you could also remove

1130
00:43:43,280 --> 00:43:45,440
exif so i haven't tried it we'll have to

1131
00:43:45,440 --> 00:43:48,240
see how well it works um but extract

1132
00:43:48,240 --> 00:43:49,760
exif

1133
00:43:49,760 --> 00:43:53,200
and it's giving us it says here 50 tags

1134
00:43:53,200 --> 00:43:56,160
so lots and lots of data behind these

1135
00:43:56,160 --> 00:43:57,440
images right

1136
00:43:57,440 --> 00:43:58,480
and

1137
00:43:58,480 --> 00:44:01,359
so for example this is one that i

1138
00:44:01,359 --> 00:44:04,960
manipulated because it definitely didn't

1139
00:44:04,960 --> 00:44:06,560
and that's probably super hard to see

1140
00:44:06,560 --> 00:44:09,839
let me make it a little bigger again

1141
00:44:10,000 --> 00:44:11,680
okay

1142
00:44:11,680 --> 00:44:14,160
so yeah so i i manipulated this of

1143
00:44:14,160 --> 00:44:15,760
course um

1144
00:44:15,760 --> 00:44:17,440
just for fun

1145
00:44:17,440 --> 00:44:20,160
so the image description is no code

1146
00:44:20,160 --> 00:44:22,640
execution allowed here the make is

1147
00:44:22,640 --> 00:44:25,040
three-letter agency the model is spy

1148
00:44:25,040 --> 00:44:26,400
camera

1149
00:44:26,400 --> 00:44:28,000
i'll let you guess what three-letter

1150
00:44:28,000 --> 00:44:30,400
agency is associated with this none

1151
00:44:30,400 --> 00:44:32,079
really but you know you can use your

1152
00:44:32,079 --> 00:44:34,640
imagination and then we have gps

1153
00:44:34,640 --> 00:44:36,400
coordinates which is how you would

1154
00:44:36,400 --> 00:44:37,920
identify the

1155
00:44:37,920 --> 00:44:39,440
uh location

1156
00:44:39,440 --> 00:44:40,400
and

1157
00:44:40,400 --> 00:44:42,640
and then all this other stuff which i

1158
00:44:42,640 --> 00:44:44,800
still don't care about like the actual

1159
00:44:44,800 --> 00:44:46,880
like photograph part of it

1160
00:44:46,880 --> 00:44:49,680
um so yeah so this is super super easy

1161
00:44:49,680 --> 00:44:51,440
to do

1162
00:44:51,440 --> 00:44:53,040
the exif

1163
00:44:53,040 --> 00:44:55,520
analysis piece

1164
00:44:55,520 --> 00:44:56,880
okay

1165
00:44:56,880 --> 00:44:59,040
so

1166
00:44:59,040 --> 00:45:02,079
i have some time for questions i can

1167
00:45:02,079 --> 00:45:02,960
also

1168
00:45:02,960 --> 00:45:05,760
like take requests to try things

1169
00:45:05,760 --> 00:45:07,520
they may or may not work because this is

1170
00:45:07,520 --> 00:45:09,440
all live demo but if it starts being

1171
00:45:09,440 --> 00:45:11,040
like live demo where i wasn't even

1172
00:45:11,040 --> 00:45:12,960
planning it it might get a little crazy

1173
00:45:12,960 --> 00:45:14,480
um

1174
00:45:14,480 --> 00:45:17,599
and i think they said this goes till

1175
00:45:17,599 --> 00:45:21,520
noon but i'm not sure if it's nooner

1176
00:45:21,520 --> 00:45:23,599
oh one yeah okay it already is noon that

1177
00:45:23,599 --> 00:45:25,119
happened um

1178
00:45:25,119 --> 00:45:27,440
so yeah so i was planning to wrap up

1179
00:45:27,440 --> 00:45:29,760
around 10 minutes before four questions

1180
00:45:29,760 --> 00:45:31,280
or if people want to come up and like

1181
00:45:31,280 --> 00:45:32,400
try stuff

1182
00:45:32,400 --> 00:45:33,760
you could do that or if you have a

1183
00:45:33,760 --> 00:45:35,040
computer with you and you want to try

1184
00:45:35,040 --> 00:45:37,599
some stuff that's cool too

1185
00:45:37,599 --> 00:45:39,359
originally when i submitted this talk i

1186
00:45:39,359 --> 00:45:41,040
thought about doing it

1187
00:45:41,040 --> 00:45:41,839
as

1188
00:45:41,839 --> 00:45:44,240
a workshop

1189
00:45:44,240 --> 00:45:45,520
would you all be interested in the

1190
00:45:45,520 --> 00:45:46,480
workshop

1191
00:45:46,480 --> 00:45:48,240
like this like where you were doing

1192
00:45:48,240 --> 00:45:50,720
different operations and trying things

1193
00:45:50,720 --> 00:45:52,720
yeah okay i think i might do that at

1194
00:45:52,720 --> 00:45:54,720
some future event

1195
00:45:54,720 --> 00:45:55,680
um

1196
00:45:55,680 --> 00:45:58,319
also did i mention cyber jitsu con june

1197
00:45:58,319 --> 00:46:01,680
18th be there be square it's cool so

1198
00:46:01,680 --> 00:46:04,079
here's my info as i said i'm pretty much

1199
00:46:04,079 --> 00:46:06,480
marcel lee on like everything um my

1200
00:46:06,480 --> 00:46:09,440
medium is blogs mostly about cyber

1201
00:46:09,440 --> 00:46:12,400
competitions um with occasional other

1202
00:46:12,400 --> 00:46:15,599
things sprinkled in for good measure and

1203
00:46:15,599 --> 00:46:17,680
my linkedin you have to have my email

1204
00:46:17,680 --> 00:46:20,560
address to connect with me so that's

1205
00:46:20,560 --> 00:46:22,160
your first challenge

1206
00:46:22,160 --> 00:46:24,000
if you want to do some research you are

1207
00:46:24,000 --> 00:46:26,480
security research people right or want

1208
00:46:26,480 --> 00:46:27,680
to be

1209
00:46:27,680 --> 00:46:30,160
so it's not that hard to find my my

1210
00:46:30,160 --> 00:46:31,440
email address but you would need to do

1211
00:46:31,440 --> 00:46:34,079
that to connect with me um and then i'm

1212
00:46:34,079 --> 00:46:36,480
on twitter of course too so

1213
00:46:36,480 --> 00:46:38,560
so yeah so questions

1214
00:46:38,560 --> 00:46:42,599
ask me anything yes

1215
00:46:44,240 --> 00:46:46,400
yeah no you absolutely could do all this

1216
00:46:46,400 --> 00:46:48,560
in a script and not use cyber chef at

1217
00:46:48,560 --> 00:46:51,960
all oh

1218
00:46:52,710 --> 00:46:55,599
[Music]

1219
00:46:55,599 --> 00:46:59,200
yeah i don't know that's a good question

1220
00:46:59,200 --> 00:47:03,000
we'll have to look into that

1221
00:47:03,599 --> 00:47:06,000
command

1222
00:47:09,280 --> 00:47:11,760
so there's line scripts there

1223
00:47:11,760 --> 00:47:13,280
all right so if you didn't hear that uh

1224
00:47:13,280 --> 00:47:15,920
splunk has a

1225
00:47:15,920 --> 00:47:18,560
cyber chef integration interesting

1226
00:47:18,560 --> 00:47:20,319
there's actually different tools out

1227
00:47:20,319 --> 00:47:22,000
there um

1228
00:47:22,000 --> 00:47:23,280
i'm trying to think there's one i was

1229
00:47:23,280 --> 00:47:25,440
just using the other day like security

1230
00:47:25,440 --> 00:47:27,440
tools where they have cyber chef like

1231
00:47:27,440 --> 00:47:30,640
baked in to use so they're pretty common

1232
00:47:30,640 --> 00:47:35,400
um i don't know you with a hat

1233
00:47:40,880 --> 00:47:42,720
yes yes yes

1234
00:47:42,720 --> 00:47:46,078
did i not do that one okay

1235
00:47:46,240 --> 00:47:49,279
yeah let's try that

1236
00:47:50,640 --> 00:47:53,839
all right

1237
00:47:55,440 --> 00:47:59,440
uh i don't know let's try apples

1238
00:47:59,440 --> 00:48:00,559
grapes

1239
00:48:00,559 --> 00:48:02,240
bananas

1240
00:48:02,240 --> 00:48:03,839
whatever

1241
00:48:03,839 --> 00:48:07,440
okay and

1242
00:48:07,440 --> 00:48:10,480
let's do fork

1243
00:48:13,839 --> 00:48:14,800
and

1244
00:48:14,800 --> 00:48:16,880
then let's what operation do we want to

1245
00:48:16,880 --> 00:48:20,160
do let's say i don't know rot 13 or

1246
00:48:20,160 --> 00:48:22,799
something like that

1247
00:48:25,680 --> 00:48:27,440
yeah so

1248
00:48:27,440 --> 00:48:29,680
so i'm not sure if we needed the fork in

1249
00:48:29,680 --> 00:48:31,520
this case but that's how it would work

1250
00:48:31,520 --> 00:48:34,520
basically

1251
00:48:46,640 --> 00:48:49,040
right it could be either

1252
00:48:49,040 --> 00:48:50,960
oh i see what you're saying do two

1253
00:48:50,960 --> 00:48:53,920
different operations

1254
00:48:54,480 --> 00:48:55,520
yes

1255
00:48:55,520 --> 00:48:57,359
you definitely could do that there's a

1256
00:48:57,359 --> 00:48:59,200
whole section on

1257
00:48:59,200 --> 00:49:00,960
and i would have to like think about it

1258
00:49:00,960 --> 00:49:02,240
so i'm not going to try to do it right

1259
00:49:02,240 --> 00:49:03,440
now but

1260
00:49:03,440 --> 00:49:06,240
in this other section i think maybe

1261
00:49:06,240 --> 00:49:07,359
is

1262
00:49:07,359 --> 00:49:10,800
no not other where is it um

1263
00:49:10,800 --> 00:49:14,599
oh utilities maybe

1264
00:49:16,079 --> 00:49:17,920
i don't know where it is right now but

1265
00:49:17,920 --> 00:49:19,680
definitely there's options of things you

1266
00:49:19,680 --> 00:49:23,839
can do with fork and other like um tools

1267
00:49:23,839 --> 00:49:25,440
so great question so i don't know

1268
00:49:25,440 --> 00:49:27,119
exactly how to do it but

1269
00:49:27,119 --> 00:49:30,359
uh yes

1270
00:49:38,800 --> 00:49:43,200
um so just to identify the type of file

1271
00:49:43,200 --> 00:49:47,280
oh yeah yeah so you can do that um

1272
00:49:47,280 --> 00:49:49,440
i've never actually used it in here to

1273
00:49:49,440 --> 00:49:51,599
be honest because typically i just run

1274
00:49:51,599 --> 00:49:53,119
the file command

1275
00:49:53,119 --> 00:49:54,640
from command line but i think that

1276
00:49:54,640 --> 00:49:57,359
that's what this would do so let's

1277
00:49:57,359 --> 00:50:00,400
in the forensic section okay

1278
00:50:00,400 --> 00:50:01,599
all right

1279
00:50:01,599 --> 00:50:03,920
detect file type there we go

1280
00:50:03,920 --> 00:50:06,160
let's put that here

1281
00:50:06,160 --> 00:50:08,480
i'm going to delete that delete that

1282
00:50:08,480 --> 00:50:10,400
let's um

1283
00:50:10,400 --> 00:50:14,640
open up dolls again

1284
00:50:18,160 --> 00:50:20,720
oh thank you

1285
00:50:22,400 --> 00:50:26,400
there we go yes so it does do that

1286
00:50:26,400 --> 00:50:27,680
very good

1287
00:50:27,680 --> 00:50:30,160
thanks for the forensics tip

1288
00:50:30,160 --> 00:50:31,040
all right

1289
00:50:31,040 --> 00:50:32,960
any other questions i feel bad cause

1290
00:50:32,960 --> 00:50:34,240
like half the audience is leaving like

1291
00:50:34,240 --> 00:50:35,760
we don't have any questions oh nick

1292
00:50:35,760 --> 00:50:39,559
you're like behind my microphone

1293
00:50:40,790 --> 00:50:43,889
[Music]

1294
00:50:45,440 --> 00:50:47,760
no it's not so it's all

1295
00:50:47,760 --> 00:50:49,440
uh client-side everything is done

1296
00:50:49,440 --> 00:50:50,800
client-side

1297
00:50:50,800 --> 00:50:53,040
so that's super cool but especially if

1298
00:50:53,040 --> 00:50:55,599
you're doing it locally um you're

1299
00:50:55,599 --> 00:50:57,520
definitely golden so like right now i

1300
00:50:57,520 --> 00:50:59,440
wouldn't even need to be

1301
00:50:59,440 --> 00:51:01,520
um like you can see i'm just writing it

1302
00:51:01,520 --> 00:51:04,079
as a file on my local host and

1303
00:51:04,079 --> 00:51:06,000
everything is done

1304
00:51:06,000 --> 00:51:08,800
on this side my computer side so great

1305
00:51:08,800 --> 00:51:11,040
question thank you

1306
00:51:11,040 --> 00:51:15,040
all right any other questions

1307
00:51:15,040 --> 00:51:16,000
okay

1308
00:51:16,000 --> 00:51:18,960
well i think that that is it so

1309
00:51:18,960 --> 00:51:20,880
give you back five minutes of your life

1310
00:51:20,880 --> 00:51:22,559
and you can go to lunch early beach the

1311
00:51:22,559 --> 00:51:23,680
crowds

1312
00:51:23,680 --> 00:51:25,359
and thank you so much for coming i

1313
00:51:25,359 --> 00:51:27,160
really appreciate it

1314
00:51:27,160 --> 00:51:30,299
[Applause]

