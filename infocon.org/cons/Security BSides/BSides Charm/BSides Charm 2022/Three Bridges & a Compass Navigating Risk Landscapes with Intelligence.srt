1
00:00:24,320 --> 00:00:25,920
all right i think we're gonna go for it

2
00:00:25,920 --> 00:00:27,439
thanks everyone for showing up this

3
00:00:27,439 --> 00:00:29,840
morning thanks besides charm for

4
00:00:29,840 --> 00:00:31,679
inviting me and for a great past few

5
00:00:31,679 --> 00:00:34,079
days i'm gonna jump right into it so

6
00:00:34,079 --> 00:00:36,719
welcome to my talk this is titled three

7
00:00:36,719 --> 00:00:38,640
bridges and a compass

8
00:00:38,640 --> 00:00:40,640
my goal for today is to give you all

9
00:00:40,640 --> 00:00:42,800
some very practical workflows for

10
00:00:42,800 --> 00:00:45,120
applying intelligence to security

11
00:00:45,120 --> 00:00:46,640
efforts and along the way we'll have a

12
00:00:46,640 --> 00:00:48,640
chance to walk through a new open source

13
00:00:48,640 --> 00:00:50,879
data set and tool that i recently had a

14
00:00:50,879 --> 00:00:52,640
chance to publish it's live right now

15
00:00:52,640 --> 00:00:54,480
and it's all geared around what i

16
00:00:54,480 --> 00:00:56,079
mentioned trying to

17
00:00:56,079 --> 00:00:57,920
help organizations of pretty much any

18
00:00:57,920 --> 00:01:00,719
size at least think about how better to

19
00:01:00,719 --> 00:01:04,559
start applying intelligence to security

20
00:01:04,559 --> 00:01:06,000
real quick background my name is scott

21
00:01:06,000 --> 00:01:07,920
small i'm a senior threat intelligence

22
00:01:07,920 --> 00:01:10,000
consultant at recorded future so i'm

23
00:01:10,000 --> 00:01:12,400
part of our customer success team

24
00:01:12,400 --> 00:01:13,760
that means i'm out there having

25
00:01:13,760 --> 00:01:15,759
conversations with our clients

26
00:01:15,759 --> 00:01:17,680
government agencies large and medium

27
00:01:17,680 --> 00:01:20,159
enterprises every single day about

28
00:01:20,159 --> 00:01:22,000
intelligence and how it relates to

29
00:01:22,000 --> 00:01:24,640
security so i promise that everything

30
00:01:24,640 --> 00:01:26,560
i'm going to touch on today is derived

31
00:01:26,560 --> 00:01:28,479
from these conversations that i'm having

32
00:01:28,479 --> 00:01:30,560
with folks out there in the field and

33
00:01:30,560 --> 00:01:31,759
seeing some of the challenges that

34
00:01:31,759 --> 00:01:33,840
they're facing in applying intelligence

35
00:01:33,840 --> 00:01:36,159
to security and hopefully finding a few

36
00:01:36,159 --> 00:01:38,079
kind of workarounds for making that a

37
00:01:38,079 --> 00:01:41,439
little bit more streamlined

38
00:01:41,439 --> 00:01:42,560
a lot of what i'm going to touch on

39
00:01:42,560 --> 00:01:44,799
today involves the miter attack

40
00:01:44,799 --> 00:01:46,640
knowledge base so i do really want to

41
00:01:46,640 --> 00:01:48,640
quickly level set with everyone in terms

42
00:01:48,640 --> 00:01:50,720
of what is miter attack and i really

43
00:01:50,720 --> 00:01:52,079
want to kind of bring it down to earth a

44
00:01:52,079 --> 00:01:53,920
little bit i know it i'm we'll be the

45
00:01:53,920 --> 00:01:55,759
first to admit it's a bit of a scary and

46
00:01:55,759 --> 00:01:58,079
seemingly technical uh kind of framework

47
00:01:58,079 --> 00:02:00,479
or knowledge base but if we had to most

48
00:02:00,479 --> 00:02:02,640
simply boil it down the miter attack

49
00:02:02,640 --> 00:02:05,360
framework is simply a catalog of

50
00:02:05,360 --> 00:02:08,959
adversary behavior

51
00:02:08,959 --> 00:02:11,360
just to provide a little bit more detail

52
00:02:11,360 --> 00:02:13,120
often times you're going to see this

53
00:02:13,120 --> 00:02:15,200
knowledge base this catalog displayed in

54
00:02:15,200 --> 00:02:16,800
one of these matrix views this is just

55
00:02:16,800 --> 00:02:19,599
kind of a snippet of the overall matrix

56
00:02:19,599 --> 00:02:21,440
but i was thinking last night speaking

57
00:02:21,440 --> 00:02:23,280
with uh you know uh having a lot of

58
00:02:23,280 --> 00:02:25,120
conversations around you know the

59
00:02:25,120 --> 00:02:26,560
challenges and all the jargon that we

60
00:02:26,560 --> 00:02:28,239
use in the security field so i just

61
00:02:28,239 --> 00:02:29,760
wanted to kind of simplify a little bit

62
00:02:29,760 --> 00:02:31,680
of what is the moderate tech knowledge

63
00:02:31,680 --> 00:02:33,280
base trying to look at

64
00:02:33,280 --> 00:02:34,720
quite simply when you look at this

65
00:02:34,720 --> 00:02:37,680
matrix view the row at the very top are

66
00:02:37,680 --> 00:02:40,239
the end goals or objectives of what an

67
00:02:40,239 --> 00:02:42,959
adversary would be trying to accomplish

68
00:02:42,959 --> 00:02:45,360
and then the ways or means that they go

69
00:02:45,360 --> 00:02:46,239
about

70
00:02:46,239 --> 00:02:48,480
trying to accomplish those goals are

71
00:02:48,480 --> 00:02:50,160
organized vertically underneath it and i

72
00:02:50,160 --> 00:02:51,599
know this is really small text that's

73
00:02:51,599 --> 00:02:53,440
kind of intentional we'll get into the

74
00:02:53,440 --> 00:02:55,280
details of a few specific as they're

75
00:02:55,280 --> 00:02:57,280
called techniques uh the the columns

76
00:02:57,280 --> 00:02:59,360
arrange vertically here but again trying

77
00:02:59,360 --> 00:03:01,360
to simplify things this is what this big

78
00:03:01,360 --> 00:03:03,840
kind of uh seemingly complicated uh

79
00:03:03,840 --> 00:03:07,760
knowledge base or matrix is trying to do

80
00:03:07,760 --> 00:03:10,080
so yes let's look at one specific

81
00:03:10,080 --> 00:03:12,400
example and talk about the application

82
00:03:12,400 --> 00:03:14,640
of minor attack at least how i see it

83
00:03:14,640 --> 00:03:16,159
i'm not going to get into the history

84
00:03:16,159 --> 00:03:17,599
and some of the original uses of the

85
00:03:17,599 --> 00:03:19,280
attack framework it is used in a lot of

86
00:03:19,280 --> 00:03:21,840
different ways quite simply the best use

87
00:03:21,840 --> 00:03:24,239
of miter attack in my view is for

88
00:03:24,239 --> 00:03:25,760
intelligence purposes and we'll kind of

89
00:03:25,760 --> 00:03:27,840
talk through what exactly i mean by that

90
00:03:27,840 --> 00:03:30,720
with a specific example so the technique

91
00:03:30,720 --> 00:03:32,400
that i've highlighted here on the matrix

92
00:03:32,400 --> 00:03:34,640
is called impair defenses it's got a

93
00:03:34,640 --> 00:03:36,959
unique identifier associated with it

94
00:03:36,959 --> 00:03:39,120
it's quite simply describing ways that

95
00:03:39,120 --> 00:03:41,599
adversaries try to get around all these

96
00:03:41,599 --> 00:03:43,280
defensive measures that we put into

97
00:03:43,280 --> 00:03:45,519
place so there are a number of specific

98
00:03:45,519 --> 00:03:47,360
ways that they can go and do that they

99
00:03:47,360 --> 00:03:49,760
can try to disable security tools that

100
00:03:49,760 --> 00:03:52,000
we put in place or maybe mess with some

101
00:03:52,000 --> 00:03:55,120
of our logging functions

102
00:03:56,159 --> 00:03:57,519
i'm going to highlight as we go along

103
00:03:57,519 --> 00:03:59,200
some of my favorite resources too just

104
00:03:59,200 --> 00:04:00,799
in in wrapping my head around mitre

105
00:04:00,799 --> 00:04:03,280
attack for intelligence but uh to dig a

106
00:04:03,280 --> 00:04:04,959
little bit deeper one of the benefits of

107
00:04:04,959 --> 00:04:07,040
having this referenceable catalog of

108
00:04:07,040 --> 00:04:09,760
adversary behaviors is we can point back

109
00:04:09,760 --> 00:04:12,080
and look at some of the specific uh like

110
00:04:12,080 --> 00:04:15,040
ways command line processes programs

111
00:04:15,040 --> 00:04:17,839
that adversaries use to carry out this

112
00:04:17,839 --> 00:04:20,478
technique of impairing defenses so what

113
00:04:20,478 --> 00:04:22,240
you're seeing listed out right now is a

114
00:04:22,240 --> 00:04:24,240
specific technique for

115
00:04:24,240 --> 00:04:27,440
turning off an open source kind of uh

116
00:04:27,440 --> 00:04:29,759
ransomware uh they call it like a

117
00:04:29,759 --> 00:04:31,919
vaccine or an anti-virus program for

118
00:04:31,919 --> 00:04:34,639
ransomware what i'm highlighting here is

119
00:04:34,639 --> 00:04:36,720
a search that you can run in a security

120
00:04:36,720 --> 00:04:39,759
tool it's it's a salmon splunk to try to

121
00:04:39,759 --> 00:04:42,880
detect that behavior of turning off the

122
00:04:42,880 --> 00:04:47,120
ransomware specific antivirus

123
00:04:47,120 --> 00:04:49,280
in reality we as defenders are not

124
00:04:49,280 --> 00:04:51,520
dealing with just a single behavior that

125
00:04:51,520 --> 00:04:53,280
we're looking at at any given time there

126
00:04:53,280 --> 00:04:54,720
are very many that we're potentially

127
00:04:54,720 --> 00:04:56,320
seeing scrolling across you know our

128
00:04:56,320 --> 00:04:58,160
feeds and throughout our sims so this is

129
00:04:58,160 --> 00:05:00,160
a little bit more of the reality

130
00:05:00,160 --> 00:05:01,919
the good news is that just like i

131
00:05:01,919 --> 00:05:03,600
highlighted there are you know

132
00:05:03,600 --> 00:05:06,160
pre-configured often publicly available

133
00:05:06,160 --> 00:05:07,919
searches that you can run across your

134
00:05:07,919 --> 00:05:10,160
data sets to try to detect these

135
00:05:10,160 --> 00:05:12,880
techniques that same concept in fact

136
00:05:12,880 --> 00:05:15,440
applies for a large portion of the

137
00:05:15,440 --> 00:05:18,320
overall attack matrix so this is also

138
00:05:18,320 --> 00:05:20,080
kind of an intentionally jumbled because

139
00:05:20,080 --> 00:05:21,680
this is kind of the reality we have all

140
00:05:21,680 --> 00:05:23,520
of these like detection rules that we

141
00:05:23,520 --> 00:05:25,199
could start to put in place

142
00:05:25,199 --> 00:05:27,520
to try to recognize all these behaviors

143
00:05:27,520 --> 00:05:29,360
within our environment

144
00:05:29,360 --> 00:05:31,360
so to wrap our heads around kind of

145
00:05:31,360 --> 00:05:33,039
starting to put this in place in reality

146
00:05:33,039 --> 00:05:34,240
you're going to have to tune a lot of

147
00:05:34,240 --> 00:05:35,759
these searches to your own environment

148
00:05:35,759 --> 00:05:37,520
it's really not kind of typically a plug

149
00:05:37,520 --> 00:05:39,759
and play exercise so to go about doing

150
00:05:39,759 --> 00:05:42,000
that in reality ultimately what we need

151
00:05:42,000 --> 00:05:44,960
to do is prioritize which techniques or

152
00:05:44,960 --> 00:05:47,600
adversary behaviors we want to drill in

153
00:05:47,600 --> 00:05:48,800
a little bit further too we want to

154
00:05:48,800 --> 00:05:51,120
investigate and put in new detections in

155
00:05:51,120 --> 00:05:53,280
place and end of the day we're going to

156
00:05:53,280 --> 00:05:54,720
use intelligence to do that and i'll

157
00:05:54,720 --> 00:05:56,080
talk about kind of how that works in

158
00:05:56,080 --> 00:05:57,759
just a moment but when we start to do

159
00:05:57,759 --> 00:06:00,400
this prioritization we can identify some

160
00:06:00,400 --> 00:06:02,160
good rules that we can put in place

161
00:06:02,160 --> 00:06:04,560
oftentimes there's multiple of them

162
00:06:04,560 --> 00:06:06,479
we can start to tune those according to

163
00:06:06,479 --> 00:06:07,919
all the noise that we're seeing in our

164
00:06:07,919 --> 00:06:10,000
own specific environment and then

165
00:06:10,000 --> 00:06:11,919
ultimately in the best case scenario and

166
00:06:11,919 --> 00:06:13,840
i do want to emphasize this

167
00:06:13,840 --> 00:06:15,919
if we put in some new detection rules

168
00:06:15,919 --> 00:06:18,160
we're going to go about trying to test

169
00:06:18,160 --> 00:06:20,080
to make sure that they actually work as

170
00:06:20,080 --> 00:06:21,759
we intended to

171
00:06:21,759 --> 00:06:24,240
quite truly it is uh take something as

172
00:06:24,240 --> 00:06:26,160
simple as typing one of those commands

173
00:06:26,160 --> 00:06:28,319
or searches in wrong into your sim for

174
00:06:28,319 --> 00:06:31,280
example and you may not uh able be able

175
00:06:31,280 --> 00:06:33,039
to actually detect the technique in

176
00:06:33,039 --> 00:06:34,639
place even though maybe the logic

177
00:06:34,639 --> 00:06:36,880
underlying logic was all correct so what

178
00:06:36,880 --> 00:06:38,160
are you seeing now these are also

179
00:06:38,160 --> 00:06:40,160
publicly available resources this comes

180
00:06:40,160 --> 00:06:43,039
from atomic red team produced by

181
00:06:43,039 --> 00:06:45,520
red canary and what we're seeing here

182
00:06:45,520 --> 00:06:47,440
are some specific quick ways that you

183
00:06:47,440 --> 00:06:48,479
can go about

184
00:06:48,479 --> 00:06:51,360
testing attacker behavior within your

185
00:06:51,360 --> 00:06:52,639
own environment

186
00:06:52,639 --> 00:06:54,240
the nice thing about everything you're

187
00:06:54,240 --> 00:06:56,720
seeing displayed here on the screen is

188
00:06:56,720 --> 00:07:00,240
all of this code contains tags that line

189
00:07:00,240 --> 00:07:02,080
up with the miter attack techniques that

190
00:07:02,080 --> 00:07:03,599
i'm highlighting like in those blue

191
00:07:03,599 --> 00:07:05,599
cells there so it's really easy to easy

192
00:07:05,599 --> 00:07:07,599
to perform this alignment we can look at

193
00:07:07,599 --> 00:07:09,440
defensive controls and even testing

194
00:07:09,440 --> 00:07:11,599
measures we can put in place all kind of

195
00:07:11,599 --> 00:07:13,599
hinging on or revolving around miter

196
00:07:13,599 --> 00:07:16,599
attack

197
00:07:17,280 --> 00:07:19,039
all right just to elaborate so within

198
00:07:19,039 --> 00:07:20,720
the matrix right now there are nearly

199
00:07:20,720 --> 00:07:23,520
600 discrete uh adversary behaviors or

200
00:07:23,520 --> 00:07:24,880
techniques and what are known as

201
00:07:24,880 --> 00:07:26,880
subtechniques uh what i've kind of been

202
00:07:26,880 --> 00:07:29,280
highlighting all along is also this fact

203
00:07:29,280 --> 00:07:31,840
that uh there are countless uh very

204
00:07:31,840 --> 00:07:33,599
specific ways that those techniques can

205
00:07:33,599 --> 00:07:35,520
be put into play so you're seeing now

206
00:07:35,520 --> 00:07:37,280
this big list of what are known as sub

207
00:07:37,280 --> 00:07:39,520
techniques uh even within those there's

208
00:07:39,520 --> 00:07:41,759
tons of different specific ways

209
00:07:41,759 --> 00:07:43,680
attackers can carry out these behaviors

210
00:07:43,680 --> 00:07:45,280
so again it really is kind of

211
00:07:45,280 --> 00:07:46,879
emphasizing that some sort of

212
00:07:46,879 --> 00:07:49,120
prioritization is needed to be done just

213
00:07:49,120 --> 00:07:51,280
to give some metrics kind of around the

214
00:07:51,280 --> 00:07:53,840
scale of this problem and a lot of this

215
00:07:53,840 --> 00:07:55,680
was we took a step back and kind of did

216
00:07:55,680 --> 00:07:57,759
a review of all of these publicly

217
00:07:57,759 --> 00:08:00,160
available data sets with detection rules

218
00:08:00,160 --> 00:08:01,759
and tests that you can run the ones that

219
00:08:01,759 --> 00:08:03,360
i've highlighted are just a small

220
00:08:03,360 --> 00:08:05,360
sampling of what's out there publicly

221
00:08:05,360 --> 00:08:08,000
available for everyone over 9 000

222
00:08:08,000 --> 00:08:10,000
specific detection rules that exist i

223
00:08:10,000 --> 00:08:11,440
think the actual actual number is

224
00:08:11,440 --> 00:08:12,800
probably quite higher these are just the

225
00:08:12,800 --> 00:08:14,080
things that you can find in the open

226
00:08:14,080 --> 00:08:15,039
source

227
00:08:15,039 --> 00:08:16,879
and are publicly available and then

228
00:08:16,879 --> 00:08:19,680
using resources like red canary and

229
00:08:19,680 --> 00:08:22,560
organizations like scythe the cyber

230
00:08:22,560 --> 00:08:25,120
analytics repository they have these are

231
00:08:25,120 --> 00:08:27,360
a number of different data sets uh that

232
00:08:27,360 --> 00:08:29,199
include tests that you can run within

233
00:08:29,199 --> 00:08:31,360
your own environment we've got well over

234
00:08:31,360 --> 00:08:33,279
2000 of those that are again just

235
00:08:33,279 --> 00:08:36,799
available in the open source

236
00:08:37,839 --> 00:08:39,760
so this brings me to kind of the the

237
00:08:39,760 --> 00:08:42,000
three bridges of the presentation and

238
00:08:42,000 --> 00:08:43,120
we're not going to be talking about

239
00:08:43,120 --> 00:08:44,640
these folks i'd love to see someone give

240
00:08:44,640 --> 00:08:46,720
a talk with with these three gentlemen

241
00:08:46,720 --> 00:08:48,800
on the screen but what i'm going to

242
00:08:48,800 --> 00:08:50,720
instead be talking about are the three

243
00:08:50,720 --> 00:08:53,519
ways that intelligence can be used as a

244
00:08:53,519 --> 00:08:56,720
bridge to better improve security within

245
00:08:56,720 --> 00:08:58,480
an organization

246
00:08:58,480 --> 00:09:00,080
so three quick ways

247
00:09:00,080 --> 00:09:02,320
number one and this is again coming from

248
00:09:02,320 --> 00:09:03,680
the intelligence teams that i am

249
00:09:03,680 --> 00:09:05,360
specifically working with i'm fortunate

250
00:09:05,360 --> 00:09:06,800
to be able to work with a lot of larger

251
00:09:06,800 --> 00:09:08,080
organizations that do have those

252
00:09:08,080 --> 00:09:10,080
resources to have entire teams dedicated

253
00:09:10,080 --> 00:09:12,000
to this i realize that's not always the

254
00:09:12,000 --> 00:09:14,160
case so i really want to be emphasizing

255
00:09:14,160 --> 00:09:15,760
kind of thought processes here even if

256
00:09:15,760 --> 00:09:17,680
you're a single individual who

257
00:09:17,680 --> 00:09:19,600
a small part of your job is keeping

258
00:09:19,600 --> 00:09:22,160
track of the trends i do think these

259
00:09:22,160 --> 00:09:24,480
these thought processes and concepts can

260
00:09:24,480 --> 00:09:26,880
absolutely apply to your day-to-day

261
00:09:26,880 --> 00:09:28,560
so the first way that intelligence

262
00:09:28,560 --> 00:09:30,640
serves as a bridge is between the

263
00:09:30,640 --> 00:09:33,600
external and the internal environments

264
00:09:33,600 --> 00:09:35,600
most of the teams that i work with very

265
00:09:35,600 --> 00:09:37,600
much of course are keeping track of all

266
00:09:37,600 --> 00:09:39,600
the various actor groups and malwares

267
00:09:39,600 --> 00:09:41,760
that exist in the world today but what

268
00:09:41,760 --> 00:09:43,680
they're often times also being tasked

269
00:09:43,680 --> 00:09:46,240
with with is being aware of the internal

270
00:09:46,240 --> 00:09:47,760
operating environment within their own

271
00:09:47,760 --> 00:09:50,480
organization so is there some

272
00:09:50,480 --> 00:09:52,880
new big technology uh rollout or digital

273
00:09:52,880 --> 00:09:54,320
transformation being planned within

274
00:09:54,320 --> 00:09:57,040
their organization they ideally at least

275
00:09:57,040 --> 00:09:59,040
should be aware of of those factors

276
00:09:59,040 --> 00:10:01,519
because they very much can have an

277
00:10:01,519 --> 00:10:03,600
impact on the overall kind of risk

278
00:10:03,600 --> 00:10:05,519
picture that the organization is faced

279
00:10:05,519 --> 00:10:07,760
with

280
00:10:07,920 --> 00:10:09,839
second way that intelligence serves as a

281
00:10:09,839 --> 00:10:12,240
bridge is between the strategic and the

282
00:10:12,240 --> 00:10:15,120
tactical levels of the threat space and

283
00:10:15,120 --> 00:10:17,120
this really actually is another key way

284
00:10:17,120 --> 00:10:19,120
that minor attack comes into play

285
00:10:19,120 --> 00:10:20,560
because they have that higher level

286
00:10:20,560 --> 00:10:22,959
structure that that first row of water

287
00:10:22,959 --> 00:10:25,200
attackers trying to do but then also all

288
00:10:25,200 --> 00:10:27,920
those granular details about how are

289
00:10:27,920 --> 00:10:29,760
they doing it down to the level of

290
00:10:29,760 --> 00:10:32,640
specific command lines and and processes

291
00:10:32,640 --> 00:10:34,640
uh all contained within this single

292
00:10:34,640 --> 00:10:36,480
framework we can kind of go between

293
00:10:36,480 --> 00:10:38,240
those very high level concepts all the

294
00:10:38,240 --> 00:10:40,800
way down to how could i detect this on

295
00:10:40,800 --> 00:10:42,720
an end point within my environment how

296
00:10:42,720 --> 00:10:44,720
could i go about unit testing that

297
00:10:44,720 --> 00:10:47,720
technique

298
00:10:47,920 --> 00:10:49,360
and then the last way is kind of a

299
00:10:49,360 --> 00:10:52,000
blending of the two but what i'm very

300
00:10:52,000 --> 00:10:54,079
much seeing right now and kind of seeing

301
00:10:54,079 --> 00:10:55,920
a ton of growing interest in using

302
00:10:55,920 --> 00:10:57,200
moderate attack for intelligence

303
00:10:57,200 --> 00:10:58,320
purposes

304
00:10:58,320 --> 00:11:00,160
these intelligence teams really are kind

305
00:11:00,160 --> 00:11:02,959
of uh perfectly situated to serve as a

306
00:11:02,959 --> 00:11:05,200
bridge between the offensive and

307
00:11:05,200 --> 00:11:08,079
defensive realms of security so

308
00:11:08,079 --> 00:11:10,079
oftentimes kind of being looked at as a

309
00:11:10,079 --> 00:11:12,399
go-to as an in-between between the red

310
00:11:12,399 --> 00:11:14,959
team operators and those defenders and

311
00:11:14,959 --> 00:11:17,360
increasingly i really am seeing

312
00:11:17,360 --> 00:11:19,440
intelligence analysts kind of being

313
00:11:19,440 --> 00:11:21,680
tasked with or at least maybe a hope or

314
00:11:21,680 --> 00:11:24,000
expectation that they would be able to

315
00:11:24,000 --> 00:11:26,560
surface some of these detection rules

316
00:11:26,560 --> 00:11:29,200
and testing mechanisms that you could go

317
00:11:29,200 --> 00:11:30,959
about putting in a place within your own

318
00:11:30,959 --> 00:11:32,880
environment and so i am seeing kind of

319
00:11:32,880 --> 00:11:34,959
increased focus on that and again i

320
00:11:34,959 --> 00:11:36,800
think by their nature of keeping track

321
00:11:36,800 --> 00:11:39,040
of kind of everything that's happening

322
00:11:39,040 --> 00:11:41,440
external and internal these teams really

323
00:11:41,440 --> 00:11:43,920
potentially are in a good uh position to

324
00:11:43,920 --> 00:11:45,440
be able to kind of

325
00:11:45,440 --> 00:11:48,079
meet this need

326
00:11:48,320 --> 00:11:49,839
and then just a couple specific tools

327
00:11:49,839 --> 00:11:51,920
that support all these concepts so we've

328
00:11:51,920 --> 00:11:53,680
talked a lot about minor attack the

329
00:11:53,680 --> 00:11:55,519
other component of this is truly just

330
00:11:55,519 --> 00:11:57,920
our analytical brains as intelligence

331
00:11:57,920 --> 00:11:58,880
analysts

332
00:11:58,880 --> 00:12:00,880
it really is kind of necessary to we can

333
00:12:00,880 --> 00:12:02,560
do all this automation and we should be

334
00:12:02,560 --> 00:12:04,560
doing automation around this but to

335
00:12:04,560 --> 00:12:06,240
really kind of sit down take that step

336
00:12:06,240 --> 00:12:07,920
back and think about how do these

337
00:12:07,920 --> 00:12:10,160
threats actually impact our organization

338
00:12:10,160 --> 00:12:12,320
i really do believe that has to be kind

339
00:12:12,320 --> 00:12:16,320
of a human analysis component to it

340
00:12:17,680 --> 00:12:19,200
all right so i'm going to start to shift

341
00:12:19,200 --> 00:12:22,959
gears to this tool that we hope can aid

342
00:12:22,959 --> 00:12:24,880
organizations in applying intelligence

343
00:12:24,880 --> 00:12:26,560
and where this is all coming from i do

344
00:12:26,560 --> 00:12:28,639
want to kind of build up to uh what led

345
00:12:28,639 --> 00:12:30,720
to the production of this a lot of this

346
00:12:30,720 --> 00:12:32,800
is coming from support that uh our

347
00:12:32,800 --> 00:12:35,120
customer success team is doing around

348
00:12:35,120 --> 00:12:38,160
threat or risk profiling organization

349
00:12:38,160 --> 00:12:41,200
risk or threat profiling exercises for

350
00:12:41,200 --> 00:12:42,639
organizations

351
00:12:42,639 --> 00:12:44,000
and all i'm doing here is just

352
00:12:44,000 --> 00:12:46,000
highlighting some of the various factors

353
00:12:46,000 --> 00:12:48,320
that ideally should be included in a

354
00:12:48,320 --> 00:12:50,720
risk profile oftentimes organizations

355
00:12:50,720 --> 00:12:53,519
will uh in in a good way start small and

356
00:12:53,519 --> 00:12:55,760
kind of focus in on one area of this and

357
00:12:55,760 --> 00:12:59,040
what we've traditionally done is being a

358
00:12:59,040 --> 00:13:01,200
cyber security intelligence company we

359
00:13:01,200 --> 00:13:02,560
focus more kind of on the upper

360
00:13:02,560 --> 00:13:04,399
left-hand side with kind of building out

361
00:13:04,399 --> 00:13:07,040
a threat profile what actors in malware

362
00:13:07,040 --> 00:13:08,720
exist out there and which ones would be

363
00:13:08,720 --> 00:13:11,120
most likely to target our specific

364
00:13:11,120 --> 00:13:13,760
organization but what we would often see

365
00:13:13,760 --> 00:13:15,680
from there we would end up you know we

366
00:13:15,680 --> 00:13:17,200
would do all this work we would run

367
00:13:17,200 --> 00:13:20,160
searches in our platform come up with

368
00:13:20,160 --> 00:13:22,079
you know a pretty cool looking picture

369
00:13:22,079 --> 00:13:23,360
like this this is highlighting

370
00:13:23,360 --> 00:13:25,040
potentially the top actor groups that

371
00:13:25,040 --> 00:13:26,959
would target us

372
00:13:26,959 --> 00:13:29,440
and then it kind of stops there it's a

373
00:13:29,440 --> 00:13:31,839
nice picture to look at but what exactly

374
00:13:31,839 --> 00:13:35,040
do you do with that information well we

375
00:13:35,040 --> 00:13:36,639
started to kind of take the next step

376
00:13:36,639 --> 00:13:38,720
and say we've identified so maybe top

377
00:13:38,720 --> 00:13:40,399
priority actors let's shorten it down to

378
00:13:40,399 --> 00:13:42,800
a short list of the top five

379
00:13:42,800 --> 00:13:45,120
what behaviors are associated with them

380
00:13:45,120 --> 00:13:46,240
you can look at all the various

381
00:13:46,240 --> 00:13:48,000
behaviors they're using see where maybe

382
00:13:48,000 --> 00:13:49,360
there's overlapping techniques that

383
00:13:49,360 --> 00:13:50,880
they're all using and you come up with

384
00:13:50,880 --> 00:13:52,560
another nice graphic which is

385
00:13:52,560 --> 00:13:54,160
highlighting you know this is the minor

386
00:13:54,160 --> 00:13:56,079
attack matrix again highlighting top

387
00:13:56,079 --> 00:13:59,120
like ttps or behaviors associated with

388
00:13:59,120 --> 00:14:01,680
your top priority threats

389
00:14:01,680 --> 00:14:02,959
what next

390
00:14:02,959 --> 00:14:04,880
i've absolutely received that question

391
00:14:04,880 --> 00:14:06,480
on conversations with our clients you

392
00:14:06,480 --> 00:14:08,000
know we're moving further along we're

393
00:14:08,000 --> 00:14:09,839
saying that we have identified maybe top

394
00:14:09,839 --> 00:14:11,839
priority techniques what do we actually

395
00:14:11,839 --> 00:14:14,480
do with that intelligence that's kind of

396
00:14:14,480 --> 00:14:16,880
where this data set that we've produced

397
00:14:16,880 --> 00:14:19,199
has has started to come into play so i'm

398
00:14:19,199 --> 00:14:20,399
going to walk through a couple final

399
00:14:20,399 --> 00:14:22,000
examples then start to kind of dig into

400
00:14:22,000 --> 00:14:24,720
the the tool itself so one of the

401
00:14:24,720 --> 00:14:26,480
literally next questions that i received

402
00:14:26,480 --> 00:14:27,680
after uh

403
00:14:27,680 --> 00:14:29,199
highlighting this heat map for a client

404
00:14:29,199 --> 00:14:31,760
was what can we start to do with that my

405
00:14:31,760 --> 00:14:33,600
next question back to them was well what

406
00:14:33,600 --> 00:14:34,880
tools do you have in place what

407
00:14:34,880 --> 00:14:36,800
capabilities do you have to search

408
00:14:36,800 --> 00:14:39,120
within your own network and endpoint

409
00:14:39,120 --> 00:14:42,160
data to detect these behaviors

410
00:14:42,160 --> 00:14:44,959
fortunately they were using a tool a sim

411
00:14:44,959 --> 00:14:47,360
solution like splunk and all this is

412
00:14:47,360 --> 00:14:49,279
publicly available i've highlighted the

413
00:14:49,279 --> 00:14:51,600
the link back to this repository splunk

414
00:14:51,600 --> 00:14:53,920
produces these searches or queries that

415
00:14:53,920 --> 00:14:56,639
you can run within the sim to be able to

416
00:14:56,639 --> 00:14:59,040
detect adversary behaviors i know

417
00:14:59,040 --> 00:15:00,160
there's a lot on the screen right now

418
00:15:00,160 --> 00:15:01,920
i'm not trying to overwhelm folks

419
00:15:01,920 --> 00:15:03,279
essentially what we're seeing here with

420
00:15:03,279 --> 00:15:05,680
the highlighted portion is

421
00:15:05,680 --> 00:15:08,079
code or logic that you can run within

422
00:15:08,079 --> 00:15:11,040
the sim to be able to detect a specific

423
00:15:11,040 --> 00:15:13,600
instance of an attacker technique and

424
00:15:13,600 --> 00:15:15,519
ultimately what we can do with this is

425
00:15:15,519 --> 00:15:17,680
highlighted down here at the bottom

426
00:15:17,680 --> 00:15:19,680
these are the minor attack codes or

427
00:15:19,680 --> 00:15:22,079
identifiers associated with the behavior

428
00:15:22,079 --> 00:15:24,320
that we are ultimately trying to detect

429
00:15:24,320 --> 00:15:26,399
so in this case uh we're saying let's

430
00:15:26,399 --> 00:15:28,000
look for instances of powershell being

431
00:15:28,000 --> 00:15:30,560
run let's look for specific event ids

432
00:15:30,560 --> 00:15:32,399
and over maybe a certain kind of rapid

433
00:15:32,399 --> 00:15:34,480
time frame that's what this specific

434
00:15:34,480 --> 00:15:36,720
search is designed to do but ultimately

435
00:15:36,720 --> 00:15:38,639
we can kind of line that back up with

436
00:15:38,639 --> 00:15:42,160
specific miter attack codes

437
00:15:42,160 --> 00:15:45,199
this brings us to if we zoom way out

438
00:15:45,199 --> 00:15:48,800
splunk provides again publicly available

439
00:15:48,800 --> 00:15:50,160
well over

440
00:15:50,160 --> 00:15:52,000
a few hundred of these specific searches

441
00:15:52,000 --> 00:15:53,360
that you can go

442
00:15:53,360 --> 00:15:55,120
and so it starts to kind of turn into a

443
00:15:55,120 --> 00:15:57,040
little bit of just a math game so

444
00:15:57,040 --> 00:15:58,800
highlighting the miter attack codes on

445
00:15:58,800 --> 00:16:00,959
the left hand side and highlighting uh

446
00:16:00,959 --> 00:16:03,519
just a roll up account of all of the

447
00:16:03,519 --> 00:16:05,279
searches that they provide that are

448
00:16:05,279 --> 00:16:07,519
associated with those same adversary

449
00:16:07,519 --> 00:16:09,199
behaviors

450
00:16:09,199 --> 00:16:11,120
so that's good to know we've started to

451
00:16:11,120 --> 00:16:13,040
look at some operational ways that we

452
00:16:13,040 --> 00:16:14,880
can take this overall original

453
00:16:14,880 --> 00:16:16,560
intelligence that we've provided and

454
00:16:16,560 --> 00:16:17,920
start to kind of put that into use

455
00:16:17,920 --> 00:16:20,240
within our environment

456
00:16:20,240 --> 00:16:21,360
one of the other things though in

457
00:16:21,360 --> 00:16:23,199
speaking with this client is they let me

458
00:16:23,199 --> 00:16:25,600
know that they are also utilizing

459
00:16:25,600 --> 00:16:27,600
kind of an open source framework known

460
00:16:27,600 --> 00:16:31,040
as sigma this is basically a standard

461
00:16:31,040 --> 00:16:33,519
for writing detection rules and so it

462
00:16:33,519 --> 00:16:35,600
can actually translate into a number of

463
00:16:35,600 --> 00:16:38,079
different specific tools uh like splunk

464
00:16:38,079 --> 00:16:40,480
elasticsearch etc you write the

465
00:16:40,480 --> 00:16:42,560
detection in a standard format and you

466
00:16:42,560 --> 00:16:45,120
can literally quickly convert it into

467
00:16:45,120 --> 00:16:46,959
other tools and so my client was also

468
00:16:46,959 --> 00:16:49,199
using this on top of kind of those

469
00:16:49,199 --> 00:16:52,800
baseline detections provided by splunk

470
00:16:52,800 --> 00:16:55,519
so what we've done now is taking that

471
00:16:55,519 --> 00:16:58,480
original spreadsheet that i had

472
00:16:58,480 --> 00:17:01,040
add in another column here with all of

473
00:17:01,040 --> 00:17:02,959
the roll up of all the detections that

474
00:17:02,959 --> 00:17:05,679
are provided by the the sigma standard

475
00:17:05,679 --> 00:17:08,079
also lined up with the miter attack

476
00:17:08,079 --> 00:17:09,760
techniques

477
00:17:09,760 --> 00:17:12,799
and it continued to expand and expand

478
00:17:12,799 --> 00:17:15,199
from there and it started to turn into

479
00:17:15,199 --> 00:17:17,679
something like this so you can see on

480
00:17:17,679 --> 00:17:18,880
the left hand side it started with

481
00:17:18,880 --> 00:17:21,439
splunk we add in sigma and we just keep

482
00:17:21,439 --> 00:17:23,119
going and going everything that's

483
00:17:23,119 --> 00:17:24,799
included in this spreadsheet right now

484
00:17:24,799 --> 00:17:27,280
is publicly available open source data

485
00:17:27,280 --> 00:17:29,919
we've got a range of specific network

486
00:17:29,919 --> 00:17:31,840
and endpoint related tools there are

487
00:17:31,840 --> 00:17:33,679
lots of others out there that

488
00:17:33,679 --> 00:17:35,520
you know no fault uh choose not to

489
00:17:35,520 --> 00:17:37,679
publicize this information so you could

490
00:17:37,679 --> 00:17:39,280
start to plug in you know even your own

491
00:17:39,280 --> 00:17:41,039
data and it just kind of keeps expanding

492
00:17:41,039 --> 00:17:42,240
from there

493
00:17:42,240 --> 00:17:44,000
so at a certain point i realized that i

494
00:17:44,000 --> 00:17:46,080
basically recreated the matrix and i

495
00:17:46,080 --> 00:17:47,840
almost stopped there

496
00:17:47,840 --> 00:17:48,960
because that's what we're all trying to

497
00:17:48,960 --> 00:17:51,039
do in cyber security is is yeah

498
00:17:51,039 --> 00:17:52,960
basically create the matrix so

499
00:17:52,960 --> 00:17:55,600
i almost stopped but i decided to keep

500
00:17:55,600 --> 00:17:58,480
going so i did the next most logical

501
00:17:58,480 --> 00:18:01,760
thing which was to put it into an html

502
00:18:01,760 --> 00:18:05,039
and javascript web app and that is is

503
00:18:05,039 --> 00:18:06,720
what's included in this data set and

504
00:18:06,720 --> 00:18:08,799
tool that we've recently had the chance

505
00:18:08,799 --> 00:18:10,080
to produce so

506
00:18:10,080 --> 00:18:11,600
here's the site this takes you to the

507
00:18:11,600 --> 00:18:13,679
the web app version of this everything

508
00:18:13,679 --> 00:18:15,440
again is publicly available so the

509
00:18:15,440 --> 00:18:17,840
underlying data that big spreadsheet uh

510
00:18:17,840 --> 00:18:19,679
that i just highlighted is is there for

511
00:18:19,679 --> 00:18:21,360
you to utilize as well

512
00:18:21,360 --> 00:18:23,600
the ideal scenario is for folks to go

513
00:18:23,600 --> 00:18:26,080
out and grab that data fine-tune it for

514
00:18:26,080 --> 00:18:28,400
your own needs you're likely not using

515
00:18:28,400 --> 00:18:30,720
both splunk and elastic and you know a

516
00:18:30,720 --> 00:18:32,880
third sim uh some organizations may have

517
00:18:32,880 --> 00:18:34,240
multiple but you're going to want to

518
00:18:34,240 --> 00:18:36,000
fine-tune that data to your own

519
00:18:36,000 --> 00:18:37,360
environment so in that scenario you're

520
00:18:37,360 --> 00:18:39,600
actually cutting out some of the columns

521
00:18:39,600 --> 00:18:40,559
but

522
00:18:40,559 --> 00:18:42,240
i want to give just a moment to kind of

523
00:18:42,240 --> 00:18:43,600
walk through what this actually looks

524
00:18:43,600 --> 00:18:45,760
like uh we do have a few features in

525
00:18:45,760 --> 00:18:47,200
here that uh hopefully make it a little

526
00:18:47,200 --> 00:18:48,799
bit easier to start putting that

527
00:18:48,799 --> 00:18:51,360
intelligence uh into place so taking a

528
00:18:51,360 --> 00:18:53,280
high-level view at what's included here

529
00:18:53,280 --> 00:18:55,760
again we've got over 9000 publicly

530
00:18:55,760 --> 00:18:57,200
accessible

531
00:18:57,200 --> 00:18:59,120
technical controls these detection rules

532
00:18:59,120 --> 00:19:01,200
that i've been mentioning also like

533
00:19:01,200 --> 00:19:03,760
policy controls as well these are more

534
00:19:03,760 --> 00:19:05,919
just you know written format guidance in

535
00:19:05,919 --> 00:19:07,760
terms of uh what higher level like

536
00:19:07,760 --> 00:19:09,919
counter measures or steps can you take

537
00:19:09,919 --> 00:19:11,679
mostly from a policy and process

538
00:19:11,679 --> 00:19:14,320
perspective uh to you know better better

539
00:19:14,320 --> 00:19:15,760
kind of prepare and guard your

540
00:19:15,760 --> 00:19:17,919
organization for these attacks and then

541
00:19:17,919 --> 00:19:19,440
again the part that i get really excited

542
00:19:19,440 --> 00:19:21,039
about is the fact that increasingly

543
00:19:21,039 --> 00:19:22,880
we're seeing more and more of these

544
00:19:22,880 --> 00:19:25,200
offensive security measures literally

545
00:19:25,200 --> 00:19:28,080
like unit tests to go out and replicate

546
00:19:28,080 --> 00:19:30,240
adversary behavior usually in a pretty

547
00:19:30,240 --> 00:19:31,919
safe way within your own environment

548
00:19:31,919 --> 00:19:32,960
you're definitely going to want to do

549
00:19:32,960 --> 00:19:34,720
this in you know virtual environments

550
00:19:34,720 --> 00:19:36,480
hopefully that mimic what's actually in

551
00:19:36,480 --> 00:19:38,160
the the production but a lot of this

552
00:19:38,160 --> 00:19:39,760
data is publicly available and

553
00:19:39,760 --> 00:19:42,640
increasingly actually being uh automated

554
00:19:42,640 --> 00:19:43,919
as well

555
00:19:43,919 --> 00:19:45,919
the key part of this again is every

556
00:19:45,919 --> 00:19:47,520
single thing every resource that's

557
00:19:47,520 --> 00:19:49,360
included in the control validation

558
00:19:49,360 --> 00:19:51,840
compass is lined up or or tagged

559
00:19:51,840 --> 00:19:54,000
essentially with a miter attack

560
00:19:54,000 --> 00:19:56,320
technique or sub technique those most

561
00:19:56,320 --> 00:19:59,280
granular layers of it

562
00:19:59,280 --> 00:20:00,080
so

563
00:20:00,080 --> 00:20:02,400
i'm gonna do the worst thing that i

564
00:20:02,400 --> 00:20:04,159
should do and try to do some of this

565
00:20:04,159 --> 00:20:05,440
live so

566
00:20:05,440 --> 00:20:07,679
uh does anyone have a favorite mitre

567
00:20:07,679 --> 00:20:09,600
attack uh technique that they'd like to

568
00:20:09,600 --> 00:20:12,719
kind of dig into a little bit

569
00:20:14,240 --> 00:20:15,679
don't worry

570
00:20:15,679 --> 00:20:18,240
obvious skating files awesome thank you

571
00:20:18,240 --> 00:20:20,240
very much all right so we can do the

572
00:20:20,240 --> 00:20:22,320
search for the actual t-code if you

573
00:20:22,320 --> 00:20:24,320
happen to know it or let's just use a

574
00:20:24,320 --> 00:20:26,480
little bit more plain text so we can

575
00:20:26,480 --> 00:20:28,720
talk about obfuscated files or

576
00:20:28,720 --> 00:20:30,720
information sounds pretty complicated

577
00:20:30,720 --> 00:20:32,480
it's a fancy way of saying

578
00:20:32,480 --> 00:20:34,720
another way that attackers try to evade

579
00:20:34,720 --> 00:20:37,039
the defenses that we put into place uh

580
00:20:37,039 --> 00:20:38,640
by kind of messing with the file

581
00:20:38,640 --> 00:20:41,280
contents uh that that would be available

582
00:20:41,280 --> 00:20:42,799
within your network

583
00:20:42,799 --> 00:20:44,640
so when we search for this specific

584
00:20:44,640 --> 00:20:46,320
behavior or technique

585
00:20:46,320 --> 00:20:48,080
we can see a number of different data

586
00:20:48,080 --> 00:20:50,240
points that all are lined up with this

587
00:20:50,240 --> 00:20:52,400
miter attack t code so sticking at the

588
00:20:52,400 --> 00:20:54,320
high level we've got this kind of policy

589
00:20:54,320 --> 00:20:56,720
and process related guidance uh every

590
00:20:56,720 --> 00:20:58,159
single one of these sources we've got

591
00:20:58,159 --> 00:20:59,840
tons of kind of supporting resources

592
00:20:59,840 --> 00:21:02,080
around i don't expect everyone to be

593
00:21:02,080 --> 00:21:04,240
familiar with probably even a fraction

594
00:21:04,240 --> 00:21:06,159
of the resource available here but you

595
00:21:06,159 --> 00:21:07,679
can click in and learn a little bit more

596
00:21:07,679 --> 00:21:09,280
about what all these various you know

597
00:21:09,280 --> 00:21:11,360
data sets are trying to do

598
00:21:11,360 --> 00:21:12,799
scroll down a little bit further we're

599
00:21:12,799 --> 00:21:14,400
talking now along the lines of the

600
00:21:14,400 --> 00:21:16,080
things that we were discussing earlier

601
00:21:16,080 --> 00:21:16,799
so

602
00:21:16,799 --> 00:21:18,640
these sim detection

603
00:21:18,640 --> 00:21:21,440
logics or rules that you could implement

604
00:21:21,440 --> 00:21:23,200
and then some of the offensive security

605
00:21:23,200 --> 00:21:24,159
tests

606
00:21:24,159 --> 00:21:25,440
what you can do from here and this is

607
00:21:25,440 --> 00:21:27,760
actually brand new as of last week is it

608
00:21:27,760 --> 00:21:30,159
kind of used to stop here we would get a

609
00:21:30,159 --> 00:21:31,600
sense of you know which of these

610
00:21:31,600 --> 00:21:33,679
specific behaviors maybe have higher

611
00:21:33,679 --> 00:21:36,320
concentration of out-of-the-box rules

612
00:21:36,320 --> 00:21:39,200
available what we can do now is pivot

613
00:21:39,200 --> 00:21:39,840
into

614
00:21:39,840 --> 00:21:41,200
[Music]

615
00:21:41,200 --> 00:21:42,960
just an additional resource that's all

616
00:21:42,960 --> 00:21:44,559
kind of included in the same github

617
00:21:44,559 --> 00:21:46,799
repository and this is taking us now

618
00:21:46,799 --> 00:21:49,360
directly to the specific in this case

619
00:21:49,360 --> 00:21:52,559
sigma rules that we would be able to run

620
00:21:52,559 --> 00:21:55,200
all lined up with obfuscated files that

621
00:21:55,200 --> 00:21:57,360
attacker technique and so what you can

622
00:21:57,360 --> 00:21:59,440
see here is there is a very large number

623
00:21:59,440 --> 00:22:01,440
of them this is kind of highlighting all

624
00:22:01,440 --> 00:22:03,039
these specific what are known as

625
00:22:03,039 --> 00:22:05,679
implementations or procedures of that

626
00:22:05,679 --> 00:22:07,440
specific technique that could possibly

627
00:22:07,440 --> 00:22:10,080
exist so again takeaway here this is

628
00:22:10,080 --> 00:22:11,840
good news we have access to a lot of

629
00:22:11,840 --> 00:22:14,159
these i can pivot directly in to this is

630
00:22:14,159 --> 00:22:16,400
the the rule as it's hosted on the sigma

631
00:22:16,400 --> 00:22:18,720
repository scroll down and find the

632
00:22:18,720 --> 00:22:21,440
exact logic to run this test uh but

633
00:22:21,440 --> 00:22:23,360
ultimately we're seeing that again even

634
00:22:23,360 --> 00:22:25,280
for this one technique

635
00:22:25,280 --> 00:22:27,360
there are 74 detection rules that are

636
00:22:27,360 --> 00:22:29,520
available to detect all these different

637
00:22:29,520 --> 00:22:31,440
implementations of it so

638
00:22:31,440 --> 00:22:32,960
we're probably ideally going to want to

639
00:22:32,960 --> 00:22:34,720
drill in a little bit further beyond

640
00:22:34,720 --> 00:22:36,159
that

641
00:22:36,159 --> 00:22:38,240
so the way that you do that is to start

642
00:22:38,240 --> 00:22:39,120
using

643
00:22:39,120 --> 00:22:40,400
further intelligence and i'm going to

644
00:22:40,400 --> 00:22:42,480
walk through really kind of one of my

645
00:22:42,480 --> 00:22:44,240
most common workflows for just starting

646
00:22:44,240 --> 00:22:47,039
to surface more relevant intelligence

647
00:22:47,039 --> 00:22:48,480
and kind of drill down to things that

648
00:22:48,480 --> 00:22:50,320
would be you know most interesting most

649
00:22:50,320 --> 00:22:51,600
notable for

650
00:22:51,600 --> 00:22:54,000
a given organization for example and the

651
00:22:54,000 --> 00:22:56,480
way that i like to do that a lot is i'm

652
00:22:56,480 --> 00:22:57,760
not going to walk through all the the

653
00:22:57,760 --> 00:22:59,280
background steps in here there's a ton

654
00:22:59,280 --> 00:23:00,960
of good resources i've linked i'm going

655
00:23:00,960 --> 00:23:02,480
to share the slides i've linked a ton of

656
00:23:02,480 --> 00:23:04,640
good walkthroughs on how to get to kind

657
00:23:04,640 --> 00:23:05,280
of

658
00:23:05,280 --> 00:23:07,039
the point that i'm showing on the screen

659
00:23:07,039 --> 00:23:09,679
this is a tool published by the mitre

660
00:23:09,679 --> 00:23:12,400
attack team that allows you to quickly

661
00:23:12,400 --> 00:23:13,679
surface

662
00:23:13,679 --> 00:23:16,480
kind of these heat maps of most notable

663
00:23:16,480 --> 00:23:18,799
techniques associated with specific

664
00:23:18,799 --> 00:23:20,960
adversaries threat actor groups or

665
00:23:20,960 --> 00:23:22,159
malware this is called the attack

666
00:23:22,159 --> 00:23:23,600
navigator

667
00:23:23,600 --> 00:23:25,280
what i'm highlighting here is you can

668
00:23:25,280 --> 00:23:29,280
search in plain text for a particular

669
00:23:29,280 --> 00:23:31,120
thread actor or malware group that you

670
00:23:31,120 --> 00:23:32,720
might find interesting

671
00:23:32,720 --> 00:23:34,799
i'm taking a little bit of a jump ahead

672
00:23:34,799 --> 00:23:36,559
one of the quickest ways you know you're

673
00:23:36,559 --> 00:23:38,400
going to be reading a lot in the news

674
00:23:38,400 --> 00:23:40,000
about these various actor groups another

675
00:23:40,000 --> 00:23:41,600
big way of surfacing something that

676
00:23:41,600 --> 00:23:44,080
would be relevant to you is to look at

677
00:23:44,080 --> 00:23:45,760
what actors have targeted other

678
00:23:45,760 --> 00:23:48,000
organizations within your industry this

679
00:23:48,000 --> 00:23:49,600
industry basis is really one of the most

680
00:23:49,600 --> 00:23:51,200
common ways that you know clients i

681
00:23:51,200 --> 00:23:52,720
interact with are kind of going about

682
00:23:52,720 --> 00:23:54,559
this but when we get to that point of

683
00:23:54,559 --> 00:23:56,559
identifying a specific

684
00:23:56,559 --> 00:23:58,799
adversary want to dig into that's where

685
00:23:58,799 --> 00:24:01,760
this tool comes in really handy so what

686
00:24:01,760 --> 00:24:03,760
i've highlighted here is a very

687
00:24:03,760 --> 00:24:05,679
prominent very popular malware known as

688
00:24:05,679 --> 00:24:06,720
trickbot

689
00:24:06,720 --> 00:24:08,720
within the navigator tool you can kind

690
00:24:08,720 --> 00:24:10,960
of pivot through and highlight different

691
00:24:10,960 --> 00:24:12,799
all the techniques that are known based

692
00:24:12,799 --> 00:24:15,440
on public observations to be associated

693
00:24:15,440 --> 00:24:17,760
with a given adversary group so i've

694
00:24:17,760 --> 00:24:19,840
already highlighted all this within the

695
00:24:19,840 --> 00:24:21,919
attack navigator highlighting specific

696
00:24:21,919 --> 00:24:24,400
techniques associated with trick bot

697
00:24:24,400 --> 00:24:26,400
what we can do from there is also

698
00:24:26,400 --> 00:24:28,400
utilize the tool come over to this other

699
00:24:28,400 --> 00:24:30,400
page

700
00:24:30,400 --> 00:24:32,400
we can export the data

701
00:24:32,400 --> 00:24:35,360
from attack navigator into just a pretty

702
00:24:35,360 --> 00:24:37,440
quick and easy json file a very

703
00:24:37,440 --> 00:24:39,200
structured way of kind of transporting

704
00:24:39,200 --> 00:24:40,559
this threat intelligence that's what

705
00:24:40,559 --> 00:24:41,840
this really is what we're looking at

706
00:24:41,840 --> 00:24:43,840
here known observations of techniques

707
00:24:43,840 --> 00:24:45,520
associated with a threat

708
00:24:45,520 --> 00:24:48,000
you can drop that into the tool here i

709
00:24:48,000 --> 00:24:50,640
have a the trick bot example kind of

710
00:24:50,640 --> 00:24:52,559
preloaded into the system

711
00:24:52,559 --> 00:24:53,760
click run

712
00:24:53,760 --> 00:24:56,240
and now what we're seeing are the list

713
00:24:56,240 --> 00:24:59,200
of specific behaviors associated with

714
00:24:59,200 --> 00:25:01,600
that input file and then all of the

715
00:25:01,600 --> 00:25:04,080
various kind of testing or detection

716
00:25:04,080 --> 00:25:06,080
rules counter measures associated with

717
00:25:06,080 --> 00:25:08,240
these specific techniques so now we've

718
00:25:08,240 --> 00:25:10,240
gone from a standpoint of looking at

719
00:25:10,240 --> 00:25:11,440
relevant intelligence for our

720
00:25:11,440 --> 00:25:13,679
organization to these very kind of

721
00:25:13,679 --> 00:25:15,520
operational measures that we can take

722
00:25:15,520 --> 00:25:17,200
again meaning detection rules you can

723
00:25:17,200 --> 00:25:19,120
run and test to make sure that they're

724
00:25:19,120 --> 00:25:21,679
actually working properly so i actually

725
00:25:21,679 --> 00:25:23,679
by default this is sorted from low to

726
00:25:23,679 --> 00:25:27,120
high meaning you would want to be

727
00:25:27,120 --> 00:25:30,000
these are uh techniques for which there

728
00:25:30,000 --> 00:25:32,480
is not a lot of existing out of the box

729
00:25:32,480 --> 00:25:34,240
you know logic or detection rules that

730
00:25:34,240 --> 00:25:35,760
exist right now so these are something

731
00:25:35,760 --> 00:25:37,760
that you know probably manually you're

732
00:25:37,760 --> 00:25:39,279
going to want to task some of your

733
00:25:39,279 --> 00:25:41,440
security engineers or threat hunters if

734
00:25:41,440 --> 00:25:43,840
you have them to try to find some kind

735
00:25:43,840 --> 00:25:45,679
of customized ways of detecting these

736
00:25:45,679 --> 00:25:47,520
techniques it's not always going to be

737
00:25:47,520 --> 00:25:49,520
possible the way that certain techniques

738
00:25:49,520 --> 00:25:51,360
are defined or it may not be very easy

739
00:25:51,360 --> 00:25:52,240
at least

740
00:25:52,240 --> 00:25:54,320
but you can go that route or if you

741
00:25:54,320 --> 00:25:56,559
don't have very much stuff in place

742
00:25:56,559 --> 00:25:58,400
right now countermeasures you can start

743
00:25:58,400 --> 00:26:00,400
with the things that have a ton of out

744
00:26:00,400 --> 00:26:01,840
of the box

745
00:26:01,840 --> 00:26:03,840
mechanisms available right now and

746
00:26:03,840 --> 00:26:05,440
that's sorted here so you can sort kind

747
00:26:05,440 --> 00:26:07,679
of high to low with all of that and

748
00:26:07,679 --> 00:26:09,679
again pivoting in more and more into the

749
00:26:09,679 --> 00:26:12,240
data here

750
00:26:12,559 --> 00:26:14,080
um all right i've got just a couple

751
00:26:14,080 --> 00:26:16,000
minutes left so i will try to wrap

752
00:26:16,000 --> 00:26:18,000
things up um definitely want to open it

753
00:26:18,000 --> 00:26:19,919
up to some questions i think at a high

754
00:26:19,919 --> 00:26:21,200
level some of the things that i've

755
00:26:21,200 --> 00:26:23,360
started to do with the tool is i've had

756
00:26:23,360 --> 00:26:25,919
the chance to publish some of my first

757
00:26:25,919 --> 00:26:27,440
atomic red teams

758
00:26:27,440 --> 00:26:29,679
scripts so this is again a publicly

759
00:26:29,679 --> 00:26:31,760
available project they highly encourage

760
00:26:31,760 --> 00:26:33,760
the community to contribute

761
00:26:33,760 --> 00:26:36,240
tests and examples to to the project

762
00:26:36,240 --> 00:26:38,320
what i did is i just came in and looked

763
00:26:38,320 --> 00:26:40,799
at one of these examples where we didn't

764
00:26:40,799 --> 00:26:43,279
have very many tests that were available

765
00:26:43,279 --> 00:26:45,039
right now however there are actually

766
00:26:45,039 --> 00:26:46,960
detection rules that existed for that

767
00:26:46,960 --> 00:26:49,440
technique meaning it's telling you how

768
00:26:49,440 --> 00:26:51,840
you would be able to see this behavior

769
00:26:51,840 --> 00:26:53,919
within your own environment all it came

770
00:26:53,919 --> 00:26:55,520
down to is simply putting it in the

771
00:26:55,520 --> 00:26:57,760
format for atomic red team to be able to

772
00:26:57,760 --> 00:27:00,000
run that test in a more like kind of

773
00:27:00,000 --> 00:27:02,159
programmatic way i also had the chance

774
00:27:02,159 --> 00:27:03,919
to dip my toes into actually producing

775
00:27:03,919 --> 00:27:05,679
sigma rules recently i wrote my first

776
00:27:05,679 --> 00:27:07,440
one on the basis of some of this

777
00:27:07,440 --> 00:27:10,159
intelligence so looking at something on

778
00:27:10,159 --> 00:27:12,320
the inverse of what i just described an

779
00:27:12,320 --> 00:27:15,039
example where lots of tests existed so

780
00:27:15,039 --> 00:27:16,480
you could go out and actually run this

781
00:27:16,480 --> 00:27:18,080
in your environment and then just

782
00:27:18,080 --> 00:27:19,440
figuring out basically how could i

783
00:27:19,440 --> 00:27:21,600
actually go about detecting that

784
00:27:21,600 --> 00:27:24,880
in you know within a security tool

785
00:27:24,880 --> 00:27:26,720
so at a much higher level i think this

786
00:27:26,720 --> 00:27:28,159
is the thing that i'll kind of close out

787
00:27:28,159 --> 00:27:29,560
with here

788
00:27:29,560 --> 00:27:32,700
[Music]

789
00:27:33,520 --> 00:27:35,360
much higher level i know the text is a

790
00:27:35,360 --> 00:27:38,320
little bit small

791
00:27:40,880 --> 00:27:43,360
what we're seeing now is taking a huge

792
00:27:43,360 --> 00:27:45,279
step back and looking at these thousands

793
00:27:45,279 --> 00:27:47,120
of rules and tests that exist within the

794
00:27:47,120 --> 00:27:49,279
the overall data set where are we seeing

795
00:27:49,279 --> 00:27:51,840
kind of concentrations or clustering on

796
00:27:51,840 --> 00:27:54,559
a minor attack technique basis so the

797
00:27:54,559 --> 00:27:57,520
outside wheel is showing that top roll

798
00:27:57,520 --> 00:27:59,600
row of the end goals of

799
00:27:59,600 --> 00:28:01,520
attackers and now we're seeing where

800
00:28:01,520 --> 00:28:03,760
we're seeing clusters of detection rules

801
00:28:03,760 --> 00:28:06,080
versus uh you know these offensive

802
00:28:06,080 --> 00:28:08,480
security tests so what this is basically

803
00:28:08,480 --> 00:28:10,240
kind of highlighting is in this case

804
00:28:10,240 --> 00:28:12,480
let's look at discovery i know the

805
00:28:12,480 --> 00:28:14,080
colors are a little bit hard to see but

806
00:28:14,080 --> 00:28:16,480
what we're saying here is that there are

807
00:28:16,480 --> 00:28:18,480
a relatively large amount of tests that

808
00:28:18,480 --> 00:28:20,799
you can go out and run to perform these

809
00:28:20,799 --> 00:28:22,480
discovery techniques

810
00:28:22,480 --> 00:28:24,720
however there's not an equivalent kind

811
00:28:24,720 --> 00:28:27,760
of proportion of detection rules so for

812
00:28:27,760 --> 00:28:29,679
maybe more for the community's sake this

813
00:28:29,679 --> 00:28:31,440
is something that we would maybe want to

814
00:28:31,440 --> 00:28:32,799
increase we would want to beef up the

815
00:28:32,799 --> 00:28:34,320
amount of detections that we have in

816
00:28:34,320 --> 00:28:36,240
place maybe they get publicized in

817
00:28:36,240 --> 00:28:38,720
something like the sigma repository

818
00:28:38,720 --> 00:28:40,559
or at least for your own knowledge your

819
00:28:40,559 --> 00:28:42,320
awareness within your own environment

820
00:28:42,320 --> 00:28:43,840
you would maybe want to focus in on the

821
00:28:43,840 --> 00:28:45,520
discovery techniques

822
00:28:45,520 --> 00:28:47,600
this is not going to be easy there's

823
00:28:47,600 --> 00:28:49,200
likely a reason why we see these

824
00:28:49,200 --> 00:28:51,440
distributions that we do i think in this

825
00:28:51,440 --> 00:28:53,200
case it's pretty easy to run one of

826
00:28:53,200 --> 00:28:54,880
these discovery techniques it could be

827
00:28:54,880 --> 00:28:56,320
something as simple as just trying to

828
00:28:56,320 --> 00:28:58,720
search through your data in your system

829
00:28:58,720 --> 00:29:01,039
to see if files exist that you could go

830
00:29:01,039 --> 00:29:03,360
pull down on the flip side of that

831
00:29:03,360 --> 00:29:05,360
trying to detect that behavior and

832
00:29:05,360 --> 00:29:07,760
finding just the malicious instances of

833
00:29:07,760 --> 00:29:09,840
it is going to be pretty difficult to do

834
00:29:09,840 --> 00:29:11,760
because these are all behaviors that

835
00:29:11,760 --> 00:29:13,440
everyday users are going to utilize as

836
00:29:13,440 --> 00:29:15,039
well so i think there's reasons why we

837
00:29:15,039 --> 00:29:17,200
see the distributions we do but i do

838
00:29:17,200 --> 00:29:18,880
also think it's really interesting i've

839
00:29:18,880 --> 00:29:20,399
never quite seen a breakdown at this

840
00:29:20,399 --> 00:29:22,799
scale on these lines so i figured we had

841
00:29:22,799 --> 00:29:24,480
the data available why not kind of run

842
00:29:24,480 --> 00:29:25,679
this and i'm going to try to get a

843
00:29:25,679 --> 00:29:27,440
visualization like this into the tool

844
00:29:27,440 --> 00:29:29,520
itself pretty soon so you could toggle

845
00:29:29,520 --> 00:29:31,039
you know different tools and and how

846
00:29:31,039 --> 00:29:33,039
they shake out but that's uh that's a

847
00:29:33,039 --> 00:29:35,200
goal for this summer so came right up on

848
00:29:35,200 --> 00:29:37,520
time i apologize for that but i'm all

849
00:29:37,520 --> 00:29:39,679
set definitely uh open to answering any

850
00:29:39,679 --> 00:29:41,120
questions and thanks everyone for the

851
00:29:41,120 --> 00:29:44,360
time and attention

852
00:29:45,580 --> 00:29:49,280
[Applause]

853
00:29:54,480 --> 00:29:57,120
any questions

854
00:29:59,360 --> 00:30:00,159
no

855
00:30:00,159 --> 00:30:05,240
all right no worries oh yeah sorry

856
00:30:10,080 --> 00:30:12,480
for sure

857
00:30:12,480 --> 00:30:15,360
so let me quickly highlight um the miter

858
00:30:15,360 --> 00:30:18,399
defend tool

859
00:30:20,960 --> 00:30:22,880
so this is an example of something that

860
00:30:22,880 --> 00:30:24,799
we have pretty detailed pretty granular

861
00:30:24,799 --> 00:30:27,200
data in here for i'll pivot out directly

862
00:30:27,200 --> 00:30:29,679
to the tool itself so this is produced

863
00:30:29,679 --> 00:30:32,320
in conjunction with mitre and the nsa

864
00:30:32,320 --> 00:30:34,240
this is more i like to kind of call them

865
00:30:34,240 --> 00:30:36,320
like higher level or higher level

866
00:30:36,320 --> 00:30:38,000
countermeasures or steps that you could

867
00:30:38,000 --> 00:30:39,279
take

868
00:30:39,279 --> 00:30:40,880
it's a little bit more kind of policy

869
00:30:40,880 --> 00:30:42,559
and process based but it actually does

870
00:30:42,559 --> 00:30:44,080
kind of divide that line you have some

871
00:30:44,080 --> 00:30:46,720
very like technical operational counter

872
00:30:46,720 --> 00:30:48,080
measures that you could try to put in

873
00:30:48,080 --> 00:30:49,919
place here what they've done this is

874
00:30:49,919 --> 00:30:51,360
purely kind of from a defensive

875
00:30:51,360 --> 00:30:53,120
perspective what they've done though is

876
00:30:53,120 --> 00:30:54,720
mapped a lot of these as they define

877
00:30:54,720 --> 00:30:56,559
them countermeasures within the defend

878
00:30:56,559 --> 00:30:59,360
framework to attacker techniques and so

879
00:30:59,360 --> 00:31:00,960
you could kind of try to line that up as

880
00:31:00,960 --> 00:31:02,880
well so i'm not extremely actually

881
00:31:02,880 --> 00:31:04,799
well-versed in operationalizing this

882
00:31:04,799 --> 00:31:07,600
data but you can look at you know file

883
00:31:07,600 --> 00:31:09,360
content rules this is actually probably

884
00:31:09,360 --> 00:31:10,720
pretty similar to some of the examples

885
00:31:10,720 --> 00:31:12,480
that we walked through before

886
00:31:12,480 --> 00:31:14,720
and it's telling you know a process and

887
00:31:14,720 --> 00:31:16,880
policy that you could put into place and

888
00:31:16,880 --> 00:31:18,960
then which specific attacker techniques

889
00:31:18,960 --> 00:31:20,799
would this kind of line up with going

890
00:31:20,799 --> 00:31:24,320
back to the miter attack framework now

891
00:31:27,120 --> 00:31:30,600
all right thanks everyone

892
00:31:35,440 --> 00:31:37,519
you

