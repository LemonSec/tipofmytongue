1
00:00:00,420 --> 00:00:02,598
foreign

2
00:00:24,600 --> 00:00:26,760
so everybody uh having a really good

3
00:00:26,760 --> 00:00:28,340
time so far good event

4
00:00:28,340 --> 00:00:32,159
there we go that's what I like

5
00:00:32,159 --> 00:00:34,079
so we're going to talk a little bit

6
00:00:34,079 --> 00:00:36,780
about malware analysis ultimately in

7
00:00:36,780 --> 00:00:38,160
Canada to get into this before we get to

8
00:00:38,160 --> 00:00:40,620
all the disclaimers and stuff I built

9
00:00:40,620 --> 00:00:42,840
this to make the concept of malware

10
00:00:42,840 --> 00:00:44,820
analysis accessible

11
00:00:44,820 --> 00:00:46,500
because a bunch of people were coming to

12
00:00:46,500 --> 00:00:48,180
me and even me early in my career I said

13
00:00:48,180 --> 00:00:49,559
I really want to do malware and

14
00:00:49,559 --> 00:00:50,640
everybody said

15
00:00:50,640 --> 00:00:51,840
you can't

16
00:00:51,840 --> 00:00:53,460
said well why can't I they said it's

17
00:00:53,460 --> 00:00:56,480
dangerous it's too hard you can't do it

18
00:00:56,480 --> 00:00:59,280
so make no mistake this is very

19
00:00:59,280 --> 00:01:01,680
everybody here can take this stuff and

20
00:01:01,680 --> 00:01:02,820
go do it

21
00:01:02,820 --> 00:01:04,438
and I'll give you some tips on how to be

22
00:01:04,438 --> 00:01:05,820
safe with that and stuff but it is not

23
00:01:05,820 --> 00:01:08,700
in any way Advanced I'm not breaking any

24
00:01:08,700 --> 00:01:10,680
ground I'm not doing anything amazing

25
00:01:10,680 --> 00:01:13,740
this is accessible for everybody

26
00:01:13,740 --> 00:01:15,240
So for anybody who didn't see my talk

27
00:01:15,240 --> 00:01:18,540
yesterday I am Sean or understudy I am

28
00:01:18,540 --> 00:01:20,040
the head of forensics and incident

29
00:01:20,040 --> 00:01:22,200
response engineering at Yahoo

30
00:01:22,200 --> 00:01:25,140
I will disclaim now that none of what

31
00:01:25,140 --> 00:01:26,220
we're going to talk about today has

32
00:01:26,220 --> 00:01:27,720
anything to do with Yahoo to make my

33
00:01:27,720 --> 00:01:30,299
legal rep happy who's here

34
00:01:30,299 --> 00:01:31,560
um I've been giving this talk long

35
00:01:31,560 --> 00:01:34,079
before I get one to Yahoo actually from

36
00:01:34,079 --> 00:01:36,180
my breach consultant days where I used

37
00:01:36,180 --> 00:01:37,619
to travel around and do threat hunting

38
00:01:37,619 --> 00:01:39,000
and like help people out through major

39
00:01:39,000 --> 00:01:41,280
breaches and malware outbreaks I've

40
00:01:41,280 --> 00:01:43,439
worked a lot of malware outbreaks in

41
00:01:43,439 --> 00:01:45,240
that time it's all secular everything

42
00:01:45,240 --> 00:01:47,759
just kind of goes you'll get like dry

43
00:01:47,759 --> 00:01:49,500
decks for a while and emotec for a while

44
00:01:49,500 --> 00:01:51,360
and then crypto miners for a while and

45
00:01:51,360 --> 00:01:54,060
then it all comes back

46
00:01:54,060 --> 00:01:56,820
um and full disclaimer I'm Rusty on this

47
00:01:56,820 --> 00:01:58,979
topic that Top Line right there head of

48
00:01:58,979 --> 00:02:01,259
that means I'm in management that means

49
00:02:01,259 --> 00:02:03,060
I don't do real work that means other

50
00:02:03,060 --> 00:02:05,219
people do real work and they make me

51
00:02:05,219 --> 00:02:07,799
look good but I've always liked talking

52
00:02:07,799 --> 00:02:09,538
about this and teaching this topic so I

53
00:02:09,538 --> 00:02:11,879
continue to do it so again been a while

54
00:02:11,879 --> 00:02:13,379
since I've done it every day

55
00:02:13,379 --> 00:02:16,080
there's a lot more than what I'm going

56
00:02:16,080 --> 00:02:18,480
to cover this is like the tip of the

57
00:02:18,480 --> 00:02:19,620
iceberg

58
00:02:19,620 --> 00:02:22,560
of what you can do and accomplish and to

59
00:02:22,560 --> 00:02:24,060
continue to level set this is an

60
00:02:24,060 --> 00:02:25,980
introduction I'm not going to go through

61
00:02:25,980 --> 00:02:27,959
like line by line on like every registry

62
00:02:27,959 --> 00:02:30,000
change or any of that stuff and like go

63
00:02:30,000 --> 00:02:31,440
through what all those look like and

64
00:02:31,440 --> 00:02:33,180
what they mean I'm going to show you the

65
00:02:33,180 --> 00:02:35,099
tools that will do that and then you can

66
00:02:35,099 --> 00:02:36,900
take this and expand on it to go look

67
00:02:36,900 --> 00:02:38,400
into stuff yourself and play with

68
00:02:38,400 --> 00:02:39,840
samples and do things

69
00:02:39,840 --> 00:02:42,239
we are going to run real malware like

70
00:02:42,239 --> 00:02:44,160
that is part of this so there's only a

71
00:02:44,160 --> 00:02:45,840
couple slides and then we're going to

72
00:02:45,840 --> 00:02:47,519
start playing with real malware on the

73
00:02:47,519 --> 00:02:48,959
hotel Wi-Fi so y'all might want to get

74
00:02:48,959 --> 00:02:50,340
off the hotel Wi-Fi

75
00:02:50,340 --> 00:02:52,680
just saying

76
00:02:52,680 --> 00:02:55,200
so what we're going to use is a whole

77
00:02:55,200 --> 00:02:56,760
bunch of different stuff this is an old

78
00:02:56,760 --> 00:02:59,640
version of Ubuntu 1404 with remnox

79
00:02:59,640 --> 00:03:02,480
remnox is a freely available open source

80
00:03:02,480 --> 00:03:05,640
malware analysis distro there are

81
00:03:05,640 --> 00:03:08,000
several others FireEye has flare

82
00:03:08,000 --> 00:03:10,920
to saragi is relatively new and kind of

83
00:03:10,920 --> 00:03:12,959
cool I've always liked remnox because

84
00:03:12,959 --> 00:03:14,159
that's kind of what I work in and I'm

85
00:03:14,159 --> 00:03:16,739
comfortable there cyber Chef does

86
00:03:16,739 --> 00:03:19,620
anybody know what cyber Chef is

87
00:03:19,620 --> 00:03:22,140
like cyber Chef is super magical because

88
00:03:22,140 --> 00:03:23,940
you can give it code and give it a

89
00:03:23,940 --> 00:03:25,200
formula and it will make the code

90
00:03:25,200 --> 00:03:26,459
something else and we'll see that

91
00:03:26,459 --> 00:03:27,780
because it's really cool

92
00:03:27,780 --> 00:03:29,519
we're going to use some command line

93
00:03:29,519 --> 00:03:31,620
tools to like look at the contents of

94
00:03:31,620 --> 00:03:33,420
PDFs to look at the contents of Word

95
00:03:33,420 --> 00:03:35,940
documents and vbas that exist and we're

96
00:03:35,940 --> 00:03:37,560
also going to jump into a VM and we're

97
00:03:37,560 --> 00:03:39,239
going to look at like how processes run

98
00:03:39,239 --> 00:03:41,879
and how registry changes happen and how

99
00:03:41,879 --> 00:03:43,560
we can watch Network traffic in

100
00:03:43,560 --> 00:03:45,360
different ways to do that and if we have

101
00:03:45,360 --> 00:03:47,519
time which again I can't see the timer

102
00:03:47,519 --> 00:03:49,500
so we're going to wing it

103
00:03:49,500 --> 00:03:51,480
we'll look into cuckoo sandbox so we'll

104
00:03:51,480 --> 00:03:52,680
basically take the things that we're

105
00:03:52,680 --> 00:03:54,000
going to talk about doing manually and

106
00:03:54,000 --> 00:03:55,560
we'll go through the automated process

107
00:03:55,560 --> 00:03:57,900
of those things and how you can use that

108
00:03:57,900 --> 00:03:59,459
I've always been a big fan of try to do

109
00:03:59,459 --> 00:04:01,080
it manually first before you automate

110
00:04:01,080 --> 00:04:03,120
something that will bring you a level of

111
00:04:03,120 --> 00:04:04,560
understanding of what you look at that's

112
00:04:04,560 --> 00:04:06,120
valuable

113
00:04:06,120 --> 00:04:09,239
so the setup assume that you are a

114
00:04:09,239 --> 00:04:11,459
security Analyst at The Daily Bugle I

115
00:04:11,459 --> 00:04:12,780
love that picture

116
00:04:12,780 --> 00:04:14,640
you got an alert or a notification about

117
00:04:14,640 --> 00:04:16,738
an email that has an attachment of a PDF

118
00:04:16,738 --> 00:04:18,540
you've been sent a copy of that

119
00:04:18,540 --> 00:04:19,620
attachment

120
00:04:19,620 --> 00:04:21,120
to look into

121
00:04:21,120 --> 00:04:23,820
now we get to go into the good part

122
00:04:23,820 --> 00:04:26,360
so

123
00:04:26,400 --> 00:04:28,740
everything is kind of laid out very

124
00:04:28,740 --> 00:04:30,960
nicely in here for me

125
00:04:30,960 --> 00:04:33,419
so right here if you can see this step

126
00:04:33,419 --> 00:04:36,120
one that's our PDF by the way I don't

127
00:04:36,120 --> 00:04:37,620
mind pictures or anything so like if

128
00:04:37,620 --> 00:04:38,580
people want to take pictures of the

129
00:04:38,580 --> 00:04:40,440
screen or the commands I have slides

130
00:04:40,440 --> 00:04:41,699
later that are really good to take

131
00:04:41,699 --> 00:04:43,620
pictures of that will walk through like

132
00:04:43,620 --> 00:04:45,300
specific commands and places that you

133
00:04:45,300 --> 00:04:47,940
can go and resources and stuff

134
00:04:47,940 --> 00:04:51,440
so if we go and pop open

135
00:04:51,540 --> 00:04:53,880
the terminal which I have a special big

136
00:04:53,880 --> 00:04:56,160
one just for everybody

137
00:04:56,160 --> 00:04:58,740
we have this PDF we can go open this PDF

138
00:04:58,740 --> 00:05:01,259
see what it does and we'll do that too

139
00:05:01,259 --> 00:05:02,639
but there's a couple tools that you can

140
00:05:02,639 --> 00:05:04,259
use just right off the cuff to look into

141
00:05:04,259 --> 00:05:06,900
a PDF right from a command line

142
00:05:06,900 --> 00:05:09,840
one of them is called PDF ID and all PDF

143
00:05:09,840 --> 00:05:11,639
ID is going to do is tell you a couple

144
00:05:11,639 --> 00:05:12,840
things

145
00:05:12,840 --> 00:05:15,240
so if I look at

146
00:05:15,240 --> 00:05:17,699
PDF ID on step one

147
00:05:17,699 --> 00:05:20,820
that's going to tell me stuff about this

148
00:05:20,820 --> 00:05:22,620
file now one of the things that's really

149
00:05:22,620 --> 00:05:24,300
interesting about this and again like

150
00:05:24,300 --> 00:05:25,440
I'm not going to go through every one of

151
00:05:25,440 --> 00:05:26,759
those that would take all day just on

152
00:05:26,759 --> 00:05:28,680
this

153
00:05:28,680 --> 00:05:30,539
third from the top

154
00:05:30,539 --> 00:05:33,600
embedded file one

155
00:05:33,600 --> 00:05:36,300
this PDF has an embedded file

156
00:05:36,300 --> 00:05:38,580
that's kind of interesting what is in

157
00:05:38,580 --> 00:05:41,580
this PDF why is there a file there

158
00:05:41,580 --> 00:05:42,840
well we can look at that a couple

159
00:05:42,840 --> 00:05:44,520
different ways we can use something

160
00:05:44,520 --> 00:05:47,599
called PDF parser

161
00:05:51,600 --> 00:05:54,660
and I need to do a more on that

162
00:05:54,660 --> 00:05:56,460
So for anybody not familiar with Linux

163
00:05:56,460 --> 00:05:58,259
is everybody kind of Baseline familiar

164
00:05:58,259 --> 00:06:00,539
with Linux and like how to use

165
00:06:00,539 --> 00:06:01,740
okay I'm going to work on that

166
00:06:01,740 --> 00:06:03,780
assumption for now I have given this

167
00:06:03,780 --> 00:06:07,020
talk from middle schoolers to Defcon

168
00:06:07,020 --> 00:06:08,819
so I try to adjust it for the audience

169
00:06:08,819 --> 00:06:10,740
as much as necessary

170
00:06:10,740 --> 00:06:12,600
so if we go through this we can see all

171
00:06:12,600 --> 00:06:14,220
right there's our embedded file let's

172
00:06:14,220 --> 00:06:16,199
look at some more

173
00:06:16,199 --> 00:06:19,340
oh type file spec

174
00:06:19,340 --> 00:06:22,380
602803 dot doc m

175
00:06:22,380 --> 00:06:24,600
anybody know what a doc m is

176
00:06:24,600 --> 00:06:26,400
good

177
00:06:26,400 --> 00:06:29,100
exactly a doc m is a document that

178
00:06:29,100 --> 00:06:31,680
contains a macro so it contains VB code

179
00:06:31,680 --> 00:06:34,139
that can run in a document if you enable

180
00:06:34,139 --> 00:06:35,819
it because computers are smarter than

181
00:06:35,819 --> 00:06:36,780
they used to be where they're always

182
00:06:36,780 --> 00:06:37,860
enabled

183
00:06:37,860 --> 00:06:40,199
so we can look at this an easier way

184
00:06:40,199 --> 00:06:42,360
though too we can use the same thing

185
00:06:42,360 --> 00:06:43,620
that we would use if we wanted to pull

186
00:06:43,620 --> 00:06:45,660
out that file and that's called PDF

187
00:06:45,660 --> 00:06:48,080
detach

188
00:06:49,680 --> 00:06:52,639
if you do a list

189
00:06:53,340 --> 00:06:55,500
step one

190
00:06:55,500 --> 00:06:57,180
there you go one embedded file that's

191
00:06:57,180 --> 00:06:58,680
what it is

192
00:06:58,680 --> 00:07:00,840
now if I want that file

193
00:07:00,840 --> 00:07:02,940
because obviously I want that file right

194
00:07:02,940 --> 00:07:05,039
that's that's the interesting thing for

195
00:07:05,039 --> 00:07:06,060
me

196
00:07:06,060 --> 00:07:07,620
well there's only one file so I'm just

197
00:07:07,620 --> 00:07:10,340
going to do a save all

198
00:07:10,500 --> 00:07:12,120
that's just going to go save that file

199
00:07:12,120 --> 00:07:13,440
for me

200
00:07:13,440 --> 00:07:15,900
if I pop back into my folder

201
00:07:15,900 --> 00:07:18,300
my document is there

202
00:07:18,300 --> 00:07:19,620
so now we have a couple different ways

203
00:07:19,620 --> 00:07:21,360
that we can approach the document

204
00:07:21,360 --> 00:07:23,099
the first thing that we'll do before we

205
00:07:23,099 --> 00:07:24,479
actually dive into like looking at the

206
00:07:24,479 --> 00:07:26,639
code is I'll just go open it up

207
00:07:26,639 --> 00:07:28,139
and then we'll talk about like looking

208
00:07:28,139 --> 00:07:30,720
at how we can extract different things

209
00:07:30,720 --> 00:07:34,880
it's gonna pop open a VM here

210
00:07:35,220 --> 00:07:38,599
I'm going to grab my document

211
00:07:39,539 --> 00:07:41,759
yank it over

212
00:07:41,759 --> 00:07:43,800
eventually

213
00:07:43,800 --> 00:07:45,660
there's a hefty demo component to this

214
00:07:45,660 --> 00:07:47,340
by the way so everybody has to bear with

215
00:07:47,340 --> 00:07:48,660
me

216
00:07:48,660 --> 00:07:51,419
everybody says that I am a brave to give

217
00:07:51,419 --> 00:07:54,680
a talk that is all demo

218
00:07:57,000 --> 00:07:59,340
you're gonna grab there we go

219
00:07:59,340 --> 00:08:00,840
so we're going to use a couple different

220
00:08:00,840 --> 00:08:03,000
tools to look at this

221
00:08:03,000 --> 00:08:05,819
we're going to use process Explorer

222
00:08:05,819 --> 00:08:07,860
which is a free Windows system internal

223
00:08:07,860 --> 00:08:09,060
tool basically every tool that we're

224
00:08:09,060 --> 00:08:10,020
going to talk about completely and

225
00:08:10,020 --> 00:08:12,000
totally free by the way so there's zero

226
00:08:12,000 --> 00:08:13,860
investment on anybody's part to do any

227
00:08:13,860 --> 00:08:17,180
of this if they want to do it at home

228
00:08:17,879 --> 00:08:21,120
it's going to start eventually I promise

229
00:08:21,120 --> 00:08:23,900
there we go

230
00:08:25,440 --> 00:08:27,120
and we're going to use another tool and

231
00:08:27,120 --> 00:08:28,860
if if anybody's done this before you all

232
00:08:28,860 --> 00:08:31,319
are probably familiar with Wireshark

233
00:08:31,319 --> 00:08:33,659
we'll get into Wireshark a bit later

234
00:08:33,659 --> 00:08:35,159
we're going to use another tool called

235
00:08:35,159 --> 00:08:36,839
Fiddler for this

236
00:08:36,839 --> 00:08:38,820
I actually really like fidget Fiddler

237
00:08:38,820 --> 00:08:40,140
because I like the way it lays out

238
00:08:40,140 --> 00:08:41,279
information

239
00:08:41,279 --> 00:08:44,159
but it really only handles URL requests

240
00:08:44,159 --> 00:08:45,839
it doesn't particularly do a good job

241
00:08:45,839 --> 00:08:47,580
with IPS and stuff depending on what

242
00:08:47,580 --> 00:08:49,860
they are it's basically just it's a it's

243
00:08:49,860 --> 00:08:51,240
a web debugger

244
00:08:51,240 --> 00:08:53,820
but it looks good

245
00:08:53,820 --> 00:08:55,860
so when we run this

246
00:08:55,860 --> 00:08:57,720
we want to see what happens in process

247
00:08:57,720 --> 00:08:59,220
Explorer more than anything else because

248
00:08:59,220 --> 00:09:00,899
process Explorer's contents are subject

249
00:09:00,899 --> 00:09:03,120
to change as new things happen that go

250
00:09:03,120 --> 00:09:05,160
away a long long time ago there was a

251
00:09:05,160 --> 00:09:06,839
tool called HP Gary's fly paper that

252
00:09:06,839 --> 00:09:08,459
doesn't exist since Anonymous attacked

253
00:09:08,459 --> 00:09:09,600
HP Gary

254
00:09:09,600 --> 00:09:11,399
and I can't find a copy of it anywhere

255
00:09:11,399 --> 00:09:12,540
and I don't know if there's an

256
00:09:12,540 --> 00:09:14,279
alternative for it that does not allow

257
00:09:14,279 --> 00:09:16,980
processes to close but for now you just

258
00:09:16,980 --> 00:09:18,480
got to pay very close attention down

259
00:09:18,480 --> 00:09:22,080
here as I start to run stuff

260
00:09:22,080 --> 00:09:24,000
we can just drop Fiddler over here in a

261
00:09:24,000 --> 00:09:25,320
corner and look at it later because

262
00:09:25,320 --> 00:09:27,480
that's going to save everything

263
00:09:27,480 --> 00:09:31,100
so we'll open our Word document first

264
00:09:31,440 --> 00:09:32,940
shrink this down move it over to this

265
00:09:32,940 --> 00:09:33,899
side

266
00:09:33,899 --> 00:09:37,019
you can see windward.exe right here

267
00:09:37,019 --> 00:09:39,660
now let's enable that macro

268
00:09:39,660 --> 00:09:42,740
now let's see what happens

269
00:09:43,019 --> 00:09:45,300
oh windward.exe just did some stuff

270
00:09:45,300 --> 00:09:46,920
including some Powershell and that's

271
00:09:46,920 --> 00:09:49,620
that's just a lot of stuff

272
00:09:49,620 --> 00:09:52,920
so windward.exe launched a macro which

273
00:09:52,920 --> 00:09:55,320
turned on Powershell Powershell went out

274
00:09:55,320 --> 00:09:57,060
did some numbers

275
00:09:57,060 --> 00:09:58,680
right now we'll just say Powershell did

276
00:09:58,680 --> 00:10:00,180
numbers

277
00:10:00,180 --> 00:10:03,600
because that's pretty much what this is

278
00:10:03,600 --> 00:10:05,760
there's an easier way to document and

279
00:10:05,760 --> 00:10:07,500
find this though

280
00:10:07,500 --> 00:10:09,959
it's a tool called

281
00:10:09,959 --> 00:10:13,160
Ole VBA

282
00:10:14,100 --> 00:10:19,040
if you decode with Ole VBA

283
00:10:19,140 --> 00:10:20,700
on step two

284
00:10:20,700 --> 00:10:22,740
now we'll need some more of this

285
00:10:22,740 --> 00:10:24,240
now it's going to tell us everything

286
00:10:24,240 --> 00:10:27,480
about this macro

287
00:10:27,480 --> 00:10:31,260
so we have CMD exe that's what launched

288
00:10:31,260 --> 00:10:32,700
right when we open the word document

289
00:10:32,700 --> 00:10:34,680
Powershell

290
00:10:34,680 --> 00:10:37,140
window style hidden executable bypass

291
00:10:37,140 --> 00:10:39,060
all different Powershell commands to do

292
00:10:39,060 --> 00:10:41,579
different things mostly to hide its own

293
00:10:41,579 --> 00:10:44,940
process and then we get into this string

294
00:10:44,940 --> 00:10:47,220
of numbers

295
00:10:47,220 --> 00:10:49,920
numbers numbers numbers numbers numbers

296
00:10:49,920 --> 00:10:51,420
lots of numbers and then a little bit

297
00:10:51,420 --> 00:10:53,399
kind of at the end

298
00:10:53,399 --> 00:10:55,440
and the nice thing about Ole VBA is it

299
00:10:55,440 --> 00:10:57,420
will also tell you some other stuff so

300
00:10:57,420 --> 00:11:00,240
runs when it's open might run a

301
00:11:00,240 --> 00:11:03,800
suspicious file has some hex strings has

302
00:11:03,800 --> 00:11:05,700
cmd.exe so it'll give you a couple

303
00:11:05,700 --> 00:11:07,740
indicators that can be really useful to

304
00:11:07,740 --> 00:11:09,180
understand what goes on as well as

305
00:11:09,180 --> 00:11:10,920
giving you the content

306
00:11:10,920 --> 00:11:14,660
but what you do is you take that content

307
00:11:15,480 --> 00:11:18,660
copy and paste that out

308
00:11:18,660 --> 00:11:21,600
gotta go all the way over here

309
00:11:21,600 --> 00:11:24,000
there's our whole content

310
00:11:24,000 --> 00:11:26,519
what we want though is everything from

311
00:11:26,519 --> 00:11:28,440
those numbers that's the part that's

312
00:11:28,440 --> 00:11:29,519
important

313
00:11:29,519 --> 00:11:31,860
those numbers in the parenthesis down to

314
00:11:31,860 --> 00:11:35,640
the bottom that's our encoded text

315
00:11:35,640 --> 00:11:37,680
document

316
00:11:37,680 --> 00:11:39,600
from there we'll jump into

317
00:11:39,600 --> 00:11:44,700
cuckoo or not cuckoo sorry cyber chef

318
00:11:44,700 --> 00:11:47,940
this is decimal encoded effectively

319
00:11:47,940 --> 00:11:50,399
so numbers and it's decimal encoded

320
00:11:50,399 --> 00:11:51,959
comma delimited

321
00:11:51,959 --> 00:11:54,480
and if you take a look at Cyber Chef you

322
00:11:54,480 --> 00:11:55,740
can see there's there's a billion

323
00:11:55,740 --> 00:11:57,420
different things that you can look into

324
00:11:57,420 --> 00:11:59,240
and do with it

325
00:11:59,240 --> 00:12:02,639
hexadecimal decimal base64. every

326
00:12:02,639 --> 00:12:03,899
challenge coin I've ever designed I

327
00:12:03,899 --> 00:12:05,220
literally write something put it into

328
00:12:05,220 --> 00:12:07,320
base64 and then put base64 around the

329
00:12:07,320 --> 00:12:08,519
outside

330
00:12:08,519 --> 00:12:12,060
like and cyber Chef is great for that

331
00:12:12,060 --> 00:12:15,300
so if we use this decimal piece here

332
00:12:15,300 --> 00:12:18,000
now we have data that's now going to

333
00:12:18,000 --> 00:12:19,800
start telling us stuff that's what that

334
00:12:19,800 --> 00:12:21,959
code does computer interprets decimal

335
00:12:21,959 --> 00:12:24,540
code does these things here's what your

336
00:12:24,540 --> 00:12:25,740
code looks like but there's further

337
00:12:25,740 --> 00:12:26,940
encoding in here and we're going to get

338
00:12:26,940 --> 00:12:29,720
to that in a minute too

339
00:12:29,760 --> 00:12:32,279
so we can scroll through this and we can

340
00:12:32,279 --> 00:12:33,779
look at everything that it does but to

341
00:12:33,779 --> 00:12:34,980
make it easier

342
00:12:34,980 --> 00:12:37,800
I'm going to open it up

343
00:12:37,800 --> 00:12:40,680
over here

344
00:12:40,680 --> 00:12:43,880
because I should have that too

345
00:12:45,360 --> 00:12:47,399
I do not well that's cool we'll look at

346
00:12:47,399 --> 00:12:49,680
it here

347
00:12:49,680 --> 00:12:51,180
so one of the things that you'll see as

348
00:12:51,180 --> 00:12:53,459
we go through this though you see like

349
00:12:53,459 --> 00:12:55,019
urls

350
00:12:55,019 --> 00:12:57,120
URLs is really interesting

351
00:12:57,120 --> 00:12:58,920
let's take that and pivot back over here

352
00:12:58,920 --> 00:13:00,180
for a second

353
00:13:00,180 --> 00:13:03,800
let's go look at that Fiddler output

354
00:13:05,100 --> 00:13:07,019
so much crap

355
00:13:07,019 --> 00:13:09,000
right here

356
00:13:09,000 --> 00:13:12,000
that looks strange both of those two

357
00:13:12,000 --> 00:13:13,740
none of those are like tools that are

358
00:13:13,740 --> 00:13:15,300
trying to execute on the system those

359
00:13:15,300 --> 00:13:16,980
all happened after we ran Powershell by

360
00:13:16,980 --> 00:13:18,300
the way all this infrastructure for this

361
00:13:18,300 --> 00:13:20,279
piece of malware is all dead that's why

362
00:13:20,279 --> 00:13:21,839
it's broken up into each individual

363
00:13:21,839 --> 00:13:25,260
piece of the copy because it's all dead

364
00:13:25,260 --> 00:13:28,320
so we have these three things that were

365
00:13:28,320 --> 00:13:30,360
attempted to reach out to Martin J

366
00:13:30,360 --> 00:13:34,560
Feller Audio HD and uchida shika

367
00:13:34,560 --> 00:13:35,940
foreign

368
00:13:35,940 --> 00:13:38,459
well let's take a look and go back over

369
00:13:38,459 --> 00:13:40,699
to

370
00:13:42,420 --> 00:13:44,820
these URLs well

371
00:13:44,820 --> 00:13:47,399
how do we get those so if you look at

372
00:13:47,399 --> 00:13:48,720
the way that's laid out you see how it's

373
00:13:48,720 --> 00:13:50,639
number number

374
00:13:50,639 --> 00:13:52,620
and then you'll see

375
00:13:52,620 --> 00:13:54,720
just like after the attack F you'll see

376
00:13:54,720 --> 00:13:58,459
in single quotes like HTTP TTP

377
00:13:58,459 --> 00:14:01,620
y45 so on and so forth

378
00:14:01,620 --> 00:14:04,079
so it's basically like a shift so that

379
00:14:04,079 --> 00:14:06,540
number 10 is the 10th thing if you count

380
00:14:06,540 --> 00:14:09,000
along there the number one is the first

381
00:14:09,000 --> 00:14:12,199
thing if you count along there

382
00:14:12,779 --> 00:14:15,920
so there is a

383
00:14:17,699 --> 00:14:19,980
how-to that exists right here so you

384
00:14:19,980 --> 00:14:22,560
break up each one of those from 0 to 20

385
00:14:22,560 --> 00:14:25,079
because there's 20. and then you put

386
00:14:25,079 --> 00:14:26,459
them together

387
00:14:26,459 --> 00:14:30,540
10 1 13 25 and that'll build out your

388
00:14:30,540 --> 00:14:32,880
whole list of urls

389
00:14:32,880 --> 00:14:35,220
and do those three look familiar to the

390
00:14:35,220 --> 00:14:37,260
three that we just saw a second ago

391
00:14:37,260 --> 00:14:39,060
was that not a much easier way to do

392
00:14:39,060 --> 00:14:41,399
this actually that part right there like

393
00:14:41,399 --> 00:14:43,980
doing that takes a little bit of time

394
00:14:43,980 --> 00:14:47,160
but this is a minimum a much safer way

395
00:14:47,160 --> 00:14:48,720
to do this because you don't actually

396
00:14:48,720 --> 00:14:51,620
have to execute anything

397
00:14:52,440 --> 00:14:54,839
so we can do that across the whole thing

398
00:14:54,839 --> 00:14:57,540
and then we'll get to

399
00:14:57,540 --> 00:14:59,279
a finished

400
00:14:59,279 --> 00:15:01,680
section oh there it is without the stuff

401
00:15:01,680 --> 00:15:04,880
I knew I had it

402
00:15:06,120 --> 00:15:08,040
so this is the second talk and Sunday is

403
00:15:08,040 --> 00:15:11,899
always hard because I'm always so tired

404
00:15:12,360 --> 00:15:13,560
so let's take a look at that

405
00:15:13,560 --> 00:15:15,720
de-obfuscated now there's a whole thing

406
00:15:15,720 --> 00:15:17,100
put together

407
00:15:17,100 --> 00:15:20,880
so hit command exe use Powershell

408
00:15:20,880 --> 00:15:24,660
Windows style hidden executable bypass

409
00:15:24,660 --> 00:15:28,320
set item item to file xor

410
00:15:28,320 --> 00:15:31,079
xor key

411
00:15:31,079 --> 00:15:34,079
URLs go here so go here download

412
00:15:34,079 --> 00:15:35,639
something

413
00:15:35,639 --> 00:15:38,160
write to host URL so write whatever

414
00:15:38,160 --> 00:15:41,959
comes from the host to the URL

415
00:15:42,120 --> 00:15:44,759
and then do some a couple other things

416
00:15:44,759 --> 00:15:47,940
here right so use that on xor to make

417
00:15:47,940 --> 00:15:49,620
that thing that's downloaded function

418
00:15:49,620 --> 00:15:51,660
I'm totally not going to get into the

419
00:15:51,660 --> 00:15:53,160
whole concept of like X worrying and all

420
00:15:53,160 --> 00:15:54,360
that stuff because one I don't remember

421
00:15:54,360 --> 00:15:57,060
most of it into again that would be like

422
00:15:57,060 --> 00:15:58,259
a whole talk

423
00:15:58,259 --> 00:16:01,440
but it's saying very directly right this

424
00:16:01,440 --> 00:16:04,199
Fiat cmm.exe

425
00:16:04,199 --> 00:16:06,060
after you download a file from here

426
00:16:06,060 --> 00:16:08,699
write it as this and then do some stuff

427
00:16:08,699 --> 00:16:10,920
to it so it becomes what it's supposed

428
00:16:10,920 --> 00:16:12,839
to be so if you did what most people

429
00:16:12,839 --> 00:16:14,339
didn't just grab this URL and went out

430
00:16:14,339 --> 00:16:15,959
and did a w get for it so you could go

431
00:16:15,959 --> 00:16:17,820
pull down the file safely it's not a

432
00:16:17,820 --> 00:16:19,560
complete file

433
00:16:19,560 --> 00:16:22,620
we can actually look at that

434
00:16:22,620 --> 00:16:26,180
because I have both of them

435
00:16:26,579 --> 00:16:29,339
so step seven being the file when you go

436
00:16:29,339 --> 00:16:30,899
out in wget Step eight being the

437
00:16:30,899 --> 00:16:33,500
completed file

438
00:16:36,540 --> 00:16:39,480
we'll pull a hash on that

439
00:16:39,480 --> 00:16:40,920
and then we'll pull a hash on the next

440
00:16:40,920 --> 00:16:43,040
one

441
00:16:46,440 --> 00:16:48,899
they are not the same and that is

442
00:16:48,899 --> 00:16:50,639
because there's a specific piece in that

443
00:16:50,639 --> 00:16:53,459
BB code that changes them and changes

444
00:16:53,459 --> 00:16:55,740
the file with that xor to make it

445
00:16:55,740 --> 00:16:58,380
actually function and work

446
00:16:58,380 --> 00:17:00,180
good to know as you're coming into this

447
00:17:00,180 --> 00:17:03,380
and looking at some of this stuff

448
00:17:05,099 --> 00:17:06,959
so

449
00:17:06,959 --> 00:17:11,220
we'll come back over to this maybe

450
00:17:13,199 --> 00:17:15,539
so we have a copy of this file we know

451
00:17:15,539 --> 00:17:17,400
what this does we know where it calls

452
00:17:17,400 --> 00:17:19,140
out to to get the file we know what the

453
00:17:19,140 --> 00:17:20,640
file is going to be named when it drops

454
00:17:20,640 --> 00:17:21,959
and we know where we're going to go to

455
00:17:21,959 --> 00:17:24,119
next now we're going to move away from

456
00:17:24,119 --> 00:17:25,619
the command line back-end stuff that's

457
00:17:25,619 --> 00:17:27,119
giving us this information and I'm going

458
00:17:27,119 --> 00:17:30,198
to actually go run this file

459
00:17:30,900 --> 00:17:33,960
this is like the fun part

460
00:17:33,960 --> 00:17:35,400
so we'll get rid of Fiddler we'll move

461
00:17:35,400 --> 00:17:37,500
into Wireshark for this we'll keep

462
00:17:37,500 --> 00:17:40,260
process Explorer

463
00:17:40,260 --> 00:17:43,400
open up Wireshark

464
00:17:45,360 --> 00:17:48,439
start a capture

465
00:17:49,080 --> 00:17:51,059
I'm really only going to focus on TCP

466
00:17:51,059 --> 00:17:53,299
traffic

467
00:17:53,880 --> 00:17:55,799
if that works because there isn't any

468
00:17:55,799 --> 00:17:57,980
yet

469
00:18:00,539 --> 00:18:02,160
copy our file over here and hopefully

470
00:18:02,160 --> 00:18:04,260
this has been on long enough

471
00:18:04,260 --> 00:18:06,900
that

472
00:18:06,900 --> 00:18:08,820
I won't have too much junk that's trying

473
00:18:08,820 --> 00:18:10,500
to get run when we when we do a couple

474
00:18:10,500 --> 00:18:12,179
other things here

475
00:18:12,179 --> 00:18:13,799
so there's another tool so we've talked

476
00:18:13,799 --> 00:18:15,240
about process Explorer a little bit and

477
00:18:15,240 --> 00:18:16,559
Wireshark and we'll get to that let's

478
00:18:16,559 --> 00:18:19,140
talk about reg shot for a second

479
00:18:19,140 --> 00:18:21,000
basically reg shot will go take a look

480
00:18:21,000 --> 00:18:22,919
at your Windows registry which the

481
00:18:22,919 --> 00:18:24,539
Windows registry is a massive pile of

482
00:18:24,539 --> 00:18:25,320
crap

483
00:18:25,320 --> 00:18:27,480
it will take a picture of it

484
00:18:27,480 --> 00:18:29,160
and then you take a second picture of it

485
00:18:29,160 --> 00:18:31,860
and it will compare those two pictures

486
00:18:31,860 --> 00:18:34,140
you would be amazed

487
00:18:34,140 --> 00:18:37,140
how much everything touches the registry

488
00:18:37,140 --> 00:18:39,660
go install Discord on a Windows box run

489
00:18:39,660 --> 00:18:42,059
reg shot before you do it it'll change

490
00:18:42,059 --> 00:18:44,100
like 500 things in your registry like

491
00:18:44,100 --> 00:18:46,080
that's just what every application does

492
00:18:46,080 --> 00:18:47,700
because the registry is a giant piece of

493
00:18:47,700 --> 00:18:48,600
crap

494
00:18:48,600 --> 00:18:51,179
sorry I'm not a Windows fan in any way

495
00:18:51,179 --> 00:18:53,039
shape or form I think I did incident

496
00:18:53,039 --> 00:18:55,020
response long enough to kind of develop

497
00:18:55,020 --> 00:18:58,039
a hatred for Windows

498
00:19:01,919 --> 00:19:04,500
but let's take a snapshot

499
00:19:04,500 --> 00:19:07,200
see where we're at in our registry now

500
00:19:07,200 --> 00:19:08,460
and then we'll see where we're at in our

501
00:19:08,460 --> 00:19:10,320
with our registry after we run this file

502
00:19:10,320 --> 00:19:12,419
and we'll pay close attention to that

503
00:19:12,419 --> 00:19:14,580
process Explorer as we run the file as

504
00:19:14,580 --> 00:19:15,660
well

505
00:19:15,660 --> 00:19:17,400
first shots out of the way

506
00:19:17,400 --> 00:19:18,900
throw it over to the side we don't got

507
00:19:18,900 --> 00:19:21,500
to worry about it

508
00:19:21,900 --> 00:19:23,640
give this a rename so it can actually

509
00:19:23,640 --> 00:19:26,240
execute

510
00:19:27,660 --> 00:19:30,980
yes let it execute

511
00:19:31,860 --> 00:19:34,440
now let's go ahead and run

512
00:19:34,440 --> 00:19:36,900
so some stuff happened we see this file

513
00:19:36,900 --> 00:19:39,179
running and then suddenly we see service

514
00:19:39,179 --> 00:19:42,120
host.exe service host.exe is a basic

515
00:19:42,120 --> 00:19:43,799
Windows running

516
00:19:43,799 --> 00:19:45,660
service

517
00:19:45,660 --> 00:19:48,600
now we don't see our file anymore but we

518
00:19:48,600 --> 00:19:50,220
still see service host DXE but if you

519
00:19:50,220 --> 00:19:52,260
look at the command line for that

520
00:19:52,260 --> 00:19:55,140
service host exe basically replacing

521
00:19:55,140 --> 00:19:58,020
that step 8 file into service host so

522
00:19:58,020 --> 00:20:00,360
it's hooking into a Windows command file

523
00:20:00,360 --> 00:20:01,620
to hide itself

524
00:20:01,620 --> 00:20:03,419
so it can stay running and persistent on

525
00:20:03,419 --> 00:20:05,700
a system and now look like service host

526
00:20:05,700 --> 00:20:09,140
that's pretty much what this thing does

527
00:20:09,360 --> 00:20:11,100
it will also

528
00:20:11,100 --> 00:20:12,960
if we can get some

529
00:20:12,960 --> 00:20:15,000
some Network traffic here

530
00:20:15,000 --> 00:20:17,400
which we can

531
00:20:17,400 --> 00:20:19,740
we've got some callouts

532
00:20:19,740 --> 00:20:22,559
it's the only TCP traffic on this box

533
00:20:22,559 --> 00:20:24,480
these three IPS

534
00:20:24,480 --> 00:20:26,760
and it tries to use a old outdated

535
00:20:26,760 --> 00:20:28,799
Symantec SSL cert which is really

536
00:20:28,799 --> 00:20:31,380
interesting so it'll encrypt the traffic

537
00:20:31,380 --> 00:20:33,179
and it's running

538
00:20:33,179 --> 00:20:36,200
four seven four three

539
00:20:36,960 --> 00:20:38,880
so we've now learned a lot about this

540
00:20:38,880 --> 00:20:41,640
file what it does where it hides all

541
00:20:41,640 --> 00:20:43,020
that kind of stuff except for other

542
00:20:43,020 --> 00:20:44,220
eggshell

543
00:20:44,220 --> 00:20:47,179
let's take a look at that too

544
00:20:47,760 --> 00:20:50,780
this one takes a minute

545
00:20:52,020 --> 00:20:54,980
now we can compare

546
00:20:58,320 --> 00:20:59,940
so

547
00:20:59,940 --> 00:21:02,760
we see some keys added SVC hosts that's

548
00:21:02,760 --> 00:21:05,159
what we were seeing so we see registry

549
00:21:05,159 --> 00:21:07,500
changes to SVC hosts from this

550
00:21:07,500 --> 00:21:10,500
file extensions is when I rename stuff

551
00:21:10,500 --> 00:21:12,900
enable file tracing enable console

552
00:21:12,900 --> 00:21:14,760
tracing these are all values and

553
00:21:14,760 --> 00:21:16,500
registry that you can go look up that do

554
00:21:16,500 --> 00:21:17,940
different things

555
00:21:17,940 --> 00:21:20,280
we'll go look for files we'll look for

556
00:21:20,280 --> 00:21:22,320
specific things we'll do all different

557
00:21:22,320 --> 00:21:24,299
types of stuff not every one of these is

558
00:21:24,299 --> 00:21:26,400
going to be related because as you can

559
00:21:26,400 --> 00:21:27,299
see

560
00:21:27,299 --> 00:21:29,580
there's a lot here

561
00:21:29,580 --> 00:21:33,559
40 total changes in our time window

562
00:21:34,020 --> 00:21:36,840
and there we go

563
00:21:36,840 --> 00:21:40,320
so from piece to piece and we'll get to

564
00:21:40,320 --> 00:21:42,179
cuckoo in a second but let's let's jump

565
00:21:42,179 --> 00:21:44,960
back here for a second

566
00:21:48,659 --> 00:21:51,900
as a security person what do we learn

567
00:21:51,900 --> 00:21:53,940
anybody want to give a crack what do we

568
00:21:53,940 --> 00:21:55,380
learn that would be useful to us as we

569
00:21:55,380 --> 00:21:59,120
continue to investigate this good

570
00:22:03,840 --> 00:22:07,380
yep we learned C2 location we learned

571
00:22:07,380 --> 00:22:09,240
URLs where it's coming from

572
00:22:09,240 --> 00:22:11,280
we learned registry changes that it

573
00:22:11,280 --> 00:22:12,960
makes we learned persistence mechanism

574
00:22:12,960 --> 00:22:14,820
into SVC hosts these are all things that

575
00:22:14,820 --> 00:22:17,159
we can use to help clean up or further

576
00:22:17,159 --> 00:22:19,500
scope the situation did any other host

577
00:22:19,500 --> 00:22:21,539
reach out to those urls

578
00:22:21,539 --> 00:22:23,820
did the C2 is the C2 prevalent anywhere

579
00:22:23,820 --> 00:22:26,760
else do we see hashes from that

580
00:22:26,760 --> 00:22:28,440
legitimate file anywhere

581
00:22:28,440 --> 00:22:32,179
anybody have any other thoughts on that

582
00:22:33,480 --> 00:22:35,960
good

583
00:22:37,980 --> 00:22:40,559
exactly and you're able to know how to

584
00:22:40,559 --> 00:22:42,659
better fix it in most cases with malware

585
00:22:42,659 --> 00:22:44,159
you just re-image the box and move on

586
00:22:44,159 --> 00:22:46,260
but you can't forget the scoping process

587
00:22:46,260 --> 00:22:49,799
of where else might it be

588
00:22:49,799 --> 00:22:53,280
so we can also take some actions up

589
00:22:53,280 --> 00:22:55,200
front we can block or monitor access to

590
00:22:55,200 --> 00:22:57,900
those URLs can't go to the URL URLs

591
00:22:57,900 --> 00:22:59,940
hard-coded in the VB script can't go

592
00:22:59,940 --> 00:23:01,320
there can't download malware can't

593
00:23:01,320 --> 00:23:03,659
infect computer problem solved

594
00:23:03,659 --> 00:23:05,460
we can block and monitor the callouts

595
00:23:05,460 --> 00:23:07,140
that won't stop us from an infection but

596
00:23:07,140 --> 00:23:09,000
that will stop the infection from being

597
00:23:09,000 --> 00:23:12,000
able to do additional things that's good

598
00:23:12,000 --> 00:23:13,919
if we're using EDR we can block and

599
00:23:13,919 --> 00:23:15,900
monitor those md5s

600
00:23:15,900 --> 00:23:17,820
if we're logging Powershell which is

601
00:23:17,820 --> 00:23:20,520
event id4104 we can look for suspicious

602
00:23:20,520 --> 00:23:22,860
power power shelf commands and this is

603
00:23:22,860 --> 00:23:24,000
kind of a cool thing to look for if

604
00:23:24,000 --> 00:23:24,900
you're in a Windows environment that

605
00:23:24,900 --> 00:23:26,340
runs Powershell anyway

606
00:23:26,340 --> 00:23:28,320
command logging for Windows style hidden

607
00:23:28,320 --> 00:23:29,820
and executable bypass which a lot assist

608
00:23:29,820 --> 00:23:32,340
admins will use that stuff but if you

609
00:23:32,340 --> 00:23:34,080
can figure out how they do it and then

610
00:23:34,080 --> 00:23:35,580
kind of move them out of your equation

611
00:23:35,580 --> 00:23:37,919
you can find some really cool I want

612
00:23:37,919 --> 00:23:40,380
okay you can basically find like the low

613
00:23:40,380 --> 00:23:42,419
hanging fruit of malware like that

614
00:23:42,419 --> 00:23:44,340
because it's still all Word document

615
00:23:44,340 --> 00:23:47,820
into VB into malware this is old and

616
00:23:47,820 --> 00:23:49,980
it's still amazingly relevant to how

617
00:23:49,980 --> 00:23:52,080
companies get infected today

618
00:23:52,080 --> 00:23:54,299
we have not gotten better with that

619
00:23:54,299 --> 00:23:55,740
and you can actually send any of your

620
00:23:55,740 --> 00:23:58,140
captured files to an AV vendor so I was

621
00:23:58,140 --> 00:24:00,960
doing an emotech case Once Upon a Time

622
00:24:00,960 --> 00:24:03,059
polymorphic meaning every time it

623
00:24:03,059 --> 00:24:04,620
installs it changes

624
00:24:04,620 --> 00:24:06,900
new hashes knew everything and I think I

625
00:24:06,900 --> 00:24:09,600
submitted something like 150

626
00:24:09,600 --> 00:24:11,760
variants that I caught of it in one

627
00:24:11,760 --> 00:24:13,740
environment to their AV vendors so their

628
00:24:13,740 --> 00:24:15,779
AV vendor could quickly build out stuff

629
00:24:15,779 --> 00:24:17,279
to better contain it within their

630
00:24:17,279 --> 00:24:18,240
environment

631
00:24:18,240 --> 00:24:19,679
it's a good option to work with your AV

632
00:24:19,679 --> 00:24:22,440
vendor if you have something like that

633
00:24:22,440 --> 00:24:24,360
so before we move on

634
00:24:24,360 --> 00:24:25,799
well we can actually talk about this

635
00:24:25,799 --> 00:24:27,779
then we'll go into the sandbox stuff so

636
00:24:27,779 --> 00:24:29,220
if anybody these are all like the

637
00:24:29,220 --> 00:24:30,299
picture slides like those are the

638
00:24:30,299 --> 00:24:31,620
commands that got run

639
00:24:31,620 --> 00:24:32,940
for anybody who wants to take it I'll

640
00:24:32,940 --> 00:24:35,720
leave it up for a minute

641
00:24:37,260 --> 00:24:38,940
I'm gonna like jump forward and then I'm

642
00:24:38,940 --> 00:24:40,799
gonna like jump back real quick when I

643
00:24:40,799 --> 00:24:42,299
get too far because I don't know what

644
00:24:42,299 --> 00:24:44,039
slides next

645
00:24:44,039 --> 00:24:46,919
as I see cameras not there as cameras

646
00:24:46,919 --> 00:24:48,840
come down then I will

647
00:24:48,840 --> 00:24:51,120
okay

648
00:24:51,120 --> 00:24:54,539
uh we'll save that one for later

649
00:24:54,539 --> 00:24:56,700
so let's talk about how you can do this

650
00:24:56,700 --> 00:24:58,260
from an automated fashion everybody

651
00:24:58,260 --> 00:24:59,880
following along so far by the way like

652
00:24:59,880 --> 00:25:02,760
any questions before we get into like

653
00:25:02,760 --> 00:25:05,179
please

654
00:25:15,240 --> 00:25:16,860
let the thing execute in a safe

655
00:25:16,860 --> 00:25:19,500
environment and grab a copy there

656
00:25:19,500 --> 00:25:22,140
because to be completely honest I don't

657
00:25:22,140 --> 00:25:24,720
know how to like inject that xor key in

658
00:25:24,720 --> 00:25:26,520
to make it function I'm sure someone

659
00:25:26,520 --> 00:25:28,500
does who's much smarter than I am but I

660
00:25:28,500 --> 00:25:29,340
don't

661
00:25:29,340 --> 00:25:31,260
like I got the full file by letting it

662
00:25:31,260 --> 00:25:32,760
run and pulling down a copy of the full

663
00:25:32,760 --> 00:25:34,500
file

664
00:25:34,500 --> 00:25:36,659
yeah

665
00:25:36,659 --> 00:25:39,059
yep

666
00:25:39,059 --> 00:25:41,539
please

667
00:25:45,480 --> 00:25:48,140
getting what

668
00:25:49,140 --> 00:25:51,919
oh absolutely

669
00:25:51,960 --> 00:25:53,640
it keeps changing but there are things

670
00:25:53,640 --> 00:25:55,200
that are similar so actually in this one

671
00:25:55,200 --> 00:25:56,640
you want to know I'll tell you how I

672
00:25:56,640 --> 00:25:58,559
scoped it across an environment

673
00:25:58,559 --> 00:26:02,220
every single copy of it was between like

674
00:26:02,220 --> 00:26:05,760
52 and 64 kilobytes and it was unsigned

675
00:26:05,760 --> 00:26:08,100
so I looked for every unsigned file in

676
00:26:08,100 --> 00:26:10,320
an entire environment between 52 and 64

677
00:26:10,320 --> 00:26:11,580
kilobytes

678
00:26:11,580 --> 00:26:13,500
and that actually scoped it near

679
00:26:13,500 --> 00:26:16,620
perfectly it was kind of amazing

680
00:26:16,620 --> 00:26:19,279
please God

681
00:26:29,400 --> 00:26:33,500
maybe but I don't know how to do it

682
00:26:33,720 --> 00:26:37,440
it's possible but exoring is above money

683
00:26:37,440 --> 00:26:40,220
for the most part

684
00:26:42,000 --> 00:26:43,620
so we're going to close this down for a

685
00:26:43,620 --> 00:26:45,960
second and then we'll run and I'll take

686
00:26:45,960 --> 00:26:47,940
a couple more questions as once we get

687
00:26:47,940 --> 00:26:49,740
to the Running part so is anybody

688
00:26:49,740 --> 00:26:51,840
familiar with like sandbox's cuckoo

689
00:26:51,840 --> 00:26:54,480
sandbox specifically cuckoo sandbox is a

690
00:26:54,480 --> 00:26:56,700
free open source malware sandbox

691
00:26:56,700 --> 00:27:00,120
it's kind of super useful and not too

692
00:27:00,120 --> 00:27:01,799
difficult to set up

693
00:27:01,799 --> 00:27:04,140
and like I have it set up on here kind

694
00:27:04,140 --> 00:27:05,880
of specifically so that I can show folks

695
00:27:05,880 --> 00:27:07,799
like how it works

696
00:27:07,799 --> 00:27:10,140
so like this is cuckoo sandbox in a

697
00:27:10,140 --> 00:27:12,000
nutshell

698
00:27:12,000 --> 00:27:13,980
so we're just going to go click submit a

699
00:27:13,980 --> 00:27:15,360
file

700
00:27:15,360 --> 00:27:18,840
we will grab our exe file right here

701
00:27:18,840 --> 00:27:21,000
we will open that file it's going to

702
00:27:21,000 --> 00:27:22,620
move us to a page we can say we want

703
00:27:22,620 --> 00:27:24,779
internet we don't want internet

704
00:27:24,779 --> 00:27:28,140
we want to do internet simulator or Tor

705
00:27:28,140 --> 00:27:29,940
like a Tor router you can set up all

706
00:27:29,940 --> 00:27:31,679
that stuff in here you can run a timeout

707
00:27:31,679 --> 00:27:33,059
short medium long we're going to go

708
00:27:33,059 --> 00:27:35,460
short for this enable remote control

709
00:27:35,460 --> 00:27:39,000
injection memory dumps you can pull full

710
00:27:39,000 --> 00:27:41,279
pcapp into archimy formerly known as

711
00:27:41,279 --> 00:27:43,919
moloch like a lot of Integrations is an

712
00:27:43,919 --> 00:27:45,840
open source project to basically go run

713
00:27:45,840 --> 00:27:47,760
this stuff and then it will tell you

714
00:27:47,760 --> 00:27:49,380
things and what the reason why I like

715
00:27:49,380 --> 00:27:50,940
doing this afterward is because a lot of

716
00:27:50,940 --> 00:27:52,260
what we already found

717
00:27:52,260 --> 00:27:54,600
you will find and we will see in this

718
00:27:54,600 --> 00:27:56,640
but hopefully you will have a bit more

719
00:27:56,640 --> 00:27:57,899
of an understanding of where it came

720
00:27:57,899 --> 00:28:00,659
from if you're not familiar with this

721
00:28:00,659 --> 00:28:02,220
this will take a couple minutes to

722
00:28:02,220 --> 00:28:04,080
analyze but before I go into questions

723
00:28:04,080 --> 00:28:06,480
as it starts I want to show

724
00:28:06,480 --> 00:28:08,399
kind of why I let it run on here if it

725
00:28:08,399 --> 00:28:10,919
works so it's booting up exactly what

726
00:28:10,919 --> 00:28:13,140
we're just using by the way so VMware

727
00:28:13,140 --> 00:28:15,600
Workstation this is set up with a script

728
00:28:15,600 --> 00:28:17,039
it'll automatically boot to VMware

729
00:28:17,039 --> 00:28:18,299
Workstation

730
00:28:18,299 --> 00:28:20,940
it runs in VMware Workstation it's just

731
00:28:20,940 --> 00:28:22,320
going to move the mouse around a whole

732
00:28:22,320 --> 00:28:24,720
bunch to simulate user input it's going

733
00:28:24,720 --> 00:28:26,159
to let it hang for a little while run

734
00:28:26,159 --> 00:28:27,779
the file and then it's going to close

735
00:28:27,779 --> 00:28:29,100
this out and print out a report of

736
00:28:29,100 --> 00:28:30,720
everything that happened so basically

737
00:28:30,720 --> 00:28:32,279
the stuff we did the network traffic

738
00:28:32,279 --> 00:28:34,080
monitoring the process monitoring the

739
00:28:34,080 --> 00:28:36,419
registry stuff it's doing all that in

740
00:28:36,419 --> 00:28:37,679
the background scripting and then

741
00:28:37,679 --> 00:28:40,440
sending it to a finished report

742
00:28:40,440 --> 00:28:43,320
does it catch everything no

743
00:28:43,320 --> 00:28:44,580
slow

744
00:28:44,580 --> 00:28:47,220
you can only leave it open for so long

745
00:28:47,220 --> 00:28:49,080
a lot of times on Old samples I'd leave

746
00:28:49,080 --> 00:28:51,480
them running for two or three days

747
00:28:51,480 --> 00:28:53,159
just to monitor if there's any new

748
00:28:53,159 --> 00:28:54,960
network traffic that comes into a sample

749
00:28:54,960 --> 00:28:57,179
or if anything else happens that's

750
00:28:57,179 --> 00:28:58,919
scheduled to happen later if I'm doing

751
00:28:58,919 --> 00:29:01,380
Dynamic analysis

752
00:29:01,380 --> 00:29:02,220
um

753
00:29:02,220 --> 00:29:04,679
earlier on we did some low-level static

754
00:29:04,679 --> 00:29:06,899
analysis I should explain the

755
00:29:06,899 --> 00:29:08,760
differences there that's like looking

756
00:29:08,760 --> 00:29:11,820
without interacting Dynamic is like full

757
00:29:11,820 --> 00:29:13,559
on let's run it let's interact let's

758
00:29:13,559 --> 00:29:15,360
let's have a party and burn some

759
00:29:15,360 --> 00:29:17,399
down

760
00:29:17,399 --> 00:29:19,320
so while this runs and it's going to

761
00:29:19,320 --> 00:29:20,399
take a little while to generate the

762
00:29:20,399 --> 00:29:22,080
report other questions

763
00:29:22,080 --> 00:29:23,640
that I can answer that was quicker than

764
00:29:23,640 --> 00:29:25,320
I thought but anything else that anybody

765
00:29:25,320 --> 00:29:27,779
wants to know

766
00:29:27,779 --> 00:29:29,580
cool

767
00:29:29,580 --> 00:29:30,960
so let's take a look at this report and

768
00:29:30,960 --> 00:29:32,340
see what we see

769
00:29:32,340 --> 00:29:35,399
so this file is very suspicious

770
00:29:35,399 --> 00:29:37,020
that's the first indicator right there

771
00:29:37,020 --> 00:29:38,520
it tells you straight up hey this is

772
00:29:38,520 --> 00:29:41,480
probably not great

773
00:29:41,580 --> 00:29:43,200
so let's scroll down through our report

774
00:29:43,200 --> 00:29:45,600
and see what we see

775
00:29:45,600 --> 00:29:48,179
queries for computer name

776
00:29:48,179 --> 00:29:50,100
collects information to fingerprint the

777
00:29:50,100 --> 00:29:53,360
system let's open up some of these

778
00:29:54,299 --> 00:29:56,159
because we saw some of this stuff when

779
00:29:56,159 --> 00:29:58,200
we were going through

780
00:29:58,200 --> 00:30:01,760
tries to locate browsers

781
00:30:03,659 --> 00:30:06,179
create suspicious process

782
00:30:06,179 --> 00:30:07,740
there's our suspicious process the

783
00:30:07,740 --> 00:30:10,080
service host exe right there there's a

784
00:30:10,080 --> 00:30:12,600
really good Sans poster by the way folks

785
00:30:12,600 --> 00:30:15,360
the like it's like the the windowsis

786
00:30:15,360 --> 00:30:16,919
internals one

787
00:30:16,919 --> 00:30:18,720
any of this stuff is helpful with

788
00:30:18,720 --> 00:30:20,760
windowsis internals because most malware

789
00:30:20,760 --> 00:30:22,500
authors want to inject in something like

790
00:30:22,500 --> 00:30:24,960
service hosts or lsas or common Windows

791
00:30:24,960 --> 00:30:27,600
processes because they can hide those

792
00:30:27,600 --> 00:30:29,220
because those are supposed to be running

793
00:30:29,220 --> 00:30:30,419
on your system

794
00:30:30,419 --> 00:30:32,159
they don't exactly call their stuff like

795
00:30:32,159 --> 00:30:34,919
malware click me or totally not malware

796
00:30:34,919 --> 00:30:36,480
I've actually seen a few where the

797
00:30:36,480 --> 00:30:38,100
service running name was like totally

798
00:30:38,100 --> 00:30:41,779
not malware that's always fun

799
00:30:42,179 --> 00:30:45,799
so tries to look for sniffers

800
00:30:47,460 --> 00:30:50,580
detected network interfaces and these

801
00:30:50,580 --> 00:30:52,440
are all color coded so they get worse as

802
00:30:52,440 --> 00:30:56,039
they go from a risk level right

803
00:30:56,039 --> 00:30:59,700
so looking for AV delete itself from

804
00:30:59,700 --> 00:31:01,500
disk it wasn't on the desktop anymore

805
00:31:01,500 --> 00:31:05,580
once it ran and injected it was gone

806
00:31:05,580 --> 00:31:07,500
collects information about installed

807
00:31:07,500 --> 00:31:09,980
applications

808
00:31:10,500 --> 00:31:14,120
Corey's details from the computer

809
00:31:15,120 --> 00:31:17,220
which are a lot

810
00:31:17,220 --> 00:31:19,080
connects to an IP address that no longer

811
00:31:19,080 --> 00:31:21,000
exists well there's the IP address that

812
00:31:21,000 --> 00:31:23,159
we saw in Wireshark

813
00:31:23,159 --> 00:31:26,240
it looks for that too

814
00:31:26,460 --> 00:31:29,100
and then of course like I got time.mite

815
00:31:29,100 --> 00:31:32,460
windows and all that oh

816
00:31:32,460 --> 00:31:34,140
sorry about that

817
00:31:34,140 --> 00:31:37,039
that is my wife

818
00:31:37,440 --> 00:31:40,980
so there's also a ton of other windows

819
00:31:40,980 --> 00:31:42,000
that exist

820
00:31:42,000 --> 00:31:43,140
right

821
00:31:43,140 --> 00:31:44,820
there's some static analysis if that's

822
00:31:44,820 --> 00:31:46,380
your jam

823
00:31:46,380 --> 00:31:47,640
this is going to tell you a bunch of

824
00:31:47,640 --> 00:31:49,500
stuff about the file

825
00:31:49,500 --> 00:31:51,559
any external artifacts that might exist

826
00:31:51,559 --> 00:31:54,179
or any extracted artifacts which there

827
00:31:54,179 --> 00:31:56,340
aren't any behavioral analysis of the

828
00:31:56,340 --> 00:31:58,500
file so that's our process tree right

829
00:31:58,500 --> 00:31:59,760
there that's exactly what we looked at

830
00:31:59,760 --> 00:32:02,539
in process Explorer process trees

831
00:32:02,539 --> 00:32:06,500
drydex.exe to SVC host

832
00:32:06,779 --> 00:32:08,519
and then if you have some of the network

833
00:32:08,519 --> 00:32:10,620
stuff more and more of it set up you'll

834
00:32:10,620 --> 00:32:13,440
see more and more of it as you go

835
00:32:13,440 --> 00:32:16,260
but there's our IP stuff and like I was

836
00:32:16,260 --> 00:32:17,700
saying you can pivot to archimi slash

837
00:32:17,700 --> 00:32:19,200
mohlock because it used to be monologue

838
00:32:19,200 --> 00:32:20,460
you can do that right there pivot in

839
00:32:20,460 --> 00:32:21,720
look at the packets if you want to

840
00:32:21,720 --> 00:32:24,559
connect that stuff together

841
00:32:26,159 --> 00:32:28,620
dropped files this being the drops file

842
00:32:28,620 --> 00:32:30,179
I'm not going to go through every one of

843
00:32:30,179 --> 00:32:31,740
these but everybody kind of gets the

844
00:32:31,740 --> 00:32:32,460
point

845
00:32:32,460 --> 00:32:34,860
we've now in you know 30 seconds done

846
00:32:34,860 --> 00:32:36,720
what we did in the last half hour

847
00:32:36,720 --> 00:32:38,640
roughly

848
00:32:38,640 --> 00:32:41,580
but I still like I like to do stuff

849
00:32:41,580 --> 00:32:44,820
manually and I like to teach it manually

850
00:32:44,820 --> 00:32:46,380
so let's pivot back over here for a

851
00:32:46,380 --> 00:32:47,220
second

852
00:32:47,220 --> 00:32:48,899
so now we're at like the take a picture

853
00:32:48,899 --> 00:32:50,159
slots

854
00:32:50,159 --> 00:32:51,659
so if people want to take a picture like

855
00:32:51,659 --> 00:32:53,279
these are some really great resources

856
00:32:53,279 --> 00:32:54,539
for this stuff

857
00:32:54,539 --> 00:32:57,960
virus total URL void ipvoid the next

858
00:32:57,960 --> 00:32:59,279
slide is going to be places that you can

859
00:32:59,279 --> 00:33:01,500
go download live malware so before I

860
00:33:01,500 --> 00:33:03,000
show the next slide

861
00:33:03,000 --> 00:33:04,799
I do want to take a minute and talk

862
00:33:04,799 --> 00:33:06,600
about like the sandbox setup and like

863
00:33:06,600 --> 00:33:08,760
having good hygiene on stuff this

864
00:33:08,760 --> 00:33:11,460
computer is a Linux Box by itself with a

865
00:33:11,460 --> 00:33:13,500
Windows VM it has never been logged into

866
00:33:13,500 --> 00:33:15,720
on any of my personal accounts I have

867
00:33:15,720 --> 00:33:17,159
throwaway accounts for every single

868
00:33:17,159 --> 00:33:18,659
thing that's on this box

869
00:33:18,659 --> 00:33:21,779
because it's full of live power like

870
00:33:21,779 --> 00:33:23,340
that is what's on this box

871
00:33:23,340 --> 00:33:25,260
every USB drive in my house is also

872
00:33:25,260 --> 00:33:27,120
probably full of live malware if I'm

873
00:33:27,120 --> 00:33:29,279
honest so if you're ever like if I ever

874
00:33:29,279 --> 00:33:30,720
give you a USB drive probably don't plug

875
00:33:30,720 --> 00:33:32,519
it in

876
00:33:32,519 --> 00:33:35,039
um but like make sure you take care to

877
00:33:35,039 --> 00:33:36,779
protect yourself if you're gonna do it I

878
00:33:36,779 --> 00:33:38,460
want to make this accessible but I also

879
00:33:38,460 --> 00:33:40,380
want people to like understand that like

880
00:33:40,380 --> 00:33:42,840
malware can do bad stuff to you

881
00:33:42,840 --> 00:33:44,820
so if you're gonna play with this stuff

882
00:33:44,820 --> 00:33:47,039
which I encourage everybody to do

883
00:33:47,039 --> 00:33:49,260
turn off your network adapter first

884
00:33:49,260 --> 00:33:51,539
you can totally do that

885
00:33:51,539 --> 00:33:54,899
if you don't want to grab a VPN do

886
00:33:54,899 --> 00:33:58,820
something else use Hotel Wi-Fi like I am

887
00:33:59,220 --> 00:34:01,260
um

888
00:34:01,260 --> 00:34:03,299
don't log into personal accounts don't

889
00:34:03,299 --> 00:34:05,100
have anything because so much of this

890
00:34:05,100 --> 00:34:06,960
the commodity stuff is account stealer

891
00:34:06,960 --> 00:34:08,520
they're going to go look for like your

892
00:34:08,520 --> 00:34:10,139
personal accounts to steal stuff it's

893
00:34:10,139 --> 00:34:12,179
all in the commodity kind of crime

894
00:34:12,179 --> 00:34:15,300
financial gain kind of place like that's

895
00:34:15,300 --> 00:34:17,520
what a lot of malware is until you get

896
00:34:17,520 --> 00:34:19,199
into very specialized stuff which no one

897
00:34:19,199 --> 00:34:21,839
would ever let me talk about on a stage

898
00:34:21,839 --> 00:34:25,320
so just take care and have a sanitized

899
00:34:25,320 --> 00:34:26,699
environment the reason why I don't run

900
00:34:26,699 --> 00:34:28,679
this is a lab or like a multi-day

901
00:34:28,679 --> 00:34:30,060
training is because every time I've

902
00:34:30,060 --> 00:34:31,859
tried people come with like their

903
00:34:31,859 --> 00:34:33,359
primary workstation I'm like I don't

904
00:34:33,359 --> 00:34:34,500
think you want to do this on your

905
00:34:34,500 --> 00:34:35,940
primary Workstation

906
00:34:35,940 --> 00:34:37,679
so I've moved away from doing it that

907
00:34:37,679 --> 00:34:40,859
way get a like a tiny little cheap

908
00:34:40,859 --> 00:34:43,020
computer like a used school computer

909
00:34:43,020 --> 00:34:46,020
whatever the case may be but like just

910
00:34:46,020 --> 00:34:47,579
be safe if you're going to play with

911
00:34:47,579 --> 00:34:49,679
this stuff and I say that before I post

912
00:34:49,679 --> 00:34:52,159
this slide

913
00:34:52,199 --> 00:34:55,079
because that is like where all the

914
00:34:55,079 --> 00:34:58,099
malware can exist

915
00:35:08,640 --> 00:35:10,800
end of speech

916
00:35:10,800 --> 00:35:15,560
I'm probably really early but thank you

917
00:35:18,240 --> 00:35:20,880
[Applause]

918
00:35:20,880 --> 00:35:22,920
yes I can

919
00:35:22,920 --> 00:35:24,920
anybody got any questions

920
00:35:24,920 --> 00:35:28,859
Curiosities gripes please

921
00:35:28,859 --> 00:35:31,200
um when it comes to analyzing malware

922
00:35:31,200 --> 00:35:33,900
you know there's a bread and come across

923
00:35:33,900 --> 00:35:37,619
certain old malware that originally

924
00:35:37,619 --> 00:35:41,400
doesn't do much but once you detonate

925
00:35:41,400 --> 00:35:45,119
them or click on the link per se after a

926
00:35:45,119 --> 00:35:46,920
period of time it changes into something

927
00:35:46,920 --> 00:35:50,099
else what will be the best way for you

928
00:35:50,099 --> 00:35:52,200
to analyze something like that run it

929
00:35:52,200 --> 00:35:54,119
long term

930
00:35:54,119 --> 00:35:56,579
so I mentioned a little earlier one of

931
00:35:56,579 --> 00:35:57,900
the things that I used to do a lot was

932
00:35:57,900 --> 00:35:59,280
leave something running for two or three

933
00:35:59,280 --> 00:36:00,119
days

934
00:36:00,119 --> 00:36:02,220
let collect all Network traffic that

935
00:36:02,220 --> 00:36:03,900
took place on that box over two or three

936
00:36:03,900 --> 00:36:06,420
days collect any processes that picked

937
00:36:06,420 --> 00:36:08,040
up and collect all registry changes over

938
00:36:08,040 --> 00:36:09,420
two or three days to see what kind of

939
00:36:09,420 --> 00:36:11,760
changes are made new malware by the way

940
00:36:11,760 --> 00:36:13,619
probably like I wouldn't be able to do

941
00:36:13,619 --> 00:36:15,000
 here because most of them won't

942
00:36:15,000 --> 00:36:17,099
even run in a VM anymore

943
00:36:17,099 --> 00:36:18,660
because the first thing they do is go

944
00:36:18,660 --> 00:36:20,099
look to see if it's a VM and then they

945
00:36:20,099 --> 00:36:21,900
stop running or they change the way that

946
00:36:21,900 --> 00:36:23,700
they run to make it not look as bad like

947
00:36:23,700 --> 00:36:26,700
malware's getting smarter

948
00:36:26,700 --> 00:36:30,439
anybody else please

949
00:36:30,900 --> 00:36:33,560
on Hardware

950
00:36:35,160 --> 00:36:37,680
yep

951
00:36:37,680 --> 00:36:39,599
yeah or you know throw it in a cloud

952
00:36:39,599 --> 00:36:42,440
instance somewhere

953
00:36:52,619 --> 00:36:54,660
to do automatically

954
00:36:54,660 --> 00:36:57,000
oftentimes yes the problem is though is

955
00:36:57,000 --> 00:36:58,680
when you're looking at like attack paths

956
00:36:58,680 --> 00:37:00,780
right that require you to go out to the

957
00:37:00,780 --> 00:37:04,380
Internet so if all I had was that PDF

958
00:37:04,380 --> 00:37:06,420
and I Got That Word document and then it

959
00:37:06,420 --> 00:37:08,040
goes to these websites and I need that

960
00:37:08,040 --> 00:37:10,020
to execute I need it to go to the

961
00:37:10,020 --> 00:37:12,359
Internet like that's part of making this

962
00:37:12,359 --> 00:37:14,160
work I don't get the file unless that

963
00:37:14,160 --> 00:37:15,660
goes to the internet

964
00:37:15,660 --> 00:37:19,040
so I've always been

965
00:37:19,380 --> 00:37:21,660
maybe even a little careless sometimes

966
00:37:21,660 --> 00:37:23,880
at least at my own home

967
00:37:23,880 --> 00:37:25,500
well because I let stuff connect to the

968
00:37:25,500 --> 00:37:29,160
internet I use onboard vpns I have vpns

969
00:37:29,160 --> 00:37:31,859
and a net segmented Network

970
00:37:31,859 --> 00:37:34,380
at my house to do this stuff

971
00:37:34,380 --> 00:37:36,599
but you can always tether it to your

972
00:37:36,599 --> 00:37:38,040
phone too

973
00:37:38,040 --> 00:37:39,540
like that's not a bad MAP that's

974
00:37:39,540 --> 00:37:40,560
actually pretty good I didn't think

975
00:37:40,560 --> 00:37:41,820
about that before but I might start

976
00:37:41,820 --> 00:37:43,200
tethering to my phone when I do this

977
00:37:43,200 --> 00:37:45,439
stuff

978
00:37:45,660 --> 00:37:48,259
go ahead

979
00:38:05,160 --> 00:38:07,020
good question and I do not have a good

980
00:38:07,020 --> 00:38:07,740
answer

981
00:38:07,740 --> 00:38:09,359
but you stumped me on a question so

982
00:38:09,359 --> 00:38:12,140
you're going to get a present

983
00:38:15,119 --> 00:38:19,339
who else has something by the way please

984
00:38:27,359 --> 00:38:29,579
so SVC hosts by its very nature is a

985
00:38:29,579 --> 00:38:31,740
very legitimate process

986
00:38:31,740 --> 00:38:33,960
which is why it gets misused a lot and

987
00:38:33,960 --> 00:38:36,060
why Empower will try to use it SVC host

988
00:38:36,060 --> 00:38:39,119
is necessary for Windows to run

989
00:38:39,119 --> 00:38:41,300
foreign

990
00:38:43,380 --> 00:38:46,380
so when you have malware this hijacking

991
00:38:46,380 --> 00:38:48,320
processes you can kill that malware

992
00:38:48,320 --> 00:38:51,960
congratulations to kind of kill that

993
00:38:51,960 --> 00:38:53,579
process and hope that you can restart it

994
00:38:53,579 --> 00:38:55,980
if there's no scheduled task that jumps

995
00:38:55,980 --> 00:38:57,839
in or does anything to basically re-up

996
00:38:57,839 --> 00:38:59,280
it next time

997
00:38:59,280 --> 00:39:01,740
or you can re-image the Box because

998
00:39:01,740 --> 00:39:03,420
you've got core Windows processes that

999
00:39:03,420 --> 00:39:05,820
are screwed in this case it's just

1000
00:39:05,820 --> 00:39:08,940
looking like it's running SVC host

1001
00:39:08,940 --> 00:39:13,579
and naming itself SVC host effectively

1002
00:39:23,640 --> 00:39:27,599
oh like SVC host or not it's in my

1003
00:39:27,599 --> 00:39:29,160
experience it's been a lot of looking at

1004
00:39:29,160 --> 00:39:30,960
those parent-child process relationships

1005
00:39:30,960 --> 00:39:32,460
right which means you have to have some

1006
00:39:32,460 --> 00:39:33,839
form of visibility when you start to

1007
00:39:33,839 --> 00:39:34,859
look at it

1008
00:39:34,859 --> 00:39:38,579
so why is SVC host being spun up out of

1009
00:39:38,579 --> 00:39:41,760
this executable that's weird

1010
00:39:41,760 --> 00:39:44,339
or like why is

1011
00:39:44,339 --> 00:39:46,820
Chrome launching my

1012
00:39:46,820 --> 00:39:50,700
winlogin.exe that's weird

1013
00:39:50,700 --> 00:39:52,560
anybody else

1014
00:39:52,560 --> 00:39:55,040
please

1015
00:40:09,680 --> 00:40:12,900
far smarter people than me do that I

1016
00:40:12,900 --> 00:40:14,880
don't I would actually recommend a class

1017
00:40:14,880 --> 00:40:16,740
and I should have put it in the slides a

1018
00:40:16,740 --> 00:40:18,540
friend of mine goes by the name of

1019
00:40:18,540 --> 00:40:21,480
Mobius is Twitter's malware Mobius he

1020
00:40:21,480 --> 00:40:23,280
does like an entry level very affordable

1021
00:40:23,280 --> 00:40:25,560
like actual re class because like this

1022
00:40:25,560 --> 00:40:27,300
is an re and I don't know when he's

1023
00:40:27,300 --> 00:40:28,560
going to kick it off again but his class

1024
00:40:28,560 --> 00:40:31,079
is great and it's not Sans expensive

1025
00:40:31,079 --> 00:40:33,300
which is also great it's only like a

1026
00:40:33,300 --> 00:40:35,099
couple hundred bucks but it's like a

1027
00:40:35,099 --> 00:40:38,579
multi-week full-on re like getra all the

1028
00:40:38,579 --> 00:40:40,440
works and getting into that stuff

1029
00:40:40,440 --> 00:40:42,599
because that's what he does for a living

1030
00:40:42,599 --> 00:40:45,200
back there

1031
00:40:54,180 --> 00:40:56,899
really

1032
00:41:03,599 --> 00:41:05,940
and then I've also added like

1033
00:41:05,940 --> 00:41:08,819
configuration like malware configuration

1034
00:41:08,819 --> 00:41:11,579
of course the total Courthouse are big

1035
00:41:11,579 --> 00:41:14,720
based on uh

1036
00:41:15,420 --> 00:41:18,140
oh nice

1037
00:41:18,720 --> 00:41:22,079
that's fantastic good to know thank you

1038
00:41:22,079 --> 00:41:24,440
please

1039
00:41:29,400 --> 00:41:34,099
come across the malware that um

1040
00:41:35,760 --> 00:41:38,040
so I've never come across one myself so

1041
00:41:38,040 --> 00:41:39,300
I don't have a good answer for that one

1042
00:41:39,300 --> 00:41:42,500
either but you already got a present

1043
00:41:43,859 --> 00:41:46,880
anybody else folks

1044
00:41:47,160 --> 00:41:49,700
back there

1045
00:41:58,319 --> 00:42:00,900
for the V for VMware you mean

1046
00:42:00,900 --> 00:42:03,000
so test for your environment

1047
00:42:03,000 --> 00:42:05,400
like always test for your environment so

1048
00:42:05,400 --> 00:42:07,980
like this is old because when I built

1049
00:42:07,980 --> 00:42:09,660
this box it was Windows 7 was my

1050
00:42:09,660 --> 00:42:11,160
environment so I was testing for my

1051
00:42:11,160 --> 00:42:12,060
environment

1052
00:42:12,060 --> 00:42:14,460
but genuinely you should always test for

1053
00:42:14,460 --> 00:42:16,440
what you're testing it against

1054
00:42:16,440 --> 00:42:18,300
you know XP is not going to do you much

1055
00:42:18,300 --> 00:42:20,460
good if everybody's on Windows 10 or

1056
00:42:20,460 --> 00:42:22,920
Windows 11 now is it 11 now again I

1057
00:42:22,920 --> 00:42:25,500
don't use Windows

1058
00:42:25,500 --> 00:42:28,680
um so is that helpful

1059
00:42:28,680 --> 00:42:30,300
all right who somebody I thought I saw

1060
00:42:30,300 --> 00:42:32,339
another hand

1061
00:42:32,339 --> 00:42:34,759
good

1062
00:42:37,140 --> 00:42:39,000
uh virtual machine technology

1063
00:42:39,000 --> 00:42:41,640
which one would you think of as the

1064
00:42:41,640 --> 00:42:45,180
least painful to initially VMware

1065
00:42:45,180 --> 00:42:46,380
yeah

1066
00:42:46,380 --> 00:42:47,040
um

1067
00:42:47,040 --> 00:42:49,859
what's the other one uh the the free one

1068
00:42:49,859 --> 00:42:53,040
by virtualbox virtualbox is a giant

1069
00:42:53,040 --> 00:42:55,740
piece of crap I hate virtualbox

1070
00:42:55,740 --> 00:42:58,260
VMware I like VMware is expensive but I

1071
00:42:58,260 --> 00:43:00,440
like VMware

1072
00:43:00,440 --> 00:43:03,660
that one I don't know

1073
00:43:03,660 --> 00:43:05,940
oh yeah

1074
00:43:05,940 --> 00:43:07,500
so just like take a community college

1075
00:43:07,500 --> 00:43:10,760
class and get free VMware

1076
00:43:11,099 --> 00:43:13,700
oh perfect

1077
00:43:14,579 --> 00:43:18,000
perfect I like it

1078
00:43:18,000 --> 00:43:21,359
well I mean you know that's questionable

1079
00:43:21,359 --> 00:43:23,339
I'm not saying I'm gonna do it I'm just

1080
00:43:23,339 --> 00:43:25,740
it's an idea

1081
00:43:25,740 --> 00:43:28,640
what else y'all got

1082
00:43:30,900 --> 00:43:33,680
go ahead

1083
00:43:38,520 --> 00:43:40,079
yes

1084
00:43:40,079 --> 00:43:43,440
and thankfully nothing bad ever happened

1085
00:43:43,440 --> 00:43:46,140
um I started to dig into something that

1086
00:43:46,140 --> 00:43:47,940
I thought was going to be like no big

1087
00:43:47,940 --> 00:43:49,619
deal just some commodity piece of

1088
00:43:49,619 --> 00:43:51,720
something and it started to do some

1089
00:43:51,720 --> 00:43:53,400
really weird stuff and I can't really

1090
00:43:53,400 --> 00:43:55,079
get into the weird stuff because that

1091
00:43:55,079 --> 00:43:56,760
would give away much and come to find

1092
00:43:56,760 --> 00:43:58,260
out that it looked like a very highly

1093
00:43:58,260 --> 00:44:01,200
targeted piece of something

1094
00:44:01,200 --> 00:44:04,619
with a person on the other end

1095
00:44:04,619 --> 00:44:06,780
and I didn't have any of my vpns or

1096
00:44:06,780 --> 00:44:08,339
anything on

1097
00:44:08,339 --> 00:44:10,140
so I really thought like somebody was

1098
00:44:10,140 --> 00:44:12,180
going to come attack the out of me

1099
00:44:12,180 --> 00:44:13,800
I really did thankfully that never

1100
00:44:13,800 --> 00:44:15,359
happened but I thought I was screwed for

1101
00:44:15,359 --> 00:44:17,720
a little bit

1102
00:44:18,900 --> 00:44:21,740
what else folks

1103
00:44:23,400 --> 00:44:25,020
all right cool then I guess that's it

1104
00:44:25,020 --> 00:44:27,359
thank you all and I hope you all enjoy

1105
00:44:27,359 --> 00:44:30,200
the rest of the comments

1106
00:44:30,560 --> 00:44:35,788
[Applause]

