1
00:00:24,160 --> 00:00:26,560
good morning everyone

2
00:00:26,560 --> 00:00:28,320
thank you for thank you for coming to my

3
00:00:28,320 --> 00:00:30,160
talk how is that is this distance okay

4
00:00:30,160 --> 00:00:31,760
can you guys hear me all right

5
00:00:31,760 --> 00:00:33,280
awesome

6
00:00:33,280 --> 00:00:36,160
so as you can see by the title uh this

7
00:00:36,160 --> 00:00:38,480
talk is gonna be about documents uh very

8
00:00:38,480 --> 00:00:40,719
osint heavy talking a lot about data

9
00:00:40,719 --> 00:00:42,800
leakage document leakage and uh document

10
00:00:42,800 --> 00:00:44,640
metadata

11
00:00:44,640 --> 00:00:46,079
now if you were here for the opening

12
00:00:46,079 --> 00:00:48,399
remarks um that was my cell phone that

13
00:00:48,399 --> 00:00:50,559
went off really loud so

14
00:00:50,559 --> 00:00:52,320
as punishment if anyone wants to play a

15
00:00:52,320 --> 00:00:53,920
ringtone really loud at any point during

16
00:00:53,920 --> 00:00:55,840
my talk that is well deserved and

17
00:00:55,840 --> 00:00:57,440
welcome

18
00:00:57,440 --> 00:00:59,520
so a little bit about who i am i'm nick

19
00:00:59,520 --> 00:01:01,039
scully i'm the founder and ceo of a

20
00:01:01,039 --> 00:01:02,559
company called fortrace we're an

21
00:01:02,559 --> 00:01:04,000
external attack surface management

22
00:01:04,000 --> 00:01:06,159
product uh formerly i was a senior cyber

23
00:01:06,159 --> 00:01:07,520
research scientist with a company called

24
00:01:07,520 --> 00:01:09,760
security risk advisors um i've made some

25
00:01:09,760 --> 00:01:12,240
open source tools all very ocinty and

26
00:01:12,240 --> 00:01:13,439
i've spoken at a bunch of conferences

27
00:01:13,439 --> 00:01:15,200
and if you like to talk or want to chat

28
00:01:15,200 --> 00:01:16,720
about this kind of stuff that's my

29
00:01:16,720 --> 00:01:18,400
contact information

30
00:01:18,400 --> 00:01:20,240
i'm pretty new to twitter so uh don't

31
00:01:20,240 --> 00:01:21,840
expect much over there

32
00:01:21,840 --> 00:01:24,640
now equally as important to this topic

33
00:01:24,640 --> 00:01:26,880
is who i am not first and foremost i am

34
00:01:26,880 --> 00:01:29,439
not a plumber um though i have been

35
00:01:29,439 --> 00:01:32,159
known to find some leaky buckets haha um

36
00:01:32,159 --> 00:01:33,680
i cannot be trusted with anything blue

37
00:01:33,680 --> 00:01:36,240
collar beyond uh putting together ikea

38
00:01:36,240 --> 00:01:37,280
furniture

39
00:01:37,280 --> 00:01:39,600
um i'm also not a lawyer while this is a

40
00:01:39,600 --> 00:01:41,520
strange um disclaimer to have to give

41
00:01:41,520 --> 00:01:43,280
for a talk like this

42
00:01:43,280 --> 00:01:44,720
uh

43
00:01:44,720 --> 00:01:47,040
the legal the legalities of accessing

44
00:01:47,040 --> 00:01:48,640
someone else's documents from the public

45
00:01:48,640 --> 00:01:49,600
internet

46
00:01:49,600 --> 00:01:52,840
um is messy at best there's not a lot of

47
00:01:52,840 --> 00:01:55,200
litigation uh beyond a couple small

48
00:01:55,200 --> 00:01:57,040
examples i'll talk about but uh we're

49
00:01:57,040 --> 00:01:58,159
going to be talking a lot about google

50
00:01:58,159 --> 00:01:59,439
dorking finding documents on the

51
00:01:59,439 --> 00:02:01,600
internet um from

52
00:02:01,600 --> 00:02:02,960
you know the comfort of your own home

53
00:02:02,960 --> 00:02:04,719
and the legality around viewing those

54
00:02:04,719 --> 00:02:05,680
files

55
00:02:05,680 --> 00:02:07,680
uh you know in short i do not endorse

56
00:02:07,680 --> 00:02:08,878
viewing someone else's files without

57
00:02:08,878 --> 00:02:10,639
their permission however it's very easy

58
00:02:10,639 --> 00:02:12,959
to do um now this slide you might find

59
00:02:12,959 --> 00:02:15,280
offensive uh due to its simplicity but

60
00:02:15,280 --> 00:02:17,280
when i'm talking about documents in this

61
00:02:17,280 --> 00:02:19,280
talk specifically these are the kinds

62
00:02:19,280 --> 00:02:21,200
i'm talking about the file types that

63
00:02:21,200 --> 00:02:23,680
spin the cogs of the world of business

64
00:02:23,680 --> 00:02:25,440
these are the files that we interact

65
00:02:25,440 --> 00:02:27,120
with these are typically the file types

66
00:02:27,120 --> 00:02:29,520
we're trying to protect um as enterprise

67
00:02:29,520 --> 00:02:30,720
defenders

68
00:02:30,720 --> 00:02:32,160
from getting out these are the files

69
00:02:32,160 --> 00:02:35,120
that store everything that a business uh

70
00:02:35,120 --> 00:02:38,239
is doing now in terms of publication i

71
00:02:38,239 --> 00:02:39,760
break publication down into two

72
00:02:39,760 --> 00:02:41,680
categories the least common one is

73
00:02:41,680 --> 00:02:42,800
intentional

74
00:02:42,800 --> 00:02:44,480
this is you know releasing marketing

75
00:02:44,480 --> 00:02:46,319
collateral releasing product

76
00:02:46,319 --> 00:02:48,800
documentation as a company releasing

77
00:02:48,800 --> 00:02:50,319
press releases anything where you're

78
00:02:50,319 --> 00:02:54,000
posting a pdf a word doc a spreadsheet a

79
00:02:54,000 --> 00:02:56,080
publicly accessible sharepoint url to

80
00:02:56,080 --> 00:02:58,080
the internet um which is typically

81
00:02:58,080 --> 00:03:00,879
linked to the corporate domain um what

82
00:03:00,879 --> 00:03:03,599
i'm more interested in and find a lot

83
00:03:03,599 --> 00:03:05,840
more common is unintentional so while

84
00:03:05,840 --> 00:03:07,599
these can also be linked directly to the

85
00:03:07,599 --> 00:03:09,440
corporate domain via like a

86
00:03:09,440 --> 00:03:11,920
misconfigured iis server uh or

87
00:03:11,920 --> 00:03:13,200
collaboration software that's been

88
00:03:13,200 --> 00:03:14,720
shared via url

89
00:03:14,720 --> 00:03:16,640
these are documents which have been

90
00:03:16,640 --> 00:03:18,959
published to the internet and what i'm

91
00:03:18,959 --> 00:03:20,400
considering publication is it's

92
00:03:20,400 --> 00:03:22,879
available via a public url and it's been

93
00:03:22,879 --> 00:03:25,120
indexed by a search engine so google or

94
00:03:25,120 --> 00:03:28,480
bing has picked up the url to this file

95
00:03:28,480 --> 00:03:30,000
um whether it's downloadable whether

96
00:03:30,000 --> 00:03:32,159
it's accessible in browser and made it

97
00:03:32,159 --> 00:03:33,599
so that someone from the outside with

98
00:03:33,599 --> 00:03:35,599
the link can view it there's a lot of

99
00:03:35,599 --> 00:03:37,840
reasons for this that i see regularly

100
00:03:37,840 --> 00:03:39,360
and this is you know anecdotal there's

101
00:03:39,360 --> 00:03:41,040
there's a lot of other reasons but uh

102
00:03:41,040 --> 00:03:43,040
collaboration softwares particularly

103
00:03:43,040 --> 00:03:45,680
sharepoint onedrive and g suite making

104
00:03:45,680 --> 00:03:48,480
files shareable via url this is the

105
00:03:48,480 --> 00:03:51,440
biggest culprit for very very internal

106
00:03:51,440 --> 00:03:53,360
files accidentally getting indexed by

107
00:03:53,360 --> 00:03:55,200
google because they are hosted when you

108
00:03:55,200 --> 00:03:57,239
visit the files from the public on

109
00:03:57,239 --> 00:03:59,599
live.officeapps.com or something

110
00:03:59,599 --> 00:04:01,519
those links are being indexed by search

111
00:04:01,519 --> 00:04:03,360
engines all the time so accidentally

112
00:04:03,360 --> 00:04:05,280
making a file shareable via url or

113
00:04:05,280 --> 00:04:06,480
intentionally doing it to share it with

114
00:04:06,480 --> 00:04:07,920
consultants is going to make it

115
00:04:07,920 --> 00:04:11,040
public-facing in many cases um

116
00:04:11,040 --> 00:04:12,560
you know internal document storage

117
00:04:12,560 --> 00:04:14,720
misconfiguration so if you're working in

118
00:04:14,720 --> 00:04:16,079
like a lab or a manufacturing

119
00:04:16,079 --> 00:04:18,399
environment there's all kinds of you

120
00:04:18,399 --> 00:04:20,959
know very good uses for

121
00:04:20,959 --> 00:04:22,720
document metadata and document

122
00:04:22,720 --> 00:04:25,360
repository storage uh that you know is

123
00:04:25,360 --> 00:04:27,040
required for compliance with a bunch of

124
00:04:27,040 --> 00:04:30,400
stuff um and those servers uh often we

125
00:04:30,400 --> 00:04:32,720
find misconfigured uh accidentally

126
00:04:32,720 --> 00:04:33,840
exposed to the internet you know and

127
00:04:33,840 --> 00:04:35,520
then the obvious stuff misconfigured git

128
00:04:35,520 --> 00:04:37,840
repos leaky buckets you know all that

129
00:04:37,840 --> 00:04:39,040
good stuff

130
00:04:39,040 --> 00:04:41,360
um and before we get into the technical

131
00:04:41,360 --> 00:04:43,280
side um a little story time this is why

132
00:04:43,280 --> 00:04:45,360
i gave the legal disclaimer so there was

133
00:04:45,360 --> 00:04:47,520
a gentleman uh robert hutchinson a

134
00:04:47,520 --> 00:04:50,320
climate activist in london who

135
00:04:50,320 --> 00:04:52,320
was doing some research on a big evil

136
00:04:52,320 --> 00:04:54,240
company big developer who was going to

137
00:04:54,240 --> 00:04:57,040
tear down some playgrounds um in his

138
00:04:57,040 --> 00:04:59,840
community this is a true story uh

139
00:04:59,840 --> 00:05:02,479
now robert was googling the company

140
00:05:02,479 --> 00:05:04,240
found their internal note-taking

141
00:05:04,240 --> 00:05:06,240
software online

142
00:05:06,240 --> 00:05:08,160
um took a screenshot of the notes he

143
00:05:08,160 --> 00:05:09,199
found within it which had some

144
00:05:09,199 --> 00:05:11,280
interesting info about them like i don't

145
00:05:11,280 --> 00:05:13,280
know bribing or

146
00:05:13,280 --> 00:05:15,039
you know trying to influence people in

147
00:05:15,039 --> 00:05:17,039
the community to vote for what they were

148
00:05:17,039 --> 00:05:19,120
doing um and he shared those notes via

149
00:05:19,120 --> 00:05:21,039
twitter the next morning you know his

150
00:05:21,039 --> 00:05:23,039
door gets kicked in the met police cyber

151
00:05:23,039 --> 00:05:25,520
crime unit uh has taken him into custody

152
00:05:25,520 --> 00:05:26,800
you'd think they'd do some due diligence

153
00:05:26,800 --> 00:05:27,919
to see if there was actually a crime

154
00:05:27,919 --> 00:05:29,520
here because they were the cyber crime

155
00:05:29,520 --> 00:05:32,000
task force but uh no they did not so

156
00:05:32,000 --> 00:05:34,320
after a brief investigation like six

157
00:05:34,320 --> 00:05:36,840
hours um robert is

158
00:05:36,840 --> 00:05:39,280
released uh because the metropolitan

159
00:05:39,280 --> 00:05:41,039
police cyber crime unit determined that

160
00:05:41,039 --> 00:05:42,639
because those files which they were

161
00:05:42,639 --> 00:05:44,479
internal like these are internal

162
00:05:44,479 --> 00:05:47,280
corporate notes they are proprietary um

163
00:05:47,280 --> 00:05:50,000
they are confidential but because a

164
00:05:50,000 --> 00:05:52,240
search engine index them they were

165
00:05:52,240 --> 00:05:54,639
considered a part of the public domain

166
00:05:54,639 --> 00:05:56,639
after that so how does that apply to

167
00:05:56,639 --> 00:05:57,919
classified information how does that

168
00:05:57,919 --> 00:06:00,400
apply to you know all kinds of internal

169
00:06:00,400 --> 00:06:02,960
marked uh documents who the hell knows

170
00:06:02,960 --> 00:06:04,639
no one knows like this is the only this

171
00:06:04,639 --> 00:06:06,000
is one of the only examples of actual

172
00:06:06,000 --> 00:06:08,160
litigation we have uh which is why i

173
00:06:08,160 --> 00:06:09,680
call um

174
00:06:09,680 --> 00:06:12,319
intent to publicize whatever whatever

175
00:06:12,319 --> 00:06:13,840
intentional or unintentional it doesn't

176
00:06:13,840 --> 00:06:15,840
really matter once it's out there it's a

177
00:06:15,840 --> 00:06:18,400
part of the public domain and enforcing

178
00:06:18,400 --> 00:06:20,800
uh you know some kind of legal action

179
00:06:20,800 --> 00:06:22,000
against someone who's got their hands on

180
00:06:22,000 --> 00:06:23,759
it is going to be pretty difficult now

181
00:06:23,759 --> 00:06:25,680
those logos at the bottom

182
00:06:25,680 --> 00:06:27,759
are all examples of companies who've had

183
00:06:27,759 --> 00:06:29,680
similar issues whether it's from third

184
00:06:29,680 --> 00:06:31,919
parties accidentally leaking buckets

185
00:06:31,919 --> 00:06:34,000
third parties with note-taking software

186
00:06:34,000 --> 00:06:36,080
that became publicly exposed the company

187
00:06:36,080 --> 00:06:38,560
themselves accidentally exposing um an

188
00:06:38,560 --> 00:06:41,440
entire sharepoint like directory which

189
00:06:41,440 --> 00:06:42,960
exposes all the files within which then

190
00:06:42,960 --> 00:06:44,560
become indexed by google and very easy

191
00:06:44,560 --> 00:06:46,720
to access there's really no shortage of

192
00:06:46,720 --> 00:06:48,639
examples in recent history of this being

193
00:06:48,639 --> 00:06:50,880
very problematic

194
00:06:50,880 --> 00:06:52,639
so how do we find corporate documents

195
00:06:52,639 --> 00:06:54,160
i'm sure most of you are familiar with

196
00:06:54,160 --> 00:06:56,319
google dorks they're super super easy to

197
00:06:56,319 --> 00:06:58,080
do basically what a google door is is

198
00:06:58,080 --> 00:07:00,400
using google's uh sort of you know

199
00:07:00,400 --> 00:07:02,479
pseudo-advanced search syntax

200
00:07:02,479 --> 00:07:04,479
to narrow down your search results to

201
00:07:04,479 --> 00:07:06,560
very specific things so in the examples

202
00:07:06,560 --> 00:07:08,160
i'm showing here we're looking for

203
00:07:08,160 --> 00:07:10,000
specific file types associated with a

204
00:07:10,000 --> 00:07:12,080
domain um in that first one you can use

205
00:07:12,080 --> 00:07:13,360
wildcards in these searches too so in

206
00:07:13,360 --> 00:07:14,800
the first one i'm saying

207
00:07:14,800 --> 00:07:17,759
um in in the url that i'm looking for in

208
00:07:17,759 --> 00:07:19,440
the search result i want the word admin

209
00:07:19,440 --> 00:07:21,360
to be there the file type that the url

210
00:07:21,360 --> 00:07:22,479
is pointing to i want it to be a

211
00:07:22,479 --> 00:07:24,800
spreadsheet and the site is gov dot

212
00:07:24,800 --> 00:07:26,720
anything which the first is gov.ng

213
00:07:26,720 --> 00:07:27,680
there's a bunch of other interesting

214
00:07:27,680 --> 00:07:29,120
ones all those files by the way were

215
00:07:29,120 --> 00:07:30,560
absolutely not supposed to be exposed to

216
00:07:30,560 --> 00:07:33,680
the internet super fun search um

217
00:07:33,680 --> 00:07:36,400
and uh every example i have uh going

218
00:07:36,400 --> 00:07:39,599
down is other examples pointing at

219
00:07:39,599 --> 00:07:41,199
different corporate entities but

220
00:07:41,199 --> 00:07:42,639
specifying what i want to see in the

221
00:07:42,639 --> 00:07:44,960
text so i'm saying in in the second

222
00:07:44,960 --> 00:07:49,039
search site blank.com show me docx so

223
00:07:49,039 --> 00:07:51,199
show me document files with the word

224
00:07:51,199 --> 00:07:53,520
proprietary in the file because google

225
00:07:53,520 --> 00:07:55,280
has indexed the contents of the files as

226
00:07:55,280 --> 00:07:57,599
well it's not just indexing html pages

227
00:07:57,599 --> 00:07:59,520
it's indexing the text within the files

228
00:07:59,520 --> 00:08:01,919
that it finds also and the last search

229
00:08:01,919 --> 00:08:03,599
um of course it would be very crass to

230
00:08:03,599 --> 00:08:06,720
call out uh you know the the wonderful

231
00:08:06,720 --> 00:08:08,400
venue that's hosted us but the name of

232
00:08:08,400 --> 00:08:09,759
that uh

233
00:08:09,759 --> 00:08:11,120
the name of that entity rhymes with

234
00:08:11,120 --> 00:08:13,840
samaritan schmotels if you do if you

235
00:08:13,840 --> 00:08:15,440
plug in their site with pdf and intex

236
00:08:15,440 --> 00:08:17,280
proprietary it comes up with all kinds

237
00:08:17,280 --> 00:08:18,560
of things that are tagged confidential

238
00:08:18,560 --> 00:08:20,639
proprietary not for public release all

239
00:08:20,639 --> 00:08:22,879
that kind of stuff

240
00:08:22,879 --> 00:08:25,360
and exploitdb is the best these are

241
00:08:25,360 --> 00:08:28,000
really simple dorks uh which find super

242
00:08:28,000 --> 00:08:30,319
juicy stuff now if you want to find even

243
00:08:30,319 --> 00:08:33,039
juicier stuff exploit db has a google

244
00:08:33,039 --> 00:08:34,640
hacking database filled with dorks the

245
00:08:34,640 --> 00:08:36,799
most fun category um for me at least is

246
00:08:36,799 --> 00:08:38,799
files containing juicy info so this is

247
00:08:38,799 --> 00:08:40,559
how to search specifically for file

248
00:08:40,559 --> 00:08:42,479
types that have been exposed by certain

249
00:08:42,479 --> 00:08:45,040
types of software that are sitting on

250
00:08:45,040 --> 00:08:46,320
the internet and again

251
00:08:46,320 --> 00:08:48,640
uh i do not condone viewing these files

252
00:08:48,640 --> 00:08:51,120
um without permission of the owner

253
00:08:51,120 --> 00:08:52,160
so this is something we're gonna come

254
00:08:52,160 --> 00:08:53,760
back to a few times but

255
00:08:53,760 --> 00:08:55,519
the adversarial value of a document

256
00:08:55,519 --> 00:08:56,720
we're going to talk about metadata and

257
00:08:56,720 --> 00:08:58,480
contents now talking about metadata

258
00:08:58,480 --> 00:08:59,760
specifically what i mean when i say

259
00:08:59,760 --> 00:09:02,320
metadata are the the properties attached

260
00:09:02,320 --> 00:09:04,080
to a file that

261
00:09:04,080 --> 00:09:06,080
are really only used

262
00:09:06,080 --> 00:09:08,560
in an advanced way by the sort of lab

263
00:09:08,560 --> 00:09:10,399
software i was talking about so like in

264
00:09:10,399 --> 00:09:12,320
a manufacturing environment you've got

265
00:09:12,320 --> 00:09:13,920
heavy fim on these files you've got

266
00:09:13,920 --> 00:09:15,839
people editing them that have super

267
00:09:15,839 --> 00:09:17,440
important pharmaceutical contents in

268
00:09:17,440 --> 00:09:19,040
them it's very important to track that

269
00:09:19,040 --> 00:09:20,880
metadata that's a good reason for file

270
00:09:20,880 --> 00:09:23,360
metadata to exist beyond that releasing

271
00:09:23,360 --> 00:09:25,200
files with metadata attached especially

272
00:09:25,200 --> 00:09:26,240
to the public

273
00:09:26,240 --> 00:09:28,320
is not super necessary but when i'm

274
00:09:28,320 --> 00:09:29,839
talking about metadata i'm talking about

275
00:09:29,839 --> 00:09:31,839
the things in the file that show how

276
00:09:31,839 --> 00:09:33,279
this file was made

277
00:09:33,279 --> 00:09:35,040
who made it when it was made and we'll

278
00:09:35,040 --> 00:09:36,320
get into the specific properties in a

279
00:09:36,320 --> 00:09:37,600
second contents i don't even need to

280
00:09:37,600 --> 00:09:40,480
explain that's just what's in the file

281
00:09:40,480 --> 00:09:42,480
so talking about metadata extraction of

282
00:09:42,480 --> 00:09:45,279
metadata from a file um is easiest done

283
00:09:45,279 --> 00:09:46,560
using exif tool there's a couple

284
00:09:46,560 --> 00:09:48,000
different iterations of this in

285
00:09:48,000 --> 00:09:49,839
different languages but exif tool is by

286
00:09:49,839 --> 00:09:51,920
far the gold standard in metadata

287
00:09:51,920 --> 00:09:53,920
extraction you can extract if they've

288
00:09:53,920 --> 00:09:55,440
got a command line and a gui version for

289
00:09:55,440 --> 00:09:57,120
windows but the command line version is

290
00:09:57,120 --> 00:09:58,800
much more popular and you can extract

291
00:09:58,800 --> 00:10:01,440
metadata from roughly 200 file types so

292
00:10:01,440 --> 00:10:03,200
in this example i'm pulling the metadata

293
00:10:03,200 --> 00:10:05,279
out of a jpeg

294
00:10:05,279 --> 00:10:06,640
that's literally the command you install

295
00:10:06,640 --> 00:10:08,480
the utility exif tool point it to the

296
00:10:08,480 --> 00:10:11,360
file it will pull down everything um and

297
00:10:11,360 --> 00:10:12,720
there's so much metadata associated with

298
00:10:12,720 --> 00:10:14,640
file i just cut it out in the second

299
00:10:14,640 --> 00:10:16,800
example i'm grepping just for just show

300
00:10:16,800 --> 00:10:19,600
me the key value pairs that have gps um

301
00:10:19,600 --> 00:10:22,160
in the field so this is showing me uh as

302
00:10:22,160 --> 00:10:24,320
an example for a jpeg file you know with

303
00:10:24,320 --> 00:10:26,320
most smartphones most digital cameras

304
00:10:26,320 --> 00:10:28,959
are recording gps information about the

305
00:10:28,959 --> 00:10:30,560
photo this is certainly not news this is

306
00:10:30,560 --> 00:10:31,279
like

307
00:10:31,279 --> 00:10:33,120
in the wild this is probably what you'll

308
00:10:33,120 --> 00:10:35,600
see metadata used for most an exif tool

309
00:10:35,600 --> 00:10:37,839
used for most is reporting on you know

310
00:10:37,839 --> 00:10:39,680
ocean tracking via

311
00:10:39,680 --> 00:10:43,279
geo data stored in photos um

312
00:10:43,279 --> 00:10:44,880
so we've got like latitudinal and

313
00:10:44,880 --> 00:10:46,880
longitudinal locations of the photo

314
00:10:46,880 --> 00:10:49,440
taken it's location above sea level very

315
00:10:49,440 --> 00:10:51,839
very specific pieces of metadata um can

316
00:10:51,839 --> 00:10:53,440
be contained within a file but what

317
00:10:53,440 --> 00:10:56,079
we're talking about is uh you know

318
00:10:56,079 --> 00:10:58,160
office productivity file types so using

319
00:10:58,160 --> 00:11:00,079
exif tool you can do the same thing you

320
00:11:00,079 --> 00:11:02,320
can run it against any kind of file what

321
00:11:02,320 --> 00:11:03,760
we're looking at here and these are

322
00:11:03,760 --> 00:11:05,279
files that i pulled this week i

323
00:11:05,279 --> 00:11:06,480
presented them in a little more of an

324
00:11:06,480 --> 00:11:08,320
easy to digest way but

325
00:11:08,320 --> 00:11:09,380
powerpoint

326
00:11:09,380 --> 00:11:10,560
[Music]

327
00:11:10,560 --> 00:11:11,600
a

328
00:11:11,600 --> 00:11:14,560
word document exported to a pdf and then

329
00:11:14,560 --> 00:11:16,560
a regular old pdf so there's a lot of

330
00:11:16,560 --> 00:11:18,320
interesting things that exif tool is

331
00:11:18,320 --> 00:11:21,040
pulling out of the file metadata here

332
00:11:21,040 --> 00:11:23,200
that that i'd like to point out uh first

333
00:11:23,200 --> 00:11:24,720
of all when pulling these files what i'm

334
00:11:24,720 --> 00:11:27,519
most often finding in the author fields

335
00:11:27,519 --> 00:11:29,440
is um either actual active directory

336
00:11:29,440 --> 00:11:30,880
credentials so internal credentials

337
00:11:30,880 --> 00:11:32,880
which is very valuable to an adversary a

338
00:11:32,880 --> 00:11:34,079
lot of them have first and last name

339
00:11:34,079 --> 00:11:36,160
combos not super you know that's not

340
00:11:36,160 --> 00:11:38,079
really that interesting um it gives me

341
00:11:38,079 --> 00:11:40,959
the name of someone on the inside but um

342
00:11:40,959 --> 00:11:43,279
like an ad credential or any sort of idp

343
00:11:43,279 --> 00:11:44,480
credential is a lot more valuable

344
00:11:44,480 --> 00:11:46,160
because i can take that you know

345
00:11:46,160 --> 00:11:47,680
brute force the subdomains and start

346
00:11:47,680 --> 00:11:49,360
poking into things that don't accept

347
00:11:49,360 --> 00:11:52,160
emails but only accept actual usernames

348
00:11:52,160 --> 00:11:53,200
so

349
00:11:53,200 --> 00:11:54,639
in that document in the middle we've got

350
00:11:54,639 --> 00:11:57,040
an active directory username in the

351
00:11:57,040 --> 00:11:59,920
metadata of a word document we've got

352
00:11:59,920 --> 00:12:01,440
the timestamp that the document was

353
00:12:01,440 --> 00:12:02,639
created and the only reason that's

354
00:12:02,639 --> 00:12:04,639
interesting is because we've got a

355
00:12:04,639 --> 00:12:06,240
software version below of the tool that

356
00:12:06,240 --> 00:12:07,440
created it

357
00:12:07,440 --> 00:12:09,279
and it's an outdated version it's adobe

358
00:12:09,279 --> 00:12:11,920
acrobat pro from 2017 which we can see

359
00:12:11,920 --> 00:12:14,480
in uh at the tail end of 2021 is still

360
00:12:14,480 --> 00:12:16,079
running on this host

361
00:12:16,079 --> 00:12:17,839
so really the value

362
00:12:17,839 --> 00:12:19,279
the value in that and the value that we

363
00:12:19,279 --> 00:12:20,639
piece together from a lot of documents

364
00:12:20,639 --> 00:12:22,639
is we can start to put together an

365
00:12:22,639 --> 00:12:24,639
inventory of software the more often we

366
00:12:24,639 --> 00:12:26,800
see a piece of software reoccurring in a

367
00:12:26,800 --> 00:12:28,480
company's public documents intentional

368
00:12:28,480 --> 00:12:30,399
otherwise the better chance we have at

369
00:12:30,399 --> 00:12:32,880
putting together an internal inventory

370
00:12:32,880 --> 00:12:34,800
of like what is probably on the gold

371
00:12:34,800 --> 00:12:36,800
image of most of these laptops which

372
00:12:36,800 --> 00:12:38,800
makes building a payload you know you've

373
00:12:38,800 --> 00:12:41,040
got a much higher degree of confidence

374
00:12:41,040 --> 00:12:42,720
when building a payload some some of

375
00:12:42,720 --> 00:12:44,639
these uh some

376
00:12:44,639 --> 00:12:46,000
documents you'll pull exit from will

377
00:12:46,000 --> 00:12:48,639
have down to the dll used to produce

378
00:12:48,639 --> 00:12:50,880
that document so you've got a dll that

379
00:12:50,880 --> 00:12:53,600
you can you know potentially hook or

380
00:12:53,600 --> 00:12:55,040
do something

381
00:12:55,040 --> 00:12:57,760
uh interesting to now some other fun uh

382
00:12:57,760 --> 00:12:59,920
point outs here are in both of these

383
00:12:59,920 --> 00:13:01,279
we've got confidential markings and

384
00:13:01,279 --> 00:13:02,880
these are documents i pulled from the

385
00:13:02,880 --> 00:13:04,880
internet with very basic google doors

386
00:13:04,880 --> 00:13:06,560
these are probably

387
00:13:06,560 --> 00:13:09,519
um casby tools or dlp tools tagging

388
00:13:09,519 --> 00:13:11,600
these documents as confidential as

389
00:13:11,600 --> 00:13:14,639
they're perusing internal resources

390
00:13:14,639 --> 00:13:16,399
as they're picked up you know by the

391
00:13:16,399 --> 00:13:18,240
sensors as they're flying around but

392
00:13:18,240 --> 00:13:20,000
they're still making it onto the

393
00:13:20,000 --> 00:13:22,959
internet despite a cosby tool or a dlp

394
00:13:22,959 --> 00:13:24,880
tool tagging it and probably trying to

395
00:13:24,880 --> 00:13:27,440
prevent its publication online due to

396
00:13:27,440 --> 00:13:30,240
some misconfiguration um

397
00:13:30,240 --> 00:13:32,480
both of these documents uh contain

398
00:13:32,480 --> 00:13:34,000
confidential information and we're

399
00:13:34,000 --> 00:13:36,800
specifically tagged as confidential but

400
00:13:36,800 --> 00:13:38,079
we're sitting

401
00:13:38,079 --> 00:13:40,399
with a publicly available google indexed

402
00:13:40,399 --> 00:13:42,720
url um online and they've got they've

403
00:13:42,720 --> 00:13:44,000
all got interesting tags which you can

404
00:13:44,000 --> 00:13:45,839
also use the tags to put together what

405
00:13:45,839 --> 00:13:48,000
security suites like what what security

406
00:13:48,000 --> 00:13:49,760
suite uses this kind of tagging

407
00:13:49,760 --> 00:13:51,600
infrastructure so you can put together

408
00:13:51,600 --> 00:13:54,720
again a good idea of software versions

409
00:13:54,720 --> 00:13:56,079
and types running on the inside in

410
00:13:56,079 --> 00:13:57,199
addition to

411
00:13:57,199 --> 00:13:59,279
uh user names and a bunch of other stuff

412
00:13:59,279 --> 00:14:00,560
a file i looked at yesterday had like

413
00:14:00,560 --> 00:14:02,320
someone an employee's name and their

414
00:14:02,320 --> 00:14:04,240
manager in the pdf's metadata i don't

415
00:14:04,240 --> 00:14:05,440
know why these

416
00:14:05,440 --> 00:14:07,440
uh i don't know why products do it that

417
00:14:07,440 --> 00:14:08,320
way

418
00:14:08,320 --> 00:14:09,839
but a couple open source scripts to get

419
00:14:09,839 --> 00:14:11,199
started and looking at the metadata of

420
00:14:11,199 --> 00:14:13,120
your own organization or of whoever the

421
00:14:13,120 --> 00:14:15,360
hell you want is pi meta and power meta

422
00:14:15,360 --> 00:14:16,399
the only difference between the two

423
00:14:16,399 --> 00:14:18,560
pymet is a little more maintained um and

424
00:14:18,560 --> 00:14:20,079
is written in python powermet is in

425
00:14:20,079 --> 00:14:21,839
powershell so you know depending on your

426
00:14:21,839 --> 00:14:23,199
environment you can get up and running

427
00:14:23,199 --> 00:14:24,880
with one of these really quickly uh what

428
00:14:24,880 --> 00:14:27,040
both of them do is dork google and bing

429
00:14:27,040 --> 00:14:30,320
for files pull them all down um extract

430
00:14:30,320 --> 00:14:32,639
the metadata with exif tool and put all

431
00:14:32,639 --> 00:14:34,480
the files in a directory for you so i

432
00:14:34,480 --> 00:14:36,160
encourage you to check those out so to

433
00:14:36,160 --> 00:14:38,959
conclude on metadata alone uh what we've

434
00:14:38,959 --> 00:14:41,199
just looked at what is the adversarial

435
00:14:41,199 --> 00:14:43,279
value of metadata a few things one is an

436
00:14:43,279 --> 00:14:45,279
internal inventory of username uh

437
00:14:45,279 --> 00:14:47,279
usernames and conventions so sometimes

438
00:14:47,279 --> 00:14:49,760
host naming conventions sometimes uh os

439
00:14:49,760 --> 00:14:51,519
versions an inventory of internal

440
00:14:51,519 --> 00:14:52,959
software so we can start to put together

441
00:14:52,959 --> 00:14:54,560
depending on how many documents a pretty

442
00:14:54,560 --> 00:14:56,480
confident gold image of what this

443
00:14:56,480 --> 00:14:57,600
enterprise might be running on the

444
00:14:57,600 --> 00:14:59,199
inside like it's super easy from the

445
00:14:59,199 --> 00:15:01,760
outside to poke at the vanity domain and

446
00:15:01,760 --> 00:15:03,600
see what software is running on the

447
00:15:03,600 --> 00:15:05,120
outside so like maybe we can tell

448
00:15:05,120 --> 00:15:07,360
they're using sales force but now we can

449
00:15:07,360 --> 00:15:09,839
tell what's going on on the actual hosts

450
00:15:09,839 --> 00:15:11,920
running inside the company um and then

451
00:15:11,920 --> 00:15:13,519
obviously the identification of tagged

452
00:15:13,519 --> 00:15:15,199
confidential content which is really

453
00:15:15,199 --> 00:15:16,800
only something i've seen in the last

454
00:15:16,800 --> 00:15:19,040
couple years with the

455
00:15:19,040 --> 00:15:21,600
adoption of casby and the slow death of

456
00:15:21,600 --> 00:15:23,760
dlp traditional dlp

457
00:15:23,760 --> 00:15:25,360
is tagged confidential documents making

458
00:15:25,360 --> 00:15:26,480
their way

459
00:15:26,480 --> 00:15:28,480
onto the internet despite protection so

460
00:15:28,480 --> 00:15:30,639
talking about document contents

461
00:15:30,639 --> 00:15:32,000
i'm going to show you some cool dork

462
00:15:32,000 --> 00:15:35,120
examples again stupid simple dorks that

463
00:15:35,120 --> 00:15:37,360
yield incredibly interesting results

464
00:15:37,360 --> 00:15:38,639
and i'll get a little more specific with

465
00:15:38,639 --> 00:15:40,240
each one on how you can narrow down what

466
00:15:40,240 --> 00:15:41,839
you're looking for but the interest the

467
00:15:41,839 --> 00:15:44,000
most interesting takeaway like back in

468
00:15:44,000 --> 00:15:46,320
2007 when most metadata document

469
00:15:46,320 --> 00:15:48,720
metadata research was done um a google

470
00:15:48,720 --> 00:15:50,000
door is probably going to show you

471
00:15:50,000 --> 00:15:52,160
things linked directly to the parent

472
00:15:52,160 --> 00:15:54,880
domain of the company in this example i

473
00:15:54,880 --> 00:15:56,959
am dorking a dot gov domain looking for

474
00:15:56,959 --> 00:16:00,800
file type xlsx what i'm given is a blank

475
00:16:00,800 --> 00:16:02,959
state police spreadsheet i click on it

476
00:16:02,959 --> 00:16:06,800
and it takes me to sharepoint so

477
00:16:06,800 --> 00:16:08,639
the reason that's happening if despite

478
00:16:08,639 --> 00:16:09,839
the fact that you would think i would

479
00:16:09,839 --> 00:16:12,320
have to do

480
00:16:12,440 --> 00:16:13,920
siteview.officeapps.live.com show me

481
00:16:13,920 --> 00:16:17,199
spreadsheets um in the i've blurted out

482
00:16:17,199 --> 00:16:18,399
so it's kind of hard to see but that

483
00:16:18,399 --> 00:16:21,839
second blue box in the office apps url

484
00:16:21,839 --> 00:16:23,519
um so this is a document shared via

485
00:16:23,519 --> 00:16:26,639
onedriver sharepoint is the tenant name

486
00:16:26,639 --> 00:16:28,959
for this particular file so google is

487
00:16:28,959 --> 00:16:30,880
smart enough to know this file is

488
00:16:30,880 --> 00:16:33,920
associated with this domain um because

489
00:16:33,920 --> 00:16:36,639
it's in the tenant location in the url

490
00:16:36,639 --> 00:16:39,519
so now exposed sharepoint files are

491
00:16:39,519 --> 00:16:40,880
accidentally

492
00:16:40,880 --> 00:16:43,040
um despite not being on your domain

493
00:16:43,040 --> 00:16:45,120
actually are associated with your domain

494
00:16:45,120 --> 00:16:47,600
in the public and dorkable so that's

495
00:16:47,600 --> 00:16:50,079
super bad news

496
00:16:50,079 --> 00:16:52,240
this example is you know it gave me some

497
00:16:52,240 --> 00:16:54,320
defense logistics agency report of

498
00:16:54,320 --> 00:16:55,759
transfers from

499
00:16:55,759 --> 00:16:56,720
uh

500
00:16:56,720 --> 00:16:58,880
the defense logistics agency to

501
00:16:58,880 --> 00:17:00,320
some law enforcement offices that i've

502
00:17:00,320 --> 00:17:02,240
blurred out and it's pretty boring stuff

503
00:17:02,240 --> 00:17:03,759
air conditioners bench presses but there

504
00:17:03,759 --> 00:17:04,880
was some cool stuff in there like

505
00:17:04,880 --> 00:17:08,000
rucksacks and body armor and i'm sure

506
00:17:08,000 --> 00:17:09,280
the more i scrolled through results the

507
00:17:09,280 --> 00:17:11,119
more i would have found um

508
00:17:11,119 --> 00:17:13,199
more interesting logistical information

509
00:17:13,199 --> 00:17:14,559
uh but another example is getting a

510
00:17:14,559 --> 00:17:16,240
little more specific with terms and just

511
00:17:16,240 --> 00:17:18,400
how easy it is this was the first search

512
00:17:18,400 --> 00:17:20,160
i ran while making this presentation and

513
00:17:20,160 --> 00:17:21,919
it immediately came up uh with good

514
00:17:21,919 --> 00:17:24,240
results so this is uh this was an

515
00:17:24,240 --> 00:17:25,199
internal

516
00:17:25,199 --> 00:17:27,760
um this was not like something hosted on

517
00:17:27,760 --> 00:17:29,520
their vanity this is something hosted on

518
00:17:29,520 --> 00:17:31,600
the vanity domain kind of but through a

519
00:17:31,600 --> 00:17:33,039
back-end application that they use to

520
00:17:33,039 --> 00:17:34,960
share presentations internally so

521
00:17:34,960 --> 00:17:36,080
running

522
00:17:36,080 --> 00:17:37,440
this dork against this particular

523
00:17:37,440 --> 00:17:39,840
company i'm just saying site

524
00:17:39,840 --> 00:17:41,360
companyname.com

525
00:17:41,360 --> 00:17:43,919
um file type pdf and in the text of the

526
00:17:43,919 --> 00:17:46,160
pdf i want to see the word confidential

527
00:17:46,160 --> 00:17:48,720
so the first link immediately business

528
00:17:48,720 --> 00:17:50,640
confidential i click on it super

529
00:17:50,640 --> 00:17:52,480
internal powerpoint that is absolutely

530
00:17:52,480 --> 00:17:54,160
tagged on every slide business

531
00:17:54,160 --> 00:17:55,760
confidential and you can see in all the

532
00:17:55,760 --> 00:17:57,280
other files i'm getting the same kind of

533
00:17:57,280 --> 00:17:59,039
internal markers so if i knew more about

534
00:17:59,039 --> 00:18:00,320
this company if they had a specific

535
00:18:00,320 --> 00:18:02,799
marking they used on everything to tag

536
00:18:02,799 --> 00:18:04,240
it as internal i could just plug that in

537
00:18:04,240 --> 00:18:05,280
and get

538
00:18:05,280 --> 00:18:07,200
even more filtered results but you know

539
00:18:07,200 --> 00:18:08,240
you can just read in the results

540
00:18:08,240 --> 00:18:09,600
proprietary and confidential this

541
00:18:09,600 --> 00:18:10,880
document contains confidential

542
00:18:10,880 --> 00:18:13,120
information no disclosure duplication

543
00:18:13,120 --> 00:18:15,840
whatever so um was were these

544
00:18:15,840 --> 00:18:17,840
intentionally disclosed i don't know it

545
00:18:17,840 --> 00:18:19,679
sure doesn't feel like it um and it

546
00:18:19,679 --> 00:18:20,960
especially didn't feel like it with this

547
00:18:20,960 --> 00:18:23,440
example so this was a different.gov

548
00:18:23,440 --> 00:18:25,360
domain i pointed to where i got a little

549
00:18:25,360 --> 00:18:26,559
more specific because i know a little

550
00:18:26,559 --> 00:18:28,320
bit more about how this particular

551
00:18:28,320 --> 00:18:30,880
organization runs so i said in-text show

552
00:18:30,880 --> 00:18:33,679
me case numbers in spreadsheets and

553
00:18:33,679 --> 00:18:35,600
again i'm taken to a sharepoint site so

554
00:18:35,600 --> 00:18:37,760
this this sharepoint issue presents

555
00:18:37,760 --> 00:18:40,559
itself um once again and clicking into

556
00:18:40,559 --> 00:18:42,400
uh despite the fact that it says pdfs in

557
00:18:42,400 --> 00:18:44,240
the link this is a spreadsheet it's

558
00:18:44,240 --> 00:18:46,960
tagged as xls by google when i click

559
00:18:46,960 --> 00:18:49,440
into it this particular spreadsheet

560
00:18:49,440 --> 00:18:52,080
had on every single you can see i'm

561
00:18:52,080 --> 00:18:54,400
pretty deep in there i'm on um column a0

562
00:18:54,400 --> 00:18:57,039
on every single row it had a unique

563
00:18:57,039 --> 00:18:58,960
email first name last name combo and

564
00:18:58,960 --> 00:19:01,200
address for an individual associated

565
00:19:01,200 --> 00:19:04,480
with a particular case type um and there

566
00:19:04,480 --> 00:19:07,520
were nine just shy of ten thousand um of

567
00:19:07,520 --> 00:19:09,120
these rows about nine thousand so that's

568
00:19:09,120 --> 00:19:12,160
30 000 unique um first name last name

569
00:19:12,160 --> 00:19:14,559
address and email combos now was this

570
00:19:14,559 --> 00:19:16,480
intentionally released it sure didn't

571
00:19:16,480 --> 00:19:18,960
feel like it but maybe and it's probably

572
00:19:18,960 --> 00:19:20,400
not a good look to have something like

573
00:19:20,400 --> 00:19:22,240
this i'm sitting out in the public my

574
00:19:22,240 --> 00:19:24,080
best guess usually the the case for

575
00:19:24,080 --> 00:19:25,600
things like this is they're sharing this

576
00:19:25,600 --> 00:19:27,200
data with a sister agency they're

577
00:19:27,200 --> 00:19:29,120
sharing this data with a consultant and

578
00:19:29,120 --> 00:19:30,880
it's because they're not linked to their

579
00:19:30,880 --> 00:19:32,400
identity infrastructure in any way they

580
00:19:32,400 --> 00:19:34,720
share via url and even when you try to

581
00:19:34,720 --> 00:19:36,799
narrow that down it doesn't always

582
00:19:36,799 --> 00:19:39,600
work uh quite how you think it should so

583
00:19:39,600 --> 00:19:41,760
this sharepoint uh file and i didn't

584
00:19:41,760 --> 00:19:42,880
even look at the other ones who the hell

585
00:19:42,880 --> 00:19:45,520
knows what was in them um was incredibly

586
00:19:45,520 --> 00:19:48,160
juicy right out of the gate

587
00:19:48,160 --> 00:19:50,160
so in terms of the adversarial value of

588
00:19:50,160 --> 00:19:51,919
a public document the contents are

589
00:19:51,919 --> 00:19:54,160
obvious right potentially passive

590
00:19:54,160 --> 00:19:55,760
collection of internal data and

591
00:19:55,760 --> 00:19:57,760
compromising data exposed via

592
00:19:57,760 --> 00:19:59,760
collaboration software and in every

593
00:19:59,760 --> 00:20:01,440
example i showed you collaboration

594
00:20:01,440 --> 00:20:03,600
software or internal misconfigurations

595
00:20:03,600 --> 00:20:05,600
now the reason i say potentially passive

596
00:20:05,600 --> 00:20:07,679
is because when you used to run a google

597
00:20:07,679 --> 00:20:09,440
door and download a bunch of documents

598
00:20:09,440 --> 00:20:11,280
from a company's website you'd be

599
00:20:11,280 --> 00:20:14,000
cutting logs on a web server now these

600
00:20:14,000 --> 00:20:16,400
files are hosted somewhere else with the

601
00:20:16,400 --> 00:20:18,799
rapid adoption of sas you're cutting

602
00:20:18,799 --> 00:20:21,600
logs somewhere that they you know are

603
00:20:21,600 --> 00:20:23,440
probably not going to this enterprise's

604
00:20:23,440 --> 00:20:26,000
sim so while it's not you know it's not

605
00:20:26,000 --> 00:20:27,120
actually

606
00:20:27,120 --> 00:20:28,000
uh

607
00:20:28,000 --> 00:20:29,760
passive in that you are cutting logs

608
00:20:29,760 --> 00:20:31,520
somewhere you're probably not cutting

609
00:20:31,520 --> 00:20:33,840
logs somewhere that the organization has

610
00:20:33,840 --> 00:20:35,679
access to in the case of sharepoint you

611
00:20:35,679 --> 00:20:37,679
know maybe and maybe the logs can be

612
00:20:37,679 --> 00:20:40,240
requested but um what you're doing you

613
00:20:40,240 --> 00:20:42,400
know dorking already on a corporate

614
00:20:42,400 --> 00:20:44,320
domain it looks like normal activity

615
00:20:44,320 --> 00:20:45,840
it's normal web server activity it's not

616
00:20:45,840 --> 00:20:47,200
going to be hitting any like advanced

617
00:20:47,200 --> 00:20:49,679
ueba alerts um or triggering much on the

618
00:20:49,679 --> 00:20:51,280
waff if you're just downloading files

619
00:20:51,280 --> 00:20:53,840
right it looks pretty normal um

620
00:20:53,840 --> 00:20:55,679
and now you're even one step removed

621
00:20:55,679 --> 00:20:57,280
from the complexity there

622
00:20:57,280 --> 00:20:58,320
uh

623
00:20:58,320 --> 00:21:00,559
and the last uh

624
00:21:00,559 --> 00:21:02,960
content um value i have there's wireless

625
00:21:02,960 --> 00:21:04,880
ransom now this is not common it's

626
00:21:04,880 --> 00:21:06,240
something that i think could be more

627
00:21:06,240 --> 00:21:08,720
common but without in all the documents

628
00:21:08,720 --> 00:21:10,000
i showed you these are potentially

629
00:21:10,000 --> 00:21:11,200
things that would have been interesting

630
00:21:11,200 --> 00:21:14,480
finds during an internal red team um

631
00:21:14,480 --> 00:21:16,000
depending on the scope of what i'm

632
00:21:16,000 --> 00:21:17,120
looking for

633
00:21:17,120 --> 00:21:18,080
uh

634
00:21:18,080 --> 00:21:20,000
i am finding you know we're finding

635
00:21:20,000 --> 00:21:22,000
files through these dorks that

636
00:21:22,000 --> 00:21:23,840
previously before the adoption of these

637
00:21:23,840 --> 00:21:25,200
cloud services and the exposure via

638
00:21:25,200 --> 00:21:28,559
public urls would have taken um phishing

639
00:21:28,559 --> 00:21:30,799
initial access uh privilege escalation

640
00:21:30,799 --> 00:21:32,159
phishing a location of the sharepoint

641
00:21:32,159 --> 00:21:33,760
server pulling down the files seeing

642
00:21:33,760 --> 00:21:35,600
what's interesting i have now done

643
00:21:35,600 --> 00:21:39,120
through like two clicks so uh

644
00:21:39,120 --> 00:21:41,120
what a lot of ransomware actors do these

645
00:21:41,120 --> 00:21:42,480
days you see in their campaigns is

646
00:21:42,480 --> 00:21:44,080
they'll not only say you know we've got

647
00:21:44,080 --> 00:21:46,320
everything pay us and we'll decrypt all

648
00:21:46,320 --> 00:21:49,039
the hosts but also uh if you don't do it

649
00:21:49,039 --> 00:21:50,799
by x time you know we've exfiltrated a

650
00:21:50,799 --> 00:21:52,960
lot too we'll start releasing it now

651
00:21:52,960 --> 00:21:54,559
without having to compromise an

652
00:21:54,559 --> 00:21:56,559
organization in a way that again cuts

653
00:21:56,559 --> 00:21:59,360
any logs you can say i found this uh

654
00:21:59,360 --> 00:22:00,799
super confidential spreadsheet about

655
00:22:00,799 --> 00:22:03,120
your upcoming merger pay me or i release

656
00:22:03,120 --> 00:22:06,400
it so without actual compromise um you

657
00:22:06,400 --> 00:22:08,720
can take content for ransom

658
00:22:08,720 --> 00:22:10,480
via its exposure which is something you

659
00:22:10,480 --> 00:22:12,320
could always do but it's become

660
00:22:12,320 --> 00:22:14,880
significantly easier with the rapid

661
00:22:14,880 --> 00:22:17,919
adoption of cloud services hosting files

662
00:22:17,919 --> 00:22:19,520
just this is just another example of

663
00:22:19,520 --> 00:22:20,799
that value in action so the bottom

664
00:22:20,799 --> 00:22:23,600
example is the contents i've cut no logs

665
00:22:23,600 --> 00:22:25,600
and i'm looking at a spreadsheet of 30

666
00:22:25,600 --> 00:22:29,440
000 unique contacts uh unique

667
00:22:29,440 --> 00:22:31,919
emails and they were not emails with for

668
00:22:31,919 --> 00:22:33,840
that entity there were people's emails

669
00:22:33,840 --> 00:22:35,919
um 30 000 unique records the content you

670
00:22:35,919 --> 00:22:37,520
know the value of that is obvious now

671
00:22:37,520 --> 00:22:40,080
with the metadata i've got in this pdf

672
00:22:40,080 --> 00:22:41,120
above

673
00:22:41,120 --> 00:22:42,880
that i pulled from a similar entity i've

674
00:22:42,880 --> 00:22:45,120
got pscript5.dll so i've got a possible

675
00:22:45,120 --> 00:22:47,200
dll to hijack i've got the specific name

676
00:22:47,200 --> 00:22:48,720
of a dll here

677
00:22:48,720 --> 00:22:50,240
i've got software versions known to be

678
00:22:50,240 --> 00:22:52,880
running on the host i've got an uh some

679
00:22:52,880 --> 00:22:55,679
kind of idp associated uh username both

680
00:22:55,679 --> 00:22:57,280
in the creator field and in the author

681
00:22:57,280 --> 00:22:59,600
field um this is a pdf but i see that it

682
00:22:59,600 --> 00:23:01,360
was created with microsoft word from the

683
00:23:01,360 --> 00:23:03,600
title of the file so i'm getting a

684
00:23:03,600 --> 00:23:05,200
pretty good idea again and i've also got

685
00:23:05,200 --> 00:23:06,880
an os version in the producer field i've

686
00:23:06,880 --> 00:23:10,400
got os x you know 10 4 6 quartz and then

687
00:23:10,400 --> 00:23:12,559
the utility used to create the pdf from

688
00:23:12,559 --> 00:23:15,200
word which was pdf context so again i'm

689
00:23:15,200 --> 00:23:16,640
putting together the more documents i

690
00:23:16,640 --> 00:23:18,320
have the more confidently i can put

691
00:23:18,320 --> 00:23:22,720
together this inventory of internal um

692
00:23:22,720 --> 00:23:25,840
you know runnings and usernames for uh

693
00:23:25,840 --> 00:23:27,360
stuffing portals that don't accept

694
00:23:27,360 --> 00:23:29,039
emails you can easily pull emails with

695
00:23:29,039 --> 00:23:30,960
like a hunter.io but where are you gonna

696
00:23:30,960 --> 00:23:32,960
pull internal creds from and it's these

697
00:23:32,960 --> 00:23:35,200
files in many cases

698
00:23:35,200 --> 00:23:38,080
uh so how do you prevent and detect this

699
00:23:38,080 --> 00:23:40,720
so prevention is uh stupidly easy in the

700
00:23:40,720 --> 00:23:44,320
most common um applications but it's not

701
00:23:44,320 --> 00:23:46,159
it's not as simple to implement for the

702
00:23:46,159 --> 00:23:47,760
business right like the folks in

703
00:23:47,760 --> 00:23:48,880
infrastructure and the folks on the

704
00:23:48,880 --> 00:23:51,039
business side might be pretty resistant

705
00:23:51,039 --> 00:23:52,720
to eliminating this because this is a

706
00:23:52,720 --> 00:23:54,960
really common way to share files in a

707
00:23:54,960 --> 00:23:57,679
totally safe way with other people it's

708
00:23:57,679 --> 00:23:59,039
just the um

709
00:23:59,039 --> 00:24:01,760
the capability itself can be misused you

710
00:24:01,760 --> 00:24:04,240
know in a way that's uh super dramatic

711
00:24:04,240 --> 00:24:05,840
and super unfortunate

712
00:24:05,840 --> 00:24:06,720
um

713
00:24:06,720 --> 00:24:08,799
on sharepoint and onedrive it is as easy

714
00:24:08,799 --> 00:24:11,200
as uh sliding a little slider down to

715
00:24:11,200 --> 00:24:14,000
least permissive and on g suite

716
00:24:14,000 --> 00:24:16,000
excuse me it's as easy as clicking uh

717
00:24:16,000 --> 00:24:18,559
the off button on uh link sharing in the

718
00:24:18,559 --> 00:24:20,400
these are both in like the admin tenants

719
00:24:20,400 --> 00:24:22,240
that's where you do it now you can also

720
00:24:22,240 --> 00:24:23,679
get a little more specific maybe you

721
00:24:23,679 --> 00:24:25,279
don't want to disable link sharing you

722
00:24:25,279 --> 00:24:27,520
can disable link sharing to anyone who's

723
00:24:27,520 --> 00:24:29,760
not in our identity infrastructure so

724
00:24:29,760 --> 00:24:32,400
you can get a little more granular and

725
00:24:32,400 --> 00:24:34,799
still allow link sharing but in a in a

726
00:24:34,799 --> 00:24:37,440
safer way but documents

727
00:24:37,440 --> 00:24:40,400
in many many cases when shared via url

728
00:24:40,400 --> 00:24:42,960
from g suite sharepoint or onedrive once

729
00:24:42,960 --> 00:24:46,320
that url exists um it will be indexed

730
00:24:46,320 --> 00:24:47,520
especially if you're like in chrome i'm

731
00:24:47,520 --> 00:24:49,039
trying to figure out all the scenarios

732
00:24:49,039 --> 00:24:50,559
um i'll put together a blog on all the

733
00:24:50,559 --> 00:24:53,039
specific scenarios that make the url

734
00:24:53,039 --> 00:24:54,880
indexed by google but there's a hell of

735
00:24:54,880 --> 00:24:56,880
a lot of them so when you make these uh

736
00:24:56,880 --> 00:24:58,960
when you make a file shareable via url

737
00:24:58,960 --> 00:25:01,039
it will be indexed by a search engine in

738
00:25:01,039 --> 00:25:02,320
most cases

739
00:25:02,320 --> 00:25:03,760
and now that is searchable by the right

740
00:25:03,760 --> 00:25:05,840
person with the right torque

741
00:25:05,840 --> 00:25:07,360
now the prevention of metadata if you've

742
00:25:07,360 --> 00:25:08,799
already got a ton of files out there and

743
00:25:08,799 --> 00:25:10,480
you put stuff out that's super useful

744
00:25:10,480 --> 00:25:12,159
and a part of normal business practice

745
00:25:12,159 --> 00:25:14,799
for you um you can strip the properties

746
00:25:14,799 --> 00:25:16,799
using like uh you know the right click

747
00:25:16,799 --> 00:25:18,240
in windows go to properties clear

748
00:25:18,240 --> 00:25:20,159
metadata that does not clear most of the

749
00:25:20,159 --> 00:25:23,840
interesting stuff um so this is the only

750
00:25:23,840 --> 00:25:26,080
method that i advocate for which is

751
00:25:26,080 --> 00:25:28,640
using the exif tool utility minus all

752
00:25:28,640 --> 00:25:31,360
equals file name uh with that argument

753
00:25:31,360 --> 00:25:33,440
uh we see on the left i have my file as

754
00:25:33,440 --> 00:25:34,640
i originally pulled it we've got that

755
00:25:34,640 --> 00:25:36,799
dll we've got all that you know the user

756
00:25:36,799 --> 00:25:38,640
names in it once i run the exif tool

757
00:25:38,640 --> 00:25:40,799
minus all it pulls all of that

758
00:25:40,799 --> 00:25:42,960
interesting stuff out now i've heard of

759
00:25:42,960 --> 00:25:45,679
ways to uh you know still retrieve that

760
00:25:45,679 --> 00:25:48,080
information but most people aren't doing

761
00:25:48,080 --> 00:25:50,159
that so this is a safe

762
00:25:50,159 --> 00:25:51,120
um

763
00:25:51,120 --> 00:25:53,279
way that i endorse to strip metadata out

764
00:25:53,279 --> 00:25:55,039
of a file before sharing it if you do

765
00:25:55,039 --> 00:25:56,880
have to share files publicly which now

766
00:25:56,880 --> 00:25:58,240
you know you should just put what the

767
00:25:58,240 --> 00:26:00,159
information on a web page but

768
00:26:00,159 --> 00:26:01,760
if you still need to share a file you

769
00:26:01,760 --> 00:26:03,600
can do it safely in a super simple

770
00:26:03,600 --> 00:26:05,919
detection pipeline uh that anyone can do

771
00:26:05,919 --> 00:26:07,279
you can do this on a box you can throw

772
00:26:07,279 --> 00:26:09,679
this into a lambda um if you run a tool

773
00:26:09,679 --> 00:26:11,520
like pi meta

774
00:26:11,520 --> 00:26:13,279
uh to download all your files you know

775
00:26:13,279 --> 00:26:14,960
on a cron job and then have a super

776
00:26:14,960 --> 00:26:16,799
simple script in bash or python or

777
00:26:16,799 --> 00:26:19,360
whatever to uh look at the metadata in

778
00:26:19,360 --> 00:26:21,120
all the files your org has out there you

779
00:26:21,120 --> 00:26:22,559
know are we accidentally exposing the

780
00:26:22,559 --> 00:26:24,159
author field the creator field are we

781
00:26:24,159 --> 00:26:25,440
are we exposing internal software

782
00:26:25,440 --> 00:26:27,919
packages um and then also grep the files

783
00:26:27,919 --> 00:26:30,000
contents for keywords that you're

784
00:26:30,000 --> 00:26:32,559
interested in like our specific tagging

785
00:26:32,559 --> 00:26:35,520
for confidential or our merger coming up

786
00:26:35,520 --> 00:26:36,720
um and

787
00:26:36,720 --> 00:26:38,159
especially if you've got something like

788
00:26:38,159 --> 00:26:41,279
your merger coming up uh run this search

789
00:26:41,279 --> 00:26:43,679
with those same keywords against

790
00:26:43,679 --> 00:26:45,520
like this is public domain stuff run it

791
00:26:45,520 --> 00:26:46,799
against everyone involved in the merger

792
00:26:46,799 --> 00:26:48,799
the two consultancies the law firm the

793
00:26:48,799 --> 00:26:49,840
mergee

794
00:26:49,840 --> 00:26:50,960
and

795
00:26:50,960 --> 00:26:53,200
see if they're not accidentally exposing

796
00:26:53,200 --> 00:26:55,840
files you know about the merger coming

797
00:26:55,840 --> 00:26:57,679
up these are things in the public domain

798
00:26:57,679 --> 00:26:59,760
you are uh legally allowed to be

799
00:26:59,760 --> 00:27:01,120
searching that especially if it's if

800
00:27:01,120 --> 00:27:03,200
it's a merger you're involved in but

801
00:27:03,200 --> 00:27:04,480
it's super easy to run this against

802
00:27:04,480 --> 00:27:06,320
yourself and run it against whoever that

803
00:27:06,320 --> 00:27:09,600
whoever else you want who might be uh

804
00:27:09,600 --> 00:27:11,120
might have this information and might be

805
00:27:11,120 --> 00:27:12,559
accidentally leaking it

806
00:27:12,559 --> 00:27:14,240
and then you know through an api send

807
00:27:14,240 --> 00:27:16,320
that alert wherever you know wherever it

808
00:27:16,320 --> 00:27:17,679
suits you

809
00:27:17,679 --> 00:27:19,520
now why does this matter a lot of us

810
00:27:19,520 --> 00:27:20,960
know about metadata already know about

811
00:27:20,960 --> 00:27:22,399
google dorks

812
00:27:22,399 --> 00:27:24,159
the reason is the landscape for dorks

813
00:27:24,159 --> 00:27:26,640
has changed quite a bit with the mass

814
00:27:26,640 --> 00:27:29,440
adoption of collaboration software and

815
00:27:29,440 --> 00:27:30,159
the

816
00:27:30,159 --> 00:27:32,159
you know switch to

817
00:27:32,159 --> 00:27:34,159
sas hosted infrastructure not a lot of

818
00:27:34,159 --> 00:27:36,000
file sharing things are on-prem anymore

819
00:27:36,000 --> 00:27:37,840
um which is you know which is the way of

820
00:27:37,840 --> 00:27:39,760
the future it's something i advocate for

821
00:27:39,760 --> 00:27:42,799
of course uh the amount of exposed files

822
00:27:42,799 --> 00:27:45,120
has increased uh dramatically over the

823
00:27:45,120 --> 00:27:47,919
last like two to four years um there's

824
00:27:47,919 --> 00:27:49,440
several reasons for that that i link

825
00:27:49,440 --> 00:27:51,360
here most of the the vendors who are

826
00:27:51,360 --> 00:27:54,000
doing your like uh the scraping that you

827
00:27:54,000 --> 00:27:55,679
would hope would be uh pulling these are

828
00:27:55,679 --> 00:27:58,799
not um so the the changes in the public

829
00:27:58,799 --> 00:28:00,320
landscape this is that's the reason why

830
00:28:00,320 --> 00:28:01,440
these things are still sitting out there

831
00:28:01,440 --> 00:28:04,159
in such huge numbers um

832
00:28:04,159 --> 00:28:06,480
and this is uh this is the final note

833
00:28:06,480 --> 00:28:09,600
i'll end on but this is 2007 beloved

834
00:28:09,600 --> 00:28:12,000
child's character bob the builder um

835
00:28:12,000 --> 00:28:14,000
seeing a document so this is a document

836
00:28:14,000 --> 00:28:15,279
profile these are all files i pulled

837
00:28:15,279 --> 00:28:18,480
from a domain um a couple days ago

838
00:28:18,480 --> 00:28:20,000
up at the top are

839
00:28:20,000 --> 00:28:21,440
files linked directly to the corporate

840
00:28:21,440 --> 00:28:23,039
domain right these are files that were

841
00:28:23,039 --> 00:28:25,120
intentionally released by the company

842
00:28:25,120 --> 00:28:27,679
totally manageable job uh for bob the

843
00:28:27,679 --> 00:28:28,960
builder we can handle this this is like

844
00:28:28,960 --> 00:28:32,480
six files um now everything else you see

845
00:28:32,480 --> 00:28:35,200
uh below that are this is 2022 bob the

846
00:28:35,200 --> 00:28:36,799
builder it's no longer 2007 we're using

847
00:28:36,799 --> 00:28:39,520
collaboration software um those are all

848
00:28:39,520 --> 00:28:42,720
files hosted by third-party services

849
00:28:42,720 --> 00:28:45,840
now exposed and associated with this

850
00:28:45,840 --> 00:28:48,080
same corporate domain

851
00:28:48,080 --> 00:28:50,080
um so obviously now we are swimming in a

852
00:28:50,080 --> 00:28:53,760
river of uh bob the builder's tears

853
00:28:53,760 --> 00:28:56,320
um and that that is the uh that is the

854
00:28:56,320 --> 00:28:58,240
ostensible end of this presentation but

855
00:28:58,240 --> 00:29:00,320
i hate to end on such a somber note uh

856
00:29:00,320 --> 00:29:01,919
and i'd like to enforce that this is a

857
00:29:01,919 --> 00:29:04,960
solvable problem right like link sharing

858
00:29:04,960 --> 00:29:07,039
uh finding these files it is solvable it

859
00:29:07,039 --> 00:29:08,559
is a little bit

860
00:29:08,559 --> 00:29:10,640
chaotic right now and a bit endemic in

861
00:29:10,640 --> 00:29:12,480
the uh

862
00:29:12,480 --> 00:29:15,039
sheer number of uh sheer volume of

863
00:29:15,039 --> 00:29:16,880
exposed files but it is most definitely

864
00:29:16,880 --> 00:29:18,960
a solvable problem uh so that's it

865
00:29:18,960 --> 00:29:20,640
that's my presentation i appreciate you

866
00:29:20,640 --> 00:29:22,399
guys coming and i think we have a little

867
00:29:22,399 --> 00:29:25,959
bit of time for questions

868
00:29:27,039 --> 00:29:30,840
i've been doing this

869
00:29:40,000 --> 00:29:43,000
mm-hmm

870
00:29:45,200 --> 00:29:48,200
uh

871
00:30:05,679 --> 00:30:06,840
you open that

872
00:30:06,840 --> 00:30:11,080
up um

873
00:30:23,200 --> 00:30:26,080
well that's unfortunate but

874
00:30:26,080 --> 00:30:28,559
a great example of uh

875
00:30:28,559 --> 00:30:30,720
the actual consequences of metadata

876
00:30:30,720 --> 00:30:33,360
leakage and yeah file history is stored

877
00:30:33,360 --> 00:30:35,760
in a lot of file types the user names of

878
00:30:35,760 --> 00:30:37,760
the people involved the time stamps all

879
00:30:37,760 --> 00:30:38,960
that stuff

880
00:30:38,960 --> 00:30:42,640
so very cool and sorry that happened

881
00:30:42,640 --> 00:30:46,000
any other questions in the back

882
00:30:47,200 --> 00:30:48,880
uh sure yeah i can share the slides

883
00:30:48,880 --> 00:30:50,559
somehow

884
00:30:50,559 --> 00:30:53,039
you got it

885
00:30:54,559 --> 00:30:56,799
yes

886
00:30:57,360 --> 00:30:59,279
do you think organizations are even

887
00:30:59,279 --> 00:31:00,320
aware of this

888
00:31:00,320 --> 00:31:01,120
um

889
00:31:01,120 --> 00:31:02,159
in my

890
00:31:02,159 --> 00:31:04,720
in my like notifications uh you know

891
00:31:04,720 --> 00:31:07,919
almost never i think only sort of now

892
00:31:07,919 --> 00:31:09,519
are companies starting to kind of be

893
00:31:09,519 --> 00:31:11,919
like hey what's on the outside like what

894
00:31:11,919 --> 00:31:14,320
can but and kind of rightfully so like

895
00:31:14,320 --> 00:31:16,240
the the priorities have been you know

896
00:31:16,240 --> 00:31:18,000
let's roll out edr let's make sure all

897
00:31:18,000 --> 00:31:19,919
of our uh internal detections are

898
00:31:19,919 --> 00:31:21,840
looking good only now are people sort of

899
00:31:21,840 --> 00:31:24,720
having the time and the space to be like

900
00:31:24,720 --> 00:31:26,240
okay well wait if we're looking

901
00:31:26,240 --> 00:31:28,159
specifically just from what the average

902
00:31:28,159 --> 00:31:29,679
adversary is looking from like

903
00:31:29,679 --> 00:31:30,799
credentialed from the outs

904
00:31:30,799 --> 00:31:32,480
uncredentialed from the outside what can

905
00:31:32,480 --> 00:31:35,919
they see so in most cases uh not aware

906
00:31:35,919 --> 00:31:36,960
at all like if i'm showing them

907
00:31:36,960 --> 00:31:37,919
something that i found here it's the

908
00:31:37,919 --> 00:31:40,000
first time they've seen it um but i do

909
00:31:40,000 --> 00:31:41,440
think that's changing

910
00:31:41,440 --> 00:31:43,200
um i'm hopeful that that's changing at

911
00:31:43,200 --> 00:31:44,159
least

912
00:31:44,159 --> 00:31:47,200
there was another question

913
00:31:47,200 --> 00:31:49,519
yes

914
00:31:56,320 --> 00:31:57,840
yeah that's a great uh that's a great

915
00:31:57,840 --> 00:32:00,559
idea i haven't i'm usually looking for

916
00:32:00,559 --> 00:32:03,760
corporate owned files but in the juicy i

917
00:32:03,760 --> 00:32:06,399
mean exploit db has tons of searches for

918
00:32:06,399 --> 00:32:09,360
file types or contents within file types

919
00:32:09,360 --> 00:32:11,919
so you could totally look for with cool

920
00:32:11,919 --> 00:32:15,200
dorks look for malware samples hosted on

921
00:32:15,200 --> 00:32:17,919
domains like look for uh open

922
00:32:17,919 --> 00:32:20,159
directories that are hosting exes or

923
00:32:20,159 --> 00:32:22,000
something facing the internet so that's

924
00:32:22,000 --> 00:32:23,600
a good idea

925
00:32:23,600 --> 00:32:25,440
and i have not done it but totally

926
00:32:25,440 --> 00:32:26,880
something to do

927
00:32:26,880 --> 00:32:28,399
all right i think i have to make room

928
00:32:28,399 --> 00:32:29,760
for the next speaker so thank you all so

929
00:32:29,760 --> 00:32:31,440
much

930
00:32:31,440 --> 00:32:34,679
much obliged

931
00:32:36,380 --> 00:32:39,479
[Applause]

932
00:32:42,080 --> 00:32:44,158
i

