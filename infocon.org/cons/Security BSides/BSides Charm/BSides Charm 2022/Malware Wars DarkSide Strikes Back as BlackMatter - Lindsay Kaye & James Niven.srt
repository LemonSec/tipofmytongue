1
00:00:23,359 --> 00:00:25,680
all right everyone hi thank you so much

2
00:00:25,680 --> 00:00:27,599
for coming to our talk on dark side

3
00:00:27,599 --> 00:00:30,160
striking back as black matter

4
00:00:30,160 --> 00:00:32,399
my name is lindsey k and i'm director of

5
00:00:32,399 --> 00:00:34,239
operational outcomes at recorded future

6
00:00:34,239 --> 00:00:35,520
um

7
00:00:35,520 --> 00:00:37,760
an insect group so i run our technical

8
00:00:37,760 --> 00:00:39,680
arm of our threat intelligence team so

9
00:00:39,680 --> 00:00:41,040
by trade i was a software engineer for

10
00:00:41,040 --> 00:00:42,399
many years before getting into reverse

11
00:00:42,399 --> 00:00:44,800
engineering and malware analysis and hi

12
00:00:44,800 --> 00:00:46,399
i'm james niven i'm a principal threat

13
00:00:46,399 --> 00:00:48,640
researcher also recorded future and

14
00:00:48,640 --> 00:00:50,559
previously to record future i did a lot

15
00:00:50,559 --> 00:00:52,239
of red teaming for offensive security

16
00:00:52,239 --> 00:00:54,000
and crowdstrike and it gave me a unique

17
00:00:54,000 --> 00:00:56,640
perspective into how operator how actors

18
00:00:56,640 --> 00:00:59,039
would actually work day-to-day

19
00:00:59,039 --> 00:01:00,879
awesome so before we get started we're

20
00:01:00,879 --> 00:01:01,840
going to talk about a couple of

21
00:01:01,840 --> 00:01:03,359
high-level terms in case you're not

22
00:01:03,359 --> 00:01:04,799
super familiar with ransomware and

23
00:01:04,799 --> 00:01:07,040
ransomware operations so first

24
00:01:07,040 --> 00:01:09,200
ransomware is a service so at a very

25
00:01:09,200 --> 00:01:10,960
high level this is a program who's run

26
00:01:10,960 --> 00:01:12,560
by a group of people called

27
00:01:12,560 --> 00:01:14,640
administrators so they're responsible

28
00:01:14,640 --> 00:01:16,000
for creating the malware managing the

29
00:01:16,000 --> 00:01:17,360
infrastructure

30
00:01:17,360 --> 00:01:19,280
and other aspects of the actual program

31
00:01:19,280 --> 00:01:21,759
itself and people called affiliates or

32
00:01:21,759 --> 00:01:23,759
advertisers will obtain membership in

33
00:01:23,759 --> 00:01:25,680
the program in order to get access to it

34
00:01:25,680 --> 00:01:26,960
so they'll do so in a couple different

35
00:01:26,960 --> 00:01:29,520
ways so either by vouches or by paying

36
00:01:29,520 --> 00:01:32,000
for access and part of the benefit for

37
00:01:32,000 --> 00:01:35,040
an aspiring affiliate of joining a ras

38
00:01:35,040 --> 00:01:36,560
is actually being able to kind of have

39
00:01:36,560 --> 00:01:38,240
that name recognition so you can imagine

40
00:01:38,240 --> 00:01:40,079
if you want to lock someone's net and

41
00:01:40,079 --> 00:01:41,759
you want them to pay

42
00:01:41,759 --> 00:01:43,280
having that name recognition that

43
00:01:43,280 --> 00:01:45,280
ensures that if they pay you they'll get

44
00:01:45,280 --> 00:01:47,759
the decryption key is good but also the

45
00:01:47,759 --> 00:01:50,320
rasp will take over some of the you know

46
00:01:50,320 --> 00:01:51,600
other aspects of it because you get

47
00:01:51,600 --> 00:01:53,439
access to a developer who can add new

48
00:01:53,439 --> 00:01:55,600
features do bug fixes other things like

49
00:01:55,600 --> 00:01:56,640
that

50
00:01:56,640 --> 00:01:57,920
some of the victim payment

51
00:01:57,920 --> 00:01:59,040
infrastructure different things like

52
00:01:59,040 --> 00:02:00,240
that so you don't have to do it on your

53
00:02:00,240 --> 00:02:01,119
own

54
00:02:01,119 --> 00:02:04,159
so next tools and ttps so very basically

55
00:02:04,159 --> 00:02:06,000
things that actors use at a technical

56
00:02:06,000 --> 00:02:07,920
level so you may hear things like

57
00:02:07,920 --> 00:02:09,758
malware malicious tools and then how

58
00:02:09,758 --> 00:02:11,520
they actually use them

59
00:02:11,520 --> 00:02:14,879
so big game hunting so around 2019

60
00:02:14,879 --> 00:02:16,560
instead of targeting individuals

61
00:02:16,560 --> 00:02:18,239
ransomware threat actors began actually

62
00:02:18,239 --> 00:02:20,400
targeting organizations largely because

63
00:02:20,400 --> 00:02:21,840
they have more of an ability and

64
00:02:21,840 --> 00:02:24,080
willingness to pay the ransom than those

65
00:02:24,080 --> 00:02:25,920
individuals and then finally the

66
00:02:25,920 --> 00:02:28,879
underground ecosystem so this is where

67
00:02:28,879 --> 00:02:31,200
one would buy and sell malware malicious

68
00:02:31,200 --> 00:02:33,120
tools and different kinds of access to

69
00:02:33,120 --> 00:02:34,400
organizations so we'll get into some of

70
00:02:34,400 --> 00:02:36,000
that later but that could include stolen

71
00:02:36,000 --> 00:02:39,040
credentials vpn rdp etc and then finally

72
00:02:39,040 --> 00:02:40,800
how threat actors can communicate with

73
00:02:40,800 --> 00:02:42,640
others

74
00:02:42,640 --> 00:02:44,959
so ransomware is a business and we're

75
00:02:44,959 --> 00:02:46,239
going to talk about a couple different

76
00:02:46,239 --> 00:02:49,040
aspects of what this business entails so

77
00:02:49,040 --> 00:02:51,519
first gaining access so how does a

78
00:02:51,519 --> 00:02:53,440
threat actor first gain access to a

79
00:02:53,440 --> 00:02:56,080
target system or organization

80
00:02:56,080 --> 00:02:58,640
next acquiring data so how do they apply

81
00:02:58,640 --> 00:03:00,159
the data what does it include and then

82
00:03:00,159 --> 00:03:01,680
what can they do with it

83
00:03:01,680 --> 00:03:04,239
next buying and selling of tools and

84
00:03:04,239 --> 00:03:06,640
data so largely dark web marketplaces

85
00:03:06,640 --> 00:03:08,560
and shops and then finally things that

86
00:03:08,560 --> 00:03:11,120
they can acquire to enable operation and

87
00:03:11,120 --> 00:03:13,280
infrastructure aspects of the ransomware

88
00:03:13,280 --> 00:03:14,400
program

89
00:03:14,400 --> 00:03:16,959
i hand it over to james excellence so

90
00:03:16,959 --> 00:03:18,959
speaking of underground ecosystem and

91
00:03:18,959 --> 00:03:20,640
the way that they have ability to buy

92
00:03:20,640 --> 00:03:22,319
and sell things they've commoditized

93
00:03:22,319 --> 00:03:23,920
almost everything it can range from

94
00:03:23,920 --> 00:03:25,920
something small like netflix accounts

95
00:03:25,920 --> 00:03:28,560
credentials there or it can arrange up

96
00:03:28,560 --> 00:03:31,760
to uh initial access so pulse fortinet

97
00:03:31,760 --> 00:03:33,360
vpns

98
00:03:33,360 --> 00:03:36,480
logins for rdp sitting on the net

99
00:03:36,480 --> 00:03:38,000
and these are done by initial access

100
00:03:38,000 --> 00:03:41,280
brokers so as she spoke to earlier

101
00:03:41,280 --> 00:03:43,680
ransomware can also be commoditized

102
00:03:43,680 --> 00:03:45,360
where you pay a certain amount of money

103
00:03:45,360 --> 00:03:47,040
to get into the program

104
00:03:47,040 --> 00:03:49,040
0.1 bitcoin or something for instance

105
00:03:49,040 --> 00:03:52,400
for non-rat non-russian speakers um

106
00:03:52,400 --> 00:03:55,120
malware checkers steelers exploits brute

107
00:03:55,120 --> 00:03:57,439
forces for credentials all this is sold

108
00:03:57,439 --> 00:04:00,480
and hashed out in different programs

109
00:04:00,480 --> 00:04:03,519
so it can also range to c2 frameworks so

110
00:04:03,519 --> 00:04:05,439
cobalt strike for instance it's not

111
00:04:05,439 --> 00:04:07,120
necessarily paid for i mean it's not

112
00:04:07,120 --> 00:04:09,840
necessarily open source but you have

113
00:04:09,840 --> 00:04:11,519
cracked versions of it lying around and

114
00:04:11,519 --> 00:04:13,439
you have cna scripts or aggressor

115
00:04:13,439 --> 00:04:15,040
scripts which can make a lot of this

116
00:04:15,040 --> 00:04:16,798
stuff just one click you right click and

117
00:04:16,798 --> 00:04:20,399
you can cover roast an entire network

118
00:04:20,880 --> 00:04:23,040
so on the business of that this is

119
00:04:23,040 --> 00:04:25,280
actually exploit this screenshot is

120
00:04:25,280 --> 00:04:27,199
black matter when they first arrived and

121
00:04:27,199 --> 00:04:28,960
this is the the country codes that

122
00:04:28,960 --> 00:04:30,560
they're looking for and the reason they

123
00:04:30,560 --> 00:04:31,919
choose these country codes is because

124
00:04:31,919 --> 00:04:32,960
those are the people that are most

125
00:04:32,960 --> 00:04:35,280
likely to pay we have cyber security and

126
00:04:35,280 --> 00:04:37,759
whatnot more mature companies will pay

127
00:04:37,759 --> 00:04:39,600
for that and they say that they don't

128
00:04:39,600 --> 00:04:41,759
want any access for medical or state

129
00:04:41,759 --> 00:04:43,440
institutions

130
00:04:43,440 --> 00:04:44,800
they want

131
00:04:44,800 --> 00:04:47,360
companies or networks that have

132
00:04:47,360 --> 00:04:48,880
over 100 million dollars worth of

133
00:04:48,880 --> 00:04:50,560
revenue and

134
00:04:50,560 --> 00:04:52,080
more or less they're looking for access

135
00:04:52,080 --> 00:04:53,680
here so

136
00:04:53,680 --> 00:04:55,840
there's two primary forums for

137
00:04:55,840 --> 00:04:58,000
russian-based ransomware it's exploiting

138
00:04:58,000 --> 00:04:59,120
xss

139
00:04:59,120 --> 00:05:01,360
and the way that it will typically work

140
00:05:01,360 --> 00:05:03,440
is if you see this post and you want

141
00:05:03,440 --> 00:05:05,120
information on it doesn't make a lot of

142
00:05:05,120 --> 00:05:06,560
sense to respond to it right there

143
00:05:06,560 --> 00:05:08,880
because then law enforcement or another

144
00:05:08,880 --> 00:05:10,400
researcher just watching it is going to

145
00:05:10,400 --> 00:05:12,240
get privy to that and start hunting you

146
00:05:12,240 --> 00:05:14,080
so what you do is you send a private

147
00:05:14,080 --> 00:05:16,240
message to this but knowing that forms

148
00:05:16,240 --> 00:05:18,639
can be compromised you want to leave as

149
00:05:18,639 --> 00:05:20,080
much information out of that private

150
00:05:20,080 --> 00:05:22,000
message so you would create a one-time

151
00:05:22,000 --> 00:05:24,400
note like a priv note that would say i'm

152
00:05:24,400 --> 00:05:26,880
interested in this here's my talks or

153
00:05:26,880 --> 00:05:29,280
telegram account or jabber and then take

154
00:05:29,280 --> 00:05:31,360
all communication off that platform so

155
00:05:31,360 --> 00:05:33,600
even administrator or compromised the

156
00:05:33,600 --> 00:05:34,720
forums

157
00:05:34,720 --> 00:05:37,759
they would have no trace of it

158
00:05:37,759 --> 00:05:40,160
ex and once the colonial attack pipeline

159
00:05:40,160 --> 00:05:42,080
attack happened everybody was really

160
00:05:42,080 --> 00:05:43,360
bearing down on those forums and just

161
00:05:43,360 --> 00:05:46,479
watching every single word

162
00:05:46,720 --> 00:05:49,039
so how do they hide uh ransomware actors

163
00:05:49,039 --> 00:05:50,960
are much like normal everyday red

164
00:05:50,960 --> 00:05:52,880
teamers they'll use things that are

165
00:05:52,880 --> 00:05:55,680
built into windows lol bins for instance

166
00:05:55,680 --> 00:05:58,720
mshta and ms build if you send an hda

167
00:05:58,720 --> 00:06:01,919
file it's essentially an html file and

168
00:06:01,919 --> 00:06:03,440
tell it to build

169
00:06:03,440 --> 00:06:06,080
code on the machine using.net framework

170
00:06:06,080 --> 00:06:08,639
ms build or csc you essentially build

171
00:06:08,639 --> 00:06:10,400
the payload on the victim machine and

172
00:06:10,400 --> 00:06:14,080
bypasses a lot of initial detections

173
00:06:14,080 --> 00:06:16,000
they will also use windows management

174
00:06:16,000 --> 00:06:18,240
tools so active directory

175
00:06:18,240 --> 00:06:20,160
they can do a lot of damage by having

176
00:06:20,160 --> 00:06:22,319
access to active directory uh tell all

177
00:06:22,319 --> 00:06:23,759
the machines to start updating and

178
00:06:23,759 --> 00:06:26,160
looking for a specific file for instance

179
00:06:26,160 --> 00:06:28,960
the locker and sis login or netlogin

180
00:06:28,960 --> 00:06:30,479
directory on the domain controller

181
00:06:30,479 --> 00:06:31,919
everything can read it and it'll fire

182
00:06:31,919 --> 00:06:33,680
away at once

183
00:06:33,680 --> 00:06:35,280
common applications that are on a lot of

184
00:06:35,280 --> 00:06:37,600
networks slack and octa slack's a really

185
00:06:37,600 --> 00:06:40,479
good example give us two so if you have

186
00:06:40,479 --> 00:06:43,280
a password for a guest wi-fi it may be

187
00:06:43,280 --> 00:06:45,199
applicable to other things in the

188
00:06:45,199 --> 00:06:47,600
network that you could scan for

189
00:06:47,600 --> 00:06:49,919
and red team tools so sharp hound rubios

190
00:06:49,919 --> 00:06:51,280
cobalt strike

191
00:06:51,280 --> 00:06:52,639
those are all

192
00:06:52,639 --> 00:06:54,000
not all of them are open source but

193
00:06:54,000 --> 00:06:55,280
they're on github and they're very

194
00:06:55,280 --> 00:06:57,360
heavily documented and the actors will

195
00:06:57,360 --> 00:06:59,440
use them and not have any real issues

196
00:06:59,440 --> 00:07:02,960
with it and they can also customize it

197
00:07:02,960 --> 00:07:04,960
so as we were speaking they innovate

198
00:07:04,960 --> 00:07:05,759
they

199
00:07:05,759 --> 00:07:07,520
this is an example of the real panel

200
00:07:07,520 --> 00:07:09,520
before they were shut down so this shows

201
00:07:09,520 --> 00:07:10,479
that

202
00:07:10,479 --> 00:07:13,039
revix at the bottom as their linux

203
00:07:13,039 --> 00:07:15,039
locker it shows all the changes with it

204
00:07:15,039 --> 00:07:16,479
and different architectures it applies

205
00:07:16,479 --> 00:07:19,759
to reveal 2.7 was not their last but it

206
00:07:19,759 --> 00:07:21,680
was the one right before their last

207
00:07:21,680 --> 00:07:23,280
update and it shows all the changes that

208
00:07:23,280 --> 00:07:25,520
happened to that in the entire time we

209
00:07:25,520 --> 00:07:27,039
tracked revolt they had about 15

210
00:07:27,039 --> 00:07:30,240
versions of windows ransomware

211
00:07:30,240 --> 00:07:33,360
cool so why does this actually matter so

212
00:07:33,360 --> 00:07:35,440
revo was not kind of an anomaly right

213
00:07:35,440 --> 00:07:36,800
threat actors especially ransomware

214
00:07:36,800 --> 00:07:38,160
threat actors will keep innovating

215
00:07:38,160 --> 00:07:40,000
largely because they have to

216
00:07:40,000 --> 00:07:42,000
so first they are following security

217
00:07:42,000 --> 00:07:44,319
trends so you might hear new

218
00:07:44,319 --> 00:07:46,639
vulnerabilities that are discovered

219
00:07:46,639 --> 00:07:48,319
if you ever read any sort of like it's

220
00:07:48,319 --> 00:07:50,879
in response reports to look at how other

221
00:07:50,879 --> 00:07:52,720
threat actors were caught what defenders

222
00:07:52,720 --> 00:07:55,199
are looking for any sort of new research

223
00:07:55,199 --> 00:07:57,199
that's coming out so if we have access

224
00:07:57,199 --> 00:07:59,039
to it consider the fact that they also

225
00:07:59,039 --> 00:08:01,199
do and they are learning from it so

226
00:08:01,199 --> 00:08:02,960
they'll read news articles research

227
00:08:02,960 --> 00:08:05,039
things that we publish ourselves so they

228
00:08:05,039 --> 00:08:06,800
are getting insights there and following

229
00:08:06,800 --> 00:08:08,479
those trends and often incorporating

230
00:08:08,479 --> 00:08:10,960
that into their own ransomware so like i

231
00:08:10,960 --> 00:08:12,479
said that they have access to a

232
00:08:12,479 --> 00:08:14,240
developer is part of the ransomware as a

233
00:08:14,240 --> 00:08:16,240
service program so this means new

234
00:08:16,240 --> 00:08:17,759
features that affiliates are requesting

235
00:08:17,759 --> 00:08:19,360
or you know might be effective in

236
00:08:19,360 --> 00:08:20,960
helping get the companies to pay the

237
00:08:20,960 --> 00:08:22,560
ransom um different sort of

238
00:08:22,560 --> 00:08:24,479
optimizations because in a ransomware

239
00:08:24,479 --> 00:08:26,240
tech they want to encrypt as much as

240
00:08:26,240 --> 00:08:28,240
they can as fast as they can things like

241
00:08:28,240 --> 00:08:30,160
antivirus evasion and anti-reverse

242
00:08:30,160 --> 00:08:31,759
engineering techniques so make it harder

243
00:08:31,759 --> 00:08:33,599
for the defenders to catch you and then

244
00:08:33,599 --> 00:08:35,440
take it apart and figure out how to

245
00:08:35,440 --> 00:08:37,360
write effective detections for you and

246
00:08:37,360 --> 00:08:39,599
then bug fixes so

247
00:08:39,599 --> 00:08:41,599
if something is broken the developer

248
00:08:41,599 --> 00:08:43,039
will often fix it

249
00:08:43,039 --> 00:08:44,800
so what this means is that we really

250
00:08:44,800 --> 00:08:46,959
can't just use one approach to finding

251
00:08:46,959 --> 00:08:49,279
them and rooting them out so we often

252
00:08:49,279 --> 00:08:50,560
like to talk about tracking the

253
00:08:50,560 --> 00:08:52,160
different versions of their tools but

254
00:08:52,160 --> 00:08:54,800
this can really change over time so 15

255
00:08:54,800 --> 00:08:56,959
versions of ravels windows ransomware

256
00:08:56,959 --> 00:08:58,800
alone while not everything changed

257
00:08:58,800 --> 00:09:00,320
between versions this is something that

258
00:09:00,320 --> 00:09:01,839
does evolve over time we can't rely

259
00:09:01,839 --> 00:09:03,600
entirely on it

260
00:09:03,600 --> 00:09:05,120
infrastructure is something that is spun

261
00:09:05,120 --> 00:09:06,240
up and down

262
00:09:06,240 --> 00:09:07,600
so you can't really use that as sort of

263
00:09:07,600 --> 00:09:10,080
a long-term tracking thing necessarily

264
00:09:10,080 --> 00:09:11,519
and james talked a little bit about some

265
00:09:11,519 --> 00:09:13,360
of those common ttps and red team tools

266
00:09:13,360 --> 00:09:15,600
that they do use so you can leverage

267
00:09:15,600 --> 00:09:17,440
some of that but that really isn't the

268
00:09:17,440 --> 00:09:19,760
whole story as well

269
00:09:19,760 --> 00:09:21,440
so what we're going to do is we're going

270
00:09:21,440 --> 00:09:23,920
to talk through an irl example of how

271
00:09:23,920 --> 00:09:25,519
this happened

272
00:09:25,519 --> 00:09:28,720
at the mid to late part of last year

273
00:09:28,720 --> 00:09:30,399
so looking specifically at how a

274
00:09:30,399 --> 00:09:32,560
ransomware threat actor rapidly evolved

275
00:09:32,560 --> 00:09:34,080
their software in response to several

276
00:09:34,080 --> 00:09:35,839
external factors like discovery by

277
00:09:35,839 --> 00:09:37,360
security researchers

278
00:09:37,360 --> 00:09:39,200
and some of the demand for new features

279
00:09:39,200 --> 00:09:40,880
in their malware so we're going to use

280
00:09:40,880 --> 00:09:42,640
black matter as an example and we

281
00:09:42,640 --> 00:09:44,240
actually discovered the group in july

282
00:09:44,240 --> 00:09:46,640
2021 and shortly thereafter put out a

283
00:09:46,640 --> 00:09:48,839
technical deep dive on the

284
00:09:48,839 --> 00:09:51,040
malware the way we discovered black

285
00:09:51,040 --> 00:09:53,519
matter was it was right place right time

286
00:09:53,519 --> 00:09:55,920
but with some good knowledge so

287
00:09:55,920 --> 00:09:57,200
we're familiar with the colonial

288
00:09:57,200 --> 00:09:59,120
pipeline attack it caused a lot of

289
00:09:59,120 --> 00:10:00,720
issues at the pump got a lot of law

290
00:10:00,720 --> 00:10:02,560
enforcement

291
00:10:02,560 --> 00:10:04,640
focused right on dark side so darkseid

292
00:10:04,640 --> 00:10:05,920
really went into hiding some of their

293
00:10:05,920 --> 00:10:08,320
people got caught and they backed down

294
00:10:08,320 --> 00:10:10,240
for a bit so with dark side out of the

295
00:10:10,240 --> 00:10:11,680
picture for now

296
00:10:11,680 --> 00:10:14,000
we still have reveal so rival has

297
00:10:14,000 --> 00:10:15,839
windows linux locker like we talked

298
00:10:15,839 --> 00:10:18,800
about in esxi locker so esxi locker is

299
00:10:18,800 --> 00:10:20,079
really really important because you can

300
00:10:20,079 --> 00:10:22,240
have all these magical tools for windows

301
00:10:22,240 --> 00:10:24,399
to protect windows host but if you host

302
00:10:24,399 --> 00:10:26,560
them all on esxi which has none of these

303
00:10:26,560 --> 00:10:28,800
cool tools and you lock the data store

304
00:10:28,800 --> 00:10:31,839
the entire network's locked so esxi is

305
00:10:31,839 --> 00:10:34,800
really really effective and so with all

306
00:10:34,800 --> 00:10:36,560
the pressure on dark side them going

307
00:10:36,560 --> 00:10:37,519
away

308
00:10:37,519 --> 00:10:39,920
re and this was time during the time of

309
00:10:39,920 --> 00:10:42,000
the us and russian talks about

310
00:10:42,000 --> 00:10:44,240
ransomware as a whole so

311
00:10:44,240 --> 00:10:45,200
this

312
00:10:45,200 --> 00:10:47,600
screenshot on the bottom is actually uh

313
00:10:47,600 --> 00:10:48,959
from the rebel panel and it's from the

314
00:10:48,959 --> 00:10:51,440
administrator he says uh well previous

315
00:10:51,440 --> 00:10:53,279
to that he said no attacks on usa for

316
00:10:53,279 --> 00:10:55,200
two weeks until these talks are over

317
00:10:55,200 --> 00:10:58,079
this thing actually is addressing the

318
00:10:58,079 --> 00:11:01,279
jbs foods case so jbs foods the top one

319
00:11:01,279 --> 00:11:04,160
is from jbs foods to the fbi saying we

320
00:11:04,160 --> 00:11:05,920
got attacked by rival

321
00:11:05,920 --> 00:11:08,079
we're shut down we have a lot of issues

322
00:11:08,079 --> 00:11:08,800
so

323
00:11:08,800 --> 00:11:11,279
everyone said jbs foods is usa company

324
00:11:11,279 --> 00:11:12,800
it's not technically and that's what

325
00:11:12,800 --> 00:11:15,360
that post is saying it's jbs sa out of

326
00:11:15,360 --> 00:11:18,480
brazil um jbs foods usa does exist but

327
00:11:18,480 --> 00:11:20,240
it's a subset so they are arguing that

328
00:11:20,240 --> 00:11:23,200
they didn't attack a usa company so

329
00:11:23,200 --> 00:11:26,640
this caused a lot of focus on reveal and

330
00:11:26,640 --> 00:11:29,200
started them to shut down we knew a lot

331
00:11:29,200 --> 00:11:31,680
of information about their actors and

332
00:11:31,680 --> 00:11:34,240
affiliates so using this knowledge

333
00:11:34,240 --> 00:11:36,079
communicating to them on talks and

334
00:11:36,079 --> 00:11:38,240
jabber and other services looking for an

335
00:11:38,240 --> 00:11:40,640
esxi locker is essentially how we landed

336
00:11:40,640 --> 00:11:43,200
on black matter

337
00:11:43,200 --> 00:11:45,920
so this is actually a

338
00:11:45,920 --> 00:11:47,920
black matters panel his first day you

339
00:11:47,920 --> 00:11:50,000
join you get all this information so it

340
00:11:50,000 --> 00:11:51,760
says we take the best features from

341
00:11:51,760 --> 00:11:54,000
rival dark side lock bit we've tested

342
00:11:54,000 --> 00:11:55,680
all our platform and our vulnerabilities

343
00:11:55,680 --> 00:11:57,760
to give you a little context darkside

344
00:11:57,760 --> 00:11:59,519
had the decryption issue in the past

345
00:11:59,519 --> 00:12:01,680
which we'll talk about later

346
00:12:01,680 --> 00:12:04,959
and there's talking about it uses on

347
00:12:04,959 --> 00:12:06,480
all the things it works on all the nas

348
00:12:06,480 --> 00:12:09,120
devices linux esxi all the windows

349
00:12:09,120 --> 00:12:10,959
versions and

350
00:12:10,959 --> 00:12:12,320
go ahead

351
00:12:12,320 --> 00:12:14,560
so here you see on the left is dark side

352
00:12:14,560 --> 00:12:17,120
panel on the right is black matter panel

353
00:12:17,120 --> 00:12:18,720
pretty visually

354
00:12:18,720 --> 00:12:20,240
similar to them

355
00:12:20,240 --> 00:12:21,680
you'll have the way to

356
00:12:21,680 --> 00:12:23,519
do your different builds on the top

357
00:12:23,519 --> 00:12:25,839
right all the company victim information

358
00:12:25,839 --> 00:12:27,600
the bitcoin addresses

359
00:12:27,600 --> 00:12:29,200
you can see it's relatively the same

360
00:12:29,200 --> 00:12:31,519
panel

361
00:12:31,519 --> 00:12:33,279
cool so at the outset there were two

362
00:12:33,279 --> 00:12:34,800
versions that were released initially

363
00:12:34,800 --> 00:12:36,800
one for windows and one for linux and

364
00:12:36,800 --> 00:12:38,880
esxi so

365
00:12:38,880 --> 00:12:40,880
the windows ransomware did have some

366
00:12:40,880 --> 00:12:42,320
fairly extensive anti-reverse

367
00:12:42,320 --> 00:12:43,440
engineering and anti-analysis

368
00:12:43,440 --> 00:12:44,800
capabilities

369
00:12:44,800 --> 00:12:46,399
nothing insurmountable but definitely

370
00:12:46,399 --> 00:12:47,760
harder than average

371
00:12:47,760 --> 00:12:49,839
comparatively the linux and esxi one was

372
00:12:49,839 --> 00:12:51,680
very straightforward so it actually

373
00:12:51,680 --> 00:12:53,040
included function names that they did

374
00:12:53,040 --> 00:12:54,639
not actually scrub from it and the

375
00:12:54,639 --> 00:12:56,399
configuration file which gives you kind

376
00:12:56,399 --> 00:12:58,000
of information about you know what it

377
00:12:58,000 --> 00:12:59,200
should do that

378
00:12:59,200 --> 00:13:00,800
a fed actors configured to do was

379
00:13:00,800 --> 00:13:02,000
de-obfuscated which made it

380
00:13:02,000 --> 00:13:04,240
substantially easier to reverse engineer

381
00:13:04,240 --> 00:13:06,079
so on the bottom right you can see

382
00:13:06,079 --> 00:13:07,760
examples of what those function names do

383
00:13:07,760 --> 00:13:08,720
and in case you're not a reverse

384
00:13:08,720 --> 00:13:10,000
engineer one of the things that's like

385
00:13:10,000 --> 00:13:11,839
really kind of just gold is when thread

386
00:13:11,839 --> 00:13:13,200
actors leave these things in because if

387
00:13:13,200 --> 00:13:14,079
you're trying to figure out what a

388
00:13:14,079 --> 00:13:15,680
function is doing it's really helpful to

389
00:13:15,680 --> 00:13:18,079
have the name with specific things such

390
00:13:18,079 --> 00:13:19,839
as get running vms so that really does

391
00:13:19,839 --> 00:13:22,639
help speed up some of the analysis there

392
00:13:22,639 --> 00:13:24,720
and on the top you can see an example of

393
00:13:24,720 --> 00:13:29,040
the windows ransom note that it dropped

394
00:13:29,040 --> 00:13:30,000
so

395
00:13:30,000 --> 00:13:31,519
generally when we talk about tracking of

396
00:13:31,519 --> 00:13:32,959
threat actors tools there's a couple

397
00:13:32,959 --> 00:13:34,160
different things that we'll start to

398
00:13:34,160 --> 00:13:35,680
look for so really what you want to look

399
00:13:35,680 --> 00:13:37,680
for is something unusual or distinctive

400
00:13:37,680 --> 00:13:40,000
that that specific actor does

401
00:13:40,000 --> 00:13:42,079
so um some places that i generally like

402
00:13:42,079 --> 00:13:44,560
to look so first cryptographic routines

403
00:13:44,560 --> 00:13:45,360
so

404
00:13:45,360 --> 00:13:48,320
these can range in you know interesting

405
00:13:48,320 --> 00:13:49,600
kind of combinations of the

406
00:13:49,600 --> 00:13:50,959
cryptographic routines which we'll get

407
00:13:50,959 --> 00:13:53,279
into soon um or things that they

408
00:13:53,279 --> 00:13:55,199
implement custom so not true crypto but

409
00:13:55,199 --> 00:13:57,839
like string obfuscation uh routines and

410
00:13:57,839 --> 00:13:59,519
something like that um sometimes threat

411
00:13:59,519 --> 00:14:01,279
actors will roll their own and they'll

412
00:14:01,279 --> 00:14:02,959
do it incorrectly and if it's something

413
00:14:02,959 --> 00:14:04,639
they do that is particularly distinctive

414
00:14:04,639 --> 00:14:07,120
you can also use that signature on so

415
00:14:07,120 --> 00:14:08,720
one example of black matter string

416
00:14:08,720 --> 00:14:10,160
decryption routine you can see in the

417
00:14:10,160 --> 00:14:11,920
top image we'll look at the key init

418
00:14:11,920 --> 00:14:13,680
function soon but this was something

419
00:14:13,680 --> 00:14:15,360
where they had

420
00:14:15,360 --> 00:14:16,800
strings were not in plain text they made

421
00:14:16,800 --> 00:14:19,199
it harder to reverse engineer by

422
00:14:19,199 --> 00:14:21,600
doing some light obfuscation to them but

423
00:14:21,600 --> 00:14:23,120
it was one of the elements of the first

424
00:14:23,120 --> 00:14:24,320
signature that we were able to write for

425
00:14:24,320 --> 00:14:27,120
them because it was unique

426
00:14:27,120 --> 00:14:28,800
so other obfuscation techniques that

427
00:14:28,800 --> 00:14:30,720
threat actors might use

428
00:14:30,720 --> 00:14:32,399
can also help you start tracking them

429
00:14:32,399 --> 00:14:34,560
especially again if they are unique

430
00:14:34,560 --> 00:14:36,880
so for example um we can look at some of

431
00:14:36,880 --> 00:14:38,639
the call obfuscation that black matter

432
00:14:38,639 --> 00:14:41,920
used so on the bottom is

433
00:14:41,920 --> 00:14:46,399
a very normal kind of windows api call

434
00:14:46,399 --> 00:14:47,360
really how you would see it when you're

435
00:14:47,360 --> 00:14:49,680
reverse engineering it you can see call

436
00:14:49,680 --> 00:14:51,839
to the specific function black matter

437
00:14:51,839 --> 00:14:53,600
didn't do that so in order to make it

438
00:14:53,600 --> 00:14:55,199
harder to reverse engineer what they had

439
00:14:55,199 --> 00:14:57,120
was they had a magic value

440
00:14:57,120 --> 00:14:59,680
and then they'd xor that value with

441
00:14:59,680 --> 00:15:01,760
another value and then jump to that

442
00:15:01,760 --> 00:15:03,440
address in order to make the call so if

443
00:15:03,440 --> 00:15:05,360
you're doing static reverse engineering

444
00:15:05,360 --> 00:15:06,639
now you have to figure out where it is

445
00:15:06,639 --> 00:15:08,320
jumping to where in memory what's loaded

446
00:15:08,320 --> 00:15:10,399
there which complicates it substantially

447
00:15:10,399 --> 00:15:12,320
however this was another element of the

448
00:15:12,320 --> 00:15:13,760
signature that we were able to create

449
00:15:13,760 --> 00:15:16,320
because this magic value appeared

450
00:15:16,320 --> 00:15:17,600
all throughout the code and it was

451
00:15:17,600 --> 00:15:19,279
something that was just baked in and

452
00:15:19,279 --> 00:15:20,880
pretty distinctive

453
00:15:20,880 --> 00:15:23,440
so again magic numbers very helpful

454
00:15:23,440 --> 00:15:25,120
especially if it's something that you

455
00:15:25,120 --> 00:15:26,639
know they derive on their own and nobody

456
00:15:26,639 --> 00:15:29,040
else is really using um and while black

457
00:15:29,040 --> 00:15:30,560
matter did not do this one of my

458
00:15:30,560 --> 00:15:32,399
personal favorites is misspellings so

459
00:15:32,399 --> 00:15:34,560
sometimes you'll see um you know error

460
00:15:34,560 --> 00:15:36,399
messages or log messages or you know

461
00:15:36,399 --> 00:15:38,560
file names mutex names different strings

462
00:15:38,560 --> 00:15:40,320
that are in the malware that they've

463
00:15:40,320 --> 00:15:41,839
misspelled and if it's particularly

464
00:15:41,839 --> 00:15:43,360
distinctive misspelling and it goes

465
00:15:43,360 --> 00:15:45,040
throughout versions they don't change it

466
00:15:45,040 --> 00:15:48,160
that can also be pretty useful

467
00:15:48,160 --> 00:15:48,959
so

468
00:15:48,959 --> 00:15:52,079
we put out a report in july and after we

469
00:15:52,079 --> 00:15:54,079
released this report new versions of the

470
00:15:54,079 --> 00:15:56,399
windows ransomware started to appear so

471
00:15:56,399 --> 00:15:58,399
some of them were fairly simple changes

472
00:15:58,399 --> 00:16:00,240
such as that magic x or key started

473
00:16:00,240 --> 00:16:01,680
changing

474
00:16:01,680 --> 00:16:03,440
and then others were more complex so the

475
00:16:03,440 --> 00:16:05,199
addition of new features

476
00:16:05,199 --> 00:16:06,000
so

477
00:16:06,000 --> 00:16:07,920
one of the examples of how the string

478
00:16:07,920 --> 00:16:10,000
encryption actually changed so we talked

479
00:16:10,000 --> 00:16:12,079
about that key init function on the top

480
00:16:12,079 --> 00:16:13,759
was the very simplistic one that they

481
00:16:13,759 --> 00:16:15,519
used in their first

482
00:16:15,519 --> 00:16:18,000
version we put out a

483
00:16:18,000 --> 00:16:19,440
little python script to decode the

484
00:16:19,440 --> 00:16:21,440
strings and then several versions later

485
00:16:21,440 --> 00:16:23,279
we actually noticed the encryption key

486
00:16:23,279 --> 00:16:26,000
initialization for the uh string

487
00:16:26,000 --> 00:16:27,920
obfuscation change substantially became

488
00:16:27,920 --> 00:16:29,600
substantially more complex and you can

489
00:16:29,600 --> 00:16:31,759
see that on the bottom

490
00:16:31,759 --> 00:16:33,680
ultimately we never actually saw another

491
00:16:33,680 --> 00:16:36,079
version of the linux and esxi ransomware

492
00:16:36,079 --> 00:16:38,639
not entirely sure why but there you go

493
00:16:38,639 --> 00:16:41,120
and ultimately between july 2021 and

494
00:16:41,120 --> 00:16:43,600
september 2021 we saw them release six

495
00:16:43,600 --> 00:16:45,519
different versions of their ransomware

496
00:16:45,519 --> 00:16:50,320
um version numbers 1.2 to 3.0

497
00:16:50,320 --> 00:16:52,240
so let's talk a little bit about some of

498
00:16:52,240 --> 00:16:54,399
those feature editions so

499
00:16:54,399 --> 00:16:56,000
we'll get into some of these but things

500
00:16:56,000 --> 00:16:57,600
like printing the ransomware note on

501
00:16:57,600 --> 00:16:59,759
local printers to add some excitement i

502
00:16:59,759 --> 00:17:01,440
guess when you encrypt

503
00:17:01,440 --> 00:17:03,040
encrypting additional file types so

504
00:17:03,040 --> 00:17:05,359
adding that support as well

505
00:17:05,359 --> 00:17:07,119
letting the threat actor identify

506
00:17:07,119 --> 00:17:09,359
specific computers not to encrypt so on

507
00:17:09,359 --> 00:17:11,039
the right you can see an example of kind

508
00:17:11,039 --> 00:17:12,319
of the build panel where you can

509
00:17:12,319 --> 00:17:14,559
configure it and say you know what kinds

510
00:17:14,559 --> 00:17:16,880
of folders to white lists

511
00:17:16,880 --> 00:17:18,319
files different things like that so you

512
00:17:18,319 --> 00:17:20,720
could identify which computers to avoid

513
00:17:20,720 --> 00:17:22,240
um the implementation of their

514
00:17:22,240 --> 00:17:24,559
cryptographic algorithm and then looking

515
00:17:24,559 --> 00:17:26,319
for large files and encrypting them

516
00:17:26,319 --> 00:17:28,480
differently so in a ransomware attack

517
00:17:28,480 --> 00:17:29,919
time is of the essence for the thread

518
00:17:29,919 --> 00:17:31,440
actor because they want to encrypt

519
00:17:31,440 --> 00:17:33,679
everything as fast as possible so that

520
00:17:33,679 --> 00:17:35,919
the victim can't you know stop it midway

521
00:17:35,919 --> 00:17:37,520
and they really have kind of maximum

522
00:17:37,520 --> 00:17:40,240
impact so being able to encrypt large

523
00:17:40,240 --> 00:17:42,880
files you'll sometimes see thread actors

524
00:17:42,880 --> 00:17:44,559
encrypt only pieces of them add

525
00:17:44,559 --> 00:17:46,640
increments whatever to just

526
00:17:46,640 --> 00:17:48,400
make them so that they're not usable but

527
00:17:48,400 --> 00:17:50,480
not waste any time in getting as much

528
00:17:50,480 --> 00:17:53,679
damage as quickly as possible

529
00:17:53,679 --> 00:17:56,240
so let's look at a couple of the uh

530
00:17:56,240 --> 00:17:58,400
specific features so between versions

531
00:17:58,400 --> 00:18:01,520
1.6 and 2.0 we saw them

532
00:18:01,520 --> 00:18:03,760
modify some of their printing

533
00:18:03,760 --> 00:18:05,440
print the ransomware

534
00:18:05,440 --> 00:18:08,559
note to printers function

535
00:18:08,559 --> 00:18:13,360
here's an example so on the left

536
00:18:13,360 --> 00:18:15,840
in versions 1.6 to 1.9 we saw them just

537
00:18:15,840 --> 00:18:17,679
say print anything as long as the

538
00:18:17,679 --> 00:18:19,360
printer isn't named pdf because that's a

539
00:18:19,360 --> 00:18:22,000
virtual printer but over time um they

540
00:18:22,000 --> 00:18:23,919
actually evolved this to say ignoring

541
00:18:23,919 --> 00:18:25,919
pdf and then some additional virtual

542
00:18:25,919 --> 00:18:26,880
printers

543
00:18:26,880 --> 00:18:27,760
so

544
00:18:27,760 --> 00:18:29,039
kind of another interesting element of

545
00:18:29,039 --> 00:18:30,799
their obfuscation you can see instead of

546
00:18:30,799 --> 00:18:32,799
looking for the specific names they take

547
00:18:32,799 --> 00:18:34,240
a hash of the name to make it just a

548
00:18:34,240 --> 00:18:35,919
little bit more complicated it's custom

549
00:18:35,919 --> 00:18:38,880
hatching algorithm

550
00:18:39,600 --> 00:18:41,520
we talked a little bit about encrypting

551
00:18:41,520 --> 00:18:43,600
different kinds of files so on the left

552
00:18:43,600 --> 00:18:45,360
you can see they add the ability first

553
00:18:45,360 --> 00:18:48,080
to encrypt microsoft exchange files um

554
00:18:48,080 --> 00:18:49,440
that's kind of how they did it and then

555
00:18:49,440 --> 00:18:51,760
they added the capability to handle the

556
00:18:51,760 --> 00:18:53,280
large ones differently so we talked a

557
00:18:53,280 --> 00:18:54,640
little bit about why there's a point to

558
00:18:54,640 --> 00:18:56,640
that um so what they do is they check

559
00:18:56,640 --> 00:18:58,240
for different extensions and then behave

560
00:18:58,240 --> 00:19:01,360
differently accordingly

561
00:19:01,760 --> 00:19:05,280
so you may remember mzsoft actually came

562
00:19:05,280 --> 00:19:06,960
out with a decrypter for black matter

563
00:19:06,960 --> 00:19:08,960
ransomware that said victims do not have

564
00:19:08,960 --> 00:19:10,480
to purchase the

565
00:19:10,480 --> 00:19:12,880
cryptokey to decrypt and they can still

566
00:19:12,880 --> 00:19:14,160
decrypt their ransomware which suggests

567
00:19:14,160 --> 00:19:15,760
that there is some kind of cryptographic

568
00:19:15,760 --> 00:19:16,640
issue

569
00:19:16,640 --> 00:19:18,880
so the threat actor supposedly fixed the

570
00:19:18,880 --> 00:19:21,600
issue in about late september 2021

571
00:19:21,600 --> 00:19:23,760
um we can't really speak to the specific

572
00:19:23,760 --> 00:19:26,480
cryptographic issue at hand here but um

573
00:19:26,480 --> 00:19:28,240
you can kind of see some evolution in

574
00:19:28,240 --> 00:19:31,120
how at least the key initialization code

575
00:19:31,120 --> 00:19:32,880
um came between the different versions

576
00:19:32,880 --> 00:19:34,640
so there are other kind of changes in

577
00:19:34,640 --> 00:19:36,080
the other crypto code but we won't get

578
00:19:36,080 --> 00:19:37,039
into those

579
00:19:37,039 --> 00:19:40,640
so you can see version 1.2 2.0 and 3.0

580
00:19:40,640 --> 00:19:42,240
kind of stacked right there

581
00:19:42,240 --> 00:19:44,240
won't necessarily get into that but it

582
00:19:44,240 --> 00:19:46,160
is interesting to see sort of like how

583
00:19:46,160 --> 00:19:48,080
they make those little changes

584
00:19:48,080 --> 00:19:51,280
especially if there was a bug

585
00:19:51,440 --> 00:19:52,400
so

586
00:19:52,400 --> 00:19:53,919
we talked a little bit about the overlap

587
00:19:53,919 --> 00:19:56,240
between darkseid and black matter

588
00:19:56,240 --> 00:19:57,440
so

589
00:19:57,440 --> 00:19:59,600
other researchers actually

590
00:19:59,600 --> 00:20:01,840
suggested that looking at how the kind

591
00:20:01,840 --> 00:20:04,480
of cryptographic

592
00:20:04,480 --> 00:20:07,200
key material was generated so using the

593
00:20:07,200 --> 00:20:09,760
custom salsa 20 matrix that had

594
00:20:09,760 --> 00:20:11,679
previously been originally unique to

595
00:20:11,679 --> 00:20:13,440
dark side so we talked about like unique

596
00:20:13,440 --> 00:20:15,679
and interesting crypto was now something

597
00:20:15,679 --> 00:20:17,360
that they were observing a very similar

598
00:20:17,360 --> 00:20:20,159
um cryptographic routine in black matter

599
00:20:20,159 --> 00:20:22,400
so what this looks like between them so

600
00:20:22,400 --> 00:20:24,320
you can see the random buffer

601
00:20:24,320 --> 00:20:26,880
initialization for black matter for dark

602
00:20:26,880 --> 00:20:29,679
side on the top followed by the rsa 1024

603
00:20:29,679 --> 00:20:31,280
encryption and then you can see black

604
00:20:31,280 --> 00:20:34,080
matter's implementation on the bottom so

605
00:20:34,080 --> 00:20:36,080
not entirely

606
00:20:36,080 --> 00:20:38,480
you know exactly the same but you do see

607
00:20:38,480 --> 00:20:40,000
some similarities

608
00:20:40,000 --> 00:20:41,760
so slight difference in how they

609
00:20:41,760 --> 00:20:43,120
actually did the generation of the

610
00:20:43,120 --> 00:20:44,880
random buffer but semantically it's

611
00:20:44,880 --> 00:20:46,720
pretty similar so that's what the

612
00:20:46,720 --> 00:20:48,080
researchers are pointing out we just

613
00:20:48,080 --> 00:20:51,120
want to give an example of that

614
00:20:51,360 --> 00:20:52,320
so i'm going to hand it back over to

615
00:20:52,320 --> 00:20:54,960
james to talk about the end thanks

616
00:20:54,960 --> 00:20:55,679
so

617
00:20:55,679 --> 00:20:57,600
dark side had the colonial plaque plant

618
00:20:57,600 --> 00:20:59,280
attack they messed up on that a little

619
00:20:59,280 --> 00:21:01,520
too high profile for them they also have

620
00:21:01,520 --> 00:21:03,039
the decryption issues which we didn't

621
00:21:03,039 --> 00:21:04,799
talk about specifically but with black

622
00:21:04,799 --> 00:21:07,360
matter we did so they've had

623
00:21:07,360 --> 00:21:09,120
decryption issues for black matter as

624
00:21:09,120 --> 00:21:11,520
well they hit a

625
00:21:11,520 --> 00:21:12,880
agricultural

626
00:21:12,880 --> 00:21:15,440
entity really heavily that caused a lot

627
00:21:15,440 --> 00:21:17,679
of issues and the security researchers

628
00:21:17,679 --> 00:21:19,600
jumped into that chat and just

629
00:21:19,600 --> 00:21:20,960
took over it and they couldn't

630
00:21:20,960 --> 00:21:23,360
differentiate between victim and

631
00:21:23,360 --> 00:21:25,679
researcher and just had had they're

632
00:21:25,679 --> 00:21:27,679
really flustered at the time so they've

633
00:21:27,679 --> 00:21:29,600
made critical mistakes and they just

634
00:21:29,600 --> 00:21:30,799
announced that they're done with it

635
00:21:30,799 --> 00:21:32,400
they're shutting down so this is

636
00:21:32,400 --> 00:21:34,480
actually the panel saying in 48 hours

637
00:21:34,480 --> 00:21:36,320
we're gone we're gonna hand out

638
00:21:36,320 --> 00:21:38,799
decryption keys so it sounds like it's

639
00:21:38,799 --> 00:21:41,840
the end of black matter but it's not

640
00:21:41,840 --> 00:21:42,799
so

641
00:21:42,799 --> 00:21:44,480
this is actually an interview by one of

642
00:21:44,480 --> 00:21:47,280
our colleagues that reaches out to

643
00:21:47,280 --> 00:21:50,480
another ransomware called alpha and it

644
00:21:50,480 --> 00:21:52,320
he they basically admitted to it so if

645
00:21:52,320 --> 00:21:54,480
you read through it it will say that

646
00:21:54,480 --> 00:21:55,440
with the

647
00:21:55,440 --> 00:21:57,760
victim chats having issues and not being

648
00:21:57,760 --> 00:22:00,240
able to tell between victim and

649
00:22:00,240 --> 00:22:01,919
impersonator

650
00:22:01,919 --> 00:22:04,159
and the decryption issues this caused us

651
00:22:04,159 --> 00:22:05,840
to shut down and then we see another

652
00:22:05,840 --> 00:22:08,559
actor lock bit say this is black matter

653
00:22:08,559 --> 00:22:11,039
doing a rebranding so what that what

654
00:22:11,039 --> 00:22:13,280
black matter did was they they were mad

655
00:22:13,280 --> 00:22:15,120
they just fired the entire dev team for

656
00:22:15,120 --> 00:22:18,720
the locker and we'll show

657
00:22:18,720 --> 00:22:20,960
so this right here this is alpha and

658
00:22:20,960 --> 00:22:23,200
this is basically the intro to their

659
00:22:23,200 --> 00:22:24,159
their new

660
00:22:24,159 --> 00:22:26,559
ransomware project and it says we have

661
00:22:26,559 --> 00:22:29,039
esi lockers you get a certain percentage

662
00:22:29,039 --> 00:22:30,080
of cut

663
00:22:30,080 --> 00:22:32,559
they completely redid the locker wrote

664
00:22:32,559 --> 00:22:34,240
it in rust

665
00:22:34,240 --> 00:22:36,000
lots of new fancy features they made it

666
00:22:36,000 --> 00:22:38,400
specific so if you capture a ransom note

667
00:22:38,400 --> 00:22:40,400
on virustotal you can't actually do

668
00:22:40,400 --> 00:22:41,679
anything with it because you have to

669
00:22:41,679 --> 00:22:43,440
have a specific access code to be able

670
00:22:43,440 --> 00:22:46,559
to visit the victim panel they rewrote

671
00:22:46,559 --> 00:22:47,360
the

672
00:22:47,360 --> 00:22:49,440
entire panel itself they added a lot of

673
00:22:49,440 --> 00:22:50,480
features

674
00:22:50,480 --> 00:22:53,440
new support tools new faqs built-in

675
00:22:53,440 --> 00:22:55,280
mixers

676
00:22:55,280 --> 00:22:56,559
they're actually working on another

677
00:22:56,559 --> 00:22:59,039
thing called morph which allows

678
00:22:59,039 --> 00:23:01,679
uh real near real-time de-oper

679
00:23:01,679 --> 00:23:03,919
obfuscation of the locker itself to

680
00:23:03,919 --> 00:23:05,760
bypass some signatures

681
00:23:05,760 --> 00:23:08,799
so they're still around

682
00:23:08,799 --> 00:23:09,679
so

683
00:23:09,679 --> 00:23:12,240
as probably defenders uh we're probably

684
00:23:12,240 --> 00:23:14,400
asking what is it now that we do because

685
00:23:14,400 --> 00:23:15,919
it seems like

686
00:23:15,919 --> 00:23:17,520
they spin up they spin down they rebrand

687
00:23:17,520 --> 00:23:18,960
they join new programs so what is it

688
00:23:18,960 --> 00:23:20,880
that we can do so one of the things i

689
00:23:20,880 --> 00:23:22,720
want to underscore is that in order to

690
00:23:22,720 --> 00:23:24,400
successfully find malicious thought

691
00:23:24,400 --> 00:23:27,200
actors um after they kind of disappear

692
00:23:27,200 --> 00:23:29,120
um it really does require a very

693
00:23:29,120 --> 00:23:31,280
multifaceted approach so not only the

694
00:23:31,280 --> 00:23:32,640
technical

695
00:23:32,640 --> 00:23:34,320
skills and signatures and things like

696
00:23:34,320 --> 00:23:36,159
that but also subject matter experts who

697
00:23:36,159 --> 00:23:37,760
know kind of how to find them and what

698
00:23:37,760 --> 00:23:39,360
to start looking for

699
00:23:39,360 --> 00:23:41,600
um also detections like you know i have

700
00:23:41,600 --> 00:23:43,840
to mention that so looking for things

701
00:23:43,840 --> 00:23:46,320
like those commonly used tools and ttps

702
00:23:46,320 --> 00:23:48,080
so things like cobalt strike will remain

703
00:23:48,080 --> 00:23:50,240
eternally popular with abts and

704
00:23:50,240 --> 00:23:52,240
ransomware threat actors and

705
00:23:52,240 --> 00:23:54,080
it's very easy to get so while that

706
00:23:54,080 --> 00:23:56,240
won't completely solve the problem being

707
00:23:56,240 --> 00:23:57,840
able to detect these sort of malicious

708
00:23:57,840 --> 00:24:00,159
tools and their use does get you you

709
00:24:00,159 --> 00:24:01,520
know some of the way

710
00:24:01,520 --> 00:24:04,320
um looking for also the latest threats

711
00:24:04,320 --> 00:24:06,400
so things like pre-ransomware tools or

712
00:24:06,400 --> 00:24:08,799
new open source technology and tools is

713
00:24:08,799 --> 00:24:11,440
really important um like i said they

714
00:24:11,440 --> 00:24:13,200
they can read the same things that we

715
00:24:13,200 --> 00:24:15,039
see like they look at github if they

716
00:24:15,039 --> 00:24:16,480
find new tools that they like and you

717
00:24:16,480 --> 00:24:18,080
know help them accomplish their goals

718
00:24:18,080 --> 00:24:19,440
they're probably going to use them so

719
00:24:19,440 --> 00:24:21,039
keeping abreast of like what is going on

720
00:24:21,039 --> 00:24:22,400
now what people are releasing and then

721
00:24:22,400 --> 00:24:23,760
what could be useful

722
00:24:23,760 --> 00:24:25,440
is also important

723
00:24:25,440 --> 00:24:27,200
um you know kind of very well known

724
00:24:27,200 --> 00:24:28,799
detection types so things like yara

725
00:24:28,799 --> 00:24:31,279
sigma and snort uh wherever possible to

726
00:24:31,279 --> 00:24:33,360
be able to track either you know

727
00:24:33,360 --> 00:24:34,880
from a defensive perspective or if you

728
00:24:34,880 --> 00:24:36,559
like to threat hunt or look for malware

729
00:24:36,559 --> 00:24:38,640
to take apart um can help you start

730
00:24:38,640 --> 00:24:40,640
finding these specific or threat actors

731
00:24:40,640 --> 00:24:42,000
specific tools like some of what we

732
00:24:42,000 --> 00:24:43,200
talked about

733
00:24:43,200 --> 00:24:45,360
other ioc fees as well are super useful

734
00:24:45,360 --> 00:24:47,200
so known command and control servers

735
00:24:47,200 --> 00:24:49,120
malicious hashes things like that

736
00:24:49,120 --> 00:24:50,799
um and then we all talk a lot about

737
00:24:50,799 --> 00:24:53,039
logging and turning on logging but

738
00:24:53,039 --> 00:24:54,720
making sure that the logs capture

739
00:24:54,720 --> 00:24:56,559
exactly what you think they should

740
00:24:56,559 --> 00:24:58,240
so that in the event that something does

741
00:24:58,240 --> 00:24:59,840
in fact happen you're able to get the

742
00:24:59,840 --> 00:25:02,080
information that you expect and would

743
00:25:02,080 --> 00:25:03,760
probably need to figure out you know

744
00:25:03,760 --> 00:25:05,200
what happened in case you weren't able

745
00:25:05,200 --> 00:25:06,640
to stop it

746
00:25:06,640 --> 00:25:08,720
um doing things like implementing common

747
00:25:08,720 --> 00:25:10,880
security measures so account pruning

748
00:25:10,880 --> 00:25:13,200
strong passwords etc

749
00:25:13,200 --> 00:25:14,559
active directory james talked a little

750
00:25:14,559 --> 00:25:16,559
bit about you know having access to

751
00:25:16,559 --> 00:25:18,080
active directory is pretty powerful so

752
00:25:18,080 --> 00:25:19,679
making sure you're doing cleanup

753
00:25:19,679 --> 00:25:21,279
disabling legacy objects and then

754
00:25:21,279 --> 00:25:23,279
implementing best practices there

755
00:25:23,279 --> 00:25:24,640
and then finally consider using

756
00:25:24,640 --> 00:25:26,240
multi-factor authentication for things

757
00:25:26,240 --> 00:25:28,480
like remote access services like rdp and

758
00:25:28,480 --> 00:25:30,480
citrix so these are still popular with

759
00:25:30,480 --> 00:25:32,159
ransomware threat actors and they will

760
00:25:32,159 --> 00:25:33,840
take advantage of them

761
00:25:33,840 --> 00:25:35,200
so with that

762
00:25:35,200 --> 00:25:38,919
are there any questions

763
00:25:45,039 --> 00:25:46,640
well it doesn't really come as a whole

764
00:25:46,640 --> 00:25:48,080
package it all depends on what you're

765
00:25:48,080 --> 00:25:50,080
looking for if it's a

766
00:25:50,080 --> 00:25:52,000
so if you're if you have access to a

767
00:25:52,000 --> 00:25:54,000
whole bunch of compromised machines and

768
00:25:54,000 --> 00:25:55,600
you want to buy information stealer it

769
00:25:55,600 --> 00:25:57,520
costs very little because all you're

770
00:25:57,520 --> 00:25:58,960
essentially doing is buying access to

771
00:25:58,960 --> 00:26:00,960
the panel you're generating the builder

772
00:26:00,960 --> 00:26:02,000
and then you're sending it to the

773
00:26:02,000 --> 00:26:04,400
networks you already own um so it could

774
00:26:04,400 --> 00:26:06,080
be a few hundred bucks a month maybe

775
00:26:06,080 --> 00:26:08,159
less it all depends on usage and how

776
00:26:08,159 --> 00:26:10,880
much you want to get access to so what's

777
00:26:10,880 --> 00:26:12,559
the actual like

778
00:26:12,559 --> 00:26:15,039
themselves

779
00:26:15,039 --> 00:26:16,320
so they're free

780
00:26:16,320 --> 00:26:19,440
all these are free yeah

781
00:26:19,440 --> 00:26:21,600
yeah so what they do is basically if you

782
00:26:21,600 --> 00:26:23,919
join as an affiliate they have a core

783
00:26:23,919 --> 00:26:25,919
set of administrators the people inside

784
00:26:25,919 --> 00:26:27,360
these groups don't know who each other

785
00:26:27,360 --> 00:26:28,960
are there are certain subsets so the

786
00:26:28,960 --> 00:26:30,640
administrators know themselves most of

787
00:26:30,640 --> 00:26:33,120
them personally this small subset so

788
00:26:33,120 --> 00:26:35,200
let's say for instance you joined and

789
00:26:35,200 --> 00:26:37,919
you were the one to own the keys if you

790
00:26:37,919 --> 00:26:40,320
have that guy that guy and that guy that

791
00:26:40,320 --> 00:26:41,600
don't know each other in real life but

792
00:26:41,600 --> 00:26:43,440
you know enough to work and get a

793
00:26:43,440 --> 00:26:44,640
network

794
00:26:44,640 --> 00:26:45,919
they're not going to know any of that

795
00:26:45,919 --> 00:26:47,760
and other teams will know that as well

796
00:26:47,760 --> 00:26:50,480
it's only just who you have so

797
00:26:50,480 --> 00:26:52,720
the more depth you compromise and more

798
00:26:52,720 --> 00:26:54,960
successful payments you have depends on

799
00:26:54,960 --> 00:26:57,919
the cut so initially so for alpha it's

800
00:26:57,919 --> 00:26:59,279
since they just started it was ninety

801
00:26:59,279 --> 00:27:01,279
percent so ninety percent goes to you

802
00:27:01,279 --> 00:27:03,279
your team to be out how you want and

803
00:27:03,279 --> 00:27:04,400
then ten percent goes to the

804
00:27:04,400 --> 00:27:06,559
administrator for building

805
00:27:06,559 --> 00:27:08,880
additional functions paying buy new cars

806
00:27:08,880 --> 00:27:10,400
whatever it is

807
00:27:10,400 --> 00:27:12,400
and you'll see a lot of it go like that

808
00:27:12,400 --> 00:27:14,400
if you don't do well you can either get

809
00:27:14,400 --> 00:27:16,400
kicked out of the group or kick down to

810
00:27:16,400 --> 00:27:18,399
80 75

811
00:27:18,399 --> 00:27:21,360
but they want as many people as she said

812
00:27:21,360 --> 00:27:23,120
they're advertisers that's how they view

813
00:27:23,120 --> 00:27:25,360
themselves by locking a network you're

814
00:27:25,360 --> 00:27:29,799
advertising for them so

815
00:27:38,960 --> 00:27:41,960
um

816
00:28:10,000 --> 00:28:13,000
right

817
00:28:22,640 --> 00:28:24,640
yeah so there actually was uh innocence

818
00:28:24,640 --> 00:28:27,039
agreeable with that and there was so

819
00:28:27,039 --> 00:28:28,720
when you have access these panels

820
00:28:28,720 --> 00:28:30,720
normally if it's a really good victim

821
00:28:30,720 --> 00:28:32,640
and you are if you're an affiliate that

822
00:28:32,640 --> 00:28:34,080
don't doesn't feel

823
00:28:34,080 --> 00:28:35,760
comfortable talking to a victim you can

824
00:28:35,760 --> 00:28:37,600
just say i want administrators to handle

825
00:28:37,600 --> 00:28:39,360
all the communication get the payment

826
00:28:39,360 --> 00:28:41,679
and then send it to me so they and they

827
00:28:41,679 --> 00:28:42,960
can even ask questions so the

828
00:28:42,960 --> 00:28:44,399
administrator if you're an affiliate and

829
00:28:44,399 --> 00:28:46,320
you block this network the administrator

830
00:28:46,320 --> 00:28:47,840
wants to know all these things he wants

831
00:28:47,840 --> 00:28:50,080
to know the zoom info revenue he wants

832
00:28:50,080 --> 00:28:51,039
to know

833
00:28:51,039 --> 00:28:52,559
what they are as long as they're not a

834
00:28:52,559 --> 00:28:54,240
hospital because like after the dark

835
00:28:54,240 --> 00:28:56,480
side incidents they put up different

836
00:28:56,480 --> 00:28:58,080
rule sets like don't block hospitals

837
00:28:58,080 --> 00:29:00,480
don't log oil pipelines so they moderate

838
00:29:00,480 --> 00:29:02,000
it before you can even lock it there's

839
00:29:02,000 --> 00:29:03,919
mistakes always but

840
00:29:03,919 --> 00:29:07,039
they'll also um

841
00:29:07,120 --> 00:29:09,200
i just lost traffic a lot that what was

842
00:29:09,200 --> 00:29:12,919
your question sorry

843
00:29:13,279 --> 00:29:15,360
yes so they have the ability to already

844
00:29:15,360 --> 00:29:17,120
see all those chats right and there are

845
00:29:17,120 --> 00:29:19,600
cases of where they will jump into those

846
00:29:19,600 --> 00:29:21,520
chats and take over uh there's a whole

847
00:29:21,520 --> 00:29:23,200
big i think there's a few threads on it

848
00:29:23,200 --> 00:29:25,200
on exploit about uh

849
00:29:25,200 --> 00:29:27,360
signature that was saying how they stole

850
00:29:27,360 --> 00:29:29,039
all this millions of dollars of money

851
00:29:29,039 --> 00:29:30,799
through that back door using keys that

852
00:29:30,799 --> 00:29:32,640
were built into the

853
00:29:32,640 --> 00:29:35,039
locker itself so they do there's no

854
00:29:35,039 --> 00:29:36,240
honor model they use and they do

855
00:29:36,240 --> 00:29:37,120
actually

856
00:29:37,120 --> 00:29:40,760
hijack each other

857
00:29:51,520 --> 00:29:53,520
these guys are still doing it years

858
00:29:53,520 --> 00:29:56,960
later like at first the rants start

859
00:29:56,960 --> 00:29:59,279
they're just new but they'll learn but

860
00:29:59,279 --> 00:30:01,200
they're still doing it so is it is this

861
00:30:01,200 --> 00:30:02,480
to avoid detection or is there some

862
00:30:02,480 --> 00:30:03,760
other research

863
00:30:03,760 --> 00:30:05,760
i mean it's honestly hard to say why

864
00:30:05,760 --> 00:30:09,360
right so having the something that you

865
00:30:09,360 --> 00:30:11,360
know will avoid detection right that's

866
00:30:11,360 --> 00:30:13,039
great or maybe like oh hey it's this

867
00:30:13,039 --> 00:30:15,039
cool new thing so it really is hard to

868
00:30:15,039 --> 00:30:16,640
say why they do it obviously like they

869
00:30:16,640 --> 00:30:18,559
shouldn't right because mistakes do

870
00:30:18,559 --> 00:30:20,080
happen and then it's like

871
00:30:20,080 --> 00:30:22,159
you know bad for business if you're not

872
00:30:22,159 --> 00:30:24,399
actually having to like sell the key to

873
00:30:24,399 --> 00:30:26,720
kind of get it deprived so

874
00:30:26,720 --> 00:30:28,640
in terms of like the actual kind of

875
00:30:28,640 --> 00:30:29,600
locker

876
00:30:29,600 --> 00:30:32,159
would not roll their own in terms of why

877
00:30:32,159 --> 00:30:33,679
they do custom crypto through a lot of

878
00:30:33,679 --> 00:30:35,679
the string type stuff so

879
00:30:35,679 --> 00:30:38,000
their job is to slow people like me down

880
00:30:38,000 --> 00:30:39,440
like make it harder for me to figure out

881
00:30:39,440 --> 00:30:41,039
what the hell is going on with their

882
00:30:41,039 --> 00:30:42,960
ransomware or understand what's going on

883
00:30:42,960 --> 00:30:45,200
or write those detections so having

884
00:30:45,200 --> 00:30:47,840
those unique string kind of obfuscation

885
00:30:47,840 --> 00:30:49,840
crypto algorithms having any sort of

886
00:30:49,840 --> 00:30:52,480
unique obfuscation yeah it takes longer

887
00:30:52,480 --> 00:30:54,960
to do

888
00:31:00,559 --> 00:31:02,799
as long as they protect the key

889
00:31:02,799 --> 00:31:05,840
yeah i mean

890
00:31:05,919 --> 00:31:07,200
in terms of

891
00:31:07,200 --> 00:31:08,960
the kind of like actual hardcore like

892
00:31:08,960 --> 00:31:10,720
crypto to actually you know encrypt the

893
00:31:10,720 --> 00:31:12,880
files yes absolutely

894
00:31:12,880 --> 00:31:14,320
the string encryption stuff like that's

895
00:31:14,320 --> 00:31:16,000
never really like real encryption that

896
00:31:16,000 --> 00:31:17,279
doesn't actually matter so there are

897
00:31:17,279 --> 00:31:18,559
those kind of like two parts of it but

898
00:31:18,559 --> 00:31:20,320
like yeah they should totally use actual

899
00:31:20,320 --> 00:31:22,799
crypto with the protected key that's

900
00:31:22,799 --> 00:31:25,679
proven but the second question is on the

901
00:31:25,679 --> 00:31:27,440
key generation itself

902
00:31:27,440 --> 00:31:30,440
um

903
00:31:44,880 --> 00:31:47,279
inputs

904
00:31:49,760 --> 00:31:52,480
so i'm not a deep crypto expert um you

905
00:31:52,480 --> 00:31:56,600
might have to ask one of them

906
00:32:00,000 --> 00:32:01,360
so i would say logging would be more

907
00:32:01,360 --> 00:32:03,440
useful for um you know figuring out what

908
00:32:03,440 --> 00:32:04,799
they had access to what they could have

909
00:32:04,799 --> 00:32:07,360
accessed um you know exfiltrated did

910
00:32:07,360 --> 00:32:08,720
they have any network connectivity did

911
00:32:08,720 --> 00:32:10,320
they exfiltrate anything so it's really

912
00:32:10,320 --> 00:32:12,000
more of the like oh something has

913
00:32:12,000 --> 00:32:14,240
happened what did happen you know did

914
00:32:14,240 --> 00:32:15,760
they query any databases things like

915
00:32:15,760 --> 00:32:17,440
that if it makes sense

916
00:32:17,440 --> 00:32:18,720
i can actually add to your first

917
00:32:18,720 --> 00:32:20,240
question a little bit for an example

918
00:32:20,240 --> 00:32:21,840
they do it so we said that they're

919
00:32:21,840 --> 00:32:23,760
advertisers as they like to put it

920
00:32:23,760 --> 00:32:25,279
lockment if you go to their site on

921
00:32:25,279 --> 00:32:26,000
their

922
00:32:26,000 --> 00:32:27,919
public blog they say we're the fastest

923
00:32:27,919 --> 00:32:29,600
locker out there and it's because they

924
00:32:29,600 --> 00:32:32,080
only do a certain amount of uh locking

925
00:32:32,080 --> 00:32:34,000
per file so of course you're the fastest

926
00:32:34,000 --> 00:32:35,840
if you only lock a megabyte worth of

927
00:32:35,840 --> 00:32:37,120
data

928
00:32:37,120 --> 00:32:38,720
and then the second aspect to that is

929
00:32:38,720 --> 00:32:40,640
you have to realize who these people are

930
00:32:40,640 --> 00:32:42,480
a lot of them are extremely arrogant

931
00:32:42,480 --> 00:32:44,320
they drive fast cars have a lot of

932
00:32:44,320 --> 00:32:47,120
retail or real estate they're they think

933
00:32:47,120 --> 00:32:48,880
they are better than you they think that

934
00:32:48,880 --> 00:32:51,120
your best practices are you're sitting

935
00:32:51,120 --> 00:32:53,279
at a nine to five practices but they can

936
00:32:53,279 --> 00:32:55,519
do better than you so they feel

937
00:32:55,519 --> 00:32:57,279
confident in rolling that well they want

938
00:32:57,279 --> 00:32:58,799
fast and sick while they just use

939
00:32:58,799 --> 00:33:01,120
tonight

940
00:33:02,000 --> 00:33:06,039
why do they walk corporations

941
00:33:37,360 --> 00:33:39,120
that if you know the playing text that

942
00:33:39,120 --> 00:33:41,519
crypto file and the number wouldn't know

943
00:33:41,519 --> 00:33:43,760
what it was it is also easier to break

944
00:33:43,760 --> 00:33:46,120
into a bible in your own

945
00:33:46,120 --> 00:33:50,600
party some of the research

946
00:33:54,240 --> 00:33:56,720
anybody else

947
00:33:56,720 --> 00:33:58,480
all right say nothing thank you guys so

948
00:33:58,480 --> 00:34:00,020
much

949
00:34:00,020 --> 00:34:05,500
[Applause]

