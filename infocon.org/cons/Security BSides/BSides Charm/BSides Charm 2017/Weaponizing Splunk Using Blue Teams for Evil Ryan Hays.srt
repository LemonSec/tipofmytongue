1
00:00:05,750 --> 00:00:13,110
<font color="#CCCCCC">all right guys</font><font color="#E5E5E5"> so I'm Ryan you talk</font>

2
00:00:09,660 --> 00:00:17,160
<font color="#E5E5E5">about weaponizing</font><font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> um</font><font color="#CCCCCC"> Wow these</font>

3
00:00:13,110 --> 00:00:18,930
colors are gonna<font color="#CCCCCC"> suck with you</font><font color="#E5E5E5"> sorry um</font>

4
00:00:17,160 --> 00:00:20,789
anyway<font color="#CCCCCC"> so I'm the director</font><font color="#E5E5E5"> security</font>

5
00:00:18,930 --> 00:00:22,198
engineering<font color="#E5E5E5"> with</font><font color="#CCCCCC"> TBG security</font><font color="#E5E5E5"> we're</font>

6
00:00:20,789 --> 00:00:23,430
consulting firm<font color="#CCCCCC"> based</font><font color="#E5E5E5"> out of Boston</font>

7
00:00:22,199 --> 00:00:25,920
doing offensive security

8
00:00:23,430 --> 00:00:28,560
I got a few certs<font color="#E5E5E5"> up there so hopefully</font>

9
00:00:25,920 --> 00:00:29,630
<font color="#E5E5E5">that shows that I know a little bit</font>

10
00:00:28,560 --> 00:00:32,879
<font color="#E5E5E5">about what I'm talking about</font>

11
00:00:29,630 --> 00:00:34,500
<font color="#E5E5E5">so this talk last year</font><font color="#CCCCCC"> my team and I</font>

12
00:00:32,880 --> 00:00:36,210
were on a pen<font color="#E5E5E5"> test</font><font color="#CCCCCC"> we got</font><font color="#E5E5E5"> internal</font>

13
00:00:34,500 --> 00:00:38,460
access<font color="#E5E5E5"> to the network</font><font color="#CCCCCC"> we're doing a</font>

14
00:00:36,210 --> 00:00:40,950
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of recon enumeration we</font>

15
00:00:38,460 --> 00:00:42,149
<font color="#E5E5E5">stumbled across</font><font color="#CCCCCC"> uh Splunk box upon</font>

16
00:00:40,950 --> 00:00:43,800
navigating to the<font color="#E5E5E5"> website it</font>

17
00:00:42,149 --> 00:00:45,300
automatically logged me in with admin

18
00:00:43,800 --> 00:00:50,010
credentials<font color="#E5E5E5"> it was like that's awesome</font>

19
00:00:45,300 --> 00:00:51,390
<font color="#E5E5E5">thanks guys um</font><font color="#CCCCCC"> but how so then we took</font>

20
00:00:50,010 --> 00:00:52,710
<font color="#CCCCCC">that we thought</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> it how</font><font color="#E5E5E5"> can we</font>

21
00:00:51,390 --> 00:00:55,469
actually leverage this into<font color="#E5E5E5"> something</font>

22
00:00:52,710 --> 00:00:57,300
that I can you<font color="#E5E5E5"> know attack this box or</font>

23
00:00:55,469 --> 00:00:58,649
attack<font color="#CCCCCC"> the rest</font><font color="#E5E5E5"> of the network</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we</font>

24
00:00:57,300 --> 00:01:00,599
came up<font color="#CCCCCC"> with a custom application that</font>

25
00:00:58,649 --> 00:01:02,280
we installed gave us a shell<font color="#CCCCCC"> on</font><font color="#E5E5E5"> a box</font>

26
00:01:00,600 --> 00:01:04,920
<font color="#E5E5E5">and then we thought well how can I get</font>

27
00:01:02,280 --> 00:01:06,689
<font color="#CCCCCC">even further well in a few slides here</font>

28
00:01:04,920 --> 00:01:07,950
<font color="#E5E5E5">I'll talk</font><font color="#CCCCCC"> about the deployment servers</font>

29
00:01:06,689 --> 00:01:09,570
and<font color="#E5E5E5"> universal supporters and all</font><font color="#CCCCCC"> of</font>

30
00:01:07,950 --> 00:01:11,100
<font color="#E5E5E5">those stuff but you can basically push</font>

31
00:01:09,570 --> 00:01:12,419
out applications to all these<font color="#E5E5E5"> Universal</font>

32
00:01:11,100 --> 00:01:14,548
forwarders that we have inside<font color="#E5E5E5"> a</font>

33
00:01:12,420 --> 00:01:16,290
customer<font color="#CCCCCC"> network</font><font color="#E5E5E5"> so on top of installing</font>

34
00:01:14,549 --> 00:01:17,970
an<font color="#CCCCCC"> application we also</font><font color="#E5E5E5"> deployed out an</font>

35
00:01:16,290 --> 00:01:20,700
application to every box in the customer

36
00:01:17,970 --> 00:01:24,420
<font color="#E5E5E5">network so</font><font color="#CCCCCC"> we took you</font><font color="#E5E5E5"> know a two-week</font>

37
00:01:20,700 --> 00:01:27,420
long pen test<font color="#E5E5E5"> in about 30 seconds so</font>

38
00:01:24,420 --> 00:01:29,070
it's pretty cool<font color="#E5E5E5"> anyway</font><font color="#CCCCCC"> so what am I</font>

39
00:01:27,420 --> 00:01:31,200
<font color="#E5E5E5">going to be here for um I</font><font color="#CCCCCC"> think this</font>

40
00:01:29,070 --> 00:01:33,720
standard Mike this<font color="#E5E5E5"> sucks</font><font color="#CCCCCC"> I like to walk</font>

41
00:01:31,200 --> 00:01:36,869
around<font color="#E5E5E5"> and the life got even</font><font color="#CCCCCC"> worse now</font>

42
00:01:33,720 --> 00:01:40,740
now no one<font color="#CCCCCC"> can read anything</font><font color="#E5E5E5"> other way</font>

43
00:01:36,869 --> 00:01:42,000
with the<font color="#E5E5E5"> light no</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so we're going to</font>

44
00:01:40,740 --> 00:01:43,920
start<font color="#E5E5E5"> out we're going to talk about</font>

45
00:01:42,000 --> 00:01:45,540
<font color="#CCCCCC">briefly</font><font color="#E5E5E5"> what's</font><font color="#CCCCCC"> Blancas hopefully</font>

46
00:01:43,920 --> 00:01:47,040
everybody at<font color="#CCCCCC"> least has some</font><font color="#E5E5E5"> idea what's</font>

47
00:01:45,540 --> 00:01:48,149
going<font color="#E5E5E5"> on with</font><font color="#CCCCCC"> Splunk um if you're here</font>

48
00:01:47,040 --> 00:01:49,560
I'll talk about<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the</font>

49
00:01:48,149 --> 00:01:51,750
misconfigurations that we've seen

50
00:01:49,560 --> 00:01:53,850
usually<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the basic</font><font color="#CCCCCC"> stuffs</font><font color="#E5E5E5"> nobody</font>

51
00:01:51,750 --> 00:01:56,100
changes their frickin password<font color="#E5E5E5"> things</font>

52
00:01:53,850 --> 00:01:57,809
like that and then we'll get into<font color="#E5E5E5"> actual</font>

53
00:01:56,100 --> 00:01:59,399
the meat of the talk<font color="#E5E5E5"> weaponizing slunk</font>

54
00:01:57,810 --> 00:02:01,469
there's three attack surfaces that we

55
00:01:59,399 --> 00:02:03,570
<font color="#E5E5E5">going into attacking the server itself</font>

56
00:02:01,469 --> 00:02:05,579
<font color="#E5E5E5">attacking the rest</font><font color="#CCCCCC"> the organization</font><font color="#E5E5E5"> and</font>

57
00:02:03,570 --> 00:02:08,160
then how we can<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> leverage Klunk</font>

58
00:02:05,579 --> 00:02:09,720
in as almost like a<font color="#CCCCCC"> situ</font><font color="#E5E5E5"> so actually if</font>

59
00:02:08,160 --> 00:02:12,840
I install<font color="#CCCCCC"> Splunk on my attacking machine</font>

60
00:02:09,720 --> 00:02:13,720
and collecting the<font color="#E5E5E5"> data that way</font><font color="#CCCCCC"> um and</font>

61
00:02:12,840 --> 00:02:14,950
<font color="#CCCCCC">then I'll wrap up</font>

62
00:02:13,720 --> 00:02:16,180
<font color="#E5E5E5">what kind of talked</font><font color="#CCCCCC"> about how you</font><font color="#E5E5E5"> can</font>

63
00:02:14,950 --> 00:02:20,589
<font color="#CCCCCC">mitigate this</font><font color="#E5E5E5"> in your own environment</font>

64
00:02:16,180 --> 00:02:21,820
<font color="#E5E5E5">and</font><font color="#CCCCCC"> since actually if anybody has any</font>

65
00:02:20,590 --> 00:02:22,990
<font color="#E5E5E5">questions while I'm doing this go</font><font color="#CCCCCC"> ahead</font>

66
00:02:21,820 --> 00:02:24,370
<font color="#E5E5E5">and raise your hand</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we can address</font>

67
00:02:22,990 --> 00:02:25,750
them as they come up

68
00:02:24,370 --> 00:02:28,960
it'll just<font color="#E5E5E5"> easier than wait</font><font color="#CCCCCC"> until the</font>

69
00:02:25,750 --> 00:02:30,430
end so<font color="#E5E5E5"> what is</font><font color="#CCCCCC"> Splunk I said</font><font color="#E5E5E5"> hopefully</font>

70
00:02:28,960 --> 00:02:31,630
<font color="#E5E5E5">you guys have some sort of idea because</font>

71
00:02:30,430 --> 00:02:33,580
I'm not<font color="#CCCCCC"> really going</font><font color="#E5E5E5"> to get into all the</font>

72
00:02:31,630 --> 00:02:36,640
details<font color="#CCCCCC"> of</font><font color="#E5E5E5"> it but it is a log</font>

73
00:02:33,580 --> 00:02:38,230
aggregation tool<font color="#CCCCCC"> all these</font><font color="#E5E5E5"> devices that</font>

74
00:02:36,640 --> 00:02:40,299
<font color="#CCCCCC">we have in our network Windows machines</font>

75
00:02:38,230 --> 00:02:41,859
Linux boxes<font color="#E5E5E5"> net firewall everything that</font>

76
00:02:40,300 --> 00:02:43,030
we have<font color="#CCCCCC"> spunks</font><font color="#E5E5E5"> going to take all the</font>

77
00:02:41,860 --> 00:02:46,530
logs and alerts that<font color="#E5E5E5"> come out</font><font color="#CCCCCC"> of those</font>

78
00:02:43,030 --> 00:02:49,300
devices<font color="#E5E5E5"> and put them into one location</font>

79
00:02:46,530 --> 00:02:51,040
<font color="#E5E5E5">as I said earlier the universal</font><font color="#CCCCCC"> flora</font>

80
00:02:49,300 --> 00:02:52,780
<font color="#CCCCCC">doors these</font><font color="#E5E5E5"> allow you to collect</font><font color="#CCCCCC"> those</font>

81
00:02:51,040 --> 00:02:54,640
logs up all these<font color="#CCCCCC"> despaired devices if</font>

82
00:02:52,780 --> 00:02:56,260
it doesn't send<font color="#E5E5E5"> out syslog messages you</font>

83
00:02:54,640 --> 00:02:58,059
can<font color="#E5E5E5"> install</font><font color="#CCCCCC"> Universal order</font><font color="#E5E5E5"> on it and</font>

84
00:02:56,260 --> 00:02:59,560
then pull in all those logs so things

85
00:02:58,060 --> 00:03:01,270
like Windows logs are normally what you

86
00:02:59,560 --> 00:03:02,890
see but any<font color="#E5E5E5"> other custom web</font>

87
00:03:01,270 --> 00:03:04,780
applications if they don't syslog out

88
00:03:02,890 --> 00:03:06,700
you can install a universal forward or

89
00:03:04,780 --> 00:03:08,200
tell<font color="#E5E5E5"> where the blog is and</font><font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> collect</font>

90
00:03:06,700 --> 00:03:09,880
<font color="#E5E5E5">them what's really nice about these is</font>

91
00:03:08,200 --> 00:03:11,350
<font color="#CCCCCC">they do allow</font><font color="#E5E5E5"> command execution on the</font>

92
00:03:09,880 --> 00:03:13,750
box<font color="#CCCCCC"> so if you need</font><font color="#E5E5E5"> to run something like</font>

93
00:03:11,350 --> 00:03:16,060
<font color="#E5E5E5">on a Linux box I want to run</font><font color="#CCCCCC"> netstat</font><font color="#E5E5E5"> and</font>

94
00:03:13,750 --> 00:03:17,950
collect the net the connections<font color="#E5E5E5"> that are</font>

95
00:03:16,060 --> 00:03:19,150
<font color="#CCCCCC">going on on my on that machine and send</font>

96
00:03:17,950 --> 00:03:22,929
those to<font color="#CCCCCC"> Splunk so that I can</font><font color="#E5E5E5"> review</font>

97
00:03:19,150 --> 00:03:24,519
those over time it will<font color="#E5E5E5"> allow</font><font color="#CCCCCC"> that all</font>

98
00:03:22,930 --> 00:03:26,140
these<font color="#E5E5E5"> Universal forwarders they're</font>

99
00:03:24,519 --> 00:03:28,360
actually sent out<font color="#E5E5E5"> through what's called</font>

100
00:03:26,140 --> 00:03:29,920
<font color="#E5E5E5">a deployment server</font><font color="#CCCCCC"> um the deployment</font>

101
00:03:28,360 --> 00:03:31,570
server allows you just<font color="#CCCCCC"> basically</font><font color="#E5E5E5"> a</font>

102
00:03:29,920 --> 00:03:34,470
collection<font color="#E5E5E5"> of all these</font><font color="#CCCCCC"> machines you can</font>

103
00:03:31,570 --> 00:03:36,910
<font color="#E5E5E5">separate</font><font color="#CCCCCC"> them out by a</font><font color="#E5E5E5"> machine name or</font>

104
00:03:34,470 --> 00:03:38,620
by the<font color="#E5E5E5"> operating</font><font color="#CCCCCC"> system to taken</font>

105
00:03:36,910 --> 00:03:39,730
categorizing<font color="#E5E5E5"> so the first screen you</font>

106
00:03:38,620 --> 00:03:41,080
would<font color="#E5E5E5"> see if you go to the deployment</font>

107
00:03:39,730 --> 00:03:42,429
<font color="#E5E5E5">server you would see all your list of</font>

108
00:03:41,080 --> 00:03:44,890
<font color="#E5E5E5">clients that have the universal</font><font color="#CCCCCC"> 4</font>

109
00:03:42,430 --> 00:03:46,209
installed you can<font color="#CCCCCC"> click over</font><font color="#E5E5E5"> and you can</font>

110
00:03:44,890 --> 00:03:48,670
<font color="#CCCCCC">actually split them up into what they</font>

111
00:03:46,209 --> 00:03:49,870
call categories or classes<font color="#CCCCCC"> so for</font>

112
00:03:48,670 --> 00:03:51,548
instance if I had a Windows application

113
00:03:49,870 --> 00:03:53,830
I only want to<font color="#E5E5E5"> install about a Windows</font>

114
00:03:51,549 --> 00:03:54,820
machine<font color="#CCCCCC"> not Linux machine so I split</font>

115
00:03:53,830 --> 00:03:56,590
them<font color="#CCCCCC"> out and say hey here's all my</font>

116
00:03:54,820 --> 00:03:59,440
<font color="#CCCCCC">Windows boxes based on operating system</font>

117
00:03:56,590 --> 00:04:01,890
<font color="#E5E5E5">only install those apps</font><font color="#CCCCCC"> and that's what</font>

118
00:03:59,440 --> 00:04:05,049
the apps<font color="#E5E5E5"> the last section here is apps</font>

119
00:04:01,890 --> 00:04:07,029
so those are the basics of<font color="#CCCCCC"> Splunk as I</font>

120
00:04:05,049 --> 00:04:08,470
said there's a<font color="#CCCCCC"> ton more to look into and</font>

121
00:04:07,030 --> 00:04:10,900
you<font color="#CCCCCC"> actually could figure</font><font color="#E5E5E5"> out with it um</font>

122
00:04:08,470 --> 00:04:13,720
if anybody has any questions<font color="#CCCCCC"> there go</font>

123
00:04:10,900 --> 00:04:16,680
<font color="#E5E5E5">ahead and ask them otherwise we'll start</font>

124
00:04:13,720 --> 00:04:16,680
getting<font color="#E5E5E5"> into the regular stuff</font>

125
00:04:18,709 --> 00:04:28,650
yes<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> as I said the basic</font>

126
00:04:26,030 --> 00:04:34,020
<font color="#CCCCCC">misconfigurations</font><font color="#E5E5E5"> that we see I'd rather</font>

127
00:04:28,650 --> 00:04:35,849
<font color="#CCCCCC">the dark let's just go dark</font><font color="#E5E5E5"> tide times</font>

128
00:04:34,020 --> 00:04:37,229
out of<font color="#CCCCCC"> 10 I usually run into</font><font color="#E5E5E5"> an</font>

129
00:04:35,850 --> 00:04:39,450
<font color="#E5E5E5">organization that didn't</font><font color="#CCCCCC"> change the</font>

130
00:04:37,230 --> 00:04:42,180
default<font color="#CCCCCC"> password its admin and changed</font>

131
00:04:39,450 --> 00:04:43,979
me obviously<font color="#E5E5E5"> now as of 6.5</font><font color="#CCCCCC"> spunked those</font>

132
00:04:42,180 --> 00:04:46,620
<font color="#CCCCCC">sorts of reset on that admin password</font>

133
00:04:43,980 --> 00:04:48,240
upon installation<font color="#CCCCCC"> but you know who</font>

134
00:04:46,620 --> 00:04:50,130
upgrades all their software<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the time</font>

135
00:04:48,240 --> 00:04:51,450
<font color="#E5E5E5">so we still do run into</font><font color="#CCCCCC"> a lot of older</font>

136
00:04:50,130 --> 00:04:54,659
machines where the passwords haven't

137
00:04:51,450 --> 00:04:56,729
been changed<font color="#CCCCCC"> the older versions as I</font>

138
00:04:54,660 --> 00:04:58,260
said that on our at<font color="#E5E5E5"> the beginning the</font>

139
00:04:56,730 --> 00:05:00,210
installation<font color="#E5E5E5"> that we were</font><font color="#CCCCCC"> into I</font><font color="#E5E5E5"> think</font>

140
00:04:58,260 --> 00:05:02,310
it was a 4.5 installation and<font color="#E5E5E5"> this was</font>

141
00:05:00,210 --> 00:05:03,810
just<font color="#CCCCCC"> last</font><font color="#E5E5E5"> year so that</font><font color="#CCCCCC"> obviously shows</font>

142
00:05:02,310 --> 00:05:05,550
<font color="#CCCCCC">people</font><font color="#E5E5E5"> are not up creating very well</font>

143
00:05:03,810 --> 00:05:07,400
those automatically<font color="#CCCCCC"> logged you</font><font color="#E5E5E5"> in if you</font>

144
00:05:05,550 --> 00:05:10,260
didn't have<font color="#E5E5E5"> an enterprise license</font><font color="#CCCCCC"> I</font>

145
00:05:07,400 --> 00:05:11,760
think I was really<font color="#CCCCCC"> the main thing</font><font color="#E5E5E5"> and</font>

146
00:05:10,260 --> 00:05:14,130
then a lot<font color="#E5E5E5"> of times I don't see SSL</font>

147
00:05:11,760 --> 00:05:16,289
turned on it's one<font color="#CCCCCC"> checkbox</font><font color="#E5E5E5"> and a Save</font>

148
00:05:14,130 --> 00:05:17,730
button<font color="#CCCCCC"> really to turn</font><font color="#E5E5E5"> that on</font><font color="#CCCCCC"> so you can</font>

149
00:05:16,290 --> 00:05:18,870
run<font color="#CCCCCC"> matter the middle attacks if you you</font>

150
00:05:17,730 --> 00:05:21,990
know if you were<font color="#CCCCCC"> seeing</font><font color="#E5E5E5"> that</font>

151
00:05:18,870 --> 00:05:24,780
and finally the universal forwarders<font color="#E5E5E5"> and</font>

152
00:05:21,990 --> 00:05:26,490
<font color="#E5E5E5">the</font><font color="#CCCCCC"> Splunk box itself is usually</font><font color="#E5E5E5"> running</font>

153
00:05:24,780 --> 00:05:29,640
as a higher privilege<font color="#E5E5E5"> user than it</font>

154
00:05:26,490 --> 00:05:32,000
really needs<font color="#E5E5E5"> um I see more the actual</font>

155
00:05:29,640 --> 00:05:34,229
<font color="#E5E5E5">spunk server software running as a</font>

156
00:05:32,000 --> 00:05:36,060
<font color="#E5E5E5">underprivileged user which</font><font color="#CCCCCC"> is good but</font>

157
00:05:34,230 --> 00:05:37,470
the universal forwarders nobody really

158
00:05:36,060 --> 00:05:39,390
<font color="#E5E5E5">wants</font><font color="#CCCCCC"> to configure the permissions</font><font color="#E5E5E5"> on</font>

159
00:05:37,470 --> 00:05:41,370
every single log set the<font color="#E5E5E5"> universal for</font>

160
00:05:39,390 --> 00:05:42,810
<font color="#E5E5E5">can read them so nine times</font><font color="#CCCCCC"> out of</font><font color="#E5E5E5"> ten I</font>

161
00:05:41,370 --> 00:05:45,180
run into those boxes<font color="#E5E5E5"> those are all</font>

162
00:05:42,810 --> 00:05:47,450
running<font color="#E5E5E5"> as root</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is awesome</font>

163
00:05:45,180 --> 00:05:47,450
for<font color="#CCCCCC"> us</font>

164
00:05:47,540 --> 00:05:53,760
so actually weaponizing<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> so upon</font>

165
00:05:52,290 --> 00:05:55,260
upon<font color="#E5E5E5"> at first getting</font><font color="#CCCCCC"> into a server</font>

166
00:05:53,760 --> 00:05:56,820
<font color="#E5E5E5">that's what we're going to talk</font><font color="#CCCCCC"> about</font>

167
00:05:55,260 --> 00:05:58,770
what when I when I get<font color="#E5E5E5"> into the attack</font>

168
00:05:56,820 --> 00:06:01,440
<font color="#E5E5E5">unit server part what can we do when we</font>

169
00:05:58,770 --> 00:06:02,520
only get on that<font color="#E5E5E5"> box</font><font color="#CCCCCC"> so first of all</font><font color="#E5E5E5"> we</font>

170
00:06:01,440 --> 00:06:03,960
want<font color="#E5E5E5"> to we</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to increase our</font>

171
00:06:02,520 --> 00:06:05,609
intelligence<font color="#E5E5E5"> so let's look at the logs</font>

172
00:06:03,960 --> 00:06:06,989
that<font color="#E5E5E5"> are</font><font color="#CCCCCC"> already in there</font><font color="#E5E5E5"> we can</font>

173
00:06:05,610 --> 00:06:08,700
identify operating systems I can

174
00:06:06,990 --> 00:06:10,260
identify the<font color="#E5E5E5"> domain controllers the</font>

175
00:06:08,700 --> 00:06:13,380
exchange servers everything else in the

176
00:06:10,260 --> 00:06:16,500
environment<font color="#E5E5E5"> then if Splunk is running as</font>

177
00:06:13,380 --> 00:06:18,330
a privileged user account<font color="#CCCCCC"> I</font><font color="#E5E5E5"> have read</font>

178
00:06:16,500 --> 00:06:18,660
<font color="#CCCCCC">access to</font><font color="#E5E5E5"> every file on</font><font color="#CCCCCC"> the operating</font>

179
00:06:18,330 --> 00:06:20,219
system

180
00:06:18,660 --> 00:06:22,860
<font color="#CCCCCC">let's pull an</font><font color="#E5E5E5"> se shadow let's pull in</font>

181
00:06:20,220 --> 00:06:24,270
you know<font color="#E5E5E5"> a</font><font color="#CCCCCC"> T password whatever</font><font color="#E5E5E5"> file you</font>

182
00:06:22,860 --> 00:06:26,430
<font color="#CCCCCC">can come</font><font color="#E5E5E5"> up with let's pull it in let's</font>

183
00:06:24,270 --> 00:06:27,930
look at it and if you do it the right

184
00:06:26,430 --> 00:06:29,820
<font color="#E5E5E5">way</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> doesn't get logged so that's</font>

185
00:06:27,930 --> 00:06:31,680
awesome<font color="#CCCCCC"> um</font>

186
00:06:29,820 --> 00:06:34,050
if we have administrator access we<font color="#CCCCCC"> can</font>

187
00:06:31,680 --> 00:06:35,850
install applications which<font color="#CCCCCC"> can be any</font>

188
00:06:34,050 --> 00:06:37,740
application which<font color="#CCCCCC"> can run any code that</font>

189
00:06:35,850 --> 00:06:40,290
<font color="#E5E5E5">we want</font><font color="#CCCCCC"> so if you</font><font color="#E5E5E5"> have a Python</font><font color="#CCCCCC"> shell</font><font color="#E5E5E5"> or</font>

190
00:06:37,740 --> 00:06:42,150
if you have anything<font color="#E5E5E5"> you can run it and</font>

191
00:06:40,290 --> 00:06:43,800
then finally we're going<font color="#CCCCCC"> to talk about</font>

192
00:06:42,150 --> 00:06:45,150
<font color="#E5E5E5">extracting the data which is you know</font>

193
00:06:43,800 --> 00:06:46,740
all these configured files are on<font color="#CCCCCC"> earth</font>

194
00:06:45,150 --> 00:06:52,500
<font color="#E5E5E5">let's let's look at the data that we can</font>

195
00:06:46,740 --> 00:06:53,760
pull<font color="#E5E5E5"> out of</font><font color="#CCCCCC"> Spock that changed attacking</font>

196
00:06:52,500 --> 00:06:55,560
<font color="#E5E5E5">the organization we're going to get into</font>

197
00:06:53,760 --> 00:06:56,640
<font color="#E5E5E5">actually how we can utilize</font><font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> to</font>

198
00:06:55,560 --> 00:06:59,970
laterally move throughout<font color="#CCCCCC"> the network</font>

199
00:06:56,640 --> 00:07:01,979
<font color="#E5E5E5">and compromise everybody</font><font color="#CCCCCC"> and then the</font>

200
00:06:59,970 --> 00:07:03,450
final part attacking the data we're

201
00:07:01,980 --> 00:07:10,170
actually going to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> it for c2</font><font color="#E5E5E5"> so</font>

202
00:07:03,450 --> 00:07:13,349
<font color="#E5E5E5">that's gonna</font><font color="#CCCCCC"> be cool so reviewing</font><font color="#E5E5E5"> the</font>

203
00:07:10,170 --> 00:07:14,850
logs all the logs are<font color="#E5E5E5"> called since this</font>

204
00:07:13,350 --> 00:07:16,710
is collecting<font color="#E5E5E5"> all the logs as I said</font>

205
00:07:14,850 --> 00:07:18,990
custom web applications<font color="#CCCCCC"> Windows Wars</font>

206
00:07:16,710 --> 00:07:20,340
Linux<font color="#E5E5E5"> logs everything's in here let's</font>

207
00:07:18,990 --> 00:07:22,470
<font color="#E5E5E5">start</font><font color="#CCCCCC"> looking for</font><font color="#E5E5E5"> things</font>

208
00:07:20,340 --> 00:07:24,900
go to the<font color="#E5E5E5"> search</font><font color="#CCCCCC"> application type in</font>

209
00:07:22,470 --> 00:07:26,400
<font color="#CCCCCC">password</font><font color="#E5E5E5"> see what comes back if it's a</font>

210
00:07:24,900 --> 00:07:28,409
custom web application a lot of times

211
00:07:26,400 --> 00:07:30,900
<font color="#E5E5E5">I've seen</font><font color="#CCCCCC"> developers pull in the</font>

212
00:07:28,410 --> 00:07:32,190
passwords<font color="#E5E5E5"> why the heck not no one else</font>

213
00:07:30,900 --> 00:07:34,200
<font color="#CCCCCC">need to see</font><font color="#E5E5E5"> this except</font><font color="#CCCCCC"> for me why would</font>

214
00:07:32,190 --> 00:07:37,320
<font color="#CCCCCC">anybody</font><font color="#E5E5E5"> be looking for passwords it's</font>

215
00:07:34,200 --> 00:07:38,820
pretty cool<font color="#CCCCCC"> um we can get it we can get</font>

216
00:07:37,320 --> 00:07:40,200
a good sense of the hours operation<font color="#CCCCCC"> if</font>

217
00:07:38,820 --> 00:07:42,810
we started looking at maybe let's say

218
00:07:40,200 --> 00:07:45,150
the windows event code for<font color="#E5E5E5"> logging in I</font>

219
00:07:42,810 --> 00:07:47,820
now<font color="#CCCCCC"> I now have a list of users that</font><font color="#E5E5E5"> say</font>

220
00:07:45,150 --> 00:07:49,530
<font color="#E5E5E5">ok this shop runs</font><font color="#CCCCCC"> 9:00 to 5:00 so I see</font>

221
00:07:47,820 --> 00:07:51,240
all<font color="#CCCCCC"> my logins at 9:00 I see all</font><font color="#E5E5E5"> my log</font>

222
00:07:49,530 --> 00:07:52,859
outs at 5:00 and I can<font color="#CCCCCC"> actually probably</font>

223
00:07:51,240 --> 00:07:54,300
pick in pick out where<font color="#CCCCCC"> lunch is too</font>

224
00:07:52,860 --> 00:07:58,620
because a lot<font color="#CCCCCC"> of people log in</font><font color="#E5E5E5"> and out</font>

225
00:07:54,300 --> 00:08:00,240
there<font color="#CCCCCC"> -</font><font color="#E5E5E5"> um or maybe I can see if it's a</font>

226
00:07:58,620 --> 00:08:01,980
<font color="#CCCCCC">24 hour shops but now I have a list of</font>

227
00:08:00,240 --> 00:08:03,270
users<font color="#E5E5E5"> these guys were</font><font color="#CCCCCC"> on the morning</font>

228
00:08:01,980 --> 00:08:05,250
shift<font color="#E5E5E5"> these desert</font><font color="#CCCCCC"> an afternoon these</font>

229
00:08:03,270 --> 00:08:06,780
guys are<font color="#E5E5E5"> a night shift so</font><font color="#CCCCCC"> it kind of</font>

230
00:08:05,250 --> 00:08:11,430
<font color="#E5E5E5">gives you a lot of intelligence</font><font color="#CCCCCC"> about a</font>

231
00:08:06,780 --> 00:08:19,909
company so<font color="#E5E5E5"> let's actually go to the demo</font>

232
00:08:11,430 --> 00:08:19,910
here why are you not working<font color="#E5E5E5"> there goes</font>

233
00:08:20,990 --> 00:08:30,310
looks like<font color="#E5E5E5"> wrapped in a light</font>

234
00:08:23,889 --> 00:08:31,810
<font color="#E5E5E5">oh let's</font><font color="#CCCCCC"> just separate so the first stop</font>

235
00:08:30,310 --> 00:08:38,440
<font color="#E5E5E5">here if you click in the middle there</font>

236
00:08:31,810 --> 00:08:41,078
you're<font color="#E5E5E5"> going to add data so if this</font>

237
00:08:38,440 --> 00:08:43,000
<font color="#CCCCCC">blokes get</font><font color="#E5E5E5"> this one application itself</font>

238
00:08:41,078 --> 00:08:45,219
is<font color="#CCCCCC"> running as root I'm going to</font><font color="#E5E5E5"> look at</font>

239
00:08:43,000 --> 00:08:48,250
monitoring<font color="#E5E5E5"> a folder or a file so</font><font color="#CCCCCC"> let's</font>

240
00:08:45,220 --> 00:08:49,660
click<font color="#E5E5E5"> on monitor can we bring the lights</font>

241
00:08:48,250 --> 00:08:53,230
<font color="#E5E5E5">down just</font><font color="#CCCCCC"> a little bit so we can read</font>

242
00:08:49,660 --> 00:08:55,779
some of it<font color="#E5E5E5"> otherwise it's not going to</font>

243
00:08:53,230 --> 00:08:56,980
make any sense<font color="#CCCCCC"> so on the left over there</font>

244
00:08:55,779 --> 00:09:00,790
we're going<font color="#E5E5E5"> to look at files and</font>

245
00:08:56,980 --> 00:09:02,740
directories<font color="#E5E5E5"> wow that sucks</font><font color="#CCCCCC"> so I'm going</font>

246
00:09:00,790 --> 00:09:04,689
<font color="#CCCCCC">to look</font><font color="#E5E5E5"> at SD password right here and</font>

247
00:09:02,740 --> 00:09:14,649
then I'm going<font color="#E5E5E5"> to hit browse and it's</font>

248
00:09:04,690 --> 00:09:16,420
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually show</font><font color="#E5E5E5"> it to me well if</font>

249
00:09:14,649 --> 00:09:18,760
we<font color="#CCCCCC"> can see</font><font color="#E5E5E5"> that it would</font><font color="#CCCCCC"> be the FT</font>

250
00:09:16,420 --> 00:09:21,519
<font color="#E5E5E5">password file so I'll be able to</font>

251
00:09:18,760 --> 00:09:23,140
enumerate user names there<font color="#CCCCCC"> umm so as</font>

252
00:09:21,519 --> 00:09:24,490
long as<font color="#E5E5E5"> you don't pass that screen right</font>

253
00:09:23,140 --> 00:09:26,439
there<font color="#E5E5E5"> and hit keep hitting next to</font>

254
00:09:24,490 --> 00:09:29,079
<font color="#E5E5E5">finish it this data didn't get indexed</font>

255
00:09:26,440 --> 00:09:30,370
<font color="#CCCCCC">it doesn't get logged and I now can pull</font>

256
00:09:29,079 --> 00:09:32,079
this down<font color="#E5E5E5"> and look at</font><font color="#CCCCCC"> it locally on my</font>

257
00:09:30,370 --> 00:09:33,459
machine<font color="#CCCCCC"> if I need to pull out hashes I</font>

258
00:09:32,079 --> 00:09:34,810
can start cracking that<font color="#E5E5E5"> the nil</font>

259
00:09:33,459 --> 00:09:36,518
administrator would<font color="#E5E5E5"> ever know</font><font color="#CCCCCC"> that I was</font>

260
00:09:34,810 --> 00:09:40,750
looking<font color="#E5E5E5"> at any of these files so no</font>

261
00:09:36,519 --> 00:09:43,420
alerts are going off<font color="#E5E5E5"> yeah that might get</font>

262
00:09:40,750 --> 00:09:44,410
<font color="#E5E5E5">a</font><font color="#CCCCCC"> little better hopefully</font><font color="#E5E5E5"> all right</font><font color="#CCCCCC"> so</font>

263
00:09:43,420 --> 00:09:45,550
that's<font color="#E5E5E5"> kind of reviewing</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> laws</font>

264
00:09:44,410 --> 00:09:47,140
<font color="#CCCCCC">everybody's</font><font color="#E5E5E5"> cool</font><font color="#CCCCCC"> with that</font><font color="#E5E5E5"> we're good</font>

265
00:09:45,550 --> 00:09:49,599
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> so let's start installing</font>

266
00:09:47,140 --> 00:09:51,970
malicious applications<font color="#E5E5E5"> so I built an app</font>

267
00:09:49,600 --> 00:09:53,320
called<font color="#CCCCCC"> Splunk shells</font><font color="#E5E5E5"> it's it does a bind</font>

268
00:09:51,970 --> 00:09:54,820
show or<font color="#E5E5E5"> revert show it's</font><font color="#CCCCCC"> just</font>

269
00:09:53,320 --> 00:09:58,860
meterpreter it's just a perfect<font color="#E5E5E5"> concept</font>

270
00:09:54,820 --> 00:09:58,860
<font color="#CCCCCC">basically to show off the capabilities</font>

271
00:09:59,820 --> 00:10:05,589
hopefully this one looks a<font color="#CCCCCC"> little better</font>

272
00:10:02,110 --> 00:10:08,019
<font color="#E5E5E5">since it's not white</font><font color="#CCCCCC"> so let's start up</font>

273
00:10:05,589 --> 00:10:10,209
<font color="#E5E5E5">with the Metasploit let's start up a</font>

274
00:10:08,019 --> 00:10:12,750
handler then we'll start<font color="#E5E5E5"> looking at the</font>

275
00:10:10,209 --> 00:10:12,750
application

276
00:10:23,320 --> 00:10:28,120
so we're setting<font color="#CCCCCC"> up a handler right here</font>

277
00:10:25,430 --> 00:10:28,120
to catch<font color="#E5E5E5"> the show</font>

278
00:10:38,100 --> 00:10:43,720
<font color="#E5E5E5">Claire</font><font color="#CCCCCC"> Handler</font><font color="#E5E5E5"> set up now let's go</font>

279
00:10:40,090 --> 00:10:45,130
actually<font color="#CCCCCC"> this</font><font color="#E5E5E5"> bloke so</font><font color="#CCCCCC"> Splunk</font>

280
00:10:43,720 --> 00:10:46,930
applications are basically just<font color="#E5E5E5"> a zip</font>

281
00:10:45,130 --> 00:10:49,260
file<font color="#CCCCCC"> of folders and scripts that are</font>

282
00:10:46,930 --> 00:10:49,260
<font color="#E5E5E5">running</font>

283
00:11:01,959 --> 00:11:07,250
<font color="#E5E5E5">growls we'll grab the zip file and then</font>

284
00:11:04,760 --> 00:11:10,100
we can install<font color="#CCCCCC"> it so what this does</font><font color="#E5E5E5"> is</font>

285
00:11:07,250 --> 00:11:11,779
it basically adds an application to

286
00:11:10,100 --> 00:11:13,010
<font color="#E5E5E5">smoke and gives you a command line</font><font color="#CCCCCC"> that</font>

287
00:11:11,779 --> 00:11:15,380
you can run<font color="#E5E5E5"> through the search and</font>

288
00:11:13,010 --> 00:11:16,819
reporting application<font color="#E5E5E5"> so once we install</font>

289
00:11:15,380 --> 00:11:18,880
<font color="#E5E5E5">it we don't have</font><font color="#CCCCCC"> to do a restart of the</font>

290
00:11:16,820 --> 00:11:21,440
<font color="#E5E5E5">box so again that doesn't alert anybody</font>

291
00:11:18,880 --> 00:11:23,450
<font color="#E5E5E5">we'll just change one permission set</font>

292
00:11:21,440 --> 00:11:24,529
that I don't think I<font color="#CCCCCC"> can do in config</font>

293
00:11:23,450 --> 00:11:26,209
files at least<font color="#CCCCCC"> having to figure out</font>

294
00:11:24,529 --> 00:11:29,300
which one it is<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you do have</font><font color="#E5E5E5"> to set</font>

295
00:11:26,209 --> 00:11:30,199
this<font color="#E5E5E5"> and</font><font color="#CCCCCC"> this is only in 6.5 so hit save</font>

296
00:11:29,300 --> 00:11:31,750
and then<font color="#CCCCCC"> we'll go</font><font color="#E5E5E5"> to search and</font>

297
00:11:30,200 --> 00:11:39,050
reporting and<font color="#CCCCCC"> actually execute the</font>

298
00:11:31,750 --> 00:11:40,490
<font color="#E5E5E5">reverse show so from the command line</font><font color="#CCCCCC"> I</font>

299
00:11:39,050 --> 00:11:42,439
can specify - I'm gonna<font color="#E5E5E5"> reverse show</font>

300
00:11:40,490 --> 00:11:43,940
don't<font color="#E5E5E5"> want a bind shell who do I need</font><font color="#CCCCCC"> to</font>

301
00:11:42,440 --> 00:11:46,160
talk<font color="#CCCCCC"> to and what port are we going to</font>

302
00:11:43,940 --> 00:11:47,930
<font color="#E5E5E5">communicate over so we'll do a reverse</font>

303
00:11:46,160 --> 00:11:49,939
<font color="#CCCCCC">shell</font><font color="#E5E5E5"> I want to do a meterpreter shell</font>

304
00:11:47,930 --> 00:11:53,239
<font color="#E5E5E5">so if I set up that that handler already</font>

305
00:11:49,940 --> 00:11:54,440
there's our IP and there's our port so

306
00:11:53,240 --> 00:11:55,700
with<font color="#E5E5E5"> it what the shell does in the</font>

307
00:11:54,440 --> 00:11:57,440
background is<font color="#CCCCCC"> actually going to fork</font>

308
00:11:55,700 --> 00:11:58,880
itself off<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> Splunk process that it</font>

309
00:11:57,440 --> 00:12:00,560
doesn't use<font color="#CCCCCC"> up</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the resources</font><font color="#E5E5E5"> while</font>

310
00:11:58,880 --> 00:12:03,170
<font color="#E5E5E5">I'm still communicating and attacking</font>

311
00:12:00,560 --> 00:12:07,880
there and then we have our connection

312
00:12:03,170 --> 00:12:09,469
<font color="#CCCCCC">err</font><font color="#E5E5E5"> so that's awesome right everybody</font>

313
00:12:07,880 --> 00:12:13,070
wants to install it<font color="#E5E5E5"> I have it on github</font>

314
00:12:09,470 --> 00:12:15,490
<font color="#CCCCCC">um that's a crappy link basically</font>

315
00:12:13,070 --> 00:12:18,740
weaponizing<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> comm has it all and</font>

316
00:12:15,490 --> 00:12:22,160
<font color="#CCCCCC">then I also submitted it to Splunk for</font>

317
00:12:18,740 --> 00:12:24,980
the<font color="#CCCCCC"> slug base it's</font><font color="#E5E5E5"> really cool I got</font>

318
00:12:22,160 --> 00:12:26,360
approved<font color="#E5E5E5"> it took like</font><font color="#CCCCCC"> three days um they</font>

319
00:12:24,980 --> 00:12:27,950
were really<font color="#E5E5E5"> cool about it it was</font><font color="#CCCCCC"> awesome</font>

320
00:12:26,360 --> 00:12:29,750
so instead of going<font color="#CCCCCC"> to browse for file</font>

321
00:12:27,950 --> 00:12:32,180
and you could<font color="#E5E5E5"> just install</font><font color="#CCCCCC"> it right from</font>

322
00:12:29,750 --> 00:12:35,160
spawn page except for<font color="#E5E5E5"> about 57</font><font color="#CCCCCC"> minutes</font>

323
00:12:32,180 --> 00:12:36,959
later I got rejected<font color="#CCCCCC"> so</font>

324
00:12:35,160 --> 00:12:39,350
I don't know who got in trouble<font color="#E5E5E5"> over</font>

325
00:12:36,960 --> 00:12:43,550
that<font color="#CCCCCC"> I've asked but they won't tell me</font>

326
00:12:39,350 --> 00:12:43,550
<font color="#CCCCCC">but I was it was fun for</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> little while</font>

327
00:12:44,720 --> 00:12:49,080
<font color="#CCCCCC">if you go I'll</font><font color="#E5E5E5"> have them all at the end</font>

328
00:12:46,740 --> 00:12:51,870
<font color="#E5E5E5">but it's github weaponizing</font><font color="#CCCCCC"> spunk</font><font color="#E5E5E5"> calm</font>

329
00:12:49,080 --> 00:12:52,920
<font color="#E5E5E5">and</font><font color="#CCCCCC"> that'll how about everything</font><font color="#E5E5E5"> it</font>

330
00:12:51,870 --> 00:12:54,600
<font color="#E5E5E5">actually will have all the slide decks</font>

331
00:12:52,920 --> 00:12:57,930
<font color="#E5E5E5">and videos and stuff</font><font color="#CCCCCC"> so you can actually</font>

332
00:12:54,600 --> 00:12:59,520
see them in proper<font color="#E5E5E5"> lighting so</font>

333
00:12:57,930 --> 00:13:01,500
extracting<font color="#E5E5E5"> data all these applications</font>

334
00:12:59,520 --> 00:13:04,590
that are<font color="#CCCCCC"> installed on Splunk you know</font>

335
00:13:01,500 --> 00:13:06,570
Active Directory<font color="#E5E5E5"> rapid7 has an app</font>

336
00:13:04,590 --> 00:13:07,640
everybody has an app and yes installed

337
00:13:06,570 --> 00:13:10,740
and they have to<font color="#E5E5E5"> configure them</font>

338
00:13:07,640 --> 00:13:12,180
different ways<font color="#E5E5E5"> um so some</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> these apps</font>

339
00:13:10,740 --> 00:13:15,170
for instance the Active Directory

340
00:13:12,180 --> 00:13:17,880
application needs a domain level

341
00:13:15,170 --> 00:13:19,020
username and password<font color="#E5E5E5"> so what you</font><font color="#CCCCCC"> would</font>

342
00:13:17,880 --> 00:13:20,640
see<font color="#CCCCCC"> is when you're configuring that</font>

343
00:13:19,020 --> 00:13:22,439
would be<font color="#CCCCCC"> screenshot like that I'd</font><font color="#E5E5E5"> have</font>

344
00:13:20,640 --> 00:13:24,140
to<font color="#E5E5E5"> install</font><font color="#CCCCCC"> it you know give it a get a</font>

345
00:13:22,440 --> 00:13:26,760
domain<font color="#E5E5E5"> give it a user give it a password</font>

346
00:13:24,140 --> 00:13:28,380
<font color="#E5E5E5">now spunk is really good about it</font><font color="#CCCCCC"> they</font>

347
00:13:26,760 --> 00:13:29,880
do store<font color="#E5E5E5"> these passwords encrypted and</font>

348
00:13:28,380 --> 00:13:32,460
<font color="#E5E5E5">they are there's a salt and</font><font color="#CCCCCC"> everything</font>

349
00:13:29,880 --> 00:13:33,930
<font color="#E5E5E5">that is unique to each one deployment as</font>

350
00:13:32,460 --> 00:13:35,640
you install it<font color="#CCCCCC"> so if you go look at</font><font color="#E5E5E5"> the</font>

351
00:13:33,930 --> 00:13:39,329
file<font color="#CCCCCC"> that's what you would actually see</font>

352
00:13:35,640 --> 00:13:41,130
in there but if you have<font color="#E5E5E5"> 14 lines of</font>

353
00:13:39,330 --> 00:13:43,110
Python code<font color="#CCCCCC"> you can actually get clear</font>

354
00:13:41,130 --> 00:13:47,570
text credential<font color="#E5E5E5"> damn can we turn the</font>

355
00:13:43,110 --> 00:13:47,570
lights<font color="#CCCCCC"> down a</font><font color="#E5E5E5"> little bit more</font><font color="#CCCCCC"> yes sucks</font>

356
00:13:48,260 --> 00:13:53,910
yeah so about<font color="#CCCCCC"> 40</font><font color="#E5E5E5"> lines of Python code</font>

357
00:13:51,780 --> 00:13:55,380
and again<font color="#CCCCCC"> it's all on github you can run</font>

358
00:13:53,910 --> 00:13:56,760
<font color="#E5E5E5">that you'll run it with your admin</font>

359
00:13:55,380 --> 00:13:58,530
credentials that<font color="#E5E5E5"> we obviously already</font>

360
00:13:56,760 --> 00:13:59,850
have<font color="#CCCCCC"> and it loops through</font><font color="#E5E5E5"> every</font>

361
00:13:58,530 --> 00:14:01,740
application<font color="#E5E5E5"> that's installed and</font>

362
00:13:59,850 --> 00:14:03,900
extracts any information that<font color="#CCCCCC"> it has in</font>

363
00:14:01,740 --> 00:14:06,000
there<font color="#E5E5E5"> so if you could see that we would</font>

364
00:14:03,900 --> 00:14:07,770
<font color="#E5E5E5">have our username and our domain level</font>

365
00:14:06,000 --> 00:14:11,460
credential password in<font color="#CCCCCC"> clear-text</font>

366
00:14:07,770 --> 00:14:13,290
and that works via the<font color="#CCCCCC"> Splunk API func</font>

367
00:14:11,460 --> 00:14:14,970
<font color="#E5E5E5">API actually</font><font color="#CCCCCC"> has access to all these</font>

368
00:14:13,290 --> 00:14:16,589
configuration files<font color="#E5E5E5"> the salt and</font>

369
00:14:14,970 --> 00:14:17,880
<font color="#E5E5E5">everything else that it needs to decrypt</font>

370
00:14:16,590 --> 00:14:19,980
those<font color="#E5E5E5"> credentials so</font><font color="#CCCCCC"> that when it</font><font color="#E5E5E5"> does</font>

371
00:14:17,880 --> 00:14:21,320
<font color="#CCCCCC">actually need to</font><font color="#E5E5E5"> use those it can</font>

372
00:14:19,980 --> 00:14:23,040
communicate<font color="#CCCCCC"> with the domain controller</font>

373
00:14:21,320 --> 00:14:28,470
luckily it's really nice<font color="#CCCCCC"> than</font><font color="#E5E5E5"> it</font>

374
00:14:23,040 --> 00:14:29,699
actually<font color="#CCCCCC"> give it to me as well so now</font>

375
00:14:28,470 --> 00:14:31,230
that we've already<font color="#E5E5E5"> attacked the server</font>

376
00:14:29,700 --> 00:14:33,300
we have<font color="#E5E5E5"> a shell</font><font color="#CCCCCC"> on the server</font><font color="#E5E5E5"> we've</font>

377
00:14:31,230 --> 00:14:35,150
extracted some<font color="#CCCCCC"> passwords</font><font color="#E5E5E5"> let's actually</font>

378
00:14:33,300 --> 00:14:37,550
move laterally in the environment

379
00:14:35,150 --> 00:14:39,350
and start working<font color="#E5E5E5"> on</font><font color="#CCCCCC"> other computers</font><font color="#E5E5E5"> so</font>

380
00:14:37,550 --> 00:14:41,900
within<font color="#E5E5E5"> the application the</font><font color="#CCCCCC"> swamp shells</font>

381
00:14:39,350 --> 00:14:43,190
application<font color="#CCCCCC"> I've built two technology</font>

382
00:14:41,900 --> 00:14:45,439
add-ons<font color="#E5E5E5"> and again these are just perfect</font>

383
00:14:43,190 --> 00:14:47,510
concepts<font color="#CCCCCC"> or</font><font color="#E5E5E5"> using basic meterpreter code</font>

384
00:14:45,440 --> 00:14:49,070
<font color="#CCCCCC">I'm not trying to</font><font color="#E5E5E5"> hide from anybody if</font>

385
00:14:47,510 --> 00:14:50,540
you<font color="#E5E5E5"> want to use them I would highly</font>

386
00:14:49,070 --> 00:14:52,400
suggest substituting<font color="#E5E5E5"> your own custom</font>

387
00:14:50,540 --> 00:14:53,959
payloads in there and it's literally

388
00:14:52,400 --> 00:14:57,410
just<font color="#E5E5E5"> swapping</font><font color="#CCCCCC"> one Python file for</font>

389
00:14:53,960 --> 00:14:59,420
whatever<font color="#E5E5E5"> else you guys have so the</font>

390
00:14:57,410 --> 00:15:01,520
<font color="#CCCCCC">Windows add-on uses a batch file and</font>

391
00:14:59,420 --> 00:15:04,390
<font color="#E5E5E5">just runs PowerShell code I'm actually</font>

392
00:15:01,520 --> 00:15:06,710
using<font color="#E5E5E5"> the</font><font color="#CCCCCC"> trusted tech unicorn unicorn</font><font color="#E5E5E5"> a</font>

393
00:15:04,390 --> 00:15:10,550
program to generate<font color="#E5E5E5"> that and just</font>

394
00:15:06,710 --> 00:15:13,550
generates<font color="#CCCCCC"> obviated payload for a reverse</font>

395
00:15:10,550 --> 00:15:15,199
meterpreter shell<font color="#E5E5E5"> and the Linux one is</font>

396
00:15:13,550 --> 00:15:16,640
just a basic Python<font color="#E5E5E5"> one and again</font><font color="#CCCCCC"> I'm</font>

397
00:15:15,200 --> 00:15:21,560
<font color="#CCCCCC">not trying to hide anything</font><font color="#E5E5E5"> it's all</font>

398
00:15:16,640 --> 00:15:24,010
just proof of concept so let's see what

399
00:15:21,560 --> 00:15:24,010
that<font color="#E5E5E5"> looks</font><font color="#CCCCCC"> like</font>

400
00:15:30,010 --> 00:15:33,530
<font color="#E5E5E5">all right so we're setting up another</font>

401
00:15:32,150 --> 00:15:40,970
handler<font color="#E5E5E5"> let's just get through this a</font>

402
00:15:33,530 --> 00:15:42,470
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit inside each these technology</font>

403
00:15:40,970 --> 00:15:46,190
add-ons there's a couple things that<font color="#E5E5E5"> you</font>

404
00:15:42,470 --> 00:15:52,010
have to change<font color="#E5E5E5"> one way the other all</font>

405
00:15:46,190 --> 00:15:54,140
<font color="#CCCCCC">right let's go with the dark just just</font>

406
00:15:52,010 --> 00:15:58,010
keep going up<font color="#E5E5E5"> and down it'll be a party</font>

407
00:15:54,140 --> 00:15:59,180
we'll have fun so there's two things<font color="#CCCCCC"> you</font>

408
00:15:58,010 --> 00:16:01,670
<font color="#E5E5E5">got to change inside these payloads</font>

409
00:15:59,180 --> 00:16:03,349
<font color="#E5E5E5">since they are just static payloads you</font>

410
00:16:01,670 --> 00:16:04,880
can have to change out your IP so give

411
00:16:03,350 --> 00:16:06,770
it<font color="#E5E5E5"> your attacker IP give your attacker</font>

412
00:16:04,880 --> 00:16:08,530
port and you do have to<font color="#CCCCCC"> substitute in</font>

413
00:16:06,770 --> 00:16:11,569
the PowerShell code because I didn't

414
00:16:08,530 --> 00:16:15,319
it's<font color="#E5E5E5"> not set</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> for you</font><font color="#CCCCCC"> no it's set up</font>

415
00:16:11,570 --> 00:16:16,970
<font color="#E5E5E5">for me</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use or somebody else so you</font>

416
00:16:15,320 --> 00:16:21,230
swap<font color="#E5E5E5"> out your PowerShell code here we'll</font>

417
00:16:16,970 --> 00:16:24,620
swap<font color="#CCCCCC"> off the Linux payload I'm just</font>

418
00:16:21,230 --> 00:16:28,550
changing our attacker<font color="#CCCCCC"> IPs</font><font color="#E5E5E5"> let's actually</font>

419
00:16:24,620 --> 00:16:32,120
get got our handler set up here let's

420
00:16:28,550 --> 00:16:33,349
actually go to<font color="#E5E5E5"> deployments all right so</font>

421
00:16:32,120 --> 00:16:34,940
here's<font color="#E5E5E5"> it</font><font color="#CCCCCC"> Terry</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> deployment</font>

422
00:16:33,350 --> 00:16:36,590
server<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we have those applications</font>

423
00:16:34,940 --> 00:16:39,230
they show up<font color="#E5E5E5"> here it's literally just</font>

424
00:16:36,590 --> 00:16:41,300
clicking<font color="#E5E5E5"> edit telling what what servers</font>

425
00:16:39,230 --> 00:16:44,120
I want to install these things on all of

426
00:16:41,300 --> 00:16:45,740
them obviously<font color="#CCCCCC"> and then it does all the</font>

427
00:16:44,120 --> 00:16:46,760
heavy<font color="#E5E5E5"> lifting of</font><font color="#CCCCCC"> setting those out and</font>

428
00:16:45,740 --> 00:16:48,020
<font color="#E5E5E5">actually running</font>

429
00:16:46,760 --> 00:16:49,910
what's really<font color="#CCCCCC"> cool here is there's</font>

430
00:16:48,020 --> 00:16:51,710
configuration file<font color="#CCCCCC"> for how many</font><font color="#E5E5E5"> times</font>

431
00:16:49,910 --> 00:16:53,779
<font color="#CCCCCC">you want this to run</font><font color="#E5E5E5"> I'm obviously just</font>

432
00:16:51,710 --> 00:16:55,460
running<font color="#E5E5E5"> it once but I could say let's</font>

433
00:16:53,779 --> 00:16:57,170
run this<font color="#E5E5E5"> every 30 minutes or let's run</font>

434
00:16:55,460 --> 00:16:59,450
this<font color="#E5E5E5"> every two hours</font><font color="#CCCCCC"> so if somebody does</font>

435
00:16:57,170 --> 00:17:01,130
<font color="#CCCCCC">detect me and kill me I now have a way</font>

436
00:16:59,450 --> 00:17:02,810
back in<font color="#E5E5E5"> it's going to call home here in</font>

437
00:17:01,130 --> 00:17:06,410
a<font color="#CCCCCC"> couple</font><font color="#E5E5E5"> but couple minutes or an hour</font>

438
00:17:02,810 --> 00:17:07,879
<font color="#E5E5E5">whatever you said so there we got our</font>

439
00:17:06,410 --> 00:17:12,290
<font color="#E5E5E5">first show back and then here in a</font>

440
00:17:07,880 --> 00:17:13,400
second we should<font color="#CCCCCC"> get our second</font><font color="#E5E5E5"> one now</font>

441
00:17:12,290 --> 00:17:14,359
<font color="#E5E5E5">it will take</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit of time</font>

442
00:17:13,400 --> 00:17:16,819
depending<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> spunk server</font>

443
00:17:14,359 --> 00:17:19,040
<font color="#E5E5E5">configuration how often the agents check</font>

444
00:17:16,819 --> 00:17:21,319
in on everything else<font color="#CCCCCC"> set that's</font><font color="#E5E5E5"> why it</font>

445
00:17:19,040 --> 00:17:22,399
<font color="#E5E5E5">might take a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit longer but since</font>

446
00:17:21,319 --> 00:17:23,859
we're<font color="#CCCCCC"> in</font><font color="#E5E5E5"> admin we can change all that</font>

447
00:17:22,400 --> 00:17:29,300
<font color="#CCCCCC">too</font>

448
00:17:23,859 --> 00:17:30,709
and so there is our<font color="#E5E5E5"> seconds so now we</font>

449
00:17:29,300 --> 00:17:32,570
have<font color="#E5E5E5"> two shells in the environment but I</font>

450
00:17:30,710 --> 00:17:34,940
mean literally if there was 100 machines

451
00:17:32,570 --> 00:17:37,580
<font color="#E5E5E5">200 machines however</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> each machines</font>

452
00:17:34,940 --> 00:17:39,050
<font color="#CCCCCC">until Metasploit crashes really you</font>

453
00:17:37,580 --> 00:17:41,210
could just<font color="#E5E5E5"> keep getting shells back I</font>

454
00:17:39,050 --> 00:17:48,980
mean I've had 60 or 70 call back in

455
00:17:41,210 --> 00:17:50,480
matter<font color="#E5E5E5"> of five minutes so that's really</font>

456
00:17:48,980 --> 00:17:52,429
<font color="#E5E5E5">the cool stuff now</font><font color="#CCCCCC"> I actually want to</font>

457
00:17:50,480 --> 00:17:53,720
<font color="#E5E5E5">talk about the command control so we're</font>

458
00:17:52,429 --> 00:17:58,309
going to<font color="#E5E5E5"> be early</font><font color="#CCCCCC"> for lunch</font><font color="#E5E5E5"> would be</font>

459
00:17:53,720 --> 00:18:00,050
<font color="#E5E5E5">good um so I built</font><font color="#CCCCCC"> another application I</font>

460
00:17:58,309 --> 00:18:02,389
just call it weaponizing<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> and</font>

461
00:18:00,050 --> 00:18:05,149
<font color="#E5E5E5">basically what I'm starting</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do and</font>

462
00:18:02,390 --> 00:18:06,559
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> still work-in-progress</font><font color="#CCCCCC"> is what</font>

463
00:18:05,150 --> 00:18:08,090
we<font color="#E5E5E5"> will only do a pen test we you know</font>

464
00:18:06,559 --> 00:18:09,200
we have to run<font color="#CCCCCC"> nmap we have to run Nick</font>

465
00:18:08,090 --> 00:18:10,580
though we have to run all these

466
00:18:09,200 --> 00:18:11,809
different<font color="#CCCCCC"> tools</font><font color="#E5E5E5"> and every single tool</font>

467
00:18:10,580 --> 00:18:14,720
<font color="#CCCCCC">generates some sort of output</font>

468
00:18:11,809 --> 00:18:16,428
so<font color="#CCCCCC"> although</font><font color="#E5E5E5"> appends has denied this</font>

469
00:18:14,720 --> 00:18:18,020
really elaborate directory structure so

470
00:18:16,429 --> 00:18:19,370
<font color="#E5E5E5">I can organize</font><font color="#CCCCCC"> all this information</font><font color="#E5E5E5"> so</font>

471
00:18:18,020 --> 00:18:21,139
when I come back<font color="#E5E5E5"> to write the</font><font color="#CCCCCC"> report</font>

472
00:18:19,370 --> 00:18:22,219
<font color="#CCCCCC">that's going to take me another week and</font>

473
00:18:21,140 --> 00:18:23,510
a<font color="#CCCCCC"> half because I have to go through all</font>

474
00:18:22,220 --> 00:18:25,970
this stuff<font color="#CCCCCC"> and</font><font color="#E5E5E5"> all these all these</font><font color="#CCCCCC"> alts</font>

475
00:18:23,510 --> 00:18:30,320
data<font color="#E5E5E5"> what if we just shoved it all in</font>

476
00:18:25,970 --> 00:18:33,640
just<font color="#CCCCCC"> blink so right here I have a Wi-Fi</font>

477
00:18:30,320 --> 00:18:36,470
pineapple app is what we're<font color="#CCCCCC"> looking at</font>

478
00:18:33,640 --> 00:18:38,000
<font color="#E5E5E5">immediately in real time</font><font color="#CCCCCC"> I could run it</font>

479
00:18:36,470 --> 00:18:40,130
like a run<font color="#CCCCCC"> my Wi-Fi pineapple run my</font>

480
00:18:38,000 --> 00:18:41,780
attack on there but I have a universal

481
00:18:40,130 --> 00:18:43,070
<font color="#CCCCCC">foreigner installed so all those columns</font>

482
00:18:41,780 --> 00:18:44,720
are<font color="#E5E5E5"> coming right into</font><font color="#CCCCCC"> Splunk so if I</font>

483
00:18:43,070 --> 00:18:46,428
have<font color="#CCCCCC"> Splunk ups</font><font color="#E5E5E5"> and I have my pineapple</font>

484
00:18:44,720 --> 00:18:48,470
running in real time I know all the

485
00:18:46,429 --> 00:18:50,300
clients all<font color="#CCCCCC"> the SS IDs that I'm seeing I</font>

486
00:18:48,470 --> 00:18:51,860
have<font color="#CCCCCC"> a nice little pretty chart if I</font>

487
00:18:50,300 --> 00:18:53,928
wanted<font color="#E5E5E5"> to send that to the client as</font>

488
00:18:51,860 --> 00:18:55,189
well<font color="#E5E5E5"> all that stuff's already given</font><font color="#CCCCCC"> to</font>

489
00:18:53,929 --> 00:18:56,600
the in real time<font color="#E5E5E5"> there's no</font>

490
00:18:55,190 --> 00:18:58,550
forcing loans there's no going<font color="#CCCCCC"> back and</font>

491
00:18:56,600 --> 00:19:00,740
you know it actually<font color="#E5E5E5"> speeds up that</font>

492
00:18:58,550 --> 00:19:02,120
dwell time from running an attack and

493
00:19:00,740 --> 00:19:04,430
<font color="#CCCCCC">actually compromising moving laterally</font>

494
00:19:02,120 --> 00:19:06,469
into<font color="#CCCCCC"> the environment and another one</font>

495
00:19:04,430 --> 00:19:08,210
that<font color="#E5E5E5"> I have is responder so responder is</font>

496
00:19:06,470 --> 00:19:10,100
the man in the<font color="#E5E5E5"> middle tool that actually</font>

497
00:19:08,210 --> 00:19:12,320
<font color="#E5E5E5">will capture hashes through throughout</font>

498
00:19:10,100 --> 00:19:13,520
the environment<font color="#E5E5E5"> so in real time again I</font>

499
00:19:12,320 --> 00:19:15,020
would<font color="#E5E5E5"> have you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> I know how many</font>

500
00:19:13,520 --> 00:19:17,330
credentials<font color="#CCCCCC"> I have</font><font color="#E5E5E5"> know the user names</font>

501
00:19:15,020 --> 00:19:19,790
<font color="#CCCCCC">and other domains therefore another hash</font>

502
00:19:17,330 --> 00:19:21,860
type and then down at the<font color="#CCCCCC"> bottom I would</font>

503
00:19:19,790 --> 00:19:23,360
<font color="#E5E5E5">actually be able to just extract in a</font>

504
00:19:21,860 --> 00:19:24,679
nice little<font color="#E5E5E5"> text file all</font><font color="#CCCCCC"> the hashes</font>

505
00:19:23,360 --> 00:19:26,449
really quickly so I<font color="#CCCCCC"> can send it over to</font>

506
00:19:24,680 --> 00:19:30,800
<font color="#E5E5E5">my cracking</font><font color="#CCCCCC"> grave and again it just</font>

507
00:19:26,450 --> 00:19:33,020
<font color="#E5E5E5">decreases</font><font color="#CCCCCC"> that dwell time for you so big</font>

508
00:19:30,800 --> 00:19:34,790
<font color="#E5E5E5">gating actions obviously update update</font>

509
00:19:33,020 --> 00:19:36,950
your software<font color="#E5E5E5"> enable SSL change your</font>

510
00:19:34,790 --> 00:19:38,060
passwords<font color="#E5E5E5"> in 6.5 it's really nice</font>

511
00:19:36,950 --> 00:19:40,130
because they actually have two-factor

512
00:19:38,060 --> 00:19:41,690
authentication now with duo<font color="#E5E5E5"> so you could</font>

513
00:19:40,130 --> 00:19:43,370
do that all you have to do is change

514
00:19:41,690 --> 00:19:45,020
<font color="#CCCCCC">your password enable two-factor and that</font>

515
00:19:43,370 --> 00:19:45,500
literally stops everything<font color="#E5E5E5"> in here I'm</font>

516
00:19:45,020 --> 00:19:47,090
<font color="#CCCCCC">talking about</font>

517
00:19:45,500 --> 00:19:49,040
unless obviously there's password reuse

518
00:19:47,090 --> 00:19:52,429
or some other way that<font color="#E5E5E5"> I got that</font>

519
00:19:49,040 --> 00:19:54,620
<font color="#E5E5E5">password um don't run</font><font color="#CCCCCC"> Blanca's root</font><font color="#E5E5E5"> not</font>

520
00:19:52,430 --> 00:19:56,720
even<font color="#CCCCCC"> Universal forwarders I know it's a</font>

521
00:19:54,620 --> 00:19:59,419
pain<font color="#CCCCCC"> to configure them but take the time</font>

522
00:19:56,720 --> 00:20:00,890
it makes my<font color="#CCCCCC"> job harder segregate your</font>

523
00:19:59,420 --> 00:20:02,720
Splunk server on your network<font color="#CCCCCC"> don't</font>

524
00:20:00,890 --> 00:20:05,780
obviously<font color="#E5E5E5"> allow all the connections to</font>

525
00:20:02,720 --> 00:20:08,240
it<font color="#E5E5E5"> from everywhere i yet have seen have</font>

526
00:20:05,780 --> 00:20:10,129
seen anybody<font color="#E5E5E5"> knew that</font><font color="#CCCCCC"> i did have a guy</font>

527
00:20:08,240 --> 00:20:12,200
last weekend in Nashville<font color="#CCCCCC"> that</font><font color="#E5E5E5"> was</font>

528
00:20:10,130 --> 00:20:14,690
talking about he has it set up proper

529
00:20:12,200 --> 00:20:17,300
way<font color="#CCCCCC"> but he's the</font><font color="#E5E5E5"> first person</font><font color="#CCCCCC"> ever the</font>

530
00:20:14,690 --> 00:20:18,140
awesomes attaches here but a<font color="#E5E5E5"> segregated</font>

531
00:20:17,300 --> 00:20:19,730
on the network don't allow the

532
00:20:18,140 --> 00:20:21,350
connections and don't<font color="#E5E5E5"> runners</font><font color="#CCCCCC"> were</font>

533
00:20:19,730 --> 00:20:23,540
<font color="#E5E5E5">miserably it and then there's a really</font>

534
00:20:21,350 --> 00:20:25,370
<font color="#E5E5E5">nice guide it's about 30 pages long</font><font color="#CCCCCC"> but</font>

535
00:20:23,540 --> 00:20:28,730
<font color="#CCCCCC">go through that and actually</font><font color="#E5E5E5"> couldn't</font>

536
00:20:25,370 --> 00:20:31,790
figure<font color="#CCCCCC"> spell correctly</font><font color="#E5E5E5"> any questions I</font>

537
00:20:28,730 --> 00:20:33,470
<font color="#E5E5E5">mean that's pretty much it there is the</font>

538
00:20:31,790 --> 00:20:35,210
information<font color="#CCCCCC"> as I said github out</font>

539
00:20:33,470 --> 00:20:37,370
weaponizing spunk<font color="#E5E5E5"> amor</font><font color="#CCCCCC"> what a nice long</font>

540
00:20:35,210 --> 00:20:39,860
I think I bought domain so<font color="#E5E5E5"> they're close</font>

541
00:20:37,370 --> 00:20:42,879
to the same place<font color="#E5E5E5"> all the slides all the</font>

542
00:20:39,860 --> 00:20:42,879
<font color="#E5E5E5">videos what's up</font>

543
00:20:46,260 --> 00:20:51,090
I do<font color="#E5E5E5"> yep all you have to do is the same</font>

544
00:20:49,710 --> 00:20:52,290
<font color="#E5E5E5">way you we install them</font><font color="#CCCCCC"> all you got</font><font color="#E5E5E5"> to</font>

545
00:20:51,090 --> 00:21:04,409
do is<font color="#E5E5E5"> delete them and</font><font color="#CCCCCC"> spawn clock should</font>

546
00:20:52,290 --> 00:21:06,389
do all the cleanup for<font color="#E5E5E5"> you yep yeah</font>

547
00:21:04,410 --> 00:21:08,010
<font color="#E5E5E5">probably in the in this payload I mean</font>

548
00:21:06,390 --> 00:21:09,920
as I<font color="#E5E5E5"> said this</font><font color="#CCCCCC"> is all basic</font><font color="#E5E5E5"> palos these</font>

549
00:21:08,010 --> 00:21:12,540
should all be detected I would hope but

550
00:21:09,920 --> 00:21:13,890
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> yeah these are all basic</font>

551
00:21:12,540 --> 00:21:15,659
payloads<font color="#E5E5E5"> I highly suggest if you're</font>

552
00:21:13,890 --> 00:21:17,550
using<font color="#E5E5E5"> this in a real real engagement</font><font color="#CCCCCC"> I</font>

553
00:21:15,660 --> 00:21:19,050
would swap these out for<font color="#CCCCCC"> you know custom</font>

554
00:21:17,550 --> 00:21:21,230
things that you you<font color="#E5E5E5"> guys run with your</font>

555
00:21:19,050 --> 00:21:21,230
team

556
00:21:27,710 --> 00:21:30,710
yep

557
00:21:35,090 --> 00:21:39,449
exactly I keep forgetting<font color="#E5E5E5"> data slide</font>

558
00:21:38,040 --> 00:21:41,820
about that but yeah you could do<font color="#CCCCCC"> cleanup</font>

559
00:21:39,450 --> 00:21:43,740
as<font color="#E5E5E5"> well if there was anything that was</font>

560
00:21:41,820 --> 00:21:45,120
log<font color="#E5E5E5"> obviously these shells that are</font>

561
00:21:43,740 --> 00:21:46,410
executing on<font color="#CCCCCC"> the box</font><font color="#E5E5E5"> with all generate</font>

562
00:21:45,120 --> 00:21:48,000
Windows logs if those are all getting

563
00:21:46,410 --> 00:21:50,250
pulled into<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> yeah you could</font><font color="#CCCCCC"> just</font>

564
00:21:48,000 --> 00:21:52,170
do a search<font color="#CCCCCC"> for</font><font color="#E5E5E5"> pipe delete and now all</font>

565
00:21:50,250 --> 00:21:53,700
<font color="#CCCCCC">my traces are gone as</font><font color="#E5E5E5"> well now it</font>

566
00:21:52,170 --> 00:21:56,429
<font color="#E5E5E5">doesn't remove it from the box itself</font>

567
00:21:53,700 --> 00:21:58,110
<font color="#E5E5E5">just from</font><font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> so if somebody actually</font>

568
00:21:56,429 --> 00:22:03,690
did forensics<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> box they will</font><font color="#CCCCCC"> see</font>

569
00:21:58,110 --> 00:22:06,409
that<font color="#E5E5E5"> stuff anything</font><font color="#CCCCCC"> else all right</font><font color="#E5E5E5"> well</font>

570
00:22:03,690 --> 00:22:06,410
that's all<font color="#E5E5E5"> I got</font>

571
00:22:11,150 --> 00:22:16,200
I've built some reports for some of our

572
00:22:14,220 --> 00:22:18,240
<font color="#CCCCCC">customers that we do Splunk with but I</font>

573
00:22:16,200 --> 00:22:20,600
don't usually see that<font color="#E5E5E5"> happening</font><font color="#CCCCCC"> for</font>

574
00:22:18,240 --> 00:22:23,600
people<font color="#E5E5E5"> on so we do have some reports for</font>

575
00:22:20,600 --> 00:22:23,600
<font color="#E5E5E5">detecting</font>

