1
00:00:00,120 --> 00:00:03,120
foreign

2
00:00:06,020 --> 00:00:21,939
[Music]

3
00:00:23,000 --> 00:00:25,320
welcome to the session I'm glad all of

4
00:00:25,320 --> 00:00:27,779
you are here to hear me out um

5
00:00:27,779 --> 00:00:30,960
I know it's the session is on on a

6
00:00:30,960 --> 00:00:32,820
Sunday at 3 P.M so I'm gonna try and

7
00:00:32,820 --> 00:00:34,680
keep this as simple and as interesting

8
00:00:34,680 --> 00:00:36,899
as possible I can't promise this is

9
00:00:36,899 --> 00:00:38,399
going to be a short session

10
00:00:38,399 --> 00:00:39,120
um

11
00:00:39,120 --> 00:00:43,140
and um all right let's start

12
00:00:43,140 --> 00:00:45,180
before we begin

13
00:00:45,180 --> 00:00:47,160
um I'm today I'm going to talk about a

14
00:00:47,160 --> 00:00:49,800
very interesting apt called Lazarus for

15
00:00:49,800 --> 00:00:50,879
those of us that don't know about

16
00:00:50,879 --> 00:00:53,940
Lazarus it's affiliated with North Korea

17
00:00:53,940 --> 00:00:56,399
so what better thing to do on a Sunday

18
00:00:56,399 --> 00:00:58,620
afternoon than talk about North Korean

19
00:00:58,620 --> 00:01:01,500
apt right an apt that we all love in

20
00:01:01,500 --> 00:01:05,220
cherish before we begin for those of you

21
00:01:05,220 --> 00:01:06,720
that don't know me my name is ashir

22
00:01:06,720 --> 00:01:09,000
Malhotra I'm a threat researcher at

23
00:01:09,000 --> 00:01:11,640
Cisco Talos and I specialize in malware

24
00:01:11,640 --> 00:01:14,400
analysis threat intelligence and malware

25
00:01:14,400 --> 00:01:17,340
detection techniques this is my second

26
00:01:17,340 --> 00:01:21,180
time speaking at besides charm so yay

27
00:01:21,180 --> 00:01:24,170
all right thank you

28
00:01:24,170 --> 00:01:25,439
[Applause]

29
00:01:25,439 --> 00:01:27,060
and that's the end of my presentation

30
00:01:27,060 --> 00:01:29,780
thank you so much

31
00:01:30,420 --> 00:01:33,000
all right on the agenda today we are

32
00:01:33,000 --> 00:01:34,680
first going to talk about who and what

33
00:01:34,680 --> 00:01:37,200
Lazarus is then we're going to talk

34
00:01:37,200 --> 00:01:40,320
about a specific campaign that Lazarus

35
00:01:40,320 --> 00:01:42,420
conducted over the course of the past

36
00:01:42,420 --> 00:01:45,500
year in in 2022 I know there's some new

37
00:01:45,500 --> 00:01:48,420
disclosures in 2023 as well I'm not

38
00:01:48,420 --> 00:01:49,680
going to present on that but I'm going

39
00:01:49,680 --> 00:01:51,000
to certainly gonna talk to you about

40
00:01:51,000 --> 00:01:53,460
that if you guys want me to

41
00:01:53,460 --> 00:01:55,680
um so as part of this campaign that we

42
00:01:55,680 --> 00:01:59,159
disclosed uh from back in 2022

43
00:01:59,159 --> 00:02:01,619
um we discovered the kill chain that I'm

44
00:02:01,619 --> 00:02:02,700
going to illustrate today and I'm going

45
00:02:02,700 --> 00:02:05,040
to talk about their playbook as well I

46
00:02:05,040 --> 00:02:06,899
will give you specific examples of

47
00:02:06,899 --> 00:02:09,060
Hands-On keyboard activity that the

48
00:02:09,060 --> 00:02:11,220
operators from this APD group are known

49
00:02:11,220 --> 00:02:12,540
to perform

50
00:02:12,540 --> 00:02:13,920
now

51
00:02:13,920 --> 00:02:14,480
um

52
00:02:14,480 --> 00:02:16,980
Lazarus really likes building implants

53
00:02:16,980 --> 00:02:19,440
they build customized implants all the

54
00:02:19,440 --> 00:02:21,720
time and I'm gonna talk about three

55
00:02:21,720 --> 00:02:23,640
specific implants I promise it's going

56
00:02:23,640 --> 00:02:25,940
to be just three or maybe more

57
00:02:25,940 --> 00:02:29,760
but these three implants were pivotal to

58
00:02:29,760 --> 00:02:32,040
the success of their campaign and I'm

59
00:02:32,040 --> 00:02:34,620
gonna describe these three implants over

60
00:02:34,620 --> 00:02:36,780
the course of three different intrusion

61
00:02:36,780 --> 00:02:39,780
sets which were all part of the same

62
00:02:39,780 --> 00:02:40,860
campaign

63
00:02:40,860 --> 00:02:42,959
then we're going to end with some key

64
00:02:42,959 --> 00:02:44,760
takeaways and some summary slides

65
00:02:44,760 --> 00:02:45,720
because

66
00:02:45,720 --> 00:02:48,780
um I was told I have to do that so

67
00:02:48,780 --> 00:02:48,820
um

68
00:02:48,820 --> 00:02:51,959
[Music]

69
00:02:51,959 --> 00:02:54,300
but Lazarus is

70
00:02:54,300 --> 00:02:56,940
very good for those of us that don't

71
00:02:56,940 --> 00:02:58,440
know what Lazarus is all right hold on

72
00:02:58,440 --> 00:03:00,000
how many of you know what an apt group

73
00:03:00,000 --> 00:03:01,739
is

74
00:03:01,739 --> 00:03:04,560
sweet all right so for those of us that

75
00:03:04,560 --> 00:03:06,060
don't know what an APD group is it's

76
00:03:06,060 --> 00:03:08,760
called an advanced persistent threat uh

77
00:03:08,760 --> 00:03:10,800
it's a state-sponsored hacking group

78
00:03:10,800 --> 00:03:13,560
that usually has the support and funding

79
00:03:13,560 --> 00:03:15,540
of government organization or a

80
00:03:15,540 --> 00:03:17,280
government uh that belongs to a specific

81
00:03:17,280 --> 00:03:19,739
country and they perform a variety of

82
00:03:19,739 --> 00:03:23,459
attacks uh you know all working towards

83
00:03:23,459 --> 00:03:25,640
the benefit of a specific nation state

84
00:03:25,640 --> 00:03:28,200
Lazarus in particular also known as

85
00:03:28,200 --> 00:03:31,739
hidden Cobra APD 38 sometimes uh zinc

86
00:03:31,739 --> 00:03:33,900
also sometimes

87
00:03:33,900 --> 00:03:37,560
has been affiliated with North Korea by

88
00:03:37,560 --> 00:03:39,480
the industry far and wide it's been

89
00:03:39,480 --> 00:03:43,260
active since at least 2010. in terms of

90
00:03:43,260 --> 00:03:45,599
their goals they have a three-pronged

91
00:03:45,599 --> 00:03:47,459
approach they either conduct their

92
00:03:47,459 --> 00:03:51,060
campaigns to perform Espionage or for

93
00:03:51,060 --> 00:03:53,459
financial gain or to conduct disruptive

94
00:03:53,459 --> 00:03:54,659
attacks

95
00:03:54,659 --> 00:03:56,519
when it comes to the victimology of

96
00:03:56,519 --> 00:03:58,500
Lazarus everything is on the table all

97
00:03:58,500 --> 00:04:00,420
organizations are on the table they love

98
00:04:00,420 --> 00:04:01,980
to go after military organizations

99
00:04:01,980 --> 00:04:04,680
civilian government entities Finance

100
00:04:04,680 --> 00:04:07,319
media verticals critical infrastructure

101
00:04:07,319 --> 00:04:08,879
anything that they can get their hands

102
00:04:08,879 --> 00:04:10,319
on

103
00:04:10,319 --> 00:04:13,040
in terms of their distribution ttps

104
00:04:13,040 --> 00:04:15,919
tactics techniques and procedures

105
00:04:15,919 --> 00:04:18,120
throughout the course of the past decade

106
00:04:18,120 --> 00:04:22,019
or so Lazarus has been known to um use a

107
00:04:22,019 --> 00:04:23,460
variety of techniques to distribute

108
00:04:23,460 --> 00:04:25,680
their malware so this includes spear

109
00:04:25,680 --> 00:04:27,660
phishing attacks social engineering

110
00:04:27,660 --> 00:04:28,639
people

111
00:04:28,639 --> 00:04:30,780
exploitation of known vulnerabilities

112
00:04:30,780 --> 00:04:33,180
and then most recently they decided to

113
00:04:33,180 --> 00:04:35,699
get into the supply chain attack game as

114
00:04:35,699 --> 00:04:38,040
well you know this year

115
00:04:38,040 --> 00:04:40,280
in terms of their malware and tooling

116
00:04:40,280 --> 00:04:42,780
they love to create new malware all the

117
00:04:42,780 --> 00:04:44,220
time there's almost like one implant

118
00:04:44,220 --> 00:04:46,860
every year I'm going to talk about three

119
00:04:46,860 --> 00:04:49,460
of their implants that we saw recently

120
00:04:49,460 --> 00:04:53,400
magic rat Yama bot and V single and I'm

121
00:04:53,400 --> 00:04:54,540
going to describe that over the course

122
00:04:54,540 --> 00:04:58,199
of three intrusion sets that being said

123
00:04:58,199 --> 00:05:00,240
they also like to use a lot of Open

124
00:05:00,240 --> 00:05:01,560
Source tools and a lot of post

125
00:05:01,560 --> 00:05:03,360
exploitation Frameworks that are readily

126
00:05:03,360 --> 00:05:05,820
available out in the wild and I'm going

127
00:05:05,820 --> 00:05:07,320
to give a brief introduction about how

128
00:05:07,320 --> 00:05:09,060
they use it and you know what kind of

129
00:05:09,060 --> 00:05:11,520
tools they like to use

130
00:05:11,520 --> 00:05:13,020
all right let's talk about the campaign

131
00:05:13,020 --> 00:05:16,139
so this campaign that we discovered

132
00:05:16,139 --> 00:05:17,759
um back in early

133
00:05:17,759 --> 00:05:20,460
um 2022 and it made its way well into

134
00:05:20,460 --> 00:05:24,840
late 2022 as well uh was used to Target

135
00:05:24,840 --> 00:05:28,139
energy companies all across the world

136
00:05:28,139 --> 00:05:30,780
um the United States not North America

137
00:05:30,780 --> 00:05:33,120
and parts of Asia as well

138
00:05:33,120 --> 00:05:35,759
it consisted of three distinct intrusion

139
00:05:35,759 --> 00:05:37,860
sets well not distinct they were very

140
00:05:37,860 --> 00:05:40,440
similar uh in the way they were deployed

141
00:05:40,440 --> 00:05:42,960
but the key difference here was the

142
00:05:42,960 --> 00:05:44,759
implants the final payloads that were

143
00:05:44,759 --> 00:05:46,080
being distributed as part of each

144
00:05:46,080 --> 00:05:48,720
intrusion set in the first intrusion set

145
00:05:48,720 --> 00:05:51,180
we saw an implant called V single being

146
00:05:51,180 --> 00:05:54,240
deployed onto infected endpoints and

147
00:05:54,240 --> 00:05:56,699
this was an instance where only V single

148
00:05:56,699 --> 00:05:58,380
was deployed I'm going to talk about we

149
00:05:58,380 --> 00:06:00,240
single as well but I just wanted to give

150
00:06:00,240 --> 00:06:02,280
you guys an introduction about it and V

151
00:06:02,280 --> 00:06:03,960
single was extensively used for

152
00:06:03,960 --> 00:06:05,699
performing Hands-On keyboard activity

153
00:06:05,699 --> 00:06:06,960
you know for searching for stuff

154
00:06:06,960 --> 00:06:08,820
enumerating stuff pivoting lateral

155
00:06:08,820 --> 00:06:11,160
movement and so on and so forth in the

156
00:06:11,160 --> 00:06:13,380
second intrusion set we saw the use of V

157
00:06:13,380 --> 00:06:15,660
single along with another malware family

158
00:06:15,660 --> 00:06:18,180
called Magic rat and when we discovered

159
00:06:18,180 --> 00:06:20,460
magic rat it was previously undisclosed

160
00:06:20,460 --> 00:06:22,860
this was something new and um if you

161
00:06:22,860 --> 00:06:24,240
don't like the name you can blame me for

162
00:06:24,240 --> 00:06:26,639
it because I was the one who named it so

163
00:06:26,639 --> 00:06:28,080
um

164
00:06:28,080 --> 00:06:30,240
don't Don't Clap don't don't encourage

165
00:06:30,240 --> 00:06:32,360
me

166
00:06:33,539 --> 00:06:35,400
so what we saw in this intrusion set was

167
00:06:35,400 --> 00:06:37,380
that first of all we single was deployed

168
00:06:37,380 --> 00:06:39,360
and then the attackers for some reason

169
00:06:39,360 --> 00:06:40,979
decided that they didn't want to use

170
00:06:40,979 --> 00:06:42,720
when we single and that made way for

171
00:06:42,720 --> 00:06:45,600
magic rat and then magic rat became the

172
00:06:45,600 --> 00:06:48,000
de facto mechanism for long-term

173
00:06:48,000 --> 00:06:50,340
persistent access uh into that specific

174
00:06:50,340 --> 00:06:51,600
Network

175
00:06:51,600 --> 00:06:54,060
in the third intrusion set we saw the

176
00:06:54,060 --> 00:06:56,639
use of V single along with yet another

177
00:06:56,639 --> 00:07:01,139
malware implant called yamabot now this

178
00:07:01,139 --> 00:07:02,940
was not because this was not by choice

179
00:07:02,940 --> 00:07:04,560
the deployment of Yama bot was not by

180
00:07:04,560 --> 00:07:06,120
choice as soon as they deployed we

181
00:07:06,120 --> 00:07:08,340
single it was detected they were like uh

182
00:07:08,340 --> 00:07:10,259
crap we gotta find something else so

183
00:07:10,259 --> 00:07:12,060
that is when they brought in yamabad and

184
00:07:12,060 --> 00:07:13,919
they started using that specific piece

185
00:07:13,919 --> 00:07:16,020
of malware for long-term persistent

186
00:07:16,020 --> 00:07:17,280
access

187
00:07:17,280 --> 00:07:19,560
all right let's go back now let's see

188
00:07:19,560 --> 00:07:22,139
how this uh entire cyber kitchen works

189
00:07:22,139 --> 00:07:24,599
and how this infection chain works

190
00:07:24,599 --> 00:07:27,780
all started with the exploitation of

191
00:07:27,780 --> 00:07:32,099
public facing vulnerable VMware servers

192
00:07:32,099 --> 00:07:34,440
they exploited the log 4J vulnerability

193
00:07:34,440 --> 00:07:37,020
you guys remember log4j

194
00:07:37,020 --> 00:07:40,139
all right and that a successful

195
00:07:40,139 --> 00:07:42,060
exploitation of the VMware servers then

196
00:07:42,060 --> 00:07:44,639
led to the establishment of a reverse

197
00:07:44,639 --> 00:07:46,740
shell they perform some preliminary

198
00:07:46,740 --> 00:07:49,800
tasks and then they went on to deploy

199
00:07:49,800 --> 00:07:51,860
customized implants

200
00:07:51,860 --> 00:07:54,060
these customized implants were as I said

201
00:07:54,060 --> 00:07:56,940
be single magic rat and Yamaha what

202
00:07:56,940 --> 00:07:58,800
um then they decided to start

203
00:07:58,800 --> 00:08:02,460
instrumenting the custom implants to

204
00:08:02,460 --> 00:08:04,800
carry out a variety of activities on the

205
00:08:04,800 --> 00:08:06,599
infected endpoints and in the infected

206
00:08:06,599 --> 00:08:09,000
organizations this included creation of

207
00:08:09,000 --> 00:08:11,699
backdoor user accounts creating reverse

208
00:08:11,699 --> 00:08:12,680
tunnels

209
00:08:12,680 --> 00:08:15,360
lateral movement data exfiltration and

210
00:08:15,360 --> 00:08:16,740
so on and so forth

211
00:08:16,740 --> 00:08:19,259
so basically the whole deal

212
00:08:19,259 --> 00:08:22,800
now before we get into uh the typical

213
00:08:22,800 --> 00:08:24,180
infection chain I just want to present

214
00:08:24,180 --> 00:08:25,500
it a different way I want to talk about

215
00:08:25,500 --> 00:08:27,960
disabling defenses

216
00:08:27,960 --> 00:08:29,819
um you know in this day and age it

217
00:08:29,819 --> 00:08:32,700
sounds very rudimentary but it's it's an

218
00:08:32,700 --> 00:08:35,640
essential step that threat actors across

219
00:08:35,640 --> 00:08:37,559
the world any mature threat actor across

220
00:08:37,559 --> 00:08:39,479
the world certainly does in one form or

221
00:08:39,479 --> 00:08:42,120
the other and that's what Lazarus did as

222
00:08:42,120 --> 00:08:43,320
well you know they try to get

223
00:08:43,320 --> 00:08:46,020
information about antivirus products and

224
00:08:46,020 --> 00:08:47,160
then you know they try to disable

225
00:08:47,160 --> 00:08:48,839
real-time monitoring try to create

226
00:08:48,839 --> 00:08:51,000
exclusions and so on and so forth is

227
00:08:51,000 --> 00:08:53,220
just preliminary tasks that they want to

228
00:08:53,220 --> 00:08:55,800
do before they actually introduce their

229
00:08:55,800 --> 00:08:58,920
custom built precious implants on an

230
00:08:58,920 --> 00:09:01,620
infected endpoint

231
00:09:01,620 --> 00:09:03,300
all right this is again what a typical

232
00:09:03,300 --> 00:09:05,220
infection chain looks like

233
00:09:05,220 --> 00:09:05,820
um

234
00:09:05,820 --> 00:09:07,500
the reason why I wanted to show you this

235
00:09:07,500 --> 00:09:09,720
diagram is because

236
00:09:09,720 --> 00:09:12,540
they didn't just use their customized

237
00:09:12,540 --> 00:09:15,120
implants uh for performing malicious

238
00:09:15,120 --> 00:09:17,880
activities on an endpoint they also used

239
00:09:17,880 --> 00:09:19,980
a variety of Open Source tools you know

240
00:09:19,980 --> 00:09:22,200
something like impact it and and the

241
00:09:22,200 --> 00:09:24,120
reason why they used it is because uh

242
00:09:24,120 --> 00:09:26,640
between the custom implants and the open

243
00:09:26,640 --> 00:09:29,360
source tools there's like a 50 50 split

244
00:09:29,360 --> 00:09:31,680
in terms of capabilities you know

245
00:09:31,680 --> 00:09:33,300
something that the customized implant

246
00:09:33,300 --> 00:09:35,399
can do the open source tool may not be

247
00:09:35,399 --> 00:09:37,140
able to do and vice versa something that

248
00:09:37,140 --> 00:09:38,940
the open source tool can do the implant

249
00:09:38,940 --> 00:09:41,100
might not be able to do so they

250
00:09:41,100 --> 00:09:43,500
basically tried to make this a symbiotic

251
00:09:43,500 --> 00:09:46,380
relationship and um work both these

252
00:09:46,380 --> 00:09:47,820
components in conjunction with each

253
00:09:47,820 --> 00:09:50,100
other in order to carry out a number of

254
00:09:50,100 --> 00:09:52,260
different activities

255
00:09:52,260 --> 00:09:54,540
all right let's talk about V single

256
00:09:54,540 --> 00:09:56,820
first the reason I want to talk about V

257
00:09:56,820 --> 00:09:59,279
single is because we saw a lot of

258
00:09:59,279 --> 00:10:02,760
Hands-On capability uh activity being

259
00:10:02,760 --> 00:10:06,420
performed via V single now B single is a

260
00:10:06,420 --> 00:10:08,339
malware family it's basically a rat

261
00:10:08,339 --> 00:10:09,320
family

262
00:10:09,320 --> 00:10:13,019
that on first look looks like another

263
00:10:13,019 --> 00:10:15,779
Lazarus family called d-track and D

264
00:10:15,779 --> 00:10:17,940
track is very popular with Lazarus you

265
00:10:17,940 --> 00:10:19,279
know they use it in a plethora of

266
00:10:19,279 --> 00:10:21,480
campaigns against different entities all

267
00:10:21,480 --> 00:10:23,399
across the world and when I started

268
00:10:23,399 --> 00:10:25,140
analyzing this um

269
00:10:25,140 --> 00:10:28,380
I realized that this is probably retract

270
00:10:28,380 --> 00:10:30,720
and then I started to peel across the

271
00:10:30,720 --> 00:10:32,100
layers and everything and then we found

272
00:10:32,100 --> 00:10:34,440
out that this was uh in fact V single

273
00:10:34,440 --> 00:10:36,420
which is a completely different implant

274
00:10:36,420 --> 00:10:39,240
from uh d-track

275
00:10:39,240 --> 00:10:42,600
d-track has two major categories of

276
00:10:42,600 --> 00:10:44,880
capabilities the first one is that it

277
00:10:44,880 --> 00:10:46,740
can create a reverse shell it's going to

278
00:10:46,740 --> 00:10:49,820
basically spawn a command dot

279
00:10:49,820 --> 00:10:53,040
execmd.exe process is gonna start

280
00:10:53,040 --> 00:10:55,620
talking to it via named pipes and

281
00:10:55,620 --> 00:10:57,240
anything that it writes and reads it can

282
00:10:57,240 --> 00:10:58,860
send out to the command and control

283
00:10:58,860 --> 00:11:00,380
server

284
00:11:00,380 --> 00:11:03,120
this is a very basic reverse shell and

285
00:11:03,120 --> 00:11:04,680
this has been very popular for the

286
00:11:04,680 --> 00:11:07,200
longest time we we've seen these kind of

287
00:11:07,200 --> 00:11:09,060
reversials from the days of apt-1 as

288
00:11:09,060 --> 00:11:12,240
well another functionality that V single

289
00:11:12,240 --> 00:11:14,279
has is that it has the ability to deploy

290
00:11:14,279 --> 00:11:16,019
plugins and when I say plugins that

291
00:11:16,019 --> 00:11:18,420
means additional payloads in this case V

292
00:11:18,420 --> 00:11:20,579
single was able to deploy additional

293
00:11:20,579 --> 00:11:22,980
payloads in the form of in-memory Shell

294
00:11:22,980 --> 00:11:24,720
Code you know it goes out to the C2

295
00:11:24,720 --> 00:11:26,100
server and it says hey I need something

296
00:11:26,100 --> 00:11:28,680
to run and my processes memory and then

297
00:11:28,680 --> 00:11:31,019
send it a Shell Code that it runs inside

298
00:11:31,019 --> 00:11:33,779
of its own process and then it also had

299
00:11:33,779 --> 00:11:35,399
the ability to run certain different

300
00:11:35,399 --> 00:11:37,860
types of scripts so VB scripts

301
00:11:37,860 --> 00:11:39,540
javascripts and Powershell scripts I

302
00:11:39,540 --> 00:11:41,760
guess that it could get from the server

303
00:11:41,760 --> 00:11:44,579
and start to execute on the infected

304
00:11:44,579 --> 00:11:48,360
endpoint the use of plugins is uh and

305
00:11:48,360 --> 00:11:50,700
this is something of node if you've been

306
00:11:50,700 --> 00:11:54,060
following Lazarus for as long as I have

307
00:11:54,060 --> 00:11:56,760
um the use of plugins in customized

308
00:11:56,760 --> 00:11:59,700
implants is very typical of Lazarus they

309
00:11:59,700 --> 00:12:01,440
like to do this they like to have a

310
00:12:01,440 --> 00:12:03,540
modular structure and we've seen this in

311
00:12:03,540 --> 00:12:05,399
the past as well

312
00:12:05,399 --> 00:12:08,339
um Sometimes some of their plugins are

313
00:12:08,339 --> 00:12:10,380
also ransomware so that's something to

314
00:12:10,380 --> 00:12:12,600
keep in mind

315
00:12:12,600 --> 00:12:14,640
all right so we have V single installed

316
00:12:14,640 --> 00:12:16,560
on the system what happens next right

317
00:12:16,560 --> 00:12:18,720
the the attackers have compromised the

318
00:12:18,720 --> 00:12:20,760
box they've done their preliminary

319
00:12:20,760 --> 00:12:22,740
actions they've disabled protections

320
00:12:22,740 --> 00:12:24,959
they've deployed V single what happens

321
00:12:24,959 --> 00:12:27,899
next what happens next is a series of

322
00:12:27,899 --> 00:12:30,000
Hands-On keyboard activity the first

323
00:12:30,000 --> 00:12:31,380
thing they do is they perform additional

324
00:12:31,380 --> 00:12:33,540
reconnaissance you know the usual CIS

325
00:12:33,540 --> 00:12:36,660
config ipconfig they query the user

326
00:12:36,660 --> 00:12:38,100
accounts they try to enumerate

327
00:12:38,100 --> 00:12:40,380
directories to find a list of installed

328
00:12:40,380 --> 00:12:42,779
programs they even run the time command

329
00:12:42,779 --> 00:12:44,760
to get an idea of what the time zone is

330
00:12:44,760 --> 00:12:46,399
and so on and so forth you know

331
00:12:46,399 --> 00:12:49,200
basically this this is an attempt to

332
00:12:49,200 --> 00:12:50,760
fingerprint and profile the system

333
00:12:50,760 --> 00:12:52,560
before they take any further actions on

334
00:12:52,560 --> 00:12:54,240
it

335
00:12:54,240 --> 00:12:56,579
if they think that the system is worth

336
00:12:56,579 --> 00:12:58,740
having access to they will start

337
00:12:58,740 --> 00:13:02,100
creating mechanisms for

338
00:13:02,100 --> 00:13:04,560
um sorry alternate mechanisms for

339
00:13:04,560 --> 00:13:07,200
maintaining that access and what they

340
00:13:07,200 --> 00:13:08,940
basically do is they will create reverse

341
00:13:08,940 --> 00:13:11,639
shells and they will also start creating

342
00:13:11,639 --> 00:13:14,220
backdoor user accounts which they will

343
00:13:14,220 --> 00:13:17,399
then give administrative privileges so

344
00:13:17,399 --> 00:13:20,160
that in case their customized implant is

345
00:13:20,160 --> 00:13:22,079
burnt or if it's not able to talk to the

346
00:13:22,079 --> 00:13:23,940
command and control server they don't

347
00:13:23,940 --> 00:13:25,560
have to reinfect the Box all over again

348
00:13:25,560 --> 00:13:27,300
they already have access and they might

349
00:13:27,300 --> 00:13:31,160
just be able to Art appeal to it

350
00:13:31,320 --> 00:13:35,160
they also in the course of this campaign

351
00:13:35,160 --> 00:13:38,839
Lazarus also had a very special focus on

352
00:13:38,839 --> 00:13:42,300
harvesting credentials so um they would

353
00:13:42,300 --> 00:13:45,540
use the VSS command utility to um get a

354
00:13:45,540 --> 00:13:47,940
shadow volume copy and then they would

355
00:13:47,940 --> 00:13:51,660
extract the ntds.dit file and they would

356
00:13:51,660 --> 00:13:53,279
just exfiltrate it out using their

357
00:13:53,279 --> 00:13:55,399
customized implant

358
00:13:55,399 --> 00:13:58,560
ntds is is a file that contains active

359
00:13:58,560 --> 00:14:00,180
directory information including a lot of

360
00:14:00,180 --> 00:14:02,339
credentials as well so that's something

361
00:14:02,339 --> 00:14:04,200
that they can extract out of the ntds

362
00:14:04,200 --> 00:14:05,940
file and then use their own time to

363
00:14:05,940 --> 00:14:08,339
crack those passwords or you know

364
00:14:08,339 --> 00:14:13,320
exploit it via past the hash oops sorry

365
00:14:13,320 --> 00:14:15,240
and then of course they have the lateral

366
00:14:15,240 --> 00:14:16,200
movement

367
00:14:16,200 --> 00:14:18,440
um if they are interested in the network

368
00:14:18,440 --> 00:14:22,019
they will start performing lateral

369
00:14:22,019 --> 00:14:23,760
movement and in order to do that they

370
00:14:23,760 --> 00:14:26,160
will do a ton of active directory

371
00:14:26,160 --> 00:14:28,320
reconnaissance the commands here are

372
00:14:28,320 --> 00:14:30,060
mostly uh

373
00:14:30,060 --> 00:14:32,940
querying uh the system and the active

374
00:14:32,940 --> 00:14:34,920
directory to find information about the

375
00:14:34,920 --> 00:14:36,600
users and the domain and the computers

376
00:14:36,600 --> 00:14:38,639
and stuff like that and then they will

377
00:14:38,639 --> 00:14:40,800
use something like impact it or Ps exact

378
00:14:40,800 --> 00:14:43,440
to Pivot off and get on another box and

379
00:14:43,440 --> 00:14:45,120
you know so on and so forth they will

380
00:14:45,120 --> 00:14:47,760
just go on and on and on

381
00:14:47,760 --> 00:14:50,040
am I going too fast

382
00:14:50,040 --> 00:14:52,560
all right cool perfect

383
00:14:52,560 --> 00:14:54,420
um so I'm going to talk about Yama what

384
00:14:54,420 --> 00:14:55,260
next

385
00:14:55,260 --> 00:14:57,660
um this was seen in intrusion set three

386
00:14:57,660 --> 00:14:59,579
remember so basically what we've done up

387
00:14:59,579 --> 00:15:01,079
till now is we've talked about intrusion

388
00:15:01,079 --> 00:15:03,360
set one and we've talked about a lot of

389
00:15:03,360 --> 00:15:05,880
Hands-On keyboard activity

390
00:15:05,880 --> 00:15:07,500
um I don't want to talk about victim 2

391
00:15:07,500 --> 00:15:09,600
yet I want to talk about victim three

392
00:15:09,600 --> 00:15:13,560
first of all in victim three we saw the

393
00:15:13,560 --> 00:15:16,519
usage of yamabot

394
00:15:16,519 --> 00:15:19,260
and it was a very clear match you know

395
00:15:19,260 --> 00:15:21,240
the samples that we found

396
00:15:21,240 --> 00:15:24,180
um were Yama bought they were attributed

397
00:15:24,180 --> 00:15:26,519
to Lazarus by the Japanese cert I think

398
00:15:26,519 --> 00:15:30,540
in 2022 as well it's a very typical rat

399
00:15:30,540 --> 00:15:33,000
malware family there's nothing very

400
00:15:33,000 --> 00:15:35,339
special about it but it consists of a

401
00:15:35,339 --> 00:15:37,560
lot of features that you see in a lot of

402
00:15:37,560 --> 00:15:40,620
commodity rats out there in the wild

403
00:15:40,620 --> 00:15:43,760
it's also golang based so um you know

404
00:15:43,760 --> 00:15:46,860
that that gives us an indication that um

405
00:15:46,860 --> 00:15:49,380
Lazarus likes to experiment with

406
00:15:49,380 --> 00:15:50,820
different platforms

407
00:15:50,820 --> 00:15:54,060
and um and and different Frameworks and

408
00:15:54,060 --> 00:15:58,680
that is what brings us to Magic rat

409
00:15:58,680 --> 00:16:00,660
all right I'm going to take a moment for

410
00:16:00,660 --> 00:16:02,220
you to look at the really cool graphic

411
00:16:02,220 --> 00:16:04,680
that my Graphics team made

412
00:16:04,680 --> 00:16:05,899
um

413
00:16:05,899 --> 00:16:09,540
it looks magical right all right so

414
00:16:09,540 --> 00:16:10,920
magic rat

415
00:16:10,920 --> 00:16:13,860
um magic rat was first uh created in

416
00:16:13,860 --> 00:16:16,980
April 2022 and then subsequently we saw

417
00:16:16,980 --> 00:16:19,320
it being deployed a month later uh in

418
00:16:19,320 --> 00:16:21,300
May 2022

419
00:16:21,300 --> 00:16:23,339
what was really really interesting about

420
00:16:23,339 --> 00:16:26,339
this malware family is that it uses the

421
00:16:26,339 --> 00:16:29,100
QT framework do you all know what the QT

422
00:16:29,100 --> 00:16:30,600
framework is

423
00:16:30,600 --> 00:16:31,860
all right I'm going to tell you what the

424
00:16:31,860 --> 00:16:34,699
QD framework is after some time not yet

425
00:16:34,699 --> 00:16:37,259
basically what it did was it would take

426
00:16:37,259 --> 00:16:39,660
this framework the software development

427
00:16:39,660 --> 00:16:42,720
framework and it would uh statically

428
00:16:42,720 --> 00:16:45,360
link that framework into its own binary

429
00:16:45,360 --> 00:16:47,160
so there's like an entire framework

430
00:16:47,160 --> 00:16:49,440
that's embedded inside an exe file or a

431
00:16:49,440 --> 00:16:52,560
dll file and that that makes it like

432
00:16:52,560 --> 00:16:54,420
more than a few megabytes to be honest

433
00:16:54,420 --> 00:16:56,220
it's like a huge file

434
00:16:56,220 --> 00:16:57,120
um

435
00:16:57,120 --> 00:17:00,060
magic rat extensively used the QT

436
00:17:00,060 --> 00:17:01,920
framework which

437
00:17:01,920 --> 00:17:04,500
um you know they used the settings uh

438
00:17:04,500 --> 00:17:06,419
and configuration mechanism in the in

439
00:17:06,419 --> 00:17:08,400
the QT framework to hold different

440
00:17:08,400 --> 00:17:10,439
configurations

441
00:17:10,439 --> 00:17:12,299
um the first set of configurations that

442
00:17:12,299 --> 00:17:13,919
you see I know it's a little small but

443
00:17:13,919 --> 00:17:15,540
it's uh basically

444
00:17:15,540 --> 00:17:20,579
a preamble followed by b64 encoded uh C2

445
00:17:20,579 --> 00:17:22,079
URLs

446
00:17:22,079 --> 00:17:24,059
um that the rat actually goes out and

447
00:17:24,059 --> 00:17:26,579
talks to and then these settings also

448
00:17:26,579 --> 00:17:29,460
and these configurations also store the

449
00:17:29,460 --> 00:17:31,080
replies from the command control server

450
00:17:31,080 --> 00:17:32,640
and victim identification information

451
00:17:32,640 --> 00:17:35,100
and so on and so forth

452
00:17:35,100 --> 00:17:38,160
in terms of persistence magic rat is

453
00:17:38,160 --> 00:17:40,140
very simple it has the ability to create

454
00:17:40,140 --> 00:17:42,179
schedule tasks on the system it also has

455
00:17:42,179 --> 00:17:43,980
the ability to create a link file a

456
00:17:43,980 --> 00:17:46,380
shortcut file in the startup folder very

457
00:17:46,380 --> 00:17:48,840
simple to be honest

458
00:17:48,840 --> 00:17:51,059
C2 communication is also very very

459
00:17:51,059 --> 00:17:54,600
simple C2 is command control server

460
00:17:54,600 --> 00:17:56,580
basically it sends out a beacon and says

461
00:17:56,580 --> 00:17:58,799
hey I'm alive I'm going to send you some

462
00:17:58,799 --> 00:18:00,539
more information about this box and then

463
00:18:00,539 --> 00:18:02,700
you tell me what I need to do after that

464
00:18:02,700 --> 00:18:05,280
and that's basically as simple as it

465
00:18:05,280 --> 00:18:08,520
gets it's HTTP based um so um it's it's

466
00:18:08,520 --> 00:18:10,380
not really very complicated

467
00:18:10,380 --> 00:18:12,840
um the communication

468
00:18:12,840 --> 00:18:15,120
in terms of capabilities

469
00:18:15,120 --> 00:18:18,600
um it's it's it's a feature Rich rat but

470
00:18:18,600 --> 00:18:20,460
it's also very simple it has the ability

471
00:18:20,460 --> 00:18:23,100
to download and execute files it can

472
00:18:23,100 --> 00:18:25,860
exfiltrate uh data it can self-delete

473
00:18:25,860 --> 00:18:28,919
itself it can create a remote shell uh

474
00:18:28,919 --> 00:18:30,360
you remember I spoke about about the

475
00:18:30,360 --> 00:18:32,880
reverse shells in in V single it's it's

476
00:18:32,880 --> 00:18:34,440
very similar it has a very similar

477
00:18:34,440 --> 00:18:37,080
capability it also has the capability to

478
00:18:37,080 --> 00:18:38,520
switch between command and control

479
00:18:38,520 --> 00:18:40,140
servers

480
00:18:40,140 --> 00:18:41,820
so the command and control server will

481
00:18:41,820 --> 00:18:43,500
send it a new value and say hey you've

482
00:18:43,500 --> 00:18:45,299
got to stop talking to me now and you

483
00:18:45,299 --> 00:18:47,700
now have to talk to a new server and the

484
00:18:47,700 --> 00:18:48,960
rat is going to be like all right cool

485
00:18:48,960 --> 00:18:50,160
I'm gonna I'm just going to switch over

486
00:18:50,160 --> 00:18:52,679
Communications and basically that's how

487
00:18:52,679 --> 00:18:54,600
it works

488
00:18:54,600 --> 00:18:55,919
all right let's talk about the QD

489
00:18:55,919 --> 00:18:59,220
framework so the QT framework is

490
00:18:59,220 --> 00:19:01,919
advertised as a cross platform framework

491
00:19:01,919 --> 00:19:05,400
for creating a variety of applications

492
00:19:05,400 --> 00:19:07,679
it's a very popular framework when it

493
00:19:07,679 --> 00:19:09,720
comes to creating a graphical user

494
00:19:09,720 --> 00:19:11,940
interface based applications uh you know

495
00:19:11,940 --> 00:19:14,160
desktop applications

496
00:19:14,160 --> 00:19:16,740
um and there's a it's it's extremely

497
00:19:16,740 --> 00:19:18,900
extremely popular to be honest

498
00:19:18,900 --> 00:19:19,500
um

499
00:19:19,500 --> 00:19:22,020
uh how many of you have used uh Ollie

500
00:19:22,020 --> 00:19:23,700
debug

501
00:19:23,700 --> 00:19:26,039
yeah only debug I think uses the QD

502
00:19:26,039 --> 00:19:28,980
framework in some form or the other

503
00:19:28,980 --> 00:19:31,860
the advantage that the QT framework

504
00:19:31,860 --> 00:19:33,179
brings

505
00:19:33,179 --> 00:19:33,960
um

506
00:19:33,960 --> 00:19:36,360
to a malware uh I don't I don't want to

507
00:19:36,360 --> 00:19:37,620
say that but now I can't find better

508
00:19:37,620 --> 00:19:41,280
words is that uh or or to the developer

509
00:19:41,280 --> 00:19:43,919
of a specific application is that it

510
00:19:43,919 --> 00:19:46,020
allows the developer to be agnostic of

511
00:19:46,020 --> 00:19:48,900
the platform the underlying platform uh

512
00:19:48,900 --> 00:19:52,440
for example windows apis or Linux or Mac

513
00:19:52,440 --> 00:19:56,220
OS calls and all the developer has to do

514
00:19:56,220 --> 00:19:59,280
is understand and figure out how the QT

515
00:19:59,280 --> 00:20:02,100
framework works and how to call the qut

516
00:20:02,100 --> 00:20:04,200
Frameworks apis instead of calling the

517
00:20:04,200 --> 00:20:07,020
platforms apis and that's all they need

518
00:20:07,020 --> 00:20:09,480
to do and then that also gives the

519
00:20:09,480 --> 00:20:12,059
developer the ability to Port their

520
00:20:12,059 --> 00:20:14,760
applications and to Port their code

521
00:20:14,760 --> 00:20:16,740
um to different platforms you know they

522
00:20:16,740 --> 00:20:18,299
just have to write code once and then

523
00:20:18,299 --> 00:20:20,280
they can compile it for Windows Linux

524
00:20:20,280 --> 00:20:23,280
Mac OS and so on and so forth this is an

525
00:20:23,280 --> 00:20:25,679
example of the malware of magic rat uh

526
00:20:25,679 --> 00:20:27,660
using network calls to communicate with

527
00:20:27,660 --> 00:20:29,520
its C2 server

528
00:20:29,520 --> 00:20:31,679
and then this is an example of the

529
00:20:31,679 --> 00:20:35,700
process creation mechanism that it uses

530
00:20:35,700 --> 00:20:37,559
I know I don't understand it either to

531
00:20:37,559 --> 00:20:38,760
be honest

532
00:20:38,760 --> 00:20:41,760
I'm the one who analyzed it so

533
00:20:41,760 --> 00:20:43,620
all right so that brings us to the

534
00:20:43,620 --> 00:20:46,200
question why would they use the QT

535
00:20:46,200 --> 00:20:47,700
framework are there certain advantages

536
00:20:47,700 --> 00:20:49,620
to using the QD framework and I'm not

537
00:20:49,620 --> 00:20:51,960
advertising using this in malware by the

538
00:20:51,960 --> 00:20:53,480
way all right

539
00:20:53,480 --> 00:20:56,760
the very first Advantage that the

540
00:20:56,760 --> 00:21:00,240
attackers have is that it makes my life

541
00:21:00,240 --> 00:21:02,400
more difficult it makes a researcher

542
00:21:02,400 --> 00:21:04,919
analysis way more cumbersome especially

543
00:21:04,919 --> 00:21:07,559
if you have an um like an eight megabyte

544
00:21:07,559 --> 00:21:09,179
exe and you have to sift through

545
00:21:09,179 --> 00:21:11,160
different lines of code and figure out

546
00:21:11,160 --> 00:21:12,840
what is a library and what is user code

547
00:21:12,840 --> 00:21:14,820
and then in turn you have to figure out

548
00:21:14,820 --> 00:21:17,100
how the apis work and how the structures

549
00:21:17,100 --> 00:21:19,440
are structured and stuff like that it's

550
00:21:19,440 --> 00:21:21,720
also designed to be highly performant I

551
00:21:21,720 --> 00:21:23,100
don't really think the attackers scared

552
00:21:23,100 --> 00:21:24,900
about that but they did use the

553
00:21:24,900 --> 00:21:27,720
multi-threading implementation to you

554
00:21:27,720 --> 00:21:29,159
know have different threads talk to each

555
00:21:29,159 --> 00:21:30,360
other

556
00:21:30,360 --> 00:21:34,380
QT is also highly portable as I said so

557
00:21:34,380 --> 00:21:37,140
we believe that the intention was to

558
00:21:37,140 --> 00:21:41,159
create Magic rat and then deploy it have

559
00:21:41,159 --> 00:21:43,500
it ready for deployment on Windows Linux

560
00:21:43,500 --> 00:21:44,880
and Mac OS wherever the attack is

561
00:21:44,880 --> 00:21:45,960
software

562
00:21:45,960 --> 00:21:47,820
so far we've only seen a Windows version

563
00:21:47,820 --> 00:21:49,980
of it so

564
00:21:49,980 --> 00:21:50,760
um

565
00:21:50,760 --> 00:21:53,460
I might be wrong yeah

566
00:21:53,460 --> 00:21:55,799
also as Defenders uh

567
00:21:55,799 --> 00:21:58,559
we have to ask this question is this an

568
00:21:58,559 --> 00:22:00,419
evasion mechanism is the QT framework

569
00:22:00,419 --> 00:22:02,640
Innovation mechanism

570
00:22:02,640 --> 00:22:03,480
um

571
00:22:03,480 --> 00:22:05,280
how many of you have seen the QT

572
00:22:05,280 --> 00:22:07,500
framework being used in malware I've

573
00:22:07,500 --> 00:22:08,820
never seen it being used in America

574
00:22:08,820 --> 00:22:11,280
you've seen it

575
00:22:11,280 --> 00:22:12,500
all right

576
00:22:12,500 --> 00:22:14,600
so

577
00:22:14,600 --> 00:22:17,159
there is also the possibility that the

578
00:22:17,159 --> 00:22:19,700
QT framework was included you know magic

579
00:22:19,700 --> 00:22:23,100
magic rat was built on the QT framework

580
00:22:23,100 --> 00:22:27,179
to evade heuristic detection mechanisms

581
00:22:27,179 --> 00:22:28,200
um you know there's always that

582
00:22:28,200 --> 00:22:30,539
possibility as well

583
00:22:30,539 --> 00:22:32,520
all right so we've spoken about three

584
00:22:32,520 --> 00:22:34,020
racks and I promised I wouldn't talk

585
00:22:34,020 --> 00:22:38,220
about another act uh but I have to so so

586
00:22:38,220 --> 00:22:40,799
far we've talked about we single and

587
00:22:40,799 --> 00:22:44,460
yamabot and Magic rat and there is yet

588
00:22:44,460 --> 00:22:46,559
another ad did I tell you that Lazarus

589
00:22:46,559 --> 00:22:49,700
loves creating new implants

590
00:22:49,700 --> 00:22:54,000
tiger rat is uh yet another implant that

591
00:22:54,000 --> 00:22:56,460
we discovered that had infrastructure

592
00:22:56,460 --> 00:22:58,020
overlap with magic rat basically we

593
00:22:58,020 --> 00:23:00,539
found a C2 server for Magic Rack that

594
00:23:00,539 --> 00:23:03,419
also hosted tiger ad

595
00:23:03,419 --> 00:23:05,280
um tiger rat is a tried and tested

596
00:23:05,280 --> 00:23:07,860
implant it was disclosed by the South

597
00:23:07,860 --> 00:23:10,620
Korean government in 2021

598
00:23:10,620 --> 00:23:11,460
um

599
00:23:11,460 --> 00:23:14,280
it's a very featured rich in terms of

600
00:23:14,280 --> 00:23:16,559
its capabilities it has the ability to

601
00:23:16,559 --> 00:23:19,940
screen capture and key log and it has a

602
00:23:19,940 --> 00:23:22,500
full-fledged file management module in

603
00:23:22,500 --> 00:23:24,320
there it has the ability to create

604
00:23:24,320 --> 00:23:28,260
destroy read write execute files and so

605
00:23:28,260 --> 00:23:30,480
on and so forth

606
00:23:30,480 --> 00:23:33,059
um what's peculiar about tiger Rod is

607
00:23:33,059 --> 00:23:36,179
that in spite of having a full-fledged

608
00:23:36,179 --> 00:23:38,820
file management module it also has the

609
00:23:38,820 --> 00:23:41,340
ability to look for certain files on the

610
00:23:41,340 --> 00:23:44,159
system with certain extensions and send

611
00:23:44,159 --> 00:23:46,200
that out to the C2 server and enable

612
00:23:46,200 --> 00:23:49,860
that enables it to exfiltrate it and um

613
00:23:49,860 --> 00:23:51,780
this is kind of sort of a duplicity of

614
00:23:51,780 --> 00:23:53,720
functionality that we've seen in rats

615
00:23:53,720 --> 00:23:56,580
authored by Lazarus

616
00:23:56,580 --> 00:23:58,679
and I'm going to talk about that in a

617
00:23:58,679 --> 00:23:59,760
bit as well

618
00:23:59,760 --> 00:24:02,460
um but basically what happens is if you

619
00:24:02,460 --> 00:24:04,039
followed um

620
00:24:04,039 --> 00:24:06,659
implants created by Lazarus over the

621
00:24:06,659 --> 00:24:08,820
past five years or so they love to

622
00:24:08,820 --> 00:24:09,900
stitch together different

623
00:24:09,900 --> 00:24:11,820
functionalities in their rats and in

624
00:24:11,820 --> 00:24:14,700
their malware families so you might not

625
00:24:14,700 --> 00:24:16,520
be able to

626
00:24:16,520 --> 00:24:19,080
derive a linear evolution in their

627
00:24:19,080 --> 00:24:20,760
malware families you know they tend to

628
00:24:20,760 --> 00:24:22,860
take things out put things back and

629
00:24:22,860 --> 00:24:24,000
stuff like that

630
00:24:24,000 --> 00:24:27,240
and this is an example of that tiger ad

631
00:24:27,240 --> 00:24:29,640
was disclosed in 2021 but it was first

632
00:24:29,640 --> 00:24:33,539
made in 2020 a bulk of its functionality

633
00:24:33,539 --> 00:24:37,500
was introduced in 2020. in 2021 we saw

634
00:24:37,500 --> 00:24:39,539
the attackers at the port forwarding

635
00:24:39,539 --> 00:24:42,600
capability and then in 2022 they

636
00:24:42,600 --> 00:24:44,820
immediately decided to remove it

637
00:24:44,820 --> 00:24:47,400
they introduced a new capability that

638
00:24:47,400 --> 00:24:50,880
allows the malware to copy over or dump

639
00:24:50,880 --> 00:24:53,400
the contents of a removable file and

640
00:24:53,400 --> 00:24:55,020
then we also saw indications that they

641
00:24:55,020 --> 00:24:56,940
were preparing to add a web capture

642
00:24:56,940 --> 00:24:59,280
module in there as well in the malware

643
00:24:59,280 --> 00:25:01,260
implant

644
00:25:01,260 --> 00:25:04,919
all right how are we doing on time

645
00:25:04,919 --> 00:25:07,440
good all right all right this might just

646
00:25:07,440 --> 00:25:10,020
be a short short presentation all right

647
00:25:10,020 --> 00:25:12,059
let's summarize everything so what are

648
00:25:12,059 --> 00:25:14,580
the key takeaways I basically I've just

649
00:25:14,580 --> 00:25:16,440
dumped a ton of information on you and

650
00:25:16,440 --> 00:25:17,940
have been like hey this is a campaign

651
00:25:17,940 --> 00:25:19,799
these are three intrusion sets this is

652
00:25:19,799 --> 00:25:23,520
for malware implants and

653
00:25:23,520 --> 00:25:26,159
um you know that's it but I'd like to

654
00:25:26,159 --> 00:25:28,740
summarize this a bit and give it more

655
00:25:28,740 --> 00:25:31,380
structure so here it is

656
00:25:31,380 --> 00:25:32,039
um

657
00:25:32,039 --> 00:25:34,980
when we looked at the implants there

658
00:25:34,980 --> 00:25:36,779
were certain things that stood out to us

659
00:25:36,779 --> 00:25:39,240
there were certain patterns that we saw

660
00:25:39,240 --> 00:25:43,980
firstly in this specific campaign we saw

661
00:25:43,980 --> 00:25:47,159
implants that were rapidly developed the

662
00:25:47,159 --> 00:25:48,720
four different types of implants that

663
00:25:48,720 --> 00:25:50,520
were developed with other customized

664
00:25:50,520 --> 00:25:52,559
modules and plugins that the attackers

665
00:25:52,559 --> 00:25:54,779
developed on a regular basis that they

666
00:25:54,779 --> 00:25:57,539
could Deploy on the infected endpoints

667
00:25:57,539 --> 00:26:00,799
we have seen the increasing use of

668
00:26:00,799 --> 00:26:03,900
obfuscation and the use of loaders in

669
00:26:03,900 --> 00:26:07,799
lazarus's implants over the past three

670
00:26:07,799 --> 00:26:11,340
or four years and that that practice has

671
00:26:11,340 --> 00:26:14,940
continued well into 2023 as well

672
00:26:14,940 --> 00:26:18,419
of course Lazarus also likes to mix and

673
00:26:18,419 --> 00:26:20,340
match their capabilities as I said they

674
00:26:20,340 --> 00:26:22,320
will stitch together different code and

675
00:26:22,320 --> 00:26:24,480
create an implant that suits a specific

676
00:26:24,480 --> 00:26:27,360
campaign or a specific intrusion set

677
00:26:27,360 --> 00:26:30,600
and then Lazarus is also moving towards

678
00:26:30,600 --> 00:26:32,880
a platform agnostic approach

679
00:26:32,880 --> 00:26:36,000
um they're basically trying to create

680
00:26:36,000 --> 00:26:38,340
one single piece of malware see if it's

681
00:26:38,340 --> 00:26:41,400
really effective and then Port it to

682
00:26:41,400 --> 00:26:42,840
different platforms and different

683
00:26:42,840 --> 00:26:45,240
operating systems as And when they see

684
00:26:45,240 --> 00:26:45,670
fit

685
00:26:45,670 --> 00:26:47,760
[Music]

686
00:26:47,760 --> 00:26:49,380
now this is something that I haven't

687
00:26:49,380 --> 00:26:52,919
spoken about a lot but um

688
00:26:52,919 --> 00:26:55,799
they do like to use a lot of readily

689
00:26:55,799 --> 00:26:57,720
available tools they will use impact it

690
00:26:57,720 --> 00:26:59,640
on a very regular basis they will use

691
00:26:59,640 --> 00:27:03,059
mimikats they will use proc dump they

692
00:27:03,059 --> 00:27:06,059
will use archive creation tools for data

693
00:27:06,059 --> 00:27:07,740
exfiltration and so on and so forth and

694
00:27:07,740 --> 00:27:09,480
they will use known tools such as

695
00:27:09,480 --> 00:27:12,120
reverse tunnels and proxies and you know

696
00:27:12,120 --> 00:27:14,279
the three proxies and the P links and

697
00:27:14,279 --> 00:27:15,500
stuff like that

698
00:27:15,500 --> 00:27:19,919
to conduct their malicious operations

699
00:27:19,919 --> 00:27:21,980
um

700
00:27:22,500 --> 00:27:24,000
all right

701
00:27:24,000 --> 00:27:25,860
this is probably going to be the last

702
00:27:25,860 --> 00:27:29,400
Light yay all right so to summarize

703
00:27:29,400 --> 00:27:32,220
Lazarus is bad

704
00:27:32,220 --> 00:27:36,059
right now this is a highly highly

705
00:27:36,059 --> 00:27:38,220
motivated adversary that is constantly

706
00:27:38,220 --> 00:27:39,960
trying new things they're constantly

707
00:27:39,960 --> 00:27:41,400
innovating

708
00:27:41,400 --> 00:27:43,140
they will not shy away from the use of

709
00:27:43,140 --> 00:27:45,120
exploits so it's not just social

710
00:27:45,120 --> 00:27:46,260
engineering

711
00:27:46,260 --> 00:27:49,020
they have a very diverse set of implants

712
00:27:49,020 --> 00:27:51,720
and arsenals in their Arsenal

713
00:27:51,720 --> 00:27:54,179
they like to use a lot of Open Source

714
00:27:54,179 --> 00:27:56,520
tools as well and perform a wide variety

715
00:27:56,520 --> 00:27:58,919
of Hands-On keyboard activity

716
00:27:58,919 --> 00:28:01,620
and

717
00:28:01,620 --> 00:28:03,539
so when you look at the slide you know

718
00:28:03,539 --> 00:28:05,520
there's this presentation and when you

719
00:28:05,520 --> 00:28:07,620
take a look at this um

720
00:28:07,620 --> 00:28:10,020
they're very motivated adversary right

721
00:28:10,020 --> 00:28:11,820
and one would even say that they're very

722
00:28:11,820 --> 00:28:14,580
sophisticated adversary as well

723
00:28:14,580 --> 00:28:15,299
um

724
00:28:15,299 --> 00:28:16,860
and sometimes we say that they're

725
00:28:16,860 --> 00:28:18,779
experts at what they do

726
00:28:18,779 --> 00:28:21,000
but sometimes

727
00:28:21,000 --> 00:28:22,500
um they're not

728
00:28:22,500 --> 00:28:24,960
in this campaign we found multiple

729
00:28:24,960 --> 00:28:26,640
instances but I want to talk about two

730
00:28:26,640 --> 00:28:29,460
instances here where they basically made

731
00:28:29,460 --> 00:28:30,799
mistakes

732
00:28:30,799 --> 00:28:32,940
firstly in the Hands-On keyboard

733
00:28:32,940 --> 00:28:36,360
activity they would mistype commands and

734
00:28:36,360 --> 00:28:37,799
every time you miss type a command you

735
00:28:37,799 --> 00:28:39,659
have to type it in again right so that

736
00:28:39,659 --> 00:28:42,539
creates a lot of noise on the system

737
00:28:42,539 --> 00:28:44,700
so you know maybe they weren't paying

738
00:28:44,700 --> 00:28:46,380
attention maybe they didn't have their

739
00:28:46,380 --> 00:28:49,380
coffee or whatever but um sometimes that

740
00:28:49,380 --> 00:28:50,279
happened

741
00:28:50,279 --> 00:28:53,159
in another instance we also saw that

742
00:28:53,159 --> 00:28:55,500
sometimes the operator that had access

743
00:28:55,500 --> 00:28:58,140
to a compromise box would type in a

744
00:28:58,140 --> 00:28:59,220
command

745
00:28:59,220 --> 00:29:01,440
figure out that it's not working

746
00:29:01,440 --> 00:29:03,299
disappear for like five minutes and then

747
00:29:03,299 --> 00:29:05,460
come back and put in the right command

748
00:29:05,460 --> 00:29:07,320
can you guess what they were doing in

749
00:29:07,320 --> 00:29:08,040
those five minutes

750
00:29:08,040 --> 00:29:09,720
[Music]

751
00:29:09,720 --> 00:29:13,140
yes they were Googling

752
00:29:13,140 --> 00:29:16,260
all right and then uh

753
00:29:16,260 --> 00:29:18,360
the this is this is my third observation

754
00:29:18,360 --> 00:29:21,539
and this is kind of analytical we

755
00:29:21,539 --> 00:29:24,659
noticed a specific pattern in their

756
00:29:24,659 --> 00:29:26,399
operations and their Hands-On keyboard

757
00:29:26,399 --> 00:29:28,260
activity

758
00:29:28,260 --> 00:29:30,299
um on some certain endpoints we would

759
00:29:30,299 --> 00:29:33,240
see a predefined set of uh commands

760
00:29:33,240 --> 00:29:35,279
being being executed day after day after

761
00:29:35,279 --> 00:29:37,380
day you know on consecutive days

762
00:29:37,380 --> 00:29:40,200
and uh what I figured was

763
00:29:40,200 --> 00:29:41,940
um it was probably because there were

764
00:29:41,940 --> 00:29:43,679
multiple operators getting access to the

765
00:29:43,679 --> 00:29:45,840
same box so you know one operator gets

766
00:29:45,840 --> 00:29:47,820
access to to a compromise box today and

767
00:29:47,820 --> 00:29:49,080
then that gets transferred to another

768
00:29:49,080 --> 00:29:50,940
operator and then that gets transferred

769
00:29:50,940 --> 00:29:52,760
to another operator day after day

770
00:29:52,760 --> 00:29:56,340
because they had persistent access and

771
00:29:56,340 --> 00:29:58,320
uh the reason why they ran the same set

772
00:29:58,320 --> 00:30:00,480
of commands is because they had the same

773
00:30:00,480 --> 00:30:03,360
Playbook it was basically a standard

774
00:30:03,360 --> 00:30:05,580
operation operating procedures manual

775
00:30:05,580 --> 00:30:07,860
sop manual that said at the very

776
00:30:07,860 --> 00:30:10,559
beginning when you get access to a

777
00:30:10,559 --> 00:30:13,980
compromise box run these commands right

778
00:30:13,980 --> 00:30:15,840
so they ran their own set of commands

779
00:30:15,840 --> 00:30:17,340
but

780
00:30:17,340 --> 00:30:19,740
um they wouldn't compare notes is is

781
00:30:19,740 --> 00:30:21,960
what I feel happened because they would

782
00:30:21,960 --> 00:30:24,299
repeatedly you know execute the same set

783
00:30:24,299 --> 00:30:25,919
of commands so basically one operator

784
00:30:25,919 --> 00:30:27,480
doesn't know what the other operator

785
00:30:27,480 --> 00:30:30,659
found out uh which again makes it noisy

786
00:30:30,659 --> 00:30:33,000
which also shows that there is a certain

787
00:30:33,000 --> 00:30:34,799
level of immaturity in their operations

788
00:30:34,799 --> 00:30:37,559
as well so there are indications that

789
00:30:37,559 --> 00:30:40,020
although we tend to create like cool

790
00:30:40,020 --> 00:30:42,059
graphics and we tend to call different

791
00:30:42,059 --> 00:30:45,200
adversaries bears and kittens and um

792
00:30:45,200 --> 00:30:49,080
leopards and tigers and pandas

793
00:30:49,080 --> 00:30:51,000
um they are human at the end of the day

794
00:30:51,000 --> 00:30:53,460
and they do make mistakes and that's

795
00:30:53,460 --> 00:30:55,880
what I'm going to leave you with today

796
00:30:55,880 --> 00:30:56,100
[Music]

797
00:30:56,100 --> 00:30:56,940
um

798
00:30:56,940 --> 00:30:59,039
how are we doing on time

799
00:30:59,039 --> 00:31:01,320
doing good all right so this is the end

800
00:31:01,320 --> 00:31:03,600
of my presentation uh now is the time

801
00:31:03,600 --> 00:31:06,480
for any questions feedback uh blessings

802
00:31:06,480 --> 00:31:09,980
beer that you might have for me

803
00:31:10,250 --> 00:31:13,720
[Music]

804
00:31:26,940 --> 00:31:28,500
um so so one of them was the the

805
00:31:28,500 --> 00:31:32,279
repeated use of um the the same set of

806
00:31:32,279 --> 00:31:35,340
commands which led me to believe that

807
00:31:35,340 --> 00:31:37,559
um you know you've already typed this

808
00:31:37,559 --> 00:31:38,820
command you already have this

809
00:31:38,820 --> 00:31:40,260
information why would you come back

810
00:31:40,260 --> 00:31:41,640
tomorrow and do the same thing again

811
00:31:41,640 --> 00:31:43,740
right and and then the day after

812
00:31:43,740 --> 00:31:46,260
tomorrow as well right so that that led

813
00:31:46,260 --> 00:31:47,760
me to believe that

814
00:31:47,760 --> 00:31:49,500
um there were two different distinct

815
00:31:49,500 --> 00:31:51,539
human individual operators operating the

816
00:31:51,539 --> 00:31:52,320
Box

817
00:31:52,320 --> 00:31:53,760
and the biggest thing is they weren't

818
00:31:53,760 --> 00:31:56,220
talking to each other you know maybe it

819
00:31:56,220 --> 00:31:57,840
was office politics or whatever but

820
00:31:57,840 --> 00:31:59,460
they're just not talking to each other

821
00:31:59,460 --> 00:32:02,299
so

822
00:32:15,480 --> 00:32:17,580
well there are indications that they've

823
00:32:17,580 --> 00:32:19,860
gotten into the supply chain attack game

824
00:32:19,860 --> 00:32:21,720
I've heard so

825
00:32:21,720 --> 00:32:23,820
um I think this is related to 3cx and X

826
00:32:23,820 --> 00:32:25,200
Trader and that's all I can talk about

827
00:32:25,200 --> 00:32:28,200
uh to be honest

828
00:32:28,200 --> 00:32:30,860
questions

829
00:32:36,659 --> 00:32:39,140
I don't remember to be honest

830
00:32:39,140 --> 00:32:41,520
they tend to mix and match their

831
00:32:41,520 --> 00:32:44,940
infrastructure as well the very um

832
00:32:44,940 --> 00:32:46,440
they're very paranoid about their

833
00:32:46,440 --> 00:32:48,480
infrastructure as well and this goes for

834
00:32:48,480 --> 00:32:51,240
most of the North Korean apt's nation

835
00:32:51,240 --> 00:32:53,640
state groups as soon as you find stuff

836
00:32:53,640 --> 00:32:56,159
on a virus total they tend to remove

837
00:32:56,159 --> 00:32:59,220
that as soon as they can unless they've

838
00:32:59,220 --> 00:33:01,260
had a certain degree of success or you

839
00:33:01,260 --> 00:33:04,879
know sometimes they just don't care

840
00:33:07,500 --> 00:33:10,500
foreign

841
00:33:13,440 --> 00:33:15,960
do work on this

842
00:33:15,960 --> 00:33:17,640
amazing job

843
00:33:17,640 --> 00:33:19,380
thank you

844
00:33:19,380 --> 00:33:23,720
thank you he said my work was fantastic

845
00:33:27,670 --> 00:33:31,170
[Applause]

846
00:33:39,559 --> 00:33:42,299
more specifically Define your groups

847
00:33:42,299 --> 00:33:44,820
that Lazarus which describes a whole

848
00:33:44,820 --> 00:33:48,899
bunch of different actors requirements

849
00:33:50,640 --> 00:33:52,799
I can try we're just gonna take an year

850
00:33:52,799 --> 00:33:55,679
or so so uh the question is is there any

851
00:33:55,679 --> 00:33:57,720
way we can get into more granularity

852
00:33:57,720 --> 00:34:00,120
when it comes to talking about Lazarus

853
00:34:00,120 --> 00:34:02,719
is that the question

854
00:34:02,820 --> 00:34:06,240
okay sure then it's going to take you

855
00:34:06,240 --> 00:34:09,239
and yours to do that so so the problem

856
00:34:09,239 --> 00:34:11,339
here is that um

857
00:34:11,339 --> 00:34:14,339
Lazarus recently the term Lazarus has

858
00:34:14,339 --> 00:34:16,320
it's it's it's people are starting to

859
00:34:16,320 --> 00:34:19,080
use it to Define an umbrella of threat

860
00:34:19,080 --> 00:34:20,040
actors

861
00:34:20,040 --> 00:34:23,699
that are associated with North Korea and

862
00:34:23,699 --> 00:34:26,280
that creates a problem because sometimes

863
00:34:26,280 --> 00:34:28,320
you need a greater detail and

864
00:34:28,320 --> 00:34:30,418
attribution and when certain people or

865
00:34:30,418 --> 00:34:33,000
certain researchers like me admittedly

866
00:34:33,000 --> 00:34:36,179
don't know who the actual entity is we

867
00:34:36,179 --> 00:34:37,980
just call it Lazarus and we get done

868
00:34:37,980 --> 00:34:40,560
with it and that dilutes the actual

869
00:34:40,560 --> 00:34:42,080
Lazarus um

870
00:34:42,080 --> 00:34:45,679
moniker to be honest

871
00:34:46,800 --> 00:34:49,460
I get you

872
00:34:58,320 --> 00:35:00,119
trust me they had a lot of systems to

873
00:35:00,119 --> 00:35:02,300
practice

874
00:35:03,500 --> 00:35:07,740
the the volume and the time period they

875
00:35:07,740 --> 00:35:09,720
had enough more than enough time to

876
00:35:09,720 --> 00:35:11,760
explore around

877
00:35:11,760 --> 00:35:15,049
[Music]

878
00:35:23,460 --> 00:35:25,619
yeah we published research on our blog

879
00:35:25,619 --> 00:35:27,119
as well I'm sorry I should have put that

880
00:35:27,119 --> 00:35:30,260
in uh right here it's a

881
00:35:30,260 --> 00:35:32,400
blog.tallosintelligence.com so that's

882
00:35:32,400 --> 00:35:33,900
basically it I apologize for that I

883
00:35:33,900 --> 00:35:36,760
should have put something in

884
00:35:36,760 --> 00:35:40,269
[Music]

885
00:35:45,300 --> 00:35:48,480
sure so uh firstly what happened was uh

886
00:35:48,480 --> 00:35:49,980
when when we got our hands on the

887
00:35:49,980 --> 00:35:51,480
samples there were more than a few

888
00:35:51,480 --> 00:35:54,420
megabytes eight or nine megabytes um and

889
00:35:54,420 --> 00:35:56,160
you know the first question you have to

890
00:35:56,160 --> 00:35:58,140
ask yourself is

891
00:35:58,140 --> 00:36:01,500
um why is this malware so big right

892
00:36:01,500 --> 00:36:02,280
um

893
00:36:02,280 --> 00:36:04,500
maybe it's made in golang or maybe it's

894
00:36:04,500 --> 00:36:07,320
made in a different framework and then

895
00:36:07,320 --> 00:36:08,700
um you know we did our own static

896
00:36:08,700 --> 00:36:10,619
analysis and we started to find that you

897
00:36:10,619 --> 00:36:12,839
know once you open it up in Ida Pro and

898
00:36:12,839 --> 00:36:15,119
you look at the strings uh you slowly

899
00:36:15,119 --> 00:36:18,560
start to understand that uh this um this

900
00:36:18,560 --> 00:36:21,599
this sub word or this substring QT is

901
00:36:21,599 --> 00:36:24,060
being used a lot and then you start

902
00:36:24,060 --> 00:36:25,680
Googling stuff and you eventually

903
00:36:25,680 --> 00:36:27,780
stumble upon the fact that oh this is

904
00:36:27,780 --> 00:36:29,760
the QT framework and when you start

905
00:36:29,760 --> 00:36:31,200
looking at the code that they're calling

906
00:36:31,200 --> 00:36:32,880
you know it's I think QD framework is an

907
00:36:32,880 --> 00:36:34,859
open source framework so you can have a

908
00:36:34,859 --> 00:36:36,359
direct match between the assembly that

909
00:36:36,359 --> 00:36:37,500
you're looking at and the code that's

910
00:36:37,500 --> 00:36:39,240
uploaded out there

911
00:36:39,240 --> 00:36:41,760
that's basically how we discovered it I

912
00:36:41,760 --> 00:36:43,740
wish we hadn't but

913
00:36:43,740 --> 00:36:47,000
[Music]

914
00:36:47,460 --> 00:36:50,160
any more questions

915
00:36:50,160 --> 00:36:52,380
going once

916
00:36:52,380 --> 00:36:54,720
going twice

917
00:36:54,720 --> 00:36:56,339
all right

918
00:36:56,339 --> 00:36:59,119
your question

919
00:37:04,440 --> 00:37:08,220
yes all right sold

920
00:37:08,220 --> 00:37:09,660
so take backs thank you so much for

921
00:37:09,660 --> 00:37:11,460
attending the session

922
00:37:11,460 --> 00:37:13,760
you guys are awesome thanks

923
00:37:13,760 --> 00:37:21,109
[Applause]

