1
00:00:03,720 --> 00:00:11,709
thank you for coming<font color="#CCCCCC"> this my second</font>

2
00:00:07,630 --> 00:00:17,200
besides Calgary<font color="#E5E5E5"> and thank you besides</font>

3
00:00:11,709 --> 00:00:19,980
for getting me back<font color="#E5E5E5"> again ready here</font>

4
00:00:17,200 --> 00:00:21,310
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to look into</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> malware's</font>

5
00:00:19,980 --> 00:00:25,630
<font color="#CCCCCC">on-demand</font>

6
00:00:21,310 --> 00:00:30,099
polymorphic code<font color="#E5E5E5"> it's kinda canned a bit</font>

7
00:00:25,630 --> 00:00:34,320
more too technical maybe<font color="#E5E5E5"> but I hope</font><font color="#CCCCCC"> to I</font>

8
00:00:30,100 --> 00:00:37,260
hope<font color="#E5E5E5"> for you to enjoy</font><font color="#CCCCCC"> it case</font>

9
00:00:34,320 --> 00:00:39,990
about me<font color="#E5E5E5"> that's why I want</font><font color="#CCCCCC"> to walk</font>

10
00:00:37,260 --> 00:00:43,970
<font color="#E5E5E5">around I want to see much nice</font><font color="#CCCCCC"> - okay I</font>

11
00:00:39,990 --> 00:00:47,100
work at<font color="#CCCCCC"> Port in it</font><font color="#E5E5E5"> okay I have but these</font>

12
00:00:43,970 --> 00:00:49,739
articles in bars<font color="#E5E5E5"> bulletin and regular</font>

13
00:00:47,100 --> 00:00:52,550
contribute or<font color="#CCCCCC"> per</font><font color="#E5E5E5"> our blog that</font>

14
00:00:49,740 --> 00:00:55,560
fortunate that<font color="#E5E5E5"> calm those are some of my</font>

15
00:00:52,550 --> 00:00:57,739
conferences that<font color="#E5E5E5"> I went to already the</font>

16
00:00:55,560 --> 00:01:01,260
red one is the besides the<font color="#CCCCCC"> current one</font>

17
00:00:57,739 --> 00:01:05,670
<font color="#E5E5E5">most of my profile picture looks like</font>

18
00:01:01,260 --> 00:01:09,259
<font color="#CCCCCC">this but deep inside that's me it's</font>

19
00:01:05,670 --> 00:01:14,119
kinda supposed<font color="#E5E5E5"> to be Batman but kinda</font>

20
00:01:09,259 --> 00:01:16,759
more into into him

21
00:01:14,119 --> 00:01:19,939
<font color="#E5E5E5">they're different malware categories</font>

22
00:01:16,759 --> 00:01:23,630
that we<font color="#E5E5E5"> already know okay it is very</font>

23
00:01:19,939 --> 00:01:28,699
<font color="#E5E5E5">ready hype in the news in the</font><font color="#CCCCCC"> media</font><font color="#E5E5E5"> and</font>

24
00:01:23,630 --> 00:01:31,520
most especially the ransomware<font color="#E5E5E5"> hey but</font>

25
00:01:28,700 --> 00:01:35,000
<font color="#E5E5E5">this one this particular malware is not</font>

26
00:01:31,520 --> 00:01:37,039
just a ransomware<font color="#E5E5E5"> it is also a virus</font>

27
00:01:35,000 --> 00:01:39,920
which is<font color="#CCCCCC"> a fire impactor</font><font color="#E5E5E5"> most ransomware</font>

28
00:01:37,039 --> 00:01:42,350
that we know they they<font color="#CCCCCC"> just lock your</font>

29
00:01:39,920 --> 00:01:45,020
screen<font color="#E5E5E5"> and clip</font><font color="#CCCCCC"> your pulse</font><font color="#E5E5E5"> and that's it</font>

30
00:01:42,350 --> 00:01:47,390
<font color="#CCCCCC">you</font><font color="#E5E5E5"> just have to</font><font color="#CCCCCC"> pay</font><font color="#E5E5E5"> by bitcoins and</font>

31
00:01:45,020 --> 00:01:50,060
then then<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can get your purse back</font>

32
00:01:47,390 --> 00:01:52,849
<font color="#CCCCCC">but this</font><font color="#E5E5E5"> one if you pay by bitcoins</font>

33
00:01:50,060 --> 00:01:55,670
there is not there<font color="#CCCCCC"> is a chance that you</font>

34
00:01:52,849 --> 00:01:58,610
<font color="#E5E5E5">can be impacted again because it impacts</font>

35
00:01:55,670 --> 00:02:00,530
the<font color="#CCCCCC"> pulse</font><font color="#E5E5E5"> and runs it again once you per</font>

36
00:01:58,610 --> 00:02:03,289
sample your calculator that<font color="#E5E5E5"> exe was</font>

37
00:02:00,530 --> 00:02:05,509
impacted<font color="#CCCCCC"> okay when you click</font><font color="#E5E5E5"> you want to</font>

38
00:02:03,289 --> 00:02:08,538
compute<font color="#E5E5E5"> something and then you click</font><font color="#CCCCCC"> it</font>

39
00:02:05,509 --> 00:02:11,750
again<font color="#E5E5E5"> you will</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> impacted again by this</font>

40
00:02:08,538 --> 00:02:12,410
ransomware<font color="#CCCCCC"> so it is a combination of a</font>

41
00:02:11,750 --> 00:02:16,640
<font color="#E5E5E5">ransomware</font>

42
00:02:12,410 --> 00:02:18,680
<font color="#E5E5E5">and a virus</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> just just the</font>

43
00:02:16,640 --> 00:02:20,690
introduction<font color="#CCCCCC"> okay we're going to</font><font color="#E5E5E5"> look</font>

44
00:02:18,680 --> 00:02:23,150
<font color="#CCCCCC">into this particular model where we're</font>

45
00:02:20,690 --> 00:02:25,280
going to<font color="#CCCCCC"> to check</font><font color="#E5E5E5"> how it works when you</font>

46
00:02:23,150 --> 00:02:27,019
try to<font color="#E5E5E5"> reverse-engineer the malware</font>

47
00:02:25,280 --> 00:02:30,410
<font color="#CCCCCC">we're looking into the some</font><font color="#E5E5E5"> of the</font>

48
00:02:27,019 --> 00:02:33,079
visible signs we try to extract the

49
00:02:30,410 --> 00:02:35,540
infected file<font color="#E5E5E5"> okay and we're going</font><font color="#CCCCCC"> to</font>

50
00:02:33,079 --> 00:02:37,959
<font color="#E5E5E5">look into also the different algorithms</font>

51
00:02:35,540 --> 00:02:41,290
<font color="#E5E5E5">the metamorphic and polymorphic</font>

52
00:02:37,959 --> 00:02:44,959
algorithm of this particular malware<font color="#CCCCCC"> a</font>

53
00:02:41,290 --> 00:02:47,900
very severe impact or it is a kind of

54
00:02:44,959 --> 00:02:51,049
malware that<font color="#CCCCCC"> attaches itself into a</font>

55
00:02:47,900 --> 00:02:53,900
hospital<font color="#CCCCCC"> okay it depends on what kind it</font>

56
00:02:51,049 --> 00:02:56,599
<font color="#E5E5E5">is a pending prepending cavity type okay</font>

57
00:02:53,900 --> 00:02:58,849
<font color="#CCCCCC">okay it</font><font color="#E5E5E5"> also maintains persistency and</font>

58
00:02:56,599 --> 00:03:02,480
<font color="#CCCCCC">of course impacted paths are harder to</font>

59
00:02:58,849 --> 00:03:04,970
restore okay the best<font color="#E5E5E5"> way is to format</font>

60
00:03:02,480 --> 00:03:07,340
<font color="#E5E5E5">your system reinstall the windows or</font>

61
00:03:04,970 --> 00:03:09,680
your<font color="#CCCCCC"> paper but it's not very advisable</font>

62
00:03:07,340 --> 00:03:11,150
<font color="#E5E5E5">because it will clean up your your</font>

63
00:03:09,680 --> 00:03:13,060
<font color="#CCCCCC">harddrive okay</font>

64
00:03:11,150 --> 00:03:15,470
<font color="#E5E5E5">and a ransomware of course</font><font color="#CCCCCC"> we'll learn</font>

65
00:03:13,060 --> 00:03:18,230
<font color="#CCCCCC">there are literally hundreds of</font>

66
00:03:15,470 --> 00:03:20,989
ransomware<font color="#E5E5E5"> roaming around</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> this one</font>

67
00:03:18,230 --> 00:03:23,209
is particularly close your computer<font color="#CCCCCC"> for</font>

68
00:03:20,989 --> 00:03:26,120
ransom<font color="#CCCCCC"> ducts your screen</font>

69
00:03:23,209 --> 00:03:31,280
users<font color="#CCCCCC"> of course</font><font color="#E5E5E5"> bitcoins</font><font color="#CCCCCC"> poor for</font>

70
00:03:26,120 --> 00:03:33,560
payment<font color="#E5E5E5"> and of course totally luxury</font>

71
00:03:31,280 --> 00:03:35,980
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> going to look into how to unlock</font>

72
00:03:33,560 --> 00:03:39,859
your screen<font color="#CCCCCC"> if you're infected with</font>

73
00:03:35,980 --> 00:03:42,048
<font color="#CCCCCC">Billa okay but you can also use the same</font>

74
00:03:39,859 --> 00:03:44,450
technique<font color="#E5E5E5"> if you if there's a new</font>

75
00:03:42,049 --> 00:03:47,090
<font color="#CCCCCC">malware that locks your</font><font color="#E5E5E5"> screen</font><font color="#CCCCCC"> I hope it</font>

76
00:03:44,450 --> 00:03:49,638
works<font color="#E5E5E5"> with that one</font><font color="#CCCCCC"> too yes a common</font>

77
00:03:47,090 --> 00:03:52,609
malware<font color="#E5E5E5"> we normally use different tools</font>

78
00:03:49,639 --> 00:03:54,769
<font color="#CCCCCC">but most</font><font color="#E5E5E5"> of the time we</font><font color="#CCCCCC"> use this</font><font color="#E5E5E5"> one we</font>

79
00:03:52,609 --> 00:03:56,599
use<font color="#CCCCCC"> the buggers</font><font color="#E5E5E5"> to to unlock there are</font>

80
00:03:54,769 --> 00:03:59,209
several the debuggers that we can

81
00:03:56,599 --> 00:04:02,030
download<font color="#E5E5E5"> for free</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> we have the</font><font color="#CCCCCC"> allah</font>

82
00:03:59,209 --> 00:04:04,129
debug<font color="#E5E5E5"> the immunity debugger</font><font color="#CCCCCC"> and if you</font>

83
00:04:02,030 --> 00:04:06,980
want to the difference between<font color="#CCCCCC"> the first</font>

84
00:04:04,129 --> 00:04:10,129
two is that<font color="#CCCCCC"> immutable debugger</font><font color="#E5E5E5"> uses</font>

85
00:04:06,980 --> 00:04:12,108
Python script to<font color="#CCCCCC"> enhance your reversing</font>

86
00:04:10,129 --> 00:04:15,409
<font color="#CCCCCC">see reversing script</font>

87
00:04:12,109 --> 00:04:18,650
<font color="#E5E5E5">okay so we have</font><font color="#CCCCCC"> xx support the dbg were</font>

88
00:04:15,409 --> 00:04:20,690
in if you're analyzing 64-bit malware

89
00:04:18,649 --> 00:04:24,229
<font color="#E5E5E5">you can use this one because I think</font>

90
00:04:20,690 --> 00:04:27,199
they<font color="#E5E5E5"> stopped enhancing</font><font color="#CCCCCC"> all the dbg but</font>

91
00:04:24,229 --> 00:04:30,830
but for<font color="#CCCCCC"> x64 DVD you can against you can</font>

92
00:04:27,199 --> 00:04:34,550
<font color="#E5E5E5">debug 32 and 64 to say at the same time</font>

93
00:04:30,830 --> 00:04:37,340
<font color="#CCCCCC">hey</font><font color="#E5E5E5"> poor poor when you encounter a</font>

94
00:04:34,550 --> 00:04:41,120
<font color="#E5E5E5">samples</font><font color="#CCCCCC"> a bill of impacted files okay</font>

95
00:04:37,340 --> 00:04:43,489
<font color="#E5E5E5">you can only see the</font><font color="#CCCCCC"> EM said header that</font>

96
00:04:41,120 --> 00:04:45,650
<font color="#E5E5E5">the</font><font color="#CCCCCC"> Crypt or that Eclipse the encrypted</font>

97
00:04:43,490 --> 00:04:47,840
<font color="#E5E5E5">file</font><font color="#CCCCCC"> okay and then of course this</font>

98
00:04:45,650 --> 00:04:50,210
<font color="#E5E5E5">particular part is I think I have a</font>

99
00:04:47,840 --> 00:04:53,630
pointer<font color="#E5E5E5"> this particular part is actually</font>

100
00:04:50,210 --> 00:04:56,960
<font color="#E5E5E5">the encrypted version</font><font color="#CCCCCC"> but when you look</font>

101
00:04:53,630 --> 00:05:00,500
inside the file<font color="#CCCCCC"> normally when you try to</font>

102
00:04:56,960 --> 00:05:03,169
unpack<font color="#E5E5E5"> this one okay you can use now</font>

103
00:05:00,500 --> 00:05:05,030
static or dynamic analysis with the

104
00:05:03,169 --> 00:05:07,820
decrypted and<font color="#E5E5E5"> part that is the common</font>

105
00:05:05,030 --> 00:05:10,330
malware strategy<font color="#CCCCCC"> okay but this</font><font color="#E5E5E5"> one is</font>

106
00:05:07,820 --> 00:05:13,340
<font color="#CCCCCC">kinda different</font>

107
00:05:10,330 --> 00:05:17,599
there are several staging reversing

108
00:05:13,340 --> 00:05:20,869
stages for<font color="#E5E5E5"> Billa the first one is he the</font>

109
00:05:17,599 --> 00:05:23,210
very first<font color="#CCCCCC"> low the lower part of</font><font color="#E5E5E5"> the the</font>

110
00:05:20,870 --> 00:05:24,530
impacted<font color="#CCCCCC"> pile is a metamorphic algorithm</font>

111
00:05:23,210 --> 00:05:26,719
we<font color="#E5E5E5"> are going to look into that</font>

112
00:05:24,530 --> 00:05:29,330
they then after the metamorphic

113
00:05:26,720 --> 00:05:31,969
algorithm it will<font color="#E5E5E5"> generate the decoded</font>

114
00:05:29,330 --> 00:05:35,150
<font color="#E5E5E5">bytes which is responsible for the</font><font color="#CCCCCC"> main</font>

115
00:05:31,969 --> 00:05:36,110
function<font color="#E5E5E5"> the main function generates the</font>

116
00:05:35,150 --> 00:05:38,690
<font color="#CCCCCC">different one</font>

117
00:05:36,110 --> 00:05:41,090
davonne polymorphic code<font color="#CCCCCC"> Karine</font><font color="#E5E5E5"> I call</font>

118
00:05:38,690 --> 00:05:43,910
<font color="#E5E5E5">that</font><font color="#CCCCCC"> pond</font><font color="#E5E5E5"> demon because every time it</font>

119
00:05:41,090 --> 00:05:46,039
executes<font color="#E5E5E5"> for example one function</font>

120
00:05:43,910 --> 00:05:48,470
executes to drop the pile

121
00:05:46,040 --> 00:05:51,320
it will<font color="#CCCCCC"> Rhian crip with another key</font>

122
00:05:48,470 --> 00:05:53,990
<font color="#E5E5E5">that's why every</font><font color="#CCCCCC"> time it uses</font><font color="#E5E5E5"> that</font>

123
00:05:51,320 --> 00:05:56,930
function<font color="#E5E5E5"> it will have a different copy</font>

124
00:05:53,990 --> 00:05:59,360
of the<font color="#E5E5E5"> malware itself it mean even if</font>

125
00:05:56,930 --> 00:06:02,390
you're debugging at the same time with

126
00:05:59,360 --> 00:06:04,640
<font color="#CCCCCC">your friends and</font><font color="#E5E5E5"> then the copy in</font><font color="#CCCCCC"> your</font>

127
00:06:02,390 --> 00:06:08,270
memory is<font color="#CCCCCC"> different from</font><font color="#E5E5E5"> different</font>

128
00:06:04,640 --> 00:06:10,430
computers<font color="#CCCCCC"> okay so that's why I called</font><font color="#E5E5E5"> on</font>

129
00:06:08,270 --> 00:06:13,609
demand so when you run the<font color="#E5E5E5"> on</font><font color="#CCCCCC"> demand</font>

130
00:06:10,430 --> 00:06:15,830
<font color="#E5E5E5">when you run this malware and then after</font>

131
00:06:13,610 --> 00:06:18,500
finishing<font color="#E5E5E5"> up some of the codes</font><font color="#CCCCCC"> it will</font>

132
00:06:15,830 --> 00:06:20,140
look something<font color="#CCCCCC"> like this like if you try</font>

133
00:06:18,500 --> 00:06:22,730
to color it it will become<font color="#CCCCCC"> like a</font>

134
00:06:20,140 --> 00:06:26,539
Christmas in<font color="#CCCCCC"> your memory in your</font>

135
00:06:22,730 --> 00:06:28,790
computer memory<font color="#CCCCCC"> ok and finally</font><font color="#E5E5E5"> the last</font>

136
00:06:26,540 --> 00:06:30,980
part<font color="#E5E5E5"> is your host pal</font><font color="#CCCCCC"> if you want to</font>

137
00:06:28,790 --> 00:06:33,110
clean your impacted parts<font color="#E5E5E5"> all you have</font>

138
00:06:30,980 --> 00:06:36,830
to do is to extract<font color="#E5E5E5"> this particular part</font>

139
00:06:33,110 --> 00:06:41,270
<font color="#E5E5E5">and then</font><font color="#CCCCCC"> you get your your impacted your</font>

140
00:06:36,830 --> 00:06:43,969
<font color="#E5E5E5">host spider okay as a ransomware okay</font>

141
00:06:41,270 --> 00:06:47,090
normally the good thing with<font color="#CCCCCC"> not good</font>

142
00:06:43,970 --> 00:06:47,750
thing the the important thing with

143
00:06:47,090 --> 00:06:50,450
ransomware

144
00:06:47,750 --> 00:06:52,910
is when<font color="#CCCCCC"> you're infected by a regular</font>

145
00:06:50,450 --> 00:06:55,460
malware sometimes most<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the time you</font>

146
00:06:52,910 --> 00:06:59,060
never know sometimes<font color="#CCCCCC"> it is a Trojan that</font>

147
00:06:55,460 --> 00:07:01,039
<font color="#E5E5E5">gets your your password</font><font color="#CCCCCC"> that collects</font>

148
00:06:59,060 --> 00:07:03,320
your information and you'll<font color="#E5E5E5"> never know</font>

149
00:07:01,040 --> 00:07:06,200
one good<font color="#E5E5E5"> thing or</font><font color="#CCCCCC"> not good thing with</font>

150
00:07:03,320 --> 00:07:11,060
transformer is there's always a visible

151
00:07:06,200 --> 00:07:14,450
sign like<font color="#E5E5E5"> this very visible right or</font>

152
00:07:11,060 --> 00:07:17,150
maybe I'm already impacted right<font color="#E5E5E5"> the</font>

153
00:07:14,450 --> 00:07:18,950
first time<font color="#E5E5E5"> when you're impacted</font><font color="#CCCCCC"> with</font>

154
00:07:17,150 --> 00:07:24,289
<font color="#E5E5E5">build up you will see</font><font color="#CCCCCC"> a blank screen</font>

155
00:07:18,950 --> 00:07:27,469
<font color="#CCCCCC">followed by this</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> I executed that</font><font color="#E5E5E5"> in</font>

156
00:07:24,290 --> 00:07:32,300
in kind of<font color="#E5E5E5"> cursor in Canada if you go if</font>

157
00:07:27,470 --> 00:07:34,850
you live in<font color="#E5E5E5"> u.s. those lag and those</font>

158
00:07:32,300 --> 00:07:37,520
things<font color="#E5E5E5"> will</font><font color="#CCCCCC"> change</font><font color="#E5E5E5"> that open to be</font>

159
00:07:34,850 --> 00:07:40,010
Picard<font color="#E5E5E5"> will become to be</font><font color="#CCCCCC"> PUSD it depends</font>

160
00:07:37,520 --> 00:07:45,200
<font color="#E5E5E5">the malware knows where you are</font>

161
00:07:40,010 --> 00:07:47,510
<font color="#E5E5E5">hey and if</font><font color="#CCCCCC"> you don't know</font><font color="#E5E5E5"> Bitcoin</font><font color="#CCCCCC"> okay</font>

162
00:07:45,200 --> 00:07:50,050
<font color="#E5E5E5">if you happen to know if you're asking</font>

163
00:07:47,510 --> 00:07:53,300
<font color="#CCCCCC">what</font><font color="#E5E5E5"> is Bitcoin one of the</font>

164
00:07:50,050 --> 00:07:55,730
important thing<font color="#CCCCCC"> bye-bye ransomware is it</font>

165
00:07:53,300 --> 00:07:58,520
explains something<font color="#E5E5E5"> it is kinda</font>

166
00:07:55,730 --> 00:07:59,000
educational<font color="#E5E5E5"> for those people that don't</font>

167
00:07:58,520 --> 00:08:03,680
know

168
00:07:59,000 --> 00:08:05,990
<font color="#E5E5E5">Bitcoin okay and the good thing is if</font>

169
00:08:03,680 --> 00:08:08,150
you already<font color="#E5E5E5"> know bitcoins and you don't</font>

170
00:08:05,990 --> 00:08:11,480
know how to pay how to get the bitcoins

171
00:08:08,150 --> 00:08:14,359
<font color="#CCCCCC">this particular malware</font><font color="#E5E5E5"> gives you</font>

172
00:08:11,480 --> 00:08:16,070
information<font color="#E5E5E5"> where to get the Bitcoin</font>

173
00:08:14,360 --> 00:08:19,250
<font color="#E5E5E5">actually in Vancouver</font>

174
00:08:16,070 --> 00:08:21,740
there is one in downtown Vancouver there

175
00:08:19,250 --> 00:08:24,230
is a<font color="#E5E5E5"> machine it is like an ATM you put</font>

176
00:08:21,740 --> 00:08:25,640
your<font color="#CCCCCC"> money there your cash</font><font color="#E5E5E5"> and then they</font>

177
00:08:24,230 --> 00:08:29,300
will give you a code for the<font color="#E5E5E5"> Bitcoin</font>

178
00:08:25,640 --> 00:08:31,820
<font color="#CCCCCC">there's also one in Seattle USA I went</font>

179
00:08:29,300 --> 00:08:34,969
there you can actually<font color="#E5E5E5"> exchange your</font>

180
00:08:31,820 --> 00:08:38,419
money<font color="#E5E5E5"> with a bit kind of problem is it</font>

181
00:08:34,969 --> 00:08:41,599
<font color="#CCCCCC">makes your driver's license in order for</font>

182
00:08:38,419 --> 00:08:44,750
you so I did<font color="#E5E5E5"> not try to to do that</font><font color="#CCCCCC"> okay</font>

183
00:08:41,599 --> 00:08:47,330
if you live somewhere not<font color="#CCCCCC"> in Vancouver</font>

184
00:08:44,750 --> 00:08:49,580
<font color="#E5E5E5">you can click your location then it will</font>

185
00:08:47,330 --> 00:08:53,180
give you the<font color="#E5E5E5"> location where you where</font>

186
00:08:49,580 --> 00:08:55,880
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can get your bitcoins and then it</font>

187
00:08:53,180 --> 00:08:57,800
will just<font color="#CCCCCC"> go around those are the</font>

188
00:08:55,880 --> 00:09:00,710
<font color="#E5E5E5">visible signs if you're</font><font color="#CCCCCC"> infected with</font>

189
00:08:57,800 --> 00:09:03,290
one<font color="#CCCCCC"> apply a parent pack</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> petia</font>

190
00:09:00,710 --> 00:09:07,130
you will see visible<font color="#E5E5E5"> signs that is</font>

191
00:09:03,290 --> 00:09:10,099
ransomware<font color="#CCCCCC"> if this particular ransomware</font>

192
00:09:07,130 --> 00:09:11,930
is<font color="#E5E5E5"> I selected this one because it is</font>

193
00:09:10,100 --> 00:09:14,480
<font color="#CCCCCC">also a</font><font color="#E5E5E5"> pollen pet as I've said earlier</font>

194
00:09:11,930 --> 00:09:16,989
but looking into different<font color="#CCCCCC"> kinds of</font><font color="#E5E5E5"> our</font>

195
00:09:14,480 --> 00:09:21,740
<font color="#CCCCCC">inspector O'Kane normally we have</font>

196
00:09:16,990 --> 00:09:24,170
<font color="#CCCCCC">appending repenting on top</font><font color="#E5E5E5"> ok the MZ is</font>

197
00:09:21,740 --> 00:09:27,800
<font color="#E5E5E5">the host file the cavity is harder to</font>

198
00:09:24,170 --> 00:09:31,729
<font color="#E5E5E5">clean</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> it inserts the</font><font color="#CCCCCC"> malware the</font>

199
00:09:27,800 --> 00:09:35,270
pollen factor in between those spaces<font color="#CCCCCC"> ok</font>

200
00:09:31,730 --> 00:09:37,010
and then the overwriting<font color="#E5E5E5"> they delete the</font>

201
00:09:35,270 --> 00:09:39,020
whole host part then<font color="#E5E5E5"> there is no</font>

202
00:09:37,010 --> 00:09:41,750
solution<font color="#CCCCCC"> for that and then you have the</font>

203
00:09:39,020 --> 00:09:45,069
companion<font color="#E5E5E5"> builder is kind a different</font>

204
00:09:41,750 --> 00:09:48,320
category<font color="#CCCCCC"> because it gets your</font><font color="#E5E5E5"> host file</font>

205
00:09:45,070 --> 00:09:50,089
encrypts<font color="#E5E5E5"> it and put it in the the body</font>

206
00:09:48,320 --> 00:09:53,030
of<font color="#E5E5E5"> the actual</font><font color="#CCCCCC"> villa</font>

207
00:09:50,089 --> 00:09:53,750
<font color="#E5E5E5">that is how build up works as well</font>

208
00:09:53,030 --> 00:09:57,260
impactors

209
00:09:53,750 --> 00:09:59,540
he normally to clean the impacted pile

210
00:09:57,260 --> 00:10:02,180
<font color="#E5E5E5">you have to know what kind of viruses</font><font color="#CCCCCC"> it</font>

211
00:09:59,540 --> 00:10:02,589
does<font color="#E5E5E5"> and then now you try to extract and</font>

212
00:10:02,180 --> 00:10:04,810
rest

213
00:10:02,590 --> 00:10:07,110
<font color="#CCCCCC">step on this one</font><font color="#E5E5E5"> earlier to this to like</font>

214
00:10:04,810 --> 00:10:09,760
create a script I'll look for the key

215
00:10:07,110 --> 00:10:13,930
<font color="#E5E5E5">encrypt and decrypt it and then you can</font>

216
00:10:09,760 --> 00:10:16,000
<font color="#E5E5E5">get the house fire</font><font color="#CCCCCC"> okay extracting the</font>

217
00:10:13,930 --> 00:10:17,560
<font color="#E5E5E5">host file we just</font><font color="#CCCCCC"> need to look for the</font>

218
00:10:16,000 --> 00:10:18,550
decryption key<font color="#E5E5E5"> I will show you where it</font>

219
00:10:17,560 --> 00:10:21,160
can be fine

220
00:10:18,550 --> 00:10:23,500
<font color="#E5E5E5">it can be one later and then use</font><font color="#CCCCCC"> that</font>

221
00:10:21,160 --> 00:10:26,469
that's the<font color="#E5E5E5"> the decryption key is only</font>

222
00:10:23,500 --> 00:10:30,760
used<font color="#CCCCCC"> as simple X or even that exercise</font>

223
00:10:26,470 --> 00:10:33,480
<font color="#E5E5E5">just trying to to change it by byte by</font>

224
00:10:30,760 --> 00:10:33,480
byte<font color="#E5E5E5"> okay</font>

225
00:10:34,890 --> 00:10:39,000
<font color="#E5E5E5">we going back to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> exactly of the</font>

226
00:10:37,530 --> 00:10:42,270
hospital first

227
00:10:39,000 --> 00:10:44,420
if you're<font color="#E5E5E5"> going to look at your your hex</font>

228
00:10:42,270 --> 00:10:48,270
editor<font color="#E5E5E5"> it will look something like this</font>

229
00:10:44,420 --> 00:10:50,849
<font color="#E5E5E5">there's nothing</font><font color="#CCCCCC"> to see okay and then you</font>

230
00:10:48,270 --> 00:10:53,550
have<font color="#CCCCCC"> to find this particular</font><font color="#E5E5E5"> code where</font>

231
00:10:50,850 --> 00:10:56,160
in<font color="#E5E5E5"> this code will will give you the</font>

232
00:10:53,550 --> 00:10:57,089
initial<font color="#E5E5E5"> key the location of the</font>

233
00:10:56,160 --> 00:10:59,040
decryption<font color="#CCCCCC"> key</font>

234
00:10:57,090 --> 00:11:01,620
<font color="#E5E5E5">these are actually you can</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> find</font>

235
00:10:59,040 --> 00:11:04,860
<font color="#E5E5E5">it just look for this offset particular</font>

236
00:11:01,620 --> 00:11:09,510
pile offset and then run the<font color="#CCCCCC"> exact the</font>

237
00:11:04,860 --> 00:11:13,610
decryption code get the decryption key

238
00:11:09,510 --> 00:11:16,710
and then the next D word will be will be

239
00:11:13,610 --> 00:11:19,650
decrypted<font color="#E5E5E5"> and then the next</font><font color="#CCCCCC"> reward</font><font color="#E5E5E5"> and</font>

240
00:11:16,710 --> 00:11:22,400
the next day word and then finally it

241
00:11:19,650 --> 00:11:22,400
<font color="#CCCCCC">will give you</font>

242
00:11:23,690 --> 00:11:31,550
this this is now your decrypted file

243
00:11:28,130 --> 00:11:33,920
that is your<font color="#CCCCCC"> husband that is the name</font><font color="#E5E5E5"> of</font>

244
00:11:31,550 --> 00:11:36,530
actually<font color="#E5E5E5"> the hospital this is the</font>

245
00:11:33,920 --> 00:11:39,229
process Explorer<font color="#CCCCCC"> this is the start of</font>

246
00:11:36,530 --> 00:11:42,170
<font color="#E5E5E5">the hospital earlier to do is to cut to</font>

247
00:11:39,230 --> 00:11:43,880
cut that particular part of the code<font color="#CCCCCC"> up</font>

248
00:11:42,170 --> 00:11:45,740
to the end of the pile and<font color="#E5E5E5"> then you</font>

249
00:11:43,880 --> 00:11:48,170
already<font color="#E5E5E5"> have your</font><font color="#CCCCCC"> hospital all</font><font color="#E5E5E5"> you have</font>

250
00:11:45,740 --> 00:11:50,000
<font color="#E5E5E5">to do is to use a to create like Python</font>

251
00:11:48,170 --> 00:11:54,170
script or some other script to extract

252
00:11:50,000 --> 00:11:56,950
the part that is how easy<font color="#CCCCCC"> it</font><font color="#E5E5E5"> is to</font><font color="#CCCCCC"> to to</font>

253
00:11:54,170 --> 00:11:59,630
clean the<font color="#E5E5E5"> villa if it is not yet</font>

254
00:11:56,950 --> 00:12:01,910
<font color="#CCCCCC">enhanced yet I think it's ready enhance</font>

255
00:11:59,630 --> 00:12:06,110
we have seen some<font color="#CCCCCC"> of the new samples</font>

256
00:12:01,910 --> 00:12:08,600
<font color="#CCCCCC">that we have here</font><font color="#E5E5E5"> so this is the key to</font>

257
00:12:06,110 --> 00:12:11,840
this<font color="#CCCCCC"> loophole that</font><font color="#E5E5E5"> key and then that's</font>

258
00:12:08,600 --> 00:12:13,730
the<font color="#CCCCCC"> host name</font><font color="#E5E5E5"> okay and that's it</font><font color="#CCCCCC"> you</font>

259
00:12:11,840 --> 00:12:17,630
already<font color="#CCCCCC"> have</font><font color="#E5E5E5"> your decrypted but that is</font>

260
00:12:13,730 --> 00:12:20,330
how<font color="#E5E5E5"> you extract</font><font color="#CCCCCC"> the impact that</font><font color="#E5E5E5"> pipe as</font>

261
00:12:17,630 --> 00:12:23,000
a metamorphic metamorphic is a different

262
00:12:20,330 --> 00:12:26,510
kind<font color="#E5E5E5"> of algorithm were in it tries to it</font>

263
00:12:23,000 --> 00:12:28,820
tries to<font color="#E5E5E5"> encrypt or decode or encode</font>

264
00:12:26,510 --> 00:12:31,040
your<font color="#E5E5E5"> file were in it's because it is</font>

265
00:12:28,820 --> 00:12:33,830
metamorphic your<font color="#CCCCCC"> antivirus engine</font>

266
00:12:31,040 --> 00:12:36,230
sometimes it is hard<font color="#CCCCCC"> for it to recognize</font>

267
00:12:33,830 --> 00:12:39,110
that it<font color="#E5E5E5"> is a malware because it can</font>

268
00:12:36,230 --> 00:12:41,300
still<font color="#CCCCCC"> run the code</font><font color="#E5E5E5"> the problem with this</font>

269
00:12:39,110 --> 00:12:43,070
one<font color="#E5E5E5"> is when you say metamorphic</font>

270
00:12:41,300 --> 00:12:45,709
algorithm the basics let's look at the

271
00:12:43,070 --> 00:12:47,750
basics<font color="#CCCCCC"> April sample you</font><font color="#E5E5E5"> want to put a</font>

272
00:12:45,710 --> 00:12:50,150
value<font color="#CCCCCC"> 0 in a certain register which is</font>

273
00:12:47,750 --> 00:12:52,400
<font color="#E5E5E5">like a variable</font><font color="#CCCCCC"> in assembly</font><font color="#E5E5E5"> the assembly</font>

274
00:12:50,150 --> 00:12:54,860
<font color="#E5E5E5">language for</font><font color="#CCCCCC"> example you want to put</font>

275
00:12:52,400 --> 00:12:59,000
<font color="#E5E5E5">value 0 to</font><font color="#CCCCCC"> e ax you can do that in</font>

276
00:12:54,860 --> 00:13:02,780
several ways<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can put 0 to e ax</font><font color="#E5E5E5"> you</font>

277
00:12:59,000 --> 00:13:05,750
can ex or<font color="#CCCCCC"> ax</font><font color="#E5E5E5"> you can subtract it</font><font color="#CCCCCC"> you can</font>

278
00:13:02,780 --> 00:13:07,730
do this and then everything<font color="#E5E5E5"> will result</font>

279
00:13:05,750 --> 00:13:10,520
in the<font color="#CCCCCC"> same thing which is the value of</font>

280
00:13:07,730 --> 00:13:13,220
<font color="#E5E5E5">0 will be placed to</font><font color="#CCCCCC"> ax</font><font color="#E5E5E5"> K that is how</font>

281
00:13:10,520 --> 00:13:15,050
metamorphic code works<font color="#CCCCCC"> okay if you're</font>

282
00:13:13,220 --> 00:13:17,720
going<font color="#CCCCCC"> to if you're going to scan it with</font>

283
00:13:15,050 --> 00:13:21,079
your<font color="#E5E5E5"> antivirus scanner</font><font color="#CCCCCC"> it will look like</font>

284
00:13:17,720 --> 00:13:23,480
<font color="#E5E5E5">us just the regular code even it is it</font>

285
00:13:21,080 --> 00:13:27,190
is sometimes hard<font color="#E5E5E5"> to to tell if it is</font>

286
00:13:23,480 --> 00:13:27,190
<font color="#E5E5E5">malicious or not</font><font color="#CCCCCC"> ok</font>

287
00:13:27,310 --> 00:13:32,109
it is hard<font color="#CCCCCC"> to find</font><font color="#E5E5E5"> similar</font><font color="#CCCCCC"> bites because</font>

288
00:13:28,900 --> 00:13:34,300
it tries to to reorganize the<font color="#CCCCCC"> code okay</font>

289
00:13:32,110 --> 00:13:37,540
unpredictable code and unknown length of

290
00:13:34,300 --> 00:13:39,370
bytes<font color="#CCCCCC"> the generated metamorphic code</font>

291
00:13:37,540 --> 00:13:41,410
wishes on this particular part the lower

292
00:13:39,370 --> 00:13:44,470
<font color="#E5E5E5">part there is the</font><font color="#CCCCCC"> very first</font><font color="#E5E5E5"> one to be</font>

293
00:13:41,410 --> 00:13:47,069
executed<font color="#E5E5E5"> okay and then a maximum</font>

294
00:13:44,470 --> 00:13:49,990
different sizes<font color="#CCCCCC"> a</font><font color="#E5E5E5"> maximum of</font>

295
00:13:47,070 --> 00:13:51,910
approximately<font color="#CCCCCC"> 20 kilobytes</font><font color="#E5E5E5"> and then all</font>

296
00:13:49,990 --> 00:13:53,770
you have<font color="#E5E5E5"> to do is to look for something</font>

297
00:13:51,910 --> 00:13:55,990
it will end and then if you want to

298
00:13:53,770 --> 00:13:58,240
<font color="#CCCCCC">pylori burst</font><font color="#E5E5E5"> the malware</font><font color="#CCCCCC"> all you have</font><font color="#E5E5E5"> to</font>

299
00:13:55,990 --> 00:14:00,970
do is to look for the escape<font color="#E5E5E5"> or they</font>

300
00:13:58,240 --> 00:14:04,360
jump or the call<font color="#E5E5E5"> okay we'll see that a</font>

301
00:14:00,970 --> 00:14:07,150
<font color="#E5E5E5">bit later</font><font color="#CCCCCC"> I compare sample wound I have</font>

302
00:14:04,360 --> 00:14:09,790
sample 1 sample 2 different infection

303
00:14:07,150 --> 00:14:14,140
algorithm<font color="#CCCCCC"> for different infected parts</font>

304
00:14:09,790 --> 00:14:19,089
he were in this particular group of

305
00:14:14,140 --> 00:14:19,750
codes is only is<font color="#CCCCCC"> only used to to the</font>

306
00:14:19,089 --> 00:14:22,330
<font color="#CCCCCC">clip</font>

307
00:14:19,750 --> 00:14:24,730
this particular<font color="#CCCCCC"> poor bytes imagine if</font>

308
00:14:22,330 --> 00:14:28,680
your troll trying to<font color="#E5E5E5"> analyze the malware</font>

309
00:14:24,730 --> 00:14:30,940
<font color="#CCCCCC">okay and you</font><font color="#E5E5E5"> are you only have one hour</font>

310
00:14:28,680 --> 00:14:32,739
<font color="#CCCCCC">caper</font><font color="#E5E5E5"> because the customer is</font><font color="#CCCCCC"> already</font>

311
00:14:30,940 --> 00:14:35,620
<font color="#E5E5E5">impacted you only have one or</font><font color="#CCCCCC"> two</font>

312
00:14:32,740 --> 00:14:40,089
<font color="#CCCCCC">analyze the malware code and then this</font>

313
00:14:35,620 --> 00:14:44,170
one is only decrypting<font color="#E5E5E5"> or bytes from</font>

314
00:14:40,089 --> 00:14:46,620
here to here<font color="#CCCCCC"> another another set of</font>

315
00:14:44,170 --> 00:14:50,469
codes<font color="#E5E5E5"> to the creep and other poor bytes</font>

316
00:14:46,620 --> 00:14:53,920
imagine how much how much longer<font color="#E5E5E5"> you're</font>

317
00:14:50,470 --> 00:14:56,560
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> generate the actual malware to</font>

318
00:14:53,920 --> 00:14:59,770
analyze<font color="#E5E5E5"> hey there is the first sample</font>

319
00:14:56,560 --> 00:15:02,979
that<font color="#CCCCCC"> I had</font><font color="#E5E5E5"> in a second sample I didn't</font>

320
00:14:59,770 --> 00:15:05,500
remove the square to compare that the

321
00:15:02,980 --> 00:15:09,670
next sample has a smaller number<font color="#E5E5E5"> of</font>

322
00:15:05,500 --> 00:15:11,920
codes<font color="#CCCCCC"> generate the same thing</font><font color="#E5E5E5"> okay this</font>

323
00:15:09,670 --> 00:15:14,560
one the<font color="#E5E5E5"> first sample has longer cause</font>

324
00:15:11,920 --> 00:15:17,500
for the second avoid the words<font color="#E5E5E5"> just</font><font color="#CCCCCC"> four</font>

325
00:15:14,560 --> 00:15:20,979
<font color="#E5E5E5">bytes and that third</font><font color="#CCCCCC"> D word is the code</font>

326
00:15:17,500 --> 00:15:22,780
is longer but they still generate the

327
00:15:20,980 --> 00:15:25,180
same<font color="#E5E5E5"> code all you have to do is to look</font>

328
00:15:22,780 --> 00:15:28,630
for those<font color="#E5E5E5"> things if you want to make to</font>

329
00:15:25,180 --> 00:15:30,010
scan that particular set of malware<font color="#CCCCCC"> k to</font>

330
00:15:28,630 --> 00:15:31,839
scan all the<font color="#CCCCCC"> paths</font><font color="#E5E5E5"> that is already</font>

331
00:15:30,010 --> 00:15:34,120
<font color="#CCCCCC">infected all you have</font><font color="#E5E5E5"> to do is to</font>

332
00:15:31,839 --> 00:15:36,940
decrypt<font color="#E5E5E5"> the malware purse</font>

333
00:15:34,120 --> 00:15:40,030
<font color="#E5E5E5">okay and then you have to find that code</font>

334
00:15:36,940 --> 00:15:43,540
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> that sample one this is some</font><font color="#CCCCCC"> too</font>

335
00:15:40,030 --> 00:15:45,750
another set of comparison<font color="#E5E5E5"> okay even the</font>

336
00:15:43,540 --> 00:15:51,730
registers that<font color="#CCCCCC"> is used is different</font>

337
00:15:45,750 --> 00:15:53,650
<font color="#CCCCCC">Hey EDI eax</font><font color="#E5E5E5"> sample1 sample2 were in if</font>

338
00:15:51,730 --> 00:15:55,800
you want<font color="#E5E5E5"> to make a detection all you</font>

339
00:15:53,650 --> 00:15:59,170
have to do is to look for the skull

340
00:15:55,800 --> 00:16:03,310
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> and then you can detect all</font><font color="#CCCCCC"> the</font>

341
00:15:59,170 --> 00:16:06,160
<font color="#E5E5E5">impacted parts this looks of some of the</font>

342
00:16:03,310 --> 00:16:08,140
so this<font color="#E5E5E5"> is how the metamorphic runs in a</font>

343
00:16:06,160 --> 00:16:10,319
debugger<font color="#CCCCCC"> I used</font><font color="#E5E5E5"> all the debug for this</font>

344
00:16:08,140 --> 00:16:10,319
one

345
00:16:11,510 --> 00:16:17,750
<font color="#E5E5E5">to decrypt that particular</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> bytes</font>

346
00:16:14,360 --> 00:16:20,870
and then<font color="#CCCCCC"> Rast the second set of second</font>

347
00:16:17,750 --> 00:16:25,600
<font color="#CCCCCC">setup code</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> they creep another set</font>

348
00:16:20,870 --> 00:16:29,120
of<font color="#E5E5E5"> four bytes and then until it runs it</font>

349
00:16:25,600 --> 00:16:32,270
<font color="#E5E5E5">decrypted the whole thing he take note</font>

350
00:16:29,120 --> 00:16:34,970
that<font color="#E5E5E5"> it</font><font color="#CCCCCC"> is only decoding</font><font color="#E5E5E5"> the first set</font>

351
00:16:32,270 --> 00:16:37,579
of<font color="#E5E5E5"> bytes as a proper set of course</font>

352
00:16:34,970 --> 00:16:41,720
earlier<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> not yet</font><font color="#E5E5E5"> the main function</font>

353
00:16:37,580 --> 00:16:43,820
<font color="#E5E5E5">we</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> not yet in the in the polymorphic</font>

354
00:16:41,720 --> 00:16:49,270
<font color="#E5E5E5">code right so it is decrypting those</font>

355
00:16:43,820 --> 00:16:49,270
things it is<font color="#CCCCCC"> not running anymore</font>

356
00:16:54,870 --> 00:16:59,350
you

357
00:16:56,860 --> 00:17:02,290
you can see that it<font color="#E5E5E5"> is the closest</font>

358
00:16:59,350 --> 00:17:05,380
changing one<font color="#CCCCCC"> thing with the metamorphic</font>

359
00:17:02,290 --> 00:17:06,940
<font color="#E5E5E5">malware</font><font color="#CCCCCC"> metameric code</font><font color="#E5E5E5"> is every time</font>

360
00:17:05,380 --> 00:17:09,940
<font color="#E5E5E5">that they do the metamour because</font>

361
00:17:06,940 --> 00:17:11,380
there's always a jump out<font color="#CCCCCC"> a call-out all</font>

362
00:17:09,940 --> 00:17:15,100
you have to do is to look for this one

363
00:17:11,380 --> 00:17:16,930
<font color="#E5E5E5">so this particular technique will will</font>

364
00:17:15,099 --> 00:17:19,959
doesn't<font color="#E5E5E5"> only work for this malware</font>

365
00:17:16,930 --> 00:17:22,150
if you encounter<font color="#E5E5E5"> a new</font><font color="#CCCCCC"> malware that uses</font>

366
00:17:19,960 --> 00:17:24,460
metamorphic code<font color="#E5E5E5"> all you have to do is</font>

367
00:17:22,150 --> 00:17:27,910
to look for the<font color="#CCCCCC"> call-out or the jump out</font>

368
00:17:24,460 --> 00:17:31,120
put a breakpoint<font color="#E5E5E5"> on that particular code</font>

369
00:17:27,910 --> 00:17:34,060
<font color="#CCCCCC">run the malware</font><font color="#E5E5E5"> on the debugger and then</font>

370
00:17:31,120 --> 00:17:36,729
the set<font color="#E5E5E5"> it will stop on that particular</font>

371
00:17:34,060 --> 00:17:40,020
call or jump and then you have now your

372
00:17:36,730 --> 00:17:44,560
decoded code<font color="#CCCCCC"> case somewhere at the end</font>

373
00:17:40,020 --> 00:17:47,160
<font color="#CCCCCC">okay of this 1k there will be a jump out</font>

374
00:17:44,560 --> 00:17:47,159
a<font color="#CCCCCC"> call-out</font>

375
00:17:47,760 --> 00:17:50,179
or this

376
00:17:50,640 --> 00:17:55,770
look for<font color="#E5E5E5"> that one for the metamorphic</font>

377
00:17:52,800 --> 00:17:59,810
code and then<font color="#CCCCCC"> breakpoint</font><font color="#E5E5E5"> once you go</font>

378
00:17:55,770 --> 00:18:03,480
<font color="#E5E5E5">back to the code you will see the same</font>

379
00:17:59,810 --> 00:18:06,990
decrypted code which is<font color="#E5E5E5"> the metamorphic</font>

380
00:18:03,480 --> 00:18:09,900
<font color="#CCCCCC">okay this one this is</font><font color="#E5E5E5"> the same</font><font color="#CCCCCC"> hey that</font>

381
00:18:06,990 --> 00:18:12,510
<font color="#E5E5E5">is how you try to to beat metamorphic</font>

382
00:18:09,900 --> 00:18:15,120
code in any<font color="#E5E5E5"> malware</font><font color="#CCCCCC"> it doesn't apply</font>

383
00:18:12,510 --> 00:18:17,720
<font color="#CCCCCC">only on</font><font color="#E5E5E5"> to this one is only poor for the</font>

384
00:18:15,120 --> 00:18:21,949
rest of<font color="#E5E5E5"> the metamorphic malware samples</font>

385
00:18:17,720 --> 00:18:21,950
<font color="#E5E5E5">let's go now to the polymorphic</font>

386
00:18:22,350 --> 00:18:28,168
we<font color="#E5E5E5"> executed this one earlier there's a</font>

387
00:18:25,350 --> 00:18:30,899
metamorphic<font color="#E5E5E5"> code</font><font color="#CCCCCC"> it only produces the</font>

388
00:18:28,169 --> 00:18:33,840
decoded bytes<font color="#E5E5E5"> and now the main function</font>

389
00:18:30,899 --> 00:18:36,080
produces<font color="#E5E5E5"> this one okay let's</font><font color="#CCCCCC"> now see</font>

390
00:18:33,840 --> 00:18:40,500
what<font color="#CCCCCC"> happens to the on-demand</font>

391
00:18:36,080 --> 00:18:41,490
<font color="#E5E5E5">polymorphic hey what happen is it uses</font>

392
00:18:40,500 --> 00:18:44,220
at the<font color="#CCCCCC"> crypto</font>

393
00:18:41,490 --> 00:18:47,039
all you have to do is to look for K for

394
00:18:44,220 --> 00:18:49,799
the decrypt or code<font color="#CCCCCC"> k the Decrypter code</font>

395
00:18:47,039 --> 00:18:52,350
<font color="#CCCCCC">k it the</font><font color="#E5E5E5"> malware author makes it harder</font>

396
00:18:49,799 --> 00:18:54,149
again<font color="#CCCCCC"> k they put garbage code were in</font>

397
00:18:52,350 --> 00:18:57,029
those are the<font color="#CCCCCC"> codes that</font><font color="#E5E5E5"> you don't</font>

398
00:18:54,149 --> 00:19:00,268
actually<font color="#E5E5E5"> need but they put it in order</font>

399
00:18:57,029 --> 00:19:03,210
<font color="#E5E5E5">for you to to make their analysis longer</font>

400
00:19:00,269 --> 00:19:07,220
harder<font color="#CCCCCC"> write garbage code</font><font color="#E5E5E5"> redundancy</font>

401
00:19:03,210 --> 00:19:09,870
check but it only uses a regular<font color="#CCCCCC"> X or</font>

402
00:19:07,220 --> 00:19:13,669
algorithm<font color="#CCCCCC"> okay this is the general code</font>

403
00:19:09,870 --> 00:19:17,330
<font color="#E5E5E5">these are the a doesn't show the</font><font color="#CCCCCC"> pool</font><font color="#E5E5E5"> it</font>

404
00:19:13,669 --> 00:19:17,330
shows here

405
00:19:21,750 --> 00:19:28,880
it's not working<font color="#CCCCCC"> it's supposed to be</font>

406
00:19:25,050 --> 00:19:31,580
showing the code here which is not there

407
00:19:28,880 --> 00:19:35,270
hey those are<font color="#CCCCCC"> the supposed to be the</font>

408
00:19:31,580 --> 00:19:35,270
code let me see<font color="#E5E5E5"> again</font>

409
00:19:35,610 --> 00:19:39,929
<font color="#CCCCCC">but you can see from</font><font color="#E5E5E5"> here the small one</font>

410
00:19:37,710 --> 00:19:43,230
<font color="#E5E5E5">it should</font><font color="#CCCCCC"> be something like this okay</font>

411
00:19:39,930 --> 00:19:45,180
<font color="#CCCCCC">and then some</font><font color="#E5E5E5"> of the the red one should</font>

412
00:19:43,230 --> 00:19:48,090
be should be<font color="#E5E5E5"> the garbage code which is</font>

413
00:19:45,180 --> 00:19:51,840
not<font color="#CCCCCC"> to be to be used by the the malware</font>

414
00:19:48,090 --> 00:19:53,639
<font color="#E5E5E5">it uses this one the RDP SC function is</font>

415
00:19:51,840 --> 00:19:56,580
the one that<font color="#E5E5E5"> generates a random key</font>

416
00:19:53,640 --> 00:20:00,300
<font color="#E5E5E5">that's why when every</font><font color="#CCCCCC"> trance that code</font>

417
00:19:56,580 --> 00:20:03,000
<font color="#E5E5E5">it goes back it generates another key</font><font color="#CCCCCC"> K</font>

418
00:20:00,300 --> 00:20:05,909
for it<font color="#E5E5E5"> to encrypt the malware back again</font>

419
00:20:03,000 --> 00:20:09,000
and then it<font color="#E5E5E5"> uses the new new key and</font>

420
00:20:05,910 --> 00:20:13,200
then but it is still<font color="#E5E5E5"> using the simple</font>

421
00:20:09,000 --> 00:20:16,800
<font color="#E5E5E5">XOR bytes</font><font color="#CCCCCC"> exhorting of the code</font>

422
00:20:13,200 --> 00:20:19,380
<font color="#E5E5E5">see what this one</font><font color="#CCCCCC"> looks like this is</font><font color="#E5E5E5"> the</font>

423
00:20:16,800 --> 00:20:25,970
one that<font color="#E5E5E5"> generates the new key new key</font>

424
00:20:19,380 --> 00:20:25,970
code and then you now have<font color="#CCCCCC"> your new key</font>

425
00:20:26,460 --> 00:20:33,600
you can see that for this<font color="#CCCCCC"> particular</font>

426
00:20:28,920 --> 00:20:36,300
part<font color="#CCCCCC"> okay this word is the key and then</font>

427
00:20:33,600 --> 00:20:38,850
once it generates back<font color="#CCCCCC"> you will</font><font color="#E5E5E5"> see that</font>

428
00:20:36,300 --> 00:20:43,970
there is<font color="#CCCCCC"> a different key</font><font color="#E5E5E5"> that it</font><font color="#CCCCCC"> uses</font>

429
00:20:38,850 --> 00:20:43,969
<font color="#CCCCCC">for the next set of encrypted</font><font color="#E5E5E5"> bytes</font>

430
00:20:45,549 --> 00:20:51,820
and there is your<font color="#E5E5E5"> on-demand polymorphic</font>

431
00:20:48,639 --> 00:20:54,939
algorithm and then it just increased so

432
00:20:51,820 --> 00:20:57,428
the<font color="#E5E5E5"> process is</font><font color="#CCCCCC"> it decrypts it</font><font color="#E5E5E5"> runs the</font>

433
00:20:54,940 --> 00:21:01,269
code and gives it<font color="#E5E5E5"> back with another key</font>

434
00:20:57,429 --> 00:21:03,789
<font color="#E5E5E5">it will look something like this this is</font>

435
00:21:01,269 --> 00:21:07,749
<font color="#E5E5E5">your</font><font color="#CCCCCC"> original or the purse encrypted</font>

436
00:21:03,789 --> 00:21:11,019
bytes encrypted codes<font color="#E5E5E5"> okay with the</font><font color="#CCCCCC"> Alt</font>

437
00:21:07,749 --> 00:21:15,749
key<font color="#CCCCCC"> I just get the first 16 bytes here</font>

438
00:21:11,019 --> 00:21:18,009
and then once it is decrypted it

439
00:21:15,749 --> 00:21:21,070
<font color="#CCCCCC">executes the malware</font><font color="#E5E5E5"> execute that</font>

440
00:21:18,009 --> 00:21:23,590
particular code and then once it is<font color="#E5E5E5"> done</font>

441
00:21:21,070 --> 00:21:27,340
<font color="#CCCCCC">executing that particular group of code</font>

442
00:21:23,590 --> 00:21:30,100
it now decrypts it<font color="#E5E5E5"> with the new key</font><font color="#CCCCCC"> okay</font>

443
00:21:27,340 --> 00:21:34,119
take note<font color="#CCCCCC"> that these are the same set of</font>

444
00:21:30,100 --> 00:21:37,719
<font color="#E5E5E5">codes based on the and this one okay but</font>

445
00:21:34,119 --> 00:21:40,629
they are now<font color="#E5E5E5"> different</font><font color="#CCCCCC"> bytes</font><font color="#E5E5E5"> because of</font>

446
00:21:37,720 --> 00:21:42,970
the<font color="#CCCCCC"> on-demand polymorphic okay</font><font color="#E5E5E5"> how do</font>

447
00:21:40,629 --> 00:21:44,830
you<font color="#E5E5E5"> detect this</font><font color="#CCCCCC"> kind of samples all you</font>

448
00:21:42,970 --> 00:21:48,639
have to do is to wait<font color="#E5E5E5"> for</font><font color="#CCCCCC"> it to be</font>

449
00:21:44,830 --> 00:21:50,499
decrypted<font color="#E5E5E5"> and then get the detection</font>

450
00:21:48,639 --> 00:21:53,199
<font color="#E5E5E5">here because every time even</font><font color="#CCCCCC"> though</font>

451
00:21:50,499 --> 00:21:55,809
other samples is different from<font color="#E5E5E5"> each</font>

452
00:21:53,200 --> 00:21:58,119
<font color="#CCCCCC">other okay but the decrypted code is</font>

453
00:21:55,809 --> 00:22:00,249
always the same so all you have<font color="#E5E5E5"> to do is</font>

454
00:21:58,119 --> 00:22:02,678
if<font color="#E5E5E5"> you're trying to make a scanner to</font>

455
00:22:00,249 --> 00:22:05,289
<font color="#E5E5E5">detect this sample by script or your</font>

456
00:22:02,679 --> 00:22:07,539
antivirus<font color="#E5E5E5"> engine or job to do is to look</font>

457
00:22:05,289 --> 00:22:11,529
for the decrypted code and then you can

458
00:22:07,539 --> 00:22:14,529
scan the<font color="#E5E5E5"> rest of the impacted virus and</font>

459
00:22:11,529 --> 00:22:17,259
also from the code<font color="#E5E5E5"> you can do not get</font>

460
00:22:14,529 --> 00:22:18,789
from the from the<font color="#E5E5E5"> code word were in it</font>

461
00:22:17,259 --> 00:22:21,309
contains the garbage code because it

462
00:22:18,789 --> 00:22:25,350
changes it always changed<font color="#E5E5E5"> so you have to</font>

463
00:22:21,309 --> 00:22:25,350
get it from the Decrypter itself

464
00:22:26,770 --> 00:22:32,440
let's proceed now in unlocking<font color="#CCCCCC"> Bella</font>

465
00:22:29,080 --> 00:22:37,389
going back to the screen<font color="#CCCCCC"> we're actually</font>

466
00:22:32,440 --> 00:22:39,880
very<font color="#E5E5E5"> fast Hey so again this is your</font>

467
00:22:37,390 --> 00:22:42,730
screen<font color="#E5E5E5"> and then if you're infected</font><font color="#CCCCCC"> with</font>

468
00:22:39,880 --> 00:22:44,800
be lucky you cannot do anything<font color="#E5E5E5"> you can</font>

469
00:22:42,730 --> 00:22:48,809
always<font color="#E5E5E5"> just go</font><font color="#CCCCCC"> around</font><font color="#E5E5E5"> if you're</font><font color="#CCCCCC"> infected</font>

470
00:22:44,800 --> 00:22:48,809
you<font color="#CCCCCC"> can just go around until you pay</font>

471
00:22:49,880 --> 00:22:55,400
<font color="#CCCCCC">by bitcoins hey</font><font color="#E5E5E5"> that's the only thing</font>

472
00:22:52,820 --> 00:22:59,120
that you can do<font color="#E5E5E5"> the only problem is can</font>

473
00:22:55,400 --> 00:23:01,190
we unlock<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> if we unlock this</font>

474
00:22:59,120 --> 00:23:03,739
one<font color="#E5E5E5"> we still have another problem</font><font color="#CCCCCC"> your</font>

475
00:23:01,190 --> 00:23:06,080
files are still impacted<font color="#E5E5E5"> right so I'm</font>

476
00:23:03,740 --> 00:23:08,870
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> show you how</font><font color="#E5E5E5"> to unlock and</font>

477
00:23:06,080 --> 00:23:10,909
<font color="#CCCCCC">then probably just download some clean</font>

478
00:23:08,870 --> 00:23:13,280
pass or run<font color="#CCCCCC"> your anti-bias because if</font>

479
00:23:10,910 --> 00:23:17,179
your screen<font color="#CCCCCC"> is locked you cannot even</font>

480
00:23:13,280 --> 00:23:20,559
run<font color="#CCCCCC"> your antivirus software right so</font>

481
00:23:17,179 --> 00:23:20,559
we're going<font color="#E5E5E5"> to unlock this one</font>

482
00:23:23,220 --> 00:23:30,559
this so I execute this one with my<font color="#E5E5E5"> XP</font><font color="#CCCCCC"> I</font>

483
00:23:27,120 --> 00:23:30,559
<font color="#E5E5E5">executed it in</font><font color="#CCCCCC"> real-time</font>

484
00:23:31,280 --> 00:23:36,920
I am<font color="#E5E5E5"> impacted that's how you you see</font>

485
00:23:34,970 --> 00:23:40,060
that<font color="#E5E5E5"> you are infected</font><font color="#CCCCCC"> with a real-time</font><font color="#E5E5E5"> I</font>

486
00:23:36,920 --> 00:23:40,060
restart the<font color="#E5E5E5"> machine</font>

487
00:23:45,200 --> 00:23:52,559
<font color="#E5E5E5">a it looks it looks</font><font color="#CCCCCC"> clean and then I</font>

488
00:23:49,200 --> 00:23:54,690
put some<font color="#CCCCCC"> timer for us to know</font><font color="#E5E5E5"> if they</font>

489
00:23:52,559 --> 00:23:56,940
<font color="#CCCCCC">are there's</font><font color="#E5E5E5"> nothing so when you restart</font>

490
00:23:54,690 --> 00:23:59,309
<font color="#CCCCCC">your computer it</font><font color="#E5E5E5"> looks like you're not</font>

491
00:23:56,940 --> 00:24:03,539
<font color="#E5E5E5">impacted anymore right because I was</font>

492
00:23:59,309 --> 00:24:04,769
impacted<font color="#E5E5E5"> I restart</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> waited for it</font><font color="#CCCCCC"> to -</font>

493
00:24:03,539 --> 00:24:06,960
because when<font color="#E5E5E5"> you restart</font><font color="#CCCCCC"> your Windows</font>

494
00:24:04,769 --> 00:24:11,370
<font color="#CCCCCC">you still have to wait for the</font><font color="#E5E5E5"> rest</font><font color="#CCCCCC"> of</font>

495
00:24:06,960 --> 00:24:15,200
<font color="#E5E5E5">your your applications right it looks</font>

496
00:24:11,370 --> 00:24:18,840
<font color="#E5E5E5">like it is not impacted anymore</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> but</font>

497
00:24:15,200 --> 00:24:22,279
somewhere around<font color="#E5E5E5"> how many seconds</font><font color="#CCCCCC"> I</font>

498
00:24:18,840 --> 00:24:22,279
think<font color="#CCCCCC"> three</font><font color="#E5E5E5"> days</font>

499
00:24:23,510 --> 00:24:27,750
we don't have enough time<font color="#E5E5E5"> to</font><font color="#CCCCCC"> learn I'm</font>

500
00:24:25,370 --> 00:24:30,570
just kidding

501
00:24:27,750 --> 00:24:32,640
<font color="#E5E5E5">a</font><font color="#CCCCCC"> real-time but the pure machine</font><font color="#E5E5E5"> is</font>

502
00:24:30,570 --> 00:24:35,189
faster this machine is actually slow<font color="#E5E5E5"> if</font>

503
00:24:32,640 --> 00:24:37,620
you<font color="#CCCCCC"> have machines faster</font><font color="#E5E5E5"> probably a few</font>

504
00:24:35,190 --> 00:24:41,120
seconds and then voila<font color="#E5E5E5"> you already have</font>

505
00:24:37,620 --> 00:24:45,330
again<font color="#E5E5E5"> your brain laughs</font><font color="#CCCCCC"> so this one</font><font color="#E5E5E5"> in</font>

506
00:24:41,120 --> 00:24:48,149
52 seconds 53 seconds<font color="#E5E5E5"> it will show again</font>

507
00:24:45,330 --> 00:24:52,020
<font color="#CCCCCC">your impacted parts actually</font><font color="#E5E5E5"> with this</font>

508
00:24:48,150 --> 00:24:54,270
one<font color="#E5E5E5"> you cannot actually ran this so this</font>

509
00:24:52,020 --> 00:24:56,639
particular<font color="#E5E5E5"> part is actually showing you</font>

510
00:24:54,270 --> 00:25:00,180
how to unlock<font color="#E5E5E5"> the villa all you have to</font>

511
00:24:56,640 --> 00:25:04,890
do is if you're using<font color="#CCCCCC"> windows k run</font><font color="#E5E5E5"> it</font>

512
00:25:00,180 --> 00:25:07,200
in safe mode right sleep mode<font color="#E5E5E5"> I am now</font>

513
00:25:04,890 --> 00:25:09,810
in safe mode<font color="#CCCCCC"> the good thing is the</font>

514
00:25:07,200 --> 00:25:14,240
malware<font color="#E5E5E5"> is not running during the safe</font>

515
00:25:09,810 --> 00:25:14,240
mode<font color="#E5E5E5"> okay afterwards</font>

516
00:25:15,120 --> 00:25:20,090
look for the go to your registry editor

517
00:25:20,200 --> 00:25:26,080
take note that<font color="#E5E5E5"> this particular technique</font>

518
00:25:22,690 --> 00:25:29,970
<font color="#CCCCCC">K can also work with other samples okay</font>

519
00:25:26,080 --> 00:25:34,899
not<font color="#E5E5E5"> just not just burn up okay look</font><font color="#CCCCCC"> poor</font>

520
00:25:29,970 --> 00:25:37,529
<font color="#E5E5E5">usually they</font><font color="#CCCCCC"> start up he the run</font><font color="#E5E5E5"> just</font>

521
00:25:34,899 --> 00:25:37,529
<font color="#E5E5E5">search for run</font>

522
00:25:38,250 --> 00:25:44,400
<font color="#CCCCCC">I am on safe mode I'm running registry</font>

523
00:25:40,590 --> 00:25:48,810
editor<font color="#CCCCCC"> okay as you can see there is an</font>

524
00:25:44,400 --> 00:25:51,090
executable here that is<font color="#E5E5E5"> actually runs</font>

525
00:25:48,810 --> 00:25:53,310
the<font color="#E5E5E5"> the malware the</font><font color="#CCCCCC"> Billa</font>

526
00:25:51,090 --> 00:25:55,050
all you have<font color="#E5E5E5"> to do is delete that</font>

527
00:25:53,310 --> 00:26:00,419
malware<font color="#CCCCCC"> Hey</font>

528
00:25:55,050 --> 00:26:02,760
but the the malware<font color="#E5E5E5"> actually has to he</font>

529
00:26:00,420 --> 00:26:05,550
died once the backup<font color="#CCCCCC"> okay find another</font>

530
00:26:02,760 --> 00:26:07,770
one by the<font color="#E5E5E5"> other the backup file</font><font color="#CCCCCC"> okay</font>

531
00:26:05,550 --> 00:26:10,500
there's another<font color="#E5E5E5"> one okay if you're</font>

532
00:26:07,770 --> 00:26:12,810
<font color="#E5E5E5">infected with Billa there are two files</font>

533
00:26:10,500 --> 00:26:16,640
running<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Auto Start mode</font>

534
00:26:12,810 --> 00:26:16,639
<font color="#CCCCCC">okay you have</font><font color="#E5E5E5"> to delete both of them</font>

535
00:26:18,600 --> 00:26:23,879
now you can now restart<font color="#E5E5E5"> your</font><font color="#CCCCCC"> machine Hey</font>

536
00:26:21,570 --> 00:26:26,520
remember earlier<font color="#CCCCCC"> when we restarted the</font>

537
00:26:23,880 --> 00:26:29,400
<font color="#E5E5E5">machine Peters 52 seconds from the boot</font>

538
00:26:26,520 --> 00:26:32,330
up it will show again the transformer

539
00:26:29,400 --> 00:26:35,330
not right<font color="#E5E5E5"> let's see this very still</font>

540
00:26:32,330 --> 00:26:35,330
impacted

541
00:26:39,610 --> 00:26:47,820
running in<font color="#CCCCCC"> real-time I restarted</font><font color="#E5E5E5"> after</font>

542
00:26:42,190 --> 00:26:47,820
<font color="#E5E5E5">deleting the autorun registry key</font>

543
00:26:52,210 --> 00:26:55,080
<font color="#CCCCCC">they're running</font>

544
00:26:58,090 --> 00:27:00,149
you

545
00:27:14,820 --> 00:27:20,100
<font color="#CCCCCC">fifty-two seconds we will see</font><font color="#E5E5E5"> supposed</font>

546
00:27:17,640 --> 00:27:21,720
to<font color="#E5E5E5"> be if you're still infected</font><font color="#CCCCCC"> or you</font>

547
00:27:20,100 --> 00:27:25,320
are actually<font color="#E5E5E5"> still impacted because we</font>

548
00:27:21,720 --> 00:27:25,830
<font color="#E5E5E5">just clean the screen up the</font><font color="#CCCCCC"> black</font>

549
00:27:25,320 --> 00:27:28,439
<font color="#E5E5E5">screen</font>

550
00:27:25,830 --> 00:27:32,760
right we<font color="#E5E5E5"> just remove the lock screen</font><font color="#CCCCCC"> P 2</font>

551
00:27:28,440 --> 00:27:35,280
<font color="#CCCCCC">2 seconds 53 54</font><font color="#E5E5E5"> so your lock screen is</font>

552
00:27:32,760 --> 00:27:37,140
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> dub the particular part that we</font>

553
00:27:35,280 --> 00:27:40,260
deleted from the registry editor<font color="#E5E5E5"> is</font>

554
00:27:37,140 --> 00:27:42,750
actually the one running the the<font color="#CCCCCC"> screen</font>

555
00:27:40,260 --> 00:27:46,500
<font color="#E5E5E5">the locking</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is actually the malware</font>

556
00:27:42,750 --> 00:27:50,010
code<font color="#CCCCCC"> okay so now we unlock the screen</font>

557
00:27:46,500 --> 00:27:53,040
<font color="#E5E5E5">but again as I tell</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> you're in your</font>

558
00:27:50,010 --> 00:27:56,430
<font color="#CCCCCC">machine is still impacted okay</font><font color="#E5E5E5"> your</font>

559
00:27:53,040 --> 00:27:59,010
files<font color="#E5E5E5"> are still impacted</font><font color="#CCCCCC"> okay you have</font>

560
00:27:56,430 --> 00:28:02,630
to do<font color="#E5E5E5"> after this</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so the screen is</font>

561
00:27:59,010 --> 00:28:05,460
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> you can now install</font><font color="#E5E5E5"> your your</font>

562
00:28:02,630 --> 00:28:07,740
<font color="#E5E5E5">antivirus software or your script that</font>

563
00:28:05,460 --> 00:28:11,010
you created<font color="#E5E5E5"> to in to get those files or</font>

564
00:28:07,740 --> 00:28:15,360
if you don't<font color="#E5E5E5"> have any important files in</font>

565
00:28:11,010 --> 00:28:17,960
<font color="#CCCCCC">your system</font><font color="#E5E5E5"> just just install a new</font><font color="#CCCCCC"> one</font>

566
00:28:15,360 --> 00:28:17,959
okay

567
00:28:18,960 --> 00:28:26,190
that is 143<font color="#E5E5E5"> 145 and</font><font color="#CCCCCC"> son and support and</font>

568
00:28:23,550 --> 00:28:29,010
then that's it<font color="#E5E5E5"> your screen is</font><font color="#CCCCCC"> unlocked</font>

569
00:28:26,190 --> 00:28:32,240
that that<font color="#CCCCCC"> particular technique can work</font>

570
00:28:29,010 --> 00:28:32,240
in other malware<font color="#CCCCCC"> too</font>

571
00:28:32,410 --> 00:28:42,790
oh<font color="#E5E5E5"> we're done not yet</font><font color="#CCCCCC"> okay in conclusion</font>

572
00:28:37,590 --> 00:28:45,159
<font color="#E5E5E5">only in 30 minutes yes</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> some challenges</font>

573
00:28:42,790 --> 00:28:47,620
in<font color="#E5E5E5"> the ransomware</font><font color="#CCCCCC"> is sometimes it's hard</font>

574
00:28:45,160 --> 00:28:49,240
to<font color="#E5E5E5"> unlock your machine you have to</font>

575
00:28:47,620 --> 00:28:52,659
<font color="#E5E5E5">release a file inspector at the same</font>

576
00:28:49,240 --> 00:28:55,330
time you have<font color="#CCCCCC"> to extract the hostile K</font>

577
00:28:52,660 --> 00:28:57,670
<font color="#CCCCCC">for the metamorphic malware producing</font>

578
00:28:55,330 --> 00:29:00,159
the main malware code<font color="#CCCCCC"> this sometimes</font>

579
00:28:57,670 --> 00:29:03,130
it's hard if you're<font color="#CCCCCC"> making a for example</font>

580
00:29:00,160 --> 00:29:05,230
work by report or<font color="#E5E5E5"> something</font><font color="#CCCCCC"> as a polymer</font>

581
00:29:03,130 --> 00:29:07,060
<font color="#CCCCCC">peak</font><font color="#E5E5E5"> it's hard to understand the malware</font>

582
00:29:05,230 --> 00:29:10,240
code most of the time it takes<font color="#CCCCCC"> you a</font>

583
00:29:07,060 --> 00:29:13,810
longer<font color="#E5E5E5"> time to look into that</font><font color="#CCCCCC"> okay</font>

584
00:29:10,240 --> 00:29:16,300
<font color="#E5E5E5">there are some possible solutions is he</font>

585
00:29:13,810 --> 00:29:19,000
removing the registry entries to unlock

586
00:29:16,300 --> 00:29:22,560
your machine running a<font color="#CCCCCC"> B security</font>

587
00:29:19,000 --> 00:29:22,560
products to<font color="#E5E5E5"> clean the system</font>

588
00:29:23,160 --> 00:29:29,550
<font color="#E5E5E5">hey you can create your own scripts just</font>

589
00:29:25,440 --> 00:29:31,530
<font color="#E5E5E5">to just look for the the</font><font color="#CCCCCC"> key</font><font color="#E5E5E5"> right and</font>

590
00:29:29,550 --> 00:29:33,840
then all you have<font color="#CCCCCC"> to do is you</font><font color="#E5E5E5"> to run X</font>

591
00:29:31,530 --> 00:29:35,639
or<font color="#E5E5E5"> within those bus and then that's it</font>

592
00:29:33,840 --> 00:29:37,740
<font color="#CCCCCC">you</font><font color="#E5E5E5"> have now the solution</font>

593
00:29:35,640 --> 00:29:39,510
<font color="#CCCCCC">okay metamorphic code as I have shown</font>

594
00:29:37,740 --> 00:29:42,030
you<font color="#E5E5E5"> earlier</font><font color="#CCCCCC"> all you have</font><font color="#E5E5E5"> to do is to</font>

595
00:29:39,510 --> 00:29:43,680
look for the jump out the call<font color="#E5E5E5"> most of</font>

596
00:29:42,030 --> 00:29:46,050
<font color="#E5E5E5">the time it has the call it has the jump</font>

597
00:29:43,680 --> 00:29:48,840
out then<font color="#CCCCCC"> breakpoint on</font><font color="#E5E5E5"> that and then you</font>

598
00:29:46,050 --> 00:29:52,110
will be able to to<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> able to read</font>

599
00:29:48,840 --> 00:29:54,449
the metamorphic code or<font color="#E5E5E5"> do the decoded</font>

600
00:29:52,110 --> 00:29:55,949
code and then of<font color="#CCCCCC"> course the last part</font>

601
00:29:54,450 --> 00:29:57,960
for the polymorphic malware

602
00:29:55,950 --> 00:30:00,510
<font color="#E5E5E5">k dumping the decrypted code is very</font>

603
00:29:57,960 --> 00:30:05,640
important when you try to analyze<font color="#CCCCCC"> it</font><font color="#E5E5E5"> in</font>

604
00:30:00,510 --> 00:30:06,310
more on dynamic and static analysis

605
00:30:05,640 --> 00:30:08,840
and

606
00:30:06,310 --> 00:30:11,230
[Music]

607
00:30:08,840 --> 00:30:15,610
that's it

608
00:30:11,230 --> 00:30:20,169
only<font color="#E5E5E5"> 30 minutes we have enough time to</font>

609
00:30:15,610 --> 00:30:23,610
<font color="#CCCCCC">pour questions and</font><font color="#E5E5E5"> questions not sure if</font>

610
00:30:20,169 --> 00:30:23,610
<font color="#E5E5E5">we have</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> answer question</font>

