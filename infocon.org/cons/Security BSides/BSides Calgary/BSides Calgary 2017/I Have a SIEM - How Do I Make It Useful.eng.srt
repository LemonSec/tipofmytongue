1
00:00:02,550 --> 00:00:08,910
hello everyone<font color="#E5E5E5"> as as mentioned my</font><font color="#CCCCCC"> name</font>

2
00:00:05,790 --> 00:00:10,709
<font color="#E5E5E5">is</font><font color="#CCCCCC"> Julian Pileggi I am here to talk</font><font color="#E5E5E5"> to</font>

3
00:00:08,910 --> 00:00:13,530
you about how<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make use of your sim</font>

4
00:00:10,709 --> 00:00:15,059
and before I<font color="#E5E5E5"> get into</font><font color="#CCCCCC"> that I'll talk to</font>

5
00:00:13,530 --> 00:00:17,850
you a bit<font color="#CCCCCC"> about who I am and will also</font>

6
00:00:15,059 --> 00:00:20,580
talk<font color="#E5E5E5"> about maybe a bit of best practices</font>

7
00:00:17,850 --> 00:00:22,290
on<font color="#CCCCCC"> how to</font><font color="#E5E5E5"> use a sim</font><font color="#CCCCCC"> I think though the</font>

8
00:00:20,580 --> 00:00:24,659
<font color="#CCCCCC">meet of</font><font color="#E5E5E5"> the content will be probably</font>

9
00:00:22,290 --> 00:00:25,890
<font color="#E5E5E5">near</font><font color="#CCCCCC"> the end</font><font color="#E5E5E5"> when we talk about some sim</font>

10
00:00:24,660 --> 00:00:27,480
rules that I think are pretty<font color="#E5E5E5"> valuable</font>

11
00:00:25,890 --> 00:00:29,400
and<font color="#CCCCCC"> that you should consider</font>

12
00:00:27,480 --> 00:00:30,750
<font color="#E5E5E5">implementing if you have a sim and</font>

13
00:00:29,400 --> 00:00:32,399
you're trying<font color="#E5E5E5"> to get some value out</font><font color="#CCCCCC"> of</font>

14
00:00:30,750 --> 00:00:33,989
<font color="#E5E5E5">it and you're</font><font color="#CCCCCC"> getting flooded</font><font color="#E5E5E5"> with a lot</font>

15
00:00:32,399 --> 00:00:35,579
<font color="#E5E5E5">of noisy alerts I think what we're gonna</font>

16
00:00:33,989 --> 00:00:37,589
talk<font color="#E5E5E5"> about near the end is going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font>

17
00:00:35,579 --> 00:00:39,540
maybe<font color="#E5E5E5"> some higher accuracy hopefully</font>

18
00:00:37,590 --> 00:00:42,750
less noisy events that will give you

19
00:00:39,540 --> 00:00:44,070
some value so like I<font color="#CCCCCC"> said</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> my</font>

20
00:00:42,750 --> 00:00:46,980
name is<font color="#E5E5E5"> Julian</font><font color="#CCCCCC"> Pileggi I'm a senior</font>

21
00:00:44,070 --> 00:00:49,559
<font color="#CCCCCC">consultant with mandiant in the Toronto</font>

22
00:00:46,980 --> 00:00:51,360
<font color="#CCCCCC">office I've been with Mandy it for about</font>

23
00:00:49,559 --> 00:00:53,750
<font color="#E5E5E5">two</font><font color="#CCCCCC"> and a half</font><font color="#E5E5E5"> years now prior</font><font color="#CCCCCC"> to that I</font>

24
00:00:51,360 --> 00:00:57,329
worked in a large<font color="#CCCCCC"> Bank in Canada doing</font>

25
00:00:53,750 --> 00:00:58,500
<font color="#E5E5E5">security operations investigations and</font>

26
00:00:57,329 --> 00:01:01,500
<font color="#CCCCCC">Incident Response</font>

27
00:00:58,500 --> 00:01:03,180
<font color="#E5E5E5">so obviously working with the sim in a</font>

28
00:01:01,500 --> 00:01:07,049
<font color="#CCCCCC">sock is kind</font><font color="#E5E5E5"> of part of your</font><font color="#CCCCCC"> day-to-day</font>

29
00:01:03,180 --> 00:01:10,139
<font color="#CCCCCC">I've got experience</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> ArcSight q</font>

30
00:01:07,049 --> 00:01:12,389
<font color="#CCCCCC">radar</font><font color="#E5E5E5"> Splunk</font><font color="#CCCCCC"> a bunch of other</font><font color="#E5E5E5"> types of</font>

31
00:01:10,139 --> 00:01:13,170
<font color="#CCCCCC">sims so I've got a pretty varied breadth</font>

32
00:01:12,389 --> 00:01:15,208
of experience with different

33
00:01:13,170 --> 00:01:16,560
<font color="#E5E5E5">technologies and this talk</font><font color="#CCCCCC"> is not</font><font color="#E5E5E5"> really</font>

34
00:01:15,209 --> 00:01:19,409
gonna be<font color="#E5E5E5"> about</font><font color="#CCCCCC"> a specific technology</font>

35
00:01:16,560 --> 00:01:21,389
<font color="#E5E5E5">it's more just about sim in general</font><font color="#CCCCCC"> I</font>

36
00:01:19,409 --> 00:01:23,609
also talked at<font color="#E5E5E5"> besides charm this year</font>

37
00:01:21,389 --> 00:01:27,359
and I trained or presented a training at

38
00:01:23,609 --> 00:01:29,158
blackhat and<font color="#E5E5E5"> Amir Khan or fire</font><font color="#CCCCCC"> icds as</font>

39
00:01:27,359 --> 00:01:32,098
it's known now<font color="#E5E5E5"> and if you guys will be</font>

40
00:01:29,159 --> 00:01:36,240
<font color="#E5E5E5">at</font><font color="#CCCCCC"> sector you might see me again</font><font color="#E5E5E5"> or at</font>

41
00:01:32,099 --> 00:01:39,149
blackhat<font color="#E5E5E5"> Europe fun fact about me</font><font color="#CCCCCC"> I can</font>

42
00:01:36,240 --> 00:01:41,039
type on average 120 words per minute<font color="#E5E5E5"> I</font>

43
00:01:39,149 --> 00:01:44,130
probably won't speak that<font color="#E5E5E5"> faster at</font>

44
00:01:41,039 --> 00:01:46,529
least I hope<font color="#CCCCCC"> I won't but yeah I</font><font color="#E5E5E5"> can</font>

45
00:01:44,130 --> 00:01:47,669
<font color="#E5E5E5">probably also type as fast as 165 words</font>

46
00:01:46,529 --> 00:01:49,109
per minute<font color="#E5E5E5"> actually it's recorded not</font>

47
00:01:47,669 --> 00:01:51,060
<font color="#E5E5E5">probably so if anyone wants</font><font color="#CCCCCC"> to challenge</font>

48
00:01:49,109 --> 00:01:53,130
<font color="#E5E5E5">me</font><font color="#CCCCCC"> feel</font><font color="#E5E5E5"> free to do</font><font color="#CCCCCC"> that after the calf</font>

49
00:01:51,060 --> 00:01:54,990
<font color="#E5E5E5">tur the presentation disclaimer though</font>

50
00:01:53,130 --> 00:01:57,089
<font color="#E5E5E5">everything that I will be talking</font><font color="#CCCCCC"> about</font>

51
00:01:54,990 --> 00:01:59,369
<font color="#CCCCCC">today</font><font color="#E5E5E5"> is coming from me it's not really</font>

52
00:01:57,090 --> 00:02:00,989
represented of representative<font color="#E5E5E5"> of maybe</font>

53
00:01:59,369 --> 00:02:03,060
<font color="#CCCCCC">fireEye or mandiant I mean a lot of it</font>

54
00:02:00,989 --> 00:02:03,659
will be<font color="#E5E5E5"> very similar but keep that</font><font color="#CCCCCC"> in</font>

55
00:02:03,060 --> 00:02:05,689
<font color="#E5E5E5">mind</font>

56
00:02:03,659 --> 00:02:08,429
<font color="#E5E5E5">take everything with a grain of salt</font><font color="#CCCCCC"> and</font>

57
00:02:05,689 --> 00:02:10,919
also understand<font color="#E5E5E5"> that everyone's</font>

58
00:02:08,429 --> 00:02:11,400
<font color="#E5E5E5">organizations are unique situations are</font>

59
00:02:10,919 --> 00:02:14,319
different

60
00:02:11,400 --> 00:02:15,670
what<font color="#CCCCCC"> I suggest</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> might say is good</font>

61
00:02:14,319 --> 00:02:17,078
or as<font color="#E5E5E5"> best practice may not really be</font>

62
00:02:15,670 --> 00:02:19,089
suitable<font color="#CCCCCC"> for your organization</font><font color="#E5E5E5"> or for</font>

63
00:02:17,079 --> 00:02:23,530
<font color="#E5E5E5">your situations you have to take that</font>

64
00:02:19,090 --> 00:02:25,810
into consideration of course so like I

65
00:02:23,530 --> 00:02:27,579
<font color="#CCCCCC">said we're gonna start off with some</font>

66
00:02:25,810 --> 00:02:29,230
best practices<font color="#E5E5E5"> and we're first going to</font>

67
00:02:27,579 --> 00:02:31,540
talk<font color="#E5E5E5"> about logging</font><font color="#CCCCCC"> I'm not</font><font color="#E5E5E5"> going to get</font>

68
00:02:29,230 --> 00:02:34,179
into<font color="#E5E5E5"> this</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> in any depth</font><font color="#CCCCCC"> really this</font>

69
00:02:31,540 --> 00:02:35,650
is very<font color="#CCCCCC"> high-level but the idea here is</font>

70
00:02:34,180 --> 00:02:38,439
<font color="#E5E5E5">the kinds of logs you need to make sure</font>

71
00:02:35,650 --> 00:02:39,819
<font color="#E5E5E5">you have in your sim this is a laundry</font>

72
00:02:38,439 --> 00:02:41,608
list<font color="#E5E5E5"> of things</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> put together based on</font>

73
00:02:39,819 --> 00:02:44,078
<font color="#E5E5E5">the kinds of things I think are useful</font>

74
00:02:41,609 --> 00:02:46,329
<font color="#E5E5E5">from my investigations or the experience</font>

75
00:02:44,079 --> 00:02:47,530
<font color="#CCCCCC">that I've had right</font><font color="#E5E5E5"> when I see these</font>

76
00:02:46,329 --> 00:02:49,239
kinds of logs there's a lot of value

77
00:02:47,530 --> 00:02:51,280
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you can get from them certain</font>

78
00:02:49,239 --> 00:02:52,180
<font color="#E5E5E5">things you can look for</font><font color="#CCCCCC"> in them</font><font color="#E5E5E5"> probably</font>

79
00:02:51,280 --> 00:02:53,949
one that<font color="#E5E5E5"> I'll point out to you is</font>

80
00:02:52,180 --> 00:02:56,049
PowerShell times<font color="#CCCCCC"> 3</font><font color="#E5E5E5"> the reason I say</font>

81
00:02:53,949 --> 00:02:57,909
times 3 is because<font color="#E5E5E5"> of course if you have</font>

82
00:02:56,049 --> 00:02:59,919
upgraded<font color="#E5E5E5"> to at least version 5</font><font color="#CCCCCC"> of</font>

83
00:02:57,909 --> 00:03:01,929
PowerShell<font color="#E5E5E5"> you can enable all</font><font color="#CCCCCC"> 3 logging</font>

84
00:02:59,919 --> 00:03:03,879
script block logging transcription

85
00:03:01,930 --> 00:03:04,930
logging and module logging highly

86
00:03:03,879 --> 00:03:08,048
recommend that<font color="#E5E5E5"> you make sure</font><font color="#CCCCCC"> you have</font>

87
00:03:04,930 --> 00:03:09,879
<font color="#CCCCCC">all</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> 3 very useful of course with</font>

88
00:03:08,049 --> 00:03:11,560
<font color="#E5E5E5">all the various PowerShell frameworks</font>

89
00:03:09,879 --> 00:03:13,149
for post exploitation activities that

90
00:03:11,560 --> 00:03:15,370
are used<font color="#CCCCCC"> by attackers</font><font color="#E5E5E5"> and red team's</font>

91
00:03:13,150 --> 00:03:17,680
alike<font color="#CCCCCC"> on the right</font><font color="#E5E5E5"> side I've</font><font color="#CCCCCC"> got some</font>

92
00:03:15,370 --> 00:03:20,229
things<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> nice</font><font color="#CCCCCC"> to have system on</font>

93
00:03:17,680 --> 00:03:22,329
<font color="#E5E5E5">top logs</font><font color="#CCCCCC"> this is a shout-out to Kenneth</font>

94
00:03:20,229 --> 00:03:24,819
who did a pretty sweet training this

95
00:03:22,329 --> 00:03:26,169
<font color="#E5E5E5">week on how to deploy this</font><font color="#CCCCCC"> montt your</font>

96
00:03:24,819 --> 00:03:27,429
environment and<font color="#E5E5E5"> monitor and look in</font>

97
00:03:26,169 --> 00:03:27,669
those logs using<font color="#CCCCCC"> Splunk which is pretty</font>

98
00:03:27,430 --> 00:03:29,829
sweet

99
00:03:27,669 --> 00:03:32,439
<font color="#E5E5E5">so that problem a bit of</font><font color="#CCCCCC"> attention to my</font>

100
00:03:29,829 --> 00:03:33,759
mind<font color="#CCCCCC"> in that in</font><font color="#E5E5E5"> that sense but I think</font><font color="#CCCCCC"> a</font>

101
00:03:32,439 --> 00:03:35,739
lot<font color="#CCCCCC"> of these are arguable</font><font color="#E5E5E5"> right some of</font>

102
00:03:33,759 --> 00:03:36,879
these you might say yeah we think<font color="#E5E5E5"> these</font>

103
00:03:35,739 --> 00:03:38,530
are<font color="#E5E5E5"> very</font><font color="#CCCCCC"> valuable</font><font color="#E5E5E5"> in some you might</font>

104
00:03:36,879 --> 00:03:41,530
disagree<font color="#CCCCCC"> with that's totally fine</font>

105
00:03:38,530 --> 00:03:42,400
this is just my<font color="#CCCCCC"> opinion and a couple</font><font color="#E5E5E5"> of</font>

106
00:03:41,530 --> 00:03:43,870
other<font color="#CCCCCC"> things I think</font><font color="#E5E5E5"> that are very</font>

107
00:03:42,400 --> 00:03:46,299
<font color="#CCCCCC">valuable that</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> always</font>

108
00:03:43,870 --> 00:03:49,180
consider<font color="#E5E5E5"> metering data here I've put</font>

109
00:03:46,299 --> 00:03:50,229
SCCM that's one capability or one tool

110
00:03:49,180 --> 00:03:52,209
that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can use for metering data</font>

111
00:03:50,229 --> 00:03:55,060
<font color="#E5E5E5">people</font><font color="#CCCCCC"> don't think</font><font color="#E5E5E5"> of metering data as a</font>

112
00:03:52,209 --> 00:03:56,620
security tool or like security

113
00:03:55,060 --> 00:03:58,449
<font color="#CCCCCC">information because it's not really but</font>

114
00:03:56,620 --> 00:03:59,709
<font color="#E5E5E5">it keeps track of</font><font color="#CCCCCC"> information about</font>

115
00:03:58,449 --> 00:04:01,569
what's<font color="#CCCCCC"> happening in your</font><font color="#E5E5E5"> environment you</font>

116
00:03:59,709 --> 00:04:02,949
can get some really<font color="#E5E5E5"> good stuff out of it</font>

117
00:04:01,569 --> 00:04:04,448
like<font color="#CCCCCC"> for example</font><font color="#E5E5E5"> applications that have</font>

118
00:04:02,949 --> 00:04:06,189
been<font color="#E5E5E5"> used if the meter is just</font>

119
00:04:04,449 --> 00:04:07,719
monitoring<font color="#E5E5E5"> how long the application was</font>

120
00:04:06,189 --> 00:04:09,790
running<font color="#E5E5E5"> the fact</font><font color="#CCCCCC"> that it was running</font>

121
00:04:07,719 --> 00:04:12,599
<font color="#E5E5E5">maybe that will give you an indicator of</font>

122
00:04:09,790 --> 00:04:14,560
<font color="#CCCCCC">compromise for</font><font color="#E5E5E5"> a backdoor or</font><font color="#CCCCCC"> something</font>

123
00:04:12,599 --> 00:04:17,918
<font color="#CCCCCC">damas logging we're gonna talk a bit</font>

124
00:04:14,560 --> 00:04:20,680
about tech specs the specifications you

125
00:04:17,918 --> 00:04:22,448
<font color="#E5E5E5">should strive to ensure that you have in</font>

126
00:04:20,680 --> 00:04:26,180
your sim<font color="#E5E5E5"> or the platform</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you're</font>

127
00:04:22,449 --> 00:04:27,949
using<font color="#E5E5E5"> as a sim and I've only got</font>

128
00:04:26,180 --> 00:04:29,419
<font color="#CCCCCC">a one slide on it which is not too bad</font>

129
00:04:27,949 --> 00:04:30,919
again I said<font color="#CCCCCC"> it's very high-level but I</font>

130
00:04:29,419 --> 00:04:32,150
<font color="#E5E5E5">think there's one thing</font><font color="#CCCCCC"> on this slide</font>

131
00:04:30,919 --> 00:04:33,889
<font color="#E5E5E5">that's gonna make most people's head</font>

132
00:04:32,150 --> 00:04:35,570
explode<font color="#E5E5E5"> but most of it I think is what</font>

133
00:04:33,889 --> 00:04:38,090
you would<font color="#CCCCCC"> expect</font><font color="#E5E5E5"> right you ideally want</font>

134
00:04:35,570 --> 00:04:39,349
<font color="#CCCCCC">to have some</font><font color="#E5E5E5"> kind of backup situation so</font>

135
00:04:38,090 --> 00:04:43,130
primary and secondary if you can

136
00:04:39,350 --> 00:04:45,470
redundancy<font color="#CCCCCC"> a lot of organizations they</font>

137
00:04:43,130 --> 00:04:47,120
don't consider a sim<font color="#E5E5E5"> or a lot of</font>

138
00:04:45,470 --> 00:04:49,190
security tools as high availability<font color="#CCCCCC"> miss</font>

139
00:04:47,120 --> 00:04:51,020
<font color="#CCCCCC">tier</font><font color="#E5E5E5"> one right and depending</font><font color="#CCCCCC"> on the size</font>

140
00:04:49,190 --> 00:04:52,940
of<font color="#CCCCCC"> your organization maybe that's</font>

141
00:04:51,020 --> 00:04:54,500
reasonable but realistically if<font color="#CCCCCC"> your</font>

142
00:04:52,940 --> 00:04:55,969
monitoring team or your ops team is

143
00:04:54,500 --> 00:04:57,620
unable<font color="#E5E5E5"> to</font><font color="#CCCCCC"> monitor</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> environment</font>

144
00:04:55,970 --> 00:05:00,320
because your sim is down it can be

145
00:04:57,620 --> 00:05:01,820
pretty pretty serious<font color="#CCCCCC"> the second thing I</font>

146
00:05:00,320 --> 00:05:03,169
want<font color="#CCCCCC"> to point out here is at your test</font>

147
00:05:01,820 --> 00:05:05,659
environment<font color="#E5E5E5"> you should</font><font color="#CCCCCC"> have a test</font>

148
00:05:03,169 --> 00:05:08,389
environment to test<font color="#E5E5E5"> your code</font><font color="#CCCCCC"> test rules</font>

149
00:05:05,660 --> 00:05:09,740
test<font color="#E5E5E5"> changes to the sim you should</font>

150
00:05:08,389 --> 00:05:11,690
actually<font color="#CCCCCC"> have a full copy of</font><font color="#E5E5E5"> your</font>

151
00:05:09,740 --> 00:05:13,280
production<font color="#CCCCCC"> data in your test environment</font>

152
00:05:11,690 --> 00:05:14,810
and a<font color="#E5E5E5"> lot of people say that's not right</font>

153
00:05:13,280 --> 00:05:17,710
<font color="#CCCCCC">right because</font><font color="#E5E5E5"> normally test environments</font>

154
00:05:14,810 --> 00:05:19,910
should<font color="#E5E5E5"> not have production data however</font>

155
00:05:17,710 --> 00:05:21,349
in the case<font color="#E5E5E5"> of</font><font color="#CCCCCC"> a sim if you don't have</font>

156
00:05:19,910 --> 00:05:23,780
real<font color="#E5E5E5"> production data you're not actually</font>

157
00:05:21,349 --> 00:05:25,729
<font color="#E5E5E5">testing</font><font color="#CCCCCC"> anything</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> you maybe</font><font color="#E5E5E5"> are</font>

158
00:05:23,780 --> 00:05:27,080
testing your ability to type the keys

159
00:05:25,729 --> 00:05:28,520
into<font color="#E5E5E5"> the computer and see if you can do</font>

160
00:05:27,080 --> 00:05:29,630
<font color="#E5E5E5">it in a test environment but it's not</font>

161
00:05:28,520 --> 00:05:31,039
gonna really<font color="#E5E5E5"> validate whether there's a</font>

162
00:05:29,630 --> 00:05:32,449
<font color="#E5E5E5">performance impact</font><font color="#CCCCCC"> it's not going to</font>

163
00:05:31,039 --> 00:05:33,560
tell you if you actually<font color="#E5E5E5"> will catch what</font>

164
00:05:32,449 --> 00:05:35,150
you're expecting to catch so you really

165
00:05:33,560 --> 00:05:36,710
need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> make sure you have a copy of</font>

166
00:05:35,150 --> 00:05:38,630
<font color="#E5E5E5">your Prada in that test environment</font>

167
00:05:36,710 --> 00:05:41,120
specifically for the sim role based

168
00:05:38,630 --> 00:05:42,830
access control<font color="#E5E5E5"> that's a basic feature I</font>

169
00:05:41,120 --> 00:05:45,020
think<font color="#E5E5E5"> that everything's got automated</font>

170
00:05:42,830 --> 00:05:46,430
aggregation by distinguishers this I

171
00:05:45,020 --> 00:05:47,840
<font color="#CCCCCC">think is probably pretty standard</font><font color="#E5E5E5"> but</font>

172
00:05:46,430 --> 00:05:50,210
<font color="#CCCCCC">the idea here is</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> be able to</font>

173
00:05:47,840 --> 00:05:53,840
aggregate alerts coming<font color="#CCCCCC"> from the sim</font>

174
00:05:50,210 --> 00:05:54,880
based on specific<font color="#E5E5E5"> distinguishers by</font>

175
00:05:53,840 --> 00:05:56,810
alert

176
00:05:54,880 --> 00:05:58,699
so each alert might have a different

177
00:05:56,810 --> 00:06:00,199
distinguisher<font color="#E5E5E5"> right of course if you</font>

178
00:05:58,699 --> 00:06:01,820
have a sim rule that triggers on

179
00:06:00,199 --> 00:06:04,220
suspicious emails<font color="#E5E5E5"> the distinguisher</font>

180
00:06:01,820 --> 00:06:07,580
might be the sending email address

181
00:06:04,220 --> 00:06:09,740
<font color="#E5E5E5">versus an IP</font><font color="#CCCCCC"> address from</font><font color="#E5E5E5"> a network kind</font>

182
00:06:07,580 --> 00:06:11,270
of correlation<font color="#E5E5E5"> rule geolocation</font>

183
00:06:09,740 --> 00:06:12,770
enrichment is huge if you don't have

184
00:06:11,270 --> 00:06:14,389
this in your sim it's<font color="#E5E5E5"> actually very very</font>

185
00:06:12,770 --> 00:06:16,940
important that<font color="#E5E5E5"> you have this geolocation</font>

186
00:06:14,389 --> 00:06:19,039
<font color="#E5E5E5">enrichment can be as simple as getting</font>

187
00:06:16,940 --> 00:06:20,990
<font color="#E5E5E5">like a max mind or IP to location</font>

188
00:06:19,039 --> 00:06:23,000
database hooking it up<font color="#E5E5E5"> to</font><font color="#CCCCCC"> your sim so</font>

189
00:06:20,990 --> 00:06:24,919
anytime there's you know a publicly

190
00:06:23,000 --> 00:06:27,530
routable IP address the information

191
00:06:24,919 --> 00:06:29,479
associated with<font color="#E5E5E5"> that address</font><font color="#CCCCCC"> can be kind</font>

192
00:06:27,530 --> 00:06:30,619
of<font color="#E5E5E5"> added to</font><font color="#CCCCCC"> the metadata for that event</font>

193
00:06:29,479 --> 00:06:32,180
<font color="#E5E5E5">and then</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can use that to actually</font>

194
00:06:30,620 --> 00:06:34,340
<font color="#E5E5E5">create correlation roles and we'll see a</font>

195
00:06:32,180 --> 00:06:35,870
couple<font color="#CCCCCC"> of examples of that later on</font><font color="#E5E5E5"> now</font>

196
00:06:34,340 --> 00:06:37,310
here at the<font color="#CCCCCC"> bottom is</font><font color="#E5E5E5"> where I think a</font>

197
00:06:35,870 --> 00:06:39,950
<font color="#E5E5E5">lot of people</font><font color="#CCCCCC"> sometimes have a hard</font><font color="#E5E5E5"> time</font>

198
00:06:37,310 --> 00:06:41,060
<font color="#E5E5E5">you</font><font color="#CCCCCC"> know swallowing this pill and that's</font>

199
00:06:39,950 --> 00:06:42,979
30 days retention is what you should

200
00:06:41,060 --> 00:06:45,650
<font color="#CCCCCC">strive for across</font><font color="#E5E5E5"> all of the logs that</font>

201
00:06:42,980 --> 00:06:47,170
you<font color="#E5E5E5"> centralize near</font><font color="#CCCCCC"> Sim can be</font><font color="#E5E5E5"> very</font>

202
00:06:45,650 --> 00:06:49,310
difficult it can<font color="#E5E5E5"> take a lot of</font><font color="#CCCCCC"> storage</font>

203
00:06:47,170 --> 00:06:51,200
<font color="#CCCCCC">but</font><font color="#E5E5E5"> of course it's very necessary and</font>

204
00:06:49,310 --> 00:06:52,760
<font color="#CCCCCC">I'll explain why in just</font><font color="#E5E5E5"> a second but</font>

205
00:06:51,200 --> 00:06:54,110
<font color="#CCCCCC">before we get to</font><font color="#E5E5E5"> that the second point</font>

206
00:06:52,760 --> 00:06:56,300
is that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> should have you should be</font>

207
00:06:54,110 --> 00:06:58,880
able to query at least the<font color="#E5E5E5"> last two</font>

208
00:06:56,300 --> 00:07:01,190
weeks<font color="#E5E5E5"> of your data for a specific atomic</font>

209
00:06:58,880 --> 00:07:03,260
indicator within<font color="#E5E5E5"> 60 seconds and you'll</font>

210
00:07:01,190 --> 00:07:05,240
notice I'm<font color="#CCCCCC"> not telling you you</font><font color="#E5E5E5"> need 256</font>

211
00:07:03,260 --> 00:07:06,409
gigs of<font color="#CCCCCC"> ram or five terabytes</font><font color="#E5E5E5"> of storage</font>

212
00:07:05,240 --> 00:07:07,970
<font color="#CCCCCC">I'm not telling you that because</font><font color="#E5E5E5"> that</font>

213
00:07:06,410 --> 00:07:09,200
doesn't<font color="#CCCCCC"> really matter it depends on your</font>

214
00:07:07,970 --> 00:07:11,480
<font color="#E5E5E5">environment and the kind of logs are</font>

215
00:07:09,200 --> 00:07:13,729
storing well you need to<font color="#E5E5E5"> strive</font><font color="#CCCCCC"> for is</font>

216
00:07:11,480 --> 00:07:14,750
the actual usability<font color="#CCCCCC"> right and so</font><font color="#E5E5E5"> that's</font>

217
00:07:13,730 --> 00:07:17,360
a measurement<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I think a lot of</font>

218
00:07:14,750 --> 00:07:18,980
<font color="#E5E5E5">people can sometimes get</font><font color="#CCCCCC"> to sometimes</font>

219
00:07:17,360 --> 00:07:20,450
they<font color="#E5E5E5"> don't you know I've had this</font>

220
00:07:18,980 --> 00:07:22,460
<font color="#CCCCCC">reaction a lot of times where people</font><font color="#E5E5E5"> say</font>

221
00:07:20,450 --> 00:07:24,560
what I should be able<font color="#E5E5E5"> to do this in 60</font>

222
00:07:22,460 --> 00:07:26,659
seconds it's not possible<font color="#E5E5E5"> right</font><font color="#CCCCCC"> but the</font>

223
00:07:24,560 --> 00:07:28,970
reality<font color="#CCCCCC"> is if you</font><font color="#E5E5E5"> aren't able to get</font>

224
00:07:26,660 --> 00:07:30,770
access<font color="#E5E5E5"> to the information</font><font color="#CCCCCC"> in your sim</font>

225
00:07:28,970 --> 00:07:32,690
it's gonna make<font color="#E5E5E5"> it much more difficult</font>

226
00:07:30,770 --> 00:07:35,060
<font color="#E5E5E5">to</font><font color="#CCCCCC"> actually perform effective monitoring</font>

227
00:07:32,690 --> 00:07:38,450
<font color="#E5E5E5">and investigation and perhaps incident</font>

228
00:07:35,060 --> 00:07:40,340
<font color="#E5E5E5">response if you ever need to do that and</font>

229
00:07:38,450 --> 00:07:42,349
it is<font color="#E5E5E5"> doable</font><font color="#CCCCCC"> I mean this is an example</font>

230
00:07:40,340 --> 00:07:43,520
of a query<font color="#E5E5E5"> I pulled for the last two</font>

231
00:07:42,350 --> 00:07:46,310
weeks<font color="#CCCCCC"> I had to make sure it was doable</font>

232
00:07:43,520 --> 00:07:47,719
before I said<font color="#E5E5E5"> this publicly</font><font color="#CCCCCC"> but you know</font>

233
00:07:46,310 --> 00:07:50,570
it is doable in this case the query took

234
00:07:47,720 --> 00:07:52,730
16 seconds<font color="#CCCCCC"> other times I've tried it</font>

235
00:07:50,570 --> 00:07:55,130
takes<font color="#CCCCCC"> 3040 seconds</font><font color="#E5E5E5"> but the idea is if</font>

236
00:07:52,730 --> 00:07:56,600
you're<font color="#E5E5E5"> looking for a specific indicator</font>

237
00:07:55,130 --> 00:07:58,190
atomic indicator<font color="#E5E5E5"> not</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> complex</font>

238
00:07:56,600 --> 00:08:00,140
<font color="#CCCCCC">expression you should be able</font><font color="#E5E5E5"> to get the</font>

239
00:07:58,190 --> 00:08:03,500
information relatively quickly<font color="#E5E5E5"> in one</font>

240
00:08:00,140 --> 00:08:06,620
organization<font color="#CCCCCC"> that I saw</font><font color="#E5E5E5"> this you know</font>

241
00:08:03,500 --> 00:08:07,730
issue they had Intel that<font color="#CCCCCC"> said that they</font>

242
00:08:06,620 --> 00:08:09,650
were<font color="#E5E5E5"> being targeted and they needed</font><font color="#CCCCCC"> to</font>

243
00:08:07,730 --> 00:08:11,060
<font color="#CCCCCC">validate whether the specific</font><font color="#E5E5E5"> threat</font>

244
00:08:09,650 --> 00:08:12,560
group had actually made any

245
00:08:11,060 --> 00:08:14,540
communication<font color="#CCCCCC"> with their network</font><font color="#E5E5E5"> very</font>

246
00:08:12,560 --> 00:08:16,460
<font color="#E5E5E5">straightforward here's five IP addresses</font>

247
00:08:14,540 --> 00:08:18,560
used by<font color="#E5E5E5"> the threat actor we know they're</font>

248
00:08:16,460 --> 00:08:20,419
targeting you check your logs and<font color="#E5E5E5"> see if</font>

249
00:08:18,560 --> 00:08:21,830
you've had any connections they said

250
00:08:20,420 --> 00:08:24,290
yeah we've got a sim we've<font color="#E5E5E5"> got 30 days</font>

251
00:08:21,830 --> 00:08:26,270
no problem<font color="#E5E5E5"> except when they went to</font>

252
00:08:24,290 --> 00:08:28,910
query it<font color="#E5E5E5"> for 30 days they realize that</font>

253
00:08:26,270 --> 00:08:31,130
the sim was under scoped<font color="#CCCCCC"> and it was</font>

254
00:08:28,910 --> 00:08:32,420
actually<font color="#CCCCCC"> gonna take about</font><font color="#E5E5E5"> seven days to</font>

255
00:08:31,130 --> 00:08:33,679
pull the<font color="#E5E5E5"> data and see if they could</font>

256
00:08:32,419 --> 00:08:35,990
<font color="#E5E5E5">actually query all the firewall logs</font>

257
00:08:33,679 --> 00:08:38,839
<font color="#E5E5E5">right so obviously not gonna be very</font>

258
00:08:35,990 --> 00:08:40,099
<font color="#CCCCCC">useful in that time frame and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

259
00:08:38,840 --> 00:08:42,710
<font color="#E5E5E5">the point I was referring to</font><font color="#CCCCCC"> earlier is</font>

260
00:08:40,099 --> 00:08:44,780
that that dwell time the<font color="#E5E5E5"> amount of time</font>

261
00:08:42,710 --> 00:08:46,460
that an attacker is inside an

262
00:08:44,780 --> 00:08:49,220
environment<font color="#CCCCCC"> before</font><font color="#E5E5E5"> they're typically</font>

263
00:08:46,460 --> 00:08:52,160
identified by an external<font color="#E5E5E5"> party or by</font>

264
00:08:49,220 --> 00:08:53,270
the team at the<font color="#E5E5E5"> organization is a median</font>

265
00:08:52,160 --> 00:08:55,160
of 99 days

266
00:08:53,270 --> 00:08:57,829
this informations pulled from the

267
00:08:55,160 --> 00:08:59,480
mandiant<font color="#CCCCCC"> m trends report</font><font color="#E5E5E5"> that they</font>

268
00:08:57,830 --> 00:09:00,620
release every year<font color="#E5E5E5"> based on all</font><font color="#CCCCCC"> the</font>

269
00:08:59,480 --> 00:09:02,600
cases<font color="#E5E5E5"> they worked on in the</font><font color="#CCCCCC"> previous</font>

270
00:09:00,620 --> 00:09:04,670
year<font color="#CCCCCC"> so 99 days was the</font><font color="#E5E5E5"> median</font><font color="#CCCCCC"> number</font>

271
00:09:02,600 --> 00:09:07,580
last year in<font color="#CCCCCC"> 2016 and it's been</font><font color="#E5E5E5"> going</font>

272
00:09:04,670 --> 00:09:09,860
down which is good but<font color="#E5E5E5"> again if an</font>

273
00:09:07,580 --> 00:09:12,380
attackers in your environment<font color="#E5E5E5"> for 99</font>

274
00:09:09,860 --> 00:09:14,390
days you probably<font color="#CCCCCC"> need at least</font><font color="#E5E5E5"> 30 days</font>

275
00:09:12,380 --> 00:09:16,730
<font color="#E5E5E5">of data right a couple</font><font color="#CCCCCC"> weeks</font><font color="#E5E5E5"> it's not</font>

276
00:09:14,390 --> 00:09:17,870
gonna cut<font color="#CCCCCC"> it the longest case that</font><font color="#E5E5E5"> I've</font>

277
00:09:16,730 --> 00:09:21,650
heard about where an attacker was<font color="#E5E5E5"> an</font>

278
00:09:17,870 --> 00:09:24,560
environment was actually over<font color="#CCCCCC"> 2000 days</font>

279
00:09:21,650 --> 00:09:27,709
<font color="#E5E5E5">right so that's</font><font color="#CCCCCC"> 5 plus years</font><font color="#E5E5E5"> then the</font>

280
00:09:24,560 --> 00:09:28,939
attacker was in an<font color="#E5E5E5"> environment so in</font>

281
00:09:27,710 --> 00:09:31,520
that<font color="#E5E5E5"> case I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> think the sim was</font>

282
00:09:28,940 --> 00:09:34,880
gonna<font color="#E5E5E5"> help them too much now we're gonna</font>

283
00:09:31,520 --> 00:09:36,860
talk<font color="#E5E5E5"> about staffing</font><font color="#CCCCCC"> again very high</font>

284
00:09:34,880 --> 00:09:37,880
<font color="#E5E5E5">level the reason</font><font color="#CCCCCC"> I talk</font><font color="#E5E5E5"> about staffing</font>

285
00:09:36,860 --> 00:09:40,850
is because you need to<font color="#E5E5E5"> know how to</font>

286
00:09:37,880 --> 00:09:43,070
appropriately staff<font color="#E5E5E5"> one the sim and the</font>

287
00:09:40,850 --> 00:09:44,540
management of the<font color="#E5E5E5"> sim but also the staff</font>

288
00:09:43,070 --> 00:09:47,000
that<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> will use the sim right</font>

289
00:09:44,540 --> 00:09:50,240
because if you don't<font color="#E5E5E5"> have users of a sim</font>

290
00:09:47,000 --> 00:09:51,440
tool<font color="#E5E5E5"> you know there's no value to</font><font color="#CCCCCC"> it</font>

291
00:09:50,240 --> 00:09:53,630
because you can't just<font color="#E5E5E5"> plug it in and</font>

292
00:09:51,440 --> 00:09:54,920
<font color="#E5E5E5">turn</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> on it's not</font><font color="#CCCCCC"> like a detective or</font>

293
00:09:53,630 --> 00:09:56,060
rather<font color="#CCCCCC"> it is a</font><font color="#E5E5E5"> detective it's not a</font>

294
00:09:54,920 --> 00:10:01,060
<font color="#E5E5E5">preventative measure right it's not</font>

295
00:09:56,060 --> 00:10:04,579
gonna just prevent attacks so this is my

296
00:10:01,060 --> 00:10:06,770
kind<font color="#E5E5E5"> of thought process</font><font color="#CCCCCC"> on amateur Blue</font>

297
00:10:04,580 --> 00:10:08,060
<font color="#CCCCCC">Team whatever you want to call it I'm</font>

298
00:10:06,770 --> 00:10:11,150
<font color="#E5E5E5">gonna call it a blue team all right</font>

299
00:10:08,060 --> 00:10:14,359
<font color="#E5E5E5">you'll see three tiers within amateur</font>

300
00:10:11,150 --> 00:10:17,810
<font color="#E5E5E5">blue team you have a tier one right or</font>

301
00:10:14,360 --> 00:10:19,310
an<font color="#E5E5E5"> l1 those are the folks</font><font color="#CCCCCC"> who are</font><font color="#E5E5E5"> doing</font>

302
00:10:17,810 --> 00:10:21,579
the day-to-day monitoring<font color="#E5E5E5"> the initial</font>

303
00:10:19,310 --> 00:10:24,319
alert assessment triage

304
00:10:21,580 --> 00:10:26,390
contextualization<font color="#E5E5E5"> and the idea here is</font>

305
00:10:24,320 --> 00:10:28,010
<font color="#E5E5E5">at the l1 level someone should be able</font>

306
00:10:26,390 --> 00:10:31,460
<font color="#E5E5E5">to</font><font color="#CCCCCC"> look at an alert</font><font color="#E5E5E5"> coming from the sim</font>

307
00:10:28,010 --> 00:10:32,960
<font color="#E5E5E5">and within 15 minutes make a decision</font>

308
00:10:31,460 --> 00:10:34,910
about whether<font color="#E5E5E5"> this is a false positive</font>

309
00:10:32,960 --> 00:10:37,420
<font color="#E5E5E5">or</font><font color="#CCCCCC"> it needs</font><font color="#E5E5E5"> to be escalated for further</font>

310
00:10:34,910 --> 00:10:39,680
investigation<font color="#CCCCCC"> right potential</font><font color="#E5E5E5"> incident</font>

311
00:10:37,420 --> 00:10:42,920
at that point of<font color="#E5E5E5"> course then you have</font>

312
00:10:39,680 --> 00:10:44,449
<font color="#E5E5E5">your l2 or level 2 tier those are the</font>

313
00:10:42,920 --> 00:10:46,939
folks<font color="#E5E5E5"> who will be typically doing that</font>

314
00:10:44,450 --> 00:10:48,140
investigation<font color="#E5E5E5"> that</font><font color="#CCCCCC"> analysis you'll</font>

315
00:10:46,940 --> 00:10:49,640
notice I put threat intelligence there

316
00:10:48,140 --> 00:10:51,590
that<font color="#E5E5E5"> typically is a separate group of</font>

317
00:10:49,640 --> 00:10:53,870
folks who are<font color="#E5E5E5"> probably providing input</font>

318
00:10:51,590 --> 00:10:55,580
<font color="#E5E5E5">into the tier 2 and tier 3 teams as well</font>

319
00:10:53,870 --> 00:10:57,800
<font color="#CCCCCC">as</font><font color="#E5E5E5"> your on team if you get to that level</font>

320
00:10:55,580 --> 00:11:02,090
of maturity<font color="#E5E5E5"> and then of</font><font color="#CCCCCC"> course the tier</font>

321
00:10:57,800 --> 00:11:03,680
<font color="#E5E5E5">3 you can see tier 3 is got your l3 team</font>

322
00:11:02,090 --> 00:11:05,780
those are<font color="#E5E5E5"> typically like very skilled</font>

323
00:11:03,680 --> 00:11:06,019
folks right maybe your forensics guy

324
00:11:05,780 --> 00:11:08,629
your

325
00:11:06,019 --> 00:11:09,980
<font color="#E5E5E5">reverse engineer if you have that it not</font>

326
00:11:08,629 --> 00:11:12,679
a lot of<font color="#E5E5E5"> organizations end up getting to</font>

327
00:11:09,980 --> 00:11:15,709
tier<font color="#E5E5E5"> 3 again</font><font color="#CCCCCC"> the hunt team also</font><font color="#E5E5E5"> that</font>

328
00:11:12,679 --> 00:11:16,939
tier 3 level that's<font color="#E5E5E5"> very mature level of</font>

329
00:11:15,709 --> 00:11:17,689
an<font color="#CCCCCC"> organization not everyone gets to</font>

330
00:11:16,939 --> 00:11:19,368
<font color="#E5E5E5">that and that's something you'll</font>

331
00:11:17,689 --> 00:11:21,139
<font color="#CCCCCC">probably want to strive for but</font><font color="#E5E5E5"> the key</font>

332
00:11:19,369 --> 00:11:23,420
star or the<font color="#E5E5E5"> key player for</font><font color="#CCCCCC"> us today is</font>

333
00:11:21,139 --> 00:11:25,759
this<font color="#E5E5E5"> group over</font><font color="#CCCCCC"> here right</font><font color="#E5E5E5"> that I've</font>

334
00:11:23,420 --> 00:11:28,309
pointed out the automation<font color="#E5E5E5"> and content</font>

335
00:11:25,759 --> 00:11:29,600
development<font color="#CCCCCC"> group</font><font color="#E5E5E5"> and you'll see I put</font>

336
00:11:28,309 --> 00:11:30,769
them kind<font color="#E5E5E5"> of somewhere between two</font><font color="#CCCCCC"> and</font>

337
00:11:29,600 --> 00:11:33,139
<font color="#CCCCCC">three because</font><font color="#E5E5E5"> they're working really</font>

338
00:11:30,769 --> 00:11:34,819
with<font color="#E5E5E5"> that tier</font><font color="#CCCCCC"> 2 and tier 3 folks</font><font color="#E5E5E5"> to</font>

339
00:11:33,139 --> 00:11:37,699
ensure<font color="#CCCCCC"> that the content</font><font color="#E5E5E5"> is being</font>

340
00:11:34,819 --> 00:11:41,809
developed<font color="#E5E5E5"> for the sim as effectively as</font>

341
00:11:37,699 --> 00:11:44,868
<font color="#E5E5E5">possible now you see it a little number</font>

342
00:11:41,809 --> 00:11:47,929
beside each<font color="#E5E5E5"> of these teams that little</font>

343
00:11:44,869 --> 00:11:50,059
number<font color="#CCCCCC"> is a proportion</font><font color="#E5E5E5"> it's not hard and</font>

344
00:11:47,929 --> 00:11:52,339
<font color="#E5E5E5">fast but it's a recommendation so if</font>

345
00:11:50,059 --> 00:11:54,350
your team was comprised of you know this

346
00:11:52,339 --> 00:11:56,839
<font color="#E5E5E5">number of people you should</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> four at</font>

347
00:11:54,350 --> 00:11:59,600
the level<font color="#CCCCCC"> 1 and the ratio</font><font color="#E5E5E5"> is at 3 at</font>

348
00:11:56,839 --> 00:12:01,279
level 2<font color="#E5E5E5"> 2 at</font><font color="#CCCCCC"> level 3 etc if you have a</font>

349
00:11:59,600 --> 00:12:03,709
smaller<font color="#E5E5E5"> team that can go</font><font color="#CCCCCC"> down to</font><font color="#E5E5E5"> two and</font>

350
00:12:01,279 --> 00:12:05,600
<font color="#CCCCCC">one and one and so forth but as I</font>

351
00:12:03,709 --> 00:12:07,429
mentioned<font color="#E5E5E5"> the lowest maturity or kind of</font>

352
00:12:05,600 --> 00:12:09,079
<font color="#E5E5E5">you know where everyone kind</font><font color="#CCCCCC"> of starts</font>

353
00:12:07,429 --> 00:12:12,049
from<font color="#E5E5E5"> he probably</font><font color="#CCCCCC"> are just</font><font color="#E5E5E5"> gonna start</font>

354
00:12:09,079 --> 00:12:14,029
<font color="#E5E5E5">off with level ones and twos that makes</font>

355
00:12:12,049 --> 00:12:18,319
sense that's probably where we are<font color="#E5E5E5"> for</font>

356
00:12:14,029 --> 00:12:20,449
<font color="#E5E5E5">most people you then expand and the key</font>

357
00:12:18,319 --> 00:12:24,170
here<font color="#CCCCCC"> is after you've got</font><font color="#E5E5E5"> your initial</font>

358
00:12:20,449 --> 00:12:26,779
monitoring capabilities down you<font color="#E5E5E5"> then</font>

359
00:12:24,170 --> 00:12:29,089
expand immediately into automation and

360
00:12:26,779 --> 00:12:30,740
content<font color="#E5E5E5"> development</font><font color="#CCCCCC"> right so a lot of</font>

361
00:12:29,089 --> 00:12:31,790
times folks leave automation and content

362
00:12:30,740 --> 00:12:33,079
<font color="#CCCCCC">development so</font><font color="#E5E5E5"> that's the sim</font>

363
00:12:31,790 --> 00:12:35,509
development<font color="#E5E5E5"> that's the people</font><font color="#CCCCCC"> who are</font>

364
00:12:33,079 --> 00:12:36,949
tuning and creating rules for a sim and

365
00:12:35,509 --> 00:12:38,929
possibly<font color="#E5E5E5"> other capabilities</font><font color="#CCCCCC"> or</font>

366
00:12:36,949 --> 00:12:40,699
technologies as well that's<font color="#CCCCCC"> where you</font>

367
00:12:38,929 --> 00:12:43,040
want<font color="#E5E5E5"> to fit them in in this kind of</font>

368
00:12:40,699 --> 00:12:44,269
second stage of<font color="#E5E5E5"> course after</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you</font>

369
00:12:43,040 --> 00:12:45,860
probably<font color="#E5E5E5"> want to expand out</font><font color="#CCCCCC"> to get a</font>

370
00:12:44,269 --> 00:12:48,259
threat intelligence team or a couple of

371
00:12:45,860 --> 00:12:49,459
<font color="#CCCCCC">thread Intel analysts again depending on</font>

372
00:12:48,259 --> 00:12:53,869
<font color="#CCCCCC">the</font><font color="#E5E5E5"> size of your</font><font color="#CCCCCC"> organization</font><font color="#E5E5E5"> and the</font>

373
00:12:49,459 --> 00:12:56,868
needs<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you have and lastly you then</font>

374
00:12:53,869 --> 00:12:58,369
get<font color="#E5E5E5"> to</font><font color="#CCCCCC"> threat hunting</font><font color="#E5E5E5"> which is a great</font>

375
00:12:56,869 --> 00:13:03,589
topic that we<font color="#E5E5E5"> won't discuss today</font>

376
00:12:58,369 --> 00:13:06,379
unfortunately so recap<font color="#CCCCCC"> on a full mature</font>

377
00:13:03,589 --> 00:13:08,059
blue team and again the reason<font color="#E5E5E5"> we I</font><font color="#CCCCCC"> talk</font>

378
00:13:06,379 --> 00:13:10,220
<font color="#CCCCCC">about this is because</font><font color="#E5E5E5"> the technology</font>

379
00:13:08,059 --> 00:13:11,389
<font color="#E5E5E5">itself is not sufficient</font><font color="#CCCCCC"> I'm gonna tell</font>

380
00:13:10,220 --> 00:13:13,249
you about some<font color="#E5E5E5"> sim rules that are super</font>

381
00:13:11,389 --> 00:13:14,449
cool<font color="#E5E5E5"> but if you don't have anyone who</font>

382
00:13:13,249 --> 00:13:16,759
can<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> implement these properly</font>

383
00:13:14,449 --> 00:13:18,630
<font color="#E5E5E5">and if you don't have anyone who</font><font color="#CCCCCC"> can</font>

384
00:13:16,759 --> 00:13:22,080
actually investigate<font color="#E5E5E5"> them properly</font>

385
00:13:18,630 --> 00:13:23,250
doesn't matter so a lot<font color="#E5E5E5"> of times it's</font>

386
00:13:22,080 --> 00:13:26,250
important<font color="#CCCCCC"> to understand that you need</font>

387
00:13:23,250 --> 00:13:28,020
<font color="#E5E5E5">the right resources and you need to use</font>

388
00:13:26,250 --> 00:13:31,170
<font color="#E5E5E5">them correctly</font><font color="#CCCCCC"> in order to you know</font>

389
00:13:28,020 --> 00:13:32,730
<font color="#E5E5E5">effectively leverage what you're doing</font>

390
00:13:31,170 --> 00:13:33,780
with your<font color="#E5E5E5"> security program</font><font color="#CCCCCC"> now when</font>

391
00:13:32,730 --> 00:13:35,190
you're trying to<font color="#E5E5E5"> staff the security</font>

392
00:13:33,780 --> 00:13:36,930
content development<font color="#E5E5E5"> team or security</font>

393
00:13:35,190 --> 00:13:39,150
automation<font color="#E5E5E5"> team of course you</font><font color="#CCCCCC"> probably</font>

394
00:13:36,930 --> 00:13:40,709
want dedicated resources<font color="#E5E5E5"> if you can one</font>

395
00:13:39,150 --> 00:13:43,079
or two is probably<font color="#E5E5E5"> sufficient three is</font>

396
00:13:40,710 --> 00:13:44,550
ideal typically they need to have a

397
00:13:43,080 --> 00:13:47,700
little<font color="#CCCCCC"> bit of software dev background</font>

398
00:13:44,550 --> 00:13:49,740
and some<font color="#CCCCCC"> IR or security operations</font>

399
00:13:47,700 --> 00:13:51,630
background<font color="#E5E5E5"> red team is also perfectly</font>

400
00:13:49,740 --> 00:13:54,540
acceptable<font color="#E5E5E5"> the idea here is I need to</font>

401
00:13:51,630 --> 00:13:57,570
<font color="#E5E5E5">understand what attackers do what</font>

402
00:13:54,540 --> 00:13:59,370
attackers<font color="#E5E5E5"> might try</font><font color="#CCCCCC"> to do what attacks</font>

403
00:13:57,570 --> 00:14:01,680
look like<font color="#E5E5E5"> attacker TTP's techniques</font>

404
00:13:59,370 --> 00:14:02,940
tactics<font color="#CCCCCC"> and procedures</font><font color="#E5E5E5"> they're probably</font>

405
00:14:01,680 --> 00:14:05,760
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> get this information from the</font>

406
00:14:02,940 --> 00:14:06,750
threat Intel feeds or<font color="#E5E5E5"> group anyways but</font>

407
00:14:05,760 --> 00:14:08,069
<font color="#E5E5E5">they still need to</font><font color="#CCCCCC"> have a good</font>

408
00:14:06,750 --> 00:14:09,840
<font color="#CCCCCC">understanding of what it</font><font color="#E5E5E5"> is if you want</font>

409
00:14:08,070 --> 00:14:12,180
<font color="#CCCCCC">to make effective detection for it</font>

410
00:14:09,840 --> 00:14:14,130
because<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of times people try to</font>

411
00:14:12,180 --> 00:14:17,250
<font color="#E5E5E5">develop</font><font color="#CCCCCC"> sim content</font><font color="#E5E5E5"> and if they don't</font>

412
00:14:14,130 --> 00:14:19,740
really understand<font color="#E5E5E5"> the attack or why the</font>

413
00:14:17,250 --> 00:14:21,600
attack works<font color="#E5E5E5"> or you</font><font color="#CCCCCC"> know the details of</font>

414
00:14:19,740 --> 00:14:23,250
it they might tune it<font color="#E5E5E5"> in a way that</font><font color="#CCCCCC"> it</font>

415
00:14:21,600 --> 00:14:25,290
won't won't be effective any longer

416
00:14:23,250 --> 00:14:26,850
without<font color="#E5E5E5"> realizing it</font>

417
00:14:25,290 --> 00:14:28,860
so programming skills of<font color="#E5E5E5"> course and</font>

418
00:14:26,850 --> 00:14:30,510
maybe some signature skills<font color="#E5E5E5"> signature</font>

419
00:14:28,860 --> 00:14:33,780
writing skills like<font color="#E5E5E5"> regex is</font><font color="#CCCCCC"> a very</font>

420
00:14:30,510 --> 00:14:35,970
basic<font color="#E5E5E5"> way of writing patterns snort cigs</font>

421
00:14:33,780 --> 00:14:37,560
<font color="#E5E5E5">PR</font><font color="#CCCCCC"> i-- OCS there's a</font><font color="#E5E5E5"> number</font><font color="#CCCCCC"> of different</font>

422
00:14:35,970 --> 00:14:38,700
capabilities as long as you have a

423
00:14:37,560 --> 00:14:42,150
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of an</font><font color="#E5E5E5"> understanding of how</font><font color="#CCCCCC"> to</font>

424
00:14:38,700 --> 00:14:45,600
do<font color="#E5E5E5"> that you should</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> fine now we're</font>

425
00:14:42,150 --> 00:14:48,300
gonna get into content management how

426
00:14:45,600 --> 00:14:50,100
you manage and<font color="#CCCCCC"> develop this content</font><font color="#E5E5E5"> this</font>

427
00:14:48,300 --> 00:14:51,270
<font color="#E5E5E5">will be a bit more interesting</font><font color="#CCCCCC"> I think</font>

428
00:14:50,100 --> 00:14:54,630
<font color="#E5E5E5">and then we're gonna get</font><font color="#CCCCCC"> into the sim</font>

429
00:14:51,270 --> 00:14:56,490
<font color="#CCCCCC">roles here's what I expect most people</font>

430
00:14:54,630 --> 00:14:58,050
are mostly<font color="#CCCCCC"> interested</font><font color="#E5E5E5"> in today of course</font>

431
00:14:56,490 --> 00:14:59,460
<font color="#E5E5E5">the use case development cycle looks</font>

432
00:14:58,050 --> 00:15:01,469
pretty much<font color="#E5E5E5"> like any development cycle</font>

433
00:14:59,460 --> 00:15:02,850
right you need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> have an idea starting</font>

434
00:15:01,470 --> 00:15:06,570
off<font color="#E5E5E5"> with the plan and what you're</font><font color="#CCCCCC"> trying</font>

435
00:15:02,850 --> 00:15:08,970
<font color="#CCCCCC">to detect what are you trying to detect</font>

436
00:15:06,570 --> 00:15:10,740
<font color="#E5E5E5">or correlate upon and that's typically</font>

437
00:15:08,970 --> 00:15:14,250
like I said maybe going to<font color="#E5E5E5"> be some input</font>

438
00:15:10,740 --> 00:15:16,410
coming<font color="#E5E5E5"> from your Intel team it could be</font>

439
00:15:14,250 --> 00:15:17,400
input from the hunt team if you<font color="#E5E5E5"> have a</font>

440
00:15:16,410 --> 00:15:18,719
threat hunting team and they've

441
00:15:17,400 --> 00:15:20,730
identified something<font color="#E5E5E5"> that your controls</font>

442
00:15:18,720 --> 00:15:23,160
do not currently detect that would be a

443
00:15:20,730 --> 00:15:26,010
great input alternatively<font color="#E5E5E5"> it could also</font>

444
00:15:23,160 --> 00:15:27,300
be<font color="#E5E5E5"> from you know anyone</font><font color="#CCCCCC"> in the security</font>

445
00:15:26,010 --> 00:15:29,310
organization who's got a good<font color="#CCCCCC"> idea of</font>

446
00:15:27,300 --> 00:15:31,140
something<font color="#CCCCCC"> to detect you then develop</font>

447
00:15:29,310 --> 00:15:31,560
some<font color="#CCCCCC"> pseudo code or logic try to</font>

448
00:15:31,140 --> 00:15:33,840
identify

449
00:15:31,560 --> 00:15:37,109
by which tools and log sources you'll

450
00:15:33,840 --> 00:15:40,770
need and then<font color="#E5E5E5"> you need to implement</font><font color="#CCCCCC"> that</font>

451
00:15:37,110 --> 00:15:42,600
of course in probably<font color="#CCCCCC"> tests first than</font>

452
00:15:40,770 --> 00:15:44,220
production<font color="#E5E5E5"> talk a bit about</font><font color="#CCCCCC"> more that</font>

453
00:15:42,600 --> 00:15:47,640
<font color="#E5E5E5">and once it's implemented and you know</font>

454
00:15:44,220 --> 00:15:49,110
that it's tuned effectively that's when

455
00:15:47,640 --> 00:15:50,520
you can operationalize<font color="#E5E5E5"> it and actually</font>

456
00:15:49,110 --> 00:15:51,720
have people<font color="#E5E5E5"> start monitoring it and the</font>

457
00:15:50,520 --> 00:15:53,550
<font color="#E5E5E5">biggest mistake</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of people make is</font>

458
00:15:51,720 --> 00:15:55,740
<font color="#CCCCCC">they implement and they don't tune</font>

459
00:15:53,550 --> 00:15:57,150
before<font color="#CCCCCC"> they operationalize and so what</font>

460
00:15:55,740 --> 00:16:01,040
you<font color="#E5E5E5"> end up having is of course</font><font color="#CCCCCC"> a</font>

461
00:15:57,150 --> 00:16:02,880
security<font color="#E5E5E5"> monitoring team or you know</font>

462
00:16:01,040 --> 00:16:04,740
security analysts who<font color="#E5E5E5"> are basically</font>

463
00:16:02,880 --> 00:16:06,000
overloaded and<font color="#E5E5E5"> they're flooded with</font>

464
00:16:04,740 --> 00:16:07,560
<font color="#E5E5E5">alerts and it's impossible</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> them to</font>

465
00:16:06,000 --> 00:16:09,540
<font color="#E5E5E5">really assess and evaluate all the</font>

466
00:16:07,560 --> 00:16:11,550
<font color="#E5E5E5">alerts and then they end up missing</font>

467
00:16:09,540 --> 00:16:13,319
something that<font color="#CCCCCC"> was really obvious and</font>

468
00:16:11,550 --> 00:16:14,699
the organization might get breached and

469
00:16:13,320 --> 00:16:18,060
then later they go back and say well<font color="#E5E5E5"> you</font>

470
00:16:14,700 --> 00:16:20,220
<font color="#CCCCCC">had you know an alert that</font><font color="#E5E5E5"> told you but</font>

471
00:16:18,060 --> 00:16:21,779
if there's an a thousand alerts a day

472
00:16:20,220 --> 00:16:23,760
it's<font color="#E5E5E5"> not really reasonable for anyone to</font>

473
00:16:21,779 --> 00:16:25,950
actually expect them<font color="#CCCCCC"> to catch everything</font>

474
00:16:23,760 --> 00:16:27,930
<font color="#E5E5E5">now when you're developing use cases or</font>

475
00:16:25,950 --> 00:16:29,690
<font color="#E5E5E5">use cases</font><font color="#CCCCCC"> as a kind of</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> that kind of</font>

476
00:16:27,930 --> 00:16:32,400
term for correlation rules in a sim

477
00:16:29,690 --> 00:16:33,870
that's the term<font color="#E5E5E5"> that folks use so when</font>

478
00:16:32,400 --> 00:16:35,310
you're developing use<font color="#E5E5E5"> cases when you're</font>

479
00:16:33,870 --> 00:16:36,450
<font color="#CCCCCC">making a library of use cases these are</font>

480
00:16:35,310 --> 00:16:37,949
the kinds<font color="#CCCCCC"> of</font><font color="#E5E5E5"> things you probably want to</font>

481
00:16:36,450 --> 00:16:39,630
track right you need to<font color="#CCCCCC"> have of course a</font>

482
00:16:37,950 --> 00:16:41,339
unique name and<font color="#E5E5E5"> number so you can</font>

483
00:16:39,630 --> 00:16:43,170
reference<font color="#E5E5E5"> that specific use case of</font>

484
00:16:41,339 --> 00:16:44,339
correlation rule<font color="#E5E5E5"> you probably want to</font>

485
00:16:43,170 --> 00:16:47,099
assign<font color="#CCCCCC"> it some</font><font color="#E5E5E5"> kind of category</font>

486
00:16:44,339 --> 00:16:48,720
personally<font color="#E5E5E5"> I like to assign</font><font color="#CCCCCC"> categories</font>

487
00:16:47,100 --> 00:16:51,150
that<font color="#CCCCCC"> are associated</font><font color="#E5E5E5"> with the attack</font>

488
00:16:48,720 --> 00:16:53,550
lifecycle or<font color="#CCCCCC"> the kill</font><font color="#E5E5E5"> chain</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> Mandy</font>

489
00:16:51,150 --> 00:16:54,870
and<font color="#CCCCCC"> fireEye has our own attack lifecycle</font>

490
00:16:53,550 --> 00:16:58,020
there's a<font color="#E5E5E5"> Lockheed Martin kill chain</font>

491
00:16:54,870 --> 00:16:59,520
<font color="#E5E5E5">whichever you use you know I think it's</font>

492
00:16:58,020 --> 00:17:01,710
good<font color="#CCCCCC"> that's a good way</font><font color="#E5E5E5"> to approach the</font>

493
00:16:59,520 --> 00:17:03,060
categorization<font color="#E5E5E5"> severity of</font><font color="#CCCCCC"> course is</font>

494
00:17:01,710 --> 00:17:04,589
subjective<font color="#E5E5E5"> a description should</font><font color="#CCCCCC"> be</font>

495
00:17:03,060 --> 00:17:07,319
enough to explain to<font color="#E5E5E5"> someone who's</font>

496
00:17:04,589 --> 00:17:09,300
reading what this use<font color="#CCCCCC"> case should</font><font color="#E5E5E5"> detect</font>

497
00:17:07,319 --> 00:17:11,010
or this rule should<font color="#CCCCCC"> detect</font><font color="#E5E5E5"> so they don't</font>

498
00:17:09,300 --> 00:17:12,060
actually need<font color="#E5E5E5"> to read you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> the logic</font>

499
00:17:11,010 --> 00:17:13,160
behind it they should<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to get a</font>

500
00:17:12,060 --> 00:17:15,329
<font color="#E5E5E5">good understanding from your description</font>

501
00:17:13,160 --> 00:17:17,699
<font color="#E5E5E5">you of course do want to have some</font>

502
00:17:15,329 --> 00:17:19,409
<font color="#E5E5E5">pseudo code involved right so you've got</font>

503
00:17:17,699 --> 00:17:21,740
to think<font color="#CCCCCC"> about</font><font color="#E5E5E5"> that a little bit</font><font color="#CCCCCC"> and the</font>

504
00:17:19,410 --> 00:17:23,459
stuff we're gonna<font color="#E5E5E5"> see today</font><font color="#CCCCCC"> I have</font><font color="#E5E5E5"> 22</font>

505
00:17:21,740 --> 00:17:24,630
correlation rules we're gonna go through

506
00:17:23,459 --> 00:17:26,819
<font color="#E5E5E5">and I've written</font><font color="#CCCCCC"> pseudocode for each of</font>

507
00:17:24,630 --> 00:17:28,260
those<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can take</font><font color="#E5E5E5"> that pseudocode</font>

508
00:17:26,819 --> 00:17:30,030
<font color="#CCCCCC">and then try to implement it</font><font color="#E5E5E5"> and the</font>

509
00:17:28,260 --> 00:17:32,340
reason we use<font color="#CCCCCC"> pseudocode</font><font color="#E5E5E5"> is because it's</font>

510
00:17:30,030 --> 00:17:33,840
technology<font color="#CCCCCC"> agnostic right you then</font><font color="#E5E5E5"> have</font>

511
00:17:32,340 --> 00:17:35,370
to adapt it for your<font color="#E5E5E5"> technology and also</font>

512
00:17:33,840 --> 00:17:37,110
for your<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> depending on what</font>

513
00:17:35,370 --> 00:17:39,780
<font color="#E5E5E5">logs you have log sources you might be</font>

514
00:17:37,110 --> 00:17:41,040
using etc log source requirements I

515
00:17:39,780 --> 00:17:43,080
mentioned before very<font color="#E5E5E5"> straightforward</font>

516
00:17:41,040 --> 00:17:45,210
what do we<font color="#E5E5E5"> need to make this accomplish</font>

517
00:17:43,080 --> 00:17:47,309
this<font color="#E5E5E5"> associated</font><font color="#CCCCCC"> reference lists</font>

518
00:17:45,210 --> 00:17:49,320
this is data that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> need to</font><font color="#CCCCCC"> populate</font>

519
00:17:47,309 --> 00:17:50,610
when<font color="#E5E5E5"> you're first creating your sim or</font>

520
00:17:49,320 --> 00:17:52,260
when you're trying<font color="#E5E5E5"> to make correlation</font>

521
00:17:50,610 --> 00:17:54,209
rules effective<font color="#E5E5E5"> this might be something</font>

522
00:17:52,260 --> 00:17:56,100
<font color="#CCCCCC">like a</font><font color="#E5E5E5"> list of all the server host names</font>

523
00:17:54,210 --> 00:17:57,929
<font color="#E5E5E5">a list of all the workstation host names</font>

524
00:17:56,100 --> 00:17:59,490
a list<font color="#E5E5E5"> of all</font><font color="#CCCCCC"> of the user names</font>

525
00:17:57,929 --> 00:18:01,380
associated<font color="#E5E5E5"> with your IT administrators</font>

526
00:17:59,490 --> 00:18:02,669
etc<font color="#CCCCCC"> these types</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> Lists that you may</font>

527
00:18:01,380 --> 00:18:05,640
want a reference<font color="#CCCCCC"> in correlation rows</font>

528
00:18:02,669 --> 00:18:07,289
later on and lastly something that a<font color="#E5E5E5"> lot</font>

529
00:18:05,640 --> 00:18:10,260
<font color="#CCCCCC">of people leave out of</font><font color="#E5E5E5"> their library</font><font color="#CCCCCC"> or</font>

530
00:18:07,289 --> 00:18:12,929
<font color="#E5E5E5">use case database is test scripts that's</font>

531
00:18:10,260 --> 00:18:16,289
just a step by<font color="#CCCCCC"> step of how you</font><font color="#E5E5E5"> actually</font>

532
00:18:12,929 --> 00:18:17,460
trigger<font color="#E5E5E5"> this alert for real not in</font><font color="#CCCCCC"> a</font>

533
00:18:16,289 --> 00:18:19,020
theory and then you will actually

534
00:18:17,460 --> 00:18:20,250
<font color="#E5E5E5">execute that test script and this is how</font>

535
00:18:19,020 --> 00:18:24,149
you make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that the sim is doing what</font>

536
00:18:20,250 --> 00:18:25,770
is<font color="#E5E5E5"> expected to do so for the actual</font>

537
00:18:24,149 --> 00:18:27,750
<font color="#CCCCCC">development portion</font><font color="#E5E5E5"> as I mentioned you</font>

538
00:18:25,770 --> 00:18:29,490
probably want to start<font color="#CCCCCC"> off with</font><font color="#E5E5E5"> user</font>

539
00:18:27,750 --> 00:18:32,789
acceptance testing right<font color="#CCCCCC"> UAT that's the</font>

540
00:18:29,490 --> 00:18:33,419
test environment<font color="#E5E5E5"> here after you've gone</font>

541
00:18:32,789 --> 00:18:35,640
from<font color="#CCCCCC"> UAT</font>

542
00:18:33,419 --> 00:18:37,289
goes<font color="#E5E5E5"> into the tuning phase and that's a</font>

543
00:18:35,640 --> 00:18:39,570
<font color="#CCCCCC">back-and-forth process between</font><font color="#E5E5E5"> tuning</font>

544
00:18:37,289 --> 00:18:41,370
and production implementation so when we

545
00:18:39,570 --> 00:18:43,439
<font color="#E5E5E5">get into that</font><font color="#CCCCCC"> UAT implementation</font><font color="#E5E5E5"> of</font>

546
00:18:41,370 --> 00:18:46,559
course you're just<font color="#E5E5E5"> testing to make sure</font>

547
00:18:43,440 --> 00:18:47,940
<font color="#E5E5E5">whether the logic works and preferably</font>

548
00:18:46,559 --> 00:18:49,320
you've got your production data<font color="#E5E5E5"> in there</font>

549
00:18:47,940 --> 00:18:50,460
so you<font color="#E5E5E5"> can actually see the kind of</font>

550
00:18:49,320 --> 00:18:52,200
performance<font color="#E5E5E5"> impact that's</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font>

551
00:18:50,460 --> 00:18:54,390
happen<font color="#E5E5E5"> on</font><font color="#CCCCCC"> your sim</font><font color="#E5E5E5"> once you start</font><font color="#CCCCCC"> this</font>

552
00:18:52,200 --> 00:18:55,590
rule it could be very could be very<font color="#E5E5E5"> high</font>

553
00:18:54,390 --> 00:18:57,539
<font color="#E5E5E5">impact depending on what you've written</font>

554
00:18:55,590 --> 00:18:58,918
at the<font color="#E5E5E5"> thresholds you set</font>

555
00:18:57,539 --> 00:19:01,039
but once you're feeling<font color="#E5E5E5"> comfortable with</font>

556
00:18:58,919 --> 00:19:03,090
<font color="#E5E5E5">that you need to tune it a little right</font>

557
00:19:01,039 --> 00:19:04,590
every<font color="#E5E5E5"> organization will have false</font>

558
00:19:03,090 --> 00:19:06,149
positives<font color="#CCCCCC"> the pseudocode I'm going</font><font color="#E5E5E5"> to</font>

559
00:19:04,590 --> 00:19:07,230
show<font color="#E5E5E5"> you a guarantee if you just try to</font>

560
00:19:06,149 --> 00:19:09,239
copy<font color="#CCCCCC"> paste this into</font><font color="#E5E5E5"> your own</font>

561
00:19:07,230 --> 00:19:10,919
organization<font color="#E5E5E5"> there's gonna be some false</font>

562
00:19:09,240 --> 00:19:12,690
<font color="#E5E5E5">positive that I've never heard of that</font>

563
00:19:10,919 --> 00:19:14,070
nobody<font color="#CCCCCC"> even considered was even possible</font>

564
00:19:12,690 --> 00:19:16,320
<font color="#CCCCCC">and it's going</font><font color="#E5E5E5"> to be in your</font>

565
00:19:14,070 --> 00:19:18,779
organization<font color="#CCCCCC"> so tuning is very very</font>

566
00:19:16,320 --> 00:19:19,770
important<font color="#CCCCCC"> and then of course</font><font color="#E5E5E5"> the</font>

567
00:19:18,779 --> 00:19:22,049
production about<font color="#E5E5E5"> the implementation</font>

568
00:19:19,770 --> 00:19:23,429
<font color="#CCCCCC">should be the easiest part</font><font color="#E5E5E5"> that's</font>

569
00:19:22,049 --> 00:19:24,480
basically just<font color="#CCCCCC"> taking the content</font><font color="#E5E5E5"> you</font>

570
00:19:23,429 --> 00:19:26,909
developed in your<font color="#CCCCCC"> uit</font>

571
00:19:24,480 --> 00:19:28,350
you've already tested and tuned and you

572
00:19:26,909 --> 00:19:29,940
just<font color="#E5E5E5"> plop that into prod and that can be</font>

573
00:19:28,350 --> 00:19:32,219
of course<font color="#E5E5E5"> done through change management</font>

574
00:19:29,940 --> 00:19:33,390
<font color="#E5E5E5">easily this is</font><font color="#CCCCCC"> the hard</font><font color="#E5E5E5"> part that can't</font>

575
00:19:32,220 --> 00:19:36,059
be done through change management<font color="#E5E5E5"> easily</font>

576
00:19:33,390 --> 00:19:38,730
<font color="#E5E5E5">that's daily tuning again another thing</font>

577
00:19:36,059 --> 00:19:40,710
<font color="#CCCCCC">that a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of people say not possible</font>

578
00:19:38,730 --> 00:19:41,850
and in some places it's really<font color="#E5E5E5"> hard to</font>

579
00:19:40,710 --> 00:19:43,980
do<font color="#CCCCCC"> that but that is what you should</font>

580
00:19:41,850 --> 00:19:46,520
<font color="#E5E5E5">strive for</font><font color="#CCCCCC"> that is the ideal situation</font>

581
00:19:43,980 --> 00:19:49,890
<font color="#CCCCCC">is that you should be</font><font color="#E5E5E5"> tuning rules</font><font color="#CCCCCC"> and</font>

582
00:19:46,520 --> 00:19:51,000
events on a daily basis in your<font color="#E5E5E5"> sim</font>

583
00:19:49,890 --> 00:19:52,620
which is of course<font color="#E5E5E5"> why you need</font>

584
00:19:51,000 --> 00:19:54,960
dedicated<font color="#CCCCCC"> staff and resources to do that</font>

585
00:19:52,620 --> 00:19:56,520
<font color="#E5E5E5">it's not really reasonable to expect a</font>

586
00:19:54,960 --> 00:19:58,049
team that's<font color="#CCCCCC"> party got a number of other</font>

587
00:19:56,520 --> 00:20:00,408
<font color="#CCCCCC">things on their plate to be doing daily</font>

588
00:19:58,049 --> 00:20:02,519
<font color="#E5E5E5">tuning of the same as</font>

589
00:20:00,409 --> 00:20:03,779
now I mentioned that test script<font color="#E5E5E5"> this is</font>

590
00:20:02,519 --> 00:20:07,679
an example<font color="#E5E5E5"> of one</font><font color="#CCCCCC"> of the test scripts</font>

591
00:20:03,779 --> 00:20:09,570
you might use<font color="#CCCCCC"> for a use case or</font><font color="#E5E5E5"> a</font>

592
00:20:07,679 --> 00:20:11,429
correlation rule<font color="#E5E5E5"> that detects malware</font>

593
00:20:09,570 --> 00:20:13,950
detected on a domain<font color="#E5E5E5"> controller</font><font color="#CCCCCC"> very</font>

594
00:20:11,429 --> 00:20:15,659
simple not<font color="#E5E5E5"> very cool but you know</font>

595
00:20:13,950 --> 00:20:18,269
<font color="#E5E5E5">obviously</font><font color="#CCCCCC"> how do you</font><font color="#E5E5E5"> test this well</font>

596
00:20:15,659 --> 00:20:20,159
<font color="#E5E5E5">let's create an</font><font color="#CCCCCC"> AI car file if you're</font>

597
00:20:18,269 --> 00:20:22,230
not familiar with<font color="#E5E5E5"> an AI car file this is</font>

598
00:20:20,159 --> 00:20:25,679
a file<font color="#CCCCCC"> that will be detected</font><font color="#E5E5E5"> by all</font>

599
00:20:22,230 --> 00:20:27,600
antivirus solutions<font color="#E5E5E5"> however it is not</font>

600
00:20:25,679 --> 00:20:29,489
malicious<font color="#CCCCCC"> it's just a plain</font><font color="#E5E5E5"> text string</font>

601
00:20:27,600 --> 00:20:31,498
I believe<font color="#CCCCCC"> with 68 characters is the</font>

602
00:20:29,489 --> 00:20:33,149
minimum<font color="#E5E5E5"> you need for the AI car</font><font color="#CCCCCC"> and it's</font>

603
00:20:31,499 --> 00:20:35,220
a<font color="#CCCCCC"> specific set of characters written</font>

604
00:20:33,149 --> 00:20:36,209
right<font color="#E5E5E5"> here</font><font color="#CCCCCC"> you can find</font><font color="#E5E5E5"> this online save</font>

605
00:20:35,220 --> 00:20:38,700
the file<font color="#E5E5E5"> on</font><font color="#CCCCCC"> your domain controller</font>

606
00:20:36,210 --> 00:20:41,009
<font color="#E5E5E5">validate yes we saw the alert validate</font>

607
00:20:38,700 --> 00:20:42,720
yes the<font color="#E5E5E5"> antivirus clean this off very</font>

608
00:20:41,009 --> 00:20:44,759
<font color="#E5E5E5">straightforward</font><font color="#CCCCCC"> but you actually</font><font color="#E5E5E5"> need</font><font color="#CCCCCC"> to</font>

609
00:20:42,720 --> 00:20:48,179
create scripts for everything in<font color="#E5E5E5"> your</font>

610
00:20:44,759 --> 00:20:50,369
use case database<font color="#E5E5E5"> now that use case</font>

611
00:20:48,179 --> 00:20:55,230
database or the<font color="#CCCCCC"> library itself is one</font>

612
00:20:50,369 --> 00:20:58,230
<font color="#E5E5E5">building block from many and these</font>

613
00:20:55,230 --> 00:21:00,899
building blocks all connect in this way

614
00:20:58,230 --> 00:21:03,779
they're all correlated<font color="#E5E5E5"> I'm gonna show</font>

615
00:21:00,899 --> 00:21:05,070
you actually how<font color="#E5E5E5"> you could fit</font><font color="#CCCCCC"> these</font>

616
00:21:03,779 --> 00:21:07,289
together and<font color="#E5E5E5"> how they should be fit</font>

617
00:21:05,070 --> 00:21:09,779
together but<font color="#E5E5E5"> the idea here</font><font color="#CCCCCC"> is that</font><font color="#E5E5E5"> you</font>

618
00:21:07,289 --> 00:21:12,960
have<font color="#E5E5E5"> your use case library or database</font>

619
00:21:09,779 --> 00:21:14,100
as the center<font color="#E5E5E5"> of what you're doing for</font>

620
00:21:12,960 --> 00:21:15,299
security monitoring right these are<font color="#E5E5E5"> the</font>

621
00:21:14,100 --> 00:21:16,230
<font color="#E5E5E5">things you're looking for</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is how</font>

622
00:21:15,299 --> 00:21:19,440
<font color="#E5E5E5">you're monitoring and what you're</font>

623
00:21:16,230 --> 00:21:21,539
monitoring<font color="#E5E5E5"> for that ties into an</font>

624
00:21:19,440 --> 00:21:22,470
<font color="#E5E5E5">investigations tracker some central</font>

625
00:21:21,539 --> 00:21:23,730
database where you<font color="#E5E5E5"> can track the</font>

626
00:21:22,470 --> 00:21:25,320
investigations and<font color="#E5E5E5"> lurtz that are coming</font>

627
00:21:23,730 --> 00:21:26,399
out of<font color="#E5E5E5"> your tools whether they're coming</font>

628
00:21:25,320 --> 00:21:28,168
<font color="#E5E5E5">from your sim or somewhere</font><font color="#CCCCCC"> else</font><font color="#E5E5E5"> but</font>

629
00:21:26,399 --> 00:21:30,629
<font color="#E5E5E5">probably from your sim so your alert</font>

630
00:21:28,169 --> 00:21:32,070
right<font color="#CCCCCC"> feeds into that Investigations</font>

631
00:21:30,629 --> 00:21:33,959
tracker the tracker<font color="#CCCCCC"> references the use</font>

632
00:21:32,070 --> 00:21:35,850
case database or<font color="#E5E5E5"> the use case library so</font>

633
00:21:33,960 --> 00:21:37,590
if an alert fires<font color="#E5E5E5"> your analyst</font><font color="#CCCCCC"> should be</font>

634
00:21:35,850 --> 00:21:39,570
able<font color="#E5E5E5"> to click on the alert name and read</font>

635
00:21:37,590 --> 00:21:40,738
the use case library entry<font color="#E5E5E5"> with all of</font>

636
00:21:39,570 --> 00:21:42,928
the<font color="#E5E5E5"> details that we discussed previously</font>

637
00:21:40,739 --> 00:21:46,049
<font color="#E5E5E5">all those fields</font><font color="#CCCCCC"> so that</font><font color="#E5E5E5"> they can get</font>

638
00:21:42,929 --> 00:21:47,489
context<font color="#CCCCCC"> on what's going on that use case</font>

639
00:21:46,049 --> 00:21:50,549
libraries then tied<font color="#CCCCCC"> into the alert</font>

640
00:21:47,489 --> 00:21:52,559
<font color="#CCCCCC">playbooks</font><font color="#E5E5E5"> or alert tasks this is the</font>

641
00:21:50,549 --> 00:21:55,350
<font color="#E5E5E5">actual steps you should take so having a</font>

642
00:21:52,559 --> 00:21:56,789
sim and having monitoring is great but

643
00:21:55,350 --> 00:21:59,129
then you<font color="#E5E5E5"> need to know what to do want</font>

644
00:21:56,789 --> 00:22:01,019
something triggers so that's what we

645
00:21:59,129 --> 00:22:03,269
call alert<font color="#CCCCCC"> playbooks this is different</font>

646
00:22:01,019 --> 00:22:05,460
<font color="#E5E5E5">than an incident playbook</font><font color="#CCCCCC"> right this is</font>

647
00:22:03,269 --> 00:22:07,019
more what<font color="#E5E5E5"> you do before you know there's</font>

648
00:22:05,460 --> 00:22:09,090
an<font color="#E5E5E5"> incident you just have an alert</font><font color="#CCCCCC"> you</font>

649
00:22:07,019 --> 00:22:10,230
have to<font color="#E5E5E5"> validate is this alert actually</font>

650
00:22:09,090 --> 00:22:12,120
representative<font color="#E5E5E5"> of an incident or</font>

651
00:22:10,230 --> 00:22:13,440
something we need<font color="#E5E5E5"> to investigate further</font>

652
00:22:12,120 --> 00:22:15,659
or is<font color="#E5E5E5"> it a false positive that we're</font>

653
00:22:13,440 --> 00:22:17,550
gonna queue up for<font color="#E5E5E5"> daily tuning and the</font>

654
00:22:15,660 --> 00:22:19,260
<font color="#CCCCCC">last piece</font><font color="#E5E5E5"> is your threat intelligence</font>

655
00:22:17,550 --> 00:22:22,050
<font color="#CCCCCC">database whether this is simply just</font>

656
00:22:19,260 --> 00:22:23,580
<font color="#E5E5E5">feeds coming</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> you know some sticks</font>

657
00:22:22,050 --> 00:22:24,899
and taxi feeds or it's an actual<font color="#E5E5E5"> team</font>

658
00:22:23,580 --> 00:22:27,570
that's kind<font color="#CCCCCC"> of preparing</font><font color="#E5E5E5"> briefs for you</font>

659
00:22:24,900 --> 00:22:30,440
<font color="#CCCCCC">you also want to</font><font color="#E5E5E5"> have that tied in so</font>

660
00:22:27,570 --> 00:22:33,510
<font color="#E5E5E5">that you can have that</font><font color="#CCCCCC"> connection</font><font color="#E5E5E5"> with</font>

661
00:22:30,440 --> 00:22:35,340
your use cases in your alerts<font color="#E5E5E5"> again the</font>

662
00:22:33,510 --> 00:22:37,410
context is<font color="#E5E5E5"> there in one place the</font>

663
00:22:35,340 --> 00:22:39,120
purpose of a sim is that<font color="#E5E5E5"> central pane of</font>

664
00:22:37,410 --> 00:22:40,470
glass<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> don't want to have people</font>

665
00:22:39,120 --> 00:22:42,000
having<font color="#CCCCCC"> to go to different resources if</font>

666
00:22:40,470 --> 00:22:44,250
you can<font color="#CCCCCC"> avoid</font><font color="#E5E5E5"> it or at</font><font color="#CCCCCC"> least make it as</font>

667
00:22:42,000 --> 00:22:46,290
easy<font color="#E5E5E5"> as possible</font><font color="#CCCCCC"> this is an example of</font>

668
00:22:44,250 --> 00:22:48,750
what you might have at a very high<font color="#CCCCCC"> level</font>

669
00:22:46,290 --> 00:22:50,370
of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> used case library names</font><font color="#E5E5E5"> these may</font>

670
00:22:48,750 --> 00:22:52,020
not<font color="#CCCCCC"> be that valuable I've made</font><font color="#E5E5E5"> these up</font>

671
00:22:50,370 --> 00:22:53,489
<font color="#E5E5E5">you know based on things that we've seen</font>

672
00:22:52,020 --> 00:22:56,040
<font color="#CCCCCC">before or correlation rows we've used</font>

673
00:22:53,490 --> 00:22:58,440
<font color="#CCCCCC">before but</font><font color="#E5E5E5"> the idea</font><font color="#CCCCCC"> is more</font><font color="#E5E5E5"> on the right</font>

674
00:22:56,040 --> 00:23:00,600
side here those tasks the alert tasks

675
00:22:58,440 --> 00:23:02,430
should be defined<font color="#E5E5E5"> and these will be</font>

676
00:23:00,600 --> 00:23:04,020
procedural tasks that<font color="#E5E5E5"> your organization</font>

677
00:23:02,430 --> 00:23:06,090
would do in a<font color="#CCCCCC"> regular basis</font><font color="#E5E5E5"> these are</font>

678
00:23:04,020 --> 00:23:08,100
<font color="#E5E5E5">things you can document to a tee every</font>

679
00:23:06,090 --> 00:23:09,959
<font color="#E5E5E5">single time someone needs to get you</font>

680
00:23:08,100 --> 00:23:12,510
know information<font color="#E5E5E5"> about</font><font color="#CCCCCC"> a specific</font><font color="#E5E5E5"> source</font>

681
00:23:09,960 --> 00:23:14,700
IP address<font color="#CCCCCC"> it's gonna be the same</font><font color="#E5E5E5"> every</font>

682
00:23:12,510 --> 00:23:16,020
time<font color="#E5E5E5"> in your organization the goal here</font>

683
00:23:14,700 --> 00:23:17,880
is you can standardize<font color="#CCCCCC"> what you're doing</font>

684
00:23:16,020 --> 00:23:19,590
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> make</font><font color="#E5E5E5"> it more efficient and you</font>

685
00:23:17,880 --> 00:23:21,230
potentially could<font color="#CCCCCC"> actually automate a</font>

686
00:23:19,590 --> 00:23:23,370
lot of this<font color="#E5E5E5"> in the future right using</font>

687
00:23:21,230 --> 00:23:26,730
security orchestration tools that's the

688
00:23:23,370 --> 00:23:29,370
new buzzword<font color="#CCCCCC"> for</font><font color="#E5E5E5"> automation right here's</font>

689
00:23:26,730 --> 00:23:32,280
an example<font color="#E5E5E5"> of what you might see</font><font color="#CCCCCC"> for the</font>

690
00:23:29,370 --> 00:23:33,929
alert<font color="#E5E5E5"> playbook for an exe being</font>

691
00:23:32,280 --> 00:23:37,050
<font color="#CCCCCC">downloaded from an on</font><font color="#E5E5E5"> categorize website</font>

692
00:23:33,930 --> 00:23:39,750
very<font color="#E5E5E5"> straightforward there are six tasks</font>

693
00:23:37,050 --> 00:23:41,760
that need<font color="#E5E5E5"> to be done these tasks</font><font color="#CCCCCC"> can be</font>

694
00:23:39,750 --> 00:23:43,230
<font color="#E5E5E5">done within</font><font color="#CCCCCC"> 10</font><font color="#E5E5E5"> minutes</font><font color="#CCCCCC"> they could even</font>

695
00:23:41,760 --> 00:23:44,520
be<font color="#E5E5E5"> automated and then all it takes is</font>

696
00:23:43,230 --> 00:23:46,170
<font color="#E5E5E5">someone to review the information that</font>

697
00:23:44,520 --> 00:23:48,720
they've collected<font color="#E5E5E5"> from the collection</font>

698
00:23:46,170 --> 00:23:50,580
tasks<font color="#E5E5E5"> and then make a</font><font color="#CCCCCC"> decision about</font>

699
00:23:48,720 --> 00:23:56,940
whether<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a false positive or true</font>

700
00:23:50,580 --> 00:23:59,639
positive<font color="#CCCCCC"> and we're</font><font color="#E5E5E5"> going to give you an</font>

701
00:23:56,940 --> 00:24:03,990
<font color="#CCCCCC">example of an actual use case library</font>

702
00:23:59,640 --> 00:24:05,340
<font color="#E5E5E5">this is one of many that you could have</font>

703
00:24:03,990 --> 00:24:06,780
in this<font color="#CCCCCC"> particular</font><font color="#E5E5E5"> case there are a</font>

704
00:24:05,340 --> 00:24:08,669
couple of thousand use cases<font color="#E5E5E5"> in this</font>

705
00:24:06,780 --> 00:24:12,450
<font color="#CCCCCC">library which is pretty extensive</font><font color="#E5E5E5"> but</font>

706
00:24:08,670 --> 00:24:14,340
the idea again<font color="#E5E5E5"> being that</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> you</font>

707
00:24:12,450 --> 00:24:15,660
know a rule name<font color="#E5E5E5"> some other information</font>

708
00:24:14,340 --> 00:24:17,909
<font color="#E5E5E5">associated with you I'm going</font><font color="#CCCCCC"> to show</font>

709
00:24:15,660 --> 00:24:19,860
you<font color="#E5E5E5"> details of those informations that</font>

710
00:24:17,910 --> 00:24:21,270
you could collect<font color="#E5E5E5"> but the way that this</font>

711
00:24:19,860 --> 00:24:23,159
interlocks with<font color="#E5E5E5"> the other components</font>

712
00:24:21,270 --> 00:24:25,170
<font color="#CCCCCC">right so here you can see we've got a</font>

713
00:24:23,160 --> 00:24:25,400
rule database I<font color="#E5E5E5"> can go in and</font><font color="#CCCCCC"> I can read</font>

714
00:24:25,170 --> 00:24:26,900
<font color="#E5E5E5">about</font>

715
00:24:25,400 --> 00:24:29,900
<font color="#CCCCCC">rulz I can understand what</font><font color="#E5E5E5"> they are if I</font>

716
00:24:26,900 --> 00:24:32,540
so choose<font color="#E5E5E5"> however</font><font color="#CCCCCC"> as I mentioned before</font>

717
00:24:29,900 --> 00:24:34,820
<font color="#CCCCCC">that investigations tracker</font><font color="#E5E5E5"> is where the</font>

718
00:24:32,540 --> 00:24:36,200
alerts will come<font color="#CCCCCC"> into so an alert should</font>

719
00:24:34,820 --> 00:24:37,540
spawn in your sim<font color="#E5E5E5"> that should</font>

720
00:24:36,200 --> 00:24:40,340
automatically generate a case for

721
00:24:37,540 --> 00:24:42,500
investigation<font color="#E5E5E5"> so when that generates a</font>

722
00:24:40,340 --> 00:24:43,879
case in<font color="#E5E5E5"> your investigations tracker you</font>

723
00:24:42,500 --> 00:24:45,860
come with<font color="#E5E5E5"> something like this</font><font color="#CCCCCC"> right a</font>

724
00:24:43,880 --> 00:24:49,210
series of alerts the case that's been

725
00:24:45,860 --> 00:24:51,080
generated<font color="#CCCCCC"> and you'll notice the name is</font>

726
00:24:49,210 --> 00:24:52,430
correlated with something from<font color="#CCCCCC"> the use</font>

727
00:24:51,080 --> 00:24:55,090
case database that we<font color="#E5E5E5"> just saw are those</font>

728
00:24:52,430 --> 00:24:57,560
rules<font color="#CCCCCC"> that we saw in the previous slides</font>

729
00:24:55,090 --> 00:25:00,110
<font color="#CCCCCC">maybe I was doom in any bit here</font><font color="#E5E5E5"> yeah so</font>

730
00:24:57,560 --> 00:25:02,179
<font color="#CCCCCC">you can see alert generated</font><font color="#E5E5E5"> this isn't</font>

731
00:25:00,110 --> 00:25:03,350
my<font color="#E5E5E5"> investigation tracking database now I</font>

732
00:25:02,180 --> 00:25:06,260
can actually<font color="#E5E5E5"> go in and</font><font color="#CCCCCC"> I can action</font>

733
00:25:03,350 --> 00:25:08,149
<font color="#E5E5E5">these alerts and I can immediately see a</font>

734
00:25:06,260 --> 00:25:10,150
summary from that<font color="#E5E5E5"> use case database</font>

735
00:25:08,150 --> 00:25:12,080
entry this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> pretty small</font><font color="#E5E5E5"> maybe y'all</font>

736
00:25:10,150 --> 00:25:14,270
<font color="#E5E5E5">zoom it in a little more here that</font>

737
00:25:12,080 --> 00:25:15,379
<font color="#E5E5E5">easier</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so you can see</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> that</font>

738
00:25:14,270 --> 00:25:17,420
summary information<font color="#CCCCCC"> is right</font><font color="#E5E5E5"> there</font>

739
00:25:15,380 --> 00:25:19,100
<font color="#CCCCCC">available</font><font color="#E5E5E5"> that's what your need to</font>

740
00:25:17,420 --> 00:25:20,870
strive for<font color="#CCCCCC"> you need to strive for</font><font color="#E5E5E5"> having</font>

741
00:25:19,100 --> 00:25:22,909
<font color="#E5E5E5">this integrated with your sim so that as</font>

742
00:25:20,870 --> 00:25:25,399
<font color="#E5E5E5">soon as the alert fires</font><font color="#CCCCCC"> a case is</font>

743
00:25:22,910 --> 00:25:27,560
created the case references the

744
00:25:25,400 --> 00:25:28,910
information in the u.s. case database<font color="#E5E5E5"> so</font>

745
00:25:27,560 --> 00:25:31,550
<font color="#E5E5E5">that the analyst or investigator can</font>

746
00:25:28,910 --> 00:25:33,080
immediately read the description<font color="#E5E5E5"> and in</font>

747
00:25:31,550 --> 00:25:35,149
this particular<font color="#E5E5E5"> case the actual query</font>

748
00:25:33,080 --> 00:25:38,800
<font color="#E5E5E5">that's being used to trigger the alert</font>

749
00:25:35,150 --> 00:25:41,180
now this is a big<font color="#CCCCCC"> problem</font><font color="#E5E5E5"> with a lot</font><font color="#CCCCCC"> of</font>

750
00:25:38,800 --> 00:25:42,830
<font color="#CCCCCC">mm-maybe proprietary IDs is for example</font>

751
00:25:41,180 --> 00:25:44,240
<font color="#CCCCCC">they never want</font><font color="#E5E5E5"> to tell you why they</font>

752
00:25:42,830 --> 00:25:45,560
<font color="#E5E5E5">detected something and that makes</font><font color="#CCCCCC"> it</font>

753
00:25:44,240 --> 00:25:47,270
really difficult<font color="#E5E5E5"> to understand</font><font color="#CCCCCC"> how to</font>

754
00:25:45,560 --> 00:25:48,679
<font color="#E5E5E5">investigate it we</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have those</font>

755
00:25:47,270 --> 00:25:50,420
limitations<font color="#CCCCCC"> with a sim because there are</font>

756
00:25:48,680 --> 00:25:51,860
tools we own them<font color="#CCCCCC"> so it's</font><font color="#E5E5E5"> very valuable</font>

757
00:25:50,420 --> 00:25:53,480
<font color="#E5E5E5">to make sure that your analysts can</font>

758
00:25:51,860 --> 00:25:57,459
actually read the contents of<font color="#CCCCCC"> your rules</font>

759
00:25:53,480 --> 00:25:59,780
<font color="#E5E5E5">so they know how and</font><font color="#CCCCCC"> why it triggered</font>

760
00:25:57,460 --> 00:26:01,070
this is a rule that<font color="#E5E5E5"> detects</font><font color="#CCCCCC"> 1 to 2</font>

761
00:25:59,780 --> 00:26:04,100
character executables being downloaded

762
00:26:01,070 --> 00:26:05,810
<font color="#CCCCCC">not really</font><font color="#E5E5E5"> very high fidelity</font><font color="#CCCCCC"> probably</font>

763
00:26:04,100 --> 00:26:07,189
lots of false positives but it catches

764
00:26:05,810 --> 00:26:11,960
some malicious things every so often as

765
00:26:07,190 --> 00:26:12,860
<font color="#E5E5E5">well so as I mentioned before</font><font color="#CCCCCC"> you want</font>

766
00:26:11,960 --> 00:26:16,010
to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure you have that summary</font>

767
00:26:12,860 --> 00:26:17,719
available immediately<font color="#E5E5E5"> and once somebody</font>

768
00:26:16,010 --> 00:26:19,100
accesses<font color="#CCCCCC"> that they can read the</font><font color="#E5E5E5"> full</font>

769
00:26:17,720 --> 00:26:21,860
details right so here<font color="#E5E5E5"> you can see</font>

770
00:26:19,100 --> 00:26:23,780
there's more details<font color="#E5E5E5"> inside</font><font color="#CCCCCC"> for example</font>

771
00:26:21,860 --> 00:26:26,389
the confidence level severity any notes

772
00:26:23,780 --> 00:26:28,250
<font color="#E5E5E5">the specific distinguishers it's very</font>

773
00:26:26,390 --> 00:26:30,680
<font color="#E5E5E5">difficult to see I know I think I have a</font>

774
00:26:28,250 --> 00:26:32,360
<font color="#CCCCCC">blown-up version in a couple</font><font color="#E5E5E5"> slides but</font>

775
00:26:30,680 --> 00:26:35,240
here's another<font color="#E5E5E5"> one for</font><font color="#CCCCCC"> example dry</font>

776
00:26:32,360 --> 00:26:37,100
dextro<font color="#CCCCCC"> j'en tried X is a malware family</font>

777
00:26:35,240 --> 00:26:38,470
that has a specific<font color="#CCCCCC"> SSL certificate that</font>

778
00:26:37,100 --> 00:26:40,658
uses and there's a pattern

779
00:26:38,470 --> 00:26:42,100
that you can detect<font color="#CCCCCC"> may not be relevant</font>

780
00:26:40,659 --> 00:26:44,110
<font color="#E5E5E5">anymore these kinds of things change all</font>

781
00:26:42,100 --> 00:26:45,879
<font color="#E5E5E5">the time but the idea</font><font color="#CCCCCC"> here is</font><font color="#E5E5E5"> again you</font>

782
00:26:44,110 --> 00:26:48,340
<font color="#E5E5E5">have this information</font><font color="#CCCCCC"> easily accessible</font>

783
00:26:45,880 --> 00:26:52,000
<font color="#E5E5E5">and when clicking on the alert because</font>

784
00:26:48,340 --> 00:26:53,439
<font color="#CCCCCC">these</font><font color="#E5E5E5"> are tied together right</font><font color="#CCCCCC"> you get</font>

785
00:26:52,000 --> 00:26:55,570
that same<font color="#CCCCCC"> information automatically</font>

786
00:26:53,440 --> 00:26:57,730
populated<font color="#E5E5E5"> in the alert details from the</font>

787
00:26:55,570 --> 00:26:59,230
use case database and you<font color="#E5E5E5"> can see here</font>

788
00:26:57,730 --> 00:27:01,659
that<font color="#E5E5E5"> the threat intelligence database is</font>

789
00:26:59,230 --> 00:27:03,669
also<font color="#E5E5E5"> correlated as well here's a link to</font>

790
00:27:01,659 --> 00:27:09,880
<font color="#E5E5E5">whatever threat intelligence is related</font>

791
00:27:03,669 --> 00:27:11,230
to<font color="#CCCCCC"> this specific</font><font color="#E5E5E5"> alert I'll show this</font>

792
00:27:09,880 --> 00:27:12,570
<font color="#E5E5E5">for</font><font color="#CCCCCC"> a second okay</font><font color="#E5E5E5"> now the threat</font>

793
00:27:11,230 --> 00:27:14,590
intelligence<font color="#CCCCCC"> database as I mentioned</font>

794
00:27:12,570 --> 00:27:16,389
ideally you want to<font color="#E5E5E5"> have that integrated</font>

795
00:27:14,590 --> 00:27:17,830
so<font color="#CCCCCC"> that you can see how all</font><font color="#E5E5E5"> these</font>

796
00:27:16,390 --> 00:27:19,870
components<font color="#CCCCCC"> are all in one we haven't</font>

797
00:27:17,830 --> 00:27:21,549
<font color="#CCCCCC">gone anywhere else</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the goal that</font>

798
00:27:19,870 --> 00:27:25,120
<font color="#E5E5E5">you need to strive for</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> always doable</font>

799
00:27:21,549 --> 00:27:26,889
<font color="#E5E5E5">but that's what you want so let's see</font>

800
00:27:25,120 --> 00:27:30,280
how this looks<font color="#CCCCCC"> if I click on</font><font color="#E5E5E5"> this use</font>

801
00:27:26,890 --> 00:27:32,260
case alert<font color="#E5E5E5"> the alert brings me to my</font>

802
00:27:30,280 --> 00:27:33,639
description<font color="#CCCCCC"> the</font><font color="#E5E5E5"> description has a link</font>

803
00:27:32,260 --> 00:27:34,990
<font color="#E5E5E5">to my threat intelligence the threat</font>

804
00:27:33,640 --> 00:27:37,270
intelligence that<font color="#E5E5E5"> allows me to read</font>

805
00:27:34,990 --> 00:27:40,030
about<font color="#CCCCCC"> this specific threat</font><font color="#E5E5E5"> and say</font><font color="#CCCCCC"> ok</font>

806
00:27:37,270 --> 00:27:41,740
what<font color="#E5E5E5"> is this</font><font color="#CCCCCC"> what are the kind of things</font>

807
00:27:40,030 --> 00:27:43,178
I should<font color="#E5E5E5"> be looking for are there any</font>

808
00:27:41,740 --> 00:27:44,590
other<font color="#E5E5E5"> relevant materials on this threat</font>

809
00:27:43,179 --> 00:27:48,340
intelligence portal<font color="#E5E5E5"> that you know I</font>

810
00:27:44,590 --> 00:27:51,299
might be<font color="#E5E5E5"> interested in the last piece as</font>

811
00:27:48,340 --> 00:27:55,090
I mentioned before<font color="#E5E5E5"> are the alert tasks</font>

812
00:27:51,299 --> 00:27:56,710
the alert tasks are what you need to do

813
00:27:55,090 --> 00:27:58,090
when<font color="#E5E5E5"> alert fires now in this particular</font>

814
00:27:56,710 --> 00:27:59,350
<font color="#E5E5E5">tool I've been showing you which I</font>

815
00:27:58,090 --> 00:28:01,030
haven't<font color="#E5E5E5"> even mentioned what it is it</font>

816
00:27:59,350 --> 00:28:02,830
<font color="#CCCCCC">doesn't matter in</font><font color="#E5E5E5"> this tool they call it</font>

817
00:28:01,030 --> 00:28:04,330
guided investigation the point is you

818
00:28:02,830 --> 00:28:05,980
need<font color="#E5E5E5"> to have</font><font color="#CCCCCC"> a definition of</font><font color="#E5E5E5"> specific</font>

819
00:28:04,330 --> 00:28:08,889
<font color="#CCCCCC">things someone should do when an alert</font>

820
00:28:05,980 --> 00:28:11,710
fires<font color="#E5E5E5"> here is an</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> of what this</font>

821
00:28:08,890 --> 00:28:13,720
specific rule is customized for<font color="#E5E5E5"> right</font>

822
00:28:11,710 --> 00:28:15,610
this<font color="#E5E5E5"> rule says these are the things you</font>

823
00:28:13,720 --> 00:28:17,350
should<font color="#E5E5E5"> check when this alert fires the</font>

824
00:28:15,610 --> 00:28:19,750
analyst<font color="#E5E5E5"> goes in evaluates these things</font>

825
00:28:17,350 --> 00:28:21,699
and<font color="#E5E5E5"> that makes their determination</font><font color="#CCCCCC"> do I</font>

826
00:28:19,750 --> 00:28:27,580
escalate this<font color="#E5E5E5"> or do</font><font color="#CCCCCC"> I suppress this do</font><font color="#E5E5E5"> I</font>

827
00:28:21,700 --> 00:28:29,169
close this<font color="#CCCCCC"> now we're gonna</font><font color="#E5E5E5"> get into the</font>

828
00:28:27,580 --> 00:28:32,740
actual sim rules as I mentioned there

829
00:28:29,169 --> 00:28:35,470
are 22 rules we're gonna discuss these

830
00:28:32,740 --> 00:28:37,059
are mostly<font color="#CCCCCC"> high-fidelity some of them</font>

831
00:28:35,470 --> 00:28:38,350
<font color="#E5E5E5">I'll talk</font><font color="#CCCCCC"> about maybe have a</font><font color="#E5E5E5"> little</font><font color="#CCCCCC"> bit</font>

832
00:28:37,059 --> 00:28:40,059
of<font color="#E5E5E5"> a lower</font><font color="#CCCCCC"> level</font><font color="#E5E5E5"> of confidence but it'll</font>

833
00:28:38,350 --> 00:28:42,070
explain why I<font color="#E5E5E5"> included them and we'll</font>

834
00:28:40,059 --> 00:28:44,168
have<font color="#CCCCCC"> pseudocode</font><font color="#E5E5E5"> as well I've made a bit</font>

835
00:28:42,070 --> 00:28:46,000
of<font color="#E5E5E5"> my</font><font color="#CCCCCC"> own syntax</font><font color="#E5E5E5"> highlighting and again</font>

836
00:28:44,169 --> 00:28:47,289
the pseudocode is just something that I

837
00:28:46,000 --> 00:28:49,179
<font color="#CCCCCC">came up with</font><font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be something</font>

838
00:28:47,289 --> 00:28:51,160
<font color="#E5E5E5">you can implement immediately</font><font color="#CCCCCC"> but should</font>

839
00:28:49,179 --> 00:28:53,440
be<font color="#E5E5E5"> fairly easy to understand for most</font>

840
00:28:51,160 --> 00:28:57,040
folks who have a bit<font color="#E5E5E5"> of background with</font>

841
00:28:53,440 --> 00:28:59,140
computers or boolean logic<font color="#E5E5E5"> so the first</font>

842
00:28:57,040 --> 00:29:00,580
we're gonna<font color="#E5E5E5"> start</font><font color="#CCCCCC"> off with very</font>

843
00:28:59,140 --> 00:29:01,900
<font color="#E5E5E5">straightforward</font><font color="#CCCCCC"> and some of these</font>

844
00:29:00,580 --> 00:29:04,480
actually<font color="#CCCCCC"> might seem like they're really</font>

845
00:29:01,900 --> 00:29:05,680
obvious to<font color="#CCCCCC"> you there are some</font><font color="#E5E5E5"> people who</font>

846
00:29:04,480 --> 00:29:06,850
haven't<font color="#E5E5E5"> heard of these</font><font color="#CCCCCC"> before but</font><font color="#E5E5E5"> this</font>

847
00:29:05,680 --> 00:29:09,760
one is<font color="#E5E5E5"> very</font><font color="#CCCCCC"> straightforward this is</font>

848
00:29:06,850 --> 00:29:12,129
<font color="#E5E5E5">successful remote authentication via</font><font color="#CCCCCC"> a</font>

849
00:29:09,760 --> 00:29:14,650
<font color="#E5E5E5">tor exit node now a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> people say</font>

850
00:29:12,130 --> 00:29:17,230
why do I<font color="#CCCCCC"> care about</font><font color="#E5E5E5"> tor well they're</font>

851
00:29:14,650 --> 00:29:18,640
<font color="#E5E5E5">thinking about probes from</font><font color="#CCCCCC"> Tour Pros</font>

852
00:29:17,230 --> 00:29:20,080
<font color="#E5E5E5">from</font><font color="#CCCCCC"> tor</font><font color="#E5E5E5"> I agree if someone's just</font>

853
00:29:18,640 --> 00:29:22,000
<font color="#E5E5E5">scanning me from a</font><font color="#CCCCCC"> tour as a node I</font>

854
00:29:20,080 --> 00:29:23,980
probably don't<font color="#E5E5E5"> care</font><font color="#CCCCCC"> that much</font><font color="#E5E5E5"> I be a</font>

855
00:29:22,000 --> 00:29:25,630
little interested but<font color="#E5E5E5"> I'm really</font>

856
00:29:23,980 --> 00:29:28,480
<font color="#E5E5E5">interested if someone who successfully</font>

857
00:29:25,630 --> 00:29:30,790
logs in<font color="#CCCCCC"> from a tor exit node so you can</font>

858
00:29:28,480 --> 00:29:32,470
see the pseudocode here<font color="#E5E5E5"> my event source</font>

859
00:29:30,790 --> 00:29:35,110
is specified in this particular case as

860
00:29:32,470 --> 00:29:37,450
VPN or<font color="#CCCCCC"> citrix</font><font color="#E5E5E5"> right so my remote access</font>

861
00:29:35,110 --> 00:29:41,229
<font color="#E5E5E5">utilities if there's an authentication</font>

862
00:29:37,450 --> 00:29:44,260
success event<font color="#E5E5E5"> and the IP address is in a</font>

863
00:29:41,230 --> 00:29:46,120
list<font color="#E5E5E5"> that I'm pulling</font><font color="#CCCCCC"> on the our for tor</font>

864
00:29:44,260 --> 00:29:47,710
<font color="#E5E5E5">exit nodes then I want to alert and</font>

865
00:29:46,120 --> 00:29:49,030
you'll see the dependency<font color="#CCCCCC"> here is of</font>

866
00:29:47,710 --> 00:29:51,160
course<font color="#CCCCCC"> we need some kind of tool</font><font color="#E5E5E5"> or</font>

867
00:29:49,030 --> 00:29:52,990
ability<font color="#CCCCCC"> to actually pull</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Tor</font><font color="#E5E5E5"> exit</font>

868
00:29:51,160 --> 00:29:55,270
node list which is public<font color="#E5E5E5"> here I</font>

869
00:29:52,990 --> 00:29:56,650
recommend<font color="#E5E5E5"> hourly and I've put a little</font>

870
00:29:55,270 --> 00:30:01,360
<font color="#E5E5E5">bit</font><font color="#CCCCCC"> of a legend here all of the field</font>

871
00:29:56,650 --> 00:30:02,530
<font color="#E5E5E5">names will</font><font color="#CCCCCC"> be in blue</font><font color="#E5E5E5"> values in red if</font>

872
00:30:01,360 --> 00:30:05,709
there's a function or some kind of

873
00:30:02,530 --> 00:30:07,090
operation<font color="#E5E5E5"> that's gonna be in green and</font>

874
00:30:05,710 --> 00:30:09,460
<font color="#E5E5E5">if there's a list that we're referencing</font>

875
00:30:07,090 --> 00:30:13,870
<font color="#E5E5E5">so kind of reference list I mentioned</font>

876
00:30:09,460 --> 00:30:14,710
before those will be<font color="#E5E5E5"> in yellow now the</font>

877
00:30:13,870 --> 00:30:17,110
second one<font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font>

878
00:30:14,710 --> 00:30:19,810
<font color="#E5E5E5">again this might be something you think</font>

879
00:30:17,110 --> 00:30:21,610
is a<font color="#E5E5E5"> no-brainer very straightforward</font><font color="#CCCCCC"> but</font>

880
00:30:19,810 --> 00:30:23,889
some folks<font color="#E5E5E5"> don't really pay attention to</font>

881
00:30:21,610 --> 00:30:25,810
antivirus alerts because the antivirus

882
00:30:23,890 --> 00:30:28,450
is meant to automatically detect and

883
00:30:25,810 --> 00:30:29,950
clean things right<font color="#E5E5E5"> and that's its</font><font color="#CCCCCC"> job</font>

884
00:30:28,450 --> 00:30:31,630
and<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> what it does and folks don't</font>

885
00:30:29,950 --> 00:30:33,400
really read or look at the antivirus

886
00:30:31,630 --> 00:30:35,110
alerts<font color="#E5E5E5"> and that totally makes sense</font>

887
00:30:33,400 --> 00:30:36,400
however they I think<font color="#CCCCCC"> there</font><font color="#E5E5E5"> are some</font>

888
00:30:35,110 --> 00:30:38,979
<font color="#E5E5E5">situations where you probably do care</font>

889
00:30:36,400 --> 00:30:41,080
<font color="#CCCCCC">for example if there's malware detected</font>

890
00:30:38,980 --> 00:30:43,450
on a<font color="#CCCCCC"> critical server</font><font color="#E5E5E5"> like your domain</font>

891
00:30:41,080 --> 00:30:45,159
controller<font color="#E5E5E5"> if there is ever a malware</font>

892
00:30:43,450 --> 00:30:46,990
detected<font color="#E5E5E5"> your domain controller even if</font>

893
00:30:45,160 --> 00:30:48,460
it's adware<font color="#E5E5E5"> it's still worth</font>

894
00:30:46,990 --> 00:30:50,410
investigating how did that<font color="#E5E5E5"> end up on</font>

895
00:30:48,460 --> 00:30:52,990
<font color="#CCCCCC">your domain controller</font><font color="#E5E5E5"> there's zero</font>

896
00:30:50,410 --> 00:30:55,810
reason<font color="#E5E5E5"> for you to not investigate</font>

897
00:30:52,990 --> 00:30:57,940
<font color="#E5E5E5">regardless of what it is</font><font color="#CCCCCC"> here you also</font>

898
00:30:55,810 --> 00:30:59,560
notice I've actually excluded something

899
00:30:57,940 --> 00:31:01,450
from a specific<font color="#E5E5E5"> list of servers the</font>

900
00:30:59,560 --> 00:31:04,540
<font color="#E5E5E5">Citrix XenApp servers right because</font>

901
00:31:01,450 --> 00:31:04,870
users have profiles on those and they

902
00:31:04,540 --> 00:31:06,340
might<font color="#E5E5E5"> be</font>

903
00:31:04,870 --> 00:31:07,719
<font color="#CCCCCC">browsing using</font><font color="#E5E5E5"> Citrix XenApp if you're</font>

904
00:31:06,340 --> 00:31:09,429
familiar with that<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of gives them</font>

905
00:31:07,720 --> 00:31:12,430
like a remote access portal<font color="#E5E5E5"> and they can</font>

906
00:31:09,430 --> 00:31:14,350
use virtualized<font color="#CCCCCC"> I guess not virtualized</font>

907
00:31:12,430 --> 00:31:16,720
but segregated applications on the

908
00:31:14,350 --> 00:31:18,219
Citrix<font color="#CCCCCC"> server</font><font color="#E5E5E5"> so of course that</font><font color="#CCCCCC"> might</font><font color="#E5E5E5"> be</font>

909
00:31:16,720 --> 00:31:19,390
a server you're not really caring about

910
00:31:18,220 --> 00:31:20,680
<font color="#E5E5E5">malware being</font><font color="#CCCCCC"> detected from</font><font color="#E5E5E5"> the</font>

911
00:31:19,390 --> 00:31:22,000
application data folder because<font color="#E5E5E5"> that's</font>

912
00:31:20,680 --> 00:31:24,370
<font color="#E5E5E5">very common you'll probably get a lot of</font>

913
00:31:22,000 --> 00:31:26,260
adware false positives<font color="#E5E5E5"> as users are</font>

914
00:31:24,370 --> 00:31:31,030
<font color="#CCCCCC">browsing or maybe some</font><font color="#E5E5E5"> JavaScript files</font>

915
00:31:26,260 --> 00:31:32,830
are detected the next one we're going to

916
00:31:31,030 --> 00:31:35,530
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> is common credential theft</font>

917
00:31:32,830 --> 00:31:37,809
file names<font color="#E5E5E5"> this is super</font><font color="#CCCCCC"> easy for</font><font color="#E5E5E5"> an</font>

918
00:31:35,530 --> 00:31:39,639
<font color="#CCCCCC">attacker to avoid all thing to do is</font>

919
00:31:37,809 --> 00:31:41,678
rename<font color="#E5E5E5"> their malware or the credential</font>

920
00:31:39,640 --> 00:31:43,090
theft utility to something else<font color="#E5E5E5"> but the</font>

921
00:31:41,679 --> 00:31:45,550
reality of<font color="#E5E5E5"> the situation is in that</font>

922
00:31:43,090 --> 00:31:47,590
probably<font color="#CCCCCC"> about 30 to 40 percent</font><font color="#E5E5E5"> of the</font>

923
00:31:45,550 --> 00:31:49,240
<font color="#CCCCCC">cases I've worked on we see the</font>

924
00:31:47,590 --> 00:31:52,090
credential theft<font color="#CCCCCC"> Malheur</font><font color="#E5E5E5"> simply renamed</font>

925
00:31:49,240 --> 00:31:54,820
one of these file<font color="#CCCCCC"> names I mean that's my</font>

926
00:31:52,090 --> 00:31:57,220
personal experience<font color="#E5E5E5"> may not</font><font color="#CCCCCC"> be yours but</font>

927
00:31:54,820 --> 00:31:58,389
the situation of or the the fact of<font color="#E5E5E5"> the</font>

928
00:31:57,220 --> 00:31:59,710
matter<font color="#E5E5E5"> is that the attackers are kind of</font>

929
00:31:58,390 --> 00:32:00,820
lazy<font color="#CCCCCC"> and so if this</font><font color="#E5E5E5"> is the tool name</font>

930
00:31:59,710 --> 00:32:02,590
they're probably gonna<font color="#CCCCCC"> just</font><font color="#E5E5E5"> drop it like</font>

931
00:32:00,820 --> 00:32:05,820
that<font color="#E5E5E5"> so the ability to</font><font color="#CCCCCC"> actually look for</font>

932
00:32:02,590 --> 00:32:09,428
<font color="#E5E5E5">that this</font><font color="#CCCCCC"> is a fairly comprehensive list</font>

933
00:32:05,820 --> 00:32:11,379
<font color="#E5E5E5">of course is gonna</font><font color="#CCCCCC"> be very</font><font color="#E5E5E5"> useful</font><font color="#CCCCCC"> like I</font>

934
00:32:09,429 --> 00:32:12,910
<font color="#E5E5E5">said though attacker all they have to do</font>

935
00:32:11,380 --> 00:32:14,230
is rename<font color="#E5E5E5"> their tool it's not gonna be</font>

936
00:32:12,910 --> 00:32:15,700
triggered on or not<font color="#E5E5E5"> detected and</font>

937
00:32:14,230 --> 00:32:18,250
actually there's something<font color="#E5E5E5"> we're gonna</font>

938
00:32:15,700 --> 00:32:19,120
detect<font color="#E5E5E5"> for that later on as well now</font>

939
00:32:18,250 --> 00:32:22,600
this<font color="#E5E5E5"> one's a little bit</font><font color="#CCCCCC"> more of a</font>

940
00:32:19,120 --> 00:32:25,540
<font color="#CCCCCC">behavioral rule rule</font><font color="#E5E5E5"> number four this</font><font color="#CCCCCC"> is</font>

941
00:32:22,600 --> 00:32:27,610
<font color="#CCCCCC">a webserver acting a little unusually</font>

942
00:32:25,540 --> 00:32:28,690
and what I mean<font color="#E5E5E5"> by that and maybe I</font>

943
00:32:27,610 --> 00:32:31,600
could<font color="#E5E5E5"> have named this a little better</font><font color="#CCCCCC"> is</font>

944
00:32:28,690 --> 00:32:34,330
<font color="#E5E5E5">that the actual web server process so if</font>

945
00:32:31,600 --> 00:32:35,709
you're using iis web server application

946
00:32:34,330 --> 00:32:38,530
which is a web server application for

947
00:32:35,710 --> 00:32:42,100
<font color="#CCCCCC">Windows the webserver process is</font>

948
00:32:38,530 --> 00:32:44,950
typically<font color="#E5E5E5"> either w3w</font><font color="#CCCCCC"> PXE that program</font>

949
00:32:42,100 --> 00:32:47,530
<font color="#E5E5E5">that</font><font color="#CCCCCC"> is the</font><font color="#E5E5E5"> iis web server application</font>

950
00:32:44,950 --> 00:32:49,929
and on older<font color="#E5E5E5"> versions</font><font color="#CCCCCC"> I think prior to</font>

951
00:32:47,530 --> 00:32:53,020
iOS version<font color="#CCCCCC"> six which hopefully nobody's</font>

952
00:32:49,929 --> 00:32:57,280
<font color="#E5E5E5">still running right okay you might also</font>

953
00:32:53,020 --> 00:32:59,320
<font color="#E5E5E5">see this as the application name asp net</font>

954
00:32:57,280 --> 00:32:59,889
<font color="#E5E5E5">underscore WP so those two executables</font>

955
00:32:59,320 --> 00:33:03,178
<font color="#E5E5E5">are not an hour</font>

956
00:32:59,890 --> 00:33:06,730
those are your IAS servers but if those

957
00:33:03,179 --> 00:33:10,840
processes are<font color="#CCCCCC"> the parent or they spawn</font>

958
00:33:06,730 --> 00:33:13,030
another process it's<font color="#CCCCCC"> not maybe</font><font color="#E5E5E5"> that</font>

959
00:33:10,840 --> 00:33:14,260
<font color="#E5E5E5">common or that usual unless there's</font>

960
00:33:13,030 --> 00:33:16,210
evidence<font color="#E5E5E5"> of</font><font color="#CCCCCC"> attacker activity for</font>

961
00:33:14,260 --> 00:33:18,100
<font color="#CCCCCC">example if an attacker</font><font color="#E5E5E5"> has found a</font>

962
00:33:16,210 --> 00:33:20,650
vulnerability<font color="#E5E5E5"> in your</font><font color="#CCCCCC"> website they may</font>

963
00:33:18,100 --> 00:33:22,840
leveraging a web shell that they've

964
00:33:20,650 --> 00:33:24,370
uploaded into<font color="#E5E5E5"> your website</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> on your</font>

965
00:33:22,840 --> 00:33:25,840
web server<font color="#CCCCCC"> to perform some other</font>

966
00:33:24,370 --> 00:33:30,850
<font color="#E5E5E5">operations and those operations might</font>

967
00:33:25,840 --> 00:33:33,070
include some of<font color="#E5E5E5"> these commands so very</font>

968
00:33:30,850 --> 00:33:34,570
straightforward<font color="#E5E5E5"> one to look for again</font>

969
00:33:33,070 --> 00:33:36,070
<font color="#CCCCCC">you</font><font color="#E5E5E5"> might have to check to</font><font color="#CCCCCC"> see if</font><font color="#E5E5E5"> this</font>

970
00:33:34,570 --> 00:33:37,210
<font color="#CCCCCC">is actually happening</font><font color="#E5E5E5"> your web server</font>

971
00:33:36,070 --> 00:33:38,710
may have custom code that your

972
00:33:37,210 --> 00:33:41,200
developers have<font color="#CCCCCC"> made and they may be</font>

973
00:33:38,710 --> 00:33:43,090
<font color="#E5E5E5">running these some</font><font color="#CCCCCC"> of these commands</font><font color="#E5E5E5"> as</font>

974
00:33:41,200 --> 00:33:45,040
part of<font color="#E5E5E5"> the web server application so</font>

975
00:33:43,090 --> 00:33:46,000
validate that check<font color="#E5E5E5"> that with all of</font>

976
00:33:45,040 --> 00:33:47,740
these<font color="#E5E5E5"> rules again as I mentioned</font>

977
00:33:46,000 --> 00:33:48,790
<font color="#E5E5E5">everyone's environments different</font><font color="#CCCCCC"> you</font>

978
00:33:47,740 --> 00:33:50,050
need<font color="#E5E5E5"> to take these with a grain of salt</font>

979
00:33:48,790 --> 00:33:51,370
you're not gonna be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> copy/paste</font>

980
00:33:50,050 --> 00:33:52,960
<font color="#E5E5E5">these directly into your</font><font color="#CCCCCC"> environment</font>

981
00:33:51,370 --> 00:33:54,610
<font color="#E5E5E5">there's probably gonna be something</font><font color="#CCCCCC"> that</font>

982
00:33:52,960 --> 00:33:58,530
happens<font color="#E5E5E5"> and that's unique</font><font color="#CCCCCC"> for you that</font>

983
00:33:54,610 --> 00:34:01,300
other people don't see now this<font color="#E5E5E5"> next one</font>

984
00:33:58,530 --> 00:34:04,540
<font color="#CCCCCC">is</font><font color="#E5E5E5"> the suspicious service</font><font color="#CCCCCC"> installation</font>

985
00:34:01,300 --> 00:34:06,760
<font color="#E5E5E5">and I'm gonna actually show you an event</font>

986
00:34:04,540 --> 00:34:08,800
<font color="#CCCCCC">a service installation event right after</font>

987
00:34:06,760 --> 00:34:10,900
this<font color="#E5E5E5"> so you can see why I picked some of</font>

988
00:34:08,800 --> 00:34:12,580
these<font color="#E5E5E5"> keywords but the idea here</font><font color="#CCCCCC"> is</font>

989
00:34:10,900 --> 00:34:16,420
<font color="#E5E5E5">you're looking for service installation</font>

990
00:34:12,580 --> 00:34:19,299
events which is the<font color="#E5E5E5"> 70</font><font color="#CCCCCC"> 45 a</font><font color="#E5E5E5"> ID</font><font color="#CCCCCC"> right so</font>

991
00:34:16,420 --> 00:34:21,340
in the Windows Event<font color="#E5E5E5"> log 70 45 and</font>

992
00:34:19,300 --> 00:34:23,770
you'll notice here<font color="#E5E5E5"> I've put service name</font>

993
00:34:21,340 --> 00:34:24,850
matches<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this weird expression right</font>

994
00:34:23,770 --> 00:34:26,770
if you're not<font color="#CCCCCC"> familiar with that</font><font color="#E5E5E5"> that's</font>

995
00:34:24,850 --> 00:34:30,460
called reg regular expressions or reg X

996
00:34:26,770 --> 00:34:32,710
and<font color="#E5E5E5"> that</font><font color="#CCCCCC"> expression</font><font color="#E5E5E5"> or that series of</font>

997
00:34:30,460 --> 00:34:35,830
symbols<font color="#E5E5E5"> essentially represents a 16</font>

998
00:34:32,710 --> 00:34:38,260
character string that<font color="#CCCCCC"> is composed</font>

999
00:34:35,830 --> 00:34:41,529
entirely of<font color="#E5E5E5"> eh-2-zed characters of</font>

1000
00:34:38,260 --> 00:34:43,210
either case<font color="#E5E5E5"> no spaces no special</font>

1001
00:34:41,530 --> 00:34:45,400
<font color="#E5E5E5">characters no numbers okay I'll explain</font>

1002
00:34:43,210 --> 00:34:47,590
why that<font color="#E5E5E5"> is that in a second and then of</font>

1003
00:34:45,400 --> 00:34:49,450
<font color="#CCCCCC">course</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> we're looking</font><font color="#E5E5E5"> for whether it</font>

1004
00:34:47,590 --> 00:34:52,240
contains<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of these key words like</font>

1005
00:34:49,449 --> 00:34:55,449
<font color="#E5E5E5">powershell CMD basic c for IX and comm</font>

1006
00:34:52,239 --> 00:34:57,700
spec<font color="#E5E5E5"> and the reason is because the</font>

1007
00:34:55,449 --> 00:34:59,560
default<font color="#E5E5E5"> service installation</font><font color="#CCCCCC"> done in</font><font color="#E5E5E5"> by</font>

1008
00:34:57,700 --> 00:35:01,990
<font color="#CCCCCC">Metasploit</font><font color="#E5E5E5"> looks like this</font>

1009
00:34:59,560 --> 00:35:03,759
so you<font color="#E5E5E5"> can see that the name or service</font>

1010
00:35:01,990 --> 00:35:05,259
name<font color="#E5E5E5"> that</font><font color="#CCCCCC"> Metasploit will use in a</font>

1011
00:35:03,760 --> 00:35:06,970
<font color="#E5E5E5">default installation and</font><font color="#CCCCCC"> i don't</font><font color="#E5E5E5"> think</font>

1012
00:35:05,260 --> 00:35:11,740
most people<font color="#E5E5E5"> are changing this is a</font>

1013
00:35:06,970 --> 00:35:13,540
randomized 16 character string<font color="#CCCCCC"> I don't</font>

1014
00:35:11,740 --> 00:35:15,100
believe<font color="#E5E5E5"> I've seen one that has numbers</font>

1015
00:35:13,540 --> 00:35:16,750
or spaces which is why I wrote the

1016
00:35:15,100 --> 00:35:18,819
expression<font color="#CCCCCC"> to look for upper or</font>

1017
00:35:16,750 --> 00:35:22,870
lowercase characters it's always<font color="#E5E5E5"> exactly</font>

1018
00:35:18,820 --> 00:35:24,670
16 characters<font color="#CCCCCC"> long straightforward very</font>

1019
00:35:22,870 --> 00:35:25,810
<font color="#E5E5E5">low hanging fruit if you can't detect it</font>

1020
00:35:24,670 --> 00:35:27,610
or you're<font color="#E5E5E5"> not looking for</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> should</font>

1021
00:35:25,810 --> 00:35:28,720
<font color="#CCCCCC">be</font><font color="#E5E5E5"> able to and then you'll notice some</font>

1022
00:35:27,610 --> 00:35:30,540
of these other<font color="#E5E5E5"> keywords</font><font color="#CCCCCC"> that I also</font>

1023
00:35:28,720 --> 00:35:34,950
highlighted<font color="#E5E5E5"> those are the</font>

1024
00:35:30,540 --> 00:35:36,570
specific strings that I looked for in

1025
00:35:34,950 --> 00:35:38,040
<font color="#E5E5E5">this rule because of course if a service</font>

1026
00:35:36,570 --> 00:35:39,540
is<font color="#CCCCCC"> installed on my system but that</font>

1027
00:35:38,040 --> 00:35:41,490
service is responsible<font color="#CCCCCC"> for simply</font>

1028
00:35:39,540 --> 00:35:42,650
running<font color="#E5E5E5"> PowerShell that doesn't sound</font>

1029
00:35:41,490 --> 00:35:46,259
like<font color="#E5E5E5"> a service that I've probably</font>

1030
00:35:42,650 --> 00:35:48,450
installed on purpose same with command

1031
00:35:46,260 --> 00:35:56,670
prompt cmd.exe<font color="#CCCCCC"> if you're not familiar</font>

1032
00:35:48,450 --> 00:35:59,390
with this<font color="#E5E5E5"> I X I X ie X is how power cell</font>

1033
00:35:56,670 --> 00:36:02,880
can be used to execute specific things

1034
00:35:59,390 --> 00:36:04,799
<font color="#E5E5E5">invoke execution</font><font color="#CCCCCC"> I believe</font><font color="#E5E5E5"> so that's</font>

1035
00:36:02,880 --> 00:36:05,340
used to<font color="#E5E5E5"> execute things I've added that</font>

1036
00:36:04,800 --> 00:36:06,930
<font color="#E5E5E5">in as well</font>

1037
00:36:05,340 --> 00:36:07,950
because if a service again is being

1038
00:36:06,930 --> 00:36:09,660
<font color="#E5E5E5">installed in</font><font color="#CCCCCC"> your system and it's</font>

1039
00:36:07,950 --> 00:36:10,919
executing something<font color="#E5E5E5"> using PowerShell it</font>

1040
00:36:09,660 --> 00:36:12,210
doesn't<font color="#E5E5E5"> really sound like an actual</font>

1041
00:36:10,920 --> 00:36:15,000
<font color="#E5E5E5">system service that you would know</font><font color="#CCCCCC"> ly be</font>

1042
00:36:12,210 --> 00:36:17,820
installing next we're<font color="#E5E5E5"> gonna talk about</font>

1043
00:36:15,000 --> 00:36:21,600
<font color="#E5E5E5">is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> download function from</font><font color="#CCCCCC"> PowerShell</font>

1044
00:36:17,820 --> 00:36:25,110
<font color="#E5E5E5">PowerShell has I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> 10 15 maybe more</font>

1045
00:36:21,600 --> 00:36:27,089
ways<font color="#CCCCCC"> to download things from the</font>

1046
00:36:25,110 --> 00:36:30,450
<font color="#E5E5E5">internet</font><font color="#CCCCCC"> and at the bottom you'll notice</font>

1047
00:36:27,090 --> 00:36:32,550
<font color="#E5E5E5">I put actually this name and</font><font color="#CCCCCC"> this talk</font>

1048
00:36:30,450 --> 00:36:34,379
<font color="#CCCCCC">that I saw der beek on Daniel</font><font color="#E5E5E5"> Bohannon</font>

1049
00:36:32,550 --> 00:36:35,790
actually another<font color="#CCCCCC"> Mandy consultant</font><font color="#E5E5E5"> he can</font>

1050
00:36:34,380 --> 00:36:37,590
explain<font color="#E5E5E5"> to you why this rule is not</font>

1051
00:36:35,790 --> 00:36:39,990
<font color="#E5E5E5">gonna be the</font><font color="#CCCCCC"> greatest because</font><font color="#E5E5E5"> he's</font>

1052
00:36:37,590 --> 00:36:41,790
created this<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that is called invoke</font>

1053
00:36:39,990 --> 00:36:44,430
cradle crafter and<font color="#E5E5E5"> he's basically made a</font>

1054
00:36:41,790 --> 00:36:45,630
way to obvious<font color="#E5E5E5"> gate</font><font color="#CCCCCC"> PowerShell in a way</font>

1055
00:36:44,430 --> 00:36:47,730
that it's<font color="#E5E5E5"> almost impossible to</font><font color="#CCCCCC"> detect</font>

1056
00:36:45,630 --> 00:36:49,260
<font color="#CCCCCC">but this will catch</font><font color="#E5E5E5"> low-hanging fruit</font>

1057
00:36:47,730 --> 00:36:50,340
<font color="#CCCCCC">PowerShell scripts</font><font color="#E5E5E5"> running in your</font>

1058
00:36:49,260 --> 00:36:53,580
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> that are downloading files</font>

1059
00:36:50,340 --> 00:36:55,170
should<font color="#CCCCCC"> be very rare with the exception</font>

1060
00:36:53,580 --> 00:36:57,210
of specific scripts<font color="#CCCCCC"> that are being</font>

1061
00:36:55,170 --> 00:36:58,470
around by your<font color="#CCCCCC"> sis admin's and that's</font>

1062
00:36:57,210 --> 00:37:01,440
something<font color="#CCCCCC"> that you can easily observe</font>

1063
00:36:58,470 --> 00:37:04,290
<font color="#E5E5E5">identifying a whitelist but otherwise</font>

1064
00:37:01,440 --> 00:37:06,750
<font color="#CCCCCC">pretty</font><font color="#E5E5E5"> much all of those functions start</font>

1065
00:37:04,290 --> 00:37:08,100
with the<font color="#E5E5E5"> keywords dot download or open</font>

1066
00:37:06,750 --> 00:37:09,960
read and you'll notice here<font color="#E5E5E5"> I've</font>

1067
00:37:08,100 --> 00:37:11,430
actually<font color="#E5E5E5"> have a green function I</font>

1068
00:37:09,960 --> 00:37:13,910
mentioned these<font color="#E5E5E5"> functions earlier this</font>

1069
00:37:11,430 --> 00:37:16,109
<font color="#E5E5E5">function is meant to split or strip</font>

1070
00:37:13,910 --> 00:37:18,810
special characters because when

1071
00:37:16,110 --> 00:37:21,180
attackers try to obfuscate<font color="#E5E5E5"> their</font>

1072
00:37:18,810 --> 00:37:23,850
commands<font color="#CCCCCC"> they'll put in things like tick</font>

1073
00:37:21,180 --> 00:37:26,940
marks or quotation marks<font color="#E5E5E5"> and funnily</font>

1074
00:37:23,850 --> 00:37:29,790
enough<font color="#E5E5E5"> PowerShell will actually allow</font>

1075
00:37:26,940 --> 00:37:31,800
<font color="#E5E5E5">you to write the word PowerShell if you</font>

1076
00:37:29,790 --> 00:37:33,630
want to execute power shell<font color="#E5E5E5"> with a bunch</font>

1077
00:37:31,800 --> 00:37:36,270
of tick marks<font color="#E5E5E5"> separating each character</font>

1078
00:37:33,630 --> 00:37:37,380
right so<font color="#E5E5E5"> that might destroy your</font>

1079
00:37:36,270 --> 00:37:41,220
detection if you're<font color="#E5E5E5"> simply looking</font><font color="#CCCCCC"> for</font>

1080
00:37:37,380 --> 00:37:43,050
<font color="#E5E5E5">the word</font><font color="#CCCCCC"> powershell or vice-versa if</font>

1081
00:37:41,220 --> 00:37:44,500
<font color="#CCCCCC">they want to</font><font color="#E5E5E5"> put those tick marks</font>

1082
00:37:43,050 --> 00:37:46,089
<font color="#CCCCCC">between every letter of</font><font color="#E5E5E5"> the word down</font>

1083
00:37:44,500 --> 00:37:47,230
<font color="#E5E5E5">if you're simply looking</font><font color="#CCCCCC"> for dot</font>

1084
00:37:46,089 --> 00:37:48,640
download and you're not stripping<font color="#E5E5E5"> out</font>

1085
00:37:47,230 --> 00:37:50,260
<font color="#CCCCCC">the</font><font color="#E5E5E5"> special characters you're gonna fail</font>

1086
00:37:48,640 --> 00:37:51,700
to catch that<font color="#E5E5E5"> so it's</font><font color="#CCCCCC"> very important</font><font color="#E5E5E5"> to</font>

1087
00:37:50,260 --> 00:37:52,569
<font color="#E5E5E5">try</font><font color="#CCCCCC"> and strip</font><font color="#E5E5E5"> out special characters if</font>

1088
00:37:51,700 --> 00:37:54,970
you're<font color="#E5E5E5"> doing this kind of detection</font>

1089
00:37:52,569 --> 00:37:56,380
<font color="#E5E5E5">otherwise your likelihood of</font><font color="#CCCCCC"> catching</font>

1090
00:37:54,970 --> 00:37:57,879
more<font color="#E5E5E5"> advanced attackers is gonna be very</font>

1091
00:37:56,380 --> 00:37:59,650
low<font color="#E5E5E5"> at this one but it will</font><font color="#CCCCCC"> probably</font>

1092
00:37:57,880 --> 00:38:01,930
catch<font color="#E5E5E5"> a lot of commodity stuff or some</font>

1093
00:37:59,650 --> 00:38:03,160
of the more<font color="#CCCCCC"> basic frameworks</font><font color="#E5E5E5"> the next</font>

1094
00:38:01,930 --> 00:38:05,618
we're gonna talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> is attempted</font>

1095
00:38:03,160 --> 00:38:07,299
<font color="#E5E5E5">exploitation detected this requires your</font>

1096
00:38:05,619 --> 00:38:09,510
vulnerability scan data<font color="#E5E5E5"> is everyone</font>

1097
00:38:07,300 --> 00:38:13,750
<font color="#CCCCCC">doing vulnerability scans every so often</font>

1098
00:38:09,510 --> 00:38:15,160
<font color="#E5E5E5">yeah hopefully</font><font color="#CCCCCC"> you should</font><font color="#E5E5E5"> be you should</font>

1099
00:38:13,750 --> 00:38:17,619
<font color="#CCCCCC">be doing it probably quarterly or</font><font color="#E5E5E5"> maybe</font>

1100
00:38:15,160 --> 00:38:19,210
more<font color="#E5E5E5"> frequently if you can but the idea</font>

1101
00:38:17,619 --> 00:38:20,680
here<font color="#CCCCCC"> is once you've got that scan</font><font color="#E5E5E5"> data I</font>

1102
00:38:19,210 --> 00:38:22,990
mean<font color="#E5E5E5"> a lot of people use</font><font color="#CCCCCC"> that scan data</font>

1103
00:38:20,680 --> 00:38:24,368
for patching you go you<font color="#CCCCCC"> patched your</font>

1104
00:38:22,990 --> 00:38:27,759
systems<font color="#E5E5E5"> and you say that's</font><font color="#CCCCCC"> great</font>

1105
00:38:24,369 --> 00:38:29,710
or sometimes<font color="#CCCCCC"> you say well you know what</font>

1106
00:38:27,760 --> 00:38:31,150
<font color="#E5E5E5">we're gonna prioritize only the critical</font>

1107
00:38:29,710 --> 00:38:33,400
ones<font color="#E5E5E5"> we're gonna leave all these other</font>

1108
00:38:31,150 --> 00:38:35,050
ones<font color="#E5E5E5"> unpatched it happens a lot</font><font color="#CCCCCC"> right</font>

1109
00:38:33,400 --> 00:38:37,869
has anyone<font color="#E5E5E5"> heard of that before</font>

1110
00:38:35,050 --> 00:38:39,700
yeah<font color="#CCCCCC"> not ideal but it definitely happens</font>

1111
00:38:37,869 --> 00:38:40,900
so the idea here<font color="#CCCCCC"> is if you</font><font color="#E5E5E5"> have this</font>

1112
00:38:39,700 --> 00:38:43,839
data<font color="#E5E5E5"> and you know</font><font color="#CCCCCC"> your systems are</font>

1113
00:38:40,900 --> 00:38:45,339
unpatched<font color="#E5E5E5"> to specific</font><font color="#CCCCCC"> CVS you can</font>

1114
00:38:43,839 --> 00:38:47,680
actually<font color="#E5E5E5"> correlate that with IDs alerts</font>

1115
00:38:45,339 --> 00:38:50,740
because<font color="#E5E5E5"> your IDs alerts will should also</font>

1116
00:38:47,680 --> 00:38:53,589
<font color="#E5E5E5">have a CV so again you're looking for an</font>

1117
00:38:50,740 --> 00:38:56,229
IDs<font color="#E5E5E5"> alert correlated with a specific</font>

1118
00:38:53,589 --> 00:38:58,750
<font color="#CCCCCC">host that you know to be vulnerable with</font>

1119
00:38:56,230 --> 00:39:00,369
that CV<font color="#CCCCCC"> and that could and likely</font><font color="#E5E5E5"> does</font>

1120
00:38:58,750 --> 00:39:02,260
indicate<font color="#CCCCCC"> that someone has</font><font color="#E5E5E5"> done some</font>

1121
00:39:00,369 --> 00:39:04,060
reconnaissance<font color="#E5E5E5"> they've already</font>

1122
00:39:02,260 --> 00:39:05,260
identified<font color="#E5E5E5"> what application is running</font>

1123
00:39:04,060 --> 00:39:06,430
<font color="#E5E5E5">on that server or system that</font><font color="#CCCCCC"> they're</font>

1124
00:39:05,260 --> 00:39:09,280
<font color="#E5E5E5">trying to exploit and they're</font><font color="#CCCCCC"> actually</font>

1125
00:39:06,430 --> 00:39:11,348
<font color="#E5E5E5">running an exploit that has a very high</font>

1126
00:39:09,280 --> 00:39:12,849
likelihood of being successful<font color="#E5E5E5"> right and</font>

1127
00:39:11,349 --> 00:39:13,960
that<font color="#E5E5E5"> means that someone is specifically</font>

1128
00:39:12,849 --> 00:39:15,700
interacting with<font color="#E5E5E5"> your</font><font color="#CCCCCC"> environment and</font>

1129
00:39:13,960 --> 00:39:17,339
<font color="#E5E5E5">the likelihood of that being a random</font>

1130
00:39:15,700 --> 00:39:20,020
scan is a little bit lower

1131
00:39:17,339 --> 00:39:21,069
that being said of course it's entirely

1132
00:39:20,020 --> 00:39:22,180
<font color="#CCCCCC">likely if you're</font><font color="#E5E5E5"> running unpatched</font>

1133
00:39:21,069 --> 00:39:23,859
software expose the internet you're

1134
00:39:22,180 --> 00:39:25,240
probably<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> get people trying to</font>

1135
00:39:23,859 --> 00:39:27,640
exploit you with<font color="#CCCCCC"> everything all the time</font>

1136
00:39:25,240 --> 00:39:29,709
this<font color="#CCCCCC"> is probably</font><font color="#E5E5E5"> better to limit to</font><font color="#CCCCCC"> your</font>

1137
00:39:27,640 --> 00:39:36,069
internal<font color="#CCCCCC"> network your internal servers</font>

1138
00:39:29,710 --> 00:39:37,180
that<font color="#E5E5E5"> are</font><font color="#CCCCCC"> not internet facing the next</font>

1139
00:39:36,069 --> 00:39:39,310
<font color="#CCCCCC">row we're gonna</font><font color="#E5E5E5"> talk about I actually</font>

1140
00:39:37,180 --> 00:39:41,529
<font color="#E5E5E5">hate this kind</font><font color="#CCCCCC"> of rule</font><font color="#E5E5E5"> and I only</font>

1141
00:39:39,310 --> 00:39:43,270
<font color="#E5E5E5">included it so I could specifically tell</font>

1142
00:39:41,530 --> 00:39:44,920
you one thing about<font color="#E5E5E5"> it a lot of</font>

1143
00:39:43,270 --> 00:39:46,690
organizations they like to say let's

1144
00:39:44,920 --> 00:39:49,300
detect brute force<font color="#E5E5E5"> and usually the</font>

1145
00:39:46,690 --> 00:39:50,560
threshold I see is<font color="#E5E5E5"> like three failed</font>

1146
00:39:49,300 --> 00:39:53,560
logins in five minutes or something

1147
00:39:50,560 --> 00:39:54,759
<font color="#E5E5E5">something really low like I said I'm not</font>

1148
00:39:53,560 --> 00:39:55,990
a huge<font color="#CCCCCC"> fan of</font><font color="#E5E5E5"> this because I really</font>

1149
00:39:54,760 --> 00:39:57,970
<font color="#E5E5E5">don't see a lot of value coming out of</font>

1150
00:39:55,990 --> 00:39:59,560
it but if you have to implement<font color="#E5E5E5"> this</font>

1151
00:39:57,970 --> 00:40:02,529
and for whatever reason<font color="#E5E5E5"> you think it's</font>

1152
00:39:59,560 --> 00:40:05,560
really<font color="#E5E5E5"> great up here</font><font color="#CCCCCC"> threshold as much</font>

1153
00:40:02,530 --> 00:40:07,420
as you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> we had in one</font>

1154
00:40:05,560 --> 00:40:09,160
<font color="#CCCCCC">organization you know we had this three</font>

1155
00:40:07,420 --> 00:40:10,660
<font color="#E5E5E5">failed logins in five minutes it</font>

1156
00:40:09,160 --> 00:40:11,770
<font color="#E5E5E5">basically just detected every Monday</font>

1157
00:40:10,660 --> 00:40:14,170
morning everyone forgetting their

1158
00:40:11,770 --> 00:40:15,700
password<font color="#E5E5E5"> on Monday morning that's all it</font>

1159
00:40:14,170 --> 00:40:17,770
was<font color="#CCCCCC"> really good for and I think</font><font color="#E5E5E5"> we did</font>

1160
00:40:15,700 --> 00:40:21,160
about<font color="#E5E5E5"> 1,000 investigations and zero of</font>

1161
00:40:17,770 --> 00:40:23,020
them were ever actual evidence of

1162
00:40:21,160 --> 00:40:24,640
activity that<font color="#E5E5E5"> was malicious or even</font>

1163
00:40:23,020 --> 00:40:25,660
someone doing something<font color="#CCCCCC"> bad</font><font color="#E5E5E5"> right so</font>

1164
00:40:24,640 --> 00:40:27,040
that's<font color="#E5E5E5"> a lot of spent effort on</font>

1165
00:40:25,660 --> 00:40:29,170
something that<font color="#E5E5E5"> wasn't really great we up</font>

1166
00:40:27,040 --> 00:40:32,740
the threshold<font color="#E5E5E5"> and if we if we up it to</font>

1167
00:40:29,170 --> 00:40:35,200
200 in 24 hours<font color="#E5E5E5"> all of</font><font color="#CCCCCC"> those you know</font>

1168
00:40:32,740 --> 00:40:37,049
just user error<font color="#E5E5E5"> things go away what</font>

1169
00:40:35,200 --> 00:40:39,910
you're<font color="#E5E5E5"> left with is two things</font>

1170
00:40:37,050 --> 00:40:42,430
you're left<font color="#E5E5E5"> with possible brute force</font>

1171
00:40:39,910 --> 00:40:44,379
<font color="#E5E5E5">that's gonna be probably one</font><font color="#CCCCCC"> in ten nine</font>

1172
00:40:42,430 --> 00:40:46,690
times out of<font color="#E5E5E5"> ten you're gonna find that</font>

1173
00:40:44,380 --> 00:40:49,150
a sysadmin has written a script<font color="#CCCCCC"> and he's</font>

1174
00:40:46,690 --> 00:40:50,440
hard-coded credentials<font color="#E5E5E5"> and you know the</font>

1175
00:40:49,150 --> 00:40:51,820
credentials<font color="#E5E5E5"> have changed</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> his script</font>

1176
00:40:50,440 --> 00:40:53,440
is hammering some server trying to use

1177
00:40:51,820 --> 00:40:55,570
the old credentials<font color="#E5E5E5"> not really a</font>

1178
00:40:53,440 --> 00:40:57,640
security<font color="#E5E5E5"> issue from the</font><font color="#CCCCCC"> perspective of</font>

1179
00:40:55,570 --> 00:40:59,380
someone breaching<font color="#CCCCCC"> your organization but</font>

1180
00:40:57,640 --> 00:41:01,240
it kind of is a security issue<font color="#E5E5E5"> from the</font>

1181
00:40:59,380 --> 00:41:03,430
<font color="#CCCCCC">perspective of you now have identified</font>

1182
00:41:01,240 --> 00:41:05,189
<font color="#E5E5E5">assistive minutes are good hard coded</font>

1183
00:41:03,430 --> 00:41:08,440
plaintext credentials<font color="#E5E5E5"> into a script</font><font color="#CCCCCC"> and</font>

1184
00:41:05,190 --> 00:41:12,070
<font color="#CCCCCC">that has some value to you know</font><font color="#E5E5E5"> finding</font>

1185
00:41:08,440 --> 00:41:13,300
and fixing of course now this one is

1186
00:41:12,070 --> 00:41:14,770
good<font color="#CCCCCC"> and</font><font color="#E5E5E5"> actually you know I've</font>

1187
00:41:13,300 --> 00:41:17,050
<font color="#E5E5E5">considered even just making this service</font>

1188
00:41:14,770 --> 00:41:19,900
<font color="#CCCCCC">installation in general but if you have</font>

1189
00:41:17,050 --> 00:41:22,570
services<font color="#E5E5E5"> being installed just at all on</font>

1190
00:41:19,900 --> 00:41:25,359
<font color="#E5E5E5">your critical servers you</font><font color="#CCCCCC"> probably</font>

1191
00:41:22,570 --> 00:41:26,920
should<font color="#E5E5E5"> be detecting that again</font><font color="#CCCCCC"> 70 45</font><font color="#E5E5E5"> VI</font>

1192
00:41:25,359 --> 00:41:28,750
D like we saw before<font color="#CCCCCC"> very</font>

1193
00:41:26,920 --> 00:41:30,130
<font color="#CCCCCC">straightforward all you</font><font color="#E5E5E5"> really need</font><font color="#CCCCCC"> is a</font>

1194
00:41:28,750 --> 00:41:34,570
reference list of your critical servers

1195
00:41:30,130 --> 00:41:37,000
<font color="#E5E5E5">and your</font><font color="#CCCCCC"> event</font><font color="#E5E5E5"> looks pretty easy to</font>

1196
00:41:34,570 --> 00:41:39,849
<font color="#E5E5E5">check and compare the reality is once</font>

1197
00:41:37,000 --> 00:41:41,530
your servers are<font color="#CCCCCC"> set</font><font color="#E5E5E5"> up domain</font>

1198
00:41:39,849 --> 00:41:43,030
controller is deployed<font color="#E5E5E5"> you're probably</font>

1199
00:41:41,530 --> 00:41:45,280
not<font color="#E5E5E5"> installing new services to it</font><font color="#CCCCCC"> very</font>

1200
00:41:43,030 --> 00:41:48,280
often<font color="#E5E5E5"> the only</font><font color="#CCCCCC"> people doing that are</font>

1201
00:41:45,280 --> 00:41:50,200
likely<font color="#CCCCCC"> going to be attackers except of</font>

1202
00:41:48,280 --> 00:41:51,280
course<font color="#E5E5E5"> if you have you know</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> approve</font>

1203
00:41:50,200 --> 00:41:52,990
change window where you're<font color="#CCCCCC"> actually</font>

1204
00:41:51,280 --> 00:41:56,349
deploying new applications then that

1205
00:41:52,990 --> 00:41:58,060
makes sense that you<font color="#E5E5E5"> might have that now</font>

1206
00:41:56,349 --> 00:42:00,880
earlier I showed<font color="#E5E5E5"> you a</font><font color="#CCCCCC"> bunch</font><font color="#E5E5E5"> of file</font>

1207
00:41:58,060 --> 00:42:02,560
names<font color="#CCCCCC"> that were related to credential</font>

1208
00:42:00,880 --> 00:42:04,450
dumping malware but<font color="#E5E5E5"> of course as I said</font>

1209
00:42:02,560 --> 00:42:08,140
<font color="#E5E5E5">attacker can simply change the file name</font>

1210
00:42:04,450 --> 00:42:09,549
<font color="#E5E5E5">and your detection is now moot so the</font>

1211
00:42:08,140 --> 00:42:10,810
alternative<font color="#CCCCCC"> I mean it's really not</font><font color="#E5E5E5"> a</font>

1212
00:42:09,550 --> 00:42:12,520
great<font color="#CCCCCC"> alternative</font>

1213
00:42:10,810 --> 00:42:14,740
but I'll<font color="#E5E5E5"> explain why I put this in here</font>

1214
00:42:12,520 --> 00:42:17,200
<font color="#E5E5E5">is going with antivirus signatures</font><font color="#CCCCCC"> and</font>

1215
00:42:14,740 --> 00:42:20,049
in this<font color="#E5E5E5"> particular case the AV solution</font>

1216
00:42:17,200 --> 00:42:22,629
that I looked<font color="#E5E5E5"> at it names all</font><font color="#CCCCCC"> of the</font>

1217
00:42:20,050 --> 00:42:25,120
credential theft malware with the prefix

1218
00:42:22,630 --> 00:42:26,020
hack tool dot so<font color="#E5E5E5"> rather than trying to</font>

1219
00:42:25,120 --> 00:42:27,430
figure<font color="#E5E5E5"> out all the credential theft</font>

1220
00:42:26,020 --> 00:42:31,360
malware names<font color="#CCCCCC"> I simply use that</font>

1221
00:42:27,430 --> 00:42:34,210
<font color="#CCCCCC">expression or that pattern substring to</font>

1222
00:42:31,360 --> 00:42:36,670
look for detection<font color="#E5E5E5"> of these hacked tools</font>

1223
00:42:34,210 --> 00:42:38,680
and that catchers hack tools credential

1224
00:42:36,670 --> 00:42:40,150
theft malware and the reason I<font color="#CCCCCC"> included</font>

1225
00:42:38,680 --> 00:42:43,330
this<font color="#CCCCCC"> because this</font><font color="#E5E5E5"> is kind of lame right</font>

1226
00:42:40,150 --> 00:42:44,890
antivirus detected it why do I care<font color="#CCCCCC"> so I</font>

1227
00:42:43,330 --> 00:42:47,470
can see why you might<font color="#CCCCCC"> think</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is kind</font>

1228
00:42:44,890 --> 00:42:49,500
<font color="#CCCCCC">of lame but if someone is already in</font>

1229
00:42:47,470 --> 00:42:51,850
<font color="#E5E5E5">your environment and dropping hack tools</font>

1230
00:42:49,500 --> 00:42:53,680
<font color="#E5E5E5">even if it's cleaned what happens</font>

1231
00:42:51,850 --> 00:42:56,020
immediately<font color="#CCCCCC"> and I've seen</font><font color="#E5E5E5"> this with</font><font color="#CCCCCC"> real</font>

1232
00:42:53,680 --> 00:42:57,009
attackers here's what happens<font color="#CCCCCC"> they</font><font color="#E5E5E5"> drop</font>

1233
00:42:56,020 --> 00:42:59,110
the hack tool it gets cleaned off

1234
00:42:57,010 --> 00:43:00,940
antivirus wipes it away<font color="#E5E5E5"> everyone ignores</font>

1235
00:42:59,110 --> 00:43:03,340
it the attacker changes one<font color="#E5E5E5"> bite in the</font>

1236
00:43:00,940 --> 00:43:05,470
file<font color="#E5E5E5"> brings it back in antivirus doesn't</font>

1237
00:43:03,340 --> 00:43:07,060
detect<font color="#E5E5E5"> it continues on his way that has</font>

1238
00:43:05,470 --> 00:43:09,580
<font color="#E5E5E5">basically slowed him down for about 30</font>

1239
00:43:07,060 --> 00:43:12,279
seconds<font color="#E5E5E5"> but for us it's a</font><font color="#CCCCCC"> great</font>

1240
00:43:09,580 --> 00:43:14,020
<font color="#E5E5E5">indicator right and they're not like so</font>

1241
00:43:12,280 --> 00:43:15,490
<font color="#E5E5E5">many cases that</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> worked on where we</font>

1242
00:43:14,020 --> 00:43:17,440
come in and we see the antivirus

1243
00:43:15,490 --> 00:43:19,390
actually had detected the<font color="#E5E5E5"> attack tool</font>

1244
00:43:17,440 --> 00:43:21,250
but it was cleaned and so no one<font color="#CCCCCC"> really</font>

1245
00:43:19,390 --> 00:43:25,180
<font color="#CCCCCC">paid attention</font><font color="#E5E5E5"> to it but that was a</font>

1246
00:43:21,250 --> 00:43:27,580
<font color="#E5E5E5">great</font><font color="#CCCCCC"> early warning now this one</font><font color="#E5E5E5"> is a</font>

1247
00:43:25,180 --> 00:43:30,399
cool one<font color="#CCCCCC"> we saw an apt threat actor</font>

1248
00:43:27,580 --> 00:43:33,279
actually doing this and folks were

1249
00:43:30,400 --> 00:43:35,890
talking<font color="#CCCCCC"> anything about ho 365 earlier</font>

1250
00:43:33,280 --> 00:43:37,180
right so<font color="#E5E5E5"> webmail or accessible email</font>

1251
00:43:35,890 --> 00:43:39,759
from the<font color="#CCCCCC"> internet especially in cloud</font>

1252
00:43:37,180 --> 00:43:42,430
hosting providers we actually saw an apt

1253
00:43:39,760 --> 00:43:47,650
organization or a group who gained

1254
00:43:42,430 --> 00:43:49,330
access to<font color="#E5E5E5"> the cloud or a 365 mail system</font>

1255
00:43:47,650 --> 00:43:51,070
for a specific<font color="#E5E5E5"> organization and what</font>

1256
00:43:49,330 --> 00:43:53,710
they<font color="#CCCCCC"> did was</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> had access to a couple</font>

1257
00:43:51,070 --> 00:43:57,460
<font color="#CCCCCC">of</font><font color="#E5E5E5"> users and they</font><font color="#CCCCCC"> basically gave those</font>

1258
00:43:53,710 --> 00:44:00,730
users delegation rights to the entire<font color="#E5E5E5"> IT</font>

1259
00:43:57,460 --> 00:44:03,520
security<font color="#CCCCCC"> team's</font><font color="#E5E5E5"> mailboxes so it's about</font>

1260
00:44:00,730 --> 00:44:05,800
26 or 27 if I recall correctly<font color="#E5E5E5"> users</font>

1261
00:44:03,520 --> 00:44:07,570
<font color="#E5E5E5">that they got access to and what that</font>

1262
00:44:05,800 --> 00:44:11,620
means<font color="#E5E5E5"> is then the attackers had full</font>

1263
00:44:07,570 --> 00:44:13,150
<font color="#E5E5E5">access to read modify and send mail on</font>

1264
00:44:11,620 --> 00:44:14,500
behalf of the security team so as the

1265
00:44:13,150 --> 00:44:15,490
security team was actually<font color="#E5E5E5"> investigating</font>

1266
00:44:14,500 --> 00:44:16,990
in this case they didn't have an

1267
00:44:15,490 --> 00:44:19,810
investigations tracker<font color="#E5E5E5"> this particular</font>

1268
00:44:16,990 --> 00:44:22,629
organization<font color="#CCCCCC"> the security team</font><font color="#E5E5E5"> well they</font>

1269
00:44:19,810 --> 00:44:23,830
just<font color="#E5E5E5"> communicated by email</font><font color="#CCCCCC"> the attackers</font>

1270
00:44:22,630 --> 00:44:24,700
were actually<font color="#E5E5E5"> reading the emails and</font>

1271
00:44:23,830 --> 00:44:27,790
<font color="#E5E5E5">watching the</font><font color="#CCCCCC"> investig--</font>

1272
00:44:24,700 --> 00:44:31,000
into them<font color="#CCCCCC"> as it proceeded in real-time</font>

1273
00:44:27,790 --> 00:44:33,009
<font color="#E5E5E5">but again basically to detect this take</font>

1274
00:44:31,000 --> 00:44:35,559
a look for the access rights<font color="#E5E5E5"> equal full</font>

1275
00:44:33,010 --> 00:44:39,400
access delegation<font color="#E5E5E5"> being set</font><font color="#CCCCCC"> on a</font>

1276
00:44:35,559 --> 00:44:41,349
specific<font color="#E5E5E5"> mailbox and this happens right</font>

1277
00:44:39,400 --> 00:44:43,720
<font color="#CCCCCC">an EA has delegation rights to an</font>

1278
00:44:41,349 --> 00:44:45,160
executives<font color="#E5E5E5"> mailbox for example so it</font>

1279
00:44:43,720 --> 00:44:47,680
happens once in<font color="#CCCCCC"> a while</font><font color="#E5E5E5"> here I</font>

1280
00:44:45,160 --> 00:44:48,819
recommended<font color="#E5E5E5"> a threshold of</font><font color="#CCCCCC"> three in 24</font>

1281
00:44:47,680 --> 00:44:50,470
hours is where you should<font color="#E5E5E5"> trigger on</font>

1282
00:44:48,819 --> 00:44:52,660
<font color="#E5E5E5">because one or two kind of makes sense</font>

1283
00:44:50,470 --> 00:44:54,700
<font color="#E5E5E5">right</font><font color="#CCCCCC"> a new employee being set up who</font>

1284
00:44:52,660 --> 00:44:55,960
has to do some<font color="#E5E5E5"> work for other folks will</font>

1285
00:44:54,700 --> 00:44:57,069
have delegation rights assigned to them

1286
00:44:55,960 --> 00:44:59,950
and<font color="#CCCCCC"> you don't to bother yourself with</font>

1287
00:44:57,069 --> 00:45:01,299
<font color="#E5E5E5">false positives like that okay we're</font>

1288
00:44:59,950 --> 00:45:03,069
about<font color="#E5E5E5"> halfway through we've got about I</font>

1289
00:45:01,299 --> 00:45:04,780
<font color="#E5E5E5">think</font><font color="#CCCCCC"> 10 or loving more</font><font color="#E5E5E5"> I think</font>

1290
00:45:03,069 --> 00:45:07,150
<font color="#E5E5E5">numbering is messed up let's see bypass</font>

1291
00:45:04,780 --> 00:45:08,710
code being used this is<font color="#E5E5E5"> cool again</font>

1292
00:45:07,150 --> 00:45:11,049
another case where we saw a PT<font color="#E5E5E5"> thread</font>

1293
00:45:08,710 --> 00:45:12,880
<font color="#E5E5E5">actor's collect the paper bypass codes</font>

1294
00:45:11,049 --> 00:45:14,339
<font color="#E5E5E5">so what that means is if you have a</font>

1295
00:45:12,880 --> 00:45:16,869
<font color="#CCCCCC">two-factor</font><font color="#E5E5E5"> authentication</font>

1296
00:45:14,339 --> 00:45:18,880
deployment<font color="#E5E5E5"> and you've got that token</font>

1297
00:45:16,869 --> 00:45:21,280
<font color="#E5E5E5">code that changes every 30 or 60 seconds</font>

1298
00:45:18,880 --> 00:45:24,700
<font color="#E5E5E5">when that is registered</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> enrolled the</font>

1299
00:45:21,280 --> 00:45:26,319
user is given<font color="#CCCCCC"> 8 typically bypass codes</font>

1300
00:45:24,700 --> 00:45:27,669
that<font color="#E5E5E5"> are called paper codes</font><font color="#CCCCCC"> this is like</font>

1301
00:45:26,319 --> 00:45:30,369
a file that they might download<font color="#E5E5E5"> and</font>

1302
00:45:27,670 --> 00:45:32,369
these codes can<font color="#CCCCCC"> be used in place of a</font>

1303
00:45:30,369 --> 00:45:35,020
rolling token or a one-time<font color="#E5E5E5"> password</font>

1304
00:45:32,369 --> 00:45:36,190
<font color="#E5E5E5">most users click on the file it</font>

1305
00:45:35,020 --> 00:45:37,270
automatically<font color="#CCCCCC"> downloads it to your</font>

1306
00:45:36,190 --> 00:45:39,250
<font color="#E5E5E5">machine if you're using something</font><font color="#CCCCCC"> like</font>

1307
00:45:37,270 --> 00:45:42,009
Google Authenticator for example and

1308
00:45:39,250 --> 00:45:44,020
then they<font color="#E5E5E5"> forget</font><font color="#CCCCCC"> about it right so if an</font>

1309
00:45:42,010 --> 00:45:45,490
attacker gets access<font color="#CCCCCC"> to that system they</font>

1310
00:45:44,020 --> 00:45:47,619
<font color="#E5E5E5">can collect that file now they've got 8</font>

1311
00:45:45,490 --> 00:45:49,000
token codes they can use to<font color="#CCCCCC"> remotely</font>

1312
00:45:47,619 --> 00:45:52,059
<font color="#CCCCCC">access your environment they don't need</font>

1313
00:45:49,000 --> 00:45:54,490
a soft token so if you're looking<font color="#CCCCCC"> in</font>

1314
00:45:52,059 --> 00:45:57,250
your multi-factor authentication logs

1315
00:45:54,490 --> 00:46:00,910
there's typically a specific<font color="#E5E5E5"> signature</font>

1316
00:45:57,250 --> 00:46:02,440
or some indicator that a bypass code was

1317
00:46:00,910 --> 00:46:05,348
used<font color="#CCCCCC"> for</font><font color="#E5E5E5"> this particular authentication</font>

1318
00:46:02,440 --> 00:46:06,670
and here I thought<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> it's possible that</font>

1319
00:46:05,349 --> 00:46:08,470
<font color="#E5E5E5">someone will use a bypass code right</font>

1320
00:46:06,670 --> 00:46:11,410
you've lost your phone you got a new

1321
00:46:08,470 --> 00:46:13,899
phone<font color="#CCCCCC"> you might want to use a bypass</font>

1322
00:46:11,410 --> 00:46:17,230
code to<font color="#E5E5E5"> login so</font><font color="#CCCCCC"> in this case</font><font color="#E5E5E5"> I limited</font>

1323
00:46:13,900 --> 00:46:18,430
this<font color="#E5E5E5"> to outside</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the home region of</font>

1324
00:46:17,230 --> 00:46:21,430
<font color="#E5E5E5">this organization this organization</font>

1325
00:46:18,430 --> 00:46:25,419
fictional exists only in Canada<font color="#E5E5E5"> and the</font>

1326
00:46:21,430 --> 00:46:27,040
US so if someone<font color="#E5E5E5"> uses a bypass code from</font>

1327
00:46:25,420 --> 00:46:29,559
<font color="#E5E5E5">anywhere outside of that I want to know</font>

1328
00:46:27,040 --> 00:46:32,200
<font color="#CCCCCC">about it</font><font color="#E5E5E5"> why again because we saw an apt</font>

1329
00:46:29,559 --> 00:46:33,760
thread actor do this from<font color="#CCCCCC"> a country</font><font color="#E5E5E5"> that</font>

1330
00:46:32,200 --> 00:46:37,618
was outside of<font color="#E5E5E5"> the home organization</font>

1331
00:46:33,760 --> 00:46:40,200
<font color="#E5E5E5">this also links in with that if a</font><font color="#CCCCCC"> too</font>

1332
00:46:37,619 --> 00:46:42,119
after authentication token is registered

1333
00:46:40,200 --> 00:46:45,259
<font color="#E5E5E5">outside</font><font color="#CCCCCC"> of your</font><font color="#E5E5E5"> home region you might</font>

1334
00:46:42,119 --> 00:46:48,059
also be<font color="#CCCCCC"> interested</font><font color="#E5E5E5"> in that because</font><font color="#CCCCCC"> why</font>

1335
00:46:45,259 --> 00:46:49,740
<font color="#E5E5E5">when a new employee joins your company</font>

1336
00:46:48,059 --> 00:46:51,180
and<font color="#E5E5E5"> you give them their two-factor</font>

1337
00:46:49,740 --> 00:46:53,279
authentication<font color="#E5E5E5"> where are they doing that</font>

1338
00:46:51,180 --> 00:46:56,160
<font color="#E5E5E5">from</font><font color="#CCCCCC"> they're setting that up in the</font>

1339
00:46:53,279 --> 00:46:58,410
<font color="#CCCCCC">office</font><font color="#E5E5E5"> maybe at home and if your</font>

1340
00:46:56,160 --> 00:46:59,549
<font color="#CCCCCC">organization is</font><font color="#E5E5E5"> based in Calgary for</font>

1341
00:46:58,410 --> 00:47:01,769
example you don't<font color="#CCCCCC"> have any</font><font color="#E5E5E5"> employees</font>

1342
00:46:59,549 --> 00:47:03,390
outside of Calgary someone is

1343
00:47:01,769 --> 00:47:06,959
<font color="#E5E5E5">registering a new two-factor</font>

1344
00:47:03,390 --> 00:47:08,390
authentication token in China<font color="#E5E5E5"> you might</font>

1345
00:47:06,960 --> 00:47:09,509
be interested<font color="#CCCCCC"> in why that's happening</font>

1346
00:47:08,390 --> 00:47:10,859
again

1347
00:47:09,509 --> 00:47:13,380
that's what<font color="#CCCCCC"> hackers are doing now so</font>

1348
00:47:10,859 --> 00:47:16,140
what we see is that<font color="#E5E5E5"> advanced attackers</font>

1349
00:47:13,380 --> 00:47:17,819
like<font color="#E5E5E5"> to use your own existing remote</font>

1350
00:47:16,140 --> 00:47:19,379
access utilities<font color="#CCCCCC"> right</font><font color="#E5E5E5"> because they can</font>

1351
00:47:17,819 --> 00:47:20,910
blend in the traffic blends right in and

1352
00:47:19,380 --> 00:47:22,799
we have seen where they will<font color="#E5E5E5"> actually</font>

1353
00:47:20,910 --> 00:47:25,140
<font color="#E5E5E5">generate their own token codes to get</font>

1354
00:47:22,799 --> 00:47:27,240
access<font color="#E5E5E5"> to you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> administration</font>

1355
00:47:25,140 --> 00:47:29,098
server<font color="#CCCCCC"> they'll simply</font><font color="#E5E5E5"> create a new</font><font color="#CCCCCC"> token</font>

1356
00:47:27,240 --> 00:47:30,779
and<font color="#E5E5E5"> now they can log in the same way</font>

1357
00:47:29,099 --> 00:47:32,460
that all your users<font color="#E5E5E5"> can so this is</font>

1358
00:47:30,779 --> 00:47:35,309
<font color="#E5E5E5">something that</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> should be</font><font color="#CCCCCC"> very</font>

1359
00:47:32,460 --> 00:47:40,289
easy<font color="#CCCCCC"> to</font><font color="#E5E5E5"> implement and you know fairly</font>

1360
00:47:35,309 --> 00:47:42,599
good accuracy<font color="#E5E5E5"> now this one is related to</font>

1361
00:47:40,289 --> 00:47:44,999
<font color="#E5E5E5">scheduled tasks and scheduled tasks of</font>

1362
00:47:42,599 --> 00:47:46,859
course are part<font color="#E5E5E5"> of the Windows operating</font>

1363
00:47:44,999 --> 00:47:48,509
system that<font color="#E5E5E5"> allows</font><font color="#CCCCCC"> specific commands</font><font color="#E5E5E5"> or</font>

1364
00:47:46,859 --> 00:47:50,848
applications to be run<font color="#CCCCCC"> on</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> regular</font>

1365
00:47:48,509 --> 00:47:53,190
basis or one time they can be used on

1366
00:47:50,849 --> 00:47:56,339
local or remote systems so attackers

1367
00:47:53,190 --> 00:47:58,890
like<font color="#CCCCCC"> to use this for</font><font color="#E5E5E5"> what we call remote</font>

1368
00:47:56,339 --> 00:48:01,799
command execution<font color="#E5E5E5"> or they might use it</font>

1369
00:47:58,890 --> 00:48:04,379
<font color="#CCCCCC">for persistence but of course if someone</font>

1370
00:48:01,799 --> 00:48:06,569
<font color="#E5E5E5">is using a scheduled task in a normal</font>

1371
00:48:04,380 --> 00:48:08,009
environment<font color="#CCCCCC"> you might not</font><font color="#E5E5E5"> see some of</font>

1372
00:48:06,569 --> 00:48:09,619
these things<font color="#CCCCCC"> for example</font><font color="#E5E5E5"> how often you</font>

1373
00:48:08,009 --> 00:48:11,609
have<font color="#E5E5E5"> scheduled tasks running batch files</font>

1374
00:48:09,619 --> 00:48:13,529
<font color="#E5E5E5">you might have it in your</font><font color="#CCCCCC"> environment</font>

1375
00:48:11,609 --> 00:48:14,700
actually<font color="#E5E5E5"> but if you do it probably</font>

1376
00:48:13,529 --> 00:48:16,200
happens on a<font color="#CCCCCC"> regular basis</font><font color="#E5E5E5"> and that's</font>

1377
00:48:14,700 --> 00:48:20,460
<font color="#E5E5E5">something that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> easily observe</font>

1378
00:48:16,200 --> 00:48:22,649
<font color="#E5E5E5">and</font><font color="#CCCCCC"> - now that being</font><font color="#E5E5E5"> said</font><font color="#CCCCCC"> it's probably</font>

1379
00:48:20,460 --> 00:48:26,069
not likely you have any scheduled tasks

1380
00:48:22,650 --> 00:48:30,059
that are using register of 32<font color="#E5E5E5"> or have</font>

1381
00:48:26,069 --> 00:48:33,329
<font color="#E5E5E5">this</font><font color="#CCCCCC"> keyword in here ser obj dll</font><font color="#E5E5E5"> does</font>

1382
00:48:30,059 --> 00:48:34,559
anyone know what that<font color="#E5E5E5"> is I've written it</font>

1383
00:48:33,329 --> 00:48:38,420
here<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> description</font><font color="#E5E5E5"> that's actually</font>

1384
00:48:34,559 --> 00:48:43,200
called<font color="#E5E5E5"> squiggly-doo which is an attack</font>

1385
00:48:38,420 --> 00:48:45,539
<font color="#E5E5E5">that uses this</font><font color="#CCCCCC"> Windows signed binary to</font>

1386
00:48:43,200 --> 00:48:48,960
deploy whatever kind<font color="#E5E5E5"> of malicious</font><font color="#CCCCCC"> code</font>

1387
00:48:45,539 --> 00:48:51,000
on<font color="#E5E5E5"> a system I believe Casey Smith subti</font>

1388
00:48:48,960 --> 00:48:52,020
on<font color="#E5E5E5"> Twitter developed or</font>

1389
00:48:51,000 --> 00:48:53,490
<font color="#E5E5E5">you know was the first researcher</font>

1390
00:48:52,020 --> 00:48:55,170
identified<font color="#E5E5E5"> that any named scribbly do</font>

1391
00:48:53,490 --> 00:48:56,459
<font color="#E5E5E5">and but the idea being if someone is</font>

1392
00:48:55,170 --> 00:48:57,750
doing<font color="#E5E5E5"> this in your</font><font color="#CCCCCC"> environment you</font>

1393
00:48:56,460 --> 00:48:59,310
<font color="#E5E5E5">should be able to detect it</font><font color="#CCCCCC"> and I would</font>

1394
00:48:57,750 --> 00:49:00,600
actually<font color="#E5E5E5"> go as far as to say you</font><font color="#CCCCCC"> should</font>

1395
00:48:59,310 --> 00:49:03,390
probably be able<font color="#E5E5E5"> to detect scribbly do</font>

1396
00:49:00,600 --> 00:49:04,980
<font color="#CCCCCC">beyond scheduled tasks but you know if</font>

1397
00:49:03,390 --> 00:49:06,990
the fact if<font color="#E5E5E5"> someone is using these</font>

1398
00:49:04,980 --> 00:49:09,000
keywords<font color="#E5E5E5"> and you know any</font><font color="#CCCCCC"> command-line</font>

1399
00:49:06,990 --> 00:49:11,790
argument<font color="#E5E5E5"> if you have the visibility into</font>

1400
00:49:09,000 --> 00:49:13,410
<font color="#E5E5E5">command-line arguments</font><font color="#CCCCCC"> if you have like</font>

1401
00:49:11,790 --> 00:49:15,630
an EDR tool<font color="#E5E5E5"> Enterprise</font><font color="#CCCCCC"> the detection</font><font color="#E5E5E5"> and</font>

1402
00:49:13,410 --> 00:49:16,680
<font color="#E5E5E5">response tool that would be great</font><font color="#CCCCCC"> or you</font>

1403
00:49:15,630 --> 00:49:22,590
can probably get that<font color="#E5E5E5"> out of system</font><font color="#CCCCCC"> on</font>

1404
00:49:16,680 --> 00:49:24,270
as well now<font color="#E5E5E5"> this one yeah this one I can</font>

1405
00:49:22,590 --> 00:49:25,950
take or leave<font color="#E5E5E5"> but I thought I'd include</font>

1406
00:49:24,270 --> 00:49:26,940
<font color="#E5E5E5">it because it points out a couple of</font>

1407
00:49:25,950 --> 00:49:28,980
interesting<font color="#E5E5E5"> things that I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> not a</font>

1408
00:49:26,940 --> 00:49:31,230
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> are aware</font><font color="#E5E5E5"> of does anybody</font>

1409
00:49:28,980 --> 00:49:34,350
know what an HT a file is or an<font color="#CCCCCC"> MHT file</font>

1410
00:49:31,230 --> 00:49:36,660
<font color="#CCCCCC">this so some</font><font color="#E5E5E5"> folks do some folks don't</font>

1411
00:49:34,350 --> 00:49:38,850
<font color="#CCCCCC">right</font><font color="#E5E5E5"> these are file types I can</font>

1412
00:49:36,660 --> 00:49:40,730
actually<font color="#CCCCCC"> can actually contain you know</font>

1413
00:49:38,850 --> 00:49:43,020
<font color="#E5E5E5">executable code</font><font color="#CCCCCC"> HTA is like an HTML</font>

1414
00:49:40,730 --> 00:49:44,580
<font color="#E5E5E5">application so it might look</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> a web</font>

1415
00:49:43,020 --> 00:49:48,480
page<font color="#E5E5E5"> but it</font><font color="#CCCCCC"> actually couldn't</font><font color="#E5E5E5"> contain</font>

1416
00:49:44,580 --> 00:49:50,310
code<font color="#E5E5E5"> MHT</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> a Microsoft document file</font>

1417
00:49:48,480 --> 00:49:52,590
and<font color="#E5E5E5"> actually can be renamed as dot</font><font color="#CCCCCC"> docx</font>

1418
00:49:50,310 --> 00:49:53,880
<font color="#CCCCCC">if an attacker</font><font color="#E5E5E5"> wants to it would be</font>

1419
00:49:52,590 --> 00:49:56,400
<font color="#CCCCCC">opened by word but</font><font color="#E5E5E5"> it actually can</font>

1420
00:49:53,880 --> 00:49:57,630
launch code as well<font color="#CCCCCC"> so these are a</font>

1421
00:49:56,400 --> 00:50:01,710
<font color="#E5E5E5">couple of</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> you might check for</font>

1422
00:49:57,630 --> 00:50:03,870
<font color="#CCCCCC">piff and</font><font color="#E5E5E5"> scr files SCR files being</font>

1423
00:50:01,710 --> 00:50:05,730
screen savers again another file type

1424
00:50:03,870 --> 00:50:08,910
<font color="#CCCCCC">that can</font><font color="#E5E5E5"> actually contain Windows</font>

1425
00:50:05,730 --> 00:50:10,350
executable code right so like<font color="#E5E5E5"> I</font><font color="#CCCCCC"> said I</font>

1426
00:50:08,910 --> 00:50:12,180
could<font color="#E5E5E5"> take or leave this one it's not</font>

1427
00:50:10,350 --> 00:50:13,380
bad<font color="#E5E5E5"> but kind of interesting at least for</font>

1428
00:50:12,180 --> 00:50:15,089
folks who don't<font color="#E5E5E5"> know that these file</font>

1429
00:50:13,380 --> 00:50:20,250
extensions can actually contain

1430
00:50:15,090 --> 00:50:21,210
executable content<font color="#E5E5E5"> got only a few</font><font color="#CCCCCC"> more</font>

1431
00:50:20,250 --> 00:50:22,170
<font color="#E5E5E5">here so</font><font color="#CCCCCC"> hopefully we'll get through</font>

1432
00:50:21,210 --> 00:50:22,800
<font color="#E5E5E5">these pretty quickly this one is very</font>

1433
00:50:22,170 --> 00:50:24,150
<font color="#CCCCCC">straightforward</font>

1434
00:50:22,800 --> 00:50:26,910
I think the relevance of<font color="#E5E5E5"> this one</font><font color="#CCCCCC"> has</font>

1435
00:50:24,150 --> 00:50:28,050
decreased over<font color="#CCCCCC"> the last few years but</font>

1436
00:50:26,910 --> 00:50:30,569
it's everyone's familiar<font color="#E5E5E5"> with right</font>

1437
00:50:28,050 --> 00:50:32,010
WordPress sites that are not kept up<font color="#CCCCCC"> to</font>

1438
00:50:30,570 --> 00:50:33,930
date they might have a<font color="#E5E5E5"> specific</font><font color="#CCCCCC"> plugin</font>

1439
00:50:32,010 --> 00:50:35,130
<font color="#CCCCCC">it's not you know it's got a</font>

1440
00:50:33,930 --> 00:50:36,779
vulnerability in<font color="#E5E5E5"> it and then all of a</font>

1441
00:50:35,130 --> 00:50:38,970
sudden<font color="#E5E5E5"> someone pops</font><font color="#CCCCCC"> 30,000 WordPress</font>

1442
00:50:36,780 --> 00:50:41,850
sites<font color="#E5E5E5"> or</font><font color="#CCCCCC"> has I never heard that before</font>

1443
00:50:38,970 --> 00:50:43,259
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> seeing like a news</font><font color="#CCCCCC"> article or X</font>

1444
00:50:41,850 --> 00:50:44,700
number of thousand WordPress sites has

1445
00:50:43,260 --> 00:50:46,950
been compromised<font color="#E5E5E5"> over the last X</font><font color="#CCCCCC"> Day</font>

1446
00:50:44,700 --> 00:50:48,899
<font color="#E5E5E5">yeah so if you start seeing downloads of</font>

1447
00:50:46,950 --> 00:50:52,350
executables<font color="#E5E5E5"> from specifically these two</font>

1448
00:50:48,900 --> 00:50:54,180
directories<font color="#CCCCCC"> that might indicate</font><font color="#E5E5E5"> that</font>

1449
00:50:52,350 --> 00:50:56,250
<font color="#E5E5E5">this has been compromised</font><font color="#CCCCCC"> and is being</font>

1450
00:50:54,180 --> 00:50:59,220
<font color="#CCCCCC">used to deliver malware a third director</font>

1451
00:50:56,250 --> 00:51:01,830
you might see is WP<font color="#E5E5E5"> dash content but the</font>

1452
00:50:59,220 --> 00:51:03,359
WP dash content directory is<font color="#E5E5E5"> the content</font>

1453
00:51:01,830 --> 00:51:04,770
directory<font color="#E5E5E5"> for the WordPress site where</font>

1454
00:51:03,360 --> 00:51:06,540
all<font color="#CCCCCC"> of its content will reside</font>

1455
00:51:04,770 --> 00:51:08,670
so if the author of that<font color="#E5E5E5"> WordPress site</font>

1456
00:51:06,540 --> 00:51:10,410
<font color="#E5E5E5">is actually just you know</font><font color="#CCCCCC"> delivering</font>

1457
00:51:08,670 --> 00:51:12,900
<font color="#CCCCCC">software because there's</font><font color="#E5E5E5"> security blog</font>

1458
00:51:10,410 --> 00:51:13,950
or you know an IT developer blog<font color="#E5E5E5"> it</font>

1459
00:51:12,900 --> 00:51:18,210
<font color="#E5E5E5">probably would be in that folder</font><font color="#CCCCCC"> and</font>

1460
00:51:13,950 --> 00:51:19,410
<font color="#CCCCCC">you'll get</font><font color="#E5E5E5"> false</font><font color="#CCCCCC"> positives sixteen local</font>

1461
00:51:18,210 --> 00:51:20,640
account created in a server<font color="#E5E5E5"> this is</font>

1462
00:51:19,410 --> 00:51:22,049
<font color="#CCCCCC">straightforward</font><font color="#E5E5E5"> right if someone is</font>

1463
00:51:20,640 --> 00:51:24,060
<font color="#CCCCCC">creating a local account</font><font color="#E5E5E5"> on a domain</font>

1464
00:51:22,050 --> 00:51:26,700
<font color="#E5E5E5">join server in your environment</font><font color="#CCCCCC"> again</font>

1465
00:51:24,060 --> 00:51:28,049
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> probably not</font><font color="#CCCCCC"> that common</font><font color="#E5E5E5"> probably</font>

1466
00:51:26,700 --> 00:51:29,730
isn't shouldn't be<font color="#CCCCCC"> happening in your</font>

1467
00:51:28,050 --> 00:51:31,290
<font color="#CCCCCC">environment likely</font><font color="#E5E5E5"> you have policies</font><font color="#CCCCCC"> in</font>

1468
00:51:29,730 --> 00:51:32,970
<font color="#CCCCCC">place</font><font color="#E5E5E5"> that say this shouldn't happen</font>

1469
00:51:31,290 --> 00:51:35,340
because<font color="#E5E5E5"> most of your domain joint</font>

1470
00:51:32,970 --> 00:51:37,049
<font color="#E5E5E5">servers should</font><font color="#CCCCCC"> be administered</font><font color="#E5E5E5"> by domain</font>

1471
00:51:35,340 --> 00:51:38,310
accounts so if someone is<font color="#CCCCCC"> creating a</font>

1472
00:51:37,050 --> 00:51:40,170
local<font color="#E5E5E5"> account again this could be an</font>

1473
00:51:38,310 --> 00:51:42,360
indicator<font color="#CCCCCC"> of malicious activity I'd say</font>

1474
00:51:40,170 --> 00:51:43,560
this<font color="#E5E5E5"> one is probably like a 30/70 more</font>

1475
00:51:42,360 --> 00:51:45,030
often than not like<font color="#CCCCCC"> seventy percent of</font>

1476
00:51:43,560 --> 00:51:45,870
<font color="#E5E5E5">the time it's like</font><font color="#CCCCCC"> a sysadmin is just</font>

1477
00:51:45,030 --> 00:51:47,340
doing<font color="#CCCCCC"> something</font><font color="#E5E5E5"> that you shouldn't</font><font color="#CCCCCC"> be</font>

1478
00:51:45,870 --> 00:51:49,710
doing<font color="#CCCCCC"> now</font><font color="#E5E5E5"> I'm purposely just for</font>

1479
00:51:47,340 --> 00:51:50,880
whatever reason interactive use of a

1480
00:51:49,710 --> 00:51:52,980
service account this one is great

1481
00:51:50,880 --> 00:51:54,330
<font color="#E5E5E5">attackers love to leverage service</font>

1482
00:51:52,980 --> 00:51:57,240
accounts because<font color="#E5E5E5"> service accounts have</font>

1483
00:51:54,330 --> 00:51:59,549
access to a lot of<font color="#E5E5E5"> stuff right they have</font>

1484
00:51:57,240 --> 00:52:01,200
<font color="#E5E5E5">access to</font><font color="#CCCCCC"> a lot of systems as well</font><font color="#E5E5E5"> but</font>

1485
00:51:59,550 --> 00:52:04,530
their service accounts and they should

1486
00:52:01,200 --> 00:52:07,439
be performing specific<font color="#E5E5E5"> operations in the</font>

1487
00:52:04,530 --> 00:52:09,990
windows logon types you'll see here<font color="#CCCCCC"> a</font>

1488
00:52:07,440 --> 00:52:12,210
<font color="#E5E5E5">specified event type</font><font color="#CCCCCC"> two and ten event</font>

1489
00:52:09,990 --> 00:52:13,529
type two is<font color="#CCCCCC"> an interactive logon</font><font color="#E5E5E5"> as if I</font>

1490
00:52:12,210 --> 00:52:16,680
sat down<font color="#E5E5E5"> at a computer</font><font color="#CCCCCC"> and type two my</font>

1491
00:52:13,530 --> 00:52:18,630
password event type<font color="#CCCCCC"> ten is a remote</font>

1492
00:52:16,680 --> 00:52:20,250
interactive<font color="#E5E5E5"> logon and that's the event</font>

1493
00:52:18,630 --> 00:52:23,060
<font color="#E5E5E5">type that you would generate if you log</font>

1494
00:52:20,250 --> 00:52:25,350
<font color="#E5E5E5">on using let's say</font><font color="#CCCCCC"> Remote Desktop</font>

1495
00:52:23,060 --> 00:52:27,120
<font color="#CCCCCC">Network</font><font color="#E5E5E5"> logons which is what a service</font>

1496
00:52:25,350 --> 00:52:29,850
account normally uses that<font color="#E5E5E5"> would be an</font>

1497
00:52:27,120 --> 00:52:31,440
<font color="#CCCCCC">event</font><font color="#E5E5E5"> type three so you</font><font color="#CCCCCC"> could write this</font>

1498
00:52:29,850 --> 00:52:33,360
<font color="#CCCCCC">rule in two ways right</font><font color="#E5E5E5"> you can either</font>

1499
00:52:31,440 --> 00:52:34,680
say look for<font color="#CCCCCC"> two and</font><font color="#E5E5E5"> ten or you can say</font>

1500
00:52:33,360 --> 00:52:37,410
just tell<font color="#E5E5E5"> me any event type that doesn't</font>

1501
00:52:34,680 --> 00:52:38,609
<font color="#CCCCCC">match three either way again you need</font><font color="#E5E5E5"> to</font>

1502
00:52:37,410 --> 00:52:39,810
check your environment<font color="#CCCCCC"> I mean you</font>

1503
00:52:38,610 --> 00:52:40,680
shouldn't<font color="#E5E5E5"> have service accounts</font><font color="#CCCCCC"> take</font>

1504
00:52:39,810 --> 00:52:42,450
interactive logons

1505
00:52:40,680 --> 00:52:44,549
unless<font color="#E5E5E5"> you have some strange apps that</font>

1506
00:52:42,450 --> 00:52:46,200
have been<font color="#CCCCCC"> deployed but a really</font><font color="#E5E5E5"> good one</font>

1507
00:52:44,550 --> 00:52:47,820
if you've if<font color="#CCCCCC"> you've got the confirmation</font>

1508
00:52:46,200 --> 00:52:51,600
<font color="#CCCCCC">that</font><font color="#E5E5E5"> your organization uses service</font>

1509
00:52:47,820 --> 00:52:53,490
accounts appropriately this<font color="#E5E5E5"> one is a</font>

1510
00:52:51,600 --> 00:52:57,089
<font color="#E5E5E5">great one</font><font color="#CCCCCC"> for detecting to make dns</font>

1511
00:52:53,490 --> 00:52:58,560
<font color="#CCCCCC">command control so covert channels that</font>

1512
00:52:57,090 --> 00:53:02,940
<font color="#CCCCCC">attackers might use</font><font color="#E5E5E5"> for commanding</font>

1513
00:52:58,560 --> 00:53:05,340
control using<font color="#CCCCCC"> dns they like to use DNS</font>

1514
00:53:02,940 --> 00:53:07,350
requests and text records can contain

1515
00:53:05,340 --> 00:53:08,640
blobs of data so<font color="#CCCCCC"> that actually allows</font>

1516
00:53:07,350 --> 00:53:11,130
them<font color="#E5E5E5"> to transmit information more</font>

1517
00:53:08,640 --> 00:53:13,980
<font color="#CCCCCC">quickly</font><font color="#E5E5E5"> so a high volume of DNS text</font>

1518
00:53:11,130 --> 00:53:15,570
records<font color="#E5E5E5"> from</font><font color="#CCCCCC"> a specific system</font><font color="#E5E5E5"> can be a</font>

1519
00:53:13,980 --> 00:53:17,019
great indicator<font color="#E5E5E5"> that someone is deployed</font>

1520
00:53:15,570 --> 00:53:19,539
malware<font color="#E5E5E5"> that is using DNS work</font>

1521
00:53:17,019 --> 00:53:21,629
<font color="#E5E5E5">mattie control now this one is an</font>

1522
00:53:19,539 --> 00:53:25,089
example<font color="#CCCCCC"> of</font><font color="#E5E5E5"> a cobalt strike detection and</font>

1523
00:53:21,630 --> 00:53:27,329
I put this here<font color="#CCCCCC"> because I think this</font><font color="#E5E5E5"> is</font>

1524
00:53:25,089 --> 00:53:29,169
<font color="#CCCCCC">very valuable so the cobalt strike</font>

1525
00:53:27,329 --> 00:53:31,029
<font color="#CCCCCC">cupola strike for those of you who don't</font>

1526
00:53:29,169 --> 00:53:33,489
<font color="#E5E5E5">know is an attack framework similar to</font>

1527
00:53:31,029 --> 00:53:35,829
<font color="#CCCCCC">Metasploit</font><font color="#E5E5E5"> right it's a commercial tool</font>

1528
00:53:33,489 --> 00:53:38,529
<font color="#E5E5E5">however</font><font color="#CCCCCC"> the profiles that it uses to</font>

1529
00:53:35,829 --> 00:53:39,640
hide its<font color="#E5E5E5"> traffic the technology uses</font><font color="#CCCCCC"> or</font>

1530
00:53:38,529 --> 00:53:41,939
the<font color="#E5E5E5"> technique it uses is called</font>

1531
00:53:39,640 --> 00:53:45,819
malleable<font color="#CCCCCC"> c2 so the command and control</font>

1532
00:53:41,939 --> 00:53:47,799
<font color="#E5E5E5">traffic</font><font color="#CCCCCC"> of cobalt strike beacon can be</font>

1533
00:53:45,819 --> 00:53:49,179
changed<font color="#CCCCCC"> very easily</font><font color="#E5E5E5"> and there are a</font>

1534
00:53:47,799 --> 00:53:50,739
number<font color="#CCCCCC"> of profiles that the author of</font>

1535
00:53:49,179 --> 00:53:52,989
cobalt strike has published on github

1536
00:53:50,739 --> 00:53:54,609
<font color="#E5E5E5">this is an example of Amazon's</font>

1537
00:53:52,989 --> 00:53:57,459
profile and there are a<font color="#CCCCCC"> number of other</font>

1538
00:53:54,609 --> 00:53:59,769
ones<font color="#E5E5E5"> and what the profile does is it</font>

1539
00:53:57,459 --> 00:54:01,419
tells the<font color="#CCCCCC"> attack tool or the payload</font><font color="#E5E5E5"> to</font>

1540
00:53:59,769 --> 00:54:03,428
communicate in such and such<font color="#E5E5E5"> a way well</font>

1541
00:54:01,419 --> 00:54:05,288
there are specific strings that are

1542
00:54:03,429 --> 00:54:07,630
<font color="#CCCCCC">hard-coded in there and actually</font><font color="#E5E5E5"> you'll</font>

1543
00:54:05,289 --> 00:54:10,390
<font color="#CCCCCC">see I</font><font color="#E5E5E5"> have two rules on this slide the</font>

1544
00:54:07,630 --> 00:54:13,089
<font color="#CCCCCC">first rule being detect any post</font><font color="#E5E5E5"> request</font>

1545
00:54:10,390 --> 00:54:14,499
<font color="#E5E5E5">that has this specific string or any get</font>

1546
00:54:13,089 --> 00:54:17,349
request that has<font color="#E5E5E5"> this specific string in</font>

1547
00:54:14,499 --> 00:54:18,939
the URI<font color="#E5E5E5"> this will</font><font color="#CCCCCC"> only work if someone</font>

1548
00:54:17,349 --> 00:54:20,499
<font color="#E5E5E5">uses the Amazon profile</font><font color="#CCCCCC"> out-of-the-box</font>

1549
00:54:18,939 --> 00:54:23,589
but like I<font color="#CCCCCC"> said how often</font><font color="#E5E5E5"> are people</font>

1550
00:54:20,499 --> 00:54:25,359
really fiddling with these things<font color="#E5E5E5"> and</font>

1551
00:54:23,589 --> 00:54:26,349
not<font color="#E5E5E5"> that</font><font color="#CCCCCC"> often and the reality is</font><font color="#E5E5E5"> we</font>

1552
00:54:25,359 --> 00:54:28,359
should at least<font color="#E5E5E5"> be able to detect the</font>

1553
00:54:26,349 --> 00:54:29,499
ones we know about<font color="#E5E5E5"> it's kind of shooting</font>

1554
00:54:28,359 --> 00:54:31,598
ourselves in the foot<font color="#CCCCCC"> if we don't even</font>

1555
00:54:29,499 --> 00:54:34,448
go for<font color="#E5E5E5"> those ones that are public this</font>

1556
00:54:31,599 --> 00:54:35,949
<font color="#E5E5E5">one is another one</font><font color="#CCCCCC"> that's good in the</font>

1557
00:54:34,449 --> 00:54:39,059
<font color="#CCCCCC">header</font><font color="#E5E5E5"> host so the requests will</font>

1558
00:54:35,949 --> 00:54:41,589
actually be generated by the<font color="#E5E5E5"> beacon</font>

1559
00:54:39,059 --> 00:54:44,289
payload and it will actually specify the

1560
00:54:41,589 --> 00:54:46,449
host as<font color="#E5E5E5"> wwm</font><font color="#CCCCCC"> comm but of course the IP</font>

1561
00:54:44,289 --> 00:54:49,059
address associated with<font color="#E5E5E5"> it it's probably</font>

1562
00:54:46,449 --> 00:54:51,819
<font color="#E5E5E5">not gonna be the</font><font color="#CCCCCC"> organisation of Amazon</font>

1563
00:54:49,059 --> 00:54:54,399
unless they're<font color="#E5E5E5"> using Amazon AWS for</font>

1564
00:54:51,819 --> 00:54:56,380
<font color="#E5E5E5">commanding</font><font color="#CCCCCC"> control but that's something</font>

1565
00:54:54,399 --> 00:54:58,058
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you have to consider like I said</font>

1566
00:54:56,380 --> 00:54:59,469
this is one example<font color="#CCCCCC"> there's at least a</font>

1567
00:54:58,059 --> 00:55:02,139
<font color="#E5E5E5">dozen I think there might be two</font><font color="#CCCCCC"> or</font>

1568
00:54:59,469 --> 00:55:04,569
<font color="#CCCCCC">three dozen profiles on the github</font><font color="#E5E5E5"> that</font>

1569
00:55:02,139 --> 00:55:06,999
<font color="#CCCCCC">will tell you</font><font color="#E5E5E5"> you know how those</font>

1570
00:55:04,569 --> 00:55:08,109
specific profiles are<font color="#CCCCCC"> used for beacon</font><font color="#E5E5E5"> to</font>

1571
00:55:06,999 --> 00:55:10,988
communicate back and<font color="#E5E5E5"> forth and you can</font>

1572
00:55:08,109 --> 00:55:12,369
<font color="#CCCCCC">look</font><font color="#E5E5E5"> for those kinds of keywords now</font>

1573
00:55:10,989 --> 00:55:14,049
this one<font color="#CCCCCC"> okay we're getting</font><font color="#E5E5E5"> to the last</font>

1574
00:55:12,369 --> 00:55:17,049
two or<font color="#CCCCCC"> three I know we're going</font><font color="#E5E5E5"> a bit</font>

1575
00:55:14,049 --> 00:55:18,130
over<font color="#E5E5E5"> time my apologies but</font><font color="#CCCCCC"> the next one</font>

1576
00:55:17,049 --> 00:55:19,630
we're talking about is volume Shadow

1577
00:55:18,130 --> 00:55:21,309
Copy deletion this one is good for

1578
00:55:19,630 --> 00:55:22,239
detecting ransomware<font color="#CCCCCC"> if you didn't</font>

1579
00:55:21,309 --> 00:55:23,319
already<font color="#CCCCCC"> know because</font><font color="#E5E5E5"> everything's</font>

1580
00:55:22,239 --> 00:55:25,649
encrypted and<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know you're in</font><font color="#CCCCCC"> trouble</font>

1581
00:55:23,319 --> 00:55:27,729
<font color="#E5E5E5">but if you if you're in that situation</font>

1582
00:55:25,649 --> 00:55:29,109
<font color="#CCCCCC">what happens is ransomware will like to</font>

1583
00:55:27,729 --> 00:55:30,189
<font color="#E5E5E5">delete your volume Shadow Copy so you</font>

1584
00:55:29,109 --> 00:55:32,830
cannot restore<font color="#E5E5E5"> from backup</font>

1585
00:55:30,190 --> 00:55:34,660
there is a flip<font color="#CCCCCC"> side to this and I've</font>

1586
00:55:32,830 --> 00:55:35,980
<font color="#E5E5E5">mentioned</font><font color="#CCCCCC"> it in the description</font><font color="#E5E5E5"> but I</font>

1587
00:55:34,660 --> 00:55:37,870
didn't specify<font color="#E5E5E5"> this</font><font color="#CCCCCC"> as a different rule</font>

1588
00:55:35,980 --> 00:55:39,340
but attackers will also like to create

1589
00:55:37,870 --> 00:55:41,319
<font color="#CCCCCC">volume shadow copies especially in your</font>

1590
00:55:39,340 --> 00:55:42,760
<font color="#E5E5E5">domain controller so if you</font><font color="#CCCCCC"> detect a</font>

1591
00:55:41,320 --> 00:55:45,190
volume Shadow Copy creation on your

1592
00:55:42,760 --> 00:55:46,930
domain controller there's a very high

1593
00:55:45,190 --> 00:55:48,700
likelihood<font color="#CCCCCC"> the reason</font><font color="#E5E5E5"> that copy was</font><font color="#CCCCCC"> made</font>

1594
00:55:46,930 --> 00:55:51,160
is what the attacker can extract the

1595
00:55:48,700 --> 00:55:52,779
<font color="#E5E5E5">NTDs</font><font color="#CCCCCC"> it file which is the file that</font>

1596
00:55:51,160 --> 00:55:54,670
contains<font color="#CCCCCC"> the password hashes for</font><font color="#E5E5E5"> all of</font>

1597
00:55:52,780 --> 00:55:56,980
the accounts in<font color="#CCCCCC"> your domain and that</font>

1598
00:55:54,670 --> 00:55:59,050
<font color="#CCCCCC">file is</font><font color="#E5E5E5"> normally locked right that's</font>

1599
00:55:56,980 --> 00:56:00,910
normally a locked file that an attacker

1600
00:55:59,050 --> 00:56:03,820
cannot<font color="#E5E5E5"> access so they create a new</font>

1601
00:56:00,910 --> 00:56:05,560
<font color="#CCCCCC">volume</font><font color="#E5E5E5"> shadow backup or volume Shadow</font>

1602
00:56:03,820 --> 00:56:06,760
Copy<font color="#E5E5E5"> so that they can then extract the</font>

1603
00:56:05,560 --> 00:56:08,529
<font color="#E5E5E5">file and they get the most up-to-date</font>

1604
00:56:06,760 --> 00:56:12,610
hashes rather rather than<font color="#E5E5E5"> using an</font>

1605
00:56:08,530 --> 00:56:15,010
existing<font color="#CCCCCC"> Shadow</font><font color="#E5E5E5"> Copy all right</font><font color="#CCCCCC"> this one</font>

1606
00:56:12,610 --> 00:56:16,810
is<font color="#CCCCCC"> again</font><font color="#E5E5E5"> some folks</font><font color="#CCCCCC"> think it's a little</font>

1607
00:56:15,010 --> 00:56:18,520
bit lame but the point<font color="#CCCCCC"> here that</font><font color="#E5E5E5"> I'm</font>

1608
00:56:16,810 --> 00:56:21,310
<font color="#CCCCCC">trying to</font><font color="#E5E5E5"> get at is that it's important</font>

1609
00:56:18,520 --> 00:56:23,830
to<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to detect when a virus has</font>

1610
00:56:21,310 --> 00:56:25,270
<font color="#CCCCCC">been cleaned in</font><font color="#E5E5E5"> real time versus on a</font>

1611
00:56:23,830 --> 00:56:27,130
scheduled scan which means that it's

1612
00:56:25,270 --> 00:56:28,480
<font color="#E5E5E5">been there for some</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> right you might</font>

1613
00:56:27,130 --> 00:56:30,430
want<font color="#CCCCCC"> to know</font><font color="#E5E5E5"> how long it's</font><font color="#CCCCCC"> been there</font>

1614
00:56:28,480 --> 00:56:32,670
<font color="#CCCCCC">for especially depending on the kind of</font>

1615
00:56:30,430 --> 00:56:35,259
malware so here<font color="#CCCCCC"> I've specified specific</font>

1616
00:56:32,670 --> 00:56:36,670
prefixes<font color="#E5E5E5"> for types of malware</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> would be</font>

1617
00:56:35,260 --> 00:56:38,140
<font color="#E5E5E5">interested in knowing how</font><font color="#CCCCCC"> long they were</font>

1618
00:56:36,670 --> 00:56:41,470
in my environment<font color="#E5E5E5"> for example</font><font color="#CCCCCC"> if someone</font>

1619
00:56:38,140 --> 00:56:44,109
had a you know<font color="#CCCCCC"> spyware</font><font color="#E5E5E5"> on one</font><font color="#CCCCCC"> of my</font>

1620
00:56:41,470 --> 00:56:45,430
servers for<font color="#E5E5E5"> five seconds</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> a very</font>

1621
00:56:44,110 --> 00:56:47,230
different<font color="#CCCCCC"> story than</font><font color="#E5E5E5"> if it was there for</font>

1622
00:56:45,430 --> 00:56:48,669
six months<font color="#CCCCCC"> and we talked</font><font color="#E5E5E5"> about the dull</font>

1623
00:56:47,230 --> 00:56:50,500
time earlier so of course<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> very</font>

1624
00:56:48,670 --> 00:56:51,940
valuable to understand<font color="#E5E5E5"> and the last</font>

1625
00:56:50,500 --> 00:56:53,020
we're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk about actually I</font>

1626
00:56:51,940 --> 00:56:54,550
<font color="#CCCCCC">just got inspired</font><font color="#E5E5E5"> in the last talk</font>

1627
00:56:53,020 --> 00:56:56,050
<font color="#E5E5E5">because someone mentioned about those</font>

1628
00:56:54,550 --> 00:56:58,240
golden ticket attacks or<font color="#CCCCCC"> something I</font>

1629
00:56:56,050 --> 00:57:00,910
think<font color="#CCCCCC"> they</font><font color="#E5E5E5"> mentioned that but the</font><font color="#CCCCCC"> idea</font>

1630
00:56:58,240 --> 00:57:02,470
here<font color="#CCCCCC"> is that the me me cats attack tool</font>

1631
00:57:00,910 --> 00:57:05,049
or the credential theft tool me me cats

1632
00:57:02,470 --> 00:57:05,830
when it dumps<font color="#E5E5E5"> tickets to a file by</font>

1633
00:57:05,050 --> 00:57:07,480
<font color="#CCCCCC">default</font>

1634
00:57:05,830 --> 00:57:09,610
it creates a file with the dot Kirby

1635
00:57:07,480 --> 00:57:11,710
extension as far as I know there are<font color="#E5E5E5"> no</font>

1636
00:57:09,610 --> 00:57:14,950
other<font color="#E5E5E5"> uses for</font><font color="#CCCCCC"> the dot Kirby file</font>

1637
00:57:11,710 --> 00:57:17,440
extension so just being<font color="#E5E5E5"> able to detect</font>

1638
00:57:14,950 --> 00:57:19,839
the creation<font color="#E5E5E5"> of those files again it's a</font>

1639
00:57:17,440 --> 00:57:22,900
<font color="#E5E5E5">baseline</font><font color="#CCCCCC"> to be able</font><font color="#E5E5E5"> to possibly detect</font>

1640
00:57:19,840 --> 00:57:24,610
the<font color="#CCCCCC"> activity of ticket dumping I don't</font>

1641
00:57:22,900 --> 00:57:28,450
know why I wrote token dumping it should

1642
00:57:24,610 --> 00:57:30,100
be ticket and anyways<font color="#CCCCCC"> so this is to</font>

1643
00:57:28,450 --> 00:57:31,960
detect<font color="#E5E5E5"> that</font><font color="#CCCCCC"> past the ticket</font><font color="#E5E5E5"> attack</font>

1644
00:57:30,100 --> 00:57:33,640
<font color="#E5E5E5">because</font><font color="#CCCCCC"> of course</font><font color="#E5E5E5"> an attacker will try</font>

1645
00:57:31,960 --> 00:57:34,810
to dump<font color="#E5E5E5"> the ticket or create a</font><font color="#CCCCCC"> forge</font>

1646
00:57:33,640 --> 00:57:37,540
<font color="#E5E5E5">ticket on</font><font color="#CCCCCC"> your domain controller</font><font color="#E5E5E5"> and</font>

1647
00:57:34,810 --> 00:57:38,410
then they will<font color="#CCCCCC"> use that</font><font color="#E5E5E5"> in your</font>

1648
00:57:37,540 --> 00:57:40,630
<font color="#CCCCCC">environment to move throughout the</font>

1649
00:57:38,410 --> 00:57:43,000
<font color="#E5E5E5">organization that comes to the</font>

1650
00:57:40,630 --> 00:57:43,720
<font color="#CCCCCC">conclusion of the content I wanted to</font>

1651
00:57:43,000 --> 00:57:44,740
talk to you

1652
00:57:43,720 --> 00:57:46,480
today thanks everyone for<font color="#CCCCCC"> your</font><font color="#E5E5E5"> attention</font>

1653
00:57:44,740 --> 00:57:49,370
<font color="#CCCCCC">if you have any questions feel free to</font>

1654
00:57:46,480 --> 00:57:55,380
come<font color="#E5E5E5"> and find me after</font>

1655
00:57:49,370 --> 00:57:55,380
[Applause]

