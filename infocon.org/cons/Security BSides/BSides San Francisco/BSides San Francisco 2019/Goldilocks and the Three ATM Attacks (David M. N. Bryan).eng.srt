1
00:00:00,030 --> 00:00:05,759
hello good<font color="#CCCCCC"> afternoon everyone</font>

2
00:00:03,060 --> 00:00:14,820
let's welcome David from x-force<font color="#E5E5E5"> ready</font>

3
00:00:05,759 --> 00:00:16,759
to give you the 130 talk hi folks<font color="#E5E5E5"> how's</font>

4
00:00:14,820 --> 00:00:21,420
everybody doing today

5
00:00:16,760 --> 00:00:23,300
excellent excellent<font color="#E5E5E5"> good good so</font>

6
00:00:21,420 --> 00:00:26,430
hopefully<font color="#CCCCCC"> you're through right talk</font>

7
00:00:23,300 --> 00:00:29,369
<font color="#CCCCCC">Goldilocks and the three ATMs</font><font color="#E5E5E5"> does it</font>

8
00:00:26,430 --> 00:00:32,130
talk about<font color="#E5E5E5"> breaking into ATM machines a</font>

9
00:00:29,369 --> 00:00:33,540
<font color="#E5E5E5">little bit about some of</font><font color="#CCCCCC"> the controls</font>

10
00:00:32,130 --> 00:00:36,960
that<font color="#CCCCCC"> are missing</font><font color="#E5E5E5"> some of the things that</font>

11
00:00:33,540 --> 00:00:40,250
I'm seeing and<font color="#CCCCCC"> how one company lost 7</font>

12
00:00:36,960 --> 00:00:43,520
<font color="#E5E5E5">million</font><font color="#CCCCCC"> US dollars or 131 million</font>

13
00:00:40,250 --> 00:00:47,100
Mexican pesos

14
00:00:43,520 --> 00:00:51,510
tell you a little bit<font color="#CCCCCC"> about myself David</font>

15
00:00:47,100 --> 00:00:55,039
<font color="#CCCCCC">Bryan I'm an opera for thought con which</font>

16
00:00:51,510 --> 00:00:58,649
is a<font color="#CCCCCC"> Chicago</font><font color="#E5E5E5"> based hacking conference</font>

17
00:00:55,039 --> 00:01:00,449
<font color="#E5E5E5">it's pretty fun</font><font color="#CCCCCC"> it's happening pretty</font>

18
00:00:58,649 --> 00:01:03,329
<font color="#E5E5E5">soon I</font><font color="#CCCCCC"> think our tickets already</font><font color="#E5E5E5"> sold</font>

19
00:01:00,449 --> 00:01:07,380
<font color="#E5E5E5">out but you know keep us in</font><font color="#CCCCCC"> mind next</font>

20
00:01:03,329 --> 00:01:12,350
time I've also been<font color="#CCCCCC"> involved</font><font color="#E5E5E5"> with Def</font>

21
00:01:07,380 --> 00:01:14,850
Con<font color="#CCCCCC"> for</font><font color="#E5E5E5"> 20 years now</font><font color="#CCCCCC"> started</font><font color="#E5E5E5"> out doing</font>

22
00:01:12,350 --> 00:01:17,100
<font color="#E5E5E5">physical security gooning moved</font><font color="#CCCCCC"> into</font>

23
00:01:14,850 --> 00:01:19,439
<font color="#E5E5E5">network was in the into network for</font>

24
00:01:17,100 --> 00:01:22,919
quite<font color="#E5E5E5"> a while and now I actually run the</font>

25
00:01:19,439 --> 00:01:25,500
department that streams<font color="#E5E5E5"> DC TV -</font>

26
00:01:22,920 --> 00:01:27,119
everybody's hotel room<font color="#E5E5E5"> so if you ever</font>

27
00:01:25,500 --> 00:01:29,759
get<font color="#E5E5E5"> to sit and watch the hotel rooms in</font>

28
00:01:27,119 --> 00:01:33,320
<font color="#CCCCCC">your or</font><font color="#E5E5E5"> the talks in your hotel room</font><font color="#CCCCCC"> you</font>

29
00:01:29,759 --> 00:01:33,320
<font color="#CCCCCC">can thank the</font><font color="#E5E5E5"> team that I'm</font><font color="#CCCCCC"> working with</font>

30
00:01:33,470 --> 00:01:38,908
<font color="#CCCCCC">also tour</font><font color="#E5E5E5"> camp is a really great thing</font>

31
00:01:36,270 --> 00:01:41,130
that<font color="#E5E5E5"> happens every</font><font color="#CCCCCC"> other year I'm I'm</font>

32
00:01:38,909 --> 00:01:42,299
<font color="#E5E5E5">really proud of it I'm I'm participant</font>

33
00:01:41,130 --> 00:01:45,240
there I think<font color="#E5E5E5"> it's really important to</font>

34
00:01:42,299 --> 00:01:47,430
<font color="#CCCCCC">be</font><font color="#E5E5E5"> part of the community and if you</font>

35
00:01:45,240 --> 00:01:51,240
haven't participate in<font color="#E5E5E5"> your local</font><font color="#CCCCCC"> DEFCON</font>

36
00:01:47,430 --> 00:01:54,689
groups<font color="#CCCCCC"> dc-6</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> to was one that I</font>

37
00:01:51,240 --> 00:01:56,759
<font color="#CCCCCC">started 10 years</font><font color="#E5E5E5"> ago and has been going</font>

38
00:01:54,689 --> 00:01:58,710
<font color="#CCCCCC">strong ever since</font><font color="#E5E5E5"> it's actually it's a</font>

39
00:01:56,759 --> 00:02:01,189
really<font color="#CCCCCC"> good way to meet</font><font color="#E5E5E5"> other</font><font color="#CCCCCC"> people in</font>

40
00:01:58,710 --> 00:02:06,770
<font color="#E5E5E5">your community it's a good way to</font>

41
00:02:01,189 --> 00:02:09,769
network<font color="#E5E5E5"> find jobs find out about threats</font>

42
00:02:06,770 --> 00:02:09,769
<font color="#E5E5E5">etc</font>

43
00:02:10,310 --> 00:02:18,800
I also really am frustrated<font color="#E5E5E5"> with how a</font>

44
00:02:16,240 --> 00:02:22,430
lot of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Internet</font><font color="#E5E5E5"> service providers</font>

45
00:02:18,800 --> 00:02:24,440
are treating privacy and<font color="#E5E5E5"> net</font><font color="#CCCCCC"> neutrality</font>

46
00:02:22,430 --> 00:02:24,950
<font color="#E5E5E5">right</font><font color="#CCCCCC"> they're kind of going out the</font>

47
00:02:24,440 --> 00:02:28,150
window

48
00:02:24,950 --> 00:02:31,549
so I started a<font color="#E5E5E5"> wireless ISP in Minnesota</font>

49
00:02:28,150 --> 00:02:36,020
<font color="#E5E5E5">because I wanted</font><font color="#CCCCCC"> to have some option for</font>

50
00:02:31,550 --> 00:02:41,300
people<font color="#E5E5E5"> in my neighborhood to have better</font>

51
00:02:36,020 --> 00:02:44,630
internet<font color="#CCCCCC"> I also work</font><font color="#E5E5E5"> for a company</font>

52
00:02:41,300 --> 00:02:46,460
called IBM<font color="#CCCCCC"> I they've been around for a</font>

53
00:02:44,630 --> 00:02:49,340
<font color="#CCCCCC">while</font>

54
00:02:46,460 --> 00:02:51,500
however x-force<font color="#E5E5E5"> red is a new group</font>

55
00:02:49,340 --> 00:02:55,550
<font color="#E5E5E5">inside of IBM</font><font color="#CCCCCC"> we've</font><font color="#E5E5E5"> only been around for</font>

56
00:02:51,500 --> 00:02:58,790
<font color="#CCCCCC">three years</font><font color="#E5E5E5"> it's basically a pen testing</font>

57
00:02:55,550 --> 00:03:02,870
<font color="#E5E5E5">group it's pretty fun pretty pretty</font>

58
00:02:58,790 --> 00:03:06,350
crazy stuff<font color="#CCCCCC"> that we see so this this</font>

59
00:03:02,870 --> 00:03:09,200
talk if you guys want there's some seats

60
00:03:06,350 --> 00:03:12,880
down<font color="#CCCCCC"> upfront</font><font color="#E5E5E5"> here and I think I see a</font>

61
00:03:09,200 --> 00:03:19,720
few kind of<font color="#CCCCCC"> in between</font><font color="#E5E5E5"> up up in the</font>

62
00:03:12,880 --> 00:03:22,250
third and fourth row<font color="#E5E5E5"> so in this case</font>

63
00:03:19,720 --> 00:03:27,770
when I submitted<font color="#E5E5E5"> this talk it was three</font>

64
00:03:22,250 --> 00:03:31,640
as of two<font color="#CCCCCC"> weeks</font><font color="#E5E5E5"> ago it's now four I'm</font>

65
00:03:27,770 --> 00:03:34,450
gonna give<font color="#E5E5E5"> each of the</font><font color="#CCCCCC"> ATMs</font><font color="#E5E5E5"> designation</font>

66
00:03:31,640 --> 00:03:36,738
of ATM alpha Bravo Charlie and Delta

67
00:03:34,450 --> 00:03:39,980
<font color="#E5E5E5">pretty much so that they're anonymous</font>

68
00:03:36,739 --> 00:03:43,000
instead of being named out I don't<font color="#E5E5E5"> want</font>

69
00:03:39,980 --> 00:03:43,000
to call out<font color="#E5E5E5"> any of the offenders</font>

70
00:03:44,120 --> 00:03:49,510
I'm not gonna<font color="#E5E5E5"> read the slide there but</font>

71
00:03:46,220 --> 00:03:52,760
essentially it it was it was<font color="#CCCCCC"> interesting</font>

72
00:03:49,510 --> 00:03:54,709
<font color="#E5E5E5">you know we had some ATMs that had very</font>

73
00:03:52,760 --> 00:03:57,320
strong security<font color="#E5E5E5"> they actually locked the</font>

74
00:03:54,709 --> 00:04:00,170
stuff down<font color="#E5E5E5"> and we had some ATMs that</font>

75
00:03:57,320 --> 00:04:02,510
assumed that the security<font color="#E5E5E5"> software that</font>

76
00:04:00,170 --> 00:04:05,109
was<font color="#E5E5E5"> installed was actually going to</font>

77
00:04:02,510 --> 00:04:09,230
prevent a<font color="#E5E5E5"> lot of the attacks that we</font><font color="#CCCCCC"> ran</font>

78
00:04:05,110 --> 00:04:12,410
and that's not the case<font color="#E5E5E5"> and then the</font>

79
00:04:09,230 --> 00:04:15,679
<font color="#E5E5E5">last couple</font><font color="#CCCCCC"> talked about some physical</font>

80
00:04:12,410 --> 00:04:18,728
<font color="#E5E5E5">some electronic but much more physical</font>

81
00:04:15,680 --> 00:04:18,728
controls<font color="#E5E5E5"> right</font>

82
00:04:20,298 --> 00:04:30,659
some of the flaws we found in one<font color="#CCCCCC"> of the</font>

83
00:04:26,250 --> 00:04:35,880
ATMs<font color="#CCCCCC"> with</font><font color="#E5E5E5"> two UDP packets we're actually</font>

84
00:04:30,660 --> 00:04:37,680
able to compromise the system<font color="#CCCCCC"> in</font><font color="#E5E5E5"> ATM</font>

85
00:04:35,880 --> 00:04:39,450
Bravo

86
00:04:37,680 --> 00:04:41,880
because they hadn't patched the system

87
00:04:39,450 --> 00:04:45,000
right<font color="#E5E5E5"> it was it was a vulnerable to</font>

88
00:04:41,880 --> 00:04:47,310
eternal blue which is<font color="#E5E5E5"> almost two years</font>

89
00:04:45,000 --> 00:04:51,420
out of date<font color="#CCCCCC"> for</font><font color="#E5E5E5"> patches that's insane</font>

90
00:04:47,310 --> 00:04:54,020
to have a Windows machine that is that

91
00:04:51,420 --> 00:04:54,020
far out<font color="#E5E5E5"> of date</font>

92
00:04:54,240 --> 00:05:01,800
<font color="#E5E5E5">ATM</font><font color="#CCCCCC"> Charlie as we will call it had some</font>

93
00:04:59,820 --> 00:05:06,780
really<font color="#E5E5E5"> poor physical</font><font color="#CCCCCC"> security around the</font>

94
00:05:01,800 --> 00:05:08,790
computer compartment<font color="#E5E5E5"> right</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> did have</font>

95
00:05:06,780 --> 00:05:12,960
a<font color="#E5E5E5"> little</font><font color="#CCCCCC"> bit of a problem with their</font>

96
00:05:08,790 --> 00:05:22,530
full disk encryption<font color="#CCCCCC"> and thus they had</font>

97
00:05:12,960 --> 00:05:25,229
millions in cash stolen so ATM a this

98
00:05:22,530 --> 00:05:27,109
was actually an ATM<font color="#CCCCCC"> that they had gone</font>

99
00:05:25,230 --> 00:05:31,140
through<font color="#CCCCCC"> and they had hardened the OS</font>

100
00:05:27,110 --> 00:05:32,970
there was I think<font color="#CCCCCC"> all but two services</font>

101
00:05:31,140 --> 00:05:37,349
listening on the machine<font color="#E5E5E5"> they had</font>

102
00:05:32,970 --> 00:05:39,240
<font color="#E5E5E5">actually disabled</font><font color="#CCCCCC"> SMB and and anything</font>

103
00:05:37,350 --> 00:05:44,580
that<font color="#E5E5E5"> an attacker could potentially</font>

104
00:05:39,240 --> 00:05:46,830
<font color="#CCCCCC">leverage it was quite a feat and the ATM</font>

105
00:05:44,580 --> 00:05:48,750
software itself was not<font color="#E5E5E5"> running as a</font>

106
00:05:46,830 --> 00:05:51,570
privileged user<font color="#E5E5E5"> was an unprivileged user</font>

107
00:05:48,750 --> 00:05:54,090
that the ATM software was running on

108
00:05:51,570 --> 00:05:55,560
<font color="#CCCCCC">would which</font><font color="#E5E5E5"> is uncommon most of the</font>

109
00:05:54,090 --> 00:05:58,140
times when we see<font color="#E5E5E5"> these devices that</font><font color="#CCCCCC"> are</font>

110
00:05:55,560 --> 00:06:00,300
doing kiosks or some sort of function

111
00:05:58,140 --> 00:06:02,310
<font color="#E5E5E5">like this the software that's actually</font>

112
00:06:00,300 --> 00:06:07,950
dispensing the cash is running<font color="#CCCCCC"> his admin</font>

113
00:06:02,310 --> 00:06:09,930
which is unfortunate<font color="#CCCCCC"> it didn't use full</font>

114
00:06:07,950 --> 00:06:12,180
disk encryption<font color="#CCCCCC"> right and so that was a</font>

115
00:06:09,930 --> 00:06:13,770
that's a<font color="#E5E5E5"> big risk to me right from</font><font color="#CCCCCC"> the</font>

116
00:06:12,180 --> 00:06:15,960
<font color="#E5E5E5">perspective</font><font color="#CCCCCC"> that these</font><font color="#E5E5E5"> could be anywhere</font>

117
00:06:13,770 --> 00:06:18,210
<font color="#CCCCCC">you don't</font><font color="#E5E5E5"> know what your</font><font color="#CCCCCC"> taxon Aereo is</font>

118
00:06:15,960 --> 00:06:20,190
<font color="#E5E5E5">gonna be if they gain access to the hard</font>

119
00:06:18,210 --> 00:06:21,630
drive<font color="#E5E5E5"> you know they're they're now going</font>

120
00:06:20,190 --> 00:06:25,620
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be able to clone and write to the</font>

121
00:06:21,630 --> 00:06:27,540
data to<font color="#E5E5E5"> the disk or whatever we're also</font>

122
00:06:25,620 --> 00:06:29,550
able<font color="#E5E5E5"> to boot from our own operating</font>

123
00:06:27,540 --> 00:06:33,030
systems so we could throw a<font color="#CCCCCC"> Kali boot in</font>

124
00:06:29,550 --> 00:06:35,810
it<font color="#E5E5E5"> boot it up dump the SMB password pull</font>

125
00:06:33,030 --> 00:06:35,809
it out move

126
00:06:37,530 --> 00:06:45,010
and we had<font color="#CCCCCC"> a TM</font><font color="#E5E5E5"> bravo this ATM was</font>

127
00:06:41,890 --> 00:06:47,530
definitely super easy to<font color="#E5E5E5"> compromise</font>

128
00:06:45,010 --> 00:06:51,849
right<font color="#E5E5E5"> without having</font><font color="#CCCCCC"> to open</font><font color="#E5E5E5"> the box or</font>

129
00:06:47,530 --> 00:06:53,070
even<font color="#E5E5E5"> gain access to anything physical</font><font color="#CCCCCC"> we</font>

130
00:06:51,850 --> 00:06:57,270
could plug into the network<font color="#CCCCCC"> and</font>

131
00:06:53,070 --> 00:07:00,190
basically run eternal blue attacks

132
00:06:57,270 --> 00:07:02,280
against this machine<font color="#CCCCCC"> and compromise it</font>

133
00:07:00,190 --> 00:07:05,110
it was it was pretty bad

134
00:07:02,280 --> 00:07:06,520
the other thing is the ATM software was

135
00:07:05,110 --> 00:07:09,280
running as administrator

136
00:07:06,520 --> 00:07:12,359
<font color="#E5E5E5">right so there was no separation of</font>

137
00:07:09,280 --> 00:07:15,010
privileges if I had gotten<font color="#CCCCCC"> access to the</font>

138
00:07:12,360 --> 00:07:18,760
the maintenance window or maintenance

139
00:07:15,010 --> 00:07:20,349
computer<font color="#CCCCCC"> or screen I should say screen</font>

140
00:07:18,760 --> 00:07:22,539
or display there's essentially a

141
00:07:20,350 --> 00:07:25,240
maintenance display that flips out

142
00:07:22,540 --> 00:07:27,010
you can plug<font color="#E5E5E5"> a USB Drive in it's game</font>

143
00:07:25,240 --> 00:07:31,810
<font color="#CCCCCC">over</font><font color="#E5E5E5"> right there's no separation of</font>

144
00:07:27,010 --> 00:07:32,680
duties<font color="#E5E5E5"> or separation of privileges now</font>

145
00:07:31,810 --> 00:07:35,410
we were able<font color="#E5E5E5"> to pull the drive out</font>

146
00:07:32,680 --> 00:07:38,110
<font color="#E5E5E5">obviously and mount it again not using</font>

147
00:07:35,410 --> 00:07:45,640
full disk encryption<font color="#CCCCCC"> it was just it</font><font color="#E5E5E5"> was</font>

148
00:07:38,110 --> 00:07:50,470
really<font color="#E5E5E5"> bad</font><font color="#CCCCCC"> ATM charlie was actually a</font>

149
00:07:45,640 --> 00:07:52,780
lot better<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this case they had they</font>

150
00:07:50,470 --> 00:07:54,940
had gone<font color="#E5E5E5"> through</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> hardened system they</font>

151
00:07:52,780 --> 00:07:57,640
had<font color="#E5E5E5"> antivirus software actually deployed</font>

152
00:07:54,940 --> 00:08:00,370
on this<font color="#E5E5E5"> system they had</font><font color="#CCCCCC"> something called</font>

153
00:07:57,640 --> 00:08:02,979
<font color="#CCCCCC">gvm checker</font><font color="#E5E5E5"> which is a company that's</font>

154
00:08:00,370 --> 00:08:06,220
<font color="#E5E5E5">put</font><font color="#CCCCCC"> out this</font><font color="#E5E5E5"> software specifically for</font>

155
00:08:02,980 --> 00:08:08,020
ATMs to<font color="#E5E5E5"> lock down ATMs</font>

156
00:08:06,220 --> 00:08:11,230
right there's they do full disk

157
00:08:08,020 --> 00:08:11,710
encryption for<font color="#E5E5E5"> them they'll lock out USB</font>

158
00:08:11,230 --> 00:08:16,120
<font color="#CCCCCC">HIDs</font>

159
00:08:11,710 --> 00:08:17,739
and this is a pre boot control<font color="#E5E5E5"> right so</font>

160
00:08:16,120 --> 00:08:20,050
pre boot means that<font color="#E5E5E5"> before Windows</font>

161
00:08:17,740 --> 00:08:22,510
actually starts booting it loads a linic

162
00:08:20,050 --> 00:08:24,700
little tiny<font color="#E5E5E5"> Linux kernel that then locks</font>

163
00:08:22,510 --> 00:08:27,340
down<font color="#CCCCCC"> the USB devices and then loads</font>

164
00:08:24,700 --> 00:08:32,348
<font color="#CCCCCC">windows I</font><font color="#E5E5E5"> was actually quite impressed</font>

165
00:08:27,340 --> 00:08:34,809
with<font color="#E5E5E5"> it because we couldn't couldn't</font>

166
00:08:32,349 --> 00:08:37,150
<font color="#CCCCCC">mount the drive</font><font color="#E5E5E5"> to start out with</font>

167
00:08:34,809 --> 00:08:39,760
couldn't boot from<font color="#E5E5E5"> our own OS all the</font>

168
00:08:37,150 --> 00:08:42,189
network<font color="#E5E5E5"> traffic was encrypted</font><font color="#CCCCCC"> but they</font>

169
00:08:39,760 --> 00:08:42,909
had this problem<font color="#CCCCCC"> that's pretty big</font>

170
00:08:42,190 --> 00:08:46,670
problem

171
00:08:42,909 --> 00:08:52,610
where they had lost a ton of money

172
00:08:46,670 --> 00:08:54,290
and in fact we<font color="#E5E5E5"> went out on</font><font color="#CCCCCC"> site</font><font color="#E5E5E5"> to one</font>

173
00:08:52,610 --> 00:08:59,450
of the grocery stores where<font color="#E5E5E5"> this their</font>

174
00:08:54,290 --> 00:09:01,849
ATMs were deployed<font color="#E5E5E5"> and basically I'd</font>

175
00:08:59,450 --> 00:09:05,930
identified an issue<font color="#E5E5E5"> and I'll show you</font>

176
00:09:01,850 --> 00:09:07,550
<font color="#E5E5E5">the issue in a little bit here but you</font>

177
00:09:05,930 --> 00:09:10,390
know they had all<font color="#E5E5E5"> these ATMs sitting</font>

178
00:09:07,550 --> 00:09:13,490
empty<font color="#E5E5E5"> with</font><font color="#CCCCCC"> no cash in them right because</font>

179
00:09:10,390 --> 00:09:16,310
<font color="#E5E5E5">they had a risk</font><font color="#CCCCCC"> a huge risk that it</font>

180
00:09:13,490 --> 00:09:17,149
already<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> they'd hit 100 over 100</font>

181
00:09:16,310 --> 00:09:24,709
ATMs

182
00:09:17,149 --> 00:09:26,180
at this point<font color="#E5E5E5"> all right so ATM a right</font>

183
00:09:24,709 --> 00:09:29,390
<font color="#CCCCCC">ATM</font><font color="#E5E5E5"> alpha this is</font><font color="#CCCCCC"> the one they said was</font>

184
00:09:26,180 --> 00:09:33,290
<font color="#E5E5E5">hardened</font><font color="#CCCCCC"> I were</font><font color="#E5E5E5"> able to boot it into</font>

185
00:09:29,390 --> 00:09:36,290
<font color="#E5E5E5">Kali</font><font color="#CCCCCC"> dump the Sam files we also found</font>

186
00:09:33,290 --> 00:09:39,890
the admin password in log files<font color="#E5E5E5"> right</font>

187
00:09:36,290 --> 00:09:42,110
this is like security 101<font color="#CCCCCC"> stop writing</font>

188
00:09:39,890 --> 00:09:44,360
passwords to log files<font color="#CCCCCC"> stop writing</font>

189
00:09:42,110 --> 00:09:48,980
passwords to log files<font color="#CCCCCC"> stop writing</font>

190
00:09:44,360 --> 00:09:52,959
passwords to log files<font color="#CCCCCC"> we also pulled a</font>

191
00:09:48,980 --> 00:09:55,760
binary<font color="#E5E5E5"> the binary was a custom written</font>

192
00:09:52,959 --> 00:09:58,609
application specifically<font color="#E5E5E5"> for this ATM</font>

193
00:09:55,760 --> 00:10:02,269
<font color="#CCCCCC">and it was a management</font><font color="#E5E5E5"> app that the</font>

194
00:09:58,610 --> 00:10:04,040
company who<font color="#E5E5E5"> created the ATM made so they</font>

195
00:10:02,269 --> 00:10:08,120
could<font color="#E5E5E5"> deploy patches so they could do</font>

196
00:10:04,040 --> 00:10:09,529
<font color="#E5E5E5">maintenance all sorts of stuff we pulled</font>

197
00:10:08,120 --> 00:10:15,470
the binary off of it and we started

198
00:10:09,529 --> 00:10:17,480
reversing it<font color="#CCCCCC"> and we were on site</font><font color="#E5E5E5"> for two</font>

199
00:10:15,470 --> 00:10:22,490
weeks<font color="#E5E5E5"> right</font><font color="#CCCCCC"> you know in this in this</font>

200
00:10:17,480 --> 00:10:26,089
case<font color="#CCCCCC"> this was an</font><font color="#E5E5E5"> ATM in Japan so you</font>

201
00:10:22,490 --> 00:10:27,500
know it was it<font color="#E5E5E5"> was a good time but you</font>

202
00:10:26,089 --> 00:10:29,180
<font color="#E5E5E5">know you're away from your family for</font>

203
00:10:27,500 --> 00:10:31,269
two weeks it gets to be a little<font color="#E5E5E5"> long</font>

204
00:10:29,180 --> 00:10:33,969
anyway

205
00:10:31,269 --> 00:10:37,880
<font color="#E5E5E5">in this case my coworker John hoops</font>

206
00:10:33,970 --> 00:10:40,310
<font color="#E5E5E5">started going through</font><font color="#CCCCCC"> used</font><font color="#E5E5E5"> Ida Pro to</font>

207
00:10:37,880 --> 00:10:42,470
sort<font color="#E5E5E5"> of watch the memory and watch how</font>

208
00:10:40,310 --> 00:10:44,390
stuff was flowing was like he's like I

209
00:10:42,470 --> 00:10:46,880
think<font color="#E5E5E5"> there's a problem here so he pulls</font>

210
00:10:44,390 --> 00:10:50,660
up a decompiler goes through and figures

211
00:10:46,880 --> 00:10:52,699
out<font color="#CCCCCC"> that there's a certain offset</font><font color="#E5E5E5"> that</font>

212
00:10:50,660 --> 00:10:55,339
the software looks for a byte offset in

213
00:10:52,699 --> 00:10:58,060
a packet and if you just bypass<font color="#E5E5E5"> that at</font>

214
00:10:55,339 --> 00:11:03,340
some point<font color="#E5E5E5"> it just runs the command</font>

215
00:10:58,060 --> 00:11:05,290
so you know we<font color="#E5E5E5"> only had</font><font color="#CCCCCC"> 1,500 or 1,400</font>

216
00:11:03,340 --> 00:11:08,230
<font color="#CCCCCC">bytes to be able to</font><font color="#E5E5E5"> send a payload to</font>

217
00:11:05,290 --> 00:11:10,120
<font color="#CCCCCC">this</font><font color="#E5E5E5"> machine</font><font color="#CCCCCC"> so thus why we have two</font>

218
00:11:08,230 --> 00:11:13,150
packets the first packet is hey go

219
00:11:10,120 --> 00:11:19,140
download<font color="#E5E5E5"> this second packet is hey run</font>

220
00:11:13,150 --> 00:11:19,140
what I<font color="#E5E5E5"> just downloaded it's pretty bad</font>

221
00:11:22,680 --> 00:11:27,550
so in this case even<font color="#E5E5E5"> though we've</font>

222
00:11:25,750 --> 00:11:30,040
hardened<font color="#CCCCCC"> this system</font><font color="#E5E5E5"> there was some</font>

223
00:11:27,550 --> 00:11:31,870
pretty immense flaws in the management

224
00:11:30,040 --> 00:11:38,439
software that<font color="#E5E5E5"> obviously hadn't been</font>

225
00:11:31,870 --> 00:11:41,140
reviewed I talked about all this stuff

226
00:11:38,440 --> 00:11:43,810
<font color="#E5E5E5">well okay so the other component is the</font>

227
00:11:41,140 --> 00:11:46,050
front end was<font color="#E5E5E5"> a flash app right it's a</font>

228
00:11:43,810 --> 00:11:49,150
flash app that runs inside<font color="#CCCCCC"> the ATM and</font>

229
00:11:46,050 --> 00:11:51,189
then<font color="#CCCCCC"> there's a java web application that</font>

230
00:11:49,150 --> 00:11:53,920
this<font color="#E5E5E5"> flash app would actually post to</font>

231
00:11:51,190 --> 00:11:55,720
and that's<font color="#E5E5E5"> the thing that would the Java</font>

232
00:11:53,920 --> 00:12:01,719
app is the thing that<font color="#CCCCCC"> would actually</font>

233
00:11:55,720 --> 00:12:04,870
dispense cash thankfully<font color="#CCCCCC"> they had</font><font color="#E5E5E5"> left</font>

234
00:12:01,720 --> 00:12:06,790
<font color="#E5E5E5">behind the debugger tool so</font><font color="#CCCCCC"> we could</font>

235
00:12:04,870 --> 00:12:09,550
pull up the debugger tool and<font color="#E5E5E5"> just trap</font>

236
00:12:06,790 --> 00:12:13,569
the time where<font color="#E5E5E5"> it says hey dispense this</font>

237
00:12:09,550 --> 00:12:16,630
cash<font color="#E5E5E5"> or vice-versa hey I've given you</font>

238
00:12:13,570 --> 00:12:19,690
this cash<font color="#CCCCCC"> like let's say I</font><font color="#E5E5E5"> put in a</font>

239
00:12:16,630 --> 00:12:22,780
certain<font color="#E5E5E5"> denomination of bills I can now</font>

240
00:12:19,690 --> 00:12:25,420
<font color="#E5E5E5">just multiply that and post it to</font><font color="#CCCCCC"> their</font>

241
00:12:22,780 --> 00:12:27,610
back-end<font color="#E5E5E5"> servers so now all of</font><font color="#CCCCCC"> a sudden</font>

242
00:12:25,420 --> 00:12:29,709
<font color="#CCCCCC">instead of having</font><font color="#E5E5E5"> a million dollars in</font>

243
00:12:27,610 --> 00:12:31,750
<font color="#E5E5E5">my bank account</font><font color="#CCCCCC"> err thousand dollars</font>

244
00:12:29,710 --> 00:12:34,150
right<font color="#CCCCCC"> I can</font><font color="#E5E5E5"> have ten thousand or a</font>

245
00:12:31,750 --> 00:12:39,640
hundred thousand right just by<font color="#CCCCCC"> changing</font>

246
00:12:34,150 --> 00:12:42,100
that<font color="#E5E5E5"> multiplier an example Java debugger</font>

247
00:12:39,640 --> 00:12:45,520
is this<font color="#E5E5E5"> right basically be able</font><font color="#CCCCCC"> to go</font>

248
00:12:42,100 --> 00:12:47,890
through the code<font color="#E5E5E5"> set a breakpoint</font><font color="#CCCCCC"> when</font>

249
00:12:45,520 --> 00:12:52,470
you're at<font color="#CCCCCC"> that breakpoint</font><font color="#E5E5E5"> come up and</font>

250
00:12:47,890 --> 00:12:52,470
prompt me for<font color="#E5E5E5"> an input</font>

251
00:13:01,220 --> 00:13:09,059
we found all<font color="#CCCCCC"> sorts of other issues</font><font color="#E5E5E5"> with</font>

252
00:13:04,259 --> 00:13:13,439
this particular<font color="#CCCCCC"> ATM</font><font color="#E5E5E5"> logs weren't being</font>

253
00:13:09,059 --> 00:13:16,529
<font color="#CCCCCC">encrypted logs</font><font color="#E5E5E5"> were trusting the time on</font>

254
00:13:13,439 --> 00:13:19,738
the ATM right<font color="#CCCCCC"> I mean there's all sorts</font>

255
00:13:16,529 --> 00:13:23,359
of like inconsistencies with how these

256
00:13:19,739 --> 00:13:26,069
systems<font color="#E5E5E5"> are set up it's pretty bad</font><font color="#CCCCCC"> I</font>

257
00:13:23,359 --> 00:13:29,129
think they're only<font color="#E5E5E5"> saving grace</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> ATM</font>

258
00:13:26,069 --> 00:13:31,409
off alpha and<font color="#E5E5E5"> Bravo was that they're</font>

259
00:13:29,129 --> 00:13:34,649
using<font color="#E5E5E5"> what's called the buy lock right</font>

260
00:13:31,409 --> 00:13:37,349
<font color="#E5E5E5">it uses sidebar technology to prevent</font>

261
00:13:34,649 --> 00:13:40,289
picking it's fairly pick resistant<font color="#E5E5E5"> you</font>

262
00:13:37,349 --> 00:13:42,059
know<font color="#E5E5E5"> I could probably spend a couple</font>

263
00:13:40,289 --> 00:13:49,289
hours trying<font color="#E5E5E5"> to pick open this lock and</font>

264
00:13:42,059 --> 00:13:50,879
<font color="#CCCCCC">I may</font><font color="#E5E5E5"> not get it that said like I said</font>

265
00:13:49,289 --> 00:13:56,059
<font color="#E5E5E5">we were on site for two weeks for this</font>

266
00:13:50,879 --> 00:14:00,109
one engagement<font color="#E5E5E5"> we got a little bored and</font>

267
00:13:56,059 --> 00:14:03,509
that<font color="#CCCCCC"> week</font><font color="#E5E5E5"> that we were on site our</font>

268
00:14:00,109 --> 00:14:06,149
president was on national<font color="#CCCCCC"> news with</font><font color="#E5E5E5"> this</font>

269
00:14:03,509 --> 00:14:08,100
<font color="#E5E5E5">segment and we decided that we will</font>

270
00:14:06,149 --> 00:14:19,199
we've compromised<font color="#E5E5E5"> this ATM we should</font>

271
00:14:08,100 --> 00:14:21,899
probably put<font color="#E5E5E5"> this up on the screen so we</font>

272
00:14:19,199 --> 00:14:24,508
<font color="#CCCCCC">replaced the flash video archive that</font>

273
00:14:21,899 --> 00:14:28,169
<font color="#CCCCCC">showed please take</font><font color="#E5E5E5"> your cash with one of</font>

274
00:14:24,509 --> 00:14:29,669
our own videos basically<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> what was</font>

275
00:14:28,169 --> 00:14:34,919
going<font color="#CCCCCC"> on there that is from the actual</font>

276
00:14:29,669 --> 00:14:37,649
ATM<font color="#E5E5E5"> it was pretty fun all</font><font color="#CCCCCC"> right so let's</font>

277
00:14:34,919 --> 00:14:39,629
go back to<font color="#E5E5E5"> ATM see right talking about</font>

278
00:14:37,649 --> 00:14:44,879
<font color="#E5E5E5">it's got basically</font><font color="#CCCCCC"> everything that</font><font color="#E5E5E5"> we</font>

279
00:14:39,629 --> 00:14:48,569
want<font color="#E5E5E5"> right</font><font color="#CCCCCC"> system is hardened</font><font color="#E5E5E5"> antivirus</font>

280
00:14:44,879 --> 00:14:49,919
<font color="#E5E5E5">it's got this like control</font><font color="#CCCCCC"> software that</font>

281
00:14:48,569 --> 00:14:53,159
actually<font color="#CCCCCC"> goes through and locks down the</font>

282
00:14:49,919 --> 00:14:54,899
ATM<font color="#E5E5E5"> locks down the</font><font color="#CCCCCC"> USB HIDs</font><font color="#E5E5E5"> how could</font>

283
00:14:53,159 --> 00:15:01,169
they have stolen<font color="#CCCCCC"> seven million dollars</font>

284
00:14:54,899 --> 00:15:04,799
from this machine<font color="#CCCCCC"> right does anybody</font>

285
00:15:01,169 --> 00:15:07,730
know what type of<font color="#E5E5E5"> lock this is I see one</font>

286
00:15:04,799 --> 00:15:12,050
<font color="#E5E5E5">hand is anybody awake</font>

287
00:15:07,730 --> 00:15:14,610
<font color="#E5E5E5">okay good good so this is a wafer lock</font>

288
00:15:12,050 --> 00:15:16,709
<font color="#CCCCCC">and this</font><font color="#E5E5E5"> is the lock that was used to</font>

289
00:15:14,610 --> 00:15:21,350
<font color="#E5E5E5">protect the computer compartment of ATM</font>

290
00:15:16,710 --> 00:15:27,750
<font color="#E5E5E5">charlie right this is insane it takes</font>

291
00:15:21,350 --> 00:15:30,060
seconds<font color="#E5E5E5"> to open this lock right</font><font color="#CCCCCC"> the</font>

292
00:15:27,750 --> 00:15:33,390
other problem is this<font color="#CCCCCC"> GBM checker</font>

293
00:15:30,060 --> 00:15:35,069
software allows the user to say just use

294
00:15:33,390 --> 00:15:37,949
the hardware<font color="#E5E5E5"> to generate the hard drive</font>

295
00:15:35,070 --> 00:15:50,220
of the full disk encryption key<font color="#E5E5E5"> does</font>

296
00:15:37,950 --> 00:15:54,630
anybody<font color="#E5E5E5"> see a problem with</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so what</font>

297
00:15:50,220 --> 00:15:58,410
<font color="#E5E5E5">we think happened they had</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> pop-up</font>

298
00:15:54,630 --> 00:16:01,320
<font color="#CCCCCC">event like a tent event</font><font color="#E5E5E5"> and the this</font>

299
00:15:58,410 --> 00:16:04,829
company<font color="#E5E5E5"> that we did the work for brought</font>

300
00:16:01,320 --> 00:16:08,010
these ATMs on site<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> end of the</font>

301
00:16:04,830 --> 00:16:10,640
event<font color="#E5E5E5"> tents were torn down loaded on the</font>

302
00:16:08,010 --> 00:16:17,910
truck<font color="#E5E5E5"> ATMs were loaded on the truck and</font>

303
00:16:10,640 --> 00:16:20,580
the truck<font color="#E5E5E5"> was stolen so what I'm</font>

304
00:16:17,910 --> 00:16:23,280
assuming<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that these</font><font color="#E5E5E5"> criminals are</font>

305
00:16:20,580 --> 00:16:25,560
actually taking<font color="#E5E5E5"> these drives and running</font>

306
00:16:23,280 --> 00:16:28,829
to<font color="#E5E5E5"> the ATMs with that they had stolen</font>

307
00:16:25,560 --> 00:16:33,300
<font color="#E5E5E5">putting the drives in and</font><font color="#CCCCCC"> sideloading</font>

308
00:16:28,830 --> 00:16:35,600
<font color="#E5E5E5">their malware right it was it's pretty</font>

309
00:16:33,300 --> 00:16:35,599
interesting

310
00:16:46,090 --> 00:16:51,160
so here's a security<font color="#E5E5E5"> law here's a lock</font>

311
00:16:48,490 --> 00:16:53,440
on this this<font color="#E5E5E5"> ATM it's super easy to</font>

312
00:16:51,160 --> 00:17:02,800
<font color="#CCCCCC">bypass that little</font><font color="#E5E5E5"> flippity bit there</font>

313
00:16:53,440 --> 00:17:05,410
<font color="#E5E5E5">and then this is me picking it yeah take</font>

314
00:17:02,800 --> 00:17:09,280
seconds<font color="#E5E5E5"> right and then this is</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> the</font>

315
00:17:05,410 --> 00:17:11,170
front<font color="#E5E5E5"> cover of this ATM again this is</font>

316
00:17:09,280 --> 00:17:13,139
the wafer lock<font color="#CCCCCC"> technology right like if</font>

317
00:17:11,170 --> 00:17:16,150
you're using<font color="#E5E5E5"> real box it should be</font>

318
00:17:13,140 --> 00:17:23,290
<font color="#CCCCCC">twenty</font><font color="#E5E5E5"> minutes maybe or five minutes</font>

319
00:17:16,150 --> 00:17:31,750
<font color="#E5E5E5">three minutes so yeah that was not good</font>

320
00:17:23,290 --> 00:17:37,720
so<font color="#CCCCCC"> the story goes</font><font color="#E5E5E5"> is that they actually</font>

321
00:17:31,750 --> 00:17:40,210
had video<font color="#E5E5E5"> of one attacker</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> came in</font><font color="#CCCCCC"> I</font>

322
00:17:37,720 --> 00:17:42,250
think they<font color="#E5E5E5"> either taking a screwdriver</font>

323
00:17:40,210 --> 00:17:45,100
<font color="#E5E5E5">and hitting that</font><font color="#CCCCCC"> little release button</font>

324
00:17:42,250 --> 00:17:47,520
on<font color="#E5E5E5"> the top or maybe even a screwdriver</font>

325
00:17:45,100 --> 00:17:49,919
and jamming open the lock which could be

326
00:17:47,520 --> 00:17:52,389
but opening<font color="#E5E5E5"> the computer compartment</font>

327
00:17:49,920 --> 00:17:54,550
they took the hard drive out<font color="#E5E5E5"> and they</font>

328
00:17:52,390 --> 00:17:56,590
left for<font color="#CCCCCC"> forty-five minutes and</font><font color="#E5E5E5"> then</font>

329
00:17:54,550 --> 00:17:59,470
they came back<font color="#CCCCCC"> and shoved the hard drive</font>

330
00:17:56,590 --> 00:18:01,810
back in the machine right and it's at

331
00:17:59,470 --> 00:18:05,650
that<font color="#CCCCCC"> point that</font><font color="#E5E5E5"> that hard drive is now</font>

332
00:18:01,810 --> 00:18:07,360
infected<font color="#E5E5E5"> with some sort</font><font color="#CCCCCC"> of malware then</font>

333
00:18:05,650 --> 00:18:10,510
what would<font color="#CCCCCC"> happen</font><font color="#E5E5E5"> is they</font><font color="#CCCCCC"> would go away</font>

334
00:18:07,360 --> 00:18:13,719
right that's their<font color="#E5E5E5"> disc mule and then</font>

335
00:18:10,510 --> 00:18:16,270
they would have<font color="#E5E5E5"> a</font><font color="#CCCCCC"> cache meal</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> this</font>

336
00:18:13,720 --> 00:18:18,360
is somebody who would then show up they

337
00:18:16,270 --> 00:18:21,940
had codes that<font color="#E5E5E5"> would get texted to them</font>

338
00:18:18,360 --> 00:18:26,020
<font color="#CCCCCC">they were only valid for 24 hours I'd go</font>

339
00:18:21,940 --> 00:18:29,500
to the ATM<font color="#CCCCCC"> pull up a maintenance screen</font>

340
00:18:26,020 --> 00:18:31,720
<font color="#E5E5E5">and then enter in</font><font color="#CCCCCC"> the codes</font><font color="#E5E5E5"> and the</font>

341
00:18:29,500 --> 00:18:34,600
<font color="#CCCCCC">machine would dispense</font><font color="#E5E5E5"> cash right and</font>

342
00:18:31,720 --> 00:18:36,670
that's<font color="#E5E5E5"> because they've loaded malware on</font>

343
00:18:34,600 --> 00:18:39,310
the machine that<font color="#CCCCCC"> hooks the DLL that</font>

344
00:18:36,670 --> 00:18:41,910
<font color="#E5E5E5">dispenses the cash it's</font><font color="#CCCCCC"> a pretty pretty</font>

345
00:18:39,310 --> 00:18:41,909
crazy stuff

346
00:18:49,600 --> 00:18:55,600
so here's<font color="#E5E5E5"> another one</font><font color="#CCCCCC"> that I just</font><font color="#E5E5E5"> did</font>

347
00:18:52,899 --> 00:19:01,119
two weeks<font color="#E5E5E5"> ago</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> this is kind of</font>

348
00:18:55,600 --> 00:19:06,908
crazy<font color="#E5E5E5"> a little intro on this one in this</font>

349
00:19:01,119 --> 00:19:09,039
<font color="#E5E5E5">case the this is an ATM</font><font color="#CCCCCC"> that previously</font>

350
00:19:06,909 --> 00:19:11,409
I was<font color="#E5E5E5"> like</font><font color="#CCCCCC"> oh these these these machines</font>

351
00:19:09,039 --> 00:19:13,809
are good from a physical security

352
00:19:11,409 --> 00:19:19,899
<font color="#CCCCCC">perspective</font><font color="#E5E5E5"> however</font><font color="#CCCCCC"> this time the vendor</font>

353
00:19:13,809 --> 00:19:22,210
decided to add electronic locks which I

354
00:19:19,899 --> 00:19:24,039
can understand like it's it's good to

355
00:19:22,210 --> 00:19:27,039
have<font color="#E5E5E5"> an audit</font><font color="#CCCCCC"> trail right it's good to</font>

356
00:19:24,039 --> 00:19:29,129
have some<font color="#E5E5E5"> sort of privilege of or</font>

357
00:19:27,039 --> 00:19:31,840
knowing what privilege a user has

358
00:19:29,129 --> 00:19:34,199
<font color="#E5E5E5">unfortunately in this case</font><font color="#CCCCCC"> their</font>

359
00:19:31,840 --> 00:19:39,059
electronic lock mechanisms allowed me to

360
00:19:34,200 --> 00:19:42,519
very quickly and<font color="#CCCCCC"> easily bypass these</font>

361
00:19:39,059 --> 00:19:44,859
super secure locks right<font color="#E5E5E5"> so in this case</font>

362
00:19:42,519 --> 00:19:47,799
I<font color="#E5E5E5"> argued</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> pre insured it</font><font color="#CCCCCC"> inserted a</font>

363
00:19:44,859 --> 00:19:50,379
shim<font color="#E5E5E5"> right just a long shim that becomes</font>

364
00:19:47,799 --> 00:19:54,850
a bypass tool because they had a gate

365
00:19:50,379 --> 00:19:59,199
<font color="#E5E5E5">that was controlled by a solenoid it's</font>

366
00:19:54,850 --> 00:20:01,539
like<font color="#E5E5E5"> whoa so that's the outside</font><font color="#CCCCCC"> that</font>

367
00:19:59,200 --> 00:20:04,299
gets me access to<font color="#E5E5E5"> the hard drive gets me</font>

368
00:20:01,539 --> 00:20:08,169
access<font color="#CCCCCC"> to the computer</font><font color="#E5E5E5"> gets me access to</font>

369
00:20:04,299 --> 00:20:12,220
the USB bus<font color="#E5E5E5"> the second network port</font><font color="#CCCCCC"> all</font>

370
00:20:08,169 --> 00:20:15,489
that fun stuff<font color="#E5E5E5"> once you're inside the</font>

371
00:20:12,220 --> 00:20:22,119
ATM<font color="#E5E5E5"> the electronic control box was</font>

372
00:20:15,489 --> 00:20:26,769
secured<font color="#CCCCCC"> by four screws and the power</font>

373
00:20:22,119 --> 00:20:29,859
rail was also exposed<font color="#E5E5E5"> so I just had to</font>

374
00:20:26,769 --> 00:20:32,529
figure out<font color="#E5E5E5"> with a multimeter which of</font>

375
00:20:29,859 --> 00:20:34,749
the wires was the the one that

376
00:20:32,529 --> 00:20:39,090
controlled<font color="#E5E5E5"> the solenoid</font><font color="#CCCCCC"> inside</font><font color="#E5E5E5"> that</font>

377
00:20:34,749 --> 00:20:49,140
protected the cash<font color="#E5E5E5"> vault and essentially</font>

378
00:20:39,090 --> 00:20:51,090
Hotwire it<font color="#E5E5E5"> it's like what so</font>

379
00:20:49,140 --> 00:20:53,970
I guess the way<font color="#CCCCCC"> to prevent</font><font color="#E5E5E5"> this stuff</font>

380
00:20:51,090 --> 00:20:57,000
like test your stuff test your stuff

381
00:20:53,970 --> 00:21:00,780
test your stuff as you deploy it<font color="#E5E5E5"> before</font>

382
00:20:57,000 --> 00:21:05,960
you deploy<font color="#CCCCCC"> it once you deploy it the</font>

383
00:21:00,780 --> 00:21:16,980
bank<font color="#E5E5E5"> in Mexico City which had millions</font>

384
00:21:05,960 --> 00:21:18,840
in cash taken from<font color="#E5E5E5"> it I can't say so the</font>

385
00:21:16,980 --> 00:21:21,570
bank had thousands of<font color="#E5E5E5"> these ATMs</font>

386
00:21:18,840 --> 00:21:25,439
deployed in production<font color="#CCCCCC"> right so it's</font><font color="#E5E5E5"> uh</font>

387
00:21:21,570 --> 00:21:33,720
it's a it's<font color="#E5E5E5"> a big issue</font><font color="#CCCCCC"> so you have to</font>

388
00:21:25,440 --> 00:21:34,830
make sure<font color="#CCCCCC"> to test so the other thing</font><font color="#E5E5E5"> you</font>

389
00:21:33,720 --> 00:21:40,260
<font color="#E5E5E5">need</font><font color="#CCCCCC"> to do is make sure you're locking</font>

390
00:21:34,830 --> 00:21:41,928
<font color="#CCCCCC">down the application right I think</font>

391
00:21:40,260 --> 00:21:44,580
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> that's one of the things is that</font>

392
00:21:41,929 --> 00:21:46,650
<font color="#CCCCCC">you need</font><font color="#E5E5E5"> to run the apps as unprivileged</font>

393
00:21:44,580 --> 00:21:49,710
users you<font color="#E5E5E5"> need to make sure there's</font><font color="#CCCCCC"> some</font>

394
00:21:46,650 --> 00:21:52,080
<font color="#CCCCCC">sort</font><font color="#E5E5E5"> of privilege separation</font><font color="#CCCCCC"> and even</font>

395
00:21:49,710 --> 00:21:53,549
run antivirus<font color="#E5E5E5"> right I think one</font><font color="#CCCCCC"> of the</font>

396
00:21:52,080 --> 00:21:56,760
things that we're<font color="#E5E5E5"> seeing is there is a</font>

397
00:21:53,549 --> 00:21:59,129
tool that<font color="#CCCCCC"> will</font><font color="#E5E5E5"> or does</font><font color="#CCCCCC"> it's solid core</font>

398
00:21:56,760 --> 00:22:01,830
is a tool<font color="#CCCCCC"> that will say oh these are the</font>

399
00:21:59,130 --> 00:22:03,720
only binaries<font color="#CCCCCC"> that I can run and one of</font>

400
00:22:01,830 --> 00:22:06,270
them is<font color="#E5E5E5"> PowerShell how many people have</font>

401
00:22:03,720 --> 00:22:12,299
owned a machine using PowerShell<font color="#E5E5E5"> yeah</font>

402
00:22:06,270 --> 00:22:15,929
<font color="#E5E5E5">right so we basically we would take a</font>

403
00:22:12,299 --> 00:22:17,639
PowerShell<font color="#CCCCCC"> or take a</font><font color="#E5E5E5"> meterpreter payload</font>

404
00:22:15,929 --> 00:22:20,130
encoded in PowerShell

405
00:22:17,640 --> 00:22:22,380
paste it into PowerShell<font color="#E5E5E5"> at the console</font>

406
00:22:20,130 --> 00:22:25,740
and<font color="#E5E5E5"> we'd have a remote shell back to</font>

407
00:22:22,380 --> 00:22:27,990
where where we were right so that<font color="#E5E5E5"> that</font>

408
00:22:25,740 --> 00:22:30,150
is a viable attack from<font color="#E5E5E5"> you've maybe</font>

409
00:22:27,990 --> 00:22:32,100
paid off a maintenance<font color="#E5E5E5"> person or you've</font>

410
00:22:30,150 --> 00:22:38,549
figured<font color="#CCCCCC"> out how to</font><font color="#E5E5E5"> open up the back</font><font color="#CCCCCC"> of</font>

411
00:22:32,100 --> 00:22:39,750
the door<font color="#E5E5E5"> right and I</font><font color="#CCCCCC"> think one of the</font>

412
00:22:38,549 --> 00:22:41,730
other<font color="#E5E5E5"> things is hold your vendors</font>

413
00:22:39,750 --> 00:22:44,370
<font color="#CCCCCC">accountable and they should be doing</font>

414
00:22:41,730 --> 00:22:45,929
<font color="#CCCCCC">this testing</font><font color="#E5E5E5"> like well why aren't they</font>

415
00:22:44,370 --> 00:22:49,049
testing these things<font color="#E5E5E5"> before they go</font><font color="#CCCCCC"> out</font>

416
00:22:45,929 --> 00:22:52,049
into<font color="#E5E5E5"> the world why why is it that we</font>

417
00:22:49,049 --> 00:22:55,230
have<font color="#CCCCCC"> to have a</font><font color="#E5E5E5"> criminal ring identify</font>

418
00:22:52,049 --> 00:22:59,668
this<font color="#E5E5E5"> stuff for us</font><font color="#CCCCCC"> before it happens</font>

419
00:22:55,230 --> 00:23:01,380
<font color="#E5E5E5">I should note the ATMs in Japan had</font>

420
00:22:59,669 --> 00:23:03,210
there wasn't a<font color="#CCCCCC"> criminal ring against</font>

421
00:23:01,380 --> 00:23:05,549
them it was more

422
00:23:03,210 --> 00:23:06,900
due diligence<font color="#E5E5E5"> testing which is good</font>

423
00:23:05,549 --> 00:23:08,760
<font color="#CCCCCC">right there</font>

424
00:23:06,900 --> 00:23:13,620
Tokyo is getting prepared<font color="#CCCCCC"> for the</font>

425
00:23:08,760 --> 00:23:17,039
Olympics<font color="#CCCCCC"> so you know then</font><font color="#E5E5E5"> I think there</font>

426
00:23:13,620 --> 00:23:19,010
is<font color="#E5E5E5"> some</font><font color="#CCCCCC"> understanding that foreigners</font>

427
00:23:17,039 --> 00:23:26,940
may not adhere<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same rules that</font>

428
00:23:19,010 --> 00:23:28,770
<font color="#E5E5E5">Japanese culture does all right so what</font>

429
00:23:26,940 --> 00:23:31,409
can<font color="#E5E5E5"> you do personally right make</font><font color="#CCCCCC"> sure</font>

430
00:23:28,770 --> 00:23:33,150
you review<font color="#E5E5E5"> your bank statements ensure</font>

431
00:23:31,409 --> 00:23:35,490
you have withdrawal limits on your your

432
00:23:33,150 --> 00:23:37,470
card<font color="#E5E5E5"> right</font>

433
00:23:35,490 --> 00:23:40,380
call your<font color="#E5E5E5"> bank if you see unauthorized</font>

434
00:23:37,470 --> 00:23:42,890
transactions<font color="#E5E5E5"> your bank accounts are</font>

435
00:23:40,380 --> 00:23:47,250
federally protected which is really good

436
00:23:42,890 --> 00:23:49,650
right<font color="#CCCCCC"> whenever I go up</font><font color="#E5E5E5"> to an ATM</font><font color="#CCCCCC"> I kind</font>

437
00:23:47,250 --> 00:23:51,330
of pulled the shard<font color="#CCCCCC"> like if I can pull</font>

438
00:23:49,650 --> 00:23:54,000
it<font color="#E5E5E5"> off or it feels loose I'm not</font>

439
00:23:51,330 --> 00:23:55,110
touching it<font color="#E5E5E5"> I'm walking away there's a</font>

440
00:23:54,000 --> 00:23:57,330
really good<font color="#CCCCCC"> chance there's a card</font>

441
00:23:55,110 --> 00:24:00,000
<font color="#CCCCCC">skimmer skimmer on it</font><font color="#E5E5E5"> although from what</font>

442
00:23:57,330 --> 00:24:01,949
<font color="#CCCCCC">I understand the skimmers people with</font>

443
00:24:00,000 --> 00:24:05,970
card skimmers have gotten much better at

444
00:24:01,950 --> 00:24:07,770
putting covers on the on the ATMs now<font color="#E5E5E5"> to</font>

445
00:24:05,970 --> 00:24:15,179
the<font color="#E5E5E5"> point you can't even tell it is a</font>

446
00:24:07,770 --> 00:24:21,650
cover<font color="#E5E5E5"> but yeah I think I have a</font><font color="#CCCCCC"> couple</font>

447
00:24:15,179 --> 00:24:23,610
minutes<font color="#CCCCCC"> for questions here so we have a</font>

448
00:24:21,650 --> 00:24:25,380
couple<font color="#E5E5E5"> questions from the audience</font>

449
00:24:23,610 --> 00:24:29,879
<font color="#CCCCCC">they're wondering where you will upload</font>

450
00:24:25,380 --> 00:24:32,640
<font color="#E5E5E5">the presentation</font><font color="#CCCCCC"> that I can figure that</font>

451
00:24:29,880 --> 00:24:34,260
<font color="#CCCCCC">out later I don't know where I can hand</font>

452
00:24:32,640 --> 00:24:37,710
<font color="#E5E5E5">it off to B sides and they can post</font><font color="#CCCCCC"> it</font>

453
00:24:34,260 --> 00:24:41,520
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> and then Franco from</font><font color="#E5E5E5"> the audience</font>

454
00:24:37,710 --> 00:24:43,860
<font color="#E5E5E5">asked do ATMs only use</font><font color="#CCCCCC"> windows</font><font color="#E5E5E5"> or do</font>

455
00:24:41,520 --> 00:24:46,620
some use some<font color="#E5E5E5"> Linux variant is there a</font>

456
00:24:43,860 --> 00:24:50,189
way<font color="#CCCCCC"> to track the</font><font color="#E5E5E5"> attackers so in this</font>

457
00:24:46,620 --> 00:24:54,239
case the cheapest and easiest route to

458
00:24:50,190 --> 00:24:58,620
market<font color="#E5E5E5"> is Windows unfortunately right</font>

459
00:24:54,240 --> 00:25:01,820
all of these ATMs<font color="#E5E5E5"> their core</font><font color="#CCCCCC"> OS</font><font color="#E5E5E5"> is</font>

460
00:24:58,620 --> 00:25:04,649
<font color="#CCCCCC">Windows which</font><font color="#E5E5E5"> is kind of</font><font color="#CCCCCC"> unfortunate</font>

461
00:25:01,820 --> 00:25:07,260
<font color="#E5E5E5">there's a little tear right here in my</font>

462
00:25:04,650 --> 00:25:08,730
corner corner<font color="#E5E5E5"> my eye</font><font color="#CCCCCC"> I wish they would</font>

463
00:25:07,260 --> 00:25:13,408
run Linux because<font color="#E5E5E5"> then we wouldn't have</font>

464
00:25:08,730 --> 00:25:16,740
<font color="#CCCCCC">these problems</font><font color="#E5E5E5"> and one more question is</font>

465
00:25:13,409 --> 00:25:19,049
what was the<font color="#CCCCCC"> bid about vendor</font>

466
00:25:16,740 --> 00:25:21,029
collusion<font color="#E5E5E5"> was the vendor providing the</font>

467
00:25:19,049 --> 00:25:29,908
limited time access code to<font color="#CCCCCC"> the cache</font>

468
00:25:21,029 --> 00:25:33,330
miles so there is there's there's a code

469
00:25:29,909 --> 00:25:35,730
<font color="#E5E5E5">right that some vendors can give to</font>

470
00:25:33,330 --> 00:25:40,408
their<font color="#CCCCCC"> maintenance people</font><font color="#E5E5E5"> to gain access</font>

471
00:25:35,730 --> 00:25:45,779
to the ATMs<font color="#CCCCCC"> right that needs to also</font><font color="#E5E5E5"> be</font>

472
00:25:40,409 --> 00:25:49,230
provided to<font color="#E5E5E5"> a user right yeah</font>

473
00:25:45,779 --> 00:25:57,710
it's it's a<font color="#E5E5E5"> it's a very interesting bit</font>

474
00:25:49,230 --> 00:26:01,230
right<font color="#CCCCCC"> i what do you recommend as the</font>

475
00:25:57,710 --> 00:26:03,600
<font color="#CCCCCC">best method for deriving</font><font color="#E5E5E5"> the keys for</font>

476
00:26:01,230 --> 00:26:06,299
<font color="#E5E5E5">full disk encryption given that</font>

477
00:26:03,600 --> 00:26:07,529
apparently the only<font color="#E5E5E5"> ATM you mentioned</font>

478
00:26:06,299 --> 00:26:09,809
<font color="#E5E5E5">that had any full disk encryption</font>

479
00:26:07,529 --> 00:26:12,630
derived their keys in<font color="#CCCCCC"> a way that was</font><font color="#E5E5E5"> the</font>

480
00:26:09,809 --> 00:26:15,120
same<font color="#E5E5E5"> across devices</font>

481
00:26:12,630 --> 00:26:17,730
so in this case<font color="#E5E5E5"> the software has</font><font color="#CCCCCC"> the</font>

482
00:26:15,120 --> 00:26:22,949
option<font color="#E5E5E5"> to go online and pull down</font><font color="#CCCCCC"> a</font>

483
00:26:17,730 --> 00:26:25,799
unique<font color="#CCCCCC"> key per machine but because</font><font color="#E5E5E5"> these</font>

484
00:26:22,950 --> 00:26:28,529
ATMs were deployed<font color="#E5E5E5"> into into places</font>

485
00:26:25,799 --> 00:26:31,320
where they can't trust the network<font color="#CCCCCC"> like</font>

486
00:26:28,529 --> 00:26:36,120
literally<font color="#E5E5E5"> a satellite feed that's maybe</font>

487
00:26:31,320 --> 00:26:38,399
<font color="#E5E5E5">64 K right so they air</font><font color="#CCCCCC"> it on the side of</font>

488
00:26:36,120 --> 00:26:40,529
the machine actually<font color="#E5E5E5"> being booted</font><font color="#CCCCCC"> so</font>

489
00:26:38,399 --> 00:26:44,279
that when the<font color="#E5E5E5"> user comes to take out</font>

490
00:26:40,529 --> 00:26:45,929
money<font color="#CCCCCC"> it works or the the latency is the</font>

491
00:26:44,279 --> 00:26:49,620
<font color="#CCCCCC">time that</font><font color="#E5E5E5"> it takes to check the network</font>

492
00:26:45,929 --> 00:26:51,149
and then dispense<font color="#E5E5E5"> the</font><font color="#CCCCCC"> cache</font><font color="#E5E5E5"> versus the</font>

493
00:26:49,620 --> 00:26:53,039
<font color="#CCCCCC">Machine just not working because it</font>

494
00:26:51,149 --> 00:26:55,199
can't<font color="#CCCCCC"> actually download</font><font color="#E5E5E5"> its disk</font>

495
00:26:53,039 --> 00:26:57,539
encryption key and<font color="#E5E5E5"> I totally understand</font>

496
00:26:55,200 --> 00:26:59,370
<font color="#E5E5E5">what they're they're doing there</font><font color="#CCCCCC"> but</font>

497
00:26:57,539 --> 00:27:06,408
<font color="#CCCCCC">unfortunately it's cost</font><font color="#E5E5E5"> them a lot</font><font color="#CCCCCC"> of</font>

498
00:26:59,370 --> 00:27:10,620
<font color="#E5E5E5">money and to what extent are I factory</font>

499
00:27:06,409 --> 00:27:12,720
default passwords on cheaper<font color="#E5E5E5"> minor ATMs</font>

500
00:27:10,620 --> 00:27:15,719
in convenience<font color="#CCCCCC"> stores</font><font color="#E5E5E5"> still an issue in</font>

501
00:27:12,720 --> 00:27:18,029
to what extent are unpatched<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> XP</font>

502
00:27:15,720 --> 00:27:20,640
ATMs deployed in the wild is still an

503
00:27:18,029 --> 00:27:22,559
issue<font color="#E5E5E5"> so I haven't personally done</font>

504
00:27:20,640 --> 00:27:23,530
research on<font color="#E5E5E5"> that so I can't make</font>

505
00:27:22,559 --> 00:27:27,180
comments

506
00:27:23,530 --> 00:27:33,330
on that all right let's<font color="#E5E5E5"> Thank You Daniel</font>

507
00:27:27,180 --> 00:27:33,330
<font color="#E5E5E5">for coming to be</font><font color="#CCCCCC"> sighs s off thank you</font>

