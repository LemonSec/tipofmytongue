1
00:00:00,030 --> 00:00:03,570
so<font color="#CCCCCC"> with all of that</font><font color="#E5E5E5"> being said we're</font>

2
00:00:01,829 --> 00:00:08,550
gonna listen<font color="#CCCCCC"> to</font><font color="#E5E5E5"> an interesting lecture</font>

3
00:00:03,570 --> 00:00:11,420
on how to kind<font color="#E5E5E5"> of inspect a virtual</font>

4
00:00:08,550 --> 00:00:15,389
guest<font color="#CCCCCC"> while still being performant in</font>

5
00:00:11,420 --> 00:00:18,090
<font color="#CCCCCC">there get interesting talk because this</font>

6
00:00:15,389 --> 00:00:20,730
is a problem where<font color="#CCCCCC"> all the ways how to</font>

7
00:00:18,090 --> 00:00:22,320
<font color="#E5E5E5">do this</font><font color="#CCCCCC"> either</font><font color="#E5E5E5"> you get inside the</font><font color="#CCCCCC"> VM and</font>

8
00:00:20,730 --> 00:00:25,170
they can<font color="#E5E5E5"> corrupt and there go your</font>

9
00:00:22,320 --> 00:00:26,519
controls or you be outside<font color="#CCCCCC"> the VM</font><font color="#E5E5E5"> sis</font>

10
00:00:25,170 --> 00:00:28,019
<font color="#CCCCCC">Huck everything and just</font><font color="#E5E5E5"> be ill</font>

11
00:00:26,519 --> 00:00:30,209
<font color="#E5E5E5">performance and ops and others</font>

12
00:00:28,019 --> 00:00:34,110
complaining about your<font color="#CCCCCC"> guest</font><font color="#E5E5E5"> being so</font>

13
00:00:30,210 --> 00:00:37,260
slow<font color="#E5E5E5"> or varieties on a</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> so let's</font>

14
00:00:34,110 --> 00:00:39,360
give<font color="#CCCCCC"> it over</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> Chris or a</font><font color="#E5E5E5"> rule and take</font>

15
00:00:37,260 --> 00:00:43,320
it<font color="#E5E5E5"> from here yeah thank you you seem to</font>

16
00:00:39,360 --> 00:00:45,000
know<font color="#CCCCCC"> so much already</font><font color="#E5E5E5"> about the</font><font color="#CCCCCC"> tag so</font>

17
00:00:43,320 --> 00:00:47,640
good afternoon<font color="#E5E5E5"> everyone</font><font color="#CCCCCC"> thank you</font><font color="#E5E5E5"> all</font>

18
00:00:45,000 --> 00:00:50,039
<font color="#E5E5E5">for being here</font><font color="#CCCCCC"> my name is Raul</font>

19
00:00:47,640 --> 00:00:53,489
<font color="#E5E5E5">and I will cover the</font><font color="#CCCCCC"> for the first part</font>

20
00:00:50,039 --> 00:00:56,489
of this presentation<font color="#E5E5E5"> just</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> put you in</font>

21
00:00:53,489 --> 00:00:59,879
context then<font color="#CCCCCC"> Christie will cover the</font>

22
00:00:56,489 --> 00:01:02,129
technical part<font color="#CCCCCC"> and I like to state from</font>

23
00:00:59,879 --> 00:01:03,599
<font color="#E5E5E5">the beginning that as you might</font><font color="#CCCCCC"> have</font>

24
00:01:02,129 --> 00:01:07,189
guessed we're not native English

25
00:01:03,600 --> 00:01:09,810
<font color="#E5E5E5">speakers</font><font color="#CCCCCC"> and we have essentially zero</font>

26
00:01:07,189 --> 00:01:15,600
experience in public<font color="#CCCCCC"> speaking so please</font>

27
00:01:09,810 --> 00:01:18,540
bear with<font color="#E5E5E5"> us now this presentation is</font>

28
00:01:15,600 --> 00:01:20,880
not<font color="#CCCCCC"> going to be about our company but</font>

29
00:01:18,540 --> 00:01:25,350
<font color="#CCCCCC">for those of you who don't know who B</font>

30
00:01:20,880 --> 00:01:27,600
defender is allow<font color="#CCCCCC"> me</font><font color="#E5E5E5"> just a few</font><font color="#CCCCCC"> words</font><font color="#E5E5E5"> we</font>

31
00:01:25,350 --> 00:01:31,979
are<font color="#E5E5E5"> worldwide</font><font color="#CCCCCC"> cyber security technology</font>

32
00:01:27,600 --> 00:01:36,030
<font color="#E5E5E5">provider</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> technology is</font><font color="#CCCCCC"> integrated in</font>

33
00:01:31,979 --> 00:01:40,530
many other security solutions we were

34
00:01:36,030 --> 00:01:44,270
founded<font color="#CCCCCC"> in 2001 and that accounts for</font>

35
00:01:40,530 --> 00:01:47,430
<font color="#E5E5E5">almost two decades</font><font color="#CCCCCC"> in security expertise</font>

36
00:01:44,270 --> 00:01:50,039
<font color="#E5E5E5">we operate a global security delivery</font>

37
00:01:47,430 --> 00:01:55,259
infrastructure protecting half a billion

38
00:01:50,040 --> 00:01:57,950
users<font color="#E5E5E5"> across more than 150 countries</font><font color="#CCCCCC"> my</font>

39
00:01:55,259 --> 00:02:00,420
team in<font color="#CCCCCC"> particular is focused</font><font color="#E5E5E5"> in</font>

40
00:01:57,950 --> 00:02:04,680
researching how hardware virtualization

41
00:02:00,420 --> 00:02:06,960
technologies can<font color="#CCCCCC"> be can be leveraged to</font>

42
00:02:04,680 --> 00:02:11,989
strengthen security<font color="#E5E5E5"> in virtualized</font>

43
00:02:06,960 --> 00:02:13,950
environments as for us<font color="#CCCCCC"> instead of</font>

44
00:02:11,989 --> 00:02:17,160
<font color="#E5E5E5">reading what's been</font>

45
00:02:13,950 --> 00:02:21,540
already written<font color="#CCCCCC"> allow me</font><font color="#E5E5E5"> to study the</font>

46
00:02:17,160 --> 00:02:24,359
story<font color="#E5E5E5"> until recently when people ask me</font>

47
00:02:21,540 --> 00:02:27,959
where I came from<font color="#CCCCCC"> I used</font><font color="#E5E5E5"> to say that I</font>

48
00:02:24,360 --> 00:02:32,819
come from Romania but then I<font color="#E5E5E5"> realized</font>

49
00:02:27,959 --> 00:02:36,750
<font color="#CCCCCC">that</font><font color="#E5E5E5"> people often associate that</font><font color="#CCCCCC"> and for</font>

50
00:02:32,819 --> 00:02:41,130
good reason with uncertain economy<font color="#E5E5E5"> poor</font>

51
00:02:36,750 --> 00:02:43,890
<font color="#E5E5E5">infrastructure or high-level corruption</font>

52
00:02:41,130 --> 00:02:46,890
<font color="#CCCCCC">it's funny how these three always</font><font color="#E5E5E5"> come</font>

53
00:02:43,890 --> 00:02:49,440
as a package<font color="#E5E5E5"> so I give</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> the little</font>

54
00:02:46,890 --> 00:02:51,119
<font color="#E5E5E5">thought and I wonder how else can I</font>

55
00:02:49,440 --> 00:02:55,799
better present<font color="#E5E5E5"> the place that I'm coming</font>

56
00:02:51,120 --> 00:02:58,700
from so that<font color="#CCCCCC"> inspiration struck and now</font>

57
00:02:55,799 --> 00:03:03,180
I'm proud to state that I come<font color="#CCCCCC"> from</font>

58
00:02:58,700 --> 00:03:07,768
Transylvania<font color="#CCCCCC"> and yes</font><font color="#E5E5E5"> it is</font><font color="#CCCCCC"> a region</font><font color="#E5E5E5"> in</font>

59
00:03:03,180 --> 00:03:14,100
Romania<font color="#E5E5E5"> and we actually live there</font>

60
00:03:07,769 --> 00:03:17,100
does it sound better now<font color="#E5E5E5"> why well</font>

61
00:03:14,100 --> 00:03:19,980
according to Lonely Planet Transylvania

62
00:03:17,100 --> 00:03:24,380
<font color="#E5E5E5">is best known as the</font><font color="#CCCCCC"> mysterious</font><font color="#E5E5E5"> land of</font>

63
00:03:19,980 --> 00:03:27,140
bloodthirsty vampires<font color="#E5E5E5"> and howling wolves</font>

64
00:03:24,380 --> 00:03:32,370
<font color="#E5E5E5">but don't worry we</font><font color="#CCCCCC"> stop drinking blood</font>

65
00:03:27,140 --> 00:03:35,940
<font color="#CCCCCC">200</font><font color="#E5E5E5"> years ago</font><font color="#CCCCCC"> when they</font><font color="#E5E5E5"> perfected</font>

66
00:03:32,370 --> 00:03:36,390
alcohol distillation<font color="#E5E5E5"> it changed</font>

67
00:03:35,940 --> 00:03:40,410
everything

68
00:03:36,390 --> 00:03:46,170
you know Bloody Mary<font color="#E5E5E5"> it means something</font>

69
00:03:40,410 --> 00:03:48,540
else<font color="#E5E5E5"> now but I'm pretty sure you</font><font color="#CCCCCC"> are not</font>

70
00:03:46,170 --> 00:03:51,958
here<font color="#E5E5E5"> to hear</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> these obsolete</font>

71
00:03:48,540 --> 00:03:54,590
<font color="#CCCCCC">threats that can be</font><font color="#E5E5E5"> overcome with a few</font>

72
00:03:51,959 --> 00:03:56,459
cloves of garlic and<font color="#CCCCCC"> a silver dagger</font>

73
00:03:54,590 --> 00:03:59,700
<font color="#CCCCCC">although I could share</font><font color="#E5E5E5"> a few stories</font>

74
00:03:56,459 --> 00:04:03,209
<font color="#CCCCCC">about my grand grand grandfather</font><font color="#E5E5E5"> after</font>

75
00:03:59,700 --> 00:04:12,149
<font color="#CCCCCC">the presentation his name by the</font><font color="#E5E5E5"> way was</font>

76
00:04:03,209 --> 00:04:13,980
a Vlad the Impaler<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> instead</font><font color="#E5E5E5"> we are</font>

77
00:04:12,150 --> 00:04:17,310
<font color="#CCCCCC">going to talk about the kind of threads</font>

78
00:04:13,980 --> 00:04:21,120
<font color="#CCCCCC">that</font><font color="#E5E5E5"> keep security researchers on their</font>

79
00:04:17,310 --> 00:04:24,090
toes<font color="#E5E5E5"> or</font><font color="#CCCCCC"> the kind of threat that</font><font color="#E5E5E5"> can</font>

80
00:04:21,120 --> 00:04:27,740
teach<font color="#CCCCCC"> people how to buy</font><font color="#E5E5E5"> Bitcoin to pay a</font>

81
00:04:24,090 --> 00:04:31,000
ransom<font color="#E5E5E5"> or</font><font color="#CCCCCC"> the kind of threat</font><font color="#E5E5E5"> that is</font>

82
00:04:27,740 --> 00:04:33,160
used as a weapon<font color="#E5E5E5"> in cyber warfare</font>

83
00:04:31,000 --> 00:04:35,810
between<font color="#CCCCCC"> states</font>

84
00:04:33,160 --> 00:04:37,610
we will also<font color="#E5E5E5"> emphasize how we are</font>

85
00:04:35,810 --> 00:04:39,349
leveraging<font color="#CCCCCC"> harder with hardware which</font>

86
00:04:37,610 --> 00:04:42,500
<font color="#CCCCCC">allies</font><font color="#E5E5E5"> Asian technologies to break the</font>

87
00:04:39,349 --> 00:04:44,719
chain of attack employed<font color="#E5E5E5"> by a PT's then</font>

88
00:04:42,500 --> 00:04:46,460
we will talk<font color="#E5E5E5"> about how latest</font>

89
00:04:44,720 --> 00:04:49,880
improvements in<font color="#CCCCCC"> vdx</font>

90
00:04:46,460 --> 00:04:51,979
are assisting hypervisors and secretive

91
00:04:49,880 --> 00:04:54,919
security solutions like ours in

92
00:04:51,979 --> 00:04:57,050
achieving<font color="#CCCCCC"> better performance in the end</font>

93
00:04:54,919 --> 00:05:00,680
we will uncover some measurements that

94
00:04:57,050 --> 00:05:03,289
we've<font color="#E5E5E5"> conducted and the results and</font>

95
00:05:00,680 --> 00:05:05,449
<font color="#CCCCCC">we'll drop some conclusions please</font>

96
00:05:03,289 --> 00:05:08,539
remember to<font color="#CCCCCC"> submit any questions</font><font color="#E5E5E5"> that</font>

97
00:05:05,449 --> 00:05:13,550
you might<font color="#CCCCCC"> have on slide oh and we will</font>

98
00:05:08,539 --> 00:05:16,009
try to answer<font color="#E5E5E5"> all of them at</font><font color="#CCCCCC"> the end</font><font color="#E5E5E5"> so</font>

99
00:05:13,550 --> 00:05:18,199
what our team<font color="#CCCCCC"> has been developing in the</font>

100
00:05:16,009 --> 00:05:20,900
last few<font color="#CCCCCC"> years is</font><font color="#E5E5E5"> what the industry</font>

101
00:05:18,199 --> 00:05:24,860
called the<font color="#E5E5E5"> industry</font><font color="#CCCCCC"> called hypervisor</font>

102
00:05:20,900 --> 00:05:27,318
memory introspection<font color="#E5E5E5"> or virtual machine</font>

103
00:05:24,860 --> 00:05:29,060
introspection technology<font color="#E5E5E5"> now according</font>

104
00:05:27,319 --> 00:05:32,419
<font color="#CCCCCC">to the first paper that</font><font color="#E5E5E5"> has ever</font>

105
00:05:29,060 --> 00:05:35,240
<font color="#E5E5E5">mentioned hypervisor introspection it is</font>

106
00:05:32,419 --> 00:05:37,609
the approach of inspecting a virtual

107
00:05:35,240 --> 00:05:40,250
<font color="#E5E5E5">machine from the outside for the purpose</font>

108
00:05:37,610 --> 00:05:45,080
of<font color="#CCCCCC"> analyzing the software running</font><font color="#E5E5E5"> inside</font>

109
00:05:40,250 --> 00:05:49,159
it and this is what we are doing we are

110
00:05:45,080 --> 00:05:51,880
<font color="#E5E5E5">monitoring the behavior of the MS from</font>

111
00:05:49,159 --> 00:05:55,690
<font color="#E5E5E5">the hypervisor</font><font color="#CCCCCC"> for the purpose</font><font color="#E5E5E5"> of</font>

112
00:05:51,880 --> 00:05:57,889
identifying rootkit<font color="#E5E5E5"> and exploit activity</font>

113
00:05:55,690 --> 00:06:00,219
so where does this kind of technology

114
00:05:57,889 --> 00:06:02,719
<font color="#CCCCCC">fit in the current security</font><font color="#E5E5E5"> landscape</font>

115
00:06:00,219 --> 00:06:05,630
<font color="#E5E5E5">first let's have a</font><font color="#CCCCCC"> look at a typical</font>

116
00:06:02,719 --> 00:06:08,120
chain of attack in the beginning<font color="#E5E5E5"> there's</font>

117
00:06:05,630 --> 00:06:11,090
the infection vector which can<font color="#E5E5E5"> be a</font>

118
00:06:08,120 --> 00:06:15,139
<font color="#E5E5E5">sparrow phishing email and in fact the</font>

119
00:06:11,090 --> 00:06:18,080
<font color="#CCCCCC">webpage</font><font color="#E5E5E5"> social media or so on receive</font>

120
00:06:15,139 --> 00:06:20,000
user will most often follow a link which

121
00:06:18,080 --> 00:06:23,030
will<font color="#E5E5E5"> trigger an exploit kit being</font>

122
00:06:20,000 --> 00:06:24,740
detonated<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the browser and then this</font>

123
00:06:23,030 --> 00:06:27,130
exploit<font color="#CCCCCC"> keep fingerprints the browser</font>

124
00:06:24,740 --> 00:06:29,930
and<font color="#CCCCCC"> abuse is</font><font color="#E5E5E5"> a nun patch vulnerability</font>

125
00:06:27,130 --> 00:06:32,719
which leads to<font color="#E5E5E5"> a user mode payload being</font>

126
00:06:29,930 --> 00:06:34,460
executed in the browser<font color="#E5E5E5"> this user mode</font>

127
00:06:32,719 --> 00:06:36,710
<font color="#CCCCCC">pelo will try to</font><font color="#E5E5E5"> take advantage of</font>

128
00:06:34,460 --> 00:06:41,210
another probability<font color="#E5E5E5"> in the operating</font>

129
00:06:36,710 --> 00:06:45,380
<font color="#E5E5E5">system to achieve kernel privilege</font>

130
00:06:41,210 --> 00:06:49,070
and then it's game<font color="#E5E5E5"> over most attacks</font>

131
00:06:45,380 --> 00:06:52,550
will use<font color="#CCCCCC"> rookie techniques</font><font color="#E5E5E5"> to acquire</font>

132
00:06:49,070 --> 00:06:55,190
persistence and remain invisible then

133
00:06:52,550 --> 00:06:57,230
attackers could try to perform a lateral

134
00:06:55,190 --> 00:07:01,430
movement<font color="#CCCCCC"> - in fact</font><font color="#E5E5E5"> other systems on the</font>

135
00:06:57,230 --> 00:07:03,410
network<font color="#E5E5E5"> they could</font><font color="#CCCCCC"> explore trade</font>

136
00:07:01,430 --> 00:07:07,750
sensitive data they could encrypt data

137
00:07:03,410 --> 00:07:11,780
or even<font color="#E5E5E5"> tamper with critical systems</font>

138
00:07:07,750 --> 00:07:13,700
<font color="#E5E5E5">until they are discovered do you have</font>

139
00:07:11,780 --> 00:07:16,580
any idea how<font color="#E5E5E5"> long does it take for a</font>

140
00:07:13,700 --> 00:07:24,469
company<font color="#CCCCCC"> or institution</font><font color="#E5E5E5"> to uncover a</font>

141
00:07:16,580 --> 00:07:31,550
bridge any numbers one month<font color="#E5E5E5"> two years</font>

142
00:07:24,470 --> 00:07:34,390
<font color="#E5E5E5">it's sometimes it happens yes the global</font>

143
00:07:31,550 --> 00:07:37,070
median<font color="#CCCCCC"> 12-time</font><font color="#E5E5E5"> that's the number</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> days</font>

144
00:07:34,390 --> 00:07:39,409
<font color="#E5E5E5">between the initial compromise and the</font>

145
00:07:37,070 --> 00:07:43,070
time of<font color="#CCCCCC"> discovery is reported to</font><font color="#E5E5E5"> be</font>

146
00:07:39,410 --> 00:07:45,410
around 100 days imagine having one

147
00:07:43,070 --> 00:07:48,349
<font color="#E5E5E5">system in your company compromised for</font>

148
00:07:45,410 --> 00:07:52,580
an hour<font color="#CCCCCC"> and then think about the</font>

149
00:07:48,350 --> 00:07:54,500
attackers having full<font color="#E5E5E5"> access</font><font color="#CCCCCC"> in control</font>

150
00:07:52,580 --> 00:08:01,310
<font color="#E5E5E5">to your entire company infrastructure</font>

151
00:07:54,500 --> 00:08:03,080
<font color="#E5E5E5">and resources for a few months let's</font>

152
00:08:01,310 --> 00:08:05,750
have a look now<font color="#CCCCCC"> at a few</font><font color="#E5E5E5"> specific and</font>

153
00:08:03,080 --> 00:08:08,450
<font color="#CCCCCC">well-known apts and see how hvi can</font>

154
00:08:05,750 --> 00:08:10,460
break their chain<font color="#CCCCCC"> of attack this is</font>

155
00:08:08,450 --> 00:08:13,820
<font color="#E5E5E5">carbonic apt which by the time</font><font color="#CCCCCC"> of</font>

156
00:08:10,460 --> 00:08:15,830
discovery<font color="#E5E5E5"> in 2014 has targeted and in</font>

157
00:08:13,820 --> 00:08:18,530
fact in several<font color="#E5E5E5"> financial institutions</font>

158
00:08:15,830 --> 00:08:23,180
around the<font color="#E5E5E5"> globe reportedly just one</font>

159
00:08:18,530 --> 00:08:26,809
bank has lost 7.3 million dollars when

160
00:08:23,180 --> 00:08:29,900
its ATMs were instructed to spew cash at

161
00:08:26,810 --> 00:08:33,559
certain times<font color="#E5E5E5"> when members</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the attack</font>

162
00:08:29,900 --> 00:08:36,169
team were there<font color="#E5E5E5"> to</font><font color="#CCCCCC"> collect them to</font>

163
00:08:33,559 --> 00:08:38,449
collect<font color="#E5E5E5"> the money</font><font color="#CCCCCC"> hbi</font><font color="#E5E5E5"> is able to attack</font>

164
00:08:36,169 --> 00:08:42,979
several<font color="#E5E5E5"> steps in the attack chain chain</font>

165
00:08:38,450 --> 00:08:46,910
starting with the exploitation<font color="#CCCCCC"> tent the</font>

166
00:08:42,980 --> 00:08:50,720
same applies to<font color="#CCCCCC"> Turla</font><font color="#E5E5E5"> apt discovered in</font>

167
00:08:46,910 --> 00:08:51,980
2014<font color="#CCCCCC"> it abuse</font><font color="#E5E5E5"> the set of vulnerabilities</font>

168
00:08:50,720 --> 00:08:54,890
in

169
00:08:51,980 --> 00:08:57,340
<font color="#CCCCCC">Adobe Reader to avoid the sandbox</font><font color="#E5E5E5"> and in</font>

170
00:08:54,890 --> 00:09:00,170
<font color="#E5E5E5">Windows for local privilege escalation</font>

171
00:08:57,340 --> 00:09:02,330
once again<font color="#CCCCCC"> hvi</font><font color="#E5E5E5"> detects and blocks the</font>

172
00:09:00,170 --> 00:09:06,229
exploitation attempt<font color="#E5E5E5"> as well as the root</font>

173
00:09:02,330 --> 00:09:07,970
kit installation attempt while<font color="#CCCCCC"> Neutron</font>

174
00:09:06,230 --> 00:09:12,410
is another example<font color="#CCCCCC"> it's been</font><font color="#E5E5E5"> active</font>

175
00:09:07,970 --> 00:09:15,140
between 2011 and 2015<font color="#E5E5E5"> and became</font>

176
00:09:12,410 --> 00:09:17,650
notorious in 2013<font color="#CCCCCC"> when it's successfully</font>

177
00:09:15,140 --> 00:09:22,130
infected companies such as Apple

178
00:09:17,650 --> 00:09:26,449
<font color="#CCCCCC">Facebook Twitter and Microsoft its</font>

179
00:09:22,130 --> 00:09:29,090
<font color="#E5E5E5">latest inspection vectors in 2015 are</font>

180
00:09:26,450 --> 00:09:31,040
still unknown but<font color="#CCCCCC"> hvi can block the</font>

181
00:09:29,090 --> 00:09:35,030
inspiration attempt and also the<font color="#CCCCCC"> rootkit</font>

182
00:09:31,040 --> 00:09:38,900
<font color="#E5E5E5">activity but the thing here is HD I was</font>

183
00:09:35,030 --> 00:09:41,720
only launched in January 2017<font color="#E5E5E5"> these</font>

184
00:09:38,900 --> 00:09:42,410
three attacks took place before<font color="#CCCCCC"> HP I was</font>

185
00:09:41,720 --> 00:09:46,070
available

186
00:09:42,410 --> 00:09:48,800
we tested against them and they are<font color="#E5E5E5"> all</font>

187
00:09:46,070 --> 00:09:50,930
<font color="#E5E5E5">blocked but I would like to share with</font>

188
00:09:48,800 --> 00:09:57,109
you what happened<font color="#CCCCCC"> during the numerous AG</font>

189
00:09:50,930 --> 00:09:59,989
and how HP I behaved<font color="#CCCCCC"> eternal blue this</font>

190
00:09:57,110 --> 00:10:03,020
should ring some bells<font color="#CCCCCC"> with you</font>

191
00:09:59,990 --> 00:10:07,370
it's an exploit developed by NSA<font color="#E5E5E5"> for</font>

192
00:10:03,020 --> 00:10:11,240
according<font color="#CCCCCC"> to</font><font color="#E5E5E5"> former NSA employees it hit</font>

193
00:10:07,370 --> 00:10:13,040
<font color="#E5E5E5">the spotlight in April 2017 when a</font>

194
00:10:11,240 --> 00:10:17,210
hacker<font color="#E5E5E5"> group released hundreds of</font>

195
00:10:13,040 --> 00:10:20,870
megabytes of material reportedly stolen

196
00:10:17,210 --> 00:10:23,170
from NSA the exploit was leveraged<font color="#CCCCCC"> in</font>

197
00:10:20,870 --> 00:10:26,810
one<font color="#E5E5E5"> cry attack just a month later</font>

198
00:10:23,170 --> 00:10:30,410
<font color="#E5E5E5">hitting 150 countries</font><font color="#CCCCCC"> and causing losses</font>

199
00:10:26,810 --> 00:10:31,880
of nearly<font color="#E5E5E5"> four billion dollars in the</font>

200
00:10:30,410 --> 00:10:34,189
following months the<font color="#E5E5E5"> eternal blue</font>

201
00:10:31,880 --> 00:10:36,950
exploit has been reported in use in

202
00:10:34,190 --> 00:10:38,870
several additional attacks most

203
00:10:36,950 --> 00:10:41,510
important all our customers have<font color="#E5E5E5"> been</font>

204
00:10:38,870 --> 00:10:46,340
protected from<font color="#E5E5E5"> moment</font><font color="#CCCCCC"> zero of these</font>

205
00:10:41,510 --> 00:10:49,760
attacks this<font color="#E5E5E5"> is a representation of the</font>

206
00:10:46,340 --> 00:10:52,400
one<font color="#E5E5E5"> Crytek by the way I really</font><font color="#CCCCCC"> hope that</font>

207
00:10:49,760 --> 00:10:54,950
everyone<font color="#E5E5E5"> here has heard about one cry</font>

208
00:10:52,400 --> 00:10:58,370
<font color="#E5E5E5">only from the news and not from an</font>

209
00:10:54,950 --> 00:11:00,230
<font color="#CCCCCC">incident here you can see how the attack</font>

210
00:10:58,370 --> 00:11:03,770
was blocked before<font color="#CCCCCC"> causing any damage</font>

211
00:11:00,230 --> 00:11:05,779
before encrypting any data so<font color="#E5E5E5"> how was</font>

212
00:11:03,770 --> 00:11:08,629
this<font color="#CCCCCC"> even possible</font>

213
00:11:05,779 --> 00:11:11,449
I will<font color="#CCCCCC"> bite</font><font color="#E5E5E5"> my colleague</font><font color="#CCCCCC"> Christie tell</font>

214
00:11:08,629 --> 00:11:14,540
you that and<font color="#E5E5E5"> also what obstacles did we</font>

215
00:11:11,449 --> 00:11:24,500
<font color="#E5E5E5">hit and how did we overcome them thank</font>

216
00:11:14,540 --> 00:11:29,269
<font color="#E5E5E5">you hi I'm Christie and I'm one of</font><font color="#CCCCCC"> the</font>

217
00:11:24,500 --> 00:11:30,889
lead edge<font color="#CCCCCC"> hi developers BitDefender</font><font color="#E5E5E5"> so</font>

218
00:11:29,269 --> 00:11:32,930
as I<font color="#E5E5E5"> mentioned the introspection</font>

219
00:11:30,889 --> 00:11:34,819
technique was proposed<font color="#E5E5E5"> several years</font><font color="#CCCCCC"> ago</font>

220
00:11:32,930 --> 00:11:37,370
as a way<font color="#CCCCCC"> of protecting</font><font color="#E5E5E5"> the system from</font>

221
00:11:34,819 --> 00:11:39,170
outside the system<font color="#E5E5E5"> itself well this was</font>

222
00:11:37,370 --> 00:11:40,819
more difficult back then<font color="#E5E5E5"> newer</font>

223
00:11:39,170 --> 00:11:43,490
<font color="#E5E5E5">technologies like the brutalization</font>

224
00:11:40,819 --> 00:11:45,589
extension of the<font color="#E5E5E5"> Intel CPU</font><font color="#CCCCCC"> make</font><font color="#E5E5E5"> it makes</font>

225
00:11:43,490 --> 00:11:47,149
this a lot<font color="#CCCCCC"> easier</font><font color="#E5E5E5"> today however there</font>

226
00:11:45,589 --> 00:11:47,750
<font color="#CCCCCC">are still challenges that we have to</font>

227
00:11:47,149 --> 00:11:50,449
<font color="#E5E5E5">overcome</font>

228
00:11:47,750 --> 00:11:53,120
<font color="#E5E5E5">like the semantic gap from the level of</font>

229
00:11:50,449 --> 00:11:56,420
<font color="#E5E5E5">the hypervisor</font><font color="#CCCCCC"> Hg I can only read</font>

230
00:11:53,120 --> 00:11:58,579
physical memory we have to give meaning

231
00:11:56,420 --> 00:12:00,800
to<font color="#E5E5E5"> those raw bytes and bridge the</font>

232
00:11:58,579 --> 00:12:03,349
semantic gap in<font color="#E5E5E5"> order to obtain a higher</font>

233
00:12:00,800 --> 00:12:06,589
level<font color="#CCCCCC"> view of the VM</font><font color="#E5E5E5"> memory there are</font>

234
00:12:03,350 --> 00:12:09,620
several<font color="#E5E5E5"> solutions to doing this but our</font>

235
00:12:06,589 --> 00:12:11,779
<font color="#E5E5E5">approach mixes data structures</font>

236
00:12:09,620 --> 00:12:14,389
<font color="#CCCCCC">invariance</font><font color="#E5E5E5"> and dynamic gas behavior</font>

237
00:12:11,779 --> 00:12:17,980
analysis in order<font color="#E5E5E5"> to obtain the location</font>

238
00:12:14,389 --> 00:12:21,829
<font color="#E5E5E5">of relevant objects inside the VM memory</font>

239
00:12:17,980 --> 00:12:24,009
once this is<font color="#E5E5E5"> done we can target our</font>

240
00:12:21,829 --> 00:12:26,029
protection in two<font color="#CCCCCC"> different</font><font color="#E5E5E5"> areas</font>

241
00:12:24,009 --> 00:12:28,519
protecting hardware resources and

242
00:12:26,029 --> 00:12:31,449
protecting<font color="#E5E5E5"> critical memory areas like</font>

243
00:12:28,519 --> 00:12:33,800
code<font color="#E5E5E5"> from the kernel</font><font color="#CCCCCC"> or drivers</font><font color="#E5E5E5"> and</font>

244
00:12:31,449 --> 00:12:35,689
certain<font color="#E5E5E5"> user</font><font color="#CCCCCC"> mode processes that are</font>

245
00:12:33,800 --> 00:12:39,229
typically<font color="#E5E5E5"> targeted by attacks such as</font>

246
00:12:35,689 --> 00:12:43,389
<font color="#E5E5E5">your word processing office office apps</font>

247
00:12:39,230 --> 00:12:43,389
<font color="#CCCCCC">applications and browser</font>

248
00:12:46,589 --> 00:12:51,810
<font color="#CCCCCC">H J can be</font><font color="#E5E5E5"> deployed in three different</font>

249
00:12:49,020 --> 00:12:54,569
<font color="#E5E5E5">scenarios the first proposed model is</font>

250
00:12:51,810 --> 00:12:57,119
with the<font color="#CCCCCC"> H J module placed directly</font>

251
00:12:54,570 --> 00:13:02,100
inside<font color="#E5E5E5"> the hypervisor this offers great</font>

252
00:12:57,120 --> 00:13:04,880
performance<font color="#CCCCCC"> as we are directly at the</font>

253
00:13:02,100 --> 00:13:07,170
core of the things<font color="#E5E5E5"> but it increases the</font>

254
00:13:04,880 --> 00:13:09,420
idea of a pack of the<font color="#E5E5E5"> hypervisor and</font>

255
00:13:07,170 --> 00:13:11,969
makes development<font color="#E5E5E5"> more tricky as for</font>

256
00:13:09,420 --> 00:13:14,189
example<font color="#E5E5E5"> an error in the H I module can</font>

257
00:13:11,970 --> 00:13:16,170
affect the entire<font color="#CCCCCC"> host</font><font color="#E5E5E5"> or we may not</font>

258
00:13:14,190 --> 00:13:18,660
have a<font color="#E5E5E5"> lot of memory because the</font>

259
00:13:16,170 --> 00:13:20,520
<font color="#E5E5E5">hypervisor is not able to</font><font color="#CCCCCC"> swap the</font>

260
00:13:18,660 --> 00:13:22,709
second approach<font color="#CCCCCC"> is to place the HP</font>

261
00:13:20,520 --> 00:13:26,400
module directly<font color="#E5E5E5"> inside the introspected</font>

262
00:13:22,710 --> 00:13:27,810
<font color="#E5E5E5">VMs the great advantage of this model</font><font color="#CCCCCC"> is</font>

263
00:13:26,400 --> 00:13:29,939
<font color="#CCCCCC">that it's really easy to</font><font color="#E5E5E5"> bridge</font><font color="#CCCCCC"> the</font>

264
00:13:27,810 --> 00:13:32,670
semantic gap but it<font color="#E5E5E5"> divides the</font><font color="#CCCCCC"> entire</font>

265
00:13:29,940 --> 00:13:36,630
<font color="#E5E5E5">isolation idea and the final model is</font>

266
00:13:32,670 --> 00:13:39,779
with<font color="#CCCCCC"> H VI</font><font color="#E5E5E5"> in dedicated security VM</font><font color="#CCCCCC"> this</font>

267
00:13:36,630 --> 00:13:42,420
offers great flexibility as we are<font color="#E5E5E5"> just</font>

268
00:13:39,779 --> 00:13:44,189
another normal<font color="#E5E5E5"> user mod process but less</font>

269
00:13:42,420 --> 00:13:48,290
performance as events need<font color="#CCCCCC"> to be</font>

270
00:13:44,190 --> 00:13:48,290
forwarded from<font color="#E5E5E5"> the hypervisor to the VM</font>

271
00:13:49,220 --> 00:13:55,589
<font color="#CCCCCC">another tricky part is the fact</font><font color="#E5E5E5"> that we</font>

272
00:13:53,370 --> 00:13:58,110
only<font color="#CCCCCC"> see physical memory but the VM is</font>

273
00:13:55,589 --> 00:13:59,910
using<font color="#CCCCCC"> virtual</font><font color="#E5E5E5"> memory in a utilized</font>

274
00:13:58,110 --> 00:14:03,660
environment<font color="#E5E5E5"> there are two level of</font>

275
00:13:59,910 --> 00:14:05,939
memory translation<font color="#E5E5E5"> first one translates</font>

276
00:14:03,660 --> 00:14:08,699
<font color="#CCCCCC">guest linear</font><font color="#E5E5E5"> addresses to guest physical</font>

277
00:14:05,940 --> 00:14:10,940
addresses using<font color="#E5E5E5"> in guest legacy page</font>

278
00:14:08,700 --> 00:14:13,860
table and the second one translates

279
00:14:10,940 --> 00:14:15,900
guest physical addresses to<font color="#E5E5E5"> host</font>

280
00:14:13,860 --> 00:14:18,720
physical addresses using<font color="#CCCCCC"> the extended</font>

281
00:14:15,900 --> 00:14:20,490
page table<font color="#E5E5E5"> the legacy page table</font>

282
00:14:18,720 --> 00:14:24,029
contains the<font color="#E5E5E5"> access rights of the memory</font>

283
00:14:20,490 --> 00:14:26,310
as<font color="#CCCCCC"> set by the guest and security tools</font>

284
00:14:24,029 --> 00:14:28,140
cannot modify or inspect those because

285
00:14:26,310 --> 00:14:31,079
messing with the operating system<font color="#E5E5E5"> memory</font>

286
00:14:28,140 --> 00:14:33,449
manager is<font color="#E5E5E5"> always a bad idea</font><font color="#CCCCCC"> and may</font>

287
00:14:31,080 --> 00:14:34,589
crash the guest<font color="#E5E5E5"> however the EPT is</font>

288
00:14:33,450 --> 00:14:37,170
entirely<font color="#E5E5E5"> controlled by the hypervisor</font>

289
00:14:34,589 --> 00:14:40,260
<font color="#E5E5E5">and</font><font color="#CCCCCC"> Hg I can place additional</font>

290
00:14:37,170 --> 00:14:45,120
restrictions on memory blocking several

291
00:14:40,260 --> 00:14:47,120
types<font color="#E5E5E5"> of attacks typically it removes</font>

292
00:14:45,120 --> 00:14:49,680
the<font color="#CCCCCC"> right permission from read-only</font>

293
00:14:47,120 --> 00:14:51,779
memory areas such as<font color="#E5E5E5"> code section or</font>

294
00:14:49,680 --> 00:14:54,300
critical data structures and<font color="#E5E5E5"> the</font>

295
00:14:51,779 --> 00:14:55,770
execution permission from pages<font color="#E5E5E5"> that</font>

296
00:14:54,300 --> 00:14:58,319
should not be<font color="#CCCCCC"> executed</font><font color="#E5E5E5"> like the stack</font><font color="#CCCCCC"> or</font>

297
00:14:55,770 --> 00:14:59,640
<font color="#CCCCCC">the</font><font color="#E5E5E5"> heap trying to write</font><font color="#CCCCCC"> to those</font><font color="#E5E5E5"> pages</font>

298
00:14:58,320 --> 00:15:02,060
or to<font color="#CCCCCC"> execute</font><font color="#E5E5E5"> from those</font>

299
00:14:59,640 --> 00:15:04,260
will trigger an<font color="#CCCCCC"> EPT violation</font>

300
00:15:02,060 --> 00:15:06,599
transitioning<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> guest to the</font>

301
00:15:04,260 --> 00:15:10,410
hypervisor<font color="#E5E5E5"> and then HVAC</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> inspect the</font>

302
00:15:06,600 --> 00:15:12,890
<font color="#E5E5E5">access and lock it if if necessary one</font>

303
00:15:10,410 --> 00:15:15,089
problem that arises here is that the EPT

304
00:15:12,890 --> 00:15:18,060
<font color="#E5E5E5">controls the translation from</font><font color="#CCCCCC"> guest</font>

305
00:15:15,089 --> 00:15:20,190
physical pages<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> hosts physical</font>

306
00:15:18,060 --> 00:15:23,609
<font color="#CCCCCC">pages which means that our protection is</font>

307
00:15:20,190 --> 00:15:26,220
set on guest physical memory<font color="#E5E5E5"> but the</font>

308
00:15:23,610 --> 00:15:29,100
guest is using linear addresses<font color="#E5E5E5"> so in</font>

309
00:15:26,220 --> 00:15:30,899
<font color="#CCCCCC">order to offer a proper protection we</font>

310
00:15:29,100 --> 00:15:33,779
need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> maintain a proper mapping</font>

311
00:15:30,899 --> 00:15:36,269
between the<font color="#E5E5E5"> linear addresses</font><font color="#CCCCCC"> used by the</font>

312
00:15:33,779 --> 00:15:38,550
guest and the physical addresses<font color="#E5E5E5"> we</font>

313
00:15:36,269 --> 00:15:41,220
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> seem protect this is done by</font>

314
00:15:38,550 --> 00:15:44,519
intercepting<font color="#CCCCCC"> writes to</font><font color="#E5E5E5"> the page tables</font>

315
00:15:41,220 --> 00:15:47,040
using the<font color="#CCCCCC"> EPT</font><font color="#E5E5E5"> when the memory manager of</font>

316
00:15:44,519 --> 00:15:49,680
the OS changes<font color="#E5E5E5"> something</font><font color="#CCCCCC"> in the page</font>

317
00:15:47,040 --> 00:15:52,529
tables an EPT violation is triggered<font color="#E5E5E5"> and</font>

318
00:15:49,680 --> 00:15:54,479
we can adjust<font color="#E5E5E5"> our protection policies</font>

319
00:15:52,529 --> 00:15:56,220
accordingly<font color="#CCCCCC"> for example if a page is</font>

320
00:15:54,480 --> 00:15:58,470
<font color="#E5E5E5">swapped out we remove the protection</font><font color="#CCCCCC"> if</font>

321
00:15:56,220 --> 00:16:00,779
it is<font color="#CCCCCC"> opted in</font><font color="#E5E5E5"> we add the protection and</font>

322
00:15:58,470 --> 00:16:02,970
if the translation translation<font color="#E5E5E5"> itself is</font>

323
00:16:00,779 --> 00:16:06,480
moved<font color="#E5E5E5"> we move the protection</font><font color="#CCCCCC"> to the new</font>

324
00:16:02,970 --> 00:16:10,110
page this<font color="#CCCCCC"> is where our performance</font>

325
00:16:06,480 --> 00:16:12,899
concerns<font color="#E5E5E5"> start to rise up most apt</font>

326
00:16:10,110 --> 00:16:15,180
violations are generated by<font color="#CCCCCC"> writes</font>

327
00:16:12,899 --> 00:16:17,420
inside the page tables and a huge amount

328
00:16:15,180 --> 00:16:19,819
<font color="#CCCCCC">of those are not really relevant for us</font>

329
00:16:17,420 --> 00:16:22,709
there<font color="#E5E5E5"> are two sources of</font><font color="#CCCCCC"> rights that</font>

330
00:16:19,820 --> 00:16:26,040
<font color="#CCCCCC">trigger this the first one</font><font color="#E5E5E5"> is the CPU</font>

331
00:16:22,709 --> 00:16:28,619
itself<font color="#E5E5E5"> when doing a page</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> the CPU</font>

332
00:16:26,040 --> 00:16:31,290
may try<font color="#CCCCCC"> to set the access of</font><font color="#E5E5E5"> dirty bits</font>

333
00:16:28,620 --> 00:16:33,779
inside the page tables<font color="#E5E5E5"> and this triggers</font>

334
00:16:31,290 --> 00:16:36,260
an EPT violation these bits are set

335
00:16:33,779 --> 00:16:38,610
atomically<font color="#CCCCCC"> in each level of translation</font>

336
00:16:36,260 --> 00:16:40,890
<font color="#CCCCCC">so</font><font color="#E5E5E5"> even if we do not want it or all</font>

337
00:16:38,610 --> 00:16:43,560
levels<font color="#E5E5E5"> will still get an exit due</font><font color="#CCCCCC"> to</font>

338
00:16:40,890 --> 00:16:46,649
this effect<font color="#E5E5E5"> another source of Rights is</font>

339
00:16:43,560 --> 00:16:48,779
<font color="#CCCCCC">the memory manager itself which may do</font>

340
00:16:46,649 --> 00:16:50,850
very frequent<font color="#CCCCCC"> writes for example</font>

341
00:16:48,779 --> 00:16:52,500
starting with<font color="#E5E5E5"> restaurant for windows</font>

342
00:16:50,850 --> 00:16:54,360
added some locking bits<font color="#E5E5E5"> to the page</font>

343
00:16:52,500 --> 00:16:57,360
table entries which are<font color="#CCCCCC"> accessed quite</font>

344
00:16:54,360 --> 00:16:58,709
often<font color="#E5E5E5"> but even</font><font color="#CCCCCC"> without this change</font><font color="#E5E5E5"> there</font>

345
00:16:57,360 --> 00:17:02,130
<font color="#E5E5E5">are still a lot of</font><font color="#CCCCCC"> rights that</font><font color="#E5E5E5"> not</font>

346
00:16:58,709 --> 00:17:04,770
interests us because we only care<font color="#CCCCCC"> about</font>

347
00:17:02,130 --> 00:17:07,550
a small subset of those only<font color="#CCCCCC"> rights that</font>

348
00:17:04,770 --> 00:17:10,939
modify control bits of translation<font color="#E5E5E5"> bits</font>

349
00:17:07,550 --> 00:17:12,819
<font color="#E5E5E5">here</font><font color="#CCCCCC"> are some results from redstone</font><font color="#E5E5E5"> for</font>

350
00:17:10,939 --> 00:17:14,559
<font color="#CCCCCC">two</font><font color="#E5E5E5"> percent of</font>

351
00:17:12,819 --> 00:17:17,109
violations are done<font color="#E5E5E5"> outside the page</font>

352
00:17:14,559 --> 00:17:18,638
tables and from the<font color="#CCCCCC"> Rights done inside</font>

353
00:17:17,109 --> 00:17:22,629
<font color="#E5E5E5">the page tables only</font><font color="#CCCCCC"> eight percent</font><font color="#E5E5E5"> are</font>

354
00:17:18,638 --> 00:17:25,208
relevant for<font color="#E5E5E5"> us we can improve on this</font>

355
00:17:22,630 --> 00:17:26,980
by using newer<font color="#CCCCCC"> Intertek knowledge ease</font>

356
00:17:25,209 --> 00:17:28,840
<font color="#E5E5E5">like the beetle ization exception and</font>

357
00:17:26,980 --> 00:17:31,299
the<font color="#E5E5E5"> vm from construction the</font>

358
00:17:28,840 --> 00:17:33,580
vitalization exception allows<font color="#E5E5E5"> us to</font>

359
00:17:31,299 --> 00:17:34,750
<font color="#E5E5E5">convert certain EPT violation to an</font>

360
00:17:33,580 --> 00:17:38,830
exception<font color="#CCCCCC"> that is delivered to the</font>

361
00:17:34,750 --> 00:17:40,870
<font color="#CCCCCC">guests without</font><font color="#E5E5E5"> triggering a</font><font color="#CCCCCC"> VM exit so</font>

362
00:17:38,830 --> 00:17:43,960
we can move a tiny part of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> HDI logic</font>

363
00:17:40,870 --> 00:17:47,709
inside the<font color="#CCCCCC"> guest and</font><font color="#E5E5E5"> let it filter these</font>

364
00:17:43,960 --> 00:17:51,070
events we then can protect this stub

365
00:17:47,710 --> 00:17:52,750
from<font color="#E5E5E5"> the rest of the guests by placing</font>

366
00:17:51,070 --> 00:17:54,549
it enough different physical address

367
00:17:52,750 --> 00:17:56,980
space<font color="#E5E5E5"> and then we can switch between</font>

368
00:17:54,549 --> 00:17:58,899
these physical address spaces using<font color="#CCCCCC"> the</font>

369
00:17:56,980 --> 00:18:00,759
<font color="#CCCCCC">VM funk instruction the VM funk</font>

370
00:17:58,899 --> 00:18:03,939
instruction allows the<font color="#CCCCCC"> guest</font><font color="#E5E5E5"> to execute</font>

371
00:18:00,759 --> 00:18:06,519
<font color="#CCCCCC">certain actions without</font><font color="#E5E5E5"> actually</font>

372
00:18:03,940 --> 00:18:08,710
triggering<font color="#E5E5E5"> a VM exit the only function</font>

373
00:18:06,519 --> 00:18:11,320
<font color="#E5E5E5">defined so</font><font color="#CCCCCC"> far by</font><font color="#E5E5E5"> Intel is the</font><font color="#CCCCCC"> apt</font>

374
00:18:08,710 --> 00:18:13,539
switch function<font color="#E5E5E5"> which will change the</font>

375
00:18:11,320 --> 00:18:17,168
current EPT therefore change the current

376
00:18:13,539 --> 00:18:19,570
physical address space<font color="#CCCCCC"> the filtering</font>

377
00:18:17,169 --> 00:18:22,720
stub is a kernel mode driver

378
00:18:19,570 --> 00:18:24,250
it could be pre-installed<font color="#CCCCCC"> in the VM but</font>

379
00:18:22,720 --> 00:18:27,370
that would make it vulnerable to attacks

380
00:18:24,250 --> 00:18:28,840
and it also has the added<font color="#E5E5E5"> disadvantage</font>

381
00:18:27,370 --> 00:18:31,719
of having<font color="#CCCCCC"> to install</font><font color="#E5E5E5"> and maintain an</font>

382
00:18:28,840 --> 00:18:35,709
agent in each VM<font color="#E5E5E5"> instead we dynamically</font>

383
00:18:31,720 --> 00:18:38,230
inject it<font color="#E5E5E5"> whenever it is necessary both</font>

384
00:18:35,710 --> 00:18:40,509
the filtering<font color="#E5E5E5"> stub</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the main</font><font color="#CCCCCC"> hy</font>

385
00:18:38,230 --> 00:18:43,090
component have the task of<font color="#CCCCCC"> setting up</font>

386
00:18:40,509 --> 00:18:46,059
the environment<font color="#E5E5E5"> first</font><font color="#CCCCCC"> hei creates that</font>

387
00:18:43,090 --> 00:18:48,699
new security<font color="#CCCCCC"> team in which</font><font color="#E5E5E5"> the filtering</font>

388
00:18:46,059 --> 00:18:51,250
<font color="#CCCCCC">stub will</font><font color="#E5E5E5"> be placed then hy configures</font>

389
00:18:48,700 --> 00:18:53,379
hardware support<font color="#CCCCCC"> for this</font><font color="#E5E5E5"> and injects</font>

390
00:18:51,250 --> 00:18:55,480
the filtering<font color="#E5E5E5"> stop the filter next up</font>

391
00:18:53,379 --> 00:18:58,750
simply intercepts the vaporization

392
00:18:55,480 --> 00:19:01,149
exception handler of<font color="#E5E5E5"> the US and then</font><font color="#CCCCCC"> hei</font>

393
00:18:58,750 --> 00:19:02,919
can mark certain pages<font color="#E5E5E5"> as convertible</font>

394
00:19:01,149 --> 00:19:04,870
<font color="#E5E5E5">which means that instead of an EPT</font>

395
00:19:02,919 --> 00:19:06,730
violation<font color="#E5E5E5"> will receive an exception in</font>

396
00:19:04,870 --> 00:19:10,899
the guest<font color="#E5E5E5"> and now the stub can do its</font>

397
00:19:06,730 --> 00:19:13,149
<font color="#E5E5E5">job due</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> fact that it runs inside</font>

398
00:19:10,899 --> 00:19:15,070
the<font color="#E5E5E5"> guest the</font><font color="#CCCCCC"> stub is vulnerable to</font>

399
00:19:13,149 --> 00:19:18,100
attacks from<font color="#CCCCCC"> the untrusted</font><font color="#E5E5E5"> kernel or</font>

400
00:19:15,070 --> 00:19:20,350
certain applications so<font color="#CCCCCC"> besides creating</font>

401
00:19:18,100 --> 00:19:22,330
<font color="#CCCCCC">the besides creating</font><font color="#E5E5E5"> that security PT</font>

402
00:19:20,350 --> 00:19:25,600
view<font color="#E5E5E5"> we</font><font color="#CCCCCC"> place additional restrictions on</font>

403
00:19:22,330 --> 00:19:26,540
memory<font color="#CCCCCC"> the stub is read-only for</font><font color="#E5E5E5"> the</font>

404
00:19:25,600 --> 00:19:28,969
rest<font color="#E5E5E5"> of the guest</font>

405
00:19:26,540 --> 00:19:30,710
in the untrusted<font color="#CCCCCC"> tippity view so an</font>

406
00:19:28,970 --> 00:19:34,220
attacker cannot<font color="#E5E5E5"> temperate our code and</font>

407
00:19:30,710 --> 00:19:36,650
data and overwrite us also<font color="#CCCCCC"> the rest of</font>

408
00:19:34,220 --> 00:19:40,010
the<font color="#CCCCCC"> US while being mapped it will</font><font color="#E5E5E5"> rights</font>

409
00:19:36,650 --> 00:19:42,500
in the<font color="#E5E5E5"> untrusted</font><font color="#CCCCCC"> EPT is only read</font>

410
00:19:40,010 --> 00:19:44,330
<font color="#CCCCCC">writing the trusted view we do this</font>

411
00:19:42,500 --> 00:19:46,190
because we<font color="#CCCCCC"> do not want an attacker to</font><font color="#E5E5E5"> be</font>

412
00:19:44,330 --> 00:19:48,889
able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> execute its code in the trusted</font>

413
00:19:46,190 --> 00:19:51,950
you<font color="#E5E5E5"> and we also need the</font><font color="#CCCCCC"> tempering page</font>

414
00:19:48,890 --> 00:19:55,310
<font color="#E5E5E5">for switching between the</font><font color="#CCCCCC"> views which is</font>

415
00:19:51,950 --> 00:19:58,180
executable<font color="#CCCCCC"> above</font><font color="#E5E5E5"> a PT's now we can</font>

416
00:19:55,310 --> 00:20:00,770
safely<font color="#E5E5E5"> filter base table accesses and</font>

417
00:19:58,180 --> 00:20:03,050
based on the source of<font color="#CCCCCC"> the right and</font><font color="#E5E5E5"> the</font>

418
00:20:00,770 --> 00:20:06,530
<font color="#CCCCCC">wait modifies memory there are different</font>

419
00:20:03,050 --> 00:20:09,740
methods<font color="#CCCCCC"> of handling it</font><font color="#E5E5E5"> for CPU</font><font color="#CCCCCC"> page</font>

420
00:20:06,530 --> 00:20:12,440
worker induced<font color="#E5E5E5"> writes this is trivial</font><font color="#CCCCCC"> a</font>

421
00:20:09,740 --> 00:20:14,990
bit will be set in<font color="#CCCCCC"> the information field</font>

422
00:20:12,440 --> 00:20:17,540
<font color="#E5E5E5">of the exception so it is easy to check</font>

423
00:20:14,990 --> 00:20:19,160
<font color="#E5E5E5">it is trivial to handle normally if this</font>

424
00:20:17,540 --> 00:20:21,170
will trigger an EPT violation we will

425
00:20:19,160 --> 00:20:24,890
have to either do a full page<font color="#CCCCCC"> walk</font>

426
00:20:21,170 --> 00:20:26,360
emulation or<font color="#E5E5E5"> to a single step in order</font>

427
00:20:24,890 --> 00:20:28,790
<font color="#E5E5E5">to ensure that all the proper action are</font>

428
00:20:26,360 --> 00:20:30,409
taken<font color="#E5E5E5"> but since we are now in the guest</font>

429
00:20:28,790 --> 00:20:33,830
context and we have access<font color="#E5E5E5"> to its memory</font>

430
00:20:30,410 --> 00:20:35,780
<font color="#E5E5E5">we can simply access that page wants one</font>

431
00:20:33,830 --> 00:20:38,510
more<font color="#E5E5E5"> time and the new page</font><font color="#CCCCCC"> what could be</font>

432
00:20:35,780 --> 00:20:40,129
triggered for memory manager induced

433
00:20:38,510 --> 00:20:42,680
writes<font color="#E5E5E5"> it is more complicated</font>

434
00:20:40,130 --> 00:20:45,140
<font color="#CCCCCC">first we</font><font color="#E5E5E5"> need</font><font color="#CCCCCC"> to decode the instruction</font>

435
00:20:42,680 --> 00:20:47,480
that<font color="#CCCCCC"> does the access in</font><font color="#E5E5E5"> order to obtain</font>

436
00:20:45,140 --> 00:20:49,490
the new<font color="#CCCCCC"> written value then we compared</font>

437
00:20:47,480 --> 00:20:51,590
the new value with the old value and<font color="#E5E5E5"> if</font>

438
00:20:49,490 --> 00:20:54,890
the right is<font color="#E5E5E5"> relevant we trigger a VM</font>

439
00:20:51,590 --> 00:20:56,600
exit and let<font color="#CCCCCC"> hv8 handle the access if it</font>

440
00:20:54,890 --> 00:20:59,060
is not<font color="#CCCCCC"> real relevant we have to emulate</font>

441
00:20:56,600 --> 00:21:00,649
<font color="#E5E5E5">it</font><font color="#CCCCCC"> but this is straightforward again we</font>

442
00:20:59,060 --> 00:21:04,970
<font color="#CCCCCC">note the value and we can</font><font color="#E5E5E5"> simply write</font>

443
00:21:00,650 --> 00:21:07,550
it to<font color="#E5E5E5"> the base table</font><font color="#CCCCCC"> we run a series of</font>

444
00:21:04,970 --> 00:21:10,370
benchmarks<font color="#E5E5E5"> and seen here is a benchmark</font>

445
00:21:07,550 --> 00:21:11,570
<font color="#CCCCCC">done on redstone</font><font color="#E5E5E5"> for using the Chrome</font>

446
00:21:10,370 --> 00:21:13,729
browser in different processing

447
00:21:11,570 --> 00:21:17,000
scenarios and measuring the load time of

448
00:21:13,730 --> 00:21:19,610
<font color="#E5E5E5">pages in in three cases now</font><font color="#CCCCCC"> hvi</font>

449
00:21:17,000 --> 00:21:21,590
traditional<font color="#CCCCCC"> hvi and HDI with the</font>

450
00:21:19,610 --> 00:21:23,449
virtualization exception improvement<font color="#E5E5E5"> and</font>

451
00:21:21,590 --> 00:21:27,379
in some cases the page loaded three

452
00:21:23,450 --> 00:21:29,920
times faster<font color="#E5E5E5"> so</font><font color="#CCCCCC"> new technologies really</font>

453
00:21:27,380 --> 00:21:33,050
really help us improve<font color="#E5E5E5"> performance and</font>

454
00:21:29,920 --> 00:21:37,590
now I'm going<font color="#E5E5E5"> to let roll</font><font color="#CCCCCC"> give us some</font>

455
00:21:33,050 --> 00:21:40,399
closing remarks<font color="#E5E5E5"> thank you</font>

456
00:21:37,590 --> 00:21:43,320
[Applause]

457
00:21:40,400 --> 00:21:47,550
so to summarize<font color="#E5E5E5"> everything in just a few</font>

458
00:21:43,320 --> 00:21:51,090
words security never just happens it

459
00:21:47,550 --> 00:21:53,610
<font color="#CCCCCC">doesn't just happen it's a state which</font>

460
00:21:51,090 --> 00:21:57,300
requires<font color="#E5E5E5"> constant effort to be preserved</font>

461
00:21:53,610 --> 00:22:01,219
<font color="#CCCCCC">I think about the laws</font><font color="#E5E5E5"> of thermodynamics</font>

462
00:21:57,300 --> 00:22:06,720
is just like<font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to maintain</font><font color="#E5E5E5"> a system</font>

463
00:22:01,220 --> 00:22:08,820
<font color="#E5E5E5">in an ordered low entropy state second</font>

464
00:22:06,720 --> 00:22:11,220
you<font color="#E5E5E5"> can leverage your hypervisor</font><font color="#CCCCCC"> to do</font>

465
00:22:08,820 --> 00:22:15,120
this for you<font color="#E5E5E5"> to provide that required</font>

466
00:22:11,220 --> 00:22:18,540
amount but also efficiency of<font color="#CCCCCC"> energy to</font>

467
00:22:15,120 --> 00:22:19,860
keep<font color="#E5E5E5"> you safe</font><font color="#CCCCCC"> this approach of using</font>

468
00:22:18,540 --> 00:22:22,649
virtualization technologies to

469
00:22:19,860 --> 00:22:25,199
introspect<font color="#CCCCCC"> VMs</font><font color="#E5E5E5"> has proven effective and</font>

470
00:22:22,650 --> 00:22:28,470
with virtualization<font color="#E5E5E5"> technologies are</font>

471
00:22:25,200 --> 00:22:30,360
constantly constantly improving<font color="#E5E5E5"> allowing</font>

472
00:22:28,470 --> 00:22:33,150
better performance for<font color="#E5E5E5"> this kind of</font>

473
00:22:30,360 --> 00:22:36,060
<font color="#E5E5E5">security solutions actually there's a</font>

474
00:22:33,150 --> 00:22:39,440
one improvement coming later this<font color="#CCCCCC"> year</font>

475
00:22:36,060 --> 00:22:41,879
from Intel<font color="#CCCCCC"> called</font><font color="#E5E5E5"> sub page permissions</font>

476
00:22:39,440 --> 00:22:45,450
<font color="#E5E5E5">which allows us to</font><font color="#CCCCCC"> protect memory</font>

477
00:22:41,880 --> 00:22:49,080
regions with granularity smaller than<font color="#CCCCCC"> 4k</font>

478
00:22:45,450 --> 00:22:50,640
page so instead of monitoring<font color="#E5E5E5"> an entire</font>

479
00:22:49,080 --> 00:22:56,490
memory<font color="#E5E5E5"> page to protect for example</font>

480
00:22:50,640 --> 00:22:59,970
<font color="#E5E5E5">accesses to 128 bytes structure SBP</font>

481
00:22:56,490 --> 00:23:02,010
allows us to monitor<font color="#E5E5E5"> only accesses</font><font color="#CCCCCC"> to</font>

482
00:22:59,970 --> 00:23:04,580
that small structure imagine what

483
00:23:02,010 --> 00:23:07,410
<font color="#E5E5E5">performance improvements will bring that</font>

484
00:23:04,580 --> 00:23:13,409
so you might be<font color="#E5E5E5"> hearing again from us</font>

485
00:23:07,410 --> 00:23:15,270
soon<font color="#CCCCCC"> also you can check out labs EE</font>

486
00:23:13,410 --> 00:23:17,760
final come to see what our<font color="#E5E5E5"> labs are</font>

487
00:23:15,270 --> 00:23:20,190
<font color="#CCCCCC">working on there's a bunch of cool stuff</font>

488
00:23:17,760 --> 00:23:23,310
and useful resources there such as great

489
00:23:20,190 --> 00:23:25,740
blog articles white papers<font color="#CCCCCC"> ransomware</font>

490
00:23:23,310 --> 00:23:34,169
decryption tools<font color="#E5E5E5"> although I really hope</font>

491
00:23:25,740 --> 00:23:34,860
you won't<font color="#E5E5E5"> ever need those then there's</font>

492
00:23:34,170 --> 00:23:37,260
this awesome

493
00:23:34,860 --> 00:23:41,879
<font color="#CCCCCC">threat map which is</font><font color="#E5E5E5"> always cool just to</font>

494
00:23:37,260 --> 00:23:43,530
<font color="#E5E5E5">sit and watch who's attacking whom that</font>

495
00:23:41,880 --> 00:23:48,390
being said thank you<font color="#E5E5E5"> once again and</font>

496
00:23:43,530 --> 00:23:51,690
let's see<font color="#CCCCCC"> if</font><font color="#E5E5E5"> we have any</font><font color="#CCCCCC"> questions any</font>

497
00:23:48,390 --> 00:23:54,680
questions from<font color="#E5E5E5"> the audience</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> sir</font>

498
00:23:51,690 --> 00:23:54,680
<font color="#E5E5E5">coming right on up</font>

499
00:23:56,270 --> 00:24:01,110
thank you for the<font color="#E5E5E5"> interpreting</font>

500
00:23:58,080 --> 00:24:03,810
presentation<font color="#CCCCCC"> there are a lot of samples</font>

501
00:24:01,110 --> 00:24:06,300
<font color="#E5E5E5">that can detect virtual machine how do</font>

502
00:24:03,810 --> 00:24:10,370
you address this problem<font color="#E5E5E5"> if you have</font>

503
00:24:06,300 --> 00:24:13,020
some<font color="#CCCCCC"> insight about the problem of</font>

504
00:24:10,370 --> 00:24:14,669
<font color="#CCCCCC">virtual machine detection</font><font color="#E5E5E5"> you know</font><font color="#CCCCCC"> mal</font>

505
00:24:13,020 --> 00:24:17,250
work and the text virtual machine and

506
00:24:14,670 --> 00:24:21,510
<font color="#E5E5E5">just</font><font color="#CCCCCC"> await execution in such environment</font>

507
00:24:17,250 --> 00:24:24,810
the solution is intended specifically

508
00:24:21,510 --> 00:24:27,660
for virtualized environments<font color="#E5E5E5"> so if a</font>

509
00:24:24,810 --> 00:24:29,970
malware detects<font color="#CCCCCC"> it run is a virtual</font>

510
00:24:27,660 --> 00:24:32,400
machine<font color="#CCCCCC"> if the</font><font color="#E5E5E5"> virtual machine is</font>

511
00:24:29,970 --> 00:24:35,610
intended to<font color="#E5E5E5"> run on top of a hypervisor</font>

512
00:24:32,400 --> 00:24:39,180
<font color="#CCCCCC">so if the malware refuses to run it's</font>

513
00:24:35,610 --> 00:24:42,689
better<font color="#CCCCCC"> so it's</font><font color="#E5E5E5"> okay so it exactly</font>

514
00:24:39,180 --> 00:24:52,380
doesn't matter that the malware<font color="#E5E5E5"> detects</font>

515
00:24:42,690 --> 00:24:55,320
it's running in a virtual<font color="#E5E5E5"> machine our</font>

516
00:24:52,380 --> 00:25:00,620
customers use virtual machines<font color="#E5E5E5"> already</font>

517
00:24:55,320 --> 00:25:06,210
so it that the solution<font color="#E5E5E5"> is targeted for</font>

518
00:25:00,620 --> 00:25:10,979
virtualized environments<font color="#E5E5E5"> okay anyone</font>

519
00:25:06,210 --> 00:25:13,500
<font color="#E5E5E5">else no one</font><font color="#CCCCCC"> online</font><font color="#E5E5E5"> it looks</font><font color="#CCCCCC"> like we just</font>

520
00:25:10,980 --> 00:25:14,710
<font color="#CCCCCC">had a great talk</font><font color="#E5E5E5"> so thank you guys it's</font>

521
00:25:13,500 --> 00:25:20,450
been<font color="#CCCCCC"> a pleasure</font>

522
00:25:14,710 --> 00:25:20,450
[Applause]

