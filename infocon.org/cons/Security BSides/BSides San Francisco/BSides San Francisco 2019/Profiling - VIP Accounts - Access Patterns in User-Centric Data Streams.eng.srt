1
00:00:00,030 --> 00:00:06,180
well thank you<font color="#CCCCCC"> very much for taking the</font>

2
00:00:01,709 --> 00:00:08,880
<font color="#CCCCCC">time to come and</font><font color="#E5E5E5"> see us today well we're</font>

3
00:00:06,180 --> 00:00:12,330
going<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> about profiling</font><font color="#E5E5E5"> VIP access</font>

4
00:00:08,880 --> 00:00:15,719
patterns in user<font color="#CCCCCC"> CENTAC centric data</font>

5
00:00:12,330 --> 00:00:20,460
streams<font color="#CCCCCC"> the TLDR that is basically try</font>

6
00:00:15,719 --> 00:00:23,939
to find out if a a VIP account and I VAP

7
00:00:20,460 --> 00:00:29,880
account<font color="#CCCCCC"> Ain can vary depending on the</font>

8
00:00:23,939 --> 00:00:32,189
context<font color="#CCCCCC"> and is at times is</font><font color="#E5E5E5"> very</font>

9
00:00:29,880 --> 00:00:36,239
difficult<font color="#E5E5E5"> if you're able for example</font><font color="#CCCCCC"> to</font>

10
00:00:32,189 --> 00:00:40,010
<font color="#E5E5E5">do a lot of</font><font color="#CCCCCC"> moment type of attack</font><font color="#E5E5E5"> like a</font>

11
00:00:36,239 --> 00:00:45,660
pasta hash or or<font color="#E5E5E5"> pass the ticket and</font>

12
00:00:40,010 --> 00:00:48,239
impersonate a<font color="#CCCCCC"> VAP account is it's almost</font>

13
00:00:45,660 --> 00:00:50,339
<font color="#CCCCCC">impossible to</font><font color="#E5E5E5"> tell</font><font color="#CCCCCC"> if you follow</font>

14
00:00:48,239 --> 00:00:54,510
<font color="#E5E5E5">patterns of behavior of an administrator</font>

15
00:00:50,340 --> 00:00:56,160
<font color="#CCCCCC">a technique that you can do post</font>

16
00:00:54,510 --> 00:00:58,140
exploitation<font color="#E5E5E5"> and that's where we're</font>

17
00:00:56,160 --> 00:01:02,669
going<font color="#CCCCCC"> to talk about today how we're</font>

18
00:00:58,140 --> 00:01:03,629
trying to approach<font color="#CCCCCC"> this</font><font color="#E5E5E5"> this problem so</font>

19
00:01:02,670 --> 00:01:06,810
who<font color="#E5E5E5"> are we</font>

20
00:01:03,629 --> 00:01:09,509
<font color="#CCCCCC">my name is rod sorrow and</font><font color="#E5E5E5"> I've been in</font>

21
00:01:06,810 --> 00:01:11,790
the industry<font color="#E5E5E5"> for a little bit I run a</font>

22
00:01:09,510 --> 00:01:14,670
<font color="#E5E5E5">hackerspace here in Silicon Valley</font>

23
00:01:11,790 --> 00:01:17,990
<font color="#E5E5E5">called Pacific hackers we also have a</font>

24
00:01:14,670 --> 00:01:21,060
conference<font color="#E5E5E5"> in November and I'm here with</font>

25
00:01:17,990 --> 00:01:23,310
Joe<font color="#E5E5E5"> today which</font><font color="#CCCCCC"> is my partner</font><font color="#E5E5E5"> in crime</font>

26
00:01:21,060 --> 00:01:26,700
we've been working together for<font color="#CCCCCC"> over</font>

27
00:01:23,310 --> 00:01:28,500
four<font color="#CCCCCC"> years now</font><font color="#E5E5E5"> since we started</font><font color="#CCCCCC"> working</font>

28
00:01:26,700 --> 00:01:32,759
together at<font color="#E5E5E5"> capito because</font><font color="#CCCCCC"> fear was a</font>

29
00:01:28,500 --> 00:01:34,530
you be a<font color="#CCCCCC"> start-up was acquired by Splunk</font>

30
00:01:32,759 --> 00:01:36,479
<font color="#CCCCCC">then we were sprung for two years and</font>

31
00:01:34,530 --> 00:01:45,600
then<font color="#E5E5E5"> we move on to</font><font color="#CCCCCC"> jasc</font>

32
00:01:36,479 --> 00:01:48,299
<font color="#E5E5E5">and now he says</font><font color="#CCCCCC"> core light so like I</font>

33
00:01:45,600 --> 00:01:52,289
<font color="#CCCCCC">mentioned previously the the goal of</font>

34
00:01:48,299 --> 00:01:57,890
<font color="#E5E5E5">this talk is a the bottom line is can we</font>

35
00:01:52,290 --> 00:02:06,110
tell<font color="#CCCCCC"> if a VIP account either</font><font color="#E5E5E5"> an admin</font>

36
00:01:57,890 --> 00:02:08,878
either a sequel is a a<font color="#E5E5E5"> root account or</font>

37
00:02:06,110 --> 00:02:12,450
<font color="#CCCCCC">he's super admin I seen that and</font>

38
00:02:08,878 --> 00:02:13,200
organizations I have a very long tenure

39
00:02:12,450 --> 00:02:18,500
as

40
00:02:13,200 --> 00:02:18,500
<font color="#E5E5E5">windows</font><font color="#CCCCCC"> engineer and I've seen a</font><font color="#E5E5E5"> lot of</font>

41
00:02:18,560 --> 00:02:27,390
<font color="#CCCCCC">admins of admins and</font><font color="#E5E5E5"> super admins can we</font>

42
00:02:24,510 --> 00:02:30,149
tell if<font color="#E5E5E5"> this accounts either</font><font color="#CCCCCC"> had been</font>

43
00:02:27,390 --> 00:02:33,359
compromised<font color="#E5E5E5"> or they are behaving in a</font>

44
00:02:30,150 --> 00:02:37,940
<font color="#CCCCCC">manner that</font><font color="#E5E5E5"> is dangerous</font><font color="#CCCCCC"> so we</font><font color="#E5E5E5"> will look</font>

45
00:02:33,360 --> 00:02:41,099
<font color="#CCCCCC">a little</font><font color="#E5E5E5"> bit of the malicious insider so</font>

46
00:02:37,940 --> 00:02:43,379
how is this defined as VIP<font color="#E5E5E5"> the</font><font color="#CCCCCC"> AAP is</font>

47
00:02:41,099 --> 00:02:47,130
defined as the account<font color="#E5E5E5"> that has the most</font>

48
00:02:43,379 --> 00:02:48,780
privilege within a system<font color="#E5E5E5"> of application</font>

49
00:02:47,130 --> 00:02:50,940
<font color="#E5E5E5">we try to include application as well</font>

50
00:02:48,780 --> 00:02:52,739
because we try to make the definition<font color="#CCCCCC"> a</font>

51
00:02:50,940 --> 00:02:55,799
<font color="#CCCCCC">little more broad</font><font color="#E5E5E5"> they're just simply</font>

52
00:02:52,739 --> 00:02:58,430
rude or system administrator and because

53
00:02:55,799 --> 00:03:01,190
when you go to<font color="#E5E5E5"> in certain environments</font>

54
00:02:58,430 --> 00:03:07,160
<font color="#CCCCCC">there are</font><font color="#E5E5E5"> levels and</font><font color="#CCCCCC"> sub levels of</font>

55
00:03:01,190 --> 00:03:12,720
<font color="#E5E5E5">system administrators or super users</font>

56
00:03:07,160 --> 00:03:15,540
<font color="#E5E5E5">usually some</font><font color="#CCCCCC"> of the privileges that</font><font color="#E5E5E5"> this</font>

57
00:03:12,720 --> 00:03:17,870
accounts have is they can create

58
00:03:15,540 --> 00:03:21,650
accounts they<font color="#CCCCCC"> can change user passwords</font>

59
00:03:17,870 --> 00:03:23,340
they can write or change log files

60
00:03:21,650 --> 00:03:26,609
install software

61
00:03:23,340 --> 00:03:33,470
add themselves to specific groups<font color="#E5E5E5"> create</font>

62
00:03:26,609 --> 00:03:33,470
groups<font color="#CCCCCC"> take</font><font color="#E5E5E5"> over specific</font><font color="#CCCCCC"> files and</font>

63
00:03:33,530 --> 00:03:39,630
these accounts are needed because within

64
00:03:38,280 --> 00:03:42,420
<font color="#E5E5E5">an organization you don't want to have a</font>

65
00:03:39,630 --> 00:03:46,410
<font color="#E5E5E5">flat structure where everybody has the</font>

66
00:03:42,420 --> 00:03:48,179
same sort of the<font color="#E5E5E5"> same privileges when it</font>

67
00:03:46,410 --> 00:03:51,000
comes to creating I'm in a straight<font color="#E5E5E5"> of</font>

68
00:03:48,180 --> 00:03:53,010
tasks or creating users or resetting

69
00:03:51,000 --> 00:03:58,319
<font color="#CCCCCC">passwords</font><font color="#E5E5E5"> so there's just sort of</font><font color="#CCCCCC"> a</font>

70
00:03:53,010 --> 00:04:00,388
hierarchy<font color="#E5E5E5"> where basically you had to if</font>

71
00:03:58,319 --> 00:04:02,760
we follow the principle<font color="#CCCCCC"> of least</font>

72
00:04:00,389 --> 00:04:05,400
privilege<font color="#E5E5E5"> you had to do obviously</font>

73
00:04:02,760 --> 00:04:09,120
segregate duties<font color="#E5E5E5"> and you had to assign</font>

74
00:04:05,400 --> 00:04:11,220
every each user<font color="#CCCCCC"> according to their tasks</font>

75
00:04:09,120 --> 00:04:13,079
<font color="#CCCCCC">and obviously you don't want</font><font color="#E5E5E5"> to assign</font>

76
00:04:11,220 --> 00:04:16,168
any user a<font color="#E5E5E5"> test that would allow them</font><font color="#CCCCCC"> to</font>

77
00:04:13,079 --> 00:04:19,079
<font color="#CCCCCC">take over</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> happens sometimes with</font>

78
00:04:16,168 --> 00:04:22,859
administrator accounts<font color="#CCCCCC"> that's been seen</font>

79
00:04:19,079 --> 00:04:24,900
in the past<font color="#CCCCCC"> I was part of a team that</font>

80
00:04:22,860 --> 00:04:27,000
was protecting a organization you

81
00:04:24,900 --> 00:04:29,429
probably<font color="#CCCCCC"> I</font><font color="#E5E5E5"> Sarah but if you</font>

82
00:04:27,000 --> 00:04:30,840
<font color="#E5E5E5">the industry long enough where the</font>

83
00:04:29,430 --> 00:04:34,680
system administrator had all their

84
00:04:30,840 --> 00:04:36,840
<font color="#CCCCCC">passwords</font><font color="#E5E5E5"> and a excel sheet</font><font color="#CCCCCC"> there were</font>

85
00:04:34,680 --> 00:04:42,270
the this individual was targeted

86
00:04:36,840 --> 00:04:45,450
he was fish and<font color="#E5E5E5"> it was a resulted to be</font>

87
00:04:42,270 --> 00:04:46,830
a<font color="#E5E5E5"> a nation state and that</font><font color="#CCCCCC"> nation state</font>

88
00:04:45,450 --> 00:04:50,789
basically<font color="#E5E5E5"> took over the organization</font>

89
00:04:46,830 --> 00:04:53,640
<font color="#CCCCCC">took over content</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> won ensued</font>

90
00:04:50,790 --> 00:04:58,400
afterwards was basically a very

91
00:04:53,640 --> 00:05:01,530
<font color="#CCCCCC">stressful</font><font color="#E5E5E5"> and difficult to deal</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> so</font>

92
00:04:58,400 --> 00:05:03,659
what happens<font color="#CCCCCC"> sometimes is depending on</font>

93
00:05:01,530 --> 00:05:07,770
<font color="#E5E5E5">the organization and the way things are</font>

94
00:05:03,660 --> 00:05:09,060
<font color="#CCCCCC">structure</font><font color="#E5E5E5"> usually you you want to you</font>

95
00:05:07,770 --> 00:05:10,229
want<font color="#CCCCCC"> to prevent</font><font color="#E5E5E5"> somebody from taking</font>

96
00:05:09,060 --> 00:05:13,230
<font color="#E5E5E5">over everything and you want to</font>

97
00:05:10,230 --> 00:05:16,770
distribute tasks and<font color="#CCCCCC"> pernicious and</font>

98
00:05:13,230 --> 00:05:18,450
privileges accordingly to whatever<font color="#E5E5E5"> the</font>

99
00:05:16,770 --> 00:05:20,760
users or group<font color="#E5E5E5"> of users are</font><font color="#CCCCCC"> doing and</font>

100
00:05:18,450 --> 00:05:25,219
that's<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> a way</font><font color="#CCCCCC"> to do to at least</font>

101
00:05:20,760 --> 00:05:25,219
the 101<font color="#E5E5E5"> of system</font><font color="#CCCCCC"> administration and</font>

102
00:05:25,250 --> 00:05:31,979
<font color="#E5E5E5">basically these are things that would</font>

103
00:05:28,830 --> 00:05:35,550
allow you<font color="#CCCCCC"> to keep your your organization</font>

104
00:05:31,979 --> 00:05:40,830
protected I'll give you an<font color="#E5E5E5"> example I</font><font color="#CCCCCC"> had</font>

105
00:05:35,550 --> 00:05:43,320
a<font color="#CCCCCC"> customer where basically they were</font>

106
00:05:40,830 --> 00:05:46,229
attacked<font color="#E5E5E5"> by ransomware and because I</font>

107
00:05:43,320 --> 00:05:48,979
said a GPO<font color="#CCCCCC"> that basically said the user</font>

108
00:05:46,229 --> 00:05:52,650
cannot write<font color="#E5E5E5"> outside of their documents</font>

109
00:05:48,979 --> 00:05:54,570
ransomware<font color="#E5E5E5"> came</font><font color="#CCCCCC"> in once executed but all</font>

110
00:05:52,650 --> 00:05:59,039
what was encrypted<font color="#E5E5E5"> was the My Documents</font>

111
00:05:54,570 --> 00:06:00,450
folder so even though I had an ass where

112
00:05:59,040 --> 00:06:05,510
the<font color="#CCCCCC"> backup was written</font><font color="#E5E5E5"> to they couldn't</font>

113
00:06:00,450 --> 00:06:05,510
write to the<font color="#E5E5E5"> nest even though I had a</font>

114
00:06:05,780 --> 00:06:10,349
software and<font color="#E5E5E5"> shares where they could</font>

115
00:06:08,100 --> 00:06:14,250
pull software<font color="#E5E5E5"> they could</font><font color="#CCCCCC"> pull for</font>

116
00:06:10,350 --> 00:06:15,870
<font color="#E5E5E5">example payroll they couldn't get into</font>

117
00:06:14,250 --> 00:06:17,370
<font color="#CCCCCC">it and they</font><font color="#E5E5E5"> couldn't</font><font color="#CCCCCC"> get into it</font><font color="#E5E5E5"> because</font>

118
00:06:15,870 --> 00:06:21,330
the end<font color="#CCCCCC"> they</font><font color="#E5E5E5"> simply didn't have rights</font>

119
00:06:17,370 --> 00:06:23,130
and<font color="#E5E5E5"> they</font><font color="#CCCCCC"> couldn't pass the</font><font color="#E5E5E5"> hatch because</font>

120
00:06:21,330 --> 00:06:25,979
<font color="#CCCCCC">I do a little trick which is to create</font>

121
00:06:23,130 --> 00:06:28,260
<font color="#E5E5E5">an account</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> to join computers to the</font>

122
00:06:25,979 --> 00:06:31,950
domain then I disable it and get rid<font color="#CCCCCC"> of</font>

123
00:06:28,260 --> 00:06:33,539
<font color="#E5E5E5">it so usually when you do that you had</font>

124
00:06:31,950 --> 00:06:36,570
to<font color="#CCCCCC"> sort of remember what was the</font>

125
00:06:33,540 --> 00:06:37,830
password for<font color="#CCCCCC"> the administrator 500 if</font>

126
00:06:36,570 --> 00:06:40,469
you do that then you're screwed<font color="#E5E5E5"> you have</font>

127
00:06:37,830 --> 00:06:41,200
to reset but<font color="#E5E5E5"> usually that's one of the</font>

128
00:06:40,470 --> 00:06:44,680
things

129
00:06:41,200 --> 00:06:45,849
in case<font color="#E5E5E5"> the somebody gets popped</font><font color="#CCCCCC"> they</font>

130
00:06:44,680 --> 00:06:47,560
can retrieve the hatch and<font color="#E5E5E5"> then</font>

131
00:06:45,850 --> 00:06:50,410
obviously you're sure<font color="#CCCCCC"> that it'll</font><font color="#E5E5E5"> pass</font>

132
00:06:47,560 --> 00:06:51,910
<font color="#E5E5E5">the hash and</font><font color="#CCCCCC"> access</font><font color="#E5E5E5"> everything and if</font>

133
00:06:50,410 --> 00:06:53,770
you<font color="#CCCCCC"> had something like eternal blue for</font>

134
00:06:51,910 --> 00:06:55,210
example<font color="#E5E5E5"> which</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> was one of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> things</font>

135
00:06:53,770 --> 00:07:01,299
that want<font color="#E5E5E5"> to cry was doing then you can</font>

136
00:06:55,210 --> 00:07:03,489
encrypt everything<font color="#E5E5E5"> so by</font><font color="#CCCCCC"> by this example</font>

137
00:07:01,300 --> 00:07:05,800
when I try to<font color="#E5E5E5"> explain is it's the</font>

138
00:07:03,490 --> 00:07:07,600
relevance of the the isolation of

139
00:07:05,800 --> 00:07:12,400
privileges<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the power</font><font color="#E5E5E5"> that this</font>

140
00:07:07,600 --> 00:07:17,470
accounts have so I think<font color="#CCCCCC"> I've already</font>

141
00:07:12,400 --> 00:07:21,638
<font color="#E5E5E5">been through this</font><font color="#CCCCCC"> the analog account and</font>

142
00:07:17,470 --> 00:07:22,680
UNIX or Linux systems<font color="#CCCCCC"> it's usually the</font>

143
00:07:21,639 --> 00:07:25,180
root account

144
00:07:22,680 --> 00:07:32,470
so usually we look either<font color="#CCCCCC"> a system in</font>

145
00:07:25,180 --> 00:07:34,560
straighter<font color="#E5E5E5"> and T system or</font><font color="#CCCCCC"> route</font><font color="#E5E5E5"> to put</font>

146
00:07:32,470 --> 00:07:38,530
it a little<font color="#E5E5E5"> bit more into a context of</font>

147
00:07:34,560 --> 00:07:41,950
how<font color="#CCCCCC"> these are</font><font color="#E5E5E5"> defined contextually and</font>

148
00:07:38,530 --> 00:07:44,080
conceptually<font color="#E5E5E5"> usually what a</font><font color="#CCCCCC"> supplier is</font>

149
00:07:41,950 --> 00:07:51,060
called<font color="#E5E5E5"> role based access control or DAC</font>

150
00:07:44,080 --> 00:07:51,060
and<font color="#CCCCCC"> rbac basically allows you to create</font>

151
00:07:51,330 --> 00:07:58,900
<font color="#E5E5E5">other organizational units or groups</font>

152
00:07:54,370 --> 00:08:01,539
where you<font color="#CCCCCC"> can then apply it right and</font>

153
00:07:58,900 --> 00:08:04,479
apply privileges that supersede the

154
00:08:01,539 --> 00:08:09,430
individual that is<font color="#E5E5E5"> inside that that</font>

155
00:08:04,479 --> 00:08:12,250
<font color="#CCCCCC">group or organizational unit and it's</font>

156
00:08:09,430 --> 00:08:17,590
usually very very<font color="#CCCCCC"> common in Active</font>

157
00:08:12,250 --> 00:08:20,350
Directory environments<font color="#CCCCCC"> the active</font>

158
00:08:17,590 --> 00:08:24,849
<font color="#CCCCCC">directory basically is the the</font>

159
00:08:20,350 --> 00:08:27,280
operational application of<font color="#CCCCCC"> RBAC</font>

160
00:08:24,850 --> 00:08:30,789
and it's usually done<font color="#CCCCCC"> through</font><font color="#E5E5E5"> a protocol</font>

161
00:08:27,280 --> 00:08:32,740
called<font color="#CCCCCC"> LDAP</font><font color="#E5E5E5"> and LDAP can be used in</font>

162
00:08:30,789 --> 00:08:39,159
Linux environments<font color="#E5E5E5"> and Windows</font>

163
00:08:32,740 --> 00:08:45,820
environments<font color="#CCCCCC"> and our investigation had</font>

164
00:08:39,159 --> 00:08:51,420
mostly data thrown at the directory so

165
00:08:45,820 --> 00:08:53,860
here's a a overview<font color="#E5E5E5"> of how the</font>

166
00:08:51,420 --> 00:08:54,560
permissions are usually distributed<font color="#E5E5E5"> you</font>

167
00:08:53,860 --> 00:08:57,639
have the

168
00:08:54,560 --> 00:09:02,540
the<font color="#E5E5E5"> director</font><font color="#CCCCCC"> of service service</font>

169
00:08:57,639 --> 00:09:06,160
<font color="#E5E5E5">basically checks the schema the schema</font>

170
00:09:02,540 --> 00:09:08,779
is<font color="#CCCCCC"> like this</font><font color="#E5E5E5"> this hierarchical</font>

171
00:09:06,160 --> 00:09:12,949
information<font color="#CCCCCC"> about</font><font color="#E5E5E5"> who</font><font color="#CCCCCC"> is who</font><font color="#E5E5E5"> what they</font>

172
00:09:08,779 --> 00:09:15,350
do what they can<font color="#CCCCCC"> and</font><font color="#E5E5E5"> they cannot do</font><font color="#CCCCCC"> it's</font>

173
00:09:12,949 --> 00:09:18,559
usually resides in the domain controller

174
00:09:15,350 --> 00:09:21,499
<font color="#E5E5E5">and</font><font color="#CCCCCC"> then from there</font><font color="#E5E5E5"> using diverse number</font>

175
00:09:18,559 --> 00:09:24,709
<font color="#E5E5E5">of technologies it gets distributed to</font>

176
00:09:21,499 --> 00:09:28,100
there were stations<font color="#CCCCCC"> to</font><font color="#E5E5E5"> servers and the</font>

177
00:09:24,709 --> 00:09:30,800
ultimately<font color="#E5E5E5"> the applications here's an</font>

178
00:09:28,100 --> 00:09:32,059
<font color="#E5E5E5">example many</font><font color="#CCCCCC"> of you</font><font color="#E5E5E5"> probably are</font><font color="#CCCCCC"> very</font>

179
00:09:30,800 --> 00:09:35,420
familiar<font color="#E5E5E5"> with this this is how you</font>

180
00:09:32,059 --> 00:09:39,649
manage<font color="#E5E5E5"> an</font><font color="#CCCCCC"> Active Directory you have the</font>

181
00:09:35,420 --> 00:09:42,529
users the users can<font color="#E5E5E5"> be moved in to all</font>

182
00:09:39,649 --> 00:09:44,959
<font color="#E5E5E5">users you can create groups</font><font color="#CCCCCC"> you can</font>

183
00:09:42,529 --> 00:09:47,499
<font color="#E5E5E5">create different</font><font color="#CCCCCC"> types of special groups</font>

184
00:09:44,959 --> 00:09:47,498
if you want

185
00:09:48,309 --> 00:09:55,309
<font color="#CCCCCC">and in this case basically what Active</font>

186
00:09:53,509 --> 00:09:58,670
Directory allows you to do is basically

187
00:09:55,309 --> 00:10:02,569
create you get very granular or who does

188
00:09:58,670 --> 00:10:05,509
what and<font color="#E5E5E5"> where can they do it</font><font color="#CCCCCC"> like I was</font>

189
00:10:02,569 --> 00:10:07,459
saying<font color="#E5E5E5"> before this can get complicated</font>

190
00:10:05,509 --> 00:10:12,170
and<font color="#CCCCCC"> I want to we want to say</font><font color="#E5E5E5"> this is a</font>

191
00:10:07,459 --> 00:10:15,170
caveat<font color="#E5E5E5"> because this is an initial</font>

192
00:10:12,170 --> 00:10:16,759
approach of this research and there are

193
00:10:15,170 --> 00:10:19,160
environments<font color="#E5E5E5"> where there are super</font>

194
00:10:16,759 --> 00:10:22,750
admins<font color="#E5E5E5"> there are all you admins</font><font color="#CCCCCC"> they are</font>

195
00:10:19,160 --> 00:10:26,389
hidden<font color="#E5E5E5"> or use their service accounts</font>

196
00:10:22,750 --> 00:10:28,579
within<font color="#CCCCCC"> my career</font><font color="#E5E5E5"> as the</font><font color="#CCCCCC"> system engineer</font>

197
00:10:26,389 --> 00:10:32,269
many times I was just telling products

198
00:10:28,579 --> 00:10:35,779
where we have to test connection<font color="#E5E5E5"> to LDAP</font>

199
00:10:32,269 --> 00:10:38,589
and then one administrator will see in a

200
00:10:35,779 --> 00:10:40,910
<font color="#E5E5E5">specific</font><font color="#CCCCCC"> of you and then the other woman</font>

201
00:10:38,589 --> 00:10:42,139
come to find<font color="#E5E5E5"> out and he didn't even know</font>

202
00:10:40,910 --> 00:10:44,839
<font color="#E5E5E5">it I guess because it was</font><font color="#CCCCCC"> a need-to-know</font>

203
00:10:42,139 --> 00:10:51,339
<font color="#CCCCCC">basis I was working with</font><font color="#E5E5E5"> a a company</font>

204
00:10:44,839 --> 00:10:54,800
that basically<font color="#E5E5E5"> they were making military</font>

205
00:10:51,339 --> 00:11:00,019
developing<font color="#E5E5E5"> military helicopters so there</font>

206
00:10:54,800 --> 00:11:02,359
were a lot<font color="#CCCCCC"> of all use and parts of the</font>

207
00:11:00,019 --> 00:11:04,610
schema<font color="#CCCCCC"> that were not seen by everybody</font>

208
00:11:02,360 --> 00:11:08,690
<font color="#E5E5E5">and that were seen by the specific</font>

209
00:11:04,610 --> 00:11:10,100
individuals<font color="#CCCCCC"> obviously this may</font>

210
00:11:08,690 --> 00:11:11,750
this research are a little more

211
00:11:10,100 --> 00:11:16,790
complicated<font color="#CCCCCC"> and difficult we try to</font>

212
00:11:11,750 --> 00:11:20,480
<font color="#CCCCCC">basically</font><font color="#E5E5E5"> approach this research in the</font>

213
00:11:16,790 --> 00:11:23,630
context of a specific<font color="#CCCCCC"> or reduce</font><font color="#E5E5E5"> or you</font>

214
00:11:20,480 --> 00:11:26,360
data where we<font color="#E5E5E5"> knew at least what</font>

215
00:11:23,630 --> 00:11:29,210
accounts based on the schema<font color="#E5E5E5"> and on the</font>

216
00:11:26,360 --> 00:11:33,290
description of these users<font color="#E5E5E5"> where</font>

217
00:11:29,210 --> 00:11:38,210
<font color="#CCCCCC">administrators</font><font color="#E5E5E5"> and if you even go into</font>

218
00:11:33,290 --> 00:11:46,930
into cross-domain<font color="#E5E5E5"> trusts or or forest it</font>

219
00:11:38,210 --> 00:11:53,300
gets even more difficult so once we

220
00:11:46,930 --> 00:11:54,920
basically agree<font color="#E5E5E5"> on what what the VIP</font>

221
00:11:53,300 --> 00:12:00,109
accounts of what<font color="#E5E5E5"> are the</font><font color="#CCCCCC"> activities or</font>

222
00:11:54,920 --> 00:12:02,240
the behaviors that<font color="#CCCCCC"> VAP accounts have</font><font color="#E5E5E5"> we</font>

223
00:12:00,110 --> 00:12:04,820
were<font color="#CCCCCC"> able to do it by certain</font><font color="#E5E5E5"> tasks</font><font color="#CCCCCC"> so</font>

224
00:12:02,240 --> 00:12:06,860
in this case we looked at<font color="#E5E5E5"> backups</font>

225
00:12:04,820 --> 00:12:10,460
password resets creation of<font color="#E5E5E5"> accounts</font>

226
00:12:06,860 --> 00:12:14,120
<font color="#E5E5E5">software installs and then basically the</font>

227
00:12:10,460 --> 00:12:19,100
<font color="#CCCCCC">reason why we did this is because we</font>

228
00:12:14,120 --> 00:12:20,870
needed<font color="#E5E5E5"> to try</font><font color="#CCCCCC"> to approach to see if if</font>

229
00:12:19,100 --> 00:12:23,360
we if we<font color="#E5E5E5"> if</font><font color="#CCCCCC"> we can tell what they're</font>

230
00:12:20,870 --> 00:12:25,310
doing if we<font color="#CCCCCC"> can establish a benchmark</font><font color="#E5E5E5"> of</font>

231
00:12:23,360 --> 00:12:27,020
<font color="#CCCCCC">what they do</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> we tell if they have</font>

232
00:12:25,310 --> 00:12:31,969
been compromised<font color="#E5E5E5"> either by an external</font>

233
00:12:27,020 --> 00:12:34,939
actor or by a<font color="#E5E5E5"> rogue insider so it looks</font>

234
00:12:31,970 --> 00:12:36,920
<font color="#CCCCCC">like I got ten minutes right</font><font color="#E5E5E5"> yeah so</font>

235
00:12:34,940 --> 00:12:39,140
that<font color="#CCCCCC"> means that we're gonna</font><font color="#E5E5E5"> have to</font>

236
00:12:36,920 --> 00:12:41,990
speed<font color="#CCCCCC"> it up</font><font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit so here's a a</font>

237
00:12:39,140 --> 00:12:44,000
some of the<font color="#E5E5E5"> the quick reasons why you</font>

238
00:12:41,990 --> 00:12:46,570
target EAP accounts<font color="#E5E5E5"> you say one tool</font>

239
00:12:44,000 --> 00:12:49,550
called<font color="#CCCCCC"> hound that</font><font color="#E5E5E5"> tells you almost like</font>

240
00:12:46,570 --> 00:12:51,080
the degree<font color="#CCCCCC"> of separation that</font><font color="#E5E5E5"> you had to</font>

241
00:12:49,550 --> 00:12:52,880
get<font color="#E5E5E5"> domain and then</font><font color="#CCCCCC"> obviously if you</font><font color="#E5E5E5"> get</font>

242
00:12:51,080 --> 00:12:54,560
the main admin<font color="#E5E5E5"> you want pretty much</font>

243
00:12:52,880 --> 00:12:57,410
everything here's a tool

244
00:12:54,560 --> 00:12:58,520
call me<font color="#E5E5E5"> me cats you probably very</font>

245
00:12:57,410 --> 00:13:01,969
familiar<font color="#CCCCCC"> with this</font><font color="#E5E5E5"> where you</font><font color="#CCCCCC"> could do</font>

246
00:12:58,520 --> 00:13:04,640
things<font color="#E5E5E5"> such as</font><font color="#CCCCCC"> pasture hatch and</font><font color="#E5E5E5"> you can</font>

247
00:13:01,970 --> 00:13:06,140
do pass<font color="#CCCCCC"> the tickets it's a little more</font>

248
00:13:04,640 --> 00:13:10,430
difficult nowadays we<font color="#CCCCCC"> still can be done</font>

249
00:13:06,140 --> 00:13:17,680
<font color="#E5E5E5">mostly if the year forest level is based</font>

250
00:13:10,430 --> 00:13:21,800
on<font color="#E5E5E5"> legacy 2003 2012 or 2008 rather so</font>

251
00:13:17,680 --> 00:13:24,469
<font color="#E5E5E5">this accounts can constantly targeted</font>

252
00:13:21,800 --> 00:13:28,849
and lately why we most of<font color="#E5E5E5"> us</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> seen</font>

253
00:13:24,470 --> 00:13:30,649
<font color="#E5E5E5">is fishing spear fishing</font><font color="#CCCCCC"> because</font>

254
00:13:28,850 --> 00:13:33,050
obviously like<font color="#E5E5E5"> I said before I've been</font>

255
00:13:30,649 --> 00:13:35,720
<font color="#CCCCCC">in</font><font color="#E5E5E5"> situations where once the</font>

256
00:13:33,050 --> 00:13:38,870
administrator was compromised

257
00:13:35,720 --> 00:13:40,519
basically the organization was done<font color="#E5E5E5"> and</font>

258
00:13:38,870 --> 00:13:43,339
there's been other cases<font color="#CCCCCC"> wrong</font><font color="#E5E5E5"> it's</font>

259
00:13:40,519 --> 00:13:45,769
wrong inside<font color="#E5E5E5"> there the administrator or</font>

260
00:13:43,339 --> 00:13:48,019
in a specific administrator leaves<font color="#E5E5E5"> takes</font>

261
00:13:45,769 --> 00:13:50,269
the passwords or research the passwords

262
00:13:48,019 --> 00:13:54,070
from others and then it locks<font color="#E5E5E5"> up or or</font>

263
00:13:50,269 --> 00:13:57,310
or<font color="#CCCCCC"> disabled to extra trade information</font>

264
00:13:54,070 --> 00:14:01,040
so here's the problem

265
00:13:57,310 --> 00:14:02,599
so not only Joe<font color="#CCCCCC"> take it</font><font color="#E5E5E5"> from here</font><font color="#CCCCCC"> and</font>

266
00:14:01,040 --> 00:14:06,880
he's<font color="#CCCCCC"> gonna talk</font><font color="#E5E5E5"> to what we did with</font>

267
00:14:02,600 --> 00:14:09,320
Kafka<font color="#E5E5E5"> and how we approach this problem</font>

268
00:14:06,880 --> 00:14:12,680
all right thanks<font color="#E5E5E5"> all right you guys hear</font>

269
00:14:09,320 --> 00:14:14,240
me<font color="#E5E5E5"> okay so yeah now we're just gonna</font>

270
00:14:12,680 --> 00:14:17,390
kind<font color="#CCCCCC"> of dive in the last few minutes</font>

271
00:14:14,240 --> 00:14:20,000
<font color="#CCCCCC">here</font><font color="#E5E5E5"> into some of like the technical</font>

272
00:14:17,390 --> 00:14:23,540
<font color="#CCCCCC">implementation</font><font color="#E5E5E5"> we were kind of doing</font><font color="#CCCCCC"> to</font>

273
00:14:20,000 --> 00:14:26,000
prototype<font color="#CCCCCC"> out</font><font color="#E5E5E5"> this sort of kind of</font>

274
00:14:23,540 --> 00:14:30,290
intuition about<font color="#E5E5E5"> there's important users</font>

275
00:14:26,000 --> 00:14:32,930
in enterprise data sets and and there

276
00:14:30,290 --> 00:14:34,339
should<font color="#E5E5E5"> be a way to kind of fingerprint</font>

277
00:14:32,930 --> 00:14:36,469
and and maybe<font color="#E5E5E5"> sort</font><font color="#CCCCCC"> of assess</font>

278
00:14:34,339 --> 00:14:39,320
automatically some notion<font color="#E5E5E5"> of like risk</font>

279
00:14:36,470 --> 00:14:43,040
the the the<font color="#E5E5E5"> account represents the</font>

280
00:14:39,320 --> 00:14:47,690
overall<font color="#E5E5E5"> and</font><font color="#CCCCCC"> uh the the overall</font><font color="#E5E5E5"> sort of a</font>

281
00:14:43,040 --> 00:14:50,390
user hierarchy so I<font color="#CCCCCC"> think you know how</font>

282
00:14:47,690 --> 00:14:53,000
we did did this<font color="#E5E5E5"> problem in an</font>

283
00:14:50,390 --> 00:15:01,130
<font color="#CCCCCC">implementation perspective is</font><font color="#E5E5E5"> just kind</font>

284
00:14:53,000 --> 00:15:04,459
of more based on<font color="#E5E5E5"> the contracted</font>

285
00:15:01,130 --> 00:15:05,810
I was<font color="#E5E5E5"> originally exposed to it at when I</font>

286
00:15:04,459 --> 00:15:07,670
<font color="#E5E5E5">was still kind of helping with</font>

287
00:15:05,810 --> 00:15:09,529
professional services services and

288
00:15:07,670 --> 00:15:11,209
engagements and so you<font color="#E5E5E5"> can kind of think</font>

289
00:15:09,529 --> 00:15:14,060
of this as<font color="#CCCCCC"> like a cookie cutter</font><font color="#E5E5E5"> pattern</font>

290
00:15:11,209 --> 00:15:16,310
we use that a few large customers doing

291
00:15:14,060 --> 00:15:18,109
consulting work<font color="#E5E5E5"> and the reason it's sort</font>

292
00:15:16,310 --> 00:15:20,750
of<font color="#E5E5E5"> a fun story to tell and kind of like</font>

293
00:15:18,110 --> 00:15:23,360
extrapolate some<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> ideas here is</font>

294
00:15:20,750 --> 00:15:26,300
<font color="#CCCCCC">because sort</font><font color="#E5E5E5"> of this workflow we're</font>

295
00:15:23,360 --> 00:15:29,690
talking about<font color="#E5E5E5"> a led to like creating</font><font color="#CCCCCC"> two</font>

296
00:15:26,300 --> 00:15:32,540
prosecutable cases against insiders<font color="#E5E5E5"> so</font>

297
00:15:29,690 --> 00:15:35,420
people are stealing data and stuff like

298
00:15:32,540 --> 00:15:38,120
that in in<font color="#CCCCCC"> a really large</font>

299
00:15:35,420 --> 00:15:38,990
kind<font color="#E5E5E5"> of bank card network or I don't</font>

300
00:15:38,120 --> 00:15:40,790
know how to say it<font color="#E5E5E5"> without giving</font><font color="#CCCCCC"> away</font>

301
00:15:38,990 --> 00:15:44,540
<font color="#E5E5E5">post basically</font><font color="#CCCCCC"> a really</font><font color="#E5E5E5"> big financial</font>

302
00:15:40,790 --> 00:15:45,800
organization<font color="#CCCCCC"> one of the interesting</font>

303
00:15:44,540 --> 00:15:48,860
<font color="#E5E5E5">problems we sorta had to think about</font>

304
00:15:45,800 --> 00:15:53,740
<font color="#E5E5E5">this time for kind of modeling kind of</font>

305
00:15:48,860 --> 00:15:56,660
important users<font color="#E5E5E5"> in</font><font color="#CCCCCC"> LDAP data</font><font color="#E5E5E5"> was how to</font>

306
00:15:53,740 --> 00:15:59,240
kind of do the anomaly detection or the

307
00:15:56,660 --> 00:16:03,020
the<font color="#E5E5E5"> the scoring of the</font><font color="#CCCCCC"> of the user</font>

308
00:15:59,240 --> 00:16:04,820
behavior in a<font color="#CCCCCC"> real-time framework so in</font>

309
00:16:03,020 --> 00:16:08,300
our<font color="#E5E5E5"> in our implementation</font><font color="#CCCCCC"> we were using</font>

310
00:16:04,820 --> 00:16:10,070
<font color="#E5E5E5">at the</font><font color="#CCCCCC"> koepcke streams API and basically</font>

311
00:16:08,300 --> 00:16:13,040
<font color="#E5E5E5">spinning up like a little distributed</font>

312
00:16:10,070 --> 00:16:14,960
app that can run more it's gonna<font color="#E5E5E5"> be more</font>

313
00:16:13,040 --> 00:16:20,510
some of the<font color="#E5E5E5"> scoring metrics I'll show</font>

314
00:16:14,960 --> 00:16:22,160
you at that at the<font color="#CCCCCC"> end here so kind</font><font color="#E5E5E5"> of</font>

315
00:16:20,510 --> 00:16:24,230
like<font color="#E5E5E5"> what happens with this this</font>

316
00:16:22,160 --> 00:16:26,120
algorithm is there's there's there's two

317
00:16:24,230 --> 00:16:28,160
<font color="#E5E5E5">kind of steps there's a sort of a</font>

318
00:16:26,120 --> 00:16:32,870
ranking step that is about<font color="#E5E5E5"> kind of</font>

319
00:16:28,160 --> 00:16:34,880
deriving<font color="#E5E5E5"> information from whatever</font>

320
00:16:32,870 --> 00:16:36,830
<font color="#CCCCCC">datasets we are sort of curating for</font><font color="#E5E5E5"> the</font>

321
00:16:34,880 --> 00:16:39,410
<font color="#E5E5E5">problem of like identifying specific</font>

322
00:16:36,830 --> 00:16:42,680
user types<font color="#E5E5E5"> typically this for us this is</font>

323
00:16:39,410 --> 00:16:45,290
<font color="#CCCCCC">Active Directory in different forms</font><font color="#E5E5E5"> and</font>

324
00:16:42,680 --> 00:16:47,660
kind<font color="#CCCCCC"> of how we derive a behavioral</font>

325
00:16:45,290 --> 00:16:49,339
fingerprint for<font color="#E5E5E5"> the the user activity</font><font color="#CCCCCC"> is</font>

326
00:16:47,660 --> 00:16:51,020
leveraging a lot<font color="#E5E5E5"> of Kerberos in this</font>

327
00:16:49,340 --> 00:16:53,750
case so we Kerberos<font color="#E5E5E5"> is something we</font>

328
00:16:51,020 --> 00:16:55,699
<font color="#CCCCCC">spend a lot of time</font><font color="#E5E5E5"> kind of on like</font>

329
00:16:53,750 --> 00:16:58,610
<font color="#CCCCCC">cherry-picking</font><font color="#E5E5E5"> little little</font><font color="#CCCCCC"> pieces of</font>

330
00:16:55,700 --> 00:17:01,970
that data into into like a<font color="#CCCCCC"> analytic</font>

331
00:16:58,610 --> 00:17:03,470
schema<font color="#E5E5E5"> and also like the Kerberos ticket</font>

332
00:17:01,970 --> 00:17:05,270
granted<font color="#E5E5E5"> without which all kind of</font><font color="#CCCCCC"> talked</font>

333
00:17:03,470 --> 00:17:06,890
about<font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit but at the</font><font color="#CCCCCC"> end of the</font>

334
00:17:05,270 --> 00:17:08,150
day we're sort of inferring<font color="#E5E5E5"> this kind of</font>

335
00:17:06,890 --> 00:17:09,770
like social<font color="#E5E5E5"> graph which is</font><font color="#CCCCCC"> a</font>

336
00:17:08,150 --> 00:17:12,320
<font color="#E5E5E5">relationship of inherited like</font>

337
00:17:09,770 --> 00:17:15,740
permissions<font color="#E5E5E5"> and trusts and how they can</font>

338
00:17:12,319 --> 00:17:17,480
access certain resources<font color="#CCCCCC"> and so because</font>

339
00:17:15,740 --> 00:17:19,970
there's sort<font color="#E5E5E5"> of a graph kind of implicit</font>

340
00:17:17,480 --> 00:17:22,730
in like the social structure of<font color="#E5E5E5"> these</font>

341
00:17:19,970 --> 00:17:25,370
these kind<font color="#CCCCCC"> of user accounts and sort of</font>

342
00:17:22,730 --> 00:17:29,530
where they what their functions are the

343
00:17:25,369 --> 00:17:32,689
the first step<font color="#CCCCCC"> in this problem was to</font>

344
00:17:29,530 --> 00:17:37,610
model like create sort of<font color="#E5E5E5"> a nice</font>

345
00:17:32,690 --> 00:17:41,360
scalable<font color="#E5E5E5"> graph data structure</font><font color="#CCCCCC"> to compute</font>

346
00:17:37,610 --> 00:17:43,639
some some classic graph metrics so kind

347
00:17:41,360 --> 00:17:45,199
of<font color="#E5E5E5"> what we have here is like that like</font>

348
00:17:43,640 --> 00:17:48,380
that<font color="#E5E5E5"> the the algorithm</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font>

349
00:17:45,200 --> 00:17:52,190
implemented<font color="#E5E5E5"> broke broken down into steps</font>

350
00:17:48,380 --> 00:17:55,990
and basically<font color="#E5E5E5"> what what the point is</font><font color="#CCCCCC"> to</font>

351
00:17:52,190 --> 00:18:01,160
is to sort of kind<font color="#E5E5E5"> of do some intuitive</font>

352
00:17:55,990 --> 00:18:04,490
<font color="#E5E5E5">processing of a social network</font><font color="#CCCCCC"> like a</font>

353
00:18:01,160 --> 00:18:05,900
<font color="#E5E5E5">website or in this case it's just like</font>

354
00:18:04,490 --> 00:18:07,190
it could<font color="#E5E5E5"> be thought of as like something</font>

355
00:18:05,900 --> 00:18:09,680
like Facebook<font color="#CCCCCC"> where there's a bunch of</font>

356
00:18:07,190 --> 00:18:12,260
users<font color="#E5E5E5"> connected</font><font color="#CCCCCC"> they may be connected</font>

357
00:18:09,680 --> 00:18:13,910
<font color="#E5E5E5">between they may be linked by by devices</font>

358
00:18:12,260 --> 00:18:16,610
<font color="#E5E5E5">or something else other than another</font>

359
00:18:13,910 --> 00:18:18,740
user account<font color="#E5E5E5"> but because it's a graph</font><font color="#CCCCCC"> we</font>

360
00:18:16,610 --> 00:18:21,679
can kind of leverage some some<font color="#CCCCCC"> breast</font>

361
00:18:18,740 --> 00:18:24,320
best practices and assign<font color="#CCCCCC"> a couple of</font>

362
00:18:21,680 --> 00:18:26,890
metrics<font color="#CCCCCC"> to the ranking of the users in</font>

363
00:18:24,320 --> 00:18:29,889
<font color="#E5E5E5">this in this this kind of large</font>

364
00:18:26,890 --> 00:18:33,260
collection of sort of<font color="#E5E5E5"> related entities</font>

365
00:18:29,890 --> 00:18:35,750
and so with with with<font color="#E5E5E5"> graph like with</font>

366
00:18:33,260 --> 00:18:39,620
<font color="#E5E5E5">like with the graph it gives us a couple</font>

367
00:18:35,750 --> 00:18:41,360
<font color="#CCCCCC">of different like counts of metrics</font><font color="#E5E5E5"> that</font>

368
00:18:39,620 --> 00:18:43,550
<font color="#CCCCCC">are important</font><font color="#E5E5E5"> and we basically kind of</font>

369
00:18:41,360 --> 00:18:45,560
have a under the<font color="#E5E5E5"> hood it's kind of where</font>

370
00:18:43,550 --> 00:18:48,350
we had to spend<font color="#E5E5E5"> some time building up</font>

371
00:18:45,560 --> 00:18:50,419
our sort<font color="#E5E5E5"> of</font><font color="#CCCCCC"> hearest</font><font color="#E5E5E5"> heuristic so we're</font>

372
00:18:48,350 --> 00:18:52,969
using PageRank a couple of other kind<font color="#CCCCCC"> of</font>

373
00:18:50,420 --> 00:18:55,130
<font color="#E5E5E5">hand-built features to describe for</font><font color="#CCCCCC"> each</font>

374
00:18:52,970 --> 00:18:56,450
user the relative rank in the graph

375
00:18:55,130 --> 00:19:00,850
that's that's kind of like the key

376
00:18:56,450 --> 00:19:00,850
intuition for the first step and then

377
00:19:01,450 --> 00:19:11,660
<font color="#E5E5E5">from from there we basically take a like</font>

378
00:19:06,650 --> 00:19:13,910
a sort<font color="#CCCCCC"> of a time like a like a time</font>

379
00:19:11,660 --> 00:19:16,250
series point of view<font color="#E5E5E5"> for each user</font>

380
00:19:13,910 --> 00:19:19,220
account<font color="#E5E5E5"> that we find important and I</font>

381
00:19:16,250 --> 00:19:21,020
<font color="#E5E5E5">think maybe I forgot to say this but the</font>

382
00:19:19,220 --> 00:19:23,630
reason<font color="#E5E5E5"> we sort of like ended up with</font>

383
00:19:21,020 --> 00:19:26,240
these first<font color="#E5E5E5"> two</font><font color="#CCCCCC"> steps were</font><font color="#E5E5E5"> kind of why</font>

384
00:19:23,630 --> 00:19:29,900
we're sort of really thinking<font color="#CCCCCC"> about what</font>

385
00:19:26,240 --> 00:19:32,510
does<font color="#CCCCCC"> it mean to be like a high risk</font><font color="#E5E5E5"> high</font>

386
00:19:29,900 --> 00:19:36,050
<font color="#CCCCCC">risk individual in an organization in</font>

387
00:19:32,510 --> 00:19:39,170
<font color="#E5E5E5">terms of their potential to just elevate</font>

388
00:19:36,050 --> 00:19:42,470
trust or target like different keys to

389
00:19:39,170 --> 00:19:45,050
the kingdom like like walking<font color="#E5E5E5"> and</font><font color="#CCCCCC"> ldap</font>

390
00:19:42,470 --> 00:19:46,960
tree is a perfect example<font color="#CCCCCC"> of a sort of a</font>

391
00:19:45,050 --> 00:19:49,879
attack technique we'd see a<font color="#E5E5E5"> lot when</font>

392
00:19:46,960 --> 00:19:52,820
<font color="#E5E5E5">kind of a campaign was was successful</font>

393
00:19:49,880 --> 00:19:54,350
and the target<font color="#E5E5E5"> was like just exfiltrated</font>

394
00:19:52,820 --> 00:19:56,450
with all the user<font color="#CCCCCC"> accounts</font><font color="#E5E5E5"> so we're just</font>

395
00:19:54,350 --> 00:19:58,250
kind of going after<font color="#E5E5E5"> these these these</font>

396
00:19:56,450 --> 00:20:02,120
<font color="#CCCCCC">these accounts that are</font><font color="#E5E5E5"> able to do a lot</font>

397
00:19:58,250 --> 00:20:07,640
of kind<font color="#E5E5E5"> of high profile permission</font>

398
00:20:02,120 --> 00:20:12,408
<font color="#CCCCCC">Changez and and in this this sort of dis</font>

399
00:20:07,640 --> 00:20:14,450
<font color="#E5E5E5">metric like we have a a just like an</font>

400
00:20:12,409 --> 00:20:15,860
intuition<font color="#CCCCCC"> for reducing false positives I</font>

401
00:20:14,450 --> 00:20:18,860
mean that's it's<font color="#CCCCCC"> not really said here</font>

402
00:20:15,860 --> 00:20:20,149
explicitly<font color="#E5E5E5"> but step</font><font color="#CCCCCC"> one and step</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> the</font>

403
00:20:18,860 --> 00:20:21,590
first<font color="#E5E5E5"> time I implemented this algorithm</font>

404
00:20:20,150 --> 00:20:24,470
<font color="#CCCCCC">I</font><font color="#E5E5E5"> we weren't doing any sort of like</font>

405
00:20:21,590 --> 00:20:27,230
ranking of important individuals and

406
00:20:24,470 --> 00:20:29,720
what happened was when we<font color="#E5E5E5"> kind of get to</font>

407
00:20:27,230 --> 00:20:31,640
the the<font color="#E5E5E5"> actual meat of this algorithm</font>

408
00:20:29,720 --> 00:20:36,020
<font color="#CCCCCC">which is</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of this</font><font color="#E5E5E5"> little graph</font><font color="#CCCCCC"> here</font>

409
00:20:31,640 --> 00:20:37,669
<font color="#CCCCCC">so for every user and in the</font><font color="#E5E5E5"> environment</font>

410
00:20:36,020 --> 00:20:39,649
<font color="#CCCCCC">you kind</font><font color="#E5E5E5"> of get this graph it's like all</font>

411
00:20:37,669 --> 00:20:41,779
the<font color="#E5E5E5"> heat map but really what it is is it</font>

412
00:20:39,649 --> 00:20:43,520
<font color="#CCCCCC">just kind of tells you like in a nice</font>

413
00:20:41,779 --> 00:20:44,960
<font color="#E5E5E5">simple picture that's gonna be</font>

414
00:20:43,520 --> 00:20:46,940
represented by like a single<font color="#E5E5E5"> number</font>

415
00:20:44,960 --> 00:20:50,360
number when<font color="#CCCCCC"> we hit it with</font><font color="#E5E5E5"> a special</font>

416
00:20:46,940 --> 00:20:52,850
algorithm<font color="#CCCCCC"> this</font><font color="#E5E5E5"> single picture of user</font>

417
00:20:50,360 --> 00:20:54,590
<font color="#CCCCCC">activity is is is something</font><font color="#E5E5E5"> we can kind</font>

418
00:20:52,850 --> 00:20:56,330
<font color="#E5E5E5">of maintain in a nice scalable</font>

419
00:20:54,590 --> 00:20:58,730
distributed fashion<font color="#E5E5E5"> so it's kind of like</font>

420
00:20:56,330 --> 00:21:01,610
a really lightweight way to sort<font color="#E5E5E5"> of hack</font>

421
00:20:58,730 --> 00:21:04,580
a baseline together<font color="#E5E5E5"> of internal access</font>

422
00:21:01,610 --> 00:21:08,120
<font color="#E5E5E5">patterns so this is more like east-west</font>

423
00:21:04,580 --> 00:21:09,860
<font color="#E5E5E5">kind of behavior</font><font color="#CCCCCC"> where typically some of</font>

424
00:21:08,120 --> 00:21:11,658
<font color="#E5E5E5">this stuff would</font><font color="#CCCCCC"> be we'd be leveraging</font>

425
00:21:09,860 --> 00:21:16,399
<font color="#E5E5E5">is about kind of Kerberos authentication</font>

426
00:21:11,659 --> 00:21:19,730
<font color="#CCCCCC">Xand and tickets being granted</font><font color="#E5E5E5"> from kind</font>

427
00:21:16,399 --> 00:21:21,320
<font color="#E5E5E5">of Windows resources this this kind of</font>

428
00:21:19,730 --> 00:21:22,850
gives<font color="#E5E5E5"> us</font><font color="#CCCCCC"> visibility into those access</font>

429
00:21:21,320 --> 00:21:25,129
patterns where oftentimes<font color="#E5E5E5"> in a large</font>

430
00:21:22,850 --> 00:21:27,740
organization<font color="#CCCCCC"> like if the traffic isn't</font>

431
00:21:25,130 --> 00:21:30,529
routed through kind of<font color="#E5E5E5"> borders or kind</font>

432
00:21:27,740 --> 00:21:33,140
<font color="#E5E5E5">of north north south we would kind of</font>

433
00:21:30,529 --> 00:21:34,399
lose<font color="#CCCCCC"> visibility at scale</font><font color="#E5E5E5"> so this was</font>

434
00:21:33,140 --> 00:21:36,860
<font color="#E5E5E5">kind of a way to kind</font><font color="#CCCCCC"> of get around</font><font color="#E5E5E5"> that</font>

435
00:21:34,399 --> 00:21:40,309
<font color="#E5E5E5">see some sort</font><font color="#CCCCCC"> of insights in</font><font color="#E5E5E5"> the land</font>

436
00:21:36,860 --> 00:21:42,469
<font color="#E5E5E5">and then kind of the</font><font color="#CCCCCC"> the modeling of</font><font color="#E5E5E5"> the</font>

437
00:21:40,309 --> 00:21:44,029
<font color="#CCCCCC">vips is sort of</font><font color="#E5E5E5"> a fancy way to say like</font>

438
00:21:42,470 --> 00:21:46,480
<font color="#E5E5E5">we've got to figure out ways</font><font color="#CCCCCC"> to produce</font>

439
00:21:44,029 --> 00:21:49,370
false positives<font color="#CCCCCC"> that are that</font><font color="#E5E5E5"> are clever</font>

440
00:21:46,480 --> 00:21:52,399
<font color="#CCCCCC">the</font><font color="#E5E5E5"> the issue we had when</font><font color="#CCCCCC"> we ran this we</font>

441
00:21:49,370 --> 00:21:56,629
this algorithm at like<font color="#E5E5E5"> some fortune tens</font>

442
00:21:52,399 --> 00:21:59,840
was that the time to validate like for

443
00:21:56,630 --> 00:22:01,730
an operator to<font color="#E5E5E5"> like basically escalate a</font>

444
00:21:59,840 --> 00:22:03,770
ticket around<font color="#E5E5E5"> this and say oh we might</font>

445
00:22:01,730 --> 00:22:06,020
have the admin<font color="#E5E5E5"> account</font><font color="#CCCCCC"> compromised we</font>

446
00:22:03,770 --> 00:22:08,299
<font color="#E5E5E5">gotta go</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know pull all the all the</font>

447
00:22:06,020 --> 00:22:10,220
servers and just kind of you<font color="#E5E5E5"> know do the</font>

448
00:22:08,299 --> 00:22:13,820
<font color="#E5E5E5">triage associated with something</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> you</font>

449
00:22:10,220 --> 00:22:15,740
<font color="#CCCCCC">know like that is specific just</font><font color="#E5E5E5"> to like</font>

450
00:22:13,820 --> 00:22:18,439
the LDAP and<font color="#CCCCCC"> Windows</font>

451
00:22:15,740 --> 00:22:21,110
environment<font color="#E5E5E5"> and</font><font color="#CCCCCC"> and also kind of</font><font color="#E5E5E5"> the</font>

452
00:22:18,440 --> 00:22:23,540
<font color="#CCCCCC">network-centric behavior in the land</font><font color="#E5E5E5"> it</font>

453
00:22:21,110 --> 00:22:25,639
<font color="#E5E5E5">would take on average the operators in</font>

454
00:22:23,540 --> 00:22:29,090
<font color="#E5E5E5">this large large organizations like 24/7</font>

455
00:22:25,640 --> 00:22:31,010
<font color="#E5E5E5">Sox</font><font color="#CCCCCC"> I think it was 20 hours</font><font color="#E5E5E5"> of working</font>

456
00:22:29,090 --> 00:22:33,590
time to<font color="#E5E5E5"> open and close a case around</font>

457
00:22:31,010 --> 00:22:39,910
<font color="#E5E5E5">this this hour</font><font color="#CCCCCC"> so it's you know it has</font>

458
00:22:33,590 --> 00:22:43,070
<font color="#E5E5E5">its drawbacks</font><font color="#CCCCCC"> but if you're able to know</font>

459
00:22:39,910 --> 00:22:45,770
<font color="#E5E5E5">and I think I picked the wrong slide</font>

460
00:22:43,070 --> 00:22:48,139
deck<font color="#CCCCCC"> correct I mean there's</font><font color="#E5E5E5"> there's</font>

461
00:22:45,770 --> 00:22:51,610
<font color="#E5E5E5">basically like I missed one picture here</font>

462
00:22:48,140 --> 00:22:51,610
<font color="#E5E5E5">this is like an older</font><font color="#CCCCCC"> version but</font>

463
00:22:56,060 --> 00:23:00,770
there was basically one more picture

464
00:22:58,040 --> 00:23:03,020
<font color="#E5E5E5">that's gonna like what what happens with</font>

465
00:23:00,770 --> 00:23:05,720
the the scoring step for every person's

466
00:23:03,020 --> 00:23:08,360
individual kind of like<font color="#E5E5E5"> act set of</font>

467
00:23:05,720 --> 00:23:11,300
access patterns is we hit this<font color="#CCCCCC"> with an</font>

468
00:23:08,360 --> 00:23:13,429
algorithm<font color="#E5E5E5"> that's called PCA</font><font color="#CCCCCC"> or SVD</font><font color="#E5E5E5"> yeah</font>

469
00:23:11,300 --> 00:23:15,050
all it does is<font color="#E5E5E5"> it takes a matrix under</font>

470
00:23:13,430 --> 00:23:19,310
<font color="#CCCCCC">though this is a matrix</font><font color="#E5E5E5"> of counts and</font>

471
00:23:15,050 --> 00:23:22,040
the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> x-axis is just</font><font color="#E5E5E5"> sort of the units</font>

472
00:23:19,310 --> 00:23:23,540
of time usually days or weeks and what

473
00:23:22,040 --> 00:23:28,070
we do is we ended up we end<font color="#E5E5E5"> up only</font>

474
00:23:23,540 --> 00:23:29,840
scoring matrixes or heat maps of users

475
00:23:28,070 --> 00:23:33,620
that<font color="#CCCCCC"> we think have a high risk</font><font color="#E5E5E5"> and this</font>

476
00:23:29,840 --> 00:23:36,080
<font color="#CCCCCC">this</font><font color="#E5E5E5"> lets us kind of target a very small</font>

477
00:23:33,620 --> 00:23:38,360
subset<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> population that poses like</font>

478
00:23:36,080 --> 00:23:40,699
a larger risk<font color="#E5E5E5"> and also can make make</font>

479
00:23:38,360 --> 00:23:42,290
that<font color="#E5E5E5"> doubler alerts manageable like if</font>

480
00:23:40,700 --> 00:23:43,880
you<font color="#E5E5E5"> don't kind of do some of this kind</font>

481
00:23:42,290 --> 00:23:48,379
<font color="#E5E5E5">of clever filtering you can run into a</font>

482
00:23:43,880 --> 00:23:51,800
lot<font color="#CCCCCC"> of just strange access patterns</font><font color="#E5E5E5"> but</font>

483
00:23:48,380 --> 00:23:54,170
you<font color="#CCCCCC"> know like</font><font color="#E5E5E5"> the key idea here is like</font>

484
00:23:51,800 --> 00:23:55,639
after after<font color="#CCCCCC"> you're sort of running our</font>

485
00:23:54,170 --> 00:23:58,730
algorithm and<font color="#E5E5E5"> you kind of build up a</font>

486
00:23:55,640 --> 00:24:00,950
picture of usually<font color="#E5E5E5"> it's weeks of time</font>

487
00:23:58,730 --> 00:24:02,780
and for an<font color="#CCCCCC"> average user like I've done</font>

488
00:24:00,950 --> 00:24:05,450
tests on my account when I was at like

489
00:24:02,780 --> 00:24:08,030
EMC<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I'd have about maybe 50 rows</font>

490
00:24:05,450 --> 00:24:11,690
each each<font color="#E5E5E5"> rows sort of like a like a</font>

491
00:24:08,030 --> 00:24:14,000
like a share or an asset that's<font color="#E5E5E5"> being</font>

492
00:24:11,690 --> 00:24:15,980
accessed<font color="#E5E5E5"> and so when you kind of</font><font color="#CCCCCC"> look at</font>

493
00:24:14,000 --> 00:24:17,870
like<font color="#CCCCCC"> what happened with the people who</font>

494
00:24:15,980 --> 00:24:20,180
were<font color="#CCCCCC"> prosecuted because of</font><font color="#E5E5E5"> this so two</font>

495
00:24:17,870 --> 00:24:22,699
admins basically were were fired<font color="#E5E5E5"> a</font>

496
00:24:20,180 --> 00:24:25,550
really large financial<font color="#E5E5E5"> organization the</font>

497
00:24:22,700 --> 00:24:27,530
day they were fired<font color="#E5E5E5"> like or maybe like</font>

498
00:24:25,550 --> 00:24:30,680
the last two days<font color="#CCCCCC"> basically like their</font>

499
00:24:27,530 --> 00:24:32,480
<font color="#E5E5E5">heat map history here I had a picture</font>

500
00:24:30,680 --> 00:24:35,120
and<font color="#E5E5E5"> I am sorry I think I just</font><font color="#CCCCCC"> screwed</font>

501
00:24:32,480 --> 00:24:36,920
<font color="#CCCCCC">the</font><font color="#E5E5E5"> slides up selamat last minute but</font>

502
00:24:35,120 --> 00:24:39,020
<font color="#E5E5E5">basically we add like one more day</font><font color="#CCCCCC"> of</font>

503
00:24:36,920 --> 00:24:41,000
information and you you see<font color="#CCCCCC"> that like</font>

504
00:24:39,020 --> 00:24:43,370
intuitively in<font color="#E5E5E5"> the and they're kind of</font>

505
00:24:41,000 --> 00:24:45,200
<font color="#E5E5E5">the coloring</font><font color="#CCCCCC"> of the access patterns it's</font>

506
00:24:43,370 --> 00:24:47,000
just there's a really noticeable

507
00:24:45,200 --> 00:24:49,100
deviation just with the naked eye and

508
00:24:47,000 --> 00:24:50,720
the way we're able to sort<font color="#CCCCCC"> of like kind</font>

509
00:24:49,100 --> 00:24:52,610
of hack<font color="#CCCCCC"> together an algorithm that that</font>

510
00:24:50,720 --> 00:24:56,510
that<font color="#E5E5E5"> sort</font><font color="#CCCCCC"> of targets that intuition is</font>

511
00:24:52,610 --> 00:24:59,419
for every for every every<font color="#E5E5E5"> update to this</font>

512
00:24:56,510 --> 00:25:01,220
<font color="#E5E5E5">matrix we rerun something that gives us</font>

513
00:24:59,420 --> 00:25:07,670
a single<font color="#E5E5E5"> number</font><font color="#CCCCCC"> it's the</font><font color="#E5E5E5"> principal</font>

514
00:25:01,220 --> 00:25:08,450
eigenvector matrix with a new day of

515
00:25:07,670 --> 00:25:10,760
information we

516
00:25:08,450 --> 00:25:12,230
compute that number again<font color="#E5E5E5"> if the two</font>

517
00:25:10,760 --> 00:25:13,970
<font color="#CCCCCC">numbers are different</font><font color="#E5E5E5"> by like a</font>

518
00:25:12,230 --> 00:25:18,110
threshold<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> sort of define with</font>

519
00:25:13,970 --> 00:25:20,270
with the the organization<font color="#CCCCCC"> itself</font><font color="#E5E5E5"> we have</font>

520
00:25:18,110 --> 00:25:21,830
a we basically have an anomaly<font color="#CCCCCC"> and</font>

521
00:25:20,270 --> 00:25:24,050
that's where we sort of kind<font color="#CCCCCC"> of go after</font>

522
00:25:21,830 --> 00:25:26,689
the investigation<font color="#E5E5E5"> side of things so this</font>

523
00:25:24,050 --> 00:25:30,590
<font color="#E5E5E5">was</font><font color="#CCCCCC"> just sort of like a way to to kind</font>

524
00:25:26,690 --> 00:25:31,790
of build a prototype<font color="#E5E5E5"> around this problem</font>

525
00:25:30,590 --> 00:25:33,470
<font color="#E5E5E5">with some</font><font color="#CCCCCC"> interesting like our</font>

526
00:25:31,790 --> 00:25:35,360
architectural constraints<font color="#E5E5E5"> mainly the</font>

527
00:25:33,470 --> 00:25:36,440
real time constraint<font color="#E5E5E5"> makes us sort of</font>

528
00:25:35,360 --> 00:25:39,020
choose like a real lightweight

529
00:25:36,440 --> 00:25:43,490
representation of users access patterns

530
00:25:39,020 --> 00:25:45,910
and<font color="#E5E5E5"> and yeah so I think there's looking</font>

531
00:25:43,490 --> 00:25:49,060
<font color="#CCCCCC">we're out of time right okay</font>

532
00:25:45,910 --> 00:25:51,620
the way I have Q&A<font color="#CCCCCC"> or that's it</font><font color="#E5E5E5"> without</font>

533
00:25:49,060 --> 00:25:57,320
any questions from<font color="#E5E5E5"> the crowd because</font>

534
00:25:51,620 --> 00:25:58,820
there are none<font color="#E5E5E5"> online well you guys have</font>

535
00:25:57,320 --> 00:25:59,929
two more<font color="#CCCCCC"> minutes</font><font color="#E5E5E5"> if you want to tell us</font>

536
00:25:58,820 --> 00:26:12,560
some more<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> stuff about</font><font color="#E5E5E5"> your</font>

537
00:25:59,930 --> 00:26:14,210
algorithm<font color="#CCCCCC"> I'm a</font><font color="#E5E5E5"> little confused which</font>

538
00:26:12,560 --> 00:26:16,490
matrix do you<font color="#CCCCCC"> think the SVD</font>

539
00:26:14,210 --> 00:26:21,140
decomposition for<font color="#E5E5E5"> is it for</font><font color="#CCCCCC"> the times</font>

540
00:26:16,490 --> 00:26:27,320
here that<font color="#CCCCCC"> this matrix</font><font color="#E5E5E5"> yep so on each one</font>

541
00:26:21,140 --> 00:26:29,210
of<font color="#E5E5E5"> these sort of like bins with which we</font>

542
00:26:27,320 --> 00:26:30,649
sort<font color="#E5E5E5"> of bucket time over</font><font color="#CCCCCC"> could be like</font>

543
00:26:29,210 --> 00:26:33,890
<font color="#E5E5E5">this</font><font color="#CCCCCC"> could be</font><font color="#E5E5E5"> an hour just some</font>

544
00:26:30,650 --> 00:26:35,510
resolution we choose<font color="#E5E5E5"> like for the real</font>

545
00:26:33,890 --> 00:26:38,720
sort of<font color="#CCCCCC"> production environment we have</font>

546
00:26:35,510 --> 00:26:41,120
maybe 40 50 days of individual<font color="#E5E5E5"> data and</font>

547
00:26:38,720 --> 00:26:43,820
then we<font color="#CCCCCC"> build this graph which is a</font>

548
00:26:41,120 --> 00:26:45,830
single matrix<font color="#E5E5E5"> each one of the like like</font>

549
00:26:43,820 --> 00:26:48,230
row column rows is basically<font color="#CCCCCC"> just an</font>

550
00:26:45,830 --> 00:26:50,929
account or normalized count<font color="#E5E5E5"> and then</font>

551
00:26:48,230 --> 00:26:53,210
when we get<font color="#E5E5E5"> a new day of data or we have</font>

552
00:26:50,930 --> 00:26:56,240
enough<font color="#E5E5E5"> information to</font><font color="#CCCCCC"> update</font><font color="#E5E5E5"> this matrix</font>

553
00:26:53,210 --> 00:26:58,640
we build another<font color="#E5E5E5"> one</font><font color="#CCCCCC"> wait and we compete</font>

554
00:26:56,240 --> 00:27:00,590
you would compute SVD on both of those

555
00:26:58,640 --> 00:27:02,270
<font color="#E5E5E5">the one that was from like the day</font>

556
00:27:00,590 --> 00:27:04,790
before<font color="#E5E5E5"> and then the one that's current</font>

557
00:27:02,270 --> 00:27:06,800
and and then we<font color="#E5E5E5"> just take the like the</font>

558
00:27:04,790 --> 00:27:08,659
first<font color="#E5E5E5"> eigen value from the result of</font>

559
00:27:06,800 --> 00:27:10,490
that computation<font color="#E5E5E5"> to give us serve an</font>

560
00:27:08,660 --> 00:27:13,040
approximate number that the serve

561
00:27:10,490 --> 00:27:14,360
represents the<font color="#E5E5E5"> current state</font><font color="#CCCCCC"> and the</font>

562
00:27:13,040 --> 00:27:15,770
latest column

563
00:27:14,360 --> 00:27:18,169
could the fact<font color="#CCCCCC"> that there's a big</font>

564
00:27:15,770 --> 00:27:24,950
anomaly<font color="#E5E5E5"> yeah exactly</font><font color="#CCCCCC"> that's the key</font>

565
00:27:18,170 --> 00:27:28,030
intuition<font color="#E5E5E5"> yeah well thank you guys it's</font>

566
00:27:24,950 --> 00:27:28,030
<font color="#E5E5E5">been a pleasure</font><font color="#CCCCCC"> great job</font>

