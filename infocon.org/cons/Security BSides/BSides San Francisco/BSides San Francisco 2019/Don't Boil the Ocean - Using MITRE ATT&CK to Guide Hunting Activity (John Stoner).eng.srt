1
00:00:00,030 --> 00:00:04,770
so my name<font color="#E5E5E5"> is John stoner</font><font color="#CCCCCC"> thanks for</font>

2
00:00:03,419 --> 00:00:07,048
having me out we're<font color="#E5E5E5"> gonna talk about</font>

3
00:00:04,770 --> 00:00:09,570
<font color="#CCCCCC">miter attack</font><font color="#E5E5E5"> thread hunting activities</font>

4
00:00:07,049 --> 00:00:11,070
and a<font color="#E5E5E5"> couple of other things</font><font color="#CCCCCC"> today my</font>

5
00:00:09,570 --> 00:00:12,420
organization always asked me to put a

6
00:00:11,070 --> 00:00:14,519
<font color="#CCCCCC">disclaimer out</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> just in case you</font>

7
00:00:12,420 --> 00:00:16,740
<font color="#CCCCCC">decide to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> some sort of a</font><font color="#E5E5E5"> decision</font>

8
00:00:14,519 --> 00:00:18,150
about getting software or<font color="#E5E5E5"> something so</font>

9
00:00:16,740 --> 00:00:20,729
we want to make sure<font color="#E5E5E5"> that nobody takes</font>

10
00:00:18,150 --> 00:00:23,609
anything<font color="#E5E5E5"> I put out there too seriously</font>

11
00:00:20,730 --> 00:00:29,099
in terms of futures and stuff so there's

12
00:00:23,609 --> 00:00:32,399
my disclaimer<font color="#E5E5E5"> enjoy</font><font color="#CCCCCC"> alright so this is</font>

13
00:00:29,099 --> 00:00:34,800
me<font color="#E5E5E5"> I've been doing various cyber</font>

14
00:00:32,399 --> 00:00:37,110
activities for the base past<font color="#E5E5E5"> 20 years</font><font color="#CCCCCC"> if</font>

15
00:00:34,800 --> 00:00:39,030
you're familiar with<font color="#E5E5E5"> some stuff within</font>

16
00:00:37,110 --> 00:00:40,649
<font color="#CCCCCC">Splunk I wrote the essay investigator</font>

17
00:00:39,030 --> 00:00:42,690
app it was<font color="#CCCCCC"> a fun</font><font color="#E5E5E5"> little app I continue</font>

18
00:00:40,649 --> 00:00:45,260
to develop<font color="#E5E5E5"> today</font><font color="#CCCCCC"> I do a lot of blogging</font>

19
00:00:42,690 --> 00:00:47,940
around<font color="#CCCCCC"> hunting and security</font><font color="#E5E5E5"> operations</font>

20
00:00:45,260 --> 00:00:50,610
<font color="#CCCCCC">spent some quality time at a couple of</font>

21
00:00:47,940 --> 00:00:53,070
different organizations there within<font color="#E5E5E5"> the</font>

22
00:00:50,610 --> 00:00:54,809
sim<font color="#E5E5E5"> and thread Intel space and as a</font>

23
00:00:53,070 --> 00:00:57,120
personal note I happen to love the

24
00:00:54,809 --> 00:00:58,559
Smiths and<font color="#E5E5E5"> all 80 sad timing music that</font>

25
00:00:57,120 --> 00:00:59,879
was something one<font color="#E5E5E5"> of my colleagues put</font>

26
00:00:58,559 --> 00:01:03,989
into the deck and<font color="#E5E5E5"> I figured I'd keep it</font>

27
00:00:59,879 --> 00:01:05,339
in there so today as we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> through</font>

28
00:01:03,989 --> 00:01:07,950
this we're going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> kind of cover four</font>

29
00:01:05,339 --> 00:01:10,048
high level areas<font color="#E5E5E5"> we're gonna talk about</font>

30
00:01:07,950 --> 00:01:12,090
<font color="#E5E5E5">the what and why do we hunt we're gonna</font>

31
00:01:10,049 --> 00:01:13,740
talk about<font color="#E5E5E5"> how</font><font color="#CCCCCC"> my torrent a conforms us</font>

32
00:01:12,090 --> 00:01:15,990
<font color="#E5E5E5">during that hunt we're going to talk</font>

33
00:01:13,740 --> 00:01:17,189
<font color="#E5E5E5">about building hypotheses because when</font>

34
00:01:15,990 --> 00:01:18,210
we start looking at<font color="#E5E5E5"> threat hunting we</font>

35
00:01:17,189 --> 00:01:20,490
kind of like applying<font color="#E5E5E5"> the scientific</font>

36
00:01:18,210 --> 00:01:22,229
<font color="#CCCCCC">method to this</font><font color="#E5E5E5"> and building a hypothesis</font>

37
00:01:20,490 --> 00:01:23,850
<font color="#E5E5E5">going ahead and confirming</font><font color="#CCCCCC"> or refuting</font>

38
00:01:22,229 --> 00:01:26,310
the hypothesis and<font color="#E5E5E5"> going from there and</font>

39
00:01:23,850 --> 00:01:27,630
then<font color="#E5E5E5"> going ahead and looking</font><font color="#CCCCCC"> at what are</font>

40
00:01:26,310 --> 00:01:30,630
the<font color="#E5E5E5"> things we can take away</font><font color="#CCCCCC"> from our</font>

41
00:01:27,630 --> 00:01:32,699
hunts as we go through they<font color="#E5E5E5"> can get very</font>

42
00:01:30,630 --> 00:01:34,229
<font color="#CCCCCC">complicated and get</font><font color="#E5E5E5"> very busy we're</font>

43
00:01:32,700 --> 00:01:36,119
trying<font color="#E5E5E5"> to kind of</font><font color="#CCCCCC"> simplify some of these</font>

44
00:01:34,229 --> 00:01:38,070
things<font color="#E5E5E5"> to kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> help people</font><font color="#CCCCCC"> focus and</font>

45
00:01:36,119 --> 00:01:40,680
be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to go ahead and get a meaningful</font>

46
00:01:38,070 --> 00:01:42,839
hunt out of it so I<font color="#CCCCCC"> don't know if</font>

47
00:01:40,680 --> 00:01:45,360
anybody knows this<font color="#E5E5E5"> gentleman about a</font>

48
00:01:42,840 --> 00:01:48,810
year ago<font color="#CCCCCC"> I was</font><font color="#E5E5E5"> looking for a good way to</font>

49
00:01:45,360 --> 00:01:50,460
synthesize<font color="#E5E5E5"> why do I hunt and the Twitter</font>

50
00:01:48,810 --> 00:01:52,560
<font color="#CCCCCC">Fairy came by one day and dropped</font><font color="#E5E5E5"> this</font>

51
00:01:50,460 --> 00:01:55,649
right in<font color="#E5E5E5"> my feed and I've kept it ever</font>

52
00:01:52,560 --> 00:01:56,729
<font color="#E5E5E5">since</font><font color="#CCCCCC"> because it really epitomizes</font><font color="#E5E5E5"> why</font>

53
00:01:55,649 --> 00:01:59,009
we want to hunt

54
00:01:56,729 --> 00:02:01,530
<font color="#E5E5E5">right if I'm playing whack-a-mole within</font>

55
00:01:59,009 --> 00:02:04,140
my organization<font color="#CCCCCC"> I</font><font color="#E5E5E5"> fixed that one box I</font>

56
00:02:01,530 --> 00:02:07,920
move on I'm great I'm happy<font color="#E5E5E5"> and the</font>

57
00:02:04,140 --> 00:02:10,440
adversary<font color="#CCCCCC"> said sing</font><font color="#E5E5E5"> goes I'm good right</font>

58
00:02:07,920 --> 00:02:11,450
<font color="#E5E5E5">one one one little foothold down I got</font>

59
00:02:10,440 --> 00:02:13,620
<font color="#CCCCCC">twenty others within</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> organization</font>

60
00:02:11,450 --> 00:02:15,238
<font color="#CCCCCC">the reason I want to hunt</font>

61
00:02:13,620 --> 00:02:16,830
is because I want to<font color="#E5E5E5"> go and find those</font>

62
00:02:15,239 --> 00:02:17,849
<font color="#CCCCCC">other pieces</font><font color="#E5E5E5"> and there's other</font><font color="#CCCCCC"> nuggets</font>

63
00:02:16,830 --> 00:02:19,739
they're still sitting<font color="#E5E5E5"> around my</font>

64
00:02:17,849 --> 00:02:21,420
<font color="#E5E5E5">environment and if all I worry about is</font>

65
00:02:19,739 --> 00:02:22,319
<font color="#E5E5E5">the lack of mole</font><font color="#CCCCCC"> I'm never</font><font color="#E5E5E5"> gonna find</font>

66
00:02:21,420 --> 00:02:27,268
<font color="#E5E5E5">those other things that</font><font color="#CCCCCC"> I'm gonna</font>

67
00:02:22,319 --> 00:02:28,530
constantly be playing catch-up<font color="#E5E5E5"> so the</font>

68
00:02:27,269 --> 00:02:31,980
question<font color="#E5E5E5"> then becomes what do we hunt</font>

69
00:02:28,530 --> 00:02:33,239
for well like Indiana Jones<font color="#CCCCCC"> we have to</font>

70
00:02:31,980 --> 00:02:34,798
<font color="#E5E5E5">kind of think</font><font color="#CCCCCC"> about this from</font><font color="#E5E5E5"> a hunt</font>

71
00:02:33,239 --> 00:02:36,690
perspective of going down from there

72
00:02:34,799 --> 00:02:38,099
very very trivial things and if<font color="#E5E5E5"> you guys</font>

73
00:02:36,690 --> 00:02:39,720
watched any of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> trilogy you</font><font color="#E5E5E5"> really</font>

74
00:02:38,099 --> 00:02:41,250
call that<font color="#E5E5E5"> he never really found any</font>

75
00:02:39,720 --> 00:02:43,379
trivial stuff we never<font color="#E5E5E5"> saw those in the</font>

76
00:02:41,250 --> 00:02:44,790
film<font color="#E5E5E5"> right he always went up to a little</font>

77
00:02:43,379 --> 00:02:47,280
<font color="#E5E5E5">bit</font><font color="#CCCCCC"> more of the annoying the challenging</font>

78
00:02:44,790 --> 00:02:49,620
<font color="#E5E5E5">and the tough there so but if you think</font>

79
00:02:47,280 --> 00:02:51,540
about it<font color="#CCCCCC"> I collect a hash value I</font>

80
00:02:49,620 --> 00:02:53,910
collect an IP address<font color="#CCCCCC"> those are very</font>

81
00:02:51,540 --> 00:02:56,129
<font color="#E5E5E5">very easy</font><font color="#CCCCCC"> to find</font><font color="#E5E5E5"> they can have some</font>

82
00:02:53,910 --> 00:02:57,959
<font color="#CCCCCC">impact but it's very</font><font color="#E5E5E5"> easy for the</font>

83
00:02:56,129 --> 00:03:00,659
adversary<font color="#CCCCCC"> to</font><font color="#E5E5E5"> change those</font><font color="#CCCCCC"> things as well</font>

84
00:02:57,959 --> 00:03:02,549
<font color="#E5E5E5">as I work</font><font color="#CCCCCC"> my way up</font><font color="#E5E5E5"> the stack finding</font>

85
00:03:00,659 --> 00:03:04,440
tools from<font color="#E5E5E5"> the adversary finding TTP's</font>

86
00:03:02,549 --> 00:03:06,299
from the adversary<font color="#E5E5E5"> it's very tough for</font>

87
00:03:04,440 --> 00:03:09,180
<font color="#CCCCCC">us to find but they're extremely</font>

88
00:03:06,299 --> 00:03:11,340
<font color="#E5E5E5">valuable and it inflicts pain on the</font>

89
00:03:09,180 --> 00:03:12,989
adversary in the<font color="#E5E5E5"> other direction</font><font color="#CCCCCC"> so the</font>

90
00:03:11,340 --> 00:03:14,400
farther we can go up<font color="#CCCCCC"> that stack during</font>

91
00:03:12,989 --> 00:03:16,200
our hunts and find more and<font color="#CCCCCC"> more</font><font color="#E5E5E5"> of</font>

92
00:03:14,400 --> 00:03:18,599
those high-value nuggets<font color="#E5E5E5"> the more</font>

93
00:03:16,200 --> 00:03:20,010
impactful we can be right so as we talk

94
00:03:18,599 --> 00:03:22,768
<font color="#CCCCCC">about these</font><font color="#E5E5E5"> things and</font><font color="#CCCCCC"> start looking</font><font color="#E5E5E5"> at</font>

95
00:03:20,010 --> 00:03:24,780
these let's keep that<font color="#CCCCCC"> in mind</font><font color="#E5E5E5"> but</font>

96
00:03:22,769 --> 00:03:26,190
remember choose and choose wisely<font color="#CCCCCC"> and</font>

97
00:03:24,780 --> 00:03:28,370
think<font color="#E5E5E5"> about what happened to the guy who</font>

98
00:03:26,190 --> 00:03:31,980
didn't choose wisely

99
00:03:28,370 --> 00:03:35,669
<font color="#E5E5E5">so we can use miter attack to go ahead</font>

100
00:03:31,980 --> 00:03:37,260
<font color="#E5E5E5">and basically get a better idea around</font>

101
00:03:35,669 --> 00:03:38,639
the techniques and<font color="#E5E5E5"> the tactics that our</font>

102
00:03:37,260 --> 00:03:40,888
<font color="#CCCCCC">adversaries</font><font color="#E5E5E5"> are using and use that to</font>

103
00:03:38,639 --> 00:03:42,629
inform<font color="#CCCCCC"> our hunt now for those</font><font color="#E5E5E5"> who just a</font>

104
00:03:40,889 --> 00:03:45,480
quick show of hands here<font color="#CCCCCC"> how many people</font>

105
00:03:42,629 --> 00:03:48,750
are<font color="#E5E5E5"> familiar with miter attack</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> about</font>

106
00:03:45,480 --> 00:03:50,698
<font color="#CCCCCC">half give or take</font><font color="#E5E5E5"> okay so miter attack</font>

107
00:03:48,750 --> 00:03:53,940
adversarial tactics techniques<font color="#CCCCCC"> in common</font>

108
00:03:50,699 --> 00:03:55,109
<font color="#CCCCCC">knowledge basically what I like to do</font>

109
00:03:53,940 --> 00:03:56,760
and if you actually<font color="#CCCCCC"> go to the</font><font color="#E5E5E5"> miter</font>

110
00:03:55,109 --> 00:03:59,519
<font color="#CCCCCC">attack</font><font color="#E5E5E5"> site they'll talk</font><font color="#CCCCCC"> about and show</font>

111
00:03:56,760 --> 00:04:00,959
you how it is set up against the<font color="#CCCCCC"> locky</font>

112
00:03:59,519 --> 00:04:03,090
<font color="#E5E5E5">mark and kill chain which is</font><font color="#CCCCCC"> that thing</font>

113
00:04:00,959 --> 00:04:05,040
down below but it's<font color="#E5E5E5"> really addressing</font>

114
00:04:03,090 --> 00:04:07,790
the<font color="#E5E5E5"> stuff to the</font><font color="#CCCCCC"> right hand side post</font>

115
00:04:05,040 --> 00:04:11,129
exploitation<font color="#CCCCCC"> and post exploitation</font>

116
00:04:07,790 --> 00:04:13,620
<font color="#E5E5E5">within an attackers kill chain if you</font>

117
00:04:11,129 --> 00:04:15,510
<font color="#CCCCCC">will</font><font color="#E5E5E5"> there is actually another model out</font>

118
00:04:13,620 --> 00:04:17,160
<font color="#CCCCCC">there called pre attack</font><font color="#E5E5E5"> that looks to</font>

119
00:04:15,510 --> 00:04:20,668
<font color="#E5E5E5">the stuff to the</font><font color="#CCCCCC"> left of</font><font color="#E5E5E5"> bang so to</font>

120
00:04:17,160 --> 00:04:22,380
speak<font color="#CCCCCC"> okay now the reason this exists</font>

121
00:04:20,668 --> 00:04:24,270
<font color="#CCCCCC">and a good reason that</font><font color="#E5E5E5"> you can use this</font>

122
00:04:22,380 --> 00:04:26,880
<font color="#E5E5E5">from a</font><font color="#CCCCCC"> threat perspective is is once an</font>

123
00:04:24,270 --> 00:04:27,370
adversary has a foothold<font color="#E5E5E5"> on your system</font>

124
00:04:26,880 --> 00:04:28,570
there's

125
00:04:27,370 --> 00:04:32,199
all sorts<font color="#E5E5E5"> of things that they're doing</font>

126
00:04:28,570 --> 00:04:34,690
<font color="#E5E5E5">in the Lockheed Martin kill chain model</font>

127
00:04:32,199 --> 00:04:36,850
<font color="#E5E5E5">it really made</font><font color="#CCCCCC"> it difficult to go back</font>

128
00:04:34,690 --> 00:04:38,169
into all those different<font color="#CCCCCC"> actions on</font>

129
00:04:36,850 --> 00:04:39,370
objectives<font color="#CCCCCC"> you're just saying I'm</font>

130
00:04:38,169 --> 00:04:41,859
looking<font color="#E5E5E5"> for this I'm looking for that</font>

131
00:04:39,370 --> 00:04:43,720
using<font color="#CCCCCC"> the mitre techniques I could be</font>

132
00:04:41,860 --> 00:04:45,760
<font color="#E5E5E5">looking across you know hundreds of</font>

133
00:04:43,720 --> 00:04:47,680
techniques that adversaries are using

134
00:04:45,760 --> 00:04:49,479
and map them across the kill chain as

135
00:04:47,680 --> 00:04:51,990
well<font color="#E5E5E5"> to better understand where in the</font>

136
00:04:49,479 --> 00:04:55,719
attack the adversary is so it gives me a

137
00:04:51,990 --> 00:04:57,729
greater<font color="#E5E5E5"> level of fidelity this is my</font>

138
00:04:55,720 --> 00:04:59,680
microcosm this is also<font color="#E5E5E5"> a very sorry</font>

139
00:04:57,729 --> 00:05:01,389
picture that I used<font color="#CCCCCC"> Microsoft Word or</font>

140
00:04:59,680 --> 00:05:02,949
PowerPoint to kind of draw my block

141
00:05:01,389 --> 00:05:05,110
diagram I couldn't<font color="#E5E5E5"> really draw out</font><font color="#CCCCCC"> a</font>

142
00:05:02,949 --> 00:05:07,560
<font color="#CCCCCC">three dimensional otherwise but</font><font color="#E5E5E5"> the idea</font>

143
00:05:05,110 --> 00:05:10,090
here<font color="#CCCCCC"> is is that you have in green a</font>

144
00:05:07,560 --> 00:05:12,760
tactic<font color="#E5E5E5"> right so lateral movement is a</font>

145
00:05:10,090 --> 00:05:14,320
tactic at the high level underneath<font color="#E5E5E5"> that</font>

146
00:05:12,760 --> 00:05:15,760
you<font color="#CCCCCC"> have a series of techniques</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> just</font>

147
00:05:14,320 --> 00:05:17,620
put two in there to make<font color="#CCCCCC"> it a little</font><font color="#E5E5E5"> bit</font>

148
00:05:15,760 --> 00:05:23,080
easier to read<font color="#E5E5E5"> past the hash and remote</font>

149
00:05:17,620 --> 00:05:24,940
<font color="#E5E5E5">desktop protocol on this side</font><font color="#CCCCCC"> of the</font>

150
00:05:23,080 --> 00:05:27,729
<font color="#E5E5E5">screen and turn</font><font color="#CCCCCC"> around here real quick</font>

151
00:05:24,940 --> 00:05:29,620
<font color="#CCCCCC">on in the blue right we have</font><font color="#E5E5E5"> software</font>

152
00:05:27,729 --> 00:05:31,450
right<font color="#E5E5E5"> these</font><font color="#CCCCCC"> are pieces</font><font color="#E5E5E5"> of software that</font>

153
00:05:29,620 --> 00:05:33,910
<font color="#CCCCCC">miters identified that mapped to</font>

154
00:05:31,450 --> 00:05:35,620
specific<font color="#E5E5E5"> adversary techniques and the</font>

155
00:05:33,910 --> 00:05:37,990
ones in red<font color="#E5E5E5"> are specific adversary</font>

156
00:05:35,620 --> 00:05:39,520
groups that map to<font color="#E5E5E5"> specific techniques</font>

157
00:05:37,990 --> 00:05:41,560
and of<font color="#E5E5E5"> course</font><font color="#CCCCCC"> certain adversaries used</font>

158
00:05:39,520 --> 00:05:42,969
<font color="#CCCCCC">by</font><font color="#E5E5E5"> certain pieces of software so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

159
00:05:41,560 --> 00:05:44,620
see<font color="#E5E5E5"> kind of the connection between these</font>

160
00:05:42,970 --> 00:05:46,270
different<font color="#E5E5E5"> things both from a threat</font>

161
00:05:44,620 --> 00:05:47,800
intelligence<font color="#E5E5E5"> perspective but also from a</font>

162
00:05:46,270 --> 00:05:50,620
threat hunting perspective<font color="#E5E5E5"> to better</font>

163
00:05:47,800 --> 00:05:52,539
inform<font color="#E5E5E5"> when I see an adversary using a</font>

164
00:05:50,620 --> 00:05:54,340
technique<font color="#E5E5E5"> it might help me inform who</font>

165
00:05:52,539 --> 00:05:56,620
the adversary is and what software

166
00:05:54,340 --> 00:05:57,909
<font color="#CCCCCC">obviously it's not an absolute</font><font color="#E5E5E5"> but these</font>

167
00:05:56,620 --> 00:06:00,190
are<font color="#E5E5E5"> different pieces that gain better</font>

168
00:05:57,910 --> 00:06:03,750
<font color="#E5E5E5">intelligence and better optics</font><font color="#CCCCCC"> into what</font>

169
00:06:00,190 --> 00:06:03,750
I'm<font color="#E5E5E5"> seeing within my environment</font><font color="#CCCCCC"> I</font>

170
00:06:03,930 --> 00:06:07,960
didn't think<font color="#E5E5E5"> this was going to render</font>

171
00:06:05,740 --> 00:06:09,370
<font color="#E5E5E5">well but what I actually walked into</font>

172
00:06:07,960 --> 00:06:12,760
this<font color="#E5E5E5"> theater I thought maybe this might</font>

173
00:06:09,370 --> 00:06:14,410
<font color="#E5E5E5">actually show up pretty well</font><font color="#CCCCCC"> so this is</font>

174
00:06:12,760 --> 00:06:18,039
<font color="#CCCCCC">the entire mitre attack enterprise</font>

175
00:06:14,410 --> 00:06:20,919
framework<font color="#E5E5E5"> it is constantly being added</font>

176
00:06:18,039 --> 00:06:22,780
<font color="#E5E5E5">to and in fact</font><font color="#CCCCCC"> the far left-hand</font><font color="#E5E5E5"> column</font>

177
00:06:20,919 --> 00:06:25,060
is initial access that wasn't there

178
00:06:22,780 --> 00:06:26,888
about a<font color="#E5E5E5"> year</font><font color="#CCCCCC"> ago the initial access used</font>

179
00:06:25,060 --> 00:06:28,570
to be part of pre attack<font color="#E5E5E5"> but as they</font>

180
00:06:26,889 --> 00:06:30,789
start<font color="#CCCCCC"> removing the</font><font color="#E5E5E5"> kill chain farther</font>

181
00:06:28,570 --> 00:06:33,340
and farther<font color="#E5E5E5"> to the delivery side initial</font>

182
00:06:30,789 --> 00:06:35,320
access started popping up there this is

183
00:06:33,340 --> 00:06:36,820
again something<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can go to</font><font color="#CCCCCC"> miters</font>

184
00:06:35,320 --> 00:06:38,020
site to go<font color="#CCCCCC"> ahead and reference there's a</font>

185
00:06:36,820 --> 00:06:39,490
number<font color="#E5E5E5"> of</font><font color="#CCCCCC"> different ways to look at this</font>

186
00:06:38,020 --> 00:06:40,780
I've got a couple<font color="#E5E5E5"> other</font><font color="#CCCCCC"> things in here</font>

187
00:06:39,490 --> 00:06:43,120
as well

188
00:06:40,780 --> 00:06:45,219
the other<font color="#E5E5E5"> model I wanted to talk about</font>

189
00:06:43,120 --> 00:06:46,510
was<font color="#E5E5E5"> the diamond model and and the reason</font>

190
00:06:45,220 --> 00:06:48,190
I'm talking about<font color="#E5E5E5"> this and it does go a</font>

191
00:06:46,510 --> 00:06:50,590
<font color="#E5E5E5">little bit away from mitre attack but it</font>

192
00:06:48,190 --> 00:06:52,000
also kind<font color="#E5E5E5"> of helps inform us from a</font>

193
00:06:50,590 --> 00:06:55,330
threat intelligence and a threat hunting

194
00:06:52,000 --> 00:06:56,800
perspective and and and the the two

195
00:06:55,330 --> 00:06:59,530
<font color="#E5E5E5">pieces coming together familiar</font><font color="#CCCCCC"> audit</font>

196
00:06:56,800 --> 00:07:01,750
<font color="#E5E5E5">familiar with a diamond model not many</font>

197
00:06:59,530 --> 00:07:03,369
<font color="#E5E5E5">people a couple</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> that's okay so</font>

198
00:07:01,750 --> 00:07:04,360
from a<font color="#E5E5E5"> diamond model</font><font color="#CCCCCC"> perspective again</font>

199
00:07:03,370 --> 00:07:06,840
it's more for threat intelligence

200
00:07:04,360 --> 00:07:09,160
there's a<font color="#E5E5E5"> couple of great links there</font>

201
00:07:06,840 --> 00:07:10,419
the example<font color="#E5E5E5"> here though I'll walk</font>

202
00:07:09,160 --> 00:07:12,610
through real briefly just to<font color="#E5E5E5"> kind of</font>

203
00:07:10,420 --> 00:07:14,470
give<font color="#E5E5E5"> you a feel because again I can take</font>

204
00:07:12,610 --> 00:07:15,610
<font color="#E5E5E5">my threat hunting pivot into my threat</font>

205
00:07:14,470 --> 00:07:17,500
intelligence because there's going to be

206
00:07:15,610 --> 00:07:19,720
a synergy and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> workflow between</font><font color="#E5E5E5"> those</font>

207
00:07:17,500 --> 00:07:20,980
folks<font color="#CCCCCC"> so in our example</font><font color="#E5E5E5"> here this</font><font color="#CCCCCC"> is</font>

208
00:07:19,720 --> 00:07:23,380
something<font color="#E5E5E5"> threat connect put together a</font>

209
00:07:20,980 --> 00:07:26,169
few<font color="#E5E5E5"> years</font><font color="#CCCCCC"> ago thread</font><font color="#E5E5E5"> connected has a</font>

210
00:07:23,380 --> 00:07:27,760
threat intelligence platform and they

211
00:07:26,169 --> 00:07:30,909
<font color="#CCCCCC">decided to go</font><font color="#E5E5E5"> ahead and build a diamond</font>

212
00:07:27,760 --> 00:07:34,390
model<font color="#E5E5E5"> around the the Battle of Yavin</font>

213
00:07:30,910 --> 00:07:35,470
<font color="#CCCCCC">maybe</font><font color="#E5E5E5"> here the Battle of Yavin come on</font>

214
00:07:34,390 --> 00:07:36,640
<font color="#E5E5E5">there's more than three people have seen</font>

215
00:07:35,470 --> 00:07:39,790
the battle<font color="#E5E5E5"> he read about the Battle of</font>

216
00:07:36,640 --> 00:07:42,310
Yavin<font color="#CCCCCC"> okay alright</font><font color="#E5E5E5"> so in the Battle of</font>

217
00:07:39,790 --> 00:07:45,760
Yavin<font color="#E5E5E5"> there was a victim out there who</font>

218
00:07:42,310 --> 00:07:49,060
<font color="#E5E5E5">is the victim the</font><font color="#CCCCCC"> death star</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Empire</font>

219
00:07:45,760 --> 00:07:50,320
<font color="#E5E5E5">they were the victims right but when I</font>

220
00:07:49,060 --> 00:07:52,000
look at this and<font color="#CCCCCC"> I look it</font><font color="#E5E5E5"> from a</font>

221
00:07:50,320 --> 00:07:53,849
diamond<font color="#E5E5E5"> model perspective</font><font color="#CCCCCC"> I have to look</font>

222
00:07:52,000 --> 00:07:56,260
<font color="#E5E5E5">at what are the capabilities</font><font color="#CCCCCC"> that the</font>

223
00:07:53,850 --> 00:08:02,110
adversary has<font color="#CCCCCC"> inflicted upon the</font><font color="#E5E5E5"> victim</font>

224
00:07:56,260 --> 00:08:04,180
<font color="#CCCCCC">I need to</font><font color="#E5E5E5"> look at the technique at all</font>

225
00:08:02,110 --> 00:08:06,660
the capabilities proton torpedoes the

226
00:08:04,180 --> 00:08:09,550
<font color="#CCCCCC">force</font><font color="#E5E5E5"> the lightsaber right those are</font><font color="#CCCCCC"> all</font>

227
00:08:06,660 --> 00:08:11,979
adversary capabilities<font color="#E5E5E5"> that the victim</font>

228
00:08:09,550 --> 00:08:12,880
absorbed on<font color="#E5E5E5"> the opposite side on the</font>

229
00:08:11,979 --> 00:08:14,140
infrastructure<font color="#E5E5E5"> what kind of</font>

230
00:08:12,880 --> 00:08:16,570
infrastructure<font color="#E5E5E5"> do they have well they</font>

231
00:08:14,140 --> 00:08:19,570
had a rebel base<font color="#E5E5E5"> right they had an</font>

232
00:08:16,570 --> 00:08:21,190
x-wing fighter<font color="#E5E5E5"> they had an r2d2 right</font>

233
00:08:19,570 --> 00:08:23,680
those different<font color="#CCCCCC"> capabilities and</font>

234
00:08:21,190 --> 00:08:28,900
infrastructure work and become what are

235
00:08:23,680 --> 00:08:32,289
the TTP's on that horizontal<font color="#E5E5E5"> axis well</font>

236
00:08:28,900 --> 00:08:35,289
which adversaries out there have those

237
00:08:32,289 --> 00:08:37,750
tactics techniques and procedures<font color="#E5E5E5"> who</font>

238
00:08:35,289 --> 00:08:41,140
has those capabilities<font color="#E5E5E5"> Luke Skywalker</font>

239
00:08:37,750 --> 00:08:43,150
<font color="#E5E5E5">does right the Rebel Alliance has those</font>

240
00:08:41,140 --> 00:08:45,400
<font color="#E5E5E5">and so you can see kind of</font><font color="#CCCCCC"> how I can</font>

241
00:08:43,150 --> 00:08:47,170
<font color="#E5E5E5">build an adversary victim relationship</font>

242
00:08:45,400 --> 00:08:48,880
and a capability infrastructure

243
00:08:47,170 --> 00:08:50,890
relationship as we get these different

244
00:08:48,880 --> 00:08:52,990
<font color="#E5E5E5">pieces and it can</font><font color="#CCCCCC"> inform us from a</font>

245
00:08:50,890 --> 00:08:54,060
threat intelligence perspective<font color="#E5E5E5"> so there</font>

246
00:08:52,990 --> 00:08:55,710
are<font color="#E5E5E5"> things that we're going to do</font>

247
00:08:54,060 --> 00:08:57,449
a<font color="#CCCCCC"> threat hunting perspective</font><font color="#E5E5E5"> that we can</font>

248
00:08:55,710 --> 00:08:59,130
then<font color="#E5E5E5"> plug back into our diamond model</font>

249
00:08:57,450 --> 00:09:00,840
and inform<font color="#E5E5E5"> our threat intelligence team</font>

250
00:08:59,130 --> 00:09:02,279
who can<font color="#E5E5E5"> then pivot back to our threat</font>

251
00:09:00,840 --> 00:09:03,930
intelligent or threat hunting and our

252
00:09:02,279 --> 00:09:07,560
<font color="#E5E5E5">security operations team so this becomes</font>

253
00:09:03,930 --> 00:09:08,969
a symbiotic<font color="#E5E5E5"> relationship we</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> also use</font>

254
00:09:07,560 --> 00:09:11,339
the diamond model to think<font color="#E5E5E5"> about how we</font>

255
00:09:08,970 --> 00:09:12,900
want<font color="#CCCCCC"> to hunt so there</font><font color="#E5E5E5"> are four vertices</font>

256
00:09:11,339 --> 00:09:14,190
<font color="#CCCCCC">there and there's actually a link at</font><font color="#E5E5E5"> the</font>

257
00:09:12,900 --> 00:09:16,050
<font color="#CCCCCC">bottom</font><font color="#E5E5E5"> of the screen that talked</font><font color="#CCCCCC"> about</font>

258
00:09:14,190 --> 00:09:17,550
<font color="#E5E5E5">how to build your using your diamond</font>

259
00:09:16,050 --> 00:09:19,709
model to go ahead<font color="#E5E5E5"> and inform your threat</font>

260
00:09:17,550 --> 00:09:22,410
hunting but again choose wisely

261
00:09:19,710 --> 00:09:23,880
<font color="#E5E5E5">all right capability and victim are</font>

262
00:09:22,410 --> 00:09:26,579
often the times where we're going to go

263
00:09:23,880 --> 00:09:28,230
ahead and choose<font color="#CCCCCC"> to start our hunts</font>

264
00:09:26,580 --> 00:09:29,700
generally you're not going to start at

265
00:09:28,230 --> 00:09:30,839
the adversary level you might start at

266
00:09:29,700 --> 00:09:32,550
<font color="#E5E5E5">the infrastructure level if you have</font>

267
00:09:30,839 --> 00:09:34,410
<font color="#CCCCCC">specific tippers</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> what-have-you to go</font>

268
00:09:32,550 --> 00:09:35,760
ahead<font color="#E5E5E5"> and</font><font color="#CCCCCC"> pivot from</font><font color="#E5E5E5"> there but these are</font>

269
00:09:34,410 --> 00:09:37,219
<font color="#CCCCCC">kind of</font><font color="#E5E5E5"> things just to kind of keep in</font>

270
00:09:35,760 --> 00:09:40,410
mind as<font color="#E5E5E5"> you're starting your threat hunt</font>

271
00:09:37,220 --> 00:09:41,850
<font color="#E5E5E5">now with attack attack can help drive</font>

272
00:09:40,410 --> 00:09:43,560
<font color="#CCCCCC">that</font><font color="#E5E5E5"> threat hunting piece which we'll</font>

273
00:09:41,850 --> 00:09:44,850
talk<font color="#E5E5E5"> about it can drive the threat</font>

274
00:09:43,560 --> 00:09:46,739
intelligence and that's<font color="#E5E5E5"> where</font><font color="#CCCCCC"> mitre</font>

275
00:09:44,850 --> 00:09:48,510
attack generated from to<font color="#E5E5E5"> start with and</font>

276
00:09:46,740 --> 00:09:49,410
the findings<font color="#E5E5E5"> that you have both from</font>

277
00:09:48,510 --> 00:09:50,700
<font color="#CCCCCC">your threat hunting your threat</font>

278
00:09:49,410 --> 00:09:52,890
intelligence can feed your<font color="#E5E5E5"> security</font>

279
00:09:50,700 --> 00:09:54,360
operations and<font color="#E5E5E5"> vice versa so you can see</font>

280
00:09:52,890 --> 00:09:55,710
kind<font color="#CCCCCC"> of how</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> different pieces can</font>

281
00:09:54,360 --> 00:09:57,630
work back and<font color="#E5E5E5"> forth</font><font color="#CCCCCC"> across one another</font>

282
00:09:55,710 --> 00:09:58,640
<font color="#CCCCCC">you</font><font color="#E5E5E5"> just have to be able to go ahead and</font>

283
00:09:57,630 --> 00:10:02,370
open<font color="#CCCCCC"> that</font><font color="#E5E5E5"> up</font>

284
00:09:58,640 --> 00:10:02,970
now as we<font color="#E5E5E5"> start looking at</font><font color="#CCCCCC"> Amanda</font><font color="#E5E5E5"> who</font>

285
00:10:02,370 --> 00:10:04,740
that guy is

286
00:10:02,970 --> 00:10:05,880
<font color="#CCCCCC">just checking time</font><font color="#E5E5E5"> time was</font><font color="#CCCCCC"> very</font>

287
00:10:04,740 --> 00:10:09,060
important in that<font color="#CCCCCC"> movie if you</font><font color="#E5E5E5"> think</font>

288
00:10:05,880 --> 00:10:10,560
<font color="#E5E5E5">about it</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> is a crucial factor</font><font color="#CCCCCC"> okay</font>

289
00:10:09,060 --> 00:10:13,199
<font color="#E5E5E5">so think about it from that</font><font color="#CCCCCC"> perspective</font>

290
00:10:10,560 --> 00:10:14,760
do not get myopic with your hunt<font color="#CCCCCC"> if you</font>

291
00:10:13,200 --> 00:10:16,890
go ahead<font color="#E5E5E5"> and set your hunt to a very</font>

292
00:10:14,760 --> 00:10:18,240
very<font color="#E5E5E5"> very narrow view you're</font><font color="#CCCCCC"> going to go</font>

293
00:10:16,890 --> 00:10:19,980
ahead<font color="#E5E5E5"> and miss all the</font><font color="#CCCCCC"> other things that</font>

294
00:10:18,240 --> 00:10:22,620
<font color="#CCCCCC">are out there</font><font color="#E5E5E5"> so start broadly with your</font>

295
00:10:19,980 --> 00:10:24,150
hunt<font color="#E5E5E5"> and gradually bring it in how much</font>

296
00:10:22,620 --> 00:10:28,820
<font color="#E5E5E5">of your data is generally</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> series</font>

297
00:10:24,150 --> 00:10:32,520
data most of<font color="#CCCCCC"> it some of</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> none of</font><font color="#E5E5E5"> it</font>

298
00:10:28,820 --> 00:10:34,290
anybody most of it right so<font color="#CCCCCC"> most of</font><font color="#E5E5E5"> it</font>

299
00:10:32,520 --> 00:10:37,170
<font color="#E5E5E5">is time series data</font><font color="#CCCCCC"> let's take advantage</font>

300
00:10:34,290 --> 00:10:38,339
of<font color="#CCCCCC"> that</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> use that timing</font><font color="#E5E5E5"> to go</font><font color="#CCCCCC"> ahead</font>

301
00:10:37,170 --> 00:10:39,319
and be able<font color="#E5E5E5"> to go ahead and review</font><font color="#CCCCCC"> that</font>

302
00:10:38,339 --> 00:10:41,370
<font color="#CCCCCC">from there</font>

303
00:10:39,320 --> 00:10:43,680
now when you start hunting against a

304
00:10:41,370 --> 00:10:44,880
hypothesis<font color="#CCCCCC"> it's important to understand</font>

305
00:10:43,680 --> 00:10:47,280
that your hunt is going<font color="#E5E5E5"> to take you in</font>

306
00:10:44,880 --> 00:10:48,570
many many<font color="#CCCCCC"> different directions okay it</font>

307
00:10:47,280 --> 00:10:51,689
could<font color="#E5E5E5"> lead you to where the</font><font color="#CCCCCC"> sidewalk</font>

308
00:10:48,570 --> 00:10:52,709
ends<font color="#E5E5E5"> but what's important to know along</font>

309
00:10:51,690 --> 00:10:54,959
the<font color="#CCCCCC"> way</font><font color="#E5E5E5"> is you're</font><font color="#CCCCCC"> going to see bright</font>

310
00:10:52,709 --> 00:10:56,640
shiny objects<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure you</font>

311
00:10:54,959 --> 00:10:57,959
note those bright shiny objects but that

312
00:10:56,640 --> 00:10:59,490
you don't get distracted<font color="#CCCCCC"> by the right</font>

313
00:10:57,959 --> 00:11:01,229
shiny objects<font color="#CCCCCC"> and start walking</font><font color="#E5E5E5"> down the</font>

314
00:10:59,490 --> 00:11:03,150
street this<font color="#CCCCCC"> way</font><font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to continue</font>

315
00:11:01,230 --> 00:11:04,740
down the path<font color="#CCCCCC"> that you're on go ahead</font>

316
00:11:03,150 --> 00:11:06,120
<font color="#E5E5E5">and note those turns though that you</font>

317
00:11:04,740 --> 00:11:08,070
take so<font color="#CCCCCC"> that you can always retrace your</font>

318
00:11:06,120 --> 00:11:11,580
steps<font color="#E5E5E5"> and then start new</font>

319
00:11:08,070 --> 00:11:12,900
when you get to a dead end<font color="#E5E5E5"> another thing</font>

320
00:11:11,580 --> 00:11:14,820
that's important<font color="#E5E5E5"> to</font><font color="#CCCCCC"> note is is that</font>

321
00:11:12,900 --> 00:11:18,540
<font color="#CCCCCC">hunts do not exist in</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> silo so stay on</font>

322
00:11:14,820 --> 00:11:20,310
<font color="#E5E5E5">target</font><font color="#CCCCCC"> okay use them in like to think</font><font color="#E5E5E5"> of</font>

323
00:11:18,540 --> 00:11:23,069
it as<font color="#E5E5E5"> guardrails</font><font color="#CCCCCC"> right I started I</font>

324
00:11:20,310 --> 00:11:24,750
started<font color="#E5E5E5"> hunt with a</font><font color="#CCCCCC"> specific technique</font>

325
00:11:23,070 --> 00:11:26,640
<font color="#CCCCCC">we're gonna start going</font><font color="#E5E5E5"> down that route</font>

326
00:11:24,750 --> 00:11:29,220
<font color="#E5E5E5">so I might start hunting for PowerShell</font>

327
00:11:26,640 --> 00:11:32,010
<font color="#CCCCCC">and</font><font color="#E5E5E5"> in this case I might come across</font>

328
00:11:29,220 --> 00:11:34,320
<font color="#E5E5E5">PowerShell that also isn't seeing dating</font>

329
00:11:32,010 --> 00:11:35,580
coding<font color="#CCCCCC"> I could hunt</font><font color="#E5E5E5"> for data encoding</font>

330
00:11:34,320 --> 00:11:37,110
all by itself<font color="#E5E5E5"> but you know what the</font>

331
00:11:35,580 --> 00:11:39,510
confluence of those<font color="#E5E5E5"> two things might be</font>

332
00:11:37,110 --> 00:11:41,520
<font color="#E5E5E5">important for my specific hunt in my</font>

333
00:11:39,510 --> 00:11:43,920
<font color="#CCCCCC">specific environment for a specific</font>

334
00:11:41,520 --> 00:11:45,569
adversary<font color="#E5E5E5"> so being able to go ahead and</font>

335
00:11:43,920 --> 00:11:47,370
say hey what I see X and I see<font color="#E5E5E5"> Y</font>

336
00:11:45,570 --> 00:11:48,960
together<font color="#CCCCCC"> that's something</font><font color="#E5E5E5"> that might be</font>

337
00:11:47,370 --> 00:11:51,360
<font color="#E5E5E5">of higher value than</font><font color="#CCCCCC"> just one by itself</font>

338
00:11:48,960 --> 00:11:52,440
<font color="#CCCCCC">but</font><font color="#E5E5E5"> be loading those things and looking</font>

339
00:11:51,360 --> 00:11:56,370
for<font color="#E5E5E5"> those together so you're always</font>

340
00:11:52,440 --> 00:11:57,690
<font color="#E5E5E5">gonna trip over</font><font color="#CCCCCC"> those other pieces now</font>

341
00:11:56,370 --> 00:12:00,240
in this<font color="#E5E5E5"> case we're going to talk</font><font color="#CCCCCC"> about</font>

342
00:11:57,690 --> 00:12:01,620
building<font color="#E5E5E5"> our hypothesis and using the</font>

343
00:12:00,240 --> 00:12:05,640
mitre attack techniques to build<font color="#E5E5E5"> our</font>

344
00:12:01,620 --> 00:12:07,350
hypothesis so this kind of came out<font color="#E5E5E5"> of</font>

345
00:12:05,640 --> 00:12:08,910
<font color="#E5E5E5">something we've been working</font><font color="#CCCCCC"> on in our</font>

346
00:12:07,350 --> 00:12:12,120
<font color="#E5E5E5">team about</font><font color="#CCCCCC"> a year ago</font><font color="#E5E5E5"> we build an</font>

347
00:12:08,910 --> 00:12:15,180
adversary emulation<font color="#E5E5E5"> it's a blue team as</font>

348
00:12:12,120 --> 00:12:17,040
capture the flag exercise and we built

349
00:12:15,180 --> 00:12:18,209
this<font color="#E5E5E5"> thing we were executing against it</font>

350
00:12:17,040 --> 00:12:19,740
and<font color="#E5E5E5"> we wanted to come back with like a</font>

351
00:12:18,210 --> 00:12:22,110
deeper dive that<font color="#E5E5E5"> we could go</font><font color="#CCCCCC"> ahead and</font>

352
00:12:19,740 --> 00:12:24,510
provide to folks that<font color="#CCCCCC"> kind of better</font>

353
00:12:22,110 --> 00:12:25,890
unders<font color="#E5E5E5"> you know what the hunting</font>

354
00:12:24,510 --> 00:12:28,020
activity would look like and<font color="#CCCCCC"> what we</font>

355
00:12:25,890 --> 00:12:29,970
could uncover<font color="#E5E5E5"> and so I sat</font><font color="#CCCCCC"> down and kind</font>

356
00:12:28,020 --> 00:12:31,260
<font color="#CCCCCC">of started working through</font><font color="#E5E5E5"> this and I</font>

357
00:12:29,970 --> 00:12:32,640
<font color="#E5E5E5">started</font><font color="#CCCCCC"> looking at</font><font color="#E5E5E5"> this going well where</font>

358
00:12:31,260 --> 00:12:34,830
would<font color="#CCCCCC"> I start</font><font color="#E5E5E5"> and I took a look at the</font>

359
00:12:32,640 --> 00:12:36,390
mitre attack techniques<font color="#E5E5E5"> and I started</font>

360
00:12:34,830 --> 00:12:37,770
looking<font color="#CCCCCC"> at these and going yeah let's go</font>

361
00:12:36,390 --> 00:12:40,260
ahead and start hunting<font color="#E5E5E5"> for PowerShell</font>

362
00:12:37,770 --> 00:12:41,520
<font color="#CCCCCC">and I started</font><font color="#E5E5E5"> seeing all the different</font>

363
00:12:40,260 --> 00:12:42,780
<font color="#CCCCCC">things in PowerShell now of course</font><font color="#E5E5E5"> I</font>

364
00:12:41,520 --> 00:12:44,460
knew we<font color="#CCCCCC"> had PowerShell in there because</font>

365
00:12:42,780 --> 00:12:45,839
we had built this thing but it was

366
00:12:44,460 --> 00:12:47,880
<font color="#E5E5E5">really interesting to</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to go down</font>

367
00:12:45,840 --> 00:12:49,620
that path<font color="#CCCCCC"> and start seeing these</font>

368
00:12:47,880 --> 00:12:52,350
different<font color="#E5E5E5"> techniques</font><font color="#CCCCCC"> that are</font><font color="#E5E5E5"> called out</font>

369
00:12:49,620 --> 00:12:54,420
in the matrix<font color="#CCCCCC"> that</font><font color="#E5E5E5"> mitre puts together</font>

370
00:12:52,350 --> 00:12:58,530
<font color="#E5E5E5">and seeing these different</font><font color="#CCCCCC"> things within</font>

371
00:12:54,420 --> 00:13:00,569
data indicator on removal of Windows

372
00:12:58,530 --> 00:13:01,890
Event<font color="#CCCCCC"> log clearing right there's there's</font>

373
00:13:00,570 --> 00:13:04,260
<font color="#CCCCCC">a number of</font><font color="#E5E5E5"> them we'll get into</font><font color="#CCCCCC"> a couple</font>

374
00:13:01,890 --> 00:13:07,640
<font color="#CCCCCC">of others</font><font color="#E5E5E5"> but you can go ahead</font><font color="#CCCCCC"> and use</font>

375
00:13:04,260 --> 00:13:11,010
these<font color="#E5E5E5"> techniques as a starting point now</font>

376
00:13:07,640 --> 00:13:12,449
who who has PowerShell running in their

377
00:13:11,010 --> 00:13:15,510
environment<font color="#E5E5E5"> and I expect to see</font>

378
00:13:12,450 --> 00:13:17,850
everybody's hands<font color="#E5E5E5"> up</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> you can port</font>

379
00:13:15,510 --> 00:13:20,040
<font color="#CCCCCC">PowerShell to</font><font color="#E5E5E5"> Linux you can</font><font color="#CCCCCC"> put</font>

380
00:13:17,850 --> 00:13:21,840
PowerShell to<font color="#E5E5E5"> Mac OS so you're gonna see</font>

381
00:13:20,040 --> 00:13:23,790
PowerShell everywhere<font color="#E5E5E5"> at this</font>

382
00:13:21,840 --> 00:13:25,800
so hunting<font color="#E5E5E5"> just for</font><font color="#CCCCCC"> PowerShell might not</font>

383
00:13:23,790 --> 00:13:27,540
be super fortuitous<font color="#E5E5E5"> so it's important to</font>

384
00:13:25,800 --> 00:13:29,969
craft your<font color="#E5E5E5"> hypothesis in a way that's</font>

385
00:13:27,540 --> 00:13:31,829
<font color="#CCCCCC">gonna be most beneficial</font><font color="#E5E5E5"> but I can start</font>

386
00:13:29,970 --> 00:13:34,440
<font color="#E5E5E5">with</font><font color="#CCCCCC"> that and</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> can go ahead</font><font color="#CCCCCC"> and</font>

387
00:13:31,830 --> 00:13:36,300
<font color="#CCCCCC">modify and and broaden and narrow my</font>

388
00:13:34,440 --> 00:13:38,160
hypothesis how I want to<font color="#E5E5E5"> so the</font>

389
00:13:36,300 --> 00:13:40,140
hypothesis we picked was ad<font color="#E5E5E5"> versus we'll</font>

390
00:13:38,160 --> 00:13:42,390
use PowerShell<font color="#E5E5E5"> Empire</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> establish a</font>

391
00:13:40,140 --> 00:13:44,340
foothold and carry out attacks maybe<font color="#E5E5E5"> I</font>

392
00:13:42,390 --> 00:13:49,500
want to<font color="#CCCCCC"> time-bound that probably</font><font color="#E5E5E5"> do in</font>

393
00:13:44,340 --> 00:13:51,300
my in<font color="#CCCCCC"> mylar</font><font color="#E5E5E5"> in a very very wide network</font>

394
00:13:49,500 --> 00:13:52,620
with lots<font color="#E5E5E5"> of different pieces maybe I</font>

395
00:13:51,300 --> 00:13:54,300
want to bound it<font color="#E5E5E5"> to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> specific set of</font>

396
00:13:52,620 --> 00:13:55,980
hosts<font color="#E5E5E5"> maybe I want to bound it to</font><font color="#CCCCCC"> a</font>

397
00:13:54,300 --> 00:13:57,209
<font color="#E5E5E5">specific set of</font><font color="#CCCCCC"> servers maybe I want to</font>

398
00:13:55,980 --> 00:14:00,540
bound<font color="#E5E5E5"> it</font><font color="#CCCCCC"> to a specific</font><font color="#E5E5E5"> organization</font>

399
00:13:57,210 --> 00:14:03,090
<font color="#CCCCCC">right my hunt should have scope and and</font>

400
00:14:00,540 --> 00:14:04,260
<font color="#E5E5E5">some Len length and breadth</font><font color="#CCCCCC"> to it</font><font color="#E5E5E5"> so I</font>

401
00:14:03,090 --> 00:14:07,200
want to<font color="#E5E5E5"> go</font><font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> and think about that</font>

402
00:14:04,260 --> 00:14:09,180
<font color="#E5E5E5">from that perspective now unfortunately</font>

403
00:14:07,200 --> 00:14:10,410
<font color="#E5E5E5">I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have an hour to go</font><font color="#CCCCCC"> through all</font>

404
00:14:09,180 --> 00:14:12,810
of the different<font color="#CCCCCC"> things that we did to</font>

405
00:14:10,410 --> 00:14:16,100
go<font color="#CCCCCC"> ahead and validate these these</font>

406
00:14:12,810 --> 00:14:18,660
<font color="#E5E5E5">different</font><font color="#CCCCCC"> hypothesis and techniques but</font>

407
00:14:16,100 --> 00:14:20,070
<font color="#CCCCCC">what I want to</font><font color="#E5E5E5"> talk about now</font><font color="#CCCCCC"> is talk</font>

408
00:14:18,660 --> 00:14:21,600
about<font color="#E5E5E5"> how I can go ahead and build this</font>

409
00:14:20,070 --> 00:14:24,060
and then what should<font color="#E5E5E5"> I be thinking about</font>

410
00:14:21,600 --> 00:14:25,680
<font color="#E5E5E5">as I start the hunt what I should be</font>

411
00:14:24,060 --> 00:14:27,630
looking<font color="#CCCCCC"> at coming</font><font color="#E5E5E5"> back out of</font><font color="#CCCCCC"> the hunt</font>

412
00:14:25,680 --> 00:14:32,459
<font color="#E5E5E5">as</font><font color="#CCCCCC"> well and things that</font><font color="#E5E5E5"> I can do to</font>

413
00:14:27,630 --> 00:14:33,450
<font color="#CCCCCC">start operationalizing it</font><font color="#E5E5E5"> so first thing</font>

414
00:14:32,460 --> 00:14:35,070
when we<font color="#CCCCCC"> talk about</font><font color="#E5E5E5"> that we want to</font>

415
00:14:33,450 --> 00:14:36,420
hypothesize around these what I want to

416
00:14:35,070 --> 00:14:38,370
do is I want to go ahead and<font color="#CCCCCC"> try to</font>

417
00:14:36,420 --> 00:14:40,079
confirm my hypothesis<font color="#E5E5E5"> are going to</font>

418
00:14:38,370 --> 00:14:43,170
refute my hypothesis<font color="#E5E5E5"> right we don't</font>

419
00:14:40,080 --> 00:14:44,610
<font color="#E5E5E5">prove hypotheses going back and</font>

420
00:14:43,170 --> 00:14:47,459
channeling my<font color="#E5E5E5"> seventh grade science</font>

421
00:14:44,610 --> 00:14:48,630
teacher<font color="#E5E5E5"> at the moment there so what are</font>

422
00:14:47,460 --> 00:14:50,430
some<font color="#E5E5E5"> of the things I need to do well I'm</font>

423
00:14:48,630 --> 00:14:51,930
hunting for PowerShell right PowerShell

424
00:14:50,430 --> 00:14:53,640
technique<font color="#CCCCCC"> I can go ahead</font><font color="#E5E5E5"> and look at the</font>

425
00:14:51,930 --> 00:14:55,380
mitre attack I can<font color="#CCCCCC"> get a little</font><font color="#E5E5E5"> bit of</font>

426
00:14:53,640 --> 00:14:56,910
blur<font color="#E5E5E5"> 'bitch that I saw just there a</font>

427
00:14:55,380 --> 00:14:57,930
second ago<font color="#CCCCCC"> but I probably need to</font>

428
00:14:56,910 --> 00:14:59,910
understand<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit about what</font>

429
00:14:57,930 --> 00:15:02,880
PowerShell is how do I hunt<font color="#CCCCCC"> forward if I</font>

430
00:14:59,910 --> 00:15:04,980
don't understand what it is<font color="#CCCCCC"> right if I'm</font>

431
00:15:02,880 --> 00:15:06,390
going to go ahead and specifically say I

432
00:15:04,980 --> 00:15:07,650
want to<font color="#CCCCCC"> look for PowerShell</font><font color="#E5E5E5"> Empire I</font>

433
00:15:06,390 --> 00:15:09,330
need to understand a bit<font color="#CCCCCC"> more about</font>

434
00:15:07,650 --> 00:15:11,130
PowerShell Empire how it actually

435
00:15:09,330 --> 00:15:13,140
functions<font color="#E5E5E5"> what it actually</font><font color="#CCCCCC"> looks like</font>

436
00:15:11,130 --> 00:15:17,790
maybe what<font color="#E5E5E5"> kind of default settings it</font>

437
00:15:13,140 --> 00:15:22,020
has do any of you and your daily<font color="#E5E5E5"> IT</font>

438
00:15:17,790 --> 00:15:23,400
security lives<font color="#E5E5E5"> use default settings and</font>

439
00:15:22,020 --> 00:15:25,949
<font color="#E5E5E5">you don't have to raise</font><font color="#CCCCCC"> your hand I'm</font>

440
00:15:23,400 --> 00:15:27,840
not<font color="#CCCCCC"> gonna ask</font><font color="#E5E5E5"> you for that okay or maybe</font>

441
00:15:25,950 --> 00:15:29,520
you say no I<font color="#E5E5E5"> don't do it but you know</font>

442
00:15:27,840 --> 00:15:30,830
once in<font color="#CCCCCC"> a</font><font color="#E5E5E5"> while do I change every</font>

443
00:15:29,520 --> 00:15:33,300
default setting let me ask you that

444
00:15:30,830 --> 00:15:35,490
<font color="#CCCCCC">again you don't</font><font color="#E5E5E5"> to show your hands but</font>

445
00:15:33,300 --> 00:15:38,490
think about<font color="#E5E5E5"> it from</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> perspective</font>

446
00:15:35,490 --> 00:15:41,430
adversary has a job adversary has<font color="#E5E5E5"> bosses</font>

447
00:15:38,490 --> 00:15:42,750
adversary has timelines<font color="#CCCCCC"> right it's</font>

448
00:15:41,430 --> 00:15:44,069
entirely possible they're going to cut

449
00:15:42,750 --> 00:15:46,529
corners there and maybe take a<font color="#E5E5E5"> couple</font>

450
00:15:44,070 --> 00:15:48,060
default settings<font color="#E5E5E5"> so</font><font color="#CCCCCC"> why not look at</font><font color="#E5E5E5"> this</font>

451
00:15:46,529 --> 00:15:49,649
<font color="#E5E5E5">from a default setting perspective and</font>

452
00:15:48,060 --> 00:15:51,029
say are<font color="#E5E5E5"> there default settings maybe I</font>

453
00:15:49,649 --> 00:15:53,670
could look for<font color="#E5E5E5"> their low hanging fruit</font>

454
00:15:51,029 --> 00:15:55,439
to<font color="#E5E5E5"> start with right I can look</font><font color="#CCCCCC"> it from a</font>

455
00:15:53,670 --> 00:15:57,000
network<font color="#CCCCCC"> perspective and say PowerShell</font>

456
00:15:55,440 --> 00:15:57,810
does have network connections that go

457
00:15:57,000 --> 00:16:00,120
<font color="#E5E5E5">back and forth</font>

458
00:15:57,810 --> 00:16:02,130
what are those<font color="#CCCCCC"> network flows look like</font>

459
00:16:00,120 --> 00:16:03,750
what ports do they use look at<font color="#E5E5E5"> from a</font>

460
00:16:02,130 --> 00:16:05,970
user<font color="#CCCCCC"> level what user accounts are being</font>

461
00:16:03,750 --> 00:16:07,740
<font color="#E5E5E5">used when did the events occur again</font>

462
00:16:05,970 --> 00:16:10,290
coming back to<font color="#E5E5E5"> time being most crucial</font>

463
00:16:07,740 --> 00:16:12,330
and then<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> runs scripts</font><font color="#E5E5E5"> is</font>

464
00:16:10,290 --> 00:16:14,130
<font color="#E5E5E5">there insight into the specific scripts</font>

465
00:16:12,330 --> 00:16:15,570
that<font color="#E5E5E5"> are running out there that we can</font>

466
00:16:14,130 --> 00:16:17,370
go<font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> and take advantage of and</font>

467
00:16:15,570 --> 00:16:20,520
understand a<font color="#E5E5E5"> little bit</font><font color="#CCCCCC"> more about the</font>

468
00:16:17,370 --> 00:16:21,930
intent that<font color="#E5E5E5"> lets going on so if I can</font>

469
00:16:20,520 --> 00:16:24,209
start<font color="#CCCCCC"> with</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> just a couple of</font><font color="#E5E5E5"> those</font>

470
00:16:21,930 --> 00:16:26,279
<font color="#E5E5E5">questions</font><font color="#CCCCCC"> to start</font><font color="#E5E5E5"> my hunt</font><font color="#CCCCCC"> I can go</font>

471
00:16:24,209 --> 00:16:31,109
ahead<font color="#E5E5E5"> and start going about trying to</font>

472
00:16:26,279 --> 00:16:33,149
confirm or refute<font color="#E5E5E5"> that hypothesis now</font>

473
00:16:31,110 --> 00:16:36,240
when I<font color="#E5E5E5"> get to the end of my hunt</font><font color="#CCCCCC"> I need</font>

474
00:16:33,149 --> 00:16:38,540
<font color="#CCCCCC">to start thinking about this in a was I</font>

475
00:16:36,240 --> 00:16:41,400
able to confirm or refute it<font color="#E5E5E5"> if I</font>

476
00:16:38,540 --> 00:16:43,260
invariably refuted it find no problem<font color="#CCCCCC"> if</font>

477
00:16:41,400 --> 00:16:44,430
I<font color="#E5E5E5"> don't have enough information we'll</font>

478
00:16:43,260 --> 00:16:46,529
<font color="#E5E5E5">come back to that</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> because that's</font>

479
00:16:44,430 --> 00:16:47,819
important to be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to go</font><font color="#CCCCCC"> ahead and</font>

480
00:16:46,529 --> 00:16:49,860
inform our<font color="#E5E5E5"> self for hunts and make</font>

481
00:16:47,820 --> 00:16:51,600
ourselves better<font color="#E5E5E5"> over</font><font color="#CCCCCC"> time if I could</font>

482
00:16:49,860 --> 00:16:53,370
confirm it I've got a bit<font color="#E5E5E5"> of a problem</font>

483
00:16:51,600 --> 00:16:54,959
<font color="#E5E5E5">for chance and there's some steps I want</font>

484
00:16:53,370 --> 00:16:57,900
<font color="#CCCCCC">to do</font><font color="#E5E5E5"> to operation license so we'll</font>

485
00:16:54,959 --> 00:16:59,040
touch on that as well<font color="#E5E5E5"> but I always</font><font color="#CCCCCC"> like</font>

486
00:16:57,900 --> 00:17:00,060
<font color="#CCCCCC">to think of</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> for me what have we</font>

487
00:16:59,040 --> 00:17:01,620
learned

488
00:17:00,060 --> 00:17:02,670
what have we<font color="#CCCCCC"> learned from</font><font color="#E5E5E5"> our hunt if we</font>

489
00:17:01,620 --> 00:17:04,650
don't learn anything from<font color="#E5E5E5"> our hunt</font>

490
00:17:02,670 --> 00:17:06,569
<font color="#E5E5E5">there's really not a point to it</font><font color="#CCCCCC"> all</font>

491
00:17:04,650 --> 00:17:08,910
<font color="#E5E5E5">right</font><font color="#CCCCCC"> I want to understand what my</font>

492
00:17:06,569 --> 00:17:13,050
attack picture looks<font color="#E5E5E5"> like maybe a visual</font>

493
00:17:08,910 --> 00:17:14,280
learner here<font color="#CCCCCC"> okay I I know if you know</font>

494
00:17:13,050 --> 00:17:15,839
somebody sits here and tells<font color="#E5E5E5"> me a bunch</font>

495
00:17:14,280 --> 00:17:17,609
of things I'm sitting there<font color="#CCCCCC"> bobble head</font>

496
00:17:15,839 --> 00:17:19,980
bobble head bobble head and it's kind of

497
00:17:17,609 --> 00:17:22,319
going right by me I need<font color="#E5E5E5"> to write it</font>

498
00:17:19,980 --> 00:17:23,699
<font color="#CCCCCC">down</font><font color="#E5E5E5"> so I</font><font color="#CCCCCC"> can see it</font><font color="#E5E5E5"> right I need to go</font>

499
00:17:22,319 --> 00:17:25,678
<font color="#CCCCCC">ahead</font><font color="#E5E5E5"> and look at things because</font><font color="#CCCCCC"> from an</font>

500
00:17:23,699 --> 00:17:27,449
advanced attacker perspective there's

501
00:17:25,679 --> 00:17:29,130
data moving<font color="#E5E5E5"> all different</font><font color="#CCCCCC"> directions</font>

502
00:17:27,449 --> 00:17:30,480
and I'm just<font color="#E5E5E5"> not good at keeping up with</font>

503
00:17:29,130 --> 00:17:31,620
all the<font color="#E5E5E5"> different IP addresses</font><font color="#CCCCCC"> and</font>

504
00:17:30,480 --> 00:17:33,059
<font color="#CCCCCC">everything</font><font color="#E5E5E5"> else so I'd like to go</font><font color="#CCCCCC"> else</font>

505
00:17:31,620 --> 00:17:35,189
<font color="#E5E5E5">go ahead and draw our self a picture</font>

506
00:17:33,059 --> 00:17:37,139
build<font color="#E5E5E5"> that attack picture to see which</font>

507
00:17:35,190 --> 00:17:40,290
way data is flowing<font color="#E5E5E5"> and with what</font>

508
00:17:37,140 --> 00:17:41,850
characteristics<font color="#CCCCCC"> I mean one of the thing</font>

509
00:17:40,290 --> 00:17:43,620
<font color="#CCCCCC">about how do</font><font color="#E5E5E5"> I map the findings that I</font>

510
00:17:41,850 --> 00:17:46,379
have back to my diamond model so I can

511
00:17:43,620 --> 00:17:47,969
<font color="#CCCCCC">inform</font><font color="#E5E5E5"> my threat intelligence team</font><font color="#CCCCCC"> I may</font>

512
00:17:46,380 --> 00:17:49,020
want to look<font color="#E5E5E5"> for</font><font color="#CCCCCC"> other techniques</font><font color="#E5E5E5"> right</font>

513
00:17:47,970 --> 00:17:50,700
so if<font color="#CCCCCC"> Dave</font>

514
00:17:49,020 --> 00:17:52,350
<font color="#E5E5E5">coding is being used at</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same time as</font>

515
00:17:50,700 --> 00:17:54,450
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> again that's a valuable</font>

516
00:17:52,350 --> 00:17:57,270
nugget<font color="#CCCCCC"> if I see</font>

517
00:17:54,450 --> 00:17:59,820
exfiltration using an<font color="#E5E5E5"> alternative</font>

518
00:17:57,270 --> 00:18:01,230
protocol<font color="#E5E5E5"> like an FTP</font><font color="#CCCCCC"> or a DNS</font><font color="#E5E5E5"> that's</font>

519
00:17:59,820 --> 00:18:03,120
useful<font color="#E5E5E5"> information</font><font color="#CCCCCC"> I want to go ahead</font>

520
00:18:01,230 --> 00:18:04,530
<font color="#E5E5E5">and be able to plug that in</font><font color="#CCCCCC"> to say these</font>

521
00:18:03,120 --> 00:18:06,989
<font color="#E5E5E5">things</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> happening in concert with</font><font color="#CCCCCC"> one</font>

522
00:18:04,530 --> 00:18:08,280
<font color="#E5E5E5">another</font><font color="#CCCCCC"> right and then I want to</font><font color="#E5E5E5"> start</font>

523
00:18:06,990 --> 00:18:09,960
<font color="#E5E5E5">thinking</font><font color="#CCCCCC"> about this from</font><font color="#E5E5E5"> an operational</font>

524
00:18:08,280 --> 00:18:11,280
ization how can I feed this back to my

525
00:18:09,960 --> 00:18:13,320
sock because<font color="#E5E5E5"> we'll talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that in a</font>

526
00:18:11,280 --> 00:18:16,590
second and then the<font color="#CCCCCC"> last</font><font color="#E5E5E5"> thing is where</font>

527
00:18:13,320 --> 00:18:19,470
are gaps gaps are one of those kind of

528
00:18:16,590 --> 00:18:21,649
funny things<font color="#E5E5E5"> that are out there</font><font color="#CCCCCC"> there</font>

529
00:18:19,470 --> 00:18:23,880
was<font color="#CCCCCC"> a spirited debate around</font>

530
00:18:21,650 --> 00:18:26,760
<font color="#E5E5E5">Thanksgiving Christmas time between</font>

531
00:18:23,880 --> 00:18:28,800
Robert Lee and Richard<font color="#E5E5E5"> Bay click around</font>

532
00:18:26,760 --> 00:18:29,970
you know when you thread hunt<font color="#E5E5E5"> are you</font>

533
00:18:28,800 --> 00:18:32,129
supposed to<font color="#E5E5E5"> be threat hunting or are you</font>

534
00:18:29,970 --> 00:18:33,570
supposed to<font color="#E5E5E5"> be doing</font><font color="#CCCCCC"> gap analysis as</font>

535
00:18:32,130 --> 00:18:35,370
well<font color="#E5E5E5"> I kind of fall into the gap</font>

536
00:18:33,570 --> 00:18:37,649
analysis I want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> inform and make mice</font>

537
00:18:35,370 --> 00:18:40,469
might make my sock better and smarter<font color="#E5E5E5"> so</font>

538
00:18:37,650 --> 00:18:43,260
I kind of like using<font color="#E5E5E5"> the where</font><font color="#CCCCCC"> are gaps</font>

539
00:18:40,470 --> 00:18:45,060
as part of our hunt as well<font color="#E5E5E5"> so what have</font>

540
00:18:43,260 --> 00:18:46,230
we learned<font color="#CCCCCC"> right coming away from our</font>

541
00:18:45,060 --> 00:18:48,780
<font color="#CCCCCC">hut what have we learned did we learn</font>

542
00:18:46,230 --> 00:18:51,930
that they had default settings<font color="#E5E5E5"> within</font>

543
00:18:48,780 --> 00:18:54,180
<font color="#CCCCCC">their within their their</font><font color="#E5E5E5"> configuration</font>

544
00:18:51,930 --> 00:18:55,800
of their of their framework<font color="#E5E5E5"> right what</font>

545
00:18:54,180 --> 00:18:57,690
kind<font color="#E5E5E5"> of communications exists there</font>

546
00:18:55,800 --> 00:18:59,399
again think about<font color="#E5E5E5"> that pyramid of pain</font>

547
00:18:57,690 --> 00:19:01,050
if I can go ahead and<font color="#CCCCCC"> see some of these</font>

548
00:18:59,400 --> 00:19:03,480
things<font color="#CCCCCC"> from an adversary infrastructure</font>

549
00:19:01,050 --> 00:19:04,889
<font color="#E5E5E5">that's kind of a higher level threshold</font>

550
00:19:03,480 --> 00:19:08,930
of pain<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we can inflict upon them</font>

551
00:19:04,890 --> 00:19:11,370
who changes SSL certs on a regular basis

552
00:19:08,930 --> 00:19:13,500
<font color="#CCCCCC">ok a lot</font><font color="#E5E5E5"> of you guys do there's a lot of</font>

553
00:19:11,370 --> 00:19:15,629
fun when you do it<font color="#CCCCCC"> to write on all your</font>

554
00:19:13,500 --> 00:19:17,310
web servers on all your other<font color="#CCCCCC"> devices</font>

555
00:19:15,630 --> 00:19:18,600
<font color="#E5E5E5">right think about it from that</font>

556
00:19:17,310 --> 00:19:20,610
<font color="#CCCCCC">perspective those things</font><font color="#E5E5E5"> aren't a lot of</font>

557
00:19:18,600 --> 00:19:22,580
<font color="#E5E5E5">fun to do</font><font color="#CCCCCC"> why</font><font color="#E5E5E5"> would an adversary want to</font>

558
00:19:20,610 --> 00:19:25,169
change<font color="#E5E5E5"> those things</font><font color="#CCCCCC"> on a regular</font><font color="#E5E5E5"> basis</font>

559
00:19:22,580 --> 00:19:26,550
<font color="#CCCCCC">ok again they're a little</font><font color="#E5E5E5"> bit like us</font>

560
00:19:25,170 --> 00:19:27,750
<font color="#E5E5E5">they want to be able to go ahead and do</font>

561
00:19:26,550 --> 00:19:30,120
the things<font color="#CCCCCC"> that they want to do the fun</font>

562
00:19:27,750 --> 00:19:31,560
<font color="#CCCCCC">stuff right not necessarily go ahead and</font>

563
00:19:30,120 --> 00:19:33,389
do the operations and and and

564
00:19:31,560 --> 00:19:34,560
maintenance<font color="#CCCCCC"> kinds of things</font><font color="#E5E5E5"> so be</font>

565
00:19:33,390 --> 00:19:36,690
looking<font color="#CCCCCC"> for those kinds of</font><font color="#E5E5E5"> things to</font>

566
00:19:34,560 --> 00:19:38,460
take advantage of is<font color="#E5E5E5"> their outbound</font>

567
00:19:36,690 --> 00:19:40,470
communication is a large volume of<font color="#E5E5E5"> data</font>

568
00:19:38,460 --> 00:19:42,450
<font color="#E5E5E5">or small volume of data I mean</font><font color="#CCCCCC"> a trickle</font>

569
00:19:40,470 --> 00:19:43,860
is still important a large stream is

570
00:19:42,450 --> 00:19:45,240
obviously important that turns<font color="#E5E5E5"> to be an</font>

571
00:19:43,860 --> 00:19:46,530
outlier so it's probably<font color="#E5E5E5"> not going to be</font>

572
00:19:45,240 --> 00:19:51,420
those large volumes of<font color="#E5E5E5"> data but</font><font color="#CCCCCC"> you</font>

573
00:19:46,530 --> 00:19:54,060
never know<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at processes so from</font>

574
00:19:51,420 --> 00:19:56,010
a process<font color="#E5E5E5"> perspective are we seeing</font>

575
00:19:54,060 --> 00:19:58,919
processes running under specific

576
00:19:56,010 --> 00:20:01,200
<font color="#E5E5E5">accounts do we expect those processes to</font>

577
00:19:58,920 --> 00:20:02,770
<font color="#E5E5E5">be running</font><font color="#CCCCCC"> under specific</font><font color="#E5E5E5"> accounts if I</font>

578
00:20:01,200 --> 00:20:06,220
have a service account what I accept

579
00:20:02,770 --> 00:20:07,570
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> running on ftp Exe what I expect a</font>

580
00:20:06,220 --> 00:20:10,540
service to account to be running<font color="#CCCCCC"> Who am</font>

581
00:20:07,570 --> 00:20:12,250
I dot exe<font color="#E5E5E5"> right think about these things</font>

582
00:20:10,540 --> 00:20:14,139
from<font color="#E5E5E5"> a hunt perspective</font><font color="#CCCCCC"> and particularly</font>

583
00:20:12,250 --> 00:20:16,510
<font color="#E5E5E5">if a hunting</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> PowerShell are these</font>

584
00:20:14,140 --> 00:20:19,240
<font color="#E5E5E5">things being spawned by PowerShell does</font>

585
00:20:16,510 --> 00:20:20,800
that seem a<font color="#E5E5E5"> little odd think about these</font>

586
00:20:19,240 --> 00:20:22,060
from<font color="#CCCCCC"> that perspective as</font><font color="#E5E5E5"> you form up</font>

587
00:20:20,800 --> 00:20:24,250
your hypothesis<font color="#CCCCCC"> and using</font><font color="#E5E5E5"> those</font>

588
00:20:22,060 --> 00:20:26,560
techniques right

589
00:20:24,250 --> 00:20:28,900
do I have specific<font color="#CCCCCC"> things running</font><font color="#E5E5E5"> in a</font>

590
00:20:26,560 --> 00:20:32,139
specific order<font color="#E5E5E5"> when you guys do an</font>

591
00:20:28,900 --> 00:20:34,180
upgrade<font color="#CCCCCC"> of a system</font><font color="#E5E5E5"> right the manual</font>

592
00:20:32,140 --> 00:20:35,080
<font color="#E5E5E5">says do step</font><font color="#CCCCCC"> one do step two do step</font>

593
00:20:34,180 --> 00:20:37,270
three<font color="#E5E5E5"> right</font>

594
00:20:35,080 --> 00:20:39,970
<font color="#E5E5E5">it doesn't say do one then do three then</font>

595
00:20:37,270 --> 00:20:43,660
did - then do four then do seven and do

596
00:20:39,970 --> 00:20:45,910
five right<font color="#CCCCCC"> there's a specific order from</font>

597
00:20:43,660 --> 00:20:47,320
<font color="#E5E5E5">an adversary perspective chances are the</font>

598
00:20:45,910 --> 00:20:49,900
adversary<font color="#E5E5E5"> wants to run things in a</font>

599
00:20:47,320 --> 00:20:51,700
specific order as well why because they

600
00:20:49,900 --> 00:20:54,130
trusted<font color="#E5E5E5"> because they've tested it</font>

601
00:20:51,700 --> 00:20:55,270
because that's<font color="#E5E5E5"> how the manual runs it so</font>

602
00:20:54,130 --> 00:20:56,920
if I can<font color="#E5E5E5"> start looking for those</font>

603
00:20:55,270 --> 00:20:58,450
<font color="#E5E5E5">processes running in a specific order</font>

604
00:20:56,920 --> 00:21:00,040
that's another potential tell that we

605
00:20:58,450 --> 00:21:01,990
have out there<font color="#E5E5E5"> to be able to go ahead</font>

606
00:21:00,040 --> 00:21:03,610
and better understand what the<font color="#E5E5E5"> adversary</font>

607
00:21:01,990 --> 00:21:07,810
is doing and then hunt that<font color="#E5E5E5"> across</font>

608
00:21:03,610 --> 00:21:08,919
<font color="#E5E5E5">multiple systems</font><font color="#CCCCCC"> as well looking</font><font color="#E5E5E5"> at</font>

609
00:21:07,810 --> 00:21:10,360
other commands<font color="#E5E5E5"> that have been spawned</font>

610
00:21:08,920 --> 00:21:12,340
like I said<font color="#E5E5E5"> PowerShell run something</font>

611
00:21:10,360 --> 00:21:13,899
spawn<font color="#E5E5E5"> something else and then the last</font>

612
00:21:12,340 --> 00:21:16,120
part<font color="#E5E5E5"> is is there any nuggets</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I can</font>

613
00:21:13,900 --> 00:21:19,390
find out<font color="#E5E5E5"> there on the internet as an</font>

614
00:21:16,120 --> 00:21:21,100
example PowerShell Empire<font color="#E5E5E5"> is freely</font>

615
00:21:19,390 --> 00:21:22,510
available out there<font color="#CCCCCC"> on github there are</font>

616
00:21:21,100 --> 00:21:23,740
strings inside of that that if I'm

617
00:21:22,510 --> 00:21:26,230
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> for it inside of my environment</font>

618
00:21:23,740 --> 00:21:28,330
<font color="#CCCCCC">I can pivot</font><font color="#E5E5E5"> out in search github the</font><font color="#CCCCCC"> pay</font>

619
00:21:26,230 --> 00:21:30,510
spins the<font color="#CCCCCC"> reddit's wherever out there in</font>

620
00:21:28,330 --> 00:21:33,220
the world<font color="#E5E5E5"> and look for additional</font>

621
00:21:30,510 --> 00:21:34,660
additional factoids<font color="#CCCCCC"> you know we kind of</font>

622
00:21:33,220 --> 00:21:36,730
<font color="#CCCCCC">talk about Google being</font><font color="#E5E5E5"> our friend from</font>

623
00:21:34,660 --> 00:21:38,320
a from a threat perspective take

624
00:21:36,730 --> 00:21:39,460
advantage of<font color="#E5E5E5"> that and start looking</font><font color="#CCCCCC"> for</font>

625
00:21:38,320 --> 00:21:40,540
<font color="#E5E5E5">those strings out there to kind of</font>

626
00:21:39,460 --> 00:21:42,400
better inform where are these<font color="#E5E5E5"> things</font>

627
00:21:40,540 --> 00:21:44,290
<font color="#CCCCCC">being seen are these default settings or</font>

628
00:21:42,400 --> 00:21:48,370
these other things<font color="#E5E5E5"> that do</font><font color="#CCCCCC"> ahead and</font>

629
00:21:44,290 --> 00:21:49,720
form us from our hunt so this is my

630
00:21:48,370 --> 00:21:51,760
other picture this is my<font color="#CCCCCC"> other picture</font>

631
00:21:49,720 --> 00:21:55,180
time<font color="#CCCCCC"> again you can tell that I'm quite</font>

632
00:21:51,760 --> 00:21:58,810
the artist<font color="#E5E5E5"> this is my hunter around</font>

633
00:21:55,180 --> 00:22:01,750
PowerShell<font color="#E5E5E5"> Empire</font><font color="#CCCCCC"> I have an SSL issuer I</font>

634
00:21:58,810 --> 00:22:03,190
have a shot 256 hash right<font color="#E5E5E5"> those are</font>

635
00:22:01,750 --> 00:22:04,690
indicators<font color="#CCCCCC"> that I can go ahead and use</font>

636
00:22:03,190 --> 00:22:07,390
and pivot within my environment<font color="#E5E5E5"> and look</font>

637
00:22:04,690 --> 00:22:09,970
for additional<font color="#E5E5E5"> instances of this I see a</font>

638
00:22:07,390 --> 00:22:12,250
<font color="#CCCCCC">callback to a</font><font color="#E5E5E5"> c2 server with an IP</font>

639
00:22:09,970 --> 00:22:14,980
address<font color="#E5E5E5"> and</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> domain that's something</font>

640
00:22:12,250 --> 00:22:16,169
else I can look for right<font color="#E5E5E5"> I see a couple</font>

641
00:22:14,980 --> 00:22:18,539
<font color="#E5E5E5">of servers</font>

642
00:22:16,169 --> 00:22:20,309
right I see executables being run those

643
00:22:18,539 --> 00:22:23,009
executables were being run in<font color="#E5E5E5"> a specific</font>

644
00:22:20,309 --> 00:22:27,418
<font color="#E5E5E5">order</font><font color="#CCCCCC"> ftp who will my schedule tasks I</font>

645
00:22:23,009 --> 00:22:29,700
see that being run across<font color="#CCCCCC"> to three</font>

646
00:22:27,419 --> 00:22:31,379
different<font color="#CCCCCC"> systems</font><font color="#E5E5E5"> once under one user</font>

647
00:22:29,700 --> 00:22:33,840
context<font color="#CCCCCC"> and</font><font color="#E5E5E5"> two under a different user</font>

648
00:22:31,379 --> 00:22:35,219
context<font color="#E5E5E5"> right those user contexts are</font>

649
00:22:33,840 --> 00:22:36,330
valuable understanding when those

650
00:22:35,220 --> 00:22:39,450
accounts may or may<font color="#CCCCCC"> not have been</font>

651
00:22:36,330 --> 00:22:40,830
<font color="#E5E5E5">created as valuable right</font><font color="#CCCCCC"> I can also see</font>

652
00:22:39,450 --> 00:22:43,559
that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> got a user agent string in there</font>

653
00:22:40,830 --> 00:22:45,600
and I also<font color="#E5E5E5"> see</font><font color="#CCCCCC"> that I</font><font color="#E5E5E5"> have a secondary</font>

654
00:22:43,559 --> 00:22:48,239
<font color="#E5E5E5">hunt that has kind</font><font color="#CCCCCC"> of merged its way</font>

655
00:22:45,600 --> 00:22:49,678
into my<font color="#CCCCCC"> powershell</font><font color="#E5E5E5"> hunt and that's okay</font>

656
00:22:48,239 --> 00:22:50,999
but<font color="#E5E5E5"> that's something</font><font color="#CCCCCC"> where I want to</font><font color="#E5E5E5"> go</font>

657
00:22:49,679 --> 00:22:52,499
ahead<font color="#E5E5E5"> and say you know what that's kind</font>

658
00:22:50,999 --> 00:22:54,029
of looking like a web vulnerability scan

659
00:22:52,499 --> 00:22:55,679
maybe it's<font color="#E5E5E5"> coming from that same server</font>

660
00:22:54,029 --> 00:22:57,539
over there let's go ahead<font color="#E5E5E5"> and kind of</font>

661
00:22:55,679 --> 00:23:00,119
<font color="#E5E5E5">put our package around it and set that</font>

662
00:22:57,539 --> 00:23:02,220
<font color="#CCCCCC">aside and build a</font><font color="#E5E5E5"> separate using the</font>

663
00:23:00,119 --> 00:23:03,749
techniques separate hunt<font color="#E5E5E5"> around that</font>

664
00:23:02,220 --> 00:23:05,220
other<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> so they don't start kind of</font>

665
00:23:03,749 --> 00:23:07,799
merging<font color="#E5E5E5"> and blurring the lines between</font>

666
00:23:05,220 --> 00:23:09,600
the<font color="#E5E5E5"> two right but right there I've got</font>

667
00:23:07,799 --> 00:23:11,429
<font color="#E5E5E5">five different indicators</font><font color="#CCCCCC"> that I could</font>

668
00:23:09,600 --> 00:23:13,830
pivot<font color="#E5E5E5"> back into and do additional hunts</font>

669
00:23:11,429 --> 00:23:16,649
on very very<font color="#E5E5E5"> straightforward</font><font color="#CCCCCC"> and that</font>

670
00:23:13,830 --> 00:23:19,499
<font color="#E5E5E5">doesn't even touch on the IP addresses</font>

671
00:23:16,649 --> 00:23:21,539
<font color="#CCCCCC">and host names of my individual systems</font>

672
00:23:19,499 --> 00:23:23,159
<font color="#E5E5E5">within my environment</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> this is just</font>

673
00:23:21,539 --> 00:23:24,720
kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> showing that</font><font color="#E5E5E5"> I have four or five</font>

674
00:23:23,159 --> 00:23:26,609
problematic systems that I need to do

675
00:23:24,720 --> 00:23:28,590
<font color="#E5E5E5">more digging on not even building</font>

676
00:23:26,609 --> 00:23:29,970
additional hypotheses around those so

677
00:23:28,590 --> 00:23:35,129
there's a lot of<font color="#E5E5E5"> fertile ground here</font>

678
00:23:29,970 --> 00:23:36,629
just on one hunt alone as I go ahead<font color="#CCCCCC"> and</font>

679
00:23:35,129 --> 00:23:38,158
<font color="#CCCCCC">look</font><font color="#E5E5E5"> at this and map this back to my</font>

680
00:23:36,629 --> 00:23:39,899
kill chain and<font color="#E5E5E5"> I'm sorry back to my</font>

681
00:23:38,159 --> 00:23:41,789
diamond model<font color="#E5E5E5"> I can</font><font color="#CCCCCC"> go ahead</font><font color="#E5E5E5"> and say</font>

682
00:23:39,899 --> 00:23:44,609
well<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> Empire is the capability</font>

683
00:23:41,789 --> 00:23:46,590
<font color="#CCCCCC">that our adversary has specifically</font><font color="#E5E5E5"> and</font>

684
00:23:44,609 --> 00:23:48,330
if I<font color="#E5E5E5"> went</font><font color="#CCCCCC"> back and</font><font color="#E5E5E5"> looked at</font><font color="#CCCCCC"> that IP</font>

685
00:23:46,590 --> 00:23:49,949
address<font color="#CCCCCC"> and the server's I could see</font>

686
00:23:48,330 --> 00:23:51,269
<font color="#E5E5E5">that those were European VPS servers</font>

687
00:23:49,950 --> 00:23:56,629
that<font color="#E5E5E5"> was part of the infrastructure and</font>

688
00:23:51,269 --> 00:23:59,220
in<font color="#E5E5E5"> the lower</font><font color="#CCCCCC"> right side</font><font color="#E5E5E5"> of the screen</font>

689
00:23:56,629 --> 00:24:00,899
<font color="#CCCCCC">you're left the technical axis there has</font>

690
00:23:59,220 --> 00:24:02,789
a number of TTP's that we've gathered

691
00:24:00,899 --> 00:24:04,289
throughout<font color="#E5E5E5"> that hunt again using all of</font>

692
00:24:02,789 --> 00:24:05,759
these different mitre attack techniques

693
00:24:04,289 --> 00:24:09,059
again<font color="#E5E5E5"> this was something we</font><font color="#CCCCCC"> build for</font>

694
00:24:05,759 --> 00:24:11,489
<font color="#CCCCCC">our adversary emulation and and so</font><font color="#E5E5E5"> you</font>

695
00:24:09,059 --> 00:24:13,408
can see with the specific organization

696
00:24:11,489 --> 00:24:15,570
that<font color="#E5E5E5"> was our our make believe adversary</font>

697
00:24:13,409 --> 00:24:16,769
here but you can see how I can<font color="#CCCCCC"> take</font><font color="#E5E5E5"> my</font>

698
00:24:15,570 --> 00:24:18,989
information<font color="#CCCCCC"> from my thread hunt</font><font color="#E5E5E5"> and</font>

699
00:24:16,769 --> 00:24:21,840
build out<font color="#E5E5E5"> this diamond model in for my</font>

700
00:24:18,989 --> 00:24:25,409
<font color="#E5E5E5">threat intelligence team to look at it a</font>

701
00:24:21,840 --> 00:24:26,820
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit of a different way yeah this</font>

702
00:24:25,409 --> 00:24:29,789
does show<font color="#CCCCCC"> much nicer here than it did on</font>

703
00:24:26,820 --> 00:24:30,178
<font color="#E5E5E5">my little screen this is</font><font color="#CCCCCC"> the miter</font>

704
00:24:29,789 --> 00:24:31,950
attack

705
00:24:30,179 --> 00:24:34,049
navigator<font color="#E5E5E5"> you can you can see the link</font>

706
00:24:31,950 --> 00:24:36,269
<font color="#E5E5E5">there you can go ahead</font><font color="#CCCCCC"> and put your own</font>

707
00:24:34,049 --> 00:24:37,740
overlays<font color="#CCCCCC"> onto this what I've done</font><font color="#E5E5E5"> here</font>

708
00:24:36,269 --> 00:24:39,570
<font color="#E5E5E5">is I've gone through and as I was</font>

709
00:24:37,740 --> 00:24:41,340
building<font color="#CCCCCC"> out all my hunts I went ahead</font>

710
00:24:39,570 --> 00:24:43,168
and<font color="#E5E5E5"> color-coded every time I saw an</font>

711
00:24:41,340 --> 00:24:45,269
additional instance of a<font color="#E5E5E5"> technique and</font>

712
00:24:43,169 --> 00:24:46,950
so in this case<font color="#CCCCCC"> Green is the most</font>

713
00:24:45,269 --> 00:24:48,360
<font color="#E5E5E5">frequently seen but PowerShell was the</font>

714
00:24:46,950 --> 00:24:50,100
most frequently<font color="#E5E5E5"> seen across all of my</font>

715
00:24:48,360 --> 00:24:51,748
hunts<font color="#E5E5E5"> but you can see across</font><font color="#CCCCCC"> the</font>

716
00:24:50,100 --> 00:24:53,759
individual tactics<font color="#CCCCCC"> the different</font>

717
00:24:51,749 --> 00:24:55,679
techniques that<font color="#E5E5E5"> we were using and where</font>

718
00:24:53,759 --> 00:24:57,419
it bore fruit<font color="#CCCCCC"> to go ahead</font><font color="#E5E5E5"> and see this</font>

719
00:24:55,679 --> 00:24:59,070
and again it becomes<font color="#E5E5E5"> all of these</font>

720
00:24:57,419 --> 00:25:01,259
different pieces really represent that

721
00:24:59,070 --> 00:25:03,269
apt to be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to understand what those</font>

722
00:25:01,259 --> 00:25:05,519
different<font color="#E5E5E5"> parts are we'll come back to</font>

723
00:25:03,269 --> 00:25:07,590
that<font color="#CCCCCC"> in a second</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> talked about</font>

724
00:25:05,519 --> 00:25:09,840
<font color="#E5E5E5">operational operationalizing our</font>

725
00:25:07,590 --> 00:25:11,519
findings<font color="#CCCCCC"> James James Bauer did a nice</font>

726
00:25:09,840 --> 00:25:13,350
little YouTube video on<font color="#E5E5E5"> threat hunting</font>

727
00:25:11,519 --> 00:25:15,659
web shells with<font color="#E5E5E5"> Splunk</font><font color="#CCCCCC"> you can go ahead</font>

728
00:25:13,350 --> 00:25:17,610
<font color="#E5E5E5">and check it out on YouTube</font><font color="#CCCCCC"> the comment</font>

729
00:25:15,659 --> 00:25:18,960
that<font color="#E5E5E5"> he put there was tremendous I</font>

730
00:25:17,610 --> 00:25:21,149
thought<font color="#E5E5E5"> because it kind of really</font>

731
00:25:18,960 --> 00:25:23,129
succinctly sums it up<font color="#E5E5E5"> thread hunting for</font>

732
00:25:21,149 --> 00:25:25,110
the sake of threat hunting and rinse and

733
00:25:23,129 --> 00:25:27,149
repeat is<font color="#E5E5E5"> not a good use of your time</font>

734
00:25:25,110 --> 00:25:29,269
<font color="#CCCCCC">okay I</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> think of it from the</font>

735
00:25:27,149 --> 00:25:32,549
<font color="#CCCCCC">perspective of the wheel there you hunt</font>

736
00:25:29,269 --> 00:25:35,429
<font color="#E5E5E5">you find something you operationalize it</font>

737
00:25:32,549 --> 00:25:37,259
<font color="#CCCCCC">and you move to the next thing</font><font color="#E5E5E5"> okay if I</font>

738
00:25:35,429 --> 00:25:38,730
operation<font color="#E5E5E5"> Eliza and right good alerting</font>

739
00:25:37,259 --> 00:25:39,869
<font color="#CCCCCC">I don't have to go hunt for</font><font color="#E5E5E5"> the same</font>

740
00:25:38,730 --> 00:25:42,869
thing over<font color="#E5E5E5"> and</font><font color="#CCCCCC"> over again it's not</font>

741
00:25:39,869 --> 00:25:45,629
efficient<font color="#CCCCCC"> okay so operationalize it and</font>

742
00:25:42,869 --> 00:25:47,039
move<font color="#E5E5E5"> to something else when we want to</font>

743
00:25:45,629 --> 00:25:48,299
<font color="#E5E5E5">start operationalizing it we need to</font>

744
00:25:47,039 --> 00:25:50,369
think<font color="#CCCCCC"> about this and think about it in</font>

745
00:25:48,299 --> 00:25:53,190
the context<font color="#E5E5E5"> of that pyramid</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> what</font>

746
00:25:50,369 --> 00:25:54,480
can we<font color="#E5E5E5"> Alert on we hit</font><font color="#CCCCCC"> a laurel encoded</font>

747
00:25:53,190 --> 00:25:55,470
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> they may</font><font color="#E5E5E5"> run encoded</font>

748
00:25:54,480 --> 00:25:56,460
PowerShell in their environment you

749
00:25:55,470 --> 00:25:58,139
<font color="#E5E5E5">don't have to raise your</font><font color="#CCCCCC"> hand if you</font>

750
00:25:56,460 --> 00:26:00,499
don't<font color="#E5E5E5"> want to but you</font><font color="#CCCCCC"> know some</font><font color="#E5E5E5"> people</font>

751
00:25:58,139 --> 00:26:02,850
<font color="#E5E5E5">do and there's good reasons for it right</font>

752
00:26:00,499 --> 00:26:04,230
<font color="#CCCCCC">other organizations they say you know</font>

753
00:26:02,850 --> 00:26:06,509
what there's no reason to<font color="#E5E5E5"> run encoded</font>

754
00:26:04,230 --> 00:26:09,869
<font color="#E5E5E5">PowerShell be aware of your organization</font>

755
00:26:06,509 --> 00:26:11,460
<font color="#E5E5E5">and why you might do that</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> when a</font>

756
00:26:09,869 --> 00:26:13,889
specific executable is run in a specific

757
00:26:11,460 --> 00:26:15,450
<font color="#E5E5E5">order</font><font color="#CCCCCC"> if I can go ahead</font><font color="#E5E5E5"> and instrument</font>

758
00:26:13,889 --> 00:26:17,219
<font color="#E5E5E5">that and I understand that this is</font>

759
00:26:15,450 --> 00:26:18,899
<font color="#CCCCCC">really</font><font color="#E5E5E5"> not something I'd expect</font><font color="#CCCCCC"> to see</font>

760
00:26:17,220 --> 00:26:20,460
within<font color="#E5E5E5"> my</font><font color="#CCCCCC"> environment alert on those</font>

761
00:26:18,899 --> 00:26:23,518
those could be<font color="#CCCCCC"> very much higher</font>

762
00:26:20,460 --> 00:26:26,129
<font color="#E5E5E5">fruit-bearing kinds of things</font><font color="#CCCCCC"> ssl</font>

763
00:26:23,519 --> 00:26:27,809
<font color="#E5E5E5">issuers same kinds of things</font><font color="#CCCCCC"> as i move</font>

764
00:26:26,129 --> 00:26:30,959
<font color="#CCCCCC">down the stack right I could blacklist</font>

765
00:26:27,809 --> 00:26:33,178
an IP address<font color="#E5E5E5"> that's totally fine if I'm</font>

766
00:26:30,960 --> 00:26:34,470
trying<font color="#E5E5E5"> to staunch the bleeding right if</font>

767
00:26:33,179 --> 00:26:36,539
I need to go ahead and<font color="#CCCCCC"> put something</font><font color="#E5E5E5"> in</font>

768
00:26:34,470 --> 00:26:37,860
spot just<font color="#E5E5E5"> to go ahead and stop the stop</font>

769
00:26:36,539 --> 00:26:39,960
stop the blood flowing<font color="#E5E5E5"> out of the</font>

770
00:26:37,860 --> 00:26:41,340
<font color="#CCCCCC">organization I</font><font color="#E5E5E5"> can do that but</font>

771
00:26:39,960 --> 00:26:42,899
understand that that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a temporary</font>

772
00:26:41,340 --> 00:26:44,209
solution because if I've got a whole

773
00:26:42,899 --> 00:26:45,830
host of VPS servers

774
00:26:44,210 --> 00:26:48,200
out there<font color="#CCCCCC"> I'm rolling to the next one</font>

775
00:26:45,830 --> 00:26:49,399
and<font color="#E5E5E5"> I'm keeping going</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so just</font>

776
00:26:48,200 --> 00:26:50,990
<font color="#CCCCCC">kind of keep those things in mind</font>

777
00:26:49,400 --> 00:26:52,370
<font color="#CCCCCC">there's AG of</font><font color="#E5E5E5"> a couple of other things</font>

778
00:26:50,990 --> 00:26:56,000
to<font color="#E5E5E5"> think about there but think about</font><font color="#CCCCCC"> it</font>

779
00:26:52,370 --> 00:27:00,820
in that context<font color="#E5E5E5"> so something else that</font>

780
00:26:56,000 --> 00:27:05,000
you<font color="#E5E5E5"> can do and again</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right cool</font>

781
00:27:00,820 --> 00:27:06,350
anybody familiar with a system on<font color="#CCCCCC"> system</font>

782
00:27:05,000 --> 00:27:08,600
<font color="#CCCCCC">on some people you insist upon okay</font>

783
00:27:06,350 --> 00:27:10,310
great<font color="#E5E5E5"> so sis</font><font color="#CCCCCC"> Mont has a set</font><font color="#E5E5E5"> of</font>

784
00:27:08,600 --> 00:27:11,870
configurations out there the<font color="#CCCCCC"> swift on</font>

785
00:27:10,310 --> 00:27:13,850
security ones are<font color="#CCCCCC"> probably the</font><font color="#E5E5E5"> most well</font>

786
00:27:11,870 --> 00:27:16,189
<font color="#E5E5E5">known that help you go</font><font color="#CCCCCC"> ahead and set up</font>

787
00:27:13,850 --> 00:27:17,990
rules<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> will</font><font color="#CCCCCC"> to go ahead and say</font>

788
00:27:16,190 --> 00:27:19,370
when I see specific images command lines

789
00:27:17,990 --> 00:27:21,530
parent images what-have-you

790
00:27:19,370 --> 00:27:23,449
go ahead and generate<font color="#E5E5E5"> a log event for me</font>

791
00:27:21,530 --> 00:27:24,950
<font color="#E5E5E5">well one of the functions that was built</font>

792
00:27:23,450 --> 00:27:27,460
into system on<font color="#E5E5E5"> recently is the ability</font>

793
00:27:24,950 --> 00:27:30,040
<font color="#E5E5E5">to go</font><font color="#CCCCCC"> ahead and add these additional</font>

794
00:27:27,460 --> 00:27:32,390
context to<font color="#CCCCCC"> it and so a whole la carte um</font>

795
00:27:30,040 --> 00:27:34,490
<font color="#E5E5E5">did a nice</font><font color="#CCCCCC"> thing and</font><font color="#E5E5E5"> went through and</font>

796
00:27:32,390 --> 00:27:36,800
basically<font color="#E5E5E5"> mapped all of these number of</font>

797
00:27:34,490 --> 00:27:39,200
these different<font color="#E5E5E5"> system on configs to the</font>

798
00:27:36,800 --> 00:27:40,970
<font color="#CCCCCC">miter attack techniques so you can see</font><font color="#E5E5E5"> I</font>

799
00:27:39,200 --> 00:27:43,310
got three of them<font color="#E5E5E5"> highlighted there you</font>

800
00:27:40,970 --> 00:27:45,680
see when<font color="#CCCCCC"> windows event you'd Alexei</font><font color="#E5E5E5"> is</font>

801
00:27:43,310 --> 00:27:48,050
referenced<font color="#E5E5E5"> it has the technique mapping</font>

802
00:27:45,680 --> 00:27:50,480
to indicate a removal<font color="#E5E5E5"> and host when I</font>

803
00:27:48,050 --> 00:27:52,610
see<font color="#CCCCCC"> remove definitions</font><font color="#E5E5E5"> from the command</font>

804
00:27:50,480 --> 00:27:55,010
line<font color="#CCCCCC"> its map to disabling security tools</font>

805
00:27:52,610 --> 00:27:56,600
when I see<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> Dec see</font><font color="#E5E5E5"> reference</font>

806
00:27:55,010 --> 00:27:58,850
<font color="#E5E5E5">in the parent image the technique is</font>

807
00:27:56,600 --> 00:28:00,230
PowerShell<font color="#E5E5E5"> so these are nice ways to be</font>

808
00:27:58,850 --> 00:28:02,840
able<font color="#E5E5E5"> to use things like the system on</font>

809
00:28:00,230 --> 00:28:04,580
<font color="#E5E5E5">tool set to better inform and go ahead</font>

810
00:28:02,840 --> 00:28:06,080
and create<font color="#E5E5E5"> those in my logs to ease my</font>

811
00:28:04,580 --> 00:28:07,879
way into<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of these hunting functions</font>

812
00:28:06,080 --> 00:28:08,899
to say let's just<font color="#E5E5E5"> start by looking at</font>

813
00:28:07,880 --> 00:28:10,340
<font color="#CCCCCC">some of the techniques</font><font color="#E5E5E5"> that are out</font>

814
00:28:08,900 --> 00:28:13,100
<font color="#CCCCCC">there</font><font color="#E5E5E5"> and where are we seeing it</font><font color="#CCCCCC"> within</font>

815
00:28:10,340 --> 00:28:14,659
the<font color="#CCCCCC"> environment and</font><font color="#E5E5E5"> I just pulled this</font>

816
00:28:13,100 --> 00:28:16,340
out<font color="#E5E5E5"> I just did this quick search</font><font color="#CCCCCC"> to go</font>

817
00:28:14,660 --> 00:28:17,750
<font color="#E5E5E5">ahead and pull PowerShell and</font><font color="#CCCCCC"> I can see</font>

818
00:28:16,340 --> 00:28:19,189
the different<font color="#E5E5E5"> techniques and</font><font color="#CCCCCC"> I can see</font>

819
00:28:17,750 --> 00:28:20,540
the images that<font color="#E5E5E5"> I can see the parent</font>

820
00:28:19,190 --> 00:28:24,260
images so<font color="#CCCCCC"> you can see power shells</font>

821
00:28:20,540 --> 00:28:27,950
running and spawning<font color="#CCCCCC"> CSC XE who am i XE</font>

822
00:28:24,260 --> 00:28:30,440
<font color="#E5E5E5">FTP XE net</font><font color="#CCCCCC"> sh c</font><font color="#E5E5E5"> right so I can see these</font>

823
00:28:27,950 --> 00:28:33,170
different<font color="#CCCCCC"> pieces</font><font color="#E5E5E5"> here the one caveat</font>

824
00:28:30,440 --> 00:28:34,850
that I would put<font color="#E5E5E5"> to this right and then</font>

825
00:28:33,170 --> 00:28:36,260
I can overlay this<font color="#CCCCCC"> onto a map and make</font>

826
00:28:34,850 --> 00:28:38,750
pretty pictures<font color="#CCCCCC"> out of it but it</font><font color="#E5E5E5"> helps</font>

827
00:28:36,260 --> 00:28:40,910
me<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of get</font><font color="#E5E5E5"> informed where I am now</font>

828
00:28:38,750 --> 00:28:44,450
I'll point out<font color="#E5E5E5"> the</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> that's the great</font>

829
00:28:40,910 --> 00:28:46,310
majority<font color="#E5E5E5"> over here</font><font color="#CCCCCC"> signed</font><font color="#E5E5E5"> binary process</font>

830
00:28:44,450 --> 00:28:49,610
execution<font color="#CCCCCC"> the concern that I have with</font>

831
00:28:46,310 --> 00:28:50,810
<font color="#CCCCCC">that</font><font color="#E5E5E5"> one is that</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> is it can be a</font>

832
00:28:49,610 --> 00:28:52,969
little<font color="#E5E5E5"> while the vague side at the</font>

833
00:28:50,810 --> 00:28:54,980
moment<font color="#CCCCCC"> the</font><font color="#E5E5E5"> way it's written so much like</font>

834
00:28:52,970 --> 00:28:56,750
any<font color="#CCCCCC"> other environment use these tools</font><font color="#E5E5E5"> as</font>

835
00:28:54,980 --> 00:28:57,560
a starting point<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> use them as an</font>

836
00:28:56,750 --> 00:28:59,000
<font color="#CCCCCC">endpoint</font>

837
00:28:57,560 --> 00:29:02,090
use them to<font color="#CCCCCC"> go ahead and tweak and</font>

838
00:28:59,000 --> 00:29:05,060
modify<font color="#E5E5E5"> I could also go ahead</font><font color="#CCCCCC"> and use</font>

839
00:29:02,090 --> 00:29:06,620
this<font color="#E5E5E5"> and</font><font color="#CCCCCC"> apply it to correlation</font>

840
00:29:05,060 --> 00:29:08,510
searches so if you're running a<font color="#E5E5E5"> sim I</font>

841
00:29:06,620 --> 00:29:10,070
could go ahead<font color="#CCCCCC"> and take these kinds of</font>

842
00:29:08,510 --> 00:29:11,090
<font color="#E5E5E5">things boil them into my sim again from</font>

843
00:29:10,070 --> 00:29:12,889
an operational<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the station</font>

844
00:29:11,090 --> 00:29:14,449
perspective that might go ahead<font color="#CCCCCC"> and help</font>

845
00:29:12,890 --> 00:29:15,740
me inform my threat hunting and give me

846
00:29:14,450 --> 00:29:21,260
<font color="#CCCCCC">guidance as to where I need to</font><font color="#E5E5E5"> pivot</font>

847
00:29:15,740 --> 00:29:22,900
<font color="#E5E5E5">back to where are the gaps again going</font>

848
00:29:21,260 --> 00:29:25,100
<font color="#CCCCCC">back that navigator if you guys recall</font>

849
00:29:22,900 --> 00:29:27,980
<font color="#CCCCCC">there's a nice big gap right in the</font>

850
00:29:25,100 --> 00:29:29,330
<font color="#E5E5E5">middle around credential access</font><font color="#CCCCCC"> I didn't</font>

851
00:29:27,980 --> 00:29:31,700
have a single hunt around credential

852
00:29:29,330 --> 00:29:33,290
access that came back with any hits<font color="#E5E5E5"> does</font>

853
00:29:31,700 --> 00:29:35,360
that mean and this goes back<font color="#E5E5E5"> to the gap</font>

854
00:29:33,290 --> 00:29:36,860
piece of this does this<font color="#E5E5E5"> mean I am</font><font color="#CCCCCC"> NOT</font>

855
00:29:35,360 --> 00:29:39,469
collecting data<font color="#E5E5E5"> that informs me about</font>

856
00:29:36,860 --> 00:29:42,139
that<font color="#E5E5E5"> or does</font><font color="#CCCCCC"> that mean</font><font color="#E5E5E5"> that I</font><font color="#CCCCCC"> need to go</font>

857
00:29:39,470 --> 00:29:44,150
ahead<font color="#E5E5E5"> and do additional hunts so you can</font>

858
00:29:42,140 --> 00:29:46,100
use<font color="#E5E5E5"> these techniques enumerate the</font>

859
00:29:44,150 --> 00:29:47,990
techniques<font color="#E5E5E5"> that you've used look at them</font>

860
00:29:46,100 --> 00:29:49,490
as to how<font color="#CCCCCC"> they bear fruit and then use</font>

861
00:29:47,990 --> 00:29:50,720
this<font color="#CCCCCC"> to also to</font><font color="#E5E5E5"> figure out maybe where</font>

862
00:29:49,490 --> 00:29:52,280
my gaps are to be able<font color="#E5E5E5"> to start</font>

863
00:29:50,720 --> 00:29:54,190
collecting more data<font color="#E5E5E5"> or to do more</font>

864
00:29:52,280 --> 00:29:56,180
threat hunting in those areas<font color="#CCCCCC"> to kind of</font>

865
00:29:54,190 --> 00:29:59,210
understand better what's going<font color="#E5E5E5"> on out</font>

866
00:29:56,180 --> 00:30:01,100
there so to kind of start<font color="#E5E5E5"> pulling this</font>

867
00:29:59,210 --> 00:30:03,140
all together<font color="#CCCCCC"> we've done a lot</font><font color="#E5E5E5"> of work</font>

868
00:30:01,100 --> 00:30:04,250
<font color="#E5E5E5">around</font><font color="#CCCCCC"> hunting</font><font color="#E5E5E5"> I've we've got a blog</font>

869
00:30:03,140 --> 00:30:06,310
series<font color="#CCCCCC"> out there you're more than</font>

870
00:30:04,250 --> 00:30:08,720
welcome to<font color="#CCCCCC"> check out I posted my slides</font>

871
00:30:06,310 --> 00:30:10,700
<font color="#E5E5E5">out there so you should be able to have</font>

872
00:30:08,720 --> 00:30:13,160
access<font color="#CCCCCC"> to the links</font><font color="#E5E5E5"> we actually have</font>

873
00:30:10,700 --> 00:30:15,440
some curated<font color="#CCCCCC"> datasets that are out there</font>

874
00:30:13,160 --> 00:30:17,840
<font color="#CCCCCC">currently there's a</font><font color="#E5E5E5"> one set that you can</font>

875
00:30:15,440 --> 00:30:18,920
go<font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> and spin</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> in a environment</font>

876
00:30:17,840 --> 00:30:20,090
and just<font color="#E5E5E5"> play</font><font color="#CCCCCC"> with yourself you can</font>

877
00:30:18,920 --> 00:30:22,040
download the data<font color="#E5E5E5"> because we've open</font>

878
00:30:20,090 --> 00:30:23,330
sourced<font color="#E5E5E5"> it as well and the powershell</font>

879
00:30:22,040 --> 00:30:24,560
version that we've got<font color="#E5E5E5"> of the data sets</font>

880
00:30:23,330 --> 00:30:25,970
will<font color="#E5E5E5"> be coming out a little bit later in</font>

881
00:30:24,560 --> 00:30:27,830
march so<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of keep an eye on my</font>

882
00:30:25,970 --> 00:30:30,070
<font color="#E5E5E5">twitter feed and a couple other places</font>

883
00:30:27,830 --> 00:30:33,169
and<font color="#E5E5E5"> you'll be seeing more about that</font>

884
00:30:30,070 --> 00:30:35,990
also<font color="#CCCCCC"> from a miter</font><font color="#E5E5E5"> attack perspective go</font>

885
00:30:33,170 --> 00:30:37,990
out both a medium and on the<font color="#CCCCCC"> mitre site</font>

886
00:30:35,990 --> 00:30:41,210
itself<font color="#E5E5E5"> they</font><font color="#CCCCCC"> have an excellent</font><font color="#E5E5E5"> set</font><font color="#CCCCCC"> of</font>

887
00:30:37,990 --> 00:30:43,610
written write-ups around it<font color="#E5E5E5"> and</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> just</font>

888
00:30:41,210 --> 00:30:46,070
<font color="#CCCCCC">recently did</font><font color="#E5E5E5"> a blog series around using</font>

889
00:30:43,610 --> 00:30:47,899
<font color="#CCCCCC">miter</font><font color="#E5E5E5"> a from an introductory perspective</font>

890
00:30:46,070 --> 00:30:49,220
<font color="#E5E5E5">second from a throw hunting perspective</font>

891
00:30:47,900 --> 00:30:51,700
with some more<font color="#E5E5E5"> examples that</font><font color="#CCCCCC"> i didn't</font>

892
00:30:49,220 --> 00:30:55,460
have<font color="#E5E5E5"> time to show today as well as</font>

893
00:30:51,700 --> 00:31:01,100
operationalizing your attack framework

894
00:30:55,460 --> 00:31:03,080
as well and with that that's me<font color="#CCCCCC"> that's</font>

895
00:31:01,100 --> 00:31:04,820
<font color="#CCCCCC">my</font><font color="#E5E5E5"> twitter handle</font><font color="#CCCCCC"> I was not able</font><font color="#E5E5E5"> to work</font>

896
00:31:03,080 --> 00:31:06,230
a few<font color="#E5E5E5"> of those references into this so</font>

897
00:31:04,820 --> 00:31:08,629
those are my other favorite movies from

898
00:31:06,230 --> 00:31:10,910
<font color="#CCCCCC">the</font><font color="#E5E5E5"> 80s</font><font color="#CCCCCC"> I'd like to thank you guys for</font>

899
00:31:08,630 --> 00:31:11,270
<font color="#CCCCCC">your time thank you besides for having</font>

900
00:31:10,910 --> 00:31:12,620
me<font color="#CCCCCC"> out</font>

901
00:31:11,270 --> 00:31:14,080
here and<font color="#E5E5E5"> I hope you enjoy the rest of</font>

902
00:31:12,620 --> 00:31:21,260
<font color="#E5E5E5">the conference</font>

903
00:31:14,080 --> 00:31:21,260
[Applause]

