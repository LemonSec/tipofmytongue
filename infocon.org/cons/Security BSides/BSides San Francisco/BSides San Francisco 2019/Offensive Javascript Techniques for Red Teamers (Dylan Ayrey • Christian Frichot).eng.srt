1
00:00:00,110 --> 00:00:07,919
offensive JavaScript techniques for<font color="#E5E5E5"> red</font>

2
00:00:02,460 --> 00:00:10,139
teamers or anyone<font color="#E5E5E5"> really awesome</font>

3
00:00:07,919 --> 00:00:12,860
everyone everyone<font color="#E5E5E5"> hey me with my funny</font>

4
00:00:10,139 --> 00:00:15,059
<font color="#E5E5E5">rock-and-roll microphone</font><font color="#CCCCCC"> tes tes oh cool</font>

5
00:00:12,860 --> 00:00:16,619
awesome we've got a lot of material to

6
00:00:15,059 --> 00:00:18,538
<font color="#CCCCCC">get through in a pretty short time so</font>

7
00:00:16,619 --> 00:00:20,100
we're<font color="#E5E5E5"> gonna get to it thank you everyone</font>

8
00:00:18,539 --> 00:00:22,320
for attending<font color="#CCCCCC"> we're gonna be talking</font>

9
00:00:20,100 --> 00:00:24,060
about offensive<font color="#E5E5E5"> JavaScript and how we</font>

10
00:00:22,320 --> 00:00:26,160
think<font color="#CCCCCC"> it should be</font><font color="#E5E5E5"> used more by</font>

11
00:00:24,060 --> 00:00:31,049
offensive red teamers and bug bounty

12
00:00:26,160 --> 00:00:33,120
hunters<font color="#CCCCCC"> so my name is</font><font color="#E5E5E5"> Christian I've</font>

13
00:00:31,050 --> 00:00:35,520
contributed<font color="#E5E5E5"> to the browser exploitation</font>

14
00:00:33,120 --> 00:00:38,519
framework also<font color="#CCCCCC"> known as beef I've</font>

15
00:00:35,520 --> 00:00:40,110
co-authored a book on bad<font color="#E5E5E5"> JavaScript and</font>

16
00:00:38,520 --> 00:00:43,829
presented it a couple<font color="#E5E5E5"> of different</font>

17
00:00:40,110 --> 00:00:46,469
<font color="#CCCCCC">conferences my name is</font><font color="#E5E5E5"> Dylan I had the</font>

18
00:00:43,829 --> 00:00:47,820
<font color="#CCCCCC">opportunity</font><font color="#E5E5E5"> to speak here last year but</font>

19
00:00:46,469 --> 00:00:49,890
an<font color="#E5E5E5"> open source tool</font><font color="#CCCCCC"> that I wrote called</font>

20
00:00:47,820 --> 00:00:51,469
truffle hog I've also spoken a number of

21
00:00:49,890 --> 00:00:55,379
different security conferences including

22
00:00:51,469 --> 00:00:57,449
<font color="#E5E5E5">torque on DEFCON</font><font color="#CCCCCC"> and besides on a number</font>

23
00:00:55,379 --> 00:00:58,800
<font color="#CCCCCC">of</font><font color="#E5E5E5"> different apps activist</font><font color="#CCCCCC"> MK</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> confer</font>

24
00:00:57,449 --> 00:01:00,108
all the New Zealanders in<font color="#E5E5E5"> the audience</font>

25
00:00:58,800 --> 00:01:07,560
which we know<font color="#E5E5E5"> there's</font><font color="#CCCCCC"> probably at least</font>

26
00:01:00,109 --> 00:01:12,299
two of you yeah<font color="#CCCCCC"> so the focus of our talk</font>

27
00:01:07,560 --> 00:01:16,650
is going<font color="#E5E5E5"> to be on a one-legged unicorn</font>

28
00:01:12,299 --> 00:01:17,850
balancing on a beach ball<font color="#CCCCCC"> Wow isn't</font>

29
00:01:16,650 --> 00:01:19,619
<font color="#CCCCCC">listening you</font><font color="#E5E5E5"> gotta say it again all</font>

30
00:01:17,850 --> 00:01:22,559
<font color="#CCCCCC">right</font><font color="#E5E5E5"> hang on</font><font color="#CCCCCC"> so it's a one-legged</font>

31
00:01:19,619 --> 00:01:27,310
unicorn<font color="#E5E5E5"> balancing on a beach ball while</font>

32
00:01:22,560 --> 00:01:31,010
juggling pogo sticks<font color="#E5E5E5"> and three tentacles</font>

33
00:01:27,310 --> 00:01:31,010
[Laughter]

34
00:01:35,360 --> 00:01:45,180
<font color="#CCCCCC">so we'll wait we're also going to be</font>

35
00:01:41,759 --> 00:01:47,210
covering<font color="#E5E5E5"> some new JavaScript features</font>

36
00:01:45,180 --> 00:01:49,079
that make<font color="#CCCCCC"> it a lot easier to do</font>

37
00:01:47,210 --> 00:01:50,490
<font color="#E5E5E5">exploiting things and we're going</font><font color="#CCCCCC"> to be</font>

38
00:01:49,079 --> 00:01:52,829
<font color="#E5E5E5">looking at</font><font color="#CCCCCC"> different ways that</font><font color="#E5E5E5"> we can</font>

39
00:01:50,490 --> 00:01:55,530
<font color="#E5E5E5">combine together Red Team techniques to</font>

40
00:01:52,829 --> 00:01:56,939
use these<font color="#CCCCCC"> JavaScript features</font><font color="#E5E5E5"> to attack</font>

41
00:01:55,530 --> 00:01:59,549
internal networks and the couple<font color="#E5E5E5"> of</font>

42
00:01:56,939 --> 00:02:03,508
those<font color="#E5E5E5"> include the fetch API WebRTC</font>

43
00:01:59,549 --> 00:02:05,430
service workers<font color="#CCCCCC"> and many</font><font color="#E5E5E5"> more sure</font><font color="#CCCCCC"> and</font>

44
00:02:03,509 --> 00:02:07,409
one<font color="#E5E5E5"> of the core themes that we'll talk</font>

45
00:02:05,430 --> 00:02:09,360
<font color="#E5E5E5">about is this</font><font color="#CCCCCC"> idea in the context</font><font color="#E5E5E5"> of web</font>

46
00:02:07,409 --> 00:02:12,629
browsers that<font color="#E5E5E5"> actions can</font><font color="#CCCCCC"> be performed</font>

47
00:02:09,360 --> 00:02:13,560
cross-origin despite one of the primary

48
00:02:12,629 --> 00:02:15,450
<font color="#CCCCCC">browser control</font>

49
00:02:13,560 --> 00:02:17,310
<font color="#CCCCCC">Genesis which is the same origin policy</font>

50
00:02:15,450 --> 00:02:18,420
<font color="#E5E5E5">and for those that maybe don't have too</font>

51
00:02:17,310 --> 00:02:20,190
much<font color="#E5E5E5"> experience with that we'll talk</font>

52
00:02:18,420 --> 00:02:24,390
<font color="#CCCCCC">about these a</font><font color="#E5E5E5"> little bit</font><font color="#CCCCCC"> more later on</font>

53
00:02:20,190 --> 00:02:25,260
as well<font color="#CCCCCC"> so like</font><font color="#E5E5E5"> I mentioned</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> a lot</font>

54
00:02:24,390 --> 00:02:28,619
<font color="#CCCCCC">of what we're gonna</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> talking about</font>

55
00:02:25,260 --> 00:02:29,790
<font color="#E5E5E5">isn't very novel</font><font color="#CCCCCC"> 2ab SEC teams and a lot</font>

56
00:02:28,620 --> 00:02:31,860
<font color="#E5E5E5">of what we're gonna be</font><font color="#CCCCCC"> talking about</font><font color="#E5E5E5"> is</font>

57
00:02:29,790 --> 00:02:33,540
it very novel<font color="#E5E5E5"> to read teams but we</font>

58
00:02:31,860 --> 00:02:35,790
<font color="#E5E5E5">believe the way that</font><font color="#CCCCCC"> we were</font><font color="#E5E5E5"> combining</font>

59
00:02:33,540 --> 00:02:38,670
the two concepts<font color="#E5E5E5"> is kind of unique</font><font color="#CCCCCC"> and</font>

60
00:02:35,790 --> 00:02:40,790
special<font color="#E5E5E5"> and valuable</font><font color="#CCCCCC"> to both parties</font><font color="#E5E5E5"> and</font>

61
00:02:38,670 --> 00:02:42,988
so there's<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> a little bit of</font>

62
00:02:40,790 --> 00:02:45,920
probably dry stuff but hopefully the

63
00:02:42,989 --> 00:02:48,600
overlaps where things get interesting

64
00:02:45,920 --> 00:02:51,059
<font color="#CCCCCC">so if we rewind</font><font color="#E5E5E5"> the clock back a little</font>

65
00:02:48,600 --> 00:02:54,030
<font color="#E5E5E5">bit to the</font><font color="#CCCCCC"> mid 2000s</font><font color="#E5E5E5"> it wasn't too</font>

66
00:02:51,060 --> 00:02:55,650
difficult<font color="#CCCCCC"> to find</font><font color="#E5E5E5"> a single critical</font>

67
00:02:54,030 --> 00:02:57,810
security vulnerability that could

68
00:02:55,650 --> 00:02:59,610
completely<font color="#CCCCCC"> compromise a company</font><font color="#E5E5E5"> you</font>

69
00:02:57,810 --> 00:03:01,410
<font color="#E5E5E5">could get a sequel injection or code</font>

70
00:02:59,610 --> 00:03:03,780
execution<font color="#E5E5E5"> that could allow you to</font>

71
00:03:01,410 --> 00:03:06,720
<font color="#E5E5E5">completely dump a production database</font>

72
00:03:03,780 --> 00:03:08,730
and<font color="#CCCCCC"> just fully</font><font color="#E5E5E5"> own an entire company at</font>

73
00:03:06,720 --> 00:03:11,940
the<font color="#E5E5E5"> time</font><font color="#CCCCCC"> at attack against</font><font color="#E5E5E5"> the client</font>

74
00:03:08,730 --> 00:03:14,069
<font color="#E5E5E5">may</font><font color="#CCCCCC"> not be that interesting because if</font>

75
00:03:11,940 --> 00:03:16,519
there's systemic problems that allow you

76
00:03:14,069 --> 00:03:18,810
to totally<font color="#E5E5E5"> dump a production database</font>

77
00:03:16,519 --> 00:03:22,670
<font color="#CCCCCC">who cares if you can attack a one</font>

78
00:03:18,810 --> 00:03:24,870
individual client<font color="#CCCCCC"> so things obviously</font>

79
00:03:22,670 --> 00:03:28,649
<font color="#E5E5E5">evolved and got more complicated over</font>

80
00:03:24,870 --> 00:03:31,829
time<font color="#E5E5E5"> red teams started extensively using</font>

81
00:03:28,650 --> 00:03:34,380
malware frameworks<font color="#E5E5E5"> to compile libraries</font>

82
00:03:31,829 --> 00:03:36,390
of exploits<font color="#E5E5E5"> and move laterally through</font>

83
00:03:34,380 --> 00:03:39,570
environments to<font color="#E5E5E5"> change many different</font>

84
00:03:36,390 --> 00:03:42,328
vulnerabilities together<font color="#E5E5E5"> and the</font>

85
00:03:39,570 --> 00:03:44,519
<font color="#E5E5E5">thinking there</font><font color="#CCCCCC"> is that these red teams</font>

86
00:03:42,329 --> 00:03:46,410
can use<font color="#CCCCCC"> these malware frameworks to</font><font color="#E5E5E5"> move</font>

87
00:03:44,519 --> 00:03:47,790
through an environment<font color="#E5E5E5"> stay in</font>

88
00:03:46,410 --> 00:03:49,590
environment for a long<font color="#E5E5E5"> period of time</font>

89
00:03:47,790 --> 00:03:51,780
and<font color="#E5E5E5"> eventually again get access to that</font>

90
00:03:49,590 --> 00:03:54,030
full<font color="#E5E5E5"> production database</font><font color="#CCCCCC"> so again we're</font>

91
00:03:51,780 --> 00:03:56,400
back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the same like client attacks</font>

92
00:03:54,030 --> 00:03:58,410
<font color="#E5E5E5">don't really seem super interesting</font>

93
00:03:56,400 --> 00:04:00,390
because with these malware frameworks

94
00:03:58,410 --> 00:04:05,940
it's still relatively easy to just

95
00:04:00,390 --> 00:04:10,048
completely dump production database so

96
00:04:05,940 --> 00:04:11,970
let's talk about<font color="#E5E5E5"> this status quo a lot</font>

97
00:04:10,049 --> 00:04:14,070
<font color="#E5E5E5">of organizations suffer from this</font>

98
00:04:11,970 --> 00:04:17,130
<font color="#CCCCCC">fallacy that</font><font color="#E5E5E5"> we have called the lobster</font>

99
00:04:14,070 --> 00:04:19,890
security fallacy<font color="#E5E5E5"> obviously really really</font>

100
00:04:17,130 --> 00:04:22,430
<font color="#E5E5E5">hard on the</font><font color="#CCCCCC"> outside and soft and</font>

101
00:04:19,890 --> 00:04:25,289
delicious<font color="#CCCCCC"> PTSD on the inside and</font>

102
00:04:22,430 --> 00:04:27,870
<font color="#E5E5E5">obviously completely secure</font>

103
00:04:25,290 --> 00:04:28,980
as everyone who has done a security

104
00:04:27,870 --> 00:04:34,650
assessment<font color="#CCCCCC"> from outside of mobilization</font>

105
00:04:28,980 --> 00:04:36,150
noise<font color="#CCCCCC"> so a big</font><font color="#E5E5E5"> part of this game</font><font color="#CCCCCC"> that we</font>

106
00:04:34,650 --> 00:04:38,940
mentioned<font color="#CCCCCC"> with the</font><font color="#E5E5E5"> malware frameworks is</font>

107
00:04:36,150 --> 00:04:40,500
getting that<font color="#E5E5E5"> first foothold</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> if we</font>

108
00:04:38,940 --> 00:04:42,630
look through<font color="#E5E5E5"> something like the Verizon</font>

109
00:04:40,500 --> 00:04:45,090
breach report<font color="#E5E5E5"> on how this usually</font>

110
00:04:42,630 --> 00:04:48,060
happens<font color="#E5E5E5"> the really easy common ways are</font>

111
00:04:45,090 --> 00:04:51,419
through<font color="#E5E5E5"> either stolen credentials in a</font>

112
00:04:48,060 --> 00:04:52,920
<font color="#E5E5E5">in a data breach or</font><font color="#CCCCCC"> guest credentials or</font>

113
00:04:51,420 --> 00:04:55,380
some form of social<font color="#CCCCCC"> engineering like</font>

114
00:04:52,920 --> 00:04:56,760
fishing<font color="#CCCCCC"> and then once you</font><font color="#E5E5E5"> get that</font>

115
00:04:55,380 --> 00:04:58,740
initial<font color="#E5E5E5"> first foothold into</font><font color="#CCCCCC"> an</font>

116
00:04:56,760 --> 00:05:00,000
environment<font color="#CCCCCC"> like I mentioned you use</font>

117
00:04:58,740 --> 00:05:01,830
your malware framework to stick around

118
00:05:00,000 --> 00:05:03,900
for<font color="#CCCCCC"> a while and move from machine to</font>

119
00:05:01,830 --> 00:05:06,150
machine<font color="#E5E5E5"> leveraging more and more</font>

120
00:05:03,900 --> 00:05:07,739
vulnerabilities collecting machines like

121
00:05:06,150 --> 00:05:10,260
<font color="#E5E5E5">you would pokemon cards until</font><font color="#CCCCCC"> eventually</font>

122
00:05:07,740 --> 00:05:11,430
<font color="#E5E5E5">you've traded up</font><font color="#CCCCCC"> to that one</font><font color="#E5E5E5"> that's</font>

123
00:05:10,260 --> 00:05:13,980
<font color="#E5E5E5">really interesting the production</font>

124
00:05:11,430 --> 00:05:16,230
<font color="#E5E5E5">database</font><font color="#CCCCCC"> and so to put</font><font color="#E5E5E5"> things into</font>

125
00:05:13,980 --> 00:05:18,840
perspective again if it's<font color="#E5E5E5"> relatively</font>

126
00:05:16,230 --> 00:05:22,260
easy<font color="#E5E5E5"> to</font><font color="#CCCCCC"> get the production database</font>

127
00:05:18,840 --> 00:05:25,619
<font color="#CCCCCC">it seems pretty boring</font><font color="#E5E5E5"> to use a client</font>

128
00:05:22,260 --> 00:05:28,260
<font color="#E5E5E5">attack like</font><font color="#CCCCCC"> CSRF to attack an individual</font>

129
00:05:25,620 --> 00:05:29,960
<font color="#CCCCCC">client and get one</font><font color="#E5E5E5"> users data when you</font>

130
00:05:28,260 --> 00:05:32,130
could<font color="#CCCCCC"> just get every users data</font>

131
00:05:29,960 --> 00:05:34,260
<font color="#CCCCCC">now obviously</font><font color="#E5E5E5"> someone who spent a lot of</font>

132
00:05:32,130 --> 00:05:36,390
time writing and contributing<font color="#CCCCCC"> to a</font>

133
00:05:34,260 --> 00:05:38,400
browser<font color="#E5E5E5"> exploitation framework which is</font>

134
00:05:36,390 --> 00:05:41,120
meant to<font color="#E5E5E5"> do</font><font color="#CCCCCC"> exactly what you have said</font>

135
00:05:38,400 --> 00:05:43,799
is boring<font color="#E5E5E5"> I feel personally attacked</font>

136
00:05:41,120 --> 00:05:45,180
I'll keep an open mind<font color="#CCCCCC"> why</font><font color="#E5E5E5"> don't you</font>

137
00:05:43,800 --> 00:05:47,640
tell me<font color="#E5E5E5"> more</font><font color="#CCCCCC"> about that</font>

138
00:05:45,180 --> 00:05:50,550
<font color="#CCCCCC">sha sha</font><font color="#E5E5E5"> so it hands up if you've heard</font>

139
00:05:47,640 --> 00:05:53,789
of beef<font color="#E5E5E5"> right hands up if you've used</font>

140
00:05:50,550 --> 00:05:57,840
beef as part<font color="#E5E5E5"> of like an official</font><font color="#CCCCCC"> Red</font>

141
00:05:53,790 --> 00:06:00,450
<font color="#CCCCCC">Team engagement still a few hands</font><font color="#E5E5E5"> so I</font>

142
00:05:57,840 --> 00:06:03,479
<font color="#CCCCCC">every one of those</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> are beer self</font>

143
00:06:00,450 --> 00:06:04,979
<font color="#E5E5E5">not easy</font><font color="#CCCCCC"> um thank you</font><font color="#E5E5E5"> obviously the idea</font>

144
00:06:03,480 --> 00:06:07,010
was beef<font color="#CCCCCC"> turned kind of JavaScript</font>

145
00:06:04,980 --> 00:06:09,480
client attacks on their head and

146
00:06:07,010 --> 00:06:12,000
<font color="#E5E5E5">wrapping back to the Verizon data breach</font>

147
00:06:09,480 --> 00:06:13,350
investigation report<font color="#CCCCCC"> you know in</font>

148
00:06:12,000 --> 00:06:15,390
<font color="#CCCCCC">Dillon's circumstance where you were try</font>

149
00:06:13,350 --> 00:06:16,740
and deliver malware<font color="#CCCCCC"> 12 percent would</font>

150
00:06:15,390 --> 00:06:18,240
open an attachment<font color="#E5E5E5"> but a bigger</font>

151
00:06:16,740 --> 00:06:22,080
percentage of people<font color="#CCCCCC"> would click a link</font>

152
00:06:18,240 --> 00:06:24,480
<font color="#CCCCCC">and that's</font><font color="#E5E5E5"> an interesting point</font><font color="#CCCCCC"> and so</font>

153
00:06:22,080 --> 00:06:27,210
we<font color="#CCCCCC"> asked</font><font color="#E5E5E5"> ourselves how bad can clicking</font>

154
00:06:24,480 --> 00:06:29,280
just<font color="#E5E5E5"> a link bait so before we go any</font>

155
00:06:27,210 --> 00:06:32,070
further by show of hands<font color="#E5E5E5"> how many</font><font color="#CCCCCC"> people</font>

156
00:06:29,280 --> 00:06:34,650
have a live browser<font color="#E5E5E5"> exploit that can be</font>

157
00:06:32,070 --> 00:06:37,760
used to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> a remote</font><font color="#E5E5E5"> code execution</font><font color="#CCCCCC"> on a</font>

158
00:06:34,650 --> 00:06:37,760
person<font color="#E5E5E5"> that clicks a link</font>

159
00:06:40,560 --> 00:06:46,480
by all means<font color="#CCCCCC"> I'd be curious</font><font color="#E5E5E5"> to hear</font><font color="#CCCCCC"> from</font>

160
00:06:43,690 --> 00:06:48,940
that<font color="#E5E5E5"> half hand after but the reality</font><font color="#CCCCCC"> is</font>

161
00:06:46,480 --> 00:06:51,340
these<font color="#E5E5E5"> types of exploits are becoming</font>

162
00:06:48,940 --> 00:06:53,700
<font color="#CCCCCC">increasingly more</font><font color="#E5E5E5"> difficult</font><font color="#CCCCCC"> browsers</font>

163
00:06:51,340 --> 00:06:56,109
have different containers and different

164
00:06:53,700 --> 00:06:57,490
<font color="#E5E5E5">security features these days that make</font>

165
00:06:56,110 --> 00:06:59,260
it so that<font color="#E5E5E5"> even if you have one type of</font>

166
00:06:57,490 --> 00:07:01,930
<font color="#E5E5E5">vulnerability</font><font color="#CCCCCC"> you probably don't have</font>

167
00:06:59,260 --> 00:07:03,550
the<font color="#CCCCCC"> whole farm</font><font color="#E5E5E5"> flashes going</font><font color="#CCCCCC"> away it's</font>

168
00:07:01,930 --> 00:07:05,980
been<font color="#CCCCCC"> end-of-life tanned</font><font color="#E5E5E5"> it's disabled by</font>

169
00:07:03,550 --> 00:07:07,960
default<font color="#CCCCCC"> in</font><font color="#E5E5E5"> a lot of major browsers</font><font color="#CCCCCC"> these</font>

170
00:07:05,980 --> 00:07:10,000
types<font color="#E5E5E5"> of</font><font color="#CCCCCC"> attacks</font><font color="#E5E5E5"> to get remote code</font>

171
00:07:07,960 --> 00:07:12,390
execution<font color="#E5E5E5"> from clicking a single link</font>

172
00:07:10,000 --> 00:07:14,590
<font color="#E5E5E5">not really a good option</font><font color="#CCCCCC"> anymore</font>

173
00:07:12,390 --> 00:07:16,390
and one of<font color="#E5E5E5"> the things that I really like</font>

174
00:07:14,590 --> 00:07:18,400
to<font color="#CCCCCC"> talk about is this</font><font color="#E5E5E5"> concept with that</font>

175
00:07:16,390 --> 00:07:20,490
the modern-day operating system is in

176
00:07:18,400 --> 00:07:23,080
<font color="#CCCCCC">frack you know it's the browser engine</font>

177
00:07:20,490 --> 00:07:25,210
<font color="#CCCCCC">chances</font><font color="#E5E5E5"> are you</font><font color="#CCCCCC"> have a</font><font color="#E5E5E5"> smartphone and</font>

178
00:07:23,080 --> 00:07:27,729
it's running<font color="#E5E5E5"> a browser probably with a</font>

179
00:07:25,210 --> 00:07:29,739
bunch of tabs also chances are if you

180
00:07:27,730 --> 00:07:33,190
open<font color="#E5E5E5"> your laptop</font><font color="#CCCCCC"> it's got a couple</font><font color="#E5E5E5"> of</font>

181
00:07:29,740 --> 00:07:35,080
<font color="#E5E5E5">windows and I know we have a previous</font>

182
00:07:33,190 --> 00:07:36,880
hiring manager of ours who used to have

183
00:07:35,080 --> 00:07:38,229
thousands<font color="#E5E5E5"> and thousands of tabs and I'm</font>

184
00:07:36,880 --> 00:07:40,080
<font color="#E5E5E5">pretty sure he</font><font color="#CCCCCC"> doesn't know what was on</font>

185
00:07:38,230 --> 00:07:43,930
every<font color="#CCCCCC"> single one of those tabs Angelou</font>

186
00:07:40,080 --> 00:07:45,789
<font color="#E5E5E5">and so you know the reality is</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> this</font>

187
00:07:43,930 --> 00:07:48,130
is a really interesting attack surface

188
00:07:45,790 --> 00:07:50,710
<font color="#E5E5E5">like a browser is a piece of</font><font color="#CCCCCC"> software</font>

189
00:07:48,130 --> 00:07:53,710
<font color="#CCCCCC">that roams around and it simultaneously</font>

190
00:07:50,710 --> 00:07:55,650
connects<font color="#E5E5E5"> to the internet it can</font><font color="#CCCCCC"> talk to</font>

191
00:07:53,710 --> 00:07:58,479
the local local<font color="#CCCCCC"> loopback</font><font color="#E5E5E5"> on your machine</font>

192
00:07:55,650 --> 00:08:00,669
<font color="#E5E5E5">it potentially is able to access things</font>

193
00:07:58,480 --> 00:08:03,610
over a VPN<font color="#E5E5E5"> and it goes from local</font>

194
00:08:00,670 --> 00:08:05,170
network<font color="#CCCCCC"> to local network so it's very</font>

195
00:08:03,610 --> 00:08:06,820
<font color="#E5E5E5">very interesting</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so kind of coming</font>

196
00:08:05,170 --> 00:08:09,520
back<font color="#CCCCCC"> to this question</font><font color="#E5E5E5"> how bad can</font>

197
00:08:06,820 --> 00:08:10,570
clicking a link be we<font color="#E5E5E5"> think it's pretty</font>

198
00:08:09,520 --> 00:08:12,940
<font color="#E5E5E5">bad we're going to try to free in the</font>

199
00:08:10,570 --> 00:08:14,110
case<font color="#CCCCCC"> to be sure one of the one of</font><font color="#E5E5E5"> the</font>

200
00:08:12,940 --> 00:08:15,310
common patterns that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> would see from</font>

201
00:08:14,110 --> 00:08:17,050
<font color="#CCCCCC">using something like</font><font color="#E5E5E5"> the browser</font>

202
00:08:15,310 --> 00:08:19,210
exploitation is something<font color="#E5E5E5"> similar to</font>

203
00:08:17,050 --> 00:08:20,740
this<font color="#CCCCCC"> a user clicks a link</font><font color="#E5E5E5"> a bad website</font>

204
00:08:19,210 --> 00:08:23,469
<font color="#E5E5E5">with bad malicious you know with</font>

205
00:08:20,740 --> 00:08:25,540
malicious JavaScript can get the

206
00:08:23,470 --> 00:08:26,980
person's<font color="#E5E5E5"> internal IP address using</font>

207
00:08:25,540 --> 00:08:29,110
<font color="#CCCCCC">technologies</font><font color="#E5E5E5"> such as web</font><font color="#CCCCCC"> real-time</font>

208
00:08:26,980 --> 00:08:30,970
communications and then using that

209
00:08:29,110 --> 00:08:33,430
<font color="#E5E5E5">information it can perform a network</font>

210
00:08:30,970 --> 00:08:35,500
sweep to find available hosts<font color="#E5E5E5"> near that</font>

211
00:08:33,429 --> 00:08:37,390
computer<font color="#E5E5E5"> and then using</font><font color="#CCCCCC"> that can</font>

212
00:08:35,500 --> 00:08:39,130
<font color="#CCCCCC">actually find open ports</font><font color="#E5E5E5"> with some</font>

213
00:08:37,390 --> 00:08:42,610
<font color="#E5E5E5">limitations against those servers as</font>

214
00:08:39,130 --> 00:08:44,730
<font color="#CCCCCC">well the beef has a number</font><font color="#E5E5E5"> of modules</font>

215
00:08:42,610 --> 00:08:47,620
<font color="#E5E5E5">that can help with these phases from</font>

216
00:08:44,730 --> 00:08:50,640
<font color="#E5E5E5">using WebRTC and during the port</font>

217
00:08:47,620 --> 00:08:52,440
scanning and this picture here<font color="#E5E5E5"> is</font>

218
00:08:50,640 --> 00:08:54,420
actually it's a feature inside<font color="#E5E5E5"> of the</font>

219
00:08:52,440 --> 00:08:55,770
product<font color="#CCCCCC"> where after you</font><font color="#E5E5E5"> run these</font>

220
00:08:54,420 --> 00:08:57,900
modules it'll give you a little<font color="#CCCCCC"> diagram</font>

221
00:08:55,770 --> 00:09:00,300
which is kind of really<font color="#E5E5E5"> useful</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font>

222
00:08:57,900 --> 00:09:03,209
<font color="#E5E5E5">so it sounds like you're kind of framing</font>

223
00:09:00,300 --> 00:09:04,920
the<font color="#CCCCCC"> case for how some of</font><font color="#E5E5E5"> these what are</font>

224
00:09:03,210 --> 00:09:06,990
<font color="#E5E5E5">usually</font><font color="#CCCCCC"> seen as</font><font color="#E5E5E5"> client attacks you're</font>

225
00:09:04,920 --> 00:09:09,000
using<font color="#E5E5E5"> beef to actually use them to</font>

226
00:09:06,990 --> 00:09:11,040
attack infrastructure exactly<font color="#E5E5E5"> so if a</font>

227
00:09:09,000 --> 00:09:12,570
client clicks a<font color="#CCCCCC"> link then you go through</font>

228
00:09:11,040 --> 00:09:14,579
that person's browser to attack some

229
00:09:12,570 --> 00:09:15,900
internal infrastructure<font color="#E5E5E5"> that sounds</font>

230
00:09:14,580 --> 00:09:18,030
pretty<font color="#E5E5E5"> interesting</font>

231
00:09:15,900 --> 00:09:19,500
but based on<font color="#CCCCCC"> my understandings of</font><font color="#E5E5E5"> the</font>

232
00:09:18,030 --> 00:09:20,970
limitations of browsers it sounds like

233
00:09:19,500 --> 00:09:23,400
there's still some challenges<font color="#CCCCCC"> here like</font>

234
00:09:20,970 --> 00:09:25,200
the<font color="#E5E5E5"> amount of time it might</font><font color="#CCCCCC"> take to do</font>

235
00:09:23,400 --> 00:09:26,310
timing attacks and stuff<font color="#E5E5E5"> like that and</font>

236
00:09:25,200 --> 00:09:30,870
maybe<font color="#E5E5E5"> something</font><font color="#CCCCCC"> same-origin policy</font>

237
00:09:26,310 --> 00:09:32,400
<font color="#E5E5E5">restrictions</font><font color="#CCCCCC"> it seems like you know in</font>

238
00:09:30,870 --> 00:09:33,560
theory<font color="#E5E5E5"> that's a good idea but maybe in</font>

239
00:09:32,400 --> 00:09:36,300
practice it<font color="#E5E5E5"> doesn't work out too well</font>

240
00:09:33,560 --> 00:09:38,160
<font color="#E5E5E5">sure and certainly a lot</font><font color="#CCCCCC"> of the logic</font><font color="#E5E5E5"> in</font>

241
00:09:36,300 --> 00:09:39,750
beef that does these you know recon

242
00:09:38,160 --> 00:09:41,430
modules against other networks is based

243
00:09:39,750 --> 00:09:43,350
on<font color="#E5E5E5"> trying to send a request to an IP</font>

244
00:09:41,430 --> 00:09:45,810
address<font color="#E5E5E5"> on an arbitral and waiting</font><font color="#CCCCCC"> for</font>

245
00:09:43,350 --> 00:09:47,310
<font color="#E5E5E5">things to fail it doesn't</font><font color="#CCCCCC"> matter whether</font>

246
00:09:45,810 --> 00:09:49,920
or<font color="#E5E5E5"> not the same origin</font><font color="#CCCCCC"> policy is going</font>

247
00:09:47,310 --> 00:09:51,329
<font color="#E5E5E5">to prevent any of that</font><font color="#CCCCCC"> talking about</font>

248
00:09:49,920 --> 00:09:52,500
<font color="#CCCCCC">this</font><font color="#E5E5E5"> though without actually discussing</font>

249
00:09:51,330 --> 00:09:53,730
the same origin<font color="#CCCCCC"> policy gets really</font>

250
00:09:52,500 --> 00:09:55,800
<font color="#CCCCCC">complicated so we have a couple of</font>

251
00:09:53,730 --> 00:09:58,110
<font color="#E5E5E5">slides on the SOP for those that haven't</font>

252
00:09:55,800 --> 00:10:00,689
spent time working<font color="#E5E5E5"> on this stuff and the</font>

253
00:09:58,110 --> 00:10:03,060
idea is that browsers<font color="#CCCCCC"> have this control</font>

254
00:10:00,690 --> 00:10:04,560
inside<font color="#E5E5E5"> of them</font><font color="#CCCCCC"> to isolate origins from</font>

255
00:10:03,060 --> 00:10:07,709
each other

256
00:10:04,560 --> 00:10:09,540
generally this is<font color="#E5E5E5"> kind of you know from</font>

257
00:10:07,710 --> 00:10:11,220
like a scheme<font color="#CCCCCC"> hostname</font><font color="#E5E5E5"> and port and</font>

258
00:10:09,540 --> 00:10:12,959
obviously some browsers have some

259
00:10:11,220 --> 00:10:14,340
nuances because Internet Explorer

260
00:10:12,960 --> 00:10:16,560
versions of Internet Explorer would do

261
00:10:14,340 --> 00:10:18,540
<font color="#CCCCCC">sop control slightly different but</font><font color="#E5E5E5"> the</font>

262
00:10:16,560 --> 00:10:20,520
<font color="#E5E5E5">idea is</font><font color="#CCCCCC"> that if you have</font><font color="#E5E5E5"> content running</font>

263
00:10:18,540 --> 00:10:22,589
in one origin such as Facebook it can't

264
00:10:20,520 --> 00:10:26,270
arbitrarily send Java scripts to an

265
00:10:22,590 --> 00:10:26,270
origin like Google and get<font color="#E5E5E5"> data back</font>

266
00:10:26,360 --> 00:10:30,870
technically it's broken down into<font color="#CCCCCC"> this</font>

267
00:10:28,470 --> 00:10:33,450
kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> two high level buckets simple</font>

268
00:10:30,870 --> 00:10:35,580
requests<font color="#E5E5E5"> are standard form requests or</font>

269
00:10:33,450 --> 00:10:36,750
get requests or other kind<font color="#E5E5E5"> of standard</font>

270
00:10:35,580 --> 00:10:39,150
web requests that<font color="#E5E5E5"> our browser may</font>

271
00:10:36,750 --> 00:10:40,710
initiate<font color="#E5E5E5"> across origin and then non</font>

272
00:10:39,150 --> 00:10:44,100
simple<font color="#E5E5E5"> requests so literally everything</font>

273
00:10:40,710 --> 00:10:45,180
else<font color="#E5E5E5"> so these are you know potentially</font>

274
00:10:44,100 --> 00:10:46,770
requests that<font color="#E5E5E5"> are generated from</font>

275
00:10:45,180 --> 00:10:49,349
JavaScript<font color="#E5E5E5"> for example although the</font>

276
00:10:46,770 --> 00:10:51,030
fetch API<font color="#E5E5E5"> can send simple requests as</font>

277
00:10:49,350 --> 00:10:53,520
<font color="#CCCCCC">well this is the bit that always seemed</font>

278
00:10:51,030 --> 00:10:56,160
crazy<font color="#E5E5E5"> to me</font><font color="#CCCCCC"> that if you send a post</font>

279
00:10:53,520 --> 00:10:59,430
request<font color="#E5E5E5"> to another origin even</font><font color="#CCCCCC"> on</font>

280
00:10:56,160 --> 00:11:01,350
<font color="#E5E5E5">another network that's allowed without</font>

281
00:10:59,430 --> 00:11:03,930
<font color="#E5E5E5">asking the</font><font color="#CCCCCC"> server's permission but if</font>

282
00:11:01,350 --> 00:11:04,540
you send a put request<font color="#E5E5E5"> arbitrarily you</font>

283
00:11:03,930 --> 00:11:06,250
have to ask

284
00:11:04,540 --> 00:11:08,140
<font color="#CCCCCC">servus permission ahead</font><font color="#E5E5E5"> of time sure and</font>

285
00:11:06,250 --> 00:11:10,240
that permission<font color="#E5E5E5"> chain looks like this</font>

286
00:11:08,140 --> 00:11:11,740
before<font color="#E5E5E5"> the client will send the request</font>

287
00:11:10,240 --> 00:11:13,780
<font color="#E5E5E5">that it wants to send it first of all</font>

288
00:11:11,740 --> 00:11:15,190
sends an options request<font color="#E5E5E5"> and it waits to</font>

289
00:11:13,780 --> 00:11:16,920
<font color="#E5E5E5">determine if that's</font><font color="#CCCCCC"> written you know</font>

290
00:11:15,190 --> 00:11:18,640
<font color="#E5E5E5">something that it's allowed to</font><font color="#CCCCCC"> do</font>

291
00:11:16,920 --> 00:11:20,800
unfortunately

292
00:11:18,640 --> 00:11:22,840
what the SOP doesn't prevent is this

293
00:11:20,800 --> 00:11:24,670
leaking of timing information<font color="#E5E5E5"> because if</font>

294
00:11:22,840 --> 00:11:27,100
you know if a host is available

295
00:11:24,670 --> 00:11:28,870
regardless of you<font color="#E5E5E5"> know from</font><font color="#CCCCCC"> just the</font>

296
00:11:27,100 --> 00:11:31,210
pure networking perspective<font color="#CCCCCC"> a response</font>

297
00:11:28,870 --> 00:11:33,220
will take a little<font color="#E5E5E5"> bit like if a host is</font>

298
00:11:31,210 --> 00:11:35,020
unavailable<font color="#CCCCCC"> a response will take longer</font>

299
00:11:33,220 --> 00:11:36,520
to fail and you can use<font color="#E5E5E5"> that timing</font>

300
00:11:35,020 --> 00:11:38,770
<font color="#E5E5E5">information to do internal network</font>

301
00:11:36,520 --> 00:11:40,090
scanning and things<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that and as</font>

302
00:11:38,770 --> 00:11:41,710
Dylan alluded to<font color="#CCCCCC"> cross-origin</font>

303
00:11:40,090 --> 00:11:43,210
vulnerabilities<font color="#CCCCCC"> can be performed through</font>

304
00:11:41,710 --> 00:11:45,280
<font color="#E5E5E5">cross-site request forgery and other</font>

305
00:11:43,210 --> 00:11:46,750
other forms as well<font color="#E5E5E5"> the other topic that</font>

306
00:11:45,280 --> 00:11:48,910
<font color="#E5E5E5">makes this really</font><font color="#CCCCCC"> interesting is DNS</font>

307
00:11:46,750 --> 00:11:51,250
rebinding<font color="#CCCCCC"> which which can</font><font color="#E5E5E5"> really blow</font>

308
00:11:48,910 --> 00:11:52,510
this stuff away<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> we'll talk about</font>

309
00:11:51,250 --> 00:11:55,620
it a<font color="#E5E5E5"> little bit but we don't have too</font>

310
00:11:52,510 --> 00:11:57,760
much time to<font color="#CCCCCC"> cover it in depth</font>

311
00:11:55,620 --> 00:12:00,430
<font color="#CCCCCC">cross-site request forgery is a pretty</font>

312
00:11:57,760 --> 00:12:02,590
<font color="#CCCCCC">well-known vulnerability</font><font color="#E5E5E5"> that you know</font>

313
00:12:00,430 --> 00:12:05,020
web application security<font color="#E5E5E5"> people talk</font>

314
00:12:02,590 --> 00:12:07,240
about<font color="#E5E5E5"> typically these</font><font color="#CCCCCC"> are simple</font>

315
00:12:05,020 --> 00:12:10,120
requests which will<font color="#E5E5E5"> include a version of</font>

316
00:12:07,240 --> 00:12:11,500
<font color="#E5E5E5">state when you try and protect against</font>

317
00:12:10,120 --> 00:12:13,270
these generally what you're<font color="#E5E5E5"> writing is</font>

318
00:12:11,500 --> 00:12:15,550
this<font color="#CCCCCC"> pre-flight you're adding a version</font>

319
00:12:13,270 --> 00:12:17,710
of<font color="#CCCCCC"> then the pre-flight artificially by</font>

320
00:12:15,550 --> 00:12:19,750
trying to<font color="#E5E5E5"> ensure that there's some some</font>

321
00:12:17,710 --> 00:12:21,870
value<font color="#E5E5E5"> that the</font><font color="#CCCCCC"> DES client knew ahead</font><font color="#E5E5E5"> of</font>

322
00:12:19,750 --> 00:12:24,130
<font color="#E5E5E5">time</font><font color="#CCCCCC"> before sending the request origin</font>

323
00:12:21,870 --> 00:12:27,040
wrapping back<font color="#CCCCCC"> with</font><font color="#E5E5E5"> FRA and I basically</font>

324
00:12:24,130 --> 00:12:28,689
<font color="#E5E5E5">talked about you know CSRF attacks</font>

325
00:12:27,040 --> 00:12:31,839
against users<font color="#CCCCCC"> they're kind of</font><font color="#E5E5E5"> not as</font>

326
00:12:28,690 --> 00:12:33,760
work<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so I guess when you frame it</font>

327
00:12:31,840 --> 00:12:36,610
<font color="#E5E5E5">like that the fact that you can send</font>

328
00:12:33,760 --> 00:12:37,990
post requests and get requests<font color="#E5E5E5"> to every</font>

329
00:12:36,610 --> 00:12:40,360
single<font color="#CCCCCC"> network</font><font color="#E5E5E5"> that a person is sitting</font>

330
00:12:37,990 --> 00:12:42,700
on the<font color="#E5E5E5"> loop back the VPN the internal</font>

331
00:12:40,360 --> 00:12:44,890
network<font color="#CCCCCC"> just if they click one</font><font color="#E5E5E5"> external</font>

332
00:12:42,700 --> 00:12:46,300
link once that sounds<font color="#E5E5E5"> like you might be</font>

333
00:12:44,890 --> 00:12:48,400
<font color="#E5E5E5">able to do some bad stuff with it</font>

334
00:12:46,300 --> 00:12:50,380
sure and this<font color="#E5E5E5"> is this is primarily what</font>

335
00:12:48,400 --> 00:12:52,390
beef<font color="#E5E5E5"> is about the idea is that you in</font>

336
00:12:50,380 --> 00:12:53,950
the<font color="#E5E5E5"> middle here are our beachhead</font><font color="#CCCCCC"> and if</font>

337
00:12:52,390 --> 00:12:55,390
you can get arbitrary JavaScript that's

338
00:12:53,950 --> 00:12:57,220
hooking back to<font color="#E5E5E5"> something else you can</font>

339
00:12:55,390 --> 00:12:59,740
then send other commands to other other

340
00:12:57,220 --> 00:13:01,690
networks<font color="#CCCCCC"> and this could be</font><font color="#E5E5E5"> your</font>

341
00:12:59,740 --> 00:13:03,760
<font color="#E5E5E5">co-workers or other internal services</font>

342
00:13:01,690 --> 00:13:04,600
<font color="#E5E5E5">cross-site scripting forms part of this</font>

343
00:13:03,760 --> 00:13:06,400
as well<font color="#CCCCCC"> we're not going to talk about</font>

344
00:13:04,600 --> 00:13:07,510
<font color="#E5E5E5">this too</font><font color="#CCCCCC"> much but the idea is that</font><font color="#E5E5E5"> if</font>

345
00:13:06,400 --> 00:13:09,100
you<font color="#E5E5E5"> have a</font><font color="#CCCCCC"> vulnerability</font><font color="#E5E5E5"> and you're a</font>

346
00:13:07,510 --> 00:13:11,530
web app you can<font color="#CCCCCC"> obviously run arbitrary</font>

347
00:13:09,100 --> 00:13:13,150
JavaScript in that origin in that

348
00:13:11,530 --> 00:13:15,100
<font color="#E5E5E5">instance that that JavaScript basically</font>

349
00:13:13,150 --> 00:13:17,290
emulate anything that the user can do

350
00:13:15,100 --> 00:13:18,040
and if you're wondering<font color="#CCCCCC"> how common these</font>

351
00:13:17,290 --> 00:13:20,560
types of owner

352
00:13:18,040 --> 00:13:22,810
these are this is<font color="#CCCCCC"> the readout of hacker</font>

353
00:13:20,560 --> 00:13:25,300
ones<font color="#E5E5E5"> most common reported</font>

354
00:13:22,810 --> 00:13:27,040
vulnerabilities<font color="#CCCCCC"> these get recorded all</font>

355
00:13:25,300 --> 00:13:29,349
the time cross-site scripting is still

356
00:13:27,040 --> 00:13:31,180
by far sitting very comfortably on top

357
00:13:29,350 --> 00:13:32,529
if you run a bug bounty<font color="#E5E5E5"> program you</font>

358
00:13:31,180 --> 00:13:34,359
<font color="#E5E5E5">probably see those all the time</font>

359
00:13:32,529 --> 00:13:37,120
cross-site request forgery is not too

360
00:13:34,360 --> 00:13:38,920
far to follow<font color="#E5E5E5"> but still</font><font color="#CCCCCC"> very common</font><font color="#E5E5E5"> type</font>

361
00:13:37,120 --> 00:13:41,319
<font color="#CCCCCC">of vulnerability and both of</font><font color="#E5E5E5"> these can</font>

362
00:13:38,920 --> 00:13:42,759
<font color="#E5E5E5">be used to attack infrastructure</font><font color="#CCCCCC"> this is</font>

363
00:13:41,319 --> 00:13:44,680
<font color="#CCCCCC">an interesting quote</font><font color="#E5E5E5"> from hacker one</font>

364
00:13:42,759 --> 00:13:47,069
where they basically<font color="#E5E5E5"> say generally</font>

365
00:13:44,680 --> 00:13:49,779
<font color="#CCCCCC">speaking stored cross-site scripting</font><font color="#E5E5E5"> are</font>

366
00:13:47,069 --> 00:13:51,910
more impactful<font color="#CCCCCC"> than reflected cross-site</font>

367
00:13:49,779 --> 00:13:53,350
scripting<font color="#CCCCCC"> I think what we want</font><font color="#E5E5E5"> to do</font>

368
00:13:51,910 --> 00:13:56,370
<font color="#E5E5E5">here today</font><font color="#CCCCCC"> is kind of flip that on its</font>

369
00:13:53,350 --> 00:13:59,500
head<font color="#E5E5E5"> and the reason why is if I want to</font>

370
00:13:56,370 --> 00:14:01,690
get some reflected cross-site scripting

371
00:13:59,500 --> 00:14:04,240
<font color="#E5E5E5">on an internal</font><font color="#CCCCCC"> application</font><font color="#E5E5E5"> I trigger it</font>

372
00:14:01,690 --> 00:14:06,670
through a victim<font color="#E5E5E5"> that clicks a link</font><font color="#CCCCCC"> I</font>

373
00:14:04,240 --> 00:14:08,139
can do that<font color="#E5E5E5"> but if it's a store across</font>

374
00:14:06,670 --> 00:14:09,430
<font color="#CCCCCC">side scripting</font><font color="#E5E5E5"> I would need some way to</font>

375
00:14:08,139 --> 00:14:10,930
store the payload ahead of time I

376
00:14:09,430 --> 00:14:13,329
<font color="#CCCCCC">wouldn't</font><font color="#E5E5E5"> be able to get that data in and</font>

377
00:14:10,930 --> 00:14:14,888
then get them to<font color="#E5E5E5"> render it and the only</font>

378
00:14:13,329 --> 00:14:16,329
way<font color="#E5E5E5"> to make that happen as additional</font>

379
00:14:14,889 --> 00:14:17,319
vulnerabilities<font color="#E5E5E5"> where as reflected</font>

380
00:14:16,329 --> 00:14:18,550
cross-site scripting

381
00:14:17,319 --> 00:14:21,399
we can immediately<font color="#E5E5E5"> start attacking</font>

382
00:14:18,550 --> 00:14:22,689
infrastructure<font color="#CCCCCC"> and so to</font><font color="#E5E5E5"> take a step</font>

383
00:14:21,399 --> 00:14:26,230
back and look<font color="#E5E5E5"> at what the bigger picture</font>

384
00:14:22,690 --> 00:14:28,990
is<font color="#E5E5E5"> here let's say I knew that internally</font>

385
00:14:26,230 --> 00:14:31,360
<font color="#E5E5E5">a company is</font><font color="#CCCCCC"> using Jenkins</font><font color="#E5E5E5"> a lot and I</font>

386
00:14:28,990 --> 00:14:33,010
can force a person to send HTTP requests

387
00:14:31,360 --> 00:14:35,170
to<font color="#E5E5E5"> their internal network if they click</font>

388
00:14:33,010 --> 00:14:37,149
my link and then I get a reflected

389
00:14:35,170 --> 00:14:39,189
cross-site scripting<font color="#E5E5E5"> in Jenkins</font><font color="#CCCCCC"> because</font>

390
00:14:37,149 --> 00:14:41,380
Jenkins lets you run code<font color="#E5E5E5"> through the</font>

391
00:14:39,190 --> 00:14:44,319
web UI<font color="#E5E5E5"> and because JavaScript gives you</font>

392
00:14:41,380 --> 00:14:46,089
full access<font color="#CCCCCC"> to the web UI this reflected</font>

393
00:14:44,319 --> 00:14:48,310
cross-site scripting<font color="#E5E5E5"> gives me remote</font>

394
00:14:46,089 --> 00:14:49,510
code execution and Jenkins and the

395
00:14:48,310 --> 00:14:51,430
stored cross-site scripting in this

396
00:14:49,510 --> 00:14:53,199
context isn't<font color="#CCCCCC"> really that helpful so if</font>

397
00:14:51,430 --> 00:14:54,959
somebody clicks<font color="#E5E5E5"> my link I can use the</font>

398
00:14:53,199 --> 00:14:57,490
reflected cross-site scripting to

399
00:14:54,959 --> 00:15:01,540
trigger remote code execution<font color="#CCCCCC"> internally</font>

400
00:14:57,490 --> 00:15:04,569
at a company so kind of bringing<font color="#E5E5E5"> it all</font>

401
00:15:01,540 --> 00:15:06,550
back<font color="#CCCCCC"> we mentioned one of the challenges</font>

402
00:15:04,569 --> 00:15:07,569
<font color="#E5E5E5">here might be same origin policy</font><font color="#CCCCCC"> and we</font>

403
00:15:06,550 --> 00:15:09,430
talked about<font color="#E5E5E5"> some</font><font color="#CCCCCC"> ways to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> around</font>

404
00:15:07,569 --> 00:15:11,139
<font color="#E5E5E5">that but it still seems</font><font color="#CCCCCC"> like if we're</font>

405
00:15:09,430 --> 00:15:12,519
attacking<font color="#E5E5E5"> an internal network</font><font color="#CCCCCC"> it's gonna</font>

406
00:15:11,139 --> 00:15:13,990
take a long<font color="#CCCCCC"> time to go through</font><font color="#E5E5E5"> all that</font>

407
00:15:12,519 --> 00:15:16,089
and<font color="#E5E5E5"> we're relying heavily on timing to</font>

408
00:15:13,990 --> 00:15:18,009
do that<font color="#E5E5E5"> yeah there's gonna</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> some major</font>

409
00:15:16,089 --> 00:15:19,600
limitations to using<font color="#CCCCCC"> these</font><font color="#E5E5E5"> definitely</font>

410
00:15:18,009 --> 00:15:21,250
<font color="#E5E5E5">and that's I'm</font><font color="#CCCCCC"> not gonna argue that</font>

411
00:15:19,600 --> 00:15:23,350
<font color="#E5E5E5">obviously the window of time where you</font>

412
00:15:21,250 --> 00:15:25,389
get<font color="#E5E5E5"> JavaScript to run</font><font color="#CCCCCC"> to do like a full</font>

413
00:15:23,350 --> 00:15:26,829
<font color="#CCCCCC">network sweep and find all the internal</font>

414
00:15:25,389 --> 00:15:28,750
hosts and find all<font color="#CCCCCC"> their IP address is</font>

415
00:15:26,829 --> 00:15:31,469
obviously<font color="#E5E5E5"> tricky happens if the victim</font>

416
00:15:28,750 --> 00:15:31,470
closes their tabs

417
00:15:31,530 --> 00:15:34,890
you know the premise<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we're talking</font>

418
00:15:32,790 --> 00:15:36,209
<font color="#CCCCCC">about</font><font color="#E5E5E5"> is trying to get</font><font color="#CCCCCC"> to arbitrary</font>

419
00:15:34,890 --> 00:15:37,770
command<font color="#CCCCCC"> injection on internal hosts</font>

420
00:15:36,210 --> 00:15:40,020
through potentially a single victim who

421
00:15:37,770 --> 00:15:41,880
<font color="#CCCCCC">may close their tab pretty fast so I</font>

422
00:15:40,020 --> 00:15:44,100
<font color="#CCCCCC">think</font><font color="#E5E5E5"> this is where we</font><font color="#CCCCCC"> really take</font><font color="#E5E5E5"> the</font>

423
00:15:41,880 --> 00:15:46,680
idea of<font color="#CCCCCC"> some red teaming techniques and</font>

424
00:15:44,100 --> 00:15:49,080
we combine<font color="#E5E5E5"> them ahead of time to do a</font>

425
00:15:46,680 --> 00:15:52,650
whole bunch<font color="#CCCCCC"> of</font><font color="#E5E5E5"> recon on</font><font color="#CCCCCC"> a company using</font>

426
00:15:49,080 --> 00:15:54,600
a wide variety of methods<font color="#CCCCCC"> to get</font>

427
00:15:52,650 --> 00:15:56,760
everything<font color="#E5E5E5"> we</font><font color="#CCCCCC"> need to know about their</font>

428
00:15:54,600 --> 00:15:57,810
<font color="#E5E5E5">internal environment ahead of time</font><font color="#CCCCCC"> so</font>

429
00:15:56,760 --> 00:15:59,550
<font color="#E5E5E5">that by</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> time somebody</font><font color="#CCCCCC"> clicks a link</font>

430
00:15:57,810 --> 00:16:01,109
<font color="#CCCCCC">we already know exactly</font><font color="#E5E5E5"> what we're</font>

431
00:15:59,550 --> 00:16:03,109
targeting with our payload queued up and

432
00:16:01,110 --> 00:16:05,790
immediately<font color="#E5E5E5"> we just start attacking them</font>

433
00:16:03,110 --> 00:16:08,100
<font color="#CCCCCC">there are a ton of different</font><font color="#E5E5E5"> rate</font>

434
00:16:05,790 --> 00:16:08,790
<font color="#E5E5E5">contexts</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I will not go into</font><font color="#CCCCCC"> all of</font>

435
00:16:08,100 --> 00:16:11,360
<font color="#E5E5E5">them</font>

436
00:16:08,790 --> 00:16:14,579
mostly<font color="#E5E5E5"> for time reasons but I will cover</font>

437
00:16:11,360 --> 00:16:17,130
<font color="#E5E5E5">two</font><font color="#CCCCCC"> of the ones up here just</font><font color="#E5E5E5"> to kind of</font>

438
00:16:14,580 --> 00:16:21,150
get the<font color="#E5E5E5"> point</font><font color="#CCCCCC"> for us the way certificate</font>

439
00:16:17,130 --> 00:16:25,260
transparency works<font color="#E5E5E5"> basically all SSL</font>

440
00:16:21,150 --> 00:16:28,230
certificates<font color="#E5E5E5"> from a real certificate</font>

441
00:16:25,260 --> 00:16:30,060
authority<font color="#CCCCCC"> will</font><font color="#E5E5E5"> be logged in a public</font>

442
00:16:28,230 --> 00:16:33,380
<font color="#E5E5E5">ledger called certificate</font><font color="#CCCCCC"> transparency</font>

443
00:16:30,060 --> 00:16:36,810
<font color="#E5E5E5">even internal hosts and so if you have</font>

444
00:16:33,380 --> 00:16:39,839
SSL on<font color="#E5E5E5"> your applications the host name</font>

445
00:16:36,810 --> 00:16:41,250
<font color="#E5E5E5">for</font><font color="#CCCCCC"> those applications is</font><font color="#E5E5E5"> very likely</font>

446
00:16:39,839 --> 00:16:43,770
being leaked through certificate

447
00:16:41,250 --> 00:16:46,800
<font color="#CCCCCC">transparency</font><font color="#E5E5E5"> and another</font><font color="#CCCCCC"> example of</font>

448
00:16:43,770 --> 00:16:49,310
things you can use recon virustotal

449
00:16:46,800 --> 00:16:52,349
<font color="#E5E5E5">is a service that advertises itself as</font>

450
00:16:49,310 --> 00:16:54,660
free<font color="#E5E5E5"> virus scanning for malware</font><font color="#CCCCCC"> samples</font>

451
00:16:52,350 --> 00:16:56,610
that you upload to<font color="#CCCCCC"> it and they do that</font>

452
00:16:54,660 --> 00:16:59,459
they<font color="#CCCCCC"> will scan it with a whole</font><font color="#E5E5E5"> bunch of</font>

453
00:16:56,610 --> 00:17:01,260
different<font color="#E5E5E5"> antivirus software well they</font>

454
00:16:59,460 --> 00:17:03,180
<font color="#E5E5E5">don't advertise as much though is if you</font>

455
00:17:01,260 --> 00:17:05,099
pay<font color="#CCCCCC"> virustotal</font><font color="#E5E5E5"> a bunch of money they</font>

456
00:17:03,180 --> 00:17:07,438
actually<font color="#CCCCCC"> allow anyone to download those</font>

457
00:17:05,099 --> 00:17:09,270
samples that people have uploaded<font color="#E5E5E5"> so if</font>

458
00:17:07,439 --> 00:17:11,339
you upload<font color="#E5E5E5"> some weird internal thing</font>

459
00:17:09,270 --> 00:17:12,869
that's got internal<font color="#E5E5E5"> host names anybody</font>

460
00:17:11,339 --> 00:17:14,609
can<font color="#E5E5E5"> download that if they pay virustotal</font>

461
00:17:12,869 --> 00:17:16,260
enough and if you don't want to pay

462
00:17:14,609 --> 00:17:19,290
<font color="#CCCCCC">virus total if you want to</font><font color="#E5E5E5"> just use</font>

463
00:17:16,260 --> 00:17:21,240
their free api as it turns out<font color="#CCCCCC"> they make</font>

464
00:17:19,290 --> 00:17:23,430
available<font color="#CCCCCC"> to them</font><font color="#E5E5E5"> all the host names</font>

465
00:17:21,240 --> 00:17:25,500
<font color="#E5E5E5">that they've found from all the samples</font>

466
00:17:23,430 --> 00:17:28,410
<font color="#E5E5E5">that have been</font><font color="#CCCCCC"> uploaded so it's</font><font color="#E5E5E5"> pretty</font>

467
00:17:25,500 --> 00:17:30,630
<font color="#CCCCCC">easy to get a whole list of host names</font>

468
00:17:28,410 --> 00:17:32,280
through<font color="#CCCCCC"> virustotal of a company because</font>

469
00:17:30,630 --> 00:17:33,900
<font color="#E5E5E5">chances are over a long course of time</font>

470
00:17:32,280 --> 00:17:35,879
folks<font color="#CCCCCC"> at that</font><font color="#E5E5E5"> company have uploaded</font>

471
00:17:33,900 --> 00:17:37,890
various samples to<font color="#CCCCCC"> virustotal including</font>

472
00:17:35,880 --> 00:17:39,060
internal host names<font color="#CCCCCC"> i'm not</font><font color="#E5E5E5"> gonna go</font>

473
00:17:37,890 --> 00:17:41,790
through<font color="#CCCCCC"> the rest</font><font color="#E5E5E5"> but you got the picture</font>

474
00:17:39,060 --> 00:17:44,090
at this<font color="#E5E5E5"> point now we're going to at this</font>

475
00:17:41,790 --> 00:17:47,210
<font color="#E5E5E5">point for no arbitrary reason</font>

476
00:17:44,090 --> 00:17:48,559
pick on<font color="#E5E5E5"> Netflix so we've asked ahead of</font>

477
00:17:47,210 --> 00:17:49,700
time from one of our<font color="#E5E5E5"> friends over</font><font color="#CCCCCC"> at</font>

478
00:17:48,559 --> 00:17:51,559
Netflix that<font color="#E5E5E5"> we can do this and they've</font>

479
00:17:49,700 --> 00:17:53,360
given<font color="#CCCCCC"> us a thumbs up we don't know</font>

480
00:17:51,559 --> 00:17:55,070
anything<font color="#E5E5E5"> about networks</font><font color="#CCCCCC"> Netflix is</font>

481
00:17:53,360 --> 00:17:56,870
internal environment<font color="#E5E5E5"> we've never worked</font>

482
00:17:55,070 --> 00:17:58,760
there<font color="#CCCCCC"> before we do have some</font><font color="#E5E5E5"> friends</font>

483
00:17:56,870 --> 00:18:01,610
over<font color="#E5E5E5"> there that we refuse to apologize</font>

484
00:17:58,760 --> 00:18:03,320
to um but the idea here<font color="#CCCCCC"> is we're just</font>

485
00:18:01,610 --> 00:18:04,850
<font color="#E5E5E5">gonna perform recon on Netflix to see</font>

486
00:18:03,320 --> 00:18:06,559
what it looks<font color="#E5E5E5"> like so we're gonna start</font>

487
00:18:04,850 --> 00:18:09,709
<font color="#E5E5E5">with second-level domains</font><font color="#CCCCCC"> what this</font>

488
00:18:06,559 --> 00:18:12,139
means is like if it's something calm or

489
00:18:09,710 --> 00:18:13,730
something or etc<font color="#CCCCCC"> we want to see as</font><font color="#E5E5E5"> many</font>

490
00:18:12,140 --> 00:18:16,610
<font color="#E5E5E5">of those</font><font color="#CCCCCC"> domains</font><font color="#E5E5E5"> that we could possibly</font>

491
00:18:13,730 --> 00:18:17,720
can<font color="#CCCCCC"> that are owned by Netflix so there</font>

492
00:18:16,610 --> 00:18:19,549
are a lot<font color="#CCCCCC"> of different tools that</font><font color="#E5E5E5"> we can</font>

493
00:18:17,720 --> 00:18:22,490
<font color="#CCCCCC">use to do this</font><font color="#E5E5E5"> one of them is a tool</font>

494
00:18:19,549 --> 00:18:25,100
<font color="#CCCCCC">called passive total that will show us</font>

495
00:18:22,490 --> 00:18:26,840
in<font color="#E5E5E5"> this example on the Left there's a</font>

496
00:18:25,100 --> 00:18:29,629
<font color="#E5E5E5">Whois certificate or sorry the Whois</font>

497
00:18:26,840 --> 00:18:31,730
record<font color="#CCCCCC"> it's got some information like</font>

498
00:18:29,630 --> 00:18:34,490
<font color="#CCCCCC">the email address organization in the</font>

499
00:18:31,730 --> 00:18:38,059
street and the<font color="#E5E5E5"> city</font><font color="#CCCCCC"> those are all</font>

500
00:18:34,490 --> 00:18:39,200
<font color="#CCCCCC">relatively unique to Netflix</font><font color="#E5E5E5"> and passive</font>

501
00:18:38,059 --> 00:18:40,879
total will actually allow you<font color="#E5E5E5"> to do a</font>

502
00:18:39,200 --> 00:18:43,490
reverse search on those<font color="#CCCCCC"> fields so we can</font>

503
00:18:40,880 --> 00:18:45,679
see<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> other domains that also</font>

504
00:18:43,490 --> 00:18:47,899
share<font color="#E5E5E5"> those attributes and use them</font><font color="#CCCCCC"> to</font>

505
00:18:45,679 --> 00:18:49,130
put together<font color="#CCCCCC"> Netflix's portfolio of</font>

506
00:18:47,899 --> 00:18:50,928
domains<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> just click the button</font>

507
00:18:49,130 --> 00:18:58,880
<font color="#CCCCCC">which is my form of hacking</font>

508
00:18:50,929 --> 00:19:00,860
<font color="#E5E5E5">it's yep</font><font color="#CCCCCC"> so on the right side we've got</font>

509
00:18:58,880 --> 00:19:03,350
the SSL certificate<font color="#CCCCCC"> and it's the same</font>

510
00:19:00,860 --> 00:19:05,689
exact idea<font color="#CCCCCC"> you notice the location</font><font color="#E5E5E5"> is</font>

511
00:19:03,350 --> 00:19:07,570
<font color="#E5E5E5">los gatos how many companies are</font><font color="#CCCCCC"> in los</font>

512
00:19:05,690 --> 00:19:10,490
<font color="#CCCCCC">gatos i've looked it's not that many</font>

513
00:19:07,570 --> 00:19:12,620
<font color="#CCCCCC">most of the los gatos certificates</font>

514
00:19:10,490 --> 00:19:14,899
<font color="#E5E5E5">actually belong to</font><font color="#CCCCCC"> netflix and so when</font>

515
00:19:12,620 --> 00:19:16,399
we<font color="#CCCCCC"> put this together with</font><font color="#E5E5E5"> say crawling</font>

516
00:19:14,899 --> 00:19:17,989
<font color="#CCCCCC">there</font><font color="#E5E5E5"> github looking for host names</font>

517
00:19:16,399 --> 00:19:19,639
<font color="#E5E5E5">going through their mobile</font><font color="#CCCCCC"> app looking</font>

518
00:19:17,990 --> 00:19:22,640
for host names<font color="#E5E5E5"> we end up with more</font><font color="#CCCCCC"> than</font>

519
00:19:19,640 --> 00:19:25,220
<font color="#E5E5E5">500 second-level domains</font><font color="#CCCCCC"> too many to</font>

520
00:19:22,640 --> 00:19:26,600
list<font color="#CCCCCC"> here and I</font><font color="#E5E5E5"> will not dig into each</font>

521
00:19:25,220 --> 00:19:29,299
<font color="#E5E5E5">and</font><font color="#CCCCCC"> every</font><font color="#E5E5E5"> one of these four subdomains</font>

522
00:19:26,600 --> 00:19:31,760
<font color="#CCCCCC">for the sake of time and said we were</font>

523
00:19:29,299 --> 00:19:34,668
only<font color="#E5E5E5"> going to look at subdomains of one</font>

524
00:19:31,760 --> 00:19:36,230
of these second-level domains but<font color="#E5E5E5"> you</font>

525
00:19:34,669 --> 00:19:39,529
can imagine<font color="#E5E5E5"> like all of them could have</font>

526
00:19:36,230 --> 00:19:41,419
subdomains that correspond to internal

527
00:19:39,529 --> 00:19:42,890
host names so we're just<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> pick</font>

528
00:19:41,419 --> 00:19:45,110
Netflix<font color="#CCCCCC"> comm and we're going</font><font color="#E5E5E5"> to get to</font>

529
00:19:42,890 --> 00:19:46,490
<font color="#E5E5E5">work on finding subdomains</font><font color="#CCCCCC"> we used a</font>

530
00:19:45,110 --> 00:19:48,709
bunch of different recon techniques to

531
00:19:46,490 --> 00:19:52,760
do this<font color="#CCCCCC"> and by the end of it what we end</font>

532
00:19:48,710 --> 00:19:55,940
up with is thousands of subdomains<font color="#CCCCCC"> we</font>

533
00:19:52,760 --> 00:19:57,289
have a small list of them<font color="#E5E5E5"> here</font><font color="#CCCCCC"> you as</font>

534
00:19:55,940 --> 00:19:57,650
you can see like some of them look

535
00:19:57,289 --> 00:19:59,690
<font color="#CCCCCC">pretty</font>

536
00:19:57,650 --> 00:20:01,360
interesting<font color="#E5E5E5"> from an attacker standpoint</font>

537
00:19:59,690 --> 00:20:04,360
that's<font color="#E5E5E5"> our confluence of Puppets server</font>

538
00:20:01,360 --> 00:20:06,889
<font color="#CCCCCC">their JIRA</font><font color="#E5E5E5"> their artifactory</font>

539
00:20:04,360 --> 00:20:09,290
not all of<font color="#E5E5E5"> these are necessarily still</font>

540
00:20:06,890 --> 00:20:12,080
live but<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of them probably are and</font>

541
00:20:09,290 --> 00:20:13,879
what we<font color="#E5E5E5"> can do is we can use these</font>

542
00:20:12,080 --> 00:20:16,220
subdomains to look for things that<font color="#CCCCCC"> look</font>

543
00:20:13,880 --> 00:20:19,730
<font color="#E5E5E5">like they're</font><font color="#CCCCCC"> open-source sounding names</font>

544
00:20:16,220 --> 00:20:21,890
so what we<font color="#E5E5E5"> can do once we find one like</font>

545
00:20:19,730 --> 00:20:24,970
<font color="#E5E5E5">for</font><font color="#CCCCCC"> example if we were to find Jenkins</font>

546
00:20:21,890 --> 00:20:29,870
<font color="#CCCCCC">that Netflix com not to say that exists</font>

547
00:20:24,970 --> 00:20:31,610
<font color="#E5E5E5">basically this would allow us to build a</font>

548
00:20:29,870 --> 00:20:35,540
payload against<font color="#E5E5E5"> that host specifically</font>

549
00:20:31,610 --> 00:20:38,240
and target it internally<font color="#E5E5E5"> so it's fair to</font>

550
00:20:35,540 --> 00:20:40,639
also assume<font color="#CCCCCC"> that if we find</font><font color="#E5E5E5"> a name</font>

551
00:20:38,240 --> 00:20:41,870
that's something Netflix<font color="#CCCCCC"> comm there's</font>

552
00:20:40,640 --> 00:20:44,180
<font color="#E5E5E5">probably a whole bunch of devs running</font>

553
00:20:41,870 --> 00:20:46,550
that thing<font color="#E5E5E5"> locally</font><font color="#CCCCCC"> as well</font>

554
00:20:44,180 --> 00:20:47,870
so if we find Jenkins that<font color="#E5E5E5"> Netflix</font><font color="#CCCCCC"> comm</font>

555
00:20:46,550 --> 00:20:48,889
<font color="#E5E5E5">it's probably fair</font><font color="#CCCCCC"> to assume</font><font color="#E5E5E5"> a whole</font>

556
00:20:47,870 --> 00:20:54,320
bunch of devs are running Jenkins

557
00:20:48,890 --> 00:20:58,010
locally<font color="#E5E5E5"> so what</font><font color="#CCCCCC"> uh what if</font><font color="#E5E5E5"> we again put</font>

558
00:20:54,320 --> 00:21:00,050
this together<font color="#E5E5E5"> not to pick on Netflix and</font>

559
00:20:58,010 --> 00:21:02,030
not to pick<font color="#E5E5E5"> on</font><font color="#CCCCCC"> Jenkins but if we look at</font>

560
00:21:00,050 --> 00:21:03,889
the list of cross-site scripting<font color="#CCCCCC"> that</font>

561
00:21:02,030 --> 00:21:05,510
<font color="#CCCCCC">have</font><font color="#E5E5E5"> been reported to Jenkins over the</font>

562
00:21:03,890 --> 00:21:08,750
last<font color="#E5E5E5"> couple of years they're pretty</font>

563
00:21:05,510 --> 00:21:11,330
common<font color="#CCCCCC"> and typically for one</font><font color="#E5E5E5"> reason or</font>

564
00:21:08,750 --> 00:21:13,550
another they're filed as low severity<font color="#CCCCCC"> we</font>

565
00:21:11,330 --> 00:21:15,050
want to again frame the case<font color="#E5E5E5"> that if you</font>

566
00:21:13,550 --> 00:21:17,600
<font color="#CCCCCC">were to get a reflected cross-site</font>

567
00:21:15,050 --> 00:21:19,750
scripting<font color="#E5E5E5"> in something like Jenkins</font><font color="#CCCCCC"> it</font>

568
00:21:17,600 --> 00:21:21,679
could be game<font color="#E5E5E5"> over</font><font color="#CCCCCC"> even if</font><font color="#E5E5E5"> it's internal</font>

569
00:21:19,750 --> 00:21:24,230
<font color="#E5E5E5">and one of the really</font><font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> things</font>

570
00:21:21,680 --> 00:21:25,640
<font color="#CCCCCC">that that happens in</font><font color="#E5E5E5"> this instance as</font>

571
00:21:24,230 --> 00:21:27,740
well as the<font color="#E5E5E5"> kind of tunes the bug bounty</font>

572
00:21:25,640 --> 00:21:29,750
from<font color="#E5E5E5"> being assessment to being</font>

573
00:21:27,740 --> 00:21:31,610
effectively a white box assessment it's

574
00:21:29,750 --> 00:21:33,080
a<font color="#CCCCCC"> view download you can software</font>

575
00:21:31,610 --> 00:21:36,110
yourself<font color="#CCCCCC"> look at the code it's a really</font>

576
00:21:33,080 --> 00:21:37,399
good<font color="#E5E5E5"> point so yeah usually</font><font color="#CCCCCC"> you're from</font><font color="#E5E5E5"> a</font>

577
00:21:36,110 --> 00:21:39,590
<font color="#E5E5E5">from an attackers point of view if</font>

578
00:21:37,400 --> 00:21:40,640
<font color="#E5E5E5">you're attacking</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> that's</font>

579
00:21:39,590 --> 00:21:43,040
external you don't have the source code

580
00:21:40,640 --> 00:21:45,320
<font color="#E5E5E5">for it but if you're attacking an open</font>

581
00:21:43,040 --> 00:21:46,490
source thing that<font color="#E5E5E5"> runs internally</font><font color="#CCCCCC"> you</font>

582
00:21:45,320 --> 00:21:48,080
could just rip the source code run it

583
00:21:46,490 --> 00:21:50,480
locally<font color="#E5E5E5"> proc do whatever you need to do</font>

584
00:21:48,080 --> 00:21:53,570
<font color="#E5E5E5">so potentially bug finding</font><font color="#CCCCCC"> is a little</font>

585
00:21:50,480 --> 00:21:54,710
easier<font color="#CCCCCC"> so this is just a small</font><font color="#E5E5E5"> piece of</font>

586
00:21:53,570 --> 00:21:57,320
JavaScript<font color="#CCCCCC"> to see what that</font><font color="#E5E5E5"> could</font><font color="#CCCCCC"> look</font>

587
00:21:54,710 --> 00:21:58,550
like<font color="#E5E5E5"> if we</font><font color="#CCCCCC"> had such an exploit like a</font>

588
00:21:57,320 --> 00:22:01,100
cross-site request forgery against

589
00:21:58,550 --> 00:22:06,169
Jenkins or something like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> to sweep</font>

590
00:22:01,100 --> 00:22:08,570
a slash 24 so 255 hosts<font color="#CCCCCC"> this</font><font color="#E5E5E5"> takes about</font>

591
00:22:06,170 --> 00:22:09,530
30 seconds<font color="#E5E5E5"> so it's pretty quick</font><font color="#CCCCCC"> so if we</font>

592
00:22:08,570 --> 00:22:10,970
knew ahead of time that<font color="#CCCCCC"> there's</font>

593
00:22:09,530 --> 00:22:11,480
something<font color="#CCCCCC"> than running</font><font color="#E5E5E5"> internally we had</font>

594
00:22:10,970 --> 00:22:13,519
an exploit

595
00:22:11,480 --> 00:22:15,200
queued up and ready to go<font color="#CCCCCC"> we could</font>

596
00:22:13,519 --> 00:22:20,510
potentially<font color="#E5E5E5"> spray their entire internal</font>

597
00:22:15,200 --> 00:22:23,029
network<font color="#CCCCCC"> after</font><font color="#E5E5E5"> 60 seconds</font><font color="#CCCCCC"> this actually</font>

598
00:22:20,510 --> 00:22:26,809
is what unlocks<font color="#E5E5E5"> some more deadly attacks</font>

599
00:22:23,029 --> 00:22:28,700
<font color="#E5E5E5">we mentioned DNS rebinding</font><font color="#CCCCCC"> earlier we</font>

600
00:22:26,809 --> 00:22:31,070
won't have<font color="#E5E5E5"> time</font><font color="#CCCCCC"> to go into all the</font>

601
00:22:28,700 --> 00:22:33,740
specifics<font color="#E5E5E5"> of DNS rebinding</font><font color="#CCCCCC"> but the basic</font>

602
00:22:31,070 --> 00:22:36,559
idea is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the definition of an origin</font>

603
00:22:33,740 --> 00:22:39,139
does not include an IP address<font color="#E5E5E5"> and so if</font>

604
00:22:36,559 --> 00:22:41,299
a DNS server responds<font color="#CCCCCC"> with a public IP</font>

605
00:22:39,139 --> 00:22:43,549
address the first time and a private IP

606
00:22:41,299 --> 00:22:44,809
<font color="#E5E5E5">address the second time the browser will</font>

607
00:22:43,549 --> 00:22:46,549
think that it's talking<font color="#E5E5E5"> to the same</font>

608
00:22:44,809 --> 00:22:48,620
origin<font color="#CCCCCC"> even though it's talking to a</font>

609
00:22:46,549 --> 00:22:51,168
different<font color="#CCCCCC"> server so we can serve our</font>

610
00:22:48,620 --> 00:22:53,090
malicious<font color="#E5E5E5"> JavaScript under a public IP</font>

611
00:22:51,169 --> 00:22:55,309
address and then using that malicious

612
00:22:53,090 --> 00:22:57,500
<font color="#CCCCCC">JavaScript have it make requests to</font><font color="#E5E5E5"> its</font>

613
00:22:55,309 --> 00:22:59,510
own<font color="#CCCCCC"> origin</font><font color="#E5E5E5"> and then the second time the</font>

614
00:22:57,500 --> 00:23:03,019
browser<font color="#E5E5E5"> does a</font><font color="#CCCCCC"> dns lookup</font><font color="#E5E5E5"> the shortest</font>

615
00:22:59,510 --> 00:23:07,490
CTL<font color="#E5E5E5"> of browser sports is 60 seconds</font><font color="#CCCCCC"> we</font>

616
00:23:03,019 --> 00:23:09,380
can actually respond with an RFC<font color="#E5E5E5"> 1819 IP</font>

617
00:23:07,490 --> 00:23:12,830
address and<font color="#E5E5E5"> have them make that request</font>

618
00:23:09,380 --> 00:23:15,850
<font color="#CCCCCC">to an internal host now the</font><font color="#E5E5E5"> caveat here</font>

619
00:23:12,830 --> 00:23:18,080
is<font color="#E5E5E5"> that HTTPS won't really</font><font color="#CCCCCC"> work because</font>

620
00:23:15,850 --> 00:23:19,908
<font color="#E5E5E5">certificates common names won't match up</font>

621
00:23:18,080 --> 00:23:21,289
<font color="#CCCCCC">because your external</font><font color="#E5E5E5"> host name isn't</font>

622
00:23:19,909 --> 00:23:24,080
<font color="#E5E5E5">gonna be the same</font><font color="#CCCCCC"> as your</font><font color="#E5E5E5"> internal host</font>

623
00:23:21,289 --> 00:23:25,700
name but everything non SSL<font color="#CCCCCC"> we can</font>

624
00:23:24,080 --> 00:23:27,740
basically<font color="#E5E5E5"> completely get rid</font><font color="#CCCCCC"> of the same</font>

625
00:23:25,700 --> 00:23:29,510
<font color="#E5E5E5">origin</font><font color="#CCCCCC"> policy and just fully make</font>

626
00:23:27,740 --> 00:23:31,100
requests of<font color="#E5E5E5"> your response to hosts</font>

627
00:23:29,510 --> 00:23:32,779
without relying across<font color="#E5E5E5"> that request</font>

628
00:23:31,100 --> 00:23:35,029
forgery bugs<font color="#E5E5E5"> and what about only</font>

629
00:23:32,779 --> 00:23:37,460
expensive firewalls<font color="#E5E5E5"> that we have that's</font>

630
00:23:35,029 --> 00:23:39,950
a great question<font color="#E5E5E5"> because the person</font>

631
00:23:37,460 --> 00:23:41,210
clicking the<font color="#E5E5E5"> link is already sitting</font><font color="#CCCCCC"> on</font>

632
00:23:39,950 --> 00:23:44,179
the network behind<font color="#E5E5E5"> the firewall</font>

633
00:23:41,210 --> 00:23:46,669
<font color="#CCCCCC">we've already bypassed that</font><font color="#E5E5E5"> and so the</font>

634
00:23:44,179 --> 00:23:49,010
user their browser<font color="#E5E5E5"> can make full</font>

635
00:23:46,669 --> 00:23:49,760
requests to loop back<font color="#CCCCCC"> to internal hosts</font>

636
00:23:49,010 --> 00:23:51,500
to VPNs

637
00:23:49,760 --> 00:23:53,120
they're already sitting<font color="#E5E5E5"> behind the</font>

638
00:23:51,500 --> 00:23:57,230
firewall<font color="#E5E5E5"> and</font><font color="#CCCCCC"> so we're</font><font color="#E5E5E5"> pretty much able</font>

639
00:23:53,120 --> 00:23:59,870
to completely blow past that pretty much

640
00:23:57,230 --> 00:24:01,970
<font color="#E5E5E5">everything on the internal</font><font color="#CCCCCC"> network that</font>

641
00:23:59,870 --> 00:24:05,449
does not use SSL<font color="#E5E5E5"> or that's running</font>

642
00:24:01,970 --> 00:24:07,880
locally<font color="#CCCCCC"> basically becomes external</font><font color="#E5E5E5"> and</font>

643
00:24:05,450 --> 00:24:09,950
<font color="#E5E5E5">the attacker can fully make requests and</font>

644
00:24:07,880 --> 00:24:11,779
view responses<font color="#CCCCCC"> as if there were no</font>

645
00:24:09,950 --> 00:24:13,460
restrictions<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> entire internal</font>

646
00:24:11,779 --> 00:24:17,000
<font color="#E5E5E5">network just by holding somebody on a</font>

647
00:24:13,460 --> 00:24:19,159
page for<font color="#E5E5E5"> 60 seconds</font><font color="#CCCCCC"> NCC</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> put out a</font>

648
00:24:17,000 --> 00:24:20,539
framework<font color="#E5E5E5"> called singularity and we met</font>

649
00:24:19,159 --> 00:24:22,940
with<font color="#CCCCCC"> those folks</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> talked with</font><font color="#E5E5E5"> them</font>

650
00:24:20,539 --> 00:24:24,710
<font color="#E5E5E5">they're building out capabilities</font><font color="#CCCCCC"> in</font>

651
00:24:22,940 --> 00:24:25,350
singularity<font color="#E5E5E5"> that will basically allow</font>

652
00:24:24,710 --> 00:24:28,380
you to

653
00:24:25,350 --> 00:24:30,389
you click a malicious link and then

654
00:24:28,380 --> 00:24:31,440
singularity will rebind to your entire

655
00:24:30,390 --> 00:24:33,150
internal<font color="#E5E5E5"> network</font>

656
00:24:31,440 --> 00:24:35,070
it'll look<font color="#E5E5E5"> at the responses coming back</font>

657
00:24:33,150 --> 00:24:36,539
<font color="#E5E5E5">log all</font><font color="#CCCCCC"> of them and if it matches a</font>

658
00:24:35,070 --> 00:24:38,760
signature of<font color="#E5E5E5"> something it knows</font><font color="#CCCCCC"> it's</font>

659
00:24:36,539 --> 00:24:40,289
vulnerable<font color="#CCCCCC"> it'll auto upload exploits to</font>

660
00:24:38,760 --> 00:24:44,190
<font color="#E5E5E5">it and you'll be</font><font color="#CCCCCC"> able to hook</font><font color="#E5E5E5"> in</font>

661
00:24:40,289 --> 00:24:47,039
interpreters<font color="#E5E5E5"> and stuff like that</font><font color="#CCCCCC"> so this</font>

662
00:24:44,190 --> 00:24:49,200
DNS rebinding stuff is really dangerous

663
00:24:47,039 --> 00:24:50,760
<font color="#E5E5E5">and I wish we cover it more but we've</font>

664
00:24:49,200 --> 00:24:52,590
got to keep covering other other

665
00:24:50,760 --> 00:24:53,940
techniques as well<font color="#E5E5E5"> so obviously</font><font color="#CCCCCC"> in these</font>

666
00:24:52,590 --> 00:24:56,610
examples we're talking about rebonding

667
00:24:53,940 --> 00:24:58,350
<font color="#CCCCCC">to IP addresses but during the recon we</font>

668
00:24:56,610 --> 00:25:00,510
didn't get up here dresses<font color="#E5E5E5"> we got see</font>

669
00:24:58,350 --> 00:25:02,969
names like<font color="#CCCCCC"> does</font><font color="#E5E5E5"> that can we do that</font><font color="#CCCCCC"> yes</font>

670
00:25:00,510 --> 00:25:07,049
so during our<font color="#E5E5E5"> recon</font><font color="#CCCCCC"> we were able</font><font color="#E5E5E5"> to get</font>

671
00:25:02,970 --> 00:25:09,120
a<font color="#E5E5E5"> portfolio of potential</font><font color="#CCCCCC"> DNS records</font>

672
00:25:07,049 --> 00:25:11,220
that that a company is<font color="#CCCCCC"> running</font>

673
00:25:09,120 --> 00:25:12,959
internally<font color="#CCCCCC"> you're absolutely right that</font>

674
00:25:11,220 --> 00:25:14,909
when we do<font color="#CCCCCC"> our DNS rebinding we don't</font>

675
00:25:12,960 --> 00:25:16,860
have to<font color="#E5E5E5"> point</font><font color="#CCCCCC"> to an IP address</font><font color="#E5E5E5"> we could</font>

676
00:25:14,909 --> 00:25:18,570
just point<font color="#E5E5E5"> to a cname and because we</font>

677
00:25:16,860 --> 00:25:21,059
<font color="#CCCCCC">already have thousands of posts so we</font>

678
00:25:18,570 --> 00:25:22,350
know are<font color="#E5E5E5"> probably already internal we</font>

679
00:25:21,059 --> 00:25:23,668
don't have to do any guesswork<font color="#E5E5E5"> at all we</font>

680
00:25:22,350 --> 00:25:25,350
<font color="#CCCCCC">can</font><font color="#E5E5E5"> just completely do our DNS rebinding</font>

681
00:25:23,669 --> 00:25:27,630
<font color="#CCCCCC">to all the hosts that</font><font color="#E5E5E5"> we already know</font>

682
00:25:25,350 --> 00:25:31,350
<font color="#CCCCCC">are there and then immediately</font><font color="#E5E5E5"> start</font>

683
00:25:27,630 --> 00:25:33,390
exfiltrating data<font color="#E5E5E5"> so</font><font color="#CCCCCC"> no we're gonna</font>

684
00:25:31,350 --> 00:25:35,699
cover a<font color="#E5E5E5"> bunch of</font><font color="#CCCCCC"> real-world examples</font>

685
00:25:33,390 --> 00:25:37,980
that<font color="#CCCCCC"> i've used in bug bounties that are</font>

686
00:25:35,700 --> 00:25:39,559
unrelated<font color="#E5E5E5"> to Netflix or Jenkins or</font>

687
00:25:37,980 --> 00:25:41,520
anything<font color="#E5E5E5"> that we've talked about so</font><font color="#CCCCCC"> far</font>

688
00:25:39,559 --> 00:25:43,649
<font color="#CCCCCC">what I want to show here is that this</font>

689
00:25:41,520 --> 00:25:46,559
process<font color="#E5E5E5"> is actually relatively easy to</font>

690
00:25:43,650 --> 00:25:49,980
do and I've<font color="#E5E5E5"> done it a couple of times</font><font color="#CCCCCC"> so</font>

691
00:25:46,559 --> 00:25:51,059
basically<font color="#CCCCCC"> there is some company that was</font>

692
00:25:49,980 --> 00:25:52,710
running<font color="#E5E5E5"> a piece of software called</font>

693
00:25:51,059 --> 00:25:54,870
<font color="#E5E5E5">review board</font><font color="#CCCCCC"> they're running it at</font>

694
00:25:52,710 --> 00:25:57,480
review<font color="#CCCCCC"> were</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> Capcom</font><font color="#E5E5E5"> that I was able</font>

695
00:25:54,870 --> 00:26:00,389
<font color="#E5E5E5">to find through recon this company ran a</font>

696
00:25:57,480 --> 00:26:02,549
bug bounty<font color="#E5E5E5"> program and so I looked up</font>

697
00:26:00,390 --> 00:26:03,960
review board I saw what<font color="#E5E5E5"> it</font><font color="#CCCCCC"> was it was a</font>

698
00:26:02,549 --> 00:26:05,429
code review<font color="#CCCCCC"> tool I pulled it down</font><font color="#E5E5E5"> and</font>

699
00:26:03,960 --> 00:26:07,140
<font color="#CCCCCC">ran it locally I had</font><font color="#E5E5E5"> access</font><font color="#CCCCCC"> to the</font>

700
00:26:05,429 --> 00:26:08,820
source code<font color="#CCCCCC"> and I started</font><font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for</font>

701
00:26:07,140 --> 00:26:10,440
web bugs<font color="#E5E5E5"> and of course it's a web</font>

702
00:26:08,820 --> 00:26:12,240
application<font color="#CCCCCC"> and it's a web application</font>

703
00:26:10,440 --> 00:26:14,010
<font color="#CCCCCC">that not a lot of security researchers</font>

704
00:26:12,240 --> 00:26:15,450
<font color="#CCCCCC">are looking at so it was filled with web</font>

705
00:26:14,010 --> 00:26:17,940
bugs ahead cross-site scripting and

706
00:26:15,450 --> 00:26:19,140
cross-site request forgery<font color="#CCCCCC"> and because</font>

707
00:26:17,940 --> 00:26:21,659
it<font color="#E5E5E5"> was white box they were relatively</font>

708
00:26:19,140 --> 00:26:23,340
<font color="#CCCCCC">easy to find</font><font color="#E5E5E5"> so when we kind of</font><font color="#CCCCCC"> combined</font>

709
00:26:21,659 --> 00:26:25,140
all this<font color="#E5E5E5"> together what we end up</font><font color="#CCCCCC"> with is</font>

710
00:26:23,340 --> 00:26:27,959
a link<font color="#E5E5E5"> that if somebody this company</font>

711
00:26:25,140 --> 00:26:29,520
clicks<font color="#E5E5E5"> we can use cross-site crypt</font>

712
00:26:27,960 --> 00:26:31,350
scripting and cross-site request forgery

713
00:26:29,520 --> 00:26:33,299
to completely steal all the source code

714
00:26:31,350 --> 00:26:35,309
<font color="#E5E5E5">at this company so we have a link that</font>

715
00:26:33,299 --> 00:26:38,639
if somebody clicks<font color="#E5E5E5"> immediately I just</font>

716
00:26:35,309 --> 00:26:39,309
<font color="#CCCCCC">get all the source code</font><font color="#E5E5E5"> we see here when</font>

717
00:26:38,640 --> 00:26:40,899
I<font color="#CCCCCC"> disclose through</font>

718
00:26:39,309 --> 00:26:43,418
you<font color="#CCCCCC"> bored there great about it they</font>

719
00:26:40,899 --> 00:26:45,729
fixed<font color="#E5E5E5"> it really quick</font><font color="#CCCCCC"> and then when we</font>

720
00:26:43,419 --> 00:26:47,440
<font color="#E5E5E5">top stack again and move back to</font><font color="#CCCCCC"> the bug</font>

721
00:26:45,730 --> 00:26:49,419
bounty<font color="#E5E5E5"> the response was kind of</font>

722
00:26:47,440 --> 00:26:51,309
interesting they said well we're running

723
00:26:49,419 --> 00:26:52,389
<font color="#E5E5E5">this internally and we appreciate you</font>

724
00:26:51,309 --> 00:26:54,309
reaching out to<font color="#CCCCCC"> reviewer and getting</font>

725
00:26:52,389 --> 00:26:56,229
this<font color="#CCCCCC"> fixed but we didn't</font><font color="#E5E5E5"> really write</font>

726
00:26:54,309 --> 00:26:58,418
<font color="#CCCCCC">this code</font><font color="#E5E5E5"> and it doesn't really</font><font color="#CCCCCC"> Drive</font>

727
00:26:56,230 --> 00:27:02,070
well with our<font color="#E5E5E5"> scope so we're not gonna</font>

728
00:26:58,419 --> 00:27:06,039
pay<font color="#CCCCCC"> you</font><font color="#E5E5E5"> but thanks for submitting</font><font color="#CCCCCC"> Wow</font>

729
00:27:02,070 --> 00:27:07,509
again<font color="#CCCCCC"> this</font><font color="#E5E5E5"> pattern is gonna get a little</font>

730
00:27:06,039 --> 00:27:10,360
<font color="#CCCCCC">repetitive</font><font color="#E5E5E5"> but there was another company</font>

731
00:27:07,509 --> 00:27:12,940
running a tool called geo CD<font color="#CCCCCC"> DevOps</font>

732
00:27:10,360 --> 00:27:15,309
<font color="#CCCCCC">grumpy Network I had no idea what</font><font color="#E5E5E5"> Geo CD</font>

733
00:27:12,940 --> 00:27:16,960
was so I googled<font color="#CCCCCC"> it I found it was an</font>

734
00:27:15,309 --> 00:27:20,320
<font color="#E5E5E5">open source thing</font><font color="#CCCCCC"> pulled down that</font>

735
00:27:16,960 --> 00:27:21,879
<font color="#E5E5E5">source</font><font color="#CCCCCC"> code I run it locally and</font><font color="#E5E5E5"> by</font>

736
00:27:20,320 --> 00:27:24,820
default<font color="#E5E5E5"> it has no authentication so</font>

737
00:27:21,879 --> 00:27:28,330
that's off to a good<font color="#E5E5E5"> start</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to</font>

738
00:27:24,820 --> 00:27:31,809
proxy requests and with enough poking at

739
00:27:28,330 --> 00:27:34,360
<font color="#CCCCCC">it I find that it's got a particular</font>

740
00:27:31,809 --> 00:27:36,908
<font color="#E5E5E5">endpoint that</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> not validating CSRF</font>

741
00:27:34,360 --> 00:27:38,439
tokens<font color="#CCCCCC"> the application was generally</font>

742
00:27:36,909 --> 00:27:39,759
good about<font color="#E5E5E5"> CSRF but there was this one</font>

743
00:27:38,440 --> 00:27:43,840
<font color="#CCCCCC">endpoint that just wasn't validating the</font>

744
00:27:39,759 --> 00:27:47,740
token<font color="#CCCCCC"> and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> endpoint was to build an</font>

745
00:27:43,840 --> 00:27:49,869
environment<font color="#CCCCCC"> not important and so when we</font>

746
00:27:47,740 --> 00:27:52,529
put<font color="#CCCCCC"> all this together what we end up</font>

747
00:27:49,869 --> 00:27:55,899
<font color="#E5E5E5">with is if somebody clicks a</font><font color="#CCCCCC"> link then</font>

748
00:27:52,529 --> 00:27:58,090
we can build an environment internally

749
00:27:55,899 --> 00:28:01,229
at this company<font color="#E5E5E5"> by geo</font><font color="#CCCCCC"> CDs definition of</font>

750
00:27:58,090 --> 00:28:03,309
what an environment is not super great

751
00:28:01,230 --> 00:28:04,570
<font color="#E5E5E5">what happened</font><font color="#CCCCCC"> here is I used somebody</font>

752
00:28:03,309 --> 00:28:06,009
<font color="#E5E5E5">that was working at this</font><font color="#CCCCCC"> company</font><font color="#E5E5E5"> and I</font>

753
00:28:04,570 --> 00:28:07,029
reached out to them<font color="#CCCCCC"> and I explained this</font>

754
00:28:06,009 --> 00:28:08,740
<font color="#E5E5E5">whole thing to them and I said</font><font color="#CCCCCC"> I know</font>

755
00:28:07,029 --> 00:28:09,850
you<font color="#CCCCCC"> have a bug bounty like</font><font color="#E5E5E5"> I had a bad</font>

756
00:28:08,740 --> 00:28:11,379
<font color="#CCCCCC">experience before should I bother</font>

757
00:28:09,850 --> 00:28:13,119
submitting this and he said you know

758
00:28:11,379 --> 00:28:15,158
<font color="#E5E5E5">like I understand where the other</font>

759
00:28:13,119 --> 00:28:16,689
<font color="#E5E5E5">company</font><font color="#CCCCCC"> was coming from like this</font><font color="#E5E5E5"> this</font>

760
00:28:15,159 --> 00:28:17,980
<font color="#E5E5E5">really you know isn't gonna be</font><font color="#CCCCCC"> in scope</font>

761
00:28:16,690 --> 00:28:19,269
and<font color="#E5E5E5"> we didn't write that code</font><font color="#CCCCCC"> so don't</font>

762
00:28:17,980 --> 00:28:23,440
<font color="#CCCCCC">bother submitting but thank you</font><font color="#E5E5E5"> for</font>

763
00:28:19,269 --> 00:28:27,190
<font color="#CCCCCC">finding this</font><font color="#E5E5E5"> and so I didn't one more</font>

764
00:28:23,440 --> 00:28:28,929
time same exact process<font color="#E5E5E5"> we find some</font>

765
00:28:27,190 --> 00:28:32,039
company running some<font color="#CCCCCC"> open-source thing</font>

766
00:28:28,929 --> 00:28:34,210
<font color="#E5E5E5">in this case the thing is actually</font>

767
00:28:32,039 --> 00:28:36,639
<font color="#E5E5E5">relatively older piece of software the</font>

768
00:28:34,210 --> 00:28:39,190
source code is on<font color="#CCCCCC"> SourceForge</font><font color="#E5E5E5"> global</font>

769
00:28:36,639 --> 00:28:40,240
site company<font color="#E5E5E5"> comm and again we're gonna</font>

770
00:28:39,190 --> 00:28:41,649
pull the source code down we're gonna

771
00:28:40,240 --> 00:28:44,049
<font color="#E5E5E5">run it locally and we're gonna pen test</font>

772
00:28:41,649 --> 00:28:46,449
it and hear what we<font color="#E5E5E5"> actually find are</font>

773
00:28:44,049 --> 00:28:47,379
some<font color="#CCCCCC"> worst</font><font color="#E5E5E5"> types of</font><font color="#CCCCCC"> vulnerabilities we</font>

774
00:28:46,450 --> 00:28:50,320
find cross-site scripting cross-site

775
00:28:47,379 --> 00:28:51,668
request forgery<font color="#CCCCCC"> we also find remote code</font>

776
00:28:50,320 --> 00:28:53,830
execution through the file<font color="#E5E5E5"> upload and</font>

777
00:28:51,669 --> 00:28:56,870
<font color="#E5E5E5">some other serious bugs</font>

778
00:28:53,830 --> 00:28:58,879
so when we put all this together<font color="#CCCCCC"> what we</font>

779
00:28:56,870 --> 00:29:00,679
have<font color="#CCCCCC"> end to end is someone clicks a link</font>

780
00:28:58,880 --> 00:29:02,660
<font color="#CCCCCC">and then</font><font color="#E5E5E5"> we use the cross</font><font color="#CCCCCC"> side scripting</font>

781
00:29:00,680 --> 00:29:04,580
just directly install a web shell and

782
00:29:02,660 --> 00:29:07,130
figure the web shell<font color="#E5E5E5"> and now at this</font>

783
00:29:04,580 --> 00:29:08,689
point<font color="#E5E5E5"> we've got somebody who clicks a</font>

784
00:29:07,130 --> 00:29:12,350
link<font color="#E5E5E5"> and immediately I have a shell in</font>

785
00:29:08,690 --> 00:29:14,270
their internal<font color="#E5E5E5"> company</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is obviously</font>

786
00:29:12,350 --> 00:29:16,790
pretty severe impact and when I

787
00:29:14,270 --> 00:29:18,889
presented this to<font color="#E5E5E5"> the company</font><font color="#CCCCCC"> they</font>

788
00:29:16,790 --> 00:29:21,320
<font color="#CCCCCC">definitely got the the picture and the</font>

789
00:29:18,890 --> 00:29:25,160
<font color="#E5E5E5">scope</font><font color="#CCCCCC"> of impact and they</font><font color="#E5E5E5"> compensated</font>

790
00:29:21,320 --> 00:29:26,929
pretty well<font color="#CCCCCC"> so the results from</font>

791
00:29:25,160 --> 00:29:29,840
submitting<font color="#E5E5E5"> these types of bugs to bug</font>

792
00:29:26,930 --> 00:29:31,490
bounties has been kind<font color="#E5E5E5"> of varied and we</font>

793
00:29:29,840 --> 00:29:33,530
could<font color="#E5E5E5"> talk about that more</font><font color="#CCCCCC"> in a bit</font><font color="#E5E5E5"> but</font>

794
00:29:31,490 --> 00:29:35,360
in this particular<font color="#E5E5E5"> case the company was</font>

795
00:29:33,530 --> 00:29:36,649
appreciative of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> finding but</font>

796
00:29:35,360 --> 00:29:38,780
hopefully I've gotten the<font color="#E5E5E5"> point across</font>

797
00:29:36,650 --> 00:29:41,000
<font color="#CCCCCC">that</font><font color="#E5E5E5"> this is really</font><font color="#CCCCCC"> easy to</font><font color="#E5E5E5"> do if you</font>

798
00:29:38,780 --> 00:29:42,410
want to<font color="#E5E5E5"> target a company and you want to</font>

799
00:29:41,000 --> 00:29:44,270
<font color="#E5E5E5">get a foothold into an environment and</font>

800
00:29:42,410 --> 00:29:45,980
<font color="#E5E5E5">you</font><font color="#CCCCCC"> want to constrain yourself to the</font>

801
00:29:44,270 --> 00:29:48,680
foothold<font color="#E5E5E5"> is only a person clicking a</font>

802
00:29:45,980 --> 00:29:52,640
link it's not that much effort<font color="#E5E5E5"> to be</font>

803
00:29:48,680 --> 00:29:54,680
able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do what I showed so um you know</font>

804
00:29:52,640 --> 00:29:56,780
<font color="#E5E5E5">obviously going back to to this same</font>

805
00:29:54,680 --> 00:29:58,400
problem though we do have still some

806
00:29:56,780 --> 00:30:00,379
<font color="#CCCCCC">challenges with</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> limited time window</font>

807
00:29:58,400 --> 00:30:02,500
<font color="#CCCCCC">and</font><font color="#E5E5E5"> there are other</font><font color="#CCCCCC"> options that</font><font color="#E5E5E5"> we have</font>

808
00:30:00,380 --> 00:30:04,490
<font color="#CCCCCC">available to us such as</font><font color="#E5E5E5"> service workers</font>

809
00:30:02,500 --> 00:30:05,990
similarly we don't have time to go<font color="#E5E5E5"> into</font>

810
00:30:04,490 --> 00:30:07,760
this in depth of service workers is a

811
00:30:05,990 --> 00:30:09,470
relatively new browser capability that

812
00:30:07,760 --> 00:30:12,830
actually allows you<font color="#E5E5E5"> to run JavaScript</font>

813
00:30:09,470 --> 00:30:14,240
<font color="#CCCCCC">after the tabs have closed</font><font color="#E5E5E5"> typically you</font>

814
00:30:12,830 --> 00:30:16,790
only<font color="#E5E5E5"> get</font><font color="#CCCCCC"> about a window</font><font color="#E5E5E5"> of five minutes</font>

815
00:30:14,240 --> 00:30:18,710
<font color="#CCCCCC">but some</font><font color="#E5E5E5"> great researchers</font><font color="#CCCCCC"> Emanuel law</font>

816
00:30:16,790 --> 00:30:20,510
from<font color="#E5E5E5"> Google and</font><font color="#CCCCCC"> claudio from Zedeck</font>

817
00:30:18,710 --> 00:30:22,310
security out of New Zealand<font color="#CCCCCC"> they've</font>

818
00:30:20,510 --> 00:30:24,320
<font color="#E5E5E5">figured out</font><font color="#CCCCCC"> how you can do it for</font><font color="#E5E5E5"> 30</font>

819
00:30:22,310 --> 00:30:26,419
minutes<font color="#CCCCCC"> and running 30 minutes of</font>

820
00:30:24,320 --> 00:30:29,780
<font color="#E5E5E5">JavaScript after the window has closed</font>

821
00:30:26,420 --> 00:30:32,240
<font color="#E5E5E5">is obviously petrifying</font><font color="#CCCCCC"> and they allow</font>

822
00:30:29,780 --> 00:30:34,670
certain<font color="#E5E5E5"> degrees</font><font color="#CCCCCC"> of you know cross-origin</font>

823
00:30:32,240 --> 00:30:36,140
requests so you know in this instance it

824
00:30:34,670 --> 00:30:38,210
can<font color="#E5E5E5"> only</font><font color="#CCCCCC"> run</font><font color="#E5E5E5"> I have a TLS</font><font color="#CCCCCC"> and it can't</font>

825
00:30:36,140 --> 00:30:40,280
do mixed content<font color="#CCCCCC"> or no blocking requests</font>

826
00:30:38,210 --> 00:30:42,500
it's funny because the DNS rebinding<font color="#CCCCCC"> is</font>

827
00:30:40,280 --> 00:30:44,840
only over<font color="#E5E5E5"> non TLS and the</font><font color="#CCCCCC"> servers</font>

828
00:30:42,500 --> 00:30:46,880
workers<font color="#E5E5E5"> are only over TLS</font><font color="#CCCCCC"> so we have a</font>

829
00:30:44,840 --> 00:30:48,620
nice portfolio<font color="#E5E5E5"> of attacks so using these</font>

830
00:30:46,880 --> 00:30:50,510
you know we can do things like we can

831
00:30:48,620 --> 00:30:52,969
<font color="#E5E5E5">potentially spray all the HTTP</font><font color="#CCCCCC"> hosts</font>

832
00:30:50,510 --> 00:30:54,650
that<font color="#E5E5E5"> we know about from our</font><font color="#CCCCCC"> recon</font><font color="#E5E5E5"> we can</font>

833
00:30:52,970 --> 00:30:55,850
<font color="#E5E5E5">potentially spray the loop back as well</font>

834
00:30:54,650 --> 00:30:57,320
because quite<font color="#E5E5E5"> often people will run</font>

835
00:30:55,850 --> 00:30:59,629
applications and they actually<font color="#CCCCCC"> listen on</font>

836
00:30:57,320 --> 00:31:00,950
the local local loopback<font color="#CCCCCC"> I'm not too</font>

837
00:30:59,630 --> 00:31:02,150
sure how<font color="#E5E5E5"> many people realize that</font><font color="#CCCCCC"> T</font>

838
00:31:00,950 --> 00:31:05,930
<font color="#E5E5E5">marks</font>

839
00:31:02,150 --> 00:31:07,820
a local loopback<font color="#E5E5E5"> for Windows it does</font><font color="#CCCCCC"> we</font>

840
00:31:05,930 --> 00:31:09,530
should<font color="#CCCCCC"> also mention that there is an</font>

841
00:31:07,820 --> 00:31:11,240
exception<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> TOS rule and that is</font>

842
00:31:09,530 --> 00:31:14,540
loopback<font color="#CCCCCC"> service</font><font color="#E5E5E5"> workers do allow you to</font>

843
00:31:11,240 --> 00:31:16,730
<font color="#E5E5E5">make non TLS requests</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> cool I'm so</font>

844
00:31:14,540 --> 00:31:18,710
like<font color="#CCCCCC"> enclosing really quick</font><font color="#E5E5E5"> you know</font>

845
00:31:16,730 --> 00:31:20,410
just reframing these problems browsers

846
00:31:18,710 --> 00:31:23,330
obviously have access to multiple

847
00:31:20,410 --> 00:31:24,440
<font color="#E5E5E5">contexts</font><font color="#CCCCCC"> and if you're</font><font color="#E5E5E5"> using you know if</font>

848
00:31:23,330 --> 00:31:25,669
you're<font color="#E5E5E5"> doing a readiness assessment we</font>

849
00:31:24,440 --> 00:31:27,290
<font color="#CCCCCC">have a pretty open scope you should</font>

850
00:31:25,670 --> 00:31:30,500
definitely<font color="#E5E5E5"> be using this as part of your</font>

851
00:31:27,290 --> 00:31:32,240
assessment<font color="#CCCCCC"> recon really really helps and</font>

852
00:31:30,500 --> 00:31:34,430
quite often this is like a different<font color="#CCCCCC"> way</font>

853
00:31:32,240 --> 00:31:35,660
to exploit recon because red teamers are

854
00:31:34,430 --> 00:31:37,160
generally<font color="#E5E5E5"> doing this but now you've</font>

855
00:31:35,660 --> 00:31:40,490
actually<font color="#E5E5E5"> got ways to be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> send</font>

856
00:31:37,160 --> 00:31:41,900
requests to internal hosts<font color="#CCCCCC"> new browser</font>

857
00:31:40,490 --> 00:31:44,150
features<font color="#E5E5E5"> are obviously really</font>

858
00:31:41,900 --> 00:31:45,620
interesting<font color="#CCCCCC"> webassembly</font><font color="#E5E5E5"> and a bunch of</font>

859
00:31:44,150 --> 00:31:48,140
other things<font color="#E5E5E5"> are coming down</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> pipeline</font>

860
00:31:45,620 --> 00:31:52,340
<font color="#E5E5E5">so take the time to research those</font>

861
00:31:48,140 --> 00:31:53,570
things and and<font color="#E5E5E5"> I think one point that I</font>

862
00:31:52,340 --> 00:31:56,929
really<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> drive home here is if</font>

863
00:31:53,570 --> 00:32:00,110
you're<font color="#E5E5E5"> running a bunch of open source in</font>

864
00:31:56,930 --> 00:32:02,420
<font color="#CCCCCC">your internal network like we</font><font color="#E5E5E5"> really</font>

865
00:32:00,110 --> 00:32:04,189
<font color="#E5E5E5">consider either putting it in scope for</font>

866
00:32:02,420 --> 00:32:06,620
the bug bounty or putting some effort

867
00:32:04,190 --> 00:32:09,200
specifically into improving<font color="#E5E5E5"> the</font><font color="#CCCCCC"> security</font>

868
00:32:06,620 --> 00:32:10,699
of<font color="#E5E5E5"> that open source software</font><font color="#CCCCCC"> submit your</font>

869
00:32:09,200 --> 00:32:13,250
patch<font color="#E5E5E5"> upstream and get other companies</font>

870
00:32:10,700 --> 00:32:15,500
to be<font color="#CCCCCC"> more secure</font><font color="#E5E5E5"> as a result a lot</font><font color="#CCCCCC"> of</font>

871
00:32:13,250 --> 00:32:18,200
<font color="#CCCCCC">people just blindly run</font><font color="#E5E5E5"> open source</font>

872
00:32:15,500 --> 00:32:20,090
stuff internally<font color="#CCCCCC"> without thinking about</font>

873
00:32:18,200 --> 00:32:21,560
<font color="#CCCCCC">it</font><font color="#E5E5E5"> too much</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> the reality</font><font color="#CCCCCC"> is those</font>

874
00:32:20,090 --> 00:32:24,740
projects don't<font color="#E5E5E5"> have the funding or the</font>

875
00:32:21,560 --> 00:32:26,629
resources<font color="#E5E5E5"> to secure them awesome</font><font color="#CCCCCC"> thank</font>

876
00:32:24,740 --> 00:32:27,830
you everyone and thanks to these people

877
00:32:26,630 --> 00:32:30,260
<font color="#CCCCCC">um if you want to come and</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> to us</font>

878
00:32:27,830 --> 00:32:32,840
for questions where the<font color="#E5E5E5"> booth called</font>

879
00:32:30,260 --> 00:32:34,920
it's a<font color="#CCCCCC"> cruise booth we'll be outside for</font>

880
00:32:32,840 --> 00:32:42,448
a<font color="#E5E5E5"> bit as well</font><font color="#CCCCCC"> thanks everyone</font>

881
00:32:34,920 --> 00:32:42,449
[Applause]

