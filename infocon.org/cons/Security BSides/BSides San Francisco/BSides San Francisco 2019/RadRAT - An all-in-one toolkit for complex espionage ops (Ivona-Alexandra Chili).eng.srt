1
00:00:00,030 --> 00:00:05,549
last talk of the day<font color="#E5E5E5"> and the nice part</font>

2
00:00:03,659 --> 00:00:07,919
<font color="#CCCCCC">about that</font><font color="#E5E5E5"> means that you guys have a</font>

3
00:00:05,549 --> 00:00:10,580
few more minutes<font color="#CCCCCC"> left to quick run over</font>

4
00:00:07,919 --> 00:00:14,280
to coat check and go buy a<font color="#E5E5E5"> t-shirt or</font>

5
00:00:10,580 --> 00:00:17,550
donate a t-shirt<font color="#E5E5E5"> by giving the</font><font color="#CCCCCC"> proceeds</font>

6
00:00:14,280 --> 00:00:25,259
to hack the hood hackers for charity<font color="#E5E5E5"> or</font>

7
00:00:17,550 --> 00:00:27,840
<font color="#E5E5E5">the e</font><font color="#CCCCCC"> F</font><font color="#E5E5E5"> now with that being said we get</font>

8
00:00:25,260 --> 00:00:31,349
<font color="#E5E5E5">to listen to a very interesting talk</font>

9
00:00:27,840 --> 00:00:33,780
<font color="#CCCCCC">we're back in the day</font><font color="#E5E5E5"> my roommates and I</font>

10
00:00:31,349 --> 00:00:34,920
would install rats<font color="#E5E5E5"> on our computers</font>

11
00:00:33,780 --> 00:00:37,320
while we would compete<font color="#CCCCCC"> and</font>

12
00:00:34,920 --> 00:00:39,270
<font color="#E5E5E5">counter-strike just so when they</font><font color="#CCCCCC"> think</font>

13
00:00:37,320 --> 00:00:40,739
we<font color="#E5E5E5"> have each other ready to kill you</font>

14
00:00:39,270 --> 00:00:42,120
<font color="#E5E5E5">hope we move their mouse we suddenly</font>

15
00:00:40,739 --> 00:00:45,269
started jiggling<font color="#E5E5E5"> them around you're like</font>

16
00:00:42,120 --> 00:00:46,589
<font color="#E5E5E5">no so as a result they started</font><font color="#CCCCCC"> getting</font>

17
00:00:45,270 --> 00:00:48,450
more interesting as you might imagine

18
00:00:46,590 --> 00:00:50,430
roommates start to escalate<font color="#E5E5E5"> between each</font>

19
00:00:48,450 --> 00:00:52,620
other<font color="#E5E5E5"> and before you know it we have</font>

20
00:00:50,430 --> 00:00:54,269
<font color="#E5E5E5">government-sponsored rats and all of our</font>

21
00:00:52,620 --> 00:00:56,820
computers and<font color="#CCCCCC"> you know we've spent</font><font color="#E5E5E5"> all</font>

22
00:00:54,270 --> 00:00:58,920
weekend<font color="#E5E5E5"> trying to ferret them out</font><font color="#CCCCCC"> wash</font>

23
00:00:56,820 --> 00:01:01,410
<font color="#E5E5E5">rinse repeat</font><font color="#CCCCCC"> so I look forward to</font>

24
00:00:58,920 --> 00:01:03,660
hearing<font color="#CCCCCC"> from Ivana speaking about a very</font>

25
00:01:01,410 --> 00:01:07,110
interesting<font color="#CCCCCC"> grant</font><font color="#E5E5E5"> that has not received</font>

26
00:01:03,660 --> 00:01:09,710
a lot of<font color="#E5E5E5"> attention</font><font color="#CCCCCC"> and yet is used in</font>

27
00:01:07,110 --> 00:01:13,560
many<font color="#CCCCCC"> places that you</font><font color="#E5E5E5"> would</font><font color="#CCCCCC"> never</font><font color="#E5E5E5"> expect</font>

28
00:01:09,710 --> 00:01:15,389
hello everyone today I'm<font color="#CCCCCC"> here to say a</font>

29
00:01:13,560 --> 00:01:17,909
<font color="#E5E5E5">few words about the research I did</font>

30
00:01:15,390 --> 00:01:18,689
<font color="#E5E5E5">recently with</font><font color="#CCCCCC"> my colleague Edward about</font>

31
00:01:17,909 --> 00:01:21,600
the rat<font color="#E5E5E5"> valve</font>

32
00:01:18,689 --> 00:01:23,820
<font color="#E5E5E5">malware that</font><font color="#CCCCCC"> was used</font><font color="#E5E5E5"> for accelerating</font>

33
00:01:21,600 --> 00:01:25,830
sensitive information<font color="#E5E5E5"> and monitoring</font>

34
00:01:23,820 --> 00:01:31,020
victims across large<font color="#E5E5E5"> network</font>

35
00:01:25,830 --> 00:01:33,298
organizations some facts<font color="#CCCCCC"> about me I'm a</font>

36
00:01:31,020 --> 00:01:35,369
forensics engineer<font color="#E5E5E5"> and</font><font color="#CCCCCC"> B defender with</font>

37
00:01:33,299 --> 00:01:37,650
<font color="#E5E5E5">four years of expertise in the cyber</font>

38
00:01:35,369 --> 00:01:40,640
threat intelligence lab and also I'm a

39
00:01:37,650 --> 00:01:42,180
<font color="#CCCCCC">master's student</font><font color="#E5E5E5"> in information security</font>

40
00:01:40,640 --> 00:01:44,369
<font color="#E5E5E5">who are we</font>

41
00:01:42,180 --> 00:01:47,759
well<font color="#E5E5E5"> the defender is a security product</font>

42
00:01:44,369 --> 00:01:51,780
<font color="#E5E5E5">founded in 2001 with almost</font><font color="#CCCCCC"> 20</font><font color="#E5E5E5"> years of</font>

43
00:01:47,759 --> 00:01:55,200
<font color="#E5E5E5">security expertise we protect over 500</font>

44
00:01:51,780 --> 00:01:57,390
million<font color="#E5E5E5"> devices in 150 countries</font><font color="#CCCCCC"> also</font>

45
00:01:55,200 --> 00:01:59,909
<font color="#CCCCCC">you can</font><font color="#E5E5E5"> find us in many of the top</font>

46
00:01:57,390 --> 00:02:03,180
<font color="#E5E5E5">security products that integrate our</font>

47
00:01:59,909 --> 00:02:05,430
technology<font color="#E5E5E5"> last but not least we are</font><font color="#CCCCCC"> a</font>

48
00:02:03,180 --> 00:02:07,380
<font color="#E5E5E5">community of passionate researchers</font>

49
00:02:05,430 --> 00:02:09,929
about machine learning<font color="#CCCCCC"> and artificial</font>

50
00:02:07,380 --> 00:02:13,859
intelligence<font color="#CCCCCC"> and all our</font><font color="#E5E5E5"> studies are</font>

51
00:02:09,929 --> 00:02:16,530
integrated also in our<font color="#E5E5E5"> technology</font>

52
00:02:13,860 --> 00:02:18,540
the agenda<font color="#CCCCCC"> for today is quite simple</font>

53
00:02:16,530 --> 00:02:21,000
<font color="#E5E5E5">well we are going to review</font><font color="#CCCCCC"> some general</font>

54
00:02:18,540 --> 00:02:22,920
aspects about<font color="#E5E5E5"> the case then we are going</font>

55
00:02:21,000 --> 00:02:25,620
<font color="#E5E5E5">to dive into some</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> technical details</font>

56
00:02:22,920 --> 00:02:28,019
<font color="#CCCCCC">and some interesting facts regarding the</font>

57
00:02:25,620 --> 00:02:31,610
telemetry<font color="#CCCCCC"> then in the</font><font color="#E5E5E5"> end we'll close</font>

58
00:02:28,020 --> 00:02:33,690
with<font color="#E5E5E5"> with some conclusions</font><font color="#CCCCCC"> very</font>

59
00:02:31,610 --> 00:02:36,000
<font color="#CCCCCC">interesting</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> that this piece</font><font color="#E5E5E5"> of</font>

60
00:02:33,690 --> 00:02:39,329
<font color="#CCCCCC">Mallard has been</font><font color="#E5E5E5"> operational since at</font>

61
00:02:36,000 --> 00:02:41,310
least 2013<font color="#CCCCCC"> but has gone unnoticed and</font>

62
00:02:39,330 --> 00:02:43,980
undocumented<font color="#E5E5E5"> by the research community</font>

63
00:02:41,310 --> 00:02:48,780
<font color="#CCCCCC">so let's take an overview of</font><font color="#E5E5E5"> the smaller</font>

64
00:02:43,980 --> 00:02:50,850
features and capabilities<font color="#E5E5E5"> this binary</font>

65
00:02:48,780 --> 00:02:53,580
file<font color="#E5E5E5"> is comprised of a set of tools</font>

66
00:02:50,850 --> 00:02:56,070
either<font color="#E5E5E5"> embedded or downloaded along the</font>

67
00:02:53,580 --> 00:02:58,709
way that<font color="#E5E5E5"> the attacking party</font><font color="#CCCCCC"> uses for</font>

68
00:02:56,070 --> 00:03:01,019
various malicious purposes<font color="#CCCCCC"> it contains</font>

69
00:02:58,709 --> 00:03:02,670
more than<font color="#E5E5E5"> 90 commands including methods</font>

70
00:03:01,020 --> 00:03:04,920
<font color="#E5E5E5">of credential harvesting and</font>

71
00:03:02,670 --> 00:03:07,739
<font color="#CCCCCC">exaggeration</font><font color="#E5E5E5"> mechanism to</font><font color="#CCCCCC"> avoid</font>

72
00:03:04,920 --> 00:03:10,230
detection<font color="#CCCCCC"> several ways of contacting</font><font color="#E5E5E5"> the</font>

73
00:03:07,740 --> 00:03:14,280
CNC server<font color="#E5E5E5"> and interesting lateral</font>

74
00:03:10,230 --> 00:03:16,769
movement mechanisms<font color="#E5E5E5"> the</font><font color="#CCCCCC"> toolkit is</font><font color="#E5E5E5"> made</font>

75
00:03:14,280 --> 00:03:19,800
of two main<font color="#E5E5E5"> components that perform most</font>

76
00:03:16,770 --> 00:03:26,160
<font color="#E5E5E5">read behavior</font><font color="#CCCCCC"> these two dll files will</font>

77
00:03:19,800 --> 00:03:28,230
both run as<font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> Services an</font>

78
00:03:26,160 --> 00:03:29,820
interesting aspect in the operation of

79
00:03:28,230 --> 00:03:32,640
this<font color="#E5E5E5"> threat is</font><font color="#CCCCCC"> that it behaves</font>

80
00:03:29,820 --> 00:03:34,890
<font color="#CCCCCC">differently based on its file name in</font>

81
00:03:32,640 --> 00:03:38,458
the<font color="#CCCCCC"> first</font><font color="#E5E5E5"> case the component will run in</font>

82
00:03:34,890 --> 00:03:40,320
<font color="#E5E5E5">installation mode</font><font color="#CCCCCC"> in the second case it</font>

83
00:03:38,459 --> 00:03:42,660
will<font color="#CCCCCC"> run in a mode that</font><font color="#E5E5E5"> will allow it to</font>

84
00:03:40,320 --> 00:03:45,299
inject<font color="#E5E5E5"> in every process running on the</font>

85
00:03:42,660 --> 00:03:47,700
system<font color="#CCCCCC"> denoting</font><font color="#E5E5E5"> a rootkit like behavior</font>

86
00:03:45,300 --> 00:03:49,680
so the purpose of<font color="#E5E5E5"> this component is</font>

87
00:03:47,700 --> 00:03:55,109
gathering<font color="#E5E5E5"> windows and network</font>

88
00:03:49,680 --> 00:03:57,720
credentials<font color="#E5E5E5"> basically there are two ways</font>

89
00:03:55,110 --> 00:04:00,450
<font color="#CCCCCC">the system can</font><font color="#E5E5E5"> get infected</font><font color="#CCCCCC"> the first</font>

90
00:03:57,720 --> 00:04:02,670
one is when it is compromised by the

91
00:04:00,450 --> 00:04:05,160
original<font color="#CCCCCC"> infection</font><font color="#E5E5E5"> vector let's call the</font>

92
00:04:02,670 --> 00:04:07,049
<font color="#E5E5E5">systems that the patient zero and the</font>

93
00:04:05,160 --> 00:04:08,640
installation component will write one of

94
00:04:07,050 --> 00:04:10,980
the two main<font color="#CCCCCC"> components of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> system</font>

95
00:04:08,640 --> 00:04:14,040
<font color="#E5E5E5">and will which will be further launched</font>

96
00:04:10,980 --> 00:04:15,780
<font color="#E5E5E5">as services in the second case if the</font>

97
00:04:14,040 --> 00:04:17,969
victim has been<font color="#E5E5E5"> compromised due to a</font>

98
00:04:15,780 --> 00:04:20,070
<font color="#E5E5E5">lateral movement operation the role of</font>

99
00:04:17,970 --> 00:04:22,800
the installation component will<font color="#CCCCCC"> be</font>

100
00:04:20,070 --> 00:04:27,659
played by<font color="#E5E5E5"> an already compromised machine</font>

101
00:04:22,800 --> 00:04:29,970
in the network apart from the<font color="#E5E5E5"> main</font><font color="#CCCCCC"> comm</font>

102
00:04:27,660 --> 00:04:32,190
there are also the secondary components

103
00:04:29,970 --> 00:04:35,220
that are<font color="#CCCCCC"> used only when needed</font><font color="#E5E5E5"> by the</font>

104
00:04:32,190 --> 00:04:37,770
<font color="#CCCCCC">rat in order to execute</font><font color="#E5E5E5"> additional</font><font color="#CCCCCC"> rad</font>

105
00:04:35,220 --> 00:04:40,050
<font color="#E5E5E5">commands or to invoke the main component</font>

106
00:04:37,770 --> 00:04:46,560
or to help the rat in itself update

107
00:04:40,050 --> 00:04:49,110
process the method of<font color="#CCCCCC"> choice</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> rat</font>

108
00:04:46,560 --> 00:04:53,550
rod employs<font color="#E5E5E5"> for persistence is via</font>

109
00:04:49,110 --> 00:04:55,770
services<font color="#E5E5E5"> so it may replace the</font>

110
00:04:53,550 --> 00:04:59,400
legitimate<font color="#CCCCCC"> dll file with the malicious</font>

111
00:04:55,770 --> 00:05:03,060
one or it may create<font color="#E5E5E5"> service the system</font>

112
00:04:59,400 --> 00:05:09,299
device manager through one to run<font color="#CCCCCC"> using</font>

113
00:05:03,060 --> 00:05:10,980
the malicious component<font color="#CCCCCC"> the parameters</font>

114
00:05:09,300 --> 00:05:12,780
used by the modern init malicious

115
00:05:10,980 --> 00:05:15,210
actions are stored in the<font color="#E5E5E5"> Windows</font>

116
00:05:12,780 --> 00:05:18,210
registry<font color="#CCCCCC"> and each</font><font color="#E5E5E5"> value under this key</font>

117
00:05:15,210 --> 00:05:20,969
serves a special purpose<font color="#E5E5E5"> so this also</font>

118
00:05:18,210 --> 00:05:24,419
can<font color="#CCCCCC"> be seen as a configuration</font><font color="#E5E5E5"> of the</font>

119
00:05:20,970 --> 00:05:26,580
<font color="#CCCCCC">maillard for example there is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> death</font>

120
00:05:24,420 --> 00:05:28,590
value which will<font color="#E5E5E5"> allow for process</font>

121
00:05:26,580 --> 00:05:31,620
injections<font color="#E5E5E5"> and used for harvesting</font>

122
00:05:28,590 --> 00:05:34,770
credentials<font color="#E5E5E5"> and hide resource usage the</font>

123
00:05:31,620 --> 00:05:36,990
MPD<font color="#E5E5E5"> parameter will enable mini cuts like</font>

124
00:05:34,770 --> 00:05:40,500
credential harvesting by injecting code

125
00:05:36,990 --> 00:05:42,840
into specific executive<font color="#CCCCCC"> balls</font><font color="#E5E5E5"> the empty</font>

126
00:05:40,500 --> 00:05:47,460
two parameter will allow for<font color="#CCCCCC"> lateral</font>

127
00:05:42,840 --> 00:05:49,710
<font color="#E5E5E5">movement capabilities other specific</font>

128
00:05:47,460 --> 00:05:51,840
parameters are set in order<font color="#E5E5E5"> to control</font>

129
00:05:49,710 --> 00:05:55,049
<font color="#E5E5E5">the</font><font color="#CCCCCC"> frequency of contact with a CNC</font>

130
00:05:51,840 --> 00:05:57,289
server or to<font color="#CCCCCC"> specify the day of the week</font>

131
00:05:55,050 --> 00:06:00,240
<font color="#E5E5E5">when it will call home to its server</font>

132
00:05:57,290 --> 00:06:02,100
<font color="#E5E5E5">last but not least there</font><font color="#CCCCCC"> is a log</font><font color="#E5E5E5"> of</font>

133
00:06:00,240 --> 00:06:04,170
update operations that the mother will

134
00:06:02,100 --> 00:06:08,550
keep in order<font color="#E5E5E5"> to keep</font><font color="#CCCCCC"> track of the</font>

135
00:06:04,170 --> 00:06:12,840
modifications done along<font color="#CCCCCC"> it run on the</font>

136
00:06:08,550 --> 00:06:15,030
system now<font color="#CCCCCC"> we'll take an in-depth look</font>

137
00:06:12,840 --> 00:06:17,099
in the steps the rat takes in order<font color="#E5E5E5"> to</font>

138
00:06:15,030 --> 00:06:20,880
establish communication with<font color="#E5E5E5"> the command</font>

139
00:06:17,100 --> 00:06:24,270
and<font color="#E5E5E5"> control infrastructure this threat</font>

140
00:06:20,880 --> 00:06:26,820
<font color="#E5E5E5">very</font><font color="#CCCCCC"> interesting is that</font><font color="#E5E5E5"> it avoids using</font>

141
00:06:24,270 --> 00:06:29,190
<font color="#E5E5E5">default DNS requests or organization</font>

142
00:06:26,820 --> 00:06:31,890
<font color="#CCCCCC">controlled DNS</font><font color="#E5E5E5"> referring the use of a</font>

143
00:06:29,190 --> 00:06:35,010
<font color="#CCCCCC">hard-coded</font><font color="#E5E5E5"> list of DNS name servers name</font>

144
00:06:31,890 --> 00:06:36,469
servers mainly<font color="#CCCCCC"> name servers of do I am</font>

145
00:06:35,010 --> 00:06:38,870
which is

146
00:06:36,470 --> 00:06:41,750
<font color="#CCCCCC">popular dynamic DNS provider</font><font color="#E5E5E5"> which seems</font>

147
00:06:38,870 --> 00:06:45,770
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be favored by this group</font><font color="#E5E5E5"> of threat</font>

148
00:06:41,750 --> 00:06:48,620
actors<font color="#E5E5E5"> also</font><font color="#CCCCCC"> named servers of MTNL which</font>

149
00:06:45,770 --> 00:06:51,950
is an Indian<font color="#E5E5E5"> ISP that actually owns the</font>

150
00:06:48,620 --> 00:06:53,990
<font color="#E5E5E5">attackers IP address also</font><font color="#CCCCCC"> as an</font>

151
00:06:51,950 --> 00:06:56,390
additional matter to avoid<font color="#CCCCCC"> restful DNS</font>

152
00:06:53,990 --> 00:06:59,330
<font color="#E5E5E5">resolutions the attacker would provide</font>

153
00:06:56,390 --> 00:07:06,710
an IP address via<font color="#E5E5E5"> hard-coded Google</font>

154
00:06:59,330 --> 00:07:08,539
Drive and<font color="#CCCCCC"> Dropbox URLs so there is the</font>

155
00:07:06,710 --> 00:07:11,900
resource available at Dropbox<font color="#E5E5E5"> or Google</font>

156
00:07:08,540 --> 00:07:14,630
Drive<font color="#CCCCCC"> hard-coded URLs</font><font color="#E5E5E5"> contains an IP</font>

157
00:07:11,900 --> 00:07:17,840
address<font color="#E5E5E5"> and along</font><font color="#CCCCCC"> with the flag</font><font color="#E5E5E5"> which</font>

158
00:07:14,630 --> 00:07:20,300
will indicate if it should enable the

159
00:07:17,840 --> 00:07:23,270
<font color="#E5E5E5">DNS resolution</font><font color="#CCCCCC"> or not in case the</font>

160
00:07:20,300 --> 00:07:25,280
connection<font color="#E5E5E5"> to the given IP will fail so</font>

161
00:07:23,270 --> 00:07:27,530
<font color="#E5E5E5">why this component has downloaded or</font>

162
00:07:25,280 --> 00:07:30,229
<font color="#E5E5E5">resolved an IP</font><font color="#CCCCCC"> address</font><font color="#E5E5E5"> it will send a</font>

163
00:07:27,530 --> 00:07:35,330
fingerprint of<font color="#CCCCCC"> the system consisting of</font>

164
00:07:30,230 --> 00:07:36,650
version<font color="#E5E5E5"> add hostname MAC address</font><font color="#CCCCCC"> or the</font>

165
00:07:35,330 --> 00:07:39,469
parameters that are stored<font color="#E5E5E5"> in the</font>

166
00:07:36,650 --> 00:07:45,500
registry<font color="#E5E5E5"> and also the business</font><font color="#CCCCCC"> of the</font>

167
00:07:39,470 --> 00:07:48,440
system radrats<font color="#E5E5E5"> current command control</font>

168
00:07:45,500 --> 00:07:51,260
set supports 92 instructions<font color="#E5E5E5"> some of</font>

169
00:07:48,440 --> 00:07:55,310
which are not<font color="#E5E5E5"> yet implemented</font><font color="#CCCCCC"> meaning</font>

170
00:07:51,260 --> 00:07:57,200
<font color="#E5E5E5">that the developer is still in working</font>

171
00:07:55,310 --> 00:08:00,140
<font color="#CCCCCC">progress with the development</font><font color="#E5E5E5"> of the</font>

172
00:07:57,200 --> 00:08:04,490
sweat<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> commands can be split into</font>

173
00:08:00,140 --> 00:08:06,740
multiple<font color="#E5E5E5"> categories like file and</font>

174
00:08:04,490 --> 00:08:09,020
registry operations credential

175
00:08:06,740 --> 00:08:11,690
harvesting<font color="#E5E5E5"> network operations</font>

176
00:08:09,020 --> 00:08:13,940
operational processes<font color="#E5E5E5"> and the system</font>

177
00:08:11,690 --> 00:08:15,890
information<font color="#E5E5E5"> lateral movement operations</font>

178
00:08:13,940 --> 00:08:18,350
update operations and implement the

179
00:08:15,890 --> 00:08:20,240
<font color="#E5E5E5">unimplemented operations and automatic</font>

180
00:08:18,350 --> 00:08:22,460
operation<font color="#E5E5E5"> but because there are a lot</font><font color="#CCCCCC"> of</font>

181
00:08:20,240 --> 00:08:24,050
commands<font color="#E5E5E5"> and this time is limited</font><font color="#CCCCCC"> we'll</font>

182
00:08:22,460 --> 00:08:27,530
highlight<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I'll analyze</font><font color="#E5E5E5"> the most</font>

183
00:08:24,050 --> 00:08:29,720
interesting categories and the ones are

184
00:08:27,530 --> 00:08:33,530
credential harvesting and lateral

185
00:08:29,720 --> 00:08:36,260
movement operations the<font color="#E5E5E5"> highest risk</font>

186
00:08:33,530 --> 00:08:38,900
<font color="#E5E5E5">that arises with</font><font color="#CCCCCC"> a red rat is it</font>

187
00:08:36,260 --> 00:08:41,210
<font color="#CCCCCC">powerful data theft capabilities so the</font>

188
00:08:38,900 --> 00:08:44,120
main focus<font color="#CCCCCC"> of this command is credential</font>

189
00:08:41,210 --> 00:08:46,940
tab theft<font color="#E5E5E5"> through ntlm harsh harvesting</font>

190
00:08:44,120 --> 00:08:48,709
through the<font color="#E5E5E5"> path</font><font color="#CCCCCC"> of hash technique</font><font color="#E5E5E5"> so it</font>

191
00:08:46,940 --> 00:08:49,780
allows the attacker to<font color="#E5E5E5"> authenticate to</font>

192
00:08:48,709 --> 00:08:54,219
<font color="#E5E5E5">remote server</font>

193
00:08:49,780 --> 00:08:56,650
only by using the ntlm hash<font color="#E5E5E5"> and not the</font>

194
00:08:54,220 --> 00:09:00,220
plaintext password as is usually the

195
00:08:56,650 --> 00:09:02,650
case<font color="#E5E5E5"> so it is very interesting this</font>

196
00:09:00,220 --> 00:09:03,160
technique because<font color="#CCCCCC"> it is very used by the</font>

197
00:09:02,650 --> 00:09:06,939
attacker

198
00:09:03,160 --> 00:09:08,469
and also another methods of<font color="#E5E5E5"> gaining</font>

199
00:09:06,940 --> 00:09:10,540
access to<font color="#E5E5E5"> sensitive data is by</font>

200
00:09:08,470 --> 00:09:15,460
decrypting the credentials stored under

201
00:09:10,540 --> 00:09:17,770
application that data directories apart

202
00:09:15,460 --> 00:09:19,840
from the credentials<font color="#E5E5E5"> they are they are</font>

203
00:09:17,770 --> 00:09:25,180
also<font color="#E5E5E5"> interested in browsing history and</font>

204
00:09:19,840 --> 00:09:27,100
network traffic another mean of

205
00:09:25,180 --> 00:09:29,770
credential harvesting is when the

206
00:09:27,100 --> 00:09:31,870
parameter debt from registry is enabled

207
00:09:29,770 --> 00:09:33,540
meaning<font color="#CCCCCC"> that functions responsible for</font>

208
00:09:31,870 --> 00:09:36,640
intercepting<font color="#E5E5E5"> usernames and passwords</font>

209
00:09:33,540 --> 00:09:37,630
<font color="#CCCCCC">entered into windows credential prompts</font>

210
00:09:36,640 --> 00:09:44,020
will be hooked

211
00:09:37,630 --> 00:09:45,400
so the<font color="#E5E5E5"> credential will be stolen last</font>

212
00:09:44,020 --> 00:09:47,319
but<font color="#E5E5E5"> not least there</font><font color="#CCCCCC"> is a group of</font>

213
00:09:45,400 --> 00:09:49,900
operations<font color="#E5E5E5"> that focus on network</font>

214
00:09:47,320 --> 00:09:52,540
<font color="#CCCCCC">discovery and network</font><font color="#E5E5E5"> traffic sniffing</font>

215
00:09:49,900 --> 00:09:55,030
through<font color="#CCCCCC"> ARP poisoning so the attacker</font>

216
00:09:52,540 --> 00:09:58,589
will choose multiple IPS between which

217
00:09:55,030 --> 00:10:02,230
the communication<font color="#E5E5E5"> will be</font><font color="#CCCCCC"> intercepted so</font>

218
00:09:58,589 --> 00:10:04,630
this component<font color="#E5E5E5"> that will redirect the</font>

219
00:10:02,230 --> 00:10:06,790
<font color="#CCCCCC">spoofed</font><font color="#E5E5E5"> art packets will you know</font>

220
00:10:04,630 --> 00:10:09,910
intercept<font color="#E5E5E5"> as may be connections or or</font>

221
00:10:06,790 --> 00:10:15,219
<font color="#CCCCCC">LDP sessions so it is very</font><font color="#E5E5E5"> possible to</font>

222
00:10:09,910 --> 00:10:18,459
intercept even credentials this

223
00:10:15,220 --> 00:10:20,530
<font color="#E5E5E5">credential harvesting is</font><font color="#CCCCCC"> done every 72</font>

224
00:10:18,460 --> 00:10:22,750
<font color="#E5E5E5">hours</font><font color="#CCCCCC"> and the amount of credential</font>

225
00:10:20,530 --> 00:10:25,120
collected goes hand in glove with<font color="#CCCCCC"> the</font>

226
00:10:22,750 --> 00:10:27,160
lateral<font color="#E5E5E5"> movement operations so in order</font>

227
00:10:25,120 --> 00:10:31,780
<font color="#E5E5E5">to affect other machine across the</font>

228
00:10:27,160 --> 00:10:34,900
network<font color="#E5E5E5"> the specific parameter from from</font>

229
00:10:31,780 --> 00:10:37,329
the registry will be set<font color="#E5E5E5"> namely</font><font color="#CCCCCC"> mt2 so</font>

230
00:10:34,900 --> 00:10:39,670
it can take values<font color="#CCCCCC"> from</font><font color="#E5E5E5"> 0 to</font><font color="#CCCCCC"> 3</font>

231
00:10:37,330 --> 00:10:42,580
<font color="#E5E5E5">representing</font><font color="#CCCCCC"> different ways to infect</font>

232
00:10:39,670 --> 00:10:44,140
<font color="#CCCCCC">adi target machine</font><font color="#E5E5E5"> so for example</font><font color="#CCCCCC"> 0</font>

233
00:10:42,580 --> 00:10:46,480
means<font color="#E5E5E5"> that no refraction</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> be</font>

234
00:10:44,140 --> 00:10:48,790
attempted<font color="#CCCCCC"> 1 means</font><font color="#E5E5E5"> that infection is</font>

235
00:10:46,480 --> 00:10:51,400
attempted with a current component using

236
00:10:48,790 --> 00:10:53,890
<font color="#E5E5E5">empty credentials so infection will be</font>

237
00:10:51,400 --> 00:10:56,530
attempted<font color="#E5E5E5"> for host for which credentials</font>

238
00:10:53,890 --> 00:11:00,569
are<font color="#CCCCCC"> already stored</font><font color="#E5E5E5"> and 3 infection will</font>

239
00:10:56,530 --> 00:11:06,220
be attempting all only for 64-bit hosts

240
00:11:00,570 --> 00:11:08,080
<font color="#E5E5E5">also</font><font color="#CCCCCC"> its third credentials after the</font>

241
00:11:06,220 --> 00:11:10,120
<font color="#E5E5E5">target has been</font><font color="#CCCCCC"> chosen one of the two</font>

242
00:11:08,080 --> 00:11:11,860
main<font color="#E5E5E5"> components will</font><font color="#CCCCCC"> be deployed to the</font>

243
00:11:10,120 --> 00:11:16,959
target machine<font color="#CCCCCC"> and will be</font><font color="#E5E5E5"> installed as</font>

244
00:11:11,860 --> 00:11:19,000
services also<font color="#CCCCCC"> allow the argument will be</font>

245
00:11:16,959 --> 00:11:21,010
specified<font color="#CCCCCC"> that represent the step of the</font>

246
00:11:19,000 --> 00:11:23,230
infection to be checked for it for

247
00:11:21,010 --> 00:11:24,790
<font color="#CCCCCC">example level</font><font color="#E5E5E5"> minus 5 it will try</font>

248
00:11:23,230 --> 00:11:26,020
connected to the Windows<font color="#CCCCCC"> registry on</font>

249
00:11:24,790 --> 00:11:28,110
that machine<font color="#CCCCCC"> and</font><font color="#E5E5E5"> check for</font><font color="#CCCCCC"> the</font>

250
00:11:26,020 --> 00:11:30,870
parameters that are<font color="#E5E5E5"> are already set</font>

251
00:11:28,110 --> 00:11:35,980
level<font color="#CCCCCC"> minus 2 will close the connection</font>

252
00:11:30,870 --> 00:11:39,850
<font color="#E5E5E5">existing on that machine</font><font color="#CCCCCC"> and so on now</font>

253
00:11:35,980 --> 00:11:43,060
we<font color="#CCCCCC"> are</font><font color="#E5E5E5"> going to review some very</font>

254
00:11:39,850 --> 00:11:46,660
interesting<font color="#E5E5E5"> facts about the</font><font color="#CCCCCC"> timeline</font><font color="#E5E5E5"> and</font>

255
00:11:43,060 --> 00:11:51,060
next<font color="#E5E5E5"> the telemetry the samples dating</font>

256
00:11:46,660 --> 00:11:54,240
from 2013 are compressed but unencrypted

257
00:11:51,060 --> 00:11:57,280
then we can distinguish<font color="#CCCCCC"> two campaigns in</font>

258
00:11:54,240 --> 00:11:59,470
2015 with an<font color="#E5E5E5"> audit</font><font color="#CCCCCC"> come with an updated</font>

259
00:11:57,280 --> 00:12:04,360
<font color="#E5E5E5">version of the</font><font color="#CCCCCC"> mother</font><font color="#E5E5E5"> that this time</font>

260
00:11:59,470 --> 00:12:06,640
uses a simple<font color="#CCCCCC"> soar encryption in 2017</font>

261
00:12:04,360 --> 00:12:08,320
<font color="#E5E5E5">another campaign is launched bringing a</font>

262
00:12:06,640 --> 00:12:11,110
new version<font color="#CCCCCC"> that adds a custom</font>

263
00:12:08,320 --> 00:12:12,850
encryption of<font color="#E5E5E5"> the embedded resources</font><font color="#CCCCCC"> so</font>

264
00:12:11,110 --> 00:12:14,920
it is clear<font color="#CCCCCC"> that the attackers are</font>

265
00:12:12,850 --> 00:12:19,180
making efforts<font color="#CCCCCC"> to</font><font color="#E5E5E5"> avoid detection of</font>

266
00:12:14,920 --> 00:12:23,349
security products now let's talk a<font color="#CCCCCC"> bit</font>

267
00:12:19,180 --> 00:12:24,099
about telemetry usually<font color="#E5E5E5"> during an</font>

268
00:12:23,350 --> 00:12:26,890
investigation

269
00:12:24,100 --> 00:12:29,050
we<font color="#E5E5E5"> are interested to see who were the</font>

270
00:12:26,890 --> 00:12:31,750
victims<font color="#CCCCCC"> of the attack if the victims</font>

271
00:12:29,050 --> 00:12:33,400
have certain characteristics<font color="#E5E5E5"> or if the</font>

272
00:12:31,750 --> 00:12:37,360
attack of codes globally in all

273
00:12:33,400 --> 00:12:40,900
geographical regions or if certain areas

274
00:12:37,360 --> 00:12:43,360
were affected and<font color="#CCCCCC"> so on</font><font color="#E5E5E5"> so analyzing our</font>

275
00:12:40,900 --> 00:12:45,760
<font color="#E5E5E5">telemetry data we have first observed a</font>

276
00:12:43,360 --> 00:12:49,720
small<font color="#E5E5E5"> number of hosts or infected</font>

277
00:12:45,760 --> 00:12:51,819
meaning<font color="#E5E5E5"> that it was</font><font color="#CCCCCC"> a targeted</font><font color="#E5E5E5"> attack</font><font color="#CCCCCC"> so</font>

278
00:12:49,720 --> 00:12:55,390
we have discovered 24<font color="#E5E5E5"> different machines</font>

279
00:12:51,820 --> 00:13:00,520
<font color="#E5E5E5">belonging to almost 60 IP addresses all</font>

280
00:12:55,390 --> 00:13:03,160
located<font color="#E5E5E5"> in India New Delhi</font><font color="#CCCCCC"> most of the</font>

281
00:13:00,520 --> 00:13:05,949
victims belong to a company that<font color="#E5E5E5"> is</font>

282
00:13:03,160 --> 00:13:08,550
related<font color="#E5E5E5"> to the energy sector</font><font color="#CCCCCC"> but a few</font>

283
00:13:05,949 --> 00:13:13,229
<font color="#E5E5E5">other victims belongs to a company that</font>

284
00:13:08,550 --> 00:13:16,060
belongs<font color="#E5E5E5"> to an</font><font color="#CCCCCC"> open source company</font>

285
00:13:13,230 --> 00:13:17,280
there are also some IP addresses which

286
00:13:16,060 --> 00:13:20,219
report did I see

287
00:13:17,280 --> 00:13:23,010
of<font color="#E5E5E5"> detection for files with an unusual</font>

288
00:13:20,220 --> 00:13:24,750
path so it seemed<font color="#E5E5E5"> that these files were</font>

289
00:13:23,010 --> 00:13:27,390
executed from<font color="#E5E5E5"> a sandbox more</font>

290
00:13:24,750 --> 00:13:28,770
particularly<font color="#E5E5E5"> VirtualBox</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> our first</font>

291
00:13:27,390 --> 00:13:31,500
thought was<font color="#CCCCCC"> okay</font>

292
00:13:28,770 --> 00:13:36,050
<font color="#E5E5E5">mighty researcher that is analyzing</font>

293
00:13:31,500 --> 00:13:40,020
these files dynamically in a sandbox<font color="#E5E5E5"> or</font>

294
00:13:36,050 --> 00:13:42,359
maybe not the<font color="#E5E5E5"> first thing we saw is that</font>

295
00:13:40,020 --> 00:13:44,189
<font color="#E5E5E5">the reported malicious files</font><font color="#CCCCCC"> seemed</font><font color="#E5E5E5"> to</font>

296
00:13:42,360 --> 00:13:46,920
<font color="#E5E5E5">be consecutive versions of the same</font>

297
00:13:44,190 --> 00:13:49,410
software so this was kind of strange

298
00:13:46,920 --> 00:13:54,000
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so I decided to check the</font>

299
00:13:49,410 --> 00:13:56,339
<font color="#E5E5E5">timestamps of this of this report</font><font color="#CCCCCC"> four</font>

300
00:13:54,000 --> 00:13:59,820
consecutive versions<font color="#E5E5E5"> the difference was</font>

301
00:13:56,340 --> 00:14:02,670
under two minutes<font color="#E5E5E5"> so things got</font><font color="#CCCCCC"> even</font>

302
00:13:59,820 --> 00:14:05,700
more strange<font color="#E5E5E5"> we extracted the files and</font>

303
00:14:02,670 --> 00:14:08,459
we took a look<font color="#E5E5E5"> at the compile time</font><font color="#CCCCCC"> so</font>

304
00:14:05,700 --> 00:14:11,520
not<font color="#CCCCCC"> only the compile time is very close</font>

305
00:14:08,460 --> 00:14:13,560
to<font color="#E5E5E5"> the report</font><font color="#CCCCCC"> time stamp but also the</font>

306
00:14:11,520 --> 00:14:17,390
difference between consecutive versions

307
00:14:13,560 --> 00:14:23,030
of the<font color="#E5E5E5"> compile time</font><font color="#CCCCCC"> are also very a very</font>

308
00:14:17,390 --> 00:14:26,040
<font color="#E5E5E5">proper</font><font color="#CCCCCC"> very close</font><font color="#E5E5E5"> under one minute so</font>

309
00:14:23,030 --> 00:14:28,829
from these<font color="#CCCCCC"> observations we can</font><font color="#E5E5E5"> draw two</font>

310
00:14:26,040 --> 00:14:30,959
<font color="#CCCCCC">conclusions we are dealing</font><font color="#E5E5E5"> with an</font>

311
00:14:28,830 --> 00:14:33,710
automated<font color="#E5E5E5"> process that compiles the</font>

312
00:14:30,960 --> 00:14:37,050
samples and<font color="#CCCCCC"> two we have actually find</font>

313
00:14:33,710 --> 00:14:39,740
found the developer of this piece of

314
00:14:37,050 --> 00:14:43,260
<font color="#E5E5E5">mother so what was actually happening</font>

315
00:14:39,740 --> 00:14:46,290
<font color="#CCCCCC">the developer was testing his binaries</font>

316
00:14:43,260 --> 00:14:49,589
<font color="#E5E5E5">against our product since the victims</font>

317
00:14:46,290 --> 00:14:52,199
are using the defender as a protection

318
00:14:49,589 --> 00:14:54,600
<font color="#CCCCCC">he wanted</font><font color="#E5E5E5"> to make sure that</font><font color="#CCCCCC"> the files</font>

319
00:14:52,200 --> 00:15:00,510
that<font color="#E5E5E5"> he releases in the wild will not be</font>

320
00:14:54,600 --> 00:15:02,670
detected<font color="#CCCCCC"> by</font><font color="#E5E5E5"> our product so we have</font>

321
00:15:00,510 --> 00:15:04,530
identified<font color="#CCCCCC"> six IPS that are used to</font>

322
00:15:02,670 --> 00:15:06,719
compile and<font color="#E5E5E5"> test the detection of our</font>

323
00:15:04,530 --> 00:15:09,930
<font color="#E5E5E5">security solutions of the resulted files</font>

324
00:15:06,720 --> 00:15:11,100
<font color="#E5E5E5">and all of the six IPS were also located</font>

325
00:15:09,930 --> 00:15:14,540
<font color="#E5E5E5">in New Delhi</font>

326
00:15:11,100 --> 00:15:18,120
so both the<font color="#E5E5E5"> target and the attacker</font><font color="#CCCCCC"> are</font>

327
00:15:14,540 --> 00:15:20,490
located in<font color="#E5E5E5"> New Delhi</font><font color="#CCCCCC"> the two CSE found</font>

328
00:15:18,120 --> 00:15:23,490
in the binaries we analyzed actually

329
00:15:20,490 --> 00:15:25,560
resolved one of<font color="#CCCCCC"> the six IP address which</font>

330
00:15:23,490 --> 00:15:31,080
<font color="#E5E5E5">was also tagged as</font><font color="#CCCCCC"> belonging to</font><font color="#E5E5E5"> the</font>

331
00:15:25,560 --> 00:15:34,150
developer<font color="#E5E5E5"> and now some closing remarks</font>

332
00:15:31,080 --> 00:15:36,130
we have seen a complex<font color="#E5E5E5"> rats that have</font>

333
00:15:34,150 --> 00:15:40,329
<font color="#E5E5E5">gone under the</font><font color="#CCCCCC"> radar for a long</font><font color="#E5E5E5"> time</font>

334
00:15:36,130 --> 00:15:42,850
which is still<font color="#E5E5E5"> under development</font><font color="#CCCCCC"> and as</font>

335
00:15:40,330 --> 00:15:46,180
we can<font color="#CCCCCC"> see</font><font color="#E5E5E5"> it was a highly targeted</font>

336
00:15:42,850 --> 00:15:48,640
campaign where<font color="#E5E5E5"> we identify both victims</font>

337
00:15:46,180 --> 00:15:52,120
and<font color="#E5E5E5"> the attacker</font><font color="#CCCCCC"> and we can proudly</font><font color="#E5E5E5"> say</font>

338
00:15:48,640 --> 00:15:54,910
that<font color="#E5E5E5"> we managed to detect almost all the</font>

339
00:15:52,120 --> 00:16:00,220
files that<font color="#E5E5E5"> he compiled in in his hand</font>

340
00:15:54,910 --> 00:16:03,100
box for<font color="#E5E5E5"> more indicators of compromised</font>

341
00:16:00,220 --> 00:16:06,370
<font color="#E5E5E5">such as domains and hashes you can check</font>

342
00:16:03,100 --> 00:16:08,260
our<font color="#CCCCCC"> B</font><font color="#E5E5E5"> defender technical blog or if you</font>

343
00:16:06,370 --> 00:16:11,980
want<font color="#E5E5E5"> to check the white paper section</font>

344
00:16:08,260 --> 00:16:13,870
<font color="#E5E5E5">for to find more</font><font color="#CCCCCC"> resources</font><font color="#E5E5E5"> also there</font>

345
00:16:11,980 --> 00:16:16,300
<font color="#E5E5E5">are some useful tools in case the four</font>

346
00:16:13,870 --> 00:16:17,920
are somewhere or<font color="#E5E5E5"> infection such as the</font>

347
00:16:16,300 --> 00:16:20,890
critters<font color="#CCCCCC"> that will</font><font color="#E5E5E5"> depict your files</font>

348
00:16:17,920 --> 00:16:25,000
automatically<font color="#E5E5E5"> so we don't need to pay</font>

349
00:16:20,890 --> 00:16:26,890
the ransom<font color="#E5E5E5"> also you can find other type</font>

350
00:16:25,000 --> 00:16:29,920
<font color="#CCCCCC">of studies done by</font><font color="#E5E5E5"> our research team</font>

351
00:16:26,890 --> 00:16:31,930
including<font color="#E5E5E5"> machine learning networking</font>

352
00:16:29,920 --> 00:16:35,770
networking and cloud infrastructure and

353
00:16:31,930 --> 00:16:38,829
many<font color="#E5E5E5"> more thank you for your attention</font>

354
00:16:35,770 --> 00:16:43,350
<font color="#E5E5E5">for more questions you</font><font color="#CCCCCC"> can find</font><font color="#E5E5E5"> me on</font>

355
00:16:38,830 --> 00:16:43,350
<font color="#E5E5E5">LinkedIn Twitter or email</font><font color="#CCCCCC"> thank you</font>

