1
00:00:03,620 --> 00:00:06,740
[Music]

2
00:00:19,720 --> 00:00:26,220
<font color="#CCCCCC">let's get started so first of</font><font color="#E5E5E5"> all thanks</font>

3
00:00:23,050 --> 00:00:29,140
to everyone<font color="#E5E5E5"> who has been present here</font><font color="#CCCCCC"> I</font>

4
00:00:26,220 --> 00:00:31,330
know<font color="#E5E5E5"> is Sunday but I hope for the next</font>

5
00:00:29,140 --> 00:00:33,220
<font color="#E5E5E5">25</font><font color="#CCCCCC"> to 30 minutes we're gonna</font><font color="#E5E5E5"> make this</font>

6
00:00:31,330 --> 00:00:35,830
<font color="#E5E5E5">talk pretty good and you'll learn</font>

7
00:00:33,220 --> 00:00:37,870
something<font color="#E5E5E5"> great and</font><font color="#CCCCCC"> where's mine so it's</font>

8
00:00:35,830 --> 00:00:40,300
kind<font color="#E5E5E5"> of journey for the next</font><font color="#CCCCCC"> 21</font><font color="#E5E5E5"> 25 to 30</font>

9
00:00:37,870 --> 00:00:42,160
minutes hopefully let's get through it

10
00:00:40,300 --> 00:00:43,199
<font color="#E5E5E5">so today we're gonna talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> trying</font>

11
00:00:42,160 --> 00:00:46,179
<font color="#E5E5E5">work</font><font color="#CCCCCC"> Yas</font>

12
00:00:43,199 --> 00:00:49,300
we typically gotta focus on<font color="#E5E5E5"> a one of the</font>

13
00:00:46,180 --> 00:00:50,710
main scenario<font color="#E5E5E5"> which means like we're</font>

14
00:00:49,300 --> 00:00:52,599
<font color="#E5E5E5">dealing with botnets we're dealing with</font>

15
00:00:50,710 --> 00:00:54,129
<font color="#CCCCCC">different set of crimeware but in this</font>

16
00:00:52,600 --> 00:00:57,250
particular<font color="#CCCCCC"> talk we are going to look</font>

17
00:00:54,129 --> 00:00:59,230
into<font color="#E5E5E5"> how the attackers</font><font color="#CCCCCC"> or the botnet</font>

18
00:00:57,250 --> 00:01:01,870
operators are deploying botnet command

19
00:00:59,230 --> 00:01:03,669
and control panels<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> all one of</font>

20
00:01:01,870 --> 00:01:05,410
<font color="#E5E5E5">the most important thing to know when we</font>

21
00:01:03,670 --> 00:01:07,630
talk about<font color="#E5E5E5"> the security</font><font color="#CCCCCC"> intelligence in</font>

22
00:01:05,410 --> 00:01:09,250
the<font color="#CCCCCC"> field of malware and</font><font color="#E5E5E5"> this actually</font>

23
00:01:07,630 --> 00:01:12,429
<font color="#E5E5E5">gives us a lot of interesting</font><font color="#CCCCCC"> insights</font>

24
00:01:09,250 --> 00:01:15,460
<font color="#E5E5E5">and then we'll take a</font><font color="#CCCCCC"> look at it so</font>

25
00:01:12,430 --> 00:01:17,229
little<font color="#E5E5E5"> brief I think background are mine</font>

26
00:01:15,460 --> 00:01:19,119
so I think<font color="#E5E5E5"> I</font><font color="#CCCCCC"> just wanted a</font><font color="#E5E5E5"> little</font>

27
00:01:17,229 --> 00:01:21,640
<font color="#E5E5E5">disclaimer</font><font color="#CCCCCC"> most of the research that</font>

28
00:01:19,119 --> 00:01:23,709
we're gonna<font color="#E5E5E5"> discuss during the course of</font>

29
00:01:21,640 --> 00:01:25,709
this talk<font color="#E5E5E5"> is totally an independent one</font>

30
00:01:23,709 --> 00:01:27,700
nothing relates to my employer<font color="#E5E5E5"> because I</font>

31
00:01:25,709 --> 00:01:29,890
always<font color="#CCCCCC"> believe that</font><font color="#E5E5E5"> you know</font><font color="#CCCCCC"> security</font>

32
00:01:27,700 --> 00:01:31,810
<font color="#CCCCCC">give a community has</font><font color="#E5E5E5"> given you so much</font>

33
00:01:29,890 --> 00:01:34,390
<font color="#CCCCCC">we are in the world</font><font color="#E5E5E5"> of shared</font>

34
00:01:31,810 --> 00:01:36,940
responsibility<font color="#E5E5E5"> model like let's start</font>

35
00:01:34,390 --> 00:01:39,340
<font color="#CCCCCC">stick to it but at the end</font><font color="#E5E5E5"> of the day it</font>

36
00:01:36,940 --> 00:01:40,539
is always our individual strengths to

37
00:01:39,340 --> 00:01:42,880
actually give back to this<font color="#E5E5E5"> karate</font>

38
00:01:40,539 --> 00:01:45,009
community as<font color="#E5E5E5"> well</font><font color="#CCCCCC"> so that drives me</font>

39
00:01:42,880 --> 00:01:47,229
towards<font color="#E5E5E5"> a lot of interesting</font><font color="#CCCCCC"> things that</font>

40
00:01:45,009 --> 00:01:49,599
<font color="#E5E5E5">is apart from my job responsibilities</font>

41
00:01:47,229 --> 00:01:52,000
so we'll take<font color="#E5E5E5"> a deep dive</font><font color="#CCCCCC"> into laid it</font>

42
00:01:49,599 --> 00:01:53,830
down<font color="#E5E5E5"> so let's get it started</font><font color="#CCCCCC"> so what are</font>

43
00:01:52,000 --> 00:01:55,420
<font color="#E5E5E5">we going to talk about today so</font><font color="#CCCCCC"> we're</font>

44
00:01:53,830 --> 00:01:58,030
<font color="#E5E5E5">gonna look into the world of cybercrime</font>

45
00:01:55,420 --> 00:02:00,459
<font color="#CCCCCC">we're gonna talk about why</font><font color="#E5E5E5"> botnet are</font>

46
00:01:58,030 --> 00:02:03,130
being drawings<font color="#E5E5E5"> growing we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> look</font>

47
00:02:00,459 --> 00:02:04,929
<font color="#E5E5E5">into the a the basic HTTP</font><font color="#CCCCCC"> base command</font>

48
00:02:03,130 --> 00:02:07,300
and control communication channels try

49
00:02:04,929 --> 00:02:09,160
to see what<font color="#E5E5E5"> it is all about</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> gonna</font>

50
00:02:07,300 --> 00:02:10,899
look<font color="#CCCCCC"> into the some</font><font color="#E5E5E5"> of the real world</font>

51
00:02:09,160 --> 00:02:13,299
<font color="#E5E5E5">Kumada and control panels how they look</font>

52
00:02:10,899 --> 00:02:14,560
<font color="#E5E5E5">like and then most important part is</font>

53
00:02:13,300 --> 00:02:17,080
that what are the techniques<font color="#CCCCCC"> that you</font>

54
00:02:14,560 --> 00:02:18,730
have<font color="#E5E5E5"> to opt to actually go after and</font>

55
00:02:17,080 --> 00:02:22,569
find these kind<font color="#E5E5E5"> of command and</font><font color="#CCCCCC"> control</font>

56
00:02:18,730 --> 00:02:25,510
panels typically pressing the channels

57
00:02:22,569 --> 00:02:27,880
on the<font color="#E5E5E5"> HTTP protocol then we have like</font>

58
00:02:25,510 --> 00:02:30,040
we did some<font color="#E5E5E5"> empirical analysis we're</font>

59
00:02:27,880 --> 00:02:31,960
gonna discuss the results of<font color="#CCCCCC"> that</font><font color="#E5E5E5"> stuff</font>

60
00:02:30,040 --> 00:02:33,519
<font color="#E5E5E5">that actually</font><font color="#CCCCCC"> gives you more feel about</font>

61
00:02:31,960 --> 00:02:34,020
what it<font color="#E5E5E5"> is all</font><font color="#CCCCCC"> about what we are talking</font>

62
00:02:33,520 --> 00:02:36,450
<font color="#CCCCCC">about</font>

63
00:02:34,020 --> 00:02:38,040
ah<font color="#E5E5E5"> then we have a little bit discussion</font>

64
00:02:36,450 --> 00:02:42,600
on the arms race<font color="#E5E5E5"> and we'll conclude</font><font color="#CCCCCC"> with</font>

65
00:02:38,040 --> 00:02:44,609
the<font color="#CCCCCC"> question and answers yep so I'll</font>

66
00:02:42,600 --> 00:02:46,500
start with a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> analogy</font><font color="#CCCCCC"> right I mean</font>

67
00:02:44,610 --> 00:02:48,420
these dates the more of the security

68
00:02:46,500 --> 00:02:50,550
threats are relying in the context<font color="#E5E5E5"> of</font>

69
00:02:48,420 --> 00:02:52,290
data movement<font color="#E5E5E5"> right I mean earlier we</font>

70
00:02:50,550 --> 00:02:53,850
have some complexities around<font color="#E5E5E5"> we have</font>

71
00:02:52,290 --> 00:02:56,010
data storage<font color="#E5E5E5"> and all that we have</font><font color="#CCCCCC"> been</font>

72
00:02:53,850 --> 00:02:58,710
advancing in that field<font color="#E5E5E5"> but right now</font>

73
00:02:56,010 --> 00:03:00,120
with new compliance coming up<font color="#CCCCCC"> gdpr</font><font color="#E5E5E5"> and</font>

74
00:02:58,710 --> 00:03:02,490
all those kind of<font color="#E5E5E5"> things down the lane</font>

75
00:03:00,120 --> 00:03:05,100
we are more individualistically

76
00:03:02,490 --> 00:03:07,110
<font color="#E5E5E5">tying after the context</font><font color="#CCCCCC"> off which are</font>

77
00:03:05,100 --> 00:03:10,260
used to call as like data movement chaos

78
00:03:07,110 --> 00:03:11,460
<font color="#E5E5E5">white what I actually mean</font><font color="#CCCCCC"> that at the</font>

79
00:03:10,260 --> 00:03:13,109
end<font color="#E5E5E5"> of the day with the last</font><font color="#CCCCCC"> ten years</font>

80
00:03:11,460 --> 00:03:15,330
mobile revolution is occurring new

81
00:03:13,110 --> 00:03:17,730
devices<font color="#CCCCCC"> are coming up</font><font color="#E5E5E5"> so what I feel</font>

82
00:03:15,330 --> 00:03:20,070
<font color="#E5E5E5">that more devices more targets more</font>

83
00:03:17,730 --> 00:03:22,500
targets<font color="#E5E5E5"> both threats more threats more</font>

84
00:03:20,070 --> 00:03:24,359
exploitation and more exploitation means

85
00:03:22,500 --> 00:03:26,760
which results in<font color="#CCCCCC"> most more security</font>

86
00:03:24,360 --> 00:03:28,950
breaches<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you seen around in the lis</font>

87
00:03:26,760 --> 00:03:31,679
recent times right we<font color="#E5E5E5"> talked</font><font color="#CCCCCC"> about who</font>

88
00:03:28,950 --> 00:03:33,929
here many many security controls like

89
00:03:31,680 --> 00:03:35,640
<font color="#E5E5E5">solutions devices everything has been</font>

90
00:03:33,930 --> 00:03:38,450
deployed<font color="#CCCCCC"> but still we are facing</font>

91
00:03:35,640 --> 00:03:40,589
security breaches what is all<font color="#E5E5E5"> about so</font>

92
00:03:38,450 --> 00:03:42,480
considering<font color="#CCCCCC"> that scenario it's</font><font color="#E5E5E5"> very</font>

93
00:03:40,590 --> 00:03:44,010
important to understand the complexities

94
00:03:42,480 --> 00:03:46,950
that are<font color="#E5E5E5"> involved around the data</font>

95
00:03:44,010 --> 00:03:49,140
movement<font color="#E5E5E5"> similarly which basically</font>

96
00:03:46,950 --> 00:03:51,359
resonates back to the<font color="#CCCCCC"> scenario which we</font>

97
00:03:49,140 --> 00:03:53,458
used<font color="#E5E5E5"> to call it more devices or are</font>

98
00:03:51,360 --> 00:03:55,140
present in the wall<font color="#E5E5E5"> more devices means</font>

99
00:03:53,459 --> 00:03:57,840
like more launch<font color="#CCCCCC"> backs for the attackers</font>

100
00:03:55,140 --> 00:04:00,540
<font color="#E5E5E5">to trigger the attacks that's why if we</font>

101
00:03:57,840 --> 00:04:02,040
in the context of boss what is<font color="#E5E5E5"> bought</font>

102
00:04:00,540 --> 00:04:03,900
mean<font color="#E5E5E5"> right basically you know you</font>

103
00:04:02,040 --> 00:04:05,549
<font color="#CCCCCC">compromised</font><font color="#E5E5E5"> the device you install your</font>

104
00:04:03,900 --> 00:04:07,890
malware you know it become a part of the

105
00:04:05,550 --> 00:04:10,590
botnet<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then you can perform a lot of</font>

106
00:04:07,890 --> 00:04:13,049
<font color="#E5E5E5">nefarious activities using that network</font>

107
00:04:10,590 --> 00:04:15,120
<font color="#CCCCCC">of</font><font color="#E5E5E5"> ports but again at the</font><font color="#CCCCCC"> endpoint the</font>

108
00:04:13,050 --> 00:04:16,440
more important part is that<font color="#E5E5E5"> in</font>

109
00:04:15,120 --> 00:04:18,209
technology things are<font color="#E5E5E5"> growing</font>

110
00:04:16,440 --> 00:04:21,329
exponentially<font color="#E5E5E5"> so as the threats</font>

111
00:04:18,209 --> 00:04:22,980
so as the infections so let's take a

112
00:04:21,329 --> 00:04:24,750
little look<font color="#CCCCCC"> into the growth in botnets</font>

113
00:04:22,980 --> 00:04:26,940
<font color="#CCCCCC">if you see around but we are seeing in</font>

114
00:04:24,750 --> 00:04:28,590
recent<font color="#E5E5E5"> times you know new botnets are</font>

115
00:04:26,940 --> 00:04:31,080
<font color="#E5E5E5">coming out whether these are dwell up</font>

116
00:04:28,590 --> 00:04:34,260
with the new code or the reuse of<font color="#E5E5E5"> the</font>

117
00:04:31,080 --> 00:04:35,700
code<font color="#CCCCCC"> I know in 2008 spy I came in Zeus</font>

118
00:04:34,260 --> 00:04:36,780
came in and then<font color="#E5E5E5"> there</font><font color="#CCCCCC"> a variety of</font>

119
00:04:35,700 --> 00:04:38,969
those botnets

120
00:04:36,780 --> 00:04:41,820
you know using<font color="#E5E5E5"> the same code Citadel one</font>

121
00:04:38,970 --> 00:04:43,919
<font color="#E5E5E5">a lot of other things these days we</font><font color="#CCCCCC"> are</font>

122
00:04:41,820 --> 00:04:45,990
looking into<font color="#E5E5E5"> infection of Tesla agent</font>

123
00:04:43,919 --> 00:04:47,909
and a lot<font color="#CCCCCC"> of other botnets but this this</font>

124
00:04:45,990 --> 00:04:50,550
at this thing is actually<font color="#E5E5E5"> going</font>

125
00:04:47,910 --> 00:04:52,380
exponentially<font color="#CCCCCC"> and that</font><font color="#E5E5E5"> actually a little</font>

126
00:04:50,550 --> 00:04:54,180
bit worrisome down the lane because<font color="#E5E5E5"> at</font>

127
00:04:52,380 --> 00:04:55,920
the end<font color="#E5E5E5"> of the day you know lot of</font>

128
00:04:54,180 --> 00:04:57,930
<font color="#CCCCCC">nefarious activities will be done on the</font>

129
00:04:55,920 --> 00:04:59,480
<font color="#CCCCCC">internet that involves users that</font>

130
00:04:57,930 --> 00:05:02,180
involve devices that involves

131
00:04:59,480 --> 00:05:04,920
<font color="#E5E5E5">organization enterprises whatever it is</font>

132
00:05:02,180 --> 00:05:09,000
<font color="#E5E5E5">attackers are basically after a scenario</font>

133
00:05:04,920 --> 00:05:10,890
<font color="#CCCCCC">to</font><font color="#E5E5E5"> get the money</font><font color="#CCCCCC"> why what I mean by that</font>

134
00:05:09,000 --> 00:05:12,300
is earlier when<font color="#CCCCCC"> we have seen in the</font>

135
00:05:10,890 --> 00:05:14,490
growth of<font color="#E5E5E5"> botnets people are doing it</font>

136
00:05:12,300 --> 00:05:16,140
for<font color="#E5E5E5"> fun</font><font color="#CCCCCC"> and profit purposes you know we</font>

137
00:05:14,490 --> 00:05:19,550
still<font color="#E5E5E5"> see denial of service but these</font>

138
00:05:16,140 --> 00:05:22,080
days<font color="#E5E5E5"> those basically</font><font color="#CCCCCC"> adversaries are</font>

139
00:05:19,550 --> 00:05:23,970
financially motivated<font color="#E5E5E5"> and that's what we</font>

140
00:05:22,080 --> 00:05:26,070
<font color="#CCCCCC">are seeing these days at the</font><font color="#E5E5E5"> end of the</font>

141
00:05:23,970 --> 00:05:27,150
day if they<font color="#E5E5E5"> steal your credentials</font><font color="#CCCCCC"> I</font>

142
00:05:26,070 --> 00:05:28,710
mean<font color="#CCCCCC"> they're gonna sell</font><font color="#E5E5E5"> it in the</font>

143
00:05:27,150 --> 00:05:31,440
underground community<font color="#E5E5E5"> they have like</font>

144
00:05:28,710 --> 00:05:33,450
well-defined structure<font color="#E5E5E5"> marketplaces in</font>

145
00:05:31,440 --> 00:05:35,130
the<font color="#E5E5E5"> underground</font><font color="#CCCCCC"> economy</font><font color="#E5E5E5"> and they are</font>

146
00:05:33,450 --> 00:05:37,200
<font color="#E5E5E5">just strengthening that economy day by</font>

147
00:05:35,130 --> 00:05:37,610
day<font color="#E5E5E5"> so that's what we are</font><font color="#CCCCCC"> feeling right</font>

148
00:05:37,200 --> 00:05:40,770
now

149
00:05:37,610 --> 00:05:43,680
just<font color="#CCCCCC"> another</font><font color="#E5E5E5"> one stats before we start</font>

150
00:05:40,770 --> 00:05:45,479
the wheel<font color="#CCCCCC"> talk growth in botnets right</font>

151
00:05:43,680 --> 00:05:47,580
and then we<font color="#E5E5E5"> can see the law over</font><font color="#CCCCCC"> IT or</font>

152
00:05:45,480 --> 00:05:49,350
botnets coming across and that<font color="#E5E5E5"> is</font>

153
00:05:47,580 --> 00:05:52,500
targeting IOT<font color="#E5E5E5"> or either they are</font>

154
00:05:49,350 --> 00:05:54,420
targeting different you know devices

155
00:05:52,500 --> 00:05:56,580
you know<font color="#CCCCCC"> dak stop lap toss</font><font color="#E5E5E5"> whatever it</font>

156
00:05:54,420 --> 00:05:58,830
is the most important point in

157
00:05:56,580 --> 00:06:00,990
understanding<font color="#E5E5E5"> the botnet growth is like</font>

158
00:05:58,830 --> 00:06:02,969
how they are abusing<font color="#CCCCCC"> the protocols so</font>

159
00:06:00,990 --> 00:06:05,040
I'm just gonna<font color="#E5E5E5"> take take a deep dive a</font>

160
00:06:02,970 --> 00:06:07,740
little bit into the basics and then<font color="#CCCCCC"> we</font>

161
00:06:05,040 --> 00:06:09,720
<font color="#E5E5E5">gonna you know talk further so when I</font>

162
00:06:07,740 --> 00:06:11,580
talk about<font color="#CCCCCC"> protocols I</font><font color="#E5E5E5"> always feel that</font>

163
00:06:09,720 --> 00:06:13,890
at the end of<font color="#E5E5E5"> the day there</font><font color="#CCCCCC"> are standard</font>

164
00:06:11,580 --> 00:06:15,780
protocols there<font color="#E5E5E5"> at HTTP protocol IRC</font>

165
00:06:13,890 --> 00:06:18,210
protocol p2p and a lot of<font color="#E5E5E5"> other</font>

166
00:06:15,780 --> 00:06:19,830
different<font color="#E5E5E5"> protocols but still at the end</font>

167
00:06:18,210 --> 00:06:21,780
<font color="#E5E5E5">of that is a client-server model right I</font>

168
00:06:19,830 --> 00:06:23,789
mean your systems are in fact<font color="#E5E5E5"> they have</font>

169
00:06:21,780 --> 00:06:25,469
<font color="#E5E5E5">to connect back to the</font><font color="#CCCCCC"> CNC server</font><font color="#E5E5E5"> and</font>

170
00:06:23,790 --> 00:06:28,260
then<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> still using the</font><font color="#CCCCCC"> same</font>

171
00:06:25,470 --> 00:06:30,330
protocols<font color="#E5E5E5"> for communication</font><font color="#CCCCCC"> the most</font>

172
00:06:28,260 --> 00:06:32,159
important artifact<font color="#E5E5E5"> in is that how they</font>

173
00:06:30,330 --> 00:06:33,960
<font color="#E5E5E5">are abusing that protocol are they are</font>

174
00:06:32,160 --> 00:06:36,150
using the similar<font color="#E5E5E5"> or they are using the</font>

175
00:06:33,960 --> 00:06:38,219
<font color="#E5E5E5">same way the way RFC's</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> defined the</font>

176
00:06:36,150 --> 00:06:40,049
protocols or are they actually<font color="#CCCCCC"> screened</font>

177
00:06:38,220 --> 00:06:42,330
<font color="#CCCCCC">during</font><font color="#E5E5E5"> the process of using the</font>

178
00:06:40,050 --> 00:06:45,480
protocols<font color="#CCCCCC"> for</font><font color="#E5E5E5"> CNC communication so we</font>

179
00:06:42,330 --> 00:06:48,060
<font color="#E5E5E5">actually take a look</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> it so let's</font>

180
00:06:45,480 --> 00:06:50,310
<font color="#CCCCCC">start with a simple basic CNC</font>

181
00:06:48,060 --> 00:06:53,730
architecture specifially<font color="#CCCCCC"> Curly for the</font>

182
00:06:50,310 --> 00:06:55,650
HTTP based botnets so let's say if you

183
00:06:53,730 --> 00:06:57,390
<font color="#E5E5E5">look at this</font><font color="#CCCCCC"> particular graphic right so</font>

184
00:06:55,650 --> 00:06:59,340
you on this side you<font color="#CCCCCC"> can clearly see</font>

185
00:06:57,390 --> 00:07:01,200
<font color="#CCCCCC">that there's a board executable which</font>

186
00:06:59,340 --> 00:07:02,119
what I actually mean by<font color="#E5E5E5"> that your system</font>

187
00:07:01,200 --> 00:07:03,889
is compromised

188
00:07:02,119 --> 00:07:05,749
malware is<font color="#E5E5E5"> running inside</font><font color="#CCCCCC"> it which we</font>

189
00:07:03,889 --> 00:07:09,080
<font color="#CCCCCC">call as a bot in</font><font color="#E5E5E5"> the context of botnet</font>

190
00:07:05,749 --> 00:07:10,369
terminology<font color="#CCCCCC"> now since the</font><font color="#E5E5E5"> body is</font>

191
00:07:09,080 --> 00:07:12,378
running<font color="#E5E5E5"> inside a system it has the</font>

192
00:07:10,369 --> 00:07:13,909
capability it's all powerful<font color="#E5E5E5"> right it's</font>

193
00:07:12,379 --> 00:07:16,219
can<font color="#E5E5E5"> subvert the integrity of client</font>

194
00:07:13,909 --> 00:07:17,599
application whatever<font color="#E5E5E5"> it is all about but</font>

195
00:07:16,219 --> 00:07:19,429
we are focusing here on<font color="#E5E5E5"> the CNC</font>

196
00:07:17,599 --> 00:07:21,139
communication channel not the

197
00:07:19,429 --> 00:07:23,179
infiltration<font color="#E5E5E5"> one because it has already</font>

198
00:07:21,139 --> 00:07:25,129
<font color="#E5E5E5">infected the system</font><font color="#CCCCCC"> but we're gonna</font>

199
00:07:23,179 --> 00:07:25,938
<font color="#E5E5E5">focus primarily on the</font><font color="#CCCCCC"> protocol</font>

200
00:07:25,129 --> 00:07:28,249
scenarios

201
00:07:25,939 --> 00:07:32,449
so the bot has to send your<font color="#CCCCCC"> information</font>

202
00:07:28,249 --> 00:07:34,909
back<font color="#E5E5E5"> to the CNC server why look into</font>

203
00:07:32,449 --> 00:07:36,709
<font color="#E5E5E5">that contacts is it</font><font color="#CCCCCC"> this a can is it</font>

204
00:07:34,909 --> 00:07:38,269
right to<font color="#CCCCCC"> say that okay you know board</font>

205
00:07:36,709 --> 00:07:39,860
extracts the information is<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> send</font>

206
00:07:38,269 --> 00:07:41,779
<font color="#E5E5E5">it back</font><font color="#CCCCCC"> to the server server we receive</font>

207
00:07:39,860 --> 00:07:43,699
it processes<font color="#CCCCCC"> stored</font><font color="#E5E5E5"> in the database the</font>

208
00:07:41,779 --> 00:07:45,740
attacker can come back<font color="#E5E5E5"> look into the</font>

209
00:07:43,699 --> 00:07:47,659
information<font color="#CCCCCC"> and then you know sell it in</font>

210
00:07:45,740 --> 00:07:49,999
the<font color="#CCCCCC"> market place</font><font color="#E5E5E5"> but if you look at the</font>

211
00:07:47,659 --> 00:07:52,429
three<font color="#E5E5E5"> different main components before</font>

212
00:07:49,999 --> 00:07:55,580
<font color="#E5E5E5">your data gets back into the CNC admin</font>

213
00:07:52,429 --> 00:07:57,919
panel there is a CNC gate as<font color="#CCCCCC"> well</font><font color="#E5E5E5"> which</font>

214
00:07:55,580 --> 00:08:00,529
<font color="#CCCCCC">is a</font><font color="#E5E5E5"> very important design component of</font>

215
00:07:57,919 --> 00:08:03,589
the<font color="#CCCCCC"> CNC deployments</font><font color="#E5E5E5"> where we talk about</font>

216
00:08:00,529 --> 00:08:06,558
<font color="#E5E5E5">botnets what that gate exactly means the</font>

217
00:08:03,589 --> 00:08:08,479
gate is basically<font color="#CCCCCC"> a actually scrutinizes</font>

218
00:08:06,559 --> 00:08:10,759
<font color="#CCCCCC">the every</font><font color="#E5E5E5"> single</font><font color="#CCCCCC"> communication that</font>

219
00:08:08,479 --> 00:08:14,240
board is<font color="#CCCCCC"> making or sending data back to</font>

220
00:08:10,759 --> 00:08:16,369
the<font color="#E5E5E5"> CNC server so body sending data get</font>

221
00:08:14,240 --> 00:08:18,919
gonna<font color="#CCCCCC"> filter it</font><font color="#E5E5E5"> it's gonna look into it</font>

222
00:08:16,369 --> 00:08:20,449
<font color="#CCCCCC">whether some data is coming</font><font color="#E5E5E5"> up which</font>

223
00:08:18,919 --> 00:08:22,669
kind of<font color="#E5E5E5"> board is sending what kind of</font>

224
00:08:20,449 --> 00:08:25,279
data<font color="#E5E5E5"> whether is a checksum associated</font>

225
00:08:22,669 --> 00:08:27,889
with<font color="#E5E5E5"> that data if there is any anomaly</font>

226
00:08:25,279 --> 00:08:30,379
the CNC gates gonna filter<font color="#E5E5E5"> that traffic</font>

227
00:08:27,889 --> 00:08:32,779
<font color="#E5E5E5">out so it's like</font><font color="#CCCCCC"> cleaning process</font><font color="#E5E5E5"> right</font>

228
00:08:30,379 --> 00:08:34,130
you know when the security researchers

229
00:08:32,779 --> 00:08:35,750
come back and they do some<font color="#E5E5E5"> kind of</font>

230
00:08:34,130 --> 00:08:38,269
analysis they can still connect back to

231
00:08:35,750 --> 00:08:40,880
the<font color="#E5E5E5"> CNC domain try to mimic the behavior</font>

232
00:08:38,269 --> 00:08:43,130
of<font color="#E5E5E5"> a bot but in that case there are</font>

233
00:08:40,880 --> 00:08:44,810
certain mechanisms they have to go after

234
00:08:43,130 --> 00:08:47,600
<font color="#E5E5E5">try to make</font><font color="#CCCCCC"> sure that they mimic the</font>

235
00:08:44,810 --> 00:08:49,459
<font color="#E5E5E5">traffic exactly the same way bot is</font>

236
00:08:47,600 --> 00:08:51,709
sending the traffic<font color="#E5E5E5"> that's why these</font>

237
00:08:49,459 --> 00:08:53,630
adversary's<font color="#CCCCCC"> bots and</font><font color="#E5E5E5"> operators they come</font>

238
00:08:51,709 --> 00:08:55,550
up with this design<font color="#CCCCCC"> of CNC</font><font color="#E5E5E5"> gate right</font>

239
00:08:53,630 --> 00:08:58,339
<font color="#E5E5E5">they want to make sure that they get the</font>

240
00:08:55,550 --> 00:09:01,160
Queen data<font color="#E5E5E5"> in underground economy the</font>

241
00:08:58,339 --> 00:09:03,829
value of<font color="#CCCCCC"> weighing data is</font><font color="#E5E5E5"> way way much</font>

242
00:09:01,160 --> 00:09:05,300
<font color="#E5E5E5">more than the like garbage starter right</font>

243
00:09:03,829 --> 00:09:07,880
because<font color="#E5E5E5"> that's where they get a more</font>

244
00:09:05,300 --> 00:09:10,250
money<font color="#CCCCCC"> because the data is clean it's</font>

245
00:09:07,880 --> 00:09:12,410
validated<font color="#E5E5E5"> it's verified and that's what</font>

246
00:09:10,250 --> 00:09:14,959
they<font color="#CCCCCC"> are</font><font color="#E5E5E5"> going after so all these steps</font>

247
00:09:12,410 --> 00:09:15,589
design components are tying back to<font color="#CCCCCC"> the</font>

248
00:09:14,959 --> 00:09:16,819
<font color="#E5E5E5">underground</font>

249
00:09:15,590 --> 00:09:18,770
on me like<font color="#E5E5E5"> how they gonna collect</font><font color="#CCCCCC"> the</font>

250
00:09:16,820 --> 00:09:20,420
<font color="#E5E5E5">data how they</font><font color="#CCCCCC"> gonna sell the data</font><font color="#E5E5E5"> what</font>

251
00:09:18,770 --> 00:09:23,210
kind of data<font color="#E5E5E5"> is getting back into the</font>

252
00:09:20,420 --> 00:09:25,250
<font color="#CCCCCC">CNC panel</font><font color="#E5E5E5"> but this is a very important</font>

253
00:09:23,210 --> 00:09:28,250
artifact in the design component of that

254
00:09:25,250 --> 00:09:30,830
<font color="#E5E5E5">so</font><font color="#CCCCCC"> baaad is gonna send HTTP traffic</font><font color="#E5E5E5"> HTTP</font>

255
00:09:28,250 --> 00:09:33,440
<font color="#CCCCCC">requests</font><font color="#E5E5E5"> in the form of HTTP POST back</font>

256
00:09:30,830 --> 00:09:36,290
to the<font color="#CCCCCC"> CNC server but the</font><font color="#E5E5E5"> gate is going</font>

257
00:09:33,440 --> 00:09:41,510
<font color="#E5E5E5">to filter it making</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that the data</font>

258
00:09:36,290 --> 00:09:43,760
is coming<font color="#E5E5E5"> as expected so in this case</font>

259
00:09:41,510 --> 00:09:44,930
<font color="#E5E5E5">I'm trying to solidify the</font><font color="#CCCCCC"> fact that I</font>

260
00:09:43,760 --> 00:09:46,790
was discussing earlier it's not

261
00:09:44,930 --> 00:09:49,160
<font color="#E5E5E5">something we</font><font color="#CCCCCC"> are just discussing</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> but</font>

262
00:09:46,790 --> 00:09:52,130
<font color="#CCCCCC">look at this</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> were analyzing some</font>

263
00:09:49,160 --> 00:09:54,430
of<font color="#CCCCCC"> the you know</font><font color="#E5E5E5"> the code of this botnet</font>

264
00:09:52,130 --> 00:09:56,300
<font color="#CCCCCC">poni botnet which we try to find</font>

265
00:09:54,430 --> 00:09:57,770
actually got<font color="#E5E5E5"> a hold</font><font color="#CCCCCC"> of you know while</font>

266
00:09:56,300 --> 00:09:59,780
doing<font color="#E5E5E5"> penetration testing of some of the</font>

267
00:09:57,770 --> 00:10:01,100
CNC servers try to make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that how it</font>

268
00:09:59,780 --> 00:10:04,040
<font color="#E5E5E5">is being deployed</font><font color="#CCCCCC"> and what it is all</font>

269
00:10:01,100 --> 00:10:06,800
about<font color="#CCCCCC"> so when we realizing the code it</font>

270
00:10:04,040 --> 00:10:08,569
was very very clear<font color="#E5E5E5"> that the concepts</font>

271
00:10:06,800 --> 00:10:12,829
<font color="#E5E5E5">that we discussed</font><font color="#CCCCCC"> earlier</font><font color="#E5E5E5"> was</font>

272
00:10:08,570 --> 00:10:14,570
implemented right<font color="#CCCCCC"> away</font><font color="#E5E5E5"> so very simple</font>

273
00:10:12,830 --> 00:10:16,640
use<font color="#CCCCCC"> case scenarios</font><font color="#E5E5E5"> what if no data is</font>

274
00:10:14,570 --> 00:10:18,140
sent<font color="#E5E5E5"> back by the bot to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> CNC server</font>

275
00:10:16,640 --> 00:10:20,750
<font color="#E5E5E5">right so the gate is gonna come back</font>

276
00:10:18,140 --> 00:10:22,310
<font color="#CCCCCC">it's filter it if you look at the code</font>

277
00:10:20,750 --> 00:10:23,870
is there<font color="#E5E5E5"> and it's gonna tell you that</font>

278
00:10:22,310 --> 00:10:26,270
<font color="#CCCCCC">how they</font><font color="#E5E5E5"> are filtering it it's a PHP</font>

279
00:10:23,870 --> 00:10:29,510
base code but it's validating<font color="#E5E5E5"> the fact</font>

280
00:10:26,270 --> 00:10:33,069
that gate<font color="#E5E5E5"> is there it's a primary</font>

281
00:10:29,510 --> 00:10:35,180
component<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> botnet CNC architecture</font>

282
00:10:33,070 --> 00:10:37,400
<font color="#E5E5E5">looking at the second one this is the</font>

283
00:10:35,180 --> 00:10:39,079
admin panel so we discuss<font color="#CCCCCC"> about there's</font>

284
00:10:37,400 --> 00:10:40,699
a gate then there is an admin panel the

285
00:10:39,080 --> 00:10:42,770
admin panel code is gonna show you how

286
00:10:40,700 --> 00:10:44,540
<font color="#CCCCCC">it's interacting with the</font><font color="#E5E5E5"> database what</font>

287
00:10:42,770 --> 00:10:46,100
kind of<font color="#E5E5E5"> white listing it has</font><font color="#CCCCCC"> implemented</font>

288
00:10:44,540 --> 00:10:49,069
and<font color="#CCCCCC"> how</font><font color="#E5E5E5"> the data is gonna go back into</font>

289
00:10:46,100 --> 00:10:51,980
<font color="#E5E5E5">that tier</font><font color="#CCCCCC"> 3 we just call</font><font color="#E5E5E5"> isn't that into</font>

290
00:10:49,070 --> 00:10:54,620
the database<font color="#CCCCCC"> so Gage and the admin panel</font>

291
00:10:51,980 --> 00:10:56,360
they are<font color="#E5E5E5"> interrelated right every</font>

292
00:10:54,620 --> 00:10:58,760
request has to<font color="#CCCCCC"> be validated and verified</font>

293
00:10:56,360 --> 00:11:01,730
by<font color="#CCCCCC"> the gate</font><font color="#E5E5E5"> before it goes back to</font><font color="#CCCCCC"> the</font>

294
00:10:58,760 --> 00:11:03,740
C&C<font color="#CCCCCC"> domain so this is</font><font color="#E5E5E5"> a basic</font>

295
00:11:01,730 --> 00:11:05,390
architecture we're gonna target<font color="#E5E5E5"> and then</font>

296
00:11:03,740 --> 00:11:07,880
we'll do some discuss about<font color="#E5E5E5"> the results</font>

297
00:11:05,390 --> 00:11:09,500
on the<font color="#E5E5E5"> empirical analysis so before</font>

298
00:11:07,880 --> 00:11:11,540
<font color="#E5E5E5">moving further I want to give you a feel</font>

299
00:11:09,500 --> 00:11:15,740
<font color="#CCCCCC">of it</font><font color="#E5E5E5"> you know how the</font><font color="#CCCCCC"> real-world</font><font color="#E5E5E5"> CNC</font>

300
00:11:11,540 --> 00:11:17,900
panels look like so if you<font color="#E5E5E5"> look at this</font>

301
00:11:15,740 --> 00:11:20,240
<font color="#E5E5E5">slide primarily so we have like</font><font color="#CCCCCC"> Lockheed</font>

302
00:11:17,900 --> 00:11:22,850
<font color="#CCCCCC">BOTS CNC panel there is a Tesla agent</font>

303
00:11:20,240 --> 00:11:23,300
<font color="#E5E5E5">CNC panel Tesla agent is</font><font color="#CCCCCC"> the kind</font><font color="#E5E5E5"> of</font>

304
00:11:22,850 --> 00:11:25,820
<font color="#E5E5E5">stealer</font>

305
00:11:23,300 --> 00:11:26,359
<font color="#CCCCCC">that is being</font><font color="#E5E5E5"> you know distributed a lot</font>

306
00:11:25,820 --> 00:11:29,510
these days

307
00:11:26,360 --> 00:11:31,550
and this basic purpose<font color="#CCCCCC"> is to</font><font color="#E5E5E5"> steal</font>

308
00:11:29,510 --> 00:11:33,620
send it<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to the CNC servers</font><font color="#E5E5E5"> store it</font>

309
00:11:31,550 --> 00:11:36,079
there<font color="#E5E5E5"> and then you</font><font color="#CCCCCC"> know reuse it in</font><font color="#E5E5E5"> the</font>

310
00:11:33,620 --> 00:11:38,779
<font color="#CCCCCC">cybercrime marketplace</font><font color="#E5E5E5"> another one is</font>

311
00:11:36,079 --> 00:11:40,910
the<font color="#E5E5E5"> Pony</font><font color="#CCCCCC"> CNC admin panel Citadel</font><font color="#E5E5E5"> CNC</font>

312
00:11:38,779 --> 00:11:43,610
admin panel<font color="#E5E5E5"> and things like</font><font color="#CCCCCC"> that one of</font>

313
00:11:40,910 --> 00:11:47,269
<font color="#CCCCCC">the important fact about Citadel is that</font>

314
00:11:43,610 --> 00:11:49,639
it is basically originated after reusing

315
00:11:47,269 --> 00:11:51,410
the same<font color="#E5E5E5"> code with</font><font color="#CCCCCC"> Zhu State so some of</font>

316
00:11:49,639 --> 00:11:55,220
<font color="#E5E5E5">the mistakes</font><font color="#CCCCCC"> that zeus botnet had like</font>

317
00:11:51,410 --> 00:11:58,250
in<font color="#CCCCCC"> 2009-2010 this botnet overcame in</font>

318
00:11:55,220 --> 00:11:59,720
2014<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think we gave a talk in blackhat</font>

319
00:11:58,250 --> 00:12:01,790
where we discussed about<font color="#E5E5E5"> how to actually</font>

320
00:11:59,720 --> 00:12:04,399
<font color="#E5E5E5">pen test the CNC panels and we</font>

321
00:12:01,790 --> 00:12:07,040
highlighted<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the weaknesses in</font>

322
00:12:04,399 --> 00:12:09,470
panels<font color="#E5E5E5"> and actually these</font><font color="#CCCCCC"> days when we</font>

323
00:12:07,040 --> 00:12:10,910
test the<font color="#E5E5E5"> panels like in 2018 after three</font>

324
00:12:09,470 --> 00:12:13,339
years most<font color="#E5E5E5"> of those</font><font color="#CCCCCC"> weaknesses have been</font>

325
00:12:10,910 --> 00:12:14,750
eradicated<font color="#CCCCCC"> so which</font><font color="#E5E5E5"> means that attackers</font>

326
00:12:13,339 --> 00:12:16,130
are also<font color="#E5E5E5"> looking what kind</font><font color="#CCCCCC"> of research</font>

327
00:12:14,750 --> 00:12:18,019
that<font color="#E5E5E5"> are going in a scary research</font>

328
00:12:16,130 --> 00:12:20,149
community making<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that they fix</font>

329
00:12:18,019 --> 00:12:23,199
those issues<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that the</font><font color="#CCCCCC"> infection</font>

330
00:12:20,149 --> 00:12:25,250
process<font color="#E5E5E5"> goes stronger and stronger</font><font color="#CCCCCC"> the</font>

331
00:12:23,199 --> 00:12:27,649
<font color="#CCCCCC">next set of panel if you look at the</font>

332
00:12:25,250 --> 00:12:29,990
administrator panel is<font color="#E5E5E5"> a coin miner coin</font>

333
00:12:27,649 --> 00:12:31,699
by a sense<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of other things Godzilla</font>

334
00:12:29,990 --> 00:12:34,160
<font color="#CCCCCC">won and all</font><font color="#E5E5E5"> that so all these</font><font color="#CCCCCC"> things is</font>

335
00:12:31,699 --> 00:12:35,750
try<font color="#E5E5E5"> to give you a feel</font><font color="#CCCCCC"> about the</font>

336
00:12:34,160 --> 00:12:37,010
infections<font color="#E5E5E5"> that are running</font><font color="#CCCCCC"> inside the</font>

337
00:12:35,750 --> 00:12:39,319
compromised

338
00:12:37,010 --> 00:12:41,329
you know machines they are using<font color="#E5E5E5"> Bitcoin</font>

339
00:12:39,319 --> 00:12:43,040
mining<font color="#E5E5E5"> another kind of stuff as well</font><font color="#CCCCCC"> so</font>

340
00:12:41,329 --> 00:12:45,229
all those information still<font color="#E5E5E5"> goes back to</font>

341
00:12:43,040 --> 00:12:47,349
the CNC servers making<font color="#E5E5E5"> sure that</font>

342
00:12:45,230 --> 00:12:49,670
<font color="#CCCCCC">wherever they</font><font color="#E5E5E5"> mined they get the idea</font>

343
00:12:47,350 --> 00:12:52,610
<font color="#E5E5E5">the data everything up from the</font>

344
00:12:49,670 --> 00:12:54,229
<font color="#E5E5E5">compromised machine</font><font color="#CCCCCC"> and these are very</font>

345
00:12:52,610 --> 00:12:56,389
important you know like<font color="#E5E5E5"> whenever you</font>

346
00:12:54,230 --> 00:12:58,310
drink you know penetration testing<font color="#E5E5E5"> or</font>

347
00:12:56,389 --> 00:13:00,500
try<font color="#E5E5E5"> to test these kind of CNC servers</font>

348
00:12:58,310 --> 00:13:02,209
you encounter all these<font color="#CCCCCC"> scenarios a lot</font>

349
00:13:00,500 --> 00:13:03,680
<font color="#E5E5E5">but then you have to have like all</font>

350
00:13:02,209 --> 00:13:05,170
techniques and tactics try to go after

351
00:13:03,680 --> 00:13:07,339
you know

352
00:13:05,170 --> 00:13:09,260
performing reconnaissance and<font color="#E5E5E5"> other kind</font>

353
00:13:07,339 --> 00:13:11,180
<font color="#E5E5E5">of things try to find out if there is</font>

354
00:13:09,260 --> 00:13:12,589
some<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know exploit that you</font>

355
00:13:11,180 --> 00:13:15,050
can<font color="#E5E5E5"> trigger to actually get some shot</font>

356
00:13:12,589 --> 00:13:16,490
out of<font color="#CCCCCC"> it</font><font color="#E5E5E5"> and some stuff like that but</font>

357
00:13:15,050 --> 00:13:18,019
at the<font color="#CCCCCC"> end</font><font color="#E5E5E5"> of the day you deal with all</font>

358
00:13:16,490 --> 00:13:20,959
<font color="#E5E5E5">these kinds on on your regular day</font>

359
00:13:18,019 --> 00:13:22,880
purposes and the most important part<font color="#E5E5E5"> is</font>

360
00:13:20,959 --> 00:13:25,750
that<font color="#E5E5E5"> you know you need</font><font color="#CCCCCC"> to make sure</font><font color="#E5E5E5"> that</font>

361
00:13:22,880 --> 00:13:28,430
you got<font color="#E5E5E5"> a hold of it you get maximum</font>

362
00:13:25,750 --> 00:13:30,170
<font color="#E5E5E5">intelligence gathered out of it try to</font>

363
00:13:28,430 --> 00:13:31,939
make sure<font color="#CCCCCC"> that you use that intelligence</font>

364
00:13:30,170 --> 00:13:33,680
to build strong detection solutions<font color="#CCCCCC"> or</font>

365
00:13:31,940 --> 00:13:35,630
try to share<font color="#CCCCCC"> that research with the</font>

366
00:13:33,680 --> 00:13:38,420
community<font color="#CCCCCC"> if somebody wants to use it</font>

367
00:13:35,630 --> 00:13:40,370
they can go ahead and<font color="#E5E5E5"> have</font><font color="#CCCCCC"> it so right</font>

368
00:13:38,420 --> 00:13:42,050
now we<font color="#E5E5E5"> have talked about your basic</font>

369
00:13:40,370 --> 00:13:43,520
architecture we<font color="#E5E5E5"> talked about design</font>

370
00:13:42,050 --> 00:13:44,899
components of the botnet

371
00:13:43,520 --> 00:13:47,149
now we look into<font color="#CCCCCC"> some of the CNC</font>

372
00:13:44,899 --> 00:13:49,610
administrative panels<font color="#CCCCCC"> sported by</font><font color="#E5E5E5"> some of</font>

373
00:13:47,149 --> 00:13:52,010
the you know botnet codes and all that

374
00:13:49,610 --> 00:13:54,350
now<font color="#E5E5E5"> let's talk about some</font><font color="#CCCCCC"> of the</font>

375
00:13:52,010 --> 00:13:57,080
techniques<font color="#CCCCCC"> that we use to actually</font><font color="#E5E5E5"> go</font>

376
00:13:54,350 --> 00:13:58,670
<font color="#CCCCCC">after and finding</font><font color="#E5E5E5"> CNC panels because we</font>

377
00:13:57,080 --> 00:14:00,320
understand what it<font color="#E5E5E5"> is</font><font color="#CCCCCC"> in theory it looks</font>

378
00:13:58,670 --> 00:14:02,300
like but at the end<font color="#E5E5E5"> of the day we want</font>

379
00:14:00,320 --> 00:14:03,890
to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure that as a security</font>

380
00:14:02,300 --> 00:14:05,870
operation guy is sitting<font color="#CCCCCC"> in a cloud</font>

381
00:14:03,890 --> 00:14:08,330
sitting on a data<font color="#E5E5E5"> center wherever it is</font>

382
00:14:05,870 --> 00:14:10,970
<font color="#E5E5E5">even in my local network</font><font color="#CCCCCC"> I want to make</font>

383
00:14:08,330 --> 00:14:13,040
sure<font color="#E5E5E5"> that what I have to look into</font><font color="#CCCCCC"> so</font>

384
00:14:10,970 --> 00:14:15,740
<font color="#E5E5E5">that I can detect and fingerprint CNC</font>

385
00:14:13,040 --> 00:14:19,930
communication typically<font color="#E5E5E5"> on the HTTP</font>

386
00:14:15,740 --> 00:14:22,490
<font color="#CCCCCC">level so</font><font color="#E5E5E5"> couple of I mean these are the</font>

387
00:14:19,930 --> 00:14:24,439
wide variety<font color="#E5E5E5"> of techniques</font><font color="#CCCCCC"> that we use</font>

388
00:14:22,490 --> 00:14:27,470
but<font color="#E5E5E5"> concentrated on specific set of</font>

389
00:14:24,440 --> 00:14:29,089
attack vectors<font color="#E5E5E5"> so first of all we all</font>

390
00:14:27,470 --> 00:14:30,860
<font color="#E5E5E5">talk about static analysis</font><font color="#CCCCCC"> you know</font>

391
00:14:29,089 --> 00:14:33,140
performing reverse engineering attackers

392
00:14:30,860 --> 00:14:35,720
are making mistakes<font color="#CCCCCC"> they are hard coding</font>

393
00:14:33,140 --> 00:14:38,480
the<font color="#E5E5E5"> things hard coding the CNC domain</font>

394
00:14:35,720 --> 00:14:40,580
<font color="#CCCCCC">C&C URL you just Reaver reverse-engineer</font>

395
00:14:38,480 --> 00:14:42,709
it or debug it and<font color="#E5E5E5"> get the ID out of it</font>

396
00:14:40,580 --> 00:14:44,209
you<font color="#E5E5E5"> know how the code</font><font color="#CCCCCC"> works in the</font>

397
00:14:42,709 --> 00:14:46,520
underlying assembly and then you know

398
00:14:44,209 --> 00:14:48,170
<font color="#E5E5E5">got a feel</font><font color="#CCCCCC"> of it Ida Pro all these kind</font>

399
00:14:46,520 --> 00:14:50,120
of tools<font color="#E5E5E5"> are there so you</font><font color="#CCCCCC"> get a feel of</font>

400
00:14:48,170 --> 00:14:51,740
it<font color="#CCCCCC"> and then you</font><font color="#E5E5E5"> got a able to find</font><font color="#CCCCCC"> the</font>

401
00:14:50,120 --> 00:14:54,470
CNC domain and then you start<font color="#E5E5E5"> your</font>

402
00:14:51,740 --> 00:14:56,270
penetration<font color="#E5E5E5"> testing afterwards but it is</font>

403
00:14:54,470 --> 00:14:57,890
find out that<font color="#E5E5E5"> okay this is a very easy</font>

404
00:14:56,270 --> 00:15:00,170
technique you know just passing the

405
00:14:57,890 --> 00:15:02,149
<font color="#CCCCCC">value of your CNC domain URL as a string</font>

406
00:15:00,170 --> 00:15:03,740
in the binary is just pretty easy you

407
00:15:02,149 --> 00:15:06,140
know strings<font color="#CCCCCC"> lot</font><font color="#E5E5E5"> of other things tool</font>

408
00:15:03,740 --> 00:15:07,640
you can use<font color="#CCCCCC"> to get it done but then</font><font color="#E5E5E5"> they</font>

409
00:15:06,140 --> 00:15:08,899
came out<font color="#E5E5E5"> okay we do want to do that</font>

410
00:15:07,640 --> 00:15:10,459
we're gonna<font color="#E5E5E5"> have like some</font><font color="#CCCCCC"> kind of</font>

411
00:15:08,899 --> 00:15:12,500
different mechanism<font color="#E5E5E5"> or different</font>

412
00:15:10,459 --> 00:15:14,300
technique<font color="#CCCCCC"> to go after</font><font color="#E5E5E5"> which we call as</font>

413
00:15:12,500 --> 00:15:16,459
like domain<font color="#E5E5E5"> generation algorithms and</font>

414
00:15:14,300 --> 00:15:18,740
some advanced algorithms<font color="#E5E5E5"> embedded in the</font>

415
00:15:16,459 --> 00:15:21,050
binary<font color="#E5E5E5"> so that when the binary or the</font>

416
00:15:18,740 --> 00:15:23,209
malware executes<font color="#E5E5E5"> sin the system at the</font>

417
00:15:21,050 --> 00:15:24,859
<font color="#E5E5E5">same time the algorithm is triggered in</font>

418
00:15:23,209 --> 00:15:27,439
the system and they<font color="#CCCCCC"> actually generate</font>

419
00:15:24,860 --> 00:15:30,110
<font color="#E5E5E5">the</font><font color="#CCCCCC"> C&C domain the</font><font color="#E5E5E5"> CL see URL</font>

420
00:15:27,440 --> 00:15:31,730
dynamically so in that case<font color="#E5E5E5"> until unless</font>

421
00:15:30,110 --> 00:15:33,829
<font color="#E5E5E5">you run the</font><font color="#CCCCCC"> malware in a controlled</font>

422
00:15:31,730 --> 00:15:35,690
environment<font color="#CCCCCC"> you basically attach it</font><font color="#E5E5E5"> to</font>

423
00:15:33,829 --> 00:15:37,489
the debugger<font color="#CCCCCC"> you don't have any idea</font>

424
00:15:35,690 --> 00:15:39,170
what the CNC domain is<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to look</font>

425
00:15:37,490 --> 00:15:41,839
like<font color="#E5E5E5"> until</font><font color="#CCCCCC"> unless you reverse</font>

426
00:15:39,170 --> 00:15:43,819
engineering it completely try to extract

427
00:15:41,839 --> 00:15:45,800
<font color="#CCCCCC">the algorithm you know</font><font color="#E5E5E5"> drive from the</font>

428
00:15:43,820 --> 00:15:48,260
algorithm you draft<font color="#E5E5E5"> a pseudo code back</font>

429
00:15:45,800 --> 00:15:50,060
into<font color="#E5E5E5"> the Python</font><font color="#CCCCCC"> write the proper code</font>

430
00:15:48,260 --> 00:15:51,620
and then you know you<font color="#E5E5E5"> just get the idea</font>

431
00:15:50,060 --> 00:15:53,329
<font color="#CCCCCC">of how the domains are being generated</font>

432
00:15:51,620 --> 00:15:55,459
<font color="#E5E5E5">so those are the power of domain</font>

433
00:15:53,329 --> 00:15:57,319
<font color="#E5E5E5">generation algorithms and when</font><font color="#CCCCCC"> dgs</font>

434
00:15:55,459 --> 00:15:59,270
generate domain we<font color="#CCCCCC"> Turman</font>

435
00:15:57,320 --> 00:16:01,820
we turn them as like algorithm generated

436
00:15:59,270 --> 00:16:04,730
domains<font color="#E5E5E5"> you can build</font><font color="#CCCCCC"> CNC</font><font color="#E5E5E5"> URLs out of it</font>

437
00:16:01,820 --> 00:16:06,740
as well<font color="#CCCCCC"> so in dynamic analysis</font><font color="#E5E5E5"> in a</font>

438
00:16:04,730 --> 00:16:08,840
control environment<font color="#CCCCCC"> in a</font><font color="#E5E5E5"> VM where you go</font>

439
00:16:06,740 --> 00:16:11,090
<font color="#CCCCCC">after you run the malware</font><font color="#E5E5E5"> you dump the</font>

440
00:16:08,840 --> 00:16:13,430
<font color="#E5E5E5">pcaps you start analyzing</font><font color="#CCCCCC"> you know how</font>

441
00:16:11,090 --> 00:16:15,530
the<font color="#E5E5E5"> network traffic looks like HTTP Laur</font>

442
00:16:13,430 --> 00:16:17,750
get requests are<font color="#E5E5E5"> going on post requests</font>

443
00:16:15,530 --> 00:16:20,150
are<font color="#E5E5E5"> going on and</font><font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to find out</font>

444
00:16:17,750 --> 00:16:22,610
anomalies in that for example simple

445
00:16:20,150 --> 00:16:25,430
<font color="#E5E5E5">anomaly you're sending the dot over HTTP</font>

446
00:16:22,610 --> 00:16:27,740
POST but the body<font color="#E5E5E5"> is encrypted basically</font>

447
00:16:25,430 --> 00:16:30,469
it<font color="#E5E5E5"> is a</font><font color="#CCCCCC"> deviation from</font><font color="#E5E5E5"> the HTTP RFC</font>

448
00:16:27,740 --> 00:16:31,760
standards because HTTP is<font color="#E5E5E5"> a clear text</font>

449
00:16:30,470 --> 00:16:33,470
protocol you don't need to have any

450
00:16:31,760 --> 00:16:35,630
encrypted<font color="#E5E5E5"> content and body and all that</font>

451
00:16:33,470 --> 00:16:37,160
so it's a couple<font color="#CCCCCC"> of these</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> you are</font>

452
00:16:35,630 --> 00:16:38,810
<font color="#E5E5E5">usually you get this intelligence you</font>

453
00:16:37,160 --> 00:16:40,939
analyze<font color="#E5E5E5"> more malware try to see</font>

454
00:16:38,810 --> 00:16:42,229
characteristics of other<font color="#CCCCCC"> bots and then</font>

455
00:16:40,940 --> 00:16:43,670
you<font color="#E5E5E5"> figure it out okay these are the</font>

456
00:16:42,230 --> 00:16:46,490
<font color="#CCCCCC">attacks these</font><font color="#E5E5E5"> are some of the techniques</font>

457
00:16:43,670 --> 00:16:47,780
they are using other<font color="#E5E5E5"> use cases that</font><font color="#CCCCCC"> you</font>

458
00:16:46,490 --> 00:16:50,450
know<font color="#E5E5E5"> whenever the send they make</font>

459
00:16:47,780 --> 00:16:52,280
<font color="#CCCCCC">mistakes like</font><font color="#E5E5E5"> Russians</font><font color="#CCCCCC"> other guys</font><font color="#E5E5E5"> were</font>

460
00:16:50,450 --> 00:16:54,320
<font color="#CCCCCC">actually drafting or in some Europe or</font>

461
00:16:52,280 --> 00:16:55,699
summation<font color="#E5E5E5"> whenever they are drafting any</font>

462
00:16:54,320 --> 00:16:57,620
kind of writing<font color="#CCCCCC"> a</font><font color="#E5E5E5"> code they make a</font>

463
00:16:55,700 --> 00:16:59,360
mistakes and HTTP headers or some other

464
00:16:57,620 --> 00:17:00,740
things<font color="#E5E5E5"> so these kind of anomalies you</font>

465
00:16:59,360 --> 00:17:03,170
keep on encountering while you're doing

466
00:17:00,740 --> 00:17:05,780
reverse engineering dynamic<font color="#E5E5E5"> analysis and</font>

467
00:17:03,170 --> 00:17:08,030
some stuff like that<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the third is</font>

468
00:17:05,780 --> 00:17:10,280
<font color="#E5E5E5">the most important part from</font><font color="#CCCCCC"> the static</font>

469
00:17:08,030 --> 00:17:12,500
analysis<font color="#CCCCCC"> and from the</font><font color="#E5E5E5"> dynamic analysis</font>

470
00:17:10,280 --> 00:17:14,540
<font color="#E5E5E5">you extract some got out you build some</font>

471
00:17:12,500 --> 00:17:16,880
signatures<font color="#E5E5E5"> and the most important part</font>

472
00:17:14,540 --> 00:17:18,949
<font color="#CCCCCC">that we all love</font><font color="#E5E5E5"> is Google right so</font>

473
00:17:16,880 --> 00:17:21,980
<font color="#E5E5E5">using Google</font><font color="#CCCCCC"> search</font><font color="#E5E5E5"> Docs you can still</font>

474
00:17:18,949 --> 00:17:22,939
detect<font color="#E5E5E5"> a lot of CNC panels</font><font color="#CCCCCC"> I'll show you</font>

475
00:17:21,980 --> 00:17:24,680
in a bit

476
00:17:22,939 --> 00:17:26,480
you have to<font color="#E5E5E5"> build patterns use Google</font>

477
00:17:24,680 --> 00:17:27,920
<font color="#E5E5E5">Docs and then just run your Python code</font>

478
00:17:26,480 --> 00:17:30,260
and then it's keep on detecting some

479
00:17:27,920 --> 00:17:32,810
similar set of web deployments and you

480
00:17:30,260 --> 00:17:35,270
can clearly see<font color="#E5E5E5"> that is so easy</font><font color="#CCCCCC"> that</font>

481
00:17:32,810 --> 00:17:37,700
<font color="#E5E5E5">Google index the CNC BOTS as well the</font>

482
00:17:35,270 --> 00:17:40,760
problem is<font color="#E5E5E5"> that most of the deployments</font>

483
00:17:37,700 --> 00:17:43,300
<font color="#E5E5E5">are the CNCs</font><font color="#CCCCCC"> of these kind</font><font color="#E5E5E5"> of stuff they</font>

484
00:17:40,760 --> 00:17:45,830
don't put<font color="#E5E5E5"> up like restriction on the</font>

485
00:17:43,300 --> 00:17:49,460
basically such<font color="#CCCCCC"> bots right so they just</font>

486
00:17:45,830 --> 00:17:52,340
go after find<font color="#E5E5E5"> okay just try to get every</font>

487
00:17:49,460 --> 00:17:54,020
HTML<font color="#E5E5E5"> page into a cache and</font><font color="#CCCCCC"> then they you</font>

488
00:17:52,340 --> 00:17:55,580
have the indexing ready and then<font color="#E5E5E5"> you</font>

489
00:17:54,020 --> 00:17:58,010
just use the<font color="#E5E5E5"> Google Docs they give you a</font>

490
00:17:55,580 --> 00:18:00,530
feel of it other one<font color="#E5E5E5"> is like hosting</font>

491
00:17:58,010 --> 00:18:02,540
providers<font color="#E5E5E5"> right data centers or</font><font color="#CCCCCC"> in cloud</font>

492
00:18:00,530 --> 00:18:05,120
or AWS<font color="#E5E5E5"> ones</font><font color="#CCCCCC"> rights where people are</font>

493
00:18:02,540 --> 00:18:07,129
hosting their VMs<font color="#E5E5E5"> and those VMs are also</font>

494
00:18:05,120 --> 00:18:09,439
<font color="#E5E5E5">getting infected compromised people are</font>

495
00:18:07,130 --> 00:18:11,299
deploying<font color="#E5E5E5"> C&C panels there as well so</font>

496
00:18:09,440 --> 00:18:13,100
<font color="#CCCCCC">you</font><font color="#E5E5E5"> need to have like some scanning</font>

497
00:18:11,299 --> 00:18:15,019
<font color="#CCCCCC">scripts you wanna up go</font><font color="#E5E5E5"> after and then</font>

498
00:18:13,100 --> 00:18:17,928
make<font color="#CCCCCC"> sure that you know you find some</font>

499
00:18:15,019 --> 00:18:20,360
kind of<font color="#E5E5E5"> patterns here as well at last</font>

500
00:18:17,929 --> 00:18:22,129
<font color="#E5E5E5">one of the important factor</font><font color="#CCCCCC"> also is</font>

501
00:18:20,360 --> 00:18:24,080
<font color="#CCCCCC">about threat intelligence gathering from</font>

502
00:18:22,129 --> 00:18:25,939
the open<font color="#E5E5E5"> source platforms or like paste</font>

503
00:18:24,080 --> 00:18:28,279
<font color="#CCCCCC">bins</font><font color="#E5E5E5"> and other kind of content</font><font color="#CCCCCC"> sharing</font>

504
00:18:25,940 --> 00:18:30,470
platforms<font color="#E5E5E5"> you you get a pretty good</font><font color="#CCCCCC"> feel</font>

505
00:18:28,279 --> 00:18:31,879
<font color="#CCCCCC">of it there are many good players in</font><font color="#E5E5E5"> the</font>

506
00:18:30,470 --> 00:18:34,549
market<font color="#CCCCCC"> right now</font><font color="#E5E5E5"> which are actually</font>

507
00:18:31,879 --> 00:18:36,949
mining<font color="#E5E5E5"> the information for us as well</font>

508
00:18:34,549 --> 00:18:38,600
<font color="#E5E5E5">but combining all these there are a</font>

509
00:18:36,950 --> 00:18:40,369
couple of other techniques<font color="#E5E5E5"> as well but</font>

510
00:18:38,600 --> 00:18:42,080
combining<font color="#E5E5E5"> all these techniques together</font>

511
00:18:40,369 --> 00:18:43,939
<font color="#E5E5E5">you can really build a good</font>

512
00:18:42,080 --> 00:18:46,699
fingerprinting solution and try<font color="#E5E5E5"> to see</font>

513
00:18:43,940 --> 00:18:49,100
that you<font color="#E5E5E5"> know how</font><font color="#CCCCCC"> Aidid to detect</font><font color="#E5E5E5"> CNC</font>

514
00:18:46,700 --> 00:18:52,369
panels for specifically that are<font color="#E5E5E5"> using</font>

515
00:18:49,100 --> 00:18:53,928
HTTP<font color="#E5E5E5"> protocol so let's just move further</font>

516
00:18:52,369 --> 00:18:55,820
and<font color="#E5E5E5"> give you a quick feel of it you know</font>

517
00:18:53,929 --> 00:18:57,590
just<font color="#CCCCCC"> a quick sniff</font><font color="#E5E5E5"> out of the</font>

518
00:18:55,820 --> 00:18:59,928
<font color="#CCCCCC">reverse-engineering so doing the looking</font>

519
00:18:57,590 --> 00:19:02,059
into<font color="#E5E5E5"> hard coded CNC so you can clearly</font>

520
00:18:59,929 --> 00:19:04,279
see one of the examples showing<font color="#E5E5E5"> the the</font>

521
00:19:02,059 --> 00:19:06,799
<font color="#CCCCCC">Mallo</font><font color="#E5E5E5"> is actually using tor network to</font>

522
00:19:04,279 --> 00:19:09,320
<font color="#E5E5E5">actually send the data out other one is</font>

523
00:19:06,799 --> 00:19:10,759
the is a pseudo code that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> drafted</font>

524
00:19:09,320 --> 00:19:12,350
<font color="#CCCCCC">after looking into the algorithm and</font>

525
00:19:10,759 --> 00:19:15,619
then we<font color="#CCCCCC"> just wrote the Python code try</font>

526
00:19:12,350 --> 00:19:18,168
to see how the you know domains are

527
00:19:15,619 --> 00:19:20,149
generated in an automated<font color="#E5E5E5"> fashion so you</font>

528
00:19:18,169 --> 00:19:22,220
have the seed value<font color="#CCCCCC"> you have the token</font>

529
00:19:20,149 --> 00:19:25,008
<font color="#CCCCCC">you just put that in</font><font color="#E5E5E5"> afterwards</font>

530
00:19:22,220 --> 00:19:26,989
engineering draft the code put that in

531
00:19:25,009 --> 00:19:29,419
and<font color="#E5E5E5"> you run the</font><font color="#CCCCCC"> Python code is gonna</font>

532
00:19:26,989 --> 00:19:32,330
<font color="#E5E5E5">give you</font><font color="#CCCCCC"> all that your</font><font color="#E5E5E5"> means right so</font>

533
00:19:29,419 --> 00:19:34,700
that's the way it is being<font color="#E5E5E5"> done for</font><font color="#CCCCCC"> from</font>

534
00:19:32,330 --> 00:19:36,889
the static analysis perspective<font color="#E5E5E5"> looking</font>

535
00:19:34,700 --> 00:19:39,320
at<font color="#E5E5E5"> the dynamic analysis when we try</font><font color="#CCCCCC"> to</font>

536
00:19:36,889 --> 00:19:42,619
<font color="#E5E5E5">look into the network traffic</font><font color="#CCCCCC"> you will</font>

537
00:19:39,320 --> 00:19:45,950
you can clearly<font color="#CCCCCC"> see that this one on the</font>

538
00:19:42,619 --> 00:19:47,720
<font color="#E5E5E5">top the first snapshot here the body is</font>

539
00:19:45,950 --> 00:19:49,429
<font color="#CCCCCC">actually generating running the domain</font>

540
00:19:47,720 --> 00:19:51,470
generation algorithm is generating the

541
00:19:49,429 --> 00:19:54,440
domain on<font color="#CCCCCC"> the fly</font><font color="#E5E5E5"> and it is sending the</font>

542
00:19:51,470 --> 00:19:57,590
<font color="#CCCCCC">the domain DNS queries try to make sure</font>

543
00:19:54,440 --> 00:20:00,139
<font color="#E5E5E5">that one domain out of the hundred is</font>

544
00:19:57,590 --> 00:20:03,289
<font color="#E5E5E5">Gerren it should resolve which attacker</font>

545
00:20:00,139 --> 00:20:05,449
is<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually set up for the CNC</font>

546
00:20:03,289 --> 00:20:07,399
communication so<font color="#CCCCCC"> it's gonna start in the</font>

547
00:20:05,450 --> 00:20:09,649
<font color="#CCCCCC">I</font><font color="#E5E5E5"> trade a fashion you know first domain</font>

548
00:20:07,399 --> 00:20:12,049
second<font color="#E5E5E5"> domain</font><font color="#CCCCCC"> on 200</font><font color="#E5E5E5"> or whatever the</font>

549
00:20:09,649 --> 00:20:13,699
numbers are<font color="#E5E5E5"> right one domain is resolved</font>

550
00:20:12,049 --> 00:20:16,070
<font color="#CCCCCC">it get the IP address it's</font><font color="#E5E5E5"> going to</font>

551
00:20:13,700 --> 00:20:17,389
start<font color="#E5E5E5"> communicating</font><font color="#CCCCCC"> but you can't detect</font>

552
00:20:16,070 --> 00:20:19,369
these kind of things directly<font color="#E5E5E5"> back into</font>

553
00:20:17,389 --> 00:20:20,899
<font color="#CCCCCC">the</font><font color="#E5E5E5"> reverse</font><font color="#CCCCCC"> engineering</font><font color="#E5E5E5"> until unless</font><font color="#CCCCCC"> you</font>

554
00:20:19,369 --> 00:20:22,879
fingerprint and try to find out what

555
00:20:20,899 --> 00:20:25,129
<font color="#CCCCCC">that algorithm</font><font color="#E5E5E5"> is all about run in a</font>

556
00:20:22,879 --> 00:20:28,899
controlled environment get all the

557
00:20:25,130 --> 00:20:31,520
<font color="#CCCCCC">domaine and then try to see from there</font>

558
00:20:28,900 --> 00:20:33,950
<font color="#E5E5E5">once the domain is is all the</font><font color="#CCCCCC"> bot is</font>

559
00:20:31,520 --> 00:20:36,500
<font color="#E5E5E5">actually sending data back</font><font color="#CCCCCC"> to the CNC</font>

560
00:20:33,950 --> 00:20:38,090
server<font color="#E5E5E5"> using the</font><font color="#CCCCCC"> HTTP protocol and</font>

561
00:20:36,500 --> 00:20:39,710
that's the example<font color="#CCCCCC"> I was giving you</font>

562
00:20:38,090 --> 00:20:42,379
earlier like you know it's still using

563
00:20:39,710 --> 00:20:44,240
the post<font color="#E5E5E5"> it's the HTTP communication but</font>

564
00:20:42,380 --> 00:20:46,970
the data<font color="#E5E5E5"> is encrypted</font><font color="#CCCCCC"> so these</font><font color="#E5E5E5"> kind of</font>

565
00:20:44,240 --> 00:20:48,950
<font color="#E5E5E5">anomalies we need to figure it out</font><font color="#CCCCCC"> to</font>

566
00:20:46,970 --> 00:20:51,730
make<font color="#CCCCCC"> sure that how to look at the data</font>

567
00:20:48,950 --> 00:20:53,540
from<font color="#E5E5E5"> the compromised machines</font>

568
00:20:51,730 --> 00:20:55,190
interesting one that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was talking about</font>

569
00:20:53,540 --> 00:20:59,270
on<font color="#E5E5E5"> the Google Docs or any search engine</font>

570
00:20:55,190 --> 00:21:00,980
<font color="#E5E5E5">Doc's here so this example is primarily</font>

571
00:20:59,270 --> 00:21:02,840
for<font color="#E5E5E5"> the LA keyboard so we</font><font color="#CCCCCC"> analyzed</font>

572
00:21:00,980 --> 00:21:05,120
couple of<font color="#CCCCCC"> CNC panels and we find out</font>

573
00:21:02,840 --> 00:21:06,770
that<font color="#CCCCCC"> these that the author of this</font>

574
00:21:05,120 --> 00:21:11,330
particular botnet they are actually

575
00:21:06,770 --> 00:21:13,340
<font color="#CCCCCC">using a random web page name with the</font>

576
00:21:11,330 --> 00:21:15,889
PHP one<font color="#E5E5E5"> basically is a PHP based random</font>

577
00:21:13,340 --> 00:21:17,810
web page name but it wasn't exactly<font color="#E5E5E5"> a</font>

578
00:21:15,890 --> 00:21:19,880
random<font color="#E5E5E5"> page right it looks like if you</font>

579
00:21:17,810 --> 00:21:22,220
see that it's generated random<font color="#E5E5E5"> but you</font>

580
00:21:19,880 --> 00:21:24,860
see wide variety of deployments the page

581
00:21:22,220 --> 00:21:26,540
was the<font color="#E5E5E5"> same so it means that it it just</font>

582
00:21:24,860 --> 00:21:27,830
try to you know fudge you from the

583
00:21:26,540 --> 00:21:30,170
perspective<font color="#CCCCCC"> that there might be some</font>

584
00:21:27,830 --> 00:21:32,240
another random generated web pages but

585
00:21:30,170 --> 00:21:33,770
<font color="#E5E5E5">it wasn't the case</font><font color="#CCCCCC"> so you build a simple</font>

586
00:21:32,240 --> 00:21:35,840
<font color="#CCCCCC">signature you run it through</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Google</font>

587
00:21:33,770 --> 00:21:38,360
<font color="#E5E5E5">Doc</font><font color="#CCCCCC"> engine and then you can clearly see</font>

588
00:21:35,840 --> 00:21:40,159
<font color="#CCCCCC">you started finding CNC panels on the</font>

589
00:21:38,360 --> 00:21:41,780
top<font color="#CCCCCC"> of it right so this</font><font color="#E5E5E5"> was just</font><font color="#CCCCCC"> a</font>

590
00:21:40,160 --> 00:21:44,000
<font color="#E5E5E5">simple google</font><font color="#CCCCCC"> search and you can clearly</font>

591
00:21:41,780 --> 00:21:46,430
see<font color="#E5E5E5"> the panels are coming up you</font><font color="#CCCCCC"> can see</font>

592
00:21:44,000 --> 00:21:49,400
which domains are you know compromised

593
00:21:46,430 --> 00:21:51,830
<font color="#E5E5E5">or specifically created for deploying</font>

594
00:21:49,400 --> 00:21:53,900
<font color="#E5E5E5">the CNC panels but this is one of the</font>

595
00:21:51,830 --> 00:21:57,139
most important another one<font color="#E5E5E5"> the example</font>

596
00:21:53,900 --> 00:21:58,790
is the<font color="#CCCCCC"> tesla agent you can</font><font color="#E5E5E5"> again build</font>

597
00:21:57,140 --> 00:22:01,070
up at<font color="#E5E5E5"> Google Doc</font><font color="#CCCCCC"> what it is all about</font>

598
00:21:58,790 --> 00:22:03,200
and then<font color="#CCCCCC"> you know pass it to the doc</font>

599
00:22:01,070 --> 00:22:04,850
<font color="#CCCCCC">engine to get a feel of it and you can</font>

600
00:22:03,200 --> 00:22:06,860
clearly<font color="#E5E5E5"> see the</font><font color="#CCCCCC"> Google is now indexing</font>

601
00:22:04,850 --> 00:22:09,679
the CNC panels<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are being</font><font color="#E5E5E5"> deployed</font>

602
00:22:06,860 --> 00:22:11,689
either uncompromised<font color="#E5E5E5"> domains or</font>

603
00:22:09,680 --> 00:22:14,870
basically<font color="#CCCCCC"> the one that we discussed</font>

604
00:22:11,690 --> 00:22:18,380
<font color="#CCCCCC">earlier but you can clearly see that</font><font color="#E5E5E5"> you</font>

605
00:22:14,870 --> 00:22:20,959
can still<font color="#E5E5E5"> get a hold of</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> that where</font>

606
00:22:18,380 --> 00:22:22,580
the<font color="#CCCCCC"> Tesla agents are but these kind of</font>

607
00:22:20,960 --> 00:22:24,230
things<font color="#CCCCCC"> these kind of signatures or these</font>

608
00:22:22,580 --> 00:22:25,939
kind<font color="#E5E5E5"> of intelligence you can only gather</font>

609
00:22:24,230 --> 00:22:28,460
once you you<font color="#E5E5E5"> know and do perform some</font>

610
00:22:25,940 --> 00:22:30,230
<font color="#E5E5E5">kind</font><font color="#CCCCCC"> of static</font><font color="#E5E5E5"> dynamic analysis or a</font>

611
00:22:28,460 --> 00:22:33,440
correlation between all those techniques

612
00:22:30,230 --> 00:22:35,720
to<font color="#CCCCCC"> get a better feel of</font><font color="#E5E5E5"> it but these</font><font color="#CCCCCC"> are</font>

613
00:22:33,440 --> 00:22:37,910
the most important techniques<font color="#CCCCCC"> and it's</font>

614
00:22:35,720 --> 00:22:38,750
security<font color="#E5E5E5"> just not only</font><font color="#CCCCCC"> all about a</font><font color="#E5E5E5"> one</font>

615
00:22:37,910 --> 00:22:40,580
layer it's like

616
00:22:38,750 --> 00:22:42,140
multiple<font color="#CCCCCC"> years and correlation between</font>

617
00:22:40,580 --> 00:22:44,270
those<font color="#CCCCCC"> layers</font><font color="#E5E5E5"> and trying to figure</font><font color="#CCCCCC"> it out</font>

618
00:22:42,140 --> 00:22:46,280
how we need<font color="#E5E5E5"> to connect</font><font color="#CCCCCC"> the dots</font><font color="#E5E5E5"> making</font>

619
00:22:44,270 --> 00:22:48,410
sure that we have a good story<font color="#CCCCCC"> before we</font>

620
00:22:46,280 --> 00:22:50,950
<font color="#CCCCCC">go</font><font color="#E5E5E5"> further and perform our further</font>

621
00:22:48,410 --> 00:22:53,420
analysis<font color="#E5E5E5"> or any kind of experimentation</font>

622
00:22:50,950 --> 00:22:55,940
<font color="#CCCCCC">so based on</font><font color="#E5E5E5"> all these things we</font><font color="#CCCCCC"> analyzed</font>

623
00:22:53,420 --> 00:22:57,530
couple of<font color="#CCCCCC"> CNC panels we working in the</font>

624
00:22:55,940 --> 00:22:59,930
same field for a couple of<font color="#E5E5E5"> years and</font>

625
00:22:57,530 --> 00:23:02,480
then<font color="#E5E5E5"> we came across we didn't find one</font>

626
00:22:59,930 --> 00:23:05,510
specific you know experiments were<font color="#CCCCCC"> not</font>

627
00:23:02,480 --> 00:23:07,070
conducted<font color="#E5E5E5"> in this context in which we</font>

628
00:23:05,510 --> 00:23:09,830
<font color="#CCCCCC">really want to</font><font color="#E5E5E5"> look like okay dump the</font>

629
00:23:07,070 --> 00:23:12,980
<font color="#E5E5E5">data dump the URL list basically</font><font color="#CCCCCC"> the C</font>

630
00:23:09,830 --> 00:23:14,600
<font color="#CCCCCC">and C URLs</font><font color="#E5E5E5"> and try to dissect those URLs</font>

631
00:23:12,980 --> 00:23:16,790
<font color="#E5E5E5">to understand the security</font><font color="#CCCCCC"> intelligence</font>

632
00:23:14,600 --> 00:23:18,649
<font color="#E5E5E5">or basically to gain more</font><font color="#CCCCCC"> security</font>

633
00:23:16,790 --> 00:23:20,330
intelligence<font color="#E5E5E5"> out of it what I mean by</font>

634
00:23:18,650 --> 00:23:21,500
<font color="#CCCCCC">that</font><font color="#E5E5E5"> I want to check how the domains are</font>

635
00:23:20,330 --> 00:23:24,800
<font color="#E5E5E5">generated I want to check how many</font>

636
00:23:21,500 --> 00:23:26,720
random<font color="#CCCCCC"> how would the entropy</font><font color="#E5E5E5"> of that</font><font color="#CCCCCC"> URL</font>

637
00:23:24,800 --> 00:23:29,960
is I also wanna check you<font color="#E5E5E5"> know what how</font>

638
00:23:26,720 --> 00:23:32,060
many CNC URLs were using<font color="#E5E5E5"> HTTP TPS how</font>

639
00:23:29,960 --> 00:23:33,710
many were using tor communication

640
00:23:32,060 --> 00:23:35,620
channel<font color="#E5E5E5"> so these kind of things like</font>

641
00:23:33,710 --> 00:23:38,030
<font color="#CCCCCC">that try to get get you a feel about</font>

642
00:23:35,620 --> 00:23:39,800
what we<font color="#E5E5E5"> are going to obtain as a part of</font>

643
00:23:38,030 --> 00:23:42,320
the security<font color="#CCCCCC"> intelligence and you can</font>

644
00:23:39,800 --> 00:23:44,690
use<font color="#E5E5E5"> that intelligence to build detection</font>

645
00:23:42,320 --> 00:23:46,429
<font color="#CCCCCC">solutions you know you</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> to mind some</font>

646
00:23:44,690 --> 00:23:47,960
<font color="#E5E5E5">that out of your</font><font color="#CCCCCC"> Splunk you can use that</font>

647
00:23:46,430 --> 00:23:50,120
if I see these kind<font color="#CCCCCC"> of patterns these</font>

648
00:23:47,960 --> 00:23:51,440
kind<font color="#E5E5E5"> of stuff feed it into</font><font color="#CCCCCC"> Splunk app</font>

649
00:23:50,120 --> 00:23:54,739
and then you<font color="#CCCCCC"> can clearly see what you</font>

650
00:23:51,440 --> 00:23:57,530
can<font color="#E5E5E5"> out of it so we did this empirical</font>

651
00:23:54,740 --> 00:24:01,430
analysis try to see what do you<font color="#CCCCCC"> want to</font>

652
00:23:57,530 --> 00:24:03,110
<font color="#E5E5E5">cover so in this particular case we</font>

653
00:24:01,430 --> 00:24:04,910
won't basically look into you know<font color="#E5E5E5"> where</font>

654
00:24:03,110 --> 00:24:07,459
domain names are<font color="#E5E5E5"> not used on the IP</font>

655
00:24:04,910 --> 00:24:10,460
<font color="#E5E5E5">addresses are used</font><font color="#CCCCCC"> you know non-standard</font>

656
00:24:07,460 --> 00:24:13,280
HTTP POST or based web communication<font color="#CCCCCC"> b</font>

657
00:24:10,460 --> 00:24:16,280
<font color="#CCCCCC">NS b c and c communication and cryptic</font>

658
00:24:13,280 --> 00:24:18,080
communication channel<font color="#E5E5E5"> how the botnet</font><font color="#CCCCCC"> cnc</font>

659
00:24:16,280 --> 00:24:20,270
panels are deployed like what kind<font color="#CCCCCC"> of</font>

660
00:24:18,080 --> 00:24:21,710
web technology the attackers<font color="#CCCCCC"> are using</font>

661
00:24:20,270 --> 00:24:24,680
to deploy these kind<font color="#E5E5E5"> of channels right</font>

662
00:24:21,710 --> 00:24:27,260
<font color="#E5E5E5">is PHP ASP aspx whatever it is all about</font>

663
00:24:24,680 --> 00:24:28,730
<font color="#E5E5E5">we really</font><font color="#CCCCCC"> wanna</font><font color="#E5E5E5"> see and we want to</font>

664
00:24:27,260 --> 00:24:30,620
<font color="#CCCCCC">perform a quantitative</font><font color="#E5E5E5"> and qualitative</font>

665
00:24:28,730 --> 00:24:32,600
analysis on the top of it because

666
00:24:30,620 --> 00:24:34,580
<font color="#CCCCCC">sometimes</font><font color="#E5E5E5"> you can get off when we are</font>

667
00:24:32,600 --> 00:24:37,459
<font color="#E5E5E5">performing experiments we really</font><font color="#CCCCCC"> want to</font>

668
00:24:34,580 --> 00:24:39,470
see the volumes right<font color="#E5E5E5"> I mean typically</font>

669
00:24:37,460 --> 00:24:40,940
in the field of just an<font color="#E5E5E5"> example in the</font>

670
00:24:39,470 --> 00:24:42,740
<font color="#E5E5E5">field of scalar white people say you</font>

671
00:24:40,940 --> 00:24:44,810
know we<font color="#E5E5E5"> don't have enough companies in</font>

672
00:24:42,740 --> 00:24:47,090
that<font color="#CCCCCC"> space that build a protection or</font>

673
00:24:44,810 --> 00:24:49,730
detection solution in that<font color="#E5E5E5"> context the</font>

674
00:24:47,090 --> 00:24:52,010
<font color="#CCCCCC">reason for that</font><font color="#E5E5E5"> is we have</font><font color="#CCCCCC"> only see very</font>

675
00:24:49,730 --> 00:24:52,400
few set<font color="#CCCCCC"> of attacks for example Stuxnet</font>

676
00:24:52,010 --> 00:24:54,020
do

677
00:24:52,400 --> 00:24:56,930
<font color="#E5E5E5">although they were very</font><font color="#CCCCCC"> aggressive but</font>

678
00:24:54,020 --> 00:24:59,240
<font color="#CCCCCC">the volume</font><font color="#E5E5E5"> not that high so that</font>

679
00:24:56,930 --> 00:25:01,310
<font color="#E5E5E5">actually derives the market to certain</font>

680
00:24:59,240 --> 00:25:02,900
extent<font color="#E5E5E5"> but</font><font color="#CCCCCC"> talk about Bitcoin mining</font>

681
00:25:01,310 --> 00:25:04,790
talk about other botnets that<font color="#E5E5E5"> are</font><font color="#CCCCCC"> youing</font>

682
00:25:02,900 --> 00:25:07,070
standard<font color="#E5E5E5"> these</font><font color="#CCCCCC"> have been</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> for years</font>

683
00:25:04,790 --> 00:25:08,899
and<font color="#E5E5E5"> years and why we have like</font><font color="#CCCCCC"> antivirus</font>

684
00:25:07,070 --> 00:25:10,370
is still existing<font color="#E5E5E5"> firewalls still there</font>

685
00:25:08,900 --> 00:25:12,590
<font color="#CCCCCC">although people are not happy with</font>

686
00:25:10,370 --> 00:25:15,260
antivirus<font color="#CCCCCC"> but it still has</font><font color="#E5E5E5"> to be on your</font>

687
00:25:12,590 --> 00:25:17,030
machine<font color="#CCCCCC"> so that's actually resonates</font>

688
00:25:15,260 --> 00:25:19,040
back to my earlier<font color="#CCCCCC"> point security is not</font>

689
00:25:17,030 --> 00:25:21,320
about<font color="#E5E5E5"> only one control but multiple</font>

690
00:25:19,040 --> 00:25:23,899
controls and the correlation among them

691
00:25:21,320 --> 00:25:26,149
we<font color="#E5E5E5"> will also want</font><font color="#CCCCCC"> to look at perform the</font>

692
00:25:23,900 --> 00:25:27,470
entropy mapping because let's say<font color="#E5E5E5"> you</font>

693
00:25:26,150 --> 00:25:29,900
<font color="#CCCCCC">want to write</font><font color="#E5E5E5"> us some fuzzing tool you</font>

694
00:25:27,470 --> 00:25:31,700
get a<font color="#E5E5E5"> one CNC URL and you are looking at</font>

695
00:25:29,900 --> 00:25:34,190
that<font color="#E5E5E5"> particular</font><font color="#CCCCCC"> URL and you wanna</font><font color="#E5E5E5"> fudge</font>

696
00:25:31,700 --> 00:25:36,320
more and then you write a Python code or

697
00:25:34,190 --> 00:25:38,450
any other code and then you can go<font color="#CCCCCC"> after</font>

698
00:25:36,320 --> 00:25:40,639
okay<font color="#E5E5E5"> take this URL as a baseline try to</font>

699
00:25:38,450 --> 00:25:42,920
<font color="#CCCCCC">I</font><font color="#E5E5E5"> trade the webpage name try to I trade</font>

700
00:25:40,640 --> 00:25:44,780
the numbers and<font color="#E5E5E5"> stuff like that so</font><font color="#CCCCCC"> when</font>

701
00:25:42,920 --> 00:25:46,940
you have an idea and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have a control</font>

702
00:25:44,780 --> 00:25:49,520
<font color="#CCCCCC">of certain</font><font color="#E5E5E5"> set</font><font color="#CCCCCC"> of data of</font><font color="#E5E5E5"> the CNC URLs</font>

703
00:25:46,940 --> 00:25:51,620
<font color="#E5E5E5">you can clearly see</font><font color="#CCCCCC"> what kind of entropy</font>

704
00:25:49,520 --> 00:25:54,139
<font color="#E5E5E5">is being set up for</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> URL so that</font>

705
00:25:51,620 --> 00:25:55,790
<font color="#CCCCCC">actually helps you</font><font color="#E5E5E5"> to write some go on</font>

706
00:25:54,140 --> 00:25:59,150
<font color="#E5E5E5">the</font><font color="#CCCCCC"> URL fuzzing tools and try to make</font>

707
00:25:55,790 --> 00:26:01,550
sure<font color="#CCCCCC"> that</font><font color="#E5E5E5"> whether you can find more CNC</font>

708
00:25:59,150 --> 00:26:03,890
panels out of it<font color="#E5E5E5"> for example we have</font>

709
00:26:01,550 --> 00:26:05,840
seen<font color="#CCCCCC"> recently</font><font color="#E5E5E5"> still the domain is the</font>

710
00:26:03,890 --> 00:26:08,090
<font color="#E5E5E5">same but the attackers have deployed</font>

711
00:26:05,840 --> 00:26:13,070
multiple CNC panels on the same domain

712
00:26:08,090 --> 00:26:15,649
or one panel on a one domain<font color="#E5E5E5"> and stuff</font>

713
00:26:13,070 --> 00:26:17,450
<font color="#E5E5E5">like that but usually</font><font color="#CCCCCC"> we understand that</font>

714
00:26:15,650 --> 00:26:19,730
<font color="#E5E5E5">okay if there is a one domain you know</font>

715
00:26:17,450 --> 00:26:21,260
one resources there only you say one<font color="#E5E5E5"> CNC</font>

716
00:26:19,730 --> 00:26:23,870
panel will be<font color="#E5E5E5"> here no but there can be</font>

717
00:26:21,260 --> 00:26:26,690
multiple<font color="#E5E5E5"> directories multiple CNC panels</font>

718
00:26:23,870 --> 00:26:28,820
will<font color="#CCCCCC"> be there this we have seen earlier</font>

719
00:26:26,690 --> 00:26:31,490
<font color="#E5E5E5">and we came across</font><font color="#CCCCCC"> there this is also</font><font color="#E5E5E5"> an</font>

720
00:26:28,820 --> 00:26:34,070
important fact when you study botnet<font color="#E5E5E5"> in</font>

721
00:26:31,490 --> 00:26:36,920
that context<font color="#CCCCCC"> so considering all</font><font color="#E5E5E5"> that</font>

722
00:26:34,070 --> 00:26:40,730
scenario<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> clean the data</font><font color="#CCCCCC"> we look at</font>

723
00:26:36,920 --> 00:26:43,040
that stuff<font color="#CCCCCC"> and some some inferences were</font>

724
00:26:40,730 --> 00:26:45,050
very very good<font color="#E5E5E5"> so we came across that</font>

725
00:26:43,040 --> 00:26:47,810
whenever the HTTP communication<font color="#CCCCCC"> takes</font>

726
00:26:45,050 --> 00:26:50,720
place<font color="#CCCCCC"> right it is not necessary that</font><font color="#E5E5E5"> in</font>

727
00:26:47,810 --> 00:26:52,639
the let's say<font color="#CCCCCC"> bot is sending HTTP POST</font>

728
00:26:50,720 --> 00:26:54,860
request out so there is a host header in

729
00:26:52,640 --> 00:26:57,650
that it's not necessary that<font color="#E5E5E5"> host header</font>

730
00:26:54,860 --> 00:27:00,139
has to have a domain<font color="#CCCCCC"> name</font><font color="#E5E5E5"> which means</font>

731
00:26:57,650 --> 00:27:02,150
that if<font color="#E5E5E5"> the attackers if the</font><font color="#CCCCCC"> bot is</font>

732
00:27:00,140 --> 00:27:04,250
<font color="#E5E5E5">actually sending the HTTP traffic using</font>

733
00:27:02,150 --> 00:27:06,240
an IP address<font color="#E5E5E5"> as the destination</font>

734
00:27:04,250 --> 00:27:09,960
there will be no<font color="#CCCCCC"> dns try</font>

735
00:27:06,240 --> 00:27:11,790
for that<font color="#E5E5E5"> and that you if your solutions</font>

736
00:27:09,960 --> 00:27:13,559
are<font color="#CCCCCC"> based on the artifact that okay we</font>

737
00:27:11,790 --> 00:27:15,240
need to first see the<font color="#E5E5E5"> DNS traffic then</font>

738
00:27:13,559 --> 00:27:17,190
the HTTP traffic that it<font color="#CCCCCC"> basically</font>

739
00:27:15,240 --> 00:27:18,809
bypasses it because there is no<font color="#E5E5E5"> domain</font>

740
00:27:17,190 --> 00:27:20,340
browser is<font color="#E5E5E5"> not gonna resolve that domain</font>

741
00:27:18,809 --> 00:27:21,960
<font color="#CCCCCC">it's still gonna initiate</font><font color="#E5E5E5"> a socket</font>

742
00:27:20,340 --> 00:27:24,928
<font color="#E5E5E5">connection</font><font color="#CCCCCC"> back to</font><font color="#E5E5E5"> the IP address and</font>

743
00:27:21,960 --> 00:27:28,440
<font color="#E5E5E5">start sending data on the fly</font><font color="#CCCCCC"> so these</font>

744
00:27:24,929 --> 00:27:29,910
kind of<font color="#E5E5E5"> things are very important and we</font>

745
00:27:28,440 --> 00:27:31,770
see that<font color="#E5E5E5"> eighteen percent close to</font>

746
00:27:29,910 --> 00:27:34,100
eighteen percent was like the

747
00:27:31,770 --> 00:27:36,030
deployments that<font color="#E5E5E5"> we analyzed for the C&C</font>

748
00:27:34,100 --> 00:27:38,969
<font color="#E5E5E5">they were actual using IP based</font>

749
00:27:36,030 --> 00:27:41,399
communication but still as we discussed

750
00:27:38,970 --> 00:27:43,110
earlier<font color="#CCCCCC"> the</font><font color="#E5E5E5"> volume based right look at</font>

751
00:27:41,400 --> 00:27:44,580
the<font color="#E5E5E5"> DNS base CNC communication</font>

752
00:27:43,110 --> 00:27:47,490
<font color="#CCCCCC">eighty-one percent we're using the</font>

753
00:27:44,580 --> 00:27:49,320
domain names<font color="#CCCCCC"> so it makes</font><font color="#E5E5E5"> sense we need a</font>

754
00:27:47,490 --> 00:27:50,970
DNS<font color="#E5E5E5"> based solutions that actually you</font>

755
00:27:49,320 --> 00:27:53,250
know dissect the DNS traffic and gives

756
00:27:50,970 --> 00:27:55,230
us the idea right<font color="#E5E5E5"> what are</font><font color="#CCCCCC"> that</font>

757
00:27:53,250 --> 00:27:57,390
normalities in the DNS<font color="#E5E5E5"> traffic is</font><font color="#CCCCCC"> right</font>

758
00:27:55,230 --> 00:27:58,650
<font color="#E5E5E5">the domain generation algorithms the DNS</font>

759
00:27:57,390 --> 00:28:00,900
handling and all those sort of things

760
00:27:58,650 --> 00:28:02,910
<font color="#CCCCCC">but this actually gives you idea like</font>

761
00:28:00,900 --> 00:28:07,440
domain names are still<font color="#E5E5E5"> being manipulated</font>

762
00:28:02,910 --> 00:28:09,540
<font color="#CCCCCC">to a greater extent so we also look into</font>

763
00:28:07,440 --> 00:28:11,100
<font color="#E5E5E5">a non-standard HTTP port so I have a lot</font>

764
00:28:09,540 --> 00:28:12,899
of discussions going<font color="#E5E5E5"> in a community</font>

765
00:28:11,100 --> 00:28:14,520
where<font color="#CCCCCC"> people say if you are doing</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> GD</font>

766
00:28:12,900 --> 00:28:17,130
<font color="#CCCCCC">P connection either is gonna be on port</font>

767
00:28:14,520 --> 00:28:18,840
80 443 eighty eighty eight zero eight

768
00:28:17,130 --> 00:28:20,670
<font color="#CCCCCC">one and</font><font color="#E5E5E5"> stuff like that that is not</font>

769
00:28:18,840 --> 00:28:22,320
<font color="#E5E5E5">entirely true</font><font color="#CCCCCC"> I mean you can't deploy a</font>

770
00:28:20,670 --> 00:28:24,030
web<font color="#E5E5E5"> server or any port just you have to</font>

771
00:28:22,320 --> 00:28:26,129
bind on that particular port to start

772
00:28:24,030 --> 00:28:28,470
listening<font color="#CCCCCC"> to your web connections so</font><font color="#E5E5E5"> we</font>

773
00:28:26,130 --> 00:28:31,650
found<font color="#CCCCCC"> that at least not enough but still</font>

774
00:28:28,470 --> 00:28:34,080
<font color="#CCCCCC">1.2 to</font><font color="#E5E5E5"> 1.3 percent</font><font color="#CCCCCC"> although twelve</font>

775
00:28:31,650 --> 00:28:35,280
<font color="#CCCCCC">thousand CNC URLs are we</font><font color="#E5E5E5"> analyzed they</font>

776
00:28:34,080 --> 00:28:37,770
were actually using<font color="#E5E5E5"> the non-standard</font>

777
00:28:35,280 --> 00:28:39,899
HTTP ports<font color="#E5E5E5"> which means that if at the</font>

778
00:28:37,770 --> 00:28:42,000
<font color="#E5E5E5">firewall or at any place if your</font>

779
00:28:39,900 --> 00:28:43,440
<font color="#CCCCCC">solution is just</font><font color="#E5E5E5"> or any signature that</font>

780
00:28:42,000 --> 00:28:45,660
<font color="#E5E5E5">you</font><font color="#CCCCCC"> have deployed as a part of</font><font color="#E5E5E5"> your</font>

781
00:28:43,440 --> 00:28:48,330
security operation that is only looking

782
00:28:45,660 --> 00:28:50,400
<font color="#E5E5E5">into</font><font color="#CCCCCC"> ok TCP port 80 four four three</font>

783
00:28:48,330 --> 00:28:52,379
<font color="#CCCCCC">eight zero at zero</font><font color="#E5E5E5"> it can bypass that</font>

784
00:28:50,400 --> 00:28:54,390
rule on the fly<font color="#CCCCCC"> so this is also an</font>

785
00:28:52,380 --> 00:28:56,420
<font color="#CCCCCC">interesting in tally engines that we</font>

786
00:28:54,390 --> 00:28:59,160
need to incorporate<font color="#E5E5E5"> into the tools and</font>

787
00:28:56,420 --> 00:29:01,500
<font color="#CCCCCC">cryptid</font><font color="#E5E5E5"> SSL connections yes we've seen</font>

788
00:28:59,160 --> 00:29:03,150
<font color="#E5E5E5">that where you know there were no</font>

789
00:29:01,500 --> 00:29:07,110
<font color="#E5E5E5">validated certificates but it was just</font>

790
00:29:03,150 --> 00:29:09,000
<font color="#E5E5E5">only 0.5 percent so still adverse</font><font color="#CCCCCC"> rays</font>

791
00:29:07,110 --> 00:29:10,530
<font color="#E5E5E5">bought and operators</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> attackers are</font>

792
00:29:09,000 --> 00:29:12,300
going<font color="#E5E5E5"> after clear text HTTP</font>

793
00:29:10,530 --> 00:29:13,559
<font color="#CCCCCC">communication to a great extent</font><font color="#E5E5E5"> it</font>

794
00:29:12,300 --> 00:29:16,649
doesn't mean<font color="#CCCCCC"> that they are not using</font>

795
00:29:13,559 --> 00:29:19,168
<font color="#CCCCCC">HTTP advanced botnets might be using but</font>

796
00:29:16,650 --> 00:29:20,100
for the<font color="#E5E5E5"> distributed infections that acts</font>

797
00:29:19,169 --> 00:29:22,020
<font color="#CCCCCC">that are not pretty much</font>

798
00:29:20,100 --> 00:29:23,549
targeted in nature they are actually go

799
00:29:22,020 --> 00:29:26,010
after<font color="#E5E5E5"> okay we don't care we just</font><font color="#CCCCCC"> want to</font>

800
00:29:23,549 --> 00:29:28,950
send<font color="#CCCCCC"> that</font><font color="#E5E5E5"> out and why they are able to</font>

801
00:29:26,010 --> 00:29:31,039
<font color="#E5E5E5">use abuse HTTP protocol because</font><font color="#CCCCCC"> this in</font>

802
00:29:28,950 --> 00:29:33,539
<font color="#E5E5E5">empower it's a very default</font>

803
00:29:31,039 --> 00:29:35,610
configuration every firewall needs to

804
00:29:33,539 --> 00:29:37,320
allow the HTTP traffic because that's

805
00:29:35,610 --> 00:29:39,059
how we browse the web so<font color="#CCCCCC"> they are</font>

806
00:29:37,320 --> 00:29:41,129
<font color="#E5E5E5">actually making that behavior</font><font color="#CCCCCC"> abused</font>

807
00:29:39,059 --> 00:29:43,139
some HTTP communication<font color="#E5E5E5"> channel and then</font>

808
00:29:41,130 --> 00:29:45,090
send the traffic<font color="#E5E5E5"> out of it and then you</font>

809
00:29:43,140 --> 00:29:47,700
need<font color="#CCCCCC"> to have ids/ips whatever it is</font>

810
00:29:45,090 --> 00:29:50,520
there to<font color="#E5E5E5"> actually dissect that content</font>

811
00:29:47,700 --> 00:29:53,730
making<font color="#E5E5E5"> sure that nothing's you know</font>

812
00:29:50,520 --> 00:29:54,929
sensitive goes out but but when you try

813
00:29:53,730 --> 00:29:56,730
to correlate<font color="#E5E5E5"> all this kind of</font>

814
00:29:54,929 --> 00:29:58,380
<font color="#CCCCCC">information it gives</font><font color="#E5E5E5"> you a very</font>

815
00:29:56,730 --> 00:29:59,490
<font color="#E5E5E5">different scenario looking at how you</font>

816
00:29:58,380 --> 00:30:01,650
need<font color="#E5E5E5"> to build a solution</font>

817
00:29:59,490 --> 00:30:03,539
<font color="#E5E5E5">you wanna define machine learning when I</font>

818
00:30:01,650 --> 00:30:04,710
define some algorithm based on<font color="#E5E5E5"> that you</font>

819
00:30:03,539 --> 00:30:06,570
wanna go after<font color="#E5E5E5"> a natural language</font>

820
00:30:04,710 --> 00:30:08,159
processing whatever<font color="#E5E5E5"> it is this is the</font>

821
00:30:06,570 --> 00:30:10,428
intelligence that<font color="#E5E5E5"> make your machine</font>

822
00:30:08,159 --> 00:30:12,840
learning algorithms<font color="#CCCCCC"> out of the flow</font>

823
00:30:10,429 --> 00:30:14,730
sometimes<font color="#CCCCCC"> you can clearly see anomalies</font>

824
00:30:12,840 --> 00:30:16,408
based on the data<font color="#E5E5E5"> but this intelligent</font>

825
00:30:14,730 --> 00:30:18,990
these kind of intelligence makes it way

826
00:30:16,409 --> 00:30:22,110
different<font color="#E5E5E5"> may advanced when you build</font>

827
00:30:18,990 --> 00:30:24,150
<font color="#E5E5E5">when you use data based approach to</font><font color="#CCCCCC"> for</font>

828
00:30:22,110 --> 00:30:26,219
<font color="#CCCCCC">detection and protection server side</font>

829
00:30:24,150 --> 00:30:29,370
deployment<font color="#E5E5E5"> PHP is the preferred choice</font>

830
00:30:26,220 --> 00:30:33,030
right<font color="#E5E5E5"> open source easy to code and all</font>

831
00:30:29,370 --> 00:30:36,209
that 96% 96% out of those<font color="#CCCCCC"> URLs were</font>

832
00:30:33,030 --> 00:30:37,559
<font color="#E5E5E5">using PHP based C and C's right so the</font>

833
00:30:36,210 --> 00:30:38,820
way they have<font color="#E5E5E5"> deployed command and</font>

834
00:30:37,559 --> 00:30:43,020
controls<font color="#E5E5E5"> the way they have written is</font>

835
00:30:38,820 --> 00:30:46,350
using PHP only<font color="#E5E5E5"> word</font><font color="#CCCCCC"> which saw only 0.625</font>

836
00:30:43,020 --> 00:30:46,740
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> using ASP yes p.net stuff like</font>

837
00:30:46,350 --> 00:30:48,629
that

838
00:30:46,740 --> 00:30:50,580
so it basically based<font color="#E5E5E5"> on the volume</font>

839
00:30:48,630 --> 00:30:52,860
<font color="#E5E5E5">based analysis at the end of the day</font>

840
00:30:50,580 --> 00:30:54,389
<font color="#E5E5E5">it's done</font><font color="#CCCCCC"> it's the PHP is a preferred</font>

841
00:30:52,860 --> 00:30:56,100
choice<font color="#CCCCCC"> so when you're building your</font>

842
00:30:54,390 --> 00:30:58,470
signatures your rules and your<font color="#E5E5E5"> other</font>

843
00:30:56,100 --> 00:31:00,299
stuff<font color="#E5E5E5"> like that that is the intelligence</font>

844
00:30:58,470 --> 00:31:02,580
you really need to go after<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> I can I</font>

845
00:31:00,299 --> 00:31:04,230
can just chop<font color="#CCCCCC"> up the window for</font><font color="#E5E5E5"> the</font>

846
00:31:02,580 --> 00:31:05,908
other set of<font color="#E5E5E5"> server-side deployments but</font>

847
00:31:04,230 --> 00:31:08,610
for this particular<font color="#CCCCCC"> one</font><font color="#E5E5E5"> I need to have a</font>

848
00:31:05,909 --> 00:31:11,159
stronger rules<font color="#E5E5E5"> we look into the</font><font color="#CCCCCC"> C&C</font>

849
00:31:08,610 --> 00:31:14,010
<font color="#E5E5E5">panas deployed on</font><font color="#CCCCCC"> the compromised web</font>

850
00:31:11,159 --> 00:31:15,600
WordPress because<font color="#CCCCCC"> WordPress Joomla</font><font color="#E5E5E5"> and</font>

851
00:31:14,010 --> 00:31:16,860
all<font color="#E5E5E5"> other kind of thing they are being</font>

852
00:31:15,600 --> 00:31:18,510
you know<font color="#E5E5E5"> some kind of vulnerabilities</font>

853
00:31:16,860 --> 00:31:20,370
came in and then you<font color="#CCCCCC"> just simply run the</font>

854
00:31:18,510 --> 00:31:23,158
<font color="#E5E5E5">exploit start deploying the web</font>

855
00:31:20,370 --> 00:31:25,110
<font color="#E5E5E5">resources</font><font color="#CCCCCC"> webpage is either used for</font>

856
00:31:23,159 --> 00:31:27,090
distributed in factions<font color="#E5E5E5"> or other stuff</font>

857
00:31:25,110 --> 00:31:29,689
like<font color="#E5E5E5"> that we still</font><font color="#CCCCCC"> found that the</font>

858
00:31:27,090 --> 00:31:32,639
attackers use the compromised<font color="#CCCCCC"> WordPress</font>

859
00:31:29,690 --> 00:31:33,720
<font color="#E5E5E5">deployments 4.8%</font><font color="#CCCCCC"> which is still a good</font>

860
00:31:32,640 --> 00:31:36,300
<font color="#E5E5E5">number then say</font>

861
00:31:33,720 --> 00:31:38,640
<font color="#E5E5E5">during that so considering all that</font>

862
00:31:36,300 --> 00:31:40,350
Analia we typically<font color="#E5E5E5"> pick</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> the seven</font>

863
00:31:38,640 --> 00:31:42,360
<font color="#E5E5E5">eight or other kind of metrics trying to</font>

864
00:31:40,350 --> 00:31:45,149
<font color="#E5E5E5">us</font><font color="#CCCCCC"> these variables and build a matrix</font>

865
00:31:42,360 --> 00:31:46,679
out of it and try<font color="#CCCCCC"> to get feel that you</font>

866
00:31:45,150 --> 00:31:48,390
know how these<font color="#CCCCCC"> botnets are being</font>

867
00:31:46,680 --> 00:31:49,950
operating right we understand the

868
00:31:48,390 --> 00:31:51,930
<font color="#CCCCCC">architecture we understand the design</font>

869
00:31:49,950 --> 00:31:54,210
components but at the end<font color="#E5E5E5"> of the way</font>

870
00:31:51,930 --> 00:31:56,520
these stats these numbers gives you a

871
00:31:54,210 --> 00:31:58,080
feel that<font color="#E5E5E5"> you know where we need to go</font>

872
00:31:56,520 --> 00:31:59,850
after<font color="#E5E5E5"> when we try to build advanced</font>

873
00:31:58,080 --> 00:32:02,699
<font color="#E5E5E5">level of network detection and</font>

874
00:31:59,850 --> 00:32:04,860
<font color="#E5E5E5">production solutions another one</font>

875
00:32:02,700 --> 00:32:06,450
important one is<font color="#CCCCCC"> duh you know that how</font>

876
00:32:04,860 --> 00:32:08,129
<font color="#E5E5E5">the</font><font color="#CCCCCC"> top-level domains are being used</font>

877
00:32:06,450 --> 00:32:10,350
like so when the attacker is registering

878
00:32:08,130 --> 00:32:12,090
a domain what kind of domain it<font color="#CCCCCC"> is going</font>

879
00:32:10,350 --> 00:32:15,199
<font color="#CCCCCC">after it's a comm is</font><font color="#E5E5E5"> the org or whatever</font>

880
00:32:12,090 --> 00:32:19,639
it is<font color="#E5E5E5"> without a doubt we found that</font>

881
00:32:15,200 --> 00:32:22,350
<font color="#CCCCCC">approximately like 40 to 45 percent or</font>

882
00:32:19,640 --> 00:32:24,750
<font color="#CCCCCC">thirty eight to forty</font><font color="#E5E5E5"> percent exactly</font>

883
00:32:22,350 --> 00:32:26,610
we're using the dot-com domain<font color="#CCCCCC"> why four</font>

884
00:32:24,750 --> 00:32:29,250
means like<font color="#E5E5E5"> com they have their cnc</font>

885
00:32:26,610 --> 00:32:31,530
deployed on a like abc.com<font color="#CCCCCC"> or some stuff</font>

886
00:32:29,250 --> 00:32:33,990
like that<font color="#CCCCCC"> and similarly we</font><font color="#E5E5E5"> analyze a lot</font>

887
00:32:31,530 --> 00:32:36,990
<font color="#E5E5E5">of things you know dot</font><font color="#CCCCCC"> r u dot net dot</font>

888
00:32:33,990 --> 00:32:39,690
dot<font color="#E5E5E5"> base dot</font><font color="#CCCCCC"> infor heavily heavily being</font>

889
00:32:36,990 --> 00:32:43,890
used domains where they have deployed

890
00:32:39,690 --> 00:32:46,740
<font color="#E5E5E5">their cnc panels moving further just the</font>

891
00:32:43,890 --> 00:32:49,170
entropy<font color="#E5E5E5"> once we found that the majority</font>

892
00:32:46,740 --> 00:32:51,540
<font color="#CCCCCC">of URLs were not that random in nature</font>

893
00:32:49,170 --> 00:32:53,100
<font color="#E5E5E5">so let's say you have a abc.com and then</font>

894
00:32:51,540 --> 00:32:55,620
you further go<font color="#E5E5E5"> had there's a resource</font>

895
00:32:53,100 --> 00:32:57,270
one and then there is a<font color="#CCCCCC"> webpage name</font><font color="#E5E5E5"> you</font>

896
00:32:55,620 --> 00:32:58,679
can still build build a<font color="#CCCCCC"> fuzzer and then</font>

897
00:32:57,270 --> 00:32:59,129
you can still you<font color="#E5E5E5"> know keep on running</font>

898
00:32:58,680 --> 00:33:01,410
the fuzzer

899
00:32:59,130 --> 00:33:03,930
using<font color="#E5E5E5"> different resources</font><font color="#CCCCCC"> and then you</font>

900
00:33:01,410 --> 00:33:06,150
find<font color="#E5E5E5"> that if you basically it resolves</font>

901
00:33:03,930 --> 00:33:07,680
it actually accepts your request<font color="#CCCCCC"> you get</font>

902
00:33:06,150 --> 00:33:09,690
a feel of it that there's a<font color="#E5E5E5"> similar kind</font>

903
00:33:07,680 --> 00:33:11,640
<font color="#E5E5E5">of resources</font><font color="#CCCCCC"> there so from the entropy</font>

904
00:33:09,690 --> 00:33:14,700
perspective we didn't find like they

905
00:33:11,640 --> 00:33:19,050
were not generating the<font color="#E5E5E5"> cnc urls to</font><font color="#CCCCCC"> a</font>

906
00:33:14,700 --> 00:33:21,750
greater<font color="#E5E5E5"> extent so</font><font color="#CCCCCC"> I think we're</font><font color="#E5E5E5"> doing</font>

907
00:33:19,050 --> 00:33:23,879
<font color="#CCCCCC">just</font><font color="#E5E5E5"> close I just want a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit talk</font>

908
00:33:21,750 --> 00:33:25,800
about the you know<font color="#CCCCCC"> arms race we all know</font>

909
00:33:23,880 --> 00:33:28,320
about<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is all</font><font color="#E5E5E5"> about attackers and</font>

910
00:33:25,800 --> 00:33:30,060
defenders<font color="#E5E5E5"> but again at the end of the</font>

911
00:33:28,320 --> 00:33:31,530
<font color="#E5E5E5">advance exploits are coming up at one</font>

912
00:33:30,060 --> 00:33:33,840
<font color="#E5E5E5">security protection and detection</font>

913
00:33:31,530 --> 00:33:35,820
mechanisms are put in place<font color="#E5E5E5"> but still we</font>

914
00:33:33,840 --> 00:33:37,470
see<font color="#CCCCCC"> security breaches and all that this</font>

915
00:33:35,820 --> 00:33:39,240
<font color="#CCCCCC">is this race is</font><font color="#E5E5E5"> never going to be ending</font>

916
00:33:37,470 --> 00:33:41,220
<font color="#E5E5E5">wherever things that are gonna end the</font>

917
00:33:39,240 --> 00:33:43,440
race then the market will<font color="#CCCCCC"> be gone right</font>

918
00:33:41,220 --> 00:33:45,570
<font color="#E5E5E5">so most important artifact is who is</font>

919
00:33:43,440 --> 00:33:47,670
going<font color="#CCCCCC"> to take the</font><font color="#E5E5E5"> first step right</font><font color="#CCCCCC"> as a</font>

920
00:33:45,570 --> 00:33:48,990
security practitioner researchers

921
00:33:47,670 --> 00:33:52,110
<font color="#CCCCCC">who's gonna come after building</font><font color="#E5E5E5"> strong</font>

922
00:33:48,990 --> 00:33:54,500
security intelligent driven<font color="#E5E5E5"> solutions</font>

923
00:33:52,110 --> 00:33:57,419
based<font color="#E5E5E5"> on what we have</font><font color="#CCCCCC"> seen in the</font>

924
00:33:54,500 --> 00:33:59,280
<font color="#E5E5E5">history and what we are expecting it to</font>

925
00:33:57,420 --> 00:34:00,600
coming in the<font color="#E5E5E5"> future but again at the</font>

926
00:33:59,280 --> 00:34:03,210
end<font color="#E5E5E5"> of the day we are dealing</font><font color="#CCCCCC"> with the</font>

927
00:34:00,600 --> 00:34:05,520
world<font color="#CCCCCC"> the</font><font color="#E5E5E5"> data movement is all time high</font>

928
00:34:03,210 --> 00:34:08,820
complexity<font color="#E5E5E5"> components away they are</font>

929
00:34:05,520 --> 00:34:10,350
<font color="#E5E5E5">design all complex your data is just</font>

930
00:34:08,820 --> 00:34:12,090
left your phone you<font color="#E5E5E5"> don't know where it</font>

931
00:34:10,350 --> 00:34:14,668
<font color="#E5E5E5">is going on we have seen</font><font color="#CCCCCC"> many cases</font>

932
00:34:12,090 --> 00:34:17,220
<font color="#E5E5E5">where you we just don't have any clue we</font>

933
00:34:14,668 --> 00:34:19,139
talked all about privacy<font color="#E5E5E5"> all the time</font>

934
00:34:17,219 --> 00:34:20,580
<font color="#E5E5E5">but the world works in different</font><font color="#CCCCCC"> way</font>

935
00:34:19,139 --> 00:34:22,230
<font color="#E5E5E5">this is what the reality</font><font color="#CCCCCC"> of the world we</font>

936
00:34:20,580 --> 00:34:23,940
<font color="#CCCCCC">live in</font><font color="#E5E5E5"> so then say during all that</font>

937
00:34:22,230 --> 00:34:25,770
<font color="#E5E5E5">scenario at the end of the day we need</font>

938
00:34:23,940 --> 00:34:27,450
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> proactive</font><font color="#CCCCCC"> we need to share the</font>

939
00:34:25,770 --> 00:34:29,449
<font color="#CCCCCC">research with</font><font color="#E5E5E5"> the security community</font><font color="#CCCCCC"> and</font>

940
00:34:27,449 --> 00:34:34,859
<font color="#E5E5E5">making sure that we build stronger</font>

941
00:34:29,449 --> 00:34:36,719
correction<font color="#E5E5E5"> and detection solutions so so</font>

942
00:34:34,860 --> 00:34:38,190
I think<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> much from a time so</font>

943
00:34:36,719 --> 00:34:40,089
if<font color="#E5E5E5"> you have any additional questions we</font>

944
00:34:38,190 --> 00:34:45,359
<font color="#E5E5E5">can talk or we can talk about later</font>

945
00:34:40,090 --> 00:34:45,359
[Applause]

