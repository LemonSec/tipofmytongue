1
00:00:00,160 --> 00:00:03,199
all right so um anyways we got a special

2
00:00:03,199 --> 00:00:06,560
guest here today amal sarwat

3
00:00:06,560 --> 00:00:10,400
and uh he has a uh tremendous background

4
00:00:10,400 --> 00:00:12,480
in cyber security

5
00:00:12,480 --> 00:00:14,080
uh particularly

6
00:00:14,080 --> 00:00:15,679
with um

7
00:00:15,679 --> 00:00:18,240
let's see i believe you work for fidelis

8
00:00:18,240 --> 00:00:20,240
and cloud passage worldwide

9
00:00:20,240 --> 00:00:22,960
threat and security research labs

10
00:00:22,960 --> 00:00:24,960
uh responsible for network endpoints and

11
00:00:24,960 --> 00:00:29,039
clouds uh he's devoted his career um to

12
00:00:29,039 --> 00:00:31,279
protecting and securing educating the

13
00:00:31,279 --> 00:00:32,719
community

14
00:00:32,719 --> 00:00:34,880
from threats um

15
00:00:34,880 --> 00:00:36,640
got a lot of background in vulnerability

16
00:00:36,640 --> 00:00:38,320
research malware

17
00:00:38,320 --> 00:00:39,280
um

18
00:00:39,280 --> 00:00:40,480
iot

19
00:00:40,480 --> 00:00:44,480
scada security and uh been in this for

20
00:00:44,480 --> 00:00:46,559
two decades now right

21
00:00:46,559 --> 00:00:48,399
okay so what we're going to talk about

22
00:00:48,399 --> 00:00:50,719
today is threat hunting using mitre

23
00:00:50,719 --> 00:00:53,360
attack against carbonac malware very

24
00:00:53,360 --> 00:00:56,480
nasty malware out there so please give a

25
00:00:56,480 --> 00:01:00,320
warm welcome to our speaker here

26
00:01:00,320 --> 00:01:01,850
i'm all

27
00:01:01,850 --> 00:01:04,959
[Applause]

28
00:01:04,959 --> 00:01:08,199
thank you

29
00:01:18,799 --> 00:01:20,640
what now

30
00:01:20,640 --> 00:01:22,880
good

31
00:01:23,360 --> 00:01:26,840
you thank you

32
00:01:39,840 --> 00:01:41,040
how about now

33
00:01:41,040 --> 00:01:42,880
good

34
00:01:42,880 --> 00:01:44,479
okay

35
00:01:44,479 --> 00:01:45,600
now

36
00:01:45,600 --> 00:01:48,399
i'll just speak up a little bit

37
00:01:48,399 --> 00:01:50,240
all right uh thank you thank you for

38
00:01:50,240 --> 00:01:52,399
being here i am actually super excited

39
00:01:52,399 --> 00:01:53,360
to

40
00:01:53,360 --> 00:01:55,439
to come here for a face-to-face

41
00:01:55,439 --> 00:01:57,920
conference after about like two years i

42
00:01:57,920 --> 00:02:00,640
think uh should couldn't could be the

43
00:02:00,640 --> 00:02:03,439
same with some of you or most of you so

44
00:02:03,439 --> 00:02:05,840
really nice to be here especially at b

45
00:02:05,840 --> 00:02:07,600
sites where

46
00:02:07,600 --> 00:02:11,120
always the focus is on on community and

47
00:02:11,120 --> 00:02:12,640
collaboration

48
00:02:12,640 --> 00:02:16,800
so let's get started uh as as it was

49
00:02:16,800 --> 00:02:18,959
introduced this session is about threat

50
00:02:18,959 --> 00:02:21,760
hunting using miler attack

51
00:02:21,760 --> 00:02:24,879
framework and against carbonic malware

52
00:02:24,879 --> 00:02:27,760
so the rating for this session like how

53
00:02:27,760 --> 00:02:30,879
you have movie ratings pg-13r

54
00:02:30,879 --> 00:02:32,959
is intermediate or actually beginner to

55
00:02:32,959 --> 00:02:36,800
intermediate so do not expect to for for

56
00:02:36,800 --> 00:02:39,599
me to you know open up idea pro

57
00:02:39,599 --> 00:02:42,400
open up a binary and show you

58
00:02:42,400 --> 00:02:44,640
and things things like that so this is

59
00:02:44,640 --> 00:02:46,800
uh this is not not that type of a

60
00:02:46,800 --> 00:02:49,120
session so what we are going to do well

61
00:02:49,120 --> 00:02:51,760
oh actually before that my uh

62
00:02:51,760 --> 00:02:53,599
you already know my name is amol i work

63
00:02:53,599 --> 00:02:55,840
for fidelis and

64
00:02:55,840 --> 00:02:58,560
on a day-to-day basis i work with a

65
00:02:58,560 --> 00:03:01,440
really great team of security engineers

66
00:03:01,440 --> 00:03:04,800
reverse engineering people um

67
00:03:04,800 --> 00:03:06,800
malware researchers and things like that

68
00:03:06,800 --> 00:03:08,560
and get to learn

69
00:03:08,560 --> 00:03:10,400
something new every

70
00:03:10,400 --> 00:03:12,080
almost every day so

71
00:03:12,080 --> 00:03:13,920
this is this has been a great learning

72
00:03:13,920 --> 00:03:15,440
experience

73
00:03:15,440 --> 00:03:17,519
working with these folks so that's

74
00:03:17,519 --> 00:03:19,120
that's about me

75
00:03:19,120 --> 00:03:19,920
so

76
00:03:19,920 --> 00:03:22,400
again coming back to this session

77
00:03:22,400 --> 00:03:24,799
as i mentioned uh what we'll look at is

78
00:03:24,799 --> 00:03:27,599
we'll look at uh threat hunting what is

79
00:03:27,599 --> 00:03:30,879
threat hunting and how

80
00:03:30,879 --> 00:03:32,640
possibly this session can help you a

81
00:03:32,640 --> 00:03:36,080
little bit do more thread hunting it's

82
00:03:36,080 --> 00:03:39,040
about using the miter attack framework

83
00:03:39,040 --> 00:03:41,360
and that's the reason i chose the

84
00:03:41,360 --> 00:03:44,319
carbonac malware because it's so well

85
00:03:44,319 --> 00:03:47,200
known it's so it it has been sort of

86
00:03:47,200 --> 00:03:49,040
researched and studied by a lot of

87
00:03:49,040 --> 00:03:51,599
people so it's a lot lot easier to

88
00:03:51,599 --> 00:03:53,760
understand and go over it by the way how

89
00:03:53,760 --> 00:03:58,080
many of you have heard about carbonac

90
00:03:58,080 --> 00:04:00,480
a lot of you good that's good so i think

91
00:04:00,480 --> 00:04:01,470
that's uh

92
00:04:01,470 --> 00:04:02,720
[Music]

93
00:04:02,720 --> 00:04:04,560
that that will be good for our session

94
00:04:04,560 --> 00:04:06,159
so let's uh

95
00:04:06,159 --> 00:04:09,840
let's get started um threat hunting um i

96
00:04:09,840 --> 00:04:10,640
mean

97
00:04:10,640 --> 00:04:12,560
why do we still do threat hunting there

98
00:04:12,560 --> 00:04:15,760
are so many automated tools so many

99
00:04:15,760 --> 00:04:18,478
mlai based

100
00:04:18,478 --> 00:04:20,399
systems that

101
00:04:20,399 --> 00:04:22,240
i think you you might have deployed in

102
00:04:22,240 --> 00:04:24,320
your organizations to

103
00:04:24,320 --> 00:04:27,040
to catch malicious behavior so why do we

104
00:04:27,040 --> 00:04:30,080
still do threat hunting and the reason

105
00:04:30,080 --> 00:04:31,120
being that

106
00:04:31,120 --> 00:04:34,080
uh in addition to automated

107
00:04:34,080 --> 00:04:36,479
cyber security automated cyber security

108
00:04:36,479 --> 00:04:39,360
is essential but in addition to that

109
00:04:39,360 --> 00:04:41,840
some of the sophisticated threats can

110
00:04:41,840 --> 00:04:45,440
sometimes get past automated detections

111
00:04:45,440 --> 00:04:47,520
so a lot of the automated detections i

112
00:04:47,520 --> 00:04:48,240
mean

113
00:04:48,240 --> 00:04:49,120
you know

114
00:04:49,120 --> 00:04:51,040
a lot of these automated detections they

115
00:04:51,040 --> 00:04:54,400
used to work based on iocs based on like

116
00:04:54,400 --> 00:04:55,440
you must be

117
00:04:55,440 --> 00:04:57,680
hearing this on a daily basis on your

118
00:04:57,680 --> 00:04:58,720
job on

119
00:04:58,720 --> 00:04:59,520
with

120
00:04:59,520 --> 00:05:02,880
file hashes ip addresses url blah blah

121
00:05:02,880 --> 00:05:04,320
blah

122
00:05:04,320 --> 00:05:06,400
which as you know can be tricked very

123
00:05:06,400 --> 00:05:08,960
easily some of the systems are based on

124
00:05:08,960 --> 00:05:11,440
behaviors which is a little bit better

125
00:05:11,440 --> 00:05:14,320
and now we have a lot of systems

126
00:05:14,320 --> 00:05:19,680
based on aiml type of things but still

127
00:05:19,680 --> 00:05:22,840
some of the advanced threats

128
00:05:22,840 --> 00:05:26,160
uh require a threat hunter to go there

129
00:05:26,160 --> 00:05:27,840
and look at

130
00:05:27,840 --> 00:05:29,360
uh look at

131
00:05:29,360 --> 00:05:31,919
the system and detections uh

132
00:05:31,919 --> 00:05:33,840
and sort of try to find out something

133
00:05:33,840 --> 00:05:35,919
which these which the automated systems

134
00:05:35,919 --> 00:05:38,320
cannot now again i'm not no by no means

135
00:05:38,320 --> 00:05:40,000
i'm saying automated systems are bad

136
00:05:40,000 --> 00:05:40,960
these are

137
00:05:40,960 --> 00:05:43,520
very very essentials but

138
00:05:43,520 --> 00:05:44,479
they

139
00:05:44,479 --> 00:05:46,639
they can be a good tool for in

140
00:05:46,639 --> 00:05:49,039
threat hunting

141
00:05:49,039 --> 00:05:51,120
also because a lot of the threat attacks

142
00:05:51,120 --> 00:05:53,280
can be low and slow and we'll see what

143
00:05:53,280 --> 00:05:55,680
that means as we go forward so

144
00:05:55,680 --> 00:05:57,840
uh that's that's that's the reason we

145
00:05:57,840 --> 00:06:00,319
you we do need uh threat hunting

146
00:06:00,319 --> 00:06:02,880
so let's let's give a formal definition

147
00:06:02,880 --> 00:06:04,960
so this is like sort of my

148
00:06:04,960 --> 00:06:07,440
definition so thread hunting is an

149
00:06:07,440 --> 00:06:09,199
iterative search so i think there are

150
00:06:09,199 --> 00:06:11,759
like two really key phrases here so one

151
00:06:11,759 --> 00:06:14,160
is iterative so it never sort of

152
00:06:14,160 --> 00:06:17,120
finishes in one go in half a day in one

153
00:06:17,120 --> 00:06:19,759
day it's it's an iterative search

154
00:06:19,759 --> 00:06:22,160
going through a lots of data your

155
00:06:22,160 --> 00:06:24,560
network data endpoint data cloud data

156
00:06:24,560 --> 00:06:27,360
container data what whatever resources

157
00:06:27,360 --> 00:06:29,360
or whatever data that you have

158
00:06:29,360 --> 00:06:31,759
and trying to detect malicious or

159
00:06:31,759 --> 00:06:34,880
suspicious or risky activities that

160
00:06:34,880 --> 00:06:37,360
evade now this is the second key phrase

161
00:06:37,360 --> 00:06:40,319
is that evade uh detections using

162
00:06:40,319 --> 00:06:41,919
existing tools

163
00:06:41,919 --> 00:06:44,160
so it's iterative and

164
00:06:44,160 --> 00:06:46,400
trying to find out something that evades

165
00:06:46,400 --> 00:06:49,360
uh existing uh tool sets and existing

166
00:06:49,360 --> 00:06:50,880
detections so

167
00:06:50,880 --> 00:06:52,960
that it's something sort of i made up by

168
00:06:52,960 --> 00:06:54,800
combining two or three other different

169
00:06:54,800 --> 00:06:56,319
definitions

170
00:06:56,319 --> 00:06:59,280
so there are uh generally when people

171
00:06:59,280 --> 00:07:02,080
talk about thread hunting there are

172
00:07:02,080 --> 00:07:03,840
three different models that people talk

173
00:07:03,840 --> 00:07:06,720
about so this is the most uh

174
00:07:06,720 --> 00:07:09,440
the model that has been used for a long

175
00:07:09,440 --> 00:07:12,479
time which is intelligence based hunting

176
00:07:12,479 --> 00:07:15,280
and what that pertains is that let's say

177
00:07:15,280 --> 00:07:17,120
you are in a sock you are a threat

178
00:07:17,120 --> 00:07:18,319
hunter

179
00:07:18,319 --> 00:07:21,440
uh generally uh organizations get a lot

180
00:07:21,440 --> 00:07:23,840
of open source or closed source feeds

181
00:07:23,840 --> 00:07:26,560
that they buy on intelligence so what

182
00:07:26,560 --> 00:07:30,400
that is is a feed of a bad file hashes

183
00:07:30,400 --> 00:07:32,479
files that are bad so you can see if

184
00:07:32,479 --> 00:07:34,960
your network your emails your what not

185
00:07:34,960 --> 00:07:36,639
have those files

186
00:07:36,639 --> 00:07:40,240
bad ip addresses for where malware does

187
00:07:40,240 --> 00:07:42,000
the command and control or communicate

188
00:07:42,000 --> 00:07:42,880
with

189
00:07:42,880 --> 00:07:46,240
bad domains urls uh bad http requests

190
00:07:46,240 --> 00:07:47,599
and whatnot

191
00:07:47,599 --> 00:07:49,919
so this has i mean this was like sort of

192
00:07:49,919 --> 00:07:51,680
like the first uh

193
00:07:51,680 --> 00:07:52,800
go-to

194
00:07:52,800 --> 00:07:54,800
uh model for thread hunting where you

195
00:07:54,800 --> 00:07:57,759
get these uh iocs

196
00:07:57,759 --> 00:07:59,680
in your intelligence feeds and then a

197
00:07:59,680 --> 00:08:02,479
thread hunter once alert is triggered

198
00:08:02,479 --> 00:08:05,120
once your system i mean you have to use

199
00:08:05,120 --> 00:08:07,199
some sort of an automated system to

200
00:08:07,199 --> 00:08:08,800
trigger you to let you know that hey i

201
00:08:08,800 --> 00:08:11,919
got an alert based on this file hash or

202
00:08:11,919 --> 00:08:14,479
on this email or whatnot then what the

203
00:08:14,479 --> 00:08:16,720
thread hunter does is uh based on these

204
00:08:16,720 --> 00:08:17,919
iocs

205
00:08:17,919 --> 00:08:19,360
he or she can

206
00:08:19,360 --> 00:08:21,759
investigate what happened before and

207
00:08:21,759 --> 00:08:23,599
what happened after

208
00:08:23,599 --> 00:08:25,680
uh that alert so what happened like

209
00:08:25,680 --> 00:08:27,759
maybe five minutes 10 minutes before

210
00:08:27,759 --> 00:08:29,440
that alert or maybe even more like a

211
00:08:29,440 --> 00:08:32,240
larger time frame on that particular box

212
00:08:32,240 --> 00:08:34,000
and what happened afterwards so that

213
00:08:34,000 --> 00:08:35,679
this is essentially

214
00:08:35,679 --> 00:08:38,719
your uh go-to intelligence based threat

215
00:08:38,719 --> 00:08:41,919
hunting the second model is a

216
00:08:41,919 --> 00:08:44,399
situational model where a lot of people

217
00:08:44,399 --> 00:08:46,240
begin with and

218
00:08:46,240 --> 00:08:48,320
what happens here is in the situational

219
00:08:48,320 --> 00:08:51,040
model there is a hypothesis so

220
00:08:51,040 --> 00:08:54,240
let's say you your organization is a

221
00:08:54,240 --> 00:08:56,720
healthcare organization and

222
00:08:56,720 --> 00:08:57,920
your

223
00:08:57,920 --> 00:09:00,160
security team or people who you

224
00:09:00,160 --> 00:09:02,560
collaborate with or whom you report to

225
00:09:02,560 --> 00:09:04,000
they tell you that hey there is a

226
00:09:04,000 --> 00:09:06,240
malware going on which is targeting

227
00:09:06,240 --> 00:09:08,880
healthcare organizations and

228
00:09:08,880 --> 00:09:10,080
it

229
00:09:10,080 --> 00:09:12,080
can you can you try to hunt for it and

230
00:09:12,080 --> 00:09:15,279
see if it exists in our networks in our

231
00:09:15,279 --> 00:09:16,320
uh

232
00:09:16,320 --> 00:09:18,560
cloud in our containers whatever sort of

233
00:09:18,560 --> 00:09:20,800
infrastructure in our emails whatever

234
00:09:20,800 --> 00:09:23,040
you are trying to threaten with

235
00:09:23,040 --> 00:09:26,080
and so you get a trigger like that and

236
00:09:26,080 --> 00:09:28,399
then you essentially

237
00:09:28,399 --> 00:09:30,800
research that malware look at

238
00:09:30,800 --> 00:09:33,440
possibly the intel iocs for it look at

239
00:09:33,440 --> 00:09:36,240
the behavior for it and try to find that

240
00:09:36,240 --> 00:09:38,560
behavior in your

241
00:09:38,560 --> 00:09:40,320
again in your logs in your networks in

242
00:09:40,320 --> 00:09:42,720
your emails what not what uh whatever

243
00:09:42,720 --> 00:09:44,959
access you have and whatever domain of

244
00:09:44,959 --> 00:09:47,279
thread hunting you are working with

245
00:09:47,279 --> 00:09:49,760
so that's the situational

246
00:09:49,760 --> 00:09:51,920
model and then there is a third one

247
00:09:51,920 --> 00:09:55,440
which is a hypothesis-based model

248
00:09:55,440 --> 00:09:59,120
in this what usually happens is

249
00:09:59,120 --> 00:10:01,279
a thread hunter uses indicator of

250
00:10:01,279 --> 00:10:04,399
attacks or ioas and ttps which are

251
00:10:04,399 --> 00:10:08,399
tactics uh techniques and procedures

252
00:10:08,399 --> 00:10:10,959
and use some sort of a framework like

253
00:10:10,959 --> 00:10:14,079
the miter attack framework uh for

254
00:10:14,079 --> 00:10:16,320
forward thread hunting i think most of

255
00:10:16,320 --> 00:10:18,480
you must have i mean how many of you

256
00:10:18,480 --> 00:10:20,480
have heard of the mitre attack framework

257
00:10:20,480 --> 00:10:22,320
i think all of you yeah great that's

258
00:10:22,320 --> 00:10:23,440
perfect

259
00:10:23,440 --> 00:10:25,040
so uh

260
00:10:25,040 --> 00:10:26,959
so this is like the third model but

261
00:10:26,959 --> 00:10:29,760
again there is no real uh

262
00:10:29,760 --> 00:10:31,839
saying that you use only one of them you

263
00:10:31,839 --> 00:10:33,680
can use all of them you can interchange

264
00:10:33,680 --> 00:10:36,240
them you can do whatever because

265
00:10:36,240 --> 00:10:38,800
the attackers out there they do not

266
00:10:38,800 --> 00:10:41,120
stick to a certain set of rules and

267
00:10:41,120 --> 00:10:42,720
there are no rules for them so i mean

268
00:10:42,720 --> 00:10:43,920
there is no

269
00:10:43,920 --> 00:10:45,200
reason why

270
00:10:45,200 --> 00:10:47,519
you or any thread hunter has to stick to

271
00:10:47,519 --> 00:10:49,200
one or the other you can sort of

272
00:10:49,200 --> 00:10:50,320
interchange

273
00:10:50,320 --> 00:10:52,399
and exchange them

274
00:10:52,399 --> 00:10:55,440
so that's a little bit on on some of the

275
00:10:55,440 --> 00:10:57,680
threat hunting models

276
00:10:57,680 --> 00:11:01,360
let's let's take a quick look at mitre

277
00:11:01,360 --> 00:11:04,160
mitre attacks and their ttp so

278
00:11:04,160 --> 00:11:07,040
i think these a few definitions would be

279
00:11:07,040 --> 00:11:09,519
enough for this presentation

280
00:11:09,519 --> 00:11:12,959
so a tactic that the force t in the ttps

281
00:11:12,959 --> 00:11:16,079
a tactic is represents why like why is

282
00:11:16,079 --> 00:11:18,240
an attacker trying to do that

283
00:11:18,240 --> 00:11:18,959
so

284
00:11:18,959 --> 00:11:21,040
the attacker's

285
00:11:21,040 --> 00:11:24,079
tactical objective could be persistence

286
00:11:24,079 --> 00:11:26,640
they want to remain on that box even if

287
00:11:26,640 --> 00:11:28,480
you know that particular

288
00:11:28,480 --> 00:11:31,200
uh machine is rebooted or whatnot or

289
00:11:31,200 --> 00:11:34,399
they want to move laterally or they want

290
00:11:34,399 --> 00:11:36,320
to execute some files that could be

291
00:11:36,320 --> 00:11:38,800
their tactical objective so a tactic

292
00:11:38,800 --> 00:11:41,600
represents why an attacker is doing that

293
00:11:41,600 --> 00:11:43,600
and a technique represents how the

294
00:11:43,600 --> 00:11:46,079
attacker does that so

295
00:11:46,079 --> 00:11:47,920
a tactical objective could be

296
00:11:47,920 --> 00:11:50,399
persistence to remain on that box of

297
00:11:50,399 --> 00:11:52,800
unnoticed so maybe being unnoticed is

298
00:11:52,800 --> 00:11:56,079
one tactical objective and persistence

299
00:11:56,079 --> 00:11:58,959
is another and how they do that is the

300
00:11:58,959 --> 00:12:00,639
technique which is well if you are using

301
00:12:00,639 --> 00:12:02,639
windows you go to this registry key you

302
00:12:02,639 --> 00:12:04,160
add yourself there

303
00:12:04,160 --> 00:12:06,720
and even if the machine is restarted or

304
00:12:06,720 --> 00:12:08,959
whatnot your malware would start again

305
00:12:08,959 --> 00:12:11,440
so that's sort of like the tactic and

306
00:12:11,440 --> 00:12:12,240
the

307
00:12:12,240 --> 00:12:13,839
technique

308
00:12:13,839 --> 00:12:16,079
and the procedure is essentially there

309
00:12:16,079 --> 00:12:18,800
are a lot a list of procedures that

310
00:12:18,800 --> 00:12:21,680
mitre has documented that

311
00:12:21,680 --> 00:12:23,920
various different thread groups have

312
00:12:23,920 --> 00:12:25,440
used

313
00:12:25,440 --> 00:12:27,519
to combine tactics and techniques and we

314
00:12:27,519 --> 00:12:29,519
will look at some of the procedures as

315
00:12:29,519 --> 00:12:31,680
we go through so these are really the

316
00:12:31,680 --> 00:12:34,399
only three things that that really we

317
00:12:34,399 --> 00:12:36,639
need for this presentation

318
00:12:36,639 --> 00:12:39,360
let's look at uh some of the tactics now

319
00:12:39,360 --> 00:12:41,600
this is a pretty busy slide

320
00:12:41,600 --> 00:12:43,839
uh mitre updates their framework

321
00:12:43,839 --> 00:12:47,079
periodically we are currently on the

322
00:12:47,079 --> 00:12:49,839
11.0 framework the mitre attack

323
00:12:49,839 --> 00:12:52,480
framework and this is how it looks like

324
00:12:52,480 --> 00:12:53,600
oh

325
00:12:53,600 --> 00:12:56,000
good i think it's it's readable

326
00:12:56,000 --> 00:12:56,959
so

327
00:12:56,959 --> 00:12:58,160
i think

328
00:12:58,160 --> 00:13:00,079
the first two things

329
00:13:00,079 --> 00:13:03,040
were added recently they were part of

330
00:13:03,040 --> 00:13:06,320
the mitre pre-attack framework so

331
00:13:06,320 --> 00:13:08,399
pre-attack was essentially

332
00:13:08,399 --> 00:13:12,560
the homework that an attacker

333
00:13:12,560 --> 00:13:14,560
does or you know

334
00:13:14,560 --> 00:13:16,639
before carrying out an attack so that

335
00:13:16,639 --> 00:13:19,440
consists of reconnaissance and resource

336
00:13:19,440 --> 00:13:20,720
development

337
00:13:20,720 --> 00:13:22,880
and now they are from version 11 they

338
00:13:22,880 --> 00:13:24,480
are in the mitre attack framework so

339
00:13:24,480 --> 00:13:26,240
reconnaissance is reconnaissance

340
00:13:26,240 --> 00:13:28,000
essentially if you are targeting let's

341
00:13:28,000 --> 00:13:30,240
say a healthcare organization an

342
00:13:30,240 --> 00:13:33,440
attacker before attacking would try to

343
00:13:33,440 --> 00:13:34,560
find out

344
00:13:34,560 --> 00:13:36,399
what type of healthcare you provide

345
00:13:36,399 --> 00:13:39,920
where are you located what type of

346
00:13:39,920 --> 00:13:42,240
what type of systems do you work with

347
00:13:42,240 --> 00:13:43,760
what types of

348
00:13:43,760 --> 00:13:45,760
patients you have and things like that

349
00:13:45,760 --> 00:13:49,040
so he or she can think of how to

350
00:13:49,040 --> 00:13:51,600
infiltrate it what systems to expect

351
00:13:51,600 --> 00:13:54,959
what social engineering things to do to

352
00:13:54,959 --> 00:13:57,360
get into the organization

353
00:13:57,360 --> 00:13:59,199
resource development is

354
00:13:59,199 --> 00:14:01,519
once once he or she

355
00:14:01,519 --> 00:14:03,120
has that information once the attacker

356
00:14:03,120 --> 00:14:04,800
has that information they would try to

357
00:14:04,800 --> 00:14:06,959
develop a resource uh try to maybe

358
00:14:06,959 --> 00:14:10,320
create a web page an email invoice or

359
00:14:10,320 --> 00:14:12,240
something like that which closely

360
00:14:12,240 --> 00:14:14,720
resembles to what your

361
00:14:14,720 --> 00:14:16,720
organization's employees

362
00:14:16,720 --> 00:14:19,440
are used to seeing so that when they see

363
00:14:19,440 --> 00:14:21,279
that they would think that oh yeah this

364
00:14:21,279 --> 00:14:23,519
is something i it's for me i belong to

365
00:14:23,519 --> 00:14:26,320
so that's reconnaissance and resource

366
00:14:26,320 --> 00:14:29,440
development initial access is initial

367
00:14:29,440 --> 00:14:32,560
access how the attacker gets or

368
00:14:32,560 --> 00:14:35,600
gets foothold into your organization

369
00:14:35,600 --> 00:14:38,639
could be social engineering could be

370
00:14:38,639 --> 00:14:41,440
just leaving usb drives in the parking

371
00:14:41,440 --> 00:14:44,320
lot and mitre has really done a really

372
00:14:44,320 --> 00:14:46,079
great job in

373
00:14:46,079 --> 00:14:50,240
uh in classifying further uh what these

374
00:14:50,240 --> 00:14:53,120
uh tactics and techniques are

375
00:14:53,120 --> 00:14:55,600
the next one is execution that

376
00:14:55,600 --> 00:14:58,480
that details how the malware would

377
00:14:58,480 --> 00:14:59,680
execute

378
00:14:59,680 --> 00:15:00,720
what

379
00:15:00,720 --> 00:15:02,560
would it be like powershell would it be

380
00:15:02,560 --> 00:15:04,800
this that and then we'll look at getting

381
00:15:04,800 --> 00:15:07,600
to the details uh after this

382
00:15:07,600 --> 00:15:09,199
uh persistence we talked about

383
00:15:09,199 --> 00:15:11,279
persistence already how

384
00:15:11,279 --> 00:15:14,560
the malware would persist reboots or

385
00:15:14,560 --> 00:15:15,440
even

386
00:15:15,440 --> 00:15:17,040
sometimes i mean there used to be

387
00:15:17,040 --> 00:15:19,760
malware that could uh even survive a

388
00:15:19,760 --> 00:15:22,399
osre install so firmware based malware

389
00:15:22,399 --> 00:15:24,000
and things like that

390
00:15:24,000 --> 00:15:27,680
and then privilege uh elevation so once

391
00:15:27,680 --> 00:15:28,399
uh

392
00:15:28,399 --> 00:15:30,480
once you have some lower privileges how

393
00:15:30,480 --> 00:15:31,680
do you find

394
00:15:31,680 --> 00:15:34,240
accounts or how do you elevate your own

395
00:15:34,240 --> 00:15:37,120
privileges on that box

396
00:15:37,120 --> 00:15:39,519
defense evasion so that means if there

397
00:15:39,519 --> 00:15:42,480
is an antivirus present on the system

398
00:15:42,480 --> 00:15:45,120
how do you evade that if there is some

399
00:15:45,120 --> 00:15:46,560
sort of a network

400
00:15:46,560 --> 00:15:47,920
or endpoint

401
00:15:47,920 --> 00:15:50,079
detection and response system how do you

402
00:15:50,079 --> 00:15:51,920
evade that system

403
00:15:51,920 --> 00:15:53,360
um

404
00:15:53,360 --> 00:15:56,800
and and the the list is uh well i think

405
00:15:56,800 --> 00:15:58,639
but it's it's good to go quickly through

406
00:15:58,639 --> 00:16:00,480
the list credentials access how to

407
00:16:00,480 --> 00:16:02,160
access credentials

408
00:16:02,160 --> 00:16:05,279
discovery is how to find uh

409
00:16:05,279 --> 00:16:07,519
other targets that are of importance

410
00:16:07,519 --> 00:16:10,480
let's say you as an attacker or on one

411
00:16:10,480 --> 00:16:12,639
machine but that's machine is not of

412
00:16:12,639 --> 00:16:14,320
much importance to you so how do you

413
00:16:14,320 --> 00:16:16,639
find other machines and then how do you

414
00:16:16,639 --> 00:16:20,480
laterally move to those machines

415
00:16:20,480 --> 00:16:22,480
collect data that you want to collect

416
00:16:22,480 --> 00:16:23,680
and then

417
00:16:23,680 --> 00:16:24,800
essentially

418
00:16:24,800 --> 00:16:26,270
create a command and control

419
00:16:26,270 --> 00:16:28,800
[Music]

420
00:16:28,800 --> 00:16:31,120
channel to your mothership to where you

421
00:16:31,120 --> 00:16:34,720
are to infiltrate or exfiltrate

422
00:16:34,720 --> 00:16:37,040
data that you want to exfiltrate

423
00:16:37,040 --> 00:16:40,000
so these are the main tactics in the

424
00:16:40,000 --> 00:16:43,279
mitre 11.0 framework

425
00:16:43,279 --> 00:16:44,320
go

426
00:16:44,320 --> 00:16:46,720
please go to the open source framework

427
00:16:46,720 --> 00:16:48,639
and there is excellent documentation and

428
00:16:48,639 --> 00:16:50,399
sub categorization

429
00:16:50,399 --> 00:16:52,160
of of these

430
00:16:52,160 --> 00:16:54,560
so this is one of the examples the

431
00:16:54,560 --> 00:16:58,480
tactic here is persistence and this is

432
00:16:58,480 --> 00:17:00,720
persistence had some categories some

433
00:17:00,720 --> 00:17:02,880
subcategories and the techniques are

434
00:17:02,880 --> 00:17:05,199
listed like how would you do persistence

435
00:17:05,199 --> 00:17:08,240
if it is a windows box why this why that

436
00:17:08,240 --> 00:17:10,400
and then the procedures are how some of

437
00:17:10,400 --> 00:17:13,039
the malware like i think here you see

438
00:17:13,039 --> 00:17:14,000
abd

439
00:17:14,000 --> 00:17:17,839
oh this is better to read abd28 or other

440
00:17:17,839 --> 00:17:19,119
malware

441
00:17:19,119 --> 00:17:21,359
other malware families or threat actors

442
00:17:21,359 --> 00:17:24,160
have used this

443
00:17:24,160 --> 00:17:26,079
this particular tactic and this

444
00:17:26,079 --> 00:17:28,240
particular technique

445
00:17:28,240 --> 00:17:31,600
so that's a little bit on

446
00:17:31,600 --> 00:17:33,360
on

447
00:17:33,360 --> 00:17:35,840
mitre attack framework and on threat

448
00:17:35,840 --> 00:17:39,520
hunting so let's take an example to sort

449
00:17:39,520 --> 00:17:42,240
of really tie uh this together

450
00:17:42,240 --> 00:17:45,039
and as i mentioned i took example of the

451
00:17:45,039 --> 00:17:48,160
carbonac malware now carbonac

452
00:17:48,160 --> 00:17:50,480
is a pretty well understood thread group

453
00:17:50,480 --> 00:17:53,679
it's both it's a thread group as well as

454
00:17:53,679 --> 00:17:55,760
it is uh

455
00:17:55,760 --> 00:17:57,200
it is

456
00:17:57,200 --> 00:17:59,039
it is the actual name of the malware

457
00:17:59,039 --> 00:18:00,960
that people refer to

458
00:18:00,960 --> 00:18:03,440
and it it was active

459
00:18:03,440 --> 00:18:05,679
a few years ago

460
00:18:05,679 --> 00:18:07,200
it targeted

461
00:18:07,200 --> 00:18:09,200
financial institutions

462
00:18:09,200 --> 00:18:10,080
so

463
00:18:10,080 --> 00:18:12,880
carbonac essentially stole a billion

464
00:18:12,880 --> 00:18:14,880
dollars and this is

465
00:18:14,880 --> 00:18:15,760
i mean

466
00:18:15,760 --> 00:18:17,440
pretty

467
00:18:17,440 --> 00:18:20,480
large sum of money from more than 100

468
00:18:20,480 --> 00:18:23,120
financial institutions in 30 countries

469
00:18:23,120 --> 00:18:25,039
so you can see how

470
00:18:25,039 --> 00:18:29,280
how devastating this was from what i

471
00:18:29,280 --> 00:18:32,960
know a lot of a lot of people behind the

472
00:18:32,960 --> 00:18:37,760
carbonac malware have been apprehended

473
00:18:37,840 --> 00:18:39,600
and i think that's that's a good news

474
00:18:39,600 --> 00:18:41,520
but when i look at these numbers it's

475
00:18:41,520 --> 00:18:43,600
mind-boggling i mean

476
00:18:43,600 --> 00:18:45,120
i mean

477
00:18:45,120 --> 00:18:47,360
a lot of you may have worked at startups

478
00:18:47,360 --> 00:18:49,760
or are you working in larger companies

479
00:18:49,760 --> 00:18:52,160
like if your revenue is a billion

480
00:18:52,160 --> 00:18:54,960
dollars imagine what is your valuation i

481
00:18:54,960 --> 00:18:57,600
mean you generally get like

482
00:18:57,600 --> 00:19:00,480
some x valuation and

483
00:19:00,480 --> 00:19:03,600
if this was a company just just it's

484
00:19:03,600 --> 00:19:04,960
just these numbers are just

485
00:19:04,960 --> 00:19:06,559
mind-boggling

486
00:19:06,559 --> 00:19:08,799
so anyway we are here to talk about

487
00:19:08,799 --> 00:19:10,880
threat hunting and the technicalities of

488
00:19:10,880 --> 00:19:14,240
it so let's go and let's see how the

489
00:19:14,240 --> 00:19:16,559
malware infiltrates a typical

490
00:19:16,559 --> 00:19:18,080
organization

491
00:19:18,080 --> 00:19:21,919
how you can use a miter attack framework

492
00:19:21,919 --> 00:19:25,760
and how as a threat hunter you can use

493
00:19:25,760 --> 00:19:28,799
mitre attack and some of these tactics

494
00:19:28,799 --> 00:19:31,520
and techniques to your advantage

495
00:19:31,520 --> 00:19:33,200
against

496
00:19:33,200 --> 00:19:35,120
some of this malware

497
00:19:35,120 --> 00:19:38,880
so this is uh the brief attack working

498
00:19:38,880 --> 00:19:41,600
um i think let's let's start uh with an

499
00:19:41,600 --> 00:19:42,799
overview

500
00:19:42,799 --> 00:19:46,000
so from the top left what you have is

501
00:19:46,000 --> 00:19:48,799
this attack was carried out by fishing

502
00:19:48,799 --> 00:19:50,840
i mean i know we are in

503
00:19:50,840 --> 00:19:55,919
2022 but still fishing remains uh

504
00:19:55,919 --> 00:19:57,120
the number

505
00:19:57,120 --> 00:20:00,000
one cause of initial access or initial

506
00:20:00,000 --> 00:20:02,320
breach so

507
00:20:02,320 --> 00:20:04,320
in i mean fishing involves a lot of

508
00:20:04,320 --> 00:20:07,760
things it also could involve

509
00:20:07,760 --> 00:20:10,000
other social engineering aspects like

510
00:20:10,000 --> 00:20:11,760
clicking on links social media blah blah

511
00:20:11,760 --> 00:20:13,440
blah but again we are we are talking

512
00:20:13,440 --> 00:20:15,360
about carbon neck so carbonac used

513
00:20:15,360 --> 00:20:16,320
phishing

514
00:20:16,320 --> 00:20:18,080
sent a phishing email to an bank

515
00:20:18,080 --> 00:20:19,280
employee

516
00:20:19,280 --> 00:20:20,799
and we'll see all of this a little bit

517
00:20:20,799 --> 00:20:23,919
more into detail in subsequent slides

518
00:20:23,919 --> 00:20:28,320
send an email to a blank bank employee

519
00:20:28,320 --> 00:20:30,960
compromised that system

520
00:20:30,960 --> 00:20:33,120
laterally moved to a lot of other

521
00:20:33,120 --> 00:20:35,919
systems trying to find the privileged

522
00:20:35,919 --> 00:20:38,320
account so i think that is what

523
00:20:38,320 --> 00:20:41,039
most of these threat actors do is try to

524
00:20:41,039 --> 00:20:42,720
find the privileged account because they

525
00:20:42,720 --> 00:20:45,600
are not interested in an account if or a

526
00:20:45,600 --> 00:20:48,720
machine if you don't have any access

527
00:20:48,720 --> 00:20:52,240
from there what they did was they really

528
00:20:52,240 --> 00:20:54,080
studied how

529
00:20:54,080 --> 00:20:56,559
by the means of screen recording and key

530
00:20:56,559 --> 00:20:58,159
loggers and whatnot

531
00:20:58,159 --> 00:21:01,200
how many transfers are being done

532
00:21:01,200 --> 00:21:04,320
and in in that particular organization

533
00:21:04,320 --> 00:21:06,480
and then carried out fraudulent

534
00:21:06,480 --> 00:21:08,000
transfers

535
00:21:08,000 --> 00:21:10,880
carried out things like controlling adms

536
00:21:10,880 --> 00:21:13,840
where they had some mules some people

537
00:21:13,840 --> 00:21:17,039
go to certain adms at a certain uh

538
00:21:17,039 --> 00:21:19,200
time and they would dispense cash in

539
00:21:19,200 --> 00:21:21,200
that atm and these guys would just grab

540
00:21:21,200 --> 00:21:22,400
the cash and

541
00:21:22,400 --> 00:21:25,120
take their cut and whatnot

542
00:21:25,120 --> 00:21:27,679
so this is sort of like an overview of

543
00:21:27,679 --> 00:21:30,640
how things work let's uh go into the

544
00:21:30,640 --> 00:21:31,679
details

545
00:21:31,679 --> 00:21:34,159
one important thing to sort of keep on

546
00:21:34,159 --> 00:21:36,000
the back of our mind is that this did

547
00:21:36,000 --> 00:21:38,000
not happen overnight

548
00:21:38,000 --> 00:21:40,559
even in the single organization so i i

549
00:21:40,559 --> 00:21:42,080
mentioned there were like hundreds of

550
00:21:42,080 --> 00:21:43,919
organizations that were targeted but

551
00:21:43,919 --> 00:21:46,720
even in a single organization this did

552
00:21:46,720 --> 00:21:49,760
not happen with a single click

553
00:21:49,760 --> 00:21:52,159
this was like a low and slow attack so

554
00:21:52,159 --> 00:21:54,159
basically the attacker

555
00:21:54,159 --> 00:21:57,280
was in the organization's

556
00:21:57,280 --> 00:22:01,200
network for days weeks and months

557
00:22:01,200 --> 00:22:03,039
so it's not like you download something

558
00:22:03,039 --> 00:22:05,280
you click something boom uh something

559
00:22:05,280 --> 00:22:07,520
happened this is where the attacker was

560
00:22:07,520 --> 00:22:10,320
inside that organization for weeks at

561
00:22:10,320 --> 00:22:11,360
least so

562
00:22:11,360 --> 00:22:13,919
uh i think that sort of gives us a

563
00:22:13,919 --> 00:22:16,400
context of um

564
00:22:16,400 --> 00:22:19,520
how how the attack uh works and

565
00:22:19,520 --> 00:22:21,360
what what really happened

566
00:22:21,360 --> 00:22:25,120
so initial access this is uh this is one

567
00:22:25,120 --> 00:22:28,000
of the first thing that

568
00:22:28,000 --> 00:22:30,000
comes to mind and again i'm not going to

569
00:22:30,000 --> 00:22:32,159
read the things on the slide but this

570
00:22:32,159 --> 00:22:35,200
sort of details uh various tactics and

571
00:22:35,200 --> 00:22:36,880
techniques uh

572
00:22:36,880 --> 00:22:39,039
and some techniques of how an initial

573
00:22:39,039 --> 00:22:40,480
access can happen

574
00:22:40,480 --> 00:22:42,799
so in case of carbonac

575
00:22:42,799 --> 00:22:45,440
oh i don't have my pointer thing but it

576
00:22:45,440 --> 00:22:47,840
was essentially fishing

577
00:22:47,840 --> 00:22:50,080
which is sort of somewhere in the middle

578
00:22:50,080 --> 00:22:51,280
there

579
00:22:51,280 --> 00:22:52,240
and

580
00:22:52,240 --> 00:22:54,559
this is an example

581
00:22:54,559 --> 00:22:57,120
of phishing email that was sent so this

582
00:22:57,120 --> 00:22:59,520
is from the link below from our justice

583
00:22:59,520 --> 00:23:00,799
department

584
00:23:00,799 --> 00:23:04,159
which did a good file on carbonac it's

585
00:23:04,159 --> 00:23:07,120
based on the carbonac files and this

586
00:23:07,120 --> 00:23:09,919
an email something similar to this was

587
00:23:09,919 --> 00:23:12,880
uh sent to bank to

588
00:23:12,880 --> 00:23:15,280
one or many of the bank employees with

589
00:23:15,280 --> 00:23:17,039
the word attachment

590
00:23:17,039 --> 00:23:17,760
so

591
00:23:17,760 --> 00:23:18,960
um

592
00:23:18,960 --> 00:23:21,520
that's pretty clear here

593
00:23:21,520 --> 00:23:24,159
so as you know i mean in these type of

594
00:23:24,159 --> 00:23:26,240
attacks the employee opens the word

595
00:23:26,240 --> 00:23:29,360
document and uh

596
00:23:29,360 --> 00:23:31,440
uh oh here i talk a little bit about

597
00:23:31,440 --> 00:23:34,159
mitigation so okay let's talk about

598
00:23:34,159 --> 00:23:37,360
phishing mitigation i mean it is one of

599
00:23:37,360 --> 00:23:39,360
the social engineering types of attacks

600
00:23:39,360 --> 00:23:41,840
so uh the mitigation for this type of

601
00:23:41,840 --> 00:23:44,400
attack or initial access we are only

602
00:23:44,400 --> 00:23:46,159
talking about initial access not about

603
00:23:46,159 --> 00:23:50,559
the entire attack would be user training

604
00:23:50,559 --> 00:23:54,240
anti-malware ids ips type of scans or

605
00:23:54,240 --> 00:23:57,919
email security like dmarc and spf so you

606
00:23:57,919 --> 00:23:59,919
can read up on you may already know

607
00:23:59,919 --> 00:24:02,159
about all these techniques and they may

608
00:24:02,159 --> 00:24:03,600
have been already there in your

609
00:24:03,600 --> 00:24:05,440
organization

610
00:24:05,440 --> 00:24:07,200
but

611
00:24:07,200 --> 00:24:08,720
looks like do i have the right

612
00:24:08,720 --> 00:24:11,440
presentation okay

613
00:24:11,440 --> 00:24:14,400
uh but from a

614
00:24:14,400 --> 00:24:16,000
attacker's

615
00:24:16,000 --> 00:24:19,039
perspective or from a threat

616
00:24:19,039 --> 00:24:22,240
intel person's perspective or from a

617
00:24:22,240 --> 00:24:24,320
threat hunter's perspective

618
00:24:24,320 --> 00:24:25,360
what

619
00:24:25,360 --> 00:24:26,480
you can

620
00:24:26,480 --> 00:24:27,840
uh

621
00:24:27,840 --> 00:24:29,120
what you can

622
00:24:29,120 --> 00:24:31,600
what what you can look at is how do i

623
00:24:31,600 --> 00:24:32,960
catch all these

624
00:24:32,960 --> 00:24:34,720
different emails

625
00:24:34,720 --> 00:24:38,480
so this is uh

626
00:24:38,480 --> 00:24:42,480
this is a graph created by

627
00:24:42,480 --> 00:24:44,880
it's on github it's created by center

628
00:24:44,880 --> 00:24:46,640
for threat i mean the link is right

629
00:24:46,640 --> 00:24:49,440
there on github and it shows

630
00:24:49,440 --> 00:24:51,600
what are the different

631
00:24:51,600 --> 00:24:53,919
on the columns what you have is are all

632
00:24:53,919 --> 00:24:54,880
the

633
00:24:54,880 --> 00:24:57,039
tactics all the mitre tactics and it has

634
00:24:57,039 --> 00:24:59,039
highlighted what are all the

635
00:24:59,039 --> 00:25:01,679
tactics that carbonac used so this is

636
00:25:01,679 --> 00:25:03,919
again this is not created by me the link

637
00:25:03,919 --> 00:25:05,039
is here

638
00:25:05,039 --> 00:25:07,440
and what we are discussing right now is

639
00:25:07,440 --> 00:25:10,400
the first one which is the initial

640
00:25:10,400 --> 00:25:12,840
access part of it

641
00:25:12,840 --> 00:25:16,399
so um

642
00:25:17,039 --> 00:25:19,360
this is a mitre execution so what

643
00:25:19,360 --> 00:25:22,960
happens when you get an email you get an

644
00:25:22,960 --> 00:25:24,080
email

645
00:25:24,080 --> 00:25:26,159
these are the various uh

646
00:25:26,159 --> 00:25:28,559
techniques and sub techniques that mitre

647
00:25:28,559 --> 00:25:31,279
has for execution for various different

648
00:25:31,279 --> 00:25:34,000
uh operating systems

649
00:25:34,000 --> 00:25:36,640
and in execution what happens was a bank

650
00:25:36,640 --> 00:25:38,880
employee he then opens a word document

651
00:25:38,880 --> 00:25:40,720
you got a word document you open it it

652
00:25:40,720 --> 00:25:42,640
looks familiar

653
00:25:42,640 --> 00:25:46,159
the word document had an embedded oel

654
00:25:46,159 --> 00:25:49,760
object object clinking and embedding

655
00:25:49,760 --> 00:25:52,640
this is a very old technology

656
00:25:52,640 --> 00:25:56,240
back in the 90s when windows was you

657
00:25:56,240 --> 00:25:58,720
know when you had the dos disk operating

658
00:25:58,720 --> 00:26:00,000
system i don't know how many of you

659
00:26:00,000 --> 00:26:01,919
remember that and you go to the command

660
00:26:01,919 --> 00:26:03,360
prompt you type

661
00:26:03,360 --> 00:26:05,440
win and then windows start windows was

662
00:26:05,440 --> 00:26:06,880
not like a

663
00:26:06,880 --> 00:26:09,360
operating system yet

664
00:26:09,360 --> 00:26:10,720
this has exist

665
00:26:10,720 --> 00:26:13,039
this oel has been there right from the

666
00:26:13,039 --> 00:26:16,080
birth of windows even before it was a

667
00:26:16,080 --> 00:26:18,159
operating system but

668
00:26:18,159 --> 00:26:20,720
anyway so a bank employee opens the word

669
00:26:20,720 --> 00:26:23,279
document there is an embedded oel object

670
00:26:23,279 --> 00:26:26,960
which has an encoded visual basic script

671
00:26:26,960 --> 00:26:29,760
now this visual basic script executes it

672
00:26:29,760 --> 00:26:30,640
runs

673
00:26:30,640 --> 00:26:33,440
and it establishes a rat a remote access

674
00:26:33,440 --> 00:26:34,880
trojan

675
00:26:34,880 --> 00:26:37,360
it establishes a connection from that

676
00:26:37,360 --> 00:26:39,919
particular machine of the victim which

677
00:26:39,919 --> 00:26:42,640
opened the email to the attacker's

678
00:26:42,640 --> 00:26:44,000
server

679
00:26:44,000 --> 00:26:47,200
so what what can we do as threat hunters

680
00:26:47,200 --> 00:26:49,200
here so one of the things that we can do

681
00:26:49,200 --> 00:26:51,440
is well we have a lot of tools at our

682
00:26:51,440 --> 00:26:52,880
disposal so

683
00:26:52,880 --> 00:26:54,559
the example of the tool here that i've

684
00:26:54,559 --> 00:26:58,159
given is oledump dot py dash py

685
00:26:58,159 --> 00:26:59,919
what it does it it

686
00:26:59,919 --> 00:27:02,960
identifies uh if you give it a word or

687
00:27:02,960 --> 00:27:06,640
excel or office find file it identifies

688
00:27:06,640 --> 00:27:08,080
macros in it

689
00:27:08,080 --> 00:27:10,400
and that's an example there

690
00:27:10,400 --> 00:27:12,559
at some places you would see there is a

691
00:27:12,559 --> 00:27:14,559
m written there that means it has

692
00:27:14,559 --> 00:27:17,520
identified a macro inside there

693
00:27:17,520 --> 00:27:18,480
now

694
00:27:18,480 --> 00:27:20,080
this could be one of the things where

695
00:27:20,080 --> 00:27:22,399
you are browsing through or where you

696
00:27:22,399 --> 00:27:24,000
are threat hunting you are you have a

697
00:27:24,000 --> 00:27:26,640
lot of files you are looking at a lot of

698
00:27:26,640 --> 00:27:28,640
email attachments that your organization

699
00:27:28,640 --> 00:27:29,520
gets

700
00:27:29,520 --> 00:27:31,360
what you could do is you can sort of

701
00:27:31,360 --> 00:27:33,679
deploy some sort of an automation that

702
00:27:33,679 --> 00:27:35,600
extracts

703
00:27:35,600 --> 00:27:38,799
the attachments and run this tool to

704
00:27:38,799 --> 00:27:41,760
find which which

705
00:27:41,760 --> 00:27:43,120
which

706
00:27:43,120 --> 00:27:45,679
which attachments or files have macros

707
00:27:45,679 --> 00:27:47,679
now just because a file has a macro

708
00:27:47,679 --> 00:27:49,679
doesn't mean it's malicious but it at

709
00:27:49,679 --> 00:27:52,320
least gives you a good point to start

710
00:27:52,320 --> 00:27:53,279
with

711
00:27:53,279 --> 00:27:56,159
what you can do after that is

712
00:27:56,159 --> 00:27:59,760
deoxicate the powershell or other code

713
00:27:59,760 --> 00:28:01,200
in that macro

714
00:28:01,200 --> 00:28:04,159
and if there are some ttps there some

715
00:28:04,159 --> 00:28:06,880
domains some urls and try to identify

716
00:28:06,880 --> 00:28:08,320
them and

717
00:28:08,320 --> 00:28:11,520
start your thread hunting that way

718
00:28:11,520 --> 00:28:12,320
so

719
00:28:12,320 --> 00:28:13,600
those are some of the things that a

720
00:28:13,600 --> 00:28:16,000
threat hunter could automate could could

721
00:28:16,000 --> 00:28:18,399
could do on this

722
00:28:18,399 --> 00:28:20,080
so the

723
00:28:20,080 --> 00:28:22,559
next so what we saw was execution

724
00:28:22,559 --> 00:28:25,360
initial access the first arrow was

725
00:28:25,360 --> 00:28:27,360
getting a email

726
00:28:27,360 --> 00:28:29,440
phishing email the second one was

727
00:28:29,440 --> 00:28:33,200
execution execute the

728
00:28:33,440 --> 00:28:37,039
macros in the word document

729
00:28:37,039 --> 00:28:40,000
and execute the shell script from that

730
00:28:40,000 --> 00:28:42,559
the third one what the malware did was

731
00:28:42,559 --> 00:28:45,600
it did some discovery and this these are

732
00:28:45,600 --> 00:28:48,000
the techniques that mitre has for

733
00:28:48,000 --> 00:28:49,200
discovery

734
00:28:49,200 --> 00:28:50,559
and the one

735
00:28:50,559 --> 00:28:52,159
that uh

736
00:28:52,159 --> 00:28:54,399
carbonac used was

737
00:28:54,399 --> 00:28:56,559
trying to find the host name trying to

738
00:28:56,559 --> 00:28:58,720
find the domain trying to find as much

739
00:28:58,720 --> 00:29:01,120
information about the machine that they

740
00:29:01,120 --> 00:29:02,159
are on

741
00:29:02,159 --> 00:29:04,159
now from an attacker's point of view

742
00:29:04,159 --> 00:29:06,640
they are sort of blind they know their

743
00:29:06,640 --> 00:29:08,720
code has executed on some machine they

744
00:29:08,720 --> 00:29:10,399
don't know whose machine is it what

745
00:29:10,399 --> 00:29:12,720
credentials do they have where are they

746
00:29:12,720 --> 00:29:15,679
so they are in this uh discovery phase

747
00:29:15,679 --> 00:29:18,399
and that's what mitre uh categorizes as

748
00:29:18,399 --> 00:29:20,880
discovery where they try to discovery

749
00:29:20,880 --> 00:29:23,440
who they are or where they are

750
00:29:23,440 --> 00:29:26,559
and uh things like that so in case of

751
00:29:26,559 --> 00:29:29,120
carbonac and the t letters in the

752
00:29:29,120 --> 00:29:32,480
parentheses are the miter uh

753
00:29:32,480 --> 00:29:34,880
techniques and sub techniques so every

754
00:29:34,880 --> 00:29:37,120
techniques

755
00:29:37,120 --> 00:29:39,440
technique and sub technique has a unique

756
00:29:39,440 --> 00:29:43,200
id so those are the unique ids for

757
00:29:43,200 --> 00:29:45,600
the mitre unique ids so i think once you

758
00:29:45,600 --> 00:29:47,760
have the presentation you can possibly

759
00:29:47,760 --> 00:29:49,600
click on it or just google on it and get

760
00:29:49,600 --> 00:29:51,039
more information

761
00:29:51,039 --> 00:29:53,360
so what the attacker does is okay there

762
00:29:53,360 --> 00:29:54,559
is an email

763
00:29:54,559 --> 00:29:56,320
it executed

764
00:29:56,320 --> 00:29:59,200
they are on some machine they have a cnc

765
00:29:59,200 --> 00:30:00,640
but they don't really know what that

766
00:30:00,640 --> 00:30:03,440
machine does where they are in the

767
00:30:03,440 --> 00:30:05,200
network hierarchy they just know that

768
00:30:05,200 --> 00:30:07,039
they are somewhere and again keep in

769
00:30:07,039 --> 00:30:09,440
mind this is a slow and low attack that

770
00:30:09,440 --> 00:30:11,760
means it's not it happened over the

771
00:30:11,760 --> 00:30:14,640
course of weeks with a lot of times real

772
00:30:14,640 --> 00:30:16,799
attackers real people not like

773
00:30:16,799 --> 00:30:18,399
completely automated sitting on the

774
00:30:18,399 --> 00:30:20,080
other side

775
00:30:20,080 --> 00:30:23,840
so and and what the uh first rat does is

776
00:30:23,840 --> 00:30:26,880
it executes a wmi script to get all this

777
00:30:26,880 --> 00:30:28,240
information

778
00:30:28,240 --> 00:30:29,919
so wmi

779
00:30:29,919 --> 00:30:31,440
everyone knows the wmi right that's the

780
00:30:31,440 --> 00:30:33,760
windows management interface

781
00:30:33,760 --> 00:30:36,159
another thing that you can look as a

782
00:30:36,159 --> 00:30:38,080
threat hunter is try to find which

783
00:30:38,080 --> 00:30:39,440
machines are

784
00:30:39,440 --> 00:30:42,000
doing wmi queries i mean again just

785
00:30:42,000 --> 00:30:44,000
because the machine is doing wma queries

786
00:30:44,000 --> 00:30:46,320
doesn't mean that it is compromised but

787
00:30:46,320 --> 00:30:48,480
most probably in a financial institution

788
00:30:48,480 --> 00:30:50,559
your normal

789
00:30:50,559 --> 00:30:52,960
banker or a clerk or

790
00:30:52,960 --> 00:30:54,000
hr

791
00:30:54,000 --> 00:30:56,480
would not really do wmi queries so that

792
00:30:56,480 --> 00:30:58,720
is something if you have endpoint system

793
00:30:58,720 --> 00:31:00,559
is as a threat hunter you can

794
00:31:00,559 --> 00:31:02,720
immediately look at is okay this sounds

795
00:31:02,720 --> 00:31:04,880
suspicious why would anyone do wmi

796
00:31:04,880 --> 00:31:07,519
queries in my organization

797
00:31:07,519 --> 00:31:10,480
uh but this is what carbon act did using

798
00:31:10,480 --> 00:31:13,360
wmi queries tried to find all this

799
00:31:13,360 --> 00:31:16,399
information in the discovery part

800
00:31:16,399 --> 00:31:19,519
then came uh command and control

801
00:31:19,519 --> 00:31:22,159
execution and exfiltration

802
00:31:22,159 --> 00:31:25,200
so in command and control the attacker

803
00:31:25,200 --> 00:31:27,919
uploads some power

804
00:31:27,919 --> 00:31:30,240
shell scripts and starts taking

805
00:31:30,240 --> 00:31:32,480
screenshots of the user's desktop and

806
00:31:32,480 --> 00:31:34,320
it's all an attempt to find out where

807
00:31:34,320 --> 00:31:36,640
they are who whose machines they are on

808
00:31:36,640 --> 00:31:39,279
and what they are doing and uh uploads

809
00:31:39,279 --> 00:31:42,080
all these screenshots to the attackers

810
00:31:42,080 --> 00:31:43,279
cnc

811
00:31:43,279 --> 00:31:45,519
uh server now this

812
00:31:45,519 --> 00:31:47,120
most probably would be automated there

813
00:31:47,120 --> 00:31:48,640
will be no one sitting on the other end

814
00:31:48,640 --> 00:31:50,880
but the malware essentially just takes

815
00:31:50,880 --> 00:31:53,039
screenshots and uploads them uploads it

816
00:31:53,039 --> 00:31:55,360
i mean someone there in the attackers

817
00:31:55,360 --> 00:31:58,159
i would like to call data center

818
00:31:58,159 --> 00:31:59,440
later

819
00:31:59,440 --> 00:32:01,200
looks at these screenshots and see if

820
00:32:01,200 --> 00:32:02,880
there is something of

821
00:32:02,880 --> 00:32:04,799
interest

822
00:32:04,799 --> 00:32:06,159
so

823
00:32:06,159 --> 00:32:09,200
those are the techniques that are

824
00:32:09,200 --> 00:32:11,519
that are pointed by the arrows

825
00:32:11,519 --> 00:32:13,679
so one another interesting thing in this

826
00:32:13,679 --> 00:32:15,919
chart is although

827
00:32:15,919 --> 00:32:18,640
um i mean instinctively we go from left

828
00:32:18,640 --> 00:32:20,480
to right we like to say that okay there

829
00:32:20,480 --> 00:32:22,559
was initial access then execution and

830
00:32:22,559 --> 00:32:24,240
this and that that

831
00:32:24,240 --> 00:32:26,080
i mean it's not necessary and most of

832
00:32:26,080 --> 00:32:28,080
the time it's not like attackers are

833
00:32:28,080 --> 00:32:30,480
there to follow mitre's guidance they

834
00:32:30,480 --> 00:32:32,080
don't i mean you know they don't have to

835
00:32:32,080 --> 00:32:33,360
and they don't do

836
00:32:33,360 --> 00:32:35,840
in uh in in sequence a lot of times you

837
00:32:35,840 --> 00:32:37,679
would see that they would go from one

838
00:32:37,679 --> 00:32:39,200
place to another

839
00:32:39,200 --> 00:32:40,559
come back again

840
00:32:40,559 --> 00:32:42,559
and and these uh things would really

841
00:32:42,559 --> 00:32:44,480
jump in these charts from here to there

842
00:32:44,480 --> 00:32:46,960
so although we like to i mean

843
00:32:46,960 --> 00:32:48,960
instinctively we would like to think

844
00:32:48,960 --> 00:32:50,880
that an attack always happens from left

845
00:32:50,880 --> 00:32:51,840
to right

846
00:32:51,840 --> 00:32:54,080
uh i mean uh as you can see the attacker

847
00:32:54,080 --> 00:32:57,760
would jump back and forth between these

848
00:32:57,760 --> 00:33:00,320
techniques and tactics

849
00:33:00,320 --> 00:33:02,559
so okay what happens after that attacker

850
00:33:02,559 --> 00:33:04,240
so there was an email

851
00:33:04,240 --> 00:33:05,840
execution email

852
00:33:05,840 --> 00:33:08,399
screenshots trying to find out who they

853
00:33:08,399 --> 00:33:11,120
are then they deploy a second stage rat

854
00:33:11,120 --> 00:33:13,200
uh remote access trojan

855
00:33:13,200 --> 00:33:17,039
what it does is it writes some code into

856
00:33:17,039 --> 00:33:20,080
the windows registry offset that so that

857
00:33:20,080 --> 00:33:22,960
most scanners or avs won't

858
00:33:22,960 --> 00:33:24,399
sort of try to

859
00:33:24,399 --> 00:33:28,159
would not find it as uh suspicious

860
00:33:28,159 --> 00:33:29,919
and

861
00:33:29,919 --> 00:33:31,440
then run that

862
00:33:31,440 --> 00:33:34,880
run that shell code and after execution

863
00:33:34,880 --> 00:33:36,880
they essentially receive a call back and

864
00:33:36,880 --> 00:33:39,679
this is where uh

865
00:33:39,679 --> 00:33:42,000
they receive a call back as in

866
00:33:42,000 --> 00:33:44,080
this is where an attacker like a real

867
00:33:44,080 --> 00:33:46,559
attacker or a physical person if he is

868
00:33:46,559 --> 00:33:48,960
interested in that machine would do more

869
00:33:48,960 --> 00:33:50,799
things on that machine so they do this

870
00:33:50,799 --> 00:33:53,200
call callback on a certain tcp port

871
00:33:53,200 --> 00:33:56,240
and this falls again into execution and

872
00:33:56,240 --> 00:33:58,320
command and control so now the attacker

873
00:33:58,320 --> 00:34:00,880
has complete command and control

874
00:34:00,880 --> 00:34:02,320
access

875
00:34:02,320 --> 00:34:04,080
to that particular box and again it

876
00:34:04,080 --> 00:34:06,880
falls in these categories the reason i

877
00:34:06,880 --> 00:34:08,639
always go to this chart and these

878
00:34:08,639 --> 00:34:10,480
categories is because these are the

879
00:34:10,480 --> 00:34:12,879
miter categories they are highlighted

880
00:34:12,879 --> 00:34:15,839
with the carbonac and

881
00:34:15,839 --> 00:34:18,399
i think as a threat hunter you can

882
00:34:18,399 --> 00:34:21,040
really look at them into detail and

883
00:34:21,040 --> 00:34:22,639
i think it will really help you in in

884
00:34:22,639 --> 00:34:24,879
your effort

885
00:34:24,879 --> 00:34:27,199
so okay what happens then the attacker

886
00:34:27,199 --> 00:34:29,760
is on the box he has exec he or she has

887
00:34:29,760 --> 00:34:32,239
executed command and control they can

888
00:34:32,239 --> 00:34:33,280
look at

889
00:34:33,280 --> 00:34:35,040
you know screen captures and things like

890
00:34:35,040 --> 00:34:35,918
that

891
00:34:35,918 --> 00:34:38,879
so then they try to uh

892
00:34:38,879 --> 00:34:41,199
dump a credentials so

893
00:34:41,199 --> 00:34:43,839
there have been some uac bypass

894
00:34:43,839 --> 00:34:45,839
vulnerabilities and that is what the

895
00:34:45,839 --> 00:34:48,960
attackers use to dump the current users

896
00:34:48,960 --> 00:34:50,800
uh credentials

897
00:34:50,800 --> 00:34:52,800
so there is a tool called as open source

898
00:34:52,800 --> 00:34:55,359
tool called as mimikatz i think how many

899
00:34:55,359 --> 00:34:57,760
of you have heard of mimikatz okay good

900
00:34:57,760 --> 00:35:00,720
so mimikatz was as you know was written

901
00:35:00,720 --> 00:35:04,640
by a developer to to show microsoft

902
00:35:04,640 --> 00:35:05,520
um

903
00:35:05,520 --> 00:35:08,160
the vulnerabilities in their

904
00:35:08,160 --> 00:35:10,640
uh authentication and credential system

905
00:35:10,640 --> 00:35:14,400
and past the past the hash was the first

906
00:35:14,400 --> 00:35:17,280
most famous mimikatz function has been

907
00:35:17,280 --> 00:35:20,240
downloaded and used by a lot of

908
00:35:20,240 --> 00:35:22,640
researchers and things like that

909
00:35:22,640 --> 00:35:24,800
unfortunately some of these tools or

910
00:35:24,800 --> 00:35:27,359
many of these tools have are also used

911
00:35:27,359 --> 00:35:32,319
by attackers for their advantage so

912
00:35:32,480 --> 00:35:35,200
carbonac uses a modified version of

913
00:35:35,200 --> 00:35:37,040
mimikats to

914
00:35:37,040 --> 00:35:40,480
dump credentials mimikatz again has now

915
00:35:40,480 --> 00:35:42,880
evolved it has a lot so what microsoft

916
00:35:42,880 --> 00:35:44,960
did was because of the past the hash

917
00:35:44,960 --> 00:35:47,520
they they moved to tokens then mimikatz

918
00:35:47,520 --> 00:35:50,400
upgraded itself to pass the token and

919
00:35:50,400 --> 00:35:52,640
then i mean if you i would really

920
00:35:52,640 --> 00:35:54,800
recommend you to look at the different

921
00:35:54,800 --> 00:35:56,880
features of mimikatz what it does and

922
00:35:56,880 --> 00:36:00,160
how it has responded to

923
00:36:00,160 --> 00:36:02,800
to different security mechanisms that

924
00:36:02,800 --> 00:36:05,119
are introduced in the os

925
00:36:05,119 --> 00:36:07,839
i really think open source tools really

926
00:36:07,839 --> 00:36:10,880
help in increasing the security overall

927
00:36:10,880 --> 00:36:13,920
of the ecosystem but again it's a very

928
00:36:13,920 --> 00:36:16,320
different talk if you want to debate on

929
00:36:16,320 --> 00:36:18,240
on that so

930
00:36:18,240 --> 00:36:20,880
anyway so it uses mimikats to dump plain

931
00:36:20,880 --> 00:36:23,599
text credentials of the current user

932
00:36:23,599 --> 00:36:25,359
because they have screenshots but they

933
00:36:25,359 --> 00:36:27,440
need credentials

934
00:36:27,440 --> 00:36:29,280
so that is

935
00:36:29,280 --> 00:36:30,960
here in

936
00:36:30,960 --> 00:36:33,440
in the mitre framework

937
00:36:33,440 --> 00:36:34,880
after that

938
00:36:34,880 --> 00:36:37,040
the machine may be of interest the

939
00:36:37,040 --> 00:36:38,880
machine the current machine that they

940
00:36:38,880 --> 00:36:41,200
are on may not be of interest so the the

941
00:36:41,200 --> 00:36:43,760
attacker tries to do a lateral movement

942
00:36:43,760 --> 00:36:44,480
to

943
00:36:44,480 --> 00:36:47,440
different uh machines and try to find

944
00:36:47,440 --> 00:36:50,240
machines that are really interesting for

945
00:36:50,240 --> 00:36:51,520
him or her

946
00:36:51,520 --> 00:36:56,240
so uh carbonac used uh several tools for

947
00:36:56,240 --> 00:36:57,839
lateral movement

948
00:36:57,839 --> 00:37:01,440
uh several second phase uh rats so the

949
00:37:01,440 --> 00:37:04,320
first remote access tool is really they

950
00:37:04,320 --> 00:37:07,280
want to be hidden not noticed and now

951
00:37:07,280 --> 00:37:08,960
they are like sort of upping up their

952
00:37:08,960 --> 00:37:11,440
game and taking a little bit more risk

953
00:37:11,440 --> 00:37:14,560
because the more tools they try they

954
00:37:14,560 --> 00:37:16,960
download they send there is more chance

955
00:37:16,960 --> 00:37:19,680
of yours behavior based systems catching

956
00:37:19,680 --> 00:37:23,200
them but i mean they have to do this so

957
00:37:23,200 --> 00:37:25,839
uh they try to do these various

958
00:37:25,839 --> 00:37:27,280
techniques and i'm not gonna read

959
00:37:27,280 --> 00:37:29,440
everything on the screen but they try to

960
00:37:29,440 --> 00:37:32,240
do these various techniques to move uh

961
00:37:32,240 --> 00:37:35,839
laterally and to gain a shell on the

962
00:37:35,839 --> 00:37:37,760
domain controller so they try to find

963
00:37:37,760 --> 00:37:40,000
where is the domain controller

964
00:37:40,000 --> 00:37:42,560
for that particular windows network and

965
00:37:42,560 --> 00:37:45,200
then they try to find you know where is

966
00:37:45,200 --> 00:37:48,079
that particular domain controller try to

967
00:37:48,079 --> 00:37:51,760
get using smb on that domain controller

968
00:37:51,760 --> 00:37:54,480
so carbonac has used

969
00:37:54,480 --> 00:37:55,920
ps exec

970
00:37:55,920 --> 00:37:59,040
is known to use tinymat has downloaded

971
00:37:59,040 --> 00:38:01,200
and utilized ps cap these are all

972
00:38:01,200 --> 00:38:03,280
different open source

973
00:38:03,280 --> 00:38:05,599
or different various utilities that it

974
00:38:05,599 --> 00:38:08,079
uses

975
00:38:08,560 --> 00:38:10,160
to

976
00:38:10,160 --> 00:38:12,000
get access

977
00:38:12,000 --> 00:38:13,839
and it has performed the past the hash

978
00:38:13,839 --> 00:38:15,040
function

979
00:38:15,040 --> 00:38:19,119
so that's where your lateral movement is

980
00:38:19,119 --> 00:38:19,920
so

981
00:38:19,920 --> 00:38:23,359
discovery of privileged users so now uh

982
00:38:23,359 --> 00:38:26,000
they are trying to find where is your

983
00:38:26,000 --> 00:38:28,400
where is the privileged user so they use

984
00:38:28,400 --> 00:38:29,839
uh

985
00:38:29,839 --> 00:38:32,400
they they try to

986
00:38:32,400 --> 00:38:34,560
find these privileged users from the

987
00:38:34,560 --> 00:38:37,599
domain controller by running get ad

988
00:38:37,599 --> 00:38:40,880
computer get net user power view and

989
00:38:40,880 --> 00:38:43,520
various techniques that are

990
00:38:43,520 --> 00:38:46,240
again documented and you can sort of

991
00:38:46,240 --> 00:38:48,800
google on them and try to find out what

992
00:38:48,800 --> 00:38:51,359
what those different techniques

993
00:38:51,359 --> 00:38:52,720
do so

994
00:38:52,720 --> 00:38:54,240
trying to find

995
00:38:54,240 --> 00:38:57,680
a privileged user and let me just

996
00:38:57,680 --> 00:38:59,839
scroll through this

997
00:38:59,839 --> 00:39:02,640
once they find the privileged account

998
00:39:02,640 --> 00:39:05,440
from the domain controller they try to

999
00:39:05,440 --> 00:39:07,920
persist on that privileged account and

1000
00:39:07,920 --> 00:39:09,440
now what is this privilege account

1001
00:39:09,440 --> 00:39:11,680
exactly so this privileged account what

1002
00:39:11,680 --> 00:39:13,920
they are trying to find is an account of

1003
00:39:13,920 --> 00:39:16,400
someone who does the transaction who

1004
00:39:16,400 --> 00:39:18,400
opens up the

1005
00:39:18,400 --> 00:39:20,720
financial who opens up their browser or

1006
00:39:20,720 --> 00:39:22,720
some other software and does financial

1007
00:39:22,720 --> 00:39:24,720
transactions

1008
00:39:24,720 --> 00:39:26,800
transfers money to other vendors

1009
00:39:26,800 --> 00:39:30,000
transfers payment to other vendors so

1010
00:39:30,000 --> 00:39:32,560
that is essentially what they are after

1011
00:39:32,560 --> 00:39:34,880
and again i have 10 minutes i'll breeze

1012
00:39:34,880 --> 00:39:37,280
through this

1013
00:39:38,320 --> 00:39:40,640
and

1014
00:39:41,440 --> 00:39:43,200
basically try to

1015
00:39:43,200 --> 00:39:46,880
create covert access and profile

1016
00:39:46,880 --> 00:39:49,760
the profile the victim again create a

1017
00:39:49,760 --> 00:39:53,040
reverse shell with that privileged users

1018
00:39:53,040 --> 00:39:55,200
account

1019
00:39:55,200 --> 00:39:58,160
uh so now after setting up persistence

1020
00:39:58,160 --> 00:39:59,040
uh

1021
00:39:59,040 --> 00:40:00,880
what

1022
00:40:00,880 --> 00:40:02,800
what what they do is they

1023
00:40:02,800 --> 00:40:04,880
install now now they know that okay now

1024
00:40:04,880 --> 00:40:06,480
i'm on the machine

1025
00:40:06,480 --> 00:40:09,440
of a privileged user that is doing these

1026
00:40:09,440 --> 00:40:10,800
transactions that is doing these

1027
00:40:10,800 --> 00:40:13,119
financial transactions or that has some

1028
00:40:13,119 --> 00:40:15,760
remote access to these atms and whatnot

1029
00:40:15,760 --> 00:40:17,119
and again

1030
00:40:17,119 --> 00:40:18,640
i think we have all this in mind this

1031
00:40:18,640 --> 00:40:21,119
didn't happen in one day this happened

1032
00:40:21,119 --> 00:40:22,960
where the attacker was in the network

1033
00:40:22,960 --> 00:40:25,839
looking at screenshots every day or in

1034
00:40:25,839 --> 00:40:28,079
their data center whatever was being

1035
00:40:28,079 --> 00:40:29,520
uploaded

1036
00:40:29,520 --> 00:40:32,560
so um

1037
00:40:32,560 --> 00:40:33,839
this is so

1038
00:40:33,839 --> 00:40:35,599
once the attacker know

1039
00:40:35,599 --> 00:40:38,640
that he or she is on the privileged

1040
00:40:38,640 --> 00:40:40,240
machine and this is the machine they

1041
00:40:40,240 --> 00:40:43,119
want they really learn how transactions

1042
00:40:43,119 --> 00:40:45,200
are done in that organization the

1043
00:40:45,200 --> 00:40:47,280
attacker may have knowledge of generally

1044
00:40:47,280 --> 00:40:49,119
how financial transactions are done but

1045
00:40:49,119 --> 00:40:52,480
how is it done in your organization

1046
00:40:52,480 --> 00:40:54,880
what software do you go to where do you

1047
00:40:54,880 --> 00:40:57,680
click how do you do that so they really

1048
00:40:57,680 --> 00:41:00,640
learn uh what's happening uh for that

1049
00:41:00,640 --> 00:41:02,480
privileged user who does these financial

1050
00:41:02,480 --> 00:41:05,520
transactions in in

1051
00:41:05,520 --> 00:41:09,760
this phase they install key loggers to

1052
00:41:09,760 --> 00:41:12,560
uh get your credentials or sometimes get

1053
00:41:12,560 --> 00:41:14,319
credentials from your browser memory

1054
00:41:14,319 --> 00:41:17,200
cache and uh

1055
00:41:17,200 --> 00:41:20,640
you can use reverse shell to to to

1056
00:41:20,640 --> 00:41:23,520
obtain all this information

1057
00:41:23,520 --> 00:41:25,599
so at this point the attacker or

1058
00:41:25,599 --> 00:41:29,119
carbonac has enough information to

1059
00:41:29,119 --> 00:41:31,359
and again look up all these t

1060
00:41:31,359 --> 00:41:32,400
uh

1061
00:41:32,400 --> 00:41:34,960
numbers to get more information on each

1062
00:41:34,960 --> 00:41:36,160
of it

1063
00:41:36,160 --> 00:41:39,040
so at this point the attacker has enough

1064
00:41:39,040 --> 00:41:42,240
information uh from the initial email to

1065
00:41:42,240 --> 00:41:45,040
coming to being executed on a machine

1066
00:41:45,040 --> 00:41:47,680
finding a privileged user

1067
00:41:47,680 --> 00:41:50,240
and finding how the privileged user

1068
00:41:50,240 --> 00:41:52,720
behaves they have enough information to

1069
00:41:52,720 --> 00:41:56,480
now carry out an attack this was just

1070
00:41:56,480 --> 00:41:58,720
all of this was still just trying to

1071
00:41:58,720 --> 00:42:01,040
find information staying low

1072
00:42:01,040 --> 00:42:02,480
and

1073
00:42:02,480 --> 00:42:05,359
trying to learn things in in the victims

1074
00:42:05,359 --> 00:42:07,200
network

1075
00:42:07,200 --> 00:42:09,200
now with all this information what they

1076
00:42:09,200 --> 00:42:11,119
do is they essentially impersonate

1077
00:42:11,119 --> 00:42:14,640
victim now it's really easy after this

1078
00:42:14,640 --> 00:42:17,680
things still now very difficult now it's

1079
00:42:17,680 --> 00:42:21,280
they they could install some remote

1080
00:42:21,280 --> 00:42:24,319
control program like vnc

1081
00:42:24,319 --> 00:42:25,920
and

1082
00:42:25,920 --> 00:42:27,839
essentially use the credentials that

1083
00:42:27,839 --> 00:42:28,839
they have

1084
00:42:28,839 --> 00:42:31,920
obtained to control the

1085
00:42:31,920 --> 00:42:34,319
victims machine they already are on the

1086
00:42:34,319 --> 00:42:36,800
domain controller and i think uh in one

1087
00:42:36,800 --> 00:42:39,440
of these t rules they have mentioned

1088
00:42:39,440 --> 00:42:41,440
that they do see on the domain control

1089
00:42:41,440 --> 00:42:42,400
machine

1090
00:42:42,400 --> 00:42:44,880
if a user is logged in or not on that

1091
00:42:44,880 --> 00:42:47,520
machine when the user is not logged in

1092
00:42:47,520 --> 00:42:50,000
that is when they execute this

1093
00:42:50,000 --> 00:42:52,400
they take control of that machine

1094
00:42:52,400 --> 00:42:53,680
and

1095
00:42:53,680 --> 00:42:55,680
essentially from what they have learned

1096
00:42:55,680 --> 00:42:56,839
so far

1097
00:42:56,839 --> 00:42:59,680
um just impersonate the machine do the

1098
00:42:59,680 --> 00:43:01,839
same thing and do the same

1099
00:43:01,839 --> 00:43:04,000
banking transactions

1100
00:43:04,000 --> 00:43:05,119
for

1101
00:43:05,119 --> 00:43:08,720
their benefit in their accounts

1102
00:43:08,880 --> 00:43:11,359
so that is

1103
00:43:11,359 --> 00:43:13,359
yeah that is pretty much

1104
00:43:13,359 --> 00:43:15,200
essentially this is when the attack is

1105
00:43:15,200 --> 00:43:17,119
complete the banking transactions are

1106
00:43:17,119 --> 00:43:17,920
done

1107
00:43:17,920 --> 00:43:19,359
and the

1108
00:43:19,359 --> 00:43:21,280
carbon act has the money from that

1109
00:43:21,280 --> 00:43:23,760
particular financial institution

1110
00:43:23,760 --> 00:43:26,000
now it almost sounds like a movie isn't

1111
00:43:26,000 --> 00:43:28,480
it like i mean

1112
00:43:28,480 --> 00:43:30,560
mission impossible or whatever movies

1113
00:43:30,560 --> 00:43:32,960
where an attacker is moving but this is

1114
00:43:32,960 --> 00:43:33,760
as

1115
00:43:33,760 --> 00:43:35,280
i said that's the reason i chose

1116
00:43:35,280 --> 00:43:38,079
carbonac which is a very well

1117
00:43:38,079 --> 00:43:40,560
known thread group very well

1118
00:43:40,560 --> 00:43:42,880
known research to malware

1119
00:43:42,880 --> 00:43:44,960
and whatever i've presented here is i

1120
00:43:44,960 --> 00:43:46,800
mean you know sort of common information

1121
00:43:46,800 --> 00:43:49,280
now of how carbon act worked and

1122
00:43:49,280 --> 00:43:52,160
managed to get a billion dollars from

1123
00:43:52,160 --> 00:43:54,400
more than 100 financial

1124
00:43:54,400 --> 00:43:57,280
institutions in 30 different countries

1125
00:43:57,280 --> 00:43:59,920
so just just a lot of mind boggling

1126
00:43:59,920 --> 00:44:02,319
numbers

1127
00:44:06,839 --> 00:44:10,880
so so this was was our original attack

1128
00:44:10,880 --> 00:44:13,200
uh which started from a phishing email

1129
00:44:13,200 --> 00:44:15,680
to a bank employee to find to moving

1130
00:44:15,680 --> 00:44:18,560
laterally finding a privileged account

1131
00:44:18,560 --> 00:44:21,440
uh using screen recording to

1132
00:44:21,440 --> 00:44:23,920
really learn how money transfers are

1133
00:44:23,920 --> 00:44:26,560
done and then carry out

1134
00:44:26,560 --> 00:44:28,720
these transactions

1135
00:44:28,720 --> 00:44:31,119
so if you augment it if you add the

1136
00:44:31,119 --> 00:44:34,880
miter sort of framework on top of it and

1137
00:44:34,880 --> 00:44:37,359
the guys here have really done the

1138
00:44:37,359 --> 00:44:39,119
github link is already in the first

1139
00:44:39,119 --> 00:44:41,359
slide of creating this chart then you

1140
00:44:41,359 --> 00:44:43,520
can literally see how

1141
00:44:43,520 --> 00:44:46,000
they jump from one phase to another of

1142
00:44:46,000 --> 00:44:48,880
the mitre techniques and

1143
00:44:48,880 --> 00:44:50,640
carry out the attack

1144
00:44:50,640 --> 00:44:53,200
so i think we have that's all i have for

1145
00:44:53,200 --> 00:44:56,400
today we have five minutes uh

1146
00:44:56,400 --> 00:44:58,560
thank you so much and i'll open it up

1147
00:44:58,560 --> 00:44:59,440
for

1148
00:44:59,440 --> 00:45:01,810
questions at this time

1149
00:45:01,810 --> 00:45:09,100
[Applause]

1150
00:45:12,400 --> 00:45:13,440
um

1151
00:45:13,440 --> 00:45:18,200
uh questions here this is a great talk

1152
00:45:18,640 --> 00:45:20,400
anyone

1153
00:45:20,400 --> 00:45:24,880
okay well i have one um so

1154
00:45:26,640 --> 00:45:29,118
there we go

1155
00:45:30,319 --> 00:45:33,319
okay

1156
00:45:42,720 --> 00:45:43,920
use

1157
00:45:43,920 --> 00:45:45,440
some

1158
00:45:45,440 --> 00:45:47,440
browser related as in stealing your

1159
00:45:47,440 --> 00:45:51,440
credentials from the browser's memory

1160
00:45:51,440 --> 00:45:53,760
so when the operator or the privileged

1161
00:45:53,760 --> 00:45:55,200
user log

1162
00:45:55,200 --> 00:45:57,280
went to their browser and logged into

1163
00:45:57,280 --> 00:45:58,839
those

1164
00:45:58,839 --> 00:46:00,720
systems uh

1165
00:46:00,720 --> 00:46:03,280
i mean your i mean whenever you enter

1166
00:46:03,280 --> 00:46:05,440
anything in your browser it is in the

1167
00:46:05,440 --> 00:46:09,599
browser's memories and if uh if you have

1168
00:46:09,599 --> 00:46:11,920
higher credentials access on that

1169
00:46:11,920 --> 00:46:13,040
machine

1170
00:46:13,040 --> 00:46:15,280
that particular process can

1171
00:46:15,280 --> 00:46:17,920
just read the entire memory and plug it

1172
00:46:17,920 --> 00:46:20,079
out of memory i mean that's how

1173
00:46:20,079 --> 00:46:22,240
um on on i mean we're talking about

1174
00:46:22,240 --> 00:46:24,000
windows here i mean that's how most

1175
00:46:24,000 --> 00:46:25,920
debuggers work right like if you write a

1176
00:46:25,920 --> 00:46:27,839
program and if you're trying to debug it

1177
00:46:27,839 --> 00:46:30,800
a debugger requires a higher privilege

1178
00:46:30,800 --> 00:46:32,640
access but then can attach to other

1179
00:46:32,640 --> 00:46:35,040
processes and show you memory and things

1180
00:46:35,040 --> 00:46:36,640
like that of other processes so that's

1181
00:46:36,640 --> 00:46:37,520
what

1182
00:46:37,520 --> 00:46:40,960
they do is they once they get

1183
00:46:40,960 --> 00:46:43,119
once they are on the box they try to get

1184
00:46:43,119 --> 00:46:44,880
those higher privileges on the box so

1185
00:46:44,880 --> 00:46:47,280
then they can act as a debugger attached

1186
00:46:47,280 --> 00:46:49,599
to any process and get a dump dump

1187
00:46:49,599 --> 00:46:51,440
memory and things like that so

1188
00:46:51,440 --> 00:46:54,560
the man in the middle for the browser i

1189
00:46:54,560 --> 00:46:56,640
don't think

1190
00:46:56,640 --> 00:47:00,640
i'm not sure i don't think most probably

1191
00:47:00,640 --> 00:47:03,599
was used in carbonx case but i think

1192
00:47:03,599 --> 00:47:05,440
they definitely used

1193
00:47:05,440 --> 00:47:09,800
the credential stealing from the browser

1194
00:47:10,560 --> 00:47:12,079
okay good um

1195
00:47:12,079 --> 00:47:16,720
other people got questions oh great

1196
00:47:21,680 --> 00:47:24,000
man

1197
00:47:32,240 --> 00:47:35,440
anybody anybody catch them in the act

1198
00:47:35,440 --> 00:47:37,040
while this while one of their attacks

1199
00:47:37,040 --> 00:47:39,599
was taking place or was this all

1200
00:47:39,599 --> 00:47:41,520
subsequent like they found that the

1201
00:47:41,520 --> 00:47:44,240
money was gone

1202
00:47:47,599 --> 00:47:49,040
research

1203
00:47:49,040 --> 00:47:51,119
or looked into

1204
00:47:51,119 --> 00:47:52,730
how they were caught um

1205
00:47:52,730 --> 00:47:54,000
[Music]

1206
00:47:54,000 --> 00:47:55,839
or if they were caught in the act they

1207
00:47:55,839 --> 00:47:58,079
were

1208
00:47:58,079 --> 00:47:59,599
like all the

1209
00:47:59,599 --> 00:48:01,839
interpol and all the

1210
00:48:01,839 --> 00:48:03,359
threat

1211
00:48:03,359 --> 00:48:04,480
all the

1212
00:48:04,480 --> 00:48:06,240
sort of cops from all the countries were

1213
00:48:06,240 --> 00:48:08,319
looking for it they were found in

1214
00:48:08,319 --> 00:48:11,230
i think eastern europe somewhere um

1215
00:48:11,230 --> 00:48:12,559
[Music]

1216
00:48:12,559 --> 00:48:15,040
and i don't know the details on how they

1217
00:48:15,040 --> 00:48:16,480
were caught

1218
00:48:16,480 --> 00:48:18,240
so yeah sorry sorry i don't know how

1219
00:48:18,240 --> 00:48:20,160
they were caught

1220
00:48:20,160 --> 00:48:21,839
so there is i think one one more

1221
00:48:21,839 --> 00:48:22,800
question

1222
00:48:22,800 --> 00:48:24,000
but i mean

1223
00:48:24,000 --> 00:48:26,960
if if if

1224
00:48:27,520 --> 00:48:29,680
say that they infiltrated 100

1225
00:48:29,680 --> 00:48:31,520
organizations they were definitely not

1226
00:48:31,520 --> 00:48:33,280
caught in the first hundred maybe it's

1227
00:48:33,280 --> 00:48:35,119
the 101

1228
00:48:35,119 --> 00:48:38,079
is where they were caught

1229
00:48:40,640 --> 00:48:43,640
question

1230
00:49:05,119 --> 00:49:06,880
like you are in this case you are a

1231
00:49:06,880 --> 00:49:08,640
financial institution

1232
00:49:08,640 --> 00:49:10,720
you know that there is this financial

1233
00:49:10,720 --> 00:49:13,040
malware going on i think what the

1234
00:49:13,040 --> 00:49:15,119
trigger that you have is

1235
00:49:15,119 --> 00:49:16,960
as a threat hunter you would immediately

1236
00:49:16,960 --> 00:49:18,559
start to

1237
00:49:18,559 --> 00:49:20,240
research on

1238
00:49:20,240 --> 00:49:21,920
what does the malwared

1239
00:49:21,920 --> 00:49:23,760
do how does it behave

1240
00:49:23,760 --> 00:49:24,880
try to

1241
00:49:24,880 --> 00:49:27,760
communicate with a lot of

1242
00:49:27,760 --> 00:49:31,520
organizations or even connect with

1243
00:49:31,520 --> 00:49:33,119
authorities to see if you can get a

1244
00:49:33,119 --> 00:49:35,119
malware sample or if

1245
00:49:35,119 --> 00:49:36,880
try to find any and every information

1246
00:49:36,880 --> 00:49:40,319
about that attack or malware and then

1247
00:49:40,319 --> 00:49:42,640
if you get some iocs then yeah try to

1248
00:49:42,640 --> 00:49:45,040
see if those particular iocs are in your

1249
00:49:45,040 --> 00:49:49,119
logs in your network in your emails

1250
00:49:49,119 --> 00:49:50,880
it really depends on

1251
00:49:50,880 --> 00:49:52,720
your investigation and how much

1252
00:49:52,720 --> 00:49:55,760
information is available you can also

1253
00:49:55,760 --> 00:49:57,760
look for behavior so if there are no

1254
00:49:57,760 --> 00:49:59,839
iocs available if there is not much

1255
00:49:59,839 --> 00:50:01,599
concrete information available there is

1256
00:50:01,599 --> 00:50:03,760
no malware samples

1257
00:50:03,760 --> 00:50:06,240
but if you even know the behavior or the

1258
00:50:06,240 --> 00:50:08,079
common behaviors you have seen in the

1259
00:50:08,079 --> 00:50:11,040
past like we saw like there are some wmi

1260
00:50:11,040 --> 00:50:13,040
queries being run or power shell being

1261
00:50:13,040 --> 00:50:15,119
run or

1262
00:50:15,119 --> 00:50:17,520
sys internal tools being downloaded then

1263
00:50:17,520 --> 00:50:19,359
you can also look for those type of

1264
00:50:19,359 --> 00:50:20,720
things because

1265
00:50:20,720 --> 00:50:23,599
malware writers use a lot of

1266
00:50:23,599 --> 00:50:25,760
reuse of code you know no one is going

1267
00:50:25,760 --> 00:50:27,760
to write all these tools from scratch so

1268
00:50:27,760 --> 00:50:30,000
they use all these existing tools so i

1269
00:50:30,000 --> 00:50:31,760
think one of the best things which could

1270
00:50:31,760 --> 00:50:33,440
be done is to see

1271
00:50:33,440 --> 00:50:34,960
uh

1272
00:50:34,960 --> 00:50:37,839
if these tools are running in on your in

1273
00:50:37,839 --> 00:50:40,800
your organization and does uh that

1274
00:50:40,800 --> 00:50:42,640
particular person really need this tool

1275
00:50:42,640 --> 00:50:44,319
so if it's a banking organization as i

1276
00:50:44,319 --> 00:50:46,079
said do

1277
00:50:46,079 --> 00:50:47,280
you know

1278
00:50:47,280 --> 00:50:49,040
does the person really need uh

1279
00:50:49,040 --> 00:50:51,760
powershell or wmi queries to do his or

1280
00:50:51,760 --> 00:50:54,240
her banking transactions so yeah that's

1281
00:50:54,240 --> 00:50:57,640
what i can suggest

