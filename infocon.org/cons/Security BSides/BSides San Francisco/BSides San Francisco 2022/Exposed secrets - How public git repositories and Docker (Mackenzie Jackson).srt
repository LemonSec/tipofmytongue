1
00:00:00,080 --> 00:00:02,480
uh we're gonna kick off today by

2
00:00:02,480 --> 00:00:05,600
learning about exposed secrets in github

3
00:00:05,600 --> 00:00:07,680
from mackenzie jackson who is a

4
00:00:07,680 --> 00:00:10,080
developer advocate i have to get another

5
00:00:10,080 --> 00:00:13,360
company right now don't i at

6
00:00:13,360 --> 00:00:14,960
you promised you'd get it

7
00:00:14,960 --> 00:00:16,000
it right so i'm gonna actually read it

8
00:00:16,000 --> 00:00:17,840
i'm gonna actually read it

9
00:00:17,840 --> 00:00:19,760
because i like invented it two minutes

10
00:00:19,760 --> 00:00:20,560
ago

11
00:00:20,560 --> 00:00:23,279
um at get guardian

12
00:00:23,279 --> 00:00:25,840
thank you thank you very much

13
00:00:25,840 --> 00:00:28,480
yeah so uh hello everyone welcome to day

14
00:00:28,480 --> 00:00:30,560
two um yesterday was awesome for those

15
00:00:30,560 --> 00:00:32,960
that were here so it's awesome it's

16
00:00:32,960 --> 00:00:34,719
great to be presenting back in front of

17
00:00:34,719 --> 00:00:36,399
everyone i think

18
00:00:36,399 --> 00:00:37,680
all the presentations i've done over the

19
00:00:37,680 --> 00:00:39,120
last two years have been in my in my

20
00:00:39,120 --> 00:00:41,120
bedroom so it's great to see actual

21
00:00:41,120 --> 00:00:43,440
people it's great to be wearing pants

22
00:00:43,440 --> 00:00:45,280
um

23
00:00:45,280 --> 00:00:46,559
so today we're going to be talking about

24
00:00:46,559 --> 00:00:48,160
exposed secrets so we're going to be

25
00:00:48,160 --> 00:00:50,320
talking about exposed secrets both both

26
00:00:50,320 --> 00:00:52,480
publicly in places like public git

27
00:00:52,480 --> 00:00:55,199
repositories in public areas like docker

28
00:00:55,199 --> 00:00:56,960
and also privately and what that all

29
00:00:56,960 --> 00:00:58,160
means so we're going to start off we'll

30
00:00:58,160 --> 00:01:00,399
do a quick rundown about secrets what

31
00:01:00,399 --> 00:01:02,320
they are how they expose themselves

32
00:01:02,320 --> 00:01:04,239
we'll talk about some breaches

33
00:01:04,239 --> 00:01:06,159
we'll leak some credentials live and see

34
00:01:06,159 --> 00:01:07,439
what happens

35
00:01:07,439 --> 00:01:08,400
and then

36
00:01:08,400 --> 00:01:09,600
we'll run through some research that

37
00:01:09,600 --> 00:01:11,439
we've done that will quantify

38
00:01:11,439 --> 00:01:12,400
um

39
00:01:12,400 --> 00:01:14,799
the problem so just to start what are

40
00:01:14,799 --> 00:01:17,360
secrets so i'm sure probably most of you

41
00:01:17,360 --> 00:01:18,880
understand this but i want to kind of

42
00:01:18,880 --> 00:01:20,479
get everyone onto the same page so we'll

43
00:01:20,479 --> 00:01:22,560
quickly run through what secrets are so

44
00:01:22,560 --> 00:01:23,920
they're digital authentication

45
00:01:23,920 --> 00:01:26,400
credentials they are essentially

46
00:01:26,400 --> 00:01:28,320
the crown jewels of organization these

47
00:01:28,320 --> 00:01:31,680
are api keys uh security certificates uh

48
00:01:31,680 --> 00:01:33,439
credential peers

49
00:01:33,439 --> 00:01:36,720
private keys these are what authenticate

50
00:01:36,720 --> 00:01:38,880
us and our systems

51
00:01:38,880 --> 00:01:39,759
with

52
00:01:39,759 --> 00:01:41,600
everything that we're using they provide

53
00:01:41,600 --> 00:01:43,439
access to the innermost workings of our

54
00:01:43,439 --> 00:01:46,159
organizations and they're exactly what

55
00:01:46,159 --> 00:01:48,399
attackers and adversaries are after

56
00:01:48,399 --> 00:01:50,240
because it allows them to move laterally

57
00:01:50,240 --> 00:01:51,450
elevate privileges

58
00:01:51,450 --> 00:01:52,799
[Music]

59
00:01:52,799 --> 00:01:54,640
so why do these secrets exist well we've

60
00:01:54,640 --> 00:01:56,640
had a big shift in how we build software

61
00:01:56,640 --> 00:01:58,159
right no longer are we building any

62
00:01:58,159 --> 00:02:01,360
monolith monolithic applications

63
00:02:01,360 --> 00:02:03,759
we're building these distributed systems

64
00:02:03,759 --> 00:02:06,479
full of microservices and

65
00:02:06,479 --> 00:02:08,399
because of this developers have

66
00:02:08,399 --> 00:02:10,479
huge amounts of sensitive information

67
00:02:10,479 --> 00:02:12,480
that we need to keep track of they need

68
00:02:12,480 --> 00:02:14,879
access to these secrets to be able to uh

69
00:02:14,879 --> 00:02:17,040
test applications to be able to import

70
00:02:17,040 --> 00:02:18,959
to input them the operations team need

71
00:02:18,959 --> 00:02:22,000
them they need to be uh used to deploy

72
00:02:22,000 --> 00:02:23,680
so we need to distribute these secrets

73
00:02:23,680 --> 00:02:26,080
really really widely but we also need to

74
00:02:26,080 --> 00:02:28,480
protect them right so this creates an

75
00:02:28,480 --> 00:02:30,720
immediate conflict of what we need to do

76
00:02:30,720 --> 00:02:32,080
now because they're made to be used

77
00:02:32,080 --> 00:02:33,680
programmatically they often end up in

78
00:02:33,680 --> 00:02:35,280
source code so programmatically means

79
00:02:35,280 --> 00:02:36,640
that they're meant to be used not by

80
00:02:36,640 --> 00:02:38,319
people but by systems by our

81
00:02:38,319 --> 00:02:39,760
applications

82
00:02:39,760 --> 00:02:41,200
so this means that they're a great

83
00:02:41,200 --> 00:02:43,120
candidate for getting into our source

84
00:02:43,120 --> 00:02:45,360
code and source code is a crazy leaky

85
00:02:45,360 --> 00:02:47,200
asset which we'll talk about later

86
00:02:47,200 --> 00:02:49,280
and then everyone's stressed software

87
00:02:49,280 --> 00:02:50,879
developers under pressure security teams

88
00:02:50,879 --> 00:02:52,319
are under pressure operation teams are

89
00:02:52,319 --> 00:02:53,599
under pressure

90
00:02:53,599 --> 00:02:56,160
and this creates a perfect storm of how

91
00:02:56,160 --> 00:02:57,840
these secrets the crown jewels of our

92
00:02:57,840 --> 00:02:59,440
organizations end up in the public

93
00:02:59,440 --> 00:03:00,640
sphere

94
00:03:00,640 --> 00:03:02,400
so let's do a quick example we're

95
00:03:02,400 --> 00:03:05,360
building an application um and if we

96
00:03:05,360 --> 00:03:07,120
want to do credit card processing if we

97
00:03:07,120 --> 00:03:08,879
want to do authentication then we're

98
00:03:08,879 --> 00:03:09,760
probably not going to build that

99
00:03:09,760 --> 00:03:11,920
ourselves unless you're mad we'll use

100
00:03:11,920 --> 00:03:13,519
different services we'll use octa we'll

101
00:03:13,519 --> 00:03:15,920
use stripe we use algolia for searches

102
00:03:15,920 --> 00:03:18,640
so quickly our application is a

103
00:03:18,640 --> 00:03:20,560
collection of different services all of

104
00:03:20,560 --> 00:03:21,760
these services

105
00:03:21,760 --> 00:03:23,599
leverage secrets

106
00:03:23,599 --> 00:03:24,799
right then we need to have some

107
00:03:24,799 --> 00:03:26,000
infrastructure we need to host our

108
00:03:26,000 --> 00:03:28,400
application so now we have some cloud

109
00:03:28,400 --> 00:03:30,480
infrastructure we have testing tools we

110
00:03:30,480 --> 00:03:33,519
have vcs uh you know we have all these

111
00:03:33,519 --> 00:03:34,799
different collections of services and

112
00:03:34,799 --> 00:03:36,720
our infrastructure all leveraging

113
00:03:36,720 --> 00:03:38,000
secrets they all need to be able to talk

114
00:03:38,000 --> 00:03:39,519
to each other

115
00:03:39,519 --> 00:03:41,120
then when we finally launch our

116
00:03:41,120 --> 00:03:42,879
application the pesky marketing team the

117
00:03:42,879 --> 00:03:44,799
sales teams they want integrations into

118
00:03:44,799 --> 00:03:47,120
salesforce and zendesk and so we need to

119
00:03:47,120 --> 00:03:48,640
have more secrets to be able to connect

120
00:03:48,640 --> 00:03:50,879
to them and this doesn't even include

121
00:03:50,879 --> 00:03:52,959
all of the microservices

122
00:03:52,959 --> 00:03:54,480
that we've created that offer a

123
00:03:54,480 --> 00:03:56,640
leveraged secret so in this very

124
00:03:56,640 --> 00:03:58,879
simplified example we can see that we

125
00:03:58,879 --> 00:04:00,879
have hundreds

126
00:04:00,879 --> 00:04:03,599
of different services all leveraging

127
00:04:03,599 --> 00:04:06,239
secrets so this is how we end up with so

128
00:04:06,239 --> 00:04:10,080
many secrets uh in our infrastructure

129
00:04:10,080 --> 00:04:11,360
and

130
00:04:11,360 --> 00:04:13,360
these gets ruled largely through our

131
00:04:13,360 --> 00:04:15,280
source code so you imagine when source

132
00:04:15,280 --> 00:04:16,880
code goes into our git repository if it

133
00:04:16,880 --> 00:04:19,519
has secrets in there that source code

134
00:04:19,519 --> 00:04:22,160
with those secrets is then distributed

135
00:04:22,160 --> 00:04:24,080
and sprawled across all of our

136
00:04:24,080 --> 00:04:25,759
developers machines

137
00:04:25,759 --> 00:04:27,919
it's probably in our messaging systems

138
00:04:27,919 --> 00:04:29,520
in our wikis in our internal

139
00:04:29,520 --> 00:04:30,960
documentation

140
00:04:30,960 --> 00:04:32,320
it's probably been backed up into

141
00:04:32,320 --> 00:04:33,680
different systems

142
00:04:33,680 --> 00:04:35,440
and if it gets compiled it's probably

143
00:04:35,440 --> 00:04:36,800
inside our running applications maybe

144
00:04:36,800 --> 00:04:38,880
it's inside our docker images

145
00:04:38,880 --> 00:04:40,560
and the biggest thing

146
00:04:40,560 --> 00:04:42,560
before i kind of stop talking so much

147
00:04:42,560 --> 00:04:44,880
about this is that we have no idea where

148
00:04:44,880 --> 00:04:47,040
these secrets are they started off in a

149
00:04:47,040 --> 00:04:49,520
nice secrets management system we shared

150
00:04:49,520 --> 00:04:50,960
them with a developer do their job and

151
00:04:50,960 --> 00:04:52,800
now they're everywhere and our attack

152
00:04:52,800 --> 00:04:55,120
surface that attackers can target to try

153
00:04:55,120 --> 00:04:56,479
and find them is huge

154
00:04:56,479 --> 00:04:58,400
but we don't know how big it is because

155
00:04:58,400 --> 00:05:00,800
we have no visibility over where they

156
00:05:00,800 --> 00:05:02,080
are

157
00:05:02,080 --> 00:05:04,000
all right so this is what we call secret

158
00:05:04,000 --> 00:05:06,320
sprawl so i want to do just a quick demo

159
00:05:06,320 --> 00:05:10,360
that i'll get back to at the end

160
00:05:10,560 --> 00:05:13,120
live demos what can go wrong

161
00:05:13,120 --> 00:05:15,199
okay so here i have an aws key so

162
00:05:15,199 --> 00:05:16,479
everyone quick take a picture you can do

163
00:05:16,479 --> 00:05:18,800
some crypto mining

164
00:05:18,800 --> 00:05:20,560
um so this is a real

165
00:05:20,560 --> 00:05:23,039
it's not a real idea it's a canary token

166
00:05:23,039 --> 00:05:24,400
and i'm going to do something that we

167
00:05:24,400 --> 00:05:25,520
should never do

168
00:05:25,520 --> 00:05:28,880
and i'm going to push this into a public

169
00:05:28,880 --> 00:05:29,910
git repository

170
00:05:29,910 --> 00:05:33,099
[Music]

171
00:05:33,360 --> 00:05:34,800
and over here

172
00:05:34,800 --> 00:05:37,759
we have our canary token setup

173
00:05:37,759 --> 00:05:39,199
and this is going to let me know every

174
00:05:39,199 --> 00:05:41,520
time someone tries to access this aws

175
00:05:41,520 --> 00:05:43,680
credential so at the end of the talk i'm

176
00:05:43,680 --> 00:05:45,199
going to come back and we're going to

177
00:05:45,199 --> 00:05:47,199
see if in the time that i've finished

178
00:05:47,199 --> 00:05:49,520
talking someone's tried to access that

179
00:05:49,520 --> 00:05:51,759
aws credential and this is a free

180
00:05:51,759 --> 00:05:53,520
service canary tokens i think the

181
00:05:53,520 --> 00:05:56,160
response to two so you can

182
00:05:56,160 --> 00:05:57,360
recreate this experiment you don't need

183
00:05:57,360 --> 00:05:59,759
to trust me

184
00:05:59,759 --> 00:06:01,919
all right back to the presentation so

185
00:06:01,919 --> 00:06:04,319
let's talk about some cases where

186
00:06:04,319 --> 00:06:06,080
attackers have actually used secrets

187
00:06:06,080 --> 00:06:07,600
that have been leaked and how they've

188
00:06:07,600 --> 00:06:10,000
used them so uber has two cases public

189
00:06:10,000 --> 00:06:12,479
and private so the public incident

190
00:06:12,479 --> 00:06:15,840
this happened when an employee of uber

191
00:06:15,840 --> 00:06:18,080
pushed code to the wrong repository they

192
00:06:18,080 --> 00:06:20,960
pushed code to their personal public get

193
00:06:20,960 --> 00:06:23,039
repository so what's important is that

194
00:06:23,039 --> 00:06:25,280
this is outside of uber's control uber

195
00:06:25,280 --> 00:06:27,919
has no idea that this has happened

196
00:06:27,919 --> 00:06:30,080
attackers were monitoring the employees

197
00:06:30,080 --> 00:06:31,840
of uber because this actually happens

198
00:06:31,840 --> 00:06:33,280
quite frequently

199
00:06:33,280 --> 00:06:35,360
and they found the s and amazon s3

200
00:06:35,360 --> 00:06:37,120
bucket they were able to access that get

201
00:06:37,120 --> 00:06:38,560
sensitive data

202
00:06:38,560 --> 00:06:40,160
and move forward the second case

203
00:06:40,160 --> 00:06:42,479
happened on a private repository

204
00:06:42,479 --> 00:06:44,720
so i hear a lot that oh we don't need to

205
00:06:44,720 --> 00:06:46,319
worry too much about secrets all our git

206
00:06:46,319 --> 00:06:48,000
repositories are private we don't do any

207
00:06:48,000 --> 00:06:50,720
open source well here there was secrets

208
00:06:50,720 --> 00:06:53,120
inside uber's private code repository

209
00:06:53,120 --> 00:06:55,039
but because of poor password hygiene by

210
00:06:55,039 --> 00:06:56,960
some of the developers attackers were

211
00:06:56,960 --> 00:06:59,680
able to access that

212
00:06:59,680 --> 00:07:00,960
and again

213
00:07:00,960 --> 00:07:03,280
amazon s3 bucket

214
00:07:03,280 --> 00:07:04,560
was there

215
00:07:04,560 --> 00:07:06,000
and

216
00:07:06,000 --> 00:07:07,360
they were able to access sensitive

217
00:07:07,360 --> 00:07:09,120
information again

218
00:07:09,120 --> 00:07:09,840
so

219
00:07:09,840 --> 00:07:11,759
the next one

220
00:07:11,759 --> 00:07:13,360
which is a little bit more complicated

221
00:07:13,360 --> 00:07:15,039
but definitely one of my favorite

222
00:07:15,039 --> 00:07:17,440
examples is that of code cov

223
00:07:17,440 --> 00:07:19,280
so last year

224
00:07:19,280 --> 00:07:21,520
codecov had a pretty significant supply

225
00:07:21,520 --> 00:07:22,400
chain

226
00:07:22,400 --> 00:07:24,319
attack so if you don't know what code

227
00:07:24,319 --> 00:07:27,280
cov is so code cov is a code coverage

228
00:07:27,280 --> 00:07:28,160
tool

229
00:07:28,160 --> 00:07:31,120
so it sits in your ci cd pipeline and it

230
00:07:31,120 --> 00:07:33,039
basically checks to see gives you a

231
00:07:33,039 --> 00:07:34,560
report of how much of your application

232
00:07:34,560 --> 00:07:37,120
is being tested it's a really cool tool

233
00:07:37,120 --> 00:07:39,280
it does a very specific job and at the

234
00:07:39,280 --> 00:07:42,080
time of the breach they had about 20 000

235
00:07:42,080 --> 00:07:43,759
customers including some big ones which

236
00:07:43,759 --> 00:07:45,280
i'll come back to

237
00:07:45,280 --> 00:07:47,440
so what happened

238
00:07:47,440 --> 00:07:50,080
so on the official code docker image

239
00:07:50,080 --> 00:07:51,120
there was

240
00:07:51,120 --> 00:07:54,000
uh a plain text secret which provided

241
00:07:54,000 --> 00:07:57,759
access to their source code

242
00:07:57,759 --> 00:07:59,120
so the attackers were able to download

243
00:07:59,120 --> 00:08:00,560
this docker image

244
00:08:00,560 --> 00:08:02,319
extract the secret

245
00:08:02,319 --> 00:08:04,400
and then they had access to codecov

246
00:08:04,400 --> 00:08:07,440
source code and in a bash uploader

247
00:08:07,440 --> 00:08:10,240
script so just a pretty ugly ugly file

248
00:08:10,240 --> 00:08:11,599
that

249
00:08:11,599 --> 00:08:13,759
just follows out a set of instructions

250
00:08:13,759 --> 00:08:16,160
they injected one line of malicious code

251
00:08:16,160 --> 00:08:16,960
which

252
00:08:16,960 --> 00:08:18,720
easily would have been ignored and that

253
00:08:18,720 --> 00:08:20,560
malicious code did one thing it said

254
00:08:20,560 --> 00:08:22,879
every time one of the twenty thousand

255
00:08:22,879 --> 00:08:25,360
customers run code cov

256
00:08:25,360 --> 00:08:27,919
to take all the environment variables

257
00:08:27,919 --> 00:08:30,000
so these are all the secrets that that

258
00:08:30,000 --> 00:08:32,559
application is using to test itself

259
00:08:32,559 --> 00:08:34,159
so it's going to need some access to

260
00:08:34,159 --> 00:08:35,679
databases it's going to need access to

261
00:08:35,679 --> 00:08:37,519
services and we're going to take all

262
00:08:37,519 --> 00:08:38,719
those environment variables and we're

263
00:08:38,719 --> 00:08:40,399
going to send them to the attacker

264
00:08:40,399 --> 00:08:42,159
so every time someone ran code cov the

265
00:08:42,159 --> 00:08:43,360
attacker got all the environment

266
00:08:43,360 --> 00:08:45,920
variables now hopefully

267
00:08:45,920 --> 00:08:47,680
you're using different credentials

268
00:08:47,680 --> 00:08:50,080
different secrets to test applications

269
00:08:50,080 --> 00:08:52,839
than you are in production

270
00:08:52,839 --> 00:08:55,279
hopefully but

271
00:08:55,279 --> 00:08:57,360
some credentials you use

272
00:08:57,360 --> 00:08:59,279
constantly and one of them is your git

273
00:08:59,279 --> 00:09:01,839
credentials so codecov had access to the

274
00:09:01,839 --> 00:09:03,839
git the github tokens if it's running in

275
00:09:03,839 --> 00:09:05,839
github or the git credentials that gives

276
00:09:05,839 --> 00:09:07,120
access to

277
00:09:07,120 --> 00:09:09,519
those repositories so then the attackers

278
00:09:09,519 --> 00:09:11,760
were able to move from code cove

279
00:09:11,760 --> 00:09:14,080
into the private code repositories

280
00:09:14,080 --> 00:09:17,040
of the victims so those victims were

281
00:09:17,040 --> 00:09:21,519
hashicorp twilio monday.com rapid7

282
00:09:21,519 --> 00:09:23,279
these attackers were able to access the

283
00:09:23,279 --> 00:09:25,519
private source code of all of those

284
00:09:25,519 --> 00:09:27,839
companies and here's what's crazy is

285
00:09:27,839 --> 00:09:30,720
that all of those companies i just named

286
00:09:30,720 --> 00:09:32,880
that have great security posture are

287
00:09:32,880 --> 00:09:34,720
fantastic companies

288
00:09:34,720 --> 00:09:36,480
all had secrets in their private code

289
00:09:36,480 --> 00:09:39,279
repositories now if hashicorp

290
00:09:39,279 --> 00:09:41,600
the company that created the term secret

291
00:09:41,600 --> 00:09:42,560
sprawl

292
00:09:42,560 --> 00:09:44,240
that builds one of the best secrets

293
00:09:44,240 --> 00:09:45,839
managers out there

294
00:09:45,839 --> 00:09:47,920
has secrets inside their code

295
00:09:47,920 --> 00:09:49,279
repositories

296
00:09:49,279 --> 00:09:50,480
because they did

297
00:09:50,480 --> 00:09:52,880
then i'm willing to bet anything

298
00:09:52,880 --> 00:09:54,560
that you all have secrets and we all

299
00:09:54,560 --> 00:09:56,560
have secrets uh in their code

300
00:09:56,560 --> 00:09:58,880
repositories and we all make mistakes

301
00:09:58,880 --> 00:10:00,720
right it happens i was making a video

302
00:10:00,720 --> 00:10:02,160
about what happens when you leak

303
00:10:02,160 --> 00:10:04,000
credentials and accidentally leaked a

304
00:10:04,000 --> 00:10:05,360
real credential

305
00:10:05,360 --> 00:10:06,880
whilst making the video it happens to

306
00:10:06,880 --> 00:10:09,279
all of us

307
00:10:09,279 --> 00:10:10,880
so this is this is a great example

308
00:10:10,880 --> 00:10:12,800
because we've moved from docker into the

309
00:10:12,800 --> 00:10:14,399
version control system and then we've

310
00:10:14,399 --> 00:10:17,519
leaped frog into other companies

311
00:10:17,519 --> 00:10:20,480
so the other one to talk about is that

312
00:10:20,480 --> 00:10:22,560
source code uh

313
00:10:22,560 --> 00:10:24,240
doesn't private source code doesn't

314
00:10:24,240 --> 00:10:26,320
always stay that private right

315
00:10:26,320 --> 00:10:28,720
the mechanisms that we use to inversion

316
00:10:28,720 --> 00:10:30,560
control systems allow it to be widely

317
00:10:30,560 --> 00:10:33,040
distributed i'm never advocating against

318
00:10:33,040 --> 00:10:34,399
that because we need that to be able to

319
00:10:34,399 --> 00:10:37,200
work efficiently but it does mean that

320
00:10:37,200 --> 00:10:39,040
it's not very secure and it's a leaky

321
00:10:39,040 --> 00:10:40,240
asset

322
00:10:40,240 --> 00:10:41,600
and we've seen a particularly large

323
00:10:41,600 --> 00:10:44,160
trend of let's say companies

324
00:10:44,160 --> 00:10:46,399
involuntarily open sourcing their source

325
00:10:46,399 --> 00:10:47,680
code

326
00:10:47,680 --> 00:10:50,079
so we've seen that uh recently with a

327
00:10:50,079 --> 00:10:52,800
few so one of them is twitch so last

328
00:10:52,800 --> 00:10:55,360
year i think in october twitch's source

329
00:10:55,360 --> 00:10:57,279
code was leaked online

330
00:10:57,279 --> 00:10:58,640
how this happened was there was a

331
00:10:58,640 --> 00:11:01,360
misconfiguration in their servers

332
00:11:01,360 --> 00:11:02,800
that allowed remote access to the git

333
00:11:02,800 --> 00:11:04,880
repositories it wasn't there for very

334
00:11:04,880 --> 00:11:06,959
long but in that brief window someone

335
00:11:06,959 --> 00:11:09,920
found it took all of their repositories

336
00:11:09,920 --> 00:11:12,320
about 250 gigabytes of data 6 000

337
00:11:12,320 --> 00:11:14,160
repositories i think and then they

338
00:11:14,160 --> 00:11:16,240
published them online involuntarily open

339
00:11:16,240 --> 00:11:17,519
sourced them

340
00:11:17,519 --> 00:11:20,160
we scanned all those repositories and we

341
00:11:20,160 --> 00:11:22,160
found thousands of secrets in there now

342
00:11:22,160 --> 00:11:23,760
the headlines following on from that was

343
00:11:23,760 --> 00:11:25,600
all about how the twitch their twitch

344
00:11:25,600 --> 00:11:28,640
stream is income was leaked but we found

345
00:11:28,640 --> 00:11:31,360
194 aws keys that no one was talking

346
00:11:31,360 --> 00:11:34,160
about we also found 69 twilio keys and

347
00:11:34,160 --> 00:11:36,880
68 google keys now

348
00:11:36,880 --> 00:11:40,160
this actually it seems huge 6600 secrets

349
00:11:40,160 --> 00:11:41,519
bold letters

350
00:11:41,519 --> 00:11:43,360
and i made some click-baity titles and

351
00:11:43,360 --> 00:11:45,120
articles about that too but the reality

352
00:11:45,120 --> 00:11:47,200
is that that's not that unusual

353
00:11:47,200 --> 00:11:49,519
that's about what we would expect

354
00:11:49,519 --> 00:11:50,480
actually it's probably a little bit

355
00:11:50,480 --> 00:11:52,480
better than what we'd expect

356
00:11:52,480 --> 00:11:54,560
and in my opinion the adversaries in

357
00:11:54,560 --> 00:11:57,839
this case did a twitch a huge favor by

358
00:11:57,839 --> 00:12:00,079
publishing it online because twitch then

359
00:12:00,079 --> 00:12:01,760
knew they had a problem they could

360
00:12:01,760 --> 00:12:04,399
rotate all those secrets quickly

361
00:12:04,399 --> 00:12:06,880
and mitigate that risk which is why i

362
00:12:06,880 --> 00:12:08,639
don't think we saw any massive

363
00:12:08,639 --> 00:12:11,440
high-profile uh breaches following on

364
00:12:11,440 --> 00:12:13,200
from that had the adversary not

365
00:12:13,200 --> 00:12:15,200
published it online had the adversaries

366
00:12:15,200 --> 00:12:16,880
instead looked for secrets themselves

367
00:12:16,880 --> 00:12:19,440
and sold them then that could have been

368
00:12:19,440 --> 00:12:21,680
a very different story

369
00:12:21,680 --> 00:12:24,240
now the other one to talk about is

370
00:12:24,240 --> 00:12:26,240
samsung and video and microsoft so these

371
00:12:26,240 --> 00:12:27,279
were all

372
00:12:27,279 --> 00:12:29,279
breached for their and their source code

373
00:12:29,279 --> 00:12:31,120
published this year

374
00:12:31,120 --> 00:12:33,120
with the lapsis group

375
00:12:33,120 --> 00:12:36,000
so lapses we later found out was

376
00:12:36,000 --> 00:12:37,920
a band of teenagers and they were

377
00:12:37,920 --> 00:12:40,480
ransoming and threatening to release

378
00:12:40,480 --> 00:12:42,320
private source code if

379
00:12:42,320 --> 00:12:43,120
uh

380
00:12:43,120 --> 00:12:44,959
if they didn't pay the ransom now we

381
00:12:44,959 --> 00:12:46,480
scanned these again for secrets and we

382
00:12:46,480 --> 00:12:48,000
did find thousands

383
00:12:48,000 --> 00:12:50,160
of secrets because they had significant

384
00:12:50,160 --> 00:12:51,519
warning a lot of them were revoked some

385
00:12:51,519 --> 00:12:53,360
of them weren't but some of them can't

386
00:12:53,360 --> 00:12:55,600
be revoked like the nvidia

387
00:12:55,600 --> 00:12:56,880
signing keys

388
00:12:56,880 --> 00:12:59,120
that were inside their code repositories

389
00:12:59,120 --> 00:13:01,920
these were used to sign malware and we

390
00:13:01,920 --> 00:13:03,600
know that they came from the nvidia

391
00:13:03,600 --> 00:13:04,880
bridge

392
00:13:04,880 --> 00:13:06,160
so then you've got to ask how did a

393
00:13:06,160 --> 00:13:08,079
group of teenagers

394
00:13:08,079 --> 00:13:10,639
breach the private source code of these

395
00:13:10,639 --> 00:13:14,560
really high profile fantastic companies

396
00:13:14,560 --> 00:13:15,519
and

397
00:13:15,519 --> 00:13:17,200
well the answer is that they were

398
00:13:17,200 --> 00:13:20,160
recruiting insiders so here we have a

399
00:13:20,160 --> 00:13:22,000
message from the telegram channel it

400
00:13:22,000 --> 00:13:24,160
says we recruit insiders employees

401
00:13:24,160 --> 00:13:25,760
insiders at the following they list a

402
00:13:25,760 --> 00:13:27,200
bunch of companies

403
00:13:27,200 --> 00:13:29,680
so you think about everyone that you

404
00:13:29,680 --> 00:13:31,120
want to have access to your secrets

405
00:13:31,120 --> 00:13:32,399
right you've probably got a secrets

406
00:13:32,399 --> 00:13:35,120
management system it's probably tightly

407
00:13:35,120 --> 00:13:37,200
controlled and your secrets are highly

408
00:13:37,200 --> 00:13:38,320
encrypted

409
00:13:38,320 --> 00:13:40,160
and now think about your git repository

410
00:13:40,160 --> 00:13:41,680
so if those secrets are in your git

411
00:13:41,680 --> 00:13:43,279
repositories think about everyone that

412
00:13:43,279 --> 00:13:44,639
has access to them

413
00:13:44,639 --> 00:13:46,480
your interns your developers your

414
00:13:46,480 --> 00:13:47,760
engineers

415
00:13:47,760 --> 00:13:50,560
how many of them have had a bad day

416
00:13:50,560 --> 00:13:52,639
how many of them if given the chance to

417
00:13:52,639 --> 00:13:54,720
make a couple of grand

418
00:13:54,720 --> 00:13:56,079
just to give someone access to their

419
00:13:56,079 --> 00:13:57,279
repositories

420
00:13:57,279 --> 00:13:59,519
would do that and as we see

421
00:13:59,519 --> 00:14:01,040
quite a lot

422
00:14:01,040 --> 00:14:03,040
so private source code isn't always

423
00:14:03,040 --> 00:14:05,519
private so we need to have this posture

424
00:14:05,519 --> 00:14:07,040
when it comes to source code that yes we

425
00:14:07,040 --> 00:14:08,959
need to protect our open source stuff

426
00:14:08,959 --> 00:14:10,560
yes we need to make sure we're not

427
00:14:10,560 --> 00:14:12,959
leaking stuff publicly but it's not good

428
00:14:12,959 --> 00:14:14,720
enough we also need to make sure that

429
00:14:14,720 --> 00:14:17,040
our private source code

430
00:14:17,040 --> 00:14:19,920
are protected as well and that we don't

431
00:14:19,920 --> 00:14:23,599
have sensitive information in there

432
00:14:23,680 --> 00:14:24,560
so

433
00:14:24,560 --> 00:14:26,560
this brings me to the next part of the

434
00:14:26,560 --> 00:14:28,000
presentation here

435
00:14:28,000 --> 00:14:30,160
and so i want to talk about a report

436
00:14:30,160 --> 00:14:32,480
that get guardian does uh every year

437
00:14:32,480 --> 00:14:35,519
called the state of secret sprawl report

438
00:14:35,519 --> 00:14:39,760
so this is a report and we look at um

439
00:14:39,760 --> 00:14:40,959
the secrets that have been leaked

440
00:14:40,959 --> 00:14:44,480
publicly so in places like github.com or

441
00:14:44,480 --> 00:14:47,040
on on docker so docker hub and then we

442
00:14:47,040 --> 00:14:49,279
also look at the secrets uh that have

443
00:14:49,279 --> 00:14:51,120
been leaked privately

444
00:14:51,120 --> 00:14:52,959
so just to give you

445
00:14:52,959 --> 00:14:54,959
um an idea

446
00:14:54,959 --> 00:14:57,279
get uh get guardian scans every single

447
00:14:57,279 --> 00:14:59,600
public commit made to github so last

448
00:14:59,600 --> 00:15:01,199
year we scanned a billion commitments if

449
00:15:01,199 --> 00:15:03,760
you've pushed something to github.com

450
00:15:03,760 --> 00:15:05,680
then we would have scanned it now how do

451
00:15:05,680 --> 00:15:07,120
we do that well

452
00:15:07,120 --> 00:15:08,560
at the start of this presentation i

453
00:15:08,560 --> 00:15:12,160
pushed a aws key and five minutes after

454
00:15:12,160 --> 00:15:15,279
i pushed that key it was broadcast on

455
00:15:15,279 --> 00:15:17,920
github's apis anyone can monitor it

456
00:15:17,920 --> 00:15:19,440
there's a couple of events to look out

457
00:15:19,440 --> 00:15:21,279
for the push event

458
00:15:21,279 --> 00:15:22,880
and the public event publix when a

459
00:15:22,880 --> 00:15:24,880
private repository is made public pushes

460
00:15:24,880 --> 00:15:27,199
when code's pushed so anyone can monitor

461
00:15:27,199 --> 00:15:29,839
it get guardian can monitor it scan it

462
00:15:29,839 --> 00:15:31,600
and look for sensitive information but

463
00:15:31,600 --> 00:15:34,320
so can adversaries so we did that we

464
00:15:34,320 --> 00:15:36,959
found a lot of secrets

465
00:15:36,959 --> 00:15:38,639
a huge amount of secrets i'm about to

466
00:15:38,639 --> 00:15:40,560
show you a scary slide next

467
00:15:40,560 --> 00:15:43,680
and um and we publish this in a report

468
00:15:43,680 --> 00:15:46,880
so how many secrets so in 2021 we

469
00:15:46,880 --> 00:15:50,000
discovered six million credentials that

470
00:15:50,000 --> 00:15:52,639
were leaked on github.com

471
00:15:52,639 --> 00:15:54,240
that is a huge amount of secrets so this

472
00:15:54,240 --> 00:15:57,759
was about a 2x uh increase from from

473
00:15:57,759 --> 00:15:59,040
last year

474
00:15:59,040 --> 00:16:00,560
now if you looked at last year's report

475
00:16:00,560 --> 00:16:02,000
we said that we found 2 million

476
00:16:02,000 --> 00:16:03,600
credentials this year we're saying we

477
00:16:03,600 --> 00:16:05,519
found 6 million and if you're good at

478
00:16:05,519 --> 00:16:07,040
math you'll know that 2 plus 2 doesn't

479
00:16:07,040 --> 00:16:08,160
equal six

480
00:16:08,160 --> 00:16:10,160
but the reason why we do this is because

481
00:16:10,160 --> 00:16:12,160
the code that was pushed to github

482
00:16:12,160 --> 00:16:14,399
increased plus the amount of detection

483
00:16:14,399 --> 00:16:16,800
that we covered publicly also increased

484
00:16:16,800 --> 00:16:18,959
so in a fair comparison we think that

485
00:16:18,959 --> 00:16:20,320
probably twice as many credentials were

486
00:16:20,320 --> 00:16:22,000
published last year than this year which

487
00:16:22,000 --> 00:16:23,680
is crazy

488
00:16:23,680 --> 00:16:26,160
56 million users pushed to github so

489
00:16:26,160 --> 00:16:27,600
that's different than the

490
00:16:27,600 --> 00:16:29,519
github's official numbers that's because

491
00:16:29,519 --> 00:16:31,199
not all of their users pushed code last

492
00:16:31,199 --> 00:16:33,199
year but 56 million of them did so we're

493
00:16:33,199 --> 00:16:36,240
looking at it at huge numbers of huge

494
00:16:36,240 --> 00:16:38,079
numbers of information here

495
00:16:38,079 --> 00:16:38,959
and

496
00:16:38,959 --> 00:16:41,040
attackers know this as well so they're

497
00:16:41,040 --> 00:16:42,480
also monitoring this so what were the

498
00:16:42,480 --> 00:16:44,560
type of secrets that we found well we

499
00:16:44,560 --> 00:16:46,880
found some data storage keys

500
00:16:46,880 --> 00:16:49,040
there's about 21 the other category

501
00:16:49,040 --> 00:16:50,720
which is the largest is what we don't

502
00:16:50,720 --> 00:16:52,720
know they do so they might be private

503
00:16:52,720 --> 00:16:55,120
they might be uh private key security

504
00:16:55,120 --> 00:16:57,519
certificates we can't tell you what they

505
00:16:57,519 --> 00:17:00,000
do um

506
00:17:00,000 --> 00:17:01,920
15 of the keys were cloud providers you

507
00:17:01,920 --> 00:17:03,440
don't need to be very imaginative to

508
00:17:03,440 --> 00:17:05,439
know what to do with cloud provider key

509
00:17:05,439 --> 00:17:07,520
you can take some pretty cool open

510
00:17:07,520 --> 00:17:10,559
source tools like pacu and exploit these

511
00:17:10,559 --> 00:17:11,439
keys

512
00:17:11,439 --> 00:17:14,400
change privileges see what you can do

513
00:17:14,400 --> 00:17:15,919
some great tools out there

514
00:17:15,919 --> 00:17:17,520
messaging systems was eight and a half

515
00:17:17,520 --> 00:17:19,199
percent now messaging systems is one of

516
00:17:19,199 --> 00:17:20,799
my favorite because

517
00:17:20,799 --> 00:17:21,599
um

518
00:17:21,599 --> 00:17:23,919
they're everywhere people don't seem to

519
00:17:23,919 --> 00:17:25,679
control them too much they hand them out

520
00:17:25,679 --> 00:17:27,839
willy-nilly but what you can do with a

521
00:17:27,839 --> 00:17:29,919
messaging system key is if it's a slack

522
00:17:29,919 --> 00:17:32,000
key then you can use it to post internal

523
00:17:32,000 --> 00:17:34,000
phishing campaigns so if you get an

524
00:17:34,000 --> 00:17:36,000
internal message from slack to say hey

525
00:17:36,000 --> 00:17:37,760
change your password you're much

526
00:17:37,760 --> 00:17:40,240
likelier to trust that than a nigerian

527
00:17:40,240 --> 00:17:44,080
prince who's just emailed you

528
00:17:44,880 --> 00:17:46,640
all right so where else did we find c

529
00:17:46,640 --> 00:17:48,640
well we find secrets everywhere we found

530
00:17:48,640 --> 00:17:51,120
500 commit messages that had the github

531
00:17:51,120 --> 00:17:53,760
token in the commit message so if you

532
00:17:53,760 --> 00:17:55,679
don't understand that then that's like

533
00:17:55,679 --> 00:17:57,120
putting your password in the subject

534
00:17:57,120 --> 00:17:59,520
line of an email like but this is

535
00:17:59,520 --> 00:18:00,960
showing that people don't fully

536
00:18:00,960 --> 00:18:03,120
understand the technology

537
00:18:03,120 --> 00:18:05,039
and so this is a problem so you might

538
00:18:05,039 --> 00:18:07,600
have employees that may have lied about

539
00:18:07,600 --> 00:18:09,679
their get abilities on their resumes

540
00:18:09,679 --> 00:18:10,960
that are pushing

541
00:18:10,960 --> 00:18:12,240
that are pushing

542
00:18:12,240 --> 00:18:13,679
their tokens through messages because

543
00:18:13,679 --> 00:18:15,280
they're not understanding how that all

544
00:18:15,280 --> 00:18:16,559
works

545
00:18:16,559 --> 00:18:18,320
now there is some

546
00:18:18,320 --> 00:18:20,640
uh some benefits that we've seen for

547
00:18:20,640 --> 00:18:23,120
instance aws keys we've seen a decrease

548
00:18:23,120 --> 00:18:25,360
this is because aws is doing some great

549
00:18:25,360 --> 00:18:28,080
work for awareness and they're also

550
00:18:28,080 --> 00:18:30,320
looking for keys themselves on github

551
00:18:30,320 --> 00:18:31,919
and they're actually sometimes auto

552
00:18:31,919 --> 00:18:33,440
revoking those keys when they're found

553
00:18:33,440 --> 00:18:35,520
so we're seeing some good movements with

554
00:18:35,520 --> 00:18:37,919
aws this is great because it's showing

555
00:18:37,919 --> 00:18:39,919
that we can buck the trend still a lot

556
00:18:39,919 --> 00:18:42,240
of keys on there but we can buck the

557
00:18:42,240 --> 00:18:44,080
trend unfortunately this is pretty much

558
00:18:44,080 --> 00:18:47,200
where those trends for positive stop

559
00:18:47,200 --> 00:18:49,120
and also because we're getting really

560
00:18:49,120 --> 00:18:51,520
wide we're getting much more services so

561
00:18:51,520 --> 00:18:54,240
planet scale and super base are cloud

562
00:18:54,240 --> 00:18:57,360
cloud infrastructure startups um planet

563
00:18:57,360 --> 00:18:59,840
scale started around about mid last year

564
00:18:59,840 --> 00:19:00,640
um

565
00:19:00,640 --> 00:19:02,320
but we've already seen huge amounts of

566
00:19:02,320 --> 00:19:04,880
secrets of these uh being leaked so this

567
00:19:04,880 --> 00:19:06,720
means that our detection needs to be way

568
00:19:06,720 --> 00:19:11,280
ahead of the curve for uh prevention

569
00:19:11,280 --> 00:19:14,000
so docker images

570
00:19:14,000 --> 00:19:16,080
so this is docker hub

571
00:19:16,080 --> 00:19:17,760
is the largest

572
00:19:17,760 --> 00:19:20,160
place to store your docker images which

573
00:19:20,160 --> 00:19:21,760
is basically just a way to run an

574
00:19:21,760 --> 00:19:23,120
application

575
00:19:23,120 --> 00:19:25,679
we scanned ten thousand docker images we

576
00:19:25,679 --> 00:19:27,280
found that around about five percent of

577
00:19:27,280 --> 00:19:30,640
them 4.6 if you're being pedantic um had

578
00:19:30,640 --> 00:19:33,440
at least one secret inside them this is

579
00:19:33,440 --> 00:19:34,960
huge the secrets were a little bit

580
00:19:34,960 --> 00:19:36,960
different the much more internal

581
00:19:36,960 --> 00:19:38,160
structures we've got a lot of github

582
00:19:38,160 --> 00:19:40,720
tokens but five percent of docker images

583
00:19:40,720 --> 00:19:42,640
containing a secret is massive that

584
00:19:42,640 --> 00:19:45,600
means you only need to download like 20

585
00:19:45,600 --> 00:19:47,760
25 docker images to find something

586
00:19:47,760 --> 00:19:49,120
sensitive

587
00:19:49,120 --> 00:19:51,280
we scanned 10 000 we found 4 thousand

588
00:19:51,280 --> 00:19:53,360
secrets one point two thousand of them

589
00:19:53,360 --> 00:19:55,120
were unique

590
00:19:55,120 --> 00:19:58,160
so some some troubling concern there

591
00:19:58,160 --> 00:20:00,320
with with docker and people not

592
00:20:00,320 --> 00:20:02,559
understanding kind of how those those

593
00:20:02,559 --> 00:20:04,240
containers work and if you don't

594
00:20:04,240 --> 00:20:06,880
understand docky it's it's it can kind

595
00:20:06,880 --> 00:20:08,720
of be a little bit like git you have

596
00:20:08,720 --> 00:20:09,760
layers

597
00:20:09,760 --> 00:20:11,600
we see a lot of of instances where

598
00:20:11,600 --> 00:20:13,440
people are adding a secret into their

599
00:20:13,440 --> 00:20:14,400
docker

600
00:20:14,400 --> 00:20:16,240
image or adding it in their docker file

601
00:20:16,240 --> 00:20:19,200
then removing it later but because it's

602
00:20:19,200 --> 00:20:21,039
built up in layers those previous layers

603
00:20:21,039 --> 00:20:22,480
that you had your secret in it is

604
00:20:22,480 --> 00:20:24,240
actually still visible if you know what

605
00:20:24,240 --> 00:20:26,080
to look for

606
00:20:26,080 --> 00:20:27,440
now the other one is private

607
00:20:27,440 --> 00:20:28,720
repositories

608
00:20:28,720 --> 00:20:29,840
so

609
00:20:29,840 --> 00:20:31,360
this one's a little bit more tricky so

610
00:20:31,360 --> 00:20:32,240
we

611
00:20:32,240 --> 00:20:34,080
published the results that we have of

612
00:20:34,080 --> 00:20:35,679
get guardians internal customers so that

613
00:20:35,679 --> 00:20:38,080
our average customer enterprise customer

614
00:20:38,080 --> 00:20:39,919
has 400 developers

615
00:20:39,919 --> 00:20:42,640
so we took that as a staple and averaged

616
00:20:42,640 --> 00:20:44,240
our results

617
00:20:44,240 --> 00:20:47,520
so in a typical country company with 400

618
00:20:47,520 --> 00:20:48,480
developers

619
00:20:48,480 --> 00:20:51,280
we found around about 1 000

620
00:20:51,280 --> 00:20:52,720
unique secrets

621
00:20:52,720 --> 00:20:55,039
each occurring about 13 times so around

622
00:20:55,039 --> 00:20:58,400
about 13 000 secrets we would find in

623
00:20:58,400 --> 00:21:00,640
the private repositories of an average

624
00:21:00,640 --> 00:21:03,360
company with 400 developers

625
00:21:03,360 --> 00:21:05,840
now taking the industry standard

626
00:21:05,840 --> 00:21:07,520
of one appsec engineer per 100

627
00:21:07,520 --> 00:21:09,120
developers

628
00:21:09,120 --> 00:21:11,280
these companies would have four appsec

629
00:21:11,280 --> 00:21:14,159
engineers so if we divide the 13 000

630
00:21:14,159 --> 00:21:16,640
secrets thirteen thousand incidences of

631
00:21:16,640 --> 00:21:17,919
secrets

632
00:21:17,919 --> 00:21:20,320
amongst these four apsec engineers each

633
00:21:20,320 --> 00:21:23,200
of them would have to investigate

634
00:21:23,200 --> 00:21:25,039
communicate with the developers

635
00:21:25,039 --> 00:21:27,760
remediate revoke republish new

636
00:21:27,760 --> 00:21:31,120
credentials three 3 400 times in a year

637
00:21:31,120 --> 00:21:33,440
it's completely unachievable

638
00:21:33,440 --> 00:21:34,799
so you do the next best thing you just

639
00:21:34,799 --> 00:21:37,440
ignore the problem

640
00:21:37,679 --> 00:21:40,559
but if we did this 10 secrets a day for

641
00:21:40,559 --> 00:21:42,240
the whole year

642
00:21:42,240 --> 00:21:44,640
we didn't take holidays it would still

643
00:21:44,640 --> 00:21:46,400
take the entire year just to remediate

644
00:21:46,400 --> 00:21:48,159
that and i don't know about you but i

645
00:21:48,159 --> 00:21:49,600
don't know many epsec engineers that

646
00:21:49,600 --> 00:21:51,200
have heaps of free time and are looking

647
00:21:51,200 --> 00:21:52,880
for extra work to do

648
00:21:52,880 --> 00:21:55,760
so this is why we need to create tools

649
00:21:55,760 --> 00:21:57,600
create systems create awareness for it

650
00:21:57,600 --> 00:21:59,919
it's not good enough to identify the

651
00:21:59,919 --> 00:22:01,120
secrets we also have to stop the

652
00:22:01,120 --> 00:22:03,440
bleeding we need to empower developers i

653
00:22:03,440 --> 00:22:05,760
know we love to use the words shift left

654
00:22:05,760 --> 00:22:07,440
but it's totally true

655
00:22:07,440 --> 00:22:08,799
developers do need to take some

656
00:22:08,799 --> 00:22:10,640
responsibility into this and how do we

657
00:22:10,640 --> 00:22:12,960
do that well we provide them the tools

658
00:22:12,960 --> 00:22:14,720
that they can do to to do it for

659
00:22:14,720 --> 00:22:18,559
instance get uh get hooks so it prevents

660
00:22:18,559 --> 00:22:21,440
you from leaking secrets

661
00:22:21,440 --> 00:22:24,000
so why does this happen well it happens

662
00:22:24,000 --> 00:22:26,080
for lots of reasons we accidentally make

663
00:22:26,080 --> 00:22:28,159
mistakes we're human right i think it

664
00:22:28,159 --> 00:22:29,520
was a keynote that said that because

665
00:22:29,520 --> 00:22:31,840
we're human uh we have great job

666
00:22:31,840 --> 00:22:34,960
security which i quite liked so

667
00:22:34,960 --> 00:22:36,159
we accidentally pushed stuff to the

668
00:22:36,159 --> 00:22:37,679
wrong repositories and it's important to

669
00:22:37,679 --> 00:22:39,039
know that we can do this on our personal

670
00:22:39,039 --> 00:22:41,520
accounts in github because github.com is

671
00:22:41,520 --> 00:22:43,280
unique because we have one account

672
00:22:43,280 --> 00:22:45,039
usually for professional and personal

673
00:22:45,039 --> 00:22:46,880
very easy to mix them up so we

674
00:22:46,880 --> 00:22:48,480
accidentally push secrets publicly or

675
00:22:48,480 --> 00:22:50,480
into the wrong places we have secrets

676
00:22:50,480 --> 00:22:51,919
buried in the history that we don't know

677
00:22:51,919 --> 00:22:54,080
about it's easy to imagine a developer

678
00:22:54,080 --> 00:22:56,320
working on some remote uh working on

679
00:22:56,320 --> 00:22:58,080
some dev branch who's quickly trying to

680
00:22:58,080 --> 00:22:59,600
get something to work hard codes a

681
00:22:59,600 --> 00:23:02,080
credential removes it later for the code

682
00:23:02,080 --> 00:23:03,840
review because he knows you're not meant

683
00:23:03,840 --> 00:23:06,159
to do it code reviewed passes because

684
00:23:06,159 --> 00:23:08,400
there's no credentials it gets pulled

685
00:23:08,400 --> 00:23:09,679
into the master branch and everyone

686
00:23:09,679 --> 00:23:11,520
forgets about it but if you scan the

687
00:23:11,520 --> 00:23:14,320
history and adversaries know to do this

688
00:23:14,320 --> 00:23:16,880
then that secret still exists in git so

689
00:23:16,880 --> 00:23:19,039
we forget about secrets we accidentally

690
00:23:19,039 --> 00:23:21,440
add some auto-generated file debug logs

691
00:23:21,440 --> 00:23:22,799
can contain secrets and environment

692
00:23:22,799 --> 00:23:24,480
variables so they can expose themselves

693
00:23:24,480 --> 00:23:26,000
here

694
00:23:26,000 --> 00:23:28,400
we have sensitive files like uh pem or

695
00:23:28,400 --> 00:23:30,720
env files that accidentally get captured

696
00:23:30,720 --> 00:23:32,640
and get repositories and then the last

697
00:23:32,640 --> 00:23:34,080
one is that

698
00:23:34,080 --> 00:23:35,919
we still have companies actively

699
00:23:35,919 --> 00:23:38,000
managing secrets in git just adding

700
00:23:38,000 --> 00:23:39,679
their environment variable files because

701
00:23:39,679 --> 00:23:41,279
it's easy we can distribute it to all

702
00:23:41,279 --> 00:23:43,360
the team everyone has access to it and

703
00:23:43,360 --> 00:23:46,400
we have excessive trust of our employees

704
00:23:46,400 --> 00:23:48,159
so you know that's

705
00:23:48,159 --> 00:23:50,880
it's it's a multi-faceted problem

706
00:23:50,880 --> 00:23:53,279
and we need lots of different solutions

707
00:23:53,279 --> 00:23:55,520
so

708
00:23:56,320 --> 00:24:01,120
now at the start i leaked an aws key

709
00:24:01,120 --> 00:24:03,440
this is how many times

710
00:24:03,440 --> 00:24:04,559
it has been

711
00:24:04,559 --> 00:24:05,600
pinged

712
00:24:05,600 --> 00:24:07,440
since my presentation

713
00:24:07,440 --> 00:24:09,600
from multiple now i do a lot of these ip

714
00:24:09,600 --> 00:24:11,279
addresses will be the same

715
00:24:11,279 --> 00:24:12,960
so we have some but let's let's try and

716
00:24:12,960 --> 00:24:15,279
find one here

717
00:24:15,279 --> 00:24:16,880
so this one's from the czech republic in

718
00:24:16,880 --> 00:24:18,960
prague

719
00:24:18,960 --> 00:24:20,400
so probably not someone that should be

720
00:24:20,400 --> 00:24:22,559
accessing this credential so this is

721
00:24:22,559 --> 00:24:24,320
just important to know you know people

722
00:24:24,320 --> 00:24:26,159
are actively monitoring this

723
00:24:26,159 --> 00:24:28,159
it is a known threat and you're getting

724
00:24:28,159 --> 00:24:30,080
good results now these aren't people i

725
00:24:30,080 --> 00:24:32,559
don't have a friend in prague refreshing

726
00:24:32,559 --> 00:24:35,600
on my repository guy come on

727
00:24:35,600 --> 00:24:37,520
this is just a bot

728
00:24:37,520 --> 00:24:38,720
that's trying to exploit it and if it

729
00:24:38,720 --> 00:24:40,559
finds something interesting we'll report

730
00:24:40,559 --> 00:24:41,360
back

731
00:24:41,360 --> 00:24:43,600
and then we can start an attack so

732
00:24:43,600 --> 00:24:46,720
it is a it is a massive massive problem

733
00:24:46,720 --> 00:24:50,080
and one that we're not getting on top of

734
00:24:50,080 --> 00:24:51,840
so how do we solve this well we need to

735
00:24:51,840 --> 00:24:53,440
do multiple different things we need to

736
00:24:53,440 --> 00:24:55,039
have better education we need to have

737
00:24:55,039 --> 00:24:57,440
tools um there are tools to scanning

738
00:24:57,440 --> 00:24:59,440
secrets i work for get guardian where

739
00:24:59,440 --> 00:25:00,960
secrets detection i won't tell you why

740
00:25:00,960 --> 00:25:02,880
we're the best because i'm biased

741
00:25:02,880 --> 00:25:04,720
but there are also other tools out there

742
00:25:04,720 --> 00:25:07,279
there's open source tools um if you want

743
00:25:07,279 --> 00:25:09,039
to use those

744
00:25:09,039 --> 00:25:10,640
so there's lots of different ways that

745
00:25:10,640 --> 00:25:11,840
we can do this

746
00:25:11,840 --> 00:25:14,000
git reposit we need to have git hooks we

747
00:25:14,000 --> 00:25:15,679
need to have better secrets management

748
00:25:15,679 --> 00:25:17,679
we need to have better education but we

749
00:25:17,679 --> 00:25:21,279
can get on on top of it

750
00:25:21,279 --> 00:25:22,080
nope

751
00:25:22,080 --> 00:25:24,000
wrong buttons

752
00:25:24,000 --> 00:25:24,960
so

753
00:25:24,960 --> 00:25:26,640
if you want to read the full report you

754
00:25:26,640 --> 00:25:29,520
can uh you can blindly trust this qr

755
00:25:29,520 --> 00:25:32,480
code i promise it won't do anything bad

756
00:25:32,480 --> 00:25:34,080
but also if you want to come see me i do

757
00:25:34,080 --> 00:25:35,919
have a one pager of the report that has

758
00:25:35,919 --> 00:25:37,520
some of the values that we have that i

759
00:25:37,520 --> 00:25:40,080
can give you and you can also from there

760
00:25:40,080 --> 00:25:42,559
go and check out the the the full report

761
00:25:42,559 --> 00:25:43,919
uh of the state of secret sprawl there's

762
00:25:43,919 --> 00:25:46,720
lots of great information um but yeah

763
00:25:46,720 --> 00:25:49,120
that's the end of my presentation so

764
00:25:49,120 --> 00:25:50,640
i'll invite anyone if they have any

765
00:25:50,640 --> 00:25:54,400
questions to to ask them now

766
00:25:54,880 --> 00:25:56,280
thank you

767
00:25:56,280 --> 00:25:59,549
[Applause]

