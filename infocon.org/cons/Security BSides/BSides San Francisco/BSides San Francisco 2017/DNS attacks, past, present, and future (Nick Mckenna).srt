1
00:00:03,629 --> 00:00:09,719
<font color="#E5E5E5">without further ado</font><font color="#CCCCCC"> Nick McKenna alright</font>

2
00:00:08,069 --> 00:00:11,970
<font color="#E5E5E5">thank you thank you for evidence</font>

3
00:00:09,719 --> 00:00:13,410
<font color="#CCCCCC">alright so i</font><font color="#E5E5E5"> said</font><font color="#CCCCCC"> i'm going to</font><font color="#E5E5E5"> be</font>

4
00:00:11,970 --> 00:00:17,099
talking about<font color="#E5E5E5"> DNS</font><font color="#CCCCCC"> attack</font>

5
00:00:13,410 --> 00:00:19,230
<font color="#E5E5E5">past present</font><font color="#CCCCCC"> and future who</font><font color="#E5E5E5"> am</font><font color="#CCCCCC"> i I'm</font>

6
00:00:17,099 --> 00:00:20,789
Nick McKenna<font color="#CCCCCC"> I</font><font color="#E5E5E5"> break</font><font color="#CCCCCC"> thing i'm a student</font>

7
00:00:19,230 --> 00:00:24,210
<font color="#CCCCCC">i'm</font><font color="#E5E5E5"> here to talk about some things that</font>

8
00:00:20,789 --> 00:00:26,730
broken<font color="#CCCCCC"> if you want to email me</font><font color="#E5E5E5"> you can</font>

9
00:00:24,210 --> 00:00:28,529
<font color="#E5E5E5">the</font><font color="#CCCCCC"> president I talking about a tool</font>

10
00:00:26,730 --> 00:00:31,649
that<font color="#CCCCCC"> I created it</font><font color="#E5E5E5"> will be on that github</font>

11
00:00:28,529 --> 00:00:33,329
<font color="#CCCCCC">will be a link at the end</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> rights</font>

12
00:00:31,649 --> 00:00:35,550
<font color="#CCCCCC">rogue DNS</font><font color="#E5E5E5"> and that's kind of where this</font>

13
00:00:33,329 --> 00:00:36,690
<font color="#CCCCCC">result start so Road penis</font>

14
00:00:35,550 --> 00:00:39,269
<font color="#CCCCCC">i'm sure many</font><font color="#E5E5E5"> of you know it but if you</font>

15
00:00:36,690 --> 00:00:41,610
<font color="#E5E5E5">don't it is where you intercept the next</font>

16
00:00:39,270 --> 00:00:44,190
request<font color="#CCCCCC"> and reply with malicious of</font>

17
00:00:41,610 --> 00:00:48,330
responses so you<font color="#E5E5E5"> try to go to</font><font color="#CCCCCC"> google it</font>

18
00:00:44,190 --> 00:00:50,940
<font color="#E5E5E5">responds with some other IP</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> why</font><font color="#CCCCCC"> is</font>

19
00:00:48,330 --> 00:00:53,849
awesome<font color="#CCCCCC"> music is awesome for an</font><font color="#E5E5E5"> attacker</font>

20
00:00:50,940 --> 00:00:56,099
<font color="#E5E5E5">primarily</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> it's very quiet and uh</font>

21
00:00:53,850 --> 00:00:58,140
<font color="#E5E5E5">the main reason why</font><font color="#CCCCCC"> is the best type of</font>

22
00:00:56,100 --> 00:01:01,320
interception attack is because<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> low</font>

23
00:00:58,140 --> 00:01:03,060
<font color="#E5E5E5">data so where</font><font color="#CCCCCC"> is with most</font><font color="#E5E5E5"> of those</font>

24
00:01:01,320 --> 00:01:05,729
texts data interception<font color="#CCCCCC"> you'd have to</font>

25
00:01:03,060 --> 00:01:09,509
handle all of the data which would if

26
00:01:05,729 --> 00:01:10,829
you have lots of<font color="#CCCCCC"> let's find Toby</font><font color="#E5E5E5"> you</font>

27
00:01:09,509 --> 00:01:12,899
<font color="#E5E5E5">mean lots of infrastructure</font><font color="#CCCCCC"> left the</font>

28
00:01:10,829 --> 00:01:14,579
<font color="#CCCCCC">band with</font><font color="#E5E5E5"> the nice thing about</font><font color="#CCCCCC"> dns is</font>

29
00:01:12,899 --> 00:01:17,460
<font color="#E5E5E5">its low bandwidth you just have to</font>

30
00:01:14,579 --> 00:01:19,798
intercept a couple<font color="#E5E5E5"> bites and send back a</font>

31
00:01:17,460 --> 00:01:21,270
couple bites<font color="#E5E5E5"> it's very easy</font><font color="#CCCCCC"> the</font>

32
00:01:19,799 --> 00:01:23,549
alternatives are very loud very

33
00:01:21,270 --> 00:01:25,590
<font color="#E5E5E5">data-intensive</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> witness is pretty</font>

34
00:01:23,549 --> 00:01:28,079
great<font color="#CCCCCC"> and that's that's what kind of</font>

35
00:01:25,590 --> 00:01:31,259
caught my eye<font color="#E5E5E5"> the past in the present</font>

36
00:01:28,079 --> 00:01:36,298
<font color="#CCCCCC">i'm going to be talking about 22 botnets</font>

37
00:01:31,259 --> 00:01:40,889
that did<font color="#CCCCCC"> dns Rogan attacks so the first</font>

38
00:01:36,299 --> 00:01:41,939
<font color="#E5E5E5">one dns changer infected</font><font color="#CCCCCC"> i believe</font><font color="#E5E5E5"> four</font>

39
00:01:40,889 --> 00:01:44,310
million people

40
00:01:41,939 --> 00:01:46,318
<font color="#E5E5E5">it did this by diffusing like registry</font>

41
00:01:44,310 --> 00:01:50,039
calls to change the dns server of a

42
00:01:46,319 --> 00:01:52,049
client<font color="#E5E5E5"> so kind of rather low tech not</font>

43
00:01:50,039 --> 00:01:55,319
very interesting<font color="#CCCCCC"> what they did to</font>

44
00:01:52,049 --> 00:01:57,659
monetize it<font color="#CCCCCC"> was replaced as</font><font color="#E5E5E5"> so you would</font>

45
00:01:55,319 --> 00:02:00,329
<font color="#E5E5E5">typically ran their own ad network that</font>

46
00:01:57,659 --> 00:02:04,439
worked by intercepting other<font color="#E5E5E5"> ad</font><font color="#CCCCCC"> networks</font>

47
00:02:00,329 --> 00:02:05,699
<font color="#CCCCCC">book in soho and</font><font color="#E5E5E5"> this is this is what</font>

48
00:02:04,439 --> 00:02:07,708
really got me interested in this and

49
00:02:05,700 --> 00:02:09,598
what I find the most interesting<font color="#CCCCCC"> so how</font>

50
00:02:07,709 --> 00:02:11,550
it would work is it would send<font color="#CCCCCC"> is it</font>

51
00:02:09,598 --> 00:02:14,339
would<font color="#CCCCCC"> duty srs against your router so it</font>

52
00:02:11,550 --> 00:02:16,170
would just try 1000 that one and

53
00:02:14,340 --> 00:02:17,010
evanescent we just tried lots and lots

54
00:02:16,170 --> 00:02:19,708
of default password

55
00:02:17,010 --> 00:02:21,959
<font color="#CCCCCC">and it was a little bit more delicious</font>

56
00:02:19,709 --> 00:02:26,909
instead of doing as it would do fishing

57
00:02:21,959 --> 00:02:29,010
on bank accounts<font color="#E5E5E5"> bank pages</font><font color="#CCCCCC"> it's spread</font>

58
00:02:26,909 --> 00:02:30,720
via<font color="#CCCCCC"> mall vertising so you have a piece</font>

59
00:02:29,010 --> 00:02:33,209
of JavaScript<font color="#E5E5E5"> that just sends lots of</font>

60
00:02:30,720 --> 00:02:34,829
<font color="#E5E5E5">iframes</font><font color="#CCCCCC"> heard of this is lots of</font>

61
00:02:33,209 --> 00:02:36,360
requests and it<font color="#E5E5E5"> would also sometimes</font>

62
00:02:34,829 --> 00:02:40,620
have<font color="#E5E5E5"> iframes pretend to be</font><font color="#CCCCCC"> google</font>

63
00:02:36,360 --> 00:02:46,409
<font color="#CCCCCC">analytics so this</font><font color="#E5E5E5"> is how it basically</font>

64
00:02:40,620 --> 00:02:49,140
<font color="#E5E5E5">works</font><font color="#CCCCCC"> so it spreads via csrs</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> as just</font>

65
00:02:46,409 --> 00:02:51,810
lots and lots of<font color="#CCCCCC"> iframes and as</font><font color="#E5E5E5"> or just</font>

66
00:02:49,140 --> 00:02:54,869
<font color="#CCCCCC">a jumped-up</font><font color="#E5E5E5"> loops so try</font><font color="#CCCCCC"> people</font>

67
00:02:51,810 --> 00:02:59,220
<font color="#E5E5E5">passwords and</font><font color="#CCCCCC"> I piece it would then</font>

68
00:02:54,870 --> 00:03:02,220
become<font color="#E5E5E5"> become your</font><font color="#CCCCCC"> dns server via DHCP</font>

69
00:02:59,220 --> 00:03:04,440
so your router<font color="#CCCCCC"> it's your</font><font color="#E5E5E5"> router</font><font color="#CCCCCC"> dns</font>

70
00:03:02,220 --> 00:03:07,889
<font color="#CCCCCC">server</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> by dhcp it will become your</font>

71
00:03:04,440 --> 00:03:11,519
<font color="#CCCCCC">dns server will</font><font color="#E5E5E5"> redirect</font><font color="#CCCCCC"> and then of</font>

72
00:03:07,889 --> 00:03:13,200
course<font color="#E5E5E5"> step</font><font color="#CCCCCC"> 5</font><font color="#E5E5E5"> profit so you might not be</font>

73
00:03:11,519 --> 00:03:15,450
able to<font color="#CCCCCC"> use very</font><font color="#E5E5E5"> well but it pretends to</font>

74
00:03:13,200 --> 00:03:19,200
be<font color="#CCCCCC"> google analytics that's a lot of</font>

75
00:03:15,450 --> 00:03:21,388
<font color="#CCCCCC">iframes and it would also set a</font>

76
00:03:19,200 --> 00:03:24,060
secondary<font color="#CCCCCC"> dns server so that their I</font>

77
00:03:21,389 --> 00:03:28,199
guess they're not being that mean this

78
00:03:24,060 --> 00:03:30,000
is the<font color="#CCCCCC"> java version that is it</font><font color="#E5E5E5"> would</font>

79
00:03:28,199 --> 00:03:36,329
just try a bunch of different<font color="#CCCCCC"> requests</font>

80
00:03:30,000 --> 00:03:38,970
<font color="#CCCCCC">ok so the process is</font><font color="#E5E5E5"> the former hacking</font>

81
00:03:36,329 --> 00:03:40,260
<font color="#CCCCCC">so this</font><font color="#E5E5E5"> is kind of get into the future</font>

82
00:03:38,970 --> 00:03:42,959
but also some stuff that we've seen

83
00:03:40,260 --> 00:03:44,970
before so in<font color="#CCCCCC"> attacks</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> really it's</font>

84
00:03:42,959 --> 00:03:48,449
<font color="#CCCCCC">kind of exploiting either</font>

85
00:03:44,970 --> 00:03:51,269
vulnerabilities in the firmware or just

86
00:03:48,449 --> 00:03:52,829
bad password so<font color="#CCCCCC"> i</font><font color="#E5E5E5"> have to typically work</font>

87
00:03:51,269 --> 00:03:54,449
<font color="#E5E5E5">you'd be compiled the firmware you</font><font color="#CCCCCC"> would</font>

88
00:03:52,829 --> 00:03:56,099
look for vulnerabilities and they were

89
00:03:54,449 --> 00:04:02,519
an exploit<font color="#CCCCCC"> you would find a way to</font>

90
00:03:56,099 --> 00:04:03,839
<font color="#E5E5E5">fingerprint this and then</font><font color="#CCCCCC"> scan so yeah</font>

91
00:04:02,519 --> 00:04:06,300
so

92
00:04:03,840 --> 00:04:09,569
<font color="#CCCCCC">here for</font><font color="#E5E5E5"> propagating</font><font color="#CCCCCC"> by 2 and this is</font>

93
00:04:06,300 --> 00:04:11,760
involved<font color="#CCCCCC"> back</font><font color="#E5E5E5"> during firmer and I've</font>

94
00:04:09,569 --> 00:04:14,160
seen this<font color="#CCCCCC"> attacks in the wild</font><font color="#E5E5E5"> early</font><font color="#CCCCCC"> sort</font>

95
00:04:11,760 --> 00:04:15,660
<font color="#CCCCCC">of it but not very frequently but i</font>

96
00:04:14,160 --> 00:04:17,668
think that it will over time become much

97
00:04:15,660 --> 00:04:21,149
more popular so it's where people use

98
00:04:17,668 --> 00:04:24,299
either<font color="#E5E5E5"> authentication bypass exploits or</font>

99
00:04:21,149 --> 00:04:26,760
other<font color="#E5E5E5"> exploits to get into routers web</font>

100
00:04:24,300 --> 00:04:28,440
<font color="#E5E5E5">interface and then use that</font><font color="#CCCCCC"> to flash the</font>

101
00:04:26,760 --> 00:04:34,860
firmware<font color="#E5E5E5"> and from there you can put</font>

102
00:04:28,440 --> 00:04:35,790
whatever you want in the<font color="#CCCCCC"> firm so what do</font>

103
00:04:34,860 --> 00:04:37,979
you do after that

104
00:04:35,790 --> 00:04:40,560
what is an attacker to do after they

105
00:04:37,979 --> 00:04:42,690
become a<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of unit provider</font><font color="#E5E5E5"> and this</font>

106
00:04:40,560 --> 00:04:44,940
is kind of where<font color="#E5E5E5"> where it started</font>

107
00:04:42,690 --> 00:04:45,960
getting kind of creative and think about

108
00:04:44,940 --> 00:04:50,070
<font color="#E5E5E5">cool thing to do</font>

109
00:04:45,960 --> 00:04:51,780
so<font color="#E5E5E5"> the first</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> backtrack so when</font>

110
00:04:50,070 --> 00:04:53,820
you think about security and what it

111
00:04:51,780 --> 00:04:55,710
means to look at security you're really

112
00:04:53,820 --> 00:04:57,240
looking at<font color="#CCCCCC"> largely the difference</font>

113
00:04:55,710 --> 00:05:00,539
between how you want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> technology to</font>

114
00:04:57,240 --> 00:05:02,430
work and how it actually works<font color="#E5E5E5"> and for</font>

115
00:05:00,539 --> 00:05:04,320
people like this man the middle<font color="#CCCCCC"> attacks</font>

116
00:05:02,430 --> 00:05:05,550
<font color="#CCCCCC">as soon as I've been</font><font color="#E5E5E5"> very leaf very hard</font>

117
00:05:04,320 --> 00:05:08,520
to do and have been done<font color="#E5E5E5"> by</font><font color="#CCCCCC"> a</font>

118
00:05:05,550 --> 00:05:12,780
<font color="#CCCCCC">nation-state but that's not really true</font>

119
00:05:08,520 --> 00:05:14,250
<font color="#CCCCCC">um and dick</font><font color="#E5E5E5"> in looking at how lots of</font>

120
00:05:12,780 --> 00:05:16,138
different sites and applications are

121
00:05:14,250 --> 00:05:17,910
built found<font color="#E5E5E5"> that most people aren't</font>

122
00:05:16,139 --> 00:05:20,310
really thinking of<font color="#CCCCCC"> man the</font><font color="#E5E5E5"> middle text</font>

123
00:05:17,910 --> 00:05:23,550
is something that is done<font color="#E5E5E5"> commonly or</font>

124
00:05:20,310 --> 00:05:25,500
something<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> people so for that</font>

125
00:05:23,550 --> 00:05:27,330
reason<font color="#CCCCCC"> I</font><font color="#E5E5E5"> build something called the</font><font color="#CCCCCC"> nsl</font>

126
00:05:25,500 --> 00:05:32,520
<font color="#CCCCCC">strip</font><font color="#E5E5E5"> and what is</font><font color="#CCCCCC"> its a simple</font>

127
00:05:27,330 --> 00:05:35,280
implementation of<font color="#CCCCCC"> SL strip</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> dns so</font>

128
00:05:32,520 --> 00:05:38,700
it's two parts<font color="#E5E5E5"> the</font><font color="#CCCCCC"> dns server and then</font>

129
00:05:35,280 --> 00:05:40,679
it's a web server so<font color="#CCCCCC"> ans server is dns</font>

130
00:05:38,700 --> 00:05:45,539
<font color="#CCCCCC">Massachusetts very easy to</font><font color="#E5E5E5"> setup is very</font>

131
00:05:40,680 --> 00:05:47,490
easy to add<font color="#CCCCCC"> manual exceptions so it's</font>

132
00:05:45,539 --> 00:05:50,550
very quick very<font color="#E5E5E5"> easy to himself</font><font color="#CCCCCC"> if i use</font>

133
00:05:47,490 --> 00:05:54,320
the<font color="#E5E5E5"> web server</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> wrote</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> flash the</font>

134
00:05:50,550 --> 00:05:54,320
main reason because it's not PHP

135
00:05:54,860 --> 00:06:00,740
<font color="#E5E5E5">and it's good for doing</font><font color="#CCCCCC"> low level stuff</font>

136
00:05:57,469 --> 00:06:02,389
<font color="#E5E5E5">and you can have a function that is just</font>

137
00:06:00,740 --> 00:06:07,189
when we<font color="#CCCCCC"> receive</font><font color="#E5E5E5"> this page we do this</font>

138
00:06:02,389 --> 00:06:13,310
with it<font color="#E5E5E5"> so so how it works</font><font color="#CCCCCC"> okay with</font>

139
00:06:07,189 --> 00:06:17,000
them on a minute<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> believe that</font><font color="#CCCCCC"> it's</font>

140
00:06:13,310 --> 00:06:21,439
<font color="#CCCCCC">okay so show</font><font color="#E5E5E5"> them on a second but what</font>

141
00:06:17,000 --> 00:06:24,379
it does is it takes it takes the<font color="#E5E5E5"> headers</font>

142
00:06:21,439 --> 00:06:26,509
<font color="#E5E5E5">so it takes the</font><font color="#CCCCCC"> Youth Center question</font>

143
00:06:24,379 --> 00:06:28,909
the<font color="#E5E5E5"> dns server it will respond with the</font>

144
00:06:26,509 --> 00:06:31,219
<font color="#E5E5E5">up with the idea of the</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> web server</font>

145
00:06:28,909 --> 00:06:34,400
<font color="#CCCCCC">and then</font><font color="#E5E5E5"> the web server will receive it</font>

146
00:06:31,219 --> 00:06:36,469
<font color="#E5E5E5">will take the the host header and then</font>

147
00:06:34,400 --> 00:06:38,719
it will find its actual IP and simple

148
00:06:36,469 --> 00:06:41,419
adjustment request to it<font color="#CCCCCC"> so even</font><font color="#E5E5E5"> if it's</font>

149
00:06:38,719 --> 00:06:42,770
an<font color="#CCCCCC"> ssl site and it uses HTS it will</font>

150
00:06:41,419 --> 00:06:46,039
still work against it<font color="#E5E5E5"> if you can somehow</font>

151
00:06:42,770 --> 00:06:49,639
get them to send an HTTP<font color="#E5E5E5"> request to that</font>

152
00:06:46,039 --> 00:06:52,068
domain<font color="#CCCCCC"> so</font><font color="#E5E5E5"> here's a demo that</font><font color="#CCCCCC"> i doing it</font>

153
00:06:49,639 --> 00:06:53,539
against<font color="#CCCCCC"> wells fargo but uh</font><font color="#E5E5E5"> surprisingly</font>

154
00:06:52,069 --> 00:06:58,990
it works<font color="#CCCCCC"> against every major American</font>

155
00:06:53,539 --> 00:06:58,990
<font color="#E5E5E5">bank or</font><font color="#CCCCCC"> goods unsurprisingly</font>

156
00:07:08,300 --> 00:07:13,280
<font color="#E5E5E5">and it's a little bit happy</font><font color="#CCCCCC"> in this</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> i</font>

157
00:07:10,789 --> 00:07:16,159
<font color="#E5E5E5">couldn't</font><font color="#CCCCCC"> get or I</font><font color="#E5E5E5"> at the time</font><font color="#CCCCCC"> I did the</font>

158
00:07:13,280 --> 00:07:18,559
demo I broke<font color="#CCCCCC"> SL concurrency so instead</font>

159
00:07:16,159 --> 00:07:21,259
of creating new<font color="#E5E5E5"> SL session</font><font color="#CCCCCC"> I just send</font>

160
00:07:18,560 --> 00:07:23,870
it to an HTTP site and then intercept it

161
00:07:21,259 --> 00:07:25,610
and then<font color="#CCCCCC"> redirect to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> the site</font>

162
00:07:23,870 --> 00:07:28,879
where<font color="#E5E5E5"> they would log in again but it</font>

163
00:07:25,610 --> 00:07:31,669
does when it actually works it does do

164
00:07:28,879 --> 00:07:34,220
<font color="#E5E5E5">SL</font><font color="#CCCCCC"> interception so it will create an SL</font>

165
00:07:31,669 --> 00:07:38,719
session with the<font color="#E5E5E5"> host and just</font><font color="#CCCCCC"> relayed</font>

166
00:07:34,220 --> 00:07:41,389
back to<font color="#CCCCCC"> the client</font><font color="#E5E5E5"> over HTTP ok so right</font>

167
00:07:38,720 --> 00:07:42,770
<font color="#E5E5E5">here it goes to wells fargo</font><font color="#CCCCCC"> com up top</font>

168
00:07:41,389 --> 00:07:44,569
is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> flash over at the bottom of the</font>

169
00:07:42,770 --> 00:07:46,698
<font color="#E5E5E5">dns server itself</font><font color="#CCCCCC"> so when I went there</font>

170
00:07:44,569 --> 00:07:48,590
is<font color="#E5E5E5"> somebody</font><font color="#CCCCCC"> who has</font><font color="#E5E5E5"> request right here</font>

171
00:07:46,699 --> 00:07:50,750
<font color="#CCCCCC">i'm logging in and then you'll see just</font>

172
00:07:48,590 --> 00:07:53,060
<font color="#E5E5E5">the post</font><font color="#CCCCCC"> request here so typically what</font>

173
00:07:50,750 --> 00:07:55,759
would end up happening is<font color="#CCCCCC"> dsl strip</font>

174
00:07:53,060 --> 00:07:57,800
would forward that to<font color="#E5E5E5"> wells fargo in an</font>

175
00:07:55,759 --> 00:08:02,030
<font color="#CCCCCC">ssl session</font><font color="#E5E5E5"> so you sending it to the</font>

176
00:07:57,800 --> 00:08:04,250
<font color="#CCCCCC">agency s</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> login</font><font color="#E5E5E5"> page and then it</font>

177
00:08:02,030 --> 00:08:05,750
would create a session with it and

178
00:08:04,250 --> 00:08:07,940
<font color="#E5E5E5">return the response</font>

179
00:08:05,750 --> 00:08:12,020
<font color="#CCCCCC">there we go we took the password from it</font>

180
00:08:07,940 --> 00:08:14,090
<font color="#CCCCCC">my</font><font color="#E5E5E5"> password one</font><font color="#CCCCCC"> that's kinda</font><font color="#E5E5E5"> do it and</font>

181
00:08:12,020 --> 00:08:18,340
it does work against<font color="#CCCCCC"> I said every major</font>

182
00:08:14,090 --> 00:08:18,340
American<font color="#E5E5E5"> you</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> so that's fun</font>

183
00:08:20,810 --> 00:08:23,320
<font color="#CCCCCC">alright</font>

184
00:08:23,630 --> 00:08:26,690
<font color="#CCCCCC">it was</font><font color="#E5E5E5"> happening here</font><font color="#CCCCCC"> and kind</font><font color="#E5E5E5"> of</font>

185
00:08:25,130 --> 00:08:29,810
<font color="#CCCCCC">explaining</font><font color="#E5E5E5"> some but here's some</font><font color="#CCCCCC"> diagram</font>

186
00:08:26,690 --> 00:08:33,020
so the<font color="#CCCCCC"> client sends a</font><font color="#E5E5E5"> request</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> dns</font>

187
00:08:29,810 --> 00:08:35,059
<font color="#E5E5E5">server</font><font color="#CCCCCC"> dns server</font><font color="#E5E5E5"> send</font><font color="#CCCCCC"> their response</font>

188
00:08:33,020 --> 00:08:37,280
and the response will be the IP of our

189
00:08:35,059 --> 00:08:40,189
flash server<font color="#CCCCCC"> so then we send a request</font>

190
00:08:37,280 --> 00:08:42,589
to the<font color="#E5E5E5"> flat server</font><font color="#CCCCCC"> class server</font><font color="#E5E5E5"> and this</font>

191
00:08:40,190 --> 00:08:44,360
is the SFL trip<font color="#CCCCCC"> aspect of it will</font><font color="#E5E5E5"> send</font>

192
00:08:42,590 --> 00:08:48,230
<font color="#E5E5E5">it back and replace everything this</font>

193
00:08:44,360 --> 00:08:50,660
<font color="#CCCCCC">https with just</font><font color="#E5E5E5"> HTTP</font><font color="#CCCCCC"> so then you're</font>

194
00:08:48,230 --> 00:08:51,590
sending more HTTP<font color="#CCCCCC"> request</font><font color="#E5E5E5"> that it can</font>

195
00:08:50,660 --> 00:08:54,439
intercept

196
00:08:51,590 --> 00:08:57,200
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> so then the second part of it is</font>

197
00:08:54,440 --> 00:08:58,670
intercepting<font color="#CCCCCC"> SL and having your own</font>

198
00:08:57,200 --> 00:09:04,430
<font color="#CCCCCC">session so</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can play it back</font>

199
00:08:58,670 --> 00:09:05,150
so what we do here<font color="#CCCCCC"> with art</font><font color="#E5E5E5"> and in doing</font>

200
00:09:04,430 --> 00:09:06,770
this

201
00:09:05,150 --> 00:09:10,850
look something up<font color="#CCCCCC"> ok so what we're doing</font>

202
00:09:06,770 --> 00:09:13,310
here is<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> sending the request to the</font>

203
00:09:10,850 --> 00:09:16,040
<font color="#CCCCCC">Wells Fargo</font><font color="#E5E5E5"> login page which has it</font>

204
00:09:13,310 --> 00:09:17,359
forces<font color="#CCCCCC"> us</font><font color="#E5E5E5"> itself HTS</font><font color="#CCCCCC"> although it doesn't</font>

205
00:09:16,040 --> 00:09:21,349
implement<font color="#E5E5E5"> it very well</font>

206
00:09:17,360 --> 00:09:24,800
<font color="#E5E5E5">so after</font><font color="#CCCCCC"> we go to the</font><font color="#E5E5E5"> homepage we</font>

207
00:09:21,350 --> 00:09:26,750
respond and<font color="#CCCCCC"> it'll say</font><font color="#E5E5E5"> go to HTTP / their</font>

208
00:09:24,800 --> 00:09:30,469
login page<font color="#CCCCCC"> so at that point we can</font>

209
00:09:26,750 --> 00:09:32,720
intercept<font color="#E5E5E5"> this then a the flash server</font><font color="#CCCCCC"> f</font>

210
00:09:30,470 --> 00:09:35,630
<font color="#E5E5E5">the actual will</font><font color="#CCCCCC"> Fargo</font><font color="#E5E5E5"> server</font><font color="#CCCCCC"> Kate where</font>

211
00:09:32,720 --> 00:09:39,320
am I going with this<font color="#E5E5E5"> and then it goes</font><font color="#CCCCCC"> so</font>

212
00:09:35,630 --> 00:09:43,550
<font color="#E5E5E5">then we'll start your replies back with</font>

213
00:09:39,320 --> 00:09:46,100
the body of the HTML body in its own<font color="#E5E5E5"> ssl</font>

214
00:09:43,550 --> 00:09:48,500
efficient<font color="#E5E5E5"> than it</font><font color="#CCCCCC"> feeds that</font><font color="#E5E5E5"> to the</font><font color="#CCCCCC"> to</font>

215
00:09:46,100 --> 00:09:51,830
the victim<font color="#E5E5E5"> over</font><font color="#CCCCCC"> HTTP so we can continue</font>

216
00:09:48,500 --> 00:09:55,460
<font color="#E5E5E5">messing with their traffic and you can</font>

217
00:09:51,830 --> 00:09:56,840
do it indefinitely so<font color="#CCCCCC"> pent head also</font>

218
00:09:55,460 --> 00:09:58,820
<font color="#E5E5E5">known as the future the reason I'm</font>

219
00:09:56,840 --> 00:10:01,310
<font color="#E5E5E5">saying testing out the future is because</font>

220
00:09:58,820 --> 00:10:04,820
I guess<font color="#E5E5E5"> this</font><font color="#CCCCCC"> isn't supposed</font><font color="#E5E5E5"> to me to be</font>

221
00:10:01,310 --> 00:10:07,849
me giving criminals ideas so<font color="#CCCCCC"> test</font>

222
00:10:04,820 --> 00:10:09,650
so what you can do with these type of

223
00:10:07,850 --> 00:10:11,480
tax or at least what<font color="#CCCCCC"> I what I found</font>

224
00:10:09,650 --> 00:10:13,790
interesting that you can<font color="#E5E5E5"> give them</font><font color="#CCCCCC"> so in</font>

225
00:10:11,480 --> 00:10:16,250
fact in boxes and<font color="#CCCCCC"> i have</font><font color="#E5E5E5"> another demo</font>

226
00:10:13,790 --> 00:10:19,910
<font color="#CCCCCC">but a I didn't have time</font><font color="#E5E5E5"> to included in</font>

227
00:10:16,250 --> 00:10:23,480
this which is exploiting<font color="#E5E5E5"> or equipment</font>

228
00:10:19,910 --> 00:10:28,010
vulnerability in<font color="#E5E5E5"> app where i had a VLAN</font>

229
00:10:23,480 --> 00:10:30,740
of like ten boxes<font color="#E5E5E5"> running</font><font color="#CCCCCC"> semi modern</font>

230
00:10:28,010 --> 00:10:32,490
<font color="#CCCCCC">pretty modern versions of debian and</font>

231
00:10:30,740 --> 00:10:35,700
then<font color="#CCCCCC"> I used</font>

232
00:10:32,490 --> 00:10:37,620
<font color="#E5E5E5">recent exploits in the app in app</font><font color="#CCCCCC"> how</font>

233
00:10:35,700 --> 00:10:41,010
<font color="#CCCCCC">assignments packages</font><font color="#E5E5E5"> where you could</font>

234
00:10:37,620 --> 00:10:43,470
just<font color="#CCCCCC"> intercept our quest to save the</font>

235
00:10:41,010 --> 00:10:44,670
<font color="#CCCCCC">debian update server and then say this</font>

236
00:10:43,470 --> 00:10:46,529
<font color="#E5E5E5">needs to</font><font color="#CCCCCC"> be passed</font>

237
00:10:44,670 --> 00:10:50,279
here's where you get the<font color="#CCCCCC"> past and then</font>

238
00:10:46,529 --> 00:10:51,990
it would include a<font color="#CCCCCC"> wooden code malware</font>

239
00:10:50,279 --> 00:10:55,200
in it and it would exploit the

240
00:10:51,990 --> 00:10:56,850
assignment ability<font color="#CCCCCC"> so</font><font color="#E5E5E5"> you have an effect</font>

241
00:10:55,200 --> 00:10:58,800
one router and then from that you<font color="#CCCCCC"> would</font>

242
00:10:56,850 --> 00:11:01,050
affect everything that gets<font color="#CCCCCC"> dns from</font>

243
00:10:58,800 --> 00:11:04,079
that you could conceivably use that in a

244
00:11:01,050 --> 00:11:06,660
setting like a<font color="#E5E5E5"> data</font><font color="#CCCCCC"> center and I think</font>

245
00:11:04,080 --> 00:11:10,080
<font color="#E5E5E5">that would be very interesting to see if</font>

246
00:11:06,660 --> 00:11:12,329
you do that in<font color="#CCCCCC"> a pen test</font><font color="#E5E5E5"> let me know</font><font color="#CCCCCC"> so</font>

247
00:11:10,080 --> 00:11:15,180
full control of all<font color="#CCCCCC"> the</font><font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> if you</font>

248
00:11:12,330 --> 00:11:17,190
<font color="#E5E5E5">and install an ssl cert on the box</font><font color="#CCCCCC"> so</font>

249
00:11:15,180 --> 00:11:19,620
from there you<font color="#CCCCCC"> could do a service that</font>

250
00:11:17,190 --> 00:11:21,810
you can do SL signing<font color="#E5E5E5"> on the fly</font>

251
00:11:19,620 --> 00:11:27,300
kind of<font color="#E5E5E5"> like your own DIY deep packet</font>

252
00:11:21,810 --> 00:11:28,890
inspection<font color="#CCCCCC"> and us if you</font><font color="#E5E5E5"> have an ssl</font>

253
00:11:27,300 --> 00:11:30,599
cert on the<font color="#E5E5E5"> box you can kind of defeat</font>

254
00:11:28,890 --> 00:11:34,380
this with certain<font color="#CCCCCC"> pinions but not</font><font color="#E5E5E5"> not</font>

255
00:11:30,600 --> 00:11:36,720
quite<font color="#E5E5E5"> stealing passwords kind of like</font><font color="#CCCCCC"> I</font>

256
00:11:34,380 --> 00:11:37,560
showed<font color="#E5E5E5"> recently</font><font color="#CCCCCC"> it's pretty</font><font color="#E5E5E5"> good feeling</font>

257
00:11:36,720 --> 00:11:40,410
password

258
00:11:37,560 --> 00:11:41,880
even if the login page that even if<font color="#CCCCCC"> this</font>

259
00:11:40,410 --> 00:11:46,290
<font color="#CCCCCC">is where the passengers are</font><font color="#E5E5E5"> being sent</font>

260
00:11:41,880 --> 00:11:49,800
<font color="#E5E5E5">is</font><font color="#CCCCCC"> FL nhcs RTLS</font><font color="#E5E5E5"> rather</font><font color="#CCCCCC"> you can still</font>

261
00:11:46,290 --> 00:11:54,000
intercept it<font color="#E5E5E5"> if we're there</font><font color="#CCCCCC"> if we're</font>

262
00:11:49,800 --> 00:11:55,439
getting the form from<font color="#CCCCCC"> is not so masking</font>

263
00:11:54,000 --> 00:11:56,670
the<font color="#CCCCCC"> command-and-control</font><font color="#E5E5E5"> servers</font>

264
00:11:55,440 --> 00:11:59,250
<font color="#CCCCCC">I'm not going to try that</font><font color="#E5E5E5"> much but that</font>

265
00:11:56,670 --> 00:12:01,709
is something<font color="#E5E5E5"> one could do because you</font>

266
00:11:59,250 --> 00:12:03,300
can just communicate data<font color="#CCCCCC"> / dns</font><font color="#E5E5E5"> and if</font>

267
00:12:01,709 --> 00:12:08,069
it's your own<font color="#CCCCCC"> dns servers you can just</font>

268
00:12:03,300 --> 00:12:11,910
retrieve the responses<font color="#E5E5E5"> so as</font><font color="#CCCCCC"> I mentioned</font>

269
00:12:08,070 --> 00:12:14,430
earlier about using the using<font color="#CCCCCC"> dns now</font>

270
00:12:11,910 --> 00:12:16,199
<font color="#CCCCCC">you can meet</font><font color="#E5E5E5"> us you can ask your working</font>

271
00:12:14,430 --> 00:12:18,390
context would be that<font color="#CCCCCC"> you've got into a</font>

272
00:12:16,200 --> 00:12:22,649
router somehow<font color="#CCCCCC"> and you want to get our</font>

273
00:12:18,390 --> 00:12:24,510
<font color="#E5E5E5">seat and</font><font color="#CCCCCC"> it kind of</font><font color="#E5E5E5"> exploded earlier the</font>

274
00:12:22,649 --> 00:12:25,890
<font color="#CCCCCC">cat-and-mouse</font><font color="#E5E5E5"> of this so kind of what</font>

275
00:12:24,510 --> 00:12:28,020
the attackers can do and what<font color="#E5E5E5"> if</font>

276
00:12:25,890 --> 00:12:29,699
<font color="#CCCCCC">defendants to</font><font color="#E5E5E5"> do so if you're starting</font>

277
00:12:28,020 --> 00:12:31,620
with the attackers heaven and external

278
00:12:29,700 --> 00:12:33,300
dns server<font color="#CCCCCC"> this is rather you to block</font>

279
00:12:31,620 --> 00:12:36,600
you can just say hey<font color="#E5E5E5"> only use these</font>

280
00:12:33,300 --> 00:12:39,660
external dns service and lots of places

281
00:12:36,600 --> 00:12:41,640
<font color="#E5E5E5">will do that however they will not do</font>

282
00:12:39,660 --> 00:12:44,060
that with internal dns service though

283
00:12:41,640 --> 00:12:46,069
<font color="#CCCCCC">where the tiger could</font><font color="#E5E5E5"> go from there</font>

284
00:12:44,060 --> 00:12:48,979
they could just if they're already in a

285
00:12:46,070 --> 00:12:50,720
router<font color="#CCCCCC"> they could probably</font><font color="#E5E5E5"> flash</font><font color="#CCCCCC"> some</font>

286
00:12:48,980 --> 00:12:52,640
<font color="#E5E5E5">firmware that would have its own</font><font color="#CCCCCC"> dns</font>

287
00:12:50,720 --> 00:12:57,590
server running on it<font color="#CCCCCC"> that they can do</font>

288
00:12:52,640 --> 00:13:00,050
the attack from<font color="#E5E5E5"> and then the</font><font color="#CCCCCC"> blue team</font>

289
00:12:57,590 --> 00:13:03,530
from<font color="#CCCCCC"> there could conceivably do</font><font color="#E5E5E5"> just</font>

290
00:13:00,050 --> 00:13:07,250
monitoring of<font color="#CCCCCC"> dns</font><font color="#E5E5E5"> like that</font><font color="#CCCCCC"> to monitor</font>

291
00:13:03,530 --> 00:13:08,540
local<font color="#CCCCCC"> dns or</font><font color="#E5E5E5"> whitelisting</font><font color="#CCCCCC"> bien and then</font>

292
00:13:07,250 --> 00:13:10,790
<font color="#E5E5E5">I'm sure there are</font><font color="#CCCCCC"> lots of reading</font>

293
00:13:08,540 --> 00:13:14,959
<font color="#E5E5E5">people that have much better much more</font>

294
00:13:10,790 --> 00:13:16,939
clever ideas and<font color="#CCCCCC"> I do</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> and fixes as I</font>

295
00:13:14,960 --> 00:13:18,680
said black hole and external<font color="#CCCCCC"> an apple</font>

296
00:13:16,940 --> 00:13:24,110
iphone but<font color="#CCCCCC"> out whitelisting your dns</font>

297
00:13:18,680 --> 00:13:27,050
<font color="#E5E5E5">monitoring dns and then</font><font color="#CCCCCC"> so the</font><font color="#E5E5E5"> next to</font>

298
00:13:24,110 --> 00:13:28,070
<font color="#CCCCCC">our kind of ideas that</font><font color="#E5E5E5"> I've been</font>

299
00:13:27,050 --> 00:13:29,390
thinking<font color="#E5E5E5"> of and</font><font color="#CCCCCC"> I haven't seen them</font>

300
00:13:28,070 --> 00:13:31,820
implemented anywhere but i think that

301
00:13:29,390 --> 00:13:33,920
they would successfully<font color="#CCCCCC"> fixes and I</font>

302
00:13:31,820 --> 00:13:35,600
think<font color="#E5E5E5"> could also be used for useful for</font>

303
00:13:33,920 --> 00:13:38,360
<font color="#CCCCCC">antivirus and browsers to implement</font>

304
00:13:35,600 --> 00:13:41,360
something like<font color="#E5E5E5"> this so if you have a bad</font>

305
00:13:38,360 --> 00:13:43,370
<font color="#E5E5E5">dns server and you have you</font><font color="#CCCCCC"> any requests</font>

306
00:13:41,360 --> 00:13:44,540
to it and<font color="#CCCCCC"> send</font><font color="#E5E5E5"> a better responses you</font>

307
00:13:43,370 --> 00:13:47,360
could look at it

308
00:13:44,540 --> 00:13:48,860
cross-reference<font color="#CCCCCC"> of</font><font color="#E5E5E5"> a bunch of other DNS</font>

309
00:13:47,360 --> 00:13:50,870
servers and then<font color="#E5E5E5"> if none of them give</font>

310
00:13:48,860 --> 00:13:53,360
you the same response<font color="#CCCCCC"> you can probably</font>

311
00:13:50,870 --> 00:13:55,370
tell that something's up there and you

312
00:13:53,360 --> 00:13:58,700
<font color="#CCCCCC">could investigate that</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> i'm working</font><font color="#E5E5E5"> on</font>

313
00:13:55,370 --> 00:13:59,990
making an<font color="#CCCCCC"> open</font><font color="#E5E5E5"> a dd-wrt model that does</font>

314
00:13:58,700 --> 00:14:03,050
that

315
00:13:59,990 --> 00:14:06,680
so if you have a<font color="#E5E5E5"> bad dns server either</font>

316
00:14:03,050 --> 00:14:08,630
being used by a client or<font color="#E5E5E5"> by your router</font>

317
00:14:06,680 --> 00:14:12,439
<font color="#CCCCCC">it</font><font color="#E5E5E5"> can look at these and</font><font color="#CCCCCC"> that it can say</font>

318
00:14:08,630 --> 00:14:15,470
hey this is bad<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> acceptor so SL</font>

319
00:14:12,440 --> 00:14:19,460
everywhere and always<font color="#E5E5E5"> so as a</font><font color="#CCCCCC"> tune</font>

320
00:14:15,470 --> 00:14:22,640
<font color="#E5E5E5">earlier if you</font><font color="#CCCCCC"> uh you can only really be</font>

321
00:14:19,460 --> 00:14:26,390
<font color="#E5E5E5">taxed at least you can</font><font color="#CCCCCC"> H to be</font><font color="#E5E5E5"> if you</font>

322
00:14:22,640 --> 00:14:28,760
don't use<font color="#CCCCCC"> ssl</font><font color="#E5E5E5"> at some point so if you</font>

323
00:14:26,390 --> 00:14:30,680
use<font color="#CCCCCC"> ssl always in all your requests that</font>

324
00:14:28,760 --> 00:14:33,800
<font color="#E5E5E5">kind of</font><font color="#CCCCCC"> fixes that</font><font color="#E5E5E5"> so there are plugins</font>

325
00:14:30,680 --> 00:14:37,819
like<font color="#CCCCCC"> SL everywhere that would be useful</font>

326
00:14:33,800 --> 00:14:39,380
for things like this so<font color="#E5E5E5"> rock scene</font><font color="#CCCCCC"> so</font>

327
00:14:37,820 --> 00:14:41,420
<font color="#E5E5E5">lots of companies they will press the</font>

328
00:14:39,380 --> 00:14:42,890
other<font color="#E5E5E5"> check out from there you can serve</font>

329
00:14:41,420 --> 00:14:44,569
<font color="#E5E5E5">sort through</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and look at the DNS</font>

330
00:14:42,890 --> 00:14:46,130
<font color="#CCCCCC">requests</font><font color="#E5E5E5"> and you could do something like</font>

331
00:14:44,570 --> 00:14:48,670
<font color="#E5E5E5">the craft cross-referencing</font><font color="#CCCCCC"> i was</font>

332
00:14:46,130 --> 00:14:48,670
talking about

333
00:14:49,180 --> 00:14:55,660
<font color="#CCCCCC">so then the</font><font color="#E5E5E5"> answer</font><font color="#CCCCCC"> cell trip if you want</font>

334
00:14:53,710 --> 00:14:58,930
to see more about it<font color="#CCCCCC"> for see the code</font>

335
00:14:55,660 --> 00:15:04,300
<font color="#E5E5E5">you can go there if you have any</font>

336
00:14:58,930 --> 00:15:11,290
<font color="#E5E5E5">question</font><font color="#CCCCCC"> e-mail be there</font><font color="#E5E5E5"> and that is it</font>

337
00:15:04,300 --> 00:15:16,180
thank you

338
00:15:11,290 --> 00:15:18,699
<font color="#E5E5E5">thank you very much</font><font color="#CCCCCC"> i'll before you go a</font>

339
00:15:16,180 --> 00:15:22,630
<font color="#CCCCCC">thank-you thank-you from</font><font color="#E5E5E5"> b-sides and</font>

340
00:15:18,699 --> 00:15:24,189
<font color="#E5E5E5">Fitbit and thank you from</font><font color="#CCCCCC"> Nick thanks</font>

341
00:15:22,630 --> 00:15:26,350
very much we will have another short

342
00:15:24,190 --> 00:15:29,819
break and i will let you know when the

343
00:15:26,350 --> 00:15:29,819
next speaker is up momentarily

