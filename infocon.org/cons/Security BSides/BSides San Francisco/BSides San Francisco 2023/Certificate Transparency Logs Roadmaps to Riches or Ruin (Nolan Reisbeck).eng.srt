1
00:00:00,480 --> 00:00:02,399
it's good to be back at b-sides it's

2
00:00:02,399 --> 00:00:04,080
been a few years

3
00:00:04,080 --> 00:00:06,779
so just a round of applause for the

4
00:00:06,779 --> 00:00:08,460
volunteers today and everybody else

5
00:00:08,460 --> 00:00:11,160
coming together to make this

6
00:00:11,160 --> 00:00:13,620
a reality again my name is Nolan

7
00:00:13,620 --> 00:00:18,000
reisbeck like she said uh I'm a platform

8
00:00:18,000 --> 00:00:19,680
engineer at MasterCard I've been there

9
00:00:19,680 --> 00:00:21,600
for a little while and today I'm going

10
00:00:21,600 --> 00:00:24,300
to be talking a little bit about uh

11
00:00:24,300 --> 00:00:26,039
certificate certificate transparency

12
00:00:26,039 --> 00:00:30,859
logs and the dangers that lie there in

13
00:00:31,260 --> 00:00:34,380
um so I

14
00:00:34,380 --> 00:00:36,000
left Oakland

15
00:00:36,000 --> 00:00:38,219
um three or four years ago I moved back

16
00:00:38,219 --> 00:00:40,079
home to bend um

17
00:00:40,079 --> 00:00:41,700
I'd probably rather be skiing or sailing

18
00:00:41,700 --> 00:00:43,620
but

19
00:00:43,620 --> 00:00:45,960
um I was thrilled to have the

20
00:00:45,960 --> 00:00:47,820
opportunity to come back and present it

21
00:00:47,820 --> 00:00:50,100
besides this year so

22
00:00:50,100 --> 00:00:52,800
um I've got two dogs and my girlfriend

23
00:00:52,800 --> 00:00:54,719
is at home she couldn't make it but I

24
00:00:54,719 --> 00:00:56,640
also do want to thank her for putting up

25
00:00:56,640 --> 00:00:57,960
with me in the last couple weeks of

26
00:00:57,960 --> 00:01:00,059
trying to pull this all together so

27
00:01:00,059 --> 00:01:03,320
for patience is appreciated

28
00:01:05,939 --> 00:01:08,159
so a little overview of the talk here I

29
00:01:08,159 --> 00:01:10,080
do want to talk uh just kind of about

30
00:01:10,080 --> 00:01:12,000
different types of SSL certificates I

31
00:01:12,000 --> 00:01:13,260
know this is a deep dive but I want to

32
00:01:13,260 --> 00:01:14,280
make sure that we're kind of all on the

33
00:01:14,280 --> 00:01:15,540
same page and talking about the same

34
00:01:15,540 --> 00:01:17,580
things we're going to talk a little bit

35
00:01:17,580 --> 00:01:19,619
about the history of certificate

36
00:01:19,619 --> 00:01:21,780
transparency logs

37
00:01:21,780 --> 00:01:25,320
um why we need them and

38
00:01:25,320 --> 00:01:27,180
how we got here

39
00:01:27,180 --> 00:01:30,299
um how we well how we uh arrived at the

40
00:01:30,299 --> 00:01:31,920
need for them there's a little bit of a

41
00:01:31,920 --> 00:01:33,299
history lesson in there uh we're going

42
00:01:33,299 --> 00:01:34,979
to talk a little bit about the process

43
00:01:34,979 --> 00:01:38,400
of how your Certificate request

44
00:01:38,400 --> 00:01:40,380
um becomes published into a certificate

45
00:01:40,380 --> 00:01:42,840
certificate transparency log

46
00:01:42,840 --> 00:01:45,119
um as well as what that whole process

47
00:01:45,119 --> 00:01:46,740
and how all the parts and pieces fit

48
00:01:46,740 --> 00:01:49,200
together when you go off and request a

49
00:01:49,200 --> 00:01:51,240
certificate until you get that

50
00:01:51,240 --> 00:01:53,040
certificate back we're going to talk a

51
00:01:53,040 --> 00:01:55,200
little bit about commercial and Homebrew

52
00:01:55,200 --> 00:01:56,960
Solutions

53
00:01:56,960 --> 00:01:59,399
for monitoring

54
00:01:59,399 --> 00:02:01,759
um the various logs that are out there

55
00:02:01,759 --> 00:02:05,460
we'll do a little quick detour into kind

56
00:02:05,460 --> 00:02:09,060
of a lot a live stream of a certificate

57
00:02:09,060 --> 00:02:11,459
transparency log and then I've got a

58
00:02:11,459 --> 00:02:13,200
little bit of a demo to go through and

59
00:02:13,200 --> 00:02:15,060
then we're going to wrap things up by

60
00:02:15,060 --> 00:02:17,520
talking a little bit about

61
00:02:17,520 --> 00:02:19,160
um like tying it all together

62
00:02:19,160 --> 00:02:22,260
certificate transparency logs for

63
00:02:22,260 --> 00:02:25,620
um The Blue Team Defenders as well as

64
00:02:25,620 --> 00:02:28,080
people that may consider themselves more

65
00:02:28,080 --> 00:02:29,760
on the red team side of things or purple

66
00:02:29,760 --> 00:02:30,660
team

67
00:02:30,660 --> 00:02:31,920
um

68
00:02:31,920 --> 00:02:33,720
how you can use an abuse certificate

69
00:02:33,720 --> 00:02:35,360
transparency logs

70
00:02:35,360 --> 00:02:38,580
and what all is out there to find and

71
00:02:38,580 --> 00:02:40,680
then we'll have a little bit of QA time

72
00:02:40,680 --> 00:02:44,040
q a time after that so

73
00:02:44,040 --> 00:02:45,720
so a brief primer

74
00:02:45,720 --> 00:02:47,660
um on certificate transparency logs

75
00:02:47,660 --> 00:02:51,780
we've got three different types of SSL

76
00:02:51,780 --> 00:02:53,180
certificates out there

77
00:02:53,180 --> 00:02:56,459
the vast majority of SSL certificates

78
00:02:56,459 --> 00:02:57,599
when they're issued are going to be

79
00:02:57,599 --> 00:03:00,180
domain verified and what that means is

80
00:03:00,180 --> 00:03:01,440
that

81
00:03:01,440 --> 00:03:04,560
you just have to present some modicum of

82
00:03:04,560 --> 00:03:09,000
control over the uh the record

83
00:03:09,000 --> 00:03:10,920
for the domain that you're requesting

84
00:03:10,920 --> 00:03:14,280
whether that's a verification or

85
00:03:14,280 --> 00:03:17,580
validation through some well-known file

86
00:03:17,580 --> 00:03:18,540
um

87
00:03:18,540 --> 00:03:22,379
add a path like an HTTP request you can

88
00:03:22,379 --> 00:03:24,720
also verify

89
00:03:24,720 --> 00:03:26,580
demonstrate ownership of the domain that

90
00:03:26,580 --> 00:03:28,379
you're requesting for

91
00:03:28,379 --> 00:03:30,360
via a text record

92
00:03:30,360 --> 00:03:33,599
um so that's another DNS record type

93
00:03:33,599 --> 00:03:35,159
um generally speaking you'll get some

94
00:03:35,159 --> 00:03:38,159
sort of random string to plug into the

95
00:03:38,159 --> 00:03:41,040
value of that text record and then the

96
00:03:41,040 --> 00:03:42,659
certificate issuer or the certificate

97
00:03:42,659 --> 00:03:44,519
Authority issuing that certificate will

98
00:03:44,519 --> 00:03:48,000
then go and wait some time look up the

99
00:03:48,000 --> 00:03:50,000
value of the text record if it matches

100
00:03:50,000 --> 00:03:52,260
the value that they provided you and

101
00:03:52,260 --> 00:03:54,420
told you to put it in there they will

102
00:03:54,420 --> 00:03:56,879
turn around and do what they need to do

103
00:03:56,879 --> 00:03:58,319
on their side and then hand you back a

104
00:03:58,319 --> 00:04:00,000
certificate so kind of generally

105
00:04:00,000 --> 00:04:02,159
speaking that's the that's the flow for

106
00:04:02,159 --> 00:04:05,040
domain verification through let's

107
00:04:05,040 --> 00:04:07,159
encrypt or the Acme

108
00:04:07,159 --> 00:04:11,640
process but there are other Cas out

109
00:04:11,640 --> 00:04:13,560
there that will do like email

110
00:04:13,560 --> 00:04:16,798
verification or things like that so

111
00:04:16,798 --> 00:04:19,918
big takeaway there DV certificates are

112
00:04:19,918 --> 00:04:22,019
probably what you're getting unless

113
00:04:22,019 --> 00:04:24,120
you're going out of your way to do a lot

114
00:04:24,120 --> 00:04:27,060
more paperwork which I don't enjoy and

115
00:04:27,060 --> 00:04:28,740
I'm sure you probably don't too but we

116
00:04:28,740 --> 00:04:32,520
will cover those here briefly

117
00:04:32,580 --> 00:04:35,639
tight number two we have an OV

118
00:04:35,639 --> 00:04:38,540
certificate or organization validated

119
00:04:38,540 --> 00:04:43,020
and what that means is that if you go

120
00:04:43,020 --> 00:04:47,940
out and request a certificate for

121
00:04:47,940 --> 00:04:48,600
um

122
00:04:48,600 --> 00:04:50,880
like a business

123
00:04:50,880 --> 00:04:52,860
um widgets Co

124
00:04:52,860 --> 00:04:55,560
um you would probably want a little bit

125
00:04:55,560 --> 00:04:56,820
more

126
00:04:56,820 --> 00:05:01,100
rigor around the process of that so

127
00:05:01,100 --> 00:05:04,979
the ca will require some paperwork

128
00:05:04,979 --> 00:05:07,380
um they will basically well I'm sorry I

129
00:05:07,380 --> 00:05:09,000
got ahead of myself there

130
00:05:09,000 --> 00:05:10,080
um

131
00:05:10,080 --> 00:05:12,720
the

132
00:05:12,720 --> 00:05:16,259
request or you when you go off and

133
00:05:16,259 --> 00:05:18,540
request an OV certificate you'll provide

134
00:05:18,540 --> 00:05:20,300
a little bit more information to them

135
00:05:20,300 --> 00:05:22,979
they'll put a couple of oids on there

136
00:05:22,979 --> 00:05:25,440
which are just object identifiers in the

137
00:05:25,440 --> 00:05:26,520
certificate

138
00:05:26,520 --> 00:05:30,000
field I've thrown a couple up there just

139
00:05:30,000 --> 00:05:31,560
for reference they're not important you

140
00:05:31,560 --> 00:05:33,380
don't need to memorize those

141
00:05:33,380 --> 00:05:36,300
so basically you basically just have to

142
00:05:36,300 --> 00:05:39,600
provide an expanded certificate subject

143
00:05:39,600 --> 00:05:42,419
on there that just says you know this is

144
00:05:42,419 --> 00:05:44,940
for example Company Incorporated in some

145
00:05:44,940 --> 00:05:47,639
Town California they'll go off and

146
00:05:47,639 --> 00:05:50,820
basically use one of like four or five

147
00:05:50,820 --> 00:05:53,039
different business database

148
00:05:53,039 --> 00:05:55,320
verifications to say yeah some some

149
00:05:55,320 --> 00:05:58,800
company example company is incorporated

150
00:05:58,800 --> 00:06:00,840
um in in that state and then they'll

151
00:06:00,840 --> 00:06:02,220
turn around and issue your certificate

152
00:06:02,220 --> 00:06:04,740
so

153
00:06:04,740 --> 00:06:06,360
third and final type

154
00:06:06,360 --> 00:06:09,419
um we have uh an extended validation

155
00:06:09,419 --> 00:06:10,979
um an EV certificate so generally

156
00:06:10,979 --> 00:06:12,780
speaking you'll kind of see these types

157
00:06:12,780 --> 00:06:14,880
of certificates used

158
00:06:14,880 --> 00:06:16,620
for

159
00:06:16,620 --> 00:06:17,460
um

160
00:06:17,460 --> 00:06:19,080
Financial processing you know credit

161
00:06:19,080 --> 00:06:20,880
card transactions things like that you

162
00:06:20,880 --> 00:06:23,880
would generally hope that your bank is

163
00:06:23,880 --> 00:06:25,740
probably using these there is

164
00:06:25,740 --> 00:06:28,680
significantly more rigor around these

165
00:06:28,680 --> 00:06:31,280
certificates and the process there

166
00:06:31,280 --> 00:06:34,680
and it is up to the ca or the issuing

167
00:06:34,680 --> 00:06:37,740
authority on that the to do that

168
00:06:37,740 --> 00:06:40,560
validation so the certificate Authority

169
00:06:40,560 --> 00:06:43,680
and browser Forum will set the

170
00:06:43,680 --> 00:06:45,900
validation requirements

171
00:06:45,900 --> 00:06:50,280
um there's like four different 200 Page

172
00:06:50,280 --> 00:06:52,139
docs out there if you want to go through

173
00:06:52,139 --> 00:06:54,180
and read those we're not going to talk

174
00:06:54,180 --> 00:06:57,180
about too much of that right now but the

175
00:06:57,180 --> 00:06:59,460
primary purpose of an extended

176
00:06:59,460 --> 00:07:01,979
validation certificate would be to

177
00:07:01,979 --> 00:07:04,740
identify the actual legal entity that

178
00:07:04,740 --> 00:07:07,380
controls a website or that domain I

179
00:07:07,380 --> 00:07:08,699
should say so

180
00:07:08,699 --> 00:07:10,500
um you're generally not going to see

181
00:07:10,500 --> 00:07:12,840
those through the

182
00:07:12,840 --> 00:07:15,440
fishing or stuffing

183
00:07:15,440 --> 00:07:19,440
campaigns the look-alikes and you know

184
00:07:19,440 --> 00:07:21,780
those those will just be generic

185
00:07:21,780 --> 00:07:22,620
um

186
00:07:22,620 --> 00:07:24,360
certificates but

187
00:07:24,360 --> 00:07:26,880
one kind of big thing to note there is

188
00:07:26,880 --> 00:07:29,819
that the the the big browsers out there

189
00:07:29,819 --> 00:07:30,780
don't really

190
00:07:30,780 --> 00:07:31,380
[Music]

191
00:07:31,380 --> 00:07:32,940
um

192
00:07:32,940 --> 00:07:35,400
make it very evident they used to

193
00:07:35,400 --> 00:07:37,020
um the EV certificates will give you a

194
00:07:37,020 --> 00:07:38,880
little green padlock um there used to be

195
00:07:38,880 --> 00:07:40,740
a little bit more but there's not uh

196
00:07:40,740 --> 00:07:43,259
there's not too much more to the user if

197
00:07:43,259 --> 00:07:44,699
you're going to your bank and logging in

198
00:07:44,699 --> 00:07:47,280
and you see the little padlock icon up

199
00:07:47,280 --> 00:07:49,259
there next to the bar you're probably

200
00:07:49,259 --> 00:07:52,380
not going to go inspect that certificate

201
00:07:52,380 --> 00:07:54,539
to make sure that there's an oid on it

202
00:07:54,539 --> 00:07:56,759
um as an end user you don't really care

203
00:07:56,759 --> 00:07:59,099
about that kind of thing um

204
00:07:59,099 --> 00:08:02,479
so the cab

205
00:08:02,479 --> 00:08:05,340
validation requirements like I said the

206
00:08:05,340 --> 00:08:06,900
primary purpose is to identify the legal

207
00:08:06,900 --> 00:08:08,819
entity that controls the domain

208
00:08:08,819 --> 00:08:12,300
um and secondarily to make it more

209
00:08:12,300 --> 00:08:16,160
difficult for fraud and other types of

210
00:08:16,160 --> 00:08:21,000
identity attacks to happen however

211
00:08:21,000 --> 00:08:23,580
an EV certificate is not intended to

212
00:08:23,580 --> 00:08:26,280
represent or warrant that the legal

213
00:08:26,280 --> 00:08:28,979
entity named in the certificate

214
00:08:28,979 --> 00:08:31,080
um is actually currently still doing

215
00:08:31,080 --> 00:08:32,000
business

216
00:08:32,000 --> 00:08:35,880
or that it is compliant with local laws

217
00:08:35,880 --> 00:08:37,620
in their jurisdictions

218
00:08:37,620 --> 00:08:39,539
um or furthermore I put this as three

219
00:08:39,539 --> 00:08:41,458
but it's also kind of important to talk

220
00:08:41,458 --> 00:08:42,419
about

221
00:08:42,419 --> 00:08:43,080
um

222
00:08:43,080 --> 00:08:45,600
by getting an Eevee certificate the the

223
00:08:45,600 --> 00:08:48,060
cab and the ca is not actually attesting

224
00:08:48,060 --> 00:08:51,060
to your trustworthiness or honesty

225
00:08:51,060 --> 00:08:52,860
um as a

226
00:08:52,860 --> 00:08:54,779
business entity

227
00:08:54,779 --> 00:08:55,860
um they just want their money and

228
00:08:55,860 --> 00:08:56,580
they're going to issue you their

229
00:08:56,580 --> 00:08:57,660
certificate they've done a little bit

230
00:08:57,660 --> 00:09:00,420
more checking into kind of who you are

231
00:09:00,420 --> 00:09:04,500
um and it's also not safe to assume um

232
00:09:04,500 --> 00:09:07,380
that you can do business with this

233
00:09:07,380 --> 00:09:09,480
company presenting a certificate so that

234
00:09:09,480 --> 00:09:10,560
being said

235
00:09:10,560 --> 00:09:12,360
um they just wanted to

236
00:09:12,360 --> 00:09:14,040
put that out there it's in one of their

237
00:09:14,040 --> 00:09:17,339
documents up at the very top um but they

238
00:09:17,339 --> 00:09:18,300
will turn around and issue their

239
00:09:18,300 --> 00:09:19,500
certificate they've just done their

240
00:09:19,500 --> 00:09:23,940
homework and can a test that the legal

241
00:09:23,940 --> 00:09:26,279
entity requesting that certificate

242
00:09:26,279 --> 00:09:30,200
actually represents that domain so

243
00:09:30,660 --> 00:09:32,519
uh organization types we did talk about

244
00:09:32,519 --> 00:09:34,380
this just a little bit

245
00:09:34,380 --> 00:09:36,540
um there's uh four different

246
00:09:36,540 --> 00:09:38,459
organization types

247
00:09:38,459 --> 00:09:40,680
um that you know you when you go and

248
00:09:40,680 --> 00:09:43,620
request an easy EV certificate they will

249
00:09:43,620 --> 00:09:47,100
bucket your request into a particular

250
00:09:47,100 --> 00:09:48,720
type of entity and that will be

251
00:09:48,720 --> 00:09:51,060
published on the certificate

252
00:09:51,060 --> 00:09:52,800
um a private organization is generally

253
00:09:52,800 --> 00:09:54,600
going to be the vast majority of

254
00:09:54,600 --> 00:09:56,760
companies that would request a

255
00:09:56,760 --> 00:09:58,220
certificate like that

256
00:09:58,220 --> 00:10:01,519
your LLCs are limited in the UK

257
00:10:01,519 --> 00:10:05,279
gmbh in Germany and limited liability

258
00:10:05,279 --> 00:10:06,480
Partnerships

259
00:10:06,480 --> 00:10:07,140
um

260
00:10:07,140 --> 00:10:09,180
there's also government entities

261
00:10:09,180 --> 00:10:11,940
um I think that's kind of obvious so

262
00:10:11,940 --> 00:10:16,680
um like the NIH or the IRS a government

263
00:10:16,680 --> 00:10:20,279
entity and that entities legal existence

264
00:10:20,279 --> 00:10:22,140
was established by the political

265
00:10:22,140 --> 00:10:23,459
um

266
00:10:23,459 --> 00:10:25,680
powers in the jurisdiction which they

267
00:10:25,680 --> 00:10:28,200
operate and they have said yes you are

268
00:10:28,200 --> 00:10:30,300
the Revenue Service for the US you may

269
00:10:30,300 --> 00:10:32,360
have a dot gov

270
00:10:32,360 --> 00:10:35,399
tldn domain business entities

271
00:10:35,399 --> 00:10:36,620
um

272
00:10:36,620 --> 00:10:40,080
this is a little murky

273
00:10:40,080 --> 00:10:42,060
um it's

274
00:10:42,060 --> 00:10:43,640
kind of General Partnerships

275
00:10:43,640 --> 00:10:45,720
unincorporated associations joint

276
00:10:45,720 --> 00:10:48,300
ventures and Sole proprietorships and

277
00:10:48,300 --> 00:10:49,860
then there's also non-commercial

278
00:10:49,860 --> 00:10:51,660
entities so non-profits academic

279
00:10:51,660 --> 00:10:53,339
institutions higher education things

280
00:10:53,339 --> 00:10:55,760
like that

281
00:10:56,640 --> 00:10:58,560
so yeah

282
00:10:58,560 --> 00:11:03,180
we get into a little bit of the need so

283
00:11:03,180 --> 00:11:07,860
um in 2011 there was a

284
00:11:07,860 --> 00:11:09,899
well there still is a CA

285
00:11:09,899 --> 00:11:12,540
um Komodo had a little bit of an Oopsy

286
00:11:12,540 --> 00:11:13,500
Daisy

287
00:11:13,500 --> 00:11:16,920
um and uh Moxie Marlin's bike gave a

288
00:11:16,920 --> 00:11:19,019
really good talk on this a while back

289
00:11:19,019 --> 00:11:21,720
um it was probably five six eight years

290
00:11:21,720 --> 00:11:24,540
ago um but

291
00:11:24,540 --> 00:11:26,579
on March 15th

292
00:11:26,579 --> 00:11:29,760
um there was uh it was discovered that

293
00:11:29,760 --> 00:11:33,480
the registration Authority instant SSL

294
00:11:33,480 --> 00:11:36,060
um which was an issuer for Komodo

295
00:11:36,060 --> 00:11:37,500
um had a little bit of security incident

296
00:11:37,500 --> 00:11:41,459
and using this registration Authority a

297
00:11:41,459 --> 00:11:43,740
other time unknown person

298
00:11:43,740 --> 00:11:47,519
um went and issued nine certificates

299
00:11:47,519 --> 00:11:50,100
across seven domains

300
00:11:50,100 --> 00:11:53,040
um four some pretty big companies Google

301
00:11:53,040 --> 00:11:57,480
Yahoo Skype Mozilla Microsoft and then

302
00:11:57,480 --> 00:12:00,779
one final one down here Global trustee

303
00:12:00,779 --> 00:12:02,700
with

304
00:12:02,700 --> 00:12:03,959
the cereal

305
00:12:03,959 --> 00:12:06,959
uh it was never really ascertained what

306
00:12:06,959 --> 00:12:09,120
that certificate was issued for it was

307
00:12:09,120 --> 00:12:11,640
not issued for a valid domain and kind

308
00:12:11,640 --> 00:12:13,140
of the

309
00:12:13,140 --> 00:12:14,940
running Theory and at least the one that

310
00:12:14,940 --> 00:12:16,500
still kind of accepted this time is that

311
00:12:16,500 --> 00:12:19,380
that was a certificate certificate that

312
00:12:19,380 --> 00:12:21,899
may or may not have been used likely may

313
00:12:21,899 --> 00:12:24,720
have been used for login to

314
00:12:24,720 --> 00:12:26,519
um maybe some some more of the back ends

315
00:12:26,519 --> 00:12:28,940
that exist in the ca world

316
00:12:28,940 --> 00:12:31,980
the Yahoo one up here in bold

317
00:12:31,980 --> 00:12:33,920
um this serial number was the only

318
00:12:33,920 --> 00:12:36,240
certificate that was issued by this

319
00:12:36,240 --> 00:12:38,820
attacker that was ever seen in the wild

320
00:12:38,820 --> 00:12:41,880
um and so what that means is that this

321
00:12:41,880 --> 00:12:43,860
person went and issued all of these

322
00:12:43,860 --> 00:12:45,180
certificates

323
00:12:45,180 --> 00:12:47,220
um for mail.google.com you know you go

324
00:12:47,220 --> 00:12:48,440
log into your Gmail

325
00:12:48,440 --> 00:12:50,880
if they had the opportunity to do that

326
00:12:50,880 --> 00:12:53,519
we're let's say for example running the

327
00:12:53,519 --> 00:12:56,040
Wi-Fi in your hotel

328
00:12:56,040 --> 00:13:00,420
they could use that certificate and that

329
00:13:00,420 --> 00:13:02,160
would allow them to redirect the traffic

330
00:13:02,160 --> 00:13:05,940
from actual Gmail to something

331
00:13:05,940 --> 00:13:07,980
presenting itself as Gmail probably

332
00:13:07,980 --> 00:13:10,860
looks the same probably acts the same

333
00:13:10,860 --> 00:13:13,620
until you click login and uh the whole

334
00:13:13,620 --> 00:13:17,399
point of that was Prudential harvesting

335
00:13:17,399 --> 00:13:20,399
but of those uh

336
00:13:20,399 --> 00:13:23,060
let's say eight certificates the

337
00:13:23,060 --> 00:13:25,560
login.yahoo one from this breach that

338
00:13:25,560 --> 00:13:26,700
was issued

339
00:13:26,700 --> 00:13:29,880
um by Komodo was the only one that was

340
00:13:29,880 --> 00:13:32,880
ever actually seen to be used the rest

341
00:13:32,880 --> 00:13:35,160
of them nobody at the time really had

342
00:13:35,160 --> 00:13:38,220
any idea what this person was up to what

343
00:13:38,220 --> 00:13:39,720
their plans were

344
00:13:39,720 --> 00:13:43,860
or what might happen but

345
00:13:43,860 --> 00:13:45,600
the

346
00:13:45,600 --> 00:13:48,180
uh

347
00:13:48,180 --> 00:13:50,399
sorry

348
00:13:50,399 --> 00:13:53,360
after the fact there was somebody that

349
00:13:53,360 --> 00:13:56,279
did publicly claim on the internet they

350
00:13:56,279 --> 00:13:58,139
posted a

351
00:13:58,139 --> 00:13:59,880
um a paste bin

352
00:13:59,880 --> 00:14:03,000
um document dump basically saying

353
00:14:03,000 --> 00:14:04,620
here's who I am I take responsibility

354
00:14:04,620 --> 00:14:07,440
for this and generally kind of at the

355
00:14:07,440 --> 00:14:09,120
time people were just kind of you know

356
00:14:09,120 --> 00:14:10,860
skeptical about that there was a few

357
00:14:10,860 --> 00:14:12,540
security researchers out there that were

358
00:14:12,540 --> 00:14:14,760
like uh I don't know it seems like you

359
00:14:14,760 --> 00:14:16,980
might just be trying to take credit for

360
00:14:16,980 --> 00:14:19,260
this for the glamor

361
00:14:19,260 --> 00:14:22,100
um but they did end up

362
00:14:22,100 --> 00:14:24,420
supplying a little bit of evidence that

363
00:14:24,420 --> 00:14:26,579
moved those claims from the realm of

364
00:14:26,579 --> 00:14:28,260
skepticism into

365
00:14:28,260 --> 00:14:31,760
oh boy this might be a problem

366
00:14:33,839 --> 00:14:36,959
after that so that was back on March

367
00:14:36,959 --> 00:14:41,399
15th of 2011. so a few months later in

368
00:14:41,399 --> 00:14:43,399
August during the summer

369
00:14:43,399 --> 00:14:47,350
uh there was a gentleman in

370
00:14:47,350 --> 00:14:48,000
[Music]

371
00:14:48,000 --> 00:14:49,019
um

372
00:14:49,019 --> 00:14:52,560
Iran that posted this very innocuous

373
00:14:52,560 --> 00:14:54,720
innocuous looking

374
00:14:54,720 --> 00:14:57,180
um kind of plea for help he seemed very

375
00:14:57,180 --> 00:14:59,820
baffled at the time by it

376
00:14:59,820 --> 00:15:00,480
um

377
00:15:00,480 --> 00:15:02,339
but he found

378
00:15:02,339 --> 00:15:04,920
um the now defunct this was

379
00:15:04,920 --> 00:15:07,079
this screenshot was a nightmare to track

380
00:15:07,079 --> 00:15:09,240
down I I could not find it all the links

381
00:15:09,240 --> 00:15:10,139
are dead

382
00:15:10,139 --> 00:15:11,639
um Google's replaced all their product

383
00:15:11,639 --> 00:15:13,920
forums but I did finally find it

384
00:15:13,920 --> 00:15:16,079
um but he said

385
00:15:16,079 --> 00:15:18,420
I tried it basically in in essence I

386
00:15:18,420 --> 00:15:20,399
tried to log into Gmail

387
00:15:20,399 --> 00:15:22,560
um and I got a certificate warning in

388
00:15:22,560 --> 00:15:23,820
Chrome

389
00:15:23,820 --> 00:15:25,079
um you know just that little red box

390
00:15:25,079 --> 00:15:28,680
that says this certificate is invalid

391
00:15:28,680 --> 00:15:30,839
he said I took a screenshot and I saved

392
00:15:30,839 --> 00:15:34,339
that certificate to the file to a file

393
00:15:34,440 --> 00:15:36,000
here's that certificate file and a

394
00:15:36,000 --> 00:15:37,320
screenshot

395
00:15:37,320 --> 00:15:39,480
um he uploaded it to MediaFire

396
00:15:39,480 --> 00:15:42,480
um and then he said here's the text of

397
00:15:42,480 --> 00:15:44,880
this decoded fake certificate

398
00:15:44,880 --> 00:15:46,440
posted it on pastebin for other people

399
00:15:46,440 --> 00:15:49,139
to look at and he said

400
00:15:49,139 --> 00:15:52,139
and then I logged into my VPN

401
00:15:52,139 --> 00:15:54,300
um and I went to Gmail again and it

402
00:15:54,300 --> 00:15:56,220
worked just fine

403
00:15:56,220 --> 00:15:57,480
um

404
00:15:57,480 --> 00:15:59,399
what's going on there was like a thing

405
00:15:59,399 --> 00:16:01,019
at Komodo that happened that I had heard

406
00:16:01,019 --> 00:16:01,980
about

407
00:16:01,980 --> 00:16:03,420
um but that was really kind of it and uh

408
00:16:03,420 --> 00:16:06,839
what I found most amusing about this um

409
00:16:06,839 --> 00:16:09,899
post was one that it was just kind of

410
00:16:09,899 --> 00:16:13,019
in a dark corner of the web on the

411
00:16:13,019 --> 00:16:16,560
Google product forums under the off

412
00:16:16,560 --> 00:16:17,880
topic

413
00:16:17,880 --> 00:16:21,240
um the coffee shop if you will so

414
00:16:21,240 --> 00:16:22,620
um just hey I noticed something weird

415
00:16:22,620 --> 00:16:24,120
going on with Google today

416
00:16:24,120 --> 00:16:25,920
um which I don't know if anybody any

417
00:16:25,920 --> 00:16:28,560
anyone has ever dealt with um end user

418
00:16:28,560 --> 00:16:30,300
support but you get a lot of

419
00:16:30,300 --> 00:16:32,040
um requests and things like that hey

420
00:16:32,040 --> 00:16:33,779
this is kind of weird and nine times out

421
00:16:33,779 --> 00:16:35,760
of ten They Don't Really pan out but um

422
00:16:35,760 --> 00:16:38,459
unfortunately for all of us this

423
00:16:38,459 --> 00:16:41,339
gentleman was uh actually spot on with

424
00:16:41,339 --> 00:16:42,120
that

425
00:16:42,120 --> 00:16:44,240
um

426
00:16:44,579 --> 00:16:47,040
so

427
00:16:47,040 --> 00:16:48,839
August 28th

428
00:16:48,839 --> 00:16:50,880
um let's just kind of keep that date in

429
00:16:50,880 --> 00:16:53,220
mind so that was

430
00:16:53,220 --> 00:16:54,180
um

431
00:16:54,180 --> 00:16:56,459
seven months after the initial Komodo

432
00:16:56,459 --> 00:16:58,758
breach

433
00:16:59,279 --> 00:17:01,019
is a little a little hard to see here so

434
00:17:01,019 --> 00:17:02,820
I'm going to squint at my screen

435
00:17:02,820 --> 00:17:05,880
um so basically the the public timeline

436
00:17:05,880 --> 00:17:08,640
um of This was

437
00:17:08,640 --> 00:17:09,299
um

438
00:17:09,299 --> 00:17:12,240
there was another breach this time it

439
00:17:12,240 --> 00:17:16,020
was through another CA called Digi notar

440
00:17:16,020 --> 00:17:19,079
um and so August 28th third line down

441
00:17:19,079 --> 00:17:21,540
there uh was one of our little friend

442
00:17:21,540 --> 00:17:23,699
posted his um

443
00:17:23,699 --> 00:17:25,740
message to the support forum is this a

444
00:17:25,740 --> 00:17:29,400
man in the middle attack to Google's SSL

445
00:17:29,400 --> 00:17:33,419
July 10th was the date of the uh actual

446
00:17:33,419 --> 00:17:34,980
certificate issuance

447
00:17:34,980 --> 00:17:37,620
um Somebody went and breached did you

448
00:17:37,620 --> 00:17:38,640
know tar

449
00:17:38,640 --> 00:17:42,360
we don't know when they we do now but at

450
00:17:42,360 --> 00:17:44,940
the time we didn't but somebody went out

451
00:17:44,940 --> 00:17:47,580
and looked and said okay that

452
00:17:47,580 --> 00:17:49,020
certificate that

453
00:17:49,020 --> 00:17:51,360
he posted on there you can go look at it

454
00:17:51,360 --> 00:17:52,860
you can see the not valid form before

455
00:17:52,860 --> 00:17:55,380
date you can see it was issued

456
00:17:55,380 --> 00:17:57,480
um July 10th

457
00:17:57,480 --> 00:17:59,520
there was a few more certificates issued

458
00:17:59,520 --> 00:18:03,480
for Google sub domains but the last one

459
00:18:03,480 --> 00:18:06,660
was issued on July 20th

460
00:18:06,660 --> 00:18:09,120
so a 10-day time span

461
00:18:09,120 --> 00:18:12,299
um and then basically a month after

462
00:18:12,299 --> 00:18:15,120
those certificates stopped being issued

463
00:18:15,120 --> 00:18:17,220
is when

464
00:18:17,220 --> 00:18:20,280
the world generally found out about it

465
00:18:20,280 --> 00:18:23,280
immediately the mines over at Google

466
00:18:23,280 --> 00:18:27,120
sprung into action and on July 29th they

467
00:18:27,120 --> 00:18:30,059
basically posted a statement saying that

468
00:18:30,059 --> 00:18:32,700
they were aware that a certificate had

469
00:18:32,700 --> 00:18:36,000
been issued by this ca for a domain that

470
00:18:36,000 --> 00:18:38,160
they controlled and they assured

471
00:18:38,160 --> 00:18:40,860
everybody that they did not request it

472
00:18:40,860 --> 00:18:42,500
um

473
00:18:42,500 --> 00:18:46,020
there were uh there was a statement that

474
00:18:46,020 --> 00:18:47,340
was made

475
00:18:47,340 --> 00:18:49,980
um by Mozilla the same day and uh

476
00:18:49,980 --> 00:18:53,039
Microsoft as well so the folks over at

477
00:18:53,039 --> 00:18:56,100
the cab Forum uh they're generally

478
00:18:56,100 --> 00:18:58,260
pretty responsive to each other and when

479
00:18:58,260 --> 00:19:00,419
problems like this arise

480
00:19:00,419 --> 00:19:02,220
it's generally a pretty cohesive thing

481
00:19:02,220 --> 00:19:06,299
and so the consensus was is that that

482
00:19:06,299 --> 00:19:09,000
certificate would be distrusted

483
00:19:09,000 --> 00:19:13,919
um in the browsers Chrome Mozilla and

484
00:19:13,919 --> 00:19:18,440
um Internet Explorer Edge Etc

485
00:19:18,900 --> 00:19:21,240
the day after that Vasco the parent

486
00:19:21,240 --> 00:19:23,340
company of diginotar

487
00:19:23,340 --> 00:19:24,240
um

488
00:19:24,240 --> 00:19:26,340
issued a public statement basically kind

489
00:19:26,340 --> 00:19:27,780
of downplaying it

490
00:19:27,780 --> 00:19:28,380
um

491
00:19:28,380 --> 00:19:31,080
now if you're following along that was

492
00:19:31,080 --> 00:19:34,320
uh 51 days after

493
00:19:34,320 --> 00:19:35,039
um

494
00:19:35,039 --> 00:19:37,320
the fraudulent certificates had been

495
00:19:37,320 --> 00:19:40,140
issued which isn't really a great look

496
00:19:40,140 --> 00:19:41,760
um they kind of slow rolled that and

497
00:19:41,760 --> 00:19:45,080
they really didn't say too much about it

498
00:19:45,080 --> 00:19:47,460
they said that they were kind of looking

499
00:19:47,460 --> 00:19:48,799
into it

500
00:19:48,799 --> 00:19:52,020
and basically said that it really wasn't

501
00:19:52,020 --> 00:19:52,860
um

502
00:19:52,860 --> 00:19:57,678
too much of a cause for concern

503
00:19:58,080 --> 00:20:00,179
which I think we can all agree

504
00:20:00,179 --> 00:20:02,460
um it should have been

505
00:20:02,460 --> 00:20:04,740
the um

506
00:20:04,740 --> 00:20:07,380
Roundup of all of the certificates that

507
00:20:07,380 --> 00:20:10,860
were issued by diginotar in uh in this

508
00:20:10,860 --> 00:20:14,400
whole Fiasco were published to a a

509
00:20:14,400 --> 00:20:17,280
mailing list on f-secure I think that

510
00:20:17,280 --> 00:20:19,200
there was

511
00:20:19,200 --> 00:20:21,240
uh let's see here there was quite a few

512
00:20:21,240 --> 00:20:22,140
of them

513
00:20:22,140 --> 00:20:23,880
and

514
00:20:23,880 --> 00:20:26,400
um on September 1st

515
00:20:26,400 --> 00:20:28,559
um chromium and

516
00:20:28,559 --> 00:20:32,940
Google revoked 257 certificates

517
00:20:32,940 --> 00:20:35,600
issued by Digi notar

518
00:20:35,600 --> 00:20:39,379
and then they

519
00:20:39,419 --> 00:20:42,600
revoke the genotars root certificate

520
00:20:42,600 --> 00:20:46,020
um now if you're a CA and your entire

521
00:20:46,020 --> 00:20:49,380
business purpose is to provide trust and

522
00:20:49,380 --> 00:20:50,880
you're out there issuing certificates

523
00:20:50,880 --> 00:20:54,480
for entities and domains that the actual

524
00:20:54,480 --> 00:20:57,720
controller of that domain didn't

525
00:20:57,720 --> 00:20:59,220
ask for

526
00:20:59,220 --> 00:21:00,780
and

527
00:21:00,780 --> 00:21:03,600
you don't know where they went that

528
00:21:03,600 --> 00:21:06,480
doesn't really instill confidence in the

529
00:21:06,480 --> 00:21:10,140
public and uh isn't very trustworthy so

530
00:21:10,140 --> 00:21:12,419
as a CA basically the only thing that

531
00:21:12,419 --> 00:21:14,039
you have is

532
00:21:14,039 --> 00:21:17,640
um your word and your processes and

533
00:21:17,640 --> 00:21:20,039
procedures for why that's not going to

534
00:21:20,039 --> 00:21:22,980
happen and if it does that trust kind of

535
00:21:22,980 --> 00:21:24,720
evaporates and

536
00:21:24,720 --> 00:21:28,020
there is not really much reason for you

537
00:21:28,020 --> 00:21:31,500
as a CA to exist anymore so September

538
00:21:31,500 --> 00:21:34,320
2nd Mozilla issued a follow-up statement

539
00:21:34,320 --> 00:21:36,360
um basically confirming the same exact

540
00:21:36,360 --> 00:21:38,580
thing saying that they would also follow

541
00:21:38,580 --> 00:21:41,100
suit with the chromium project they

542
00:21:41,100 --> 00:21:44,159
would be blacklisting all of the or I'm

543
00:21:44,159 --> 00:21:45,960
sorry they would be revoking all the

544
00:21:45,960 --> 00:21:50,039
certificates in um in Mozilla and uh

545
00:21:50,039 --> 00:21:51,960
basically disallowing those to be

546
00:21:51,960 --> 00:21:55,200
trusted so if somebody was using that

547
00:21:55,200 --> 00:21:57,120
certificate and a end user went

548
00:21:57,120 --> 00:21:59,280
navigated to a website and that website

549
00:21:59,280 --> 00:22:01,260
presented that certificate big old

550
00:22:01,260 --> 00:22:02,640
Banner

551
00:22:02,640 --> 00:22:04,260
um

552
00:22:04,260 --> 00:22:07,080
September 3rd uh yeah September 3rd the

553
00:22:07,080 --> 00:22:10,440
uh the Dutch government also revoked

554
00:22:10,440 --> 00:22:13,740
trust in the did you notar route now

555
00:22:13,740 --> 00:22:15,900
this is um also kind of important

556
00:22:15,900 --> 00:22:16,940
because

557
00:22:16,940 --> 00:22:22,080
the Dutch government used Digi notar as

558
00:22:22,080 --> 00:22:24,659
their primary ca for a lot of things

559
00:22:24,659 --> 00:22:28,020
like taxes and um Healthcare and things

560
00:22:28,020 --> 00:22:29,580
like that

561
00:22:29,580 --> 00:22:33,059
so chromium's out mozilla's out the

562
00:22:33,059 --> 00:22:34,860
Dutch Government is out

563
00:22:34,860 --> 00:22:37,200
um and things are not really looking so

564
00:22:37,200 --> 00:22:39,419
good for did you notar

565
00:22:39,419 --> 00:22:41,940
um September 5th the interim report on

566
00:22:41,940 --> 00:22:47,159
what happened there uh was published

567
00:22:47,159 --> 00:22:49,080
the same day that that report was

568
00:22:49,080 --> 00:22:50,039
published

569
00:22:50,039 --> 00:22:51,600
um did you know tar

570
00:22:51,600 --> 00:22:53,340
decided it was finally time to pick up

571
00:22:53,340 --> 00:22:55,740
the phone and Report the breach to the

572
00:22:55,740 --> 00:22:58,400
Dutch police

573
00:22:59,940 --> 00:23:01,500
shortly after that

574
00:23:01,500 --> 00:23:03,539
um the next week they officially filed

575
00:23:03,539 --> 00:23:05,220
for bankruptcy

576
00:23:05,220 --> 00:23:08,179
um and the day after that a Dutch Court

577
00:23:08,179 --> 00:23:10,860
basically accepted their bankruptcy

578
00:23:10,860 --> 00:23:13,380
filing they would cease to operate as a

579
00:23:13,380 --> 00:23:16,020
legal entity in the Netherlands and

580
00:23:16,020 --> 00:23:19,020
issue uh no more certificates wanted or

581
00:23:19,020 --> 00:23:20,460
unwanted

582
00:23:20,460 --> 00:23:22,919
so that's the public timeline now we get

583
00:23:22,919 --> 00:23:26,059
to go into what really happened

584
00:23:27,480 --> 00:23:29,580
did you know Tara was compromised way

585
00:23:29,580 --> 00:23:32,460
back on June 6th

586
00:23:32,460 --> 00:23:35,760
um which is far before

587
00:23:35,760 --> 00:23:37,140
um

588
00:23:37,140 --> 00:23:40,140
August when our our friends posted that

589
00:23:40,140 --> 00:23:43,200
to the Google forums

590
00:23:43,200 --> 00:23:45,179
July 10th

591
00:23:45,179 --> 00:23:47,700
um there was a wild card certificate

592
00:23:47,700 --> 00:23:50,100
issued for google.com

593
00:23:50,100 --> 00:23:51,500
um and so that's not just

594
00:23:51,500 --> 00:23:54,299
mail.google.com that could be anything

595
00:23:54,299 --> 00:23:56,580
else under that

596
00:23:56,580 --> 00:23:58,919
um single subdomain Google

597
00:23:58,919 --> 00:24:02,400
you could use that certificate to do all

598
00:24:02,400 --> 00:24:04,940
sorts of awful and terrible things

599
00:24:04,940 --> 00:24:08,280
and that certificate was not revoked

600
00:24:08,280 --> 00:24:11,580
until about a month and a half later on

601
00:24:11,580 --> 00:24:14,580
August 29th so just a few days after the

602
00:24:14,580 --> 00:24:16,620
problem was surfaced in that product

603
00:24:16,620 --> 00:24:17,820
Forum

604
00:24:17,820 --> 00:24:20,280
um July 10th somebody over at Digi notar

605
00:24:20,280 --> 00:24:22,919
noticed an automated test had failed to

606
00:24:22,919 --> 00:24:23,880
work

607
00:24:23,880 --> 00:24:25,740
raise your hand if you work in an

608
00:24:25,740 --> 00:24:27,840
organization that uses Jenkins or

609
00:24:27,840 --> 00:24:29,700
something else like that to run CI

610
00:24:29,700 --> 00:24:35,940
testing and tests fail a lot right

611
00:24:35,940 --> 00:24:38,100
and you go yeah that broke it's probably

612
00:24:38,100 --> 00:24:40,260
not a very big deal uh we'll look at it

613
00:24:40,260 --> 00:24:42,240
it's Friday afternoon two o'clock I'll

614
00:24:42,240 --> 00:24:44,159
look at it on Monday

615
00:24:44,159 --> 00:24:45,659
um I'm not saying that that's what

616
00:24:45,659 --> 00:24:47,940
happened but somebody over there noticed

617
00:24:47,940 --> 00:24:49,620
that on July 10th one of their

618
00:24:49,620 --> 00:24:51,780
integration tests failed and that

619
00:24:51,780 --> 00:24:53,100
integration test basically what that

620
00:24:53,100 --> 00:24:55,679
integration test did

621
00:24:55,679 --> 00:24:57,659
um was that it went out and looked at

622
00:24:57,659 --> 00:25:00,360
all of the certificates that that CA

623
00:25:00,360 --> 00:25:03,179
issues and I looked at all of the

624
00:25:03,179 --> 00:25:06,020
requests

625
00:25:06,179 --> 00:25:07,679
please sign me a certificate for

626
00:25:07,679 --> 00:25:09,960
google.com I've issued you a certificate

627
00:25:09,960 --> 00:25:11,880
for google.com

628
00:25:11,880 --> 00:25:14,520
however things didn't line up

629
00:25:14,520 --> 00:25:15,600
um and that was kind of the big problem

630
00:25:15,600 --> 00:25:16,799
they realized that there was a whole

631
00:25:16,799 --> 00:25:18,600
bunch of certificates out there

632
00:25:18,600 --> 00:25:22,158
that they had no requests for

633
00:25:22,200 --> 00:25:25,140
um and so they went and fixed

634
00:25:25,140 --> 00:25:27,240
um that test

635
00:25:27,240 --> 00:25:28,799
um took about a week

636
00:25:28,799 --> 00:25:33,120
and uh the

637
00:25:33,120 --> 00:25:35,220
administrative records um like I said

638
00:25:35,220 --> 00:25:37,380
the the administrative the the number of

639
00:25:37,380 --> 00:25:38,880
requests and the number of issued

640
00:25:38,880 --> 00:25:39,900
certificates

641
00:25:39,900 --> 00:25:41,880
in the end just didn't match up that's

642
00:25:41,880 --> 00:25:44,580
all that test was meant to show

643
00:25:44,580 --> 00:25:48,000
uh July 20th they found a script

644
00:25:48,000 --> 00:25:51,299
somewhere presumably on uh one of those

645
00:25:51,299 --> 00:25:53,580
agents or you know I'm just positing

646
00:25:53,580 --> 00:25:55,440
here um

647
00:25:55,440 --> 00:25:57,059
one of the systems that was running the

648
00:25:57,059 --> 00:26:00,179
tests they found a little bit of um

649
00:26:00,179 --> 00:26:02,520
leftover cruft that wasn't cleaned up so

650
00:26:02,520 --> 00:26:04,380
the attacker didn't really

651
00:26:04,380 --> 00:26:06,240
um clean up after themselves and they

652
00:26:06,240 --> 00:26:07,440
kind of shot themselves in the foot

653
00:26:07,440 --> 00:26:08,520
there

654
00:26:08,520 --> 00:26:10,559
they also found out that there was even

655
00:26:10,559 --> 00:26:12,240
more certificates that hadn't been

656
00:26:12,240 --> 00:26:14,340
requested that were issued

657
00:26:14,340 --> 00:26:15,000
um

658
00:26:15,000 --> 00:26:17,940
on July 27th they engaged in external

659
00:26:17,940 --> 00:26:19,260
security firm

660
00:26:19,260 --> 00:26:21,360
um the official report that was

661
00:26:21,360 --> 00:26:23,220
furnished to the Dutch government and

662
00:26:23,220 --> 00:26:24,659
everybody else on the internet uh never

663
00:26:24,659 --> 00:26:26,760
actually said who the initial firm was I

664
00:26:26,760 --> 00:26:29,580
did not ever find that out but I would

665
00:26:29,580 --> 00:26:31,380
love to know

666
00:26:31,380 --> 00:26:33,659
um and that report basically just showed

667
00:26:33,659 --> 00:26:37,559
that some server sitting out there in

668
00:26:37,559 --> 00:26:40,380
their infrastructure in uh in in one of

669
00:26:40,380 --> 00:26:43,500
the dmz's uh had been compromised by an

670
00:26:43,500 --> 00:26:45,480
unknown entity using a known

671
00:26:45,480 --> 00:26:47,640
vulnerability

672
00:26:47,640 --> 00:26:50,580
um in the dot net nuke software that

673
00:26:50,580 --> 00:26:53,760
that server Ran So yet again another

674
00:26:53,760 --> 00:26:57,419
known known vulnerability that hadn't

675
00:26:57,419 --> 00:26:59,220
been patched on a server sitting out

676
00:26:59,220 --> 00:27:01,140
there wide open on the internet um

677
00:27:01,140 --> 00:27:02,940
that story should be

678
00:27:02,940 --> 00:27:05,580
very familiar now at this point

679
00:27:05,580 --> 00:27:06,840
um

680
00:27:06,840 --> 00:27:11,340
it was discovered that the Rogue one of

681
00:27:11,340 --> 00:27:14,760
the Rogue certificates had been verified

682
00:27:14,760 --> 00:27:18,000
by an IP address originating in the

683
00:27:18,000 --> 00:27:20,100
Islamic Republic of Iran so basically

684
00:27:20,100 --> 00:27:21,840
when you're out there navigating around

685
00:27:21,840 --> 00:27:23,100
on the web

686
00:27:23,100 --> 00:27:26,279
um your browser whatever it will be will

687
00:27:26,279 --> 00:27:28,260
say yep that's fine and good I see that

688
00:27:28,260 --> 00:27:30,480
certificate I verified the chain it does

689
00:27:30,480 --> 00:27:32,400
look valid but there's a little bit more

690
00:27:32,400 --> 00:27:33,720
that goes on in the background that

691
00:27:33,720 --> 00:27:35,940
needs to happen in order for that

692
00:27:35,940 --> 00:27:37,799
certificate um to actually be verified

693
00:27:37,799 --> 00:27:42,840
so they saw that that some browser in

694
00:27:42,840 --> 00:27:44,360
Iran had

695
00:27:44,360 --> 00:27:49,380
requested to verify that certificate

696
00:27:49,380 --> 00:27:51,299
August 28th as we know we talked about

697
00:27:51,299 --> 00:27:53,760
this already that is when our friend

698
00:27:53,760 --> 00:27:56,940
posted that innocuous message in the

699
00:27:56,940 --> 00:27:58,679
Google product forums

700
00:27:58,679 --> 00:28:02,159
August 29th that certificate was revoked

701
00:28:02,159 --> 00:28:04,440
and then August 30th there was another

702
00:28:04,440 --> 00:28:06,960
it firm called Fox I.T that was hired by

703
00:28:06,960 --> 00:28:11,159
Digi notar they kind of specialize in um

704
00:28:11,159 --> 00:28:13,500
digital forensics and things like that

705
00:28:13,500 --> 00:28:15,779
and they were the author of the final

706
00:28:15,779 --> 00:28:19,260
report that was eventually published and

707
00:28:19,260 --> 00:28:21,919
furnished everybody

708
00:28:22,200 --> 00:28:24,059
so why do we need Certificate

709
00:28:24,059 --> 00:28:26,340
transparency logs um the aftermath of

710
00:28:26,340 --> 00:28:28,159
the digi notar breach

711
00:28:28,159 --> 00:28:30,419
531 certificates were issued between

712
00:28:30,419 --> 00:28:34,860
July 10th and July 20th used in um uh

713
00:28:34,860 --> 00:28:36,779
monster in the middle attacks against

714
00:28:36,779 --> 00:28:40,380
Google Gmail Yahoo Skype Mozilla

715
00:28:40,380 --> 00:28:42,720
um Microsoft tour and ever and and

716
00:28:42,720 --> 00:28:44,039
others

717
00:28:44,039 --> 00:28:47,100
um Kaspersky uh researcher

718
00:28:47,100 --> 00:28:48,299
um I'm not even going to try to

719
00:28:48,299 --> 00:28:50,880
pronounce that last name basically said

720
00:28:50,880 --> 00:28:53,159
um in a public Blog blog post according

721
00:28:53,159 --> 00:28:55,559
to digi notar they are not able to track

722
00:28:55,559 --> 00:28:57,720
which Rogue certificates they generated

723
00:28:57,720 --> 00:29:01,799
so they issued 531 they had no idea what

724
00:29:01,799 --> 00:29:02,880
those certificates were there was

725
00:29:02,880 --> 00:29:04,700
nothing actually

726
00:29:04,700 --> 00:29:07,620
reconciling not a single log file saying

727
00:29:07,620 --> 00:29:09,900
I issued a certificate for Gmail I

728
00:29:09,900 --> 00:29:12,539
issued a certificate for login.yahoo No

729
00:29:12,539 --> 00:29:13,740
Such accounting

730
00:29:13,740 --> 00:29:15,799
um

731
00:29:15,840 --> 00:29:17,400
if you don't know what you're issuing

732
00:29:17,400 --> 00:29:18,539
you're probably not counting how many

733
00:29:18,539 --> 00:29:19,980
are issuing

734
00:29:19,980 --> 00:29:21,120
um so they didn't know how many Rogue

735
00:29:21,120 --> 00:29:22,799
certificates were out there

736
00:29:22,799 --> 00:29:24,539
um either did you know Tire performs no

737
00:29:24,539 --> 00:29:25,860
logging of the certificates they create

738
00:29:25,860 --> 00:29:27,779
or their logs got cleaned out in the

739
00:29:27,779 --> 00:29:28,980
attack so a little bit of benefit of the

740
00:29:28,980 --> 00:29:30,179
adult there

741
00:29:30,179 --> 00:29:33,299
um Chris wazinski from Sophos said they

742
00:29:33,299 --> 00:29:36,059
found all of this

743
00:29:36,059 --> 00:29:37,620
um they found all the certificates

744
00:29:37,620 --> 00:29:40,860
except for the google.com one what other

745
00:29:40,860 --> 00:29:42,720
sites were at risk from visiting earlier

746
00:29:42,720 --> 00:29:44,940
were those certificates for Microsoft

747
00:29:44,940 --> 00:29:47,700
Yahoo or PayPal spoiler alert they were

748
00:29:47,700 --> 00:29:51,000
when he published that the full list of

749
00:29:51,000 --> 00:29:53,779
certificates had not been yet found out

750
00:29:53,779 --> 00:29:56,880
but not a good look

751
00:29:56,880 --> 00:29:58,919
so CT logs

752
00:29:58,919 --> 00:30:00,960
um trust no public record of

753
00:30:00,960 --> 00:30:02,760
certificates issued

754
00:30:02,760 --> 00:30:05,340
not who issued it not requested not who

755
00:30:05,340 --> 00:30:06,779
requested it

756
00:30:06,779 --> 00:30:09,080
um not how many did they issue

757
00:30:09,080 --> 00:30:12,539
or was that the only one if you have one

758
00:30:12,539 --> 00:30:15,000
Rogue certificate issued logic kind of

759
00:30:15,000 --> 00:30:17,100
follows that there was probably a lot

760
00:30:17,100 --> 00:30:18,779
more but without any of those kinds of

761
00:30:18,779 --> 00:30:21,419
Records you don't know

762
00:30:21,419 --> 00:30:23,880
problem number two it takes a while to

763
00:30:23,880 --> 00:30:25,620
revoke certificates

764
00:30:25,620 --> 00:30:29,399
um you can you know a CA can revoke a

765
00:30:29,399 --> 00:30:31,140
certificate an end user can request to

766
00:30:31,140 --> 00:30:33,179
certificate be revoked um but it's not

767
00:30:33,179 --> 00:30:35,399
instantaneous

768
00:30:35,399 --> 00:30:37,620
um and the third part notification how

769
00:30:37,620 --> 00:30:40,440
do uh end users know that that

770
00:30:40,440 --> 00:30:43,080
certificate has been revoked uh there

771
00:30:43,080 --> 00:30:44,760
isn't or there was not at the time a

772
00:30:44,760 --> 00:30:47,340
very good valid mechanism for

773
00:30:47,340 --> 00:30:48,720
um

774
00:30:48,720 --> 00:30:51,539
someone here and someone in New York

775
00:30:51,539 --> 00:30:54,559
um reconciling those

776
00:30:56,220 --> 00:30:59,640
um so as a domain owner you have no idea

777
00:30:59,640 --> 00:31:01,260
um you're just kind of blindly trusting

778
00:31:01,260 --> 00:31:03,059
at that point that Cas are doing their

779
00:31:03,059 --> 00:31:05,159
job like they said they would

780
00:31:05,159 --> 00:31:07,440
um and that they were only issuing

781
00:31:07,440 --> 00:31:09,720
certificates that were requested and

782
00:31:09,720 --> 00:31:12,360
they weren't issuing certificates for

783
00:31:12,360 --> 00:31:14,220
competitor for your competitors

784
00:31:14,220 --> 00:31:18,240
um but users also don't really have any

785
00:31:18,240 --> 00:31:21,120
way of knowing is

786
00:31:21,120 --> 00:31:23,220
when they go to mail.google.com to log

787
00:31:23,220 --> 00:31:26,580
into their uh Gmail is that actually

788
00:31:26,580 --> 00:31:28,679
is what they're logging into actually

789
00:31:28,679 --> 00:31:31,020
Google the only thing that you have is

790
00:31:31,020 --> 00:31:33,179
that certificate

791
00:31:33,179 --> 00:31:35,159
um and if it says it's from Google

792
00:31:35,159 --> 00:31:36,960
you're probably not going to look too

793
00:31:36,960 --> 00:31:39,740
much further into that

794
00:31:39,840 --> 00:31:42,659
certificates take a while to revoke crls

795
00:31:42,659 --> 00:31:45,120
have existed for quite a long time a

796
00:31:45,120 --> 00:31:47,100
client a web browser in this case would

797
00:31:47,100 --> 00:31:49,919
generally download a crl list from a

798
00:31:49,919 --> 00:31:53,340
certificate Authority or a crl issuer

799
00:31:53,340 --> 00:31:55,679
um maybe once a day maybe once every

800
00:31:55,679 --> 00:31:56,880
couple of days

801
00:31:56,880 --> 00:31:58,020
um it's kind of expected that your

802
00:31:58,020 --> 00:32:00,299
browser will check those

803
00:32:00,299 --> 00:32:02,100
um it'll search through the list

804
00:32:02,100 --> 00:32:04,679
and if the domain that you're navigating

805
00:32:04,679 --> 00:32:07,559
to is on that list it will prompt that

806
00:32:07,559 --> 00:32:10,559
but your browser may be out of date on

807
00:32:10,559 --> 00:32:13,020
that list refresh so no instantaneous

808
00:32:13,020 --> 00:32:14,399
mechanism to

809
00:32:14,399 --> 00:32:17,460
revoke a certificate right away you

810
00:32:17,460 --> 00:32:20,640
could be waiting a day or two for that

811
00:32:20,640 --> 00:32:22,980
to finally show up on your browser as

812
00:32:22,980 --> 00:32:25,860
having been revoked

813
00:32:25,860 --> 00:32:28,620
notification we talked about that how

814
00:32:28,620 --> 00:32:29,880
are you notified that the certificate

815
00:32:29,880 --> 00:32:31,320
has been revoked

816
00:32:31,320 --> 00:32:33,299
whatever this is over here how many

817
00:32:33,299 --> 00:32:35,520
times a day do you see that at work

818
00:32:35,520 --> 00:32:36,179
um

819
00:32:36,179 --> 00:32:38,279
I log into firewalls all the time

820
00:32:38,279 --> 00:32:39,899
certificate validation errors do I look

821
00:32:39,899 --> 00:32:41,640
at them I have in the past I don't

822
00:32:41,640 --> 00:32:43,919
regularly I'll admit that

823
00:32:43,919 --> 00:32:46,320
um but you as a user you probably see

824
00:32:46,320 --> 00:32:47,820
that you go to a hotel you try to

825
00:32:47,820 --> 00:32:49,620
connect to the Wi-Fi they're running a

826
00:32:49,620 --> 00:32:51,360
captive portal says please click here to

827
00:32:51,360 --> 00:32:52,799
continue so you got to like click around

828
00:32:52,799 --> 00:32:56,700
and Google or in Chrome or Mozilla click

829
00:32:56,700 --> 00:32:58,440
Advanced it's different for each one too

830
00:32:58,440 --> 00:33:00,840
which is also kind of frustrating

831
00:33:00,840 --> 00:33:02,039
um

832
00:33:02,039 --> 00:33:03,659
probably just close browser and walkway

833
00:33:03,659 --> 00:33:05,399
which I guess is kind of the intended

834
00:33:05,399 --> 00:33:07,500
purpose of that make it too hard to do

835
00:33:07,500 --> 00:33:10,100
unsafe things

836
00:33:10,799 --> 00:33:12,419
so

837
00:33:12,419 --> 00:33:14,220
um

838
00:33:14,220 --> 00:33:16,980
the need has been demonstrated uh we

839
00:33:16,980 --> 00:33:18,600
need a better accounting mechanism for

840
00:33:18,600 --> 00:33:19,799
this it needs to be publicly available

841
00:33:19,799 --> 00:33:22,080
needs to be trusted

842
00:33:22,080 --> 00:33:24,299
um we probably shouldn't let the cas run

843
00:33:24,299 --> 00:33:26,159
it they've kind of in the past

844
00:33:26,159 --> 00:33:28,140
demonstrated that

845
00:33:28,140 --> 00:33:29,760
they're not some of them are not to be

846
00:33:29,760 --> 00:33:30,960
trusted

847
00:33:30,960 --> 00:33:32,399
um so

848
00:33:32,399 --> 00:33:34,260
how does this all work um a website

849
00:33:34,260 --> 00:33:36,779
owner basically used them in a CSR or um

850
00:33:36,779 --> 00:33:38,399
a request

851
00:33:38,399 --> 00:33:40,200
they'll issue a pre-certificate which is

852
00:33:40,200 --> 00:33:42,120
a certificate it's just not a real one

853
00:33:42,120 --> 00:33:43,500
there's a couple of bits and bytes in

854
00:33:43,500 --> 00:33:44,880
there that indicate that it's not to be

855
00:33:44,880 --> 00:33:47,760
used as an actual secure certificate

856
00:33:47,760 --> 00:33:49,740
um the ca then publishes that

857
00:33:49,740 --> 00:33:52,200
certificate that pre-certificate to a

858
00:33:52,200 --> 00:33:53,760
log

859
00:33:53,760 --> 00:33:56,460
um that log takes that pre-certificate

860
00:33:56,460 --> 00:33:59,100
it basically stamps it with a timestamp

861
00:33:59,100 --> 00:34:01,320
on there and sends it right back to the

862
00:34:01,320 --> 00:34:03,678
ca

863
00:34:03,779 --> 00:34:05,460
now that that

864
00:34:05,460 --> 00:34:07,019
um

865
00:34:07,019 --> 00:34:09,359
certificate timestamp is in that

866
00:34:09,359 --> 00:34:11,879
certificate it has been published to a

867
00:34:11,879 --> 00:34:13,859
log it has been recorded as being in

868
00:34:13,859 --> 00:34:16,379
that log the ca can now send that

869
00:34:16,379 --> 00:34:17,820
certificate on to you to use on your

870
00:34:17,820 --> 00:34:19,139
website

871
00:34:19,139 --> 00:34:21,599
um and then the browsers and user agents

872
00:34:21,599 --> 00:34:24,239
will monitor those certificates

873
00:34:24,239 --> 00:34:26,820
um and then all of these certificate

874
00:34:26,820 --> 00:34:28,679
logs that are out there are all

875
00:34:28,679 --> 00:34:31,139
cryptographically monitored so not to

876
00:34:31,139 --> 00:34:33,060
get too in-depth on that it's basically

877
00:34:33,060 --> 00:34:34,739
a Merkle tree hash

878
00:34:34,739 --> 00:34:35,820
um

879
00:34:35,820 --> 00:34:37,980
the blockchain

880
00:34:37,980 --> 00:34:38,879
um so they're cryptographically

881
00:34:38,879 --> 00:34:40,739
monitored they are append only you

882
00:34:40,739 --> 00:34:42,780
cannot once something is published to a

883
00:34:42,780 --> 00:34:45,540
CT log remove it no matter how much you

884
00:34:45,540 --> 00:34:47,940
beg and plead once it's in there it's in

885
00:34:47,940 --> 00:34:49,139
there forever

886
00:34:49,139 --> 00:34:54,080
um and uh no no edits allowed so

887
00:34:54,480 --> 00:34:56,280
CT log providers the big ones out there

888
00:34:56,280 --> 00:34:58,500
cloudflare digicert Google let's encrypt

889
00:34:58,500 --> 00:35:01,560
satigo trust Asia there's a few others I

890
00:35:01,560 --> 00:35:03,900
didn't really record them we have over

891
00:35:03,900 --> 00:35:04,920
here

892
00:35:04,920 --> 00:35:06,420
the

893
00:35:06,420 --> 00:35:08,700
certificate um the timestamp

894
00:35:08,700 --> 00:35:10,500
requirements so in order for a

895
00:35:10,500 --> 00:35:12,300
certificate to be trusted in the

896
00:35:12,300 --> 00:35:13,760
Chromium browser

897
00:35:13,760 --> 00:35:16,079
the CT

898
00:35:16,079 --> 00:35:18,420
the the SCT has to be published to at

899
00:35:18,420 --> 00:35:21,000
least one log

900
00:35:21,000 --> 00:35:25,220
um and it can um

901
00:35:27,119 --> 00:35:28,920
so sorry

902
00:35:28,920 --> 00:35:31,200
for a certificate validity length of

903
00:35:31,200 --> 00:35:33,960
less than 180 days it has to be

904
00:35:33,960 --> 00:35:36,660
published into two different CT logs so

905
00:35:36,660 --> 00:35:38,940
those would ideally match up and if

906
00:35:38,940 --> 00:35:41,040
they're issuing a certificate for longer

907
00:35:41,040 --> 00:35:42,660
than 180 days which is pretty difficult

908
00:35:42,660 --> 00:35:44,220
to do now these days you can still get

909
00:35:44,220 --> 00:35:46,560
them on an EV certificate but it has to

910
00:35:46,560 --> 00:35:49,380
be published to three different logs so

911
00:35:49,380 --> 00:35:51,300
the ca can publish it to the let's

912
00:35:51,300 --> 00:35:53,160
encrypt log they can publish it did you

913
00:35:53,160 --> 00:35:54,780
certain they can publish it it to

914
00:35:54,780 --> 00:35:57,240
sectigo if they'd like to and that will

915
00:35:57,240 --> 00:35:59,280
return in Chrome uh completely valid

916
00:35:59,280 --> 00:36:01,200
certificate there's a big red bar there

917
00:36:01,200 --> 00:36:03,420
for Mozilla they have not yet at this

918
00:36:03,420 --> 00:36:04,500
point

919
00:36:04,500 --> 00:36:07,560
today's date instituted a CT log

920
00:36:07,560 --> 00:36:10,079
requirement in the Mozilla browser

921
00:36:10,079 --> 00:36:12,599
Safari has one Chrome has one

922
00:36:12,599 --> 00:36:14,460
um not sure what Mozilla is doing but

923
00:36:14,460 --> 00:36:15,660
it's fine

924
00:36:15,660 --> 00:36:19,040
we'll get there they'll get there

925
00:36:19,920 --> 00:36:21,660
certificate logs

926
00:36:21,660 --> 00:36:24,240
um the buy the providers Google

927
00:36:24,240 --> 00:36:26,700
maintains a whole bunch let's encrypt

928
00:36:26,700 --> 00:36:29,220
has a few Cloud flares got a couple um

929
00:36:29,220 --> 00:36:31,680
did you search has a couple

930
00:36:31,680 --> 00:36:33,000
there's a lot of certificates that are

931
00:36:33,000 --> 00:36:35,220
requested every day

932
00:36:35,220 --> 00:36:38,280
there's been 9.2 billion certificates

933
00:36:38,280 --> 00:36:41,700
published since 2013. so you can't stick

934
00:36:41,700 --> 00:36:43,500
them all into one file that would just

935
00:36:43,500 --> 00:36:44,940
make them too long so what basically

936
00:36:44,940 --> 00:36:46,859
what ends up happening is that

937
00:36:46,859 --> 00:36:48,599
certificate

938
00:36:48,599 --> 00:36:51,119
the certificate logs themselves are are

939
00:36:51,119 --> 00:36:54,380
sharded by the year of the certificate

940
00:36:54,380 --> 00:36:56,579
expiration is that kind of track for

941
00:36:56,579 --> 00:36:58,740
everybody if your certificate expires in

942
00:36:58,740 --> 00:37:02,160
2024 it will be published into the for

943
00:37:02,160 --> 00:37:06,859
example argon 2024 certificate log

944
00:37:07,740 --> 00:37:09,780
um I thought this was kind of a useful

945
00:37:09,780 --> 00:37:12,660
and interesting certificate or I'm sorry

946
00:37:12,660 --> 00:37:13,980
a um

947
00:37:13,980 --> 00:37:15,720
uh graphic here just kind of showing the

948
00:37:15,720 --> 00:37:17,820
uptake of the number of certificates

949
00:37:17,820 --> 00:37:20,760
published into each log you can

950
00:37:20,760 --> 00:37:22,440
definitely see that that all started to

951
00:37:22,440 --> 00:37:26,520
take off there in 2019 and they've

952
00:37:26,520 --> 00:37:28,020
basically doubled their traffic every

953
00:37:28,020 --> 00:37:30,560
year since

954
00:37:32,880 --> 00:37:34,619
um I pulled this graphic from cloudflare

955
00:37:34,619 --> 00:37:35,940
they

956
00:37:35,940 --> 00:37:37,200
um have published some useful

957
00:37:37,200 --> 00:37:38,520
information here

958
00:37:38,520 --> 00:37:41,339
um just basically talking about uh you

959
00:37:41,339 --> 00:37:43,460
know

960
00:37:44,220 --> 00:37:47,040
sorry that's 4.1 trillion um valid

961
00:37:47,040 --> 00:37:49,500
certificates floating around out there

962
00:37:49,500 --> 00:37:53,220
uh for 8.5 trillion domains

963
00:37:53,220 --> 00:37:55,260
um

964
00:37:55,260 --> 00:37:57,960
they issue a lot of certificates every

965
00:37:57,960 --> 00:38:00,420
day let's encrypt uh we'll issue between

966
00:38:00,420 --> 00:38:02,700
five and six million certificates a day

967
00:38:02,700 --> 00:38:04,500
so that's a lot of certificates being

968
00:38:04,500 --> 00:38:06,000
issued

969
00:38:06,000 --> 00:38:08,700
um and then this also will show the um

970
00:38:08,700 --> 00:38:12,480
the log utilization by large Cas and

971
00:38:12,480 --> 00:38:13,859
this is basically just kind of showing

972
00:38:13,859 --> 00:38:17,640
here that some Cas prefer publishing to

973
00:38:17,640 --> 00:38:21,260
others to certain CT logs over others

974
00:38:21,260 --> 00:38:23,520
and some of them are just kind of round

975
00:38:23,520 --> 00:38:26,960
robin they'll publish to all of them

976
00:38:27,020 --> 00:38:29,220
the CT

977
00:38:29,220 --> 00:38:31,020
log stream if you want to go out there

978
00:38:31,020 --> 00:38:33,560
and monitor the CT logs yourself

979
00:38:33,560 --> 00:38:36,780
the best way to do that that I found up

980
00:38:36,780 --> 00:38:40,800
to this point is a

981
00:38:40,800 --> 00:38:44,280
a service from calidog um it's uh search

982
00:38:44,280 --> 00:38:46,740
stream servers written in Elixir you can

983
00:38:46,740 --> 00:38:48,359
plug it in it'll monitor every CT log

984
00:38:48,359 --> 00:38:50,339
out there if you want to go parse the CT

985
00:38:50,339 --> 00:38:52,920
logs for your own domains be my guest

986
00:38:52,920 --> 00:38:56,700
it's kind of a pain though so

987
00:38:56,700 --> 00:39:00,119
I've got up here um a couple of

988
00:39:00,119 --> 00:39:02,040
um interesting useful utilities they're

989
00:39:02,040 --> 00:39:03,540
probably the best well-known one no

990
00:39:03,540 --> 00:39:06,359
well-known one is uh crt.sh that's

991
00:39:06,359 --> 00:39:07,680
bisectigo

992
00:39:07,680 --> 00:39:10,859
uh Cali dog also publishes a bunch of

993
00:39:10,859 --> 00:39:13,859
libraries for python go JavaScript

994
00:39:13,859 --> 00:39:16,560
um and they'll laugh at you if you try

995
00:39:16,560 --> 00:39:18,599
to use Java it's on their website I

996
00:39:18,599 --> 00:39:20,099
didn't make that up

997
00:39:20,099 --> 00:39:22,680
but there's also cert spotter that's by

998
00:39:22,680 --> 00:39:25,859
SSL mate or cert Eagle there's a few

999
00:39:25,859 --> 00:39:28,500
others out there meta has a search if

1000
00:39:28,500 --> 00:39:31,320
you own a domain you can go check plug

1001
00:39:31,320 --> 00:39:33,180
your domain in you can see how many

1002
00:39:33,180 --> 00:39:35,820
certificates have been issued for your

1003
00:39:35,820 --> 00:39:36,839
domain

1004
00:39:36,839 --> 00:39:39,320
if you'd like to monitor the pre-logs

1005
00:39:39,320 --> 00:39:43,079
you'll need to use the fort or sorry the

1006
00:39:43,079 --> 00:39:46,020
certificate transparency log go by

1007
00:39:46,020 --> 00:39:48,720
Google they forked the go libraries for

1008
00:39:48,720 --> 00:39:54,140
ASN encoding and crypto x509 because the

1009
00:39:54,140 --> 00:39:59,359
scts don't really conform to

1010
00:39:59,700 --> 00:40:01,680
valid spec so they had to make some

1011
00:40:01,680 --> 00:40:03,300
adjustments there

1012
00:40:03,300 --> 00:40:05,520
I've got a quick demo here I want to run

1013
00:40:05,520 --> 00:40:06,660
through that I've got just about 10

1014
00:40:06,660 --> 00:40:09,420
minutes left and so basically what I

1015
00:40:09,420 --> 00:40:10,980
wanted to take everybody through

1016
00:40:10,980 --> 00:40:13,140
um is the process of requesting a

1017
00:40:13,140 --> 00:40:14,339
certificate

1018
00:40:14,339 --> 00:40:17,520
through let's encrypt and then using

1019
00:40:17,520 --> 00:40:22,380
that on a honey pot showing that

1020
00:40:22,380 --> 00:40:24,960
basically once we go issue a certificate

1021
00:40:24,960 --> 00:40:28,380
there are eyes watching out there so let

1022
00:40:28,380 --> 00:40:30,300
me just go ahead and get out of the

1023
00:40:30,300 --> 00:40:31,859
slideshow real quick and we'll go ahead

1024
00:40:31,859 --> 00:40:34,640
and get that started

1025
00:40:39,960 --> 00:40:42,119
is that big enough oh I'm sorry that's

1026
00:40:42,119 --> 00:40:45,060
on my screen this might be interesting

1027
00:40:45,060 --> 00:40:47,420
okay

1028
00:40:50,520 --> 00:40:53,480
a big black box

1029
00:40:57,000 --> 00:40:59,420
here

1030
00:41:11,339 --> 00:41:12,960
so we're going to go ahead and generate

1031
00:41:12,960 --> 00:41:15,240
a cert for a domain that I registered a

1032
00:41:15,240 --> 00:41:17,700
little while ago and that will basically

1033
00:41:17,700 --> 00:41:21,740
point to a Honeypot that I have

1034
00:41:23,280 --> 00:41:26,060
thank you

1035
00:41:29,520 --> 00:41:33,020
all right and we're off and going

1036
00:41:33,900 --> 00:41:36,300
so as you can see up there

1037
00:41:36,300 --> 00:41:39,599
um I've registered the domain b-sides uh

1038
00:41:39,599 --> 00:41:42,780
SF 2023-ct logs.com

1039
00:41:42,780 --> 00:41:46,079
I've generated a random sub domain for

1040
00:41:46,079 --> 00:41:49,260
that and

1041
00:41:49,920 --> 00:41:51,720
that didn't quite work I have another

1042
00:41:51,720 --> 00:41:54,799
one for this hold on one second

1043
00:41:58,680 --> 00:42:01,819
I lost my mouse

1044
00:42:02,700 --> 00:42:03,900
that would probably be a whole lot

1045
00:42:03,900 --> 00:42:06,560
easier wouldn't it

1046
00:42:14,160 --> 00:42:17,118
hey there we go

1047
00:42:31,859 --> 00:42:34,040
foreign

1048
00:42:35,000 --> 00:42:37,740
the original demo didn't want to work

1049
00:42:37,740 --> 00:42:40,260
same setup uh randomly generated

1050
00:42:40,260 --> 00:42:42,480
subdomain we'll be publishing an a

1051
00:42:42,480 --> 00:42:46,079
record to cloudflare and then using that

1052
00:42:46,079 --> 00:42:47,880
for text-based verification through

1053
00:42:47,880 --> 00:42:49,680
let's encrypt

1054
00:42:49,680 --> 00:42:51,799
um

1055
00:42:52,200 --> 00:42:55,079
there goes the DNS Challenge and then

1056
00:42:55,079 --> 00:42:58,079
that will go ahead and start stop and

1057
00:42:58,079 --> 00:43:00,359
we'll we'll refresh everything in just

1058
00:43:00,359 --> 00:43:01,819
one moment

1059
00:43:01,819 --> 00:43:05,280
this Honeypot that's running I found a

1060
00:43:05,280 --> 00:43:06,720
very good utility I was going to write

1061
00:43:06,720 --> 00:43:08,460
my own and realized that that was way

1062
00:43:08,460 --> 00:43:09,780
more effort than I wanted to put into

1063
00:43:09,780 --> 00:43:11,180
this

1064
00:43:11,180 --> 00:43:14,280
I'll put it in the uh in the slides here

1065
00:43:14,280 --> 00:43:16,920
but there's a very very good

1066
00:43:16,920 --> 00:43:18,839
um Honeypot utility out there published

1067
00:43:18,839 --> 00:43:21,960
by Deutsch Telecom it's called teapot CE

1068
00:43:21,960 --> 00:43:25,260
the letter t pot and then the letters c

1069
00:43:25,260 --> 00:43:30,420
e that basically has 30 or 40 some odd

1070
00:43:30,420 --> 00:43:32,460
honeypots that all run in different

1071
00:43:32,460 --> 00:43:34,500
Docker containers they've got a

1072
00:43:34,500 --> 00:43:36,060
fantastic web UI we'll go through that

1073
00:43:36,060 --> 00:43:39,000
in just a moment but basically what that

1074
00:43:39,000 --> 00:43:41,160
does is it spins up a whole bunch of

1075
00:43:41,160 --> 00:43:43,920
Docker containers that are meant to look

1076
00:43:43,920 --> 00:43:45,859
like

1077
00:43:45,859 --> 00:43:50,160
elasticsearch or redis or

1078
00:43:50,160 --> 00:43:50,760
um

1079
00:43:50,760 --> 00:43:53,220
a whole bunch of other things it will

1080
00:43:53,220 --> 00:43:55,859
also monitor the

1081
00:43:55,859 --> 00:43:58,500
um SSH telnet logins and things like

1082
00:43:58,500 --> 00:44:02,300
that I will go ahead and grab this here

1083
00:44:12,660 --> 00:44:14,220
I clicked through it I just said that

1084
00:44:14,220 --> 00:44:16,260
right

1085
00:44:16,260 --> 00:44:18,240
oops yeah I clicked the wrong one let's

1086
00:44:18,240 --> 00:44:19,319
try that again

1087
00:44:19,319 --> 00:44:22,020
this should be the right one

1088
00:44:22,020 --> 00:44:23,520
you might have to wait just a moment

1089
00:44:23,520 --> 00:44:25,140
here for

1090
00:44:25,140 --> 00:44:28,980
Cabana to come back up it's uh it's been

1091
00:44:28,980 --> 00:44:31,020
collecting attacks for quite a while so

1092
00:44:31,020 --> 00:44:33,839
the index is is rather large this is the

1093
00:44:33,839 --> 00:44:35,880
general kind of just teapot user

1094
00:44:35,880 --> 00:44:37,200
interface

1095
00:44:37,200 --> 00:44:38,880
um and then we'll go ahead and just take

1096
00:44:38,880 --> 00:44:43,520
a look here at the dashboards

1097
00:44:46,920 --> 00:44:49,520
I'm sorry

1098
00:45:01,140 --> 00:45:04,098
to be what we want

1099
00:45:30,660 --> 00:45:33,618
all right so

1100
00:45:36,300 --> 00:45:38,099
once we load in

1101
00:45:38,099 --> 00:45:40,500
um there are quite a few dashboards

1102
00:45:40,500 --> 00:45:42,420
we'll give that just a moment there to

1103
00:45:42,420 --> 00:45:43,800
catch up

1104
00:45:43,800 --> 00:45:47,480
talk about those there real quick

1105
00:46:00,119 --> 00:46:02,940
so in the week and a half that this has

1106
00:46:02,940 --> 00:46:04,200
been running

1107
00:46:04,200 --> 00:46:07,560
um they well in the last 24 hours

1108
00:46:07,560 --> 00:46:10,500
um this particular Honeypot has been

1109
00:46:10,500 --> 00:46:13,760
attacked 17 and a half thousand times

1110
00:46:13,760 --> 00:46:17,760
you can see these rather large spikes in

1111
00:46:17,760 --> 00:46:19,980
here this is while I was um

1112
00:46:19,980 --> 00:46:23,640
working on the presentation this morning

1113
00:46:23,640 --> 00:46:25,500
and last night as well

1114
00:46:25,500 --> 00:46:28,940
um and so oops

1115
00:46:33,359 --> 00:46:35,520
let's just look at the last uh two hours

1116
00:46:35,520 --> 00:46:37,880
here

1117
00:46:44,280 --> 00:46:45,800
so if we go out

1118
00:46:45,800 --> 00:46:48,960
and issue a certificate

1119
00:46:48,960 --> 00:46:50,099
um

1120
00:46:50,099 --> 00:46:53,640
pointing at this IP address we can see

1121
00:46:53,640 --> 00:46:56,220
that there's been about a thousand

1122
00:46:56,220 --> 00:46:59,760
instances for this Purdue so each the

1123
00:46:59,760 --> 00:47:01,200
the top bar up here is basically just

1124
00:47:01,200 --> 00:47:02,520
representing each of those is a

1125
00:47:02,520 --> 00:47:04,260
different honey pot that is running on

1126
00:47:04,260 --> 00:47:05,359
the system

1127
00:47:05,359 --> 00:47:08,579
we've got a very nice map of generally

1128
00:47:08,579 --> 00:47:10,020
speaking where those attacks are coming

1129
00:47:10,020 --> 00:47:14,819
from and the user agents

1130
00:47:14,819 --> 00:47:17,940
um country of origin what kind of attack

1131
00:47:17,940 --> 00:47:20,160
it was going and then the rather amusing

1132
00:47:20,160 --> 00:47:22,920
tag cloud of usernames and passwords

1133
00:47:22,920 --> 00:47:25,380
down there that have been attempted to

1134
00:47:25,380 --> 00:47:30,180
be used to log into SSH and some of the

1135
00:47:30,180 --> 00:47:31,380
other

1136
00:47:31,380 --> 00:47:33,740
https

1137
00:47:33,740 --> 00:47:36,119
logins there's um there's a Blog that's

1138
00:47:36,119 --> 00:47:39,660
running on there there's a Cisco ASA

1139
00:47:39,660 --> 00:47:41,700
firewall that's running on there and so

1140
00:47:41,700 --> 00:47:43,200
this is basically just collecting all of

1141
00:47:43,200 --> 00:47:44,480
the attempts

1142
00:47:44,480 --> 00:47:47,099
there are another few dashboards in here

1143
00:47:47,099 --> 00:47:50,339
if you really want to drill into other

1144
00:47:50,339 --> 00:47:51,839
um

1145
00:47:51,839 --> 00:47:54,900
honey pots by buy Honeypot in there you

1146
00:47:54,900 --> 00:47:57,060
can see exactly what that had been

1147
00:47:57,060 --> 00:47:58,339
collecting

1148
00:47:58,339 --> 00:48:03,480
and everything else the

1149
00:48:07,619 --> 00:48:10,800
come on it's just taking a little while

1150
00:48:10,800 --> 00:48:12,380
um I wish I had some more time

1151
00:48:12,380 --> 00:48:16,440
I will leave this up if you want to take

1152
00:48:16,440 --> 00:48:19,619
a picture of the URL up there you're

1153
00:48:19,619 --> 00:48:21,079
welcome to do that

1154
00:48:21,079 --> 00:48:23,880
might be a little bit of a CTF to figure

1155
00:48:23,880 --> 00:48:26,280
out what the actual web and password is

1156
00:48:26,280 --> 00:48:29,119
on there

1157
00:48:32,460 --> 00:48:35,099
okay let's uh we'll get back to the demo

1158
00:48:35,099 --> 00:48:37,079
here real quick or sorry the the

1159
00:48:37,079 --> 00:48:38,460
presentation

1160
00:48:38,460 --> 00:48:40,520
um

1161
00:48:42,180 --> 00:48:43,740
we'll talk about red team and blue team

1162
00:48:43,740 --> 00:48:45,240
real quick and then we'll have a minute

1163
00:48:45,240 --> 00:48:48,618
or two for questions at the end so

1164
00:48:50,780 --> 00:48:53,590
so if you find yourself defending

1165
00:48:53,590 --> 00:48:54,119
[Music]

1166
00:48:54,119 --> 00:48:54,900
um

1167
00:48:54,900 --> 00:48:56,339
on the defensive side of the security

1168
00:48:56,339 --> 00:48:57,480
space

1169
00:48:57,480 --> 00:48:58,440
um

1170
00:48:58,440 --> 00:49:01,380
my recommendations would be to find

1171
00:49:01,380 --> 00:49:03,540
some sort of tool or tool out there

1172
00:49:03,540 --> 00:49:05,460
whether it's paid or free there's a

1173
00:49:05,460 --> 00:49:07,920
whole bunch of self-hosted options

1174
00:49:07,920 --> 00:49:09,000
um

1175
00:49:09,000 --> 00:49:11,099
and I'd like to press impress on you

1176
00:49:11,099 --> 00:49:13,140
that if you go out and monitor your

1177
00:49:13,140 --> 00:49:15,359
organization or your own domains just

1178
00:49:15,359 --> 00:49:17,760
once a month or once every quarter that

1179
00:49:17,760 --> 00:49:19,079
is far better than doing absolutely

1180
00:49:19,079 --> 00:49:22,079
nothing at all you probably don't need

1181
00:49:22,079 --> 00:49:24,119
to put the effort into monitoring the

1182
00:49:24,119 --> 00:49:28,500
actual live stream of CT logs on Akron

1183
00:49:28,500 --> 00:49:31,920
15 20 30 minutes should be probably just

1184
00:49:31,920 --> 00:49:34,920
fine how long it takes you to find out

1185
00:49:34,920 --> 00:49:38,220
if somebody in your organization if

1186
00:49:38,220 --> 00:49:39,660
sales has gone out and stood up another

1187
00:49:39,660 --> 00:49:42,599
subdomain probably doesn't matter too

1188
00:49:42,599 --> 00:49:45,060
much how long it takes you to find that

1189
00:49:45,060 --> 00:49:47,520
out if fixing that problem is going to

1190
00:49:47,520 --> 00:49:49,859
take a few months

1191
00:49:49,859 --> 00:49:51,180
um

1192
00:49:51,180 --> 00:49:54,020
you can also

1193
00:49:54,020 --> 00:49:56,599
see if

1194
00:49:56,599 --> 00:49:59,520
CAA records work for your organization

1195
00:49:59,520 --> 00:50:02,280
for your use case a CIA record basically

1196
00:50:02,280 --> 00:50:06,119
says only this provider is allowed to

1197
00:50:06,119 --> 00:50:08,280
issue certificates so you can say only

1198
00:50:08,280 --> 00:50:10,380
let's encrypt for these subdomains I'm

1199
00:50:10,380 --> 00:50:12,599
getting the old stop sign here I do

1200
00:50:12,599 --> 00:50:14,040
apologize that we didn't quite get to

1201
00:50:14,040 --> 00:50:16,020
finish I'll stick around or at least

1202
00:50:16,020 --> 00:50:17,540
outside if you have some more questions

1203
00:50:17,540 --> 00:50:19,859
I've uploaded the rest of these slides

1204
00:50:19,859 --> 00:50:23,160
and everything else to the presentation

1205
00:50:23,160 --> 00:50:25,920
are too too scared so if you would like

1206
00:50:25,920 --> 00:50:28,079
to go through these you're more than

1207
00:50:28,079 --> 00:50:31,260
welcome to peruse them at your leisure

1208
00:50:31,260 --> 00:50:32,760
thank you so much for coming today and

1209
00:50:32,760 --> 00:50:34,330
enjoy the rest of your day

1210
00:50:34,330 --> 00:50:37,440
[Applause]

