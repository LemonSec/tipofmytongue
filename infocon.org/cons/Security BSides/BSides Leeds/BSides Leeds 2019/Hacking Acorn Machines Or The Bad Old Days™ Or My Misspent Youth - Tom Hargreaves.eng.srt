1
00:00:02,560 --> 00:00:08,740
this is a talk about hacking acorn

2
00:00:05,980 --> 00:00:12,550
machines or the bad old days or my

3
00:00:08,740 --> 00:00:18,990
misspent youth and is all about what I

4
00:00:12,550 --> 00:00:22,660
got upped a teenager so first of all

5
00:00:18,990 --> 00:00:26,409
what do I mean by hacking there are two

6
00:00:22,660 --> 00:00:28,180
schools of thought on whether the versus

7
00:00:26,410 --> 00:00:30,490
crack no debate which I am absolutely

8
00:00:28,180 --> 00:00:32,650
not going to get into it but given that

9
00:00:30,490 --> 00:00:38,980
this is a security conference there will

10
00:00:32,650 --> 00:00:43,300
be supplies so does anyone remember

11
00:00:38,980 --> 00:00:47,019
these guys if you did not grow up in the

12
00:00:43,300 --> 00:00:49,360
UK in the edges of 90s you may not have

13
00:00:47,020 --> 00:00:51,700
run into these but these would be BC

14
00:00:49,360 --> 00:00:56,920
micros they were in primary schools to

15
00:00:51,700 --> 00:00:59,500
help the land and a lot of people cut

16
00:00:56,920 --> 00:01:07,450
their teeth from them as an introduction

17
00:00:59,500 --> 00:01:09,340
to computers and ACON where they come

18
00:01:07,450 --> 00:01:12,400
word that competed made the BBC micro

19
00:01:09,340 --> 00:01:17,140
but they were also plan is the field of

20
00:01:12,400 --> 00:01:20,799
networking and they had a thing called a

21
00:01:17,140 --> 00:01:23,890
kinetic Annette I am not sure if I think

22
00:01:20,799 --> 00:01:25,900
given that sir this was one of their

23
00:01:23,890 --> 00:01:27,759
promotional materials that they were

24
00:01:25,900 --> 00:01:30,280
probably going for the Eco part the

25
00:01:27,759 --> 00:01:34,600
low-cost but in my world it has always

26
00:01:30,280 --> 00:01:36,820
been a cadet so I do not know what they

27
00:01:34,600 --> 00:01:39,100
were playing with this from the early

28
00:01:36,820 --> 00:01:42,309
80s they were playing they were

29
00:01:39,100 --> 00:01:44,798
developing this in like 1980 1981 before

30
00:01:42,310 --> 00:01:47,380
even the BBC micro existed you'll note

31
00:01:44,799 --> 00:01:49,030
that these little schematic machines at

32
00:01:47,380 --> 00:01:52,119
the bottom were not in fact BBC might

33
00:01:49,030 --> 00:01:57,750
hood micros they were acorn atoms which

34
00:01:52,119 --> 00:02:00,340
was the predecessor to the BBC micro so

35
00:01:57,750 --> 00:02:04,030
change we're doing networking before

36
00:02:00,340 --> 00:02:07,090
people knew what networking was and

37
00:02:04,030 --> 00:02:10,179
because they were big in education a lot

38
00:02:07,090 --> 00:02:14,620
of schools also had networks of these

39
00:02:10,179 --> 00:02:26,140
machines and I got to play with them

40
00:02:14,620 --> 00:02:30,410
and doing this this is how they did

41
00:02:26,140 --> 00:02:32,000
networking in the 80s these are a bunch

42
00:02:30,410 --> 00:02:35,780
of what are called immediate packets

43
00:02:32,000 --> 00:02:39,440
which you could send from one station to

44
00:02:35,780 --> 00:02:41,870
another and it would do anything and if

45
00:02:39,440 --> 00:02:47,060
you look this command list you will

46
00:02:41,870 --> 00:02:49,880
think this doesn't look like the command

47
00:02:47,060 --> 00:02:52,520
list for any Network protocol you know

48
00:02:49,880 --> 00:02:57,079
this looks more like the command list

49
00:02:52,520 --> 00:03:01,550
for a debugger you shall peek and poke

50
00:02:57,080 --> 00:03:04,190
pipes on a remote machine that's jsr you

51
00:03:01,550 --> 00:03:08,150
see there is jump to cebu T so you can

52
00:03:04,190 --> 00:03:11,140
execute arbitrary code by poking bytes

53
00:03:08,150 --> 00:03:14,540
into your machine your target and

54
00:03:11,140 --> 00:03:16,250
stopping it also has pathologies for

55
00:03:14,540 --> 00:03:17,500
stopping the sting of stepping and so on

56
00:03:16,250 --> 00:03:20,110
which I'm sure was incredibly useful

57
00:03:17,500 --> 00:03:23,570
when they were developing all of this

58
00:03:20,110 --> 00:03:33,640
but arguably has no place in a classroom

59
00:03:23,570 --> 00:03:39,049
full of girls but it was fun they had

60
00:03:33,640 --> 00:03:40,880
things they had built-in facilities that

61
00:03:39,050 --> 00:03:43,610
allowed you to take remote control of

62
00:03:40,880 --> 00:03:45,980
another computer hips keyboard can be

63
00:03:43,610 --> 00:03:48,170
locked out and your keyboard will send

64
00:03:45,980 --> 00:03:52,519
input to it and you'd get to see the

65
00:03:48,170 --> 00:03:55,100
speed that it produced and the way that

66
00:03:52,520 --> 00:03:57,490
they did this is they did not have the

67
00:03:55,100 --> 00:04:00,230
wrong space to implement any of this on

68
00:03:57,490 --> 00:04:02,660
the Machinists themselves instead they

69
00:04:00,230 --> 00:04:05,420
use this remote code execution to send

70
00:04:02,660 --> 00:04:09,560
over code and have it running on the

71
00:04:05,420 --> 00:04:12,950
remote machine and the only way that you

72
00:04:09,560 --> 00:04:17,870
were expected to keep your classroom

73
00:04:12,950 --> 00:04:20,120
chaos free is by declining to host the

74
00:04:17,870 --> 00:04:21,850
utilities that did this on the shared

75
00:04:20,120 --> 00:04:26,790
network wowza

76
00:04:21,850 --> 00:04:29,130
he pulled networks work

77
00:04:26,790 --> 00:04:31,200
that the concept that you would

78
00:04:29,130 --> 00:04:33,630
introduce things from outside either

79
00:04:31,200 --> 00:04:35,190
I mean machines did not have disk drives

80
00:04:33,630 --> 00:04:36,960
the entire point of having a network is

81
00:04:35,190 --> 00:04:39,080
that you did not need a describe her

82
00:04:36,960 --> 00:04:45,570
machine of death drives were expensive

83
00:04:39,080 --> 00:04:49,560
so you basically had one single shared

84
00:04:45,570 --> 00:04:51,300
file store and if the utilities to do

85
00:04:49,560 --> 00:04:54,510
all of the fun stuff were not available

86
00:04:51,300 --> 00:04:57,360
on it then you were basically out of

87
00:04:54,510 --> 00:04:59,280
luck unless you were to do things like

88
00:04:57,360 --> 00:05:06,180
tell your woman all to class and uh

89
00:04:59,280 --> 00:05:08,280
float things from tech but this is just

90
00:05:06,180 --> 00:05:11,130
a sign now I am NOT going to talk about

91
00:05:08,280 --> 00:05:12,000
a kinetically the big because it is

92
00:05:11,130 --> 00:05:14,840
before my time

93
00:05:12,000 --> 00:05:19,080
I did get to play with it a little bit

94
00:05:14,840 --> 00:05:21,750
but this is just an indication to set

95
00:05:19,080 --> 00:05:27,870
the scene this is what they were doing

96
00:05:21,750 --> 00:05:30,990
in ages this is what they were doing in

97
00:05:27,870 --> 00:05:33,930
the 90s they had moved on from the 8-bit

98
00:05:30,990 --> 00:05:36,390
machines as you may know acorn were

99
00:05:33,930 --> 00:05:40,080
different the ARM architecture and this

100
00:05:36,390 --> 00:05:43,890
was the risk PC introduced in 1984 which

101
00:05:40,080 --> 00:05:49,280
was a 32-bit machine wearing a comm 610

102
00:05:43,890 --> 00:05:52,229
which was on the we know on before and

103
00:05:49,280 --> 00:05:54,929
these things to really have to fight

104
00:05:52,229 --> 00:05:59,280
megabytes of RAM and a couple hundred

105
00:05:54,930 --> 00:06:02,729
makes a hard disk and when I was

106
00:05:59,280 --> 00:06:06,179
boarding school I returned from summer

107
00:06:02,729 --> 00:06:09,140
break in 1994 defines that we had

108
00:06:06,180 --> 00:06:13,830
acquired a room full of ten of them and

109
00:06:09,140 --> 00:06:20,340
I thought they were better than bread be

110
00:06:13,830 --> 00:06:22,169
is sliced or otherwise and I had a whole

111
00:06:20,340 --> 00:06:27,289
lot of fun with them over the years and

112
00:06:22,169 --> 00:06:34,830
I am going to show you so first of all

113
00:06:27,289 --> 00:06:37,380
these things were networked they a cause

114
00:06:34,830 --> 00:06:39,878
the original econet Oreca net was

115
00:06:37,380 --> 00:06:42,939
basically a glorified serial link

116
00:06:39,879 --> 00:06:45,219
they had moved on from this by then they

117
00:06:42,939 --> 00:06:47,589
had seed that direction that industry

118
00:06:45,219 --> 00:06:50,459
was headed and everything was now

119
00:06:47,589 --> 00:06:54,669
running over boxed under 10base2

120
00:06:50,459 --> 00:06:58,179
at the link layer at this flew a layer

121
00:06:54,669 --> 00:07:02,889
they were still using the ethernet

122
00:06:58,179 --> 00:07:04,239
vertical tunnels over UDP I believe well

123
00:07:02,889 --> 00:07:07,059
certainly they did have a plumbing over

124
00:07:04,240 --> 00:07:09,009
UDP they may also have Hadley tooling or

125
00:07:07,059 --> 00:07:11,439
overbought Ethernet I don't know I

126
00:07:09,009 --> 00:07:14,709
actually understand that layer at the

127
00:07:11,439 --> 00:07:18,099
time so instead I'm going to talk about

128
00:07:14,709 --> 00:07:26,679
some of the highlights such cuz the file

129
00:07:18,099 --> 00:07:30,188
server so first things first this is a

130
00:07:26,679 --> 00:07:33,429
quote from the level 4 file server

131
00:07:30,189 --> 00:07:38,019
managers died which was the software

132
00:07:33,429 --> 00:07:42,308
that's beautiful plan to provide a file

133
00:07:38,019 --> 00:07:44,229
store or users well we disapp it says to

134
00:07:42,309 --> 00:07:45,729
prevent unauthorized people tampering

135
00:07:44,229 --> 00:07:47,919
with information stored on the file

136
00:07:45,729 --> 00:07:50,169
server keep the file server stationed in

137
00:07:47,919 --> 00:07:51,459
a locked room even if you run the file

138
00:07:50,169 --> 00:07:53,139
server on the station without the

139
00:07:51,459 --> 00:07:54,699
keyboard in mind it it's a sensible to

140
00:07:53,139 --> 00:07:56,740
take this precaution to prevent anyone

141
00:07:54,699 --> 00:07:59,860
attaching a keyboard or monitor and so

142
00:07:56,740 --> 00:08:06,430
gaining access to files did they do this

143
00:07:59,860 --> 00:08:08,679
no they did not have these had computers

144
00:08:06,430 --> 00:08:11,499
as I mentioned they were all in the same

145
00:08:08,679 --> 00:08:14,169
room they all had keyboards the monitors

146
00:08:11,499 --> 00:08:17,860
in fact a court did not even sell

147
00:08:14,169 --> 00:08:19,419
service so the file server had more

148
00:08:17,860 --> 00:08:21,279
memories and all of the others it had

149
00:08:19,419 --> 00:08:23,258
more discs the others all of which were

150
00:08:21,279 --> 00:08:25,629
useful it all sounded larger monitor

151
00:08:23,259 --> 00:08:29,139
after meals which was entirely unused

152
00:08:25,629 --> 00:08:32,759
because they just sat that because if

153
00:08:29,139 --> 00:08:36,250
you used it this course was a

154
00:08:32,759 --> 00:08:38,229
cooperative multitasking system so if

155
00:08:36,250 --> 00:08:40,240
you decided that you wanted to use the

156
00:08:38,229 --> 00:08:41,740
file server for something more mild

157
00:08:40,240 --> 00:08:44,680
serving would stop while you were doing

158
00:08:41,740 --> 00:08:47,800
something else so the file server was

159
00:08:44,680 --> 00:08:51,130
off-limits but I should mention this is

160
00:08:47,800 --> 00:08:52,709
a boarding school I was at it was

161
00:08:51,130 --> 00:09:00,840
possible to get in after

162
00:08:52,710 --> 00:09:04,140
yes so I got to claim that the file

163
00:09:00,840 --> 00:09:07,080
server and when you load up the file

164
00:09:04,140 --> 00:09:09,240
server you can get to all of people's

165
00:09:07,080 --> 00:09:11,220
files but you can also get to all the

166
00:09:09,240 --> 00:09:13,050
people's accounts as there is an

167
00:09:11,220 --> 00:09:14,460
application or manager that lets you

168
00:09:13,050 --> 00:09:17,250
manage the it capsule there is what it

169
00:09:14,460 --> 00:09:19,650
looks like and you will notice there

170
00:09:17,250 --> 00:09:22,800
that the password is displayed as a

171
00:09:19,650 --> 00:09:29,280
whole bunch of dashes I guess they

172
00:09:22,800 --> 00:09:32,250
didn't like asterisks but it turns out

173
00:09:29,280 --> 00:09:35,339
they were actually storing plus they

174
00:09:32,250 --> 00:09:37,620
were actually not cashier passwords they

175
00:09:35,340 --> 00:09:44,250
had to be plain text passwords available

176
00:09:37,620 --> 00:09:46,050
and they were lying on the GUI to rip

177
00:09:44,250 --> 00:09:48,780
splice the characters in the password

178
00:09:46,050 --> 00:09:52,849
with dashes so approximately two minutes

179
00:09:48,780 --> 00:09:52,850
with a window editor says it'll do this

180
00:09:53,180 --> 00:10:00,989
snow that is all that one good and I

181
00:09:59,550 --> 00:10:08,219
promptly brought a list of people's

182
00:10:00,990 --> 00:10:11,450
passwords suit two minutes for the two

183
00:10:08,220 --> 00:10:15,360
minutes with a window editor to get at I

184
00:10:11,450 --> 00:10:19,290
decided that I wanted to be able to get

185
00:10:15,360 --> 00:10:20,940
the passwords off without actually

186
00:10:19,290 --> 00:10:22,469
having access to the machine because you

187
00:10:20,940 --> 00:10:24,240
know people will change the passwords

188
00:10:22,470 --> 00:10:28,170
and it's possible that I will not get

189
00:10:24,240 --> 00:10:30,810
the machine again so that will say

190
00:10:28,170 --> 00:10:33,329
facility for sharing a drive read-only

191
00:10:30,810 --> 00:10:34,770
so I went back to all of the machines in

192
00:10:33,330 --> 00:10:36,360
the room and got them to share their

193
00:10:34,770 --> 00:10:39,689
entire hard drives over the network

194
00:10:36,360 --> 00:10:42,090
including the file servers unfortunately

195
00:10:39,690 --> 00:10:44,670
this manager program would not run over

196
00:10:42,090 --> 00:10:47,790
the network it needed to be run on the

197
00:10:44,670 --> 00:10:49,380
file server which means that if I were

198
00:10:47,790 --> 00:10:51,870
to get the passwords out I would have to

199
00:10:49,380 --> 00:10:54,570
crack the password I suppose I was like

200
00:10:51,870 --> 00:10:57,690
this those of you who follow me on

201
00:10:54,570 --> 00:10:59,730
Twitter and there are here to be a few

202
00:10:57,690 --> 00:11:02,910
more of you than there were a few weeks

203
00:10:59,730 --> 00:11:04,860
ago as a result of this talk which is

204
00:11:02,910 --> 00:11:05,390
good because I haven't had you posted it

205
00:11:04,860 --> 00:11:08,450
on too

206
00:11:05,390 --> 00:11:11,060
ages except this which I posted

207
00:11:08,450 --> 00:11:13,130
yesterday I don't know I had a chance to

208
00:11:11,060 --> 00:11:14,569
look at but if you did then enough you

209
00:11:13,130 --> 00:11:19,579
will have a head start on what I'm about

210
00:11:14,570 --> 00:11:22,550
to say this is the password file font a

211
00:11:19,579 --> 00:11:24,469
level 4 file server and you will see

212
00:11:22,550 --> 00:11:27,680
that it has some user names that are

213
00:11:24,470 --> 00:11:31,640
backwards and it has a whole bunch of

214
00:11:27,680 --> 00:11:32,300
other rubbish in what do you do with

215
00:11:31,640 --> 00:11:36,439
such ethic

216
00:11:32,300 --> 00:11:39,199
it's turns out they are using encryption

217
00:11:36,440 --> 00:11:45,200
what encryption are they using they are

218
00:11:39,200 --> 00:11:48,230
using XOR with a constant bite I should

219
00:11:45,200 --> 00:11:51,230
point out this was 1995 UNIX crypt have

220
00:11:48,230 --> 00:11:52,970
been around for 20 years why exactly did

221
00:11:51,230 --> 00:11:56,450
they do it this way I have no freaking

222
00:11:52,970 --> 00:11:59,899
idea acorn was notorious for living in

223
00:11:56,450 --> 00:12:01,640
their own little world not taking notice

224
00:11:59,899 --> 00:12:04,130
of where the rest of the industry was

225
00:12:01,640 --> 00:12:06,500
headed but is also work worth pointing

226
00:12:04,130 --> 00:12:08,600
out that acorn actually sold UNIX

227
00:12:06,500 --> 00:12:11,620
workstations they had themselves portage

228
00:12:08,600 --> 00:12:15,560
or quickly BSD to the ARM architecture

229
00:12:11,620 --> 00:12:19,490
so it is not like they didn't know how

230
00:12:15,560 --> 00:12:21,018
to do this they just didn't care clearly

231
00:12:19,490 --> 00:12:22,640
they didn't care about defense-in-depth

232
00:12:21,019 --> 00:12:26,120
they assume that if you're learning a

233
00:12:22,640 --> 00:12:28,010
file server you will keep it laptop but

234
00:12:26,120 --> 00:12:30,320
I have not looked into this but I would

235
00:12:28,010 --> 00:12:32,360
bet good money the passwords are

236
00:12:30,320 --> 00:12:36,220
transmitted in plaintext or some equally

237
00:12:32,360 --> 00:12:36,220
for real encryption over the network

238
00:12:39,510 --> 00:12:47,810
so that was before FAFSA or have we got

239
00:12:45,630 --> 00:12:47,810
next

240
00:12:49,010 --> 00:12:57,480
this is FS lock this is what they did to

241
00:12:55,050 --> 00:12:59,370
ensure that all of the client computers

242
00:12:57,480 --> 00:13:04,440
remain usable and that people did not

243
00:12:59,370 --> 00:13:07,010
look up I'm on this prevented people

244
00:13:04,440 --> 00:13:09,889
from writing to the hard-disk

245
00:13:07,010 --> 00:13:13,649
except for a single public directory

246
00:13:09,889 --> 00:13:15,180
where people would store files and

247
00:13:13,649 --> 00:13:17,730
promptly have them deleted by the next

248
00:13:15,180 --> 00:13:21,810
person that came along it was being

249
00:13:17,730 --> 00:13:25,139
mischievous so if I actually wanted to

250
00:13:21,810 --> 00:13:27,149
stop things and as a 15 year old by and

251
00:13:25,139 --> 00:13:29,339
large the thing that I was interested in

252
00:13:27,149 --> 00:13:32,850
his playing games and not having been

253
00:13:29,339 --> 00:13:34,410
deleted by the administration so I

254
00:13:32,850 --> 00:13:36,180
wanted somewhere to store stuff out of

255
00:13:34,410 --> 00:13:37,040
public scrutiny but I couldn't write to

256
00:13:36,180 --> 00:13:40,620
the hard-disk

257
00:13:37,040 --> 00:13:44,730
also if did it prevented access to the

258
00:13:40,620 --> 00:13:47,100
NVRAM or CMOS ROM in a conference so you

259
00:13:44,730 --> 00:13:53,819
could not recall bigger than machine in

260
00:13:47,100 --> 00:13:57,870
any way which again was annoying so it

261
00:13:53,819 --> 00:14:02,089
turns out that there was a utility that

262
00:13:57,870 --> 00:14:05,670
will ship with RISC OS which was a block

263
00:14:02,089 --> 00:14:11,899
happy that we are not doing on that

264
00:14:05,670 --> 00:14:11,899
first we are doing method is first the

265
00:14:12,829 --> 00:14:19,729
acorn worth had a big presence in the UK

266
00:14:16,139 --> 00:14:22,860
that had ambitions of selling overseas

267
00:14:19,730 --> 00:14:25,620
which meant that all user built visible

268
00:14:22,860 --> 00:14:30,630
strings needed to be translatable so

269
00:14:25,620 --> 00:14:35,220
they have a messages file that you could

270
00:14:30,630 --> 00:14:40,199
edit that would allow the translations

271
00:14:35,220 --> 00:14:45,269
elsewhere so this is a copy of FS locks

272
00:14:40,199 --> 00:14:50,040
messages file and it shows the strings

273
00:14:45,269 --> 00:14:52,830
at the top you can see on the path to

274
00:14:50,040 --> 00:14:56,160
there is dollar dot public

275
00:14:52,830 --> 00:14:59,670
hwah scoffs used dots as have separators

276
00:14:56,160 --> 00:15:01,860
and dollar means route directly so this

277
00:14:59,670 --> 00:15:05,250
was the top directive the hard disk and

278
00:15:01,860 --> 00:15:07,529
paste some dirt on public and it looked

279
00:15:05,250 --> 00:15:11,399
at this message to find out what the

280
00:15:07,529 --> 00:15:14,670
translated name of public was Haley your

281
00:15:11,399 --> 00:15:16,980
particular look off now I should point

282
00:15:14,670 --> 00:15:21,569
out the FS what was involved and so you

283
00:15:16,980 --> 00:15:23,940
couldn't just go up short but it had

284
00:15:21,570 --> 00:15:26,670
four visions to make sure that you did

285
00:15:23,940 --> 00:15:28,410
not copy it to RAM and run it now but

286
00:15:26,670 --> 00:15:32,310
the messages file did not

287
00:15:28,410 --> 00:15:36,630
so what you could do is take the

288
00:15:32,310 --> 00:15:39,060
original UK messages file viv place the

289
00:15:36,630 --> 00:15:42,750
string and dollar public with dollar dot

290
00:15:39,060 --> 00:15:45,390
remove the public and suddenly it thinks

291
00:15:42,750 --> 00:15:47,610
the entire hard drive is the drive that

292
00:15:45,390 --> 00:15:54,089
you can is that directory that you can

293
00:15:47,610 --> 00:15:57,450
now write so this is how you dirt that

294
00:15:54,089 --> 00:16:00,000
is a very small amount of code it finds

295
00:15:57,450 --> 00:16:02,700
the first of all they're copies the

296
00:16:00,000 --> 00:16:06,000
messages file to run it pulls out the

297
00:16:02,700 --> 00:16:09,360
location of the messages file it changes

298
00:16:06,000 --> 00:16:13,680
one single byte which that number ten is

299
00:16:09,360 --> 00:16:18,959
ASCII new line so it puts a new line in

300
00:16:13,680 --> 00:16:23,069
place of the heat of public so you now

301
00:16:18,959 --> 00:16:25,290
have the string dollar dot and it

302
00:16:23,070 --> 00:16:28,560
reinitialize a--'s the messages and that

303
00:16:25,290 --> 00:16:30,930
workflow thing other than the fact that

304
00:16:28,560 --> 00:16:33,660
it took approximately three you look at

305
00:16:30,930 --> 00:16:39,839
that because you have to copy the entire

306
00:16:33,660 --> 00:16:43,380
messages mm-hmm this was on a machine

307
00:16:39,839 --> 00:16:46,440
with like five megabytes typically and I

308
00:16:43,380 --> 00:16:48,439
thought that was it's a little bit so I

309
00:16:46,440 --> 00:16:51,180
went looking for other approaches and

310
00:16:48,440 --> 00:16:53,940
the other approach a second approach I

311
00:16:51,180 --> 00:16:57,269
came up with was long patch it turns out

312
00:16:53,940 --> 00:17:01,589
that there is a file shipped with

313
00:16:57,269 --> 00:17:04,709
discussed that fixes of all of the there

314
00:17:01,589 --> 00:17:06,600
had actual math ones at this point they

315
00:17:04,709 --> 00:17:09,000
weren't flash or Yvonne's

316
00:17:06,599 --> 00:17:12,448
they were actual math ones and the lead

317
00:17:09,000 --> 00:17:14,909
timer must ones is large so by the time

318
00:17:12,449 --> 00:17:18,329
the OS ships they had found a whole

319
00:17:14,909 --> 00:17:20,339
bunch of books into ROM and they needed

320
00:17:18,329 --> 00:17:23,339
to fix the lobster and this is how they

321
00:17:20,339 --> 00:17:24,448
did it I have no idea how it works I had

322
00:17:23,339 --> 00:17:26,809
no idea that's fine

323
00:17:24,449 --> 00:17:29,730
I had no documentation to speak of I

324
00:17:26,809 --> 00:17:31,620
basically was figuring this out with a

325
00:17:29,730 --> 00:17:35,309
disassembler a hex editor and a copy of

326
00:17:31,620 --> 00:17:37,620
basic well it's not too hard to figure

327
00:17:35,309 --> 00:17:42,000
out what is going on and what is going

328
00:17:37,620 --> 00:17:44,129
on is this you have to three fields you

329
00:17:42,000 --> 00:17:48,419
have the location you have the before

330
00:17:44,129 --> 00:17:51,449
and you have after and they fight that

331
00:17:48,419 --> 00:17:53,549
the location contains the contents

332
00:17:51,450 --> 00:17:57,830
before and it will change it to after

333
00:17:53,549 --> 00:18:02,580
using some magic mhm

334
00:17:57,830 --> 00:18:06,809
I'll help me to do the messages I'll

335
00:18:02,580 --> 00:18:09,360
hack with using a lot easier most bit

336
00:18:06,809 --> 00:18:11,940
also I would need to do a different hack

337
00:18:09,360 --> 00:18:15,689
because now I could patch the S lock

338
00:18:11,940 --> 00:18:22,409
module in its entirety I could just make

339
00:18:15,690 --> 00:18:25,889
it be killable because normally if you

340
00:18:22,409 --> 00:18:38,340
try to kill it it refuses because that

341
00:18:25,889 --> 00:18:40,379
would defeat the entire point the

342
00:18:38,340 --> 00:18:44,610
business of course except the incredibly

343
00:18:40,379 --> 00:18:46,649
version specific doing this way but it

344
00:18:44,610 --> 00:18:54,209
turns out that there was an even simpler

345
00:18:46,649 --> 00:19:02,129
way I ended up doing which is this see

346
00:18:54,210 --> 00:19:04,320
what yes there were two ways to kill her

347
00:19:02,129 --> 00:19:07,080
module risk loss and my module think

348
00:19:04,320 --> 00:19:09,450
kernel module there was not a big

349
00:19:07,080 --> 00:19:11,820
separation between kernel and user space

350
00:19:09,450 --> 00:19:13,529
that there was a separation of sorts

351
00:19:11,820 --> 00:19:15,510
they had an MMU but they didn't use it

352
00:19:13,529 --> 00:19:17,100
much as evidenced by the fact that I

353
00:19:15,510 --> 00:19:20,640
could write a simple basic program to

354
00:19:17,100 --> 00:19:35,370
poke into a module

355
00:19:20,640 --> 00:19:42,570
have it work without to do anything so

356
00:19:35,370 --> 00:19:45,030
what we have have is that what when

357
00:19:42,570 --> 00:19:46,409
you've tried to kill a module and into

358
00:19:45,030 --> 00:19:48,960
that mess lock is the module that we are

359
00:19:46,410 --> 00:19:53,669
trying to kill that is a flag that the

360
00:19:48,960 --> 00:19:59,490
operating system sets when it calls the

361
00:19:53,669 --> 00:20:01,650
finalization code of the module and if

362
00:19:59,490 --> 00:20:03,330
the flag is set it is a promise by the

363
00:20:01,650 --> 00:20:05,280
operating system that this is a

364
00:20:03,330 --> 00:20:06,928
temporary shutdown I am going to show

365
00:20:05,280 --> 00:20:08,940
you down briefly I'm going to move you

366
00:20:06,929 --> 00:20:11,910
around I'm going to defragment the heap

367
00:20:08,940 --> 00:20:16,559
and I'm going to set you all right back

368
00:20:11,910 --> 00:20:22,169
up again this is because there heap was

369
00:20:16,559 --> 00:20:25,470
terrible and they had a command called

370
00:20:22,169 --> 00:20:27,299
I'm trying which allowed you to we

371
00:20:25,470 --> 00:20:29,669
initialize all the modules move things

372
00:20:27,299 --> 00:20:32,400
down and reclaim the memory that you are

373
00:20:29,669 --> 00:20:34,200
otherwise losing to fragmentation this

374
00:20:32,400 --> 00:20:35,910
turned out to be a terrible idea in fact

375
00:20:34,200 --> 00:20:38,540
it was a very terrible that they later

376
00:20:35,910 --> 00:20:43,770
turned it in to ignore it later versions

377
00:20:38,540 --> 00:20:47,970
but the flag remains so it was possible

378
00:20:43,770 --> 00:20:49,860
to be tennis to do video s ly 2 FS lock

379
00:20:47,970 --> 00:20:56,220
say I'm going to shoot you down

380
00:20:49,860 --> 00:20:59,219
temporarily and never actually follow

381
00:20:56,220 --> 00:21:02,010
through on that so FS lock thought it

382
00:20:59,220 --> 00:21:05,280
had being killed the OS thought it was

383
00:21:02,010 --> 00:21:08,429
still running albeit that it had removed

384
00:21:05,280 --> 00:21:13,260
all its hooks from all of the SIS calls

385
00:21:08,429 --> 00:21:16,710
and things and so you ended up with a

386
00:21:13,260 --> 00:21:18,650
zombie and it was very otherwise to do

387
00:21:16,710 --> 00:21:20,910
anything at all with a zombie

388
00:21:18,650 --> 00:21:22,799
interacting with it in any way would

389
00:21:20,910 --> 00:21:25,620
almost certainly mock up the machine but

390
00:21:22,799 --> 00:21:27,389
that was ok but more to the point this

391
00:21:25,620 --> 00:21:31,320
was incredibly portable they would work

392
00:21:27,390 --> 00:21:32,730
on any version ever and I think I had a

393
00:21:31,320 --> 00:21:33,830
version that was less not and advise

394
00:21:32,730 --> 00:21:42,020
that code

395
00:21:33,830 --> 00:21:44,570
but this is not it but yes now I have

396
00:21:42,020 --> 00:21:51,080
solved the formula I can store them at

397
00:21:44,570 --> 00:21:52,750
others mutiny but I wanted more it is

398
00:21:51,080 --> 00:21:59,178
what else we got

399
00:21:52,750 --> 00:22:03,590
yes I had not heard of the word rootkit

400
00:21:59,179 --> 00:22:07,159
at this point but that is approximately

401
00:22:03,590 --> 00:22:12,168
what I ended up writing because it turns

402
00:22:07,159 --> 00:22:13,820
out that people actually go looking

403
00:22:12,169 --> 00:22:19,730
through directory structures especially

404
00:22:13,820 --> 00:22:26,539
if they take up lots of space so what I

405
00:22:19,730 --> 00:22:28,820
did was I made a way to hide things so

406
00:22:26,539 --> 00:22:32,559
the OS no longer acknowledged their

407
00:22:28,820 --> 00:22:40,309
existence and I have a little demo and

408
00:22:32,559 --> 00:22:43,730
see - and we'll see what is going on so

409
00:22:40,309 --> 00:22:45,200
I'll explain afterwards ok so you see I

410
00:22:43,730 --> 00:22:47,030
have a little dirty here which is the

411
00:22:45,200 --> 00:22:51,830
multiplication sign in which I store my

412
00:22:47,030 --> 00:22:54,590
super secret stuff I bet well if that

413
00:22:51,830 --> 00:22:56,928
I'm going to run the yup a special

414
00:22:54,590 --> 00:22:59,689
kidney utility now I hope in the

415
00:22:56,929 --> 00:23:02,090
directory again and it has vanished and

416
00:22:59,690 --> 00:23:03,860
the here is the fun part either to open

417
00:23:02,090 --> 00:23:07,030
the character map I'm ready to create a

418
00:23:03,860 --> 00:23:10,990
new directory with a division symbol and

419
00:23:07,030 --> 00:23:13,879
hey presto its back but this is not the

420
00:23:10,990 --> 00:23:18,260
division I created a do directly with a

421
00:23:13,880 --> 00:23:21,620
division symbol but that never happened

422
00:23:18,260 --> 00:23:23,960
and now we've got that thing with the

423
00:23:21,620 --> 00:23:27,229
multiplication symbol back so what's

424
00:23:23,960 --> 00:23:30,650
happened to the division symbol and the

425
00:23:27,230 --> 00:23:32,210
way this works is I wanted to do this

426
00:23:30,650 --> 00:23:35,299
the source codes in the background by

427
00:23:32,210 --> 00:23:41,540
the way again there is very very little

428
00:23:35,299 --> 00:23:45,139
of it this hooked the operating systems

429
00:23:41,540 --> 00:23:47,070
redirect the entry Cisco which is read

430
00:23:45,140 --> 00:23:52,590
in Linux powers

431
00:23:47,070 --> 00:23:59,399
but it turned out the list is sorted its

432
00:23:52,590 --> 00:24:04,290
directory entries alphabetically so when

433
00:23:59,400 --> 00:24:08,880
you called reader or its equivalent you

434
00:24:04,290 --> 00:24:13,770
would get back a sorted list so if you

435
00:24:08,880 --> 00:24:17,370
pick something near the end of the route

436
00:24:13,770 --> 00:24:19,350
map I initially picked a ski to 5/5

437
00:24:17,370 --> 00:24:23,340
which I'll check which I later changed

438
00:24:19,350 --> 00:24:27,300
for reasons I will tell you shortly then

439
00:24:23,340 --> 00:24:29,939
the idea is you walk through the list to

440
00:24:27,300 --> 00:24:32,610
see if the thing at the end is your

441
00:24:29,940 --> 00:24:36,510
special file name and if it is you

442
00:24:32,610 --> 00:24:43,199
simply subtract one from the number the

443
00:24:36,510 --> 00:24:46,140
availeth so that saves you actually

444
00:24:43,200 --> 00:24:48,990
having to do any modification of the

445
00:24:46,140 --> 00:24:53,310
directory entries themselves you can't

446
00:24:48,990 --> 00:24:56,240
just change the length field which was

447
00:24:53,310 --> 00:25:00,000
really nice and made the code very small

448
00:24:56,240 --> 00:25:03,150
but it turned out this acorn did actual

449
00:25:00,000 --> 00:25:07,200
local aware string comparison and so I

450
00:25:03,150 --> 00:25:09,780
don't know if anyone knows that 255 in

451
00:25:07,200 --> 00:25:12,510
Latin one is a wire with an umlaut over

452
00:25:09,780 --> 00:25:15,660
it which was sorted along with the wise

453
00:25:12,510 --> 00:25:17,490
and so Zed came after that so I picked

454
00:25:15,660 --> 00:25:19,650
something else that was further up that

455
00:25:17,490 --> 00:25:22,050
was not an alphabetical symbol that

456
00:25:19,650 --> 00:25:25,860
would not be confused and I ended up

457
00:25:22,050 --> 00:25:28,350
with us not ASCII Latin 1 2 - 1 5 which

458
00:25:25,860 --> 00:25:30,600
is the motivation symbol first I picked

459
00:25:28,350 --> 00:25:32,490
up at random turns out there were later

460
00:25:30,600 --> 00:25:34,800
ones such as the division symbol nobody

461
00:25:32,490 --> 00:25:36,330
ever used any of these in file names so

462
00:25:34,800 --> 00:25:37,710
it was perfectly safe but it turned out

463
00:25:36,330 --> 00:25:39,840
is really useful to the debugging

464
00:25:37,710 --> 00:25:42,720
because if you're trying to debug

465
00:25:39,840 --> 00:25:47,340
something like this when it's working

466
00:25:42,720 --> 00:25:53,480
you can't actually see the thing so that

467
00:25:47,340 --> 00:25:53,480
made life easier to debug

468
00:25:55,430 --> 00:26:03,150
so I now had a way of storing small of

469
00:26:00,180 --> 00:26:09,390
my stuff album of scrutiny and this was

470
00:26:03,150 --> 00:26:12,350
one on boot-up but I wanted more so I do

471
00:26:09,390 --> 00:26:17,580
not suddenly have code for this still

472
00:26:12,350 --> 00:26:21,949
but I was able to I have basically zero

473
00:26:17,580 --> 00:26:26,149
documentation on any of this but I was I

474
00:26:21,950 --> 00:26:28,950
had a list of API calls for a canet and

475
00:26:26,150 --> 00:26:33,270
after much experimentation I figured out

476
00:26:28,950 --> 00:26:38,580
a way to send a point just one bite but

477
00:26:33,270 --> 00:26:40,440
that was all you needed and I ended up

478
00:26:38,580 --> 00:26:46,620
implementing what was approximately a

479
00:26:40,440 --> 00:26:51,360
the mote shop so you could have a test

480
00:26:46,620 --> 00:26:54,199
window open on a remote machine that

481
00:26:51,360 --> 00:26:58,169
would not appear in the process lift and

482
00:26:54,200 --> 00:27:01,050
you could send right to his and get

483
00:26:58,170 --> 00:27:02,970
rights back from it and the latency was

484
00:27:01,050 --> 00:27:06,470
terrible it was about a new milliseconds

485
00:27:02,970 --> 00:27:12,180
especially if you had lots of output

486
00:27:06,470 --> 00:27:13,980
command this did not have any kind tcp

487
00:27:12,180 --> 00:27:17,100
was just a glimmer in people's eye at

488
00:27:13,980 --> 00:27:18,690
this point so if the network was

489
00:27:17,100 --> 00:27:22,350
congested if there was packet we are

490
00:27:18,690 --> 00:27:26,550
doing if packets were lost then your

491
00:27:22,350 --> 00:27:27,689
session would behave strangely but that

492
00:27:26,550 --> 00:27:34,800
was all okay

493
00:27:27,690 --> 00:27:42,270
and I was basically able to run commands

494
00:27:34,800 --> 00:27:47,490
on a machine room which was all well and

495
00:27:42,270 --> 00:27:50,100
good because by enlarge I is not trying

496
00:27:47,490 --> 00:27:54,870
to be malicious until other people got

497
00:27:50,100 --> 00:27:56,820
hold of the program that lets human

498
00:27:54,870 --> 00:27:59,939
commands on other people's machines and

499
00:27:56,820 --> 00:28:02,639
by far the most popular thing that

500
00:27:59,940 --> 00:28:04,620
people found it amusing to do to other

501
00:28:02,640 --> 00:28:04,980
people's machines was to remotely reboot

502
00:28:04,620 --> 00:28:06,719
them

503
00:28:04,980 --> 00:28:09,780
which was

504
00:28:06,720 --> 00:28:15,390
single command basic it was cysts who

505
00:28:09,780 --> 00:28:17,370
thinks a and there were people who did

506
00:28:15,390 --> 00:28:20,909
not know any basic other than that one

507
00:28:17,370 --> 00:28:24,149
command for this precise reason and

508
00:28:20,909 --> 00:28:26,669
someone I think it may have been my

509
00:28:24,150 --> 00:28:27,799
friend K I do not know I don't think it

510
00:28:26,669 --> 00:28:31,980
was me

511
00:28:27,799 --> 00:28:35,850
ended up distributing a version of this

512
00:28:31,980 --> 00:28:37,919
that looked as though it was sending

513
00:28:35,850 --> 00:28:39,658
commands to a remote machine but in fact

514
00:28:37,919 --> 00:28:47,450
executed the commands on your local

515
00:28:39,659 --> 00:28:57,720
machine which put out to that so yeah

516
00:28:47,450 --> 00:29:03,510
what else we got that is what life was

517
00:28:57,720 --> 00:29:06,000
like it was very different for my

518
00:29:03,510 --> 00:29:12,559
security perspective it was clear the

519
00:29:06,000 --> 00:29:15,960
acorns priorities were making work and

520
00:29:12,559 --> 00:29:20,760
make it robust and make it user friendly

521
00:29:15,960 --> 00:29:28,770
and maybe possibly make it secure as

522
00:29:20,760 --> 00:29:33,179
very much an afterthought and I would

523
00:29:28,770 --> 00:29:35,039
like to offer a lifetime supply of

524
00:29:33,179 --> 00:29:38,250
aspirin for all of the headaches that I

525
00:29:35,039 --> 00:29:46,470
caused the administrator of the computer

526
00:29:38,250 --> 00:29:53,510
who is dr. who attack and yeah how long

527
00:29:46,470 --> 00:30:03,690
we got okay okay I'm gonna call it that

528
00:29:53,510 --> 00:30:05,610
does anyone have anything to ask if this

529
00:30:03,690 --> 00:30:20,690
was about 95 96

530
00:30:05,610 --> 00:30:20,689
so between 95 to 98 I had over

531
00:30:20,790 --> 00:30:28,570
okay Northcote I saw this sort come to I

532
00:30:26,320 --> 00:30:32,350
showed you this off a two and a half

533
00:30:28,570 --> 00:30:35,860
inch hard drive to an average IDE hard

534
00:30:32,350 --> 00:30:40,780
drive that I had on my own acorn machine

535
00:30:35,860 --> 00:30:44,199
that I had a get sooner half inch to

536
00:30:40,780 --> 00:30:48,690
three and a half inch cable that I was

537
00:30:44,200 --> 00:30:55,960
able to transfer it onto an IDE machine

538
00:30:48,690 --> 00:30:58,840
in about 2001 but ironically I lost that

539
00:30:55,960 --> 00:31:02,050
or that data to a disk crash later but

540
00:30:58,840 --> 00:31:04,720
the original drive in 1996 was still

541
00:31:02,050 --> 00:31:07,629
alive and just last week I was able to

542
00:31:04,720 --> 00:31:09,580
load it up and pull the entire 720

543
00:31:07,630 --> 00:31:18,760
megabytes of it and that is where the

544
00:31:09,580 --> 00:31:22,179
code comes the network screenshots are

545
00:31:18,760 --> 00:31:24,790
all from the this software is all

546
00:31:22,180 --> 00:31:26,890
available for download stuff so I was

547
00:31:24,790 --> 00:31:29,020
able to set it up and in fact I have it

548
00:31:26,890 --> 00:31:30,970
running on my laptop because it is very

549
00:31:29,020 --> 00:31:32,290
annoying to them this guy's on a laptop

550
00:31:30,970 --> 00:31:37,180
because it needs all the function keys

551
00:31:32,290 --> 00:31:39,580
and all of the math boxes so this hidden

552
00:31:37,180 --> 00:31:41,710
video for example is something that I

553
00:31:39,580 --> 00:31:48,240
created on this machine a couple of days

554
00:31:41,710 --> 00:31:48,240
ago does that answer your question

555
00:31:50,470 --> 00:31:53,569
[Music]

556
00:31:55,830 --> 00:31:58,949
anywhere else

557
00:32:02,340 --> 00:32:13,060
this rule over 500 yes and I was saying

558
00:32:11,470 --> 00:32:16,090
before is have got to meet two minutes

559
00:32:13,060 --> 00:32:17,590
with a window Maya to reveal the

560
00:32:16,090 --> 00:32:19,179
passwords it was approximately half an

561
00:32:17,590 --> 00:32:23,050
hour where the hex editor to decode the

562
00:32:19,180 --> 00:32:27,340
password format telling the admin his

563
00:32:23,050 --> 00:32:28,810
password with Judith priceless turns out

564
00:32:27,340 --> 00:32:30,919
it was his wife's name I did not know

565
00:32:28,810 --> 00:32:34,970
that could save me a bunch of time

566
00:32:30,920 --> 00:32:37,880
lesson here don't have don't use your

567
00:32:34,970 --> 00:32:46,819
nearest interests names as passwords

568
00:32:37,880 --> 00:32:46,819
[Music]

569
00:32:47,680 --> 00:32:58,589
there else

570
00:32:50,580 --> 00:32:58,589
[Music]

