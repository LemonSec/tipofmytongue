1
00:00:00,530 --> 00:00:02,590
you

2
00:00:03,950 --> 00:00:05,670
let's start with just a brief

3
00:00:05,670 --> 00:00:07,500
introduction of ourselves my name is

4
00:00:07,500 --> 00:00:10,230
Nick I'm running the malware Intel team

5
00:00:10,230 --> 00:00:13,530
at Intel 471 we all hate myself and the

6
00:00:13,530 --> 00:00:14,940
rest of the guys we spend all day

7
00:00:14,940 --> 00:00:17,519
looking at malware mostly financially

8
00:00:17,519 --> 00:00:19,950
motivated malware and we trying to

9
00:00:19,950 --> 00:00:21,690
figure out what these guys are doing

10
00:00:21,690 --> 00:00:24,780
we're trying to track their actions in a

11
00:00:24,780 --> 00:00:26,520
programmatic way and then analyze the

12
00:00:26,520 --> 00:00:29,970
data that we collect so let's fix it

13
00:00:29,970 --> 00:00:32,159
I I work at somewhere where I'm at least

14
00:00:32,159 --> 00:00:34,860
in his team this is my first time

15
00:00:34,860 --> 00:00:36,840
speaking out besides so let's go for it

16
00:00:36,840 --> 00:00:39,690
and if you want to to talk shop you can

17
00:00:39,690 --> 00:00:43,440
reach me through through Twitter 24

18
00:00:43,440 --> 00:00:48,480
hours per day so a little overview of

19
00:00:48,480 --> 00:00:50,040
how we've structured the talk so the

20
00:00:50,040 --> 00:00:51,750
beginning is answering the question what

21
00:00:51,750 --> 00:00:54,000
is cubot and I'm glad we put that

22
00:00:54,000 --> 00:00:55,559
because it seems like nobody knows what

23
00:00:55,559 --> 00:00:58,020
it is a second we'll talk about how does

24
00:00:58,020 --> 00:01:01,280
cubot work that's the technical portion

25
00:01:01,280 --> 00:01:03,539
trying to keep it to like high level

26
00:01:03,539 --> 00:01:07,860
tactics and and procedures and tools

27
00:01:07,860 --> 00:01:10,409
used and function of the malware and

28
00:01:10,409 --> 00:01:12,240
then finally we're going to talk a

29
00:01:12,240 --> 00:01:15,360
little bit more about the vendors that

30
00:01:15,360 --> 00:01:17,820
the Cuba operators use because they

31
00:01:17,820 --> 00:01:19,710
don't do everything themselves they

32
00:01:19,710 --> 00:01:25,170
outsource some of the work to others so

33
00:01:25,170 --> 00:01:27,450
let's get started Cuba there's a modular

34
00:01:27,450 --> 00:01:29,700
info stealer though the main purpose of

35
00:01:29,700 --> 00:01:33,360
Cuba is to gather information from the

36
00:01:33,360 --> 00:01:36,090
infected machine the modular part means

37
00:01:36,090 --> 00:01:37,830
that they can load additional plugins

38
00:01:37,830 --> 00:01:40,310
for for additional functionality so if

39
00:01:40,310 --> 00:01:42,479
for example they want to turn your

40
00:01:42,479 --> 00:01:44,960
machine into a proxy they just load a

41
00:01:44,960 --> 00:01:48,210
UPnP plug-in and now your your infected

42
00:01:48,210 --> 00:01:49,890
machine is a proxy or they can load a

43
00:01:49,890 --> 00:01:52,079
cookie grabber plug-in that steals all

44
00:01:52,079 --> 00:01:53,549
the cookies that are saved by all your

45
00:01:53,549 --> 00:01:56,040
browsers and ships those back to the the

46
00:01:56,040 --> 00:02:01,439
back end Cuba at first emerging in 2007

47
00:02:01,439 --> 00:02:04,110
according to a report released by

48
00:02:04,110 --> 00:02:07,020
Symantec it's a really good report in

49
00:02:07,020 --> 00:02:10,679
fact so we trust that this is true but

50
00:02:10,679 --> 00:02:12,989
it hasn't always been showing the same

51
00:02:12,989 --> 00:02:14,939
level of activity over the years so some

52
00:02:14,939 --> 00:02:16,579
years we've seen

53
00:02:16,579 --> 00:02:19,189
low levels of activity which some years

54
00:02:19,189 --> 00:02:21,890
we've seen as like right now high

55
00:02:21,890 --> 00:02:23,930
activity where the operation is is going

56
00:02:23,930 --> 00:02:26,480
at full strength we will be talking

57
00:02:26,480 --> 00:02:29,480
about activity from the year 2019 unless

58
00:02:29,480 --> 00:02:31,340
we specify otherwise so everything that

59
00:02:31,340 --> 00:02:34,069
we talk about like how the malware is

60
00:02:34,069 --> 00:02:36,049
spread and stuff like that is relevant

61
00:02:36,049 --> 00:02:38,540
to 2019

62
00:02:38,540 --> 00:02:40,970
cubot is financially motivated it's not

63
00:02:40,970 --> 00:02:45,500
an apt but I would classify it as an

64
00:02:45,500 --> 00:02:48,560
advanced threat and it can also be

65
00:02:48,560 --> 00:02:51,829
persistent but it's not apt in the sense

66
00:02:51,829 --> 00:02:53,420
of espionage it's financially motivated

67
00:02:53,420 --> 00:02:55,669
thereafter they're trying to make money

68
00:02:55,669 --> 00:03:00,230
using their their Cuba malware the

69
00:03:00,230 --> 00:03:02,810
current code base actually matches the

70
00:03:02,810 --> 00:03:06,590
analysis done in 2011 and what that

71
00:03:06,590 --> 00:03:09,260
seems to show is that we're talking

72
00:03:09,260 --> 00:03:10,730
about the same malware that was

73
00:03:10,730 --> 00:03:12,889
operating in 2011 which is actually

74
00:03:12,889 --> 00:03:15,079
quite impressive because not many

75
00:03:15,079 --> 00:03:17,299
malware families have that long of a

76
00:03:17,299 --> 00:03:21,500
life span and it still actively

77
00:03:21,500 --> 00:03:23,299
developed to this day so just a few

78
00:03:23,299 --> 00:03:25,340
months ago we saw a new plug-in that was

79
00:03:25,340 --> 00:03:27,530
released and we've also seen new

80
00:03:27,530 --> 00:03:29,750
functions that were developed as we're

81
00:03:29,750 --> 00:03:34,370
tracking this threat so why cubot why

82
00:03:34,370 --> 00:03:37,729
are we calling it Cuba again sorry for

83
00:03:37,729 --> 00:03:39,530
the small screen shot but this is some

84
00:03:39,530 --> 00:03:40,790
of the strings that were found in the

85
00:03:40,790 --> 00:03:43,519
binary and I'll read some of them out

86
00:03:43,519 --> 00:03:45,739
for you pew bot version Cuba

87
00:03:45,739 --> 00:03:49,220
configuration path Cuba run mutex the

88
00:03:49,220 --> 00:03:51,109
authors are calling it Cuba and that's

89
00:03:51,109 --> 00:03:53,109
why we're calling it Cuba now some

90
00:03:53,109 --> 00:03:55,639
vendors have given other names like

91
00:03:55,639 --> 00:03:58,430
quake bots and pink slip bought but

92
00:03:58,430 --> 00:03:59,750
we're going to stick with Cuba because

93
00:03:59,750 --> 00:04:03,889
that's what the authors call it I'd like

94
00:04:03,889 --> 00:04:04,939
to give a shout out to some of the

95
00:04:04,939 --> 00:04:07,069
previous work that's been done give

96
00:04:07,069 --> 00:04:09,319
credit where it's due we've read over

97
00:04:09,319 --> 00:04:13,459
these reports here they're all excellent

98
00:04:13,459 --> 00:04:15,139
it's all really good work done that

99
00:04:15,139 --> 00:04:17,659
we've built upon and to improve our own

100
00:04:17,659 --> 00:04:20,029
understanding of them our as well and to

101
00:04:20,029 --> 00:04:21,918
validate like things that we're seeing

102
00:04:21,918 --> 00:04:24,260
in 2011 can we see that it's the same

103
00:04:24,260 --> 00:04:26,960
now again it shows that it's one actor

104
00:04:26,960 --> 00:04:30,990
group consistently operating over time

105
00:04:30,990 --> 00:04:34,720
so now we know what is Cuba let's talk

106
00:04:34,720 --> 00:04:36,760
about how does Cuba get onto your

107
00:04:36,760 --> 00:04:37,150
network

108
00:04:37,150 --> 00:04:41,650
Ponty onto victim machines so in 2019

109
00:04:41,650 --> 00:04:44,920
and even 2018 we've seen the primary

110
00:04:44,920 --> 00:04:47,160
delivery mechanism is mouth spam so

111
00:04:47,160 --> 00:04:50,400
malicious spam either with a link to

112
00:04:50,400 --> 00:04:54,790
some other file or with files attached

113
00:04:54,790 --> 00:04:59,050
so sometimes we see JavaScript loaders

114
00:04:59,050 --> 00:05:02,770
we see VBS loaders we see documents like

115
00:05:02,770 --> 00:05:04,920
office documents with macros the

116
00:05:04,920 --> 00:05:07,360
prevailing theme here is that the Cuba

117
00:05:07,360 --> 00:05:09,460
operators are continuously making

118
00:05:09,460 --> 00:05:11,470
modifications and changes to be able to

119
00:05:11,470 --> 00:05:13,720
bypass protection systems to be able to

120
00:05:13,720 --> 00:05:14,890
bypass

121
00:05:14,890 --> 00:05:16,600
yeah those protection systems to get

122
00:05:16,600 --> 00:05:19,480
onto the machine an interesting note is

123
00:05:19,480 --> 00:05:23,200
that we've seen the same VBS loader used

124
00:05:23,200 --> 00:05:25,180
to drop other malware families such as

125
00:05:25,180 --> 00:05:29,560
Dana bot dry decks enhancer which seems

126
00:05:29,560 --> 00:05:32,350
to indicate that the Cuba operators have

127
00:05:32,350 --> 00:05:34,810
purchased a dropper service or purchased

128
00:05:34,810 --> 00:05:36,580
a tool from someone else that other

129
00:05:36,580 --> 00:05:38,860
people are also using so again it shows

130
00:05:38,860 --> 00:05:43,170
that Cuba operators will will gladly

131
00:05:43,170 --> 00:05:48,610
outsource some of the work one other

132
00:05:48,610 --> 00:05:51,400
thing that we've seen is Cuba dropped by

133
00:05:51,400 --> 00:05:53,020
a motet maybe some people have heard of

134
00:05:53,020 --> 00:05:56,890
a motet yeah few more hands this family

135
00:05:56,890 --> 00:05:58,870
is really prevalent these days it's one

136
00:05:58,870 --> 00:06:01,110
of the most talked about droppers and

137
00:06:01,110 --> 00:06:04,840
they send new campaigns spreading

138
00:06:04,840 --> 00:06:06,400
campaigns almost every day of the week

139
00:06:06,400 --> 00:06:10,090
and almost all over the world I mean all

140
00:06:10,090 --> 00:06:12,490
the way to like China Latin America

141
00:06:12,490 --> 00:06:14,830
Europe United States a motet is

142
00:06:14,830 --> 00:06:17,290
considered top tier cyber criminals and

143
00:06:17,290 --> 00:06:20,650
if we're we saw a motet dropping Cuba

144
00:06:20,650 --> 00:06:22,840
earlier this year and this shows that

145
00:06:22,840 --> 00:06:27,580
the Cuba operators have access to top

146
00:06:27,580 --> 00:06:30,610
tier cyber criminals that maybe some of

147
00:06:30,610 --> 00:06:33,940
the lower ranking cyber criminals don't

148
00:06:33,940 --> 00:06:35,770
have access to and that makes sense

149
00:06:35,770 --> 00:06:37,180
considering how long they've been in the

150
00:06:37,180 --> 00:06:41,590
game so we've talked about what is Cuba

151
00:06:41,590 --> 00:06:43,510
how does it get to your machine

152
00:06:43,510 --> 00:06:45,280
I'm going to talk briefly about what

153
00:06:45,280 --> 00:06:47,800
happens at the moment that the cubed is

154
00:06:47,800 --> 00:06:49,390
launched on the machine and then I'm

155
00:06:49,390 --> 00:06:51,220
going to pass it over to what hated to

156
00:06:51,220 --> 00:06:54,880
jump into the details so Cuba launches

157
00:06:54,880 --> 00:06:59,440
itself several times to get everything

158
00:06:59,440 --> 00:07:01,660
accomplished that it wants to do in the

159
00:07:01,660 --> 00:07:04,810
initial execution can't see here but it

160
00:07:04,810 --> 00:07:08,050
launches itself with with a special flag

161
00:07:08,050 --> 00:07:12,370
and then it creates a scheduled task to

162
00:07:12,370 --> 00:07:15,150
run itself again and this is sort of a

163
00:07:15,150 --> 00:07:18,340
privilege escalation to get higher

164
00:07:18,340 --> 00:07:20,590
privileges it's a kind of ridiculous

165
00:07:20,590 --> 00:07:23,070
that Windows allows you to do that but

166
00:07:23,070 --> 00:07:26,530
finally we see that Cuba runs itself

167
00:07:26,530 --> 00:07:29,770
from the scheduled tasks and injects its

168
00:07:29,770 --> 00:07:32,650
its own copy of the core DLL into

169
00:07:32,650 --> 00:07:36,220
explorer.exe so you won't see you know

170
00:07:36,220 --> 00:07:39,010
some suspicious process name in your

171
00:07:39,010 --> 00:07:41,410
task manager it's running inside

172
00:07:41,410 --> 00:07:43,930
explorer.exe which is presumably running

173
00:07:43,930 --> 00:07:46,500
on on everybody's Windows machine and

174
00:07:46,500 --> 00:07:49,120
with that I'm gonna pass it to alright

175
00:07:49,120 --> 00:07:53,830
so now that we have an overview into the

176
00:07:53,830 --> 00:07:56,080
queue or threat let's go to life

177
00:07:56,080 --> 00:08:00,220
including darkness well first of all we

178
00:08:00,220 --> 00:08:03,910
have to to mention when we fight miner

179
00:08:03,910 --> 00:08:05,830
is through my pan pour through a motet

180
00:08:05,830 --> 00:08:09,550
or through any mean this sample is is

181
00:08:09,550 --> 00:08:11,440
packed and cobblestone pucker

182
00:08:11,440 --> 00:08:14,650
they seem to do use always the same one

183
00:08:14,650 --> 00:08:18,900
that is polymorphic so perhaps it works

184
00:08:18,900 --> 00:08:22,390
against individual detection after

185
00:08:22,390 --> 00:08:24,520
performing an unpacking we have another

186
00:08:24,520 --> 00:08:28,570
layer of protection which flirts static

187
00:08:28,570 --> 00:08:32,020
analysis and these are just two included

188
00:08:32,020 --> 00:08:35,590
templates which are pretty

189
00:08:35,590 --> 00:08:37,479
straightforward to the code they are

190
00:08:37,479 --> 00:08:38,909
plain

191
00:08:38,909 --> 00:08:44,890
Shorry themes with 64 key whites but

192
00:08:44,890 --> 00:08:48,520
this simple procedure throws a lot of

193
00:08:48,520 --> 00:08:51,430
light into static analysis I think you

194
00:08:51,430 --> 00:08:53,680
cannot see from from there but here we

195
00:08:53,680 --> 00:08:57,060
have all the dakotas strings like

196
00:08:57,060 --> 00:09:01,620
articles or the book and messages the

197
00:09:01,620 --> 00:09:06,720
allows to load and so on so after we

198
00:09:06,720 --> 00:09:11,310
have the strings the code we can jump

199
00:09:11,310 --> 00:09:14,840
into the interior television which cubot

200
00:09:14,840 --> 00:09:19,740
that's a lot it it once to ensure it's

201
00:09:19,740 --> 00:09:21,090
not running an assemble for a

202
00:09:21,090 --> 00:09:25,410
militarized environment for detecting

203
00:09:25,410 --> 00:09:28,890
them he's going to to use the Heian

204
00:09:28,890 --> 00:09:31,920
instructions from the Intel instruction

205
00:09:31,920 --> 00:09:35,190
set to attack being were it also will

206
00:09:35,190 --> 00:09:38,310
check if the sample has been renamed as

207
00:09:38,310 --> 00:09:41,820
sample the deep sea of active file dot

208
00:09:41,820 --> 00:09:45,600
exe so perhaps there are some some boxes

209
00:09:45,600 --> 00:09:47,670
using this profile for submitted samples

210
00:09:47,670 --> 00:09:54,720
and if if you wat detect it's running on

211
00:09:54,720 --> 00:09:57,780
an built environment it will overwrite

212
00:09:57,780 --> 00:10:01,460
the executable with the Liddy made

213
00:10:01,460 --> 00:10:07,940
windows calculator sort of erases itself

214
00:10:08,690 --> 00:10:11,310
so we have been discussing the

215
00:10:11,310 --> 00:10:13,470
production from the unpacked sample

216
00:10:13,470 --> 00:10:18,450
visit the cubed other and this no other

217
00:10:18,450 --> 00:10:23,010
has many resources which are the next

218
00:10:23,010 --> 00:10:27,330
component in the fact insane behalf I

219
00:10:27,330 --> 00:10:29,160
this we are interested in the first

220
00:10:29,160 --> 00:10:32,280
three ones so for IV number one we have

221
00:10:32,280 --> 00:10:34,800
to be cordial which is going to be

222
00:10:34,800 --> 00:10:39,090
injected into Splore dot exe all of

223
00:10:39,090 --> 00:10:41,280
these resources are protected under two

224
00:10:41,280 --> 00:10:44,400
layers one encryption layer or rc4 and

225
00:10:44,400 --> 00:10:48,300
another compression layer of brief l set

226
00:10:48,300 --> 00:10:52,110
which is hard to to realize because it

227
00:10:52,110 --> 00:10:55,140
has the header change into a custom one

228
00:10:55,140 --> 00:10:58,830
so you have a unknown compression

229
00:10:58,830 --> 00:11:03,000
algorithm without no header if you and

230
00:11:03,000 --> 00:11:06,090
realize what are we dealing with

231
00:11:06,090 --> 00:11:08,190
they only have the only thing you have

232
00:11:08,190 --> 00:11:10,290
to do next is to implement yourself

233
00:11:10,290 --> 00:11:14,370
which is a lot of work and you want to

234
00:11:14,370 --> 00:11:17,180
avoid that at any cost

235
00:11:17,180 --> 00:11:21,300
for at least 200 these are the dll's to

236
00:11:21,300 --> 00:11:23,460
be injected in Internet Explorer to

237
00:11:23,460 --> 00:11:28,320
perform the bank in stealing we have pls

238
00:11:28,320 --> 00:11:32,490
here targeting both detectors 32 and 64

239
00:11:32,490 --> 00:11:36,060
systems and also they could be ll which

240
00:11:36,060 --> 00:11:38,600
is the one responsible for establishing

241
00:11:38,600 --> 00:11:40,140
communications with the command and

242
00:11:40,140 --> 00:11:43,740
control executing commands has its own

243
00:11:43,740 --> 00:11:47,820
resources the at least in this table and

244
00:11:47,820 --> 00:11:50,190
we are going to dive into every one of

245
00:11:50,190 --> 00:11:52,650
them in upcoming slides just to

246
00:11:52,650 --> 00:11:57,810
summarize in the ID 8 stands for the

247
00:11:57,810 --> 00:12:02,100
on-board computer asian number 10 is a

248
00:12:02,100 --> 00:12:03,180
javascript later

249
00:12:03,180 --> 00:12:06,840
cubot has two methods of 13 with 80

250
00:12:06,840 --> 00:12:08,910
binaries this one a plan we are going to

251
00:12:08,910 --> 00:12:11,310
talk about the other one later and the

252
00:12:11,310 --> 00:12:14,790
ID 11 stands for the controller drift to

253
00:12:14,790 --> 00:12:16,140
establish this communication with the

254
00:12:16,140 --> 00:12:20,700
backend for these resources we have only

255
00:12:20,700 --> 00:12:22,890
one layer of protection for more

256
00:12:22,890 --> 00:12:24,750
configuration and control list this is

257
00:12:24,750 --> 00:12:27,150
only the increase in layer of support

258
00:12:27,150 --> 00:12:29,850
and further they ask you to the data we

259
00:12:29,850 --> 00:12:33,450
have also the completion layer intake

260
00:12:33,450 --> 00:12:35,160
and riley and diffenbach configuration

261
00:12:35,160 --> 00:12:38,670
are not really huge files so when the

262
00:12:38,670 --> 00:12:40,260
thing gets bigger

263
00:12:40,260 --> 00:12:44,010
I guess cubed operators want to make a

264
00:12:44,010 --> 00:12:46,370
nice pool tables tinier so they compress

265
00:12:46,370 --> 00:12:52,650
these files so for the on board

266
00:12:52,650 --> 00:12:58,880
configuration we have up to this two

267
00:12:58,880 --> 00:13:01,080
different kinds of internal

268
00:13:01,080 --> 00:13:04,050
configurations for the first one we have

269
00:13:04,050 --> 00:13:07,740
here the company ID and a configuration

270
00:13:07,740 --> 00:13:12,030
a timestamp for the company V let's say

271
00:13:12,030 --> 00:13:15,030
you run multiple multiple campaigns or

272
00:13:15,030 --> 00:13:18,360
you have malice pain campaigns and other

273
00:13:18,360 --> 00:13:19,750
malware pistol

274
00:13:19,750 --> 00:13:22,540
and third party payloads so on the back

275
00:13:22,540 --> 00:13:26,560
end you can keep track of what does it

276
00:13:26,560 --> 00:13:30,160
come every what the configuration

277
00:13:30,160 --> 00:13:33,220
timestamp we believe is a timestamp they

278
00:13:33,220 --> 00:13:36,550
computed on the operators set in in the

279
00:13:36,550 --> 00:13:42,250
samples for keeping track of when did

280
00:13:42,250 --> 00:13:46,570
they build them and here is when the

281
00:13:46,570 --> 00:13:48,160
thing gets interesting

282
00:13:48,160 --> 00:13:51,850
those are compromised FTP locations very

283
00:13:51,850 --> 00:13:54,580
likely stolen in previous cubed

284
00:13:54,580 --> 00:13:57,940
campaigns so they use this compromised

285
00:13:57,940 --> 00:14:02,070
FTP account to upload the stolen data

286
00:14:02,070 --> 00:14:06,400
the these are little eight addresses so

287
00:14:06,400 --> 00:14:09,550
we if they run one campaign and still

288
00:14:09,550 --> 00:14:14,680
this FTP access to a user in upcoming

289
00:14:14,680 --> 00:14:17,710
campaigns they are going to upload the

290
00:14:17,710 --> 00:14:20,470
stern information to this compromised

291
00:14:20,470 --> 00:14:24,430
FTP account finally there are some

292
00:14:24,430 --> 00:14:26,860
samples which don't have the campaign

293
00:14:26,860 --> 00:14:30,010
Navy for example this one and this is

294
00:14:30,010 --> 00:14:31,900
because this is more likely to be an

295
00:14:31,900 --> 00:14:34,870
update for Google so the company B is

296
00:14:34,870 --> 00:14:36,730
going to be inherited from the previous

297
00:14:36,730 --> 00:14:44,190
sample for the derivative later is

298
00:14:44,190 --> 00:14:46,020
pretty stifled war

299
00:14:46,020 --> 00:14:49,860
it has son of a station but very very

300
00:14:49,860 --> 00:14:54,310
very very little it will establish a

301
00:14:54,310 --> 00:14:57,040
communication with up to three

302
00:14:57,040 --> 00:15:01,210
controllers to essentially set unrelated

303
00:15:01,210 --> 00:15:04,810
kavod the communication has to Liza

304
00:15:04,810 --> 00:15:07,980
encoding an encryption this is just

305
00:15:07,980 --> 00:15:10,870
exciting encoding and after that we'll

306
00:15:10,870 --> 00:15:12,720
have rc4 encryption

307
00:15:12,720 --> 00:15:15,670
finally after these two letters we will

308
00:15:15,670 --> 00:15:19,770
have the final few board executable but

309
00:15:19,770 --> 00:15:24,370
before dropping to disk the javascript

310
00:15:24,370 --> 00:15:27,250
file is going to try some a bastion for

311
00:15:27,250 --> 00:15:29,770
antivirus over and for doing so is going

312
00:15:29,770 --> 00:15:32,860
to slide defective below into

313
00:15:32,860 --> 00:15:37,390
first 1000 bytes in one side and the

314
00:15:37,390 --> 00:15:40,060
very rest on another one this is

315
00:15:40,060 --> 00:15:43,270
basically taking the P header from a

316
00:15:43,270 --> 00:15:45,940
suitable file of frontiers of the file

317
00:15:45,940 --> 00:15:50,830
so I believe this second file even if it

318
00:15:50,830 --> 00:15:54,970
is happy and individuals award perhaps

319
00:15:54,970 --> 00:16:00,550
cannot analyze it properly so to ensure

320
00:16:00,550 --> 00:16:06,730
if this works for the last component in

321
00:16:06,730 --> 00:16:09,610
the resources for the core DLL we have

322
00:16:09,610 --> 00:16:13,500
to control a list which may have up to

323
00:16:13,500 --> 00:16:16,740
150 controllers per sample which is a

324
00:16:16,740 --> 00:16:21,760
lot and we can see here controls we'll

325
00:16:21,760 --> 00:16:24,790
listen in in many many many boards like

326
00:16:24,790 --> 00:16:35,950
443 or eighty ninety nine ninety five so

327
00:16:35,950 --> 00:16:41,620
for finalizing this internals of cubot

328
00:16:41,620 --> 00:16:44,050
will it here the export that comment

329
00:16:44,050 --> 00:16:45,790
because after establishing

330
00:16:45,790 --> 00:16:48,400
communications with the IP controllers

331
00:16:48,400 --> 00:16:51,730
we are so here the baton is going to

332
00:16:51,730 --> 00:16:53,980
request devotes to exactly some commands

333
00:16:53,980 --> 00:16:58,330
and those comments are listed here for

334
00:16:58,330 --> 00:17:00,190
the sake of simplicity we only have

335
00:17:00,190 --> 00:17:03,850
renamed the most you set one for the

336
00:17:03,850 --> 00:17:07,089
began and that is fitting Cuba dates

337
00:17:07,089 --> 00:17:09,819
this is the second method for fitting

338
00:17:09,819 --> 00:17:13,869
all they did cubot sideswipe in yet and

339
00:17:13,869 --> 00:17:18,750
that plugins also it has

340
00:17:18,750 --> 00:17:21,839
our movement capabilities it we are

341
00:17:21,839 --> 00:17:24,089
going to discuss later oh by the way a

342
00:17:24,089 --> 00:17:27,119
cute version is also in this beta

343
00:17:27,119 --> 00:17:29,490
section of the P here we have the three

344
00:17:29,490 --> 00:17:32,039
two two version and here the three two

345
00:17:32,039 --> 00:17:34,070
three three two three

346
00:17:34,070 --> 00:17:37,320
they are different in terms this one

347
00:17:37,320 --> 00:17:40,559
exports more comments they are always

348
00:17:40,559 --> 00:17:42,480
having new comments or removing existing

349
00:17:42,480 --> 00:17:50,070
ones so now that we'll have an overview

350
00:17:50,070 --> 00:17:54,330
into the technical internals of the

351
00:17:54,330 --> 00:17:57,360
thread let's try to talk a bit more

352
00:17:57,360 --> 00:18:01,080
about the operation so we started

353
00:18:01,080 --> 00:18:03,750
tracking cubot in May 2000 nineteen and

354
00:18:03,750 --> 00:18:07,860
we have collected all these versions so

355
00:18:07,860 --> 00:18:11,450
we can tell you these guys do code and

356
00:18:11,450 --> 00:18:15,020
do like coding and I new filters

357
00:18:15,020 --> 00:18:18,179
many of the versions only saw minor

358
00:18:18,179 --> 00:18:21,150
updates but for other ones we have seen

359
00:18:21,150 --> 00:18:24,270
new commands remove commands and also

360
00:18:24,270 --> 00:18:28,668
new methods for not a fist infiltration

361
00:18:30,860 --> 00:18:35,039
the company is we were discussing before

362
00:18:35,039 --> 00:18:38,250
in the embark config they will all of

363
00:18:38,250 --> 00:18:40,260
the operators of the bone to keep track

364
00:18:40,260 --> 00:18:42,179
of the infection the source of

365
00:18:42,179 --> 00:18:46,740
disinfectants for campaigns SP and SPX

366
00:18:46,740 --> 00:18:49,260
they are for sure delivered through one

367
00:18:49,260 --> 00:18:52,080
spam email spam waves Nick was

368
00:18:52,080 --> 00:18:58,080
describing and for the 888 campaigns to

369
00:18:58,080 --> 00:19:02,700
serve for further added the EU here

370
00:19:02,700 --> 00:19:06,600
I believe it stands for Europe because

371
00:19:06,600 --> 00:19:09,480
this wave was just target in Europe so

372
00:19:09,480 --> 00:19:11,970
you have another IP address you will get

373
00:19:11,970 --> 00:19:17,490
this cubed sample and nowadays there are

374
00:19:17,490 --> 00:19:22,190
ongoing queue world campaigns under SPX

375
00:19:22,190 --> 00:19:25,559
campaign Navy and these are incrementing

376
00:19:25,559 --> 00:19:27,480
numbers for example I think the last one

377
00:19:27,480 --> 00:19:30,450
was SP x26

378
00:19:30,450 --> 00:19:33,200
campaign ad

379
00:19:36,810 --> 00:19:42,490
so we said we have up to 150 controllers

380
00:19:42,490 --> 00:19:46,450
per sample and as we have been trading

381
00:19:46,450 --> 00:19:49,090
this thread since May we have up to

382
00:19:49,090 --> 00:19:52,690
three thousand unique controllers from

383
00:19:52,690 --> 00:19:57,120
kuat which we have brought in in this

384
00:19:57,120 --> 00:20:01,840
deal distribution a scam I don't know if

385
00:20:01,840 --> 00:20:04,570
we have told you this already but

386
00:20:04,570 --> 00:20:07,530
keyword is targeted mainly the US and

387
00:20:07,530 --> 00:20:12,900
Canada so it makes sense for all the

388
00:20:12,900 --> 00:20:15,880
controllers to be located in the United

389
00:20:15,880 --> 00:20:19,990
States it will arise less suspicions if

390
00:20:19,990 --> 00:20:24,100
you see ongoing Canadians to do yes from

391
00:20:24,100 --> 00:20:27,760
the US so if you see some connectors

392
00:20:27,760 --> 00:20:31,870
from for Russia or from for China maybe

393
00:20:31,870 --> 00:20:34,680
you can flag the traffic a suspicious

394
00:20:34,680 --> 00:20:39,490
another point is that the first line of

395
00:20:39,490 --> 00:20:41,650
qubit controllers are actually just

396
00:20:41,650 --> 00:20:44,230
proxies and these proxies are made up of

397
00:20:44,230 --> 00:20:47,310
infected bots so they have basically an

398
00:20:47,310 --> 00:20:51,370
endless supply of front-end proxies and

399
00:20:51,370 --> 00:20:53,200
that's why we're seeing the front-end

400
00:20:53,200 --> 00:20:54,700
proxies located in countries where they

401
00:20:54,700 --> 00:20:56,950
focus most of their attention it's

402
00:20:56,950 --> 00:20:59,080
really nice because it hides the backend

403
00:20:59,080 --> 00:21:01,840
from prying eyes like us and law

404
00:21:01,840 --> 00:21:04,960
enforcement as well and it's it's free

405
00:21:04,960 --> 00:21:08,050
to them they're just reusing resources

406
00:21:08,050 --> 00:21:14,740
that they already have so we introduced

407
00:21:14,740 --> 00:21:20,760
cubot as a molar information s tiller

408
00:21:20,760 --> 00:21:22,290
this means

409
00:21:22,290 --> 00:21:27,070
cubot can extend its functionality with

410
00:21:27,070 --> 00:21:30,360
orginal plugins so far we have seen

411
00:21:30,360 --> 00:21:35,200
these three here the platform rubber has

412
00:21:35,200 --> 00:21:37,480
been here since the very beginning of

413
00:21:37,480 --> 00:21:40,180
the operation it will felt credential

414
00:21:40,180 --> 00:21:44,680
from services like pop3 also SDP to use

415
00:21:44,680 --> 00:21:45,760
later in the

416
00:21:45,760 --> 00:21:48,190
as filtration professors for the stolen

417
00:21:48,190 --> 00:21:53,710
data one really interesting part about

418
00:21:53,710 --> 00:21:56,800
the cookie wherever model first time we

419
00:21:56,800 --> 00:21:59,680
saw this one was in August 2000 nineteen

420
00:21:59,680 --> 00:22:05,890
and it turns out that trip bot group

421
00:22:05,890 --> 00:22:10,420
release a cookie model in your life 2019

422
00:22:10,420 --> 00:22:14,410
so three brothers in a cookie rubber

423
00:22:14,410 --> 00:22:19,290
model in July and Bing cubed in August

424
00:22:19,290 --> 00:22:22,150
mega hat makes us seen that there is

425
00:22:22,150 --> 00:22:25,510
some kind of relationship within the

426
00:22:25,510 --> 00:22:28,210
groups like hey guys we have released

427
00:22:28,210 --> 00:22:31,390
this model and it's working is useful or

428
00:22:31,390 --> 00:22:35,050
perhaps they just saw it and this they

429
00:22:35,050 --> 00:22:37,840
thought to yourself perhaps we will code

430
00:22:37,840 --> 00:22:43,600
another one for us we don't know the

431
00:22:43,600 --> 00:22:45,220
last model we want to discuss here is

432
00:22:45,220 --> 00:22:51,150
the play model which will make this

433
00:22:51,150 --> 00:22:55,060
Infotech computers part of cubed in

434
00:22:55,060 --> 00:22:57,910
fractal too so we have impacted system

435
00:22:57,910 --> 00:23:00,970
new integrity system already impacted

436
00:23:00,970 --> 00:23:04,330
system acting as proxies intermediate

437
00:23:04,330 --> 00:23:08,920
nodes and the final cubed again - with

438
00:23:08,920 --> 00:23:13,750
all of these intermediate infra which is

439
00:23:13,750 --> 00:23:15,880
very clever actually so you increase the

440
00:23:15,880 --> 00:23:18,190
uptime from the real controllers so you

441
00:23:18,190 --> 00:23:22,410
have to reign style in another servers

442
00:23:23,400 --> 00:23:26,490
so let's go now let's move into the

443
00:23:26,490 --> 00:23:32,050
stolen data you both resist this as

444
00:23:32,050 --> 00:23:36,010
distant plates for uploading the data

445
00:23:36,010 --> 00:23:38,830
we've told from infected users the

446
00:23:38,830 --> 00:23:41,260
fields from the template are highlighted

447
00:23:41,260 --> 00:23:44,680
in red they are self explanatory time

448
00:23:44,680 --> 00:23:49,780
URL later referrer they seem to have a

449
00:23:49,780 --> 00:23:52,450
lock with Windows 10 and it's processor

450
00:23:52,450 --> 00:23:55,980
as we have see here this back attack

451
00:23:55,980 --> 00:23:59,290
well the filthy

452
00:23:59,290 --> 00:24:01,330
is not very self-explanatory but it

453
00:24:01,330 --> 00:24:06,120
stands for fourth type so 8/2 will be

454
00:24:06,120 --> 00:24:10,170
beta gathereth through hooking HTTP or

455
00:24:10,170 --> 00:24:15,130
HTTPS requests so every HTTP site that's

456
00:24:15,130 --> 00:24:17,530
visited by the infected user all the

457
00:24:17,530 --> 00:24:20,500
cookies and the site itself are sent

458
00:24:20,500 --> 00:24:23,560
back to the Cuba operators so they can

459
00:24:23,560 --> 00:24:26,380
see if you're visiting interesting sites

460
00:24:26,380 --> 00:24:28,660
like banking websites that will draw

461
00:24:28,660 --> 00:24:30,070
their attention towards you this is how

462
00:24:30,070 --> 00:24:31,540
they find the interesting victims from

463
00:24:31,540 --> 00:24:31,990
them

464
00:24:31,990 --> 00:24:33,610
you know thousands of pots that they

465
00:24:33,610 --> 00:24:38,020
have notice also another type which is

466
00:24:38,020 --> 00:24:41,770
denoted by K B which is stands for

467
00:24:41,770 --> 00:24:46,590
keyboard so this T login technique will

468
00:24:46,590 --> 00:24:51,760
take K strokes from P program the

469
00:24:51,760 --> 00:24:54,730
windows title so it for this case they

470
00:24:54,730 --> 00:24:59,160
are killing in in Chrome in a catalog in

471
00:24:59,160 --> 00:25:02,680
Google Chrome window and this will be

472
00:25:02,680 --> 00:25:08,280
the data gathered through the keystrokes

473
00:25:09,210 --> 00:25:12,220
for this is like we have some poetic

474
00:25:12,220 --> 00:25:13,110
justice

475
00:25:13,110 --> 00:25:17,920
because if to check the kind of report

476
00:25:17,920 --> 00:25:20,500
here is also keyboard so this data is

477
00:25:20,500 --> 00:25:22,600
collected through collodion and we have

478
00:25:22,600 --> 00:25:25,140
this I have an important message for you

479
00:25:25,140 --> 00:25:30,760
this starts interesting about my late

480
00:25:30,760 --> 00:25:34,800
client bla la la which has a deposit of

481
00:25:34,800 --> 00:25:39,400
10.5 million dollars so if you want more

482
00:25:39,400 --> 00:25:40,960
information I can give you full details

483
00:25:40,960 --> 00:25:45,910
had the see Frank at us a.com same on

484
00:25:45,910 --> 00:25:48,880
this guy is a scammer for one name is

485
00:25:48,880 --> 00:25:58,930
camera is infected with cured for the

486
00:25:58,930 --> 00:26:01,720
lateral movement which we have to

487
00:26:01,720 --> 00:26:04,480
discuss our less because this like they

488
00:26:04,480 --> 00:26:06,220
they

489
00:26:06,220 --> 00:26:09,520
the topic now and networks being

490
00:26:09,520 --> 00:26:12,700
infected by a man would like trick both

491
00:26:12,700 --> 00:26:17,679
imitate drive x-cubed we perform this

492
00:26:17,679 --> 00:26:19,750
protection and after that they run from

493
00:26:19,750 --> 00:26:23,559
the network cubed has lateral movement

494
00:26:23,559 --> 00:26:27,159
capabilities it's the common 13 it has

495
00:26:27,159 --> 00:26:29,230
to be issued for again to be executed

496
00:26:29,230 --> 00:26:33,250
and it will take advantage of the net

497
00:26:33,250 --> 00:26:35,799
videos protocol to spread through

498
00:26:35,799 --> 00:26:39,760
internet network to do so it will try to

499
00:26:39,760 --> 00:26:42,880
use the administrator account and in

500
00:26:42,880 --> 00:26:47,620
case it has a password cubed has him in

501
00:26:47,620 --> 00:26:50,140
one of the recording plates this part of

502
00:26:50,140 --> 00:26:53,200
password listing to used against the

503
00:26:53,200 --> 00:26:56,230
administrator account is going to put a

504
00:26:56,230 --> 00:27:00,070
force his way into another shirt to

505
00:27:00,070 --> 00:27:04,690
basically test in them also it has the

506
00:27:04,690 --> 00:27:07,120
capability to execute this Power Cell

507
00:27:07,120 --> 00:27:10,090
common which we'll say it a Power Cell

508
00:27:10,090 --> 00:27:12,520
is freed from a remote location in this

509
00:27:12,520 --> 00:27:16,230
state is Dropbox will be another one

510
00:27:16,230 --> 00:27:20,730
this Power Cell will have two dll's

511
00:27:20,730 --> 00:27:25,059
within the code and looser unica's dll's

512
00:27:25,059 --> 00:27:30,240
which it cool use to try further the

513
00:27:30,240 --> 00:27:33,520
administration administration account

514
00:27:33,520 --> 00:27:37,059
brutal force or just to report to the

515
00:27:37,059 --> 00:27:40,240
Kommandant controls the passwords such

516
00:27:40,240 --> 00:27:45,190
as through through mini cuts there are

517
00:27:45,190 --> 00:27:48,130
claims my some vendors but cubot may be

518
00:27:48,130 --> 00:27:51,610
behind some pushing trucks on ransomware

519
00:27:51,610 --> 00:27:55,659
outbreak it is not confirmed and we

520
00:27:55,659 --> 00:27:58,809
don't even confirm it or deny it but

521
00:27:58,809 --> 00:28:02,320
it's just a chance you are exposed you

522
00:28:02,320 --> 00:28:08,820
have activity in fact in your network so

523
00:28:08,820 --> 00:28:13,210
now that we have some overview into your

524
00:28:13,210 --> 00:28:15,370
internals at the

525
00:28:15,370 --> 00:28:18,309
did operation Nick is going to walk us

526
00:28:18,309 --> 00:28:22,600
through the vendor footprint so what am

527
00:28:22,600 --> 00:28:24,330
I talking about with vendor footprint

528
00:28:24,330 --> 00:28:26,590
the cubed operators have done a really

529
00:28:26,590 --> 00:28:29,830
good job to stay under the radar we

530
00:28:29,830 --> 00:28:30,999
don't know who they are we don't know

531
00:28:30,999 --> 00:28:32,999
who they're what their handles are

532
00:28:32,999 --> 00:28:36,389
however we do realize that they

533
00:28:36,389 --> 00:28:40,029
extensively use services of vendors in

534
00:28:40,029 --> 00:28:43,169
the underground economy and by

535
00:28:43,169 --> 00:28:46,259
investigating those vendors we can see

536
00:28:46,259 --> 00:28:49,119
who has connections to the cubot

537
00:28:49,119 --> 00:28:50,980
operators and what vendors they're using

538
00:28:50,980 --> 00:28:52,299
so that's what we're going to talk about

539
00:28:52,299 --> 00:28:54,100
next and this is something that I'm

540
00:28:54,100 --> 00:28:57,840
calling the the vendor footprint of Cuba

541
00:28:57,840 --> 00:29:00,249
one of the services that they use is

542
00:29:00,249 --> 00:29:04,480
code signing code signing is used by

543
00:29:04,480 --> 00:29:08,289
legitimate software vendors to ensure

544
00:29:08,289 --> 00:29:10,210
that the software that they release to

545
00:29:10,210 --> 00:29:12,460
their users has not been tampered with

546
00:29:12,460 --> 00:29:15,580
so before they so they get a secure key

547
00:29:15,580 --> 00:29:20,110
from a company like Komodo or Symantec

548
00:29:20,110 --> 00:29:22,179
then they sign their binaries with this

549
00:29:22,179 --> 00:29:23,889
key and then they release these signed

550
00:29:23,889 --> 00:29:27,009
binaries and the reason why malware

551
00:29:27,009 --> 00:29:29,799
authors are interested in code signing

552
00:29:29,799 --> 00:29:32,470
is because it can help to bypass

553
00:29:32,470 --> 00:29:34,869
features protection features of Windows

554
00:29:34,869 --> 00:29:38,169
like smart screen which it will

555
00:29:38,169 --> 00:29:41,289
generally increase the chance that when

556
00:29:41,289 --> 00:29:43,200
a user when an end-user when a victim

557
00:29:43,200 --> 00:29:45,399
clicks on the malware or executes the

558
00:29:45,399 --> 00:29:47,470
malware in some way that this malware

559
00:29:47,470 --> 00:29:49,360
will be allowed to execute on the victim

560
00:29:49,360 --> 00:29:52,809
machine so the cubot operators have used

561
00:29:52,809 --> 00:29:57,879
code signing in to 2019 and and

562
00:29:57,879 --> 00:30:00,549
previously before but they don't do it

563
00:30:00,549 --> 00:30:02,649
for everything so they don't use code

564
00:30:02,649 --> 00:30:05,080
signing on updates but only for this the

565
00:30:05,080 --> 00:30:06,700
mouse spam campaigns that they're trying

566
00:30:06,700 --> 00:30:11,619
to spread in our tracking we notice that

567
00:30:11,619 --> 00:30:13,799
okay you can't really see it so well but

568
00:30:13,799 --> 00:30:18,249
in about June we saw a lot of code

569
00:30:18,249 --> 00:30:21,999
signed cubot binaries but then later on

570
00:30:21,999 --> 00:30:24,220
we saw none and these two are kind of

571
00:30:24,220 --> 00:30:26,529
anomalous these are actually older

572
00:30:26,529 --> 00:30:28,659
versions that we just hadn't seen

573
00:30:28,659 --> 00:30:31,629
four and then we we pick them up later

574
00:30:31,629 --> 00:30:35,229
in our sample collection and process

575
00:30:35,229 --> 00:30:38,229
them so we're seeing them stop using

576
00:30:38,229 --> 00:30:42,849
this tactic in the early days of cubot a

577
00:30:42,849 --> 00:30:46,830
semantic report from 2011 suggested that

578
00:30:46,830 --> 00:30:50,349
human operators were were stealing the

579
00:30:50,349 --> 00:30:52,450
signing keys from their victims and

580
00:30:52,450 --> 00:30:57,359
using them but we think that in 2019

581
00:30:57,359 --> 00:31:00,279
Cuba operators are not doing this

582
00:31:00,279 --> 00:31:01,989
anymore we think it's more likely that

583
00:31:01,989 --> 00:31:04,929
they're using vendors in the underground

584
00:31:04,929 --> 00:31:08,919
economy and this is a post from an actor

585
00:31:08,919 --> 00:31:12,369
in an online forum saying I'd like to

586
00:31:12,369 --> 00:31:17,679
offer you this service for $300 I will

587
00:31:17,679 --> 00:31:20,019
sign your malware and it will it will

588
00:31:20,019 --> 00:31:21,489
look legitimate and you can see that

589
00:31:21,489 --> 00:31:24,099
from the screenshots previously this

590
00:31:24,099 --> 00:31:26,799
says well it says it cannot be verified

591
00:31:26,799 --> 00:31:30,700
because these certificates were revoked

592
00:31:30,700 --> 00:31:34,840
but at the time that they were spread

593
00:31:34,840 --> 00:31:37,179
these were valid and Windows thought

594
00:31:37,179 --> 00:31:41,739
that they were valid another thing that

595
00:31:41,739 --> 00:31:44,080
makes us think that they stopped using

596
00:31:44,080 --> 00:31:46,359
stolen keys from their victims and

597
00:31:46,359 --> 00:31:49,059
switched to a vendor is because all of

598
00:31:49,059 --> 00:31:53,169
the code sign samples that we found were

599
00:31:53,169 --> 00:31:55,659
these keys were issued to companies in

600
00:31:55,659 --> 00:31:59,019
the UK every single one and if they were

601
00:31:59,019 --> 00:32:04,210
using keys the stolen from bots we

602
00:32:04,210 --> 00:32:05,499
should see a wider geographic

603
00:32:05,499 --> 00:32:07,269
distribution and because we don't see

604
00:32:07,269 --> 00:32:10,330
that it's it's another indication that

605
00:32:10,330 --> 00:32:13,899
they're using one of these online code

606
00:32:13,899 --> 00:32:16,349
signing vendors from the underground

607
00:32:16,349 --> 00:32:18,669
next I'm going to talk about web injects

608
00:32:18,669 --> 00:32:21,999
I feel like I might need to explain what

609
00:32:21,999 --> 00:32:24,450
a web inject is so I'll do so briefly

610
00:32:24,450 --> 00:32:27,700
when you go to a web site when you're

611
00:32:27,700 --> 00:32:29,139
infected with Cuba and you go to a

612
00:32:29,139 --> 00:32:31,450
website in your browser that interests

613
00:32:31,450 --> 00:32:34,059
them like a banking website or Amazon or

614
00:32:34,059 --> 00:32:36,450
something like that what they can do is

615
00:32:36,450 --> 00:32:39,309
your browser will request the page and

616
00:32:39,309 --> 00:32:42,270
and Amazon if that's the the page

617
00:32:42,270 --> 00:32:45,330
we'll we'll send a response and before

618
00:32:45,330 --> 00:32:48,330
the browser renders that response they

619
00:32:48,330 --> 00:32:51,150
will inject some additional HTML and

620
00:32:51,150 --> 00:32:52,980
JavaScript to do things like add

621
00:32:52,980 --> 00:32:55,470
additional fields like what's the

622
00:32:55,470 --> 00:32:57,420
mother's maiden name what's your secret

623
00:32:57,420 --> 00:33:01,080
question they'll try to also trick you

624
00:33:01,080 --> 00:33:03,540
into using into giving like an

625
00:33:03,540 --> 00:33:05,640
authentication token that they can then

626
00:33:05,640 --> 00:33:07,860
use to make it a transaction like a bank

627
00:33:07,860 --> 00:33:11,850
transfer and we see the Cuba operators

628
00:33:11,850 --> 00:33:14,190
using several different vendors for web

629
00:33:14,190 --> 00:33:18,090
injects web injects are actually not the

630
00:33:18,090 --> 00:33:20,970
most simple thing to to develop and

631
00:33:20,970 --> 00:33:22,950
maintain you have to have access to the

632
00:33:22,950 --> 00:33:24,780
bank's website you have to spend a lot

633
00:33:24,780 --> 00:33:26,190
of time learning how the bank website

634
00:33:26,190 --> 00:33:29,400
works and it's something that a lot of

635
00:33:29,400 --> 00:33:32,130
banking Trojans outsource and Cuba

636
00:33:32,130 --> 00:33:35,730
interestingly enough has outsourced to

637
00:33:35,730 --> 00:33:38,130
at least three different vendors

638
00:33:38,130 --> 00:33:41,760
possibly more the web injects for Cuba

639
00:33:41,760 --> 00:33:43,559
are mostly targeting the banking sector

640
00:33:43,559 --> 00:33:46,590
financial services online payments

641
00:33:46,590 --> 00:33:48,000
online shopping interestingly enough

642
00:33:48,000 --> 00:33:49,590
they're targeting Verizon which is a

643
00:33:49,590 --> 00:33:52,110
telecommunications company a cell phone

644
00:33:52,110 --> 00:33:54,840
company in the United States mostly in

645
00:33:54,840 --> 00:33:57,450
the United States in Canada but this can

646
00:33:57,450 --> 00:33:59,370
change at any time or it could be that

647
00:33:59,370 --> 00:34:02,280
we didn't detect the campaign that

648
00:34:02,280 --> 00:34:08,699
targeted other region so this is sort of

649
00:34:08,699 --> 00:34:11,340
what part of a web inject looks like

650
00:34:11,340 --> 00:34:13,800
it's just JavaScript this one in

651
00:34:13,800 --> 00:34:16,830
particular is a TS engine by an actor

652
00:34:16,830 --> 00:34:19,710
called Yuma Yuma has been around since

653
00:34:19,710 --> 00:34:23,399
the early zeus days they're probably the

654
00:34:23,399 --> 00:34:26,730
oldest web inject vendor that I know of

655
00:34:26,730 --> 00:34:30,149
and they offer their services for here

656
00:34:30,149 --> 00:34:33,929
you can see $3,500 for Chase Bank and

657
00:34:33,929 --> 00:34:36,719
that is a complete solution that

658
00:34:36,719 --> 00:34:41,790
requires no interaction from the from

659
00:34:41,790 --> 00:34:44,070
the operator it's it's the ATS automatic

660
00:34:44,070 --> 00:34:47,790
transfer system in the case of Cuba

661
00:34:47,790 --> 00:34:51,869
they're targeting eBay PayPal and Amazon

662
00:34:51,869 --> 00:34:55,800
with this web inject kit I want

663
00:34:55,800 --> 00:34:58,230
also make a note about this gate key

664
00:34:58,230 --> 00:35:03,200
here this is the default gate key that

665
00:35:03,200 --> 00:35:07,350
that is when you buy a 80s engine that's

666
00:35:07,350 --> 00:35:08,910
the default gate key that that you're

667
00:35:08,910 --> 00:35:12,360
given when you set up that software and

668
00:35:12,360 --> 00:35:15,060
I've seen previous researchers say oh

669
00:35:15,060 --> 00:35:18,390
I've seen this key used by three or four

670
00:35:18,390 --> 00:35:20,250
different banking Trojans there must be

671
00:35:20,250 --> 00:35:22,200
some sort of link there but I think the

672
00:35:22,200 --> 00:35:24,000
link would be very weak given that this

673
00:35:24,000 --> 00:35:26,160
is the default key and anyone who

674
00:35:26,160 --> 00:35:29,730
purchases the the AES engine and doesn't

675
00:35:29,730 --> 00:35:31,170
change the default settings would would

676
00:35:31,170 --> 00:35:32,910
have that gate key now if that gate key

677
00:35:32,910 --> 00:35:34,860
were changed then that would be an

678
00:35:34,860 --> 00:35:36,890
indication that there could be a link

679
00:35:36,890 --> 00:35:41,700
the next one was first mentioned by a

680
00:35:41,700 --> 00:35:43,740
former colleague of mine James Wieck at

681
00:35:43,740 --> 00:35:45,660
bot comp and an excellent talk that he

682
00:35:45,660 --> 00:35:49,440
gave about web injects we don't know

683
00:35:49,440 --> 00:35:54,920
still who is behind this webbing jetpack

684
00:35:54,920 --> 00:35:57,870
but it's it's denoted it's been named

685
00:35:57,870 --> 00:36:00,330
ing underscore ing because of variable

686
00:36:00,330 --> 00:36:04,050
names that that were assigned in the in

687
00:36:04,050 --> 00:36:05,790
that you'll find in it it's heavily

688
00:36:05,790 --> 00:36:07,200
obfuscated here's some of the less

689
00:36:07,200 --> 00:36:12,360
obfuscated code there are some key words

690
00:36:12,360 --> 00:36:14,760
in here like I'd mean capaz that you

691
00:36:14,760 --> 00:36:16,380
might be able to recognize if you see

692
00:36:16,380 --> 00:36:18,510
this in the wild and this is what the

693
00:36:18,510 --> 00:36:20,940
the panel the login panel looks like for

694
00:36:20,940 --> 00:36:27,300
the operator the third vendor that we

695
00:36:27,300 --> 00:36:31,470
know is their services are purchased by

696
00:36:31,470 --> 00:36:35,070
the Q Bar operators is cactus 1010

697
00:36:35,070 --> 00:36:39,420
cactus 1010 has a nice service there's

698
00:36:39,420 --> 00:36:42,450
their website where you can buy you can

699
00:36:42,450 --> 00:36:44,730
shop for web injects by brand by country

700
00:36:44,730 --> 00:36:47,760
it's on it's on the it's on tour it's

701
00:36:47,760 --> 00:36:50,370
it's an onion server this is a

702
00:36:50,370 --> 00:36:53,100
screenshot of the panel what it looks

703
00:36:53,100 --> 00:36:55,440
like to the operator we have this

704
00:36:55,440 --> 00:36:58,830
because cactus provided sample videos on

705
00:36:58,830 --> 00:37:01,500
their website and this is what the login

706
00:37:01,500 --> 00:37:03,420
panel looks like if anyone is following

707
00:37:03,420 --> 00:37:07,560
along in investigating web injects this

708
00:37:07,560 --> 00:37:09,210
is how you can tell that you're looking

709
00:37:09,210 --> 00:37:10,140
at

710
00:37:10,140 --> 00:37:13,230
you panel and you panel stands for

711
00:37:13,230 --> 00:37:17,220
universal panel which means you purchase

712
00:37:17,220 --> 00:37:18,780
this service and all your web inject

713
00:37:18,780 --> 00:37:22,790
needs are met it can grab tokens it can

714
00:37:22,790 --> 00:37:26,069
do automatic transfers it's a very

715
00:37:26,069 --> 00:37:28,319
capable and it seems to be pretty

716
00:37:28,319 --> 00:37:31,619
popular as well and cubot specifically

717
00:37:31,619 --> 00:37:33,569
is using it to target American Express

718
00:37:33,569 --> 00:37:37,260
Verizon and Costco I have a little bit

719
00:37:37,260 --> 00:37:41,839
of time left so I'd like to talk about

720
00:37:41,839 --> 00:37:46,680
two web injects sets packs that we found

721
00:37:46,680 --> 00:37:48,599
where we don't know who the vendor is in

722
00:37:48,599 --> 00:37:49,740
fact we don't really know anything about

723
00:37:49,740 --> 00:37:50,819
it at all

724
00:37:50,819 --> 00:37:53,280
and as far as I know I couldn't find any

725
00:37:53,280 --> 00:37:55,020
references to it in open source

726
00:37:55,020 --> 00:37:58,099
intelligence well I'm calling it bucha

727
00:37:58,099 --> 00:38:00,809
simply because they used the name bucha

728
00:38:00,809 --> 00:38:03,930
a lot i rep through the file and found

729
00:38:03,930 --> 00:38:07,020
the book a button book a timer bucha

730
00:38:07,020 --> 00:38:10,290
mein Buch a pop-up so if anyone is

731
00:38:10,290 --> 00:38:11,640
looking at web injects and they've seen

732
00:38:11,640 --> 00:38:13,650
this bucha stuff I'd like to talk with

733
00:38:13,650 --> 00:38:14,819
you

734
00:38:14,819 --> 00:38:18,480
cubot is using it this vendor to target

735
00:38:18,480 --> 00:38:20,520
United States banks big banks in the

736
00:38:20,520 --> 00:38:24,210
United States it's also heavily

737
00:38:24,210 --> 00:38:26,040
obfuscated this is some of the less

738
00:38:26,040 --> 00:38:28,440
obfuscated stuff that might be

739
00:38:28,440 --> 00:38:32,119
recognizable to someone and then finally

740
00:38:32,119 --> 00:38:36,839
I'll talk about Cortez Cortez is less

741
00:38:36,839 --> 00:38:39,000
sophisticated than the other web injects

742
00:38:39,000 --> 00:38:40,770
it doesn't use any obfuscation at all

743
00:38:40,770 --> 00:38:43,099
everything is completely in clear text

744
00:38:43,099 --> 00:38:46,650
personally it looks to me like someone's

745
00:38:46,650 --> 00:38:49,410
first foray into web injects like

746
00:38:49,410 --> 00:38:52,710
they're just learning and in fact it for

747
00:38:52,710 --> 00:38:54,569
Cuba they only use it to target a single

748
00:38:54,569 --> 00:38:57,000
bank it could be that other vendors

749
00:38:57,000 --> 00:38:59,160
weren't working well with that bank and

750
00:38:59,160 --> 00:39:00,359
maybe they tried their own hand that's

751
00:39:00,359 --> 00:39:01,230
something that they weren't familiar

752
00:39:01,230 --> 00:39:03,900
with or they outsource the work to

753
00:39:03,900 --> 00:39:07,290
someone who wasn't as experienced as the

754
00:39:07,290 --> 00:39:09,839
other vendors the reason why I called it

755
00:39:09,839 --> 00:39:11,940
Cortez is it simply because the the gait

756
00:39:11,940 --> 00:39:14,700
path is called Cortez that PHP there

757
00:39:14,700 --> 00:39:16,260
really wasn't anything else that I that

758
00:39:16,260 --> 00:39:21,530
was unique about it so

759
00:39:21,530 --> 00:39:25,910
for for Cuba we are able to learn that

760
00:39:25,910 --> 00:39:29,480
they have an extensive operation where

761
00:39:29,480 --> 00:39:31,610
they use open-source tools they use

762
00:39:31,610 --> 00:39:32,900
their own developed tools they use a

763
00:39:32,900 --> 00:39:34,490
Trojan that they've been using for ten

764
00:39:34,490 --> 00:39:37,190
years almost they continuously develop

765
00:39:37,190 --> 00:39:39,560
it but they're not afraid to use vendors

766
00:39:39,560 --> 00:39:42,950
for spreading them out we're for doing

767
00:39:42,950 --> 00:39:44,720
web injects and also for bypassing

768
00:39:44,720 --> 00:39:46,750
security solutions of the code signing

769
00:39:46,750 --> 00:39:49,430
it's the mark in my opinion of a

770
00:39:49,430 --> 00:39:52,130
sophisticated group if anybody wants to

771
00:39:52,130 --> 00:39:53,990
play along at home with the samples

772
00:39:53,990 --> 00:39:58,160
we've got some hashes for you it's kind

773
00:39:58,160 --> 00:40:00,440
of pointless to give IFC's of the of the

774
00:40:00,440 --> 00:40:02,270
controllers because they change so often

775
00:40:02,270 --> 00:40:07,220
although I did give the latest domain

776
00:40:07,220 --> 00:40:09,860
actually it's not the latest domain it

777
00:40:09,860 --> 00:40:13,580
it changed this is one domain that they

778
00:40:13,580 --> 00:40:15,950
were using for almost a year for

779
00:40:15,950 --> 00:40:18,290
fetching web injects that's where they

780
00:40:18,290 --> 00:40:20,510
were hosting it behind this domain it's

781
00:40:20,510 --> 00:40:22,490
now CDN metrics com

782
00:40:22,490 --> 00:40:24,440
finally someone took it down or

783
00:40:24,440 --> 00:40:28,570
something I'd like to wrap up with just

784
00:40:28,570 --> 00:40:34,070
a few words about cubot personally I

785
00:40:34,070 --> 00:40:36,610
would consider it a high-priority threat

786
00:40:36,610 --> 00:40:38,810
just given the amount of experience that

787
00:40:38,810 --> 00:40:41,090
they have and the the fact that if you

788
00:40:41,090 --> 00:40:42,950
see this on your network they're either

789
00:40:42,950 --> 00:40:44,870
going to make money off of your off of

790
00:40:44,870 --> 00:40:48,920
your computers by making account

791
00:40:48,920 --> 00:40:51,680
transfers or they can decide to ransom

792
00:40:51,680 --> 00:40:52,940
your data and they have the tools to

793
00:40:52,940 --> 00:40:55,490
answer to do full ransom of all machines

794
00:40:55,490 --> 00:40:58,460
in the network and it's also not a

795
00:40:58,460 --> 00:41:01,070
threat that will be likely to disappear

796
00:41:01,070 --> 00:41:04,220
anytime soon unless there's some law

797
00:41:04,220 --> 00:41:06,140
enforcement operation that I'm not aware

798
00:41:06,140 --> 00:41:08,270
of but given that they've been in the

799
00:41:08,270 --> 00:41:10,970
scene for over a decade I think they're

800
00:41:10,970 --> 00:41:14,300
here to stay and I'd like to invite

801
00:41:14,300 --> 00:41:17,510
anyone who's researching cubot to to

802
00:41:17,510 --> 00:41:19,520
contact us we're happy to work with

803
00:41:19,520 --> 00:41:21,950
anyone who is doing research into cube

804
00:41:21,950 --> 00:41:25,200
lot as well and thanks for your time

805
00:41:25,200 --> 00:41:27,259
you

