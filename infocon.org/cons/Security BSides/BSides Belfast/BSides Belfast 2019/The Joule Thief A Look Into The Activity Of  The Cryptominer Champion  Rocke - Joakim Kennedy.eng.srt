1
00:00:00,530 --> 00:00:02,460
you

2
00:00:02,460 --> 00:00:05,730
good morning everyone so as we heard

3
00:00:05,730 --> 00:00:09,390
we're gonna go over the jewel thief so

4
00:00:09,390 --> 00:00:11,550
this is a campaign that we've been

5
00:00:11,550 --> 00:00:16,079
tracking for the last nine months but

6
00:00:16,079 --> 00:00:17,369
then also we've got a spam back in

7
00:00:17,369 --> 00:00:19,470
actually take a look at previous

8
00:00:19,470 --> 00:00:21,240
activity and sort of like put together

9
00:00:21,240 --> 00:00:24,210
what this actor has been doing so Who am

10
00:00:24,210 --> 00:00:28,350
I and my name is Hakim Kennedy and I am

11
00:00:28,350 --> 00:00:31,470
a threat intelligence manager for the

12
00:00:31,470 --> 00:00:34,829
research team that in anomaly sort of

13
00:00:34,829 --> 00:00:36,360
under the umbrella of anomaly threat

14
00:00:36,360 --> 00:00:40,230
research I love to do research explores

15
00:00:40,230 --> 00:00:42,989
stuff and when I don't do that I also

16
00:00:42,989 --> 00:00:45,390
like to build stuff usually tooling

17
00:00:45,390 --> 00:00:48,050
around sort of the work that I'm doing

18
00:00:48,050 --> 00:00:53,160
just as a kind of itch that it will

19
00:00:53,160 --> 00:00:56,160
scratch that itch from time to time so

20
00:00:56,160 --> 00:00:58,320
for the agenda so first we're gonna go

21
00:00:58,320 --> 00:00:59,820
over and a little bit of a quick

22
00:00:59,820 --> 00:01:03,690
introduction to who rock is and we're

23
00:01:03,690 --> 00:01:05,009
not gonna actually reveal his identity

24
00:01:05,009 --> 00:01:08,270
or their identity but as far as we know

25
00:01:08,270 --> 00:01:11,880
we kind of go through its much of

26
00:01:11,880 --> 00:01:14,130
information we have and then we're gonna

27
00:01:14,130 --> 00:01:18,420
sort of look at the activity and in a

28
00:01:18,420 --> 00:01:22,020
way of sort of structuring this decided

29
00:01:22,020 --> 00:01:23,490
sort of break it up into sort of like a

30
00:01:23,490 --> 00:01:27,659
three story lines sort of how they have

31
00:01:27,659 --> 00:01:31,820
evolved throughout sort of their career

32
00:01:31,820 --> 00:01:34,530
so to start with so who is wrong it's a

33
00:01:34,530 --> 00:01:38,670
Chinese based threat actor and they have

34
00:01:38,670 --> 00:01:42,240
been doing crypto mining for quite some

35
00:01:42,240 --> 00:01:45,540
time they are mainly targeting Linux

36
00:01:45,540 --> 00:01:48,780
servers this sort of started out by

37
00:01:48,780 --> 00:01:52,110
scanning the internet and then sort of

38
00:01:52,110 --> 00:01:54,329
getting coin miners onto them they've

39
00:01:54,329 --> 00:01:58,380
been active since 2017 coming actually

40
00:01:58,380 --> 00:02:01,920
at this point it's probably about two

41
00:02:01,920 --> 00:02:03,930
years this started around sometime in

42
00:02:03,930 --> 00:02:07,049
the October frame of 2017 the sort of

43
00:02:07,049 --> 00:02:10,318
the first sort of activity started to

44
00:02:10,318 --> 00:02:13,608
come out around this group

45
00:02:13,780 --> 00:02:17,260
this is actually a partial timeline of

46
00:02:17,260 --> 00:02:20,470
some of their activity it's a doesn't

47
00:02:20,470 --> 00:02:21,490
include sort of all of the

48
00:02:21,490 --> 00:02:23,020
infrastructure and sort of how they've

49
00:02:23,020 --> 00:02:24,820
moved through and what do you use sort

50
00:02:24,820 --> 00:02:29,500
of using the sort of main things I want

51
00:02:29,500 --> 00:02:31,150
to just give you guys some hints so this

52
00:02:31,150 --> 00:02:35,260
is a well it's sort of like these yellow

53
00:02:35,260 --> 00:02:38,080
dots those are somewhat of like majors

54
00:02:38,080 --> 00:02:40,390
report from some water reports and

55
00:02:40,390 --> 00:02:43,450
public reports around him this would

56
00:02:43,450 --> 00:02:47,320
have been released by different threat

57
00:02:47,320 --> 00:02:50,350
research teams so again I sort of break

58
00:02:50,350 --> 00:02:52,209
down and start with sort of this area of

59
00:02:52,209 --> 00:02:55,060
the report which is the initial sort of

60
00:02:55,060 --> 00:02:57,730
phase and this will sort of cover the

61
00:02:57,730 --> 00:02:59,200
initial discovery and then sort of

62
00:02:59,200 --> 00:03:00,640
naming of the group which was done by

63
00:03:00,640 --> 00:03:05,200
Cisco talis back in August of 2018 and

64
00:03:05,200 --> 00:03:09,780
sort of how their activity started so

65
00:03:09,780 --> 00:03:14,230
this activity was announced by were

66
00:03:14,230 --> 00:03:17,830
published by Cisco telecine in at the

67
00:03:17,830 --> 00:03:20,739
end of August 2018 and it spans all the

68
00:03:20,739 --> 00:03:26,290
way back to late 2017 and the group was

69
00:03:26,290 --> 00:03:30,750
a sort of exploiting a lot of their

70
00:03:30,750 --> 00:03:33,910
honey pots and they would scan the

71
00:03:33,910 --> 00:03:36,910
internet and drop crypto miners onon the

72
00:03:36,910 --> 00:03:38,920
targeting and infrastructure they would

73
00:03:38,920 --> 00:03:41,799
use in was Apache struts WebLogic cold

74
00:03:41,799 --> 00:03:44,500
fusion and Jenkins and what they would

75
00:03:44,500 --> 00:03:46,959
do was they actually got on get remote

76
00:03:46,959 --> 00:03:48,459
code execution and then he would install

77
00:03:48,459 --> 00:03:51,910
a chrome a cron job the cron job would

78
00:03:51,910 --> 00:03:55,299
then execute and download a fake JPEG so

79
00:03:55,299 --> 00:03:58,209
it was hosted somewhere else essentially

80
00:03:58,209 --> 00:04:01,900
was just a file that had the JPEG file

81
00:04:01,900 --> 00:04:03,940
extension but it turned out to be a

82
00:04:03,940 --> 00:04:07,360
crypto miner the places where the extra

83
00:04:07,360 --> 00:04:09,940
hosted these mining tools and scripts

84
00:04:09,940 --> 00:04:13,390
was first on get e which is a Chinese

85
00:04:13,390 --> 00:04:16,570
sort of a github competitor and then

86
00:04:16,570 --> 00:04:20,440
github itself and get lob and then later

87
00:04:20,440 --> 00:04:23,860
on towards the kief this sort of period

88
00:04:23,860 --> 00:04:26,680
they shifted off from github and he's

89
00:04:26,680 --> 00:04:27,550
gay

90
00:04:27,550 --> 00:04:31,169
hosting providers to actually Hadoop

91
00:04:31,169 --> 00:04:33,550
today actually spun up their own

92
00:04:33,550 --> 00:04:38,110
infrastructure to host this some of the

93
00:04:38,110 --> 00:04:41,020
sort of functionality of this initially

94
00:04:41,020 --> 00:04:43,800
this cron job would actually pull down

95
00:04:43,800 --> 00:04:46,599
bash scripts that would run certain

96
00:04:46,599 --> 00:04:49,990
commands it would uninstall AV products

97
00:04:49,990 --> 00:04:51,220
that might have been installed on the

98
00:04:51,220 --> 00:04:56,770
server and it used a open source tool

99
00:04:56,770 --> 00:05:00,039
called Lib process Haider it's a user

100
00:05:00,039 --> 00:05:03,729
land rootkit it uses the functionality

101
00:05:03,729 --> 00:05:06,880
of the LD preload which is a

102
00:05:06,880 --> 00:05:09,250
functionality in Linux that allows you

103
00:05:09,250 --> 00:05:12,300
to load a shared objects or a library

104
00:05:12,300 --> 00:05:16,000
every time a in application any

105
00:05:16,000 --> 00:05:17,740
application is actually executed and

106
00:05:17,740 --> 00:05:21,159
that's a way of overriding other

107
00:05:21,159 --> 00:05:23,080
functions as entries you can sort of

108
00:05:23,080 --> 00:05:26,199
patch things and Lib process Hyder does

109
00:05:26,199 --> 00:05:29,710
this to actually patch Lib C so when

110
00:05:29,710 --> 00:05:31,780
you're listing processes and things you

111
00:05:31,780 --> 00:05:33,330
can actually hook these functions and

112
00:05:33,330 --> 00:05:37,330
provide sort of code to hide whatever

113
00:05:37,330 --> 00:05:44,259
you want to hide they also utilize SSH

114
00:05:44,259 --> 00:05:46,389
for lateral movement and this was done

115
00:05:46,389 --> 00:05:49,779
through the script and this is the time

116
00:05:49,779 --> 00:05:51,159
a little snippet around it that's

117
00:05:51,159 --> 00:05:52,569
actually at the end it would actually

118
00:05:52,569 --> 00:05:55,449
look for the known hosts and the any

119
00:05:55,449 --> 00:05:57,039
authorized keys to be stored on the

120
00:05:57,039 --> 00:05:59,740
compromised server and then scan through

121
00:05:59,740 --> 00:06:02,169
and just try to essentially execute the

122
00:06:02,169 --> 00:06:07,090
same code in there at this time the

123
00:06:07,090 --> 00:06:08,500
group was mainly just using public

124
00:06:08,500 --> 00:06:10,750
mining pools so it would pull down the

125
00:06:10,750 --> 00:06:13,360
miner you rely in a configuration file

126
00:06:13,360 --> 00:06:15,960
and then connect out with a public

127
00:06:15,960 --> 00:06:18,490
mining pool and then the wallet so kind

128
00:06:18,490 --> 00:06:20,349
of easy to track their activity based on

129
00:06:20,349 --> 00:06:22,240
the wallets they were using and things

130
00:06:22,240 --> 00:06:26,409
like that so going over a little bit of

131
00:06:26,409 --> 00:06:27,819
the setup script so this is actually

132
00:06:27,819 --> 00:06:30,389
what was installed at I'm a cron job

133
00:06:30,389 --> 00:06:32,979
yeah sort of the initial sort of setup

134
00:06:32,979 --> 00:06:35,080
and here we can see how it's fetching a

135
00:06:35,080 --> 00:06:39,849
fake JPEG file the sort of the initial

136
00:06:39,849 --> 00:06:41,330
setup script

137
00:06:41,330 --> 00:06:44,240
we'll go through and actually kill a

138
00:06:44,240 --> 00:06:46,010
bunch of other processes mostly other

139
00:06:46,010 --> 00:06:52,010
mining BOTS any other services that

140
00:06:52,010 --> 00:06:54,170
might be trying to prevent any nefarious

141
00:06:54,170 --> 00:06:58,130
stuff to happen and then towards the end

142
00:06:58,130 --> 00:07:01,190
it actually sort of downloads I'm sorry

143
00:07:01,190 --> 00:07:04,550
that the image might be bad each of the

144
00:07:04,550 --> 00:07:07,130
screen of Italy but it would actually

145
00:07:07,130 --> 00:07:08,900
fetch all these services and these are

146
00:07:08,900 --> 00:07:16,840
actually hosted on github gitlab and

147
00:07:16,840 --> 00:07:19,220
what after it's full pull down all the

148
00:07:19,220 --> 00:07:21,230
accessories that it needs it runs sort

149
00:07:21,230 --> 00:07:24,230
of like an installation script and this

150
00:07:24,230 --> 00:07:27,170
one sort of executed pretty quickly it's

151
00:07:27,170 --> 00:07:28,430
kind of straightforward so you can see

152
00:07:28,430 --> 00:07:32,120
how it's going to create this file and

153
00:07:32,120 --> 00:07:34,100
sort of downloads and executes other

154
00:07:34,100 --> 00:07:37,670
stuff the sort of the update file that

155
00:07:37,670 --> 00:07:42,650
was kicked executed you see here set of

156
00:07:42,650 --> 00:07:45,070
tracks what is going on and we see a

157
00:07:45,070 --> 00:07:47,060
here's where sort of the mining is

158
00:07:47,060 --> 00:07:50,870
executed and it's using masquerading so

159
00:07:50,870 --> 00:07:53,420
it's actually Heidi which is what kind

160
00:07:53,420 --> 00:07:54,830
of the name the process is regarding

161
00:07:54,830 --> 00:07:56,210
that this case it actually is

162
00:07:56,210 --> 00:07:59,510
impersonating an SSH daemon running this

163
00:07:59,510 --> 00:08:01,850
is sort of a theme did you would see

164
00:08:01,850 --> 00:08:06,080
this sort of actors using so this kind

165
00:08:06,080 --> 00:08:08,870
of this district scripts was kind of

166
00:08:08,870 --> 00:08:12,740
interesting because back in July

167
00:08:12,740 --> 00:08:15,230
f5 labs will actually release a report

168
00:08:15,230 --> 00:08:16,940
where they actually looked at this code

169
00:08:16,940 --> 00:08:20,390
here and actually found out that someone

170
00:08:20,390 --> 00:08:22,010
earlier published something on Stack

171
00:08:22,010 --> 00:08:26,180
Overflow but he simply asked how I think

172
00:08:26,180 --> 00:08:27,890
sort of get a if the program is not

173
00:08:27,890 --> 00:08:29,900
running and I relaunch it by checking it

174
00:08:29,900 --> 00:08:31,940
has paid and if you actually look at

175
00:08:31,940 --> 00:08:35,270
these lines the actor corresponds well

176
00:08:35,270 --> 00:08:36,919
pretty much straight on to what is in

177
00:08:36,919 --> 00:08:40,429
this script so looking sort of at this

178
00:08:40,429 --> 00:08:43,370
activity of this group we can see that

179
00:08:43,370 --> 00:08:45,290
they were sort of starting posting at

180
00:08:45,290 --> 00:08:49,910
the end of October 2017 they definitely

181
00:08:49,910 --> 00:08:51,620
been interesting and writing sort of IRC

182
00:08:51,620 --> 00:08:54,590
BOTS in Python

183
00:08:54,590 --> 00:08:56,780
and we can see sort of all the this sort

184
00:08:56,780 --> 00:08:58,850
of question here and also you know a

185
00:08:58,850 --> 00:09:00,890
little bit suspicious of how do you

186
00:09:00,890 --> 00:09:03,140
perform a mask an input for my domain

187
00:09:03,140 --> 00:09:05,540
name so you can see how this user on

188
00:09:05,540 --> 00:09:07,100
Stack Overflow seems to be interesting

189
00:09:07,100 --> 00:09:09,230
in some something that so relate to what

190
00:09:09,230 --> 00:09:12,680
this activity of this group and in

191
00:09:12,680 --> 00:09:14,660
addition to that they also post his eye

192
00:09:14,660 --> 00:09:18,010
on the Stack Exchange which is a sister

193
00:09:18,010 --> 00:09:20,840
account or a sister service to stack

194
00:09:20,840 --> 00:09:23,120
overflow but he asked about questions

195
00:09:23,120 --> 00:09:25,910
with regards to Bitcoin so kind of falls

196
00:09:25,910 --> 00:09:29,860
in line with this group is interested in

197
00:09:30,910 --> 00:09:33,230
so that was sort of the initial face so

198
00:09:33,230 --> 00:09:38,780
let's go to the the first half of this

199
00:09:38,780 --> 00:09:42,590
year so and plus back to like October's

200
00:09:42,590 --> 00:09:44,060
are we looking at almost a six month

201
00:09:44,060 --> 00:09:46,250
period so there's activities of a span

202
00:09:46,250 --> 00:09:51,230
from October to June May sort of shift

203
00:09:51,230 --> 00:09:54,140
and we've seen a kind of a shift between

204
00:09:54,140 --> 00:09:57,950
and during this there's quite of a part

205
00:09:57,950 --> 00:10:00,200
of other report coming out the first one

206
00:10:00,200 --> 00:10:02,120
that was sort of tail off from Dallas

207
00:10:02,120 --> 00:10:05,390
was a report by Palo Alto Networks their

208
00:10:05,390 --> 00:10:07,880
unit 42 we'd been sort of tracking this

209
00:10:07,880 --> 00:10:12,020
group too we released a report on this

210
00:10:12,020 --> 00:10:15,380
group to around the March frame and then

211
00:10:15,380 --> 00:10:17,270
we see some other reports further down

212
00:10:17,270 --> 00:10:21,380
the line so Matt sort of the main sort

213
00:10:21,380 --> 00:10:24,170
of a shift in this group instead of

214
00:10:24,170 --> 00:10:27,920
hosting the actual files on github we

215
00:10:27,920 --> 00:10:30,380
kind of need gives a or open get

216
00:10:30,380 --> 00:10:32,710
directors cubes which gives it really

217
00:10:32,710 --> 00:10:36,050
juicy information to threat to actual

218
00:10:36,050 --> 00:10:37,760
security researchers because you can go

219
00:10:37,760 --> 00:10:39,470
back and look at the git history and see

220
00:10:39,470 --> 00:10:41,990
how they sort of changing their stuff if

221
00:10:41,990 --> 00:10:45,020
you come in late they shift it and

222
00:10:45,020 --> 00:10:46,670
actually moved over to started posting

223
00:10:46,670 --> 00:10:50,360
this on pasted they also started moving

224
00:10:50,360 --> 00:10:54,800
off from using main like us from Chinese

225
00:10:54,800 --> 00:10:58,280
based service provider for their

226
00:10:58,280 --> 00:11:01,430
infrastructure prior to this use mainly

227
00:11:01,430 --> 00:11:04,610
like Alibaba web $0.10 and now to

228
00:11:04,610 --> 00:11:05,740
started more using

229
00:11:05,740 --> 00:11:09,220
and digitalocean they've started to

230
00:11:09,220 --> 00:11:13,150
using CloudFlare for as a front for a

231
00:11:13,150 --> 00:11:15,100
lot of stuff so sort of moving more

232
00:11:15,100 --> 00:11:20,020
towards like the Western world he also

233
00:11:20,020 --> 00:11:21,850
started using as I said the CloudFlare

234
00:11:21,850 --> 00:11:23,860
disorder also using other CD ends to

235
00:11:23,860 --> 00:11:26,980
host some of their stuff basically a way

236
00:11:26,980 --> 00:11:29,910
of hiding where it actually was hosted

237
00:11:29,910 --> 00:11:33,610
and then instead of us instead of having

238
00:11:33,610 --> 00:11:37,360
like a script is dropped they shifted

239
00:11:37,360 --> 00:11:39,520
and actually started using a malware to

240
00:11:39,520 --> 00:11:41,830
control all this stuff so sort of a big

241
00:11:41,830 --> 00:11:43,960
evolution from how their activities Joe

242
00:11:43,960 --> 00:11:50,020
changed the setup script is kind of same

243
00:11:50,020 --> 00:11:51,720
it's very similar to what we've seen

244
00:11:51,720 --> 00:11:54,730
prior to this and it will still sort of

245
00:11:54,730 --> 00:11:56,920
kill a bunch of processes remove other

246
00:11:56,920 --> 00:11:59,380
in malware bots there might be there

247
00:11:59,380 --> 00:12:05,200
already it also had sort of this the

248
00:12:05,200 --> 00:12:06,340
same thing here we we see the Lib

249
00:12:06,340 --> 00:12:08,370
processor would where it would install

250
00:12:08,370 --> 00:12:12,460
download the process is haider and

251
00:12:12,460 --> 00:12:15,790
installed it into the LD preload to do

252
00:12:15,790 --> 00:12:21,900
the same the same hiding we also see

253
00:12:21,900 --> 00:12:24,190
sort of the one of the first uses of

254
00:12:24,190 --> 00:12:29,350
Python in this area and also we can see

255
00:12:29,350 --> 00:12:31,030
how it's sort of downloading and setting

256
00:12:31,030 --> 00:12:33,040
up or setting up the cron job footik

257
00:12:33,040 --> 00:12:36,990
persistence the Python code and

258
00:12:36,990 --> 00:12:39,760
basically four encoded but if you decode

259
00:12:39,760 --> 00:12:42,190
it it's pretty much the same as what the

260
00:12:42,190 --> 00:12:44,050
script is the shell script is doing

261
00:12:44,050 --> 00:12:47,410
using curl and W get and so it's just a

262
00:12:47,410 --> 00:12:50,860
sort of another way of doing it so sort

263
00:12:50,860 --> 00:12:52,120
of probably surf that a little bit of as

264
00:12:52,120 --> 00:12:54,940
backup in case curl W get is not

265
00:12:54,940 --> 00:12:56,920
installed it checks maybe it tries to

266
00:12:56,920 --> 00:13:01,450
use Python we also see the uninstall of

267
00:13:01,450 --> 00:13:04,150
Av tools or monitoring tools these one

268
00:13:04,150 --> 00:13:08,020
is more specific to Chinese hosting

269
00:13:08,020 --> 00:13:09,670
providers so they provide monitoring

270
00:13:09,670 --> 00:13:12,490
systems that install the arm D

271
00:13:12,490 --> 00:13:16,720
the service the instances and a lot of

272
00:13:16,720 --> 00:13:17,830
these instructions is basically just

273
00:13:17,830 --> 00:13:21,520
taken straight up from the fa Q's of how

274
00:13:21,520 --> 00:13:23,620
to install them on their website so if

275
00:13:23,620 --> 00:13:25,540
you go to like Alibaba web and now how

276
00:13:25,540 --> 00:13:27,430
do i uninstall this tool and it gives

277
00:13:27,430 --> 00:13:29,170
you this instructions pretty much that's

278
00:13:29,170 --> 00:13:32,710
being copied on here the mining as you

279
00:13:32,710 --> 00:13:36,550
see is pulling down again is masquerader

280
00:13:36,550 --> 00:13:43,860
as a JPEG and it also installs it as a

281
00:13:43,860 --> 00:13:47,670
the file name is they started using his

282
00:13:47,670 --> 00:13:50,290
kernel thread names we're usually the

283
00:13:50,290 --> 00:13:52,630
last character swapped around so in this

284
00:13:52,630 --> 00:13:55,630
scenario we have like at work is like a

285
00:13:55,630 --> 00:13:59,140
worker demon but instead of instead of

286
00:13:59,140 --> 00:14:01,090
having workers daemon as what the thread

287
00:14:01,090 --> 00:14:02,680
would be called they just swap the D and

288
00:14:02,680 --> 00:14:04,870
the S the sort of a system you actually

289
00:14:04,870 --> 00:14:07,360
see consistently through these how this

290
00:14:07,360 --> 00:14:11,160
group is sort of naming their files and

291
00:14:11,160 --> 00:14:13,240
so that's sort of the span from the

292
00:14:13,240 --> 00:14:16,810
kotoba up to about end of february at

293
00:14:16,810 --> 00:14:20,740
that point what the group started doing

294
00:14:20,740 --> 00:14:22,300
was actually to start using a pure

295
00:14:22,300 --> 00:14:25,780
malware to do this and this one again

296
00:14:25,780 --> 00:14:28,230
was actually downloaded as a fake jpg

297
00:14:28,230 --> 00:14:30,970
instead of it just being sort of the

298
00:14:30,970 --> 00:14:34,570
mining this is actually a a malware

299
00:14:34,570 --> 00:14:36,880
written in go it does include the actual

300
00:14:36,880 --> 00:14:39,340
miner inside it so this is technically a

301
00:14:39,340 --> 00:14:42,730
dropper but it also sets up some

302
00:14:42,730 --> 00:14:45,520
persistence does them under stuff in

303
00:14:45,520 --> 00:14:47,950
turn with regards to standing up for

304
00:14:47,950 --> 00:14:49,810
other vulnerable hosts and try to sort

305
00:14:49,810 --> 00:14:51,610
of spread through the network or on the

306
00:14:51,610 --> 00:14:58,090
internet the one of the domains where

307
00:14:58,090 --> 00:15:00,520
this one is host was hosted on is the so

308
00:15:00,520 --> 00:15:04,150
card domain it is a website that's

309
00:15:04,150 --> 00:15:07,060
controlled by the threat actor it's set

310
00:15:07,060 --> 00:15:11,530
up to look like a image uploads space or

311
00:15:11,530 --> 00:15:16,510
like a provider in China for Kermit

312
00:15:16,510 --> 00:15:20,560
exactly the translation it's a for some

313
00:15:20,560 --> 00:15:23,290
of the services and you have to sort of

314
00:15:23,290 --> 00:15:25,840
provide a photo ID of your

315
00:15:25,840 --> 00:15:28,870
a photocopy of your ID just sort of

316
00:15:28,870 --> 00:15:31,240
prove your identity so this service is

317
00:15:31,240 --> 00:15:33,400
sort of set up as a place to upload your

318
00:15:33,400 --> 00:15:36,610
ID so you can use it to sort of provide

319
00:15:36,610 --> 00:15:38,950
the link to to give sort of that to the

320
00:15:38,950 --> 00:15:42,550
service whatever you need and also this

321
00:15:42,550 --> 00:15:45,730
switched over to using a new paceman

322
00:15:45,730 --> 00:15:47,200
account so this one went through the

323
00:15:47,200 --> 00:15:51,580
name of system ten the c2 structure kind

324
00:15:51,580 --> 00:15:55,480
of uses three pastes the one of the

325
00:15:55,480 --> 00:16:00,400
paste is a setup script one need sort of

326
00:16:00,400 --> 00:16:02,860
downloads everything and then you have a

327
00:16:02,860 --> 00:16:05,950
taste that is holds an updated version

328
00:16:05,950 --> 00:16:09,520
if this version does not match what the

329
00:16:09,520 --> 00:16:12,480
malware expects it will really child to

330
00:16:12,480 --> 00:16:15,480
the firt would like the other the last

331
00:16:15,480 --> 00:16:18,760
paste which is a redirect and that

332
00:16:18,760 --> 00:16:21,220
allows sort of a threat act if you have

333
00:16:21,220 --> 00:16:23,740
sort of hide where the setup script is

334
00:16:23,740 --> 00:16:27,520
located and then also change it if they

335
00:16:27,520 --> 00:16:31,810
need to except for the forgot to turn

336
00:16:31,810 --> 00:16:33,730
off to make sure that all their pace

337
00:16:33,730 --> 00:16:35,800
were public so once you've found the

338
00:16:35,800 --> 00:16:38,050
name you can just go and look and sort

339
00:16:38,050 --> 00:16:43,330
of pull down this as the updated the

340
00:16:43,330 --> 00:16:46,780
malware that they had developed and they

341
00:16:46,780 --> 00:16:50,650
seem to have some sort of a humor kind

342
00:16:50,650 --> 00:16:53,680
of call the LSD mainly because that

343
00:16:53,680 --> 00:16:56,110
seems to be what they're calling it so

344
00:16:56,110 --> 00:16:58,930
this is a somewhat of a projection of

345
00:16:58,930 --> 00:17:01,720
the source code layout by the for the

346
00:17:01,720 --> 00:17:04,959
malware and they have the folder

347
00:17:04,959 --> 00:17:08,050
structure they cut sort of this follows

348
00:17:08,050 --> 00:17:10,869
within the convention back in the day

349
00:17:10,869 --> 00:17:13,440
how go language see sort of Lee

350
00:17:13,440 --> 00:17:16,480
recommend you to structure your code so

351
00:17:16,480 --> 00:17:18,760
they put it on their a source folder

352
00:17:18,760 --> 00:17:21,970
github calm and then slash hippies slash

353
00:17:21,970 --> 00:17:27,180
LSD hippies is a valid actually

354
00:17:27,180 --> 00:17:29,770
organizations they have some repose but

355
00:17:29,770 --> 00:17:34,200
not this repo and and it's linked to a

356
00:17:34,200 --> 00:17:37,570
Swedish company so pretty sure it's not

357
00:17:37,570 --> 00:17:39,880
that the actual real or

358
00:17:39,880 --> 00:17:42,880
the safety behind it one of the

359
00:17:42,880 --> 00:17:45,900
persistence that it's using is system D

360
00:17:45,900 --> 00:17:48,280
services it also will actually try to do

361
00:17:48,280 --> 00:17:50,530
in at D and here again you see the

362
00:17:50,530 --> 00:17:53,290
masquerading of a kernel thread where

363
00:17:53,290 --> 00:17:54,790
the last two characters have been

364
00:17:54,790 --> 00:18:00,990
swapped or sort of this summary of this

365
00:18:00,990 --> 00:18:04,060
campaign they swapped over from using

366
00:18:04,060 --> 00:18:06,220
extra public mining pools and actually

367
00:18:06,220 --> 00:18:09,010
spun out their own in a private pool or

368
00:18:09,010 --> 00:18:13,810
a proxy and that way the actual they

369
00:18:13,810 --> 00:18:15,340
don't have to provide the actual wallet

370
00:18:15,340 --> 00:18:17,200
address has been used so it makes it

371
00:18:17,200 --> 00:18:19,270
hard now to track how much money are

372
00:18:19,270 --> 00:18:22,140
they making and then other sort of

373
00:18:22,140 --> 00:18:24,520
related campaigns because you now you

374
00:18:24,520 --> 00:18:26,260
just see in an outbound connection going

375
00:18:26,260 --> 00:18:27,370
out to this and there's no

376
00:18:27,370 --> 00:18:32,650
configurations of given the miner was

377
00:18:32,650 --> 00:18:35,110
recompiled to include the configuration

378
00:18:35,110 --> 00:18:37,960
but inside it and certain mix sort of

379
00:18:37,960 --> 00:18:39,280
makes it a little bit harder to extract

380
00:18:39,280 --> 00:18:42,120
all this sort of mining information and

381
00:18:42,120 --> 00:18:44,500
this malware that was down was as was

382
00:18:44,500 --> 00:18:48,730
previously said was written in go the

383
00:18:48,730 --> 00:18:52,090
malware once he had sort of download and

384
00:18:52,090 --> 00:18:54,550
set up the the mining is actually

385
00:18:54,550 --> 00:18:57,580
started to scan for vulnerable Redis

386
00:18:57,580 --> 00:19:00,300
service and it would doctor try to

387
00:19:00,300 --> 00:19:03,520
connect to it if it was not protected

388
00:19:03,520 --> 00:19:06,190
with a password and then it would try a

389
00:19:06,190 --> 00:19:10,600
set of default sort of credentials and

390
00:19:10,600 --> 00:19:12,190
then if you managed to get on it would

391
00:19:12,190 --> 00:19:15,610
you see so the flush all method to write

392
00:19:15,610 --> 00:19:17,320
file to disk which you should involve a

393
00:19:17,320 --> 00:19:21,760
cron job and sort of spread itself and

394
00:19:21,760 --> 00:19:26,260
then also sort of the external persona

395
00:19:26,260 --> 00:19:28,170
this groups are using a sort of this

396
00:19:28,170 --> 00:19:32,110
identity of system 10 and from sort of

397
00:19:32,110 --> 00:19:35,100
this time in February with it started

398
00:19:35,100 --> 00:19:38,910
this sort of has stuck to it until

399
00:19:38,910 --> 00:19:41,200
currently within the last few days of

400
00:19:41,200 --> 00:19:45,340
still using it and then so this was kind

401
00:19:45,340 --> 00:19:47,080
of what they did where they were out in

402
00:19:47,080 --> 00:19:50,850
the spring of this year

403
00:19:50,980 --> 00:19:54,809
and it was not much more to it until

404
00:19:54,809 --> 00:19:58,299
around April there's a lot of sort of

405
00:19:58,299 --> 00:20:01,240
post coming up on the confluence website

406
00:20:01,240 --> 00:20:03,820
saying that you know my servers been

407
00:20:03,820 --> 00:20:06,520
hacked and things like that all sort of

408
00:20:06,520 --> 00:20:08,799
the cron jobs that they found matches

409
00:20:08,799 --> 00:20:12,730
pretty much what this group is doing so

410
00:20:12,730 --> 00:20:18,970
sort of started in another wave and so

411
00:20:18,970 --> 00:20:20,440
this was like this was actually the

412
00:20:20,440 --> 00:20:23,040
first post I mean she's a April 10 and

413
00:20:23,040 --> 00:20:25,660
the security vulnerability that they

414
00:20:25,660 --> 00:20:27,610
were exploiting was actually disclosed

415
00:20:27,610 --> 00:20:31,480
by confluence on a 20th of March so

416
00:20:31,480 --> 00:20:35,110
that's the button you know that's pretty

417
00:20:35,110 --> 00:20:38,169
quick from for a threat actor to sort of

418
00:20:38,169 --> 00:20:40,360
take a description of a vulnerability

419
00:20:40,360 --> 00:20:41,950
and develop exploit is starting actually

420
00:20:41,950 --> 00:20:47,380
exploiting it in wild the malware did

421
00:20:47,380 --> 00:20:49,480
not contain the exploit in it so this

422
00:20:49,480 --> 00:20:51,760
was done by a scanning essentially with

423
00:20:51,760 --> 00:20:53,350
infrastructure and then deploying the

424
00:20:53,350 --> 00:20:55,210
malware on it which is a sort of the

425
00:20:55,210 --> 00:20:56,860
initial behavior that we've seen the

426
00:20:56,860 --> 00:20:59,790
destroy factor they switched from

427
00:20:59,790 --> 00:21:02,020
instead of connecting directly to the IP

428
00:21:02,020 --> 00:21:04,360
address of the mining pool they started

429
00:21:04,360 --> 00:21:06,549
connecting to this domain research

430
00:21:06,549 --> 00:21:11,410
follows a pastebin account and the same

431
00:21:11,410 --> 00:21:13,900
place here it was also dropping this

432
00:21:13,900 --> 00:21:16,299
gold malware and the malware is also

433
00:21:16,299 --> 00:21:18,520
updated so instead of just scanning for

434
00:21:18,520 --> 00:21:21,070
read is it also started to scan for SSH

435
00:21:21,070 --> 00:21:24,450
and then it also started to scan for

436
00:21:24,450 --> 00:21:31,570
Jenkins servers so the Jenkins part it

437
00:21:31,570 --> 00:21:34,450
would scan the IP space and look for

438
00:21:34,450 --> 00:21:35,970
anything that was listening on port 8080

439
00:21:35,970 --> 00:21:41,530
and then if you've got a response is

440
00:21:41,530 --> 00:21:43,710
sent for different payloads

441
00:21:43,710 --> 00:21:45,580
this is sort of a summary of the

442
00:21:45,580 --> 00:21:50,799
payloads they tracked by at least some

443
00:21:50,799 --> 00:21:52,179
of these are there's a lot of chaining

444
00:21:52,179 --> 00:21:54,520
and in these it involves a bypass that

445
00:21:54,520 --> 00:21:57,580
was just closed in 2018 and then there

446
00:21:57,580 --> 00:22:00,250
is a remote code execution just the last

447
00:22:00,250 --> 00:22:03,100
bit here which is a you

448
00:22:03,100 --> 00:22:06,880
to bypass plus a different version using

449
00:22:06,880 --> 00:22:13,380
the grab annotation functionality in

450
00:22:13,380 --> 00:22:16,230
what's a programming language in

451
00:22:16,230 --> 00:22:20,169
description if I can't remember what the

452
00:22:20,169 --> 00:22:23,400
script language in Jenkins allows hmm

453
00:22:23,400 --> 00:22:27,640
now it's not Ruby script it's a groovy

454
00:22:27,640 --> 00:22:32,890
yes sorry yes it's an annotation for

455
00:22:32,890 --> 00:22:35,350
Groot for groovy that allows it to pull

456
00:22:35,350 --> 00:22:38,710
down a music-hall that are great and it

457
00:22:38,710 --> 00:22:40,270
can install it so it was a vulnerability

458
00:22:40,270 --> 00:22:41,500
in there so you can actually pull down

459
00:22:41,500 --> 00:22:47,370
any jar and it will just execute it so

460
00:22:47,370 --> 00:22:49,419
that's kind of the activity that was

461
00:22:49,419 --> 00:22:53,140
leading up to this summer and then sort

462
00:22:53,140 --> 00:22:57,340
of the the last phase this is kind of

463
00:22:57,340 --> 00:22:59,470
where I would like to call more of like

464
00:22:59,470 --> 00:23:01,000
getting more what-if focusing on

465
00:23:01,000 --> 00:23:02,580
actually getting more control over this

466
00:23:02,580 --> 00:23:05,799
towards the end of the spring you got

467
00:23:05,799 --> 00:23:07,360
harder and harder to track the grip

468
00:23:07,360 --> 00:23:09,850
because the usually the pastes that they

469
00:23:09,850 --> 00:23:12,940
were using we're taking down or removed

470
00:23:12,940 --> 00:23:15,880
pretty quickly so by the time you got to

471
00:23:15,880 --> 00:23:16,960
it it was already gone

472
00:23:16,960 --> 00:23:20,620
and we're not sure if it's due to them

473
00:23:20,620 --> 00:23:23,230
taking them down or if is people were

474
00:23:23,230 --> 00:23:24,490
reporting it then pasted beans were

475
00:23:24,490 --> 00:23:28,210
taking it down leaning a little bit

476
00:23:28,210 --> 00:23:30,970
towards the the second option given that

477
00:23:30,970 --> 00:23:33,070
they've moved off paste bin to be able

478
00:23:33,070 --> 00:23:36,250
to host it and as it is right now

479
00:23:36,250 --> 00:23:38,500
they they don't seem to take their stuff

480
00:23:38,500 --> 00:23:41,500
down pretty quickly so this sort of was

481
00:23:41,500 --> 00:23:43,210
probably preventing being you know being

482
00:23:43,210 --> 00:23:45,460
taken down to sort of inhibit their

483
00:23:45,460 --> 00:23:49,809
operations so this last phase this

484
00:23:49,809 --> 00:23:53,289
summer is all about the control so they

485
00:23:53,289 --> 00:23:55,150
started moving more to the self-hosted

486
00:23:55,150 --> 00:23:59,440
base so instead of hosting the script

487
00:23:59,440 --> 00:24:01,809
the setup script on paste bin it was

488
00:24:01,809 --> 00:24:04,960
moved and hosted under a subdomain of

489
00:24:04,960 --> 00:24:09,610
the system ten called LSD had the update

490
00:24:09,610 --> 00:24:12,760
script the whole divert held the version

491
00:24:12,760 --> 00:24:16,320
now was hosted on the update dot system

492
00:24:16,320 --> 00:24:19,650
ten org um but sort of the functionality

493
00:24:19,650 --> 00:24:22,260
was pretty much the same but the good

494
00:24:22,260 --> 00:24:23,730
thing is when when this kind of moves

495
00:24:23,730 --> 00:24:25,440
now kind of made it a little bit easier

496
00:24:25,440 --> 00:24:27,630
to sort of see a little bit more of

497
00:24:27,630 --> 00:24:29,670
activity because now you're tracking it

498
00:24:29,670 --> 00:24:31,530
based on the domain instead of like

499
00:24:31,530 --> 00:24:33,540
pastebin where there's so much traffic

500
00:24:33,540 --> 00:24:36,120
going in so it's hard to tell what is

501
00:24:36,120 --> 00:24:41,220
sort of nefarious so this is a data

502
00:24:41,220 --> 00:24:47,970
taken from Cisco umbrella and there's an

503
00:24:47,970 --> 00:24:49,740
interesting little spike that happen in

504
00:24:49,740 --> 00:24:57,570
the update system domain around the 29th

505
00:24:57,570 --> 00:25:01,620
of July where you actually seen above

506
00:25:01,620 --> 00:25:06,030
its above 21,000 resolutions per hour so

507
00:25:06,030 --> 00:25:07,890
it's a quite a high spike going on in

508
00:25:07,890 --> 00:25:09,540
that activity otherwise it stays pretty

509
00:25:09,540 --> 00:25:11,330
low with regards to a couple of hundred

510
00:25:11,330 --> 00:25:15,060
resolutions like was a request to DNS

511
00:25:15,060 --> 00:25:19,650
per hour they also did some changes to

512
00:25:19,650 --> 00:25:23,220
the malware and started to use a new way

513
00:25:23,220 --> 00:25:25,560
of doing like a mutex so it actually

514
00:25:25,560 --> 00:25:28,200
runs a web server that it's listening on

515
00:25:28,200 --> 00:25:33,570
a very high port and when it starts it

516
00:25:33,570 --> 00:25:37,440
tries to actually connect to this socket

517
00:25:37,440 --> 00:25:39,540
and if the socket is open or sorry if

518
00:25:39,540 --> 00:25:41,900
the socket has something listening in

519
00:25:41,900 --> 00:25:44,370
assumes that there's another version of

520
00:25:44,370 --> 00:25:47,550
itself running and it will exit so kind

521
00:25:47,550 --> 00:25:51,300
of using it as a mutex and in addition

522
00:25:51,300 --> 00:25:53,100
is still continuing with the SSH

523
00:25:53,100 --> 00:25:56,040
reticent Jenkins the algorithm exploit

524
00:25:56,040 --> 00:26:03,240
for activemq activemq is a very similar

525
00:26:03,240 --> 00:26:08,310
to and rabbitmq that's messaging a hub

526
00:26:08,310 --> 00:26:11,520
subsystem we can sort of submit messages

527
00:26:11,520 --> 00:26:13,890
and subscribe for the communication

528
00:26:13,890 --> 00:26:17,720
between services and this is a

529
00:26:17,720 --> 00:26:20,600
vulnerability in a file server

530
00:26:20,600 --> 00:26:24,990
functionality of this service so what it

531
00:26:24,990 --> 00:26:28,220
tries to do is upload a file

532
00:26:28,220 --> 00:26:31,940
and then it uses a move to actually move

533
00:26:31,940 --> 00:26:34,460
it into as a cron job and this was

534
00:26:34,460 --> 00:26:36,559
disclosed in 2016 so we're not looking

535
00:26:36,559 --> 00:26:40,340
at something very recent so kind of

536
00:26:40,340 --> 00:26:43,279
interested that it still added it this

537
00:26:43,279 --> 00:26:46,879
is the exploitation by this sorry if the

538
00:26:46,879 --> 00:26:50,509
image does not clear enough and it tries

539
00:26:50,509 --> 00:26:54,549
to so you have the cron jobs up here and

540
00:26:54,549 --> 00:26:57,110
then there's three different locations

541
00:26:57,110 --> 00:26:58,970
so these are three three different

542
00:26:58,970 --> 00:27:00,740
places where you can place a cron job so

543
00:27:00,740 --> 00:27:05,960
you have it under d @ c cron d and then

544
00:27:05,960 --> 00:27:08,330
/root and then it tries in this pool

545
00:27:08,330 --> 00:27:11,899
folder and then for the as a tab and

546
00:27:11,899 --> 00:27:15,049
then as the root m and it runs sort of

547
00:27:15,049 --> 00:27:17,480
like the same exploit three times to see

548
00:27:17,480 --> 00:27:20,029
basically trying to make sure it'll to

549
00:27:20,029 --> 00:27:21,049
make sure it actually works

550
00:27:21,049 --> 00:27:23,779
the exploitation is quite pretty

551
00:27:23,779 --> 00:27:29,389
straightforward he does a put request to

552
00:27:29,389 --> 00:27:33,139
that URL with that file and then after

553
00:27:33,139 --> 00:27:35,539
that you use it as a move to move that

554
00:27:35,539 --> 00:27:39,860
file from that location to this cron job

555
00:27:39,860 --> 00:27:42,740
location and that's sort of is it pretty

556
00:27:42,740 --> 00:27:45,399
much cut straight for that exploited

557
00:27:45,399 --> 00:27:49,279
they also changed the behavior to make

558
00:27:49,279 --> 00:27:52,009
sort of ensure that their stuff is

559
00:27:52,009 --> 00:27:55,730
mining given that you manage this sort

560
00:27:55,730 --> 00:27:58,429
of exploit these servers others also

561
00:27:58,429 --> 00:28:00,860
probably exploit the servers so one of

562
00:28:00,860 --> 00:28:02,090
the things you usually see with these

563
00:28:02,090 --> 00:28:04,340
active actors is to make sure it's just

564
00:28:04,340 --> 00:28:08,450
you the the way they've done is

565
00:28:08,450 --> 00:28:10,549
previously has been to sort of scan and

566
00:28:10,549 --> 00:28:15,379
for known file names and urls or IPS

567
00:28:15,379 --> 00:28:17,450
that they might be connecting to using

568
00:28:17,450 --> 00:28:19,820
sort of PS and then sort of killed the

569
00:28:19,820 --> 00:28:23,029
services this one's this version of the

570
00:28:23,029 --> 00:28:24,860
malware changed it so what it actually

571
00:28:24,860 --> 00:28:29,149
has is the actual md5 hash of its minor

572
00:28:29,149 --> 00:28:33,409
and because it is supportable 32-bit and

573
00:28:33,409 --> 00:28:35,990
64-bit it will have two hashes

574
00:28:35,990 --> 00:28:39,500
and it will scan all of the files that

575
00:28:39,500 --> 00:28:41,240
are running so we look for all the

576
00:28:41,240 --> 00:28:43,550
running processes take the hash of that

577
00:28:43,550 --> 00:28:47,540
process and then identify this is my

578
00:28:47,540 --> 00:28:50,150
minor and then it will go through all of

579
00:28:50,150 --> 00:28:52,940
the processes again calculate an average

580
00:28:52,940 --> 00:28:57,230
CPU usage and then if the usages is

581
00:28:57,230 --> 00:29:02,030
above 40% he will kill the process just

582
00:29:02,030 --> 00:29:04,220
to make sure so that its minor is the

583
00:29:04,220 --> 00:29:06,130
one that actually takes precedence and

584
00:29:06,130 --> 00:29:07,880
they are the one they're actually

585
00:29:07,880 --> 00:29:14,420
getting most of the quant so just this

586
00:29:14,420 --> 00:29:16,880
is sort of the summarizes group so this

587
00:29:16,880 --> 00:29:21,110
is a Chinese threat actor they've been

588
00:29:21,110 --> 00:29:23,620
active for for much two years now and

589
00:29:23,620 --> 00:29:25,820
they focusing mainly on sort of

590
00:29:25,820 --> 00:29:29,480
compromising Linux servers and we've

591
00:29:29,480 --> 00:29:31,040
seen sort of this shift of moving from

592
00:29:31,040 --> 00:29:33,320
like mainly focusing in Chinese based

593
00:29:33,320 --> 00:29:35,450
infrastructure at targeting Chinese

594
00:29:35,450 --> 00:29:37,160
servers and hosting providers to

595
00:29:37,160 --> 00:29:39,710
actually moving in more to the Western

596
00:29:39,710 --> 00:29:43,610
area and they also sort of evolved just

597
00:29:43,610 --> 00:29:45,080
using scripts to actually using a

598
00:29:45,080 --> 00:29:47,060
full-on malware to sort of control their

599
00:29:47,060 --> 00:29:51,620
system and then so sort of to control

600
00:29:51,620 --> 00:29:53,240
and sort of like how do I prevent this

601
00:29:53,240 --> 00:29:53,810
from happening

602
00:29:53,810 --> 00:29:56,330
well pretty much most of the cases

603
00:29:56,330 --> 00:29:58,430
they're using known vulnerabilities and

604
00:29:58,430 --> 00:30:01,430
they're using me credentials so if you

605
00:30:01,430 --> 00:30:05,000
sort of handling that you're it as

606
00:30:05,000 --> 00:30:06,800
immune as you can be against this threat

607
00:30:06,800 --> 00:30:10,400
actor well that's not really the end of

608
00:30:10,400 --> 00:30:12,710
the story so that was sort of the

609
00:30:12,710 --> 00:30:16,250
activity up to August's and as a

610
00:30:16,250 --> 00:30:19,790
mid-september where so prior to when

611
00:30:19,790 --> 00:30:24,200
this was actually submitted in the last

612
00:30:24,200 --> 00:30:25,250
few weeks

613
00:30:25,250 --> 00:30:27,340
they actually have changed their c2

614
00:30:27,340 --> 00:30:30,290
infrastructure since they're of hosting

615
00:30:30,290 --> 00:30:33,940
it on this LSD this system ten domain

616
00:30:33,940 --> 00:30:37,910
and they actually changed and started to

617
00:30:37,910 --> 00:30:42,410
host the actual scripting as um text

618
00:30:42,410 --> 00:30:47,120
records in the DNS name server so and

619
00:30:47,120 --> 00:30:49,760
they also moved over from a from this

620
00:30:49,760 --> 00:30:52,970
distant an org domain to a more random

621
00:30:52,970 --> 00:30:58,070
looking domain and the data is also

622
00:30:58,070 --> 00:31:01,190
encrypted so we'll reach out fetch down

623
00:31:01,190 --> 00:31:03,320
and get the text record and then the

624
00:31:03,320 --> 00:31:05,720
actual domain record is also used to

625
00:31:05,720 --> 00:31:08,960
generate the decryption key which is

626
00:31:08,960 --> 00:31:11,930
then the data blob the return is

627
00:31:11,930 --> 00:31:16,820
encrypted by 128-bit AES and that sort

628
00:31:16,820 --> 00:31:20,330
of does this if this resolution fails if

629
00:31:20,330 --> 00:31:23,240
it fails by doing the text record in the

630
00:31:23,240 --> 00:31:25,640
case of ute someone is blocking for

631
00:31:25,640 --> 00:31:26,720
example if you're blocking these

632
00:31:26,720 --> 00:31:28,580
resolution to go out to this specific

633
00:31:28,580 --> 00:31:31,910
domain it actually goes over the main

634
00:31:31,910 --> 00:31:34,910
that dns over https so actually will

635
00:31:34,910 --> 00:31:37,670
connect to CloudFlare and perform the

636
00:31:37,670 --> 00:31:41,030
same request out it's kind of an

637
00:31:41,030 --> 00:31:43,490
interesting scenario we see some new

638
00:31:43,490 --> 00:31:46,730
methods as kind of in a in the news

639
00:31:46,730 --> 00:31:51,020
because we've been a lot of discussion

640
00:31:51,020 --> 00:31:53,510
around if browser should a lot so basic

641
00:31:53,510 --> 00:31:55,460
should turn this on by default to use

642
00:31:55,460 --> 00:31:59,540
the main dns over HTTP so we're starting

643
00:31:59,540 --> 00:32:01,370
to see malware actually utilizing this

644
00:32:01,370 --> 00:32:04,480
technology as a way of bypassing

645
00:32:04,480 --> 00:32:08,090
potential blockage and also to protect

646
00:32:08,090 --> 00:32:12,970
sort of and hide their sort of intent

647
00:32:13,150 --> 00:32:16,040
and we can see when this started this

648
00:32:16,040 --> 00:32:18,320
actually is a new domain that it's using

649
00:32:18,320 --> 00:32:20,450
to fetch down and get the update we

650
00:32:20,450 --> 00:32:22,820
started to get some resolution in the

651
00:32:22,820 --> 00:32:26,660
mid September and the activity sort of

652
00:32:26,660 --> 00:32:28,730
stayed on and you can see some Oh spikes

653
00:32:28,730 --> 00:32:31,720
around just a few weeks back so this is

654
00:32:31,720 --> 00:32:38,300
mainly October now I had a look actually

655
00:32:38,300 --> 00:32:41,360
just yet last night to see their current

656
00:32:41,360 --> 00:32:48,910
activity and this in the last few days

657
00:32:48,910 --> 00:32:51,950
they swapped over to start using the

658
00:32:51,950 --> 00:32:54,740
actual main domain so they actually not

659
00:32:54,740 --> 00:32:58,550
the sub domain but I fell to resolve

660
00:32:58,550 --> 00:33:02,270
down to the pool and this happened just

661
00:33:02,270 --> 00:33:03,140
about

662
00:33:03,140 --> 00:33:05,930
week ago and at that time when I went

663
00:33:05,930 --> 00:33:10,010
happened this is from Cisco umbrella you

664
00:33:10,010 --> 00:33:12,890
started to see around 21,000 resolutions

665
00:33:12,890 --> 00:33:15,590
per hour going into this domain so they

666
00:33:15,590 --> 00:33:19,490
pretty active it's an interesting way I

667
00:33:19,490 --> 00:33:21,290
was like seeing how this there's some

668
00:33:21,290 --> 00:33:23,060
pretty lot of resolutions going onto

669
00:33:23,060 --> 00:33:27,320
this domains one of the latest sort of

670
00:33:27,320 --> 00:33:28,760
scripts that pull down and being

671
00:33:28,760 --> 00:33:31,670
installed this one is was seemed to be

672
00:33:31,670 --> 00:33:33,950
an update around the 21st to 22nd of

673
00:33:33,950 --> 00:33:38,270
October and they're hosting this malware

674
00:33:38,270 --> 00:33:42,100
in three places so there's a to Chinese

675
00:33:42,100 --> 00:33:45,320
hosting provider and then it's github so

676
00:33:45,320 --> 00:33:47,240
they seem to be they started to abuse

677
00:33:47,240 --> 00:33:50,690
the way a functionality and github where

678
00:33:50,690 --> 00:33:54,590
you can if you write a document you can

679
00:33:54,590 --> 00:33:57,500
drag in an image into sort of the add

680
00:33:57,500 --> 00:33:59,720
text editor and it will take that image

681
00:33:59,720 --> 00:34:04,430
and throw it on to s3 and I give lucky a

682
00:34:04,430 --> 00:34:08,030
link to it and they've sort of misusing

683
00:34:08,030 --> 00:34:09,739
this that github is not properly

684
00:34:09,739 --> 00:34:13,219
checking that it is a image file seem to

685
00:34:13,219 --> 00:34:14,630
be if you just put the right file

686
00:34:14,630 --> 00:34:16,250
extension it will accept it and I'll

687
00:34:16,250 --> 00:34:18,320
throw it on there so so another way of

688
00:34:18,320 --> 00:34:26,120
sort of hiding their stuff and so strip

689
00:34:26,120 --> 00:34:27,620
has been pretty active so if you guys

690
00:34:27,620 --> 00:34:30,800
have any sort of questions around

691
00:34:30,800 --> 00:34:33,879
[Music]

692
00:34:51,880 --> 00:34:54,449
[Music]

693
00:34:54,449 --> 00:35:00,089
ah do and I repeat with a microphone yes

694
00:35:00,089 --> 00:35:02,820
my question is run the go-biz malware on

695
00:35:02,820 --> 00:35:05,390
the endpoint protection mechanisms

696
00:35:05,390 --> 00:35:08,310
obviously I'm not concerned about AV

697
00:35:08,310 --> 00:35:10,410
bypasses that's quite easy enough but

698
00:35:10,410 --> 00:35:13,290
you know for more her hero behavioral

699
00:35:13,290 --> 00:35:15,030
analysis engines such as like

700
00:35:15,030 --> 00:35:17,310
CrowdStrike carbon black is there

701
00:35:17,310 --> 00:35:19,859
anything there that those tools are

702
00:35:19,859 --> 00:35:22,320
similar ric lacking the poly boob is

703
00:35:22,320 --> 00:35:23,520
malware to activate

704
00:35:23,520 --> 00:35:31,320
I actually don't about too much until

705
00:35:31,320 --> 00:35:35,550
the how the the malware serve act how

706
00:35:35,550 --> 00:35:39,210
they can sort of bypass the sort of the

707
00:35:39,210 --> 00:35:44,520
edid RS or EGR systems so I wouldn't be

708
00:35:44,520 --> 00:35:46,500
able to tell you like what out there

709
00:35:46,500 --> 00:35:48,660
sort of the heuristics they're using and

710
00:35:48,660 --> 00:35:50,820
sort of a success rate with regards to

711
00:35:50,820 --> 00:35:56,240
gold malware in general possibly done

712
00:36:00,109 --> 00:36:02,790
there yes there's a lot of convenience

713
00:36:02,790 --> 00:36:07,079
but has also been in general there seem

714
00:36:07,079 --> 00:36:14,250
to be a poor there's a there's a lot of

715
00:36:14,250 --> 00:36:15,750
gold malware that you should have a very

716
00:36:15,750 --> 00:36:18,420
very low detection rate if you looking

717
00:36:18,420 --> 00:36:20,000
at on that from was like a static

718
00:36:20,000 --> 00:36:24,270
analysis mainly can be that the binaries

719
00:36:24,270 --> 00:36:30,480
are big so you know this one if I

720
00:36:30,480 --> 00:36:31,619
remember correctly it's probably about

721
00:36:31,619 --> 00:36:34,950
six six to maybe six four six megabyte

722
00:36:34,950 --> 00:36:40,099
spot the size of this malware I've seen

723
00:36:40,099 --> 00:36:43,910
malware's there's been unpacked twelve

724
00:36:43,910 --> 00:36:47,609
megabytes and in those scenarios is not

725
00:36:47,609 --> 00:36:51,359
gonna usually scan it and the size wise

726
00:36:51,359 --> 00:36:53,640
there's a little bit of that going

727
00:36:53,640 --> 00:36:56,430
around and I know they've been some

728
00:36:56,430 --> 00:37:00,240
other much some some lower end a V the

729
00:37:00,240 --> 00:37:02,310
basically just started flying all go

730
00:37:02,310 --> 00:37:04,720
pioneering is malware because

731
00:37:04,720 --> 00:37:10,280
yeah yeah you also have that portability

732
00:37:10,280 --> 00:37:12,950
to talk about it's quite um an easy way

733
00:37:12,950 --> 00:37:14,630
Singh and I think if you're looking at

734
00:37:14,630 --> 00:37:17,210
this one it is compiled on Linux ooh

735
00:37:17,210 --> 00:37:18,890
they don't use any cross compilations or

736
00:37:18,890 --> 00:37:21,860
anything like that but from a hunting

737
00:37:21,860 --> 00:37:23,750
perspective if you're looking at most of

738
00:37:23,750 --> 00:37:25,310
the stuff you're seeing like uploaded to

739
00:37:25,310 --> 00:37:27,790
VT that's malicious and written and go

740
00:37:27,790 --> 00:37:32,750
it's with your red teaming stuff so very

741
00:37:32,750 --> 00:37:35,680
like highly adopted by red teamers so

742
00:37:35,680 --> 00:37:40,910
any other questions any more questions

743
00:37:40,910 --> 00:37:46,490
two more people yeah wait a sec you're

744
00:37:46,490 --> 00:37:49,880
coming on TV thanks any Intel on the

745
00:37:49,880 --> 00:37:52,010
actual currency used the wallets the

746
00:37:52,010 --> 00:37:54,080
amount of currency harvested like high

747
00:37:54,080 --> 00:37:59,570
financially profitable it's been ever

748
00:37:59,570 --> 00:38:01,940
since we tracked them they they started

749
00:38:01,940 --> 00:38:05,420
to use so their proxy so we have no

750
00:38:05,420 --> 00:38:07,100
knowledge of the wallet that it goes

751
00:38:07,100 --> 00:38:12,140
into if you have a contact if

752
00:38:12,140 --> 00:38:15,560
digitalocean maybe we can get because

753
00:38:15,560 --> 00:38:19,520
that's where they host it I think I've

754
00:38:19,520 --> 00:38:21,190
reported a couple of times but it's

755
00:38:21,190 --> 00:38:24,710
still sitting up there so yeah at this

756
00:38:24,710 --> 00:38:26,270
point you just see the connect it just

757
00:38:26,270 --> 00:38:29,030
has the configuration just gives the

758
00:38:29,030 --> 00:38:32,270
domain and the port that's it so that's

759
00:38:32,270 --> 00:38:35,840
all that's where the wording sort of the

760
00:38:35,840 --> 00:38:49,520
trail stops yeah just the spikes in

761
00:38:49,520 --> 00:38:50,990
traffic you were noting does that

762
00:38:50,990 --> 00:38:54,350
correspond to them then getting a new

763
00:38:54,350 --> 00:38:56,540
major infection thing and then it just

764
00:38:56,540 --> 00:39:01,040
gets cleaned off the sweat drops don't

765
00:39:01,040 --> 00:39:04,210
really know it's a it's a good question

766
00:39:04,210 --> 00:39:09,830
the that one if you're talking about the

767
00:39:09,830 --> 00:39:15,170
big spike in in June this quantum Oni is

768
00:39:15,170 --> 00:39:16,610
an interesting one it could be the day

769
00:39:16,610 --> 00:39:18,380
you actually ran a specific cam

770
00:39:18,380 --> 00:39:25,670
at that time the I think the one with

771
00:39:25,670 --> 00:39:27,110
the mining is kind of interesting

772
00:39:27,110 --> 00:39:29,690
because you kind of see it pretty steady

773
00:39:29,690 --> 00:39:31,869
sort of a great on it

774
00:39:31,869 --> 00:39:34,970
so those fluxes the the big spikes there

775
00:39:34,970 --> 00:39:37,880
it's hard to tell what they are and and

776
00:39:37,880 --> 00:39:40,430
then also they're set up to obviously

777
00:39:40,430 --> 00:39:44,950
execute this on the periodic thing so

778
00:39:44,950 --> 00:39:48,050
maybe it's spread it out I don't know

779
00:39:48,050 --> 00:39:50,270
kind of an interesting sonar yeah I

780
00:39:50,270 --> 00:39:51,950
don't have the telemetry to look at that

781
00:39:51,950 --> 00:39:54,710
why you know what happened that specific

782
00:39:54,710 --> 00:39:56,750
date that actually sort of caused the

783
00:39:56,750 --> 00:40:02,180
massive spike it's it's also the

784
00:40:02,180 --> 00:40:03,410
scenario it could have been someone that

785
00:40:03,410 --> 00:40:06,610
is excessively just a really you know

786
00:40:06,610 --> 00:40:08,750
rerunning some sort of thing in the

787
00:40:08,750 --> 00:40:11,000
sandbox and it just doing a lot of

788
00:40:11,000 --> 00:40:15,910
resolution so knows because i've

789
00:40:15,910 --> 00:40:17,720
received have been coming from was like

790
00:40:17,720 --> 00:40:20,270
one small area so one country or

791
00:40:20,270 --> 00:40:25,790
something like that so all right any

792
00:40:25,790 --> 00:40:34,040
more questions one index do you ever go

793
00:40:34,040 --> 00:40:35,780
figure out from running in the sandbox

794
00:40:35,780 --> 00:40:38,240
which cryptocurrencies it was trying to

795
00:40:38,240 --> 00:40:42,300
mine against as its mining manera most

796
00:40:42,300 --> 00:40:44,230
[Music]

797
00:40:44,230 --> 00:40:47,080
pretty that's pretty much exclusively

798
00:40:47,080 --> 00:40:51,859
for most mining bots is to mine Manero

799
00:40:51,859 --> 00:40:54,580
given that it's the only thing that is

800
00:40:54,580 --> 00:40:57,910
nowadays sort of feasible on CPU and GPU

801
00:40:57,910 --> 00:41:02,300
so to seem to be doing it given sort of

802
00:41:02,300 --> 00:41:04,790
they post on the Stack Overflow seems to

803
00:41:04,790 --> 00:41:09,100
be clear or exchange was Stack Exchange

804
00:41:09,100 --> 00:41:11,840
one this focus on cryptocurrency

805
00:41:11,840 --> 00:41:13,640
anything like that obviously seem to be

806
00:41:13,640 --> 00:41:16,040
that they translating you knowbut they

807
00:41:16,040 --> 00:41:18,170
taking them an air on exchanging it for

808
00:41:18,170 --> 00:41:20,630
Bitcoin obviously cash out at some point

809
00:41:20,630 --> 00:41:24,200
as they are interested in Bitcoin but

810
00:41:24,200 --> 00:41:26,600
that's not really feasible on on the

811
00:41:26,600 --> 00:41:28,480
hardware to mine

812
00:41:28,480 --> 00:41:32,819
so all right one more

813
00:41:32,819 --> 00:41:37,850
no okay thank you yogi

814
00:41:37,850 --> 00:41:40,980
[Applause]

