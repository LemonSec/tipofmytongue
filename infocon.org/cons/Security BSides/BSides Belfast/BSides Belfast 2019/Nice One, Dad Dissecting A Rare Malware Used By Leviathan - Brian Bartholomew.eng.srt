1
00:00:02,800 --> 00:00:06,050
so over to you and your Orleans Oaks

2
00:00:06,050 --> 00:00:08,148
have fun alright cool

3
00:00:08,148 --> 00:00:11,540
yep so thanks everybody for coming just

4
00:00:11,540 --> 00:00:13,190
let you know this talks about 30 minutes

5
00:00:13,190 --> 00:00:15,769
so we'll have 15 minutes of fun talkie

6
00:00:15,769 --> 00:00:18,440
time afterwards but and also I've been

7
00:00:18,440 --> 00:00:20,240
tweeting dad jokes all day with the

8
00:00:20,240 --> 00:00:22,520
hashtag besides in case anybody wants

9
00:00:22,520 --> 00:00:25,940
some of my other ones out there so yeah

10
00:00:25,940 --> 00:00:28,370
today we're going to talk about a piece

11
00:00:28,370 --> 00:00:30,530
of malware that was called dad joke is

12
00:00:30,530 --> 00:00:32,450
actually used by the actor Leviathan or

13
00:00:32,450 --> 00:00:35,839
some people refer to as APD 40 so before

14
00:00:35,839 --> 00:00:37,969
we get into it I just want to say a few

15
00:00:37,969 --> 00:00:41,420
things first off credit where credit's

16
00:00:41,420 --> 00:00:43,370
do thanks to fire I we have names like

17
00:00:43,370 --> 00:00:47,050
dad Bob and dad joke and dad Schwartz

18
00:00:47,050 --> 00:00:50,420
this is fun but special credit to Nick

19
00:00:50,420 --> 00:00:52,819
Carr and Rick Cole without their tweets

20
00:00:52,819 --> 00:00:53,809
that I'll show you later on

21
00:00:53,809 --> 00:00:55,190
I basically wouldn't have been able to

22
00:00:55,190 --> 00:00:56,390
find any of this stuff in the first

23
00:00:56,390 --> 00:00:58,489
place so kudos to them just want to make

24
00:00:58,489 --> 00:01:01,100
sure I say that first hopefully we'll be

25
00:01:01,100 --> 00:01:03,620
releasing a blog shortly it's already

26
00:01:03,620 --> 00:01:04,879
written we're just going through to make

27
00:01:04,879 --> 00:01:06,350
sure we don't say anything we shouldn't

28
00:01:06,350 --> 00:01:09,530
say in there and I'd like to try to

29
00:01:09,530 --> 00:01:11,030
coordinate that with fireEye's so we'll

30
00:01:11,030 --> 00:01:12,409
see if that actually happens but

31
00:01:12,409 --> 00:01:14,049
hopefully in the next couple weeks

32
00:01:14,049 --> 00:01:16,070
obviously there's dad jokes contained

33
00:01:16,070 --> 00:01:18,079
herein so please feel free to laugh or

34
00:01:18,079 --> 00:01:20,810
boo but please don't throw any tomatoes

35
00:01:20,810 --> 00:01:25,490
at me they are dad jokes so the first

36
00:01:25,490 --> 00:01:28,009
one this is good I'll give you a second

37
00:01:28,009 --> 00:01:30,350
to read it I can't like that one he was

38
00:01:30,350 --> 00:01:32,090
on duty uh-huh

39
00:01:32,090 --> 00:01:33,740
so we'll get into the initial discovery

40
00:01:33,740 --> 00:01:37,039
the malware obviously most of the stuff

41
00:01:37,039 --> 00:01:38,810
that we talk about nowadays they usually

42
00:01:38,810 --> 00:01:41,990
starts with a fish so back in August of

43
00:01:41,990 --> 00:01:44,420
this past year we saw a wave of attacks

44
00:01:44,420 --> 00:01:47,030
that was targeting a specific ministry

45
00:01:47,030 --> 00:01:50,179
in Southeast Asia in particular Ministry

46
00:01:50,179 --> 00:01:53,060
of Defense and while it was a wave of

47
00:01:53,060 --> 00:01:56,060
spear fishes it really wasn't super

48
00:01:56,060 --> 00:01:58,520
widespread we actually only found about

49
00:01:58,520 --> 00:02:00,770
three documents that targeted a couple

50
00:02:00,770 --> 00:02:03,020
different users two of the users were

51
00:02:03,020 --> 00:02:05,600
actually overseas not in Southeast Asia

52
00:02:05,600 --> 00:02:07,670
one was actually in Southeast Asia but

53
00:02:07,670 --> 00:02:09,560
they all worked for the ministry so it

54
00:02:09,560 --> 00:02:10,788
wasn't really widespread it was an

55
00:02:10,788 --> 00:02:12,440
interesting phishing campaign usually

56
00:02:12,440 --> 00:02:13,440
you'll see them blast

57
00:02:13,440 --> 00:02:15,750
an entire agency with hundreds emails

58
00:02:15,750 --> 00:02:17,880
but in this case this kind of piques my

59
00:02:17,880 --> 00:02:20,970
interest so when I started looking at it

60
00:02:20,970 --> 00:02:22,620
the delivery method itself was actually

61
00:02:22,620 --> 00:02:24,840
kind of unique too and it had an

62
00:02:24,840 --> 00:02:27,990
interesting very intricate ornate

63
00:02:27,990 --> 00:02:29,820
delivery chain that we'll talk about but

64
00:02:29,820 --> 00:02:32,010
basically it was a word document that

65
00:02:32,010 --> 00:02:33,930
got sent to the users it had a couple

66
00:02:33,930 --> 00:02:36,630
embedded executables specifically in exe

67
00:02:36,630 --> 00:02:39,450
and DLL inside of it it contained or

68
00:02:39,450 --> 00:02:41,010
actually reached out and grabbed the

69
00:02:41,010 --> 00:02:43,620
remote template pulled down the macro

70
00:02:43,620 --> 00:02:45,630
inside of the template executed it and

71
00:02:45,630 --> 00:02:47,940
did load order hijacking or what some

72
00:02:47,940 --> 00:02:50,520
folks call side loading so I said okay

73
00:02:50,520 --> 00:02:52,170
this is interesting I'll go try to find

74
00:02:52,170 --> 00:02:55,800
some more so I looked at the location of

75
00:02:55,800 --> 00:02:58,080
where the remote template was and I

76
00:02:58,080 --> 00:02:59,790
quickly discovered that I wasn't really

77
00:02:59,790 --> 00:03:00,990
going to go anywhere with this one

78
00:03:00,990 --> 00:03:04,050
because the actor used a short-lived

79
00:03:04,050 --> 00:03:06,510
campaign so this was pretty interesting

80
00:03:06,510 --> 00:03:07,980
and unique to me as well the fact that

81
00:03:07,980 --> 00:03:10,200
the actor flipped the switch this is

82
00:03:10,200 --> 00:03:12,990
based on our passive DNS system but you

83
00:03:12,990 --> 00:03:14,820
can see they started the campaign on

84
00:03:14,820 --> 00:03:16,980
August 29th they turned it off on the

85
00:03:16,980 --> 00:03:18,510
12th so basically it was a two-week

86
00:03:18,510 --> 00:03:20,489
campaign they scored the targets they

87
00:03:20,489 --> 00:03:21,780
wanted to and then they flipped it off

88
00:03:21,780 --> 00:03:25,080
to loopback which is makes it difficult

89
00:03:25,080 --> 00:03:27,450
for a researcher because a lot of times

90
00:03:27,450 --> 00:03:28,739
if you're not out there collecting the

91
00:03:28,739 --> 00:03:30,330
stuff as it happens you can't go back

92
00:03:30,330 --> 00:03:32,130
and get it later so that was kind of

93
00:03:32,130 --> 00:03:34,110
interesting to me so I hit a dead end on

94
00:03:34,110 --> 00:03:36,900
that but I did look at the macro that

95
00:03:36,900 --> 00:03:39,480
was inside and I was able to pivot on a

96
00:03:39,480 --> 00:03:41,940
couple of things so we'll get back to

97
00:03:41,940 --> 00:03:43,170
this screenshot in a little bit later

98
00:03:43,170 --> 00:03:44,940
but at the top and the bottom I

99
00:03:44,940 --> 00:03:47,970
highlighted some interesting values the

100
00:03:47,970 --> 00:03:49,200
two at the top and the one at the bottom

101
00:03:49,200 --> 00:03:52,380
there used these hex values were used by

102
00:03:52,380 --> 00:03:55,440
the actor in the macro but surprisingly

103
00:03:55,440 --> 00:03:58,380
they didn't change them that often so it

104
00:03:58,380 --> 00:03:59,940
was a unique value that I could put into

105
00:03:59,940 --> 00:04:01,800
a simple Yara cig and actually pivot off

106
00:04:01,800 --> 00:04:03,540
of and find some more stuff we'll get

107
00:04:03,540 --> 00:04:05,040
back to what they were in in a little

108
00:04:05,040 --> 00:04:07,019
bit but I was able to pivot on that and

109
00:04:07,019 --> 00:04:08,430
I found a few more documents that were

110
00:04:08,430 --> 00:04:11,670
sent in around middle of July this is

111
00:04:11,670 --> 00:04:13,350
where the tweets come in but basically

112
00:04:13,350 --> 00:04:16,700
one of them was discussed on Twitter so

113
00:04:16,700 --> 00:04:18,750
take your time read the tweet but

114
00:04:18,750 --> 00:04:24,210
basically Rick Cole on the Left talks

115
00:04:24,210 --> 00:04:25,360
about

116
00:04:25,360 --> 00:04:27,250
a spirit that they found and he said oh

117
00:04:27,250 --> 00:04:29,680
you got a dad joke instead talks about

118
00:04:29,680 --> 00:04:31,419
the exploit a gnat actually I just kind

119
00:04:31,419 --> 00:04:33,069
of discussed with you and then on the

120
00:04:33,069 --> 00:04:36,610
right Nick actually refers to dad joke

121
00:04:36,610 --> 00:04:40,180
as well and says probable apt forty so

122
00:04:40,180 --> 00:04:42,580
this was obviously you could imagine my

123
00:04:42,580 --> 00:04:43,599
excitement because I'm such a

124
00:04:43,599 --> 00:04:46,599
connoisseur of dad jokes plus apt forty

125
00:04:46,599 --> 00:04:48,699
is a pretty interesting actor so thanks

126
00:04:48,699 --> 00:04:51,690
to them again for dropping those tidbits

127
00:04:51,690 --> 00:04:55,000
so now we have a name we have a group a

128
00:04:55,000 --> 00:04:56,500
PT forty or what we refer to as

129
00:04:56,500 --> 00:04:58,960
Leviathan unfortunately when I started

130
00:04:58,960 --> 00:05:00,310
going out there and looking for dad

131
00:05:00,310 --> 00:05:02,139
jokes there wasn't really anything out

132
00:05:02,139 --> 00:05:03,490
there except for this shirt that my wife

133
00:05:03,490 --> 00:05:05,949
bought me because she knows I love them

134
00:05:05,949 --> 00:05:06,550
so much

135
00:05:06,550 --> 00:05:09,449
so I kind of hit a dead end again

136
00:05:09,449 --> 00:05:12,729
luckily at Kaspersky we save all the

137
00:05:12,729 --> 00:05:15,759
data all the time so looking back I was

138
00:05:15,759 --> 00:05:17,500
able to go back into a retro haunt and

139
00:05:17,500 --> 00:05:20,710
what was surprising is that I only found

140
00:05:20,710 --> 00:05:22,659
a total of eight campaigns since the

141
00:05:22,659 --> 00:05:26,110
beginning of 2019 so the malware itself

142
00:05:26,110 --> 00:05:28,659
was kind of rare usually when you find

143
00:05:28,659 --> 00:05:29,949
something you go back and you'll see

144
00:05:29,949 --> 00:05:32,500
consistent campaigns over and over again

145
00:05:32,500 --> 00:05:35,219
usually in the dozens or hundreds of

146
00:05:35,219 --> 00:05:38,080
victims for example with our data that

147
00:05:38,080 --> 00:05:40,120
we have in this case we only saw eight

148
00:05:40,120 --> 00:05:43,029
campaigns the other interesting fact was

149
00:05:43,029 --> 00:05:45,370
that this was actually looks like it

150
00:05:45,370 --> 00:05:48,490
began in January of 2019 so this is the

151
00:05:48,490 --> 00:05:50,050
possible epoch time for the malware

152
00:05:50,050 --> 00:05:52,750
which is kind of interesting this is a

153
00:05:52,750 --> 00:05:54,400
list of the campaigns I was able to find

154
00:05:54,400 --> 00:05:55,870
feel free to take pictures I'll leave it

155
00:05:55,870 --> 00:05:57,460
up there for a second if anybody wants I

156
00:05:57,460 --> 00:06:00,129
OC s but essentially you can see that

157
00:06:00,129 --> 00:06:02,050
the actor started using this malware

158
00:06:02,050 --> 00:06:04,900
essentially at the first of the year or

159
00:06:04,900 --> 00:06:07,659
the third and then they took about two

160
00:06:07,659 --> 00:06:09,729
months off and then they came back did

161
00:06:09,729 --> 00:06:11,229
it again took another two months off

162
00:06:11,229 --> 00:06:14,469
used it again so consistently every

163
00:06:14,469 --> 00:06:15,940
month or two they'll send one or two

164
00:06:15,940 --> 00:06:18,129
campaigns but eight campaigns over a

165
00:06:18,129 --> 00:06:19,900
span of now ten months is actually

166
00:06:19,900 --> 00:06:22,419
pretty rare to me what was even more

167
00:06:22,419 --> 00:06:24,520
interesting is that we could see the

168
00:06:24,520 --> 00:06:26,199
development cycles happening in between

169
00:06:26,199 --> 00:06:28,110
each campaigns so they would use it

170
00:06:28,110 --> 00:06:30,340
presumably come back to the drawing

171
00:06:30,340 --> 00:06:32,199
table report on bugs and things that

172
00:06:32,199 --> 00:06:34,210
happen fix some things add some new

173
00:06:34,210 --> 00:06:37,360
features functionalities whatever and go

174
00:06:37,360 --> 00:06:38,710
back to the drawing board and use it

175
00:06:38,710 --> 00:06:39,310
again

176
00:06:39,310 --> 00:06:40,900
so this indicated to me that the actor

177
00:06:40,900 --> 00:06:43,210
is being pretty meticulous they have a

178
00:06:43,210 --> 00:06:45,040
developer they're fixing some stuff that

179
00:06:45,040 --> 00:06:46,420
they found which is pretty interesting

180
00:06:46,420 --> 00:06:49,180
to me so before we get into the malware

181
00:06:49,180 --> 00:06:50,500
though we need to actually talk about

182
00:06:50,500 --> 00:06:55,770
the actor dad drug number two bison so I

183
00:06:55,770 --> 00:06:58,000
got a laugh at the front at least that

184
00:06:58,000 --> 00:06:59,490
was good

185
00:06:59,490 --> 00:07:01,360
there's plenty more where that came from

186
00:07:01,360 --> 00:07:04,360
so just to get everybody in the room on

187
00:07:04,360 --> 00:07:07,270
the same page with apt 40 we'll just

188
00:07:07,270 --> 00:07:08,500
talk a little bit about them before we

189
00:07:08,500 --> 00:07:10,419
go any further so they're also known as

190
00:07:10,419 --> 00:07:12,070
Leviathan like I said earlier that was

191
00:07:12,070 --> 00:07:14,260
the name I think that was made by

192
00:07:14,260 --> 00:07:14,950
Proofpoint

193
00:07:14,950 --> 00:07:16,660
when they first wrote about them about a

194
00:07:16,660 --> 00:07:18,850
year to maybe two years ago Microsoft

195
00:07:18,850 --> 00:07:21,480
has publicly called them gadolinium

196
00:07:21,480 --> 00:07:23,770
Accenture I believe it was put a paper

197
00:07:23,770 --> 00:07:26,710
out in maybe February of this year they

198
00:07:26,710 --> 00:07:29,200
called the actor mud carp and then on

199
00:07:29,200 --> 00:07:31,150
the right hand side you see temp dot

200
00:07:31,150 --> 00:07:33,430
periscope and temp dot jumper that's the

201
00:07:33,430 --> 00:07:36,940
old I site names that we used or they

202
00:07:36,940 --> 00:07:39,460
used I should say before they actually

203
00:07:39,460 --> 00:07:41,470
wrap this actor into an official apt

204
00:07:41,470 --> 00:07:43,630
number which was 40 so if anybody wants

205
00:07:43,630 --> 00:07:45,820
to cross-reference those are names that

206
00:07:45,820 --> 00:07:48,370
were used fireEye's says they've been

207
00:07:48,370 --> 00:07:51,760
active since 2013 personally myself I

208
00:07:51,760 --> 00:07:54,640
would say I only see it about 2015 but

209
00:07:54,640 --> 00:07:57,100
really the general community hasn't

210
00:07:57,100 --> 00:07:58,390
really known about this actor since

211
00:07:58,390 --> 00:08:01,690
about late 2018 early 2019 when they

212
00:08:01,690 --> 00:08:03,130
started getting some press coverage on

213
00:08:03,130 --> 00:08:05,310
some of the campaigns that were running

214
00:08:05,310 --> 00:08:07,150
referring to some of the campaigns

215
00:08:07,150 --> 00:08:09,789
they've done or headlines this first one

216
00:08:09,789 --> 00:08:14,260
for instance China basically they say

217
00:08:14,260 --> 00:08:16,090
hackers targeting universities this was

218
00:08:16,090 --> 00:08:19,539
in relation to some naval technologies

219
00:08:19,539 --> 00:08:21,250
being developed that those universities

220
00:08:21,250 --> 00:08:23,770
listed up above so they targeted them

221
00:08:23,770 --> 00:08:25,960
this is an example of one of the c2s

222
00:08:25,960 --> 00:08:28,180
that was tweeted a while back but you

223
00:08:28,180 --> 00:08:30,789
can see the Thiessen group marine system

224
00:08:30,789 --> 00:08:32,500
so you have a trend here on naval

225
00:08:32,500 --> 00:08:34,330
technologies they actually had their

226
00:08:34,330 --> 00:08:35,919
hands in the Cambodian election at one

227
00:08:35,919 --> 00:08:38,320
point this was I forget who actually

228
00:08:38,320 --> 00:08:39,880
came out with this research but maybe

229
00:08:39,880 --> 00:08:40,419
fireEye

230
00:08:40,419 --> 00:08:45,400
in July of 2018 again naval secrets in

231
00:08:45,400 --> 00:08:48,459
this instance here the actual Chinese

232
00:08:48,459 --> 00:08:52,000
Navy did seize an American uuv at one

233
00:08:52,000 --> 00:08:52,300
point

234
00:08:52,300 --> 00:08:55,750
they intercepted underwater our unmanned

235
00:08:55,750 --> 00:08:58,269
vehicle and then when they did that they

236
00:08:58,269 --> 00:09:01,500
actually sent Spears and posed as a uuv

237
00:09:01,500 --> 00:09:03,279
manufacturer as well to get more

238
00:09:03,279 --> 00:09:06,670
technologies and then I think this was

239
00:09:06,670 --> 00:09:08,890
recorded future if I'm not mistaken they

240
00:09:08,890 --> 00:09:10,390
wrote some reporting on how they were

241
00:09:10,390 --> 00:09:12,459
using some Russian apt techniques so if

242
00:09:12,459 --> 00:09:13,750
you've seen any of these headlines this

243
00:09:13,750 --> 00:09:16,500
is the actor we're talking about I

244
00:09:16,500 --> 00:09:18,610
mentioned the naval technologies this

245
00:09:18,610 --> 00:09:21,100
was what they focused on early on they

246
00:09:21,100 --> 00:09:24,700
were very heavily involved in gathering

247
00:09:24,700 --> 00:09:28,000
information on anything related to naval

248
00:09:28,000 --> 00:09:30,550
technologies or maritime interests and

249
00:09:30,550 --> 00:09:33,160
also South China Sea you'll see a map

250
00:09:33,160 --> 00:09:35,829
here in a minute more recently though we

251
00:09:35,829 --> 00:09:38,350
see them targeting people or countries

252
00:09:38,350 --> 00:09:40,029
or organizations that are invested in

253
00:09:40,029 --> 00:09:42,940
the Bri so they've moved away not

254
00:09:42,940 --> 00:09:44,890
completely but moved away from the naval

255
00:09:44,890 --> 00:09:47,140
stuff and more focused on Bri at this

256
00:09:47,140 --> 00:09:49,209
point so you'll see on the map fire I

257
00:09:49,209 --> 00:09:51,070
did a really good job in their report

258
00:09:51,070 --> 00:09:53,890
back in March on this but basically you

259
00:09:53,890 --> 00:09:56,170
can see very distinct separation of

260
00:09:56,170 --> 00:09:58,209
targeting the interesting part here why

261
00:09:58,209 --> 00:09:59,560
I put this up as if you look at the

262
00:09:59,560 --> 00:10:01,630
South China Sea pretty much every

263
00:10:01,630 --> 00:10:04,149
country that borders that sea has been

264
00:10:04,149 --> 00:10:06,310
targeted and hit by these guys I would

265
00:10:06,310 --> 00:10:07,839
argue that Vietnam is actually on the

266
00:10:07,839 --> 00:10:09,700
list as well it's not colored here but

267
00:10:09,700 --> 00:10:12,459
and then you have countries like in the

268
00:10:12,459 --> 00:10:15,550
Middle East you have you know Norway UK

269
00:10:15,550 --> 00:10:17,890
u.s. obviously this is where they're

270
00:10:17,890 --> 00:10:20,440
targeting engineering companies defense

271
00:10:20,440 --> 00:10:23,860
contractors as well as Bri energy stuff

272
00:10:23,860 --> 00:10:26,410
like that so pretty much pretty wide

273
00:10:26,410 --> 00:10:30,130
across the board their endgame obviously

274
00:10:30,130 --> 00:10:32,079
like any other cyber espionage actor is

275
00:10:32,079 --> 00:10:34,930
going after information they're more of

276
00:10:34,930 --> 00:10:36,550
a smash-and-grab type actor so they'll

277
00:10:36,550 --> 00:10:37,810
come in they'll find the information

278
00:10:37,810 --> 00:10:40,690
they want bundle it up ship it out we

279
00:10:40,690 --> 00:10:41,949
don't see them doing anything like

280
00:10:41,949 --> 00:10:44,140
destructive attacks or any of that other

281
00:10:44,140 --> 00:10:46,260
stuff financially motivated type things

282
00:10:46,260 --> 00:10:48,790
what's interesting about their tempo is

283
00:10:48,790 --> 00:10:51,070
it's fairly consistent but they always

284
00:10:51,070 --> 00:10:53,829
tend to use very short very targeted

285
00:10:53,829 --> 00:10:56,079
campaigns the people that they target

286
00:10:56,079 --> 00:10:58,829
we're talking defense attache directly

287
00:10:58,829 --> 00:11:01,660
ministers directly president's office

288
00:11:01,660 --> 00:11:03,940
directly we're not going after

289
00:11:03,940 --> 00:11:06,040
secretaries we're not going after

290
00:11:06,040 --> 00:11:08,079
people in an organization their various

291
00:11:08,079 --> 00:11:10,660
meticulous with who they target and then

292
00:11:10,660 --> 00:11:12,160
they shut that campaign down very

293
00:11:12,160 --> 00:11:16,839
quickly to try to hide what they did so

294
00:11:16,839 --> 00:11:21,759
onto the malware I like Star Wars the

295
00:11:21,759 --> 00:11:23,259
one on the left is my favorite and he

296
00:11:23,259 --> 00:11:26,170
felt your presence so I broke the

297
00:11:26,170 --> 00:11:27,850
malware down into three pieces because

298
00:11:27,850 --> 00:11:30,910
it had this very intricate exploit chain

299
00:11:30,910 --> 00:11:33,370
that was going on so we talking to talk

300
00:11:33,370 --> 00:11:34,959
about the macro or the template first

301
00:11:34,959 --> 00:11:36,910
and then the loader DLL and then

302
00:11:36,910 --> 00:11:39,339
ultimately the end main dad joke payload

303
00:11:39,339 --> 00:11:43,630
itself so on to the template this is

304
00:11:43,630 --> 00:11:45,069
obviously the initial start of the

305
00:11:45,069 --> 00:11:47,410
exploit chain when the document is

306
00:11:47,410 --> 00:11:49,630
opened the the it will go out and

307
00:11:49,630 --> 00:11:51,220
basically fetch a template from a remote

308
00:11:51,220 --> 00:11:53,800
location on the server inside the

309
00:11:53,800 --> 00:11:55,509
template there's a macro that's executed

310
00:11:55,509 --> 00:11:56,980
and that kicks off a very interesting

311
00:11:56,980 --> 00:11:59,740
chain of events and I show you a couple

312
00:11:59,740 --> 00:12:02,050
things here so first off the part that's

313
00:12:02,050 --> 00:12:04,839
highlighted in white in this URL feel

314
00:12:04,839 --> 00:12:06,399
free to take pictures again because this

315
00:12:06,399 --> 00:12:08,380
is I'll mention this later on in the

316
00:12:08,380 --> 00:12:11,410
detection and defense section but these

317
00:12:11,410 --> 00:12:13,690
are pretty unique to this actual macro

318
00:12:13,690 --> 00:12:16,690
so as soon as the macro is run the first

319
00:12:16,690 --> 00:12:18,310
thing it does is it goes and does a get

320
00:12:18,310 --> 00:12:20,560
request to the server of choice and it

321
00:12:20,560 --> 00:12:22,690
does this two parameters at the end the

322
00:12:22,690 --> 00:12:24,190
username and the hostname basically

323
00:12:24,190 --> 00:12:26,410
beginning back and saying hey the macro

324
00:12:26,410 --> 00:12:28,839
was run on this box then it goes through

325
00:12:28,839 --> 00:12:30,519
and it actually extracts the benign

326
00:12:30,519 --> 00:12:32,709
executable from the word doc in the last

327
00:12:32,709 --> 00:12:34,600
wave of attacks this was a Windows

328
00:12:34,600 --> 00:12:37,389
Defender executable that's vulnerable to

329
00:12:37,389 --> 00:12:40,540
the load order hijacking and then it'll

330
00:12:40,540 --> 00:12:42,370
send another get request and then this

331
00:12:42,370 --> 00:12:44,620
time it uses the parameter a equals exe

332
00:12:44,620 --> 00:12:47,350
basically saying hey I was able to pull

333
00:12:47,350 --> 00:12:49,050
the executable out of the document

334
00:12:49,050 --> 00:12:52,180
almost like it's logging then it'll go

335
00:12:52,180 --> 00:12:53,949
through and actually extract the DLL or

336
00:12:53,949 --> 00:12:54,430
the loader

337
00:12:54,430 --> 00:12:56,860
from the word document as well and it

338
00:12:56,860 --> 00:12:59,350
unhides the content to the user which

339
00:12:59,350 --> 00:13:01,350
we'll discuss here in the next slide and

340
00:13:01,350 --> 00:13:03,910
it executes the benign executable

341
00:13:03,910 --> 00:13:05,800
ultimately side loading the loader into

342
00:13:05,800 --> 00:13:08,829
place and then it sends another get

343
00:13:08,829 --> 00:13:10,899
request and this time it says a equals

344
00:13:10,899 --> 00:13:13,360
run so those three things in order like

345
00:13:13,360 --> 00:13:14,769
that is actually a really unique

346
00:13:14,769 --> 00:13:19,029
indicator to the macro obviously just

347
00:13:19,029 --> 00:13:19,930
talked about that

348
00:13:19,930 --> 00:13:22,420
basically what this is is the actor

349
00:13:22,420 --> 00:13:24,760
built this functionality into the macro

350
00:13:24,760 --> 00:13:27,430
to track the exploit chain so if

351
00:13:27,430 --> 00:13:29,050
something goes wrong along the way

352
00:13:29,050 --> 00:13:31,120
they're able to say okay well we were

353
00:13:31,120 --> 00:13:33,760
able to have the macro execute and then

354
00:13:33,760 --> 00:13:35,860
the exe got pulled out at the document

355
00:13:35,860 --> 00:13:37,839
but the dll they can get side loaded so

356
00:13:37,839 --> 00:13:39,459
it helps them kind of debug and figure

357
00:13:39,459 --> 00:13:41,200
out before they have full access on the

358
00:13:41,200 --> 00:13:43,149
box what actually happened in the chain

359
00:13:43,149 --> 00:13:45,940
which is pretty smart they just look at

360
00:13:45,940 --> 00:13:48,790
their web logs basically they also use

361
00:13:48,790 --> 00:13:51,580
these things called eyes shapes in the

362
00:13:51,580 --> 00:13:55,360
macro pardon me and that was those

363
00:13:55,360 --> 00:13:57,790
values that I showed you earlier so they

364
00:13:57,790 --> 00:14:00,910
use these values for the executable the

365
00:14:00,910 --> 00:14:04,930
dll and the actual hidden content so

366
00:14:04,930 --> 00:14:06,910
what's unique about this is that the two

367
00:14:06,910 --> 00:14:09,520
values that's at top we've seen change a

368
00:14:09,520 --> 00:14:13,839
little bit but the one at the bottom has

369
00:14:13,839 --> 00:14:15,760
not so we've observed three actual

370
00:14:15,760 --> 00:14:17,440
different values for the exe and the

371
00:14:17,440 --> 00:14:19,089
loader and all the eight campaigns we've

372
00:14:19,089 --> 00:14:21,070
seen but they've used the exact same

373
00:14:21,070 --> 00:14:23,080
value every time for the hidden content

374
00:14:23,080 --> 00:14:24,940
portion this was kind of a screw-up I

375
00:14:24,940 --> 00:14:26,500
think by their part so they'll probably

376
00:14:26,500 --> 00:14:27,880
see these slides and then change it

377
00:14:27,880 --> 00:14:30,730
sorry but for now it's a really good

378
00:14:30,730 --> 00:14:32,680
detection you're able to pivot it and

379
00:14:32,680 --> 00:14:34,240
find other stuff just based on that in

380
00:14:34,240 --> 00:14:38,350
the macro so onto the loader this

381
00:14:38,350 --> 00:14:41,500
basically only has two functions

382
00:14:41,500 --> 00:14:45,100
it basically extracts the payload from a

383
00:14:45,100 --> 00:14:47,350
resource and loads it into memory and

384
00:14:47,350 --> 00:14:49,300
the way it does that is obviously it

385
00:14:49,300 --> 00:14:51,040
started started using the load order

386
00:14:51,040 --> 00:14:54,220
hijacking and then inside of the actual

387
00:14:54,220 --> 00:14:55,900
loader there's an encrypted config block

388
00:14:55,900 --> 00:14:58,660
as well as a compressed payload lzma

389
00:14:58,660 --> 00:15:00,670
compressed payload which is the dad joke

390
00:15:00,670 --> 00:15:03,640
malware itself the thing about the

391
00:15:03,640 --> 00:15:07,170
loader is it's very small in function

392
00:15:07,170 --> 00:15:10,150
and it only does a couple things and

393
00:15:10,150 --> 00:15:12,520
it's changed every campaign so it makes

394
00:15:12,520 --> 00:15:14,620
it super difficult to sigil on in the

395
00:15:14,620 --> 00:15:16,690
latest wave the configuration block

396
00:15:16,690 --> 00:15:19,329
itself is actually 188 bytes and it's

397
00:15:19,329 --> 00:15:21,279
decrypted using a doubles or routine I

398
00:15:21,279 --> 00:15:23,589
think it was like Azure 88 and then 66

399
00:15:23,589 --> 00:15:27,160
sorry if I said so wrong but previous

400
00:15:27,160 --> 00:15:29,200
versions actually had different sizes

401
00:15:29,200 --> 00:15:32,230
for the config blocks they had different

402
00:15:32,230 --> 00:15:33,240
routines

403
00:15:33,240 --> 00:15:35,040
and it made it really really hard to

404
00:15:35,040 --> 00:15:37,439
sing on this DLL which actually kind of

405
00:15:37,439 --> 00:15:39,389
sucks because it's really the only file

406
00:15:39,389 --> 00:15:41,189
that's stored on disk everything else

407
00:15:41,189 --> 00:15:44,100
has run out of memory so it it made it

408
00:15:44,100 --> 00:15:46,429
very difficult for us to find things

409
00:15:46,429 --> 00:15:48,779
this is an example of the config block

410
00:15:48,779 --> 00:15:50,550
it's pretty standard if anybody's worked

411
00:15:50,550 --> 00:15:52,679
with malware before hopefully everybody

412
00:15:52,679 --> 00:15:54,360
in this room but up at the top you have

413
00:15:54,360 --> 00:15:56,639
the SI toos I highlighted a few

414
00:15:56,639 --> 00:15:58,379
interesting pieces here so the middle

415
00:15:58,379 --> 00:16:00,869
part is the web directory where actually

416
00:16:00,869 --> 00:16:02,910
all the data gets uploaded to so they're

417
00:16:02,910 --> 00:16:05,189
able to put one or multiple c2s in the

418
00:16:05,189 --> 00:16:07,429
config but then for each victim

419
00:16:07,429 --> 00:16:09,899
organization or each person they're

420
00:16:09,899 --> 00:16:11,069
going after they can actually change

421
00:16:11,069 --> 00:16:14,189
that config value and have that user's

422
00:16:14,189 --> 00:16:16,110
data go to a different folder so it's

423
00:16:16,110 --> 00:16:18,480
easy for them to track the more

424
00:16:18,480 --> 00:16:20,129
interesting pieces are the two byte

425
00:16:20,129 --> 00:16:21,660
flags that I actually highlighted there

426
00:16:21,660 --> 00:16:23,220
so the first one on the right hand side

427
00:16:23,220 --> 00:16:25,649
the double zero I found in this last

428
00:16:25,649 --> 00:16:28,889
wave that they left the ability in the

429
00:16:28,889 --> 00:16:30,899
malware to actually flip a debug switch

430
00:16:30,899 --> 00:16:33,869
on so the malware developer forgot to

431
00:16:33,869 --> 00:16:35,550
turn that out or turn it off or take it

432
00:16:35,550 --> 00:16:38,819
out but this is the value in the config

433
00:16:38,819 --> 00:16:40,199
block where if you were able to turn

434
00:16:40,199 --> 00:16:42,540
that on by making it a non zero value

435
00:16:42,540 --> 00:16:45,269
the malware will just basically crap out

436
00:16:45,269 --> 00:16:46,949
logs like it's going out of style

437
00:16:46,949 --> 00:16:48,389
which is great because if you're not a

438
00:16:48,389 --> 00:16:50,939
reverse or you can just run it and look

439
00:16:50,939 --> 00:16:52,439
at the log files and see what's going on

440
00:16:52,439 --> 00:16:55,740
the one on the left is actually the

441
00:16:55,740 --> 00:16:58,350
persistence flag so what really sucks is

442
00:16:58,350 --> 00:17:01,259
they can turn that to zero and not even

443
00:17:01,259 --> 00:17:03,329
write the dll to the hard disk in the

444
00:17:03,329 --> 00:17:05,549
first place so everything is a memory

445
00:17:05,549 --> 00:17:07,140
which is really cool and it makes it

446
00:17:07,140 --> 00:17:11,789
very hard to detect so onto the payload

447
00:17:11,789 --> 00:17:13,349
let me make sure I didn't skip a slide

448
00:17:13,349 --> 00:17:16,319
there yeah we're good so the payload

449
00:17:16,319 --> 00:17:17,789
itself is actually nothing really

450
00:17:17,789 --> 00:17:19,980
special I was hoping there was going to

451
00:17:19,980 --> 00:17:21,689
be loads of functionality in this thing

452
00:17:21,689 --> 00:17:24,510
but in real in reality it was just

453
00:17:24,510 --> 00:17:27,569
basically a beacon and a download and

454
00:17:27,569 --> 00:17:29,220
execute stage - so this was really

455
00:17:29,220 --> 00:17:31,520
designed as a stage one payload

456
00:17:31,520 --> 00:17:33,750
unfortunately in the last couple waves

457
00:17:33,750 --> 00:17:35,820
we haven't been able to figure out what

458
00:17:35,820 --> 00:17:38,340
the stage two payload actually is in

459
00:17:38,340 --> 00:17:40,890
previous campaigns in the past this

460
00:17:40,890 --> 00:17:42,840
actor has used things like Cobalt strike

461
00:17:42,840 --> 00:17:46,489
and other cots and and open source type

462
00:17:46,489 --> 00:17:48,629
but in this case I don't really know

463
00:17:48,629 --> 00:17:50,389
what it is yet so we're still looking

464
00:17:50,389 --> 00:17:52,470
potentially this is one of those dad

465
00:17:52,470 --> 00:17:54,600
shorts or dad bod things but I don't

466
00:17:54,600 --> 00:17:56,549
know I haven't I don't have access to

467
00:17:56,549 --> 00:17:58,830
fireEye reporting so hopefully we can

468
00:17:58,830 --> 00:18:02,129
find it but what was really cool is the

469
00:18:02,129 --> 00:18:04,619
actor was again very meticulous each

470
00:18:04,619 --> 00:18:07,289
payload that I looked at was literally

471
00:18:07,289 --> 00:18:09,480
compiled a day or two before the

472
00:18:09,480 --> 00:18:11,450
campaign started so they were building

473
00:18:11,450 --> 00:18:14,429
each individual payload for each victim

474
00:18:14,429 --> 00:18:15,929
that they were going after which was

475
00:18:15,929 --> 00:18:17,669
it's pretty unique for an actor to do

476
00:18:17,669 --> 00:18:19,980
that a lot of times actors will spit out

477
00:18:19,980 --> 00:18:22,049
one payload and send it to a bunch of

478
00:18:22,049 --> 00:18:23,639
people in this case they were really

479
00:18:23,639 --> 00:18:26,279
going in configuring that specific for

480
00:18:26,279 --> 00:18:28,109
that victim sending it and they could

481
00:18:28,109 --> 00:18:29,820
track all their pieces of malware based

482
00:18:29,820 --> 00:18:32,609
off of this so it was pretty cool again

483
00:18:32,609 --> 00:18:34,289
the latest piece had actually a debug

484
00:18:34,289 --> 00:18:36,899
and persistence switch in the config and

485
00:18:36,899 --> 00:18:38,999
hopefully in the blog will have the

486
00:18:38,999 --> 00:18:40,739
exact bytes where that's at so if you do

487
00:18:40,739 --> 00:18:42,090
come across this malware you'll know

488
00:18:42,090 --> 00:18:44,460
what bite to flip on but if you look at

489
00:18:44,460 --> 00:18:46,470
it and Ida it's pretty easy to see the

490
00:18:46,470 --> 00:18:48,480
chain of events that have to happen for

491
00:18:48,480 --> 00:18:50,669
the debug to happen so the beacon

492
00:18:50,669 --> 00:18:52,169
traffic itself for those that are

493
00:18:52,169 --> 00:18:54,210
interested in network traffic from a

494
00:18:54,210 --> 00:18:55,889
defender standpoint this is kind of what

495
00:18:55,889 --> 00:18:58,350
it looks like I highlighted values in

496
00:18:58,350 --> 00:19:00,600
blue because this is generated randomly

497
00:19:00,600 --> 00:19:03,179
in the system but all the stuff in red

498
00:19:03,179 --> 00:19:05,249
other than the payload or the actual

499
00:19:05,249 --> 00:19:07,350
data the header information is

500
00:19:07,350 --> 00:19:10,320
hard-coded in the malware so you can sig

501
00:19:10,320 --> 00:19:12,210
on the user agent which I don't think in

502
00:19:12,210 --> 00:19:15,419
this case is super unique but there's

503
00:19:15,419 --> 00:19:16,679
some other things in there that you

504
00:19:16,679 --> 00:19:18,840
might be able to to write signatures on

505
00:19:18,840 --> 00:19:21,269
specifically the file name with image

506
00:19:21,269 --> 00:19:24,210
that blue portion is filled in through

507
00:19:24,210 --> 00:19:26,789
format strings for example so you can

508
00:19:26,789 --> 00:19:28,619
write some signatures on that but

509
00:19:28,619 --> 00:19:30,359
basically it's made to look like a PNG

510
00:19:30,359 --> 00:19:32,730
they slap the PNG header on the front

511
00:19:32,730 --> 00:19:34,830
they do a post to the c2 and then

512
00:19:34,830 --> 00:19:36,359
they're off to the races getting data

513
00:19:36,359 --> 00:19:39,419
the data itself is actually encrypted

514
00:19:39,419 --> 00:19:44,549
using AES 128 so that's not super unique

515
00:19:44,549 --> 00:19:46,649
or anything but what was unique is the

516
00:19:46,649 --> 00:19:48,509
key generation for the actual encryption

517
00:19:48,509 --> 00:19:51,989
a lot of times bad guys will put in the

518
00:19:51,989 --> 00:19:54,330
key hard-coded into the malware and go

519
00:19:54,330 --> 00:19:56,850
from there and use that as obviously the

520
00:19:56,850 --> 00:19:58,380
key for the encryption in

521
00:19:58,380 --> 00:20:01,620
case they followed a very weird chain of

522
00:20:01,620 --> 00:20:03,960
events but basically they generate a

523
00:20:03,960 --> 00:20:06,860
64-byte value using the Microsoft API

524
00:20:06,860 --> 00:20:09,630
and then what they did is they prepended

525
00:20:09,630 --> 00:20:11,760
this string secure 32 dot Lib to the

526
00:20:11,760 --> 00:20:14,280
front of that 64 byte value so now they

527
00:20:14,280 --> 00:20:16,110
have whatever it is 75 bytes or

528
00:20:16,110 --> 00:20:18,240
something and then what they do is they

529
00:20:18,240 --> 00:20:20,940
take a shot 256 of that full value and

530
00:20:20,940 --> 00:20:24,570
that will spit out a 32 byte value that

531
00:20:24,570 --> 00:20:27,120
then they split into two 16 byte values

532
00:20:27,120 --> 00:20:29,190
and they use the first one as the key

533
00:20:29,190 --> 00:20:31,080
and then the second one as the IV and

534
00:20:31,080 --> 00:20:33,000
then each time they encrypt the next

535
00:20:33,000 --> 00:20:35,190
package they throw the IV in the top of

536
00:20:35,190 --> 00:20:38,190
the data so it's able to be decrypted in

537
00:20:38,190 --> 00:20:41,010
CBC mode on the back end so it was kind

538
00:20:41,010 --> 00:20:42,780
of a unique way of generating the key

539
00:20:42,780 --> 00:20:45,410
here but it was pretty interesting to me

540
00:20:45,410 --> 00:20:47,610
previous versions actually used the

541
00:20:47,610 --> 00:20:49,800
string hello everyone we're talking the

542
00:20:49,800 --> 00:20:51,450
ones back in like January March

543
00:20:51,450 --> 00:20:52,230
timeframe

544
00:20:52,230 --> 00:20:55,650
and I think they've changed that to a

545
00:20:55,650 --> 00:20:58,290
more benign type string now because

546
00:20:58,290 --> 00:20:59,820
everyone started singing on hello

547
00:20:59,820 --> 00:21:01,680
everyone they wanted to look more

548
00:21:01,680 --> 00:21:03,870
professional I guess so but older

549
00:21:03,870 --> 00:21:05,850
versions use that as the prepended value

550
00:21:05,850 --> 00:21:08,810
instead of the secure 32 dot live and

551
00:21:08,810 --> 00:21:11,370
the decrypted data once you decrypt it

552
00:21:11,370 --> 00:21:12,990
it's really nothing super special but

553
00:21:12,990 --> 00:21:14,730
it's just MAC address username system

554
00:21:14,730 --> 00:21:18,570
name IP address etc so that's basically

555
00:21:18,570 --> 00:21:21,660
the malware but I did want to go through

556
00:21:21,660 --> 00:21:24,600
some final things about the actor in

557
00:21:24,600 --> 00:21:27,390
particular warren you're missing the

558
00:21:27,390 --> 00:21:29,760
mathematician jack come on it's a good

559
00:21:29,760 --> 00:21:32,340
one I want to talk about the attribution

560
00:21:32,340 --> 00:21:33,660
caveats there was a couple things and

561
00:21:33,660 --> 00:21:35,100
also I always like to kind of throw in

562
00:21:35,100 --> 00:21:36,750
some defense and detection strategies

563
00:21:36,750 --> 00:21:38,850
for those people that are involved in

564
00:21:38,850 --> 00:21:42,060
that sort of thing so on the attribution

565
00:21:42,060 --> 00:21:44,040
fire I specifically says that this is

566
00:21:44,040 --> 00:21:47,550
probable apt 40 i've only have the tweet

567
00:21:47,550 --> 00:21:49,530
from nick basically saying this but i've

568
00:21:49,530 --> 00:21:50,820
talked to them and they still don't

569
00:21:50,820 --> 00:21:53,490
definitively tie this to the actor i

570
00:21:53,490 --> 00:21:56,340
will say that the malware itself is only

571
00:21:56,340 --> 00:21:58,680
unique to this actor that i see so that

572
00:21:58,680 --> 00:22:01,440
is kind of an indication that it's them

573
00:22:01,440 --> 00:22:04,980
but i still my official stance with our

574
00:22:04,980 --> 00:22:06,360
reporting is that with moderate

575
00:22:06,360 --> 00:22:09,030
confidence this is leviathan or apt 40

576
00:22:09,030 --> 00:22:11,010
the reason i say moderate confident

577
00:22:11,010 --> 00:22:14,220
is there were some data points going

578
00:22:14,220 --> 00:22:15,990
through when I was writing the report

579
00:22:15,990 --> 00:22:18,390
that I found that made me second-guess

580
00:22:18,390 --> 00:22:19,950
whether this is actually them or not and

581
00:22:19,950 --> 00:22:21,480
I really can't account for why this

582
00:22:21,480 --> 00:22:24,480
happened but in particular there was one

583
00:22:24,480 --> 00:22:26,760
user that actually was targeted with a

584
00:22:26,760 --> 00:22:29,040
different malware called net eagle about

585
00:22:29,040 --> 00:22:31,760
a week before they were targeted with

586
00:22:31,760 --> 00:22:33,240
that joke

587
00:22:33,240 --> 00:22:34,890
so it was kind of interesting the net

588
00:22:34,890 --> 00:22:37,260
eagle malware in particular is usually

589
00:22:37,260 --> 00:22:39,780
attributed to apt 30 a different Chinese

590
00:22:39,780 --> 00:22:42,810
based actor so it says to me one of a

591
00:22:42,810 --> 00:22:43,440
few things

592
00:22:43,440 --> 00:22:46,860
either a PT 30 and apt 40 aren't talking

593
00:22:46,860 --> 00:22:48,510
to each other and they're both targeting

594
00:22:48,510 --> 00:22:50,160
the same victim I think that might be

595
00:22:50,160 --> 00:22:52,590
the case but it could also mean that a

596
00:22:52,590 --> 00:22:54,720
PT 30 and 40 might be the same person

597
00:22:54,720 --> 00:22:57,810
I'm not really sure but I think that

598
00:22:57,810 --> 00:22:59,040
they're just stepping on each other's

599
00:22:59,040 --> 00:23:00,330
toes because they have the same

600
00:23:00,330 --> 00:23:02,070
directive and there's many many teams

601
00:23:02,070 --> 00:23:04,710
coming out of China so this is one of

602
00:23:04,710 --> 00:23:07,730
those cases where you have a collision

603
00:23:07,730 --> 00:23:10,290
more interestingly though we had this

604
00:23:10,290 --> 00:23:12,570
actor group or this activity group that

605
00:23:12,570 --> 00:23:16,380
we called per fan Li pardon if it's

606
00:23:16,380 --> 00:23:17,910
spelled wrong I think some people call

607
00:23:17,910 --> 00:23:19,950
it profoundly was that actually the name

608
00:23:19,950 --> 00:23:22,200
in the malware but we have this cluster

609
00:23:22,200 --> 00:23:24,180
of activity that we never really had

610
00:23:24,180 --> 00:23:26,130
attributed to anybody previously we just

611
00:23:26,130 --> 00:23:27,810
knew it as a cluster we didn't have an

612
00:23:27,810 --> 00:23:31,380
actor with it what I saw with this which

613
00:23:31,380 --> 00:23:33,360
was really interesting is that at the

614
00:23:33,360 --> 00:23:36,060
end of 2018 I saw per fan Li being

615
00:23:36,060 --> 00:23:38,750
backed out of systems and then dad joke

616
00:23:38,750 --> 00:23:41,160
them being targeted with dad joke

617
00:23:41,160 --> 00:23:43,740
immediately after so in December they

618
00:23:43,740 --> 00:23:46,470
removed that and then in January there

619
00:23:46,470 --> 00:23:48,270
was targeting by dad joke at the same

620
00:23:48,270 --> 00:23:50,730
target so I think it kind of indicates

621
00:23:50,730 --> 00:23:53,400
that potentially profoundly if anybody

622
00:23:53,400 --> 00:23:54,890
else has ever tracked that activity

623
00:23:54,890 --> 00:23:57,810
might be another tool or cluster from

624
00:23:57,810 --> 00:23:59,610
the Leviathan actor I'm not really sure

625
00:23:59,610 --> 00:24:00,930
I'd love to talk to some people if

626
00:24:00,930 --> 00:24:04,230
they're familiar with that so onto

627
00:24:04,230 --> 00:24:06,360
detection I mentioned earlier the

628
00:24:06,360 --> 00:24:10,770
easiest thing is those three URLs if

629
00:24:10,770 --> 00:24:11,940
you're looking at the perimeter

630
00:24:11,940 --> 00:24:13,950
basically at post request coming out of

631
00:24:13,950 --> 00:24:15,660
your network you're able to pretty

632
00:24:15,660 --> 00:24:17,460
easily sig on those URLs that I

633
00:24:17,460 --> 00:24:20,280
highlighted in white we have had one

634
00:24:20,280 --> 00:24:22,170
false positive on that some other

635
00:24:22,170 --> 00:24:24,539
website actually uses those parameters

636
00:24:24,539 --> 00:24:26,549
it's pretty rare and we just put in a

637
00:24:26,549 --> 00:24:29,309
little whitelist and it was fine we

638
00:24:29,309 --> 00:24:30,239
haven't really seen any other

639
00:24:30,239 --> 00:24:31,589
false-positive since then so that's

640
00:24:31,589 --> 00:24:34,349
pretty easy detection secondly if you

641
00:24:34,349 --> 00:24:36,679
have the ability to detect macros I

642
00:24:36,679 --> 00:24:38,879
don't I would say you should look into

643
00:24:38,879 --> 00:24:41,159
something that lets you look into macro

644
00:24:41,159 --> 00:24:42,719
code but if you do have that ability or

645
00:24:42,719 --> 00:24:44,659
if you do break those out based on

646
00:24:44,659 --> 00:24:46,440
attachments in your mail server or

647
00:24:46,440 --> 00:24:48,359
whatever looking for those unique

648
00:24:48,359 --> 00:24:50,159
eyeshape values that I mentioned earlier

649
00:24:50,159 --> 00:24:51,959
that's a pretty easy Sig also too ripe

650
00:24:51,959 --> 00:24:54,719
and indicates that you're looking at dad

651
00:24:54,719 --> 00:24:56,759
joke malware and then finally a lot of

652
00:24:56,759 --> 00:24:58,379
people don't have this ability but it

653
00:24:58,379 --> 00:25:00,239
needs to become more prevalent is

654
00:25:00,239 --> 00:25:02,969
looking in memory a lot of actors

655
00:25:02,969 --> 00:25:04,859
nowadays are moving to the file list

656
00:25:04,859 --> 00:25:06,569
type malware and the only way you're

657
00:25:06,569 --> 00:25:08,429
going to detect it is in memory so in

658
00:25:08,429 --> 00:25:11,940
this case we couldn't detect the loader

659
00:25:11,940 --> 00:25:13,979
DLL because of there's there's so many

660
00:25:13,979 --> 00:25:15,899
changes that happened over the period of

661
00:25:15,899 --> 00:25:18,629
8 months or 10 months we focused on the

662
00:25:18,629 --> 00:25:20,729
actual main payload once it's loaded in

663
00:25:20,729 --> 00:25:22,349
memory or at least decompressed in

664
00:25:22,349 --> 00:25:25,259
memory and this was a pretty good cig to

665
00:25:25,259 --> 00:25:26,819
look at as well and you can stop it

666
00:25:26,819 --> 00:25:29,339
before it's actually called so again

667
00:25:29,339 --> 00:25:30,929
static detection on the loader was

668
00:25:30,929 --> 00:25:33,599
pretty tough so looking on disk is not

669
00:25:33,599 --> 00:25:37,409
that easy to do if you do business in

670
00:25:37,409 --> 00:25:39,869
Southeast Asia or if you're a defense

671
00:25:39,869 --> 00:25:42,179
contractor or if you deal in naval

672
00:25:42,179 --> 00:25:44,399
technologies you probably should know

673
00:25:44,399 --> 00:25:46,469
about this actor I'm hoping that if you

674
00:25:46,469 --> 00:25:49,799
do you are aware of apt 40 but if not go

675
00:25:49,799 --> 00:25:51,929
read about them they're super important

676
00:25:51,929 --> 00:25:54,329
to your business and then finally

677
00:25:54,329 --> 00:25:56,579
obviously user awareness I put it in all

678
00:25:56,579 --> 00:25:59,429
my slides but we don't do it enough we

679
00:25:59,429 --> 00:26:00,899
need to train our users more and more

680
00:26:00,899 --> 00:26:02,429
they're the front lines of defense so

681
00:26:02,429 --> 00:26:04,619
you know please let them know about what

682
00:26:04,619 --> 00:26:07,019
these Spears look like how this actor in

683
00:26:07,019 --> 00:26:10,109
particular is going after people and and

684
00:26:10,109 --> 00:26:14,039
let the defense attache types know about

685
00:26:14,039 --> 00:26:15,599
this training as well not just your

686
00:26:15,599 --> 00:26:17,219
normal staff because those are the ones

687
00:26:17,219 --> 00:26:20,009
being targeted so at that point I'll

688
00:26:20,009 --> 00:26:21,659
take any questions those are my kids

689
00:26:21,659 --> 00:26:23,729
this is usually the reaction I get every

690
00:26:23,729 --> 00:26:26,519
time I tell a dad they don't quite get

691
00:26:26,519 --> 00:26:30,020
them but I do so that's it thanks

692
00:26:30,020 --> 00:26:32,080
you

