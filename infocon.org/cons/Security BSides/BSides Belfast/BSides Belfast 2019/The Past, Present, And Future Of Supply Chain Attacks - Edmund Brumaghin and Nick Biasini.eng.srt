1
00:00:02,620 --> 00:00:05,809
all right welcome everybody thanks for

2
00:00:05,809 --> 00:00:07,970
sticking it out for the afternoon we're

3
00:00:07,970 --> 00:00:10,370
gonna talk to you today about signed

4
00:00:10,370 --> 00:00:12,230
sealed and compromised kind of where we

5
00:00:12,230 --> 00:00:14,480
are with supply chain attacks kind of

6
00:00:14,480 --> 00:00:16,369
where we've been where we are today and

7
00:00:16,369 --> 00:00:18,590
where we see it going in the future as

8
00:00:18,590 --> 00:00:20,540
far as who I am I'm a security

9
00:00:20,540 --> 00:00:23,000
researcher with Talos I got my start as

10
00:00:23,000 --> 00:00:25,490
a stock analyst used to work in a 24 by

11
00:00:25,490 --> 00:00:28,580
7 sock for too many years too many hours

12
00:00:28,580 --> 00:00:30,920
and I've been an analyst lead analyst

13
00:00:30,920 --> 00:00:33,019
manage teams of analysts I've basically

14
00:00:33,019 --> 00:00:35,269
done everything in security except be a

15
00:00:35,269 --> 00:00:36,949
developer and I'm very very proud of

16
00:00:36,949 --> 00:00:38,899
that because no one ever wants to look

17
00:00:38,899 --> 00:00:41,719
at my code ever as far as my research

18
00:00:41,719 --> 00:00:43,550
stuff is concerned I do a lot of

19
00:00:43,550 --> 00:00:45,170
research and exploit kits I have for a

20
00:00:45,170 --> 00:00:47,210
long time I was one of the people behind

21
00:00:47,210 --> 00:00:49,010
discovering domain shadowing I've done a

22
00:00:49,010 --> 00:00:50,629
lot of stuff with angler back in the day

23
00:00:50,629 --> 00:00:52,489
but today I'll talk to you about supply

24
00:00:52,489 --> 00:00:55,850
chain let me hand it off to Edmond yeah

25
00:00:55,850 --> 00:00:57,679
so my name's Edmond brummagem

26
00:00:57,679 --> 00:00:59,629
on you might recognize this slide if you

27
00:00:59,629 --> 00:01:01,670
were in my talk earlier on DNS but I'm a

28
00:01:01,670 --> 00:01:03,739
security researcher with Cisco sallows I

29
00:01:03,739 --> 00:01:06,530
love malware that's that's what I do on

30
00:01:06,530 --> 00:01:08,270
a daily basis we're typically neck deep

31
00:01:08,270 --> 00:01:09,740
in in different malware campaigns that

32
00:01:09,740 --> 00:01:11,600
we're seeing in the wild so I love

33
00:01:11,600 --> 00:01:12,829
ripping them apart and figure out how

34
00:01:12,829 --> 00:01:13,880
they work so that we can protect

35
00:01:13,880 --> 00:01:17,329
customers like Nick I have a background

36
00:01:17,329 --> 00:01:19,130
in security operations so I've held

37
00:01:19,130 --> 00:01:20,810
pretty much every role you can hold in a

38
00:01:20,810 --> 00:01:22,430
sock before coming over to into the

39
00:01:22,430 --> 00:01:26,180
research side ok let's talk a little

40
00:01:26,180 --> 00:01:27,829
let's talk a little bit about what

41
00:01:27,829 --> 00:01:29,509
supply chain is what it's actually made

42
00:01:29,509 --> 00:01:31,219
up of there's a lot of components to

43
00:01:31,219 --> 00:01:32,479
supply chain and I'm gonna kind of

44
00:01:32,479 --> 00:01:35,180
abstract this to general terms so at its

45
00:01:35,180 --> 00:01:37,700
most basic form what you start with is

46
00:01:37,700 --> 00:01:39,920
raw material and this could be something

47
00:01:39,920 --> 00:01:41,780
you mind something you create whatever

48
00:01:41,780 --> 00:01:44,030
that is some sort of raw object right

49
00:01:44,030 --> 00:01:46,520
well that object has to get somewhere

50
00:01:46,520 --> 00:01:48,079
that's where suppliers come in they're

51
00:01:48,079 --> 00:01:50,390
the ones that move the raw material and

52
00:01:50,390 --> 00:01:53,659
put it into manufacturing this is where

53
00:01:53,659 --> 00:01:55,219
you have the people that are actually

54
00:01:55,219 --> 00:01:58,039
assembling the software the widget the

55
00:01:58,039 --> 00:01:59,899
whatever you want to call it the item

56
00:01:59,899 --> 00:02:01,939
that is being created now that you

57
00:02:01,939 --> 00:02:04,219
actually have a finalized product you

58
00:02:04,219 --> 00:02:07,009
then move in to distribution so now

59
00:02:07,009 --> 00:02:08,750
you're you have you went from raw

60
00:02:08,750 --> 00:02:10,310
materials to getting those raw materials

61
00:02:10,310 --> 00:02:11,920
to the manufacturer

62
00:02:11,920 --> 00:02:13,810
the manufacturer creates a finalized

63
00:02:13,810 --> 00:02:16,000
product that finalized product then goes

64
00:02:16,000 --> 00:02:17,830
into a distribution network which then

65
00:02:17,830 --> 00:02:21,180
finally gets to your customers so

66
00:02:21,180 --> 00:02:24,550
immediately you should see why people

67
00:02:24,550 --> 00:02:27,610
attack supply chain there are so many

68
00:02:27,610 --> 00:02:30,160
people involved in this process there

69
00:02:30,160 --> 00:02:32,650
are just a lot of avenues for you to go

70
00:02:32,650 --> 00:02:35,350
down so let's start by talking about

71
00:02:35,350 --> 00:02:37,390
where this all started let's talk about

72
00:02:37,390 --> 00:02:39,250
the first ever instance of a supply

73
00:02:39,250 --> 00:02:41,230
chain attack that we've seen and it

74
00:02:41,230 --> 00:02:44,410
starts with the gunman project for those

75
00:02:44,410 --> 00:02:45,790
of you that aren't familiar this is a

76
00:02:45,790 --> 00:02:48,580
recently declassified project from the

77
00:02:48,580 --> 00:02:50,950
US government and it actually starts

78
00:02:50,950 --> 00:02:53,890
with Believe It or Not a typewriter this

79
00:02:53,890 --> 00:02:56,560
is the beginning of supply chain attacks

80
00:02:56,560 --> 00:02:57,730
all right

81
00:02:57,730 --> 00:03:01,000
yes I'm talking about the late 70s early

82
00:03:01,000 --> 00:03:03,489
80s the time of giant cell phones and

83
00:03:03,489 --> 00:03:07,150
terrible suits apparently what actually

84
00:03:07,150 --> 00:03:10,569
happened is there was a bunch of US

85
00:03:10,569 --> 00:03:12,760
embassies inside of Russia they received

86
00:03:12,760 --> 00:03:16,359
a tip that someone was intercepting the

87
00:03:16,359 --> 00:03:18,579
communications inside of their embassies

88
00:03:18,579 --> 00:03:22,720
inside of Russia what we actually found

89
00:03:22,720 --> 00:03:25,420
was the first known interdiction attack

90
00:03:25,420 --> 00:03:26,859
and I'll talk a little bit more about

91
00:03:26,859 --> 00:03:29,170
what interdiction attacks are but let me

92
00:03:29,170 --> 00:03:31,299
talk to you about what was done to these

93
00:03:31,299 --> 00:03:33,609
typewriters this is very interesting so

94
00:03:33,609 --> 00:03:35,590
basically what happened is these

95
00:03:35,590 --> 00:03:37,359
typewriters were being sent all the

96
00:03:37,359 --> 00:03:39,010
embassies they had to go through Russian

97
00:03:39,010 --> 00:03:41,019
customs when they arrived at Russian

98
00:03:41,019 --> 00:03:43,989
customs they were intercepted what they

99
00:03:43,989 --> 00:03:46,450
actually did is they took a solid metal

100
00:03:46,450 --> 00:03:48,040
bar that was inside of all these

101
00:03:48,040 --> 00:03:50,769
typewriters and hollowed it out inside

102
00:03:50,769 --> 00:03:52,750
of there they put a full circuit board

103
00:03:52,750 --> 00:03:55,359
that had full wireless communications

104
00:03:55,359 --> 00:03:57,459
for every key that was typed on the

105
00:03:57,459 --> 00:03:59,739
keyboard and the only way that they

106
00:03:59,739 --> 00:04:02,319
found it actually was through x-ray and

107
00:04:02,319 --> 00:04:05,380
the only group that found it was a small

108
00:04:05,380 --> 00:04:07,269
organization at the time that undertook

109
00:04:07,269 --> 00:04:08,950
the task that no one else could fill

110
00:04:08,950 --> 00:04:12,280
called the National Security Agency so

111
00:04:12,280 --> 00:04:13,660
let's talk about the logistics behind

112
00:04:13,660 --> 00:04:18,070
this they had to in secret remove 11

113
00:04:18,070 --> 00:04:20,170
tons of equipment out of

114
00:04:20,170 --> 00:04:22,420
US embassies in Russia to figure out how

115
00:04:22,420 --> 00:04:24,160
to do this when they began the

116
00:04:24,160 --> 00:04:26,410
inspection no one could figure out what

117
00:04:26,410 --> 00:04:28,530
was going on there was no visible

118
00:04:28,530 --> 00:04:31,060
alterations nothing obviously was done

119
00:04:31,060 --> 00:04:33,820
they literally had to x-ray the machines

120
00:04:33,820 --> 00:04:35,920
to see it and actually on this slide you

121
00:04:35,920 --> 00:04:38,050
can actually see the x-ray as well as

122
00:04:38,050 --> 00:04:39,610
the actual board that they pulled out of

123
00:04:39,610 --> 00:04:42,880
the the typewriter itself as far as

124
00:04:42,880 --> 00:04:44,500
sophistication is concerned they

125
00:04:44,500 --> 00:04:46,480
actually had the ability to turn this

126
00:04:46,480 --> 00:04:49,090
tracking on and off remotely they

127
00:04:49,090 --> 00:04:51,340
transmitted everything wirelessly and

128
00:04:51,340 --> 00:04:53,620
they actually didn't record the type

129
00:04:53,620 --> 00:04:56,200
heads they monitored the monitored the

130
00:04:56,200 --> 00:04:58,810
electronic frequency of the rotation of

131
00:04:58,810 --> 00:05:01,450
the type heads to determine this what

132
00:05:01,450 --> 00:05:04,180
did we really find though the Russians

133
00:05:04,180 --> 00:05:06,550
created the first key logger that's

134
00:05:06,550 --> 00:05:07,930
basically what they did is they created

135
00:05:07,930 --> 00:05:10,420
the first key logger so let's talk a

136
00:05:10,420 --> 00:05:12,310
little bit about interdiction this is

137
00:05:12,310 --> 00:05:15,310
probably the most common form of supply

138
00:05:15,310 --> 00:05:16,750
chain that you're gonna see associated

139
00:05:16,750 --> 00:05:19,150
with very sophisticated actors in

140
00:05:19,150 --> 00:05:19,810
nation-states

141
00:05:19,810 --> 00:05:22,390
the reason that is is basically what

142
00:05:22,390 --> 00:05:23,770
they're doing is intercepting these

143
00:05:23,770 --> 00:05:25,630
products while they're mid shipment so

144
00:05:25,630 --> 00:05:28,990
once they leave the distributor and are

145
00:05:28,990 --> 00:05:30,820
heading to the customer they will

146
00:05:30,820 --> 00:05:33,520
intercept the packages in route modify

147
00:05:33,520 --> 00:05:35,980
them reseal them and continue along to

148
00:05:35,980 --> 00:05:39,670
their final destination okay so that is

149
00:05:39,670 --> 00:05:42,070
my example of interdiction attack let's

150
00:05:42,070 --> 00:05:45,190
talk about clipper chips just show of

151
00:05:45,190 --> 00:05:46,600
hands how many people actually remember

152
00:05:46,600 --> 00:05:49,480
or know about clipper chips oh it's an

153
00:05:49,480 --> 00:05:51,880
okay amount this is also pretty

154
00:05:51,880 --> 00:05:54,190
old-school but this is actually one of

155
00:05:54,190 --> 00:05:57,390
those clipper tips so the concept was

156
00:05:57,390 --> 00:06:00,850
AT&T released a hardware encrypted phone

157
00:06:00,850 --> 00:06:02,500
that allowed you to do encrypted

158
00:06:02,500 --> 00:06:04,630
communications between devices and the

159
00:06:04,630 --> 00:06:06,760
US government decided that they didn't

160
00:06:06,760 --> 00:06:08,800
like that so what they did is they came

161
00:06:08,800 --> 00:06:10,750
up with a concept of a clipper chip a

162
00:06:10,750 --> 00:06:13,540
clipper chip was supposed to use proper

163
00:06:13,540 --> 00:06:16,420
key escrow to allow only authorized

164
00:06:16,420 --> 00:06:19,420
users to decrypt communications and as

165
00:06:19,420 --> 00:06:21,310
we all know when you create a backdoor

166
00:06:21,310 --> 00:06:23,320
an encryption is only used by the one

167
00:06:23,320 --> 00:06:24,880
person it's intended for and it's

168
00:06:24,880 --> 00:06:27,130
implemented perfectly every time

169
00:06:27,130 --> 00:06:29,470
not really and in this case it wasn't at

170
00:06:29,470 --> 00:06:31,570
all initially there was a huge debate

171
00:06:31,570 --> 00:06:32,600
around this

172
00:06:32,600 --> 00:06:36,710
and then I in late 1994 you had the the

173
00:06:36,710 --> 00:06:38,540
revolutionary research come out from

174
00:06:38,540 --> 00:06:40,460
Matt blaze where he blew apart what the

175
00:06:40,460 --> 00:06:42,170
chipper clip was how easy it was to

176
00:06:42,170 --> 00:06:43,940
compromise how easy was to decrypt the

177
00:06:43,940 --> 00:06:47,450
data and oddly it never went anywhere

178
00:06:47,450 --> 00:06:49,760
you never really distributed it it was

179
00:06:49,760 --> 00:06:52,520
never actualized as a product but what

180
00:06:52,520 --> 00:06:54,320
this was is kind of the first example of

181
00:06:54,320 --> 00:06:56,900
a supply chain and manipulating the

182
00:06:56,900 --> 00:06:59,000
physical supply chain of devices now

183
00:06:59,000 --> 00:07:00,470
this is a little bit more difficult

184
00:07:00,470 --> 00:07:02,360
because this involves you being on the

185
00:07:02,360 --> 00:07:04,580
assembly line as the devices and the

186
00:07:04,580 --> 00:07:06,950
products are being manufactured

187
00:07:06,950 --> 00:07:09,380
let's talk about some hardware supply

188
00:07:09,380 --> 00:07:12,730
chain attacks today they don't exist

189
00:07:12,730 --> 00:07:15,590
they don't and there's lots of reasons

190
00:07:15,590 --> 00:07:18,680
for that if anybody does have examples

191
00:07:18,680 --> 00:07:21,380
of wide scale hardware supply chain

192
00:07:21,380 --> 00:07:22,880
attack I'd love to hear about them

193
00:07:22,880 --> 00:07:24,950
because I've never seen it there's lots

194
00:07:24,950 --> 00:07:26,600
of reasons for this you look at things

195
00:07:26,600 --> 00:07:28,460
like circuit boards right and then you

196
00:07:28,460 --> 00:07:29,960
start taking it even further and start

197
00:07:29,960 --> 00:07:31,550
looking at chips and then you start

198
00:07:31,550 --> 00:07:32,930
taking it even further and looking at

199
00:07:32,930 --> 00:07:35,240
traces and you realize that there are

200
00:07:35,240 --> 00:07:36,920
hundreds of people thousands of people

201
00:07:36,920 --> 00:07:39,830
that all their job is all day is to take

202
00:07:39,830 --> 00:07:42,140
chips and strip off layers and start

203
00:07:42,140 --> 00:07:43,670
looking at where all the wires go and

204
00:07:43,670 --> 00:07:46,280
they do this every single time so if you

205
00:07:46,280 --> 00:07:48,740
want to do a hardware attack it is going

206
00:07:48,740 --> 00:07:51,650
to be extremely difficult and extremely

207
00:07:51,650 --> 00:07:54,250
noisy because you can't just compromise

208
00:07:54,250 --> 00:07:57,110
one device on an assembly line you have

209
00:07:57,110 --> 00:07:59,120
to compromise all the devices on an

210
00:07:59,120 --> 00:08:01,640
assembly line this is why there are just

211
00:08:01,640 --> 00:08:04,700
so many more advantageous and easier

212
00:08:04,700 --> 00:08:06,950
ways to attack supply chain that will

213
00:08:06,950 --> 00:08:08,870
not result in you having to compromise

214
00:08:08,870 --> 00:08:11,950
tens or hundreds of thousands of people

215
00:08:11,950 --> 00:08:14,180
all right one last thing network supply

216
00:08:14,180 --> 00:08:16,970
chain this is a pretty common one as

217
00:08:16,970 --> 00:08:19,370
well I'm sure you all remember the

218
00:08:19,370 --> 00:08:21,950
target breach it's a big deal will huge

219
00:08:21,950 --> 00:08:24,650
credit card data breach started with one

220
00:08:24,650 --> 00:08:28,040
of these on a stage back system inside

221
00:08:28,040 --> 00:08:30,950
of their their enterprise and people

222
00:08:30,950 --> 00:08:33,320
like this who require access to those

223
00:08:33,320 --> 00:08:36,320
devices to manage them and they abused

224
00:08:36,320 --> 00:08:38,510
this advice or this access right that's

225
00:08:38,510 --> 00:08:40,039
how they were able to get in was by

226
00:08:40,039 --> 00:08:42,320
leveraging the access that you provided

227
00:08:42,320 --> 00:08:44,290
to your HVAC provider

228
00:08:44,290 --> 00:08:46,899
so generally the most important thing

229
00:08:46,899 --> 00:08:49,389
you need to understand is validating why

230
00:08:49,389 --> 00:08:52,779
you are giving people access why do you

231
00:08:52,779 --> 00:08:55,000
need access to this device what

232
00:08:55,000 --> 00:08:56,829
specifically do you need access to

233
00:08:56,829 --> 00:08:59,259
coming in and installing and allowing

234
00:08:59,259 --> 00:09:00,910
someone unfettered access into your

235
00:09:00,910 --> 00:09:02,470
environment because they need to manage

236
00:09:02,470 --> 00:09:05,040
an HVAC system is a horrible idea

237
00:09:05,040 --> 00:09:06,610
additionally and this is something

238
00:09:06,610 --> 00:09:08,339
that's becoming more and more important

239
00:09:08,339 --> 00:09:11,470
you really no longer can just can turn

240
00:09:11,470 --> 00:09:13,839
concern yourself about your own security

241
00:09:13,839 --> 00:09:16,029
posture right you have to start pushing

242
00:09:16,029 --> 00:09:18,250
your security posture onto your vendors

243
00:09:18,250 --> 00:09:20,050
how do you know what they're doing to

244
00:09:20,050 --> 00:09:21,639
secure their software how do you know

245
00:09:21,639 --> 00:09:23,050
that they actually have a reliable

246
00:09:23,050 --> 00:09:25,600
supply chain as a large organization

247
00:09:25,600 --> 00:09:27,610
these are the kinds of questions you're

248
00:09:27,610 --> 00:09:29,589
really gonna have to start asking those

249
00:09:29,589 --> 00:09:31,620
that you want to do business with and

250
00:09:31,620 --> 00:09:34,300
then another key thing of course is how

251
00:09:34,300 --> 00:09:36,160
do you monitor that connection right is

252
00:09:36,160 --> 00:09:38,230
it fully encrypted do you have a way to

253
00:09:38,230 --> 00:09:39,819
decrypt those communications are you

254
00:09:39,819 --> 00:09:41,649
gonna analyze what they're accessing and

255
00:09:41,649 --> 00:09:43,540
how they're accessing it and then more

256
00:09:43,540 --> 00:09:45,639
importantly what type of connection do

257
00:09:45,639 --> 00:09:47,470
they need do they need a site-to-site

258
00:09:47,470 --> 00:09:50,230
VPN can you provide them with VPN access

259
00:09:50,230 --> 00:09:53,350
do they want RDP access because please

260
00:09:53,350 --> 00:09:55,779
got no do not give them RDP access

261
00:09:55,779 --> 00:09:57,790
unless they have to go through a bunch

262
00:09:57,790 --> 00:09:59,529
of Hoops to get there because everybody

263
00:09:59,529 --> 00:10:01,480
knows RDP on the Internet is failsafe

264
00:10:01,480 --> 00:10:05,529
nothing bad ever happens there so what

265
00:10:05,529 --> 00:10:06,519
are the lessons that they learned about

266
00:10:06,519 --> 00:10:09,760
this multi-factor authentication is

267
00:10:09,760 --> 00:10:12,040
paramount to this if you have external

268
00:10:12,040 --> 00:10:14,500
partners you should require them all to

269
00:10:14,500 --> 00:10:16,389
use multi-factor authentication at least

270
00:10:16,389 --> 00:10:19,600
then you can try and prevent things like

271
00:10:19,600 --> 00:10:21,190
credential reuse or credential theft

272
00:10:21,190 --> 00:10:23,730
from really coming and inviting you

273
00:10:23,730 --> 00:10:28,240
please isolate IOT devices segmentation

274
00:10:28,240 --> 00:10:30,490
is the thing please make use of it

275
00:10:30,490 --> 00:10:32,769
it will save you I know it's a pain to

276
00:10:32,769 --> 00:10:35,430
implement I know it can be costly but in

277
00:10:35,430 --> 00:10:38,290
horrible times it can save you an awful

278
00:10:38,290 --> 00:10:41,620
lot I mean nobody really thinks auditing

279
00:10:41,620 --> 00:10:44,019
is sexy in security but man is it

280
00:10:44,019 --> 00:10:46,120
important you have got to audit the

281
00:10:46,120 --> 00:10:47,589
people that have access to this stuff

282
00:10:47,589 --> 00:10:49,209
you have some provider that you

283
00:10:49,209 --> 00:10:51,610
provision to access to four years ago it

284
00:10:51,610 --> 00:10:53,079
still has credentials that isn't even a

285
00:10:53,079 --> 00:10:55,570
provider anymore because nobody looked

286
00:10:55,570 --> 00:10:58,600
who had access and why and again key

287
00:10:58,600 --> 00:11:00,820
things segment your network

288
00:11:00,820 --> 00:11:03,700
do not allow RDP from the Internet I

289
00:11:03,700 --> 00:11:05,590
mean this is just good advice for anyone

290
00:11:05,590 --> 00:11:08,640
do not allow RDP from the Internet

291
00:11:08,640 --> 00:11:10,960
ok so I'm gonna hand it over to Edmund

292
00:11:10,960 --> 00:11:13,090
now to really go deep on what we're

293
00:11:13,090 --> 00:11:14,920
really seeing more and more of which is

294
00:11:14,920 --> 00:11:18,970
the software supply chain excellent yeah

295
00:11:18,970 --> 00:11:21,820
so um as we all know adversaries will

296
00:11:21,820 --> 00:11:23,860
typically try to work towards mission

297
00:11:23,860 --> 00:11:25,540
objectives right no they're typically

298
00:11:25,540 --> 00:11:27,550
going to attempt to achieve those

299
00:11:27,550 --> 00:11:29,230
mission objectives as cheaply as quickly

300
00:11:29,230 --> 00:11:31,030
and as easily as possible

301
00:11:31,030 --> 00:11:33,100
so what a lot of attackers have

302
00:11:33,100 --> 00:11:35,650
recognized is that as their targets have

303
00:11:35,650 --> 00:11:37,270
gotten more mature from a security

304
00:11:37,270 --> 00:11:39,850
capability standpoint it's often quicker

305
00:11:39,850 --> 00:11:41,860
cheaper and easier to target a third

306
00:11:41,860 --> 00:11:43,300
party that they know the company

307
00:11:43,300 --> 00:11:45,370
leverages and leverage that access to

308
00:11:45,370 --> 00:11:46,720
gain an initial foothold within an

309
00:11:46,720 --> 00:11:49,390
organizational environment right in a

310
00:11:49,390 --> 00:11:50,950
lot of cases the soft target isn't

311
00:11:50,950 --> 00:11:53,350
necessarily you know hitting up against

312
00:11:53,350 --> 00:11:54,910
the firewall of the company itself it's

313
00:11:54,910 --> 00:11:56,740
targeting the supplier software or

314
00:11:56,740 --> 00:11:58,570
services or things of that nature and

315
00:11:58,570 --> 00:12:00,040
then leveraging the access to that

316
00:12:00,040 --> 00:12:02,050
environment to hop through to the the

317
00:12:02,050 --> 00:12:03,280
actual organization that they're

318
00:12:03,280 --> 00:12:04,570
targeting and that's what we're really

319
00:12:04,570 --> 00:12:08,080
seeing from from adversaries on in I'm

320
00:12:08,080 --> 00:12:09,760
gonna walk through a few examples of

321
00:12:09,760 --> 00:12:11,170
some of the types of attacks that we've

322
00:12:11,170 --> 00:12:13,030
seen that have had wide-ranging impacts

323
00:12:13,030 --> 00:12:14,500
on you know large numbers of

324
00:12:14,500 --> 00:12:17,440
organizations around the world this is

325
00:12:17,440 --> 00:12:18,820
what a software supply chain attack

326
00:12:18,820 --> 00:12:21,970
actually typically looks like so in a

327
00:12:21,970 --> 00:12:23,650
lot of cases what you'll see is the the

328
00:12:23,650 --> 00:12:26,650
attackers will compromise the the vendor

329
00:12:26,650 --> 00:12:28,600
or the manufacturer of a specific piece

330
00:12:28,600 --> 00:12:30,400
of software that they know is being used

331
00:12:30,400 --> 00:12:31,630
by the target that they're actually

332
00:12:31,630 --> 00:12:33,460
going after and they'll compromise their

333
00:12:33,460 --> 00:12:35,020
development environment and use that

334
00:12:35,020 --> 00:12:37,870
access to insert malicious code

335
00:12:37,870 --> 00:12:39,790
typically you know backdoor code into

336
00:12:39,790 --> 00:12:42,520
the software development environment for

337
00:12:42,520 --> 00:12:44,560
that company so when they take the code

338
00:12:44,560 --> 00:12:46,420
compile it and then ship it to customers

339
00:12:46,420 --> 00:12:48,220
it's already bent back toward a lot of

340
00:12:48,220 --> 00:12:49,750
cases it may be signed using legitimate

341
00:12:49,750 --> 00:12:51,520
code signing certificates right because

342
00:12:51,520 --> 00:12:52,960
they've compromised the actual source

343
00:12:52,960 --> 00:12:55,120
code itself so then that will typically

344
00:12:55,120 --> 00:12:57,850
be distributed to whoever is using the

345
00:12:57,850 --> 00:12:59,410
software from the legitimate and

346
00:12:59,410 --> 00:13:01,720
software manufacturer nobody realizing

347
00:13:01,720 --> 00:13:03,190
that you know it's been backed or you

348
00:13:03,190 --> 00:13:04,630
can check hashes you can compare the

349
00:13:04,630 --> 00:13:06,019
hash of the downloaded file

350
00:13:06,019 --> 00:13:07,879
- the one you receive from the software

351
00:13:07,879 --> 00:13:08,989
vendor they're going to match because

352
00:13:08,989 --> 00:13:09,980
you're getting it from the legitimate

353
00:13:09,980 --> 00:13:11,089
source

354
00:13:11,089 --> 00:13:13,309
they've just been compromised so once

355
00:13:13,309 --> 00:13:15,189
that's been distributed into the actual

356
00:13:15,189 --> 00:13:16,790
organizations that are being targeted

357
00:13:16,790 --> 00:13:18,860
the attackers can then leverage that to

358
00:13:18,860 --> 00:13:20,059
initiate you know command and control

359
00:13:20,059 --> 00:13:22,639
protocols bot registration with command

360
00:13:22,639 --> 00:13:24,290
control servers and then leverage that

361
00:13:24,290 --> 00:13:25,790
to begin to operate within the

362
00:13:25,790 --> 00:13:27,170
environment they're actually all along

363
00:13:27,170 --> 00:13:29,269
trying to target they're simply you know

364
00:13:29,269 --> 00:13:30,980
going after the soft target and in this

365
00:13:30,980 --> 00:13:34,730
case you know the supply chain so one of

366
00:13:34,730 --> 00:13:36,589
the most destructive cyber attacks in

367
00:13:36,589 --> 00:13:38,360
history is not pet yet right I'm sure

368
00:13:38,360 --> 00:13:39,769
everyone in the room is pretty familiar

369
00:13:39,769 --> 00:13:42,739
with this one it was very very disrupted

370
00:13:42,739 --> 00:13:44,029
to a lot of organizations around the

371
00:13:44,029 --> 00:13:46,579
world accosted a lot of companies you

372
00:13:46,579 --> 00:13:48,769
know a ton of money due to operational

373
00:13:48,769 --> 00:13:52,069
disruption and associated impacts on

374
00:13:52,069 --> 00:13:53,629
this was an example of a supply chain

375
00:13:53,629 --> 00:13:56,029
attack in in action so the way that this

376
00:13:56,029 --> 00:13:59,179
worked was the adversaries behind not

377
00:13:59,179 --> 00:14:01,819
petia compromised a software development

378
00:14:01,819 --> 00:14:04,309
company called emmy dr. so mu dhaka

379
00:14:04,309 --> 00:14:05,989
they make tax accounting software that's

380
00:14:05,989 --> 00:14:08,149
heavily used in the country of Ukraine

381
00:14:08,149 --> 00:14:10,939
so if you do business in Ukraine or if

382
00:14:10,939 --> 00:14:12,709
you're located in Ukraine odds are you

383
00:14:12,709 --> 00:14:14,149
have a system in your environment that

384
00:14:14,149 --> 00:14:16,790
has a me dock software installed for for

385
00:14:16,790 --> 00:14:18,799
accounting purposes um so what they did

386
00:14:18,799 --> 00:14:20,420
was actually compromised the software

387
00:14:20,420 --> 00:14:22,249
update servers associated with the ami

388
00:14:22,249 --> 00:14:25,309
dock application so for victims when you

389
00:14:25,309 --> 00:14:26,629
open the software and go check for

390
00:14:26,629 --> 00:14:28,549
updates it goes out to any dock servers

391
00:14:28,549 --> 00:14:30,470
and pulls down the latest version well

392
00:14:30,470 --> 00:14:31,549
in this case they had inserted

393
00:14:31,549 --> 00:14:33,920
backdoored copies of software updates to

394
00:14:33,920 --> 00:14:35,509
those distribution servers so the next

395
00:14:35,509 --> 00:14:38,029
time potential victims went out reached

396
00:14:38,029 --> 00:14:40,069
out to update a me doc they actually got

397
00:14:40,069 --> 00:14:41,779
that back the word code into the

398
00:14:41,779 --> 00:14:43,819
environment and so the attackers

399
00:14:43,819 --> 00:14:45,439
actually leverage this sort of access to

400
00:14:45,439 --> 00:14:47,029
those distribution servers for a period

401
00:14:47,029 --> 00:14:49,999
of time to distribute this backdoor and

402
00:14:49,999 --> 00:14:51,019
gain access to all of these

403
00:14:51,019 --> 00:14:53,269
organizations that had any dock software

404
00:14:53,269 --> 00:14:55,309
installed in their environments so when

405
00:14:55,309 --> 00:14:58,220
the attacker chose to activate non petia

406
00:14:58,220 --> 00:14:59,480
they were able to leverage that access

407
00:14:59,480 --> 00:15:01,189
to push this malware to all of those

408
00:15:01,189 --> 00:15:03,799
environments as we're probably all aware

409
00:15:03,799 --> 00:15:06,019
this was a destructive self-propagating

410
00:15:06,019 --> 00:15:08,269
a piece of malware that was designed to

411
00:15:08,269 --> 00:15:10,610
cause operational impacts so the

412
00:15:10,610 --> 00:15:12,319
backdoor itself that was planted in

413
00:15:12,319 --> 00:15:13,939
those software updates functioned pretty

414
00:15:13,939 --> 00:15:15,379
similar to what you would expect from a

415
00:15:15,379 --> 00:15:17,149
backdoor I'm not going to go through all

416
00:15:17,149 --> 00:15:17,960
of the specific

417
00:15:17,960 --> 00:15:19,430
that were available to it but they're

418
00:15:19,430 --> 00:15:21,020
pretty common when you're looking at

419
00:15:21,020 --> 00:15:22,310
backdoors and the functionality that

420
00:15:22,310 --> 00:15:25,240
they typically provide for adversaries

421
00:15:25,240 --> 00:15:28,310
so this is the the payload this is the

422
00:15:28,310 --> 00:15:31,310
ransom note that was associated with not

423
00:15:31,310 --> 00:15:32,720
petty looks pretty similar to what you

424
00:15:32,720 --> 00:15:34,720
see from Master Boot Record based on our

425
00:15:34,720 --> 00:15:36,890
although there's a lot of examples of

426
00:15:36,890 --> 00:15:39,710
those out there this is what the the

427
00:15:39,710 --> 00:15:41,660
actual ransom screen that was displayed

428
00:15:41,660 --> 00:15:43,610
once the malware was activated in was

429
00:15:43,610 --> 00:15:45,080
finished with the destructive activities

430
00:15:45,080 --> 00:15:46,340
that it was performing on infected

431
00:15:46,340 --> 00:15:47,870
systems once it was finished attempting

432
00:15:47,870 --> 00:15:49,520
to propagate to other systems you can

433
00:15:49,520 --> 00:15:50,750
see how this sort of malware creates

434
00:15:50,750 --> 00:15:52,100
kind of a snowball effect you start out

435
00:15:52,100 --> 00:15:53,810
with a patient zero in the environment

436
00:15:53,810 --> 00:15:55,940
you know that system gets effectively

437
00:15:55,940 --> 00:15:58,790
you know just destroyed and then the the

438
00:15:58,790 --> 00:16:00,230
malware attempts to propagate throughout

439
00:16:00,230 --> 00:16:02,150
the network more systems become infected

440
00:16:02,150 --> 00:16:03,860
that propagation continues and before

441
00:16:03,860 --> 00:16:05,750
long you go from one destroyed system to

442
00:16:05,750 --> 00:16:08,410
a significant percentage of your overall

443
00:16:08,410 --> 00:16:11,810
network architecture so in this

444
00:16:11,810 --> 00:16:13,130
particular example the the malware

445
00:16:13,130 --> 00:16:15,710
actually had several capabilities that

446
00:16:15,710 --> 00:16:17,660
it could leverage for propagation to

447
00:16:17,660 --> 00:16:19,820
other hosts within the environment to

448
00:16:19,820 --> 00:16:21,800
facilitate that destructive capability

449
00:16:21,800 --> 00:16:23,000
that I was talking about they could use

450
00:16:23,000 --> 00:16:25,910
WMI they could use PS exec they actually

451
00:16:25,910 --> 00:16:27,470
could leverage eternal blue and eternal

452
00:16:27,470 --> 00:16:29,060
romance as well so they would scan the

453
00:16:29,060 --> 00:16:31,310
subnet of the infected system look for

454
00:16:31,310 --> 00:16:33,560
potential candidates for propagation and

455
00:16:33,560 --> 00:16:35,210
if found they would propagate to those

456
00:16:35,210 --> 00:16:37,040
systems the destructive capabilities

457
00:16:37,040 --> 00:16:38,420
would start and they would destroy

458
00:16:38,420 --> 00:16:41,660
systems so there was when we started

459
00:16:41,660 --> 00:16:42,470
looking at this there was some

460
00:16:42,470 --> 00:16:44,120
interesting elements right you've got a

461
00:16:44,120 --> 00:16:45,890
ransom note there's a Bitcoin wallet

462
00:16:45,890 --> 00:16:47,450
address there they're basically saying

463
00:16:47,450 --> 00:16:49,010
you know pay us Bitcoin and we'll give

464
00:16:49,010 --> 00:16:50,600
you your system back but there was

465
00:16:50,600 --> 00:16:52,730
several interesting characteristics that

466
00:16:52,730 --> 00:16:54,590
you know lead us to believe that this

467
00:16:54,590 --> 00:16:57,230
wasn't designed for financial gain this

468
00:16:57,230 --> 00:17:00,170
was in financially motivated and that

469
00:17:00,170 --> 00:17:01,270
was because there were several

470
00:17:01,270 --> 00:17:03,560
destructive operations that would take

471
00:17:03,560 --> 00:17:05,030
place that literally could not be

472
00:17:05,030 --> 00:17:06,650
reversed by the adversary even if you

473
00:17:06,650 --> 00:17:08,959
did pay likewise the the way that they

474
00:17:08,959 --> 00:17:10,609
were managing the ransom payouts they

475
00:17:10,609 --> 00:17:12,740
just had a single email address no

476
00:17:12,740 --> 00:17:14,540
unique identifiers to manage you know

477
00:17:14,540 --> 00:17:16,490
who's actually paid the ransom to know

478
00:17:16,490 --> 00:17:18,230
who to give any potential keys or

479
00:17:18,230 --> 00:17:25,099
recoverability capability soup second

480
00:17:25,099 --> 00:17:27,709
one so when you talk about like the

481
00:17:27,709 --> 00:17:29,240
types of companies that are typically

482
00:17:29,240 --> 00:17:30,740
targeted in these sort of software

483
00:17:30,740 --> 00:17:31,430
supply chain

484
00:17:31,430 --> 00:17:33,740
attacks on you know you're not typically

485
00:17:33,740 --> 00:17:35,270
gonna see companies like like the ones

486
00:17:35,270 --> 00:17:37,130
on the slide targeted because it's it's

487
00:17:37,130 --> 00:17:38,570
extremely difficult these are companies

488
00:17:38,570 --> 00:17:40,250
that have very very good security

489
00:17:40,250 --> 00:17:42,620
postures you're gonna you're gonna see

490
00:17:42,620 --> 00:17:44,390
organizations that provide niche

491
00:17:44,390 --> 00:17:47,180
software or niche services in a lot of

492
00:17:47,180 --> 00:17:48,470
cases these might be related to the

493
00:17:48,470 --> 00:17:50,240
medical field or the tech field or the

494
00:17:50,240 --> 00:17:52,730
banking industry or aviation in a lot of

495
00:17:52,730 --> 00:17:54,380
these industries they use extremely

496
00:17:54,380 --> 00:17:56,630
small companies that provide very very

497
00:17:56,630 --> 00:17:58,400
niche software products are very very

498
00:17:58,400 --> 00:18:01,700
niche services and as a result you know

499
00:18:01,700 --> 00:18:03,860
that they don't typically have the same

500
00:18:03,860 --> 00:18:05,450
level of security posture right when

501
00:18:05,450 --> 00:18:06,560
you're talking about you know three

502
00:18:06,560 --> 00:18:08,270
developers in a garage developing a

503
00:18:08,270 --> 00:18:09,560
software application that's used in

504
00:18:09,560 --> 00:18:11,720
mission-critical applications you know

505
00:18:11,720 --> 00:18:12,920
they're not necessarily gonna have the

506
00:18:12,920 --> 00:18:14,390
same emphasis on securing their

507
00:18:14,390 --> 00:18:15,920
environment on securing their software

508
00:18:15,920 --> 00:18:17,600
development lifecycle on securing their

509
00:18:17,600 --> 00:18:19,460
network architecture as you would with

510
00:18:19,460 --> 00:18:21,110
you know larger more mature and more

511
00:18:21,110 --> 00:18:22,850
established companies and that's really

512
00:18:22,850 --> 00:18:25,910
where the adversaries are focusing so

513
00:18:25,910 --> 00:18:27,710
another example of this in action was

514
00:18:27,710 --> 00:18:30,400
with ccleaner which was a pretty big

515
00:18:30,400 --> 00:18:32,570
supply chain attack that had

516
00:18:32,570 --> 00:18:35,060
wide-ranging impacts as well so if

517
00:18:35,060 --> 00:18:36,230
you're not familiar with ccleaner

518
00:18:36,230 --> 00:18:38,360
it was an application that was initially

519
00:18:38,360 --> 00:18:40,490
created by a company called pure form

520
00:18:40,490 --> 00:18:43,910
that was subsequently purchased by avast

521
00:18:43,910 --> 00:18:46,250
CCleaner is effectively an application

522
00:18:46,250 --> 00:18:47,330
that you can use to kind of like

523
00:18:47,330 --> 00:18:49,360
centrally perform a bunch of

524
00:18:49,360 --> 00:18:51,290
administrative and management tasks on

525
00:18:51,290 --> 00:18:52,460
Windows endpoints you can manage

526
00:18:52,460 --> 00:18:55,610
installed software install updates you

527
00:18:55,610 --> 00:18:57,380
know clear caches and whatnot it

528
00:18:57,380 --> 00:18:58,790
provides kind of a single pane of glass

529
00:18:58,790 --> 00:19:00,770
to perform all of those you're not going

530
00:19:00,770 --> 00:19:03,110
across a lot of different control panel

531
00:19:03,110 --> 00:19:05,750
applications so this is a pretty widely

532
00:19:05,750 --> 00:19:07,640
used application this is from the

533
00:19:07,640 --> 00:19:09,890
ccleaner website just some statistics on

534
00:19:09,890 --> 00:19:11,630
the actual install base associated with

535
00:19:11,630 --> 00:19:13,940
ccleaner you can see over two hundred or

536
00:19:13,940 --> 00:19:16,760
over two billion CCleaner downloads

537
00:19:16,760 --> 00:19:18,890
worldwide that's a pretty large number

538
00:19:18,890 --> 00:19:22,940
of users that were impacted by this so

539
00:19:22,940 --> 00:19:24,650
it was interesting because when we were

540
00:19:24,650 --> 00:19:26,120
taking a look at this we initially found

541
00:19:26,120 --> 00:19:27,830
this because of some of the heuristic

542
00:19:27,830 --> 00:19:29,450
detection that's that's built into our

543
00:19:29,450 --> 00:19:32,600
endpoint security program and we started

544
00:19:32,600 --> 00:19:34,280
looking at it we noticed that you know

545
00:19:34,280 --> 00:19:35,660
it was being retrieved from the

546
00:19:35,660 --> 00:19:37,370
legitimate software download site for

547
00:19:37,370 --> 00:19:39,650
ccleaner it was actually signed by the

548
00:19:39,650 --> 00:19:41,930
company that's associated with the

549
00:19:41,930 --> 00:19:42,970
development of this

550
00:19:42,970 --> 00:19:45,010
we're um and in what we were able to

551
00:19:45,010 --> 00:19:47,320
identify was that the attackers had

552
00:19:47,320 --> 00:19:49,419
actually targeted pure forms software

553
00:19:49,419 --> 00:19:50,770
development environment like I was

554
00:19:50,770 --> 00:19:52,539
describing earlier and leveraged that

555
00:19:52,539 --> 00:19:55,690
access to backdoor a specific version of

556
00:19:55,690 --> 00:19:57,640
ccleaner that was in subsequently

557
00:19:57,640 --> 00:20:00,400
compiled by the legitimate a application

558
00:20:00,400 --> 00:20:02,380
vendor and made available on their

559
00:20:02,380 --> 00:20:03,880
legitimate software download site so

560
00:20:03,880 --> 00:20:05,650
you'd go out you'd grab this you could

561
00:20:05,650 --> 00:20:07,809
clone once again compare hashes make

562
00:20:07,809 --> 00:20:08,980
sure you're getting it from the right

563
00:20:08,980 --> 00:20:10,870
location but at the end of the day you

564
00:20:10,870 --> 00:20:12,340
were installing a back to her copy of

565
00:20:12,340 --> 00:20:15,159
ccleaner so this was a pretty

566
00:20:15,159 --> 00:20:17,020
interesting fact were on it featured a

567
00:20:17,020 --> 00:20:21,490
kind of a multi-stage c2 connectivity

568
00:20:21,490 --> 00:20:24,039
mechanism where the Malheur would

569
00:20:24,039 --> 00:20:26,679
connect out to a specific IP address and

570
00:20:26,679 --> 00:20:28,000
as a fail back if it was unable to

571
00:20:28,000 --> 00:20:29,799
connect to that IP it would use a domain

572
00:20:29,799 --> 00:20:31,240
generation algorithm so it would

573
00:20:31,240 --> 00:20:33,429
dynamically generate a list of domains

574
00:20:33,429 --> 00:20:35,799
to connect to it would perform a dns

575
00:20:35,799 --> 00:20:38,860
request to the active DGA domain at the

576
00:20:38,860 --> 00:20:40,539
time for whenever the malware was

577
00:20:40,539 --> 00:20:42,789
operating and then whatever was returned

578
00:20:42,789 --> 00:20:45,940
by the the DNS response from the DNS

579
00:20:45,940 --> 00:20:47,710
server for that domain they would

580
00:20:47,710 --> 00:20:50,110
basically take the IPS perform an

581
00:20:50,110 --> 00:20:52,179
operation on them and then leverage the

582
00:20:52,179 --> 00:20:53,980
results of that operation to define

583
00:20:53,980 --> 00:20:55,659
where they would actually go for command

584
00:20:55,659 --> 00:20:57,030
and control so as a pretty sophisticated

585
00:20:57,030 --> 00:21:00,580
mechanism provided fail back for for the

586
00:21:00,580 --> 00:21:02,620
the adversary in cases that the the

587
00:21:02,620 --> 00:21:03,610
primary command and control

588
00:21:03,610 --> 00:21:05,289
infrastructure was taken down or

589
00:21:05,289 --> 00:21:07,750
suspended or was unable to be

590
00:21:07,750 --> 00:21:09,700
operational so we reversed engineered

591
00:21:09,700 --> 00:21:11,530
the Evette DGA and we were able to

592
00:21:11,530 --> 00:21:13,659
generate a list of all of the domains

593
00:21:13,659 --> 00:21:15,220
that would be leveraged by the malware

594
00:21:15,220 --> 00:21:18,549
for the next 12 months what the the

595
00:21:18,549 --> 00:21:20,620
malware's DGA domain was was set up to

596
00:21:20,620 --> 00:21:22,600
do was it would rotate once a month to a

597
00:21:22,600 --> 00:21:25,090
new domain based on you know the the DG

598
00:21:25,090 --> 00:21:28,510
output or the DGA result and so we

599
00:21:28,510 --> 00:21:29,890
actually sinkhole of all of those

600
00:21:29,890 --> 00:21:31,059
domains because they hadn't actually

601
00:21:31,059 --> 00:21:33,370
been registered by the adversary yet and

602
00:21:33,370 --> 00:21:35,470
when the primary command and control

603
00:21:35,470 --> 00:21:37,390
server was taken down when we were doing

604
00:21:37,390 --> 00:21:39,490
this research we were able to monitor

605
00:21:39,490 --> 00:21:41,770
all of the activity the DNS activity

606
00:21:41,770 --> 00:21:43,150
associated with the command and control

607
00:21:43,150 --> 00:21:45,250
infrastructure on that we had sync hold

608
00:21:45,250 --> 00:21:47,260
and you can see how it starts it at one

609
00:21:47,260 --> 00:21:48,970
domain and then when it hits the next

610
00:21:48,970 --> 00:21:51,039
month it switches over to the to the

611
00:21:51,039 --> 00:21:52,990
next domain in the list but since we had

612
00:21:52,990 --> 00:21:53,760
sync hold all

613
00:21:53,760 --> 00:21:55,560
those domains proactively on the

614
00:21:55,560 --> 00:21:57,270
adversary wasn't able to regain control

615
00:21:57,270 --> 00:21:59,370
of the all of the systems that they had

616
00:21:59,370 --> 00:22:02,940
backward so the the back door was a

617
00:22:02,940 --> 00:22:04,950
stage one of what was ultimately a

618
00:22:04,950 --> 00:22:07,170
multi-stage infection process the back

619
00:22:07,170 --> 00:22:08,730
door basically gave them capabilities

620
00:22:08,730 --> 00:22:10,460
bare minimum set of capabilities

621
00:22:10,460 --> 00:22:12,150
possible to operate in the environment

622
00:22:12,150 --> 00:22:14,820
so that if they chose to operate further

623
00:22:14,820 --> 00:22:16,560
or if this was a target that they were

624
00:22:16,560 --> 00:22:17,910
interested in they could deploy

625
00:22:17,910 --> 00:22:20,250
additional stages of malware and begin

626
00:22:20,250 --> 00:22:21,240
to operate towards some of those

627
00:22:21,240 --> 00:22:23,100
longer-term objectives so one of the

628
00:22:23,100 --> 00:22:24,150
things that would do is it would grab a

629
00:22:24,150 --> 00:22:25,920
list of all of the installed programs

630
00:22:25,920 --> 00:22:27,510
the running processes a ton of

631
00:22:27,510 --> 00:22:29,490
information about the the system that

632
00:22:29,490 --> 00:22:30,900
was infected when it would be canal to

633
00:22:30,900 --> 00:22:32,040
commanding control it would just send

634
00:22:32,040 --> 00:22:33,690
all of this information out it's pretty

635
00:22:33,690 --> 00:22:35,310
much all the info an adversary would

636
00:22:35,310 --> 00:22:37,350
need to stand up a lab environment that

637
00:22:37,350 --> 00:22:39,750
completely mirrors the endpoints in an

638
00:22:39,750 --> 00:22:41,010
environment they might be interested in

639
00:22:41,010 --> 00:22:42,780
targeting and then testing payloads

640
00:22:42,780 --> 00:22:45,390
against so make sure that you know they

641
00:22:45,390 --> 00:22:47,640
could remain undetected so we were able

642
00:22:47,640 --> 00:22:49,650
to gain access to the command and

643
00:22:49,650 --> 00:22:51,780
control server database that was

644
00:22:51,780 --> 00:22:54,420
associated with this this first stage of

645
00:22:54,420 --> 00:22:55,920
that malware infection and what we found

646
00:22:55,920 --> 00:22:59,040
was a PHP application with a database

647
00:22:59,040 --> 00:23:00,870
back-end that was being used to track

648
00:23:00,870 --> 00:23:02,820
all of the bots that were basically

649
00:23:02,820 --> 00:23:05,130
beaconing out to command control all of

650
00:23:05,130 --> 00:23:06,930
the infected systems that were operating

651
00:23:06,930 --> 00:23:08,520
with this backdoor and what they had

652
00:23:08,520 --> 00:23:10,260
done was they had defined an array list

653
00:23:10,260 --> 00:23:14,100
of domains on the c2 server and the

654
00:23:14,100 --> 00:23:16,740
logic of the the server-side application

655
00:23:16,740 --> 00:23:18,870
was such that if a system beaconing

656
00:23:18,870 --> 00:23:20,790
to command and control with stage ones

657
00:23:20,790 --> 00:23:23,370
backdoor was originating from or was

658
00:23:23,370 --> 00:23:24,900
part of any of the domains in this list

659
00:23:24,900 --> 00:23:27,090
they would choose to serve a stage two

660
00:23:27,090 --> 00:23:28,860
payload so this was the list of

661
00:23:28,860 --> 00:23:30,450
companies that this particular adversary

662
00:23:30,450 --> 00:23:32,010
was interested in operating against it

663
00:23:32,010 --> 00:23:33,330
was a pretty interesting way to do that

664
00:23:33,330 --> 00:23:35,100
because at any given time based on

665
00:23:35,100 --> 00:23:38,040
changes in tasking let's say they were

666
00:23:38,040 --> 00:23:39,870
interested in high tech companies you

667
00:23:39,870 --> 00:23:42,360
know this month but wanted to operate

668
00:23:42,360 --> 00:23:44,430
against a different industry or a

669
00:23:44,430 --> 00:23:46,970
specific geographic region or you know

670
00:23:46,970 --> 00:23:48,900
strategic targets that could simply

671
00:23:48,900 --> 00:23:50,940
change this list and in the very next

672
00:23:50,940 --> 00:23:52,290
time the systems were beacon in they

673
00:23:52,290 --> 00:23:53,940
could drop additional now our payloads

674
00:23:53,940 --> 00:23:55,410
and begin to operate towards those

675
00:23:55,410 --> 00:23:56,970
mission objectives you'll notice that

676
00:23:56,970 --> 00:23:58,740
Cisco comm is actually in this list of

677
00:23:58,740 --> 00:24:01,590
domains but since we were able to you

678
00:24:01,590 --> 00:24:03,380
know look at the the backend database

679
00:24:03,380 --> 00:24:05,520
all of the information about all of the

680
00:24:05,520 --> 00:24:06,740
systems that had been

681
00:24:06,740 --> 00:24:08,510
- see - we were able to determine that

682
00:24:08,510 --> 00:24:09,890
none of our systems had actually been

683
00:24:09,890 --> 00:24:11,899
impacted by this but this is a list of a

684
00:24:11,899 --> 00:24:14,330
lot of a lot of high-tech companies and

685
00:24:14,330 --> 00:24:16,490
a pretty interesting way to create a

686
00:24:16,490 --> 00:24:19,549
dragnet a very large botnet that you

687
00:24:19,549 --> 00:24:21,919
could use to immediately begin operating

688
00:24:21,919 --> 00:24:23,779
further against strategic targets on an

689
00:24:23,779 --> 00:24:27,230
ongoing basis so we did a little bit of

690
00:24:27,230 --> 00:24:30,260
analysis of some of the code functions

691
00:24:30,260 --> 00:24:32,299
that were available to ccleaner and we

692
00:24:32,299 --> 00:24:33,980
actually did some comparisons against

693
00:24:33,980 --> 00:24:36,169
other known malware families that have

694
00:24:36,169 --> 00:24:38,059
been operational across the threat

695
00:24:38,059 --> 00:24:39,830
landscape and we found very very

696
00:24:39,830 --> 00:24:41,270
interesting similarities to some

697
00:24:41,270 --> 00:24:44,600
existing apt related malware families

698
00:24:44,600 --> 00:24:47,210
that have been seen in the wild so this

699
00:24:47,210 --> 00:24:49,669
was associated with group 72 if you're

700
00:24:49,669 --> 00:24:51,380
not familiar with group 72 it's an apt

701
00:24:51,380 --> 00:24:54,020
group you can go online there's a lot of

702
00:24:54,020 --> 00:24:55,880
research that's been done it goes by

703
00:24:55,880 --> 00:24:57,169
various code names so you can see a

704
00:24:57,169 --> 00:24:58,789
couple examples on the on the slide

705
00:24:58,789 --> 00:24:59,990
there but so a pretty interesting

706
00:24:59,990 --> 00:25:02,090
example of a software supply chain

707
00:25:02,090 --> 00:25:03,919
attack and just how dangerous this sort

708
00:25:03,919 --> 00:25:05,929
of approach can be in organizations

709
00:25:05,929 --> 00:25:07,309
where they're doing everything right in

710
00:25:07,309 --> 00:25:09,350
the retrieval of you know software

711
00:25:09,350 --> 00:25:10,100
they're getting it from the right

712
00:25:10,100 --> 00:25:11,539
location they're checking hashes they're

713
00:25:11,539 --> 00:25:13,669
making sure the code signed it still

714
00:25:13,669 --> 00:25:17,240
creates a problem because by targeting

715
00:25:17,240 --> 00:25:18,830
you know softer targets you're able to

716
00:25:18,830 --> 00:25:20,659
you know subvert a lot of the security

717
00:25:20,659 --> 00:25:22,250
controls that organizations may have in

718
00:25:22,250 --> 00:25:26,919
place all right now I'm gonna talk about

719
00:25:26,919 --> 00:25:29,990
what was the obvious eventualities which

720
00:25:29,990 --> 00:25:31,970
is when criminals realized hey there's a

721
00:25:31,970 --> 00:25:33,140
whole bunch of money to make if I attack

722
00:25:33,140 --> 00:25:35,120
the supply chain and that's exactly what

723
00:25:35,120 --> 00:25:37,549
we've seen this is actually a really

724
00:25:37,549 --> 00:25:39,140
interesting one that I'll start with so

725
00:25:39,140 --> 00:25:42,710
this was disclosed as a zero-day at the

726
00:25:42,710 --> 00:25:45,320
app sac village of DEFCON this most

727
00:25:45,320 --> 00:25:47,000
recent DEFCON so like a couple months

728
00:25:47,000 --> 00:25:50,600
ago that was in WEP min was the product

729
00:25:50,600 --> 00:25:53,620
that it was a zero-day turns out wasn't

730
00:25:53,620 --> 00:25:56,029
necessarily a zero-day they were

731
00:25:56,029 --> 00:25:57,440
actually hit with the supply chain

732
00:25:57,440 --> 00:25:59,179
attack so what happened was is they

733
00:25:59,179 --> 00:26:00,590
compromised one of the development

734
00:26:00,590 --> 00:26:03,289
servers they modified a script and then

735
00:26:03,289 --> 00:26:05,210
time stomped it to make sure that it

736
00:26:05,210 --> 00:26:07,250
didn't look like it was modified they

737
00:26:07,250 --> 00:26:09,110
found out that the server was modified

738
00:26:09,110 --> 00:26:11,390
reverted a bunch of stuff but since they

739
00:26:11,390 --> 00:26:13,190
didn't know that that file was modified

740
00:26:13,190 --> 00:26:15,260
it ended up continuing through the

741
00:26:15,260 --> 00:26:17,659
process and made its way into a much

742
00:26:17,659 --> 00:26:19,059
later version of the code

743
00:26:19,059 --> 00:26:20,919
and that was actually what the adversary

744
00:26:20,919 --> 00:26:22,419
was taking advantage of it wasn't that

745
00:26:22,419 --> 00:26:24,159
they had a zero-day in the code it was

746
00:26:24,159 --> 00:26:26,889
that someone added code which in effect

747
00:26:26,889 --> 00:26:29,259
is a zero day but this is just one

748
00:26:29,259 --> 00:26:30,909
example of what we're seeing we've seen

749
00:26:30,909 --> 00:26:33,039
examples like pH compare where you have

750
00:26:33,039 --> 00:26:35,379
this hard-coded IP address that it was

751
00:26:35,379 --> 00:26:39,669
beaconing out to web extensions so this

752
00:26:39,669 --> 00:26:43,690
is a gigantic target just gigantic if

753
00:26:43,690 --> 00:26:45,970
you think about average users and their

754
00:26:45,970 --> 00:26:48,519
browsers and what extensions have access

755
00:26:48,519 --> 00:26:51,519
to by starting to attack web extensions

756
00:26:51,519 --> 00:26:54,190
you can immediately hit a huge amount of

757
00:26:54,190 --> 00:26:56,559
systems very very quickly and do simple

758
00:26:56,559 --> 00:26:58,809
things like click-fraud with very little

759
00:26:58,809 --> 00:27:01,929
difficulty and then what we've seen most

760
00:27:01,929 --> 00:27:03,820
recently as just the dam is broken it's

761
00:27:03,820 --> 00:27:06,039
it's like every week we're hearing about

762
00:27:06,039 --> 00:27:08,590
a different supply chain attack in some

763
00:27:08,590 --> 00:27:11,259
industries both large and small a lot of

764
00:27:11,259 --> 00:27:12,999
it has been done for crypto mining

765
00:27:12,999 --> 00:27:14,980
they've done all kinds of interesting

766
00:27:14,980 --> 00:27:17,350
things and then you can't forget about

767
00:27:17,350 --> 00:27:18,429
mage cart

768
00:27:18,429 --> 00:27:20,080
the thing that's skimming credit cards

769
00:27:20,080 --> 00:27:21,460
all over the Internet has been doing it

770
00:27:21,460 --> 00:27:24,970
for not six months a year now almost a

771
00:27:24,970 --> 00:27:27,190
but let me finish up by a very

772
00:27:27,190 --> 00:27:30,220
interesting specific example the event

773
00:27:30,220 --> 00:27:32,679
stream incident so event stream is an

774
00:27:32,679 --> 00:27:35,019
open source software program there is a

775
00:27:35,019 --> 00:27:37,840
sub product of that called flatmap

776
00:27:37,840 --> 00:27:40,809
stream and what happened was is you had

777
00:27:40,809 --> 00:27:43,119
a software developer theoretically who

778
00:27:43,119 --> 00:27:45,580
started contributing read up regularly

779
00:27:45,580 --> 00:27:47,710
to this particular software package and

780
00:27:47,710 --> 00:27:49,929
was really moving it forward so the

781
00:27:49,929 --> 00:27:52,149
person who actually owned that software

782
00:27:52,149 --> 00:27:54,070
package receives an email from this

783
00:27:54,070 --> 00:27:55,840
person who's been actively developing it

784
00:27:55,840 --> 00:27:57,700
and they said hey I noticed that you

785
00:27:57,700 --> 00:27:59,289
don't really have a lot of time you

786
00:27:59,289 --> 00:28:01,059
haven't been developing this very much

787
00:28:01,059 --> 00:28:02,889
lately would you be willing to let me

788
00:28:02,889 --> 00:28:05,379
take it over and as the owner didn't

789
00:28:05,379 --> 00:28:06,789
really have time to manage it anymore

790
00:28:06,789 --> 00:28:09,039
they're like fine here you can take the

791
00:28:09,039 --> 00:28:10,749
library and become the owner of it and

792
00:28:10,749 --> 00:28:14,499
they very quickly modified it to add a

793
00:28:14,499 --> 00:28:16,869
whole lot of malicious functionality and

794
00:28:16,869 --> 00:28:19,570
then they profited pretty significantly

795
00:28:19,570 --> 00:28:22,090
the reason is they were targeting a

796
00:28:22,090 --> 00:28:25,019
Bitcoin wallet software called co-pay

797
00:28:25,019 --> 00:28:27,940
what they basically did is they modified

798
00:28:27,940 --> 00:28:29,860
the code to determine specifically if

799
00:28:29,860 --> 00:28:32,019
co-pay was running they then detected

800
00:28:32,019 --> 00:28:32,260
the

801
00:28:32,260 --> 00:28:34,120
on the mobile platform windows platform

802
00:28:34,120 --> 00:28:35,980
whatever and they looked at what the

803
00:28:35,980 --> 00:28:38,200
balance was of the wallet and they made

804
00:28:38,200 --> 00:28:40,210
a decision on whether or not to dump the

805
00:28:40,210 --> 00:28:42,929
wallet based on how much money was in it

806
00:28:42,929 --> 00:28:45,400
did a little math the balance had to be

807
00:28:45,400 --> 00:28:47,320
more than a hundred Bitcoin or more than

808
00:28:47,320 --> 00:28:50,290
a thousand Bitcoin cash so for every one

809
00:28:50,290 --> 00:28:52,900
time this code executed they would steal

810
00:28:52,900 --> 00:28:54,910
either four hundred thousand dollars or

811
00:28:54,910 --> 00:28:56,169
two hundred and fifty thousand dollars

812
00:28:56,169 --> 00:28:59,020
you can start to understand why

813
00:28:59,020 --> 00:29:00,580
adversaries are like wait a minute

814
00:29:00,580 --> 00:29:03,010
why am I wasting my time trying to

815
00:29:03,010 --> 00:29:05,080
compromise just random systems on the

816
00:29:05,080 --> 00:29:07,030
internet I should start focusing on

817
00:29:07,030 --> 00:29:09,669
specific products and what we've really

818
00:29:09,669 --> 00:29:11,710
started to see is open source is

819
00:29:11,710 --> 00:29:14,230
becoming a massive target github

820
00:29:14,230 --> 00:29:17,169
repositories NPM packages web extensions

821
00:29:17,169 --> 00:29:19,600
anywhere where people are writing code

822
00:29:19,600 --> 00:29:22,090
and sharing code bad guys are realizing

823
00:29:22,090 --> 00:29:24,669
if I play good for a while and help the

824
00:29:24,669 --> 00:29:26,919
project a little bit I can get levels of

825
00:29:26,919 --> 00:29:28,840
access that I never would have hoped to

826
00:29:28,840 --> 00:29:32,200
achieve by compromising a company just

827
00:29:32,200 --> 00:29:34,000
straight away and now we're really

828
00:29:34,000 --> 00:29:36,100
seeing is this is going to continue it's

829
00:29:36,100 --> 00:29:37,960
going to get worse and you really have

830
00:29:37,960 --> 00:29:39,820
to start looking at this and then you

831
00:29:39,820 --> 00:29:41,890
have the disaster that is ad networks I

832
00:29:41,890 --> 00:29:43,299
don't know if anybody's looked at ad

833
00:29:43,299 --> 00:29:45,760
networks but my god is it a disaster

834
00:29:45,760 --> 00:29:48,669
there's so many systems so many domains

835
00:29:48,669 --> 00:29:51,160
involved and there's so many points

836
00:29:51,160 --> 00:29:53,350
where you can infect this process along

837
00:29:53,350 --> 00:29:56,880
the way so what are you supposed to do

838
00:29:56,880 --> 00:29:59,470
so the one thing you should do before

839
00:29:59,470 --> 00:30:01,270
you really start worrying about supply

840
00:30:01,270 --> 00:30:04,120
chain attacks is ask yourself do you

841
00:30:04,120 --> 00:30:06,010
have all the basics covered because if

842
00:30:06,010 --> 00:30:08,320
you don't stop wasting your time if you

843
00:30:08,320 --> 00:30:10,120
have RDP open to the internet stop

844
00:30:10,120 --> 00:30:11,980
worrying about supply chain attacks if

845
00:30:11,980 --> 00:30:13,870
you have a flat network and you don't

846
00:30:13,870 --> 00:30:15,730
patch and you don't have any visibility

847
00:30:15,730 --> 00:30:18,580
stop worrying about supply chain attacks

848
00:30:18,580 --> 00:30:20,440
because it is the least of your problems

849
00:30:20,440 --> 00:30:23,380
at that point but if you are amateur

850
00:30:23,380 --> 00:30:25,510
security organization and you do have

851
00:30:25,510 --> 00:30:27,880
the bases covered and here's just a list

852
00:30:27,880 --> 00:30:29,799
of the things you should have if you

853
00:30:29,799 --> 00:30:30,640
don't know the assets in your

854
00:30:30,640 --> 00:30:32,530
environment stop asking me about supply

855
00:30:32,530 --> 00:30:34,390
chain attacks you don't patch you don't

856
00:30:34,390 --> 00:30:36,280
segment you don't understand the users

857
00:30:36,280 --> 00:30:38,590
what your file access control you have

858
00:30:38,590 --> 00:30:40,360
no user education if you're not even

859
00:30:40,360 --> 00:30:43,150
doing threat hunting stop worrying about

860
00:30:43,150 --> 00:30:44,610
supply chain attacks there

861
00:30:44,610 --> 00:30:46,590
much bigger problems in your environment

862
00:30:46,590 --> 00:30:50,520
to deal with but if you do simple guide

863
00:30:50,520 --> 00:30:52,710
install the update on a single system or

864
00:30:52,710 --> 00:30:55,460
a handful of systems and wait and wait

865
00:30:55,460 --> 00:30:58,410
wait some more hurry up and wait just

866
00:30:58,410 --> 00:31:00,720
keep waiting and then start looking for

867
00:31:00,720 --> 00:31:03,090
things start figuring out what networks

868
00:31:03,090 --> 00:31:05,730
and devices is this connecting to is it

869
00:31:05,730 --> 00:31:07,350
connecting some random server in a

870
00:31:07,350 --> 00:31:09,450
random country on a random port as if it

871
00:31:09,450 --> 00:31:11,580
is that's probably weird and maybe you

872
00:31:11,580 --> 00:31:13,320
should look at a little more what type

873
00:31:13,320 --> 00:31:15,330
of document data is being sent out are

874
00:31:15,330 --> 00:31:17,190
you seeing huge amounts of data leaving

875
00:31:17,190 --> 00:31:19,340
your network that could be a red flag

876
00:31:19,340 --> 00:31:22,020
really scrutinizing the connections that

877
00:31:22,020 --> 00:31:23,210
are coming into your environment

878
00:31:23,210 --> 00:31:25,640
realizing what you're doing and

879
00:31:25,640 --> 00:31:28,200
isolating your test clients if you're

880
00:31:28,200 --> 00:31:29,760
gonna test software updates in

881
00:31:29,760 --> 00:31:32,610
production isolate segments make sure

882
00:31:32,610 --> 00:31:34,110
that you're willing to lose those

883
00:31:34,110 --> 00:31:36,299
systems you don't want to have this be

884
00:31:36,299 --> 00:31:38,400
widely deployed before you understand

885
00:31:38,400 --> 00:31:41,309
that it's been backdoor and then again I

886
00:31:41,309 --> 00:31:43,140
mentioned this before but you have

887
00:31:43,140 --> 00:31:45,780
really got to start considering pushing

888
00:31:45,780 --> 00:31:47,850
your security to your vendors your

889
00:31:47,850 --> 00:31:50,490
security controls do not only apply to

890
00:31:50,490 --> 00:31:54,570
your environment anymore there are years

891
00:31:54,570 --> 00:31:57,690
and countless resources spent securing

892
00:31:57,690 --> 00:32:00,000
environments but vendors don't have to

893
00:32:00,000 --> 00:32:01,770
worry about that right you're you don't

894
00:32:01,770 --> 00:32:04,110
validate their best practices what you

895
00:32:04,110 --> 00:32:05,820
really need to do is generalized

896
00:32:05,820 --> 00:32:08,760
industry has to take some education from

897
00:32:08,760 --> 00:32:10,290
government and military backgrounds

898
00:32:10,290 --> 00:32:12,510
they've been doing this for a lot longer

899
00:32:12,510 --> 00:32:14,370
than we have they've been worried about

900
00:32:14,370 --> 00:32:17,280
this for a lot longer than we have they

901
00:32:17,280 --> 00:32:19,559
already know that you have to have a

902
00:32:19,559 --> 00:32:21,480
secure environment and don't assume

903
00:32:21,480 --> 00:32:22,679
because you have a trust relationship

904
00:32:22,679 --> 00:32:25,230
that they are secure not the same thing

905
00:32:25,230 --> 00:32:27,480
you really need to validate that they

906
00:32:27,480 --> 00:32:29,880
actually have a secure environment ask

907
00:32:29,880 --> 00:32:31,679
them what are you doing to validate your

908
00:32:31,679 --> 00:32:33,690
code how many people have access to it

909
00:32:33,690 --> 00:32:35,669
do you have a closed environment what

910
00:32:35,669 --> 00:32:37,650
types of checking are you doing on a

911
00:32:37,650 --> 00:32:39,840
continual basis these are the types of

912
00:32:39,840 --> 00:32:41,250
things you need to understand from your

913
00:32:41,250 --> 00:32:44,010
vendors and then is the final thing you

914
00:32:44,010 --> 00:32:47,429
know how big is this really everybody is

915
00:32:47,429 --> 00:32:49,410
paying attention it is already

916
00:32:49,410 --> 00:32:51,090
threatened critical infrastructure the

917
00:32:51,090 --> 00:32:53,990
United States it continues to affect

918
00:32:53,990 --> 00:32:56,510
this organizations and it is a real real

919
00:32:56,510 --> 00:32:58,660
concern for everybody if you're not

920
00:32:58,660 --> 00:33:01,040
concerned about this and you are part of

921
00:33:01,040 --> 00:33:02,540
a mature security organization you

922
00:33:02,540 --> 00:33:04,340
really should be because this is where

923
00:33:04,340 --> 00:33:06,230
an adversary is gonna come after you if

924
00:33:06,230 --> 00:33:08,150
they can't get in the front door they're

925
00:33:08,150 --> 00:33:09,920
definitely gonna try going after supply

926
00:33:09,920 --> 00:33:12,860
chain alright I think we're just about

927
00:33:12,860 --> 00:33:15,770
on time so does anybody have a question

928
00:33:15,770 --> 00:33:23,510
or two awesome all right when we get

929
00:33:23,510 --> 00:33:24,770
windy up here just about on time no

930
00:33:24,770 --> 00:33:28,179
thanks good thanks

