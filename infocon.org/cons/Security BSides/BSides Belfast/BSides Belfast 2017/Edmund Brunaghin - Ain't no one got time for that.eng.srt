1
00:00:04,820 --> 00:00:09,680
so my name is<font color="#CCCCCC"> Edmund brummagem</font><font color="#E5E5E5"> I'm a</font>

2
00:00:07,260 --> 00:00:12,180
security<font color="#CCCCCC"> researcher with Cisco Talos</font>

3
00:00:09,680 --> 00:00:14,430
<font color="#CCCCCC">spent</font><font color="#E5E5E5"> about a decade</font><font color="#CCCCCC"> in the security</font>

4
00:00:12,180 --> 00:00:17,130
industry<font color="#E5E5E5"> most of</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> career before coming</font>

5
00:00:14,430 --> 00:00:18,450
<font color="#CCCCCC">to Talos</font><font color="#E5E5E5"> was in security operations show</font>

6
00:00:17,130 --> 00:00:22,110
of hands<font color="#E5E5E5"> who here works in security</font>

7
00:00:18,450 --> 00:00:25,080
<font color="#E5E5E5">operations in some capacity yeah so if</font>

8
00:00:22,110 --> 00:00:27,210
<font color="#CCCCCC">you</font><font color="#E5E5E5"> okay of anyone who works in a</font>

9
00:00:25,080 --> 00:00:30,240
<font color="#E5E5E5">Security Operations capacity whether</font>

10
00:00:27,210 --> 00:00:32,430
that's monitoring<font color="#E5E5E5"> for intrusion events</font>

11
00:00:30,240 --> 00:00:33,690
or doing<font color="#CCCCCC"> Incident Response or anything</font>

12
00:00:32,430 --> 00:00:36,600
like<font color="#CCCCCC"> that how many</font><font color="#E5E5E5"> of you have the</font>

13
00:00:33,690 --> 00:00:38,579
luxury<font color="#CCCCCC"> of being able</font><font color="#E5E5E5"> to statically</font>

14
00:00:36,600 --> 00:00:41,870
<font color="#CCCCCC">reverse engineer an unknown binary in</font>

15
00:00:38,579 --> 00:00:44,309
your environment<font color="#E5E5E5"> okay okay so a couple</font>

16
00:00:41,870 --> 00:00:45,839
<font color="#E5E5E5">and most of the security</font><font color="#CCCCCC"> operations</font>

17
00:00:44,309 --> 00:00:47,968
centers and security<font color="#E5E5E5"> operations teams</font>

18
00:00:45,839 --> 00:00:50,039
I've worked in most of the time<font color="#E5E5E5"> the team</font>

19
00:00:47,969 --> 00:00:54,390
<font color="#E5E5E5">just doesn't have that</font><font color="#CCCCCC"> luxury so you</font>

20
00:00:50,039 --> 00:00:55,920
have a sim chirp or you have a virus

21
00:00:54,390 --> 00:00:58,769
alert come in and you<font color="#E5E5E5"> have to figure out</font>

22
00:00:55,920 --> 00:01:00,359
<font color="#E5E5E5">you know what is a specific binary what</font>

23
00:00:58,769 --> 00:01:01,649
does<font color="#E5E5E5"> it do is it malware what kind of</font>

24
00:01:00,359 --> 00:01:03,359
malware is it what's the risk<font color="#E5E5E5"> to my</font>

25
00:01:01,649 --> 00:01:04,979
<font color="#CCCCCC">organization and typically you have a</font>

26
00:01:03,359 --> 00:01:07,590
very<font color="#E5E5E5"> short</font><font color="#CCCCCC"> period of time to answer</font>

27
00:01:04,979 --> 00:01:09,240
<font color="#CCCCCC">those questions before</font><font color="#E5E5E5"> management comes</font>

28
00:01:07,590 --> 00:01:11,280
<font color="#E5E5E5">in and asks those</font><font color="#CCCCCC"> questions and you have</font>

29
00:01:09,240 --> 00:01:12,809
<font color="#E5E5E5">to be able to</font><font color="#CCCCCC"> answer</font><font color="#E5E5E5"> them so kind</font><font color="#CCCCCC"> of</font>

30
00:01:11,280 --> 00:01:15,090
<font color="#E5E5E5">wanted to put this talk together to</font>

31
00:01:12,810 --> 00:01:18,000
<font color="#CCCCCC">focus</font><font color="#E5E5E5"> on that to provide a quick and</font>

32
00:01:15,090 --> 00:01:19,770
<font color="#E5E5E5">easy way that you</font><font color="#CCCCCC"> can you know</font><font color="#E5E5E5"> come</font>

33
00:01:18,000 --> 00:01:22,200
across<font color="#E5E5E5"> samples in your environment</font>

34
00:01:19,770 --> 00:01:24,119
<font color="#CCCCCC">analyze them identify functionality</font>

35
00:01:22,200 --> 00:01:26,100
<font color="#E5E5E5">associated with those samples without</font>

36
00:01:24,119 --> 00:01:28,140
having to statically<font color="#CCCCCC"> reverse-engineer go</font>

37
00:01:26,100 --> 00:01:30,869
function by function<font color="#CCCCCC"> and analyze code</font>

38
00:01:28,140 --> 00:01:32,670
<font color="#CCCCCC">execution flow</font><font color="#E5E5E5"> there's a lot of</font>

39
00:01:30,869 --> 00:01:34,229
different<font color="#CCCCCC"> reasons why why security</font>

40
00:01:32,670 --> 00:01:36,210
operations teams don't typically<font color="#CCCCCC"> have</font>

41
00:01:34,229 --> 00:01:38,039
<font color="#E5E5E5">that</font><font color="#CCCCCC"> capacity right sometimes they're</font>

42
00:01:36,210 --> 00:01:39,719
just<font color="#CCCCCC"> not trained in how to use</font><font color="#E5E5E5"> the</font>

43
00:01:38,039 --> 00:01:41,609
disassembler or how to use a<font color="#CCCCCC"> debugger</font>

44
00:01:39,719 --> 00:01:43,649
<font color="#CCCCCC">and a lot of</font><font color="#E5E5E5"> times they just don't have</font>

45
00:01:41,609 --> 00:01:45,059
<font color="#E5E5E5">the time or resources available</font><font color="#CCCCCC"> to be</font>

46
00:01:43,649 --> 00:01:46,320
able<font color="#CCCCCC"> to you</font><font color="#E5E5E5"> know statically</font>

47
00:01:45,060 --> 00:01:49,229
reverse-engineer malware and that's

48
00:01:46,320 --> 00:01:51,869
where dynamic analysis comes in then the

49
00:01:49,229 --> 00:01:53,250
name of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> talk was was aka dynamic</font>

50
00:01:51,869 --> 00:01:55,380
malware analysis for the overworked

51
00:01:53,250 --> 00:01:57,210
<font color="#CCCCCC">analyst but it could also be a que how</font>

52
00:01:55,380 --> 00:01:58,829
to avoid having to<font color="#E5E5E5"> perform reverse</font>

53
00:01:57,210 --> 00:02:00,449
engineering in the first place<font color="#CCCCCC"> because a</font>

54
00:01:58,829 --> 00:02:02,130
lot<font color="#E5E5E5"> of times it takes a lot of time in</font>

55
00:02:00,450 --> 00:02:03,509
<font color="#E5E5E5">in a lot of cases it's</font><font color="#CCCCCC"> not actually</font>

56
00:02:02,130 --> 00:02:05,999
necessary<font color="#CCCCCC"> especially with things</font><font color="#E5E5E5"> like</font>

57
00:02:03,509 --> 00:02:07,979
commodity malware it's very easy<font color="#E5E5E5"> to go</font>

58
00:02:05,999 --> 00:02:09,600
from<font color="#E5E5E5"> this is a sample</font><font color="#CCCCCC"> that I found in my</font>

59
00:02:07,979 --> 00:02:11,340
environment<font color="#E5E5E5"> to hey this is what it</font>

60
00:02:09,600 --> 00:02:13,200
actually<font color="#E5E5E5"> is this is what it does this is</font>

61
00:02:11,340 --> 00:02:14,430
the risk it poses and this is the sort

62
00:02:13,200 --> 00:02:16,560
of response<font color="#CCCCCC"> that</font>

63
00:02:14,430 --> 00:02:18,780
to take without having to even<font color="#E5E5E5"> open it</font>

64
00:02:16,560 --> 00:02:22,010
up in a disassembler or<font color="#E5E5E5"> a debugger and</font>

65
00:02:18,780 --> 00:02:25,049
and manually<font color="#E5E5E5"> analyze code execution flow</font>

66
00:02:22,010 --> 00:02:27,599
so what this presentation is not<font color="#E5E5E5"> I don't</font>

67
00:02:25,049 --> 00:02:29,760
<font color="#E5E5E5">have a single slide with it with a</font>

68
00:02:27,599 --> 00:02:31,108
<font color="#CCCCCC">screenshot of assembly code so that's</font>

69
00:02:29,760 --> 00:02:33,179
<font color="#CCCCCC">not what it's</font><font color="#E5E5E5"> about it's about not</font>

70
00:02:31,109 --> 00:02:35,099
having<font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually perform that sort of</font>

71
00:02:33,180 --> 00:02:37,379
process<font color="#CCCCCC"> on a</font><font color="#E5E5E5"> binary in your environment</font>

72
00:02:35,099 --> 00:02:39,238
<font color="#CCCCCC">it's much</font><font color="#E5E5E5"> easier to</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to let's say</font>

73
00:02:37,379 --> 00:02:41,189
execute<font color="#CCCCCC"> it in a sandbox</font><font color="#E5E5E5"> environment</font>

74
00:02:39,239 --> 00:02:43,709
<font color="#CCCCCC">identify the functionality associated</font>

75
00:02:41,189 --> 00:02:45,720
<font color="#CCCCCC">with it</font><font color="#E5E5E5"> put together an IOC list and</font>

76
00:02:43,709 --> 00:02:48,180
then pivot<font color="#E5E5E5"> on that</font><font color="#CCCCCC"> to identify the</font>

77
00:02:45,720 --> 00:02:49,680
malware family and<font color="#E5E5E5"> in a lot</font><font color="#CCCCCC"> of cases an</font>

78
00:02:48,180 --> 00:02:51,180
antivirus company or a<font color="#E5E5E5"> security</font>

79
00:02:49,680 --> 00:02:53,040
researcher<font color="#E5E5E5"> has already performed</font><font color="#CCCCCC"> the</font>

80
00:02:51,180 --> 00:02:54,510
reverse<font color="#E5E5E5"> engineering for you right so</font>

81
00:02:53,040 --> 00:02:55,679
from<font color="#E5E5E5"> a security operations</font><font color="#CCCCCC"> perspective</font>

82
00:02:54,510 --> 00:02:56,819
you can very quickly answer the

83
00:02:55,680 --> 00:02:59,280
questions<font color="#E5E5E5"> you</font><font color="#CCCCCC"> need to answer without</font>

84
00:02:56,819 --> 00:03:01,798
having to actually<font color="#E5E5E5"> perform that process</font>

85
00:02:59,280 --> 00:03:04,620
<font color="#CCCCCC">yourself</font><font color="#E5E5E5"> so what are we going to cover</font>

86
00:03:01,799 --> 00:03:06,450
today<font color="#E5E5E5"> well</font><font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to go over how to</font>

87
00:03:04,620 --> 00:03:08,519
build a kind<font color="#E5E5E5"> of a portable malware</font>

88
00:03:06,450 --> 00:03:10,108
analysis lab so a quick and<font color="#E5E5E5"> easy lab</font>

89
00:03:08,519 --> 00:03:11,790
that you can stand up in in an

90
00:03:10,109 --> 00:03:14,040
environment that will enable you to

91
00:03:11,790 --> 00:03:16,108
perform<font color="#E5E5E5"> that dynamic analysis of samples</font>

92
00:03:14,040 --> 00:03:17,548
<font color="#CCCCCC">you may come across I also want to talk</font>

93
00:03:16,109 --> 00:03:19,769
<font color="#CCCCCC">about open source intelligence</font><font color="#E5E5E5"> right</font>

94
00:03:17,549 --> 00:03:21,569
<font color="#E5E5E5">being able to leverage all</font><font color="#CCCCCC"> of the great</font>

95
00:03:19,769 --> 00:03:23,549
<font color="#CCCCCC">work that</font><font color="#E5E5E5"> the entire security industry</font>

96
00:03:21,569 --> 00:03:25,138
is doing on a regular<font color="#E5E5E5"> basis because it</font>

97
00:03:23,549 --> 00:03:27,329
<font color="#CCCCCC">can save</font><font color="#E5E5E5"> you a</font><font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> time it can</font><font color="#CCCCCC"> save</font>

98
00:03:25,139 --> 00:03:29,160
you a<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> resources and at the end of</font>

99
00:03:27,329 --> 00:03:30,299
<font color="#CCCCCC">the day you're able to</font><font color="#E5E5E5"> answer the</font>

100
00:03:29,160 --> 00:03:31,709
questions<font color="#E5E5E5"> you need to answer it very</font>

101
00:03:30,299 --> 00:03:33,150
very quickly<font color="#CCCCCC"> because that's what it's</font>

102
00:03:31,709 --> 00:03:34,500
all about when<font color="#E5E5E5"> you're trying to figure</font>

103
00:03:33,150 --> 00:03:35,879
<font color="#CCCCCC">out you</font><font color="#E5E5E5"> know do I</font><font color="#CCCCCC"> need to initiate</font>

104
00:03:34,500 --> 00:03:37,699
incident response and<font color="#E5E5E5"> what does that</font>

105
00:03:35,879 --> 00:03:40,649
<font color="#E5E5E5">Incident Response needs to look like</font>

106
00:03:37,699 --> 00:03:42,449
<font color="#E5E5E5">being able to avoid you know statically</font>

107
00:03:40,650 --> 00:03:44,459
analyzing a<font color="#E5E5E5"> sample and being able to go</font>

108
00:03:42,449 --> 00:03:45,840
<font color="#CCCCCC">straight to hey we know all about</font><font color="#E5E5E5"> this</font>

109
00:03:44,459 --> 00:03:48,540
<font color="#E5E5E5">because there's already been a dossier</font>

110
00:03:45,840 --> 00:03:50,819
<font color="#CCCCCC">released</font><font color="#E5E5E5"> on it is very very powerful</font><font color="#CCCCCC"> and</font>

111
00:03:48,540 --> 00:03:52,290
<font color="#CCCCCC">then I want to</font><font color="#E5E5E5"> talk about a repeatable</font>

112
00:03:50,819 --> 00:03:53,940
<font color="#E5E5E5">process</font><font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to go over some some</font>

113
00:03:52,290 --> 00:03:56,190
quick and easy tools that you can stand

114
00:03:53,940 --> 00:03:58,590
up in<font color="#CCCCCC"> in</font><font color="#E5E5E5"> your analysis environment</font><font color="#CCCCCC"> to</font>

115
00:03:56,190 --> 00:04:01,560
<font color="#E5E5E5">help</font><font color="#CCCCCC"> you quickly</font><font color="#E5E5E5"> identify you know what</font>

116
00:03:58,590 --> 00:04:03,479
a<font color="#E5E5E5"> particularly our sample is capable of</font>

117
00:04:01,560 --> 00:04:05,389
<font color="#E5E5E5">doing and then that</font><font color="#CCCCCC"> provides you once</font>

118
00:04:03,479 --> 00:04:07,620
again information you can pivot<font color="#E5E5E5"> on to</font>

119
00:04:05,389 --> 00:04:09,659
positively identify if it's a known

120
00:04:07,620 --> 00:04:11,340
malware family what functionality is

121
00:04:09,659 --> 00:04:13,409
<font color="#CCCCCC">available and and what it's designed for</font>

122
00:04:11,340 --> 00:04:14,879
<font color="#E5E5E5">you know what what impact could it have</font>

123
00:04:13,409 --> 00:04:18,269
in your<font color="#CCCCCC"> environment so</font><font color="#E5E5E5"> you can respond</font>

124
00:04:14,879 --> 00:04:19,978
accordingly<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so let's get</font>

125
00:04:18,269 --> 00:04:21,780
started let's<font color="#E5E5E5"> talk about</font><font color="#CCCCCC"> our analysis</font>

126
00:04:19,978 --> 00:04:23,520
labs<font color="#E5E5E5"> right when you're building out a</font>

127
00:04:21,779 --> 00:04:24,900
<font color="#E5E5E5">malware analysis lab the first thing you</font>

128
00:04:23,520 --> 00:04:25,669
<font color="#CCCCCC">need to do is identify what</font><font color="#E5E5E5"> your</font>

129
00:04:24,900 --> 00:04:27,888
requirements<font color="#CCCCCC"> are</font>

130
00:04:25,669 --> 00:04:29,990
so I just<font color="#E5E5E5"> kind of put a list together</font><font color="#CCCCCC"> if</font>

131
00:04:27,889 --> 00:04:32,060
<font color="#E5E5E5">some of the requirements I have when I'm</font>

132
00:04:29,990 --> 00:04:33,889
<font color="#E5E5E5">putting together a malware analysis lab</font>

133
00:04:32,060 --> 00:04:36,139
<font color="#E5E5E5">right</font><font color="#CCCCCC"> you need to be able</font><font color="#E5E5E5"> to facilitate</font>

134
00:04:33,889 --> 00:04:37,879
analyzing malware that targets<font color="#CCCCCC"> multiple</font>

135
00:04:36,139 --> 00:04:40,789
platforms multiple versions of Windows

136
00:04:37,879 --> 00:04:42,529
OS X<font color="#E5E5E5"> Linux things of that nature</font><font color="#CCCCCC"> I also</font>

137
00:04:40,789 --> 00:04:44,479
need to be able to anonymize<font color="#CCCCCC"> C</font><font color="#E5E5E5"> to</font>

138
00:04:42,529 --> 00:04:47,210
traffic<font color="#CCCCCC"> one of the things that you'll</font>

139
00:04:44,479 --> 00:04:50,240
see<font color="#E5E5E5"> is when a malware author especially</font>

140
00:04:47,210 --> 00:04:51,229
in more targeted attacks<font color="#E5E5E5"> sins malware</font>

141
00:04:50,240 --> 00:04:53,479
<font color="#E5E5E5">into your</font><font color="#CCCCCC"> environment whether it's</font>

142
00:04:51,229 --> 00:04:54,740
<font color="#CCCCCC">fishing or through the use of malvert</font>

143
00:04:53,479 --> 00:04:57,050
<font color="#CCCCCC">sizing campaigns things like that</font>

144
00:04:54,740 --> 00:04:58,520
they're going<font color="#CCCCCC"> to notice if they start</font>

145
00:04:57,050 --> 00:05:00,979
getting<font color="#E5E5E5"> a lot of C</font><font color="#CCCCCC"> - and</font><font color="#E5E5E5"> it looks</font><font color="#CCCCCC"> like</font>

146
00:04:58,520 --> 00:05:03,438
<font color="#E5E5E5">you've found their malware so being able</font>

147
00:05:00,979 --> 00:05:05,150
to transparently route all of the

148
00:05:03,439 --> 00:05:08,060
traffic<font color="#CCCCCC"> from</font><font color="#E5E5E5"> my at</font><font color="#CCCCCC"> my analysis lab</font>

149
00:05:05,150 --> 00:05:09,770
through tor is is essential<font color="#E5E5E5"> also needs</font>

150
00:05:08,060 --> 00:05:10,909
to be<font color="#E5E5E5"> reasonably safe from contamination</font>

151
00:05:09,770 --> 00:05:12,500
right you don't want to just<font color="#CCCCCC"> throw this</font>

152
00:05:10,909 --> 00:05:14,330
into<font color="#E5E5E5"> your</font><font color="#CCCCCC"> production you know server</font>

153
00:05:12,500 --> 00:05:16,219
<font color="#E5E5E5">network and and start analyzing and</font>

154
00:05:14,330 --> 00:05:17,779
detonating<font color="#E5E5E5"> malware samples because that</font>

155
00:05:16,219 --> 00:05:20,060
could<font color="#E5E5E5"> get nasty quickly depending on the</font>

156
00:05:17,779 --> 00:05:21,289
<font color="#E5E5E5">type of</font><font color="#CCCCCC"> malware it is especially you</font>

157
00:05:20,060 --> 00:05:23,479
know given some of<font color="#E5E5E5"> the worm activity</font>

158
00:05:21,289 --> 00:05:25,159
we've seen this<font color="#E5E5E5"> year also need to be</font>

159
00:05:23,479 --> 00:05:27,050
able<font color="#CCCCCC"> to perform passive analysis of</font>

160
00:05:25,159 --> 00:05:29,240
network traffic<font color="#E5E5E5"> right so not necessarily</font>

161
00:05:27,050 --> 00:05:31,219
<font color="#E5E5E5">running you know TCP dump or Wireshark</font>

162
00:05:29,240 --> 00:05:32,990
<font color="#E5E5E5">on the the system</font><font color="#CCCCCC"> that I'm you know</font>

163
00:05:31,219 --> 00:05:35,150
detonating malware samples<font color="#E5E5E5"> on but being</font>

164
00:05:32,990 --> 00:05:36,860
able<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that off box because in a lot</font>

165
00:05:35,150 --> 00:05:39,049
of<font color="#E5E5E5"> cases malware will check</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the</font>

166
00:05:36,860 --> 00:05:41,569
<font color="#E5E5E5">existence of processes</font><font color="#CCCCCC"> that are used for</font>

167
00:05:39,050 --> 00:05:43,639
<font color="#E5E5E5">common analysis tasks and then I need to</font>

168
00:05:41,569 --> 00:05:45,620
<font color="#E5E5E5">be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to simulate</font><font color="#CCCCCC"> situ communications</font>

169
00:05:43,639 --> 00:05:47,990
<font color="#E5E5E5">and I'll go into some tools that</font>

170
00:05:45,620 --> 00:05:49,339
facilitate that<font color="#E5E5E5"> in a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> but I</font>

171
00:05:47,990 --> 00:05:51,110
also<font color="#E5E5E5"> needed it to</font><font color="#CCCCCC"> be a little</font><font color="#E5E5E5"> bit more</font>

172
00:05:49,339 --> 00:05:53,419
versatile so maybe I don't<font color="#E5E5E5"> just want to</font>

173
00:05:51,110 --> 00:05:55,279
analyze malware maybe I also want to you

174
00:05:53,419 --> 00:05:57,529
know<font color="#E5E5E5"> stand up you know additional</font>

175
00:05:55,279 --> 00:05:58,279
<font color="#E5E5E5">virtual machines or additional systems</font>

176
00:05:57,529 --> 00:06:01,729
that I can use<font color="#CCCCCC"> for other purposes</font>

177
00:05:58,279 --> 00:06:04,610
<font color="#CCCCCC">whether that's penetration testing</font><font color="#E5E5E5"> CTF</font>

178
00:06:01,729 --> 00:06:06,349
activity things<font color="#E5E5E5"> like that so once you</font>

179
00:06:04,610 --> 00:06:08,719
<font color="#E5E5E5">identified your requirements one of the</font>

180
00:06:06,349 --> 00:06:10,039
most vital answers or<font color="#CCCCCC"> questions that</font><font color="#E5E5E5"> you</font>

181
00:06:08,719 --> 00:06:12,349
need<font color="#E5E5E5"> to answer is whether or not you go</font>

182
00:06:10,039 --> 00:06:13,639
<font color="#CCCCCC">bare-metal</font><font color="#E5E5E5"> or virtual right it's a</font>

183
00:06:12,349 --> 00:06:15,680
<font color="#E5E5E5">question that's been asked by pretty</font>

184
00:06:13,639 --> 00:06:18,439
much every malware analyst ever<font color="#E5E5E5"> right</font><font color="#CCCCCC"> to</font>

185
00:06:15,680 --> 00:06:21,199
<font color="#E5E5E5">VM or not to BM there's some pros and</font>

186
00:06:18,439 --> 00:06:22,759
cons<font color="#CCCCCC"> to both sides right so with virtual</font>

187
00:06:21,199 --> 00:06:25,479
environments are really<font color="#CCCCCC"> flexible</font><font color="#E5E5E5"> you can</font>

188
00:06:22,759 --> 00:06:27,560
simulate a lot of complex network

189
00:06:25,479 --> 00:06:29,029
topology configurations without having

190
00:06:27,560 --> 00:06:31,399
to buy a bunch<font color="#E5E5E5"> of blinky lights or a</font>

191
00:06:29,029 --> 00:06:33,319
bunch of gear it's also recoverable

192
00:06:31,399 --> 00:06:34,729
right you can take<font color="#CCCCCC"> snapshots and you</font>

193
00:06:33,319 --> 00:06:37,370
should<font color="#E5E5E5"> definitely take snapshots as</font>

194
00:06:34,729 --> 00:06:38,609
quickly as<font color="#CCCCCC"> possible all the</font><font color="#E5E5E5"> time so</font><font color="#CCCCCC"> that</font>

195
00:06:37,370 --> 00:06:40,470
when you<font color="#CCCCCC"> are analyzed</font>

196
00:06:38,610 --> 00:06:42,509
<font color="#E5E5E5">particularly our sample you can execute</font>

197
00:06:40,470 --> 00:06:44,220
multiple<font color="#E5E5E5"> times and have different sets</font>

198
00:06:42,509 --> 00:06:46,919
of snapshots associated with what you're

199
00:06:44,220 --> 00:06:48,539
<font color="#E5E5E5">doing with the particular sample it's</font>

200
00:06:46,919 --> 00:06:49,948
also pretty<font color="#CCCCCC"> cheap right once again you</font>

201
00:06:48,539 --> 00:06:52,889
don't<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to buy a bunch of gear</font><font color="#CCCCCC"> so you</font>

202
00:06:49,949 --> 00:06:54,889
can do<font color="#E5E5E5"> it on relatively simple hardware</font>

203
00:06:52,889 --> 00:06:58,110
<font color="#CCCCCC">you know even a laptop in</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of cases</font>

204
00:06:54,889 --> 00:07:02,430
<font color="#CCCCCC">but there are cons associated with it</font>

205
00:06:58,110 --> 00:07:03,599
<font color="#E5E5E5">right a lot of malware is is designed to</font>

206
00:07:02,430 --> 00:07:05,219
<font color="#E5E5E5">detect whether or not it's being</font>

207
00:07:03,599 --> 00:07:07,289
executed in a virtual<font color="#E5E5E5"> environment and</font>

208
00:07:05,219 --> 00:07:09,990
<font color="#CCCCCC">it'll</font><font color="#E5E5E5"> behave differently than if it's in</font>

209
00:07:07,289 --> 00:07:12,469
bare metal you know<font color="#CCCCCC"> anti sandbox</font>

210
00:07:09,990 --> 00:07:15,030
<font color="#E5E5E5">techniques are very very common nowadays</font>

211
00:07:12,469 --> 00:07:16,740
<font color="#E5E5E5">physical it's it's secure you you don't</font>

212
00:07:15,030 --> 00:07:18,179
have<font color="#E5E5E5"> to worry about some somebody</font>

213
00:07:16,740 --> 00:07:19,949
throwing<font color="#E5E5E5"> you an</font><font color="#CCCCCC"> O'Day for your</font>

214
00:07:18,180 --> 00:07:21,599
hypervisor or something though if you

215
00:07:19,949 --> 00:07:24,300
came across that that would be excellent

216
00:07:21,599 --> 00:07:25,800
<font color="#CCCCCC">because those aren't</font><font color="#E5E5E5"> cheap also</font><font color="#CCCCCC"> evasion</font>

217
00:07:24,300 --> 00:07:27,690
right<font color="#CCCCCC"> malware's never going to detect</font>

218
00:07:25,800 --> 00:07:29,759
<font color="#CCCCCC">it's running in a virtual environment or</font>

219
00:07:27,690 --> 00:07:31,139
sandbox<font color="#CCCCCC"> because it's not and then it'll</font>

220
00:07:29,759 --> 00:07:32,819
<font color="#E5E5E5">keep your house</font><font color="#CCCCCC"> warm during</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> winter</font>

221
00:07:31,139 --> 00:07:35,639
<font color="#E5E5E5">so that's that some of the pros</font>

222
00:07:32,819 --> 00:07:37,439
associated with physical<font color="#E5E5E5"> systems for me</font>

223
00:07:35,639 --> 00:07:40,500
here's some of the lab components that<font color="#CCCCCC"> I</font>

224
00:07:37,439 --> 00:07:42,719
typically will<font color="#CCCCCC"> use or recommend so you</font>

225
00:07:40,500 --> 00:07:44,370
know a decent<font color="#E5E5E5"> system</font><font color="#CCCCCC"> one of</font><font color="#E5E5E5"> the most</font>

226
00:07:42,719 --> 00:07:46,259
important things<font color="#E5E5E5"> is storage capacity</font>

227
00:07:44,370 --> 00:07:48,300
right when you're taking snapshots and

228
00:07:46,259 --> 00:07:49,620
<font color="#E5E5E5">you have multiple VMs you're gonna run</font>

229
00:07:48,300 --> 00:07:51,150
into storage<font color="#E5E5E5"> issues so that's that's</font>

230
00:07:49,620 --> 00:07:53,699
<font color="#E5E5E5">really the most important thing I</font><font color="#CCCCCC"> found</font>

231
00:07:51,150 --> 00:07:55,948
you<font color="#CCCCCC"> know CPUs ran that's cheap nowadays</font>

232
00:07:53,699 --> 00:07:57,990
<font color="#E5E5E5">but finding like let's say a laptop with</font>

233
00:07:55,949 --> 00:07:59,940
enough storage to<font color="#CCCCCC"> facilitate you know</font>

234
00:07:57,990 --> 00:08:02,060
several vm's with multiple trees of

235
00:07:59,940 --> 00:08:04,770
snapshots<font color="#E5E5E5"> that gets expensive quickly</font>

236
00:08:02,060 --> 00:08:06,539
also recommend a hardware firewall just

237
00:08:04,770 --> 00:08:07,830
to make<font color="#CCCCCC"> sure that you're in a controlled</font>

238
00:08:06,539 --> 00:08:09,690
environment<font color="#E5E5E5"> and that you don't</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> to</font>

239
00:08:07,830 --> 00:08:11,550
risk any sort of<font color="#E5E5E5"> cross</font><font color="#CCCCCC"> contamination</font>

240
00:08:09,690 --> 00:08:13,979
when you're<font color="#E5E5E5"> actively you know detonating</font>

241
00:08:11,550 --> 00:08:16,620
and running malware in your lab from<font color="#E5E5E5"> a</font>

242
00:08:13,979 --> 00:08:18,360
<font color="#E5E5E5">guest systems perspective you know it</font>

243
00:08:16,620 --> 00:08:19,949
<font color="#E5E5E5">just depends for me I typically try</font><font color="#CCCCCC"> to</font>

244
00:08:18,360 --> 00:08:22,080
run a bunch of<font color="#E5E5E5"> different versions of the</font>

245
00:08:19,949 --> 00:08:25,020
<font color="#E5E5E5">Windows operating system as well as OSX</font>

246
00:08:22,080 --> 00:08:27,990
<font color="#CCCCCC">a couple optional but recommended</font><font color="#E5E5E5"> so REM</font>

247
00:08:25,020 --> 00:08:29,909
<font color="#E5E5E5">Nix is super useful for analyzing</font>

248
00:08:27,990 --> 00:08:32,190
malware especially when it comes<font color="#E5E5E5"> to</font>

249
00:08:29,909 --> 00:08:33,779
things like passive<font color="#E5E5E5"> network inspection</font>

250
00:08:32,190 --> 00:08:36,240
<font color="#E5E5E5">and being able to log a lot</font><font color="#CCCCCC"> of the</font>

251
00:08:33,779 --> 00:08:37,979
traffic<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of built-in tools which</font>

252
00:08:36,240 --> 00:08:41,579
I'll<font color="#E5E5E5"> go over in</font><font color="#CCCCCC"> a little bit IP</font><font color="#E5E5E5"> fire I</font>

253
00:08:37,979 --> 00:08:43,320
like to use<font color="#E5E5E5"> it's it's like a UTM</font><font color="#CCCCCC"> um but</font>

254
00:08:41,578 --> 00:08:45,449
it's really really<font color="#CCCCCC"> simple to</font><font color="#E5E5E5"> deploy and</font>

255
00:08:43,320 --> 00:08:47,699
I like to stand<font color="#E5E5E5"> that up</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> you know</font>

256
00:08:45,449 --> 00:08:49,979
it has a snort<font color="#E5E5E5"> IDs process that you can</font>

257
00:08:47,699 --> 00:08:50,650
enable<font color="#E5E5E5"> it</font><font color="#CCCCCC"> also has</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> tour socks proxy</font>

258
00:08:49,980 --> 00:08:52,089
that<font color="#E5E5E5"> you can in a</font>

259
00:08:50,650 --> 00:08:55,079
so if you're sending traffic<font color="#E5E5E5"> through</font>

260
00:08:52,089 --> 00:08:57,550
this to exit<font color="#E5E5E5"> your environment it can</font>

261
00:08:55,080 --> 00:08:59,620
basically<font color="#E5E5E5"> route that through</font><font color="#CCCCCC"> tor if</font><font color="#E5E5E5"> you</font>

262
00:08:57,550 --> 00:09:01,209
can<font color="#E5E5E5"> sock safai your applications and</font>

263
00:08:59,620 --> 00:09:02,770
then also onion pie is something that<font color="#E5E5E5"> I</font>

264
00:09:01,210 --> 00:09:04,540
came<font color="#CCCCCC"> across</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit after</font><font color="#CCCCCC"> I</font>

265
00:09:02,770 --> 00:09:06,010
initially<font color="#CCCCCC"> put</font><font color="#E5E5E5"> my lab together</font><font color="#CCCCCC"> but it's</font>

266
00:09:04,540 --> 00:09:08,020
super<font color="#E5E5E5"> useful you can basically take</font><font color="#CCCCCC"> a</font>

267
00:09:06,010 --> 00:09:09,970
<font color="#E5E5E5">Raspberry Pi</font><font color="#CCCCCC"> give it to network</font>

268
00:09:08,020 --> 00:09:11,890
interfaces one of them in my

269
00:09:09,970 --> 00:09:14,080
<font color="#E5E5E5">configuration is</font><font color="#CCCCCC"> Wireless and the other</font>

270
00:09:11,890 --> 00:09:15,880
<font color="#E5E5E5">one is wired but you can</font><font color="#CCCCCC"> basically stand</font>

271
00:09:14,080 --> 00:09:18,190
it up so<font color="#CCCCCC"> that it's an AP that broadcast</font>

272
00:09:15,880 --> 00:09:19,900
<font color="#E5E5E5">in your environment</font><font color="#CCCCCC"> connect</font><font color="#E5E5E5"> your system</font>

273
00:09:18,190 --> 00:09:22,240
<font color="#E5E5E5">that you're using for</font><font color="#CCCCCC"> analysis up to it</font>

274
00:09:19,900 --> 00:09:25,839
<font color="#E5E5E5">and it will route all</font><font color="#CCCCCC"> the traffic</font>

275
00:09:22,240 --> 00:09:28,420
through<font color="#E5E5E5"> itself through tor so completely</font>

276
00:09:25,839 --> 00:09:31,150
<font color="#E5E5E5">transparent to whatever</font><font color="#CCCCCC"> a physical</font>

277
00:09:28,420 --> 00:09:33,640
<font color="#E5E5E5">network you're actually connected</font><font color="#CCCCCC"> to so</font>

278
00:09:31,150 --> 00:09:35,949
why do I recommend<font color="#CCCCCC"> IP fire</font><font color="#E5E5E5"> super simple</font>

279
00:09:33,640 --> 00:09:37,870
to deploy<font color="#E5E5E5"> and it's it's really great to</font>

280
00:09:35,950 --> 00:09:39,670
<font color="#CCCCCC">use is kind of a gateway between your</font>

281
00:09:37,870 --> 00:09:42,610
malware analysis<font color="#E5E5E5"> network in the outside</font>

282
00:09:39,670 --> 00:09:45,310
world<font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> do transparent network</font>

283
00:09:42,610 --> 00:09:48,130
inspection you<font color="#E5E5E5"> can run intrusion</font>

284
00:09:45,310 --> 00:09:50,439
detection rule set and you can<font color="#E5E5E5"> gather a</font>

285
00:09:48,130 --> 00:09:51,820
lot of<font color="#E5E5E5"> log data</font><font color="#CCCCCC"> you can TCP</font><font color="#E5E5E5"> dump from it</font>

286
00:09:50,440 --> 00:09:53,589
and you can see pretty<font color="#CCCCCC"> much everything</font>

287
00:09:51,820 --> 00:09:57,430
that the system is using<font color="#E5E5E5"> to analyze</font>

288
00:09:53,589 --> 00:09:59,320
malware is doing at any given<font color="#E5E5E5"> time once</font>

289
00:09:57,430 --> 00:10:00,969
again<font color="#E5E5E5"> it</font><font color="#CCCCCC"> has a an optional</font><font color="#E5E5E5"> tor routing</font>

290
00:09:59,320 --> 00:10:03,070
package that you<font color="#E5E5E5"> can deploy straight</font>

291
00:10:00,970 --> 00:10:04,500
from within IP fire that's really<font color="#E5E5E5"> super</font>

292
00:10:03,070 --> 00:10:06,760
simple<font color="#E5E5E5"> to</font><font color="#CCCCCC"> set up</font><font color="#E5E5E5"> takes about two minutes</font>

293
00:10:04,500 --> 00:10:08,170
<font color="#CCCCCC">and</font><font color="#E5E5E5"> then then</font><font color="#CCCCCC"> you have a socks proxy</font>

294
00:10:06,760 --> 00:10:12,010
<font color="#E5E5E5">that will just send all your</font><font color="#CCCCCC"> traffic</font>

295
00:10:08,170 --> 00:10:14,050
through tor<font color="#CCCCCC"> just a note</font><font color="#E5E5E5"> if you do take</font>

296
00:10:12,010 --> 00:10:16,779
this sort of<font color="#E5E5E5"> approach applications that</font>

297
00:10:14,050 --> 00:10:18,670
<font color="#CCCCCC">aren't socks</font><font color="#E5E5E5"> aren't proxy aware and then</font>

298
00:10:16,779 --> 00:10:20,980
<font color="#CCCCCC">a lot</font><font color="#E5E5E5"> of malware may not necessarily use</font>

299
00:10:18,670 --> 00:10:23,500
your socks proxy so it's important that

300
00:10:20,980 --> 00:10:26,140
<font color="#E5E5E5">you you make sure that you're using</font>

301
00:10:23,500 --> 00:10:27,700
applications that are proxy aware if you

302
00:10:26,140 --> 00:10:29,589
<font color="#E5E5E5">do this or socks</font><font color="#CCCCCC"> apply them or something</font>

303
00:10:27,700 --> 00:10:33,100
<font color="#CCCCCC">like that</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is kind of why</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> started</font>

304
00:10:29,589 --> 00:10:34,990
recommending onion<font color="#CCCCCC"> PI over IP</font><font color="#E5E5E5"> fired just</font>

305
00:10:33,100 --> 00:10:36,610
<font color="#CCCCCC">from</font><font color="#E5E5E5"> a from a</font><font color="#CCCCCC"> tor routing perspective</font>

306
00:10:34,990 --> 00:10:40,240
<font color="#E5E5E5">because it's completely transparent</font><font color="#CCCCCC"> so</font>

307
00:10:36,610 --> 00:10:42,940
your analysis lab so it's super simple

308
00:10:40,240 --> 00:10:45,100
<font color="#E5E5E5">to deploy</font><font color="#CCCCCC"> hooks takes about</font><font color="#E5E5E5"> 30 minutes</font>

309
00:10:42,940 --> 00:10:47,650
<font color="#CCCCCC">to setup</font><font color="#E5E5E5"> and then once you've</font><font color="#CCCCCC"> got it</font><font color="#E5E5E5"> set</font>

310
00:10:45,100 --> 00:10:48,700
<font color="#CCCCCC">up</font><font color="#E5E5E5"> you plug its physical interface into</font>

311
00:10:47,650 --> 00:10:51,100
your network<font color="#CCCCCC"> and then it's got a</font>

312
00:10:48,700 --> 00:10:52,690
secondary<font color="#E5E5E5"> Wi-Fi interface that functions</font>

313
00:10:51,100 --> 00:10:55,089
as an AP when you want to<font color="#E5E5E5"> analyze</font>

314
00:10:52,690 --> 00:10:56,890
<font color="#E5E5E5">malware connect up to the AP and all</font>

315
00:10:55,089 --> 00:10:59,070
your traffic gets routed through tor<font color="#E5E5E5"> so</font>

316
00:10:56,890 --> 00:11:02,079
super super<font color="#CCCCCC"> easy super</font><font color="#E5E5E5"> flexible you can</font>

317
00:10:59,070 --> 00:11:03,910
simply I always using my<font color="#E5E5E5"> Raspberry Pi as</font>

318
00:11:02,079 --> 00:11:05,260
a as a retro<font color="#E5E5E5"> PI and</font>

319
00:11:03,910 --> 00:11:07,510
this is super simple<font color="#CCCCCC"> you just pop</font><font color="#E5E5E5"> it</font>

320
00:11:05,260 --> 00:11:10,540
others ecard<font color="#CCCCCC"> in</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> Raspberry Pi</font><font color="#E5E5E5"> and</font>

321
00:11:07,510 --> 00:11:12,730
all the sudden you<font color="#CCCCCC"> have an onion pie</font><font color="#E5E5E5"> so</font>

322
00:11:10,540 --> 00:11:14,530
from from a lab network topology<font color="#CCCCCC"> setup</font>

323
00:11:12,730 --> 00:11:16,630
<font color="#CCCCCC">one of the things I like to</font><font color="#E5E5E5"> do is I like</font>

324
00:11:14,530 --> 00:11:18,520
to<font color="#E5E5E5"> stand up multiple virtual network</font>

325
00:11:16,630 --> 00:11:20,470
interfaces<font color="#E5E5E5"> within whatever hypervisor I</font>

326
00:11:18,520 --> 00:11:22,060
happen to be using<font color="#CCCCCC"> and so one of those</font>

327
00:11:20,470 --> 00:11:23,800
network interfaces will connect to the

328
00:11:22,060 --> 00:11:26,170
outside<font color="#CCCCCC"> world</font><font color="#E5E5E5"> so whatever network</font>

329
00:11:23,800 --> 00:11:27,910
connection<font color="#E5E5E5"> your physical host system is</font>

330
00:11:26,170 --> 00:11:30,280
connected<font color="#CCCCCC"> to and that's what facilitates</font>

331
00:11:27,910 --> 00:11:31,510
communication<font color="#CCCCCC"> out of your analysis</font>

332
00:11:30,280 --> 00:11:33,189
environment<font color="#CCCCCC"> and then you've got a</font>

333
00:11:31,510 --> 00:11:35,260
secondary virtual network interface

334
00:11:33,190 --> 00:11:38,170
that's kind<font color="#CCCCCC"> of a private</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> and</font>

335
00:11:35,260 --> 00:11:40,480
then I deploy<font color="#E5E5E5"> my IP</font><font color="#CCCCCC"> fire as you can see</font>

336
00:11:38,170 --> 00:11:42,040
right<font color="#E5E5E5"> here that basically</font><font color="#CCCCCC"> bridges the</font>

337
00:11:40,480 --> 00:11:44,320
two<font color="#CCCCCC"> networks so it facilitates</font>

338
00:11:42,040 --> 00:11:46,930
communications from<font color="#E5E5E5"> the internal private</font>

339
00:11:44,320 --> 00:11:49,570
<font color="#E5E5E5">only network to the outside world and</font>

340
00:11:46,930 --> 00:11:51,189
through my onion pie<font color="#E5E5E5"> and then within</font>

341
00:11:49,570 --> 00:11:53,500
your analysis<font color="#CCCCCC"> Network that private</font>

342
00:11:51,190 --> 00:11:55,900
network you can deploy<font color="#CCCCCC"> beans as needed</font>

343
00:11:53,500 --> 00:11:58,030
<font color="#CCCCCC">to you</font><font color="#E5E5E5"> know perform the analysis</font>

344
00:11:55,900 --> 00:12:00,790
whatever target<font color="#E5E5E5"> operating system hours</font>

345
00:11:58,030 --> 00:12:03,100
trying to to execute in you can also

346
00:12:00,790 --> 00:12:05,050
deploy<font color="#E5E5E5"> any tool set</font><font color="#CCCCCC"> that you need to to</font>

347
00:12:03,100 --> 00:12:07,360
analyze<font color="#CCCCCC"> the malware</font><font color="#E5E5E5"> if you're doing</font>

348
00:12:05,050 --> 00:12:09,699
<font color="#E5E5E5">passive analysis things like that so I</font>

349
00:12:07,360 --> 00:12:11,860
<font color="#E5E5E5">mentioned Remnick so earlier I'm an avid</font>

350
00:12:09,700 --> 00:12:14,710
fan<font color="#E5E5E5"> of</font><font color="#CCCCCC"> unix because it's</font><font color="#E5E5E5"> super useful</font>

351
00:12:11,860 --> 00:12:17,950
for<font color="#CCCCCC"> performing a lot</font><font color="#E5E5E5"> of different off</font>

352
00:12:14,710 --> 00:12:20,080
box analysis so<font color="#E5E5E5"> two of the tools that</font><font color="#CCCCCC"> i</font>

353
00:12:17,950 --> 00:12:23,260
specifically<font color="#E5E5E5"> like in REM mixes i netsim</font>

354
00:12:20,080 --> 00:12:25,300
<font color="#CCCCCC">and fake dns</font><font color="#E5E5E5"> so the idea here</font><font color="#CCCCCC"> is that</font>

355
00:12:23,260 --> 00:12:27,280
<font color="#E5E5E5">you</font><font color="#CCCCCC"> take let's say a</font><font color="#E5E5E5"> Windows VM that</font>

356
00:12:25,300 --> 00:12:29,589
<font color="#E5E5E5">you're detonating malware in and you</font>

357
00:12:27,280 --> 00:12:32,949
point your DNS server<font color="#E5E5E5"> and Gateway over</font>

358
00:12:29,590 --> 00:12:35,110
to your<font color="#E5E5E5"> REM</font><font color="#CCCCCC"> NICs</font><font color="#E5E5E5"> VM well by deploying</font><font color="#CCCCCC"> AI</font>

359
00:12:32,950 --> 00:12:38,740
netsim<font color="#CCCCCC"> and fake</font><font color="#E5E5E5"> DNS within REM NICs you</font>

360
00:12:35,110 --> 00:12:42,010
can a have a system that<font color="#E5E5E5"> always responds</font>

361
00:12:38,740 --> 00:12:43,840
to DNS requests from whatever system

362
00:12:42,010 --> 00:12:45,939
you're analyzing malware in and it says

363
00:12:43,840 --> 00:12:47,200
<font color="#E5E5E5">oh you want to go to google.com for</font>

364
00:12:45,940 --> 00:12:49,240
<font color="#E5E5E5">instance well that's me</font>

365
00:12:47,200 --> 00:12:50,950
and so you can very<font color="#CCCCCC"> very</font><font color="#E5E5E5"> quickly and</font>

366
00:12:49,240 --> 00:12:52,660
<font color="#E5E5E5">easily see</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> of the DNS requests that</font>

367
00:12:50,950 --> 00:12:55,330
malware<font color="#E5E5E5"> is making in your analysis</font>

368
00:12:52,660 --> 00:12:56,439
environment<font color="#E5E5E5"> and I netsim is is great</font>

369
00:12:55,330 --> 00:12:59,080
because when you<font color="#E5E5E5"> combine it with fake</font>

370
00:12:56,440 --> 00:13:01,840
DNS<font color="#E5E5E5"> let's say it wants to</font><font color="#CCCCCC"> stand</font><font color="#E5E5E5"> up an</font>

371
00:12:59,080 --> 00:13:03,580
HTTP connection<font color="#E5E5E5"> to perform command and</font>

372
00:13:01,840 --> 00:13:05,440
control<font color="#CCCCCC"> communications well I netsim</font>

373
00:13:03,580 --> 00:13:06,940
basically simulates a bunch of different

374
00:13:05,440 --> 00:13:08,710
network services in your<font color="#E5E5E5"> analysis</font>

375
00:13:06,940 --> 00:13:10,030
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> so you've got DNS that says</font>

376
00:13:08,710 --> 00:13:11,890
oh yeah you want to<font color="#E5E5E5"> go to Google well</font>

377
00:13:10,030 --> 00:13:12,579
that's me and then<font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> facilitate</font>

378
00:13:11,890 --> 00:13:15,610
an<font color="#CCCCCC"> HCC</font>

379
00:13:12,580 --> 00:13:17,680
<font color="#E5E5E5">P handshake so you can play with command</font>

380
00:13:15,610 --> 00:13:19,600
and<font color="#CCCCCC"> control</font><font color="#E5E5E5"> communications that that</font>

381
00:13:17,680 --> 00:13:21,819
<font color="#E5E5E5">malware is making can simulate responses</font>

382
00:13:19,600 --> 00:13:23,500
that<font color="#CCCCCC"> malware may you know want to</font><font color="#E5E5E5"> want</font>

383
00:13:21,820 --> 00:13:26,380
to<font color="#E5E5E5"> see to get further into the</font><font color="#CCCCCC"> c2</font>

384
00:13:23,500 --> 00:13:28,170
communications<font color="#CCCCCC"> process not only that but</font>

385
00:13:26,380 --> 00:13:30,579
<font color="#E5E5E5">even if you're</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> doing active network</font>

386
00:13:28,170 --> 00:13:32,649
analysis with with<font color="#CCCCCC"> rim mix there's a lot</font>

387
00:13:30,579 --> 00:13:34,390
of other very very<font color="#CCCCCC"> useful tools</font><font color="#E5E5E5"> for</font>

388
00:13:32,649 --> 00:13:36,100
document analysis the obvious<font color="#E5E5E5"> gating</font>

389
00:13:34,390 --> 00:13:38,290
JavaScript and<font color="#CCCCCC"> things that you'll</font>

390
00:13:36,100 --> 00:13:39,750
commonly<font color="#E5E5E5"> do if you're in</font><font color="#CCCCCC"> Sec ops and</font>

391
00:13:38,290 --> 00:13:44,920
you're<font color="#E5E5E5"> analyzing threats that may be</font>

392
00:13:39,750 --> 00:13:46,839
seen within<font color="#E5E5E5"> your</font><font color="#CCCCCC"> environment so a couple</font>

393
00:13:44,920 --> 00:13:49,029
<font color="#E5E5E5">of tools that</font><font color="#CCCCCC"> I use</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> the system that</font>

394
00:13:46,839 --> 00:13:51,610
I'm<font color="#CCCCCC"> actually detonating now we're in I</font>

395
00:13:49,029 --> 00:13:53,500
use<font color="#E5E5E5"> red shot</font><font color="#CCCCCC"> and I'll go into</font><font color="#E5E5E5"> that in</font><font color="#CCCCCC"> a</font>

396
00:13:51,610 --> 00:13:55,450
little<font color="#CCCCCC"> bit capture bat solder it doesn't</font>

397
00:13:53,500 --> 00:13:57,519
run on<font color="#E5E5E5"> 64-bit operating systems but if</font>

398
00:13:55,450 --> 00:14:00,550
you're<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> 32-bit analysis it's super</font>

399
00:13:57,519 --> 00:14:02,440
helpful<font color="#E5E5E5"> process hacker is really handy</font>

400
00:14:00,550 --> 00:14:04,349
<font color="#E5E5E5">for quickly</font><font color="#CCCCCC"> identifying what mal was</font>

401
00:14:02,440 --> 00:14:07,209
doing in real time on a system

402
00:14:04,350 --> 00:14:08,800
sysinternals suite obviously there's a

403
00:14:07,209 --> 00:14:11,079
ton<font color="#CCCCCC"> of great utilities that</font><font color="#E5E5E5"> you can use</font>

404
00:14:08,800 --> 00:14:13,300
for<font color="#CCCCCC"> analyzing samples in your</font>

405
00:14:11,079 --> 00:14:15,969
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> fiddler</font><font color="#E5E5E5"> and HTTP</font>

406
00:14:13,300 --> 00:14:18,160
proxies are super useful for<font color="#E5E5E5"> quickly</font>

407
00:14:15,970 --> 00:14:21,310
<font color="#CCCCCC">identifying the types of HTTP</font>

408
00:14:18,160 --> 00:14:23,589
communications malware<font color="#E5E5E5"> may be doing</font><font color="#CCCCCC"> so</font>

409
00:14:21,310 --> 00:14:25,119
the idea is as I mentioned set your set

410
00:14:23,589 --> 00:14:27,370
of static<font color="#E5E5E5"> IP on the analysis machine</font>

411
00:14:25,120 --> 00:14:29,230
<font color="#E5E5E5">that you're using and set your gateway</font>

412
00:14:27,370 --> 00:14:30,760
in DNS over to your room<font color="#CCCCCC"> next box so you</font>

413
00:14:29,230 --> 00:14:32,770
<font color="#CCCCCC">can</font><font color="#E5E5E5"> analyze quickly the DNS</font>

414
00:14:30,760 --> 00:14:34,779
communications as well<font color="#CCCCCC"> as what sorts of</font>

415
00:14:32,770 --> 00:14:36,459
network<font color="#E5E5E5"> services the the mal was trying</font>

416
00:14:34,779 --> 00:14:38,709
to consume from what would<font color="#E5E5E5"> be the</font>

417
00:14:36,459 --> 00:14:40,540
attackers command control server and

418
00:14:38,709 --> 00:14:42,149
then<font color="#E5E5E5"> you turn up Wireshark or TCP dump</font>

419
00:14:40,540 --> 00:14:44,319
on on<font color="#CCCCCC"> REM NICs as well and you can see</font>

420
00:14:42,149 --> 00:14:46,630
<font color="#E5E5E5">from a peek at perspective everything</font>

421
00:14:44,320 --> 00:14:48,310
<font color="#E5E5E5">that the system is doing</font><font color="#CCCCCC"> and then since</font>

422
00:14:46,630 --> 00:14:49,779
<font color="#E5E5E5">this logs over to a system where</font><font color="#CCCCCC"> you can</font>

423
00:14:48,310 --> 00:14:51,819
review<font color="#E5E5E5"> them after you've detonated your</font>

424
00:14:49,779 --> 00:14:55,959
malware so if you're<font color="#E5E5E5"> running a snort</font><font color="#CCCCCC"> on</font>

425
00:14:51,820 --> 00:14:57,760
your IP<font color="#E5E5E5"> fire eutteum or within</font><font color="#CCCCCC"> REM</font><font color="#E5E5E5"> NICs</font>

426
00:14:55,959 --> 00:14:59,729
you just send your syslog out somewhere

427
00:14:57,760 --> 00:15:02,380
that you can<font color="#E5E5E5"> review</font><font color="#CCCCCC"> it after the fact</font>

428
00:14:59,730 --> 00:15:04,779
so I mentioned red shot<font color="#E5E5E5"> red shots super</font>

429
00:15:02,380 --> 00:15:06,939
useful<font color="#E5E5E5"> for quickly</font><font color="#CCCCCC"> snap taking a</font>

430
00:15:04,779 --> 00:15:10,449
snapshot of the the registry on a

431
00:15:06,940 --> 00:15:12,459
<font color="#E5E5E5">Windows system as well as indexing the</font>

432
00:15:10,449 --> 00:15:14,170
contents of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> directory structure and so</font>

433
00:15:12,459 --> 00:15:16,029
the idea is that<font color="#E5E5E5"> you do this before you</font>

434
00:15:14,170 --> 00:15:17,860
execute malware and then you do<font color="#CCCCCC"> it</font><font color="#E5E5E5"> again</font>

435
00:15:16,029 --> 00:15:19,420
after<font color="#E5E5E5"> you execute malware and it'll</font>

436
00:15:17,860 --> 00:15:20,800
produce a nice report that shows you

437
00:15:19,420 --> 00:15:23,199
everything<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> changed from a</font>

438
00:15:20,800 --> 00:15:24,969
registry perspective as well<font color="#E5E5E5"> as anything</font>

439
00:15:23,199 --> 00:15:25,560
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> changed within the directory</font>

440
00:15:24,970 --> 00:15:27,990
<font color="#CCCCCC">content</font>

441
00:15:25,560 --> 00:15:30,029
so the hard drive<font color="#CCCCCC"> of whatever directory</font>

442
00:15:27,990 --> 00:15:31,680
<font color="#E5E5E5">that you suggest I typically will start</font>

443
00:15:30,029 --> 00:15:33,750
out just indexing the entire hard drive

444
00:15:31,680 --> 00:15:35,400
<font color="#CCCCCC">and then</font><font color="#E5E5E5"> kind of a</font><font color="#CCCCCC"> pinpoint</font><font color="#E5E5E5"> from there</font>

445
00:15:33,750 --> 00:15:37,770
where I<font color="#CCCCCC"> happen to see malware starting</font>

446
00:15:35,400 --> 00:15:39,300
<font color="#E5E5E5">to</font><font color="#CCCCCC"> right but</font><font color="#E5E5E5"> it'll give you a nice handy</font>

447
00:15:37,770 --> 00:15:41,760
report so you<font color="#CCCCCC"> can quickly identify you</font>

448
00:15:39,300 --> 00:15:43,770
know<font color="#E5E5E5"> what's</font><font color="#CCCCCC"> changed and based on the</font>

449
00:15:41,760 --> 00:15:45,390
contents of new registry<font color="#E5E5E5"> keys or new</font>

450
00:15:43,770 --> 00:15:47,010
files that are created<font color="#E5E5E5"> in a new path</font>

451
00:15:45,390 --> 00:15:49,140
<font color="#E5E5E5">setter touch a lot of times you can take</font>

452
00:15:47,010 --> 00:15:51,180
those<font color="#CCCCCC"> i/o CS and you can pivot on those</font>

453
00:15:49,140 --> 00:15:53,250
so you spend five minutes<font color="#CCCCCC"> executing a</font>

454
00:15:51,180 --> 00:15:55,709
malware sample and you may be able<font color="#CCCCCC"> to</font>

455
00:15:53,250 --> 00:15:57,750
<font color="#CCCCCC">identify what the malware family is what</font>

456
00:15:55,710 --> 00:16:01,020
its<font color="#CCCCCC"> capabilities are and</font><font color="#E5E5E5"> what risk it</font>

457
00:15:57,750 --> 00:16:03,000
poses to<font color="#E5E5E5"> your organization</font><font color="#CCCCCC"> so process</font>

458
00:16:01,020 --> 00:16:06,150
hacker is is it's kind of like<font color="#CCCCCC"> task</font>

459
00:16:03,000 --> 00:16:08,040
<font color="#E5E5E5">manager on on steroids</font><font color="#CCCCCC"> it's super useful</font>

460
00:16:06,150 --> 00:16:10,230
for<font color="#CCCCCC"> quickly identifying</font><font color="#E5E5E5"> you know what</font>

461
00:16:08,040 --> 00:16:12,810
now<font color="#CCCCCC"> where's writing</font><font color="#E5E5E5"> to any sort of</font>

462
00:16:10,230 --> 00:16:14,450
<font color="#CCCCCC">network connections</font><font color="#E5E5E5"> that get created</font><font color="#CCCCCC"> by</font>

463
00:16:12,810 --> 00:16:17,699
the the malware while it's executing

464
00:16:14,450 --> 00:16:19,230
<font color="#E5E5E5">etcetera and</font><font color="#CCCCCC"> it's it's very useful</font><font color="#E5E5E5"> from</font>

465
00:16:17,700 --> 00:16:21,089
a visual<font color="#E5E5E5"> perspective so while you're</font>

466
00:16:19,230 --> 00:16:23,420
analyzing<font color="#E5E5E5"> a particular malware sample</font>

467
00:16:21,089 --> 00:16:25,500
<font color="#E5E5E5">you can have this up in it color codes</font>

468
00:16:23,420 --> 00:16:27,150
<font color="#E5E5E5">changes to the system and you</font><font color="#CCCCCC"> can very</font>

469
00:16:25,500 --> 00:16:28,920
<font color="#CCCCCC">very quickly identify those in</font><font color="#E5E5E5"> real time</font>

470
00:16:27,150 --> 00:16:30,780
before<font color="#CCCCCC"> you even go back and review the</font>

471
00:16:28,920 --> 00:16:33,240
log data that you're generating<font color="#CCCCCC"> with red</font>

472
00:16:30,780 --> 00:16:35,100
shot and other utilities later so<font color="#E5E5E5"> this</font>

473
00:16:33,240 --> 00:16:36,420
is just<font color="#E5E5E5"> an</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> of all</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> the</font>

474
00:16:35,100 --> 00:16:38,550
network<font color="#E5E5E5"> connections that are being seen</font>

475
00:16:36,420 --> 00:16:40,110
<font color="#CCCCCC">on a specific VM that</font><font color="#E5E5E5"> I was running and</font>

476
00:16:38,550 --> 00:16:42,150
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> see it's it's</font><font color="#CCCCCC"> color-coded it's</font>

477
00:16:40,110 --> 00:16:44,490
it's really intuitive and really easy<font color="#E5E5E5"> to</font>

478
00:16:42,150 --> 00:16:46,500
quickly identify changes<font color="#E5E5E5"> in real time on</font>

479
00:16:44,490 --> 00:16:49,140
a system and then you can also see files

480
00:16:46,500 --> 00:16:50,970
that are<font color="#CCCCCC"> written to disk in in real time</font>

481
00:16:49,140 --> 00:16:53,250
as<font color="#CCCCCC"> well so having</font><font color="#E5E5E5"> that just right in</font>

482
00:16:50,970 --> 00:16:55,130
front<font color="#CCCCCC"> of you is kind of</font><font color="#E5E5E5"> a single</font><font color="#CCCCCC"> pane of</font>

483
00:16:53,250 --> 00:16:57,120
<font color="#CCCCCC">glass</font><font color="#E5E5E5"> and what's going on</font><font color="#CCCCCC"> in the system</font>

484
00:16:55,130 --> 00:16:58,800
<font color="#E5E5E5">obviously you'll</font><font color="#CCCCCC"> have historical log</font>

485
00:16:57,120 --> 00:17:00,600
data later when you're running<font color="#E5E5E5"> your</font><font color="#CCCCCC"> red</font>

486
00:16:58,800 --> 00:17:02,579
shot reports and stuff<font color="#E5E5E5"> like that but if</font>

487
00:17:00,600 --> 00:17:04,079
you see<font color="#E5E5E5"> something that pops up in</font>

488
00:17:02,580 --> 00:17:05,699
process hacker while you're<font color="#CCCCCC"> executing</font>

489
00:17:04,079 --> 00:17:07,500
malware you can quickly<font color="#E5E5E5"> you know start</font>

490
00:17:05,699 --> 00:17:09,660
to<font color="#E5E5E5"> search on those IO CS and you may</font><font color="#CCCCCC"> not</font>

491
00:17:07,500 --> 00:17:11,660
<font color="#E5E5E5">even need a review log data later like I</font>

492
00:17:09,660 --> 00:17:13,740
mentioned it's all about<font color="#E5E5E5"> trying to avoid</font>

493
00:17:11,660 --> 00:17:16,920
<font color="#E5E5E5">expending additional resources if</font>

494
00:17:13,740 --> 00:17:19,199
they're not necessarily<font color="#CCCCCC"> required in a</font>

495
00:17:16,920 --> 00:17:20,339
<font color="#CCCCCC">security operations environment</font><font color="#E5E5E5"> most of</font>

496
00:17:19,199 --> 00:17:22,980
the teams that I've been<font color="#E5E5E5"> on</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> been</font>

497
00:17:20,339 --> 00:17:25,109
overworked and understaffed so<font color="#E5E5E5"> being</font>

498
00:17:22,980 --> 00:17:27,560
able to<font color="#E5E5E5"> perform this</font><font color="#CCCCCC"> process quickly</font><font color="#E5E5E5"> in</font>

499
00:17:25,109 --> 00:17:31,050
an operational<font color="#E5E5E5"> environment is</font><font color="#CCCCCC"> essential</font>

500
00:17:27,560 --> 00:17:33,360
and then<font color="#CCCCCC"> process monitor is another good</font>

501
00:17:31,050 --> 00:17:36,030
utility<font color="#E5E5E5"> for monitoring all of</font><font color="#CCCCCC"> the</font>

502
00:17:33,360 --> 00:17:37,800
different<font color="#CCCCCC"> changes on a</font><font color="#E5E5E5"> Windows system it</font>

503
00:17:36,030 --> 00:17:39,000
can<font color="#CCCCCC"> be very very verbose so one of</font><font color="#E5E5E5"> the</font>

504
00:17:37,800 --> 00:17:39,500
things that they provide is kind<font color="#E5E5E5"> of a</font>

505
00:17:39,000 --> 00:17:42,269
fill

506
00:17:39,500 --> 00:17:44,399
<font color="#E5E5E5">functionality so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can deploy filters</font>

507
00:17:42,269 --> 00:17:46,740
that will<font color="#E5E5E5"> only show you things that you</font>

508
00:17:44,399 --> 00:17:48,779
may<font color="#E5E5E5"> be</font><font color="#CCCCCC"> interested in and this requires</font>

509
00:17:46,740 --> 00:17:50,399
kind<font color="#E5E5E5"> of a balancing act</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> you don't</font>

510
00:17:48,779 --> 00:17:51,690
want a whole<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> extra noise but if</font>

511
00:17:50,399 --> 00:17:53,580
you start to<font color="#CCCCCC"> get too aggressive with</font>

512
00:17:51,690 --> 00:17:54,840
<font color="#E5E5E5">your filtering you may miss things that</font>

513
00:17:53,580 --> 00:17:57,480
you actually<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be paying attention</font>

514
00:17:54,840 --> 00:17:59,760
<font color="#E5E5E5">to so there's a lot</font><font color="#CCCCCC"> of filters that you</font>

515
00:17:57,480 --> 00:18:01,200
<font color="#CCCCCC">can</font><font color="#E5E5E5"> find on the on the interwebs</font><font color="#CCCCCC"> and you</font>

516
00:17:59,760 --> 00:18:02,908
can<font color="#E5E5E5"> download them import them</font><font color="#CCCCCC"> into a</font>

517
00:18:01,200 --> 00:18:04,529
process monitor there's a lot of use

518
00:18:02,909 --> 00:18:06,809
<font color="#CCCCCC">cases</font><font color="#E5E5E5"> that have</font><font color="#CCCCCC"> already</font><font color="#E5E5E5"> been created but</font>

519
00:18:04,529 --> 00:18:09,179
it<font color="#E5E5E5"> keeps you</font><font color="#CCCCCC"> from having</font><font color="#E5E5E5"> to potentially</font>

520
00:18:06,809 --> 00:18:11,250
analyze millions of lines of changes

521
00:18:09,179 --> 00:18:13,019
when you really<font color="#E5E5E5"> maybe only need to be</font>

522
00:18:11,250 --> 00:18:16,169
concerned with<font color="#E5E5E5"> you know a few thousand</font>

523
00:18:13,019 --> 00:18:18,299
all about speeding that process<font color="#E5E5E5"> up</font><font color="#CCCCCC"> so I</font>

524
00:18:16,169 --> 00:18:20,130
<font color="#E5E5E5">mentioned fake DNS earlier that's that's</font>

525
00:18:18,299 --> 00:18:22,019
that<font color="#E5E5E5"> that process</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you run on</font>

526
00:18:20,130 --> 00:18:24,450
<font color="#CCCCCC">Remnick sand you point</font><font color="#E5E5E5"> your DNS</font><font color="#CCCCCC"> server</font>

527
00:18:22,019 --> 00:18:26,610
on<font color="#CCCCCC"> your Windows environment to</font><font color="#E5E5E5"> your room</font>

528
00:18:24,450 --> 00:18:28,230
next<font color="#CCCCCC"> vm or whatever linux system you may</font>

529
00:18:26,610 --> 00:18:30,600
be using<font color="#E5E5E5"> you can deploy this package on</font>

530
00:18:28,230 --> 00:18:32,370
any number of Linux environments but

531
00:18:30,600 --> 00:18:34,678
this is kind of what it looks<font color="#CCCCCC"> like when</font>

532
00:18:32,370 --> 00:18:36,840
when you're you know executing a process

533
00:18:34,679 --> 00:18:38,909
on<font color="#E5E5E5"> your</font><font color="#CCCCCC"> Windows VM and it's making DNS</font>

534
00:18:36,840 --> 00:18:41,070
requests so it's it's real quick real

535
00:18:38,909 --> 00:18:43,769
easy way to<font color="#E5E5E5"> to very</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> quickly</font>

536
00:18:41,070 --> 00:18:45,600
identify what now where maybe you know

537
00:18:43,769 --> 00:18:47,070
requesting<font color="#E5E5E5"> from a domain resolution</font>

538
00:18:45,600 --> 00:18:49,678
perspective<font color="#CCCCCC"> it's all</font><font color="#E5E5E5"> about putting the</font>

539
00:18:47,070 --> 00:18:51,629
<font color="#CCCCCC">information in front of</font><font color="#E5E5E5"> you and is least</font>

540
00:18:49,679 --> 00:18:54,960
convoluted of a way as possible<font color="#CCCCCC"> so you</font>

541
00:18:51,630 --> 00:18:57,419
<font color="#E5E5E5">can quickly</font><font color="#CCCCCC"> perform that analysis so i</font>

542
00:18:54,960 --> 00:18:59,370
netsim<font color="#E5E5E5"> i netsim is great because it</font>

543
00:18:57,419 --> 00:19:01,169
<font color="#CCCCCC">allows you to</font><font color="#E5E5E5"> simulate network services</font>

544
00:18:59,370 --> 00:19:03,779
<font color="#E5E5E5">within your analysis environment so</font><font color="#CCCCCC"> you</font>

545
00:19:01,169 --> 00:19:05,929
can simulate<font color="#E5E5E5"> IRC servers you</font><font color="#CCCCCC"> can</font>

546
00:19:03,779 --> 00:19:08,279
simulate web servers you<font color="#E5E5E5"> can simulate</font>

547
00:19:05,929 --> 00:19:09,840
<font color="#E5E5E5">SMTP servers you can simulate pretty</font>

548
00:19:08,279 --> 00:19:11,490
much anything that<font color="#CCCCCC"> malware might</font>

549
00:19:09,840 --> 00:19:13,350
<font color="#E5E5E5">typically use for command and control</font>

550
00:19:11,490 --> 00:19:16,880
and<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> really powerful</font><font color="#CCCCCC"> because you can</font>

551
00:19:13,350 --> 00:19:19,350
also<font color="#CCCCCC"> use</font><font color="#E5E5E5"> eye nets in and</font><font color="#CCCCCC"> write response</font>

552
00:19:16,880 --> 00:19:22,139
information<font color="#E5E5E5"> and response instructions</font>

553
00:19:19,350 --> 00:19:23,879
within Remnick so you can<font color="#CCCCCC"> facilitate</font>

554
00:19:22,139 --> 00:19:26,760
getting<font color="#E5E5E5"> further into</font><font color="#CCCCCC"> that command</font><font color="#E5E5E5"> and</font>

555
00:19:23,880 --> 00:19:28,590
control traffic process so you can

556
00:19:26,760 --> 00:19:29,970
<font color="#E5E5E5">simulate responses based on you know</font>

557
00:19:28,590 --> 00:19:31,649
what<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> finding about</font><font color="#E5E5E5"> what the</font>

558
00:19:29,970 --> 00:19:33,090
<font color="#CCCCCC">malware</font><font color="#E5E5E5"> is expecting to receive from</font>

559
00:19:31,649 --> 00:19:35,250
<font color="#E5E5E5">command and control and get more</font>

560
00:19:33,090 --> 00:19:36,389
information<font color="#E5E5E5"> but you typically don't</font>

561
00:19:35,250 --> 00:19:38,820
necessarily need<font color="#E5E5E5"> to do that</font><font color="#CCCCCC"> if you're</font>

562
00:19:36,389 --> 00:19:40,620
<font color="#CCCCCC">just performing a malware identification</font>

563
00:19:38,820 --> 00:19:42,299
and this is kind of what it<font color="#CCCCCC"> looks like</font>

564
00:19:40,620 --> 00:19:46,350
when you know you've got a net sim

565
00:19:42,299 --> 00:19:49,289
running and you<font color="#E5E5E5"> analyze a malware sample</font>

566
00:19:46,350 --> 00:19:51,029
that uses HTTP requests<font color="#E5E5E5"> for command</font><font color="#CCCCCC"> and</font>

567
00:19:49,289 --> 00:19:52,510
control<font color="#E5E5E5"> you can very quickly see you</font>

568
00:19:51,029 --> 00:19:55,540
know what<font color="#E5E5E5"> you are eyes are being</font>

569
00:19:52,510 --> 00:19:58,360
and things of that<font color="#CCCCCC"> nature also Wireshark</font>

570
00:19:55,540 --> 00:20:00,010
if you don't use Wireshark<font color="#E5E5E5"> you probably</font>

571
00:19:58,360 --> 00:20:02,260
want to get familiar<font color="#CCCCCC"> with it one of the</font>

572
00:20:00,010 --> 00:20:05,530
most<font color="#CCCCCC"> powerful</font><font color="#E5E5E5"> things that</font><font color="#CCCCCC"> I find is the</font>

573
00:20:02,260 --> 00:20:07,060
<font color="#CCCCCC">ability to export objects</font><font color="#E5E5E5"> so if you do</font>

574
00:20:05,530 --> 00:20:10,990
have a malware sample that's making use

575
00:20:07,060 --> 00:20:13,149
of<font color="#E5E5E5"> HTTP for additional stage downloads</font>

576
00:20:10,990 --> 00:20:14,890
or command and control or<font color="#CCCCCC"> things like</font>

577
00:20:13,150 --> 00:20:17,500
that<font color="#E5E5E5"> deployment of additional modules</font>

578
00:20:14,890 --> 00:20:19,210
you can<font color="#E5E5E5"> very quickly export those HTTP</font>

579
00:20:17,500 --> 00:20:21,540
objects out once you've created your

580
00:20:19,210 --> 00:20:24,550
<font color="#CCCCCC">pcap and you can</font><font color="#E5E5E5"> analyze those as well</font>

581
00:20:21,540 --> 00:20:25,870
so<font color="#CCCCCC"> anytime you're analyzing malware in a</font>

582
00:20:24,550 --> 00:20:28,480
virtual environment you're going<font color="#CCCCCC"> to run</font>

583
00:20:25,870 --> 00:20:30,699
into<font color="#E5E5E5"> situations where the malware simply</font>

584
00:20:28,480 --> 00:20:32,560
<font color="#E5E5E5">won't do what</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> would expect it to do</font>

585
00:20:30,700 --> 00:20:34,000
it may new do nothing at all<font color="#E5E5E5"> and there's</font>

586
00:20:32,560 --> 00:20:35,830
a lot of<font color="#E5E5E5"> different</font><font color="#CCCCCC"> reasons for that</font><font color="#E5E5E5"> now</font>

587
00:20:34,000 --> 00:20:39,640
our authors have have<font color="#CCCCCC"> taken a lot of</font>

588
00:20:35,830 --> 00:20:41,530
<font color="#E5E5E5">steps to evade automated analysis</font>

589
00:20:39,640 --> 00:20:42,730
environments so like sand<font color="#E5E5E5"> boxes and</font>

590
00:20:41,530 --> 00:20:44,260
things<font color="#E5E5E5"> like that you know they'll</font>

591
00:20:42,730 --> 00:20:46,240
profile the system they'll look<font color="#CCCCCC"> for</font>

592
00:20:44,260 --> 00:20:50,620
devices that<font color="#CCCCCC"> are associated</font><font color="#E5E5E5"> with VMware</font>

593
00:20:46,240 --> 00:20:52,900
virtual box or<font color="#E5E5E5"> parallels they'll check</font>

594
00:20:50,620 --> 00:20:54,429
for<font color="#E5E5E5"> debugger they'll look at system time</font>

595
00:20:52,900 --> 00:20:55,930
they'll look at you know<font color="#E5E5E5"> the number of</font>

596
00:20:54,430 --> 00:20:57,790
cores in your system they'll look for

597
00:20:55,930 --> 00:20:59,920
<font color="#E5E5E5">mouse movements they'll look</font><font color="#CCCCCC"> for a lot</font>

598
00:20:57,790 --> 00:21:02,350
of<font color="#CCCCCC"> different activity to try</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> identify</font>

599
00:20:59,920 --> 00:21:04,000
whether they're being executed<font color="#CCCCCC"> you know</font>

600
00:21:02,350 --> 00:21:06,189
within a legitimate system that may<font color="#E5E5E5"> be</font>

601
00:21:04,000 --> 00:21:08,190
an end user is using<font color="#E5E5E5"> versus just being</font>

602
00:21:06,190 --> 00:21:11,440
<font color="#E5E5E5">pushed into a sandbox</font><font color="#CCCCCC"> and detonated for</font>

603
00:21:08,190 --> 00:21:13,570
the creation of like a cuckoo<font color="#E5E5E5"> report a</font>

604
00:21:11,440 --> 00:21:15,820
lot<font color="#E5E5E5"> of times you'll see sleep patterns</font>

605
00:21:13,570 --> 00:21:17,200
that are<font color="#CCCCCC"> there baked into</font><font color="#E5E5E5"> a lot of the</font>

606
00:21:15,820 --> 00:21:20,169
different malware<font color="#CCCCCC"> that we see in the</font>

607
00:21:17,200 --> 00:21:21,880
wild<font color="#CCCCCC"> so you know you may not be</font><font color="#E5E5E5"> able to</font>

608
00:21:20,170 --> 00:21:23,680
just run it for<font color="#E5E5E5"> five minutes</font><font color="#CCCCCC"> and expect</font>

609
00:21:21,880 --> 00:21:25,210
it<font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually kick into</font><font color="#E5E5E5"> the the</font>

610
00:21:23,680 --> 00:21:27,670
malicious activity that you would expect

611
00:21:25,210 --> 00:21:30,060
<font color="#E5E5E5">you may have to run it for longer and in</font>

612
00:21:27,670 --> 00:21:33,550
some cases it may<font color="#E5E5E5"> just be easier</font><font color="#CCCCCC"> to</font>

613
00:21:30,060 --> 00:21:35,470
stand<font color="#E5E5E5"> up bare metal and execute it there</font>

614
00:21:33,550 --> 00:21:36,790
so if you're<font color="#E5E5E5"> having a hard</font><font color="#CCCCCC"> time trying</font>

615
00:21:35,470 --> 00:21:38,620
<font color="#CCCCCC">to identify</font><font color="#E5E5E5"> you know what sort of</font>

616
00:21:36,790 --> 00:21:40,750
evasion is this is this<font color="#E5E5E5"> now we're doing</font>

617
00:21:38,620 --> 00:21:42,310
<font color="#E5E5E5">what's it looking for what's it</font>

618
00:21:40,750 --> 00:21:43,930
triggering<font color="#CCCCCC"> on is it looking</font><font color="#E5E5E5"> for the</font>

619
00:21:42,310 --> 00:21:46,179
existence of<font color="#CCCCCC"> different applications</font>

620
00:21:43,930 --> 00:21:47,620
installed processes running<font color="#E5E5E5"> you know at</font>

621
00:21:46,180 --> 00:21:49,300
the<font color="#CCCCCC"> end</font><font color="#E5E5E5"> of the day it may be easier just</font>

622
00:21:47,620 --> 00:21:52,989
<font color="#E5E5E5">to run</font><font color="#CCCCCC"> it in bare metal and</font><font color="#E5E5E5"> not even</font>

623
00:21:49,300 --> 00:21:54,070
worry<font color="#CCCCCC"> about it so there's a couple</font>

624
00:21:52,990 --> 00:21:56,230
<font color="#E5E5E5">things that you can do there's some</font>

625
00:21:54,070 --> 00:21:58,540
<font color="#CCCCCC">plugins you can</font><font color="#E5E5E5"> use within like</font><font color="#CCCCCC"> oli</font>

626
00:21:56,230 --> 00:22:02,590
debug that will hide the the presence<font color="#E5E5E5"> of</font>

627
00:21:58,540 --> 00:22:04,629
a debugger<font color="#E5E5E5"> don't use VM drivers so I</font>

628
00:22:02,590 --> 00:22:06,100
know a lot of people it's<font color="#E5E5E5"> it's</font>

629
00:22:04,630 --> 00:22:08,230
very very convenient<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to have</font>

630
00:22:06,100 --> 00:22:10,689
<font color="#E5E5E5">things like copy paste and directory</font>

631
00:22:08,230 --> 00:22:12,940
sharing within<font color="#E5E5E5"> let's say</font><font color="#CCCCCC"> VMware but</font>

632
00:22:10,690 --> 00:22:17,440
<font color="#E5E5E5">whenever you install the</font><font color="#CCCCCC"> the guest</font>

633
00:22:12,940 --> 00:22:20,380
utilities<font color="#CCCCCC"> that facilitate that that sort</font>

634
00:22:17,440 --> 00:22:21,910
of activity<font color="#CCCCCC"> you're basically putting a</font>

635
00:22:20,380 --> 00:22:23,560
lot of<font color="#E5E5E5"> artifacts on the system</font><font color="#CCCCCC"> that</font>

636
00:22:21,910 --> 00:22:25,960
<font color="#E5E5E5">makes it very very obvious that it's</font>

637
00:22:23,560 --> 00:22:28,210
<font color="#E5E5E5">running in a</font><font color="#CCCCCC"> virtual environment so you</font>

638
00:22:25,960 --> 00:22:29,860
know device drivers get installed things

639
00:22:28,210 --> 00:22:31,360
like that<font color="#CCCCCC"> I find it's best just</font><font color="#E5E5E5"> not to</font>

640
00:22:29,860 --> 00:22:34,959
<font color="#E5E5E5">install any sort</font><font color="#CCCCCC"> of like guest additions</font>

641
00:22:31,360 --> 00:22:37,389
or tools that<font color="#E5E5E5"> allow you to copy paste</font>

642
00:22:34,960 --> 00:22:39,700
just just deal with<font color="#CCCCCC"> it</font><font color="#E5E5E5"> right</font>

643
00:22:37,390 --> 00:22:41,080
also there's applications you can<font color="#E5E5E5"> use to</font>

644
00:22:39,700 --> 00:22:42,760
simulate mouse movements there's also

645
00:22:41,080 --> 00:22:44,379
<font color="#CCCCCC">open-source code that you</font><font color="#E5E5E5"> can use that</font>

646
00:22:42,760 --> 00:22:45,790
will make it<font color="#E5E5E5"> look like your mouse is</font>

647
00:22:44,380 --> 00:22:47,350
moving<font color="#E5E5E5"> around the screen because there</font>

648
00:22:45,790 --> 00:22:47,730
are malware families that do check for

649
00:22:47,350 --> 00:22:50,080
that

650
00:22:47,730 --> 00:22:52,540
also make sure your VM has more than one

651
00:22:50,080 --> 00:22:54,159
core so one<font color="#CCCCCC"> of the things that we that</font>

652
00:22:52,540 --> 00:22:56,350
we've seen with with certain<font color="#CCCCCC"> hour is</font>

653
00:22:54,160 --> 00:22:58,240
<font color="#E5E5E5">that if you are</font><font color="#CCCCCC"> executing in a system</font>

654
00:22:56,350 --> 00:23:01,030
<font color="#E5E5E5">that</font><font color="#CCCCCC"> only has one core they assume that</font>

655
00:22:58,240 --> 00:23:03,040
most conventional<font color="#E5E5E5"> commercial pcs</font>

656
00:23:01,030 --> 00:23:05,620
nowadays have more than one core right

657
00:23:03,040 --> 00:23:08,080
<font color="#E5E5E5">who's got a laptop</font><font color="#CCCCCC"> or desktop with with</font>

658
00:23:05,620 --> 00:23:11,080
less than two<font color="#E5E5E5"> cores</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> very many people</font>

659
00:23:08,080 --> 00:23:12,699
<font color="#E5E5E5">so they know</font><font color="#CCCCCC"> that it's common that</font><font color="#E5E5E5"> when</font>

660
00:23:11,080 --> 00:23:14,830
you're trying to<font color="#E5E5E5"> conserve resources you</font>

661
00:23:12,700 --> 00:23:16,720
deploy<font color="#CCCCCC"> beans for analysis the least</font>

662
00:23:14,830 --> 00:23:19,780
<font color="#E5E5E5">amount of resources necessary so if</font>

663
00:23:16,720 --> 00:23:23,080
malware detects less than<font color="#E5E5E5"> two cores may</font>

664
00:23:19,780 --> 00:23:25,480
not run also snapshot after a few hours

665
00:23:23,080 --> 00:23:27,610
<font color="#E5E5E5">of simulated activity so one thing that</font>

666
00:23:25,480 --> 00:23:29,440
malware<font color="#E5E5E5"> may do is it may look for the</font>

667
00:23:27,610 --> 00:23:32,439
<font color="#E5E5E5">presence of documents within the My</font>

668
00:23:29,440 --> 00:23:35,740
<font color="#E5E5E5">Documents</font><font color="#CCCCCC"> folder or</font><font color="#E5E5E5"> internet browsing</font>

669
00:23:32,440 --> 00:23:37,660
cache or things like that<font color="#E5E5E5"> to show</font><font color="#CCCCCC"> that</font>

670
00:23:35,740 --> 00:23:39,550
the<font color="#E5E5E5"> system's been in use recently right</font>

671
00:23:37,660 --> 00:23:41,800
if you<font color="#E5E5E5"> just deploy a fresh VM and don't</font>

672
00:23:39,550 --> 00:23:43,960
do<font color="#CCCCCC"> anything</font><font color="#E5E5E5"> on it it doesn't look</font><font color="#CCCCCC"> like</font>

673
00:23:41,800 --> 00:23:48,129
it's a legitimate<font color="#E5E5E5"> system that</font><font color="#CCCCCC"> a malware</font>

674
00:23:43,960 --> 00:23:50,500
author may want<font color="#E5E5E5"> to infect also once</font>

675
00:23:48,130 --> 00:23:52,450
again<font color="#E5E5E5"> be patient</font><font color="#CCCCCC"> and you may have</font><font color="#E5E5E5"> to go</font>

676
00:23:50,500 --> 00:23:54,160
<font color="#CCCCCC">bare-metal if you know just based on</font>

677
00:23:52,450 --> 00:23:56,620
time you<font color="#E5E5E5"> could spend time analyzing</font>

678
00:23:54,160 --> 00:23:58,900
<font color="#E5E5E5">evasion analyzing anti sandbox</font>

679
00:23:56,620 --> 00:24:00,189
<font color="#E5E5E5">techniques but if you're in a</font><font color="#CCCCCC"> Security</font>

680
00:23:58,900 --> 00:24:02,380
<font color="#CCCCCC">Operations environment and you just need</font>

681
00:24:00,190 --> 00:24:06,220
<font color="#E5E5E5">answers quickly you may just deploy bare</font>

682
00:24:02,380 --> 00:24:07,810
metal and<font color="#CCCCCC"> do that</font><font color="#E5E5E5"> so finding malware</font>

683
00:24:06,220 --> 00:24:09,700
<font color="#CCCCCC">samples if you're interested in</font><font color="#E5E5E5"> getting</font>

684
00:24:07,810 --> 00:24:11,440
<font color="#E5E5E5">more acquainted</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> the dynamic</font>

685
00:24:09,700 --> 00:24:12,790
analysis process you can get them all

686
00:24:11,440 --> 00:24:14,310
over the<font color="#E5E5E5"> place there's no shortage of</font>

687
00:24:12,790 --> 00:24:18,040
malware across the internet nowadays

688
00:24:14,310 --> 00:24:20,409
<font color="#CCCCCC">Twitter</font><font color="#E5E5E5"> is great for for finding IOC</font>

689
00:24:18,040 --> 00:24:21,340
correlating IOC s<font color="#E5E5E5"> and then identifying</font>

690
00:24:20,410 --> 00:24:24,850
new samples

691
00:24:21,340 --> 00:24:27,189
you know people<font color="#CCCCCC"> tag</font><font color="#E5E5E5"> malware malware IOC</font>

692
00:24:24,850 --> 00:24:29,439
s with hashtags based on on the malware

693
00:24:27,190 --> 00:24:31,570
family so like trick<font color="#CCCCCC"> bot</font><font color="#E5E5E5"> or globe</font>

694
00:24:29,440 --> 00:24:32,860
imposter or<font color="#CCCCCC"> something like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you just</font>

695
00:24:31,570 --> 00:24:34,750
<font color="#CCCCCC">search Twitter</font><font color="#E5E5E5"> and you're gonna come</font><font color="#CCCCCC"> up</font>

696
00:24:32,860 --> 00:24:38,649
with<font color="#E5E5E5"> samples</font><font color="#CCCCCC"> there's there's no shortage</font>

697
00:24:34,750 --> 00:24:40,330
also you can use a<font color="#E5E5E5"> virus total</font><font color="#CCCCCC"> vti for</font>

698
00:24:38,650 --> 00:24:41,980
<font color="#CCCCCC">Yarra hunting if there's a specific</font>

699
00:24:40,330 --> 00:24:44,649
malware family that you're looking to

700
00:24:41,980 --> 00:24:47,080
<font color="#CCCCCC">get more samples for when in doubt</font><font color="#E5E5E5"> right</font>

701
00:24:44,650 --> 00:24:49,570
open your<font color="#E5E5E5"> spam folder</font><font color="#CCCCCC"> people are</font>

702
00:24:47,080 --> 00:24:52,780
definitely spamming malware on a regular

703
00:24:49,570 --> 00:24:55,090
basis<font color="#E5E5E5"> sign up for as much junk as you</font>

704
00:24:52,780 --> 00:24:56,770
can with a throwaway account<font color="#E5E5E5"> you may</font>

705
00:24:55,090 --> 00:24:58,659
need to deploy<font color="#CCCCCC"> your own email service</font>

706
00:24:56,770 --> 00:25:00,370
because<font color="#CCCCCC"> gmail</font><font color="#E5E5E5"> will filter your spam</font>

707
00:24:58,660 --> 00:25:01,990
pretty well<font color="#E5E5E5"> so if you're</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> looking</font>

708
00:25:00,370 --> 00:25:05,020
<font color="#CCCCCC">for raw samples you may need to stand up</font>

709
00:25:01,990 --> 00:25:06,670
<font color="#CCCCCC">a domain set up an email and then just</font>

710
00:25:05,020 --> 00:25:10,090
start spamming that<font color="#E5E5E5"> out on whatever list</font>

711
00:25:06,670 --> 00:25:11,980
she can and then<font color="#CCCCCC"> mhm in modern honeypot</font>

712
00:25:10,090 --> 00:25:14,320
network is really<font color="#E5E5E5"> great for quickly</font>

713
00:25:11,980 --> 00:25:15,820
deploying<font color="#E5E5E5"> different sorts of honeypot so</font>

714
00:25:14,320 --> 00:25:17,620
you can deploy<font color="#E5E5E5"> WordPress honey pots</font>

715
00:25:15,820 --> 00:25:20,110
things like that<font color="#CCCCCC"> to to quickly identify</font>

716
00:25:17,620 --> 00:25:21,489
you know<font color="#E5E5E5"> what attackers are dropping or</font>

717
00:25:20,110 --> 00:25:25,179
what attackers are uploading too

718
00:25:21,490 --> 00:25:26,590
vulnerable servers in real time so right

719
00:25:25,180 --> 00:25:28,360
you've got an hour<font color="#E5E5E5"> in your</font><font color="#CCCCCC"> environment</font>

720
00:25:26,590 --> 00:25:29,740
you've done some dynamic analysis and

721
00:25:28,360 --> 00:25:31,419
you're trying<font color="#E5E5E5"> to figure out what you're</font>

722
00:25:29,740 --> 00:25:33,880
actually<font color="#CCCCCC"> looking at you've got</font><font color="#E5E5E5"> some IOC</font>

723
00:25:31,420 --> 00:25:34,960
data because you executed malware and

724
00:25:33,880 --> 00:25:36,610
you've got<font color="#E5E5E5"> you know network</font>

725
00:25:34,960 --> 00:25:40,060
communications that now is making<font color="#E5E5E5"> you</font>

726
00:25:36,610 --> 00:25:43,209
got<font color="#E5E5E5"> registry entries that are</font><font color="#CCCCCC"> being</font>

727
00:25:40,060 --> 00:25:44,320
<font color="#E5E5E5">created</font><font color="#CCCCCC"> WMI</font><font color="#E5E5E5"> registration that's taking</font>

728
00:25:43,210 --> 00:25:46,510
place you've<font color="#E5E5E5"> got you've got a list of</font>

729
00:25:44,320 --> 00:25:48,370
IOC so what do you do with<font color="#CCCCCC"> it well</font><font color="#E5E5E5"> open</font>

730
00:25:46,510 --> 00:25:50,020
<font color="#E5E5E5">source intelligence is is great for</font>

731
00:25:48,370 --> 00:25:52,239
being able<font color="#CCCCCC"> to go</font><font color="#E5E5E5"> from I have a list of</font>

732
00:25:50,020 --> 00:25:53,740
IOC<font color="#E5E5E5"> s to this is the</font><font color="#CCCCCC"> malware</font><font color="#E5E5E5"> that I'm</font>

733
00:25:52,240 --> 00:25:55,270
actually<font color="#CCCCCC"> looking at and here's a</font>

734
00:25:53,740 --> 00:25:56,830
technical write-up of<font color="#E5E5E5"> all the</font>

735
00:25:55,270 --> 00:25:58,629
functionality<font color="#CCCCCC"> associated with it</font>

736
00:25:56,830 --> 00:25:59,679
and when I say<font color="#CCCCCC"> OSN or open source</font>

737
00:25:58,630 --> 00:26:01,510
intelligence I'm not talking about

738
00:25:59,680 --> 00:26:03,400
<font color="#CCCCCC">daxing people I'm talking about the</font><font color="#E5E5E5"> the</font>

739
00:26:01,510 --> 00:26:05,890
<font color="#CCCCCC">threat intelligence that's being</font>

740
00:26:03,400 --> 00:26:08,500
generated<font color="#E5E5E5"> on</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> on a daily basis by</font><font color="#CCCCCC"> the</font>

741
00:26:05,890 --> 00:26:10,060
entire security<font color="#E5E5E5"> community and it's great</font>

742
00:26:08,500 --> 00:26:13,150
because it's one<font color="#E5E5E5"> of the best ways to get</font>

743
00:26:10,060 --> 00:26:14,379
samples<font color="#E5E5E5"> and you can quickly</font><font color="#CCCCCC"> pivot on IOC</font>

744
00:26:13,150 --> 00:26:18,400
<font color="#E5E5E5">s that you may see in your environment</font>

745
00:26:14,380 --> 00:26:19,600
<font color="#E5E5E5">to go from unknown binary to being able</font>

746
00:26:18,400 --> 00:26:21,160
to answer<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the questions that</font><font color="#E5E5E5"> you</font>

747
00:26:19,600 --> 00:26:23,230
<font color="#CCCCCC">need to answer you know very very</font>

748
00:26:21,160 --> 00:26:25,510
<font color="#E5E5E5">quickly when</font><font color="#CCCCCC"> you're sim chirps or your</font>

749
00:26:23,230 --> 00:26:28,960
AV solution chirps or something like

750
00:26:25,510 --> 00:26:30,320
<font color="#E5E5E5">that and and also you know being able to</font>

751
00:26:28,960 --> 00:26:32,659
work<font color="#E5E5E5"> with</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> the key</font>

752
00:26:30,320 --> 00:26:35,509
<font color="#CCCCCC">he's great</font><font color="#E5E5E5"> right everyone being able to</font>

753
00:26:32,659 --> 00:26:38,870
put as much I OC data as<font color="#E5E5E5"> much analysis</font>

754
00:26:35,509 --> 00:26:40,970
data out<font color="#E5E5E5"> into the the public spaces is</font>

755
00:26:38,870 --> 00:26:42,379
great because it saves everyone<font color="#E5E5E5"> time it</font>

756
00:26:40,970 --> 00:26:44,240
raises the bar<font color="#CCCCCC"> for the entire community</font>

757
00:26:42,380 --> 00:26:46,429
<font color="#E5E5E5">and that's one of the things that we</font>

758
00:26:44,240 --> 00:26:48,110
always<font color="#E5E5E5"> try to do so just some examples</font>

759
00:26:46,429 --> 00:26:49,880
<font color="#CCCCCC">of some some good</font><font color="#E5E5E5"> open source</font>

760
00:26:48,110 --> 00:26:53,570
<font color="#E5E5E5">intelligence resources that are out</font>

761
00:26:49,880 --> 00:26:56,000
there<font color="#CCCCCC"> that are available for use you</font>

762
00:26:53,570 --> 00:26:58,820
know who is data is great domain tools

763
00:26:56,000 --> 00:27:00,259
is a paid<font color="#CCCCCC"> service but I highly recommend</font>

764
00:26:58,820 --> 00:27:02,990
it<font color="#CCCCCC"> for</font><font color="#E5E5E5"> being able to perform like</font>

765
00:27:00,259 --> 00:27:05,720
historic Whois<font color="#E5E5E5"> reconnaissance being able</font>

766
00:27:02,990 --> 00:27:08,269
to<font color="#E5E5E5"> do reverse who is being able to</font>

767
00:27:05,720 --> 00:27:09,590
<font color="#E5E5E5">search off of different IOC data about a</font>

768
00:27:08,269 --> 00:27:11,570
domain registrant

769
00:27:09,590 --> 00:27:13,519
is is super<font color="#CCCCCC"> helpful when it comes to</font>

770
00:27:11,570 --> 00:27:15,500
being able to pivot and identify the

771
00:27:13,519 --> 00:27:19,940
scope<font color="#E5E5E5"> of a malware campaign that you may</font>

772
00:27:15,500 --> 00:27:21,710
see in your environment<font color="#CCCCCC"> um also</font><font color="#E5E5E5"> IP void</font>

773
00:27:19,940 --> 00:27:23,059
is great if you've only got an IP

774
00:27:21,710 --> 00:27:25,789
<font color="#CCCCCC">address</font><font color="#E5E5E5"> and you're trying to figure</font><font color="#CCCCCC"> out</font>

775
00:27:23,059 --> 00:27:27,918
you know<font color="#E5E5E5"> has it been seen is it bad is</font>

776
00:27:25,789 --> 00:27:30,500
<font color="#E5E5E5">it good what what do various sources</font>

777
00:27:27,919 --> 00:27:32,450
know about it<font color="#CCCCCC"> on virustotal</font><font color="#E5E5E5"> is super</font>

778
00:27:30,500 --> 00:27:34,250
helpful one of the things you'll find<font color="#E5E5E5"> if</font>

779
00:27:32,450 --> 00:27:35,629
you if you come across a hash in your

780
00:27:34,250 --> 00:27:36,320
<font color="#CCCCCC">environment is if you throw it into</font>

781
00:27:35,629 --> 00:27:38,209
virustotal

782
00:27:36,320 --> 00:27:40,820
the community is great<font color="#CCCCCC"> about you know</font>

783
00:27:38,210 --> 00:27:43,399
putting<font color="#CCCCCC"> comments</font><font color="#E5E5E5"> and in tagging samples</font>

784
00:27:40,820 --> 00:27:45,559
with you know<font color="#E5E5E5"> the configuration</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> a</font>

785
00:27:43,399 --> 00:27:47,059
malware sample may be programmed<font color="#CCCCCC"> to use</font>

786
00:27:45,559 --> 00:27:49,158
<font color="#E5E5E5">that will include things like command</font>

787
00:27:47,059 --> 00:27:50,570
and control servers a lot of times

788
00:27:49,159 --> 00:27:51,710
you'll see<font color="#CCCCCC"> the</font><font color="#E5E5E5"> actual malware family</font>

789
00:27:50,570 --> 00:27:54,168
itself tagged and that can be very

790
00:27:51,710 --> 00:27:55,429
<font color="#CCCCCC">helpful when it comes to identifying you</font>

791
00:27:54,169 --> 00:27:59,059
<font color="#CCCCCC">know what you're actually</font><font color="#E5E5E5"> looking at</font>

792
00:27:55,429 --> 00:28:01,129
from our sample perspective also

793
00:27:59,059 --> 00:28:03,440
<font color="#E5E5E5">security blogs there's a ton of them out</font>

794
00:28:01,129 --> 00:28:05,209
there and it's it's good<font color="#E5E5E5"> because there's</font>

795
00:28:03,440 --> 00:28:07,820
a lot<font color="#E5E5E5"> of great information that's that's</font>

796
00:28:05,210 --> 00:28:09,919
being put into the the<font color="#CCCCCC"> public space on a</font>

797
00:28:07,820 --> 00:28:12,289
very<font color="#CCCCCC"> very regular basis</font><font color="#E5E5E5"> you know a lot</font>

798
00:28:09,919 --> 00:28:14,360
<font color="#E5E5E5">of researchers are coming</font><font color="#CCCCCC"> across you</font>

799
00:28:12,289 --> 00:28:16,610
know malware in the wild<font color="#E5E5E5"> analyzing it</font>

800
00:28:14,360 --> 00:28:18,110
ripping it apart and<font color="#E5E5E5"> then putting very</font>

801
00:28:16,610 --> 00:28:20,090
very comprehensive write-ups out and

802
00:28:18,110 --> 00:28:22,789
they can be<font color="#E5E5E5"> very helpful for</font><font color="#CCCCCC"> a sec ops</font>

803
00:28:20,090 --> 00:28:24,110
team or you know a security analyst if

804
00:28:22,789 --> 00:28:27,500
you're trying to<font color="#E5E5E5"> quickly analyze</font>

805
00:28:24,110 --> 00:28:30,469
something<font color="#E5E5E5"> that you come across also a</font>

806
00:28:27,500 --> 00:28:33,139
URL void is is super helpful as well URL

807
00:28:30,470 --> 00:28:35,240
<font color="#E5E5E5">query is another great example because</font>

808
00:28:33,139 --> 00:28:37,129
<font color="#CCCCCC">you can</font><font color="#E5E5E5"> quickly visualize all of the</font>

809
00:28:35,240 --> 00:28:38,299
different requests that<font color="#E5E5E5"> are made and and</font>

810
00:28:37,129 --> 00:28:40,519
all<font color="#E5E5E5"> of the different response data</font>

811
00:28:38,299 --> 00:28:41,629
associated with HTTP communication<font color="#CCCCCC"> so if</font>

812
00:28:40,519 --> 00:28:43,279
you have a domain<font color="#CCCCCC"> that you've come</font>

813
00:28:41,629 --> 00:28:43,779
<font color="#E5E5E5">across you've seen malware reach out to</font>

814
00:28:43,279 --> 00:28:45,190
it

815
00:28:43,779 --> 00:28:49,210
and you want to get more<font color="#E5E5E5"> information for</font>

816
00:28:45,190 --> 00:28:50,710
the the URL<font color="#CCCCCC"> into URL query net and you</font>

817
00:28:49,210 --> 00:28:53,169
can<font color="#E5E5E5"> get a lot of</font><font color="#CCCCCC"> good information very</font>

818
00:28:50,710 --> 00:28:55,509
very<font color="#CCCCCC"> quickly about</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> right so</font>

819
00:28:53,169 --> 00:28:58,119
correlating<font color="#E5E5E5"> IOC</font><font color="#CCCCCC"> s2 to</font><font color="#E5E5E5"> identify malware</font>

820
00:28:55,509 --> 00:29:00,429
<font color="#CCCCCC">data pivoting pivoting is is very</font><font color="#E5E5E5"> very</font>

821
00:28:58,119 --> 00:29:03,639
essential<font color="#CCCCCC"> so being able to go from you</font>

822
00:29:00,429 --> 00:29:05,469
know Rando<font color="#E5E5E5"> IOC X to you know this is</font>

823
00:29:03,639 --> 00:29:08,799
this is everything<font color="#CCCCCC"> that the the world</font>

824
00:29:05,469 --> 00:29:11,080
knows about<font color="#E5E5E5"> a malware family is is super</font>

825
00:29:08,799 --> 00:29:12,309
useful<font color="#E5E5E5"> and you can</font><font color="#CCCCCC"> pivot off of a lot</font><font color="#E5E5E5"> of</font>

826
00:29:11,080 --> 00:29:14,289
different<font color="#E5E5E5"> data you can</font><font color="#CCCCCC"> pivot off a</font>

827
00:29:12,309 --> 00:29:17,408
<font color="#CCCCCC">hashes you can pivot off of</font><font color="#E5E5E5"> you know</font>

828
00:29:14,289 --> 00:29:19,839
domains<font color="#CCCCCC"> C</font><font color="#E5E5E5"> to IP addresses</font><font color="#CCCCCC"> domain</font>

829
00:29:17,409 --> 00:29:22,539
registrant<font color="#CCCCCC"> information</font><font color="#E5E5E5"> you know a lot of</font>

830
00:29:19,839 --> 00:29:25,119
<font color="#E5E5E5">things like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can also pivot off</font>

831
00:29:22,539 --> 00:29:27,999
of<font color="#E5E5E5"> the URI structure of command and</font>

832
00:29:25,119 --> 00:29:29,889
<font color="#E5E5E5">control traffic so in a lot of commodity</font>

833
00:29:27,999 --> 00:29:32,979
malware you<font color="#CCCCCC"> know they</font><font color="#E5E5E5"> don't change that</font>

834
00:29:29,889 --> 00:29:36,158
very very<font color="#CCCCCC"> often and and and you can see</font>

835
00:29:32,979 --> 00:29:37,869
<font color="#E5E5E5">command and control URI</font><font color="#CCCCCC"> requests go out</font>

836
00:29:36,159 --> 00:29:39,700
and you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> just basically take the path</font>

837
00:29:37,869 --> 00:29:42,399
<font color="#E5E5E5">that's used and quickly identify</font><font color="#CCCCCC"> the</font>

838
00:29:39,700 --> 00:29:46,089
sort of<font color="#E5E5E5"> malware so things like</font><font color="#CCCCCC"> pony in</font>

839
00:29:42,399 --> 00:29:47,799
<font color="#E5E5E5">h1n1</font><font color="#CCCCCC"> they don't change the URI structure</font>

840
00:29:46,089 --> 00:29:50,849
all that<font color="#E5E5E5"> frequently from from what I've</font>

841
00:29:47,799 --> 00:29:53,259
seen<font color="#CCCCCC"> just off of samples in the wild</font>

842
00:29:50,849 --> 00:29:55,439
<font color="#CCCCCC">filenames can can be</font><font color="#E5E5E5"> searched that's not</font>

843
00:29:53,259 --> 00:29:58,570
as accurate<font color="#E5E5E5"> because obviously</font><font color="#CCCCCC"> filenames</font>

844
00:29:55,440 --> 00:30:00,519
<font color="#E5E5E5">aren't a hash but making at</font><font color="#CCCCCC"> least help</font>

845
00:29:58,570 --> 00:30:01,928
in<font color="#CCCCCC"> in certain situations where you're</font>

846
00:30:00,519 --> 00:30:06,039
just<font color="#E5E5E5"> not coming up</font><font color="#CCCCCC"> with a lot of useful</font>

847
00:30:01,929 --> 00:30:09,070
<font color="#E5E5E5">data elsewhere so just some</font><font color="#CCCCCC"> examples</font>

848
00:30:06,039 --> 00:30:11,739
I've gone<font color="#CCCCCC"> over a few of them</font><font color="#E5E5E5"> so I</font>

849
00:30:09,070 --> 00:30:13,178
mentioned<font color="#CCCCCC"> a</font><font color="#E5E5E5"> bot rack</font><font color="#CCCCCC"> Pony they've been</font>

850
00:30:11,739 --> 00:30:15,129
used to know they've<font color="#E5E5E5"> been known to use</font>

851
00:30:13,179 --> 00:30:17,440
static URI structures you'll see them

852
00:30:15,129 --> 00:30:18,968
rotate occasionally but it doesn't

853
00:30:17,440 --> 00:30:20,379
happen<font color="#CCCCCC"> that often it's not like every</font>

854
00:30:18,969 --> 00:30:23,080
sample<font color="#E5E5E5"> is using a completely</font><font color="#CCCCCC"> different</font>

855
00:30:20,379 --> 00:30:25,418
<font color="#E5E5E5">URI structure so just by throwing it</font>

856
00:30:23,080 --> 00:30:28,210
into<font color="#CCCCCC"> Google on you can very very quickly</font>

857
00:30:25,419 --> 00:30:29,710
go from<font color="#E5E5E5"> random URI pattern to Oh</font>

858
00:30:28,210 --> 00:30:31,989
someone's seen this they've identified

859
00:30:29,710 --> 00:30:36,969
<font color="#E5E5E5">the malware family and there's extensive</font>

860
00:30:31,989 --> 00:30:38,559
write-ups about it<font color="#E5E5E5"> so just a quick and</font>

861
00:30:36,969 --> 00:30:40,239
dirty analysis process I've kind of gone

862
00:30:38,559 --> 00:30:41,769
<font color="#E5E5E5">through some</font><font color="#CCCCCC"> of this</font><font color="#E5E5E5"> already but just</font><font color="#CCCCCC"> to</font>

863
00:30:40,239 --> 00:30:43,599
kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> put it all together and and</font>

864
00:30:41,769 --> 00:30:45,129
bring it back<font color="#E5E5E5"> to you know what this</font>

865
00:30:43,599 --> 00:30:46,509
process<font color="#CCCCCC"> actually looks like</font><font color="#E5E5E5"> when you're</font>

866
00:30:45,129 --> 00:30:48,279
when you've got a malware sample<font color="#E5E5E5"> that</font>

867
00:30:46,509 --> 00:30:50,349
you need to analyze<font color="#E5E5E5"> in your environment</font>

868
00:30:48,279 --> 00:30:52,359
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so first of all you'll start up</font>

869
00:30:50,349 --> 00:30:53,859
your<font color="#E5E5E5"> REM</font><font color="#CCCCCC"> NICs</font><font color="#E5E5E5"> VM and you'll launch those</font>

870
00:30:52,359 --> 00:30:55,928
<font color="#E5E5E5">two utilities I mentioned earlier</font><font color="#CCCCCC"> I</font>

871
00:30:53,859 --> 00:30:56,360
netsim fake<font color="#E5E5E5"> DNS you'll probably want to</font>

872
00:30:55,929 --> 00:30:58,130
stand<font color="#E5E5E5"> up</font>

873
00:30:56,360 --> 00:31:02,000
a packet capture<font color="#E5E5E5"> program of some sort</font>

874
00:30:58,130 --> 00:31:04,250
<font color="#CCCCCC">but whatever your</font><font color="#E5E5E5"> your pcap collection</font>

875
00:31:02,000 --> 00:31:05,720
utility of choices Wireshark TCP dump

876
00:31:04,250 --> 00:31:07,910
<font color="#E5E5E5">and then you want to start your analysis</font>

877
00:31:05,720 --> 00:31:09,290
<font color="#E5E5E5">VM so that that would be the let's say</font>

878
00:31:07,910 --> 00:31:11,929
the<font color="#E5E5E5"> windows</font><font color="#CCCCCC"> vm</font><font color="#E5E5E5"> that you're</font><font color="#CCCCCC"> actually</font>

879
00:31:09,290 --> 00:31:14,240
gonna execute malware in for analysis

880
00:31:11,929 --> 00:31:17,690
first things first<font color="#E5E5E5"> take a fresh snapshot</font>

881
00:31:14,240 --> 00:31:20,000
<font color="#CCCCCC">I can't</font><font color="#E5E5E5"> stress enough on that snapshots</font>

882
00:31:17,690 --> 00:31:22,910
<font color="#CCCCCC">are your friend</font><font color="#E5E5E5"> take them often take</font>

883
00:31:20,000 --> 00:31:24,590
them as as much as you can<font color="#E5E5E5"> because</font><font color="#CCCCCC"> I</font>

884
00:31:22,910 --> 00:31:26,000
have<font color="#CCCCCC"> had several situations where I just</font>

885
00:31:24,590 --> 00:31:27,770
<font color="#E5E5E5">haven't thought</font><font color="#CCCCCC"> about it and I've like</font>

886
00:31:26,000 --> 00:31:29,750
set up<font color="#E5E5E5"> some utilities and I've done some</font>

887
00:31:27,770 --> 00:31:31,610
tweaking<font color="#E5E5E5"> and then I just didn't take</font><font color="#CCCCCC"> a</font>

888
00:31:29,750 --> 00:31:33,740
snapshot<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> I went to execute some</font>

889
00:31:31,610 --> 00:31:35,479
<font color="#E5E5E5">hour and then when I went</font><font color="#CCCCCC"> to revert</font>

890
00:31:33,740 --> 00:31:38,570
snapshot it was like oh well there goes

891
00:31:35,480 --> 00:31:41,120
<font color="#E5E5E5">four hours</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> work also set your local</font>

892
00:31:38,570 --> 00:31:43,159
DNS and<font color="#CCCCCC"> gateway to</font><font color="#E5E5E5"> point to rim</font><font color="#CCCCCC"> NICs so</font>

893
00:31:41,120 --> 00:31:45,260
that you can actually be<font color="#CCCCCC"> able to collect</font>

894
00:31:43,160 --> 00:31:47,990
<font color="#E5E5E5">and analyze those DNS requests you can</font>

895
00:31:45,260 --> 00:31:49,820
<font color="#E5E5E5">create the peak apps on and and you can</font>

896
00:31:47,990 --> 00:31:52,070
simulate that<font color="#CCCCCC"> situ traffic using AI</font>

897
00:31:49,820 --> 00:31:53,270
netsim and then test your<font color="#E5E5E5"> DNS just to</font>

898
00:31:52,070 --> 00:31:55,520
make<font color="#CCCCCC"> sure your tools are executing</font>

899
00:31:53,270 --> 00:31:57,559
properly<font color="#E5E5E5"> you know make a DNS</font><font color="#CCCCCC"> request out</font>

900
00:31:55,520 --> 00:31:59,059
you know ping Google or<font color="#E5E5E5"> something like</font>

901
00:31:57,559 --> 00:32:01,309
that<font color="#E5E5E5"> and you'll</font><font color="#CCCCCC"> see it in remix you'll</font>

902
00:31:59,059 --> 00:32:04,070
see the DNS<font color="#CCCCCC"> requests you'll see the the</font>

903
00:32:01,309 --> 00:32:05,090
the<font color="#E5E5E5"> actual get</font><font color="#CCCCCC"> request</font><font color="#E5E5E5"> over HTTP</font><font color="#CCCCCC"> in and</font>

904
00:32:04,070 --> 00:32:07,730
that's how<font color="#E5E5E5"> you know your tools are</font>

905
00:32:05,090 --> 00:32:08,899
<font color="#CCCCCC">working so you don't waste time and</font><font color="#E5E5E5"> come</font>

906
00:32:07,730 --> 00:32:10,929
to<font color="#CCCCCC"> find out that you're not actually</font>

907
00:32:08,900 --> 00:32:13,190
generating log data after you've been

908
00:32:10,929 --> 00:32:15,830
executing malware for you know 10 15

909
00:32:13,190 --> 00:32:18,230
<font color="#E5E5E5">minutes so then you'll set up</font><font color="#CCCCCC"> your</font>

910
00:32:15,830 --> 00:32:21,590
<font color="#CCCCCC">analysis</font><font color="#E5E5E5"> VM so you'll want to start</font><font color="#CCCCCC"> out</font>

911
00:32:18,230 --> 00:32:24,530
<font color="#E5E5E5">process monitor</font><font color="#CCCCCC"> there's some batch files</font>

912
00:32:21,590 --> 00:32:26,360
that you can<font color="#E5E5E5"> use</font><font color="#CCCCCC"> to basically</font><font color="#E5E5E5"> a lot of</font>

913
00:32:24,530 --> 00:32:28,160
times malware will write to the<font color="#E5E5E5"> temp</font>

914
00:32:26,360 --> 00:32:30,049
directory or to other<font color="#E5E5E5"> common directories</font>

915
00:32:28,160 --> 00:32:32,870
within<font color="#E5E5E5"> the windows file system and you</font>

916
00:32:30,049 --> 00:32:35,090
can<font color="#E5E5E5"> basically loop in Windows command</font>

917
00:32:32,870 --> 00:32:36,469
<font color="#E5E5E5">line that'll basically say</font><font color="#CCCCCC"> ok any</font><font color="#E5E5E5"> time a</font>

918
00:32:35,090 --> 00:32:38,470
file gets dropped into<font color="#E5E5E5"> this directory</font>

919
00:32:36,470 --> 00:32:41,299
<font color="#E5E5E5">copy it out of that directory into</font>

920
00:32:38,470 --> 00:32:42,590
staging directory that<font color="#E5E5E5"> you can use to</font>

921
00:32:41,299 --> 00:32:43,840
look<font color="#E5E5E5"> at it later because a lot of times</font>

922
00:32:42,590 --> 00:32:46,730
what you'll see with now where is that

923
00:32:43,840 --> 00:32:48,740
<font color="#CCCCCC">they'll drop</font><font color="#E5E5E5"> into Tim execute and then</font>

924
00:32:46,730 --> 00:32:51,350
clean temp up so it happens very very

925
00:32:48,740 --> 00:32:53,000
<font color="#CCCCCC">quickly and by</font><font color="#E5E5E5"> having this loop over</font><font color="#CCCCCC"> the</font>

926
00:32:51,350 --> 00:32:54,530
temp directory you can<font color="#CCCCCC"> make sure that</font>

927
00:32:53,000 --> 00:32:57,770
<font color="#CCCCCC">you can grab a copy of it before it gets</font>

928
00:32:54,530 --> 00:32:59,510
deleted<font color="#E5E5E5"> later on also startup process</font>

929
00:32:57,770 --> 00:33:01,309
hacker right you want<font color="#E5E5E5"> to know what</font>

930
00:32:59,510 --> 00:33:03,559
<font color="#E5E5E5">Mallory is doing in real time even</font>

931
00:33:01,309 --> 00:33:05,000
though you're generating<font color="#E5E5E5"> logs</font><font color="#CCCCCC"> um</font><font color="#E5E5E5"> you</font>

932
00:33:03,559 --> 00:33:06,350
know if you can see something<font color="#E5E5E5"> very very</font>

933
00:33:05,000 --> 00:33:09,389
quickly while you're executing<font color="#E5E5E5"> the</font>

934
00:33:06,350 --> 00:33:11,279
malware<font color="#E5E5E5"> it's it's super helpful</font>

935
00:33:09,389 --> 00:33:13,168
and then start a bread shot<font color="#E5E5E5"> you want to</font>

936
00:33:11,279 --> 00:33:15,119
do<font color="#E5E5E5"> red shot after some</font><font color="#CCCCCC"> of these other</font>

937
00:33:13,169 --> 00:33:18,210
utilities because<font color="#E5E5E5"> they can be somewhat</font>

938
00:33:15,119 --> 00:33:19,949
<font color="#CCCCCC">noisy</font><font color="#E5E5E5"> and it'll make your report</font><font color="#CCCCCC"> look a</font>

939
00:33:18,210 --> 00:33:21,989
lot nastier and<font color="#CCCCCC"> you'll have to go</font>

940
00:33:19,950 --> 00:33:23,309
through<font color="#CCCCCC"> a lot more false</font><font color="#E5E5E5"> positives in</font>

941
00:33:21,989 --> 00:33:24,629
your red shot report if<font color="#CCCCCC"> you do that</font>

942
00:33:23,309 --> 00:33:27,059
first<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> start kicking off these</font>

943
00:33:24,629 --> 00:33:29,399
<font color="#E5E5E5">other processes and</font><font color="#CCCCCC"> then you'll</font><font color="#E5E5E5"> want to</font>

944
00:33:27,059 --> 00:33:32,039
save the red shot report that you

945
00:33:29,399 --> 00:33:33,928
generate before you execute malware into

946
00:33:32,039 --> 00:33:35,369
<font color="#CCCCCC">a directory</font><font color="#E5E5E5"> that's not likely to be</font>

947
00:33:33,929 --> 00:33:37,139
<font color="#E5E5E5">overwritten so if you're if you're</font>

948
00:33:35,369 --> 00:33:38,999
analyzing let's say ransomware<font color="#E5E5E5"> where you</font>

949
00:33:37,139 --> 00:33:40,289
don't know what you're analyzing yet you

950
00:33:38,999 --> 00:33:41,820
don't want to store<font color="#CCCCCC"> this in a location</font>

951
00:33:40,289 --> 00:33:45,059
<font color="#E5E5E5">that is just going to be overwritten and</font>

952
00:33:41,820 --> 00:33:46,999
encrypted<font color="#CCCCCC"> and then if you're on 32-bit</font>

953
00:33:45,059 --> 00:33:49,408
<font color="#E5E5E5">Windows system capture that but</font>

954
00:33:46,999 --> 00:33:51,359
typically if<font color="#CCCCCC"> you're if you're</font><font color="#E5E5E5"> using a</font>

955
00:33:49,409 --> 00:33:53,309
<font color="#E5E5E5">64-bit analysis platform it's not</font>

956
00:33:51,359 --> 00:33:54,960
<font color="#E5E5E5">applicable</font><font color="#CCCCCC"> so once you have your</font><font color="#E5E5E5"> initial</font>

957
00:33:53,309 --> 00:33:56,908
<font color="#CCCCCC">red shot report</font><font color="#E5E5E5"> set up and you're</font>

958
00:33:54,960 --> 00:33:58,379
capturing data and you got<font color="#CCCCCC"> Remnick setup</font>

959
00:33:56,909 --> 00:34:00,720
and your beams pointed to it<font color="#E5E5E5"> you'll</font><font color="#CCCCCC"> want</font>

960
00:33:58,379 --> 00:34:02,639
<font color="#CCCCCC">to actually</font><font color="#E5E5E5"> execute the malware</font><font color="#CCCCCC"> so</font>

961
00:34:00,720 --> 00:34:05,100
you'll start process monitor and you'll

962
00:34:02,639 --> 00:34:07,320
start capturing<font color="#E5E5E5"> system activity you can</font>

963
00:34:05,100 --> 00:34:08,848
deploy any filters that you<font color="#E5E5E5"> need to like</font>

964
00:34:07,320 --> 00:34:10,980
I mentioned earlier<font color="#CCCCCC"> you</font><font color="#E5E5E5"> want to execute</font>

965
00:34:08,849 --> 00:34:12,510
the malware<font color="#E5E5E5"> within the the virtual</font>

966
00:34:10,980 --> 00:34:14,219
environment<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> you'll want to</font>

967
00:34:12,510 --> 00:34:17,480
monitor the activity<font color="#E5E5E5"> just let it run</font><font color="#CCCCCC"> for</font>

968
00:34:14,219 --> 00:34:20,399
a little<font color="#E5E5E5"> bit and then you'll be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

969
00:34:17,480 --> 00:34:21,599
you<font color="#CCCCCC"> may have a visual indication like</font><font color="#E5E5E5"> if</font>

970
00:34:20,399 --> 00:34:23,429
it's ransomware right that's going<font color="#E5E5E5"> to be</font>

971
00:34:21,599 --> 00:34:24,869
in your face when when ransomware kicks

972
00:34:23,429 --> 00:34:26,549
off<font color="#E5E5E5"> it's going to display a ransom note</font>

973
00:34:24,869 --> 00:34:29,280
that gives you instructions for<font color="#E5E5E5"> how</font><font color="#CCCCCC"> to</font>

974
00:34:26,549 --> 00:34:30,449
pay the<font color="#CCCCCC"> ransom demand</font><font color="#E5E5E5"> to decrypt your</font>

975
00:34:29,280 --> 00:34:32,579
files and<font color="#E5E5E5"> you'll know</font><font color="#CCCCCC"> right then in</font>

976
00:34:30,449 --> 00:34:34,649
there that yeah it's it's probably<font color="#CCCCCC"> okay</font>

977
00:34:32,579 --> 00:34:37,530
<font color="#CCCCCC">to go ahead and terminate execution</font>

978
00:34:34,649 --> 00:34:39,989
other types of malware<font color="#CCCCCC"> may be less</font>

979
00:34:37,530 --> 00:34:41,760
<font color="#CCCCCC">in-your-face as far as like getting you</font>

980
00:34:39,989 --> 00:34:43,348
a visual indication that<font color="#E5E5E5"> malware is</font>

981
00:34:41,760 --> 00:34:45,119
actually executing properly so you may

982
00:34:43,349 --> 00:34:49,049
<font color="#E5E5E5">just need to give it</font><font color="#CCCCCC"> some time and then</font>

983
00:34:45,119 --> 00:34:51,210
look and see<font color="#E5E5E5"> so you know you'll want</font><font color="#CCCCCC"> to</font>

984
00:34:49,049 --> 00:34:53,339
execute<font color="#E5E5E5"> a second</font><font color="#CCCCCC"> red shot</font><font color="#E5E5E5"> captured that</font>

985
00:34:51,210 --> 00:34:54,240
creates your<font color="#E5E5E5"> your after report so you</font>

986
00:34:53,339 --> 00:34:55,828
have a before<font color="#CCCCCC"> port</font>

987
00:34:54,239 --> 00:34:58,109
report and you have an after report and

988
00:34:55,829 --> 00:35:00,720
then you can basically diff the two and

989
00:34:58,109 --> 00:35:02,308
compare what changes have been made<font color="#E5E5E5"> you</font>

990
00:35:00,720 --> 00:35:03,899
want to export<font color="#E5E5E5"> any sort of event logs</font>

991
00:35:02,309 --> 00:35:06,329
from within<font color="#E5E5E5"> Windows that you may have</font>

992
00:35:03,900 --> 00:35:07,829
and you want to export<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the things so</font>

993
00:35:06,329 --> 00:35:09,900
all the reports<font color="#E5E5E5"> say</font><font color="#CCCCCC"> that your that</font>

994
00:35:07,829 --> 00:35:11,730
<font color="#E5E5E5">you've created using</font><font color="#CCCCCC"> these utilities as</font>

995
00:35:09,900 --> 00:35:14,099
<font color="#E5E5E5">well as your fake DNS and</font><font color="#CCCCCC"> I netsim</font>

996
00:35:11,730 --> 00:35:16,559
reports and at that<font color="#E5E5E5"> point you have a lot</font>

997
00:35:14,099 --> 00:35:18,990
<font color="#CCCCCC">of data that</font><font color="#E5E5E5"> you can quickly analyze to</font>

998
00:35:16,559 --> 00:35:20,430
try to put<font color="#E5E5E5"> together that</font><font color="#CCCCCC"> IOC list that I</font>

999
00:35:18,990 --> 00:35:22,430
mentioned<font color="#CCCCCC"> earlier that</font><font color="#E5E5E5"> you pivot off of</font>

1000
00:35:20,430 --> 00:35:25,368
<font color="#CCCCCC">to positively identify</font>

1001
00:35:22,430 --> 00:35:26,390
an hour itself<font color="#E5E5E5"> so just some key</font>

1002
00:35:25,369 --> 00:35:28,819
takeaways

1003
00:35:26,390 --> 00:35:30,770
you know<font color="#E5E5E5"> malware analysis labs aren't</font>

1004
00:35:28,819 --> 00:35:32,240
<font color="#CCCCCC">expensive hardware</font><font color="#E5E5E5"> costs have come down</font>

1005
00:35:30,770 --> 00:35:32,839
<font color="#E5E5E5">significantly over</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> past several</font>

1006
00:35:32,240 --> 00:35:34,790
years

1007
00:35:32,839 --> 00:35:36,170
make sure you have storage make sure you

1008
00:35:34,790 --> 00:35:38,630
have more<font color="#E5E5E5"> storage than you think you'll</font>

1009
00:35:36,170 --> 00:35:41,000
need<font color="#E5E5E5"> because snapshots get costly</font><font color="#CCCCCC"> very</font>

1010
00:35:38,630 --> 00:35:43,220
quickly<font color="#E5E5E5"> on you know you can have several</font>

1011
00:35:41,000 --> 00:35:44,809
<font color="#CCCCCC">several gigs per snapshot depending on</font>

1012
00:35:43,220 --> 00:35:46,970
what you've<font color="#CCCCCC"> done on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> from the</font>

1013
00:35:44,809 --> 00:35:50,150
<font color="#CCCCCC">time you've</font><font color="#E5E5E5"> taken your last snapshot to</font>

1014
00:35:46,970 --> 00:35:51,919
when you take<font color="#CCCCCC"> your next</font><font color="#E5E5E5"> one and make</font>

1015
00:35:50,150 --> 00:35:54,349
sure<font color="#CCCCCC"> you have your setup beforehand so</font>

1016
00:35:51,920 --> 00:35:56,270
this the whole idea<font color="#CCCCCC"> behind this is is to</font>

1017
00:35:54,349 --> 00:35:58,940
try<font color="#CCCCCC"> to give a very very inexpensive</font>

1018
00:35:56,270 --> 00:36:00,589
<font color="#CCCCCC">quick and easy process that security</font>

1019
00:35:58,940 --> 00:36:01,640
operations teams can use<font color="#E5E5E5"> in their</font>

1020
00:36:00,589 --> 00:36:04,759
environments to very very<font color="#CCCCCC"> quickly</font>

1021
00:36:01,640 --> 00:36:06,980
<font color="#CCCCCC">analyze you know malware related events</font>

1022
00:36:04,760 --> 00:36:08,480
<font color="#E5E5E5">that they may come across alerts that</font>

1023
00:36:06,980 --> 00:36:09,859
they may see in their environment but

1024
00:36:08,480 --> 00:36:12,069
it's very<font color="#E5E5E5"> very important that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> set</font>

1025
00:36:09,859 --> 00:36:14,990
all of<font color="#E5E5E5"> this stuff up before</font><font color="#CCCCCC"> you actually</font>

1026
00:36:12,069 --> 00:36:16,849
<font color="#CCCCCC">need it because</font><font color="#E5E5E5"> it takes a little while</font>

1027
00:36:14,990 --> 00:36:18,410
<font color="#CCCCCC">to get all the way set up to get</font><font color="#E5E5E5"> all of</font>

1028
00:36:16,849 --> 00:36:20,660
your<font color="#E5E5E5"> tools configured the</font><font color="#CCCCCC"> way that you</font>

1029
00:36:18,410 --> 00:36:22,339
like them to stand up the<font color="#E5E5E5"> virtual</font>

1030
00:36:20,660 --> 00:36:24,109
<font color="#CCCCCC">environment to stand up all the pins</font>

1031
00:36:22,339 --> 00:36:25,549
<font color="#E5E5E5">that you need so making sure</font><font color="#CCCCCC"> that you</font>

1032
00:36:24,109 --> 00:36:27,710
<font color="#CCCCCC">have those already available when you</font>

1033
00:36:25,550 --> 00:36:30,680
<font color="#CCCCCC">need</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> as is essential to</font><font color="#E5E5E5"> being able</font>

1034
00:36:27,710 --> 00:36:32,359
to make<font color="#E5E5E5"> this a quick process</font><font color="#CCCCCC"> and in many</font>

1035
00:36:30,680 --> 00:36:33,950
<font color="#E5E5E5">cases you</font><font color="#CCCCCC"> can identify malware</font><font color="#E5E5E5"> and its</font>

1036
00:36:32,359 --> 00:36:36,109
capabilities without<font color="#E5E5E5"> necessarily even</font>

1037
00:36:33,950 --> 00:36:38,899
running<font color="#E5E5E5"> it</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> take a hash and throw</font>

1038
00:36:36,109 --> 00:36:40,910
it into<font color="#CCCCCC"> virustotal or throw it into a</font>

1039
00:36:38,900 --> 00:36:43,099
<font color="#CCCCCC">Google search and</font><font color="#E5E5E5"> look at different</font>

1040
00:36:40,910 --> 00:36:45,319
<font color="#E5E5E5">sorts of sandbox reports you know hybrid</font>

1041
00:36:43,099 --> 00:36:47,150
analysis malware<font color="#E5E5E5"> there's a lot of</font>

1042
00:36:45,319 --> 00:36:49,160
different you know reports<font color="#E5E5E5"> that you can</font>

1043
00:36:47,150 --> 00:36:50,809
get<font color="#E5E5E5"> just</font><font color="#CCCCCC"> by throwing a file hash</font><font color="#E5E5E5"> into</font>

1044
00:36:49,160 --> 00:36:52,069
Google and it can save<font color="#E5E5E5"> you a</font><font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> time</font>

1045
00:36:50,809 --> 00:36:53,930
<font color="#E5E5E5">because you may be able to put together</font>

1046
00:36:52,069 --> 00:36:55,700
the<font color="#CCCCCC"> i/o seized</font><font color="#E5E5E5"> on that</font><font color="#CCCCCC"> allow you to</font>

1047
00:36:53,930 --> 00:36:57,440
<font color="#E5E5E5">identify the the</font><font color="#CCCCCC"> malware and its</font>

1048
00:36:55,700 --> 00:36:58,848
capabilities without<font color="#CCCCCC"> ever even needing</font>

1049
00:36:57,440 --> 00:37:01,940
it<font color="#E5E5E5"> detonated in the case</font><font color="#CCCCCC"> that you do</font>

1050
00:36:58,849 --> 00:37:03,910
this<font color="#CCCCCC"> process is super useful for</font><font color="#E5E5E5"> you</font>

1051
00:37:01,940 --> 00:37:07,400
know providing a quick and<font color="#E5E5E5"> dirty way</font><font color="#CCCCCC"> to</font>

1052
00:37:03,910 --> 00:37:09,170
be<font color="#CCCCCC"> able to obtain and answer a lot of</font>

1053
00:37:07,400 --> 00:37:10,400
<font color="#CCCCCC">questions</font><font color="#E5E5E5"> and obtain a lot of</font>

1054
00:37:09,170 --> 00:37:12,319
<font color="#CCCCCC">information about malware</font><font color="#E5E5E5"> in your</font>

1055
00:37:10,400 --> 00:37:14,869
environment<font color="#CCCCCC"> how</font><font color="#E5E5E5"> open source data is your</font>

1056
00:37:12,319 --> 00:37:17,180
friend<font color="#E5E5E5"> right no need to reinvent</font><font color="#CCCCCC"> the</font>

1057
00:37:14,869 --> 00:37:18,950
<font color="#CCCCCC">wheel no need to you know do all of this</font>

1058
00:37:17,180 --> 00:37:20,899
work yourself<font color="#E5E5E5"> if someone else has</font>

1059
00:37:18,950 --> 00:37:22,308
already<font color="#E5E5E5"> done</font><font color="#CCCCCC"> in and has</font><font color="#E5E5E5"> been helpful</font>

1060
00:37:20,900 --> 00:37:24,829
<font color="#E5E5E5">enough to actually release it to</font><font color="#CCCCCC"> the</font>

1061
00:37:22,309 --> 00:37:26,720
<font color="#E5E5E5">world</font><font color="#CCCCCC"> and then if all</font><font color="#E5E5E5"> those fails just</font>

1062
00:37:24,829 --> 00:37:28,339
<font color="#E5E5E5">run the malware capture its activity</font>

1063
00:37:26,720 --> 00:37:30,950
you'll be<font color="#CCCCCC"> able to put together</font><font color="#E5E5E5"> at least</font>

1064
00:37:28,339 --> 00:37:32,450
<font color="#E5E5E5">some sort of a list of</font><font color="#CCCCCC"> IOC data related</font>

1065
00:37:30,950 --> 00:37:34,399
to<font color="#CCCCCC"> that malware and then use that</font><font color="#E5E5E5"> to</font>

1066
00:37:32,450 --> 00:37:35,868
<font color="#CCCCCC">identify</font><font color="#E5E5E5"> it and its associated</font>

1067
00:37:34,400 --> 00:37:37,309
characteristics and you may

1068
00:37:35,869 --> 00:37:39,049
be able<font color="#CCCCCC"> to identify its characteristics</font>

1069
00:37:37,309 --> 00:37:42,069
right<font color="#E5E5E5"> away just based on what you</font>

1070
00:37:39,049 --> 00:37:44,779
observed in your<font color="#E5E5E5"> analysis lab</font><font color="#CCCCCC"> and so</font>

1071
00:37:42,069 --> 00:37:48,369
with that if anybody has any<font color="#CCCCCC"> questions</font>

1072
00:37:44,779 --> 00:37:48,369
I'll take them<font color="#E5E5E5"> out I appreciate</font><font color="#CCCCCC"> it</font>

