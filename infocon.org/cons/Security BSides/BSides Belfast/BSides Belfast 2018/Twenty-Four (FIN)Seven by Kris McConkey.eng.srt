1
00:00:02,300 --> 00:00:05,879
<font color="#E5E5E5">all right great thanks</font><font color="#CCCCCC"> hi folks</font><font color="#E5E5E5"> thanks</font>

2
00:00:05,100 --> 00:00:09,000
<font color="#E5E5E5">for coming</font>

3
00:00:05,879 --> 00:00:10,620
this talk is<font color="#E5E5E5"> going to look a little bit</font>

4
00:00:09,000 --> 00:00:12,990
different than it would<font color="#CCCCCC"> have</font><font color="#E5E5E5"> done if I</font>

5
00:00:10,620 --> 00:00:15,509
delivered<font color="#E5E5E5"> it at the back end of July and</font>

6
00:00:12,990 --> 00:00:18,630
so this is an actor<font color="#CCCCCC"> that we've been</font>

7
00:00:15,509 --> 00:00:20,070
<font color="#E5E5E5">tracking probably since about 2015</font><font color="#CCCCCC"> very</font>

8
00:00:18,630 --> 00:00:21,960
<font color="#E5E5E5">focused on financial crime a</font>

9
00:00:20,070 --> 00:00:23,490
particularly<font color="#E5E5E5"> targeted</font><font color="#CCCCCC"> financial crime so</font>

10
00:00:21,960 --> 00:00:25,320
they're not really<font color="#E5E5E5"> opportunistic in any</font>

11
00:00:23,490 --> 00:00:26,669
sense<font color="#CCCCCC"> we've done a bunch</font><font color="#E5E5E5"> of</font>

12
00:00:25,320 --> 00:00:28,529
<font color="#CCCCCC">Investigations around the world with</font>

13
00:00:26,670 --> 00:00:31,349
<font color="#E5E5E5">these guys and couple in Europe but</font>

14
00:00:28,529 --> 00:00:32,640
mostly<font color="#E5E5E5"> in the US and I'm</font><font color="#CCCCCC"> is Warren kind</font>

15
00:00:31,349 --> 00:00:34,079
<font color="#E5E5E5">of alluded to</font><font color="#CCCCCC"> there are a few people</font>

16
00:00:32,640 --> 00:00:36,450
<font color="#CCCCCC">have done some</font><font color="#E5E5E5"> really good research on</font>

17
00:00:34,079 --> 00:00:38,550
these guys including<font color="#CCCCCC"> Tallis which I'll</font>

18
00:00:36,450 --> 00:00:39,510
touch<font color="#E5E5E5"> on in a</font><font color="#CCCCCC"> little bit as well but the</font>

19
00:00:38,550 --> 00:00:43,680
reason that looks a little bit<font color="#E5E5E5"> different</font>

20
00:00:39,510 --> 00:00:45,449
<font color="#CCCCCC">now then it would</font><font color="#E5E5E5"> have at the</font><font color="#CCCCCC"> back end</font>

21
00:00:43,680 --> 00:00:47,129
<font color="#E5E5E5">of July was that on the</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> of August</font>

22
00:00:45,450 --> 00:00:49,680
<font color="#E5E5E5">and the US Department of Justice</font>

23
00:00:47,129 --> 00:00:52,170
<font color="#CCCCCC">announced that in early 2018 they'd</font>

24
00:00:49,680 --> 00:00:53,879
<font color="#CCCCCC">actually arrested three of the key</font>

25
00:00:52,170 --> 00:00:56,969
members<font color="#E5E5E5"> behind the group so this is a</font>

26
00:00:53,879 --> 00:00:59,550
little extract<font color="#E5E5E5"> from their</font><font color="#CCCCCC"> indictment</font>

27
00:00:56,969 --> 00:01:00,899
<font color="#CCCCCC">just to give</font><font color="#E5E5E5"> you a feel</font><font color="#CCCCCC"> for the scale</font><font color="#E5E5E5"> of</font>

28
00:00:59,550 --> 00:01:02,279
some<font color="#CCCCCC"> of these guys or at least based on</font>

29
00:01:00,899 --> 00:01:04,949
<font color="#CCCCCC">the stuff that the Department of Justice</font>

30
00:01:02,280 --> 00:01:07,409
<font color="#CCCCCC">was</font><font color="#E5E5E5"> willing to reference in the</font>

31
00:01:04,949 --> 00:01:09,750
indictment so 15 million customer card

32
00:01:07,409 --> 00:01:12,119
records stolen<font color="#E5E5E5"> most of those ended up</font>

33
00:01:09,750 --> 00:01:14,729
for sale on<font color="#CCCCCC"> a cybercrime forum called</font>

34
00:01:12,119 --> 00:01:16,710
Joker stash and which we have<font color="#CCCCCC"> a sort of</font>

35
00:01:14,729 --> 00:01:18,659
half<font color="#E5E5E5"> suspicion some of the fin</font><font color="#CCCCCC"> 7 guys</font>

36
00:01:16,710 --> 00:01:22,048
<font color="#E5E5E5">might actually run and they</font><font color="#CCCCCC"> certainly</font>

37
00:01:18,659 --> 00:01:24,390
share and have access<font color="#E5E5E5"> to that forum with</font>

38
00:01:22,049 --> 00:01:25,680
some of the other<font color="#CCCCCC"> targeted</font><font color="#E5E5E5"> cyber crime</font>

39
00:01:24,390 --> 00:01:27,240
groups<font color="#E5E5E5"> like fin</font><font color="#CCCCCC"> six which is</font>

40
00:01:25,680 --> 00:01:28,939
<font color="#E5E5E5">particularly active in the UK and Europe</font>

41
00:01:27,240 --> 00:01:31,320
at the minute

42
00:01:28,939 --> 00:01:33,298
<font color="#E5E5E5">6500 point-of-sale terminals compromised</font>

43
00:01:31,320 --> 00:01:36,929
at more<font color="#E5E5E5"> than</font><font color="#CCCCCC"> 3600 separate business</font>

44
00:01:33,299 --> 00:01:38,430
locations and that's just in the<font color="#CCCCCC"> US so</font>

45
00:01:36,930 --> 00:01:40,470
these guys were really<font color="#E5E5E5"> quite prolific</font>

46
00:01:38,430 --> 00:01:41,820
<font color="#E5E5E5">and in what they did so this talk</font><font color="#CCCCCC"> is</font>

47
00:01:40,470 --> 00:01:44,039
really<font color="#E5E5E5"> going to be a little bit of a run</font>

48
00:01:41,820 --> 00:01:45,779
through<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> stuff that the</font>

49
00:01:44,040 --> 00:01:48,420
Department of Justice called out in the

50
00:01:45,780 --> 00:01:49,619
indictment about how<font color="#E5E5E5"> these guys operated</font>

51
00:01:48,420 --> 00:01:52,110
<font color="#E5E5E5">how they targeted different</font>

52
00:01:49,619 --> 00:01:53,460
organizations and<font color="#CCCCCC"> then what that</font><font color="#E5E5E5"> looked</font>

53
00:01:52,110 --> 00:01:55,530
like a from a research perspective

54
00:01:53,460 --> 00:01:57,658
<font color="#E5E5E5">because our</font><font color="#CCCCCC"> faretta Intel teams</font><font color="#E5E5E5"> been</font>

55
00:01:55,530 --> 00:01:59,460
looking at<font color="#E5E5E5"> these guys</font><font color="#CCCCCC"> in 2015 as well</font><font color="#E5E5E5"> as</font>

56
00:01:57,659 --> 00:02:00,719
from an<font color="#E5E5E5"> incident response perspective in</font>

57
00:01:59,460 --> 00:02:01,770
terms<font color="#E5E5E5"> of how we've actually dealt with</font>

58
00:02:00,719 --> 00:02:03,689
<font color="#E5E5E5">these guys and some of the victim</font>

59
00:02:01,770 --> 00:02:05,640
networks as well<font color="#E5E5E5"> and then how they've</font>

60
00:02:03,689 --> 00:02:07,220
reacted to some of<font color="#CCCCCC"> the stuff that's been</font>

61
00:02:05,640 --> 00:02:09,479
in<font color="#E5E5E5"> the press</font><font color="#CCCCCC"> so by them as</font><font color="#E5E5E5"> well</font><font color="#CCCCCC"> so</font>

62
00:02:07,220 --> 00:02:11,200
<font color="#CCCCCC">hopefully it'll be a bit of a rapid-fire</font>

63
00:02:09,479 --> 00:02:12,670
<font color="#E5E5E5">run-through</font>

64
00:02:11,200 --> 00:02:15,280
and try<font color="#E5E5E5"> and cover</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> the more</font>

65
00:02:12,670 --> 00:02:18,190
interesting points<font color="#CCCCCC"> about how</font><font color="#E5E5E5"> they they</font>

66
00:02:15,280 --> 00:02:20,140
<font color="#CCCCCC">actually behave so I'm not</font><font color="#E5E5E5"> expecting</font>

67
00:02:18,190 --> 00:02:22,000
<font color="#CCCCCC">everybody read</font><font color="#E5E5E5"> this the key points on</font>

68
00:02:20,140 --> 00:02:24,160
this<font color="#E5E5E5"> were basically that these guys</font>

69
00:02:22,000 --> 00:02:25,930
typically<font color="#CCCCCC"> fish</font><font color="#E5E5E5"> their way and they</font>

70
00:02:24,160 --> 00:02:28,090
typically crafted some stuff<font color="#E5E5E5"> that was</font>

71
00:02:25,930 --> 00:02:30,220
<font color="#E5E5E5">really quite</font><font color="#CCCCCC"> relevant</font><font color="#E5E5E5"> to the companies</font>

72
00:02:28,090 --> 00:02:32,080
<font color="#E5E5E5">so they're their primary target this was</font>

73
00:02:30,220 --> 00:02:34,000
retail hospitality<font color="#E5E5E5"> and leisure</font>

74
00:02:32,080 --> 00:02:35,739
<font color="#E5E5E5">sothank food retailers like Chipotle</font>

75
00:02:34,000 --> 00:02:37,769
<font color="#E5E5E5">which is one of the big big</font><font color="#CCCCCC"> breaches</font>

76
00:02:35,739 --> 00:02:40,120
<font color="#CCCCCC">that was in the</font><font color="#E5E5E5"> public domain and</font>

77
00:02:37,769 --> 00:02:41,980
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> anybody in a kind of retail</font>

78
00:02:40,120 --> 00:02:43,360
<font color="#CCCCCC">leisure sort of sector so anybody that's</font>

79
00:02:41,980 --> 00:02:45,160
<font color="#E5E5E5">collecting massive amounts of credit</font>

80
00:02:43,360 --> 00:02:47,769
<font color="#E5E5E5">card</font><font color="#CCCCCC"> data</font><font color="#E5E5E5"> or personal</font><font color="#CCCCCC"> information and</font>

81
00:02:45,160 --> 00:02:49,299
where they find occasionally they were

82
00:02:47,769 --> 00:02:51,730
targeting environments that didn't have

83
00:02:49,299 --> 00:02:53,530
big<font color="#CCCCCC"> pause</font><font color="#E5E5E5"> terminal deployments they</font>

84
00:02:51,730 --> 00:02:56,230
would then actually switch the theme to

85
00:02:53,530 --> 00:02:58,750
target<font color="#E5E5E5"> individuals that would know a bit</font>

86
00:02:56,230 --> 00:03:01,569
about<font color="#E5E5E5"> that upcoming like SEC filings</font>

87
00:02:58,750 --> 00:03:03,580
around<font color="#E5E5E5"> and our profitability and market</font>

88
00:03:01,569 --> 00:03:05,018
results those sorts of things<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that</font>

89
00:03:03,580 --> 00:03:06,310
they could<font color="#E5E5E5"> probably then</font><font color="#CCCCCC"> front-run some</font>

90
00:03:05,019 --> 00:03:09,100
of the market activity<font color="#E5E5E5"> whenever those</font>

91
00:03:06,310 --> 00:03:11,769
announcements came<font color="#CCCCCC"> out and there</font><font color="#E5E5E5"> that</font>

92
00:03:09,100 --> 00:03:14,470
the the<font color="#E5E5E5"> tailoring of some of the lures</font>

93
00:03:11,769 --> 00:03:17,350
was always quite interesting for<font color="#E5E5E5"> the</font>

94
00:03:14,470 --> 00:03:19,239
retail outlets<font color="#E5E5E5"> this was so fonts</font><font color="#CCCCCC"> North</font>

95
00:03:17,350 --> 00:03:20,590
<font color="#CCCCCC">Korea miss</font><font color="#E5E5E5"> Missy says my name is Adrian</font>

96
00:03:19,239 --> 00:03:23,200
<font color="#CCCCCC">Clark and I want to make a catering</font>

97
00:03:20,590 --> 00:03:25,090
order<font color="#E5E5E5"> for tomorrow</font><font color="#CCCCCC"> 11:00 a.m. it's a big</font>

98
00:03:23,200 --> 00:03:26,738
one for 14 people<font color="#E5E5E5"> I've composed a list</font>

99
00:03:25,090 --> 00:03:29,109
of what<font color="#E5E5E5"> we'll need</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> closed file</font>

100
00:03:26,739 --> 00:03:31,060
contains all catering information click

101
00:03:29,109 --> 00:03:34,030
on<font color="#E5E5E5"> edit at the</font><font color="#CCCCCC"> top of the page and then</font>

102
00:03:31,060 --> 00:03:36,010
<font color="#CCCCCC">double click to unlock content</font><font color="#E5E5E5"> and so</font>

103
00:03:34,030 --> 00:03:38,019
quite specific<font color="#CCCCCC"> around</font><font color="#E5E5E5"> how you get access</font>

104
00:03:36,010 --> 00:03:39,820
<font color="#E5E5E5">to this stuff and this one's pretty</font>

105
00:03:38,019 --> 00:03:41,920
pretty much the same<font color="#E5E5E5"> I want</font><font color="#CCCCCC"> to make a</font>

106
00:03:39,820 --> 00:03:43,480
<font color="#E5E5E5">takeout order for tomorrow at</font><font color="#CCCCCC"> 11 a.m.</font>

107
00:03:41,920 --> 00:03:45,190
<font color="#CCCCCC">includes file contains order and my</font>

108
00:03:43,480 --> 00:03:46,358
personal info click<font color="#E5E5E5"> on edit at the</font><font color="#CCCCCC"> top</font>

109
00:03:45,190 --> 00:03:49,109
<font color="#CCCCCC">of the page and then</font><font color="#E5E5E5"> double click</font><font color="#CCCCCC"> to</font>

110
00:03:46,359 --> 00:03:51,579
unlock content<font color="#E5E5E5"> why change it if it works</font>

111
00:03:49,109 --> 00:03:53,500
and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> same</font><font color="#E5E5E5"> thing this contains all</font>

112
00:03:51,579 --> 00:03:55,720
<font color="#E5E5E5">necessary</font><font color="#CCCCCC"> information and order in</font><font color="#E5E5E5"> our</font>

113
00:03:53,500 --> 00:03:56,799
<font color="#E5E5E5">website and click Edit anyway at the top</font>

114
00:03:55,720 --> 00:03:59,920
of the page<font color="#E5E5E5"> and then double click</font><font color="#CCCCCC"> to</font>

115
00:03:56,799 --> 00:04:02,140
unlock<font color="#CCCCCC"> content and the ones which were</font>

116
00:03:59,920 --> 00:04:03,730
<font color="#E5E5E5">slightly more amusing</font><font color="#CCCCCC"> for about a</font><font color="#E5E5E5"> six to</font>

117
00:04:02,140 --> 00:04:06,160
<font color="#E5E5E5">nine month period whenever they were</font>

118
00:04:03,730 --> 00:04:09,179
targeting restaurants and one of their

119
00:04:06,160 --> 00:04:11,590
consistent themes was to send an email

120
00:04:09,180 --> 00:04:13,120
pretending<font color="#CCCCCC"> that they had dined at the</font>

121
00:04:11,590 --> 00:04:15,819
restaurant the previous day they were

122
00:04:13,120 --> 00:04:19,149
part<font color="#E5E5E5"> of like a local company and they</font>

123
00:04:15,819 --> 00:04:21,190
had<font color="#E5E5E5"> really bad diarrhea and so there was</font>

124
00:04:19,149 --> 00:04:23,140
home saying like<font color="#CCCCCC"> we</font><font color="#E5E5E5"> were filing a formal</font>

125
00:04:21,190 --> 00:04:23,630
<font color="#CCCCCC">complaint please</font><font color="#E5E5E5"> open this file and</font>

126
00:04:23,140 --> 00:04:26,419
<font color="#CCCCCC">write up</font>

127
00:04:23,630 --> 00:04:27,650
click at the top etc but<font color="#E5E5E5"> that actually</font>

128
00:04:26,420 --> 00:04:30,020
got them into some of their<font color="#E5E5E5"> highest</font>

129
00:04:27,650 --> 00:04:32,570
profile victims<font color="#E5E5E5"> and it became quite a</font>

130
00:04:30,020 --> 00:04:33,919
strong indicator<font color="#E5E5E5"> of these guys and some</font>

131
00:04:32,570 --> 00:04:35,930
of their targeting of<font color="#E5E5E5"> the retail and</font>

132
00:04:33,920 --> 00:04:38,090
hospitality sectors for<font color="#CCCCCC"> about</font><font color="#E5E5E5"> a good six</font>

133
00:04:35,930 --> 00:04:40,850
<font color="#CCCCCC">to nine month window and but one of</font><font color="#E5E5E5"> the</font>

134
00:04:38,090 --> 00:04:43,400
key ways of tracking them<font color="#CCCCCC"> and this was</font>

135
00:04:40,850 --> 00:04:47,140
an almost flawless way of doing it<font color="#CCCCCC"> for</font>

136
00:04:43,400 --> 00:04:49,190
almost<font color="#E5E5E5"> a year</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> that the document was</font>

137
00:04:47,140 --> 00:04:51,560
<font color="#CCCCCC">they</font><font color="#E5E5E5"> actually had two versions</font><font color="#CCCCCC"> of it</font>

138
00:04:49,190 --> 00:04:53,570
this is<font color="#CCCCCC"> a docx lure</font><font color="#E5E5E5"> and an RTF lure</font>

139
00:04:51,560 --> 00:04:55,580
every single one<font color="#E5E5E5"> of them had this image</font>

140
00:04:53,570 --> 00:04:56,930
<font color="#E5E5E5">in it and it was</font><font color="#CCCCCC"> basically exactly the</font>

141
00:04:55,580 --> 00:04:58,520
<font color="#E5E5E5">same thing as the instruction</font><font color="#CCCCCC"> set it's</font>

142
00:04:56,930 --> 00:05:01,310
like double click<font color="#E5E5E5"> on and enable macros</font>

143
00:04:58,520 --> 00:05:02,690
and<font color="#E5E5E5"> so on but if you remember</font><font color="#CCCCCC"> Custance</font>

144
00:05:01,310 --> 00:05:04,040
<font color="#E5E5E5">talk about</font><font color="#CCCCCC"> yara and some of the cool</font>

145
00:05:02,690 --> 00:05:06,469
things<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> do with it</font><font color="#E5E5E5"> you can</font>

146
00:05:04,040 --> 00:05:09,260
<font color="#E5E5E5">actually track embedded images in RTF</font>

147
00:05:06,470 --> 00:05:10,760
files and docx files<font color="#E5E5E5"> and you might think</font>

148
00:05:09,260 --> 00:05:12,680
docx is a bit of a weird<font color="#E5E5E5"> one because</font>

149
00:05:10,760 --> 00:05:14,180
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> a compressed zip file so how do</font>

150
00:05:12,680 --> 00:05:15,800
you write a<font color="#CCCCCC"> euro rule for the contents</font>

151
00:05:14,180 --> 00:05:18,290
it's actually the<font color="#CCCCCC"> case that images are</font>

152
00:05:15,800 --> 00:05:20,630
not compressed in docx files<font color="#E5E5E5"> so they in</font>

153
00:05:18,290 --> 00:05:22,610
the in the raw zip file and<font color="#E5E5E5"> the actual</font>

154
00:05:20,630 --> 00:05:24,080
<font color="#E5E5E5">image structure is exactly</font><font color="#CCCCCC"> the same</font><font color="#E5E5E5"> so</font>

155
00:05:22,610 --> 00:05:25,430
<font color="#E5E5E5">you can create the arrow rule for the</font>

156
00:05:24,080 --> 00:05:27,710
<font color="#E5E5E5">binary of the image and then track all</font>

157
00:05:25,430 --> 00:05:29,570
the documents<font color="#CCCCCC"> that it's used in and so</font>

158
00:05:27,710 --> 00:05:31,190
until<font color="#CCCCCC"> a couple of other families started</font>

159
00:05:29,570 --> 00:05:33,650
stealing<font color="#E5E5E5"> this lure so I think trick</font><font color="#CCCCCC"> bot</font>

160
00:05:31,190 --> 00:05:36,380
started using it at the<font color="#E5E5E5"> back end of 2017</font>

161
00:05:33,650 --> 00:05:40,400
<font color="#E5E5E5">it was actually a really reliable way of</font>

162
00:05:36,380 --> 00:05:44,900
<font color="#CCCCCC">tracking</font><font color="#E5E5E5"> pin 7 activity so that</font><font color="#CCCCCC"> got them</font>

163
00:05:40,400 --> 00:05:48,380
<font color="#CCCCCC">into huge amounts</font><font color="#E5E5E5"> of their victims what</font>

164
00:05:44,900 --> 00:05:51,770
that<font color="#E5E5E5"> basically did was drop a very I</font>

165
00:05:48,380 --> 00:05:54,469
guess comp not complex<font color="#E5E5E5"> but quite heavy</font>

166
00:05:51,770 --> 00:05:55,700
<font color="#E5E5E5">JavaScript framework that they used to</font>

167
00:05:54,470 --> 00:05:57,650
then drop a whole lot<font color="#E5E5E5"> of secondary</font>

168
00:05:55,700 --> 00:05:59,659
<font color="#E5E5E5">payloads so I let them do system</font>

169
00:05:57,650 --> 00:06:00,859
enumeration<font color="#E5E5E5"> fingerprinting to figure out</font>

170
00:05:59,660 --> 00:06:02,420
<font color="#CCCCCC">kind of what</font><font color="#E5E5E5"> they were in what systems</font>

171
00:06:00,860 --> 00:06:04,310
they were on what it had access<font color="#CCCCCC"> to who</font>

172
00:06:02,420 --> 00:06:07,490
the users<font color="#CCCCCC"> were let them upload download</font>

173
00:06:04,310 --> 00:06:09,380
<font color="#E5E5E5">files let them run screen grabs and let</font>

174
00:06:07,490 --> 00:06:11,360
them<font color="#E5E5E5"> drop some other payloads like tiny</font>

175
00:06:09,380 --> 00:06:12,860
<font color="#CCCCCC">met and so the co tiny interpreter</font>

176
00:06:11,360 --> 00:06:14,420
person which they used for<font color="#E5E5E5"> quite a long</font>

177
00:06:12,860 --> 00:06:16,790
<font color="#CCCCCC">time to do</font><font color="#E5E5E5"> something more</font><font color="#CCCCCC"> interactive</font>

178
00:06:14,420 --> 00:06:18,350
access<font color="#CCCCCC"> and they also</font><font color="#E5E5E5"> use cobalt strike</font>

179
00:06:16,790 --> 00:06:19,910
for a while as<font color="#CCCCCC"> well but one of</font><font color="#E5E5E5"> the</font>

180
00:06:18,350 --> 00:06:21,980
things that was quite<font color="#CCCCCC"> interesting was</font>

181
00:06:19,910 --> 00:06:25,010
<font color="#CCCCCC">that every single deployment they did</font>

182
00:06:21,980 --> 00:06:27,080
had a different hash value so they<font color="#E5E5E5"> never</font>

183
00:06:25,010 --> 00:06:29,270
repeated this in JavaScript payload

184
00:06:27,080 --> 00:06:30,620
across victims<font color="#CCCCCC"> and one of the ways even</font>

185
00:06:29,270 --> 00:06:32,210
<font color="#E5E5E5">though the the core functionality</font>

186
00:06:30,620 --> 00:06:33,849
remained the same<font color="#E5E5E5"> one of the ways that</font>

187
00:06:32,210 --> 00:06:36,248
<font color="#E5E5E5">they changed</font>

188
00:06:33,849 --> 00:06:39,069
<font color="#E5E5E5">that the</font><font color="#CCCCCC"> codebase</font><font color="#E5E5E5"> was to</font><font color="#CCCCCC"> basically tick</font>

189
00:06:36,249 --> 00:06:40,479
junk<font color="#CCCCCC"> javascript</font><font color="#E5E5E5"> code not junk but</font><font color="#CCCCCC"> take</font>

190
00:06:39,069 --> 00:06:42,279
<font color="#CCCCCC">javascript code from</font><font color="#E5E5E5"> open source</font>

191
00:06:40,479 --> 00:06:43,899
<font color="#CCCCCC">websites</font><font color="#E5E5E5"> drop it into their own</font>

192
00:06:42,279 --> 00:06:47,080
<font color="#CCCCCC">JavaScript files but they never caught</font>

193
00:06:43,899 --> 00:06:49,149
<font color="#E5E5E5">it and so this is their code on the left</font>

194
00:06:47,080 --> 00:06:51,998
and narrative script file<font color="#E5E5E5"> the one on the</font>

195
00:06:49,149 --> 00:06:53,619
right is<font color="#CCCCCC"> actually top 20 JavaScript</font>

196
00:06:51,999 --> 00:06:56,379
questions you're likely to<font color="#E5E5E5"> get asked in</font>

197
00:06:53,619 --> 00:06:58,089
an interview<font color="#E5E5E5"> and they just would</font>

198
00:06:56,379 --> 00:06:59,709
literally go<font color="#CCCCCC"> to stack overflow</font><font color="#E5E5E5"> they'd go</font>

199
00:06:58,089 --> 00:07:00,969
<font color="#E5E5E5">to a bunch</font><font color="#CCCCCC"> of sites just</font><font color="#E5E5E5"> fine anywhere</font>

200
00:06:59,709 --> 00:07:03,219
that<font color="#CCCCCC"> there was public javascript code</font>

201
00:07:00,969 --> 00:07:04,629
<font color="#E5E5E5">copy big chunks of it and then drop it</font>

202
00:07:03,219 --> 00:07:06,550
in their own payloads<font color="#E5E5E5"> and it kind of</font>

203
00:07:04,629 --> 00:07:08,619
bulk they might<font color="#E5E5E5"> mean it less likely</font><font color="#CCCCCC"> that</font>

204
00:07:06,550 --> 00:07:09,610
<font color="#CCCCCC">AV was going to trigger on it and those</font>

205
00:07:08,619 --> 00:07:11,139
types of<font color="#E5E5E5"> things so they were really</font>

206
00:07:09,610 --> 00:07:13,209
<font color="#E5E5E5">trying to obfuscate this quite heavily</font>

207
00:07:11,139 --> 00:07:17,080
<font color="#E5E5E5">and</font><font color="#CCCCCC"> genuine it actually worked for</font><font color="#E5E5E5"> them</font>

208
00:07:13,209 --> 00:07:19,389
quite a bit so<font color="#E5E5E5"> we saw I'll show you some</font>

209
00:07:17,080 --> 00:07:21,849
<font color="#E5E5E5">of the structure of this in a bit but</font>

210
00:07:19,389 --> 00:07:23,399
this<font color="#E5E5E5"> actually made decoding some of</font>

211
00:07:21,849 --> 00:07:26,649
these a<font color="#E5E5E5"> little bit</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> complex and</font>

212
00:07:23,399 --> 00:07:28,869
actually<font color="#E5E5E5"> over</font><font color="#CCCCCC"> time they incrementally</font>

213
00:07:26,649 --> 00:07:30,459
made<font color="#E5E5E5"> a whole lot of other changes to try</font>

214
00:07:28,869 --> 00:07:32,589
<font color="#E5E5E5">and actually evade the researchers that</font>

215
00:07:30,459 --> 00:07:34,059
<font color="#E5E5E5">we're tracking them and so it cost them</font>

216
00:07:32,589 --> 00:07:35,559
mention another blog<font color="#CCCCCC"> post by</font><font color="#E5E5E5"> this really</font>

217
00:07:34,059 --> 00:07:36,789
<font color="#E5E5E5">company called Morpheus X they also</font>

218
00:07:35,559 --> 00:07:39,129
<font color="#E5E5E5">published some stuff from these guys</font>

219
00:07:36,789 --> 00:07:41,110
<font color="#E5E5E5">fire I did some stuff Talos did some</font>

220
00:07:39,129 --> 00:07:42,999
stuff and<font color="#E5E5E5"> then Proofpoint did some stuff</font>

221
00:07:41,110 --> 00:07:44,709
as well<font color="#CCCCCC"> and almost every single</font><font color="#E5E5E5"> time</font>

222
00:07:42,999 --> 00:07:46,419
<font color="#CCCCCC">I'll show some data points</font><font color="#E5E5E5"> on this</font>

223
00:07:44,709 --> 00:07:48,219
these guys<font color="#E5E5E5"> will reacted within a few</font>

224
00:07:46,419 --> 00:07:50,409
days<font color="#E5E5E5"> to update some of the code to make</font>

225
00:07:48,219 --> 00:07:52,329
some changes<font color="#E5E5E5"> to the evasion</font><font color="#CCCCCC"> technique</font><font color="#E5E5E5"> so</font>

226
00:07:50,409 --> 00:07:54,039
<font color="#E5E5E5">that we're trying to use</font><font color="#CCCCCC"> for this</font><font color="#E5E5E5"> stuff</font>

227
00:07:52,329 --> 00:07:56,769
<font color="#E5E5E5">so that's</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit about how they</font>

228
00:07:54,039 --> 00:07:58,089
got in this is<font color="#CCCCCC"> another snippet</font><font color="#E5E5E5"> from the</font>

229
00:07:56,769 --> 00:07:59,829
indictment<font color="#E5E5E5"> so they're frequently</font>

230
00:07:58,089 --> 00:08:03,240
targeted victim companies with customers

231
00:07:59,829 --> 00:08:05,469
who<font color="#CCCCCC"> use payment cards in those case who</font>

232
00:08:03,240 --> 00:08:07,119
in those cases spent<font color="#E5E5E5"> seven configured</font>

233
00:08:05,469 --> 00:08:08,800
malware to extract<font color="#CCCCCC"> a copy</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> compile a</font>

234
00:08:07,119 --> 00:08:10,839
payment<font color="#E5E5E5"> card data and then transmit it</font>

235
00:08:08,800 --> 00:08:13,119
to see<font color="#CCCCCC"> to</font><font color="#E5E5E5"> servers controlled by</font><font color="#CCCCCC"> fin</font>

236
00:08:10,839 --> 00:08:15,369
<font color="#E5E5E5">seven</font><font color="#CCCCCC"> kinda obvious for them to be doing</font>

237
00:08:13,119 --> 00:08:18,429
<font color="#E5E5E5">and if they're targeting retail</font>

238
00:08:15,369 --> 00:08:20,379
environments<font color="#E5E5E5"> so from an incident</font>

239
00:08:18,429 --> 00:08:21,518
<font color="#CCCCCC">response perspective</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a little</font>

240
00:08:20,379 --> 00:08:25,449
bit about what<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of that stuff looked</font>

241
00:08:21,519 --> 00:08:27,069
like so they had a<font color="#E5E5E5"> script which we</font>

242
00:08:25,449 --> 00:08:30,219
<font color="#E5E5E5">always used to joke that if we ever find</font>

243
00:08:27,069 --> 00:08:31,839
a deck C or a dot something on a victim

244
00:08:30,219 --> 00:08:34,120
<font color="#E5E5E5">that was a pretty good starting point</font>

245
00:08:31,839 --> 00:08:36,849
for<font color="#CCCCCC"> anything bad these guys consistently</font>

246
00:08:34,120 --> 00:08:39,639
called this a dot VBS and it was

247
00:08:36,849 --> 00:08:42,610
effectively a script<font color="#E5E5E5"> that copied a file</font>

248
00:08:39,639 --> 00:08:45,030
called<font color="#CCCCCC"> DM PR dumper ps1</font><font color="#E5E5E5"> so a</font><font color="#CCCCCC"> PowerShell</font>

249
00:08:42,610 --> 00:08:47,220
script<font color="#E5E5E5"> from one system to another</font>

250
00:08:45,030 --> 00:08:48,600
but in many<font color="#E5E5E5"> of the it's kind</font><font color="#CCCCCC"> of cut off</font>

251
00:08:47,220 --> 00:08:51,420
<font color="#E5E5E5">slightly</font><font color="#CCCCCC"> at the bottom for good reasons</font>

252
00:08:48,600 --> 00:08:53,160
but in<font color="#E5E5E5"> many</font><font color="#CCCCCC"> of the cases we investigated</font>

253
00:08:51,420 --> 00:08:54,420
these guys already<font color="#E5E5E5"> had legitimate</font>

254
00:08:53,160 --> 00:08:56,250
credentials that let<font color="#E5E5E5"> them move around</font>

255
00:08:54,420 --> 00:08:57,810
the payment terminal<font color="#CCCCCC"> network</font><font color="#E5E5E5"> so in this</font>

256
00:08:56,250 --> 00:08:59,220
case the demand was blank the<font color="#CCCCCC"> user name</font>

257
00:08:57,810 --> 00:09:01,229
<font color="#CCCCCC">is term user and then they had a valid</font>

258
00:08:59,220 --> 00:09:03,150
<font color="#CCCCCC">password so they'd already picked this</font>

259
00:09:01,230 --> 00:09:04,910
stuff<font color="#E5E5E5"> up from doing some of the recon</font>

260
00:09:03,150 --> 00:09:07,680
and after their initial<font color="#E5E5E5"> phishing</font>

261
00:09:04,910 --> 00:09:09,089
configured this script<font color="#E5E5E5"> and then ran</font><font color="#CCCCCC"> it</font>

262
00:09:07,680 --> 00:09:10,770
<font color="#E5E5E5">command which can</font><font color="#CCCCCC"> pulled out on the</font>

263
00:09:09,090 --> 00:09:13,080
<font color="#CCCCCC">right hand side that</font><font color="#E5E5E5"> basically copies it</font>

264
00:09:10,770 --> 00:09:14,490
back and forward<font color="#CCCCCC"> from from some other</font>

265
00:09:13,080 --> 00:09:18,800
systems<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get it</font><font color="#CCCCCC"> deployed around</font><font color="#E5E5E5"> the</font>

266
00:09:14,490 --> 00:09:21,300
<font color="#E5E5E5">environment so back to the indictment</font>

267
00:09:18,800 --> 00:09:22,550
conspiracy compromised<font color="#E5E5E5"> illegally</font>

268
00:09:21,300 --> 00:09:24,240
accessed<font color="#E5E5E5"> and had unauthorized</font>

269
00:09:22,550 --> 00:09:25,319
communications with which<font color="#E5E5E5"> other things</font>

270
00:09:24,240 --> 00:09:28,350
are really<font color="#CCCCCC"> weird</font>

271
00:09:25,320 --> 00:09:29,790
<font color="#CCCCCC">phrasing exfiltrated proprietary private</font>

272
00:09:28,350 --> 00:09:31,170
non-public victim data and information

273
00:09:29,790 --> 00:09:33,660
<font color="#E5E5E5">from the computer systems of victims</font>

274
00:09:31,170 --> 00:09:39,599
<font color="#E5E5E5">three arrests a restaurant chain with</font>

275
00:09:33,660 --> 00:09:41,480
<font color="#E5E5E5">thousands of locations in the yes so in</font>

276
00:09:39,600 --> 00:09:43,620
this specific<font color="#E5E5E5"> instance they actually</font>

277
00:09:41,480 --> 00:09:44,550
they keep talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> district of</font>

278
00:09:43,620 --> 00:09:46,050
<font color="#CCCCCC">Washington because</font><font color="#E5E5E5"> that's where the</font>

279
00:09:44,550 --> 00:09:47,760
indictment was filed but<font color="#CCCCCC"> thirty three</font>

280
00:09:46,050 --> 00:09:49,859
restaurant chains just<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Washington and</font>

281
00:09:47,760 --> 00:09:51,569
thousands nationally so one of<font color="#E5E5E5"> the</font>

282
00:09:49,860 --> 00:09:53,280
<font color="#E5E5E5">interesting things that</font><font color="#CCCCCC"> we figured out</font>

283
00:09:51,570 --> 00:09:55,140
<font color="#E5E5E5">and in some of the incident</font><font color="#CCCCCC"> response</font>

284
00:09:53,280 --> 00:09:58,079
cases was<font color="#CCCCCC"> why</font><font color="#E5E5E5"> they were getting such</font>

285
00:09:55,140 --> 00:10:01,199
broad point-of-sale malware deployments

286
00:09:58,080 --> 00:10:02,760
<font color="#E5E5E5">in these victim networks we've seen</font><font color="#CCCCCC"> thin</font>

287
00:10:01,200 --> 00:10:03,960
<font color="#CCCCCC">sex do this recently</font><font color="#E5E5E5"> as well but Finn</font>

288
00:10:02,760 --> 00:10:05,990
<font color="#CCCCCC">said was the first group that we</font>

289
00:10:03,960 --> 00:10:07,140
<font color="#CCCCCC">actually saw</font><font color="#E5E5E5"> using PA</font><font color="#CCCCCC"> exact and</font>

290
00:10:05,990 --> 00:10:09,870
hijacking

291
00:10:07,140 --> 00:10:12,540
<font color="#CCCCCC">Altiris and so Symantec Altiris software</font>

292
00:10:09,870 --> 00:10:15,810
distribution tools they managed<font color="#E5E5E5"> to get</font>

293
00:10:12,540 --> 00:10:17,130
<font color="#CCCCCC">onto that</font><font color="#E5E5E5"> distribute their own script in</font>

294
00:10:15,810 --> 00:10:18,449
exactly the<font color="#CCCCCC"> same way that the company</font>

295
00:10:17,130 --> 00:10:20,790
would push out their own software

296
00:10:18,450 --> 00:10:23,220
<font color="#E5E5E5">updates or patch updates etc</font><font color="#CCCCCC"> and managed</font>

297
00:10:20,790 --> 00:10:26,550
<font color="#CCCCCC">to hit 95% of the poles terminals in one</font>

298
00:10:23,220 --> 00:10:27,690
go<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is pretty slick</font><font color="#E5E5E5"> so that that</font>

299
00:10:26,550 --> 00:10:29,130
was one of<font color="#CCCCCC"> the things</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> really</font>

300
00:10:27,690 --> 00:10:31,560
<font color="#E5E5E5">focused on quite heavily whenever they</font>

301
00:10:29,130 --> 00:10:33,090
got into an environment<font color="#E5E5E5"> and we've seen</font>

302
00:10:31,560 --> 00:10:35,010
in some<font color="#CCCCCC"> of the recent</font><font color="#E5E5E5"> within six cases</font>

303
00:10:33,090 --> 00:10:37,020
we've investigated in the UK and Europe

304
00:10:35,010 --> 00:10:38,910
<font color="#CCCCCC">and they've done exactly the same</font><font color="#E5E5E5"> thing</font>

305
00:10:37,020 --> 00:10:40,079
as well<font color="#CCCCCC"> and it's definitely</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> to</font>

306
00:10:38,910 --> 00:10:41,699
<font color="#CCCCCC">look out for if you're defending</font><font color="#E5E5E5"> a</font>

307
00:10:40,080 --> 00:10:43,590
network and make sure you've got<font color="#CCCCCC"> good</font>

308
00:10:41,700 --> 00:10:48,270
logging<font color="#E5E5E5"> on the software distribution</font>

309
00:10:43,590 --> 00:10:50,670
<font color="#E5E5E5">systems as well and so going into dumper</font>

310
00:10:48,270 --> 00:10:52,530
<font color="#E5E5E5">dot ps1 and this kind of does</font><font color="#CCCCCC"> what it</font>

311
00:10:50,670 --> 00:10:54,150
says<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> tin it's the credit card</font>

312
00:10:52,530 --> 00:10:56,790
scraper or dumpers<font color="#CCCCCC"> their</font><font color="#E5E5E5"> main</font><font color="#CCCCCC"> poles</font>

313
00:10:54,150 --> 00:10:58,750
malware and starts off with an<font color="#CCCCCC"> included</font>

314
00:10:56,790 --> 00:11:03,009
<font color="#CCCCCC">and base64 array</font>

315
00:10:58,750 --> 00:11:04,750
the<font color="#CCCCCC"> first bits of that so the tvq string</font>

316
00:11:03,009 --> 00:11:06,639
should<font color="#E5E5E5"> be pretty familiar to any of you</font>

317
00:11:04,750 --> 00:11:11,079
<font color="#E5E5E5">that are</font><font color="#CCCCCC"> doing any research and that's</font>

318
00:11:06,639 --> 00:11:13,089
<font color="#E5E5E5">the included PE header for a binary but</font>

319
00:11:11,079 --> 00:11:15,969
this you've just<font color="#E5E5E5"> decoded that and tried</font>

320
00:11:13,089 --> 00:11:17,319
<font color="#CCCCCC">to elevate privileges</font><font color="#E5E5E5"> and then run it so</font>

321
00:11:15,970 --> 00:11:20,230
the binary<font color="#E5E5E5"> that it dropped out was a</font>

322
00:11:17,319 --> 00:11:22,449
normal windows PE binary first thing it

323
00:11:20,230 --> 00:11:25,480
<font color="#E5E5E5">did was try to check if it had admin</font>

324
00:11:22,449 --> 00:11:28,060
privileges and<font color="#E5E5E5"> again whenever it figured</font>

325
00:11:25,480 --> 00:11:29,920
out<font color="#E5E5E5"> if it had admin privileges it</font>

326
00:11:28,060 --> 00:11:31,930
dropped into a function<font color="#E5E5E5"> or some of the</font>

327
00:11:29,920 --> 00:11:34,149
more<font color="#E5E5E5"> interesting stuff and then kicked</font>

328
00:11:31,930 --> 00:11:37,258
off so the way<font color="#CCCCCC"> that this managed to</font>

329
00:11:34,149 --> 00:11:39,879
persist<font color="#E5E5E5"> on systems despite reboots and</font>

330
00:11:37,259 --> 00:11:42,790
was actually<font color="#E5E5E5"> a method that we hadn't</font>

331
00:11:39,879 --> 00:11:46,540
seen anybody do in the<font color="#CCCCCC"> wild before and</font>

332
00:11:42,790 --> 00:11:49,060
it was effectively creating a blob that

333
00:11:46,540 --> 00:11:51,759
then got loaded<font color="#CCCCCC"> into a specific registry</font>

334
00:11:49,060 --> 00:11:53,888
key but it was what that blob did then

335
00:11:51,759 --> 00:11:55,389
it was quite the<font color="#E5E5E5"> interesting that there</font>

336
00:11:53,889 --> 00:11:56,980
was the persistence<font color="#E5E5E5"> for how that</font>

337
00:11:55,389 --> 00:11:59,610
registry blob got loaded<font color="#E5E5E5"> was the</font>

338
00:11:56,980 --> 00:12:02,649
interesting<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> so it created a</font>

339
00:11:59,610 --> 00:12:04,089
registry key that had a<font color="#E5E5E5"> little Microsoft</font>

340
00:12:02,649 --> 00:12:05,439
string at the start so if anybody was

341
00:12:04,089 --> 00:12:06,759
<font color="#CCCCCC">looking at it it probably just looked</font>

342
00:12:05,439 --> 00:12:09,399
<font color="#E5E5E5">quite legitimate or something to do</font>

343
00:12:06,759 --> 00:12:11,189
<font color="#E5E5E5">Microsoft DRM and</font><font color="#CCCCCC"> then there was a shell</font>

344
00:12:09,399 --> 00:12:13,660
code loading routine straight after that

345
00:12:11,189 --> 00:12:15,099
<font color="#E5E5E5">then another kind of string brick</font><font color="#CCCCCC"> and</font>

346
00:12:13,660 --> 00:12:17,170
then a<font color="#E5E5E5"> whole bunch of encoded binary</font>

347
00:12:15,100 --> 00:12:19,480
<font color="#E5E5E5">content so</font><font color="#CCCCCC"> that in itself wasn't</font>

348
00:12:17,170 --> 00:12:21,490
particularly<font color="#E5E5E5"> interesting and but kind of</font>

349
00:12:19,480 --> 00:12:24,879
staged that<font color="#E5E5E5"> and and then it went on</font><font color="#CCCCCC"> to</font>

350
00:12:21,490 --> 00:12:26,920
build an entry in the shim cache<font color="#E5E5E5"> so this</font>

351
00:12:24,879 --> 00:12:28,870
was basically<font color="#E5E5E5"> Microsoft's method for</font>

352
00:12:26,920 --> 00:12:30,128
doing<font color="#E5E5E5"> inland patching in system boots</font>

353
00:12:28,870 --> 00:12:33,279
it's the way a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the Microsoft</font>

354
00:12:30,129 --> 00:12:35,050
updates work and programmatically this

355
00:12:33,279 --> 00:12:36,730
is all pretty<font color="#CCCCCC"> well-documented so anybody</font>

356
00:12:35,050 --> 00:12:39,370
<font color="#E5E5E5">that can it needs to develop a little</font>

357
00:12:36,730 --> 00:12:41,259
<font color="#E5E5E5">inline patch for something</font><font color="#CCCCCC"> conform with</font>

358
00:12:39,370 --> 00:12:44,889
<font color="#CCCCCC">the</font><font color="#E5E5E5"> instructions builder and shim</font>

359
00:12:41,259 --> 00:12:47,500
<font color="#E5E5E5">database so this created it in the temp</font>

360
00:12:44,889 --> 00:12:50,050
directory<font color="#E5E5E5"> pretty random name and then</font>

361
00:12:47,500 --> 00:12:52,319
ran it and with the<font color="#CCCCCC"> SDB instant files so</font>

362
00:12:50,050 --> 00:12:56,050
<font color="#CCCCCC">Elida patches and run</font><font color="#E5E5E5"> quietly some</font>

363
00:12:52,319 --> 00:12:59,469
notifications were popped up<font color="#E5E5E5"> then</font>

364
00:12:56,050 --> 00:13:00,729
looking at the code for<font color="#CCCCCC"> this there's</font>

365
00:12:59,470 --> 00:13:02,470
<font color="#E5E5E5">actually a little part of the Leslie</font>

366
00:13:00,730 --> 00:13:05,529
drop out all of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> key points of the</font>

367
00:13:02,470 --> 00:13:08,559
<font color="#E5E5E5">shim databases and so this was targeting</font>

368
00:13:05,529 --> 00:13:10,779
<font color="#E5E5E5">services XE and that was the the main</font>

369
00:13:08,559 --> 00:13:12,250
process it<font color="#E5E5E5"> was targeting and then this</font>

370
00:13:10,779 --> 00:13:17,230
string table was a set

371
00:13:12,250 --> 00:13:19,390
options for<font color="#E5E5E5"> hi it was named so any kind</font>

372
00:13:17,230 --> 00:13:22,000
of<font color="#E5E5E5"> shim patch that's loaded at runtime</font>

373
00:13:19,390 --> 00:13:23,890
<font color="#E5E5E5">you cannot see in the application</font>

374
00:13:22,000 --> 00:13:25,930
compatibility<font color="#E5E5E5"> database but you can see</font>

375
00:13:23,890 --> 00:13:27,310
it in the installed<font color="#CCCCCC"> update and the way</font>

376
00:13:25,930 --> 00:13:29,170
<font color="#E5E5E5">this managed to hide itself wasn't it</font>

377
00:13:27,310 --> 00:13:31,569
basically picked one of those names<font color="#CCCCCC"> so</font>

378
00:13:29,170 --> 00:13:33,459
<font color="#E5E5E5">either a Microsoft</font><font color="#CCCCCC"> KB</font><font color="#E5E5E5"> services fixer one</font>

379
00:13:31,570 --> 00:13:35,980
services<font color="#CCCCCC"> or XE</font><font color="#E5E5E5"> Microsoft services or</font>

380
00:13:33,460 --> 00:13:38,500
Microsoft Corporation<font color="#E5E5E5"> and that was then</font>

381
00:13:35,980 --> 00:13:41,560
what popped up in the<font color="#CCCCCC"> can add</font><font color="#E5E5E5"> remove</font>

382
00:13:38,500 --> 00:13:42,820
programs as one<font color="#CCCCCC"> of the pointers that</font><font color="#E5E5E5"> was</font>

383
00:13:41,560 --> 00:13:44,589
installed so this was<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> quite</font>

384
00:13:42,820 --> 00:13:46,810
hard to<font color="#E5E5E5"> find</font><font color="#CCCCCC"> if you were</font><font color="#E5E5E5"> just literally</font>

385
00:13:44,590 --> 00:13:47,740
looking at stuff on the system<font color="#E5E5E5"> and but a</font>

386
00:13:46,810 --> 00:13:49,660
really<font color="#E5E5E5"> really nice way of getting</font>

387
00:13:47,740 --> 00:13:51,670
persistence<font color="#E5E5E5"> whenever</font><font color="#CCCCCC"> we there mapped</font>

388
00:13:49,660 --> 00:13:53,319
back how the attacker had gone about

389
00:13:51,670 --> 00:13:55,540
<font color="#E5E5E5">this and we thought this was something</font>

390
00:13:53,320 --> 00:13:57,640
<font color="#E5E5E5">quite new I think it was twenty sixteen</font>

391
00:13:55,540 --> 00:13:59,380
or<font color="#E5E5E5"> seventeen and we find this or find</font>

392
00:13:57,640 --> 00:14:02,050
them<font color="#E5E5E5"> doing this for the first time on an</font>

393
00:13:59,380 --> 00:14:03,430
investigation<font color="#E5E5E5"> we realized actually it's</font>

394
00:14:02,050 --> 00:14:05,349
not<font color="#E5E5E5"> new and they were literally</font>

395
00:14:03,430 --> 00:14:06,819
<font color="#E5E5E5">following a playbook that somebody</font>

396
00:14:05,350 --> 00:14:09,750
<font color="#CCCCCC">eyesight had written and presented at</font>

397
00:14:06,820 --> 00:14:12,310
blackhat in 2014<font color="#CCCCCC"> and it's a really good</font>

398
00:14:09,750 --> 00:14:14,800
<font color="#E5E5E5">kind of bit of documentation</font><font color="#CCCCCC"> about this</font>

399
00:14:12,310 --> 00:14:16,239
technique and<font color="#E5E5E5"> they flagged at that point</font>

400
00:14:14,800 --> 00:14:19,150
this is probably<font color="#E5E5E5"> going to be used for</font>

401
00:14:16,240 --> 00:14:23,620
<font color="#E5E5E5">persistence at some time so really quite</font>

402
00:14:19,150 --> 00:14:25,329
nice thing to use in the wild<font color="#CCCCCC"> that was a</font>

403
00:14:23,620 --> 00:14:27,040
<font color="#CCCCCC">little bit about the pause malware it</font>

404
00:14:25,330 --> 00:14:28,960
hired actually operated after that was

405
00:14:27,040 --> 00:14:31,390
pretty standard<font color="#CCCCCC"> there was a regex</font><font color="#E5E5E5"> that</font>

406
00:14:28,960 --> 00:14:33,130
just looked<font color="#CCCCCC"> for the card run values</font>

407
00:14:31,390 --> 00:14:35,260
<font color="#E5E5E5">called them I dropped</font><font color="#CCCCCC"> them</font><font color="#E5E5E5"> into another</font>

408
00:14:33,130 --> 00:14:38,170
<font color="#CCCCCC">log file and and the actor collected</font>

409
00:14:35,260 --> 00:14:41,200
them<font color="#E5E5E5"> and shifted</font><font color="#CCCCCC"> shift them off</font><font color="#E5E5E5"> so</font>

410
00:14:38,170 --> 00:14:44,680
<font color="#E5E5E5">moving back to the JavaScript framework</font>

411
00:14:41,200 --> 00:14:46,600
these guys were incredibly active like I

412
00:14:44,680 --> 00:14:48,579
said they didn't redeploy the same

413
00:14:46,600 --> 00:14:51,130
version<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the JavaScript framework into</font>

414
00:14:48,580 --> 00:14:52,780
any victim and we could have pulled

415
00:14:51,130 --> 00:14:55,300
together<font color="#E5E5E5"> a little bit of a snapshot of</font>

416
00:14:52,780 --> 00:14:56,620
some of<font color="#E5E5E5"> their</font><font color="#CCCCCC"> activity so this is</font><font color="#E5E5E5"> just</font>

417
00:14:55,300 --> 00:15:00,130
an example of<font color="#E5E5E5"> the development lifecycle</font>

418
00:14:56,620 --> 00:15:02,770
from<font color="#CCCCCC"> first of June to 30</font><font color="#E5E5E5"> July in 2017</font>

419
00:15:00,130 --> 00:15:04,300
<font color="#E5E5E5">and there's actually a lot</font><font color="#CCCCCC"> of</font>

420
00:15:02,770 --> 00:15:06,040
developments to start off starting<font color="#E5E5E5"> off a</font>

421
00:15:04,300 --> 00:15:08,140
version of<font color="#E5E5E5"> one to four</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so the</font>

422
00:15:06,040 --> 00:15:10,120
<font color="#CCCCCC">JavaScript</font><font color="#E5E5E5"> framework has a value called</font>

423
00:15:08,140 --> 00:15:11,800
<font color="#CCCCCC">kaid built into</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> basically was</font>

424
00:15:10,120 --> 00:15:13,240
<font color="#E5E5E5">their version number which made actually</font>

425
00:15:11,800 --> 00:15:15,579
<font color="#E5E5E5">quite easy to track whatever they were</font>

426
00:15:13,240 --> 00:15:18,280
changing things and<font color="#CCCCCC"> even just</font><font color="#E5E5E5"> taking</font><font color="#CCCCCC"> a</font>

427
00:15:15,580 --> 00:15:19,060
July on its own there<font color="#E5E5E5"> are 21 working</font>

428
00:15:18,280 --> 00:15:20,620
days in<font color="#CCCCCC"> July</font>

429
00:15:19,060 --> 00:15:22,630
<font color="#CCCCCC">these guys produced 19 different</font>

430
00:15:20,620 --> 00:15:24,940
<font color="#E5E5E5">versions of the malware</font><font color="#CCCCCC"> and so it was</font>

431
00:15:22,630 --> 00:15:25,990
pretty<font color="#E5E5E5"> much something every</font><font color="#CCCCCC"> day</font><font color="#E5E5E5"> and they</font>

432
00:15:24,940 --> 00:15:28,330
were knocking on

433
00:15:25,990 --> 00:15:30,580
and from the visibility we have it looks

434
00:15:28,330 --> 00:15:33,160
like every<font color="#E5E5E5"> single version was targeting</font>

435
00:15:30,580 --> 00:15:34,840
a<font color="#CCCCCC"> different victim so in terms</font><font color="#E5E5E5"> of their</font>

436
00:15:33,160 --> 00:15:36,339
operations if you've got a developer or

437
00:15:34,840 --> 00:15:38,170
doing something full-time in terms of

438
00:15:36,340 --> 00:15:40,030
<font color="#E5E5E5">building new versions of this you then</font>

439
00:15:38,170 --> 00:15:42,459
<font color="#CCCCCC">obviously got other people</font><font color="#E5E5E5"> doing a lot</font>

440
00:15:40,030 --> 00:15:44,380
<font color="#CCCCCC">of the</font><font color="#E5E5E5"> deployment targeting recon work</font>

441
00:15:42,460 --> 00:15:46,840
<font color="#E5E5E5">and some of the expo and intrusion</font>

442
00:15:44,380 --> 00:15:49,390
operations as well that was kind of a

443
00:15:46,840 --> 00:15:51,640
<font color="#E5E5E5">two-month and snapshot of this if we</font>

444
00:15:49,390 --> 00:15:54,310
zoom out a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit the earliest</font>

445
00:15:51,640 --> 00:15:57,730
version that we have<font color="#E5E5E5"> and was version 19</font>

446
00:15:54,310 --> 00:16:00,160
of this stuff<font color="#E5E5E5"> the latest version was 204</font>

447
00:15:57,730 --> 00:16:01,600
<font color="#CCCCCC">if</font><font color="#E5E5E5"> we plot those on time there's a</font>

448
00:16:00,160 --> 00:16:02,740
couple<font color="#E5E5E5"> of little</font><font color="#CCCCCC"> quirks around the start</font>

449
00:16:01,600 --> 00:16:05,020
when they<font color="#E5E5E5"> work they</font><font color="#CCCCCC"> were playing</font><font color="#E5E5E5"> with</font>

450
00:16:02,740 --> 00:16:06,250
some<font color="#E5E5E5"> of the version numbers but</font><font color="#CCCCCC"> broadly</font>

451
00:16:05,020 --> 00:16:10,569
you can<font color="#CCCCCC"> see the</font><font color="#E5E5E5"> development lifecycle</font>

452
00:16:06,250 --> 00:16:12,400
from this is March and 2017 through<font color="#CCCCCC"> to</font>

453
00:16:10,570 --> 00:16:16,780
basically<font color="#E5E5E5"> the end of September or</font>

454
00:16:12,400 --> 00:16:18,310
<font color="#E5E5E5">October</font><font color="#CCCCCC"> and 2017</font><font color="#E5E5E5"> so almost with the</font>

455
00:16:16,780 --> 00:16:21,100
exception of a big spike at<font color="#CCCCCC"> the</font><font color="#E5E5E5"> start a</font>

456
00:16:18,310 --> 00:16:23,650
relatively linear<font color="#E5E5E5"> and kind of</font>

457
00:16:21,100 --> 00:16:25,360
development<font color="#E5E5E5"> lifecycle and some other</font>

458
00:16:23,650 --> 00:16:29,170
overlays that<font color="#CCCCCC"> we can do on this as well</font>

459
00:16:25,360 --> 00:16:31,330
that are quite interesting<font color="#CCCCCC"> so the terms</font>

460
00:16:29,170 --> 00:16:34,150
of some of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> changes a lot of these</font>

461
00:16:31,330 --> 00:16:36,130
micro evolutions were prompted by

462
00:16:34,150 --> 00:16:38,800
<font color="#E5E5E5">detection techniques not all of them</font>

463
00:16:36,130 --> 00:16:42,189
were<font color="#E5E5E5"> published but they kept</font><font color="#CCCCCC"> very close</font>

464
00:16:38,800 --> 00:16:43,870
eye on<font color="#E5E5E5"> when some of the security</font>

465
00:16:42,190 --> 00:16:46,030
<font color="#E5E5E5">solutions in the environments they were</font>

466
00:16:43,870 --> 00:16:47,350
targeting<font color="#E5E5E5"> we're picking them up so even</font>

467
00:16:46,030 --> 00:16:49,630
if<font color="#E5E5E5"> somebody hadn't released a blog</font><font color="#CCCCCC"> about</font>

468
00:16:47,350 --> 00:16:51,190
<font color="#E5E5E5">the activity what they were finding was</font>

469
00:16:49,630 --> 00:16:52,540
<font color="#E5E5E5">actually as soon as</font><font color="#CCCCCC"> AV was starting to</font>

470
00:16:51,190 --> 00:16:54,700
pick<font color="#E5E5E5"> up some of this stuff for</font><font color="#CCCCCC"> and I say</font>

471
00:16:52,540 --> 00:16:56,980
far I was blocking<font color="#E5E5E5"> it the perimeter they</font>

472
00:16:54,700 --> 00:16:59,050
would immediately make<font color="#E5E5E5"> changes</font><font color="#CCCCCC"> to it so</font>

473
00:16:56,980 --> 00:17:01,510
<font color="#E5E5E5">just even across versions from one</font>

474
00:16:59,050 --> 00:17:03,459
version to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> next they made a</font><font color="#E5E5E5"> bunch of</font>

475
00:17:01,510 --> 00:17:05,829
<font color="#CCCCCC">changes there are a couple of</font>

476
00:17:03,460 --> 00:17:09,250
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> things in this so the one on</font>

477
00:17:05,829 --> 00:17:12,399
the left<font color="#E5E5E5"> they realized in the bot ID and</font>

478
00:17:09,250 --> 00:17:14,369
so they had a little<font color="#CCCCCC"> C UID function</font><font color="#E5E5E5"> that</font>

479
00:17:12,400 --> 00:17:16,839
created a unique identifier<font color="#CCCCCC"> for that bot</font>

480
00:17:14,369 --> 00:17:18,520
but it wasn't unique<font color="#E5E5E5"> enough so they were</font>

481
00:17:16,839 --> 00:17:19,839
starting<font color="#CCCCCC"> to get conflicts</font><font color="#E5E5E5"> across</font>

482
00:17:18,520 --> 00:17:21,400
different victims<font color="#E5E5E5"> whenever they were</font>

483
00:17:19,839 --> 00:17:23,679
deploying it because sometimes<font color="#E5E5E5"> the hash</font>

484
00:17:21,400 --> 00:17:25,180
value would wouldn't<font color="#E5E5E5"> be unique enough so</font>

485
00:17:23,680 --> 00:17:28,420
on the version<font color="#E5E5E5"> on the right and they</font>

486
00:17:25,180 --> 00:17:30,370
built in a bot suffix<font color="#E5E5E5"> and so again for</font>

487
00:17:28,420 --> 00:17:32,140
each piece of<font color="#CCCCCC"> the framework they were</font>

488
00:17:30,370 --> 00:17:34,270
deploying<font color="#E5E5E5"> each of victim had its unique</font>

489
00:17:32,140 --> 00:17:35,950
suffix effectively because that that

490
00:17:34,270 --> 00:17:37,510
version<font color="#E5E5E5"> of the JavaScript would only be</font>

491
00:17:35,950 --> 00:17:38,730
deployed to<font color="#E5E5E5"> that victim so the</font>

492
00:17:37,510 --> 00:17:41,100
<font color="#E5E5E5">combination of that</font><font color="#CCCCCC"> plus</font>

493
00:17:38,730 --> 00:17:43,320
the<font color="#CCCCCC"> identifiers</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> made that system</font>

494
00:17:41,100 --> 00:17:45,870
<font color="#E5E5E5">and that specific victim unique and then</font>

495
00:17:43,320 --> 00:17:47,760
the<font color="#CCCCCC"> situ arrays that they used as well</font>

496
00:17:45,870 --> 00:17:50,370
and typically changed every few versions

497
00:17:47,760 --> 00:17:52,559
<font color="#E5E5E5">they did we use some of that but the</font>

498
00:17:50,370 --> 00:17:54,570
<font color="#E5E5E5">other bit there's a specific Caesar</font>

499
00:17:52,559 --> 00:17:56,220
cipher alphabet which again changed

500
00:17:54,570 --> 00:18:00,299
every single<font color="#E5E5E5"> version for this that</font>

501
00:17:56,220 --> 00:18:01,740
handled<font color="#E5E5E5"> the c2</font><font color="#CCCCCC"> protocol as well so</font><font color="#E5E5E5"> not</font>

502
00:18:00,299 --> 00:18:03,090
exactly strong encryption but just

503
00:18:01,740 --> 00:18:06,030
enough<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make sure he couldn't write</font>

504
00:18:03,090 --> 00:18:09,689
basic<font color="#CCCCCC"> IDs signatures for</font><font color="#E5E5E5"> it so that was</font>

505
00:18:06,030 --> 00:18:11,340
just<font color="#CCCCCC"> literary version</font><font color="#E5E5E5"> diversion and some</font>

506
00:18:09,690 --> 00:18:13,470
of the other things<font color="#CCCCCC"> that I did where</font>

507
00:18:11,340 --> 00:18:14,970
they<font color="#E5E5E5"> worked out some of the researchers</font>

508
00:18:13,470 --> 00:18:17,220
<font color="#E5E5E5">including us we were able</font><font color="#CCCCCC"> to automate</font>

509
00:18:14,970 --> 00:18:20,160
<font color="#E5E5E5">the decode of the entire JavaScript</font>

510
00:18:17,220 --> 00:18:21,750
<font color="#E5E5E5">framework this was actually several</font>

511
00:18:20,160 --> 00:18:23,640
<font color="#E5E5E5">layers deep so they had a master</font>

512
00:18:21,750 --> 00:18:26,040
<font color="#E5E5E5">JavaScript file which had a whole ton of</font>

513
00:18:23,640 --> 00:18:28,049
<font color="#E5E5E5">bit 64 encoded arrays in it whenever you</font>

514
00:18:26,040 --> 00:18:29,940
then<font color="#E5E5E5"> decode it each of those a bunch of</font>

515
00:18:28,049 --> 00:18:31,470
them also<font color="#CCCCCC"> contained</font><font color="#E5E5E5"> additional bits 64</font>

516
00:18:29,940 --> 00:18:33,299
arrays in it<font color="#E5E5E5"> whatever you then decoded</font>

517
00:18:31,470 --> 00:18:35,040
<font color="#CCCCCC">those you dropped</font><font color="#E5E5E5"> out the actual</font><font color="#CCCCCC"> Drac</font>

518
00:18:33,299 --> 00:18:36,929
<font color="#E5E5E5">JavaScript payload at the end of it so</font>

519
00:18:35,040 --> 00:18:39,629
it<font color="#E5E5E5"> was kind of several layers deep but</font>

520
00:18:36,929 --> 00:18:42,750
with the variables that<font color="#E5E5E5"> they used like</font>

521
00:18:39,630 --> 00:18:44,730
bot ID alpha<font color="#CCCCCC"> DK</font><font color="#E5E5E5"> k ID bot suffix and so</font>

522
00:18:42,750 --> 00:18:46,590
on it was<font color="#CCCCCC"> very easy</font><font color="#E5E5E5"> to write quick shell</font>

523
00:18:44,730 --> 00:18:47,940
script<font color="#CCCCCC"> that kind</font><font color="#E5E5E5"> of dropped through all</font>

524
00:18:46,590 --> 00:18:51,510
<font color="#CCCCCC">of that</font><font color="#E5E5E5"> and just decoded everything</font>

525
00:18:47,940 --> 00:18:53,760
straight<font color="#CCCCCC"> out what they did</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> try and</font>

526
00:18:51,510 --> 00:18:56,490
<font color="#CCCCCC">evade that</font><font color="#E5E5E5"> was randomly name all the</font>

527
00:18:53,760 --> 00:18:58,110
variables<font color="#CCCCCC"> a kind</font><font color="#E5E5E5"> of two character things</font>

528
00:18:56,490 --> 00:19:02,549
of the one<font color="#E5E5E5"> on the right starts with C</font><font color="#CCCCCC"> v</font>

529
00:18:58,110 --> 00:19:03,870
<font color="#E5E5E5">CW c XC YC GCM etc and so those those</font>

530
00:19:02,549 --> 00:19:05,490
<font color="#E5E5E5">things started kind</font><font color="#CCCCCC"> of and went</font>

531
00:19:03,870 --> 00:19:07,020
incrementally and then rotated whenever

532
00:19:05,490 --> 00:19:08,400
they got to the<font color="#E5E5E5"> end of the</font><font color="#CCCCCC"> alphabet and</font>

533
00:19:07,020 --> 00:19:09,750
<font color="#E5E5E5">again those were different for every</font>

534
00:19:08,400 --> 00:19:11,760
<font color="#CCCCCC">single</font><font color="#E5E5E5"> one so there was no way of doing</font>

535
00:19:09,750 --> 00:19:15,299
<font color="#CCCCCC">a specific</font><font color="#E5E5E5"> search for those you had to</font>

536
00:19:11,760 --> 00:19:16,169
build<font color="#CCCCCC"> another routine</font><font color="#E5E5E5"> to do it so that</font>

537
00:19:15,299 --> 00:19:16,559
was a little bit<font color="#E5E5E5"> of like what that</font>

538
00:19:16,169 --> 00:19:19,650
looked like

539
00:19:16,559 --> 00:19:20,970
<font color="#E5E5E5">we obviously then tried</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get that</font><font color="#CCCCCC"> on a</font>

540
00:19:19,650 --> 00:19:22,799
graph<font color="#E5E5E5"> I'm not expecting you</font><font color="#CCCCCC"> to read this</font>

541
00:19:20,970 --> 00:19:24,480
<font color="#E5E5E5">but whenever we started mapping I every</font>

542
00:19:22,799 --> 00:19:26,910
single<font color="#CCCCCC"> file name every single to me and</font>

543
00:19:24,480 --> 00:19:29,160
every<font color="#E5E5E5"> single URL</font><font color="#CCCCCC"> and that they used</font><font color="#E5E5E5"> for</font>

544
00:19:26,910 --> 00:19:31,980
this stuff<font color="#CCCCCC"> and it became pretty obvious</font>

545
00:19:29,160 --> 00:19:34,020
that this returning is a quite big big

546
00:19:31,980 --> 00:19:35,520
graph<font color="#E5E5E5"> but give</font><font color="#CCCCCC"> us some pretty good stuff</font>

547
00:19:34,020 --> 00:19:37,559
that<font color="#E5E5E5"> we can then feed into detection</font>

548
00:19:35,520 --> 00:19:39,510
techniques and actually there<font color="#E5E5E5"> was a lot</font>

549
00:19:37,559 --> 00:19:41,870
of video<font color="#E5E5E5"> of this which I have lost</font>

550
00:19:39,510 --> 00:19:45,900
somewhere

551
00:19:41,870 --> 00:19:48,389
yeah<font color="#E5E5E5"> don't worry about it</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> video</font>

552
00:19:45,900 --> 00:19:50,370
<font color="#E5E5E5">showing some of the decoding on it so</font>

553
00:19:48,390 --> 00:19:52,200
one of the things that we're always

554
00:19:50,370 --> 00:19:53,428
<font color="#E5E5E5">quite interested in oh we've</font><font color="#CCCCCC"> seen</font><font color="#E5E5E5"> this</font>

555
00:19:52,200 --> 00:19:55,320
with a<font color="#E5E5E5"> bunch of the other</font><font color="#CCCCCC"> actors and</font>

556
00:19:53,429 --> 00:19:56,850
<font color="#CCCCCC">actually some of</font><font color="#E5E5E5"> the ones</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> cost and</font>

557
00:19:55,320 --> 00:19:58,500
spoke<font color="#E5E5E5"> about this</font><font color="#CCCCCC"> morning</font><font color="#E5E5E5"> and</font>

558
00:19:56,850 --> 00:20:00,719
particularly the<font color="#E5E5E5"> high end espionage</font>

559
00:19:58,500 --> 00:20:02,580
groups<font color="#E5E5E5"> pay really close attention to</font>

560
00:20:00,720 --> 00:20:04,410
<font color="#E5E5E5">when they're discovered or when anybody</font>

561
00:20:02,580 --> 00:20:06,330
publishes on them to the<font color="#E5E5E5"> point where</font>

562
00:20:04,410 --> 00:20:07,890
some<font color="#CCCCCC"> of the really high-end ones will</font>

563
00:20:06,330 --> 00:20:10,020
literally<font color="#E5E5E5"> tear down their entire</font>

564
00:20:07,890 --> 00:20:12,150
<font color="#E5E5E5">infrastructure</font><font color="#CCCCCC"> remove all their</font><font color="#E5E5E5"> implants</font>

565
00:20:10,020 --> 00:20:14,240
etc<font color="#E5E5E5"> in a matter of minutes after</font><font color="#CCCCCC"> being</font>

566
00:20:12,150 --> 00:20:18,210
<font color="#E5E5E5">discovered or somebody publishes a</font><font color="#CCCCCC"> blog</font>

567
00:20:14,240 --> 00:20:19,860
<font color="#CCCCCC">on them so</font><font color="#E5E5E5"> if you want any good stories</font>

568
00:20:18,210 --> 00:20:22,050
of like that cost<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> have a few that</font>

569
00:20:19,860 --> 00:20:23,699
can<font color="#E5E5E5"> tell you</font><font color="#CCCCCC"> over beers</font><font color="#E5E5E5"> these guys as</font>

570
00:20:22,050 --> 00:20:26,040
well<font color="#E5E5E5"> pay pretty close attention to a lot</font>

571
00:20:23,700 --> 00:20:27,809
<font color="#CCCCCC">of</font><font color="#E5E5E5"> stuff so</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> looking at some of the</font>

572
00:20:26,040 --> 00:20:30,090
blog's<font color="#E5E5E5"> that were published about them</font>

573
00:20:27,809 --> 00:20:32,220
<font color="#CCCCCC">summer last year</font><font color="#E5E5E5"> was one of their really</font>

574
00:20:30,090 --> 00:20:34,320
<font color="#E5E5E5">heightened periods of activity so just a</font>

575
00:20:32,220 --> 00:20:36,179
<font color="#E5E5E5">few</font><font color="#CCCCCC"> months</font><font color="#E5E5E5"> before they arrests and a</font>

576
00:20:34,320 --> 00:20:38,280
correspond<font color="#E5E5E5"> to some of the best industry</font>

577
00:20:36,179 --> 00:20:41,480
publications on them as well<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> have</font>

578
00:20:38,280 --> 00:20:44,399
fire<font color="#E5E5E5"> I in March 2017 talking about the</font>

579
00:20:41,480 --> 00:20:47,130
<font color="#E5E5E5">sec themed like financially themed and</font>

580
00:20:44,400 --> 00:20:49,230
spearfishing<font color="#E5E5E5"> campaigns they ran more few</font>

581
00:20:47,130 --> 00:20:50,550
<font color="#E5E5E5">sec and then just a</font><font color="#CCCCCC"> few days</font><font color="#E5E5E5"> later and</font><font color="#CCCCCC"> i</font>

582
00:20:49,230 --> 00:20:52,140
said<font color="#CCCCCC"> they're discovered at what they</font>

583
00:20:50,550 --> 00:20:54,960
originally described as a polymorphic

584
00:20:52,140 --> 00:20:56,280
fire less attack and to which a few of

585
00:20:54,960 --> 00:20:58,050
us<font color="#E5E5E5"> pointed out and actually the</font><font color="#CCCCCC"> thing</font>

586
00:20:56,280 --> 00:21:00,300
leaves files scattered all over<font color="#CCCCCC"> disk and</font>

587
00:20:58,050 --> 00:21:03,840
so polymorphic and<font color="#E5E5E5"> file this or maybe</font>

588
00:21:00,300 --> 00:21:07,678
<font color="#E5E5E5">overriding it slightly</font><font color="#CCCCCC"> then did</font><font color="#E5E5E5"> another</font>

589
00:21:03,840 --> 00:21:09,809
set of blog posts<font color="#CCCCCC"> in june</font><font color="#E5E5E5"> about the</font>

590
00:21:07,679 --> 00:21:11,420
restaurant targeting fire<font color="#CCCCCC"> i mentioned</font>

591
00:21:09,809 --> 00:21:13,500
them quite a<font color="#E5E5E5"> lot in a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

592
00:21:11,420 --> 00:21:14,880
discussion papers<font color="#E5E5E5"> there's a guy called</font>

593
00:21:13,500 --> 00:21:16,590
daniel Bohannon if you haven't seen this

594
00:21:14,880 --> 00:21:17,850
white paper on confiscation techniques

595
00:21:16,590 --> 00:21:20,220
it is well worth they read whether

596
00:21:17,850 --> 00:21:22,559
<font color="#CCCCCC">you're a blue team or red team and then</font>

597
00:21:20,220 --> 00:21:25,590
a<font color="#E5E5E5"> company called iceberg which designs a</font>

598
00:21:22,559 --> 00:21:27,540
network<font color="#E5E5E5"> sensor had responded to a few</font>

599
00:21:25,590 --> 00:21:29,909
cases<font color="#E5E5E5"> including one of our clients and</font>

600
00:21:27,540 --> 00:21:33,120
published some<font color="#CCCCCC"> of their</font><font color="#E5E5E5"> findings and</font>

601
00:21:29,910 --> 00:21:35,250
then our<font color="#E5E5E5"> good friends at Talos and did</font>

602
00:21:33,120 --> 00:21:36,479
one of<font color="#CCCCCC"> the best posts on some of the new</font>

603
00:21:35,250 --> 00:21:37,950
<font color="#CCCCCC">JavaScript stuff</font><font color="#E5E5E5"> which was known as</font>

604
00:21:36,480 --> 00:21:40,650
<font color="#CCCCCC">Bethel</font><font color="#E5E5E5"> or a battler I'm not quite sure</font>

605
00:21:37,950 --> 00:21:42,540
how<font color="#CCCCCC"> you pronounce</font><font color="#E5E5E5"> it in September and</font>

606
00:21:40,650 --> 00:21:46,020
then<font color="#E5E5E5"> iceberg did their last public one</font>

607
00:21:42,540 --> 00:21:49,500
at the<font color="#E5E5E5"> very start of October</font><font color="#CCCCCC"> in 2017</font><font color="#E5E5E5"> so</font>

608
00:21:46,020 --> 00:21:52,050
if we go back<font color="#CCCCCC"> to the timeline of</font><font color="#E5E5E5"> when</font>

609
00:21:49,500 --> 00:21:54,509
these guys<font color="#E5E5E5"> were actually releasing new</font>

610
00:21:52,050 --> 00:21:56,428
versions<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> actually align so</font>

611
00:21:54,509 --> 00:21:57,539
the development<font color="#CCCCCC"> Sprint's they did</font><font color="#E5E5E5"> where</font>

612
00:21:56,429 --> 00:21:59,249
<font color="#CCCCCC">they were</font><font color="#E5E5E5"> coming out like really</font>

613
00:21:57,539 --> 00:22:01,169
frequently<font color="#E5E5E5"> with new versions to some of</font>

614
00:21:59,249 --> 00:22:02,969
the blog posts<font color="#E5E5E5"> and so there's a little</font>

615
00:22:01,169 --> 00:22:05,009
<font color="#E5E5E5">clusters of activity that overlap</font>

616
00:22:02,969 --> 00:22:07,440
<font color="#E5E5E5">particularly up in the Canada somewhere</font>

617
00:22:05,009 --> 00:22:10,529
last year<font color="#CCCCCC"> Center</font><font color="#E5E5E5"> about it kind</font><font color="#CCCCCC"> of just</font>

618
00:22:07,440 --> 00:22:12,509
over<font color="#E5E5E5"> halfway we're almost within kind of</font>

619
00:22:10,529 --> 00:22:13,799
a day or<font color="#CCCCCC"> two of</font><font color="#E5E5E5"> a blog post coming out</font>

620
00:22:12,509 --> 00:22:15,179
they would<font color="#E5E5E5"> have several new versions</font>

621
00:22:13,799 --> 00:22:17,129
like<font color="#E5E5E5"> with a whole bunch of the the</font>

622
00:22:15,179 --> 00:22:19,799
techniques<font color="#E5E5E5"> to aviod</font><font color="#CCCCCC"> however</font><font color="#E5E5E5"> the previous</font>

623
00:22:17,129 --> 00:22:22,168
<font color="#E5E5E5">researchers were or catching them and</font>

624
00:22:19,799 --> 00:22:24,690
<font color="#E5E5E5">then they did a wholesale</font><font color="#CCCCCC"> change in the</font>

625
00:22:22,169 --> 00:22:26,519
entire framework on the<font color="#E5E5E5"> 6th of October</font>

626
00:22:24,690 --> 00:22:29,099
<font color="#E5E5E5">which was literally just a few days</font>

627
00:22:26,519 --> 00:22:30,449
after<font color="#CCCCCC"> Tallis's blog post their 27th of</font>

628
00:22:29,099 --> 00:22:34,249
September so they obviously<font color="#CCCCCC"> had somebody</font>

629
00:22:30,449 --> 00:22:34,249
<font color="#E5E5E5">pretty focused on rewriting</font><font color="#CCCCCC"> this stuff</font>

630
00:22:36,019 --> 00:22:41,669
so into targeting some of<font color="#CCCCCC"> their</font>

631
00:22:40,079 --> 00:22:43,408
targeting unsurprising it was pretty

632
00:22:41,669 --> 00:22:45,809
obvious<font color="#E5E5E5"> they designed a lot of</font>

633
00:22:43,409 --> 00:22:46,889
infrastructure<font color="#E5E5E5"> to mimic the victims they</font>

634
00:22:45,809 --> 00:22:49,649
were going after<font color="#E5E5E5"> or at least their</font>

635
00:22:46,889 --> 00:22:52,379
sectors<font color="#E5E5E5"> so everything from Waffle House</font>

636
00:22:49,649 --> 00:22:54,658
two strikes with lucky<font color="#E5E5E5"> through two</font>

637
00:22:52,379 --> 00:22:56,039
delicious<font color="#E5E5E5"> wings and</font><font color="#CCCCCC"> dominoes you can</font>

638
00:22:54,659 --> 00:22:58,019
<font color="#CCCCCC">actually tell from</font><font color="#E5E5E5"> the demands that</font><font color="#CCCCCC"> were</font>

639
00:22:56,039 --> 00:23:00,899
using for<font color="#CCCCCC"> some</font><font color="#E5E5E5"> of the fishing who they</font>

640
00:22:58,019 --> 00:23:02,789
were<font color="#CCCCCC"> targeting and the command and</font>

641
00:23:00,899 --> 00:23:05,218
<font color="#E5E5E5">control infrastructure the back end was</font>

642
00:23:02,789 --> 00:23:07,709
more kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> like Google service or</font>

643
00:23:05,219 --> 00:23:08,940
cloud-based themes and which is why

644
00:23:07,709 --> 00:23:10,349
there's another little cluster

645
00:23:08,940 --> 00:23:11,369
associated with<font color="#E5E5E5"> a</font><font color="#CCCCCC"> stop</font><font color="#E5E5E5"> touch all of</font><font color="#CCCCCC"> the</font>

646
00:23:10,349 --> 00:23:13,619
<font color="#CCCCCC">sec it's one of the reasons we think</font>

647
00:23:11,369 --> 00:23:14,819
<font color="#CCCCCC">they're related to fin</font><font color="#E5E5E5"> 7 and but quite a</font>

648
00:23:13,619 --> 00:23:16,859
lot<font color="#CCCCCC"> of their targeting was pretty</font>

649
00:23:14,819 --> 00:23:22,049
obvious<font color="#E5E5E5"> from the domains that were using</font>

650
00:23:16,859 --> 00:23:24,359
<font color="#CCCCCC">so back to the indictment the</font>

651
00:23:22,049 --> 00:23:26,549
<font color="#E5E5E5">interesting bit from this from from our</font>

652
00:23:24,359 --> 00:23:28,349
perspective is that<font color="#E5E5E5"> the last part of</font>

653
00:23:26,549 --> 00:23:30,149
<font color="#E5E5E5">this so fin 7 often utilize various</font>

654
00:23:28,349 --> 00:23:31,859
off-the-shelf software and custom

655
00:23:30,149 --> 00:23:34,468
malware so I've<font color="#E5E5E5"> already mentioned things</font>

656
00:23:31,859 --> 00:23:37,379
like<font color="#E5E5E5"> me me cats or sorry</font><font color="#CCCCCC"> I'm meterpreter</font>

657
00:23:34,469 --> 00:23:39,479
<font color="#E5E5E5">and a custom</font><font color="#CCCCCC"> our like</font><font color="#E5E5E5"> a pause terminals</font>

658
00:23:37,379 --> 00:23:42,029
<font color="#E5E5E5">and a combination thereof to extract and</font>

659
00:23:39,479 --> 00:23:45,599
transfer<font color="#CCCCCC"> data to a loot folder on one or</font>

660
00:23:42,029 --> 00:23:46,259
more<font color="#E5E5E5"> servers control</font><font color="#CCCCCC"> by fin seven so one</font>

661
00:23:45,599 --> 00:23:48,629
of the things that we were doing

662
00:23:46,259 --> 00:23:50,129
<font color="#E5E5E5">particularly after the</font><font color="#CCCCCC"> ir cases that we</font>

663
00:23:48,629 --> 00:23:53,309
worked where we find the<font color="#E5E5E5"> dump product</font>

664
00:23:50,129 --> 00:23:55,529
ps1 scripts<font color="#CCCCCC"> that unloaded</font><font color="#E5E5E5"> the the pause</font>

665
00:23:53,309 --> 00:23:58,199
malware we're going and looking for

666
00:23:55,529 --> 00:24:00,329
unique strings in that that we could

667
00:23:58,199 --> 00:24:02,219
find anywhere so across<font color="#E5E5E5"> our malware</font>

668
00:24:00,329 --> 00:24:04,580
repos<font color="#CCCCCC"> that we've got access to</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> even</font>

669
00:24:02,219 --> 00:24:06,800
just very simple<font color="#CCCCCC"> google</font><font color="#E5E5E5"> searches for it</font>

670
00:24:04,580 --> 00:24:09,379
one of the things which<font color="#E5E5E5"> we find was</font>

671
00:24:06,800 --> 00:24:10,820
<font color="#E5E5E5">their command</font><font color="#CCCCCC"> and control panel</font><font color="#E5E5E5"> so we</font>

672
00:24:09,380 --> 00:24:12,950
actually<font color="#E5E5E5"> find a version of this that</font>

673
00:24:10,820 --> 00:24:16,610
<font color="#CCCCCC">they had</font><font color="#E5E5E5"> slipped up with and forgotten</font>

674
00:24:12,950 --> 00:24:18,380
<font color="#E5E5E5">to protect so a little bit sloppy from</font>

675
00:24:16,610 --> 00:24:21,350
their perspective<font color="#E5E5E5"> but</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> find this</font>

676
00:24:18,380 --> 00:24:23,900
within about three weeks of<font color="#E5E5E5"> them making</font>

677
00:24:21,350 --> 00:24:26,120
<font color="#CCCCCC">that mistake and this was where the</font>

678
00:24:23,900 --> 00:24:28,070
Department of Justice got the<font color="#E5E5E5"> loots term</font>

679
00:24:26,120 --> 00:24:30,739
from so the<font color="#E5E5E5"> menu on the left was hosts</font>

680
00:24:28,070 --> 00:24:32,240
which is what you see there<font color="#E5E5E5"> so every</font>

681
00:24:30,740 --> 00:24:35,030
host that<font color="#E5E5E5"> was infected</font><font color="#CCCCCC"> with a JavaScript</font>

682
00:24:32,240 --> 00:24:35,810
framework<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> Lutz which was all of</font>

683
00:24:35,030 --> 00:24:38,510
the stuff that<font color="#E5E5E5"> they were able to</font>

684
00:24:35,810 --> 00:24:41,300
<font color="#E5E5E5">actually get from those systems</font><font color="#CCCCCC"> so this</font>

685
00:24:38,510 --> 00:24:42,800
<font color="#CCCCCC">was</font><font color="#E5E5E5"> actually a pretty</font><font color="#CCCCCC"> good insight into</font>

686
00:24:41,300 --> 00:24:44,810
<font color="#E5E5E5">what these guys were doing who they've</font>

687
00:24:42,800 --> 00:24:47,389
been targeting and in some of<font color="#CCCCCC"> the</font>

688
00:24:44,810 --> 00:24:49,700
malware<font color="#E5E5E5"> they'd been using so as well as</font>

689
00:24:47,390 --> 00:24:51,500
the list<font color="#E5E5E5"> of the systems we were</font><font color="#CCCCCC"> able to</font>

690
00:24:49,700 --> 00:24:53,410
see the<font color="#E5E5E5"> history of all of</font><font color="#CCCCCC"> the commands</font>

691
00:24:51,500 --> 00:24:57,440
that<font color="#E5E5E5"> they had run</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> those systems</font>

692
00:24:53,410 --> 00:24:59,060
including when it was run and the hood

693
00:24:57,440 --> 00:25:00,770
of it so the output was stored<font color="#E5E5E5"> on disk</font>

694
00:24:59,060 --> 00:25:02,690
<font color="#E5E5E5">and</font><font color="#CCCCCC"> there was a little command you can</font>

695
00:25:00,770 --> 00:25:05,060
run through<font color="#CCCCCC"> this</font><font color="#E5E5E5"> a panel to actually</font>

696
00:25:02,690 --> 00:25:06,680
grab the<font color="#E5E5E5"> output and pull it back</font><font color="#CCCCCC"> so you</font>

697
00:25:05,060 --> 00:25:08,810
can then see what was happening<font color="#CCCCCC"> so of</font>

698
00:25:06,680 --> 00:25:10,280
course we<font color="#E5E5E5"> would a kind of scraper that</font>

699
00:25:08,810 --> 00:25:12,139
<font color="#E5E5E5">just went through it all and pulled</font>

700
00:25:10,280 --> 00:25:13,399
everything<font color="#E5E5E5"> back</font><font color="#CCCCCC"> one of the</font><font color="#E5E5E5"> more</font>

701
00:25:12,140 --> 00:25:15,680
interesting things<font color="#CCCCCC"> about this group was</font>

702
00:25:13,400 --> 00:25:18,140
that<font color="#CCCCCC"> there quite often lumped in with</font>

703
00:25:15,680 --> 00:25:19,460
another group called<font color="#E5E5E5"> carbonic and which</font>

704
00:25:18,140 --> 00:25:21,680
<font color="#CCCCCC">actually isn't a group it's a malware</font>

705
00:25:19,460 --> 00:25:24,020
family used by several<font color="#CCCCCC"> groups</font><font color="#E5E5E5"> and there</font>

706
00:25:21,680 --> 00:25:26,450
was always<font color="#E5E5E5"> a bit</font><font color="#CCCCCC"> of debate as to whether</font>

707
00:25:24,020 --> 00:25:28,160
<font color="#E5E5E5">fin 7 was related to those guys or</font>

708
00:25:26,450 --> 00:25:33,080
whether they were<font color="#E5E5E5"> the carbonate</font><font color="#CCCCCC"> group</font>

709
00:25:28,160 --> 00:25:36,230
one<font color="#E5E5E5"> in the same this kind of proved our</font>

710
00:25:33,080 --> 00:25:38,419
link to the<font color="#CCCCCC"> carbon act or</font><font color="#E5E5E5"> to fin sevens</font>

711
00:25:36,230 --> 00:25:40,250
use of carbon act<font color="#E5E5E5"> so one</font><font color="#CCCCCC"> of the search</font>

712
00:25:38,420 --> 00:25:42,170
terms that<font color="#E5E5E5"> we were running</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> the</font>

713
00:25:40,250 --> 00:25:43,910
<font color="#E5E5E5">incident that we were looking at where</font>

714
00:25:42,170 --> 00:25:46,520
we've got some of those scripts popped

715
00:25:43,910 --> 00:25:47,960
up here and then<font color="#E5E5E5"> whenever we pulled some</font>

716
00:25:46,520 --> 00:25:49,460
<font color="#E5E5E5">of the payloads</font><font color="#CCCCCC"> back that had been run</font>

717
00:25:47,960 --> 00:25:50,840
<font color="#CCCCCC">on victim systems we</font><font color="#E5E5E5"> were able to</font>

718
00:25:49,460 --> 00:25:52,880
conclusively<font color="#CCCCCC"> shield one</font><font color="#E5E5E5"> of them was</font>

719
00:25:50,840 --> 00:25:55,820
indeed<font color="#E5E5E5"> carbon</font><font color="#CCCCCC"> AK so we had</font><font color="#E5E5E5"> actually seen</font>

720
00:25:52,880 --> 00:25:57,310
<font color="#E5E5E5">firsthand</font><font color="#CCCCCC"> fin</font><font color="#E5E5E5"> 7 deploying the carbon act</font>

721
00:25:55,820 --> 00:25:59,659
malware into some of the victims<font color="#E5E5E5"> and</font>

722
00:25:57,310 --> 00:26:01,129
<font color="#CCCCCC">this</font><font color="#E5E5E5"> proved quite useful in</font><font color="#CCCCCC"> terms of</font>

723
00:25:59,660 --> 00:26:02,180
just<font color="#CCCCCC"> being able to see a bit about what</font>

724
00:26:01,130 --> 00:26:05,030
they were up to and<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> the things</font>

725
00:26:02,180 --> 00:26:06,800
they were<font color="#E5E5E5"> they were testing on the other</font>

726
00:26:05,030 --> 00:26:08,600
bit that we find quite<font color="#CCCCCC"> interesting and</font>

727
00:26:06,800 --> 00:26:10,310
<font color="#E5E5E5">their development</font><font color="#CCCCCC"> was their build</font>

728
00:26:08,600 --> 00:26:12,050
pipeline so as I mentioned they were

729
00:26:10,310 --> 00:26:16,100
doing a new<font color="#CCCCCC"> build</font><font color="#E5E5E5"> almost every</font><font color="#CCCCCC"> single</font>

730
00:26:12,050 --> 00:26:17,870
day<font color="#E5E5E5"> we find a rather</font><font color="#CCCCCC"> curious fact and</font>

731
00:26:16,100 --> 00:26:20,990
<font color="#CCCCCC">I've liked that build process</font>

732
00:26:17,870 --> 00:26:23,600
if you look at the part of me<font color="#E5E5E5"> you look</font>

733
00:26:20,990 --> 00:26:27,470
at<font color="#E5E5E5"> the time lines of when some of this</font>

734
00:26:23,600 --> 00:26:29,659
stuff<font color="#E5E5E5"> was created some of it was first</font>

735
00:26:27,470 --> 00:26:32,120
seen in<font color="#CCCCCC"> the wild</font><font color="#E5E5E5"> on virustotal</font>

736
00:26:29,660 --> 00:26:33,890
<font color="#E5E5E5">and then first uploaded to virustotal or</font>

737
00:26:32,120 --> 00:26:36,020
some quite interesting discrepancies<font color="#E5E5E5"> and</font>

738
00:26:33,890 --> 00:26:37,460
it was quite often the case<font color="#CCCCCC"> that</font>

739
00:26:36,020 --> 00:26:39,559
whenever<font color="#E5E5E5"> one of their documents was</font>

740
00:26:37,460 --> 00:26:41,690
uploaded to<font color="#CCCCCC"> virustotal virustotal</font>

741
00:26:39,559 --> 00:26:44,570
<font color="#E5E5E5">reported that had it had first seen the</font>

742
00:26:41,690 --> 00:26:46,910
<font color="#E5E5E5">hash in the wild</font><font color="#CCCCCC"> before the document was</font>

743
00:26:44,570 --> 00:26:48,770
first<font color="#E5E5E5"> uploaded so digging into that a</font>

744
00:26:46,910 --> 00:26:51,080
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> more in testing it</font><font color="#E5E5E5"> it looks</font>

745
00:26:48,770 --> 00:26:51,770
like<font color="#E5E5E5"> if you search for a hash from</font>

746
00:26:51,080 --> 00:26:53,600
<font color="#CCCCCC">virustotal</font>

747
00:26:51,770 --> 00:26:56,150
and virus tool doesn't<font color="#CCCCCC"> actually have the</font>

748
00:26:53,600 --> 00:26:58,370
<font color="#E5E5E5">file it will record the fact that you</font>

749
00:26:56,150 --> 00:27:00,140
searched for<font color="#CCCCCC"> the hash</font><font color="#E5E5E5"> and then when the</font>

750
00:26:58,370 --> 00:27:03,340
file is litter uploaded it<font color="#E5E5E5"> will show</font>

751
00:27:00,140 --> 00:27:05,960
that<font color="#E5E5E5"> search as the first in the wild and</font>

752
00:27:03,340 --> 00:27:08,300
<font color="#CCCCCC">submission</font><font color="#E5E5E5"> so the interesting</font><font color="#CCCCCC"> bit of</font>

753
00:27:05,960 --> 00:27:09,800
like this was obviously<font color="#E5E5E5"> meter data in</font>

754
00:27:08,300 --> 00:27:12,470
some of the document templates is in

755
00:27:09,800 --> 00:27:15,080
<font color="#E5E5E5">local timezone virus totals</font><font color="#CCCCCC"> time stamps</font>

756
00:27:12,470 --> 00:27:18,290
are in UTC so we<font color="#E5E5E5"> can actually see these</font>

757
00:27:15,080 --> 00:27:21,649
guys creating a document<font color="#CCCCCC"> and</font><font color="#E5E5E5"> this was at</font>

758
00:27:18,290 --> 00:27:24,170
<font color="#CCCCCC">0 5:14</font><font color="#E5E5E5"> local time document was last</font>

759
00:27:21,650 --> 00:27:27,080
modified<font color="#CCCCCC"> zero five twenty five was</font><font color="#E5E5E5"> in</font>

760
00:27:24,170 --> 00:27:29,059
<font color="#E5E5E5">nine minutes litter zero to twenty five</font>

761
00:27:27,080 --> 00:27:31,610
it was first seen in<font color="#CCCCCC"> the wild and</font><font color="#E5E5E5"> virus</font>

762
00:27:29,059 --> 00:27:34,580
<font color="#E5E5E5">total and then a wild litter it was</font>

763
00:27:31,610 --> 00:27:37,129
uploaded<font color="#E5E5E5"> by a victim and so there was</font>

764
00:27:34,580 --> 00:27:40,580
this discrepancy<font color="#CCCCCC"> of local time of the</font>

765
00:27:37,130 --> 00:27:42,530
documents<font color="#E5E5E5"> and UTC being almost exactly</font>

766
00:27:40,580 --> 00:27:44,389
<font color="#CCCCCC">three hours</font><font color="#E5E5E5"> and what we worked out was</font>

767
00:27:42,530 --> 00:27:46,250
<font color="#E5E5E5">there was part of the build pipeline for</font>

768
00:27:44,390 --> 00:27:48,290
these guys<font color="#E5E5E5"> that every time they created</font>

769
00:27:46,250 --> 00:27:49,880
a new<font color="#E5E5E5"> javascript file they would search</font>

770
00:27:48,290 --> 00:27:53,059
for<font color="#CCCCCC"> the existence of the hash of that</font>

771
00:27:49,880 --> 00:27:54,770
file on virustotal<font color="#E5E5E5"> and so whenever then</font>

772
00:27:53,059 --> 00:27:56,690
somebody uploaded it you can<font color="#CCCCCC"> actually</font>

773
00:27:54,770 --> 00:27:57,830
<font color="#E5E5E5">see when the</font><font color="#CCCCCC"> malware author had tested</font>

774
00:27:56,690 --> 00:27:59,660
it because they had previously searched

775
00:27:57,830 --> 00:28:01,309
for the hash<font color="#CCCCCC"> and so there</font><font color="#E5E5E5"> are a whole</font>

776
00:27:59,660 --> 00:28:04,700
<font color="#CCCCCC">bunch</font><font color="#E5E5E5"> of examples</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> these this</font><font color="#CCCCCC"> is just</font>

777
00:28:01,309 --> 00:28:06,559
another one so<font color="#CCCCCC"> 950 local time</font><font color="#E5E5E5"> 956 and</font>

778
00:28:04,700 --> 00:28:09,320
local times last modified so<font color="#CCCCCC"> it took</font>

779
00:28:06,559 --> 00:28:11,720
them six minutes to create<font color="#E5E5E5"> this one 656</font>

780
00:28:09,320 --> 00:28:13,370
and so<font color="#CCCCCC"> within literally</font><font color="#E5E5E5"> within the same</font>

781
00:28:11,720 --> 00:28:15,470
minute<font color="#E5E5E5"> the</font><font color="#CCCCCC"> hash</font><font color="#E5E5E5"> for search for</font><font color="#CCCCCC"> virus</font>

782
00:28:13,370 --> 00:28:17,809
<font color="#E5E5E5">total and then a while later a victim</font>

783
00:28:15,470 --> 00:28:19,550
uploaded it it's a really<font color="#CCCCCC"> good</font>

784
00:28:17,809 --> 00:28:21,260
<font color="#E5E5E5">indication</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> these guys were in a UTC</font>

785
00:28:19,550 --> 00:28:23,680
plus<font color="#E5E5E5"> three times over which is obviously</font>

786
00:28:21,260 --> 00:28:25,900
you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> Ukraine</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> Russia</font>

787
00:28:23,680 --> 00:28:28,420
so<font color="#E5E5E5"> getting</font><font color="#CCCCCC"> to some of the</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> real-world</font>

788
00:28:25,900 --> 00:28:30,460
<font color="#E5E5E5">side of this</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is where some of the</font>

789
00:28:28,420 --> 00:28:32,530
the Department of Justice reporting is

790
00:28:30,460 --> 00:28:35,320
really quite<font color="#CCCCCC"> fascinating</font><font color="#E5E5E5"> the way these</font>

791
00:28:32,530 --> 00:28:37,270
guys<font color="#E5E5E5"> worked was</font><font color="#CCCCCC"> that they actually had</font>

792
00:28:35,320 --> 00:28:39,340
some core<font color="#E5E5E5"> people in a group but they ran</font>

793
00:28:37,270 --> 00:28:42,460
a front<font color="#E5E5E5"> company called combi security</font>

794
00:28:39,340 --> 00:28:44,050
that advertised pentesting services and

795
00:28:42,460 --> 00:28:46,420
so they created job post on LinkedIn

796
00:28:44,050 --> 00:28:48,580
they hired people<font color="#E5E5E5"> in Israel</font><font color="#CCCCCC"> and Russia</font>

797
00:28:46,420 --> 00:28:51,040
and<font color="#CCCCCC"> elsewhere to</font><font color="#E5E5E5"> actually help them do</font>

798
00:28:48,580 --> 00:28:53,740
ten tests and they<font color="#E5E5E5"> managed the whole</font>

799
00:28:51,040 --> 00:28:55,300
process with JIRA and HipChat and other

800
00:28:53,740 --> 00:28:56,950
things<font color="#E5E5E5"> and would assign tasks so these</font>

801
00:28:55,300 --> 00:28:59,710
<font color="#E5E5E5">people to either do development work for</font>

802
00:28:56,950 --> 00:29:01,810
them or like<font color="#E5E5E5"> do week on an organization</font>

803
00:28:59,710 --> 00:29:03,010
or<font color="#E5E5E5"> exfil from an organization and for</font>

804
00:29:01,810 --> 00:29:04,389
the most<font color="#E5E5E5"> part</font><font color="#CCCCCC"> a whole load of</font><font color="#E5E5E5"> those</font>

805
00:29:03,010 --> 00:29:07,420
<font color="#E5E5E5">contractors had no idea they were</font>

806
00:29:04,390 --> 00:29:11,140
actually conducting see any operations

807
00:29:07,420 --> 00:29:12,910
at all<font color="#E5E5E5"> and so the DOJ kind of obviously</font>

808
00:29:11,140 --> 00:29:14,410
done a bit to try and figure out<font color="#E5E5E5"> who</font>

809
00:29:12,910 --> 00:29:16,540
these people<font color="#E5E5E5"> were obviously spoken</font><font color="#CCCCCC"> to a</font>

810
00:29:14,410 --> 00:29:19,120
<font color="#E5E5E5">few of them and tried to delineate</font>

811
00:29:16,540 --> 00:29:20,800
<font color="#CCCCCC">between those guys and</font><font color="#E5E5E5"> the core folks</font>

812
00:29:19,120 --> 00:29:22,810
that<font color="#CCCCCC"> were</font><font color="#E5E5E5"> running the whole shebang</font><font color="#CCCCCC"> but</font>

813
00:29:20,800 --> 00:29:24,639
the fact that these<font color="#E5E5E5"> guys publicly had a</font>

814
00:29:22,810 --> 00:29:27,460
company with<font color="#E5E5E5"> its own website</font><font color="#CCCCCC"> that some</font>

815
00:29:24,640 --> 00:29:33,220
job adverts and<font color="#E5E5E5"> Linkedin etc was was</font>

816
00:29:27,460 --> 00:29:34,720
quite<font color="#E5E5E5"> prison and obviously it's</font><font color="#CCCCCC"> pretty</font>

817
00:29:33,220 --> 00:29:38,500
explicit what they were after<font color="#CCCCCC"> so you've</font>

818
00:29:34,720 --> 00:29:40,150
got looking for me just boy<font color="#E5E5E5"> devs Ruby on</font>

819
00:29:38,500 --> 00:29:43,930
Rails<font color="#CCCCCC"> devs to help them customize a lot</font>

820
00:29:40,150 --> 00:29:46,240
<font color="#E5E5E5">of the</font><font color="#CCCCCC"> front-end no surprise that there</font>

821
00:29:43,930 --> 00:29:49,860
are<font color="#CCCCCC"> also people who have</font><font color="#E5E5E5"> it on LinkedIn</font>

822
00:29:46,240 --> 00:29:51,880
<font color="#CCCCCC">as having worked for comvee security and</font>

823
00:29:49,860 --> 00:29:54,250
they're surprised as<font color="#E5E5E5"> well there's some</font>

824
00:29:51,880 --> 00:29:55,840
of them graduated<font color="#E5E5E5"> in computer</font>

825
00:29:54,250 --> 00:29:59,500
<font color="#E5E5E5">information systems security degrees</font>

826
00:29:55,840 --> 00:30:00,850
<font color="#E5E5E5">from</font><font color="#CCCCCC"> university and</font><font color="#E5E5E5"> actually a whole</font><font color="#CCCCCC"> lot</font>

827
00:29:59,500 --> 00:30:02,260
of<font color="#E5E5E5"> other</font><font color="#CCCCCC"> ones as well that you can find</font>

828
00:30:00,850 --> 00:30:04,179
have since cleaned up their LinkedIn

829
00:30:02,260 --> 00:30:05,830
<font color="#E5E5E5">accounts</font><font color="#CCCCCC"> but again cost of alluded to</font>

830
00:30:04,180 --> 00:30:07,840
<font color="#CCCCCC">want</font><font color="#E5E5E5"> something's on the internet you</font>

831
00:30:05,830 --> 00:30:09,159
can't get get rid of<font color="#E5E5E5"> it</font><font color="#CCCCCC"> and so some of</font>

832
00:30:07,840 --> 00:30:11,649
these ones are quite interesting as<font color="#E5E5E5"> well</font>

833
00:30:09,160 --> 00:30:15,730
<font color="#E5E5E5">and so full stack developer</font><font color="#CCCCCC"> a C++</font>

834
00:30:11,650 --> 00:30:17,890
developer and<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Kombi security so</font><font color="#E5E5E5"> that</font>

835
00:30:15,730 --> 00:30:19,000
might be<font color="#CCCCCC"> where some of the C++ plazma</font>

836
00:30:17,890 --> 00:30:21,070
<font color="#CCCCCC">and where I got developed</font>

837
00:30:19,000 --> 00:30:22,840
who knows<font color="#E5E5E5"> and but there's everybody in</font>

838
00:30:21,070 --> 00:30:25,000
here from somebody like<font color="#E5E5E5"> saying they were</font>

839
00:30:22,840 --> 00:30:28,360
in<font color="#CCCCCC"> a pen test rule to developers rule to</font>

840
00:30:25,000 --> 00:30:32,260
JavaScript dev rules etc<font color="#CCCCCC"> and</font><font color="#E5E5E5"> just quite</font>

841
00:30:28,360 --> 00:30:33,639
a nice way of doing<font color="#CCCCCC"> this and so that</font>

842
00:30:32,260 --> 00:30:35,560
<font color="#E5E5E5">those the the old version of their</font>

843
00:30:33,640 --> 00:30:37,060
<font color="#CCCCCC">website this got torn down in at</font><font color="#E5E5E5"> mid</font>

844
00:30:35,560 --> 00:30:39,100
2017 but it was running

845
00:30:37,060 --> 00:30:41,830
and pretty consistently throughout 2016

846
00:30:39,100 --> 00:30:43,899
they had<font color="#CCCCCC"> Russian Hebrew</font><font color="#E5E5E5"> and English</font>

847
00:30:41,830 --> 00:30:45,159
<font color="#E5E5E5">versions of it as well so pretty good</font>

848
00:30:43,900 --> 00:30:47,800
for all<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> places they were</font>

849
00:30:45,160 --> 00:30:49,660
trying<font color="#CCCCCC"> to hire people in and</font><font color="#E5E5E5"> yet just</font>

850
00:30:47,800 --> 00:30:51,310
fascinating that<font color="#CCCCCC"> this was running and</font>

851
00:30:49,660 --> 00:30:52,900
<font color="#CCCCCC">that's that was their recruiting vehicle</font>

852
00:30:51,310 --> 00:30:55,419
to actually<font color="#CCCCCC"> get people in to conduct</font>

853
00:30:52,900 --> 00:30:57,910
this stuff for them so the bit I

854
00:30:55,420 --> 00:31:01,870
mentioned where we think<font color="#E5E5E5"> there's another</font>

855
00:30:57,910 --> 00:31:04,300
related<font color="#E5E5E5"> group to these guys so</font><font color="#CCCCCC"> Cisco a</font>

856
00:31:01,870 --> 00:31:07,000
proof point but both have published on

857
00:31:04,300 --> 00:31:09,100
the<font color="#CCCCCC"> whittler</font><font color="#E5E5E5"> a battler and JavaScript</font>

858
00:31:07,000 --> 00:31:10,960
framework which we<font color="#CCCCCC"> think</font><font color="#E5E5E5"> was very</font>

859
00:31:09,100 --> 00:31:13,330
closely tied to some of the<font color="#CCCCCC"> fin 7</font>

860
00:31:10,960 --> 00:31:17,050
<font color="#E5E5E5">operations and the other thing that they</font>

861
00:31:13,330 --> 00:31:19,480
did post the<font color="#E5E5E5"> Talos and blog post about a</font>

862
00:31:17,050 --> 00:31:21,070
lot<font color="#E5E5E5"> of this stuff was</font><font color="#CCCCCC"> completely to</font><font color="#E5E5E5"> drop</font>

863
00:31:19,480 --> 00:31:22,810
the old version of<font color="#E5E5E5"> the framework</font><font color="#CCCCCC"> and</font>

864
00:31:21,070 --> 00:31:24,460
there's a new one<font color="#CCCCCC"> now in</font><font color="#E5E5E5"> existence as</font>

865
00:31:22,810 --> 00:31:26,919
well<font color="#CCCCCC"> which I think fire I called</font><font color="#E5E5E5"> Griffin</font>

866
00:31:24,460 --> 00:31:29,260
if I remember<font color="#E5E5E5"> right very very simple</font>

867
00:31:26,920 --> 00:31:31,380
malware framework or sorry JavaScript

868
00:31:29,260 --> 00:31:34,780
framework<font color="#E5E5E5"> and which literally has a</font>

869
00:31:31,380 --> 00:31:37,510
basic<font color="#E5E5E5"> loop that runs every 12 seconds or</font>

870
00:31:34,780 --> 00:31:40,180
so and<font color="#CCCCCC"> just tries to send some stuff</font>

871
00:31:37,510 --> 00:31:41,980
<font color="#E5E5E5">back to the the</font><font color="#CCCCCC"> c2 server but again it</font>

872
00:31:40,180 --> 00:31:43,870
gives<font color="#E5E5E5"> them</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> ability</font><font color="#CCCCCC"> to just deploy</font>

873
00:31:41,980 --> 00:31:46,960
any other tools<font color="#E5E5E5"> down to that system</font>

874
00:31:43,870 --> 00:31:48,070
whenever<font color="#E5E5E5"> they they</font><font color="#CCCCCC"> think it's a it's</font><font color="#E5E5E5"> an</font>

875
00:31:46,960 --> 00:31:52,360
interest and they actually<font color="#E5E5E5"> want to go</font>

876
00:31:48,070 --> 00:31:55,629
and<font color="#CCCCCC"> do some more stuff on</font><font color="#E5E5E5"> it in terms of</font>

877
00:31:52,360 --> 00:31:58,240
the activity of<font color="#CCCCCC"> these</font><font color="#E5E5E5"> guys</font><font color="#CCCCCC"> they're still</font>

878
00:31:55,630 --> 00:32:00,310
really<font color="#E5E5E5"> active so that</font><font color="#CCCCCC"> the bus</font><font color="#E5E5E5"> have not</font>

879
00:31:58,240 --> 00:32:02,860
impacted<font color="#E5E5E5"> these guys at</font><font color="#CCCCCC"> all so the</font>

880
00:32:00,310 --> 00:32:05,679
arrests<font color="#E5E5E5"> we're in January</font><font color="#CCCCCC"> of the the 3</font>

881
00:32:02,860 --> 00:32:09,070
mins<font color="#E5E5E5"> and seven guys these guys have</font>

882
00:32:05,680 --> 00:32:14,110
continued<font color="#CCCCCC"> I'm part of meet 3i and so</font>

883
00:32:09,070 --> 00:32:15,879
we've got<font color="#E5E5E5"> demands from April right</font>

884
00:32:14,110 --> 00:32:19,659
through to literally a few days<font color="#E5E5E5"> ago on</font>

885
00:32:15,880 --> 00:32:22,330
<font color="#E5E5E5">the 9th of September all pretty much</font>

886
00:32:19,660 --> 00:32:24,730
<font color="#CCCCCC">Clyde or</font><font color="#E5E5E5"> API or CDN focused in terms of</font>

887
00:32:22,330 --> 00:32:27,250
themes and the way that we track some of

888
00:32:24,730 --> 00:32:30,760
<font color="#E5E5E5">these if anybody's interested there's</font>

889
00:32:27,250 --> 00:32:32,560
actually a really<font color="#E5E5E5"> reliable 302 response</font>

890
00:32:30,760 --> 00:32:34,120
on<font color="#CCCCCC"> it which you can</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> shoo down to</font>

891
00:32:32,560 --> 00:32:35,679
track<font color="#E5E5E5"> so if you pick some of these and</font>

892
00:32:34,120 --> 00:32:36,969
have<font color="#E5E5E5"> a look at I should and reports on</font>

893
00:32:35,680 --> 00:32:38,710
it you'll<font color="#E5E5E5"> be able to find an indicator</font>

894
00:32:36,970 --> 00:32:40,600
that<font color="#E5E5E5"> you can then use</font><font color="#CCCCCC"> to find and other</font>

895
00:32:38,710 --> 00:32:42,670
ones as<font color="#E5E5E5"> well so it'll be</font><font color="#CCCCCC"> interesting to</font>

896
00:32:40,600 --> 00:32:44,679
<font color="#E5E5E5">see where these guys go and part of the</font>

897
00:32:42,670 --> 00:32:47,200
reason<font color="#E5E5E5"> we think they're linked is the</font>

898
00:32:44,680 --> 00:32:49,510
targeting partly the<font color="#E5E5E5"> infrastructure and</font>

899
00:32:47,200 --> 00:32:50,650
the style of it and partly the

900
00:32:49,510 --> 00:32:52,030
<font color="#E5E5E5">JavaScript frame</font>

901
00:32:50,650 --> 00:32:54,010
because well<font color="#CCCCCC"> which just seems very very</font>

902
00:32:52,030 --> 00:32:55,899
<font color="#E5E5E5">similar</font><font color="#CCCCCC"> it's a highlight</font><font color="#E5E5E5"> of the korfin</font>

903
00:32:54,010 --> 00:32:58,570
<font color="#E5E5E5">seven guys originally did their</font>

904
00:32:55,900 --> 00:32:59,680
operations<font color="#E5E5E5"> so we'll see how</font><font color="#CCCCCC"> successful</font>

905
00:32:58,570 --> 00:33:01,840
these guys are they're certainly on a

906
00:32:59,680 --> 00:33:04,120
smaller scale than<font color="#CCCCCC"> fen 7 was at its</font>

907
00:33:01,840 --> 00:33:05,860
height<font color="#E5E5E5"> and back in summer last year</font><font color="#CCCCCC"> but</font>

908
00:33:04,120 --> 00:33:07,929
it'll be<font color="#CCCCCC"> pretty interesting to</font><font color="#E5E5E5"> see where</font>

909
00:33:05,860 --> 00:33:11,310
they<font color="#E5E5E5"> go and I think</font><font color="#CCCCCC"> that is pretty much</font>

910
00:33:07,930 --> 00:33:11,310
all<font color="#CCCCCC"> I've got</font>

