1
00:00:02,949 --> 00:00:07,309
yeah so I have a couple designate spots

2
00:00:05,149 --> 00:00:09,260
in the talk to ask questions<font color="#E5E5E5"> there's</font>

3
00:00:07,309 --> 00:00:10,160
three or four<font color="#CCCCCC"> points</font><font color="#E5E5E5"> I broken that have</font>

4
00:00:09,260 --> 00:00:13,640
you give me question at<font color="#E5E5E5"> that point</font>

5
00:00:10,160 --> 00:00:15,500
that'd be great I work at Alice<font color="#CCCCCC"> and I</font>

6
00:00:13,640 --> 00:00:16,820
saw Telus like a huge sponsor<font color="#E5E5E5"> here and I</font>

7
00:00:15,500 --> 00:00:18,560
still got except it's I'm the reason<font color="#E5E5E5"> I'm</font>

8
00:00:16,820 --> 00:00:19,820
<font color="#CCCCCC">not sure so I think I might</font><font color="#E5E5E5"> just got</font>

9
00:00:18,560 --> 00:00:22,009
<font color="#E5E5E5">accepted because I work with</font><font color="#CCCCCC"> Telus but</font>

10
00:00:19,820 --> 00:00:23,119
that's<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> anyway this is in the zone</font>

11
00:00:22,010 --> 00:00:24,619
<font color="#CCCCCC">or</font><font color="#E5E5E5"> CCD</font><font color="#CCCCCC"> backing station</font>

12
00:00:23,119 --> 00:00:25,698
the title is a<font color="#CCCCCC"> little deceiving we're</font>

13
00:00:24,619 --> 00:00:28,670
gonna talk about<font color="#E5E5E5"> a heap exploit</font><font color="#CCCCCC"> that I</font>

14
00:00:25,699 --> 00:00:29,510
wrote to attack iPhone and Safari<font color="#CCCCCC"> but</font>

15
00:00:28,670 --> 00:00:31,130
<font color="#E5E5E5">really what we're gonna do is we're</font>

16
00:00:29,510 --> 00:00:33,559
<font color="#E5E5E5">gonna dive into the internals of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> OS</font>

17
00:00:31,130 --> 00:00:35,498
<font color="#CCCCCC">X heap and the different</font><font color="#E5E5E5"> strategies that</font>

18
00:00:33,559 --> 00:00:38,390
<font color="#E5E5E5">it has and how that whole</font><font color="#CCCCCC"> thing works</font>

19
00:00:35,499 --> 00:00:41,300
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is the obligatory</font><font color="#CCCCCC"> Talos slide</font>

20
00:00:38,390 --> 00:00:42,469
that's the<font color="#E5E5E5"> team of</font><font color="#CCCCCC"> Talas</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> again</font>

21
00:00:41,300 --> 00:00:44,479
I'm the one if<font color="#CCCCCC"> we're talking</font><font color="#E5E5E5"> you guys</font>

22
00:00:42,469 --> 00:00:45,920
<font color="#E5E5E5">but every person here and every person</font>

23
00:00:44,479 --> 00:00:47,899
on Talos team has helped me one way or

24
00:00:45,920 --> 00:00:50,299
<font color="#CCCCCC">the other to have</font><font color="#E5E5E5"> this talk I couldn't</font>

25
00:00:47,899 --> 00:00:52,760
<font color="#E5E5E5">be</font><font color="#CCCCCC"> doing ends without them I don't know</font>

26
00:00:50,299 --> 00:00:54,229
<font color="#CCCCCC">it</font><font color="#E5E5E5"> just made its way over to Ireland</font><font color="#CCCCCC"> but</font>

27
00:00:52,760 --> 00:00:57,620
<font color="#E5E5E5">a couple</font><font color="#CCCCCC"> weeks ago there</font><font color="#E5E5E5"> was a pretty</font>

28
00:00:54,229 --> 00:00:59,059
<font color="#E5E5E5">big</font><font color="#CCCCCC"> apple patch that came out and people</font>

29
00:00:57,620 --> 00:01:00,498
<font color="#E5E5E5">had this big</font><font color="#CCCCCC"> Highline like Oh</font>

30
00:00:59,059 --> 00:01:01,940
<font color="#CCCCCC">stage-fright for Apple States</font><font color="#E5E5E5"> right for</font>

31
00:01:00,499 --> 00:01:04,519
Apple well what do they mean what is

32
00:01:01,940 --> 00:01:05,990
that<font color="#CCCCCC"> how was</font><font color="#E5E5E5"> that going</font><font color="#CCCCCC"> so I had over</font>

33
00:01:04,519 --> 00:01:07,700
100 hundred blog post about<font color="#CCCCCC"> this bug and</font>

34
00:01:05,990 --> 00:01:11,750
people didn't quite understand<font color="#CCCCCC"> what it</font>

35
00:01:07,700 --> 00:01:14,270
<font color="#CCCCCC">meant</font><font color="#E5E5E5"> but here's the - here's</font><font color="#CCCCCC"> two CDs</font>

36
00:01:11,750 --> 00:01:17,090
from Apple<font color="#E5E5E5"> that effect</font><font color="#CCCCCC"> that this</font><font color="#E5E5E5"> Expo is</font>

37
00:01:14,270 --> 00:01:18,170
actually gonna use and I don't<font color="#E5E5E5"> think</font>

38
00:01:17,090 --> 00:01:19,250
I've ever given<font color="#CCCCCC"> a proof of concept of</font>

39
00:01:18,170 --> 00:01:20,330
<font color="#E5E5E5">this out but then</font><font color="#CCCCCC"> this is all patch and</font>

40
00:01:19,250 --> 00:01:21,770
stuff if you guys<font color="#CCCCCC"> wanna</font><font color="#E5E5E5"> prove a</font><font color="#CCCCCC"> concept</font>

41
00:01:20,330 --> 00:01:25,190
later<font color="#E5E5E5"> I'd be more than willing to give</font>

42
00:01:21,770 --> 00:01:29,570
it<font color="#E5E5E5"> to you so you can check it out so why</font>

43
00:01:25,190 --> 00:01:31,970
did I do this<font color="#CCCCCC"> researchers so I'm trying</font>

44
00:01:29,570 --> 00:01:35,059
<font color="#E5E5E5">to find bugs</font><font color="#CCCCCC"> I found a really</font><font color="#E5E5E5"> juicy bug</font>

45
00:01:31,970 --> 00:01:36,410
a real nice bug<font color="#CCCCCC"> I I'm fuzzing</font><font color="#E5E5E5"> I already</font>

46
00:01:35,060 --> 00:01:38,510
have our IP<font color="#CCCCCC"> control the second I look at</font>

47
00:01:36,410 --> 00:01:40,100
my crash<font color="#E5E5E5"> so I'm thinking this is a win I</font>

48
00:01:38,510 --> 00:01:42,050
got<font color="#CCCCCC"> already</font><font color="#E5E5E5"> control I can access it from</font>

49
00:01:40,100 --> 00:01:44,419
<font color="#E5E5E5">Safari</font><font color="#CCCCCC"> I get the game over right what</font>

50
00:01:42,050 --> 00:01:47,300
else<font color="#E5E5E5"> is there to do so I go look up</font>

51
00:01:44,420 --> 00:01:49,280
documentation on<font color="#CCCCCC"> OSX I find a bunch of</font>

52
00:01:47,300 --> 00:01:51,920
people written<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> stuff in like</font>

53
00:01:49,280 --> 00:01:53,540
2004 and like 2005 back when I was sex

54
00:01:51,920 --> 00:01:55,850
with<font color="#E5E5E5"> PowerPC that's great you know</font>

55
00:01:53,540 --> 00:01:56,240
that's awesome<font color="#CCCCCC"> but that's I can help</font><font color="#E5E5E5"> me</font>

56
00:01:55,850 --> 00:01:58,280
much

57
00:01:56,240 --> 00:02:00,830
so we have heat<font color="#CCCCCC"> spraying that's not</font>

58
00:01:58,280 --> 00:02:02,810
<font color="#E5E5E5">reliable</font><font color="#CCCCCC"> Hogan</font><font color="#E5E5E5"> so I first made this</font>

59
00:02:00,830 --> 00:02:04,429
exploit<font color="#E5E5E5"> I just</font><font color="#CCCCCC"> JIT sprayed I did jet</font>

60
00:02:02,810 --> 00:02:05,600
spray<font color="#CCCCCC"> jumped or jet spray</font><font color="#E5E5E5"> I had</font><font color="#CCCCCC"> 10</font>

61
00:02:04,430 --> 00:02:08,209
<font color="#CCCCCC">percent accuracy I mean 10 percent</font>

62
00:02:05,600 --> 00:02:09,799
reliability<font color="#E5E5E5"> boom that's</font><font color="#CCCCCC"> a pretty good</font>

63
00:02:08,209 --> 00:02:12,319
exploit I don't know if anybody saw<font color="#CCCCCC"> this</font>

64
00:02:09,800 --> 00:02:13,999
<font color="#E5E5E5">but at blackhat Apple</font><font color="#CCCCCC"> actually came out</font>

65
00:02:12,319 --> 00:02:15,138
<font color="#CCCCCC">the talk and they told us that they'd</font>

66
00:02:13,999 --> 00:02:15,810
actually<font color="#E5E5E5"> they're redoing their jet</font>

67
00:02:15,139 --> 00:02:18,060
engine

68
00:02:15,810 --> 00:02:20,700
so now<font color="#CCCCCC"> they're jet engine if</font><font color="#E5E5E5"> anybody's</font>

69
00:02:18,060 --> 00:02:21,900
<font color="#E5E5E5">ever seen a</font><font color="#CCCCCC"> jet engine is</font><font color="#E5E5E5"> a jet engine</font>

70
00:02:20,700 --> 00:02:23,130
for<font color="#CCCCCC"> JavaScript's</font><font color="#E5E5E5"> just in time to</font>

71
00:02:21,900 --> 00:02:24,720
<font color="#E5E5E5">violations</font><font color="#CCCCCC"> so when you put JavaScript</font>

72
00:02:23,130 --> 00:02:26,430
<font color="#CCCCCC">now</font><font color="#E5E5E5"> there has to compile that code and</font>

73
00:02:24,720 --> 00:02:28,410
it makes a page<font color="#E5E5E5"> readable writable</font>

74
00:02:26,430 --> 00:02:30,390
executable<font color="#E5E5E5"> so if you jump to</font><font color="#CCCCCC"> that I can</font>

75
00:02:28,410 --> 00:02:32,760
put<font color="#E5E5E5"> shellcode there JIT code and that's</font>

76
00:02:30,390 --> 00:02:34,708
executed<font color="#E5E5E5"> what Apple</font><font color="#CCCCCC"> is doing</font><font color="#E5E5E5"> now is</font>

77
00:02:32,760 --> 00:02:36,269
<font color="#E5E5E5">they're gonna separate the JIT they're</font>

78
00:02:34,709 --> 00:02:38,220
gonna separate data from the actual

79
00:02:36,270 --> 00:02:39,870
<font color="#E5E5E5">instructions</font><font color="#CCCCCC"> themselves</font><font color="#E5E5E5"> so I can no</font>

80
00:02:38,220 --> 00:02:41,040
longer<font color="#CCCCCC"> just throw data in there that's</font>

81
00:02:39,870 --> 00:02:42,750
<font color="#E5E5E5">not gonna be an executable page anymore</font>

82
00:02:41,040 --> 00:02:44,489
<font color="#CCCCCC">now that's on the writable page</font><font color="#E5E5E5"> so heap</font>

83
00:02:42,750 --> 00:02:48,630
<font color="#E5E5E5">spraying is now gone on the latest</font>

84
00:02:44,490 --> 00:02:50,610
versions<font color="#CCCCCC"> yeah so we need</font><font color="#E5E5E5"> an in-depth</font>

85
00:02:48,630 --> 00:02:51,840
knowledge<font color="#E5E5E5"> of the heap algorithm because</font>

86
00:02:50,610 --> 00:02:53,550
a couple<font color="#CCCCCC"> things we're</font><font color="#E5E5E5"> gonna see there's</font>

87
00:02:51,840 --> 00:02:54,570
a<font color="#E5E5E5"> couple safety checks in here that are</font>

88
00:02:53,550 --> 00:02:56,070
gonna try to<font color="#E5E5E5"> prevent us from doing</font><font color="#CCCCCC"> a</font>

89
00:02:54,570 --> 00:02:57,560
<font color="#E5E5E5">sieve overflow but with</font><font color="#CCCCCC"> the nice limit</font>

90
00:02:56,070 --> 00:03:01,019
with a good<font color="#CCCCCC"> in-depth knowledge we can</font>

91
00:02:57,560 --> 00:03:02,250
bypass some<font color="#E5E5E5"> of</font><font color="#CCCCCC"> those</font><font color="#E5E5E5"> this is just slide</font>

92
00:03:01,020 --> 00:03:03,600
just showing<font color="#CCCCCC"> I'm not the first person</font><font color="#E5E5E5"> to</font>

93
00:03:02,250 --> 00:03:04,800
<font color="#E5E5E5">reverse engineer heap</font><font color="#CCCCCC"> there's been a</font>

94
00:03:03,600 --> 00:03:06,810
<font color="#E5E5E5">million people reverse engineer</font><font color="#CCCCCC"> before</font>

95
00:03:04,800 --> 00:03:09,000
my favorite is<font color="#CCCCCC"> probably Chris valasek</font>

96
00:03:06,810 --> 00:03:11,160
or denied<font color="#CCCCCC"> I so</font><font color="#E5E5E5"> V those guys are the man</font>

97
00:03:09,000 --> 00:03:13,020
<font color="#E5E5E5">and this all just work is modeled up to</font>

98
00:03:11,160 --> 00:03:15,660
them<font color="#E5E5E5"> so I have to give</font><font color="#CCCCCC"> credit where</font>

99
00:03:13,020 --> 00:03:18,540
credit's<font color="#E5E5E5"> to and like I said this is all</font>

100
00:03:15,660 --> 00:03:21,410
the if<font color="#E5E5E5"> you google</font><font color="#CCCCCC"> OS I keep and this is</font>

101
00:03:18,540 --> 00:03:24,329
what you're gonna find<font color="#CCCCCC"> cocoa with</font><font color="#E5E5E5"> malloc</font>

102
00:03:21,410 --> 00:03:25,650
blog post<font color="#E5E5E5"> that's like 100 word blog post</font>

103
00:03:24,330 --> 00:03:27,690
<font color="#E5E5E5">that's probably the best blog</font><font color="#CCCCCC"> post at</font>

104
00:03:25,650 --> 00:03:29,280
all of them it's super<font color="#E5E5E5"> small super easy</font>

105
00:03:27,690 --> 00:03:30,750
<font color="#E5E5E5">but it had a lot of great information</font>

106
00:03:29,280 --> 00:03:31,670
and<font color="#E5E5E5"> it's highly recommend checking</font><font color="#CCCCCC"> it</font>

107
00:03:30,750 --> 00:03:33,750
out

108
00:03:31,670 --> 00:03:34,768
so all this<font color="#CCCCCC"> research was</font><font color="#E5E5E5"> on ten point</font>

109
00:03:33,750 --> 00:03:36,530
one<font color="#E5E5E5"> point five</font>

110
00:03:34,769 --> 00:03:39,360
we're on ten point<font color="#CCCCCC"> one point six now</font>

111
00:03:36,530 --> 00:03:40,920
<font color="#E5E5E5">everything is still good</font><font color="#CCCCCC"> I also have a</font>

112
00:03:39,360 --> 00:03:41,940
<font color="#CCCCCC">sierra beta which is</font><font color="#E5E5E5"> coming out soon</font><font color="#CCCCCC"> I</font>

113
00:03:40,920 --> 00:03:42,750
<font color="#E5E5E5">don't know how much you guys know</font><font color="#CCCCCC"> about</font>

114
00:03:41,940 --> 00:03:44,489
Apple<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you've any question</font><font color="#E5E5E5"> about</font>

115
00:03:42,750 --> 00:03:45,329
<font color="#E5E5E5">anything but Sierra's coming out in like</font>

116
00:03:44,489 --> 00:03:47,190
a month

117
00:03:45,329 --> 00:03:48,900
and the<font color="#CCCCCC"> oct</font><font color="#E5E5E5"> p.m. station is the same in</font>

118
00:03:47,190 --> 00:03:52,769
Sierra as it is here<font color="#CCCCCC"> so all the work I</font>

119
00:03:48,900 --> 00:03:54,299
did<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> still applicable</font><font color="#CCCCCC"> so here's what</font>

120
00:03:52,769 --> 00:03:55,350
we're<font color="#E5E5E5"> gonna talk about the structures</font>

121
00:03:54,299 --> 00:03:57,360
I'm fortunate I have to give<font color="#CCCCCC"> you a</font>

122
00:03:55,350 --> 00:03:59,280
little<font color="#E5E5E5"> background on what these teachers</font>

123
00:03:57,360 --> 00:04:00,810
<font color="#CCCCCC">look like and it's boring</font><font color="#E5E5E5"> and I'm sorry</font>

124
00:03:59,280 --> 00:04:02,459
<font color="#E5E5E5">but if you could</font><font color="#CCCCCC"> just bear</font><font color="#E5E5E5"> with me if</font>

125
00:04:00,810 --> 00:04:03,840
you can even someone out it's<font color="#E5E5E5"> okay</font>

126
00:04:02,459 --> 00:04:05,190
but you<font color="#CCCCCC"> could bear</font><font color="#E5E5E5"> with me I appreciate</font>

127
00:04:03,840 --> 00:04:07,260
<font color="#E5E5E5">it</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> we're gonna talk about some heap</font>

128
00:04:05,190 --> 00:04:09,000
strategies and how I had heap overflow

129
00:04:07,260 --> 00:04:10,980
right<font color="#CCCCCC"> Hebrew flows are great but they're</font>

130
00:04:09,000 --> 00:04:12,150
<font color="#E5E5E5">tough to exploit I think anybody's</font>

131
00:04:10,980 --> 00:04:13,679
<font color="#CCCCCC">exporting Hebrew</font><font color="#E5E5E5"> flow knows that's not</font>

132
00:04:12,150 --> 00:04:15,299
an<font color="#E5E5E5"> easy bug well what's an easier bug</font>

133
00:04:13,680 --> 00:04:16,739
I'll use after free right if I have<font color="#CCCCCC"> you</font>

134
00:04:15,299 --> 00:04:18,090
<font color="#CCCCCC">self to free that's a pretty that's a</font>

135
00:04:16,738 --> 00:04:20,010
<font color="#E5E5E5">pretty standard exploit I mean I pretty</font>

136
00:04:18,089 --> 00:04:21,390
<font color="#E5E5E5">much I understand how to do that so how</font>

137
00:04:20,010 --> 00:04:22,800
can I take<font color="#E5E5E5"> my Hebrew flow into it</font><font color="#CCCCCC"> you</font>

138
00:04:21,390 --> 00:04:25,200
<font color="#E5E5E5">have</font><font color="#CCCCCC"> to free and</font><font color="#E5E5E5"> that's that that</font>

139
00:04:22,800 --> 00:04:27,300
section song<font color="#E5E5E5"> and then I have a few</font>

140
00:04:25,200 --> 00:04:28,740
slides if I make it<font color="#CCCCCC"> to I make it to him</font>

141
00:04:27,300 --> 00:04:29,870
about<font color="#CCCCCC"> X actually</font><font color="#E5E5E5"> explains the part</font>

142
00:04:28,740 --> 00:04:31,860
itself

143
00:04:29,870 --> 00:04:33,600
I'm hoping you<font color="#E5E5E5"> guys have a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of</font>

144
00:04:31,860 --> 00:04:36,780
<font color="#CCCCCC">knowledge of</font><font color="#E5E5E5"> the heap I'm gonna go to a</font>

145
00:04:33,600 --> 00:04:39,060
super rudimentary version here these<font color="#E5E5E5"> are</font>

146
00:04:36,780 --> 00:04:41,280
a bunch<font color="#E5E5E5"> of alligators but what I'd like</font>

147
00:04:39,060 --> 00:04:43,170
<font color="#CCCCCC">to do here is you divide</font><font color="#E5E5E5"> them into two</font>

148
00:04:41,280 --> 00:04:45,299
types you have link based links let's

149
00:04:43,170 --> 00:04:47,760
pick<font color="#CCCCCC"> that alligators</font><font color="#E5E5E5"> and you have arena</font>

150
00:04:45,300 --> 00:04:50,790
base<font color="#E5E5E5"> alligators a linked list based</font>

151
00:04:47,760 --> 00:04:52,380
alligator that<font color="#E5E5E5"> one is essentially it's</font>

152
00:04:50,790 --> 00:04:53,850
just<font color="#E5E5E5"> all the free blocks gets thrown</font>

153
00:04:52,380 --> 00:04:56,010
together<font color="#E5E5E5"> and they put this metadata</font>

154
00:04:53,850 --> 00:04:57,300
their self preview size<font color="#E5E5E5"> next size and so</font>

155
00:04:56,010 --> 00:04:58,830
<font color="#E5E5E5">they get</font><font color="#CCCCCC"> to next block are you gonna do</font>

156
00:04:57,300 --> 00:05:02,430
is<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> walk down and find the next one</font>

157
00:04:58,830 --> 00:05:04,650
<font color="#CCCCCC">that</font><font color="#E5E5E5"> fits and this is what leads to the</font>

158
00:05:02,430 --> 00:05:06,990
Doug Liman like standard<font color="#CCCCCC"> 4x4</font><font color="#E5E5E5"> by right</font>

159
00:05:04,650 --> 00:05:08,280
anywhere<font color="#CCCCCC"> old</font><font color="#E5E5E5"> school on the heap</font><font color="#CCCCCC"> on</font>

160
00:05:06,990 --> 00:05:10,590
<font color="#CCCCCC">linking attack that's what this comes</font>

161
00:05:08,280 --> 00:05:12,000
from<font color="#E5E5E5"> what this is great</font><font color="#CCCCCC"> in everything</font>

162
00:05:10,590 --> 00:05:14,849
<font color="#E5E5E5">but the problem with this is if you want</font>

163
00:05:12,000 --> 00:05:15,690
<font color="#CCCCCC">to deallocate memory</font><font color="#E5E5E5"> it's very intensive</font>

164
00:05:14,850 --> 00:05:18,270
because<font color="#E5E5E5"> you have to walk this entire</font>

165
00:05:15,690 --> 00:05:19,500
linked list<font color="#E5E5E5"> so how do we fix that we go</font>

166
00:05:18,270 --> 00:05:22,099
with<font color="#E5E5E5"> something</font><font color="#CCCCCC"> called an arena allocator</font>

167
00:05:19,500 --> 00:05:24,690
<font color="#CCCCCC">and</font><font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> beam allocators do is they</font>

168
00:05:22,100 --> 00:05:26,460
allocate things based<font color="#CCCCCC"> on size</font><font color="#E5E5E5"> so the</font>

169
00:05:24,690 --> 00:05:29,400
most famous and<font color="#CCCCCC"> most Asian this is a low</font>

170
00:05:26,460 --> 00:05:30,840
fragmentation<font color="#CCCCCC"> need</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> Windows which if</font>

171
00:05:29,400 --> 00:05:32,310
you<font color="#CCCCCC"> allocate</font><font color="#E5E5E5"> 12 things</font><font color="#CCCCCC"> at the</font><font color="#E5E5E5"> same size</font>

172
00:05:30,840 --> 00:05:34,200
<font color="#CCCCCC">it starts to bucket them so now</font>

173
00:05:32,310 --> 00:05:35,640
everything everything of size<font color="#CCCCCC"> 10</font><font color="#E5E5E5"> it goes</font>

174
00:05:34,200 --> 00:05:38,310
in bucket then everything in size 11

175
00:05:35,640 --> 00:05:40,110
<font color="#E5E5E5">goes in bucket 11 and that makes it much</font>

176
00:05:38,310 --> 00:05:42,210
easier<font color="#E5E5E5"> for deallocation you can now</font>

177
00:05:40,110 --> 00:05:44,070
allocate objects almost instantly<font color="#E5E5E5"> and</font>

178
00:05:42,210 --> 00:05:45,570
<font color="#E5E5E5">that kind</font><font color="#CCCCCC"> of looks like this so you</font><font color="#E5E5E5"> can</font>

179
00:05:44,070 --> 00:05:47,820
<font color="#E5E5E5">see if we want to allocate something</font>

180
00:05:45,570 --> 00:05:50,520
<font color="#E5E5E5">from slot 4 here we would just</font><font color="#CCCCCC"> go and</font>

181
00:05:47,820 --> 00:05:53,099
say hey<font color="#CCCCCC"> Soph or oh there is</font><font color="#E5E5E5"> cool let me</font>

182
00:05:50,520 --> 00:05:54,510
<font color="#E5E5E5">take that and</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> just so it's a more</font>

183
00:05:53,100 --> 00:05:57,600
modern<font color="#CCCCCC"> he permutation</font><font color="#E5E5E5"> and that's how</font>

184
00:05:54,510 --> 00:05:59,340
most<font color="#CCCCCC"> human agents are these days okay</font>

185
00:05:57,600 --> 00:05:59,790
<font color="#CCCCCC">we're gonna talk about two seconds</font><font color="#E5E5E5"> on</font>

186
00:05:59,340 --> 00:06:02,669
<font color="#CCCCCC">OSX</font>

187
00:05:59,790 --> 00:06:04,290
so anybody<font color="#E5E5E5"> to see before it's probably</font>

188
00:06:02,669 --> 00:06:05,370
use<font color="#CCCCCC"> lips see anybody's program I was sex</font>

189
00:06:04,290 --> 00:06:07,590
before<font color="#E5E5E5"> that's probably the core</font>

190
00:06:05,370 --> 00:06:09,690
foundation core foundation is the basis

191
00:06:07,590 --> 00:06:12,599
of all<font color="#E5E5E5"> objective-c</font><font color="#CCCCCC"> it's handles all of</font>

192
00:06:09,690 --> 00:06:14,400
the handles all<font color="#E5E5E5"> of the graphical</font>

193
00:06:12,600 --> 00:06:15,720
setups it handles all<font color="#E5E5E5"> the cross</font><font color="#CCCCCC"> process</font>

194
00:06:14,400 --> 00:06:19,260
communication<font color="#CCCCCC"> handles all that</font><font color="#E5E5E5"> kind of</font>

195
00:06:15,720 --> 00:06:20,610
rendering things<font color="#E5E5E5"> and so you're asking</font>

196
00:06:19,260 --> 00:06:21,180
you probably wondering why is this

197
00:06:20,610 --> 00:06:24,690
useful

198
00:06:21,180 --> 00:06:26,190
well WebKit<font color="#CCCCCC"> is Safari WebKit can build</font>

199
00:06:24,690 --> 00:06:27,870
on<font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> it can build on Linux</font><font color="#E5E5E5"> it can</font>

200
00:06:26,190 --> 00:06:30,180
build<font color="#CCCCCC"> on OSX</font><font color="#E5E5E5"> so it has to have</font><font color="#CCCCCC"> its own</font>

201
00:06:27,870 --> 00:06:32,550
internal heating applications to work so

202
00:06:30,180 --> 00:06:34,380
I have a heap overflow in<font color="#CCCCCC"> OSX I don't</font>

203
00:06:32,550 --> 00:06:35,250
have heat overflow<font color="#E5E5E5"> and WebKit so we're</font>

204
00:06:34,380 --> 00:06:36,900
gonna have<font color="#E5E5E5"> to figure out how to get</font>

205
00:06:35,250 --> 00:06:37,979
around that<font color="#CCCCCC"> and this core foundation</font>

206
00:06:36,900 --> 00:06:40,419
turns out to be<font color="#E5E5E5"> the way</font><font color="#CCCCCC"> to get around</font>

207
00:06:37,979 --> 00:06:43,090
<font color="#E5E5E5">that I'll go into that more as we</font>

208
00:06:40,420 --> 00:06:44,980
go<font color="#E5E5E5"> along and</font><font color="#CCCCCC"> just a real quick</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> want to</font>

209
00:06:43,090 --> 00:06:46,390
tell you about the<font color="#CCCCCC"> things that OSX gives</font>

210
00:06:44,980 --> 00:06:49,960
you to help make your<font color="#E5E5E5"> life</font><font color="#CCCCCC"> a little</font>

211
00:06:46,390 --> 00:06:53,080
<font color="#E5E5E5">easier because</font><font color="#CCCCCC"> OS X was based on PSD it</font>

212
00:06:49,960 --> 00:06:54,969
has a similar<font color="#E5E5E5"> BSC style allocator</font><font color="#CCCCCC"> they</font>

213
00:06:53,080 --> 00:06:57,340
called garden<font color="#CCCCCC"> malloc</font><font color="#E5E5E5"> it's essentially</font>

214
00:06:54,970 --> 00:06:59,440
<font color="#CCCCCC">seen as a cheap or</font><font color="#E5E5E5"> live</font><font color="#CCCCCC"> dislocator if</font>

215
00:06:57,340 --> 00:07:01,750
<font color="#CCCCCC">you say FL essentially just marks pages</font>

216
00:06:59,440 --> 00:07:03,430
as not accessible<font color="#CCCCCC"> and as soon</font><font color="#E5E5E5"> as you</font>

217
00:07:01,750 --> 00:07:04,330
free<font color="#CCCCCC"> something it makes marks as nice as</font>

218
00:07:03,430 --> 00:07:06,250
well<font color="#E5E5E5"> as well so that's</font><font color="#CCCCCC"> gonna catch all</font>

219
00:07:04,330 --> 00:07:08,320
<font color="#CCCCCC">your</font><font color="#E5E5E5"> set of</font><font color="#CCCCCC"> fries</font><font color="#E5E5E5"> it puts guard pages</font>

220
00:07:06,250 --> 00:07:11,620
around<font color="#E5E5E5"> heap overflows it's very very</font>

221
00:07:08,320 --> 00:07:14,349
helpful OSX also gives you<font color="#E5E5E5"> malloc stock</font>

222
00:07:11,620 --> 00:07:16,120
logging out of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> box you can turn on</font>

223
00:07:14,350 --> 00:07:18,490
stack logging and you get<font color="#CCCCCC"> full back</font>

224
00:07:16,120 --> 00:07:21,700
<font color="#E5E5E5">traces on all your malloc on all your</font>

225
00:07:18,490 --> 00:07:23,050
malloc calls<font color="#E5E5E5"> there's another command</font>

226
00:07:21,700 --> 00:07:24,159
called malloc history<font color="#E5E5E5"> which is gonna</font>

227
00:07:23,050 --> 00:07:26,440
<font color="#E5E5E5">give you a little more output as a</font>

228
00:07:24,160 --> 00:07:27,400
little more verbose and<font color="#E5E5E5"> you have to use</font>

229
00:07:26,440 --> 00:07:29,530
it<font color="#E5E5E5"> from the command</font><font color="#CCCCCC"> line</font><font color="#E5E5E5"> you can't use</font>

230
00:07:27,400 --> 00:07:31,479
<font color="#CCCCCC">it for melody B but</font><font color="#E5E5E5"> I wrote a tool they</font>

231
00:07:29,530 --> 00:07:32,799
can<font color="#E5E5E5"> make a user melody</font><font color="#CCCCCC"> B and it's</font>

232
00:07:31,480 --> 00:07:34,660
<font color="#E5E5E5">infinitely better because malloc info</font>

233
00:07:32,800 --> 00:07:35,770
crashes oh let me be<font color="#CCCCCC"> 5 times</font><font color="#E5E5E5"> out of 10</font>

234
00:07:34,660 --> 00:07:37,090
so if you're working<font color="#CCCCCC"> with</font><font color="#E5E5E5"> something for</font>

235
00:07:35,770 --> 00:07:38,680
<font color="#E5E5E5">an hour and use the stupid thing and I</font>

236
00:07:37,090 --> 00:07:40,150
<font color="#CCCCCC">just crashed and they're</font><font color="#E5E5E5"> done</font><font color="#CCCCCC"> and you</font>

237
00:07:38,680 --> 00:07:42,700
<font color="#E5E5E5">just wasted so much time so I usually</font>

238
00:07:40,150 --> 00:07:45,280
use history and I'd recommend<font color="#CCCCCC"> that</font><font color="#E5E5E5"> as</font>

239
00:07:42,700 --> 00:07:54,219
well if I'm<font color="#CCCCCC"> Sam I talking too fast</font>

240
00:07:45,280 --> 00:07:57,070
everybody<font color="#CCCCCC"> ok ok all right</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I like to</font>

241
00:07:54,220 --> 00:07:58,990
<font color="#E5E5E5">think</font><font color="#CCCCCC"> of this as a large</font><font color="#E5E5E5"> umbrella like a</font>

242
00:07:57,070 --> 00:08:00,130
big golf umbrella<font color="#CCCCCC"> imagine you and your 5</font>

243
00:07:58,990 --> 00:08:01,360
buddies right you're standing it's

244
00:08:00,130 --> 00:08:02,830
pouring outside and<font color="#E5E5E5"> only one of</font><font color="#CCCCCC"> you guys</font>

245
00:08:01,360 --> 00:08:04,120
<font color="#E5E5E5">got an umbrella</font><font color="#CCCCCC"> so what are you</font><font color="#E5E5E5"> gonna do</font>

246
00:08:02,830 --> 00:08:05,979
you're all gonna try<font color="#E5E5E5"> to huddle under</font>

247
00:08:04,120 --> 00:08:07,450
there<font color="#E5E5E5"> and hundl</font><font color="#CCCCCC"> and rubella</font><font color="#E5E5E5"> that's what</font>

248
00:08:05,980 --> 00:08:09,670
this<font color="#E5E5E5"> malloc zovut idea is we have</font><font color="#CCCCCC"> a</font>

249
00:08:07,450 --> 00:08:11,380
giant overarching zone structure<font color="#E5E5E5"> and we</font>

250
00:08:09,670 --> 00:08:16,470
have individual<font color="#CCCCCC"> Malik's inside that zone</font>

251
00:08:11,380 --> 00:08:19,540
structure<font color="#E5E5E5"> so something like WebKit is</font>

252
00:08:16,470 --> 00:08:21,280
WebKit is version 2 so WebKit<font color="#E5E5E5"> malloc</font>

253
00:08:19,540 --> 00:08:22,840
sits inside the<font color="#E5E5E5"> same zone that</font><font color="#CCCCCC"> OSX</font>

254
00:08:21,280 --> 00:08:24,729
malloc does but it's in its own version

255
00:08:22,840 --> 00:08:26,409
so this<font color="#E5E5E5"> this overarching umbrella</font><font color="#CCCCCC"> kind</font>

256
00:08:24,730 --> 00:08:27,880
<font color="#E5E5E5">of manages all these different</font><font color="#CCCCCC"> value</font>

257
00:08:26,410 --> 00:08:29,860
invitations<font color="#E5E5E5"> this is gonna make things</font>

258
00:08:27,880 --> 00:08:31,240
<font color="#E5E5E5">like Safari possible so I</font><font color="#CCCCCC"> can have four</font>

259
00:08:29,860 --> 00:08:32,979
<font color="#E5E5E5">or five six seven different he panels</font>

260
00:08:31,240 --> 00:08:37,450
<font color="#CCCCCC">Asians all at once and this zone</font>

261
00:08:32,979 --> 00:08:39,070
algorithm takes care of<font color="#E5E5E5"> all that so the</font>

262
00:08:37,450 --> 00:08:40,690
magazine allocator which is the<font color="#CCCCCC"> mac</font><font color="#E5E5E5"> the</font>

263
00:08:39,070 --> 00:08:43,870
magazine<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> is default OSX</font>

264
00:08:40,690 --> 00:08:44,980
<font color="#CCCCCC">malik</font><font color="#E5E5E5"> the not to be confused the WebKit</font>

265
00:08:43,870 --> 00:08:47,500
malloc which is slightly<font color="#E5E5E5"> different</font><font color="#CCCCCC"> we'll</font>

266
00:08:44,980 --> 00:08:48,760
get to<font color="#E5E5E5"> that more you can see it's used</font>

267
00:08:47,500 --> 00:08:50,710
by basically everything color<font color="#CCCCCC"> sync</font>

268
00:08:48,760 --> 00:08:52,630
safarik you know it<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> that's on</font>

269
00:08:50,710 --> 00:08:53,860
everything<font color="#E5E5E5"> anything that's on OSX that's</font>

270
00:08:52,630 --> 00:08:57,250
not WebKit<font color="#CCCCCC"> uses it</font>

271
00:08:53,860 --> 00:08:58,620
and<font color="#CCCCCC"> WebKit</font><font color="#E5E5E5"> uses a little bit and that's</font>

272
00:08:57,250 --> 00:09:00,430
<font color="#E5E5E5">pretty much that</font>

273
00:08:58,620 --> 00:09:01,660
<font color="#E5E5E5">all right so the way I showed</font><font color="#CCCCCC"> you to</font>

274
00:09:00,430 --> 00:09:03,280
free<font color="#E5E5E5"> this a little bit it's just a</font>

275
00:09:01,660 --> 00:09:05,640
<font color="#CCCCCC">reading</font><font color="#E5E5E5"> base allocator</font><font color="#CCCCCC"> so it's a</font><font color="#E5E5E5"> bucket</font>

276
00:09:03,280 --> 00:09:09,610
list<font color="#CCCCCC"> it's pretty</font><font color="#E5E5E5"> straightforward</font><font color="#CCCCCC"> and</font>

277
00:09:05,640 --> 00:09:11,830
<font color="#CCCCCC">here's a here is the worst part</font><font color="#E5E5E5"> of this</font>

278
00:09:09,610 --> 00:09:13,630
exploit and the best<font color="#CCCCCC"> of defense</font>

279
00:09:11,830 --> 00:09:16,360
mechanism<font color="#CCCCCC"> apples ever come up with and</font>

280
00:09:13,630 --> 00:09:20,770
it's the fact<font color="#E5E5E5"> that they bind a magazine</font>

281
00:09:16,360 --> 00:09:22,360
to a core<font color="#E5E5E5"> so what a magazine is I mean</font>

282
00:09:20,770 --> 00:09:24,400
was over the region is where the actual

283
00:09:22,360 --> 00:09:25,930
<font color="#E5E5E5">memory comes from so I allocate</font>

284
00:09:24,400 --> 00:09:28,030
<font color="#E5E5E5">something comes</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> region well a</font>

285
00:09:25,930 --> 00:09:33,040
region is down to the core of<font color="#E5E5E5"> your</font>

286
00:09:28,030 --> 00:09:34,720
<font color="#E5E5E5">computer and what happens is</font><font color="#CCCCCC"> that as you</font>

287
00:09:33,040 --> 00:09:36,760
go along<font color="#E5E5E5"> and you block to the kernel it</font>

288
00:09:34,720 --> 00:09:38,080
can switch cores on you so if I<font color="#E5E5E5"> if I did</font>

289
00:09:36,760 --> 00:09:41,050
I'm doing<font color="#CCCCCC"> a heat massage</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you may</font>

290
00:09:38,080 --> 00:09:42,430
keep<font color="#E5E5E5"> spraying on core one</font><font color="#CCCCCC"> I then do some</font>

291
00:09:41,050 --> 00:09:43,839
file reading<font color="#E5E5E5"> and that gives a chance</font><font color="#CCCCCC"> to</font>

292
00:09:42,430 --> 00:09:46,060
<font color="#CCCCCC">the</font><font color="#E5E5E5"> kernel to block well now it comes</font>

293
00:09:43,840 --> 00:09:47,440
<font color="#E5E5E5">back and I'm encore</font><font color="#CCCCCC"> to so all the heap</font>

294
00:09:46,060 --> 00:09:49,119
sprang edge did all that<font color="#E5E5E5"> work I just did</font>

295
00:09:47,440 --> 00:09:50,920
<font color="#CCCCCC">it's gone it's not</font><font color="#E5E5E5"> there anymore I'm on</font>

296
00:09:49,120 --> 00:09:52,390
core to core<font color="#E5E5E5"> one set up perfectly for me</font>

297
00:09:50,920 --> 00:09:54,040
to exploit<font color="#E5E5E5"> core twos not set up</font><font color="#CCCCCC"> at all</font>

298
00:09:52,390 --> 00:09:55,240
this particular<font color="#E5E5E5"> laptop has a course</font>

299
00:09:54,040 --> 00:09:56,500
that's<font color="#E5E5E5"> eight different malloc</font>

300
00:09:55,240 --> 00:09:58,120
invitations that<font color="#E5E5E5"> I have to try to</font>

301
00:09:56,500 --> 00:09:59,650
<font color="#CCCCCC">massage and try to get around</font><font color="#E5E5E5"> that's not</font>

302
00:09:58,120 --> 00:10:03,600
<font color="#CCCCCC">gonna happen it's it's nearly impossible</font>

303
00:09:59,650 --> 00:10:03,600
<font color="#CCCCCC">I needed I need a way around that</font>

304
00:10:11,170 --> 00:10:13,229
you

305
00:12:04,450 --> 00:12:07,479
[Music]

306
00:20:28,790 --> 00:20:32,389
and backward<font color="#CCCCCC"> Cola sighs</font><font color="#E5E5E5"> remember our</font>

307
00:20:31,070 --> 00:20:33,740
Dudley<font color="#CCCCCC"> Malick invitation that we talked</font>

308
00:20:32,390 --> 00:20:35,150
about<font color="#E5E5E5"> the beginning</font><font color="#CCCCCC"> of this we had our</font>

309
00:20:33,740 --> 00:20:37,130
unlink we had a four byte overwrite

310
00:20:35,150 --> 00:20:39,220
unlike that you could do that's<font color="#E5E5E5"> very</font>

311
00:20:37,130 --> 00:20:42,020
similar what you can do here let's

312
00:20:39,220 --> 00:20:43,280
implore you to think about<font color="#E5E5E5"> what you</font>

313
00:20:42,020 --> 00:20:44,810
<font color="#E5E5E5">could do if</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> control forward</font>

314
00:20:43,280 --> 00:20:45,830
<font color="#E5E5E5">coalesce size and Agricola size I</font>

315
00:20:44,810 --> 00:20:47,810
haven't told you<font color="#E5E5E5"> anything else about it</font>

316
00:20:45,830 --> 00:20:49,760
<font color="#CCCCCC">keep that in the back your mind</font><font color="#E5E5E5"> that's</font>

317
00:20:47,810 --> 00:20:51,139
gonna be a real key<font color="#E5E5E5"> for this exploit is</font>

318
00:20:49,760 --> 00:20:53,570
those<font color="#CCCCCC"> four word</font><font color="#E5E5E5"> coalesce</font><font color="#CCCCCC"> and Agricola</font>

319
00:20:51,140 --> 00:20:55,060
<font color="#CCCCCC">size if I can control those two</font><font color="#E5E5E5"> I can</font>

320
00:20:53,570 --> 00:21:02,270
win<font color="#E5E5E5"> okay we can control the whole</font>

321
00:20:55,060 --> 00:21:05,389
program<font color="#E5E5E5"> okay so this is</font><font color="#CCCCCC"> but this is</font>

322
00:21:02,270 --> 00:21:07,550
showing a tiny a tiny<font color="#E5E5E5"> region notice this</font>

323
00:21:05,390 --> 00:21:10,340
<font color="#CCCCCC">turn pretty six Lots</font><font color="#E5E5E5"> but only 64 filled</font>

324
00:21:07,550 --> 00:21:12,409
<font color="#E5E5E5">it's kind</font><font color="#CCCCCC"> of a silly choice for the do</font>

325
00:21:10,340 --> 00:21:14,030
but<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> what they decided</font><font color="#E5E5E5"> to and this</font>

326
00:21:12,410 --> 00:21:16,670
<font color="#E5E5E5">is what a small region looks like notice</font>

327
00:21:14,030 --> 00:21:22,070
it fills up<font color="#E5E5E5"> all all 206 it takes care of</font>

328
00:21:16,670 --> 00:21:24,230
everything<font color="#CCCCCC"> okay regions so we</font><font color="#E5E5E5"> have</font>

329
00:21:22,070 --> 00:21:26,990
<font color="#CCCCCC">magazine so may recap this one more time</font>

330
00:21:24,230 --> 00:21:28,760
<font color="#CCCCCC">we're overarching some structure we have</font>

331
00:21:26,990 --> 00:21:32,300
our magazine<font color="#CCCCCC"> Malick that's inside the</font>

332
00:21:28,760 --> 00:21:33,860
overarching<font color="#CCCCCC"> zone instructor and</font><font color="#E5E5E5"> that's</font>

333
00:21:32,300 --> 00:21:36,080
<font color="#E5E5E5">where our magazines are and inside a</font>

334
00:21:33,860 --> 00:21:38,300
magazine<font color="#E5E5E5"> is a region the region is where</font>

335
00:21:36,080 --> 00:21:39,949
<font color="#E5E5E5">the actual code but actual memory comes</font>

336
00:21:38,300 --> 00:21:42,169
from so when you when you allocate<font color="#E5E5E5"> them</font>

337
00:21:39,950 --> 00:21:43,580
something it goes<font color="#E5E5E5"> zone magazine</font>

338
00:21:42,170 --> 00:21:45,320
magazines<font color="#E5E5E5"> is hey I got a region</font>

339
00:21:43,580 --> 00:21:46,460
I got space<font color="#E5E5E5"> take something</font><font color="#CCCCCC"> from my</font>

340
00:21:45,320 --> 00:21:47,929
region<font color="#CCCCCC"> and that's where it all comes</font>

341
00:21:46,460 --> 00:21:49,700
<font color="#CCCCCC">from so that's</font><font color="#E5E5E5"> what this region T is is</font>

342
00:21:47,930 --> 00:21:52,640
that<font color="#CCCCCC"> we're the</font><font color="#E5E5E5"> actual memory itself</font>

343
00:21:49,700 --> 00:21:54,230
comes<font color="#CCCCCC"> from so I think I'd beat this to</font>

344
00:21:52,640 --> 00:21:56,900
death already<font color="#E5E5E5"> but we have tiny regions</font>

345
00:21:54,230 --> 00:21:58,640
<font color="#E5E5E5">and we're small regions so you have tiny</font>

346
00:21:56,900 --> 00:21:59,630
magazines and<font color="#E5E5E5"> you're small magazines so</font>

347
00:21:58,640 --> 00:22:02,300
again remember<font color="#E5E5E5"> I talked</font><font color="#CCCCCC"> about this</font>

348
00:21:59,630 --> 00:22:03,800
<font color="#E5E5E5">earlier</font><font color="#CCCCCC"> but if you have an exploit and</font>

349
00:22:02,300 --> 00:22:05,540
you're exporting on and you're setting

350
00:22:03,800 --> 00:22:06,740
<font color="#E5E5E5">up your exploit on tiny and for whatever</font>

351
00:22:05,540 --> 00:22:08,930
reason something<font color="#CCCCCC"> happens you have</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> go</font>

352
00:22:06,740 --> 00:22:10,220
small everything<font color="#CCCCCC"> you did is gone</font><font color="#E5E5E5"> you</font>

353
00:22:08,930 --> 00:22:13,130
know all the work you just<font color="#E5E5E5"> did is no</font>

354
00:22:10,220 --> 00:22:15,590
longer there<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you have to ensure that</font>

355
00:22:13,130 --> 00:22:18,650
<font color="#CCCCCC">you're</font><font color="#E5E5E5"> massaging and doing them hitting</font>

356
00:22:15,590 --> 00:22:21,830
<font color="#CCCCCC">the</font><font color="#E5E5E5"> right the region the right</font>

357
00:22:18,650 --> 00:22:23,720
invitation<font color="#E5E5E5"> yeah so region metadata</font>

358
00:22:21,830 --> 00:22:26,419
describes<font color="#E5E5E5"> chunk size is it</font><font color="#CCCCCC"> describes</font>

359
00:22:23,720 --> 00:22:28,730
<font color="#E5E5E5">that full it is</font><font color="#CCCCCC"> we have tiny mini their</font>

360
00:22:26,420 --> 00:22:30,590
thing and<font color="#E5E5E5"> let's move forward</font><font color="#CCCCCC"> to this one</font>

361
00:22:28,730 --> 00:22:33,890
so this<font color="#E5E5E5"> is generally what the bitmap</font>

362
00:22:30,590 --> 00:22:35,810
looks like so to see if a block is<font color="#E5E5E5"> in it</font>

363
00:22:33,890 --> 00:22:37,520
<font color="#E5E5E5">you see</font><font color="#CCCCCC"> how big a block is so this</font><font color="#E5E5E5"> block</font>

364
00:22:35,810 --> 00:22:40,409
is gonna<font color="#E5E5E5"> be 3 cuando</font><font color="#CCCCCC"> okay this</font><font color="#E5E5E5"> one and</font>

365
00:22:37,520 --> 00:22:43,260
two<font color="#CCCCCC"> zeroes</font><font color="#E5E5E5"> that's three quantum</font><font color="#CCCCCC"> okay</font>

366
00:22:40,410 --> 00:22:46,410
<font color="#E5E5E5">this second one means that it's a huge</font>

367
00:22:43,260 --> 00:22:48,390
block this one is what was to quantum

368
00:22:46,410 --> 00:22:49,980
<font color="#CCCCCC">size but because it's</font><font color="#E5E5E5"> zero</font><font color="#CCCCCC"> that means</font>

369
00:22:48,390 --> 00:22:52,920
<font color="#E5E5E5">it's a free block so if we look at our</font>

370
00:22:49,980 --> 00:22:56,370
<font color="#E5E5E5">free list we didn't see</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> at E</font>

371
00:22:52,920 --> 00:22:58,530
<font color="#E5E5E5">Street and that's our tiny regions our</font>

372
00:22:56,370 --> 00:23:00,629
small regions are nearly identical but

373
00:22:58,530 --> 00:23:02,310
they decided<font color="#E5E5E5"> to put it all in</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> so</font>

374
00:23:00,630 --> 00:23:05,160
they put it all in one<font color="#E5E5E5"> in one thing and</font>

375
00:23:02,310 --> 00:23:08,129
the top bit determines whether it's free

376
00:23:05,160 --> 00:23:11,340
<font color="#E5E5E5">or in use these are in use these are</font>

377
00:23:08,130 --> 00:23:12,450
free<font color="#CCCCCC"> the top bit decides I'm not sure</font>

378
00:23:11,340 --> 00:23:13,830
why they<font color="#CCCCCC"> decided to do one different</font>

379
00:23:12,450 --> 00:23:15,660
retaining versus one difference<font color="#CCCCCC"> before</font>

380
00:23:13,830 --> 00:23:17,280
<font color="#CCCCCC">fall and here's some more information</font>

381
00:23:15,660 --> 00:23:18,240
about<font color="#E5E5E5"> the large region that you guys are</font>

382
00:23:17,280 --> 00:23:19,560
more<font color="#E5E5E5"> than welcome to check</font><font color="#CCCCCC"> out on your</font>

383
00:23:18,240 --> 00:23:21,540
own<font color="#E5E5E5"> or</font><font color="#CCCCCC"> you can talk</font><font color="#E5E5E5"> to me about it later</font>

384
00:23:19,560 --> 00:23:27,000
<font color="#CCCCCC">I'll</font><font color="#E5E5E5"> be more than one to talk to you</font>

385
00:23:21,540 --> 00:23:28,560
about<font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> every region knows it's</font>

386
00:23:27,000 --> 00:23:31,680
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> magazine knows what magazine is</font>

387
00:23:28,560 --> 00:23:33,540
supposed to<font color="#CCCCCC"> be attached</font><font color="#E5E5E5"> to who owns me</font>

388
00:23:31,680 --> 00:23:35,340
<font color="#E5E5E5">what quorum</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> on I told you you cannot</font>

389
00:23:33,540 --> 00:23:37,020
switch course<font color="#CCCCCC"> unless you go to</font><font color="#E5E5E5"> the depot</font>

390
00:23:35,340 --> 00:23:38,639
if you pin<font color="#CCCCCC"> yourself</font><font color="#E5E5E5"> to the depot</font><font color="#CCCCCC"> that</font>

391
00:23:37,020 --> 00:23:41,220
means you now relinquish yourself you're

392
00:23:38,640 --> 00:23:43,260
not being used<font color="#E5E5E5"> anymore</font><font color="#CCCCCC"> and you can be</font>

393
00:23:41,220 --> 00:23:44,430
put on<font color="#CCCCCC"> a different core so if you have a</font>

394
00:23:43,260 --> 00:23:47,820
region<font color="#E5E5E5"> it's always gonna be on the same</font>

395
00:23:44,430 --> 00:23:50,160
core<font color="#CCCCCC"> alright and that's</font><font color="#E5E5E5"> it for that's it</font>

396
00:23:47,820 --> 00:23:51,570
for the<font color="#CCCCCC"> de structures I know I probably</font>

397
00:23:50,160 --> 00:23:52,920
<font color="#E5E5E5">went</font><font color="#CCCCCC"> overhead require didn't understand</font>

398
00:23:51,570 --> 00:23:54,210
all of it and that's<font color="#CCCCCC"> okay it's not</font><font color="#E5E5E5"> that</font>

399
00:23:52,920 --> 00:23:56,250
most important thing the world<font color="#E5E5E5"> but if</font>

400
00:23:54,210 --> 00:24:07,520
<font color="#E5E5E5">you have any questions feel free to ask</font>

401
00:23:56,250 --> 00:24:10,200
at<font color="#E5E5E5"> this moment a little</font><font color="#CCCCCC"> bit yes</font>

402
00:24:07,520 --> 00:24:12,030
everything on Apple is<font color="#E5E5E5"> open-source</font><font color="#CCCCCC"> but</font>

403
00:24:10,200 --> 00:24:14,100
what you'll find about<font color="#E5E5E5"> Apple</font><font color="#CCCCCC"> open-source</font>

404
00:24:12,030 --> 00:24:18,330
is it's open<font color="#CCCCCC"> source and that means that</font>

405
00:24:14,100 --> 00:24:20,070
like it's there but<font color="#CCCCCC"> it's not</font><font color="#E5E5E5"> correct so</font>

406
00:24:18,330 --> 00:24:22,080
like the<font color="#E5E5E5"> gender general ideas is this</font>

407
00:24:20,070 --> 00:24:24,360
document<font color="#CCCCCC"> yes</font><font color="#E5E5E5"> but we had a reverse</font>

408
00:24:22,080 --> 00:24:26,520
engineer the entire lives<font color="#CCCCCC"> this and</font>

409
00:24:24,360 --> 00:24:28,469
<font color="#CCCCCC">malloc four weeks to get</font><font color="#E5E5E5"> everything</font>

410
00:24:26,520 --> 00:24:29,760
perfect<font color="#CCCCCC"> because the open source</font>

411
00:24:28,470 --> 00:24:31,020
invitation is missing things I'm

412
00:24:29,760 --> 00:24:33,600
assuming it's missing things because of

413
00:24:31,020 --> 00:24:34,470
prior to<font color="#CCCCCC"> airy</font><font color="#E5E5E5"> proprietary knowledge and</font>

414
00:24:33,600 --> 00:24:36,300
things like that they<font color="#CCCCCC"> just didn't put</font>

415
00:24:34,470 --> 00:24:37,830
everything in there<font color="#E5E5E5"> but</font><font color="#CCCCCC"> what I do give</font>

416
00:24:36,300 --> 00:24:39,629
you guys if<font color="#E5E5E5"> you're interested in</font>

417
00:24:37,830 --> 00:24:41,580
replicating my work is I give you an

418
00:24:39,630 --> 00:24:44,850
entire<font color="#CCCCCC"> marked up live</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> Alec id be</font>

419
00:24:41,580 --> 00:24:46,260
<font color="#CCCCCC">on</font><font color="#E5E5E5"> on my github</font>

420
00:24:44,850 --> 00:24:48,000
<font color="#CCCCCC">the whole things marked up the whole to</font>

421
00:24:46,260 --> 00:24:49,410
every structure<font color="#E5E5E5"> is</font><font color="#CCCCCC"> defined everything</font><font color="#E5E5E5"> is</font>

422
00:24:48,000 --> 00:24:50,970
set<font color="#CCCCCC"> up perfect</font><font color="#E5E5E5"> again it's ten point one</font>

423
00:24:49,410 --> 00:24:53,370
<font color="#E5E5E5">point ten point one one point five</font>

424
00:24:50,970 --> 00:24:54,150
<font color="#CCCCCC">temple one point six is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same sierra</font>

425
00:24:53,370 --> 00:24:55,679
<font color="#E5E5E5">the beta</font>

426
00:24:54,150 --> 00:24:57,960
<font color="#E5E5E5">is the same but there's a chance</font><font color="#CCCCCC"> that's</font>

427
00:24:55,680 --> 00:25:01,380
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> change that's gonna segue into</font>

428
00:24:57,960 --> 00:25:02,400
this<font color="#E5E5E5"> I wrote a tool well</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> I'm not</font>

429
00:25:01,380 --> 00:25:03,930
allowed to say his<font color="#CCCCCC"> name he doesn't want</font>

430
00:25:02,400 --> 00:25:05,910
to be you guys want to<font color="#E5E5E5"> talk to me and a</font>

431
00:25:03,930 --> 00:25:08,340
<font color="#E5E5E5">good friend</font><font color="#CCCCCC"> of mine</font><font color="#E5E5E5"> wrote a tool and we</font>

432
00:25:05,910 --> 00:25:09,780
call it<font color="#E5E5E5"> Mac keep and it's</font><font color="#CCCCCC"> LT</font><font color="#E5E5E5"> Python</font>

433
00:25:08,340 --> 00:25:11,669
<font color="#E5E5E5">script</font><font color="#CCCCCC"> that allows you</font><font color="#E5E5E5"> to access</font>

434
00:25:09,780 --> 00:25:13,230
everything I<font color="#CCCCCC"> just</font><font color="#E5E5E5"> told you</font><font color="#CCCCCC"> you can look</font>

435
00:25:11,670 --> 00:25:14,730
<font color="#E5E5E5">at any of these pieces information</font><font color="#CCCCCC"> is</font>

436
00:25:13,230 --> 00:25:17,490
talked about<font color="#CCCCCC"> you can analyze all of them</font>

437
00:25:14,730 --> 00:25:18,630
you<font color="#E5E5E5"> can do anything you want what's</font>

438
00:25:17,490 --> 00:25:20,730
great about the zillion Python script

439
00:25:18,630 --> 00:25:22,290
<font color="#CCCCCC">there's probably 700 lines give or take</font>

440
00:25:20,730 --> 00:25:24,300
and if they make any<font color="#CCCCCC"> change its their</font>

441
00:25:22,290 --> 00:25:25,860
structures just<font color="#CCCCCC"> change my structures my</font>

442
00:25:24,300 --> 00:25:29,040
structures are very easily<font color="#E5E5E5"> set up it's</font>

443
00:25:25,860 --> 00:25:30,479
very<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> to modify</font><font color="#E5E5E5"> we set this thing up</font>

444
00:25:29,040 --> 00:25:32,730
so<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the future it's gonna be very</font>

445
00:25:30,480 --> 00:25:34,410
<font color="#E5E5E5">easy I have</font><font color="#CCCCCC"> planned support this iOS</font><font color="#E5E5E5"> so</font>

446
00:25:32,730 --> 00:25:36,510
then<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> have the same introspection</font>

447
00:25:34,410 --> 00:25:37,680
tools on iOS we<font color="#E5E5E5"> set it up very modular</font>

448
00:25:36,510 --> 00:25:40,860
very easy to adjust

449
00:25:37,680 --> 00:25:42,720
so anything<font color="#CCCCCC"> that any uh</font><font color="#E5E5E5"> malloc changes</font>

450
00:25:40,860 --> 00:25:44,669
shouldn't really affect our tool too

451
00:25:42,720 --> 00:25:45,990
much<font color="#E5E5E5"> like I said Apple does have a</font>

452
00:25:44,670 --> 00:25:46,860
patent on<font color="#E5E5E5"> this they're not gonna just</font>

453
00:25:45,990 --> 00:25:48,840
change<font color="#E5E5E5"> your malloc conversation</font>

454
00:25:46,860 --> 00:25:51,000
<font color="#CCCCCC">completely because they do spend</font><font color="#E5E5E5"> a lot</font>

455
00:25:48,840 --> 00:25:56,429
<font color="#CCCCCC">of time and research making</font><font color="#E5E5E5"> it</font>

456
00:25:51,000 --> 00:25:58,110
allocation scheme any demo<font color="#E5E5E5"> would give or</font>

457
00:25:56,430 --> 00:26:00,990
whatever<font color="#E5E5E5"> I'll be showing you this mat</font>

458
00:25:58,110 --> 00:26:02,310
<font color="#E5E5E5">keep tool</font><font color="#CCCCCC"> and that's really the meat of</font>

459
00:26:00,990 --> 00:26:04,410
<font color="#E5E5E5">my talk</font><font color="#CCCCCC"> that's where I</font><font color="#E5E5E5"> could most of my</font>

460
00:26:02,310 --> 00:26:05,820
time<font color="#E5E5E5"> and I would</font><font color="#CCCCCC"> appreciate anything</font><font color="#E5E5E5"> I</font>

461
00:26:04,410 --> 00:26:07,650
say<font color="#CCCCCC"> or any I do want</font><font color="#E5E5E5"> you guys to</font>

462
00:26:05,820 --> 00:26:11,149
understand or whatever please<font color="#CCCCCC"> just shout</font>

463
00:26:07,650 --> 00:26:13,860
out I'll try to explain<font color="#E5E5E5"> the best I can</font>

464
00:26:11,150 --> 00:26:17,250
okay so strategies<font color="#E5E5E5"> I talked</font><font color="#CCCCCC"> about the my</font>

465
00:26:13,860 --> 00:26:18,240
main<font color="#CCCCCC"> strategy for here is we</font><font color="#E5E5E5"> need we</font>

466
00:26:17,250 --> 00:26:19,800
need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> position things right that's</font>

467
00:26:18,240 --> 00:26:20,880
that's that's problem one cuz I have

468
00:26:19,800 --> 00:26:22,470
these<font color="#CCCCCC"> always checks on I have a</font><font color="#E5E5E5"> lot of</font>

469
00:26:20,880 --> 00:26:23,880
checks on problems<font color="#E5E5E5"> I can't run in any of</font>

470
00:26:22,470 --> 00:26:25,680
those<font color="#E5E5E5"> problems</font><font color="#CCCCCC"> so I need to I need</font><font color="#E5E5E5"> to</font>

471
00:26:23,880 --> 00:26:27,680
have a spot where I'm open with no free

472
00:26:25,680 --> 00:26:32,820
blocks<font color="#E5E5E5"> more difficult than you think</font>

473
00:26:27,680 --> 00:26:34,050
<font color="#CCCCCC">I need said</font><font color="#E5E5E5"> things over right and I</font><font color="#CCCCCC"> need</font>

474
00:26:32,820 --> 00:26:35,189
<font color="#CCCCCC">to do my metadata unlinking attack</font>

475
00:26:34,050 --> 00:26:36,690
<font color="#E5E5E5">remember you're</font><font color="#CCCCCC"> supposed to</font><font color="#E5E5E5"> be thinking</font>

476
00:26:35,190 --> 00:26:38,910
<font color="#CCCCCC">in the back of</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> mind if you control</font>

477
00:26:36,690 --> 00:26:40,590
the<font color="#CCCCCC"> coalesce</font><font color="#E5E5E5"> size what can we do so</font>

478
00:26:38,910 --> 00:26:42,090
that's that's the part<font color="#CCCCCC"> that</font><font color="#E5E5E5"> was I've</font>

479
00:26:40,590 --> 00:26:42,959
given this talk<font color="#CCCCCC"> before</font><font color="#E5E5E5"> and people didn't</font>

480
00:26:42,090 --> 00:26:45,570
<font color="#CCCCCC">quite understand that so it's what I'm</font>

481
00:26:42,960 --> 00:26:47,340
trying to<font color="#E5E5E5"> emphasize that just to kind of</font>

482
00:26:45,570 --> 00:26:49,260
think<font color="#CCCCCC"> about that</font><font color="#E5E5E5"> the forward size how</font>

483
00:26:47,340 --> 00:26:51,209
big that's now big that block is and how

484
00:26:49,260 --> 00:26:52,800
far back the next free block is<font color="#E5E5E5"> is</font>

485
00:26:51,210 --> 00:26:55,080
controlled directly by<font color="#E5E5E5"> metadata and we</font>

486
00:26:52,800 --> 00:26:59,220
can overflow<font color="#E5E5E5"> that so let's just keep</font>

487
00:26:55,080 --> 00:27:01,800
that<font color="#CCCCCC"> in mind as we go along so I talked</font>

488
00:26:59,220 --> 00:27:03,140
<font color="#E5E5E5">about this already but</font><font color="#CCCCCC"> the only key</font><font color="#E5E5E5"> the</font>

489
00:27:01,800 --> 00:27:05,550
<font color="#E5E5E5">point</font><font color="#CCCCCC"> say going</font><font color="#E5E5E5"> home home here</font>

490
00:27:03,140 --> 00:27:07,330
most people are<font color="#E5E5E5"> windows people</font><font color="#CCCCCC"> windows</font>

491
00:27:05,550 --> 00:27:08,678
cache works

492
00:27:07,330 --> 00:27:10,239
if you any if<font color="#E5E5E5"> you allocate</font><font color="#CCCCCC"> a size</font>

493
00:27:08,679 --> 00:27:11,739
smaller<font color="#CCCCCC"> sivaiah</font><font color="#E5E5E5"> and my cache is</font><font color="#CCCCCC"> full of</font>

494
00:27:10,239 --> 00:27:12,730
<font color="#E5E5E5">200 bytes and</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> allocate hundred bytes</font>

495
00:27:11,739 --> 00:27:14,950
<font color="#E5E5E5">well it's gonna</font><font color="#CCCCCC"> take it off the</font><font color="#E5E5E5"> cash</font>

496
00:27:12,730 --> 00:27:20,289
<font color="#CCCCCC">always X</font><font color="#E5E5E5"> keep it does not do that</font><font color="#CCCCCC"> they</font>

497
00:27:14,950 --> 00:27:21,840
exact only exact so free list we talked

498
00:27:20,289 --> 00:27:24,489
<font color="#CCCCCC">about already but it's linked list</font>

499
00:27:21,840 --> 00:27:26,678
<font color="#CCCCCC">indexed by quantum size so if you want</font>

500
00:27:24,489 --> 00:27:28,659
<font color="#E5E5E5">to allocate a for quantum but block you</font>

501
00:27:26,679 --> 00:27:30,190
go to you go to slot 4<font color="#E5E5E5"> if there's</font>

502
00:27:28,659 --> 00:27:32,019
nothing<font color="#CCCCCC"> there</font><font color="#E5E5E5"> you go to stop 5 if</font>

503
00:27:30,190 --> 00:27:33,249
there's nothing<font color="#CCCCCC"> there you go to saw</font><font color="#E5E5E5"> 6 so</font>

504
00:27:32,019 --> 00:27:35,139
on and so forth<font color="#CCCCCC"> until you find a slot</font>

505
00:27:33,249 --> 00:27:38,379
that's open and when you find this<font color="#CCCCCC"> lot</font>

506
00:27:35,139 --> 00:27:39,820
<font color="#E5E5E5">that's open you it'll cut that block</font>

507
00:27:38,379 --> 00:27:42,730
open<font color="#E5E5E5"> coalesce</font><font color="#CCCCCC"> device that blocks</font>

508
00:27:39,820 --> 00:27:44,350
together<font color="#CCCCCC"> and that's how that works</font><font color="#E5E5E5"> it's</font>

509
00:27:42,730 --> 00:27:46,450
important<font color="#E5E5E5"> because if the cache is full</font>

510
00:27:44,350 --> 00:27:48,100
<font color="#E5E5E5">and you're trying to set up you're</font>

511
00:27:46,450 --> 00:27:49,179
trying to say if<font color="#CCCCCC"> you spray</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> shiny said</font>

512
00:27:48,100 --> 00:27:50,678
things like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> and it</font><font color="#E5E5E5"> starts pulling</font>

513
00:27:49,179 --> 00:27:52,179
off the cache<font color="#E5E5E5"> not the free list not</font>

514
00:27:50,679 --> 00:27:55,090
somewhere<font color="#E5E5E5"> you expect well then you're</font>

515
00:27:52,179 --> 00:27:56,649
kind<font color="#E5E5E5"> of in a bad predicament so I like</font>

516
00:27:55,090 --> 00:27:57,850
to<font color="#E5E5E5"> clear the cache almost instant so the</font>

517
00:27:56,649 --> 00:28:01,629
person<font color="#CCCCCC"> wanted the</font><font color="#E5E5E5"> first thing we did in</font>

518
00:27:57,850 --> 00:28:03,699
our exploit is clear off the cache<font color="#CCCCCC"> all</font>

519
00:28:01,629 --> 00:28:06,459
<font color="#CCCCCC">right so here we go I think I'm gonna</font>

520
00:28:03,700 --> 00:28:06,899
<font color="#E5E5E5">yes I'll try the pointer I'm gonna do my</font>

521
00:28:06,460 --> 00:28:11,739
<font color="#CCCCCC">best</font>

522
00:28:06,899 --> 00:28:13,600
it's tough<font color="#CCCCCC"> to</font><font color="#E5E5E5"> explain</font><font color="#CCCCCC"> ok so let's say we</font>

523
00:28:11,739 --> 00:28:16,359
control blue<font color="#E5E5E5"> block</font><font color="#CCCCCC"> I can overflow blue</font>

524
00:28:13,600 --> 00:28:18,908
block as much as I want<font color="#E5E5E5"> okay and I have</font>

525
00:28:16,359 --> 00:28:21,340
<font color="#E5E5E5">red block here and red blocks a</font><font color="#CCCCCC"> 3x3</font>

526
00:28:18,909 --> 00:28:24,249
block free block<font color="#CCCCCC"> 1 means it's in use</font><font color="#E5E5E5"> 0</font>

527
00:28:21,340 --> 00:28:27,668
means it's free<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so if I overwrite</font>

528
00:28:24,249 --> 00:28:29,619
blue block<font color="#CCCCCC"> I over write them all the way</font>

529
00:28:27,669 --> 00:28:31,299
to backward<font color="#E5E5E5"> Co that's right to my back</font>

530
00:28:29,619 --> 00:28:32,590
<font color="#E5E5E5">Ricola</font><font color="#CCCCCC"> size</font><font color="#E5E5E5"> let's ignore the checksum</font>

531
00:28:31,299 --> 00:28:34,690
problems ignore all those problem<font color="#E5E5E5"> to</font>

532
00:28:32,590 --> 00:28:36,970
this point<font color="#E5E5E5"> and let's say we can</font>

533
00:28:34,690 --> 00:28:38,919
overwrite<font color="#CCCCCC"> it's backwards</font><font color="#E5E5E5"> size what</font>

534
00:28:36,970 --> 00:28:41,409
happens if I point<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> backwards</font><font color="#E5E5E5"> size</font>

535
00:28:38,919 --> 00:28:43,119
to another<font color="#E5E5E5"> free block I so instead</font><font color="#CCCCCC"> of</font>

536
00:28:41,409 --> 00:28:44,980
<font color="#CCCCCC">pointing it's free its backward</font><font color="#E5E5E5"> size</font>

537
00:28:43,119 --> 00:28:46,809
points that's busy block so it knows

538
00:28:44,980 --> 00:28:48,460
when it tries to<font color="#E5E5E5"> coalesce hey</font><font color="#CCCCCC"> but block</font>

539
00:28:46,809 --> 00:28:49,539
<font color="#E5E5E5">behind</font><font color="#CCCCCC"> you busy I can't call this a busy</font>

540
00:28:48,460 --> 00:28:51,070
block that's a busy block what am I

541
00:28:49,539 --> 00:28:53,710
supposed to do<font color="#E5E5E5"> I'm gonna stay with</font><font color="#CCCCCC"> my by</font>

542
00:28:51,070 --> 00:28:55,359
myself<font color="#E5E5E5"> but if I overrode this</font><font color="#CCCCCC"> backwards</font>

543
00:28:53,710 --> 00:28:56,950
size and said hey you know what you

544
00:28:55,359 --> 00:28:58,119
<font color="#E5E5E5">actually are this big</font>

545
00:28:56,950 --> 00:28:59,980
your<font color="#E5E5E5"> backer size is</font><font color="#CCCCCC"> actually back</font><font color="#E5E5E5"> to</font>

546
00:28:58,119 --> 00:29:02,080
here to this free block<font color="#E5E5E5"> when the</font>

547
00:28:59,980 --> 00:29:03,399
coalescing algorithms goes through<font color="#CCCCCC"> its</font>

548
00:29:02,080 --> 00:29:05,529
<font color="#CCCCCC">gonna say hey the block behind</font><font color="#E5E5E5"> me is</font>

549
00:29:03,399 --> 00:29:07,178
free<font color="#CCCCCC"> let's mark everything between me</font>

550
00:29:05,529 --> 00:29:09,340
and<font color="#CCCCCC"> that block that's free those are all</font>

551
00:29:07,179 --> 00:29:11,710
free blocks<font color="#E5E5E5"> so what that's gonna do</font><font color="#CCCCCC"> is</font>

552
00:29:09,340 --> 00:29:13,299
it's<font color="#E5E5E5"> gonna take</font><font color="#CCCCCC"> all these ones all these</font>

553
00:29:11,710 --> 00:29:15,340
ones and you're gonna get it you<font color="#E5E5E5"> can</font>

554
00:29:13,299 --> 00:29:16,929
actually allocate<font color="#CCCCCC"> two objects</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> top of</font>

555
00:29:15,340 --> 00:29:17,859
each other<font color="#E5E5E5"> and by allocating to offices</font>

556
00:29:16,929 --> 00:29:19,539
objects on<font color="#CCCCCC"> top of each</font><font color="#E5E5E5"> other by</font>

557
00:29:17,859 --> 00:29:20,800
<font color="#E5E5E5">overriding the</font><font color="#CCCCCC"> backward size we now</font>

558
00:29:19,539 --> 00:29:22,540
return to<font color="#CCCCCC"> keyboard</font>

559
00:29:20,800 --> 00:29:23,740
<font color="#E5E5E5">three two hours and top of each other</font><font color="#CCCCCC"> I</font>

560
00:29:22,540 --> 00:29:25,149
mean<font color="#CCCCCC"> is it's the</font><font color="#E5E5E5"> same that same</font>

561
00:29:23,740 --> 00:29:26,680
scenarios are you start to create so

562
00:29:25,150 --> 00:29:29,260
<font color="#CCCCCC">what we do here is where you taking the</font>

563
00:29:26,680 --> 00:29:30,880
<font color="#CCCCCC">heat</font><font color="#E5E5E5"> overflow over writing some</font><font color="#CCCCCC"> mated</font>

564
00:29:29,260 --> 00:29:32,830
metadata to turn this into<font color="#E5E5E5"> yourself to</font>

565
00:29:30,880 --> 00:29:36,640
<font color="#CCCCCC">free so we can get a standard</font><font color="#E5E5E5"> a more</font>

566
00:29:32,830 --> 00:29:38,500
standard exploit out of it<font color="#E5E5E5"> that's that's</font>

567
00:29:36,640 --> 00:29:40,840
backwards<font color="#CCCCCC"> the next slide</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> for words</font>

568
00:29:38,500 --> 00:29:42,280
<font color="#E5E5E5">I'm not gonna thank slides for words and</font>

569
00:29:40,840 --> 00:29:45,850
it's the same idea<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> just gonna</font>

570
00:29:42,280 --> 00:29:48,160
<font color="#CCCCCC">overwrite these yeah just</font><font color="#E5E5E5"> gonna write</font>

571
00:29:45,850 --> 00:29:49,659
these<font color="#E5E5E5"> and you're gonna point this guy</font>

572
00:29:48,160 --> 00:29:51,070
you're gonna point this guy forward into

573
00:29:49,660 --> 00:29:52,660
this next<font color="#CCCCCC"> free block up here the same</font>

574
00:29:51,070 --> 00:29:54,129
<font color="#CCCCCC">way that happens</font><font color="#E5E5E5"> I've had much more luck</font>

575
00:29:52,660 --> 00:29:55,540
with backward<font color="#E5E5E5"> coalescing I think back</font>

576
00:29:54,130 --> 00:29:56,350
row hasn't got much<font color="#CCCCCC"> more reliable</font><font color="#E5E5E5"> that</font>

577
00:29:55,540 --> 00:29:58,840
<font color="#E5E5E5">works a lot better</font>

578
00:29:56,350 --> 00:30:02,770
<font color="#E5E5E5">forward coalescing is extreme rare</font>

579
00:29:58,840 --> 00:30:04,750
scenario<font color="#CCCCCC"> it's not super useful not super</font>

580
00:30:02,770 --> 00:30:06,190
<font color="#E5E5E5">useful for the use</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> degree type idea</font>

581
00:30:04,750 --> 00:30:07,720
that I was<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> for so we didn't go</font>

582
00:30:06,190 --> 00:30:09,940
in this too deep<font color="#E5E5E5"> but the same idea could</font>

583
00:30:07,720 --> 00:30:11,170
<font color="#E5E5E5">be applied</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> any questions in</font>

584
00:30:09,940 --> 00:30:12,490
<font color="#E5E5E5">there that's like that's</font><font color="#CCCCCC"> the probably</font>

585
00:30:11,170 --> 00:30:13,750
<font color="#E5E5E5">that</font><font color="#CCCCCC"> that's the most difficult thing</font><font color="#E5E5E5"> to</font>

586
00:30:12,490 --> 00:30:14,980
understand it's<font color="#CCCCCC"> like the most important</font>

587
00:30:13,750 --> 00:30:16,780
<font color="#E5E5E5">part to understand on how we got this</font>

588
00:30:14,980 --> 00:30:18,610
<font color="#CCCCCC">how we took</font><font color="#E5E5E5"> Ebola flow to a full</font>

589
00:30:16,780 --> 00:30:20,110
exponent<font color="#CCCCCC"> sorry</font><font color="#E5E5E5"> that this is the magic</font>

590
00:30:18,610 --> 00:30:21,699
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is the Voodoo this</font><font color="#E5E5E5"> the part that</font>

591
00:30:20,110 --> 00:30:22,929
people this is the part that<font color="#E5E5E5"> people are</font>

592
00:30:21,700 --> 00:30:24,430
like oh how do I explain right<font color="#CCCCCC"> here to</font>

593
00:30:22,930 --> 00:30:27,460
it<font color="#CCCCCC"> how does it happens that's it that</font>

594
00:30:24,430 --> 00:30:29,350
was the Voodoo that<font color="#E5E5E5"> so if you don't get</font>

595
00:30:27,460 --> 00:30:30,760
<font color="#CCCCCC">questions about it please</font><font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> super</font>

596
00:30:29,350 --> 00:30:38,550
difficult<font color="#E5E5E5"> it just took a really long</font>

597
00:30:30,760 --> 00:30:38,550
<font color="#CCCCCC">time to</font><font color="#E5E5E5"> figure out nothing okay</font><font color="#CCCCCC"> alright</font>

598
00:30:39,030 --> 00:30:44,350
<font color="#E5E5E5">so we talked</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> already but it also</font>

599
00:30:42,670 --> 00:30:45,790
has also<font color="#E5E5E5"> the four byte metadata</font>

600
00:30:44,350 --> 00:30:47,260
overwrite that<font color="#E5E5E5"> you still have that</font><font color="#CCCCCC"> same</font>

601
00:30:45,790 --> 00:30:48,520
<font color="#CCCCCC">Doug Liman like</font><font color="#E5E5E5"> overwrite I could</font>

602
00:30:47,260 --> 00:30:50,440
overwrite info over the next corner the

603
00:30:48,520 --> 00:30:52,830
<font color="#E5E5E5">blinker blink and get a four byte</font>

604
00:30:50,440 --> 00:30:54,580
overwrite well what's wrong with<font color="#E5E5E5"> that</font>

605
00:30:52,830 --> 00:30:55,810
<font color="#CCCCCC">seven</font><font color="#E5E5E5"> percent</font><font color="#CCCCCC"> chance</font><font color="#E5E5E5"> to get in the</font>

606
00:30:54,580 --> 00:30:58,929
correct<font color="#E5E5E5"> checksum oh that's pretty</font>

607
00:30:55,810 --> 00:31:01,960
terrible<font color="#CCCCCC"> but you know dies oh he had a</font>

608
00:30:58,930 --> 00:31:04,810
cool technique for<font color="#E5E5E5"> Snow Leopard I</font>

609
00:31:01,960 --> 00:31:05,800
believe is the operators name and you

610
00:31:04,810 --> 00:31:07,330
would just overwrite everything with

611
00:31:05,800 --> 00:31:08,710
know instead of overwriting<font color="#E5E5E5"> the pointers</font>

612
00:31:07,330 --> 00:31:10,300
<font color="#E5E5E5">used over everything with null so then</font>

613
00:31:08,710 --> 00:31:12,670
you can get<font color="#E5E5E5"> to know</font><font color="#CCCCCC"> better metadata so</font>

614
00:31:10,300 --> 00:31:15,760
if<font color="#E5E5E5"> I overwrite if I over all these guys</font>

615
00:31:12,670 --> 00:31:17,770
were<font color="#CCCCCC"> here no no no no backward emphasize</font>

616
00:31:15,760 --> 00:31:19,180
better when it goes into a checksum

617
00:31:17,770 --> 00:31:20,260
<font color="#CCCCCC">what's the checksum of</font><font color="#E5E5E5"> null have you</font>

618
00:31:19,180 --> 00:31:22,570
checked them<font color="#E5E5E5"> no</font><font color="#CCCCCC"> that's this gonna be no</font>

619
00:31:20,260 --> 00:31:24,310
right well Apple thought about<font color="#E5E5E5"> this</font>

620
00:31:22,570 --> 00:31:26,230
already<font color="#CCCCCC"> and</font><font color="#E5E5E5"> what they do is it</font>

621
00:31:24,310 --> 00:31:28,030
<font color="#E5E5E5">everything is null it goes in the region</font>

622
00:31:26,230 --> 00:31:29,140
<font color="#CCCCCC">it marks there's an on</font><font color="#E5E5E5"> use block</font><font color="#CCCCCC"> it says</font>

623
00:31:28,030 --> 00:31:30,820
you cannot<font color="#CCCCCC"> use a block anymore this</font>

624
00:31:29,140 --> 00:31:32,530
block is no longer<font color="#E5E5E5"> good so you have to</font>

625
00:31:30,820 --> 00:31:34,510
do some coalescing to get that block

626
00:31:32,530 --> 00:31:36,100
back<font color="#E5E5E5"> in use</font><font color="#CCCCCC"> it turns out that that's</font>

627
00:31:34,510 --> 00:31:38,919
unfortunately it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> quite possible</font>

628
00:31:36,100 --> 00:31:40,449
with the way that<font color="#CCCCCC"> our heap overflow is</font>

629
00:31:38,919 --> 00:31:42,220
<font color="#E5E5E5">set up but that would be ideas you</font>

630
00:31:40,450 --> 00:31:44,169
overwrite everything<font color="#E5E5E5"> with null you think</font>

631
00:31:42,220 --> 00:31:46,390
a coalesce again<font color="#E5E5E5"> and get this block back</font>

632
00:31:44,169 --> 00:31:48,130
in use<font color="#CCCCCC"> and pass all the check all the</font>

633
00:31:46,390 --> 00:31:50,830
checks<font color="#CCCCCC"> and pointers</font><font color="#E5E5E5"> what we ended up</font>

634
00:31:48,130 --> 00:31:53,470
doing<font color="#E5E5E5"> we end up doing is that the checks</font>

635
00:31:50,830 --> 00:31:55,418
<font color="#CCCCCC">and pointers</font><font color="#E5E5E5"> they come</font><font color="#CCCCCC"> out to be 1 3 or</font>

636
00:31:53,470 --> 00:31:56,799
<font color="#E5E5E5">7 like that was it they</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> 1 3 or</font><font color="#CCCCCC"> 7</font><font color="#E5E5E5"> so</font>

637
00:31:55,419 --> 00:31:58,270
I started<font color="#CCCCCC"> two</font><font color="#E5E5E5"> percent chance I'll take</font>

638
00:31:56,799 --> 00:32:00,129
<font color="#E5E5E5">that chance that's that's where we left</font>

639
00:31:58,270 --> 00:32:01,600
it at all<font color="#E5E5E5"> override the</font><font color="#CCCCCC"> corner I just try</font>

640
00:32:00,130 --> 00:32:02,460
over<font color="#CCCCCC"> 1/3 or</font><font color="#E5E5E5"> 7 and that's where</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> that's</font>

641
00:32:01,600 --> 00:32:04,449
<font color="#E5E5E5">where we left it</font>

642
00:32:02,460 --> 00:32:05,710
obviously if I want the weapon great

643
00:32:04,450 --> 00:32:07,600
<font color="#E5E5E5">exploit I've wanted this to be better if</font>

644
00:32:05,710 --> 00:32:08,740
I wanted<font color="#E5E5E5"> to be the best of the best</font><font color="#CCCCCC"> you</font>

645
00:32:07,600 --> 00:32:11,469
need to figure out<font color="#E5E5E5"> a way</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> around</font>

646
00:32:08,740 --> 00:32:18,720
<font color="#E5E5E5">that and</font><font color="#CCCCCC"> that's a</font><font color="#E5E5E5"> serious problem</font><font color="#CCCCCC"> that</font>

647
00:32:11,470 --> 00:32:21,700
the office XP<font color="#CCCCCC"> past</font><font color="#E5E5E5"> for exportation</font><font color="#CCCCCC"> ok so</font>

648
00:32:18,720 --> 00:32:23,950
does anybody audience<font color="#E5E5E5"> feel brave or on</font>

649
00:32:21,700 --> 00:32:25,960
talk or<font color="#CCCCCC"> just want me</font><font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> I like to</font>

650
00:32:23,950 --> 00:32:29,380
<font color="#CCCCCC">talk it's not a big deal no ok that's</font>

651
00:32:25,960 --> 00:32:33,580
fine<font color="#CCCCCC"> let's say for instance we want</font><font color="#E5E5E5"> to</font>

652
00:32:29,380 --> 00:32:35,380
allocate<font color="#CCCCCC"> 5 quantum allocation what are</font>

653
00:32:33,580 --> 00:32:37,780
we gonna do we're gonna<font color="#CCCCCC"> go to 5 right</font>

654
00:32:35,380 --> 00:32:38,290
and there's nothing there<font color="#E5E5E5"> so what are we</font>

655
00:32:37,780 --> 00:32:40,090
gonna<font color="#E5E5E5"> do next</font>

656
00:32:38,290 --> 00:32:41,620
<font color="#E5E5E5">we're gonna go to 6 and we're gonna go</font>

657
00:32:40,090 --> 00:32:43,330
down<font color="#CCCCCC"> 6 we're gonna walk to the</font><font color="#E5E5E5"> end of it</font>

658
00:32:41,620 --> 00:32:46,439
and I'm gonna give you<font color="#CCCCCC"> this block this</font>

659
00:32:43,330 --> 00:32:48,639
<font color="#E5E5E5">is gonna be the block you get returned</font>

660
00:32:46,440 --> 00:32:50,919
<font color="#E5E5E5">and that's that's crazy how it is if I</font>

661
00:32:48,640 --> 00:32:51,970
want<font color="#CCCCCC"> an allocated</font><font color="#E5E5E5"> block that was 15</font><font color="#CCCCCC"> it</font>

662
00:32:50,919 --> 00:32:53,590
would<font color="#E5E5E5"> go to the end and it was</font><font color="#CCCCCC"> say I</font>

663
00:32:51,970 --> 00:32:55,540
<font color="#E5E5E5">don't have anything there</font><font color="#CCCCCC"> so what do you</font>

664
00:32:53,590 --> 00:32:56,709
do if you<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have any in there so we</font>

665
00:32:55,540 --> 00:32:59,080
look in the<font color="#CCCCCC"> cache so start looking</font>

666
00:32:56,710 --> 00:33:02,830
<font color="#CCCCCC">cached is an exact match</font><font color="#E5E5E5"> sure great</font>

667
00:32:59,080 --> 00:33:07,030
allocate that is it is their spot in the

668
00:33:02,830 --> 00:33:09,250
free list<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> allocated awesome walk up</font>

669
00:33:07,030 --> 00:33:11,139
the free list do we find<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> ok</font>

670
00:33:09,250 --> 00:33:13,929
great allocated<font color="#E5E5E5"> if all those things fail</font>

671
00:33:11,140 --> 00:33:16,929
<font color="#E5E5E5">we allocate from the</font><font color="#CCCCCC"> reason</font><font color="#E5E5E5"> how do you</font>

672
00:33:13,929 --> 00:33:18,340
allocate from region well it's pretty

673
00:33:16,929 --> 00:33:19,600
straightforward<font color="#CCCCCC"> you go to the mag bytes</font>

674
00:33:18,340 --> 00:33:20,860
<font color="#CCCCCC">for you and say hey I have</font><font color="#E5E5E5"> this much</font>

675
00:33:19,600 --> 00:33:24,280
many buddies available give me some

676
00:33:20,860 --> 00:33:26,500
bytes there's a couple metadata there's

677
00:33:24,280 --> 00:33:29,200
<font color="#E5E5E5">no metadata pieces in the region itself</font>

678
00:33:26,500 --> 00:33:30,700
<font color="#E5E5E5">that determine where you're gonna get</font>

679
00:33:29,200 --> 00:33:31,870
more bites from and we're going<font color="#E5E5E5"> to I'm</font>

680
00:33:30,700 --> 00:33:34,840
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to demo this and show you</font><font color="#CCCCCC"> guys how</font>

681
00:33:31,870 --> 00:33:36,939
<font color="#E5E5E5">we can accurately predict all any</font>

682
00:33:34,840 --> 00:33:38,500
allocation well before it happens<font color="#CCCCCC"> where</font>

683
00:33:36,940 --> 00:33:39,940
it's<font color="#E5E5E5"> coming from</font><font color="#CCCCCC"> where it's</font><font color="#E5E5E5"> gonna be how</font>

684
00:33:38,500 --> 00:33:44,080
it's<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> line up we can predict all</font>

685
00:33:39,940 --> 00:33:45,549
those things<font color="#E5E5E5"> so I'm trying a new thing</font>

686
00:33:44,080 --> 00:33:46,689
here I'm not demoing till the end I'm

687
00:33:45,549 --> 00:33:47,700
<font color="#CCCCCC">just gonna do one long demo at the</font><font color="#E5E5E5"> end</font>

688
00:33:46,690 --> 00:33:48,620
<font color="#E5E5E5">to try to make</font>

689
00:33:47,700 --> 00:33:53,029
this whole thing a<font color="#E5E5E5"> little more cohesive</font>

690
00:33:48,620 --> 00:33:55,260
<font color="#CCCCCC">again if I</font><font color="#E5E5E5"> ask questions</font><font color="#CCCCCC"> as you get I</font>

691
00:33:53,029 --> 00:33:58,139
try<font color="#E5E5E5"> to put this in</font><font color="#CCCCCC"> here just</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> you guys</font>

692
00:33:55,260 --> 00:34:00,000
understand what<font color="#CCCCCC"> this does</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a</font>

693
00:33:58,139 --> 00:34:01,649
stupid<font color="#E5E5E5"> Python script what this does is</font>

694
00:34:00,000 --> 00:34:05,100
it forces every allocation on the

695
00:34:01,649 --> 00:34:06,510
magazine one<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> i mean maybe</font>

696
00:34:05,100 --> 00:34:09,960
somebody<font color="#E5E5E5"> can but it's extremely</font>

697
00:34:06,510 --> 00:34:11,609
difficult to<font color="#CCCCCC"> debug</font><font color="#E5E5E5"> an application using</font>

698
00:34:09,960 --> 00:34:14,179
those<font color="#E5E5E5"> X key but with LD be if you don't</font>

699
00:34:11,609 --> 00:34:16,259
<font color="#E5E5E5">do this because every</font><font color="#CCCCCC"> breakpoint my</font>

700
00:34:14,179 --> 00:34:17,668
every<font color="#CCCCCC"> breakpoint my core was</font><font color="#E5E5E5"> gonna</font>

701
00:34:16,260 --> 00:34:19,980
switch every single breakpoint doesn't

702
00:34:17,668 --> 00:34:22,379
matter<font color="#E5E5E5"> so every time I would do anything</font>

703
00:34:19,980 --> 00:34:24,270
<font color="#E5E5E5">it would switch all this does is it goes</font>

704
00:34:22,379 --> 00:34:25,679
through<font color="#CCCCCC"> and</font><font color="#E5E5E5"> makes it</font><font color="#CCCCCC"> in sure</font><font color="#E5E5E5"> that goes</font>

705
00:34:24,270 --> 00:34:28,668
in core<font color="#E5E5E5"> one it's always on core one and</font>

706
00:34:25,679 --> 00:34:30,690
every switches<font color="#CCCCCC"> from core map core one</font>

707
00:34:28,668 --> 00:34:32,520
all<font color="#E5E5E5"> right so that's everything from</font>

708
00:34:30,690 --> 00:34:34,079
that's<font color="#E5E5E5"> all our allocation stuff do we</font>

709
00:34:32,520 --> 00:34:37,379
have any question on<font color="#E5E5E5"> how to allocate you</font>

710
00:34:34,079 --> 00:34:39,899
got<font color="#CCCCCC"> will</font><font color="#E5E5E5"> go with that</font><font color="#CCCCCC"> okay so the last</font>

711
00:34:37,379 --> 00:34:41,668
<font color="#E5E5E5">thing before</font><font color="#CCCCCC"> we go into a</font><font color="#E5E5E5"> demo and</font>

712
00:34:39,899 --> 00:34:43,078
<font color="#CCCCCC">before we talk about</font><font color="#E5E5E5"> that do you guys</font>

713
00:34:41,668 --> 00:34:44,250
want a demo I'm a demo<font color="#E5E5E5"> this stuff</font><font color="#CCCCCC"> and</font>

714
00:34:43,079 --> 00:34:46,109
then we'll talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> I thought the</font>

715
00:34:44,250 --> 00:34:49,679
exploit I'll demo how stuff works don't

716
00:34:46,109 --> 00:34:53,279
<font color="#E5E5E5">talk about anyway okay so</font><font color="#CCCCCC"> this is a</font>

717
00:34:49,679 --> 00:34:55,500
bitmap<font color="#CCCCCC"> I see most bitmap is but</font><font color="#E5E5E5"> this is</font>

718
00:34:53,280 --> 00:34:58,079
how it<font color="#CCCCCC"> represents the entire malloc</font>

719
00:34:55,500 --> 00:35:00,869
range itself<font color="#E5E5E5"> okay so we have a region it</font>

720
00:34:58,079 --> 00:35:02,970
may<font color="#E5E5E5"> region bitmap and</font><font color="#CCCCCC"> every one is a</font>

721
00:35:00,869 --> 00:35:05,369
block<font color="#CCCCCC"> in use in every</font><font color="#E5E5E5"> 0 is a block</font>

722
00:35:02,970 --> 00:35:07,950
<font color="#E5E5E5">that's not in use</font><font color="#CCCCCC"> so if you look at your</font>

723
00:35:05,369 --> 00:35:10,170
<font color="#E5E5E5">free list you can see where the free</font>

724
00:35:07,950 --> 00:35:12,210
<font color="#E5E5E5">list objects</font><font color="#CCCCCC"> line</font><font color="#E5E5E5"> up why is this useful</font>

725
00:35:10,170 --> 00:35:12,660
<font color="#E5E5E5">when I'm having it overflow and</font><font color="#CCCCCC"> have an</font>

726
00:35:12,210 --> 00:35:13,770
exploit

727
00:35:12,660 --> 00:35:15,720
I need<font color="#E5E5E5"> these others to be next to each</font>

728
00:35:13,770 --> 00:35:18,420
<font color="#E5E5E5">other if this is my vulnerable buffer</font><font color="#CCCCCC"> I</font>

729
00:35:15,720 --> 00:35:20,098
need to know what what I have next<font color="#E5E5E5"> so</font>

730
00:35:18,420 --> 00:35:22,349
this region<font color="#E5E5E5"> bitmap isn't very important</font>

731
00:35:20,099 --> 00:35:26,670
to understand<font color="#E5E5E5"> so I can place</font><font color="#CCCCCC"> my objects</font>

732
00:35:22,349 --> 00:35:28,260
<font color="#E5E5E5">next to each other so Alex Todorov came</font>

733
00:35:26,670 --> 00:35:30,750
up with the idea of<font color="#CCCCCC"> heating heating Shui</font>

734
00:35:28,260 --> 00:35:32,609
<font color="#CCCCCC">and 2006</font><font color="#E5E5E5"> and the whole</font><font color="#CCCCCC"> idea behind that</font>

735
00:35:30,750 --> 00:35:33,540
<font color="#CCCCCC">did you flatten</font><font color="#E5E5E5"> the heap the whole idea</font>

736
00:35:32,609 --> 00:35:35,220
is<font color="#E5E5E5"> you're gonna you're gonna flatten the</font>

737
00:35:33,540 --> 00:35:36,599
entire heap and then every allocation

738
00:35:35,220 --> 00:35:37,649
you make after<font color="#CCCCCC"> you flattened it is gonna</font>

739
00:35:36,599 --> 00:35:39,599
<font color="#E5E5E5">be next to</font><font color="#CCCCCC"> show that's just that that's</font>

740
00:35:37,650 --> 00:35:41,099
<font color="#CCCCCC">just the way it works if I</font><font color="#E5E5E5"> flatten it</font>

741
00:35:39,599 --> 00:35:41,940
there's nowhere else<font color="#E5E5E5"> for her to go as</font>

742
00:35:41,099 --> 00:35:43,619
<font color="#CCCCCC">we've said</font><font color="#E5E5E5"> before where they're gonna</font>

743
00:35:41,940 --> 00:35:45,300
come from<font color="#E5E5E5"> it's gonna come from</font>

744
00:35:43,619 --> 00:35:46,800
<font color="#E5E5E5">megabytes for you to end so if I</font><font color="#CCCCCC"> flatten</font>

745
00:35:45,300 --> 00:35:48,210
<font color="#E5E5E5">this entire thing it's all in use and I</font>

746
00:35:46,800 --> 00:35:49,109
like a<font color="#CCCCCC"> 2 objects they're gonna be right</font>

747
00:35:48,210 --> 00:35:50,430
next to<font color="#E5E5E5"> each</font><font color="#CCCCCC"> other because they're</font><font color="#E5E5E5"> right</font>

748
00:35:49,109 --> 00:35:54,140
<font color="#E5E5E5">they both</font><font color="#CCCCCC"> came from</font><font color="#E5E5E5"> the same part in the</font>

749
00:35:50,430 --> 00:35:56,069
region so how do we fly in the bitmap

750
00:35:54,140 --> 00:35:58,770
<font color="#CCCCCC">this is just saying that there's 56</font>

751
00:35:56,069 --> 00:36:00,450
quantum<font color="#E5E5E5"> of free free slots and if you</font>

752
00:35:58,770 --> 00:36:01,050
have a large<font color="#E5E5E5"> number is up equals 36 as</font>

753
00:36:00,450 --> 00:36:03,810
well

754
00:36:01,050 --> 00:36:05,520
I said don't<font color="#E5E5E5"> do math</font><font color="#CCCCCC"> in public so</font><font color="#E5E5E5"> what</font>

755
00:36:03,810 --> 00:36:08,070
we need you<font color="#E5E5E5"> just makes 56 single corner</font>

756
00:36:05,520 --> 00:36:09,720
allocations<font color="#E5E5E5"> of</font><font color="#CCCCCC"> flattened bitmap</font><font color="#E5E5E5"> okay we</font>

757
00:36:08,070 --> 00:36:12,270
made 56 quantum allocations<font color="#E5E5E5"> it's still</font>

758
00:36:09,720 --> 00:36:16,080
length 901<font color="#CCCCCC"> I</font><font color="#E5E5E5"> go back a couple slides and</font>

759
00:36:12,270 --> 00:36:20,009
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> length 901</font><font color="#CCCCCC"> here I think 901 it's</font>

760
00:36:16,080 --> 00:36:21,630
also like 901<font color="#E5E5E5"> but now there is no those</font>

761
00:36:20,010 --> 00:36:23,280
are free slots anymore<font color="#CCCCCC"> so now in the</font>

762
00:36:21,630 --> 00:36:25,800
<font color="#E5E5E5">next allocation I make is coming from</font>

763
00:36:23,280 --> 00:36:29,250
the back<font color="#CCCCCC"> of this</font><font color="#E5E5E5"> and I make a 25 quantum</font>

764
00:36:25,800 --> 00:36:31,350
allocation<font color="#CCCCCC"> 24 quantum allocation</font><font color="#E5E5E5"> and now</font>

765
00:36:29,250 --> 00:36:32,670
you can see the length is 29 25<font color="#E5E5E5"> and this</font>

766
00:36:31,350 --> 00:36:34,680
whole thing<font color="#E5E5E5"> is bigger so if I made</font>

767
00:36:32,670 --> 00:36:37,110
another allocation right there<font color="#E5E5E5"> another</font>

768
00:36:34,680 --> 00:36:38,759
<font color="#E5E5E5">one right there</font><font color="#CCCCCC"> right there</font><font color="#E5E5E5"> so now I can</font>

769
00:36:37,110 --> 00:36:40,020
<font color="#E5E5E5">put on if I</font><font color="#CCCCCC"> can control objects and I</font>

770
00:36:38,760 --> 00:36:42,500
can<font color="#CCCCCC"> control</font><font color="#E5E5E5"> what I'm doing I have</font>

771
00:36:40,020 --> 00:36:44,460
overflows I can actually<font color="#CCCCCC"> get</font><font color="#E5E5E5"> this - I</font>

772
00:36:42,500 --> 00:36:47,400
actually<font color="#CCCCCC"> positioned things perfectly</font>

773
00:36:44,460 --> 00:36:49,710
with this double<font color="#CCCCCC"> freeze not possible</font>

774
00:36:47,400 --> 00:36:51,930
they there's a busy<font color="#E5E5E5"> flag that checks for</font>

775
00:36:49,710 --> 00:36:56,690
if there's been<font color="#E5E5E5"> a treat already or not</font>

776
00:36:51,930 --> 00:36:58,950
<font color="#E5E5E5">and they took for that immediately so</font>

777
00:36:56,690 --> 00:37:01,380
keep spraying<font color="#E5E5E5"> this is my personal</font>

778
00:36:58,950 --> 00:37:05,759
<font color="#CCCCCC">opinion this is</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> any but</font><font color="#E5E5E5"> he's praying</font>

779
00:37:01,380 --> 00:37:08,310
is kind of<font color="#CCCCCC"> dead on oh</font><font color="#E5E5E5"> s X it's the</font>

780
00:37:05,760 --> 00:37:10,800
64-bit address space it's just<font color="#CCCCCC"> too large</font>

781
00:37:08,310 --> 00:37:12,930
and there's a lot<font color="#E5E5E5"> of these spaces</font>

782
00:37:10,800 --> 00:37:14,970
<font color="#CCCCCC">they're dead</font><font color="#E5E5E5"> because of these magazine</font>

783
00:37:12,930 --> 00:37:16,350
structures and<font color="#E5E5E5"> things and we tried the</font>

784
00:37:14,970 --> 00:37:18,049
<font color="#E5E5E5">heap spray and it just since it was not</font>

785
00:37:16,350 --> 00:37:20,460
<font color="#CCCCCC">reliable</font>

786
00:37:18,050 --> 00:37:23,580
it seems it wasn't<font color="#CCCCCC"> reliable and it</font>

787
00:37:20,460 --> 00:37:28,830
wasn't gonna<font color="#E5E5E5"> work for us</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font>

788
00:37:23,580 --> 00:37:31,590
521 I got 20 minutes<font color="#E5E5E5"> left so I'm gonna</font>

789
00:37:28,830 --> 00:37:33,900
talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> this project</font><font color="#CCCCCC"> Mac keep great</font>

790
00:37:31,590 --> 00:37:36,300
project wonderful it<font color="#E5E5E5"> was fun but what</font>

791
00:37:33,900 --> 00:37:38,520
happened<font color="#E5E5E5"> during Mac heap is I use this</font>

792
00:37:36,300 --> 00:37:41,280
tool<font color="#E5E5E5"> called</font><font color="#CCCCCC"> LOD</font><font color="#E5E5E5"> be has anybody in here</font>

793
00:37:38,520 --> 00:37:42,900
ever use LD be if anybody think it's

794
00:37:41,280 --> 00:37:43,170
good<font color="#CCCCCC"> I don't think anybody thinks it's</font>

795
00:37:42,900 --> 00:37:45,060
good

796
00:37:43,170 --> 00:37:46,050
it's a terrible piece of software<font color="#E5E5E5"> I mean</font>

797
00:37:45,060 --> 00:37:47,759
it's great it's wonderful<font color="#E5E5E5"> but does</font>

798
00:37:46,050 --> 00:37:48,660
everything it does but it's<font color="#E5E5E5"> extremely</font>

799
00:37:47,760 --> 00:37:49,230
difficult to use it's<font color="#E5E5E5"> not user friendly</font>

800
00:37:48,660 --> 00:37:51,899
at all

801
00:37:49,230 --> 00:37:53,700
so<font color="#CCCCCC"> duro Co has a great LD beam it's</font>

802
00:37:51,900 --> 00:37:55,860
awesome it's cool it does it does some

803
00:37:53,700 --> 00:37:56,580
interesting<font color="#CCCCCC"> stuff but it doesn't do</font><font color="#E5E5E5"> what</font>

804
00:37:55,860 --> 00:37:58,320
I want it to do

805
00:37:56,580 --> 00:38:00,360
I came from window bug<font color="#E5E5E5"> I like me in the</font>

806
00:37:58,320 --> 00:38:01,710
bug<font color="#E5E5E5"> I want to be able to IPO</font><font color="#CCCCCC"> IRIX and</font>

807
00:38:00,360 --> 00:38:04,440
get some get some information back<font color="#E5E5E5"> I</font>

808
00:38:01,710 --> 00:38:06,840
want to be able<font color="#E5E5E5"> to do DW p OIRA</font><font color="#CCCCCC"> x plus</font>

809
00:38:04,440 --> 00:38:08,820
BC plus<font color="#E5E5E5"> this plus</font><font color="#CCCCCC"> that and have all</font>

810
00:38:06,840 --> 00:38:10,500
<font color="#CCCCCC">these commands together</font><font color="#E5E5E5"> and do</font><font color="#CCCCCC"> all stuff</font>

811
00:38:08,820 --> 00:38:12,120
LD be<font color="#E5E5E5"> you can only one command</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> time</font>

812
00:38:10,500 --> 00:38:13,560
that's it you can't you<font color="#E5E5E5"> can't have</font>

813
00:38:12,120 --> 00:38:14,350
<font color="#E5E5E5">script callbacks there's all these</font>

814
00:38:13,560 --> 00:38:17,080
<font color="#E5E5E5">massive</font><font color="#CCCCCC"> the</font>

815
00:38:14,350 --> 00:38:18,370
<font color="#E5E5E5">patience</font><font color="#CCCCCC"> LD be that we have or we could</font>

816
00:38:17,080 --> 00:38:19,600
<font color="#E5E5E5">never come</font><font color="#CCCCCC"> where two guys would come</font>

817
00:38:18,370 --> 00:38:20,980
<font color="#E5E5E5">from window window more of a windows</font>

818
00:38:19,600 --> 00:38:23,319
background trying<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> this we couldn't</font>

819
00:38:20,980 --> 00:38:26,380
overcome<font color="#CCCCCC"> it so what I</font><font color="#E5E5E5"> did what we did is</font>

820
00:38:23,320 --> 00:38:27,910
we<font color="#E5E5E5"> wrote a this is just showing you</font><font color="#CCCCCC"> this</font>

821
00:38:26,380 --> 00:38:29,290
<font color="#CCCCCC">is just</font><font color="#E5E5E5"> showing you how</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> make a</font>

822
00:38:27,910 --> 00:38:31,870
<font color="#CCCCCC">breakpoint like if I wanted</font><font color="#E5E5E5"> to make a</font>

823
00:38:29,290 --> 00:38:34,060
breakpoint<font color="#CCCCCC"> that prints out our</font><font color="#E5E5E5"> X like</font>

824
00:38:31,870 --> 00:38:35,230
that's crazy<font color="#CCCCCC"> as</font><font color="#E5E5E5"> it looks insane</font><font color="#CCCCCC"> if I</font>

825
00:38:34,060 --> 00:38:37,240
want to<font color="#E5E5E5"> make a breakpoint at mean I</font>

826
00:38:35,230 --> 00:38:38,140
can't say break<font color="#E5E5E5"> main like gdb says break</font>

827
00:38:37,240 --> 00:38:41,379
me and<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> how it work</font>

828
00:38:38,140 --> 00:38:43,839
how do<font color="#E5E5E5"> breakpoint set - a tilde whatever</font>

829
00:38:41,380 --> 00:38:45,490
<font color="#E5E5E5">that thing is ' thing avoid name like</font>

830
00:38:43,840 --> 00:38:46,750
<font color="#CCCCCC">see casting styles and like I don't want</font>

831
00:38:45,490 --> 00:38:49,660
<font color="#E5E5E5">to type see casting I'm doing a low D</font>

832
00:38:46,750 --> 00:38:52,000
<font color="#E5E5E5">beat stuff that's just that's crazy</font><font color="#CCCCCC"> so</font>

833
00:38:49,660 --> 00:38:54,370
it lacks functionality<font color="#E5E5E5"> it does the</font>

834
00:38:52,000 --> 00:38:56,620
Python functionality<font color="#E5E5E5"> it's terrible this</font>

835
00:38:54,370 --> 00:38:57,850
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> so many problems</font><font color="#CCCCCC"> you had so we</font>

836
00:38:56,620 --> 00:38:59,890
<font color="#E5E5E5">just</font><font color="#CCCCCC"> created a</font><font color="#E5E5E5"> generic way of adding</font>

837
00:38:57,850 --> 00:39:01,960
functions we added alias and breakpoint

838
00:38:59,890 --> 00:39:03,700
managers<font color="#E5E5E5"> entire full expression parser</font>

839
00:39:01,960 --> 00:39:05,320
we have<font color="#CCCCCC"> an entire ability to parse with</font>

840
00:39:03,700 --> 00:39:07,359
them<font color="#E5E5E5"> now we can do stuff</font><font color="#CCCCCC"> like this we</font>

841
00:39:05,320 --> 00:39:09,010
can<font color="#E5E5E5"> ask a local variable one with our ax</font>

842
00:39:07,360 --> 00:39:10,750
with me and tell<font color="#CCCCCC"> me what's what is that</font>

843
00:39:09,010 --> 00:39:12,640
address and<font color="#E5E5E5"> I could do DW on that I can</font>

844
00:39:10,750 --> 00:39:13,840
do whatever I want we took reported

845
00:39:12,640 --> 00:39:16,900
<font color="#E5E5E5">almost every window bug command we</font>

846
00:39:13,840 --> 00:39:20,220
wanted and we ported it to<font color="#CCCCCC"> l DB</font><font color="#E5E5E5"> what</font>

847
00:39:16,900 --> 00:39:22,210
happened<font color="#CCCCCC"> before that before</font><font color="#E5E5E5"> is I didn't</font>

848
00:39:20,220 --> 00:39:24,669
tell anybody about<font color="#E5E5E5"> it and so nobody's</font>

849
00:39:22,210 --> 00:39:26,020
seen<font color="#CCCCCC"> it</font><font color="#E5E5E5"> after</font><font color="#CCCCCC"> the last like</font><font color="#E5E5E5"> I put it</font>

850
00:39:24,670 --> 00:39:27,990
online but nobody looked at it so this

851
00:39:26,020 --> 00:39:30,580
time<font color="#E5E5E5"> I talked</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> you about it more so</font>

852
00:39:27,990 --> 00:39:33,370
<font color="#CCCCCC">I'm gonna take</font><font color="#E5E5E5"> a quick</font><font color="#CCCCCC"> break</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> we're</font>

853
00:39:30,580 --> 00:39:34,420
gonna do a demo<font color="#CCCCCC"> I'm gonna demo you we're</font>

854
00:39:33,370 --> 00:39:35,770
gonna predict where allocations are

855
00:39:34,420 --> 00:39:37,030
gonna come<font color="#CCCCCC"> from we're gonna predict</font><font color="#E5E5E5"> one</font>

856
00:39:35,770 --> 00:39:38,020
off the<font color="#E5E5E5"> cache</font><font color="#CCCCCC"> we're gonna predict one</font>

857
00:39:37,030 --> 00:39:39,340
off the free list then we're gonna put a

858
00:39:38,020 --> 00:39:40,530
critical<font color="#CCCCCC"> amount to region</font><font color="#E5E5E5"> and we can</font>

859
00:39:39,340 --> 00:39:43,060
watch the region grow up a little<font color="#E5E5E5"> bit</font>

860
00:39:40,530 --> 00:39:45,280
and then<font color="#E5E5E5"> imma show you</font><font color="#CCCCCC"> one of</font><font color="#E5E5E5"> the cool</font>

861
00:39:43,060 --> 00:39:46,720
stuff<font color="#CCCCCC"> we did with</font><font color="#E5E5E5"> LD be in it and I got</font>

862
00:39:45,280 --> 00:39:48,640
20 minutes<font color="#E5E5E5"> left and then from there I</font>

863
00:39:46,720 --> 00:39:51,700
got 15<font color="#E5E5E5"> slides on</font><font color="#CCCCCC"> equitation on how we</font>

864
00:39:48,640 --> 00:39:54,640
exploit<font color="#E5E5E5"> Safari with this bug and that's</font>

865
00:39:51,700 --> 00:39:56,970
<font color="#CCCCCC">I</font><font color="#E5E5E5"> think I'll have just the right amount</font>

866
00:39:54,640 --> 00:39:56,970
<font color="#CCCCCC">I'm</font>

867
00:40:05,330 --> 00:40:12,620
if you can't see your I'm doing

868
00:40:07,830 --> 00:40:17,490
something wrong just<font color="#E5E5E5"> shut up please</font>

869
00:40:12,620 --> 00:40:19,710
<font color="#E5E5E5">all right unable to find an executable</font>

870
00:40:17,490 --> 00:40:22,808
where am I

871
00:40:19,710 --> 00:40:22,809
[Music]

872
00:40:23,190 --> 00:40:26,420
you guys are you<font color="#E5E5E5"> guys interesting the</font>

873
00:40:24,840 --> 00:40:33,330
<font color="#CCCCCC">coder your GPA</font><font color="#E5E5E5"> can you</font><font color="#CCCCCC"> just believe me</font>

874
00:40:26,420 --> 00:40:35,580
I'll show you<font color="#CCCCCC"> the code I guess you guys</font>

875
00:40:33,330 --> 00:40:36,960
aren't very trustworthy huh<font color="#CCCCCC"> I know I got</font>

876
00:40:35,580 --> 00:40:39,240
a black eye<font color="#CCCCCC"> and stuff but</font><font color="#E5E5E5"> that's not</font>

877
00:40:36,960 --> 00:40:43,590
trustworthy<font color="#CCCCCC"> all right I guess you gotta</font>

878
00:40:39,240 --> 00:40:46,770
<font color="#CCCCCC">watch you BIM to everybody all right</font><font color="#E5E5E5"> all</font>

879
00:40:43,590 --> 00:40:48,150
this is gonna do is initialization<font color="#E5E5E5"> what</font>

880
00:40:46,770 --> 00:40:49,980
<font color="#E5E5E5">an installation is simply doing is this</font>

881
00:40:48,150 --> 00:40:51,960
calling<font color="#E5E5E5"> freedom a like a</font><font color="#CCCCCC"> bunch</font><font color="#E5E5E5"> you can't</font>

882
00:40:49,980 --> 00:40:53,850
you can't do<font color="#E5E5E5"> a</font><font color="#CCCCCC"> heap</font><font color="#E5E5E5"> of stuff without</font>

883
00:40:51,960 --> 00:40:55,080
having<font color="#E5E5E5"> some</font><font color="#CCCCCC"> initialization code think</font>

884
00:40:53,850 --> 00:40:56,730
about when you<font color="#CCCCCC"> wanted Safari starts up</font>

885
00:40:55,080 --> 00:40:58,049
for instance how much stuff does it do

886
00:40:56,730 --> 00:40:59,790
on the back<font color="#E5E5E5"> end is set up the heap and</font>

887
00:40:58,050 --> 00:41:01,230
set up<font color="#E5E5E5"> things so that's all this is this</font>

888
00:40:59,790 --> 00:41:02,340
is I<font color="#E5E5E5"> mean I know it's</font><font color="#CCCCCC"> kind of crazy</font><font color="#E5E5E5"> buy</font>

889
00:41:01,230 --> 00:41:03,810
something<font color="#CCCCCC"> special just calling malloc</font>

890
00:41:02,340 --> 00:41:05,280
and free a few times<font color="#CCCCCC"> to pull some</font>

891
00:41:03,810 --> 00:41:08,070
<font color="#CCCCCC">information out</font><font color="#E5E5E5"> of our region</font><font color="#CCCCCC"> it's that</font>

892
00:41:05,280 --> 00:41:09,060
way we have a full list to deal with and

893
00:41:08,070 --> 00:41:11,910
what we're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do here</font><font color="#CCCCCC"> is we're gonna</font>

894
00:41:09,060 --> 00:41:14,040
allocate we're gonna<font color="#CCCCCC"> allocate</font><font color="#E5E5E5"> 10 blocks</font>

895
00:41:11,910 --> 00:41:17,549
<font color="#E5E5E5">and then</font><font color="#CCCCCC"> we're gonna</font><font color="#E5E5E5"> free</font><font color="#CCCCCC"> recall</font><font color="#E5E5E5"> blocks</font>

896
00:41:14,040 --> 00:41:19,230
<font color="#E5E5E5">this isn't even the right code my code</font><font color="#CCCCCC"> I</font>

897
00:41:17,550 --> 00:41:26,610
mean that in that image stuff is still

898
00:41:19,230 --> 00:41:28,280
fine but<font color="#E5E5E5"> it's ridiculous all right so</font>

899
00:41:26,610 --> 00:41:30,900
we're<font color="#E5E5E5"> gonna do is we're going to</font>

900
00:41:28,280 --> 00:41:33,420
allocate<font color="#E5E5E5"> 10 blocks and we have free</font><font color="#CCCCCC"> 10</font>

901
00:41:30,900 --> 00:41:34,440
blocks and then we hit<font color="#E5E5E5"> a breakpoint the</font>

902
00:41:33,420 --> 00:41:35,700
reason we hit the breakpoint is I'm

903
00:41:34,440 --> 00:41:37,440
going<font color="#E5E5E5"> to show you what the cache looks</font>

904
00:41:35,700 --> 00:41:39,180
like at that<font color="#E5E5E5"> point and they notice we're</font>

905
00:41:37,440 --> 00:41:41,640
allocating a<font color="#CCCCCC"> 9 quantum allocation well</font>

906
00:41:39,180 --> 00:41:43,080
<font color="#E5E5E5">is 10 means I was gonna stop at 9 so the</font>

907
00:41:41,640 --> 00:41:44,400
last quantum allocation<font color="#E5E5E5"> it freed was 9</font>

908
00:41:43,080 --> 00:41:46,500
quantum that's gonna be in the cache

909
00:41:44,400 --> 00:41:47,880
<font color="#CCCCCC">that's gonna</font><font color="#E5E5E5"> come off</font><font color="#CCCCCC"> the cache from</font>

910
00:41:46,500 --> 00:41:50,040
there<font color="#E5E5E5"> we're gonna allocate another 9</font>

911
00:41:47,880 --> 00:41:51,000
<font color="#E5E5E5">content allocation off the free list</font><font color="#CCCCCC"> and</font>

912
00:41:50,040 --> 00:41:52,080
then from there I'm<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to clear the</font>

913
00:41:51,000 --> 00:41:54,990
free list I'm<font color="#E5E5E5"> gonna wipe the whole thing</font>

914
00:41:52,080 --> 00:41:56,759
and<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> allocate one off of</font><font color="#CCCCCC"> the well</font>

915
00:41:54,990 --> 00:41:59,870
like it wants the reason so let me get

916
00:41:56,760 --> 00:41:59,870
<font color="#CCCCCC">this back to</font><font color="#E5E5E5"> the wrong one</font>

917
00:42:01,900 --> 00:42:06,610
I slept<font color="#E5E5E5"> like one hour last night so I'm</font>

918
00:42:04,060 --> 00:42:08,020
sorry I was a little<font color="#CCCCCC"> I'm a little I'm a</font>

919
00:42:06,610 --> 00:42:09,880
<font color="#CCCCCC">little off</font><font color="#E5E5E5"> but that's</font><font color="#CCCCCC"> okay I</font><font color="#E5E5E5"> hope you</font>

920
00:42:08,020 --> 00:42:12,190
guys are enjoying the talk<font color="#CCCCCC"> alright so</font>

921
00:42:09,880 --> 00:42:13,690
let's do<font color="#CCCCCC"> Ron</font><font color="#E5E5E5"> get this whole thing set up</font>

922
00:42:12,190 --> 00:42:15,880
a little bit<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so write a breakpoint</font>

923
00:42:13,690 --> 00:42:19,360
<font color="#E5E5E5">and notice it</font><font color="#CCCCCC"> says simple stuff malloc</font>

924
00:42:15,880 --> 00:42:21,280
there and we're gonna remove<font color="#CCCCCC"> 0 X 90 0 X</font>

925
00:42:19,360 --> 00:42:26,260
90 is a<font color="#CCCCCC"> 9 quantum allocation that's just</font>

926
00:42:21,280 --> 00:42:29,620
16 times 9 so let's take a look<font color="#E5E5E5"> so we do</font>

927
00:42:26,260 --> 00:42:31,930
script exact file<font color="#E5E5E5"> the OL</font><font color="#CCCCCC"> Odom file and</font>

928
00:42:29,620 --> 00:42:32,950
my file is<font color="#E5E5E5"> called load PI it's just</font>

929
00:42:31,930 --> 00:42:36,419
<font color="#E5E5E5">going to set up with</font><font color="#CCCCCC"> the set us up with</font>

930
00:42:32,950 --> 00:42:38,890
<font color="#E5E5E5">a few basic structures so we unscripted</font>

931
00:42:36,420 --> 00:42:40,690
gonna have Z<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> breezy is our</font>

932
00:42:38,890 --> 00:42:42,160
overarching<font color="#E5E5E5"> golf umbrella that all your</font>

933
00:42:40,690 --> 00:42:43,660
<font color="#CCCCCC">friends are standing in there well ok so</font>

934
00:42:42,160 --> 00:42:46,270
one of<font color="#E5E5E5"> our friends is called the</font>

935
00:42:43,660 --> 00:42:49,120
magazine<font color="#CCCCCC"> malloc and</font><font color="#E5E5E5"> that's a inside the</font>

936
00:42:46,270 --> 00:42:51,100
magazine malloc<font color="#E5E5E5"> he has a mega the</font>

937
00:42:49,120 --> 00:42:52,690
<font color="#E5E5E5">magazine entries and I set that up</font><font color="#CCCCCC"> for</font>

938
00:42:51,100 --> 00:42:55,120
<font color="#CCCCCC">us because</font><font color="#E5E5E5"> it said we're all in the</font>

939
00:42:52,690 --> 00:42:56,800
first<font color="#E5E5E5"> magazine so that's T</font><font color="#CCCCCC"> C is our</font>

940
00:42:55,120 --> 00:42:59,140
<font color="#E5E5E5">first magazine</font><font color="#CCCCCC"> and you can see T has a</font>

941
00:42:56,800 --> 00:43:07,090
bitmap<font color="#CCCCCC"> and T</font><font color="#E5E5E5"> is a cache you see this guy</font>

942
00:42:59,140 --> 00:43:10,089
<font color="#E5E5E5">right here mag last</font><font color="#CCCCCC"> 3</font><font color="#E5E5E5"> 9 plus 144</font><font color="#CCCCCC"> this is</font>

943
00:43:07,090 --> 00:43:12,670
right here<font color="#CCCCCC"> mag glass free is the cache</font>

944
00:43:10,090 --> 00:43:14,350
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so let's take notice address one</font>

945
00:43:12,670 --> 00:43:15,610
zero zero one zero two zero zero

946
00:43:14,350 --> 00:43:17,350
you guys believe<font color="#CCCCCC"> me that's where</font><font color="#E5E5E5"> the</font>

947
00:43:15,610 --> 00:43:17,740
<font color="#E5E5E5">next allocations gonna come from</font><font color="#CCCCCC"> I hope</font>

948
00:43:17,350 --> 00:43:22,960
so

949
00:43:17,740 --> 00:43:24,549
so let's just do<font color="#E5E5E5"> this let's do H</font><font color="#CCCCCC"> okay so</font>

950
00:43:22,960 --> 00:43:26,880
you can see we're<font color="#E5E5E5"> gonna call malloc</font>

951
00:43:24,550 --> 00:43:29,740
<font color="#E5E5E5">right here of 90 I'm gonna continue on</font>

952
00:43:26,880 --> 00:43:31,480
and<font color="#CCCCCC"> notice a king</font><font color="#E5E5E5"> exact what we said was</font>

953
00:43:29,740 --> 00:43:36,580
gonna come<font color="#CCCCCC"> from that's pretty good</font>

954
00:43:31,480 --> 00:43:37,810
also check out this so forward

955
00:43:36,580 --> 00:43:39,190
disassembly<font color="#E5E5E5"> is great right everybody</font>

956
00:43:37,810 --> 00:43:40,090
likes forward disassembly but when you

957
00:43:39,190 --> 00:43:41,620
<font color="#E5E5E5">reverse engineer and you're trying to</font>

958
00:43:40,090 --> 00:43:42,850
<font color="#CCCCCC">phone every researcher you trying to</font>

959
00:43:41,620 --> 00:43:44,740
exploit something<font color="#E5E5E5"> you want to know where</font>

960
00:43:42,850 --> 00:43:45,910
you came from<font color="#CCCCCC"> not where you are you know</font>

961
00:43:44,740 --> 00:43:47,290
<font color="#E5E5E5">you don't necessarily care where you</font><font color="#CCCCCC"> are</font>

962
00:43:45,910 --> 00:43:48,759
going you<font color="#E5E5E5"> care where you came from</font>

963
00:43:47,290 --> 00:43:50,620
well how the<font color="#E5E5E5"> hell do</font><font color="#CCCCCC"> you do backwards</font>

964
00:43:48,760 --> 00:43:53,350
assembly in<font color="#CCCCCC"> ella debe you could do</font>

965
00:43:50,620 --> 00:43:56,830
something you do something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> this you</font>

966
00:43:53,350 --> 00:43:58,450
<font color="#CCCCCC">can do this ass</font><font color="#E5E5E5"> - ass</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> on our IP</font><font color="#CCCCCC"> mine's</font>

967
00:43:56,830 --> 00:44:00,130
<font color="#CCCCCC">8 and</font><font color="#E5E5E5"> that's gonna do something</font><font color="#CCCCCC"> like</font>

968
00:43:58,450 --> 00:44:02,230
that<font color="#E5E5E5"> but</font><font color="#CCCCCC"> that's not even looks weird</font>

969
00:44:00,130 --> 00:44:03,670
that's<font color="#E5E5E5"> a crazy why would</font><font color="#CCCCCC"> I do that</font><font color="#E5E5E5"> so we</font>

970
00:44:02,230 --> 00:44:05,290
<font color="#E5E5E5">brought a little crazy we were a little</font>

971
00:44:03,670 --> 00:44:07,210
thing and<font color="#E5E5E5"> there's called backward</font>

972
00:44:05,290 --> 00:44:08,410
<font color="#CCCCCC">disassemble and so you can just assemble</font>

973
00:44:07,210 --> 00:44:09,880
backwards and<font color="#E5E5E5"> they will want to</font>

974
00:44:08,410 --> 00:44:11,290
<font color="#E5E5E5">backwards assemble ten lines</font><font color="#CCCCCC"> I came back</font>

975
00:44:09,880 --> 00:44:13,120
<font color="#E5E5E5">with two simple ten lines or 120 you can</font>

976
00:44:11,290 --> 00:44:14,800
do whatever I want<font color="#E5E5E5"> it's much simpler</font>

977
00:44:13,120 --> 00:44:17,000
it's much<font color="#E5E5E5"> easier</font>

978
00:44:14,800 --> 00:44:18,620
because when you do<font color="#E5E5E5"> more our IP -</font><font color="#CCCCCC"> a</font>

979
00:44:17,000 --> 00:44:20,840
value<font color="#E5E5E5"> that offset might be wrong and</font>

980
00:44:18,620 --> 00:44:22,520
because<font color="#CCCCCC"> off</font><font color="#E5E5E5"> codes aren't</font><font color="#CCCCCC"> uh because our</font>

981
00:44:20,840 --> 00:44:23,630
cars aren't<font color="#E5E5E5"> aren't aligned</font><font color="#CCCCCC"> eight might</font>

982
00:44:22,520 --> 00:44:25,490
not be the right<font color="#E5E5E5"> number if I do I apply</font>

983
00:44:23,630 --> 00:44:27,560
to our<font color="#CCCCCC"> ap minus</font><font color="#E5E5E5"> nine</font><font color="#CCCCCC"> their code I'm</font>

984
00:44:25,490 --> 00:44:29,240
<font color="#CCCCCC">gonna gets different</font><font color="#E5E5E5"> like that's not</font>

985
00:44:27,560 --> 00:44:30,740
that's not valid code anymore<font color="#CCCCCC"> like what</font>

986
00:44:29,240 --> 00:44:33,169
is<font color="#CCCCCC"> what does</font><font color="#E5E5E5"> this move</font><font color="#CCCCCC"> ABS that's not</font>

987
00:44:30,740 --> 00:44:34,850
valid code but backward dissemble takes

988
00:44:33,170 --> 00:44:37,120
care of<font color="#E5E5E5"> all that for you and this is</font><font color="#CCCCCC"> one</font>

989
00:44:34,850 --> 00:44:39,049
small<font color="#CCCCCC"> thing that</font><font color="#E5E5E5"> we have inside</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> our</font>

990
00:44:37,120 --> 00:44:40,430
<font color="#E5E5E5">okay what's next we're calling another</font>

991
00:44:39,050 --> 00:44:43,460
<font color="#E5E5E5">ninety five allocation let's</font><font color="#CCCCCC"> loaded back</font>

992
00:44:40,430 --> 00:44:46,640
of our script so I really like my algae

993
00:44:43,460 --> 00:44:48,980
being<font color="#E5E5E5"> it's unjust okay and so then we</font>

994
00:44:46,640 --> 00:44:52,490
look at<font color="#E5E5E5"> T again and that's</font><font color="#CCCCCC"> do print T</font>

995
00:44:48,980 --> 00:45:02,300
<font color="#E5E5E5">dump and all that is it just dumps the</font>

996
00:44:52,490 --> 00:45:04,339
free list<font color="#CCCCCC"> though so we have three five</font>

997
00:45:02,300 --> 00:45:06,830
one zero<font color="#E5E5E5"> so let's continue on you'll</font><font color="#CCCCCC"> see</font>

998
00:45:04,340 --> 00:45:08,180
that here in a second<font color="#E5E5E5"> and as you see the</font>

999
00:45:06,830 --> 00:45:12,710
<font color="#E5E5E5">screen being Mallik looks free list</font>

1000
00:45:08,180 --> 00:45:14,060
three five one zero<font color="#E5E5E5"> okay that's you told</font>

1001
00:45:12,710 --> 00:45:16,610
me you could do that toilet does not

1002
00:45:14,060 --> 00:45:19,009
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> not super impressive that's fine</font>

1003
00:45:16,610 --> 00:45:20,630
but let's clear the free list<font color="#E5E5E5"> let's do</font>

1004
00:45:19,010 --> 00:45:22,040
something a little<font color="#CCCCCC"> more</font><font color="#E5E5E5"> difficult let's</font>

1005
00:45:20,630 --> 00:45:25,730
do a little<font color="#E5E5E5"> math let's have some</font>

1006
00:45:22,040 --> 00:45:28,250
challenging here<font color="#CCCCCC"> so now</font><font color="#E5E5E5"> I do my duty</font>

1007
00:45:25,730 --> 00:45:31,190
<font color="#E5E5E5">check out T's bitmap remember I told you</font>

1008
00:45:28,250 --> 00:45:33,440
it<font color="#E5E5E5"> only holds 64 or when something goes</font>

1009
00:45:31,190 --> 00:45:34,640
<font color="#CCCCCC">to</font><font color="#E5E5E5"> 64 slide gets stuck instead there so</font>

1010
00:45:33,440 --> 00:45:36,050
that's what<font color="#CCCCCC"> that</font><font color="#E5E5E5"> last free list</font>

1011
00:45:34,640 --> 00:45:38,029
allocation is this is a dead spot on

1012
00:45:36,050 --> 00:45:41,510
that<font color="#E5E5E5"> very end of the free list</font><font color="#CCCCCC"> but if I</font>

1013
00:45:38,030 --> 00:45:44,000
do print T<font color="#CCCCCC"> dump</font><font color="#E5E5E5"> you're gonna see there</font>

1014
00:45:41,510 --> 00:45:51,160
ain't nothing there so what you can do

1015
00:45:44,000 --> 00:45:51,160
is you can take this address<font color="#E5E5E5"> I think</font>

1016
00:45:53,620 --> 00:45:58,970
okay<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can take this address and you</font>

1017
00:45:57,320 --> 00:46:02,450
<font color="#E5E5E5">Matt you mask off</font><font color="#CCCCCC"> the mask off the bits</font>

1018
00:45:58,970 --> 00:46:03,560
you<font color="#E5E5E5"> mask off</font><font color="#CCCCCC"> the lower bits I have a</font>

1019
00:46:02,450 --> 00:46:05,390
function though though this I just<font color="#CCCCCC"> don't</font>

1020
00:46:03,560 --> 00:46:08,630
<font color="#CCCCCC">remember it is mask</font><font color="#E5E5E5"> off the lower bits</font>

1021
00:46:05,390 --> 00:46:14,299
and then you're gonna add the mag bytes

1022
00:46:08,630 --> 00:46:16,760
free<font color="#E5E5E5"> at end and then you do number Vice</font>

1023
00:46:14,300 --> 00:46:19,790
magazine<font color="#CCCCCC"> number by a</font><font color="#E5E5E5"> magazine - number</font>

1024
00:46:16,760 --> 00:46:21,050
<font color="#E5E5E5">bag - number bytes period end</font><font color="#CCCCCC"> and that's</font>

1025
00:46:19,790 --> 00:46:23,060
gonna give us<font color="#E5E5E5"> number you take the</font>

1026
00:46:21,050 --> 00:46:24,140
hexadecimal of that<font color="#E5E5E5"> number again I wrote</font>

1027
00:46:23,060 --> 00:46:27,020
a<font color="#CCCCCC"> function for this I</font><font color="#E5E5E5"> just don't</font><font color="#CCCCCC"> know</font>

1028
00:46:24,140 --> 00:46:27,319
what it was<font color="#E5E5E5"> you</font><font color="#CCCCCC"> wrote</font><font color="#E5E5E5"> you get that</font>

1029
00:46:27,020 --> 00:46:31,610
<font color="#E5E5E5">number</font>

1030
00:46:27,320 --> 00:46:34,120
and that's wrong Oh<font color="#CCCCCC"> cuz I did the why</font>

1031
00:46:31,610 --> 00:46:36,290
don't you guys tell me<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> being silly</font><font color="#CCCCCC"> I</font>

1032
00:46:34,120 --> 00:46:41,440
just put the same number twice<font color="#E5E5E5"> come on</font>

1033
00:46:36,290 --> 00:46:43,580
guys<font color="#CCCCCC"> I told you I haven't</font><font color="#E5E5E5"> slept</font><font color="#CCCCCC"> all</font>

1034
00:46:41,440 --> 00:46:46,520
<font color="#CCCCCC">right so we take</font><font color="#E5E5E5"> this and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> take this</font>

1035
00:46:43,580 --> 00:46:48,520
<font color="#CCCCCC">number and</font><font color="#E5E5E5"> now a 3 B a</font><font color="#CCCCCC"> zero so what I</font>

1036
00:46:46,520 --> 00:46:50,810
<font color="#CCCCCC">did was I</font><font color="#E5E5E5"> took the bytes free at the end</font>

1037
00:46:48,520 --> 00:46:52,820
versus the<font color="#E5E5E5"> whole all the bytes</font><font color="#CCCCCC"> so I'd</font>

1038
00:46:50,810 --> 00:46:54,529
<font color="#E5E5E5">say I have a hundred bytes and there's</font>

1039
00:46:52,820 --> 00:46:56,240
80 bytes free at the end<font color="#CCCCCC"> well that means</font>

1040
00:46:54,530 --> 00:46:58,550
I have I have<font color="#E5E5E5"> to move forward 20 bytes</font>

1041
00:46:56,240 --> 00:47:00,290
and a Barbie<font color="#E5E5E5"> that's all I did just a</font>

1042
00:46:58,550 --> 00:47:02,120
simple<font color="#E5E5E5"> basic math equation you mask off</font>

1043
00:47:00,290 --> 00:47:03,740
<font color="#CCCCCC">the bits as</font><font color="#E5E5E5"> where comes from</font><font color="#CCCCCC"> three be a</font>

1044
00:47:02,120 --> 00:47:06,230
zero<font color="#E5E5E5"> there's nothing on the free list</font>

1045
00:47:03,740 --> 00:47:07,430
there's nothing in there's nothing<font color="#CCCCCC"> that</font>

1046
00:47:06,230 --> 00:47:08,690
I that<font color="#CCCCCC"> we can predict</font><font color="#E5E5E5"> you come from</font>

1047
00:47:07,430 --> 00:47:13,640
<font color="#E5E5E5">that's coming</font><font color="#CCCCCC"> directly from the region</font>

1048
00:47:08,690 --> 00:47:16,250
<font color="#E5E5E5">and yeah that's coming directly from the</font>

1049
00:47:13,640 --> 00:47:18,890
region<font color="#E5E5E5"> and let's continue on real quick</font>

1050
00:47:16,250 --> 00:47:21,320
<font color="#E5E5E5">and we know this region pointer</font><font color="#CCCCCC"> 3 be a</font>

1051
00:47:18,890 --> 00:47:25,040
<font color="#E5E5E5">zero</font><font color="#CCCCCC"> see I up</font><font color="#E5E5E5"> the math and I</font>

1052
00:47:21,320 --> 00:47:27,320
still<font color="#E5E5E5"> is able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get right present all</font>

1053
00:47:25,040 --> 00:47:29,090
right<font color="#CCCCCC"> so that's</font><font color="#E5E5E5"> there's any questions</font>

1054
00:47:27,320 --> 00:47:30,500
about<font color="#CCCCCC"> that do you</font><font color="#E5E5E5"> guys want I mean so</font>

1055
00:47:29,090 --> 00:47:31,700
that<font color="#E5E5E5"> we can we can I can show you the</font>

1056
00:47:30,500 --> 00:47:33,470
<font color="#CCCCCC">bitmap and I</font><font color="#E5E5E5"> can show you how that works</font>

1057
00:47:31,700 --> 00:47:38,689
I'll tell you why I<font color="#E5E5E5"> don't want to do</font>

1058
00:47:33,470 --> 00:47:46,879
<font color="#E5E5E5">that while I do it how about that so the</font>

1059
00:47:38,690 --> 00:47:51,050
<font color="#E5E5E5">problem with this is prom with this is</font>

1060
00:47:46,880 --> 00:47:52,490
it loads<font color="#E5E5E5"> 65,000</font><font color="#CCCCCC"> python objects in 65,000</font>

1061
00:47:51,050 --> 00:47:54,440
<font color="#E5E5E5">python objects takes a long time to load</font>

1062
00:47:52,490 --> 00:47:56,390
<font color="#E5E5E5">so when</font><font color="#CCCCCC"> I wrote</font><font color="#E5E5E5"> all this code I wrote it</font>

1063
00:47:54,440 --> 00:47:57,920
on my iMac<font color="#CCCCCC"> that has a super processor</font>

1064
00:47:56,390 --> 00:47:59,029
and it's super awesome<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> I moved</font>

1065
00:47:57,920 --> 00:48:00,800
to my<font color="#CCCCCC"> laptop</font><font color="#E5E5E5"> and I'm like wait</font><font color="#CCCCCC"> I</font>

1066
00:47:59,030 --> 00:48:02,810
probably shouldn't<font color="#CCCCCC"> at</font><font color="#E5E5E5"> all 65,000 objects</font>

1067
00:48:00,800 --> 00:48:04,820
there's like 40 objects in use and<font color="#CCCCCC"> I'm</font>

1068
00:48:02,810 --> 00:48:06,470
loading 65,000<font color="#E5E5E5"> so that's what</font><font color="#CCCCCC"> makes</font>

1069
00:48:04,820 --> 00:48:08,240
<font color="#E5E5E5">sense</font><font color="#CCCCCC"> I tried to fix</font><font color="#E5E5E5"> this morning but I</font>

1070
00:48:06,470 --> 00:48:09,620
said<font color="#CCCCCC"> it'd asleep so</font><font color="#E5E5E5"> it was hard to fix</font>

1071
00:48:08,240 --> 00:48:11,060
<font color="#E5E5E5">but this just takes just a minute to</font>

1072
00:48:09,620 --> 00:48:14,259
<font color="#E5E5E5">load up but</font><font color="#CCCCCC"> I'll just</font><font color="#E5E5E5"> give you guys a</font>

1073
00:48:11,060 --> 00:48:16,970
<font color="#CCCCCC">peak</font><font color="#E5E5E5"> what a bitmap it looks like</font><font color="#CCCCCC"> and</font>

1074
00:48:14,260 --> 00:48:19,580
another cool<font color="#CCCCCC"> little feature I think</font><font color="#E5E5E5"> the</font>

1075
00:48:16,970 --> 00:48:21,830
coolest<font color="#E5E5E5"> feature the coolest feature I</font>

1076
00:48:19,580 --> 00:48:23,240
think<font color="#E5E5E5"> is you can give me</font><font color="#CCCCCC"> that address</font>

1077
00:48:21,830 --> 00:48:27,140
and<font color="#E5E5E5"> I'll tell you exactly</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> bitmap</font>

1078
00:48:23,240 --> 00:48:29,149
<font color="#CCCCCC">artists so you are</font><font color="#E5E5E5"> that app and</font><font color="#CCCCCC"> it tells</font>

1079
00:48:27,140 --> 00:48:31,490
you that's a block 954<font color="#CCCCCC"> so if I look at</font>

1080
00:48:29,150 --> 00:48:36,080
<font color="#E5E5E5">map other</font><font color="#CCCCCC"> my map looks like</font><font color="#E5E5E5"> I look at</font>

1081
00:48:31,490 --> 00:48:38,600
that map 954 and that's my that's my

1082
00:48:36,080 --> 00:48:41,190
that's my apply for navigation<font color="#CCCCCC"> for 10</font>

1083
00:48:38,600 --> 00:48:43,470
<font color="#CCCCCC">quondam allocation</font>

1084
00:48:41,190 --> 00:48:45,150
right there and so by that<font color="#E5E5E5"> point if I</font>

1085
00:48:43,470 --> 00:48:47,399
have a free<font color="#CCCCCC"> decide of my objects I can</font>

1086
00:48:45,150 --> 00:48:48,420
query exactly where they are<font color="#CCCCCC"> in this so</font>

1087
00:48:47,400 --> 00:48:50,490
<font color="#E5E5E5">I can</font><font color="#CCCCCC"> see what I'm what am I going</font><font color="#E5E5E5"> to</font>

1088
00:48:48,420 --> 00:48:52,530
overflow next<font color="#E5E5E5"> what am I gonna hit next</font>

1089
00:48:50,490 --> 00:48:54,720
so for my coalescing thing here<font color="#E5E5E5"> I need</font>

1090
00:48:52,530 --> 00:48:56,849
to position<font color="#CCCCCC"> my block</font><font color="#E5E5E5"> directly behind the</font>

1091
00:48:54,720 --> 00:48:58,680
free block but and I could<font color="#E5E5E5"> then by</font>

1092
00:48:56,849 --> 00:49:00,329
looking<font color="#CCCCCC"> at the bitmap I can see what</font>

1093
00:48:58,680 --> 00:49:03,060
other free blocks<font color="#E5E5E5"> I can write it back</font>

1094
00:49:00,329 --> 00:49:05,819
into so on this bitmap becomes very

1095
00:49:03,060 --> 00:49:06,960
useful<font color="#CCCCCC"> we're gonna</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> it one</font><font color="#E5E5E5"> more time</font>

1096
00:49:05,819 --> 00:49:09,390
<font color="#CCCCCC">cuz</font><font color="#E5E5E5"> that's</font><font color="#CCCCCC"> why I show you</font><font color="#E5E5E5"> what a bitmap</font>

1097
00:49:06,960 --> 00:49:13,290
looks like when it's full<font color="#E5E5E5"> I'm not full</font>

1098
00:49:09,390 --> 00:49:14,848
<font color="#CCCCCC">but that one</font><font color="#E5E5E5"> was fun once you what it</font>

1099
00:49:13,290 --> 00:49:19,230
looks like when it has a few items<font color="#E5E5E5"> in</font>

1100
00:49:14,849 --> 00:49:29,430
the free list<font color="#E5E5E5"> so he</font><font color="#CCCCCC"> was afraid</font><font color="#E5E5E5"> alike and</font>

1101
00:49:19,230 --> 00:49:33,060
then<font color="#E5E5E5"> it's a bit touch string is</font><font color="#CCCCCC"> just too</font>

1102
00:49:29,430 --> 00:49:35,069
stupid<font color="#CCCCCC"> I don't know bitter strange</font><font color="#E5E5E5"> this</font>

1103
00:49:33,060 --> 00:49:37,700
<font color="#CCCCCC">is stupid thing I wrote that takes a</font>

1104
00:49:35,069 --> 00:49:40,859
bitmap it makes it a nice string format

1105
00:49:37,700 --> 00:49:42,868
<font color="#E5E5E5">so like that's for instance say I have I</font>

1106
00:49:40,859 --> 00:49:44,190
<font color="#E5E5E5">want overflows 23 quantum</font><font color="#CCCCCC"> allocations</font>

1107
00:49:42,869 --> 00:49:47,700
like what we want to see you might<font color="#CCCCCC"> say</font>

1108
00:49:44,190 --> 00:49:50,280
where is the allocation<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we want</font>

1109
00:49:47,700 --> 00:49:52,160
<font color="#CCCCCC">to do where the allocation is we'll</font><font color="#E5E5E5"> look</font>

1110
00:49:50,280 --> 00:49:54,210
at it<font color="#E5E5E5"> okay I'll take another second</font>

1111
00:49:52,160 --> 00:49:56,328
<font color="#E5E5E5">alright or</font><font color="#CCCCCC"> twelve minutes I</font><font color="#E5E5E5"> think</font><font color="#CCCCCC"> we're</font>

1112
00:49:54,210 --> 00:49:56,329
good

1113
00:50:03,480 --> 00:50:07,839
come on<font color="#E5E5E5"> all</font><font color="#CCCCCC"> right cool</font>

1114
00:50:05,529 --> 00:50:10,809
so I<font color="#E5E5E5"> lost</font><font color="#CCCCCC"> at 8:49</font><font color="#E5E5E5"> let's take a look our</font>

1115
00:50:07,839 --> 00:50:13,509
map<font color="#E5E5E5"> and you'll notice that so</font><font color="#CCCCCC"> there were</font>

1116
00:50:10,809 --> 00:50:14,559
<font color="#CCCCCC">23 23</font><font color="#E5E5E5"> block allocation there and you'll</font>

1117
00:50:13,509 --> 00:50:16,089
notice that<font color="#E5E5E5"> all these allocations</font><font color="#CCCCCC"> are</font>

1118
00:50:14,559 --> 00:50:21,970
here you can see them<font color="#E5E5E5"> all the zeros it's</font>

1119
00:50:16,089 --> 00:50:25,509
very easy to<font color="#E5E5E5"> see but if I do map 954 849</font>

1120
00:50:21,970 --> 00:50:28,118
sorry 849<font color="#CCCCCC"> okay</font>

1121
00:50:25,509 --> 00:50:29,920
<font color="#E5E5E5">MIT block</font><font color="#CCCCCC"> 849 you'll notice there's that</font>

1122
00:50:28,119 --> 00:50:53,190
free block there so let's hypothetically

1123
00:50:29,920 --> 00:50:56,950
hypothetically speaking so this is gonna

1124
00:50:53,190 --> 00:50:58,749
if I or flow this will<font color="#E5E5E5"> block</font><font color="#CCCCCC"> to here I</font>

1125
00:50:56,950 --> 00:51:01,720
overflow the whole thing<font color="#CCCCCC"> I overwrite the</font>

1126
00:50:58,749 --> 00:51:04,180
backwards<font color="#CCCCCC"> M</font><font color="#E5E5E5"> sighs well what happens if I</font>

1127
00:51:01,720 --> 00:51:04,779
<font color="#E5E5E5">put the backwards</font><font color="#CCCCCC"> m sighs here</font><font color="#E5E5E5"> I pointed</font>

1128
00:51:04,180 --> 00:51:06,819
back here

1129
00:51:04,779 --> 00:51:08,799
well when they got when the coalescing

1130
00:51:06,819 --> 00:51:11,529
algorithm happens<font color="#E5E5E5"> what's gonna happen is</font>

1131
00:51:08,799 --> 00:51:13,569
<font color="#E5E5E5">it's gonna think all these plates are</font>

1132
00:51:11,529 --> 00:51:15,400
now free<font color="#E5E5E5"> so if I allocate another</font>

1133
00:51:13,569 --> 00:51:18,038
allocation it's gonna get allocated

1134
00:51:15,400 --> 00:51:19,660
<font color="#CCCCCC">right in here and so what you can</font>

1135
00:51:18,039 --> 00:51:21,430
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> do not only can you allocate</font>

1136
00:51:19,660 --> 00:51:22,930
things on<font color="#E5E5E5"> top</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> each other</font><font color="#CCCCCC"> well you can</font>

1137
00:51:21,430 --> 00:51:24,308
<font color="#E5E5E5">actually do is you can allocate things</font>

1138
00:51:22,930 --> 00:51:26,379
that are way<font color="#E5E5E5"> too large for small</font><font color="#CCCCCC"> regions</font>

1139
00:51:24,309 --> 00:51:28,630
so I've actually been<font color="#E5E5E5"> able to get 120</font>

1140
00:51:26,380 --> 00:51:30,220
130 140 quantum allocations coming out

1141
00:51:28,630 --> 00:51:32,499
of tiny regions<font color="#CCCCCC"> even though that maximum</font>

1142
00:51:30,220 --> 00:51:33,549
tiny region is 512<font color="#E5E5E5"> so I you can actually</font>

1143
00:51:32,499 --> 00:51:35,049
<font color="#E5E5E5">trick the whole time you region</font>

1144
00:51:33,549 --> 00:51:36,730
allocation scheme to think it has way

1145
00:51:35,049 --> 00:51:37,960
more<font color="#E5E5E5"> space and</font><font color="#CCCCCC"> actually does and you</font><font color="#E5E5E5"> can</font>

1146
00:51:36,730 --> 00:51:43,809
really muck around with<font color="#CCCCCC"> it</font>

1147
00:51:37,960 --> 00:51:46,119
with<font color="#E5E5E5"> that little bit of coalescing I</font>

1148
00:51:43,809 --> 00:51:48,130
think that's it<font color="#E5E5E5"> for my demo and the rest</font>

1149
00:51:46,119 --> 00:51:54,749
<font color="#E5E5E5">of it is gonna be talking</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> problems</font>

1150
00:51:48,130 --> 00:51:54,749
we had well<font color="#CCCCCC"> explained</font><font color="#E5E5E5"> sorry cool</font>

1151
00:52:03,930 --> 00:52:09,759
<font color="#CCCCCC">I'm just a little</font><font color="#E5E5E5"> hard of hearing</font>

1152
00:52:05,980 --> 00:52:12,339
oh I'll<font color="#CCCCCC"> check some issues fixed</font><font color="#E5E5E5"> so the</font>

1153
00:52:09,760 --> 00:52:14,920
checks machine is fixed<font color="#E5E5E5"> exactly so what</font>

1154
00:52:12,339 --> 00:52:16,299
<font color="#E5E5E5">we did</font><font color="#CCCCCC"> was we</font><font color="#E5E5E5"> did</font><font color="#CCCCCC"> analysis we yes how</font>

1155
00:52:14,920 --> 00:52:18,579
can<font color="#CCCCCC"> you get past this checksum problem</font>

1156
00:52:16,300 --> 00:52:19,720
and I mentioned<font color="#CCCCCC"> just a touch what I did</font>

1157
00:52:18,579 --> 00:52:21,760
was I ran millions and millions<font color="#CCCCCC"> and</font>

1158
00:52:19,720 --> 00:52:23,348
<font color="#CCCCCC">millions of</font><font color="#E5E5E5"> these iterations</font><font color="#CCCCCC"> and I took</font>

1159
00:52:21,760 --> 00:52:25,869
<font color="#E5E5E5">statistics on what the checksums were</font>

1160
00:52:23,349 --> 00:52:27,730
and thus<font color="#E5E5E5"> it's the</font><font color="#CCCCCC"> checksums are not</font>

1161
00:52:25,869 --> 00:52:29,530
random<font color="#E5E5E5"> they are somewhat deterministic</font>

1162
00:52:27,730 --> 00:52:31,000
<font color="#E5E5E5">yeah occasionally</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> get an outlier</font><font color="#CCCCCC"> but</font>

1163
00:52:29,530 --> 00:52:32,319
for the most part<font color="#CCCCCC"> I've run this thing</font>

1164
00:52:31,000 --> 00:52:34,000
millions millions<font color="#E5E5E5"> of</font><font color="#CCCCCC"> times</font><font color="#E5E5E5"> it's usually</font>

1165
00:52:32,319 --> 00:52:36,430
<font color="#CCCCCC">1 3</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> 7 those are the</font><font color="#E5E5E5"> three numbers</font><font color="#CCCCCC"> it</font>

1166
00:52:34,000 --> 00:52:38,349
usually is<font color="#E5E5E5"> that's 30% chance I'm not an</font>

1167
00:52:36,430 --> 00:52:39,790
attacker<font color="#CCCCCC"> I'm a vulnerable researcher my</font>

1168
00:52:38,349 --> 00:52:41,380
job is not to get<font color="#E5E5E5"> a hundred percent</font>

1169
00:52:39,790 --> 00:52:43,569
<font color="#E5E5E5">reliable exploit my job to prove</font>

1170
00:52:41,380 --> 00:52:45,010
something exploitable<font color="#CCCCCC"> and I get a patch</font>

1171
00:52:43,569 --> 00:52:46,540
to move forward<font color="#E5E5E5"> get us a little bit of a</font>

1172
00:52:45,010 --> 00:52:48,460
Palissy show that we can<font color="#E5E5E5"> do this show</font>

1173
00:52:46,540 --> 00:52:49,779
our skills but it would<font color="#CCCCCC"> take it would</font>

1174
00:52:48,460 --> 00:52:51,579
<font color="#CCCCCC">probably take me another month or two to</font>

1175
00:52:49,780 --> 00:52:52,930
<font color="#E5E5E5">get a full hundred percent</font><font color="#CCCCCC"> I can pass</font>

1176
00:52:51,579 --> 00:52:54,160
<font color="#E5E5E5">this checksum every time we'd have to</font>

1177
00:52:52,930 --> 00:52:57,129
come<font color="#CCCCCC"> up</font><font color="#E5E5E5"> with a new novel technique and</font>

1178
00:52:54,160 --> 00:52:59,859
it's<font color="#E5E5E5"> not necessarily worth it for my</font>

1179
00:52:57,130 --> 00:53:00,790
<font color="#E5E5E5">position and</font><font color="#CCCCCC"> my current they have a</font>

1180
00:52:59,859 --> 00:53:02,560
current<font color="#E5E5E5"> job like if I was a</font>

1181
00:53:00,790 --> 00:53:05,770
weapons-grade exploit developer<font color="#E5E5E5"> I for</font>

1182
00:53:02,560 --> 00:53:10,680
sure<font color="#E5E5E5"> would want to be better at</font><font color="#CCCCCC"> that</font>

1183
00:53:05,770 --> 00:53:10,680
checksum problem I lost my<font color="#E5E5E5"> mouse</font>

1184
00:53:26,240 --> 00:53:35,269
<font color="#E5E5E5">all right</font><font color="#CCCCCC"> eight minutes cool</font><font color="#E5E5E5"> oh man</font>

1185
00:53:31,559 --> 00:53:37,920
<font color="#CCCCCC">one second</font><font color="#E5E5E5"> sorry it's really forgot</font>

1186
00:53:35,269 --> 00:53:41,669
all right what I want to show you was

1187
00:53:37,920 --> 00:53:43,650
this cool stock okay<font color="#CCCCCC"> so let's take an</font><font color="#E5E5E5"> H</font>

1188
00:53:41,670 --> 00:53:45,450
<font color="#CCCCCC">so there's no other relative unit in the</font>

1189
00:53:43,650 --> 00:53:49,160
<font color="#E5E5E5">world that does this they start draw a</font>

1190
00:53:45,450 --> 00:53:49,160
little<font color="#CCCCCC"> beam it's cool</font><font color="#E5E5E5"> but it doesn't use</font>

1191
00:53:49,309 --> 00:53:52,710
this amazing hex dump like<font color="#CCCCCC"> that</font>

1192
00:53:51,420 --> 00:53:54,089
there's no<font color="#E5E5E5"> color code output I don't</font>

1193
00:53:52,710 --> 00:53:56,039
like color I'm more of a white<font color="#E5E5E5"> kind of</font>

1194
00:53:54,089 --> 00:53:57,420
guy<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> a full color</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> all you</font>

1195
00:53:56,039 --> 00:54:00,170
have to do is say color on and it would

1196
00:53:57,420 --> 00:54:02,670
<font color="#E5E5E5">I've heard</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> white</font>

1197
00:54:00,170 --> 00:54:04,109
<font color="#CCCCCC">always</font><font color="#E5E5E5"> a definite pretty standard</font><font color="#CCCCCC"> the</font>

1198
00:54:02,670 --> 00:54:07,589
<font color="#E5E5E5">stack except took forever</font>

1199
00:54:04,109 --> 00:54:09,109
<font color="#CCCCCC">this showed you already</font><font color="#E5E5E5"> took forever</font>

1200
00:54:07,589 --> 00:54:12,119
<font color="#E5E5E5">let's just say one look at the stack</font>

1201
00:54:09,109 --> 00:54:13,828
<font color="#CCCCCC">let's look at words on stack</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> go</font>

1202
00:54:12,119 --> 00:54:17,130
these nice words normally what you do is

1203
00:54:13,829 --> 00:54:18,569
you do something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> this and it looks</font>

1204
00:54:17,130 --> 00:54:20,039
<font color="#CCCCCC">like</font><font color="#E5E5E5"> it's like kind of</font>

1205
00:54:18,569 --> 00:54:21,089
<font color="#CCCCCC">weird-looking it doesn't quite fit</font><font color="#E5E5E5"> and</font>

1206
00:54:20,039 --> 00:54:23,760
you say<font color="#E5E5E5"> okay what</font><font color="#CCCCCC"> if I don't</font><font color="#E5E5E5"> want words</font>

1207
00:54:21,089 --> 00:54:25,589
I want double words<font color="#E5E5E5"> great awesome</font><font color="#CCCCCC"> well</font>

1208
00:54:23,760 --> 00:54:28,410
what if I don't want what do I want<font color="#CCCCCC"> to</font>

1209
00:54:25,589 --> 00:54:29,220
<font color="#E5E5E5">look at the pointer at RSP plus 16 so</font>

1210
00:54:28,410 --> 00:54:33,210
then you<font color="#E5E5E5"> can do something like this you</font>

1211
00:54:29,220 --> 00:54:34,980
<font color="#CCCCCC">could do</font><font color="#E5E5E5"> Pui</font><font color="#CCCCCC"> I know this doesn't this</font>

1212
00:54:33,210 --> 00:54:37,740
<font color="#CCCCCC">doesn't look that impressive</font><font color="#E5E5E5"> but this is</font>

1213
00:54:34,980 --> 00:54:39,960
like ridiculously awesome compared to

1214
00:54:37,740 --> 00:54:43,319
like what<font color="#CCCCCC"> LDV does myself so I</font><font color="#E5E5E5"> know QD I</font>

1215
00:54:39,960 --> 00:54:46,019
can dump words of the pointer at<font color="#E5E5E5"> RSP</font>

1216
00:54:43,319 --> 00:54:49,319
plus 16 which is<font color="#E5E5E5"> gonna</font><font color="#CCCCCC"> let you looking</font>

1217
00:54:46,019 --> 00:54:50,848
<font color="#E5E5E5">forward doing all that good stuff</font>

1218
00:54:49,319 --> 00:54:52,920
<font color="#E5E5E5">that</font><font color="#CCCCCC"> is stuff that's</font><font color="#E5E5E5"> really hard to do</font>

1219
00:54:50,849 --> 00:54:55,799
<font color="#CCCCCC">in ldb there's no way to script that</font>

1220
00:54:52,920 --> 00:54:57,329
<font color="#CCCCCC">it's almost unscripted ball without</font>

1221
00:54:55,799 --> 00:54:59,250
stuff like this<font color="#CCCCCC"> I talked about Malik</font>

1222
00:54:57,329 --> 00:55:01,259
history before<font color="#E5E5E5"> I don't think I have</font>

1223
00:54:59,250 --> 00:55:02,609
<font color="#E5E5E5">stack logging on but you can just type</font>

1224
00:55:01,259 --> 00:55:06,029
history<font color="#E5E5E5"> from the from the command like</font>

1225
00:55:02,609 --> 00:55:08,430
this and it'll it'll run it'll run that

1226
00:55:06,029 --> 00:55:10,829
<font color="#E5E5E5">Malik history command for you</font><font color="#CCCCCC"> you can</font>

1227
00:55:08,430 --> 00:55:12,390
run proc<font color="#E5E5E5"> Maps</font><font color="#CCCCCC"> I don't let any you guys</font>

1228
00:55:10,829 --> 00:55:14,490
are<font color="#E5E5E5"> Linux people there's maps that tell</font>

1229
00:55:12,390 --> 00:55:15,900
<font color="#E5E5E5">you the</font><font color="#CCCCCC"> whole the whole memory layout</font>

1230
00:55:14,490 --> 00:55:16,740
and all<font color="#E5E5E5"> this X is</font><font color="#CCCCCC"> something very</font><font color="#E5E5E5"> similar</font>

1231
00:55:15,900 --> 00:55:18,960
<font color="#E5E5E5">to</font><font color="#CCCCCC"> that</font>

1232
00:55:16,740 --> 00:55:20,758
so you but you can't clear it melody<font color="#CCCCCC"> B</font>

1233
00:55:18,960 --> 00:55:22,319
so I can't you there's no possible way

1234
00:55:20,759 --> 00:55:23,700
<font color="#E5E5E5">to find page permissions on</font><font color="#CCCCCC"> the DB so</font>

1235
00:55:22,319 --> 00:55:24,808
when I<font color="#CCCCCC"> do go to do my x point I'm trying</font>

1236
00:55:23,700 --> 00:55:26,009
<font color="#CCCCCC">to figure</font><font color="#E5E5E5"> out what the patient is</font>

1237
00:55:24,809 --> 00:55:27,630
there's something<font color="#CCCCCC"> that'll be has no</font>

1238
00:55:26,009 --> 00:55:29,759
functionality to do that so there's a

1239
00:55:27,630 --> 00:55:32,400
<font color="#E5E5E5">small things like that that really made</font>

1240
00:55:29,759 --> 00:55:33,869
it them hard<font color="#CCCCCC"> alright five</font><font color="#E5E5E5"> minutes left</font>

1241
00:55:32,400 --> 00:55:44,430
<font color="#E5E5E5">no</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> burn through this real</font><font color="#CCCCCC"> quick</font>

1242
00:55:33,869 --> 00:55:46,829
and we'll call<font color="#E5E5E5"> it</font><font color="#CCCCCC"> a day cool</font><font color="#E5E5E5"> all right</font>

1243
00:55:44,430 --> 00:55:49,049
<font color="#CCCCCC">so the problem with Safari it has five</font>

1244
00:55:46,829 --> 00:55:50,579
<font color="#CCCCCC">Mallik zones</font><font color="#E5E5E5"> what the what are you</font>

1245
00:55:49,049 --> 00:55:51,119
doing man like five<font color="#CCCCCC"> mattek-sands you</font>

1246
00:55:50,579 --> 00:55:52,559
kidding me

1247
00:55:51,119 --> 00:55:54,749
well I<font color="#E5E5E5"> have a heap over floor of our EP</font>

1248
00:55:52,559 --> 00:55:56,190
control I can hit this<font color="#E5E5E5"> to Safari</font><font color="#CCCCCC"> I want</font>

1249
00:55:54,749 --> 00:55:57,390
I'm like I'm<font color="#E5E5E5"> the champion I'm the best</font>

1250
00:55:56,190 --> 00:55:59,009
<font color="#CCCCCC">person in the world I got</font><font color="#E5E5E5"> the best</font>

1251
00:55:57,390 --> 00:56:01,828
exploit ever<font color="#E5E5E5"> I get to this thing and</font>

1252
00:55:59,009 --> 00:56:04,049
<font color="#E5E5E5">it's crazy</font><font color="#CCCCCC"> so what we have is we have</font>

1253
00:56:01,829 --> 00:56:05,130
<font color="#CCCCCC">default my</font><font color="#E5E5E5"> luck</font><font color="#CCCCCC"> well guess what WebKit</font>

1254
00:56:04,049 --> 00:56:07,288
doesn't use<font color="#CCCCCC"> the fall not</font><font color="#E5E5E5"> for really</font>

1255
00:56:05,130 --> 00:56:08,759
anything they have WebKit<font color="#CCCCCC"> mark they have</font>

1256
00:56:07,289 --> 00:56:10,319
WTF<font color="#CCCCCC"> Malik why wouldn't they why would</font>

1257
00:56:08,759 --> 00:56:12,509
they use my Malik<font color="#E5E5E5"> when they can use</font>

1258
00:56:10,319 --> 00:56:13,890
their<font color="#CCCCCC"> own</font><font color="#E5E5E5"> this is typically what it</font>

1259
00:56:12,509 --> 00:56:16,049
looks like you can<font color="#E5E5E5"> see they use WebKit</font>

1260
00:56:13,890 --> 00:56:17,160
<font color="#CCCCCC">malloc</font><font color="#E5E5E5"> and default</font><font color="#CCCCCC"> marks so I just</font><font color="#E5E5E5"> told</font>

1261
00:56:16,049 --> 00:56:20,460
you that don't use WebKit doesn't<font color="#CCCCCC"> heed</font>

1262
00:56:17,160 --> 00:56:22,558
to fall not for anything so why is the

1263
00:56:20,460 --> 00:56:23,670
pollak so large<font color="#E5E5E5"> well it's that core</font>

1264
00:56:22,559 --> 00:56:24,479
foundation stuff we talked<font color="#E5E5E5"> about the</font>

1265
00:56:23,670 --> 00:56:26,789
beginning<font color="#CCCCCC"> I know if anybody remembers</font>

1266
00:56:24,479 --> 00:56:30,089
that<font color="#E5E5E5"> but core foundation is the way that</font>

1267
00:56:26,789 --> 00:56:32,460
the WebKit<font color="#CCCCCC"> is able to interact with OS</font><font color="#E5E5E5"> X</font>

1268
00:56:30,089 --> 00:56:34,170
and operating system itself<font color="#E5E5E5"> so between</font>

1269
00:56:32,460 --> 00:56:35,609
that interaction<font color="#E5E5E5"> were able</font><font color="#CCCCCC"> to get things</font>

1270
00:56:34,170 --> 00:56:37,739
<font color="#E5E5E5">in our malloc zone</font><font color="#CCCCCC"> we're able</font><font color="#E5E5E5"> to</font>

1271
00:56:35,609 --> 00:56:39,529
coalesce<font color="#CCCCCC"> our Malik's together</font><font color="#E5E5E5"> where I</font>

1272
00:56:37,739 --> 00:56:42,839
would<font color="#E5E5E5"> call as our heap all through this</font>

1273
00:56:39,529 --> 00:56:45,269
<font color="#CCCCCC">core</font><font color="#E5E5E5"> foundation idea so have an image</font>

1274
00:56:42,839 --> 00:56:47,069
base<font color="#E5E5E5"> here overflow core foundation</font>

1275
00:56:45,269 --> 00:56:49,379
<font color="#CCCCCC">working as</font><font color="#E5E5E5"> I oh that's fall malloc zone</font>

1276
00:56:47,069 --> 00:56:50,969
<font color="#E5E5E5">blob so what do</font><font color="#CCCCCC"> we need I mean</font>

1277
00:56:49,380 --> 00:56:52,890
information<font color="#E5E5E5"> we need an object</font><font color="#CCCCCC"> override</font>

1278
00:56:50,969 --> 00:56:54,599
the obvious override was really easy

1279
00:56:52,890 --> 00:56:56,519
<font color="#E5E5E5">there's I mean core foundation allocates</font>

1280
00:56:54,599 --> 00:56:59,969
so many objects<font color="#E5E5E5"> that was really simple</font>

1281
00:56:56,519 --> 00:57:01,950
the difficult part was information<font color="#CCCCCC"> leak</font>

1282
00:56:59,969 --> 00:57:03,660
but pretty much<font color="#E5E5E5"> every allocation you</font>

1283
00:57:01,950 --> 00:57:07,348
control from<font color="#E5E5E5"> JavaScript falls in WebKit</font>

1284
00:57:03,660 --> 00:57:09,390
malloc<font color="#E5E5E5"> but every call to new falls in</font>

1285
00:57:07,349 --> 00:57:12,930
default<font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> so what do</font><font color="#CCCCCC"> we do we</font><font color="#E5E5E5"> went</font>

1286
00:57:09,390 --> 00:57:15,420
through and we found<font color="#E5E5E5"> we traced every</font>

1287
00:57:12,930 --> 00:57:18,960
single called a new inside of every uh

1288
00:57:15,420 --> 00:57:20,369
every shared library that WebKit uses

1289
00:57:18,960 --> 00:57:22,289
<font color="#E5E5E5">charge upon every colony we burst every</font>

1290
00:57:20,369 --> 00:57:23,579
<font color="#E5E5E5">call we search the entire memory space</font>

1291
00:57:22,289 --> 00:57:25,410
<font color="#CCCCCC">for any pointers that</font><font color="#E5E5E5"> might fall into</font>

1292
00:57:23,579 --> 00:57:27,869
<font color="#E5E5E5">some of these things to try to find any</font>

1293
00:57:25,410 --> 00:57:29,149
object we could possibly<font color="#E5E5E5"> use</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> coalesce</font>

1294
00:57:27,869 --> 00:57:31,440
our<font color="#CCCCCC"> ep</font>

1295
00:57:29,150 --> 00:57:33,359
so we<font color="#E5E5E5"> found a couple heat massaging</font>

1296
00:57:31,440 --> 00:57:35,190
primitives<font color="#CCCCCC"> the audio context object it</font>

1297
00:57:33,359 --> 00:57:37,259
doesn't<font color="#CCCCCC"> offer</font><font color="#E5E5E5"> arbitrary it does not</font>

1298
00:57:35,190 --> 00:57:38,700
offer arbitrary allocation<font color="#E5E5E5"> but you</font>

1299
00:57:37,259 --> 00:57:40,650
cannot do allocation size of three four

1300
00:57:38,700 --> 00:57:41,999
or<font color="#E5E5E5"> five quantum just by calling audio</font>

1301
00:57:40,650 --> 00:57:43,440
context with a couple<font color="#E5E5E5"> different</font>

1302
00:57:41,999 --> 00:57:44,910
parameters<font color="#E5E5E5"> so that was pretty easy to</font>

1303
00:57:43,440 --> 00:57:46,829
<font color="#E5E5E5">start that's</font><font color="#CCCCCC"> that's how we were able to</font>

1304
00:57:44,910 --> 00:57:47,730
<font color="#E5E5E5">massage</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> heap into a state</font><font color="#CCCCCC"> that works</font>

1305
00:57:46,829 --> 00:57:50,950
pretty well

1306
00:57:47,730 --> 00:57:53,110
and the other another super hard problem

1307
00:57:50,950 --> 00:57:54,669
here is we had a<font color="#E5E5E5"> write a server</font><font color="#CCCCCC"> if you</font>

1308
00:57:53,110 --> 00:57:56,770
<font color="#E5E5E5">send</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can write back</font><font color="#CCCCCC"> to it and</font>

1309
00:57:54,670 --> 00:58:00,130
<font color="#E5E5E5">it makes</font><font color="#CCCCCC"> new TIF files that's not easy</font>

1310
00:57:56,770 --> 00:58:01,810
to do<font color="#E5E5E5"> it's not easy like you</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> out you</font>

1311
00:58:00,130 --> 00:58:03,070
get<font color="#CCCCCC"> your information and now you call</font>

1312
00:58:01,810 --> 00:58:05,680
back to your server he makes new TIF

1313
00:58:03,070 --> 00:58:07,720
files to adjust this<font color="#E5E5E5"> like</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> just was</font>

1314
00:58:05,680 --> 00:58:09,910
really really hard to get<font color="#E5E5E5"> that all set</font>

1315
00:58:07,720 --> 00:58:11,950
up properly<font color="#CCCCCC"> all right and here is the</font>

1316
00:58:09,910 --> 00:58:12,310
here's the<font color="#E5E5E5"> hand</font><font color="#CCCCCC"> wavy magic I told you</font>

1317
00:58:11,950 --> 00:58:15,129
about

1318
00:58:12,310 --> 00:58:15,700
we found one string<font color="#CCCCCC"> I don't even know</font><font color="#E5E5E5"> if</font>

1319
00:58:15,130 --> 00:58:17,050
<font color="#E5E5E5">it's there anymore</font>

1320
00:58:15,700 --> 00:58:18,129
<font color="#CCCCCC">because Apple saw this and I don't think</font>

1321
00:58:17,050 --> 00:58:19,900
<font color="#E5E5E5">they probably I don't think they left it</font>

1322
00:58:18,130 --> 00:58:21,250
<font color="#CCCCCC">there but there's one string and</font><font color="#E5E5E5"> it's</font>

1323
00:58:19,900 --> 00:58:22,600
allocated in the<font color="#CCCCCC"> default</font><font color="#E5E5E5"> song</font><font color="#CCCCCC"> it's</font>

1324
00:58:21,250 --> 00:58:25,510
called<font color="#E5E5E5"> date that prototype of</font><font color="#CCCCCC"> to locale</font>

1325
00:58:22,600 --> 00:58:27,069
<font color="#E5E5E5">you have like a</font><font color="#CCCCCC"> three-second window to</font>

1326
00:58:25,510 --> 00:58:29,680
hit<font color="#E5E5E5"> this string so this string is</font>

1327
00:58:27,070 --> 00:58:30,940
allocated on<font color="#CCCCCC"> a default zone and then</font>

1328
00:58:29,680 --> 00:58:33,490
immediately following<font color="#CCCCCC"> that it gets</font>

1329
00:58:30,940 --> 00:58:35,500
copied<font color="#E5E5E5"> it's a webcam a lock</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> to</font>

1330
00:58:33,490 --> 00:58:37,390
hit<font color="#E5E5E5"> it before it goes to webcam a lock</font>

1331
00:58:35,500 --> 00:58:38,980
<font color="#E5E5E5">we have core issues with corrugation</font>

1332
00:58:37,390 --> 00:58:40,839
issues we have a lot of<font color="#CCCCCC"> issues</font><font color="#E5E5E5"> here that</font>

1333
00:58:38,980 --> 00:58:42,700
<font color="#E5E5E5">have to be overcome</font><font color="#CCCCCC"> to make</font><font color="#E5E5E5"> this perfect</font>

1334
00:58:40,840 --> 00:58:44,920
<font color="#CCCCCC">you have like a split second</font><font color="#E5E5E5"> to</font>

1335
00:58:42,700 --> 00:58:47,350
overwrite that<font color="#E5E5E5"> no bite on</font><font color="#CCCCCC"> that thing on</font>

1336
00:58:44,920 --> 00:58:48,640
<font color="#E5E5E5">that</font><font color="#CCCCCC"> date to prototype Luke at locale</font>

1337
00:58:47,350 --> 00:58:50,500
string so<font color="#CCCCCC"> that way when it gets copied</font>

1338
00:58:48,640 --> 00:58:52,870
<font color="#CCCCCC">over it copies too much data</font><font color="#E5E5E5"> and you get</font>

1339
00:58:50,500 --> 00:58:54,130
<font color="#E5E5E5">your information</font><font color="#CCCCCC"> leak out</font><font color="#E5E5E5"> again I'm not</font>

1340
00:58:52,870 --> 00:58:56,890
<font color="#CCCCCC">a weapon</font><font color="#E5E5E5"> created I'm not a weapons-grade</font>

1341
00:58:54,130 --> 00:58:59,470
exploit writer and it's not the most

1342
00:58:56,890 --> 00:59:03,460
reliable technique in the<font color="#E5E5E5"> world but it</font>

1343
00:58:59,470 --> 00:59:05,709
works and it's pretty impressive it<font color="#CCCCCC"> was</font>

1344
00:59:03,460 --> 00:59:10,000
a pretty good<font color="#E5E5E5"> find and it was pretty</font>

1345
00:59:05,710 --> 00:59:12,760
<font color="#E5E5E5">hard to do so just as a general recap we</font>

1346
00:59:10,000 --> 00:59:14,800
<font color="#E5E5E5">have our three quantum allocation we</font>

1347
00:59:12,760 --> 00:59:17,020
empty your quantum we do our backwards

1348
00:59:14,800 --> 00:59:18,910
<font color="#CCCCCC">colas I've talked</font><font color="#E5E5E5"> so much about we get</font>

1349
00:59:17,020 --> 00:59:20,110
<font color="#E5E5E5">to chunk freeze you remove</font><font color="#CCCCCC"> that null</font>

1350
00:59:18,910 --> 00:59:21,940
<font color="#CCCCCC">terminator</font><font color="#E5E5E5"> and then when you in</font>

1351
00:59:20,110 --> 00:59:23,350
JavaScript<font color="#E5E5E5"> read back that date</font><font color="#CCCCCC"> he gives</font>

1352
00:59:21,940 --> 00:59:25,060
you back more information<font color="#E5E5E5"> you know have</font>

1353
00:59:23,350 --> 00:59:27,400
an information leak that<font color="#E5E5E5"> you can use I</font>

1354
00:59:25,060 --> 00:59:28,570
told you before<font color="#E5E5E5"> our IP control no</font>

1355
00:59:27,400 --> 00:59:30,610
problem<font color="#E5E5E5"> there's a lot of objects</font>

1356
00:59:28,570 --> 00:59:33,100
<font color="#CCCCCC">overwrite and that's what we got code</font>

1357
00:59:30,610 --> 00:59:34,810
execution and<font color="#E5E5E5"> that's how</font><font color="#CCCCCC"> we're able</font><font color="#E5E5E5"> to</font>

1358
00:59:33,100 --> 00:59:37,240
<font color="#CCCCCC">tack Safari I would show it to you now</font>

1359
00:59:34,810 --> 00:59:39,490
but I<font color="#CCCCCC"> say it's</font><font color="#E5E5E5"> like 20 it's like</font><font color="#CCCCCC"> 1 in</font><font color="#E5E5E5"> 20</font>

1360
00:59:37,240 --> 00:59:41,379
so like<font color="#CCCCCC"> 5 percent reliable I guess</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

1361
00:59:39,490 --> 00:59:45,729
<font color="#CCCCCC">coordinate</font><font color="#E5E5E5"> and nobody wants</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> see me</font>

1362
00:59:41,380 --> 00:59:48,040
<font color="#CCCCCC">though</font><font color="#E5E5E5"> 20 exploit that's of our so</font><font color="#CCCCCC"> well</font>

1363
00:59:45,730 --> 00:59:50,350
<font color="#CCCCCC">beam you on</font><font color="#E5E5E5"> anyway that's it for me but</font>

1364
00:59:48,040 --> 00:59:52,029
if you<font color="#CCCCCC"> guys</font><font color="#E5E5E5"> could all if you guys are</font>

1365
00:59:50,350 --> 00:59:53,950
any interested at<font color="#E5E5E5"> all everything</font><font color="#CCCCCC"> this</font>

1366
00:59:52,030 --> 00:59:55,600
whole<font color="#E5E5E5"> slide deck all my tools on Mac</font>

1367
00:59:53,950 --> 00:59:56,350
heap I just released<font color="#E5E5E5"> that LD be in it</font>

1368
00:59:55,600 --> 00:59:59,830
today

1369
00:59:56,350 --> 01:00:03,190
on github as well<font color="#CCCCCC"> so all</font><font color="#E5E5E5"> that's up there</font>

1370
00:59:59,830 --> 01:00:05,400
I am one blank<font color="#E5E5E5"> well one and that's the</font>

1371
01:00:03,190 --> 01:00:05,400
<font color="#E5E5E5">top</font>

1372
01:00:13,790 --> 01:00:21,210
got any questions<font color="#CCCCCC"> or anything this is</font>

1373
01:00:19,050 --> 01:00:23,010
<font color="#CCCCCC">about three months</font><font color="#E5E5E5"> with the work yeah</font>

1374
01:00:21,210 --> 01:00:25,290
give or<font color="#E5E5E5"> take</font><font color="#CCCCCC"> I just want to show you</font>

1375
01:00:23,010 --> 01:00:27,720
<font color="#CCCCCC">guys one more thing I know I know so</font>

1376
01:00:25,290 --> 01:00:30,420
<font color="#CCCCCC">it's like three</font><font color="#E5E5E5"> more things come on</font><font color="#CCCCCC"> all</font>

1377
01:00:27,720 --> 01:00:32,009
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so let</font><font color="#CCCCCC"> me let's say this</font><font color="#E5E5E5"> I wanted</font>

1378
01:00:30,420 --> 01:00:34,080
I want to reverse<font color="#E5E5E5"> engineer</font><font color="#CCCCCC"> Malick</font><font color="#E5E5E5"> right</font>

1379
01:00:32,010 --> 01:00:35,640
<font color="#E5E5E5">okay so how do I find where Malik is</font>

1380
01:00:34,080 --> 01:00:37,830
okay well let me tell you<font color="#CCCCCC"> you do image</font>

1381
01:00:35,640 --> 01:00:39,690
<font color="#E5E5E5">list</font><font color="#CCCCCC"> just an image list and it'll tell</font>

1382
01:00:37,830 --> 01:00:43,380
you<font color="#E5E5E5"> Ramallah</font><font color="#CCCCCC"> is right</font><font color="#E5E5E5"> so your image list</font>

1383
01:00:39,690 --> 01:00:44,790
okay what's that's cool okay well<font color="#CCCCCC"> what I</font>

1384
01:00:43,380 --> 01:00:45,900
<font color="#CCCCCC">don't know</font><font color="#E5E5E5"> let me just do command F</font>

1385
01:00:44,790 --> 01:00:47,040
Ramallah<font color="#CCCCCC"> alright I can just come in</font>

1386
01:00:45,900 --> 01:00:48,900
after my terminal that's gonna<font color="#E5E5E5"> find</font>

1387
01:00:47,040 --> 01:00:50,160
<font color="#E5E5E5">Malik or isn't it look cool they found</font>

1388
01:00:48,900 --> 01:00:51,810
<font color="#E5E5E5">Malik for me</font><font color="#CCCCCC"> that's wonderful</font>

1389
01:00:50,160 --> 01:00:53,370
but if you have more<font color="#E5E5E5"> and you have more</font>

1390
01:00:51,810 --> 01:00:54,990
Malik's<font color="#E5E5E5"> and you have more stuff they</font>

1391
01:00:53,370 --> 01:00:56,130
can't find Malik<font color="#E5E5E5"> for you anymore</font><font color="#CCCCCC"> so we</font>

1392
01:00:54,990 --> 01:00:58,680
carried a little<font color="#CCCCCC"> thing called this</font>

1393
01:00:56,130 --> 01:01:01,350
<font color="#E5E5E5">module so</font><font color="#CCCCCC"> now I can su LM</font><font color="#E5E5E5"> Malik</font>

1394
01:00:58,680 --> 01:01:02,940
it gives me right away perfect<font color="#CCCCCC"> okay</font>

1395
01:01:01,350 --> 01:01:04,560
<font color="#E5E5E5">let's say that's awesome I know the</font>

1396
01:01:02,940 --> 01:01:05,840
module is now I want to<font color="#E5E5E5"> know every</font>

1397
01:01:04,560 --> 01:01:07,529
function<font color="#E5E5E5"> that has the word Malik in it</font>

1398
01:01:05,840 --> 01:01:08,610
how am I<font color="#CCCCCC"> going to find</font><font color="#E5E5E5"> out every</font>

1399
01:01:07,530 --> 01:01:10,410
function has<font color="#E5E5E5"> a word Malik and I don't</font>

1400
01:01:08,610 --> 01:01:11,940
<font color="#E5E5E5">know what Malik I need</font><font color="#CCCCCC"> I have</font><font color="#E5E5E5"> no idea</font>

1401
01:01:10,410 --> 01:01:16,529
well now you<font color="#E5E5E5"> can do something like this</font>

1402
01:01:11,940 --> 01:01:18,060
LS Malik and it's gonna<font color="#E5E5E5"> come back</font><font color="#CCCCCC"> these</font>

1403
01:01:16,530 --> 01:01:19,830
are all the places<font color="#E5E5E5"> and all the offsets</font>

1404
01:01:18,060 --> 01:01:22,590
where Malik<font color="#E5E5E5"> is used in anywhere</font><font color="#CCCCCC"> this</font>

1405
01:01:19,830 --> 01:01:25,380
<font color="#E5E5E5">program again things that LD be simply</font>

1406
01:01:22,590 --> 01:01:28,080
can't do one last<font color="#CCCCCC"> thing I'll get off the</font>

1407
01:01:25,380 --> 01:01:30,510
<font color="#E5E5E5">stage I promise</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is this is main</font>

1408
01:01:28,080 --> 01:01:32,430
<font color="#E5E5E5">right what if I want to know what every</font>

1409
01:01:30,510 --> 01:01:34,860
call in<font color="#CCCCCC"> mean because I know a lot of you</font>

1410
01:01:32,430 --> 01:01:36,330
verse engineers our call<font color="#CCCCCC"> reversing here</font>

1411
01:01:34,860 --> 01:01:37,530
that's<font color="#E5E5E5"> that's how you taught you first</font>

1412
01:01:36,330 --> 01:01:39,210
call to call to call to<font color="#CCCCCC"> try to</font>

1413
01:01:37,530 --> 01:01:41,310
understand the flow<font color="#CCCCCC"> of programs</font><font color="#E5E5E5"> okay</font>

1414
01:01:39,210 --> 01:01:42,870
what if I want<font color="#E5E5E5"> to see all the calls okay</font>

1415
01:01:41,310 --> 01:01:44,880
well I can do this<font color="#E5E5E5"> I can again a command</font>

1416
01:01:42,870 --> 01:01:46,259
F call<font color="#E5E5E5"> right I can I can kind of go</font>

1417
01:01:44,880 --> 01:01:47,730
<font color="#CCCCCC">through but now you saw it</font><font color="#E5E5E5"> wasn't super</font>

1418
01:01:46,260 --> 01:01:50,160
far up now I'm I<font color="#E5E5E5"> don't know where I am</font>

1419
01:01:47,730 --> 01:01:52,410
anymore<font color="#CCCCCC"> like this is</font><font color="#E5E5E5"> terrible okay well</font>

1420
01:01:50,160 --> 01:01:54,839
so my<font color="#E5E5E5"> next option</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> I can copy all this</font>

1421
01:01:52,410 --> 01:01:56,279
I can copy all<font color="#E5E5E5"> this data and put</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> in</font>

1422
01:01:54,840 --> 01:01:59,460
sublime<font color="#E5E5E5"> text or something look for call</font>

1423
01:01:56,280 --> 01:02:02,430
that way or we<font color="#CCCCCC"> can do something called</font>

1424
01:01:59,460 --> 01:02:05,310
<font color="#CCCCCC">theis search and you do -</font><font color="#E5E5E5"> and main and</font>

1425
01:02:02,430 --> 01:02:06,660
<font color="#CCCCCC">used to call</font><font color="#E5E5E5"> I'm gonna go because of all</font>

1426
01:02:05,310 --> 01:02:08,400
the calls<font color="#CCCCCC"> format like all the calls are</font>

1427
01:02:06,660 --> 01:02:09,690
free<font color="#CCCCCC"> any call that that</font><font color="#E5E5E5"> program makes it</font>

1428
01:02:08,400 --> 01:02:10,800
<font color="#E5E5E5">shows you where it is how it's done you</font>

1429
01:02:09,690 --> 01:02:12,510
<font color="#E5E5E5">can</font><font color="#CCCCCC"> do it for anything you do that</font>

1430
01:02:10,800 --> 01:02:14,100
instead<font color="#CCCCCC"> of call you wants you jumped on</font>

1431
01:02:12,510 --> 01:02:15,510
equals it shows you all<font color="#CCCCCC"> the jumped on</font>

1432
01:02:14,100 --> 01:02:17,460
equals<font color="#E5E5E5"> instead of jumping to equal you</font>

1433
01:02:15,510 --> 01:02:20,760
want ads it shows you all<font color="#CCCCCC"> the ads like</font>

1434
01:02:17,460 --> 01:02:22,470
so you<font color="#E5E5E5"> can do it for any any</font><font color="#CCCCCC"> you can</font>

1435
01:02:20,760 --> 01:02:24,570
search through<font color="#CCCCCC"> any program for</font><font color="#E5E5E5"> that and</font>

1436
01:02:22,470 --> 01:02:25,770
that works<font color="#E5E5E5"> extremely well another being</font>

1437
01:02:24,570 --> 01:02:27,720
able<font color="#E5E5E5"> to do any</font><font color="#CCCCCC"> of that</font>

1438
01:02:25,770 --> 01:02:28,980
that's my la buena pitch<font color="#CCCCCC"> I hope you</font>

1439
01:02:27,720 --> 01:02:30,259
<font color="#E5E5E5">check it</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> thank you so</font><font color="#CCCCCC"> much for</font>

1440
01:02:28,980 --> 01:02:32,610
listening<font color="#E5E5E5"> I appreciate it</font>

1441
01:02:30,260 --> 01:02:34,200
I'll be<font color="#CCCCCC"> around</font><font color="#E5E5E5"> for a while if anybody</font>

1442
01:02:32,610 --> 01:02:35,400
<font color="#CCCCCC">any crepitus questions or any I</font><font color="#E5E5E5"> could</font>

1443
01:02:34,200 --> 01:02:36,600
stop or if you wanna talk<font color="#E5E5E5"> about more or</font>

1444
01:02:35,400 --> 01:02:39,150
if you want<font color="#E5E5E5"> to see me throw</font><font color="#CCCCCC"> x-play 20</font>

1445
01:02:36,600 --> 01:02:42,410
times<font color="#E5E5E5"> feel</font><font color="#CCCCCC"> free to come</font><font color="#E5E5E5"> off</font><font color="#CCCCCC"> do that</font><font color="#E5E5E5"> too</font>

1446
01:02:39,150 --> 01:02:42,410
thank you so<font color="#E5E5E5"> much</font>

