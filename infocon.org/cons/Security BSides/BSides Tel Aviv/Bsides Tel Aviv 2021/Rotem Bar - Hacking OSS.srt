1
00:00:00,000 --> 00:00:03,280
things now our next speaker is actually

2
00:00:03,280 --> 00:00:05,040
going to take us down a different

3
00:00:05,040 --> 00:00:05,839
direction

4
00:00:05,839 --> 00:00:08,080
he's going to take us into the world of

5
00:00:08,080 --> 00:00:08,960
open

6
00:00:08,960 --> 00:00:11,200
source software and the security

7
00:00:11,200 --> 00:00:12,240
vulnerabilities

8
00:00:12,240 --> 00:00:14,320
and problems that can be found in open

9
00:00:14,320 --> 00:00:15,440
source software

10
00:00:15,440 --> 00:00:17,520
so as they get ready i'm going to tell

11
00:00:17,520 --> 00:00:19,840
you a little bit about our next speaker

12
00:00:19,840 --> 00:00:22,960
his name is rotem and rotem is a very

13
00:00:22,960 --> 00:00:23,920
cool cat

14
00:00:23,920 --> 00:00:25,920
yeah join me right here autumn let's

15
00:00:25,920 --> 00:00:27,599
give him a hand

16
00:00:27,599 --> 00:00:31,840
we've got

17
00:00:39,520 --> 00:00:41,120
is a very cool cat with more than a

18
00:00:41,120 --> 00:00:43,520
decade of experience in cyber security

19
00:00:43,520 --> 00:00:45,360
and all kinds of things from penetration

20
00:00:45,360 --> 00:00:47,600
testing to vulnerability analysis

21
00:00:47,600 --> 00:00:50,000
and today is going to take us through

22
00:00:50,000 --> 00:00:51,760
this rabbit hole of open

23
00:00:51,760 --> 00:00:54,239
source software and one of the fun

24
00:00:54,239 --> 00:00:55,760
things that rotten has done is actually

25
00:00:55,760 --> 00:00:57,760
take a year to travel around the world

26
00:00:57,760 --> 00:01:01,120
while doing bug bounty programs which i

27
00:01:01,120 --> 00:01:03,920
absolutely love the stage is yours wrote

28
00:01:03,920 --> 00:01:06,960
them let's give it up for him

29
00:01:07,520 --> 00:01:11,760
hey so it's great to be here and they'll

30
00:01:11,760 --> 00:01:13,280
be talking in live

31
00:01:13,280 --> 00:01:15,439
last time i was talking in a conference

32
00:01:15,439 --> 00:01:16,560
it was a virtual

33
00:01:16,560 --> 00:01:19,920
in my in my room and it's so fun to see

34
00:01:19,920 --> 00:01:21,759
all the feedback and everybody over here

35
00:01:21,759 --> 00:01:22,400
so

36
00:01:22,400 --> 00:01:26,720
thank you for coming

37
00:01:26,720 --> 00:01:28,799
i'll be talking about hacking the open

38
00:01:28,799 --> 00:01:30,720
source software

39
00:01:30,720 --> 00:01:34,560
so i started like a year ago or two

40
00:01:34,560 --> 00:01:35,119
years ago

41
00:01:35,119 --> 00:01:38,000
playing with different stuff and found

42
00:01:38,000 --> 00:01:38,799
myself

43
00:01:38,799 --> 00:01:40,880
every time going into open source and i

44
00:01:40,880 --> 00:01:42,720
will explain

45
00:01:42,720 --> 00:01:46,159
different clicking okay

46
00:01:46,159 --> 00:01:49,280
the clicker is yeah so i will

47
00:01:49,280 --> 00:01:52,479
start explaining a bit about who am i

48
00:01:52,479 --> 00:01:55,840
why why do what i do how i hack stuff

49
00:01:55,840 --> 00:01:57,920
this is super secret knowledge that i

50
00:01:57,920 --> 00:01:59,600
will share with everybody

51
00:01:59,600 --> 00:02:02,479
well not so secret um i will tell you

52
00:02:02,479 --> 00:02:03,840
two stories one about

53
00:02:03,840 --> 00:02:07,119
a traversal attack that we did together

54
00:02:07,119 --> 00:02:07,600
with

55
00:02:07,600 --> 00:02:12,160
danny robinson he's from apps flyer and

56
00:02:12,160 --> 00:02:14,560
and another one that i did in playing

57
00:02:14,560 --> 00:02:15,630
with ssrfs

58
00:02:15,630 --> 00:02:16,959
[Music]

59
00:02:16,959 --> 00:02:20,319
just by mistake so

60
00:02:20,319 --> 00:02:22,640
i'll talk about a bit about myself so

61
00:02:22,640 --> 00:02:23,840
i'm a cyber paladin

62
00:02:23,840 --> 00:02:26,239
this is who i am in the last couple of

63
00:02:26,239 --> 00:02:27,040
years

64
00:02:27,040 --> 00:02:30,640
i work in a super cool startup it's a

65
00:02:30,640 --> 00:02:32,160
new startup half a year

66
00:02:32,160 --> 00:02:36,000
old um i created a bug bounty

67
00:02:36,000 --> 00:02:38,160
il meetup so everybody that wants to

68
00:02:38,160 --> 00:02:39,360
join uh

69
00:02:39,360 --> 00:02:42,640
we had the first event last like two

70
00:02:42,640 --> 00:02:44,879
three weeks ago and it was amazing lots

71
00:02:44,879 --> 00:02:46,319
of good feedback and

72
00:02:46,319 --> 00:02:48,879
i'm sure there will be much more events

73
00:02:48,879 --> 00:02:49,599
um

74
00:02:49,599 --> 00:02:52,239
soon and i'm a father for a seven year

75
00:02:52,239 --> 00:02:52,870
old

76
00:02:52,870 --> 00:02:54,720
[Music]

77
00:02:54,720 --> 00:02:58,080
girl i passed the

78
00:02:58,080 --> 00:03:01,120
cover deal with him so it's

79
00:03:01,120 --> 00:03:03,840
it was tough but interesting and banded

80
00:03:03,840 --> 00:03:04,640
as the garden

81
00:03:04,640 --> 00:03:08,640
and this is me um i'll get to the point

82
00:03:08,640 --> 00:03:11,599
and the point is how i hack stuff so

83
00:03:11,599 --> 00:03:13,040
this is a bit about

84
00:03:13,040 --> 00:03:16,239
my super secret sauce and what i do

85
00:03:16,239 --> 00:03:18,720
but actually when i see a system any

86
00:03:18,720 --> 00:03:19,760
system at all

87
00:03:19,760 --> 00:03:22,879
i start playing with it and i'm

88
00:03:22,879 --> 00:03:25,040
i'm saying playing it's not like testing

89
00:03:25,040 --> 00:03:26,159
it or

90
00:03:26,159 --> 00:03:29,040
checking it out it's it's a game it's a

91
00:03:29,040 --> 00:03:29,599
game i

92
00:03:29,599 --> 00:03:31,440
want to start playing start to see all

93
00:03:31,440 --> 00:03:33,599
the stuff over in the system

94
00:03:33,599 --> 00:03:36,080
and when i play with it then i start

95
00:03:36,080 --> 00:03:37,840
understanding more and more stuff

96
00:03:37,840 --> 00:03:40,959
over there but then sometimes something

97
00:03:40,959 --> 00:03:42,319
doesn't feel right

98
00:03:42,319 --> 00:03:46,159
and this is a main point in all pen

99
00:03:46,159 --> 00:03:48,319
testing and hacking and what we do

100
00:03:48,319 --> 00:03:50,879
is we have these feelings and i want to

101
00:03:50,879 --> 00:03:52,400
in the next slide i will talk about what

102
00:03:52,400 --> 00:03:54,239
is this feeling and the

103
00:03:54,239 --> 00:03:57,439
how how i get them but before the

104
00:03:57,439 --> 00:03:58,400
feeling

105
00:03:58,400 --> 00:04:01,200
after i we felt something is wrong then

106
00:04:01,200 --> 00:04:03,200
i need to understand exactly

107
00:04:03,200 --> 00:04:05,120
to the bit level what's happening why is

108
00:04:05,120 --> 00:04:05,980
it happening and

109
00:04:05,980 --> 00:04:07,280
[Music]

110
00:04:07,280 --> 00:04:09,439
why the developer did this mistake in

111
00:04:09,439 --> 00:04:10,319
order to

112
00:04:10,319 --> 00:04:12,840
get me more to be able to hack the

113
00:04:12,840 --> 00:04:15,519
system

114
00:04:15,519 --> 00:04:18,798
clickable yeah so a bit about what is

115
00:04:18,798 --> 00:04:20,320
this feeling

116
00:04:20,320 --> 00:04:22,560
and this feeling is first of all is

117
00:04:22,560 --> 00:04:23,440
prediction

118
00:04:23,440 --> 00:04:26,160
i have lots of experience playing with

119
00:04:26,160 --> 00:04:26,639
lots of

120
00:04:26,639 --> 00:04:28,720
different systems and i expect them to

121
00:04:28,720 --> 00:04:29,759
work in a

122
00:04:29,759 --> 00:04:32,639
specific way so when i access the home

123
00:04:32,639 --> 00:04:34,000
directory of

124
00:04:34,000 --> 00:04:36,960
your website it needs to give me a 200

125
00:04:36,960 --> 00:04:37,680
okay

126
00:04:37,680 --> 00:04:39,199
when i access something that doesn't

127
00:04:39,199 --> 00:04:41,520
exist it needs to give me a 404

128
00:04:41,520 --> 00:04:45,120
i have these feelings and then if

129
00:04:45,120 --> 00:04:46,960
something doesn't happen like i predict

130
00:04:46,960 --> 00:04:49,680
it like i get into a yoga and gives me a

131
00:04:49,680 --> 00:04:51,040
500 error or something

132
00:04:51,040 --> 00:04:54,320
else this triggers my feeling

133
00:04:54,320 --> 00:04:58,160
my spider sense that i want to go and

134
00:04:58,160 --> 00:05:01,360
dig deep into it the other areas is

135
00:05:01,360 --> 00:05:04,400
i've seen that every time i play with a

136
00:05:04,400 --> 00:05:05,199
system

137
00:05:05,199 --> 00:05:08,240
and then sometimes i see a php or

138
00:05:08,240 --> 00:05:12,320
other areas i'm not i'm not against php

139
00:05:12,320 --> 00:05:12,639
but

140
00:05:12,639 --> 00:05:15,759
php is a very good sign or

141
00:05:15,759 --> 00:05:17,840
that there may be something wrong over

142
00:05:17,840 --> 00:05:18,960
here

143
00:05:18,960 --> 00:05:20,960
but other technologies i've looked in

144
00:05:20,960 --> 00:05:23,039
the way and i see okay this is something

145
00:05:23,039 --> 00:05:24,720
i know it happens

146
00:05:24,720 --> 00:05:29,199
this will probably lead to these areas

147
00:05:29,199 --> 00:05:30,720
and then there's the what the

148
00:05:30,720 --> 00:05:32,400
moment that

149
00:05:32,400 --> 00:05:34,720
these this doesn't need to happen i'm

150
00:05:34,720 --> 00:05:35,840
accessing a url

151
00:05:35,840 --> 00:05:39,120
and some like sometimes a new

152
00:05:39,120 --> 00:05:41,840
environments those different types of

153
00:05:41,840 --> 00:05:42,720
responses

154
00:05:42,720 --> 00:05:44,720
i access one time it's one response the

155
00:05:44,720 --> 00:05:46,320
other time it's another response

156
00:05:46,320 --> 00:05:47,840
these are the most interesting areas

157
00:05:47,840 --> 00:05:50,240
because you see there's inconsistency of

158
00:05:50,240 --> 00:05:52,639
the system and

159
00:05:52,639 --> 00:05:56,160
let's play with that so i'll start

160
00:05:56,160 --> 00:05:59,600
with my stories and what i'm doing

161
00:05:59,600 --> 00:06:03,759
and this is access to one of

162
00:06:04,960 --> 00:06:07,600
to a normal system and i always try to

163
00:06:07,600 --> 00:06:09,759
get to something that doesn't exist

164
00:06:09,759 --> 00:06:13,440
and i got from uh from over here uh

165
00:06:13,440 --> 00:06:15,280
responsible for response that there was

166
00:06:15,280 --> 00:06:17,440
a server named cowboy and gave me

167
00:06:17,440 --> 00:06:19,680
it doesn't happen and this is okay this

168
00:06:19,680 --> 00:06:20,960
is the

169
00:06:20,960 --> 00:06:24,000
the proper way of what should happen

170
00:06:24,000 --> 00:06:25,919
but then a bit playing with fuzzing and

171
00:06:25,919 --> 00:06:27,919
playing with it

172
00:06:27,919 --> 00:06:30,240
and trying to traverse to do path

173
00:06:30,240 --> 00:06:31,280
reversal

174
00:06:31,280 --> 00:06:34,639
we got this answer and this answer is

175
00:06:34,639 --> 00:06:36,639
interesting i've actually seen it in

176
00:06:36,639 --> 00:06:37,919
different areas

177
00:06:37,919 --> 00:06:40,560
and but i see also the server over here

178
00:06:40,560 --> 00:06:41,120
it's

179
00:06:41,120 --> 00:06:44,720
not a cowboy anymore it's a aws clb

180
00:06:44,720 --> 00:06:48,720
so why is elb sending me

181
00:06:48,720 --> 00:06:50,560
responses to something else because i

182
00:06:50,560 --> 00:06:52,960
asked the server i didn't ask the elb

183
00:06:52,960 --> 00:06:55,759
and so i figured out there's a alb or

184
00:06:55,759 --> 00:06:57,120
elb in the middle

185
00:06:57,120 --> 00:07:00,400
and it is giving me a bad request but

186
00:07:00,400 --> 00:07:02,720
i in this specific case it's something

187
00:07:02,720 --> 00:07:04,639
that i knew and i saw that

188
00:07:04,639 --> 00:07:07,039
i i did have a traversal injection i

189
00:07:07,039 --> 00:07:08,400
knew it because i saw it in the source

190
00:07:08,400 --> 00:07:08,960
code

191
00:07:08,960 --> 00:07:12,000
but nothing it didn't happen it wasn't i

192
00:07:12,000 --> 00:07:12,960
wasn't able to

193
00:07:12,960 --> 00:07:16,720
exploit it because elb did something

194
00:07:16,720 --> 00:07:18,080
and this is something is very

195
00:07:18,080 --> 00:07:20,000
interesting to understand what

196
00:07:20,000 --> 00:07:23,360
what is this something so i added

197
00:07:23,360 --> 00:07:26,240
different slashes start playing and then

198
00:07:26,240 --> 00:07:28,240
adding multiple slashes

199
00:07:28,240 --> 00:07:31,919
in front of the url gave me an okay from

200
00:07:31,919 --> 00:07:33,440
the original server

201
00:07:33,440 --> 00:07:37,280
and i'm looking like why why

202
00:07:37,280 --> 00:07:39,120
did i add multiple slashes in the

203
00:07:39,120 --> 00:07:40,720
beginning and

204
00:07:40,720 --> 00:07:42,639
it worked and when i didn't add them it

205
00:07:42,639 --> 00:07:44,720
didn't work like there's

206
00:07:44,720 --> 00:07:46,639
something very weird happening over here

207
00:07:46,639 --> 00:07:49,360
and i need to understand it

208
00:07:49,360 --> 00:07:51,750
so i know this message over here and

209
00:07:51,750 --> 00:07:53,199
[Music]

210
00:07:53,199 --> 00:07:55,120
i saw this message over here with a bad

211
00:07:55,120 --> 00:07:57,840
request with the bt color equals white

212
00:07:57,840 --> 00:07:58,240
and

213
00:07:58,240 --> 00:07:59,919
i started looking for it and looking for

214
00:07:59,919 --> 00:08:01,919
more instances that give me

215
00:08:01,919 --> 00:08:04,400
who is giving me this answer and i know

216
00:08:04,400 --> 00:08:05,039
this is

217
00:08:05,039 --> 00:08:08,800
elb but i'm starting the investigation

218
00:08:08,800 --> 00:08:09,919
i'm starting to understand

219
00:08:09,919 --> 00:08:12,720
why why is this happening how how can i

220
00:08:12,720 --> 00:08:13,280
hack this

221
00:08:13,280 --> 00:08:17,120
or what how can i go to my goal

222
00:08:17,120 --> 00:08:18,800
so the first thing is let me github this

223
00:08:18,800 --> 00:08:20,800
for you because

224
00:08:20,800 --> 00:08:22,879
most people go to google i go to github

225
00:08:22,879 --> 00:08:23,840
github has

226
00:08:23,840 --> 00:08:25,840
lots of information lots of stuff

227
00:08:25,840 --> 00:08:27,759
there's code i can see

228
00:08:27,759 --> 00:08:30,400
source code that is happening over there

229
00:08:30,400 --> 00:08:31,120
and

230
00:08:31,120 --> 00:08:33,679
i saw lots of different references to

231
00:08:33,679 --> 00:08:34,799
nginx

232
00:08:34,799 --> 00:08:38,000
so we have nginx and nginx gives me the

233
00:08:38,000 --> 00:08:39,599
same response

234
00:08:39,599 --> 00:08:42,559
but this is alb so is this nginx maybe

235
00:08:42,559 --> 00:08:43,919
alb is using

236
00:08:43,919 --> 00:08:46,800
some kind of customized nginx in the

237
00:08:46,800 --> 00:08:48,480
background

238
00:08:48,480 --> 00:08:50,800
so you try to go more further and they

239
00:08:50,800 --> 00:08:52,480
saw that in the git commits

240
00:08:52,480 --> 00:08:54,720
because you have all the commit history

241
00:08:54,720 --> 00:08:56,160
and you can look in the comments then

242
00:08:56,160 --> 00:08:56,959
you see

243
00:08:56,959 --> 00:08:58,720
there was a bg column and they removed

244
00:08:58,720 --> 00:09:00,399
it but you can

245
00:09:00,399 --> 00:09:02,820
see in the code that it is nginx and

246
00:09:02,820 --> 00:09:04,160
[Music]

247
00:09:04,160 --> 00:09:07,360
like this specific page is

248
00:09:07,360 --> 00:09:10,880
probably nginx so i was looking into the

249
00:09:10,880 --> 00:09:12,880
nginx documentation and they saw a very

250
00:09:12,880 --> 00:09:14,880
nice configuration file

251
00:09:14,880 --> 00:09:16,800
uh the configuration option that has

252
00:09:16,800 --> 00:09:18,080
merged slashes

253
00:09:18,080 --> 00:09:20,560
and metal slashes has it's actually

254
00:09:20,560 --> 00:09:21,920
creates all discussions and takes them

255
00:09:21,920 --> 00:09:22,880
together

256
00:09:22,880 --> 00:09:26,880
so if you if you put in slashes

257
00:09:26,880 --> 00:09:29,200
like wherever there are multiple slashes

258
00:09:29,200 --> 00:09:30,880
it merges them together

259
00:09:30,880 --> 00:09:34,480
and this can be why multiple slashes

260
00:09:34,480 --> 00:09:38,160
made the mistake of

261
00:09:38,160 --> 00:09:41,680
of passing it through so i want

262
00:09:41,680 --> 00:09:43,440
i want to understand it deeply i want to

263
00:09:43,440 --> 00:09:45,760
understand exactly what what's happening

264
00:09:45,760 --> 00:09:49,440
i have the code i have everything but

265
00:09:49,440 --> 00:09:53,360
first of all i want to show about how

266
00:09:53,360 --> 00:09:53,760
i'm

267
00:09:53,760 --> 00:09:56,320
uh how i'm working so this was until now

268
00:09:56,320 --> 00:09:57,600
black box testing

269
00:09:57,600 --> 00:09:58,959
i didn't have access to the code i

270
00:09:58,959 --> 00:10:00,720
didn't have access to nothing

271
00:10:00,720 --> 00:10:03,920
but i like i'm good at black box testing

272
00:10:03,920 --> 00:10:04,720
i like to

273
00:10:04,720 --> 00:10:06,959
have access to everything i need so i

274
00:10:06,959 --> 00:10:08,000
need access to

275
00:10:08,000 --> 00:10:10,640
the source code i need access to run the

276
00:10:10,640 --> 00:10:13,200
programs i need access to

277
00:10:13,200 --> 00:10:15,519
even talk with developers and this is

278
00:10:15,519 --> 00:10:17,360
why i love open source

279
00:10:17,360 --> 00:10:19,440
it's so easy to go and find the slack of

280
00:10:19,440 --> 00:10:21,760
the open source uh community

281
00:10:21,760 --> 00:10:23,680
or some other forum and just talk with

282
00:10:23,680 --> 00:10:25,839
the guys asking why did you do this why

283
00:10:25,839 --> 00:10:26,959
did you do that

284
00:10:26,959 --> 00:10:28,880
yeah i can see the code i can compile it

285
00:10:28,880 --> 00:10:31,600
i can it's not black box it's not like a

286
00:10:31,600 --> 00:10:33,360
frustrating black box that i don't have

287
00:10:33,360 --> 00:10:36,240
any thing that i need to have hours of

288
00:10:36,240 --> 00:10:37,519
debugging and fuzzing

289
00:10:37,519 --> 00:10:40,480
and understanding what they do so this

290
00:10:40,480 --> 00:10:40,880
is

291
00:10:40,880 --> 00:10:43,839
i in the past i did lots of black box

292
00:10:43,839 --> 00:10:44,640
testing and

293
00:10:44,640 --> 00:10:47,839
now today i'm doing more white box and

294
00:10:47,839 --> 00:10:50,640
understanding exactly because it's

295
00:10:50,640 --> 00:10:51,200
easier

296
00:10:51,200 --> 00:10:53,279
it's easier it's beneficial for my

297
00:10:53,279 --> 00:10:55,200
clients and beneficial for me

298
00:10:55,200 --> 00:10:59,279
it's just i like it

299
00:10:59,279 --> 00:11:02,000
so i went to the source code and i com i

300
00:11:02,000 --> 00:11:03,200
found the

301
00:11:03,200 --> 00:11:06,320
http pulsing area of how

302
00:11:06,320 --> 00:11:08,800
how it's passing the url so nginx is

303
00:11:08,800 --> 00:11:10,880
passing the url in a specific way

304
00:11:10,880 --> 00:11:15,360
and i downloaded this this line of code

305
00:11:15,360 --> 00:11:17,680
and i actually created a smart program

306
00:11:17,680 --> 00:11:18,880
that simulates

307
00:11:18,880 --> 00:11:21,519
what i want to do and i sent slash dot

308
00:11:21,519 --> 00:11:22,880
dot slash hello world

309
00:11:22,880 --> 00:11:24,640
to it and i see exactly i put in

310
00:11:24,640 --> 00:11:26,399
debugging comments so i can

311
00:11:26,399 --> 00:11:28,959
see what it's doing and i saw that it's

312
00:11:28,959 --> 00:11:30,000
okay

313
00:11:30,000 --> 00:11:31,760
it's not okay it's actually returning

314
00:11:31,760 --> 00:11:33,760
11. and 11 is a

315
00:11:33,760 --> 00:11:35,519
problem with the state machine that it's

316
00:11:35,519 --> 00:11:37,440
crashing in some place

317
00:11:37,440 --> 00:11:40,079
and then if i add the multiple slashes

318
00:11:40,079 --> 00:11:40,959
then i can see

319
00:11:40,959 --> 00:11:42,959
it's a looking for a charitable slash

320
00:11:42,959 --> 00:11:45,360
it's a merging them and then

321
00:11:45,360 --> 00:11:49,600
it's going okay so the number of slashes

322
00:11:49,600 --> 00:11:52,000
needs to be more than the amount of

323
00:11:52,000 --> 00:11:53,760
direct reversals over here and this is

324
00:11:53,760 --> 00:11:54,800
what i found from

325
00:11:54,800 --> 00:11:56,800
digging into the source code and seeing

326
00:11:56,800 --> 00:11:58,399
everything over here

327
00:11:58,399 --> 00:12:00,880
so this is happening in nginx and they

328
00:12:00,880 --> 00:12:02,000
want

329
00:12:02,000 --> 00:12:05,120
to continue and this is

330
00:12:05,120 --> 00:12:08,639
a bit what's what happened and when does

331
00:12:08,639 --> 00:12:09,360
the mail slash

332
00:12:09,360 --> 00:12:13,600
off in the nginx it can

333
00:12:13,839 --> 00:12:17,279
it actually nginx can by mistake protect

334
00:12:17,279 --> 00:12:18,399
you from

335
00:12:18,399 --> 00:12:20,240
traversal attacks and you just need to

336
00:12:20,240 --> 00:12:23,120
add slashes in the front

337
00:12:23,120 --> 00:12:24,880
so i talked to amazon about this and i

338
00:12:24,880 --> 00:12:27,440
talked to friend genex about it

339
00:12:27,440 --> 00:12:30,079
both told me this is intended behavior

340
00:12:30,079 --> 00:12:31,040
this is what's

341
00:12:31,040 --> 00:12:34,160
supposed to happen and we try to discuss

342
00:12:34,160 --> 00:12:37,360
different areas this alb is not a

343
00:12:37,360 --> 00:12:38,720
protection

344
00:12:38,720 --> 00:12:41,120
mechanism but you should know as a pen

345
00:12:41,120 --> 00:12:42,240
tester that

346
00:12:42,240 --> 00:12:44,320
it sometimes does protect you by mistake

347
00:12:44,320 --> 00:12:46,320
but there's a very easy bypass

348
00:12:46,320 --> 00:12:49,600
to bypass this behavior uh

349
00:12:49,600 --> 00:12:52,000
because everybody uses alb or not

350
00:12:52,000 --> 00:12:54,000
everybody but lots of

351
00:12:54,000 --> 00:12:56,079
lots of companies they use a lb they

352
00:12:56,079 --> 00:12:57,440
can't change it they're not

353
00:12:57,440 --> 00:13:00,000
able to change this behavior and also

354
00:13:00,000 --> 00:13:01,360
talking with nginx

355
00:13:01,360 --> 00:13:04,480
we looked up about the rfc of the http

356
00:13:04,480 --> 00:13:06,959
request itself and how you should pause

357
00:13:06,959 --> 00:13:07,920
http and

358
00:13:07,920 --> 00:13:10,000
they said yeah it's not in the lfc it

359
00:13:10,000 --> 00:13:12,399
doesn't say what you should expectly do

360
00:13:12,399 --> 00:13:14,959
this is not a mistake this is maybe a

361
00:13:14,959 --> 00:13:15,920
feature request

362
00:13:15,920 --> 00:13:18,399
but we don't have we don't want to do

363
00:13:18,399 --> 00:13:20,240
nothing with it it will break lots of

364
00:13:20,240 --> 00:13:21,600
stuff

365
00:13:21,600 --> 00:13:23,680
so we decided not to do nothing but just

366
00:13:23,680 --> 00:13:26,000
know about it

367
00:13:26,000 --> 00:13:28,720
but then if it blocks you you can add a

368
00:13:28,720 --> 00:13:30,160
slash to it

369
00:13:30,160 --> 00:13:33,440
and this is this is my

370
00:13:33,440 --> 00:13:36,800
my conclusions from this small research

371
00:13:36,800 --> 00:13:38,639
i have here a blog you can go into it

372
00:13:38,639 --> 00:13:39,920
into an extra versa

373
00:13:39,920 --> 00:13:42,639
it's something i did with danny we

374
00:13:42,639 --> 00:13:45,279
looked at different

375
00:13:45,279 --> 00:13:48,720
different payloads and you can just read

376
00:13:48,720 --> 00:13:49,040
about

377
00:13:49,040 --> 00:13:52,800
all the investigation of wooden

378
00:13:54,480 --> 00:13:56,880
so we wrote a blog about this we were

379
00:13:56,880 --> 00:13:59,439
the blog was

380
00:13:59,839 --> 00:14:02,399
blowing up on twitter we had even people

381
00:14:02,399 --> 00:14:04,480
from

382
00:14:04,480 --> 00:14:07,519
i don't know which like a persia or

383
00:14:07,519 --> 00:14:10,639
other yahid namini talked about it and

384
00:14:10,639 --> 00:14:10,959
the

385
00:14:10,959 --> 00:14:13,040
people in the bug bounty used this

386
00:14:13,040 --> 00:14:14,320
vulnerability

387
00:14:14,320 --> 00:14:17,680
to earn money from this vulnerability

388
00:14:17,680 --> 00:14:20,160
open security gave it even stock

389
00:14:20,160 --> 00:14:22,399
talked about it a bit stock is a very

390
00:14:22,399 --> 00:14:23,760
well known

391
00:14:23,760 --> 00:14:26,800
bug bounty leader um

392
00:14:26,800 --> 00:14:29,360
so this is a this is a different

393
00:14:29,360 --> 00:14:30,240
references

394
00:14:30,240 --> 00:14:33,839
from this blog and they what we did

395
00:14:33,839 --> 00:14:36,959
so a bit about

396
00:14:36,959 --> 00:14:40,880
a bit about this this was a very fun

397
00:14:40,880 --> 00:14:43,680
experiment but i wanted to talk also

398
00:14:43,680 --> 00:14:44,160
about

399
00:14:44,160 --> 00:14:46,959
uh different different areas a different

400
00:14:46,959 --> 00:14:47,839
open source

401
00:14:47,839 --> 00:14:51,120
attack that we did and this attack was

402
00:14:51,120 --> 00:14:52,240
actually

403
00:14:52,240 --> 00:14:54,399
started by the most boring prime test in

404
00:14:54,399 --> 00:14:55,440
the world

405
00:14:55,440 --> 00:14:58,720
and i took a job and we had a i had a

406
00:14:58,720 --> 00:14:59,680
pen test

407
00:14:59,680 --> 00:15:03,519
and i went with all my passion to go

408
00:15:03,519 --> 00:15:06,160
and start hacking into the system and

409
00:15:06,160 --> 00:15:07,680
then they told me

410
00:15:07,680 --> 00:15:10,720
the system is just like a lot of

411
00:15:10,720 --> 00:15:12,560
different open source programs

412
00:15:12,560 --> 00:15:14,959
that are connected together so we have

413
00:15:14,959 --> 00:15:15,839
this open source

414
00:15:15,839 --> 00:15:18,959
load balancer let's say elb or lv

415
00:15:18,959 --> 00:15:21,920
i would say open source syntaxes in this

416
00:15:21,920 --> 00:15:23,199
case it was elastic

417
00:15:23,199 --> 00:15:25,600
there's a database there's open source

418
00:15:25,600 --> 00:15:27,519
cms there's an open source

419
00:15:27,519 --> 00:15:30,880
a lot of different open source

420
00:15:31,279 --> 00:15:34,800
services and all created in a mesh so

421
00:15:34,800 --> 00:15:37,199
they give a solution to a specific

422
00:15:37,199 --> 00:15:38,160
client

423
00:15:38,160 --> 00:15:40,720
and then the mission was you have x

424
00:15:40,720 --> 00:15:42,720
excels to find something interesting

425
00:15:42,720 --> 00:15:45,199
and i'm saying okay what can i found

426
00:15:45,199 --> 00:15:47,920
find interesting

427
00:15:50,480 --> 00:15:53,360
so my options was i first like the most

428
00:15:53,360 --> 00:15:55,600
basic is find configuration problems

429
00:15:55,600 --> 00:15:57,440
this is easy it's just like going

430
00:15:57,440 --> 00:15:58,720
through all the places looking at the

431
00:15:58,720 --> 00:15:59,920
configuration saying

432
00:15:59,920 --> 00:16:02,480
yeah this doesn't have ssl this doesn't

433
00:16:02,480 --> 00:16:03,360
have

434
00:16:03,360 --> 00:16:05,519
this recommendation we have different

435
00:16:05,519 --> 00:16:07,199
like types of

436
00:16:07,199 --> 00:16:09,440
problems and just telling them but it's

437
00:16:09,440 --> 00:16:10,880
not a fun pentest it's not like

438
00:16:10,880 --> 00:16:12,079
something that

439
00:16:12,079 --> 00:16:14,160
it's fun for me to do i can go

440
00:16:14,160 --> 00:16:16,000
infrastructure go nmap and

441
00:16:16,000 --> 00:16:18,399
start finding different vulnerabilities

442
00:16:18,399 --> 00:16:20,079
but also

443
00:16:20,079 --> 00:16:22,160
i did a bit about this with kubernetes

444
00:16:22,160 --> 00:16:23,839
because it's fun

445
00:16:23,839 --> 00:16:27,279
but then i had much more hours to play

446
00:16:27,279 --> 00:16:29,600
with and i wanted to find some blood

447
00:16:29,600 --> 00:16:32,639
and i wanted to look more so

448
00:16:32,639 --> 00:16:34,480
finding a vulnerability inside one of

449
00:16:34,480 --> 00:16:37,839
these open-source programs

450
00:16:38,320 --> 00:16:40,240
so i played with the system as i said

451
00:16:40,240 --> 00:16:41,440
before i'm playing with the different

452
00:16:41,440 --> 00:16:42,480
systems

453
00:16:42,480 --> 00:16:45,519
and i found a hint what's this hint

454
00:16:45,519 --> 00:16:48,160
i saw over here in elastic there's a

455
00:16:48,160 --> 00:16:49,680
alerting model

456
00:16:49,680 --> 00:16:51,600
and actually this is elastic but it's

457
00:16:51,600 --> 00:16:53,440
not elastic because this is an open

458
00:16:53,440 --> 00:16:54,800
distro plug-in

459
00:16:54,800 --> 00:16:57,519
for elastic and i will get to it why

460
00:16:57,519 --> 00:16:58,480
it's important

461
00:16:58,480 --> 00:17:01,360
that it's not elastic but then i see

462
00:17:01,360 --> 00:17:02,399
this web hook and

463
00:17:02,399 --> 00:17:05,199
this is it gives me my final sense if

464
00:17:05,199 --> 00:17:06,240
there's a web hook

465
00:17:06,240 --> 00:17:08,240
probably there will be a ssrf

466
00:17:08,240 --> 00:17:10,319
vulnerability over here

467
00:17:10,319 --> 00:17:14,400
so i just like 110 put in

468
00:17:14,400 --> 00:17:17,439
the default service cluster

469
00:17:17,439 --> 00:17:21,359
of registry of a cover of kubernetes

470
00:17:21,359 --> 00:17:24,000
this will exploit if you have also aws

471
00:17:24,000 --> 00:17:25,359
metadata apis

472
00:17:25,359 --> 00:17:29,200
this is also a way localhost y12701

473
00:17:29,200 --> 00:17:30,880
there are different ways to start

474
00:17:30,880 --> 00:17:33,840
understanding if there's a

475
00:17:33,840 --> 00:17:37,520
local ssrf over here or just go

476
00:17:37,520 --> 00:17:40,799
to your server outside so i

477
00:17:40,799 --> 00:17:44,960
put it up sent a request

478
00:17:45,120 --> 00:17:49,200
and great success i i was able to send

479
00:17:49,200 --> 00:17:52,240
a payload the most interesting area here

480
00:17:52,240 --> 00:17:52,480
is

481
00:17:52,480 --> 00:17:54,080
it's not only a payload i can control

482
00:17:54,080 --> 00:17:55,679
the whole body of the payload

483
00:17:55,679 --> 00:17:57,840
i can create a post payload and i can

484
00:17:57,840 --> 00:17:58,799
create even

485
00:17:58,799 --> 00:18:01,280
i see the response back inside my

486
00:18:01,280 --> 00:18:01,840
browser

487
00:18:01,840 --> 00:18:03,679
when i'm sending it because i'm testing

488
00:18:03,679 --> 00:18:05,760
it and it sends me back the response

489
00:18:05,760 --> 00:18:07,760
so i can really start communicating with

490
00:18:07,760 --> 00:18:08,880
internal services

491
00:18:08,880 --> 00:18:12,000
i can ask the kubernetes api over here

492
00:18:12,000 --> 00:18:14,000
and this specific case also the

493
00:18:14,000 --> 00:18:15,600
commodities api wasn't configured

494
00:18:15,600 --> 00:18:17,360
properly and i was able to

495
00:18:17,360 --> 00:18:20,720
take over the whole part environment

496
00:18:20,720 --> 00:18:23,679
the the node this is a specific

497
00:18:23,679 --> 00:18:24,720
kubernetes node

498
00:18:24,720 --> 00:18:27,600
by creating a privileged pod and then

499
00:18:27,600 --> 00:18:28,960
escalating my privileges

500
00:18:28,960 --> 00:18:30,690
to have more

501
00:18:30,690 --> 00:18:32,480
[Music]

502
00:18:32,480 --> 00:18:35,200
to have access to the whole node but

503
00:18:35,200 --> 00:18:38,080
this is not a story

504
00:18:40,160 --> 00:18:42,799
the question over here that i ask myself

505
00:18:42,799 --> 00:18:44,480
is who is responsible

506
00:18:44,480 --> 00:18:47,600
so i know the client has

507
00:18:47,600 --> 00:18:49,520
all these open source environments and

508
00:18:49,520 --> 00:18:52,000
he just put it over there

509
00:18:52,000 --> 00:18:54,720
and it's not it's not like he can do

510
00:18:54,720 --> 00:18:56,880
something about it he can add maybe

511
00:18:56,880 --> 00:18:57,520
protections

512
00:18:57,520 --> 00:19:00,799
add firewall rules know that

513
00:19:00,799 --> 00:19:02,799
make sure to isolate the environment and

514
00:19:02,799 --> 00:19:04,880
this is also stuff that i told him

515
00:19:04,880 --> 00:19:08,080
but then maybe someone else is also

516
00:19:08,080 --> 00:19:11,280
responsible over here so we had elastic

517
00:19:11,280 --> 00:19:13,600
elastic it's actually it's the elastic

518
00:19:13,600 --> 00:19:14,640
the framework itself but

519
00:19:14,640 --> 00:19:17,840
it's not theirs the they have the

520
00:19:17,840 --> 00:19:19,039
problem was inside

521
00:19:19,039 --> 00:19:21,360
the open disco plug-in and there's the

522
00:19:21,360 --> 00:19:22,640
open distal that they

523
00:19:22,640 --> 00:19:24,480
developed the plug-in and maybe it's

524
00:19:24,480 --> 00:19:25,919
them they are actually

525
00:19:25,919 --> 00:19:28,160
they already did a fork and they

526
00:19:28,160 --> 00:19:29,360
the whole distance

527
00:19:29,360 --> 00:19:32,160
and there's lots of talks about why and

528
00:19:32,160 --> 00:19:32,799
how

529
00:19:32,799 --> 00:19:35,440
of the gpl of the agpl and gpl and all

530
00:19:35,440 --> 00:19:36,400
these

531
00:19:36,400 --> 00:19:38,880
problems of the licensing but then the

532
00:19:38,880 --> 00:19:40,400
question is who is responsible so i

533
00:19:40,400 --> 00:19:42,799
started talking with opendistal

534
00:19:42,799 --> 00:19:46,880
and i want actually to search

535
00:19:46,880 --> 00:19:51,200
on why this happens or where to ask them

536
00:19:51,200 --> 00:19:54,799
and i asked i went to the github open

537
00:19:54,799 --> 00:19:56,240
discord for elasticsearching

538
00:19:56,240 --> 00:19:59,520
and to understand who should i submit to

539
00:19:59,520 --> 00:20:02,559
and over there it says if you find a

540
00:20:02,559 --> 00:20:03,919
vulnerability

541
00:20:03,919 --> 00:20:06,000
tell aws because this is aws

542
00:20:06,000 --> 00:20:08,000
responsibility

543
00:20:08,000 --> 00:20:09,760
so it's interesting this is an open

544
00:20:09,760 --> 00:20:11,600
source project but aws

545
00:20:11,600 --> 00:20:15,039
is in charge of it so i said okay let's

546
00:20:15,039 --> 00:20:17,520
send a message to aws i send a message

547
00:20:17,520 --> 00:20:19,440
to aws and aws tells me

548
00:20:19,440 --> 00:20:22,240
no this is not our responsibility try

549
00:20:22,240 --> 00:20:23,919
checking the open disco

550
00:20:23,919 --> 00:20:26,400
so i'm in a loop here now i'm uh okay i

551
00:20:26,400 --> 00:20:27,120
will go to the

552
00:20:27,120 --> 00:20:29,440
open distro again so instead of going

553
00:20:29,440 --> 00:20:31,039
into the loop and trying to understand i

554
00:20:31,039 --> 00:20:32,320
just told them

555
00:20:32,320 --> 00:20:35,440
it says that you i should

556
00:20:35,440 --> 00:20:38,159
contact you check with other people or

557
00:20:38,159 --> 00:20:39,919
do whatever you need to understand

558
00:20:39,919 --> 00:20:42,159
if this is your responsibility and then

559
00:20:42,159 --> 00:20:43,280
they started

560
00:20:43,280 --> 00:20:45,440
talking with me and i got a hold of the

561
00:20:45,440 --> 00:20:47,120
security team and they

562
00:20:47,120 --> 00:20:50,240
we had a zoom we had a lot multiple

563
00:20:50,240 --> 00:20:51,760
conversations about

564
00:20:51,760 --> 00:20:55,120
exactly what's uh how to solve it and

565
00:20:55,120 --> 00:20:59,678
and what is the problem they added uh

566
00:21:00,080 --> 00:21:03,520
updates that you can create new

567
00:21:03,520 --> 00:21:06,559
uh you can block you can create blocks

568
00:21:06,559 --> 00:21:07,840
for the

569
00:21:07,840 --> 00:21:10,720
servers that are allowed or disallowed

570
00:21:10,720 --> 00:21:11,760
to access

571
00:21:11,760 --> 00:21:16,159
so it kind of helps with the mitigation

572
00:21:16,159 --> 00:21:17,919
but then i also told them but i want to

573
00:21:17,919 --> 00:21:19,280
tell the client

574
00:21:19,280 --> 00:21:22,320
so we created a process of

575
00:21:22,320 --> 00:21:24,640
giving getting this a cv and do carrier

576
00:21:24,640 --> 00:21:25,840
cv and open

577
00:21:25,840 --> 00:21:28,880
open distort for elasticsearch we got

578
00:21:28,880 --> 00:21:32,400
in the cvs s3 7.1 and see if this is two

579
00:21:32,400 --> 00:21:33,760
actually it's less so this is why i put

580
00:21:33,760 --> 00:21:35,440
only the 7.1

581
00:21:35,440 --> 00:21:38,480
i like the high uh but then we have

582
00:21:38,480 --> 00:21:40,480
if you want you can see in my blog over

583
00:21:40,480 --> 00:21:41,760
here about exactly

584
00:21:41,760 --> 00:21:45,440
what what happened and how we handled it

585
00:21:45,440 --> 00:21:48,880
and this is uh more about the cv

586
00:21:48,880 --> 00:21:52,640
and how we

587
00:21:52,799 --> 00:21:59,120
how how it happened um

588
00:21:59,120 --> 00:22:01,840
i think this is this is all about this

589
00:22:01,840 --> 00:22:03,919
area i had much more to say

590
00:22:03,919 --> 00:22:05,840
but we had a time limit of 25 minutes

591
00:22:05,840 --> 00:22:07,600
and i think we're already

592
00:22:07,600 --> 00:22:13,840
we're over there so thank you very much

593
00:22:13,910 --> 00:22:14,540
[Music]

594
00:22:14,540 --> 00:22:18,559
[Applause]

595
00:22:18,559 --> 00:22:20,559
and if you want you can come talk to me

596
00:22:20,559 --> 00:22:22,640
and we can talk about

597
00:22:22,640 --> 00:22:26,000
later stuff

598
00:22:26,000 --> 00:22:28,960
any questions anybody

599
00:22:29,919 --> 00:22:39,760
nope all right

