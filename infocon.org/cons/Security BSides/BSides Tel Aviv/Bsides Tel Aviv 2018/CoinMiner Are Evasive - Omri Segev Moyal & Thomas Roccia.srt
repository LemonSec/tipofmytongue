1
00:00:00,060 --> 00:00:02,009
we are going now to start with our nerf

2
00:00:02,009 --> 00:00:03,750
next talk we are going to talk about

3
00:00:03,750 --> 00:00:05,970
going Niners and we are going to have

4
00:00:05,970 --> 00:00:09,719
our second international speaker from us

5
00:00:09,719 --> 00:00:12,120
and we're going to have our own armory

6
00:00:12,120 --> 00:00:14,219
from very active in the Israeli hacking

7
00:00:14,219 --> 00:00:21,439
community so welcome thanks

8
00:00:25,190 --> 00:00:33,309
[Applause]

9
00:00:42,120 --> 00:00:44,629
like

10
00:00:44,629 --> 00:00:47,239
all right so almost every Enterprise

11
00:00:47,239 --> 00:00:51,230
suffered at least one crypto mining

12
00:00:51,230 --> 00:00:54,469
related attack this year so how many of

13
00:00:54,469 --> 00:00:56,269
you raise your hand how many of you

14
00:00:56,269 --> 00:00:59,149
already have an experience with craft oh

15
00:00:59,149 --> 00:01:02,559
my no raise your hand

16
00:01:03,129 --> 00:01:06,580
more than expected right all right so

17
00:01:06,580 --> 00:01:09,350
thank you very much my name is Tomas

18
00:01:09,350 --> 00:01:11,240
Rocha I'm working as a security

19
00:01:11,240 --> 00:01:15,170
researcher in the McAfee advanced wet

20
00:01:15,170 --> 00:01:17,929
research team and really happy to be

21
00:01:17,929 --> 00:01:18,649
here today

22
00:01:18,649 --> 00:01:21,440
my name is Omri Tiger morale and I'm the

23
00:01:21,440 --> 00:01:23,030
co-founder and head of research at

24
00:01:23,030 --> 00:01:32,390
Minerva labs ok so what we will discuss

25
00:01:32,390 --> 00:01:35,030
today so mostly we will review together

26
00:01:35,030 --> 00:01:38,299
the rise of coal miner we all know that

27
00:01:38,299 --> 00:01:41,509
since sometimes there is a lot of crypto

28
00:01:41,509 --> 00:01:44,090
miners or coal miners that infect your

29
00:01:44,090 --> 00:01:47,569
computer we will see also another view

30
00:01:47,569 --> 00:01:50,840
of the evasion techniques mostly used by

31
00:01:50,840 --> 00:01:53,210
a crop terminal which is interesting to

32
00:01:53,210 --> 00:01:56,149
notice here is the cryptocurrency

33
00:01:56,149 --> 00:01:58,579
interest in Google Trends and we can see

34
00:01:58,579 --> 00:02:00,740
that there is a huge peak in the in last

35
00:02:00,740 --> 00:02:03,380
December which was in the same time as

36
00:02:03,380 --> 00:02:06,619
the the Bitcoin peak another thing which

37
00:02:06,619 --> 00:02:09,320
is interesting is the interest come from

38
00:02:09,320 --> 00:02:09,709
mult

39
00:02:09,709 --> 00:02:13,100
and Marta is a tax haven so could be

40
00:02:13,100 --> 00:02:15,380
related as well we're also going to look

41
00:02:15,380 --> 00:02:17,840
about the kind of gang territorial wars

42
00:02:17,840 --> 00:02:20,720
between competing crypto miners and of

43
00:02:20,720 --> 00:02:22,880
course it's a b-side talk so we gotta

44
00:02:22,880 --> 00:02:24,829
have some defensive tactics something

45
00:02:24,829 --> 00:02:26,359
you can take home and improve your

46
00:02:26,359 --> 00:02:28,100
security related to that and we also

47
00:02:28,100 --> 00:02:29,930
going to do some gambling on production

48
00:02:29,930 --> 00:02:33,200
so I did I missed all my vodka bet so

49
00:02:33,200 --> 00:02:37,850
maybe I'll get one good here so everyone

50
00:02:37,850 --> 00:02:40,579
heard about a story about crypto my

51
00:02:40,579 --> 00:02:43,350
nails every day we have a new one even

52
00:02:43,350 --> 00:02:45,540
the last two day we get new one as well

53
00:02:45,540 --> 00:02:48,420
there is one with docker attack so every

54
00:02:48,420 --> 00:02:51,060
day is a new as a new day for crypto my

55
00:02:51,060 --> 00:02:54,150
crypto minor and cyber criminals so

56
00:02:54,150 --> 00:02:56,280
basically even preparing this talk we

57
00:02:56,280 --> 00:02:58,320
were really overwhelm every time we went

58
00:02:58,320 --> 00:03:03,030
and tried to improve the the talk then

59
00:03:03,030 --> 00:03:04,950
there was a new attack coming up coming

60
00:03:04,950 --> 00:03:06,870
and up and there was one just yes two

61
00:03:06,870 --> 00:03:10,320
days ago about the Dockers and basically

62
00:03:10,320 --> 00:03:13,350
someone is pretty smart embedded crypto

63
00:03:13,350 --> 00:03:15,240
minors inside docker images that were

64
00:03:15,240 --> 00:03:17,880
download by thousands of people my boy

65
00:03:17,880 --> 00:03:22,380
anyway so we will try to keep it up to

66
00:03:22,380 --> 00:03:24,180
date but you know if you just Google for

67
00:03:24,180 --> 00:03:25,860
crypto module funds are more recent

68
00:03:25,860 --> 00:03:30,210
attacks okay so let's talk about the

69
00:03:30,210 --> 00:03:33,540
business model used by Auto behind

70
00:03:33,540 --> 00:03:34,530
crypto my nose

71
00:03:34,530 --> 00:03:37,440
so mostly to mine crypto currency you

72
00:03:37,440 --> 00:03:39,870
need to use a computer resources but

73
00:03:39,870 --> 00:03:41,910
it's not any more profitable to mine in

74
00:03:41,910 --> 00:03:44,220
your own so that's why cyber criminal

75
00:03:44,220 --> 00:03:46,800
decided to move to crop to miners by

76
00:03:46,800 --> 00:03:49,850
infecting people and multiply the

77
00:03:49,850 --> 00:03:53,640
resources to mine cryptocurrencies there

78
00:03:53,640 --> 00:03:55,680
are also like legitimate miners they're

79
00:03:55,680 --> 00:03:58,740
gonna choose public pools so they can

80
00:03:58,740 --> 00:04:00,960
share the resources with other miners so

81
00:04:00,960 --> 00:04:03,690
they can maximize the profit and also

82
00:04:03,690 --> 00:04:05,670
large botnets have bins we seen

83
00:04:05,670 --> 00:04:08,490
transition to using crypto miners as

84
00:04:08,490 --> 00:04:14,070
well ok so what about the most

85
00:04:14,070 --> 00:04:17,029
cryptocurrency mine at least used by

86
00:04:17,029 --> 00:04:20,910
cyber criminals all crop terminals yes

87
00:04:20,910 --> 00:04:23,460
it's money row so it's real interesting

88
00:04:23,460 --> 00:04:26,120
to see that because mana row of specific

89
00:04:26,120 --> 00:04:29,480
functionality such as it provides

90
00:04:29,480 --> 00:04:32,130
anonymous and anonymous for anonymity

91
00:04:32,130 --> 00:04:35,520
sorry for cyber criminals and it's also

92
00:04:35,520 --> 00:04:39,360
easy to implement and easy to use in

93
00:04:39,360 --> 00:04:41,580
your own tools which is interesting to

94
00:04:41,580 --> 00:04:44,910
notice as well is even money row claims

95
00:04:44,910 --> 00:04:47,700
the money regimes claims that 80% of the

96
00:04:47,700 --> 00:04:51,060
network a chouette is unknown meaning we

97
00:04:51,060 --> 00:04:53,430
have 80% of the a shred network from

98
00:04:53,430 --> 00:04:54,880
money

99
00:04:54,880 --> 00:04:57,640
which could be potentially from a cyber

100
00:04:57,640 --> 00:04:59,680
criminal activity or at least Club to my

101
00:04:59,680 --> 00:05:01,420
nose

102
00:05:01,420 --> 00:05:03,910
another strong feature of Manero is that

103
00:05:03,910 --> 00:05:06,550
unlike a terraeum bitcoin the

104
00:05:06,550 --> 00:05:08,440
transaction are much more anonymous and

105
00:05:08,440 --> 00:05:11,650
also if you look at anyone with Bitcoin

106
00:05:11,650 --> 00:05:13,000
wallet you can see exactly how much

107
00:05:13,000 --> 00:05:15,220
money money or Bitcoin they have the

108
00:05:15,220 --> 00:05:17,770
transaction with much much it's much

109
00:05:17,770 --> 00:05:20,610
more complicated than that

110
00:05:20,610 --> 00:05:23,800
so when we're looking about the crypto

111
00:05:23,800 --> 00:05:27,280
miners is a malicious application or is

112
00:05:27,280 --> 00:05:29,620
a malware we need to separate it as a

113
00:05:29,620 --> 00:05:32,590
malware basically we want to know how it

114
00:05:32,590 --> 00:05:34,900
gets to our computers other computers or

115
00:05:34,900 --> 00:05:37,390
servers etc so we started investigating

116
00:05:37,390 --> 00:05:39,330
and we reach the same conclusion that

117
00:05:39,330 --> 00:05:42,370
the majority of crypto miners attack are

118
00:05:42,370 --> 00:05:43,720
pretty much similar to any malware

119
00:05:43,720 --> 00:05:46,570
attack most of its together is less

120
00:05:46,570 --> 00:05:48,610
sophisticated they will use things like

121
00:05:48,610 --> 00:05:51,760
spearfishing malicious documents they

122
00:05:51,760 --> 00:05:54,520
will use warm sell of war mobility like

123
00:05:54,520 --> 00:05:58,090
exploiting brute forces or smb1 a

124
00:05:58,090 --> 00:05:59,710
chronic that I mentioned wanna fly here

125
00:05:59,710 --> 00:06:05,470
and also we seen that basically and we

126
00:06:05,470 --> 00:06:07,360
will speak about it more in more details

127
00:06:07,360 --> 00:06:09,970
soon they will start competing each

128
00:06:09,970 --> 00:06:14,890
other as well one more thing I forgot to

129
00:06:14,890 --> 00:06:17,470
mention is unlike malware there's one

130
00:06:17,470 --> 00:06:19,210
with the interesting fact they don't

131
00:06:19,210 --> 00:06:20,919
really need in some of them to infect

132
00:06:20,919 --> 00:06:22,360
the computer all they need is a

133
00:06:22,360 --> 00:06:24,820
JavaScript access to start mining with

134
00:06:24,820 --> 00:06:26,530
your browser so you can just browse to

135
00:06:26,530 --> 00:06:28,510
somewhere they don't need an exploit

136
00:06:28,510 --> 00:06:29,950
they're running anything you will just

137
00:06:29,950 --> 00:06:32,020
stop your computer will start mining

138
00:06:32,020 --> 00:06:39,160
slow so the rise of coal miners again so

139
00:06:39,160 --> 00:06:43,900
we know that mining can damage your

140
00:06:43,900 --> 00:06:47,229
computer hardware but there is also some

141
00:06:47,229 --> 00:06:50,320
clever way to make you reach but also to

142
00:06:50,320 --> 00:06:52,570
warm your home and you and your cat so

143
00:06:52,570 --> 00:06:55,080
that's an example about how to mine

144
00:06:55,080 --> 00:06:58,450
cryptocurrency in your home which could

145
00:06:58,450 --> 00:07:01,780
be also really interesting I think it's

146
00:07:01,780 --> 00:07:03,269
one of their only

147
00:07:03,269 --> 00:07:05,279
efficient ways to actually use crypto

148
00:07:05,279 --> 00:07:10,949
miners okay so before to deep dive into

149
00:07:10,949 --> 00:07:14,849
the song use cases let's define what is

150
00:07:14,849 --> 00:07:17,839
evasion techniques so evasion techniques

151
00:07:17,839 --> 00:07:21,139
mostly all the techniques used to avoid

152
00:07:21,139 --> 00:07:23,819
dynamic static analysis human analysis

153
00:07:23,819 --> 00:07:27,659
also in order to understand the behavior

154
00:07:27,659 --> 00:07:30,899
of software or malware and it's

155
00:07:30,899 --> 00:07:33,360
interesting to understand this concept

156
00:07:33,360 --> 00:07:36,119
because today in modern malware there is

157
00:07:36,119 --> 00:07:37,709
plenty of evasion techniques that are

158
00:07:37,709 --> 00:07:40,129
implemented to avoid detection and

159
00:07:40,129 --> 00:07:43,009
analysis so that's why we can classify

160
00:07:43,009 --> 00:07:45,629
the evasion techniques by the following

161
00:07:45,629 --> 00:07:47,279
so we have on T cell boxing or key

162
00:07:47,279 --> 00:07:49,949
antivirus etc etc there is plenty and

163
00:07:49,949 --> 00:07:52,409
there is new techniques that appears

164
00:07:52,409 --> 00:07:55,679
every day cool so we start with a quick

165
00:07:55,679 --> 00:07:58,769
intro and now let's dig in a bit more

166
00:07:58,769 --> 00:08:00,899
deeper so one of we're gonna do it by

167
00:08:00,899 --> 00:08:02,339
case studies this is the way we are

168
00:08:02,339 --> 00:08:05,179
gonna design it so one of the

169
00:08:05,179 --> 00:08:07,289
interesting fifth toe - that we've seen

170
00:08:07,289 --> 00:08:10,589
called water miner basically a Russian

171
00:08:10,589 --> 00:08:12,919
author schooled with his friends and he

172
00:08:12,919 --> 00:08:16,289
putted crypto mine inside a GTA Mode

173
00:08:16,289 --> 00:08:18,360
something like that forgive me I can't

174
00:08:18,360 --> 00:08:19,889
translate Russian hundred-percent

175
00:08:19,889 --> 00:08:22,349
and basically what they did is it was

176
00:08:22,349 --> 00:08:23,639
chosen right so as soon as someone

177
00:08:23,639 --> 00:08:26,159
started to run the mode the crypto minor

178
00:08:26,159 --> 00:08:27,839
would have been installed on the sides

179
00:08:27,839 --> 00:08:30,479
kind of like a fake Oracle or Intel

180
00:08:30,479 --> 00:08:32,639
products it did some really cool evasive

181
00:08:32,639 --> 00:08:36,328
stuff so first of all XM rig if anyone

182
00:08:36,328 --> 00:08:38,068
doesn't know it it's an open-source tool

183
00:08:38,068 --> 00:08:40,229
to mine Manero XM rig needs some

184
00:08:40,229 --> 00:08:43,198
parameters to run or a config file so

185
00:08:43,198 --> 00:08:44,850
you can see which wallet you are how

186
00:08:44,850 --> 00:08:47,220
many threads etc what they did was

187
00:08:47,220 --> 00:08:48,899
pretty smile was one of the first one to

188
00:08:48,899 --> 00:08:50,819
do it they took the parameters they took

189
00:08:50,819 --> 00:08:52,680
the code and embedded inside the main

190
00:08:52,680 --> 00:08:55,470
crypto minor payload so was it's not

191
00:08:55,470 --> 00:08:57,420
that easy to track and another really

192
00:08:57,420 --> 00:09:00,029
cheeky thing they did is you know the

193
00:09:00,029 --> 00:09:03,149
it's it was a mode for power users for

194
00:09:03,149 --> 00:09:05,550
people who were like cheat on games so

195
00:09:05,550 --> 00:09:07,889
whenever your machine starting to run

196
00:09:07,889 --> 00:09:09,839
slow what do you do you probably open

197
00:09:09,839 --> 00:09:10,790
task manager

198
00:09:10,790 --> 00:09:12,560
or if you're in Russia you're gonna open

199
00:09:12,560 --> 00:09:15,140
end here and basically what they did as

200
00:09:15,140 --> 00:09:17,180
soon as envy or test manager would have

201
00:09:17,180 --> 00:09:19,550
been open the crypto mining process

202
00:09:19,550 --> 00:09:21,650
would have run into a halt so basically

203
00:09:21,650 --> 00:09:23,900
it would have reduced the CPU and you

204
00:09:23,900 --> 00:09:25,520
wouldn't see what's actually stealing

205
00:09:25,520 --> 00:09:28,340
your resources so by the way we've

206
00:09:28,340 --> 00:09:31,400
managed to track the author his name was

207
00:09:31,400 --> 00:09:33,290
Anton you remember the sole name I don't

208
00:09:33,290 --> 00:09:36,260
remember yeah it was name is that was

209
00:09:36,260 --> 00:09:40,160
Anton a we since Antone even of but he

210
00:09:40,160 --> 00:09:41,450
was in Russia so they couldn't really

211
00:09:41,450 --> 00:09:43,760
track him do anything to him but at

212
00:09:43,760 --> 00:09:48,830
least we've shamed him a bit every year

213
00:09:48,830 --> 00:09:51,620
is another crop terminal which is really

214
00:09:51,620 --> 00:09:53,540
interesting too so this one is coming

215
00:09:53,540 --> 00:09:55,940
packed so you can see there is some nice

216
00:09:55,940 --> 00:09:59,840
string into the packet file and if you

217
00:09:59,840 --> 00:10:02,840
if you reverse the the some pores you

218
00:10:02,840 --> 00:10:04,520
can you can see actually that this one

219
00:10:04,520 --> 00:10:08,450
is replacing the wallet address into the

220
00:10:08,450 --> 00:10:10,520
clipboard which is real interesting

221
00:10:10,520 --> 00:10:13,310
because if you don't pay attention the

222
00:10:13,310 --> 00:10:15,950
malware will replace the wallet address

223
00:10:15,950 --> 00:10:18,500
that you copy past and it will replace

224
00:10:18,500 --> 00:10:22,160
this wallet by his own his own wallet

225
00:10:22,160 --> 00:10:24,590
sorry and we can see here that he is

226
00:10:24,590 --> 00:10:27,320
looking for several wallet address which

227
00:10:27,320 --> 00:10:31,610
has btc-e that6 cetera so this kind of

228
00:10:31,610 --> 00:10:33,440
marvel is really interesting and it

229
00:10:33,440 --> 00:10:37,190
comes from with other techniques such as

230
00:10:37,190 --> 00:10:39,590
also Bitcoin stealer

231
00:10:39,590 --> 00:10:41,270
so it will look for the registry for

232
00:10:41,270 --> 00:10:43,010
Bitcoin cutie

233
00:10:43,010 --> 00:10:44,810
it will steal the wallet and it will

234
00:10:44,810 --> 00:10:47,900
also have capabilities to steal the

235
00:10:47,900 --> 00:10:51,440
cookie into into the into the machine

236
00:10:51,440 --> 00:10:53,090
infected machine so this one is really

237
00:10:53,090 --> 00:10:55,430
interesting and it's a real case selling

238
00:10:55,430 --> 00:10:58,580
on several black market so it's still

239
00:10:58,580 --> 00:11:00,830
interesting to study this kind of crop

240
00:11:00,830 --> 00:11:05,510
terminals so as I mentioned it can be a

241
00:11:05,510 --> 00:11:08,210
2018 talk without mentioning wanna cry

242
00:11:08,210 --> 00:11:09,670
but we're not really gonna discuss

243
00:11:09,670 --> 00:11:11,980
right here when one okay first emerge

244
00:11:11,980 --> 00:11:13,990
then there was another pretty much

245
00:11:13,990 --> 00:11:16,750
similar you iwi eeks or whatever you

246
00:11:16,750 --> 00:11:18,250
want to pronounce it I'm really bad at

247
00:11:18,250 --> 00:11:20,470
pronouncing malware names but anyway at

248
00:11:20,470 --> 00:11:22,480
the same time Monica was exploiting your

249
00:11:22,480 --> 00:11:25,810
SMB is eternal blue whatever this was

250
00:11:25,810 --> 00:11:27,880
doing the same was originally originally

251
00:11:27,880 --> 00:11:31,000
originally I ran so much that shifted to

252
00:11:31,000 --> 00:11:33,790
crypto minor and basically the one of

253
00:11:33,790 --> 00:11:36,100
the reason that it was never really

254
00:11:36,100 --> 00:11:38,200
found was never detected probably how

255
00:11:38,200 --> 00:11:40,380
many of you have heard about this before

256
00:11:40,380 --> 00:11:43,290
how many of you heard about Warnock Roy

257
00:11:43,290 --> 00:11:47,050
yep so basically what they did they we

258
00:11:47,050 --> 00:11:48,970
call it they crawl the web look for

259
00:11:48,970 --> 00:11:50,080
anything that's called evasive

260
00:11:50,080 --> 00:11:52,270
techniques some code they can still grab

261
00:11:52,270 --> 00:11:54,280
that code copy paste it put it into the

262
00:11:54,280 --> 00:11:56,740
mail to the main malware and basically

263
00:11:56,740 --> 00:11:58,840
the researchers and everybody were

264
00:11:58,840 --> 00:12:00,580
thinking it might have been one of our

265
00:12:00,580 --> 00:12:02,230
exploiting the SMEs that was actually

266
00:12:02,230 --> 00:12:05,770
ywi X I was really really evasive things

267
00:12:05,770 --> 00:12:09,430
like anti debuggers on T V M on T

268
00:12:09,430 --> 00:12:11,860
sandboxing etc so pretty smart and

269
00:12:11,860 --> 00:12:18,820
effective okay so let's talk about Java

270
00:12:18,820 --> 00:12:21,610
Java Surya adolfo to pronounce anyway

271
00:12:21,610 --> 00:12:24,610
this one is also using several evasion

272
00:12:24,610 --> 00:12:26,740
techniques so first of all is coming

273
00:12:26,740 --> 00:12:30,190
with a fakie code so which is a simple

274
00:12:30,190 --> 00:12:33,300
trick used by malware it's also

275
00:12:33,300 --> 00:12:38,500
infecting every HTML file meaning it it

276
00:12:38,500 --> 00:12:41,110
inject a con I've JavaScript into a into

277
00:12:41,110 --> 00:12:43,840
each HTML file on the system so if you

278
00:12:43,840 --> 00:12:46,030
don't pay attention you run your HTML

279
00:12:46,030 --> 00:12:47,770
file in your web server on production

280
00:12:47,770 --> 00:12:51,340
and you mind cryptocurrencies it also

281
00:12:51,340 --> 00:12:54,400
have capabilities such as on chief

282
00:12:54,400 --> 00:12:57,760
forensic by deleting for example safe

283
00:12:57,760 --> 00:13:00,850
mode or the registry access it also

284
00:13:00,850 --> 00:13:03,910
delayed the backup the dot is oh and

285
00:13:03,910 --> 00:13:06,350
dodgy a show

286
00:13:06,350 --> 00:13:09,380
finally which is actually a fail this

287
00:13:09,380 --> 00:13:12,920
malware is infected every PE file into

288
00:13:12,920 --> 00:13:14,680
the system even the critical file

289
00:13:14,680 --> 00:13:17,840
resulting a crash of the system so here

290
00:13:17,840 --> 00:13:20,480
we have an example so it comes with the

291
00:13:20,480 --> 00:13:24,230
high cone of 360 safe which is not

292
00:13:24,230 --> 00:13:27,530
Chinese antivirus we have an example

293
00:13:27,530 --> 00:13:31,190
about the HTML file modified into the

294
00:13:31,190 --> 00:13:34,190
infected machine here we have an extract

295
00:13:34,190 --> 00:13:37,010
with the antivirus yeah I forgot to talk

296
00:13:37,010 --> 00:13:41,390
about that Java is also redirecting or

297
00:13:41,390 --> 00:13:43,550
the antivirus website to the localhost

298
00:13:43,550 --> 00:13:47,090
to avoid any any gathering data about

299
00:13:47,090 --> 00:13:49,400
about it so we can see here the list we

300
00:13:49,400 --> 00:13:50,990
can see for example values total and

301
00:13:50,990 --> 00:13:54,440
also security website the registry

302
00:13:54,440 --> 00:13:56,540
disabled which is here and the disable

303
00:13:56,540 --> 00:14:02,450
safe good which is just here ok so we

304
00:14:02,450 --> 00:14:05,600
saw some example about evasion technique

305
00:14:05,600 --> 00:14:07,880
such as anti forensic and also injection

306
00:14:07,880 --> 00:14:11,240
etc but there is also a competition

307
00:14:11,240 --> 00:14:15,290
between crop to minors and we're going

308
00:14:15,290 --> 00:14:17,180
to talk about that right now so most of

309
00:14:17,180 --> 00:14:19,820
the most of some crypto minor are using

310
00:14:19,820 --> 00:14:23,360
for example will browse the task manager

311
00:14:23,360 --> 00:14:25,700
to find for example and also threat and

312
00:14:25,700 --> 00:14:28,240
kill the process or they will patch

313
00:14:28,240 --> 00:14:30,230
directly the system to avoid any

314
00:14:30,230 --> 00:14:31,400
affection we are specific

315
00:14:31,400 --> 00:14:35,000
vulnerabilities you might asking

316
00:14:35,000 --> 00:14:37,010
yourself why does they care about

317
00:14:37,010 --> 00:14:39,110
competition so anyone who's done

318
00:14:39,110 --> 00:14:40,940
incident response probably found at

319
00:14:40,940 --> 00:14:42,650
least some computers with like 6 7

320
00:14:42,650 --> 00:14:44,570
Trojans and they're all living together

321
00:14:44,570 --> 00:14:46,550
feasting from the information they can

322
00:14:46,550 --> 00:14:49,190
stay still but crypto mind is kind of

323
00:14:49,190 --> 00:14:51,530
like ransomware they can't live together

324
00:14:51,530 --> 00:14:53,060
because they make the money or for

325
00:14:53,060 --> 00:14:54,650
Mahmoud CPU they actually use and if

326
00:14:54,650 --> 00:14:56,780
someone else taking the CPU first the

327
00:14:56,780 --> 00:14:58,310
user probably going to get annoyed fares

328
00:14:58,310 --> 00:15:01,010
fast and second they're gonna make less

329
00:15:01,010 --> 00:15:04,670
money so one of those crypto miners

330
00:15:04,670 --> 00:15:07,070
really evasive called ghost miner ghost

331
00:15:07,070 --> 00:15:10,190
miner was found spreading via WebLogic

332
00:15:10,190 --> 00:15:12,649
own abilities in oracle sm

333
00:15:12,649 --> 00:15:15,649
a brute-force PHP admin brute-force

334
00:15:15,649 --> 00:15:17,749
mostly focus on Windows system you can

335
00:15:17,749 --> 00:15:20,059
see a quick power shove test looking at

336
00:15:20,059 --> 00:15:21,860
how much network is actually created

337
00:15:21,860 --> 00:15:24,290
from a PowerShell this is the type of

338
00:15:24,290 --> 00:15:25,819
the communication

339
00:15:25,819 --> 00:15:28,790
now of course minor was they built

340
00:15:28,790 --> 00:15:30,860
almost completely in PowerShell

341
00:15:30,860 --> 00:15:33,139
so both the spreading and deploying the

342
00:15:33,139 --> 00:15:35,209
payload first of all they used and

343
00:15:35,209 --> 00:15:37,069
invoke reflective Pia injection from

344
00:15:37,069 --> 00:15:39,949
power sploit so you can easily inject

345
00:15:39,949 --> 00:15:42,230
now really interesting to see was the

346
00:15:42,230 --> 00:15:45,319
first generation of ghost miner wasn't

347
00:15:45,319 --> 00:15:48,050
really using PowerShell almost and it

348
00:15:48,050 --> 00:15:49,399
was really easily detected by the

349
00:15:49,399 --> 00:15:52,759
majority of IVs and other tools and the

350
00:15:52,759 --> 00:15:54,290
second generation when he was very

351
00:15:54,290 --> 00:15:56,480
discovered wasn't detected almost at all

352
00:15:56,480 --> 00:15:57,769
at least from the products we've been

353
00:15:57,769 --> 00:16:00,259
able to test so it shows the evasiveness

354
00:16:00,259 --> 00:16:03,800
and how much important it is now for

355
00:16:03,800 --> 00:16:06,230
main topic here basically ghost miner

356
00:16:06,230 --> 00:16:08,209
was really really vicious against its

357
00:16:08,209 --> 00:16:10,459
competitors and whoever created this did

358
00:16:10,459 --> 00:16:12,559
a really major research they look for

359
00:16:12,559 --> 00:16:14,779
things like static names for other

360
00:16:14,779 --> 00:16:16,550
crypto miners they look for open-source

361
00:16:16,550 --> 00:16:19,370
tool they would delete and kill any

362
00:16:19,370 --> 00:16:21,559
process related to crypto miners kill

363
00:16:21,559 --> 00:16:24,370
any scheduled tasks delete services etc

364
00:16:24,370 --> 00:16:27,379
now what we did basically we

365
00:16:27,379 --> 00:16:30,079
reverse-engineer the code and we were

366
00:16:30,079 --> 00:16:33,139
able to create an open-source PowerShell

367
00:16:33,139 --> 00:16:34,610
script that does actually the opposite

368
00:16:34,610 --> 00:16:36,410
is going to help red teamers and

369
00:16:36,410 --> 00:16:40,040
defenders to to fight against other

370
00:16:40,040 --> 00:16:42,319
people miners basically what happens

371
00:16:42,319 --> 00:16:44,899
here we have the this discussed XM rig

372
00:16:44,899 --> 00:16:47,059
miner running in the background and

373
00:16:47,059 --> 00:16:49,100
basically as soon as will run the miner

374
00:16:49,100 --> 00:16:51,889
killer script it will find that miner

375
00:16:51,889 --> 00:16:54,079
and kill life now if you do decide to

376
00:16:54,079 --> 00:16:56,480
use it it's up on github use it with

377
00:16:56,480 --> 00:16:58,370
caution may be one of the IT guys that

378
00:16:58,370 --> 00:17:00,439
actually deployed for miners will get

379
00:17:00,439 --> 00:17:02,600
annoyed by you or you kill supplications

380
00:17:02,600 --> 00:17:04,520
so again used with caution and you can

381
00:17:04,520 --> 00:17:06,589
see that the miner was killed right away

382
00:17:06,589 --> 00:17:08,898
all open source you can have a look at

383
00:17:08,898 --> 00:17:15,199
that regarding competition difficulties

384
00:17:15,199 --> 00:17:18,289
and also another crop Tomiko to minors

385
00:17:18,289 --> 00:17:20,970
so this one was

386
00:17:20,970 --> 00:17:23,490
coming after the one aqua infection and

387
00:17:23,490 --> 00:17:26,040
spreading with the same vulnerability

388
00:17:26,040 --> 00:17:28,740
eternal blue it was actually not

389
00:17:28,740 --> 00:17:30,570
embedded directly into the the some

390
00:17:30,570 --> 00:17:32,910
parts but spreading manually and we can

391
00:17:32,910 --> 00:17:35,040
see here so we will reverse engineering

392
00:17:35,040 --> 00:17:37,140
the the some pores at McAfee and there

393
00:17:37,140 --> 00:17:39,960
is the first one we saw the some part

394
00:17:39,960 --> 00:17:44,520
was in up trail 2017 and after one

395
00:17:44,520 --> 00:17:46,260
acquire infection the one spreading with

396
00:17:46,260 --> 00:17:48,690
the eternal blue and we compared the

397
00:17:48,690 --> 00:17:50,820
same function the function of the the

398
00:17:50,820 --> 00:17:54,060
both samples and it was actually almost

399
00:17:54,060 --> 00:17:57,330
the same and this one he was willing to

400
00:17:57,330 --> 00:17:59,640
receive because it was using also a

401
00:17:59,640 --> 00:18:03,840
small batch script to patch the sed PO

402
00:18:03,840 --> 00:18:06,570
to avoid any other infection via the

403
00:18:06,570 --> 00:18:08,550
eternal blue exploit it's kind of

404
00:18:08,550 --> 00:18:09,870
interesting what do you prefer getting

405
00:18:09,870 --> 00:18:11,910
around somewhere from the exploit or

406
00:18:11,910 --> 00:18:17,490
getting a crypto miners okay there is

407
00:18:17,490 --> 00:18:20,790
also also a very technique especially

408
00:18:20,790 --> 00:18:24,660
for crypto minor so for example they can

409
00:18:24,660 --> 00:18:27,090
use they can limit the CPU utilization

410
00:18:27,090 --> 00:18:29,910
to avoid detection so for example when

411
00:18:29,910 --> 00:18:32,070
you look at the when you look at the

412
00:18:32,070 --> 00:18:35,640
task manager you see the CPU but there

413
00:18:35,640 --> 00:18:41,370
is no over you say over over CPU usage

414
00:18:41,370 --> 00:18:45,120
so they can they can change that they

415
00:18:45,120 --> 00:18:48,180
can also enable the mining process on

416
00:18:48,180 --> 00:18:51,930
specific hours see if you go to lunch

417
00:18:51,930 --> 00:18:54,180
the malware will see that you are not in

418
00:18:54,180 --> 00:18:56,640
front of your computer and will mine we

419
00:18:56,640 --> 00:18:59,280
start the mining process and and they

420
00:18:59,280 --> 00:19:01,890
can also for example I used mining

421
00:19:01,890 --> 00:19:04,110
process in several area so if you for

422
00:19:04,110 --> 00:19:05,820
example let your computer on during the

423
00:19:05,820 --> 00:19:09,540
night the miner can wake up and use the

424
00:19:09,540 --> 00:19:14,820
the resources of your computer so just

425
00:19:14,820 --> 00:19:17,760
to recap a bit what we saw in this

426
00:19:17,760 --> 00:19:19,290
presentation about the evasive

427
00:19:19,290 --> 00:19:22,560
techniques so mostly we can see that the

428
00:19:22,560 --> 00:19:24,870
the samples to die HDD for that

429
00:19:24,870 --> 00:19:28,650
presentation was using Packers like most

430
00:19:28,650 --> 00:19:30,420
of the malware but also process

431
00:19:30,420 --> 00:19:32,850
injection and also auntie

432
00:19:32,850 --> 00:19:35,910
Nitori which is makes sense because when

433
00:19:35,910 --> 00:19:37,860
you when you when you have a crypto

434
00:19:37,860 --> 00:19:40,560
miners what they want it's not to be

435
00:19:40,560 --> 00:19:42,930
detected so if they use ot monitoring

436
00:19:42,930 --> 00:19:46,140
techniques for example to disable the

437
00:19:46,140 --> 00:19:48,810
the task manager or to disable the

438
00:19:48,810 --> 00:19:51,540
registry they will they will have more

439
00:19:51,540 --> 00:19:54,420
time to to mine to use the resources of

440
00:19:54,420 --> 00:19:56,520
your computer yeah we make kind of a

441
00:19:56,520 --> 00:19:58,110
small table here is showing the case

442
00:19:58,110 --> 00:19:59,700
studies in which evasive techniques each

443
00:19:59,700 --> 00:20:02,100
one of them used if anyone wants to

444
00:20:02,100 --> 00:20:04,020
research themself will be able to share

445
00:20:04,020 --> 00:20:05,580
their samples maybe you'll find some

446
00:20:05,580 --> 00:20:10,350
evasion tactics yeah so basically you

447
00:20:10,350 --> 00:20:12,570
know as I said we gotta give you some

448
00:20:12,570 --> 00:20:15,150
defensive to defensive tactics so one of

449
00:20:15,150 --> 00:20:17,040
the major thing we recommend is to Pony

450
00:20:17,040 --> 00:20:19,920
to office I CPU activity in your network

451
00:20:19,920 --> 00:20:21,930
and your device says it's not that easy

452
00:20:21,930 --> 00:20:23,550
but there's some really cool tools to do

453
00:20:23,550 --> 00:20:26,280
it basically either you found a crypto

454
00:20:26,280 --> 00:20:27,660
miners you've got an application that's

455
00:20:27,660 --> 00:20:29,130
running really bad here you need to add

456
00:20:29,130 --> 00:20:31,650
some CPUs so it's not a bad thing to do

457
00:20:31,650 --> 00:20:33,510
anyway second thing there's a link here

458
00:20:33,510 --> 00:20:35,760
for the miner killer either you can take

459
00:20:35,760 --> 00:20:37,980
it and use it again with caution or you

460
00:20:37,980 --> 00:20:39,900
can understand what where the things

461
00:20:39,900 --> 00:20:41,730
that we're looking for and maybe build

462
00:20:41,730 --> 00:20:45,390
some tools yourself you can also find on

463
00:20:45,390 --> 00:20:49,830
our github yahwah rule for detecting

464
00:20:49,830 --> 00:20:52,110
money rule which is a basic one to

465
00:20:52,110 --> 00:20:56,010
detect Munir activity also it's good to

466
00:20:56,010 --> 00:20:58,050
monitoring your traffic for example miss

467
00:20:58,050 --> 00:21:01,950
not rules or this kind of tools you can

468
00:21:01,950 --> 00:21:04,110
monitoring your traffic for crypto

469
00:21:04,110 --> 00:21:06,150
currency transaction or mining traffic

470
00:21:06,150 --> 00:21:09,150
and there is also the current block

471
00:21:09,150 --> 00:21:10,830
yoli's which is really cool because this

472
00:21:10,830 --> 00:21:13,200
list is actually

473
00:21:13,200 --> 00:21:16,560
getting all the website using crypto

474
00:21:16,560 --> 00:21:20,370
minor we just connive or others and it's

475
00:21:20,370 --> 00:21:22,500
actually a cool demo for that so it's

476
00:21:22,500 --> 00:21:26,910
basically it's basically just how to

477
00:21:26,910 --> 00:21:29,490
implement the list on on your firewall

478
00:21:29,490 --> 00:21:32,460
and then on to who you you create the

479
00:21:32,460 --> 00:21:36,240
routes or the or the crypto minor from

480
00:21:36,240 --> 00:21:38,670
specific website will be blocked by the

481
00:21:38,670 --> 00:21:40,680
by the firewall it's such a simple to

482
00:21:40,680 --> 00:21:44,610
simple obvious a simple task that you

483
00:21:44,610 --> 00:21:46,740
can do and you can spread it for your

484
00:21:46,740 --> 00:21:49,110
order network it's a good list on gear

485
00:21:49,110 --> 00:21:51,420
up it's basically maintained by a single

486
00:21:51,420 --> 00:21:54,120
guy in Germany crazy guy 0 dot but we

487
00:21:54,120 --> 00:21:55,530
should follow him and it's really really

488
00:21:55,530 --> 00:21:58,020
effective because majority of crypto -

489
00:21:58,020 --> 00:22:01,050
do have some known domains this the less

490
00:22:01,050 --> 00:22:03,510
sophisticated ones so in this here you

491
00:22:03,510 --> 00:22:05,550
can basically see how we implemented in

492
00:22:05,550 --> 00:22:07,500
a little snitch and now it's easily to

493
00:22:07,500 --> 00:22:12,060
get it's blocking other crypto miners so

494
00:22:12,060 --> 00:22:14,430
basically if we're into the kind of the

495
00:22:14,430 --> 00:22:16,680
gambling here so what things we can

496
00:22:16,680 --> 00:22:18,960
expect in the future obviously at least

497
00:22:18,960 --> 00:22:20,970
from our perspective we see that crypto

498
00:22:20,970 --> 00:22:22,380
matters isn't gonna search even farther

499
00:22:22,380 --> 00:22:24,750
we see more and more attackers are using

500
00:22:24,750 --> 00:22:27,930
it we actually finger because the molero

501
00:22:27,930 --> 00:22:29,970
price and bitcoin price decreased a bit

502
00:22:29,970 --> 00:22:34,020
attackers have more incentive to get and

503
00:22:34,020 --> 00:22:35,580
find more computers and increase their

504
00:22:35,580 --> 00:22:38,310
botnets so it's something we're gonna

505
00:22:38,310 --> 00:22:41,100
see we probably gonna system or what we

506
00:22:41,100 --> 00:22:43,380
call unhandled devices things that are

507
00:22:43,380 --> 00:22:45,000
less money - it looks like your

508
00:22:45,000 --> 00:22:46,890
raspberries your light bulbs your

509
00:22:46,890 --> 00:22:48,660
refrigerator gonna get attacked and

510
00:22:48,660 --> 00:22:51,180
probably gonna get deployed by crypto

511
00:22:51,180 --> 00:22:57,360
miners on them we can also see also we

512
00:22:57,360 --> 00:23:00,140
talked we talked about it a bit before

513
00:23:00,140 --> 00:23:03,060
there is also some move from cyber

514
00:23:03,060 --> 00:23:05,580
criminals so for example some minor we

515
00:23:05,580 --> 00:23:07,110
will present during this tour such as

516
00:23:07,110 --> 00:23:11,040
Joe acaba was actually originally a

517
00:23:11,040 --> 00:23:11,760
ransomware

518
00:23:11,760 --> 00:23:14,280
and giotto of decided to move to crop to

519
00:23:14,280 --> 00:23:17,640
crop to minor there is also some past

520
00:23:17,640 --> 00:23:19,020
example we

521
00:23:19,020 --> 00:23:22,040
Braddock's and trig boat which was

522
00:23:22,040 --> 00:23:25,230
starting to target cryptocurrency wallet

523
00:23:25,230 --> 00:23:28,860
and cryptocurrencies user regarding if

524
00:23:28,860 --> 00:23:31,680
we if we go further in in the future

525
00:23:31,680 --> 00:23:35,100
regarding the attacks into the

526
00:23:35,100 --> 00:23:38,010
blockchain there is like the majority

527
00:23:38,010 --> 00:23:40,170
attack which was already the case with

528
00:23:40,170 --> 00:23:42,840
the verge coin and the BTC guard so I

529
00:23:42,840 --> 00:23:45,480
will go more in detail for for this one

530
00:23:45,480 --> 00:23:48,000
for it an example about our intent and

531
00:23:48,000 --> 00:23:49,530
devices were already starting to see

532
00:23:49,530 --> 00:23:52,560
kind of the first box of that trend is

533
00:23:52,560 --> 00:23:55,800
an ADB miner based looking for debug

534
00:23:55,800 --> 00:23:58,200
your ports for Android and then when it

535
00:23:58,200 --> 00:23:59,940
finds them probably like shout and stuff

536
00:23:59,940 --> 00:24:01,890
like that or scanning then the net

537
00:24:01,890 --> 00:24:03,810
they're gonna get install installing the

538
00:24:03,810 --> 00:24:06,840
miner which is interesting here is to

539
00:24:06,840 --> 00:24:08,790
observe the rise of botnet miner

540
00:24:08,790 --> 00:24:12,630
so it's it will be much more common to

541
00:24:12,630 --> 00:24:15,000
see botnet miner in the future because

542
00:24:15,000 --> 00:24:16,680
it's much more profitable for cyber

543
00:24:16,680 --> 00:24:20,040
criminals regarding the majority attack

544
00:24:20,040 --> 00:24:21,600
so basically the majority attack will

545
00:24:21,600 --> 00:24:23,820
influence the blockchain integrity and

546
00:24:23,820 --> 00:24:26,250
with the rise of botnet magnetars it

547
00:24:26,250 --> 00:24:28,800
could be more common in the future so

548
00:24:28,800 --> 00:24:31,680
what is the majority attack exactly it's

549
00:24:31,680 --> 00:24:35,250
the case where cyber criminals or

550
00:24:35,250 --> 00:24:38,790
malicious actors will get more than 51%

551
00:24:38,790 --> 00:24:41,100
of the network meaning they can

552
00:24:41,100 --> 00:24:44,280
influence the the blockchain by forging

553
00:24:44,280 --> 00:24:47,010
their own blocks of create their own

554
00:24:47,010 --> 00:24:50,490
transaction or also can sell the real

555
00:24:50,490 --> 00:24:52,890
transaction so it with the rise of

556
00:24:52,890 --> 00:24:53,790
botnet miners

557
00:24:53,790 --> 00:24:56,880
it could be more more common in the

558
00:24:56,880 --> 00:24:59,550
future so just a quick recap because we

559
00:24:59,550 --> 00:25:01,800
went through some funds from some topic

560
00:25:01,800 --> 00:25:03,180
so we start with kind of the trend the

561
00:25:03,180 --> 00:25:06,510
rise of crypto - we then we then went to

562
00:25:06,510 --> 00:25:08,220
bit into the rabbit all about some case

563
00:25:08,220 --> 00:25:09,840
studies about what are those evasive

564
00:25:09,840 --> 00:25:12,840
techniques they used we look at evasive

565
00:25:12,840 --> 00:25:14,640
techniques and competition between those

566
00:25:14,640 --> 00:25:15,710
the miners

567
00:25:15,710 --> 00:25:18,000
hopefully we offered some good and

568
00:25:18,000 --> 00:25:20,250
defensive tactics let us know if it

569
00:25:20,250 --> 00:25:20,910
worked for you

570
00:25:20,910 --> 00:25:23,490
and we went for a bit just right now and

571
00:25:23,490 --> 00:25:27,390
exploring some future trends all right

572
00:25:27,390 --> 00:25:30,980
thank you very much for your attention

573
00:25:35,570 --> 00:25:39,260
so now we hope you enjoyed the talk so

574
00:25:39,260 --> 00:25:40,670
if you have any question feel free to

575
00:25:40,670 --> 00:25:43,310
reach out to us even after the talk on

576
00:25:43,310 --> 00:25:46,790
on Twitter or LinkedIn anyway so anyone

577
00:25:46,790 --> 00:25:51,820
have any questions I try it's gonna

578
00:25:51,820 --> 00:26:00,920
beautiful ones all right if anyone have

579
00:26:00,920 --> 00:26:02,540
any questions you can come to a softer

580
00:26:02,540 --> 00:26:05,379
and thank you

