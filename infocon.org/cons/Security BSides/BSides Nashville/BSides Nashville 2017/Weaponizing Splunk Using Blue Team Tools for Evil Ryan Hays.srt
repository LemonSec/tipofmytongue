1
00:00:03,890 --> 00:00:07,259
alright<font color="#E5E5E5"> guys I think everybody is in</font>

2
00:00:06,420 --> 00:00:10,650
here that's<font color="#E5E5E5"> going to be in here</font>

3
00:00:07,259 --> 00:00:12,360
hopefully or they'll miss out but i'll

4
00:00:10,650 --> 00:00:13,590
go ahead and get<font color="#E5E5E5"> started so I name is</font>

5
00:00:12,360 --> 00:00:16,710
Ryan I'm going<font color="#E5E5E5"> to be talked about</font>

6
00:00:13,590 --> 00:00:18,570
weaponizing<font color="#CCCCCC"> splunk a little bit about</font>

7
00:00:16,710 --> 00:00:20,699
myself on the director<font color="#E5E5E5"> of security</font>

8
00:00:18,570 --> 00:00:22,590
engineering at CVG security for a

9
00:00:20,699 --> 00:00:25,800
consulting firm out of<font color="#E5E5E5"> Boston and we</font>

10
00:00:22,590 --> 00:00:27,869
specialize<font color="#CCCCCC"> in all sense of security some</font>

11
00:00:25,800 --> 00:00:29,099
certs up there hopefully<font color="#E5E5E5"> means I know a</font>

12
00:00:27,869 --> 00:00:33,480
little<font color="#E5E5E5"> bit about what I'm talking about</font>

13
00:00:29,099 --> 00:00:35,100
I don't know so this talk came from last

14
00:00:33,480 --> 00:00:37,099
year my<font color="#CCCCCC"> team and I were on</font><font color="#E5E5E5"> an engagement</font>

15
00:00:35,100 --> 00:00:40,079
we had gotten<font color="#E5E5E5"> into access to the</font>

16
00:00:37,100 --> 00:00:42,920
organization um and during recon and

17
00:00:40,079 --> 00:00:45,870
enumeration we found a spunk server

18
00:00:42,920 --> 00:00:48,420
really cool we navigated it navigated to

19
00:00:45,870 --> 00:00:50,788
it and it was<font color="#E5E5E5"> very nice to</font><font color="#CCCCCC"> us and just</font>

20
00:00:48,420 --> 00:00:53,190
logged us right in and load this right

21
00:00:50,789 --> 00:00:55,949
in as admin so like that's<font color="#E5E5E5"> awesome but</font>

22
00:00:53,190 --> 00:00:57,718
what can<font color="#CCCCCC"> I do with this so we built a</font>

23
00:00:55,949 --> 00:01:01,199
custom application we installed that it

24
00:00:57,719 --> 00:01:03,899
allowed us to get root<font color="#E5E5E5"> access on the</font>

25
00:01:01,199 --> 00:01:05,850
machine that we were on and then we

26
00:01:03,899 --> 00:01:07,680
thought hey how can<font color="#E5E5E5"> I expand this out</font>

27
00:01:05,850 --> 00:01:09,360
how can I<font color="#CCCCCC"> get more access into the</font><font color="#E5E5E5"> into</font>

28
00:01:07,680 --> 00:01:11,549
the internal network of the organization

29
00:01:09,360 --> 00:01:12,900
so we build more custom applications and

30
00:01:11,549 --> 00:01:14,640
then we utilize the functionality of

31
00:01:12,900 --> 00:01:17,640
spunk to deploy ease out at every system

32
00:01:14,640 --> 00:01:19,200
in the organization and within about you

33
00:01:17,640 --> 00:01:20,970
know a few minutes<font color="#E5E5E5"> we had you know</font>

34
00:01:19,200 --> 00:01:22,890
domain admin and we had to access every

35
00:01:20,970 --> 00:01:24,150
box in the organization that's kind of

36
00:01:22,890 --> 00:01:25,920
where this whole thing came from<font color="#E5E5E5"> and I'm</font>

37
00:01:24,150 --> 00:01:28,290
going to<font color="#E5E5E5"> go through the steps of what we</font>

38
00:01:25,920 --> 00:01:31,890
did to actually build those and you know

39
00:01:28,290 --> 00:01:32,970
exploit the organization so we're going

40
00:01:31,890 --> 00:01:34,259
to<font color="#CCCCCC"> start out them to talk a little</font><font color="#E5E5E5"> bit</font>

41
00:01:32,970 --> 00:01:35,880
about<font color="#CCCCCC"> splunk and some of the basic</font>

42
00:01:34,259 --> 00:01:38,009
functionality this Punk has three you

43
00:01:35,880 --> 00:01:40,289
guys know exactly what<font color="#E5E5E5"> I'm doing during</font>

44
00:01:38,009 --> 00:01:41,909
<font color="#E5E5E5">the talk on some of the</font>

45
00:01:40,290 --> 00:01:43,740
misconfigurations that we see just the

46
00:01:41,909 --> 00:01:45,299
basic stuff and then<font color="#E5E5E5"> I'll actually talk</font>

47
00:01:43,740 --> 00:01:46,770
<font color="#E5E5E5">about what what I mean when I talk about</font>

48
00:01:45,299 --> 00:01:48,600
weaponizing spunk there's basically

49
00:01:46,770 --> 00:01:50,369
three attack surfaces we're going to be

50
00:01:48,600 --> 00:01:51,658
attacking<font color="#E5E5E5"> the server attacking the</font>

51
00:01:50,369 --> 00:01:53,390
organization<font color="#E5E5E5"> that will be the lateral</font>

52
00:01:51,659 --> 00:01:56,909
movement and then attacking the data

53
00:01:53,390 --> 00:01:58,860
that last part is more moving away from

54
00:01:56,909 --> 00:02:00,930
<font color="#E5E5E5">actually using a customer slunk instance</font>

55
00:01:58,860 --> 00:02:03,060
to utilizing your own spunk instance um

56
00:02:00,930 --> 00:02:04,979
during<font color="#CCCCCC"> a pen test we generate tons and</font>

57
00:02:03,060 --> 00:02:06,600
tons and tons of data and it takes time

58
00:02:04,979 --> 00:02:08,250
<font color="#E5E5E5">to review all that data and generate the</font>

59
00:02:06,600 --> 00:02:10,470
report everybody hates that part I know

60
00:02:08,250 --> 00:02:12,569
I hate that<font color="#E5E5E5"> part it's the stores part of</font>

61
00:02:10,470 --> 00:02:13,670
it so if utilized spoke to bring in all

62
00:02:12,569 --> 00:02:15,260
<font color="#E5E5E5">that data we can</font>

63
00:02:13,670 --> 00:02:17,540
to speed<font color="#E5E5E5"> up that process and it actually</font>

64
00:02:15,260 --> 00:02:18,950
speeds up your attack as well so<font color="#CCCCCC"> I'll</font>

65
00:02:17,540 --> 00:02:20,060
talk<font color="#E5E5E5"> about that and then the finally I'm</font>

66
00:02:18,950 --> 00:02:22,069
going<font color="#E5E5E5"> to wrap it all up with mitigating</font>

67
00:02:20,060 --> 00:02:23,720
actions a lot<font color="#E5E5E5"> of the stuff spunks</font>

68
00:02:22,069 --> 00:02:26,060
already put together<font color="#E5E5E5"> for you people just</font>

69
00:02:23,720 --> 00:02:27,319
don't read the documentation um so we'll

70
00:02:26,060 --> 00:02:29,090
kind<font color="#E5E5E5"> of talk about that just real quick</font>

71
00:02:27,319 --> 00:02:30,440
at the<font color="#CCCCCC"> end because if</font><font color="#E5E5E5"> I tell</font><font color="#CCCCCC"> you how to</font>

72
00:02:29,090 --> 00:02:34,670
attack it I<font color="#CCCCCC"> need to at least give you</font>

73
00:02:30,440 --> 00:02:37,220
some options<font color="#E5E5E5"> on how</font><font color="#CCCCCC"> to fix it so what is</font>

74
00:02:34,670 --> 00:02:39,380
<font color="#CCCCCC">funk it's a wall decoration and</font>

75
00:02:37,220 --> 00:02:40,970
correlation tool it's very<font color="#E5E5E5"> powerful has</font>

76
00:02:39,380 --> 00:02:43,130
the expandability through what they call

77
00:02:40,970 --> 00:02:44,959
applications and all these applications

78
00:02:43,130 --> 00:02:47,810
written in a lot of<font color="#CCCCCC"> different scripting</font>

79
00:02:44,959 --> 00:02:51,560
language languages<font color="#CCCCCC"> Python Perl bash</font>

80
00:02:47,810 --> 00:02:53,360
PowerShell things like that the nice

81
00:02:51,560 --> 00:02:55,670
thing about the applications is it gives

82
00:02:53,360 --> 00:02:58,010
me command execution on that host I can

83
00:02:55,670 --> 00:02:59,569
run anything I hand it and there's

84
00:02:58,010 --> 00:03:00,768
really nothing to stop<font color="#E5E5E5"> you your phone as</font>

85
00:02:59,569 --> 00:03:05,119
long<font color="#E5E5E5"> as you have the right privileges on</font>

86
00:03:00,769 --> 00:03:06,769
the application so some<font color="#CCCCCC"> things some</font>

87
00:03:05,120 --> 00:03:07,760
functions within<font color="#CCCCCC"> splunk that we're going</font>

88
00:03:06,769 --> 00:03:11,209
<font color="#E5E5E5">to talk about later on in the</font>

89
00:03:07,760 --> 00:03:12,709
presentation one aspect of swamp since

90
00:03:11,209 --> 00:03:14,330
it needs<font color="#E5E5E5"> to gather all this data it</font>

91
00:03:12,709 --> 00:03:16,910
needs to have a way to get to data right

92
00:03:14,330 --> 00:03:19,160
so a lot of applications<font color="#CCCCCC"> offer</font><font color="#E5E5E5"> syslog so</font>

93
00:03:16,910 --> 00:03:21,200
it'll send in the logs your network

94
00:03:19,160 --> 00:03:22,489
appliances and stuff all<font color="#CCCCCC"> offer</font><font color="#E5E5E5"> that but</font>

95
00:03:21,200 --> 00:03:24,140
some of the applications such as you

96
00:03:22,489 --> 00:03:26,420
know<font color="#CCCCCC"> just windows in general it doesn't</font>

97
00:03:24,140 --> 00:03:28,190
offer syslog so slut gives you a

98
00:03:26,420 --> 00:03:31,130
universal forwarder that will install

99
00:03:28,190 --> 00:03:32,450
<font color="#CCCCCC">the operating system collects all these</font>

100
00:03:31,130 --> 00:03:35,060
logs that we're talking about<font color="#E5E5E5"> they're</font>

101
00:03:32,450 --> 00:03:37,010
already on the<font color="#E5E5E5"> host and then also again</font>

102
00:03:35,060 --> 00:03:40,090
is expandable by applications and gives

103
00:03:37,010 --> 00:03:43,070
you command execution it's<font color="#E5E5E5"> really nice</font>

104
00:03:40,090 --> 00:03:44,810
all these<font color="#E5E5E5"> Universal forwarders are</font>

105
00:03:43,070 --> 00:03:46,608
controlled by what's called a deployment

106
00:03:44,810 --> 00:03:48,680
server so the deployment server

107
00:03:46,609 --> 00:03:50,660
basically allows you to collect all

108
00:03:48,680 --> 00:03:52,790
these get over supporters they allow you

109
00:03:50,660 --> 00:03:57,920
to<font color="#E5E5E5"> split them up into you know different</font>

110
00:03:52,790 --> 00:03:59,720
categories um yeah basically different

111
00:03:57,920 --> 00:04:01,819
<font color="#CCCCCC">categories but based on host names or</font>

112
00:03:59,720 --> 00:04:04,340
operating systems this just helps<font color="#E5E5E5"> you</font>

113
00:04:01,819 --> 00:04:06,018
manage the deployment so that you know

114
00:04:04,340 --> 00:04:07,670
if I'm if I'm<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at a Windows</font>

115
00:04:06,019 --> 00:04:09,170
application<font color="#CCCCCC"> I'm only employing Windows</font>

116
00:04:07,670 --> 00:04:10,638
applications out the windows hosts and

117
00:04:09,170 --> 00:04:16,548
not to pull out to linux boxes and

118
00:04:10,639 --> 00:04:17,959
things like that um yep so who's just

119
00:04:16,548 --> 00:04:20,060
what the deployment server looks like I

120
00:04:17,959 --> 00:04:24,770
get my clients I can<font color="#E5E5E5"> break them up into</font>

121
00:04:20,060 --> 00:04:26,570
classes which is the category and then I

122
00:04:24,770 --> 00:04:27,200
decide the applications that<font color="#E5E5E5"> go to</font>

123
00:04:26,570 --> 00:04:28,940
classes

124
00:04:27,200 --> 00:04:31,729
the classes decided with applications

125
00:04:28,940 --> 00:04:33,890
got to which hosts so that's basically

126
00:04:31,730 --> 00:04:35,120
<font color="#CCCCCC">splunk in a nutshell oh you know if you</font>

127
00:04:33,890 --> 00:04:36,979
guys have any questions or if i'm going

128
00:04:35,120 --> 00:04:38,120
<font color="#E5E5E5">to quickly raise a hand ask some</font>

129
00:04:36,980 --> 00:04:41,570
questions<font color="#CCCCCC"> i</font><font color="#E5E5E5"> don't mind the dialogue</font>

130
00:04:38,120 --> 00:04:43,280
<font color="#E5E5E5">while I'm talking so the Mets</font>

131
00:04:41,570 --> 00:04:45,200
configurations that everyone sees on the

132
00:04:43,280 --> 00:04:46,400
older versions that's plunked<font color="#E5E5E5"> the one</font>

133
00:04:45,200 --> 00:04:48,080
that<font color="#CCCCCC"> i was talking</font><font color="#E5E5E5"> about earlier i think</font>

134
00:04:46,400 --> 00:04:49,340
it was for dot<font color="#E5E5E5"> five these have been</font>

135
00:04:48,080 --> 00:04:50,570
<font color="#E5E5E5">fixed in the new one did that</font>

136
00:04:49,340 --> 00:04:52,549
automatically logged you in if you

137
00:04:50,570 --> 00:04:54,320
didn't have credentials set up the

138
00:04:52,550 --> 00:04:56,990
default passwords admin and<font color="#CCCCCC"> change</font><font color="#E5E5E5"> me</font>

139
00:04:54,320 --> 00:04:58,760
every version prior<font color="#CCCCCC"> to six dot five</font>

140
00:04:56,990 --> 00:05:00,200
which is the current release didn't

141
00:04:58,760 --> 00:05:01,700
require you to set that password it

142
00:05:00,200 --> 00:05:05,719
automatically had it configured for you

143
00:05:01,700 --> 00:05:06,890
so it's grown into that um<font color="#CCCCCC"> ssl is</font>

144
00:05:05,720 --> 00:05:08,600
another one is to check in the box

145
00:05:06,890 --> 00:05:11,360
nobody ever<font color="#E5E5E5"> checks the box though unless</font>

146
00:05:08,600 --> 00:05:12,530
<font color="#E5E5E5">you call them on it so if there's no ssl</font>

147
00:05:11,360 --> 00:05:14,210
configured you can do man-in-the-middle

148
00:05:12,530 --> 00:05:17,419
attacks<font color="#E5E5E5"> as long as your internal the</font>

149
00:05:14,210 --> 00:05:19,520
network already and then<font color="#E5E5E5"> always spoke</font><font color="#CCCCCC"> i</font>

150
00:05:17,420 --> 00:05:21,440
find this every single organization i go

151
00:05:19,520 --> 00:05:22,849
into maybe the smoke application is

152
00:05:21,440 --> 00:05:24,680
<font color="#CCCCCC">there running his route but all those</font>

153
00:05:22,850 --> 00:05:26,750
<font color="#CCCCCC">universal forwarders they will be and</font>

154
00:05:24,680 --> 00:05:29,510
that's<font color="#E5E5E5"> actually the key to the entire</font>

155
00:05:26,750 --> 00:05:31,610
attack so smoke is always going<font color="#E5E5E5"> to be</font>

156
00:05:29,510 --> 00:05:33,680
running as a privileged user unless you

157
00:05:31,610 --> 00:05:38,600
<font color="#E5E5E5">have a you know reputable organization</font>

158
00:05:33,680 --> 00:05:40,430
install it for you may be like oh so the

159
00:05:38,600 --> 00:05:41,960
<font color="#CCCCCC">lesson I think spoke so there's three</font>

160
00:05:40,430 --> 00:05:43,100
attack surfaces<font color="#CCCCCC"> I talked about earlier</font>

161
00:05:41,960 --> 00:05:45,020
attacking the server attacking the

162
00:05:43,100 --> 00:05:47,690
organization at second data packet of

163
00:05:45,020 --> 00:05:49,460
server is I have<font color="#CCCCCC"> accessed that server I</font>

164
00:05:47,690 --> 00:05:51,350
have those admin credentials somehow I

165
00:05:49,460 --> 00:05:52,909
got them either through credential reuse

166
00:05:51,350 --> 00:05:55,130
or one of those misconfigurations that I

167
00:05:52,910 --> 00:05:56,060
just talked<font color="#CCCCCC"> about um the</font><font color="#E5E5E5"> first thing you</font>

168
00:05:55,130 --> 00:05:57,469
want to do is you want to<font color="#E5E5E5"> know your</font>

169
00:05:56,060 --> 00:05:59,930
environment so look at the logs that are

170
00:05:57,470 --> 00:06:01,820
already in<font color="#CCCCCC"> spa</font><font color="#E5E5E5"> are their windows logs</font>

171
00:05:59,930 --> 00:06:05,120
can I can<font color="#E5E5E5"> I look at those those windows</font>

172
00:06:01,820 --> 00:06:06,950
logs things like that um spunk allows

173
00:06:05,120 --> 00:06:08,840
you to read in fought from<font color="#E5E5E5"> the operating</font>

174
00:06:06,950 --> 00:06:10,909
system the local hosts that<font color="#E5E5E5"> you're on so</font>

175
00:06:08,840 --> 00:06:13,969
let's start<font color="#E5E5E5"> pulling in and</font><font color="#CCCCCC"> files at p</font>

176
00:06:10,910 --> 00:06:15,920
shadow if you are SE password groups

177
00:06:13,970 --> 00:06:17,180
host any<font color="#E5E5E5"> anything really if it's a</font>

178
00:06:15,920 --> 00:06:18,830
windows box we look at some of<font color="#E5E5E5"> those</font>

179
00:06:17,180 --> 00:06:20,990
files so start looking at the local

180
00:06:18,830 --> 00:06:24,169
files on machine and then we'll get<font color="#CCCCCC"> into</font>

181
00:06:20,990 --> 00:06:26,030
most application attacking the

182
00:06:24,170 --> 00:06:27,200
organization so that's<font color="#E5E5E5"> the we're going</font>

183
00:06:26,030 --> 00:06:28,340
to be abusing the trust with the

184
00:06:27,200 --> 00:06:30,229
universal forwarders that are already

185
00:06:28,340 --> 00:06:31,700
out there let's send out applications

186
00:06:30,230 --> 00:06:33,920
that executes code on all those machine

187
00:06:31,700 --> 00:06:35,450
let's configure those applications to

188
00:06:33,920 --> 00:06:38,690
run every five seconds so that a cape

189
00:06:35,450 --> 00:06:40,440
somebody catches me I now have my shell

190
00:06:38,690 --> 00:06:41,760
back immediately

191
00:06:40,440 --> 00:06:45,440
and then<font color="#E5E5E5"> attacking the data will be</font>

192
00:06:41,760 --> 00:06:45,440
bringing in all our pen tastes they do

193
00:06:46,580 --> 00:06:51,900
I'm<font color="#E5E5E5"> going very quickly</font><font color="#CCCCCC"> it's cool so</font>

194
00:06:50,250 --> 00:06:53,100
reviewing the logs as I said let's look

195
00:06:51,900 --> 00:06:55,530
at the logs that are already in slunk

196
00:06:53,100 --> 00:06:57,090
ever<font color="#CCCCCC"> slug is huge and everybody's</font>

197
00:06:55,530 --> 00:06:58,289
gathering everything because they need

198
00:06:57,090 --> 00:07:00,179
to know all this information<font color="#E5E5E5"> about their</font>

199
00:06:58,290 --> 00:07:02,760
environment<font color="#E5E5E5"> so you're going to find web</font>

200
00:07:00,180 --> 00:07:05,610
application logs windows logs<font color="#E5E5E5"> Linux logs</font>

201
00:07:02,760 --> 00:07:07,349
everything custom application so now I

202
00:07:05,610 --> 00:07:09,330
can<font color="#CCCCCC"> go in splunk and I can look up and</font>

203
00:07:07,350 --> 00:07:10,500
say hey here's all my database servers

204
00:07:09,330 --> 00:07:12,719
here's a list of<font color="#E5E5E5"> all my domain</font>

205
00:07:10,500 --> 00:07:15,570
controllers here's a valid list of users

206
00:07:12,720 --> 00:07:17,640
that log in just today actually I can

207
00:07:15,570 --> 00:07:21,180
look at login logs and say hey this

208
00:07:17,640 --> 00:07:22,590
organization runs from 8am to 2pm or

209
00:07:21,180 --> 00:07:24,630
whatever it is they have a rotating

210
00:07:22,590 --> 00:07:26,460
<font color="#E5E5E5">shifts they're always in here's users</font>

211
00:07:24,630 --> 00:07:28,159
that work different shifts all this

212
00:07:26,460 --> 00:07:30,690
information can be pulled out a plum and

213
00:07:28,160 --> 00:07:32,010
we can review that and immediately have

214
00:07:30,690 --> 00:07:37,500
all this knowledge in our hands being

215
00:07:32,010 --> 00:07:39,420
being<font color="#E5E5E5"> intact if it is custom web app</font>

216
00:07:37,500 --> 00:07:42,240
logs we can go in there and look and say

217
00:07:39,420 --> 00:07:46,770
you know these users have higher level

218
00:07:42,240 --> 00:07:48,450
of privileges than other users here's

219
00:07:46,770 --> 00:07:49,770
things<font color="#E5E5E5"> that I</font><font color="#CCCCCC"> go and look for just some</font>

220
00:07:48,450 --> 00:07:51,960
key terms to throw out<font color="#CCCCCC"> user name</font>

221
00:07:49,770 --> 00:07:55,280
password<font color="#E5E5E5"> things like that those are</font>

222
00:07:51,960 --> 00:07:58,560
really going to get you<font color="#E5E5E5"> the quick wins</font>

223
00:07:55,280 --> 00:08:01,650
and here's some files that I usually go

224
00:07:58,560 --> 00:08:03,390
for the ssh keys that's really fun if<font color="#E5E5E5"> I</font>

225
00:08:01,650 --> 00:08:06,210
can't get command execution maybe it's

226
00:08:03,390 --> 00:08:08,010
running as a<font color="#E5E5E5"> lower level privilege but</font>

227
00:08:06,210 --> 00:08:10,109
then<font color="#CCCCCC"> I</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> go i can grab these</font><font color="#E5E5E5"> ssh keys</font>

228
00:08:08,010 --> 00:08:13,620
and what I'm what I'm looking at these

229
00:08:10,110 --> 00:08:15,270
things um I'm always one to build up

230
00:08:13,620 --> 00:08:17,690
attack profiles and kind of<font color="#E5E5E5"> get to know</font>

231
00:08:15,270 --> 00:08:19,919
my environment how do how do they

232
00:08:17,690 --> 00:08:22,169
structure the<font color="#E5E5E5"> host names you</font><font color="#CCCCCC"> know how</font>

233
00:08:19,919 --> 00:08:23,669
can I can I look<font color="#E5E5E5"> at the host names and</font>

234
00:08:22,169 --> 00:08:24,990
kind of determine what these boxes what

235
00:08:23,669 --> 00:08:26,909
the function is in the<font color="#CCCCCC"> environment and</font>

236
00:08:24,990 --> 00:08:30,360
build out<font color="#E5E5E5"> a you know kind of an attack</font>

237
00:08:26,910 --> 00:08:33,419
passive way I want<font color="#E5E5E5"> to execute so here's</font>

238
00:08:30,360 --> 00:08:40,140
a quick demo the nice<font color="#CCCCCC"> thing about this</font>

239
00:08:33,419 --> 00:08:42,449
right is so crap of course that

240
00:08:40,140 --> 00:08:46,080
resolution we can't read I just shot

241
00:08:42,450 --> 00:08:48,180
these lower quality too all right let's

242
00:08:46,080 --> 00:08:49,410
give up on<font color="#CCCCCC"> that anyway it's</font><font color="#E5E5E5"> like you're</font>

243
00:08:48,180 --> 00:08:51,949
<font color="#E5E5E5">going to add data you're going to upload</font>

244
00:08:49,410 --> 00:08:53,959
a log file from the<font color="#E5E5E5"> local file system</font>

245
00:08:51,950 --> 00:08:55,700
and you're going<font color="#E5E5E5"> to keep hitting next</font>

246
00:08:53,960 --> 00:08:56,780
<font color="#CCCCCC">stuff here in the top right and as long</font>

247
00:08:55,700 --> 00:08:59,000
as you don't go all<font color="#CCCCCC"> the way to the end</font>

248
00:08:56,780 --> 00:09:01,220
none of<font color="#CCCCCC"> that information is logged so if</font>

249
00:08:59,000 --> 00:09:02,870
<font color="#E5E5E5">I pull an SE shadow I can review the</font>

250
00:09:01,220 --> 00:09:04,430
data look at look at<font color="#E5E5E5"> all those password</font>

251
00:09:02,870 --> 00:09:06,680
hashes grab those the Roman<font color="#CCCCCC"> of my</font>

252
00:09:04,430 --> 00:09:08,300
password cracker but spoke never knows I

253
00:09:06,680 --> 00:09:09,829
was well<font color="#CCCCCC"> splunk knows i was there but no</font>

254
00:09:08,300 --> 00:09:11,780
one else<font color="#CCCCCC"> knows i was there none of the</font>

255
00:09:09,830 --> 00:09:14,060
administrative users so then<font color="#E5E5E5"> i can just</font>

256
00:09:11,780 --> 00:09:16,310
<font color="#E5E5E5">go back</font><font color="#CCCCCC"> to pick a new</font><font color="#E5E5E5"> log file hit next</font>

257
00:09:14,060 --> 00:09:18,170
review that collect the information I

258
00:09:16,310 --> 00:09:20,270
<font color="#CCCCCC">need and keep going back and forth over</font>

259
00:09:18,170 --> 00:09:23,449
and over again and as I said<font color="#E5E5E5"> nothing is</font>

260
00:09:20,270 --> 00:09:26,870
<font color="#E5E5E5">ever logged there I hope my other video</font>

261
00:09:23,450 --> 00:09:28,220
show because that's going to suck are

262
00:09:26,870 --> 00:09:31,010
you attacking the server malicious

263
00:09:28,220 --> 00:09:32,990
application<font color="#CCCCCC"> um so</font><font color="#E5E5E5"> I built an app is</font>

264
00:09:31,010 --> 00:09:35,650
called<font color="#CCCCCC"> splunk</font><font color="#E5E5E5"> shell basically when you</font>

265
00:09:32,990 --> 00:09:38,090
install<font color="#CCCCCC"> it it's a</font><font color="#E5E5E5"> Python reverse shell</font>

266
00:09:35,650 --> 00:09:39,709
funkiest package with the mates<font color="#CCCCCC"> punk</font>

267
00:09:38,090 --> 00:09:43,250
applications<font color="#CCCCCC"> package</font><font color="#E5E5E5"> with their own</font>

268
00:09:39,710 --> 00:09:50,120
<font color="#E5E5E5">Python interpreter it's</font><font color="#CCCCCC"> two got 72 I yea</font>

269
00:09:43,250 --> 00:09:51,910
sorry Oh sides i built a basis basically

270
00:09:50,120 --> 00:09:54,770
just a common python meterpreter shell

271
00:09:51,910 --> 00:10:02,449
just<font color="#E5E5E5"> a basic payload to demo demo the</font>

272
00:09:54,770 --> 00:10:04,819
activity so that we can show off see

273
00:10:02,450 --> 00:10:07,340
this video<font color="#CCCCCC"> it's better okay so let's</font>

274
00:10:04,820 --> 00:10:09,670
start up a handler first inside that

275
00:10:07,340 --> 00:10:09,670
exploit

276
00:10:24,209 --> 00:10:26,410
hopeful

277
00:10:25,300 --> 00:10:32,410
people are familiar with<font color="#E5E5E5"> metasploit a</font>

278
00:10:26,410 --> 00:10:34,120
little bit know what<font color="#E5E5E5"> I'm doing here so</font>

279
00:10:32,410 --> 00:10:35,439
as I said the shell<font color="#E5E5E5"> that's going to be</font>

280
00:10:34,120 --> 00:10:37,180
coming back as a Python meterpreter

281
00:10:35,440 --> 00:10:39,580
shell so we have<font color="#CCCCCC"> said we have to</font><font color="#E5E5E5"> use</font>

282
00:10:37,180 --> 00:10:41,469
proper payload you can do reverse you

283
00:10:39,580 --> 00:10:42,820
can do buying shelves it does support

284
00:10:41,470 --> 00:10:46,200
both of them it does support basic

285
00:10:42,820 --> 00:10:46,200
command shows as well if you needed that

286
00:10:52,620 --> 00:10:55,990
<font color="#CCCCCC">all right so we have a handler</font><font color="#E5E5E5"> set up</font>

287
00:10:54,670 --> 00:10:57,189
now we need to<font color="#E5E5E5"> go</font><font color="#CCCCCC"> back to slunk we're</font>

288
00:10:55,990 --> 00:11:01,089
going to use those credentials that we

289
00:10:57,190 --> 00:11:03,269
have I won't stall an application come

290
00:11:01,089 --> 00:11:03,269
on

291
00:11:25,520 --> 00:11:27,579
you

292
00:11:30,320 --> 00:11:36,000
so the fun part here is we<font color="#CCCCCC"> could</font>

293
00:11:32,670 --> 00:11:38,040
substitute any you know any code here

294
00:11:36,000 --> 00:11:40,590
that you wanted<font color="#CCCCCC"> i obviously</font><font color="#E5E5E5"> i'm using a</font>

295
00:11:38,040 --> 00:11:42,030
<font color="#CCCCCC">python interpreter shell but</font><font color="#E5E5E5"> this could</font>

296
00:11:40,590 --> 00:11:43,320
be anything if you have something custom

297
00:11:42,030 --> 00:11:45,720
on your team that you guys use if

298
00:11:43,320 --> 00:11:47,610
there's you know some other function you

299
00:11:45,720 --> 00:11:49,860
wanted to run all you got to<font color="#E5E5E5"> do is swap</font>

300
00:11:47,610 --> 00:11:52,470
out my<font color="#CCCCCC"> python code for yours and install</font>

301
00:11:49,860 --> 00:11:54,450
this and run it the one setting that<font color="#E5E5E5"> you</font>

302
00:11:52,470 --> 00:11:55,770
have to change for 625 is that<font color="#CCCCCC"> i haven't</font>

303
00:11:54,450 --> 00:11:57,630
<font color="#E5E5E5">figured out a configuration file there</font>

304
00:11:55,770 --> 00:12:00,300
may be one I<font color="#CCCCCC"> just haven't figured over</font>

305
00:11:57,630 --> 00:12:02,280
20 it<font color="#E5E5E5"> is but now basically what this is</font>

306
00:12:00,300 --> 00:12:04,079
has installed is a command that we can

307
00:12:02,280 --> 00:12:06,510
run up from the search and reporting app

308
00:12:04,080 --> 00:12:08,760
so we'll run the app will say<font color="#E5E5E5"> I want to</font>

309
00:12:06,510 --> 00:12:12,620
reverse shell I want a matter prover

310
00:12:08,760 --> 00:12:12,620
shell and here's who you need to talk to

311
00:12:16,280 --> 00:12:20,490
so if you<font color="#E5E5E5"> don't this actually Forks off</font>

312
00:12:19,020 --> 00:12:25,069
the profits if you don't fork that off

313
00:12:20,490 --> 00:12:27,360
<font color="#CCCCCC">that will hang and keep using that that</font>

314
00:12:25,070 --> 00:12:29,040
profit the<font color="#CCCCCC"> splunk process to run and</font>

315
00:12:27,360 --> 00:12:30,150
execute your shelf so the entire time

316
00:12:29,040 --> 00:12:31,920
<font color="#E5E5E5">that you're</font><font color="#CCCCCC"> running in your shell it</font>

317
00:12:30,150 --> 00:12:33,270
would sit there<font color="#E5E5E5"> so you do need to fork</font>

318
00:12:31,920 --> 00:12:35,729
off the process the ones that<font color="#CCCCCC"> I have</font>

319
00:12:33,270 --> 00:12:37,699
built-in do so if you do swap them out

320
00:12:35,730 --> 00:12:40,920
that would be one thing to keep in mind

321
00:12:37,700 --> 00:12:43,440
and it also prevents the admin if you

322
00:12:40,920 --> 00:12:48,660
restart<font color="#CCCCCC"> splunk my shelf still there it's</font>

323
00:12:43,440 --> 00:12:55,200
still calling home so there's that<font color="#E5E5E5"> any</font>

324
00:12:48,660 --> 00:12:57,630
questions there on that one yeah all the

325
00:12:55,200 --> 00:13:01,260
videos of you in github um actually the

326
00:12:57,630 --> 00:13:07,200
entire presentation is it the links at

327
00:13:01,260 --> 00:13:08,790
the end of<font color="#E5E5E5"> this as well so awesome it's</font>

328
00:13:07,200 --> 00:13:10,650
cool everyone's to install<font color="#CCCCCC"> it it's on</font>

329
00:13:08,790 --> 00:13:12,060
github right here at this link and I

330
00:13:10,650 --> 00:13:14,640
said there's another link at the end of

331
00:13:12,060 --> 00:13:17,099
this presentation as well and I did have

332
00:13:14,640 --> 00:13:20,220
it in<font color="#CCCCCC"> splunk base or yeah this</font><font color="#E5E5E5"> funk</font>

333
00:13:17,100 --> 00:13:21,930
based app store so I submitted it it was

334
00:13:20,220 --> 00:13:25,710
cool<font color="#E5E5E5"> everybody thought it was awesome</font>

335
00:13:21,930 --> 00:13:26,790
and then<font color="#E5E5E5"> about 57 minutes later they</font>

336
00:13:25,710 --> 00:13:30,450
figured out<font color="#E5E5E5"> what the hell was</font><font color="#CCCCCC"> going on</font>

337
00:13:26,790 --> 00:13:31,589
and they told<font color="#E5E5E5"> me I was crazy I don't</font>

338
00:13:30,450 --> 00:13:33,780
know who got in trouble for<font color="#E5E5E5"> it but</font>

339
00:13:31,590 --> 00:13:35,700
somebody<font color="#E5E5E5"> got in trouble and because I</font>

340
00:13:33,780 --> 00:13:36,900
<font color="#E5E5E5">got pulled if it was in the spunk faced</font>

341
00:13:35,700 --> 00:13:37,270
that would have made it a lot easier if

342
00:13:36,900 --> 00:13:38,890
you were to

343
00:13:37,270 --> 00:13:40,780
Eric you're<font color="#E5E5E5"> a pen tester inside an</font>

344
00:13:38,890 --> 00:13:42,640
environment you<font color="#CCCCCC"> can log in literally say</font>

345
00:13:40,780 --> 00:13:44,829
browse apps type in spunk shelves and

346
00:13:42,640 --> 00:13:46,720
thought never having to upload any code

347
00:13:44,830 --> 00:13:51,700
to them so it would<font color="#CCCCCC"> have been funny but</font>

348
00:13:46,720 --> 00:13:54,010
yeah they caught on oh I'm sure<font color="#CCCCCC"> they</font>

349
00:13:51,700 --> 00:13:55,870
have I I was going to go down the route

350
00:13:54,010 --> 00:13:57,550
of trying to hide it and you<font color="#E5E5E5"> know</font>

351
00:13:55,870 --> 00:13:59,590
obviously<font color="#E5E5E5"> it's a code and I was like</font>

352
00:13:57,550 --> 00:14:01,089
nuts wasted<font color="#CCCCCC"> so my way to</font><font color="#E5E5E5"> my time</font><font color="#CCCCCC"> all</font>

353
00:13:59,590 --> 00:14:03,840
<font color="#CCCCCC">right let's just put it</font><font color="#E5E5E5"> up on github</font>

354
00:14:01,090 --> 00:14:07,270
people get downloaded be funny that way

355
00:14:03,840 --> 00:14:09,430
so extracting data so all these apps

356
00:14:07,270 --> 00:14:10,810
that we install I guess<font color="#E5E5E5"> not really mine</font>

357
00:14:09,430 --> 00:14:12,069
because there's no configuration for it

358
00:14:10,810 --> 00:14:13,479
but all the other apps that you install

359
00:14:12,070 --> 00:14:15,340
all need credentials to talk to

360
00:14:13,480 --> 00:14:17,080
<font color="#E5E5E5">something you know next pose has an app</font>

361
00:14:15,340 --> 00:14:19,510
you<font color="#CCCCCC"> need to give it credentials to talk</font>

362
00:14:17,080 --> 00:14:23,940
to your next post console windows needs

363
00:14:19,510 --> 00:14:26,260
a user usually need a domain user

364
00:14:23,940 --> 00:14:28,870
usually it should only have read access

365
00:14:26,260 --> 00:14:30,640
a lot of times it has more but all these

366
00:14:28,870 --> 00:14:32,260
all these things need configurations so

367
00:14:30,640 --> 00:14:34,960
you need to input a<font color="#E5E5E5"> username and a</font>

368
00:14:32,260 --> 00:14:37,090
password so smug takes all those in

369
00:14:34,960 --> 00:14:39,100
through your app it's all stored in a

370
00:14:37,090 --> 00:14:40,720
file on the file system and luckily

371
00:14:39,100 --> 00:14:43,740
spunk does do it correctly and they do

372
00:14:40,720 --> 00:14:45,640
<font color="#E5E5E5">salt and encrypt all these credentials</font>

373
00:14:43,740 --> 00:14:49,390
this is what it would<font color="#E5E5E5"> look like for</font>

374
00:14:45,640 --> 00:14:50,860
<font color="#E5E5E5">Windows app you install a I'm sorry you</font>

375
00:14:49,390 --> 00:14:52,600
set up your configuration with your

376
00:14:50,860 --> 00:14:54,760
username<font color="#CCCCCC"> and password and everything and</font>

377
00:14:52,600 --> 00:14:56,110
if we<font color="#E5E5E5"> looked at the actual file</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> a</font>

378
00:14:54,760 --> 00:14:57,790
file system this is<font color="#E5E5E5"> what you would see</font>

379
00:14:56,110 --> 00:15:01,660
so you can't actually read anything

380
00:14:57,790 --> 00:15:03,640
awesome<font color="#CCCCCC"> on splunk part bad on schooling</font>

381
00:15:01,660 --> 00:15:06,400
support because about 14 lines of Python

382
00:15:03,640 --> 00:15:09,449
code and utilizing the API I now get

383
00:15:06,400 --> 00:15:13,360
<font color="#E5E5E5">clear text passwords here in the middle</font>

384
00:15:09,450 --> 00:15:15,550
so the API needs to need to be<font color="#E5E5E5"> able to</font>

385
00:15:13,360 --> 00:15:18,760
<font color="#E5E5E5">speak to all these applications so if I</font>

386
00:15:15,550 --> 00:15:20,410
give<font color="#E5E5E5"> it a dose or username and password</font>

387
00:15:18,760 --> 00:15:22,720
it needs to be able<font color="#E5E5E5"> to reach out to that</font>

388
00:15:20,410 --> 00:15:24,400
domain controller or that other windows

389
00:15:22,720 --> 00:15:26,770
system in the network and give it those

390
00:15:24,400 --> 00:15:28,900
credentials so the API have to be able

391
00:15:26,770 --> 00:15:30,280
<font color="#E5E5E5">to unencrypt those passwords well it'll</font>

392
00:15:28,900 --> 00:15:33,640
also give<font color="#E5E5E5"> it up to anybody else that</font>

393
00:15:30,280 --> 00:15:35,890
asks for Moscow so as I said there's all

394
00:15:33,640 --> 00:15:37,569
14 lines of Python it'll lift your every

395
00:15:35,890 --> 00:15:38,890
application that you have and decrypt

396
00:15:37,570 --> 00:15:48,649
all those credentials and present them

397
00:15:38,890 --> 00:15:52,399
to you not<font color="#E5E5E5"> once</font><font color="#CCCCCC"> long so</font><font color="#E5E5E5"> yeah</font>

398
00:15:48,649 --> 00:15:54,199
so that is a business trip<font color="#E5E5E5"> so the</font>

399
00:15:52,399 --> 00:15:58,339
encrypted password storage endpoint in

400
00:15:54,199 --> 00:16:00,319
swamp prior to 65 required physical and

401
00:15:58,339 --> 00:16:04,939
mental objects and pensioners for dot

402
00:16:00,319 --> 00:16:06,829
yep because you have now is the

403
00:16:04,939 --> 00:16:09,740
developers unfortunately takes half the

404
00:16:06,829 --> 00:16:12,709
liver delivered food capability my lists

405
00:16:09,740 --> 00:16:15,730
or password it is still<font color="#CCCCCC"> it</font><font color="#E5E5E5"> all saying</font>

406
00:16:12,709 --> 00:16:18,109
<font color="#E5E5E5">how would you do not have to give</font><font color="#CCCCCC"> that</font>

407
00:16:15,730 --> 00:16:22,670
but if<font color="#E5E5E5"> I'm going to minister I have it</font>

408
00:16:18,110 --> 00:16:24,709
or can give it to myself yes<font color="#E5E5E5"> correct yes</font>

409
00:16:22,670 --> 00:16:26,089
<font color="#E5E5E5">so there is there's a setting there so</font>

410
00:16:24,709 --> 00:16:28,518
as long<font color="#E5E5E5"> as but if you have</font><font color="#CCCCCC"> administrator</font>

411
00:16:26,089 --> 00:16:30,559
credentials and this is assuming that

412
00:16:28,519 --> 00:16:32,629
you have<font color="#E5E5E5"> in some way have administrative</font>

413
00:16:30,559 --> 00:16:34,100
level access you could either if you

414
00:16:32,629 --> 00:16:35,509
didn't already have it on that user that

415
00:16:34,100 --> 00:16:37,699
<font color="#E5E5E5">you had you could give it to yourself</font>

416
00:16:35,509 --> 00:16:40,220
<font color="#E5E5E5">because you're</font><font color="#CCCCCC"> an admin or you know if</font>

417
00:16:37,699 --> 00:16:42,649
you need if<font color="#E5E5E5"> you already did have it yeah</font>

418
00:16:40,220 --> 00:16:50,089
you are correct but that is new for six

419
00:16:42,649 --> 00:16:51,379
I think<font color="#CCCCCC"> it's 653 or 60 65 oh ok so</font>

420
00:16:50,089 --> 00:16:52,069
attacking the organization this is what

421
00:16:51,379 --> 00:16:53,600
we're going to talk about those

422
00:16:52,069 --> 00:16:54,769
<font color="#CCCCCC">Universal forwarders and that deployment</font>

423
00:16:53,600 --> 00:16:57,620
server that we talked<font color="#E5E5E5"> about the</font>

424
00:16:54,769 --> 00:16:58,910
beginning so along with the application

425
00:16:57,620 --> 00:17:00,709
that we talked about<font color="#E5E5E5"> just a second ago</font>

426
00:16:58,910 --> 00:17:03,110
there's to what we call technology

427
00:17:00,709 --> 00:17:05,898
add-on it's just a Splunk way of talking

428
00:17:03,110 --> 00:17:08,329
about<font color="#CCCCCC"> a different apps</font><font color="#E5E5E5"> I built a</font><font color="#CCCCCC"> Windows</font>

429
00:17:05,898 --> 00:17:10,129
one in the linux one and again these are

430
00:17:08,329 --> 00:17:11,750
all basic interpreter shells you could

431
00:17:10,130 --> 00:17:13,760
swap out this code with anything<font color="#CCCCCC"> that</font>

432
00:17:11,750 --> 00:17:16,039
you wanted so the windows one is just<font color="#E5E5E5"> a</font>

433
00:17:13,760 --> 00:17:20,390
bat file runs a PowerShell command for a

434
00:17:16,039 --> 00:17:22,158
reverse meterpreter shell the<font color="#E5E5E5"> Linux</font><font color="#CCCCCC"> ones</font>

435
00:17:20,390 --> 00:17:23,539
all<font color="#E5E5E5"> Python it's honestly the same code</font>

436
00:17:22,159 --> 00:17:26,659
that I used in the other application

437
00:17:23,539 --> 00:17:32,120
just<font color="#E5E5E5"> poured it over to a technology out</font>

438
00:17:26,659 --> 00:17:34,669
on<font color="#CCCCCC"> I'm here's a demo of that real quick</font>

439
00:17:32,120 --> 00:17:40,459
so i use the unicorn application to

440
00:17:34,669 --> 00:17:42,230
generate the power shell code and as<font color="#CCCCCC"> i</font>

441
00:17:40,460 --> 00:17:44,270
said<font color="#E5E5E5"> a lot of times these universal</font>

442
00:17:42,230 --> 00:17:46,730
forwarders are installed<font color="#E5E5E5"> and running as</font>

443
00:17:44,270 --> 00:17:48,470
root or system so as soon<font color="#E5E5E5"> as this code</font>

444
00:17:46,730 --> 00:17:52,419
runs it gives me<font color="#CCCCCC"> a reverse shell</font><font color="#E5E5E5"> i also</font>

445
00:17:48,470 --> 00:17:52,419
have the same<font color="#E5E5E5"> level access</font>

446
00:18:17,450 --> 00:18:28,909
questions or<font color="#E5E5E5"> just don't</font><font color="#CCCCCC"> er I've had yeah</font>

447
00:18:26,210 --> 00:18:30,559
I have an account of some sort there's

448
00:18:28,909 --> 00:18:32,000
either miss configuration with a default

449
00:18:30,559 --> 00:18:33,408
<font color="#CCCCCC">pass where there's password breeze in</font>

450
00:18:32,000 --> 00:18:35,210
<font color="#E5E5E5">the environment yeah the assumption is</font>

451
00:18:33,409 --> 00:18:37,610
<font color="#E5E5E5">that you do have some sort of access</font>

452
00:18:35,210 --> 00:18:39,289
into<font color="#CCCCCC"> the server there's really no</font>

453
00:18:37,610 --> 00:18:51,139
vulnerabilities I'm just a<font color="#E5E5E5"> creative way</font>

454
00:18:39,289 --> 00:18:53,240
of using that pretty much so I thought

455
00:18:51,139 --> 00:18:58,519
our PowerShell payload here with our new

456
00:18:53,240 --> 00:19:00,169
stuff again all this if you had some

457
00:18:58,519 --> 00:19:02,779
custom code that you guys use for your

458
00:19:00,169 --> 00:19:04,250
red team or your your pen testing that

459
00:19:02,779 --> 00:19:06,679
can all be swapped in here as<font color="#CCCCCC"> well this</font>

460
00:19:04,250 --> 00:19:10,820
is just<font color="#E5E5E5"> for demo purposes I felt like</font><font color="#CCCCCC"> my</font>

461
00:19:06,679 --> 00:19:12,350
<font color="#CCCCCC">display was even that was like crap on</font>

462
00:19:10,820 --> 00:19:16,970
there you<font color="#E5E5E5"> still here we can read some of</font>

463
00:19:12,350 --> 00:19:17,928
it I have high res videos then you

464
00:19:16,970 --> 00:19:19,909
couldn't read<font color="#CCCCCC"> it on the</font><font color="#E5E5E5"> low res</font>

465
00:19:17,929 --> 00:19:32,240
projector so i swapped them now you

466
00:19:19,909 --> 00:19:35,809
can't see that anyways<font color="#E5E5E5"> it'll start up</font>

467
00:19:32,240 --> 00:19:38,630
<font color="#E5E5E5">our handler will go into the deployment</font>

468
00:19:35,809 --> 00:19:44,029
server here<font color="#CCCCCC"> i will</font><font color="#E5E5E5"> just oh man that was</font>

469
00:19:38,630 --> 00:19:48,470
horrible one bad to the next anyway so

470
00:19:44,029 --> 00:19:49,909
these deploy out so the nice part with

471
00:19:48,470 --> 00:19:52,909
it with these technology add-ons is

472
00:19:49,909 --> 00:19:54,470
again we can set the restart time of the

473
00:19:52,909 --> 00:19:55,880
application so if you needed<font color="#E5E5E5"> it to run</font>

474
00:19:54,470 --> 00:19:57,799
every five seconds<font color="#CCCCCC"> or</font><font color="#E5E5E5"> if you want it to</font>

475
00:19:55,880 --> 00:19:59,840
run average six hours<font color="#E5E5E5"> whatever you</font>

476
00:19:57,799 --> 00:20:02,600
really wanted you<font color="#CCCCCC"> could do that so</font><font color="#E5E5E5"> that</font>

477
00:19:59,840 --> 00:20:04,760
every whatever your time is it'll it'll

478
00:20:02,600 --> 00:20:13,639
kick that show up<font color="#CCCCCC"> again and again and</font>

479
00:20:04,760 --> 00:20:17,750
again yeah we'll just go with<font color="#E5E5E5"> that</font>

480
00:20:13,639 --> 00:20:21,459
<font color="#E5E5E5">because that sucks anyways any questions</font>

481
00:20:17,750 --> 00:20:24,460
there that that was kind of that<font color="#E5E5E5"> section</font>

482
00:20:21,460 --> 00:20:24,460
yeah

483
00:20:27,549 --> 00:20:32,780
so<font color="#E5E5E5"> I started out with yeah so I started</font>

484
00:20:31,429 --> 00:20:34,669
out with which is putting power shell

485
00:20:32,780 --> 00:20:36,860
code basically is a reverse meterpreter

486
00:20:34,669 --> 00:20:38,419
shell with powershell so<font color="#E5E5E5"> I put that in</font>

487
00:20:36,860 --> 00:20:40,340
there and that runs they favorite every

488
00:20:38,419 --> 00:20:50,600
five seconds or<font color="#E5E5E5"> 10 seconds whatever you</font>

489
00:20:40,340 --> 00:20:54,649
put I'm sorry so those last section here

490
00:20:50,600 --> 00:20:56,840
attacking the data<font color="#E5E5E5"> I'm super ahead um so</font>

491
00:20:54,650 --> 00:20:58,850
I said we generate a ton of data with

492
00:20:56,840 --> 00:21:01,189
pen testing and map scans we're running

493
00:20:58,850 --> 00:21:02,750
<font color="#CCCCCC">Nix Oh every tool you have is going</font><font color="#E5E5E5"> to</font>

494
00:21:01,190 --> 00:21:06,650
generate some sort<font color="#E5E5E5"> of data responder</font>

495
00:21:02,750 --> 00:21:08,540
everything all that<font color="#E5E5E5"> stuff unless you put</font>

496
00:21:06,650 --> 00:21:10,520
it in<font color="#CCCCCC"> splunk it also</font><font color="#E5E5E5"> some text files</font>

497
00:21:08,540 --> 00:21:12,230
normally for me and I have to go through

498
00:21:10,520 --> 00:21:14,660
windows and windows and go through these

499
00:21:12,230 --> 00:21:15,919
crazy hierarchy of folders and that's

500
00:21:14,660 --> 00:21:17,600
how it's all organized and that's how I

501
00:21:15,919 --> 00:21:22,070
go back<font color="#CCCCCC"> to read it and generate reports</font>

502
00:21:17,600 --> 00:21:23,959
and<font color="#E5E5E5"> takes me days and it sucks so if we</font>

503
00:21:22,070 --> 00:21:31,450
<font color="#E5E5E5">had it all in</font><font color="#CCCCCC"> splunk for instance is the</font>

504
00:21:23,960 --> 00:21:34,450
Wi-Fi pineapple it's just hold on let me

505
00:21:31,450 --> 00:21:34,450
grab

506
00:21:47,660 --> 00:22:02,420
guess I should drag it over here

507
00:21:49,680 --> 00:22:05,520
shouldn't there we go slightly<font color="#E5E5E5"> better</font>

508
00:22:02,420 --> 00:22:07,920
<font color="#E5E5E5">okay so we have a we have an app for the</font>

509
00:22:05,520 --> 00:22:09,300
Wi-Fi pineapple in real time all these

510
00:22:07,920 --> 00:22:11,130
logs are coming in from your Wi-Fi

511
00:22:09,300 --> 00:22:13,440
pineapple you could look at one single

512
00:22:11,130 --> 00:22:14,580
dashboard and you get SSID<font color="#E5E5E5"> geez I get</font>

513
00:22:13,440 --> 00:22:16,650
the clients that<font color="#E5E5E5"> I've already got</font>

514
00:22:14,580 --> 00:22:19,439
attacked or attached to my pineapple

515
00:22:16,650 --> 00:22:20,520
down here you get two timelines for the

516
00:22:19,440 --> 00:22:22,170
different probe requests and the

517
00:22:20,520 --> 00:22:24,330
different SS IDs that<font color="#CCCCCC"> we're seeing and</font>

518
00:22:22,170 --> 00:22:26,790
it kind of speeds up that attack so now

519
00:22:24,330 --> 00:22:28,830
<font color="#E5E5E5">I know who who's on my network who I</font>

520
00:22:26,790 --> 00:22:30,780
have already<font color="#E5E5E5"> and what SSID is I'm saying</font>

521
00:22:28,830 --> 00:22:32,490
in the<font color="#CCCCCC"> future I'd like to add some more</font>

522
00:22:30,780 --> 00:22:34,230
context menus that I could drop down and

523
00:22:32,490 --> 00:22:36,840
say hey run this attack on<font color="#E5E5E5"> this guy and</font>

524
00:22:34,230 --> 00:22:39,300
<font color="#CCCCCC">it'll run those those scripts on the</font>

525
00:22:36,840 --> 00:22:40,590
different point out on the pineapple so

526
00:22:39,300 --> 00:22:42,600
that it would start capturing<font color="#E5E5E5"> everybody</font>

527
00:22:40,590 --> 00:22:44,790
else that hasn't been built yet right

528
00:22:42,600 --> 00:22:48,270
now we<font color="#E5E5E5"> just got dashboards but we're</font>

529
00:22:44,790 --> 00:22:49,710
getting closer<font color="#CCCCCC"> and the other app that we</font>

530
00:22:48,270 --> 00:22:52,650
have set up<font color="#E5E5E5"> I'm just going</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> this</font>

531
00:22:49,710 --> 00:22:57,870
outside of PowerPoint for now would be

532
00:22:52,650 --> 00:23:03,000
responder so responders a

533
00:22:57,870 --> 00:23:04,949
man-in-the-middle tool kind of it's good

534
00:23:03,000 --> 00:23:07,740
enough<font color="#CCCCCC"> i guess response men and little</font>

535
00:23:04,950 --> 00:23:10,590
<font color="#CCCCCC">tool for</font><font color="#E5E5E5"> pen testing you'll run it it'll</font>

536
00:23:07,740 --> 00:23:11,910
do men in little on SMB HTTP FTP all the

537
00:23:10,590 --> 00:23:13,770
different protocols that are going

538
00:23:11,910 --> 00:23:15,240
across the network it'll say hey whoever

539
00:23:13,770 --> 00:23:17,639
you're trying to authenticate with I'm

540
00:23:15,240 --> 00:23:19,680
that guy send me your hash and so you

541
00:23:17,640 --> 00:23:20,970
collect all<font color="#E5E5E5"> the hashes and again in real</font>

542
00:23:19,680 --> 00:23:22,500
time if we're sending all those logs

543
00:23:20,970 --> 00:23:24,480
into<font color="#CCCCCC"> splunk if you're running spunk on</font>

544
00:23:22,500 --> 00:23:27,690
your<font color="#E5E5E5"> pin test box it would make</font><font color="#CCCCCC"> things a</font>

545
00:23:24,480 --> 00:23:29,220
lot<font color="#CCCCCC"> faster so up top right</font><font color="#E5E5E5"> away I can in</font>

546
00:23:27,690 --> 00:23:31,110
<font color="#E5E5E5">real time see how many credentials I've</font>

547
00:23:29,220 --> 00:23:32,880
already captured what couple of<font color="#E5E5E5"> type</font>

548
00:23:31,110 --> 00:23:34,830
they are what protocol they are the

549
00:23:32,880 --> 00:23:37,230
<font color="#CCCCCC">usernames that I'm looking at and then</font>

550
00:23:34,830 --> 00:23:38,580
<font color="#E5E5E5">down at the bottom here I cut off and</font>

551
00:23:37,230 --> 00:23:40,620
some of this stuff is blurred because it

552
00:23:38,580 --> 00:23:42,659
was actually<font color="#CCCCCC"> like a live engagement I</font>

553
00:23:40,620 --> 00:23:44,399
was on down at<font color="#E5E5E5"> the bottom I have the</font>

554
00:23:42,660 --> 00:23:45,990
hashes that you could<font color="#CCCCCC"> easily just export</font>

555
00:23:44,400 --> 00:23:48,390
and kick over to hash cat or John or

556
00:23:45,990 --> 00:23:49,980
whatever school that<font color="#E5E5E5"> you're using and</font>

557
00:23:48,390 --> 00:23:51,100
again there's I would like to<font color="#CCCCCC"> build out</font>

558
00:23:49,980 --> 00:23:53,530
some context menus in

559
00:23:51,100 --> 00:23:55,659
future to say hey run this in hash cat

560
00:23:53,530 --> 00:24:06,059
and it automatically pushes that out for

561
00:23:55,660 --> 00:24:06,059
you here school starts where I wanted<font color="#E5E5E5"> to</font>

562
00:24:07,799 --> 00:24:14,100
so we'll end it with indicating actions

563
00:24:10,539 --> 00:24:16,330
and I'm Way ahead but it's cool um

564
00:24:14,100 --> 00:24:17,949
obviously just update your software I

565
00:24:16,330 --> 00:24:19,539
mean I said at the<font color="#E5E5E5"> beginning the</font>

566
00:24:17,950 --> 00:24:21,100
<font color="#E5E5E5">engagement that started this it was</font>

567
00:24:19,539 --> 00:24:22,450
running<font color="#CCCCCC"> a</font><font color="#E5E5E5"> 45 installation that</font>

568
00:24:21,100 --> 00:24:24,340
automatically logged me and his admin

569
00:24:22,450 --> 00:24:26,679
had they been running a you know six to

570
00:24:24,340 --> 00:24:28,240
five or six auto installation at least

571
00:24:26,679 --> 00:24:30,220
it would not to log me in maybe they

572
00:24:28,240 --> 00:24:32,409
still had default credentials so update

573
00:24:30,220 --> 00:24:35,350
your passwords enable ssl it's one it's

574
00:24:32,409 --> 00:24:37,210
one check in the box and<font color="#E5E5E5"> then there</font><font color="#CCCCCC"> is a</font>

575
00:24:35,350 --> 00:24:40,270
secure deployment guide there's a<font color="#E5E5E5"> kind</font>

576
00:24:37,210 --> 00:24:42,429
<font color="#CCCCCC">of</font><font color="#E5E5E5"> stuff in here it's about 15 to 20</font>

577
00:24:40,270 --> 00:24:46,510
pages long there's ton<font color="#CCCCCC"> of stuff in here</font>

578
00:24:42,429 --> 00:24:48,159
you can do it you know to do domain

579
00:24:46,510 --> 00:24:51,490
authentication you know add in more

580
00:24:48,159 --> 00:24:55,059
complex layers besides just basic

581
00:24:51,490 --> 00:24:58,539
<font color="#E5E5E5">application stuff yeah that's it as</font><font color="#CCCCCC"> I</font>

582
00:24:55,059 --> 00:25:00,100
said sorry about the videos I have<font color="#E5E5E5"> never</font>

583
00:24:58,539 --> 00:25:03,309
know what I'm going<font color="#CCCCCC"> to run</font><font color="#E5E5E5"> into here</font><font color="#CCCCCC"> of</font>

584
00:25:00,100 --> 00:25:06,189
the presentation any questions there oh

585
00:25:03,309 --> 00:25:08,820
and there's the contact info bring<font color="#E5E5E5"> that</font>

586
00:25:06,190 --> 00:25:08,820
back up sorry

587
00:25:40,309 --> 00:25:45,270
<font color="#CCCCCC">so you would want</font><font color="#E5E5E5"> to I guess split your</font>

588
00:25:43,260 --> 00:25:46,590
data up so I mean<font color="#E5E5E5"> for</font><font color="#CCCCCC"> instance there</font>

589
00:25:45,270 --> 00:25:48,059
I've had somebody in accounting that

590
00:25:46,590 --> 00:25:49,770
need to look at something only

591
00:25:48,059 --> 00:25:51,510
accounting data you obviously wouldn't

592
00:25:49,770 --> 00:25:53,639
allow them access look at all your IT

593
00:25:51,510 --> 00:25:56,100
data as well so you can segregate out

594
00:25:53,640 --> 00:25:57,840
the data like that and assign users

595
00:25:56,100 --> 00:25:59,669
access to different they call them

596
00:25:57,840 --> 00:26:02,220
indexes so that would be different data

597
00:25:59,670 --> 00:26:04,950
sets mm-hmm I mean that's one one thing

598
00:26:02,220 --> 00:26:06,450
but there's a bunch of other stuff<font color="#CCCCCC"> you</font>

599
00:26:04,950 --> 00:26:08,809
know don't obviously don't import your

600
00:26:06,450 --> 00:26:21,240
<font color="#E5E5E5">passwords hunting for things like</font><font color="#CCCCCC"> that</font>

601
00:26:08,809 --> 00:26:22,918
yes um so this would<font color="#CCCCCC"> be more of</font>

602
00:26:21,240 --> 00:26:24,870
something that<font color="#CCCCCC"> I would be running in</font>

603
00:26:22,919 --> 00:26:26,850
real time for myself to kind of keep an

604
00:26:24,870 --> 00:26:28,770
updated sat if there is a cool shirt in

605
00:26:26,850 --> 00:26:31,080
there<font color="#E5E5E5"> yeah i would put that the report</font>

606
00:26:28,770 --> 00:26:34,830
but most of that<font color="#E5E5E5"> is just for me</font><font color="#CCCCCC"> to know</font>

607
00:26:31,080 --> 00:26:41,730
right away hey I've got 20 ntlm v1

608
00:26:34,830 --> 00:26:43,620
hashes or you know whatever that would

609
00:26:41,730 --> 00:26:46,049
be my own luck implementation we I

610
00:26:43,620 --> 00:26:49,760
usually pop that on either the cali box

611
00:26:46,049 --> 00:26:49,760
or whatever box<font color="#CCCCCC"> at</font><font color="#E5E5E5"> hi</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> gonna be</font><font color="#CCCCCC"> using</font>

612
00:27:08,480 --> 00:27:12,540
yeah so if he wanted to<font color="#E5E5E5"> go in if you had</font>

613
00:27:11,010 --> 00:27:14,610
<font color="#E5E5E5">pulling for instance my credit card</font>

614
00:27:12,540 --> 00:27:16,230
<font color="#E5E5E5">information there are ways using the the</font>

615
00:27:14,610 --> 00:27:17,969
configuration<font color="#CCCCCC"> file to actually say hey</font>

616
00:27:16,230 --> 00:27:19,740
just put access to the credit card

617
00:27:17,970 --> 00:27:22,350
information or you know whatever regit

618
00:27:19,740 --> 00:27:24,120
regex pattern really that you wanted for

619
00:27:22,350 --> 00:27:26,490
data that you didn't want the entire

620
00:27:24,120 --> 00:27:28,770
piece maybe<font color="#CCCCCC"> I only want 20 characters</font>

621
00:27:26,490 --> 00:27:29,910
<font color="#E5E5E5">outline instead of all 50 you could do</font>

622
00:27:28,770 --> 00:27:33,929
it Reggie Jackson and kind of pull<font color="#E5E5E5"> out</font>

623
00:27:29,910 --> 00:27:36,919
stuff or do whatever Graham anything

624
00:27:33,929 --> 00:27:36,919
<font color="#E5E5E5">else yes</font>

625
00:27:48,490 --> 00:27:53,210
technically it would be logged in small

626
00:27:50,840 --> 00:27:54,980
can be<font color="#E5E5E5"> in the internal logs um that's</font>

627
00:27:53,210 --> 00:27:57,470
normally not something I've noticed in

628
00:27:54,980 --> 00:27:59,300
engagement that people have like reports

629
00:27:57,470 --> 00:28:00,530
or alerts set up for yeah it is

630
00:27:59,300 --> 00:28:10,790
<font color="#E5E5E5">something</font><font color="#CCCCCC"> you would want to</font><font color="#E5E5E5"> go back</font><font color="#CCCCCC"> and</font>

631
00:28:00,530 --> 00:28:20,870
clean up so honey pot he wants to swung

632
00:28:10,790 --> 00:28:27,770
and roll off early application say they

633
00:28:20,870 --> 00:28:29,600
know you know yeah I mean<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> lot</font>

634
00:28:27,770 --> 00:28:31,730
of information<font color="#E5E5E5"> and I don't see a lot of</font>

635
00:28:29,600 --> 00:29:16,030
reports and obviously a lot<font color="#E5E5E5"> to more</font>

636
00:28:31,730 --> 00:29:18,560
people hat yeah it does it would have I

637
00:29:16,030 --> 00:29:20,629
don't think I have any customers that

638
00:29:18,560 --> 00:29:32,030
run it yet that's 65 yes but not

639
00:29:20,630 --> 00:29:33,170
<font color="#CCCCCC">multipad yeah</font><font color="#E5E5E5"> I mean I</font><font color="#CCCCCC"> would but</font><font color="#E5E5E5"> I would</font>

640
00:29:32,030 --> 00:29:34,760
still need that second factor

641
00:29:33,170 --> 00:29:40,970
authentication if that I mean if we're

642
00:29:34,760 --> 00:29:45,379
<font color="#CCCCCC">going that route yeah so what other</font>

643
00:29:40,970 --> 00:29:48,170
additional resources having something

644
00:29:45,380 --> 00:29:51,320
like lots of the last and quickly search

645
00:29:48,170 --> 00:29:52,690
the data allowing a quick from the

646
00:29:51,320 --> 00:29:57,189
right-hander

647
00:29:52,690 --> 00:29:59,090
suicide retino-a now I've got flagon

648
00:29:57,190 --> 00:30:01,190
<font color="#CCCCCC">pulling a whole bunch</font><font color="#E5E5E5"> of data very</font>

649
00:29:59,090 --> 00:30:04,760
quickly<font color="#CCCCCC"> climbs into</font><font color="#E5E5E5"> this what's the</font>

650
00:30:01,190 --> 00:30:06,020
equivalent on the residence I mean

651
00:30:04,760 --> 00:30:08,000
technically there isn't one I've been

652
00:30:06,020 --> 00:30:10,490
<font color="#E5E5E5">kind of building slowly building stuff</font>

653
00:30:08,000 --> 00:30:13,190
out on the pineapple<font color="#CCCCCC"> and responder one</font>

654
00:30:10,490 --> 00:30:16,190
dashboard that we have been<font color="#CCCCCC"> working on</font>

655
00:30:13,190 --> 00:31:01,429
an nmap show me really quickly<font color="#E5E5E5"> things</font>

656
00:30:16,190 --> 00:31:04,279
that are open<font color="#E5E5E5"> okay yeah and any of your</font>

657
00:31:01,429 --> 00:31:05,630
custom tools a lot of this if you start

658
00:31:04,279 --> 00:31:07,460
move migrating in the in this route

659
00:31:05,630 --> 00:31:10,370
you're going to have to either do a lot

660
00:31:07,460 --> 00:31:13,130
of configuration and reg reg ex matching

661
00:31:10,370 --> 00:31:14,629
to really get the true output on stuff

662
00:31:13,130 --> 00:31:18,409
or if you have custom stuff<font color="#E5E5E5"> to just</font>

663
00:31:14,630 --> 00:31:27,409
output to<font color="#E5E5E5"> JSON or CSV or XML something</font>

664
00:31:18,409 --> 00:31:30,010
standardized anything else cool<font color="#CCCCCC"> all</font>

665
00:31:27,409 --> 00:31:30,010
<font color="#CCCCCC">right thanks</font>

666
00:31:33,520 --> 00:31:35,580
you

