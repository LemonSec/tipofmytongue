1
00:00:08,760 --> 00:00:14,820
[Applause]

2
00:00:11,420 --> 00:00:17,039
you've got a crowd of hecklers<font color="#E5E5E5"> only it's</font>

3
00:00:14,820 --> 00:00:19,770
my pleasure for to<font color="#E5E5E5"> introduce here this</font>

4
00:00:17,039 --> 00:00:21,510
evening<font color="#CCCCCC"> this afternoon - Chad see my</font>

5
00:00:19,770 --> 00:00:24,029
internet dumpster diver

6
00:00:21,510 --> 00:00:27,420
<font color="#E5E5E5">DDoS researcher</font><font color="#CCCCCC"> hunter of botnets</font>

7
00:00:24,029 --> 00:00:29,269
<font color="#E5E5E5">diddler of malware in senior Security</font>

8
00:00:27,420 --> 00:00:31,410
<font color="#E5E5E5">Response Team engineer at Akamai</font>

9
00:00:29,269 --> 00:00:33,750
<font color="#E5E5E5">presenting with him is Rory Smith</font>

10
00:00:31,410 --> 00:00:35,940
<font color="#E5E5E5">computer and caffeine addict pocket</font>

11
00:00:33,750 --> 00:00:38,370
ninja<font color="#E5E5E5"> log crawler and first line</font><font color="#CCCCCC"> of</font>

12
00:00:35,940 --> 00:00:40,739
defense against<font color="#E5E5E5"> large-scale web app and</font>

13
00:00:38,370 --> 00:00:42,959
DDoS attacks targeting your favorite

14
00:00:40,739 --> 00:00:46,550
companies also<font color="#E5E5E5"> known as the senior sock</font>

15
00:00:42,960 --> 00:00:46,550
engine<font color="#E5E5E5"> specialist at Akamai</font>

16
00:00:52,420 --> 00:00:58,550
hey guys thanks<font color="#CCCCCC"> for having us the talk</font>

17
00:00:56,600 --> 00:01:01,280
we're gonna<font color="#E5E5E5"> give today is the wire X</font>

18
00:00:58,550 --> 00:01:03,860
botnet<font color="#CCCCCC"> and how shady apps lead to hot</font>

19
00:01:01,280 --> 00:01:06,920
pockets<font color="#E5E5E5"> and we'll hand it off to Rory</font>

20
00:01:03,860 --> 00:01:10,159
first<font color="#CCCCCC"> alright hey</font><font color="#E5E5E5"> everybody</font>

21
00:01:06,920 --> 00:01:13,159
pretty much here<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have a nice and</font>

22
00:01:10,159 --> 00:01:15,320
<font color="#CCCCCC">interesting attack to kind of bring in I</font>

23
00:01:13,159 --> 00:01:17,450
wanna just<font color="#E5E5E5"> at the timeline</font><font color="#CCCCCC"> bring you all</font>

24
00:01:15,320 --> 00:01:18,949
into the<font color="#CCCCCC"> sack</font><font color="#E5E5E5"> you're gonna become</font><font color="#CCCCCC"> one</font>

25
00:01:17,450 --> 00:01:21,729
with us you're gonna<font color="#E5E5E5"> feel our pain</font>

26
00:01:18,950 --> 00:01:24,110
the pressures on<font color="#E5E5E5"> every point of this and</font>

27
00:01:21,729 --> 00:01:26,000
pretty much show you how we work through

28
00:01:24,110 --> 00:01:27,410
it so if you've<font color="#E5E5E5"> ever worked in a sock</font>

29
00:01:26,000 --> 00:01:29,330
<font color="#CCCCCC">you're gonna feel like</font><font color="#E5E5E5"> this is another</font>

30
00:01:27,410 --> 00:01:31,100
<font color="#E5E5E5">day in the office if you haven't well</font>

31
00:01:29,330 --> 00:01:34,340
just get<font color="#E5E5E5"> ready</font><font color="#CCCCCC"> you're about</font><font color="#E5E5E5"> to get</font>

32
00:01:31,100 --> 00:01:37,490
strapped in and engage so on<font color="#E5E5E5"> August the</font>

33
00:01:34,340 --> 00:01:40,369
17th<font color="#E5E5E5"> we had pretty</font><font color="#CCCCCC"> much a slew of</font>

34
00:01:37,490 --> 00:01:43,399
attacks right<font color="#CCCCCC"> and it targeted all of our</font>

35
00:01:40,369 --> 00:01:45,020
hospitality customers so what's

36
00:01:43,399 --> 00:01:47,000
interesting<font color="#E5E5E5"> about this attack is</font><font color="#CCCCCC"> that</font>

37
00:01:45,020 --> 00:01:49,130
you know you're working<font color="#CCCCCC"> in a</font><font color="#E5E5E5"> sock you</font>

38
00:01:47,000 --> 00:01:51,110
get to know someone's infrastructure you

39
00:01:49,130 --> 00:01:53,060
get to tune it accordingly<font color="#CCCCCC"> you want to</font>

40
00:01:51,110 --> 00:01:55,130
protect them proactively<font color="#CCCCCC"> we always want</font>

41
00:01:53,060 --> 00:01:57,550
to go<font color="#E5E5E5"> towards a proactive solution</font><font color="#CCCCCC"> but</font>

42
00:01:55,130 --> 00:01:59,690
in this case normal<font color="#E5E5E5"> mitigation methods</font>

43
00:01:57,550 --> 00:02:01,819
<font color="#E5E5E5">didn't work none of our</font><font color="#CCCCCC"> proactive</font>

44
00:01:59,690 --> 00:02:03,619
solutions worked what was also

45
00:02:01,819 --> 00:02:07,069
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> is that</font><font color="#E5E5E5"> even our detection</font>

46
00:02:03,619 --> 00:02:08,840
methods<font color="#E5E5E5"> didn't work right</font><font color="#CCCCCC"> so and then</font>

47
00:02:07,069 --> 00:02:11,180
<font color="#E5E5E5">after that</font><font color="#CCCCCC"> for some of our</font><font color="#E5E5E5"> customers you</font>

48
00:02:08,840 --> 00:02:12,530
know have advanced mitigation<font color="#CCCCCC"> methods</font>

49
00:02:11,180 --> 00:02:15,170
depending<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the solution that</font><font color="#E5E5E5"> they have</font>

50
00:02:12,530 --> 00:02:18,050
and those also failed<font color="#E5E5E5"> so now we're</font>

51
00:02:15,170 --> 00:02:19,940
missing a<font color="#CCCCCC"> lot of information now we're</font>

52
00:02:18,050 --> 00:02:22,370
unable to<font color="#E5E5E5"> detect it we're unable to</font>

53
00:02:19,940 --> 00:02:26,000
mitigate<font color="#E5E5E5"> it proactively and that's what</font>

54
00:02:22,370 --> 00:02:28,760
we walk<font color="#CCCCCC"> into starting</font><font color="#E5E5E5"> a day so what's so</font>

55
00:02:26,000 --> 00:02:31,940
special<font color="#CCCCCC"> about wirings right so what</font>

56
00:02:28,760 --> 00:02:36,319
we're looking on is<font color="#E5E5E5"> 70,000 unique IP</font>

57
00:02:31,940 --> 00:02:38,540
addresses right so<font color="#E5E5E5"> 70,000 infected</font>

58
00:02:36,319 --> 00:02:40,429
devices connected at one<font color="#CCCCCC"> time and I</font>

59
00:02:38,540 --> 00:02:43,280
<font color="#CCCCCC">think</font><font color="#E5E5E5"> there's still being a bit modest</font>

60
00:02:40,430 --> 00:02:44,959
because<font color="#CCCCCC"> we saw quite a few more but</font>

61
00:02:43,280 --> 00:02:48,200
we're gonna go ahead<font color="#CCCCCC"> and</font><font color="#E5E5E5"> just hold it</font><font color="#CCCCCC"> at</font>

62
00:02:44,959 --> 00:02:50,629
70,000<font color="#E5E5E5"> and these addresses they result</font>

63
00:02:48,200 --> 00:02:52,670
primarily<font color="#CCCCCC"> to mobile networks</font><font color="#E5E5E5"> not always</font>

64
00:02:50,629 --> 00:02:54,440
<font color="#CCCCCC">cuz you know</font><font color="#E5E5E5"> you may</font><font color="#CCCCCC"> have your phone and</font>

65
00:02:52,670 --> 00:02:56,929
it's connected on<font color="#CCCCCC"> the Wi-Fi</font><font color="#E5E5E5"> it's not</font>

66
00:02:54,440 --> 00:02:59,120
necessarily always<font color="#E5E5E5"> mobile but one of the</font>

67
00:02:56,930 --> 00:02:59,819
trends that<font color="#E5E5E5"> we saw with it later on is</font>

68
00:02:59,120 --> 00:03:01,769
<font color="#CCCCCC">that it</font>

69
00:02:59,819 --> 00:03:02,920
<font color="#E5E5E5">definitely mobile networks</font>

70
00:03:01,769 --> 00:03:05,260
geographically

71
00:03:02,920 --> 00:03:08,549
<font color="#E5E5E5">no that was completely dispersed again</font>

72
00:03:05,260 --> 00:03:10,899
we have a hundred<font color="#E5E5E5"> countries here however</font>

73
00:03:08,550 --> 00:03:13,959
actually being there on the ground

74
00:03:10,900 --> 00:03:17,080
<font color="#E5E5E5">looking at it we saw</font><font color="#CCCCCC"> 172 plus so</font>

75
00:03:13,959 --> 00:03:19,060
definitely<font color="#E5E5E5"> more and it bypassed all our</font>

76
00:03:17,080 --> 00:03:21,430
standard security<font color="#E5E5E5"> anomaly detection</font><font color="#CCCCCC"> x'</font>

77
00:03:19,060 --> 00:03:24,220
that we had in<font color="#E5E5E5"> place it bypassed</font>

78
00:03:21,430 --> 00:03:27,549
proactive control methods and it also

79
00:03:24,220 --> 00:03:30,160
even bypassed our basic JavaScript<font color="#CCCCCC"> real</font>

80
00:03:27,549 --> 00:03:32,290
browser challenges so whatever this bot

81
00:03:30,160 --> 00:03:33,700
was it they knew what<font color="#E5E5E5"> they were</font><font color="#CCCCCC"> doing</font>

82
00:03:32,290 --> 00:03:35,500
these<font color="#E5E5E5"> attackers knew what they were</font>

83
00:03:33,700 --> 00:03:39,578
<font color="#CCCCCC">building on what they were targeting and</font>

84
00:03:35,500 --> 00:03:43,239
then<font color="#E5E5E5"> now let's go back</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> in the sack</font>

85
00:03:39,579 --> 00:03:45,970
and we're finding<font color="#E5E5E5"> the mushroom cloud so</font>

86
00:03:43,239 --> 00:03:48,250
the title<font color="#E5E5E5"> says it all because you're in</font>

87
00:03:45,970 --> 00:03:52,349
you're sitting down<font color="#E5E5E5"> your phone rings and</font>

88
00:03:48,250 --> 00:03:54,579
the<font color="#CCCCCC"> first call is we've gotta save</font><font color="#E5E5E5"> one</font>

89
00:03:52,349 --> 00:03:57,670
critical business<font color="#CCCCCC"> infrastructure is</font>

90
00:03:54,579 --> 00:03:59,799
impacted<font color="#E5E5E5"> websites down right now we're</font>

91
00:03:57,670 --> 00:04:00,129
<font color="#CCCCCC">making no money</font><font color="#E5E5E5"> here's a bridge get on</font>

92
00:03:59,799 --> 00:04:03,010
it

93
00:04:00,129 --> 00:04:04,780
we need your<font color="#E5E5E5"> help</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> no warning you</font>

94
00:04:03,010 --> 00:04:07,420
know you love those blind<font color="#E5E5E5"> calls you're</font>

95
00:04:04,780 --> 00:04:09,400
going<font color="#E5E5E5"> into it blind</font><font color="#CCCCCC"> you get on and you</font>

96
00:04:07,420 --> 00:04:11,230
know<font color="#E5E5E5"> you're we're all seasoned sucks now</font>

97
00:04:09,400 --> 00:04:13,359
<font color="#E5E5E5">so we're going</font><font color="#CCCCCC"> through</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> lives what</font>

98
00:04:11,230 --> 00:04:14,709
can<font color="#E5E5E5"> we see what can we find</font><font color="#CCCCCC"> right so</font>

99
00:04:13,359 --> 00:04:16,329
we're looking<font color="#CCCCCC"> on let's say we have our</font>

100
00:04:14,709 --> 00:04:18,010
<font color="#CCCCCC">mud</font><font color="#E5E5E5"> security rules we've got our snort</font>

101
00:04:16,329 --> 00:04:20,380
rules we've got everything<font color="#CCCCCC"> engaging</font>

102
00:04:18,010 --> 00:04:24,219
we're checking no triggers we've got

103
00:04:20,380 --> 00:04:27,250
rate controls no triggers so at this

104
00:04:24,220 --> 00:04:29,650
point it's hey did somebody on<font color="#CCCCCC"> your site</font>

105
00:04:27,250 --> 00:04:32,289
do some maintenance<font color="#E5E5E5"> maybe open maybe you</font>

106
00:04:29,650 --> 00:04:33,580
tried<font color="#E5E5E5"> contact a system team did they try</font>

107
00:04:32,289 --> 00:04:36,550
to<font color="#CCCCCC"> update something</font><font color="#E5E5E5"> and bring down your</font>

108
00:04:33,580 --> 00:04:39,240
<font color="#E5E5E5">app we say that a lot</font><font color="#CCCCCC"> but maybe that's</font>

109
00:04:36,550 --> 00:04:41,260
<font color="#E5E5E5">what's going on so we</font><font color="#CCCCCC"> said ok</font><font color="#E5E5E5"> while</font>

110
00:04:39,240 --> 00:04:43,870
everybody<font color="#E5E5E5"> is engaged and doing their</font>

111
00:04:41,260 --> 00:04:46,659
thing<font color="#E5E5E5"> let's actually go on the traffic</font>

112
00:04:43,870 --> 00:04:48,580
side<font color="#E5E5E5"> what does traffic look like usually</font>

113
00:04:46,660 --> 00:04:51,340
someone's network operations made up

114
00:04:48,580 --> 00:04:54,280
<font color="#E5E5E5">made perform those tasks since you won't</font>

115
00:04:51,340 --> 00:04:56,289
<font color="#E5E5E5">really go to a</font><font color="#CCCCCC"> sock and just say are the</font>

116
00:04:54,280 --> 00:04:58,450
<font color="#E5E5E5">traffic so we</font><font color="#CCCCCC"> know that business is</font>

117
00:04:56,289 --> 00:04:59,770
impacted<font color="#E5E5E5"> and it's going down so if there</font>

118
00:04:58,450 --> 00:05:01,630
<font color="#E5E5E5">was an attack capable of bringing in a</font>

119
00:04:59,770 --> 00:05:03,760
<font color="#CCCCCC">down we must be able</font><font color="#E5E5E5"> to see it in</font>

120
00:05:01,630 --> 00:05:05,139
<font color="#E5E5E5">traffic right</font><font color="#CCCCCC"> so we started</font><font color="#E5E5E5"> looking on</font>

121
00:05:03,760 --> 00:05:07,870
let's say the hits per second to the

122
00:05:05,139 --> 00:05:11,349
<font color="#E5E5E5">site now fairly popular</font><font color="#CCCCCC"> sites so it has</font>

123
00:05:07,870 --> 00:05:12,160
its usual 250 to 500 per second logs

124
00:05:11,349 --> 00:05:15,909
usually

125
00:05:12,160 --> 00:05:18,220
and then immediately we<font color="#E5E5E5"> see 20,000 right</font>

126
00:05:15,910 --> 00:05:19,930
so<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> 20,000 per second millions are</font>

127
00:05:18,220 --> 00:05:22,300
<font color="#CCCCCC">logs per minute now being filled</font><font color="#E5E5E5"> and</font>

128
00:05:19,930 --> 00:05:23,980
some customers<font color="#CCCCCC"> to their benefit they</font>

129
00:05:22,300 --> 00:05:26,110
were actually able<font color="#E5E5E5"> to stay up their</font>

130
00:05:23,980 --> 00:05:29,710
server logs were<font color="#CCCCCC"> 70 percent 80 percent</font>

131
00:05:26,110 --> 00:05:33,160
their CPUs and other customers they were

132
00:05:29,710 --> 00:05:35,049
<font color="#E5E5E5">completely down so</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> whatever this</font><font color="#CCCCCC"> is</font>

133
00:05:33,160 --> 00:05:37,180
it can do<font color="#CCCCCC"> twenty thousand per second and</font>

134
00:05:35,050 --> 00:05:38,440
at the same time not trigger<font color="#CCCCCC"> an alert</font>

135
00:05:37,180 --> 00:05:41,110
<font color="#E5E5E5">that's weird</font>

136
00:05:38,440 --> 00:05:43,150
<font color="#CCCCCC">on the security side</font><font color="#E5E5E5"> so I decided let's</font>

137
00:05:41,110 --> 00:05:46,600
go ahead<font color="#E5E5E5"> and look on your valid traffic</font>

138
00:05:43,150 --> 00:05:49,450
let's see what's<font color="#E5E5E5"> actually in those logs</font>

139
00:05:46,600 --> 00:05:50,950
right now not really<font color="#E5E5E5"> any is a task from</font>

140
00:05:49,450 --> 00:05:53,770
our side since from<font color="#E5E5E5"> the security</font>

141
00:05:50,950 --> 00:05:56,680
perspective<font color="#E5E5E5"> we</font><font color="#CCCCCC"> want to go ahead and what</font>

142
00:05:53,770 --> 00:05:58,120
we do is we tag it<font color="#CCCCCC"> as malicious and</font><font color="#E5E5E5"> we</font>

143
00:05:56,680 --> 00:06:00,460
get we want<font color="#E5E5E5"> to preserve those headers</font>

144
00:05:58,120 --> 00:06:01,990
<font color="#CCCCCC">because</font><font color="#E5E5E5"> just if you go into</font><font color="#CCCCCC"> your Apache</font>

145
00:06:00,460 --> 00:06:04,989
log you're gonna get some details

146
00:06:01,990 --> 00:06:07,930
headers aren't preserved<font color="#E5E5E5"> right so once</font>

147
00:06:04,990 --> 00:06:09,700
we<font color="#E5E5E5"> get that going maybe on your sock you</font>

148
00:06:07,930 --> 00:06:12,880
may have a<font color="#CCCCCC"> TCP dump that</font><font color="#E5E5E5"> you can open</font><font color="#CCCCCC"> it</font>

149
00:06:09,700 --> 00:06:15,280
and see it live we see that pretty much

150
00:06:12,880 --> 00:06:17,860
<font color="#E5E5E5">the traffic looks fairly well with the</font>

151
00:06:15,280 --> 00:06:20,859
exception<font color="#CCCCCC"> of the user agent</font><font color="#E5E5E5"> looking on</font>

152
00:06:17,860 --> 00:06:23,590
that<font color="#E5E5E5"> user agent we can see 26 characters</font>

153
00:06:20,860 --> 00:06:25,450
randomly strung together<font color="#E5E5E5"> right so when</font>

154
00:06:23,590 --> 00:06:28,989
you're<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the logs</font><font color="#CCCCCC"> it's clear as</font><font color="#E5E5E5"> day</font>

155
00:06:25,450 --> 00:06:32,080
now when IDs is looking at it<font color="#E5E5E5"> it's a</font>

156
00:06:28,990 --> 00:06:34,660
unique IP and a unique user agent so

157
00:06:32,080 --> 00:06:36,729
it's<font color="#CCCCCC"> treating</font><font color="#E5E5E5"> that as unique traffic</font>

158
00:06:34,660 --> 00:06:38,770
right so<font color="#E5E5E5"> nothing to see</font><font color="#CCCCCC"> here maybe it's</font>

159
00:06:36,730 --> 00:06:42,070
just a marketing<font color="#E5E5E5"> campaign and that's why</font>

160
00:06:38,770 --> 00:06:44,710
their traffic doubled right<font color="#E5E5E5"> so now we</font>

161
00:06:42,070 --> 00:06:46,659
can we can identify it<font color="#E5E5E5"> that's no problem</font>

162
00:06:44,710 --> 00:06:49,560
<font color="#E5E5E5">let's let's build some more profile</font>

163
00:06:46,660 --> 00:06:52,480
around<font color="#E5E5E5"> it right so we've got get floods</font>

164
00:06:49,560 --> 00:06:54,520
post requests and get requests we

165
00:06:52,480 --> 00:06:57,880
already identify the user<font color="#CCCCCC"> agent and that</font>

166
00:06:54,520 --> 00:06:59,950
<font color="#CCCCCC">the IPS were all unique</font><font color="#E5E5E5"> now the rate is</font>

167
00:06:57,880 --> 00:07:02,200
interesting they're getting brought down

168
00:06:59,950 --> 00:07:04,780
however<font color="#E5E5E5"> looking through the logs we have</font>

169
00:07:02,200 --> 00:07:07,330
a lot<font color="#CCCCCC"> of IP addresses we were clocking</font>

170
00:07:04,780 --> 00:07:10,599
<font color="#E5E5E5">it at maybe three requests per second</font>

171
00:07:07,330 --> 00:07:13,090
per IP address at near its peak<font color="#CCCCCC"> no</font>

172
00:07:10,600 --> 00:07:15,640
that's definitely<font color="#E5E5E5"> territories where if</font>

173
00:07:13,090 --> 00:07:18,750
you go rate control<font color="#E5E5E5"> you're going to hit</font>

174
00:07:15,640 --> 00:07:21,700
legitimate<font color="#CCCCCC"> traffic so from there and</font>

175
00:07:18,750 --> 00:07:24,370
I'll go into<font color="#CCCCCC"> the next</font><font color="#E5E5E5"> line a little</font><font color="#CCCCCC"> bit</font>

176
00:07:21,700 --> 00:07:25,960
<font color="#E5E5E5">later because the attacker</font><font color="#CCCCCC"> appeared to</font>

177
00:07:24,370 --> 00:07:28,690
be actively monitoring which will call

178
00:07:25,960 --> 00:07:31,900
<font color="#E5E5E5">over in a second and overall the volume</font>

179
00:07:28,690 --> 00:07:33,610
<font color="#E5E5E5">traffic was high enough to him</font><font color="#CCCCCC"> to impact</font>

180
00:07:31,900 --> 00:07:36,849
<font color="#E5E5E5">your infrastructure right so these</font><font color="#CCCCCC"> are</font>

181
00:07:33,610 --> 00:07:39,400
what we know now<font color="#E5E5E5"> fairly easy we've got</font>

182
00:07:36,849 --> 00:07:41,620
26 character user agent<font color="#E5E5E5"> we've got some</font>

183
00:07:39,400 --> 00:07:43,690
pretty decent<font color="#E5E5E5"> regex skills going on so</font>

184
00:07:41,620 --> 00:07:45,490
let's just drop this one right<font color="#E5E5E5"> this is</font>

185
00:07:43,690 --> 00:07:48,009
basic<font color="#E5E5E5"> right so we're</font><font color="#CCCCCC"> just saying</font><font color="#E5E5E5"> a to</font><font color="#CCCCCC"> Z</font>

186
00:07:45,490 --> 00:07:50,020
<font color="#E5E5E5">26 make sure you put that dollar sign in</font>

187
00:07:48,009 --> 00:07:52,900
the end but<font color="#CCCCCC"> for some mitigation</font>

188
00:07:50,020 --> 00:07:54,669
appliances<font color="#E5E5E5"> some of our clients let's say</font>

189
00:07:52,900 --> 00:07:56,859
<font color="#E5E5E5">they don't just have</font><font color="#CCCCCC"> one domain right</font>

190
00:07:54,669 --> 00:08:00,490
they have maybe<font color="#CCCCCC"> 10 15</font><font color="#E5E5E5"> domains and that</font>

191
00:07:56,860 --> 00:08:02,050
<font color="#CCCCCC">is really popular domains</font><font color="#E5E5E5"> you don't want</font>

192
00:08:00,490 --> 00:08:04,300
to just<font color="#E5E5E5"> use</font><font color="#CCCCCC"> reg X that can be</font>

193
00:08:02,050 --> 00:08:06,160
computationally expensive<font color="#E5E5E5"> so you don't</font>

194
00:08:04,300 --> 00:08:08,500
want to be<font color="#E5E5E5"> inspecting on everything</font><font color="#CCCCCC"> we</font>

195
00:08:06,160 --> 00:08:10,150
<font color="#E5E5E5">just want to cut that traffic first so</font>

196
00:08:08,500 --> 00:08:12,340
we figured out the<font color="#CCCCCC"> domain</font><font color="#E5E5E5"> from the</font><font color="#CCCCCC"> locks</font>

197
00:08:10,150 --> 00:08:15,549
before<font color="#E5E5E5"> and we already saw</font><font color="#CCCCCC"> that we had</font>

198
00:08:12,340 --> 00:08:17,138
get and post requests so let's just make

199
00:08:15,550 --> 00:08:19,919
a rule pretty much those<font color="#CCCCCC"> are the</font>

200
00:08:17,139 --> 00:08:22,810
criteria<font color="#E5E5E5"> is there and pretty easy</font>

201
00:08:19,919 --> 00:08:25,359
<font color="#E5E5E5">now attack mitigated beautiful everybody</font>

202
00:08:22,810 --> 00:08:27,639
is happy<font color="#CCCCCC"> right so attacks mitigated</font>

203
00:08:25,360 --> 00:08:30,490
<font color="#CCCCCC">servers our back</font><font color="#E5E5E5"> CPU levels are great</font>

204
00:08:27,639 --> 00:08:32,349
<font color="#CCCCCC">websites stable</font><font color="#E5E5E5"> customers</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> awesome</font>

205
00:08:30,490 --> 00:08:35,950
<font color="#CCCCCC">and ready to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> back to business</font>

206
00:08:32,349 --> 00:08:37,719
and then the<font color="#CCCCCC"> cycle is</font><font color="#E5E5E5"> down again and now</font>

207
00:08:35,950 --> 00:08:38,560
we're wondering hey what's going on this

208
00:08:37,719 --> 00:08:41,200
<font color="#E5E5E5">is</font><font color="#CCCCCC"> weird</font>

209
00:08:38,559 --> 00:08:43,239
so then we'll start looking<font color="#CCCCCC"> on the logs</font>

210
00:08:41,200 --> 00:08:45,880
again<font color="#E5E5E5"> we're already mitigating some now</font>

211
00:08:43,240 --> 00:08:47,740
they're playing with the length and then

212
00:08:45,880 --> 00:08:49,450
taunting us noscitur<font color="#CCCCCC"> like oh you know</font>

213
00:08:47,740 --> 00:08:50,829
what we've got ahead<font color="#E5E5E5"> and throw digits in</font>

214
00:08:49,450 --> 00:08:54,820
there<font color="#E5E5E5"> - what are you gonna do next</font>

215
00:08:50,829 --> 00:08:56,469
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so again</font><font color="#E5E5E5"> we know what good user</font>

216
00:08:54,820 --> 00:08:57,820
agents look like we<font color="#CCCCCC"> know what bad we</font>

217
00:08:56,470 --> 00:09:00,520
know what characters to expect or

218
00:08:57,820 --> 00:09:03,670
characters<font color="#E5E5E5"> not to expect and we can go</font>

219
00:09:00,520 --> 00:09:06,550
<font color="#E5E5E5">ahead and start</font><font color="#CCCCCC"> making more</font><font color="#E5E5E5"> reg X's now</font>

220
00:09:03,670 --> 00:09:08,800
after that every<font color="#CCCCCC"> time we made it they</font>

221
00:09:06,550 --> 00:09:11,529
change it and then of course<font color="#E5E5E5"> they went</font>

222
00:09:08,800 --> 00:09:14,439
over<font color="#CCCCCC"> - what are you gonna</font><font color="#E5E5E5"> do when we hit</font>

223
00:09:11,529 --> 00:09:16,480
you<font color="#E5E5E5"> with legitimate user agents right so</font>

224
00:09:14,440 --> 00:09:19,000
now we're<font color="#CCCCCC"> getting</font><font color="#E5E5E5"> legitimates so now</font>

225
00:09:16,480 --> 00:09:20,890
this<font color="#E5E5E5"> is this is ours going now because</font>

226
00:09:19,000 --> 00:09:24,640
<font color="#E5E5E5">we've got whack-a-mole going now we've</font>

227
00:09:20,890 --> 00:09:26,860
got pretty<font color="#E5E5E5"> much you know</font><font color="#CCCCCC"> legitimate user</font>

228
00:09:24,640 --> 00:09:28,750
agents which we can't just make<font color="#CCCCCC"> a custom</font>

229
00:09:26,860 --> 00:09:31,390
rule to drop<font color="#E5E5E5"> so now we've got to get</font>

230
00:09:28,750 --> 00:09:32,680
<font color="#E5E5E5">more proactive because at this point we</font>

231
00:09:31,390 --> 00:09:35,260
have a case<font color="#E5E5E5"> where our customers are</font>

232
00:09:32,680 --> 00:09:37,870
saying every<font color="#CCCCCC"> time you make a rule</font><font color="#E5E5E5"> you</font>

233
00:09:35,260 --> 00:09:38,620
fix the problem<font color="#CCCCCC"> but</font><font color="#E5E5E5"> between each of your</font>

234
00:09:37,870 --> 00:09:40,240
rules

235
00:09:38,620 --> 00:09:43,420
were feelin impact<font color="#E5E5E5"> and it's getting</font>

236
00:09:40,240 --> 00:09:45,340
really<font color="#E5E5E5"> bad</font><font color="#CCCCCC"> so at this point</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> you</font>

237
00:09:43,420 --> 00:09:48,579
know our<font color="#CCCCCC"> advanced mechanisms they're not</font>

238
00:09:45,340 --> 00:09:51,580
<font color="#CCCCCC">working</font><font color="#E5E5E5"> because this is whatever this is</font>

239
00:09:48,580 --> 00:09:53,980
<font color="#E5E5E5">it's currently bypassing those so we've</font>

240
00:09:51,580 --> 00:09:57,010
got<font color="#E5E5E5"> user oldies but goodies and we've</font>

241
00:09:53,980 --> 00:09:59,710
got a pretty much just lower the levels

242
00:09:57,010 --> 00:10:02,460
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so we had to use multiple controls</font>

243
00:09:59,710 --> 00:10:05,830
<font color="#CCCCCC">after this right we have geo blocks</font>

244
00:10:02,460 --> 00:10:09,940
aggressive rate controls<font color="#CCCCCC"> network lists</font>

245
00:10:05,830 --> 00:10:12,400
<font color="#E5E5E5">and each of well combined</font><font color="#CCCCCC"> it definitely</font>

246
00:10:09,940 --> 00:10:14,770
mitigated<font color="#E5E5E5"> the problem individually each</font>

247
00:10:12,400 --> 00:10:17,199
had their<font color="#E5E5E5"> own set of</font><font color="#CCCCCC"> problems so let's</font>

248
00:10:14,770 --> 00:10:21,370
say we<font color="#CCCCCC"> start with a</font><font color="#E5E5E5"> blacklist in this is</font>

249
00:10:17,200 --> 00:10:23,320
hospitality so some of our customers say

250
00:10:21,370 --> 00:10:24,780
hey we've<font color="#CCCCCC"> got a global</font><font color="#E5E5E5"> presence</font><font color="#CCCCCC"> people</font>

251
00:10:23,320 --> 00:10:27,670
buy<font color="#CCCCCC"> tickets from</font><font color="#E5E5E5"> us all over the world</font>

252
00:10:24,780 --> 00:10:29,410
<font color="#CCCCCC">people want to stay in hotels</font><font color="#E5E5E5"> and they</font>

253
00:10:27,670 --> 00:10:31,660
come from<font color="#E5E5E5"> all</font><font color="#CCCCCC"> over to book we can't just</font>

254
00:10:29,410 --> 00:10:33,120
go<font color="#CCCCCC"> on</font><font color="#E5E5E5"> black countries randomly you're</font>

255
00:10:31,660 --> 00:10:35,650
gonna you're gonna cost us<font color="#E5E5E5"> money so</font>

256
00:10:33,120 --> 00:10:38,470
those this wouldn't be a great<font color="#E5E5E5"> option</font>

257
00:10:35,650 --> 00:10:39,970
right<font color="#E5E5E5"> but for other customers they're</font>

258
00:10:38,470 --> 00:10:43,080
like hey<font color="#E5E5E5"> you know what most of our</font>

259
00:10:39,970 --> 00:10:48,130
<font color="#E5E5E5">income is coming from the US or Europe</font>

260
00:10:43,080 --> 00:10:52,330
<font color="#E5E5E5">right now</font><font color="#CCCCCC"> I've got $0 coming in let's go</font>

261
00:10:48,130 --> 00:10:53,830
ahead and block everybody<font color="#E5E5E5"> else then we</font>

262
00:10:52,330 --> 00:10:56,290
<font color="#E5E5E5">use the aggressive rate controls was</font>

263
00:10:53,830 --> 00:10:59,290
said over<font color="#E5E5E5"> overall we're seeing</font><font color="#CCCCCC"> three</font>

264
00:10:56,290 --> 00:11:02,469
requests per second right<font color="#E5E5E5"> so on</font><font color="#CCCCCC"> average</font>

265
00:10:59,290 --> 00:11:05,920
three requests per second so legitimate

266
00:11:02,470 --> 00:11:08,140
users can pretty much trigger a three

267
00:11:05,920 --> 00:11:10,569
requests per second easy<font color="#CCCCCC"> however</font><font color="#E5E5E5"> do you</font>

268
00:11:08,140 --> 00:11:12,460
expect it to<font color="#E5E5E5"> sustain</font><font color="#CCCCCC"> over five seconds</font>

269
00:11:10,570 --> 00:11:14,320
<font color="#E5E5E5">do you expect it</font><font color="#CCCCCC"> to sustain over</font><font color="#E5E5E5"> a</font>

270
00:11:12,460 --> 00:11:16,150
minute or two<font color="#CCCCCC"> minutes so should a</font>

271
00:11:14,320 --> 00:11:18,790
legitimate user be doing three requests

272
00:11:16,150 --> 00:11:21,640
<font color="#E5E5E5">per second for two minutes that's</font>

273
00:11:18,790 --> 00:11:23,530
<font color="#CCCCCC">definitely</font><font color="#E5E5E5"> not expected at that point so</font>

274
00:11:21,640 --> 00:11:26,250
<font color="#CCCCCC">we could get more aggressive</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> our</font>

275
00:11:23,530 --> 00:11:28,540
<font color="#E5E5E5">rate controls</font><font color="#CCCCCC"> tune in accordingly and</font>

276
00:11:26,250 --> 00:11:31,690
from there for some of<font color="#CCCCCC"> our customers</font>

277
00:11:28,540 --> 00:11:36,459
<font color="#CCCCCC">that resulted in some legitimate client</font>

278
00:11:31,690 --> 00:11:39,010
<font color="#E5E5E5">impact others of</font><font color="#CCCCCC"> course had no impact so</font>

279
00:11:36,460 --> 00:11:40,720
this was definitely<font color="#E5E5E5"> a good one but again</font>

280
00:11:39,010 --> 00:11:42,700
if we have two<font color="#E5E5E5"> customers getting dropped</font>

281
00:11:40,720 --> 00:11:44,650
as opposed to<font color="#E5E5E5"> everybody being unable to</font>

282
00:11:42,700 --> 00:11:46,780
<font color="#E5E5E5">access a site this is effective and</font>

283
00:11:44,650 --> 00:11:50,319
acceptable<font color="#CCCCCC"> to</font><font color="#E5E5E5"> them and then we had</font>

284
00:11:46,780 --> 00:11:52,240
network lists right<font color="#E5E5E5"> so network list it</font>

285
00:11:50,320 --> 00:11:54,130
was great at the<font color="#E5E5E5"> start</font>

286
00:11:52,240 --> 00:11:56,110
you need something immediate<font color="#E5E5E5"> you need to</font>

287
00:11:54,130 --> 00:11:58,870
shave off<font color="#CCCCCC"> some of those top talkers and</font>

288
00:11:56,110 --> 00:12:01,540
get that<font color="#CCCCCC"> sight a little less load</font><font color="#E5E5E5"> but</font>

289
00:11:58,870 --> 00:12:02,830
this was exhaustive super exhaustive

290
00:12:01,540 --> 00:12:05,140
when you're<font color="#E5E5E5"> pulling</font><font color="#CCCCCC"> loads</font><font color="#E5E5E5"> and you're</font>

291
00:12:02,830 --> 00:12:07,930
pulling<font color="#CCCCCC"> loads then you have 50,000 lines</font>

292
00:12:05,140 --> 00:12:10,870
<font color="#CCCCCC">of code</font><font color="#E5E5E5"> with 30,000</font><font color="#CCCCCC"> different IPS</font><font color="#E5E5E5"> you</font>

293
00:12:07,930 --> 00:12:14,050
<font color="#E5E5E5">can imagine how exhaustive that must get</font>

294
00:12:10,870 --> 00:12:16,029
<font color="#E5E5E5">to even</font><font color="#CCCCCC"> add them to a list</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> even when</font>

295
00:12:14,050 --> 00:12:17,920
you<font color="#E5E5E5"> think</font><font color="#CCCCCC"> about it we did see this</font><font color="#E5E5E5"> as a</font>

296
00:12:16,029 --> 00:12:21,250
<font color="#CCCCCC">mobile network</font><font color="#E5E5E5"> so if you think about</font>

297
00:12:17,920 --> 00:12:24,699
your drive here your<font color="#CCCCCC"> flight here</font><font color="#E5E5E5"> you may</font>

298
00:12:21,250 --> 00:12:28,120
have<font color="#CCCCCC"> changed IP addresses</font><font color="#E5E5E5"> 10 times right</font>

299
00:12:24,700 --> 00:12:31,870
<font color="#E5E5E5">and conservative so 10 times</font><font color="#CCCCCC"> in which</font>

300
00:12:28,120 --> 00:12:33,670
case one infected IP could do<font color="#E5E5E5"> 10 IP</font>

301
00:12:31,870 --> 00:12:37,390
address<font color="#CCCCCC"> attacker from</font><font color="#E5E5E5"> 10 different IP</font>

302
00:12:33,670 --> 00:12:40,060
address this was super temporary but if

303
00:12:37,390 --> 00:12:42,699
they're feeling<font color="#CCCCCC"> impact were engaged</font><font color="#E5E5E5"> and</font>

304
00:12:40,060 --> 00:12:45,040
of course we're using<font color="#E5E5E5"> every tool at our</font>

305
00:12:42,700 --> 00:12:47,709
disposal<font color="#CCCCCC"> so from a combination of those</font>

306
00:12:45,040 --> 00:12:50,050
three<font color="#E5E5E5"> we're able to pretty much mitigate</font>

307
00:12:47,709 --> 00:12:52,599
the attack make our custom rules as well

308
00:12:50,050 --> 00:12:55,029
and<font color="#CCCCCC"> tunas needed if they called in and</font>

309
00:12:52,600 --> 00:12:57,880
<font color="#CCCCCC">said hey our customers are impacted</font><font color="#E5E5E5"> then</font>

310
00:12:55,029 --> 00:12:59,709
you know we would go<font color="#E5E5E5"> figure</font><font color="#CCCCCC"> out a way</font>

311
00:12:57,880 --> 00:13:01,120
maybe<font color="#E5E5E5"> increase the threshold a bit and</font>

312
00:12:59,709 --> 00:13:02,770
make<font color="#E5E5E5"> sure that the load that they're</font>

313
00:13:01,120 --> 00:13:04,899
seen on their side isn't<font color="#E5E5E5"> too much and</font>

314
00:13:02,770 --> 00:13:07,149
pretty much<font color="#E5E5E5"> just go on and from there we</font>

315
00:13:04,899 --> 00:13:10,149
got them through the hard<font color="#CCCCCC"> part of this</font>

316
00:13:07,149 --> 00:13:13,120
attack<font color="#E5E5E5"> right so now that that's done we</font>

317
00:13:10,149 --> 00:13:15,820
<font color="#CCCCCC">just</font><font color="#E5E5E5"> go ahead and call our cert team or</font>

318
00:13:13,120 --> 00:13:18,520
<font color="#E5E5E5">Chad here and I'm like hey Chad this</font><font color="#CCCCCC"> is</font>

319
00:13:15,820 --> 00:13:20,850
<font color="#CCCCCC">a button</font><font color="#E5E5E5"> it it's super annoying</font><font color="#CCCCCC"> and</font>

320
00:13:18,520 --> 00:13:23,439
we've been dealing with this all weekend

321
00:13:20,850 --> 00:13:25,360
<font color="#E5E5E5">interesting thing looks like it's coming</font>

322
00:13:23,440 --> 00:13:32,020
from<font color="#E5E5E5"> mobile networks go ahead and check</font>

323
00:13:25,360 --> 00:13:35,649
<font color="#E5E5E5">it</font><font color="#CCCCCC"> out this is where I come in</font><font color="#E5E5E5"> love</font>

324
00:13:32,020 --> 00:13:38,770
botnets the best<font color="#CCCCCC"> I always</font><font color="#E5E5E5"> love finding a</font>

325
00:13:35,649 --> 00:13:40,630
new botnet it's always a good<font color="#E5E5E5"> day</font><font color="#CCCCCC"> it</font>

326
00:13:38,770 --> 00:13:41,110
sucks for<font color="#E5E5E5"> the internet but it's a lot</font><font color="#CCCCCC"> of</font>

327
00:13:40,630 --> 00:13:44,950
fun for me

328
00:13:41,110 --> 00:13:47,260
<font color="#E5E5E5">so this sounds especially interesting as</font>

329
00:13:44,950 --> 00:13:48,880
soon as I get<font color="#E5E5E5"> any details from it and</font>

330
00:13:47,260 --> 00:13:50,319
I'm<font color="#CCCCCC"> just like give me</font><font color="#E5E5E5"> the data</font><font color="#CCCCCC"> give me</font>

331
00:13:48,880 --> 00:13:54,100
what we need<font color="#CCCCCC"> let's start digging</font><font color="#E5E5E5"> now</font>

332
00:13:50,320 --> 00:13:57,430
<font color="#E5E5E5">before I go</font><font color="#CCCCCC"> any further there</font><font color="#E5E5E5"> are some</font>

333
00:13:54,100 --> 00:13:59,020
things<font color="#CCCCCC"> that led up to the discoveries</font>

334
00:13:57,430 --> 00:14:02,739
that<font color="#E5E5E5"> we'll talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that I can't talk</font>

335
00:13:59,020 --> 00:14:04,089
<font color="#CCCCCC">about</font><font color="#E5E5E5"> just as supposedly Napoleon said</font>

336
00:14:02,740 --> 00:14:05,010
never interfere with your enemy when

337
00:14:04,089 --> 00:14:06,520
he's<font color="#E5E5E5"> making a mistake</font>

338
00:14:05,010 --> 00:14:09,280
<font color="#CCCCCC">the develop</font>

339
00:14:06,520 --> 00:14:10,720
<font color="#E5E5E5">of the malware made mistakes</font><font color="#CCCCCC"> I want to</font>

340
00:14:09,280 --> 00:14:15,699
talk about those mistakes but they are

341
00:14:10,720 --> 00:14:18,610
eventually<font color="#E5E5E5"> what led us to finding the</font>

342
00:14:15,700 --> 00:14:22,950
apks and everything else<font color="#CCCCCC"> that found the</font>

343
00:14:18,610 --> 00:14:26,800
botnet<font color="#E5E5E5"> or made us uncover the botnet so</font>

344
00:14:22,950 --> 00:14:29,470
one of<font color="#E5E5E5"> the mistakes resulted in some</font>

345
00:14:26,800 --> 00:14:31,359
random<font color="#E5E5E5"> characters ending up in some of</font>

346
00:14:29,470 --> 00:14:35,080
<font color="#E5E5E5">the attack traffic that looked fairly</font>

347
00:14:31,360 --> 00:14:38,560
unique unique enough<font color="#CCCCCC"> that when you drop</font>

348
00:14:35,080 --> 00:14:41,860
<font color="#E5E5E5">them</font><font color="#CCCCCC"> into Google</font><font color="#E5E5E5"> you found apks</font>

349
00:14:38,560 --> 00:14:43,810
associated<font color="#E5E5E5"> with them hosted on these apk</font>

350
00:14:41,860 --> 00:14:45,810
marrying sites now if you're<font color="#E5E5E5"> not</font>

351
00:14:43,810 --> 00:14:48,280
<font color="#E5E5E5">familiar with a</font><font color="#CCCCCC"> became airing sites</font>

352
00:14:45,810 --> 00:14:51,880
essentially<font color="#E5E5E5"> they just crawl the Play</font>

353
00:14:48,280 --> 00:14:53,800
Store<font color="#E5E5E5"> and they snapshot everything</font>

354
00:14:51,880 --> 00:14:56,890
<font color="#CCCCCC">pulled down the</font><font color="#E5E5E5"> apk files that would be</font>

355
00:14:53,800 --> 00:15:00,400
<font color="#E5E5E5">hosted</font><font color="#CCCCCC"> there copy the descriptions</font><font color="#E5E5E5"> copy</font>

356
00:14:56,890 --> 00:15:03,130
the developer<font color="#CCCCCC"> pages everything and serve</font>

357
00:15:00,400 --> 00:15:06,520
as a backup<font color="#E5E5E5"> if you will kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> like an</font>

358
00:15:03,130 --> 00:15:08,560
APA<font color="#E5E5E5"> apk archive so if your favorite app</font>

359
00:15:06,520 --> 00:15:11,230
gets pulled<font color="#CCCCCC"> from the App Store you can</font>

360
00:15:08,560 --> 00:15:14,500
probably still go find the apk<font color="#E5E5E5"> and then</font>

361
00:15:11,230 --> 00:15:18,580
load<font color="#CCCCCC"> it from</font><font color="#E5E5E5"> an unknown source directly</font>

362
00:15:14,500 --> 00:15:20,440
from here they also if they<font color="#E5E5E5"> push a new</font>

363
00:15:18,580 --> 00:15:21,790
version<font color="#E5E5E5"> everybody was all up in arms</font>

364
00:15:20,440 --> 00:15:23,320
about the new snapchat well you could

365
00:15:21,790 --> 00:15:25,719
have<font color="#E5E5E5"> went and got your old snapchat back</font>

366
00:15:23,320 --> 00:15:28,150
from these guys<font color="#CCCCCC"> probably stuff like that</font>

367
00:15:25,720 --> 00:15:31,600
so<font color="#E5E5E5"> that's what</font><font color="#CCCCCC"> therefore this turned</font>

368
00:15:28,150 --> 00:15:34,569
<font color="#E5E5E5">into quite the rabbit hole</font><font color="#CCCCCC"> we had a</font>

369
00:15:31,600 --> 00:15:37,570
couple<font color="#CCCCCC"> instances</font><font color="#E5E5E5"> from the attackers</font>

370
00:15:34,570 --> 00:15:40,780
mistakes<font color="#E5E5E5"> that led</font><font color="#CCCCCC"> us to</font><font color="#E5E5E5"> a couple pages</font>

371
00:15:37,570 --> 00:15:43,240
<font color="#E5E5E5">which in turn led us to their developer</font>

372
00:15:40,780 --> 00:15:44,920
page as it was captured<font color="#E5E5E5"> by the mirroring</font>

373
00:15:43,240 --> 00:15:47,260
sites which led us to<font color="#CCCCCC"> the other apps</font>

374
00:15:44,920 --> 00:15:49,930
which led us to<font color="#E5E5E5"> more apps and more apps</font>

375
00:15:47,260 --> 00:15:51,730
<font color="#E5E5E5">and more apps</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> think you can</font>

376
00:15:49,930 --> 00:15:55,000
really<font color="#E5E5E5"> see it in the screenshot here but</font>

377
00:15:51,730 --> 00:15:57,280
like this<font color="#E5E5E5"> google is for</font><font color="#CCCCCC"> tubemate two</font>

378
00:15:55,000 --> 00:16:00,460
point two point nine snap<font color="#E5E5E5"> Tube YouTube</font>

379
00:15:57,280 --> 00:16:03,339
downloader<font color="#CCCCCC"> are and you find that we've</font>

380
00:16:00,460 --> 00:16:05,590
got listings from<font color="#E5E5E5"> apk pure we've got</font>

381
00:16:03,340 --> 00:16:08,140
listings from<font color="#CCCCCC"> eight one APK dot CEO</font><font color="#E5E5E5"> and</font>

382
00:16:05,590 --> 00:16:10,030
there were a bunch of others so it was a

383
00:16:08,140 --> 00:16:11,800
lot of just going<font color="#E5E5E5"> and hopping from</font><font color="#CCCCCC"> one</font>

384
00:16:10,030 --> 00:16:13,240
of those to the next and grabbing all

385
00:16:11,800 --> 00:16:16,030
<font color="#E5E5E5">the apks we could find that seemed</font>

386
00:16:13,240 --> 00:16:17,360
relatively<font color="#E5E5E5"> unique so now we've got all</font>

387
00:16:16,030 --> 00:16:20,360
<font color="#CCCCCC">of</font><font color="#E5E5E5"> these apks</font>

388
00:16:17,360 --> 00:16:21,889
and I am<font color="#E5E5E5"> not an Android developer and</font>

389
00:16:20,360 --> 00:16:25,730
<font color="#CCCCCC">I've</font><font color="#E5E5E5"> never reversed</font><font color="#CCCCCC"> anything on an</font>

390
00:16:21,889 --> 00:16:27,769
Android device<font color="#CCCCCC"> so</font><font color="#E5E5E5"> now the hunt begins</font><font color="#CCCCCC"> as</font>

391
00:16:25,730 --> 00:16:30,350
to how can we start to handle this and

392
00:16:27,769 --> 00:16:34,339
this is where<font color="#E5E5E5"> apktool comes in thank God</font>

393
00:16:30,350 --> 00:16:37,249
<font color="#E5E5E5">for apktool it is amazing</font><font color="#CCCCCC"> and if you are</font>

394
00:16:34,339 --> 00:16:38,509
looking<font color="#CCCCCC"> into malicious</font><font color="#E5E5E5"> apk files or</font>

395
00:16:37,249 --> 00:16:41,089
malicious<font color="#E5E5E5"> Android applications you</font>

396
00:16:38,509 --> 00:16:43,369
should<font color="#E5E5E5"> definitely look into it this</font><font color="#CCCCCC"> is</font>

397
00:16:41,089 --> 00:16:45,350
<font color="#CCCCCC">straight off its website a tool for</font>

398
00:16:43,369 --> 00:16:48,470
reverse<font color="#CCCCCC"> engineering third-party closed</font>

399
00:16:45,350 --> 00:16:50,329
binary<font color="#CCCCCC"> android apps it can</font><font color="#E5E5E5"> decode</font>

400
00:16:48,470 --> 00:16:51,619
resources to nearly original form and

401
00:16:50,329 --> 00:16:53,868
rebuild them after making some

402
00:16:51,619 --> 00:16:56,179
modifications<font color="#E5E5E5"> it also makes working with</font>

403
00:16:53,869 --> 00:16:57,949
<font color="#E5E5E5">an app easier because</font><font color="#CCCCCC"> of the project</font>

404
00:16:56,179 --> 00:17:00,559
like file structure and<font color="#E5E5E5"> automation of</font>

405
00:16:57,949 --> 00:17:01,729
some repetitive<font color="#E5E5E5"> tasks they also have a</font>

406
00:17:00,559 --> 00:17:03,709
disclaimer<font color="#CCCCCC"> that please don't</font><font color="#E5E5E5"> use it for</font>

407
00:17:01,730 --> 00:17:08,000
<font color="#E5E5E5">piracy</font><font color="#CCCCCC"> because you can totally use it</font>

408
00:17:03,709 --> 00:17:11,000
<font color="#E5E5E5">for piracy it's that good</font><font color="#CCCCCC"> we we don't</font>

409
00:17:08,000 --> 00:17:13,010
<font color="#E5E5E5">know if the developer that</font><font color="#CCCCCC"> launched this</font>

410
00:17:11,000 --> 00:17:14,510
<font color="#CCCCCC">malware used this but</font><font color="#E5E5E5"> I wouldn't be</font>

411
00:17:13,010 --> 00:17:16,369
surprised if he did because it allows

412
00:17:14,510 --> 00:17:19,158
you to<font color="#CCCCCC"> basically</font><font color="#E5E5E5"> decompile a nap and</font>

413
00:17:16,369 --> 00:17:20,629
then<font color="#E5E5E5"> recompile that same app from the</font>

414
00:17:19,159 --> 00:17:23,089
decompiled source that you got from<font color="#E5E5E5"> the</font>

415
00:17:20,630 --> 00:17:23,559
<font color="#CCCCCC">first</font><font color="#E5E5E5"> D compilation and you can modify</font>

416
00:17:23,089 --> 00:17:26,869
it

417
00:17:23,559 --> 00:17:29,450
hence piracy<font color="#CCCCCC"> if you want to</font><font color="#E5E5E5"> find more</font>

418
00:17:26,869 --> 00:17:31,549
info<font color="#E5E5E5"> you can just google it if you're on</font>

419
00:17:29,450 --> 00:17:35,899
<font color="#E5E5E5">OSX</font><font color="#CCCCCC"> you can literally install it from</font>

420
00:17:31,549 --> 00:17:37,399
<font color="#E5E5E5">brew super easy</font><font color="#CCCCCC"> it's also available in</font>

421
00:17:35,899 --> 00:17:39,250
<font color="#CCCCCC">most of your package management</font><font color="#E5E5E5"> stuff on</font>

422
00:17:37,399 --> 00:17:45,018
all of your<font color="#E5E5E5"> favorite Linux distros so</font>

423
00:17:39,250 --> 00:17:47,240
it's awesome so this is a quick<font color="#CCCCCC"> example</font>

424
00:17:45,019 --> 00:17:52,429
of using<font color="#CCCCCC"> apk</font><font color="#E5E5E5"> tool you can see here we</font>

425
00:17:47,240 --> 00:17:53,840
have<font color="#CCCCCC"> T TWD LP H</font><font color="#E5E5E5"> key GQ whatever that is</font>

426
00:17:52,429 --> 00:17:58,070
one of the apks that was pulled down

427
00:17:53,840 --> 00:18:00,080
<font color="#E5E5E5">obviously</font><font color="#CCCCCC"> from apk pure comm and this is</font>

428
00:17:58,070 --> 00:18:02,200
<font color="#E5E5E5">just a basic D compilation</font><font color="#CCCCCC"> process it</font>

429
00:18:00,080 --> 00:18:06,649
couldn't get literally<font color="#E5E5E5"> any easier</font>

430
00:18:02,200 --> 00:18:11,269
<font color="#E5E5E5">apktool</font><font color="#CCCCCC"> D file name and</font><font color="#E5E5E5"> the result is a</font>

431
00:18:06,649 --> 00:18:14,418
directory named after<font color="#E5E5E5"> the app so we go</font>

432
00:18:11,269 --> 00:18:17,960
into<font color="#CCCCCC"> that directory and</font><font color="#E5E5E5"> there's a lot of</font>

433
00:18:14,419 --> 00:18:20,269
files in there<font color="#E5E5E5"> there's</font><font color="#CCCCCC"> 2422</font><font color="#E5E5E5"> files in</font>

434
00:18:17,960 --> 00:18:24,529
there that's quite concerning

435
00:18:20,269 --> 00:18:26,210
<font color="#E5E5E5">considering it's one tiny apk and the</font>

436
00:18:24,529 --> 00:18:28,550
<font color="#E5E5E5">the big problem is that we have to dig</font>

437
00:18:26,210 --> 00:18:31,370
<font color="#CCCCCC">through</font><font color="#E5E5E5"> this stuff to figure</font><font color="#CCCCCC"> out if</font>

438
00:18:28,550 --> 00:18:34,010
apks this is one<font color="#E5E5E5"> apk</font><font color="#CCCCCC"> at this</font><font color="#E5E5E5"> point I</font>

439
00:18:31,370 --> 00:18:35,659
think<font color="#E5E5E5"> we had close to two dozen and each</font>

440
00:18:34,010 --> 00:18:39,050
of them were producing thousands and

441
00:18:35,660 --> 00:18:41,810
thousands<font color="#E5E5E5"> and thousands of files</font><font color="#CCCCCC"> so the</font>

442
00:18:39,050 --> 00:18:45,950
important part<font color="#CCCCCC"> here</font><font color="#E5E5E5"> is that</font><font color="#CCCCCC"> apk tool</font>

443
00:18:41,810 --> 00:18:49,490
produces<font color="#CCCCCC"> a folder called</font><font color="#E5E5E5"> smiley</font><font color="#CCCCCC"> although</font>

444
00:18:45,950 --> 00:18:53,090
these smiley files<font color="#E5E5E5"> are text</font><font color="#CCCCCC"> files which</font>

445
00:18:49,490 --> 00:18:56,060
becomes important for<font color="#E5E5E5"> the next steps now</font>

446
00:18:53,090 --> 00:18:57,740
the problem is if we<font color="#E5E5E5"> look at how many</font>

447
00:18:56,060 --> 00:19:01,070
<font color="#CCCCCC">lines of</font><font color="#E5E5E5"> code we</font><font color="#CCCCCC"> actually have from</font>

448
00:18:57,740 --> 00:19:04,310
smiley<font color="#E5E5E5"> across our 2,400 files and</font>

449
00:19:01,070 --> 00:19:07,419
directories<font color="#E5E5E5"> we have three</font><font color="#CCCCCC"> hundred eighty</font>

450
00:19:04,310 --> 00:19:10,280
thousand lines of code<font color="#CCCCCC"> also a nightmare</font>

451
00:19:07,420 --> 00:19:12,140
<font color="#E5E5E5">I don't want to dig</font><font color="#CCCCCC"> through three</font>

452
00:19:10,280 --> 00:19:14,960
thousand three<font color="#CCCCCC"> hundred eighty thousand</font>

453
00:19:12,140 --> 00:19:16,700
lines of code<font color="#E5E5E5"> trying to find to figure</font>

454
00:19:14,960 --> 00:19:19,940
out if this is a<font color="#E5E5E5"> malicious app or this</font>

455
00:19:16,700 --> 00:19:21,710
is<font color="#E5E5E5"> just some guy doing piracy so that's</font>

456
00:19:19,940 --> 00:19:27,980
a lot<font color="#CCCCCC"> of hey how can we find some</font>

457
00:19:21,710 --> 00:19:30,730
needles<font color="#CCCCCC"> first thing why</font><font color="#E5E5E5"> is there so much</font>

458
00:19:27,980 --> 00:19:33,890
<font color="#CCCCCC">small e</font><font color="#E5E5E5"> there's so much small e because</font>

459
00:19:30,730 --> 00:19:38,450
apktool doesn't know where your app ends

460
00:19:33,890 --> 00:19:40,820
and the<font color="#CCCCCC"> android core libraries and and</font>

461
00:19:38,450 --> 00:19:42,200
<font color="#E5E5E5">everything else begins</font><font color="#CCCCCC"> so we can see</font>

462
00:19:40,820 --> 00:19:43,909
here you've got Android<font color="#E5E5E5"> support</font>

463
00:19:42,200 --> 00:19:45,950
annotation<font color="#E5E5E5"> Android support v4</font>

464
00:19:43,910 --> 00:19:49,010
accessibility services<font color="#E5E5E5"> Android for</font>

465
00:19:45,950 --> 00:19:51,560
support<font color="#E5E5E5"> animation</font><font color="#CCCCCC"> app view</font><font color="#E5E5E5"> then we have</font>

466
00:19:49,010 --> 00:19:54,980
v7 app internal widget so there's all

467
00:19:51,560 --> 00:19:57,470
this stuff<font color="#E5E5E5"> that</font><font color="#CCCCCC"> comes out and a lot of</font>

468
00:19:54,980 --> 00:20:02,690
<font color="#E5E5E5">it is just junk that you</font><font color="#CCCCCC"> can ignore</font>

469
00:19:57,470 --> 00:20:04,130
safely the good news is is<font color="#CCCCCC"> because this</font>

470
00:20:02,690 --> 00:20:06,470
<font color="#E5E5E5">stuff's written in Java and Java</font>

471
00:20:04,130 --> 00:20:08,630
utilizes proper namespaces for libraries

472
00:20:06,470 --> 00:20:11,540
<font color="#CCCCCC">and everything else it does you the</font>

473
00:20:08,630 --> 00:20:13,550
favor of saying<font color="#E5E5E5"> hey this is</font><font color="#CCCCCC"> all the</font>

474
00:20:11,540 --> 00:20:15,500
Android<font color="#E5E5E5"> stuff from the Android namespace</font>

475
00:20:13,550 --> 00:20:17,840
and this over<font color="#CCCCCC"> here</font><font color="#E5E5E5"> is all the</font><font color="#CCCCCC"> other</font>

476
00:20:15,500 --> 00:20:21,650
<font color="#E5E5E5">stuff from all the other namespaces in</font>

477
00:20:17,840 --> 00:20:25,189
this case we know the<font color="#E5E5E5"> app was called</font><font color="#CCCCCC"> T W</font>

478
00:20:21,650 --> 00:20:27,710
<font color="#CCCCCC">DL whatever</font><font color="#E5E5E5"> and if we look in the actual</font>

479
00:20:25,190 --> 00:20:30,890
<font color="#E5E5E5">small</font><font color="#CCCCCC"> e structure</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> see a comm and then</font>

480
00:20:27,710 --> 00:20:33,130
we see a<font color="#CCCCCC"> TWD</font><font color="#E5E5E5"> lph whatever and then we</font>

481
00:20:30,890 --> 00:20:36,170
see an app now if you're<font color="#CCCCCC"> actually</font>

482
00:20:33,130 --> 00:20:39,020
writing<font color="#E5E5E5"> Java you probably are</font><font color="#CCCCCC"> familiar</font>

483
00:20:36,170 --> 00:20:40,890
with import<font color="#E5E5E5"> comm dot your library name</font>

484
00:20:39,020 --> 00:20:45,240
dot<font color="#E5E5E5"> whatever path you</font>

485
00:20:40,890 --> 00:20:47,900
go down so<font color="#E5E5E5"> when's apktool does the D</font>

486
00:20:45,240 --> 00:20:51,450
compilation it actually like they say<font color="#E5E5E5"> it</font>

487
00:20:47,900 --> 00:20:54,690
maintains a same application structure

488
00:20:51,450 --> 00:20:56,670
<font color="#E5E5E5">for your project for recompilation and</font>

489
00:20:54,690 --> 00:20:59,480
management<font color="#CCCCCC"> purposes when it does</font><font color="#E5E5E5"> the D</font>

490
00:20:56,670 --> 00:21:02,580
compilation it does the same<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> so</font>

491
00:20:59,480 --> 00:21:05,270
looking<font color="#E5E5E5"> into just these folders or this</font>

492
00:21:02,580 --> 00:21:07,050
folder where<font color="#E5E5E5"> we suspect the primary</font>

493
00:21:05,270 --> 00:21:09,690
<font color="#E5E5E5">nefarious stuff is happening because</font>

494
00:21:07,050 --> 00:21:11,760
it's very unlikely that<font color="#E5E5E5"> he's</font><font color="#CCCCCC"> back</font>

495
00:21:09,690 --> 00:21:14,660
<font color="#CCCCCC">dooring stuff into the Android libraries</font>

496
00:21:11,760 --> 00:21:18,060
it's possible I guess<font color="#E5E5E5"> but it's unlikely</font>

497
00:21:14,660 --> 00:21:23,160
<font color="#CCCCCC">we find twenty four hundred and</font><font color="#E5E5E5"> fifty</font>

498
00:21:18,060 --> 00:21:25,740
<font color="#CCCCCC">one lines of code</font><font color="#E5E5E5"> so sorry</font><font color="#CCCCCC"> 24,000 lines</font>

499
00:21:23,160 --> 00:21:29,310
of<font color="#E5E5E5"> code</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> much more manageable</font><font color="#CCCCCC"> than</font>

500
00:21:25,740 --> 00:21:32,490
three hundred eighty thousand so what is

501
00:21:29,310 --> 00:21:34,290
<font color="#E5E5E5">small</font><font color="#CCCCCC"> e like a pirate no</font><font color="#E5E5E5"> not like well</font>

502
00:21:32,490 --> 00:21:36,360
it can be<font color="#E5E5E5"> used for piracy</font><font color="#CCCCCC"> so maybe a</font>

503
00:21:34,290 --> 00:21:39,000
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit like a pirate</font><font color="#CCCCCC"> small</font><font color="#E5E5E5"> e</font>

504
00:21:36,360 --> 00:21:41,760
slash<font color="#CCCCCC"> back Somali</font><font color="#E5E5E5"> isn't a similar</font>

505
00:21:39,000 --> 00:21:44,430
disassembler for the<font color="#E5E5E5"> decks format used</font>

506
00:21:41,760 --> 00:21:47,160
by dalvik<font color="#CCCCCC"> androids Java VM</font>

507
00:21:44,430 --> 00:21:50,340
implementation syntax is<font color="#E5E5E5"> lui based on</font>

508
00:21:47,160 --> 00:21:51,900
<font color="#E5E5E5">Jasmin's</font><font color="#CCCCCC"> detects or syntax</font><font color="#E5E5E5"> supports the</font>

509
00:21:50,340 --> 00:21:53,760
full functionality of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> dex format</font>

510
00:21:51,900 --> 00:21:57,090
including annotations debugging

511
00:21:53,760 --> 00:21:58,190
<font color="#CCCCCC">information line information etc I don't</font>

512
00:21:57,090 --> 00:22:01,530
know what that means either

513
00:21:58,190 --> 00:22:04,680
so what does<font color="#E5E5E5"> this really mean</font><font color="#CCCCCC"> in plain</font>

514
00:22:01,530 --> 00:22:07,290
<font color="#E5E5E5">English you can take Java</font><font color="#CCCCCC"> Dex</font><font color="#E5E5E5"> dalvik</font>

515
00:22:04,680 --> 00:22:09,270
bytecode<font color="#CCCCCC"> it will process it</font><font color="#E5E5E5"> and it will</font>

516
00:22:07,290 --> 00:22:11,490
<font color="#E5E5E5">convert it into this small e language</font>

517
00:22:09,270 --> 00:22:14,760
which is basically an<font color="#CCCCCC"> ASCII</font>

518
00:22:11,490 --> 00:22:16,770
representation of Java<font color="#E5E5E5"> bytecode so if</font>

519
00:22:14,760 --> 00:22:20,280
you've<font color="#E5E5E5"> ever thrown a binary in something</font>

520
00:22:16,770 --> 00:22:22,440
like Ida<font color="#CCCCCC"> and and you start to see the</font>

521
00:22:20,280 --> 00:22:24,090
the<font color="#E5E5E5"> actual functions the move functions</font>

522
00:22:22,440 --> 00:22:24,660
and all of the pops and the pushes<font color="#E5E5E5"> and</font>

523
00:22:24,090 --> 00:22:29,699
everything

524
00:22:24,660 --> 00:22:32,640
same thing<font color="#E5E5E5"> for Java essentially and just</font>

525
00:22:29,700 --> 00:22:36,000
<font color="#E5E5E5">dump to ASCII so it's really good you</font>

526
00:22:32,640 --> 00:22:40,680
<font color="#E5E5E5">should definitely get to know it here is</font>

527
00:22:36,000 --> 00:22:42,330
some sample code<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Mali we can see the</font>

528
00:22:40,680 --> 00:22:43,980
first<font color="#E5E5E5"> line we've got class public</font><font color="#CCCCCC"> hello</font>

529
00:22:42,330 --> 00:22:47,070
<font color="#CCCCCC">world</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> creating our hello world</font>

530
00:22:43,980 --> 00:22:49,140
class we can see super java.lang object

531
00:22:47,070 --> 00:22:52,980
this<font color="#E5E5E5"> is basically a hint that we're</font>

532
00:22:49,140 --> 00:22:54,570
extending<font color="#E5E5E5"> the generic Java object class</font>

533
00:22:52,980 --> 00:22:59,130
if we were writing<font color="#E5E5E5"> code this would be</font>

534
00:22:54,570 --> 00:23:03,060
<font color="#E5E5E5">hello world extends object</font><font color="#CCCCCC"> if we declare</font>

535
00:22:59,130 --> 00:23:06,450
<font color="#CCCCCC">a public</font><font color="#E5E5E5"> method main static returns void</font>

536
00:23:03,060 --> 00:23:07,800
we override that main function<font color="#CCCCCC"> we're</font>

537
00:23:06,450 --> 00:23:11,550
gonna have two values<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we're</font><font color="#CCCCCC"> going</font>

538
00:23:07,800 --> 00:23:14,190
<font color="#E5E5E5">to store two registers we have V 0 V 0</font>

539
00:23:11,550 --> 00:23:16,919
stores<font color="#CCCCCC"> are reference to system dot out</font>

540
00:23:14,190 --> 00:23:22,500
you can see java.lang system arrow<font color="#CCCCCC"> to</font>

541
00:23:16,920 --> 00:23:24,960
out the actual second value<font color="#E5E5E5"> is the the</font>

542
00:23:22,500 --> 00:23:27,960
the<font color="#E5E5E5"> object type of that</font><font color="#CCCCCC"> so in this case</font>

543
00:23:24,960 --> 00:23:32,730
it's a<font color="#CCCCCC"> java io print stream then we</font>

544
00:23:27,960 --> 00:23:36,000
store in v1<font color="#CCCCCC"> con string hello world</font><font color="#E5E5E5"> down</font>

545
00:23:32,730 --> 00:23:38,520
below we see invoke virtual<font color="#E5E5E5"> we see</font><font color="#CCCCCC"> V 0</font>

546
00:23:36,000 --> 00:23:40,140
which we know is system dot<font color="#CCCCCC"> out and we</font>

547
00:23:38,520 --> 00:23:42,900
see V 1 which we know<font color="#E5E5E5"> is our string</font>

548
00:23:40,140 --> 00:23:44,940
hello world<font color="#E5E5E5"> and then we see that on the</font>

549
00:23:42,900 --> 00:23:47,520
print stream<font color="#E5E5E5"> we're using the function</font>

550
00:23:44,940 --> 00:23:50,130
print line so invoke virtual is

551
00:23:47,520 --> 00:23:52,680
basically just a function call<font color="#CCCCCC"> and now</font>

552
00:23:50,130 --> 00:23:54,330
we see down<font color="#CCCCCC"> below and comments I've put</font>

553
00:23:52,680 --> 00:23:55,440
a<font color="#E5E5E5"> little sample as to what that</font><font color="#CCCCCC"> would</font>

554
00:23:54,330 --> 00:23:59,520
actually<font color="#CCCCCC"> look like system dot out dot</font>

555
00:23:55,440 --> 00:24:03,120
print line<font color="#E5E5E5"> hello world return void and</font>

556
00:23:59,520 --> 00:24:04,160
method so that<font color="#CCCCCC"> is your crash course</font><font color="#E5E5E5"> -</font>

557
00:24:03,120 --> 00:24:06,270
this<font color="#E5E5E5"> is small e</font>

558
00:24:04,160 --> 00:24:09,570
we're gonna look at some more<font color="#E5E5E5"> of it I'm</font>

559
00:24:06,270 --> 00:24:10,710
sorry so we're<font color="#E5E5E5"> still looking</font><font color="#CCCCCC"> for a</font>

560
00:24:09,570 --> 00:24:14,760
needle<font color="#E5E5E5"> we've got all of</font><font color="#CCCCCC"> this small e</font>

561
00:24:10,710 --> 00:24:17,880
<font color="#E5E5E5">it's interesting but there is way too</font>

562
00:24:14,760 --> 00:24:19,980
much<font color="#CCCCCC"> of</font><font color="#E5E5E5"> it now we</font><font color="#CCCCCC"> don't know how this</font>

563
00:24:17,880 --> 00:24:21,570
thing communicates with its<font color="#E5E5E5"> c2 we don't</font>

564
00:24:19,980 --> 00:24:23,550
know if it's<font color="#E5E5E5"> binary protocol if it's</font>

565
00:24:21,570 --> 00:24:26,370
HTTP it could be<font color="#E5E5E5"> using</font><font color="#CCCCCC"> something funky</font>

566
00:24:23,550 --> 00:24:29,310
<font color="#E5E5E5">all we really know is that it's capable</font>

567
00:24:26,370 --> 00:24:32,159
<font color="#E5E5E5">of attacking HTTP services so let's</font>

568
00:24:29,310 --> 00:24:34,980
start<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at HTTP or let's start</font>

569
00:24:32,160 --> 00:24:37,320
looking<font color="#CCCCCC"> for HTTP as a token within the</font>

570
00:24:34,980 --> 00:24:39,930
code because<font color="#CCCCCC"> you never know maybe</font><font color="#E5E5E5"> you</font>

571
00:24:37,320 --> 00:24:41,669
know this thing decomposes<font color="#CCCCCC"> or D compiles</font>

572
00:24:39,930 --> 00:24:44,100
and includes annotations and notes and

573
00:24:41,670 --> 00:24:46,890
<font color="#E5E5E5">other things maybe somewhere buried in</font>

574
00:24:44,100 --> 00:24:49,860
there we can find HTTP and start to pick

575
00:24:46,890 --> 00:24:52,640
away at this what we didn't<font color="#E5E5E5"> expect</font><font color="#CCCCCC"> to</font>

576
00:24:49,860 --> 00:24:57,800
<font color="#E5E5E5">find and found immediately</font><font color="#CCCCCC"> where two</font>

577
00:24:52,640 --> 00:25:02,070
domains<font color="#CCCCCC"> ax</font><font color="#E5E5E5"> click</font><font color="#CCCCCC"> dot store you and dot</font><font color="#E5E5E5"> G</font>

578
00:24:57,800 --> 00:25:03,570
so if we look at<font color="#E5E5E5"> where those strings</font>

579
00:25:02,070 --> 00:25:05,590
were found one is called exploration

580
00:25:03,570 --> 00:25:08,230
<font color="#CCCCCC">activity small e</font>

581
00:25:05,590 --> 00:25:14,740
not<font color="#E5E5E5"> too suspicious the other is found in</font>

582
00:25:08,230 --> 00:25:15,670
services<font color="#CCCCCC"> /r why</font><font color="#E5E5E5"> iidr XC j MF b which</font><font color="#CCCCCC"> i</font>

583
00:25:14,740 --> 00:25:17,710
<font color="#E5E5E5">don't know if you're familiar with</font>

584
00:25:15,670 --> 00:25:23,160
malware naming but that seems nothing

585
00:25:17,710 --> 00:25:26,440
<font color="#E5E5E5">like malware right totally</font><font color="#CCCCCC"> legit</font><font color="#E5E5E5"> so</font>

586
00:25:23,160 --> 00:25:30,100
first thing first<font color="#E5E5E5"> let's poke these let's</font>

587
00:25:26,440 --> 00:25:33,040
see what they do<font color="#CCCCCC"> if we hit u dot ax</font>

588
00:25:30,100 --> 00:25:36,129
<font color="#CCCCCC">clicked that store just simple curl we</font>

589
00:25:33,040 --> 00:25:37,899
get a 200<font color="#CCCCCC"> ok response</font><font color="#E5E5E5"> blank never</font>

590
00:25:36,130 --> 00:25:39,520
changes<font color="#E5E5E5"> we can hit it a thousand times</font>

591
00:25:37,900 --> 00:25:43,420
<font color="#E5E5E5">we always get a blank response to the</font>

592
00:25:39,520 --> 00:25:46,120
<font color="#E5E5E5">200</font><font color="#CCCCCC"> ok if we hit G ax</font><font color="#E5E5E5"> click that store</font>

593
00:25:43,420 --> 00:25:49,030
<font color="#E5E5E5">we also get a 200</font><font color="#CCCCCC"> response this</font><font color="#E5E5E5"> time</font>

594
00:25:46,120 --> 00:25:50,919
<font color="#CCCCCC">there's HTML the HTML</font><font color="#E5E5E5"> content is mostly</font>

595
00:25:49,030 --> 00:25:53,920
blank<font color="#E5E5E5"> except for there is a single title</font>

596
00:25:50,920 --> 00:25:56,710
tag and in that title<font color="#E5E5E5"> tag is a string</font>

597
00:25:53,920 --> 00:26:00,430
and that string changes every time we

598
00:25:56,710 --> 00:26:06,640
hit<font color="#CCCCCC"> the server so this is an example of</font>

599
00:26:00,430 --> 00:26:12,060
what you would see HTML<font color="#CCCCCC"> title HTTP slash</font>

600
00:26:06,640 --> 00:26:14,980
slash gobbly gook HTTP slash slash so

601
00:26:12,060 --> 00:26:18,550
certainly looks like<font color="#E5E5E5"> we've got at least</font>

602
00:26:14,980 --> 00:26:20,410
two URLs here we can tell<font color="#CCCCCC"> that the</font>

603
00:26:18,550 --> 00:26:24,159
second URL starts because we see the

604
00:26:20,410 --> 00:26:27,010
first HTTP<font color="#E5E5E5"> and we can obviously tell</font>

605
00:26:24,160 --> 00:26:28,480
<font color="#CCCCCC">that it starts to</font><font color="#E5E5E5"> HTTP now if you look</font>

606
00:26:27,010 --> 00:26:32,379
at<font color="#E5E5E5"> this</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit closer something</font>

607
00:26:28,480 --> 00:26:39,790
else jumps out of<font color="#E5E5E5"> here we also see</font><font color="#CCCCCC"> s any</font>

608
00:26:32,380 --> 00:26:41,790
<font color="#CCCCCC">W X</font><font color="#E5E5E5"> WRI is repeated so that's pretty</font>

609
00:26:39,790 --> 00:26:44,649
<font color="#CCCCCC">interesting</font><font color="#E5E5E5"> because given the</font>

610
00:26:41,790 --> 00:26:46,210
<font color="#E5E5E5">randomization of that string it seems</font>

611
00:26:44,650 --> 00:26:48,790
kind of weird<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> would see repeats</font>

612
00:26:46,210 --> 00:26:54,040
like<font color="#E5E5E5"> that if it were truly a random</font>

613
00:26:48,790 --> 00:26:55,840
string so then we start to come<font color="#CCCCCC"> to</font>

614
00:26:54,040 --> 00:26:58,300
<font color="#CCCCCC">conclusions</font><font color="#E5E5E5"> clearly the first thing is</font>

615
00:26:55,840 --> 00:27:02,080
URL we don't know why but we know<font color="#CCCCCC"> it's</font>

616
00:26:58,300 --> 00:27:04,990
<font color="#E5E5E5">URL the second string that</font><font color="#CCCCCC"> is repeated</font>

617
00:27:02,080 --> 00:27:07,780
<font color="#E5E5E5">we're now assuming as a delimiter</font><font color="#CCCCCC"> and if</font>

618
00:27:04,990 --> 00:27:11,440
we break up<font color="#E5E5E5"> this title on that delimiter</font>

619
00:27:07,780 --> 00:27:14,560
<font color="#E5E5E5">all of a sudden those magical mix of</font>

620
00:27:11,440 --> 00:27:16,720
characters in the middle are 26<font color="#CCCCCC"> Alpha</font>

621
00:27:14,560 --> 00:27:17,980
characters<font color="#E5E5E5"> sounds a lot like the user</font>

622
00:27:16,720 --> 00:27:19,640
agents we've been seeing<font color="#E5E5E5"> in the attacks</font>

623
00:27:17,980 --> 00:27:22,640
<font color="#E5E5E5">so we're starting to</font>

624
00:27:19,640 --> 00:27:25,040
confident we found the apks<font color="#E5E5E5"> for what we</font>

625
00:27:22,640 --> 00:27:27,560
thought was a mobile<font color="#E5E5E5"> botnet in there we</font>

626
00:27:25,040 --> 00:27:29,990
found URL that points to a site and in

627
00:27:27,560 --> 00:27:35,620
that site we've now got a title<font color="#E5E5E5"> tag that</font>

628
00:27:29,990 --> 00:27:39,080
<font color="#CCCCCC">contains</font><font color="#E5E5E5"> URLs and a random 26 character</font>

629
00:27:35,620 --> 00:27:42,399
string<font color="#E5E5E5"> so feeling like we're definitely</font>

630
00:27:39,080 --> 00:27:45,980
honing in on the<font color="#E5E5E5"> right the right place</font>

631
00:27:42,400 --> 00:27:48,350
<font color="#CCCCCC">side note if anybody has ever</font><font color="#E5E5E5"> used the</font>

632
00:27:45,980 --> 00:27:49,850
wire<font color="#E5E5E5"> X but Bitcoin app I'm sorry that</font>

633
00:27:48,350 --> 00:27:52,280
this happened we had no<font color="#CCCCCC"> idea it was name</font>

634
00:27:49,850 --> 00:27:55,100
<font color="#E5E5E5">that we named this wire X because of</font>

635
00:27:52,280 --> 00:27:57,080
shuffling of<font color="#CCCCCC"> the letters</font><font color="#E5E5E5"> in this</font>

636
00:27:55,100 --> 00:28:00,439
delimiter file or at this delimiter

637
00:27:57,080 --> 00:28:02,179
value there are some way more fun names

638
00:28:00,440 --> 00:28:06,410
in there but we weren't<font color="#E5E5E5"> allowed</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use</font>

639
00:28:02,180 --> 00:28:11,450
<font color="#E5E5E5">any of them so you can imagine you can</font>

640
00:28:06,410 --> 00:28:15,560
<font color="#E5E5E5">imagine</font><font color="#CCCCCC"> alright so now we've found</font><font color="#E5E5E5"> a URL</font>

641
00:28:11,450 --> 00:28:17,750
<font color="#CCCCCC">in a file that was interesting we found</font>

642
00:28:15,560 --> 00:28:21,200
that that file is named very

643
00:28:17,750 --> 00:28:22,610
suspiciously<font color="#E5E5E5"> we've confirmed that what</font>

644
00:28:21,200 --> 00:28:23,420
looks<font color="#E5E5E5"> like the user agent</font><font color="#CCCCCC"> is coming out</font>

645
00:28:22,610 --> 00:28:25,070
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> title tag</font>

646
00:28:23,420 --> 00:28:26,680
now let's find how this delimiter is

647
00:28:25,070 --> 00:28:29,300
going to be used<font color="#E5E5E5"> and where and</font>

648
00:28:26,680 --> 00:28:30,980
potentially how<font color="#E5E5E5"> these values get used if</font>

649
00:28:29,300 --> 00:28:33,669
this is indeed a delimiter as we suspect

650
00:28:30,980 --> 00:28:36,980
it is<font color="#CCCCCC"> we grew up for that delimiter and</font>

651
00:28:33,670 --> 00:28:39,020
now we see<font color="#E5E5E5"> our same two files show up</font>

652
00:28:36,980 --> 00:28:41,060
again we see exploration activity

653
00:28:39,020 --> 00:28:42,139
<font color="#E5E5E5">there's four versions of exploration</font>

654
00:28:41,060 --> 00:28:43,310
activity and we'll explain that<font color="#E5E5E5"> in a</font>

655
00:28:42,140 --> 00:28:46,640
second

656
00:28:43,310 --> 00:28:50,600
this new<font color="#CCCCCC"> adapter thing is new</font><font color="#E5E5E5"> the comp</font>

657
00:28:46,640 --> 00:28:53,270
<font color="#E5E5E5">file is also</font><font color="#CCCCCC"> new but the services</font><font color="#E5E5E5"> we see</font>

658
00:28:50,600 --> 00:28:56,990
are very suspiciously named service

659
00:28:53,270 --> 00:29:00,790
again<font color="#E5E5E5"> so let's look into that service</font>

660
00:28:56,990 --> 00:29:03,680
<font color="#E5E5E5">file what we find in there is and</font>

661
00:29:00,790 --> 00:29:05,120
<font color="#E5E5E5">actually what we find in there and a lot</font>

662
00:29:03,680 --> 00:29:08,270
<font color="#CCCCCC">of places</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is why we see so many</font>

663
00:29:05,120 --> 00:29:11,719
files here is we find a function that

664
00:29:08,270 --> 00:29:14,600
<font color="#E5E5E5">uses our delimiter as the first part</font><font color="#CCCCCC"> of</font>

665
00:29:11,720 --> 00:29:20,390
its<font color="#CCCCCC"> function name</font><font color="#E5E5E5"> we see public s</font><font color="#CCCCCC"> anew X</font>

666
00:29:14,600 --> 00:29:23,570
<font color="#CCCCCC">W R</font><font color="#E5E5E5"> I and then</font><font color="#CCCCCC"> CC now</font><font color="#E5E5E5"> I don't know how</font>

667
00:29:20,390 --> 00:29:26,330
familiar<font color="#CCCCCC"> you</font><font color="#E5E5E5"> are with verbage relating</font>

668
00:29:23,570 --> 00:29:29,659
to malware<font color="#E5E5E5"> and botnets but CC is command</font>

669
00:29:26,330 --> 00:29:32,899
and control so to see a<font color="#E5E5E5"> function with</font>

670
00:29:29,660 --> 00:29:35,640
our token and then<font color="#CCCCCC"> CC at the end</font>

671
00:29:32,900 --> 00:29:37,260
<font color="#E5E5E5">that feels pretty good because now we</font>

672
00:29:35,640 --> 00:29:38,820
suspected<font color="#E5E5E5"> this thing was communicating</font>

673
00:29:37,260 --> 00:29:40,290
with<font color="#E5E5E5"> the CC in the first place based on</font>

674
00:29:38,820 --> 00:29:43,500
<font color="#E5E5E5">all the observations we made thus</font><font color="#CCCCCC"> far</font>

675
00:29:40,290 --> 00:29:45,450
and<font color="#CCCCCC"> the guesses that</font><font color="#E5E5E5"> we've made so let's</font>

676
00:29:43,500 --> 00:29:47,490
see what this thing's doing<font color="#CCCCCC"> will will</font>

677
00:29:45,450 --> 00:29:50,720
only focus<font color="#CCCCCC"> on the blue lines</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> to</font>

678
00:29:47,490 --> 00:29:52,920
<font color="#E5E5E5">save</font><font color="#CCCCCC"> time and</font><font color="#E5E5E5"> energy</font>

679
00:29:50,720 --> 00:29:55,890
the first thing where you see it do is

680
00:29:52,920 --> 00:30:00,660
that it is spinning<font color="#E5E5E5"> up an Android WebKit</font>

681
00:29:55,890 --> 00:30:03,300
web view then<font color="#E5E5E5"> it is using that</font><font color="#CCCCCC"> webview</font>

682
00:30:00,660 --> 00:30:05,100
to get the settings object<font color="#E5E5E5"> from that</font>

683
00:30:03,300 --> 00:30:08,580
<font color="#E5E5E5">settings</font><font color="#CCCCCC"> object its setting</font><font color="#E5E5E5"> the cache</font>

684
00:30:05,100 --> 00:30:10,740
mode<font color="#E5E5E5"> to</font><font color="#CCCCCC"> two if you look up the value for</font>

685
00:30:08,580 --> 00:30:15,689
what that<font color="#E5E5E5"> means it's a constant means</font>

686
00:30:10,740 --> 00:30:17,310
<font color="#E5E5E5">don't set cache</font><font color="#CCCCCC"> then it is setting</font><font color="#E5E5E5"> v1 to</font>

687
00:30:15,690 --> 00:30:21,540
the value of<font color="#E5E5E5"> one and clearing the cache</font>

688
00:30:17,310 --> 00:30:24,210
<font color="#E5E5E5">using that</font><font color="#CCCCCC"> value it is</font><font color="#E5E5E5"> clearing the</font>

689
00:30:21,540 --> 00:30:27,000
history on the webview<font color="#E5E5E5"> then we see that</font>

690
00:30:24,210 --> 00:30:29,220
<font color="#E5E5E5">actual reference to the</font><font color="#CCCCCC"> gix click store</font>

691
00:30:27,000 --> 00:30:32,250
<font color="#E5E5E5">this is the URL</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we suspect is</font>

692
00:30:29,220 --> 00:30:36,000
giving the commands<font color="#E5E5E5"> we see it load that</font>

693
00:30:32,250 --> 00:30:40,350
URL<font color="#E5E5E5"> here's where it gets interesting</font><font color="#CCCCCC"> we</font>

694
00:30:36,000 --> 00:30:43,170
see a new instance of<font color="#E5E5E5"> services our same</font>

695
00:30:40,350 --> 00:30:45,030
<font color="#CCCCCC">filename</font><font color="#E5E5E5"> with a dollar sign</font><font color="#CCCCCC"> - at the</font><font color="#E5E5E5"> end</font>

696
00:30:43,170 --> 00:30:47,400
we see the dollar sign<font color="#E5E5E5"> - at the end</font>

697
00:30:45,030 --> 00:30:49,530
version<font color="#E5E5E5"> a knitted and then we see it</font>

698
00:30:47,400 --> 00:30:52,290
passed in you can see it's stored in v1

699
00:30:49,530 --> 00:30:57,090
and then v1<font color="#E5E5E5"> is passed into the webview</font>

700
00:30:52,290 --> 00:30:58,670
as a set webview client so what's the

701
00:30:57,090 --> 00:31:01,830
deal<font color="#CCCCCC"> with the dollar signs</font>

702
00:30:58,670 --> 00:31:04,770
when apktool<font color="#CCCCCC"> decompile is</font><font color="#E5E5E5"> APK files</font>

703
00:31:01,830 --> 00:31:06,919
you'll find there are<font color="#E5E5E5"> the cases where a</font>

704
00:31:04,770 --> 00:31:09,990
file you're<font color="#CCCCCC"> looking at may have multiple</font>

705
00:31:06,920 --> 00:31:12,780
named versions of itself delimited with

706
00:31:09,990 --> 00:31:16,580
<font color="#CCCCCC">a dollar sign</font><font color="#E5E5E5"> sometimes multiple dollar</font>

707
00:31:12,780 --> 00:31:20,250
signs<font color="#CCCCCC"> what's going</font><font color="#E5E5E5"> on here is</font>

708
00:31:16,580 --> 00:31:22,649
essentially when I'm writing<font color="#CCCCCC"> my</font><font color="#E5E5E5"> Java I</font>

709
00:31:20,250 --> 00:31:24,150
can put multiple<font color="#E5E5E5"> class declarations in a</font>

710
00:31:22,650 --> 00:31:27,350
single source<font color="#E5E5E5"> file before compilation</font>

711
00:31:24,150 --> 00:31:31,170
<font color="#E5E5E5">and what apktool is trying to do for</font>

712
00:31:27,350 --> 00:31:32,820
<font color="#CCCCCC">sane management of my project is take</font>

713
00:31:31,170 --> 00:31:34,860
those multiple classes and split<font color="#E5E5E5"> them</font>

714
00:31:32,820 --> 00:31:35,309
out<font color="#E5E5E5"> into unique classes for management</font>

715
00:31:34,860 --> 00:31:37,320
and

716
00:31:35,309 --> 00:31:39,928
organization purposes<font color="#CCCCCC"> so instead of</font>

717
00:31:37,320 --> 00:31:42,299
seeing this<font color="#CCCCCC"> massive wall of text</font><font color="#E5E5E5"> for a</font>

718
00:31:39,929 --> 00:31:44,580
single file<font color="#E5E5E5"> all of my subclasses get</font>

719
00:31:42,299 --> 00:31:47,730
spun out in this case what we're

720
00:31:44,580 --> 00:31:50,428
<font color="#CCCCCC">observing here</font><font color="#E5E5E5"> is that the developer</font>

721
00:31:47,730 --> 00:31:53,100
declared their<font color="#CCCCCC"> webview client class</font>

722
00:31:50,429 --> 00:31:55,889
<font color="#E5E5E5">inside of the same source file it was</font>

723
00:31:53,100 --> 00:31:58,199
compiled and then Wendy<font color="#CCCCCC"> compiled it gets</font>

724
00:31:55,889 --> 00:32:00,178
split<font color="#E5E5E5"> out to its own thing now we don't</font>

725
00:31:58,200 --> 00:32:01,620
<font color="#E5E5E5">know</font><font color="#CCCCCC"> that it's a webview client yet</font><font color="#E5E5E5"> but</font>

726
00:32:00,179 --> 00:32:03,690
we can<font color="#E5E5E5"> make a pretty</font><font color="#CCCCCC"> educated guess</font>

727
00:32:01,620 --> 00:32:07,559
based on how we're seeing it used in<font color="#E5E5E5"> the</font>

728
00:32:03,690 --> 00:32:09,210
decompiled source<font color="#CCCCCC"> you know we see dollar</font>

729
00:32:07,559 --> 00:32:12,418
sign<font color="#CCCCCC"> two in it and then we see it</font>

730
00:32:09,210 --> 00:32:17,879
<font color="#CCCCCC">immediately set as the previous</font><font color="#E5E5E5"> web</font>

731
00:32:12,419 --> 00:32:20,070
<font color="#E5E5E5">views own</font><font color="#CCCCCC"> webview client so what is a</font>

732
00:32:17,879 --> 00:32:22,830
<font color="#E5E5E5">webview</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> webview is basically a</font>

733
00:32:20,070 --> 00:32:24,960
headless embedded<font color="#E5E5E5"> browser instance it's</font>

734
00:32:22,830 --> 00:32:28,139
part<font color="#CCCCCC"> of the Android OS if you've ever</font>

735
00:32:24,960 --> 00:32:29,669
<font color="#CCCCCC">used an app where you know you</font><font color="#E5E5E5"> install</font>

736
00:32:28,139 --> 00:32:31,289
the app and then<font color="#E5E5E5"> you click</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the little</font>

737
00:32:29,669 --> 00:32:34,980
icon and it just<font color="#E5E5E5"> loads the</font><font color="#CCCCCC"> website</font>

738
00:32:31,289 --> 00:32:38,570
<font color="#E5E5E5">that's basically a webview</font><font color="#CCCCCC"> what is a</font>

739
00:32:34,980 --> 00:32:41,669
webview client a<font color="#CCCCCC"> client</font><font color="#E5E5E5"> is basically a</font>

740
00:32:38,570 --> 00:32:44,519
programmable<font color="#E5E5E5"> interface for</font><font color="#CCCCCC"> catching</font>

741
00:32:41,669 --> 00:32:47,429
events and having programmatic hooks

742
00:32:44,519 --> 00:32:49,649
into<font color="#CCCCCC"> a webview that has been declared</font><font color="#E5E5E5"> so</font>

743
00:32:47,429 --> 00:32:51,509
just like in<font color="#E5E5E5"> JavaScript you can create</font>

744
00:32:49,649 --> 00:32:53,189
an object<font color="#E5E5E5"> and then you can catch the</font>

745
00:32:51,509 --> 00:32:58,619
onload or on page load or whatever

746
00:32:53,190 --> 00:33:03,869
events this<font color="#E5E5E5"> is the WebKit class for</font>

747
00:32:58,619 --> 00:33:05,699
<font color="#E5E5E5">hooking into those events so if we</font>

748
00:33:03,869 --> 00:33:08,730
actually look<font color="#CCCCCC"> into that dollar sign</font><font color="#E5E5E5"> to</font>

749
00:33:05,700 --> 00:33:11,159
<font color="#E5E5E5">file where</font><font color="#CCCCCC"> we suspect the webview client</font>

750
00:33:08,730 --> 00:33:15,059
<font color="#E5E5E5">is indeed being used we confirm that</font>

751
00:33:11,159 --> 00:33:18,179
<font color="#CCCCCC">there is one being</font><font color="#E5E5E5"> used and the magic</font>

752
00:33:15,059 --> 00:33:20,759
happens<font color="#E5E5E5"> in the on paged finished event</font>

753
00:33:18,179 --> 00:33:23,519
hook<font color="#CCCCCC"> so this event</font><font color="#E5E5E5"> hook fires when a</font>

754
00:33:20,759 --> 00:33:24,960
page<font color="#E5E5E5"> is done loading obviously that's</font>

755
00:33:23,519 --> 00:33:28,190
<font color="#CCCCCC">very handy</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> need to process the</font>

756
00:33:24,960 --> 00:33:30,570
page<font color="#CCCCCC"> so what's going on here</font>

757
00:33:28,190 --> 00:33:34,379
important<font color="#E5E5E5"> to note is the first parameter</font>

758
00:33:30,570 --> 00:33:37,439
<font color="#E5E5E5">passed in p1 is a webview this is our</font>

759
00:33:34,379 --> 00:33:41,309
webview that was just<font color="#E5E5E5"> loaded</font><font color="#CCCCCC"> with the c2</font>

760
00:33:37,440 --> 00:33:45,899
page we see that that webview will then

761
00:33:41,309 --> 00:33:49,090
call get title if we have a<font color="#E5E5E5"> title tag we</font>

762
00:33:45,899 --> 00:33:52,899
<font color="#E5E5E5">will continue we will call get title</font>

763
00:33:49,090 --> 00:33:58,990
again<font color="#E5E5E5"> now we see our delimiter our s</font><font color="#CCCCCC"> nu</font>

764
00:33:52,900 --> 00:34:01,420
<font color="#CCCCCC">X WRI</font><font color="#E5E5E5"> is loaded into V 2 and then we're</font>

765
00:33:58,990 --> 00:34:04,450
checking with<font color="#CCCCCC"> a string contains that</font>

766
00:34:01,420 --> 00:34:08,860
that string<font color="#E5E5E5"> that is stored in our title</font>

767
00:34:04,450 --> 00:34:12,429
<font color="#E5E5E5">tag contains our delimiter</font><font color="#CCCCCC"> if we do</font><font color="#E5E5E5"> find</font>

768
00:34:08,860 --> 00:34:15,520
instances<font color="#E5E5E5"> of it we continue we get title</font>

769
00:34:12,429 --> 00:34:17,589
again we trim it<font color="#E5E5E5"> for white space on the</font>

770
00:34:15,520 --> 00:34:21,750
ends<font color="#E5E5E5"> and then we split it on our</font>

771
00:34:17,590 --> 00:34:25,560
delimiter exactly what we expected

772
00:34:21,750 --> 00:34:28,770
perfect<font color="#CCCCCC"> so all</font><font color="#E5E5E5"> of our all of our wildest</font>

773
00:34:25,560 --> 00:34:33,489
speculation<font color="#E5E5E5"> and dreams are coming true</font>

774
00:34:28,770 --> 00:34:34,179
<font color="#E5E5E5">so we found our C</font><font color="#CCCCCC"> 2 for sure all of our</font>

775
00:34:33,489 --> 00:34:36,339
guesses

776
00:34:34,179 --> 00:34:39,009
most of our guesses have been correct so

777
00:34:36,340 --> 00:34:42,040
far<font color="#CCCCCC"> we</font><font color="#E5E5E5"> know that our initially suspected</font>

778
00:34:39,010 --> 00:34:44,500
delimiter is indeed correct now we need

779
00:34:42,040 --> 00:34:47,739
to see how these values<font color="#E5E5E5"> are being used</font>

780
00:34:44,500 --> 00:34:49,870
<font color="#E5E5E5">so this is for sure the C</font><font color="#CCCCCC"> 2 but</font><font color="#E5E5E5"> we don't</font>

781
00:34:47,739 --> 00:34:52,209
know which of these URLs<font color="#CCCCCC"> is the target</font>

782
00:34:49,870 --> 00:34:55,810
what is the other URL for we have no

783
00:34:52,210 --> 00:35:00,030
idea at<font color="#CCCCCC"> this point</font><font color="#E5E5E5"> at this point though</font>

784
00:34:55,810 --> 00:35:03,700
we had already begun tracking that C<font color="#E5E5E5"> 2</font>

785
00:35:00,030 --> 00:35:07,600
<font color="#E5E5E5">and we had have without a doubt observed</font>

786
00:35:03,700 --> 00:35:09,370
that<font color="#E5E5E5"> URLs we were protecting and were</font>

787
00:35:07,600 --> 00:35:18,140
<font color="#E5E5E5">actively under attack from these</font>

788
00:35:09,370 --> 00:35:23,640
attackers were<font color="#E5E5E5"> showing up in this C 2 so</font>

789
00:35:18,140 --> 00:35:26,250
this is the s new<font color="#CCCCCC"> XR III whatever this</font>

790
00:35:23,640 --> 00:35:28,259
<font color="#E5E5E5">is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> attacking function</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you want to</font>

791
00:35:26,250 --> 00:35:29,040
know how a DDoS<font color="#E5E5E5"> is this is where all the</font>

792
00:35:28,260 --> 00:35:32,450
secrets lie

793
00:35:29,040 --> 00:35:35,940
the first thing worth noting<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the two</font>

794
00:35:32,450 --> 00:35:40,290
<font color="#E5E5E5">declarations for x64 that's in hex it</font>

795
00:35:35,940 --> 00:35:41,700
comes out to a decimal<font color="#E5E5E5"> 100</font><font color="#CCCCCC"> I had to</font>

796
00:35:40,290 --> 00:35:43,470
strip a lot of this out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> here to try</font>

797
00:35:41,700 --> 00:35:45,330
<font color="#E5E5E5">and fit it</font><font color="#CCCCCC"> onto</font><font color="#E5E5E5"> slides and even still it</font>

798
00:35:43,470 --> 00:35:47,279
spreads<font color="#E5E5E5"> across like three slides so</font>

799
00:35:45,330 --> 00:35:50,279
there are parts<font color="#CCCCCC"> missing</font><font color="#E5E5E5"> just know that</font>

800
00:35:47,280 --> 00:35:54,480
this was running in a loop you<font color="#E5E5E5"> can guess</font>

801
00:35:50,280 --> 00:35:56,670
how<font color="#CCCCCC"> many iterations it had so we spin up</font>

802
00:35:54,480 --> 00:35:58,530
a new<font color="#E5E5E5"> web instance</font><font color="#CCCCCC"> sorry web</font><font color="#E5E5E5"> view</font>

803
00:35:56,670 --> 00:36:01,590
instance<font color="#E5E5E5"> from that web view we anit it</font>

804
00:35:58,530 --> 00:36:03,870
<font color="#E5E5E5">we're also creating a new hash map the</font>

805
00:36:01,590 --> 00:36:05,520
hash map is interesting because it's

806
00:36:03,870 --> 00:36:08,880
basically<font color="#E5E5E5"> the object type that is</font>

807
00:36:05,520 --> 00:36:12,870
<font color="#E5E5E5">expected if you plan to override HTTP</font>

808
00:36:08,880 --> 00:36:16,500
headers<font color="#E5E5E5"> in a web view object</font><font color="#CCCCCC"> from there</font>

809
00:36:12,870 --> 00:36:20,400
we see map put<font color="#E5E5E5"> but first we see the con</font>

810
00:36:16,500 --> 00:36:22,080
string refer so here we can<font color="#CCCCCC"> figure out</font>

811
00:36:20,400 --> 00:36:24,120
that<font color="#CCCCCC"> we know that the three values</font>

812
00:36:22,080 --> 00:36:26,819
<font color="#CCCCCC">passed in</font><font color="#E5E5E5"> here you see</font><font color="#CCCCCC"> L java.lang</font>

813
00:36:24,120 --> 00:36:29,130
string<font color="#CCCCCC"> three times</font><font color="#E5E5E5"> up there in the</font>

814
00:36:26,820 --> 00:36:31,670
public<font color="#E5E5E5"> function header declaration for</font>

815
00:36:29,130 --> 00:36:35,730
the the<font color="#E5E5E5"> function itself the method and</font>

816
00:36:31,670 --> 00:36:39,300
the<font color="#E5E5E5"> peas map exactly to what you're</font>

817
00:36:35,730 --> 00:36:41,340
thinking there so<font color="#CCCCCC"> p1 p2 p3 so we know</font>

818
00:36:39,300 --> 00:36:44,220
<font color="#CCCCCC">that the third URL in this case is being</font>

819
00:36:41,340 --> 00:36:46,290
shoved into the referer header of<font color="#E5E5E5"> the</font>

820
00:36:44,220 --> 00:36:50,250
web<font color="#E5E5E5"> view that's going to be used for the</font>

821
00:36:46,290 --> 00:36:52,410
attack<font color="#E5E5E5"> we see X requested</font><font color="#CCCCCC"> with which</font><font color="#E5E5E5"> is</font>

822
00:36:50,250 --> 00:36:56,250
an interesting header this header<font color="#E5E5E5"> is</font>

823
00:36:52,410 --> 00:36:58,890
used<font color="#E5E5E5"> by the app it's built in and what</font>

824
00:36:56,250 --> 00:37:01,560
it basically does if you're using an

825
00:36:58,890 --> 00:37:03,960
embedded<font color="#CCCCCC"> web view the X requested with</font>

826
00:37:01,560 --> 00:37:07,620
header ships<font color="#E5E5E5"> with the name of the</font>

827
00:37:03,960 --> 00:37:09,540
<font color="#CCCCCC">application</font><font color="#E5E5E5"> that's doing the request we</font>

828
00:37:07,620 --> 00:37:10,790
can<font color="#E5E5E5"> see here</font><font color="#CCCCCC"> that the bad guy had</font>

829
00:37:09,540 --> 00:37:16,670
thought about<font color="#E5E5E5"> this</font>

830
00:37:10,790 --> 00:37:19,560
he blanks it<font color="#CCCCCC"> over written next we see</font>

831
00:37:16,670 --> 00:37:23,220
<font color="#E5E5E5">the request to get settings for the web</font>

832
00:37:19,560 --> 00:37:25,170
<font color="#E5E5E5">view that we're about to</font><font color="#CCCCCC"> use and we see</font>

833
00:37:23,220 --> 00:37:27,379
it enables JavaScript to make<font color="#E5E5E5"> sure that</font>

834
00:37:25,170 --> 00:37:30,240
we can bypass<font color="#E5E5E5"> our real browser checks</font>

835
00:37:27,380 --> 00:37:32,160
next we're setting the user<font color="#E5E5E5"> agent</font>

836
00:37:30,240 --> 00:37:34,470
we see here<font color="#E5E5E5"> that they're setting</font><font color="#CCCCCC"> v12</font>

837
00:37:32,160 --> 00:37:36,569
<font color="#E5E5E5">ptoo ptoo</font><font color="#CCCCCC"> we know as the</font><font color="#E5E5E5"> user agents the</font>

838
00:37:34,470 --> 00:37:38,160
<font color="#E5E5E5">second</font><font color="#CCCCCC"> value in the the title</font><font color="#E5E5E5"> that we</font>

839
00:37:36,570 --> 00:37:40,050
showed and we know<font color="#E5E5E5"> that has been split</font>

840
00:37:38,160 --> 00:37:42,420
<font color="#E5E5E5">into an array before</font><font color="#CCCCCC"> being</font><font color="#E5E5E5"> passed into</font>

841
00:37:40,050 --> 00:37:45,660
here or not<font color="#CCCCCC"> splintered an array but</font>

842
00:37:42,420 --> 00:37:48,300
chopped up and passed accordingly<font color="#CCCCCC"> we see</font>

843
00:37:45,660 --> 00:37:50,940
that<font color="#E5E5E5"> he clears the history not sure why</font>

844
00:37:48,300 --> 00:37:52,710
exactly<font color="#CCCCCC"> I guess</font><font color="#E5E5E5"> if you're browsing on</font>

845
00:37:50,940 --> 00:37:53,520
your phone and you look in your<font color="#CCCCCC"> history</font>

846
00:37:52,710 --> 00:37:55,619
<font color="#E5E5E5">and all of a sudden</font><font color="#CCCCCC"> there's all</font><font color="#E5E5E5"> these</font>

847
00:37:53,520 --> 00:37:57,540
sites you've never been to and there's

848
00:37:55,619 --> 00:38:00,330
thousands of pages<font color="#E5E5E5"> for it you might be</font><font color="#CCCCCC"> a</font>

849
00:37:57,540 --> 00:38:03,590
<font color="#E5E5E5">little suspicious</font><font color="#CCCCCC"> he clears</font><font color="#E5E5E5"> the form</font>

850
00:38:00,330 --> 00:38:06,960
<font color="#E5E5E5">data also</font><font color="#CCCCCC"> not sure why</font><font color="#E5E5E5"> but he does</font>

851
00:38:03,590 --> 00:38:08,490
<font color="#E5E5E5">clears the cache this one's obvious</font><font color="#CCCCCC"> if</font>

852
00:38:06,960 --> 00:38:09,630
you're<font color="#E5E5E5"> performing a DDoS attack and</font>

853
00:38:08,490 --> 00:38:13,020
you're getting cache hits on<font color="#E5E5E5"> your local</font>

854
00:38:09,630 --> 00:38:13,980
<font color="#E5E5E5">device you're failing don't do that</font><font color="#CCCCCC"> well</font>

855
00:38:13,020 --> 00:38:19,500
actually<font color="#E5E5E5"> do do that</font>

856
00:38:13,980 --> 00:38:22,800
do do that<font color="#CCCCCC"> then he clears the</font><font color="#E5E5E5"> web view</font>

857
00:38:19,500 --> 00:38:26,930
database from<font color="#E5E5E5"> the local device he wipes</font>

858
00:38:22,800 --> 00:38:31,770
<font color="#E5E5E5">the web cache DB from the local device</font>

859
00:38:26,930 --> 00:38:37,410
finally<font color="#E5E5E5"> he sets the cache mode to no</font>

860
00:38:31,770 --> 00:38:40,020
caching<font color="#E5E5E5"> and then he loads the URL for</font>

861
00:38:37,410 --> 00:38:45,118
the<font color="#E5E5E5"> target and here we can see he's</font>

862
00:38:40,020 --> 00:38:47,730
loading p1 into v1 so we know<font color="#CCCCCC"> that now</font>

863
00:38:45,119 --> 00:38:52,050
<font color="#CCCCCC">we</font><font color="#E5E5E5"> can absolutely positively confirm</font>

864
00:38:47,730 --> 00:38:53,760
that the order<font color="#E5E5E5"> and use for those values</font>

865
00:38:52,050 --> 00:38:56,430
are what we thought they were first one

866
00:38:53,760 --> 00:38:58,530
target URL<font color="#E5E5E5"> second one user agent third</font>

867
00:38:56,430 --> 00:39:01,410
one we now know is the referer header

868
00:38:58,530 --> 00:39:07,050
<font color="#E5E5E5">that will show up in the HTTP headers</font>

869
00:39:01,410 --> 00:39:09,779
for the attack<font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> creates a new</font>

870
00:39:07,050 --> 00:39:11,070
<font color="#E5E5E5">instance of same file</font><font color="#CCCCCC"> name</font><font color="#E5E5E5"> dollar sign</font>

871
00:39:09,780 --> 00:39:13,050
<font color="#E5E5E5">three we won't go into that it was</font>

872
00:39:11,070 --> 00:39:16,050
basically just<font color="#E5E5E5"> an empty skeleton to</font>

873
00:39:13,050 --> 00:39:17,280
catch errors and fail gracefully<font color="#E5E5E5"> without</font>

874
00:39:16,050 --> 00:39:21,720
<font color="#E5E5E5">throwing errors in the users face</font>

875
00:39:17,280 --> 00:39:28,070
<font color="#E5E5E5">because something went wrong</font><font color="#CCCCCC"> and then we</font>

876
00:39:21,720 --> 00:39:30,450
<font color="#CCCCCC">see a</font><font color="#E5E5E5"> dent and he increments v-0 so</font>

877
00:39:28,070 --> 00:39:31,590
essentially we're in a loop<font color="#CCCCCC"> and what</font>

878
00:39:30,450 --> 00:39:34,080
we're<font color="#E5E5E5"> gonna do is we're gonna spin up</font>

879
00:39:31,590 --> 00:39:36,390
<font color="#E5E5E5">100 web views we're gonna load them up</font>

880
00:39:34,080 --> 00:39:37,950
<font color="#CCCCCC">with our</font><font color="#E5E5E5"> target using the user agent we</font>

881
00:39:36,390 --> 00:39:40,230
requested with blank requested with

882
00:39:37,950 --> 00:39:41,950
<font color="#E5E5E5">headers and a refer that we've specified</font>

883
00:39:40,230 --> 00:39:43,569
from<font color="#E5E5E5"> the c2</font>

884
00:39:41,950 --> 00:39:48,098
and send all that traffic<font color="#E5E5E5"> at our poor</font>

885
00:39:43,569 --> 00:39:50,770
poor victims so there we go

886
00:39:48,099 --> 00:39:53,920
this<font color="#E5E5E5"> is what we've we now absolutely</font>

887
00:39:50,770 --> 00:39:58,930
positively can confirm<font color="#E5E5E5"> is coming out of</font>

888
00:39:53,920 --> 00:40:04,480
these malicious apps this<font color="#E5E5E5"> would be the</font>

889
00:39:58,930 --> 00:40:06,759
<font color="#E5E5E5">pseudocode based on the decompile stuff</font>

890
00:40:04,480 --> 00:40:08,559
that we just<font color="#E5E5E5"> discussed</font><font color="#CCCCCC"> if you were more</font>

891
00:40:06,760 --> 00:40:12,280
<font color="#E5E5E5">comfortable looking at it and something</font>

892
00:40:08,559 --> 00:40:14,049
that resembles a real language<font color="#CCCCCC"> attack</font>

893
00:40:12,280 --> 00:40:17,380
command parser extends<font color="#CCCCCC"> web view client</font>

894
00:40:14,049 --> 00:40:22,000
<font color="#CCCCCC">on page finished</font><font color="#E5E5E5"> page title get title if</font>

895
00:40:17,380 --> 00:40:25,780
it contains our delimiter continue<font color="#CCCCCC"> trim</font>

896
00:40:22,000 --> 00:40:28,750
it split it pass it<font color="#E5E5E5"> into our DDoS attack</font>

897
00:40:25,780 --> 00:40:32,559
<font color="#E5E5E5">service and</font><font color="#CCCCCC"> ddos attack service looks</font>

898
00:40:28,750 --> 00:40:34,480
like this target user agent refer get

899
00:40:32,559 --> 00:40:38,290
your webview headers<font color="#CCCCCC"> overwrite refer</font>

900
00:40:34,480 --> 00:40:41,020
blank your<font color="#CCCCCC"> ex requested with header spin</font>

901
00:40:38,290 --> 00:40:45,308
<font color="#CCCCCC">up</font><font color="#E5E5E5"> 100 instances of a webview</font><font color="#CCCCCC"> and an</font>

902
00:40:41,020 --> 00:40:47,680
array loop over<font color="#E5E5E5"> and inject your new web</font>

903
00:40:45,309 --> 00:40:48,880
views<font color="#E5E5E5"> into your existing array make sure</font>

904
00:40:47,680 --> 00:40:50,558
you override the<font color="#E5E5E5"> settings</font><font color="#CCCCCC"> and do</font>

905
00:40:48,880 --> 00:40:53,230
everything<font color="#E5E5E5"> delete all your files</font>

906
00:40:50,559 --> 00:40:59,619
everything<font color="#E5E5E5"> between sessions continue</font>

907
00:40:53,230 --> 00:41:01,809
onward so now that we know<font color="#E5E5E5"> how this is</font>

908
00:40:59,619 --> 00:41:04,770
<font color="#E5E5E5">being</font><font color="#CCCCCC"> used and this step like I said</font>

909
00:41:01,809 --> 00:41:07,750
already happened but it was<font color="#CCCCCC"> still fun</font>

910
00:41:04,770 --> 00:41:12,040
<font color="#CCCCCC">basically we just begin</font><font color="#E5E5E5"> tracking this</font>

911
00:41:07,750 --> 00:41:14,680
<font color="#CCCCCC">situ</font><font color="#E5E5E5"> non-stop and we did it over tor so</font>

912
00:41:12,040 --> 00:41:18,430
if you blocked us<font color="#E5E5E5"> you know we'd be back</font>

913
00:41:14,680 --> 00:41:20,950
in<font color="#CCCCCC"> 5 minutes and this</font><font color="#E5E5E5"> allowed us to</font>

914
00:41:18,430 --> 00:41:22,598
<font color="#CCCCCC">capture a lot of attack traffic confirm</font>

915
00:41:20,950 --> 00:41:27,759
attacks against our<font color="#E5E5E5"> own customers as</font>

916
00:41:22,599 --> 00:41:30,250
well as monitor real-time<font color="#E5E5E5"> attack traffic</font>

917
00:41:27,760 --> 00:41:33,069
<font color="#CCCCCC">against other people that we didn't know</font>

918
00:41:30,250 --> 00:41:35,140
<font color="#E5E5E5">so</font><font color="#CCCCCC"> while we can say hey we know</font><font color="#E5E5E5"> this</font>

919
00:41:33,069 --> 00:41:37,230
thing's attacking us it was also fun to

920
00:41:35,140 --> 00:41:40,990
<font color="#E5E5E5">say hey this thing's attacking them and</font>

921
00:41:37,230 --> 00:41:43,359
they're down<font color="#E5E5E5"> ok they're starting to come</font>

922
00:41:40,990 --> 00:41:47,558
<font color="#CCCCCC">back</font><font color="#E5E5E5"> up and now they're</font><font color="#CCCCCC"> changing stuff</font>

923
00:41:43,359 --> 00:41:51,160
so it<font color="#E5E5E5"> was pretty cool to</font><font color="#CCCCCC"> watch I guess</font>

924
00:41:47,559 --> 00:41:52,660
would<font color="#CCCCCC"> be</font><font color="#E5E5E5"> some Freud or it was fun to</font>

925
00:41:51,160 --> 00:41:53,240
watch<font color="#E5E5E5"> but it was painful to watch at the</font>

926
00:41:52,660 --> 00:41:56,330
<font color="#E5E5E5">same time</font>

927
00:41:53,240 --> 00:41:59,419
yeah phone when<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> marrows yeah it's</font>

928
00:41:56,330 --> 00:42:01,759
always<font color="#E5E5E5"> fun when it's not us so what did</font>

929
00:41:59,420 --> 00:42:04,790
we<font color="#CCCCCC"> learn from watching</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> situ</font><font color="#E5E5E5"> for a</font>

930
00:42:01,760 --> 00:42:07,730
considerable<font color="#E5E5E5"> amount of time</font><font color="#CCCCCC"> we managed</font>

931
00:42:04,790 --> 00:42:09,259
<font color="#CCCCCC">to capture</font><font color="#E5E5E5"> over the course of well first</font>

932
00:42:07,730 --> 00:42:11,840
of<font color="#E5E5E5"> all the timeline of this was it</font>

933
00:42:09,260 --> 00:42:15,650
attacked us<font color="#E5E5E5"> on the weekend and by the</font>

934
00:42:11,840 --> 00:42:21,320
next weekend<font color="#CCCCCC"> it was</font><font color="#E5E5E5"> down or it was in</font>

935
00:42:15,650 --> 00:42:23,810
the process<font color="#CCCCCC"> of going down and in a</font>

936
00:42:21,320 --> 00:42:27,830
<font color="#E5E5E5">little over seven</font><font color="#CCCCCC"> days it was completely</font>

937
00:42:23,810 --> 00:42:29,509
<font color="#E5E5E5">down</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> 386 thousand attack commands</font>

938
00:42:27,830 --> 00:42:33,619
were observed over<font color="#E5E5E5"> that course that it</font>

939
00:42:29,510 --> 00:42:36,890
was still<font color="#E5E5E5"> up and running of those 386</font>

940
00:42:33,619 --> 00:42:39,650
thousand attack commands 17,000 of them

941
00:42:36,890 --> 00:42:43,160
<font color="#E5E5E5">targeted</font><font color="#CCCCCC"> a unique domain and path</font>

942
00:42:39,650 --> 00:42:44,840
combination so just like we said if they

943
00:42:43,160 --> 00:42:47,089
<font color="#E5E5E5">are active they're actively monitoring</font>

944
00:42:44,840 --> 00:42:49,520
you and they're actively<font color="#E5E5E5"> seeing if their</font>

945
00:42:47,090 --> 00:42:51,880
attack is<font color="#E5E5E5"> having impact these guys</font>

946
00:42:49,520 --> 00:42:54,770
<font color="#CCCCCC">attacks 17,000 different things</font><font color="#E5E5E5"> and</font>

947
00:42:51,880 --> 00:42:56,540
thousands of<font color="#E5E5E5"> those same</font><font color="#CCCCCC"> things or</font>

948
00:42:54,770 --> 00:42:59,420
<font color="#E5E5E5">different things were across the</font><font color="#CCCCCC"> same</font>

949
00:42:56,540 --> 00:43:01,310
people<font color="#E5E5E5"> you know if you were sitting</font><font color="#CCCCCC"> over</font>

950
00:42:59,420 --> 00:43:03,109
here<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> hammering your cart and</font>

951
00:43:01,310 --> 00:43:04,430
you start putting<font color="#E5E5E5"> some kind of</font>

952
00:43:03,109 --> 00:43:07,190
<font color="#E5E5E5">mitigation in place that's protecting</font>

953
00:43:04,430 --> 00:43:08,660
your cart<font color="#E5E5E5"> and it starts to work all of</font><font color="#CCCCCC"> a</font>

954
00:43:07,190 --> 00:43:10,460
sudden they start hammering your

955
00:43:08,660 --> 00:43:12,560
customer service<font color="#CCCCCC"> form or your ticket</font>

956
00:43:10,460 --> 00:43:14,900
system<font color="#E5E5E5"> or anything else that</font><font color="#CCCCCC"> they think</font>

957
00:43:12,560 --> 00:43:19,100
<font color="#E5E5E5">might cause impact to your</font><font color="#CCCCCC"> your</font>

958
00:43:14,900 --> 00:43:22,340
organization<font color="#E5E5E5"> of those 17,000 unique</font>

959
00:43:19,100 --> 00:43:23,529
endpoints there were only 61 domains

960
00:43:22,340 --> 00:43:27,020
that were targeted

961
00:43:23,530 --> 00:43:30,050
so they<font color="#CCCCCC"> attacked 17,000 things across 61</font>

962
00:43:27,020 --> 00:43:32,570
organizations<font color="#CCCCCC"> the targets included</font>

963
00:43:30,050 --> 00:43:37,270
travel which we know<font color="#E5E5E5"> from firsthand</font>

964
00:43:32,570 --> 00:43:40,480
experience ecommerce<font color="#CCCCCC"> a very large</font>

965
00:43:37,270 --> 00:43:42,830
e-commerce<font color="#CCCCCC"> website named after a jungle</font>

966
00:43:40,480 --> 00:43:44,630
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> hilarious if you think about</font><font color="#E5E5E5"> it</font>

967
00:43:42,830 --> 00:43:46,400
yeah let's attack them they have so many

968
00:43:44,630 --> 00:43:48,560
servers<font color="#E5E5E5"> that</font><font color="#CCCCCC"> they give half of them away</font>

969
00:43:46,400 --> 00:43:52,869
<font color="#E5E5E5">I'm sure</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can take them</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> with our</font>

970
00:43:48,560 --> 00:43:59,109
botnet<font color="#E5E5E5"> file-sharing torrenting stuff</font>

971
00:43:52,869 --> 00:43:59,109
<font color="#CCCCCC">prawn always a hot target</font><font color="#E5E5E5"> governments</font>

972
00:43:59,440 --> 00:44:02,819
<font color="#E5E5E5">gaming</font>

973
00:44:01,349 --> 00:44:12,499
just I want<font color="#E5E5E5"> to say these things</font><font color="#CCCCCC"> but I</font>

974
00:44:02,819 --> 00:44:17,759
can't say them<font color="#E5E5E5"> so okay they they had</font>

975
00:44:12,499 --> 00:44:19,288
<font color="#E5E5E5">36,800 unique user agents overall that</font>

976
00:44:17,759 --> 00:44:21,450
were used<font color="#E5E5E5"> in their attacks this includes</font>

977
00:44:19,289 --> 00:44:24,569
the randomized ones we found<font color="#CCCCCC"> that if you</font>

978
00:44:21,450 --> 00:44:25,950
<font color="#E5E5E5">hit them</font><font color="#CCCCCC"> they were basically just</font>

979
00:44:24,569 --> 00:44:27,269
shuffling that you would always get<font color="#E5E5E5"> a</font>

980
00:44:25,950 --> 00:44:28,979
new<font color="#E5E5E5"> unique one even if they were hitting</font>

981
00:44:27,269 --> 00:44:33,299
the same target<font color="#E5E5E5"> so it was like they had</font>

982
00:44:28,979 --> 00:44:35,910
a randomization script or some kind<font color="#CCCCCC"> of</font>

983
00:44:33,299 --> 00:44:38,519
function in the<font color="#CCCCCC"> situ but more</font>

984
00:44:35,910 --> 00:44:40,259
interesting<font color="#E5E5E5"> is that if we omit all of</font>

985
00:44:38,519 --> 00:44:44,308
those and we only look at ones that look

986
00:44:40,259 --> 00:44:46,019
like<font color="#E5E5E5"> real valid user agents we observed</font>

987
00:44:44,309 --> 00:44:48,979
<font color="#E5E5E5">eight thousand four hundred and ninety</font>

988
00:44:46,019 --> 00:44:52,288
<font color="#CCCCCC">two user agents that looked super legit</font>

989
00:44:48,979 --> 00:44:55,410
like it would<font color="#E5E5E5"> be</font><font color="#CCCCCC"> opera coming from</font>

990
00:44:52,289 --> 00:44:57,390
<font color="#E5E5E5">Windows XP</font><font color="#CCCCCC"> it would be Firefox on</font>

991
00:44:55,410 --> 00:45:00,210
Windows<font color="#CCCCCC"> seven it would be FreeBSD</font>

992
00:44:57,390 --> 00:45:02,150
running<font color="#CCCCCC"> chrome like super legit</font><font color="#E5E5E5"> you</font>

993
00:45:00,210 --> 00:45:04,499
would never suspect that<font color="#E5E5E5"> they were</font>

994
00:45:02,150 --> 00:45:06,479
nefarious at all

995
00:45:04,499 --> 00:45:09,689
the attackers were very very<font color="#E5E5E5"> active in</font>

996
00:45:06,479 --> 00:45:11,069
pivoting<font color="#CCCCCC"> they appeared</font><font color="#E5E5E5"> to be just</font><font color="#CCCCCC"> as we</font>

997
00:45:09,690 --> 00:45:12,660
were monitoring<font color="#E5E5E5"> it appeared that they</font>

998
00:45:11,069 --> 00:45:15,538
were monitoring<font color="#CCCCCC"> too and as soon as they</font>

999
00:45:12,660 --> 00:45:17,219
had impact<font color="#E5E5E5"> and it that impact started to</font>

1000
00:45:15,539 --> 00:45:18,960
go away and the<font color="#E5E5E5"> the target recovered</font>

1001
00:45:17,219 --> 00:45:24,359
they would<font color="#E5E5E5"> pivot and start to make</font>

1002
00:45:18,960 --> 00:45:25,589
<font color="#CCCCCC">changes how did this happen so</font><font color="#E5E5E5"> basically</font>

1003
00:45:24,359 --> 00:45:27,359
this happened because they were<font color="#E5E5E5"> named</font>

1004
00:45:25,589 --> 00:45:30,089
squatting on<font color="#E5E5E5"> the Play Store</font><font color="#CCCCCC"> there are</font>

1005
00:45:27,359 --> 00:45:32,549
apps that<font color="#CCCCCC"> you can get</font><font color="#E5E5E5"> for apks or you</font>

1006
00:45:30,089 --> 00:45:34,170
can get apks<font color="#E5E5E5"> for that are against the</font>

1007
00:45:32,549 --> 00:45:37,440
Terms of Service<font color="#E5E5E5"> of Google's own Play</font>

1008
00:45:34,170 --> 00:45:39,989
Store<font color="#E5E5E5"> and therefore they</font><font color="#CCCCCC"> cannot be</font><font color="#E5E5E5"> had</font>

1009
00:45:37,440 --> 00:45:42,420
<font color="#E5E5E5">so what they basically did was grab</font>

1010
00:45:39,989 --> 00:45:44,309
these apps<font color="#E5E5E5"> decompile them shove their</font>

1011
00:45:42,420 --> 00:45:47,729
backdoors<font color="#CCCCCC"> and upload them to</font><font color="#E5E5E5"> the Play</font>

1012
00:45:44,309 --> 00:45:50,279
Store under a very similar name that

1013
00:45:47,729 --> 00:45:52,589
would hit on a search for<font color="#CCCCCC"> an ignorant</font>

1014
00:45:50,279 --> 00:45:55,289
user that ignorant user would install

1015
00:45:52,589 --> 00:45:57,210
this<font color="#CCCCCC"> application and until Google</font><font color="#E5E5E5"> caught</font>

1016
00:45:55,289 --> 00:46:00,119
on it would sit there infecting<font color="#CCCCCC"> people</font>

1017
00:45:57,210 --> 00:46:01,829
and then once it<font color="#CCCCCC"> was pulled</font><font color="#E5E5E5"> that was it</font>

1018
00:46:00,119 --> 00:46:03,420
it would stay<font color="#CCCCCC"> on that</font><font color="#E5E5E5"> users device so</font>

1019
00:46:01,829 --> 00:46:04,769
long as they did<font color="#CCCCCC"> not install it how many</font>

1020
00:46:03,420 --> 00:46:05,940
go look at<font color="#E5E5E5"> your phone right now and</font><font color="#CCCCCC"> you</font>

1021
00:46:04,769 --> 00:46:07,468
tell<font color="#CCCCCC"> me how many apps you got there that</font>

1022
00:46:05,940 --> 00:46:12,019
<font color="#E5E5E5">you installed like one time you've never</font>

1023
00:46:07,469 --> 00:46:12,019
<font color="#E5E5E5">looked at again that's one of these guys</font>

1024
00:46:12,779 --> 00:46:16,329
so yeah that<font color="#E5E5E5"> was pretty much it</font><font color="#CCCCCC"> they</font>

1025
00:46:15,099 --> 00:46:19,479
would trash their accounts they had

1026
00:46:16,329 --> 00:46:20,859
multiple<font color="#E5E5E5"> very shady accounts the</font>

1027
00:46:19,479 --> 00:46:23,649
developer names were<font color="#CCCCCC"> always</font><font color="#E5E5E5"> just like</font>

1028
00:46:20,859 --> 00:46:25,359
<font color="#CCCCCC">ten character alphanumeric</font><font color="#E5E5E5"> random and</font>

1029
00:46:23,650 --> 00:46:29,079
people still would just be like<font color="#E5E5E5"> I'm</font>

1030
00:46:25,359 --> 00:46:32,019
<font color="#E5E5E5">gonna install this this seems</font><font color="#CCCCCC"> good here</font>

1031
00:46:29,079 --> 00:46:34,449
are<font color="#E5E5E5"> some of the apps also interesting we</font>

1032
00:46:32,019 --> 00:46:36,879
tried to test these<font color="#CCCCCC"> in the Android</font>

1033
00:46:34,449 --> 00:46:39,339
virtual device the AVD stuff and they

1034
00:46:36,880 --> 00:46:42,670
didn't do<font color="#CCCCCC"> anything</font><font color="#E5E5E5"> need to</font><font color="#CCCCCC"> actually go</font>

1035
00:46:39,339 --> 00:46:46,209
out<font color="#E5E5E5"> buy some crappy burner devices throw</font>

1036
00:46:42,670 --> 00:46:48,880
<font color="#E5E5E5">them on ADB and load these apps over ADB</font>

1037
00:46:46,209 --> 00:46:50,890
via unknown<font color="#E5E5E5"> sources and then once we</font>

1038
00:46:48,880 --> 00:46:53,859
spun them up<font color="#E5E5E5"> we were able to actually</font>

1039
00:46:50,890 --> 00:46:57,359
<font color="#E5E5E5">get them</font><font color="#CCCCCC"> to go from there we were</font><font color="#E5E5E5"> able</font>

1040
00:46:53,859 --> 00:47:01,989
<font color="#CCCCCC">to spin up</font><font color="#E5E5E5"> throw them on Wi-Fi</font><font color="#CCCCCC"> and</font>

1041
00:46:57,359 --> 00:47:05,078
<font color="#E5E5E5">control DNS then we could trigger replay</font>

1042
00:47:01,989 --> 00:47:07,689
attacks of previous attack commands and

1043
00:47:05,079 --> 00:47:09,839
<font color="#E5E5E5">test moving fields around changing</font>

1044
00:47:07,689 --> 00:47:13,449
values seeing what<font color="#E5E5E5"> this thing could do</font>

1045
00:47:09,839 --> 00:47:15,489
if you<font color="#E5E5E5"> looked at the permissions</font>

1046
00:47:13,449 --> 00:47:18,749
<font color="#CCCCCC">required it needed full administration</font>

1047
00:47:15,489 --> 00:47:21,819
permissions which what could go wrong

1048
00:47:18,749 --> 00:47:25,029
<font color="#CCCCCC">and it would</font><font color="#E5E5E5"> spin up services in the</font>

1049
00:47:21,819 --> 00:47:28,150
background<font color="#E5E5E5"> so what does this mean this</font>

1050
00:47:25,029 --> 00:47:30,219
<font color="#E5E5E5">means you got hot pockets</font><font color="#CCCCCC"> they ran in</font>

1051
00:47:28,150 --> 00:47:31,779
the background<font color="#E5E5E5"> that so it didn't the app</font>

1052
00:47:30,219 --> 00:47:33,849
didn't need to<font color="#E5E5E5"> be running for this thing</font>

1053
00:47:31,779 --> 00:47:35,439
to run<font color="#E5E5E5"> as soon as you launched</font><font color="#CCCCCC"> it the</font>

1054
00:47:33,849 --> 00:47:37,269
first time it<font color="#CCCCCC"> spun up a</font><font color="#E5E5E5"> service that did</font>

1055
00:47:35,439 --> 00:47:41,348
what it needed to do<font color="#E5E5E5"> and that service</font>

1056
00:47:37,269 --> 00:47:42,999
ran<font color="#E5E5E5"> forever</font><font color="#CCCCCC"> it would connect or attack</font>

1057
00:47:41,349 --> 00:47:44,589
using whatever<font color="#CCCCCC"> connection it had so</font>

1058
00:47:42,999 --> 00:47:46,238
you're in<font color="#E5E5E5"> your car you're</font><font color="#CCCCCC"> driving to</font>

1059
00:47:44,589 --> 00:47:48,069
work<font color="#E5E5E5"> you're hopping</font><font color="#CCCCCC"> across multiple</font>

1060
00:47:46,239 --> 00:47:50,079
<font color="#E5E5E5">wireless towers you're getting new IPs</font>

1061
00:47:48,069 --> 00:47:51,429
you're attacking<font color="#E5E5E5"> all that time you get</font>

1062
00:47:50,079 --> 00:47:52,929
to Starbucks you're ordering your coffee

1063
00:47:51,429 --> 00:47:54,759
<font color="#CCCCCC">you're on their Wi-Fi you're</font><font color="#E5E5E5"> attacking</font>

1064
00:47:52,929 --> 00:47:55,839
all that time you<font color="#E5E5E5"> get to work you're</font>

1065
00:47:54,759 --> 00:47:57,160
sitting in the<font color="#E5E5E5"> conference room you're</font>

1066
00:47:55,839 --> 00:47:58,449
bored you're looking at your phone your

1067
00:47:57,160 --> 00:48:00,368
<font color="#CCCCCC">phone's</font><font color="#E5E5E5"> hot you don't know why you're</font>

1068
00:47:58,449 --> 00:48:01,779
attacking all that time you go<font color="#E5E5E5"> home</font>

1069
00:48:00,369 --> 00:48:03,309
you're on Wi-Fi<font color="#CCCCCC"> you charge your phone</font>

1070
00:48:01,779 --> 00:48:04,929
three times<font color="#CCCCCC"> a day battery's still dying</font>

1071
00:48:03,309 --> 00:48:08,589
you don't know why it's a tagging all

1072
00:48:04,929 --> 00:48:11,529
<font color="#CCCCCC">the time so this</font><font color="#E5E5E5"> is part</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> reason</font>

1073
00:48:08,589 --> 00:48:13,299
<font color="#CCCCCC">that we saw so</font><font color="#E5E5E5"> much traffic distribution</font>

1074
00:48:11,529 --> 00:48:14,769
<font color="#E5E5E5">and a lot of stuff coming out of this</font>

1075
00:48:13,299 --> 00:48:16,029
thing<font color="#E5E5E5"> also</font><font color="#CCCCCC"> if you haven't</font><font color="#E5E5E5"> tried</font>

1076
00:48:14,769 --> 00:48:18,540
cheeseburger lean pockets they're

1077
00:48:16,029 --> 00:48:23,370
delicious<font color="#E5E5E5"> do it</font>

1078
00:48:18,540 --> 00:48:26,160
uh<font color="#E5E5E5"> I went the wrong</font><font color="#CCCCCC"> way take</font><font color="#E5E5E5"> down</font><font color="#CCCCCC"> like I</font>

1079
00:48:23,370 --> 00:48:28,259
<font color="#CCCCCC">said</font><font color="#E5E5E5"> the once we had figured this thing</font>

1080
00:48:26,160 --> 00:48:29,730
out<font color="#E5E5E5"> and could absolutely positively</font>

1081
00:48:28,260 --> 00:48:32,370
confirm that it<font color="#CCCCCC"> was an attacking source</font>

1082
00:48:29,730 --> 00:48:36,540
<font color="#CCCCCC">we notified Google Google was super</font>

1083
00:48:32,370 --> 00:48:40,049
responsive<font color="#CCCCCC"> they began taking stuff down</font>

1084
00:48:36,540 --> 00:48:42,360
immediately<font color="#CCCCCC"> they identified lots of apps</font>

1085
00:48:40,050 --> 00:48:45,660
they identified over<font color="#E5E5E5"> 400 apps from</font><font color="#CCCCCC"> the</font>

1086
00:48:42,360 --> 00:48:48,270
same developer or at least based on

1087
00:48:45,660 --> 00:48:50,069
<font color="#E5E5E5">trends related to that developer and</font>

1088
00:48:48,270 --> 00:48:52,530
they were able<font color="#E5E5E5"> to remove those apps from</font>

1089
00:48:50,070 --> 00:48:54,420
the<font color="#E5E5E5"> Play Store and get them out</font><font color="#CCCCCC"> of there</font>

1090
00:48:52,530 --> 00:48:56,850
using the new Play protect features on

1091
00:48:54,420 --> 00:48:58,920
<font color="#E5E5E5">some newer devices they were also able</font>

1092
00:48:56,850 --> 00:49:01,710
to<font color="#E5E5E5"> remotely uninstall the apps from</font>

1093
00:48:58,920 --> 00:49:03,420
infected devices<font color="#E5E5E5"> and the really</font><font color="#CCCCCC"> cool</font>

1094
00:49:01,710 --> 00:49:05,940
<font color="#CCCCCC">part was</font><font color="#E5E5E5"> if anybody else tried to</font>

1095
00:49:03,420 --> 00:49:09,000
<font color="#CCCCCC">download them and</font><font color="#E5E5E5"> install</font><font color="#CCCCCC"> them from</font><font color="#E5E5E5"> apk</font>

1096
00:49:05,940 --> 00:49:10,200
<font color="#CCCCCC">mears or anything else you would be hit</font>

1097
00:49:09,000 --> 00:49:11,580
with this right in the<font color="#E5E5E5"> face</font>

1098
00:49:10,200 --> 00:49:13,020
app can be<font color="#CCCCCC"> used to perform denial of</font>

1099
00:49:11,580 --> 00:49:14,910
service attacks against other systems

1100
00:49:13,020 --> 00:49:20,640
<font color="#CCCCCC">and resources yadda yadda yadda</font>

1101
00:49:14,910 --> 00:49:23,970
please don't install<font color="#E5E5E5"> this crap</font><font color="#CCCCCC"> after we</font>

1102
00:49:20,640 --> 00:49:25,859
went<font color="#E5E5E5"> public it was discovered</font><font color="#CCCCCC"> that there</font>

1103
00:49:23,970 --> 00:49:27,209
were also UDP attack capabilities which

1104
00:49:25,860 --> 00:49:31,410
we did<font color="#E5E5E5"> not see in some of the samples</font>

1105
00:49:27,210 --> 00:49:34,140
that<font color="#E5E5E5"> we had found upon the discovery of</font>

1106
00:49:31,410 --> 00:49:36,420
<font color="#E5E5E5">that from 360</font><font color="#CCCCCC"> cien we did go</font><font color="#E5E5E5"> back and</font>

1107
00:49:34,140 --> 00:49:38,069
look at our<font color="#CCCCCC"> 24 somethin samples and like</font>

1108
00:49:36,420 --> 00:49:39,420
one or<font color="#CCCCCC"> two</font><font color="#E5E5E5"> of them did</font><font color="#CCCCCC"> have these</font>

1109
00:49:38,070 --> 00:49:42,420
<font color="#E5E5E5">capabilities we just missed it</font><font color="#CCCCCC"> because</font>

1110
00:49:39,420 --> 00:49:46,290
there was<font color="#E5E5E5"> so much other</font><font color="#CCCCCC"> stuff if you</font>

1111
00:49:42,420 --> 00:49:50,820
want more<font color="#E5E5E5"> about that</font><font color="#CCCCCC"> Google</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> goo GL</font>

1112
00:49:46,290 --> 00:49:51,990
<font color="#E5E5E5">/ -</font><font color="#CCCCCC"> you BTR X there's a full</font><font color="#E5E5E5"> write-up</font>

1113
00:49:50,820 --> 00:49:53,670
there<font color="#E5E5E5"> same deal</font>

1114
00:49:51,990 --> 00:49:56,970
picking<font color="#CCCCCC"> it all apart</font><font color="#E5E5E5"> analyzing the</font>

1115
00:49:53,670 --> 00:49:58,980
source code this<font color="#E5E5E5"> was not just</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> kamae it</font>

1116
00:49:56,970 --> 00:50:01,470
was a team effort<font color="#CCCCCC"> it involved Google</font>

1117
00:49:58,980 --> 00:50:05,550
team<font color="#E5E5E5"> Comrie risk IQ CloudFlare</font><font color="#CCCCCC"> Oracle</font>

1118
00:50:01,470 --> 00:50:10,379
<font color="#CCCCCC">flashpoint Rory</font><font color="#E5E5E5"> and they all</font><font color="#CCCCCC"> deserve</font>

1119
00:50:05,550 --> 00:50:12,960
<font color="#CCCCCC">high-fives some of the all the guys in</font>

1120
00:50:10,380 --> 00:50:14,490
<font color="#E5E5E5">blue are some of the Akamai researchers</font>

1121
00:50:12,960 --> 00:50:15,810
and and resources<font color="#E5E5E5"> that helped including</font>

1122
00:50:14,490 --> 00:50:17,160
this man<font color="#E5E5E5"> right</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> Dave</font><font color="#CCCCCC"> McEwen who's</font>

1123
00:50:15,810 --> 00:50:19,529
too afraid<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get on stage</font><font color="#CCCCCC"> so I'm</font>

1124
00:50:17,160 --> 00:50:22,699
calling him<font color="#E5E5E5"> out</font>

1125
00:50:19,530 --> 00:50:22,699
[Applause]

1126
00:50:23,079 --> 00:50:28,670
in red is<font color="#E5E5E5"> miss miss</font><font color="#CCCCCC"> Jaime</font><font color="#E5E5E5"> Cochran she</font>

1127
00:50:26,990 --> 00:50:30,828
recently passed away<font color="#E5E5E5"> she was</font><font color="#CCCCCC"> an amazing</font>

1128
00:50:28,670 --> 00:50:32,690
researcher and you should definitely

1129
00:50:30,829 --> 00:50:35,210
google her name<font color="#E5E5E5"> she was also an epic</font>

1130
00:50:32,690 --> 00:50:36,470
troll a troll that<font color="#CCCCCC"> was so good they</font>

1131
00:50:35,210 --> 00:50:41,720
brought her on talk shows<font color="#E5E5E5"> to troll</font>

1132
00:50:36,470 --> 00:50:46,779
people<font color="#E5E5E5"> so that's it</font><font color="#CCCCCC"> we've got 30 seconds</font>

1133
00:50:41,720 --> 00:50:46,779
Q&A go yeah

1134
00:50:49,089 --> 00:50:55,520
<font color="#CCCCCC">molly code</font><font color="#E5E5E5"> why did you not</font><font color="#CCCCCC"> use like</font>

1135
00:50:53,119 --> 00:50:56,809
<font color="#CCCCCC">dexter</font><font color="#E5E5E5"> jar JD do something so you could</font>

1136
00:50:55,520 --> 00:50:58,040
actually get it back<font color="#E5E5E5"> were they doing</font>

1137
00:50:56,809 --> 00:50:58,880
some type<font color="#E5E5E5"> of authentication are we</font>

1138
00:50:58,040 --> 00:51:01,520
trying<font color="#CCCCCC"> to do something</font><font color="#E5E5E5"> that was</font>

1139
00:50:58,880 --> 00:51:04,099
programmable easy to do<font color="#E5E5E5"> that across all</font>

1140
00:51:01,520 --> 00:51:06,079
<font color="#E5E5E5">the apps</font><font color="#CCCCCC"> sir to be</font><font color="#E5E5E5"> honest for me I had</font>

1141
00:51:04,099 --> 00:51:08,240
never really picked apart an apk before

1142
00:51:06,079 --> 00:51:10,369
<font color="#E5E5E5">and when I started</font><font color="#CCCCCC"> looking into it</font>

1143
00:51:08,240 --> 00:51:14,629
apktool was the first thing that<font color="#CCCCCC"> I found</font>

1144
00:51:10,369 --> 00:51:17,059
<font color="#E5E5E5">and it did</font><font color="#CCCCCC"> exactly what</font><font color="#E5E5E5"> I needed on the</font>

1145
00:51:14,630 --> 00:51:17,990
first try it got me visibility into the

1146
00:51:17,059 --> 00:51:21,559
source code<font color="#CCCCCC"> that I wouldn't</font><font color="#E5E5E5"> have</font>

1147
00:51:17,990 --> 00:51:23,180
<font color="#CCCCCC">otherwise</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that was good enough so if</font>

1148
00:51:21,559 --> 00:51:25,130
there are<font color="#CCCCCC"> other tools</font><font color="#E5E5E5"> I should</font>

1149
00:51:23,180 --> 00:51:26,808
definitely<font color="#CCCCCC"> look into them but it was</font>

1150
00:51:25,130 --> 00:51:29,420
<font color="#E5E5E5">just the first one I found and it worked</font>

1151
00:51:26,809 --> 00:51:33,109
well<font color="#CCCCCC"> enough for</font><font color="#E5E5E5"> future reference so you</font>

1152
00:51:29,420 --> 00:51:36,049
<font color="#E5E5E5">can feed in the apk tool to get</font><font color="#CCCCCC"> a small</font>

1153
00:51:33,109 --> 00:51:37,609
e<font color="#E5E5E5"> then</font><font color="#CCCCCC"> use Dex</font><font color="#E5E5E5"> to jar to get a jar and</font>

1154
00:51:36,049 --> 00:51:39,799
<font color="#E5E5E5">then you can get from a jar file you can</font>

1155
00:51:37,609 --> 00:51:41,328
use JD<font color="#E5E5E5"> GUI and actually get full Java</font>

1156
00:51:39,799 --> 00:51:43,730
code<font color="#E5E5E5"> although you don't have to write</font>

1157
00:51:41,329 --> 00:51:44,960
<font color="#CCCCCC">your pseudo code you could</font><font color="#E5E5E5"> actually use</font>

1158
00:51:43,730 --> 00:51:46,819
these nobody should just<font color="#E5E5E5"> turn that</font><font color="#CCCCCC"> into</font>

1159
00:51:44,960 --> 00:51:48,950
a<font color="#E5E5E5"> single tool</font><font color="#CCCCCC"> they should</font><font color="#E5E5E5"> just make a</font>

1160
00:51:46,819 --> 00:51:51,920
<font color="#E5E5E5">script you just do that</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it grabs all</font>

1161
00:51:48,950 --> 00:51:53,419
the depths and does it all yeah<font color="#E5E5E5"> but</font>

1162
00:51:51,920 --> 00:51:58,790
still<font color="#CCCCCC"> awesome stuff thank you yeah</font><font color="#E5E5E5"> thank</font>

1163
00:51:53,420 --> 00:51:59,359
you<font color="#E5E5E5"> anything else all right I</font><font color="#CCCCCC"> think</font>

1164
00:51:58,790 --> 00:52:00,980
we're<font color="#E5E5E5"> all set</font>

1165
00:51:59,359 --> 00:52:02,420
<font color="#CCCCCC">I made</font><font color="#E5E5E5"> it in</font><font color="#CCCCCC"> time did you go all</font><font color="#E5E5E5"> right</font>

1166
00:52:00,980 --> 00:52:03,290
thanks guys guys

1167
00:52:02,420 --> 00:52:11,940
[Music]

1168
00:52:03,290 --> 00:52:11,940
[Applause]

