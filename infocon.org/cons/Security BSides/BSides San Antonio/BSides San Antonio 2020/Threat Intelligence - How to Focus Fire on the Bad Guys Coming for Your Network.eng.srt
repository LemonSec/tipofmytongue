1
00:00:00,000 --> 00:00:03,040
[Music]

2
00:00:03,040 --> 00:00:04,000
hello everyone

3
00:00:04,000 --> 00:00:05,759
my name is kyle hubert and today i'll be

4
00:00:05,759 --> 00:00:07,279
talking about threat intelligence

5
00:00:07,279 --> 00:00:09,200
how to focus fire on the bad guys coming

6
00:00:09,200 --> 00:00:10,800
through our network now we do have a lot

7
00:00:10,800 --> 00:00:12,320
of material to get through today

8
00:00:12,320 --> 00:00:13,679
and we do have a demo towards the end of

9
00:00:13,679 --> 00:00:14,960
the presentation so let's just go ahead

10
00:00:14,960 --> 00:00:17,920
and jump right into things

11
00:00:18,640 --> 00:00:21,119
first a little bit about myself i'm an

12
00:00:21,119 --> 00:00:22,880
air force network analyst and blue team

13
00:00:22,880 --> 00:00:23,600
lead

14
00:00:23,600 --> 00:00:24,720
and when i'm not working with threat

15
00:00:24,720 --> 00:00:26,880
intelligence i'm also interested in iot

16
00:00:26,880 --> 00:00:27,599
security

17
00:00:27,599 --> 00:00:30,080
and purple teaming now before i get too

18
00:00:30,080 --> 00:00:31,519
far ahead of myself i do need to say

19
00:00:31,519 --> 00:00:32,800
that none of this

20
00:00:32,800 --> 00:00:34,880
is official policy or official views of

21
00:00:34,880 --> 00:00:37,120
the air force or the dod

22
00:00:37,120 --> 00:00:38,399
these are all personal views and

23
00:00:38,399 --> 00:00:40,160
processes that i've made that i felt

24
00:00:40,160 --> 00:00:41,680
would be beneficial to share

25
00:00:41,680 --> 00:00:44,480
with the greater cyber community so that

26
00:00:44,480 --> 00:00:46,239
being said if you'd like to

27
00:00:46,239 --> 00:00:47,600
see more things that i build by all

28
00:00:47,600 --> 00:00:49,120
means you can follow me on twitter my

29
00:00:49,120 --> 00:00:51,199
handle there is apt-get kubert

30
00:00:51,199 --> 00:00:52,800
and i'm always looking for feedback so

31
00:00:52,800 --> 00:00:54,480
if you have some thoughts on how to

32
00:00:54,480 --> 00:00:56,239
improve either the presentation

33
00:00:56,239 --> 00:00:57,920
or the code that you'll see towards the

34
00:00:57,920 --> 00:00:59,440
end that'd be a good place to get a hold

35
00:00:59,440 --> 00:01:00,559
of me and make those suggestions and i'd

36
00:01:00,559 --> 00:01:02,450
love to hear from you

37
00:01:02,450 --> 00:01:03,920
[Music]

38
00:01:03,920 --> 00:01:05,438
so what to expect about this

39
00:01:05,438 --> 00:01:07,439
presentation well what you are going to

40
00:01:07,439 --> 00:01:08,000
learn

41
00:01:08,000 --> 00:01:10,000
is how to prioritize the techniques that

42
00:01:10,000 --> 00:01:11,119
you want to hunt for

43
00:01:11,119 --> 00:01:13,360
on your particular environment you're

44
00:01:13,360 --> 00:01:14,400
also going to learn

45
00:01:14,400 --> 00:01:16,720
how to focus your defenders on specific

46
00:01:16,720 --> 00:01:17,759
adversaries and

47
00:01:17,759 --> 00:01:20,000
perhaps adversaries that are targeting

48
00:01:20,000 --> 00:01:21,840
your specific organization or

49
00:01:21,840 --> 00:01:23,360
maybe something a little more broad like

50
00:01:23,360 --> 00:01:26,479
organizations in your industry vertical

51
00:01:26,479 --> 00:01:28,720
what you're not going to learn is that

52
00:01:28,720 --> 00:01:30,240
this is some magic bullet

53
00:01:30,240 --> 00:01:31,600
that will always find the bad guy that

54
00:01:31,600 --> 00:01:33,439
will always solve all your problems

55
00:01:33,439 --> 00:01:35,520
you're also not going to learn about any

56
00:01:35,520 --> 00:01:37,200
techniques that you don't have to look

57
00:01:37,200 --> 00:01:38,320
for

58
00:01:38,320 --> 00:01:40,320
in a perfect world you would be able to

59
00:01:40,320 --> 00:01:41,759
look for every threat actor that's out

60
00:01:41,759 --> 00:01:44,000
there in every technique that they use

61
00:01:44,000 --> 00:01:45,200
unfortunately we don't live in a perfect

62
00:01:45,200 --> 00:01:47,759
world and last time i checked i believe

63
00:01:47,759 --> 00:01:49,119
mitre had identified

64
00:01:49,119 --> 00:01:51,280
about 106 different threat actors across

65
00:01:51,280 --> 00:01:52,479
the board

66
00:01:52,479 --> 00:01:54,560
that's a lot of bad guys and telling

67
00:01:54,560 --> 00:01:56,079
your defense team to just

68
00:01:56,079 --> 00:01:59,040
go find evil is a pretty broad ask when

69
00:01:59,040 --> 00:02:00,240
they have to look for

70
00:02:00,240 --> 00:02:03,040
106 different threat actors all with

71
00:02:03,040 --> 00:02:04,880
varying amounts of different techniques

72
00:02:04,880 --> 00:02:07,439
of accomplishing their objectives so

73
00:02:07,439 --> 00:02:08,720
hopefully by the end of this you'll have

74
00:02:08,720 --> 00:02:10,479
a little better idea of how you can

75
00:02:10,479 --> 00:02:12,959
focus your defenders on specific threats

76
00:02:12,959 --> 00:02:14,720
and prioritize so you're not just giving

77
00:02:14,720 --> 00:02:16,080
them a very broad

78
00:02:16,080 --> 00:02:17,050
go find evil

79
00:02:17,050 --> 00:02:19,680
[Music]

80
00:02:19,680 --> 00:02:22,879
so what is threat intelligence well my

81
00:02:22,879 --> 00:02:23,920
working definition

82
00:02:23,920 --> 00:02:26,480
is the application and analysis of

83
00:02:26,480 --> 00:02:27,520
threat information

84
00:02:27,520 --> 00:02:29,680
in order to better inform defenders how

85
00:02:29,680 --> 00:02:31,920
adversaries will accomplish their goals

86
00:02:31,920 --> 00:02:33,360
of course that begs the question what is

87
00:02:33,360 --> 00:02:35,760
threat information that is defined as

88
00:02:35,760 --> 00:02:37,360
any information that can help an

89
00:02:37,360 --> 00:02:38,879
organization identify

90
00:02:38,879 --> 00:02:41,280
assess monitor and respond to cyber

91
00:02:41,280 --> 00:02:42,800
threats

92
00:02:42,800 --> 00:02:44,879
an example of threat information would

93
00:02:44,879 --> 00:02:46,400
be like an i p address

94
00:02:46,400 --> 00:02:47,840
generally these things are more like

95
00:02:47,840 --> 00:02:49,519
atomic indicators things like

96
00:02:49,519 --> 00:02:52,879
ips or hash values these are things that

97
00:02:52,879 --> 00:02:55,120
by themselves are more like data points

98
00:02:55,120 --> 00:02:57,280
and don't really inform defenders of

99
00:02:57,280 --> 00:02:58,640
anything specific

100
00:02:58,640 --> 00:03:01,680
by themselves what you want to do is you

101
00:03:01,680 --> 00:03:02,720
want to start

102
00:03:02,720 --> 00:03:04,800
adding some context around that data

103
00:03:04,800 --> 00:03:06,560
point and then once you start doing that

104
00:03:06,560 --> 00:03:09,280
then you start going from information to

105
00:03:09,280 --> 00:03:11,040
intelligence

106
00:03:11,040 --> 00:03:11,920
and that's where we're kind of getting

107
00:03:11,920 --> 00:03:13,440
into this third bullet here and this is

108
00:03:13,440 --> 00:03:14,560
probably one of the more important

109
00:03:14,560 --> 00:03:16,400
pieces of the presentation so

110
00:03:16,400 --> 00:03:17,840
if you take away nothing else take away

111
00:03:17,840 --> 00:03:21,280
this information becomes intelligence

112
00:03:21,280 --> 00:03:23,280
when it is analyzed and used to inform

113
00:03:23,280 --> 00:03:26,879
defenders of a specific threat

114
00:03:26,879 --> 00:03:28,720
so again going back to our i p address

115
00:03:28,720 --> 00:03:31,120
example what you could do is perhaps

116
00:03:31,120 --> 00:03:32,799
whenever you hand that ip address to

117
00:03:32,799 --> 00:03:33,519
your

118
00:03:33,519 --> 00:03:35,840
network defender you say hey this is a

119
00:03:35,840 --> 00:03:36,959
known bad ip

120
00:03:36,959 --> 00:03:39,360
that's used for exfiltration and this

121
00:03:39,360 --> 00:03:40,879
particular adversary

122
00:03:40,879 --> 00:03:43,440
uses ip address so right there not only

123
00:03:43,440 --> 00:03:44,319
did you tell them

124
00:03:44,319 --> 00:03:46,159
it's a bad ip which okay fine that's a

125
00:03:46,159 --> 00:03:47,840
good start but he also said it's used

126
00:03:47,840 --> 00:03:48,959
for exfiltration

127
00:03:48,959 --> 00:03:50,480
which now tells your analyst that they

128
00:03:50,480 --> 00:03:52,239
should be looking for data going to that

129
00:03:52,239 --> 00:03:53,360
ip

130
00:03:53,360 --> 00:03:54,720
you also said it's associated with a

131
00:03:54,720 --> 00:03:56,720
specific threat actor so now that they

132
00:03:56,720 --> 00:03:57,200
can do

133
00:03:57,200 --> 00:03:58,799
uh they can go and do some research

134
00:03:58,799 --> 00:04:00,319
about that thread actor and see if

135
00:04:00,319 --> 00:04:01,599
there's any other

136
00:04:01,599 --> 00:04:04,400
techniques that they want to research or

137
00:04:04,400 --> 00:04:06,319
maybe hunt for on the environment

138
00:04:06,319 --> 00:04:07,840
and this is where you start going from

139
00:04:07,840 --> 00:04:09,680
the again the information part

140
00:04:09,680 --> 00:04:11,439
to the intelligence part adding that

141
00:04:11,439 --> 00:04:13,360
context and connecting some of those

142
00:04:13,360 --> 00:04:14,560
data points together

143
00:04:14,560 --> 00:04:16,160
as opposed to just giving your analyst

144
00:04:16,160 --> 00:04:18,959
raw information

145
00:04:19,759 --> 00:04:21,040
if we look at this in terms of the

146
00:04:21,040 --> 00:04:23,280
pyramid of pain most times when we're

147
00:04:23,280 --> 00:04:24,800
talking about threat intelligence

148
00:04:24,800 --> 00:04:25,919
we're talking about the lower three

149
00:04:25,919 --> 00:04:28,000
tiers of the pyramid of pain

150
00:04:28,000 --> 00:04:30,240
now to be clear i'm not saying that

151
00:04:30,240 --> 00:04:31,199
threat information

152
00:04:31,199 --> 00:04:34,400
is not useful or not important it is

153
00:04:34,400 --> 00:04:36,000
i'm just trying to show that there is a

154
00:04:36,000 --> 00:04:37,840
very clear line

155
00:04:37,840 --> 00:04:39,440
between what is threat information and

156
00:04:39,440 --> 00:04:41,199
what is threat intelligence

157
00:04:41,199 --> 00:04:43,199
threat information individually doesn't

158
00:04:43,199 --> 00:04:46,080
inform defenders of anything specific

159
00:04:46,080 --> 00:04:48,000
once you start adding that context and

160
00:04:48,000 --> 00:04:49,840
enriching that data and

161
00:04:49,840 --> 00:04:52,400
starting to connect that information

162
00:04:52,400 --> 00:04:53,280
together

163
00:04:53,280 --> 00:04:55,199
then you start getting into the threat

164
00:04:55,199 --> 00:04:57,280
intelligence spaces then you start

165
00:04:57,280 --> 00:04:58,880
being able to inform your defenders of

166
00:04:58,880 --> 00:05:00,720
something specific

167
00:05:00,720 --> 00:05:03,039
again going back to our prip address

168
00:05:03,039 --> 00:05:04,240
example

169
00:05:04,240 --> 00:05:06,560
maybe you are saying that this ip

170
00:05:06,560 --> 00:05:07,520
address

171
00:05:07,520 --> 00:05:09,440
used for exfiltration is part of this

172
00:05:09,440 --> 00:05:10,560
particular

173
00:05:10,560 --> 00:05:12,639
tool set and then they can look that up

174
00:05:12,639 --> 00:05:14,479
or at the very least they have this

175
00:05:14,479 --> 00:05:15,840
technique that they can start doing some

176
00:05:15,840 --> 00:05:17,199
research on and see what's going on

177
00:05:17,199 --> 00:05:18,240
there

178
00:05:18,240 --> 00:05:20,639
so this is where it really starts to

179
00:05:20,639 --> 00:05:21,600
come together and

180
00:05:21,600 --> 00:05:24,160
crossing that line from information to

181
00:05:24,160 --> 00:05:26,080
intelligence

182
00:05:26,080 --> 00:05:27,680
but now that you know uh what threat

183
00:05:27,680 --> 00:05:29,600
intelligence is why would you want to

184
00:05:29,600 --> 00:05:31,360
use something like this

185
00:05:31,360 --> 00:05:34,639
i'm glad you asked so

186
00:05:34,639 --> 00:05:37,440
the why to use threat intelligence this

187
00:05:37,440 --> 00:05:38,720
is where you start getting

188
00:05:38,720 --> 00:05:41,280
those stereotypical sun tzu quotes that

189
00:05:41,280 --> 00:05:42,400
come to mind

190
00:05:42,400 --> 00:05:44,240
but they really do make sense in this

191
00:05:44,240 --> 00:05:45,919
context and really

192
00:05:45,919 --> 00:05:47,919
the why to using threat intelligence

193
00:05:47,919 --> 00:05:49,919
boils down to three main things

194
00:05:49,919 --> 00:05:51,600
you have your understanding

195
00:05:51,600 --> 00:05:54,320
prioritization and efficiency

196
00:05:54,320 --> 00:05:56,639
now what i what i mean by understanding

197
00:05:56,639 --> 00:05:58,319
is that by using threat intelligence

198
00:05:58,319 --> 00:06:00,080
you'll gain a deeper understanding

199
00:06:00,080 --> 00:06:02,479
of adversary tactics and techniques uh

200
00:06:02,479 --> 00:06:04,319
that are targeting your organization

201
00:06:04,319 --> 00:06:06,880
or organizations like your own this is

202
00:06:06,880 --> 00:06:08,479
important because if you have a better

203
00:06:08,479 --> 00:06:09,759
understanding of

204
00:06:09,759 --> 00:06:11,360
how an adversary would accomplish their

205
00:06:11,360 --> 00:06:13,759
goals or how they would carry out

206
00:06:13,759 --> 00:06:15,759
an attack on your organization you have

207
00:06:15,759 --> 00:06:17,520
a much better chance of catching it

208
00:06:17,520 --> 00:06:20,000
and seeing how you could mitigate some

209
00:06:20,000 --> 00:06:22,000
of those actions

210
00:06:22,000 --> 00:06:24,160
this also gets into prioritization

211
00:06:24,160 --> 00:06:26,720
because if you know what to look for

212
00:06:26,720 --> 00:06:28,400
you're going to probably move that up to

213
00:06:28,400 --> 00:06:29,759
the top of the list of what you want to

214
00:06:29,759 --> 00:06:30,960
hunt for and what you want your team to

215
00:06:30,960 --> 00:06:32,400
be looking into

216
00:06:32,400 --> 00:06:34,639
so this is making some of these

217
00:06:34,639 --> 00:06:36,319
techniques and the threat groups that

218
00:06:36,319 --> 00:06:39,360
execute them uh some of your most

219
00:06:39,360 --> 00:06:42,560
likely uh threats to the target which

220
00:06:42,560 --> 00:06:44,080
in this case unfortunately the target is

221
00:06:44,080 --> 00:06:45,600
you they're coming for your

222
00:06:45,600 --> 00:06:47,280
organization and your data and you're

223
00:06:47,280 --> 00:06:48,340
trying to defend against it

224
00:06:48,340 --> 00:06:49,840
[Music]

225
00:06:49,840 --> 00:06:52,000
again going back to what i said before

226
00:06:52,000 --> 00:06:53,440
you don't want to tell your teams just

227
00:06:53,440 --> 00:06:53,759
go

228
00:06:53,759 --> 00:06:55,360
find evil so by using this

229
00:06:55,360 --> 00:06:56,800
prioritization

230
00:06:56,800 --> 00:06:59,039
you can focus them on particular groups

231
00:06:59,039 --> 00:07:00,000
and techniques

232
00:07:00,000 --> 00:07:01,680
that are most likely going to be used

233
00:07:01,680 --> 00:07:04,000
against your organization

234
00:07:04,000 --> 00:07:06,319
and then finally efficiency so let's say

235
00:07:06,319 --> 00:07:08,000
you have identified five

236
00:07:08,000 --> 00:07:09,919
uh groups that are most likely going to

237
00:07:09,919 --> 00:07:11,919
come after your organization

238
00:07:11,919 --> 00:07:14,880
based on prior targets or network

239
00:07:14,880 --> 00:07:16,240
infrastructure whatever

240
00:07:16,240 --> 00:07:19,759
you deem or how you decide that

241
00:07:19,759 --> 00:07:21,599
one there might be some common

242
00:07:21,599 --> 00:07:23,280
techniques between them such as

243
00:07:23,280 --> 00:07:24,479
powershell

244
00:07:24,479 --> 00:07:26,560
so what you could do based on whatever

245
00:07:26,560 --> 00:07:28,400
tools that you have available to you

246
00:07:28,400 --> 00:07:30,479
to your hunt team is you could figure

247
00:07:30,479 --> 00:07:31,440
out how to

248
00:07:31,440 --> 00:07:33,120
write a hunt that would look for

249
00:07:33,120 --> 00:07:35,280
powershell use across all five of those

250
00:07:35,280 --> 00:07:36,319
thread actors

251
00:07:36,319 --> 00:07:38,000
as opposed to doing five individual

252
00:07:38,000 --> 00:07:40,639
hunts one for each thread actor

253
00:07:40,639 --> 00:07:41,919
and this is extremely important

254
00:07:41,919 --> 00:07:44,000
especially when we get into if you have

255
00:07:44,000 --> 00:07:45,599
a smaller team or maybe a compressed

256
00:07:45,599 --> 00:07:47,280
timeline for some reason

257
00:07:47,280 --> 00:07:49,440
being able to increase your efficiency

258
00:07:49,440 --> 00:07:51,599
and figure out how you can do

259
00:07:51,599 --> 00:07:53,280
less hunts to still cover the same

260
00:07:53,280 --> 00:07:54,720
amount of techniques

261
00:07:54,720 --> 00:07:56,560
or the same amount of thread actors

262
00:07:56,560 --> 00:07:58,160
really really helps

263
00:07:58,160 --> 00:08:01,120
in terms of getting through more hunts

264
00:08:01,120 --> 00:08:03,280
and trying to find more bad guys

265
00:08:03,280 --> 00:08:04,570
quickly

266
00:08:04,570 --> 00:08:07,599
[Music]

267
00:08:07,599 --> 00:08:08,960
so now we're going to look at threat

268
00:08:08,960 --> 00:08:10,720
intelligence as a process

269
00:08:10,720 --> 00:08:12,879
and this is a bit of a misconception

270
00:08:12,879 --> 00:08:14,560
because a lot of times when people think

271
00:08:14,560 --> 00:08:15,680
of threat intelligence

272
00:08:15,680 --> 00:08:17,520
they think it uh it's more like a

273
00:08:17,520 --> 00:08:19,280
checklist and they might do this before

274
00:08:19,280 --> 00:08:21,120
the beginning of an operation

275
00:08:21,120 --> 00:08:23,360
or the beginning of the work week and

276
00:08:23,360 --> 00:08:24,319
then they'll just go through the

277
00:08:24,319 --> 00:08:25,759
checklist and say okay they'll check the

278
00:08:25,759 --> 00:08:26,560
boxes

279
00:08:26,560 --> 00:08:28,319
and they'll say yeah we did our threat

280
00:08:28,319 --> 00:08:29,680
intelligence and we're good to go and

281
00:08:29,680 --> 00:08:31,280
they'll never touch it again

282
00:08:31,280 --> 00:08:33,519
that's not how this is supposed to work

283
00:08:33,519 --> 00:08:35,039
this is more of a process

284
00:08:35,039 --> 00:08:37,120
it's something that you should be doing

285
00:08:37,120 --> 00:08:38,479
over and over and over again

286
00:08:38,479 --> 00:08:40,799
and there's a lot of different processes

287
00:08:40,799 --> 00:08:42,080
out there

288
00:08:42,080 --> 00:08:44,159
to kind of show this but the one that i

289
00:08:44,159 --> 00:08:45,920
like the best is the f3

290
00:08:45,920 --> 00:08:48,720
ead model and this is a little bit of a

291
00:08:48,720 --> 00:08:51,200
weird model not many people use it

292
00:08:51,200 --> 00:08:54,720
but the f3 e80 basically stands for

293
00:08:54,720 --> 00:08:57,600
find fix finish exploit analyze and

294
00:08:57,600 --> 00:08:59,040
disseminate

295
00:08:59,040 --> 00:09:01,120
and the reason i like this model so much

296
00:09:01,120 --> 00:09:02,880
is because it does a very good job of

297
00:09:02,880 --> 00:09:03,600
showing how

298
00:09:03,600 --> 00:09:06,720
incident response or the operation side

299
00:09:06,720 --> 00:09:10,399
of security operations can very easily

300
00:09:10,399 --> 00:09:12,080
feed into and support threat

301
00:09:12,080 --> 00:09:13,680
intelligence or the intelligence side of

302
00:09:13,680 --> 00:09:14,640
operations

303
00:09:14,640 --> 00:09:16,320
and how that process can begin again

304
00:09:16,320 --> 00:09:19,600
with intelligence feeding operations

305
00:09:19,600 --> 00:09:21,760
so whenever you start this process

306
00:09:21,760 --> 00:09:22,880
you're most likely going to be

307
00:09:22,880 --> 00:09:25,040
in the find phase and what the find

308
00:09:25,040 --> 00:09:25,920
phase is

309
00:09:25,920 --> 00:09:28,160
as you take you basically are taking

310
00:09:28,160 --> 00:09:29,600
known bad so maybe

311
00:09:29,600 --> 00:09:31,839
white papers that you come across online

312
00:09:31,839 --> 00:09:33,440
perhaps some intelligence that's been

313
00:09:33,440 --> 00:09:34,240
shared between

314
00:09:34,240 --> 00:09:35,920
you and a partner organization or a

315
00:09:35,920 --> 00:09:37,200
threat intelligence group that you're a

316
00:09:37,200 --> 00:09:38,240
part of

317
00:09:38,240 --> 00:09:39,600
and you take that intelligence and you

318
00:09:39,600 --> 00:09:42,399
start looking for it on your network

319
00:09:42,399 --> 00:09:44,720
and perhaps you find something and you

320
00:09:44,720 --> 00:09:46,160
find some bad guys

321
00:09:46,160 --> 00:09:48,160
well at this point you are now in the

322
00:09:48,160 --> 00:09:50,880
fixed stage of the incident response

323
00:09:50,880 --> 00:09:53,360
side of this process and fixed does not

324
00:09:53,360 --> 00:09:55,200
mean you are fixing the problem

325
00:09:55,200 --> 00:09:57,680
that that's a bit of a misconception fix

326
00:09:57,680 --> 00:09:59,600
actually means that you are fixating on

327
00:09:59,600 --> 00:10:00,640
the bad guys

328
00:10:00,640 --> 00:10:02,399
in your network you're scoping the

329
00:10:02,399 --> 00:10:04,240
intrusion this is where you want to

330
00:10:04,240 --> 00:10:05,120
identify

331
00:10:05,120 --> 00:10:06,800
all of the locations where the bad guys

332
00:10:06,800 --> 00:10:08,320
have kind of set up persistence

333
00:10:08,320 --> 00:10:09,920
you want to identify all the malware

334
00:10:09,920 --> 00:10:11,519
that they've dropped on your network

335
00:10:11,519 --> 00:10:12,800
you want to figure out how they're

336
00:10:12,800 --> 00:10:14,560
getting in and out of your network

337
00:10:14,560 --> 00:10:16,079
and this is where you fully scope the

338
00:10:16,079 --> 00:10:18,160
intrusion so that when you do take those

339
00:10:18,160 --> 00:10:19,279
ir actions

340
00:10:19,279 --> 00:10:20,880
you're not leaving anything behind that

341
00:10:20,880 --> 00:10:22,680
the adversary could take advantage of

342
00:10:22,680 --> 00:10:24,079
[Music]

343
00:10:24,079 --> 00:10:25,519
so of course that brings us to the

344
00:10:25,519 --> 00:10:27,120
finish phase and the finish as

345
00:10:27,120 --> 00:10:28,399
the name implies is where you are

346
00:10:28,399 --> 00:10:30,800
finishing off the enemy you are taking

347
00:10:30,800 --> 00:10:33,120
those ir actions to remove any sort of

348
00:10:33,120 --> 00:10:34,800
footholds that they have in the network

349
00:10:34,800 --> 00:10:36,160
and hopefully you're collecting some of

350
00:10:36,160 --> 00:10:38,160
those malware samples and pcap files and

351
00:10:38,160 --> 00:10:39,279
anything else

352
00:10:39,279 --> 00:10:41,040
that could be useful for when you get

353
00:10:41,040 --> 00:10:44,800
into your threat intelligence phase

354
00:10:44,880 --> 00:10:46,800
so at this point we cross over into

355
00:10:46,800 --> 00:10:48,320
threat intelligence and the exploit

356
00:10:48,320 --> 00:10:49,040
phase

357
00:10:49,040 --> 00:10:50,800
and the exploit phase is where you start

358
00:10:50,800 --> 00:10:52,560
collecting all that information so you

359
00:10:52,560 --> 00:10:54,240
take those malware samples you found you

360
00:10:54,240 --> 00:10:56,640
take those pcap files you've captured

361
00:10:56,640 --> 00:10:58,079
and you just want to collect as much

362
00:10:58,079 --> 00:11:00,160
information as possible now again

363
00:11:00,160 --> 00:11:02,320
at this stage this is threat information

364
00:11:02,320 --> 00:11:03,839
this is just raw data

365
00:11:03,839 --> 00:11:05,839
so you just want to collect as much data

366
00:11:05,839 --> 00:11:07,279
as possible at this point

367
00:11:07,279 --> 00:11:09,839
so you can then take that in the analyze

368
00:11:09,839 --> 00:11:13,040
phase and turn it into intelligence

369
00:11:13,040 --> 00:11:16,079
so we're now in the analyze phase and

370
00:11:16,079 --> 00:11:17,600
this is where you're going to take as i

371
00:11:17,600 --> 00:11:19,600
said that threat information and start

372
00:11:19,600 --> 00:11:21,360
analyzing it enriching it

373
00:11:21,360 --> 00:11:23,600
adding some context to those data points

374
00:11:23,600 --> 00:11:25,040
and hopefully at the end of this phase

375
00:11:25,040 --> 00:11:26,720
you should have a pretty good amount of

376
00:11:26,720 --> 00:11:28,000
some threat intelligence

377
00:11:28,000 --> 00:11:30,320
that you can use now this is also the

378
00:11:30,320 --> 00:11:31,360
stage where you would

379
00:11:31,360 --> 00:11:33,040
probably want to start making the attack

380
00:11:33,040 --> 00:11:34,959
timeline you'd want to start looking at

381
00:11:34,959 --> 00:11:36,480
how did the adversary gain initial

382
00:11:36,480 --> 00:11:39,120
access how do they gain persistence

383
00:11:39,120 --> 00:11:40,640
what other actions did they take and

384
00:11:40,640 --> 00:11:42,480
when did they take them and this is when

385
00:11:42,480 --> 00:11:43,839
you want to start building that out as

386
00:11:43,839 --> 00:11:44,480
well

387
00:11:44,480 --> 00:11:47,279
so you have a better idea of how they

388
00:11:47,279 --> 00:11:48,399
progress through your network

389
00:11:48,399 --> 00:11:49,760
up until the point where you took those

390
00:11:49,760 --> 00:11:53,040
ir actions to remove them

391
00:11:53,040 --> 00:11:54,639
and then finally we have the disseminate

392
00:11:54,639 --> 00:11:56,480
phase and this phase

393
00:11:56,480 --> 00:11:57,920
is pretty important because this is

394
00:11:57,920 --> 00:11:59,360
where you share those findings those

395
00:11:59,360 --> 00:12:00,800
awesome white papers you've written all

396
00:12:00,800 --> 00:12:02,000
that threat intelligence that you've

397
00:12:02,000 --> 00:12:02,880
created

398
00:12:02,880 --> 00:12:04,480
and at the very least i would hope that

399
00:12:04,480 --> 00:12:05,360
you would share it with your own

400
00:12:05,360 --> 00:12:06,800
organization

401
00:12:06,800 --> 00:12:09,120
if not maybe your threat intelligence

402
00:12:09,120 --> 00:12:10,480
sharing group or even the

403
00:12:10,480 --> 00:12:12,639
cyber security community at large this

404
00:12:12,639 --> 00:12:14,320
is where you publish those findings

405
00:12:14,320 --> 00:12:16,560
uh you share that with the community and

406
00:12:16,560 --> 00:12:17,839
then hopefully someone can take that

407
00:12:17,839 --> 00:12:19,200
threat intelligence

408
00:12:19,200 --> 00:12:21,440
and then go into their own find pays as

409
00:12:21,440 --> 00:12:24,530
the process begins again

410
00:12:24,530 --> 00:12:27,760
[Music]

411
00:12:27,760 --> 00:12:29,839
now before we go too much farther i do

412
00:12:29,839 --> 00:12:31,120
want to talk a little bit about the

413
00:12:31,120 --> 00:12:32,720
miter attack matrix

414
00:12:32,720 --> 00:12:33,839
because i am going to be referencing

415
00:12:33,839 --> 00:12:35,040
this a good bit throughout the rest of

416
00:12:35,040 --> 00:12:36,639
the presentation

417
00:12:36,639 --> 00:12:39,040
if you're not familiar the mitre attack

418
00:12:39,040 --> 00:12:39,680
matrix

419
00:12:39,680 --> 00:12:41,839
the attack piece stands for adversarial

420
00:12:41,839 --> 00:12:42,959
tactics techniques

421
00:12:42,959 --> 00:12:45,040
and common knowledge and basically this

422
00:12:45,040 --> 00:12:46,399
is something that miters

423
00:12:46,399 --> 00:12:48,880
built out that they try to show every

424
00:12:48,880 --> 00:12:50,000
possible way

425
00:12:50,000 --> 00:12:51,839
that an adversary could accomplish

426
00:12:51,839 --> 00:12:53,440
objectives or

427
00:12:53,440 --> 00:12:55,839
accomplish their tactics on your

428
00:12:55,839 --> 00:12:58,079
organization's environment

429
00:12:58,079 --> 00:12:59,519
and this page in particular we're

430
00:12:59,519 --> 00:13:02,000
looking at is a screenshot of one of the

431
00:13:02,000 --> 00:13:04,399
group pages that they have

432
00:13:04,399 --> 00:13:05,920
the above the associated group

433
00:13:05,920 --> 00:13:07,519
descriptions you would have the group

434
00:13:07,519 --> 00:13:10,000
name in this case it is apt 19

435
00:13:10,000 --> 00:13:12,399
along with a summary of the group you

436
00:13:12,399 --> 00:13:13,519
also have the associated group

437
00:13:13,519 --> 00:13:14,639
descriptions there

438
00:13:14,639 --> 00:13:17,279
or their aliases and then below that you

439
00:13:17,279 --> 00:13:18,639
have the techniques

440
00:13:18,639 --> 00:13:20,480
the techniques used so this is all the

441
00:13:20,480 --> 00:13:22,480
techniques that this particular group

442
00:13:22,480 --> 00:13:24,079
has used in the past

443
00:13:24,079 --> 00:13:25,120
if it's been a while since you've looked

444
00:13:25,120 --> 00:13:26,399
at the miter attack matrix you might

445
00:13:26,399 --> 00:13:27,360
notice a few things that look

446
00:13:27,360 --> 00:13:28,880
differently and namely

447
00:13:28,880 --> 00:13:31,920
the technique ids there recently miter

448
00:13:31,920 --> 00:13:33,440
has switched from

449
00:13:33,440 --> 00:13:36,079
a t and then a four number uh numbering

450
00:13:36,079 --> 00:13:36,560
scheme

451
00:13:36,560 --> 00:13:38,639
to the t the four numbers and then in

452
00:13:38,639 --> 00:13:40,560
some cases if there are sub techniques

453
00:13:40,560 --> 00:13:41,760
to that category

454
00:13:41,760 --> 00:13:43,199
that's where that decimal number will

455
00:13:43,199 --> 00:13:44,320
come into play so that's where you'll

456
00:13:44,320 --> 00:13:46,320
see the decimal zero zero one

457
00:13:46,320 --> 00:13:48,000
zero zero two zero zero three things of

458
00:13:48,000 --> 00:13:49,440
that nature

459
00:13:49,440 --> 00:13:50,959
and this actually caused a little bit of

460
00:13:50,959 --> 00:13:52,639
issues with the demo code

461
00:13:52,639 --> 00:13:54,720
uh but we were able to get that

462
00:13:54,720 --> 00:13:55,920
corrected for you guys so you can

463
00:13:55,920 --> 00:13:57,199
actually see the demo today

464
00:13:57,199 --> 00:13:58,800
um but if it's been a while things might

465
00:13:58,800 --> 00:13:59,760
have looked a little bit different on

466
00:13:59,760 --> 00:14:01,040
the miter attack matrix

467
00:14:01,040 --> 00:14:03,839
than what you pass remember

468
00:14:05,120 --> 00:14:08,079
so what do you need to do threat

469
00:14:08,079 --> 00:14:09,440
intelligence

470
00:14:09,440 --> 00:14:12,399
so this is four big points that you want

471
00:14:12,399 --> 00:14:13,519
to

472
00:14:13,519 --> 00:14:15,440
make sure you have in order to do this

473
00:14:15,440 --> 00:14:16,560
correctly

474
00:14:16,560 --> 00:14:18,320
the first one is a list of your

475
00:14:18,320 --> 00:14:20,240
organization's critical assets

476
00:14:20,240 --> 00:14:23,279
now this is not just your secret source

477
00:14:23,279 --> 00:14:24,480
code or

478
00:14:24,480 --> 00:14:26,320
your super cool app that you built or

479
00:14:26,320 --> 00:14:27,920
maybe the secret recipe to the company

480
00:14:27,920 --> 00:14:29,519
barbecue sauce

481
00:14:29,519 --> 00:14:31,120
those are all important and should be

482
00:14:31,120 --> 00:14:33,360
defended but

483
00:14:33,360 --> 00:14:34,800
you want to look at other things that an

484
00:14:34,800 --> 00:14:36,959
adversary might want

485
00:14:36,959 --> 00:14:39,920
to leverage for example a trusted

486
00:14:39,920 --> 00:14:40,560
relationship

487
00:14:40,560 --> 00:14:43,199
maybe your organization has a secure

488
00:14:43,199 --> 00:14:45,040
pathway or a trusted relationship

489
00:14:45,040 --> 00:14:47,279
with a government entity or another

490
00:14:47,279 --> 00:14:48,800
organization

491
00:14:48,800 --> 00:14:51,600
you want to take a look and see if an

492
00:14:51,600 --> 00:14:53,839
adversary might want to exploit that

493
00:14:53,839 --> 00:14:56,320
trusted relationship to go from your

494
00:14:56,320 --> 00:14:57,519
organization

495
00:14:57,519 --> 00:14:59,279
to the other organization whatever that

496
00:14:59,279 --> 00:15:00,639
looks like it's

497
00:15:00,639 --> 00:15:02,399
they may not be interested in attacking

498
00:15:02,399 --> 00:15:03,760
you just for

499
00:15:03,760 --> 00:15:05,839
the secret sauce that you have they

500
00:15:05,839 --> 00:15:07,600
might just be wanting to

501
00:15:07,600 --> 00:15:09,600
go through your network to hit another

502
00:15:09,600 --> 00:15:11,279
organization

503
00:15:11,279 --> 00:15:13,680
just something to keep in mind so the

504
00:15:13,680 --> 00:15:15,199
second point there is knowledge of

505
00:15:15,199 --> 00:15:17,120
threat intelligence resources now the

506
00:15:17,120 --> 00:15:18,399
good news here is there's a lot of

507
00:15:18,399 --> 00:15:19,839
really good resources out there

508
00:15:19,839 --> 00:15:21,920
that are totally free so you don't need

509
00:15:21,920 --> 00:15:23,839
to go out and spend a lot of money

510
00:15:23,839 --> 00:15:26,160
to start a threat intelligence program

511
00:15:26,160 --> 00:15:27,440
or threat intelligence sell in your

512
00:15:27,440 --> 00:15:28,800
organization

513
00:15:28,800 --> 00:15:30,720
now that being said if you take a look

514
00:15:30,720 --> 00:15:32,560
at the products out there and think that

515
00:15:32,560 --> 00:15:33,839
they would be beneficial and you have

516
00:15:33,839 --> 00:15:35,920
the budget to do so then by all means

517
00:15:35,920 --> 00:15:38,000
go spend money on a threat intelligence

518
00:15:38,000 --> 00:15:40,079
platform but this is simply saying that

519
00:15:40,079 --> 00:15:40,800
you don't

520
00:15:40,800 --> 00:15:44,000
have to do that if you don't want to

521
00:15:44,000 --> 00:15:46,240
now there are some resources out there

522
00:15:46,240 --> 00:15:47,839
that will go over and there is a list of

523
00:15:47,839 --> 00:15:48,880
those resources

524
00:15:48,880 --> 00:15:50,160
towards the end of this presentation

525
00:15:50,160 --> 00:15:52,480
that you'll see but a lot of the white

526
00:15:52,480 --> 00:15:54,480
papers out there the apt

527
00:15:54,480 --> 00:15:56,399
specific reporting there's some very

528
00:15:56,399 --> 00:15:57,839
solid reports out there that

529
00:15:57,839 --> 00:16:00,240
are completely free to the public so

530
00:16:00,240 --> 00:16:00,959
again

531
00:16:00,959 --> 00:16:02,959
just be aware of what's out there and

532
00:16:02,959 --> 00:16:06,000
know what resources you can pull from

533
00:16:06,000 --> 00:16:08,079
the third bullet here is a little bit

534
00:16:08,079 --> 00:16:09,199
more difficult

535
00:16:09,199 --> 00:16:11,519
this is where you have to sit down and

536
00:16:11,519 --> 00:16:12,800
have some very honest

537
00:16:12,800 --> 00:16:15,120
and potentially difficult conversations

538
00:16:15,120 --> 00:16:17,279
to identify what your limits are

539
00:16:17,279 --> 00:16:18,800
and there can be any number of

540
00:16:18,800 --> 00:16:20,959
limitations that might be on you and

541
00:16:20,959 --> 00:16:21,440
your team

542
00:16:21,440 --> 00:16:23,519
it could be budget constraints it could

543
00:16:23,519 --> 00:16:24,959
be manning it could be time

544
00:16:24,959 --> 00:16:26,800
it could be experience and all those

545
00:16:26,800 --> 00:16:28,000
things are totally fine

546
00:16:28,000 --> 00:16:30,160
especially in the experience phase we

547
00:16:30,160 --> 00:16:31,440
all start somewhere so if you don't have

548
00:16:31,440 --> 00:16:33,120
a super experienced team that's totally

549
00:16:33,120 --> 00:16:34,399
okay

550
00:16:34,399 --> 00:16:36,160
just you need to make sure though that

551
00:16:36,160 --> 00:16:38,320
you understand what those limits are

552
00:16:38,320 --> 00:16:40,240
if you have a list of 10 thread actors

553
00:16:40,240 --> 00:16:41,920
but based on

554
00:16:41,920 --> 00:16:43,519
for whatever reason you can only look at

555
00:16:43,519 --> 00:16:45,600
five you need to understand that and you

556
00:16:45,600 --> 00:16:46,720
need to make sure that you're focusing

557
00:16:46,720 --> 00:16:48,959
on maybe those top five threat actors

558
00:16:48,959 --> 00:16:51,279
as opposed to trying to spread yourself

559
00:16:51,279 --> 00:16:52,720
or your team too thin

560
00:16:52,720 --> 00:16:55,279
by trying to look at all ten so just

561
00:16:55,279 --> 00:16:56,639
make sure you have a pretty good handle

562
00:16:56,639 --> 00:16:58,560
on what you can and can't do what is

563
00:16:58,560 --> 00:17:01,519
in the realm of the possible for you and

564
00:17:01,519 --> 00:17:02,720
then finally

565
00:17:02,720 --> 00:17:04,720
you to have a good situational awareness

566
00:17:04,720 --> 00:17:06,000
of world events

567
00:17:06,000 --> 00:17:07,679
now this one's a little unpopular

568
00:17:07,679 --> 00:17:09,039
because again as

569
00:17:09,039 --> 00:17:10,640
tech folks we like being in the bits and

570
00:17:10,640 --> 00:17:12,240
bytes and getting into the weeds the

571
00:17:12,240 --> 00:17:13,520
technical side of things and i totally

572
00:17:13,520 --> 00:17:14,720
get that

573
00:17:14,720 --> 00:17:16,160
but there is something to be said about

574
00:17:16,160 --> 00:17:18,000
keeping an eye on

575
00:17:18,000 --> 00:17:20,000
the situat just what's going on in the

576
00:17:20,000 --> 00:17:21,439
world in general

577
00:17:21,439 --> 00:17:24,079
mostly because there again you have

578
00:17:24,079 --> 00:17:25,679
nation states out there that

579
00:17:25,679 --> 00:17:27,199
some of these groups are suspected to be

580
00:17:27,199 --> 00:17:29,679
connected to and some of those countries

581
00:17:29,679 --> 00:17:31,440
strategic intentions

582
00:17:31,440 --> 00:17:33,679
match up seemingly very closely with

583
00:17:33,679 --> 00:17:35,679
some of the actions these groups take

584
00:17:35,679 --> 00:17:37,919
so knowing what what's going on in the

585
00:17:37,919 --> 00:17:39,280
world and how that might affect your

586
00:17:39,280 --> 00:17:40,640
organization

587
00:17:40,640 --> 00:17:43,520
can be very helpful in identifying the

588
00:17:43,520 --> 00:17:44,880
types of threat actors that might be

589
00:17:44,880 --> 00:17:46,559
coming after your organization

590
00:17:46,559 --> 00:17:48,559
or what their strategic intentions are

591
00:17:48,559 --> 00:17:50,000
and what their goals might be

592
00:17:50,000 --> 00:17:51,919
in terms of what they might be trying to

593
00:17:51,919 --> 00:17:54,240
gain by attacking your organization

594
00:17:54,240 --> 00:17:56,470
or organizations in your industry

595
00:17:56,470 --> 00:17:59,520
[Music]

596
00:17:59,520 --> 00:18:00,960
so just to make sure we're on the same

597
00:18:00,960 --> 00:18:02,080
page here because i know that i've

598
00:18:02,080 --> 00:18:04,080
thrown out tactic and technique a lot

599
00:18:04,080 --> 00:18:06,160
i just want to make sure we we're on the

600
00:18:06,160 --> 00:18:08,400
same page in terms of the terminology

601
00:18:08,400 --> 00:18:11,200
so whenever i say tactic i'm talking

602
00:18:11,200 --> 00:18:11,679
about

603
00:18:11,679 --> 00:18:13,760
the overarching goal or the objective

604
00:18:13,760 --> 00:18:14,799
that

605
00:18:14,799 --> 00:18:17,440
the bad guy is trying to accomplish so

606
00:18:17,440 --> 00:18:19,440
for example a bad guy might try to

607
00:18:19,440 --> 00:18:21,840
establish initial access and then gain

608
00:18:21,840 --> 00:18:23,919
persistence in a particular environment

609
00:18:23,919 --> 00:18:26,960
those are tactics those are big goals

610
00:18:26,960 --> 00:18:29,679
that they're trying to achieve

611
00:18:29,679 --> 00:18:31,440
the way that they accomplish those

612
00:18:31,440 --> 00:18:33,440
tactics is through techniques

613
00:18:33,440 --> 00:18:35,600
so in order to achieve the tactic of

614
00:18:35,600 --> 00:18:36,799
initial access

615
00:18:36,799 --> 00:18:38,880
a bad guy might use the technique of a

616
00:18:38,880 --> 00:18:40,000
spearfishing link

617
00:18:40,000 --> 00:18:41,919
or utilizing that trusted relationship

618
00:18:41,919 --> 00:18:43,679
that we talked about earlier

619
00:18:43,679 --> 00:18:45,520
and then once they've accomplished that

620
00:18:45,520 --> 00:18:47,039
tactic they will try to accomplish the

621
00:18:47,039 --> 00:18:49,520
tactic of persistence perhaps by using

622
00:18:49,520 --> 00:18:51,760
a boot kit as the technique so i just

623
00:18:51,760 --> 00:18:52,960
want to make sure we're clear on what

624
00:18:52,960 --> 00:18:54,400
that actually looks like and what that

625
00:18:54,400 --> 00:18:55,280
means

626
00:18:55,280 --> 00:18:58,480
before we go too much farther

627
00:18:58,799 --> 00:19:00,080
all right so you have all the background

628
00:19:00,080 --> 00:19:02,480
information at this point you know

629
00:19:02,480 --> 00:19:04,799
the the what the why so how do you

630
00:19:04,799 --> 00:19:05,520
actually

631
00:19:05,520 --> 00:19:09,120
use threat intelligence well first

632
00:19:09,120 --> 00:19:10,559
whenever you start off with this you're

633
00:19:10,559 --> 00:19:12,080
going to be in the red section of that

634
00:19:12,080 --> 00:19:12,720
circle

635
00:19:12,720 --> 00:19:14,080
you're going to be looking at all the

636
00:19:14,080 --> 00:19:15,600
bad guys that have ever been identified

637
00:19:15,600 --> 00:19:16,880
that are out there and again

638
00:19:16,880 --> 00:19:20,320
that's a lot we're looking at about 106.

639
00:19:20,320 --> 00:19:22,400
so the first step is who wants your

640
00:19:22,400 --> 00:19:24,559
assets who wants to get your stuff

641
00:19:24,559 --> 00:19:26,720
who wants those crown jewels and

642
00:19:26,720 --> 00:19:28,640
hopefully uh that should take

643
00:19:28,640 --> 00:19:30,960
your list down pretty considerably

644
00:19:30,960 --> 00:19:32,960
depending on what your organizations

645
00:19:32,960 --> 00:19:35,840
is involved in so once you've identified

646
00:19:35,840 --> 00:19:37,520
who wants your stuff

647
00:19:37,520 --> 00:19:39,039
then you want to dig a little bit deeper

648
00:19:39,039 --> 00:19:41,039
into those specific groups

649
00:19:41,039 --> 00:19:43,919
and see if any of those groups have the

650
00:19:43,919 --> 00:19:44,960
capability

651
00:19:44,960 --> 00:19:48,480
to access your assets now

652
00:19:48,480 --> 00:19:49,919
unfortunately if we're talking about

653
00:19:49,919 --> 00:19:51,679
nation state threat actors

654
00:19:51,679 --> 00:19:54,160
then more than likely if they want your

655
00:19:54,160 --> 00:19:55,840
assets or they want your stuff

656
00:19:55,840 --> 00:19:57,760
they can probably get to your stuff and

657
00:19:57,760 --> 00:19:59,360
that's totally okay

658
00:19:59,360 --> 00:20:02,159
this is just to help add another layer

659
00:20:02,159 --> 00:20:02,559
to

660
00:20:02,559 --> 00:20:05,280
again maybe weed out some of those

661
00:20:05,280 --> 00:20:06,880
script kitties or

662
00:20:06,880 --> 00:20:09,360
less funded groups that for whatever

663
00:20:09,360 --> 00:20:11,280
reason you or your organization

664
00:20:11,280 --> 00:20:12,640
just doesn't feel like they're quite a

665
00:20:12,640 --> 00:20:14,159
threat or you just don't want to focus

666
00:20:14,159 --> 00:20:15,200
on them

667
00:20:15,200 --> 00:20:17,840
right at this point in time and then

668
00:20:17,840 --> 00:20:19,679
finally once you identify who has the

669
00:20:19,679 --> 00:20:21,679
capabilities to get to your stuff

670
00:20:21,679 --> 00:20:22,880
then you want to see where those

671
00:20:22,880 --> 00:20:24,720
techniques overlap this is getting back

672
00:20:24,720 --> 00:20:26,559
to what i said before when you identify

673
00:20:26,559 --> 00:20:27,200
that it's

674
00:20:27,200 --> 00:20:29,520
maybe a technique like powershell is

675
00:20:29,520 --> 00:20:30,240
used across

676
00:20:30,240 --> 00:20:31,840
all of the groups that are interested

677
00:20:31,840 --> 00:20:34,559
and can access your assets

678
00:20:34,559 --> 00:20:36,080
well at this point you would want to say

679
00:20:36,080 --> 00:20:37,679
okay well let's figure out what kind of

680
00:20:37,679 --> 00:20:39,039
hunts we can do

681
00:20:39,039 --> 00:20:41,039
that can look for those tech those

682
00:20:41,039 --> 00:20:42,320
shared techniques

683
00:20:42,320 --> 00:20:44,559
as opposed to doing individual hunts for

684
00:20:44,559 --> 00:20:47,280
each of the techniques

685
00:20:47,280 --> 00:20:49,760
so to illustrate this let's walk through

686
00:20:49,760 --> 00:20:51,360
a quick scenario

687
00:20:51,360 --> 00:20:52,880
for this scenario we're going to say

688
00:20:52,880 --> 00:20:54,400
that you're an admin for st

689
00:20:54,400 --> 00:20:56,480
cyber's medical center this is a

690
00:20:56,480 --> 00:20:58,240
hospital that primarily focuses on

691
00:20:58,240 --> 00:21:00,080
patient care but you also have some

692
00:21:00,080 --> 00:21:01,440
research facilities that you need to be

693
00:21:01,440 --> 00:21:02,400
aware of

694
00:21:02,400 --> 00:21:03,570
and make sure that you can protect

695
00:21:03,570 --> 00:21:04,880
[Music]

696
00:21:04,880 --> 00:21:06,720
whenever we start this process

697
00:21:06,720 --> 00:21:08,799
you're going to be in the red you are

698
00:21:08,799 --> 00:21:10,480
looking at all the bad guys that are out

699
00:21:10,480 --> 00:21:11,440
there

700
00:21:11,440 --> 00:21:12,720
and you haven't whittled down that list

701
00:21:12,720 --> 00:21:16,320
yet so let's start doing that

702
00:21:16,320 --> 00:21:17,840
first thing you want to do is start

703
00:21:17,840 --> 00:21:19,760
looking at who's targeted health care

704
00:21:19,760 --> 00:21:22,559
or medical r d in the past now there's a

705
00:21:22,559 --> 00:21:24,400
lot of good resources out there that

706
00:21:24,400 --> 00:21:26,240
can help you with this but the two that

707
00:21:26,240 --> 00:21:27,679
i'm going to highlight here are the m

708
00:21:27,679 --> 00:21:29,360
trends yearly report

709
00:21:29,360 --> 00:21:31,440
this is a report put out every year by

710
00:21:31,440 --> 00:21:33,200
the fireeye corporation

711
00:21:33,200 --> 00:21:36,320
and this is a about the the 2020 report

712
00:21:36,320 --> 00:21:38,080
was about 60 pages

713
00:21:38,080 --> 00:21:40,320
and this will talk about large

714
00:21:40,320 --> 00:21:42,240
overarching trends in cyber security

715
00:21:42,240 --> 00:21:42,960
that

716
00:21:42,960 --> 00:21:44,960
fireeye is expecting to see in the

717
00:21:44,960 --> 00:21:46,000
coming year

718
00:21:46,000 --> 00:21:47,360
one of the findings of that report

719
00:21:47,360 --> 00:21:49,280
actually showed that talking about

720
00:21:49,280 --> 00:21:50,080
ransomware

721
00:21:50,080 --> 00:21:51,760
use was going to go up in 2020 i think

722
00:21:51,760 --> 00:21:53,520
we've all seen that

723
00:21:53,520 --> 00:21:55,840
so that's something you can use to get a

724
00:21:55,840 --> 00:21:56,880
more of a

725
00:21:56,880 --> 00:21:58,960
big picture view of things and then you

726
00:21:58,960 --> 00:22:00,799
can also look at the miter attack matrix

727
00:22:00,799 --> 00:22:01,919
groups

728
00:22:01,919 --> 00:22:04,159
as i said before there's a summary on

729
00:22:04,159 --> 00:22:06,240
those groups so you can actually go back

730
00:22:06,240 --> 00:22:08,080
and read through those summaries

731
00:22:08,080 --> 00:22:10,080
to see if any of those groups have

732
00:22:10,080 --> 00:22:12,240
targeted healthcare in the past

733
00:22:12,240 --> 00:22:13,919
many times those summaries will include

734
00:22:13,919 --> 00:22:15,600
past industries

735
00:22:15,600 --> 00:22:17,760
past countries that they've targeted so

736
00:22:17,760 --> 00:22:19,600
that's a really good place to start

737
00:22:19,600 --> 00:22:22,480
to get a general idea of the different

738
00:22:22,480 --> 00:22:23,679
threat actors that

739
00:22:23,679 --> 00:22:25,360
might be interested either in your

740
00:22:25,360 --> 00:22:26,880
specific organization

741
00:22:26,880 --> 00:22:30,400
or at the very least your sector

742
00:22:30,400 --> 00:22:32,400
so at this point you now are in the

743
00:22:32,400 --> 00:22:34,080
orange you should have a short list of

744
00:22:34,080 --> 00:22:35,039
groups

745
00:22:35,039 --> 00:22:36,640
and then hopefully you can now at this

746
00:22:36,640 --> 00:22:38,320
point start whittling that down

747
00:22:38,320 --> 00:22:40,320
to see if there's anyone in that group

748
00:22:40,320 --> 00:22:42,559
that cannot access your network for

749
00:22:42,559 --> 00:22:44,480
whatever reason

750
00:22:44,480 --> 00:22:46,320
to do this you're going to want to start

751
00:22:46,320 --> 00:22:48,720
looking at the specific techniques that

752
00:22:48,720 --> 00:22:49,280
each

753
00:22:49,280 --> 00:22:52,799
threat actor uses and see

754
00:22:52,799 --> 00:22:54,960
of the ones that want your stuff who can

755
00:22:54,960 --> 00:22:56,080
access your stuff

756
00:22:56,080 --> 00:22:57,360
to do this you're going to have to dig

757
00:22:57,360 --> 00:22:59,840
into some of the apt-specific reporting

758
00:22:59,840 --> 00:23:01,200
again i'm going to go back to fire right

759
00:23:01,200 --> 00:23:03,440
here they have a really good report

760
00:23:03,440 --> 00:23:06,640
on apt-41 apt-41

761
00:23:06,640 --> 00:23:10,000
this report is about a 68 page deep dive

762
00:23:10,000 --> 00:23:11,360
and the reason i really like this

763
00:23:11,360 --> 00:23:13,760
particular report is that it links

764
00:23:13,760 --> 00:23:17,120
the activity of apt 41 back to

765
00:23:17,120 --> 00:23:19,600
china's strategic intentions namely it

766
00:23:19,600 --> 00:23:21,600
references china's five-year plan

767
00:23:21,600 --> 00:23:23,360
it also references that made in china

768
00:23:23,360 --> 00:23:25,039
2025 initiative

769
00:23:25,039 --> 00:23:26,960
which is talking about how china wants

770
00:23:26,960 --> 00:23:28,400
to produce more

771
00:23:28,400 --> 00:23:29,600
higher value products like

772
00:23:29,600 --> 00:23:31,360
pharmaceuticals and getting more

773
00:23:31,360 --> 00:23:33,760
involved in pharmaceutical r d which

774
00:23:33,760 --> 00:23:34,960
is something that you need to be worried

775
00:23:34,960 --> 00:23:36,799
about being an admin for st cyprus

776
00:23:36,799 --> 00:23:38,159
medical center

777
00:23:38,159 --> 00:23:40,480
so this is where again you want to look

778
00:23:40,480 --> 00:23:41,679
into

779
00:23:41,679 --> 00:23:43,360
not only the techniques of these

780
00:23:43,360 --> 00:23:45,520
specific threat actors but maybe some of

781
00:23:45,520 --> 00:23:47,120
their goals and some of the driving

782
00:23:47,120 --> 00:23:49,120
factors behind their operations

783
00:23:49,120 --> 00:23:51,039
going back to that situational awareness

784
00:23:51,039 --> 00:23:52,480
of world events and and why that would

785
00:23:52,480 --> 00:23:54,960
be important here

786
00:23:54,960 --> 00:23:57,679
so at this point uh you have now gotten

787
00:23:57,679 --> 00:23:59,679
all the way down to the blue

788
00:23:59,679 --> 00:24:01,440
you've more than likely most of the

789
00:24:01,440 --> 00:24:03,360
folks that want your stuff can access

790
00:24:03,360 --> 00:24:04,080
your stuff but

791
00:24:04,080 --> 00:24:06,720
again that's okay and now you can start

792
00:24:06,720 --> 00:24:07,440
working on

793
00:24:07,440 --> 00:24:10,799
getting into the green now uh just to

794
00:24:10,799 --> 00:24:12,400
show you uh what those directors look

795
00:24:12,400 --> 00:24:14,159
like from that scenario

796
00:24:14,159 --> 00:24:16,080
again we started with 106 different

797
00:24:16,080 --> 00:24:17,440
thread actors

798
00:24:17,440 --> 00:24:20,159
and we were able to get that down to

799
00:24:20,159 --> 00:24:21,760
eight really nine thread actors

800
00:24:21,760 --> 00:24:23,360
white fly is a new addition that was

801
00:24:23,360 --> 00:24:26,080
just added to uh the miter groups fairly

802
00:24:26,080 --> 00:24:27,440
recently

803
00:24:27,440 --> 00:24:28,640
but if you were looking at all the

804
00:24:28,640 --> 00:24:30,320
thread actors that are targeting

805
00:24:30,320 --> 00:24:31,039
healthcare

806
00:24:31,039 --> 00:24:34,279
you would have apt 18 apt 19

807
00:24:34,279 --> 00:24:37,760
apt41 deep panda fin4

808
00:24:37,760 --> 00:24:40,720
menu pass orange worm tropic trooper and

809
00:24:40,720 --> 00:24:42,159
of course white fly

810
00:24:42,159 --> 00:24:45,440
now we did add apt 19 on there manually

811
00:24:45,440 --> 00:24:46,559
i did that

812
00:24:46,559 --> 00:24:47,919
because if you look at the reporting for

813
00:24:47,919 --> 00:24:49,840
apt 19 specifically

814
00:24:49,840 --> 00:24:51,039
you'll see that while they haven't

815
00:24:51,039 --> 00:24:53,200
targeted uh the healthcare industry

816
00:24:53,200 --> 00:24:54,159
directly

817
00:24:54,159 --> 00:24:56,559
they have shown an interest in r d as

818
00:24:56,559 --> 00:24:57,919
well as pharmaceuticals

819
00:24:57,919 --> 00:24:59,600
so that's where we added them to that

820
00:24:59,600 --> 00:25:01,520
list as well

821
00:25:01,520 --> 00:25:03,600
and then for argument's sake we'll say

822
00:25:03,600 --> 00:25:04,640
that you wrote an

823
00:25:04,640 --> 00:25:07,360
amazing strategic intelligence brief to

824
00:25:07,360 --> 00:25:08,880
your sizzle you looked at the m trans

825
00:25:08,880 --> 00:25:10,080
yoga report and

826
00:25:10,080 --> 00:25:12,000
did a little write up on it and your

827
00:25:12,000 --> 00:25:14,000
sizzo wants you to focus on

828
00:25:14,000 --> 00:25:16,240
suspected chinese threat actors as well

829
00:25:16,240 --> 00:25:18,880
as any actors that utilize ransomware

830
00:25:18,880 --> 00:25:20,559
is kind of their standard operating

831
00:25:20,559 --> 00:25:21,760
procedure when they attack an

832
00:25:21,760 --> 00:25:23,279
organization

833
00:25:23,279 --> 00:25:25,120
using this guidance from your sizzo you

834
00:25:25,120 --> 00:25:27,279
can then whittle those ninth right

835
00:25:27,279 --> 00:25:28,960
actors down to six

836
00:25:28,960 --> 00:25:30,640
you would eliminate orange worm tropic

837
00:25:30,640 --> 00:25:32,960
trooper and white fly from your list

838
00:25:32,960 --> 00:25:35,679
so then finally you would have a short

839
00:25:35,679 --> 00:25:38,000
list of six thread actors

840
00:25:38,000 --> 00:25:40,640
from 106 that you can start looking at

841
00:25:40,640 --> 00:25:41,919
and now see

842
00:25:41,919 --> 00:25:43,840
what common techniques do those six

843
00:25:43,840 --> 00:25:46,080
thread actors share

844
00:25:46,080 --> 00:25:46,960
and this is where we're going to get

845
00:25:46,960 --> 00:25:48,559
into the demo because this code

846
00:25:48,559 --> 00:25:49,279
hopefully

847
00:25:49,279 --> 00:25:50,559
will make this process a little bit

848
00:25:50,559 --> 00:25:52,559
faster for you so let's see what the

849
00:25:52,559 --> 00:25:56,000
demo gods have to say

850
00:25:56,000 --> 00:25:58,000
all right so you can see we got the

851
00:25:58,000 --> 00:25:59,840
script pulled up here ready to go

852
00:25:59,840 --> 00:26:02,159
uh for this python script you will need

853
00:26:02,159 --> 00:26:04,000
python 3.8 installed

854
00:26:04,000 --> 00:26:05,200
so just keep that in mind whenever

855
00:26:05,200 --> 00:26:10,240
you're trying to make the script work

856
00:26:10,240 --> 00:26:12,000
so the very first thing it's going to do

857
00:26:12,000 --> 00:26:13,360
whenever we run the script

858
00:26:13,360 --> 00:26:15,120
is it's going to ask if you want to add

859
00:26:15,120 --> 00:26:17,039
countries in bulk or add

860
00:26:17,039 --> 00:26:19,679
groups in bulk by country excuse me now

861
00:26:19,679 --> 00:26:20,480
in this case

862
00:26:20,480 --> 00:26:22,240
since we're going looking at this in

863
00:26:22,240 --> 00:26:24,480
terms of a sector of industry

864
00:26:24,480 --> 00:26:27,679
we're not really interested in adding or

865
00:26:27,679 --> 00:26:29,760
removing groups by country so we're

866
00:26:29,760 --> 00:26:31,279
going to go ahead and just skip that

867
00:26:31,279 --> 00:26:34,880
by putting in six all right so now we

868
00:26:34,880 --> 00:26:36,480
get to the spot where we can start

869
00:26:36,480 --> 00:26:37,200
adding

870
00:26:37,200 --> 00:26:40,159
groups in bulk by industry sector and

871
00:26:40,159 --> 00:26:42,000
since we are looking at the medical and

872
00:26:42,000 --> 00:26:43,440
health care industry

873
00:26:43,440 --> 00:26:44,880
we're going to go ahead and put in

874
00:26:44,880 --> 00:26:45,700
number eight

875
00:26:45,700 --> 00:26:49,910
[Music]

876
00:26:50,480 --> 00:26:52,880
all right so we've added all the target

877
00:26:52,880 --> 00:26:54,880
or all the groups from the medical

878
00:26:54,880 --> 00:26:56,720
and healthcare industry that's awesome

879
00:26:56,720 --> 00:26:58,240
so now we'll go ahead and do zero

880
00:26:58,240 --> 00:27:01,279
so we don't keep adding groups in bulk

881
00:27:01,279 --> 00:27:01,840
and then

882
00:27:01,840 --> 00:27:04,400
this last step here is where you can

883
00:27:04,400 --> 00:27:06,080
individually add a group so since again

884
00:27:06,080 --> 00:27:08,080
we said we wanted to add

885
00:27:08,080 --> 00:27:10,400
apt 19 because they showed an interest

886
00:27:10,400 --> 00:27:11,840
in r and d

887
00:27:11,840 --> 00:27:13,760
we're going to go ahead and put in apt

888
00:27:13,760 --> 00:27:16,159
19.

889
00:27:16,159 --> 00:27:18,000
all right so that was added and then

890
00:27:18,000 --> 00:27:19,760
type in end

891
00:27:19,760 --> 00:27:22,320
and now you can see this is our almost

892
00:27:22,320 --> 00:27:24,000
final list of the nine thread actors

893
00:27:24,000 --> 00:27:25,840
that we had previously identified

894
00:27:25,840 --> 00:27:29,039
so you can see you have 18 41 deep panda

895
00:27:29,039 --> 00:27:30,320
fin4

896
00:27:30,320 --> 00:27:33,120
menu pass orange worm tropic trooper

897
00:27:33,120 --> 00:27:34,080
white fly

898
00:27:34,080 --> 00:27:37,279
and apt 19. now again we need to remove

899
00:27:37,279 --> 00:27:39,039
the three of those from this list before

900
00:27:39,039 --> 00:27:40,480
we can go any further

901
00:27:40,480 --> 00:27:41,919
so we're going to go ahead and say yes

902
00:27:41,919 --> 00:27:44,480
we would like to remove groups

903
00:27:44,480 --> 00:27:46,080
at this point we would go ahead and just

904
00:27:46,080 --> 00:27:48,000
remove

905
00:27:48,000 --> 00:27:49,190
orange worm

906
00:27:49,190 --> 00:27:52,320
[Music]

907
00:27:52,320 --> 00:27:55,200
and tropic trooper

908
00:27:55,200 --> 00:27:56,399
[Music]

909
00:27:56,399 --> 00:27:59,919
and white fly

910
00:27:59,919 --> 00:28:01,120
alright so we've removed those three

911
00:28:01,120 --> 00:28:03,520
from the list go ahead and type in

912
00:28:03,520 --> 00:28:07,600
end and as you can see we now have

913
00:28:07,600 --> 00:28:10,880
our final list of six thread actors and

914
00:28:10,880 --> 00:28:12,159
this is our short list that we want to

915
00:28:12,159 --> 00:28:13,200
start looking at

916
00:28:13,200 --> 00:28:14,960
and seeing what techniques do all six of

917
00:28:14,960 --> 00:28:16,320
these threat actors share amongst

918
00:28:16,320 --> 00:28:18,240
themselves

919
00:28:18,240 --> 00:28:20,240
so the next step here is you want to put

920
00:28:20,240 --> 00:28:22,480
in a minimum number of groups

921
00:28:22,480 --> 00:28:24,000
that share a technique so for example if

922
00:28:24,000 --> 00:28:25,600
you were to put in three

923
00:28:25,600 --> 00:28:27,760
then you would see all of the techniques

924
00:28:27,760 --> 00:28:29,600
that are shared between

925
00:28:29,600 --> 00:28:31,679
three or more of the groups that you've

926
00:28:31,679 --> 00:28:32,960
selected

927
00:28:32,960 --> 00:28:34,559
for in this case we're going to go ahead

928
00:28:34,559 --> 00:28:37,260
and just use four just as an example

929
00:28:37,260 --> 00:28:40,400
[Music]

930
00:28:40,960 --> 00:28:43,919
all right so you can see that we have a

931
00:28:43,919 --> 00:28:44,799
total

932
00:28:44,799 --> 00:28:48,080
number of six groups selected and here

933
00:28:48,080 --> 00:28:49,600
it's kind of interesting you can see

934
00:28:49,600 --> 00:28:50,080
that

935
00:28:50,080 --> 00:28:52,880
the total unique techniques between just

936
00:28:52,880 --> 00:28:54,399
those six thread actors

937
00:28:54,399 --> 00:28:56,799
is still 90 different techniques so that

938
00:28:56,799 --> 00:28:57,520
means that

939
00:28:57,520 --> 00:28:58,880
even if you would have whittled it down

940
00:28:58,880 --> 00:29:00,799
to just six threat actors

941
00:29:00,799 --> 00:29:02,960
and then told your hunt team to just go

942
00:29:02,960 --> 00:29:04,880
look for every technique that those six

943
00:29:04,880 --> 00:29:06,559
threat actors use

944
00:29:06,559 --> 00:29:08,240
you would still be looking at about 90

945
00:29:08,240 --> 00:29:10,080
different hunts that they would have to

946
00:29:10,080 --> 00:29:11,440
go and do

947
00:29:11,440 --> 00:29:13,440
to look for every technique that all of

948
00:29:13,440 --> 00:29:14,799
those threat actors use

949
00:29:14,799 --> 00:29:16,320
that's still a pretty big ass depending

950
00:29:16,320 --> 00:29:19,440
on the size and experience of your team

951
00:29:19,440 --> 00:29:21,440
so the next couple lines here actually

952
00:29:21,440 --> 00:29:23,679
show the

953
00:29:23,679 --> 00:29:25,679
techniques themselves so you can see we

954
00:29:25,679 --> 00:29:27,440
have obfuscated files

955
00:29:27,440 --> 00:29:30,960
or information web protocols

956
00:29:30,960 --> 00:29:34,799
valid accounts spear phishing attachment

957
00:29:34,799 --> 00:29:37,520
and our favorite power shell you can

958
00:29:37,520 --> 00:29:39,520
also see that all of these are shared

959
00:29:39,520 --> 00:29:40,559
between

960
00:29:40,559 --> 00:29:43,200
uh four out of the six adversary groups

961
00:29:43,200 --> 00:29:45,760
that we've identified

962
00:29:45,760 --> 00:29:47,919
so now you have your short list of

963
00:29:47,919 --> 00:29:49,520
techniques that you can

964
00:29:49,520 --> 00:29:51,440
hand off to your hunt team but let's go

965
00:29:51,440 --> 00:29:53,039
a step further because

966
00:29:53,039 --> 00:29:55,679
telling your hunt team what techniques

967
00:29:55,679 --> 00:29:57,039
to hunt for

968
00:29:57,039 --> 00:29:58,480
doesn't help a whole lot if they don't

969
00:29:58,480 --> 00:29:59,840
have the right data sources and if

970
00:29:59,840 --> 00:30:01,760
they're not ingesting the right data

971
00:30:01,760 --> 00:30:04,240
to actually potentially find bad guys

972
00:30:04,240 --> 00:30:05,760
using those techniques

973
00:30:05,760 --> 00:30:07,120
so this next step here will help you

974
00:30:07,120 --> 00:30:09,120
identify what data sources you need

975
00:30:09,120 --> 00:30:11,279
in order to start hunting for some of

976
00:30:11,279 --> 00:30:12,960
these things

977
00:30:12,960 --> 00:30:14,640
so what we're going to do is we're going

978
00:30:14,640 --> 00:30:17,840
to go ahead and do number one first

979
00:30:17,840 --> 00:30:20,320
and what this is going to show you is

980
00:30:20,320 --> 00:30:21,200
the

981
00:30:21,200 --> 00:30:23,200
basically it's going to list out all of

982
00:30:23,200 --> 00:30:24,960
the data sources

983
00:30:24,960 --> 00:30:26,480
that you can use to find these

984
00:30:26,480 --> 00:30:28,399
techniques and it's going to tell you

985
00:30:28,399 --> 00:30:29,279
how many

986
00:30:29,279 --> 00:30:31,840
techniques a single data source can

987
00:30:31,840 --> 00:30:32,800
capture

988
00:30:32,800 --> 00:30:34,640
[Music]

989
00:30:34,640 --> 00:30:36,880
now there's a lot of text there i

990
00:30:36,880 --> 00:30:38,480
understand that we'll just step through

991
00:30:38,480 --> 00:30:39,440
it

992
00:30:39,440 --> 00:30:42,159
this is not ideal unfortunately in a

993
00:30:42,159 --> 00:30:43,600
perfect world what you'd like

994
00:30:43,600 --> 00:30:45,919
is maybe a couple different data sources

995
00:30:45,919 --> 00:30:47,120
that could potentially find

996
00:30:47,120 --> 00:30:48,399
all of those techniques that you've

997
00:30:48,399 --> 00:30:50,320
identified unfortunately in this case

998
00:30:50,320 --> 00:30:50,960
that's

999
00:30:50,960 --> 00:30:52,960
not going to happen here but you can see

1000
00:30:52,960 --> 00:30:54,799
that the process monitoring

1001
00:30:54,799 --> 00:30:57,600
can catch about four out of the five

1002
00:30:57,600 --> 00:30:58,960
shared techniques

1003
00:30:58,960 --> 00:31:01,200
you have file monitoring can potentially

1004
00:31:01,200 --> 00:31:02,080
catch

1005
00:31:02,080 --> 00:31:03,360
three out of those five techniques if

1006
00:31:03,360 --> 00:31:05,279
you have a way of capturing that

1007
00:31:05,279 --> 00:31:07,200
data source but then once we start

1008
00:31:07,200 --> 00:31:09,039
getting down to the process command line

1009
00:31:09,039 --> 00:31:10,799
parameters and below

1010
00:31:10,799 --> 00:31:12,480
you can see that these data sources can

1011
00:31:12,480 --> 00:31:14,720
only potentially catch two out of five

1012
00:31:14,720 --> 00:31:17,279
or even one out of five uh techniques

1013
00:31:17,279 --> 00:31:18,640
that we've identified

1014
00:31:18,640 --> 00:31:20,640
and that's not as useful as you would

1015
00:31:20,640 --> 00:31:22,000
like so

1016
00:31:22,000 --> 00:31:24,480
let's go ahead and do number two and see

1017
00:31:24,480 --> 00:31:27,760
if that gives us some better output

1018
00:31:28,799 --> 00:31:30,880
and this looks a little bit better so

1019
00:31:30,880 --> 00:31:32,000
basically what's going on

1020
00:31:32,000 --> 00:31:35,120
here is instead of showing

1021
00:31:35,120 --> 00:31:37,919
the data sources and the total number of

1022
00:31:37,919 --> 00:31:39,679
techniques that they can identify

1023
00:31:39,679 --> 00:31:41,840
or instead looking at it in terms of the

1024
00:31:41,840 --> 00:31:44,080
five techniques that we've

1025
00:31:44,080 --> 00:31:45,360
shown to be the ones that are shared

1026
00:31:45,360 --> 00:31:47,360
across all of our threat actors

1027
00:31:47,360 --> 00:31:48,720
so if you want to look for that

1028
00:31:48,720 --> 00:31:51,200
obfuscated files or information

1029
00:31:51,200 --> 00:31:53,279
you can use any one of these data

1030
00:31:53,279 --> 00:31:54,480
sources

1031
00:31:54,480 --> 00:31:57,760
preferably more if you can but these are

1032
00:31:57,760 --> 00:31:59,120
all of the data sources you could

1033
00:31:59,120 --> 00:32:00,559
capture potentially

1034
00:32:00,559 --> 00:32:03,360
to find obfuscated files or information

1035
00:32:03,360 --> 00:32:05,760
if you wanted to catch web protocols

1036
00:32:05,760 --> 00:32:08,000
you could you could capture any one of

1037
00:32:08,000 --> 00:32:08,799
those

1038
00:32:08,799 --> 00:32:11,600
data sources to potentially catch an

1039
00:32:11,600 --> 00:32:13,919
adversary use of web protocols and so on

1040
00:32:13,919 --> 00:32:15,840
and so forth down the list

1041
00:32:15,840 --> 00:32:18,000
and this just is i wanted to add this in

1042
00:32:18,000 --> 00:32:22,000
here in case we had some of the

1043
00:32:22,640 --> 00:32:25,120
output that was a little harder to read

1044
00:32:25,120 --> 00:32:26,640
and had a bunch of different data

1045
00:32:26,640 --> 00:32:28,080
sources that maybe only could catch

1046
00:32:28,080 --> 00:32:31,679
one two three data sources and

1047
00:32:31,679 --> 00:32:34,080
you just wanted to very quickly identify

1048
00:32:34,080 --> 00:32:35,679
what data sources you need

1049
00:32:35,679 --> 00:32:37,039
for these specific techniques that

1050
00:32:37,039 --> 00:32:38,020
you've already found

1051
00:32:38,020 --> 00:32:39,760
[Music]

1052
00:32:39,760 --> 00:32:41,760
now this basically runs through a switch

1053
00:32:41,760 --> 00:32:43,279
statement so you can go back and forth

1054
00:32:43,279 --> 00:32:44,799
between option one and option two if

1055
00:32:44,799 --> 00:32:45,600
you'd like

1056
00:32:45,600 --> 00:32:47,039
i know there's a lot of text there so if

1057
00:32:47,039 --> 00:32:48,799
you need to take notes or

1058
00:32:48,799 --> 00:32:50,640
anything else and then whenever you're

1059
00:32:50,640 --> 00:32:52,320
done you can go ahead

1060
00:32:52,320 --> 00:32:55,039
and press number three and that will

1061
00:32:55,039 --> 00:32:56,850
exit out of the script

1062
00:32:56,850 --> 00:32:59,279
[Music]

1063
00:32:59,279 --> 00:33:00,799
all right so demo god's worked with us

1064
00:33:00,799 --> 00:33:03,519
today that's awesome

1065
00:33:03,519 --> 00:33:05,840
so at this point let's see what we

1066
00:33:05,840 --> 00:33:07,039
accomplished

1067
00:33:07,039 --> 00:33:09,679
through that demo and through that code

1068
00:33:09,679 --> 00:33:11,519
so you can see that we started with a

1069
00:33:11,519 --> 00:33:13,760
hundred and six different threat groups

1070
00:33:13,760 --> 00:33:16,960
now we also from that 106 focused on

1071
00:33:16,960 --> 00:33:20,240
our six most likely attackers

1072
00:33:20,240 --> 00:33:22,559
and then from that group of six threat

1073
00:33:22,559 --> 00:33:23,360
actors

1074
00:33:23,360 --> 00:33:25,519
we still had 90 different unique

1075
00:33:25,519 --> 00:33:27,679
techniques we would have had to look for

1076
00:33:27,679 --> 00:33:30,799
so using the

1077
00:33:30,799 --> 00:33:33,519
ttp aggregator script there we were able

1078
00:33:33,519 --> 00:33:34,880
to boil that down to five

1079
00:33:34,880 --> 00:33:36,480
specific techniques we wanted to look

1080
00:33:36,480 --> 00:33:38,399
for that we can then hand off to the

1081
00:33:38,399 --> 00:33:39,519
hunt team

1082
00:33:39,519 --> 00:33:41,360
and also the data sources we need to

1083
00:33:41,360 --> 00:33:43,279
capture in order for them to carry out

1084
00:33:43,279 --> 00:33:44,160
those hunts

1085
00:33:44,160 --> 00:33:45,279
[Music]

1086
00:33:45,279 --> 00:33:47,039
so at this point you are now in the

1087
00:33:47,039 --> 00:33:48,640
green you've identified all the

1088
00:33:48,640 --> 00:33:50,399
techniques you found with the overlap

1089
00:33:50,399 --> 00:33:52,960
and you can send your team off with

1090
00:33:52,960 --> 00:33:53,519
hopefully

1091
00:33:53,519 --> 00:33:55,840
a very realistic expectation of what

1092
00:33:55,840 --> 00:33:56,620
they can hunt for

1093
00:33:56,620 --> 00:33:58,640
[Music]

1094
00:33:58,640 --> 00:34:00,640
so just doing a quick review here what

1095
00:34:00,640 --> 00:34:02,559
did we really cover

1096
00:34:02,559 --> 00:34:04,840
first threat information is not threat

1097
00:34:04,840 --> 00:34:06,720
intelligence uh

1098
00:34:06,720 --> 00:34:09,040
it is still useful it is still important

1099
00:34:09,040 --> 00:34:10,639
but information does not equal

1100
00:34:10,639 --> 00:34:12,159
intelligence and that's a key takeaway

1101
00:34:12,159 --> 00:34:13,199
here

1102
00:34:13,199 --> 00:34:14,399
you also want to keep in mind that

1103
00:34:14,399 --> 00:34:16,399
threat intelligence is a process this is

1104
00:34:16,399 --> 00:34:17,440
not something that's

1105
00:34:17,440 --> 00:34:18,960
one and done this is not something you

1106
00:34:18,960 --> 00:34:21,199
just do as a checklist and then

1107
00:34:21,199 --> 00:34:23,440
say you never have to touch it again

1108
00:34:23,440 --> 00:34:24,639
this should be something

1109
00:34:24,639 --> 00:34:27,199
that you're doing on a regular basis and

1110
00:34:27,199 --> 00:34:28,560
really in a perfect world

1111
00:34:28,560 --> 00:34:30,639
your incident response folks should be

1112
00:34:30,639 --> 00:34:32,000
taking what they learn

1113
00:34:32,000 --> 00:34:32,960
and then feeding that into your

1114
00:34:32,960 --> 00:34:34,639
intelligence process and then your

1115
00:34:34,639 --> 00:34:36,159
intelligence folks should share what

1116
00:34:36,159 --> 00:34:37,199
they've learned and what they've

1117
00:34:37,199 --> 00:34:38,159
analyzed

1118
00:34:38,159 --> 00:34:39,918
and share that with your ir team and

1119
00:34:39,918 --> 00:34:41,440
then again that just that

1120
00:34:41,440 --> 00:34:43,440
feedback that positive feedback loop

1121
00:34:43,440 --> 00:34:44,800
really uh helps

1122
00:34:44,800 --> 00:34:47,520
make everybody better and then finally

1123
00:34:47,520 --> 00:34:48,800
you want to be willing to consider

1124
00:34:48,800 --> 00:34:50,399
non-technical sources

1125
00:34:50,399 --> 00:34:52,960
again i understand that as a lot of tech

1126
00:34:52,960 --> 00:34:54,639
folks we want to get into the

1127
00:34:54,639 --> 00:34:57,440
nitty-gritty of things but we cannot

1128
00:34:57,440 --> 00:34:59,119
discount how important

1129
00:34:59,119 --> 00:35:02,800
some of these softer documents can be

1130
00:35:02,800 --> 00:35:04,320
and especially in terms of keeping an

1131
00:35:04,320 --> 00:35:05,920
eye on what's going on in the world

1132
00:35:05,920 --> 00:35:07,760
uh some of the long-term goals of

1133
00:35:07,760 --> 00:35:09,760
certain nation-states and certain groups

1134
00:35:09,760 --> 00:35:11,359
that are suspected to be tied to

1135
00:35:11,359 --> 00:35:14,480
those nation-states you want to try to

1136
00:35:14,480 --> 00:35:14,960
keep

1137
00:35:14,960 --> 00:35:18,079
a broad world view so you can see

1138
00:35:18,079 --> 00:35:19,760
exactly what's going on in the world

1139
00:35:19,760 --> 00:35:21,280
and how that could potentially impact

1140
00:35:21,280 --> 00:35:22,880
your organization or

1141
00:35:22,880 --> 00:35:26,800
other organizations in your industry

1142
00:35:26,880 --> 00:35:28,400
i also want to take a second just to

1143
00:35:28,400 --> 00:35:30,640
thank a few folks the dr pinky

1144
00:35:30,640 --> 00:35:33,200
and stack frames these two folks did a

1145
00:35:33,200 --> 00:35:33,920
really

1146
00:35:33,920 --> 00:35:35,200
great job helping me out on

1147
00:35:35,200 --> 00:35:37,040
troubleshooting some of the code in the

1148
00:35:37,040 --> 00:35:38,560
demo you just saw

1149
00:35:38,560 --> 00:35:40,560
as i said earlier right before the

1150
00:35:40,560 --> 00:35:41,680
presentation

1151
00:35:41,680 --> 00:35:44,560
miter changed how they did the matrix

1152
00:35:44,560 --> 00:35:45,839
and they changed how they outlaid some

1153
00:35:45,839 --> 00:35:46,640
of the

1154
00:35:46,640 --> 00:35:48,880
ttps they also changed their back end

1155
00:35:48,880 --> 00:35:50,400
api code a bit

1156
00:35:50,400 --> 00:35:51,920
and that really threw a lot of things

1157
00:35:51,920 --> 00:35:53,920
off in the demo code itself

1158
00:35:53,920 --> 00:35:55,520
so these two really stepped up and

1159
00:35:55,520 --> 00:35:56,880
helped me out in troubleshooting and

1160
00:35:56,880 --> 00:35:58,320
finding some of those bugs and fixing

1161
00:35:58,320 --> 00:35:58,960
them

1162
00:35:58,960 --> 00:36:00,480
so we could give you guys an outstanding

1163
00:36:00,480 --> 00:36:02,320
demo uh without having to try to walk

1164
00:36:02,320 --> 00:36:04,160
through a tabletop the entire time

1165
00:36:04,160 --> 00:36:07,359
so really big thanks to to these two and

1166
00:36:07,359 --> 00:36:09,170
helping squash some of those bugs in

1167
00:36:09,170 --> 00:36:10,839
[Music]

1168
00:36:10,839 --> 00:36:12,880
time

1169
00:36:12,880 --> 00:36:14,560
now this is the list of resources that

1170
00:36:14,560 --> 00:36:16,079
i've kind of been talking about

1171
00:36:16,079 --> 00:36:17,760
throughout the presentation

1172
00:36:17,760 --> 00:36:19,920
the awesome threat intelligence list of

1173
00:36:19,920 --> 00:36:20,880
resources

1174
00:36:20,880 --> 00:36:23,040
this is on github and this is basically

1175
00:36:23,040 --> 00:36:24,480
just a really big list

1176
00:36:24,480 --> 00:36:26,000
of different threat intelligence things

1177
00:36:26,000 --> 00:36:27,839
out there that if you don't know where

1178
00:36:27,839 --> 00:36:29,280
else to go to start

1179
00:36:29,280 --> 00:36:32,160
that's a good place to go you also have

1180
00:36:32,160 --> 00:36:33,040
the nsi

1181
00:36:33,040 --> 00:36:35,520
the national security innovations group

1182
00:36:35,520 --> 00:36:37,440
they publish strategic multi-layer

1183
00:36:37,440 --> 00:36:39,680
assessments or sma papers

1184
00:36:39,680 --> 00:36:40,720
and these are pretty beefy they're

1185
00:36:40,720 --> 00:36:42,720
usually above 100 pages

1186
00:36:42,720 --> 00:36:44,640
i put these the types of documents that

1187
00:36:44,640 --> 00:36:46,320
can give you a pretty good idea

1188
00:36:46,320 --> 00:36:48,320
of the strategic intentions of different

1189
00:36:48,320 --> 00:36:49,359
nation states

1190
00:36:49,359 --> 00:36:50,880
and what might be deriving some of their

1191
00:36:50,880 --> 00:36:52,800
decision making processes

1192
00:36:52,800 --> 00:36:54,000
so i would recommend maybe checking

1193
00:36:54,000 --> 00:36:55,839
those out if you have some folks that

1194
00:36:55,839 --> 00:36:58,079
like reading those sorts of things of

1195
00:36:58,079 --> 00:36:59,920
course we have the m trends 2020 report

1196
00:36:59,920 --> 00:37:02,079
as well as the apt-401 report that i

1197
00:37:02,079 --> 00:37:03,119
talked about

1198
00:37:03,119 --> 00:37:04,560
the miter attack matrix which i've

1199
00:37:04,560 --> 00:37:06,400
already talked about a couple times

1200
00:37:06,400 --> 00:37:07,680
and then finally we also have

1201
00:37:07,680 --> 00:37:09,839
intelligence driven network defense

1202
00:37:09,839 --> 00:37:12,960
by lockheed and this is a paper put out

1203
00:37:12,960 --> 00:37:15,680
by lockheed martin talking about uh the

1204
00:37:15,680 --> 00:37:17,440
cyber kill chain

1205
00:37:17,440 --> 00:37:19,200
um but it's still a good report to kind

1206
00:37:19,200 --> 00:37:20,800
of familiarize yourself with

1207
00:37:20,800 --> 00:37:22,720
uh and just see what they're talking

1208
00:37:22,720 --> 00:37:23,920
about and how you might be able to tie

1209
00:37:23,920 --> 00:37:25,359
that into your organization

1210
00:37:25,359 --> 00:37:27,040
uh specifically when you're trying to

1211
00:37:27,040 --> 00:37:28,400
write up the

1212
00:37:28,400 --> 00:37:31,599
uh attack cycle that an adversary

1213
00:37:31,599 --> 00:37:33,200
took in your network and whenever you're

1214
00:37:33,200 --> 00:37:34,800
trying to write that up for your

1215
00:37:34,800 --> 00:37:37,440
ir report or maybe handing that off to

1216
00:37:37,440 --> 00:37:39,599
your threat intelligence folks

1217
00:37:39,599 --> 00:37:41,359
and then finally we have intelligence

1218
00:37:41,359 --> 00:37:42,880
for an incident response

1219
00:37:42,880 --> 00:37:44,240
i know this is an o'reilly publishing

1220
00:37:44,240 --> 00:37:45,920
book last time i checked this was about

1221
00:37:45,920 --> 00:37:47,280
60 dollars

1222
00:37:47,280 --> 00:37:49,680
but this is a really good book that

1223
00:37:49,680 --> 00:37:50,880
would really be the only thing you

1224
00:37:50,880 --> 00:37:51,839
really have to pay for

1225
00:37:51,839 --> 00:37:53,680
in this list to get started in threat

1226
00:37:53,680 --> 00:37:55,200
intelligence

1227
00:37:55,200 --> 00:37:57,599
this book also walks through that f3 ead

1228
00:37:57,599 --> 00:37:58,880
cycle some more and a little more in

1229
00:37:58,880 --> 00:38:00,000
depth

1230
00:38:00,000 --> 00:38:01,440
and it's a really really good resource i

1231
00:38:01,440 --> 00:38:03,040
would recommend picking up

1232
00:38:03,040 --> 00:38:04,560
if you want to dive into this threat

1233
00:38:04,560 --> 00:38:06,720
intelligence and this process

1234
00:38:06,720 --> 00:38:07,839
a little bit deeper than what we were

1235
00:38:07,839 --> 00:38:10,799
able to talk about today

1236
00:38:10,960 --> 00:38:12,960
so with that that's all that i have for

1237
00:38:12,960 --> 00:38:14,560
you guys today thank you for

1238
00:38:14,560 --> 00:38:15,760
listening to my presentation i do

1239
00:38:15,760 --> 00:38:17,760
appreciate it if you want to reach out

1240
00:38:17,760 --> 00:38:19,680
with any questions or comments by all

1241
00:38:19,680 --> 00:38:21,119
means you can hit me up on twitter

1242
00:38:21,119 --> 00:38:22,320
that's my handle again

1243
00:38:22,320 --> 00:38:25,680
apt getcubert you can also find all the

1244
00:38:25,680 --> 00:38:27,599
not only the demo code but the slides as

1245
00:38:27,599 --> 00:38:29,440
well as well as some

1246
00:38:29,440 --> 00:38:31,520
spreadsheets that i've published to work

1247
00:38:31,520 --> 00:38:32,880
with the

1248
00:38:32,880 --> 00:38:35,200
code itself that's all my git lab there

1249
00:38:35,200 --> 00:38:36,640
that you can find and just

1250
00:38:36,640 --> 00:38:39,200
use it as as much as you want and then

1251
00:38:39,200 --> 00:38:40,640
finally also my linkedin there so if you

1252
00:38:40,640 --> 00:38:42,320
want to send me a request on linkedin or

1253
00:38:42,320 --> 00:38:43,359
a message there

1254
00:38:43,359 --> 00:38:45,920
by all means you can you can do that if

1255
00:38:45,920 --> 00:38:47,280
you'd so choose

1256
00:38:47,280 --> 00:38:49,280
but yeah that's that's all i have and

1257
00:38:49,280 --> 00:38:50,880
hope you guys learned something and

1258
00:38:50,880 --> 00:38:52,079
like i said if you have any feedback

1259
00:38:52,079 --> 00:39:01,839
please let me know thank you

1260
00:39:27,760 --> 00:39:29,839
you

