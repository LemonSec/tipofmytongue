1
00:00:01,680 --> 00:00:03,280
this talk is going to be on

2
00:00:03,280 --> 00:00:06,720
red team operations it's about overt

3
00:00:06,720 --> 00:00:08,320
operations specifically

4
00:00:08,320 --> 00:00:10,480
so when we talk about red team

5
00:00:10,480 --> 00:00:12,639
operations the traditional context in

6
00:00:12,639 --> 00:00:13,920
which we think about these kind of

7
00:00:13,920 --> 00:00:14,559
things

8
00:00:14,559 --> 00:00:17,440
is that we want to not be caught right

9
00:00:17,440 --> 00:00:19,119
and so what this talk is going to do is

10
00:00:19,119 --> 00:00:20,000
we're going to get a

11
00:00:20,000 --> 00:00:22,880
bit of a deep dive into red teaming but

12
00:00:22,880 --> 00:00:23,920
a specifically

13
00:00:23,920 --> 00:00:26,240
alternative strategy for red teaming

14
00:00:26,240 --> 00:00:27,439
because what i'm seeing with a lot of

15
00:00:27,439 --> 00:00:28,640
red teamers right now

16
00:00:28,640 --> 00:00:30,560
is that we have a decent number of

17
00:00:30,560 --> 00:00:32,880
hurdles and challenges to overcome

18
00:00:32,880 --> 00:00:35,040
because blue team defenses have gotten

19
00:00:35,040 --> 00:00:36,160
so much stronger

20
00:00:36,160 --> 00:00:38,239
over the past several years and as a

21
00:00:38,239 --> 00:00:40,879
result we've seen an explosion in red

22
00:00:40,879 --> 00:00:42,719
team tools and tactics

23
00:00:42,719 --> 00:00:46,000
and also some rethinking of um

24
00:00:46,000 --> 00:00:48,399
methodology that we maybe haven't uh

25
00:00:48,399 --> 00:00:49,840
utilized or leveraged in the past so

26
00:00:49,840 --> 00:00:50,800
we're going to have a little bit of an

27
00:00:50,800 --> 00:00:51,440
overt

28
00:00:51,440 --> 00:00:54,800
versus covert discussion here so first

29
00:00:54,800 --> 00:00:55,760
off who am i

30
00:00:55,760 --> 00:00:58,879
uh and why am i chatting with you well

31
00:00:58,879 --> 00:01:00,480
my name is matt tusan and you can tell

32
00:01:00,480 --> 00:01:02,719
that i'm super cool by the shades

33
00:01:02,719 --> 00:01:04,959
totally gives it away and i used to be

34
00:01:04,959 --> 00:01:06,400
in the air force i used to be here

35
00:01:06,400 --> 00:01:08,320
working in san antonio actually at

36
00:01:08,320 --> 00:01:10,000
lachlan air force base doing cyberspace

37
00:01:10,000 --> 00:01:12,479
stuff eventually i left the military

38
00:01:12,479 --> 00:01:13,840
went worked with black hills information

39
00:01:13,840 --> 00:01:15,040
security for a while doing

40
00:01:15,040 --> 00:01:17,200
penetration testing red teaming all that

41
00:01:17,200 --> 00:01:18,080
kind of stuff

42
00:01:18,080 --> 00:01:19,439
swapped over to counter hack for a

43
00:01:19,439 --> 00:01:21,119
little bit building you might notice

44
00:01:21,119 --> 00:01:21,520
these

45
00:01:21,520 --> 00:01:23,759
these slides are sans branded doing a

46
00:01:23,759 --> 00:01:25,280
little bit of

47
00:01:25,280 --> 00:01:27,439
range building for sans i actually got

48
00:01:27,439 --> 00:01:29,360
to rediscover some of my military routes

49
00:01:29,360 --> 00:01:30,640
doing that because we do uh

50
00:01:30,640 --> 00:01:33,040
exercises to help with blue team

51
00:01:33,040 --> 00:01:34,400
validation efforts

52
00:01:34,400 --> 00:01:36,880
for the cpts that the military has some

53
00:01:36,880 --> 00:01:39,119
of them here out of san antonio in fact

54
00:01:39,119 --> 00:01:41,040
um after that i went ahead and made my

55
00:01:41,040 --> 00:01:43,280
own cyber security company open security

56
00:01:43,280 --> 00:01:45,040
uh which in fact is part of why i'm

57
00:01:45,040 --> 00:01:46,159
chatting with you here today we

58
00:01:46,159 --> 00:01:47,520
sponsored b-sides

59
00:01:47,520 --> 00:01:50,640
and they had a last-minute cancellation

60
00:01:50,640 --> 00:01:51,360
for a talk

61
00:01:51,360 --> 00:01:52,840
and they reached out to us and i said

62
00:01:52,840 --> 00:01:55,680
hey i happen to have some slides sitting

63
00:01:55,680 --> 00:01:56,240
around

64
00:01:56,240 --> 00:01:58,000
uh i guess in a couple hours i can do a

65
00:01:58,000 --> 00:02:00,240
presentation for you

66
00:02:00,240 --> 00:02:01,759
so that's why i'm here and that's why

67
00:02:01,759 --> 00:02:03,600
we're having this uh conversation about

68
00:02:03,600 --> 00:02:05,360
overt and covert operations

69
00:02:05,360 --> 00:02:07,920
in sans i'm also the uh lead author of

70
00:02:07,920 --> 00:02:08,399
sec

71
00:02:08,399 --> 00:02:10,560
security 460 on enterprise threat and

72
00:02:10,560 --> 00:02:11,760
vulnerability assessment

73
00:02:11,760 --> 00:02:14,800
as well as the author of 665

74
00:02:14,800 --> 00:02:16,080
which you'll see at the very bottom of

75
00:02:16,080 --> 00:02:17,200
these slides in fact because it's where

76
00:02:17,200 --> 00:02:18,560
these slides come from

77
00:02:18,560 --> 00:02:21,440
on advanced red team tactics and threat

78
00:02:21,440 --> 00:02:22,400
emulation

79
00:02:22,400 --> 00:02:24,400
now if you haven't heard of 665 before

80
00:02:24,400 --> 00:02:26,160
that's uh partly by design

81
00:02:26,160 --> 00:02:27,920
but it's also because the course isn't

82
00:02:27,920 --> 00:02:29,760
actually live yet the course is in

83
00:02:29,760 --> 00:02:30,400
development

84
00:02:30,400 --> 00:02:31,840
and one of the things that i want to do

85
00:02:31,840 --> 00:02:33,680
as we start developing this course for

86
00:02:33,680 --> 00:02:34,480
sans and such

87
00:02:34,480 --> 00:02:35,840
is i want to share as much as we can

88
00:02:35,840 --> 00:02:37,360
with the community as we go through

89
00:02:37,360 --> 00:02:38,080
which is

90
00:02:38,080 --> 00:02:39,760
the genesis of these slides so what

91
00:02:39,760 --> 00:02:41,519
you're seeing here is essentially a bit

92
00:02:41,519 --> 00:02:43,200
of a beta first look at some of the

93
00:02:43,200 --> 00:02:44,640
things that we're exploring

94
00:02:44,640 --> 00:02:46,319
from the perspective of red team

95
00:02:46,319 --> 00:02:50,239
training and i hope you'll enjoy it

96
00:02:50,239 --> 00:02:52,160
so this presentation here is focused

97
00:02:52,160 --> 00:02:53,440
entirely on

98
00:02:53,440 --> 00:02:56,560
red force versus blue force operations

99
00:02:56,560 --> 00:02:58,319
and that what i mean by that is you've

100
00:02:58,319 --> 00:03:00,480
got a red team you've got a blue team

101
00:03:00,480 --> 00:03:02,800
and they interact with each other on a

102
00:03:02,800 --> 00:03:04,400
networking environment

103
00:03:04,400 --> 00:03:06,319
and traditionally of course when we talk

104
00:03:06,319 --> 00:03:08,159
about it from the red team perspective

105
00:03:08,159 --> 00:03:10,080
we want to challenge the blue team our

106
00:03:10,080 --> 00:03:11,680
objective in the end is going to be to

107
00:03:11,680 --> 00:03:14,239
make blue team defensive stronger

108
00:03:14,239 --> 00:03:16,239
and there's a good reason for this right

109
00:03:16,239 --> 00:03:17,440
now i would not

110
00:03:17,440 --> 00:03:21,040
say that we are winning in cyberspace

111
00:03:21,040 --> 00:03:22,720
not really and the thing is it's not

112
00:03:22,720 --> 00:03:24,560
because we have to lose or because the

113
00:03:24,560 --> 00:03:26,000
attacker has the advantage

114
00:03:26,000 --> 00:03:27,040
i think once we're through this

115
00:03:27,040 --> 00:03:28,720
conversation and through this topic

116
00:03:28,720 --> 00:03:29,280
you'll

117
00:03:29,280 --> 00:03:30,959
see that the attacker really doesn't

118
00:03:30,959 --> 00:03:32,400
have the advantage since we're giving it

119
00:03:32,400 --> 00:03:33,680
from the perspective of red team

120
00:03:33,680 --> 00:03:35,920
we can actually see the history of this

121
00:03:35,920 --> 00:03:36,720
and why

122
00:03:36,720 --> 00:03:40,560
as red tamers we today perhaps need to

123
00:03:40,560 --> 00:03:43,200
very significantly alter the site

124
00:03:43,200 --> 00:03:43,680
picture

125
00:03:43,680 --> 00:03:45,440
by which we actually look at how we

126
00:03:45,440 --> 00:03:47,440
perform operations in order to keep up

127
00:03:47,440 --> 00:03:49,200
with the most advanced blue teams out

128
00:03:49,200 --> 00:03:49,840
there

129
00:03:49,840 --> 00:03:51,680
but the problem that we have and the

130
00:03:51,680 --> 00:03:53,360
reason why we're not really winning

131
00:03:53,360 --> 00:03:55,680
is because many blue teams aren't

132
00:03:55,680 --> 00:03:56,640
focusing

133
00:03:56,640 --> 00:04:00,319
on what is in fact the right problem and

134
00:04:00,319 --> 00:04:02,400
what we see as a result of that is that

135
00:04:02,400 --> 00:04:05,200
attackers have essentially carte blanche

136
00:04:05,200 --> 00:04:07,360
access to our information networks and

137
00:04:07,360 --> 00:04:08,400
information systems

138
00:04:08,400 --> 00:04:10,400
uh with open security we do all kinds of

139
00:04:10,400 --> 00:04:11,519
cyber security work

140
00:04:11,519 --> 00:04:13,599
things like penetration testing and red

141
00:04:13,599 --> 00:04:15,599
teaming but also incident handling and

142
00:04:15,599 --> 00:04:16,959
incident response

143
00:04:16,959 --> 00:04:18,880
and for example i was doing an instant

144
00:04:18,880 --> 00:04:20,639
response uh you tend to have to do these

145
00:04:20,639 --> 00:04:21,199
on site

146
00:04:21,199 --> 00:04:22,639
so this is the lastness and a response i

147
00:04:22,639 --> 00:04:24,560
did before all the quarantine lockdowns

148
00:04:24,560 --> 00:04:26,800
and covet 19 stuff so ah

149
00:04:26,800 --> 00:04:28,880
fun times so i was doing this instant

150
00:04:28,880 --> 00:04:30,479
response and it was for

151
00:04:30,479 --> 00:04:33,360
a law firm who had been compromised and

152
00:04:33,360 --> 00:04:35,360
ransomed this was in february

153
00:04:35,360 --> 00:04:37,520
and uh so we go in there and we first

154
00:04:37,520 --> 00:04:39,120
start looking and what we want to find

155
00:04:39,120 --> 00:04:40,400
out is how the attacker got in

156
00:04:40,400 --> 00:04:42,080
potentially do some attribution to

157
00:04:42,080 --> 00:04:44,880
determine who that actual attacker is

158
00:04:44,880 --> 00:04:47,120
if this environment got compromised by

159
00:04:47,120 --> 00:04:48,800
our experience we can pretty much say

160
00:04:48,800 --> 00:04:50,400
that it's probably not the most secure

161
00:04:50,400 --> 00:04:51,680
environment

162
00:04:51,680 --> 00:04:52,720
and not to say that if you're really

163
00:04:52,720 --> 00:04:54,639
secure you won't get compromised that's

164
00:04:54,639 --> 00:04:56,080
not the case at all but generally

165
00:04:56,080 --> 00:04:56,720
speaking

166
00:04:56,720 --> 00:04:58,080
if i'm showing up to do incident

167
00:04:58,080 --> 00:05:00,560
response i'm not expecting the blue team

168
00:05:00,560 --> 00:05:02,160
to really know what's going on

169
00:05:02,160 --> 00:05:04,000
if there even is a blue team and that's

170
00:05:04,000 --> 00:05:05,280
just that's just typical

171
00:05:05,280 --> 00:05:07,039
now sometimes you have really good teams

172
00:05:07,039 --> 00:05:09,199
but most of the time you don't

173
00:05:09,199 --> 00:05:10,479
and i think a lot of the people who are

174
00:05:10,479 --> 00:05:12,479
having this conversation or here with us

175
00:05:12,479 --> 00:05:13,199
and b-sides

176
00:05:13,199 --> 00:05:14,560
might not actually quite realize what it

177
00:05:14,560 --> 00:05:16,320
looks like in the real world because

178
00:05:16,320 --> 00:05:18,320
most of us with an information security

179
00:05:18,320 --> 00:05:19,120
role

180
00:05:19,120 --> 00:05:21,039
work at some organization that has an

181
00:05:21,039 --> 00:05:22,720
information security function

182
00:05:22,720 --> 00:05:24,240
and that might be on the offensive side

183
00:05:24,240 --> 00:05:25,759
maybe you work for a company like open

184
00:05:25,759 --> 00:05:26,880
security and we do cyber security

185
00:05:26,880 --> 00:05:27,600
services

186
00:05:27,600 --> 00:05:29,840
or perhaps it's on the defensive side or

187
00:05:29,840 --> 00:05:31,360
even offensive side but internal to an

188
00:05:31,360 --> 00:05:32,320
organization

189
00:05:32,320 --> 00:05:34,240
where the organization itself has

190
00:05:34,240 --> 00:05:35,759
invested into

191
00:05:35,759 --> 00:05:37,919
cyber security positions so if we work

192
00:05:37,919 --> 00:05:39,680
in the business of cyber security

193
00:05:39,680 --> 00:05:41,840
we're actually already exposed to

194
00:05:41,840 --> 00:05:43,360
something that is not normal

195
00:05:43,360 --> 00:05:44,880
and as somebody who's done a fair bit of

196
00:05:44,880 --> 00:05:46,479
instant response i can tell you what

197
00:05:46,479 --> 00:05:47,520
normal looks like

198
00:05:47,520 --> 00:05:50,400
because i show up when their network uh

199
00:05:50,400 --> 00:05:52,000
stops working

200
00:05:52,000 --> 00:05:53,600
and in those cases many times they might

201
00:05:53,600 --> 00:05:55,440
have some i.t personnel but they

202
00:05:55,440 --> 00:05:56,880
probably don't have

203
00:05:56,880 --> 00:05:59,360
direct information security people and

204
00:05:59,360 --> 00:06:00,479
that's not because

205
00:06:00,479 --> 00:06:01,759
if they had them they certainly wouldn't

206
00:06:01,759 --> 00:06:03,360
get gotten hacked or anything like that

207
00:06:03,360 --> 00:06:04,960
i'm just saying we need to look at

208
00:06:04,960 --> 00:06:07,520
the world as a whole and there's a very

209
00:06:07,520 --> 00:06:08,720
very big difference

210
00:06:08,720 --> 00:06:10,160
between the top twenty percent of

211
00:06:10,160 --> 00:06:12,560
companies and the bottom eighty percent

212
00:06:12,560 --> 00:06:13,919
of companies out there

213
00:06:13,919 --> 00:06:16,400
in the top twenty percent there may be

214
00:06:16,400 --> 00:06:17,840
somebody who fulfills an

215
00:06:17,840 --> 00:06:19,759
information security role in the company

216
00:06:19,759 --> 00:06:21,520
specifically in the bottom eighty

217
00:06:21,520 --> 00:06:22,880
percent of companies and yes i

218
00:06:22,880 --> 00:06:24,639
seriously do mean eighty percent of

219
00:06:24,639 --> 00:06:25,919
companies today

220
00:06:25,919 --> 00:06:27,840
and i'm not even talking about say

221
00:06:27,840 --> 00:06:29,280
companies in uh

222
00:06:29,280 --> 00:06:30,880
less developed countries no i'm talking

223
00:06:30,880 --> 00:06:32,639
about the companies that we see and

224
00:06:32,639 --> 00:06:35,199
interact with on a day-to-day basis

225
00:06:35,199 --> 00:06:36,880
the eighty percent of those eighty

226
00:06:36,880 --> 00:06:38,319
percent of those companies they don't

227
00:06:38,319 --> 00:06:39,520
have a single employee

228
00:06:39,520 --> 00:06:42,880
with an information security specific

229
00:06:42,880 --> 00:06:44,479
function we are talking about pretty big

230
00:06:44,479 --> 00:06:46,080
companies here companies that may have

231
00:06:46,080 --> 00:06:48,400
say two hundred to a thousand employees

232
00:06:48,400 --> 00:06:49,840
so we're not talking about the tiny

233
00:06:49,840 --> 00:06:51,599
companies but we are talking about the

234
00:06:51,599 --> 00:06:52,880
majority of companies

235
00:06:52,880 --> 00:06:55,280
and as a result in information security

236
00:06:55,280 --> 00:06:56,080
we're often

237
00:06:56,080 --> 00:06:59,199
inundated in this uh

238
00:06:59,199 --> 00:07:01,919
circumstances of isolation where our

239
00:07:01,919 --> 00:07:04,479
perspective is significantly skewed from

240
00:07:04,479 --> 00:07:05,280
reality

241
00:07:05,280 --> 00:07:06,720
because we look at things from the

242
00:07:06,720 --> 00:07:08,720
perspective of organizations where we

243
00:07:08,720 --> 00:07:10,400
work or whom we work for

244
00:07:10,400 --> 00:07:11,759
which means that they've likely made

245
00:07:11,759 --> 00:07:13,759
some investment into cyber security

246
00:07:13,759 --> 00:07:15,280
and i'm here to tell you right now that

247
00:07:15,280 --> 00:07:17,039
is not typical

248
00:07:17,039 --> 00:07:18,319
and so what it looks like from the

249
00:07:18,319 --> 00:07:20,000
attack perspective in many of these

250
00:07:20,000 --> 00:07:20,639
cases

251
00:07:20,639 --> 00:07:22,240
and also for that top 20 we'll talk

252
00:07:22,240 --> 00:07:23,680
about that here in just a little bit

253
00:07:23,680 --> 00:07:24,960
but what it looks like from the attack

254
00:07:24,960 --> 00:07:27,120
perspective is that you don't

255
00:07:27,120 --> 00:07:29,759
need to do very much at all to be covert

256
00:07:29,759 --> 00:07:31,360
right so if we're talking about covert

257
00:07:31,360 --> 00:07:33,759
the idea with covert operations is that

258
00:07:33,759 --> 00:07:35,599
these are actions that we maybe do from

259
00:07:35,599 --> 00:07:36,800
an offensive perspective

260
00:07:36,800 --> 00:07:38,560
that are intended to fly beneath the

261
00:07:38,560 --> 00:07:40,319
radar now is it possible that it wasn't

262
00:07:40,319 --> 00:07:41,039
covert enough

263
00:07:41,039 --> 00:07:43,199
yes yes yes absolutely but when we're

264
00:07:43,199 --> 00:07:44,720
doing an operation right as an attacker

265
00:07:44,720 --> 00:07:46,080
we make a decision

266
00:07:46,080 --> 00:07:48,240
that decision that we make is covert if

267
00:07:48,240 --> 00:07:50,000
what we expect

268
00:07:50,000 --> 00:07:52,319
is for it to fly beneath the radar now

269
00:07:52,319 --> 00:07:54,080
we could get caught again that does

270
00:07:54,080 --> 00:07:54,800
happen

271
00:07:54,800 --> 00:07:56,879
but our thoughts there are i'm going

272
00:07:56,879 --> 00:07:58,400
gonna do something and this will

273
00:07:58,400 --> 00:08:00,639
probably not get noticed

274
00:08:00,639 --> 00:08:01,680
and if we look at the bottom eighty

275
00:08:01,680 --> 00:08:03,759
percent that is a hundred percent true

276
00:08:03,759 --> 00:08:08,000
it's like uh uh um that anchorman uh

277
00:08:08,000 --> 00:08:09,520
thing right eighty percent of the time

278
00:08:09,520 --> 00:08:11,440
it works eighty uh hundreds it works all

279
00:08:11,440 --> 00:08:12,720
the time yeah that's what it is for the

280
00:08:12,720 --> 00:08:13,680
bottom eighty percent

281
00:08:13,680 --> 00:08:15,199
now in the top 20 percent we can often

282
00:08:15,199 --> 00:08:17,199
do covert operations without doing much

283
00:08:17,199 --> 00:08:17,759
either

284
00:08:17,759 --> 00:08:19,440
so we look at the eight at the bottom

285
00:08:19,440 --> 00:08:21,360
eighty percent of the top twenty percent

286
00:08:21,360 --> 00:08:22,720
now i sound like bernie sanders over

287
00:08:22,720 --> 00:08:24,560
here goodness

288
00:08:24,560 --> 00:08:26,080
the bottom of 80 percent of the top 20

289
00:08:26,080 --> 00:08:27,759
percent yeah so the bottom 80 percent of

290
00:08:27,759 --> 00:08:28,720
the top 20

291
00:08:28,720 --> 00:08:30,960
we generally uh are operating in an

292
00:08:30,960 --> 00:08:31,759
environment

293
00:08:31,759 --> 00:08:33,519
where there maybe is investment in

294
00:08:33,519 --> 00:08:35,200
security but there isn't really

295
00:08:35,200 --> 00:08:37,440
continuous and active defense or

296
00:08:37,440 --> 00:08:39,200
monitoring so what we might do is we

297
00:08:39,200 --> 00:08:41,200
might trip some kind of antivirus

298
00:08:41,200 --> 00:08:43,919
or edr edr stands for endpoint detection

299
00:08:43,919 --> 00:08:44,880
and response

300
00:08:44,880 --> 00:08:48,080
uh so we trip that system but uh when it

301
00:08:48,080 --> 00:08:49,760
finds our malware maybe we uh we work

302
00:08:49,760 --> 00:08:50,880
through our malware a little bit more

303
00:08:50,880 --> 00:08:52,240
and we do a bypass

304
00:08:52,240 --> 00:08:53,600
and now we get our malware actually

305
00:08:53,600 --> 00:08:55,920
working but when we do this we probably

306
00:08:55,920 --> 00:08:57,120
don't expect

307
00:08:57,120 --> 00:08:59,360
that anyone actually looked at the

308
00:08:59,360 --> 00:09:00,240
detection

309
00:09:00,240 --> 00:09:02,720
or at the antivirus alert and did

310
00:09:02,720 --> 00:09:04,080
anything about it because the bottom

311
00:09:04,080 --> 00:09:05,839
eighty percent of the top twenty percent

312
00:09:05,839 --> 00:09:07,680
maybe has some of these things in place

313
00:09:07,680 --> 00:09:09,839
and they have the opportunity to be

314
00:09:09,839 --> 00:09:12,000
victorious but they don't actually take

315
00:09:12,000 --> 00:09:13,200
advantage of that so they have the

316
00:09:13,200 --> 00:09:15,519
sensors but nobody's looking at them

317
00:09:15,519 --> 00:09:17,920
here's a really sad example of exactly

318
00:09:17,920 --> 00:09:19,120
that

319
00:09:19,120 --> 00:09:22,399
for example equifax who here's heard of

320
00:09:22,399 --> 00:09:25,200
equifax yeah that's a sad story or

321
00:09:25,200 --> 00:09:26,640
actually just an embarrassing story

322
00:09:26,640 --> 00:09:27,040
right

323
00:09:27,040 --> 00:09:29,120
they get compromised by an attack group

324
00:09:29,120 --> 00:09:30,320
who had compromised them

325
00:09:30,320 --> 00:09:32,560
two separate occasions in the past going

326
00:09:32,560 --> 00:09:33,920
after the exact same data

327
00:09:33,920 --> 00:09:35,839
and they still managed to fall apart a

328
00:09:35,839 --> 00:09:37,760
third time then they took an extra four

329
00:09:37,760 --> 00:09:39,440
months after they found the compromise

330
00:09:39,440 --> 00:09:41,120
before they told anybody about it

331
00:09:41,120 --> 00:09:42,720
because they just don't care about the

332
00:09:42,720 --> 00:09:43,440
fact that they

333
00:09:43,440 --> 00:09:46,320
just released 200 plus million people's

334
00:09:46,320 --> 00:09:48,160
credit card information and data like

335
00:09:48,160 --> 00:09:49,040
absolutely

336
00:09:49,040 --> 00:09:51,200
atrocious really want that company to

337
00:09:51,200 --> 00:09:52,480
burn in a fire

338
00:09:52,480 --> 00:09:55,680
um but what's fun or fun

339
00:09:55,680 --> 00:09:57,839
what's intriguing is if we look at how

340
00:09:57,839 --> 00:09:59,279
they found out that they were actually

341
00:09:59,279 --> 00:10:00,080
compromised

342
00:10:00,080 --> 00:10:01,440
if we look at the ttp of that attack

343
00:10:01,440 --> 00:10:02,880
group they were not particularly

344
00:10:02,880 --> 00:10:04,000
effective they didn't really know

345
00:10:04,000 --> 00:10:06,000
what they were doing and we can see this

346
00:10:06,000 --> 00:10:07,920
by some of the commands that they ran

347
00:10:07,920 --> 00:10:09,519
for example every time they compromised

348
00:10:09,519 --> 00:10:11,440
this equifax server the first command

349
00:10:11,440 --> 00:10:12,160
that they would run

350
00:10:12,160 --> 00:10:13,519
is who am i because they want to know

351
00:10:13,519 --> 00:10:15,279
what the user context is that they're

352
00:10:15,279 --> 00:10:16,839
running it

353
00:10:16,839 --> 00:10:19,120
okay theoretically you could know this

354
00:10:19,120 --> 00:10:20,399
based on the process that you're

355
00:10:20,399 --> 00:10:22,160
compromising in that case it was a java

356
00:10:22,160 --> 00:10:23,680
web application so it was a tomcat

357
00:10:23,680 --> 00:10:24,160
server

358
00:10:24,160 --> 00:10:26,079
tomcat generally runs as root on these

359
00:10:26,079 --> 00:10:27,600
systems which in my opinion just a

360
00:10:27,600 --> 00:10:29,360
design flaw

361
00:10:29,360 --> 00:10:31,040
but so the attacker got gets access to

362
00:10:31,040 --> 00:10:32,480
these systems and starts running some

363
00:10:32,480 --> 00:10:33,440
basic commands

364
00:10:33,440 --> 00:10:36,560
on them now equifax found out

365
00:10:36,560 --> 00:10:38,000
months and months after they were

366
00:10:38,000 --> 00:10:40,480
compromised because

367
00:10:40,480 --> 00:10:42,320
they had a monitoring solution and the

368
00:10:42,320 --> 00:10:44,320
monitoring solution identified

369
00:10:44,320 --> 00:10:46,720
data exfiltration so why did it take

370
00:10:46,720 --> 00:10:48,000
four or five months

371
00:10:48,000 --> 00:10:50,560
for them to see for them to identify

372
00:10:50,560 --> 00:10:51,760
they were compromised when that

373
00:10:51,760 --> 00:10:53,360
compromise was happening and the data

374
00:10:53,360 --> 00:10:54,480
exploration was happening over that

375
00:10:54,480 --> 00:10:56,240
entire period of time

376
00:10:56,240 --> 00:10:58,720
well so it turns out they had this box

377
00:10:58,720 --> 00:11:00,000
they probably paid too much money

378
00:11:00,000 --> 00:11:01,680
for and they plugged it in and it was

379
00:11:01,680 --> 00:11:03,120
doing this continuous monitoring

380
00:11:03,120 --> 00:11:04,720
and the blinky blinky lights were going

381
00:11:04,720 --> 00:11:06,320
blinky blinky blinky

382
00:11:06,320 --> 00:11:09,440
but nobody was looking until five months

383
00:11:09,440 --> 00:11:11,040
later they realized that it wasn't

384
00:11:11,040 --> 00:11:12,160
properly logging

385
00:11:12,160 --> 00:11:13,920
i think what happened was that the hard

386
00:11:13,920 --> 00:11:15,839
drive had gotten full of logs

387
00:11:15,839 --> 00:11:17,680
and they didn't clear it so it was going

388
00:11:17,680 --> 00:11:19,360
blinky blinky blinky and they weren't

389
00:11:19,360 --> 00:11:20,480
thinking about the fact that it wasn't

390
00:11:20,480 --> 00:11:22,000
working at all as they finally get this

391
00:11:22,000 --> 00:11:24,320
thing back up and running and they go oh

392
00:11:24,320 --> 00:11:29,920
huh i think we're hacked again

393
00:11:29,920 --> 00:11:32,079
this is covert operations in the bottom

394
00:11:32,079 --> 00:11:33,920
eighty percent of the top twenty percent

395
00:11:33,920 --> 00:11:35,600
you don't have to do very much

396
00:11:35,600 --> 00:11:36,800
because even if the security

397
00:11:36,800 --> 00:11:38,640
orchestration is in place

398
00:11:38,640 --> 00:11:40,160
for eighty percent of that top twenty

399
00:11:40,160 --> 00:11:42,079
percent they're not looking at it

400
00:11:42,079 --> 00:11:44,399
so what we're really talking about is

401
00:11:44,399 --> 00:11:46,480
the top

402
00:11:46,480 --> 00:11:50,560
20 of the top 20

403
00:11:50,560 --> 00:11:53,839
i think that mathematically makes sense

404
00:11:53,839 --> 00:11:55,519
but we're talking about advanced red

405
00:11:55,519 --> 00:11:56,880
team we need to have the ability to

406
00:11:56,880 --> 00:11:57,519
project

407
00:11:57,519 --> 00:11:59,760
forces right to be able to operate on

408
00:11:59,760 --> 00:12:00,720
these environments

409
00:12:00,720 --> 00:12:02,079
even when there's some of the most

410
00:12:02,079 --> 00:12:04,000
secure ones out there and for a couple

411
00:12:04,000 --> 00:12:05,360
of information security firms

412
00:12:05,360 --> 00:12:07,839
that's really what we focus on so if i

413
00:12:07,839 --> 00:12:09,040
were to name the the ones that really

414
00:12:09,040 --> 00:12:10,079
focus here it's a

415
00:12:10,079 --> 00:12:11,920
trusted sac black hills information

416
00:12:11,920 --> 00:12:14,240
security us open security

417
00:12:14,240 --> 00:12:16,000
red siege their company out of dallas

418
00:12:16,000 --> 00:12:18,560
texas uh our focus tends to really be on

419
00:12:18,560 --> 00:12:19,200
operating

420
00:12:19,200 --> 00:12:21,200
in some of the most well orchestrated

421
00:12:21,200 --> 00:12:23,040
environments from a security standpoint

422
00:12:23,040 --> 00:12:24,959
out there we really love to play in

423
00:12:24,959 --> 00:12:26,560
these playgrounds but what we'll see

424
00:12:26,560 --> 00:12:27,200
here

425
00:12:27,200 --> 00:12:29,120
is that those type of organizations have

426
00:12:29,120 --> 00:12:30,800
all done some interesting things from

427
00:12:30,800 --> 00:12:32,000
the perspective of

428
00:12:32,000 --> 00:12:34,800
retooling in order for it to be possible

429
00:12:34,800 --> 00:12:36,720
to do operations on those environments

430
00:12:36,720 --> 00:12:38,959
because if we do anything that is even

431
00:12:38,959 --> 00:12:40,160
remotely

432
00:12:40,160 --> 00:12:43,120
not covert enough we get caught

433
00:12:43,120 --> 00:12:43,920
immediately

434
00:12:43,920 --> 00:12:46,720
and then the entire campaign falls apart

435
00:12:46,720 --> 00:12:48,079
pretty darn quickly

436
00:12:48,079 --> 00:12:49,920
and so if we're in this circumstance

437
00:12:49,920 --> 00:12:51,920
where we have to tiptoe around the

438
00:12:51,920 --> 00:12:52,480
environment

439
00:12:52,480 --> 00:12:54,480
very very cautiously and then we end up

440
00:12:54,480 --> 00:12:55,839
in a circumstance let's say we see a

441
00:12:55,839 --> 00:12:56,320
system

442
00:12:56,320 --> 00:12:58,560
we've got system access to that device

443
00:12:58,560 --> 00:13:00,399
and we know a domain admin is logged in

444
00:13:00,399 --> 00:13:02,000
so we want to do some kind of mimikats

445
00:13:02,000 --> 00:13:03,839
but we're pretty sure that something may

446
00:13:03,839 --> 00:13:04,880
be looking for

447
00:13:04,880 --> 00:13:06,639
let's say reflected dll injection into

448
00:13:06,639 --> 00:13:08,000
the lsas process

449
00:13:08,000 --> 00:13:09,279
right we're pretty sure that this

450
00:13:09,279 --> 00:13:11,120
operation that we're going to do isn't

451
00:13:11,120 --> 00:13:11,839
covert

452
00:13:11,839 --> 00:13:14,160
it's going to be over but we need to do

453
00:13:14,160 --> 00:13:15,760
it anyways

454
00:13:15,760 --> 00:13:17,519
because if we don't we may not be able

455
00:13:17,519 --> 00:13:19,200
to accomplish our objectives

456
00:13:19,200 --> 00:13:21,279
from a red team engagement perspective

457
00:13:21,279 --> 00:13:22,560
so every now and then we have what we

458
00:13:22,560 --> 00:13:23,120
call

459
00:13:23,120 --> 00:13:25,600
non-opsec safe operations we may do as a

460
00:13:25,600 --> 00:13:26,160
red team

461
00:13:26,160 --> 00:13:28,560
where we're aware that this is going to

462
00:13:28,560 --> 00:13:29,920
be less covert than the rest of our

463
00:13:29,920 --> 00:13:31,680
operations and it's going to be more

464
00:13:31,680 --> 00:13:32,320
loud

465
00:13:32,320 --> 00:13:34,480
so it's there's a chance we might get

466
00:13:34,480 --> 00:13:36,480
caught and so we're talking about with

467
00:13:36,480 --> 00:13:37,920
overt operations here

468
00:13:37,920 --> 00:13:39,760
is when we do an action that we know or

469
00:13:39,760 --> 00:13:41,519
acknowledge the blue team

470
00:13:41,519 --> 00:13:43,120
should see it's possible they don't see

471
00:13:43,120 --> 00:13:44,880
it happens all the time right

472
00:13:44,880 --> 00:13:46,240
hiding in the noise is an example of

473
00:13:46,240 --> 00:13:48,000
this but we acknowledge

474
00:13:48,000 --> 00:13:50,000
that this operation we're about to do

475
00:13:50,000 --> 00:13:51,120
could uh

476
00:13:51,120 --> 00:13:52,880
key the blue team in on what we're

477
00:13:52,880 --> 00:13:54,720
absolutely doing now the thing about

478
00:13:54,720 --> 00:13:56,560
overt operations though is

479
00:13:56,560 --> 00:13:58,800
what if we acknowledge that we're going

480
00:13:58,800 --> 00:13:59,839
to be seen

481
00:13:59,839 --> 00:14:02,880
and we make ourselves seen

482
00:14:02,880 --> 00:14:06,079
everywhere simultaneously

483
00:14:06,079 --> 00:14:07,920
in order to cover what we're actually

484
00:14:07,920 --> 00:14:09,519
doing

485
00:14:09,519 --> 00:14:11,519
so with blue team defenses these days

486
00:14:11,519 --> 00:14:13,040
there's actually this real big

487
00:14:13,040 --> 00:14:15,440
conversation about using cyberspace

488
00:14:15,440 --> 00:14:16,399
deception

489
00:14:16,399 --> 00:14:18,720
in order to build deceptive defensive

490
00:14:18,720 --> 00:14:20,880
systems that trick the bad guy

491
00:14:20,880 --> 00:14:22,720
into giving up information about

492
00:14:22,720 --> 00:14:25,120
themselves an example of a cyberspace

493
00:14:25,120 --> 00:14:26,560
trap like this might be

494
00:14:26,560 --> 00:14:28,639
if we set a fine grain password policy

495
00:14:28,639 --> 00:14:29,680
in active directory

496
00:14:29,680 --> 00:14:31,760
with a lockout policy of one and then we

497
00:14:31,760 --> 00:14:33,279
create a uh

498
00:14:33,279 --> 00:14:36,399
domain admin user for that uh for that

499
00:14:36,399 --> 00:14:37,920
um

500
00:14:37,920 --> 00:14:39,279
we create a real domain add user with a

501
00:14:39,279 --> 00:14:40,560
strong password that we never need to

502
00:14:40,560 --> 00:14:42,160
use we can throw that password away

503
00:14:42,160 --> 00:14:43,839
we just needed the admin account okay

504
00:14:43,839 --> 00:14:45,199
and we set that admin account

505
00:14:45,199 --> 00:14:47,440
to that lockout policy of one and then

506
00:14:47,440 --> 00:14:49,440
we put incorrect credentials

507
00:14:49,440 --> 00:14:52,000
into lsas memory on some systems you can

508
00:14:52,000 --> 00:14:53,920
do this with a run as command

509
00:14:53,920 --> 00:14:55,600
if an attacker runs mimikatz which is

510
00:14:55,600 --> 00:14:56,800
one of the most common techniques that

511
00:14:56,800 --> 00:14:57,680
attackers will use

512
00:14:57,680 --> 00:14:59,360
they'll get that domain admin account

513
00:14:59,360 --> 00:15:01,279
and a password for it but when they try

514
00:15:01,279 --> 00:15:02,639
that password it's not the correct

515
00:15:02,639 --> 00:15:03,279
password

516
00:15:03,279 --> 00:15:05,199
so since the lockout policy is won it'll

517
00:15:05,199 --> 00:15:06,320
lock out the account

518
00:15:06,320 --> 00:15:08,320
and the attack or the defender can see

519
00:15:08,320 --> 00:15:10,320
that that system has been compromised

520
00:15:10,320 --> 00:15:12,079
based on that account lockout so this

521
00:15:12,079 --> 00:15:13,839
cyberspace deception is presenting the

522
00:15:13,839 --> 00:15:14,560
attacker

523
00:15:14,560 --> 00:15:15,680
with something that they're actively

524
00:15:15,680 --> 00:15:17,600
looking for but that thing that they're

525
00:15:17,600 --> 00:15:18,240
looking for

526
00:15:18,240 --> 00:15:21,440
is actually a trap um

527
00:15:21,440 --> 00:15:22,880
for example if you look at say monkey

528
00:15:22,880 --> 00:15:24,959
traps they do the ones with the the jar

529
00:15:24,959 --> 00:15:25,680
that's

530
00:15:25,680 --> 00:15:27,199
that the hole is large enough to get

531
00:15:27,199 --> 00:15:29,279
your hand in uh but there's marbles in

532
00:15:29,279 --> 00:15:30,800
it the monkeys want to grab the marbles

533
00:15:30,800 --> 00:15:32,480
but so they grab a fistful of marbles

534
00:15:32,480 --> 00:15:33,600
and they can't get their hand out of the

535
00:15:33,600 --> 00:15:34,560
jar anymore

536
00:15:34,560 --> 00:15:36,160
so you're giving them the marbles that

537
00:15:36,160 --> 00:15:37,600
they want uh

538
00:15:37,600 --> 00:15:39,920
domain admin credentials except they're

539
00:15:39,920 --> 00:15:41,920
not even real domain admin credentials

540
00:15:41,920 --> 00:15:43,680
and you're trapping them based on the

541
00:15:43,680 --> 00:15:45,199
ttp that the attackers themselves

542
00:15:45,199 --> 00:15:46,079
actually use

543
00:15:46,079 --> 00:15:47,600
and this is an emerging defensive

544
00:15:47,600 --> 00:15:50,000
strategy for some of the top tier

545
00:15:50,000 --> 00:15:52,000
organizations out there i was in fact

546
00:15:52,000 --> 00:15:53,040
doing some of this

547
00:15:53,040 --> 00:15:56,720
cyber defense cyberspace trapping

548
00:15:56,720 --> 00:15:59,120
orchestration and design when i was in

549
00:15:59,120 --> 00:15:59,920
the military

550
00:15:59,920 --> 00:16:01,600
as part of the u.s air force's tactics

551
00:16:01,600 --> 00:16:02,959
development shop

552
00:16:02,959 --> 00:16:05,040
but it's really really cool the thing is

553
00:16:05,040 --> 00:16:07,279
from the offensive perspective we've

554
00:16:07,279 --> 00:16:08,560
never really needed to

555
00:16:08,560 --> 00:16:10,880
trick the blue team very heavily into

556
00:16:10,880 --> 00:16:12,000
doing something

557
00:16:12,000 --> 00:16:14,880
because we've been able to operate

558
00:16:14,880 --> 00:16:16,240
covertly thus far

559
00:16:16,240 --> 00:16:17,680
but if we're looking at some of the most

560
00:16:17,680 --> 00:16:20,240
secure environments on the planet

561
00:16:20,240 --> 00:16:21,920
well what we have to acknowledge is that

562
00:16:21,920 --> 00:16:24,000
most of the covert operations would have

563
00:16:24,000 --> 00:16:25,040
done in the past

564
00:16:25,040 --> 00:16:28,079
for this security uh

565
00:16:28,079 --> 00:16:29,759
posture of this organization are

566
00:16:29,759 --> 00:16:31,600
actually going to be overt operations

567
00:16:31,600 --> 00:16:33,519
instead of covert ones so how can we

568
00:16:33,519 --> 00:16:36,639
potentially leverage leverage deception

569
00:16:36,639 --> 00:16:38,480
and overtly perform deception in the

570
00:16:38,480 --> 00:16:40,320
environment when we know aid the

571
00:16:40,320 --> 00:16:41,600
attacker is going or the defender is

572
00:16:41,600 --> 00:16:42,480
going to see us

573
00:16:42,480 --> 00:16:44,959
so we want to be give ourselves more

574
00:16:44,959 --> 00:16:46,320
opportunity and more freedom of

575
00:16:46,320 --> 00:16:47,680
maneuvering the environment

576
00:16:47,680 --> 00:16:50,240
by convincing the defenders that we are

577
00:16:50,240 --> 00:16:51,199
somewhere else

578
00:16:51,199 --> 00:16:53,440
and doing something that we are in fact

579
00:16:53,440 --> 00:16:55,600
not worried about

580
00:16:55,600 --> 00:16:57,120
and so let's talk about this history

581
00:16:57,120 --> 00:16:59,920
then of overt to covert operations here

582
00:16:59,920 --> 00:17:01,199
with covert operations and cyber

583
00:17:01,199 --> 00:17:02,639
security at the very beginning of course

584
00:17:02,639 --> 00:17:03,839
you could do whatever the heck you

585
00:17:03,839 --> 00:17:04,559
wanted to do

586
00:17:04,559 --> 00:17:07,359
because we didn't have antivirus and for

587
00:17:07,359 --> 00:17:08,640
the grey beards among us you may

588
00:17:08,640 --> 00:17:10,400
recognize some of these screenshots

589
00:17:10,400 --> 00:17:14,400
here we have sub 7. sub 7 is essentially

590
00:17:14,400 --> 00:17:15,359
the og

591
00:17:15,359 --> 00:17:18,400
original gangster of remote access

592
00:17:18,400 --> 00:17:20,559
trojans or remote access tools

593
00:17:20,559 --> 00:17:22,880
sub 7 is just a backdoor implant

594
00:17:22,880 --> 00:17:23,599
framework right

595
00:17:23,599 --> 00:17:25,039
you can create the back door it connects

596
00:17:25,039 --> 00:17:27,039
back to sub 7. the screenshot that's in

597
00:17:27,039 --> 00:17:28,240
front of it is one called

598
00:17:28,240 --> 00:17:31,679
poison ivy this is one that was used by

599
00:17:31,679 --> 00:17:32,320
a

600
00:17:32,320 --> 00:17:34,720
chinese intrusion set but unfortunately

601
00:17:34,720 --> 00:17:35,520
for them

602
00:17:35,520 --> 00:17:38,720
they uh they uploaded their

603
00:17:38,720 --> 00:17:40,559
code to a place that everyone in the

604
00:17:40,559 --> 00:17:41,760
world had access to

605
00:17:41,760 --> 00:17:43,520
and so now the world has access to this

606
00:17:43,520 --> 00:17:44,880
backdoor system as well

607
00:17:44,880 --> 00:17:47,520
to be fair these are quite old sub 7 is

608
00:17:47,520 --> 00:17:48,640
late 90s

609
00:17:48,640 --> 00:17:51,679
poison ivy is early 2000s but the thing

610
00:17:51,679 --> 00:17:52,160
is these

611
00:17:52,160 --> 00:17:54,000
these back doors these implants they

612
00:17:54,000 --> 00:17:55,360
should get picked up by a traditional

613
00:17:55,360 --> 00:17:56,640
antivirus because they don't really

614
00:17:56,640 --> 00:17:58,720
change not polymorphic in any sense

615
00:17:58,720 --> 00:18:01,120
because once upon a time those kinds of

616
00:18:01,120 --> 00:18:02,559
defenses didn't exist

617
00:18:02,559 --> 00:18:04,799
and to be covert we didn't have to do

618
00:18:04,799 --> 00:18:05,679
anything

619
00:18:05,679 --> 00:18:08,240
anything at all and then we had things

620
00:18:08,240 --> 00:18:10,160
like the metasploit framework metasploit

621
00:18:10,160 --> 00:18:11,440
framework came out also in the early

622
00:18:11,440 --> 00:18:13,440
2000s but has continued to grow and was

623
00:18:13,440 --> 00:18:14,799
developed and built upon

624
00:18:14,799 --> 00:18:16,880
by the community over time uh and

625
00:18:16,880 --> 00:18:18,320
heavily medically it's absolutely

626
00:18:18,320 --> 00:18:18,960
outstanding

627
00:18:18,960 --> 00:18:20,880
it is however an exploit it is an

628
00:18:20,880 --> 00:18:22,320
exploitation framework which includes

629
00:18:22,320 --> 00:18:23,919
things like exploit development

630
00:18:23,919 --> 00:18:26,000
so in the modern sense we don't

631
00:18:26,000 --> 00:18:27,200
traditionally think

632
00:18:27,200 --> 00:18:29,919
about metasploit as a command and

633
00:18:29,919 --> 00:18:31,360
control framework

634
00:18:31,360 --> 00:18:34,320
it does happen to be a c2 tool but we'll

635
00:18:34,320 --> 00:18:35,840
see with some more advanced ones

636
00:18:35,840 --> 00:18:37,600
are that there's a lot more command

637
00:18:37,600 --> 00:18:39,360
control framework features

638
00:18:39,360 --> 00:18:41,280
that don't actually exist in metasploit

639
00:18:41,280 --> 00:18:43,520
but we do start to see in the metasploit

640
00:18:43,520 --> 00:18:44,160
project

641
00:18:44,160 --> 00:18:46,080
is some understanding that there are

642
00:18:46,080 --> 00:18:48,240
signatures and that we may need to do

643
00:18:48,240 --> 00:18:50,320
things to evade those signatures and

644
00:18:50,320 --> 00:18:51,840
with that we have things like the

645
00:18:51,840 --> 00:18:53,520
encoders inside of metasploit

646
00:18:53,520 --> 00:18:55,360
for example one of the ones that's uh

647
00:18:55,360 --> 00:18:57,600
pretty well known is called shikaraganai

648
00:18:57,600 --> 00:19:00,799
which is japanese for it is inevitable

649
00:19:00,799 --> 00:19:04,400
um and so what it does is it takes a

650
00:19:04,400 --> 00:19:05,360
binary

651
00:19:05,360 --> 00:19:07,600
and it changes that one so it might say

652
00:19:07,600 --> 00:19:11,440
hey look we've got um this

653
00:19:11,440 --> 00:19:14,160
x86 piece of assembly that does

654
00:19:14,160 --> 00:19:14,799
something

655
00:19:14,799 --> 00:19:17,360
so let's convert that to an operation

656
00:19:17,360 --> 00:19:18,400
that does the equivalent

657
00:19:18,400 --> 00:19:21,520
thing but with different codes for

658
00:19:21,520 --> 00:19:22,160
example

659
00:19:22,160 --> 00:19:25,039
if we say um um if we're putting things

660
00:19:25,039 --> 00:19:26,000
in a register for

661
00:19:26,000 --> 00:19:28,400
registers for adding let's say we say uh

662
00:19:28,400 --> 00:19:30,720
set eax to one set eab

663
00:19:30,720 --> 00:19:33,600
to uh uh two and then add them together

664
00:19:33,600 --> 00:19:34,480
uh or to one

665
00:19:34,480 --> 00:19:35,520
and then add them together it gives you

666
00:19:35,520 --> 00:19:37,840
two right but you could do this in the

667
00:19:37,840 --> 00:19:39,120
opposite manner you could say

668
00:19:39,120 --> 00:19:42,480
add a to b and then add b to c

669
00:19:42,480 --> 00:19:45,360
and then subtract d from c and then you

670
00:19:45,360 --> 00:19:46,080
still get

671
00:19:46,080 --> 00:19:47,679
two and so here we have an example of

672
00:19:47,679 --> 00:19:49,200
just equivalent operations

673
00:19:49,200 --> 00:19:51,440
that then take a binary and make it do

674
00:19:51,440 --> 00:19:52,400
the same thing

675
00:19:52,400 --> 00:19:55,840
but do it in a different set

676
00:19:55,840 --> 00:19:57,919
of instructions which significantly

677
00:19:57,919 --> 00:19:59,200
alters the

678
00:19:59,200 --> 00:20:02,799
signature for that actual um binary

679
00:20:02,799 --> 00:20:04,559
now of course when you have an encoder

680
00:20:04,559 --> 00:20:06,159
like this what you have the ability to

681
00:20:06,159 --> 00:20:07,440
do as an antivirus spender

682
00:20:07,440 --> 00:20:08,880
is you can look at that encoder since

683
00:20:08,880 --> 00:20:11,039
metasploits encoders are open source

684
00:20:11,039 --> 00:20:12,480
you can look at that encoder and you can

685
00:20:12,480 --> 00:20:15,840
build a signature for how that encoder

686
00:20:15,840 --> 00:20:18,799
changes binaries for example if you were

687
00:20:18,799 --> 00:20:20,400
to do something like this

688
00:20:20,400 --> 00:20:23,760
with calculator.exe calculator.exe

689
00:20:23,760 --> 00:20:26,320
will absolutely show up as a virus and

690
00:20:26,320 --> 00:20:27,440
most antivirus

691
00:20:27,440 --> 00:20:29,760
uh software because it's not actually

692
00:20:29,760 --> 00:20:30,640
looking for

693
00:20:30,640 --> 00:20:32,840
the executable it's looking for the

694
00:20:32,840 --> 00:20:34,240
encoder um i

695
00:20:34,240 --> 00:20:37,840
in fact in 2013 2014 uh built

696
00:20:37,840 --> 00:20:40,000
an encoder and that encoder i i still

697
00:20:40,000 --> 00:20:41,520
happen to have the code works to this

698
00:20:41,520 --> 00:20:42,080
day

699
00:20:42,080 --> 00:20:44,960
for metasploit uh interpreters like to

700
00:20:44,960 --> 00:20:45,679
this day

701
00:20:45,679 --> 00:20:48,799
and the only reason it does is because i

702
00:20:48,799 --> 00:20:49,679
never

703
00:20:49,679 --> 00:20:53,039
uploaded the encoder to

704
00:20:53,039 --> 00:20:55,440
open source on the internet and so

705
00:20:55,440 --> 00:20:56,640
antivirus vendors have never had the

706
00:20:56,640 --> 00:20:58,400
opportunity to get the source code for

707
00:20:58,400 --> 00:20:59,200
the encoder

708
00:20:59,200 --> 00:21:01,679
and as a result i can still use it today

709
00:21:01,679 --> 00:21:02,960
to

710
00:21:02,960 --> 00:21:05,520
modify shell code and bypass antivirus

711
00:21:05,520 --> 00:21:06,159
vendors

712
00:21:06,159 --> 00:21:08,000
because antivirus itself isn't

713
00:21:08,000 --> 00:21:10,000
particularly a good security mechanism

714
00:21:10,000 --> 00:21:11,120
and i know a lot of people get a bit

715
00:21:11,120 --> 00:21:13,360
fatalistic about this

716
00:21:13,360 --> 00:21:16,559
because they say you know what am i

717
00:21:16,559 --> 00:21:17,919
actually supposed to do

718
00:21:17,919 --> 00:21:19,440
if all of these solutions that i can

719
00:21:19,440 --> 00:21:21,120
acquire or work on my network

720
00:21:21,120 --> 00:21:22,880
can be bypassed but the thing is we're

721
00:21:22,880 --> 00:21:24,080
actually looking at this wrong and the

722
00:21:24,080 --> 00:21:25,200
reason we're looking at it wrong is

723
00:21:25,200 --> 00:21:27,360
because we always want this staples easy

724
00:21:27,360 --> 00:21:28,240
button right

725
00:21:28,240 --> 00:21:29,520
anti-virus is a good example of a

726
00:21:29,520 --> 00:21:31,200
staples easy button and it works pretty

727
00:21:31,200 --> 00:21:32,480
well if we're talking about a

728
00:21:32,480 --> 00:21:36,080
mass exposed worm like let's say

729
00:21:36,080 --> 00:21:37,520
wannacry because they have plenty of

730
00:21:37,520 --> 00:21:39,440
time to build signatures

731
00:21:39,440 --> 00:21:42,320
for the virus before it actually manages

732
00:21:42,320 --> 00:21:43,760
to get to a lot of systems

733
00:21:43,760 --> 00:21:46,480
will zombies be exposed yes absolutely

734
00:21:46,480 --> 00:21:48,480
um it's kind of like building a vaccine

735
00:21:48,480 --> 00:21:48,799
right

736
00:21:48,799 --> 00:21:51,440
once we see a new strain of say wannacry

737
00:21:51,440 --> 00:21:52,640
the antivirus fenders go out and they

738
00:21:52,640 --> 00:21:53,919
make a signature for it

739
00:21:53,919 --> 00:21:55,520
but they can't make that signature until

740
00:21:55,520 --> 00:21:57,679
they've seen that version of wannacry

741
00:21:57,679 --> 00:21:58,000
come

742
00:21:58,000 --> 00:21:59,360
out so they actually have to have

743
00:21:59,360 --> 00:22:00,880
exposure of certain number of people

744
00:22:00,880 --> 00:22:02,159
then they find it they build the

745
00:22:02,159 --> 00:22:02,880
signature

746
00:22:02,880 --> 00:22:05,039
and uh make herd immunity essentially

747
00:22:05,039 --> 00:22:06,320
from everyone else who happens to have

748
00:22:06,320 --> 00:22:07,520
that antivirus product

749
00:22:07,520 --> 00:22:10,000
but the thing is that means that if

750
00:22:10,000 --> 00:22:11,600
you're doing

751
00:22:11,600 --> 00:22:14,799
operations as a human red teamer

752
00:22:14,799 --> 00:22:16,000
you will never be caught by these

753
00:22:16,000 --> 00:22:17,600
antivirus signatures because everything

754
00:22:17,600 --> 00:22:18,480
you're doing is

755
00:22:18,480 --> 00:22:20,559
from the perspective of antivirus zero

756
00:22:20,559 --> 00:22:22,559
day always right if i build my own back

757
00:22:22,559 --> 00:22:23,039
door

758
00:22:23,039 --> 00:22:25,280
is there a signature for it no if i use

759
00:22:25,280 --> 00:22:27,520
that back door for a specific campaign

760
00:22:27,520 --> 00:22:29,440
will there become a signature for it

761
00:22:29,440 --> 00:22:30,559
probably not

762
00:22:30,559 --> 00:22:32,080
not until that thing gets exposed and

763
00:22:32,080 --> 00:22:33,840
there's incident response that happens

764
00:22:33,840 --> 00:22:35,600
and the incident responders give that

765
00:22:35,600 --> 00:22:37,520
any the virus data to

766
00:22:37,520 --> 00:22:39,280
an antivirus vendor to create it see the

767
00:22:39,280 --> 00:22:41,600
thing is a automated system like

768
00:22:41,600 --> 00:22:42,640
antivirus is

769
00:22:42,640 --> 00:22:44,720
never ever ever going to be

770
00:22:44,720 --> 00:22:46,240
significantly capable

771
00:22:46,240 --> 00:22:49,280
at detecting a human

772
00:22:49,280 --> 00:22:52,000
operator on an environment i as a human

773
00:22:52,000 --> 00:22:52,720
operator

774
00:22:52,720 --> 00:22:55,039
will inevitably be successful at

775
00:22:55,039 --> 00:22:56,480
overcoming these machines

776
00:22:56,480 --> 00:22:58,960
now i do hear sometimes this concept of

777
00:22:58,960 --> 00:22:59,760
artificial

778
00:22:59,760 --> 00:23:01,840
intelligence based and machine learning

779
00:23:01,840 --> 00:23:03,280
based cyber security

780
00:23:03,280 --> 00:23:04,880
and you can buy those things today and

781
00:23:04,880 --> 00:23:06,000
they don't actually do what they say

782
00:23:06,000 --> 00:23:07,440
they do in their complete garbage save

783
00:23:07,440 --> 00:23:08,240
your money

784
00:23:08,240 --> 00:23:09,600
but i do think that at some point in the

785
00:23:09,600 --> 00:23:12,000
future maybe 15 20 years in the future

786
00:23:12,000 --> 00:23:16,080
we will have perhaps not general purpose

787
00:23:16,080 --> 00:23:17,440
artificial intelligence but artificial

788
00:23:17,440 --> 00:23:18,960
intelligence that's flexible enough

789
00:23:18,960 --> 00:23:21,200
from a cyber security context that it

790
00:23:21,200 --> 00:23:23,200
actually has some ability to fight

791
00:23:23,200 --> 00:23:25,280
an interactive operator but if you think

792
00:23:25,280 --> 00:23:26,559
that that's something that's available

793
00:23:26,559 --> 00:23:28,640
today you are misinformed

794
00:23:28,640 --> 00:23:30,880
and the sales team of that product has

795
00:23:30,880 --> 00:23:32,640
most likely been lying to you

796
00:23:32,640 --> 00:23:34,480
because it just doesn't exist today

797
00:23:34,480 --> 00:23:36,080
which means to stop

798
00:23:36,080 --> 00:23:38,559
a human attacker you need to have a

799
00:23:38,559 --> 00:23:39,520
human defender

800
00:23:39,520 --> 00:23:41,840
and we absolutely absolutely can be

801
00:23:41,840 --> 00:23:42,720
effective

802
00:23:42,720 --> 00:23:44,720
in this manner but what it means is the

803
00:23:44,720 --> 00:23:46,480
blue team tools that are effective as

804
00:23:46,480 --> 00:23:48,080
stopping human attackers

805
00:23:48,080 --> 00:23:51,360
tend to be tools that emphasize

806
00:23:51,360 --> 00:23:53,840
the blue team operator themselves as in

807
00:23:53,840 --> 00:23:55,039
they make them more efficient

808
00:23:55,039 --> 00:23:58,559
more capable of detecting and responding

809
00:23:58,559 --> 00:23:59,840
so that they can identify where the

810
00:23:59,840 --> 00:24:02,080
compromise is and identify what's going

811
00:24:02,080 --> 00:24:02,720
on with the

812
00:24:02,720 --> 00:24:04,320
with the system and the environment and

813
00:24:04,320 --> 00:24:06,640
then eradicate the compromise

814
00:24:06,640 --> 00:24:10,720
as well so if no one's looking

815
00:24:10,720 --> 00:24:12,640
from a covert operations perspective we

816
00:24:12,640 --> 00:24:14,480
don't really need to be that covert

817
00:24:14,480 --> 00:24:19,840
but the thing is um

818
00:24:21,279 --> 00:24:23,760
but the thing is today for the best

819
00:24:23,760 --> 00:24:25,120
environments

820
00:24:25,120 --> 00:24:27,600
there's often actually real defenders

821
00:24:27,600 --> 00:24:28,640
who are taking

822
00:24:28,640 --> 00:24:31,679
these say antivirus logs

823
00:24:31,679 --> 00:24:34,240
or edr alerts and they're actually

824
00:24:34,240 --> 00:24:35,919
sending a human there

825
00:24:35,919 --> 00:24:37,760
to take a look at what the circumstances

826
00:24:37,760 --> 00:24:40,159
are whereby that was generated

827
00:24:40,159 --> 00:24:42,320
if nobody's looking at these logs

828
00:24:42,320 --> 00:24:43,840
everything is covert

829
00:24:43,840 --> 00:24:45,279
but today for some of the most secure

830
00:24:45,279 --> 00:24:47,520
enterprises your endpoint detection and

831
00:24:47,520 --> 00:24:49,200
response systems

832
00:24:49,200 --> 00:24:51,360
are actually being used by blue teams to

833
00:24:51,360 --> 00:24:52,240
do

834
00:24:52,240 --> 00:24:54,799
detection and response i know it's a

835
00:24:54,799 --> 00:24:56,559
revolutionary concept right

836
00:24:56,559 --> 00:24:58,480
it's so fascinating to see things like

837
00:24:58,480 --> 00:25:00,240
say

838
00:25:00,240 --> 00:25:03,279
carbon black or end game an organization

839
00:25:03,279 --> 00:25:04,559
buys these things and they're

840
00:25:04,559 --> 00:25:06,880
endpoint detection response capabilities

841
00:25:06,880 --> 00:25:08,240
but while these organizations put them

842
00:25:08,240 --> 00:25:09,039
on their endpoints

843
00:25:09,039 --> 00:25:11,200
they never use them to detect and after

844
00:25:11,200 --> 00:25:12,640
that thing detects they never actually

845
00:25:12,640 --> 00:25:13,440
respond

846
00:25:13,440 --> 00:25:15,279
to what's been detected i mean it's

847
00:25:15,279 --> 00:25:16,799
literally in the name

848
00:25:16,799 --> 00:25:18,720
but so for our more advanced defenders

849
00:25:18,720 --> 00:25:20,400
they are actually using these tools

850
00:25:20,400 --> 00:25:22,240
the way that they can be most effective

851
00:25:22,240 --> 00:25:25,520
in enabling them to have

852
00:25:25,520 --> 00:25:28,000
situational awareness of what's going on

853
00:25:28,000 --> 00:25:30,080
on their environment itself

854
00:25:30,080 --> 00:25:33,120
and so as a result attackers

855
00:25:33,120 --> 00:25:35,200
red teamers like myself we've had to

856
00:25:35,200 --> 00:25:36,240
change the game

857
00:25:36,240 --> 00:25:37,760
because if i'm using metasploit and it

858
00:25:37,760 --> 00:25:40,000
triggers antivirus i can't know i can no

859
00:25:40,000 --> 00:25:42,080
longer rely on nobody going there to

860
00:25:42,080 --> 00:25:44,080
actually look at what's happening

861
00:25:44,080 --> 00:25:46,240
plus these antivirus vendors may have

862
00:25:46,240 --> 00:25:47,600
actually created or these not

863
00:25:47,600 --> 00:25:48,720
just antivirus vendors but these

864
00:25:48,720 --> 00:25:50,559
endpoint detection response vendors have

865
00:25:50,559 --> 00:25:51,600
created so many

866
00:25:51,600 --> 00:25:54,080
uh trigger opportunities that while they

867
00:25:54,080 --> 00:25:56,000
might not block my malware

868
00:25:56,000 --> 00:25:58,880
they will almost certainly alert at some

869
00:25:58,880 --> 00:26:00,159
degree of severity

870
00:26:00,159 --> 00:26:02,000
the blue team to come look because

871
00:26:02,000 --> 00:26:03,919
something doesn't look right

872
00:26:03,919 --> 00:26:06,240
right and this is what y edr is so

873
00:26:06,240 --> 00:26:07,440
different

874
00:26:07,440 --> 00:26:09,279
fundamentally than antivirus because

875
00:26:09,279 --> 00:26:11,360
antivirus is there to block bad stuff

876
00:26:11,360 --> 00:26:12,880
and we already know it's terrible at

877
00:26:12,880 --> 00:26:14,720
doing that

878
00:26:14,720 --> 00:26:16,960
but edr isn't actually there to block

879
00:26:16,960 --> 00:26:19,360
stuff in fact most edr vendors happen to

880
00:26:19,360 --> 00:26:20,159
have

881
00:26:20,159 --> 00:26:21,840
signatures for malware but that's

882
00:26:21,840 --> 00:26:23,760
because

883
00:26:23,760 --> 00:26:25,200
the people purchasing them the

884
00:26:25,200 --> 00:26:27,200
organizations purchasing those products

885
00:26:27,200 --> 00:26:29,440
expect them to block bad stuff which is

886
00:26:29,440 --> 00:26:30,320
fundamentally

887
00:26:30,320 --> 00:26:31,840
dumb like that is not what they are

888
00:26:31,840 --> 00:26:34,000
there for that is not what we need as

889
00:26:34,000 --> 00:26:34,960
blue teams

890
00:26:34,960 --> 00:26:37,440
uh let antivirus do any of our stuff the

891
00:26:37,440 --> 00:26:38,799
thing that you want with edr

892
00:26:38,799 --> 00:26:40,799
is the ability to detect and respond as

893
00:26:40,799 --> 00:26:42,080
efficiently as possible

894
00:26:42,080 --> 00:26:45,200
as an active defensive blue team and so

895
00:26:45,200 --> 00:26:46,960
while these features do often exist

896
00:26:46,960 --> 00:26:48,880
in edr products we really need to focus

897
00:26:48,880 --> 00:26:51,039
on is that blue team

898
00:26:51,039 --> 00:26:53,679
life cycle around detection and response

899
00:26:53,679 --> 00:26:55,200
and as a result of that

900
00:26:55,200 --> 00:26:57,360
any of the major cyber security uh

901
00:26:57,360 --> 00:26:58,640
services firms like

902
00:26:58,640 --> 00:27:03,039
open security trusted sec um

903
00:27:03,039 --> 00:27:05,600
red siege black hills list goes on in

904
00:27:05,600 --> 00:27:06,320
guardians

905
00:27:06,320 --> 00:27:09,120
we've all had to go out and develop our

906
00:27:09,120 --> 00:27:09,600
own

907
00:27:09,600 --> 00:27:12,080
custom command and control tools and

908
00:27:12,080 --> 00:27:12,880
malware

909
00:27:12,880 --> 00:27:14,960
some have released those tools to the

910
00:27:14,960 --> 00:27:16,400
public other tools

911
00:27:16,400 --> 00:27:18,399
are closed source and we're maintaining

912
00:27:18,399 --> 00:27:20,000
them in-house because we need to

913
00:27:20,000 --> 00:27:21,679
continue to be able to do operations

914
00:27:21,679 --> 00:27:24,080
and we need to overcome the fact that

915
00:27:24,080 --> 00:27:25,360
many of these vendors

916
00:27:25,360 --> 00:27:28,080
are literally watching our projects on

917
00:27:28,080 --> 00:27:28,880
on github

918
00:27:28,880 --> 00:27:30,399
and immediately creating signatures the

919
00:27:30,399 --> 00:27:32,240
moment we push something

920
00:27:32,240 --> 00:27:34,000
to them whereas if we just didn't push

921
00:27:34,000 --> 00:27:35,760
those signatures we would never ever get

922
00:27:35,760 --> 00:27:36,399
caught

923
00:27:36,399 --> 00:27:41,439
for example uh prismatica here is the uh

924
00:27:42,640 --> 00:27:44,640
c2 framework that's created by my

925
00:27:44,640 --> 00:27:45,919
company open security

926
00:27:45,919 --> 00:27:48,399
and there's some remote remote backdoors

927
00:27:48,399 --> 00:27:49,600
and such in there as well

928
00:27:49,600 --> 00:27:51,760
uh that one is though uh open source and

929
00:27:51,760 --> 00:27:53,120
free and on the internet

930
00:27:53,120 --> 00:27:56,159
uh we'll talk about that a little bit um

931
00:27:56,159 --> 00:27:57,919
as well but so what we see here is that

932
00:27:57,919 --> 00:27:59,279
it's actually become a bit of a golden

933
00:27:59,279 --> 00:28:00,840
age of c2 because

934
00:28:00,840 --> 00:28:03,760
defenses have had so much investment put

935
00:28:03,760 --> 00:28:04,240
into them

936
00:28:04,240 --> 00:28:06,399
i believe information security this year

937
00:28:06,399 --> 00:28:08,159
or maybe you know last year was a 70

938
00:28:08,159 --> 00:28:09,679
billion dollar industry

939
00:28:09,679 --> 00:28:13,200
like wow but the thing is that uh

940
00:28:13,200 --> 00:28:16,799
that market capitalization is all on the

941
00:28:16,799 --> 00:28:18,000
defensive side

942
00:28:18,000 --> 00:28:20,080
so like mcafee was bought out several

943
00:28:20,080 --> 00:28:21,039
years ago by

944
00:28:21,039 --> 00:28:23,760
intel for 1.2 billion or something

945
00:28:23,760 --> 00:28:25,200
absurd like that

946
00:28:25,200 --> 00:28:27,679
uh which means that as red teamers what

947
00:28:27,679 --> 00:28:28,640
we're actually doing

948
00:28:28,640 --> 00:28:31,679
is we're operating and competing and

949
00:28:31,679 --> 00:28:33,919
trying to overcome

950
00:28:33,919 --> 00:28:36,159
products that have billions and billions

951
00:28:36,159 --> 00:28:37,919
of dollars invested in them

952
00:28:37,919 --> 00:28:39,679
and so open source projects are just not

953
00:28:39,679 --> 00:28:40,880
going to be able to compete on that

954
00:28:40,880 --> 00:28:41,440
level

955
00:28:41,440 --> 00:28:44,240
so in that context what do we do well

956
00:28:44,240 --> 00:28:45,440
the first thing that we saw the

957
00:28:45,440 --> 00:28:46,640
information security community the red

958
00:28:46,640 --> 00:28:47,600
team community do

959
00:28:47,600 --> 00:28:49,760
is just start releasing massive amounts

960
00:28:49,760 --> 00:28:50,880
of new c2 tools

961
00:28:50,880 --> 00:28:53,360
it's really a golden age of c2 and what

962
00:28:53,360 --> 00:28:54,320
you see here is actually

963
00:28:54,320 --> 00:28:57,039
something called the c2 matrix the c2

964
00:28:57,039 --> 00:28:57,679
matrix

965
00:28:57,679 --> 00:29:02,720
is a a web app that's created by

966
00:29:02,720 --> 00:29:05,679
george ochies he's actually the author

967
00:29:05,679 --> 00:29:06,799
of the security

968
00:29:06,799 --> 00:29:10,480
5 64 and 565 classes with sans on red

969
00:29:10,480 --> 00:29:11,360
teaming

970
00:29:11,360 --> 00:29:13,760
and so this product here goes through a

971
00:29:13,760 --> 00:29:15,039
bunch of different c2

972
00:29:15,039 --> 00:29:17,120
toolkits and helps you decide which ones

973
00:29:17,120 --> 00:29:18,640
are possibly best for your organization

974
00:29:18,640 --> 00:29:19,200
to use

975
00:29:19,200 --> 00:29:21,120
so we see here a bunch of them on the

976
00:29:21,120 --> 00:29:22,640
left hand side we can actually go

977
00:29:22,640 --> 00:29:23,840
through this wizard and ask

978
00:29:23,840 --> 00:29:26,960
the the matrix for um what is probably

979
00:29:26,960 --> 00:29:28,080
possibly gonna be the best

980
00:29:28,080 --> 00:29:30,640
utility for us to use in our actual uh

981
00:29:30,640 --> 00:29:31,919
red team organization

982
00:29:31,919 --> 00:29:33,600
so we could do something like do we need

983
00:29:33,600 --> 00:29:35,520
this to have an exposed api

984
00:29:35,520 --> 00:29:37,679
uh does our c2 framework need to support

985
00:29:37,679 --> 00:29:38,880
multiple users

986
00:29:38,880 --> 00:29:40,880
okay next what kind of channels do we

987
00:29:40,880 --> 00:29:42,559
want to be able to communicate over

988
00:29:42,559 --> 00:29:44,320
uh does it need to be able to operate on

989
00:29:44,320 --> 00:29:45,520
different operating systems well maybe

990
00:29:45,520 --> 00:29:46,559
you want all three

991
00:29:46,559 --> 00:29:48,960
i'll tell you that most of these c2

992
00:29:48,960 --> 00:29:51,120
tools focus on windows for a good reason

993
00:29:51,120 --> 00:29:52,559
active directory domain is where most of

994
00:29:52,559 --> 00:29:53,360
our

995
00:29:53,360 --> 00:29:55,919
engagements rely on some of them do have

996
00:29:55,919 --> 00:29:56,720
linux support

997
00:29:56,720 --> 00:29:58,640
but not a huge number have mac os

998
00:29:58,640 --> 00:30:00,480
support interesting

999
00:30:00,480 --> 00:30:02,240
uh what are the capabilities do we need

1000
00:30:02,240 --> 00:30:03,600
maybe we want to have

1001
00:30:03,600 --> 00:30:06,720
custom profiles on the actual network

1002
00:30:06,720 --> 00:30:08,159
this is going to be really important for

1003
00:30:08,159 --> 00:30:10,000
our conversation on overt operations

1004
00:30:10,000 --> 00:30:10,399
here

1005
00:30:10,399 --> 00:30:12,159
in just a little bit because here we're

1006
00:30:12,159 --> 00:30:14,080
talking about features that a c2

1007
00:30:14,080 --> 00:30:15,120
framework has

1008
00:30:15,120 --> 00:30:17,919
in order to make it more covert we talk

1009
00:30:17,919 --> 00:30:19,600
about overt operations we actually may

1010
00:30:19,600 --> 00:30:20,640
want to be

1011
00:30:20,640 --> 00:30:22,640
louder we'll look at what that seems

1012
00:30:22,640 --> 00:30:24,000
like in just a moment

1013
00:30:24,000 --> 00:30:25,520
so we say it needs to have the ability

1014
00:30:25,520 --> 00:30:27,200
to have custom c2 profiles that allows

1015
00:30:27,200 --> 00:30:27,919
us to control

1016
00:30:27,919 --> 00:30:29,279
how it communicates over the internet

1017
00:30:29,279 --> 00:30:31,520
let's say we're using http communication

1018
00:30:31,520 --> 00:30:33,840
with a custom c2 profile we get to set

1019
00:30:33,840 --> 00:30:34,720
things like

1020
00:30:34,720 --> 00:30:36,159
what the get parameters are going to be

1021
00:30:36,159 --> 00:30:38,000
in the get request and what the server

1022
00:30:38,000 --> 00:30:39,360
is going to respond back with

1023
00:30:39,360 --> 00:30:40,880
so on both sides you can maybe make the

1024
00:30:40,880 --> 00:30:43,120
communication look exactly like it's aws

1025
00:30:43,120 --> 00:30:48,158
or google docs or something like that um

1026
00:30:48,960 --> 00:30:50,640
what kind of uh interface does it need

1027
00:30:50,640 --> 00:30:52,159
to have maybe we want to have a gui or a

1028
00:30:52,159 --> 00:30:53,360
web interface

1029
00:30:53,360 --> 00:30:55,919
uh maybe cscli is good enough for us but

1030
00:30:55,919 --> 00:30:57,120
maybe we want to have some kind of ui

1031
00:30:57,120 --> 00:30:58,720
did most of the advanced c2 frameworks

1032
00:30:58,720 --> 00:31:00,320
these days are starting to have a ui

1033
00:31:00,320 --> 00:31:02,240
which i do feel like is important it can

1034
00:31:02,240 --> 00:31:04,240
have some efficiency improvements there

1035
00:31:04,240 --> 00:31:06,240
but most importantly it's a lot easier

1036
00:31:06,240 --> 00:31:08,880
to get multi-faceted people

1037
00:31:08,880 --> 00:31:12,000
together to form a red team if there's

1038
00:31:12,000 --> 00:31:13,679
some kind of cohesive ui that can be

1039
00:31:13,679 --> 00:31:15,200
shared

1040
00:31:15,200 --> 00:31:17,039
um and then what kind of support i'd say

1041
00:31:17,039 --> 00:31:18,399
we don't care about support too much

1042
00:31:18,399 --> 00:31:20,960
and it lists us here the c2 framework

1043
00:31:20,960 --> 00:31:21,919
tools that are

1044
00:31:21,919 --> 00:31:26,000
potentially going to support our needs

1045
00:31:28,799 --> 00:31:31,120
and prismatic is one of them that's tool

1046
00:31:31,120 --> 00:31:32,000
is up here

1047
00:31:32,000 --> 00:31:33,760
um it's got an api and such and you're

1048
00:31:33,760 --> 00:31:34,880
welcome to take a look at it if you'd

1049
00:31:34,880 --> 00:31:35,519
like to

1050
00:31:35,519 --> 00:31:37,120
um it's the product that's supported by

1051
00:31:37,120 --> 00:31:38,480
open security and it's open source and

1052
00:31:38,480 --> 00:31:40,000
free we're continuously developing it

1053
00:31:40,000 --> 00:31:42,480
over time

1054
00:31:42,559 --> 00:31:46,159
and there you see that all right so in

1055
00:31:46,159 --> 00:31:48,159
the end blue team capabilities are

1056
00:31:48,159 --> 00:31:50,640
very very heavily on the rise at the

1057
00:31:50,640 --> 00:31:52,080
moment and blue teams are getting better

1058
00:31:52,080 --> 00:31:52,480
better

1059
00:31:52,480 --> 00:31:54,720
better day by day but i still see this

1060
00:31:54,720 --> 00:31:55,679
all the time

1061
00:31:55,679 --> 00:31:58,320
um anthony coggins here tweeted this at

1062
00:31:58,320 --> 00:31:58,960
me

1063
00:31:58,960 --> 00:32:01,360
um when i was talking about overt

1064
00:32:01,360 --> 00:32:02,559
operations on twitter

1065
00:32:02,559 --> 00:32:04,000
and he said as a blue team member and

1066
00:32:04,000 --> 00:32:05,600
i've heard this so many times from so

1067
00:32:05,600 --> 00:32:06,240
many people

1068
00:32:06,240 --> 00:32:08,320
but he says as a blue team member we i

1069
00:32:08,320 --> 00:32:10,399
always say we have to get it right 100

1070
00:32:10,399 --> 00:32:11,279
of the time

1071
00:32:11,279 --> 00:32:14,399
red team only needs to get lucky once

1072
00:32:14,399 --> 00:32:17,120
and the thing is he is wrong he is

1073
00:32:17,120 --> 00:32:17,919
really

1074
00:32:17,919 --> 00:32:20,960
really wrong but his position is not

1075
00:32:20,960 --> 00:32:21,840
unique

1076
00:32:21,840 --> 00:32:23,200
so many blue teamers have this

1077
00:32:23,200 --> 00:32:25,360
fatalistic point of view and they say

1078
00:32:25,360 --> 00:32:26,880
i'm going to lose my job at some point

1079
00:32:26,880 --> 00:32:28,559
i've already made my piece with that

1080
00:32:28,559 --> 00:32:30,720
because an attacker is going to get in

1081
00:32:30,720 --> 00:32:32,240
and there you go

1082
00:32:32,240 --> 00:32:34,080
and you know if all of your users on

1083
00:32:34,080 --> 00:32:35,039
your environment are local

1084
00:32:35,039 --> 00:32:35,919
administrators

1085
00:32:35,919 --> 00:32:38,480
then yeah that's probably probably just

1086
00:32:38,480 --> 00:32:39,200
given up

1087
00:32:39,200 --> 00:32:41,600
the uh the ghost at that point but the

1088
00:32:41,600 --> 00:32:42,720
thing is

1089
00:32:42,720 --> 00:32:43,919
let's think about what an attacker has

1090
00:32:43,919 --> 00:32:44,880
to do and where they have to be

1091
00:32:44,880 --> 00:32:46,720
successful they have to

1092
00:32:46,720 --> 00:32:48,720
craft some kind of fishing ruse most

1093
00:32:48,720 --> 00:32:50,000
likely if they're going fishing to get

1094
00:32:50,000 --> 00:32:51,039
in which is the most common way to

1095
00:32:51,039 --> 00:32:52,320
actually get access to networks

1096
00:32:52,320 --> 00:32:55,200
so they craft some fishing roos and they

1097
00:32:55,200 --> 00:32:56,640
send that phishing email to somebody and

1098
00:32:56,640 --> 00:32:57,679
a user clicks on it

1099
00:32:57,679 --> 00:32:59,519
will they eventually get a user to click

1100
00:32:59,519 --> 00:33:01,679
on something yeah yeah they will

1101
00:33:01,679 --> 00:33:03,279
now once that user clicks on something

1102
00:33:03,279 --> 00:33:05,120
they need to uh that click

1103
00:33:05,120 --> 00:33:06,880
needs to cause code execution so the

1104
00:33:06,880 --> 00:33:08,960
attacker can have remote access

1105
00:33:08,960 --> 00:33:11,440
will that work eventually sure sure it

1106
00:33:11,440 --> 00:33:12,559
might

1107
00:33:12,559 --> 00:33:14,000
do we have any detection controls on

1108
00:33:14,000 --> 00:33:15,840
that i hope we have some

1109
00:33:15,840 --> 00:33:16,799
some for things that are getting

1110
00:33:16,799 --> 00:33:19,360
executed and post exploitation as well

1111
00:33:19,360 --> 00:33:21,519
now what now the attacker has access as

1112
00:33:21,519 --> 00:33:23,760
a standard regular user in the domain

1113
00:33:23,760 --> 00:33:26,159
do they start their ransomware campaign

1114
00:33:26,159 --> 00:33:27,679
no of course not

1115
00:33:27,679 --> 00:33:30,799
um i was doing last year a uh incident

1116
00:33:30,799 --> 00:33:32,159
response for an organization that was

1117
00:33:32,159 --> 00:33:33,200
ransomware

1118
00:33:33,200 --> 00:33:36,240
uh the attackers asked for like 2.2

1119
00:33:36,240 --> 00:33:38,399
million dollars

1120
00:33:38,399 --> 00:33:40,000
via bitcoin to extort them for their

1121
00:33:40,000 --> 00:33:42,240
network back they ended up negotiating

1122
00:33:42,240 --> 00:33:44,240
the uh the actual ransomware fee down to

1123
00:33:44,240 --> 00:33:45,840
1.4 million dollars

1124
00:33:45,840 --> 00:33:48,399
which is still obscene but the reason

1125
00:33:48,399 --> 00:33:49,279
they had to pay

1126
00:33:49,279 --> 00:33:50,880
is because they had the company was

1127
00:33:50,880 --> 00:33:52,720
making about 40 million dollars

1128
00:33:52,720 --> 00:33:56,720
in gross revenue year over year and uh

1129
00:33:56,720 --> 00:33:59,919
if they said no they would have had to

1130
00:33:59,919 --> 00:34:01,039
fire all of their employees and they

1131
00:34:01,039 --> 00:34:02,559
would have gone out of business

1132
00:34:02,559 --> 00:34:04,559
because the attacker had everything they

1133
00:34:04,559 --> 00:34:06,000
had all of their source code

1134
00:34:06,000 --> 00:34:07,840
they had all of their workstations all

1135
00:34:07,840 --> 00:34:09,440
other servers it was

1136
00:34:09,440 --> 00:34:12,560
full compromise they got massacred

1137
00:34:12,560 --> 00:34:15,280
and uh so the question was pay 1.4

1138
00:34:15,280 --> 00:34:16,079
million dollars

1139
00:34:16,079 --> 00:34:18,639
or go out of business that's a pretty

1140
00:34:18,639 --> 00:34:20,560
easy question for them to answer

1141
00:34:20,560 --> 00:34:22,879
in that case and so what we have to

1142
00:34:22,879 --> 00:34:24,000
realize though

1143
00:34:24,000 --> 00:34:25,679
is what were the circumstances that

1144
00:34:25,679 --> 00:34:27,599
caused that to happen well their network

1145
00:34:27,599 --> 00:34:29,359
was not particularly secure by any means

1146
00:34:29,359 --> 00:34:30,480
and they had a lot of local

1147
00:34:30,480 --> 00:34:32,000
administrators in all of their systems

1148
00:34:32,000 --> 00:34:34,079
but in spite of that and and their

1149
00:34:34,079 --> 00:34:35,520
domain controller was vulnerable to the

1150
00:34:35,520 --> 00:34:37,040
eternal blue exploit let me throw that

1151
00:34:37,040 --> 00:34:38,800
one out there too

1152
00:34:38,800 --> 00:34:40,239
but in spite of all of that the

1153
00:34:40,239 --> 00:34:42,560
attackers got into the environment

1154
00:34:42,560 --> 00:34:45,359
in november december and then they

1155
00:34:45,359 --> 00:34:47,359
launched their ransomware attack

1156
00:34:47,359 --> 00:34:50,079
in april end of april in fact it was

1157
00:34:50,079 --> 00:34:51,359
almost may

1158
00:34:51,359 --> 00:34:54,320
that's eight months of opportunity to

1159
00:34:54,320 --> 00:34:55,280
detect

1160
00:34:55,280 --> 00:34:57,680
and then to respond and if the attacker

1161
00:34:57,680 --> 00:34:59,520
at any point

1162
00:34:59,520 --> 00:35:01,440
alerts you to their presence allows for

1163
00:35:01,440 --> 00:35:02,960
that detection to happen

1164
00:35:02,960 --> 00:35:05,359
well then you you get to respond that's

1165
00:35:05,359 --> 00:35:07,359
a really big home field advantage the

1166
00:35:07,359 --> 00:35:09,119
blue team has and if we're actually

1167
00:35:09,119 --> 00:35:09,760
looking

1168
00:35:09,760 --> 00:35:12,560
to identify ttp that attackers do and

1169
00:35:12,560 --> 00:35:13,920
we're looking to discover them in a post

1170
00:35:13,920 --> 00:35:15,440
exploitation context

1171
00:35:15,440 --> 00:35:17,920
every single action the attackers take

1172
00:35:17,920 --> 00:35:20,800
every single command that they run

1173
00:35:20,800 --> 00:35:22,720
is an opportunity to detect for that

1174
00:35:22,720 --> 00:35:25,200
same organization we did for them a

1175
00:35:25,200 --> 00:35:27,200
a culminating exercise so we helped

1176
00:35:27,200 --> 00:35:28,560
eradicate the compromise

1177
00:35:28,560 --> 00:35:30,560
we helped train their team we help them

1178
00:35:30,560 --> 00:35:32,400
orchestrate better defense controls and

1179
00:35:32,400 --> 00:35:32,720
do

1180
00:35:32,720 --> 00:35:35,359
uh active detection and active defense

1181
00:35:35,359 --> 00:35:36,240
on their network

1182
00:35:36,240 --> 00:35:37,839
and then we finalized the whole thing in

1183
00:35:37,839 --> 00:35:39,440
february of this year

1184
00:35:39,440 --> 00:35:42,240
with an on-site red team where uh my red

1185
00:35:42,240 --> 00:35:43,280
team was

1186
00:35:43,280 --> 00:35:45,040
compromising their environment and i was

1187
00:35:45,040 --> 00:35:46,480
embedded with the blue team there doing

1188
00:35:46,480 --> 00:35:48,000
say a purple team operations

1189
00:35:48,000 --> 00:35:49,440
where the red team is trying to attack

1190
00:35:49,440 --> 00:35:51,200
and then we're defending and they were

1191
00:35:51,200 --> 00:35:52,480
exceptionally successful

1192
00:35:52,480 --> 00:35:54,800
against uh against even my red teamers

1193
00:35:54,800 --> 00:35:56,160
so

1194
00:35:56,160 --> 00:35:57,839
i'm not too worried about this happening

1195
00:35:57,839 --> 00:35:59,200
to them again in the future and the

1196
00:35:59,200 --> 00:36:00,480
reason for it is

1197
00:36:00,480 --> 00:36:02,079
blue teams have this fatalistic

1198
00:36:02,079 --> 00:36:03,280
perspective where they think they're

1199
00:36:03,280 --> 00:36:04,240
going to lose

1200
00:36:04,240 --> 00:36:06,960
and by thinking it they make it so when

1201
00:36:06,960 --> 00:36:07,599
it comes down

1202
00:36:07,599 --> 00:36:09,599
to it blue team does have the home field

1203
00:36:09,599 --> 00:36:11,760
advantage and as red teamers if we're

1204
00:36:11,760 --> 00:36:14,320
operating on the most well orchestrated

1205
00:36:14,320 --> 00:36:15,920
blue team environments

1206
00:36:15,920 --> 00:36:18,640
we have our work cut out for us really

1207
00:36:18,640 --> 00:36:21,279
really heavily

1208
00:36:22,160 --> 00:36:24,480
and so the thing about that is if let's

1209
00:36:24,480 --> 00:36:26,000
say we're doing a bread team

1210
00:36:26,000 --> 00:36:27,599
and we're using a tool like cobalt

1211
00:36:27,599 --> 00:36:29,920
strike and the cobalt strike

1212
00:36:29,920 --> 00:36:31,200
binary that we're using as a remote

1213
00:36:31,200 --> 00:36:33,440
access tool gets picked up by antivirus

1214
00:36:33,440 --> 00:36:35,920
and we lose to blue team it can be

1215
00:36:35,920 --> 00:36:37,599
really really frustrating

1216
00:36:37,599 --> 00:36:40,320
because well what are we going to do

1217
00:36:40,320 --> 00:36:41,359
about it i can't

1218
00:36:41,359 --> 00:36:43,680
buy a tool that an antivirus vendor

1219
00:36:43,680 --> 00:36:44,960
can't also buy

1220
00:36:44,960 --> 00:36:48,079
and make signatures for so we just

1221
00:36:48,079 --> 00:36:50,240
we're in this weird place where we're

1222
00:36:50,240 --> 00:36:51,839
doing all kinds of operations that we

1223
00:36:51,839 --> 00:36:52,320
know

1224
00:36:52,320 --> 00:36:55,119
an attacker would do and would bypass

1225
00:36:55,119 --> 00:36:55,839
the blue team

1226
00:36:55,839 --> 00:36:57,520
but because we've got certain

1227
00:36:57,520 --> 00:36:59,680
requirements in red team let's say using

1228
00:36:59,680 --> 00:37:01,200
commercial office self tools

1229
00:37:01,200 --> 00:37:04,320
or open source tools we know that we are

1230
00:37:04,320 --> 00:37:05,440
being louder

1231
00:37:05,440 --> 00:37:08,000
than the actual the the actual attack

1232
00:37:08,000 --> 00:37:08,800
groups might be

1233
00:37:08,800 --> 00:37:11,119
who have this 1.4 million dollars to

1234
00:37:11,119 --> 00:37:12,320
potentially gain

1235
00:37:12,320 --> 00:37:14,320
off of a compromise like this and so

1236
00:37:14,320 --> 00:37:15,599
that can be really frustrating when you

1237
00:37:15,599 --> 00:37:16,720
feel like you got caught

1238
00:37:16,720 --> 00:37:19,680
and the blue team won and the reason why

1239
00:37:19,680 --> 00:37:20,560
they won is

1240
00:37:20,560 --> 00:37:23,680
not fair because it wasn't realistic or

1241
00:37:23,680 --> 00:37:24,560
contrived

1242
00:37:24,560 --> 00:37:26,160
there wasn't enough network traffic

1243
00:37:26,160 --> 00:37:28,800
going on it's just not fair right

1244
00:37:28,800 --> 00:37:30,240
well we have to resist that urge we

1245
00:37:30,240 --> 00:37:32,160
really really do because red team is all

1246
00:37:32,160 --> 00:37:32,640
about

1247
00:37:32,640 --> 00:37:34,560
making the blue team better and so if

1248
00:37:34,560 --> 00:37:36,480
they catch our stuff that's outstanding

1249
00:37:36,480 --> 00:37:38,240
now if we identify that they need to be

1250
00:37:38,240 --> 00:37:39,359
better because they wouldn't catch

1251
00:37:39,359 --> 00:37:40,320
something realistic

1252
00:37:40,320 --> 00:37:41,920
we may want to do what's called a white

1253
00:37:41,920 --> 00:37:44,240
card and say okay you caught this

1254
00:37:44,240 --> 00:37:46,400
keep looking for another way that you

1255
00:37:46,400 --> 00:37:47,920
could catch this let that one go and

1256
00:37:47,920 --> 00:37:48,800
pretend that you're

1257
00:37:48,800 --> 00:37:50,720
not seeing that let's threshold that for

1258
00:37:50,720 --> 00:37:51,920
a little while see what else you can

1259
00:37:51,920 --> 00:37:52,400
detect

1260
00:37:52,400 --> 00:37:54,400
so we can do those kind of things but

1261
00:37:54,400 --> 00:37:56,560
the other way we may consider this is

1262
00:37:56,560 --> 00:37:58,800
if the blue team can see everything

1263
00:37:58,800 --> 00:38:00,000
because their orchestration is really

1264
00:38:00,000 --> 00:38:00,640
good

1265
00:38:00,640 --> 00:38:03,920
what if instead of trying to go more

1266
00:38:03,920 --> 00:38:04,720
covert

1267
00:38:04,720 --> 00:38:07,440
so that there's less for them to see

1268
00:38:07,440 --> 00:38:08,400
what if

1269
00:38:08,400 --> 00:38:10,640
we do the opposite and we go really

1270
00:38:10,640 --> 00:38:12,640
really overt

1271
00:38:12,640 --> 00:38:14,720
so that when they look at their network

1272
00:38:14,720 --> 00:38:16,079
it looks like their network

1273
00:38:16,079 --> 00:38:18,480
has exploded it looks like the attacker

1274
00:38:18,480 --> 00:38:19,280
is

1275
00:38:19,280 --> 00:38:21,920
everywhere everywhere everywhere and if

1276
00:38:21,920 --> 00:38:22,880
it looks like we're

1277
00:38:22,880 --> 00:38:25,280
everywhere what can the blue team

1278
00:38:25,280 --> 00:38:26,960
possibly do

1279
00:38:26,960 --> 00:38:30,000
to detect or respond to the very

1280
00:38:30,000 --> 00:38:31,359
specific place

1281
00:38:31,359 --> 00:38:33,680
and specific actions that we actually

1282
00:38:33,680 --> 00:38:35,040
want to accomplish

1283
00:38:35,040 --> 00:38:36,960
we're talking here about creating some

1284
00:38:36,960 --> 00:38:39,200
kind of fog of war effect

1285
00:38:39,200 --> 00:38:42,640
so that the defenders see all of this

1286
00:38:42,640 --> 00:38:44,160
action going on in their network but

1287
00:38:44,160 --> 00:38:45,839
don't have the ability to respond to

1288
00:38:45,839 --> 00:38:47,440
what we're actually doing

1289
00:38:47,440 --> 00:38:48,960
here's an example of a little bit

1290
00:38:48,960 --> 00:38:50,400
something like that this is uh me

1291
00:38:50,400 --> 00:38:51,359
teaching at the

1292
00:38:51,359 --> 00:38:53,760
uh tbt 570 class we do with sans which

1293
00:38:53,760 --> 00:38:55,119
is red force versus blue force where i

1294
00:38:55,119 --> 00:38:56,079
play the red team

1295
00:38:56,079 --> 00:38:58,240
and then uh the students are all

1296
00:38:58,240 --> 00:39:00,000
different groups of the blue team

1297
00:39:00,000 --> 00:39:01,520
and they have to defend this environment

1298
00:39:01,520 --> 00:39:03,040
against an attack campaign

1299
00:39:03,040 --> 00:39:06,240
this is uh campaign

1300
00:39:06,240 --> 00:39:08,560
b i think um and if you notice here

1301
00:39:08,560 --> 00:39:10,079
that's cobalt strike

1302
00:39:10,079 --> 00:39:12,160
as a screenshot behind the scenes and

1303
00:39:12,160 --> 00:39:13,680
all of their systems are beating out to

1304
00:39:13,680 --> 00:39:14,000
me

1305
00:39:14,000 --> 00:39:15,520
but am i doing operations on all of them

1306
00:39:15,520 --> 00:39:17,520
simultaneously or

1307
00:39:17,520 --> 00:39:19,599
is the tool on the left hand side which

1308
00:39:19,599 --> 00:39:21,280
is not cobalt strike

1309
00:39:21,280 --> 00:39:23,359
the actual remote access tool that i'm

1310
00:39:23,359 --> 00:39:24,800
using in order to

1311
00:39:24,800 --> 00:39:26,000
compromise the environment and

1312
00:39:26,000 --> 00:39:28,560
accomplish my objectives where cobalt

1313
00:39:28,560 --> 00:39:29,760
strike exists

1314
00:39:29,760 --> 00:39:31,760
just to get them focused on it these

1315
00:39:31,760 --> 00:39:33,200
coal strikes a little bit louder there

1316
00:39:33,200 --> 00:39:34,800
are signatures for it if you seem like

1317
00:39:34,800 --> 00:39:36,240
end game it might really focus in on

1318
00:39:36,240 --> 00:39:37,040
cobalt strike

1319
00:39:37,040 --> 00:39:38,560
so while they're spinning their wheels

1320
00:39:38,560 --> 00:39:40,880
focusing on all of these loud signatures

1321
00:39:40,880 --> 00:39:42,880
that sure could potentially be bad we're

1322
00:39:42,880 --> 00:39:44,320
actually accomplishing our

1323
00:39:44,320 --> 00:39:46,560
envir our operations our covert

1324
00:39:46,560 --> 00:39:47,680
operations

1325
00:39:47,680 --> 00:39:50,480
external to the overt noise that we're

1326
00:39:50,480 --> 00:39:51,040
creating

1327
00:39:51,040 --> 00:39:53,040
inside the environment and so if we want

1328
00:39:53,040 --> 00:39:55,280
to orchestrate an attack campaign

1329
00:39:55,280 --> 00:39:57,520
in this context we have to reverse

1330
00:39:57,520 --> 00:39:58,720
engineer the blue team

1331
00:39:58,720 --> 00:40:00,480
and the blue team essentially does

1332
00:40:00,480 --> 00:40:02,240
detection and then

1333
00:40:02,240 --> 00:40:05,200
response and on the detection side the

1334
00:40:05,200 --> 00:40:06,640
way that we tend to operate in order to

1335
00:40:06,640 --> 00:40:08,640
avoid detection or to operate

1336
00:40:08,640 --> 00:40:11,200
in the detection window of blue team is

1337
00:40:11,200 --> 00:40:13,200
we try to be more and more covert

1338
00:40:13,200 --> 00:40:14,800
or alternatively something we're not

1339
00:40:14,800 --> 00:40:16,319
going to talk about today

1340
00:40:16,319 --> 00:40:18,880
but alternatively we could attack the

1341
00:40:18,880 --> 00:40:20,400
blue team defenses

1342
00:40:20,400 --> 00:40:23,680
to um to disrupt

1343
00:40:23,680 --> 00:40:26,880
their detection capability

1344
00:40:26,880 --> 00:40:28,560
for example if i'm trying to do really

1345
00:40:28,560 --> 00:40:30,240
hardcore covert operations

1346
00:40:30,240 --> 00:40:31,839
and i get onto a system one of the first

1347
00:40:31,839 --> 00:40:33,240
things i'll probably do is kill

1348
00:40:33,240 --> 00:40:35,359
splunkd.exe if they're using splunk

1349
00:40:35,359 --> 00:40:37,280
as their sim because now suddenly that

1350
00:40:37,280 --> 00:40:39,200
system is no longer responding

1351
00:40:39,200 --> 00:40:41,119
and then we'll do whatever operations we

1352
00:40:41,119 --> 00:40:42,640
want and then probably turn

1353
00:40:42,640 --> 00:40:44,960
splunk back on so that they can't tell

1354
00:40:44,960 --> 00:40:45,920
that they're

1355
00:40:45,920 --> 00:40:48,079
that the system is actually down and has

1356
00:40:48,079 --> 00:40:49,040
stopped responding it looks like the

1357
00:40:49,040 --> 00:40:50,319
system started responding again

1358
00:40:50,319 --> 00:40:51,680
and now it's just missing the logs that

1359
00:40:51,680 --> 00:40:54,079
were potentially at risk

1360
00:40:54,079 --> 00:40:56,079
so we can attack their network defenses

1361
00:40:56,079 --> 00:40:57,200
as well there are a large number of

1362
00:40:57,200 --> 00:40:58,560
things you can do to attack network

1363
00:40:58,560 --> 00:40:59,440
defenses

1364
00:40:59,440 --> 00:41:01,839
for example with edr products if you use

1365
00:41:01,839 --> 00:41:02,960
local firewalls

1366
00:41:02,960 --> 00:41:06,000
or art cache tables you can prevent the

1367
00:41:06,000 --> 00:41:08,640
edrs from communicating with the actual

1368
00:41:08,640 --> 00:41:09,920
endpoints and if they can't communicate

1369
00:41:09,920 --> 00:41:11,760
with the endpoints they can't alert the

1370
00:41:11,760 --> 00:41:13,040
defensive team either so there's

1371
00:41:13,040 --> 00:41:14,400
actually a lot that you can do

1372
00:41:14,400 --> 00:41:15,839
from the perspective of attacking

1373
00:41:15,839 --> 00:41:17,920
network defenses and network controls

1374
00:41:17,920 --> 00:41:20,960
as the red team in order to degrade the

1375
00:41:20,960 --> 00:41:21,920
blue team's

1376
00:41:21,920 --> 00:41:23,920
detection capability and so if we're

1377
00:41:23,920 --> 00:41:24,960
operating in the

1378
00:41:24,960 --> 00:41:28,000
detection uh the counter detection

1379
00:41:28,000 --> 00:41:29,280
standpoint of things there are some

1380
00:41:29,280 --> 00:41:31,760
things we can do now on the response

1381
00:41:31,760 --> 00:41:33,119
thing like they've found us at this

1382
00:41:33,119 --> 00:41:33,599
point

1383
00:41:33,599 --> 00:41:35,760
and they want to respond there's a

1384
00:41:35,760 --> 00:41:37,040
couple things you can do as well

1385
00:41:37,040 --> 00:41:38,800
because the thing is with detection and

1386
00:41:38,800 --> 00:41:40,480
response that cycle

1387
00:41:40,480 --> 00:41:42,400
for the blue team their objective as a

1388
00:41:42,400 --> 00:41:44,640
blue team is to detect the attack

1389
00:41:44,640 --> 00:41:46,319
and respond to the attack before the

1390
00:41:46,319 --> 00:41:48,240
attacker delivers effects

1391
00:41:48,240 --> 00:41:50,000
like let's say the ransomware for

1392
00:41:50,000 --> 00:41:51,599
example that company that i gave as an

1393
00:41:51,599 --> 00:41:52,720
example here where they were ransom for

1394
00:41:52,720 --> 00:41:53,760
1.4 million dollars

1395
00:41:53,760 --> 00:41:56,640
if they had responded at any point

1396
00:41:56,640 --> 00:41:59,119
before the ransomware hit

1397
00:41:59,119 --> 00:42:01,520
it's no big deal right it's either 1.4

1398
00:42:01,520 --> 00:42:02,319
million dollars

1399
00:42:02,319 --> 00:42:04,480
or nothing because if they can respond

1400
00:42:04,480 --> 00:42:06,560
before the effect gets delivered

1401
00:42:06,560 --> 00:42:07,520
it doesn't matter that they were

1402
00:42:07,520 --> 00:42:09,040
compromised this is another thing that

1403
00:42:09,040 --> 00:42:10,560
blue teams don't realize it doesn't

1404
00:42:10,560 --> 00:42:11,920
matter that you're compromised

1405
00:42:11,920 --> 00:42:13,760
what matters is that you can respond

1406
00:42:13,760 --> 00:42:14,960
before the attacker

1407
00:42:14,960 --> 00:42:17,599
delivers their effect be it ransomware

1408
00:42:17,599 --> 00:42:19,040
be it data theft

1409
00:42:19,040 --> 00:42:21,440
whatever it might be and so as the

1410
00:42:21,440 --> 00:42:22,160
attacker

1411
00:42:22,160 --> 00:42:24,480
if we want to be successful during the

1412
00:42:24,480 --> 00:42:25,520
response

1413
00:42:25,520 --> 00:42:27,599
we can hack faster so if they've

1414
00:42:27,599 --> 00:42:29,119
detected us and they're in the process

1415
00:42:29,119 --> 00:42:30,000
of responding

1416
00:42:30,000 --> 00:42:33,359
but we are able to be more efficient or

1417
00:42:33,359 --> 00:42:34,880
to speed through the network

1418
00:42:34,880 --> 00:42:37,280
and deliver our effects faster than the

1419
00:42:37,280 --> 00:42:38,800
blue team is able to respond

1420
00:42:38,800 --> 00:42:42,400
then we still win okay now alternatively

1421
00:42:42,400 --> 00:42:44,880
what about the blue team's resources

1422
00:42:44,880 --> 00:42:47,599
what if we give them more to respond

1423
00:42:47,599 --> 00:42:50,480
to so the thing is attackers have been

1424
00:42:50,480 --> 00:42:50,880
doing

1425
00:42:50,880 --> 00:42:53,359
all kinds of denial of service attacks

1426
00:42:53,359 --> 00:42:55,280
for eons and eons neons

1427
00:42:55,280 --> 00:42:57,040
and by eons i mean computers have been

1428
00:42:57,040 --> 00:42:59,760
around for eons right

1429
00:42:59,760 --> 00:43:02,000
so attackers have been doing these kinds

1430
00:43:02,000 --> 00:43:03,599
of attacks like sin flood attacks right

1431
00:43:03,599 --> 00:43:05,359
sin flood is a denial of service attack

1432
00:43:05,359 --> 00:43:06,880
generally it's a distributed denial of

1433
00:43:06,880 --> 00:43:08,000
service tax you're doing it for multiple

1434
00:43:08,000 --> 00:43:08,720
different hosts

1435
00:43:08,720 --> 00:43:11,119
but the objective there is to exhaust

1436
00:43:11,119 --> 00:43:12,640
all of the resources

1437
00:43:12,640 --> 00:43:14,960
for that remote host generally a website

1438
00:43:14,960 --> 00:43:15,839
or something right

1439
00:43:15,839 --> 00:43:17,599
so it's a website and we're doing a sin

1440
00:43:17,599 --> 00:43:19,359
flood attack because we're anonymous and

1441
00:43:19,359 --> 00:43:21,200
anonymous has just come back

1442
00:43:21,200 --> 00:43:23,280
uh okay and so they're doing this in

1443
00:43:23,280 --> 00:43:24,960
flood attack what is their objective

1444
00:43:24,960 --> 00:43:27,040
they don't really hack into the box all

1445
00:43:27,040 --> 00:43:28,000
they're doing

1446
00:43:28,000 --> 00:43:31,040
is over utilizing all the resources that

1447
00:43:31,040 --> 00:43:32,560
are available to that system and now the

1448
00:43:32,560 --> 00:43:34,160
system is no longer available

1449
00:43:34,160 --> 00:43:36,720
but we have to think of blue team itself

1450
00:43:36,720 --> 00:43:37,920
as a resource

1451
00:43:37,920 --> 00:43:39,839
because if we can exhaust all of the

1452
00:43:39,839 --> 00:43:41,359
blue team's resources

1453
00:43:41,359 --> 00:43:42,880
then we've essentially done a denial of

1454
00:43:42,880 --> 00:43:44,880
service attack against the blue team

1455
00:43:44,880 --> 00:43:47,119
themselves and this is what we're

1456
00:43:47,119 --> 00:43:48,640
talking about we talk about over

1457
00:43:48,640 --> 00:43:52,160
operations so we look at over operations

1458
00:43:52,160 --> 00:43:54,160
and we look at the covert to overt

1459
00:43:54,160 --> 00:43:55,280
continuum

1460
00:43:55,280 --> 00:43:56,640
we can of course if you want to be more

1461
00:43:56,640 --> 00:43:58,640
covert we can slow things down

1462
00:43:58,640 --> 00:44:01,119
if we want to uh stay underneath weeds

1463
00:44:01,119 --> 00:44:02,079
we can do that

1464
00:44:02,079 --> 00:44:03,839
targeting of network detection controls

1465
00:44:03,839 --> 00:44:05,119
and attack those

1466
00:44:05,119 --> 00:44:07,040
more overt is to hack faster right we're

1467
00:44:07,040 --> 00:44:08,720
going to be louder we acknowledge that

1468
00:44:08,720 --> 00:44:09,920
these are over operations

1469
00:44:09,920 --> 00:44:12,160
but what we're taking a gamble into is

1470
00:44:12,160 --> 00:44:13,839
we're gambling that we're going to be

1471
00:44:13,839 --> 00:44:15,359
able to hack fast enough

1472
00:44:15,359 --> 00:44:17,920
to hack faster than they can respond and

1473
00:44:17,920 --> 00:44:20,000
then finally with blue team resource

1474
00:44:20,000 --> 00:44:22,400
exhaustion we are being very overt

1475
00:44:22,400 --> 00:44:24,000
because our objective there is to give

1476
00:44:24,000 --> 00:44:24,640
them so

1477
00:44:24,640 --> 00:44:27,520
much to respond to really overt that

1478
00:44:27,520 --> 00:44:28,880
they can't actually respond

1479
00:44:28,880 --> 00:44:32,560
to the things that matter the most um

1480
00:44:32,560 --> 00:44:34,000
and so if you look at the timeline here

1481
00:44:34,000 --> 00:44:36,640
we can compress or stretch

1482
00:44:36,640 --> 00:44:39,200
these different components of the blue

1483
00:44:39,200 --> 00:44:40,400
team's detection

1484
00:44:40,400 --> 00:44:42,400
and response capability and so all of

1485
00:44:42,400 --> 00:44:43,839
the operations that we as red team

1486
00:44:43,839 --> 00:44:45,599
perform within this continuum

1487
00:44:45,599 --> 00:44:47,359
their objective is to either stretch

1488
00:44:47,359 --> 00:44:49,359
that detection response window

1489
00:44:49,359 --> 00:44:52,560
or to compress our operations

1490
00:44:52,560 --> 00:44:57,520
into that window so they fit within it

1491
00:44:57,520 --> 00:44:59,359
and so if we want to target the blue

1492
00:44:59,359 --> 00:45:00,640
team directly

1493
00:45:00,640 --> 00:45:02,480
we have to think about how they do

1494
00:45:02,480 --> 00:45:04,640
operations so we need to break down and

1495
00:45:04,640 --> 00:45:05,359
deconstruct

1496
00:45:05,359 --> 00:45:08,000
their security operation center in order

1497
00:45:08,000 --> 00:45:09,200
to do things like

1498
00:45:09,200 --> 00:45:11,920
uh identify what we want to do to

1499
00:45:11,920 --> 00:45:13,760
resource to exhaust those resources for

1500
00:45:13,760 --> 00:45:15,520
example most organizations have

1501
00:45:15,520 --> 00:45:18,079
a host team and they have a network team

1502
00:45:18,079 --> 00:45:19,920
and if we're exhausting the network team

1503
00:45:19,920 --> 00:45:21,680
but we haven't done the host team then

1504
00:45:21,680 --> 00:45:23,119
we might actually still be losing

1505
00:45:23,119 --> 00:45:26,160
so we want to deconstruct their actual

1506
00:45:26,160 --> 00:45:28,480
operations and then perform exhaustion

1507
00:45:28,480 --> 00:45:30,880
attacks against all of those components

1508
00:45:30,880 --> 00:45:33,440
so for example we might go back to

1509
00:45:33,440 --> 00:45:35,040
exactly we talked about the c2 tools

1510
00:45:35,040 --> 00:45:35,599
right

1511
00:45:35,599 --> 00:45:37,920
we wanted to find for a covert operation

1512
00:45:37,920 --> 00:45:39,040
c2 framework

1513
00:45:39,040 --> 00:45:41,119
a c2 framework that lets us do custom

1514
00:45:41,119 --> 00:45:43,119
profiles well what if you do

1515
00:45:43,119 --> 00:45:46,240
the cobalt strike default profile most

1516
00:45:46,240 --> 00:45:48,319
intrusion detection systems

1517
00:45:48,319 --> 00:45:50,319
i hope all of them but most detection

1518
00:45:50,319 --> 00:45:52,000
systems

1519
00:45:52,000 --> 00:45:54,560
will trigger an alert that says c2 tool

1520
00:45:54,560 --> 00:45:55,280
detected

1521
00:45:55,280 --> 00:45:56,720
if you're running cobol strike in

1522
00:45:56,720 --> 00:45:58,640
default modes so generally speaking as

1523
00:45:58,640 --> 00:45:59,359
an attacker

1524
00:45:59,359 --> 00:46:01,839
we're thinking about covert so we want

1525
00:46:01,839 --> 00:46:03,119
to modify everything and do everything

1526
00:46:03,119 --> 00:46:03,760
custom

1527
00:46:03,760 --> 00:46:05,920
but what if we just take cobalt strike

1528
00:46:05,920 --> 00:46:07,760
and we plant it on all of the systems in

1529
00:46:07,760 --> 00:46:08,480
the environment

1530
00:46:08,480 --> 00:46:10,400
and we don't even care if they find the

1531
00:46:10,400 --> 00:46:12,560
c2 servers because we're not using them

1532
00:46:12,560 --> 00:46:15,040
the only thing we care about is your ids

1533
00:46:15,040 --> 00:46:16,319
is telling you that there's

1534
00:46:16,319 --> 00:46:18,160
outbound attack traffic from your

1535
00:46:18,160 --> 00:46:20,160
environment go look at

1536
00:46:20,160 --> 00:46:22,079
hosts one through five thousand because

1537
00:46:22,079 --> 00:46:24,000
they're all doing it

1538
00:46:24,000 --> 00:46:27,280
um we don't want to be slow here

1539
00:46:27,280 --> 00:46:28,960
right so we're looking at over to covert

1540
00:46:28,960 --> 00:46:30,720
continuum instead of hacking slow we

1541
00:46:30,720 --> 00:46:31,440
want to hack

1542
00:46:31,440 --> 00:46:33,440
faster or at least make it appear like

1543
00:46:33,440 --> 00:46:34,800
we're hacking faster so we want to have

1544
00:46:34,800 --> 00:46:35,760
these beacon intervals

1545
00:46:35,760 --> 00:46:38,000
be really really loud what you see on

1546
00:46:38,000 --> 00:46:39,040
the right hand side

1547
00:46:39,040 --> 00:46:40,640
is a tool called ai hunter which is

1548
00:46:40,640 --> 00:46:42,079
really good at discovering beaconing

1549
00:46:42,079 --> 00:46:43,119
based malware

1550
00:46:43,119 --> 00:46:44,560
we want to make it really easy to

1551
00:46:44,560 --> 00:46:46,960
discover an ai hunter because we want

1552
00:46:46,960 --> 00:46:48,880
not to hide in the noise we want to

1553
00:46:48,880 --> 00:46:50,000
create noise

1554
00:46:50,000 --> 00:46:52,319
to actually hide ourselves in so it

1555
00:46:52,319 --> 00:46:54,240
looks like all of our outbound

1556
00:46:54,240 --> 00:46:57,280
stuff is beaconing really rapidly um

1557
00:46:57,280 --> 00:46:58,800
we can also spoof these this is actually

1558
00:46:58,800 --> 00:47:01,520
really really really cool um

1559
00:47:01,520 --> 00:47:02,960
when people first get interface security

1560
00:47:02,960 --> 00:47:04,000
they're like oh yeah you can spoof your

1561
00:47:04,000 --> 00:47:04,880
ip

1562
00:47:04,880 --> 00:47:06,319
but when it comes down to it that's not

1563
00:47:06,319 --> 00:47:08,000
exactly true

1564
00:47:08,000 --> 00:47:09,440
because if we're looking at a protocol

1565
00:47:09,440 --> 00:47:11,920
like tcp tcp is connection oriented

1566
00:47:11,920 --> 00:47:12,960
right it's stateful

1567
00:47:12,960 --> 00:47:14,640
so you send a syn packet in you get a

1568
00:47:14,640 --> 00:47:17,759
synack um

1569
00:47:18,480 --> 00:47:19,599
and then you acknowledge that you

1570
00:47:19,599 --> 00:47:20,800
receive that syntax and now you've

1571
00:47:20,800 --> 00:47:22,319
established through a handshake and then

1572
00:47:22,319 --> 00:47:24,000
you send data via like push push push

1573
00:47:24,000 --> 00:47:26,640
messages and so on okay this means that

1574
00:47:26,640 --> 00:47:27,680
you have to track that

1575
00:47:27,680 --> 00:47:29,280
session state which is done by the

1576
00:47:29,280 --> 00:47:30,800
sequence numbers in tcp

1577
00:47:30,800 --> 00:47:32,319
so you can't actually spoof your ip

1578
00:47:32,319 --> 00:47:34,559
address because when the target system

1579
00:47:34,559 --> 00:47:37,760
responds to that spoofed message the

1580
00:47:37,760 --> 00:47:39,359
system that received it

1581
00:47:39,359 --> 00:47:41,119
needs to or it's going to have to

1582
00:47:41,119 --> 00:47:42,559
respond with the sequence numbers that

1583
00:47:42,559 --> 00:47:43,839
are calculated based on

1584
00:47:43,839 --> 00:47:45,839
the first senate received and will only

1585
00:47:45,839 --> 00:47:47,520
accept that final act if the sequence

1586
00:47:47,520 --> 00:47:48,559
numbers match as well

1587
00:47:48,559 --> 00:47:50,000
so you actually need to understand both

1588
00:47:50,000 --> 00:47:52,000
sides but the thing is if we're doing

1589
00:47:52,000 --> 00:47:55,280
um attack operations we can spoof both

1590
00:47:55,280 --> 00:47:56,160
sides

1591
00:47:56,160 --> 00:47:59,119
because we can fake both of them so we

1592
00:47:59,119 --> 00:48:01,359
can spoof from inside the environment

1593
00:48:01,359 --> 00:48:03,200
and then spoof the responses that come

1594
00:48:03,200 --> 00:48:04,960
back in them from wherever we would like

1595
00:48:04,960 --> 00:48:06,640
so let's say i have a c2 ip address

1596
00:48:06,640 --> 00:48:07,680
that's on azure

1597
00:48:07,680 --> 00:48:10,800
i can spoof any ip address response

1598
00:48:10,800 --> 00:48:13,119
on the outside as well as the inside so

1599
00:48:13,119 --> 00:48:14,319
let's say on the inside i've got my

1600
00:48:14,319 --> 00:48:15,440
little spoofing tool

1601
00:48:15,440 --> 00:48:16,800
and maybe i'm using escape before it and

1602
00:48:16,800 --> 00:48:18,880
i send a syn packet out to an ip address

1603
00:48:18,880 --> 00:48:19,599
on the internet

1604
00:48:19,599 --> 00:48:21,599
that doesn't have a host that's up just

1605
00:48:21,599 --> 00:48:23,599
any random ip address okay

1606
00:48:23,599 --> 00:48:26,400
now on my azure side right the one that

1607
00:48:26,400 --> 00:48:27,680
is really my c2 tool

1608
00:48:27,680 --> 00:48:29,680
i can spoof a response because i

1609
00:48:29,680 --> 00:48:31,680
actually know what the sequence numbers

1610
00:48:31,680 --> 00:48:32,319
are

1611
00:48:32,319 --> 00:48:34,559
from the original sin message and the

1612
00:48:34,559 --> 00:48:36,400
send message is going to receive that

1613
00:48:36,400 --> 00:48:37,599
and it's going to be able to send back

1614
00:48:37,599 --> 00:48:39,440
that act so we can actually spoof all

1615
00:48:39,440 --> 00:48:40,319
sides of this

1616
00:48:40,319 --> 00:48:41,680
the thing is we won't actually get the

1617
00:48:41,680 --> 00:48:43,520
results the traffic but if we're doing

1618
00:48:43,520 --> 00:48:45,359
overt operations we don't care about the

1619
00:48:45,359 --> 00:48:47,440
results of traffic this isn't real c2

1620
00:48:47,440 --> 00:48:49,119
this just looks for all intents and

1621
00:48:49,119 --> 00:48:51,200
purposes like real c2

1622
00:48:51,200 --> 00:48:52,720
which means we can make it look like

1623
00:48:52,720 --> 00:48:54,880
your environment is being compromised

1624
00:48:54,880 --> 00:48:57,599
by hundreds of thousands of remote c2

1625
00:48:57,599 --> 00:48:58,240
servers

1626
00:48:58,240 --> 00:49:00,480
simultaneously by spoofing both sides of

1627
00:49:00,480 --> 00:49:01,520
the communication

1628
00:49:01,520 --> 00:49:02,720
really really quickly and easier

1629
00:49:02,720 --> 00:49:04,720
environment and so on the network side

1630
00:49:04,720 --> 00:49:05,119
most

1631
00:49:05,119 --> 00:49:07,200
organizations they tend to be very very

1632
00:49:07,200 --> 00:49:08,400
network focused

1633
00:49:08,400 --> 00:49:10,559
in their defensive strategies and on the

1634
00:49:10,559 --> 00:49:11,839
network side they're going to want to

1635
00:49:11,839 --> 00:49:13,680
put in firewall rules but they can't put

1636
00:49:13,680 --> 00:49:15,920
in viral rules for the entire internet

1637
00:49:15,920 --> 00:49:16,480
and if we

1638
00:49:16,480 --> 00:49:18,960
spoof to make it look like the c2

1639
00:49:18,960 --> 00:49:19,760
addresses

1640
00:49:19,760 --> 00:49:23,359
are every host in the entire internet

1641
00:49:23,359 --> 00:49:25,599
well their network team is immediately

1642
00:49:25,599 --> 00:49:27,359
compromised and their resources are

1643
00:49:27,359 --> 00:49:28,160
exhausted

1644
00:49:28,160 --> 00:49:31,200
so our real c2 is now

1645
00:49:31,200 --> 00:49:32,960
much more effective because they can no

1646
00:49:32,960 --> 00:49:34,960
longer detect and respond to

1647
00:49:34,960 --> 00:49:37,599
it because their use or their resources

1648
00:49:37,599 --> 00:49:39,359
are now over utilized

1649
00:49:39,359 --> 00:49:40,720
here's an example of one of the tools

1650
00:49:40,720 --> 00:49:42,000
they might use to do some of this

1651
00:49:42,000 --> 00:49:43,520
detection this here is

1652
00:49:43,520 --> 00:49:45,119
elk stack this is actually via the

1653
00:49:45,119 --> 00:49:46,800
security onion version and so the

1654
00:49:46,800 --> 00:49:48,240
network team may be relying on something

1655
00:49:48,240 --> 00:49:48,880
like this

1656
00:49:48,880 --> 00:49:51,680
our objective is to fill this with bogus

1657
00:49:51,680 --> 00:49:52,559
information

1658
00:49:52,559 --> 00:49:54,240
such that the actual attack information

1659
00:49:54,240 --> 00:49:56,160
that we're looking for is no longer

1660
00:49:56,160 --> 00:49:57,200
easily discernible

1661
00:49:57,200 --> 00:49:58,960
because it's full of all kinds of other

1662
00:49:58,960 --> 00:50:00,960
things that look like really bad attacks

1663
00:50:00,960 --> 00:50:02,480
that need to be responded to

1664
00:50:02,480 --> 00:50:03,599
and so the other side of that is going

1665
00:50:03,599 --> 00:50:05,599
to be host operations they might be

1666
00:50:05,599 --> 00:50:06,720
using say

1667
00:50:06,720 --> 00:50:09,200
splunk senders to get host event logs

1668
00:50:09,200 --> 00:50:09,760
they might

1669
00:50:09,760 --> 00:50:12,720
be using something like say uh silence

1670
00:50:12,720 --> 00:50:14,559
so here we see host logs

1671
00:50:14,559 --> 00:50:18,079
silence crowdstrike edrs

1672
00:50:18,079 --> 00:50:19,839
we want to fill the logs of all of these

1673
00:50:19,839 --> 00:50:22,000
systems as well in order to cause over

1674
00:50:22,000 --> 00:50:23,599
utilization of the host

1675
00:50:23,599 --> 00:50:24,960
so that means if we want to make

1676
00:50:24,960 --> 00:50:27,280
everyone think that we ran

1677
00:50:27,280 --> 00:50:28,880
mimi cats on a system so they have to

1678
00:50:28,880 --> 00:50:30,960
respond to that we don't actually need

1679
00:50:30,960 --> 00:50:32,160
to run mimikats

1680
00:50:32,160 --> 00:50:34,240
all we need to do is create an event log

1681
00:50:34,240 --> 00:50:35,359
that makes it look

1682
00:50:35,359 --> 00:50:37,119
like we ran mimikats because then in

1683
00:50:37,119 --> 00:50:38,960
their sim

1684
00:50:38,960 --> 00:50:40,319
their sim is going to tell them they ran

1685
00:50:40,319 --> 00:50:42,400
mimikats because those

1686
00:50:42,400 --> 00:50:44,240
log forwarders they're not actually

1687
00:50:44,240 --> 00:50:45,440
looking for techniques they're being

1688
00:50:45,440 --> 00:50:47,200
executed they're reading the logs

1689
00:50:47,200 --> 00:50:49,040
and those logs have been constructed

1690
00:50:49,040 --> 00:50:51,119
such that the blue team will have

1691
00:50:51,119 --> 00:50:53,040
good uh indicators of compromise to look

1692
00:50:53,040 --> 00:50:54,640
like look at so we need to do is

1693
00:50:54,640 --> 00:50:55,920
identify what those indicators of

1694
00:50:55,920 --> 00:50:57,119
compromise are going to be

1695
00:50:57,119 --> 00:50:59,200
and then we need to fill the logs on all

1696
00:50:59,200 --> 00:51:00,240
of the systems

1697
00:51:00,240 --> 00:51:02,160
with that it turns out that powershell

1698
00:51:02,160 --> 00:51:04,240
is extremely good for this

1699
00:51:04,240 --> 00:51:06,400
and with powershell we can use the get

1700
00:51:06,400 --> 00:51:08,480
event or not get

1701
00:51:08,480 --> 00:51:12,240
create event logs commandlet in order to

1702
00:51:12,240 --> 00:51:13,760
accomplish this

1703
00:51:13,760 --> 00:51:14,880
let me pull this up for you so you can

1704
00:51:14,880 --> 00:51:23,839
see an example

1705
00:51:41,920 --> 00:51:51,839
um come on computer

1706
00:52:04,960 --> 00:52:06,240
computer doesn't want to work the way

1707
00:52:06,240 --> 00:52:08,480
that i intend it to so we're just going

1708
00:52:08,480 --> 00:52:19,839
to cheat it

1709
00:52:23,359 --> 00:52:24,559
so if you were to jump to something like

1710
00:52:24,559 --> 00:52:26,319
a windows machine here and open

1711
00:52:26,319 --> 00:52:33,839
something like powershell

1712
00:52:46,720 --> 00:52:49,118
buddy

1713
00:52:53,520 --> 00:52:56,960
copy and pasting is hard today

1714
00:52:57,760 --> 00:53:01,839
all right we'll just

1715
00:53:02,880 --> 00:53:04,240
open up a text editor and slap it in a

1716
00:53:04,240 --> 00:53:06,879
text editor

1717
00:53:10,960 --> 00:53:12,400
so you could run a command lit like this

1718
00:53:12,400 --> 00:53:14,079
here's a real quick one-liner and all it

1719
00:53:14,079 --> 00:53:15,280
does is add

1720
00:53:15,280 --> 00:53:17,920
um a new event log where the event

1721
00:53:17,920 --> 00:53:20,000
source is minicats.exe

1722
00:53:20,000 --> 00:53:24,640
and if you're building a uh a detection

1723
00:53:24,720 --> 00:53:28,079
holy macro computer if you're building

1724
00:53:28,079 --> 00:53:30,079
some kind of detection

1725
00:53:30,079 --> 00:53:32,880
where that detection is um looking for

1726
00:53:32,880 --> 00:53:33,760
certain strings

1727
00:53:33,760 --> 00:53:35,680
that are known to be bad like mimikats

1728
00:53:35,680 --> 00:53:37,119
maybe that's a really common one to have

1729
00:53:37,119 --> 00:53:38,400
some kind of detection

1730
00:53:38,400 --> 00:53:39,920
built around we've essentially just

1731
00:53:39,920 --> 00:53:42,480
created event logs that allow us to

1732
00:53:42,480 --> 00:53:43,359
create that

1733
00:53:43,359 --> 00:53:45,599
in the event log and since the get the

1734
00:53:45,599 --> 00:53:47,520
new event log commandlet in powershell

1735
00:53:47,520 --> 00:53:49,119
actually lets you run it against remote

1736
00:53:49,119 --> 00:53:50,720
computers we can have access to a single

1737
00:53:50,720 --> 00:53:51,760
computer in the environment

1738
00:53:51,760 --> 00:53:53,280
and run this against all of the

1739
00:53:53,280 --> 00:53:54,720
computers in the environment to make it

1740
00:53:54,720 --> 00:53:55,760
look like mimikatz has been

1741
00:53:55,760 --> 00:53:57,119
simultaneously run

1742
00:53:57,119 --> 00:53:59,680
on every single system local to that

1743
00:53:59,680 --> 00:54:00,480
actual system

1744
00:54:00,480 --> 00:54:02,720
so we can absolutely control what the

1745
00:54:02,720 --> 00:54:03,839
actual atta

1746
00:54:03,839 --> 00:54:05,680
defenders get to see in the environment

1747
00:54:05,680 --> 00:54:07,040
and if we can control that

1748
00:54:07,040 --> 00:54:08,800
we can make it look like something like

1749
00:54:08,800 --> 00:54:10,079
this this is mimikatz

1750
00:54:10,079 --> 00:54:11,920
is being executed everywhere and so now

1751
00:54:11,920 --> 00:54:13,680
that they have detected it everywhere

1752
00:54:13,680 --> 00:54:15,760
they need to respond to it everywhere

1753
00:54:15,760 --> 00:54:17,920
and can't respond to what really matters

1754
00:54:17,920 --> 00:54:19,520
where else might we find some of these

1755
00:54:19,520 --> 00:54:20,960
things to use as detections

1756
00:54:20,960 --> 00:54:22,480
the living offlane binaries and script

1757
00:54:22,480 --> 00:54:24,400
project has a list of those defenders

1758
00:54:24,400 --> 00:54:24,880
today

1759
00:54:24,880 --> 00:54:27,040
often go through these low basses in

1760
00:54:27,040 --> 00:54:29,200
order to build detections in splunk or

1761
00:54:29,200 --> 00:54:29,920
in elk

1762
00:54:29,920 --> 00:54:31,920
to determine whether or not an attacker

1763
00:54:31,920 --> 00:54:33,599
has run something so if we go through

1764
00:54:33,599 --> 00:54:34,240
here

1765
00:54:34,240 --> 00:54:36,319
we have now a list of things to make our

1766
00:54:36,319 --> 00:54:38,079
covert operation scripts

1767
00:54:38,079 --> 00:54:40,319
do and of course the attackers or

1768
00:54:40,319 --> 00:54:41,440
defenders know all about different

1769
00:54:41,440 --> 00:54:43,040
languages and such that are being used

1770
00:54:43,040 --> 00:54:44,559
so if we're using something like

1771
00:54:44,559 --> 00:54:46,799
powershell and powersploit

1772
00:54:46,799 --> 00:54:48,960
all of these things are malicious in

1773
00:54:48,960 --> 00:54:50,640
nature and so if we make it look like

1774
00:54:50,640 --> 00:54:51,920
that has been executed somewhere or we

1775
00:54:51,920 --> 00:54:53,119
actually just drop it and run it

1776
00:54:53,119 --> 00:54:53,599
somewhere

1777
00:54:53,599 --> 00:54:55,839
but we do this ad nauseum to hundreds of

1778
00:54:55,839 --> 00:54:58,480
systems that's all more noise the

1779
00:54:58,480 --> 00:55:01,599
defender has to respond to and so we're

1780
00:55:01,599 --> 00:55:02,240
doing here

1781
00:55:02,240 --> 00:55:04,319
is essentially reverse deceptive

1782
00:55:04,319 --> 00:55:05,359
operations

1783
00:55:05,359 --> 00:55:07,599
where the defender may want to deceive

1784
00:55:07,599 --> 00:55:09,040
us to make us

1785
00:55:09,040 --> 00:55:10,880
vulnerable acceptable to a trap we can

1786
00:55:10,880 --> 00:55:12,880
also trap the defenders here too

1787
00:55:12,880 --> 00:55:14,480
make them think that the attack is

1788
00:55:14,480 --> 00:55:16,079
happening

1789
00:55:16,079 --> 00:55:17,520
in their finance department we're

1790
00:55:17,520 --> 00:55:19,680
actually focused on getting data from hr

1791
00:55:19,680 --> 00:55:21,839
or whatever it might actually be and we

1792
00:55:21,839 --> 00:55:23,280
can absolutely uh

1793
00:55:23,280 --> 00:55:25,119
take advantage of sun tzu style

1794
00:55:25,119 --> 00:55:26,799
techniques here now if you're interested

1795
00:55:26,799 --> 00:55:28,160
in things like cyber space deception

1796
00:55:28,160 --> 00:55:30,079
there is a podcast that's called the

1797
00:55:30,079 --> 00:55:31,599
take back the advantage podcast

1798
00:55:31,599 --> 00:55:33,520
by kevin fiskus it's a full youtube

1799
00:55:33,520 --> 00:55:35,040
channel um it's really really good

1800
00:55:35,040 --> 00:55:36,400
actually um i was in fact

1801
00:55:36,400 --> 00:55:37,920
on a podcast with kevin fiskus a couple

1802
00:55:37,920 --> 00:55:39,839
weeks back and all these videos were up

1803
00:55:39,839 --> 00:55:40,640
there

1804
00:55:40,640 --> 00:55:42,160
really interesting way to make your mind

1805
00:55:42,160 --> 00:55:43,839
think differently about cyber security

1806
00:55:43,839 --> 00:55:45,280
than perhaps it has

1807
00:55:45,280 --> 00:55:48,960
in the past um here's my contact

1808
00:55:48,960 --> 00:55:50,240
information if you have

1809
00:55:50,240 --> 00:55:52,559
questions that come out at some point in

1810
00:55:52,559 --> 00:55:53,760
the future and you want to reach out or

1811
00:55:53,760 --> 00:55:54,400
you want to

1812
00:55:54,400 --> 00:55:57,280
jam about red teaming and uh cyber space

1813
00:55:57,280 --> 00:55:58,400
trapping and deception and all those

1814
00:55:58,400 --> 00:55:59,119
kind of things

1815
00:55:59,119 --> 00:56:01,280
i'm totally into it i'm pretty active on

1816
00:56:01,280 --> 00:56:02,799
twitter so that's probably your best bet

1817
00:56:02,799 --> 00:56:04,000
to look up look me up

1818
00:56:04,000 --> 00:56:05,599
i also have a youtube channel and i do

1819
00:56:05,599 --> 00:56:07,440
videos on these kinds of things

1820
00:56:07,440 --> 00:56:10,000
all the time

1821
00:56:11,440 --> 00:56:13,119
hi max john we're right up at the end of

1822
00:56:13,119 --> 00:56:14,640
our time here but there's actually a

1823
00:56:14,640 --> 00:56:16,079
great conversation going on in the

1824
00:56:16,079 --> 00:56:17,280
discord right now

1825
00:56:17,280 --> 00:56:18,880
uh we're gonna move that to track four

1826
00:56:18,880 --> 00:56:20,400
breakouts so if you'd like to jump on

1827
00:56:20,400 --> 00:56:20,880
there

1828
00:56:20,880 --> 00:56:22,640
at the end of this uh there's tons of

1829
00:56:22,640 --> 00:56:24,000
questions and there's some back and

1830
00:56:24,000 --> 00:56:25,280
forth that i think that uh

1831
00:56:25,280 --> 00:56:26,559
you can definitely help out with thank

1832
00:56:26,559 --> 00:56:29,359
you perfect i'll jump on the discord

1833
00:56:29,359 --> 00:56:31,040
and we'll chat it up alright everyone

1834
00:56:31,040 --> 00:56:32,640
thanks so much for your time i hope this

1835
00:56:32,640 --> 00:56:33,200
was

1836
00:56:33,200 --> 00:56:45,839
interesting for you

1837
00:57:05,040 --> 00:57:07,119
you

