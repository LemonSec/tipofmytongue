1
00:00:00,120 --> 00:00:02,100
can everybody hear me okay

2
00:00:02,100 --> 00:00:03,419
yes cool

3
00:00:03,419 --> 00:00:05,940
uh I'm Vincent my talk is titled I Know

4
00:00:05,940 --> 00:00:07,500
What You Did Last Summer I'm still

5
00:00:07,500 --> 00:00:11,240
hacking your small business

6
00:00:11,580 --> 00:00:13,920
my talk is rated M for Mature because at

7
00:00:13,920 --> 00:00:15,059
some point I'm going to use some

8
00:00:15,059 --> 00:00:18,180
profanity I'm sorry that's just how I am

9
00:00:18,180 --> 00:00:19,619
some things I'm going to show you today

10
00:00:19,619 --> 00:00:21,900
would be considered criminal activity

11
00:00:21,900 --> 00:00:23,460
should you not have the permission from

12
00:00:23,460 --> 00:00:24,600
your target

13
00:00:24,600 --> 00:00:27,000
FYI

14
00:00:27,000 --> 00:00:30,420
who am I I'm a penetration tester I'm a

15
00:00:30,420 --> 00:00:32,340
small business owner and I'm an Air

16
00:00:32,340 --> 00:00:33,899
Force veteran

17
00:00:33,899 --> 00:00:35,640
the things that are important to know

18
00:00:35,640 --> 00:00:37,620
about me are that I've been in tech for

19
00:00:37,620 --> 00:00:40,020
over 30 years I've run a technology

20
00:00:40,020 --> 00:00:42,420
business for the last 20 years it

21
00:00:42,420 --> 00:00:44,460
started off as a break fix I.T company

22
00:00:44,460 --> 00:00:46,559
we were a concierge type business where

23
00:00:46,559 --> 00:00:48,600
we had a small number of clients and

24
00:00:48,600 --> 00:00:50,760
they were high revenue and then about 10

25
00:00:50,760 --> 00:00:53,520
years ago Cloud started eating into our

26
00:00:53,520 --> 00:00:56,460
business model and our businesses didn't

27
00:00:56,460 --> 00:00:58,379
scale that way because uh you know we're

28
00:00:58,379 --> 00:01:00,960
once six-figure clients we're now low

29
00:01:00,960 --> 00:01:03,780
five figure clients so I decided to

30
00:01:03,780 --> 00:01:06,840
Pivot the business thought security be a

31
00:01:06,840 --> 00:01:09,060
good play seems like it wasn't a bad

32
00:01:09,060 --> 00:01:10,500
choice

33
00:01:10,500 --> 00:01:13,140
um and I took the oscp course do you

34
00:01:13,140 --> 00:01:15,000
know what that is and I fell in love

35
00:01:15,000 --> 00:01:16,740
with offense and I've been doing

36
00:01:16,740 --> 00:01:19,560
offensive security ever since

37
00:01:19,560 --> 00:01:20,700
foreign

38
00:01:20,700 --> 00:01:22,680
so what's this talk about

39
00:01:22,680 --> 00:01:25,439
so I work with small businesses so think

40
00:01:25,439 --> 00:01:28,560
a thousand employees or less uh with big

41
00:01:28,560 --> 00:01:30,320
businesses say like a Bank of America

42
00:01:30,320 --> 00:01:34,200
Bank of America has a security team they

43
00:01:34,200 --> 00:01:37,380
have uh you know a sock they have layers

44
00:01:37,380 --> 00:01:39,720
and layers of security and they have big

45
00:01:39,720 --> 00:01:41,700
bags of money to throw at the problem

46
00:01:41,700 --> 00:01:43,979
small businesses on the other hand are

47
00:01:43,979 --> 00:01:46,140
the low-hanging fruit and this talk is

48
00:01:46,140 --> 00:01:48,180
about my Adventures while working with

49
00:01:48,180 --> 00:01:51,000
those small businesses

50
00:01:51,000 --> 00:01:53,700
so we are going to attack a small

51
00:01:53,700 --> 00:01:56,640
business like a malicious actor and our

52
00:01:56,640 --> 00:01:58,979
Target is going to be 100 to 250

53
00:01:58,979 --> 00:02:01,439
employees in size this is a sweet spot

54
00:02:01,439 --> 00:02:03,479
for me personally because they're big

55
00:02:03,479 --> 00:02:05,640
enough that they have stuff but they're

56
00:02:05,640 --> 00:02:07,320
small enough that they're still very

57
00:02:07,320 --> 00:02:09,300
immature so when we look in their

58
00:02:09,300 --> 00:02:11,280
environments they're not running EDR

59
00:02:11,280 --> 00:02:13,200
they don't have a sock they're not using

60
00:02:13,200 --> 00:02:15,239
sock as a service they're running

61
00:02:15,239 --> 00:02:17,700
traditional AV and most times we find

62
00:02:17,700 --> 00:02:19,739
that they're running flat networks so no

63
00:02:19,739 --> 00:02:22,080
segmentation

64
00:02:22,080 --> 00:02:24,480
so maybe somebody else in this room has

65
00:02:24,480 --> 00:02:25,980
thought about how they would hide their

66
00:02:25,980 --> 00:02:27,300
identity if they were going to be an

67
00:02:27,300 --> 00:02:28,319
attacker

68
00:02:28,319 --> 00:02:31,319
my wish list consists of burner laptops

69
00:02:31,319 --> 00:02:33,300
I'm going to work out of a mom-and-pop

70
00:02:33,300 --> 00:02:34,800
coffee shop because I feel like

71
00:02:34,800 --> 00:02:37,379
Starbucks is logging the traffic uh

72
00:02:37,379 --> 00:02:38,879
they've got cameras I don't know what

73
00:02:38,879 --> 00:02:40,680
the retention is on that I don't want to

74
00:02:40,680 --> 00:02:41,879
deal with that I'm going to work out of

75
00:02:41,879 --> 00:02:43,800
the mom and pop coffee shop I'm going to

76
00:02:43,800 --> 00:02:46,200
use a privacy VPN I'm going to use tour

77
00:02:46,200 --> 00:02:48,959
and Tails and I'm going to have a VPS or

78
00:02:48,959 --> 00:02:51,900
two virtual private server

79
00:02:51,900 --> 00:02:54,180
some of you may recognize this it's the

80
00:02:54,180 --> 00:02:56,099
logo for Kali Linux I saw a little smile

81
00:02:56,099 --> 00:02:58,680
there can't be a hacker unless you use

82
00:02:58,680 --> 00:02:59,640
Cali

83
00:02:59,640 --> 00:03:01,920
truth be told actually don't use Cali I

84
00:03:01,920 --> 00:03:04,379
use Ubuntu I put a small set of tools on

85
00:03:04,379 --> 00:03:06,540
it that I use I find that Cali is big

86
00:03:06,540 --> 00:03:08,459
and Bloated and it tends to break in the

87
00:03:08,459 --> 00:03:10,560
middle of engagements but in the context

88
00:03:10,560 --> 00:03:12,599
of this talk I'm going to use Cali

89
00:03:12,599 --> 00:03:15,060
because every script kitty in the world

90
00:03:15,060 --> 00:03:17,940
uses it and if my operating system gets

91
00:03:17,940 --> 00:03:19,440
fingerprinted I'm gonna look like

92
00:03:19,440 --> 00:03:21,659
everybody else

93
00:03:21,659 --> 00:03:24,000
I'm gonna use mold vad for my privacy

94
00:03:24,000 --> 00:03:26,159
VPN because they take cash and I thought

95
00:03:26,159 --> 00:03:28,739
that was hilarious they say send us cash

96
00:03:28,739 --> 00:03:30,480
but not too much but they don't specify

97
00:03:30,480 --> 00:03:32,760
how much is too much so I threw twenty

98
00:03:32,760 --> 00:03:34,739
dollars in an envelope mailed it to

99
00:03:34,739 --> 00:03:36,840
Sweden and it was expecting that to be

100
00:03:36,840 --> 00:03:38,940
beer money but in about a week it

101
00:03:38,940 --> 00:03:41,340
actually lit up I was really surprised

102
00:03:41,340 --> 00:03:43,080
I'm gonna get a little granular because

103
00:03:43,080 --> 00:03:44,760
I want you to see how simple it is to

104
00:03:44,760 --> 00:03:47,099
get this this platform set up so I'm

105
00:03:47,099 --> 00:03:49,440
going to install Tor I'm going to make a

106
00:03:49,440 --> 00:03:52,019
modification to proxy chains and then

107
00:03:52,019 --> 00:03:53,700
I'm going to curl my IP address before

108
00:03:53,700 --> 00:03:55,379
and after and what we see is that we

109
00:03:55,379 --> 00:03:57,239
have one IP address and then when we go

110
00:03:57,239 --> 00:04:00,299
through tour we have another FYI those

111
00:04:00,299 --> 00:04:02,280
are not my IP addresses because this is

112
00:04:02,280 --> 00:04:03,720
the security conference I don't trust

113
00:04:03,720 --> 00:04:06,000
you people

114
00:04:06,000 --> 00:04:07,500
going to install them all that client

115
00:04:07,500 --> 00:04:10,680
gonna fire it up gonna connect so we're

116
00:04:10,680 --> 00:04:13,080
connected to Sweden again I'm going to

117
00:04:13,080 --> 00:04:15,599
check my IP address before and after and

118
00:04:15,599 --> 00:04:16,858
again what we see is that we have two

119
00:04:16,858 --> 00:04:18,839
different IP addresses so now I have

120
00:04:18,839 --> 00:04:20,459
several routes to go to the internet and

121
00:04:20,459 --> 00:04:22,500
I can masquerade my IP

122
00:04:22,500 --> 00:04:25,560
so the question is are we safe is this

123
00:04:25,560 --> 00:04:27,000
good opsec

124
00:04:27,000 --> 00:04:29,699
from a small business sure from three

125
00:04:29,699 --> 00:04:32,940
letter agencies or a nation state no but

126
00:04:32,940 --> 00:04:34,259
this is good enough for what we're going

127
00:04:34,259 --> 00:04:35,820
to do

128
00:04:35,820 --> 00:04:38,460
oh that was my I don't know sorry

129
00:04:38,460 --> 00:04:40,440
so now we're gonna go hunting and you

130
00:04:40,440 --> 00:04:41,759
might be thinking well what are we

131
00:04:41,759 --> 00:04:43,380
hunting for

132
00:04:43,380 --> 00:04:46,199
I need a VPS and I was thinking that I

133
00:04:46,199 --> 00:04:47,940
would get some crypto and I would go to

134
00:04:47,940 --> 00:04:49,560
some shady provider and I would get a

135
00:04:49,560 --> 00:04:52,080
VPS from them but then I had this idea

136
00:04:52,080 --> 00:04:54,900
of firing up a honey pot now I've got a

137
00:04:54,900 --> 00:04:57,600
bunch of ports that are open on this and

138
00:04:57,600 --> 00:04:59,400
the first thing that I noticed was that

139
00:04:59,400 --> 00:05:01,919
there was a ton of SMB traffic coming

140
00:05:01,919 --> 00:05:04,199
inbound and it was just overwhelming I

141
00:05:04,199 --> 00:05:06,000
mean it was crazy like I had RDP open

142
00:05:06,000 --> 00:05:07,500
and that would get hit here and there

143
00:05:07,500 --> 00:05:09,600
and you know obviously HTTP and https

144
00:05:09,600 --> 00:05:12,419
but SMB traffic was just flowing and

145
00:05:12,419 --> 00:05:14,340
flowing and flowing so after 10 minutes

146
00:05:14,340 --> 00:05:17,460
I just cut it I parse the logs I sorted

147
00:05:17,460 --> 00:05:21,060
for Unique IPS and I had 62 of them now

148
00:05:21,060 --> 00:05:23,820
my thinking here is these are bought

149
00:05:23,820 --> 00:05:26,580
compromised servers so they were they

150
00:05:26,580 --> 00:05:28,620
had vulnerabilities and those Bots took

151
00:05:28,620 --> 00:05:31,199
them over so I'm thinking I mean I've

152
00:05:31,199 --> 00:05:33,360
heard of bots actually patching but I

153
00:05:33,360 --> 00:05:34,919
can't imagine that's all of them so I

154
00:05:34,919 --> 00:05:37,380
think I can find a vulnerability I can

155
00:05:37,380 --> 00:05:39,060
compromise that and then I can take a

156
00:05:39,060 --> 00:05:40,320
position

157
00:05:40,320 --> 00:05:42,960
so I scan and I find that there are a

158
00:05:42,960 --> 00:05:45,120
bunch of ports open and so I'm liking my

159
00:05:45,120 --> 00:05:46,979
odds at this point

160
00:05:46,979 --> 00:05:50,100
so as I dig in I do a reverse a reverse

161
00:05:50,100 --> 00:05:52,139
lookup and I see that I've got a bunch

162
00:05:52,139 --> 00:05:54,000
of ips that are actually out of country

163
00:05:54,000 --> 00:05:56,160
now I don't know but in my head I'm

164
00:05:56,160 --> 00:05:57,539
thinking if I stay out of the United

165
00:05:57,539 --> 00:05:59,280
States I'm probably better off that just

166
00:05:59,280 --> 00:06:00,660
adds another layer

167
00:06:00,660 --> 00:06:03,419
as I dig into that further I find four

168
00:06:03,419 --> 00:06:07,139
Russian IPS it Army of Ukraine and

169
00:06:07,139 --> 00:06:09,000
Anonymous are hacking the [ __ ] out of

170
00:06:09,000 --> 00:06:10,979
Russia so I feel like these are good

171
00:06:10,979 --> 00:06:12,479
targets for me because I can blend into

172
00:06:12,479 --> 00:06:14,820
that noise and I can take a position and

173
00:06:14,820 --> 00:06:16,440
again further you know hiding my

174
00:06:16,440 --> 00:06:17,520
identity

175
00:06:17,520 --> 00:06:19,919
so hack the planet right

176
00:06:19,919 --> 00:06:21,300
would like to remind you that that would

177
00:06:21,300 --> 00:06:23,160
be considered a criminal activity so

178
00:06:23,160 --> 00:06:25,860
we're going to pretend

179
00:06:25,860 --> 00:06:28,919
let's say on one of those uh Russian IPS

180
00:06:28,919 --> 00:06:32,100
I find a vulnerable WordPress site

181
00:06:32,100 --> 00:06:35,220
now I have a number of plugins that I

182
00:06:35,220 --> 00:06:37,800
use to do various things on on WordPress

183
00:06:37,800 --> 00:06:39,180
let me step back for a second if you

184
00:06:39,180 --> 00:06:40,620
don't know what a plug-in is you go to a

185
00:06:40,620 --> 00:06:42,360
website it's got this pretty picture and

186
00:06:42,360 --> 00:06:44,280
that Scrolls and there's another picture

187
00:06:44,280 --> 00:06:46,560
that takes its place that's a plug-in it

188
00:06:46,560 --> 00:06:49,199
adds functionality to the core product

189
00:06:49,199 --> 00:06:50,460
um and so I've got one it's called

190
00:06:50,460 --> 00:06:52,500
WordPress backdoor that seems kind of

191
00:06:52,500 --> 00:06:54,240
suspicious so we're going to call it

192
00:06:54,240 --> 00:06:57,539
WordPress CSS updater and basically all

193
00:06:57,539 --> 00:06:59,580
a plug-in is there's some comment lines

194
00:06:59,580 --> 00:07:01,319
that WordPress will recognize it is

195
00:07:01,319 --> 00:07:03,900
being a plug-in and then some PHP the

196
00:07:03,900 --> 00:07:07,139
bottom line is remote code execution so

197
00:07:07,139 --> 00:07:08,460
we zip it up

198
00:07:08,460 --> 00:07:12,479
we log in we point to the plug-in and

199
00:07:12,479 --> 00:07:14,340
then we activate the plugin

200
00:07:14,340 --> 00:07:16,440
and there it is our plugin is sitting in

201
00:07:16,440 --> 00:07:18,300
there now I've managed content

202
00:07:18,300 --> 00:07:19,919
Management Systems before and never have

203
00:07:19,919 --> 00:07:21,780
I gone in and scrutinized those plugins

204
00:07:21,780 --> 00:07:23,639
they just exist in their own little

205
00:07:23,639 --> 00:07:26,039
place now as an attacker though I'm

206
00:07:26,039 --> 00:07:27,780
looking at this and I see that two are

207
00:07:27,780 --> 00:07:30,919
in need of updating I don't want anybody

208
00:07:30,919 --> 00:07:33,720
to be drawn to that like if an admin

209
00:07:33,720 --> 00:07:34,979
comes in and sees that they're going to

210
00:07:34,979 --> 00:07:36,599
go look in there I don't want them to

211
00:07:36,599 --> 00:07:37,800
see that because then they're going to

212
00:07:37,800 --> 00:07:39,060
come in and maybe see mine so I'm

213
00:07:39,060 --> 00:07:40,139
actually going to patch that as an

214
00:07:40,139 --> 00:07:42,720
attacker I'm going to do a good deed

215
00:07:42,720 --> 00:07:44,160
at the end of the day what we're trying

216
00:07:44,160 --> 00:07:46,259
to accomplish is this we point to the

217
00:07:46,259 --> 00:07:48,240
plug-in we give it the command of ID and

218
00:07:48,240 --> 00:07:50,160
then what we get back is dub dub data so

219
00:07:50,160 --> 00:07:51,960
right now I've got remote code execution

220
00:07:51,960 --> 00:07:55,860
and I've got myself a Russian C2 server

221
00:07:55,860 --> 00:07:57,479
so the next topic I want to talk about

222
00:07:57,479 --> 00:07:58,860
is phishing

223
00:07:58,860 --> 00:08:01,139
so back in the day when I first started

224
00:08:01,139 --> 00:08:03,000
running fishing campaigns I would take

225
00:08:03,000 --> 00:08:05,520
one email and I would blast it out to

226
00:08:05,520 --> 00:08:07,380
all the users at the same time and then

227
00:08:07,380 --> 00:08:09,000
I would gather the metrics and I would

228
00:08:09,000 --> 00:08:10,740
weigh out like how good our training was

229
00:08:10,740 --> 00:08:12,479
doing the problem with that is people

230
00:08:12,479 --> 00:08:14,039
were like sneaking over the wall and

231
00:08:14,039 --> 00:08:15,539
they're like hey watch out for that fake

232
00:08:15,539 --> 00:08:17,699
phishing email and so I felt like that

233
00:08:17,699 --> 00:08:19,680
wasn't a very effective way so what we

234
00:08:19,680 --> 00:08:22,500
do today is we take our users and we

235
00:08:22,500 --> 00:08:24,479
break them up into groups so we have the

236
00:08:24,479 --> 00:08:25,860
marketing department the sales

237
00:08:25,860 --> 00:08:27,960
department finance and then what we do

238
00:08:27,960 --> 00:08:30,300
is we find fish that match those those

239
00:08:30,300 --> 00:08:32,940
those groups and so like the fake FedEx

240
00:08:32,940 --> 00:08:34,559
email is going to go to the shipping guy

241
00:08:34,559 --> 00:08:36,419
and then because we're working with

242
00:08:36,419 --> 00:08:39,479
small business what happens is we very

243
00:08:39,479 --> 00:08:42,240
rarely see that uh two users get fished

244
00:08:42,240 --> 00:08:45,300
in the same day and rarely are two users

245
00:08:45,300 --> 00:08:47,519
um seeing the same fish

246
00:08:47,519 --> 00:08:49,140
now I want to show you some fish that

247
00:08:49,140 --> 00:08:50,339
hooks people

248
00:08:50,339 --> 00:08:51,839
um I want to talk about variables

249
00:08:51,839 --> 00:08:53,459
because you're going to see percent date

250
00:08:53,459 --> 00:08:55,620
percent time percent email these get

251
00:08:55,620 --> 00:08:57,480
populated at the time they get sent out

252
00:08:57,480 --> 00:08:59,279
so upper right hand corner you see

253
00:08:59,279 --> 00:09:00,660
percent date that would just show

254
00:09:00,660 --> 00:09:02,760
today's date so this was one that went

255
00:09:02,760 --> 00:09:04,860
out it's not great it says you ordered a

256
00:09:04,860 --> 00:09:07,380
1700 laptop and the user is like oh [ __ ]

257
00:09:07,380 --> 00:09:08,700
I did not order that I'm going to click

258
00:09:08,700 --> 00:09:10,200
on all these links so that was something

259
00:09:10,200 --> 00:09:12,060
to fish somebody

260
00:09:12,060 --> 00:09:14,220
here's another one big voicemail to

261
00:09:14,220 --> 00:09:16,200
email this is actually really successful

262
00:09:16,200 --> 00:09:18,120
in a client that actually has voicemail

263
00:09:18,120 --> 00:09:20,660
to email the problem with them is that

264
00:09:20,660 --> 00:09:24,240
their VoIP system puts their name and

265
00:09:24,240 --> 00:09:25,920
the company's name and the VoIP system

266
00:09:25,920 --> 00:09:27,600
name in here and this has none of that

267
00:09:27,600 --> 00:09:29,459
people keep clicking on it

268
00:09:29,459 --> 00:09:31,860
at the bottom of the barrel we have this

269
00:09:31,860 --> 00:09:33,720
piece of crap since we've received your

270
00:09:33,720 --> 00:09:35,220
order it'll be processed soon you can

271
00:09:35,220 --> 00:09:36,540
view your order by clicking here and

272
00:09:36,540 --> 00:09:37,800
it's got a link it says thank you

273
00:09:37,800 --> 00:09:39,300
customer service department it doesn't

274
00:09:39,300 --> 00:09:40,500
have their name doesn't have the

275
00:09:40,500 --> 00:09:42,360
company's name doesn't have anything and

276
00:09:42,360 --> 00:09:45,980
people click on this I swear it's crazy

277
00:09:46,080 --> 00:09:47,820
so at the end of the quarter I run the

278
00:09:47,820 --> 00:09:49,320
metrics and what we see is that we had

279
00:09:49,320 --> 00:09:51,300
10 users clicking links we had two

280
00:09:51,300 --> 00:09:53,519
reported when I run these campaigns I

281
00:09:53,519 --> 00:09:55,680
try to emphasize reporting to me that

282
00:09:55,680 --> 00:09:57,959
seems equally valuable as recognizing

283
00:09:57,959 --> 00:09:59,399
something and not clicking on the link

284
00:09:59,399 --> 00:10:01,440
and the reason being is if a fish comes

285
00:10:01,440 --> 00:10:03,180
into your environment and you report it

286
00:10:03,180 --> 00:10:05,339
I can Purge that from the mail system

287
00:10:05,339 --> 00:10:06,720
and I can stop other people from

288
00:10:06,720 --> 00:10:08,700
clicking on that link this client

289
00:10:08,700 --> 00:10:10,860
doesn't care though and so this is the

290
00:10:10,860 --> 00:10:12,300
guy that I report to for this

291
00:10:12,300 --> 00:10:13,920
specifically and he says we're doing our

292
00:10:13,920 --> 00:10:15,899
annual PCI security training hopefully

293
00:10:15,899 --> 00:10:18,000
they'll pay more attention this year

294
00:10:18,000 --> 00:10:20,580
so funny thing is I went back in my

295
00:10:20,580 --> 00:10:22,860
email I have a an email from him last

296
00:10:22,860 --> 00:10:24,420
year literally said the same thing and

297
00:10:24,420 --> 00:10:26,640
these guys are at 20 click rate Which is

298
00:10:26,640 --> 00:10:29,160
higher than the average they suck all

299
00:10:29,160 --> 00:10:33,060
right I want to talk about spear fishing

300
00:10:33,060 --> 00:10:35,519
who thinks they can't be fished

301
00:10:35,519 --> 00:10:38,040
anybody I know it says you put your

302
00:10:38,040 --> 00:10:39,300
hands down

303
00:10:39,300 --> 00:10:42,240
so I assume there are people in the room

304
00:10:42,240 --> 00:10:43,740
that are looking to get their first job

305
00:10:43,740 --> 00:10:46,140
in security or they're looking to get a

306
00:10:46,140 --> 00:10:47,940
better paying job so I'm going to prop

307
00:10:47,940 --> 00:10:50,760
up a website Phoenix recruiters uh it

308
00:10:50,760 --> 00:10:52,500
says whether you need remote or on-site

309
00:10:52,500 --> 00:10:54,000
staff we understand the unique

310
00:10:54,000 --> 00:10:56,040
challenges of the Phoenix Metro Area job

311
00:10:56,040 --> 00:10:58,500
market and you're like Vincent I'm in

312
00:10:58,500 --> 00:11:00,420
San Antonio you're right

313
00:11:00,420 --> 00:11:02,220
we understand the unique challenges of

314
00:11:02,220 --> 00:11:05,160
the San Antonio job market I buy domains

315
00:11:05,160 --> 00:11:07,320
for 12 bucks I got this template off of

316
00:11:07,320 --> 00:11:09,600
w3schools I spent maybe five ten minutes

317
00:11:09,600 --> 00:11:11,700
building this thing and that's that's

318
00:11:11,700 --> 00:11:14,100
the beginning of what I'm about to do so

319
00:11:14,100 --> 00:11:15,540
then I'm going to fire off an email and

320
00:11:15,540 --> 00:11:18,180
it says hi John I am Vincent Smith and I

321
00:11:18,180 --> 00:11:19,860
work as a senior placement specialist at

322
00:11:19,860 --> 00:11:22,920
Phoenix recruiters or San Antonio

323
00:11:22,920 --> 00:11:24,959
I saw your profile on LinkedIn and I was

324
00:11:24,959 --> 00:11:27,420
really impressed by your experience and

325
00:11:27,420 --> 00:11:29,519
computer-y things because computer

326
00:11:29,519 --> 00:11:32,100
things are in high demand right now here

327
00:11:32,100 --> 00:11:34,380
at Phoenix recruiters we always look to

328
00:11:34,380 --> 00:11:36,360
collaborate with talented people blah

329
00:11:36,360 --> 00:11:39,060
blah blah sincerely Vincent Smith got a

330
00:11:39,060 --> 00:11:40,980
nice little signature block generated

331
00:11:40,980 --> 00:11:43,079
that a logo on adobe's website it was

332
00:11:43,079 --> 00:11:45,240
free took me about five minutes there

333
00:11:45,240 --> 00:11:47,339
are no links or no documents in here I'm

334
00:11:47,339 --> 00:11:48,980
going to go around and around

335
00:11:48,980 --> 00:11:52,140
establishing a relationship with you I'm

336
00:11:52,140 --> 00:11:54,000
going to offer you a half a million

337
00:11:54,000 --> 00:11:55,860
dollars a year because it's not my money

338
00:11:55,860 --> 00:11:57,600
and I don't care

339
00:11:57,600 --> 00:11:59,040
and then eventually I'm going to get to

340
00:11:59,040 --> 00:12:00,540
the point where I say my client would

341
00:12:00,540 --> 00:12:02,880
like to take this to the next level they

342
00:12:02,880 --> 00:12:04,260
need you to sign a non-disclosure

343
00:12:04,260 --> 00:12:05,820
agreement I'm going to send you a link

344
00:12:05,820 --> 00:12:07,320
or a document and I'm going to get you

345
00:12:07,320 --> 00:12:10,440
to do something you don't want to do

346
00:12:10,440 --> 00:12:12,300
so bottom line is we can all be fished

347
00:12:12,300 --> 00:12:15,899
me too all right that was a little heavy

348
00:12:15,899 --> 00:12:17,760
I want to transition

349
00:12:17,760 --> 00:12:20,760
meet Jade

350
00:12:20,760 --> 00:12:22,920
Jade's got her CV posted up on his on

351
00:12:22,920 --> 00:12:24,060
this website

352
00:12:24,060 --> 00:12:26,040
she's currently working as a bilingual

353
00:12:26,040 --> 00:12:27,839
customer service rep at Therma Fisher

354
00:12:27,839 --> 00:12:30,000
Scientific prior to that she was an

355
00:12:30,000 --> 00:12:31,740
Engineering Systems technical sales

356
00:12:31,740 --> 00:12:34,140
engineer at Johnson Controls and prior

357
00:12:34,140 --> 00:12:35,579
to that she was a technical sales

358
00:12:35,579 --> 00:12:38,519
engineer at spirax she's got an MBA from

359
00:12:38,519 --> 00:12:40,079
Pepperdine and a bachelor's in

360
00:12:40,079 --> 00:12:44,239
mechanical engineering from Cal Poly

361
00:12:44,459 --> 00:12:47,339
she's got skills Office 365 Salesforce

362
00:12:47,339 --> 00:12:50,160
Vis me Zoom she speaks English and

363
00:12:50,160 --> 00:12:53,220
Spanish fluently a little bit German

364
00:12:53,220 --> 00:12:55,079
she's on LinkedIn

365
00:12:55,079 --> 00:12:58,579
is she real or fake

366
00:12:58,920 --> 00:13:00,660
she's fake

367
00:13:00,660 --> 00:13:02,639
when the person does not exist that is

368
00:13:02,639 --> 00:13:04,800
an AI generated photo

369
00:13:04,800 --> 00:13:06,600
because I lack creativity I went to the

370
00:13:06,600 --> 00:13:07,920
fake name generator and got her name

371
00:13:07,920 --> 00:13:09,660
address and phone number

372
00:13:09,660 --> 00:13:11,579
somebody was telling me I was given this

373
00:13:11,579 --> 00:13:13,380
demo I was demoing this talk for timing

374
00:13:13,380 --> 00:13:14,700
and my one of my buddies was like well I

375
00:13:14,700 --> 00:13:15,899
looked at her profile on LinkedIn and

376
00:13:15,899 --> 00:13:17,940
see if she had connections I'm like dude

377
00:13:17,940 --> 00:13:20,040
in a week I was getting connections from

378
00:13:20,040 --> 00:13:21,839
Therma Fisher Scientific and the

379
00:13:21,839 --> 00:13:23,700
Pepperdine MBA school I'm like she's

380
00:13:23,700 --> 00:13:25,740
gonna look like it when I get done so

381
00:13:25,740 --> 00:13:26,940
you might be wondering where I'm going

382
00:13:26,940 --> 00:13:28,860
with this right to what end so I start

383
00:13:28,860 --> 00:13:30,779
my engagement and I'm on my client's

384
00:13:30,779 --> 00:13:32,399
website and I'm kind of scouring for

385
00:13:32,399 --> 00:13:34,139
things at the bottom I see this thing

386
00:13:34,139 --> 00:13:36,540
for employment it's a PDF it's looking

387
00:13:36,540 --> 00:13:38,339
for a technical position with it you

388
00:13:38,339 --> 00:13:40,380
know that's a heavy engineering and

389
00:13:40,380 --> 00:13:43,680
sales so I tailored Jade to meet this

390
00:13:43,680 --> 00:13:45,420
position I went on the way back internet

391
00:13:45,420 --> 00:13:47,279
and I saw that this had been sitting up

392
00:13:47,279 --> 00:13:49,260
there for a long time so either this

393
00:13:49,260 --> 00:13:52,260
position churns or it's hard to fill in

394
00:13:52,260 --> 00:13:53,880
either case I'm liking where I'm going

395
00:13:53,880 --> 00:13:54,839
with this

396
00:13:54,839 --> 00:13:56,399
at the bottom of their website they give

397
00:13:56,399 --> 00:13:57,959
me an email address to email info

398
00:13:57,959 --> 00:13:59,760
companynade.com

399
00:13:59,760 --> 00:14:02,579
remember Jade Jay's got an outlook.com

400
00:14:02,579 --> 00:14:03,779
account

401
00:14:03,779 --> 00:14:06,120
turns out you can set up outlook.com

402
00:14:06,120 --> 00:14:07,860
without a phone

403
00:14:07,860 --> 00:14:09,660
in two weeks after setting up this

404
00:14:09,660 --> 00:14:11,940
account it said hey we need a backup

405
00:14:11,940 --> 00:14:13,560
email or a phone so I went to the

406
00:14:13,560 --> 00:14:15,959
Disposable email site I generated an

407
00:14:15,959 --> 00:14:18,360
email gave that to Outlook it gave me a

408
00:14:18,360 --> 00:14:21,540
six digit PIN I gave it back and then

409
00:14:21,540 --> 00:14:23,820
I'm golden forever and you can do this

410
00:14:23,820 --> 00:14:26,100
over Tour by the way

411
00:14:26,100 --> 00:14:28,680
remember Jade CV site

412
00:14:28,680 --> 00:14:31,500
I embedded a canary token if you don't

413
00:14:31,500 --> 00:14:33,120
know what Canary tokens are there these

414
00:14:33,120 --> 00:14:34,560
little web bugs that you can put in

415
00:14:34,560 --> 00:14:36,959
various things like Doc documents and

416
00:14:36,959 --> 00:14:39,480
websites and AWS keys and what happens

417
00:14:39,480 --> 00:14:41,579
is when somebody trips on this it starts

418
00:14:41,579 --> 00:14:45,420
giving you information about the visitor

419
00:14:45,420 --> 00:14:46,920
look forward there we go

420
00:14:46,920 --> 00:14:49,160
so I send off an email to

421
00:14:49,160 --> 00:14:51,720
infocompanen.com to whom it may concern

422
00:14:51,720 --> 00:14:54,060
I found your job posting for technical

423
00:14:54,060 --> 00:14:55,560
customer service rep and my

424
00:14:55,560 --> 00:14:57,660
qualifications are not an exact match

425
00:14:57,660 --> 00:15:00,120
which is technically not true they are

426
00:15:00,120 --> 00:15:01,980
however I'm attempting to secure

427
00:15:01,980 --> 00:15:03,300
employment in the Bay Area to be close

428
00:15:03,300 --> 00:15:04,620
to my family I appreciate your

429
00:15:04,620 --> 00:15:06,779
consideration blah blah blah kind

430
00:15:06,779 --> 00:15:10,320
regards Jade in her signature block I've

431
00:15:10,320 --> 00:15:12,839
got a link to the CV I've also got a

432
00:15:12,839 --> 00:15:14,399
link to LinkedIn which is just LinkedIn

433
00:15:14,399 --> 00:15:17,279
but the CV's got the canary token

434
00:15:17,279 --> 00:15:19,860
it's subtle I don't know that they're

435
00:15:19,860 --> 00:15:22,620
gonna click the link to the CV spoiler

436
00:15:22,620 --> 00:15:25,139
alert they click the link to the CV but

437
00:15:25,139 --> 00:15:27,779
should they but should if they had not I

438
00:15:27,779 --> 00:15:29,399
would just go around and around and then

439
00:15:29,399 --> 00:15:30,839
eventually I would send them a link to

440
00:15:30,839 --> 00:15:32,279
something or I would send them a

441
00:15:32,279 --> 00:15:33,300
document

442
00:15:33,300 --> 00:15:36,660
what we get is this so after this

443
00:15:36,660 --> 00:15:38,519
document or after this uh email went

444
00:15:38,519 --> 00:15:41,279
around and around I get five hits I get

445
00:15:41,279 --> 00:15:43,320
an incident list and then when I dig

446
00:15:43,320 --> 00:15:45,839
into the incident what I get is an IP

447
00:15:45,839 --> 00:15:47,839
address and I get user agent information

448
00:15:47,839 --> 00:15:51,120
so I'm starting an engagement blind in

449
00:15:51,120 --> 00:15:52,800
this environment I don't know anything

450
00:15:52,800 --> 00:15:54,899
about this environment I do know that

451
00:15:54,899 --> 00:15:56,699
Windows controls seventy percent of the

452
00:15:56,699 --> 00:15:58,680
operating system Market but I'm on the

453
00:15:58,680 --> 00:16:00,000
Mac there's somebody in this room that's

454
00:16:00,000 --> 00:16:02,279
using Linux what I'm trying to get is

455
00:16:02,279 --> 00:16:05,279
information essentially for free that I

456
00:16:05,279 --> 00:16:07,079
do not have going into this environment

457
00:16:07,079 --> 00:16:09,360
the other thing that I get is uh this

458
00:16:09,360 --> 00:16:10,920
user in particular is using Firefox

459
00:16:10,920 --> 00:16:12,779
might look up the version see if there's

460
00:16:12,779 --> 00:16:14,279
a vulnerability but it's just

461
00:16:14,279 --> 00:16:15,720
information that I can get for free

462
00:16:15,720 --> 00:16:17,639
without a little effort

463
00:16:17,639 --> 00:16:19,800
so next topic calling this

464
00:16:19,800 --> 00:16:22,380
multi-function Madness

465
00:16:22,380 --> 00:16:24,180
this is tank

466
00:16:24,180 --> 00:16:25,980
is real

467
00:16:25,980 --> 00:16:29,100
he is a 70 pound Pitbull and he's my

468
00:16:29,100 --> 00:16:31,440
buddy and tank has the prey drive of

469
00:16:31,440 --> 00:16:33,839
like on a scale from one to ten tank is

470
00:16:33,839 --> 00:16:36,720
a 15. tank is the kind of dog when you

471
00:16:36,720 --> 00:16:38,699
open up the door he surveys the

472
00:16:38,699 --> 00:16:40,680
perimeter

473
00:16:40,680 --> 00:16:42,899
I live in Arizona we back up to the

474
00:16:42,899 --> 00:16:44,880
desert we got lots of desert creatures

475
00:16:44,880 --> 00:16:46,500
that roam in and out of our backyard

476
00:16:46,500 --> 00:16:48,420
Tank's doing his thing and gets along

477
00:16:48,420 --> 00:16:50,940
the back wall there's this giant [ __ ]

478
00:16:50,940 --> 00:16:52,860
lizard there's my first step on giant

479
00:16:52,860 --> 00:16:55,500
lizard on the wall

480
00:16:55,500 --> 00:16:57,779
tank hits along the back wall sees the

481
00:16:57,779 --> 00:16:59,820
lizard and lizard sees tank

482
00:16:59,820 --> 00:17:02,220
the lizard starts running tank's in

483
00:17:02,220 --> 00:17:04,980
Pursuit the lizard doubles back

484
00:17:04,980 --> 00:17:07,140
tank follows this goes back and forth a

485
00:17:07,140 --> 00:17:08,459
few times

486
00:17:08,459 --> 00:17:10,439
The Listener falls off the wall and tank

487
00:17:10,439 --> 00:17:12,480
bites it in the center and swallows the

488
00:17:12,480 --> 00:17:14,280
thing whole and it was the most

489
00:17:14,280 --> 00:17:16,559
disgusting thing I'd ever seen

490
00:17:16,559 --> 00:17:19,439
it is that kind of dry oh sorry I forgot

491
00:17:19,439 --> 00:17:21,599
so

492
00:17:21,599 --> 00:17:23,699
every day this has been two years ago

493
00:17:23,699 --> 00:17:25,679
every day since that day

494
00:17:25,679 --> 00:17:27,839
I open up the back door and tank makes a

495
00:17:27,839 --> 00:17:29,400
beeline to that spot on the wall it's

496
00:17:29,400 --> 00:17:32,040
crazy and uh like a lizard's gonna

497
00:17:32,040 --> 00:17:34,140
appear for him you know and so it's that

498
00:17:34,140 --> 00:17:36,600
kind of drive that he has this is how I

499
00:17:36,600 --> 00:17:39,720
am with your multi-function copiers I

500
00:17:39,720 --> 00:17:40,559
love

501
00:17:40,559 --> 00:17:42,000
my fears

502
00:17:42,000 --> 00:17:43,919
because it's funny like after an

503
00:17:43,919 --> 00:17:45,299
engagement people are like well you know

504
00:17:45,299 --> 00:17:47,280
Hecker is going to make free coffees no

505
00:17:47,280 --> 00:17:50,039
the [ __ ] has privileged access it scans

506
00:17:50,039 --> 00:17:52,980
to file and it scans the email so I'm on

507
00:17:52,980 --> 00:17:54,419
an engagement

508
00:17:54,419 --> 00:17:56,880
I get into The copier it's scanned a

509
00:17:56,880 --> 00:17:57,900
file

510
00:17:57,900 --> 00:17:59,940
it's scanning into users home

511
00:17:59,940 --> 00:18:02,100
directories and those are restricted to

512
00:18:02,100 --> 00:18:04,320
the individual user so instead of taking

513
00:18:04,320 --> 00:18:06,240
that user account and giving it access

514
00:18:06,240 --> 00:18:08,400
to those those directories they just

515
00:18:08,400 --> 00:18:10,620
made it domain admin I took over the

516
00:18:10,620 --> 00:18:12,720
scanner account I'm domain admin game

517
00:18:12,720 --> 00:18:13,799
over

518
00:18:13,799 --> 00:18:16,740
and another one with scan to file I get

519
00:18:16,740 --> 00:18:18,179
in and I see that there are no

520
00:18:18,179 --> 00:18:20,220
credentials so I think it's a mail relay

521
00:18:20,220 --> 00:18:22,919
and the back story is they were changing

522
00:18:22,919 --> 00:18:24,960
passwords every 30 days

523
00:18:24,960 --> 00:18:26,880
and it was breaking the scan to email

524
00:18:26,880 --> 00:18:30,059
function every 30 days so what they did

525
00:18:30,059 --> 00:18:31,559
was they decided they were going to

526
00:18:31,559 --> 00:18:34,140
White list an IP for mail relay except

527
00:18:34,140 --> 00:18:36,059
instead of doing a one-to-one mapping

528
00:18:36,059 --> 00:18:38,520
from the from the scanner through the

529
00:18:38,520 --> 00:18:40,679
the firewall they just whitelisted the

530
00:18:40,679 --> 00:18:43,440
entire network so I get in I don't see

531
00:18:43,440 --> 00:18:45,539
credentials in there I think mail relay

532
00:18:45,539 --> 00:18:47,880
I'm inside the network I send off an

533
00:18:47,880 --> 00:18:49,679
email and it goes through so I started

534
00:18:49,679 --> 00:18:51,840
phishing everybody in the company off of

535
00:18:51,840 --> 00:18:54,120
the mail relay and I was bypassing their

536
00:18:54,120 --> 00:18:56,220
security controls

537
00:18:56,220 --> 00:18:58,380
so here I am on this engagement and I

538
00:18:58,380 --> 00:19:00,660
find one of my favorite devices a copier

539
00:19:00,660 --> 00:19:02,940
here's this Xerox Versa link so I go to

540
00:19:02,940 --> 00:19:04,980
Google and I say Google what is the

541
00:19:04,980 --> 00:19:06,600
default password and Google says one one

542
00:19:06,600 --> 00:19:09,720
one that seems safe

543
00:19:09,720 --> 00:19:11,460
so I go to the login page one one one

544
00:19:11,460 --> 00:19:14,100
one cross my fingers upper right hand

545
00:19:14,100 --> 00:19:17,220
corner I'm logged in as admin

546
00:19:17,220 --> 00:19:19,320
so I get into the settings and it

547
00:19:19,320 --> 00:19:21,240
actually has credentials in there but I

548
00:19:21,240 --> 00:19:23,880
get this idea I'm gonna put my attacking

549
00:19:23,880 --> 00:19:26,880
server IP address in as the mail server

550
00:19:26,880 --> 00:19:28,320
and then I'm going to downgrade the port

551
00:19:28,320 --> 00:19:30,120
to 25 and the reason why I'm doing that

552
00:19:30,120 --> 00:19:32,820
is because it's unencrypted

553
00:19:32,820 --> 00:19:35,580
now if I were to make scanner software I

554
00:19:35,580 --> 00:19:37,200
would make it so that if you made

555
00:19:37,200 --> 00:19:39,000
modification to the settings it would

556
00:19:39,000 --> 00:19:40,500
blank out the password but I have never

557
00:19:40,500 --> 00:19:43,340
found that to be the case

558
00:19:43,440 --> 00:19:45,720
when I started engagement I fire up a

559
00:19:45,720 --> 00:19:48,000
tool called responder responder is an LL

560
00:19:48,000 --> 00:19:50,039
MNR poisoner it's basically used to do

561
00:19:50,039 --> 00:19:52,020
bad things for Microsoft but in this

562
00:19:52,020 --> 00:19:53,700
case I'm going to use it to catch

563
00:19:53,700 --> 00:19:56,700
credentials off this scanner hopefully

564
00:19:56,700 --> 00:19:59,340
so I've got the SMTP server set to my

565
00:19:59,340 --> 00:20:01,440
attacking server I've downgraded the 425

566
00:20:01,440 --> 00:20:03,600
for uh because it's not encrypted and

567
00:20:03,600 --> 00:20:05,520
then I throw in a bogus email and I hit

568
00:20:05,520 --> 00:20:08,340
test and back in responder I get cleared

569
00:20:08,340 --> 00:20:11,100
text credentials from that scanner

570
00:20:11,100 --> 00:20:12,900
so when I get in your environment I'm a

571
00:20:12,900 --> 00:20:15,299
scan for all the copiers and if we're

572
00:20:15,299 --> 00:20:17,039
counting them I got 19 and I'm going to

573
00:20:17,039 --> 00:20:19,200
go through every single one of these and

574
00:20:19,200 --> 00:20:20,160
I'm going to look and see if there's

575
00:20:20,160 --> 00:20:21,660
some credentials that I can abuse in

576
00:20:21,660 --> 00:20:23,220
there or steal or whatever

577
00:20:23,220 --> 00:20:26,520
so that scanner account that we just uh

578
00:20:26,520 --> 00:20:28,500
we just captured it actually wasn't

579
00:20:28,500 --> 00:20:30,360
domain admin but what it gave me access

580
00:20:30,360 --> 00:20:33,480
to was HR and accounting so for defining

581
00:20:33,480 --> 00:20:36,960
impact HR spii finances money right so

582
00:20:36,960 --> 00:20:38,940
in my pen test report I say the

583
00:20:38,940 --> 00:20:40,440
penetration tester use tools and

584
00:20:40,440 --> 00:20:42,000
techniques to extract data from the

585
00:20:42,000 --> 00:20:43,740
network simulating the actions of a

586
00:20:43,740 --> 00:20:46,200
malicious attacker you got ransomware

587
00:20:46,200 --> 00:20:48,179
gangs they get into your network they

588
00:20:48,179 --> 00:20:50,280
encrypt your files and then they say pay

589
00:20:50,280 --> 00:20:51,960
us or we're going to take your data and

590
00:20:51,960 --> 00:20:53,940
we're going to dump it on the internet I

591
00:20:53,940 --> 00:20:55,440
basically just simulated that because

592
00:20:55,440 --> 00:20:57,120
they've they're exfiltrating your data

593
00:20:57,120 --> 00:20:59,700
and that's what I can do

594
00:20:59,700 --> 00:21:03,299
this next one I'm calling evil bookmark

595
00:21:03,299 --> 00:21:04,740
I need to give you a little backstory on

596
00:21:04,740 --> 00:21:07,320
this so in my scoping document I ask how

597
00:21:07,320 --> 00:21:09,179
is the penetration tester obtaining

598
00:21:09,179 --> 00:21:10,980
access to the network so it might be

599
00:21:10,980 --> 00:21:14,100
over a VPN uh if they don't manage the

600
00:21:14,100 --> 00:21:15,840
network and maybe they've got an IDs

601
00:21:15,840 --> 00:21:17,820
I'll send them an Intel Nook which is a

602
00:21:17,820 --> 00:21:19,500
little computer and I'll ship it off to

603
00:21:19,500 --> 00:21:20,760
them and say drop this in the middle of

604
00:21:20,760 --> 00:21:22,740
your network plug it in turn it on it

605
00:21:22,740 --> 00:21:24,240
calls back to my attacking server and

606
00:21:24,240 --> 00:21:25,980
then I tunnel back in and do my thing

607
00:21:25,980 --> 00:21:28,980
another option is a jump box and that's

608
00:21:28,980 --> 00:21:31,140
where this is going

609
00:21:31,140 --> 00:21:34,559
so I get into the jump box and to my

610
00:21:34,559 --> 00:21:37,320
surprise the computer is inserted into

611
00:21:37,320 --> 00:21:38,580
the domain

612
00:21:38,580 --> 00:21:41,159
and my domain or my account is a domain

613
00:21:41,159 --> 00:21:43,799
user account and it maps drives for me

614
00:21:43,799 --> 00:21:46,559
and I'm like that is way way too much

615
00:21:46,559 --> 00:21:48,120
access that was not how that's supposed

616
00:21:48,120 --> 00:21:49,140
to go down but I'm like [ __ ] it I'm

617
00:21:49,140 --> 00:21:50,340
gonna run with it

618
00:21:50,340 --> 00:21:51,539
so

619
00:21:51,539 --> 00:21:53,640
I had this idea so this is a bookmark

620
00:21:53,640 --> 00:21:55,140
right and what we got is this little

621
00:21:55,140 --> 00:21:56,760
picture and we got this arrow that

622
00:21:56,760 --> 00:21:59,220
indicates shortcut when we look at this

623
00:21:59,220 --> 00:22:01,140
at the file system level really all it

624
00:22:01,140 --> 00:22:04,559
is is a file name that ends in dot URL

625
00:22:04,559 --> 00:22:07,020
when we look inside it's this four lines

626
00:22:07,020 --> 00:22:08,340
of code right so it says internet

627
00:22:08,340 --> 00:22:10,620
shortcut uh it's got the resource

628
00:22:10,620 --> 00:22:13,140
google.com and what generates that

629
00:22:13,140 --> 00:22:16,080
picture is the reference to Icon file so

630
00:22:16,080 --> 00:22:17,940
I'm putting pointing this to my

631
00:22:17,940 --> 00:22:20,580
attacking server

632
00:22:20,580 --> 00:22:22,980
now I dropped this on this common share

633
00:22:22,980 --> 00:22:25,740
that I have access to thank you

634
00:22:25,740 --> 00:22:28,260
and I want you to recall when we went to

635
00:22:28,260 --> 00:22:30,240
the desktop and you saw that tweet deck

636
00:22:30,240 --> 00:22:32,340
icon that little bird we didn't have to

637
00:22:32,340 --> 00:22:34,320
do anything to get that to render it's

638
00:22:34,320 --> 00:22:37,200
the act of opening to that location that

639
00:22:37,200 --> 00:22:39,120
causes it to look for the icon file so

640
00:22:39,120 --> 00:22:40,679
it's just dropping this out there when

641
00:22:40,679 --> 00:22:43,559
people open it up it should start

642
00:22:43,559 --> 00:22:45,720
sending things back to my attacking

643
00:22:45,720 --> 00:22:48,059
server so I've got responding server

644
00:22:48,059 --> 00:22:50,580
still fired up

645
00:22:50,580 --> 00:22:53,100
it starts raining hashes and I'm taking

646
00:22:53,100 --> 00:22:55,020
hashes and I'm throwing them into hash

647
00:22:55,020 --> 00:22:56,760
cat and I'm cracking them and then all

648
00:22:56,760 --> 00:22:58,500
of a sudden I get the administrator

649
00:22:58,500 --> 00:23:00,900
account the administrator account and

650
00:23:00,900 --> 00:23:04,020
I'm like what is going on and so I'm

651
00:23:04,020 --> 00:23:05,760
doing the postmortem on this with the

652
00:23:05,760 --> 00:23:08,039
client and it turns out there was an

653
00:23:08,039 --> 00:23:10,200
administrator using the administrator

654
00:23:10,200 --> 00:23:12,000
account as his personal user account I'm

655
00:23:12,000 --> 00:23:13,559
like that is something you shouldn't be

656
00:23:13,559 --> 00:23:15,059
doing

657
00:23:15,059 --> 00:23:17,460
all right next we got tell me your

658
00:23:17,460 --> 00:23:18,900
secrets

659
00:23:18,900 --> 00:23:21,000
so I started my engagement and I go to a

660
00:23:21,000 --> 00:23:23,039
I go to Hunter i o and if you don't know

661
00:23:23,039 --> 00:23:25,260
what Hunter i o is it'll tell you uh

662
00:23:25,260 --> 00:23:27,419
known email addresses for this domain

663
00:23:27,419 --> 00:23:29,100
name the other thing that it'll tell you

664
00:23:29,100 --> 00:23:31,559
is the name format right so in the case

665
00:23:31,559 --> 00:23:32,820
of this client which is a little small

666
00:23:32,820 --> 00:23:37,080
it's first name dot last initial so I

667
00:23:37,080 --> 00:23:40,140
take the 200 most common names and then

668
00:23:40,140 --> 00:23:41,880
I do a little bash magic and basically

669
00:23:41,880 --> 00:23:43,500
what I'm doing is I'm taking that list

670
00:23:43,500 --> 00:23:47,159
and I'm appending dot a through dot Z to

671
00:23:47,159 --> 00:23:48,840
the end of all of those basically trying

672
00:23:48,840 --> 00:23:51,299
to match that format right so you know

673
00:23:51,299 --> 00:23:53,220
Aaron a through o goes through Z do that

674
00:23:53,220 --> 00:23:55,559
for every single name now I'm going to

675
00:23:55,559 --> 00:23:58,860
use a cool a tool called curb root as an

676
00:23:58,860 --> 00:24:01,679
unauthenticated user I can spray the

677
00:24:01,679 --> 00:24:03,840
domain controller with that list and it

678
00:24:03,840 --> 00:24:05,460
will tell me if those are valid

679
00:24:05,460 --> 00:24:08,760
usernames so I'm starting to get hits I

680
00:24:08,760 --> 00:24:10,679
parse that out and I dump it into a text

681
00:24:10,679 --> 00:24:13,679
file that is one half of what I want the

682
00:24:13,679 --> 00:24:16,559
other half is I want passwords now there

683
00:24:16,559 --> 00:24:18,419
was a blog post a few years ago it was a

684
00:24:18,419 --> 00:24:20,159
pen tester and he was finding these

685
00:24:20,159 --> 00:24:22,500
commonalities in his engagements

686
00:24:22,500 --> 00:24:25,320
in particular people would call the help

687
00:24:25,320 --> 00:24:26,880
desk and they would need their password

688
00:24:26,880 --> 00:24:29,220
reset and they helped us trying to be

689
00:24:29,220 --> 00:24:31,140
helpful and following password

690
00:24:31,140 --> 00:24:33,659
complexity rules right so need an upper

691
00:24:33,659 --> 00:24:35,520
need lower need number need a special

692
00:24:35,520 --> 00:24:37,140
character they were doing things like

693
00:24:37,140 --> 00:24:39,480
welcome one exclamation point capital W

694
00:24:39,480 --> 00:24:41,280
the other thing they were doing is the

695
00:24:41,280 --> 00:24:43,500
seasons so spring summer fall Autumn and

696
00:24:43,500 --> 00:24:45,120
then throw in the ear on the end of it

697
00:24:45,120 --> 00:24:47,340
so I took that I'm lazy I script

698
00:24:47,340 --> 00:24:49,500
everything so I've got an array welcome

699
00:24:49,500 --> 00:24:51,419
winter spring summer fall and I've got

700
00:24:51,419 --> 00:24:55,020
the years 2019 through 2022. now the

701
00:24:55,020 --> 00:24:56,760
reason why I'm going back into the past

702
00:24:56,760 --> 00:24:59,220
is what I've found is that sometimes an

703
00:24:59,220 --> 00:25:00,780
account will get shut down and then a

704
00:25:00,780 --> 00:25:03,059
manager will call up and say I need that

705
00:25:03,059 --> 00:25:04,620
account opened up and they'll open it up

706
00:25:04,620 --> 00:25:06,240
and they'll say okay yeah we reset the

707
00:25:06,240 --> 00:25:08,100
password and it's summer 2021

708
00:25:08,100 --> 00:25:10,140
exclamation point so we have actually

709
00:25:10,140 --> 00:25:12,179
found accounts from previous years it

710
00:25:12,179 --> 00:25:14,220
just got left open another thing that

711
00:25:14,220 --> 00:25:15,299
I'm going to do

712
00:25:15,299 --> 00:25:16,980
is I'm going to go through their website

713
00:25:16,980 --> 00:25:18,600
do they make a product or they in an

714
00:25:18,600 --> 00:25:20,340
industry can I take those words you know

715
00:25:20,340 --> 00:25:21,720
those words that might be used in a

716
00:25:21,720 --> 00:25:23,340
password I'm going to grab stuff from

717
00:25:23,340 --> 00:25:25,320
their address in this case I'm going to

718
00:25:25,320 --> 00:25:26,820
grab Fremont

719
00:25:26,820 --> 00:25:28,440
and then I'm going to make my list so

720
00:25:28,440 --> 00:25:31,620
welcome one Fremont one and the seasons

721
00:25:31,620 --> 00:25:33,419
now I'm going to use a tool called crack

722
00:25:33,419 --> 00:25:35,460
map exact I'm going to call that CME

723
00:25:35,460 --> 00:25:36,960
moving forward because it's a tongue

724
00:25:36,960 --> 00:25:38,159
twister

725
00:25:38,159 --> 00:25:40,500
and I can spray that list of users with

726
00:25:40,500 --> 00:25:42,240
welcome one and what we see is status

727
00:25:42,240 --> 00:25:44,100
log and failure so that is not a good

728
00:25:44,100 --> 00:25:45,480
password for any of those accounts that

729
00:25:45,480 --> 00:25:47,640
I have I come back in with Fremont one

730
00:25:47,640 --> 00:25:49,560
and I get a hit jody.o

731
00:25:49,560 --> 00:25:51,419
[Music]

732
00:25:51,419 --> 00:25:53,820
so I'm going to use a tool called Hydra

733
00:25:53,820 --> 00:25:56,340
and Hydra is a brute forcing tool

734
00:25:56,340 --> 00:25:57,720
typically it would give it a username

735
00:25:57,720 --> 00:25:59,640
and a bunch of passwords in a list and

736
00:25:59,640 --> 00:26:01,200
you would spray a service I actually

737
00:26:01,200 --> 00:26:03,419
know the username and the password what

738
00:26:03,419 --> 00:26:05,400
I'm doing is I'm putting a bash for Loop

739
00:26:05,400 --> 00:26:07,140
in front of this and I'm spraying hosts

740
00:26:07,140 --> 00:26:11,220
1 through 100 looking for open RDP with

741
00:26:11,220 --> 00:26:13,620
that username and password after covid

742
00:26:13,620 --> 00:26:15,960
regular users have been given have been

743
00:26:15,960 --> 00:26:17,580
given remote desktops so this is

744
00:26:17,580 --> 00:26:20,480
something that we hunt for and we find

745
00:26:20,480 --> 00:26:25,020
when I get to host 62 I get a hit

746
00:26:25,020 --> 00:26:27,299
so the question is now what bro pop

747
00:26:27,299 --> 00:26:30,419
shells Metasploit right I could

748
00:26:30,419 --> 00:26:32,820
or I could use connect wise control

749
00:26:32,820 --> 00:26:34,320
if you don't know what connect wise

750
00:26:34,320 --> 00:26:36,480
control is he does

751
00:26:36,480 --> 00:26:38,340
you call the help desk and you say hey I

752
00:26:38,340 --> 00:26:40,080
got a problem with my computer my icons

753
00:26:40,080 --> 00:26:41,580
are upside down and the help desk is

754
00:26:41,580 --> 00:26:42,659
like hey I'll come under your computer

755
00:26:42,659 --> 00:26:44,700
and turn those right side up they use a

756
00:26:44,700 --> 00:26:46,620
tool like connectwise control to screen

757
00:26:46,620 --> 00:26:48,919
share with you

758
00:26:48,919 --> 00:26:51,360
turns out you can set up a connectwise

759
00:26:51,360 --> 00:26:53,039
control account as any old person

760
00:26:53,039 --> 00:26:55,860
without a credit card so I use Jade

761
00:26:55,860 --> 00:26:57,120
because why not

762
00:26:57,120 --> 00:26:58,980
I'd like to point out that if you

763
00:26:58,980 --> 00:27:00,419
actually I learned earlier that I could

764
00:27:00,419 --> 00:27:02,279
I could actually hop in with somebody on

765
00:27:02,279 --> 00:27:04,440
RDP but prior to hearing that earlier

766
00:27:04,440 --> 00:27:06,059
today in a talk

767
00:27:06,059 --> 00:27:08,760
um I would typically not want to log in

768
00:27:08,760 --> 00:27:10,260
when a user is on their machine because

769
00:27:10,260 --> 00:27:11,700
it'll bounce them out it's going to draw

770
00:27:11,700 --> 00:27:13,620
attention so I typically want to work

771
00:27:13,620 --> 00:27:15,840
after hours in the case of this client I

772
00:27:15,840 --> 00:27:17,340
hopped in at four o'clock in the morning

773
00:27:17,340 --> 00:27:19,140
I know it sucked but that's when I did

774
00:27:19,140 --> 00:27:20,580
it

775
00:27:20,580 --> 00:27:22,620
stop connect wise control

776
00:27:22,620 --> 00:27:25,260
and Jody Dash PC shows up in my console

777
00:27:25,260 --> 00:27:27,059
bottom left-hand Corner trial will

778
00:27:27,059 --> 00:27:28,740
expire in 14 days that's super

779
00:27:28,740 --> 00:27:30,000
convenient because my engagements

780
00:27:30,000 --> 00:27:32,659
usually the last two weeks

781
00:27:32,659 --> 00:27:35,580
I'm trying to get remote code execution

782
00:27:35,580 --> 00:27:37,559
and that's what I'm doing here I execute

783
00:27:37,559 --> 00:27:39,419
the command who am I it gives me back NT

784
00:27:39,419 --> 00:27:41,159
Authority system so I don't need

785
00:27:41,159 --> 00:27:42,600
Metasploit I don't need to have to do

786
00:27:42,600 --> 00:27:44,400
evasion techniques or disable defender

787
00:27:44,400 --> 00:27:46,740
or whatever I can just get this on the

788
00:27:46,740 --> 00:27:48,419
machine because it's a legitimate

789
00:27:48,419 --> 00:27:50,940
application

790
00:27:50,940 --> 00:27:52,440
like to point out that this dumpster

791
00:27:52,440 --> 00:27:55,260
fire was brought to you by local admin

792
00:27:55,260 --> 00:27:58,380
if you give your users local admin I'm

793
00:27:58,380 --> 00:28:00,900
gonna wreck your [ __ ]

794
00:28:00,900 --> 00:28:02,580
so I'm on the user's desktop it's

795
00:28:02,580 --> 00:28:04,620
enumeration time if you've ever played

796
00:28:04,620 --> 00:28:07,080
the CTF world there's a offensive

797
00:28:07,080 --> 00:28:09,179
Powershell called Powersport I've never

798
00:28:09,179 --> 00:28:11,340
used that in the real world I actually

799
00:28:11,340 --> 00:28:13,080
live off the land I tend to just use

800
00:28:13,080 --> 00:28:14,940
Windows against itself and active and

801
00:28:14,940 --> 00:28:17,580
active directory the same uh so because

802
00:28:17,580 --> 00:28:19,380
I'm a local admin I'm gonna harp on that

803
00:28:19,380 --> 00:28:21,960
I can install rsat remote server admin

804
00:28:21,960 --> 00:28:24,240
tools so I get it installed and I start

805
00:28:24,240 --> 00:28:25,919
querying the environment what I'm

806
00:28:25,919 --> 00:28:27,720
looking for is password never expires

807
00:28:27,720 --> 00:28:30,360
password last set so I find a few

808
00:28:30,360 --> 00:28:32,580
accounts that are set to true so those

809
00:28:32,580 --> 00:28:34,799
are password never expires the reason

810
00:28:34,799 --> 00:28:36,240
why I'm hunting these down is because

811
00:28:36,240 --> 00:28:37,620
I've actually been in the middle of an

812
00:28:37,620 --> 00:28:39,360
engagement where I get creds and then I

813
00:28:39,360 --> 00:28:41,400
lose them so if I can take over these

814
00:28:41,400 --> 00:28:43,919
accounts I know I'm good another thing

815
00:28:43,919 --> 00:28:45,120
that I'm gonna look for is service

816
00:28:45,120 --> 00:28:48,059
accounts because typically they set them

817
00:28:48,059 --> 00:28:49,620
to never expire and they always throw

818
00:28:49,620 --> 00:28:51,659
them into the domain admins group

819
00:28:51,659 --> 00:28:54,360
now at the bottom I see this comp ad and

820
00:28:54,360 --> 00:28:55,740
my I don't know what that is that's not

821
00:28:55,740 --> 00:28:57,779
that's something weird and I think in my

822
00:28:57,779 --> 00:28:59,400
head I have to like imagine what this

823
00:28:59,400 --> 00:29:00,840
could be and I think maybe they're using

824
00:29:00,840 --> 00:29:02,880
it to insert computers in the domain I

825
00:29:02,880 --> 00:29:05,039
query domain admins and that account is

826
00:29:05,039 --> 00:29:06,539
in the domain admin script so that would

827
00:29:06,539 --> 00:29:09,539
be an account that I would go after

828
00:29:09,539 --> 00:29:12,539
that's a very very a lot of stuff that

829
00:29:12,539 --> 00:29:14,340
you can't see but basically this is all

830
00:29:14,340 --> 00:29:15,840
the custom Powershell that I've written

831
00:29:15,840 --> 00:29:17,400
that lives off the lamp

832
00:29:17,400 --> 00:29:18,899
um and I can do a whole talk on active

833
00:29:18,899 --> 00:29:21,059
directory another time but but basically

834
00:29:21,059 --> 00:29:22,740
unless you're looking for like

835
00:29:22,740 --> 00:29:24,659
Powershell execution I can do all this

836
00:29:24,659 --> 00:29:26,820
stuff I'm not getting detected

837
00:29:26,820 --> 00:29:29,779
all right I want to rewind

838
00:29:30,539 --> 00:29:32,580
I'm on this system

839
00:29:32,580 --> 00:29:35,279
I see Jody we're Jody we know this but I

840
00:29:35,279 --> 00:29:37,620
also see a disconnected user account

841
00:29:37,620 --> 00:29:40,440
now there was a there is a tool called

842
00:29:40,440 --> 00:29:42,659
Mimi cats that you could use to dump

843
00:29:42,659 --> 00:29:44,520
lsats but mimicats has been neutered

844
00:29:44,520 --> 00:29:45,600
recently

845
00:29:45,600 --> 00:29:48,059
but because I'm local admin

846
00:29:48,059 --> 00:29:49,860
I don't need it I can right click in

847
00:29:49,860 --> 00:29:51,419
task manager and I can create a dump

848
00:29:51,419 --> 00:29:53,640
file of lsas if you don't know what lsas

849
00:29:53,640 --> 00:29:56,340
is it it contains clear correct clear

850
00:29:56,340 --> 00:29:59,159
text credentials and password hashes so

851
00:29:59,159 --> 00:30:00,960
I dump it to a file and it says hey it's

852
00:30:00,960 --> 00:30:02,880
in this temp folder and then moments

853
00:30:02,880 --> 00:30:04,740
later Defender kicks in and says whoa

854
00:30:04,740 --> 00:30:06,419
that was a severe behavior and I'm like

855
00:30:06,419 --> 00:30:07,980
oh [ __ ] it's going to delete that file

856
00:30:07,980 --> 00:30:09,899
so I immediately jump into the folder

857
00:30:09,899 --> 00:30:12,299
and I zip a copy in place and then I

858
00:30:12,299 --> 00:30:14,760
drag a copy to the desktop moments after

859
00:30:14,760 --> 00:30:17,039
that Defender deletes that file but it

860
00:30:17,039 --> 00:30:18,659
leaves the zip file and it leaves the

861
00:30:18,659 --> 00:30:21,059
one on the desktop so it's the act of

862
00:30:21,059 --> 00:30:23,340
dumping lsas and not the presence of the

863
00:30:23,340 --> 00:30:25,620
file so Defender almost there but not

864
00:30:25,620 --> 00:30:28,200
quite and because I'm local admin I

865
00:30:28,200 --> 00:30:31,340
disable Defender because

866
00:30:32,419 --> 00:30:34,260
foreign

867
00:30:34,260 --> 00:30:36,720
so I dropped Mimi cats on the box I

868
00:30:36,720 --> 00:30:37,740
didn't have to I could have fold this

869
00:30:37,740 --> 00:30:38,760
over

870
00:30:38,760 --> 00:30:40,799
um and it pointed to my dump file and

871
00:30:40,799 --> 00:30:42,059
the first thing that we see at the

872
00:30:42,059 --> 00:30:44,399
bottom is uh the administrator account

873
00:30:44,399 --> 00:30:46,260
and the password hash so hold that

874
00:30:46,260 --> 00:30:48,179
thought though so then I get some clear

875
00:30:48,179 --> 00:30:50,940
text credentials and then I'm looking at

876
00:30:50,940 --> 00:30:52,620
this clear text credential I'm like I

877
00:30:52,620 --> 00:30:55,320
recognize that that's office 365. and

878
00:30:55,320 --> 00:30:56,880
this is an email account I'm like I'm

879
00:30:56,880 --> 00:30:58,559
gonna log into OHA Outlook web access

880
00:30:58,559 --> 00:30:59,940
webmail

881
00:30:59,940 --> 00:31:03,000
so I go to OA I gave it my username and

882
00:31:03,000 --> 00:31:05,279
password and then it throws up and I'm

883
00:31:05,279 --> 00:31:06,960
like well that's weird it accepted the

884
00:31:06,960 --> 00:31:09,120
credential but it threw up and I'm like

885
00:31:09,120 --> 00:31:10,140
I don't know what this is but it's

886
00:31:10,140 --> 00:31:12,419
base64 so I'm going to decode it

887
00:31:12,419 --> 00:31:14,880
so it says the mailbox being accessed

888
00:31:14,880 --> 00:31:16,559
doesn't have a valid account State

889
00:31:16,559 --> 00:31:19,860
protocol disabled now again I have to

890
00:31:19,860 --> 00:31:21,539
conjure up in my head like what is going

891
00:31:21,539 --> 00:31:23,580
on here

892
00:31:23,580 --> 00:31:25,799
I think that they didn't want to enable

893
00:31:25,799 --> 00:31:27,840
two-factor authentication so what they

894
00:31:27,840 --> 00:31:30,240
did was they disabled Outlook web access

895
00:31:30,240 --> 00:31:33,480
but you don't create a mailbox unless

896
00:31:33,480 --> 00:31:35,340
you want to give user access one way

897
00:31:35,340 --> 00:31:37,380
shape or form right so I'm thinking well

898
00:31:37,380 --> 00:31:40,020
you know I'm on Jody's system I got

899
00:31:40,020 --> 00:31:42,539
Outlook I fire up a new profile

900
00:31:42,539 --> 00:31:45,720
configure it with info at give it the

901
00:31:45,720 --> 00:31:47,820
password and when I see this I know I'm

902
00:31:47,820 --> 00:31:49,919
golden because you're all set

903
00:31:49,919 --> 00:31:52,440
so I get into the user's mailbox now it

904
00:31:52,440 --> 00:31:54,240
wasn't in scope to dig into this user's

905
00:31:54,240 --> 00:31:55,020
mail

906
00:31:55,020 --> 00:31:56,820
but the thing that Drew my attention was

907
00:31:56,820 --> 00:31:58,620
this down at the bottom

908
00:31:58,620 --> 00:32:01,500
it says cyber suppliers cyber security

909
00:32:01,500 --> 00:32:04,559
and it's from Raytheon now a few years

910
00:32:04,559 --> 00:32:06,059
back the government was basically

911
00:32:06,059 --> 00:32:07,559
getting tired of being hacked through

912
00:32:07,559 --> 00:32:09,419
the supply chain so they came up with

913
00:32:09,419 --> 00:32:11,580
some compliance things for their vendors

914
00:32:11,580 --> 00:32:12,960
and they were saying all right your

915
00:32:12,960 --> 00:32:15,120
vendors vendors need to go through some

916
00:32:15,120 --> 00:32:16,919
of this I think dfars is the bottom of

917
00:32:16,919 --> 00:32:17,880
this Barrel

918
00:32:17,880 --> 00:32:19,620
now the thing that's really amusing to

919
00:32:19,620 --> 00:32:21,000
me is having just finished the

920
00:32:21,000 --> 00:32:22,860
penetration test for this client I know

921
00:32:22,860 --> 00:32:24,120
for a fact that they're not dfars

922
00:32:24,120 --> 00:32:25,740
compliant the other thing that's really

923
00:32:25,740 --> 00:32:28,860
amusing is that this is dated 2016. like

924
00:32:28,860 --> 00:32:31,799
they are six years not complete all

925
00:32:31,799 --> 00:32:33,299
right

926
00:32:33,299 --> 00:32:34,740
so you want to rewind back to that

927
00:32:34,740 --> 00:32:36,600
administrator account I'm going in for

928
00:32:36,600 --> 00:32:39,120
the kill shot

929
00:32:39,120 --> 00:32:41,520
I fire up CME I pointed to the domain

930
00:32:41,520 --> 00:32:42,960
controller I give it the administrator

931
00:32:42,960 --> 00:32:45,120
account and that password hash

932
00:32:45,120 --> 00:32:47,700
bottom right hand or we see the command

933
00:32:47,700 --> 00:32:49,559
completed successfully so that is a

934
00:32:49,559 --> 00:32:51,120
valid hash for that account

935
00:32:51,120 --> 00:32:53,640
I double checked on Main admins and

936
00:32:53,640 --> 00:32:56,880
jody.o is in the domain admins group did

937
00:32:56,880 --> 00:32:59,700
I did I skip a slide oh no sorry yeah

938
00:32:59,700 --> 00:33:02,039
and so Jody is in the domain admins

939
00:33:02,039 --> 00:33:03,120
group

940
00:33:03,120 --> 00:33:05,580
so that's a fatality uh so I've

941
00:33:05,580 --> 00:33:07,980
exfiltrated data I've taken over the

942
00:33:07,980 --> 00:33:09,899
mail server I've been in a user's

943
00:33:09,899 --> 00:33:11,640
mailbox and I've taken over the domain

944
00:33:11,640 --> 00:33:15,419
admin so now let's talk about Solutions

945
00:33:15,419 --> 00:33:18,059
burn it all down

946
00:33:18,059 --> 00:33:20,100
any Defenders in the room

947
00:33:20,100 --> 00:33:22,200
anyone I'm sorry

948
00:33:22,200 --> 00:33:24,059
now I got Solutions

949
00:33:24,059 --> 00:33:27,600
uh gamify fishing this is something uh

950
00:33:27,600 --> 00:33:30,000
users don't care right you know if their

951
00:33:30,000 --> 00:33:31,320
computer gets ransomware they're like

952
00:33:31,320 --> 00:33:32,760
not my computer why do I care like I

953
00:33:32,760 --> 00:33:34,559
only care about my home computer so what

954
00:33:34,559 --> 00:33:36,360
we have found is that you we have to get

955
00:33:36,360 --> 00:33:39,419
them engaged so uh pre-covid what we

956
00:33:39,419 --> 00:33:40,620
would do is we would give out these

957
00:33:40,620 --> 00:33:42,600
little rubber or little glass fish bowls

958
00:33:42,600 --> 00:33:44,340
and every time they completed the

959
00:33:44,340 --> 00:33:45,899
campaign successfully we would give them

960
00:33:45,899 --> 00:33:47,580
rubber fish we found that they started

961
00:33:47,580 --> 00:33:49,320
competing against each other to get more

962
00:33:49,320 --> 00:33:51,899
fish in their bowl uh post covid we

963
00:33:51,899 --> 00:33:54,360
started using Starbucks gift cards so

964
00:33:54,360 --> 00:33:56,760
remember these are small businesses so a

965
00:33:56,760 --> 00:33:58,919
hundred employees I'm doing my campaigns

966
00:33:58,919 --> 00:34:00,539
across the entire quarter and we say

967
00:34:00,539 --> 00:34:01,620
we're gonna give you a five dollar

968
00:34:01,620 --> 00:34:03,659
Starbucks gift card if you successfully

969
00:34:03,659 --> 00:34:06,179
complete this campaign 500 a quarter

970
00:34:06,179 --> 00:34:08,280
that's like pretzels and coffee probably

971
00:34:08,280 --> 00:34:11,099
right and then what we do is we'll set

972
00:34:11,099 --> 00:34:12,300
some benchmarks for them you know we'll

973
00:34:12,300 --> 00:34:14,219
say all right eating you know 10 people

974
00:34:14,219 --> 00:34:16,619
click the link but two people report it

975
00:34:16,619 --> 00:34:18,659
we want 10 people reporting and then

976
00:34:18,659 --> 00:34:20,099
we're going to start you know raising or

977
00:34:20,099 --> 00:34:21,780
moving the goal posts basically get them

978
00:34:21,780 --> 00:34:24,300
you know at least get them to 16 which

979
00:34:24,300 --> 00:34:25,859
is the average like the bottom of the

980
00:34:25,859 --> 00:34:27,540
average past

981
00:34:27,540 --> 00:34:29,820
managers in 2fa we've been kind of

982
00:34:29,820 --> 00:34:31,500
beating that dead horse for the last 20

983
00:34:31,500 --> 00:34:32,820
years

984
00:34:32,820 --> 00:34:35,580
um if you're not doing it do it AV to

985
00:34:35,580 --> 00:34:38,280
EDR so antivirus to endpoint detect and

986
00:34:38,280 --> 00:34:40,379
respond if you don't know what EDR is

987
00:34:40,379 --> 00:34:42,480
it's fancy antivirus

988
00:34:42,480 --> 00:34:44,099
um and it used to be Enterprise

989
00:34:44,099 --> 00:34:46,260
expensive and now it is small business

990
00:34:46,260 --> 00:34:48,418
inexpensive it's really not that much

991
00:34:48,418 --> 00:34:51,300
more to go from traditional AV to EDR so

992
00:34:51,300 --> 00:34:52,918
we've been moving all of our clients to

993
00:34:52,918 --> 00:34:55,619
that and then seems security information

994
00:34:55,619 --> 00:34:58,619
event management basically it's a log

995
00:34:58,619 --> 00:35:01,260
Aggregate and and you can set thresholds

996
00:35:01,260 --> 00:35:03,900
on things and it'll trigger alerts based

997
00:35:03,900 --> 00:35:06,359
on that so in the past you'd need a team

998
00:35:06,359 --> 00:35:07,920
and you'd have to do a bunch of

999
00:35:07,920 --> 00:35:09,599
configuration there are actually some

1000
00:35:09,599 --> 00:35:11,579
products that work well out of the box

1001
00:35:11,579 --> 00:35:13,500
basically just install it and there's a

1002
00:35:13,500 --> 00:35:15,060
default rule set in there that works

1003
00:35:15,060 --> 00:35:16,920
really well the some of the stuff that

1004
00:35:16,920 --> 00:35:18,839
you saw me doing earlier like adding

1005
00:35:18,839 --> 00:35:20,520
into the domain admins group that's

1006
00:35:20,520 --> 00:35:21,839
going to throw up an alert that's going

1007
00:35:21,839 --> 00:35:23,520
to get me busted

1008
00:35:23,520 --> 00:35:25,500
um you know spraying that could get me

1009
00:35:25,500 --> 00:35:28,260
busted so that's another thing it's not

1010
00:35:28,260 --> 00:35:29,700
super expensive I don't want to name

1011
00:35:29,700 --> 00:35:30,960
drop products if you want some

1012
00:35:30,960 --> 00:35:33,780
recommendations just grab me offline and

1013
00:35:33,780 --> 00:35:36,060
with that I'm going to say thank you and

1014
00:35:36,060 --> 00:35:38,839
open it up for questions

