1
00:00:07,099 --> 00:00:10,200
all right here hey everyone

2
00:00:10,200 --> 00:00:12,719
hello hello how are you

3
00:00:12,719 --> 00:00:14,820
cool cool that's good to hear hey this

4
00:00:14,820 --> 00:00:17,100
is awesome thank you so much uh I'm just

5
00:00:17,100 --> 00:00:18,539
honored and flattered to be here with

6
00:00:18,539 --> 00:00:19,740
you all this is a very very cool

7
00:00:19,740 --> 00:00:21,480
opportunity and I hope we'll have a

8
00:00:21,480 --> 00:00:23,160
little bit of fun I try to keep things

9
00:00:23,160 --> 00:00:26,039
cool and casual and candid uh so

10
00:00:26,039 --> 00:00:27,779
hopefully we'll get into some fun stuff

11
00:00:27,779 --> 00:00:29,880
but uh what I wanted to bring to you

12
00:00:29,880 --> 00:00:31,740
today was

13
00:00:31,740 --> 00:00:33,960
well hey first of all I got to apologize

14
00:00:33,960 --> 00:00:36,660
look I don't have any cool Elite sexy

15
00:00:36,660 --> 00:00:39,180
zero days or new hot exploits to pull

16
00:00:39,180 --> 00:00:40,559
off the shelf or anything that I don't

17
00:00:40,559 --> 00:00:41,760
know bring a whole lot of technical

18
00:00:41,760 --> 00:00:43,980
caliber but hopefully we're still gonna

19
00:00:43,980 --> 00:00:45,120
get a little bit nerdy we're still gonna

20
00:00:45,120 --> 00:00:46,980
get geeky still look into some code and

21
00:00:46,980 --> 00:00:49,559
still have some tech aspect to it but at

22
00:00:49,559 --> 00:00:51,899
the end of the day I do want to tell you

23
00:00:51,899 --> 00:00:54,000
a story and I hope there are components

24
00:00:54,000 --> 00:00:55,559
of it and pieces of it at least that

25
00:00:55,559 --> 00:00:58,079
might resonate with you a little bit but

26
00:00:58,079 --> 00:01:00,059
um hey without all that boilerplate

27
00:01:00,059 --> 00:01:01,680
let's kind of dive in I wanted to bring

28
00:01:01,680 --> 00:01:04,080
to you this thing

29
00:01:04,080 --> 00:01:06,320
that says all aboard the supply chain

30
00:01:06,320 --> 00:01:08,520
vulnerabilities and exploits throughout

31
00:01:08,520 --> 00:01:10,500
the proverbial Pipeline and I'm going to

32
00:01:10,500 --> 00:01:12,299
be chatting a little bit about

33
00:01:12,299 --> 00:01:14,640
the supply chain which I realize is

34
00:01:14,640 --> 00:01:17,159
super duper vague it's extremely broad

35
00:01:17,159 --> 00:01:19,619
it's extremely General and it's another

36
00:01:19,619 --> 00:01:21,360
one of those terms that I feel like we

37
00:01:21,360 --> 00:01:23,040
just kind of throw out there and like

38
00:01:23,040 --> 00:01:24,420
cast into the wind and sometimes it's

39
00:01:24,420 --> 00:01:25,979
really hard to capture

40
00:01:25,979 --> 00:01:27,960
what do you actually mean what what what

41
00:01:27,960 --> 00:01:30,720
kind of supply chain in what way

42
00:01:30,720 --> 00:01:33,360
let me sort of boil and bake it down I

43
00:01:33,360 --> 00:01:34,320
think you could have a very very

44
00:01:34,320 --> 00:01:36,360
technical concept of supply chain of

45
00:01:36,360 --> 00:01:39,600
like hey some CI CD continuous

46
00:01:39,600 --> 00:01:41,400
integration continuous deployment blah

47
00:01:41,400 --> 00:01:43,079
blah blah pipeline

48
00:01:43,079 --> 00:01:45,799
of developing software and code and Tech

49
00:01:45,799 --> 00:01:49,380
or even like people of the supply chain

50
00:01:49,380 --> 00:01:52,200
like hey you receive some Goods or some

51
00:01:52,200 --> 00:01:54,180
service from someone at another party

52
00:01:54,180 --> 00:01:57,360
that receives that same good from

53
00:01:57,360 --> 00:02:00,720
something else Upstream so we'll play

54
00:02:00,720 --> 00:02:05,159
with that anyway uh look before we get

55
00:02:05,159 --> 00:02:07,079
into the weeds please let me say I can't

56
00:02:07,079 --> 00:02:09,899
say it enough thank you uh RJ had

57
00:02:09,899 --> 00:02:11,340
reached out to me a bit ago said hey do

58
00:02:11,340 --> 00:02:12,720
you want to come party with us at the

59
00:02:12,720 --> 00:02:14,520
Cayman Islands I thought it was a

60
00:02:14,520 --> 00:02:15,840
phishing email

61
00:02:15,840 --> 00:02:18,599
um but we're here now and I I can't say

62
00:02:18,599 --> 00:02:20,459
enough thank you let me be super duper

63
00:02:20,459 --> 00:02:22,620
quick on the boring obligatory

64
00:02:22,620 --> 00:02:24,660
introduction the who am I slide

65
00:02:24,660 --> 00:02:27,660
establishing credibility I realize no

66
00:02:27,660 --> 00:02:29,340
one really cares so I'm going to speed

67
00:02:29,340 --> 00:02:30,660
run right through this

68
00:02:30,660 --> 00:02:33,180
um hey hello I'm John Hammond uh cut my

69
00:02:33,180 --> 00:02:35,040
teeth on some cyber security stuff when

70
00:02:35,040 --> 00:02:37,800
I was with the United States Coast Guard

71
00:02:37,800 --> 00:02:39,480
um I also have been trying to grow a

72
00:02:39,480 --> 00:02:40,860
little bit of the cheesy YouTube channel

73
00:02:40,860 --> 00:02:43,260
to bring cyber security education to get

74
00:02:43,260 --> 00:02:45,239
awareness and training and messaging out

75
00:02:45,239 --> 00:02:47,519
there it's a lot of fun that is a uh

76
00:02:47,519 --> 00:02:49,920
labor of love and a real pet passion

77
00:02:49,920 --> 00:02:51,300
project but we're cruising another thing

78
00:02:51,300 --> 00:02:53,099
I don't know like half a million folks

79
00:02:53,099 --> 00:02:55,620
so it's surreal and very very fulfilling

80
00:02:55,620 --> 00:02:57,420
and I'm happy to have a whole lot of

81
00:02:57,420 --> 00:02:59,340
those cool opportunities with that

82
00:02:59,340 --> 00:03:00,959
again speed running here because I know

83
00:03:00,959 --> 00:03:02,940
this is boring and doesn't matter uh I

84
00:03:02,940 --> 00:03:05,160
got kind of hey my first gig as a

85
00:03:05,160 --> 00:03:07,980
teacher as an instructor with the United

86
00:03:07,980 --> 00:03:09,660
States Department of Defense cyber

87
00:03:09,660 --> 00:03:11,220
Training Academy that was kind of fun

88
00:03:11,220 --> 00:03:13,319
hey you know got to be up on front on

89
00:03:13,319 --> 00:03:15,300
the screen got to do some hanging out by

90
00:03:15,300 --> 00:03:18,120
the podium but it is really

91
00:03:18,120 --> 00:03:21,120
a matter of keeping students awake and

92
00:03:21,120 --> 00:03:22,620
entertained sort of like riding a

93
00:03:22,620 --> 00:03:24,120
unicycle and just trying to juggle keep

94
00:03:24,120 --> 00:03:25,800
their pulse up so I thought you know

95
00:03:25,800 --> 00:03:27,360
what let me go do this for real I want

96
00:03:27,360 --> 00:03:29,400
to be on the keyboard I went to go be

97
00:03:29,400 --> 00:03:32,400
with the defense threat reduction agency

98
00:03:32,400 --> 00:03:34,200
that was a little bit of red tape and

99
00:03:34,200 --> 00:03:35,519
some slow moving spots there So

100
00:03:35,519 --> 00:03:37,019
eventually I bounced over to where I am

101
00:03:37,019 --> 00:03:39,780
now at Huntress which is I love and it's

102
00:03:39,780 --> 00:03:41,340
incredible to be there but I want to

103
00:03:41,340 --> 00:03:43,440
tell you some of the fun stories that

104
00:03:43,440 --> 00:03:45,900
come from that because I hope

105
00:03:45,900 --> 00:03:47,280
I could at least bring a little bit more

106
00:03:47,280 --> 00:03:49,620
of hey the front lines or I I try to be

107
00:03:49,620 --> 00:03:51,720
in the trenches with everyone on this

108
00:03:51,720 --> 00:03:54,239
whole cyber security thing so

109
00:03:54,239 --> 00:03:56,459
anyway let's tell the story and I

110
00:03:56,459 --> 00:03:57,900
realize we're going to do a little bit

111
00:03:57,900 --> 00:03:58,920
of

112
00:03:58,920 --> 00:04:01,680
time travel so please bear with me we're

113
00:04:01,680 --> 00:04:03,299
going to move backwards in time as to

114
00:04:03,299 --> 00:04:05,400
hey when things got started and hey how

115
00:04:05,400 --> 00:04:06,900
this all happened and then what's kind

116
00:04:06,900 --> 00:04:09,000
of come of it Forward on but

117
00:04:09,000 --> 00:04:11,459
let me set the background here with a

118
00:04:11,459 --> 00:04:13,379
little bit of context

119
00:04:13,379 --> 00:04:15,599
here's this news article here are these

120
00:04:15,599 --> 00:04:17,399
headlines hey here are the journalism

121
00:04:17,399 --> 00:04:18,720
reporters screaming and shouting about

122
00:04:18,720 --> 00:04:23,340
connect wise finishes rce bug that's

123
00:04:23,340 --> 00:04:25,680
remote code execution hey compromising a

124
00:04:25,680 --> 00:04:27,360
machine or an endpoint

125
00:04:27,360 --> 00:04:30,240
fixes this rce bug exposing thousands of

126
00:04:30,240 --> 00:04:31,320
servers

127
00:04:31,320 --> 00:04:34,199
two attacks uh I don't know how well you

128
00:04:34,199 --> 00:04:35,699
might be able to see the picture

129
00:04:35,699 --> 00:04:38,460
timeline here uh this is October of last

130
00:04:38,460 --> 00:04:41,460
year October 28th very back in 2022. and

131
00:04:41,460 --> 00:04:44,040
they say look it's the problem the

132
00:04:44,040 --> 00:04:46,259
weakness the vulnerability is an

133
00:04:46,259 --> 00:04:48,900
elements that are used in a downstream

134
00:04:48,900 --> 00:04:50,940
component

135
00:04:50,940 --> 00:04:53,460
okay there's our first inkling of a

136
00:04:53,460 --> 00:04:54,720
supply chain but we'll talk about a

137
00:04:54,720 --> 00:04:56,280
little bit more and let me kind of

138
00:04:56,280 --> 00:04:59,160
Center us here in October that'll be the

139
00:04:59,160 --> 00:05:01,080
focal point of the story while we do

140
00:05:01,080 --> 00:05:03,660
some time travel in just a moment

141
00:05:03,660 --> 00:05:06,240
there are more dreaming and shouting and

142
00:05:06,240 --> 00:05:08,699
hey hey hey the sky is falling headlines

143
00:05:08,699 --> 00:05:11,580
and alerts and all this uh news articles

144
00:05:11,580 --> 00:05:14,060
that say Hey patch now yada yada

145
00:05:14,060 --> 00:05:18,000
dangerous rce bug lays upon connectwise

146
00:05:18,000 --> 00:05:21,180
server backup managers are folks

147
00:05:21,180 --> 00:05:22,500
familiar with connectwise I'm super

148
00:05:22,500 --> 00:05:25,500
sorry I realize that hey a vendor in the

149
00:05:25,500 --> 00:05:28,440
MSP space a managed service provider

150
00:05:28,440 --> 00:05:31,440
channel that is one of those spots that

151
00:05:31,440 --> 00:05:32,699
will offer

152
00:05:32,699 --> 00:05:35,220
services to other businesses and

153
00:05:35,220 --> 00:05:37,020
companies and organizations well

154
00:05:37,020 --> 00:05:39,600
oftentimes I.T Services hey we'll we'll

155
00:05:39,600 --> 00:05:41,400
manage your website we'll make sure your

156
00:05:41,400 --> 00:05:42,900
email is up and running we'll get the

157
00:05:42,900 --> 00:05:45,180
fire file transfer protocol and all the

158
00:05:45,180 --> 00:05:47,220
stuff on those file shares that make

159
00:05:47,220 --> 00:05:49,259
sure that's all working

160
00:05:49,259 --> 00:05:51,780
they are one of those managed service

161
00:05:51,780 --> 00:05:54,479
providers helping other manage service

162
00:05:54,479 --> 00:05:56,340
providers provide for their businesses

163
00:05:56,340 --> 00:05:58,139
that they support whether that's it a

164
00:05:58,139 --> 00:06:01,740
dental office or a law firm or

165
00:06:01,740 --> 00:06:03,960
municipality or I don't know Hospital

166
00:06:03,960 --> 00:06:06,300
right it could be anything

167
00:06:06,300 --> 00:06:09,419
and that's maybe another inkling of that

168
00:06:09,419 --> 00:06:10,860
supply chain here because hey if there's

169
00:06:10,860 --> 00:06:12,660
a vulnerability in something that this

170
00:06:12,660 --> 00:06:14,280
company a at the top of the tree

171
00:06:14,280 --> 00:06:16,560
provides trickles down to B on one

172
00:06:16,560 --> 00:06:18,600
branch of the tree and then those

173
00:06:18,600 --> 00:06:20,639
potential Roots underneath it

174
00:06:20,639 --> 00:06:25,340
could be some damage down there

175
00:06:25,380 --> 00:06:27,419
so uh

176
00:06:27,419 --> 00:06:29,819
let me bring us backwards in time now

177
00:06:29,819 --> 00:06:31,620
let me sort of press rewind and get to

178
00:06:31,620 --> 00:06:33,600
the start of this thing to talk about

179
00:06:33,600 --> 00:06:35,699
how this all kind of came to light and

180
00:06:35,699 --> 00:06:37,620
I'll introduce you if I may to a fella

181
00:06:37,620 --> 00:06:39,960
admittedly on Twitter right hey internet

182
00:06:39,960 --> 00:06:42,840
twitterverse uh fricos I know that's a

183
00:06:42,840 --> 00:06:43,919
little bit weird to kind of see that

184
00:06:43,919 --> 00:06:45,720
name there uh his name is Florian

185
00:06:45,720 --> 00:06:48,539
Florian Hauser uh researcher over at

186
00:06:48,539 --> 00:06:51,900
code white gmbh

187
00:06:51,900 --> 00:06:53,580
honestly think of this as hey Twitter

188
00:06:53,580 --> 00:06:55,800
guy keep it easy for your own thoughts

189
00:06:55,800 --> 00:06:57,600
here but frico says Hey can anyone get

190
00:06:57,600 --> 00:07:00,419
me in touch with the security contact I

191
00:07:00,419 --> 00:07:02,100
connect wise

192
00:07:02,100 --> 00:07:03,600
take note of that time stamp there

193
00:07:03,600 --> 00:07:06,840
that's July 2022.

194
00:07:06,840 --> 00:07:08,340
hey I'm trying to reach out I'm trying

195
00:07:08,340 --> 00:07:09,720
to get a hold of someone over at this

196
00:07:09,720 --> 00:07:10,800
vendor I want to get a hold of

197
00:07:10,800 --> 00:07:12,720
connectwise but can anyone help me

198
00:07:12,720 --> 00:07:15,900
because I I'm not having any luck

199
00:07:15,900 --> 00:07:19,080
says that in July come to August he says

200
00:07:19,080 --> 00:07:22,080
hey look does anyone use cert or like I

201
00:07:22,080 --> 00:07:23,520
don't know some computer Emergency

202
00:07:23,520 --> 00:07:25,440
Response Team or any acronym right does

203
00:07:25,440 --> 00:07:27,300
anyone use these for vulnerability

204
00:07:27,300 --> 00:07:28,919
disclosure because of an unresponsive

205
00:07:28,919 --> 00:07:30,419
vendor

206
00:07:30,419 --> 00:07:31,919
I'm trying to get a hold of connect

207
00:07:31,919 --> 00:07:33,300
voice but I just can't get a hold of

208
00:07:33,300 --> 00:07:34,560
them I can't reach them they're not

209
00:07:34,560 --> 00:07:36,000
they're not getting back to me

210
00:07:36,000 --> 00:07:38,460
this is August bear in mind

211
00:07:38,460 --> 00:07:39,900
so okay let's think a little bit about

212
00:07:39,900 --> 00:07:41,039
the months here that are kind of

213
00:07:41,039 --> 00:07:42,240
component of this because now we're

214
00:07:42,240 --> 00:07:44,220
getting into September still not seeing

215
00:07:44,220 --> 00:07:46,259
any Buzz still not getting any

216
00:07:46,259 --> 00:07:47,460
breakthrough

217
00:07:47,460 --> 00:07:48,900
at this point he just kind of kicks it

218
00:07:48,900 --> 00:07:50,699
over to the security Community hey

219
00:07:50,699 --> 00:07:53,160
fellow nerds other Geeks and hackers are

220
00:07:53,160 --> 00:07:55,500
you looking for a zero day like hey look

221
00:07:55,500 --> 00:07:56,400
what you want a new hot new

222
00:07:56,400 --> 00:07:57,960
vulnerability

223
00:07:57,960 --> 00:07:59,880
months ago I tried to contact

224
00:07:59,880 --> 00:08:02,819
connectwise for an auth Bypass or

225
00:08:02,819 --> 00:08:05,280
authentication bypass in this R1 soft

226
00:08:05,280 --> 00:08:07,500
server backend manager

227
00:08:07,500 --> 00:08:10,319
no dice couldn't get a hold of them have

228
00:08:10,319 --> 00:08:12,780
fun good luck good luck have fun

229
00:08:12,780 --> 00:08:15,060
now uh to kind of add some more color

230
00:08:15,060 --> 00:08:17,580
here an authentication bypass is like

231
00:08:17,580 --> 00:08:20,520
you try to log in to Amazon or you try

232
00:08:20,520 --> 00:08:22,560
to log into Google but say you didn't

233
00:08:22,560 --> 00:08:25,560
have to log in say you're a threat actor

234
00:08:25,560 --> 00:08:27,300
you're an adversary you're a hacker and

235
00:08:27,300 --> 00:08:29,220
you just got to skip right on by you

236
00:08:29,220 --> 00:08:31,379
don't need to authenticate you don't

237
00:08:31,379 --> 00:08:32,580
need to log in

238
00:08:32,580 --> 00:08:34,860
I could open the door to some spooky

239
00:08:34,860 --> 00:08:36,240
scary stuff right especially if there's

240
00:08:36,240 --> 00:08:38,099
some information there or controls or

241
00:08:38,099 --> 00:08:40,200
power and functionality

242
00:08:40,200 --> 00:08:42,659
that a threat actor shouldn't have

243
00:08:42,659 --> 00:08:44,520
uh so so that's the authentication

244
00:08:44,520 --> 00:08:46,620
bypass and this is in September

245
00:08:46,620 --> 00:08:48,540
remember we came from July we went down

246
00:08:48,540 --> 00:08:50,279
to August now or September okay so

247
00:08:50,279 --> 00:08:51,959
months have been passing here and

248
00:08:51,959 --> 00:08:53,580
eventually I don't know how well you

249
00:08:53,580 --> 00:08:54,959
might be able to read this one but this

250
00:08:54,959 --> 00:08:56,820
is us catching it and kind of our

251
00:08:56,820 --> 00:08:58,800
internal Slack

252
00:08:58,800 --> 00:09:00,660
hey we're working with the team

253
00:09:00,660 --> 00:09:02,580
doing what we do day to day

254
00:09:02,580 --> 00:09:04,560
and we have someone that says

255
00:09:04,560 --> 00:09:06,240
someone passed this along Someone caught

256
00:09:06,240 --> 00:09:08,279
wind of this on the twitterverse

257
00:09:08,279 --> 00:09:10,860
an Elon Musk little spot here they say

258
00:09:10,860 --> 00:09:11,940
look

259
00:09:11,940 --> 00:09:15,000
freikos had tweeted many months past so

260
00:09:15,000 --> 00:09:17,399
time for Pock time for the proof of

261
00:09:17,399 --> 00:09:19,200
concept

262
00:09:19,200 --> 00:09:21,300
here's how to blow this thing up here's

263
00:09:21,300 --> 00:09:22,980
the weapon here's the gun here's how you

264
00:09:22,980 --> 00:09:24,959
do this authentication bypass because

265
00:09:24,959 --> 00:09:27,060
what 90 days have passed it's you try to

266
00:09:27,060 --> 00:09:28,800
reach them in July maybe even earlier

267
00:09:28,800 --> 00:09:30,779
when he found this

268
00:09:30,779 --> 00:09:32,940
and he never got a hold of the vendor to

269
00:09:32,940 --> 00:09:35,100
be able to do responsible disclosure so

270
00:09:35,100 --> 00:09:37,680
he feels like well now what uh I'm just

271
00:09:37,680 --> 00:09:38,760
going to release this I'm just going to

272
00:09:38,760 --> 00:09:40,380
bring it out to the world now these are

273
00:09:40,380 --> 00:09:42,120
just some crappy burp sweet screenshots

274
00:09:42,120 --> 00:09:43,860
uh forgive me I don't know how well you

275
00:09:43,860 --> 00:09:45,000
might be able to see because I know it's

276
00:09:45,000 --> 00:09:46,860
blurry super small text but for the

277
00:09:46,860 --> 00:09:48,779
fellow nerds and Geeks and hackers burp

278
00:09:48,779 --> 00:09:50,100
sweet is one of those web application

279
00:09:50,100 --> 00:09:53,279
penetration testing tools

280
00:09:53,279 --> 00:09:55,200
this tweet

281
00:09:55,200 --> 00:09:57,660
kind of Clues Us in it's like whoa wait

282
00:09:57,660 --> 00:09:58,920
a second you look you have the

283
00:09:58,920 --> 00:10:00,300
vulnerability you have an authentication

284
00:10:00,300 --> 00:10:02,880
bypass and a connect wise product

285
00:10:02,880 --> 00:10:04,860
I got to admit that's that's kind of a

286
00:10:04,860 --> 00:10:06,839
big deal connectwise is one of those top

287
00:10:06,839 --> 00:10:09,120
dogs if you aren't familiar in the MSP

288
00:10:09,120 --> 00:10:10,740
space or the managed service provider

289
00:10:10,740 --> 00:10:13,200
Channel think like a Microsoft think

290
00:10:13,200 --> 00:10:15,360
like a big business that's running the

291
00:10:15,360 --> 00:10:16,320
show

292
00:10:16,320 --> 00:10:17,519
so if there's a vulnerability there

293
00:10:17,519 --> 00:10:19,800
there might be some stuff that could do

294
00:10:19,800 --> 00:10:21,660
some real damage

295
00:10:21,660 --> 00:10:23,220
so we start to chat about this we start

296
00:10:23,220 --> 00:10:25,260
to Banter uh an individual says look

297
00:10:25,260 --> 00:10:27,260
this is how the 2018

298
00:10:27,260 --> 00:10:29,580
cassaya crypto Miner vulnerability and

299
00:10:29,580 --> 00:10:31,200
that little certain apocalypse

300
00:10:31,200 --> 00:10:32,880
Armageddon came through

301
00:10:32,880 --> 00:10:34,680
and then we start to think like look hey

302
00:10:34,680 --> 00:10:36,839
John another co-worker of mine a great

303
00:10:36,839 --> 00:10:38,459
peer Caleb

304
00:10:38,459 --> 00:10:40,620
look guys this might really be worth

305
00:10:40,620 --> 00:10:42,300
digging into because it could be so so

306
00:10:42,300 --> 00:10:44,220
good for education's sake for getting

307
00:10:44,220 --> 00:10:46,079
maybe more of a narrative and to show

308
00:10:46,079 --> 00:10:48,060
people the impact that cyber security

309
00:10:48,060 --> 00:10:50,459
might actually have

310
00:10:50,459 --> 00:10:52,560
and then we're thinking wait a second

311
00:10:52,560 --> 00:10:54,600
can we pull down R1 soft can we play

312
00:10:54,600 --> 00:10:55,860
with this can we Tinker with it and

313
00:10:55,860 --> 00:10:58,019
where did that tweet go that Twitter

314
00:10:58,019 --> 00:11:00,480
post just vanished fell off the face of

315
00:11:00,480 --> 00:11:01,860
the internet

316
00:11:01,860 --> 00:11:03,360
it was deleted

317
00:11:03,360 --> 00:11:05,640
fry ghost our Twitter friend

318
00:11:05,640 --> 00:11:09,660
was asked to remove that by probably a

319
00:11:09,660 --> 00:11:11,220
vendor we hey connectwise thinking like

320
00:11:11,220 --> 00:11:12,720
let's let's clean that up let's remove

321
00:11:12,720 --> 00:11:14,579
that let's not show that out to the

322
00:11:14,579 --> 00:11:16,380
world here so that's a little bit of a

323
00:11:16,380 --> 00:11:17,459
bummer

324
00:11:17,459 --> 00:11:19,380
but thankfully slack had cached those

325
00:11:19,380 --> 00:11:20,579
images so we could kind of get a chance

326
00:11:20,579 --> 00:11:22,140
to poke and play with it

327
00:11:22,140 --> 00:11:24,360
anyway

328
00:11:24,360 --> 00:11:26,220
start to wonder here

329
00:11:26,220 --> 00:11:29,040
why are they trying to respond and

330
00:11:29,040 --> 00:11:31,620
connect and reach out to connect wise

331
00:11:31,620 --> 00:11:34,800
when he said this is an R1 soft software

332
00:11:34,800 --> 00:11:37,260
he said this is a Backup Manager for

333
00:11:37,260 --> 00:11:39,060
another vendor and they say why would

334
00:11:39,060 --> 00:11:40,860
they want to report it to connect wise

335
00:11:40,860 --> 00:11:43,380
oh oh oh oh sorry okay

336
00:11:43,380 --> 00:11:44,820
turns out

337
00:11:44,820 --> 00:11:47,519
acquisition R1 soft change of hands now

338
00:11:47,519 --> 00:11:50,220
owned and eaten by connectless that's

339
00:11:50,220 --> 00:11:51,959
okay totally understood but maybe adds

340
00:11:51,959 --> 00:11:54,000
an arm to our supply chain story here

341
00:11:54,000 --> 00:11:56,040
because now you've got a product sold to

342
00:11:56,040 --> 00:11:58,019
vendors sold to other vendors sold the

343
00:11:58,019 --> 00:12:00,240
businesses that came from another vendor

344
00:12:00,240 --> 00:12:02,279
that no one works there anymore

345
00:12:02,279 --> 00:12:03,899
so this is kind of hard to dig into some

346
00:12:03,899 --> 00:12:06,180
of that technical cyber security sense

347
00:12:06,180 --> 00:12:07,740
and there's just another

348
00:12:07,740 --> 00:12:09,839
uh piece of the puzzle

349
00:12:09,839 --> 00:12:11,760
and if folks aren't familiar hey this is

350
00:12:11,760 --> 00:12:14,579
what that server Backup Manager software

351
00:12:14,579 --> 00:12:17,339
looks like here's our login page hey so

352
00:12:17,339 --> 00:12:19,140
you were to enter your admin credentials

353
00:12:19,140 --> 00:12:22,260
your password and it is at its core a

354
00:12:22,260 --> 00:12:23,820
Backup Manager

355
00:12:23,820 --> 00:12:25,560
so all the other computers all the other

356
00:12:25,560 --> 00:12:28,079
hosts that need to have their data

357
00:12:28,079 --> 00:12:29,279
backed up would kind of be connecting

358
00:12:29,279 --> 00:12:31,200
and communicating and working with this

359
00:12:31,200 --> 00:12:34,579
manager the server and the service

360
00:12:35,459 --> 00:12:38,700
now once you log in what more can you do

361
00:12:38,700 --> 00:12:40,800
if you were an administrator if you were

362
00:12:40,800 --> 00:12:42,899
the actual maintainer of the software

363
00:12:42,899 --> 00:12:45,420
some curious and interesting things but

364
00:12:45,420 --> 00:12:47,399
we started to dig into

365
00:12:47,399 --> 00:12:49,860
okay what did Florian what did frycoast

366
00:12:49,860 --> 00:12:51,240
what are what did our Twitter friend

367
00:12:51,240 --> 00:12:53,579
find for this zero day in this

368
00:12:53,579 --> 00:12:55,019
vulnerability based off of those burp

369
00:12:55,019 --> 00:12:56,639
Suite screenshots those are the only

370
00:12:56,639 --> 00:12:59,040
pieces of the puzzle that we had

371
00:12:59,040 --> 00:13:02,100
but we caught a little bit of an Inkling

372
00:13:02,100 --> 00:13:04,440
when we saw this advisory we saw a note

373
00:13:04,440 --> 00:13:06,180
we saw a report look there's a

374
00:13:06,180 --> 00:13:09,360
vulnerability in this ZK or ZK library

375
00:13:09,360 --> 00:13:12,360
and now you might upload a file hey so

376
00:13:12,360 --> 00:13:13,560
you wanted to give something to the

377
00:13:13,560 --> 00:13:15,360
server to the service

378
00:13:15,360 --> 00:13:17,700
but there's a problem there is a

379
00:13:17,700 --> 00:13:19,680
weakness and I don't want to drag you

380
00:13:19,680 --> 00:13:21,720
through the the mud here too much but

381
00:13:21,720 --> 00:13:24,360
they note that this is fixed this is

382
00:13:24,360 --> 00:13:26,100
patched they already solved this problem

383
00:13:26,100 --> 00:13:27,300
here it's been resolved in these

384
00:13:27,300 --> 00:13:29,459
versions 9.6 whatever

385
00:13:29,459 --> 00:13:32,100
and if you want to zoom in on maybe that

386
00:13:32,100 --> 00:13:33,360
date here

387
00:13:33,360 --> 00:13:35,339
that's what may

388
00:13:35,339 --> 00:13:38,100
May of 2022 okay so a couple more months

389
00:13:38,100 --> 00:13:40,380
to add to our timeline

390
00:13:40,380 --> 00:13:41,940
and now let me get a little bit nerdy

391
00:13:41,940 --> 00:13:43,019
here

392
00:13:43,019 --> 00:13:44,940
we wanted to dig into it

393
00:13:44,940 --> 00:13:46,620
we wanted to see okay

394
00:13:46,620 --> 00:13:49,200
can we reach can we access that ZK

395
00:13:49,200 --> 00:13:51,839
library in that snippet of code because

396
00:13:51,839 --> 00:13:54,120
note this is where our technical aspect

397
00:13:54,120 --> 00:13:56,519
of the supply chain comes into play

398
00:13:56,519 --> 00:13:58,440
this product the software this

399
00:13:58,440 --> 00:14:00,540
application is its own thing it's built

400
00:14:00,540 --> 00:14:02,160
and it's made

401
00:14:02,160 --> 00:14:04,079
but one of the ingredients that it's

402
00:14:04,079 --> 00:14:05,339
baked with

403
00:14:05,339 --> 00:14:07,320
has that flaw has that vulnerability and

404
00:14:07,320 --> 00:14:10,320
weakness that's that ZK Library

405
00:14:10,320 --> 00:14:12,360
so we start to pry this thing open we

406
00:14:12,360 --> 00:14:14,040
try to think look is it matching that

407
00:14:14,040 --> 00:14:16,380
weak vulnerable version number is it

408
00:14:16,380 --> 00:14:18,899
patched yet and it's not

409
00:14:18,899 --> 00:14:19,980
we're still seeing the same

410
00:14:19,980 --> 00:14:21,480
vulnerability we're still seeing that

411
00:14:21,480 --> 00:14:23,220
weakness in the version number and this

412
00:14:23,220 --> 00:14:24,480
is what it kind of looks like when we're

413
00:14:24,480 --> 00:14:25,800
Kicking It Up

414
00:14:25,800 --> 00:14:27,660
and then we start

415
00:14:27,660 --> 00:14:30,000
to dig into it again all we have are

416
00:14:30,000 --> 00:14:31,620
these burp Suite screenshots to kind of

417
00:14:31,620 --> 00:14:34,019
play with see okay what parameters are

418
00:14:34,019 --> 00:14:35,940
you passing to that service what cookie

419
00:14:35,940 --> 00:14:37,860
is there what headers are going to be in

420
00:14:37,860 --> 00:14:40,260
the mix here I start to sling some gross

421
00:14:40,260 --> 00:14:42,240
python code here for folks digging into

422
00:14:42,240 --> 00:14:44,940
that we start to see can we decompile

423
00:14:44,940 --> 00:14:46,699
parts of this application because it's

424
00:14:46,699 --> 00:14:49,320
Java and again not to get too nerdy but

425
00:14:49,320 --> 00:14:50,339
that's something you can kind of take a

426
00:14:50,339 --> 00:14:52,199
look at those class files and find the

427
00:14:52,199 --> 00:14:54,779
original source code but we ran into a

428
00:14:54,779 --> 00:14:56,639
wall

429
00:14:56,639 --> 00:14:59,339
we couldn't get past

430
00:14:59,339 --> 00:15:01,320
this little roadblock there's like a

431
00:15:01,320 --> 00:15:04,079
little ZK error hey a little bit of a

432
00:15:04,079 --> 00:15:06,480
note here here's a header whoops it says

433
00:15:06,480 --> 00:15:08,880
200 okay you're good

434
00:15:08,880 --> 00:15:11,820
but there's a 410 whatever code for an

435
00:15:11,820 --> 00:15:13,320
error message

436
00:15:13,320 --> 00:15:15,959
we couldn't recreate the proof of

437
00:15:15,959 --> 00:15:17,339
concept and the vulnerability like dang

438
00:15:17,339 --> 00:15:18,480
it

439
00:15:18,480 --> 00:15:19,680
I'm hitting the same problem that

440
00:15:19,680 --> 00:15:20,820
Caleb's hitting we're running up against

441
00:15:20,820 --> 00:15:22,320
the wall we're not seeing a whole lot of

442
00:15:22,320 --> 00:15:25,320
motion at this point I say uh uh okay

443
00:15:25,320 --> 00:15:28,500
well let me see can I just ask like hey

444
00:15:28,500 --> 00:15:30,540
I'll reach out I'll just genuinely out

445
00:15:30,540 --> 00:15:33,180
go ask Florian frykos our Twitter friend

446
00:15:33,180 --> 00:15:34,699
and say hey

447
00:15:34,699 --> 00:15:38,279
uh I know you're doing what you do here

448
00:15:38,279 --> 00:15:40,320
I know you're busy fighting fires but if

449
00:15:40,320 --> 00:15:41,639
you'd be willing to chat a little bit

450
00:15:41,639 --> 00:15:44,760
about this R1 soft vulnerability if you

451
00:15:44,760 --> 00:15:46,380
would tell me what you're willing to and

452
00:15:46,380 --> 00:15:48,300
what you found here it could really

453
00:15:48,300 --> 00:15:50,100
really help us out with our partners

454
00:15:50,100 --> 00:15:51,540
because we have folks we support

455
00:15:51,540 --> 00:15:52,980
businesses and organizations that use

456
00:15:52,980 --> 00:15:54,540
connect wise

457
00:15:54,540 --> 00:15:56,459
I try to send in my code I try to send

458
00:15:56,459 --> 00:15:58,139
him what I've been tracking

459
00:15:58,139 --> 00:16:01,500
and then moments later

460
00:16:01,500 --> 00:16:03,000
we got it

461
00:16:03,000 --> 00:16:04,680
we say wait a second wait a second wait

462
00:16:04,680 --> 00:16:06,300
a second if we weren't using this

463
00:16:06,300 --> 00:16:08,639
session ID this token whatever secret

464
00:16:08,639 --> 00:16:10,740
magic sauce value we wouldn't have been

465
00:16:10,740 --> 00:16:12,779
able to get past this parts

466
00:16:12,779 --> 00:16:14,579
but now we did

467
00:16:14,579 --> 00:16:16,800
said yeah I just stole the session ID

468
00:16:16,800 --> 00:16:18,240
from the browser session and then we say

469
00:16:18,240 --> 00:16:19,699
wait a second here's an ID value

470
00:16:19,699 --> 00:16:22,320
redacted here but it's just a zkid value

471
00:16:22,320 --> 00:16:25,380
it might come from the requests

472
00:16:25,380 --> 00:16:26,940
that's it

473
00:16:26,940 --> 00:16:29,220
boom fire check mark

474
00:16:29,220 --> 00:16:31,139
that's that's the success reaction in

475
00:16:31,139 --> 00:16:33,360
slack I send my code I say look at this

476
00:16:33,360 --> 00:16:34,800
we got it we got it

477
00:16:34,800 --> 00:16:37,079
I know I'm like a dog with my tail

478
00:16:37,079 --> 00:16:38,459
between my legs I'm going to go back to

479
00:16:38,459 --> 00:16:40,980
fryco's go back to Florian he says hey

480
00:16:40,980 --> 00:16:41,940
John

481
00:16:41,940 --> 00:16:43,440
thanks for reaching out big fan of what

482
00:16:43,440 --> 00:16:45,480
you do thank you uh and he says I don't

483
00:16:45,480 --> 00:16:47,339
know maybe you downloaded a patch

484
00:16:47,339 --> 00:16:49,139
version or something has been fixed and

485
00:16:49,139 --> 00:16:51,899
then I say we got it it's working

486
00:16:51,899 --> 00:16:54,360
we have recreated the proof of concept

487
00:16:54,360 --> 00:16:57,480
for the authentication bypass now what

488
00:16:57,480 --> 00:16:59,940
that means is that I don't have to have

489
00:16:59,940 --> 00:17:02,459
any credentials I don't need to know Joe

490
00:17:02,459 --> 00:17:04,079
schmoe's password I don't even need to

491
00:17:04,079 --> 00:17:06,179
know the admin password I can just walk

492
00:17:06,179 --> 00:17:09,000
right in the door has been opened

493
00:17:09,000 --> 00:17:11,959
and that's that power

494
00:17:12,599 --> 00:17:14,280
but

495
00:17:14,280 --> 00:17:16,740
now what

496
00:17:16,740 --> 00:17:19,020
we've opened this door because of the

497
00:17:19,020 --> 00:17:21,119
vulnerability and weakness in that ZK

498
00:17:21,119 --> 00:17:23,699
library that higher Upstream only

499
00:17:23,699 --> 00:17:26,280
components and piece of the pie but now

500
00:17:26,280 --> 00:17:27,959
this whole application is something that

501
00:17:27,959 --> 00:17:30,000
we can just beat up right

502
00:17:30,000 --> 00:17:32,340
so we say look I've got local file

503
00:17:32,340 --> 00:17:34,080
inclusion I can read some sensitive

504
00:17:34,080 --> 00:17:36,059
files I can read configuration files I

505
00:17:36,059 --> 00:17:38,880
can see how the server is built

506
00:17:38,880 --> 00:17:40,440
but now what

507
00:17:40,440 --> 00:17:42,440
because we wanted to think

508
00:17:42,440 --> 00:17:45,360
what more could be done here I could

509
00:17:45,360 --> 00:17:47,340
literally log in as admin that might

510
00:17:47,340 --> 00:17:50,340
give me more power and Caleb okay

511
00:17:50,340 --> 00:17:52,260
Wise Guy smart little genius he says

512
00:17:52,260 --> 00:17:54,179
look you can make authenticated requests

513
00:17:54,179 --> 00:17:56,520
to other endpoints we can crawl around

514
00:17:56,520 --> 00:17:58,799
the program and really do anything that

515
00:17:58,799 --> 00:18:01,320
we want here if you specify this path

516
00:18:01,320 --> 00:18:04,260
zcal or whatever ZK authentication I

517
00:18:04,260 --> 00:18:06,179
don't know it'll effectively make a post

518
00:18:06,179 --> 00:18:07,260
request

519
00:18:07,260 --> 00:18:10,559
and you could pass along any arguments

520
00:18:10,559 --> 00:18:13,200
huh that sounds really cool that sounds

521
00:18:13,200 --> 00:18:14,700
like something we can work with with a

522
00:18:14,700 --> 00:18:16,919
couple limitations uh for the other

523
00:18:16,919 --> 00:18:18,840
folks nerds and Geeks the post request

524
00:18:18,840 --> 00:18:21,900
is a little bit limited we can't get or

525
00:18:21,900 --> 00:18:24,059
receive info from the server

526
00:18:24,059 --> 00:18:25,679
we're only pushing and putting

527
00:18:25,679 --> 00:18:28,020
information on the server so we sort of

528
00:18:28,020 --> 00:18:31,440
have to drive around in a weird way but

529
00:18:31,440 --> 00:18:33,840
we start to think on this

530
00:18:33,840 --> 00:18:36,059
and I'm talking with fricos now I've

531
00:18:36,059 --> 00:18:37,740
made a new friend hey reached out across

532
00:18:37,740 --> 00:18:40,080
the internet and now we're best of buds

533
00:18:40,080 --> 00:18:41,760
he says look

534
00:18:41,760 --> 00:18:43,320
I appreciate you digging into this I

535
00:18:43,320 --> 00:18:44,940
didn't want to disclose a full working

536
00:18:44,940 --> 00:18:46,620
proof of concept I just shared those

537
00:18:46,620 --> 00:18:48,539
burp Suite screenshots because I didn't

538
00:18:48,539 --> 00:18:49,860
want to enable

539
00:18:49,860 --> 00:18:52,799
script kitties threat actors maybe some

540
00:18:52,799 --> 00:18:55,500
folks that could do real damage have

541
00:18:55,500 --> 00:18:56,760
some malicious intent and make some

542
00:18:56,760 --> 00:18:58,320
noise out of this and I didn't try to

543
00:18:58,320 --> 00:19:00,120
abuse the authentication bypass even

544
00:19:00,120 --> 00:19:01,740
further he didn't try to push the

545
00:19:01,740 --> 00:19:03,179
envelope and see what else could be done

546
00:19:03,179 --> 00:19:04,080
here

547
00:19:04,080 --> 00:19:05,760
I just showed that you're able to reach

548
00:19:05,760 --> 00:19:07,380
these endpoints we can see that local

549
00:19:07,380 --> 00:19:09,240
file inclusion

550
00:19:09,240 --> 00:19:12,480
and I say gotcha gotcha I'm gonna try

551
00:19:12,480 --> 00:19:14,580
and weaponize it a little bit further I

552
00:19:14,580 --> 00:19:16,320
want to push the envelope here see what

553
00:19:16,320 --> 00:19:18,440
more could come from this

554
00:19:18,440 --> 00:19:20,400
foreign

555
00:19:20,400 --> 00:19:23,700
so with our authentication bypass with

556
00:19:23,700 --> 00:19:25,440
this hey moving around the application

557
00:19:25,440 --> 00:19:28,679
as a sort of pseudo admin user like a

558
00:19:28,679 --> 00:19:30,780
ghost really I can post to other

559
00:19:30,780 --> 00:19:33,419
endpoints but now what can I actually do

560
00:19:33,419 --> 00:19:35,520
as like a feature and functionality

561
00:19:35,520 --> 00:19:39,720
could I create a new user maybe I I want

562
00:19:39,720 --> 00:19:41,340
to act like the hacker I want to I want

563
00:19:41,340 --> 00:19:42,900
to put my hacker hat on act as the

564
00:19:42,900 --> 00:19:44,700
adversary and let me see can I gain

565
00:19:44,700 --> 00:19:47,280
persistence in some way with a new user

566
00:19:47,280 --> 00:19:49,620
or I don't know could I could I try and

567
00:19:49,620 --> 00:19:51,240
grab their cookies or their sessions or

568
00:19:51,240 --> 00:19:53,400
find out the admin password

569
00:19:53,400 --> 00:19:55,220
problem is

570
00:19:55,220 --> 00:19:58,440
ZK framework this whole Library this

571
00:19:58,440 --> 00:20:00,059
application of the way it's written is

572
00:20:00,059 --> 00:20:01,380
really weird

573
00:20:01,380 --> 00:20:03,720
it's uh it's put together as if it were

574
00:20:03,720 --> 00:20:06,000
a desktop interface so it tries to be

575
00:20:06,000 --> 00:20:08,700
very very familiar and loving to a mouse

576
00:20:08,700 --> 00:20:10,799
and a keyboard right

577
00:20:10,799 --> 00:20:13,020
you think user friendly with widgets and

578
00:20:13,020 --> 00:20:15,360
buttons and all these doodads so the way

579
00:20:15,360 --> 00:20:17,280
that you might normally think if you're

580
00:20:17,280 --> 00:20:19,140
a hey hacker pen test you're a red

581
00:20:19,140 --> 00:20:21,720
teamer you think I can beat up this web

582
00:20:21,720 --> 00:20:24,320
application maybe I can do some

583
00:20:24,320 --> 00:20:26,940
cross-site scripting to steal cookies or

584
00:20:26,940 --> 00:20:28,380
session info

585
00:20:28,380 --> 00:20:29,760
yada yada

586
00:20:29,760 --> 00:20:31,740
well the way that you've done is

587
00:20:31,740 --> 00:20:33,419
normally just a single request you say

588
00:20:33,419 --> 00:20:34,440
hey I want to change this password

589
00:20:34,440 --> 00:20:36,299
here's the username password password

590
00:20:36,299 --> 00:20:39,360
confirmation send it over

591
00:20:39,360 --> 00:20:41,460
you're filling out the form and in one

592
00:20:41,460 --> 00:20:43,320
request you've bundled up and packaged

593
00:20:43,320 --> 00:20:45,960
all of that form info

594
00:20:45,960 --> 00:20:48,059
ZK doesn't work like that

595
00:20:48,059 --> 00:20:51,600
ZK says Hey every time that you move

596
00:20:51,600 --> 00:20:53,520
your mouse every time you move into and

597
00:20:53,520 --> 00:20:55,440
focus on an input box whether you want

598
00:20:55,440 --> 00:20:56,700
to type in your name whether you want to

599
00:20:56,700 --> 00:20:58,140
type in anything it sends another

600
00:20:58,140 --> 00:21:00,900
message to the backend server

601
00:21:00,900 --> 00:21:03,179
you've moved your mouse over here you

602
00:21:03,179 --> 00:21:05,100
clicked on this button you started to

603
00:21:05,100 --> 00:21:06,539
type in every single keystroke you sent

604
00:21:06,539 --> 00:21:08,220
to the server you press the letter A the

605
00:21:08,220 --> 00:21:10,500
letter B the letter c

606
00:21:10,500 --> 00:21:12,539
and that's kind of annoying

607
00:21:12,539 --> 00:21:14,160
because every time by the end of it you

608
00:21:14,160 --> 00:21:16,260
finally click the submit button

609
00:21:16,260 --> 00:21:18,600
all you do is tell the server I click

610
00:21:18,600 --> 00:21:19,799
the submit button and that's it it

611
00:21:19,799 --> 00:21:20,820
didn't have any of the other information

612
00:21:20,820 --> 00:21:22,919
because it was already sent to the

613
00:21:22,919 --> 00:21:23,940
server

614
00:21:23,940 --> 00:21:26,760
what this means is as a hacker as a

615
00:21:26,760 --> 00:21:28,080
threat actor as someone who wants to

616
00:21:28,080 --> 00:21:30,720
weaponize what were found here

617
00:21:30,720 --> 00:21:33,419
this needs a lot more hand-holding I

618
00:21:33,419 --> 00:21:35,460
need to sort of drive around or swing

619
00:21:35,460 --> 00:21:37,320
from One widget to another grab

620
00:21:37,320 --> 00:21:39,179
identifiers for every element on the

621
00:21:39,179 --> 00:21:40,200
page

622
00:21:40,200 --> 00:21:41,820
that's annoying

623
00:21:41,820 --> 00:21:43,980
all that to say sorry I don't mean to be

624
00:21:43,980 --> 00:21:46,380
rambling too long we started to dig into

625
00:21:46,380 --> 00:21:49,679
what we could do here decompiling Java

626
00:21:49,679 --> 00:21:51,539
code trying to run up against all these

627
00:21:51,539 --> 00:21:53,280
different features and functionality and

628
00:21:53,280 --> 00:21:54,539
we started to see some like really weird

629
00:21:54,539 --> 00:21:57,059
stuff like funny things I don't know if

630
00:21:57,059 --> 00:21:59,039
you can dig into this hey here's a

631
00:21:59,039 --> 00:22:02,039
bastard class exception from hell

632
00:22:02,039 --> 00:22:03,539
I don't know what programmers put in

633
00:22:03,539 --> 00:22:05,700
their code right it could be anything

634
00:22:05,700 --> 00:22:08,480
but this is for the nerds in the room

635
00:22:08,480 --> 00:22:11,880
jadix JD decompiler stuff that we can

636
00:22:11,880 --> 00:22:13,860
use to cut through this code

637
00:22:13,860 --> 00:22:16,260
and we start to run into some Easter

638
00:22:16,260 --> 00:22:19,260
eggs there's a Konami Code

639
00:22:19,260 --> 00:22:20,820
I don't know if any video game friends

640
00:22:20,820 --> 00:22:22,320
but if you do an up up down down left

641
00:22:22,320 --> 00:22:24,240
right A B thing right hey you got new 30

642
00:22:24,240 --> 00:22:27,000
lives pops up on the screen cutesy dumb

643
00:22:27,000 --> 00:22:28,919
but again that's the extent that we were

644
00:22:28,919 --> 00:22:30,900
digging into because we desperately

645
00:22:30,900 --> 00:22:34,260
wanted there to be a vulnerability here

646
00:22:34,260 --> 00:22:35,940
kind of a weird thought right like we

647
00:22:35,940 --> 00:22:38,039
want to break into this thing

648
00:22:38,039 --> 00:22:41,400
but what if it could be done

649
00:22:41,400 --> 00:22:43,500
so we keep running to walls we keep

650
00:22:43,500 --> 00:22:45,000
trying to go down every single road that

651
00:22:45,000 --> 00:22:46,679
we could trying to hit every rabbit hole

652
00:22:46,679 --> 00:22:48,780
and see what could we take advantage of

653
00:22:48,780 --> 00:22:51,059
to do something more than just an

654
00:22:51,059 --> 00:22:53,700
authentication bypass could we get code

655
00:22:53,700 --> 00:22:55,919
execution could we steal passwords could

656
00:22:55,919 --> 00:22:58,799
we change user information

657
00:22:58,799 --> 00:23:01,020
ultimately

658
00:23:01,020 --> 00:23:03,480
we found

659
00:23:03,480 --> 00:23:05,520
this database driver

660
00:23:05,520 --> 00:23:07,200
which sounds kind of simple and kind of

661
00:23:07,200 --> 00:23:09,240
easy like hey if any nerds or Geeks and

662
00:23:09,240 --> 00:23:10,440
CTF players in the room might be

663
00:23:10,440 --> 00:23:12,960
thinking oh duh

664
00:23:12,960 --> 00:23:14,460
because you could put that in the back

665
00:23:14,460 --> 00:23:16,679
end of the server like the structure and

666
00:23:16,679 --> 00:23:18,600
the components here now we're not

667
00:23:18,600 --> 00:23:20,340
working with the front end anymore those

668
00:23:20,340 --> 00:23:22,380
pretty pictures and login buttons and

669
00:23:22,380 --> 00:23:25,559
widgets now we're going to the database

670
00:23:25,559 --> 00:23:26,880
that gives us a little bit more control

671
00:23:26,880 --> 00:23:30,120
so what if we could just upload our own

672
00:23:30,120 --> 00:23:32,159
database driver

673
00:23:32,159 --> 00:23:34,679
hardcore right nerdy and giddy if we

674
00:23:34,679 --> 00:23:36,179
start to think

675
00:23:36,179 --> 00:23:38,340
how do we actually get a database driver

676
00:23:38,340 --> 00:23:41,039
to trigger code

677
00:23:41,039 --> 00:23:44,940
this is a jdbc Java database connector

678
00:23:44,940 --> 00:23:47,400
and we start to think like how can we

679
00:23:47,400 --> 00:23:49,799
write some custom Java how can we write

680
00:23:49,799 --> 00:23:51,900
our own payload that we'll be able to

681
00:23:51,900 --> 00:23:53,880
Fire and do something to prove that

682
00:23:53,880 --> 00:23:55,380
we've gained the capability that we want

683
00:23:55,380 --> 00:23:57,539
so we start researching we start

684
00:23:57,539 --> 00:23:59,460
googling around we start asking Uncle

685
00:23:59,460 --> 00:24:00,360
Google

686
00:24:00,360 --> 00:24:04,620
turns out hey some individual Airman 604

687
00:24:04,620 --> 00:24:07,740
I think is his handle he says

688
00:24:07,740 --> 00:24:10,020
he's already put together this back door

689
00:24:10,020 --> 00:24:12,659
database driver I'm like oh thank you

690
00:24:12,659 --> 00:24:14,039
someone else has already done all the

691
00:24:14,039 --> 00:24:16,860
work so huge Kudos and thank you to to

692
00:24:16,860 --> 00:24:19,020
Airman for that and he has this blog

693
00:24:19,020 --> 00:24:20,580
post on medium that says look I've

694
00:24:20,580 --> 00:24:22,440
crafted this code I put together this

695
00:24:22,440 --> 00:24:24,600
database driver so you can slap it in

696
00:24:24,600 --> 00:24:26,940
and run commands

697
00:24:26,940 --> 00:24:29,400
operate on the computer as if you were

698
00:24:29,400 --> 00:24:31,860
sitting in front of it you have that

699
00:24:31,860 --> 00:24:34,260
terminal or that shell access to run

700
00:24:34,260 --> 00:24:35,580
system commands

701
00:24:35,580 --> 00:24:39,260
got a wolf in sheep's clothing right

702
00:24:39,539 --> 00:24:41,700
and that's it

703
00:24:41,700 --> 00:24:43,860
we slap that into my python code we've

704
00:24:43,860 --> 00:24:45,299
been swinging back and forth between all

705
00:24:45,299 --> 00:24:46,500
these widgets things that we can beat up

706
00:24:46,500 --> 00:24:48,360
and hit and

707
00:24:48,360 --> 00:24:49,980
we got it

708
00:24:49,980 --> 00:24:51,600
upload the database driver everything

709
00:24:51,600 --> 00:24:53,760
that we were Cruising Into so far and we

710
00:24:53,760 --> 00:24:56,159
got new ground push the envelope even

711
00:24:56,159 --> 00:24:58,080
further we know we're just beyond the

712
00:24:58,080 --> 00:25:00,480
authentication bypass we have code

713
00:25:00,480 --> 00:25:04,020
execution on the back of server

714
00:25:04,020 --> 00:25:06,659
cool okay we've done some damage maybe

715
00:25:06,659 --> 00:25:08,580
new cve whatever

716
00:25:08,580 --> 00:25:11,159
but we want to keep the right

717
00:25:11,159 --> 00:25:14,400
mindset here we want we want to keep the

718
00:25:14,400 --> 00:25:16,380
right mentality of like hey we we

719
00:25:16,380 --> 00:25:17,520
weren't able to do responsible

720
00:25:17,520 --> 00:25:20,100
disclosure first with fricos because

721
00:25:20,100 --> 00:25:22,380
they couldn't get a hold of connectwise

722
00:25:22,380 --> 00:25:23,820
well can can we get a hold of

723
00:25:23,820 --> 00:25:24,960
connectwise

724
00:25:24,960 --> 00:25:27,179
so we started to think on this but we

725
00:25:27,179 --> 00:25:28,380
start to realize that well there could

726
00:25:28,380 --> 00:25:30,480
be so much more damage that's done

727
00:25:30,480 --> 00:25:32,400
while I might be able to execute code

728
00:25:32,400 --> 00:25:34,559
run system commands here and by the way

729
00:25:34,559 --> 00:25:36,960
I'm sorry uh this was a very very simple

730
00:25:36,960 --> 00:25:39,779
and innocent uh crafting of a small text

731
00:25:39,779 --> 00:25:43,080
file there's no destination or no

732
00:25:43,080 --> 00:25:45,779
trigger that's anything crazy we're

733
00:25:45,779 --> 00:25:47,039
basically just opening the calculator

734
00:25:47,039 --> 00:25:49,740
application saying look I proved that I

735
00:25:49,740 --> 00:25:51,779
compromised this

736
00:25:51,779 --> 00:25:54,480
but it wasn't just that we could

737
00:25:54,480 --> 00:25:56,700
download some files and data that would

738
00:25:56,700 --> 00:25:59,520
be used for tech support quote unquote

739
00:25:59,520 --> 00:26:01,440
private key files for the server

740
00:26:01,440 --> 00:26:03,659
configuration settings other license

741
00:26:03,659 --> 00:26:05,520
Keys subscription information things

742
00:26:05,520 --> 00:26:07,020
that would just be for the genuine

743
00:26:07,020 --> 00:26:08,760
product

744
00:26:08,760 --> 00:26:10,740
and that might be a little bit more you

745
00:26:10,740 --> 00:26:12,000
didn't even need to use code execution

746
00:26:12,000 --> 00:26:13,080
for that you could just pull it right

747
00:26:13,080 --> 00:26:15,179
down with the authentication bypass in

748
00:26:15,179 --> 00:26:19,159
that ZK Library bear in mind

749
00:26:20,700 --> 00:26:22,500
but

750
00:26:22,500 --> 00:26:25,620
we're on a backup server

751
00:26:25,620 --> 00:26:26,820
which

752
00:26:26,820 --> 00:26:30,000
could really be a high value Target for

753
00:26:30,000 --> 00:26:32,640
a hacker threat actor adversary apt

754
00:26:32,640 --> 00:26:34,919
nation state right because again keep in

755
00:26:34,919 --> 00:26:37,620
mind all of the other computers or hosts

756
00:26:37,620 --> 00:26:39,419
that might end up

757
00:26:39,419 --> 00:26:42,299
backing up their data will work and

758
00:26:42,299 --> 00:26:45,419
synchronize with this Backup Manager

759
00:26:45,419 --> 00:26:47,460
so we start to think

760
00:26:47,460 --> 00:26:49,860
hang on what if there's a certain amount

761
00:26:49,860 --> 00:26:51,840
of domino effect here hey Poison the

762
00:26:51,840 --> 00:26:53,700
Well get the tree and then all the

763
00:26:53,700 --> 00:26:55,620
branches and root just die here so we

764
00:26:55,620 --> 00:26:58,020
started to dig into the API of this

765
00:26:58,020 --> 00:26:59,460
application now that we've gained code

766
00:26:59,460 --> 00:27:01,500
execution we have full compromise access

767
00:27:01,500 --> 00:27:03,000
and we can still act as the

768
00:27:03,000 --> 00:27:06,000
administrator what more can we do

769
00:27:06,000 --> 00:27:08,279
keep asking ourselves that question this

770
00:27:08,279 --> 00:27:11,100
is uh some of the soap services or

771
00:27:11,100 --> 00:27:13,140
methods or functions we can call with

772
00:27:13,140 --> 00:27:14,940
the API

773
00:27:14,940 --> 00:27:17,159
does anyone see anything really really

774
00:27:17,159 --> 00:27:20,120
interesting there

775
00:27:20,659 --> 00:27:23,880
are some fun ones delete agent

776
00:27:23,880 --> 00:27:24,960
I don't know how well you can see that

777
00:27:24,960 --> 00:27:26,760
there's a there's a get agents get

778
00:27:26,760 --> 00:27:31,039
default agent ID create agents

779
00:27:31,980 --> 00:27:34,620
I see it down there yeah run agent

780
00:27:34,620 --> 00:27:36,120
command

781
00:27:36,120 --> 00:27:38,520
oh no

782
00:27:38,520 --> 00:27:39,900
so what are you thinking what are we

783
00:27:39,900 --> 00:27:42,360
thinking look we had an authentication

784
00:27:42,360 --> 00:27:45,419
bypass that we just was point and shoot

785
00:27:45,419 --> 00:27:47,159
right we didn't need to know credentials

786
00:27:47,159 --> 00:27:48,659
we didn't need to know anything about

787
00:27:48,659 --> 00:27:50,220
the target of the fact that it's

788
00:27:50,220 --> 00:27:52,440
potentially vulnerable and then we just

789
00:27:52,440 --> 00:27:54,960
fire away and now we could potentially

790
00:27:54,960 --> 00:27:57,120
again code execution and now we could

791
00:27:57,120 --> 00:27:59,400
potentially bundle that up

792
00:27:59,400 --> 00:28:02,100
to run code execution on all of the

793
00:28:02,100 --> 00:28:04,919
downstream connected servers that use

794
00:28:04,919 --> 00:28:07,380
that machine as their backups

795
00:28:07,380 --> 00:28:09,120
kind of wild

796
00:28:09,120 --> 00:28:09,960
um

797
00:28:09,960 --> 00:28:12,059
if I may I think I do have a video here

798
00:28:12,059 --> 00:28:13,740
if my friends might be able to help

799
00:28:13,740 --> 00:28:15,000
bring that up I'd love to be able to

800
00:28:15,000 --> 00:28:16,679
Showcase it because I wanted to bring

801
00:28:16,679 --> 00:28:19,679
that to your attention of the impact

802
00:28:19,679 --> 00:28:20,760
um

803
00:28:20,760 --> 00:28:22,620
I'll see if I can bring it together so

804
00:28:22,620 --> 00:28:24,480
here we have a couple machines all put

805
00:28:24,480 --> 00:28:26,340
together and I'm just logging into the

806
00:28:26,340 --> 00:28:27,539
Backup Manager for the sake of

807
00:28:27,539 --> 00:28:30,419
showcasing say hey here are the machines

808
00:28:30,419 --> 00:28:31,860
that are connected here's a Windows 10

809
00:28:31,860 --> 00:28:34,020
box Windows 11 Windows 8 Windows Server

810
00:28:34,020 --> 00:28:37,020
whatever whatever now around this time

811
00:28:37,020 --> 00:28:39,360
this is October so just about a month

812
00:28:39,360 --> 00:28:42,419
ago uh lock bit one of the ransomware

813
00:28:42,419 --> 00:28:43,799
gangs was getting into a little bit of

814
00:28:43,799 --> 00:28:45,720
trouble because they seem to have a lot

815
00:28:45,720 --> 00:28:48,299
of their ransomware tooling released out

816
00:28:48,299 --> 00:28:50,460
online it was public and it was released

817
00:28:50,460 --> 00:28:52,679
so I thought

818
00:28:52,679 --> 00:28:54,179
well you know what some really good

819
00:28:54,179 --> 00:28:56,159
fireworks you know what will really blow

820
00:28:56,159 --> 00:28:57,960
people's mind

821
00:28:57,960 --> 00:29:00,659
what if we just push ransomware down

822
00:29:00,659 --> 00:29:03,240
this big giant supply chain attack so

823
00:29:03,240 --> 00:29:04,799
there it is here's our run on our

824
00:29:04,799 --> 00:29:06,620
exploit running our code here's python

825
00:29:06,620 --> 00:29:10,380
to tell every single Downstream host

826
00:29:10,380 --> 00:29:13,860
connect back to me and download lockdit

827
00:29:13,860 --> 00:29:16,320
and then run and deploy and detonate

828
00:29:16,320 --> 00:29:19,020
ransomware across each and every one of

829
00:29:19,020 --> 00:29:20,159
these

830
00:29:20,159 --> 00:29:21,779
whoa

831
00:29:21,779 --> 00:29:23,580
okay

832
00:29:23,580 --> 00:29:25,080
I don't know how well hey we might be

833
00:29:25,080 --> 00:29:26,279
cruising through this year but I did

834
00:29:26,279 --> 00:29:27,480
want to bring that to your attention

835
00:29:27,480 --> 00:29:28,980
because

836
00:29:28,980 --> 00:29:32,340
this could be a real big thing this

837
00:29:32,340 --> 00:29:34,980
could have been potentially some crazy

838
00:29:34,980 --> 00:29:36,659
Shenanigans I don't know if folks are

839
00:29:36,659 --> 00:29:39,240
familiar with caseya VSA uh some time

840
00:29:39,240 --> 00:29:42,840
ago another MSP kind of spearhead caseya

841
00:29:42,840 --> 00:29:44,779
had a little bit of ransomware

842
00:29:44,779 --> 00:29:47,640
Armageddon uh and there were a whole lot

843
00:29:47,640 --> 00:29:50,460
of businesses compromised with Regal the

844
00:29:50,460 --> 00:29:52,440
ransomware operator and it was exactly

845
00:29:52,440 --> 00:29:54,360
this using the rmm or the remote

846
00:29:54,360 --> 00:29:56,580
monitoring and management solution to

847
00:29:56,580 --> 00:29:59,360
push down ransomware to each component

848
00:29:59,360 --> 00:30:01,919
thank you for spinning up the video I

849
00:30:01,919 --> 00:30:03,240
did want to bring that because I thought

850
00:30:03,240 --> 00:30:07,100
wow maybe that shows the impact here

851
00:30:07,320 --> 00:30:09,360
but that's that

852
00:30:09,360 --> 00:30:11,399
that's cutesy when I get to put in a

853
00:30:11,399 --> 00:30:13,440
video of hey maybe four connected

854
00:30:13,440 --> 00:30:15,120
machines for the sake of show and tell

855
00:30:15,120 --> 00:30:16,860
but what's the real blast radius here

856
00:30:16,860 --> 00:30:20,580
how much damage could this do

857
00:30:20,580 --> 00:30:23,039
we fire up Showdown right Internet of

858
00:30:23,039 --> 00:30:24,419
Things search engine folks might be

859
00:30:24,419 --> 00:30:25,740
familiar with that to see what else is

860
00:30:25,740 --> 00:30:27,779
out there on the open internet how many

861
00:30:27,779 --> 00:30:30,059
server backup managers are out there in

862
00:30:30,059 --> 00:30:32,340
the world and we got what close to five

863
00:30:32,340 --> 00:30:34,440
thousand

864
00:30:34,440 --> 00:30:37,200
um okay and remember that is the server

865
00:30:37,200 --> 00:30:39,720
itself that is the Backup Manager it is

866
00:30:39,720 --> 00:30:42,240
not the downstream components of all the

867
00:30:42,240 --> 00:30:44,640
hosts that might be connected to it

868
00:30:44,640 --> 00:30:46,440
all vulnerable because of some ZK

869
00:30:46,440 --> 00:30:51,559
Library Downstream Downstream Downstream

870
00:30:51,960 --> 00:30:53,700
so uh

871
00:30:53,700 --> 00:30:56,820
tough to to swallow that pill uh but

872
00:30:56,820 --> 00:30:58,320
again we want to do the right thing here

873
00:30:58,320 --> 00:31:00,120
we want to bring this to the best

874
00:31:00,120 --> 00:31:01,740
attention that we could we want to bring

875
00:31:01,740 --> 00:31:03,120
this to connect wise and do the right

876
00:31:03,120 --> 00:31:05,279
thing we're not hackers I might be doing

877
00:31:05,279 --> 00:31:06,779
the security research to find this stuff

878
00:31:06,779 --> 00:31:08,100
out

879
00:31:08,100 --> 00:31:10,740
but I'm not a ransomware operator

880
00:31:10,740 --> 00:31:11,940
so

881
00:31:11,940 --> 00:31:14,279
we start to wonder hey

882
00:31:14,279 --> 00:31:17,039
should we wait for connectwise to patch

883
00:31:17,039 --> 00:31:18,659
this thing just I don't know like like

884
00:31:18,659 --> 00:31:20,580
tricos or Florian or our Twitter friend

885
00:31:20,580 --> 00:31:22,679
mentioned and the direct messages that I

886
00:31:22,679 --> 00:31:25,620
had back and forth and of course yes the

887
00:31:25,620 --> 00:31:27,600
answer there is yes we should wait until

888
00:31:27,600 --> 00:31:30,480
they're patched to tell the story

889
00:31:30,480 --> 00:31:32,159
and then some time passes hey there's

890
00:31:32,159 --> 00:31:34,500
some communication and they say

891
00:31:34,500 --> 00:31:37,140
look connect boys couldn't reproduce it

892
00:31:37,140 --> 00:31:38,820
they couldn't recreate it they couldn't

893
00:31:38,820 --> 00:31:40,020
actually bring in some of the

894
00:31:40,020 --> 00:31:42,059
breadcrumbs that you guys had to build

895
00:31:42,059 --> 00:31:44,220
this detonator

896
00:31:44,220 --> 00:31:45,720
they asked if we'd be willing to work

897
00:31:45,720 --> 00:31:47,460
with them I'm like yes of course

898
00:31:47,460 --> 00:31:49,500
absolutely a thousand percent I want to

899
00:31:49,500 --> 00:31:52,640
help with all this

900
00:31:52,679 --> 00:31:55,080
so we met with connectwise Caleb and I

901
00:31:55,080 --> 00:31:56,580
Caleb I gave the other researchers that

902
00:31:56,580 --> 00:31:58,799
were digging into this and

903
00:31:58,799 --> 00:32:00,659
it went well it was very good it was

904
00:32:00,659 --> 00:32:02,100
very very positive to have a

905
00:32:02,100 --> 00:32:05,340
communication face-to-face over Zoom to

906
00:32:05,340 --> 00:32:07,020
talk about this where we get to show

907
00:32:07,020 --> 00:32:09,000
them some of the code show them what we

908
00:32:09,000 --> 00:32:11,039
built show them how this could really

909
00:32:11,039 --> 00:32:13,140
impact things and they were receptive

910
00:32:13,140 --> 00:32:14,940
that was the best thing that we could

911
00:32:14,940 --> 00:32:16,380
hear because it's I know it's really

912
00:32:16,380 --> 00:32:18,000
weird when you have someone that says

913
00:32:18,000 --> 00:32:20,279
hey I just hacked all your stuff

914
00:32:20,279 --> 00:32:21,659
but we want to build the right

915
00:32:21,659 --> 00:32:23,220
relationship with that

916
00:32:23,220 --> 00:32:25,679
turns out they couldn't directly update

917
00:32:25,679 --> 00:32:29,100
to the latest ZK Library

918
00:32:29,100 --> 00:32:31,140
they weren't able to patch even though

919
00:32:31,140 --> 00:32:34,260
the patch was available in May

920
00:32:34,260 --> 00:32:36,539
because they're running Java 7.

921
00:32:36,539 --> 00:32:38,940
okay folks that know Java probably

922
00:32:38,940 --> 00:32:41,279
understand that Agony uh the patch

923
00:32:41,279 --> 00:32:43,799
version of ZK is on Java eight and

924
00:32:43,799 --> 00:32:46,380
migrating those is a nightmare so okay

925
00:32:46,380 --> 00:32:49,140
look understood couldn't just as easily

926
00:32:49,140 --> 00:32:52,200
patch because that version mismatch

927
00:32:52,200 --> 00:32:53,700
but then

928
00:32:53,700 --> 00:32:55,980
we chatted about like hey I'd love to

929
00:32:55,980 --> 00:32:57,659
keep helping I want I want to bring this

930
00:32:57,659 --> 00:33:00,059
to you for all the right reasons so I

931
00:33:00,059 --> 00:33:01,919
know if you're getting a micro pack even

932
00:33:01,919 --> 00:33:03,960
something from ZK specifically for

933
00:33:03,960 --> 00:33:05,580
version seven

934
00:33:05,580 --> 00:33:07,260
for that Java version that you're

935
00:33:07,260 --> 00:33:09,299
running as part of this product

936
00:33:09,299 --> 00:33:10,799
can we help

937
00:33:10,799 --> 00:33:12,720
test that patch can we validate can we

938
00:33:12,720 --> 00:33:14,220
make sure the fix really really works

939
00:33:14,220 --> 00:33:16,320
against our exploit against our proof of

940
00:33:16,320 --> 00:33:18,779
concept and they say their understanding

941
00:33:18,779 --> 00:33:20,340
and it might be over this they're open

942
00:33:20,340 --> 00:33:21,720
to it

943
00:33:21,720 --> 00:33:24,360
but they need us to sign an NDA

944
00:33:24,360 --> 00:33:27,419
need us on an on-disclosure agreement

945
00:33:27,419 --> 00:33:29,279
um

946
00:33:29,279 --> 00:33:31,559
two reactions to this and I'm totally

947
00:33:31,559 --> 00:33:34,080
understanding of each and you might have

948
00:33:34,080 --> 00:33:35,640
your own immediate opinion knee-jerk

949
00:33:35,640 --> 00:33:37,500
reaction as to wait a second huh wait oh

950
00:33:37,500 --> 00:33:39,000
actually yes

951
00:33:39,000 --> 00:33:39,720
um

952
00:33:39,720 --> 00:33:43,140
number one I think yes of course

953
00:33:43,140 --> 00:33:45,120
absolutely I understand I know this is

954
00:33:45,120 --> 00:33:46,799
your product I know this is your baby I

955
00:33:46,799 --> 00:33:48,059
know this is what we're trying to do to

956
00:33:48,059 --> 00:33:49,140
make sure that we're doing the

957
00:33:49,140 --> 00:33:51,360
formalities correctly we're dotting all

958
00:33:51,360 --> 00:33:53,340
the eyes we're crossing the t's

959
00:33:53,340 --> 00:33:55,860
legal stuff right

960
00:33:55,860 --> 00:33:57,899
opinion number two

961
00:33:57,899 --> 00:33:59,720
wait a second what why

962
00:33:59,720 --> 00:34:02,399
I'm just trying to validate and help

963
00:34:02,399 --> 00:34:04,380
your patch

964
00:34:04,380 --> 00:34:05,519
um

965
00:34:05,519 --> 00:34:07,440
you of course can conform your own

966
00:34:07,440 --> 00:34:09,239
opinion there and I'm curious what that

967
00:34:09,239 --> 00:34:12,060
might be but it's always a weird sort of

968
00:34:12,060 --> 00:34:13,859
a certain gut punch when a researcher

969
00:34:13,859 --> 00:34:15,780
kind of sees an NDA and especially with

970
00:34:15,780 --> 00:34:18,780
the companies involved and you know you

971
00:34:18,780 --> 00:34:20,339
know I don't have to fill in those gaps

972
00:34:20,339 --> 00:34:23,099
for you but then all of a sudden

973
00:34:23,099 --> 00:34:25,739
some days pass time I think it was just

974
00:34:25,739 --> 00:34:27,659
Friday maybe that same week they're

975
00:34:27,659 --> 00:34:29,820
pinging us out like uh did you guys have

976
00:34:29,820 --> 00:34:31,560
anything to do with this

977
00:34:31,560 --> 00:34:33,599
do you guys have any more commentary or

978
00:34:33,599 --> 00:34:35,099
stuff because connectwise we just

979
00:34:35,099 --> 00:34:36,719
published it they brought out in the

980
00:34:36,719 --> 00:34:38,159
open and now everyone knows what's going

981
00:34:38,159 --> 00:34:39,060
on

982
00:34:39,060 --> 00:34:41,639
it's the cat's out of the bag

983
00:34:41,639 --> 00:34:43,679
there is the link to their security

984
00:34:43,679 --> 00:34:46,859
bulletin there is their uh server Backup

985
00:34:46,859 --> 00:34:49,560
Manager advisory and release the patch

986
00:34:49,560 --> 00:34:51,300
that they're bringing out kind of threw

987
00:34:51,300 --> 00:34:53,040
us off guard not gonna lie and that's on

988
00:34:53,040 --> 00:34:55,379
it again they're their own spot they can

989
00:34:55,379 --> 00:34:57,420
do what they'd like to do but

990
00:34:57,420 --> 00:34:59,099
it wasn't what we expected because we

991
00:34:59,099 --> 00:35:00,540
thought we were kind of hey in This

992
00:35:00,540 --> 00:35:02,099
Together synchronizing some of that

993
00:35:02,099 --> 00:35:05,720
coordination in collaboration

994
00:35:06,420 --> 00:35:07,859
now

995
00:35:07,859 --> 00:35:10,260
the cat's out of the back this is when

996
00:35:10,260 --> 00:35:12,060
all of those news stories and those

997
00:35:12,060 --> 00:35:13,560
headlines and those journalists in the

998
00:35:13,560 --> 00:35:15,839
screaming October as we started with a

999
00:35:15,839 --> 00:35:17,040
little bit of our talk and presentation

1000
00:35:17,040 --> 00:35:18,900
here now they're starting to fly hey

1001
00:35:18,900 --> 00:35:21,119
connect wise patch is this critical flaw

1002
00:35:21,119 --> 00:35:22,859
that could have affected those 5 000

1003
00:35:22,859 --> 00:35:25,020
servers and all their Downstream

1004
00:35:25,020 --> 00:35:26,339
components

1005
00:35:26,339 --> 00:35:28,020
Caleb got some time in the Limelight

1006
00:35:28,020 --> 00:35:29,579
chatting with crn chatting with other

1007
00:35:29,579 --> 00:35:32,520
reporters and journalists

1008
00:35:32,520 --> 00:35:35,040
and we started to do our own write-up we

1009
00:35:35,040 --> 00:35:37,380
wanted to scramble like oh hang on wait

1010
00:35:37,380 --> 00:35:38,460
a second I didn't realize we were

1011
00:35:38,460 --> 00:35:40,320
getting our communication out this fast

1012
00:35:40,320 --> 00:35:42,839
so I try to put it together

1013
00:35:42,839 --> 00:35:43,740
um

1014
00:35:43,740 --> 00:35:46,020
and we wrote up everything the same

1015
00:35:46,020 --> 00:35:47,339
exact story that I've just told you

1016
00:35:47,339 --> 00:35:49,859
communicating with frikos hey building

1017
00:35:49,859 --> 00:35:51,420
this beating our head against the wall

1018
00:35:51,420 --> 00:35:53,099
trying to find the right solution trying

1019
00:35:53,099 --> 00:35:55,260
to do this correctly communication The

1020
00:35:55,260 --> 00:35:57,960
Better Together story that we want here

1021
00:35:57,960 --> 00:36:00,240
and that's what that is

1022
00:36:00,240 --> 00:36:01,980
here's the vulnerability disclosure for

1023
00:36:01,980 --> 00:36:04,020
connectwise or R1 soft server Backup

1024
00:36:04,020 --> 00:36:04,920
Manager

1025
00:36:04,920 --> 00:36:06,720
and the supply chain risk that comes

1026
00:36:06,720 --> 00:36:08,760
with that in both the weird technical

1027
00:36:08,760 --> 00:36:11,339
aspect the ZK Library Downstream to

1028
00:36:11,339 --> 00:36:14,339
software and the personal procedural

1029
00:36:14,339 --> 00:36:16,500
pipeline of businesses sold to

1030
00:36:16,500 --> 00:36:19,320
businesses to sell to more businesses

1031
00:36:19,320 --> 00:36:21,119
what you might find in the grocery store

1032
00:36:21,119 --> 00:36:23,220
you don't know where that you don't know

1033
00:36:23,220 --> 00:36:25,440
where that crop grew or that plant was

1034
00:36:25,440 --> 00:36:27,420
over at the farm

1035
00:36:27,420 --> 00:36:29,339
sometimes you just don't know how it's

1036
00:36:29,339 --> 00:36:32,040
all made behind the scenes

1037
00:36:32,040 --> 00:36:33,960
so this was a really really weird story

1038
00:36:33,960 --> 00:36:35,880
to tell because especially when we get

1039
00:36:35,880 --> 00:36:37,859
out some of our information try to do

1040
00:36:37,859 --> 00:36:39,480
this messaging we want to give the

1041
00:36:39,480 --> 00:36:41,820
community the right stuff we want to

1042
00:36:41,820 --> 00:36:42,900
give them

1043
00:36:42,900 --> 00:36:45,180
indicators of compromise or indicators

1044
00:36:45,180 --> 00:36:47,520
of attack or some threat intelligence or

1045
00:36:47,520 --> 00:36:49,680
some info and details and analytics that

1046
00:36:49,680 --> 00:36:50,820
they can use

1047
00:36:50,820 --> 00:36:52,619
to make sure that they're safe that

1048
00:36:52,619 --> 00:36:55,260
they're doing what they need to do if

1049
00:36:55,260 --> 00:36:56,760
they can patch or if they can find any

1050
00:36:56,760 --> 00:36:58,800
signs of exploitation now this is really

1051
00:36:58,800 --> 00:37:00,720
really weird because

1052
00:37:00,720 --> 00:37:01,380
um

1053
00:37:01,380 --> 00:37:03,359
we're taking advantage of

1054
00:37:03,359 --> 00:37:05,480
normal functionality

1055
00:37:05,480 --> 00:37:07,920
other than the authentication bypass

1056
00:37:07,920 --> 00:37:10,200
right the thing that opened the door

1057
00:37:10,200 --> 00:37:11,940
changing the database driver is

1058
00:37:11,940 --> 00:37:14,520
something that anyone could do the admin

1059
00:37:14,520 --> 00:37:16,920
would already naturally do

1060
00:37:16,920 --> 00:37:19,200
running an agent command

1061
00:37:19,200 --> 00:37:21,780
still something that was totally okay in

1062
00:37:21,780 --> 00:37:23,460
the eyes of the API and all those

1063
00:37:23,460 --> 00:37:25,320
different functions and features here

1064
00:37:25,320 --> 00:37:27,060
so we tried to show you and look here

1065
00:37:27,060 --> 00:37:29,160
are the logs I know it's dull and like

1066
00:37:29,160 --> 00:37:30,839
your eyes glaze over here but there's

1067
00:37:30,839 --> 00:37:32,640
nothing there there's nothing to really

1068
00:37:32,640 --> 00:37:34,560
showcase it isn't out of the norm

1069
00:37:34,560 --> 00:37:36,660
and that's kind of hard to come to terms

1070
00:37:36,660 --> 00:37:37,740
with here

1071
00:37:37,740 --> 00:37:39,420
um but that's just the server

1072
00:37:39,420 --> 00:37:41,940
perspective right that's that server

1073
00:37:41,940 --> 00:37:43,920
back at manager itself what about all

1074
00:37:43,920 --> 00:37:46,079
the downstream agents what about all the

1075
00:37:46,079 --> 00:37:47,820
hosts the computers that are trying to

1076
00:37:47,820 --> 00:37:49,980
back up their data

1077
00:37:49,980 --> 00:37:51,060
well

1078
00:37:51,060 --> 00:37:53,880
they just have these logs hey a command

1079
00:37:53,880 --> 00:37:55,020
ran

1080
00:37:55,020 --> 00:37:57,240
I don't tell you what the command was

1081
00:37:57,240 --> 00:37:58,680
they didn't tell you I detonated lock

1082
00:37:58,680 --> 00:38:01,200
but ransomware my host but something

1083
00:38:01,200 --> 00:38:05,760
happened so it's not super duper helpful

1084
00:38:05,760 --> 00:38:08,160
um hard to bring that out and weird

1085
00:38:08,160 --> 00:38:09,540
especially when we're Walking the

1086
00:38:09,540 --> 00:38:11,760
Tightrope of a potentially real emerging

1087
00:38:11,760 --> 00:38:14,040
vulnerability

1088
00:38:14,040 --> 00:38:16,079
so here's the complete timeline hey as

1089
00:38:16,079 --> 00:38:18,480
we saw in may we got that patch hey July

1090
00:38:18,480 --> 00:38:20,339
we saw the communications go out August

1091
00:38:20,339 --> 00:38:22,320
September October when we start to dig

1092
00:38:22,320 --> 00:38:24,300
into this when we have communications

1093
00:38:24,300 --> 00:38:27,420
with connectwise when we start to try to

1094
00:38:27,420 --> 00:38:29,400
put the puzzle pieces together

1095
00:38:29,400 --> 00:38:32,480
the best way that we can

1096
00:38:32,760 --> 00:38:35,040
now one thing to note here if I may

1097
00:38:35,040 --> 00:38:37,520
along this storyline

1098
00:38:37,520 --> 00:38:39,900
is that we never shared our proof of

1099
00:38:39,900 --> 00:38:41,820
concept kind of the same way that

1100
00:38:41,820 --> 00:38:43,800
Florian frico's Twitter guy was saying

1101
00:38:43,800 --> 00:38:45,839
look I don't want to enable those script

1102
00:38:45,839 --> 00:38:47,520
kitties or those threat actors or those

1103
00:38:47,520 --> 00:38:50,099
real hackers that do bad things

1104
00:38:50,099 --> 00:38:52,320
the proof of concept our exploit has not

1105
00:38:52,320 --> 00:38:53,940
been shared and will not be shared

1106
00:38:53,940 --> 00:38:55,800
outright because that would just be way

1107
00:38:55,800 --> 00:38:57,960
too risky and way too irresponsible

1108
00:38:57,960 --> 00:38:59,460
right now

1109
00:38:59,460 --> 00:39:00,180
um

1110
00:39:00,180 --> 00:39:02,400
as far as we're aware there has been no

1111
00:39:02,400 --> 00:39:04,020
exploitation in the wild there aren't

1112
00:39:04,020 --> 00:39:05,579
any real threats beating this up right

1113
00:39:05,579 --> 00:39:06,780
now

1114
00:39:06,780 --> 00:39:08,700
and then this was when I was putting up

1115
00:39:08,700 --> 00:39:10,500
that write-up

1116
00:39:10,500 --> 00:39:12,960
but those are the cornerstones right now

1117
00:39:12,960 --> 00:39:15,060
as we're again at the center piece of

1118
00:39:15,060 --> 00:39:16,260
our story

1119
00:39:16,260 --> 00:39:18,240
after we've unfolded and unraveled all

1120
00:39:18,240 --> 00:39:21,660
this we've got this new thing to show we

1121
00:39:21,660 --> 00:39:23,700
took an authentication bypass and drove

1122
00:39:23,700 --> 00:39:26,099
it towards remote code execution to be

1123
00:39:26,099 --> 00:39:28,200
like ransomware deployment mechanism

1124
00:39:28,200 --> 00:39:31,079
across all these hosts

1125
00:39:31,079 --> 00:39:33,420
but we didn't want to give that out of

1126
00:39:33,420 --> 00:39:36,060
course as the Arsenal that it was

1127
00:39:36,060 --> 00:39:37,920
granted we told the story and maybe

1128
00:39:37,920 --> 00:39:39,240
there are some breadcrumbs in there to

1129
00:39:39,240 --> 00:39:41,339
make sense of this maybe smart any

1130
00:39:41,339 --> 00:39:43,680
seasoned hacker in the room could just

1131
00:39:43,680 --> 00:39:47,099
as easily create that proof of concept

1132
00:39:47,099 --> 00:39:49,260
so

1133
00:39:49,260 --> 00:39:52,440
let's move forward now in our timeline

1134
00:39:52,440 --> 00:39:54,839
four months later uh

1135
00:39:54,839 --> 00:39:57,480
wanted to bring you to today the current

1136
00:39:57,480 --> 00:40:00,240
events where we are right now uh because

1137
00:40:00,240 --> 00:40:03,000
I know if I weren't already rambling and

1138
00:40:03,000 --> 00:40:04,560
droning on for way too long the stories

1139
00:40:04,560 --> 00:40:06,900
not get over

1140
00:40:06,900 --> 00:40:10,859
Fox I.T another Sweet Security spot

1141
00:40:10,859 --> 00:40:12,900
releases this article releases this

1142
00:40:12,900 --> 00:40:14,160
write-up and the timeline here is

1143
00:40:14,160 --> 00:40:16,680
February February 22nd

1144
00:40:16,680 --> 00:40:19,500
today is what March 23rd

1145
00:40:19,500 --> 00:40:22,200
from backup to back door exploitation of

1146
00:40:22,200 --> 00:40:24,599
this cve the ZK authentication bypass

1147
00:40:24,599 --> 00:40:26,820
and the R1 soft server Backup Manager

1148
00:40:26,820 --> 00:40:28,800
they say during a recent incident

1149
00:40:28,800 --> 00:40:31,079
response case we found traces of the

1150
00:40:31,079 --> 00:40:33,420
adversary leveraging and taking

1151
00:40:33,420 --> 00:40:35,520
advantage of the connectwise R1 soft

1152
00:40:35,520 --> 00:40:37,859
server back in manager the adversary

1153
00:40:37,859 --> 00:40:39,420
used it as an initial point of access

1154
00:40:39,420 --> 00:40:41,940
and as a platform to control those

1155
00:40:41,940 --> 00:40:44,220
Downstream systems connected by The

1156
00:40:44,220 --> 00:40:46,320
Backup Manager

1157
00:40:46,320 --> 00:40:48,300
crap

1158
00:40:48,300 --> 00:40:50,460
it started to happen

1159
00:40:50,460 --> 00:40:52,859
makes sense I mean I guess like there's

1160
00:40:52,859 --> 00:40:54,660
a matter of time I don't know not a

1161
00:40:54,660 --> 00:40:56,400
matter of if a matter of when you know

1162
00:40:56,400 --> 00:40:58,680
uh

1163
00:40:58,680 --> 00:41:00,119
but this is kind of weird and wild

1164
00:41:00,119 --> 00:41:02,940
because we start to see everyone scream

1165
00:41:02,940 --> 00:41:04,320
and shout about this even a little bit

1166
00:41:04,320 --> 00:41:07,079
more so than when we tried to bring it

1167
00:41:07,079 --> 00:41:09,780
out to proactively patch to preemptively

1168
00:41:09,780 --> 00:41:11,760
do the right thing to fix this before it

1169
00:41:11,760 --> 00:41:13,260
got taken advantage of

1170
00:41:13,260 --> 00:41:15,060
by bad people

1171
00:41:15,060 --> 00:41:18,480
headlines are back in action I know you

1172
00:41:18,480 --> 00:41:20,040
see tweets you see Twitter messages you

1173
00:41:20,040 --> 00:41:22,140
see folks on Mastodon saying

1174
00:41:22,140 --> 00:41:23,160
um

1175
00:41:23,160 --> 00:41:25,020
NSA is tracking us from the United

1176
00:41:25,020 --> 00:41:27,240
States side uh sizza I don't know if

1177
00:41:27,240 --> 00:41:29,460
folks are familiar oh this is the uh

1178
00:41:29,460 --> 00:41:31,980
Center for information or excuse me

1179
00:41:31,980 --> 00:41:33,599
cyber security infrastructure and

1180
00:41:33,599 --> 00:41:35,579
Security Agency and they have and

1181
00:41:35,579 --> 00:41:38,160
maintained this known database this

1182
00:41:38,160 --> 00:41:40,260
catalog of exploited vulnerabilities

1183
00:41:40,260 --> 00:41:43,680
some of the big ones like log4j if folks

1184
00:41:43,680 --> 00:41:46,280
are familiar with that uh and guess what

1185
00:41:46,280 --> 00:41:49,020
the silly strange vulnerability that we

1186
00:41:49,020 --> 00:41:51,720
were beaten up got itself a name

1187
00:41:51,720 --> 00:41:54,119
smack dab in that catalog an envelope

1188
00:41:54,119 --> 00:41:56,940
for that ZK framework bypass

1189
00:41:56,940 --> 00:42:00,420
and we thought wow okay uh this is again

1190
00:42:00,420 --> 00:42:02,280
a little bit of a spotlight in a Strange

1191
00:42:02,280 --> 00:42:03,660
New Way

1192
00:42:03,660 --> 00:42:04,619
um

1193
00:42:04,619 --> 00:42:06,839
and that's really really weird to

1194
00:42:06,839 --> 00:42:09,300
stomach if I may from from a personal

1195
00:42:09,300 --> 00:42:10,740
level digging into it and spending those

1196
00:42:10,740 --> 00:42:11,820
long nights cutting through the code

1197
00:42:11,820 --> 00:42:13,800
trying to find how can we push this

1198
00:42:13,800 --> 00:42:15,780
further for the right reasons if there

1199
00:42:15,780 --> 00:42:17,400
even is one I don't know it gets super

1200
00:42:17,400 --> 00:42:20,720
blurry and super duper Gray

1201
00:42:21,119 --> 00:42:23,339
but Fox I.T

1202
00:42:23,339 --> 00:42:25,440
appreciate them they say hey you know

1203
00:42:25,440 --> 00:42:27,359
what October way back to the center of

1204
00:42:27,359 --> 00:42:28,740
our storyline the security company

1205
00:42:28,740 --> 00:42:30,300
Huntress hey those nerds and Geeks John

1206
00:42:30,300 --> 00:42:31,740
and Caleb they were publishing about

1207
00:42:31,740 --> 00:42:34,260
this and how it can be used how this

1208
00:42:34,260 --> 00:42:36,720
authentication bypass could lead to

1209
00:42:36,720 --> 00:42:38,520
remote code execution and it's connected

1210
00:42:38,520 --> 00:42:40,260
backup agents

1211
00:42:40,260 --> 00:42:42,780
another video of lock bit ransomware

1212
00:42:42,780 --> 00:42:44,640
being pushed down to all those they have

1213
00:42:44,640 --> 00:42:46,320
a couple stats up here hey how many

1214
00:42:46,320 --> 00:42:48,900
backdoor servers are already out on the

1215
00:42:48,900 --> 00:42:52,320
open internet because that is the

1216
00:42:52,320 --> 00:42:54,900
current situation and that while they

1217
00:42:54,900 --> 00:42:56,400
found these breadcrumbs in a real

1218
00:42:56,400 --> 00:42:58,619
incident response case that triggers

1219
00:42:58,619 --> 00:43:00,000
them

1220
00:43:00,000 --> 00:43:01,920
to go do their research and to go do

1221
00:43:01,920 --> 00:43:03,180
their digging

1222
00:43:03,180 --> 00:43:06,060
what's the blast radius again right how

1223
00:43:06,060 --> 00:43:09,240
much has this done

1224
00:43:09,240 --> 00:43:11,220
so there's a graph of hey maybe by

1225
00:43:11,220 --> 00:43:13,380
country or where there might be some web

1226
00:43:13,380 --> 00:43:15,240
shells already present because what

1227
00:43:15,240 --> 00:43:16,920
threat actors would do and I don't know

1228
00:43:16,920 --> 00:43:18,720
if I may have moved past the slide let

1229
00:43:18,720 --> 00:43:21,180
me backtrack just a moment uh nope might

1230
00:43:21,180 --> 00:43:22,859
have just missed it okay

1231
00:43:22,859 --> 00:43:25,619
there is a uh traction

1232
00:43:25,619 --> 00:43:27,960
no no cool

1233
00:43:27,960 --> 00:43:29,760
there's a slot where they mention look

1234
00:43:29,760 --> 00:43:33,300
we found about a hundred web shells

1235
00:43:33,300 --> 00:43:35,339
public on the open internet since

1236
00:43:35,339 --> 00:43:40,140
January uh January 9th so

1237
00:43:40,140 --> 00:43:42,660
it's March now and I I wonder and I feel

1238
00:43:42,660 --> 00:43:45,000
like that number has gone up right

1239
00:43:45,000 --> 00:43:47,280
so what a threat actor would do what a

1240
00:43:47,280 --> 00:43:48,780
genuine hacker might end up doing is

1241
00:43:48,780 --> 00:43:51,180
taking advantages as they would with all

1242
00:43:51,180 --> 00:43:52,500
the explanation and detail that I've

1243
00:43:52,500 --> 00:43:54,780
just given you but using the database

1244
00:43:54,780 --> 00:43:57,599
driver to add a persistent web shell so

1245
00:43:57,599 --> 00:43:59,099
they can just naturally connect right

1246
00:43:59,099 --> 00:44:01,140
back to the server anytime they want

1247
00:44:01,140 --> 00:44:04,140
whenever they want to do more damage

1248
00:44:04,140 --> 00:44:06,240
uh for nerds in a room that's the

1249
00:44:06,240 --> 00:44:09,000
Godzilla web shell another one of those

1250
00:44:09,000 --> 00:44:11,640
Java code bases that they can use and

1251
00:44:11,640 --> 00:44:13,740
what they've seen for later post

1252
00:44:13,740 --> 00:44:16,319
exploitation has been some small simple

1253
00:44:16,319 --> 00:44:19,020
stuff they throw up uh python simple

1254
00:44:19,020 --> 00:44:21,540
HTTP server and then just sort of lurk

1255
00:44:21,540 --> 00:44:23,400
and wait and try to slowly exfiltrate

1256
00:44:23,400 --> 00:44:26,579
data uh I got in touch with the fox it

1257
00:44:26,579 --> 00:44:28,319
fellows I tried to reach out and I said

1258
00:44:28,319 --> 00:44:30,300
look can we talk can we can we have a

1259
00:44:30,300 --> 00:44:31,619
meeting can I can we share what we've

1260
00:44:31,619 --> 00:44:34,440
been seeing here and there were again

1261
00:44:34,440 --> 00:44:37,319
extremely generous when willing to bring

1262
00:44:37,319 --> 00:44:39,240
me into the fold a little bit

1263
00:44:39,240 --> 00:44:40,680
because they had to take this blog post

1264
00:44:40,680 --> 00:44:42,660
down

1265
00:44:42,660 --> 00:44:45,480
they were momentarily making changes but

1266
00:44:45,480 --> 00:44:48,599
they were asked by a third party who was

1267
00:44:48,599 --> 00:44:50,940
not named to please take it down and

1268
00:44:50,940 --> 00:44:52,200
again you can probably use your

1269
00:44:52,200 --> 00:44:53,940
imagination to extrapolate okay what

1270
00:44:53,940 --> 00:44:56,099
that might mean one way or the other

1271
00:44:56,099 --> 00:44:57,599
um

1272
00:44:57,599 --> 00:44:59,579
and I thought thinking like what is what

1273
00:44:59,579 --> 00:45:01,400
does attribution look like

1274
00:45:01,400 --> 00:45:04,319
are we thinking okay nation state threat

1275
00:45:04,319 --> 00:45:06,240
actor hacker whatever normally we don't

1276
00:45:06,240 --> 00:45:08,220
talk about that because we don't

1277
00:45:08,220 --> 00:45:09,180
care

1278
00:45:09,180 --> 00:45:10,980
and I I don't mean to trivialize that

1279
00:45:10,980 --> 00:45:13,380
but when we see bad stuff when we see

1280
00:45:13,380 --> 00:45:15,599
malware we just said get that out I

1281
00:45:15,599 --> 00:45:16,920
don't want malware I don't want that

1282
00:45:16,920 --> 00:45:18,359
ransomware I don't care what it is what

1283
00:45:18,359 --> 00:45:20,940
it's from go away

1284
00:45:20,940 --> 00:45:23,819
but when Pope when people ask when those

1285
00:45:23,819 --> 00:45:25,800
cheesy news headlines or journalists

1286
00:45:25,800 --> 00:45:27,060
come down and say how did this happen

1287
00:45:27,060 --> 00:45:28,800
where did it come from

1288
00:45:28,800 --> 00:45:31,560
they asked the attribution question this

1289
00:45:31,560 --> 00:45:32,880
is skeptical

1290
00:45:32,880 --> 00:45:35,280
um and complete speculation but I

1291
00:45:35,280 --> 00:45:37,440
believe they were leaning towards the

1292
00:45:37,440 --> 00:45:39,599
same actors of hafnium if folks were

1293
00:45:39,599 --> 00:45:40,980
tracking a whole lot of the Microsoft

1294
00:45:40,980 --> 00:45:43,200
Exchange vulnerabilities some time ago

1295
00:45:43,200 --> 00:45:46,440
between proxy logon proxy shell proxy

1296
00:45:46,440 --> 00:45:49,700
not log on uh those threat actors would

1297
00:45:49,700 --> 00:45:54,720
China if I if I may be so bold right uh

1298
00:45:54,720 --> 00:45:56,640
it's funny when you get down to it

1299
00:45:56,640 --> 00:45:57,960
because when we have these conversations

1300
00:45:57,960 --> 00:45:59,819
of all these backdoored web shells and

1301
00:45:59,819 --> 00:46:02,400
what's out in the world

1302
00:46:02,400 --> 00:46:05,099
they said something that was so pithy to

1303
00:46:05,099 --> 00:46:06,720
me and it stuck with me and it still

1304
00:46:06,720 --> 00:46:08,460
hits like a bullet because it's very

1305
00:46:08,460 --> 00:46:10,980
very easy to think

1306
00:46:10,980 --> 00:46:12,300
everyone's going to say it's going to be

1307
00:46:12,300 --> 00:46:13,980
ransomware and everyone's going to be

1308
00:46:13,980 --> 00:46:15,480
screaming and shouting worried about

1309
00:46:15,480 --> 00:46:17,400
ransomware the next ransomware

1310
00:46:17,400 --> 00:46:19,319
Armageddon maybe something a little bit

1311
00:46:19,319 --> 00:46:22,079
more Sinister uh and they don't often

1312
00:46:22,079 --> 00:46:24,300
think about it's it's very likely just

1313
00:46:24,300 --> 00:46:27,180
going to be information espionage it's

1314
00:46:27,180 --> 00:46:28,619
it's very likely just going to be

1315
00:46:28,619 --> 00:46:31,380
sitting waiting lurking seeing as much

1316
00:46:31,380 --> 00:46:32,819
as they can get a hold of and listen in

1317
00:46:32,819 --> 00:46:35,040
on and then pulling it out

1318
00:46:35,040 --> 00:46:35,700
um

1319
00:46:35,700 --> 00:46:37,560
and that stuck with me I don't know

1320
00:46:37,560 --> 00:46:39,599
because

1321
00:46:39,599 --> 00:46:41,400
Ransom words in the news Ransom was in

1322
00:46:41,400 --> 00:46:42,660
the headlines wrestlers is what we're

1323
00:46:42,660 --> 00:46:44,760
chatting about but it might not always

1324
00:46:44,760 --> 00:46:46,260
be that they might just be taking it

1325
00:46:46,260 --> 00:46:47,460
slow

1326
00:46:47,460 --> 00:46:49,200
anyway I'm sorry I didn't mean to go

1327
00:46:49,200 --> 00:46:51,480
down that Doom and Gloom uh Road here

1328
00:46:51,480 --> 00:46:54,900
but I did want to show more of the story

1329
00:46:54,900 --> 00:46:57,180
while we crafted this exploit around

1330
00:46:57,180 --> 00:47:00,480
October and then timeline uh when we got

1331
00:47:00,480 --> 00:47:01,859
the messaging out of the very very end

1332
00:47:01,859 --> 00:47:03,720
of October maybe say near Halloween or

1333
00:47:03,720 --> 00:47:06,300
so there are new conversations and

1334
00:47:06,300 --> 00:47:08,400
Chatters of folks posting their own

1335
00:47:08,400 --> 00:47:10,200
write-ups of this and sharing their own

1336
00:47:10,200 --> 00:47:13,260
exploits in December so maybe as early

1337
00:47:13,260 --> 00:47:15,660
as a little more than a month and we've

1338
00:47:15,660 --> 00:47:18,119
seen these out and about online uh you

1339
00:47:18,119 --> 00:47:20,040
can still find them obviously this is

1340
00:47:20,040 --> 00:47:22,319
still something you could dig into but

1341
00:47:22,319 --> 00:47:23,880
they go through and if you actually take

1342
00:47:23,880 --> 00:47:25,319
a look at the GitHub some of the code

1343
00:47:25,319 --> 00:47:27,300
that's present here this is exactly it

1344
00:47:27,300 --> 00:47:30,240
taking advantage of the ZK Library

1345
00:47:30,240 --> 00:47:32,400
and using the exact same trade craft

1346
00:47:32,400 --> 00:47:34,740
that we used for the remote code

1347
00:47:34,740 --> 00:47:37,640
execution aspect

1348
00:47:39,780 --> 00:47:41,460
okay

1349
00:47:41,460 --> 00:47:42,839
um

1350
00:47:42,839 --> 00:47:46,020
sorry long story right but

1351
00:47:46,020 --> 00:47:49,440
and again to pull us out of the really

1352
00:47:49,440 --> 00:47:51,960
really Doom and Gloom hey thread actor

1353
00:47:51,960 --> 00:47:53,760
ransomware ransomware getting uh

1354
00:47:53,760 --> 00:47:56,760
vulnerabilities and exploits I I want to

1355
00:47:56,760 --> 00:47:59,640
zoom out because I think when we get to

1356
00:47:59,640 --> 00:48:02,819
tell this story it still comes with the

1357
00:48:02,819 --> 00:48:04,740
look we're trying to do this for the

1358
00:48:04,740 --> 00:48:07,859
best reasons that we could and it took

1359
00:48:07,859 --> 00:48:10,440
every single person in this play through

1360
00:48:10,440 --> 00:48:12,480
to make that happen

1361
00:48:12,480 --> 00:48:14,839
we would not have been able to see this

1362
00:48:14,839 --> 00:48:17,819
if fricos hadn't flagged it and was

1363
00:48:17,819 --> 00:48:19,319
chatting about it we would not have been

1364
00:48:19,319 --> 00:48:21,180
able to get at least a little bit of the

1365
00:48:21,180 --> 00:48:23,220
preemptive real better defense and

1366
00:48:23,220 --> 00:48:24,660
security and patching had we not

1367
00:48:24,660 --> 00:48:26,460
communicated with connect wise

1368
00:48:26,460 --> 00:48:28,200
what if that never happened at all what

1369
00:48:28,200 --> 00:48:30,480
if this just suddenly was a real zero

1370
00:48:30,480 --> 00:48:32,160
day that wasn't already at least some

1371
00:48:32,160 --> 00:48:34,740
things had the walls boarded up and the

1372
00:48:34,740 --> 00:48:37,380
doors closed here uh

1373
00:48:37,380 --> 00:48:39,180
so I wanted to drive that point home

1374
00:48:39,180 --> 00:48:40,619
because

1375
00:48:40,619 --> 00:48:43,200
it was a lot of information sharing and

1376
00:48:43,200 --> 00:48:44,940
knowledge sharing and getting people

1377
00:48:44,940 --> 00:48:47,579
together because it's really really

1378
00:48:47,579 --> 00:48:49,500
weird when I come to an event or a

1379
00:48:49,500 --> 00:48:51,180
conference and talking to a room full of

1380
00:48:51,180 --> 00:48:53,819
people it's very easy to wonder

1381
00:48:53,819 --> 00:48:55,920
why did you come here

1382
00:48:55,920 --> 00:48:58,440
why did you either come to listen to me

1383
00:48:58,440 --> 00:49:00,060
why did you come to play the CTF why'd

1384
00:49:00,060 --> 00:49:02,160
you go to this Workshop why did you come

1385
00:49:02,160 --> 00:49:04,560
to b-sides

1386
00:49:04,560 --> 00:49:07,020
it's because you wanted to be part of

1387
00:49:07,020 --> 00:49:10,380
this community to make things better

1388
00:49:10,380 --> 00:49:12,119
while sometimes there might have weird

1389
00:49:12,119 --> 00:49:13,980
fallouts and weird things that you

1390
00:49:13,980 --> 00:49:15,720
didn't expect or just I don't know some

1391
00:49:15,720 --> 00:49:17,940
certain amount of inconsequential things

1392
00:49:17,940 --> 00:49:19,079
that happen

1393
00:49:19,079 --> 00:49:21,900
uh you're here for the right reason

1394
00:49:21,900 --> 00:49:25,380
so forgive me long-winded on this I

1395
00:49:25,380 --> 00:49:27,000
really really do think the community

1396
00:49:27,000 --> 00:49:29,359
aspect when we get to tell these stories

1397
00:49:29,359 --> 00:49:31,800
blemishes faults things that go wrong

1398
00:49:31,800 --> 00:49:34,200
all in all that's still the teamwork in

1399
00:49:34,200 --> 00:49:36,540
the building that we're doing together

1400
00:49:36,540 --> 00:49:39,000
so

1401
00:49:39,000 --> 00:49:41,579
if I may last bit here because I know

1402
00:49:41,579 --> 00:49:45,300
I've been going for too long uh what I

1403
00:49:45,300 --> 00:49:46,619
would offer you

1404
00:49:46,619 --> 00:49:49,020
is for those nerds and Geeks and hackers

1405
00:49:49,020 --> 00:49:50,220
in the room or even for the folks that

1406
00:49:50,220 --> 00:49:52,200
aren't slinging code on the keyboard day

1407
00:49:52,200 --> 00:49:54,119
in and day out

1408
00:49:54,119 --> 00:49:56,160
we tried to dig into this thing because

1409
00:49:56,160 --> 00:49:58,800
we wanted to help fix the problems that

1410
00:49:58,800 --> 00:50:00,960
could have came up down the line

1411
00:50:00,960 --> 00:50:03,060
it's software that I don't use every day

1412
00:50:03,060 --> 00:50:05,160
except for we don't use but Partners

1413
00:50:05,160 --> 00:50:07,920
people other individuals do

1414
00:50:07,920 --> 00:50:10,319
and that's something that we should kind

1415
00:50:10,319 --> 00:50:12,000
of take a weird sense of responsibility

1416
00:50:12,000 --> 00:50:13,619
to go

1417
00:50:13,619 --> 00:50:14,760
fix

1418
00:50:14,760 --> 00:50:17,220
and go help because

1419
00:50:17,220 --> 00:50:19,800
that spooky scary supply chain while I

1420
00:50:19,800 --> 00:50:21,900
keep making light of it that's very very

1421
00:50:21,900 --> 00:50:23,760
Sinister and like you've got an upstream

1422
00:50:23,760 --> 00:50:25,980
vulnerability in ZK

1423
00:50:25,980 --> 00:50:27,780
The Showdown screenshots that I showed

1424
00:50:27,780 --> 00:50:30,359
you 5 000 servers

1425
00:50:30,359 --> 00:50:32,099
that's for the server Backup Manager

1426
00:50:32,099 --> 00:50:35,099
application that is not for all the

1427
00:50:35,099 --> 00:50:36,300
other programs and all the other

1428
00:50:36,300 --> 00:50:38,760
software that use the ZK Library

1429
00:50:38,760 --> 00:50:40,260
I've seen a whole bunch of others that

1430
00:50:40,260 --> 00:50:43,380
are using for school administration for

1431
00:50:43,380 --> 00:50:45,119
managing Personnel I've seen even some

1432
00:50:45,119 --> 00:50:47,640
for visiting tickets to have visiting

1433
00:50:47,640 --> 00:50:51,480
time for prisons and that's weird

1434
00:50:51,480 --> 00:50:53,520
but I mean to say that is that there is

1435
00:50:53,520 --> 00:50:55,920
still more to go fix and we need to go

1436
00:50:55,920 --> 00:50:57,540
get a messaging and awareness out there

1437
00:50:57,540 --> 00:51:00,720
for them to make that better

1438
00:51:00,720 --> 00:51:03,240
so that's my rally and cry that's my

1439
00:51:03,240 --> 00:51:04,680
call to action if I may for you all

1440
00:51:04,680 --> 00:51:06,420
especially as you spent time here at

1441
00:51:06,420 --> 00:51:08,880
b-sides learning together

1442
00:51:08,880 --> 00:51:10,859
let's go fix those problems and make

1443
00:51:10,859 --> 00:51:12,119
stuff better

1444
00:51:12,119 --> 00:51:13,680
um

1445
00:51:13,680 --> 00:51:15,480
with that

1446
00:51:15,480 --> 00:51:18,780
that's uh that's enough for me rambling

1447
00:51:18,780 --> 00:51:20,040
cool

1448
00:51:20,040 --> 00:51:21,720
thank you thank you so much for letting

1449
00:51:21,720 --> 00:51:23,220
me spend time with you all uh if you'd

1450
00:51:23,220 --> 00:51:25,140
like to chat more anytime please don't

1451
00:51:25,140 --> 00:51:26,579
hesitate to reach out I have a QR code

1452
00:51:26,579 --> 00:51:28,559
up here don't scan QR codes your own

1453
00:51:28,559 --> 00:51:31,020
threat model and risk you choose but you

1454
00:51:31,020 --> 00:51:33,240
can track me down uh not a stranger by

1455
00:51:33,240 --> 00:51:35,280
any means please do please do come say

1456
00:51:35,280 --> 00:51:37,559
hi but I believe we have some time for

1457
00:51:37,559 --> 00:51:39,180
questions if that's a okay if anyone

1458
00:51:39,180 --> 00:51:41,400
wants to chat

1459
00:51:41,400 --> 00:51:43,880
okay

1460
00:51:45,030 --> 00:51:48,299
[Music]

1461
00:51:48,780 --> 00:51:51,599
there are so many lessons from this

1462
00:51:51,599 --> 00:51:52,800
um

1463
00:51:52,800 --> 00:51:55,800
uh I could start like

1464
00:51:55,800 --> 00:51:58,980
companies like involved in in providing

1465
00:51:58,980 --> 00:52:00,960
these Services I mean

1466
00:52:00,960 --> 00:52:04,800
I'm no coder I was doing uh doing a

1467
00:52:04,800 --> 00:52:08,220
masters in in business analytics and I

1468
00:52:08,220 --> 00:52:11,339
wrote a small python script to just

1469
00:52:11,339 --> 00:52:15,000
search for script Twitter for vengeance

1470
00:52:15,000 --> 00:52:16,800
of whatever

1471
00:52:16,800 --> 00:52:19,559
I mean if I could do this with um a

1472
00:52:19,559 --> 00:52:20,940
non-coder

1473
00:52:20,940 --> 00:52:22,920
I mean they could have done they could

1474
00:52:22,920 --> 00:52:25,980
have done that and see if there were

1475
00:52:25,980 --> 00:52:28,319
people talking about their product uh

1476
00:52:28,319 --> 00:52:32,480
second thing command and control

1477
00:52:32,700 --> 00:52:34,619
um what's your opinion on maybe

1478
00:52:34,619 --> 00:52:37,319
companies like really being who have

1479
00:52:37,319 --> 00:52:39,420
those kind of mission critical systems

1480
00:52:39,420 --> 00:52:41,760
like just blocking everything

1481
00:52:41,760 --> 00:52:44,220
except for those IP addresses that they

1482
00:52:44,220 --> 00:52:46,980
can they can verify they can interact

1483
00:52:46,980 --> 00:52:48,660
with it they can interact with their

1484
00:52:48,660 --> 00:52:51,180
software because part of the things that

1485
00:52:51,180 --> 00:52:52,559
yes you could have the exploit and

1486
00:52:52,559 --> 00:52:54,480
whatever so forth but just like with one

1487
00:52:54,480 --> 00:52:56,160
acquiry

1488
00:52:56,160 --> 00:52:57,720
um how that was stopped was that

1489
00:52:57,720 --> 00:52:59,520
somebody purchased that the address

1490
00:52:59,520 --> 00:53:02,099
where the command and control was

1491
00:53:02,099 --> 00:53:04,380
so something as simple as that

1492
00:53:04,380 --> 00:53:07,920
but I know it's maybe impractical I

1493
00:53:07,920 --> 00:53:09,540
I don't know what the opinion is like

1494
00:53:09,540 --> 00:53:13,260
I'm not I'm retired from being in it for

1495
00:53:13,260 --> 00:53:14,940
the last 13 years

1496
00:53:14,940 --> 00:53:18,420
so I really can't tell you like what if

1497
00:53:18,420 --> 00:53:19,980
that would be practical or anything like

1498
00:53:19,980 --> 00:53:21,780
that

1499
00:53:21,780 --> 00:53:24,839
okay so I'm going to try and restate it

1500
00:53:24,839 --> 00:53:26,339
just for me to help clarify for myself

1501
00:53:26,339 --> 00:53:28,260
and then you can gut check if I got that

1502
00:53:28,260 --> 00:53:31,260
right is that okay uh second question

1503
00:53:31,260 --> 00:53:34,079
was hey what about some of the

1504
00:53:34,079 --> 00:53:35,520
capabilities that we might be able to

1505
00:53:35,520 --> 00:53:38,099
put in place to just block those things

1506
00:53:38,099 --> 00:53:39,900
that look bad whether it's an IP address

1507
00:53:39,900 --> 00:53:42,119
whether it's a zone or region or

1508
00:53:42,119 --> 00:53:43,559
application

1509
00:53:43,559 --> 00:53:46,859
is that the right thread yes okay and

1510
00:53:46,859 --> 00:53:48,300
the first question did you was there

1511
00:53:48,300 --> 00:53:49,920
another first component of that or am I

1512
00:53:49,920 --> 00:53:52,140
it's just that it's just that okay you

1513
00:53:52,140 --> 00:53:54,119
shouldn't have taken you

1514
00:53:54,119 --> 00:53:56,940
I mean directly interacting with

1515
00:53:56,940 --> 00:54:00,059
connectwise several times for them to

1516
00:54:00,059 --> 00:54:01,980
respond when they already were contacted

1517
00:54:01,980 --> 00:54:04,800
from before and we're saying hey ah and

1518
00:54:04,800 --> 00:54:07,200
you know so companies can be more

1519
00:54:07,200 --> 00:54:10,079
proactive in terms in terms of

1520
00:54:10,079 --> 00:54:12,720
you know searching for dimensions on

1521
00:54:12,720 --> 00:54:14,520
whatever whatever

1522
00:54:14,520 --> 00:54:17,460
um sites that are known to how to have

1523
00:54:17,460 --> 00:54:20,400
these conversations so two threads I'm

1524
00:54:20,400 --> 00:54:22,319
hearing vulnerability disclosure and I'm

1525
00:54:22,319 --> 00:54:24,540
hearing proactive defensive blocking

1526
00:54:24,540 --> 00:54:26,520
malicious known malicious is that

1527
00:54:26,520 --> 00:54:28,079
correct right cool

1528
00:54:28,079 --> 00:54:30,000
um so I'll take vendor disclosure first

1529
00:54:30,000 --> 00:54:31,680
if that's okay

1530
00:54:31,680 --> 00:54:36,240
um yeah look hard reality to face when

1531
00:54:36,240 --> 00:54:37,740
you have an individual researcher that's

1532
00:54:37,740 --> 00:54:39,540
trying to bang on doors scream and

1533
00:54:39,540 --> 00:54:40,740
making commotions that they can get

1534
00:54:40,740 --> 00:54:42,540
something done fixed and that doesn't

1535
00:54:42,540 --> 00:54:45,180
come through uh and then you know the

1536
00:54:45,180 --> 00:54:47,339
another company understanding and

1537
00:54:47,339 --> 00:54:49,380
totally falling on our sword look we're

1538
00:54:49,380 --> 00:54:50,819
a vendor we're in the same pool we

1539
00:54:50,819 --> 00:54:53,220
played the same party and maybe that was

1540
00:54:53,220 --> 00:54:54,960
why we could get their attention I don't

1541
00:54:54,960 --> 00:54:58,440
know that sort of sucks but you're

1542
00:54:58,440 --> 00:54:59,940
absolutely right and like can we be more

1543
00:54:59,940 --> 00:55:02,040
proactive of getting organizations

1544
00:55:02,040 --> 00:55:04,319
businesses companies vendors whatever

1545
00:55:04,319 --> 00:55:09,000
to be more accepting of and receptive to

1546
00:55:09,000 --> 00:55:10,740
vulnerabilities and security weaknesses

1547
00:55:10,740 --> 00:55:11,640
that need to be brought to their

1548
00:55:11,640 --> 00:55:14,099
attention by another researcher or

1549
00:55:14,099 --> 00:55:16,040
someone in the in the hacking fight

1550
00:55:16,040 --> 00:55:18,300
a couple ways I think there are really

1551
00:55:18,300 --> 00:55:19,500
good ways to combat this because

1552
00:55:19,500 --> 00:55:21,960
ultimately I know and I think I heard

1553
00:55:21,960 --> 00:55:25,200
from frico specifically that said I got

1554
00:55:25,200 --> 00:55:27,359
the response that said well hey you

1555
00:55:27,359 --> 00:55:29,460
reached out to us via channels and

1556
00:55:29,460 --> 00:55:31,079
methods ABC

1557
00:55:31,079 --> 00:55:32,579
well we weren't going to see that we

1558
00:55:32,579 --> 00:55:34,200
don't if you would reach out to us via

1559
00:55:34,200 --> 00:55:36,180
methods XYZ then we would have been able

1560
00:55:36,180 --> 00:55:37,920
to get a hold of you like well that's

1561
00:55:37,920 --> 00:55:40,200
stupid why do these separate things

1562
00:55:40,200 --> 00:55:42,359
exist can we can we unify that can we

1563
00:55:42,359 --> 00:55:43,800
standardize that

1564
00:55:43,800 --> 00:55:46,140
um I don't know if folks are familiar

1565
00:55:46,140 --> 00:55:48,180
there's a new RFC one of those requests

1566
00:55:48,180 --> 00:55:50,460
for comments standards thoughts uh for

1567
00:55:50,460 --> 00:55:53,480
security.txt it's a lot like a stupid

1568
00:55:53,480 --> 00:55:56,280
robots.text or a DOT well-known uh

1569
00:55:56,280 --> 00:55:58,200
standard location on websites where you

1570
00:55:58,200 --> 00:55:59,760
might be able to say if you find a

1571
00:55:59,760 --> 00:56:01,200
vulnerability in any of our product

1572
00:56:01,200 --> 00:56:03,300
services or what have you contact us

1573
00:56:03,300 --> 00:56:04,079
here

1574
00:56:04,079 --> 00:56:06,119
and it's so easy to find and so easy to

1575
00:56:06,119 --> 00:56:09,540
get to because it's security.txt and and

1576
00:56:09,540 --> 00:56:12,180
that that's how you can go it would

1577
00:56:12,180 --> 00:56:13,740
really really be a big advocate for that

1578
00:56:13,740 --> 00:56:14,940
if I may

1579
00:56:14,940 --> 00:56:16,859
um but yes a thousand percent I don't

1580
00:56:16,859 --> 00:56:18,480
want to be uh beating a dead horse here

1581
00:56:18,480 --> 00:56:20,640
but I agree and I hope we can kind of

1582
00:56:20,640 --> 00:56:23,099
keep getting more on that good fight

1583
00:56:23,099 --> 00:56:25,700
ladder question I'm sorry what about

1584
00:56:25,700 --> 00:56:27,960
trying to block the best that we can

1585
00:56:27,960 --> 00:56:29,579
whether that's some weird geofencing

1586
00:56:29,579 --> 00:56:31,200
whether that's some hey adding some list

1587
00:56:31,200 --> 00:56:33,540
of the Deni list Etc

1588
00:56:33,540 --> 00:56:34,619
um

1589
00:56:34,619 --> 00:56:37,140
if I may there are I think is a certain

1590
00:56:37,140 --> 00:56:40,440
new trend that has a certain asterisk

1591
00:56:40,440 --> 00:56:42,300
and disclaimers and footnotes of a whole

1592
00:56:42,300 --> 00:56:45,359
zero trust buzzword I said the bad word

1593
00:56:45,359 --> 00:56:46,260
um

1594
00:56:46,260 --> 00:56:48,000
I feel like that's really really really

1595
00:56:48,000 --> 00:56:50,579
hard to do in in practice

1596
00:56:50,579 --> 00:56:53,099
um I know from the user experience and

1597
00:56:53,099 --> 00:56:55,020
from the administrative burden of having

1598
00:56:55,020 --> 00:56:57,960
everything and this boiling down zero

1599
00:56:57,960 --> 00:57:00,119
drust into a more digestible thing like

1600
00:57:00,119 --> 00:57:02,579
let's say if we took security and we

1601
00:57:02,579 --> 00:57:05,040
said deny everything don't let anything

1602
00:57:05,040 --> 00:57:06,900
happen ever

1603
00:57:06,900 --> 00:57:10,140
unless I said so allow by exception

1604
00:57:10,140 --> 00:57:12,359
sounds awesome sounds really good and I

1605
00:57:12,359 --> 00:57:14,640
agree that is a cool security concept

1606
00:57:14,640 --> 00:57:16,680
and that's what it is I think we do that

1607
00:57:16,680 --> 00:57:18,660
the right way already with

1608
00:57:18,660 --> 00:57:20,760
access controls and network segregations

1609
00:57:20,760 --> 00:57:22,079
and the same stuff we've been screaming

1610
00:57:22,079 --> 00:57:24,540
about for decades the new Marketing

1611
00:57:24,540 --> 00:57:26,280
sales term makes it a little bit tough

1612
00:57:26,280 --> 00:57:28,020
to distill that

1613
00:57:28,020 --> 00:57:30,839
but I'm understanding that it is very

1614
00:57:30,839 --> 00:57:33,720
very hard to actually Implement that and

1615
00:57:33,720 --> 00:57:34,619
when you

1616
00:57:34,619 --> 00:57:37,500
falter in one way or the other

1617
00:57:37,500 --> 00:57:39,540
the whole castle comes crumbled down

1618
00:57:39,540 --> 00:57:42,420
there's a little social engineering play

1619
00:57:42,420 --> 00:57:46,260
that I do say you have a application

1620
00:57:46,260 --> 00:57:47,760
you're a threat actor you're a hacker

1621
00:57:47,760 --> 00:57:49,619
and you're just trying to deceive and

1622
00:57:49,619 --> 00:57:52,920
fool the victim you decorate and you

1623
00:57:52,920 --> 00:57:55,500
manipulate uh you create your program

1624
00:57:55,500 --> 00:57:58,680
with the Google Chrome icon

1625
00:57:58,680 --> 00:58:00,599
so that when it fires and runs up on the

1626
00:58:00,599 --> 00:58:02,940
victim computer you have a little pop-up

1627
00:58:02,940 --> 00:58:04,440
alert thing in the bottom right of their

1628
00:58:04,440 --> 00:58:06,300
computer screen that says Hey Google

1629
00:58:06,300 --> 00:58:08,339
Chrome would like to run will you allow

1630
00:58:08,339 --> 00:58:10,440
add this program to your allow list or

1631
00:58:10,440 --> 00:58:12,119
deny its execution

1632
00:58:12,119 --> 00:58:13,500
and you think well it just looks like

1633
00:58:13,500 --> 00:58:16,920
Google Chrome I'm good just go run turns

1634
00:58:16,920 --> 00:58:19,319
out hey the stupid Sans font that

1635
00:58:19,319 --> 00:58:21,180
Windows displays it in it wasn't Google

1636
00:58:21,180 --> 00:58:23,760
Chrome it was a capital I it wasn't the

1637
00:58:23,760 --> 00:58:25,559
real letter L it was like googie Chrome

1638
00:58:25,559 --> 00:58:28,740
or some weird stupid typo but

1639
00:58:28,740 --> 00:58:30,380
now what

1640
00:58:30,380 --> 00:58:34,619
you or user or any person has willingly

1641
00:58:34,619 --> 00:58:36,599
allowed that malware that ransomware

1642
00:58:36,599 --> 00:58:39,420
that crypto Miner to run the onus is now

1643
00:58:39,420 --> 00:58:41,700
on you which might be harder for some

1644
00:58:41,700 --> 00:58:44,040
conversations with contracts and formal

1645
00:58:44,040 --> 00:58:46,020
papers uh and that's kind of weird to

1646
00:58:46,020 --> 00:58:47,940
draw that line so

1647
00:58:47,940 --> 00:58:50,400
threat actors hackers understanding look

1648
00:58:50,400 --> 00:58:53,339
allowless denialists they all exist

1649
00:58:53,339 --> 00:58:55,619
when the threat actor says I don't need

1650
00:58:55,619 --> 00:58:58,079
to break the entire technology I don't

1651
00:58:58,079 --> 00:59:00,960
need to I don't need to break zero trust

1652
00:59:00,960 --> 00:59:03,780
I just need to break the implementation

1653
00:59:03,780 --> 00:59:05,819
how have these

1654
00:59:05,819 --> 00:59:07,079
people

1655
00:59:07,079 --> 00:59:08,760
managers system administrators Network

1656
00:59:08,760 --> 00:59:11,299
Engineers developers how the people

1657
00:59:11,299 --> 00:59:13,680
misconfigured it or made a mistake uh

1658
00:59:13,680 --> 00:59:15,540
that's what they're going to hunt down

1659
00:59:15,540 --> 00:59:16,740
I don't know if that answered your

1660
00:59:16,740 --> 00:59:18,599
question at all

1661
00:59:18,599 --> 00:59:21,599
cool

1662
00:59:24,720 --> 00:59:26,819
yeah

1663
00:59:26,819 --> 00:59:28,859
yeah I gotta pull up Showdown see uh see

1664
00:59:28,859 --> 00:59:31,220
how we're looking

1665
00:59:32,760 --> 00:59:36,299
oh is it working okay so my question is

1666
00:59:36,299 --> 00:59:39,299
when you went to develop the EK

1667
00:59:39,299 --> 00:59:41,940
you said you wrote The Python code in

1668
00:59:41,940 --> 00:59:44,579
Python obviously so Pi odbc would be

1669
00:59:44,579 --> 00:59:47,220
native for python what made you lean

1670
00:59:47,220 --> 00:59:50,400
towards jdbc over peyote BC

1671
00:59:50,400 --> 00:59:52,500
um in relation to developing the EK was

1672
00:59:52,500 --> 00:59:54,780
that because Java is typically the Swiss

1673
00:59:54,780 --> 00:59:57,000
cheese for security

1674
00:59:57,000 --> 01:00:00,540
uh yes with the short answer uh

1675
01:00:00,540 --> 01:00:03,000
knee-jerk reaction is I want to know

1676
01:00:03,000 --> 01:00:04,619
what will work I know I want to know

1677
01:00:04,619 --> 01:00:06,839
what will fit in the environment uh so

1678
01:00:06,839 --> 01:00:09,180
again when we're sort of operating at

1679
01:00:09,180 --> 01:00:11,099
the edge of our understanding and like

1680
01:00:11,099 --> 01:00:13,859
this is new Uncharted Territory I am I'm

1681
01:00:13,859 --> 01:00:16,200
truthfully and I'm okay with grasping

1682
01:00:16,200 --> 01:00:19,200
for has anyone else done this research

1683
01:00:19,200 --> 01:00:21,180
I'm going to come to that like the same

1684
01:00:21,180 --> 01:00:22,740
way I reached out to fricos hey I'm

1685
01:00:22,740 --> 01:00:25,319
really sorry can can you help

1686
01:00:25,319 --> 01:00:27,660
but that's I think part of it I think

1687
01:00:27,660 --> 01:00:28,980
that's part of us all growing I think

1688
01:00:28,980 --> 01:00:30,480
that's all part of us learning whether I

1689
01:00:30,480 --> 01:00:31,740
could have cranked it out in Python I

1690
01:00:31,740 --> 01:00:33,180
could have done rust or golang I could

1691
01:00:33,180 --> 01:00:35,760
have been I could have been hip but I

1692
01:00:35,760 --> 01:00:38,460
wanted to do what worked so

1693
01:00:38,460 --> 01:00:39,900
foreign

1694
01:00:39,900 --> 01:00:42,660
I had a quick question about I was

1695
01:00:42,660 --> 01:00:43,559
wondering if you can provide more

1696
01:00:43,559 --> 01:00:45,240
context on security research in general

1697
01:00:45,240 --> 01:00:46,680
you said

1698
01:00:46,680 --> 01:00:48,000
um kind of encouraging people to look

1699
01:00:48,000 --> 01:00:51,240
for larger Downstream impacts of

1700
01:00:51,240 --> 01:00:53,880
monitoring software how does that kind

1701
01:00:53,880 --> 01:00:55,980
of play a role into your target

1702
01:00:55,980 --> 01:00:58,680
selection do you look for software where

1703
01:00:58,680 --> 01:01:00,480
the downstream impact might be greater

1704
01:01:00,480 --> 01:01:02,579
do you look for projects where a lot of

1705
01:01:02,579 --> 01:01:03,839
people might have been working with the

1706
01:01:03,839 --> 01:01:05,460
software in general as a security

1707
01:01:05,460 --> 01:01:07,799
researcher how does things like that

1708
01:01:07,799 --> 01:01:10,079
kind of play into your methodology

1709
01:01:10,079 --> 01:01:12,119
super good question

1710
01:01:12,119 --> 01:01:14,819
um sort of hey where do you go to hunt

1711
01:01:14,819 --> 01:01:16,740
and how do you how do you go find what

1712
01:01:16,740 --> 01:01:18,480
you're looking for et cetera what do you

1713
01:01:18,480 --> 01:01:20,040
choose in that regard really really

1714
01:01:20,040 --> 01:01:22,559
weird uh and like you you get to ask

1715
01:01:22,559 --> 01:01:24,540
that question to yourself

1716
01:01:24,540 --> 01:01:26,819
um because I'm understanding of look hey

1717
01:01:26,819 --> 01:01:29,700
people like to do hacking and cyber

1718
01:01:29,700 --> 01:01:31,440
security because it's very sexy because

1719
01:01:31,440 --> 01:01:32,700
you can put it out on the internet and

1720
01:01:32,700 --> 01:01:35,280
he's like wow look I'm the lead hacker

1721
01:01:35,280 --> 01:01:36,780
um and there's a certain amount of clout

1722
01:01:36,780 --> 01:01:38,280
to that like I'm not gonna lie I'm not

1723
01:01:38,280 --> 01:01:39,720
going to turn that down

1724
01:01:39,720 --> 01:01:42,780
um with that said I look up to the folks

1725
01:01:42,780 --> 01:01:45,299
that are cranking out windows kernel

1726
01:01:45,299 --> 01:01:48,059
local privilege escalation zero days

1727
01:01:48,059 --> 01:01:49,619
um understanding like look that's above

1728
01:01:49,619 --> 01:01:51,780
my head and I and I want to try to bring

1729
01:01:51,780 --> 01:01:53,460
an impact toward stuff that I can help

1730
01:01:53,460 --> 01:01:56,220
with and that I'd know uh and I'll be

1731
01:01:56,220 --> 01:01:57,599
the first to admit sometimes that means

1732
01:01:57,599 --> 01:01:58,579
scraping the bottom of the barrel

1733
01:01:58,579 --> 01:02:01,319
sometimes that means looking at these

1734
01:02:01,319 --> 01:02:05,220
old deprecated end-of-life unpatched

1735
01:02:05,220 --> 01:02:08,099
stuff that hey maybe has been code that

1736
01:02:08,099 --> 01:02:10,980
some vendor wrote 20 years ago but it's

1737
01:02:10,980 --> 01:02:13,079
still being used

1738
01:02:13,079 --> 01:02:14,339
um and I

1739
01:02:14,339 --> 01:02:18,420
I I have to say the

1740
01:02:18,420 --> 01:02:20,880
managed service provider Community could

1741
01:02:20,880 --> 01:02:23,460
use some love right I think there's

1742
01:02:23,460 --> 01:02:24,900
always room for improvement especially

1743
01:02:24,900 --> 01:02:28,260
everywhere and everyone but uh we all I

1744
01:02:28,260 --> 01:02:29,760
think a lot of times the traditional

1745
01:02:29,760 --> 01:02:31,799
quote-unquote infosec and the cookie

1746
01:02:31,799 --> 01:02:34,380
cutter Defcon black hat whatever uh we

1747
01:02:34,380 --> 01:02:35,880
always looked as msps as like the wild

1748
01:02:35,880 --> 01:02:37,260
west

1749
01:02:37,260 --> 01:02:40,020
um but there is so much more need and

1750
01:02:40,020 --> 01:02:42,000
necessity there and their tooling and

1751
01:02:42,000 --> 01:02:43,200
what they need to fix and what we can

1752
01:02:43,200 --> 01:02:44,339
fix there

1753
01:02:44,339 --> 01:02:48,900
because that is genuinely the 99 that is

1754
01:02:48,900 --> 01:02:51,059
literally what a whole of our businesses

1755
01:02:51,059 --> 01:02:54,240
um and economies built on so I I think

1756
01:02:54,240 --> 01:02:55,859
there is a lot of impact and a lot of

1757
01:02:55,859 --> 01:02:57,720
fulfillment which might be greater than

1758
01:02:57,720 --> 01:02:59,940
the sexy clout or lucrative finance that

1759
01:02:59,940 --> 01:03:01,619
comes from security research

1760
01:03:01,619 --> 01:03:04,200
just making the difference for the right

1761
01:03:04,200 --> 01:03:06,540
reasons can be in those areas that need

1762
01:03:06,540 --> 01:03:08,960
it the most

1763
01:03:11,520 --> 01:03:14,040
hey John uh thanks a very cool

1764
01:03:14,040 --> 01:03:15,599
presentation and it's cool to see behind

1765
01:03:15,599 --> 01:03:17,880
the curtain how it all works

1766
01:03:17,880 --> 01:03:19,680
um you mentioned kind of responsible

1767
01:03:19,680 --> 01:03:22,680
disclosure bug Bounty kind of you must

1768
01:03:22,680 --> 01:03:24,059
interact with a lot of different

1769
01:03:24,059 --> 01:03:26,940
companies different approaches and I saw

1770
01:03:26,940 --> 01:03:29,460
when you you flashed out the NDA it

1771
01:03:29,460 --> 01:03:30,900
seemed like you had a slight reaction to

1772
01:03:30,900 --> 01:03:32,160
that

1773
01:03:32,160 --> 01:03:34,559
um you obviously observing like a level

1774
01:03:34,559 --> 01:03:37,500
of confidentiality you kind of kept you

1775
01:03:37,500 --> 01:03:39,660
know writing the information kind of uh

1776
01:03:39,660 --> 01:03:42,780
the key components of it didn't disclose

1777
01:03:42,780 --> 01:03:44,940
that publicly but are there any kind of

1778
01:03:44,940 --> 01:03:47,220
practices what advising companies like

1779
01:03:47,220 --> 01:03:49,200
ourselves who we're having to enforce

1780
01:03:49,200 --> 01:03:51,660
our own kind of policies on this stuff

1781
01:03:51,660 --> 01:03:53,099
what would you say they're like the best

1782
01:03:53,099 --> 01:03:54,540
practice what do you like to see as a

1783
01:03:54,540 --> 01:03:56,280
researcher like what is an impediment to

1784
01:03:56,280 --> 01:03:58,319
you doing your job what is actually good

1785
01:03:58,319 --> 01:04:00,420
practice for for the for the purposes of

1786
01:04:00,420 --> 01:04:02,880
like responsible disclosure

1787
01:04:02,880 --> 01:04:05,400
super good question hey uh what are some

1788
01:04:05,400 --> 01:04:07,079
of those best practices or things that

1789
01:04:07,079 --> 01:04:10,500
we love to see or or help

1790
01:04:10,500 --> 01:04:11,760
um when there's something that we're a

1791
01:04:11,760 --> 01:04:13,020
little bit embarrassed to bring to the

1792
01:04:13,020 --> 01:04:15,180
table of hey there's a new vulnerability

1793
01:04:15,180 --> 01:04:18,420
or hey we had some problem uh if I may

1794
01:04:18,420 --> 01:04:20,819
and I realize again kind of tough pill

1795
01:04:20,819 --> 01:04:22,980
to swallow the absolute greatest thing

1796
01:04:22,980 --> 01:04:26,819
that you can do is have that absolute

1797
01:04:26,819 --> 01:04:29,099
honesty and transparency

1798
01:04:29,099 --> 01:04:31,740
um I can if I may I'll get into it look

1799
01:04:31,740 --> 01:04:34,260
look I Huntress vendor and not not

1800
01:04:34,260 --> 01:04:36,839
trying to point towards or do some silly

1801
01:04:36,839 --> 01:04:39,960
commercial by any means we got popped

1802
01:04:39,960 --> 01:04:41,280
one day hey we had our own security

1803
01:04:41,280 --> 01:04:43,380
incident we had everyone has their own

1804
01:04:43,380 --> 01:04:48,180
oops and blemish and mistake uh

1805
01:04:48,180 --> 01:04:49,619
but we sort of had to hold each other

1806
01:04:49,619 --> 01:04:51,119
accountable the same way that we want to

1807
01:04:51,119 --> 01:04:52,799
hold other security vendors accountable

1808
01:04:52,799 --> 01:04:54,480
that we say like look we had some stupid

1809
01:04:54,480 --> 01:04:57,540
temporary ephemeral AWS instance that

1810
01:04:57,540 --> 01:04:59,280
left RDP open because it was just like

1811
01:04:59,280 --> 01:05:00,960
some default Security Group and there

1812
01:05:00,960 --> 01:05:03,540
was some stupid password like abc123

1813
01:05:03,540 --> 01:05:06,180
literally the like top 10 lines of rock

1814
01:05:06,180 --> 01:05:07,260
UDOT text

1815
01:05:07,260 --> 01:05:11,040
that sucks that's really embarrassing

1816
01:05:11,040 --> 01:05:11,700
um

1817
01:05:11,700 --> 01:05:15,480
but those raw gory details are I think

1818
01:05:15,480 --> 01:05:18,119
really uh something that can be

1819
01:05:18,119 --> 01:05:20,460
commendable because you're willing to

1820
01:05:20,460 --> 01:05:22,079
say that and say like look okay we've

1821
01:05:22,079 --> 01:05:24,119
dropped the ball but now this is what

1822
01:05:24,119 --> 01:05:25,799
we're doing to fix it this is the impact

1823
01:05:25,799 --> 01:05:28,260
we've contained it the best that we can

1824
01:05:28,260 --> 01:05:29,880
um

1825
01:05:29,880 --> 01:05:31,920
I'm scrambling here on the screeching

1826
01:05:31,920 --> 01:05:33,839
for straws but I do think at the end of

1827
01:05:33,839 --> 01:05:36,119
the day it is just the transparency and

1828
01:05:36,119 --> 01:05:38,880
honesty fall on your sword uh as tough

1829
01:05:38,880 --> 01:05:41,640
it might be to say sometimes

1830
01:05:41,640 --> 01:05:45,540
one more okay I have a question

1831
01:05:45,540 --> 01:05:47,880
um we talk about people processes and

1832
01:05:47,880 --> 01:05:49,920
technology in terms of cyber security

1833
01:05:49,920 --> 01:05:51,540
posture

1834
01:05:51,540 --> 01:05:53,220
um what you showed us earlier was

1835
01:05:53,220 --> 01:05:54,660
obviously a vulnerability in the

1836
01:05:54,660 --> 01:05:57,000
technology but within the supply chain

1837
01:05:57,000 --> 01:05:59,640
so thinking about the platforms

1838
01:05:59,640 --> 01:06:02,119
leveraged by managed service providers

1839
01:06:02,119 --> 01:06:04,339
we've got

1840
01:06:04,339 --> 01:06:07,319
connectwise cassaya solarwinds there's

1841
01:06:07,319 --> 01:06:09,119
different tools out there almost every

1842
01:06:09,119 --> 01:06:11,819
managed service provider leverages a

1843
01:06:11,819 --> 01:06:13,799
platform like that

1844
01:06:13,799 --> 01:06:15,780
um so we think we think about the

1845
01:06:15,780 --> 01:06:18,660
industry in in the third party risk the

1846
01:06:18,660 --> 01:06:21,240
organizations have by engaging managed

1847
01:06:21,240 --> 01:06:22,559
service providers

1848
01:06:22,559 --> 01:06:24,780
what are your recommendations for the

1849
01:06:24,780 --> 01:06:27,059
potential customer and how they consider

1850
01:06:27,059 --> 01:06:29,400
a value a managed service provider and

1851
01:06:29,400 --> 01:06:30,960
what can manage service providers do

1852
01:06:30,960 --> 01:06:31,980
better

1853
01:06:31,980 --> 01:06:35,520
super good question hey uh how do you

1854
01:06:35,520 --> 01:06:37,380
understanding that there is a real need

1855
01:06:37,380 --> 01:06:40,380
to have someone help and Outsource

1856
01:06:40,380 --> 01:06:41,700
whether you're working with a managed

1857
01:06:41,700 --> 01:06:43,380
service provider and specifically in

1858
01:06:43,380 --> 01:06:45,500
that case how do you

1859
01:06:45,500 --> 01:06:48,599
I if I may I think the first thing is to

1860
01:06:48,599 --> 01:06:52,079
just genuinely vet the vendor the new

1861
01:06:52,079 --> 01:06:53,280
third party someone that you're trying

1862
01:06:53,280 --> 01:06:54,960
to get to work with something that

1863
01:06:54,960 --> 01:06:56,579
you're adding to your stack one way or

1864
01:06:56,579 --> 01:06:58,619
the other uh ask those hard questions

1865
01:06:58,619 --> 01:07:00,780
when was your last security audit hey

1866
01:07:00,780 --> 01:07:03,359
have you been doing some reviews of your

1867
01:07:03,359 --> 01:07:06,359
application hey do you have a software

1868
01:07:06,359 --> 01:07:08,460
bill of materials look that's a can of

1869
01:07:08,460 --> 01:07:09,720
worms I know that's a whole other thing

1870
01:07:09,720 --> 01:07:11,099
to dig into and I won't touch that hot

1871
01:07:11,099 --> 01:07:14,700
stove but s-bomb real thing

1872
01:07:14,700 --> 01:07:17,160
when log4j hit the streets it would have

1873
01:07:17,160 --> 01:07:18,720
been really really nice to know if my

1874
01:07:18,720 --> 01:07:19,980
vendor actually had that vulnerable

1875
01:07:19,980 --> 01:07:22,260
version as part of their ingredients

1876
01:07:22,260 --> 01:07:24,599
list on the recipe when you have vendors

1877
01:07:24,599 --> 01:07:26,280
come out of the woodwork one month two

1878
01:07:26,280 --> 01:07:28,140
months three months later whoops we were

1879
01:07:28,140 --> 01:07:30,119
compromised or we're vulnerable that

1880
01:07:30,119 --> 01:07:32,579
sucks uh so it's those hard questions to

1881
01:07:32,579 --> 01:07:34,440
hold vendors accountable look have you

1882
01:07:34,440 --> 01:07:35,700
been doing some of those internal red

1883
01:07:35,700 --> 01:07:37,020
teams I don't even know if you'd go that

1884
01:07:37,020 --> 01:07:39,660
far but if you do are you willing to

1885
01:07:39,660 --> 01:07:42,299
show me like can you can you make this

1886
01:07:42,299 --> 01:07:43,799
and I don't know if that's the

1887
01:07:43,799 --> 01:07:47,220
transparency level but those hard

1888
01:07:47,220 --> 01:07:48,839
questions are absolutely the best way to

1889
01:07:48,839 --> 01:07:52,500
do it and test like test the controls

1890
01:07:52,500 --> 01:07:54,839
hey I put a new EDR in place hey I'm

1891
01:07:54,839 --> 01:07:56,460
using some rmm hey I'm going to see what

1892
01:07:56,460 --> 01:07:57,780
bells and whistles this doodad might

1893
01:07:57,780 --> 01:07:59,520
have

1894
01:07:59,520 --> 01:08:02,880
kick the tires do the weird stuff

1895
01:08:02,880 --> 01:08:04,980
and you might get a weird phone call

1896
01:08:04,980 --> 01:08:06,480
that says hey guys what are you doing

1897
01:08:06,480 --> 01:08:09,539
why are you beating up our product uh

1898
01:08:09,539 --> 01:08:11,280
it's you can come to them and tell them

1899
01:08:11,280 --> 01:08:13,920
like we we want to make sure that we are

1900
01:08:13,920 --> 01:08:16,439
confident in you to provide security for

1901
01:08:16,439 --> 01:08:17,219
us

1902
01:08:17,219 --> 01:08:19,020
for the next year for the next three

1903
01:08:19,020 --> 01:08:20,698
years however long our stupid contract

1904
01:08:20,698 --> 01:08:23,819
might be uh that is that is how you can

1905
01:08:23,819 --> 01:08:26,520
kind of hold folks accountable if in my

1906
01:08:26,520 --> 01:08:28,819
opinion

1907
01:08:33,060 --> 01:08:36,000
cool crickets I think

1908
01:08:36,000 --> 01:08:37,620
thanks so much everyone this is a lot of

1909
01:08:37,620 --> 01:08:40,219
fun thank you

