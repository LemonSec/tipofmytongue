1
00:00:00,030 --> 00:00:03,720
Thanks well good afternoon test tests

2
00:00:03,720 --> 00:00:05,130
immunise of just a second here hang on

3
00:00:05,130 --> 00:00:07,140
sorry for everybody that I'm scratching

4
00:00:07,140 --> 00:00:09,000
on the wife sir

5
00:00:09,000 --> 00:00:11,429
good all right thank you all for coming

6
00:00:11,429 --> 00:00:13,440
to this afternoon to hear me talk about

7
00:00:13,440 --> 00:00:15,630
the five things that matter this talk

8
00:00:15,630 --> 00:00:17,490
for me is an important one because it's

9
00:00:17,490 --> 00:00:19,020
the five things that I typically see in

10
00:00:19,020 --> 00:00:20,369
most security programs where we have a

11
00:00:20,369 --> 00:00:22,380
lot of problems with and with my talks I

12
00:00:22,380 --> 00:00:24,600
like to keep them fairly high level and

13
00:00:24,600 --> 00:00:26,250
also super technical as well and balance

14
00:00:26,250 --> 00:00:28,320
both of those so I'll give you some nice

15
00:00:28,320 --> 00:00:29,640
bypass techniques for Windows Defender

16
00:00:29,640 --> 00:00:31,410
some other things throughout the talk

17
00:00:31,410 --> 00:00:33,570
and everything else but really this talk

18
00:00:33,570 --> 00:00:35,280
kind of hits home to me because it's one

19
00:00:35,280 --> 00:00:36,600
of the things where when we go into a

20
00:00:36,600 --> 00:00:38,190
lot of companies we see a lot of

21
00:00:38,190 --> 00:00:38,899
different things

22
00:00:38,899 --> 00:00:40,950
appreciate the background it's been fun

23
00:00:40,950 --> 00:00:43,079
being in the cybersecurity space it's

24
00:00:43,079 --> 00:00:44,910
interesting I my dad just recently

25
00:00:44,910 --> 00:00:46,860
twittered I says my dad got to it it's

26
00:00:46,860 --> 00:00:49,950
been a literally interesting actually so

27
00:00:49,950 --> 00:00:51,030
I know a lot more about him that I

28
00:00:51,030 --> 00:00:52,620
thought I would ever know about my dad

29
00:00:52,620 --> 00:00:56,610
and and so one thing he did recently is

30
00:00:56,610 --> 00:00:59,370
a few years ago he spoke at derbycon and

31
00:00:59,370 --> 00:01:02,129
he let the whole world know that I was

32
00:01:02,129 --> 00:01:03,930
scared of clowns and it has not stopped

33
00:01:03,930 --> 00:01:07,200
since I get people sending me clowns all

34
00:01:07,200 --> 00:01:09,180
day every day there's people threatening

35
00:01:09,180 --> 00:01:10,530
to hire clowns to come to the office

36
00:01:10,530 --> 00:01:13,080
like it's it's been a whole bunch thing

37
00:01:13,080 --> 00:01:14,939
but recently he just he just released my

38
00:01:14,939 --> 00:01:17,250
my report card from when I was a senior

39
00:01:17,250 --> 00:01:18,810
in high school which I had all apps

40
00:01:18,810 --> 00:01:22,670
except had 1b and was in typing and

41
00:01:22,670 --> 00:01:24,689
other then I filled out a high school

42
00:01:24,689 --> 00:01:26,610
and I graduated in summer school to go

43
00:01:26,610 --> 00:01:28,080
there and ice shortly join the Marines

44
00:01:28,080 --> 00:01:29,640
after that but it's been a great ride we

45
00:01:29,640 --> 00:01:31,170
never thought being able to talk in

46
00:01:31,170 --> 00:01:32,579
front of people was a thing or being

47
00:01:32,579 --> 00:01:33,900
able to do computers for a living was a

48
00:01:33,900 --> 00:01:35,340
thing so it's been a really awesome

49
00:01:35,340 --> 00:01:36,900
experience and I've gotten a lot of

50
00:01:36,900 --> 00:01:39,329
great things to do for it so with that

51
00:01:39,329 --> 00:01:40,710
I'm gonna show you a quick video and

52
00:01:40,710 --> 00:01:42,420
this is one of my favorite things in

53
00:01:42,420 --> 00:01:44,100
life that I got I got actually got to be

54
00:01:44,100 --> 00:01:45,990
a part of kind of kind of I'm part of

55
00:01:45,990 --> 00:01:48,869
this segment but this is from mr. robot

56
00:01:48,869 --> 00:01:52,110
and in season 3 Elliott is basically

57
00:01:52,110 --> 00:01:53,729
getting fired from evil Corp and he's

58
00:01:53,729 --> 00:01:56,159
trying to evade the security guy folks

59
00:01:56,159 --> 00:01:58,290
so that he can stop the dark army from

60
00:01:58,290 --> 00:02:00,030
actually taking down evil Corp and so

61
00:02:00,030 --> 00:02:02,369
Elliott is basically trying to evade

62
00:02:02,369 --> 00:02:03,810
security and get around him you know

63
00:02:03,810 --> 00:02:05,369
here I'm throw a little little thing in

64
00:02:05,369 --> 00:02:07,290
here that I thought was really cool it's

65
00:02:07,290 --> 00:02:08,878
kind of cool when that they dropped her

66
00:02:08,878 --> 00:02:10,530
name on a TV show that even worked with

67
00:02:10,530 --> 00:02:10,960
and helped

68
00:02:10,960 --> 00:02:12,430
and it's because I throughout this

69
00:02:12,430 --> 00:02:14,440
series and he look at the screens and in

70
00:02:14,440 --> 00:02:16,210
season 1 episode 5 when Elliott is

71
00:02:16,210 --> 00:02:18,010
hacking into steel mountain they use a

72
00:02:18,010 --> 00:02:19,660
social engineer toolkit to spoof a text

73
00:02:19,660 --> 00:02:21,070
message that allows them in the steel

74
00:02:21,070 --> 00:02:22,900
mountain and then season 3 episode 1 I

75
00:02:22,900 --> 00:02:25,240
think it was when Darlene lit the fire

76
00:02:25,240 --> 00:02:27,670
up and all the money that ran somewhere

77
00:02:27,670 --> 00:02:28,810
that they deployed they deployed through

78
00:02:28,810 --> 00:02:30,190
the social engineer toolkit so a lot of

79
00:02:30,190 --> 00:02:31,840
really neat things you get the

80
00:02:31,840 --> 00:02:32,740
experience and it really cool

81
00:02:32,740 --> 00:02:34,360
interesting up to have also been in a

82
00:02:34,360 --> 00:02:36,490
rap video never thought that would

83
00:02:36,490 --> 00:02:39,100
happen I was in a Chris Brown rap video

84
00:02:39,100 --> 00:02:41,230
and it was really interesting I flew out

85
00:02:41,230 --> 00:02:43,000
to LA and it's a really interesting

86
00:02:43,000 --> 00:02:46,240
piece where he he basically reached out

87
00:02:46,240 --> 00:02:47,650
to our website the producer did and he's

88
00:02:47,650 --> 00:02:49,630
like hey can you can you can Dave advise

89
00:02:49,630 --> 00:02:51,520
us on this this rep you didn't know who

90
00:02:51,520 --> 00:02:53,470
was at the time and I'm like the only

91
00:02:53,470 --> 00:02:55,000
restriction is that Dave needs to be in

92
00:02:55,000 --> 00:02:56,470
the hacking video and needs actually be

93
00:02:56,470 --> 00:02:57,520
in the video so there are I'm in the

94
00:02:57,520 --> 00:02:58,930
back like hacking away and the old

95
00:02:58,930 --> 00:03:01,420
premise is that Chris Brown broke up

96
00:03:01,420 --> 00:03:02,590
with his girlfriend and he wants to

97
00:03:02,590 --> 00:03:05,020
delete all the pictures off of her phone

98
00:03:05,020 --> 00:03:06,760
so he hires his best friend Dave to come

99
00:03:06,760 --> 00:03:08,050
in and delete all the photos off of

100
00:03:08,050 --> 00:03:10,690
there so I don't know this is really

101
00:03:10,690 --> 00:03:12,340
cheesy don't look it up at work by the

102
00:03:12,340 --> 00:03:13,840
way it's definitely not safe for work in

103
00:03:13,840 --> 00:03:15,700
any way shape or form but that was kind

104
00:03:15,700 --> 00:03:19,170
of a fun one too so so while we're here

105
00:03:19,170 --> 00:03:22,720
is that when we look at security we talk

106
00:03:22,720 --> 00:03:25,300
a lot about things that we that are our

107
00:03:25,300 --> 00:03:26,710
challenges right and we all have

108
00:03:26,710 --> 00:03:28,930
challenges I always like to make the the

109
00:03:28,930 --> 00:03:31,060
joke that we could fix security today

110
00:03:31,060 --> 00:03:33,310
and actually I can you can walk out here

111
00:03:33,310 --> 00:03:34,810
with the million dollar secret of fixing

112
00:03:34,810 --> 00:03:36,040
security today right now I'm gonna give

113
00:03:36,040 --> 00:03:38,140
it to you for free okay and that's if

114
00:03:38,140 --> 00:03:39,760
you have one dedicated person to

115
00:03:39,760 --> 00:03:41,470
security for every single one employee

116
00:03:41,470 --> 00:03:44,380
that you have of your organization cuz

117
00:03:44,380 --> 00:03:45,790
you can just sit behind them and be like

118
00:03:45,790 --> 00:03:46,930
not don't click that link you just

119
00:03:46,930 --> 00:03:48,490
clicked it okay hang on grab the

120
00:03:48,490 --> 00:03:50,320
computer pass over the person next to

121
00:03:50,320 --> 00:03:51,730
you they reimagine you're all set right

122
00:03:51,730 --> 00:03:54,040
security would be fixed it solves all

123
00:03:54,040 --> 00:03:56,050
the issues that we deal with today soft

124
00:03:56,050 --> 00:03:57,010
furtive on the lifecycle you have a

125
00:03:57,010 --> 00:03:58,330
security person behind there like that's

126
00:03:58,330 --> 00:03:59,710
sequel injection you can't code it that

127
00:03:59,710 --> 00:04:01,210
way code it the other way okay got it

128
00:04:01,210 --> 00:04:02,800
got okay cool you know it literally

129
00:04:02,800 --> 00:04:04,180
fixed things as we see it think we don't

130
00:04:04,180 --> 00:04:06,760
have that luxury so a lot of us fit deal

131
00:04:06,760 --> 00:04:08,020
with a lot of different things whether

132
00:04:08,020 --> 00:04:10,150
it's politics whether it's not enough

133
00:04:10,150 --> 00:04:12,040
funding or staff whether it's not having

134
00:04:12,040 --> 00:04:13,960
the the people to be able to support it

135
00:04:13,960 --> 00:04:16,060
there's a lot of things that that create

136
00:04:16,060 --> 00:04:17,440
challenges in our environment and so

137
00:04:17,440 --> 00:04:18,160
that's we're gonna be talking about

138
00:04:18,160 --> 00:04:20,470
today and still to this day I haven't

139
00:04:20,470 --> 00:04:21,820
found a piece of technologists replace

140
00:04:21,820 --> 00:04:23,740
me yet personally artificial

141
00:04:23,740 --> 00:04:24,770
intelligence has

142
00:04:24,770 --> 00:04:27,289
not replaced us as attackers or defense

143
00:04:27,289 --> 00:04:29,120
there's a lot of things coming kind of

144
00:04:29,120 --> 00:04:30,020
coming up from a marketing perspective

145
00:04:30,020 --> 00:04:32,030
that are kind of interesting so what are

146
00:04:32,030 --> 00:04:35,300
the top five things that matter to at

147
00:04:35,300 --> 00:04:37,009
least to me when it comes to scare might

148
00:04:37,009 --> 00:04:38,479
not be everybody but these are things

149
00:04:38,479 --> 00:04:40,520
that I commonly see pretty much across

150
00:04:40,520 --> 00:04:42,590
the board before we start in that the

151
00:04:42,590 --> 00:04:44,659
basics here it's easy to say that

152
00:04:44,659 --> 00:04:46,669
everything's broken and and I don't

153
00:04:46,669 --> 00:04:48,110
think everything is broken in fact what

154
00:04:48,110 --> 00:04:50,000
I would say is that over the past ten

155
00:04:50,000 --> 00:04:51,710
years I've seen security go through a

156
00:04:51,710 --> 00:04:53,120
complete transformation where we've

157
00:04:53,120 --> 00:04:55,610
gotten better we're at a place now where

158
00:04:55,610 --> 00:04:57,440
you actually see defenders winning

159
00:04:57,440 --> 00:04:59,539
against the red team yeah we're at a

160
00:04:59,539 --> 00:05:00,620
time now where people are actually

161
00:05:00,620 --> 00:05:02,330
detecting attacks earlier on now it's

162
00:05:02,330 --> 00:05:04,460
not perfect in any way shape or form and

163
00:05:04,460 --> 00:05:05,569
I see something like Starwood and

164
00:05:05,569 --> 00:05:06,800
Marriott right where they had breaches

165
00:05:06,800 --> 00:05:07,729
for three or four years without

166
00:05:07,729 --> 00:05:10,069
detection again not perfect in any way

167
00:05:10,069 --> 00:05:11,389
but we're getting better in a lot of

168
00:05:11,389 --> 00:05:12,500
cases that we're doing and I cannot say

169
00:05:12,500 --> 00:05:13,490
say being a red teamer

170
00:05:13,490 --> 00:05:15,530
and I'll talk about what that actual

171
00:05:15,530 --> 00:05:17,300
concept means because that's changed a

172
00:05:17,300 --> 00:05:19,219
lot over the past ten years but actually

173
00:05:19,219 --> 00:05:20,300
being a red teamer I can say it's

174
00:05:20,300 --> 00:05:21,469
substantially harder for me to break

175
00:05:21,469 --> 00:05:24,050
into companies substantially harder one

176
00:05:24,050 --> 00:05:26,240
little thing can totally set off an

177
00:05:26,240 --> 00:05:28,460
analyst and go into triage mode to

178
00:05:28,460 --> 00:05:29,300
figure out what was actually happening

179
00:05:29,300 --> 00:05:31,669
one of our testers recently was doing a

180
00:05:31,669 --> 00:05:33,860
was doing a red team engagement and we

181
00:05:33,860 --> 00:05:35,690
use so we use we have our own research

182
00:05:35,690 --> 00:05:37,699
and development team over a trusted SEC

183
00:05:37,699 --> 00:05:38,960
and they develop all those cool

184
00:05:38,960 --> 00:05:40,400
weaponize tools that we use we don't

185
00:05:40,400 --> 00:05:41,750
disclose when you just use them for our

186
00:05:41,750 --> 00:05:42,889
customers for them to get better than

187
00:05:42,889 --> 00:05:44,270
anything else and it might be a debate

188
00:05:44,270 --> 00:05:46,340
about that or whatever I understand but

189
00:05:46,340 --> 00:05:48,259
we use this awesome amazing thing on

190
00:05:48,259 --> 00:05:49,940
this customer for Red Team got into

191
00:05:49,940 --> 00:05:51,440
environment bypassed all their EDR

192
00:05:51,440 --> 00:05:52,759
products got command and control

193
00:05:52,759 --> 00:05:54,770
infrastructure completely undetected

194
00:05:54,770 --> 00:05:57,169
it's perfect use a bunch of undocumented

195
00:05:57,169 --> 00:05:58,159
ways of getting a remote code execution

196
00:05:58,159 --> 00:06:00,050
on to the system things that haven't

197
00:06:00,050 --> 00:06:01,639
been discovered yet flew completely

198
00:06:01,639 --> 00:06:03,199
under the radar right and he might be

199
00:06:03,199 --> 00:06:04,370
like well why are you doing that first

200
00:06:04,370 --> 00:06:05,659
place all explained in just a second

201
00:06:05,659 --> 00:06:08,120
what was interesting is is about four

202
00:06:08,120 --> 00:06:11,840
minutes later we got detected four

203
00:06:11,840 --> 00:06:14,270
minutes using some really amazing

204
00:06:14,270 --> 00:06:14,900
tradecraft

205
00:06:14,900 --> 00:06:16,849
that we had spent years of developing

206
00:06:16,849 --> 00:06:19,099
and we got detected in four minutes how

207
00:06:19,099 --> 00:06:21,770
did we get detected well what they had

208
00:06:21,770 --> 00:06:22,849
done in their environment which I

209
00:06:22,849 --> 00:06:24,650
thought was really unique is that they

210
00:06:24,650 --> 00:06:26,979
baseline people on two categories

211
00:06:26,979 --> 00:06:30,110
technical and non-technical and what

212
00:06:30,110 --> 00:06:31,699
they look for is anybody that would run

213
00:06:31,699 --> 00:06:33,469
command line arguments in this specific

214
00:06:33,469 --> 00:06:35,930
case we you looked at IP config to see

215
00:06:35,930 --> 00:06:37,460
what the network we were on harmless

216
00:06:37,460 --> 00:06:38,240
obvious

217
00:06:38,240 --> 00:06:40,160
it's not code execution in which shape

218
00:06:40,160 --> 00:06:42,110
or form but this person fell in a non

219
00:06:42,110 --> 00:06:44,919
technical category and typed in ipconfig

220
00:06:44,919 --> 00:06:48,380
boom nail right it's stuff like that

221
00:06:48,380 --> 00:06:51,229
that makes it really challenging for us

222
00:06:51,229 --> 00:06:53,030
as attackers to start to go into

223
00:06:53,030 --> 00:06:54,740
environments we don't know where all the

224
00:06:54,740 --> 00:06:56,840
landmines are at and that was never the

225
00:06:56,840 --> 00:06:58,610
way five years ago by the way five years

226
00:06:58,610 --> 00:07:00,380
ago we can go in with Metasploit or on

227
00:07:00,380 --> 00:07:02,449
otto pone destroy a bunch of systems the

228
00:07:02,449 --> 00:07:03,410
only way they would know is if the

229
00:07:03,410 --> 00:07:05,120
system crashed right

230
00:07:05,120 --> 00:07:07,400
things have changed substantially over

231
00:07:07,400 --> 00:07:09,020
the past five to ten years to where we

232
00:07:09,020 --> 00:07:10,610
are a better industry and it's amazing

233
00:07:10,610 --> 00:07:12,199
to see all of the work that's gone into

234
00:07:12,199 --> 00:07:13,759
making that possible that's all to

235
00:07:13,759 --> 00:07:15,680
people that's all those other people in

236
00:07:15,680 --> 00:07:17,570
this room sitting here today making and

237
00:07:17,570 --> 00:07:19,160
making your organization's better every

238
00:07:19,160 --> 00:07:20,240
time of what you're doing and that's a

239
00:07:20,240 --> 00:07:21,770
huge testament to what we're starting to

240
00:07:21,770 --> 00:07:23,509
see so what are some of the things that

241
00:07:23,509 --> 00:07:26,599
we see out there number one the basics

242
00:07:26,599 --> 00:07:28,789
the basics still kick our butts today

243
00:07:28,789 --> 00:07:31,070
you know we want to stop adversaries

244
00:07:31,070 --> 00:07:33,110
from breaking in using zero day exploits

245
00:07:33,110 --> 00:07:34,699
and we still have password one as our

246
00:07:34,699 --> 00:07:36,050
main password for all of our users right

247
00:07:36,050 --> 00:07:38,569
and that's a people problem right and in

248
00:07:38,569 --> 00:07:39,830
many cases there's a lot of things that

249
00:07:39,830 --> 00:07:41,840
we have to incorporate it to that but

250
00:07:41,840 --> 00:07:42,919
weak passwords pasture management

251
00:07:42,919 --> 00:07:45,440
two-factor authentication segmentation

252
00:07:45,440 --> 00:07:47,590
my god right

253
00:07:47,590 --> 00:07:49,460
segmentation is one of those things

254
00:07:49,460 --> 00:07:50,509
where we should have been doing a long

255
00:07:50,509 --> 00:07:52,669
time ago but we have to re our Kotak how

256
00:07:52,669 --> 00:07:54,740
we do business try doing that in a large

257
00:07:54,740 --> 00:07:56,750
organization small organizations might

258
00:07:56,750 --> 00:07:57,979
might be a little bit easier but large

259
00:07:57,979 --> 00:07:59,570
organizations rer connecting and

260
00:07:59,570 --> 00:08:00,979
redesigning your entire infrastructure

261
00:08:00,979 --> 00:08:03,500
is a major thing probably one of the

262
00:08:03,500 --> 00:08:05,150
most effective ways that we get stopped

263
00:08:05,150 --> 00:08:06,469
as attackers is through application

264
00:08:06,469 --> 00:08:08,870
whitelisting by far today application

265
00:08:08,870 --> 00:08:10,729
whitelisting again by far the most

266
00:08:10,729 --> 00:08:12,469
effective control you can put into your

267
00:08:12,469 --> 00:08:15,050
environment today to stop most the stuff

268
00:08:15,050 --> 00:08:16,159
you see out there now don't get me wrong

269
00:08:16,159 --> 00:08:17,750
there's we've called living off the land

270
00:08:17,750 --> 00:08:19,250
binders and scripts and there's ways of

271
00:08:19,250 --> 00:08:20,990
circumventing those controls but guess

272
00:08:20,990 --> 00:08:23,030
what guess what 84% of the noise is

273
00:08:23,030 --> 00:08:25,909
today binaries and applications that are

274
00:08:25,909 --> 00:08:29,000
untrusted in your environment 84% what

275
00:08:29,000 --> 00:08:31,000
happens when you take that away you

276
00:08:31,000 --> 00:08:35,479
don't have 84% anymore right so you know

277
00:08:35,479 --> 00:08:37,940
you have 16% to do the math right yeah

278
00:08:37,940 --> 00:08:39,529
okay thank God I always freak out about

279
00:08:39,529 --> 00:08:41,208
that with that one statistic I get the

280
00:08:41,208 --> 00:08:43,578
numbers wrong then you have 16% now you

281
00:08:43,578 --> 00:08:45,170
can focus on in your environment say hey

282
00:08:45,170 --> 00:08:46,190
these are the things that we can do

283
00:08:46,190 --> 00:08:48,650
differently to identify the noise in May

284
00:08:48,650 --> 00:08:50,209
and and monitor for deviations of

285
00:08:50,209 --> 00:08:50,790
patterns to be

286
00:08:50,790 --> 00:08:52,470
in your environment so again one of the

287
00:08:52,470 --> 00:08:54,750
most effective ways out there not easy

288
00:08:54,750 --> 00:08:56,820
is anybody ement application control and

289
00:08:56,820 --> 00:08:58,050
cross your entire environment in high

290
00:08:58,050 --> 00:09:00,560
integrity mode without any exceptions

291
00:09:00,560 --> 00:09:04,260
not happening right not happening but

292
00:09:04,260 --> 00:09:05,850
there are ways for us to at least get it

293
00:09:05,850 --> 00:09:06,980
in there to do a bit better of a job

294
00:09:06,980 --> 00:09:10,200
some basics that I see blocking on-site

295
00:09:10,200 --> 00:09:11,730
executables and user profile directories

296
00:09:11,730 --> 00:09:14,910
as a start like basic right hey it's not

297
00:09:14,910 --> 00:09:16,140
a code signed application

298
00:09:16,140 --> 00:09:17,850
you know just block it in your user app

299
00:09:17,850 --> 00:09:19,380
data's and your downloads and everything

300
00:09:19,380 --> 00:09:20,850
else and don't allow it to execute in

301
00:09:20,850 --> 00:09:22,020
the first place guess what that does

302
00:09:22,020 --> 00:09:24,810
prob about 75% of that 84% you see out

303
00:09:24,810 --> 00:09:27,540
there today constrain language moon

304
00:09:27,540 --> 00:09:30,030
being able to implement so let me just

305
00:09:30,030 --> 00:09:32,430
get this out of the way do regular users

306
00:09:32,430 --> 00:09:36,240
the PowerShell hell as kids in your heck

307
00:09:36,240 --> 00:09:40,230
no heck no regular users do not need

308
00:09:40,230 --> 00:09:42,450
PowerShell right so why do why does

309
00:09:42,450 --> 00:09:45,030
every user need access the PowerShell

310
00:09:45,030 --> 00:09:46,740
you could do that within Group Policy

311
00:09:46,740 --> 00:09:48,420
right if you have soft restriction

312
00:09:48,420 --> 00:09:50,400
policies you have app blocker and device

313
00:09:50,400 --> 00:09:51,720
guard right you can do that directly

314
00:09:51,720 --> 00:09:53,220
with the group policy to say hey if

315
00:09:53,220 --> 00:09:54,480
they're not part of these groups don't

316
00:09:54,480 --> 00:09:56,130
allow them to execute power shell and

317
00:09:56,130 --> 00:09:57,570
there's two locations by the way in

318
00:09:57,570 --> 00:09:59,010
PowerShell people almost for always

319
00:09:59,010 --> 00:10:00,930
always forget this you have C colon

320
00:10:00,930 --> 00:10:02,220
backslash Windows backslash this with

321
00:10:02,220 --> 00:10:03,510
their due back sash windows powershell

322
00:10:03,510 --> 00:10:05,910
backs s version 100 backslash powershell

323
00:10:05,910 --> 00:10:07,350
died exe and PowerShell underscore is

324
00:10:07,350 --> 00:10:08,850
seated exe okay those are your two main

325
00:10:08,850 --> 00:10:11,160
locations but you also have on sis while

326
00:10:11,160 --> 00:10:12,960
64 which is amir windows directory

327
00:10:12,960 --> 00:10:15,750
windows backs last as well 64 back to us

328
00:10:15,750 --> 00:10:16,830
windows powershell back to the first

329
00:10:16,830 --> 00:10:18,690
window back to the power saw the DX e

330
00:10:18,690 --> 00:10:21,150
and then powershell and square zdz those

331
00:10:21,150 --> 00:10:23,100
two locations are your two main culprits

332
00:10:23,100 --> 00:10:24,270
for what you want to lock down with

333
00:10:24,270 --> 00:10:26,760
those specifically so this thing long

334
00:10:26,760 --> 00:10:29,310
users for access powershell version 6

335
00:10:29,310 --> 00:10:31,680
and above heavy logging everybody from

336
00:10:31,680 --> 00:10:33,870
the script lock logging there's anybody

337
00:10:33,870 --> 00:10:36,240
ever enable script lock logging did

338
00:10:36,240 --> 00:10:37,640
anybody crash servers when they did that

339
00:10:37,640 --> 00:10:39,900
they just Splunk licensing go up 10

340
00:10:39,900 --> 00:10:43,860
million dollars yes right so script

341
00:10:43,860 --> 00:10:46,050
block logging is amazing it's also the

342
00:10:46,050 --> 00:10:47,550
most noisiest log that you're gonna have

343
00:10:47,550 --> 00:10:49,050
in your entire environment and i wish we

344
00:10:49,050 --> 00:10:50,250
lived in a world where money wasn't a

345
00:10:50,250 --> 00:10:52,170
problem like again one security person

346
00:10:52,170 --> 00:10:53,790
to one employee when you enable

347
00:10:53,790 --> 00:10:55,680
constraint language mode there is stuff

348
00:10:55,680 --> 00:10:57,360
of microsoft's internals that you never

349
00:10:57,360 --> 00:10:58,530
want to see deployed in your environment

350
00:10:58,530 --> 00:11:00,450
from those powershell scripts man they

351
00:11:00,450 --> 00:11:01,740
do stuff wrong especially if your office

352
00:11:01,740 --> 00:11:03,510
365 user or

353
00:11:03,510 --> 00:11:05,580
customers the amount of unsigned

354
00:11:05,580 --> 00:11:07,350
PowerShell code that is flying through

355
00:11:07,350 --> 00:11:08,640
your network is absolutely astonishing

356
00:11:08,640 --> 00:11:10,590
it's incredible

357
00:11:10,590 --> 00:11:12,300
and by the way if you ever want to fool

358
00:11:12,300 --> 00:11:14,190
a sock out by the way just take one of

359
00:11:14,190 --> 00:11:16,290
those scripts it's like they're like 700

360
00:11:16,290 --> 00:11:18,300
pages long put your shell code injection

361
00:11:18,300 --> 00:11:19,680
in the middle of it cuz no one's ever

362
00:11:19,680 --> 00:11:21,420
gonna see it and just upload and you're

363
00:11:21,420 --> 00:11:21,960
all set

364
00:11:21,960 --> 00:11:22,890
cuz they're not code sign in the first

365
00:11:22,890 --> 00:11:23,940
place it's still gonna create as

366
00:11:23,940 --> 00:11:25,110
Microsoft function and do all this stuff

367
00:11:25,110 --> 00:11:26,400
and it's also gonna get you remote code

368
00:11:26,400 --> 00:11:27,690
execution at the same time without being

369
00:11:27,690 --> 00:11:31,220
seen so apply on that one specifically

370
00:11:31,220 --> 00:11:33,480
also PowerShell version 6 and getting

371
00:11:33,480 --> 00:11:35,700
more four boats into logging what's

372
00:11:35,700 --> 00:11:37,710
interesting the PowerShell is it

373
00:11:37,710 --> 00:11:38,820
integrates into what's called the

374
00:11:38,820 --> 00:11:40,110
anti-malware scan interface which I'm

375
00:11:40,110 --> 00:11:41,220
going to show you an example here in a

376
00:11:41,220 --> 00:11:43,890
few a messiah is is is a great

377
00:11:43,890 --> 00:11:45,180
abstraction layer getting a little more

378
00:11:45,180 --> 00:11:46,800
clear of what actually is about to be

379
00:11:46,800 --> 00:11:48,540
executing on your system right before it

380
00:11:48,540 --> 00:11:50,040
hits the actual interpreter itself and

381
00:11:50,040 --> 00:11:52,200
so with a MSI there's what's called a

382
00:11:52,200 --> 00:11:54,660
messiah scan string and a MSS can buffer

383
00:11:54,660 --> 00:11:56,580
and what you can do with PowerShell

384
00:11:56,580 --> 00:11:58,440
scripts specifically is scan those prior

385
00:11:58,440 --> 00:12:00,000
to it actually executing in your system

386
00:12:00,000 --> 00:12:01,980
which gives you a lot more verbosity now

387
00:12:01,980 --> 00:12:04,050
the issue with a MSI is it runs in user

388
00:12:04,050 --> 00:12:05,760
land mode so as a user you can disable

389
00:12:05,760 --> 00:12:07,560
it so there's a number of ways of

390
00:12:07,560 --> 00:12:09,000
defeating a Masai complete setting it

391
00:12:09,000 --> 00:12:11,400
down completely but what you'll see in a

392
00:12:11,400 --> 00:12:14,100
demonstration here is that even with a

393
00:12:14,100 --> 00:12:15,780
MSI detection you only have to modify

394
00:12:15,780 --> 00:12:17,670
things in just this tiny tiny tiny way

395
00:12:17,670 --> 00:12:19,230
to circumvent their complete detection

396
00:12:19,230 --> 00:12:20,370
criteria so it's still a really

397
00:12:20,370 --> 00:12:22,980
rudimentary way of detection but still

398
00:12:22,980 --> 00:12:24,360
good visibility if you're pulling that

399
00:12:24,360 --> 00:12:27,270
data back to look at that I'm a huge fan

400
00:12:27,270 --> 00:12:29,460
of system on system on leverages what's

401
00:12:29,460 --> 00:12:31,260
called kernel level event log tracing

402
00:12:31,260 --> 00:12:34,350
for Windows etw it's a great way of

403
00:12:34,350 --> 00:12:36,240
getting more visibility into things that

404
00:12:36,240 --> 00:12:36,930
are happening in your environment

405
00:12:36,930 --> 00:12:38,970
without having to deal with crazy kernel

406
00:12:38,970 --> 00:12:41,010
drivers so system on is a great way to

407
00:12:41,010 --> 00:12:42,390
deploy your environment to see a lot of

408
00:12:42,390 --> 00:12:44,190
good stuff and Olaf has probably the

409
00:12:44,190 --> 00:12:46,040
most comprehensive system on

410
00:12:46,040 --> 00:12:47,580
configuration files what's great about

411
00:12:47,580 --> 00:12:48,930
system on is you can actually configure

412
00:12:48,930 --> 00:12:51,330
them to be alerts and alarms it does

413
00:12:51,330 --> 00:12:52,440
it's only central correlation

414
00:12:52,440 --> 00:12:54,630
essentially you can say and if this does

415
00:12:54,630 --> 00:12:56,340
that and ok that's good and then send

416
00:12:56,340 --> 00:12:58,050
this alarm back that specifically does

417
00:12:58,050 --> 00:12:59,970
something this is great for living off

418
00:12:59,970 --> 00:13:01,320
land binaries and scripts and everything

419
00:13:01,320 --> 00:13:05,070
else please please please enable the

420
00:13:05,070 --> 00:13:08,130
Windows Firewall internally just that

421
00:13:08,130 --> 00:13:10,950
that's easy isn't it for users users not

422
00:13:10,950 --> 00:13:14,280
easy easy no easy little easy kind easy

423
00:13:14,280 --> 00:13:17,430
for regular users why does that matter

424
00:13:17,430 --> 00:13:19,230
workstation workstation communication is

425
00:13:19,230 --> 00:13:20,339
typically how we move for ladder

426
00:13:20,339 --> 00:13:22,440
movement so you enable the Windows

427
00:13:22,440 --> 00:13:24,360
Firewall basic concept and all of a

428
00:13:24,360 --> 00:13:26,430
sudden I can't pivot from Bob and IT to

429
00:13:26,430 --> 00:13:28,529
Bob and sales to Mary nighties computer

430
00:13:28,529 --> 00:13:30,330
you eliminated an attack surface that we

431
00:13:30,330 --> 00:13:31,920
we previously had that we wouldn't have

432
00:13:31,920 --> 00:13:33,180
necessarily if you had those just

433
00:13:33,180 --> 00:13:36,690
controls out there detections I will

434
00:13:36,690 --> 00:13:38,160
repeat this throughout this presentation

435
00:13:38,160 --> 00:13:39,570
this is one of the most important pieces

436
00:13:39,570 --> 00:13:41,339
out there but in order to do endpoint

437
00:13:41,339 --> 00:13:43,050
detection and in order to do a detection

438
00:13:43,050 --> 00:13:44,880
at all you need to have endpoint locks

439
00:13:44,880 --> 00:13:47,400
I'll repeat that you need to have

440
00:13:47,400 --> 00:13:48,600
endpoint locks I know you're Splunk

441
00:13:48,600 --> 00:13:50,160
licensing goes up to ten million dollars

442
00:13:50,160 --> 00:13:52,410
but you need and I'm not a rep for lunk

443
00:13:52,410 --> 00:13:54,180
by the way either but you know whatever

444
00:13:54,180 --> 00:13:55,260
you have for your cinema your

445
00:13:55,260 --> 00:13:56,160
correlation engine if you using

446
00:13:56,160 --> 00:13:57,300
something like elasticsearch all you

447
00:13:57,300 --> 00:14:00,180
need a storage then right but you you

448
00:14:00,180 --> 00:14:01,230
leverage something like endpoints you

449
00:14:01,230 --> 00:14:02,460
have to have logs that's where most of

450
00:14:02,460 --> 00:14:03,510
your attacks service comes in through

451
00:14:03,510 --> 00:14:04,950
again obviously other things like east

452
00:14:04,950 --> 00:14:06,810
east and west traffic not just north and

453
00:14:06,810 --> 00:14:09,360
south when it comes to communications

454
00:14:09,360 --> 00:14:11,820
DNS logs script block Logging's grades

455
00:14:11,820 --> 00:14:13,980
command line auditing another group

456
00:14:13,980 --> 00:14:15,330
policy feature right you turn that on

457
00:14:15,330 --> 00:14:16,680
you can see command line auditing as

458
00:14:16,680 --> 00:14:18,390
it's going on why is bob and sales

459
00:14:18,390 --> 00:14:20,580
executing an IP config some decent

460
00:14:20,580 --> 00:14:23,570
pieces their visibility first

461
00:14:23,570 --> 00:14:25,770
understanding specific tactics and

462
00:14:25,770 --> 00:14:26,940
procedures techniques and procedures

463
00:14:26,940 --> 00:14:29,160
that attackers using your environment

464
00:14:29,160 --> 00:14:30,900
from a detection standpoint what I see

465
00:14:30,900 --> 00:14:33,600
in most companies and what I do a thing

466
00:14:33,600 --> 00:14:35,370
called ions there's a thing called ask

467
00:14:35,370 --> 00:14:36,350
an expert which I apparently am

468
00:14:36,350 --> 00:14:39,180
pretending to be an expert and so when

469
00:14:39,180 --> 00:14:41,730
you're an expert the more the biggest

470
00:14:41,730 --> 00:14:43,529
calls that I get is how do I take my

471
00:14:43,529 --> 00:14:45,750
turist techniques and how do I run them

472
00:14:45,750 --> 00:14:46,860
in my environment how do I write the

473
00:14:46,860 --> 00:14:48,959
Texans off of them that's gonna be our

474
00:14:48,959 --> 00:14:50,970
RC and then they call their ad that's my

475
00:14:50,970 --> 00:14:53,339
adversarial simulation programming I'm

476
00:14:53,339 --> 00:14:54,690
like okay we got a lot of discussion to

477
00:14:54,690 --> 00:14:56,820
talk about here okay so what happens

478
00:14:56,820 --> 00:14:58,320
with a lot of these techniques out there

479
00:14:58,320 --> 00:14:59,880
is that you're not focusing on the

480
00:14:59,880 --> 00:15:01,709
tactics or the procedures that the

481
00:15:01,709 --> 00:15:02,820
attackers wrappered by or even

482
00:15:02,820 --> 00:15:04,260
understanding your threat models around

483
00:15:04,260 --> 00:15:06,029
which groups are specifically focused on

484
00:15:06,029 --> 00:15:08,070
you as an organization and what ends up

485
00:15:08,070 --> 00:15:09,390
happening is you get a bunch of command

486
00:15:09,390 --> 00:15:10,950
line parsing tools do your writing

487
00:15:10,950 --> 00:15:13,110
specifically Texans for and to

488
00:15:13,110 --> 00:15:15,390
circumvent them is usually very trivial

489
00:15:15,390 --> 00:15:17,910
a good example is a tool that I wrote

490
00:15:17,910 --> 00:15:19,230
called magic unicorn which is a

491
00:15:19,230 --> 00:15:21,089
PowerShell exploitation framework and

492
00:15:21,089 --> 00:15:22,740
one of the customers that we were

493
00:15:22,740 --> 00:15:24,420
working with will look for encoded

494
00:15:24,420 --> 00:15:25,950
command which if you're not familiar

495
00:15:25,950 --> 00:15:28,410
powershell coda command is the way to

496
00:15:28,410 --> 00:15:30,040
essentially get around what are called

497
00:15:30,040 --> 00:15:32,290
execution restriction policies and so

498
00:15:32,290 --> 00:15:33,970
within code of command you can cast

499
00:15:33,970 --> 00:15:35,920
something in Unicode and base64 encode

500
00:15:35,920 --> 00:15:37,240
it and your entire application would

501
00:15:37,240 --> 00:15:39,699
then run by running a code of command so

502
00:15:39,699 --> 00:15:41,350
a lot of people look for in coda command

503
00:15:41,350 --> 00:15:42,790
being run in their environment look for

504
00:15:42,790 --> 00:15:46,060
- e - en - en c - e C by the way which a

505
00:15:46,060 --> 00:15:47,620
lot of people don't know about so I

506
00:15:47,620 --> 00:15:50,199
wrote unicorn to basically convert

507
00:15:50,199 --> 00:15:52,269
encode a command back at the very end

508
00:15:52,269 --> 00:15:53,589
but you never actually call encode of

509
00:15:53,589 --> 00:15:54,430
command the first place which

510
00:15:54,430 --> 00:15:55,620
circumvents all the detection criteria

511
00:15:55,620 --> 00:15:58,389
that's out there so again looking more

512
00:15:58,389 --> 00:15:59,709
at the behavior which we'll talk about

513
00:15:59,709 --> 00:16:01,029
here in a little bit becomes really

514
00:16:01,029 --> 00:16:03,220
important than the actual technique that

515
00:16:03,220 --> 00:16:04,120
was being leveraged in your environment

516
00:16:04,120 --> 00:16:06,040
I'd want to know every single time power

517
00:16:06,040 --> 00:16:07,389
saw communicating out to the Internet is

518
00:16:07,389 --> 00:16:08,290
that gonna generate a lot of false

519
00:16:08,290 --> 00:16:10,089
positives yep can I based on my

520
00:16:10,089 --> 00:16:11,139
environment yep

521
00:16:11,139 --> 00:16:13,509
but I get a lot less as time goes on yep

522
00:16:13,509 --> 00:16:16,000
do any people to do that yes so you know

523
00:16:16,000 --> 00:16:18,069
behavior becomes really really important

524
00:16:18,069 --> 00:16:19,630
in environments but you need the people

525
00:16:19,630 --> 00:16:21,639
to be able to really establish that and

526
00:16:21,639 --> 00:16:25,329
use it and so my personal belief is that

527
00:16:25,329 --> 00:16:26,889
we purchase tools to try to fix poor

528
00:16:26,889 --> 00:16:29,110
security programs and let me let me talk

529
00:16:29,110 --> 00:16:30,310
about that for a second okay in this

530
00:16:30,310 --> 00:16:32,500
concept because if you are if you have a

531
00:16:32,500 --> 00:16:34,420
group that is already overworked right

532
00:16:34,420 --> 00:16:36,040
would you is anybody here not overworked

533
00:16:36,040 --> 00:16:37,360
does anybody just chill at their office

534
00:16:37,360 --> 00:16:38,760
they don't do anything they just chill

535
00:16:38,760 --> 00:16:40,779
got one that's pretty awesome I'm not

536
00:16:40,779 --> 00:16:44,170
not look one person just chill at the

537
00:16:44,170 --> 00:16:45,250
office and don't do anything you're not

538
00:16:45,250 --> 00:16:47,470
not dealing with meetings or fires would

539
00:16:47,470 --> 00:16:49,149
be great as if we could just focus our

540
00:16:49,149 --> 00:16:51,459
entire day on security but that never

541
00:16:51,459 --> 00:16:53,589
happens right we're dealing with a lot

542
00:16:53,589 --> 00:16:55,029
of other things you got ITIL and change

543
00:16:55,029 --> 00:16:56,529
control we got to go to the cab meeting

544
00:16:56,529 --> 00:16:58,180
for something else and do this and that

545
00:16:58,180 --> 00:16:59,860
and then we have audits going on we're

546
00:16:59,860 --> 00:17:01,630
at the provide context and data to it oh

547
00:17:01,630 --> 00:17:03,069
hey there's a fire over here where the

548
00:17:03,069 --> 00:17:04,150
system's burning down was it our

549
00:17:04,150 --> 00:17:05,530
endpoint agent that did it you know

550
00:17:05,530 --> 00:17:06,760
there's all these different things that

551
00:17:06,760 --> 00:17:09,130
impact us on a day-in day-out and so

552
00:17:09,130 --> 00:17:11,020
when you take a piece of technology that

553
00:17:11,020 --> 00:17:12,309
you already have embedded in your

554
00:17:12,309 --> 00:17:14,530
environment you say this product is crap

555
00:17:14,530 --> 00:17:16,299
and you rip it out and you put a brand

556
00:17:16,299 --> 00:17:19,290
new piece of technology and what happens

557
00:17:19,290 --> 00:17:21,609
that next product and we just this crap

558
00:17:21,609 --> 00:17:22,959
because it's how you're leveraging the

559
00:17:22,959 --> 00:17:24,970
tools and technology you don't have the

560
00:17:24,970 --> 00:17:26,439
resources to be able to leverage it in

561
00:17:26,439 --> 00:17:28,209
the same way you can anything else and

562
00:17:28,209 --> 00:17:31,440
like I hear all the time like our voters

563
00:17:31,440 --> 00:17:34,120
you know we're using Qualis raising

564
00:17:34,120 --> 00:17:35,770
nessus or using rapid7 or whatever you

565
00:17:35,770 --> 00:17:37,419
want to use it sucks I'm like well

566
00:17:37,419 --> 00:17:39,460
what's your process well we don't have a

567
00:17:39,460 --> 00:17:41,980
process okay let's let's talk about it's

568
00:17:41,980 --> 00:17:43,870
not the scanner that's your fault

569
00:17:43,870 --> 00:17:45,070
it's your program that you built

570
00:17:45,070 --> 00:17:46,480
surround it that is not working as

571
00:17:46,480 --> 00:17:48,880
anticipating to focus on that so usually

572
00:17:48,880 --> 00:17:50,590
when we purchase new tools we already

573
00:17:50,590 --> 00:17:51,970
have everything we need today in our

574
00:17:51,970 --> 00:17:53,620
environment typically you may be a

575
00:17:53,620 --> 00:17:54,850
supplement a couple of things but we

576
00:17:54,850 --> 00:17:55,929
usually already have the technology

577
00:17:55,929 --> 00:17:58,360
today to do what we need to do yet we go

578
00:17:58,360 --> 00:17:59,500
we buy the latest and greatest because

579
00:17:59,500 --> 00:18:03,370
it's next-gen it's awesome so most

580
00:18:03,370 --> 00:18:05,980
organizations we see are still at the

581
00:18:05,980 --> 00:18:08,559
basic concept level they don't have a

582
00:18:08,559 --> 00:18:10,210
lot of the enhanced detection they're

583
00:18:10,210 --> 00:18:11,770
not focusing on simulations and a

584
00:18:11,770 --> 00:18:13,570
mediation to talk a little bit about

585
00:18:13,570 --> 00:18:15,789
here in a few minutes some are much

586
00:18:15,789 --> 00:18:16,990
further ahead than others there's a

587
00:18:16,990 --> 00:18:19,029
there's a company that we do work for it

588
00:18:19,029 --> 00:18:19,990
probably has one of the best security

589
00:18:19,990 --> 00:18:22,149
programs that I've ever seen and and I

590
00:18:22,149 --> 00:18:23,679
love to tell the story because it's

591
00:18:23,679 --> 00:18:25,720
where we just got annihilated to where

592
00:18:25,720 --> 00:18:27,399
we look like a bunch of kids and and we

593
00:18:27,399 --> 00:18:28,840
don't like that feeling right when we're

594
00:18:28,840 --> 00:18:31,149
gonna and a red team engagement and you

595
00:18:31,149 --> 00:18:32,559
get in and they detecting you shut you

596
00:18:32,559 --> 00:18:33,700
out in every single way shape or form

597
00:18:33,700 --> 00:18:35,020
you possible you could have gotten into

598
00:18:35,020 --> 00:18:36,460
their environment and then the entire

599
00:18:36,460 --> 00:18:38,169
blue team is clapping and cheering on

600
00:18:38,169 --> 00:18:41,500
the phone Wow like can't we be trusted

601
00:18:41,500 --> 00:18:43,480
sack yeah you know it's like shooting

602
00:18:43,480 --> 00:18:45,789
you're like oh so we're like playing

603
00:18:45,789 --> 00:18:47,470
like playing like careless whispers in

604
00:18:47,470 --> 00:18:49,240
our slack channel and like like like

605
00:18:49,240 --> 00:18:51,520
eating popcorn and ice cream so to get

606
00:18:51,520 --> 00:18:53,529
over it and you know one thing we

607
00:18:53,529 --> 00:18:54,880
decided is hey that we don't never want

608
00:18:54,880 --> 00:18:56,110
to have that happen again and so next

609
00:18:56,110 --> 00:18:57,970
time in round we destroyed them and we

610
00:18:57,970 --> 00:18:59,409
were clapping on the phone and then the

611
00:18:59,409 --> 00:19:00,669
next time around they destroyed us it's

612
00:19:00,669 --> 00:19:01,750
that back and forth that works really

613
00:19:01,750 --> 00:19:03,580
well right but the way that they do it

614
00:19:03,580 --> 00:19:05,679
is is they have an entire team that

615
00:19:05,679 --> 00:19:07,539
focuses on understanding their threats

616
00:19:07,539 --> 00:19:09,190
in their environment and building their

617
00:19:09,190 --> 00:19:10,990
program around that and then simulating

618
00:19:10,990 --> 00:19:12,370
that in these types of tests and

619
00:19:12,370 --> 00:19:14,140
simulations that we see out there so

620
00:19:14,140 --> 00:19:16,299
again some of these are great use

621
00:19:16,299 --> 00:19:18,039
examples of things that actually work in

622
00:19:18,039 --> 00:19:20,679
environments that we've seen and

623
00:19:20,679 --> 00:19:22,570
collaboration is one of the biggest

624
00:19:22,570 --> 00:19:25,059
pieces that I can't hit home enough

625
00:19:25,059 --> 00:19:27,130
about I'm gonna break down a the

626
00:19:27,130 --> 00:19:28,840
concepts here and then insert this is in

627
00:19:28,840 --> 00:19:31,240
education or not a repeat of something

628
00:19:31,240 --> 00:19:33,010
that you've already already know but we

629
00:19:33,010 --> 00:19:34,570
talked about Blue Team and Red Team we

630
00:19:34,570 --> 00:19:35,980
talked about purple team purple teaming

631
00:19:35,980 --> 00:19:37,600
isn't a new concept purple team has been

632
00:19:37,600 --> 00:19:39,490
around since 2007 Lee says this as far

633
00:19:39,490 --> 00:19:41,409
back as I could find it a term usage of

634
00:19:41,409 --> 00:19:43,510
purple teaming and purple teaming isn't

635
00:19:43,510 --> 00:19:44,919
a new thing that we're trying to build

636
00:19:44,919 --> 00:19:46,630
on top of the security industry what

637
00:19:46,630 --> 00:19:48,640
purple teaming is is just collaboration

638
00:19:48,640 --> 00:19:49,870
between the red team and the blue team

639
00:19:49,870 --> 00:19:51,970
and what we used to do and I'll talk

640
00:19:51,970 --> 00:19:53,110
about this here in a little bit we used

641
00:19:53,110 --> 00:19:54,750
to go in we should just break everything

642
00:19:54,750 --> 00:19:57,370
and you'd break everything you'd hand

643
00:19:57,370 --> 00:19:59,050
awesome report to your customer and

644
00:19:59,050 --> 00:20:00,820
you'd walk out like man I just destroyed

645
00:20:00,820 --> 00:20:02,410
this company they're totally screwed

646
00:20:02,410 --> 00:20:04,090
good luck and then next year to come

647
00:20:04,090 --> 00:20:06,580
back same thing just join him again they

648
00:20:06,580 --> 00:20:08,230
fixed all the technical findings they

649
00:20:08,230 --> 00:20:09,400
didn't fix the reason why those

650
00:20:09,400 --> 00:20:10,540
technical findings were there in the

651
00:20:10,540 --> 00:20:11,200
first place

652
00:20:11,200 --> 00:20:13,450
and so year after year after year after

653
00:20:13,450 --> 00:20:15,280
year it was read winning winning winning

654
00:20:15,280 --> 00:20:17,440
winning winning and it was read doing

655
00:20:17,440 --> 00:20:19,270
their mystique and their their amazing

656
00:20:19,270 --> 00:20:21,160
feats and they're a cool hacker stuff

657
00:20:21,160 --> 00:20:22,630
from their screens flying with you know

658
00:20:22,630 --> 00:20:24,550
green green green text everywhere with

659
00:20:24,550 --> 00:20:27,160
cool ASCII art have to have ask yarn or

660
00:20:27,160 --> 00:20:29,050
to be considered a hacker my opinion

661
00:20:29,050 --> 00:20:31,059
it's also a prerequisite for any tools

662
00:20:31,059 --> 00:20:32,290
that we release a trusted second test

663
00:20:32,290 --> 00:20:34,570
it's actually in the tool release guide

664
00:20:34,570 --> 00:20:37,750
ASCII art and so any get judged on the

665
00:20:37,750 --> 00:20:41,110
ASCII art - so anyways but that wasn't

666
00:20:41,110 --> 00:20:42,460
the right way of doing things we weren't

667
00:20:42,460 --> 00:20:44,080
helping anybody by going in and

668
00:20:44,080 --> 00:20:45,850
destroying companies every time where

669
00:20:45,850 --> 00:20:47,890
companies really start to shine is when

670
00:20:47,890 --> 00:20:49,480
you have that collaboration between red

671
00:20:49,480 --> 00:20:51,250
and blue where instead of doing covert

672
00:20:51,250 --> 00:20:53,170
all the time to test the effectiveness

673
00:20:53,170 --> 00:20:54,970
of your instant response program you're

674
00:20:54,970 --> 00:20:56,710
doing over testing you're working with

675
00:20:56,710 --> 00:20:57,640
them as you're going through your

676
00:20:57,640 --> 00:20:59,710
simulations and you say listen here's

677
00:20:59,710 --> 00:21:01,300
the things that we're doing here's the

678
00:21:01,300 --> 00:21:02,410
things you can get better on here's the

679
00:21:02,410 --> 00:21:03,280
things that you're just missing as far

680
00:21:03,280 --> 00:21:04,809
as detection you walk out of there

681
00:21:04,809 --> 00:21:06,790
completely different then hey here's a

682
00:21:06,790 --> 00:21:08,800
list of 10 findings at the pit patch you

683
00:21:08,800 --> 00:21:10,570
know specific systems for so that

684
00:21:10,570 --> 00:21:12,220
collaboration really becomes really

685
00:21:12,220 --> 00:21:14,920
really important I'm a huge believer on

686
00:21:14,920 --> 00:21:16,300
simulations and emulation

687
00:21:16,300 --> 00:21:19,420
I think tool releases are great there's

688
00:21:19,420 --> 00:21:20,740
a lot of debate right now and whether or

689
00:21:20,740 --> 00:21:22,360
not to release is do more harm than good

690
00:21:22,360 --> 00:21:23,800
whether researchers disclosing

691
00:21:23,800 --> 00:21:26,080
techniques do more harm than good I'm a

692
00:21:26,080 --> 00:21:28,210
huge advocate of giving tools to people

693
00:21:28,210 --> 00:21:29,920
that may not be able to develop those

694
00:21:29,920 --> 00:21:30,940
tools so they can test their own

695
00:21:30,940 --> 00:21:32,380
environment attackers are gonna do it

696
00:21:32,380 --> 00:21:34,090
why can't we have the same types of

697
00:21:34,090 --> 00:21:35,140
tools out there yes they're gonna be

698
00:21:35,140 --> 00:21:37,150
used by adversaries colbalt strike by

699
00:21:37,150 --> 00:21:38,559
the way is used all the time by Russia

700
00:21:38,559 --> 00:21:40,960
all the time would you say that coal

701
00:21:40,960 --> 00:21:42,910
boat strikes a bad tool no we use it as

702
00:21:42,910 --> 00:21:44,290
testers all the time to test the

703
00:21:44,290 --> 00:21:45,760
effectiveness because we don't have a

704
00:21:45,760 --> 00:21:48,010
Mudge to be able to build that tool

705
00:21:48,010 --> 00:21:49,750
internally to our own capabilities and

706
00:21:49,750 --> 00:21:51,790
so we have to have the tools necessary

707
00:21:51,790 --> 00:21:54,309
to do our jobs as does any carpenter it

708
00:21:54,309 --> 00:21:56,200
has to do their jobs could a carpenter

709
00:21:56,200 --> 00:21:58,510
take one of his his devices and stab

710
00:21:58,510 --> 00:22:01,030
somebody with it absolutely when it

711
00:22:01,030 --> 00:22:02,800
comes to research we have to have that a

712
00:22:02,800 --> 00:22:04,420
conduit of getting better and working

713
00:22:04,420 --> 00:22:06,070
better to to one goal of making things

714
00:22:06,070 --> 00:22:07,600
more secure

715
00:22:07,600 --> 00:22:10,000
without simulations red-and-blue don't

716
00:22:10,000 --> 00:22:11,800
understand each other so when I go

717
00:22:11,800 --> 00:22:12,850
through and I do a simulation of

718
00:22:12,850 --> 00:22:15,250
somebody my goal isn't to destroy them

719
00:22:15,250 --> 00:22:17,380
and it wasn't anymore I used to really

720
00:22:17,380 --> 00:22:19,780
like destroy people but but it used to

721
00:22:19,780 --> 00:22:22,120
be that way my goal is to make them

722
00:22:22,120 --> 00:22:23,350
better and what they're actually

723
00:22:23,350 --> 00:22:25,360
accomplishing and so simulations and

724
00:22:25,360 --> 00:22:26,560
working through these types of things

725
00:22:26,560 --> 00:22:28,960
make a big deal usually companies don't

726
00:22:28,960 --> 00:22:30,340
even have a foundation by the way we

727
00:22:30,340 --> 00:22:32,170
hear all the time hey we want a red team

728
00:22:32,170 --> 00:22:33,760
and we're like okay

729
00:22:33,760 --> 00:22:36,250
what does that mean to you like oh we

730
00:22:36,250 --> 00:22:37,960
want you this is just like completely

731
00:22:37,960 --> 00:22:39,610
annihilate us and break into us so that

732
00:22:39,610 --> 00:22:40,900
we you know we know exactly where all of

733
00:22:40,900 --> 00:22:42,100
our weaknesses and our exposures are in

734
00:22:42,100 --> 00:22:43,690
our environment so that then we can

735
00:22:43,690 --> 00:22:45,850
patch them all and be secure I'm like

736
00:22:45,850 --> 00:22:47,080
that's not how any of this works by the

737
00:22:47,080 --> 00:22:48,400
way this is not a red team for you

738
00:22:48,400 --> 00:22:49,990
Brett's most most organizations that we

739
00:22:49,990 --> 00:22:51,670
deal with are not at a maturity level to

740
00:22:51,670 --> 00:22:53,320
deal with red team engagements almost

741
00:22:53,320 --> 00:22:55,510
99% of them are not at a level that they

742
00:22:55,510 --> 00:22:56,650
even need red team's in their

743
00:22:56,650 --> 00:22:58,180
environment they don't even have basic

744
00:22:58,180 --> 00:23:00,430
forms of monitoring detection or even

745
00:23:00,430 --> 00:23:01,420
having endpoint logs in their

746
00:23:01,420 --> 00:23:02,920
environments what is a red team gonna do

747
00:23:02,920 --> 00:23:04,660
for them other than destroy them and

748
00:23:04,660 --> 00:23:06,220
show them where they have faulty

749
00:23:06,220 --> 00:23:07,480
programs in there and that can be used

750
00:23:07,480 --> 00:23:09,610
as a wedge - so one thing I'll say is

751
00:23:09,610 --> 00:23:12,880
red and blue are better together and I'm

752
00:23:12,880 --> 00:23:15,310
a huge advocate of that I have become

753
00:23:15,310 --> 00:23:17,710
more blue and I still say I'm Red Team

754
00:23:17,710 --> 00:23:20,140
but my whole operation of thinking is

755
00:23:20,140 --> 00:23:21,940
all blue like if I'm gonna write

756
00:23:21,940 --> 00:23:24,070
something a tool a new technique or a

757
00:23:24,070 --> 00:23:26,890
tack vector how am I gonna stop that you

758
00:23:26,890 --> 00:23:29,350
know when I do something new or unique I

759
00:23:29,350 --> 00:23:30,940
make sure that it doesn't impact blue

760
00:23:30,940 --> 00:23:33,400
like by releasing a specific exploit you

761
00:23:33,400 --> 00:23:35,050
know to the wild to impact other

762
00:23:35,050 --> 00:23:36,250
organizations and companies I you seen

763
00:23:36,250 --> 00:23:37,090
everything about that I used to write

764
00:23:37,090 --> 00:23:38,950
exploits all the time publish them up a

765
00:23:38,950 --> 00:23:40,000
mill arm like yeah I just got this

766
00:23:40,000 --> 00:23:42,100
awesome zero day here you go good luck

767
00:23:42,100 --> 00:23:44,050
you know vendor go go go patch it a

768
00:23:44,050 --> 00:23:45,940
little bit more refined now and times

769
00:23:45,940 --> 00:23:47,260
are a lot different by the way that was

770
00:23:47,260 --> 00:23:50,230
a badge of credibility you know earlier

771
00:23:50,230 --> 00:23:52,660
in you know and earlier in times of what

772
00:23:52,660 --> 00:23:53,680
exploits you can write and get around

773
00:23:53,680 --> 00:23:55,060
data execution prevention and stuff like

774
00:23:55,060 --> 00:23:58,870
that but again we talk about like we

775
00:23:58,870 --> 00:24:00,640
talked about the red team today like it

776
00:24:00,640 --> 00:24:02,800
was ten years ago we always say all the

777
00:24:02,800 --> 00:24:05,020
red team is not special I hear that all

778
00:24:05,020 --> 00:24:05,920
the time like the red team's not a

779
00:24:05,920 --> 00:24:06,880
special group well yeah they are a

780
00:24:06,880 --> 00:24:08,050
special group there there they

781
00:24:08,050 --> 00:24:09,970
understand offensive capabilities within

782
00:24:09,970 --> 00:24:12,130
an organization you're not applying the

783
00:24:12,130 --> 00:24:14,200
red team the right way then you're right

784
00:24:14,200 --> 00:24:15,250
they're just sitting there destroying

785
00:24:15,250 --> 00:24:17,260
your environment and so the

786
00:24:17,260 --> 00:24:18,400
terminologies that we use around

787
00:24:18,400 --> 00:24:20,680
penetration testers by the way ten years

788
00:24:20,680 --> 00:24:21,400
ago

789
00:24:21,400 --> 00:24:22,930
right pentesters just come in they just

790
00:24:22,930 --> 00:24:24,160
destroy the organization and they walk

791
00:24:24,160 --> 00:24:26,080
out yeah I guess that still happens in

792
00:24:26,080 --> 00:24:27,430
environments but that's not exactly what

793
00:24:27,430 --> 00:24:28,780
we're designed to be doing in

794
00:24:28,780 --> 00:24:31,720
organizations that's room hacker by the

795
00:24:31,720 --> 00:24:34,030
way applies to both red and blue it's

796
00:24:34,030 --> 00:24:35,830
not just the red team that has hackers

797
00:24:35,830 --> 00:24:37,660
the blue team are hackers why aren't you

798
00:24:37,660 --> 00:24:38,980
hacking our stuff up to figure out how

799
00:24:38,980 --> 00:24:41,080
to defend it aren't you writing awesome

800
00:24:41,080 --> 00:24:42,580
code to figure out ways to respond to us

801
00:24:42,580 --> 00:24:44,500
more effectively we're all hacking

802
00:24:44,500 --> 00:24:48,160
together and in this specific way and so

803
00:24:48,160 --> 00:24:49,660
the industry changed and this happened

804
00:24:49,660 --> 00:24:51,670
while ago it just takes a it takes a lot

805
00:24:51,670 --> 00:24:54,160
of terminologies fixes to do this people

806
00:24:54,160 --> 00:24:55,570
think that red team's repente ask people

807
00:24:55,570 --> 00:24:56,680
think that pentester vulnerability

808
00:24:56,680 --> 00:24:57,790
assessment people think I want to be

809
00:24:57,790 --> 00:24:59,170
assassins or red team's people think

810
00:24:59,170 --> 00:25:01,090
that physical assessments are you know

811
00:25:01,090 --> 00:25:02,380
social engineering which it can be a

812
00:25:02,380 --> 00:25:03,700
component of that so there's a lot of

813
00:25:03,700 --> 00:25:06,130
terminology issues that we face in this

814
00:25:06,130 --> 00:25:07,660
industry right now and a lot of it

815
00:25:07,660 --> 00:25:10,210
really is hey red team's more designed

816
00:25:10,210 --> 00:25:11,980
to understand your threat models towards

817
00:25:11,980 --> 00:25:13,360
your organization and build your

818
00:25:13,360 --> 00:25:14,680
capabilities off of what the

819
00:25:14,680 --> 00:25:16,330
capabilities are of that organization

820
00:25:16,330 --> 00:25:18,580
and to be a little bit better that's it

821
00:25:18,580 --> 00:25:21,310
not not exponentially better but going

822
00:25:21,310 --> 00:25:22,720
to the level of what that organization

823
00:25:22,720 --> 00:25:26,950
is willing to actually accomplish you

824
00:25:26,950 --> 00:25:28,660
might see a theme here around sharing

825
00:25:28,660 --> 00:25:30,610
and collaboration but when we work

826
00:25:30,610 --> 00:25:33,190
together and understand things we get

827
00:25:33,190 --> 00:25:35,350
better research by the way sharing

828
00:25:35,350 --> 00:25:38,230
things and getting better tools doing

829
00:25:38,230 --> 00:25:39,550
different things that you're I thought

830
00:25:39,550 --> 00:25:40,750
some of these were great some this one

831
00:25:40,750 --> 00:25:43,240
was how to call PowerShell without ever

832
00:25:43,240 --> 00:25:45,250
calling PowerShell that came from Daniel

833
00:25:45,250 --> 00:25:45,730
Bohannon

834
00:25:45,730 --> 00:25:46,960
both of these came from Danny Bohannon

835
00:25:46,960 --> 00:25:49,420
over fire I and this was a specific one

836
00:25:49,420 --> 00:25:52,000
is it just run for files and basically

837
00:25:52,000 --> 00:25:54,190
will eventually execute power shell with

838
00:25:54,190 --> 00:25:55,390
no exit on there and you could just

839
00:25:55,390 --> 00:25:56,530
launch PowerShell thought that a good

840
00:25:56,530 --> 00:25:59,280
ETR bypass by the way for all you folks

841
00:25:59,280 --> 00:26:01,270
this one down here I thought was really

842
00:26:01,270 --> 00:26:02,860
brilliant so it's very familiar with

843
00:26:02,860 --> 00:26:04,390
what we call living off the lamp miners

844
00:26:04,390 --> 00:26:06,850
and scripts is it me not familiar feel

845
00:26:06,850 --> 00:26:08,200
free raise your hand I okay got a couple

846
00:26:08,200 --> 00:26:10,620
explain it real quick so if you look at

847
00:26:10,620 --> 00:26:12,640
exploitation right our whole goal is to

848
00:26:12,640 --> 00:26:14,590
get code execution onto a system right

849
00:26:14,590 --> 00:26:16,270
we want to get code execution it's now

850
00:26:16,270 --> 00:26:17,260
granted we might have other objectives

851
00:26:17,260 --> 00:26:19,210
password stealing or things like that

852
00:26:19,210 --> 00:26:20,920
bypassing multi-factor authentication

853
00:26:20,920 --> 00:26:24,790
etc etc but with exploitation our whole

854
00:26:24,790 --> 00:26:26,350
goal is to get code onto that system

855
00:26:26,350 --> 00:26:27,820
that we can then run to compromised that

856
00:26:27,820 --> 00:26:28,930
asset and then from there if do

857
00:26:28,930 --> 00:26:31,150
ransomware or move laterally across

858
00:26:31,150 --> 00:26:33,180
environments other systems

859
00:26:33,180 --> 00:26:35,730
primarily I gave a talk I think it was

860
00:26:35,730 --> 00:26:38,640
DEFCON 13 it was the very first ever

861
00:26:38,640 --> 00:26:40,890
PowerShell security talk and as you've

862
00:26:40,890 --> 00:26:42,420
talked to the folks at Microsoft they'll

863
00:26:42,420 --> 00:26:43,830
say that I was the first person ever to

864
00:26:43,830 --> 00:26:44,880
give a partial secure job which is

865
00:26:44,880 --> 00:26:45,840
really cool to say like you're kind of

866
00:26:45,840 --> 00:26:48,000
like the father of PowerShell security

867
00:26:48,000 --> 00:26:49,740
you know kind of kicking that thing was

868
00:26:49,740 --> 00:26:51,740
kind of neat it's called PowerShell oMFG

869
00:26:51,740 --> 00:26:54,480
and it was when PowerShell had first

870
00:26:54,480 --> 00:26:55,980
come out and it was it was in every

871
00:26:55,980 --> 00:26:57,420
operating system yet it was Windows

872
00:26:57,420 --> 00:26:58,860
Vista at the time and they were looking

873
00:26:58,860 --> 00:27:00,690
at making an optional requirement in

874
00:27:00,690 --> 00:27:01,890
Windows Vista but they had come out and

875
00:27:01,890 --> 00:27:03,270
announced him that any further operating

876
00:27:03,270 --> 00:27:04,530
systems would have PowerShell embedded

877
00:27:04,530 --> 00:27:06,240
into it so I just had to take a look at

878
00:27:06,240 --> 00:27:07,650
it was one of my good friends Josh Kelly

879
00:27:07,650 --> 00:27:09,570
and we're like wow this is really

880
00:27:09,570 --> 00:27:11,040
powerful you can do a lot of great stuff

881
00:27:11,040 --> 00:27:12,960
with and I said listen you know giving a

882
00:27:12,960 --> 00:27:14,340
full-fledged programming language onto a

883
00:27:14,340 --> 00:27:15,270
Windows environment

884
00:27:15,270 --> 00:27:17,130
aside from vbscript and others is gonna

885
00:27:17,130 --> 00:27:18,870
be pretty damaging I think to security

886
00:27:18,870 --> 00:27:20,450
especially with no logging anything else

887
00:27:20,450 --> 00:27:22,740
it's gonna be a big deal and it's can be

888
00:27:22,740 --> 00:27:23,940
one of the main fronts of attack and lo

889
00:27:23,940 --> 00:27:25,620
and behold Power Cells become a major

890
00:27:25,620 --> 00:27:26,700
front of it now one thing I'll say about

891
00:27:26,700 --> 00:27:30,180
Microsoft is that Lee homes literally

892
00:27:30,180 --> 00:27:32,340
the catalyst for security in PowerShell

893
00:27:32,340 --> 00:27:34,830
that he deserves everything that he gets

894
00:27:34,830 --> 00:27:37,050
in more in raids I'm sure he literally

895
00:27:37,050 --> 00:27:38,610
got everything that is currently in

896
00:27:38,610 --> 00:27:39,840
PowerShell with a constraint language

897
00:27:39,840 --> 00:27:41,700
mode with logging and verbosity in there

898
00:27:41,700 --> 00:27:42,990
you have in their script lock logging

899
00:27:42,990 --> 00:27:44,490
all the security features that we now

900
00:27:44,490 --> 00:27:46,740
know instead of PowerShell you all just

901
00:27:46,740 --> 00:27:48,000
have to kind of update your stuff from

902
00:27:48,000 --> 00:27:50,160
PowerShell version 2 up to PowerShell

903
00:27:50,160 --> 00:27:52,650
version 6 or above anyways so that's

904
00:27:52,650 --> 00:27:55,590
that's PowerShell well with the way we

905
00:27:55,590 --> 00:27:57,480
used to hack about ten years ago is we

906
00:27:57,480 --> 00:27:58,770
would look for things like Java right

907
00:27:58,770 --> 00:28:00,690
which had a lot of major issues in it or

908
00:28:00,690 --> 00:28:02,460
Adobe which had a lot of major issues in

909
00:28:02,460 --> 00:28:03,930
it or office products which would have a

910
00:28:03,930 --> 00:28:05,190
lot of still have a lot of major issues

911
00:28:05,190 --> 00:28:07,710
in and so you'd have these products and

912
00:28:07,710 --> 00:28:09,660
we say well we know that a user probably

913
00:28:09,660 --> 00:28:12,360
has these products in their system so we

914
00:28:12,360 --> 00:28:14,190
know that it's there it's the same thing

915
00:28:14,190 --> 00:28:15,360
with living off the land binders and

916
00:28:15,360 --> 00:28:17,100
scripts and this is why it's so kind of

917
00:28:17,100 --> 00:28:18,510
damaging this is it circumvents

918
00:28:18,510 --> 00:28:19,680
application whitelisting your

919
00:28:19,680 --> 00:28:21,570
application control is that microsoft

920
00:28:21,570 --> 00:28:23,670
ships with binaries across the operating

921
00:28:23,670 --> 00:28:24,900
system that allow it to work right you

922
00:28:24,900 --> 00:28:27,030
have Calcutta XE for example right it's

923
00:28:27,030 --> 00:28:29,580
code signed by Microsoft you know it has

924
00:28:29,580 --> 00:28:30,960
a specific function that it produces

925
00:28:30,960 --> 00:28:33,060
well all their binaries in the Windows

926
00:28:33,060 --> 00:28:34,260
operating system have additional

927
00:28:34,260 --> 00:28:36,090
functionality built in as well I'm like

928
00:28:36,090 --> 00:28:37,560
for my my favorite ones and I'll show

929
00:28:37,560 --> 00:28:39,600
you a demonstration of this is reg SBR

930
00:28:39,600 --> 00:28:42,150
32 it's under the system 32 directory

931
00:28:42,150 --> 00:28:45,060
and registry or 32 has a /i parameter

932
00:28:45,060 --> 00:28:46,659
that allows you to go in down those

933
00:28:46,659 --> 00:28:48,190
put tags directly from the internet and

934
00:28:48,190 --> 00:28:50,139
run it without any type of detection

935
00:28:50,139 --> 00:28:51,789
whatsoever so you can go and download

936
00:28:51,789 --> 00:28:53,229
code roughly from internet execute

937
00:28:53,229 --> 00:28:54,549
automatically without any type of

938
00:28:54,549 --> 00:28:56,470
detection so using a code sign Microsoft

939
00:28:56,470 --> 00:28:58,899
Windows binary to then go and download

940
00:28:58,899 --> 00:29:00,220
code directly off the Internet and

941
00:29:00,220 --> 00:29:01,809
execute it in an authorized State

942
00:29:01,809 --> 00:29:04,330
there's about 77 of these binaries in

943
00:29:04,330 --> 00:29:07,659
Windows I do it MSH GA CBD THC CSC THC

944
00:29:07,659 --> 00:29:09,190
Matt have been checked there's a whole

945
00:29:09,190 --> 00:29:10,479
bunch of these right even BG info the

946
00:29:10,479 --> 00:29:13,029
background info that you use to show the

947
00:29:13,029 --> 00:29:14,289
IP address this has remote code

948
00:29:14,289 --> 00:29:16,179
execution functionality into it so you

949
00:29:16,179 --> 00:29:17,529
know there's a lot of different things

950
00:29:17,529 --> 00:29:18,820
that are codes I'm at Microsoft that

951
00:29:18,820 --> 00:29:21,909
give you full capabilities now let me

952
00:29:21,909 --> 00:29:22,989
show you a little little demonstration

953
00:29:22,989 --> 00:29:26,649
here really quick power this back up

954
00:29:26,649 --> 00:29:30,849
again sorry about that so this is a

955
00:29:30,849 --> 00:29:33,519
fully updated version of if it comes

956
00:29:33,519 --> 00:29:36,549
back up I hope they got it does it'll

957
00:29:36,549 --> 00:29:38,229
come up take a second here it goes oh my

958
00:29:38,229 --> 00:29:45,729
god or not there it goes all right so I

959
00:29:45,729 --> 00:29:47,259
got a fully up-to-date version of

960
00:29:47,259 --> 00:29:53,950
Windows 10 and and this is an example of

961
00:29:53,950 --> 00:29:55,629
what registry are 32 would look like as

962
00:29:55,629 --> 00:29:57,759
an attacker okay you give it a slash

963
00:29:57,759 --> 00:29:59,590
eyes / and in the slash is the most

964
00:29:59,590 --> 00:30:01,239
important and we're gonna go to trust

965
00:30:01,239 --> 00:30:03,460
tech comm as an example okay and so here

966
00:30:03,460 --> 00:30:04,539
we're just gonna go and download a

967
00:30:04,539 --> 00:30:05,889
script object it could be whatever

968
00:30:05,889 --> 00:30:07,389
extension type you want - doesn't have

969
00:30:07,389 --> 00:30:09,460
to be XML or txt or SCP or anything like

970
00:30:09,460 --> 00:30:10,960
that can be whatever you want to cuz you

971
00:30:10,960 --> 00:30:12,129
imagine hosting something like github

972
00:30:12,129 --> 00:30:13,629
and it's just a github project and it

973
00:30:13,629 --> 00:30:15,279
says readme dot txt does your defenders

974
00:30:15,279 --> 00:30:19,239
gonna see that and so this is this will

975
00:30:19,239 --> 00:30:20,859
basically create a script logic and

976
00:30:20,859 --> 00:30:23,200
execute this code for us now interesting

977
00:30:23,200 --> 00:30:25,359
enough Microsoft knows that this is bad

978
00:30:25,359 --> 00:30:27,129
right so I'm running the latest version

979
00:30:27,129 --> 00:30:29,919
of Windows Defender if you notice here

980
00:30:29,919 --> 00:30:33,309
it was less updated for the 24 so four

981
00:30:33,309 --> 00:30:34,779
days ago okay so it's about four days

982
00:30:34,779 --> 00:30:36,639
all wish you know hey I didn't hook up

983
00:30:36,639 --> 00:30:40,479
to the Internet today I apologize but if

984
00:30:40,479 --> 00:30:43,899
I run this what happens ooh got snagged

985
00:30:43,899 --> 00:30:46,330
by antivirus right it must be a really

986
00:30:46,330 --> 00:30:48,399
good detection I'm sure let's take a

987
00:30:48,399 --> 00:30:53,679
look at this what if I throw carrot into

988
00:30:53,679 --> 00:30:57,249
here wait hang on hang on Oh too good

989
00:30:57,249 --> 00:30:58,400
okay

990
00:30:58,400 --> 00:31:04,040
what if I throw another carrot here Oh

991
00:31:04,040 --> 00:31:06,630
still denied what if I throw three

992
00:31:06,630 --> 00:31:17,040
carrots this the screen to go away oh we

993
00:31:17,040 --> 00:31:27,360
get through Thank You Rance my demo I'm

994
00:31:27,360 --> 00:31:32,400
Dave Kennedy this is what we're dealing

995
00:31:32,400 --> 00:31:34,920
with today when it comes to detection

996
00:31:34,920 --> 00:31:38,550
and prevention and this is a clear-cut

997
00:31:38,550 --> 00:31:40,800
case of what we seen edr products to by

998
00:31:40,800 --> 00:31:43,640
the way edr products looking for that /i

999
00:31:43,640 --> 00:31:45,480
throw one care in there

1000
00:31:45,480 --> 00:31:47,820
let's get seen throw two carrots three

1001
00:31:47,820 --> 00:31:50,160
carrots are good sounds good another

1002
00:31:50,160 --> 00:31:52,260
couple funny ones on throwing legitimate

1003
00:31:52,260 --> 00:31:54,510
words into your your code take a

1004
00:31:54,510 --> 00:31:56,520
dictionary and just have variable

1005
00:31:56,520 --> 00:31:58,110
substitutions in there of dictionary

1006
00:31:58,110 --> 00:31:59,850
words because it makes it look more

1007
00:31:59,850 --> 00:32:01,560
predictable from an analysis perspective

1008
00:32:01,560 --> 00:32:02,460
that it's legitimate because you're

1009
00:32:02,460 --> 00:32:03,840
using legitimate dictionary words not

1010
00:32:03,840 --> 00:32:05,700
coding language stuff there's so many

1011
00:32:05,700 --> 00:32:06,780
different tricks that we have out there

1012
00:32:06,780 --> 00:32:08,820
but it's super trivial is this make me

1013
00:32:08,820 --> 00:32:11,190
an elite hacker by the way Yeah right

1014
00:32:11,190 --> 00:32:13,350
I just bypassed Windows Defender I

1015
00:32:13,350 --> 00:32:14,910
gotten rated number one in the antivirus

1016
00:32:14,910 --> 00:32:16,680
category and this year and whatever the

1017
00:32:16,680 --> 00:32:18,500
heck magazine that was right number one

1018
00:32:18,500 --> 00:32:28,620
got around it right three carrots so you

1019
00:32:28,620 --> 00:32:30,150
know with with living off land binaries

1020
00:32:30,150 --> 00:32:31,860
and scripts that's a whole nother attack

1021
00:32:31,860 --> 00:32:33,510
surface that we have available to us and

1022
00:32:33,510 --> 00:32:34,920
you know when I was gonna get to this

1023
00:32:34,920 --> 00:32:36,480
one is that this one was found in the

1024
00:32:36,480 --> 00:32:38,850
wild which I would ask does anybody here

1025
00:32:38,850 --> 00:32:40,320
actually would anybody here actually

1026
00:32:40,320 --> 00:32:42,120
detect this and I'd like to see a honest

1027
00:32:42,120 --> 00:32:43,950
answer don't be like my miner detection

1028
00:32:43,950 --> 00:32:45,690
program is the best I would all right

1029
00:32:45,690 --> 00:32:48,380
listen to what it's doing first okay

1030
00:32:48,380 --> 00:32:51,180
it's going out and it's using cert you

1031
00:32:51,180 --> 00:32:54,020
till okay every from a cert util

1032
00:32:54,020 --> 00:32:55,650
import-export certificates

1033
00:32:55,650 --> 00:32:57,450
there's a - ping option where you can

1034
00:32:57,450 --> 00:32:58,920
download code directly from the internet

1035
00:32:58,920 --> 00:33:00,510
with Suri tool why that was ever a

1036
00:33:00,510 --> 00:33:03,750
feature right don't know but hey it's

1037
00:33:03,750 --> 00:33:05,250
cool right you can download code record

1038
00:33:05,250 --> 00:33:06,690
an Internet in any context and you

1039
00:33:06,690 --> 00:33:07,860
certain till for it fine

1040
00:33:07,860 --> 00:33:09,960
sounds good now here's a crazy detection

1041
00:33:09,960 --> 00:33:11,610
they download the power show code

1042
00:33:11,610 --> 00:33:13,500
directly through circuit still and then

1043
00:33:13,500 --> 00:33:14,760
execute it with PowerShell

1044
00:33:14,760 --> 00:33:16,500
never calling out with PowerShell at all

1045
00:33:16,500 --> 00:33:18,809
in the first place pretty awesome

1046
00:33:18,809 --> 00:33:22,020
where'd you detect that no one looking

1047
00:33:22,020 --> 00:33:23,750
for sir utility key not to the internet

1048
00:33:23,750 --> 00:33:27,720
we looking for you have to do that from

1049
00:33:27,720 --> 00:33:29,160
command prompt well that one's command C

1050
00:33:29,160 --> 00:33:30,120
but you don't need to you don't need to

1051
00:33:30,120 --> 00:33:32,790
run from command prompt oh by the way as

1052
00:33:32,790 --> 00:33:33,809
an attacker

1053
00:33:33,809 --> 00:33:35,190
I can't member last time I'm actually

1054
00:33:35,190 --> 00:33:36,600
dropped into a command prompt by the way

1055
00:33:36,600 --> 00:33:38,190
we know you all look for us drug-running

1056
00:33:38,190 --> 00:33:40,740
cmd.exe but that's a good one eye or

1057
00:33:40,740 --> 00:33:44,630
leverage a completely in PowerShell so

1058
00:33:50,870 --> 00:33:52,890
that's that's the good way of doing it

1059
00:33:52,890 --> 00:33:53,730
right more than that behavior of

1060
00:33:53,730 --> 00:33:55,169
understanding applications that haven't

1061
00:33:55,169 --> 00:33:56,370
beacon down the first place and then

1062
00:33:56,370 --> 00:34:02,040
from there going there totally agree yep

1063
00:34:02,040 --> 00:34:03,720
a couple II agree baselining your

1064
00:34:03,720 --> 00:34:04,980
environment sounds like a marvelous

1065
00:34:04,980 --> 00:34:10,199
counter so without what by way without

1066
00:34:10,199 --> 00:34:12,690
talking about this most the folks in

1067
00:34:12,690 --> 00:34:14,159
here defenders probably would have known

1068
00:34:14,159 --> 00:34:16,770
that you could do that right there are

1069
00:34:16,770 --> 00:34:19,080
ways with three carrots they get around

1070
00:34:19,080 --> 00:34:20,760
Windows Defender right or there are ways

1071
00:34:20,760 --> 00:34:22,560
with cert util to go and do this or you

1072
00:34:22,560 --> 00:34:24,300
know one of my favorites is MSHDA tied

1073
00:34:24,300 --> 00:34:28,530
exe most folks know about HDI files so

1074
00:34:28,530 --> 00:34:30,690
HCA files are high content HTML files

1075
00:34:30,690 --> 00:34:32,850
and what's what's damaging about them is

1076
00:34:32,850 --> 00:34:34,500
you can run them in a browser and they

1077
00:34:34,500 --> 00:34:35,940
have any browser execute them so they

1078
00:34:35,940 --> 00:34:37,379
basically you can hit open and do

1079
00:34:37,379 --> 00:34:39,449
anything you want to there and so with

1080
00:34:39,449 --> 00:34:42,090
with HT a files most people block HTA's

1081
00:34:42,090 --> 00:34:44,070
at the firewall right so they don't

1082
00:34:44,070 --> 00:34:45,690
allow those to actually actually execute

1083
00:34:45,690 --> 00:34:49,230
but MSHDA that exe is a phenomenal

1084
00:34:49,230 --> 00:34:51,300
resource you can point m sh TI DXE to

1085
00:34:51,300 --> 00:34:52,980
any website you want to again download

1086
00:34:52,980 --> 00:34:54,330
the code and execute it directly for you

1087
00:34:54,330 --> 00:34:55,889
they have me me cats running off of em

1088
00:34:55,889 --> 00:34:57,480
SCH ta ta whatever you want to running

1089
00:34:57,480 --> 00:34:59,820
off of MSHDA without an issue so again a

1090
00:34:59,820 --> 00:35:01,830
lot of issues that that with microsoft

1091
00:35:01,830 --> 00:35:03,750
code signing applications that give us

1092
00:35:03,750 --> 00:35:05,700
code execution functionality but it

1093
00:35:05,700 --> 00:35:07,890
comes into sharing you wouldn't know

1094
00:35:07,890 --> 00:35:09,080
about that if you weren't here today

1095
00:35:09,080 --> 00:35:11,160
your blue team probably would know about

1096
00:35:11,160 --> 00:35:12,270
unless you tested it out on their red

1097
00:35:12,270 --> 00:35:14,190
team your thread hunters wouldn't have

1098
00:35:14,190 --> 00:35:15,060
known about unless they've seen in the

1099
00:35:15,060 --> 00:35:16,980
wild before all of those pieces of

1100
00:35:16,980 --> 00:35:18,240
knowledge coming together to work

1101
00:35:18,240 --> 00:35:19,890
together collaborate work really really

1102
00:35:19,890 --> 00:35:21,290
well

1103
00:35:21,290 --> 00:35:24,910
number four behavior

1104
00:35:24,910 --> 00:35:27,460
focus on and Jeff Moss nailed this on

1105
00:35:27,460 --> 00:35:28,960
the head was last year at black head

1106
00:35:28,960 --> 00:35:30,280
before he introduced the keynote and

1107
00:35:30,280 --> 00:35:33,309
Jeff Moss said as an industry we are

1108
00:35:33,309 --> 00:35:35,470
focusing solely on a techniques and we

1109
00:35:35,470 --> 00:35:36,970
have no idea what the tactics and

1110
00:35:36,970 --> 00:35:39,640
procedures of attackers are any spot on

1111
00:35:39,640 --> 00:35:41,710
100% right mitre attack is a great

1112
00:35:41,710 --> 00:35:43,180
example minor attack is a great

1113
00:35:43,180 --> 00:35:45,069
phenomenal resource this is don't get me

1114
00:35:45,069 --> 00:35:46,450
wrong it's great a walk through a lot of

1115
00:35:46,450 --> 00:35:47,380
techniques allows you to do some

1116
00:35:47,380 --> 00:35:49,180
simulations in your environment but it

1117
00:35:49,180 --> 00:35:51,579
is not a cheat sheet for detection not

1118
00:35:51,579 --> 00:35:52,630
what it was designed for if you're

1119
00:35:52,630 --> 00:35:54,130
trying to do whack-a-mole detections off

1120
00:35:54,130 --> 00:35:56,770
of the technique section of miter your

1121
00:35:56,770 --> 00:35:58,329
programs probably missing a substantial

1122
00:35:58,329 --> 00:35:59,500
amount of gaps when it comes to

1123
00:35:59,500 --> 00:36:00,460
attacking and I would say it's probably

1124
00:36:00,460 --> 00:36:01,839
pretty easy to circumvent your detection

1125
00:36:01,839 --> 00:36:04,150
criteria so we are focused on the

1126
00:36:04,150 --> 00:36:05,650
techniques not tactics or procedures so

1127
00:36:05,650 --> 00:36:07,660
once we realize that we can start to

1128
00:36:07,660 --> 00:36:09,369
look at what that means to switch more

1129
00:36:09,369 --> 00:36:11,230
to the tactics and procedures behaviors

1130
00:36:11,230 --> 00:36:14,140
and behavior is a loosely level term

1131
00:36:14,140 --> 00:36:16,089
across this entire industry but again a

1132
00:36:16,089 --> 00:36:19,059
behavior why is Mary in sales using

1133
00:36:19,059 --> 00:36:20,740
PowerShell in the first place that's a

1134
00:36:20,740 --> 00:36:22,210
good baseline that's a good behavior

1135
00:36:22,210 --> 00:36:22,780
right

1136
00:36:22,780 --> 00:36:25,480
why is red Jessica r32 bikini on to the

1137
00:36:25,480 --> 00:36:26,859
internet when it has it before in our

1138
00:36:26,859 --> 00:36:28,329
while in the wild ever before in the

1139
00:36:28,329 --> 00:36:28,720
past

1140
00:36:28,720 --> 00:36:30,339
those are great behaviors in your

1141
00:36:30,339 --> 00:36:32,140
environment things that you can count on

1142
00:36:32,140 --> 00:36:33,549
to look for things again

1143
00:36:33,549 --> 00:36:35,049
is it gonna generate false positive

1144
00:36:35,049 --> 00:36:37,599
absolutely can't we minimize those false

1145
00:36:37,599 --> 00:36:38,980
positives in baseline environment sure

1146
00:36:38,980 --> 00:36:40,960
you know do we need people to do that

1147
00:36:40,960 --> 00:36:43,480
yes I already said that earlier today so

1148
00:36:43,480 --> 00:36:44,380
those are some of the things that we'd

1149
00:36:44,380 --> 00:36:46,569
be focused on a good example of a

1150
00:36:46,569 --> 00:36:49,270
behavior as I was going into a company

1151
00:36:49,270 --> 00:36:52,059
doing a threat hunting exercise and it

1152
00:36:52,059 --> 00:36:53,410
was one of those engagements where the

1153
00:36:53,410 --> 00:36:55,750
first minute you sit down like I got it

1154
00:36:55,750 --> 00:36:58,450
I got him I got a good one and it was an

1155
00:36:58,450 --> 00:37:00,220
exchange server running as a system

1156
00:37:00,220 --> 00:37:01,270
account on exchange sure which also

1157
00:37:01,270 --> 00:37:04,720
happen to be a DC it wasn't exposed to

1158
00:37:04,720 --> 00:37:06,150
Internet thank God that was one

1159
00:37:06,150 --> 00:37:08,740
interesting piece about there but it's

1160
00:37:08,740 --> 00:37:11,920
also DC and the best part about it was

1161
00:37:11,920 --> 00:37:14,349
they had a PowerShell script that was

1162
00:37:14,349 --> 00:37:16,150
going every every night at 2:00 o'clock

1163
00:37:16,150 --> 00:37:18,039
in the morning going to China and

1164
00:37:18,039 --> 00:37:20,079
downloading a binary directly into

1165
00:37:20,079 --> 00:37:21,910
memory through PowerShell right non code

1166
00:37:21,910 --> 00:37:23,559
sign all other good stuff right and I'm

1167
00:37:23,559 --> 00:37:25,779
like I sit then I see this attack and

1168
00:37:25,779 --> 00:37:27,760
I'm like I just made my money for this

1169
00:37:27,760 --> 00:37:30,279
one I'm good I got a PT in here you know

1170
00:37:30,279 --> 00:37:32,170
I got some I got some hackers you know

1171
00:37:32,170 --> 00:37:33,579
we're gonna dive into this everything's

1172
00:37:33,579 --> 00:37:35,529
fine not like you know go to the

1173
00:37:35,529 --> 00:37:37,599
customer I'm like hey I hate to be the

1174
00:37:37,599 --> 00:37:38,440
bearer bad

1175
00:37:38,440 --> 00:37:40,720
but you're breech like really bad like

1176
00:37:40,720 --> 00:37:42,550
domain controllers and command and

1177
00:37:42,550 --> 00:37:43,960
control and also their stuff

1178
00:37:43,960 --> 00:37:45,940
and it's like oh my gosh and it starts

1179
00:37:45,940 --> 00:37:47,079
bringing up this instant response team

1180
00:37:47,079 --> 00:37:48,700
we start looking at it and it turns out

1181
00:37:48,700 --> 00:37:49,900
they have a third-party marketing

1182
00:37:49,900 --> 00:37:51,339
company does metrics offer the exchanged

1183
00:37:51,339 --> 00:37:52,480
performance it's out of China that

1184
00:37:52,480 --> 00:37:54,339
downloads unquote signed binaries at two

1185
00:37:54,339 --> 00:37:56,410
o'clock in the morning apparently and

1186
00:37:56,410 --> 00:37:59,460
it's perfectly legitimate that's fine

1187
00:37:59,460 --> 00:38:04,240
IDC hey HCP as well which is even better

1188
00:38:04,240 --> 00:38:05,920
you know it's like it's like literally

1189
00:38:05,920 --> 00:38:07,480
every step of the way right and it's

1190
00:38:07,480 --> 00:38:08,890
like they're using attacker techniques

1191
00:38:08,890 --> 00:38:10,450
or code is IP skated you're leveraging

1192
00:38:10,450 --> 00:38:11,740
and voc expression to go and download

1193
00:38:11,740 --> 00:38:12,970
code record from Internet all great

1194
00:38:12,970 --> 00:38:14,560
stuff right so these are things that we

1195
00:38:14,560 --> 00:38:15,940
typically see an environment where like

1196
00:38:15,940 --> 00:38:17,140
hey I found something that's a behavior

1197
00:38:17,140 --> 00:38:18,579
I'd want to know that that behaviors

1198
00:38:18,579 --> 00:38:19,839
there but I can baseline and look for

1199
00:38:19,839 --> 00:38:22,720
other things in our environment right so

1200
00:38:22,720 --> 00:38:24,130
visibility becomes critical I'm going to

1201
00:38:24,130 --> 00:38:25,510
show you an example here in just a

1202
00:38:25,510 --> 00:38:28,150
second of getting around visibility or a

1203
00:38:28,150 --> 00:38:29,920
lot of the traditional protection

1204
00:38:29,920 --> 00:38:32,109
mechanisms that we have but protection

1205
00:38:32,109 --> 00:38:33,970
takes time and and the biggest piece

1206
00:38:33,970 --> 00:38:35,200
that you can walk away out here with is

1207
00:38:35,200 --> 00:38:37,150
that while protection takes time we can

1208
00:38:37,150 --> 00:38:38,710
augment things with detection to get

1209
00:38:38,710 --> 00:38:40,180
better and faster what we're doing a

1210
00:38:40,180 --> 00:38:42,430
good example is when that DD OTO came

1211
00:38:42,430 --> 00:38:43,780
out a couple years ago right I mean

1212
00:38:43,780 --> 00:38:46,000
remember that DD OTO came out as a way

1213
00:38:46,000 --> 00:38:47,500
to get remote code execution if Excel

1214
00:38:47,500 --> 00:38:49,540
files about macros right and so with

1215
00:38:49,540 --> 00:38:50,800
that Microsoft said at the time they

1216
00:38:50,800 --> 00:38:51,970
work in a patch they eventually end up

1217
00:38:51,970 --> 00:38:53,500
doing it based on the damage and crits

1218
00:38:53,500 --> 00:38:56,410
here it had with DD auto it was being

1219
00:38:56,410 --> 00:38:57,810
used in the wild within seven hours

1220
00:38:57,810 --> 00:39:01,150
seven hours we saw ransomware campaigns

1221
00:39:01,150 --> 00:39:03,190
hitting it could you implement changes

1222
00:39:03,190 --> 00:39:04,780
in your environment within seven hours

1223
00:39:04,780 --> 00:39:08,079
across your entire organization probably

1224
00:39:08,079 --> 00:39:10,420
not right but can we detect certain

1225
00:39:10,420 --> 00:39:11,650
things in our environment than seven

1226
00:39:11,650 --> 00:39:13,569
hours probably we're getting the right

1227
00:39:13,569 --> 00:39:15,310
sources of information right so again

1228
00:39:15,310 --> 00:39:17,020
detection becomes much faster much more

1229
00:39:17,020 --> 00:39:19,000
nimble we still focus on protection

1230
00:39:19,000 --> 00:39:20,589
because we're not giving up on that we

1231
00:39:20,589 --> 00:39:21,940
still need to focus on those detection

1232
00:39:21,940 --> 00:39:24,160
pieces and being faster some quick brief

1233
00:39:24,160 --> 00:39:26,140
statistics this is over binary defense

1234
00:39:26,140 --> 00:39:27,819
we analyzed a bunch of code code

1235
00:39:27,819 --> 00:39:30,250
execution samples and what we found is

1236
00:39:30,250 --> 00:39:32,380
that 82 percent I said 84 I apologize I

1237
00:39:32,380 --> 00:39:33,579
got this that wrong I did get the

1238
00:39:33,579 --> 00:39:36,400
numbers wrong being it 82% are

1239
00:39:36,400 --> 00:39:38,650
executables so still to this day a

1240
00:39:38,650 --> 00:39:42,819
choose executables 13% is PowerShell 4%

1241
00:39:42,819 --> 00:39:43,930
is living off the land by owners and

1242
00:39:43,930 --> 00:39:45,280
scripts so living off the lands very

1243
00:39:45,280 --> 00:39:47,680
small number the one that most companies

1244
00:39:47,680 --> 00:39:48,910
are probably trying to focus the most on

1245
00:39:48,910 --> 00:39:50,079
when they're not even getting PowerShell

1246
00:39:50,079 --> 00:39:52,150
logs not focusing on

1247
00:39:52,150 --> 00:39:53,470
allowing executables in their user

1248
00:39:53,470 --> 00:39:55,270
directories and again our priorities

1249
00:39:55,270 --> 00:39:58,920
become completely skewed and different

1250
00:40:01,740 --> 00:40:04,990
lets customer data aggregated our EDR

1251
00:40:04,990 --> 00:40:07,329
pieces for it and then we and our sim

1252
00:40:07,329 --> 00:40:11,770
pieces for correct things that actually

1253
00:40:11,770 --> 00:40:16,390
made it ten points yep some breakout

1254
00:40:16,390 --> 00:40:19,150
time frames on average it took about an

1255
00:40:19,150 --> 00:40:21,160
hour and a half almost two hours to

1256
00:40:21,160 --> 00:40:22,960
break out of a specific system so when a

1257
00:40:22,960 --> 00:40:25,089
machine becomes compromised what happens

1258
00:40:25,089 --> 00:40:26,529
from there you know how do they move out

1259
00:40:26,529 --> 00:40:27,640
and spray laterally across the

1260
00:40:27,640 --> 00:40:28,750
environments about an hour and a half so

1261
00:40:28,750 --> 00:40:30,700
us as defenders we have about an hour

1262
00:40:30,700 --> 00:40:32,289
and a half time frame to respond to that

1263
00:40:32,289 --> 00:40:34,000
specific incident and then go from there

1264
00:40:34,000 --> 00:40:36,730
right here's the thing if an attacker

1265
00:40:36,730 --> 00:40:39,940
customizes anything anything at all they

1266
00:40:39,940 --> 00:40:42,369
typically go undetected and what I mean

1267
00:40:42,369 --> 00:40:44,680
by by that is our reliance on tools and

1268
00:40:44,680 --> 00:40:46,260
technology those tools themselves

1269
00:40:46,260 --> 00:40:49,119
typically go on notice now where I get

1270
00:40:49,119 --> 00:40:52,390
busted it's not from a tool I get bust

1271
00:40:52,390 --> 00:40:55,029
it is from people and so every time I go

1272
00:40:55,029 --> 00:40:56,109
into an organization we already know how

1273
00:40:56,109 --> 00:40:57,789
to get past the CDR product and this

1274
00:40:57,789 --> 00:40:59,710
antivirus product and this specific

1275
00:40:59,710 --> 00:41:00,819
protection mechanism you know exactly

1276
00:41:00,819 --> 00:41:01,450
what we're doing

1277
00:41:01,450 --> 00:41:03,220
when we get tripped up it's by people

1278
00:41:03,220 --> 00:41:04,450
doing creative things we're looking at

1279
00:41:04,450 --> 00:41:07,029
unusual behavior customized stuff works

1280
00:41:07,029 --> 00:41:09,700
take a technique modify it anyway again

1281
00:41:09,700 --> 00:41:11,770
to the three carrots versus two carrots

1282
00:41:11,770 --> 00:41:14,260
throwing seven carats thrown done

1283
00:41:14,260 --> 00:41:16,180
carrots you can highly a piece key

1284
00:41:16,180 --> 00:41:17,260
attend carrots I'm telling you I am

1285
00:41:17,260 --> 00:41:19,510
you'll read the code at that boy oh you

1286
00:41:19,510 --> 00:41:20,740
know what to do with time carrots that's

1287
00:41:20,740 --> 00:41:24,309
some G stuff right there build your own

1288
00:41:24,309 --> 00:41:26,230
bait detection for sure right a good

1289
00:41:26,230 --> 00:41:28,920
example of this is I wrote a tool in

1290
00:41:28,920 --> 00:41:32,380
2011 note started 2013 and it was a

1291
00:41:32,380 --> 00:41:34,150
simple command and control

1292
00:41:34,150 --> 00:41:36,490
infrastructure that uses HTTP and an

1293
00:41:36,490 --> 00:41:37,539
advanced encryption standard to

1294
00:41:37,539 --> 00:41:38,859
communicate over and was a bike compiled

1295
00:41:38,859 --> 00:41:40,599
Python program okay and it was

1296
00:41:40,599 --> 00:41:41,680
downloaded over a million times the

1297
00:41:41,680 --> 00:41:43,180
trusted second what it would do is it

1298
00:41:43,180 --> 00:41:46,390
wash a shell over HTTP or https over AES

1299
00:41:46,390 --> 00:41:48,160
and allow you to communicate back and

1300
00:41:48,160 --> 00:41:50,260
forth I uploaded the virus soldiers to

1301
00:41:50,260 --> 00:41:51,490
kind of take a look at how it get

1302
00:41:51,490 --> 00:41:52,809
attacked because you know unquote signed

1303
00:41:52,809 --> 00:41:54,819
binary malicious is all hack been

1304
00:41:54,819 --> 00:41:56,170
downloaded a million times in the wild

1305
00:41:56,170 --> 00:42:00,099
and three out of the 67 or so actually

1306
00:42:00,099 --> 00:42:01,270
detected as malicious which I thought

1307
00:42:01,270 --> 00:42:01,960
was pretty amazing

1308
00:42:01,960 --> 00:42:04,480
um so again you have to customize

1309
00:42:04,480 --> 00:42:05,980
anything just use what was already a

1310
00:42:05,980 --> 00:42:07,119
available out there to me today just

1311
00:42:07,119 --> 00:42:09,280
kind of obscure let's do a demonstration

1312
00:42:09,280 --> 00:42:10,390
real quick now I'm gonna show you a

1313
00:42:10,390 --> 00:42:13,660
video and I'm gonna do it live so here's

1314
00:42:13,660 --> 00:42:15,850
an example of let me get the play button

1315
00:42:15,850 --> 00:42:18,910
if I can find my mouse again no I'm uh

1316
00:42:18,910 --> 00:42:22,020
supposed to have sound on that hang on

1317
00:42:25,890 --> 00:42:28,630
there we go okay so we're gonna run

1318
00:42:28,630 --> 00:42:30,520
unicorn and now I'm gonna do is I'm you

1319
00:42:30,520 --> 00:42:31,619
something out of the box meterpreter

1320
00:42:31,619 --> 00:42:34,390
Metasploit okay and Metasploit is very

1321
00:42:34,390 --> 00:42:35,740
commoditized would you see a lot of

1322
00:42:35,740 --> 00:42:36,940
folks use it so you know if you just

1323
00:42:36,940 --> 00:42:38,560
take it out the box it'll get detected

1324
00:42:38,560 --> 00:42:40,210
by antivirus or something else we're

1325
00:42:40,210 --> 00:42:42,190
gonna have a call back to 172 16 2 2 1

1326
00:42:42,190 --> 00:42:45,070
at 171 up 43 we're gonna go ahead and

1327
00:42:45,070 --> 00:42:46,780
just decode it really quick you'll see

1328
00:42:46,780 --> 00:42:48,910
the code here in a second I'm just gonna

1329
00:42:48,910 --> 00:42:54,940
decode the values here ly fast and I'm

1330
00:42:54,940 --> 00:42:56,530
gonna get the raw code that's gonna be

1331
00:42:56,530 --> 00:42:58,000
executing the system and what's gonna be

1332
00:42:58,000 --> 00:43:00,070
seen by a Messire the anti-malware scan

1333
00:43:00,070 --> 00:43:04,060
interface run it here's the code

1334
00:43:04,060 --> 00:43:06,550
it's obfuscated and of course now we're

1335
00:43:06,550 --> 00:43:07,810
gonna go and paste this over to the

1336
00:43:07,810 --> 00:43:09,220
powershell interpreter over here on the

1337
00:43:09,220 --> 00:43:10,810
right hand side we're also gonna start a

1338
00:43:10,810 --> 00:43:12,010
listener for Metasploit as well at the

1339
00:43:12,010 --> 00:43:13,359
same time so that we have something to

1340
00:43:13,359 --> 00:43:14,590
catch our shell in the event that were

1341
00:43:14,590 --> 00:43:17,380
successful so over here you can see we

1342
00:43:17,380 --> 00:43:20,200
have our partial interpreter and we're

1343
00:43:20,200 --> 00:43:23,470
gonna run MSF console and over here

1344
00:43:23,470 --> 00:43:24,040
gonna hit play

1345
00:43:24,040 --> 00:43:25,630
oh no it's kind of blurry buddy but we

1346
00:43:25,630 --> 00:43:27,100
got stopped by a Maasai the anti-malware

1347
00:43:27,100 --> 00:43:30,100
scan interface blocked us and it's it's

1348
00:43:30,100 --> 00:43:32,740
a virus what we're gonna do here it's

1349
00:43:32,740 --> 00:43:34,030
really quick is we're gonna take a look

1350
00:43:34,030 --> 00:43:35,800
and say whoa I wonder what part of the

1351
00:43:35,800 --> 00:43:37,930
code is actually getting detected by

1352
00:43:37,930 --> 00:43:41,050
antivirus okay let's go and run that so

1353
00:43:41,050 --> 00:43:43,390
I just cut that out and I hit play well

1354
00:43:43,390 --> 00:43:45,070
ok it doesn't get picked up and apart so

1355
00:43:45,070 --> 00:43:46,720
the last line of my code is getting

1356
00:43:46,720 --> 00:43:48,700
picked up by in averse so man must be a

1357
00:43:48,700 --> 00:43:50,710
really good detection I'm sure what if I

1358
00:43:50,710 --> 00:43:55,350
create a variable let's copy that line

1359
00:43:55,470 --> 00:44:00,149
and paste it it can't be that easy

1360
00:44:00,500 --> 00:44:06,230
yep it is so so funny story Bob does you

1361
00:44:06,230 --> 00:44:07,220
get your shot anything else is great

1362
00:44:07,220 --> 00:44:08,810
right funny story about this one

1363
00:44:08,810 --> 00:44:12,320
specifically is that unicorn went for

1364
00:44:12,320 --> 00:44:13,609
years undetected years and years and

1365
00:44:13,609 --> 00:44:14,450
years and make something to get more

1366
00:44:14,450 --> 00:44:15,380
popular and they started writing

1367
00:44:15,380 --> 00:44:17,630
antivirus signatures for okay and it

1368
00:44:17,630 --> 00:44:19,130
became a battle between Microsoft and

1369
00:44:19,130 --> 00:44:20,480
myself I'm sure I have horrible horrible

1370
00:44:20,480 --> 00:44:22,340
names being called on me over there any

1371
00:44:22,340 --> 00:44:23,630
great folks are there by the way I love

1372
00:44:23,630 --> 00:44:24,770
everything they're doing in there

1373
00:44:24,770 --> 00:44:27,320
getting better but when the funny parts

1374
00:44:27,320 --> 00:44:28,730
was is that they started writing

1375
00:44:28,730 --> 00:44:30,440
signatures for defender every single

1376
00:44:30,440 --> 00:44:33,200
week so I got upset and one week I

1377
00:44:33,200 --> 00:44:34,609
decided I'm like you know what I'm gonna

1378
00:44:34,609 --> 00:44:36,050
spend a week and write a program that

1379
00:44:36,050 --> 00:44:37,820
does all this for me automatically and

1380
00:44:37,820 --> 00:44:39,349
so what it would do is it would go and

1381
00:44:39,349 --> 00:44:42,560
check out the latest defender signatures

1382
00:44:42,560 --> 00:44:44,420
it would check to see if it got hit by

1383
00:44:44,420 --> 00:44:46,099
antivirus if it got hit by antivirus it

1384
00:44:46,099 --> 00:44:47,780
automatically rewrite the code for me I

1385
00:44:47,780 --> 00:44:49,849
wrote a PowerShell interpreter for

1386
00:44:49,849 --> 00:44:51,920
Python in it it would rewrite for me it

1387
00:44:51,920 --> 00:44:53,599
would do had integrated into get lab

1388
00:44:53,599 --> 00:44:55,430
checks so we've built and passed make

1389
00:44:55,430 --> 00:44:56,630
sure I got a shell back and everything I

1390
00:44:56,630 --> 00:44:58,070
oughta made my whole framework and it'll

1391
00:44:58,070 --> 00:44:59,630
automatically do a pull request for me

1392
00:44:59,630 --> 00:45:01,160
to see whether or not it got past it so

1393
00:45:01,160 --> 00:45:02,599
within about 30 seconds of a new

1394
00:45:02,599 --> 00:45:04,280
signature being released I already had a

1395
00:45:04,280 --> 00:45:06,740
bypass already up on github I'm gonna

1396
00:45:06,740 --> 00:45:08,359
need it so that went out for like two

1397
00:45:08,359 --> 00:45:11,480
months and they finally gave up this is

1398
00:45:11,480 --> 00:45:15,380
pretty good feel bad for the folks out

1399
00:45:15,380 --> 00:45:16,460
writing that by the way I mean that is

1400
00:45:16,460 --> 00:45:24,170
suck so here's a version I'll show you a

1401
00:45:24,170 --> 00:45:27,770
funny thing here some quirks sometimes

1402
00:45:27,770 --> 00:45:28,970
it works sometimes it doesn't but let me

1403
00:45:28,970 --> 00:45:31,400
show you an example here you got me

1404
00:45:31,400 --> 00:45:32,480
running the latest and greatest

1405
00:45:32,480 --> 00:45:34,550
I got a listener up here right now I'm

1406
00:45:34,550 --> 00:45:36,800
sure my IP didn't change over the course

1407
00:45:36,800 --> 00:45:37,790
of talking here which has happened

1408
00:45:37,790 --> 00:45:38,240
before

1409
00:45:38,240 --> 00:45:40,820
go ahead play we're gonna run our code

1410
00:45:40,820 --> 00:45:45,710
out of unicorn I notice here I got a

1411
00:45:45,710 --> 00:45:47,930
virus threat protection found right got

1412
00:45:47,930 --> 00:45:51,759
busted whatever is if I hit play again

1413
00:45:53,640 --> 00:46:06,280
it works no dia just to prove that I'm

1414
00:46:06,280 --> 00:46:11,040
not not crazy here we're on that box so

1415
00:46:11,040 --> 00:46:16,420
so just run your coat twice and you're

1416
00:46:16,420 --> 00:46:18,340
fine I don't understand what's going on

1417
00:46:18,340 --> 00:46:19,330
here anymore

1418
00:46:19,330 --> 00:46:21,700
you could also circumvent this by if you

1419
00:46:21,700 --> 00:46:28,210
do something like couple examples so I

1420
00:46:28,210 --> 00:46:30,220
run this code here this is the decoded

1421
00:46:30,220 --> 00:46:33,070
code you just take these this dis Bob

1422
00:46:33,070 --> 00:46:34,510
here which is all your shellcode and

1423
00:46:34,510 --> 00:46:36,820
just replace it with instead of using

1424
00:46:36,820 --> 00:46:38,620
like symbols you just replace it with

1425
00:46:38,620 --> 00:46:40,570
numeric values like like five five five

1426
00:46:40,570 --> 00:46:42,730
five five it also circumvents all the

1427
00:46:42,730 --> 00:46:43,750
detection rights here up there as well

1428
00:46:43,750 --> 00:46:48,130
again really hard stuff okay to do makes

1429
00:46:48,130 --> 00:46:53,050
me lose sleep at night Oh another funny

1430
00:46:53,050 --> 00:46:54,700
quirk about that I was testing unicorn

1431
00:46:54,700 --> 00:46:58,480
one time and I'd run a command and then

1432
00:46:58,480 --> 00:47:00,460
run another command and then it was for

1433
00:47:00,460 --> 00:47:01,720
some reason who'd be like this is being

1434
00:47:01,720 --> 00:47:03,220
blocked by Hannover stone would work

1435
00:47:03,220 --> 00:47:04,660
well my second one my third one fourth

1436
00:47:04,660 --> 00:47:05,710
one wouldn't work and then I realized

1437
00:47:05,710 --> 00:47:07,990
there was a bug in defender where if you

1438
00:47:07,990 --> 00:47:09,160
submitted something in PowerShell from

1439
00:47:09,160 --> 00:47:10,330
the command line if for some reason

1440
00:47:10,330 --> 00:47:12,190
their their logic layer started marking

1441
00:47:12,190 --> 00:47:14,260
every single command as malicious so if

1442
00:47:14,260 --> 00:47:16,810
you did like a equals one it like you're

1443
00:47:16,810 --> 00:47:18,910
being blocked by antivirus equals to

1444
00:47:18,910 --> 00:47:20,290
being Wi-Fi antivirus you have to

1445
00:47:20,290 --> 00:47:21,880
restart your computer to get rid of that

1446
00:47:21,880 --> 00:47:22,840
that's a big bug that they actually

1447
00:47:22,840 --> 00:47:24,640
ended up fixing which is good so that's

1448
00:47:24,640 --> 00:47:25,960
kind of all over the place I'm not sure

1449
00:47:25,960 --> 00:47:27,280
exactly what's going on over there

1450
00:47:27,280 --> 00:47:32,250
Oh still in the

1451
00:47:38,769 --> 00:47:42,259
there we go so number five leadership

1452
00:47:42,259 --> 00:47:44,179
people leadership and communication is

1453
00:47:44,179 --> 00:47:46,939
extremely important where I see most

1454
00:47:46,939 --> 00:47:49,819
programs fail as not having the right

1455
00:47:49,819 --> 00:47:51,739
leadership in place and what I mean by

1456
00:47:51,739 --> 00:47:54,349
that is when I was I was the chief

1457
00:47:54,349 --> 00:47:55,699
security officer for Diebold for a

1458
00:47:55,699 --> 00:47:57,439
number of years and when I got the

1459
00:47:57,439 --> 00:47:59,029
Diebold there's actually a great talk

1460
00:47:59,029 --> 00:48:02,390
over at Derby Con this year that I gave

1461
00:48:02,390 --> 00:48:05,689
him and my CIO came and one of the two

1462
00:48:05,689 --> 00:48:06,739
of the folks that I work with on a

1463
00:48:06,739 --> 00:48:08,089
security team came we all talked about

1464
00:48:08,089 --> 00:48:09,499
how we were successful at our company

1465
00:48:09,499 --> 00:48:11,539
and what was interesting is that the CIO

1466
00:48:11,539 --> 00:48:14,359
and me were best friends and we worked

1467
00:48:14,359 --> 00:48:16,039
together to do what was right for that

1468
00:48:16,039 --> 00:48:17,779
company and no matter what it was and

1469
00:48:17,779 --> 00:48:19,130
whether it was hey you're being too

1470
00:48:19,130 --> 00:48:20,749
crazy on security well Duke it out and

1471
00:48:20,749 --> 00:48:21,859
figure it out in the parking lot you

1472
00:48:21,859 --> 00:48:23,660
know we're just friends trying to figure

1473
00:48:23,660 --> 00:48:24,650
things out in the right way of doing

1474
00:48:24,650 --> 00:48:26,929
things and we got more accomplished in

1475
00:48:26,929 --> 00:48:28,609
three years than I've seen any other

1476
00:48:28,609 --> 00:48:31,279
program moving in five or ten and a lot

1477
00:48:31,279 --> 00:48:32,449
of that had to do with my first became

1478
00:48:32,449 --> 00:48:33,619
the chief security officer over a

1479
00:48:33,619 --> 00:48:36,109
Diebold what did i do that i repel

1480
00:48:36,109 --> 00:48:38,749
technology no did I go and I hire a

1481
00:48:38,749 --> 00:48:40,670
whole bunch of people no I wouldn't I

1482
00:48:40,670 --> 00:48:41,660
bought a whole bunch of beer and pizza

1483
00:48:41,660 --> 00:48:43,789
for the IT folks like like a whole bunch

1484
00:48:43,789 --> 00:48:45,769
of times and because I became friends

1485
00:48:45,769 --> 00:48:47,299
with them like hey I have your back you

1486
00:48:47,299 --> 00:48:48,739
have mine one of the funny stories that

1487
00:48:48,739 --> 00:48:50,509
I had with Diebold is that at the time

1488
00:48:50,509 --> 00:48:51,739
we were looking at implementing scan

1489
00:48:51,739 --> 00:48:54,410
safe which was it got acquired by Cisco

1490
00:48:54,410 --> 00:48:56,359
and scan see was a phenomenal product

1491
00:48:56,359 --> 00:48:58,219
the way that they did at the time is

1492
00:48:58,219 --> 00:48:59,390
they had these things called beacon

1493
00:48:59,390 --> 00:49:01,789
servers and you could basically proxy

1494
00:49:01,789 --> 00:49:03,049
chain your beacon servers so that you

1495
00:49:03,049 --> 00:49:04,819
didn't go out 18 four four three across

1496
00:49:04,819 --> 00:49:06,799
your environment anymore okay so my goal

1497
00:49:06,799 --> 00:49:09,170
was to disallow all egress ports period

1498
00:49:09,170 --> 00:49:10,640
and only allow 18 for for three four

1499
00:49:10,640 --> 00:49:13,130
specific exceptions and 21 for specific

1500
00:49:13,130 --> 00:49:14,660
exceptions across our entire global

1501
00:49:14,660 --> 00:49:16,910
enterprise ok it's pretty awesome peak

1502
00:49:16,910 --> 00:49:19,519
right no egress ports whatsoever and 84

1503
00:49:19,519 --> 00:49:21,019
for 3 completely gone across the entire

1504
00:49:21,019 --> 00:49:22,939
network you can't egress out 84 for 3

1505
00:49:22,939 --> 00:49:24,799
unless you go out through the proxy and

1506
00:49:24,799 --> 00:49:27,019
then hit with scan safe which is SSL

1507
00:49:27,019 --> 00:49:28,130
termination and everything else we had

1508
00:49:28,130 --> 00:49:31,249
good visibility into and so I had this

1509
00:49:31,249 --> 00:49:32,749
project where it should take a normal

1510
00:49:32,749 --> 00:49:34,130
company probably what a year to

1511
00:49:34,130 --> 00:49:35,029
implement something like that right

1512
00:49:35,029 --> 00:49:37,130
across your globe maybe six months did

1513
00:49:37,130 --> 00:49:39,920
in three weeks and the way that I did it

1514
00:49:39,920 --> 00:49:44,839
is as I tried to find a a we were a big

1515
00:49:44,839 --> 00:49:47,179
ITIL shop okay and I found a change

1516
00:49:47,179 --> 00:49:48,469
control request that had to do something

1517
00:49:48,469 --> 00:49:49,849
with like tweaking this can save server

1518
00:49:49,849 --> 00:49:51,980
and I'm like hey mark and Marcos in

1519
00:49:51,980 --> 00:49:53,750
and networking he's like I'm like hey

1520
00:49:53,750 --> 00:49:55,820
man I'm like can you uh can you just

1521
00:49:55,820 --> 00:49:57,530
make this one rule I think I got

1522
00:49:57,530 --> 00:49:58,940
everything done but quemic this one rule

1523
00:49:58,940 --> 00:50:00,500
we are blocking 84 for three across the

1524
00:50:00,500 --> 00:50:02,750
entire company and he's like man I think

1525
00:50:02,750 --> 00:50:03,740
that's a good idea you're gonna break

1526
00:50:03,740 --> 00:50:05,660
some stuff I'm like it's okay there's

1527
00:50:05,660 --> 00:50:06,950
this there's this change control thing

1528
00:50:06,950 --> 00:50:09,980
here that that you know is kind of like

1529
00:50:09,980 --> 00:50:11,869
that it kind of sounds like it so he can

1530
00:50:11,869 --> 00:50:13,280
just tuck underneath there and see if it

1531
00:50:13,280 --> 00:50:14,900
works and he's like nah man I'm not

1532
00:50:14,900 --> 00:50:16,040
gonna do it so I went to when it's a

1533
00:50:16,040 --> 00:50:18,080
Scott there's a guy next to him like hey

1534
00:50:18,080 --> 00:50:21,080
man can you get Haiti for four three two

1535
00:50:21,080 --> 00:50:22,850
cross the network and it's kind of like

1536
00:50:22,850 --> 00:50:24,170
he's like you say I think it's a good

1537
00:50:24,170 --> 00:50:25,760
idea and I'm like listen you're getting

1538
00:50:25,760 --> 00:50:27,290
trouble I'll take all the blame for it

1539
00:50:27,290 --> 00:50:29,359
okay and so we ended up doing this

1540
00:50:29,359 --> 00:50:30,500
sweeping change across our entire

1541
00:50:30,500 --> 00:50:32,000
company within three weeks and broke our

1542
00:50:32,000 --> 00:50:33,350
entire production instances of where

1543
00:50:33,350 --> 00:50:36,320
they produced a TMZ because they used

1544
00:50:36,320 --> 00:50:38,630
these signing to sign the actual boards

1545
00:50:38,630 --> 00:50:41,330
for each ATM and stop production of all

1546
00:50:41,330 --> 00:50:42,859
our manufacturing facilities for both of

1547
00:50:42,859 --> 00:50:44,060
those like I was like poor horse wasn't

1548
00:50:44,060 --> 00:50:47,300
a big deal but but good enough we didn't

1549
00:50:47,300 --> 00:50:48,710
get in any trouble whatsoever because it

1550
00:50:48,710 --> 00:50:50,000
was a specific change we're trying to

1551
00:50:50,000 --> 00:50:51,109
accomplish across our entire environment

1552
00:50:51,109 --> 00:50:52,970
and so you know funny stories like that

1553
00:50:52,970 --> 00:50:54,440
a story after story to store we had a

1554
00:50:54,440 --> 00:50:55,790
customer application where I

1555
00:50:55,790 --> 00:50:57,470
accidentally found on blind sequel

1556
00:50:57,470 --> 00:50:59,720
injection and and I overrode everybody's

1557
00:50:59,720 --> 00:51:01,820
password the same one on accident and

1558
00:51:01,820 --> 00:51:04,940
completely crash the application yeah so

1559
00:51:04,940 --> 00:51:06,260
you learn you're right Oz and I was

1560
00:51:06,260 --> 00:51:07,760
younger and younger Dave younger Dave

1561
00:51:07,760 --> 00:51:11,150
but the piece I wanted to hit with this

1562
00:51:11,150 --> 00:51:13,070
and then the leadership piece was like

1563
00:51:13,070 --> 00:51:14,570
the folks that I worked with knew that I

1564
00:51:14,570 --> 00:51:15,619
had their back no matter what if they

1565
00:51:15,619 --> 00:51:17,450
messed up or if I messed up we had each

1566
00:51:17,450 --> 00:51:19,430
other's backs no matter what I would go

1567
00:51:19,430 --> 00:51:20,780
to bat for them I would make sure that

1568
00:51:20,780 --> 00:51:22,910
they had the right resources to be able

1569
00:51:22,910 --> 00:51:24,260
to accomplish what they needed to do

1570
00:51:24,260 --> 00:51:26,180
leadership is really really important

1571
00:51:26,180 --> 00:51:28,640
people is really really important to

1572
00:51:28,640 --> 00:51:30,320
have people to go and do things to help

1573
00:51:30,320 --> 00:51:32,570
you out communication is really really

1574
00:51:32,570 --> 00:51:34,130
important I didn't just go and do things

1575
00:51:34,130 --> 00:51:35,570
and just like hey I'm gonna shut this

1576
00:51:35,570 --> 00:51:37,400
down and that's that I worked with

1577
00:51:37,400 --> 00:51:39,020
people and communicating this those

1578
00:51:39,020 --> 00:51:40,040
specific things with why we're doing

1579
00:51:40,040 --> 00:51:44,000
things to an organization well then I'll

1580
00:51:44,000 --> 00:51:46,070
say is that if you can't make a change

1581
00:51:46,070 --> 00:51:49,490
in a company move on i time and time

1582
00:51:49,490 --> 00:51:51,020
again i go to a person or organization

1583
00:51:51,020 --> 00:51:52,670
like man we really want to come in

1584
00:51:52,670 --> 00:51:53,930
because i want you to smash our entire

1585
00:51:53,930 --> 00:51:55,580
company because our IT folks are just

1586
00:51:55,580 --> 00:51:57,530
won't do anything we're doing and I'm

1587
00:51:57,530 --> 00:51:59,180
the only person in security and they

1588
00:51:59,180 --> 00:52:00,220
don't want to do anything we have

1589
00:52:00,220 --> 00:52:02,150
100,000 people and there's one person

1590
00:52:02,150 --> 00:52:03,590
that a key to the security you know this

1591
00:52:03,590 --> 00:52:05,390
is this is you know my struggle every

1592
00:52:05,390 --> 00:52:05,809
single day

1593
00:52:05,809 --> 00:52:07,069
I'm just fighting fires every day and I

1594
00:52:07,069 --> 00:52:09,170
can't do it anymore if you can't make a

1595
00:52:09,170 --> 00:52:10,579
change in a company that you're working

1596
00:52:10,579 --> 00:52:12,439
with it's time to move on move to a

1597
00:52:12,439 --> 00:52:14,209
place that will make a change move to a

1598
00:52:14,209 --> 00:52:16,189
company that wants to change in the way

1599
00:52:16,189 --> 00:52:17,689
to get better for information security

1600
00:52:17,689 --> 00:52:19,729
and I'm a huge advocate of that you if

1601
00:52:19,729 --> 00:52:20,869
you're at a place where you're no longer

1602
00:52:20,869 --> 00:52:22,219
feeling effective or you've already done

1603
00:52:22,219 --> 00:52:23,839
your job you've already left your legacy

1604
00:52:23,839 --> 00:52:25,160
on to that's--that's is that into that

1605
00:52:25,160 --> 00:52:26,809
organization go somewhere else and do it

1606
00:52:26,809 --> 00:52:28,939
again it's awesome it's exciting it's

1607
00:52:28,939 --> 00:52:30,170
fun it's exhilarating you do new things

1608
00:52:30,170 --> 00:52:31,579
you get to figure things out in a

1609
00:52:31,579 --> 00:52:32,209
different way

1610
00:52:32,209 --> 00:52:33,890
all those things become really really

1611
00:52:33,890 --> 00:52:38,420
important so I'm closing the five things

1612
00:52:38,420 --> 00:52:40,609
right I talked about what I talked about

1613
00:52:40,609 --> 00:52:43,849
I remember sharing a collaboration right

1614
00:52:43,849 --> 00:52:46,729
leadership and communication behavior

1615
00:52:46,729 --> 00:52:48,499
right what was the other one I press the

1616
00:52:48,499 --> 00:52:50,420
other one the basics there we go the

1617
00:52:50,420 --> 00:52:52,430
basics that I was looking for the basics

1618
00:52:52,430 --> 00:52:54,589
all of those things make up what we are

1619
00:52:54,589 --> 00:52:56,599
today insecurity and and it's really

1620
00:52:56,599 --> 00:52:58,489
easy to get sucked into hey I need to

1621
00:52:58,489 --> 00:52:59,660
start going off these living off the

1622
00:52:59,660 --> 00:53:01,009
land by owners and scripts and blocking

1623
00:53:01,009 --> 00:53:02,059
all this stuff when we still have half

1624
00:53:02,059 --> 00:53:03,739
or one out there focusing on the basics

1625
00:53:03,739 --> 00:53:05,329
becomes really really important in your

1626
00:53:05,329 --> 00:53:06,829
environment collaborating with people

1627
00:53:06,829 --> 00:53:09,769
becomes really really important what are

1628
00:53:09,769 --> 00:53:12,019
you doing I thought I was getting

1629
00:53:12,019 --> 00:53:20,689
smirnoff ice here for a second so I say

1630
00:53:20,689 --> 00:53:22,849
you know what's really awesome is is

1631
00:53:22,849 --> 00:53:25,729
events like this like b-sides is amazing

1632
00:53:25,729 --> 00:53:28,549
when he's like hey can you come out here

1633
00:53:28,549 --> 00:53:30,589
and speak at b-sides I make sure what's

1634
00:53:30,589 --> 00:53:31,699
the date let me make sure it works not

1635
00:53:31,699 --> 00:53:33,019
fly on a plane come on here in two

1636
00:53:33,019 --> 00:53:34,670
seconds you know it's amazing that we

1637
00:53:34,670 --> 00:53:36,049
have a community of people that want to

1638
00:53:36,049 --> 00:53:37,579
share their experiences that want to

1639
00:53:37,579 --> 00:53:39,679
work together to collectively make the

1640
00:53:39,679 --> 00:53:40,849
world a better place and that's exactly

1641
00:53:40,849 --> 00:53:42,679
what we're doing so you know we're

1642
00:53:42,679 --> 00:53:43,880
working together figuring things out

1643
00:53:43,880 --> 00:53:45,019
we're making things better and I could

1644
00:53:45,019 --> 00:53:46,999
say again I've been in this industry for

1645
00:53:46,999 --> 00:53:49,069
a long time it's like 18 years which is

1646
00:53:49,069 --> 00:53:50,900
really friggin weird that I have been in

1647
00:53:50,900 --> 00:53:54,160
this industry for 18 years 19 years

1648
00:53:54,160 --> 00:53:57,380
2000-2001 got into the security space 19

1649
00:53:57,380 --> 00:53:59,509
years almost 20 years which is horrible

1650
00:53:59,509 --> 00:54:02,719
I mean I'm not getting old you know 20

1651
00:54:02,719 --> 00:54:04,369
years in one individual industry and I

1652
00:54:04,369 --> 00:54:06,109
can say over the span of 20 years we've

1653
00:54:06,109 --> 00:54:07,759
gotten so much better as an industry

1654
00:54:07,759 --> 00:54:08,869
working in case you need to do that

1655
00:54:08,869 --> 00:54:10,640
again and see your point earlier in your

1656
00:54:10,640 --> 00:54:12,380
presentation you know paving the way for

1657
00:54:12,380 --> 00:54:14,029
our next generation of kids getting out

1658
00:54:14,029 --> 00:54:14,959
of the way and stop being that that

1659
00:54:14,959 --> 00:54:16,279
person's like hey you need to you know

1660
00:54:16,279 --> 00:54:17,660
build your own cat5 cables in order to

1661
00:54:17,660 --> 00:54:18,349
get a job here

1662
00:54:18,349 --> 00:54:19,490
you know things

1663
00:54:19,490 --> 00:54:21,170
changed quite a bit in 20 years it's no

1664
00:54:21,170 --> 00:54:22,910
longer on mudding days anymore it's no

1665
00:54:22,910 --> 00:54:25,010
longer you know modems and BBS is you

1666
00:54:25,010 --> 00:54:26,060
know we're doing things in a different

1667
00:54:26,060 --> 00:54:27,410
way that we had before and it's better

1668
00:54:27,410 --> 00:54:29,480
it's not it's just better I love all

1669
00:54:29,480 --> 00:54:30,950
these showstoppers when the cloud came

1670
00:54:30,950 --> 00:54:32,300
like we were gonna stop in the first

1671
00:54:32,300 --> 00:54:35,119
place really or even even waterfall like

1672
00:54:35,119 --> 00:54:37,490
we're not gonna eventually go to agile

1673
00:54:37,490 --> 00:54:39,590
to get stuff out faster like hey what

1674
00:54:39,590 --> 00:54:40,760
you're saying is that I can get all my

1675
00:54:40,760 --> 00:54:42,050
stuff out way faster and I'd have to

1676
00:54:42,050 --> 00:54:43,850
hire anymore resources yeah but it's

1677
00:54:43,850 --> 00:54:45,020
gonna be a whole bunch of bugs in it but

1678
00:54:45,020 --> 00:54:48,080
Han you said I can get it out faster and

1679
00:54:48,080 --> 00:54:49,460
get some across yeah but it's gonna be

1680
00:54:49,460 --> 00:54:51,170
security holes no what you said is it's

1681
00:54:51,170 --> 00:54:53,810
gonna be out faster like that was gonna

1682
00:54:53,810 --> 00:54:55,790
stop a business right or a cloud hey we

1683
00:54:55,790 --> 00:54:57,470
don't have to hire all IT folks which by

1684
00:54:57,470 --> 00:54:59,390
the way best thing ever right hey you

1685
00:54:59,390 --> 00:55:00,800
get to move to the cloud you have to

1686
00:55:00,800 --> 00:55:02,630
worry about IT folks you'll have to

1687
00:55:02,630 --> 00:55:04,160
worry about you know scalability of

1688
00:55:04,160 --> 00:55:08,480
everything is that true no cetera in

1689
00:55:08,480 --> 00:55:10,790
fact I would say are the past nine

1690
00:55:10,790 --> 00:55:13,790
engagements that I've done going after

1691
00:55:13,790 --> 00:55:15,530
our cloud environment I've broken into

1692
00:55:15,530 --> 00:55:17,990
every single nine one of those cloud

1693
00:55:17,990 --> 00:55:19,160
environments based on configuration

1694
00:55:19,160 --> 00:55:20,900
issues so again doesn't mean necessarily

1695
00:55:20,900 --> 00:55:22,460
better anyways we're all working

1696
00:55:22,460 --> 00:55:23,930
together to come together to get better

1697
00:55:23,930 --> 00:55:25,850
what we're doing and so let's continue

1698
00:55:25,850 --> 00:55:27,710
to make the world a safer place in

1699
00:55:27,710 --> 00:55:29,450
security I think we're all doing that

1700
00:55:29,450 --> 00:55:29,990
right now

1701
00:55:29,990 --> 00:55:31,609
share your experiences figure out what

1702
00:55:31,609 --> 00:55:33,410
makes you unique and and share those

1703
00:55:33,410 --> 00:55:34,700
experiences here great on stage and

1704
00:55:34,700 --> 00:55:35,900
start talking about this so that's what

1705
00:55:35,900 --> 00:55:37,820
makes us an amazing collaborative

1706
00:55:37,820 --> 00:55:38,990
industry and it's just going to continue

1707
00:55:38,990 --> 00:55:40,970
to grow as it is and just want to give a

1708
00:55:40,970 --> 00:55:43,040
special shout out to Jack Daniel over

1709
00:55:43,040 --> 00:55:44,540
there for all the stuff he does for

1710
00:55:44,540 --> 00:55:47,710
b-sides let's give a round of applause

1711
00:55:50,890 --> 00:55:53,210
that is an incredible man right there

1712
00:55:53,210 --> 00:55:54,739
one that I've gotten to known or the

1713
00:55:54,739 --> 00:55:55,880
many years and Jack probably didn't even

1714
00:55:55,880 --> 00:55:57,319
know the story about when I first got

1715
00:55:57,319 --> 00:55:59,180
introduced to Jack Daniel if he goes at

1716
00:55:59,180 --> 00:56:02,299
shmoocon two or three Jack was out

1717
00:56:02,299 --> 00:56:03,890
ranting and raving about something

1718
00:56:03,890 --> 00:56:06,259
cybersecurity at the UH Nepal security

1719
00:56:06,259 --> 00:56:07,969
weekly podcast on the outside area there

1720
00:56:07,969 --> 00:56:09,799
and I was like man this guy's really

1721
00:56:09,799 --> 00:56:10,940
really smart and I just sat down and

1722
00:56:10,940 --> 00:56:12,229
listened to him and since then I've been

1723
00:56:12,229 --> 00:56:14,150
a follower of Jack for was we've gone

1724
00:56:14,150 --> 00:56:16,249
through what do we got now I don't even

1725
00:56:16,249 --> 00:56:17,690
know it's been lots

1726
00:56:17,690 --> 00:56:19,789
I guess that we're getting old so you

1727
00:56:19,789 --> 00:56:21,680
know 15 years or whatnot so you know

1728
00:56:21,680 --> 00:56:23,299
it's incredible person over there so

1729
00:56:23,299 --> 00:56:24,559
again makes things again Jack for all

1730
00:56:24,559 --> 00:56:25,729
you do so thank you all very much for

1731
00:56:25,729 --> 00:56:26,989
coming out to my talk I hope you learned

1732
00:56:26,989 --> 00:56:28,039
something new

1733
00:56:28,039 --> 00:56:29,299
you know remember three carats

1734
00:56:29,299 --> 00:56:30,859
completely bypass anything else out

1735
00:56:30,859 --> 00:56:33,140
there you're all set but I think you all

1736
00:56:33,140 --> 00:56:34,170
very much besides appreciate

1737
00:56:34,170 --> 00:56:36,630
[Applause]

