1
00:00:16,379 --> 00:00:18,580
goodmornin hackers well today I'm going

2
00:00:18,580 --> 00:00:20,529
to be talking about the rise of

3
00:00:20,529 --> 00:00:23,710
ransomware a little bit about myself i

4
00:00:23,710 --> 00:00:26,830
am a malware researcher at fish me and

5
00:00:26,830 --> 00:00:29,380
one of my passions dealing with malware

6
00:00:29,380 --> 00:00:31,210
is taking a look those malware families

7
00:00:31,210 --> 00:00:33,970
that utilize PHP panels and finding you

8
00:00:33,970 --> 00:00:35,290
know vulnerabilities within that

9
00:00:35,290 --> 00:00:37,380
particular malware command and control

10
00:00:37,380 --> 00:00:39,520
some of my hobbies include playing the

11
00:00:39,520 --> 00:00:42,340
drums and listening to music and as you

12
00:00:42,340 --> 00:00:43,720
mentioned every now and then I'll tweet

13
00:00:43,720 --> 00:00:47,469
out things from at heck slacks so feel

14
00:00:47,469 --> 00:00:49,000
free to hit me up on there or my work

15
00:00:49,000 --> 00:00:55,330
email let's go over our agenda for today

16
00:00:55,330 --> 00:00:56,800
so we'll talk about what is ransomware

17
00:00:56,800 --> 00:00:59,590
some common practices regardless of the

18
00:00:59,590 --> 00:01:03,490
family and we'll also dive into three

19
00:01:03,490 --> 00:01:05,319
particular families you may have heard

20
00:01:05,319 --> 00:01:07,479
about these in the news recently being

21
00:01:07,479 --> 00:01:10,720
crypto wall tesla crypt and locky will

22
00:01:10,720 --> 00:01:12,220
also talk about some mitigation steps

23
00:01:12,220 --> 00:01:14,560
and i'll not only that the end user or

24
00:01:14,560 --> 00:01:17,409
residential user can implement but also

25
00:01:17,409 --> 00:01:19,210
what you can do within your organization

26
00:01:19,210 --> 00:01:23,080
and finally also have a video demo of a

27
00:01:23,080 --> 00:01:26,880
live infection that i record it for you

28
00:01:27,300 --> 00:01:30,520
first a little disclaimer though anytime

29
00:01:30,520 --> 00:01:32,020
that you play with malware make sure

30
00:01:32,020 --> 00:01:33,880
you're doing it in a properly segmented

31
00:01:33,880 --> 00:01:36,100
lab don't be the one that you know

32
00:01:36,100 --> 00:01:38,350
infects your organization and this

33
00:01:38,350 --> 00:01:40,120
presentation may contain links so if you

34
00:01:40,120 --> 00:01:42,070
have your laptop your mobile phone and

35
00:01:42,070 --> 00:01:43,450
the audience please don't visit those

36
00:01:43,450 --> 00:01:49,479
that wouldn't be good for you all right

37
00:01:49,479 --> 00:01:51,070
so what is ransomware rain somewhere is

38
00:01:51,070 --> 00:01:52,900
the type of malware that restricts

39
00:01:52,900 --> 00:01:54,820
access to the infected computer system

40
00:01:54,820 --> 00:01:58,570
in way in some way most notably usually

41
00:01:58,570 --> 00:02:00,040
through some type of file encryption

42
00:02:00,040 --> 00:02:04,810
process and the way that what the

43
00:02:04,810 --> 00:02:07,210
malware actors are monetizing that is

44
00:02:07,210 --> 00:02:09,489
that they will restrict that access back

45
00:02:09,489 --> 00:02:12,569
to a file usually with some type of

46
00:02:12,569 --> 00:02:15,640
digital currency that the victim has to

47
00:02:15,640 --> 00:02:20,590
pay usually in Bitcoin so show of hands

48
00:02:20,590 --> 00:02:22,360
who here has been ravaged by ransomware

49
00:02:22,360 --> 00:02:24,730
either their home computers or the

50
00:02:24,730 --> 00:02:27,189
organization I know Lance admitting that

51
00:02:27,189 --> 00:02:28,400
he got popped earlier

52
00:02:28,400 --> 00:02:33,560
yeah yeah hey you know somebody usually

53
00:02:33,560 --> 00:02:36,860
uh I gave this talk not so long ago in

54
00:02:36,860 --> 00:02:39,110
Birmingham and quite a few hands went up

55
00:02:39,110 --> 00:02:41,360
over there and I was like okay well

56
00:02:41,360 --> 00:02:43,879
leave your hand in the air if you paid

57
00:02:43,879 --> 00:02:46,609
the ransom and everyone's like yeah kind

58
00:02:46,609 --> 00:02:49,310
of not really wanting to admit it but

59
00:02:49,310 --> 00:02:50,659
unfortunately I mean there's really no

60
00:02:50,659 --> 00:02:53,299
other way to get those files back I mean

61
00:02:53,299 --> 00:02:55,760
it's very strong cryptography and

62
00:02:55,760 --> 00:02:57,739
encryption that they're utilizing to

63
00:02:57,739 --> 00:03:01,159
hold those files to ransom you may have

64
00:03:01,159 --> 00:03:03,200
heard about these events recently in the

65
00:03:03,200 --> 00:03:05,090
news Hollywood Presbyterian Medical

66
00:03:05,090 --> 00:03:07,879
Center februari of 2016 paid a ransom of

67
00:03:07,879 --> 00:03:10,549
40 bitcoins roughly at the time

68
00:03:10,549 --> 00:03:13,430
seventeen thousand dollars us so you can

69
00:03:13,430 --> 00:03:14,810
read about that incident they actually

70
00:03:14,810 --> 00:03:16,340
released a memo on the website it's

71
00:03:16,340 --> 00:03:18,620
pretty interesting and Methodist

72
00:03:18,620 --> 00:03:20,930
Hospital hint in Henderson Kentucky

73
00:03:20,930 --> 00:03:24,319
March of 2016 they declared an internal

74
00:03:24,319 --> 00:03:26,930
state of emergency due to a locky

75
00:03:26,930 --> 00:03:29,150
infection screenshot of their website

76
00:03:29,150 --> 00:03:31,340
with that huge regiment red banner at

77
00:03:31,340 --> 00:03:33,169
the top saying that you know we've got

78
00:03:33,169 --> 00:03:35,780
popped by ransomware this was brought to

79
00:03:35,780 --> 00:03:38,780
light by Krebs Brian Krebs his website

80
00:03:38,780 --> 00:03:41,120
Krebs on security and like I mentioned

81
00:03:41,120 --> 00:03:43,129
earlier you know organizations they

82
00:03:43,129 --> 00:03:44,359
might have no choice but to pay that

83
00:03:44,359 --> 00:03:46,819
ransom especially if its credit business

84
00:03:46,819 --> 00:03:51,040
critical files that have been encrypted

85
00:03:51,879 --> 00:03:54,889
some common practices regardless of the

86
00:03:54,889 --> 00:03:57,620
ransomware family on encrypt files with

87
00:03:57,620 --> 00:04:00,709
very strong asymmetric crypto so even if

88
00:04:00,709 --> 00:04:02,629
you had all of the computing resources

89
00:04:02,629 --> 00:04:04,310
within the world it will still take you

90
00:04:04,310 --> 00:04:06,049
hundreds if not thousands of years to

91
00:04:06,049 --> 00:04:08,959
break this type of cryptography most of

92
00:04:08,959 --> 00:04:10,879
these families that I'll go over they

93
00:04:10,879 --> 00:04:14,239
utilize on The Onion Router or tour for

94
00:04:14,239 --> 00:04:16,760
command and control relaying victim

95
00:04:16,760 --> 00:04:18,370
instructions and also the backend

96
00:04:18,370 --> 00:04:21,260
databases that handle payment

97
00:04:21,260 --> 00:04:24,979
verification deletes shadow copies and

98
00:04:24,979 --> 00:04:29,139
windows snapshots so as you can imagine

99
00:04:29,139 --> 00:04:32,150
you want to prohibit the user from

100
00:04:32,150 --> 00:04:33,740
rolling back from previous file

101
00:04:33,740 --> 00:04:35,539
snapshots so they usually just delete

102
00:04:35,539 --> 00:04:38,330
those out what we have also seen too is

103
00:04:38,330 --> 00:04:41,210
that some of the lesser known variants

104
00:04:41,210 --> 00:04:42,110
that are just now coming

105
00:04:42,110 --> 00:04:43,790
into the wall they might masquerade or

106
00:04:43,790 --> 00:04:47,120
pretend to be a more well-known crypto

107
00:04:47,120 --> 00:04:50,450
wolf are crypto ransomware family mainly

108
00:04:50,450 --> 00:04:52,880
to entice a user that you know in the

109
00:04:52,880 --> 00:04:54,860
event that they pay that they will get

110
00:04:54,860 --> 00:04:58,010
their files back most of these are

111
00:04:58,010 --> 00:05:00,920
installed via exploit kits be it

112
00:05:00,920 --> 00:05:03,890
drive-by download attacks or massive

113
00:05:03,890 --> 00:05:07,460
spam campaigns and one other thing that

114
00:05:07,460 --> 00:05:08,780
we've seen is that most of these

115
00:05:08,780 --> 00:05:11,000
families they private are privatized

116
00:05:11,000 --> 00:05:14,240
network shares / local drives right so

117
00:05:14,240 --> 00:05:15,410
as you can imagine within an

118
00:05:15,410 --> 00:05:17,510
organization some of these malware

119
00:05:17,510 --> 00:05:19,220
families they're wanting to encrypt

120
00:05:19,220 --> 00:05:22,070
those files located on network shares

121
00:05:22,070 --> 00:05:24,320
prior to worrying about files on local

122
00:05:24,320 --> 00:05:26,540
drives main reason being you know that's

123
00:05:26,540 --> 00:05:27,590
obviously going to affect more people

124
00:05:27,590 --> 00:05:30,650
and that organization is probably more

125
00:05:30,650 --> 00:05:32,240
willing to pay that ransom to get those

126
00:05:32,240 --> 00:05:35,990
files back and as mentioned early to a

127
00:05:35,990 --> 00:05:39,770
digital currency usually Bitcoin so

128
00:05:39,770 --> 00:05:41,300
let's explore three of the notorious

129
00:05:41,300 --> 00:05:44,570
families in the news first one being

130
00:05:44,570 --> 00:05:46,700
crypto wall so the latest version of

131
00:05:46,700 --> 00:05:49,190
this was version 4.0 first seen in

132
00:05:49,190 --> 00:05:52,970
November 2015 and although recently you

133
00:05:52,970 --> 00:05:56,240
know in the media they kind of portray

134
00:05:56,240 --> 00:05:58,070
this as being a very new threat but

135
00:05:58,070 --> 00:06:00,440
crypto wall obviously has been around

136
00:06:00,440 --> 00:06:03,950
for a while so it's definitely not a new

137
00:06:03,950 --> 00:06:07,880
issue when it comes to ransomware the

138
00:06:07,880 --> 00:06:09,590
way that this infects the system is

139
00:06:09,590 --> 00:06:12,740
processed by process Halloween or DLL

140
00:06:12,740 --> 00:06:14,870
injection usually into Explorer

141
00:06:14,870 --> 00:06:18,290
svchost.exe and also has a reboot

142
00:06:18,290 --> 00:06:20,620
persistence via registry run key

143
00:06:20,620 --> 00:06:23,570
encrypts the file names and files with a

144
00:06:23,570 --> 00:06:27,320
very strong RSA 2048 key deletes the

145
00:06:27,320 --> 00:06:29,830
shadow copies as most of them do and

146
00:06:29,830 --> 00:06:32,630
there was some actor attribution behind

147
00:06:32,630 --> 00:06:36,230
this particular family the author of a

148
00:06:36,230 --> 00:06:40,190
hymen exploit kit was doxxed and what

149
00:06:40,190 --> 00:06:44,090
they noticed is that the the development

150
00:06:44,090 --> 00:06:45,950
of hymen dropped as soon as crypto wall

151
00:06:45,950 --> 00:06:48,110
came out so the idea being that this

152
00:06:48,110 --> 00:06:51,140
particular author stopped doing exploit

153
00:06:51,140 --> 00:06:52,730
kit development and then went on to

154
00:06:52,730 --> 00:06:55,969
ransomware first seen as cryptolocker

155
00:06:55,969 --> 00:07:00,079
clone in November 2013 and the actors

156
00:07:00,079 --> 00:07:01,849
actually abandoned the back end so right

157
00:07:01,849 --> 00:07:04,689
now although there might be some

158
00:07:04,689 --> 00:07:06,769
variants that are still being spread in

159
00:07:06,769 --> 00:07:10,009
the while of crypto wall the back end

160
00:07:10,009 --> 00:07:13,759
panel or the database that handles you

161
00:07:13,759 --> 00:07:15,559
know monetary transactions to verify

162
00:07:15,559 --> 00:07:18,559
ransom payments completely down so it's

163
00:07:18,559 --> 00:07:21,589
no longer really a threat but as we've

164
00:07:21,589 --> 00:07:23,689
seen with previous crime where families

165
00:07:23,689 --> 00:07:26,869
you know especially Sue's that the

166
00:07:26,869 --> 00:07:28,729
source code leak of that has spawned

167
00:07:28,729 --> 00:07:30,379
several variants so we're definitely

168
00:07:30,379 --> 00:07:32,899
keeping our ear to the ground to see if

169
00:07:32,899 --> 00:07:35,929
that's the case as law enforcement is

170
00:07:35,929 --> 00:07:37,699
closing in on this guy because of the

171
00:07:37,699 --> 00:07:42,669
the daxing of the the particular author

172
00:07:45,939 --> 00:07:48,889
here's a little snapshot here of the

173
00:07:48,889 --> 00:07:51,139
version history and this was taken from

174
00:07:51,139 --> 00:07:53,419
Krypto wall tracker org was very good

175
00:07:53,419 --> 00:07:54,619
website if you want to learn more about

176
00:07:54,619 --> 00:07:58,549
crypto wall has quite a few things about

177
00:07:58,549 --> 00:08:01,789
the family and attribution as well first

178
00:08:01,789 --> 00:08:04,279
started in November 20 2013 as i said as

179
00:08:04,279 --> 00:08:06,829
cryptolocker clone renamed itself crypto

180
00:08:06,829 --> 00:08:09,829
defense and then in March of 2014 we

181
00:08:09,829 --> 00:08:13,369
have crypto wolverton for I'm sorry

182
00:08:13,369 --> 00:08:17,300
crypto wall version one started one of

183
00:08:17,300 --> 00:08:19,699
the pretty funny things that you can

184
00:08:19,699 --> 00:08:22,099
take a look at as far as attributions

185
00:08:22,099 --> 00:08:25,699
concerned is to see which countries are

186
00:08:25,699 --> 00:08:28,279
excluded from execution for these

187
00:08:28,279 --> 00:08:31,610
particular families and as you can see

188
00:08:31,610 --> 00:08:36,068
here the map you know mostly the Russian

189
00:08:36,068 --> 00:08:38,839
kind of gives way to the attribution of

190
00:08:38,839 --> 00:08:41,860
this particular family

191
00:08:45,129 --> 00:08:48,319
here's a little snapshot of a typical

192
00:08:48,319 --> 00:08:50,269
campaign overview including the

193
00:08:50,269 --> 00:08:53,540
infrastructure hitting crypto wall so

194
00:08:53,540 --> 00:08:57,860
usually a je s downloader is included in

195
00:08:57,860 --> 00:08:59,660
a zip archive that's attached to an

196
00:08:59,660 --> 00:09:01,459
email and I'll go more into the

197
00:09:01,459 --> 00:09:03,350
JavaScript downloaders here in a minute

198
00:09:03,350 --> 00:09:06,139
that's massively spammed out and poor

199
00:09:06,139 --> 00:09:08,209
granny clicks on that and infects your

200
00:09:08,209 --> 00:09:10,899
computer that's then communicating with

201
00:09:10,899 --> 00:09:14,720
PHP proxy which is usually just one flat

202
00:09:14,720 --> 00:09:17,059
PHP file hosted on a compromised website

203
00:09:17,059 --> 00:09:20,300
which then again creates like a curl

204
00:09:20,300 --> 00:09:23,420
wrapper for any post information that's

205
00:09:23,420 --> 00:09:25,850
in fords that back to another proxy

206
00:09:25,850 --> 00:09:28,249
server usually provokes your engine X

207
00:09:28,249 --> 00:09:30,800
and then that gets forwarded back to the

208
00:09:30,800 --> 00:09:36,649
tor hidden web service here's an actual

209
00:09:36,649 --> 00:09:40,100
example of a email lure that dropped

210
00:09:40,100 --> 00:09:43,189
crypto ball so information regarding

211
00:09:43,189 --> 00:09:45,170
your order and promotional offer can be

212
00:09:45,170 --> 00:09:47,660
found in the attachment below again with

213
00:09:47,660 --> 00:09:51,019
a zip archive attachment zip archive

214
00:09:51,019 --> 00:09:54,379
contains a dot jas file which when

215
00:09:54,379 --> 00:09:57,290
double clicked on windows execute just

216
00:09:57,290 --> 00:09:59,779
like a dot exe so this is actually

217
00:09:59,779 --> 00:10:02,059
obvious gated JavaScript that's executed

218
00:10:02,059 --> 00:10:04,009
by window scripting hosts and it's

219
00:10:04,009 --> 00:10:09,949
usually a heavily obvious skated this

220
00:10:09,949 --> 00:10:11,660
downloaded then reaches out usually to

221
00:10:11,660 --> 00:10:14,180
another compromise site or a engine X

222
00:10:14,180 --> 00:10:16,610
proxy that hosts the second stage

223
00:10:16,610 --> 00:10:22,339
payload and once that executes it does a

224
00:10:22,339 --> 00:10:27,980
series of check-ins over HTTP POST so

225
00:10:27,980 --> 00:10:30,279
pictured right set the actual PHP

226
00:10:30,279 --> 00:10:32,929
backend source code for this particular

227
00:10:32,929 --> 00:10:36,649
file and as you can see on line two they

228
00:10:36,649 --> 00:10:39,559
just statically hard code the IP address

229
00:10:39,559 --> 00:10:43,730
of that third tier engine X proxy that

230
00:10:43,730 --> 00:10:45,259
would then communicate to the tor hidden

231
00:10:45,259 --> 00:10:48,829
web service back end on the cool thing

232
00:10:48,829 --> 00:10:51,529
though since this is over HTTP being a

233
00:10:51,529 --> 00:10:53,509
plaintext protocol there are some really

234
00:10:53,509 --> 00:10:56,990
good secure ekada hits or signatures

235
00:10:56,990 --> 00:10:58,140
that emerging threat

236
00:10:58,140 --> 00:11:01,320
even in there at the free version ET

237
00:11:01,320 --> 00:11:03,030
Trojan crypto while checking as you can

238
00:11:03,030 --> 00:11:04,350
see the screen shot down at the bottom

239
00:11:04,350 --> 00:11:12,270
there in a squeal GUI and this is what

240
00:11:12,270 --> 00:11:15,240
our poor grandma sees on her desktop so

241
00:11:15,240 --> 00:11:18,150
not only is it pop up a image file PNG

242
00:11:18,150 --> 00:11:20,100
within the windows photo viewer of the

243
00:11:20,100 --> 00:11:22,800
instructions on how she can you know get

244
00:11:22,800 --> 00:11:25,230
her files decrypted but also usually

245
00:11:25,230 --> 00:11:27,990
drops a HTML file which is rendered in

246
00:11:27,990 --> 00:11:29,670
the background there in the default

247
00:11:29,670 --> 00:11:35,970
browser the same instructions so as I

248
00:11:35,970 --> 00:11:38,670
mentioned earlier yonathan here tweeted

249
00:11:38,670 --> 00:11:41,100
out March 28th that he noticed the back

250
00:11:41,100 --> 00:11:44,160
end monitoring yonathan being the actual

251
00:11:44,160 --> 00:11:46,920
curator of crypto well track org so

252
00:11:46,920 --> 00:11:48,450
you'd been monitoring this particular

253
00:11:48,450 --> 00:11:50,400
crew for a while and noticed that the

254
00:11:50,400 --> 00:11:53,730
the back end completely went down as you

255
00:11:53,730 --> 00:11:56,850
can see down at the bottom graph from

256
00:11:56,850 --> 00:12:00,620
ransomware abuse eh they track several

257
00:12:00,620 --> 00:12:04,590
crypto ransomware families it's a really

258
00:12:04,590 --> 00:12:07,230
cool website to get a little bit better

259
00:12:07,230 --> 00:12:10,080
idea of how far spread this particular

260
00:12:10,080 --> 00:12:12,060
threat is so definitely check them out

261
00:12:12,060 --> 00:12:13,740
and it's a you know in sharp decline

262
00:12:13,740 --> 00:12:15,390
there was probably one blimp there at

263
00:12:15,390 --> 00:12:17,640
april twenty seventh but if i had to

264
00:12:17,640 --> 00:12:18,540
guess i was probably just some

265
00:12:18,540 --> 00:12:26,190
researcher that was messing around any

266
00:12:26,190 --> 00:12:28,500
uh any questions so far encrypt the wall

267
00:12:28,500 --> 00:12:31,340
yeah

268
00:12:36,020 --> 00:12:39,120
yeah yeah that's the case but um as far

269
00:12:39,120 --> 00:12:40,670
as I understand this particular family

270
00:12:40,670 --> 00:12:43,950
it does do a check-in prior to

271
00:12:43,950 --> 00:12:46,890
encrypting so in the event that you know

272
00:12:46,890 --> 00:12:48,240
this is still being spread by some

273
00:12:48,240 --> 00:12:50,250
automated spam campaign that was set up

274
00:12:50,250 --> 00:12:54,870
way back yeah well yeah at least it

275
00:12:54,870 --> 00:12:56,430
won't be you know infecting your

276
00:12:56,430 --> 00:12:58,260
computer or encrypting the files at

277
00:12:58,260 --> 00:13:05,130
least good question yeah okay I like

278
00:13:05,130 --> 00:13:18,470
those yeah that's a good question yeah

279
00:13:18,470 --> 00:13:22,110
yeah I mean there the problem is is that

280
00:13:22,110 --> 00:13:24,360
they're utilizing encryption that you

281
00:13:24,360 --> 00:13:26,070
know is mathematically sound and what

282
00:13:26,070 --> 00:13:27,660
i'll i'll go over and one of the

283
00:13:27,660 --> 00:13:29,970
families there are some vaccinations or

284
00:13:29,970 --> 00:13:33,570
even some bugs with in the

285
00:13:33,570 --> 00:13:37,860
implementation of that so it's not

286
00:13:37,860 --> 00:13:39,839
usually that the the encryptions flaw

287
00:13:39,839 --> 00:13:41,430
that you know someone can break the

288
00:13:41,430 --> 00:13:43,380
encryption because that's not the case

289
00:13:43,380 --> 00:13:46,010
it's that how that was implemented right

290
00:13:46,010 --> 00:13:49,440
so what we'll see with locking I'll talk

291
00:13:49,440 --> 00:13:50,870
about this here in a minute there was a

292
00:13:50,870 --> 00:13:54,360
trick to you could populate a particular

293
00:13:54,360 --> 00:13:57,360
registry key with a public key on that

294
00:13:57,360 --> 00:13:59,459
to which you already have the private

295
00:13:59,459 --> 00:14:00,810
key for so than the event that you were

296
00:14:00,810 --> 00:14:02,550
infected with walkie you already have

297
00:14:02,550 --> 00:14:04,260
that private key pair and could decrypt

298
00:14:04,260 --> 00:14:07,220
your files so there's usually bugs or

299
00:14:07,220 --> 00:14:10,200
vaccinations that's due to the

300
00:14:10,200 --> 00:14:12,330
implementation but not necessarily you

301
00:14:12,330 --> 00:14:14,850
know a flaw or zero day within the equip

302
00:14:14,850 --> 00:14:17,779
shin itself

303
00:14:20,160 --> 00:14:23,100
I'm moving on to Tesla crib so the

304
00:14:23,100 --> 00:14:24,660
current version right now is actually

305
00:14:24,660 --> 00:14:27,990
4.2 and this was released or seen in the

306
00:14:27,990 --> 00:14:29,699
wild just as recently as April

307
00:14:29,699 --> 00:14:31,949
twenty-eighth encrypt files with very

308
00:14:31,949 --> 00:14:36,240
strong RSA key of 4096 and yeah we kind

309
00:14:36,240 --> 00:14:38,129
of touched on this earlier so version 3

310
00:14:38,129 --> 00:14:40,439
had a bug within its implementation that

311
00:14:40,439 --> 00:14:43,560
allowed you to decrypt the files that

312
00:14:43,560 --> 00:14:48,810
was published by Talos which Talos Intel

313
00:14:48,810 --> 00:14:50,009
I think they were bought out by Cisco

314
00:14:50,009 --> 00:14:53,850
recently and so you're able to get your

315
00:14:53,850 --> 00:14:56,100
files back but you know sure enough not

316
00:14:56,100 --> 00:14:58,949
even like a month after that these guys

317
00:14:58,949 --> 00:15:00,600
went ahead and patched it went with

318
00:15:00,600 --> 00:15:02,220
their release of version four point oh

319
00:15:02,220 --> 00:15:05,389
so that decoder to tool no longer works

320
00:15:05,389 --> 00:15:07,709
persistence again for reboots via

321
00:15:07,709 --> 00:15:10,949
registry ronke and this has been seen

322
00:15:10,949 --> 00:15:12,540
dispersed in the wild via the angler

323
00:15:12,540 --> 00:15:14,399
exploit kit and of course your massive

324
00:15:14,399 --> 00:15:18,420
mouth spam campaigns but this family was

325
00:15:18,420 --> 00:15:20,819
also first seen in march of 2015 so this

326
00:15:20,819 --> 00:15:24,349
has been around for a while as well

327
00:15:25,250 --> 00:15:27,600
here's a snapshot of the the version

328
00:15:27,600 --> 00:15:30,029
history so again starting in march 2

329
00:15:30,029 --> 00:15:32,880
2015 is when we fought first scene

330
00:15:32,880 --> 00:15:36,360
version 1 of tesla crypt and version 2

331
00:15:36,360 --> 00:15:38,970
kicking off in november 2015 and then

332
00:15:38,970 --> 00:15:40,560
from there it looks like they're

333
00:15:40,560 --> 00:15:42,170
pivoting to almost like a bi-monthly

334
00:15:42,170 --> 00:15:45,240
release cycle like even scheduled on

335
00:15:45,240 --> 00:15:48,089
those so although you have minor

336
00:15:48,089 --> 00:15:49,649
versions that release the past couple

337
00:15:49,649 --> 00:15:51,899
weeks we'll probably see version 5 here

338
00:15:51,899 --> 00:15:59,009
in the next couple weeks so yeah yeah it

339
00:15:59,009 --> 00:16:02,819
could be the case yeah yeah I could

340
00:16:02,819 --> 00:16:06,449
definitely be the case I'm not really

341
00:16:06,449 --> 00:16:08,970
sure why that sped the development up I

342
00:16:08,970 --> 00:16:12,029
guess yeah as more people or buying

343
00:16:12,029 --> 00:16:13,529
their their kit because this is like a

344
00:16:13,529 --> 00:16:15,389
ransomware as a service that they're

345
00:16:15,389 --> 00:16:16,860
able to spend more resources on

346
00:16:16,860 --> 00:16:21,319
development yeah

347
00:16:22,410 --> 00:16:26,529
yeah usually and I like to think of it

348
00:16:26,529 --> 00:16:28,480
as mimicking the actual software

349
00:16:28,480 --> 00:16:30,910
companies so you have your team's for

350
00:16:30,910 --> 00:16:32,560
development you have a team for

351
00:16:32,560 --> 00:16:36,120
distribution marketing sales and support

352
00:16:36,120 --> 00:16:49,510
so yes yeah well so the going theory is

353
00:16:49,510 --> 00:16:51,730
if you're a malware author and presiding

354
00:16:51,730 --> 00:16:54,250
in those countries that that you you

355
00:16:54,250 --> 00:16:57,279
know better than to attack your

356
00:16:57,279 --> 00:17:02,140
motherland that foreign you know attacks

357
00:17:02,140 --> 00:17:06,520
is a little bit not as watched as

358
00:17:06,520 --> 00:17:08,980
closely I guess compared to you know if

359
00:17:08,980 --> 00:17:11,380
you're trying to attack the country that

360
00:17:11,380 --> 00:17:13,589
you reside in so that's a good question

361
00:17:13,589 --> 00:17:16,589
yeah

362
00:17:30,820 --> 00:17:35,179
yeah they do utilize arm the question

363
00:17:35,179 --> 00:17:37,489
was was you know I guess from like a

364
00:17:37,489 --> 00:17:40,639
host detection standpoint in the event

365
00:17:40,639 --> 00:17:42,200
that you saw this encryption routine

366
00:17:42,200 --> 00:17:45,710
that's being performed why can't you

367
00:17:45,710 --> 00:17:48,590
block that but yeah most of these are

368
00:17:48,590 --> 00:17:52,159
utilizing you know the windows api type

369
00:17:52,159 --> 00:17:55,759
of keys from what I believe and that's

370
00:17:55,759 --> 00:17:59,389
how they encrypt the files as far as AV

371
00:17:59,389 --> 00:18:02,269
detecting it I mean there's from these

372
00:18:02,269 --> 00:18:04,940
fresh campaigns that I see every day

373
00:18:04,940 --> 00:18:07,549
there's usually zero detection at least

374
00:18:07,549 --> 00:18:09,080
running it through like segments a

375
00:18:09,080 --> 00:18:13,399
static signature on a virus total so

376
00:18:13,399 --> 00:18:16,039
very low detection as far as AV is

377
00:18:16,039 --> 00:18:36,980
concerned yeah yeah yeah yeah absolutely

378
00:18:36,980 --> 00:18:39,710
on they don't offer it right now but uh

379
00:18:39,710 --> 00:18:43,070
I've heard of a couple researchers Tesla

380
00:18:43,070 --> 00:18:44,690
Krypton some of the earlier versions had

381
00:18:44,690 --> 00:18:47,090
a support number that you could call to

382
00:18:47,090 --> 00:18:48,799
get assistance with purchasing Bitcoin

383
00:18:48,799 --> 00:18:50,960
and there's some pretty phone calls that

384
00:18:50,960 --> 00:18:53,629
have been recorded for that trying to a

385
00:18:53,629 --> 00:18:55,070
social engineer a little bit more

386
00:18:55,070 --> 00:18:56,629
information out of these guys but

387
00:18:56,629 --> 00:18:58,249
they're probably just a call center that

388
00:18:58,249 --> 00:19:00,139
these guys hired I doubt they had you

389
00:19:00,139 --> 00:19:02,539
know any direct monetary ties with the

390
00:19:02,539 --> 00:19:11,980
actual actors yeah

391
00:19:17,520 --> 00:19:21,960
yeah absolutely so an exploit kit is

392
00:19:21,960 --> 00:19:25,870
it's a custom piece of software ran by a

393
00:19:25,870 --> 00:19:28,200
malicious actor that in the event

394
00:19:28,200 --> 00:19:33,580
through normal user browsing exploit

395
00:19:33,580 --> 00:19:37,690
vulnerabilities within a browser session

396
00:19:37,690 --> 00:19:39,940
from there the idea is that you know

397
00:19:39,940 --> 00:19:41,830
once you have code execution they're

398
00:19:41,830 --> 00:19:44,560
dropping the malware and running that so

399
00:19:44,560 --> 00:19:46,570
it's just used as a as a means the

400
00:19:46,570 --> 00:19:57,160
distribution another question good so

401
00:19:57,160 --> 00:20:01,330
still very prevalent um even though the

402
00:20:01,330 --> 00:20:03,250
past couple weeks we've seen a little

403
00:20:03,250 --> 00:20:06,070
bit of a decline with Tessa crept and I

404
00:20:06,070 --> 00:20:07,990
think that might be attributed some of

405
00:20:07,990 --> 00:20:09,900
the same forms where this particular

406
00:20:09,900 --> 00:20:14,520
variant is being marketed has also been

407
00:20:14,520 --> 00:20:17,710
marketed for surber which is a fairly

408
00:20:17,710 --> 00:20:20,020
new ransomware just started playing with

409
00:20:20,020 --> 00:20:22,570
it the past couple weeks so I think some

410
00:20:22,570 --> 00:20:23,980
of the actors that were playing with

411
00:20:23,980 --> 00:20:26,170
Tessa crypt if maybe have moved on to

412
00:20:26,170 --> 00:20:29,710
server right now and so definitely start

413
00:20:29,710 --> 00:20:31,390
paying more attention to that family as

414
00:20:31,390 --> 00:20:37,450
well it's still very prevalent taking a

415
00:20:37,450 --> 00:20:39,910
look at the typical campaign overview

416
00:20:39,910 --> 00:20:42,220
including the infrastructure so less

417
00:20:42,220 --> 00:20:45,010
intimate in mini airy notes for this

418
00:20:45,010 --> 00:20:48,400
family you know the the JavaScript

419
00:20:48,400 --> 00:20:51,190
attachment attached to an email on a

420
00:20:51,190 --> 00:20:53,680
massive mal spam campaign granny gets

421
00:20:53,680 --> 00:20:55,710
that email clicks on the attachment

422
00:20:55,710 --> 00:20:58,330
execute the second stage downloader and

423
00:20:58,330 --> 00:21:01,060
that then interns communicates with a

424
00:21:01,060 --> 00:21:03,670
PHP proxy again another compromised

425
00:21:03,670 --> 00:21:07,210
website usually a hacked WordPress or

426
00:21:07,210 --> 00:21:09,910
some other type of CMS that then Ford's

427
00:21:09,910 --> 00:21:12,790
that information to back-end again

428
00:21:12,790 --> 00:21:18,340
another tor hidden web service here's

429
00:21:18,340 --> 00:21:21,790
another live example from our sample set

430
00:21:21,790 --> 00:21:23,950
this one

431
00:21:23,950 --> 00:21:27,200
attempting to lure the user to believe

432
00:21:27,200 --> 00:21:29,060
in that it was unsuccessful western

433
00:21:29,060 --> 00:21:31,550
union transfer so you you received a

434
00:21:31,550 --> 00:21:33,200
money transfer for the amount of you

435
00:21:33,200 --> 00:21:36,410
know however much US dollars via western

436
00:21:36,410 --> 00:21:39,470
union and a warning letter zip

437
00:21:39,470 --> 00:21:44,780
attachment so that zip archive of course

438
00:21:44,780 --> 00:21:47,960
again has a jay s and by the way i mean

439
00:21:47,960 --> 00:21:52,370
although j/s seems to be a popular

440
00:21:52,370 --> 00:21:54,680
choice for some of these campaigns at

441
00:21:54,680 --> 00:21:56,450
the moment we've also seen malicious

442
00:21:56,450 --> 00:21:58,910
office documents that have you know

443
00:21:58,910 --> 00:22:01,820
macros enabled so if that user clicks

444
00:22:01,820 --> 00:22:04,460
allow macro then it's going to fire off

445
00:22:04,460 --> 00:22:06,350
and grab that second stage executable as

446
00:22:06,350 --> 00:22:09,550
well yeah question

447
00:22:32,240 --> 00:22:35,700
yeah my guess is on since that sounds

448
00:22:35,700 --> 00:22:37,500
like it was more of a web-based

449
00:22:37,500 --> 00:22:39,780
infection that was probably coming from

450
00:22:39,780 --> 00:22:45,059
an exploit kit which that would be my

451
00:22:45,059 --> 00:22:47,640
guess but yeah the way that the exploit

452
00:22:47,640 --> 00:22:49,020
kits work and we kind of touched on this

453
00:22:49,020 --> 00:22:51,660
earlier is that in the event that a user

454
00:22:51,660 --> 00:22:53,250
is browsing the web site might be

455
00:22:53,250 --> 00:22:56,520
silently redirected to it to an exploit

456
00:22:56,520 --> 00:23:00,390
kit and if it has if the users operating

457
00:23:00,390 --> 00:23:02,580
system or 3rd party plugins like flash

458
00:23:02,580 --> 00:23:05,220
and one honor are not updated then it

459
00:23:05,220 --> 00:23:07,080
exploits a vulnerability that will then

460
00:23:07,080 --> 00:23:09,630
drop you know whatever type of malware

461
00:23:09,630 --> 00:23:14,100
that that exploit kit user has set up to

462
00:23:14,100 --> 00:23:19,770
be dropped ok so again yeah heavily

463
00:23:19,770 --> 00:23:23,100
obvious gated JavaScript for the second

464
00:23:23,100 --> 00:23:26,280
stage downloader that then downloads it

465
00:23:26,280 --> 00:23:29,640
and you can see in the headers that for

466
00:23:29,640 --> 00:23:31,799
the return in the stream believe this

467
00:23:31,799 --> 00:23:35,309
one's actually engine X yes and Gen X

468
00:23:35,309 --> 00:23:37,860
proxy that was hosting second stage

469
00:23:37,860 --> 00:23:49,710
payloads as far as restrictions in place

470
00:23:49,710 --> 00:23:52,549
where

471
00:23:53,660 --> 00:23:57,710
oh yeah as far as like maybe geo

472
00:23:57,710 --> 00:24:02,630
restrictions or yeah some of the the PHP

473
00:24:02,630 --> 00:24:05,600
files that handle the the second stage

474
00:24:05,600 --> 00:24:08,600
download they might check user agent

475
00:24:08,600 --> 00:24:13,090
strings or I've seen geolocation as well

476
00:24:13,090 --> 00:24:18,320
they'll also place like it I've seen HT

477
00:24:18,320 --> 00:24:21,980
access files with long list of IP

478
00:24:21,980 --> 00:24:25,340
subnets that might block known security

479
00:24:25,340 --> 00:24:28,070
vendors or you know virustotal actually

480
00:24:28,070 --> 00:24:30,770
I just looked at a one of those the

481
00:24:30,770 --> 00:24:33,320
other day and within the PHP code it was

482
00:24:33,320 --> 00:24:35,450
looking for the user agent of virustotal

483
00:24:35,450 --> 00:24:38,120
so apparently anytime that a virus total

484
00:24:38,120 --> 00:24:40,010
is attempting to grab a second stage

485
00:24:40,010 --> 00:24:42,980
that it has like it's google cloud user

486
00:24:42,980 --> 00:24:45,050
agent and i have seen that blocked in

487
00:24:45,050 --> 00:24:51,440
some of these so again it this family as

488
00:24:51,440 --> 00:24:54,340
well it checks in with HTTP POST to a

489
00:24:54,340 --> 00:24:56,660
compromise website that's hosting this

490
00:24:56,660 --> 00:25:00,380
PHP file source code pictured right the

491
00:25:00,380 --> 00:25:01,550
cool thing about this one though is that

492
00:25:01,550 --> 00:25:04,220
actually forged it back to the tour back

493
00:25:04,220 --> 00:25:06,170
end usually through some type of Tour de

494
00:25:06,170 --> 00:25:09,440
web gateway as you can see on line 15 in

495
00:25:09,440 --> 00:25:12,140
that source code is the tor hidden

496
00:25:12,140 --> 00:25:16,880
gateway addresses there and since we're

497
00:25:16,880 --> 00:25:18,920
over HTTP again very strong suricata

498
00:25:18,920 --> 00:25:22,660
hits provided to us by emerging threat

499
00:25:22,660 --> 00:25:25,220
ET Trojan alpha crypt Tesla crypt

500
00:25:25,220 --> 00:25:27,770
ransomware CNC beacon and beacon

501
00:25:27,770 --> 00:25:33,020
response and this is what our poor

502
00:25:33,020 --> 00:25:36,800
granny sees on her desktop PNG file pops

503
00:25:36,800 --> 00:25:39,140
up foot and photo viewer with the

504
00:25:39,140 --> 00:25:41,270
instructions on how to decrypt and pay

505
00:25:41,270 --> 00:25:46,130
the ransom and of course the HTML file

506
00:25:46,130 --> 00:25:51,500
displaying a default browser any

507
00:25:51,500 --> 00:25:54,760
questions so far on Tesla

508
00:25:55,100 --> 00:26:01,130
yeah that seems to be the yeah the

509
00:26:01,130 --> 00:26:02,600
question was do they always use tor

510
00:26:02,600 --> 00:26:05,230
prior to encryption or the callbacks

511
00:26:05,230 --> 00:26:07,520
most of the families do but actually

512
00:26:07,520 --> 00:26:11,690
with surber even if you do not have a

513
00:26:11,690 --> 00:26:15,950
network connection it will go ahead and

514
00:26:15,950 --> 00:26:17,750
kurp your files so that's one difference

515
00:26:17,750 --> 00:26:19,280
but yeah most of these families they'll

516
00:26:19,280 --> 00:26:22,250
attempt to do their check in first to

517
00:26:22,250 --> 00:26:24,740
get kind of instructions I guess from

518
00:26:24,740 --> 00:26:26,150
the OC two and then they'll start

519
00:26:26,150 --> 00:26:28,190
encrypting but what I've seen with

520
00:26:28,190 --> 00:26:40,390
server that's not the case yeah yeah

521
00:26:52,390 --> 00:26:55,340
most of those arm so in Prior versions

522
00:26:55,340 --> 00:26:57,350
to some of these families that was an

523
00:26:57,350 --> 00:27:00,169
issue that the executable or the

524
00:27:00,169 --> 00:27:04,250
ransomware loader also had a private

525
00:27:04,250 --> 00:27:06,710
queue which may have existed in memory

526
00:27:06,710 --> 00:27:07,970
at some point so you could you know

527
00:27:07,970 --> 00:27:10,820
snapshot and hopefully get that key out

528
00:27:10,820 --> 00:27:13,580
of memory to decrypt in the event that

529
00:27:13,580 --> 00:27:15,530
your organization was pumped but what

530
00:27:15,530 --> 00:27:16,720
we're seeing now is that these

531
00:27:16,720 --> 00:27:20,270
miscreants / campaign are solely using

532
00:27:20,270 --> 00:27:22,850
private key and that's not being

533
00:27:22,850 --> 00:27:25,159
forwarded out to the clients at all so

534
00:27:25,159 --> 00:27:28,510
that the same public he might be in use

535
00:27:28,510 --> 00:27:31,520
for the entire campaign but that private

536
00:27:31,520 --> 00:27:33,020
key never touches the box that it's

537
00:27:33,020 --> 00:27:35,630
infecting it's it's only residing back

538
00:27:35,630 --> 00:27:38,059
end on you know their their back-end

539
00:27:38,059 --> 00:27:46,240
services I see

540
00:27:46,240 --> 00:27:53,070
oh I see that huh that's a good form

541
00:27:53,070 --> 00:27:57,670
right yeah I mean there's definitely

542
00:27:57,670 --> 00:28:00,700
means of as long as you can do like a

543
00:28:00,700 --> 00:28:03,790
memory dump and extract keys from that

544
00:28:03,790 --> 00:28:08,050
method yeah mainly using volatility for

545
00:28:08,050 --> 00:28:23,740
that kind of stuff yeah yep yeah some of

546
00:28:23,740 --> 00:28:26,679
the the initial families they weren't

547
00:28:26,679 --> 00:28:29,890
utilizing the the tour to web gateways

548
00:28:29,890 --> 00:28:32,620
so you would have to there were

549
00:28:32,620 --> 00:28:35,010
instructions within the the ransomware

550
00:28:35,010 --> 00:28:37,270
decryption that you have to go out and

551
00:28:37,270 --> 00:28:40,270
download the you know tor browser to be

552
00:28:40,270 --> 00:28:41,650
able to actually get to the payment

553
00:28:41,650 --> 00:28:44,200
information or the payment portal but

554
00:28:44,200 --> 00:28:45,340
most of these families now they're

555
00:28:45,340 --> 00:28:46,870
they're going to just drop the

556
00:28:46,870 --> 00:28:51,270
instructions and the the victim user

557
00:28:51,270 --> 00:28:54,160
would not have to utilize tour

558
00:28:54,160 --> 00:28:56,830
themselves that's just a method that

559
00:28:56,830 --> 00:28:58,510
they're utilizing to hide their back-end

560
00:28:58,510 --> 00:29:03,240
infrastructure yeah

561
00:29:16,529 --> 00:29:20,830
yeah um someone else you know within the

562
00:29:20,830 --> 00:29:22,870
the AV sec could probably answer that

563
00:29:22,870 --> 00:29:25,690
better all I know is that a bee's dead

564
00:29:25,690 --> 00:29:41,590
at least from my viewpoint like even

565
00:29:41,590 --> 00:29:43,450
trip wire or any of those types of file

566
00:29:43,450 --> 00:29:45,610
system change detection utilities are

567
00:29:45,610 --> 00:29:46,779
going to tell you that it's happening

568
00:29:46,779 --> 00:29:49,029
but you're going to find it faster but

569
00:29:49,029 --> 00:29:52,690
you're still owes there is it unless you

570
00:29:52,690 --> 00:29:54,580
then you still have to recover whatever

571
00:29:54,580 --> 00:30:09,070
you didn't stop so what's Ailin well

572
00:30:09,070 --> 00:30:10,600
that is a problem some of them have to

573
00:30:10,600 --> 00:30:11,980
hibernate like some of the latest ones

574
00:30:11,980 --> 00:30:19,779
the mac ransomware yeah they're getting

575
00:30:19,779 --> 00:30:22,960
very tricky but yeah it wasn't in India

576
00:30:22,960 --> 00:30:28,779
back-end infrastructures across Greece

577
00:30:28,779 --> 00:30:30,940
yeah absolutely on so the question was

578
00:30:30,940 --> 00:30:32,340
was the back-end infrastructure

579
00:30:32,340 --> 00:30:34,750
increasing as the amount of samples

580
00:30:34,750 --> 00:30:36,549
since most of these families are

581
00:30:36,549 --> 00:30:38,230
actually like a ransomware as a service

582
00:30:38,230 --> 00:30:41,950
we have um it's not necessarily that the

583
00:30:41,950 --> 00:30:45,279
malicious actor that's setting up these

584
00:30:45,279 --> 00:30:47,049
campaigns they're standing up their own

585
00:30:47,049 --> 00:30:48,909
infrastructure that's provided to them

586
00:30:48,909 --> 00:30:50,620
by the people that are selling the

587
00:30:50,620 --> 00:30:54,340
ransomware as a service but we have seen

588
00:30:54,340 --> 00:30:58,929
you know more middle notes or like

589
00:30:58,929 --> 00:31:02,019
burner nodes some of those like engine X

590
00:31:02,019 --> 00:31:03,789
proxy so instead of like hard coding

591
00:31:03,789 --> 00:31:05,380
three or four IP addresses they might do

592
00:31:05,380 --> 00:31:07,210
five or six just to have a little bit

593
00:31:07,210 --> 00:31:13,630
more of a nodes that they can burn yeah

594
00:31:13,630 --> 00:31:16,029
I think so yeah I haven't seen in an AWS

595
00:31:16,029 --> 00:31:25,230
yet but I'm waiting for it yeah yeah

596
00:31:40,710 --> 00:31:44,830
yeah as far as on the actual executable

597
00:31:44,830 --> 00:31:48,040
itself or where what would the scope of

598
00:31:48,040 --> 00:31:59,340
the are will be against yeah

599
00:32:02,360 --> 00:32:06,740
yeah that's true um especially with the

600
00:32:06,740 --> 00:32:09,890
actual executable itself even from you

601
00:32:09,890 --> 00:32:11,300
know second stage payload that might be

602
00:32:11,300 --> 00:32:12,440
coming back if you're running you're

603
00:32:12,440 --> 00:32:16,550
against that those are heavily packed so

604
00:32:16,550 --> 00:32:18,350
and that's the reason why AV detections

605
00:32:18,350 --> 00:32:22,450
failing is due to packed executable code

606
00:32:22,450 --> 00:32:25,820
so yeah it's really hard to to see that

607
00:32:25,820 --> 00:32:27,740
so not only is that you know every two

608
00:32:27,740 --> 00:32:29,060
weeks they're they're patching bugs

609
00:32:29,060 --> 00:32:33,290
within the actual ransomware malware

610
00:32:33,290 --> 00:32:36,320
itself but the the Packers at they

611
00:32:36,320 --> 00:32:38,930
utilize I can see within the same

612
00:32:38,930 --> 00:32:41,000
campaign they might have 20 distinct

613
00:32:41,000 --> 00:32:44,390
hashes of an executable that they

614
00:32:44,390 --> 00:32:46,790
utilize and that would be a relatively

615
00:32:46,790 --> 00:33:01,120
small campaign yeah without executing it

616
00:33:01,120 --> 00:33:04,220
that's really tough mainly because of

617
00:33:04,220 --> 00:33:08,870
the the issue with packing if so like a

618
00:33:08,870 --> 00:33:20,139
zit in user though um yeah right

619
00:33:22,880 --> 00:33:25,560
yeah absolutely so that's actually one

620
00:33:25,560 --> 00:33:28,560
thing that my company works on not to do

621
00:33:28,560 --> 00:33:31,230
any type of plugging or anything but

622
00:33:31,230 --> 00:33:35,220
what so our analysts what they do is

623
00:33:35,220 --> 00:33:37,140
they take a look at you know what are

624
00:33:37,140 --> 00:33:38,790
some of the massive mouth spam campaigns

625
00:33:38,790 --> 00:33:41,760
per day and they'll they'll pull down

626
00:33:41,760 --> 00:33:43,560
the malware analyze that and we really

627
00:33:43,560 --> 00:33:45,930
set as threat indicators that you may

628
00:33:45,930 --> 00:33:47,430
have seen in some of the email slides

629
00:33:47,430 --> 00:33:50,280
it'll say you know threat ID number so

630
00:33:50,280 --> 00:33:52,490
idea being you know after a while we've

631
00:33:52,490 --> 00:33:56,880
detected enough signatures that we can

632
00:33:56,880 --> 00:33:59,010
pinpoint alright well this particular

633
00:33:59,010 --> 00:34:01,740
email has this indicator in it and we

634
00:34:01,740 --> 00:34:03,390
know that this has been a crypto wall

635
00:34:03,390 --> 00:34:05,940
dropper or a Tesla drop or campaign

636
00:34:05,940 --> 00:34:08,280
in the past so we can you know create

637
00:34:08,280 --> 00:34:10,500
signatures around that that way you just

638
00:34:10,500 --> 00:34:13,260
solely looking at the email and some of

639
00:34:13,260 --> 00:34:15,510
the are signatures or signatures that

640
00:34:15,510 --> 00:34:17,130
are written for that particular campaign

641
00:34:17,130 --> 00:34:20,090
you already know that that's what the

642
00:34:20,090 --> 00:34:23,090
the first stage or the second stage

643
00:34:23,090 --> 00:34:27,500
payload could be does that make sense

644
00:34:28,370 --> 00:34:31,380
yeah absolutely on so virustotal of most

645
00:34:31,380 --> 00:34:34,320
um most reverse engineers to that at

646
00:34:34,320 --> 00:34:36,270
least the ones that I work with we're

647
00:34:36,270 --> 00:34:39,510
constantly commenting on virustotal so

648
00:34:39,510 --> 00:34:42,060
if if you have a secure means of

649
00:34:42,060 --> 00:34:44,840
checking the hash of that malware sample

650
00:34:44,840 --> 00:34:47,730
you might not be able to trap trust the

651
00:34:47,730 --> 00:34:51,090
initial j s droppers that are included

652
00:34:51,090 --> 00:34:52,918
in the attachments just because they

653
00:34:52,918 --> 00:34:56,190
switch up so often there's so many per

654
00:34:56,190 --> 00:34:58,800
campaign but that second stage payload

655
00:34:58,800 --> 00:35:03,600
hash doesn't change up as as often /

656
00:35:03,600 --> 00:35:05,400
campaign so if you can get a hold of

657
00:35:05,400 --> 00:35:07,500
that get a hash and look that up on

658
00:35:07,500 --> 00:35:10,440
virustotal most researchers they've been

659
00:35:10,440 --> 00:35:11,820
pretty good about commenting on

660
00:35:11,820 --> 00:35:13,380
virustotal as far as what type of

661
00:35:13,380 --> 00:35:16,530
malware family that could be good

662
00:35:16,530 --> 00:35:18,950
question

663
00:35:21,630 --> 00:35:26,460
moving on to LA key and lock is also

664
00:35:26,460 --> 00:35:28,349
spread via massive mouth spam campaigns

665
00:35:28,349 --> 00:35:31,740
with either doc mock macros office stock

666
00:35:31,740 --> 00:35:34,319
macros or JavaScript downloaders it's

667
00:35:34,319 --> 00:35:36,420
also being seen dropped as the final

668
00:35:36,420 --> 00:35:39,210
payload for neutrino and angler exploit

669
00:35:39,210 --> 00:35:42,059
kids again reboot persistence for your

670
00:35:42,059 --> 00:35:44,130
registry run key and some of the earlier

671
00:35:44,130 --> 00:35:46,410
versions that were pushed out with locky

672
00:35:46,410 --> 00:35:48,869
they actually placed some tracking

673
00:35:48,869 --> 00:35:52,380
information within the registry at HK

674
00:35:52,380 --> 00:35:55,230
current user software / locky so it was

675
00:35:55,230 --> 00:35:58,920
very easy to see that key in there and

676
00:35:58,920 --> 00:36:00,180
I'll talk about that here in a minute

677
00:36:00,180 --> 00:36:02,400
some of the mitigation steps that their

678
00:36:02,400 --> 00:36:06,029
team then you know pushed out as far as

679
00:36:06,029 --> 00:36:08,250
changes delete shadow file copies of

680
00:36:08,250 --> 00:36:10,019
course encrypts data with a very strong

681
00:36:10,019 --> 00:36:12,869
aes-128 and first appeared on the scene

682
00:36:12,869 --> 00:36:18,299
da mid-february of 2016 so show of hands

683
00:36:18,299 --> 00:36:21,000
not who's here who here is familiar with

684
00:36:21,000 --> 00:36:24,359
dried X banking Trojan quite a few

685
00:36:24,359 --> 00:36:26,099
people okay for those not in the know

686
00:36:26,099 --> 00:36:28,440
dried x is a man in the browser banking

687
00:36:28,440 --> 00:36:31,430
Trojan what that means is that as a

688
00:36:31,430 --> 00:36:34,859
user's computer is infected with dried x

689
00:36:34,859 --> 00:36:37,259
any sum that they're visiting a website

690
00:36:37,259 --> 00:36:39,359
that's included in the droid x

691
00:36:39,359 --> 00:36:41,700
configuration file javascript is going

692
00:36:41,700 --> 00:36:43,859
to be immediately injected into that

693
00:36:43,859 --> 00:36:46,890
browser session to you know usually to

694
00:36:46,890 --> 00:36:50,700
retrieve credentials one cool capability

695
00:36:50,700 --> 00:36:52,769
is that this actually started with Zeus

696
00:36:52,769 --> 00:36:55,549
banking trojan is a VNC connect back

697
00:36:55,549 --> 00:36:58,589
capability so as financial institutions

698
00:36:58,589 --> 00:37:00,119
they start to you know do more like

699
00:37:00,119 --> 00:37:02,819
fraud detection and they notice that you

700
00:37:02,819 --> 00:37:05,009
know grandma Jo initiated an account

701
00:37:05,009 --> 00:37:08,250
transfer from Ohio but then you know not

702
00:37:08,250 --> 00:37:11,160
even an hour later a much larger

703
00:37:11,160 --> 00:37:13,259
transaction occurred from Ukraine so

704
00:37:13,259 --> 00:37:15,210
that's always going to set off fraud

705
00:37:15,210 --> 00:37:17,220
alerts so the way that the miscreants

706
00:37:17,220 --> 00:37:19,619
are combating that is to utilize a VNC

707
00:37:19,619 --> 00:37:21,779
connect back to that infected grandma

708
00:37:21,779 --> 00:37:24,450
joe's machine and initiating those

709
00:37:24,450 --> 00:37:26,970
account transfers directly from her

710
00:37:26,970 --> 00:37:28,799
computer it's a little bit harder to

711
00:37:28,799 --> 00:37:30,329
detect as far as you know fraud

712
00:37:30,329 --> 00:37:33,720
detection within the FI so pretty cool

713
00:37:33,720 --> 00:37:35,520
piece the reason why

714
00:37:35,520 --> 00:37:37,470
I mentioned dried X here is because

715
00:37:37,470 --> 00:37:39,740
there's been a very strong connection

716
00:37:39,740 --> 00:37:43,950
between dried x botnet 220 and lucky

717
00:37:43,950 --> 00:37:46,590
affiliate ID is one and three so we're

718
00:37:46,590 --> 00:37:47,730
seeing some of the same distribution

719
00:37:47,730 --> 00:37:50,130
methods utilized for those families and

720
00:37:50,130 --> 00:37:52,500
there's also been some researchers that

721
00:37:52,500 --> 00:37:54,570
have monitored dried x baking charging

722
00:37:54,570 --> 00:37:57,570
for long term deployments and what

723
00:37:57,570 --> 00:37:59,550
they've noticed is that the running

724
00:37:59,550 --> 00:38:02,100
theory well is that you know since these

725
00:38:02,100 --> 00:38:04,380
research computers are not really being

726
00:38:04,380 --> 00:38:08,010
utilized for banking and they're not you

727
00:38:08,010 --> 00:38:09,570
know the miscreants aren't gaining any

728
00:38:09,570 --> 00:38:12,240
type of credentials from that so instead

729
00:38:12,240 --> 00:38:14,730
of just moving on from that infected

730
00:38:14,730 --> 00:38:17,010
endpoint one last-ditch effort to

731
00:38:17,010 --> 00:38:19,830
monetize that infection is to drop locky

732
00:38:19,830 --> 00:38:22,200
so people have been seeing that in

733
00:38:22,200 --> 00:38:29,640
long-term dried X infections here's a

734
00:38:29,640 --> 00:38:34,200
very small snapshot of about 3,000

735
00:38:34,200 --> 00:38:36,090
unique source IP addresses so these are

736
00:38:36,090 --> 00:38:37,920
IP addresses that downloaded the second

737
00:38:37,920 --> 00:38:40,050
stage payload second stage in this

738
00:38:40,050 --> 00:38:43,650
particular campaign being the after the

739
00:38:43,650 --> 00:38:45,410
victim clicks the the java script

740
00:38:45,410 --> 00:38:47,370
executable it then reaches out to a

741
00:38:47,370 --> 00:38:50,250
second stage payload which grabs the the

742
00:38:50,250 --> 00:38:52,680
locking loader so source IP addresses

743
00:38:52,680 --> 00:38:54,900
that were downloading this this

744
00:38:54,900 --> 00:38:58,860
particular campaign so taking a look at

745
00:38:58,860 --> 00:39:00,870
that map as you can see it's pretty

746
00:39:00,870 --> 00:39:03,570
geographically dispersed except for one

747
00:39:03,570 --> 00:39:07,950
country anyone take a guess Russia right

748
00:39:07,950 --> 00:39:10,260
yeah I mean there's like there's there's

749
00:39:10,260 --> 00:39:12,660
one red blip there and that if I had to

750
00:39:12,660 --> 00:39:13,890
take a guess i was probably some

751
00:39:13,890 --> 00:39:15,480
researcher that was downloaded in second

752
00:39:15,480 --> 00:39:17,640
stage through some type of like VPN

753
00:39:17,640 --> 00:39:20,670
solution so pretty much the same actor

754
00:39:20,670 --> 00:39:22,440
attribution as most of these coming out

755
00:39:22,440 --> 00:39:30,600
of Russia here's a an example of a live

756
00:39:30,600 --> 00:39:33,630
email lure that we seen in the wild this

757
00:39:33,630 --> 00:39:36,300
one again being a you know some type of

758
00:39:36,300 --> 00:39:38,970
invoice lure please review the attached

759
00:39:38,970 --> 00:39:42,600
copy of your invoice in Eric Hauck air

760
00:39:42,600 --> 00:39:46,490
cargo copy within the zip attachment

761
00:39:46,490 --> 00:39:48,510
and of course has a javascript

762
00:39:48,510 --> 00:39:51,660
downloader heavily obvious gated and

763
00:39:51,660 --> 00:39:54,990
again is ran just like dot exe when a

764
00:39:54,990 --> 00:39:57,450
user double clicks on it the window

765
00:39:57,450 --> 00:40:01,559
scripting host reaches out and grabs the

766
00:40:01,559 --> 00:40:04,050
second stage payload for locking most of

767
00:40:04,050 --> 00:40:06,240
the distributions especially for

768
00:40:06,240 --> 00:40:09,180
affiliate ID 1 and 3 2nd stage payloads

769
00:40:09,180 --> 00:40:13,130
are being hosted on compromised websites

770
00:40:13,130 --> 00:40:16,490
for each campaign we usually see

771
00:40:16,490 --> 00:40:19,140
anywhere from about 10 to 20 compromised

772
00:40:19,140 --> 00:40:21,329
websites and these are burnt every day

773
00:40:21,329 --> 00:40:24,329
so new compromised websites are being

774
00:40:24,329 --> 00:40:26,579
utilized for each campaign usually about

775
00:40:26,579 --> 00:40:30,660
10 to 20 URLs for that so that's

776
00:40:30,660 --> 00:40:35,130
downloaded and executed and a little bit

777
00:40:35,130 --> 00:40:37,530
different a setup for locky so there's

778
00:40:37,530 --> 00:40:39,240
actually there's usually three or four

779
00:40:39,240 --> 00:40:41,010
hard coded IP addresses within this

780
00:40:41,010 --> 00:40:43,859
loader that I think it builds a URL

781
00:40:43,859 --> 00:40:47,670
around that some of the earlier versions

782
00:40:47,670 --> 00:40:52,020
it was posted in a URL to main PHP then

783
00:40:52,020 --> 00:40:53,549
that was changed up to submit and then

784
00:40:53,549 --> 00:40:56,369
most recently as of like a couple weeks

785
00:40:56,369 --> 00:41:00,690
ago they switched to user info PHP so

786
00:41:00,690 --> 00:41:02,400
again since we're over plain sex

787
00:41:02,400 --> 00:41:05,549
protocol very strong signatures from

788
00:41:05,549 --> 00:41:06,809
emerging threat that you can get for

789
00:41:06,809 --> 00:41:09,240
that trojan ransom we're at lucky CNC

790
00:41:09,240 --> 00:41:16,619
beacon oh and also one other thing I

791
00:41:16,619 --> 00:41:17,970
failed to mention here in the slide deck

792
00:41:17,970 --> 00:41:20,400
is that although there's you know three

793
00:41:20,400 --> 00:41:23,190
or four hard coded IP addresses lock key

794
00:41:23,190 --> 00:41:25,740
also has a fallback domain generation

795
00:41:25,740 --> 00:41:28,049
algorithm or DGA and that seed value

796
00:41:28,049 --> 00:41:30,930
changes up weekly so unfortunately I

797
00:41:30,930 --> 00:41:32,700
mean as a researcher you might be able

798
00:41:32,700 --> 00:41:34,890
to predict a couple days out what the

799
00:41:34,890 --> 00:41:38,130
the DGA domains might be they then

800
00:41:38,130 --> 00:41:40,140
change that seed value the next week in

801
00:41:40,140 --> 00:41:42,390
a different campaign so very hard to

802
00:41:42,390 --> 00:41:44,220
predict those from you know longest

803
00:41:44,220 --> 00:41:50,819
long-term sinkhole een and poor granny

804
00:41:50,819 --> 00:41:52,530
Jo this is what she's getting on her

805
00:41:52,530 --> 00:41:54,809
desktop now so not only is it pop up the

806
00:41:54,809 --> 00:41:57,210
image instructions in photo viewer but

807
00:41:57,210 --> 00:41:59,109
also sets the desktop

808
00:41:59,109 --> 00:42:01,029
background as those instructions as well

809
00:42:01,029 --> 00:42:02,739
just to make sure you don't miss him I

810
00:42:02,739 --> 00:42:10,180
guess all right so kind of touched on

811
00:42:10,180 --> 00:42:11,739
this earlier with a nice lady's question

812
00:42:11,739 --> 00:42:14,680
about prevention or you know

813
00:42:14,680 --> 00:42:17,920
vaccinations and just like any other

814
00:42:17,920 --> 00:42:20,499
type of software system you know the

815
00:42:20,499 --> 00:42:23,079
lack of proper programming and lack of

816
00:42:23,079 --> 00:42:26,619
quality assurance leads to bugs so there

817
00:42:26,619 --> 00:42:29,410
was a registry lock of again ACL that

818
00:42:29,410 --> 00:42:31,660
she could to implement so by setting a

819
00:42:31,660 --> 00:42:33,670
particular registry key I kind of I

820
00:42:33,670 --> 00:42:35,710
mentioned earlier it was that HKC you

821
00:42:35,710 --> 00:42:37,749
software locky so if you set like a

822
00:42:37,749 --> 00:42:40,900
read-only a tribute as an admin when

823
00:42:40,900 --> 00:42:44,049
locky initially execute it attempts to

824
00:42:44,049 --> 00:42:47,529
read that and due to improper exception

825
00:42:47,529 --> 00:42:49,059
handling would just crap out and would

826
00:42:49,059 --> 00:42:52,809
not infect your system so one of one of

827
00:42:52,809 --> 00:42:55,269
my fellow co-workers initially found

828
00:42:55,269 --> 00:42:57,599
this bug and then like two weeks later a

829
00:42:57,599 --> 00:43:00,400
Lexi consulting firm publicly blogged

830
00:43:00,400 --> 00:43:02,890
about it and of course like within the

831
00:43:02,890 --> 00:43:04,720
matter of three days we saw that that

832
00:43:04,720 --> 00:43:07,239
was patched meeting along the wall wild

833
00:43:07,239 --> 00:43:09,130
so pretty interesting to see that you

834
00:43:09,130 --> 00:43:10,960
know these guys are performing Oh sent

835
00:43:10,960 --> 00:43:14,619
on their you know their their malware

836
00:43:14,619 --> 00:43:17,799
and in the event that you know there's

837
00:43:17,799 --> 00:43:19,930
some type of public information that's

838
00:43:19,930 --> 00:43:21,309
published they are obviously reading

839
00:43:21,309 --> 00:43:23,289
that in reacting very quickly in the

840
00:43:23,289 --> 00:43:25,900
development lifecycle of that malware so

841
00:43:25,900 --> 00:43:27,190
pretty interesting to see that in the

842
00:43:27,190 --> 00:43:30,970
world so one other method that you can

843
00:43:30,970 --> 00:43:35,109
use to not get infected by lackey is

844
00:43:35,109 --> 00:43:37,630
just go ahead and setting your operating

845
00:43:37,630 --> 00:43:41,470
system language to russian i don't i

846
00:43:41,470 --> 00:43:43,359
don't know how usable it would be then

847
00:43:43,359 --> 00:43:46,239
but that is one method and there was

848
00:43:46,239 --> 00:43:48,420
also that same rich street key too

849
00:43:48,420 --> 00:43:51,880
although that has been patched around

850
00:43:51,880 --> 00:43:54,069
march 29th with the other registry lock

851
00:43:54,069 --> 00:43:57,190
crash and the setting a completed

852
00:43:57,190 --> 00:44:00,999
registry key that particular registry

853
00:44:00,999 --> 00:44:02,859
key is still based on the the computer

854
00:44:02,859 --> 00:44:04,809
name so it's still it can still be

855
00:44:04,809 --> 00:44:07,420
computed so that the same patch exists

856
00:44:07,420 --> 00:44:10,450
just not at the the easier

857
00:44:10,450 --> 00:44:12,970
statically coded registry key it's a

858
00:44:12,970 --> 00:44:17,349
unique per machine and as I mentioned

859
00:44:17,349 --> 00:44:20,619
earlier sue Lexie published how you

860
00:44:20,619 --> 00:44:23,109
might be able to populate that RSA

861
00:44:23,109 --> 00:44:25,839
public key already on a machine so in

862
00:44:25,839 --> 00:44:27,160
the event that you are infected with

863
00:44:27,160 --> 00:44:29,890
locky the idea being that you you have a

864
00:44:29,890 --> 00:44:32,680
key pair for that public key that you

865
00:44:32,680 --> 00:44:34,780
can go ahead and decrypt your files so

866
00:44:34,780 --> 00:44:38,280
one other method of vaccinating yourself

867
00:44:38,280 --> 00:44:47,109
yeah that's a good question so the

868
00:44:47,109 --> 00:44:49,660
question was how would what dis applied

869
00:44:49,660 --> 00:44:53,490
to anything got saved in the cloud and

870
00:44:53,910 --> 00:45:01,210
yeah um so I'm not sure if depends how

871
00:45:01,210 --> 00:45:06,010
it's mapped I know one of my one of my

872
00:45:06,010 --> 00:45:07,930
fellow co-workers he was given a live

873
00:45:07,930 --> 00:45:13,089
infection demo and his the way that he

874
00:45:13,089 --> 00:45:15,099
transferred malware samples into his vm

875
00:45:15,099 --> 00:45:19,900
was through a network share so lucky was

876
00:45:19,900 --> 00:45:23,829
intuitive enough to scanned other

877
00:45:23,829 --> 00:45:25,420
network shares and found that his

878
00:45:25,420 --> 00:45:30,130
dropbox was mapped to his local machine

879
00:45:30,130 --> 00:45:31,750
and then started encrypting our

880
00:45:31,750 --> 00:45:37,000
companies a drop box but but uh yeah it

881
00:45:37,000 --> 00:45:38,260
was pretty funny we give him for a

882
00:45:38,260 --> 00:45:42,130
while for about that but um he the cool

883
00:45:42,130 --> 00:45:43,690
thing about cloud storage is that

884
00:45:43,690 --> 00:45:45,130
they're you know they they have very

885
00:45:45,130 --> 00:45:47,890
good backups so it was very easily it

886
00:45:47,890 --> 00:45:49,180
was just like one phone call and they

887
00:45:49,180 --> 00:45:51,960
reverted everything back prior to

888
00:45:51,960 --> 00:45:54,280
encrypting those files that's a good

889
00:45:54,280 --> 00:45:58,690
question all right we talked a little

890
00:45:58,690 --> 00:46:00,910
bit about mitigation and we've already

891
00:46:00,910 --> 00:46:03,520
kind of touched a bit on this keep your

892
00:46:03,520 --> 00:46:06,069
environment patch first and foremost so

893
00:46:06,069 --> 00:46:08,290
not only you know keeping Internet

894
00:46:08,290 --> 00:46:11,020
Explorer up to date your OS level win

895
00:46:11,020 --> 00:46:13,329
updates but also all of your 3rd party

896
00:46:13,329 --> 00:46:15,069
plugins to prevent you know third-party

897
00:46:15,069 --> 00:46:18,640
drive-by attacks with exploit kits so

898
00:46:18,640 --> 00:46:21,190
all of your Adobe Flash is

899
00:46:21,190 --> 00:46:24,940
java PDF pretty much anything that's web

900
00:46:24,940 --> 00:46:28,810
based on your machine one other thing

901
00:46:28,810 --> 00:46:30,819
that you can do is block executable

902
00:46:30,819 --> 00:46:32,829
scripts on gateways I have no idea why

903
00:46:32,829 --> 00:46:35,560
dot jas files within a zip archive are

904
00:46:35,560 --> 00:46:37,750
allowed through email gateways I cannot

905
00:46:37,750 --> 00:46:39,430
think of any business reason why that

906
00:46:39,430 --> 00:46:43,599
would be legit yeah why y dot zips at

907
00:46:43,599 --> 00:46:46,420
all yeah is that how you deploy code

908
00:46:46,420 --> 00:46:49,690
idea so even yeah even if your

909
00:46:49,690 --> 00:46:51,460
developers come back and say well that's

910
00:46:51,460 --> 00:46:53,740
how we you know patch things I don't

911
00:46:53,740 --> 00:46:57,119
know I think there would be more secure

912
00:46:57,119 --> 00:47:00,609
ways to to transfer that type of stuff

913
00:47:00,609 --> 00:47:04,180
with an organization one other thing

914
00:47:04,180 --> 00:47:06,040
that you should definitely be doing not

915
00:47:06,040 --> 00:47:08,380
only for your home computer but also

916
00:47:08,380 --> 00:47:10,569
within your organization is back up in

917
00:47:10,569 --> 00:47:12,700
practice those two set disaster recovery

918
00:47:12,700 --> 00:47:15,730
drills first the forum oh so it's not

919
00:47:15,730 --> 00:47:17,079
only that you have you know three two

920
00:47:17,079 --> 00:47:20,319
one backups but also you know having

921
00:47:20,319 --> 00:47:22,079
your practice drills in the event that

922
00:47:22,079 --> 00:47:26,470
our HR guys are able to encrypt with

923
00:47:26,470 --> 00:47:28,450
ransomware all of our development source

924
00:47:28,450 --> 00:47:30,579
code you know how does that how does

925
00:47:30,579 --> 00:47:32,380
that impact our business and how do we

926
00:47:32,380 --> 00:47:34,780
quickly get back to operational status

927
00:47:34,780 --> 00:47:37,420
so you should be able to answer that you

928
00:47:37,420 --> 00:47:39,040
know fairly quickly and know the

929
00:47:39,040 --> 00:47:42,240
timetable that that would take to occur

930
00:47:42,240 --> 00:47:44,980
train users to spot fish first the

931
00:47:44,980 --> 00:47:46,990
foremost you know is that the idea of

932
00:47:46,990 --> 00:47:49,930
especially the company dime at training

933
00:47:49,930 --> 00:47:52,630
your users to become an asset as opposed

934
00:47:52,630 --> 00:47:55,270
to a liability so definitely seeing that

935
00:47:55,270 --> 00:47:58,180
and only as they report things but you

936
00:47:58,180 --> 00:48:00,160
know how is that acted upon within your

937
00:48:00,160 --> 00:48:04,540
security operations center one pretty

938
00:48:04,540 --> 00:48:07,569
cool a tool that's published by a bit

939
00:48:07,569 --> 00:48:10,450
defender is anti ransomware so you might

940
00:48:10,450 --> 00:48:11,829
want to check out that I would not

941
00:48:11,829 --> 00:48:14,680
recommend that for the enterprise as I

942
00:48:14,680 --> 00:48:17,050
was playing with it even after the

943
00:48:17,050 --> 00:48:21,490
lackey patches it does prevent Loki from

944
00:48:21,490 --> 00:48:24,040
infecting but what I have noticed is

945
00:48:24,040 --> 00:48:28,869
that it updates over HTTP plaintext so

946
00:48:28,869 --> 00:48:31,420
it reaches out you know and grabs an

947
00:48:31,420 --> 00:48:33,490
executable and updates so probably think

948
00:48:33,490 --> 00:48:34,150
of some type of

949
00:48:34,150 --> 00:48:36,520
in the middle scenario for that in the

950
00:48:36,520 --> 00:48:38,140
work we know sation but at least for a

951
00:48:38,140 --> 00:48:39,609
grand mal Joe's computer i'm probably

952
00:48:39,609 --> 00:48:43,480
going to install that on therefore also

953
00:48:43,480 --> 00:48:45,400
definitely want to implement least

954
00:48:45,400 --> 00:48:48,460
privileged access based on you know user

955
00:48:48,460 --> 00:48:50,890
business roles there's no reason why

956
00:48:50,890 --> 00:48:53,319
your HR your sales team has complete

957
00:48:53,319 --> 00:48:55,630
read write on your dev source trees

958
00:48:55,630 --> 00:49:01,809
right and starting to wrap up a little

959
00:49:01,809 --> 00:49:03,039
bit just want to go over some final

960
00:49:03,039 --> 00:49:04,450
thoughts of what I'm currently working

961
00:49:04,450 --> 00:49:06,490
on and what I'll be concentrating on in

962
00:49:06,490 --> 00:49:09,400
the future as a kind of mission earlier

963
00:49:09,400 --> 00:49:11,529
the malware ecosystems starting to mimic

964
00:49:11,529 --> 00:49:13,119
legit software you know you have your

965
00:49:13,119 --> 00:49:15,190
support your sales marketing

966
00:49:15,190 --> 00:49:17,559
distribution and even your development

967
00:49:17,559 --> 00:49:20,650
team one thing with in some of these

968
00:49:20,650 --> 00:49:23,589
ransomware instruction sets you'll see

969
00:49:23,589 --> 00:49:26,890
that it prompts the user or instructs

970
00:49:26,890 --> 00:49:28,569
the user to reach out to particular

971
00:49:28,569 --> 00:49:30,549
Bitcoin exchanges where they might be

972
00:49:30,549 --> 00:49:32,440
able to utilize their PayPal account to

973
00:49:32,440 --> 00:49:35,049
exchange that for Bitcoin have those

974
00:49:35,049 --> 00:49:37,119
exchanges then looked at you know what

975
00:49:37,119 --> 00:49:39,460
it would with all the amount of money

976
00:49:39,460 --> 00:49:41,020
that's moving around with a big coin

977
00:49:41,020 --> 00:49:45,460
from ransomware you know that these

978
00:49:45,460 --> 00:49:46,960
exchanges are getting a nice cut of that

979
00:49:46,960 --> 00:49:49,569
action so I haven't seen too much

980
00:49:49,569 --> 00:49:52,859
research out on the exchanges themselves

981
00:49:52,859 --> 00:49:55,900
and of course there's a huge rise of

982
00:49:55,900 --> 00:49:57,279
ransomware all these families that we

983
00:49:57,279 --> 00:49:58,960
talked about here they're marketing on

984
00:49:58,960 --> 00:50:02,829
underground forms so people can hire

985
00:50:02,829 --> 00:50:04,270
that they don't have to stand up the

986
00:50:04,270 --> 00:50:06,730
infrastructure to start these campaigns

987
00:50:06,730 --> 00:50:10,270
they're slowly just renting that service

988
00:50:10,270 --> 00:50:11,770
and then from there it's left up to them

989
00:50:11,770 --> 00:50:14,770
to hire maybe a spammer or a distributor

990
00:50:14,770 --> 00:50:18,690
to massively spam out those campaigns

991
00:50:18,690 --> 00:50:21,250
one other pretty cool facet that came

992
00:50:21,250 --> 00:50:25,240
across with ransomware while researching

993
00:50:25,240 --> 00:50:28,900
this stuff is it's being used to cover

994
00:50:28,900 --> 00:50:31,569
up corporate intrusions so some of your

995
00:50:31,569 --> 00:50:33,549
advanced persistent threat I know don't

996
00:50:33,549 --> 00:50:35,849
throw anything at me I mentioned apts

997
00:50:35,849 --> 00:50:37,750
some of these guys you know they've been

998
00:50:37,750 --> 00:50:39,220
in network for two or three years

999
00:50:39,220 --> 00:50:41,260
they've exfilled every bit that they

1000
00:50:41,260 --> 00:50:43,660
could have you know possibly get out of

1001
00:50:43,660 --> 00:50:46,599
an organization that so one last-ditch

1002
00:50:46,599 --> 00:50:47,360
effort

1003
00:50:47,360 --> 00:50:49,490
maybe to monetize the foot hole that

1004
00:50:49,490 --> 00:50:51,650
they have on an organization is to drop

1005
00:50:51,650 --> 00:50:55,370
ransomware you know that probably maybe

1006
00:50:55,370 --> 00:50:57,050
tips ahead as far as detection is

1007
00:50:57,050 --> 00:50:59,630
concern these guys I think it was the

1008
00:50:59,630 --> 00:51:01,160
secure wheres article is pretty neat

1009
00:51:01,160 --> 00:51:03,320
that they distributed rent somewhere out

1010
00:51:03,320 --> 00:51:06,020
to be like Active Directory somehow

1011
00:51:06,020 --> 00:51:08,900
maybe wsus or whatever its successor is

1012
00:51:08,900 --> 00:51:11,350
to all the the computers on a network

1013
00:51:11,350 --> 00:51:16,060
but the they found out you know after

1014
00:51:16,060 --> 00:51:18,410
you know coming in investigating that

1015
00:51:18,410 --> 00:51:20,090
that these guys had been in the network

1016
00:51:20,090 --> 00:51:24,920
for two or three years already so and

1017
00:51:24,920 --> 00:51:27,020
some future work that i'll be taking a

1018
00:51:27,020 --> 00:51:29,420
look at personally identify more family

1019
00:51:29,420 --> 00:51:31,310
vulnerabilities especially playing with

1020
00:51:31,310 --> 00:51:33,110
the community control infrastructure

1021
00:51:33,110 --> 00:51:36,620
backend server which is fairly new first

1022
00:51:36,620 --> 00:51:39,260
thing in the wild around march 10th so

1023
00:51:39,260 --> 00:51:41,810
starting to play with that now and of

1024
00:51:41,810 --> 00:51:45,320
course any type of one project that kind

1025
00:51:45,320 --> 00:51:46,610
of came up with and maybe wanted to run

1026
00:51:46,610 --> 00:51:48,170
this by you all to see what thoughts

1027
00:51:48,170 --> 00:51:51,460
were on this is taking a look at a

1028
00:51:51,460 --> 00:51:56,120
long-term monitoring so after a user's

1029
00:51:56,120 --> 00:51:59,300
infected they pay the ransom and that

1030
00:51:59,300 --> 00:52:01,340
doesn't you know these guys aren't

1031
00:52:01,340 --> 00:52:03,340
removing the malware from the computer

1032
00:52:03,340 --> 00:52:07,430
so the invent are the reason why they

1033
00:52:07,430 --> 00:52:08,930
paid the ransom in the first place the

1034
00:52:08,930 --> 00:52:10,220
victims because they don't have solid

1035
00:52:10,220 --> 00:52:14,030
backups and the data that they was

1036
00:52:14,030 --> 00:52:16,010
encrypted isn't important up for them to

1037
00:52:16,010 --> 00:52:17,720
pay the ransom so they're probably not

1038
00:52:17,720 --> 00:52:19,970
wiping the computers removing all traces

1039
00:52:19,970 --> 00:52:22,400
in malware this malware still

1040
00:52:22,400 --> 00:52:25,400
communicating you know back situ so

1041
00:52:25,400 --> 00:52:26,420
that's one thing that i would like to

1042
00:52:26,420 --> 00:52:30,550
play with you know perhaps maybe access

1043
00:52:30,550 --> 00:52:33,620
you know to that infected node is sold

1044
00:52:33,620 --> 00:52:36,770
to a third party could be the case or as

1045
00:52:36,770 --> 00:52:39,590
later versions of particular malware

1046
00:52:39,590 --> 00:52:41,570
family come out does it reinfect itself

1047
00:52:41,570 --> 00:52:43,940
and the whole you know ransomware or the

1048
00:52:43,940 --> 00:52:46,250
ransom process starts over again I think

1049
00:52:46,250 --> 00:52:47,330
that'd be pretty interesting to take a

1050
00:52:47,330 --> 00:52:51,890
look at and got a quick video demo here

1051
00:52:51,890 --> 00:52:54,220
for you

1052
00:52:56,950 --> 00:52:59,630
so what I did here was um just create

1053
00:52:59,630 --> 00:53:01,640
like a batch file of a whole bunch of

1054
00:53:01,640 --> 00:53:03,230
different ransomware families and the

1055
00:53:03,230 --> 00:53:04,700
only two that I actually got to pop up

1056
00:53:04,700 --> 00:53:07,820
was a server and CTB locker so as you

1057
00:53:07,820 --> 00:53:09,290
can see Sir bird didn't take any time at

1058
00:53:09,290 --> 00:53:12,920
all as soon as i started the the video

1059
00:53:12,920 --> 00:53:16,750
there that's when server infected

1060
00:53:17,920 --> 00:53:21,830
popping up HTML instructions as you can

1061
00:53:21,830 --> 00:53:24,770
see there the dot onion link early

1062
00:53:24,770 --> 00:53:27,109
version of server actually requested

1063
00:53:27,109 --> 00:53:35,090
that you download the tor browser which

1064
00:53:35,090 --> 00:53:37,280
just as you think servers good pops up

1065
00:53:37,280 --> 00:53:39,740
another text document it's pretty funny

1066
00:53:39,740 --> 00:53:41,270
thing about I mean they definitely want

1067
00:53:41,270 --> 00:53:43,070
to make the the victim user get those

1068
00:53:43,070 --> 00:53:45,590
instructions but then CTB Locker takes

1069
00:53:45,590 --> 00:53:47,600
over minimizes all the windows and sets

1070
00:53:47,600 --> 00:53:48,770
the desktop background to the

1071
00:53:48,770 --> 00:53:52,160
instructions server comes back with HTML

1072
00:53:52,160 --> 00:53:54,859
instructions again and they kind of

1073
00:53:54,859 --> 00:53:56,630
battle it out a lot of Windows scripting

1074
00:53:56,630 --> 00:53:59,960
errors going on mainly because the the

1075
00:53:59,960 --> 00:54:01,490
infected file is there encrypting

1076
00:54:01,490 --> 00:54:04,850
themselves at this point so it's a kind

1077
00:54:04,850 --> 00:54:06,350
of a race condition which I thought was

1078
00:54:06,350 --> 00:54:16,430
pretty fun yeah yeah yeah yeah true yeah

1079
00:54:16,430 --> 00:54:18,500
that could definitely save you in some

1080
00:54:18,500 --> 00:54:21,680
ways yeah this end user obviously having

1081
00:54:21,680 --> 00:54:23,060
a really bad day probably call an IT

1082
00:54:23,060 --> 00:54:25,609
right now I t's telling them well have

1083
00:54:25,609 --> 00:54:28,750
you tried turning it off and on again

1084
00:54:29,849 --> 00:54:47,740
yeah good one thing you good yeah catch

1085
00:54:47,740 --> 00:54:51,849
a quick yeah I don't do much I are um

1086
00:54:51,849 --> 00:54:54,460
but that would be my approach to it I

1087
00:54:54,460 --> 00:55:14,880
wouldn't try any other questions yeah

1088
00:55:15,510 --> 00:55:18,910
it's very debated on there was like a FB

1089
00:55:18,910 --> 00:55:22,750
i-- release i think it was a week or two

1090
00:55:22,750 --> 00:55:26,309
ago and i don't know if it was lucky

1091
00:55:26,309 --> 00:55:29,019
actors that they were talking about what

1092
00:55:29,019 --> 00:55:33,089
they said it could have been as high as

1093
00:55:37,920 --> 00:55:42,099
yeah can be over inflated extra shirt

1094
00:55:42,099 --> 00:55:44,829
the UM there has been a lot of tracking

1095
00:55:44,829 --> 00:55:46,900
you since this is Bitcoin there has been

1096
00:55:46,900 --> 00:55:49,589
some researchers out of it tracking

1097
00:55:49,589 --> 00:55:52,920
watching transactions

1098
00:55:52,920 --> 00:55:55,470
then some of the earlier crypto wall

1099
00:55:55,470 --> 00:55:57,000
research that came out about blockchain

1100
00:55:57,000 --> 00:56:00,030
tracking they suggested anywhere between

1101
00:56:00,030 --> 00:56:07,340
200 for out of dollars very high numbers

1102
00:56:14,530 --> 00:56:22,630
it's working so I change it please

1103
00:56:22,630 --> 00:56:26,950
enough to get it like these guys but I

1104
00:56:26,950 --> 00:56:31,000
mean the reason why there

1105
00:57:47,740 --> 00:57:53,150
yeah my fruit of these yeah cool any

1106
00:57:53,150 --> 00:57:55,550
other questions good y'all bout hungry

1107
00:57:55,550 --> 00:57:58,450
yeah I know I am um I think we had one

1108
00:57:58,450 --> 00:58:02,859
announcement real quick

