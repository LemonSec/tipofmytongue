1
00:00:01,199 --> 00:00:03,120
all right let's go ahead and get started

2
00:00:03,120 --> 00:00:05,520
um thank you for joining uh welcome uh

3
00:00:05,520 --> 00:00:07,600
this is hacking into a hospital during a

4
00:00:07,600 --> 00:00:09,920
pandemic pretty fun test i recently

5
00:00:09,920 --> 00:00:12,000
uh had the privilege of doing and happy

6
00:00:12,000 --> 00:00:13,280
to share it with you

7
00:00:13,280 --> 00:00:16,640
um let's go ahead and jump right in um

8
00:00:16,640 --> 00:00:19,119
so talk for this uh you'll quickly find

9
00:00:19,119 --> 00:00:20,480
out when we get to the who am i my

10
00:00:20,480 --> 00:00:22,160
background is air force

11
00:00:22,160 --> 00:00:24,560
uh and one of the things a really dumb

12
00:00:24,560 --> 00:00:26,160
joke to start off here

13
00:00:26,160 --> 00:00:27,519
how can you tell somebody's a fighter

14
00:00:27,519 --> 00:00:30,160
pilot at the bar they'll tell you right

15
00:00:30,160 --> 00:00:32,558
the simple fact is that uh fighter

16
00:00:32,558 --> 00:00:33,200
pilots are

17
00:00:33,200 --> 00:00:35,040
always loving to tell different war

18
00:00:35,040 --> 00:00:37,360
stories or you know there i was inverted

19
00:00:37,360 --> 00:00:38,320
kind of stories

20
00:00:38,320 --> 00:00:40,480
um and while while that's annoying for

21
00:00:40,480 --> 00:00:41,440
most of us

22
00:00:41,440 --> 00:00:43,520
it does serve a purpose for one they're

23
00:00:43,520 --> 00:00:44,480
really interesting

24
00:00:44,480 --> 00:00:47,200
uh and for two that's actually how they

25
00:00:47,200 --> 00:00:47,840
make the

26
00:00:47,840 --> 00:00:49,360
make each other better so by telling

27
00:00:49,360 --> 00:00:51,680
stories uh they're able to bolster each

28
00:00:51,680 --> 00:00:52,960
other's skills learn different

29
00:00:52,960 --> 00:00:54,640
techniques or tricks that they tried and

30
00:00:54,640 --> 00:00:56,239
then other pilots learn those going

31
00:00:56,239 --> 00:00:57,920
forward right so

32
00:00:57,920 --> 00:00:59,199
really the purpose of this call is i

33
00:00:59,199 --> 00:01:00,640
think we can do that more in the

34
00:01:00,640 --> 00:01:02,480
information security industry so i plan

35
00:01:02,480 --> 00:01:04,080
to do exactly that let's tell a story

36
00:01:04,080 --> 00:01:05,680
about a recent test i got to do

37
00:01:05,680 --> 00:01:08,640
a very fun test of a hospital right in

38
00:01:08,640 --> 00:01:09,280
the middle of

39
00:01:09,280 --> 00:01:11,360
the pandemic we're all going through and

40
00:01:11,360 --> 00:01:12,799
from that hopefully we can pull some

41
00:01:12,799 --> 00:01:14,159
lessons learned

42
00:01:14,159 --> 00:01:16,640
i hope this presentation is helpful for

43
00:01:16,640 --> 00:01:18,479
both red teamers and learning some

44
00:01:18,479 --> 00:01:20,159
different techniques and tricks

45
00:01:20,159 --> 00:01:22,720
uh that i employed and by all means if

46
00:01:22,720 --> 00:01:24,240
you had some more tricks for me to learn

47
00:01:24,240 --> 00:01:25,520
or things i didn't bring up that i

48
00:01:25,520 --> 00:01:26,400
should have

49
00:01:26,400 --> 00:01:28,240
hit me up in the chat i'm in the chat

50
00:01:28,240 --> 00:01:29,680
right now or at least i hope so this is

51
00:01:29,680 --> 00:01:31,040
pre-recorded right so

52
00:01:31,040 --> 00:01:32,960
bearing some a major emergency i should

53
00:01:32,960 --> 00:01:34,079
be in the chat

54
00:01:34,079 --> 00:01:37,119
uh and uh you know i would love to share

55
00:01:37,119 --> 00:01:37,920
stories with you

56
00:01:37,920 --> 00:01:40,640
also though for blue teams um and

57
00:01:40,640 --> 00:01:42,640
primarily for blue teams here here's the

58
00:01:42,640 --> 00:01:44,159
attacks that you're up against

59
00:01:44,159 --> 00:01:46,159
uh some of them and some things that you

60
00:01:46,159 --> 00:01:47,840
may not have considered that i

61
00:01:47,840 --> 00:01:50,000
uh figured out in this test that that

62
00:01:50,000 --> 00:01:51,600
hopefully you can take some lessons

63
00:01:51,600 --> 00:01:52,079
learned

64
00:01:52,079 --> 00:01:53,439
my goal is for you to have at least one

65
00:01:53,439 --> 00:01:55,119
thing you can go back to to your

66
00:01:55,119 --> 00:01:56,079
organization

67
00:01:56,079 --> 00:01:57,680
and secure your network right that's why

68
00:01:57,680 --> 00:01:59,360
we all do what we do

69
00:01:59,360 --> 00:02:01,200
um we'll kind of finish with some

70
00:02:01,200 --> 00:02:02,640
general thoughts about

71
00:02:02,640 --> 00:02:04,719
uh the industry specifically the

72
00:02:04,719 --> 00:02:05,840
healthcare industry

73
00:02:05,840 --> 00:02:09,119
uh and uh you know hopefully we'll we'll

74
00:02:09,119 --> 00:02:11,200
have a good time uh doing so so

75
00:02:11,200 --> 00:02:13,200
first and foremost a little bit about me

76
00:02:13,200 --> 00:02:15,280
so um

77
00:02:15,280 --> 00:02:16,800
really the patches at the bottom there

78
00:02:16,800 --> 00:02:18,720
will kind of give you a good rundown of

79
00:02:18,720 --> 00:02:21,200
a little bit of my story so i was

80
00:02:21,200 --> 00:02:22,480
fortunate enough to go to the air force

81
00:02:22,480 --> 00:02:24,239
academy so that first

82
00:02:24,239 --> 00:02:26,800
patch there is cadet squadron 11. i got

83
00:02:26,800 --> 00:02:29,599
my master's degree from virginia tech

84
00:02:29,599 --> 00:02:31,680
immediately after graduating college i

85
00:02:31,680 --> 00:02:32,720
was sent to

86
00:02:32,720 --> 00:02:36,000
england and while over there

87
00:02:36,000 --> 00:02:38,480
i had a blast i was part of a special

88
00:02:38,480 --> 00:02:40,560
operations support squadron

89
00:02:40,560 --> 00:02:43,840
and so my job was to be

90
00:02:43,840 --> 00:02:45,200
dropped out of a plane in the middle of

91
00:02:45,200 --> 00:02:47,760
a field uh and set up a network that

92
00:02:47,760 --> 00:02:49,040
supports

93
00:02:49,040 --> 00:02:52,160
unclassified classified nato classified

94
00:02:52,160 --> 00:02:55,599
networks for up to 1200 people in 12

95
00:02:55,599 --> 00:02:57,040
hours right so

96
00:02:57,040 --> 00:03:00,080
really tactical combat com type stuff

97
00:03:00,080 --> 00:03:00,640
where

98
00:03:00,640 --> 00:03:02,879
i really got to get my hands dirty learn

99
00:03:02,879 --> 00:03:03,760
networking

100
00:03:03,760 --> 00:03:06,239
drinking from a fire hose and it was

101
00:03:06,239 --> 00:03:07,920
absolutely a blast my wife and i went to

102
00:03:07,920 --> 00:03:10,080
32 countries while we lived there

103
00:03:10,080 --> 00:03:12,720
after that i got stationed in what is

104
00:03:12,720 --> 00:03:14,080
normally sunny

105
00:03:14,080 --> 00:03:17,440
florida that just got hit pretty hard by

106
00:03:17,440 --> 00:03:20,080
uh hurricane sally uh but right there

107
00:03:20,080 --> 00:03:21,519
next to pensacola actually is where i

108
00:03:21,519 --> 00:03:23,120
was stationed and there i was part of

109
00:03:23,120 --> 00:03:24,799
operational test and evaluation

110
00:03:24,799 --> 00:03:27,840
and so we were the uh

111
00:03:27,840 --> 00:03:29,840
final check of a system before the air

112
00:03:29,840 --> 00:03:31,920
force purchased it right so

113
00:03:31,920 --> 00:03:33,280
you know one of the things i got to do

114
00:03:33,280 --> 00:03:34,480
there is do the cyber security

115
00:03:34,480 --> 00:03:36,879
evaluation of the integrated air defense

116
00:03:36,879 --> 00:03:38,239
over washington dc

117
00:03:38,239 --> 00:03:39,920
uh so making sure obviously there's no

118
00:03:39,920 --> 00:03:41,280
cyber security vulnerabilities that's

119
00:03:41,280 --> 00:03:42,879
going to cause one of those missiles to

120
00:03:42,879 --> 00:03:44,480
to take out an airliner or anything like

121
00:03:44,480 --> 00:03:46,560
that so i learned a lot while i was

122
00:03:46,560 --> 00:03:49,040
there the next patch there is a wall

123
00:03:49,040 --> 00:03:50,799
station in florida i was right next door

124
00:03:50,799 --> 00:03:52,560
to the cyber school house

125
00:03:52,560 --> 00:03:55,599
and so one of the things that uh i was

126
00:03:55,599 --> 00:03:57,280
fortunate to do is i just knocked on

127
00:03:57,280 --> 00:03:58,640
their door every single day and said hey

128
00:03:58,640 --> 00:04:00,400
do you have any availability any classes

129
00:04:00,400 --> 00:04:01,120
that are open

130
00:04:01,120 --> 00:04:03,680
and one day somebody had problems with

131
00:04:03,680 --> 00:04:04,720
their security clearance because you

132
00:04:04,720 --> 00:04:06,159
have to have a top secret clearance to

133
00:04:06,159 --> 00:04:06,799
go through that

134
00:04:06,799 --> 00:04:08,319
and i was fortunate enough to get a spot

135
00:04:08,319 --> 00:04:11,120
so i am a fortunate graduate of the

136
00:04:11,120 --> 00:04:12,560
cyber warfare training

137
00:04:12,560 --> 00:04:16,238
uh and uh while so while there the last

138
00:04:16,238 --> 00:04:18,160
patch there is i was able to deploy

139
00:04:18,160 --> 00:04:21,358
uh to uh qatar and i was

140
00:04:21,358 --> 00:04:23,199
uh actually in charge of the building

141
00:04:23,199 --> 00:04:25,440
where the backbone of the internet for

142
00:04:25,440 --> 00:04:29,040
uh all troops so uh availability was

143
00:04:29,040 --> 00:04:30,720
obviously a very big deal just making

144
00:04:30,720 --> 00:04:32,240
sure that uh the generators were

145
00:04:32,240 --> 00:04:34,000
regularly tested and nothing went down

146
00:04:34,000 --> 00:04:34,639
because

147
00:04:34,639 --> 00:04:36,960
uh it was the tier one network so uh

148
00:04:36,960 --> 00:04:37,919
other than that

149
00:04:37,919 --> 00:04:40,080
my hobbies i you know recently getting

150
00:04:40,080 --> 00:04:41,919
into big green eggs so if you have any

151
00:04:41,919 --> 00:04:44,240
recipes for me uh drop it in the chat

152
00:04:44,240 --> 00:04:45,199
and

153
00:04:45,199 --> 00:04:46,880
i have three year old twins a boy and a

154
00:04:46,880 --> 00:04:49,440
girl so when i am not

155
00:04:49,440 --> 00:04:52,560
uh doing uh security work obviously i'm

156
00:04:52,560 --> 00:04:54,479
chasing them around and probably pulling

157
00:04:54,479 --> 00:04:55,600
out my hair

158
00:04:55,600 --> 00:04:57,919
uh finally there's my twitter or twitter

159
00:04:57,919 --> 00:04:58,800
hashtag

160
00:04:58,800 --> 00:05:01,280
or whatever if you want to follow me

161
00:05:01,280 --> 00:05:02,479
cool

162
00:05:02,479 --> 00:05:04,880
let's set the stage then so this test

163
00:05:04,880 --> 00:05:05,520
was a

164
00:05:05,520 --> 00:05:07,600
major hospital in the pacific northwest

165
00:05:07,600 --> 00:05:09,440
obviously due to non-disclosure

166
00:05:09,440 --> 00:05:10,960
agreements we're not going to talk about

167
00:05:10,960 --> 00:05:13,520
exactly what hospital was uh but you can

168
00:05:13,520 --> 00:05:15,440
just assume it's one of the major ones

169
00:05:15,440 --> 00:05:17,759
uh in somewhere in the pacific northwest

170
00:05:17,759 --> 00:05:18,720
so

171
00:05:18,720 --> 00:05:22,080
california oregon washington alaska

172
00:05:22,080 --> 00:05:23,759
idaho i don't really know what else is

173
00:05:23,759 --> 00:05:25,600
in the pacific northwest but one of

174
00:05:25,600 --> 00:05:26,240
those

175
00:05:26,240 --> 00:05:28,639
uh and we started with an external

176
00:05:28,639 --> 00:05:29,680
penetration test

177
00:05:29,680 --> 00:05:32,560
in february of 2020 so right when uh

178
00:05:32,560 --> 00:05:34,800
this all started and if you remember

179
00:05:34,800 --> 00:05:36,560
uh the pacific northwest was one of the

180
00:05:36,560 --> 00:05:38,080
entry points one of the first kind of

181
00:05:38,080 --> 00:05:39,759
states hit hard by it so there was

182
00:05:39,759 --> 00:05:41,120
already a little bit

183
00:05:41,120 --> 00:05:44,160
of of concern and for reasons that we

184
00:05:44,160 --> 00:05:45,280
will go over

185
00:05:45,280 --> 00:05:47,360
after the external penetration test was

186
00:05:47,360 --> 00:05:48,400
done

187
00:05:48,400 --> 00:05:51,600
we convinced them or you know you know

188
00:05:51,600 --> 00:05:52,880
we had a conversation where

189
00:05:52,880 --> 00:05:55,759
uh it expanded into a social engineering

190
00:05:55,759 --> 00:05:56,240
uh

191
00:05:56,240 --> 00:05:58,639
and then into a internal penetration

192
00:05:58,639 --> 00:05:59,759
test

193
00:05:59,759 --> 00:06:01,840
the internal penetration test was done

194
00:06:01,840 --> 00:06:03,039
uh late june

195
00:06:03,039 --> 00:06:06,400
of 2020. so uh are some representative

196
00:06:06,400 --> 00:06:08,880
excuse me representative charts of the

197
00:06:08,880 --> 00:06:10,720
various states going through

198
00:06:10,720 --> 00:06:14,080
um you know coven 19 at this time and so

199
00:06:14,080 --> 00:06:16,080
as you can clearly see you know they're

200
00:06:16,080 --> 00:06:17,759
spiking so what does that mean

201
00:06:17,759 --> 00:06:20,319
well uh first and foremost one of the uh

202
00:06:20,319 --> 00:06:21,759
elements of this whole thing

203
00:06:21,759 --> 00:06:23,840
uh and one of the lessons learned for

204
00:06:23,840 --> 00:06:25,919
red teamers is availability is

205
00:06:25,919 --> 00:06:28,400
absolutely imperative right our job or

206
00:06:28,400 --> 00:06:30,080
my job as a penetration tester

207
00:06:30,080 --> 00:06:33,120
is to balance giving my client a good

208
00:06:33,120 --> 00:06:34,319
understanding of the risk

209
00:06:34,319 --> 00:06:37,120
so that they can realize what type of

210
00:06:37,120 --> 00:06:37,919
attacks they

211
00:06:37,919 --> 00:06:39,840
are up against and how to defend against

212
00:06:39,840 --> 00:06:41,680
them but at the same time

213
00:06:41,680 --> 00:06:43,680
uh keeping their network running is is

214
00:06:43,680 --> 00:06:45,680
one of my primary concerns during a test

215
00:06:45,680 --> 00:06:46,000
so

216
00:06:46,000 --> 00:06:48,960
anything i do i'm going to make sure

217
00:06:48,960 --> 00:06:50,080
that

218
00:06:50,080 --> 00:06:52,479
i'm keeping in mind availability

219
00:06:52,479 --> 00:06:53,199
obviously

220
00:06:53,199 --> 00:06:55,280
we all know not to do denial of service

221
00:06:55,280 --> 00:06:56,319
attacks but

222
00:06:56,319 --> 00:06:57,599
one of the conversations i want to have

223
00:06:57,599 --> 00:06:59,120
is how do you choose the right exploit

224
00:06:59,120 --> 00:06:59,840
for

225
00:06:59,840 --> 00:07:03,120
uh you know attacks etc so

226
00:07:03,120 --> 00:07:06,080
um that's the stage and and let's kind

227
00:07:06,080 --> 00:07:06,720
of jump

228
00:07:06,720 --> 00:07:09,039
right into it then so first is the

229
00:07:09,039 --> 00:07:10,800
external penetration test again this

230
00:07:10,800 --> 00:07:12,479
took place in february

231
00:07:12,479 --> 00:07:14,400
for those who are not familiar with the

232
00:07:14,400 --> 00:07:17,039
terminology external penetration test

233
00:07:17,039 --> 00:07:18,880
is essentially a hacker on the internet

234
00:07:18,880 --> 00:07:20,240
what can they see

235
00:07:20,240 --> 00:07:22,080
from the network is networks and

236
00:07:22,080 --> 00:07:24,000
services exposed

237
00:07:24,000 --> 00:07:25,680
is there anything that you have exposed

238
00:07:25,680 --> 00:07:27,520
to the internet that may be

239
00:07:27,520 --> 00:07:29,599
vulnerable and then further it also

240
00:07:29,599 --> 00:07:30,880
includes things like open source

241
00:07:30,880 --> 00:07:32,319
intelligence so doing

242
00:07:32,319 --> 00:07:35,520
uh crafted google searches um searching

243
00:07:35,520 --> 00:07:37,039
your social media to see if there's any

244
00:07:37,039 --> 00:07:38,479
sensitive information

245
00:07:38,479 --> 00:07:40,960
uh that maybe should not be there right

246
00:07:40,960 --> 00:07:41,599
so

247
00:07:41,599 --> 00:07:43,919
um as part of the external penetration

248
00:07:43,919 --> 00:07:44,800
test we were

249
00:07:44,800 --> 00:07:47,039
enumerating everything that they had

250
00:07:47,039 --> 00:07:48,560
listening on the network and one of the

251
00:07:48,560 --> 00:07:51,360
things we came across was an owa server

252
00:07:51,360 --> 00:07:54,400
um so jackpot right so

253
00:07:54,400 --> 00:07:57,599
owa is vulnerable to something called

254
00:07:57,599 --> 00:08:00,639
timing based username enumeration and so

255
00:08:00,639 --> 00:08:02,479
this is uh really what it looks like

256
00:08:02,479 --> 00:08:05,199
here uh from the attack so

257
00:08:05,199 --> 00:08:08,560
um you can see that first arrow points

258
00:08:08,560 --> 00:08:09,120
to

259
00:08:09,120 --> 00:08:12,479
a failed login that took the server

260
00:08:12,479 --> 00:08:15,360
about three seconds to respond to me uh

261
00:08:15,360 --> 00:08:15,759
so

262
00:08:15,759 --> 00:08:18,800
from that i can ascertain uh that that

263
00:08:18,800 --> 00:08:22,000
is a invalid password attempt and it is

264
00:08:22,000 --> 00:08:23,599
not a valid user

265
00:08:23,599 --> 00:08:26,319
because as you can see with the second

266
00:08:26,319 --> 00:08:27,039
uh

267
00:08:27,039 --> 00:08:30,160
log in there that that user

268
00:08:30,160 --> 00:08:33,200
the a clark user for example responded

269
00:08:33,200 --> 00:08:34,719
in less than a second

270
00:08:34,719 --> 00:08:36,958
still not a valid password right but

271
00:08:36,958 --> 00:08:38,958
what i can see is that that is a valid

272
00:08:38,958 --> 00:08:40,240
username so

273
00:08:40,240 --> 00:08:43,120
um with owa servers you can ascertain

274
00:08:43,120 --> 00:08:45,200
whether a user is valid or not by the

275
00:08:45,200 --> 00:08:47,440
time it takes the server to respond

276
00:08:47,440 --> 00:08:49,920
um there is other forms of username

277
00:08:49,920 --> 00:08:51,200
enumeration out there

278
00:08:51,200 --> 00:08:54,080
of course my favorite is just when uh

279
00:08:54,080 --> 00:08:54,399
you

280
00:08:54,399 --> 00:08:57,040
go to a type in the password it says

281
00:08:57,040 --> 00:08:58,480
this is not a valid user right that's

282
00:08:58,480 --> 00:08:59,440
the easiest

283
00:08:59,440 --> 00:09:01,760
um there's tools that are available uh

284
00:09:01,760 --> 00:09:02,880
primarily this

285
00:09:02,880 --> 00:09:04,640
right here is a picture of metasploit

286
00:09:04,640 --> 00:09:06,080
but there's also uh

287
00:09:06,080 --> 00:09:07,920
just using burp professional where you

288
00:09:07,920 --> 00:09:11,200
can enumerate things like the time

289
00:09:11,200 --> 00:09:12,560
of the response the length of the

290
00:09:12,560 --> 00:09:14,640
response you can even do keyword

291
00:09:14,640 --> 00:09:15,600
searches

292
00:09:15,600 --> 00:09:19,040
uh for the uh invalid error code for

293
00:09:19,040 --> 00:09:20,000
example

294
00:09:20,000 --> 00:09:23,440
uh and in through that you can develop a

295
00:09:23,440 --> 00:09:25,279
list of of common users

296
00:09:25,279 --> 00:09:28,000
right so the first thing we need to know

297
00:09:28,000 --> 00:09:28,640
is

298
00:09:28,640 --> 00:09:31,760
what is their username convention so

299
00:09:31,760 --> 00:09:34,480
uh the first thing we did for that is we

300
00:09:34,480 --> 00:09:35,920
searched google

301
00:09:35,920 --> 00:09:38,000
and i'm looking for anything that ends

302
00:09:38,000 --> 00:09:40,560
in their domain so at hospital.com for

303
00:09:40,560 --> 00:09:41,519
example

304
00:09:41,519 --> 00:09:44,240
um so just doing crafted google searches

305
00:09:44,240 --> 00:09:46,399
for at hospital.com and i'm looking for

306
00:09:46,399 --> 00:09:48,800
things that are email addresses

307
00:09:48,800 --> 00:09:50,399
so of course we're going to run into

308
00:09:50,399 --> 00:09:52,040
things like info

309
00:09:52,040 --> 00:09:55,920
hospital.com and careers hospital.com

310
00:09:55,920 --> 00:09:58,800
uh but eventually hopefully we find one

311
00:09:58,800 --> 00:09:59,519
or two

312
00:09:59,519 --> 00:10:01,440
email addresses that are actual users

313
00:10:01,440 --> 00:10:02,560
maybe from their

314
00:10:02,560 --> 00:10:06,240
uh local local social club

315
00:10:06,240 --> 00:10:09,760
or they're using their company email for

316
00:10:09,760 --> 00:10:11,839
personal or they did a webinar and they

317
00:10:11,839 --> 00:10:14,640
released their email that way right

318
00:10:14,640 --> 00:10:17,360
so through that we can make sure we know

319
00:10:17,360 --> 00:10:18,079
their username

320
00:10:18,079 --> 00:10:20,000
format and then the next thing we do is

321
00:10:20,000 --> 00:10:21,440
we took advantage of this

322
00:10:21,440 --> 00:10:24,480
username enumeration through the time uh

323
00:10:24,480 --> 00:10:26,000
to validate that that's right so we

324
00:10:26,000 --> 00:10:27,680
tried a few usernames that are

325
00:10:27,680 --> 00:10:31,519
common names as first name dot last name

326
00:10:31,519 --> 00:10:33,040
first name straight in to last name

327
00:10:33,040 --> 00:10:34,800
first initial last name

328
00:10:34,800 --> 00:10:37,680
uh etc and through that we can see that

329
00:10:37,680 --> 00:10:39,680
okay we have a pretty good idea

330
00:10:39,680 --> 00:10:42,079
that it is first initial last name for

331
00:10:42,079 --> 00:10:44,240
this particular client

332
00:10:44,240 --> 00:10:46,079
great now that we know that the second

333
00:10:46,079 --> 00:10:48,000
thing we can do is we can use all the

334
00:10:48,000 --> 00:10:49,519
information available to us

335
00:10:49,519 --> 00:10:52,320
specifically linkedin right so we go to

336
00:10:52,320 --> 00:10:53,279
linkedin for

337
00:10:53,279 --> 00:10:56,000
uh pacific northwest hospital and we can

338
00:10:56,000 --> 00:10:56,480
see

339
00:10:56,480 --> 00:11:00,240
they have 450 employees available

340
00:11:00,240 --> 00:11:02,880
on the network or on linkedin so perfect

341
00:11:02,880 --> 00:11:04,480
let's take all their names and put them

342
00:11:04,480 --> 00:11:07,040
in the first initial last name format

343
00:11:07,040 --> 00:11:10,000
and now we have a list of 438 potential

344
00:11:10,000 --> 00:11:10,880
usernames

345
00:11:10,880 --> 00:11:12,959
great let's take it a step further

346
00:11:12,959 --> 00:11:14,000
though uh

347
00:11:14,000 --> 00:11:18,000
and let's take a list of the top oh 1000

348
00:11:18,000 --> 00:11:21,760
most common last names and

349
00:11:21,760 --> 00:11:24,720
try every you know alphabet character a

350
00:11:24,720 --> 00:11:25,440
through z

351
00:11:25,440 --> 00:11:27,680
in front of the most common last names

352
00:11:27,680 --> 00:11:29,760
you know that gives us a list of uh what

353
00:11:29,760 --> 00:11:31,200
26 000

354
00:11:31,200 --> 00:11:34,079
plus the 438 that we think are valid put

355
00:11:34,079 --> 00:11:36,000
it all into one giant list and let's run

356
00:11:36,000 --> 00:11:38,480
it through this username and numeration

357
00:11:38,480 --> 00:11:41,760
and develop a list of valid usernames

358
00:11:41,760 --> 00:11:44,160
once i have that list of valid usernames

359
00:11:44,160 --> 00:11:45,760
i'm going to do what is a

360
00:11:45,760 --> 00:11:49,279
called a password spring attack

361
00:11:49,279 --> 00:11:51,920
so a password spring attack reverses the

362
00:11:51,920 --> 00:11:53,760
paradigm of a traditional password

363
00:11:53,760 --> 00:11:55,120
attack right so

364
00:11:55,120 --> 00:11:57,120
traditional password attack i might be

365
00:11:57,120 --> 00:11:58,399
doing the username

366
00:11:58,399 --> 00:12:01,680
administrator and uh trying the most

367
00:12:01,680 --> 00:12:03,600
top 1000 passwords or something like

368
00:12:03,600 --> 00:12:05,839
that uh trying to guess whatever that

369
00:12:05,839 --> 00:12:07,360
administrator password is

370
00:12:07,360 --> 00:12:09,519
uh in a password spraying attack though

371
00:12:09,519 --> 00:12:11,200
i'm reversing that paradigm

372
00:12:11,200 --> 00:12:14,480
instead of a thousand passwords with one

373
00:12:14,480 --> 00:12:16,240
username i'm trying a thousand

374
00:12:16,240 --> 00:12:19,120
usernames with one password so this

375
00:12:19,120 --> 00:12:20,720
gives me several advantages one

376
00:12:20,720 --> 00:12:21,680
instead of trying to guess the

377
00:12:21,680 --> 00:12:23,760
administrator password which hopefully

378
00:12:23,760 --> 00:12:26,480
knock on wood is a secure password i'm

379
00:12:26,480 --> 00:12:28,160
only trying to find the weakest link so

380
00:12:28,160 --> 00:12:29,839
all i need to do is find whoever has the

381
00:12:29,839 --> 00:12:31,839
weakest password in the organization

382
00:12:31,839 --> 00:12:34,079
uh the other thing is i can avoid things

383
00:12:34,079 --> 00:12:35,760
like account lockouts

384
00:12:35,760 --> 00:12:37,519
uh you know account lockouts if i were

385
00:12:37,519 --> 00:12:39,040
to type in the wrong password for one of

386
00:12:39,040 --> 00:12:40,480
these usernames more than

387
00:12:40,480 --> 00:12:42,560
i don't know three times it's gonna lock

388
00:12:42,560 --> 00:12:43,760
out the account right

389
00:12:43,760 --> 00:12:46,160
uh but if i'm able to do a password

390
00:12:46,160 --> 00:12:48,240
spraying attack the end result is

391
00:12:48,240 --> 00:12:51,920
one invalid password attempt per user

392
00:12:51,920 --> 00:12:53,839
per time i run it right so

393
00:12:53,839 --> 00:12:55,600
as long as i'm doing this once every 30

394
00:12:55,600 --> 00:12:57,040
minutes i'm staying

395
00:12:57,040 --> 00:12:58,880
way below and we actually ran it twice

396
00:12:58,880 --> 00:13:00,880
every 30 minutes but that's still

397
00:13:00,880 --> 00:13:03,360
way below the account lockout threshold

398
00:13:03,360 --> 00:13:04,959
and lets me search for whatever that

399
00:13:04,959 --> 00:13:06,399
weakest password is

400
00:13:06,399 --> 00:13:09,519
without necessarily um

401
00:13:09,519 --> 00:13:12,079
ever locking out accounts probably not

402
00:13:12,079 --> 00:13:13,200
being detected

403
00:13:13,200 --> 00:13:16,399
the simple fact is most organizations

404
00:13:16,399 --> 00:13:18,720
or most alerting systems don't alert to

405
00:13:18,720 --> 00:13:20,720
just one invalid password attempt

406
00:13:20,720 --> 00:13:23,360
they should because it's actually 26 000

407
00:13:23,360 --> 00:13:25,120
invalid password attempts from one ip

408
00:13:25,120 --> 00:13:26,560
address but each of them is just a

409
00:13:26,560 --> 00:13:28,000
unique username

410
00:13:28,000 --> 00:13:31,200
so it is not actually alerting so great

411
00:13:31,200 --> 00:13:33,040
so now i'm searching for the weakest

412
00:13:33,040 --> 00:13:34,720
password what is the weakest password

413
00:13:34,720 --> 00:13:36,240
well as you can see here i'm trying

414
00:13:36,240 --> 00:13:36,639
spring

415
00:13:36,639 --> 00:13:40,000
2020 and that didn't work and so let's

416
00:13:40,000 --> 00:13:42,399
try winter 2020 and again this is in

417
00:13:42,399 --> 00:13:43,040
february

418
00:13:43,040 --> 00:13:44,560
so oh what do you know we have

419
00:13:44,560 --> 00:13:46,160
successful login right

420
00:13:46,160 --> 00:13:47,839
so here's the thing when you're making

421
00:13:47,839 --> 00:13:49,360
your users change their password every

422
00:13:49,360 --> 00:13:50,399
90 days

423
00:13:50,399 --> 00:13:53,440
you would be amazed uh probably 60 of

424
00:13:53,440 --> 00:13:54,959
the time one of them is going to have

425
00:13:54,959 --> 00:13:57,760
the season and the year why because it

426
00:13:57,760 --> 00:13:59,199
meets the password complexity

427
00:13:59,199 --> 00:14:00,000
requirements

428
00:14:00,000 --> 00:14:01,839
it's long enough and it's easy to

429
00:14:01,839 --> 00:14:03,760
remember so users are doing

430
00:14:03,760 --> 00:14:08,480
winter 2020 spring 2020 summer 2020

431
00:14:08,480 --> 00:14:11,040
fall 2020 et cetera uh simply because

432
00:14:11,040 --> 00:14:12,320
they don't have to think up a password

433
00:14:12,320 --> 00:14:13,680
it's too hard for users to pick up

434
00:14:13,680 --> 00:14:15,360
passwords i guess right so

435
00:14:15,360 --> 00:14:17,920
uh great now that we have the owa login

436
00:14:17,920 --> 00:14:20,079
let's log in and see what we have oh

437
00:14:20,079 --> 00:14:23,120
ephi oh man this is a picture of power

438
00:14:23,120 --> 00:14:24,399
chart which is what they use for their

439
00:14:24,399 --> 00:14:25,920
hospital records that's probably not

440
00:14:25,920 --> 00:14:26,480
good

441
00:14:26,480 --> 00:14:31,279
right so great we have a good finding

442
00:14:32,880 --> 00:14:34,000
the hospital is definitely going to be

443
00:14:34,000 --> 00:14:35,839
interested the fact that they have this

444
00:14:35,839 --> 00:14:36,639
exposed

445
00:14:36,639 --> 00:14:38,639
that their users are sending you know

446
00:14:38,639 --> 00:14:40,560
sensitive information back and forth

447
00:14:40,560 --> 00:14:44,160
um etc so great but i want to do further

448
00:14:44,160 --> 00:14:44,959
right so

449
00:14:44,959 --> 00:14:46,160
the ultimate goal of an external

450
00:14:46,160 --> 00:14:48,399
penetration test is to gain access to

451
00:14:48,399 --> 00:14:49,680
the internal network right because i

452
00:14:49,680 --> 00:14:51,440
want to try to break in if a think of a

453
00:14:51,440 --> 00:14:52,959
ransomware attack would want have to

454
00:14:52,959 --> 00:14:54,160
have internal access

455
00:14:54,160 --> 00:14:56,320
uh yeah i can get some phi on the

456
00:14:56,320 --> 00:14:58,480
external especially from their owa

457
00:14:58,480 --> 00:15:00,160
but if i have internal network access

458
00:15:00,160 --> 00:15:01,360
and i can directly access these

459
00:15:01,360 --> 00:15:02,880
applications myself

460
00:15:02,880 --> 00:15:04,399
that's a whole lot more information than

461
00:15:04,399 --> 00:15:06,800
i'm able to see uh just from this user's

462
00:15:06,800 --> 00:15:07,279
email

463
00:15:07,279 --> 00:15:09,920
so perfect so my next target of course

464
00:15:09,920 --> 00:15:10,399
is

465
00:15:10,399 --> 00:15:14,720
the vpn and their vpn had multi-factor

466
00:15:14,720 --> 00:15:17,040
uh authentication right so close yet so

467
00:15:17,040 --> 00:15:18,880
far um

468
00:15:18,880 --> 00:15:21,360
you know a random disclosure here

469
00:15:21,360 --> 00:15:22,240
jarissa

470
00:15:22,240 --> 00:15:24,079
this is just a random picture i found on

471
00:15:24,079 --> 00:15:25,360
google right so don't

472
00:15:25,360 --> 00:15:26,800
don't be trying to risk that with winter

473
00:15:26,800 --> 00:15:28,800
2020 and and uh

474
00:15:28,800 --> 00:15:30,079
you know hopefully she doesn't actually

475
00:15:30,079 --> 00:15:31,839
have that password but uh

476
00:15:31,839 --> 00:15:35,040
uh so we logged into the vpn and

477
00:15:35,040 --> 00:15:36,880
immediately we're prompted with uh

478
00:15:36,880 --> 00:15:38,800
entering a second form of authentication

479
00:15:38,800 --> 00:15:40,959
right multi-factor authentication

480
00:15:40,959 --> 00:15:43,040
so we weren't actually able to break in

481
00:15:43,040 --> 00:15:44,639
there so this is great this is the

482
00:15:44,639 --> 00:15:46,000
strength for the report

483
00:15:46,000 --> 00:15:48,399
um so let's go on so you know let's talk

484
00:15:48,399 --> 00:15:50,000
about what we've already found so far so

485
00:15:50,000 --> 00:15:52,160
how do i fix this right so

486
00:15:52,160 --> 00:15:54,720
first and foremost this is why

487
00:15:54,720 --> 00:15:56,240
multi-factor authentication is so

488
00:15:56,240 --> 00:15:57,199
important

489
00:15:57,199 --> 00:15:59,040
we'll talk about it again when we get

490
00:15:59,040 --> 00:16:00,320
into the

491
00:16:00,320 --> 00:16:03,920
um into the social engineering findings

492
00:16:03,920 --> 00:16:06,320
right but multi-factor authentication

493
00:16:06,320 --> 00:16:07,920
by prompting their phone after the

494
00:16:07,920 --> 00:16:09,440
password attack or

495
00:16:09,440 --> 00:16:11,120
making a user type in a one-time

496
00:16:11,120 --> 00:16:12,639
password uh

497
00:16:12,639 --> 00:16:14,880
you know that is why multi-factor is

498
00:16:14,880 --> 00:16:15,839
there it is so

499
00:16:15,839 --> 00:16:18,720
important uh for that because the simple

500
00:16:18,720 --> 00:16:20,399
fact is regardless of if your password

501
00:16:20,399 --> 00:16:22,480
policy was 14 characters 20 characters

502
00:16:22,480 --> 00:16:24,240
or whatever users are going to choose

503
00:16:24,240 --> 00:16:26,560
i mean 20 are are going to choose stupid

504
00:16:26,560 --> 00:16:27,440
passwords

505
00:16:27,440 --> 00:16:30,399
um you know we have certain clients that

506
00:16:30,399 --> 00:16:32,560
have 20 character passwords

507
00:16:32,560 --> 00:16:36,320
and they're um you know their

508
00:16:36,320 --> 00:16:38,079
password is company name company name

509
00:16:38,079 --> 00:16:40,399
company name company name or

510
00:16:40,399 --> 00:16:42,800
this is really stupid right so um the

511
00:16:42,800 --> 00:16:44,399
fact is users are always going to choose

512
00:16:44,399 --> 00:16:46,079
bad passwords and that's the importance

513
00:16:46,079 --> 00:16:46,720
of

514
00:16:46,720 --> 00:16:49,600
multi-factor authentication secondly uh

515
00:16:49,600 --> 00:16:52,000
increase the password strength right so

516
00:16:52,000 --> 00:16:55,360
um it's important uh for us

517
00:16:55,360 --> 00:16:58,639
as penetration testers um to not give a

518
00:16:58,639 --> 00:17:00,000
subjective opinion here

519
00:17:00,000 --> 00:17:02,320
uh and i you know i have yet to get

520
00:17:02,320 --> 00:17:03,360
through a

521
00:17:03,360 --> 00:17:06,400
uh presentation without uh the client

522
00:17:06,400 --> 00:17:08,079
saying okay great what do you recommend

523
00:17:08,079 --> 00:17:09,839
for passwords then

524
00:17:09,839 --> 00:17:11,919
well we always fall back on the center

525
00:17:11,919 --> 00:17:13,199
for internet security right it's a

526
00:17:13,199 --> 00:17:15,119
standard for a reason so we should fall

527
00:17:15,119 --> 00:17:16,959
back on the industry standards say 14

528
00:17:16,959 --> 00:17:18,319
characters you know that's what we

529
00:17:18,319 --> 00:17:20,079
choose to do at triaxia

530
00:17:20,079 --> 00:17:23,119
but most importantly it has to be

531
00:17:23,119 --> 00:17:25,760
combined with user education

532
00:17:25,760 --> 00:17:27,599
you know it is far more important than

533
00:17:27,599 --> 00:17:28,799
the length of the password is

534
00:17:28,799 --> 00:17:30,400
for people to know how to choose strong

535
00:17:30,400 --> 00:17:32,640
passwords and you know we give awareness

536
00:17:32,640 --> 00:17:35,120
training all the time and i love to walk

537
00:17:35,120 --> 00:17:36,000
users through

538
00:17:36,000 --> 00:17:38,720
exactly how we crack passwords and how

539
00:17:38,720 --> 00:17:40,080
to choose a strong password

540
00:17:40,080 --> 00:17:41,760
what i find is as silly as it sounds

541
00:17:41,760 --> 00:17:43,600
users do not know how to choose a strong

542
00:17:43,600 --> 00:17:44,880
password

543
00:17:44,880 --> 00:17:46,799
users are doing things like their kids

544
00:17:46,799 --> 00:17:48,400
name with some symbols at the end

545
00:17:48,400 --> 00:17:49,679
they're adding ads and thinking it's

546
00:17:49,679 --> 00:17:51,039
making it harder for us

547
00:17:51,039 --> 00:17:53,600
uh the reality is uh when we're doing a

548
00:17:53,600 --> 00:17:54,240
password

549
00:17:54,240 --> 00:17:57,120
attack and just kind of uh some some

550
00:17:57,120 --> 00:17:57,760
inside

551
00:17:57,760 --> 00:18:00,000
uh how we crack passwords that tracks

552
00:18:00,000 --> 00:18:02,240
him um the first thing we do is we run

553
00:18:02,240 --> 00:18:03,280
through every

554
00:18:03,280 --> 00:18:05,120
uh password list we can think of so we

555
00:18:05,120 --> 00:18:06,559
have every dictionary word

556
00:18:06,559 --> 00:18:09,760
every uh bible verse we have every curse

557
00:18:09,760 --> 00:18:11,600
word every sports team name

558
00:18:11,600 --> 00:18:15,919
uh common phrases uh french phrases

559
00:18:15,919 --> 00:18:18,720
previous data breaches etc and so we

560
00:18:18,720 --> 00:18:19,840
just run through those

561
00:18:19,840 --> 00:18:21,520
and to put that into context it takes

562
00:18:21,520 --> 00:18:23,360
our machine about i don't know 15

563
00:18:23,360 --> 00:18:24,640
minutes to run through all the password

564
00:18:24,640 --> 00:18:25,679
lists we have we're talking about

565
00:18:25,679 --> 00:18:26,880
terabytes of data

566
00:18:26,880 --> 00:18:30,320
the next thing we do is add rules to

567
00:18:30,320 --> 00:18:32,400
those so we choose a standard

568
00:18:32,400 --> 00:18:34,720
password which is usually a combination

569
00:18:34,720 --> 00:18:35,600
of

570
00:18:35,600 --> 00:18:38,160
dictionary words sports teams etc and

571
00:18:38,160 --> 00:18:40,080
we'll just change the a's to ads we'll

572
00:18:40,080 --> 00:18:40,480
change

573
00:18:40,480 --> 00:18:44,000
the fives to or excuse me the s's to

574
00:18:44,000 --> 00:18:46,080
fives or dollar signs right

575
00:18:46,080 --> 00:18:47,760
we'll add one two three exclamation

576
00:18:47,760 --> 00:18:49,520
point at the end uh we will

577
00:18:49,520 --> 00:18:52,559
change it to uppercase lowercase etc

578
00:18:52,559 --> 00:18:56,080
really uh yeah that only takes us maybe

579
00:18:56,080 --> 00:18:56,799
an hour

580
00:18:56,799 --> 00:19:00,240
uh so you know by adding at symbols for

581
00:19:00,240 --> 00:19:01,840
your a's you're just making it harder

582
00:19:01,840 --> 00:19:03,280
for yourself to remember

583
00:19:03,280 --> 00:19:05,200
uh and it's no harder for me to guess it

584
00:19:05,200 --> 00:19:07,520
right so um you know the comic on the

585
00:19:07,520 --> 00:19:09,440
right the xkd there

586
00:19:09,440 --> 00:19:11,039
yeah everybody knows that right but it

587
00:19:11,039 --> 00:19:12,880
still holds true um

588
00:19:12,880 --> 00:19:13,840
and i was actually reading an

589
00:19:13,840 --> 00:19:15,679
interesting uh article on it and it's

590
00:19:15,679 --> 00:19:16,960
basically like hey

591
00:19:16,960 --> 00:19:19,760
even this is wrong uh you know we should

592
00:19:19,760 --> 00:19:21,840
be preaching use password managers right

593
00:19:21,840 --> 00:19:22,840
so

594
00:19:22,840 --> 00:19:25,840
um password managers are basically

595
00:19:25,840 --> 00:19:29,679
uh lastpass one pass key pass you know

596
00:19:29,679 --> 00:19:33,120
there's no one is the right

597
00:19:33,120 --> 00:19:35,440
right one uh anyone will work but the

598
00:19:35,440 --> 00:19:37,200
simple fact is those password managers

599
00:19:37,200 --> 00:19:37,840
work as

600
00:19:37,840 --> 00:19:39,440
in you have a single password to get

601
00:19:39,440 --> 00:19:41,280
into your vault and then it knows all

602
00:19:41,280 --> 00:19:42,720
your passwords for you

603
00:19:42,720 --> 00:19:44,160
uh so that you never have to remember

604
00:19:44,160 --> 00:19:46,480
them uh so for example if you put a gun

605
00:19:46,480 --> 00:19:47,840
to my head right now and ask me for my

606
00:19:47,840 --> 00:19:49,600
bank password i don't know it i know the

607
00:19:49,600 --> 00:19:51,440
password to i use lastpass but

608
00:19:51,440 --> 00:19:53,120
i know the password to my lastpass but

609
00:19:53,120 --> 00:19:54,720
that's it right so uh

610
00:19:54,720 --> 00:19:56,559
one if you needed that password if i

611
00:19:56,559 --> 00:19:57,919
need it for any reason i have to log

612
00:19:57,919 --> 00:19:59,919
into lastpass first and then get access

613
00:19:59,919 --> 00:20:00,880
to it so

614
00:20:00,880 --> 00:20:02,799
uh the point is we should just we should

615
00:20:02,799 --> 00:20:05,120
be teaching this to users and we're not

616
00:20:05,120 --> 00:20:07,440
the other thing is we preach uh past

617
00:20:07,440 --> 00:20:09,440
phrases right so

618
00:20:09,440 --> 00:20:11,360
if i take the password i have a yellow

619
00:20:11,360 --> 00:20:12,720
dog named spot

620
00:20:12,720 --> 00:20:14,960
uh and set that as my password that is

621
00:20:14,960 --> 00:20:16,320
way more secure

622
00:20:16,320 --> 00:20:19,200
than any other type of password i'm

623
00:20:19,200 --> 00:20:20,960
going to be able to generate

624
00:20:20,960 --> 00:20:22,640
because it's based off multiple words

625
00:20:22,640 --> 00:20:24,320
keep the spaces whatever

626
00:20:24,320 --> 00:20:25,760
keep the punctuation and the

627
00:20:25,760 --> 00:20:27,360
capitalization perfect

628
00:20:27,360 --> 00:20:29,200
um that's 24 characters there's no way

629
00:20:29,200 --> 00:20:30,720
i'll ever be able to block it if i

630
00:20:30,720 --> 00:20:32,880
want to make it even harder just take

631
00:20:32,880 --> 00:20:34,400
the first letter from each of those and

632
00:20:34,400 --> 00:20:35,679
then add another sentence right so i

633
00:20:35,679 --> 00:20:36,960
have a yellow dog named spot

634
00:20:36,960 --> 00:20:39,440
we picked them out in 2015. perfect now

635
00:20:39,440 --> 00:20:40,480
i have numbers

636
00:20:40,480 --> 00:20:43,280
right so teach that to users that's the

637
00:20:43,280 --> 00:20:44,799
best thing you can do because the simple

638
00:20:44,799 --> 00:20:46,400
fact is if you make

639
00:20:46,400 --> 00:20:48,720
uh your password policy 14 characters

640
00:20:48,720 --> 00:20:49,679
what are you going to do you're going to

641
00:20:49,679 --> 00:20:51,200
have a bunch of people

642
00:20:51,200 --> 00:20:52,880
writing it down on sticky notes or

643
00:20:52,880 --> 00:20:54,320
forgetting their passwords especially in

644
00:20:54,320 --> 00:20:56,080
a hospital right we can't afford

645
00:20:56,080 --> 00:20:58,320
uh to have users locked out of their

646
00:20:58,320 --> 00:20:59,200
accounts especially

647
00:20:59,200 --> 00:21:02,320
in the emergency room for example so um

648
00:21:02,320 --> 00:21:03,919
the other thing is consider a password

649
00:21:03,919 --> 00:21:05,520
blacklist these are becoming more and

650
00:21:05,520 --> 00:21:06,960
more popular

651
00:21:06,960 --> 00:21:08,799
but a password blacklist basically

652
00:21:08,799 --> 00:21:11,280
allows you to put words that should not

653
00:21:11,280 --> 00:21:12,960
be used as part of a password

654
00:21:12,960 --> 00:21:16,320
so you can put winter spring summer

655
00:21:16,320 --> 00:21:18,799
and immediately eliminate those most

656
00:21:18,799 --> 00:21:20,080
common passwords you could put

657
00:21:20,080 --> 00:21:21,679
hospital like or the name of your

658
00:21:21,679 --> 00:21:23,280
company right

659
00:21:23,280 --> 00:21:25,280
and that is going to do wonders to

660
00:21:25,280 --> 00:21:26,720
prevent you

661
00:21:26,720 --> 00:21:28,159
to prevent people from choosing the

662
00:21:28,159 --> 00:21:30,080
weakest passwords because as long as you

663
00:21:30,080 --> 00:21:31,360
can guess the weakest link

664
00:21:31,360 --> 00:21:34,000
i can't uh finally configure alerts

665
00:21:34,000 --> 00:21:34,400
right

666
00:21:34,400 --> 00:21:36,000
as we've already talked about there's no

667
00:21:36,000 --> 00:21:37,840
reason uh why

668
00:21:37,840 --> 00:21:40,880
anybody should be

669
00:21:40,880 --> 00:21:43,600
trying 26 000 passwords from a single

670
00:21:43,600 --> 00:21:44,000
source

671
00:21:44,000 --> 00:21:47,280
ip address right so configure those to

672
00:21:47,280 --> 00:21:49,280
you know and that's a balance right so

673
00:21:49,280 --> 00:21:50,880
you don't want to configure it so it's

674
00:21:50,880 --> 00:21:52,000
crying wolf every time there's an

675
00:21:52,000 --> 00:21:53,360
invalid password attempt

676
00:21:53,360 --> 00:21:54,559
uh but there should be some sort of

677
00:21:54,559 --> 00:21:56,480
threshold below 26 000 where it's

678
00:21:56,480 --> 00:21:58,480
alerting you

679
00:21:58,480 --> 00:22:01,919
okay so great so that's a good test uh

680
00:22:01,919 --> 00:22:04,000
and you know that that's perfect but

681
00:22:04,000 --> 00:22:05,120
there's no real

682
00:22:05,120 --> 00:22:07,840
indication in there why they would want

683
00:22:07,840 --> 00:22:08,559
to do

684
00:22:08,559 --> 00:22:12,320
social engineering or uh internal right

685
00:22:12,320 --> 00:22:14,559
uh yeah but just like 2020 but wait

686
00:22:14,559 --> 00:22:15,840
there's more right so the year that

687
00:22:15,840 --> 00:22:17,679
keeps on giving unfortunately here

688
00:22:17,679 --> 00:22:20,720
um so we talked about they have owa

689
00:22:20,720 --> 00:22:22,640
exposed well the other thing they had

690
00:22:22,640 --> 00:22:24,480
exposed was their servicenow

691
00:22:24,480 --> 00:22:26,480
instance so servicenow for those who

692
00:22:26,480 --> 00:22:27,520
don't know

693
00:22:27,520 --> 00:22:29,520
is a workflow automation process right

694
00:22:29,520 --> 00:22:31,440
so companies use it for all types of

695
00:22:31,440 --> 00:22:32,960
things in this particular case they're

696
00:22:32,960 --> 00:22:35,120
using it to assist in their help desk

697
00:22:35,120 --> 00:22:37,600
so perfect through their single sign-on

698
00:22:37,600 --> 00:22:38,400
portal i'm

699
00:22:38,400 --> 00:22:42,480
able to log into their service now

700
00:22:42,480 --> 00:22:44,960
application and you know as you can see

701
00:22:44,960 --> 00:22:46,480
in this screenshot i'm getting some

702
00:22:46,480 --> 00:22:47,360
helpful

703
00:22:47,360 --> 00:22:51,360
hints and tips on uh how to set up your

704
00:22:51,360 --> 00:22:54,080
personal phone great so now i know

705
00:22:54,080 --> 00:22:55,520
they're using mobile pass

706
00:22:55,520 --> 00:22:57,520
for the iphone well let me download that

707
00:22:57,520 --> 00:22:58,960
app and see what i can do

708
00:22:58,960 --> 00:23:01,679
well no i still it's not configured to

709
00:23:01,679 --> 00:23:02,559
my phone

710
00:23:02,559 --> 00:23:04,320
i have the right application but i don't

711
00:23:04,320 --> 00:23:06,400
have the key so let's see if we can go

712
00:23:06,400 --> 00:23:09,600
further jackpot okay so here

713
00:23:09,600 --> 00:23:13,600
is uh requesting employee

714
00:23:13,600 --> 00:23:15,600
services so for new employees who want

715
00:23:15,600 --> 00:23:17,679
to

716
00:23:17,679 --> 00:23:19,840
request access to the vpn they fill out

717
00:23:19,840 --> 00:23:20,799
this form

718
00:23:20,799 --> 00:23:22,720
well not exactly but it says if you

719
00:23:22,720 --> 00:23:24,640
already have mobile pass

720
00:23:24,640 --> 00:23:26,480
and you're having access issues call the

721
00:23:26,480 --> 00:23:28,240
service desk at this number i obviously

722
00:23:28,240 --> 00:23:29,760
had to block it out right

723
00:23:29,760 --> 00:23:32,320
but call the service desk at this number

724
00:23:32,320 --> 00:23:34,640
and we'll troubleshoot your issues

725
00:23:34,640 --> 00:23:36,880
so i saw this put it in the report and

726
00:23:36,880 --> 00:23:37,840
said hey

727
00:23:37,840 --> 00:23:40,480
i'm willing to bet uh if i called that

728
00:23:40,480 --> 00:23:41,360
number

729
00:23:41,360 --> 00:23:43,760
pretending to be a user they would send

730
00:23:43,760 --> 00:23:45,679
the mobile pass reset

731
00:23:45,679 --> 00:23:48,080
link to my email if i already have

732
00:23:48,080 --> 00:23:50,080
access to a user's email

733
00:23:50,080 --> 00:23:52,400
then maybe i could hypothetically use

734
00:23:52,400 --> 00:23:53,120
that

735
00:23:53,120 --> 00:23:55,279
to social engineer the help desk to give

736
00:23:55,279 --> 00:23:57,360
me access to the vpn and they said

737
00:23:57,360 --> 00:24:00,159
well yes let's try that so that takes us

738
00:24:00,159 --> 00:24:02,799
to social engineering

739
00:24:02,799 --> 00:24:05,200
social engineering is basically doing

740
00:24:05,200 --> 00:24:07,039
anything that takes advantage of the

741
00:24:07,039 --> 00:24:08,640
human element right so

742
00:24:08,640 --> 00:24:10,880
at trix and security we typically do

743
00:24:10,880 --> 00:24:12,320
three different types of social

744
00:24:12,320 --> 00:24:13,600
engineering anytime we do

745
00:24:13,600 --> 00:24:16,159
a social engineering campaign the first

746
00:24:16,159 --> 00:24:16,960
is

747
00:24:16,960 --> 00:24:19,120
and our most successful is wishing right

748
00:24:19,120 --> 00:24:20,640
so that just like we talked about phone

749
00:24:20,640 --> 00:24:21,279
based

750
00:24:21,279 --> 00:24:23,760
um you know generally speaking we're

751
00:24:23,760 --> 00:24:24,960
about 80 to 90

752
00:24:24,960 --> 00:24:26,799
successful when we're doing phone based

753
00:24:26,799 --> 00:24:28,720
social engineering uh the second would

754
00:24:28,720 --> 00:24:30,799
be spearfishing so taking

755
00:24:30,799 --> 00:24:33,200
uh all the information we have to craft

756
00:24:33,200 --> 00:24:34,640
a really individualized

757
00:24:34,640 --> 00:24:37,360
email to a user and seeing if we can't

758
00:24:37,360 --> 00:24:38,960
get them to click on a link they're not

759
00:24:38,960 --> 00:24:42,080
supposed to give us their password etc

760
00:24:42,080 --> 00:24:43,840
generally speaking spear phishing right

761
00:24:43,840 --> 00:24:45,600
around 40 successful

762
00:24:45,600 --> 00:24:47,520
finally we would do what's called bulk

763
00:24:47,520 --> 00:24:48,880
fishing and this is

764
00:24:48,880 --> 00:24:50,559
uh just sending out an email to a whole

765
00:24:50,559 --> 00:24:52,240
lot of people uh

766
00:24:52,240 --> 00:24:54,640
and hoping not really that tailored uh

767
00:24:54,640 --> 00:24:56,400
but just hoping somebody

768
00:24:56,400 --> 00:24:59,120
uh falls for it right so generally 10 to

769
00:24:59,120 --> 00:24:59,760
12

770
00:24:59,760 --> 00:25:02,880
successful right and so that sounds good

771
00:25:02,880 --> 00:25:04,159
but all it takes like we just talked

772
00:25:04,159 --> 00:25:05,679
about is one user

773
00:25:05,679 --> 00:25:07,919
to give me their access and and we're in

774
00:25:07,919 --> 00:25:08,799
right so

775
00:25:08,799 --> 00:25:11,440
uh in this instance we were crafting uh

776
00:25:11,440 --> 00:25:13,120
this was months later right so the

777
00:25:13,120 --> 00:25:14,000
external penetration

778
00:25:14,000 --> 00:25:16,720
test happened in february and we're

779
00:25:16,720 --> 00:25:18,799
doing this now in june so

780
00:25:18,799 --> 00:25:20,640
that user password that we guessed we

781
00:25:20,640 --> 00:25:23,520
never longer had it

782
00:25:24,000 --> 00:25:26,799
so now we needed a way that we could get

783
00:25:26,799 --> 00:25:28,880
access to

784
00:25:28,880 --> 00:25:31,360
um more passwords and then we're going

785
00:25:31,360 --> 00:25:32,559
to take those passwords and call the

786
00:25:32,559 --> 00:25:34,159
help desk right so

787
00:25:34,159 --> 00:25:36,320
how do we do that so first and foremost

788
00:25:36,320 --> 00:25:37,840
you can go to google domains

789
00:25:37,840 --> 00:25:40,799
and buy any type of domain you want to

790
00:25:40,799 --> 00:25:42,000
these new extensions

791
00:25:42,000 --> 00:25:43,600
and they're not that old like maybe five

792
00:25:43,600 --> 00:25:45,600
years old or so but these things are

793
00:25:45,600 --> 00:25:46,080
awesome

794
00:25:46,080 --> 00:25:49,440
because um for whatever reason users

795
00:25:49,440 --> 00:25:50,400
aren't that comfortable with them

796
00:25:50,400 --> 00:25:51,919
they're not seeing them that much in the

797
00:25:51,919 --> 00:25:52,960
wild

798
00:25:52,960 --> 00:25:56,279
but you can go and we can buy you know

799
00:25:56,279 --> 00:25:57,720
hospital.wiki

800
00:25:57,720 --> 00:26:00,720
hospital.website hospital.watch

801
00:26:00,720 --> 00:26:03,440
whatever it is you know hospital.portal

802
00:26:03,440 --> 00:26:04,880
training

803
00:26:04,880 --> 00:26:07,919
and we can go buy one of these and um

804
00:26:07,919 --> 00:26:10,080
set it up and it looks like us and for

805
00:26:10,080 --> 00:26:11,120
whatever reason

806
00:26:11,120 --> 00:26:12,400
because users aren't comfortable with

807
00:26:12,400 --> 00:26:14,880
them or whatever reason

808
00:26:14,880 --> 00:26:18,159
they think it's an internal portal

809
00:26:18,159 --> 00:26:20,080
and so they actually inherently trust it

810
00:26:20,080 --> 00:26:21,200
more

811
00:26:21,200 --> 00:26:24,240
because it's not dot com so great

812
00:26:24,240 --> 00:26:25,919
in this particular instance we bought

813
00:26:25,919 --> 00:26:27,919
hospital or whatever the company name

814
00:26:27,919 --> 00:26:29,760
dot training and pretended to be a

815
00:26:29,760 --> 00:26:31,840
training portal

816
00:26:31,840 --> 00:26:34,159
so now um there's all sorts of tools

817
00:26:34,159 --> 00:26:34,960
that do this but

818
00:26:34,960 --> 00:26:37,919
we used go fish on for this particular

819
00:26:37,919 --> 00:26:39,120
sometimes we use social engineering

820
00:26:39,120 --> 00:26:41,360
toolkit sometimes we do it manually

821
00:26:41,360 --> 00:26:45,360
but we use that to clone

822
00:26:45,360 --> 00:26:47,919
their external login portal so obviously

823
00:26:47,919 --> 00:26:49,679
disclaimer this is

824
00:26:49,679 --> 00:26:51,200
a different hospital that i just found

825
00:26:51,200 --> 00:26:53,679
on google but

826
00:26:53,679 --> 00:26:55,360
it kind of looks the same as the portal

827
00:26:55,360 --> 00:26:57,679
we use so we clone their

828
00:26:57,679 --> 00:27:00,960
portal and um from that

829
00:27:00,960 --> 00:27:04,559
we send an email and so the email says

830
00:27:04,559 --> 00:27:07,200
hey new training portal actions required

831
00:27:07,200 --> 00:27:08,080
and

832
00:27:08,080 --> 00:27:11,120
uh we posed as the help desk uh so you

833
00:27:11,120 --> 00:27:12,559
can see we just set up a

834
00:27:12,559 --> 00:27:16,080
uh google email um

835
00:27:16,080 --> 00:27:17,919
and that cost us i think six dollars a

836
00:27:17,919 --> 00:27:20,240
month but the first 30 days are free so

837
00:27:20,240 --> 00:27:22,799
uh good investment uh also forgot to

838
00:27:22,799 --> 00:27:25,520
mention on all these um

839
00:27:25,520 --> 00:27:27,919
uh domains here that these are a little

840
00:27:27,919 --> 00:27:29,200
bit more expensive right because i'm

841
00:27:29,200 --> 00:27:30,559
using hospital instead of the actual

842
00:27:30,559 --> 00:27:31,440
domain name

843
00:27:31,440 --> 00:27:32,880
if you get more specific with the domain

844
00:27:32,880 --> 00:27:34,799
name it's as cheap as like 12 bucks

845
00:27:34,799 --> 00:27:38,000
for most of these uh that i'm purchasing

846
00:27:38,000 --> 00:27:41,440
so great sending the email now uh good

847
00:27:41,440 --> 00:27:42,960
morning we're in the process of setting

848
00:27:42,960 --> 00:27:44,480
up a new training portal

849
00:27:44,480 --> 00:27:45,919
this will eventually be the centralized

850
00:27:45,919 --> 00:27:47,679
portal for all your ongoing training

851
00:27:47,679 --> 00:27:48,720
requirements

852
00:27:48,720 --> 00:27:50,480
uh computer-based training and our

853
00:27:50,480 --> 00:27:52,399
compliance we need a few we're in the

854
00:27:52,399 --> 00:27:53,919
final stages and i need

855
00:27:53,919 --> 00:27:56,640
i've been tasked with getting a few uh

856
00:27:56,640 --> 00:27:58,480
personnel from each department

857
00:27:58,480 --> 00:27:59,840
uh to make sure everything is working

858
00:27:59,840 --> 00:28:01,760
correctly to make sure your device is

859
00:28:01,760 --> 00:28:04,000
compatible please log into this

860
00:28:04,000 --> 00:28:06,399
sign in using your network credentials

861
00:28:06,399 --> 00:28:07,760
and

862
00:28:07,760 --> 00:28:09,840
uh you'll get either a success or an

863
00:28:09,840 --> 00:28:11,440
error message

864
00:28:11,440 --> 00:28:13,440
and please reply to this email with that

865
00:28:13,440 --> 00:28:15,039
right so

866
00:28:15,039 --> 00:28:18,159
they go to the portal uh and

867
00:28:18,159 --> 00:28:20,559
they log in and this is an example of

868
00:28:20,559 --> 00:28:21,279
what we see

869
00:28:21,279 --> 00:28:23,919
so i can see the username and the

870
00:28:23,919 --> 00:28:25,600
password exactly when they clicked on it

871
00:28:25,600 --> 00:28:26,480
etc

872
00:28:26,480 --> 00:28:28,240
what they see is that bottom screen shot

873
00:28:28,240 --> 00:28:29,679
there that says

874
00:28:29,679 --> 00:28:32,320
basically hey thank you for visiting the

875
00:28:32,320 --> 00:28:34,080
portal you're compatible please reply

876
00:28:34,080 --> 00:28:35,200
with this email

877
00:28:35,200 --> 00:28:37,520
and we got all sorts of replies uh

878
00:28:37,520 --> 00:28:38,320
including

879
00:28:38,320 --> 00:28:41,039
uh screenshots uh different things like

880
00:28:41,039 --> 00:28:41,360
that

881
00:28:41,360 --> 00:28:44,399
so this is fun uh the

882
00:28:44,399 --> 00:28:46,320
other thing that you know i will use the

883
00:28:46,320 --> 00:28:47,760
same exact campaign

884
00:28:47,760 --> 00:28:50,799
with like a vishing uh phone based right

885
00:28:50,799 --> 00:28:53,279
the difference is uh really i'll call

886
00:28:53,279 --> 00:28:55,279
them and so the reason why

887
00:28:55,279 --> 00:28:57,440
uh phone-based social engineering is so

888
00:28:57,440 --> 00:28:58,640
good

889
00:28:58,640 --> 00:29:01,039
is because of two things one uh i'm only

890
00:29:01,039 --> 00:29:02,399
sending it to people who pick up the

891
00:29:02,399 --> 00:29:02,799
phone

892
00:29:02,799 --> 00:29:05,120
right so uh you'll see in the next slide

893
00:29:05,120 --> 00:29:06,480
my stats really get hurt when i

894
00:29:06,480 --> 00:29:07,919
when people aren't at their computer or

895
00:29:07,919 --> 00:29:09,200
never even open the email during the

896
00:29:09,200 --> 00:29:10,159
time window

897
00:29:10,159 --> 00:29:13,120
uh and and when i'm doing phone based i

898
00:29:13,120 --> 00:29:14,960
will basically call somebody and as soon

899
00:29:14,960 --> 00:29:16,080
as they pick up the phone

900
00:29:16,080 --> 00:29:18,080
i will send the email right away um and

901
00:29:18,080 --> 00:29:19,679
that way you know obviously

902
00:29:19,679 --> 00:29:21,279
my stats are only based on people who

903
00:29:21,279 --> 00:29:23,360
are uh picking up the phone

904
00:29:23,360 --> 00:29:26,080
uh whereas when i'm sending an email

905
00:29:26,080 --> 00:29:27,360
sometimes

906
00:29:27,360 --> 00:29:30,399
i don't know whether it got blocked

907
00:29:30,399 --> 00:29:33,200
whether their it team is you know told

908
00:29:33,200 --> 00:29:35,120
people not to click on it anymore

909
00:29:35,120 --> 00:29:38,399
or whether they're just not at their

910
00:29:38,399 --> 00:29:40,080
desk or on vacation or whatever unless i

911
00:29:40,080 --> 00:29:41,360
get out of office so

912
00:29:41,360 --> 00:29:42,559
you know we have to count it no matter

913
00:29:42,559 --> 00:29:45,520
what so the other reason why though

914
00:29:45,520 --> 00:29:48,880
is because in a phone based again i have

915
00:29:48,880 --> 00:29:49,600
you on the phone

916
00:29:49,600 --> 00:29:50,799
i'm going through the same exact

917
00:29:50,799 --> 00:29:53,600
campaign saying i'm a help desk employee

918
00:29:53,600 --> 00:29:54,000
uh

919
00:29:54,000 --> 00:29:56,399
i'm trying to tell you you know exactly

920
00:29:56,399 --> 00:29:57,440
what's going on

921
00:29:57,440 --> 00:29:59,600
your only choices at that point are a go

922
00:29:59,600 --> 00:30:01,279
along which most do

923
00:30:01,279 --> 00:30:04,159
or b directly confront me right and i

924
00:30:04,159 --> 00:30:06,000
you know i've had users sometimes look

925
00:30:06,000 --> 00:30:07,279
me up in the directory to make sure i'm

926
00:30:07,279 --> 00:30:08,320
a valid user

927
00:30:08,320 --> 00:30:10,799
which i am thank you linkedin uh i've

928
00:30:10,799 --> 00:30:12,240
also had people check

929
00:30:12,240 --> 00:30:14,240
on my phone number to make sure it's

930
00:30:14,240 --> 00:30:16,240
really calling from the office i say i

931
00:30:16,240 --> 00:30:16,720
am

932
00:30:16,720 --> 00:30:19,279
which usually i am which is a tool

933
00:30:19,279 --> 00:30:20,559
called spoof card

934
00:30:20,559 --> 00:30:22,799
uh and i'll explain that and i'll show

935
00:30:22,799 --> 00:30:23,919
you a screenshot of that in just a

936
00:30:23,919 --> 00:30:24,720
minute

937
00:30:24,720 --> 00:30:27,440
uh and you know but then other than that

938
00:30:27,440 --> 00:30:28,880
they're going along with it because they

939
00:30:28,880 --> 00:30:29,919
don't want to say hey i don't really

940
00:30:29,919 --> 00:30:31,039
think you are

941
00:30:31,039 --> 00:30:33,200
funny story uh one of the first times i

942
00:30:33,200 --> 00:30:35,039
used this exact campaign

943
00:30:35,039 --> 00:30:38,159
uh was for a fortune 300 client right so

944
00:30:38,159 --> 00:30:39,679
they're huge so there's no way they know

945
00:30:39,679 --> 00:30:41,200
everybody but i called

946
00:30:41,200 --> 00:30:43,120
uh pretending to be somebody i don't

947
00:30:43,120 --> 00:30:44,720
know john smith or whatever right

948
00:30:44,720 --> 00:30:47,440
and i call and this lady picks up and

949
00:30:47,440 --> 00:30:48,000
she goes

950
00:30:48,000 --> 00:30:50,159
you're not john smith i know john smith

951
00:30:50,159 --> 00:30:51,440
right so what are the odds so

952
00:30:51,440 --> 00:30:52,640
that is one of the ways you'll get

953
00:30:52,640 --> 00:30:54,159
caught but most of the time they don't

954
00:30:54,159 --> 00:30:54,559
know

955
00:30:54,559 --> 00:30:56,720
everybody uh in especially in larger

956
00:30:56,720 --> 00:30:58,000
organizations

957
00:30:58,000 --> 00:31:00,000
um so it works like a charm so let's get

958
00:31:00,000 --> 00:31:02,320
to the stats

959
00:31:02,320 --> 00:31:04,399
so as you can see from the statistics

960
00:31:04,399 --> 00:31:05,679
here we had

961
00:31:05,679 --> 00:31:08,320
we sent about 500 email exactly 500

962
00:31:08,320 --> 00:31:09,200
emails

963
00:31:09,200 --> 00:31:12,399
and uh we got message failed to send for

964
00:31:12,399 --> 00:31:14,880
69 of them which probably means

965
00:31:14,880 --> 00:31:17,440
they're no longer employed there in the

966
00:31:17,440 --> 00:31:18,960
spreadsheet they gave us is a little out

967
00:31:18,960 --> 00:31:19,760
of date

968
00:31:19,760 --> 00:31:21,519
we had nine out of office emails so we

969
00:31:21,519 --> 00:31:22,880
cannot count those

970
00:31:22,880 --> 00:31:25,440
uh 349 i just don't know what happened

971
00:31:25,440 --> 00:31:26,080
to them they

972
00:31:26,080 --> 00:31:28,559
just never even got opened right so i

973
00:31:28,559 --> 00:31:30,320
don't know if the user was not there

974
00:31:30,320 --> 00:31:32,640
i don't know whether they you know word

975
00:31:32,640 --> 00:31:34,320
got around and they knew not to even

976
00:31:34,320 --> 00:31:34,960
open it

977
00:31:34,960 --> 00:31:38,399
so uh unknown for 349. but you see there

978
00:31:38,399 --> 00:31:40,799
73 of them opened it and of the 73 that

979
00:31:40,799 --> 00:31:42,880
opened the email 65 of them

980
00:31:42,880 --> 00:31:44,880
clicked the link and submitted data only

981
00:31:44,880 --> 00:31:47,039
eight of them realized it was this booth

982
00:31:47,039 --> 00:31:50,240
uh at that point so uh really that's

983
00:31:50,240 --> 00:31:52,320
you know roughly 13 but this all

984
00:31:52,320 --> 00:31:54,240
happened in about 30 to 40 minutes

985
00:31:54,240 --> 00:31:56,240
uh you know generally speaking another

986
00:31:56,240 --> 00:31:58,399
pro tip for the red teamers

987
00:31:58,399 --> 00:32:00,159
is generally speaking when we're doing a

988
00:32:00,159 --> 00:32:01,919
massive campaign like this we want to

989
00:32:01,919 --> 00:32:03,679
try to get those emails out

990
00:32:03,679 --> 00:32:06,559
as fast as we can right so uh rumor

991
00:32:06,559 --> 00:32:08,000
spread like wildfire

992
00:32:08,000 --> 00:32:10,480
and we want to make sure we're getting

993
00:32:10,480 --> 00:32:11,679
all of our emails

994
00:32:11,679 --> 00:32:13,840
out slow enough that the filter or

995
00:32:13,840 --> 00:32:15,440
whatever doesn't block us

996
00:32:15,440 --> 00:32:18,720
but fast enough that uh our emails

997
00:32:18,720 --> 00:32:20,559
hitting their inbox before

998
00:32:20,559 --> 00:32:24,480
uh they are spreading gossip around and

999
00:32:24,480 --> 00:32:26,240
everybody knows about it right so

1000
00:32:26,240 --> 00:32:27,840
the other thing is i typically pick a

1001
00:32:27,840 --> 00:32:29,360
good time a day so you obviously don't

1002
00:32:29,360 --> 00:32:30,640
want to do it during lunch time

1003
00:32:30,640 --> 00:32:32,320
i think in this one we try to do like 9

1004
00:32:32,320 --> 00:32:34,000
a.m on a tuesday morning

1005
00:32:34,000 --> 00:32:37,200
perfect time so so great so now we have

1006
00:32:37,200 --> 00:32:39,200
65 different credentials

1007
00:32:39,200 --> 00:32:41,600
and again going back a few slides our

1008
00:32:41,600 --> 00:32:42,240
main goal

1009
00:32:42,240 --> 00:32:44,320
is to gain access to that vpn we talked

1010
00:32:44,320 --> 00:32:45,279
about

1011
00:32:45,279 --> 00:32:47,600
so let's do it so here's spoof card i'm

1012
00:32:47,600 --> 00:32:49,039
going to spoof my number to pretend to

1013
00:32:49,039 --> 00:32:49,519
be

1014
00:32:49,519 --> 00:32:51,919
an alaska area code and i'm going to

1015
00:32:51,919 --> 00:32:52,799
call the

1016
00:32:52,799 --> 00:32:54,960
help desk and say hey i lost my phone

1017
00:32:54,960 --> 00:32:56,159
over the weekend

1018
00:32:56,159 --> 00:32:59,279
can you reset my mobile pass and as you

1019
00:32:59,279 --> 00:33:00,240
can see there

1020
00:33:00,240 --> 00:33:01,440
again because they didn't have

1021
00:33:01,440 --> 00:33:03,679
multi-factor on that owa server i have

1022
00:33:03,679 --> 00:33:05,039
access to their email so i'm just

1023
00:33:05,039 --> 00:33:06,559
sitting there waiting

1024
00:33:06,559 --> 00:33:09,039
for it i call the help desk and they say

1025
00:33:09,039 --> 00:33:11,200
oh sure yeah we'll send it to your email

1026
00:33:11,200 --> 00:33:14,399
right because they think obviously only

1027
00:33:14,399 --> 00:33:16,720
uh you know joe smith has access to his

1028
00:33:16,720 --> 00:33:18,559
email so if joe smith's asking for

1029
00:33:18,559 --> 00:33:21,360
a reset uh and then then i don't have to

1030
00:33:21,360 --> 00:33:22,799
worry about authenticating him

1031
00:33:22,799 --> 00:33:25,679
so perfect i'm sitting there uh one of

1032
00:33:25,679 --> 00:33:27,440
the interesting parts in the high drama

1033
00:33:27,440 --> 00:33:28,559
parts about this test

1034
00:33:28,559 --> 00:33:32,159
is um you know i had to sit there and

1035
00:33:32,159 --> 00:33:33,440
wait and i hoped

1036
00:33:33,440 --> 00:33:36,399
joe was not open look checking his email

1037
00:33:36,399 --> 00:33:37,840
very closely right because this email

1038
00:33:37,840 --> 00:33:38,640
came in

1039
00:33:38,640 --> 00:33:40,159
and it says hey you're requesting your

1040
00:33:40,159 --> 00:33:41,679
mobile pass gets reset so i

1041
00:33:41,679 --> 00:33:44,320
quickly hid that as fast as i could uh

1042
00:33:44,320 --> 00:33:46,000
it's hoping he wouldn't see it well it

1043
00:33:46,000 --> 00:33:46,720
worked

1044
00:33:46,720 --> 00:33:49,360
uh as you can see i gained access uh to

1045
00:33:49,360 --> 00:33:50,320
their vpn

1046
00:33:50,320 --> 00:33:51,760
you know this is another random google

1047
00:33:51,760 --> 00:33:54,000
image but we did gain access to

1048
00:33:54,000 --> 00:33:57,519
uh their uh multifactor so

1049
00:33:57,519 --> 00:34:00,720
um so how do you fix this right so uh

1050
00:34:00,720 --> 00:34:02,240
multi-factor is still important right we

1051
00:34:02,240 --> 00:34:03,600
don't want to knock it but there's no

1052
00:34:03,600 --> 00:34:04,640
such thing

1053
00:34:04,640 --> 00:34:07,840
as a silver bullet so

1054
00:34:07,840 --> 00:34:10,960
if mfa was in place on that owa server

1055
00:34:10,960 --> 00:34:13,760
it still would have been protecting um

1056
00:34:13,760 --> 00:34:14,159
or

1057
00:34:14,159 --> 00:34:16,560
you know so so the first thing is mfa is

1058
00:34:16,560 --> 00:34:18,239
important right so we need to pull that

1059
00:34:18,239 --> 00:34:19,440
owa behind

1060
00:34:19,440 --> 00:34:22,960
the vpn or at least put mfa on that

1061
00:34:22,960 --> 00:34:24,719
also that service now right there's no

1062
00:34:24,719 --> 00:34:26,399
reason why people should be accessing

1063
00:34:26,399 --> 00:34:27,440
that

1064
00:34:27,440 --> 00:34:30,719
without mfa maybe

1065
00:34:30,719 --> 00:34:35,199
this service

1066
00:34:35,199 --> 00:34:37,040
hopefully not even that you should lock

1067
00:34:37,040 --> 00:34:38,480
it in and then have users

1068
00:34:38,480 --> 00:34:40,320
call their supervisor if they lose their

1069
00:34:40,320 --> 00:34:41,599
phone or whatever it is

1070
00:34:41,599 --> 00:34:43,599
um you know it's a balance of usability

1071
00:34:43,599 --> 00:34:45,599
and security right it always will be

1072
00:34:45,599 --> 00:34:48,239
second uh oh and while we're on that

1073
00:34:48,239 --> 00:34:49,199
first mfa one

1074
00:34:49,199 --> 00:34:50,879
just you know there is no such thing as

1075
00:34:50,879 --> 00:34:52,239
a silver bullet in security

1076
00:34:52,239 --> 00:34:54,639
i have gotten past mfa through various

1077
00:34:54,639 --> 00:34:57,200
means uh just recently last month

1078
00:34:57,200 --> 00:35:00,320
uh a client had mfa and i tried to log

1079
00:35:00,320 --> 00:35:02,720
in with several users and i think three

1080
00:35:02,720 --> 00:35:03,359
out of five

1081
00:35:03,359 --> 00:35:05,040
it was a push notification right from

1082
00:35:05,040 --> 00:35:07,040
duo and three out of five of them

1083
00:35:07,040 --> 00:35:09,760
clicked past anyways right they're just

1084
00:35:09,760 --> 00:35:10,560
so trained

1085
00:35:10,560 --> 00:35:12,000
so you know obviously the one-time

1086
00:35:12,000 --> 00:35:13,119
password is better than a push

1087
00:35:13,119 --> 00:35:14,320
notification

1088
00:35:14,320 --> 00:35:17,119
uh but then also with duo if you have

1089
00:35:17,119 --> 00:35:17,839
access to

1090
00:35:17,839 --> 00:35:20,400
their c drive you can usually get to the

1091
00:35:20,400 --> 00:35:21,760
c program files

1092
00:35:21,760 --> 00:35:25,599
duo and the link for uh resetting and

1093
00:35:25,599 --> 00:35:27,359
setting up is is right there in the

1094
00:35:27,359 --> 00:35:30,400
configuration files for duo uh well

1095
00:35:30,400 --> 00:35:32,560
how do you gain access to their c drive

1096
00:35:32,560 --> 00:35:33,920
well usually through something like ps

1097
00:35:33,920 --> 00:35:34,480
exec

1098
00:35:34,480 --> 00:35:36,400
on an internal if i have access to their

1099
00:35:36,400 --> 00:35:37,680
computer

1100
00:35:37,680 --> 00:35:39,359
i won't go into too much details there

1101
00:35:39,359 --> 00:35:41,040
but but the simple thing you need to

1102
00:35:41,040 --> 00:35:41,920
know is that

1103
00:35:41,920 --> 00:35:44,960
share drive or smb does not duo doesn't

1104
00:35:44,960 --> 00:35:47,280
support it so

1105
00:35:47,280 --> 00:35:48,720
it all goes back to the point of there

1106
00:35:48,720 --> 00:35:51,680
is no such thing as a silver bullet

1107
00:35:51,680 --> 00:35:55,200
in security second stop providing

1108
00:35:55,200 --> 00:35:56,960
generic awareness training that nobody

1109
00:35:56,960 --> 00:35:58,240
listens to right so

1110
00:35:58,240 --> 00:36:00,240
as security professionals blue team and

1111
00:36:00,240 --> 00:36:02,240
renting we get maybe an hour

1112
00:36:02,240 --> 00:36:05,680
a year uh of their time and

1113
00:36:05,680 --> 00:36:07,599
we're wasting it we're wasting it with

1114
00:36:07,599 --> 00:36:09,680
things like um

1115
00:36:09,680 --> 00:36:11,200
computer-based training that nobody's

1116
00:36:11,200 --> 00:36:12,880
listening to uh

1117
00:36:12,880 --> 00:36:15,920
you know random compliance type talks

1118
00:36:15,920 --> 00:36:18,240
man that is our opportunity and one of

1119
00:36:18,240 --> 00:36:20,079
the most important things we can do

1120
00:36:20,079 --> 00:36:22,720
to help educate our users on how not to

1121
00:36:22,720 --> 00:36:23,440
fall for these

1122
00:36:23,440 --> 00:36:25,119
the simple fact is with the comic on the

1123
00:36:25,119 --> 00:36:27,119
right you know uh funny but

1124
00:36:27,119 --> 00:36:30,320
the simple fact is that uh users are

1125
00:36:30,320 --> 00:36:31,839
considering when you tell them social

1126
00:36:31,839 --> 00:36:33,119
engineering the first thing that pops in

1127
00:36:33,119 --> 00:36:33,760
their mind

1128
00:36:33,760 --> 00:36:35,839
is prince of nigeria right they're not

1129
00:36:35,839 --> 00:36:36,800
thinking of

1130
00:36:36,800 --> 00:36:38,079
some of the more complicated

1131
00:36:38,079 --> 00:36:39,839
sophisticated attacks that they're

1132
00:36:39,839 --> 00:36:43,040
actually facing um you know that's why

1133
00:36:43,040 --> 00:36:44,400
they're so successful

1134
00:36:44,400 --> 00:36:47,119
so you know statistically speaking 88 of

1135
00:36:47,119 --> 00:36:48,720
data breaches have social engineering

1136
00:36:48,720 --> 00:36:49,280
involved

1137
00:36:49,280 --> 00:36:51,760
so during our limited time to do

1138
00:36:51,760 --> 00:36:53,119
awareness training we got to make it

1139
00:36:53,119 --> 00:36:54,079
count uh

1140
00:36:54,079 --> 00:36:56,160
and by that i mean i love to take

1141
00:36:56,160 --> 00:36:58,240
pictures screenshots from the recent

1142
00:36:58,240 --> 00:36:59,599
tests we just did

1143
00:36:59,599 --> 00:37:01,760
and show them hey you guys actually fell

1144
00:37:01,760 --> 00:37:03,040
for this of course i'm going to

1145
00:37:03,040 --> 00:37:04,400
anonymize it i don't want to call

1146
00:37:04,400 --> 00:37:05,359
anybody out

1147
00:37:05,359 --> 00:37:07,359
or make anybody uncomfortable but this

1148
00:37:07,359 --> 00:37:08,560
is the types of tests

1149
00:37:08,560 --> 00:37:11,280
or or you know types of attacks that

1150
00:37:11,280 --> 00:37:12,079
they're under

1151
00:37:12,079 --> 00:37:13,599
and they need to be aware of it how do

1152
00:37:13,599 --> 00:37:15,599
they know whether this is really coming

1153
00:37:15,599 --> 00:37:16,880
from the inside

1154
00:37:16,880 --> 00:37:18,480
what type of information should they

1155
00:37:18,480 --> 00:37:20,000
expect it to

1156
00:37:20,000 --> 00:37:21,359
what are the procedures they should be

1157
00:37:21,359 --> 00:37:22,960
looking out for how does an attacker

1158
00:37:22,960 --> 00:37:24,800
guess their password right so

1159
00:37:24,800 --> 00:37:26,880
um we have to make that limited

1160
00:37:26,880 --> 00:37:28,000
opportunity to

1161
00:37:28,000 --> 00:37:30,160
do awareness training and we have to

1162
00:37:30,160 --> 00:37:31,599
make it count because

1163
00:37:31,599 --> 00:37:33,119
um you know generally speaking we're

1164
00:37:33,119 --> 00:37:34,800
spending all of our resources hoping

1165
00:37:34,800 --> 00:37:36,560
that something bad won't happen

1166
00:37:36,560 --> 00:37:38,720
uh but but that's one of our no matter

1167
00:37:38,720 --> 00:37:41,359
how many bells and whistles we have

1168
00:37:41,359 --> 00:37:42,960
awareness training will only be as weak

1169
00:37:42,960 --> 00:37:44,960
as the winter 2020 on our network right

1170
00:37:44,960 --> 00:37:45,760
so

1171
00:37:45,760 --> 00:37:48,240
um make that count that's really you

1172
00:37:48,240 --> 00:37:49,680
know what i wanted to hammer home

1173
00:37:49,680 --> 00:37:52,960
uh finally or excuse me third layer

1174
00:37:52,960 --> 00:37:53,599
defenses

1175
00:37:53,599 --> 00:37:56,720
right so uh generally the

1176
00:37:56,720 --> 00:37:59,119
best thing to do is to consider you know

1177
00:37:59,119 --> 00:38:00,720
the analogy of a

1178
00:38:00,720 --> 00:38:04,560
uh medieval castle right so uh

1179
00:38:04,560 --> 00:38:06,640
how many entrances do you have you know

1180
00:38:06,640 --> 00:38:08,640
back the best medieval castles back in

1181
00:38:08,640 --> 00:38:09,920
the day right had

1182
00:38:09,920 --> 00:38:11,359
uh you know the moat around them with

1183
00:38:11,359 --> 00:38:13,440
the crocodiles in right and so

1184
00:38:13,440 --> 00:38:15,599
uh then they also had the drawbridge

1185
00:38:15,599 --> 00:38:17,440
right so the only main entrance was the

1186
00:38:17,440 --> 00:38:18,000
drawbridge

1187
00:38:18,000 --> 00:38:20,640
unless somebody were to crawl through

1188
00:38:20,640 --> 00:38:21,200
that

1189
00:38:21,200 --> 00:38:23,040
and then put up a really tall lower

1190
00:38:23,040 --> 00:38:24,560
ladder right

1191
00:38:24,560 --> 00:38:26,480
so great so that is reducing your attack

1192
00:38:26,480 --> 00:38:28,720
surface only having the drawbridge right

1193
00:38:28,720 --> 00:38:30,400
so then on top of that they layer

1194
00:38:30,400 --> 00:38:31,839
defenses

1195
00:38:31,839 --> 00:38:35,119
you know if you're able to cross the

1196
00:38:35,119 --> 00:38:38,640
drawbridge they have you know really hot

1197
00:38:38,640 --> 00:38:40,960
tar and oil that drops from on high on

1198
00:38:40,960 --> 00:38:42,240
you right so

1199
00:38:42,240 --> 00:38:44,880
uh that's the next layer then somehow

1200
00:38:44,880 --> 00:38:45,520
they have the

1201
00:38:45,520 --> 00:38:47,599
giant front door that's barred shut

1202
00:38:47,599 --> 00:38:49,839
right and then if you get past that

1203
00:38:49,839 --> 00:38:50,960
they have a bunch of troops sitting

1204
00:38:50,960 --> 00:38:52,240
there waiting for you right so they have

1205
00:38:52,240 --> 00:38:54,240
layers of defenses

1206
00:38:54,240 --> 00:38:55,680
same thing applies to defending our

1207
00:38:55,680 --> 00:38:57,839
network we have to have layers mfa alone

1208
00:38:57,839 --> 00:38:59,119
is not good enough

1209
00:38:59,119 --> 00:39:00,880
next gen endpoint protection alone is

1210
00:39:00,880 --> 00:39:02,640
not good enough

1211
00:39:02,640 --> 00:39:04,160
you know even those two combined are

1212
00:39:04,160 --> 00:39:06,160
just not good enough

1213
00:39:06,160 --> 00:39:09,200
and then finally uh the third

1214
00:39:09,200 --> 00:39:12,560
is to assume uh compromise

1215
00:39:12,560 --> 00:39:14,880
so i recently just wrote a blog on the

1216
00:39:14,880 --> 00:39:16,640
the hat in matrix and so that's used for

1217
00:39:16,640 --> 00:39:17,680
injury prevention

1218
00:39:17,680 --> 00:39:18,880
basically when they're trying to figure

1219
00:39:18,880 --> 00:39:20,320
out how to get cars to stop crashing

1220
00:39:20,320 --> 00:39:21,359
into each other

1221
00:39:21,359 --> 00:39:24,079
uh they use this matrix uh that

1222
00:39:24,079 --> 00:39:26,640
basically looks at the pre-event factors

1223
00:39:26,640 --> 00:39:28,720
the event factors and then the post

1224
00:39:28,720 --> 00:39:30,320
event factors right so the pre-event

1225
00:39:30,320 --> 00:39:32,560
factors are things like

1226
00:39:32,560 --> 00:39:35,920
this speed limit maybe

1227
00:39:35,920 --> 00:39:38,480
the high visibility arrows you see on on

1228
00:39:38,480 --> 00:39:40,480
curves that are coming up the flash the

1229
00:39:40,480 --> 00:39:41,520
stop lights etc

1230
00:39:41,520 --> 00:39:43,440
these are all things meant to prevent an

1231
00:39:43,440 --> 00:39:45,200
attack from occurring or prevent a

1232
00:39:45,200 --> 00:39:46,960
accident from occurring uh the second

1233
00:39:46,960 --> 00:39:48,560
would be things that make

1234
00:39:48,560 --> 00:39:50,800
the severity less bad if it does happen

1235
00:39:50,800 --> 00:39:52,480
right so even with speed limits

1236
00:39:52,480 --> 00:39:54,720
etc accidents are going to happen right

1237
00:39:54,720 --> 00:39:56,079
so you have to assume

1238
00:39:56,079 --> 00:39:57,760
what are you going to do to prevent the

1239
00:39:57,760 --> 00:39:59,200
event from being so bad

1240
00:39:59,200 --> 00:40:01,040
that's things like safety ratings in

1241
00:40:01,040 --> 00:40:02,240
cars

1242
00:40:02,240 --> 00:40:05,119
things like seat belts airbags etc

1243
00:40:05,119 --> 00:40:06,560
things that are designed to

1244
00:40:06,560 --> 00:40:08,560
in when the event happens to stop it

1245
00:40:08,560 --> 00:40:10,960
quickly and then finally they have post

1246
00:40:10,960 --> 00:40:12,880
event they understand that people

1247
00:40:12,880 --> 00:40:15,920
will get injured in car accidents

1248
00:40:15,920 --> 00:40:17,920
it's just they're never get to point of

1249
00:40:17,920 --> 00:40:19,520
zero therefore they

1250
00:40:19,520 --> 00:40:22,000
consider things like having the hospital

1251
00:40:22,000 --> 00:40:24,000
network and ambulatory services

1252
00:40:24,000 --> 00:40:25,760
on who's on call so that an ambulance

1253
00:40:25,760 --> 00:40:28,000
can quickly get to them aravax

1254
00:40:28,000 --> 00:40:30,720
uh you know etc tow trucks to get it off

1255
00:40:30,720 --> 00:40:32,880
the road etc so

1256
00:40:32,880 --> 00:40:34,560
with injury prevention they use the

1257
00:40:34,560 --> 00:40:36,240
haddad matrix to

1258
00:40:36,240 --> 00:40:38,079
look at all the different factors that

1259
00:40:38,079 --> 00:40:39,359
lead pre-event

1260
00:40:39,359 --> 00:40:42,160
event post event same thing as security

1261
00:40:42,160 --> 00:40:43,760
right we can borrow that

1262
00:40:43,760 --> 00:40:46,960
and really uh make it useful for us in

1263
00:40:46,960 --> 00:40:48,240
our jobs

1264
00:40:48,240 --> 00:40:50,800
yes our main focus or not even our main

1265
00:40:50,800 --> 00:40:52,720
focus one of our focuses should be

1266
00:40:52,720 --> 00:40:54,960
pre-event what can we do to stop the

1267
00:40:54,960 --> 00:40:56,480
compromise from happening in the first

1268
00:40:56,480 --> 00:40:57,520
place

1269
00:40:57,520 --> 00:40:59,599
layer defenses reducing our attack

1270
00:40:59,599 --> 00:41:01,359
surface multi-factor authentication

1271
00:41:01,359 --> 00:41:03,119
better passwords etc

1272
00:41:03,119 --> 00:41:06,240
no matter what we do we have to assume

1273
00:41:06,240 --> 00:41:08,160
that events compromises will happen

1274
00:41:08,160 --> 00:41:09,359
hopefully they're small

1275
00:41:09,359 --> 00:41:11,280
what can we do to limit the impact to

1276
00:41:11,280 --> 00:41:12,720
them well

1277
00:41:12,720 --> 00:41:16,160
event would be things like segmentation

1278
00:41:16,160 --> 00:41:20,480
uh also things uh like um

1279
00:41:20,480 --> 00:41:22,160
alerting so that we can quickly respond

1280
00:41:22,160 --> 00:41:24,079
and deduct to it and then finally

1281
00:41:24,079 --> 00:41:26,480
uh go through an exercise of assumes

1282
00:41:26,480 --> 00:41:28,160
compromise or post event

1283
00:41:28,160 --> 00:41:31,440
uh what how much will it spread uh do

1284
00:41:31,440 --> 00:41:33,040
you have segmentation on your network

1285
00:41:33,040 --> 00:41:33,359
like

1286
00:41:33,359 --> 00:41:34,880
fire doors is what i like to call them

1287
00:41:34,880 --> 00:41:37,359
to coordinate off to just one department

1288
00:41:37,359 --> 00:41:38,960
or one area of the network

1289
00:41:38,960 --> 00:41:41,440
do you have offline backups for a

1290
00:41:41,440 --> 00:41:43,040
ransomware attack for example so that

1291
00:41:43,040 --> 00:41:44,000
you could restore

1292
00:41:44,000 --> 00:41:47,119
uh you know etc so

1293
00:41:47,119 --> 00:41:50,160
really you know we should apply security

1294
00:41:50,160 --> 00:41:50,800
controls

1295
00:41:50,800 --> 00:41:52,400
and make sure that we're considering all

1296
00:41:52,400 --> 00:41:55,119
three layers because things happen

1297
00:41:55,119 --> 00:41:58,000
okay moving on to the internal

1298
00:41:58,000 --> 00:41:59,680
penetration test so now i gain

1299
00:41:59,680 --> 00:42:02,880
access to the internal network and uh

1300
00:42:02,880 --> 00:42:05,920
really what can i see so uh first and

1301
00:42:05,920 --> 00:42:07,839
foremost

1302
00:42:07,839 --> 00:42:09,520
one of the things that's changed in pin

1303
00:42:09,520 --> 00:42:11,520
testing a lot since the pandemic begins

1304
00:42:11,520 --> 00:42:12,880
and one of the things that we've really

1305
00:42:12,880 --> 00:42:14,800
been challenging to

1306
00:42:14,800 --> 00:42:17,119
improve on is not relying on the same

1307
00:42:17,119 --> 00:42:18,720
old spoofing attacks we always have

1308
00:42:18,720 --> 00:42:19,839
right so

1309
00:42:19,839 --> 00:42:23,200
uh for those who

1310
00:42:23,200 --> 00:42:25,680
are red teamers you know net bios name

1311
00:42:25,680 --> 00:42:27,200
service local lake multicast name

1312
00:42:27,200 --> 00:42:28,319
resolution

1313
00:42:28,319 --> 00:42:31,520
uh is is an old go-to right so uh that's

1314
00:42:31,520 --> 00:42:32,800
generally a way that we can get an

1315
00:42:32,800 --> 00:42:34,480
initial foothold on the network really

1316
00:42:34,480 --> 00:42:35,119
quickly

1317
00:42:35,119 --> 00:42:38,400
but during the pandemic uh what we're

1318
00:42:38,400 --> 00:42:38,800
seeing

1319
00:42:38,800 --> 00:42:41,200
is a lot of times is that those systems

1320
00:42:41,200 --> 00:42:41,839
are not

1321
00:42:41,839 --> 00:42:44,160
directly on the network or users are

1322
00:42:44,160 --> 00:42:45,040
working from home

1323
00:42:45,040 --> 00:42:47,520
a lot more frequently and therefore that

1324
00:42:47,520 --> 00:42:48,480
attack surface

1325
00:42:48,480 --> 00:42:51,359
is not really as valid anymore right so

1326
00:42:51,359 --> 00:42:52,880
i'm trying to come up with different

1327
00:42:52,880 --> 00:42:54,560
ways and and trying to improve our

1328
00:42:54,560 --> 00:42:56,319
abilities to get past and not rely on

1329
00:42:56,319 --> 00:42:57,520
the same old

1330
00:42:57,520 --> 00:42:59,680
yes it's still a problem yes it's in the

1331
00:42:59,680 --> 00:43:00,720
report and

1332
00:43:00,720 --> 00:43:03,119
you know we should make note of it um

1333
00:43:03,119 --> 00:43:03,839
but really

1334
00:43:03,839 --> 00:43:06,240
you know diversifying past that uh a

1335
00:43:06,240 --> 00:43:07,440
little bit so

1336
00:43:07,440 --> 00:43:08,880
in this particular instance who am i

1337
00:43:08,880 --> 00:43:10,480
kidding we're testing the hospital right

1338
00:43:10,480 --> 00:43:13,839
yeah jackpot uh all sorts of exploitable

1339
00:43:13,839 --> 00:43:14,800
vulnerabilities

1340
00:43:14,800 --> 00:43:18,160
are exposed and a lot of these are

1341
00:43:18,160 --> 00:43:19,920
critical like we can see so

1342
00:43:19,920 --> 00:43:22,560
um you know moving on to the next slide

1343
00:43:22,560 --> 00:43:23,839
here you can see

1344
00:43:23,839 --> 00:43:27,599
that there is um

1345
00:43:27,599 --> 00:43:29,359
all sorts of critical vulnerabilities

1346
00:43:29,359 --> 00:43:31,200
here so we're talking about 40 different

1347
00:43:31,200 --> 00:43:33,440
systems that are running windows xp

1348
00:43:33,440 --> 00:43:35,119
this is very common at hospitals they

1349
00:43:35,119 --> 00:43:36,800
cannot update these systems because it's

1350
00:43:36,800 --> 00:43:38,560
running some weird x-ray machine that

1351
00:43:38,560 --> 00:43:39,680
they don't support

1352
00:43:39,680 --> 00:43:41,760
you know whatever it is i'm also seeing

1353
00:43:41,760 --> 00:43:43,280
a lot of microsoft

1354
00:43:43,280 --> 00:43:46,240
uh rdp cbe so that's the blue key

1355
00:43:46,240 --> 00:43:47,760
vulnerability that recently came out

1356
00:43:47,760 --> 00:43:50,119
right so tons of those i had tons of

1357
00:43:50,119 --> 00:43:52,000
ms17010 which is the wannacry

1358
00:43:52,000 --> 00:43:52,880
vulnerabilities

1359
00:43:52,880 --> 00:43:56,160
so there is all sorts of vulnerabilities

1360
00:43:56,160 --> 00:43:58,160
uh exposed on this network that would

1361
00:43:58,160 --> 00:43:59,520
allow an attacker to

1362
00:43:59,520 --> 00:44:01,920
gain access so that's problem number one

1363
00:44:01,920 --> 00:44:02,640
okay

1364
00:44:02,640 --> 00:44:04,640
so now that i have all these systems to

1365
00:44:04,640 --> 00:44:07,200
exploit which one do i want to choose

1366
00:44:07,200 --> 00:44:09,920
to exploit and so remember going back to

1367
00:44:09,920 --> 00:44:10,240
this

1368
00:44:10,240 --> 00:44:13,760
i am plugged in to an emergency room my

1369
00:44:13,760 --> 00:44:16,880
laptop is in the middle of

1370
00:44:16,880 --> 00:44:18,480
the height of the pandemic right

1371
00:44:18,480 --> 00:44:20,160
availability is key

1372
00:44:20,160 --> 00:44:23,040
i cannot afford to take down their mri

1373
00:44:23,040 --> 00:44:23,599
machine

1374
00:44:23,599 --> 00:44:25,680
or uh god forbid something even more

1375
00:44:25,680 --> 00:44:26,880
important right so

1376
00:44:26,880 --> 00:44:28,400
i have to make sure we're keeping these

1377
00:44:28,400 --> 00:44:30,960
systems are up and so

1378
00:44:30,960 --> 00:44:33,599
what are we doing to make sure a system

1379
00:44:33,599 --> 00:44:34,079
is

1380
00:44:34,079 --> 00:44:36,880
reliable and safe to exploit and so

1381
00:44:36,880 --> 00:44:38,560
really with that and i think this

1382
00:44:38,560 --> 00:44:40,240
doesn't get talked about enough

1383
00:44:40,240 --> 00:44:42,960
from everything i hear is just man

1384
00:44:42,960 --> 00:44:44,800
there's a lot of dangers out there with

1385
00:44:44,800 --> 00:44:45,359
some of these

1386
00:44:45,359 --> 00:44:47,520
exploits and so you know for example the

1387
00:44:47,520 --> 00:44:50,040
blue keep and the

1388
00:44:50,040 --> 00:44:52,960
ms-17010 i want to cry they both

1389
00:44:52,960 --> 00:44:55,680
have about a 50 chance of working and

1390
00:44:55,680 --> 00:44:56,640
about a 50

1391
00:44:56,640 --> 00:44:58,000
chance of causing the blue screen of

1392
00:44:58,000 --> 00:45:00,319
death right they both you know could

1393
00:45:00,319 --> 00:45:01,760
crash the server

1394
00:45:01,760 --> 00:45:04,000
that is not acceptable you know for a

1395
00:45:04,000 --> 00:45:05,680
lot of our clients

1396
00:45:05,680 --> 00:45:08,240
and so uh really how do i choose the

1397
00:45:08,240 --> 00:45:09,920
right one to exploit so

1398
00:45:09,920 --> 00:45:14,240
i want to demonstrate to the client

1399
00:45:14,240 --> 00:45:15,920
all of the vulnerabilities that i can

1400
00:45:15,920 --> 00:45:16,960
right the difference between a

1401
00:45:16,960 --> 00:45:18,960
vulnerability scan and a penetration

1402
00:45:18,960 --> 00:45:19,599
test

1403
00:45:19,599 --> 00:45:22,000
is that we do exploit where we can but

1404
00:45:22,000 --> 00:45:23,520
at the same time we have to take a

1405
00:45:23,520 --> 00:45:25,680
measured approach to that right so

1406
00:45:25,680 --> 00:45:28,079
uh this just comes down to doing your

1407
00:45:28,079 --> 00:45:29,119
homework i mean

1408
00:45:29,119 --> 00:45:32,160
consider the reputation if you go look

1409
00:45:32,160 --> 00:45:35,839
on exploit db metasploit rapid 7's

1410
00:45:35,839 --> 00:45:36,560
website

1411
00:45:36,560 --> 00:45:39,520
uh the cde itself understand everything

1412
00:45:39,520 --> 00:45:40,560
about it

1413
00:45:40,560 --> 00:45:42,800
including the reputation uh you know

1414
00:45:42,800 --> 00:45:44,400
who's talking about it has it worked in

1415
00:45:44,400 --> 00:45:45,280
the past

1416
00:45:45,280 --> 00:45:47,280
uh is this been around for a while is

1417
00:45:47,280 --> 00:45:49,200
this trusted does it have the excellent

1418
00:45:49,200 --> 00:45:51,040
rating or whatever it is

1419
00:45:51,040 --> 00:45:52,800
additionally we need to dive into

1420
00:45:52,800 --> 00:45:55,280
understanding what the exploit does

1421
00:45:55,280 --> 00:45:57,599
far too often we're just clicking run

1422
00:45:57,599 --> 00:45:58,720
without really

1423
00:45:58,720 --> 00:46:00,560
diving into the code or anything like

1424
00:46:00,560 --> 00:46:02,400
that and understanding exactly what that

1425
00:46:02,400 --> 00:46:03,680
exploit does

1426
00:46:03,680 --> 00:46:05,680
and how it does it so you know in this

1427
00:46:05,680 --> 00:46:07,440
instance when we're trying to avoid

1428
00:46:07,440 --> 00:46:08,800
problems on the network

1429
00:46:08,800 --> 00:46:12,160
i need to do things like uh avoid buffer

1430
00:46:12,160 --> 00:46:14,160
overflows right that's overriding memory

1431
00:46:14,160 --> 00:46:16,319
that's usually a very bad thing

1432
00:46:16,319 --> 00:46:19,280
uh so and then finally use all the

1433
00:46:19,280 --> 00:46:20,880
information available us to make the

1434
00:46:20,880 --> 00:46:23,119
decision right so

1435
00:46:23,119 --> 00:46:25,280
do i know that this is the exact version

1436
00:46:25,280 --> 00:46:27,920
that is vulnerable do i know

1437
00:46:27,920 --> 00:46:31,520
what this system is right so an ms-17010

1438
00:46:31,520 --> 00:46:33,040
that has a potential blue screen of

1439
00:46:33,040 --> 00:46:33,920
death

1440
00:46:33,920 --> 00:46:36,079
is maybe okay on a user workstation

1441
00:46:36,079 --> 00:46:37,839
maybe not okay on the domain controller

1442
00:46:37,839 --> 00:46:38,480
right so

1443
00:46:38,480 --> 00:46:40,319
use all the information about what the

1444
00:46:40,319 --> 00:46:42,400
system is what the system's running

1445
00:46:42,400 --> 00:46:44,960
et cetera to drive our decision so in

1446
00:46:44,960 --> 00:46:46,000
this particular

1447
00:46:46,000 --> 00:46:48,960
instance we decided to go with a ibm

1448
00:46:48,960 --> 00:46:49,839
websphere java

1449
00:46:49,839 --> 00:46:51,760
serialization vulnerability uh really

1450
00:46:51,760 --> 00:46:53,280
that's just

1451
00:46:53,280 --> 00:46:56,400
an unsafe deserialization call in the

1452
00:46:56,400 --> 00:46:58,160
apache commons library

1453
00:46:58,160 --> 00:47:00,240
uh which really just allows remote code

1454
00:47:00,240 --> 00:47:01,520
execution the

1455
00:47:01,520 --> 00:47:03,520
actual exploit doesn't matter that much

1456
00:47:03,520 --> 00:47:04,880
uh the point is

1457
00:47:04,880 --> 00:47:06,400
it was one of the safer ones with a good

1458
00:47:06,400 --> 00:47:08,560
reputation that affected the application

1459
00:47:08,560 --> 00:47:09,920
more than the underlying operating

1460
00:47:09,920 --> 00:47:10,720
system

1461
00:47:10,720 --> 00:47:12,160
uh and we felt good about it we

1462
00:47:12,160 --> 00:47:14,240
confirmed you know at traction security

1463
00:47:14,240 --> 00:47:15,760
we always have engineer huddles in this

1464
00:47:15,760 --> 00:47:18,079
instance where we uh get together with

1465
00:47:18,079 --> 00:47:19,599
everybody who's available and say hey

1466
00:47:19,599 --> 00:47:21,359
let's talk about this here's my options

1467
00:47:21,359 --> 00:47:22,720
what do you think

1468
00:47:22,720 --> 00:47:25,280
and really you know uh come up with the

1469
00:47:25,280 --> 00:47:26,960
best game plan before we go forward

1470
00:47:26,960 --> 00:47:30,160
so uh it worked obviously we gain access

1471
00:47:30,160 --> 00:47:30,800
to it

1472
00:47:30,800 --> 00:47:33,680
uh once i gained access to it i done the

1473
00:47:33,680 --> 00:47:35,839
contents of the local sam file

1474
00:47:35,839 --> 00:47:37,920
and so the local sam file of course

1475
00:47:37,920 --> 00:47:39,280
holds the

1476
00:47:39,280 --> 00:47:42,559
hashes of all the local administrators

1477
00:47:42,559 --> 00:47:44,079
and in this particular instance

1478
00:47:44,079 --> 00:47:45,200
they are using the same local

1479
00:47:45,200 --> 00:47:47,119
administrator password across all of the

1480
00:47:47,119 --> 00:47:48,559
systems you see here

1481
00:47:48,559 --> 00:47:51,040
uh so using that i can do what is called

1482
00:47:51,040 --> 00:47:53,119
a past the hash attack which i'm happy

1483
00:47:53,119 --> 00:47:54,319
to go more into

1484
00:47:54,319 --> 00:47:55,680
if you want to hit me up on discord but

1485
00:47:55,680 --> 00:47:56,880
i'm kind of running out of time so i'm

1486
00:47:56,880 --> 00:47:58,720
not going to go too much into it

1487
00:47:58,720 --> 00:48:01,200
but the point is i once you gain access

1488
00:48:01,200 --> 00:48:03,119
to one system i can gain access to every

1489
00:48:03,119 --> 00:48:05,520
system that shares that same password

1490
00:48:05,520 --> 00:48:08,319
also by dumping the lsas process i'm

1491
00:48:08,319 --> 00:48:10,400
able to read the contents of memory

1492
00:48:10,400 --> 00:48:14,079
directly from directly from

1493
00:48:14,079 --> 00:48:16,400
the lsas portion of memory and so this

1494
00:48:16,400 --> 00:48:18,880
is obviously a representative screenshot

1495
00:48:18,880 --> 00:48:20,240
in the top there but i wanted to show

1496
00:48:20,240 --> 00:48:22,079
you what it looks like so this is mimi

1497
00:48:22,079 --> 00:48:23,200
cats

1498
00:48:23,200 --> 00:48:25,520
mimi cats works well except it gets

1499
00:48:25,520 --> 00:48:27,680
caught a lot by antivirus

1500
00:48:27,680 --> 00:48:30,559
so you can see that the bob 1password

1501
00:48:30,559 --> 00:48:33,040
again representative screenshot but

1502
00:48:33,040 --> 00:48:35,040
that gave me access to the clear text

1503
00:48:35,040 --> 00:48:37,359
passwords uh for the red teamers

1504
00:48:37,359 --> 00:48:40,400
on the listening to this you know a lot

1505
00:48:40,400 --> 00:48:42,240
of times mimi cats will get caught

1506
00:48:42,240 --> 00:48:44,079
by antivirus but if you're just using

1507
00:48:44,079 --> 00:48:46,160
crack map exec with the tac-tac lsa

1508
00:48:46,160 --> 00:48:46,800
option

1509
00:48:46,800 --> 00:48:48,720
that dumps the contents of the lsas

1510
00:48:48,720 --> 00:48:50,319
which has a lot less passwords in it but

1511
00:48:50,319 --> 00:48:51,359
they still is some

1512
00:48:51,359 --> 00:48:53,440
almost never gets caught so i've been

1513
00:48:53,440 --> 00:48:54,880
using that quite a bit lately

1514
00:48:54,880 --> 00:48:57,680
uh and so anyways through this we gained

1515
00:48:57,680 --> 00:48:59,599
access to one of their domain admin

1516
00:48:59,599 --> 00:49:00,400
accounts

1517
00:49:00,400 --> 00:49:01,839
i gained access to the domain

1518
00:49:01,839 --> 00:49:04,559
administrator represented a picture of

1519
00:49:04,559 --> 00:49:06,400
the domain controller for example and

1520
00:49:06,400 --> 00:49:08,079
then right so now i want to demonstrate

1521
00:49:08,079 --> 00:49:09,040
the risk

1522
00:49:09,040 --> 00:49:10,880
uh so we gained access directly to that

1523
00:49:10,880 --> 00:49:13,040
power chart that we showed earlier

1524
00:49:13,040 --> 00:49:15,680
so so now we directly have access to

1525
00:49:15,680 --> 00:49:17,520
mess with people's medical records to

1526
00:49:17,520 --> 00:49:18,480
mess with

1527
00:49:18,480 --> 00:49:21,440
uh to see all sorts right i can see all

1528
00:49:21,440 --> 00:49:22,800
i can log in as the administrator and

1529
00:49:22,800 --> 00:49:24,000
see all the different patients in the

1530
00:49:24,000 --> 00:49:26,800
hospital at any given time

1531
00:49:26,800 --> 00:49:28,800
i can see everybody's i can go to the hr

1532
00:49:28,800 --> 00:49:30,000
folder on the share drive

1533
00:49:30,000 --> 00:49:32,960
right and see all the access to uh all

1534
00:49:32,960 --> 00:49:34,400
the different salaries

1535
00:49:34,400 --> 00:49:36,960
by the way doctors get paid a ton we're

1536
00:49:36,960 --> 00:49:38,720
all in the wrong industry

1537
00:49:38,720 --> 00:49:41,760
they get paid well uh and then finally

1538
00:49:41,760 --> 00:49:43,200
you know this wouldn't be a pandemic

1539
00:49:43,200 --> 00:49:45,040
talk if i didn't show you here's

1540
00:49:45,040 --> 00:49:46,400
everybody in their hospital

1541
00:49:46,400 --> 00:49:48,480
exactly which room they're in their

1542
00:49:48,480 --> 00:49:49,680
medical record number

1543
00:49:49,680 --> 00:49:51,599
and everybody who tested positive for

1544
00:49:51,599 --> 00:49:53,200
covid in the hospital at this given

1545
00:49:53,200 --> 00:49:53,760
point right

1546
00:49:53,760 --> 00:49:55,920
also their situation report shows which

1547
00:49:55,920 --> 00:49:57,119
things they're doing to minimize the

1548
00:49:57,119 --> 00:49:57,760
risk

1549
00:49:57,760 --> 00:50:01,599
etc right so all sorts of bad bad things

1550
00:50:01,599 --> 00:50:03,440
so uh real quickly because i'm running

1551
00:50:03,440 --> 00:50:04,800
out of time how do i fix this

1552
00:50:04,800 --> 00:50:06,400
first and foremost we got to figure out

1553
00:50:06,400 --> 00:50:08,559
patching right this just demonstrates

1554
00:50:08,559 --> 00:50:10,160
why patching is important hospitals have

1555
00:50:10,160 --> 00:50:11,680
unique circumstances which make it

1556
00:50:11,680 --> 00:50:12,000
harder

1557
00:50:12,000 --> 00:50:14,400
for them but still we need something we

1558
00:50:14,400 --> 00:50:16,000
need to be able to patch these

1559
00:50:16,000 --> 00:50:18,640
laps is microsoft local administrator

1560
00:50:18,640 --> 00:50:20,079
password solution

1561
00:50:20,079 --> 00:50:23,200
that solves the problem of shared local

1562
00:50:23,200 --> 00:50:25,119
administrator passwords for you it's a

1563
00:50:25,119 --> 00:50:27,119
free tool provided by microsoft that

1564
00:50:27,119 --> 00:50:28,800
will randomly generate different ones

1565
00:50:28,800 --> 00:50:30,400
it's basically a password manager for

1566
00:50:30,400 --> 00:50:31,599
those local accounts

1567
00:50:31,599 --> 00:50:33,680
it will automate it for you go get that

1568
00:50:33,680 --> 00:50:35,359
that's awesome

1569
00:50:35,359 --> 00:50:39,280
that is a good link there on how to

1570
00:50:39,280 --> 00:50:42,559
stop the memory from storing clear text

1571
00:50:42,559 --> 00:50:44,319
passwords for example that lsas and the

1572
00:50:44,319 --> 00:50:45,680
mimikats we talked about and then

1573
00:50:45,680 --> 00:50:47,599
finally segmentation right so

1574
00:50:47,599 --> 00:50:51,599
i already referenced it as a as a

1575
00:50:51,599 --> 00:50:53,440
fire door but in this particular

1576
00:50:53,440 --> 00:50:55,119
instance it was important for

1577
00:50:55,119 --> 00:50:58,160
the um

1578
00:50:58,240 --> 00:51:00,480
it was important for the client that i

1579
00:51:00,480 --> 00:51:02,000
mentioned that this

1580
00:51:02,000 --> 00:51:04,160
uh where my laptop was was essentially

1581
00:51:04,160 --> 00:51:05,520
the same as if i walked into the

1582
00:51:05,520 --> 00:51:06,800
emergency room and plugged it in right

1583
00:51:06,800 --> 00:51:08,079
in the lobby right so

1584
00:51:08,079 --> 00:51:09,920
they don't have proper segmentation and

1585
00:51:09,920 --> 00:51:12,000
they don't have proper port control

1586
00:51:12,000 --> 00:51:13,599
so anybody can walk into that hospital

1587
00:51:13,599 --> 00:51:15,200
and do exactly what i just did pretty

1588
00:51:15,200 --> 00:51:16,400
scary stuff

1589
00:51:16,400 --> 00:51:18,480
segmentation is basically going back to

1590
00:51:18,480 --> 00:51:19,839
that assumed compromise

1591
00:51:19,839 --> 00:51:22,160
you want to go and you want to put fire

1592
00:51:22,160 --> 00:51:24,319
doors in place using strong access

1593
00:51:24,319 --> 00:51:25,839
control lists

1594
00:51:25,839 --> 00:51:28,240
such that if i compromise one area of

1595
00:51:28,240 --> 00:51:30,400
the hospital i can't get to every area

1596
00:51:30,400 --> 00:51:31,839
what i recommend is we start with our

1597
00:51:31,839 --> 00:51:33,839
most high risk areas right so

1598
00:51:33,839 --> 00:51:35,920
the domain admins should be in a

1599
00:51:35,920 --> 00:51:37,200
separate vlan

1600
00:51:37,200 --> 00:51:38,480
yes they need to reach out to everybody

1601
00:51:38,480 --> 00:51:40,079
but nobody needs to reach them that way

1602
00:51:40,079 --> 00:51:42,240
i can't dump the contents of memories

1603
00:51:42,240 --> 00:51:44,240
okay so with my little bit of remaining

1604
00:51:44,240 --> 00:51:45,839
time here let's talk about

1605
00:51:45,839 --> 00:51:47,599
uh hospitals have a real problem right

1606
00:51:47,599 --> 00:51:49,359
so i went to the top

1607
00:51:49,359 --> 00:51:51,520
five google searches no kidding this is

1608
00:51:51,520 --> 00:51:53,200
just one through five results when i

1609
00:51:53,200 --> 00:51:53,760
search for

1610
00:51:53,760 --> 00:51:56,319
employee login uh excuse me hospital

1611
00:51:56,319 --> 00:51:57,760
employee login this is the first five

1612
00:51:57,760 --> 00:51:59,119
results that popped up for me

1613
00:51:59,119 --> 00:52:02,160
so first ui health starting march 10

1614
00:52:02,160 --> 00:52:05,119
2020 you'll have we're gonna start doing

1615
00:52:05,119 --> 00:52:06,720
duo two-factor authentication first of

1616
00:52:06,720 --> 00:52:08,160
all thanks now i know it's duo

1617
00:52:08,160 --> 00:52:10,640
second of all what was took you to march

1618
00:52:10,640 --> 00:52:12,319
of 2020 that's a problem

1619
00:52:12,319 --> 00:52:14,640
right next employee logins in the top

1620
00:52:14,640 --> 00:52:15,839
right there

1621
00:52:15,839 --> 00:52:17,599
first of all they are showing me all the

1622
00:52:17,599 --> 00:52:20,480
different chronos self-service login the

1623
00:52:20,480 --> 00:52:22,400
webmail login etc

1624
00:52:22,400 --> 00:52:24,559
that's really convenient thank you also

1625
00:52:24,559 --> 00:52:25,440
i'm wondering if

1626
00:52:25,440 --> 00:52:26,960
that's the same situation i ran into

1627
00:52:26,960 --> 00:52:28,880
with my hospital where are all of those

1628
00:52:28,880 --> 00:52:30,000
protected with multi-factor

1629
00:52:30,000 --> 00:52:31,200
authentication

1630
00:52:31,200 --> 00:52:33,119
uh you know finally that bottom right

1631
00:52:33,119 --> 00:52:35,040
one well thank you for the phone number

1632
00:52:35,040 --> 00:52:37,680
uh for the service desk uh and there's

1633
00:52:37,680 --> 00:52:39,280
all the possible logins i would need

1634
00:52:39,280 --> 00:52:40,400
right so

1635
00:52:40,400 --> 00:52:43,359
great uh the next one here's the vpn

1636
00:52:43,359 --> 00:52:44,319
here's the internet

1637
00:52:44,319 --> 00:52:46,079
oh by the way if you're not using a

1638
00:52:46,079 --> 00:52:47,760
company computer you have to use this

1639
00:52:47,760 --> 00:52:48,160
link

1640
00:52:48,160 --> 00:52:50,960
to get into the vpn thanks need that

1641
00:52:50,960 --> 00:52:51,359
also

1642
00:52:51,359 --> 00:52:54,000
possible denial service it says on there

1643
00:52:54,000 --> 00:52:54,880
uh

1644
00:52:54,880 --> 00:52:57,520
when you uh when you're done uh please

1645
00:52:57,520 --> 00:52:59,440
disconnect to let others connect

1646
00:52:59,440 --> 00:53:01,920
well okay so that sounds uh like a

1647
00:53:01,920 --> 00:53:03,440
potential denial of service and then

1648
00:53:03,440 --> 00:53:04,319
finally

1649
00:53:04,319 --> 00:53:06,319
my favorite possibly is community health

1650
00:53:06,319 --> 00:53:07,599
gives me the entire list of

1651
00:53:07,599 --> 00:53:09,200
representatives who are on the phone

1652
00:53:09,200 --> 00:53:11,119
uh and so now i know exactly who's

1653
00:53:11,119 --> 00:53:13,040
working their their help desk their i.t

1654
00:53:13,040 --> 00:53:15,280
support so that's very helpful for maybe

1655
00:53:15,280 --> 00:53:16,800
that social engineering attack we talked

1656
00:53:16,800 --> 00:53:18,720
about

1657
00:53:18,720 --> 00:53:21,920
so uh hospitals in general have a crazy

1658
00:53:21,920 --> 00:53:23,760
need for availability they need to be

1659
00:53:23,760 --> 00:53:24,400
able to

1660
00:53:24,400 --> 00:53:26,079
access their systems they can't afford

1661
00:53:26,079 --> 00:53:27,440
downtime they can't

1662
00:53:27,440 --> 00:53:29,760
afford a emergency room doctor not being

1663
00:53:29,760 --> 00:53:31,599
able to log in they just can't do it

1664
00:53:31,599 --> 00:53:32,960
additionally as we've already talked

1665
00:53:32,960 --> 00:53:34,319
about some of the operating systems and

1666
00:53:34,319 --> 00:53:36,800
applications cannot be updated for any

1667
00:53:36,800 --> 00:53:38,640
for a variety of reasons because the

1668
00:53:38,640 --> 00:53:39,680
applications

1669
00:53:39,680 --> 00:53:43,040
only run on server 2003 or xp uh

1670
00:53:43,040 --> 00:53:44,559
additionally they have increased demand

1671
00:53:44,559 --> 00:53:46,400
for interconnectivity and sharing they

1672
00:53:46,400 --> 00:53:49,040
need from the operating room to send the

1673
00:53:49,040 --> 00:53:50,559
results down to the lab and that to be

1674
00:53:50,559 --> 00:53:52,160
shared immediately and there's a whole

1675
00:53:52,160 --> 00:53:53,760
lot of health reasons for them to share

1676
00:53:53,760 --> 00:53:55,280
data back and forth and it's super

1677
00:53:55,280 --> 00:53:57,200
sensitive data and then finally they

1678
00:53:57,200 --> 00:53:58,960
have all sorts of shared workstations

1679
00:53:58,960 --> 00:53:59,760
right so

1680
00:53:59,760 --> 00:54:01,839
the nurses all use the same computer or

1681
00:54:01,839 --> 00:54:03,440
same three computers etc

1682
00:54:03,440 --> 00:54:05,119
they also have shared user accounts

1683
00:54:05,119 --> 00:54:06,880
which prevent non non

1684
00:54:06,880 --> 00:54:10,480
repudiation so i don't know how to solve

1685
00:54:10,480 --> 00:54:12,240
it i want to open a conversation about

1686
00:54:12,240 --> 00:54:13,839
this because you know i've lost sleep

1687
00:54:13,839 --> 00:54:14,800
over this

1688
00:54:14,800 --> 00:54:16,640
uh but generally you know it's pretty

1689
00:54:16,640 --> 00:54:18,720
scary stuff so here's some things that i

1690
00:54:18,720 --> 00:54:20,160
can think of that would help it one

1691
00:54:20,160 --> 00:54:22,480
segmentation or even micro segregate

1692
00:54:22,480 --> 00:54:24,000
segmentation right so

1693
00:54:24,000 --> 00:54:26,480
um one of the things i proposed in a

1694
00:54:26,480 --> 00:54:28,000
small business initiative

1695
00:54:28,000 --> 00:54:29,920
thing a while back when i was a blue

1696
00:54:29,920 --> 00:54:31,040
teamer is

1697
00:54:31,040 --> 00:54:32,960
a micro segmentation device which is

1698
00:54:32,960 --> 00:54:34,079
basically

1699
00:54:34,079 --> 00:54:37,280
let's put a a

1700
00:54:37,280 --> 00:54:38,960
raspberry pi type machine that has a

1701
00:54:38,960 --> 00:54:40,160
whole lot of security tools like a

1702
00:54:40,160 --> 00:54:41,680
next-gen antivirus and

1703
00:54:41,680 --> 00:54:44,400
a host-based firewall in front of these

1704
00:54:44,400 --> 00:54:45,119
systems

1705
00:54:45,119 --> 00:54:47,440
uh and so there's a uh you know a

1706
00:54:47,440 --> 00:54:48,880
one-to-one connection between the

1707
00:54:48,880 --> 00:54:51,280
xp machine and this device and then this

1708
00:54:51,280 --> 00:54:52,000
device could

1709
00:54:52,000 --> 00:54:53,839
make smarter decisions about what data

1710
00:54:53,839 --> 00:54:55,280
is necessary and what data is not

1711
00:54:55,280 --> 00:54:56,880
necessary um so something like that just

1712
00:54:56,880 --> 00:54:58,480
a micro segmentation to try to prevent

1713
00:54:58,480 --> 00:54:59,040
it

1714
00:54:59,040 --> 00:55:00,480
getting rid of passwords in the hospital

1715
00:55:00,480 --> 00:55:02,720
so you know when you go to a bar

1716
00:55:02,720 --> 00:55:04,799
uh or a restaurant a lot of times the

1717
00:55:04,799 --> 00:55:06,720
receptionist just swiping that right to

1718
00:55:06,720 --> 00:55:08,960
get access to the the console

1719
00:55:08,960 --> 00:55:11,200
so stuff like that would still allow for

1720
00:55:11,200 --> 00:55:12,960
quick availability without

1721
00:55:12,960 --> 00:55:14,880
uh having the password like i saw the

1722
00:55:14,880 --> 00:55:16,480
password emergency one a thousand times

1723
00:55:16,480 --> 00:55:17,599
during this test

1724
00:55:17,599 --> 00:55:19,760
um additionally things like in the

1725
00:55:19,760 --> 00:55:21,359
military use a cac card and a pen so

1726
00:55:21,359 --> 00:55:22,880
it's just four digits but you at least

1727
00:55:22,880 --> 00:55:24,960
have the cap card for that multi-factor

1728
00:55:24,960 --> 00:55:26,319
uh we've already talked about awareness

1729
00:55:26,319 --> 00:55:27,920
training has to count and then

1730
00:55:27,920 --> 00:55:29,440
increasing the incident response

1731
00:55:29,440 --> 00:55:30,400
capabilities

1732
00:55:30,400 --> 00:55:32,079
i created a domain administrator account

1733
00:55:32,079 --> 00:55:33,760
on this and they never even noticed so

1734
00:55:33,760 --> 00:55:35,839
you know it just we have to work

1735
00:55:35,839 --> 00:55:37,200
together to make this better

1736
00:55:37,200 --> 00:55:39,200
um interested to hear your thoughts in

1737
00:55:39,200 --> 00:55:40,559
the discord chat

1738
00:55:40,559 --> 00:55:43,200
uh but i'm out of time for now so uh

1739
00:55:43,200 --> 00:55:44,799
loved having this conversation with you

1740
00:55:44,799 --> 00:55:48,000
uh hit me up at any point i'll share my

1741
00:55:48,000 --> 00:55:49,920
info in the discord chat and we can talk

1742
00:55:49,920 --> 00:55:51,760
more uh wish we could grab a beer

1743
00:55:51,760 --> 00:55:53,359
together or anything but uh

1744
00:55:53,359 --> 00:55:54,720
you know hopefully next year we won't be

1745
00:55:54,720 --> 00:55:56,559
virtual

1746
00:55:56,559 --> 00:55:59,680
thank you

