1
00:00:00,160 --> 00:00:02,320
hi welcome to b-side charlotte my name

2
00:00:02,320 --> 00:00:04,240
is rick rutledge i'm a senior security

3
00:00:04,240 --> 00:00:04,880
engineer

4
00:00:04,880 --> 00:00:07,200
with polarity and i'm here today to talk

5
00:00:07,200 --> 00:00:09,599
about uh hunting in general the title is

6
00:00:09,599 --> 00:00:11,040
tools don't hunt tools find

7
00:00:11,040 --> 00:00:14,080
analysts hunt so i'm going to kind of

8
00:00:14,080 --> 00:00:14,880
walk around

9
00:00:14,880 --> 00:00:17,760
the building blocks of a sock this is a

10
00:00:17,760 --> 00:00:18,400
out of the

11
00:00:18,400 --> 00:00:20,320
building blocks recommendation guide

12
00:00:20,320 --> 00:00:21,600
from sands

13
00:00:21,600 --> 00:00:24,320
on building your sock as a world-class

14
00:00:24,320 --> 00:00:25,599
operations center

15
00:00:25,599 --> 00:00:26,720
so i'm going to walk through kind of

16
00:00:26,720 --> 00:00:28,720
each of these chunks and give you what

17
00:00:28,720 --> 00:00:31,439
we've seen in real life from experience

18
00:00:31,439 --> 00:00:32,719
as far as

19
00:00:32,719 --> 00:00:34,640
best recommendations what we've seen

20
00:00:34,640 --> 00:00:36,000
problems with

21
00:00:36,000 --> 00:00:37,600
and how to get around some of those

22
00:00:37,600 --> 00:00:39,680
issues so the first section i'm going to

23
00:00:39,680 --> 00:00:41,520
talk about is technology

24
00:00:41,520 --> 00:00:44,480
so within the technology component of a

25
00:00:44,480 --> 00:00:45,200
sock

26
00:00:45,200 --> 00:00:47,840
it's broken up into groups so the

27
00:00:47,840 --> 00:00:48,960
technology piece is

28
00:00:48,960 --> 00:00:51,680
is often the easiest one that the

29
00:00:51,680 --> 00:00:52,879
low-hanging fruit that when

30
00:00:52,879 --> 00:00:54,239
you know first building a sock or even

31
00:00:54,239 --> 00:00:56,160
updating that the

32
00:00:56,160 --> 00:00:58,239
applications the uh software that's used

33
00:00:58,239 --> 00:00:59,520
in those hunts and

34
00:00:59,520 --> 00:01:01,520
investigations that's usually the first

35
00:01:01,520 --> 00:01:03,359
thing uh brought on board

36
00:01:03,359 --> 00:01:05,600
um often without a process in place so

37
00:01:05,600 --> 00:01:06,640
we're gonna go through each of these

38
00:01:06,640 --> 00:01:07,439
categories so

39
00:01:07,439 --> 00:01:09,439
can i talk about some of the problems we

40
00:01:09,439 --> 00:01:12,000
see of uh socks that are now mature

41
00:01:12,000 --> 00:01:13,439
using software that was bought before

42
00:01:13,439 --> 00:01:15,520
the process or even through the

43
00:01:15,520 --> 00:01:17,840
software cycle and updating so

44
00:01:17,840 --> 00:01:19,680
identification protection detection

45
00:01:19,680 --> 00:01:21,280
response and recovery

46
00:01:21,280 --> 00:01:22,720
and generally what we see is response

47
00:01:22,720 --> 00:01:24,320
and recovery there aren't quite as many

48
00:01:24,320 --> 00:01:25,520
tools for those categories and i'll

49
00:01:25,520 --> 00:01:28,240
touch on that when we get there

50
00:01:28,240 --> 00:01:30,720
so the first section identification this

51
00:01:30,720 --> 00:01:32,320
would be anything

52
00:01:32,320 --> 00:01:34,640
for recognizing the threats anything

53
00:01:34,640 --> 00:01:35,600
that logs or

54
00:01:35,600 --> 00:01:37,920
you know your sim risk analysis and then

55
00:01:37,920 --> 00:01:38,640
of course

56
00:01:38,640 --> 00:01:40,960
user and asset management user and asset

57
00:01:40,960 --> 00:01:42,560
management being a big one to maintain

58
00:01:42,560 --> 00:01:43,920
when there's changes users

59
00:01:43,920 --> 00:01:46,799
changing roles updates of new servers

60
00:01:46,799 --> 00:01:48,079
coming online

61
00:01:48,079 --> 00:01:50,000
so these pieces are very important to

62
00:01:50,000 --> 00:01:51,759
keep up to date as much as possible

63
00:01:51,759 --> 00:01:53,840
obviously and then log management we've

64
00:01:53,840 --> 00:01:55,200
got a lot to say about log management as

65
00:01:55,200 --> 00:01:56,960
well missing logs things that aren't uh

66
00:01:56,960 --> 00:01:57,759
updated

67
00:01:57,759 --> 00:02:00,159
in that realm can often leave you blind

68
00:02:00,159 --> 00:02:02,719
to threats

69
00:02:02,880 --> 00:02:06,000
the protection category this dives into

70
00:02:06,000 --> 00:02:06,560
the

71
00:02:06,560 --> 00:02:08,399
is referring to the proxy firewall

72
00:02:08,399 --> 00:02:10,000
endpoint protections any

73
00:02:10,000 --> 00:02:12,319
usually the stuff that goes in first for

74
00:02:12,319 --> 00:02:14,000
the first line of defense and security

75
00:02:14,000 --> 00:02:15,200
when you're thinking about just keeping

76
00:02:15,200 --> 00:02:18,480
people out um as well as the ssl and

77
00:02:18,480 --> 00:02:22,000
encryption layer um but one of the

78
00:02:22,000 --> 00:02:23,520
more often ones that i've been working

79
00:02:23,520 --> 00:02:25,280
with lately especially with uh

80
00:02:25,280 --> 00:02:27,599
you know financial and and other sectors

81
00:02:27,599 --> 00:02:29,120
where where private information is

82
00:02:29,120 --> 00:02:29,920
important is the

83
00:02:29,920 --> 00:02:33,920
dlp or data loss prevention component

84
00:02:34,480 --> 00:02:36,000
and then within the detection group we

85
00:02:36,000 --> 00:02:37,360
have all of our threat intelligence

86
00:02:37,360 --> 00:02:39,599
internal and external products

87
00:02:39,599 --> 00:02:41,440
and that's you know there's a wide

88
00:02:41,440 --> 00:02:43,360
variety for all of these categories of

89
00:02:43,360 --> 00:02:44,000
tools

90
00:02:44,000 --> 00:02:45,519
and it's usually a matter of looking

91
00:02:45,519 --> 00:02:47,120
between budget and what fits into your

92
00:02:47,120 --> 00:02:47,680
mode

93
00:02:47,680 --> 00:02:50,000
best often with thread intel you've got

94
00:02:50,000 --> 00:02:51,440
the option for open source or

95
00:02:51,440 --> 00:02:54,400
or not um community driven uh is a is a

96
00:02:54,400 --> 00:02:55,680
big one for thread intel

97
00:02:55,680 --> 00:02:57,519
and we'll dive into some more of those

98
00:02:57,519 --> 00:02:59,280
uh in a bit but um

99
00:02:59,280 --> 00:03:01,120
as well as on the detection side we have

100
00:03:01,120 --> 00:03:02,800
soar which is often

101
00:03:02,800 --> 00:03:04,720
one of the newer categories um often

102
00:03:04,720 --> 00:03:07,200
used for enhancing detections logs that

103
00:03:07,200 --> 00:03:07,920
have come in

104
00:03:07,920 --> 00:03:09,360
to understand if there's a threat there

105
00:03:09,360 --> 00:03:11,440
or not and then of course traffic

106
00:03:11,440 --> 00:03:13,200
analysis understanding patterns

107
00:03:13,200 --> 00:03:15,360
um and then putting a little bit more of

108
00:03:15,360 --> 00:03:16,959
the intelligence around the logs that

109
00:03:16,959 --> 00:03:18,080
you're already gathering like the

110
00:03:18,080 --> 00:03:19,280
machine learning with ai

111
00:03:19,280 --> 00:03:23,120
rf uba and uh just correlation of rules

112
00:03:23,120 --> 00:03:24,080
to understand

113
00:03:24,080 --> 00:03:26,239
when something means when an alert means

114
00:03:26,239 --> 00:03:27,920
something or when it doesn't

115
00:03:27,920 --> 00:03:29,599
and then of course your basic log

116
00:03:29,599 --> 00:03:30,959
monitoring and alerting

117
00:03:30,959 --> 00:03:33,040
when a happens alert on this or when

118
00:03:33,040 --> 00:03:34,080
when this event

119
00:03:34,080 --> 00:03:35,360
occurs we want to know about it every

120
00:03:35,360 --> 00:03:38,560
time and so the detection phase is often

121
00:03:38,560 --> 00:03:39,280
where

122
00:03:39,280 --> 00:03:41,120
most socks that i work with spend a

123
00:03:41,120 --> 00:03:44,560
majority of their time in focus

124
00:03:44,879 --> 00:03:47,280
and then on to the response category

125
00:03:47,280 --> 00:03:48,720
this is where we're talking about

126
00:03:48,720 --> 00:03:50,720
you know ddos protection endpoint

127
00:03:50,720 --> 00:03:52,239
detection and response and this is

128
00:03:52,239 --> 00:03:53,920
generally

129
00:03:53,920 --> 00:03:55,760
less less emphasis on the on the

130
00:03:55,760 --> 00:03:57,599
response more people are usually focused

131
00:03:57,599 --> 00:04:00,239
on detection and finding the problems um

132
00:04:00,239 --> 00:04:02,080
response is is usually for the more

133
00:04:02,080 --> 00:04:03,760
severe ones like like the ones mentioned

134
00:04:03,760 --> 00:04:04,799
here

135
00:04:04,799 --> 00:04:06,799
but this is this is one category where

136
00:04:06,799 --> 00:04:08,159
the vendors are a little bit behind as

137
00:04:08,159 --> 00:04:10,319
well

138
00:04:10,400 --> 00:04:12,720
and then of course recovery uh several

139
00:04:12,720 --> 00:04:14,000
stages of recovery

140
00:04:14,000 --> 00:04:15,360
you've got your vulnerability

141
00:04:15,360 --> 00:04:17,199
remediation products that are just

142
00:04:17,199 --> 00:04:18,880
you know going to clean your endpoints

143
00:04:18,880 --> 00:04:20,560
and within the virtualization

144
00:04:20,560 --> 00:04:22,079
environments you've got the ability to

145
00:04:22,079 --> 00:04:24,560
refer back snapshots go back in time

146
00:04:24,560 --> 00:04:26,080
uh take configs back to the way they

147
00:04:26,080 --> 00:04:27,360
were when things were working and not

148
00:04:27,360 --> 00:04:28,560
infected

149
00:04:28,560 --> 00:04:29,600
and then of course ransomware

150
00:04:29,600 --> 00:04:31,680
remediation has been a big topic over

151
00:04:31,680 --> 00:04:33,600
the past few years

152
00:04:33,600 --> 00:04:35,360
so all of these categories combined in

153
00:04:35,360 --> 00:04:37,360
subcategories of different products and

154
00:04:37,360 --> 00:04:39,600
tools that companies have

155
00:04:39,600 --> 00:04:42,240
that's a lot of tools so 25 categories

156
00:04:42,240 --> 00:04:43,680
here we've usually got more than one

157
00:04:43,680 --> 00:04:44,479
tool

158
00:04:44,479 --> 00:04:46,240
in a category most customers that i've

159
00:04:46,240 --> 00:04:47,759
worked with in the past uh

160
00:04:47,759 --> 00:04:50,000
a lot of times they have several um and

161
00:04:50,000 --> 00:04:51,600
so this quote from the cso of

162
00:04:51,600 --> 00:04:53,600
palo alto he's you know on the high end

163
00:04:53,600 --> 00:04:56,000
he's looking at 130 tool

164
00:04:56,000 --> 00:04:59,120
average for large enterprises um and i

165
00:04:59,120 --> 00:04:59,759
have been

166
00:04:59,759 --> 00:05:01,600
to custom companies wherever that's the

167
00:05:01,600 --> 00:05:03,039
case and then there's uh

168
00:05:03,039 --> 00:05:04,560
usually a team dedicated to figuring out

169
00:05:04,560 --> 00:05:06,479
which tools they need to get rid of

170
00:05:06,479 --> 00:05:08,479
but that team is not generally working

171
00:05:08,479 --> 00:05:10,400
with the sock directly or in the weeds

172
00:05:10,400 --> 00:05:11,120
so

173
00:05:11,120 --> 00:05:12,960
you know that that takes some tuning it

174
00:05:12,960 --> 00:05:14,560
takes work to get those right

175
00:05:14,560 --> 00:05:17,039
um but with that amount of tools um

176
00:05:17,039 --> 00:05:19,280
there's often a gap between the analysts

177
00:05:19,280 --> 00:05:22,160
and and the end game that the the

178
00:05:22,160 --> 00:05:23,039
finding the

179
00:05:23,039 --> 00:05:25,520
the hunting for the iocs and the bad

180
00:05:25,520 --> 00:05:26,400
actors

181
00:05:26,400 --> 00:05:28,880
um so that's where we the one of the

182
00:05:28,880 --> 00:05:31,199
best fixes we can get to with that is

183
00:05:31,199 --> 00:05:32,960
focusing on the people in the training

184
00:05:32,960 --> 00:05:35,919
and then aligning process to that

185
00:05:35,919 --> 00:05:37,759
this next one is just a quick snapshot

186
00:05:37,759 --> 00:05:40,240
of just a handful of the tools available

187
00:05:40,240 --> 00:05:42,400
so it can be overwhelming um to say the

188
00:05:42,400 --> 00:05:44,000
least that's where when you get your

189
00:05:44,000 --> 00:05:44,560
process

190
00:05:44,560 --> 00:05:47,600
defined first and then bring the tools

191
00:05:47,600 --> 00:05:48,880
in behind it that's that's

192
00:05:48,880 --> 00:05:51,520
uh going to give you a much finer scope

193
00:05:51,520 --> 00:05:52,080
of

194
00:05:52,080 --> 00:05:55,039
targeting those those threats so the the

195
00:05:55,039 --> 00:05:56,400
biggest problems with accessing all that

196
00:05:56,400 --> 00:05:57,520
data obviously the the

197
00:05:57,520 --> 00:05:59,600
time consumption involved in flipping

198
00:05:59,600 --> 00:06:01,039
between products so when you have five

199
00:06:01,039 --> 00:06:02,960
or six tools to do one thing

200
00:06:02,960 --> 00:06:04,319
you generally come down to one or two

201
00:06:04,319 --> 00:06:05,840
that you like the best and each analyst

202
00:06:05,840 --> 00:06:07,840
ends up doing something different

203
00:06:07,840 --> 00:06:10,000
so we get what we always see a lot in

204
00:06:10,000 --> 00:06:11,520
the field we're different analysts

205
00:06:11,520 --> 00:06:12,800
three different four different analysts

206
00:06:12,800 --> 00:06:13,919
on the same team have three or four

207
00:06:13,919 --> 00:06:16,080
different ways of doing the same thing

208
00:06:16,080 --> 00:06:18,639
so pivoting between tools is a big one

209
00:06:18,639 --> 00:06:20,000
that also requires more training

210
00:06:20,000 --> 00:06:22,000
so if you have those you know ten tools

211
00:06:22,000 --> 00:06:23,759
to do one thing uh that's

212
00:06:23,759 --> 00:06:26,080
ten different uh things that everybody

213
00:06:26,080 --> 00:06:27,440
has to be trained on

214
00:06:27,440 --> 00:06:29,199
you generally do have a smee for each

215
00:06:29,199 --> 00:06:31,520
product but uh then again you have

216
00:06:31,520 --> 00:06:32,560
if you have people using different

217
00:06:32,560 --> 00:06:34,720
products you have different results

218
00:06:34,720 --> 00:06:36,479
and then process deterioration comes out

219
00:06:36,479 --> 00:06:38,479
of this with the fact that they're

220
00:06:38,479 --> 00:06:39,840
using different things getting different

221
00:06:39,840 --> 00:06:43,039
results taking shortcuts because there's

222
00:06:43,039 --> 00:06:46,319
so much data to sift through if you know

223
00:06:46,319 --> 00:06:47,680
you're going about this manually you

224
00:06:47,680 --> 00:06:49,759
often will get burnt out looking at all

225
00:06:49,759 --> 00:06:51,440
that information

226
00:06:51,440 --> 00:06:52,960
and then there's obviously a need for

227
00:06:52,960 --> 00:06:54,560
better correlation between those

228
00:06:54,560 --> 00:06:55,520
separate tools

229
00:06:55,520 --> 00:06:58,240
to help with all this

230
00:06:58,880 --> 00:07:02,160
um obviously multiple monitors help

231
00:07:02,160 --> 00:07:04,560
and most people go that route but uh

232
00:07:04,560 --> 00:07:06,080
there's only so much you can do i've

233
00:07:06,080 --> 00:07:08,080
you know i've had up to four monitors i

234
00:07:08,080 --> 00:07:09,599
generally end up ignoring one so

235
00:07:09,599 --> 00:07:11,759
so you know you can only do so much with

236
00:07:11,759 --> 00:07:13,919
what you put in front of the person

237
00:07:13,919 --> 00:07:15,199
you need to make that more efficient

238
00:07:15,199 --> 00:07:16,800
less to look at and and you're going to

239
00:07:16,800 --> 00:07:19,599
get better results

240
00:07:19,840 --> 00:07:21,759
so you know the first piece the first

241
00:07:21,759 --> 00:07:22,960
slide i was showing you the different

242
00:07:22,960 --> 00:07:24,880
pieces of the sock so the technology

243
00:07:24,880 --> 00:07:27,440
stack again that's usually where socks

244
00:07:27,440 --> 00:07:27,919
start

245
00:07:27,919 --> 00:07:30,639
their invest investment in building out

246
00:07:30,639 --> 00:07:32,160
their sock

247
00:07:32,160 --> 00:07:34,960
and the people in the process come next

248
00:07:34,960 --> 00:07:35,520
but

249
00:07:35,520 --> 00:07:37,440
over a time once the stock matures you

250
00:07:37,440 --> 00:07:38,800
see more focus on process

251
00:07:38,800 --> 00:07:41,039
and better use of those tools aligning

252
00:07:41,039 --> 00:07:42,319
those tools with the established

253
00:07:42,319 --> 00:07:43,199
processes

254
00:07:43,199 --> 00:07:45,280
will eliminate unnecessary tools as well

255
00:07:45,280 --> 00:07:46,240
as focus

256
00:07:46,240 --> 00:07:48,879
the tools you know that can do 200

257
00:07:48,879 --> 00:07:50,479
things you may only need it for 50 of

258
00:07:50,479 --> 00:07:52,160
those things then you can focus in

259
00:07:52,160 --> 00:07:53,919
by your license for what you need and

260
00:07:53,919 --> 00:07:56,560
use it for that specific task

261
00:07:56,560 --> 00:07:58,400
and then building out an easy method for

262
00:07:58,400 --> 00:07:59,599
collaboration

263
00:07:59,599 --> 00:08:01,280
so you know there's stock analysts that

264
00:08:01,280 --> 00:08:02,800
are using different tools

265
00:08:02,800 --> 00:08:04,560
one guy finds something bad somebody

266
00:08:04,560 --> 00:08:05,840
else finds you know

267
00:08:05,840 --> 00:08:07,919
no no result if they're sharing that

268
00:08:07,919 --> 00:08:09,919
information you're less likely to miss

269
00:08:09,919 --> 00:08:11,199
something

270
00:08:11,199 --> 00:08:12,639
plus you're less likely to duplicate

271
00:08:12,639 --> 00:08:14,879
work so collaboration is very important

272
00:08:14,879 --> 00:08:15,599
in

273
00:08:15,599 --> 00:08:18,080
any sock and the biggest issue with that

274
00:08:18,080 --> 00:08:20,720
is making it easy for the users to do

275
00:08:20,720 --> 00:08:22,240
if you have a product that's cumbersome

276
00:08:22,240 --> 00:08:24,160
to use when collaborating

277
00:08:24,160 --> 00:08:26,240
analysts are less likely to do it and

278
00:08:26,240 --> 00:08:28,160
you're going to have more gaps

279
00:08:28,160 --> 00:08:30,160
and then consistency between analysts

280
00:08:30,160 --> 00:08:31,599
again that's refining the process and

281
00:08:31,599 --> 00:08:32,320
tool set

282
00:08:32,320 --> 00:08:35,519
giving everybody a very tight uh not

283
00:08:35,519 --> 00:08:37,519
not too narrow but a very tight set of

284
00:08:37,519 --> 00:08:39,760
processes so that they can focus on

285
00:08:39,760 --> 00:08:41,679
finding the the proper things that they

286
00:08:41,679 --> 00:08:45,120
need the proper data that they need

287
00:08:45,440 --> 00:08:48,480
the next component in this cycle

288
00:08:48,480 --> 00:08:50,640
i'm going to talk about is is the

289
00:08:50,640 --> 00:08:52,320
process so looking at the different

290
00:08:52,320 --> 00:08:53,760
processes i've seen around different

291
00:08:53,760 --> 00:08:54,880
socks

292
00:08:54,880 --> 00:08:56,800
we've come up with some some good ideas

293
00:08:56,800 --> 00:08:58,080
and bad ideas that we've seen

294
00:08:58,080 --> 00:08:59,200
so i'm kind of trying to put these

295
00:08:59,200 --> 00:09:00,800
together and highlight the problems and

296
00:09:00,800 --> 00:09:01,600
challenges and

297
00:09:01,600 --> 00:09:04,720
and how we can work around those

298
00:09:04,720 --> 00:09:07,040
so preparing for the hunt one of the

299
00:09:07,040 --> 00:09:08,640
quotes we've highlighted highlighted

300
00:09:08,640 --> 00:09:10,160
here is uh successful threat hunting

301
00:09:10,160 --> 00:09:10,959
depends

302
00:09:10,959 --> 00:09:12,240
on a thorough understanding of the

303
00:09:12,240 --> 00:09:14,080
operating environment meaning you know

304
00:09:14,080 --> 00:09:16,240
the targets where they're at

305
00:09:16,240 --> 00:09:18,959
what threat actors want understanding

306
00:09:18,959 --> 00:09:22,240
the environment's a big part of it um

307
00:09:22,240 --> 00:09:25,200
knowing the system's uh values is number

308
00:09:25,200 --> 00:09:25,920
one so

309
00:09:25,920 --> 00:09:27,920
understanding if there's some data on a

310
00:09:27,920 --> 00:09:29,120
system that's that's

311
00:09:29,120 --> 00:09:31,200
not sensitive or it's not as important

312
00:09:31,200 --> 00:09:33,680
um why waste time hunting that uh area

313
00:09:33,680 --> 00:09:35,200
of the network or looking at logs for

314
00:09:35,200 --> 00:09:36,640
that system

315
00:09:36,640 --> 00:09:38,399
but knowing the value of those systems

316
00:09:38,399 --> 00:09:40,560
to outside actors is key

317
00:09:40,560 --> 00:09:42,000
also understanding the orientation of

318
00:09:42,000 --> 00:09:43,680
their system so if you know you have a

319
00:09:43,680 --> 00:09:44,800
system that's unimportant that you're

320
00:09:44,800 --> 00:09:45,680
not focused on

321
00:09:45,680 --> 00:09:47,519
can it reach a system that is important

322
00:09:47,519 --> 00:09:49,600
so looking for lateral communication

323
00:09:49,600 --> 00:09:51,839
things that you know ports open that

324
00:09:51,839 --> 00:09:53,040
shouldn't be

325
00:09:53,040 --> 00:09:55,279
configuration items that uh you know

326
00:09:55,279 --> 00:09:56,320
could be changed

327
00:09:56,320 --> 00:09:58,160
behind your back and you not realize it

328
00:09:58,160 --> 00:10:00,080
because you don't know the configuration

329
00:10:00,080 --> 00:10:02,079
so knowing the configuration that's

330
00:10:02,079 --> 00:10:03,680
intended for that device

331
00:10:03,680 --> 00:10:05,440
is another big one so that when there is

332
00:10:05,440 --> 00:10:07,120
a breach you don't let it sit for six

333
00:10:07,120 --> 00:10:07,920
months while they

334
00:10:07,920 --> 00:10:10,800
do what they want with it

335
00:10:11,920 --> 00:10:14,720
companies often prioritize logging over

336
00:10:14,720 --> 00:10:15,200
training

337
00:10:15,200 --> 00:10:17,920
so you get a new system new a new

338
00:10:17,920 --> 00:10:18,959
network of servers

339
00:10:18,959 --> 00:10:21,120
stood up in production um the first

340
00:10:21,120 --> 00:10:23,120
thing they do is turn logging on so it's

341
00:10:23,120 --> 00:10:26,079
taken care of and it's alerting so done

342
00:10:26,079 --> 00:10:26,640
right

343
00:10:26,640 --> 00:10:28,240
the problem is that analysts are getting

344
00:10:28,240 --> 00:10:30,000
this information they see an alert

345
00:10:30,000 --> 00:10:31,839
that says it's a red flag go look at

346
00:10:31,839 --> 00:10:34,000
this something bad's going on

347
00:10:34,000 --> 00:10:35,680
without context around what that system

348
00:10:35,680 --> 00:10:37,200
is there for and the responsibility of

349
00:10:37,200 --> 00:10:38,079
that server

350
00:10:38,079 --> 00:10:40,640
um it's not as valuable so they could

351
00:10:40,640 --> 00:10:42,320
get an alert that might mean something

352
00:10:42,320 --> 00:10:43,760
on one system and nothing on another

353
00:10:43,760 --> 00:10:45,279
depending on the job of those

354
00:10:45,279 --> 00:10:47,440
those servers also knowing what ports

355
00:10:47,440 --> 00:10:48,320
should be open

356
00:10:48,320 --> 00:10:50,640
when they get there so giving those

357
00:10:50,640 --> 00:10:51,600
security teams

358
00:10:51,600 --> 00:10:53,279
information more information and context

359
00:10:53,279 --> 00:10:55,120
around the assets they're protecting

360
00:10:55,120 --> 00:10:58,560
is key for them to be able to quickly

361
00:10:58,839 --> 00:11:00,000
respond

362
00:11:00,000 --> 00:11:02,240
and then forming a hypothesis um the

363
00:11:02,240 --> 00:11:04,560
next phase in the process would be

364
00:11:04,560 --> 00:11:05,920
figuring out okay we've got this

365
00:11:05,920 --> 00:11:07,920
information about threats

366
00:11:07,920 --> 00:11:09,519
potential threats and known threats

367
00:11:09,519 --> 00:11:11,920
coming in um you have to formulate

368
00:11:11,920 --> 00:11:14,160
what what you think is is happening the

369
00:11:14,160 --> 00:11:16,240
hypothesis you know figures out what the

370
00:11:16,240 --> 00:11:17,680
goal of that threat actor is what

371
00:11:17,680 --> 00:11:18,640
they're trying to gain

372
00:11:18,640 --> 00:11:21,600
um access to and why um this is usually

373
00:11:21,600 --> 00:11:23,120
the hardest part of the process is to

374
00:11:23,120 --> 00:11:24,720
try and figure out what someone else is

375
00:11:24,720 --> 00:11:25,839
thinking when you when you see that

376
00:11:25,839 --> 00:11:26,240
there's

377
00:11:26,240 --> 00:11:29,279
there's something going on you can use

378
00:11:29,279 --> 00:11:31,040
risk-based approaches is a very common

379
00:11:31,040 --> 00:11:33,120
way to do this to figure out okay this

380
00:11:33,120 --> 00:11:33,440
this

381
00:11:33,440 --> 00:11:35,839
risk exists here's the exploit for it

382
00:11:35,839 --> 00:11:37,920
it's meant to do this one thing

383
00:11:37,920 --> 00:11:39,040
so that's probably what they're trying

384
00:11:39,040 --> 00:11:41,360
to get that's where the threat intel

385
00:11:41,360 --> 00:11:42,880
comes in to feed you that information so

386
00:11:42,880 --> 00:11:43,600
using those

387
00:11:43,600 --> 00:11:45,839
tools together can help you format a

388
00:11:45,839 --> 00:11:47,440
hypothesis

389
00:11:47,440 --> 00:11:49,839
um other challenges with this is making

390
00:11:49,839 --> 00:11:51,519
sure your thread intel is accurate and

391
00:11:51,519 --> 00:11:52,079
current

392
00:11:52,079 --> 00:11:54,880
and relevant um you know 90 of thread

393
00:11:54,880 --> 00:11:55,600
intel

394
00:11:55,600 --> 00:11:57,360
a good thread intel feed might not be

395
00:11:57,360 --> 00:11:59,360
relevant for my network i may not have

396
00:11:59,360 --> 00:12:01,519
certain services running so so you have

397
00:12:01,519 --> 00:12:02,720
to sift through that information make

398
00:12:02,720 --> 00:12:03,680
sure you're looking at what's what

399
00:12:03,680 --> 00:12:06,399
matters to your organization

400
00:12:06,399 --> 00:12:09,200
and this also you know the challenge

401
00:12:09,200 --> 00:12:10,639
challenge with this one is also a

402
00:12:10,639 --> 00:12:12,079
historical information

403
00:12:12,079 --> 00:12:14,320
matching up what you've seen in the past

404
00:12:14,320 --> 00:12:15,279
is not always

405
00:12:15,279 --> 00:12:17,600
as quick as searching for a ticket that

406
00:12:17,600 --> 00:12:19,360
had this ip in it before

407
00:12:19,360 --> 00:12:21,760
sometimes things change ips or names

408
00:12:21,760 --> 00:12:22,880
change there's there's a lot of

409
00:12:22,880 --> 00:12:24,240
variables in there that can cause the

410
00:12:24,240 --> 00:12:25,040
historical

411
00:12:25,040 --> 00:12:27,440
data to not be as helpful as it should

412
00:12:27,440 --> 00:12:28,240
be

413
00:12:28,240 --> 00:12:29,760
so normalizing that and making it

414
00:12:29,760 --> 00:12:31,760
searchable and relevant and attached to

415
00:12:31,760 --> 00:12:33,040
the current incident

416
00:12:33,040 --> 00:12:35,200
um that that's usually a big challenge

417
00:12:35,200 --> 00:12:36,079
in formatting this

418
00:12:36,079 --> 00:12:38,320
hypothesis and then of course

419
00:12:38,320 --> 00:12:40,320
identification of security controls

420
00:12:40,320 --> 00:12:42,160
knowing which firewalls they should be

421
00:12:42,160 --> 00:12:43,760
going through which proxy server should

422
00:12:43,760 --> 00:12:44,079
be

423
00:12:44,079 --> 00:12:46,160
serving up that web page and

424
00:12:46,160 --> 00:12:48,079
understanding the flow of the network

425
00:12:48,079 --> 00:12:49,040
behind

426
00:12:49,040 --> 00:12:53,600
behind everything you're looking at

427
00:12:53,600 --> 00:12:55,600
and then log collection once you've got

428
00:12:55,600 --> 00:12:56,639
your hypothesis

429
00:12:56,639 --> 00:12:57,839
you've figured out what you're looking

430
00:12:57,839 --> 00:12:59,360
for and what the threat actor is looking

431
00:12:59,360 --> 00:13:00,079
for

432
00:13:00,079 --> 00:13:01,519
now it's time to go gather the evidence

433
00:13:01,519 --> 00:13:03,920
to figure out um what else he did

434
00:13:03,920 --> 00:13:05,920
or what is all the what was all the data

435
00:13:05,920 --> 00:13:06,959
that that leaked out

436
00:13:06,959 --> 00:13:09,519
everything that you um can put together

437
00:13:09,519 --> 00:13:10,000
from

438
00:13:10,000 --> 00:13:11,360
the logs is going to help in

439
00:13:11,360 --> 00:13:13,360
understanding what happened um

440
00:13:13,360 --> 00:13:16,240
so the log reliability and availability

441
00:13:16,240 --> 00:13:17,120
is usually uh

442
00:13:17,120 --> 00:13:19,040
one of the issues but that that's got to

443
00:13:19,040 --> 00:13:20,560
be verified now you got to make sure

444
00:13:20,560 --> 00:13:21,920
you've got logs from the server for the

445
00:13:21,920 --> 00:13:23,440
time frame in question

446
00:13:23,440 --> 00:13:25,120
um and if not you've got to take more

447
00:13:25,120 --> 00:13:27,360
extreme actions grabbing network traffic

448
00:13:27,360 --> 00:13:28,560
that sort of thing

449
00:13:28,560 --> 00:13:30,399
um and logs for you know any

450
00:13:30,399 --> 00:13:31,680
investigation are usually coming from

451
00:13:31,680 --> 00:13:32,639
multiple sources

452
00:13:32,639 --> 00:13:35,839
with most customers i work with

453
00:13:35,839 --> 00:13:36,959
every now and then you get someone that

454
00:13:36,959 --> 00:13:38,959
has one centralized log server

455
00:13:38,959 --> 00:13:41,519
that's a lot a lot simpler if you can if

456
00:13:41,519 --> 00:13:42,720
you can manage to get there

457
00:13:42,720 --> 00:13:44,160
but it's not always the case generally

458
00:13:44,160 --> 00:13:45,360
you have different departments that have

459
00:13:45,360 --> 00:13:46,880
different budgets and have different

460
00:13:46,880 --> 00:13:47,839
products

461
00:13:47,839 --> 00:13:49,519
so piecing those things together is key

462
00:13:49,519 --> 00:13:52,560
to understand the whole picture

463
00:13:52,720 --> 00:13:53,839
some challenges with putting that

464
00:13:53,839 --> 00:13:56,160
information together is that

465
00:13:56,160 --> 00:13:58,000
as i mentioned many log sources don't

466
00:13:58,000 --> 00:13:59,839
easily port into a central management

467
00:13:59,839 --> 00:14:01,440
system so you may not be able to cross

468
00:14:01,440 --> 00:14:02,000
certain network

469
00:14:02,000 --> 00:14:05,199
borders so it has to live somewhere else

470
00:14:05,199 --> 00:14:08,399
many high value systems legacy systems

471
00:14:08,399 --> 00:14:09,600
they often don't have

472
00:14:09,600 --> 00:14:11,760
a normalized log format so you may have

473
00:14:11,760 --> 00:14:12,880
to do some

474
00:14:12,880 --> 00:14:14,880
manual work to sift through those logs

475
00:14:14,880 --> 00:14:16,480
and figure out you know what's relevant

476
00:14:16,480 --> 00:14:17,680
what's not

477
00:14:17,680 --> 00:14:20,480
in extreme cases you can't get the logs

478
00:14:20,480 --> 00:14:20,800
so

479
00:14:20,800 --> 00:14:22,560
your only option is to go do live

480
00:14:22,560 --> 00:14:24,320
forensics captures on the on the

481
00:14:24,320 --> 00:14:26,560
endpoints looking at traffic network

482
00:14:26,560 --> 00:14:30,399
traffic that sort of thing

483
00:14:30,399 --> 00:14:32,639
and then for the next phase of our

484
00:14:32,639 --> 00:14:33,839
process

485
00:14:33,839 --> 00:14:36,480
segment of the sock is the investigation

486
00:14:36,480 --> 00:14:37,199
so once you've

487
00:14:37,199 --> 00:14:38,959
formed a hypothesis collected your logs

488
00:14:38,959 --> 00:14:40,160
and your evidence it's time to

489
00:14:40,160 --> 00:14:41,519
investigate and try to figure out

490
00:14:41,519 --> 00:14:42,959
exactly what happened

491
00:14:42,959 --> 00:14:45,120
first thing to do is to confirm was this

492
00:14:45,120 --> 00:14:47,920
threat realized was was this successful

493
00:14:47,920 --> 00:14:50,240
uh an attempt to get data or whatever

494
00:14:50,240 --> 00:14:51,360
the target

495
00:14:51,360 --> 00:14:54,160
was trying to do to what extent did they

496
00:14:54,160 --> 00:14:54,800
get

497
00:14:54,800 --> 00:14:56,480
the information they were trying to get

498
00:14:56,480 --> 00:14:58,560
or did they succeed or not

499
00:14:58,560 --> 00:15:00,160
and then establishing a timeline of

500
00:15:00,160 --> 00:15:02,880
events that's obviously key for logs and

501
00:15:02,880 --> 00:15:04,320
this may be where you have to pivot back

502
00:15:04,320 --> 00:15:05,680
to some of the other steps maybe you

503
00:15:05,680 --> 00:15:07,360
need more logs maybe you need data from

504
00:15:07,360 --> 00:15:08,639
another system that you've discovered

505
00:15:08,639 --> 00:15:10,000
was involved

506
00:15:10,000 --> 00:15:12,560
so often you go during the investigation

507
00:15:12,560 --> 00:15:13,440
phase

508
00:15:13,440 --> 00:15:15,199
back and forth and capturing more

509
00:15:15,199 --> 00:15:16,800
information

510
00:15:16,800 --> 00:15:18,480
and then determining the impact and

511
00:15:18,480 --> 00:15:19,920
figuring out what this

512
00:15:19,920 --> 00:15:21,920
this breach or attempted breach meant

513
00:15:21,920 --> 00:15:24,560
for the company

514
00:15:25,360 --> 00:15:26,959
biggest challenges on the investigative

515
00:15:26,959 --> 00:15:29,680
phase the budgetary limits

516
00:15:29,680 --> 00:15:31,360
along with you know your mandate to

517
00:15:31,360 --> 00:15:32,800
operate a risk-based approach often

518
00:15:32,800 --> 00:15:34,399
limit the scope so

519
00:15:34,399 --> 00:15:36,959
operating with a log management system

520
00:15:36,959 --> 00:15:37,839
that you've only

521
00:15:37,839 --> 00:15:39,360
purchased a certain amount of logging

522
00:15:39,360 --> 00:15:41,680
for you maybe you couldn't store logs

523
00:15:41,680 --> 00:15:43,440
for the firewalls but just the servers

524
00:15:43,440 --> 00:15:45,040
and so you don't have all of the

525
00:15:45,040 --> 00:15:47,360
connectivity attempts in between that's

526
00:15:47,360 --> 00:15:49,040
an extreme case but but i have seen

527
00:15:49,040 --> 00:15:49,519
similar

528
00:15:49,519 --> 00:15:51,759
situations and then evaluating

529
00:15:51,759 --> 00:15:53,519
information from a narrowed viewer or

530
00:15:53,519 --> 00:15:54,000
bias

531
00:15:54,000 --> 00:15:56,959
can can cause you to miss data so you

532
00:15:56,959 --> 00:15:58,560
know looking at that narrower scope of

533
00:15:58,560 --> 00:15:59,519
information

534
00:15:59,519 --> 00:16:00,880
shorter time frames than than you

535
00:16:00,880 --> 00:16:02,720
otherwise would be able to um

536
00:16:02,720 --> 00:16:04,639
can just cause you to not be able to see

537
00:16:04,639 --> 00:16:05,759
and have blind spots

538
00:16:05,759 --> 00:16:08,320
uh along the investigative route and

539
00:16:08,320 --> 00:16:09,839
then reviewing logs in isolation and

540
00:16:09,839 --> 00:16:10,480
manually

541
00:16:10,480 --> 00:16:13,839
um just any manual task in general

542
00:16:13,839 --> 00:16:15,120
is going to be cumbersome and mind

543
00:16:15,120 --> 00:16:17,120
numbing and cause cause you to miss

544
00:16:17,120 --> 00:16:17,600
things

545
00:16:17,600 --> 00:16:19,600
people start uh glossing over when they

546
00:16:19,600 --> 00:16:21,279
get to page 50 of the log

547
00:16:21,279 --> 00:16:22,959
for example and you're not going to

548
00:16:22,959 --> 00:16:26,399
catch everything manually that way

549
00:16:26,399 --> 00:16:28,720
so that was the technology piece and the

550
00:16:28,720 --> 00:16:31,040
process piece of the stack

551
00:16:31,040 --> 00:16:32,639
the next component i want to talk more

552
00:16:32,639 --> 00:16:34,480
about is a little bit more about the

553
00:16:34,480 --> 00:16:35,199
people

554
00:16:35,199 --> 00:16:37,519
so talking about some of the training

555
00:16:37,519 --> 00:16:39,279
with the actual individuals doing the

556
00:16:39,279 --> 00:16:40,880
job

557
00:16:40,880 --> 00:16:43,759
the training as well as um focusing on

558
00:16:43,759 --> 00:16:44,240
the

559
00:16:44,240 --> 00:16:45,759
the parts of the process that they need

560
00:16:45,759 --> 00:16:48,399
to focus on so this is where we get into

561
00:16:48,399 --> 00:16:49,839
actually trying to avoid those

562
00:16:49,839 --> 00:16:51,680
mind-numbing blind spots

563
00:16:51,680 --> 00:16:53,440
so the focus of this section is going to

564
00:16:53,440 --> 00:16:56,000
be on the blind spots themselves

565
00:16:56,000 --> 00:16:59,120
um enhancing the hunt one of the things

566
00:16:59,120 --> 00:17:00,160
that we can do

567
00:17:00,160 --> 00:17:03,040
is or one example i found here is a it's

568
00:17:03,040 --> 00:17:03,279
a

569
00:17:03,279 --> 00:17:05,760
where's waldo graphic and there's

570
00:17:05,760 --> 00:17:06,559
actually an

571
00:17:06,559 --> 00:17:08,400
algorithm that someone wrote and i've

572
00:17:08,400 --> 00:17:10,000
got the link in this uh slideshow that

573
00:17:10,000 --> 00:17:11,039
i'll show at the end

574
00:17:11,039 --> 00:17:13,520
that um someone wrote it's probably like

575
00:17:13,520 --> 00:17:14,640
10 lines of code

576
00:17:14,640 --> 00:17:16,640
it's pretty pretty uh brief but it

577
00:17:16,640 --> 00:17:18,000
eliminates all

578
00:17:18,000 --> 00:17:20,480
the colors but rad or dims them finds

579
00:17:20,480 --> 00:17:22,400
certain patterns looks flips it to black

580
00:17:22,400 --> 00:17:23,359
and white and looks for a certain

581
00:17:23,359 --> 00:17:24,319
pattern

582
00:17:24,319 --> 00:17:26,799
and then uses the the simple code and it

583
00:17:26,799 --> 00:17:27,599
finds wall to

584
00:17:27,599 --> 00:17:30,320
90 of the time to 95 percent of the time

585
00:17:30,320 --> 00:17:30,640
so

586
00:17:30,640 --> 00:17:32,640
using code to speed things up and help

587
00:17:32,640 --> 00:17:34,240
you get somewhere quicker

588
00:17:34,240 --> 00:17:36,160
um you know making use of your tools

589
00:17:36,160 --> 00:17:37,360
it's kind of the highlight here this

590
00:17:37,360 --> 00:17:39,760
is enhancing the hunt with the tools but

591
00:17:39,760 --> 00:17:40,480
also knowing

592
00:17:40,480 --> 00:17:43,360
what you're looking for

593
00:17:44,240 --> 00:17:46,000
so the challenges the biggest challenge

594
00:17:46,000 --> 00:17:46,880
i'm going to highlight today are the

595
00:17:46,880 --> 00:17:48,080
blind spots

596
00:17:48,080 --> 00:17:50,400
uh decimating disseminating that

597
00:17:50,400 --> 00:17:51,760
historical information

598
00:17:51,760 --> 00:17:53,200
among the team and getting that

599
00:17:53,200 --> 00:17:54,799
information out to everyone

600
00:17:54,799 --> 00:17:58,320
um that's that's uh key as well

601
00:17:58,320 --> 00:18:00,240
and then real-time collaboration between

602
00:18:00,240 --> 00:18:02,000
all the analysts working on an incident

603
00:18:02,000 --> 00:18:02,480
uh

604
00:18:02,480 --> 00:18:04,400
generally is something that uh most

605
00:18:04,400 --> 00:18:06,240
socks you know can do

606
00:18:06,240 --> 00:18:08,799
90 of the time 75 percent is probably

607
00:18:08,799 --> 00:18:10,160
more of the average i see that they

608
00:18:10,160 --> 00:18:12,000
they're happy with that um and that's

609
00:18:12,000 --> 00:18:13,520
where it comes down to more of a process

610
00:18:13,520 --> 00:18:14,000
and figuring

611
00:18:14,000 --> 00:18:16,080
out what tools work for your group for

612
00:18:16,080 --> 00:18:19,199
real-time collaboration

613
00:18:20,400 --> 00:18:22,799
so this is just kind of an interesting

614
00:18:22,799 --> 00:18:23,520
fact about

615
00:18:23,520 --> 00:18:25,600
about blind spots in general so the

616
00:18:25,600 --> 00:18:26,559
optic nerve

617
00:18:26,559 --> 00:18:29,520
routes before the nervous fibers are out

618
00:18:29,520 --> 00:18:31,120
before the optic nerve in each

619
00:18:31,120 --> 00:18:33,360
in every human's eye that creates a

620
00:18:33,360 --> 00:18:34,480
blind spot so everyone's

621
00:18:34,480 --> 00:18:37,840
at least one blind spot in each eye

622
00:18:37,840 --> 00:18:40,000
the way that our brain synthesizes both

623
00:18:40,000 --> 00:18:42,080
of those images together and overlaps

624
00:18:42,080 --> 00:18:42,480
them

625
00:18:42,480 --> 00:18:44,640
it is able to ignore the blind spots in

626
00:18:44,640 --> 00:18:46,559
both eyes creating a full image

627
00:18:46,559 --> 00:18:48,400
so this is kind of a synonymous with how

628
00:18:48,400 --> 00:18:49,600
we're trying to look at the network and

629
00:18:49,600 --> 00:18:50,320
figure out

630
00:18:50,320 --> 00:18:52,480
when when something's not visible can we

631
00:18:52,480 --> 00:18:56,640
see it from another angle

632
00:18:56,640 --> 00:18:58,559
hunting where you're blind can give you

633
00:18:58,559 --> 00:18:59,919
better vision tomorrow

634
00:18:59,919 --> 00:19:02,240
so so figuring out and looking in those

635
00:19:02,240 --> 00:19:05,520
spots where you don't have visibility

636
00:19:05,520 --> 00:19:08,400
helps build out that uh that visibility

637
00:19:08,400 --> 00:19:09,520
for the future so

638
00:19:09,520 --> 00:19:11,919
an example of this is where you're not

639
00:19:11,919 --> 00:19:13,919
capturing logging data for example

640
00:19:13,919 --> 00:19:15,840
um your hunt might lead you there and

641
00:19:15,840 --> 00:19:17,120
figure out another way that you're going

642
00:19:17,120 --> 00:19:18,480
to have to capture information from that

643
00:19:18,480 --> 00:19:20,080
system so that you can see when there

644
00:19:20,080 --> 00:19:20,400
are

645
00:19:20,400 --> 00:19:22,160
incidents or issues with that with that

646
00:19:22,160 --> 00:19:25,840
particular part of the network

647
00:19:26,160 --> 00:19:28,720
and this is based on the diamond model

648
00:19:28,720 --> 00:19:29,200
which

649
00:19:29,200 --> 00:19:31,200
for each thread actor you you've got

650
00:19:31,200 --> 00:19:32,720
four points four key points that you

651
00:19:32,720 --> 00:19:34,000
want to try to collect

652
00:19:34,000 --> 00:19:36,640
so who are they what data are they after

653
00:19:36,640 --> 00:19:38,480
and what are their capabilities and

654
00:19:38,480 --> 00:19:40,240
methods

655
00:19:40,240 --> 00:19:42,000
and of course what infrastructure do

656
00:19:42,000 --> 00:19:43,440
they use so

657
00:19:43,440 --> 00:19:45,520
the the idea here is that if you have

658
00:19:45,520 --> 00:19:47,360
all four of these pieces of information

659
00:19:47,360 --> 00:19:49,120
you could lose one and still have

660
00:19:49,120 --> 00:19:50,720
visibility to what that threat actor is

661
00:19:50,720 --> 00:19:51,840
doing

662
00:19:51,840 --> 00:19:53,679
if you only have one piece of this data

663
00:19:53,679 --> 00:19:55,200
then then you're single threaded and

664
00:19:55,200 --> 00:19:56,400
you're

665
00:19:56,400 --> 00:19:58,799
basically cut off if he changes his ip

666
00:19:58,799 --> 00:20:00,960
and that's all you had for example

667
00:20:00,960 --> 00:20:02,880
so so the key is to get as much about

668
00:20:02,880 --> 00:20:04,799
each actor as you can

669
00:20:04,799 --> 00:20:06,480
from all of the different sources that

670
00:20:06,480 --> 00:20:08,400
you have and make use of the technology

671
00:20:08,400 --> 00:20:09,679
to gather that information and don't

672
00:20:09,679 --> 00:20:11,360
just stop when you see the ip address

673
00:20:11,360 --> 00:20:12,240
keep going

674
00:20:12,240 --> 00:20:14,000
um and get as much information as you

675
00:20:14,000 --> 00:20:15,280
can so something

676
00:20:15,280 --> 00:20:17,360
about you know the model does change

677
00:20:17,360 --> 00:20:18,400
you've still got

678
00:20:18,400 --> 00:20:21,840
eyes on that on that actor

679
00:20:23,840 --> 00:20:25,760
so this uh graphic i'm gonna switch to

680
00:20:25,760 --> 00:20:27,200
kind of some some graphic

681
00:20:27,200 --> 00:20:29,039
uh demonstrations here that kind of walk

682
00:20:29,039 --> 00:20:31,280
through some different ways to observe

683
00:20:31,280 --> 00:20:34,480
uh the information so

684
00:20:34,480 --> 00:20:36,880
the unknown threats everybody's got

685
00:20:36,880 --> 00:20:38,240
unknown threats that can affect their

686
00:20:38,240 --> 00:20:39,600
organization

687
00:20:39,600 --> 00:20:41,200
and then there's realized and observed

688
00:20:41,200 --> 00:20:42,640
threat actors so you know

689
00:20:42,640 --> 00:20:44,159
that information it's coming through

690
00:20:44,159 --> 00:20:45,679
your threat feeds you've had attacks in

691
00:20:45,679 --> 00:20:46,880
the past that you've

692
00:20:46,880 --> 00:20:48,960
identified what was going on you blocked

693
00:20:48,960 --> 00:20:50,480
those

694
00:20:50,480 --> 00:20:53,280
there are no knowns known unknowns but

695
00:20:53,280 --> 00:20:54,480
there are also

696
00:20:54,480 --> 00:20:56,960
unknown unknowns so that makes sense you

697
00:20:56,960 --> 00:20:58,640
don't know what you don't know

698
00:20:58,640 --> 00:21:01,120
it's actually donald rumsfeld quote so

699
00:21:01,120 --> 00:21:02,559
that's basically telling you

700
00:21:02,559 --> 00:21:04,559
you you know some of the information you

701
00:21:04,559 --> 00:21:05,679
know what you know but you don't know

702
00:21:05,679 --> 00:21:07,200
some of the things that that are not in

703
00:21:07,200 --> 00:21:08,480
front of you and that's where

704
00:21:08,480 --> 00:21:10,159
hiding those are discovering those blind

705
00:21:10,159 --> 00:21:14,000
spots becomes more important

706
00:21:14,000 --> 00:21:16,080
so filling in the gaps i know this is a

707
00:21:16,080 --> 00:21:17,200
busy graphic but

708
00:21:17,200 --> 00:21:19,039
uh kind of walk through it here so in

709
00:21:19,039 --> 00:21:20,240
the last one we had

710
00:21:20,240 --> 00:21:21,919
what we had already observed what we've

711
00:21:21,919 --> 00:21:24,000
already seen and we've we've captured

712
00:21:24,000 --> 00:21:25,919
that we know that information

713
00:21:25,919 --> 00:21:27,600
so the way to fill in the gaps of the

714
00:21:27,600 --> 00:21:28,960
unknown information

715
00:21:28,960 --> 00:21:32,240
is with your standard red team analysis

716
00:21:32,240 --> 00:21:33,840
looking at what could happen

717
00:21:33,840 --> 00:21:35,919
uh community sharing is a big one so

718
00:21:35,919 --> 00:21:36,960
talking to your peers

719
00:21:36,960 --> 00:21:38,880
other people in the same vertical as

720
00:21:38,880 --> 00:21:40,480
your company figuring out what they've

721
00:21:40,480 --> 00:21:40,880
seen

722
00:21:40,880 --> 00:21:43,120
that could potentially overlap and

723
00:21:43,120 --> 00:21:45,760
understanding and sharing information

724
00:21:45,760 --> 00:21:47,840
a lot of times i work with a lot of

725
00:21:47,840 --> 00:21:49,600
different you know energy vertical

726
00:21:49,600 --> 00:21:50,720
financial vertical they all have

727
00:21:50,720 --> 00:21:51,200
different

728
00:21:51,200 --> 00:21:53,360
specific to their segment communities

729
00:21:53,360 --> 00:21:55,600
and once you put in you get out

730
00:21:55,600 --> 00:21:57,280
and then of course collection of data

731
00:21:57,280 --> 00:21:58,640
hunting in general

732
00:21:58,640 --> 00:22:00,960
um gut feeling is actually a part of

733
00:22:00,960 --> 00:22:01,919
that um

734
00:22:01,919 --> 00:22:04,080
and then there's the different threat

735
00:22:04,080 --> 00:22:05,840
feeds so you've got bad threat feeds

736
00:22:05,840 --> 00:22:06,400
which

737
00:22:06,400 --> 00:22:07,840
you don't there's no point in bothering

738
00:22:07,840 --> 00:22:09,200
with that it doesn't overlap with any of

739
00:22:09,200 --> 00:22:10,720
your organizational data if it's a bad

740
00:22:10,720 --> 00:22:11,760
threat feed that's that's what that

741
00:22:11,760 --> 00:22:12,080
means

742
00:22:12,080 --> 00:22:13,919
it doesn't have any relevancy to you but

743
00:22:13,919 --> 00:22:15,760
even in the good threat feed information

744
00:22:15,760 --> 00:22:17,679
now the subscription services that tell

745
00:22:17,679 --> 00:22:19,280
you all these cves and everything that

746
00:22:19,280 --> 00:22:20,799
that's potentially

747
00:22:20,799 --> 00:22:22,960
hitting the networks right now you can

748
00:22:22,960 --> 00:22:24,400
still eliminate a lot of that that has

749
00:22:24,400 --> 00:22:25,840
no relevancy to you things that don't

750
00:22:25,840 --> 00:22:27,280
matter to your network that

751
00:22:27,280 --> 00:22:29,440
you shouldn't waste time looking at so

752
00:22:29,440 --> 00:22:30,880
you wipe those out you've got a narrowed

753
00:22:30,880 --> 00:22:31,360
focus

754
00:22:31,360 --> 00:22:33,760
and just a few small gaps so you take

755
00:22:33,760 --> 00:22:34,960
that knowledge

756
00:22:34,960 --> 00:22:36,960
of the that knowledge of your unknowns

757
00:22:36,960 --> 00:22:40,159
down quite a bit

758
00:22:40,159 --> 00:22:42,080
um and so then we want to look at the

759
00:22:42,080 --> 00:22:43,840
data it's the data itself

760
00:22:43,840 --> 00:22:45,919
that that you're trying to protect you

761
00:22:45,919 --> 00:22:47,840
have your organization's data

762
00:22:47,840 --> 00:22:49,679
and then data that is sensitive to your

763
00:22:49,679 --> 00:22:51,600
organization often those are

764
00:22:51,600 --> 00:22:53,280
those are two separate things so you

765
00:22:53,280 --> 00:22:54,559
don't want the bad guys getting any of

766
00:22:54,559 --> 00:22:55,919
it but but you want to start with the

767
00:22:55,919 --> 00:22:58,080
sensitive stuff

768
00:22:58,080 --> 00:22:59,520
so then there's the data that the threat

769
00:22:59,520 --> 00:23:01,600
actors are after

770
00:23:01,600 --> 00:23:03,440
usually it looks you know similar like

771
00:23:03,440 --> 00:23:04,880
this you'll have a small segment of

772
00:23:04,880 --> 00:23:06,799
organizational data that is not as

773
00:23:06,799 --> 00:23:07,840
sensitive that they're going to get

774
00:23:07,840 --> 00:23:09,120
regardless trying to get to that

775
00:23:09,120 --> 00:23:10,480
sensitive data

776
00:23:10,480 --> 00:23:12,159
but where you want to start is is

777
00:23:12,159 --> 00:23:14,080
protecting that sensitive stuff that

778
00:23:14,080 --> 00:23:17,360
you know the threat actors are after

779
00:23:18,000 --> 00:23:20,640
often the most sensitive stuff would be

780
00:23:20,640 --> 00:23:22,159
the trade secrets and customer data

781
00:23:22,159 --> 00:23:23,440
that's usually what has

782
00:23:23,440 --> 00:23:26,080
monetary value or ransomware value uh

783
00:23:26,080 --> 00:23:27,120
the most valuable

784
00:23:27,120 --> 00:23:28,799
data is often what the threat actors are

785
00:23:28,799 --> 00:23:30,960
after um and then stuff that that falls

786
00:23:30,960 --> 00:23:31,840
into that uh

787
00:23:31,840 --> 00:23:33,600
that white space you know like account

788
00:23:33,600 --> 00:23:35,039
names passwords network addresses they

789
00:23:35,039 --> 00:23:36,640
can use that to get to the sensitive

790
00:23:36,640 --> 00:23:37,840
data sometimes but

791
00:23:37,840 --> 00:23:39,679
not always and then when it falls

792
00:23:39,679 --> 00:23:41,600
outside of the organizational data

793
00:23:41,600 --> 00:23:44,159
the the larger part of that circle um

794
00:23:44,159 --> 00:23:45,279
that's old data

795
00:23:45,279 --> 00:23:47,039
usually that you could just delete so if

796
00:23:47,039 --> 00:23:48,400
you wipe that out delete it get rid of

797
00:23:48,400 --> 00:23:49,760
it things that that

798
00:23:49,760 --> 00:23:51,520
are still in your network that are not

799
00:23:51,520 --> 00:23:52,960
necessary for your business

800
00:23:52,960 --> 00:23:54,640
um that takes away a lot of the scope

801
00:23:54,640 --> 00:23:56,000
that you have to focus on

802
00:23:56,000 --> 00:23:57,840
um you can also often use that for honey

803
00:23:57,840 --> 00:23:59,600
pots so you can build you know a segment

804
00:23:59,600 --> 00:24:00,559
of the network

805
00:24:00,559 --> 00:24:02,559
where it attack tracks the threat actors

806
00:24:02,559 --> 00:24:03,440
to and they think they're getting

807
00:24:03,440 --> 00:24:05,840
somewhere

808
00:24:06,480 --> 00:24:07,919
so cutting out that information you

809
00:24:07,919 --> 00:24:10,480
don't need narrows down the scope quite

810
00:24:10,480 --> 00:24:11,440
a bit

811
00:24:11,440 --> 00:24:14,320
taking out just the sensitive data gives

812
00:24:14,320 --> 00:24:14,720
you a

813
00:24:14,720 --> 00:24:17,120
much smaller sliver to work with so now

814
00:24:17,120 --> 00:24:18,080
we'll focus on that

815
00:24:18,080 --> 00:24:20,960
for starting our hunt this is an area

816
00:24:20,960 --> 00:24:22,559
where we know that we

817
00:24:22,559 --> 00:24:25,360
are vulnerable potentially that's where

818
00:24:25,360 --> 00:24:26,240
the threat actors

819
00:24:26,240 --> 00:24:27,919
are targeting that's what they can reach

820
00:24:27,919 --> 00:24:30,840
so that's where we want to start our

821
00:24:30,840 --> 00:24:32,320
hunt

822
00:24:32,320 --> 00:24:34,799
now overlay that with vulnerabilities so

823
00:24:34,799 --> 00:24:36,400
we have our unknown vulnerabilities

824
00:24:36,400 --> 00:24:38,480
and our cbes things that have been

825
00:24:38,480 --> 00:24:39,919
caught and picked up on before

826
00:24:39,919 --> 00:24:41,600
so we've got to narrow this scope down

827
00:24:41,600 --> 00:24:42,960
now so

828
00:24:42,960 --> 00:24:46,159
with your cves you've got what was

829
00:24:46,159 --> 00:24:48,159
discovered by the red team there's known

830
00:24:48,159 --> 00:24:50,080
and unknown there

831
00:24:50,080 --> 00:24:51,679
good pen testing obviously can find a

832
00:24:51,679 --> 00:24:54,799
lot of those automation

833
00:24:54,799 --> 00:24:56,559
both good and bad you have good bad pen

834
00:24:56,559 --> 00:24:58,080
tests as well that's what we're cutting

835
00:24:58,080 --> 00:24:59,600
off out of this circle

836
00:24:59,600 --> 00:25:03,039
and then adversary reported reported

837
00:25:03,039 --> 00:25:05,039
information on you know direct web stuff

838
00:25:05,039 --> 00:25:06,240
like uh

839
00:25:06,240 --> 00:25:07,679
dark reading that you would find some of

840
00:25:07,679 --> 00:25:09,279
those cves and and

841
00:25:09,279 --> 00:25:12,080
exploits for those

842
00:25:12,559 --> 00:25:14,559
so that shaves down our known or

843
00:25:14,559 --> 00:25:15,840
actually increases our known

844
00:25:15,840 --> 00:25:16,720
vulnerabilities

845
00:25:16,720 --> 00:25:17,840
and shaves down our unknown

846
00:25:17,840 --> 00:25:20,559
vulnerabilities

847
00:25:22,799 --> 00:25:25,919
so we want to overlay that and what

848
00:25:25,919 --> 00:25:27,200
we're using here is

849
00:25:27,200 --> 00:25:30,720
a mathematical union is everything

850
00:25:30,720 --> 00:25:32,159
and we're actually one of looking at

851
00:25:32,159 --> 00:25:33,840
want to look at the intersection just

852
00:25:33,840 --> 00:25:35,760
the data that overlaps

853
00:25:35,760 --> 00:25:38,400
so putting our targeted data over the

854
00:25:38,400 --> 00:25:39,520
sensitive

855
00:25:39,520 --> 00:25:42,799
data brings down the sliver even further

856
00:25:42,799 --> 00:25:44,400
so we've got a much smaller segment that

857
00:25:44,400 --> 00:25:45,840
we're working with now once we figured

858
00:25:45,840 --> 00:25:47,600
out the vulnerabilities patched them

859
00:25:47,600 --> 00:25:49,600
gotten them out of the way and now we

860
00:25:49,600 --> 00:25:51,200
can focus on

861
00:25:51,200 --> 00:25:55,840
what's still unknown

862
00:25:55,840 --> 00:25:58,320
now we look at uh known capabilities and

863
00:25:58,320 --> 00:26:00,559
methods that we've already collected

864
00:26:00,559 --> 00:26:03,120
so these are the the things that the

865
00:26:03,120 --> 00:26:04,480
threat actors are using

866
00:26:04,480 --> 00:26:06,960
um overlay that with our unknown segment

867
00:26:06,960 --> 00:26:08,159
of the network to take that

868
00:26:08,159 --> 00:26:09,760
chunk down even further so we have a

869
00:26:09,760 --> 00:26:13,360
much smaller segment of unknown data

870
00:26:13,360 --> 00:26:14,720
maybe where we need to start looking at

871
00:26:14,720 --> 00:26:16,080
logging and things like that in this

872
00:26:16,080 --> 00:26:17,440
particular environment and that's where

873
00:26:17,440 --> 00:26:20,720
our hunting is going to be focused

874
00:26:21,039 --> 00:26:23,200
and that's where we we come back around

875
00:26:23,200 --> 00:26:25,120
to looking at the tools usually

876
00:26:25,120 --> 00:26:27,679
the tools of configuring logging

877
00:26:27,679 --> 00:26:29,039
configuring the devices

878
00:26:29,039 --> 00:26:31,360
um to talk on the right networks to be

879
00:26:31,360 --> 00:26:32,640
able to access them

880
00:26:32,640 --> 00:26:35,200
updating os is that sort of thing so all

881
00:26:35,200 --> 00:26:36,240
of the perimeter

882
00:26:36,240 --> 00:26:38,320
internal network uh database hosts

883
00:26:38,320 --> 00:26:39,679
applications that's that's what we're

884
00:26:39,679 --> 00:26:40,480
going to focus on

885
00:26:40,480 --> 00:26:41,919
for understanding in that unknown

886
00:26:41,919 --> 00:26:43,600
network what do we have there that we're

887
00:26:43,600 --> 00:26:46,720
that we're not monitoring today

888
00:26:46,720 --> 00:26:49,279
um and this is obviously the tools uh

889
00:26:49,279 --> 00:26:50,480
ngt

890
00:26:50,480 --> 00:26:52,000
uh we're talking about the next great

891
00:26:52,000 --> 00:26:53,760
thing so whatever whatever comes next

892
00:26:53,760 --> 00:26:54,400
after

893
00:26:54,400 --> 00:26:57,679
sim dlp antivirus

894
00:26:57,679 --> 00:26:59,440
that's that's basically the the stuff

895
00:26:59,440 --> 00:27:00,799
we're going to focus on for this

896
00:27:00,799 --> 00:27:03,360
information

897
00:27:04,159 --> 00:27:07,200
so now overlaying our detectability

898
00:27:07,200 --> 00:27:10,000
what we know we can capture what's

899
00:27:10,000 --> 00:27:11,919
visible in the network so what we can

900
00:27:11,919 --> 00:27:12,640
see

901
00:27:12,640 --> 00:27:13,919
not only what we can see but then what

902
00:27:13,919 --> 00:27:16,480
we can detect on top of what we can see

903
00:27:16,480 --> 00:27:18,399
overlay that with the vulnerable portion

904
00:27:18,399 --> 00:27:19,760
of the network that

905
00:27:19,760 --> 00:27:21,120
we know the threat actors are trying to

906
00:27:21,120 --> 00:27:23,279
get to takes us down

907
00:27:23,279 --> 00:27:26,880
to the smallest sliver and we can see

908
00:27:26,880 --> 00:27:28,880
where we have no visibility which is

909
00:27:28,880 --> 00:27:31,840
where you're going to start your hunt

910
00:27:31,840 --> 00:27:34,000
highlighted in red is anything you can't

911
00:27:34,000 --> 00:27:35,039
you can't see

912
00:27:35,039 --> 00:27:36,240
you're not getting logs you're not

913
00:27:36,240 --> 00:27:38,559
getting detectability um

914
00:27:38,559 --> 00:27:39,919
we have we have we're blind to that

915
00:27:39,919 --> 00:27:41,919
section that's obviously where you need

916
00:27:41,919 --> 00:27:43,279
to start your hunt because that's where

917
00:27:43,279 --> 00:27:44,480
you're most vulnerable

918
00:27:44,480 --> 00:27:47,520
and usually hunting enables detection

919
00:27:47,520 --> 00:27:49,360
so you know starting to look at those

920
00:27:49,360 --> 00:27:51,440
systems you're not only seeing what this

921
00:27:51,440 --> 00:27:52,720
current state is

922
00:27:52,720 --> 00:27:54,799
but you're observing why it's not

923
00:27:54,799 --> 00:27:56,399
detectable or why it's not

924
00:27:56,399 --> 00:27:59,520
visible and that hunt process alone can

925
00:27:59,520 --> 00:28:00,159
help you

926
00:28:00,159 --> 00:28:01,679
resolve some of these missing components

927
00:28:01,679 --> 00:28:03,679
in your network um so starting the hunt

928
00:28:03,679 --> 00:28:04,320
there

929
00:28:04,320 --> 00:28:06,159
and as well as in the where you can't

930
00:28:06,159 --> 00:28:08,399
detect anything about the network

931
00:28:08,399 --> 00:28:10,000
is critical to understanding you know

932
00:28:10,000 --> 00:28:11,360
whether there's a threat actor there yet

933
00:28:11,360 --> 00:28:12,000
or not

934
00:28:12,000 --> 00:28:14,840
um there very well could be in the near

935
00:28:14,840 --> 00:28:17,840
future

936
00:28:19,360 --> 00:28:21,039
thank you i am rick again i'm rick

937
00:28:21,039 --> 00:28:22,720
rutledge with polarity senior security

938
00:28:22,720 --> 00:28:23,600
engineer

939
00:28:23,600 --> 00:28:28,799
and enjoy the rest of the show

