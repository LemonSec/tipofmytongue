1
00:00:03,810 --> 00:00:08,500
okay my name is Pete I work at

2
00:00:06,700 --> 00:00:10,629
Connecticut a senior soybean choose an

3
00:00:08,500 --> 00:00:12,339
analyst I've been in this role for about

4
00:00:10,629 --> 00:00:15,428
two years

5
00:00:12,339 --> 00:00:15,789
just to note my views and opinions on my

6
00:00:15,429 --> 00:00:19,480
own

7
00:00:15,789 --> 00:00:23,860
and don't necessarily represent those my

8
00:00:19,480 --> 00:00:25,540
employer so my data what do I do

9
00:00:23,860 --> 00:00:28,960
got a number of roles and

10
00:00:25,540 --> 00:00:31,630
responsibilities so I'm a leading a team

11
00:00:28,960 --> 00:00:34,929
of analysts my primary responsibilities

12
00:00:31,630 --> 00:00:37,289
are analysis into our job incidents and

13
00:00:34,929 --> 00:00:40,570
escalating those to our clients

14
00:00:37,289 --> 00:00:43,620
capability development so disagree view

15
00:00:40,570 --> 00:00:47,980
in our colon detection capabilities

16
00:00:43,620 --> 00:00:51,578
identify any gaps in our lured him and

17
00:00:47,980 --> 00:00:53,379
then hunting these to mitigate these and

18
00:00:51,579 --> 00:00:55,749
the key thing is the adversity

19
00:00:53,379 --> 00:00:58,870
techniques so this is developing

20
00:00:55,749 --> 00:01:02,289
awareness of the TTP's what about guys

21
00:00:58,870 --> 00:01:04,378
doing out there how will they exploit

22
00:01:02,289 --> 00:01:09,610
vulnerabilities bypass our detection

23
00:01:04,379 --> 00:01:11,430
methods and so on the final thing is the

24
00:01:09,610 --> 00:01:13,899
important part is to joining the mentor

25
00:01:11,430 --> 00:01:16,630
so I spend a lot of time with the

26
00:01:13,899 --> 00:01:18,880
journalists especially junior guys doing

27
00:01:16,630 --> 00:01:21,070
one to one meant to him so this could be

28
00:01:18,880 --> 00:01:25,048
anything for how to use the tools that

29
00:01:21,070 --> 00:01:28,419
we are or doing towards analysis etc

30
00:01:25,049 --> 00:01:29,079
doing assessments or they maintain and

31
00:01:28,420 --> 00:01:32,229
our awareness

32
00:01:29,079 --> 00:01:36,908
I believe bit on the career path so on

33
00:01:32,229 --> 00:01:40,570
and also one even CTF exercises so

34
00:01:36,909 --> 00:01:44,640
that's a good measure but that's being

35
00:01:40,570 --> 00:01:47,770
replaced by 24/7 lab access systems now

36
00:01:44,640 --> 00:01:52,840
so I work in a sock that's provided in

37
00:01:47,770 --> 00:01:55,060
24/7 security monitor so we were a money

38
00:01:52,840 --> 00:01:56,560
security service provider so we have a

39
00:01:55,060 --> 00:01:59,499
number of external clients that we

40
00:01:56,560 --> 00:02:02,560
monitor it's very much a frontline

41
00:01:59,499 --> 00:02:04,899
operations environment so we are dealing

42
00:02:02,560 --> 00:02:07,689
with real incidents and it can be quite

43
00:02:04,899 --> 00:02:10,240
visualize especially limit about a lot

44
00:02:07,689 --> 00:02:14,099
of clients instance happening or do we

45
00:02:10,240 --> 00:02:14,099
prioritize those instincts etc

46
00:02:15,129 --> 00:02:22,159
so there's been a lot of interest in the

47
00:02:17,599 --> 00:02:25,700
motor top matrix in the past year over

48
00:02:22,159 --> 00:02:28,548
to especially what it is out to adopt is

49
00:02:25,700 --> 00:02:31,099
pathway hon Tim used for validation etc

50
00:02:28,549 --> 00:02:32,930
and he seemed lots of mention of it in

51
00:02:31,099 --> 00:02:35,238
the previous slides and the

52
00:02:32,930 --> 00:02:37,430
presentations so I'm going to be

53
00:02:35,239 --> 00:02:42,049
covering the motor atop matrix from a

54
00:02:37,430 --> 00:02:46,549
more practical aspect I refused what my

55
00:02:42,049 --> 00:02:50,120
experience is of it more specifically on

56
00:02:46,549 --> 00:02:52,940
Windows host I was using the system on

57
00:02:50,120 --> 00:02:54,879
configuration and I would not to use up

58
00:02:52,940 --> 00:02:58,569
or as part of security monitoring

59
00:02:54,879 --> 00:03:01,548
service so the reason for adopting

60
00:02:58,569 --> 00:03:04,369
system on the attack matrix really was

61
00:03:01,549 --> 00:03:07,549
to use the available features within

62
00:03:04,370 --> 00:03:12,290
Windows without actually introducing new

63
00:03:07,549 --> 00:03:17,569
technology and we just wanted to come

64
00:03:12,290 --> 00:03:19,099
over 16 implementation so the previous

65
00:03:17,569 --> 00:03:21,048
presentation covered a lot about the

66
00:03:19,099 --> 00:03:23,869
attack matrix principles and what it is

67
00:03:21,049 --> 00:03:26,930
the origins of it etc so I'm not going

68
00:03:23,870 --> 00:03:28,699
to cover too much in detail but I will

69
00:03:26,930 --> 00:03:32,810
provide some context of how we've used

70
00:03:28,699 --> 00:03:35,750
them well I was interested to know but

71
00:03:32,810 --> 00:03:38,569
Before we jump into the top matrix only

72
00:03:35,750 --> 00:03:40,310
six month come back I'm going to go back

73
00:03:38,569 --> 00:03:43,728
to basics just say why do we need

74
00:03:40,310 --> 00:03:45,590
monitoring the need for it and some of

75
00:03:43,729 --> 00:03:46,909
the challenges that we face especially

76
00:03:45,590 --> 00:03:49,909
from a security analyst point of view

77
00:03:46,909 --> 00:03:52,220
and then I'll move on to the top matrix

78
00:03:49,909 --> 00:03:56,060
that will cover the deployment us vets

79
00:03:52,220 --> 00:03:58,310
and the focus a bit more on sis for some

80
00:03:56,060 --> 00:04:00,979
use cases that I've used to validator

81
00:03:58,310 --> 00:04:03,379
and then finally I'll cover the lessons

82
00:04:00,979 --> 00:04:04,459
identified and the opportunities and

83
00:04:03,379 --> 00:04:10,340
we're going to take this in the future

84
00:04:04,459 --> 00:04:14,180
so secluded to monitor doing intrusion

85
00:04:10,340 --> 00:04:16,250
analysis instant response they all have

86
00:04:14,180 --> 00:04:21,650
a need to capture or understand up to

87
00:04:16,250 --> 00:04:23,659
indigent IT systems so going back to

88
00:04:21,649 --> 00:04:25,789
absolute basics why do we need to

89
00:04:23,659 --> 00:04:27,110
monitor our systems what virtual we're

90
00:04:25,789 --> 00:04:31,349
looking for etcetera

91
00:04:27,110 --> 00:04:34,350
so in this case yeah Bob Joyce you like

92
00:04:31,350 --> 00:04:36,930
the tailored access organization spot at

93
00:04:34,350 --> 00:04:39,720
the NSA his team responsible for

94
00:04:36,930 --> 00:04:42,510
advanced exploitation of IT systems gave

95
00:04:39,720 --> 00:04:44,970
over presentation the news next enigma

96
00:04:42,510 --> 00:04:47,360
conference a few years ago and is this

97
00:04:44,970 --> 00:04:50,270
basically given her an education to

98
00:04:47,360 --> 00:04:52,410
computers professionals and academics

99
00:04:50,270 --> 00:04:54,750
about how to keep people like him and

100
00:04:52,410 --> 00:04:57,570
his tea and other that acted out of a

101
00:04:54,750 --> 00:05:01,950
system so one of the key statements

102
00:04:57,570 --> 00:05:03,810
caught my eye was a bundle ID so is

103
00:05:01,950 --> 00:05:05,849
basically that there is a system

104
00:05:03,810 --> 00:05:08,880
administrator what she looks at unlocks

105
00:05:05,850 --> 00:05:10,620
understand what they mean understand how

106
00:05:08,880 --> 00:05:14,070
it applies to the context their system

107
00:05:10,620 --> 00:05:16,040
so at the end of the day an IT system is

108
00:05:14,070 --> 00:05:19,020
providing some function or service

109
00:05:16,040 --> 00:05:24,410
we don't deploy a IOT system for fun of

110
00:05:19,020 --> 00:05:27,180
it so we've heard all of the CRA

111
00:05:24,410 --> 00:05:29,370
competency confidentiality integrity and

112
00:05:27,180 --> 00:05:33,120
availability so a system administrator

113
00:05:29,370 --> 00:05:35,040
or a network defender she'll be able to

114
00:05:33,120 --> 00:05:38,810
look at the locks be able to determine

115
00:05:35,040 --> 00:05:38,810
what impact it's having on any of those

116
00:05:39,680 --> 00:05:46,710
so if you stop that nopony's important

117
00:05:42,390 --> 00:05:48,240
but what do we lock so my why Jake is a

118
00:05:46,710 --> 00:05:51,260
sons instructor and he voiced his

119
00:05:48,240 --> 00:05:52,530
recommendation for Windows blogging I

120
00:05:51,260 --> 00:05:55,979
agree

121
00:05:52,530 --> 00:05:57,570
look what you come storagee cheap well

122
00:05:55,979 --> 00:06:00,270
there's a cost with everything and I

123
00:05:57,570 --> 00:06:02,060
think it was highlighted earlier on but

124
00:06:00,270 --> 00:06:04,320
the cuffs come B if you lock everything

125
00:06:02,060 --> 00:06:07,160
yeah he's probably stop clogging on the

126
00:06:04,320 --> 00:06:10,979
network bandwidth what I stole his cheap

127
00:06:07,160 --> 00:06:13,410
but once he stopped up to and archiving

128
00:06:10,979 --> 00:06:15,390
backups and then all your processing and

129
00:06:13,410 --> 00:06:16,770
overheads in terms of processing update

130
00:06:15,390 --> 00:06:21,840
to the managing out and pause you know

131
00:06:16,770 --> 00:06:24,090
that starts becoming quite costly and it

132
00:06:21,840 --> 00:06:25,530
it could impact the end-user experience

133
00:06:24,090 --> 00:06:29,969
as well as the capturing team was lock

134
00:06:25,530 --> 00:06:31,559
data from the employ so quite often from

135
00:06:29,970 --> 00:06:33,979
my experience system administrators

136
00:06:31,560 --> 00:06:36,510
don't configured a lock sources properly

137
00:06:33,979 --> 00:06:38,520
and they don't provide the Colet locks

138
00:06:36,510 --> 00:06:40,080
so for example I provide the locks for

139
00:06:38,520 --> 00:06:43,438
the test environment or not

140
00:06:40,080 --> 00:06:46,139
environment and then we end up getting

141
00:06:43,439 --> 00:06:48,960
blind spots on the network so from a

142
00:06:46,139 --> 00:06:50,610
network defend the point of view if you

143
00:06:48,960 --> 00:06:53,099
cut too much locks you could end up

144
00:06:50,610 --> 00:06:55,530
tossing you seem by overwhelming it

145
00:06:53,099 --> 00:06:57,780
locks and then the Corsa seems to earth

146
00:06:55,530 --> 00:07:02,549
to capture then I lose easy near

147
00:06:57,780 --> 00:07:04,979
real-time capability so you can mitigate

148
00:07:02,550 --> 00:07:08,009
this somewhat by tuning the endpoints

149
00:07:04,979 --> 00:07:09,360
what locks you collect him and to get

150
00:07:08,009 --> 00:07:11,610
the right balance between a collecting

151
00:07:09,360 --> 00:07:15,690
light level of locks to support an

152
00:07:11,610 --> 00:07:17,280
instant response but there are a lot of

153
00:07:15,690 --> 00:07:18,930
factors when it comes into play by

154
00:07:17,280 --> 00:07:22,409
monitoring environments especially when

155
00:07:18,930 --> 00:07:28,710
dealing with disconnected users poor

156
00:07:22,409 --> 00:07:30,409
comms etc so we need to log events about

157
00:07:28,710 --> 00:07:33,479
our to get the balance right

158
00:07:30,409 --> 00:07:36,090
so we lock in the relevant items so

159
00:07:33,479 --> 00:07:37,979
analyst or system administrator go back

160
00:07:36,090 --> 00:07:40,438
to him and we play and understand what's

161
00:07:37,979 --> 00:07:42,090
being captured the number of frameworks

162
00:07:40,439 --> 00:07:45,560
out there that define a critical

163
00:07:42,090 --> 00:07:48,479
security controls such as Sun stop 20

164
00:07:45,560 --> 00:07:51,180
there's some lucky control ships good

165
00:07:48,479 --> 00:07:53,669
practice guide number 13 I provided

166
00:07:51,180 --> 00:07:55,440
guidance on what I went to capture and

167
00:07:53,669 --> 00:07:57,810
you can use that to check your local

168
00:07:55,440 --> 00:08:00,539
sources to make sure you he kept in our

169
00:07:57,810 --> 00:08:03,270
events but sometimes frameworks on

170
00:08:00,539 --> 00:08:05,610
enough sometimes the vendors of the

171
00:08:03,270 --> 00:08:08,580
appliances don't log all the activity

172
00:08:05,610 --> 00:08:10,500
that you need to capture so you ever

173
00:08:08,580 --> 00:08:14,339
think out the box and explore the data

174
00:08:10,500 --> 00:08:17,250
sources and other issue system

175
00:08:14,339 --> 00:08:19,889
administrators they use default locking

176
00:08:17,250 --> 00:08:21,419
policy just stay out of the box and that

177
00:08:19,889 --> 00:08:24,349
might not capture all the events that

178
00:08:21,419 --> 00:08:27,299
you need to capture there is some help

179
00:08:24,349 --> 00:08:30,779
the NCRC have provided a really helpful

180
00:08:27,300 --> 00:08:32,610
resource called locking made easy it's a

181
00:08:30,779 --> 00:08:35,549
set up based on configuration profiles

182
00:08:32,610 --> 00:08:38,690
for windows systems that provide

183
00:08:35,549 --> 00:08:41,130
recommended GPOs system on comfy etc

184
00:08:38,690 --> 00:08:43,640
there's a presentation about this later

185
00:08:41,130 --> 00:08:46,140
on today I recommend you attending that

186
00:08:43,640 --> 00:08:51,750
so I'm going to be focused on the my to

187
00:08:46,140 --> 00:08:53,819
atop matrix on sis month so so I thought

188
00:08:51,750 --> 00:08:55,530
about security monitor weekly walk

189
00:08:53,820 --> 00:08:58,440
while you might need it and the

190
00:08:55,530 --> 00:09:00,300
approaches to lock him so I'm now going

191
00:08:58,440 --> 00:09:01,590
to be talking about wildlife monitoring

192
00:09:00,300 --> 00:09:04,589
and discuss what we're trying to achieve

193
00:09:01,590 --> 00:09:06,030
using their top matrix and then I could

194
00:09:04,590 --> 00:09:11,790
be incorporated a part of a monitoring

195
00:09:06,030 --> 00:09:14,720
solution so so much of our enterprise

196
00:09:11,790 --> 00:09:17,099
now is becoming more interconnected so

197
00:09:14,720 --> 00:09:20,880
we've seen traditional activities such

198
00:09:17,100 --> 00:09:23,190
as using on-premises email all the way

199
00:09:20,880 --> 00:09:25,320
up to uses during system administration

200
00:09:23,190 --> 00:09:29,910
and so on but a boundaries change them

201
00:09:25,320 --> 00:09:33,300
the third party external services cloud

202
00:09:29,910 --> 00:09:35,370
based stuff is such a compliance checks

203
00:09:33,300 --> 00:09:38,849
order the checks are becoming more

204
00:09:35,370 --> 00:09:40,230
evident but for the security analysts my

205
00:09:38,850 --> 00:09:42,330
war anniversary behavior is getting

206
00:09:40,230 --> 00:09:44,970
harder to detect especially if they

207
00:09:42,330 --> 00:09:47,610
leverage multiple techniques as part of

208
00:09:44,970 --> 00:09:49,680
an interesting escalation were finding

209
00:09:47,610 --> 00:09:52,020
that the client operational security

210
00:09:49,680 --> 00:09:54,180
team the system that we monitor are

211
00:09:52,020 --> 00:09:55,860
demanding more contextual information

212
00:09:54,180 --> 00:09:58,349
about the incident

213
00:09:55,860 --> 00:10:02,340
how did the attack occur what is the

214
00:09:58,350 --> 00:10:04,680
likely impact etc so a good security

215
00:10:02,340 --> 00:10:06,900
analyst in my opinion should we maintain

216
00:10:04,680 --> 00:10:07,500
an awareness or threat adversary'

217
00:10:06,900 --> 00:10:12,600
tactics

218
00:10:07,500 --> 00:10:14,340
this will help no good from bad the

219
00:10:12,600 --> 00:10:17,550
example know what window speeches look

220
00:10:14,340 --> 00:10:20,280
like legitimate use of those features so

221
00:10:17,550 --> 00:10:26,640
is PowerShell base64 encoding good

222
00:10:20,280 --> 00:10:28,949
behavior so the parameter pane I always

223
00:10:26,640 --> 00:10:30,360
refer to this in a space when I'm

224
00:10:28,950 --> 00:10:33,090
discussing with this clear analyst

225
00:10:30,360 --> 00:10:36,750
mother should be aiming for so there's a

226
00:10:33,090 --> 00:10:38,400
lot of emphasis on IO sees we've

227
00:10:36,750 --> 00:10:39,150
mentioned earlier on IOC can be

228
00:10:38,400 --> 00:10:42,000
discarded

229
00:10:39,150 --> 00:10:44,220
entire infrastructure of evil software

230
00:10:42,000 --> 00:10:47,220
components we developed it's expensive

231
00:10:44,220 --> 00:10:49,020
for the adversary what is doable what is

232
00:10:47,220 --> 00:10:51,690
hard is we create in a TTP's

233
00:10:49,020 --> 00:10:55,640
this is effectively the trade club early

234
00:10:51,690 --> 00:10:58,260
adversity operates changing this

235
00:10:55,640 --> 00:11:01,319
requires significant investment and new

236
00:10:58,260 --> 00:11:03,870
skills new approaches to attacks so this

237
00:11:01,320 --> 00:11:06,000
is effectively rebuild in a new team we

238
00:11:03,870 --> 00:11:07,230
put potentially new people and new skill

239
00:11:06,000 --> 00:11:09,490
sets

240
00:11:07,230 --> 00:11:13,030
well this is where someone like my to

241
00:11:09,490 --> 00:11:16,210
attack matrix comes into play after

242
00:11:13,030 --> 00:11:18,819
she's focused at the TTP level so to

243
00:11:16,210 --> 00:11:20,680
understand TTP's ideally threat

244
00:11:18,820 --> 00:11:23,800
intelligence force support this

245
00:11:20,680 --> 00:11:25,540
knowledge but as highlighted earlier on

246
00:11:23,800 --> 00:11:27,790
and what I'm gonna say is up at the

247
00:11:25,540 --> 00:11:31,209
moment T are of course very heavily

248
00:11:27,790 --> 00:11:32,680
focused on IOC s we are getting more

249
00:11:31,210 --> 00:11:37,210
context around those I have seized a

250
00:11:32,680 --> 00:11:38,770
bursary to operate and etc oh another

251
00:11:37,210 --> 00:11:41,320
reason why I'm not getting the full

252
00:11:38,770 --> 00:11:43,270
detail is so they could beat up the

253
00:11:41,320 --> 00:11:44,770
evidence wasn't captured it's probably

254
00:11:43,270 --> 00:11:47,410
incident or it not locked or not

255
00:11:44,770 --> 00:11:50,199
observed or it could be have certain

256
00:11:47,410 --> 00:11:56,920
information being will help of this

257
00:11:50,200 --> 00:11:59,380
ongoing investigations etc so simply

258
00:11:56,920 --> 00:12:01,439
focusing on Windows endpoints just

259
00:11:59,380 --> 00:12:04,270
looking at a clean build of Windows tab

260
00:12:01,440 --> 00:12:06,790
32-bit version we can see from this

261
00:12:04,270 --> 00:12:10,990
illustration of a lot of yep seized

262
00:12:06,790 --> 00:12:14,130
dealers and a few calm files and this

263
00:12:10,990 --> 00:12:16,870
doesn't include the Program Files folder

264
00:12:14,130 --> 00:12:19,270
or there are the custom installed

265
00:12:16,870 --> 00:12:19,990
applications so why am i bringing this

266
00:12:19,270 --> 00:12:21,880
up

267
00:12:19,990 --> 00:12:24,340
so following the first few point of view

268
00:12:21,880 --> 00:12:26,110
why build tools when you can use living

269
00:12:24,340 --> 00:12:29,280
offline techniques or exploit the

270
00:12:26,110 --> 00:12:32,140
windows features on the operating system

271
00:12:29,280 --> 00:12:34,329
what the fundamental question is if

272
00:12:32,140 --> 00:12:37,240
we've got all of these components are we

273
00:12:34,330 --> 00:12:39,730
got Windows host on our network where do

274
00:12:37,240 --> 00:12:42,610
we focus our attention where do I fly or

275
00:12:39,730 --> 00:12:44,950
Ataris everything we do what techniques

276
00:12:42,610 --> 00:12:51,160
do is focus on and how do we do this in

277
00:12:44,950 --> 00:12:54,490
a consistent manner so the previous

278
00:12:51,160 --> 00:12:56,410
presentation titled the Mott to top

279
00:12:54,490 --> 00:12:58,570
plane weapon for hunting

280
00:12:56,410 --> 00:12:59,829
gave an excellent introduction to this

281
00:12:58,570 --> 00:13:03,400
and it covered a lot about

282
00:12:59,830 --> 00:13:05,800
prioritization so just quickly go

283
00:13:03,400 --> 00:13:06,400
through the sort of micro type matrix

284
00:13:05,800 --> 00:13:07,959
being

285
00:13:06,400 --> 00:13:10,959
gaining popularity in the last year or

286
00:13:07,960 --> 00:13:13,450
so but it came to my attention at least

287
00:13:10,960 --> 00:13:15,700
18 months ago probably a bit longer and

288
00:13:13,450 --> 00:13:18,770
I've been using this for a variety of

289
00:13:15,700 --> 00:13:22,220
purposes so point number one

290
00:13:18,770 --> 00:13:25,730
as a learning resource so to develop

291
00:13:22,220 --> 00:13:27,470
situational awareness of very TTP's it

292
00:13:25,730 --> 00:13:31,760
was a good point of reference

293
00:13:27,470 --> 00:13:35,540
well doc you made against a PT's number

294
00:13:31,760 --> 00:13:40,010
two Emily in university we generally

295
00:13:35,540 --> 00:13:41,540
some of those techniques he says love to

296
00:13:40,010 --> 00:13:43,339
gain insight what gets generated in

297
00:13:41,540 --> 00:13:45,680
locked files what gets generated on the

298
00:13:43,339 --> 00:13:47,570
host and that's really useful for

299
00:13:45,680 --> 00:13:50,329
validating detection especially if God

300
00:13:47,570 --> 00:13:52,730
exists in controls in place and then

301
00:13:50,330 --> 00:13:55,430
number three was a testing vendor

302
00:13:52,730 --> 00:13:57,649
solutions so then Jesus story tinkle

303
00:13:55,430 --> 00:14:01,729
fittingly my turret up major that matrix

304
00:13:57,649 --> 00:14:04,220
or the profiles etc so we flipped out

305
00:14:01,730 --> 00:14:05,779
and started phones to fire him so it's a

306
00:14:04,220 --> 00:14:07,750
good way to do a little bit of

307
00:14:05,779 --> 00:14:10,700
validation to understand the coverage

308
00:14:07,750 --> 00:14:14,540
well going back to the pyramid of pain

309
00:14:10,700 --> 00:14:18,080
the atop framework of eyes focus on a

310
00:14:14,540 --> 00:14:19,640
very tasty piece so he made himself the

311
00:14:18,080 --> 00:14:22,339
really good reference and it's been

312
00:14:19,640 --> 00:14:26,600
continually updated with new TTP's and

313
00:14:22,339 --> 00:14:27,829
references so talked about what the

314
00:14:26,600 --> 00:14:28,490
challenges are and what we're trying to

315
00:14:27,829 --> 00:14:30,859
achieve

316
00:14:28,490 --> 00:14:36,560
well how do we use the atop matrix in a

317
00:14:30,860 --> 00:14:39,890
way of detecting adversary's behavior so

318
00:14:36,560 --> 00:14:41,569
I used sis mom for the time being so

319
00:14:39,890 --> 00:14:43,520
this is part of the system turnoff suite

320
00:14:41,570 --> 00:14:46,010
developed by my person of its from

321
00:14:43,520 --> 00:14:48,589
Microsoft so I need this some of that

322
00:14:46,010 --> 00:14:51,560
was a fairly non intrusive or quiet

323
00:14:48,589 --> 00:14:53,450
increase readability up the endpoint so

324
00:14:51,560 --> 00:14:59,209
I had someone say why not just deploy

325
00:14:53,450 --> 00:15:02,839
Edie armed so because we're animus SP we

326
00:14:59,209 --> 00:15:05,329
don't necessarily have the ability to

327
00:15:02,839 --> 00:15:07,579
interrogate networks

328
00:15:05,329 --> 00:15:10,339
sort of be disheartened a receiver and

329
00:15:07,579 --> 00:15:11,510
if there is reason for that so different

330
00:15:10,339 --> 00:15:14,050
kinds of different infrastructure

331
00:15:11,510 --> 00:15:16,520
several different requirements and so on

332
00:15:14,050 --> 00:15:19,010
well I was a sis mom

333
00:15:16,520 --> 00:15:22,220
aegeon decreased Windows events and

334
00:15:19,010 --> 00:15:23,990
using the resistant lock sources so we

335
00:15:22,220 --> 00:15:26,149
can integrate this using a get extra

336
00:15:23,990 --> 00:15:27,440
lock source without too much for the

337
00:15:26,149 --> 00:15:31,579
configuration a lot of monitoring

338
00:15:27,440 --> 00:15:32,360
solutions the other motivation is some

339
00:15:31,579 --> 00:15:34,310
Microsoft developed

340
00:15:32,360 --> 00:15:36,829
software component they actually

341
00:15:34,310 --> 00:15:43,310
maintained new features being outdated

342
00:15:36,829 --> 00:15:45,709
said to her so I recently I've been

343
00:15:43,310 --> 00:15:49,489
using system on version 9 but last year

344
00:15:45,709 --> 00:15:51,949
I was using version 8 that was a game

345
00:15:49,490 --> 00:15:54,470
changer in my view because some of the

346
00:15:51,950 --> 00:15:56,450
features are did was the ability to

347
00:15:54,470 --> 00:15:57,709
configure tax to specific observed

348
00:15:56,450 --> 00:16:01,160
events

349
00:15:57,709 --> 00:16:02,899
so before system version 8 I was trying

350
00:16:01,160 --> 00:16:05,120
to find the best method of mapping

351
00:16:02,899 --> 00:16:08,089
system on events to the top matrix

352
00:16:05,120 --> 00:16:10,399
techniques so one method with creating

353
00:16:08,089 --> 00:16:12,200
the muffins in the seam but I thought

354
00:16:10,399 --> 00:16:14,420
this was a long approach it was kind of

355
00:16:12,200 --> 00:16:17,360
doing at the top and once all the locks

356
00:16:14,420 --> 00:16:19,849
are coming but in my view I think the

357
00:16:17,360 --> 00:16:22,790
lock event should be classified a close

358
00:16:19,850 --> 00:16:25,279
as possible to the lock sauce the other

359
00:16:22,790 --> 00:16:28,849
issue the seams of a lot of person who

360
00:16:25,279 --> 00:16:30,800
was any way to process in tag locks so

361
00:16:28,850 --> 00:16:34,610
this would introduce in it all ahead on

362
00:16:30,800 --> 00:16:38,060
closed system the looks and it could

363
00:16:34,610 --> 00:16:40,519
impact the performance of him so for

364
00:16:38,060 --> 00:16:43,969
example an audit lots of Windows Cisco

365
00:16:40,519 --> 00:16:45,829
snore ideas locks and so on when events

366
00:16:43,970 --> 00:16:49,370
get locked in there this is like a

367
00:16:45,829 --> 00:16:53,239
vendor ID or a splitter so on to

368
00:16:49,370 --> 00:16:55,699
indicate what that event is so that's

369
00:16:53,240 --> 00:16:57,860
why I was trying to achieve so so once

370
00:16:55,699 --> 00:17:00,229
this one version 8 came out I started

371
00:16:57,860 --> 00:17:03,769
using the Swift on security system on

372
00:17:00,230 --> 00:17:06,160
comput to start tagging events but then

373
00:17:03,769 --> 00:17:10,970
someone else had the same idea with me

374
00:17:06,160 --> 00:17:14,660
so Chuck corresponding system on config

375
00:17:10,970 --> 00:17:17,240
file but expanded this using the tax

376
00:17:14,660 --> 00:17:17,870
feature so I used this at the basis of

377
00:17:17,240 --> 00:17:21,079
myself

378
00:17:17,869 --> 00:17:24,589
sorry Kristen modest in a little bit so

379
00:17:21,079 --> 00:17:27,379
you can see the use of tax sir probably

380
00:17:24,589 --> 00:17:29,059
bought a condition put a match there are

381
00:17:27,380 --> 00:17:31,460
a number of configuration parameters and

382
00:17:29,059 --> 00:17:33,918
system oh sorry

383
00:17:31,460 --> 00:17:37,730
using parent calling process the image

384
00:17:33,919 --> 00:17:42,679
name looking at registry keys etc you

385
00:17:37,730 --> 00:17:45,650
can exclude items as well so they affect

386
00:17:42,679 --> 00:17:48,320
the option filter for this e good

387
00:17:45,650 --> 00:17:52,480
filter noise of SAP applications and so

388
00:17:48,320 --> 00:17:56,110
on but I copy other apps by safe I mean

389
00:17:52,480 --> 00:17:58,400
these applications such as anti viruses

390
00:17:56,110 --> 00:17:59,629
suffocation just naturally generate a

391
00:17:58,400 --> 00:18:01,880
lot of noise especially if they're up

392
00:17:59,630 --> 00:18:04,730
data or what you don't want to be doing

393
00:18:01,880 --> 00:18:07,700
is excluding safe applications that

394
00:18:04,730 --> 00:18:10,370
could be used legitimately or so it's a

395
00:18:07,700 --> 00:18:12,470
technique so it could be pop up a living

396
00:18:10,370 --> 00:18:16,159
off the lantern a so you need to be

397
00:18:12,470 --> 00:18:18,740
careful I did up a customized

398
00:18:16,160 --> 00:18:21,470
configuration but we use third-party

399
00:18:18,740 --> 00:18:24,430
components at different IVs lab

400
00:18:21,470 --> 00:18:24,430
forwarders and so on

401
00:18:25,090 --> 00:18:31,100
so this is a Pronovias not familiar with

402
00:18:28,910 --> 00:18:34,670
system on this is what this one of them

403
00:18:31,100 --> 00:18:37,760
looks like what this is got the attack

404
00:18:34,670 --> 00:18:41,240
nature's clumping applied so when event

405
00:18:37,760 --> 00:18:44,810
comes in get sub-zero products this

406
00:18:41,240 --> 00:18:47,510
month a gem and it gets dumped into the

407
00:18:44,810 --> 00:18:49,190
Windows Event log so if you look in the

408
00:18:47,510 --> 00:18:51,650
Windows Event Viewer that's what you see

409
00:18:49,190 --> 00:18:53,390
on the left and so you can see the

410
00:18:51,650 --> 00:18:56,690
example there they split that with

411
00:18:53,390 --> 00:19:00,650
what's been told it is the system user

412
00:18:56,690 --> 00:19:04,220
discovery rule and they come online in

413
00:19:00,650 --> 00:19:07,190
correlates to the system info THC so

414
00:19:04,220 --> 00:19:09,320
that's free this is a application built

415
00:19:07,190 --> 00:19:12,230
in Windows that grabs the system

416
00:19:09,320 --> 00:19:16,600
information such a build on the detailed

417
00:19:12,230 --> 00:19:19,070
hardware configuration IP addresses etc

418
00:19:16,600 --> 00:19:21,800
that techniques been a mapped gonna see

419
00:19:19,070 --> 00:19:25,429
at up matrix web page on the bottom

420
00:19:21,800 --> 00:19:28,330
right so you can get order interesting

421
00:19:25,430 --> 00:19:34,630
logically if she's well it's this moment

422
00:19:28,330 --> 00:19:37,250
but it's useful to do that map him so

423
00:19:34,630 --> 00:19:39,380
but how did it look like from a locking

424
00:19:37,250 --> 00:19:42,170
perspective so you can see on the bottom

425
00:19:39,380 --> 00:19:43,610
line so that's of all of them so it

426
00:19:42,170 --> 00:19:45,950
looks quite different what you see in

427
00:19:43,610 --> 00:19:53,870
the windows event so you get XML tags

428
00:19:45,950 --> 00:19:56,090
set them so the scene will use only a

429
00:19:53,870 --> 00:19:59,178
doubt box party moves just for plain

430
00:19:56,090 --> 00:20:03,320
vanilla Sh'ma what I want you to use

431
00:19:59,179 --> 00:20:04,669
for the top matrixyl features so it

432
00:20:03,320 --> 00:20:08,869
starting out the rules then I could

433
00:20:04,669 --> 00:20:13,489
exploit them so I have to generate my

434
00:20:08,869 --> 00:20:16,129
own father effectively so you can see on

435
00:20:13,489 --> 00:20:19,249
the top screen you can see the first one

436
00:20:16,129 --> 00:20:22,789
of em it's pass now classified than the

437
00:20:19,249 --> 00:20:25,429
key attributes get put into a special

438
00:20:22,789 --> 00:20:27,320
event field so it's from a correlation

439
00:20:25,429 --> 00:20:29,659
point of view we can then start to

440
00:20:27,320 --> 00:20:32,809
correlate the hashes they can be used

441
00:20:29,659 --> 00:20:36,769
against intelligence feeds because start

442
00:20:32,809 --> 00:20:38,450
basically IOC Marco but then we can

443
00:20:36,769 --> 00:20:40,399
start build more complex rules by

444
00:20:38,450 --> 00:20:42,950
looking for sequences events are part of

445
00:20:40,399 --> 00:20:47,689
a wider TTP's and I look and is

446
00:20:42,950 --> 00:20:50,539
dangerous activity so there is another

447
00:20:47,690 --> 00:20:52,039
limitation that you might face it's just

448
00:20:50,539 --> 00:20:55,879
one of them you captured so much

449
00:20:52,039 --> 00:20:57,710
information in your tools might be

450
00:20:55,879 --> 00:21:01,668
limited and much information you can

451
00:20:57,710 --> 00:21:04,879
exploit so you so much me aware of are

452
00:21:01,669 --> 00:21:07,429
you based your correlation on now the

453
00:21:04,879 --> 00:21:11,089
classification itself is usually seen

454
00:21:07,429 --> 00:21:13,580
specific so most Poor's warlock events

455
00:21:11,089 --> 00:21:16,279
into a classification that you can use

456
00:21:13,580 --> 00:21:20,059
our acquired a correlation so in this

457
00:21:16,279 --> 00:21:22,279
case so did a number utilities and

458
00:21:20,059 --> 00:21:26,239
applications up wicket where they've

459
00:21:22,279 --> 00:21:27,589
been classified post a service stop what

460
00:21:26,239 --> 00:21:34,580
the actual rule name

461
00:21:27,589 --> 00:21:37,549
the ideally you can see it there so just

462
00:21:34,580 --> 00:21:40,279
to recap this money is installed on the

463
00:21:37,549 --> 00:21:43,580
windows house and this is installed as a

464
00:21:40,279 --> 00:21:46,639
driver than as a service load it was up

465
00:21:43,580 --> 00:21:48,799
configuration file was such a event for

466
00:21:46,639 --> 00:21:52,369
not interested or interested Indonesia

467
00:21:48,799 --> 00:21:54,200
classify then the event took up to this

468
00:21:52,369 --> 00:21:56,799
part of the windows lock file and he's

469
00:21:54,200 --> 00:21:59,029
afforded to a centralized lock server

470
00:21:56,799 --> 00:22:03,229
along with all the other locks from all

471
00:21:59,029 --> 00:22:06,289
the other hosts and usually in typical

472
00:22:03,229 --> 00:22:09,079
security monitoring cell you have an

473
00:22:06,289 --> 00:22:11,280
agent or look folded on there that were

474
00:22:09,079 --> 00:22:14,700
forwarded on to

475
00:22:11,280 --> 00:22:16,799
see where it was all the obligation and

476
00:22:14,700 --> 00:22:23,850
pushes another layer of the locks than

477
00:22:16,799 --> 00:22:27,840
the sea we'll post those as well so if

478
00:22:23,850 --> 00:22:29,610
man event doesn't match a configuration

479
00:22:27,840 --> 00:22:33,720
technique that's been programmed in a

480
00:22:29,610 --> 00:22:35,100
config then we classify little cut tool

481
00:22:33,720 --> 00:22:38,940
so you can see here in the bottom lap

482
00:22:35,100 --> 00:22:40,559
he's no map him so could be various

483
00:22:38,940 --> 00:22:42,299
reason for them it could be hard it's a

484
00:22:40,559 --> 00:22:44,908
new application installed on there

485
00:22:42,299 --> 00:22:47,010
probably news or it could be a new

486
00:22:44,909 --> 00:22:50,010
feature what's been added to Windows so

487
00:22:47,010 --> 00:22:53,070
in service packs update there's always

488
00:22:50,010 --> 00:22:54,870
new applications being added so this is

489
00:22:53,070 --> 00:22:57,570
uncle dick get pass or a general

490
00:22:54,870 --> 00:23:00,090
catch-all so the key thing to look out

491
00:22:57,570 --> 00:23:02,100
for for my absolute my own point of view

492
00:23:00,090 --> 00:23:04,889
to look out for a lot of these cuts all

493
00:23:02,100 --> 00:23:06,629
events my advice would be set up like an

494
00:23:04,890 --> 00:23:08,460
alarm so if you start getting too many

495
00:23:06,630 --> 00:23:11,909
so there's probably the features being

496
00:23:08,460 --> 00:23:14,429
used or in this case is because system

497
00:23:11,909 --> 00:23:18,240
is deployed on a host are sitting server

498
00:23:14,429 --> 00:23:20,900
was installed on the sequel agent exe

499
00:23:18,240 --> 00:23:24,900
and didn't feature in the config file

500
00:23:20,900 --> 00:23:26,730
it's a event number 18 in system on iris

501
00:23:24,900 --> 00:23:30,480
plate to a pipe connected from a client

502
00:23:26,730 --> 00:23:34,169
to the server or analysis of the

503
00:23:30,480 --> 00:23:36,179
application it is legit so it got white

504
00:23:34,169 --> 00:23:41,549
listed and effectively excluded in the

505
00:23:36,179 --> 00:23:44,309
config file but this is she usually

506
00:23:41,549 --> 00:23:47,760
standard onboarding tuning activity you

507
00:23:44,309 --> 00:23:50,820
do lock sources you do that with any

508
00:23:47,760 --> 00:23:52,650
type not to sis mom you start getting a

509
00:23:50,820 --> 00:23:55,200
bunch they don't match and then they get

510
00:23:52,650 --> 00:23:57,299
caught by perhaps all it could be issues

511
00:23:55,200 --> 00:24:00,000
authorities as well and then you start

512
00:23:57,299 --> 00:24:03,679
looking for key attributes and start

513
00:24:00,000 --> 00:24:03,679
understanding the context so I'll know

514
00:24:04,159 --> 00:24:10,409
so the key resources that are used for

515
00:24:06,900 --> 00:24:12,799
deployment sis mom was a card era so

516
00:24:10,409 --> 00:24:16,789
doctor tool that I first came across

517
00:24:12,799 --> 00:24:19,379
early last year it's now on version 2

518
00:24:16,789 --> 00:24:20,940
it's a recent belief and so it's

519
00:24:19,380 --> 00:24:21,710
developed by the same team

520
00:24:20,940 --> 00:24:25,790
paying over

521
00:24:21,710 --> 00:24:28,390
my to attack matrix the development team

522
00:24:25,790 --> 00:24:31,220
has significantly changed the platform

523
00:24:28,390 --> 00:24:33,530
I'm using the first release I'm

524
00:24:31,220 --> 00:24:37,520
migrating to version 2 that came out to

525
00:24:33,530 --> 00:24:40,700
solve a month ago the atomic the canary

526
00:24:37,520 --> 00:24:42,260
get off he could speak quite a number of

527
00:24:40,700 --> 00:24:46,850
techniques as well which is in addition

528
00:24:42,260 --> 00:24:49,370
to the attack matrix flame work is long

529
00:24:46,850 --> 00:24:51,649
and it's good for validating a system on

530
00:24:49,370 --> 00:24:56,300
can pick correlation rules it said to

531
00:24:51,650 --> 00:24:56,840
him so how was my cell configured for

532
00:24:56,300 --> 00:25:00,190
all of this

533
00:24:56,840 --> 00:25:03,379
so a standalone environment for research

534
00:25:00,190 --> 00:25:05,540
so this was a lab environment was

535
00:25:03,380 --> 00:25:07,730
composed of windows server multiple

536
00:25:05,540 --> 00:25:11,450
windows clients such as version 710

537
00:25:07,730 --> 00:25:14,290
32-bit 64-bit etcetera I didn't focus on

538
00:25:11,450 --> 00:25:16,850
specific build versions or and allow

539
00:25:14,290 --> 00:25:18,770
what the environment was purely used for

540
00:25:16,850 --> 00:25:20,689
experimental and concept and development

541
00:25:18,770 --> 00:25:22,840
so his Excel environment for winning

542
00:25:20,690 --> 00:25:25,130
card era on against his lab liam's I

543
00:25:22,840 --> 00:25:27,320
didn't obviously set up in that

544
00:25:25,130 --> 00:25:30,530
environment but we didn't make use of

545
00:25:27,320 --> 00:25:32,510
secure Union to special ID up stop to

546
00:25:30,530 --> 00:25:35,560
correlate the airlocks and do a basic

547
00:25:32,510 --> 00:25:38,090
search and correlational year events I

548
00:25:35,560 --> 00:25:42,770
had a separate test investment

549
00:25:38,090 --> 00:25:44,629
environment that I'd to see mono so if

550
00:25:42,770 --> 00:25:46,520
representative of fields of production

551
00:25:44,630 --> 00:25:49,310
environment and so on well it didn't

552
00:25:46,520 --> 00:25:52,639
occur to installed on that so that

553
00:25:49,310 --> 00:25:53,919
environment spying or deploying testing

554
00:25:52,640 --> 00:25:56,750
a system on configuration

555
00:25:53,920 --> 00:26:00,500
be able to undertake some very basic

556
00:25:56,750 --> 00:26:01,460
level validation or the TTP's there's

557
00:26:00,500 --> 00:26:02,360
something he's living off the land

558
00:26:01,460 --> 00:26:04,370
techniques

559
00:26:02,360 --> 00:26:07,510
but what I couldn't do it was deploy any

560
00:26:04,370 --> 00:26:09,409
malware or do any destructive techniques

561
00:26:07,510 --> 00:26:12,170
that would have to take place on the

562
00:26:09,410 --> 00:26:14,450
research environment the production

563
00:26:12,170 --> 00:26:17,990
environment we focus on with a client

564
00:26:14,450 --> 00:26:21,140
monitor the state ok clean to enhance

565
00:26:17,990 --> 00:26:23,720
the monitor not so he deploys system on

566
00:26:21,140 --> 00:26:26,120
an hour config on this environment why I

567
00:26:23,720 --> 00:26:29,150
only did that on a very small scale to

568
00:26:26,120 --> 00:26:32,090
start with as part of a pilot and we

569
00:26:29,150 --> 00:26:35,050
focused on some critical assets so these

570
00:26:32,090 --> 00:26:39,639
were jump boxes

571
00:26:35,050 --> 00:26:41,620
it was kind of ourselves so what was

572
00:26:39,640 --> 00:26:44,050
part not pilot I'm just

573
00:26:41,620 --> 00:26:45,969
she already interested in getting

574
00:26:44,050 --> 00:26:48,030
feedback from the system administrators

575
00:26:45,970 --> 00:26:51,040
from people who use those assets

576
00:26:48,030 --> 00:26:53,560
performance and also to understand the

577
00:26:51,040 --> 00:26:54,310
login into the seam so going back to my

578
00:26:53,560 --> 00:26:55,960
earlier point

579
00:26:54,310 --> 00:26:57,970
oh I don't wanna do it suppose this

580
00:26:55,960 --> 00:27:00,160
month everywhere I start getting thirty

581
00:26:57,970 --> 00:27:02,080
which system on events I wanted to get a

582
00:27:00,160 --> 00:27:04,060
feel for I was like to put you know on

583
00:27:02,080 --> 00:27:06,669
some production house different types

584
00:27:04,060 --> 00:27:13,000
then see if I needed to know and he

585
00:27:06,670 --> 00:27:15,010
knows it said to him there was some

586
00:27:13,000 --> 00:27:16,960
limitations like the research lab and

587
00:27:15,010 --> 00:27:21,040
intestine and reference didn't have any

588
00:27:16,960 --> 00:27:23,110
part of life capability so very much the

589
00:27:21,040 --> 00:27:26,050
analyst gentleman in the event looking

590
00:27:23,110 --> 00:27:28,899
in there looks similar cleared it wasn't

591
00:27:26,050 --> 00:27:35,350
really stress testing the config or

592
00:27:28,900 --> 00:27:38,110
validating any correlation rules there

593
00:27:35,350 --> 00:27:40,810
was a fourth environment that was cell

594
00:27:38,110 --> 00:27:43,689
or a honeypot and that was just very

595
00:27:40,810 --> 00:27:46,320
very short period and that was pretty

596
00:27:43,690 --> 00:27:49,360
Morrison Windows host cell with RDP

597
00:27:46,320 --> 00:27:52,409
exposed and I was running sis mom and I

598
00:27:49,360 --> 00:27:56,260
were just interested in see how that was

599
00:27:52,410 --> 00:27:58,720
being used in the wild so to speak just

600
00:27:56,260 --> 00:27:59,890
if you understand what type of people

601
00:27:58,720 --> 00:28:06,040
were using them and what they were

602
00:27:59,890 --> 00:28:11,140
trying to do on the host so generally

603
00:28:06,040 --> 00:28:13,629
this one is lightweight however you feel

604
00:28:11,140 --> 00:28:16,990
a really poor comp it or you're welcome

605
00:28:13,630 --> 00:28:18,520
extensively for certain activities or a

606
00:28:16,990 --> 00:28:20,830
ferocious extremely busy

607
00:28:18,520 --> 00:28:24,310
it can make system on one hop a little

608
00:28:20,830 --> 00:28:26,350
bit I've only ever had one instance of

609
00:28:24,310 --> 00:28:30,100
this is on one host and notice these

610
00:28:26,350 --> 00:28:33,280
they've some CPU spike attuned to come

611
00:28:30,100 --> 00:28:35,250
pick I reduced the need for confusing or

612
00:28:33,280 --> 00:28:37,960
the hush face and just focus on sha-1

613
00:28:35,250 --> 00:28:44,290
but apart from that no other history did

614
00:28:37,960 --> 00:28:46,540
any other host so I've talked about what

615
00:28:44,290 --> 00:28:47,440
system on is really what the attack

616
00:28:46,540 --> 00:28:49,990
matrix

617
00:28:47,440 --> 00:28:53,200
the configuration and deployment a

618
00:28:49,990 --> 00:28:55,900
little bit about the same integration so

619
00:28:53,200 --> 00:28:58,150
I'm not going to cover the validation on

620
00:28:55,900 --> 00:29:02,500
someone events get alerted some of the

621
00:28:58,150 --> 00:29:06,940
blind spots on some real-world usage so

622
00:29:02,500 --> 00:29:09,940
so back 18 months ago a bit longer

623
00:29:06,940 --> 00:29:11,470
started with caldera so the first tool

624
00:29:09,940 --> 00:29:15,549
that I used in conjunction with the

625
00:29:11,470 --> 00:29:17,679
attack matrix and so I'd literally

626
00:29:15,549 --> 00:29:19,600
deployed this on research lab and very

627
00:29:17,679 --> 00:29:21,790
much running our again some windows

628
00:29:19,600 --> 00:29:24,159
theorems and just educating your list

629
00:29:21,790 --> 00:29:27,370
these are types of techniques the sepal

630
00:29:24,160 --> 00:29:30,040
gets generated and so on this is a very

631
00:29:27,370 --> 00:29:31,750
basic example so the blue dot

632
00:29:30,040 --> 00:29:34,629
I'm since screen just shows one host

633
00:29:31,750 --> 00:29:36,669
that's represented by a blue circle so

634
00:29:34,630 --> 00:29:39,490
that's a Windows host and I was a car

635
00:29:36,669 --> 00:29:42,730
dealer agent installed then the caldera

636
00:29:39,490 --> 00:29:44,710
server interacts with this agent to

637
00:29:42,730 --> 00:29:48,700
invoke various options so the screen

638
00:29:44,710 --> 00:29:50,770
started to server and when you run an

639
00:29:48,700 --> 00:29:54,070
operation it mimics the adversity

640
00:29:50,770 --> 00:29:57,730
behavior such as a human operator or any

641
00:29:54,070 --> 00:30:00,850
automated activity so Cardo is deployed

642
00:29:57,730 --> 00:30:02,410
on a research lab Sorority documentation

643
00:30:00,850 --> 00:30:04,659
says that it can be deployed on a

644
00:30:02,410 --> 00:30:07,960
production environment because it's got

645
00:30:04,660 --> 00:30:11,710
like an auto clean-up ability this

646
00:30:07,960 --> 00:30:14,860
particular release shipped with mimic up

647
00:30:11,710 --> 00:30:18,220
so mimicked artists credential dump him

648
00:30:14,860 --> 00:30:19,389
I wouldn't deploy on a production

649
00:30:18,220 --> 00:30:23,040
environment because I would probably

650
00:30:19,390 --> 00:30:30,700
trigger you're just a navy or the census

651
00:30:23,040 --> 00:30:33,360
there he could so just want him out of

652
00:30:30,700 --> 00:30:35,679
the box of history using code area

653
00:30:33,360 --> 00:30:39,668
standard outer box windows no

654
00:30:35,679 --> 00:30:45,580
configuration not them if you fire one

655
00:30:39,669 --> 00:30:48,010
of a cutter network operations it's all

656
00:30:45,580 --> 00:30:50,949
done in two minutes and they the number

657
00:30:48,010 --> 00:30:52,419
of activities that happen you can see

658
00:30:50,950 --> 00:30:54,929
farmer screenshots if look at the

659
00:30:52,419 --> 00:30:57,220
applications clearly insist on locks

660
00:30:54,929 --> 00:31:00,480
hardly anything gets generated and he

661
00:30:57,220 --> 00:31:00,480
might not even see any events

662
00:31:00,770 --> 00:31:08,190
so so within that two minutes of the act

663
00:31:04,580 --> 00:31:10,918
what was being mimicked it conducted

664
00:31:08,190 --> 00:31:14,309
host and Network survey and his don't

665
00:31:10,919 --> 00:31:16,380
credentials we're not ready see now if

666
00:31:14,309 --> 00:31:18,330
he did tweak the locking policies you

667
00:31:16,380 --> 00:31:22,650
see some well what you're never going to

668
00:31:18,330 --> 00:31:27,928
see everything the born on the bottom

669
00:31:22,650 --> 00:31:30,500
left system one is is called conflicts

670
00:31:27,929 --> 00:31:32,970
or what it does it which stops the agent

671
00:31:30,500 --> 00:31:36,240
which affects the UPS on behalf of

672
00:31:32,970 --> 00:31:38,730
cafeteria server in order to limit the

673
00:31:36,240 --> 00:31:41,250
options well if you look at the system

674
00:31:38,730 --> 00:31:47,370
on events you can see the more system on

675
00:31:41,250 --> 00:31:49,169
activity so if validating system on

676
00:31:47,370 --> 00:31:52,350
attack techniques in cardio is

677
00:31:49,169 --> 00:31:54,480
especially useful you can start to map

678
00:31:52,350 --> 00:31:57,659
events and your pollution details on the

679
00:31:54,480 --> 00:31:59,790
left with the system on event so you see

680
00:31:57,660 --> 00:32:01,290
in the windows event looks that issue

681
00:31:59,790 --> 00:32:03,480
starts a correlation between the

682
00:32:01,290 --> 00:32:05,399
activity and then you can start to do

683
00:32:03,480 --> 00:32:08,370
some tuning out as well if excessive

684
00:32:05,400 --> 00:32:10,559
noise so in the middle of screenshot you

685
00:32:08,370 --> 00:32:12,449
can see the system only uses discovery

686
00:32:10,559 --> 00:32:15,379
that I talked already about I use an

687
00:32:12,450 --> 00:32:17,280
assessment system on system info command

688
00:32:15,380 --> 00:32:19,799
then on the bottom right

689
00:32:17,280 --> 00:32:21,590
you've got the command line interface so

690
00:32:19,799 --> 00:32:23,850
that's quite an interesting

691
00:32:21,590 --> 00:32:27,149
classification there's been a marked

692
00:32:23,850 --> 00:32:31,860
rule name online interface but if you

693
00:32:27,150 --> 00:32:34,410
look at the come online interview you

694
00:32:31,860 --> 00:32:36,659
can see that is trying to scan

695
00:32:34,410 --> 00:32:40,169
directories for word password and the

696
00:32:36,660 --> 00:32:42,000
titles so yes you could create specific

697
00:32:40,169 --> 00:32:44,520
rules I'm look for that kind of thing

698
00:32:42,000 --> 00:32:48,270
but it is you in the command function to

699
00:32:44,520 --> 00:32:49,620
do that directory and if you do came up

700
00:32:48,270 --> 00:32:51,570
with specific always where to start on

701
00:32:49,620 --> 00:32:55,500
the line to start looking for people

702
00:32:51,570 --> 00:32:59,510
searching for users computer names

703
00:32:55,500 --> 00:33:02,760
different language terms they it's a lot

704
00:32:59,510 --> 00:33:04,830
but it's not 100% Maps or from a system

705
00:33:02,760 --> 00:33:07,610
analysts point of view the activity did

706
00:33:04,830 --> 00:33:07,610
look suspicious

707
00:33:11,429 --> 00:33:16,500
validations color is fine to a certain

708
00:33:13,860 --> 00:33:19,168
point there are some limitations for

709
00:33:16,500 --> 00:33:21,510
example no pattern of life then this

710
00:33:19,169 --> 00:33:23,669
picks TTP eventually we just run out

711
00:33:21,510 --> 00:33:26,850
against technique to test against and

712
00:33:23,669 --> 00:33:29,010
unless you start developing your own at

713
00:33:26,850 --> 00:33:32,570
that point I decided to throw it on you

714
00:33:29,010 --> 00:33:36,629
pop start was deliberately insecure so

715
00:33:32,570 --> 00:33:39,659
I'll be poor or TP certains I use a

716
00:33:36,630 --> 00:33:43,770
common account names very weak passwords

717
00:33:39,660 --> 00:33:49,830
etc and I use one own accounts are being

718
00:33:43,770 --> 00:33:51,418
used and so on and then from this view

719
00:33:49,830 --> 00:33:53,760
of a number of attempts and several

720
00:33:51,419 --> 00:33:56,130
compromises also it was quite good to

721
00:33:53,760 --> 00:33:58,860
see see some activity in a system on and

722
00:33:56,130 --> 00:34:03,090
the attack makes it full for them so the

723
00:33:58,860 --> 00:34:05,699
most common activity when hoster

724
00:34:03,090 --> 00:34:09,060
compromise and so on was the attempt to

725
00:34:05,700 --> 00:34:11,580
gain privilege escalation solos or just

726
00:34:09,060 --> 00:34:12,960
gotten all the accounts on the Box it

727
00:34:11,580 --> 00:34:14,460
kind of makes sense on why yes again

728
00:34:12,960 --> 00:34:17,159
there are hosts first thing you ought to

729
00:34:14,460 --> 00:34:21,179
do is get fitted escalation and two of

730
00:34:17,159 --> 00:34:23,280
things today we've attempts to dump

731
00:34:21,179 --> 00:34:24,899
innately local authority subsystem

732
00:34:23,280 --> 00:34:26,820
service getting stuff on memory and so

733
00:34:24,899 --> 00:34:30,000
on but then I saw a number of false

734
00:34:26,820 --> 00:34:34,050
positives switches SVC host interacting

735
00:34:30,000 --> 00:34:35,190
with the same place s so so you need

736
00:34:34,050 --> 00:34:37,320
little bit of tuning but it is useful

737
00:34:35,190 --> 00:34:41,609
then I still a lot of things such as a

738
00:34:37,320 --> 00:34:44,119
sailing up C theory tools so I thought

739
00:34:41,609 --> 00:34:47,129
oh gosh 10 8 oz sounds quite clever

740
00:34:44,119 --> 00:34:49,080
partly it was a event and I was

741
00:34:47,129 --> 00:34:51,509
Microsoft dependent downloading updates

742
00:34:49,080 --> 00:34:54,690
and then restart the ATM

743
00:34:51,510 --> 00:34:56,909
so again tuning opportunity or it could

744
00:34:54,690 --> 00:34:58,170
get me thinking and I really

745
00:34:56,909 --> 00:34:59,970
legit FM

746
00:34:58,170 --> 00:35:04,460
could anniversary do that kind of thing

747
00:34:59,970 --> 00:35:04,459
so that was a command used to the bottom

748
00:35:07,430 --> 00:35:14,220
not even one the honeypot for long

749
00:35:09,560 --> 00:35:17,070
because at the same time roughly the RDP

750
00:35:14,220 --> 00:35:19,470
vulnerability was disclosed so there was

751
00:35:17,070 --> 00:35:21,599
a lot of phone in cigar name

752
00:35:19,470 --> 00:35:24,480
everything happening so just shut it

753
00:35:21,599 --> 00:35:28,369
down or for sure awhile it was useful at

754
00:35:24,480 --> 00:35:30,390
the size larger some external validation

755
00:35:28,369 --> 00:35:33,690
interesting o'clock door the usernames

756
00:35:30,390 --> 00:35:37,940
and there's some interest in username

757
00:35:33,690 --> 00:35:42,329
between use such as Linda Debbie Tracy

758
00:35:37,940 --> 00:35:45,930
French version administrator and then I

759
00:35:42,329 --> 00:35:50,660
was some HVAC and other canister so it's

760
00:35:45,930 --> 00:35:53,069
quite interesting so queasy about so

761
00:35:50,660 --> 00:35:54,210
this is a tool that's been doing around

762
00:35:53,069 --> 00:35:58,890
for quite a while

763
00:35:54,210 --> 00:36:03,119
there is a he Lester Advisory squeeze on

764
00:35:58,890 --> 00:36:04,920
the top right it's a tool that's

765
00:36:03,119 --> 00:36:07,800
available on github and source code

766
00:36:04,920 --> 00:36:12,690
provided and it's a tool not been used

767
00:36:07,800 --> 00:36:15,180
by those a PT's so again I thought would

768
00:36:12,690 --> 00:36:17,790
be good opportunities test see how close

769
00:36:15,180 --> 00:36:21,750
of a person sis mom and I was classified

770
00:36:17,790 --> 00:36:24,960
identity tap matrix so we have a server

771
00:36:21,750 --> 00:36:29,310
at the top screen the axe is a

772
00:36:24,960 --> 00:36:31,380
controller for I've seen the mark said

773
00:36:29,310 --> 00:36:34,078
to the client and the client is a

774
00:36:31,380 --> 00:36:37,430
payload that connects to the server so

775
00:36:34,079 --> 00:36:39,839
the initial operation on the Left

776
00:36:37,430 --> 00:36:42,180
doesn't reveal anything exciting under

777
00:36:39,839 --> 00:36:45,119
that process started the event we've

778
00:36:42,180 --> 00:36:50,098
been eating that classified you can see

779
00:36:45,119 --> 00:36:53,369
the file name Exe so that established

780
00:36:50,099 --> 00:36:55,920
connection connect it to the server so

781
00:36:53,369 --> 00:37:00,450
in terms of the more access a number of

782
00:36:55,920 --> 00:37:03,300
things do so that step was let's grab

783
00:37:00,450 --> 00:37:05,578
some system information that he seemed

784
00:37:03,300 --> 00:37:10,890
to trigger any events at all squats

785
00:37:05,579 --> 00:37:13,530
poison Nam activity scene then they are

786
00:37:10,890 --> 00:37:15,810
thought alike before most shell that

787
00:37:13,530 --> 00:37:20,300
dick took an event and you can see the

788
00:37:15,810 --> 00:37:24,029
command access the technique name again

789
00:37:20,300 --> 00:37:25,410
the one process was invoked or

790
00:37:24,030 --> 00:37:28,230
interesting these and then I was

791
00:37:25,410 --> 00:37:31,618
followed by change code page utility

792
00:37:28,230 --> 00:37:35,519
that was invoked so doing a bit of

793
00:37:31,619 --> 00:37:38,700
malware analysis are confirmed that both

794
00:37:35,519 --> 00:37:41,538
of these commanders do get invoked by

795
00:37:38,700 --> 00:37:42,919
that feature so it's quite useful stop

796
00:37:41,539 --> 00:37:47,339
daisy-chaining

797
00:37:42,920 --> 00:37:50,609
events so what the the key thing is not

798
00:37:47,339 --> 00:37:53,160
succeed for a navy so good antivirus

799
00:37:50,609 --> 00:37:55,529
should just hope laser light being

800
00:37:53,160 --> 00:37:57,808
installed but like I said source codes

801
00:37:55,529 --> 00:38:01,410
out there people can download a tweak

802
00:37:57,809 --> 00:38:05,219
change features of the scaler and so on

803
00:38:01,410 --> 00:38:06,839
but if I still using the same techniques

804
00:38:05,219 --> 00:38:09,599
what's been employed in a core the

805
00:38:06,839 --> 00:38:11,569
closer these could be indicators by

806
00:38:09,599 --> 00:38:18,269
using the command and change code page

807
00:38:11,569 --> 00:38:22,460
events so I started looking at Windows

808
00:38:18,269 --> 00:38:26,609
Features windows subsystem for Linux so

809
00:38:22,460 --> 00:38:30,150
really good feature enables due to one

810
00:38:26,609 --> 00:38:31,890
Linux kernel within Windows sis mom

811
00:38:30,150 --> 00:38:34,140
didn't detect any activity related to

812
00:38:31,890 --> 00:38:36,210
that feature kind of makes sense is

813
00:38:34,140 --> 00:38:39,509
looking for windows binary when there's

814
00:38:36,210 --> 00:38:43,710
always related activity but it's a blind

815
00:38:39,509 --> 00:38:46,559
spot because it was features enable you

816
00:38:43,710 --> 00:38:49,079
can do a lot of the Linux type features

817
00:38:46,559 --> 00:38:51,989
such as IP compare I asked on pick and

818
00:38:49,079 --> 00:38:54,809
so on the always goofy and I just want

819
00:38:51,989 --> 00:39:01,049
trigger but the equivalent windows

820
00:38:54,809 --> 00:39:03,109
clones would that's one an individual

821
00:39:01,049 --> 00:39:06,269
going by the name is some boxes paper

822
00:39:03,109 --> 00:39:10,828
released several zero days back in May

823
00:39:06,269 --> 00:39:12,299
on get up in my opinion it should have

824
00:39:10,829 --> 00:39:16,289
been a bit more responsible disclosure

825
00:39:12,299 --> 00:39:19,130
on these well I just don't want it up or

826
00:39:16,289 --> 00:39:23,519
they deploy them

827
00:39:19,130 --> 00:39:26,190
so what interested me for my experience

828
00:39:23,519 --> 00:39:28,828
we have some clients who are monitoring

829
00:39:26,190 --> 00:39:31,799
requirements was like detecting zero day

830
00:39:28,829 --> 00:39:33,960
activity in my opinion I found I was

831
00:39:31,799 --> 00:39:35,489
kind of quite difficult to detect

832
00:39:33,960 --> 00:39:38,430
especially when he got an enterprise

833
00:39:35,489 --> 00:39:40,410
network but multitude of devices so it's

834
00:39:38,430 --> 00:39:43,919
not just about looking to 0 days on

835
00:39:40,410 --> 00:39:48,029
Windows so she could be future

836
00:39:43,920 --> 00:39:50,279
the backup device attempt them or

837
00:39:48,029 --> 00:39:53,549
interestingly the top meters is based on

838
00:39:50,279 --> 00:39:56,670
a classification of known TTP's so this

839
00:39:53,549 --> 00:39:58,700
is fairly unknown I'm looking for see

840
00:39:56,670 --> 00:40:00,750
how this match against the known TTP's

841
00:39:58,700 --> 00:40:03,019
it will be interesting to see how this

842
00:40:00,750 --> 00:40:06,450
configuration worked

843
00:40:03,019 --> 00:40:09,328
so just for all information flows not

844
00:40:06,450 --> 00:40:11,759
familiar the exploit can see scheduled

845
00:40:09,329 --> 00:40:14,579
tasks using a legacy Windows Java object

846
00:40:11,760 --> 00:40:17,250
and effectively promotes a non admin to

847
00:40:14,579 --> 00:40:22,260
a system level village sorry to look at

848
00:40:17,250 --> 00:40:26,099
this escalation executing a payload so

849
00:40:22,260 --> 00:40:28,819
is the pushiest crate on the left if you

850
00:40:26,099 --> 00:40:33,920
see the scheduled tasks being invoked

851
00:40:28,819 --> 00:40:37,500
and then finally see the job completed

852
00:40:33,920 --> 00:40:39,510
or not would the third step shows to

853
00:40:37,500 --> 00:40:41,160
come on line interface rule then you can

854
00:40:39,510 --> 00:40:43,769
see this script has been invoked again

855
00:40:41,160 --> 00:40:46,529
and the final thing you can see the top

856
00:40:43,769 --> 00:40:51,149
completed in step four and that would

857
00:40:46,529 --> 00:40:53,400
run the the user local TV escalation but

858
00:40:51,150 --> 00:40:54,930
it's not immediately clear what impact

859
00:40:53,400 --> 00:40:57,630
running our code is hat

860
00:40:54,930 --> 00:41:00,690
so you'd have to still call a against

861
00:40:57,630 --> 00:41:02,549
it'll lock sources well could see the

862
00:41:00,690 --> 00:41:06,029
two events come on

863
00:41:02,549 --> 00:41:08,099
interfaith a lot of activity should be

864
00:41:06,029 --> 00:41:10,079
enough to trigger but because a lot of

865
00:41:08,099 --> 00:41:12,990
these didn't get classified they would

866
00:41:10,079 --> 00:41:15,779
be affected clustered a catch-all

867
00:41:12,990 --> 00:41:16,979
you would have to go into that I know

868
00:41:15,779 --> 00:41:18,269
that kind of being someone that's

869
00:41:16,980 --> 00:41:19,380
pointing what happened if you discover

870
00:41:18,269 --> 00:41:22,339
all of these you've got a number of

871
00:41:19,380 --> 00:41:24,599
events were being classified to cut your

872
00:41:22,339 --> 00:41:27,058
promiscuity are listed should we start

873
00:41:24,599 --> 00:41:28,859
documenting up star understand him what

874
00:41:27,059 --> 00:41:31,019
come on that was why it was wrong what

875
00:41:28,859 --> 00:41:32,848
impact that did I have and then they

876
00:41:31,019 --> 00:41:36,720
could start developing their TTP's

877
00:41:32,849 --> 00:41:38,490
and and then to start dating a convict

878
00:41:36,720 --> 00:41:42,029
and then it starts maturing what your

879
00:41:38,490 --> 00:41:44,519
cost if I and in cm but the good thing

880
00:41:42,029 --> 00:41:47,400
is Microsoft as much discipline ability

881
00:41:44,519 --> 00:41:49,799
so you know an issue so much this

882
00:41:47,400 --> 00:41:53,720
exploit but still useful techniques to

883
00:41:49,799 --> 00:41:55,559
look out for so if I'm doing all of this

884
00:41:53,720 --> 00:41:57,700
working out the use of system are

885
00:41:55,559 --> 00:42:00,490
applying the top matrix to

886
00:41:57,700 --> 00:42:03,100
and doing some validation so what were

887
00:42:00,490 --> 00:42:04,930
the pitfalls correlate in events

888
00:42:03,100 --> 00:42:07,480
mr. challenge him I'm still something

889
00:42:04,930 --> 00:42:09,250
that will develop him and the main issue

890
00:42:07,480 --> 00:42:11,230
in maintaining balance anak took in too

891
00:42:09,250 --> 00:42:13,630
many false positives because a lot of

892
00:42:11,230 --> 00:42:18,010
these techniques use legitimate reason

893
00:42:13,630 --> 00:42:20,710
for it as well as a malicious youth so

894
00:42:18,010 --> 00:42:22,270
somebody we're not just using the real

895
00:42:20,710 --> 00:42:25,030
name but different if somebody have to

896
00:42:22,270 --> 00:42:26,980
believe seed well other forms of

897
00:42:25,030 --> 00:42:29,950
correlation is using nearly event

898
00:42:26,980 --> 00:42:34,440
classification slightly higher structure

899
00:42:29,950 --> 00:42:36,700
but it's doable the validation of the

900
00:42:34,440 --> 00:42:40,260
system on configuration done in quick

901
00:42:36,700 --> 00:42:43,089
succession so code area Krista Boehm

902
00:42:40,260 --> 00:42:45,160
within one or two minutes it generates

903
00:42:43,090 --> 00:42:47,980
all the adversity artifacts it done all

904
00:42:45,160 --> 00:42:49,720
the bad stuff in reality anniversary

905
00:42:47,980 --> 00:42:52,360
could be on the platform or the house or

906
00:42:49,720 --> 00:42:54,850
a lot longer they could do the initial

907
00:42:52,360 --> 00:42:57,430
compromised and maintain persistent then

908
00:42:54,850 --> 00:43:00,520
it could be days weeks months before

909
00:42:57,430 --> 00:43:04,690
start exploiting all the vulnerabilities

910
00:43:00,520 --> 00:43:07,360
do a lot of activity so it could be slow

911
00:43:04,690 --> 00:43:10,420
burn activity the other weaker is ti

912
00:43:07,360 --> 00:43:13,150
cardio as a number of build profiles for

913
00:43:10,420 --> 00:43:16,710
actors in behaviour started developer

914
00:43:13,150 --> 00:43:19,930
own but then the Evoque block the TI I

915
00:43:16,710 --> 00:43:22,150
just didn't quite it was enough TTP's in

916
00:43:19,930 --> 00:43:27,040
order to mature the techniques that

917
00:43:22,150 --> 00:43:29,950
we're trying to do so deploying system

918
00:43:27,040 --> 00:43:31,630
on using a tap matrix TTP's in a

919
00:43:29,950 --> 00:43:33,910
one-step process are they not being

920
00:43:31,630 --> 00:43:35,950
highlighted earlier on it needs to be a

921
00:43:33,910 --> 00:43:38,230
continuous with view of TTP's and

922
00:43:35,950 --> 00:43:42,279
developer correlation will review the TR

923
00:43:38,230 --> 00:43:44,160
I moved him from most TTP's so there are

924
00:43:42,280 --> 00:43:46,240
a lot of different attack vectors

925
00:43:44,160 --> 00:43:50,259
features been added to windows all the

926
00:43:46,240 --> 00:43:52,209
time and I attend shield up to new from

927
00:43:50,260 --> 00:43:54,880
the abilities and exploit so no

928
00:43:52,210 --> 00:43:57,970
shortcuts you need to continue to you

929
00:43:54,880 --> 00:44:01,900
more though make sure those understand

930
00:43:57,970 --> 00:44:04,810
the environment except to them what tre

931
00:44:01,900 --> 00:44:08,710
is getting better is moving away from

932
00:44:04,810 --> 00:44:10,540
IOC s and TTP storms coming more common

933
00:44:08,710 --> 00:44:11,520
now and tre force so you can see the

934
00:44:10,540 --> 00:44:14,340
fire

935
00:44:11,520 --> 00:44:17,160
starting to do mapping against TTP's and

936
00:44:14,340 --> 00:44:20,420
it's really good and it gives you a

937
00:44:17,160 --> 00:44:22,589
young Lister better insight of what

938
00:44:20,420 --> 00:44:24,720
iversity to use more techniques they're

939
00:44:22,590 --> 00:44:28,610
developing so it fits quite nicely with

940
00:44:24,720 --> 00:44:31,799
the pyramid I talked about earlier one

941
00:44:28,610 --> 00:44:33,930
so how good analysis is another one I

942
00:44:31,800 --> 00:44:36,120
was doing my things apart artifact

943
00:44:33,930 --> 00:44:39,810
analysis so it's more focused on the

944
00:44:36,120 --> 00:44:42,480
software side and a detailed view of the

945
00:44:39,810 --> 00:44:44,870
artifact it's useful to look at and you

946
00:44:42,480 --> 00:44:50,070
can do some basic correlation but again

947
00:44:44,870 --> 00:44:53,100
it's not a substitute for an AV so

948
00:44:50,070 --> 00:44:56,100
defensive measures system um provides no

949
00:44:53,100 --> 00:44:57,360
defensive measures at all however you

950
00:44:56,100 --> 00:45:00,029
can provide some harden them while

951
00:44:57,360 --> 00:45:02,790
restricting the config file so if you're

952
00:45:00,030 --> 00:45:05,070
very just call this our config file it

953
00:45:02,790 --> 00:45:06,810
could be a bit game over they could

954
00:45:05,070 --> 00:45:09,810
understand what you're looking for are

955
00:45:06,810 --> 00:45:12,029
you detecting it and so on there are

956
00:45:09,810 --> 00:45:15,150
some pitfalls to look out for as well

957
00:45:12,030 --> 00:45:18,300
such as poor configuration you end up

958
00:45:15,150 --> 00:45:21,810
excluding too much activity that you

959
00:45:18,300 --> 00:45:24,090
need to capture and even though using

960
00:45:21,810 --> 00:45:26,420
system on and so on

961
00:45:24,090 --> 00:45:28,770
other thing to look out for would be

962
00:45:26,420 --> 00:45:30,870
change it to the system on driver or

963
00:45:28,770 --> 00:45:36,320
service state sort of its stopping and

964
00:45:30,870 --> 00:45:39,120
starting and effectively stop the feed

965
00:45:36,320 --> 00:45:40,410
by generally on all the hosts I've seen

966
00:45:39,120 --> 00:45:47,040
sis mom they've always been

967
00:45:40,410 --> 00:45:49,350
event generating some saw lessened

968
00:45:47,040 --> 00:45:51,210
identify don't expect a system on

969
00:45:49,350 --> 00:45:53,069
conflict to capture all the events like

970
00:45:51,210 --> 00:45:55,530
I said you'll get catch all you need to

971
00:45:53,070 --> 00:45:57,480
have a look at those the analysts need

972
00:45:55,530 --> 00:46:00,300
to be understanding what's be reported

973
00:45:57,480 --> 00:46:03,000
in those are developing hypotheses and

974
00:46:00,300 --> 00:46:04,680
so on however you didn't get enhanced

975
00:46:03,000 --> 00:46:07,080
visibility so

976
00:46:04,680 --> 00:46:08,940
reporting is part of an incident it's

977
00:46:07,080 --> 00:46:11,700
easier for the analyst to report back to

978
00:46:08,940 --> 00:46:14,220
the client and as I understand exactly

979
00:46:11,700 --> 00:46:17,910
what activity has happened now this fits

980
00:46:14,220 --> 00:46:20,370
them in terms of correlation rules keep

981
00:46:17,910 --> 00:46:21,770
it simple focus on the operations don't

982
00:46:20,370 --> 00:46:27,359
tie them up

983
00:46:21,770 --> 00:46:29,400
actor techniques because artists will

984
00:46:27,360 --> 00:46:30,690
change that techniques a little bit or

985
00:46:29,400 --> 00:46:36,240
some of the techniques will always be

986
00:46:30,690 --> 00:46:37,920
fairly static weirdness you'll come

987
00:46:36,240 --> 00:46:42,359
across him I did

988
00:46:37,920 --> 00:46:45,270
so deployed on live house then I saw

989
00:46:42,360 --> 00:46:48,750
PowerShell scripts on him and it was

990
00:46:45,270 --> 00:46:50,850
just went in for infinity him let's stop

991
00:46:48,750 --> 00:46:53,730
come on check him see what ports are

992
00:46:50,850 --> 00:46:55,440
open and then it was clear in the ports

993
00:46:53,730 --> 00:46:57,750
and then just keep doing it and doing

994
00:46:55,440 --> 00:46:59,430
them initially I thought got some kind

995
00:46:57,750 --> 00:47:00,780
of weird behaviour I can kind of beacon

996
00:46:59,430 --> 00:47:02,970
in or is that something I was something

997
00:47:00,780 --> 00:47:04,500
him apparently it was a performance

998
00:47:02,970 --> 00:47:07,730
issue on the house it was an exchange

999
00:47:04,500 --> 00:47:10,440
server apparently he's got a happy

1000
00:47:07,730 --> 00:47:12,600
hooking the ports on the Rizal offices

1001
00:47:10,440 --> 00:47:15,390
on the house so the system administrator

1002
00:47:12,600 --> 00:47:18,330
deployed the power source where it was

1003
00:47:15,390 --> 00:47:22,080
happened this fixes out their legitimate

1004
00:47:18,330 --> 00:47:23,700
reason for doing it was a unless you're

1005
00:47:22,080 --> 00:47:25,770
gonna get your system on look flooded

1006
00:47:23,700 --> 00:47:30,270
with all this activity do you do have to

1007
00:47:25,770 --> 00:47:33,120
do a bit of tuning blind spots if

1008
00:47:30,270 --> 00:47:36,810
someone just used you some malware of a

1009
00:47:33,120 --> 00:47:39,210
TV system or might not classify those

1010
00:47:36,810 --> 00:47:42,180
events but you might be able to spot I

1011
00:47:39,210 --> 00:47:44,910
don't Lea so for example lexical is used

1012
00:47:42,180 --> 00:47:48,810
to get sister and privilege the next

1013
00:47:44,910 --> 00:47:51,509
step might be to place user accounts so

1014
00:47:48,810 --> 00:47:53,549
sis mama and the attack matrix might not

1015
00:47:51,510 --> 00:47:55,920
be useful for that but using a Windows

1016
00:47:53,550 --> 00:47:59,820
security logs so don't concern yourself

1017
00:47:55,920 --> 00:48:02,400
too much on the system unlocks going

1018
00:47:59,820 --> 00:48:05,520
forward I'm in the process of grading

1019
00:48:02,400 --> 00:48:07,380
system onto version 10 they provides DNS

1020
00:48:05,520 --> 00:48:11,130
locking or the process of reporting on

1021
00:48:07,380 --> 00:48:12,780
the original file name so game changer

1022
00:48:11,130 --> 00:48:16,380
I'm not even seeing this functioned and

1023
00:48:12,780 --> 00:48:18,780
easy off solutions either Swift on

1024
00:48:16,380 --> 00:48:21,120
secure is released an updated system on

1025
00:48:18,780 --> 00:48:23,760
config file so it provides mocking Tilly

1026
00:48:21,120 --> 00:48:25,980
attack matrix TTP's as well so now we've

1027
00:48:23,760 --> 00:48:29,640
got two convicts or Laughton's spoof on

1028
00:48:25,980 --> 00:48:32,560
security verse revelation that is

1029
00:48:29,640 --> 00:48:35,080
maturing so TR report yeah

1030
00:48:32,560 --> 00:48:38,230
of teacher and TTP's and so on again

1031
00:48:35,080 --> 00:48:44,610
somatic I've been just starting clearing

1032
00:48:38,230 --> 00:48:47,920
them so for my retinas point of view

1033
00:48:44,610 --> 00:48:50,890
concluding slides through the security

1034
00:48:47,920 --> 00:48:51,880
analyst perspective they taught matrix

1035
00:48:50,890 --> 00:48:55,480
addition

1036
00:48:51,880 --> 00:48:57,400
GameChanger it's invaluable so the

1037
00:48:55,480 --> 00:48:59,380
security analyst is kind of moving more

1038
00:48:57,400 --> 00:49:02,320
away from reactive to more productive

1039
00:48:59,380 --> 00:49:04,120
understanding the events starting to be

1040
00:49:02,320 --> 00:49:05,470
more threat aware understand what's

1041
00:49:04,120 --> 00:49:08,290
happening in the environment the host

1042
00:49:05,470 --> 00:49:11,439
and so on which makes the security in

1043
00:49:08,290 --> 00:49:12,940
see an escalation more valuable to the

1044
00:49:11,440 --> 00:49:18,490
client because we can provide more

1045
00:49:12,940 --> 00:49:20,080
context detail the youngest still needs

1046
00:49:18,490 --> 00:49:21,490
to understand the environment under

1047
00:49:20,080 --> 00:49:24,310
standard I hosted deployed the

1048
00:49:21,490 --> 00:49:27,009
configuration what was visible to what

1049
00:49:24,310 --> 00:49:28,810
the critical of star and so on and I

1050
00:49:27,010 --> 00:49:32,260
still recommend I exercising is done

1051
00:49:28,810 --> 00:49:35,250
either from external pen testing so on

1052
00:49:32,260 --> 00:49:37,390
just get the analyst to understand him

1053
00:49:35,250 --> 00:49:39,760
we've covered all the techniques we need

1054
00:49:37,390 --> 00:49:41,680
to previous presentation talked about

1055
00:49:39,760 --> 00:49:48,550
prioritization we're going through that

1056
00:49:41,680 --> 00:49:49,810
same pain because my viewers are we

1057
00:49:48,550 --> 00:49:51,610
shouldn't be going for zero positive

1058
00:49:49,810 --> 00:49:55,660
would you need to capture stuff because

1059
00:49:51,610 --> 00:49:56,800
there is legit activity although you

1060
00:49:55,660 --> 00:50:00,490
shouldn't be getting a full coverage of

1061
00:49:56,800 --> 00:50:03,460
the attack matrix because as mentioned

1062
00:50:00,490 --> 00:50:05,589
earlier on some technical article to the

1063
00:50:03,460 --> 00:50:06,940
environment you're trying to monitor so

1064
00:50:05,590 --> 00:50:10,120
a basic level you should be able to

1065
00:50:06,940 --> 00:50:11,680
detect order technics be news then next

1066
00:50:10,120 --> 00:50:13,810
level should start prioritizing the

1067
00:50:11,680 --> 00:50:16,060
techniques and then mapping that on to

1068
00:50:13,810 --> 00:50:22,360
the operation it could leap off on an

1069
00:50:16,060 --> 00:50:25,509
attack so last slide yeah somebody

1070
00:50:22,360 --> 00:50:27,390
excellent references so I use most of

1071
00:50:25,510 --> 00:50:30,790
his offices you should be familiar with

1072
00:50:27,390 --> 00:50:32,190
the last item we see a detection lap so

1073
00:50:30,790 --> 00:50:35,380
if you really want to quickly spin up

1074
00:50:32,190 --> 00:50:37,960
some virtual machines Windows Server

1075
00:50:35,380 --> 00:50:40,990
host and so on then this eclipse won't

1076
00:50:37,960 --> 00:50:43,400
do that there is a couple of other

1077
00:50:40,990 --> 00:50:46,019
things I'm not included on there

1078
00:50:43,400 --> 00:50:50,039
something called Sigma so they provide

1079
00:50:46,019 --> 00:50:51,930
generic she clear t-wolves and I've been

1080
00:50:50,039 --> 00:50:53,849
quite a useful resource for correlation

1081
00:50:51,930 --> 00:50:55,499
as well you can start to use that for

1082
00:50:53,849 --> 00:50:56,640
school money to environment start

1083
00:50:55,499 --> 00:50:59,519
looking at what techniques should be

1084
00:50:56,640 --> 00:51:02,969
looking for and if you're trying to get

1085
00:50:59,519 --> 00:51:06,538
into the top meters or trying to get to

1086
00:51:02,969 --> 00:51:08,969
honest up to speed on this then listen a

1087
00:51:06,539 --> 00:51:12,209
couple of datasets out there so my tooth

1088
00:51:08,969 --> 00:51:17,640
released her so called her up or we are

1089
00:51:12,209 --> 00:51:19,890
WL is about three kick in size with his

1090
00:51:17,640 --> 00:51:21,660
11 kick version and I was a lot of data

1091
00:51:19,890 --> 00:51:26,549
in there with a lot of bad activity so

1092
00:51:21,660 --> 00:51:27,618
it's quite good chest though so thanks

1093
00:51:26,549 --> 00:51:30,560
for listening

1094
00:51:27,619 --> 00:51:36,139
that's me

1095
00:51:30,560 --> 00:51:36,139
[Applause]

