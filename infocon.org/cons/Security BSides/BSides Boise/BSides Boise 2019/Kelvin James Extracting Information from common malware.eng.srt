1
00:00:10,639 --> 00:00:15,770
sweet alright ladies gentlemen this is

2
00:00:15,770 --> 00:00:22,430
looking at we're going to be looking at

3
00:00:22,619 --> 00:00:26,650
fantastic malware actually the title of

4
00:00:26,650 --> 00:00:28,390
the official title of this I really

5
00:00:28,390 --> 00:00:30,430
struggled the title believe or not was a

6
00:00:30,430 --> 00:00:32,980
extracting information for common

7
00:00:32,980 --> 00:00:35,920
malware for worlds and what that really

8
00:00:35,920 --> 00:00:41,620
means is that we're going to take a look

9
00:00:41,620 --> 00:00:43,750
at the normal matter that you folks see

10
00:00:43,750 --> 00:00:45,309
every day I don't know about you guys

11
00:00:45,309 --> 00:00:50,769
but I see three or four malware email

12
00:00:50,769 --> 00:00:55,479
campaigns throughout my week we are

13
00:00:55,479 --> 00:00:59,260
actually doing so we are not doing any

14
00:00:59,260 --> 00:01:01,680
reverse engineering we are not doing

15
00:01:01,680 --> 00:01:04,330
debugging we're not doing anything else

16
00:01:04,330 --> 00:01:09,340
besides taking malware and take it

17
00:01:09,340 --> 00:01:12,670
running it and checking it out most of

18
00:01:12,670 --> 00:01:14,260
the modeler samples are going to look at

19
00:01:14,260 --> 00:01:17,049
today you can literally do in two

20
00:01:17,049 --> 00:01:20,350
segregated VMs you got your VirtualBox

21
00:01:20,350 --> 00:01:22,150
you got your Windows and you got a Linux

22
00:01:22,150 --> 00:01:25,800
box which is going to lie to the malware

23
00:01:25,800 --> 00:01:29,320
the only one the only exception is Zeus

24
00:01:29,320 --> 00:01:33,130
panda banker which is which does require

25
00:01:33,130 --> 00:01:35,830
internet if I have found but I included

26
00:01:35,830 --> 00:01:37,420
it because it's a pain in my butt and I

27
00:01:37,420 --> 00:01:41,140
hate it we will also look at trick bot

28
00:01:41,140 --> 00:01:46,930
the trick which is extra icky before we

29
00:01:46,930 --> 00:01:49,120
go any further I'm going to ask you guys

30
00:01:49,120 --> 00:01:51,250
to ask me a question which is why are we

31
00:01:51,250 --> 00:01:54,310
doing this that's a fantastic question

32
00:01:54,310 --> 00:01:55,870
I'm glad you asked that we are doing

33
00:01:55,870 --> 00:01:59,890
this because even though we have our

34
00:01:59,890 --> 00:02:02,200
mind cast we've got our proof point

35
00:02:02,200 --> 00:02:05,260
we've got our app River we've got all

36
00:02:05,260 --> 00:02:09,128
these emails sanitization technologies

37
00:02:09,128 --> 00:02:11,879
they're not always a hundred percent

38
00:02:11,879 --> 00:02:16,150
just this was just September if you

39
00:02:16,150 --> 00:02:18,970
notice here I've got believing how this

40
00:02:18,970 --> 00:02:21,790
was an open directory and I have 100 X

41
00:02:21,790 --> 00:02:26,440
103 px 106 e^x and I don't standing here

42
00:02:26,440 --> 00:02:28,440
net wire Remco fantast

43
00:02:28,440 --> 00:02:30,150
now I know my indicators are gonna be

44
00:02:30,150 --> 00:02:34,130
however this is what I got

45
00:02:34,670 --> 00:02:41,490
anybody notice any discrepancies don't

46
00:02:41,490 --> 00:02:44,580
dance style 102 porfavor I had no 102

47
00:02:44,580 --> 00:02:47,450
exe on this list and believe it or not

48
00:02:47,450 --> 00:02:51,150
102 dot exe was actually lucky bottle so

49
00:02:51,150 --> 00:02:53,700
if I knew that was lucky but then I see

50
00:02:53,700 --> 00:02:54,660
okay great

51
00:02:54,660 --> 00:02:56,730
so now I know that I've got my fre dot

52
00:02:56,730 --> 00:02:58,910
php' which I'm gonna see on my network

53
00:02:58,910 --> 00:03:01,500
the real reason we take a look at these

54
00:03:01,500 --> 00:03:06,150
so we know what's attacking us we have

55
00:03:06,150 --> 00:03:08,220
lots of campaigns that come through I

56
00:03:08,220 --> 00:03:10,110
can tell you straight away the one that

57
00:03:10,110 --> 00:03:12,630
always drops panda Baker is Hanson er

58
00:03:12,630 --> 00:03:14,910
Chancellor tour doubt it downloads eagle

59
00:03:14,910 --> 00:03:19,110
pony pony until the end of September and

60
00:03:19,110 --> 00:03:21,270
you could set your watch by it Monday

61
00:03:21,270 --> 00:03:24,270
through Thursday 8:00 between 8 o'clock

62
00:03:24,270 --> 00:03:26,520
and 10 o'clock and bam it's coming in

63
00:03:26,520 --> 00:03:27,870
with effects with all these other

64
00:03:27,870 --> 00:03:30,750
subjects those large campaigns that

65
00:03:30,750 --> 00:03:32,690
you'll see coming in throughout your

66
00:03:32,690 --> 00:03:37,260
your day those will generally be well

67
00:03:37,260 --> 00:03:39,720
analyzed you're gonna have a proof point

68
00:03:39,720 --> 00:03:41,550
on them you're gonna have Palo Alto on

69
00:03:41,550 --> 00:03:43,620
them most of the time those are the ones

70
00:03:43,620 --> 00:03:45,180
that are going to come in you're pretty

71
00:03:45,180 --> 00:03:47,390
safe with saying okay yeah we have

72
00:03:47,390 --> 00:03:49,680
thousands of emails and just came in

73
00:03:49,680 --> 00:03:51,600
even if they're undelivered if you're

74
00:03:51,600 --> 00:03:52,890
looking at something like proof point

75
00:03:52,890 --> 00:03:54,780
you can still say holy crud I've got a

76
00:03:54,780 --> 00:03:56,880
boat ton of these coming in somebody's

77
00:03:56,880 --> 00:03:58,320
analyzed them and it's good to go

78
00:03:58,320 --> 00:04:01,410
it's these 1 Z 2 Z's it's these right

79
00:04:01,410 --> 00:04:03,239
here that you have to be careful with

80
00:04:03,239 --> 00:04:06,890
trip pile will normally come in

81
00:04:07,130 --> 00:04:10,050
sometimes on a very large scale campaign

82
00:04:10,050 --> 00:04:13,110
but other times as I as I've experienced

83
00:04:13,110 --> 00:04:16,410
they come in 1 Z 2 Z 3 s and fours just

84
00:04:16,410 --> 00:04:18,630
enough under the radar so if you don't

85
00:04:18,630 --> 00:04:20,548
know what you're looking for you're not

86
00:04:20,548 --> 00:04:21,899
going to know what to look for on your

87
00:04:21,899 --> 00:04:24,739
network

88
00:04:26,969 --> 00:04:30,939
any questions so far I was told by my

89
00:04:30,939 --> 00:04:34,150
family to go slow unlike my standard

90
00:04:34,150 --> 00:04:38,469
speed of gerbil on crack sooo questions

91
00:04:38,469 --> 00:04:45,939
anything all right so the tools we're

92
00:04:45,939 --> 00:04:49,689
gonna use all of them I'm a real big

93
00:04:49,689 --> 00:04:52,330
open source guy the more open source the

94
00:04:52,330 --> 00:04:56,169
better only because it makes it easier

95
00:04:56,169 --> 00:04:59,770
to use for my perspective I use a lot of

96
00:04:59,770 --> 00:05:02,529
Linux in fact as we look at this one of

97
00:05:02,529 --> 00:05:05,409
the crucial things a tech help list calm

98
00:05:05,409 --> 00:05:07,629
on Twitter really spoke this well he

99
00:05:07,629 --> 00:05:10,300
said you handle your Linux malware on

100
00:05:10,300 --> 00:05:12,580
Windows and you handle your Windows

101
00:05:12,580 --> 00:05:15,430
malware on Linux we're gonna be using

102
00:05:15,430 --> 00:05:18,819
VirtualBox who had a Linux VM I would

103
00:05:18,819 --> 00:05:21,610
highly recommend matter of cell from end

104
00:05:21,610 --> 00:05:23,710
game security I believe she has a post

105
00:05:23,710 --> 00:05:26,710
and I'll post through all these on my

106
00:05:26,710 --> 00:05:29,770
pastebin after this talk she has a

107
00:05:29,770 --> 00:05:31,599
premade set up ready to go

108
00:05:31,599 --> 00:05:34,449
VM with I netsim really hot stuff makes

109
00:05:34,449 --> 00:05:35,889
it super easy to lie to the malware

110
00:05:35,889 --> 00:05:40,330
which we like to do Windows 7 vm will be

111
00:05:40,330 --> 00:05:43,240
using i netsim so i netsim there's also

112
00:05:43,240 --> 00:05:45,819
a great one called fake net these are

113
00:05:45,819 --> 00:05:47,680
what we're going to use to just

114
00:05:47,680 --> 00:05:50,560
basically lie to the malware that it's

115
00:05:50,560 --> 00:05:53,649
most of these affect all these except

116
00:05:53,649 --> 00:05:55,479
for paying a banker will request some

117
00:05:55,479 --> 00:05:58,330
sort of what's my external IP address IP

118
00:05:58,330 --> 00:06:02,529
chicken IP an info I think there's a can

119
00:06:02,529 --> 00:06:05,710
has IP what is my IP address all these

120
00:06:05,710 --> 00:06:07,779
ones are just so we can find out what's

121
00:06:07,779 --> 00:06:11,020
my external IP address will use I netsim

122
00:06:11,020 --> 00:06:14,110
and the Linux VM to lie to it if you

123
00:06:14,110 --> 00:06:16,629
want to get a little more esoteric which

124
00:06:16,629 --> 00:06:20,379
I have done I'll run my own Apache

125
00:06:20,379 --> 00:06:23,110
server on that van and I will actually

126
00:06:23,110 --> 00:06:25,530
go down to I will go down

127
00:06:25,530 --> 00:06:31,470
the responses from IP chicken or from IP

128
00:06:31,470 --> 00:06:34,230
net info and I will actually copy the

129
00:06:34,230 --> 00:06:36,810
responses verbatim how they look and I

130
00:06:36,810 --> 00:06:39,120
will actually create different websites

131
00:06:39,120 --> 00:06:42,390
within an Apache instance that will

132
00:06:42,390 --> 00:06:45,030
actually mimic the exact responses but I

133
00:06:45,030 --> 00:06:51,780
netsim does just a great job as well so

134
00:06:51,780 --> 00:06:55,190
I will reiterate that when you are using

135
00:06:55,190 --> 00:06:58,110
this type of technique using VirtualBox

136
00:06:58,110 --> 00:07:00,090
I would strongly recommend you actually

137
00:07:00,090 --> 00:07:04,680
handle it on a Linux machine if not if

138
00:07:04,680 --> 00:07:07,290
you are willing to take the risk I would

139
00:07:07,290 --> 00:07:09,120
strongly recommend wherever your source

140
00:07:09,120 --> 00:07:11,970
is you use something like 7-zip to do it

141
00:07:11,970 --> 00:07:14,580
to encrypt it zip with a password this

142
00:07:14,580 --> 00:07:15,570
way you're going to prevent yourself

143
00:07:15,570 --> 00:07:17,310
from accidentally clicking on it and

144
00:07:17,310 --> 00:07:23,760
having a horrible rest of your day so

145
00:07:23,760 --> 00:07:25,440
first thing we're going to do you can

146
00:07:25,440 --> 00:07:27,300
choose whatever internal network you

147
00:07:27,300 --> 00:07:32,070
like 171 60.1 and 0.2 is what I've

148
00:07:32,070 --> 00:07:35,070
chosen all your 192 block 1 I 2 1 6 8

149
00:07:35,070 --> 00:07:40,260
blocks those are fine as well you'll be

150
00:07:40,260 --> 00:07:42,630
wanting to set these up as an internal

151
00:07:42,630 --> 00:07:44,700
only network on VirtualBox

152
00:07:44,700 --> 00:07:47,880
you can see here I've got this set just

153
00:07:47,880 --> 00:07:50,669
a the router the default gateway and the

154
00:07:50,669 --> 00:07:53,190
preferred DNS are the Linux box which we

155
00:07:53,190 --> 00:07:56,850
just set up really easy make sure to do

156
00:07:56,850 --> 00:07:58,680
a pain test test make sure they can talk

157
00:07:58,680 --> 00:08:02,910
to each other so what I've done here is

158
00:08:02,910 --> 00:08:05,790
I actually run VirtualBox on Linux as

159
00:08:05,790 --> 00:08:09,540
well so I have a VM shared directory so

160
00:08:09,540 --> 00:08:11,340
the VM shared directory is what I share

161
00:08:11,340 --> 00:08:14,160
on the Linux machine itself and that

162
00:08:14,160 --> 00:08:16,110
allows me to share from the guest to the

163
00:08:16,110 --> 00:08:19,590
host that one I have read and writable

164
00:08:19,590 --> 00:08:21,240
there's nothing in there it's only if I

165
00:08:21,240 --> 00:08:23,820
want to copy something from the hook

166
00:08:23,820 --> 00:08:25,770
from the guest to the host

167
00:08:25,770 --> 00:08:27,540
now SF case

168
00:08:27,540 --> 00:08:29,460
this is actually where I have them our

169
00:08:29,460 --> 00:08:33,960
so that's sitting on my host machine so

170
00:08:33,960 --> 00:08:36,270
when I want to make a copy when I want

171
00:08:36,270 --> 00:08:39,570
to get this malware from my Linux box VM

172
00:08:39,570 --> 00:08:42,690
on to my Windows machine the first step

173
00:08:42,690 --> 00:08:46,440
is I use my Linux VM to copy from my

174
00:08:46,440 --> 00:08:50,220
host to my Linux VM and this is why

175
00:08:50,220 --> 00:08:52,500
movement Monday I have no idea why they

176
00:08:52,500 --> 00:08:53,880
call it that but that's what they called

177
00:08:53,880 --> 00:08:58,980
it from there we will SFTP that file

178
00:08:58,980 --> 00:09:03,210
across from our Linux VM to our windows

179
00:09:03,210 --> 00:09:06,230
BM so our process is our host machine

180
00:09:06,230 --> 00:09:08,220
preferentially Linux which is holding

181
00:09:08,220 --> 00:09:13,160
the malware we copy it from the Linux VM

182
00:09:13,160 --> 00:09:16,260
on to from that machine onto Linux VM

183
00:09:16,260 --> 00:09:19,530
itself and then we SFTP it across to the

184
00:09:19,530 --> 00:09:24,450
Windows machine after we've got that set

185
00:09:24,450 --> 00:09:26,130
we're gonna tell our we this that we're

186
00:09:26,130 --> 00:09:28,080
gonna set up RI netsim really quick

187
00:09:28,080 --> 00:09:30,180
really easy you can actually just do a

188
00:09:30,180 --> 00:09:31,440
search in a place I think they're all

189
00:09:31,440 --> 00:09:34,320
set that end up 10.1 anyway we tell it

190
00:09:34,320 --> 00:09:35,880
hey we're gonna buy to our internal

191
00:09:35,880 --> 00:09:40,260
address 117 to the 6201 same thing with

192
00:09:40,260 --> 00:09:46,680
our DNS the default response is ein it's

193
00:09:46,680 --> 00:09:49,800
an HTTP server I've been a giveaway so

194
00:09:49,800 --> 00:09:51,180
we want to change that into something

195
00:09:51,180 --> 00:09:53,130
that's not blatantly saying hey I'm fine

196
00:09:53,130 --> 00:09:53,670
it's him

197
00:09:53,670 --> 00:09:56,540
now where absolutely does look for that

198
00:09:56,540 --> 00:09:59,210
first thing we look at is agent Tesla

199
00:09:59,210 --> 00:10:02,520
agent Tesla is a key logger it is one of

200
00:10:02,520 --> 00:10:05,220
many that I see constantly this hawkeye

201
00:10:05,220 --> 00:10:06,390
key logger as well they're very

202
00:10:06,390 --> 00:10:08,640
prevalent they can be anywhere from

203
00:10:08,640 --> 00:10:13,460
embedded within documents to downloaded

204
00:10:13,460 --> 00:10:15,930
some documents will actually I've seen a

205
00:10:15,930 --> 00:10:17,820
lot of recent ones where they'll

206
00:10:17,820 --> 00:10:20,340
actually go out to a bitly link the

207
00:10:20,340 --> 00:10:25,350
bitly link will go to a loud coca la or

208
00:10:25,350 --> 00:10:26,329
there's one other

209
00:10:26,329 --> 00:10:28,160
I think it's confident mo they'll

210
00:10:28,160 --> 00:10:31,429
actually download either a JPEG file

211
00:10:31,429 --> 00:10:34,100
which is literally an executable or they

212
00:10:34,100 --> 00:10:36,709
will tag on the embedded executable

213
00:10:36,709 --> 00:10:39,199
within the JPEG file it's trivial to

214
00:10:39,199 --> 00:10:43,579
execute it out we run this and a good

215
00:10:43,579 --> 00:10:46,339
thing that I do is I keep an eye on this

216
00:10:46,339 --> 00:10:48,949
bad boy right here so when I have five

217
00:10:48,949 --> 00:10:52,100
Meg's of memory used I don't think much

218
00:10:52,100 --> 00:10:53,869
is going on but I will tell you that as

219
00:10:53,869 --> 00:10:56,689
soon as I run it I will keep an eye I

220
00:10:56,689 --> 00:10:58,579
normally have both of these running I

221
00:10:58,579 --> 00:11:00,470
have a nice wide screen monitor I have

222
00:11:00,470 --> 00:11:03,829
my Linux VM on one side my windows VM on

223
00:11:03,829 --> 00:11:06,529
the other and I run a packet capture so

224
00:11:06,529 --> 00:11:08,239
I can listen the traffic as soon as you

225
00:11:08,239 --> 00:11:10,999
see the magic of check I peed in DNS

226
00:11:10,999 --> 00:11:12,949
there or you know that it's loaded into

227
00:11:12,949 --> 00:11:13,989
memory

228
00:11:13,989 --> 00:11:17,119
at this point in time i suspend the

229
00:11:17,119 --> 00:11:20,689
process and i create a dump file I may

230
00:11:20,689 --> 00:11:22,429
not have all the information there yet

231
00:11:22,429 --> 00:11:23,029
but I will

232
00:11:23,029 --> 00:11:25,339
I actually for especially for agent

233
00:11:25,339 --> 00:11:28,100
Tesla I make about three or four process

234
00:11:28,100 --> 00:11:34,100
dumps I let it sit I will resume the

235
00:11:34,100 --> 00:11:37,519
process and then I'll do a search search

236
00:11:37,519 --> 00:11:40,399
stream sometimes I have to refresh it as

237
00:11:40,399 --> 00:11:41,989
soon as you start seeing this gobbly

238
00:11:41,989 --> 00:11:43,579
 you're in like Flynn you know you

239
00:11:43,579 --> 00:11:46,399
got these are base64 encoded and

240
00:11:46,399 --> 00:11:49,339
encrypted entries that we use that is

241
00:11:49,339 --> 00:11:53,480
the key which is static key that 1v2 I

242
00:11:53,480 --> 00:11:55,040
don't know why they haven't changing it

243
00:11:55,040 --> 00:11:56,799
what they haven't changed together I

244
00:11:56,799 --> 00:12:00,160
will add one more time make a dump file

245
00:12:00,160 --> 00:12:03,049
from there I'm going to use a new on

246
00:12:03,049 --> 00:12:06,139
track on Twitter as a very sharp region

247
00:12:06,139 --> 00:12:08,029
I believe he works for Palo Alto he

248
00:12:08,029 --> 00:12:11,540
created this all I did was add one more

249
00:12:11,540 --> 00:12:14,660
entry which is import base64 and

250
00:12:14,660 --> 00:12:17,029
basically weaponize this I'll also have

251
00:12:17,029 --> 00:12:21,350
this up on Facebook we copy all these

252
00:12:21,350 --> 00:12:25,639
back over three dump files over three

253
00:12:25,639 --> 00:12:29,629
dump files over and from here we strings

254
00:12:29,629 --> 00:12:34,230
these out we do al for a wide

255
00:12:34,230 --> 00:12:38,820
- extracted basic b64 we run that script

256
00:12:38,820 --> 00:12:44,160
which is here that's literally all this

257
00:12:44,160 --> 00:12:46,650
is I kid you not copy paste add the

258
00:12:46,650 --> 00:12:49,830
import base64 under there that's that's

259
00:12:49,830 --> 00:12:52,140
seriously hit and we will have this

260
00:12:52,140 --> 00:12:54,900
amount of excitement it does look a

261
00:12:54,900 --> 00:12:56,970
little nasty at first you can clean it

262
00:12:56,970 --> 00:12:59,520
up with grep sent off at the end of the

263
00:12:59,520 --> 00:13:02,580
day this is what you'll get and you will

264
00:13:02,580 --> 00:13:05,760
see that this one actually - ftp lassic

265
00:13:05,760 --> 00:13:09,930
comm jungle at 6:00 calm people who say

266
00:13:09,930 --> 00:13:11,610
gee that looks like a password are

267
00:13:11,610 --> 00:13:12,870
probably right that's probably a

268
00:13:12,870 --> 00:13:15,360
password agent Tesla comes in three

269
00:13:15,360 --> 00:13:18,660
tasty variants usually we see the SMTP

270
00:13:18,660 --> 00:13:22,050
version which may use TLS betweens you

271
00:13:22,050 --> 00:13:23,580
will not be able to get the threat actor

272
00:13:23,580 --> 00:13:27,270
in this case jug alas XCOM sometimes

273
00:13:27,270 --> 00:13:29,130
they do a phenomenal fail where they

274
00:13:29,130 --> 00:13:32,430
actually have their email go out and

275
00:13:32,430 --> 00:13:34,830
clear text and they do an authentication

276
00:13:34,830 --> 00:13:36,300
it's basics before you get the

277
00:13:36,300 --> 00:13:38,670
credentials that way in this particular

278
00:13:38,670 --> 00:13:41,820
case though it was FTP variant so if we

279
00:13:41,820 --> 00:13:45,360
saw a if we saw a DNS request for alas

280
00:13:45,360 --> 00:13:48,090
XCOM we would know that somebody has

281
00:13:48,090 --> 00:13:49,860
opened something bad and their day has

282
00:13:49,860 --> 00:13:55,050
just gone pear-shaped our next little DC

283
00:13:55,050 --> 00:13:57,240
that we're going to look at is panda

284
00:13:57,240 --> 00:13:59,280
banker we will start with that same

285
00:13:59,280 --> 00:14:01,710
process we're going to copy it over from

286
00:14:01,710 --> 00:14:06,660
our host operating system onto our Linux

287
00:14:06,660 --> 00:14:10,950
VM we will then SFTP it across from our

288
00:14:10,950 --> 00:14:14,100
Linux VM to our windows 7 box we will

289
00:14:14,100 --> 00:14:19,050
run this and what will seem like a very

290
00:14:19,050 --> 00:14:23,390
long time but you will actually see two

291
00:14:23,390 --> 00:14:27,120
service host processes Python at this

292
00:14:27,120 --> 00:14:29,089
point in time I actually will do

293
00:14:29,089 --> 00:14:31,969
dumps as well but I will also begin to

294
00:14:31,969 --> 00:14:37,369
look for Strings within this and the

295
00:14:37,369 --> 00:14:39,589
phrase that pays ladies and gentlemen

296
00:14:39,589 --> 00:14:41,989
and I usually just check for underscore

297
00:14:41,989 --> 00:14:44,089
config as soon as you got an underscore

298
00:14:44,089 --> 00:14:46,729
conferring the goal why because now you

299
00:14:46,729 --> 00:14:49,909
know your bucket ID is 2 6 10 and you

300
00:14:49,909 --> 00:14:51,919
have all the configuration information

301
00:14:51,919 --> 00:14:54,879
needed

302
00:14:54,879 --> 00:14:57,859
dump it lesson out bam there you go

303
00:14:57,859 --> 00:14:59,959
there's their entire conflict up to and

304
00:14:59,959 --> 00:15:02,359
including the base64 encode is processed

305
00:15:02,359 --> 00:15:05,499
name which is usually putty dot exe

306
00:15:05,499 --> 00:15:08,689
botnet ID is up there your web and jex

307
00:15:08,689 --> 00:15:10,669
your b and c modules your grab or your

308
00:15:10,669 --> 00:15:12,529
socks your key logger all that garbage

309
00:15:12,529 --> 00:15:15,889
is right there for you so again if you

310
00:15:15,889 --> 00:15:18,489
suddenly see this on your network

311
00:15:18,489 --> 00:15:20,539
someone has just to open something that

312
00:15:20,539 --> 00:15:22,369
is very naughty and you're going to get

313
00:15:22,369 --> 00:15:26,109
the role it's a no response questions

314
00:15:26,109 --> 00:15:30,709
anything all right

315
00:15:30,709 --> 00:15:33,859
a last one to my particular favorite but

316
00:15:33,859 --> 00:15:37,099
i really is trick but same process we

317
00:15:37,099 --> 00:15:41,029
copy it over from host the linux vm from

318
00:15:41,029 --> 00:15:46,089
linux vm to windows 7 vm the process now

319
00:15:46,089 --> 00:15:49,369
is so fast that if you have process

320
00:15:49,369 --> 00:15:51,409
hacker running which come tasty you will

321
00:15:51,409 --> 00:15:53,119
see a service has been deleted anyone

322
00:15:53,119 --> 00:15:57,139
want to guess with that services god

323
00:15:57,139 --> 00:15:59,959
bless you Windows Defender it's kind of

324
00:15:59,959 --> 00:16:03,019
rude you can also check and this one

325
00:16:03,019 --> 00:16:05,569
will absolutely take an eternity I teach

326
00:16:05,569 --> 00:16:06,799
you nothing you're going to wonder if

327
00:16:06,799 --> 00:16:08,419
anything actually happened after you

328
00:16:08,419 --> 00:16:10,069
click the executable oh my gosh what

329
00:16:10,069 --> 00:16:10,729
happened

330
00:16:10,729 --> 00:16:12,769
you can check because trick bots will

331
00:16:12,769 --> 00:16:16,309
actually create a scheduled task as you

332
00:16:16,309 --> 00:16:18,019
can tell it says it's every 10 minutes

333
00:16:18,019 --> 00:16:19,759
if you catch it wrong you will actually

334
00:16:19,759 --> 00:16:21,439
have to wait 10 minutes which is really

335
00:16:21,439 --> 00:16:26,119
lame this is what it has started this

336
00:16:26,119 --> 00:16:28,480
actual start I name my boxes ran

337
00:16:28,480 --> 00:16:31,560
to make them look good as much as I can

338
00:16:31,560 --> 00:16:34,870
in what will seem like an eternity

339
00:16:34,870 --> 00:16:36,940
service house will finally show up you

340
00:16:36,940 --> 00:16:39,790
will also see network activity the same

341
00:16:39,790 --> 00:16:42,220
with agent Tesla you'll see your check

342
00:16:42,220 --> 00:16:45,040
IP you'll see your can't I have IP all

343
00:16:45,040 --> 00:16:50,079
these other ones I didn't dive any use

344
00:16:50,079 --> 00:16:51,310
another one that trick Bob will

345
00:16:51,310 --> 00:16:53,470
continually try this is why my external

346
00:16:53,470 --> 00:16:54,880
IP is another this is why it's really

347
00:16:54,880 --> 00:16:56,910
good to have these running side-by-side

348
00:16:56,910 --> 00:17:00,940
run you can use t sharp you can use TCP

349
00:17:00,940 --> 00:17:02,889
dump whatever you want to use a hoarder

350
00:17:02,889 --> 00:17:04,569
so you can just so you can see the

351
00:17:04,569 --> 00:17:07,150
traffic you can actually if you're just

352
00:17:07,150 --> 00:17:09,280
doing it on your on a host machine as

353
00:17:09,280 --> 00:17:11,049
well if you're running Wireshark you can

354
00:17:11,049 --> 00:17:13,299
listen in on that a V net that

355
00:17:13,299 --> 00:17:15,609
VirtualBox Ethernet interface as well

356
00:17:15,609 --> 00:17:19,449
and listen to that as well from here the

357
00:17:19,449 --> 00:17:22,929
phrase that pays is MC comp mic Charlie

358
00:17:22,929 --> 00:17:26,829
Charlie us for November Foxtrot as soon

359
00:17:26,829 --> 00:17:28,960
as you see this and you may have to do

360
00:17:28,960 --> 00:17:31,480
several refreshes you're going we don't

361
00:17:31,480 --> 00:17:32,950
even have to do any dumps through this

362
00:17:32,950 --> 00:17:38,260
one all we have to do is save it right

363
00:17:38,260 --> 00:17:39,940
down here you can save their strings

364
00:17:39,940 --> 00:17:42,340
that will actually save this the entire

365
00:17:42,340 --> 00:17:47,110
search this is our version there's our D

366
00:17:47,110 --> 00:17:47,710
tag

367
00:17:47,710 --> 00:17:50,049
there's our command and control servers

368
00:17:50,049 --> 00:17:51,730
which are going to download a boat ton

369
00:17:51,730 --> 00:17:53,950
of nasty modules up to including latest

370
00:17:53,950 --> 00:17:55,630
one which is quite a sale grab over -

371
00:17:55,630 --> 00:18:00,610
there's REO B's copied over in fact on

372
00:18:00,610 --> 00:18:03,730
my VM on my Linux VM I don't even I have

373
00:18:03,730 --> 00:18:05,320
the bi-directional clipboard work

374
00:18:05,320 --> 00:18:06,880
rock-and-roll and I just copied straight

375
00:18:06,880 --> 00:18:10,140
over copy this into Visual Studio code

376
00:18:10,140 --> 00:18:13,000
XML format it posted on Twitter like a

377
00:18:13,000 --> 00:18:19,110
boss if you happen to see Ford 449

378
00:18:19,110 --> 00:18:21,549
you're going to have a bad day for the

379
00:18:21,549 --> 00:18:24,520
rest of your day this is why we take a

380
00:18:24,520 --> 00:18:27,520
look at these things these small sort of

381
00:18:27,520 --> 00:18:29,940
okay it was a malicious attachment

382
00:18:29,940 --> 00:18:33,160
grande wasn't blocked I get that a lot

383
00:18:33,160 --> 00:18:34,930
well was it blocked yes it was

384
00:18:34,930 --> 00:18:36,850
Oh fantastic wasn't fantastic but the

385
00:18:36,850 --> 00:18:39,130
bugger-all wasn't right we want to know

386
00:18:39,130 --> 00:18:41,830
what's attacking us so we know what

387
00:18:41,830 --> 00:18:48,640
indicators to look for these are all the

388
00:18:48,640 --> 00:18:52,870
goodies that we used I strongly

389
00:18:52,870 --> 00:18:54,760
recommend visual studio code it is

390
00:18:54,760 --> 00:18:58,210
cross-platform it is a as I've used it

391
00:18:58,210 --> 00:18:59,410
more and more it's been a really good

392
00:18:59,410 --> 00:19:03,130
replacement for notepad plus plus again

393
00:19:03,130 --> 00:19:07,290
I will post these up shortly

394
00:19:08,310 --> 00:19:10,350
any questions

395
00:19:10,350 --> 00:19:18,070
please I use Windows 7 because Windows

396
00:19:18,070 --> 00:19:21,070
10 is also a pain in my butt trying to

397
00:19:21,070 --> 00:19:24,580
get it to stop running antivirus Windows

398
00:19:24,580 --> 00:19:27,700
10 is fantastic for the common person I

399
00:19:27,700 --> 00:19:29,980
would have my Ballmer in Windows 10 as a

400
00:19:29,980 --> 00:19:32,740
analyst oh my gosh stop I have to make

401
00:19:32,740 --> 00:19:35,950
special things special scripts just to

402
00:19:35,950 --> 00:19:38,380
kill the thing I actually use Windows 10

403
00:19:38,380 --> 00:19:41,050
for static analysis which is fine and

404
00:19:41,050 --> 00:19:43,030
dandy but seriously I had to make sure

405
00:19:43,030 --> 00:19:47,320
to disable all the all the antivirus

406
00:19:47,320 --> 00:19:49,720
check the Windows Defender it is amazing

407
00:19:49,720 --> 00:19:51,340
that that's currently why I've also

408
00:19:51,340 --> 00:19:53,620
found there are certain types of malware

409
00:19:53,620 --> 00:19:56,290
that will I ran on just the other day

410
00:19:56,290 --> 00:19:59,040
the dotnet would only run in Windows XP

411
00:19:59,040 --> 00:20:02,200
so I have a window I have no idea why so

412
00:20:02,200 --> 00:20:06,280
I have a Windows XP VM I have a Windows

413
00:20:06,280 --> 00:20:09,760
7 VM which is 32-bit only I also have

414
00:20:09,760 --> 00:20:11,560
one which is 64-bit only I have all

415
00:20:11,560 --> 00:20:13,660
three of them and I have seriously used

416
00:20:13,660 --> 00:20:15,940
all three of them to analyze certain

417
00:20:15,940 --> 00:20:17,860
hours that just won't play any other way

418
00:20:17,860 --> 00:20:22,870
other questions don't think they're

419
00:20:22,870 --> 00:20:24,160
inane questions because they're not

420
00:20:24,160 --> 00:20:27,060
anything else

421
00:20:32,360 --> 00:20:34,320
that's a great question

422
00:20:34,320 --> 00:20:37,620
I recently kind of sort of switched over

423
00:20:37,620 --> 00:20:41,940
to making snapshots but for some reason

424
00:20:41,940 --> 00:20:43,680
I found for a long time than making

425
00:20:43,680 --> 00:20:46,110
snapshots was having to remember to go

426
00:20:46,110 --> 00:20:48,780
back and restore the snapshot later

427
00:20:48,780 --> 00:20:50,580
it's terrible okay I better do this

428
00:20:50,580 --> 00:20:52,470
great analysis you started up I had

429
00:20:52,470 --> 00:20:54,660
firing out oh crud I forgot to restore

430
00:20:54,660 --> 00:20:57,660
the snapshot I just cut it out stop it

431
00:20:57,660 --> 00:20:59,940
restore the snapshot I've actually gone

432
00:20:59,940 --> 00:21:01,770
in and set the drive once I get

433
00:21:01,770 --> 00:21:03,210
everything all set up I got all the

434
00:21:03,210 --> 00:21:05,460
tools that I need paid dump whatever

435
00:21:05,460 --> 00:21:08,400
process hacker I will actually go in and

436
00:21:08,400 --> 00:21:11,010
set that drive to immutable and so all I

437
00:21:11,010 --> 00:21:13,080
need to do is as soon as I shut it down

438
00:21:13,080 --> 00:21:15,540
it automatically if nothing was ever

439
00:21:15,540 --> 00:21:18,420
stored into the disk when it's when

440
00:21:18,420 --> 00:21:20,520
you're using it for snapshots then it

441
00:21:20,520 --> 00:21:22,740
stores in the disk there's a caveat with

442
00:21:22,740 --> 00:21:25,500
that however the bonus point about if

443
00:21:25,500 --> 00:21:28,320
you're using snapshots you can if you

444
00:21:28,320 --> 00:21:31,800
say oh gee I needed a file off that off

445
00:21:31,800 --> 00:21:34,620
that image I can actually just start up

446
00:21:34,620 --> 00:21:36,270
my virtual box again and boom

447
00:21:36,270 --> 00:21:37,920
everything's fine and dandy I didn't

448
00:21:37,920 --> 00:21:39,480
restore the snapshot yet so I can still

449
00:21:39,480 --> 00:21:41,430
grab the file or the artifact that was

450
00:21:41,430 --> 00:21:42,330
dropped but that's a really good

451
00:21:42,330 --> 00:21:46,130
question so far immutable seems to be

452
00:21:46,130 --> 00:21:48,960
the best method for me but I have

453
00:21:48,960 --> 00:21:52,260
switched over a couple of them to the

454
00:21:52,260 --> 00:21:54,240
snapshot method just because a lot of

455
00:21:54,240 --> 00:21:55,830
these tools get updated really

456
00:21:55,830 --> 00:21:58,920
frequently x64 debug gets updated just

457
00:21:58,920 --> 00:22:01,140
almost monthly and I'd like to keep

458
00:22:01,140 --> 00:22:03,150
those tools current so that's why I've

459
00:22:03,150 --> 00:22:04,560
kind of switched over there to the

460
00:22:04,560 --> 00:22:10,890
snapshot man anything else okay

461
00:22:10,890 --> 00:22:14,820
the last bit before I go as you go out

462
00:22:14,820 --> 00:22:17,160
and as you look at these malicious code

463
00:22:17,160 --> 00:22:20,280
as you defend your companies defend

464
00:22:20,280 --> 00:22:22,350
families but one thing to keep in mind

465
00:22:22,350 --> 00:22:26,430
is that everything we do every service

466
00:22:26,430 --> 00:22:30,990
every product it is all about people so

467
00:22:30,990 --> 00:22:32,700
as you approach your day and it's two

468
00:22:32,700 --> 00:22:34,050
o'clock in the morning you you're on

469
00:22:34,050 --> 00:22:36,390
call and you're looking at an IDs alert

470
00:22:36,390 --> 00:22:39,180
keep it in the back of your mind really

471
00:22:39,180 --> 00:22:40,590
at the end of the day it's all about

472
00:22:40,590 --> 00:22:41,400
people

473
00:22:41,400 --> 00:22:43,080
all right thank you very much

474
00:22:43,080 --> 00:22:44,100
appreciated

475
00:22:44,100 --> 00:22:50,869
[Applause]

