1
00:00:02,610 --> 00:00:06,820
I learned the hard way you don't have to

2
00:00:04,259 --> 00:00:09,100
let's crack some passwords

3
00:00:06,820 --> 00:00:11,799
so the elevator pitch go this talk is

4
00:00:09,100 --> 00:00:12,969
for all of you to be able to learn this

5
00:00:11,799 --> 00:00:16,539
here and then go back to your

6
00:00:12,969 --> 00:00:19,060
organization's and do it I saw way too

7
00:00:16,539 --> 00:00:21,220
much blue stuff where it didn't give me

8
00:00:19,060 --> 00:00:23,560
everything I needed to know to actually

9
00:00:21,220 --> 00:00:25,869
be able to do an audit you find tools

10
00:00:23,560 --> 00:00:27,160
and they say this is how you dump the

11
00:00:25,869 --> 00:00:28,960
hashes off the domain controller here's

12
00:00:27,160 --> 00:00:31,960
the tool used to decrypt them and then

13
00:00:28,960 --> 00:00:33,760
use hash cat to crack it and then oh

14
00:00:31,960 --> 00:00:34,329
here's the beautiful report we generate

15
00:00:33,760 --> 00:00:37,960
okay

16
00:00:34,329 --> 00:00:39,879
that's fine the hard part was the

17
00:00:37,960 --> 00:00:41,379
cracking it that was the hard part

18
00:00:39,879 --> 00:00:43,860
that's the thing I actually need a lot

19
00:00:41,379 --> 00:00:43,860
of knowledge about

20
00:00:47,340 --> 00:00:53,790
Who am I Benjamin theis I nerd pretty

21
00:00:50,280 --> 00:00:56,340
hard at home I'm covering DC Hopper I've

22
00:00:53,790 --> 00:00:58,140
used just about everything I haven't

23
00:00:56,340 --> 00:01:02,490
technically used gen 2 but I counts

24
00:00:58,140 --> 00:01:03,060
Avion and my other gaming rig is the

25
00:01:02,490 --> 00:01:05,550
Raspberry Pi

26
00:01:03,060 --> 00:01:07,140
I brought the Raspberry Pi to the hotel

27
00:01:05,550 --> 00:01:08,520
room I was very excited to see that I

28
00:01:07,140 --> 00:01:10,050
could actually plug it into the TV and

29
00:01:08,520 --> 00:01:14,100
then I grabbed into my bag and found I

30
00:01:10,050 --> 00:01:16,399
forgot a controller really really sad at

31
00:01:14,100 --> 00:01:21,000
work I am a full stack full scope

32
00:01:16,400 --> 00:01:23,130
defense or one branch of a company I am

33
00:01:21,000 --> 00:01:25,430
a little weird in that I am wearing

34
00:01:23,130 --> 00:01:27,960
every hat for an entire security program

35
00:01:25,430 --> 00:01:31,200
but at a small enough scale where it's

36
00:01:27,960 --> 00:01:35,250
kind of doable for a single person kind

37
00:01:31,200 --> 00:01:37,200
of um I also have really been enjoying

38
00:01:35,250 --> 00:01:39,240
doing hunting recently

39
00:01:37,200 --> 00:01:43,040
I'm also the internal Red Team so does

40
00:01:39,240 --> 00:01:43,039
that make me a one-person purple team

41
00:01:43,520 --> 00:01:47,460
maybe um

42
00:01:45,840 --> 00:01:49,950
my approach to defense just very very

43
00:01:47,460 --> 00:01:51,928
briefly we we as defenders have the

44
00:01:49,950 --> 00:01:54,060
home-field advantage why aren't we using

45
00:01:51,929 --> 00:01:55,410
it like that's I'm very very home alone

46
00:01:54,060 --> 00:01:58,320
about this somebody else is gonna come

47
00:01:55,410 --> 00:02:00,090
into my environment and that's where the

48
00:01:58,320 --> 00:02:06,000
battle is gonna be fought let me change

49
00:02:00,090 --> 00:02:07,950
the environment to manage there why do

50
00:02:06,000 --> 00:02:10,530
we care the other thing about me being

51
00:02:07,950 --> 00:02:12,030
kind of full scope is yes the lion's

52
00:02:10,530 --> 00:02:14,130
share this talk is going to be technical

53
00:02:12,030 --> 00:02:16,200
but it's gonna be in context of your

54
00:02:14,130 --> 00:02:19,230
strategy for achieving a goal and we're

55
00:02:16,200 --> 00:02:21,480
gonna talk about what is that goal our

56
00:02:19,230 --> 00:02:22,950
goal is to frustrate attackers it is to

57
00:02:21,480 --> 00:02:24,810
take things away from them it is to

58
00:02:22,950 --> 00:02:26,880
lengthen the amount of time it takes to

59
00:02:24,810 --> 00:02:28,560
complete certain attacks you make it

60
00:02:26,880 --> 00:02:30,840
take longer that's more time for us to

61
00:02:28,560 --> 00:02:32,640
respond shut things down a better chance

62
00:02:30,840 --> 00:02:35,209
I actually do shut it down before they

63
00:02:32,640 --> 00:02:37,040
reach their end goal

64
00:02:35,209 --> 00:02:38,959
early on in the attackers lifecycle

65
00:02:37,040 --> 00:02:40,459
initial access after spraying if you

66
00:02:38,959 --> 00:02:42,620
have anything connected to Active

67
00:02:40,459 --> 00:02:45,069
Directory that is available outside from

68
00:02:42,620 --> 00:02:47,689
the internet they Outlook Web App

69
00:02:45,069 --> 00:02:49,939
anything exchange related they can

70
00:02:47,689 --> 00:02:52,219
password spray do a little research get

71
00:02:49,939 --> 00:02:55,189
a list of usernames and guess the same

72
00:02:52,219 --> 00:02:58,909
weak password right now it would be fall

73
00:02:55,189 --> 00:03:00,980
2019 bang against your in every account

74
00:02:58,909 --> 00:03:02,840
they've identified they just need one

75
00:03:00,980 --> 00:03:04,310
dump the global address list

76
00:03:02,840 --> 00:03:05,900
they now have every username in your

77
00:03:04,310 --> 00:03:07,370
entire org do a second pastors for

78
00:03:05,900 --> 00:03:09,769
against all of them you can start

79
00:03:07,370 --> 00:03:12,650
pillaging through email looking for VPN

80
00:03:09,769 --> 00:03:15,349
credentials certain certificates all

81
00:03:12,650 --> 00:03:18,409
that stuff if you find beep inserts boom

82
00:03:15,349 --> 00:03:20,268
you're in the fact your password policy

83
00:03:18,409 --> 00:03:23,239
the fact that you let somebody in your

84
00:03:20,269 --> 00:03:27,530
org have fall 2019 bag as password just

85
00:03:23,239 --> 00:03:29,300
got attackers from outside of your to in

86
00:03:27,530 --> 00:03:30,770
once you're inside there are lots of

87
00:03:29,300 --> 00:03:32,960
ways for attacks to do lateral movement

88
00:03:30,770 --> 00:03:35,090
and things a lot of them don't require

89
00:03:32,960 --> 00:03:37,970
them cracking anything but if the

90
00:03:35,090 --> 00:03:39,650
attacker can crack things that means

91
00:03:37,970 --> 00:03:41,990
they get to do it stealthier you're

92
00:03:39,650 --> 00:03:44,180
gonna be setting off more alarms if you

93
00:03:41,990 --> 00:03:45,890
just do pass the hash then if you crack

94
00:03:44,180 --> 00:03:47,440
that hash and use the legitimate

95
00:03:45,890 --> 00:03:49,820
credentials over a legitimate protocol

96
00:03:47,440 --> 00:03:53,750
so we're not completely cutting down

97
00:03:49,820 --> 00:03:55,400
lateral movement but we can make it

98
00:03:53,750 --> 00:03:58,400
harder take away the thing they would

99
00:03:55,400 --> 00:04:00,890
rather be doing um as well as like

100
00:03:58,400 --> 00:04:02,630
server hosting is a thing you can do

101
00:04:00,890 --> 00:04:04,700
it's part of the protocol there's no way

102
00:04:02,630 --> 00:04:06,950
you can patch it out but what they're

103
00:04:04,700 --> 00:04:08,959
doing is asking for a hash for a service

104
00:04:06,950 --> 00:04:11,690
account before they can use that they

105
00:04:08,959 --> 00:04:12,860
have to crack it by oughta day we're

106
00:04:11,690 --> 00:04:14,720
going to make sure we don't have any

107
00:04:12,860 --> 00:04:17,930
SuperDuper weak service accounts in our

108
00:04:14,720 --> 00:04:19,579
environment collection what if what the

109
00:04:17,930 --> 00:04:21,590
attackers after is behind a web login

110
00:04:19,579 --> 00:04:23,390
portal it is backed by a D but they

111
00:04:21,589 --> 00:04:25,460
can't directly like pass the hash into

112
00:04:23,390 --> 00:04:28,630
that thing then they need to crack the

113
00:04:25,460 --> 00:04:30,830
credentials there depending on what your

114
00:04:28,630 --> 00:04:32,450
what your crown jewels are depending

115
00:04:30,830 --> 00:04:36,140
with the attackers after they may need

116
00:04:32,450 --> 00:04:38,300
to crack a credential to get and they're

117
00:04:36,140 --> 00:04:39,590
also a few possibilities for expo you're

118
00:04:38,300 --> 00:04:40,820
really locked down you don't have too

119
00:04:39,590 --> 00:04:42,260
many things you're letting out you're

120
00:04:40,820 --> 00:04:44,870
probably living your own stuff out so

121
00:04:42,260 --> 00:04:46,490
like exchange they can use that valid

122
00:04:44,870 --> 00:04:48,350
credential just shove stuff into drafts

123
00:04:46,490 --> 00:04:51,260
use those credentials to log in pull it

124
00:04:48,350 --> 00:04:52,880
out at that point you've seen the same

125
00:04:51,260 --> 00:04:54,770
type of traffic from your legitimate

126
00:04:52,880 --> 00:04:59,090
server with a legitimate account that's

127
00:04:54,770 --> 00:05:00,320
pretty soapy and then also if you have

128
00:04:59,090 --> 00:05:03,440
cloud stuff flowed through you may or

129
00:05:00,320 --> 00:05:05,510
may not but if you do hey I've cracked

130
00:05:03,440 --> 00:05:07,520
this credential I see that this

131
00:05:05,510 --> 00:05:09,200
organization is using Dropbox for

132
00:05:07,520 --> 00:05:11,299
whatever let me see if any of these

133
00:05:09,200 --> 00:05:13,520
people are using the same username and

134
00:05:11,300 --> 00:05:16,040
that same password in Dropbox look they

135
00:05:13,520 --> 00:05:18,380
are now it's traffic you've explicitly

136
00:05:16,040 --> 00:05:20,750
allowed through with an account you from

137
00:05:18,380 --> 00:05:22,280
your organization so these are other

138
00:05:20,750 --> 00:05:24,500
things we would like attackers to not

139
00:05:22,280 --> 00:05:26,900
doing

140
00:05:24,500 --> 00:05:28,100
how do we do that so now we know why we

141
00:05:26,900 --> 00:05:30,140
would care about password security how

142
00:05:28,100 --> 00:05:32,000
are we gonna improve it there are four

143
00:05:30,140 --> 00:05:33,590
main areas I've identified that people

144
00:05:32,000 --> 00:05:35,810
use to do this some people focus on one

145
00:05:33,590 --> 00:05:37,820
I'm gonna say probably most of them are

146
00:05:35,810 --> 00:05:40,040
worth your time to look at first thing

147
00:05:37,820 --> 00:05:41,810
is training and tools the next one just

148
00:05:40,040 --> 00:05:42,260
changing your policy this is really

149
00:05:41,810 --> 00:05:43,970
important

150
00:05:42,260 --> 00:05:44,870
auditing is gonna be most of what we're

151
00:05:43,970 --> 00:05:46,160
talking about and then password

152
00:05:44,870 --> 00:05:48,460
filtering is the newer techniques to

153
00:05:46,160 --> 00:05:51,220
shown up

154
00:05:48,460 --> 00:05:53,530
any tools ultimately when it comes to

155
00:05:51,220 --> 00:05:55,270
your users password security is about

156
00:05:53,530 --> 00:05:58,270
changing their behavior you want them to

157
00:05:55,270 --> 00:05:59,799
pick strong passwords to change

158
00:05:58,270 --> 00:06:02,258
somebody's behavior you need three

159
00:05:59,800 --> 00:06:04,210
things they need to know their behavior

160
00:06:02,259 --> 00:06:05,860
needs to change they need to have the

161
00:06:04,210 --> 00:06:08,049
knowledge required to change that

162
00:06:05,860 --> 00:06:09,460
behavior and do the new behavior you

163
00:06:08,050 --> 00:06:11,650
need to have the tool as well as tools

164
00:06:09,460 --> 00:06:13,258
will also make that easier and they need

165
00:06:11,650 --> 00:06:16,870
to have the motivation to do it

166
00:06:13,259 --> 00:06:18,669
motivation is hard taking them know that

167
00:06:16,870 --> 00:06:20,650
it's their job to have good passwords

168
00:06:18,669 --> 00:06:23,289
that's straightforward include it in

169
00:06:20,650 --> 00:06:25,510
your employee onboarding a we care about

170
00:06:23,289 --> 00:06:27,310
security here you were required to have

171
00:06:25,510 --> 00:06:29,919
a secure password these are our policies

172
00:06:27,310 --> 00:06:32,680
you're required to do this reading them

173
00:06:29,919 --> 00:06:35,198
is just your nearly training have an

174
00:06:32,680 --> 00:06:37,120
onboarding training you need to do so

175
00:06:35,199 --> 00:06:38,740
that they know how to make strong

176
00:06:37,120 --> 00:06:40,720
passwords they know your recommended

177
00:06:38,740 --> 00:06:42,910
method for generating them you give them

178
00:06:40,720 --> 00:06:45,070
tools to help generate it and you give

179
00:06:42,910 --> 00:06:46,780
them a password vault installed by

180
00:06:45,070 --> 00:06:48,820
default on their workstation and new

181
00:06:46,780 --> 00:06:50,289
teachers can be using that one's

182
00:06:48,820 --> 00:06:53,580
important because it does affect

183
00:06:50,289 --> 00:06:55,330
motivation not directly but indirectly

184
00:06:53,580 --> 00:06:56,859
eventually they will figure out that

185
00:06:55,330 --> 00:06:58,150
since they have a password vault that

186
00:06:56,860 --> 00:06:59,530
means they only need to remember two

187
00:06:58,150 --> 00:07:02,320
passwords but when to log into the

188
00:06:59,530 --> 00:07:04,119
machine and when to unlock the vault all

189
00:07:02,320 --> 00:07:05,440
of the other passwords their story and

190
00:07:04,120 --> 00:07:06,580
eyebolt are now gonna be super secure

191
00:07:05,440 --> 00:07:07,659
because they don't have to remember them

192
00:07:06,580 --> 00:07:10,060
they can just keep them in the vault

193
00:07:07,659 --> 00:07:12,820
you just won as far as all of those

194
00:07:10,060 --> 00:07:14,949
passwords are concerned and no longer

195
00:07:12,820 --> 00:07:16,780
having aspirins under sticky notes no

196
00:07:14,949 --> 00:07:19,030
longer having like you all know that one

197
00:07:16,780 --> 00:07:20,409
red sheet in your organization that's

198
00:07:19,030 --> 00:07:23,590
all of the accounts and all of the

199
00:07:20,409 --> 00:07:25,930
passwords for them you know where it is

200
00:07:23,590 --> 00:07:28,000
you know which team is using it it might

201
00:07:25,930 --> 00:07:31,160
be yours

202
00:07:28,000 --> 00:07:32,990
before you pass for Vulpix is that makes

203
00:07:31,160 --> 00:07:35,720
less clean text credentials for a taxi

204
00:07:32,990 --> 00:07:39,020
village by pulling down the level of

205
00:07:35,720 --> 00:07:41,479
effort blow people's motivation you

206
00:07:39,020 --> 00:07:43,159
change their behavior so I can't force

207
00:07:41,479 --> 00:07:45,258
somebody to be motivated but I can make

208
00:07:43,160 --> 00:07:48,910
it easier for them to do the right thing

209
00:07:45,259 --> 00:07:48,910
to do the secure thing I want them to do

210
00:07:51,449 --> 00:07:58,680
policies this is one of the biggest

211
00:07:55,069 --> 00:08:01,199
screw-ups in terms of security if you

212
00:07:58,680 --> 00:08:04,319
are using 8 character minimum with a

213
00:08:01,199 --> 00:08:06,809
bunch of complexity and 90-day rotation

214
00:08:04,319 --> 00:08:08,819
you are in the worst case scenario

215
00:08:06,809 --> 00:08:10,949
because absolutely no part of that is

216
00:08:08,819 --> 00:08:14,129
securing you and part of it is making

217
00:08:10,949 --> 00:08:15,930
your grinding down your users point

218
00:08:14,129 --> 00:08:20,370
where they have no energy left to make a

219
00:08:15,930 --> 00:08:23,789
good password 8 characters is trackable

220
00:08:20,370 --> 00:08:25,680
in minutes on a pro rig if we're not

221
00:08:23,789 --> 00:08:28,949
talking a pro rig I'm gonna show you how

222
00:08:25,680 --> 00:08:33,889
to get through a majority of them in six

223
00:08:28,949 --> 00:08:33,889
days on a hundred and fifty dollar GPU

224
00:08:34,769 --> 00:08:39,479
so we need to push longer we're talking

225
00:08:36,869 --> 00:08:42,779
a pro rig anything shorter than 12 is a

226
00:08:39,479 --> 00:08:45,989
no-go right now and is crackable in I

227
00:08:42,779 --> 00:08:47,699
think weeks 11 is gonna take a few years

228
00:08:45,989 --> 00:08:50,910
but that's gonna change next year when

229
00:08:47,699 --> 00:08:53,128
the next GPU comes out right so 12 is

230
00:08:50,910 --> 00:08:54,329
the absolute minimum and for years I've

231
00:08:53,129 --> 00:08:55,350
never heard anybody who knew what

232
00:08:54,329 --> 00:08:57,270
they're talking about that said anything

233
00:08:55,350 --> 00:08:59,790
less than 12

234
00:08:57,270 --> 00:09:04,040
now I do when it comes to password

235
00:08:59,790 --> 00:09:04,040
policies it really is the length of caps

236
00:09:08,740 --> 00:09:14,779
that's going in the chip same thing

237
00:09:12,589 --> 00:09:16,819
applies to your rotation time I realize

238
00:09:14,779 --> 00:09:18,319
a lot of people particularly higher up

239
00:09:16,819 --> 00:09:21,979
in your org are gonna be really nervous

240
00:09:18,319 --> 00:09:25,790
if you try to go for no backs fast for a

241
00:09:21,980 --> 00:09:27,589
time that's fine you don't need to go

242
00:09:25,790 --> 00:09:29,629
there but you do need a lid off the

243
00:09:27,589 --> 00:09:32,060
pressure it needs to be significantly

244
00:09:29,629 --> 00:09:34,550
longer than 90 days I'm gonna recommend

245
00:09:32,060 --> 00:09:36,920
pushing up to a year that should be a

246
00:09:34,550 --> 00:09:38,870
good balance point between yes you do

247
00:09:36,920 --> 00:09:42,740
still have a maximum time a password

248
00:09:38,870 --> 00:09:45,470
will live period it's a hard limit why

249
00:09:42,740 --> 00:09:47,209
when somebody makes a password they know

250
00:09:45,470 --> 00:09:49,629
unless it gets cracked by your audit

251
00:09:47,209 --> 00:09:51,680
they get to keep it for a whole year

252
00:09:49,629 --> 00:09:53,420
because I'm recommending you do audits

253
00:09:51,680 --> 00:09:55,219
quarterly this means that you're

254
00:09:53,420 --> 00:09:57,319
changing my password always change from

255
00:09:55,220 --> 00:09:59,629
90 days into my password will have to

256
00:09:57,319 --> 00:10:01,878
change every 90 days unless I make a

257
00:09:59,629 --> 00:10:05,420
strong password then I get to keep it

258
00:10:01,879 --> 00:10:07,490
for a year and this is reframing their

259
00:10:05,420 --> 00:10:09,740
motivation and gives you an opportunity

260
00:10:07,490 --> 00:10:13,870
to change the behavior in more people um

261
00:10:09,740 --> 00:10:15,680
the the 90 day password thing is why

262
00:10:13,870 --> 00:10:18,199
password spraying is even possible

263
00:10:15,680 --> 00:10:20,120
because as you force people to rotate

264
00:10:18,199 --> 00:10:21,829
passwords they get lazier and lazier and

265
00:10:20,120 --> 00:10:23,810
lazier until they find the low-energy

266
00:10:21,829 --> 00:10:25,250
point for password password you

267
00:10:23,810 --> 00:10:28,969
literally don't even have to remember

268
00:10:25,250 --> 00:10:29,930
what your is it what season is it row

269
00:10:28,970 --> 00:10:31,610
bang on the end

270
00:10:29,930 --> 00:10:33,888
done I didn't even have to remember my

271
00:10:31,610 --> 00:10:36,970
password I can just generate it throw me

272
00:10:33,889 --> 00:10:36,970
information I have floating around

273
00:10:39,300 --> 00:10:43,050
um so what you managed to achieve in

274
00:10:41,670 --> 00:10:44,849
terms of minimum password length will

275
00:10:43,050 --> 00:10:47,310
influence your crack cracking strategy

276
00:10:44,850 --> 00:10:48,839
when you're auditing if you are stuck at

277
00:10:47,310 --> 00:10:51,750
8 characters if you're getting pushback

278
00:10:48,839 --> 00:10:53,580
for changing it to something longer your

279
00:10:51,750 --> 00:10:55,470
focus is gonna be on cracking those

280
00:10:53,580 --> 00:10:57,390
shorter passwords to demonstrate hey I

281
00:10:55,470 --> 00:10:59,730
cracked all these passwords we need this

282
00:10:57,390 --> 00:11:01,769
to be longer if you've been successful

283
00:10:59,730 --> 00:11:02,790
in pushing up to 12 or longer you're

284
00:11:01,769 --> 00:11:03,959
gonna have a different thing and that's

285
00:11:02,790 --> 00:11:05,430
gonna be all right what is an attacker

286
00:11:03,959 --> 00:11:06,839
who knows that gonna do how do I

287
00:11:05,430 --> 00:11:09,780
replicate that how do I crack the same

288
00:11:06,839 --> 00:11:11,160
passwords in actual attack

289
00:11:09,780 --> 00:11:14,970
that's weird auditing is closed this

290
00:11:11,160 --> 00:11:17,130
talk pretty simple dump ashes crack them

291
00:11:14,970 --> 00:11:18,690
anybody they you crack their password

292
00:11:17,130 --> 00:11:20,460
you're using the same technique an

293
00:11:18,690 --> 00:11:21,570
attacker would if you can crack it a

294
00:11:20,460 --> 00:11:22,260
real attacker would have been able to

295
00:11:21,570 --> 00:11:23,610
crack it too

296
00:11:22,260 --> 00:11:25,800
that person needs to rotate their

297
00:11:23,610 --> 00:11:27,690
password look at what they did just a

298
00:11:25,800 --> 00:11:29,670
little bit of the information about like

299
00:11:27,690 --> 00:11:31,710
hey I saw you use a song lyric as your

300
00:11:29,670 --> 00:11:33,180
password I realized it's long enough but

301
00:11:31,710 --> 00:11:34,290
you use something that's Gessle you use

302
00:11:33,180 --> 00:11:35,849
something somebody can just download

303
00:11:34,290 --> 00:11:38,699
manipulate a little bit and guess it

304
00:11:35,850 --> 00:11:41,610
need to have it be random or hey this is

305
00:11:38,700 --> 00:11:44,400
your favorite bible verse come on I

306
00:11:41,610 --> 00:11:46,830
don't recommend like a three-strike on a

307
00:11:44,400 --> 00:11:48,689
thing or any kind of real punishment for

308
00:11:46,830 --> 00:11:51,660
this ideally you're gonna be way too

309
00:11:48,690 --> 00:11:54,240
successful for that to be a thing if for

310
00:11:51,660 --> 00:11:56,490
many audits in a row somebody is failing

311
00:11:54,240 --> 00:11:58,800
every single one and on a case-by-case

312
00:11:56,490 --> 00:12:00,000
basis maybe take some remedial action

313
00:11:58,800 --> 00:12:01,520
but I wouldn't go straight for like

314
00:12:00,000 --> 00:12:05,100
though it's three strikes and you get a

315
00:12:01,520 --> 00:12:07,550
some kind of punishment I just recommend

316
00:12:05,100 --> 00:12:07,550
education

317
00:12:08,480 --> 00:12:11,720
that's where filtering is a little bit

318
00:12:09,890 --> 00:12:14,270
newer it's recommended by the newness

319
00:12:11,720 --> 00:12:16,040
stand where standard at creation time do

320
00:12:14,270 --> 00:12:17,900
not allowed known compromised password I

321
00:12:16,040 --> 00:12:20,180
don't actually think that's possible

322
00:12:17,900 --> 00:12:21,350
given the fact that the list of known

323
00:12:20,180 --> 00:12:25,099
compromised passwords I'm gonna

324
00:12:21,350 --> 00:12:26,300
recommend you use like 20 gigs I don't I

325
00:12:25,100 --> 00:12:28,220
don't see your domain controller

326
00:12:26,300 --> 00:12:30,800
searching through 20 gigs of text for an

327
00:12:28,220 --> 00:12:33,310
exact match and not timing out fast word

328
00:12:30,800 --> 00:12:35,930
creation process but we can try

329
00:12:33,310 --> 00:12:37,489
it's never gonna cover auditing it's

330
00:12:35,930 --> 00:12:39,229
never gonna replace auditing they're

331
00:12:37,490 --> 00:12:41,330
complementary they don't replace each

332
00:12:39,230 --> 00:12:43,100
other some of the software I've seen out

333
00:12:41,330 --> 00:12:45,200
there is soft mattress a listen no

334
00:12:43,100 --> 00:12:48,140
password those will be accepted if it is

335
00:12:45,200 --> 00:12:49,670
more than 80% similar to this list of

336
00:12:48,140 --> 00:12:51,319
passwords I think that's really good

337
00:12:49,670 --> 00:12:52,670
because that is starting to cover some

338
00:12:51,320 --> 00:12:54,770
of the wiggle room that you're covering

339
00:12:52,670 --> 00:12:56,300
with auditing so there must not contain

340
00:12:54,770 --> 00:12:57,680
it would be really great for like hey

341
00:12:56,300 --> 00:12:59,500
I've cracked bunch of passwords I see

342
00:12:57,680 --> 00:13:01,790
that everybody's using the company name

343
00:12:59,500 --> 00:13:04,300
let's just lat let people use the

344
00:13:01,790 --> 00:13:04,300
company name

345
00:13:04,670 --> 00:13:07,339
and then some of these also come with

346
00:13:05,840 --> 00:13:08,930
really advanced password tools someone

347
00:13:07,340 --> 00:13:11,210
come with like strike meters and other

348
00:13:08,930 --> 00:13:11,589
things there's a good stuff to be had

349
00:13:11,210 --> 00:13:14,990
here

350
00:13:11,590 --> 00:13:16,670
have you got right now until Microsoft

351
00:13:14,990 --> 00:13:20,000
supports this natively in Active

352
00:13:16,670 --> 00:13:21,949
Directory you're going to have to grab a

353
00:13:20,000 --> 00:13:24,260
DLL and stick it onto the main

354
00:13:21,950 --> 00:13:26,360
controller if that third-party DLL

355
00:13:24,260 --> 00:13:27,920
crashes it will crash else ass'll the

356
00:13:26,360 --> 00:13:29,330
domain controller so if you go to your

357
00:13:27,920 --> 00:13:32,660
IT team and say hey we want to do then

358
00:13:29,330 --> 00:13:34,400
they go no there's a reason they're

359
00:13:32,660 --> 00:13:36,770
telling you no it's because there's a

360
00:13:34,400 --> 00:13:38,600
lot of risk there crash as it goes down

361
00:13:36,770 --> 00:13:39,740
if they upgrade in the DLL is no longer

362
00:13:38,600 --> 00:13:41,480
compatible with a new version you're

363
00:13:39,740 --> 00:13:44,570
gonna have problems and is a bad day for

364
00:13:41,480 --> 00:13:46,790
everybody this is a I'm pretty Pro

365
00:13:44,570 --> 00:13:50,180
open-source but this is a case where I

366
00:13:46,790 --> 00:13:51,469
would look carefully into the project

367
00:13:50,180 --> 00:13:53,780
make sure it's well maintained before

368
00:13:51,470 --> 00:13:55,850
deploying it period and where you might

369
00:13:53,780 --> 00:13:58,209
actually want to go for a commercial

370
00:13:55,850 --> 00:14:01,810
solution that has some support behind it

371
00:13:58,210 --> 00:14:01,810
look before you

372
00:14:02,970 --> 00:14:05,730
gonna talk about different maturity

373
00:14:04,319 --> 00:14:07,769
levels in terms of password cracking you

374
00:14:05,730 --> 00:14:09,990
can pick what's right for your org I

375
00:14:07,769 --> 00:14:11,250
think basically every organization I can

376
00:14:09,990 --> 00:14:14,069
think about the planet should at least

377
00:14:11,250 --> 00:14:15,899
be at the one-hour level because it is

378
00:14:14,069 --> 00:14:18,000
very very little additional effort once

379
00:14:15,899 --> 00:14:20,220
you already dump the hashes you check

380
00:14:18,000 --> 00:14:22,589
them against known compromised ones that

381
00:14:20,220 --> 00:14:25,139
is the five minute on it just sit there

382
00:14:22,589 --> 00:14:26,399
and guess the obvious thing just give a

383
00:14:25,139 --> 00:14:28,699
little good to cover and see what you

384
00:14:26,399 --> 00:14:30,810
can do in one hour one hour real time

385
00:14:28,699 --> 00:14:32,430
not that much I think everybody should

386
00:14:30,810 --> 00:14:34,018
be there but if you want to do more than

387
00:14:32,430 --> 00:14:38,250
that you can you pick where you want to

388
00:14:34,019 --> 00:14:39,600
be on those security levels I'm in an

389
00:14:38,250 --> 00:14:42,120
audit we're just checking whether or not

390
00:14:39,600 --> 00:14:44,220
the hash is known compromise perfect

391
00:14:42,120 --> 00:14:46,589
exact match one hour

392
00:14:44,220 --> 00:14:49,680
we're gonna go through high probability

393
00:14:46,589 --> 00:14:53,370
passwords with some good password rules

394
00:14:49,680 --> 00:14:56,370
and that's about all we're gonna do

395
00:14:53,370 --> 00:14:58,620
if you've got a weekend on Friday you do

396
00:14:56,370 --> 00:15:00,480
the one hour audit and then you set a

397
00:14:58,620 --> 00:15:02,820
bunch of things to leave running over

398
00:15:00,480 --> 00:15:04,710
the weekend let it run over the weekend

399
00:15:02,820 --> 00:15:06,300
and then you check them on Monday and

400
00:15:04,710 --> 00:15:07,590
now you've got some crack patchwork

401
00:15:06,300 --> 00:15:09,000
passwords you're gonna find related

402
00:15:07,590 --> 00:15:10,110
passwords you just gonna take that list

403
00:15:09,000 --> 00:15:11,700
of crack passwords and you're gonna

404
00:15:10,110 --> 00:15:14,730
shove it through some more stuff crack

405
00:15:11,700 --> 00:15:16,320
related passwords continuous auditing

406
00:15:14,730 --> 00:15:18,180
what I mean by that is just after you're

407
00:15:16,320 --> 00:15:19,860
done with that process leave it running

408
00:15:18,180 --> 00:15:21,780
until the next audit you will need a

409
00:15:19,860 --> 00:15:23,520
dedicated box for this this is where you

410
00:15:21,780 --> 00:15:25,980
might want to consider pinning a little

411
00:15:23,520 --> 00:15:28,860
bit of money or a little bit of nicer

412
00:15:25,980 --> 00:15:31,110
GPU if you want to be at that level of

413
00:15:28,860 --> 00:15:32,240
maturity not don't worry about it you

414
00:15:31,110 --> 00:15:34,530
pick where you want to exist on this

415
00:15:32,240 --> 00:15:37,590
when you leave that running it's gonna

416
00:15:34,530 --> 00:15:39,600
crack a few hashes you then add those to

417
00:15:37,590 --> 00:15:41,760
your list you check make sure those

418
00:15:39,600 --> 00:15:44,750
things are still active you crack more

419
00:15:41,760 --> 00:15:44,750
stuff you've got more common

420
00:15:45,490 --> 00:15:49,480
what are we gonna need to do this

421
00:15:46,570 --> 00:15:51,310
hardware I'm recommending an NVIDIA GPU

422
00:15:49,480 --> 00:15:53,070
there's this good cat compatibility and

423
00:15:51,310 --> 00:15:55,390
I'm recommending you stick with Windows

424
00:15:53,070 --> 00:15:57,839
Linux guy is telling you to stick with

425
00:15:55,390 --> 00:15:57,839
Windows

426
00:16:00,200 --> 00:16:04,700
you're pretty much guaranteed it's going

427
00:16:01,820 --> 00:16:07,040
to install and any newer Nvidia driver

428
00:16:04,700 --> 00:16:09,110
is going to give you open CL which is

429
00:16:07,040 --> 00:16:11,719
the thing that lets you do random

430
00:16:09,110 --> 00:16:14,930
calculations on hardware what lets you

431
00:16:11,720 --> 00:16:17,000
do work on a GPU just if you've never

432
00:16:14,930 --> 00:16:18,500
built a PC before you're gonna need to

433
00:16:17,000 --> 00:16:19,910
make sure you have enough power this is

434
00:16:18,500 --> 00:16:21,200
our only really relevant if you doing a

435
00:16:19,910 --> 00:16:22,430
V for your car and you're gonna need to

436
00:16:21,200 --> 00:16:23,840
make sure it has a slot open which it

437
00:16:22,430 --> 00:16:27,589
almost certainly welcome make sure the

438
00:16:23,840 --> 00:16:28,940
card also physically fits into it all of

439
00:16:27,590 --> 00:16:30,590
the cracking times I'm gonna give you

440
00:16:28,940 --> 00:16:33,410
are either baby unless otherwise

441
00:16:30,590 --> 00:16:34,730
specified or for a gtx 1050 that's about

442
00:16:33,410 --> 00:16:37,689
a hundred and fifty dollar card

443
00:16:34,730 --> 00:16:40,340
I found one laying around where I work

444
00:16:37,690 --> 00:16:42,200
so scrounge around see what you can find

445
00:16:40,340 --> 00:16:43,790
you can use whatever you can find you

446
00:16:42,200 --> 00:16:45,770
can use multiple if you have a couple

447
00:16:43,790 --> 00:16:47,719
like I could have scratched a couple of

448
00:16:45,770 --> 00:16:49,220
seven forties and use both of those

449
00:16:47,720 --> 00:16:51,410
would have got me in the same place but

450
00:16:49,220 --> 00:16:53,330
see what you can scrounge see what you

451
00:16:51,410 --> 00:16:55,040
can buy figure out quite at like say hey

452
00:16:53,330 --> 00:16:56,930
we're doing this what's our budget can I

453
00:16:55,040 --> 00:16:59,569
spend this much money spend this much

454
00:16:56,930 --> 00:17:01,219
money and you're gonna go buy that but

455
00:16:59,570 --> 00:17:03,760
you can do this without spending any

456
00:17:01,220 --> 00:17:03,760
upfront money

457
00:17:04,319 --> 00:17:08,158
software hash cat this is going to be

458
00:17:06,539 --> 00:17:09,839
the thing we use to crack the hash

459
00:17:08,159 --> 00:17:12,299
you're gonna see a lot of hash cat

460
00:17:09,839 --> 00:17:16,049
prints processor is a tool that will do

461
00:17:12,299 --> 00:17:18,599
combinations of words so if you I wanted

462
00:17:16,049 --> 00:17:22,168
to do every possible combination of five

463
00:17:18,599 --> 00:17:23,099
words between eight characters and you

464
00:17:22,169 --> 00:17:26,039
know twelve characters

465
00:17:23,099 --> 00:17:27,569
prince2 let me do that back in something

466
00:17:26,039 --> 00:17:30,360
as optional this will analyze existing

467
00:17:27,569 --> 00:17:32,070
passwords and generate you masks this is

468
00:17:30,360 --> 00:17:35,158
how you get something that you know is

469
00:17:32,070 --> 00:17:36,809
statistically good what percentage of

470
00:17:35,159 --> 00:17:37,769
some of these passwords can i crack in

471
00:17:36,809 --> 00:17:40,168
ten minutes

472
00:17:37,769 --> 00:17:41,190
ACK tell me how many can i crack in ten

473
00:17:40,169 --> 00:17:42,779
minutes well you can crack to these

474
00:17:41,190 --> 00:17:45,320
three masks in ten that's great give me

475
00:17:42,779 --> 00:17:45,320
those three masks

476
00:17:45,330 --> 00:17:50,220
this is where how you do actual root or

477
00:17:48,629 --> 00:17:51,509
we'll talking worry about that but

478
00:17:50,220 --> 00:17:52,950
nobody does brute force everybody use

479
00:17:51,509 --> 00:17:54,480
masks how do I know I'm tracking the

480
00:17:52,950 --> 00:17:56,129
right mask you have a tool that

481
00:17:54,480 --> 00:17:59,460
generates you the statistically best one

482
00:17:56,129 --> 00:18:00,509
um n TST does it is the file on the

483
00:17:59,460 --> 00:18:02,519
domain controller it actually contains

484
00:18:00,509 --> 00:18:05,129
the hashes it's encrypted

485
00:18:02,519 --> 00:18:09,710
of course it's Microsoft so anybody want

486
00:18:05,129 --> 00:18:09,709
to guess where the encryption key is

487
00:18:10,040 --> 00:18:14,000
right next to it in the registry same

488
00:18:12,260 --> 00:18:16,780
command of the dumps this also dumps

489
00:18:14,000 --> 00:18:16,780
that registry hive

490
00:18:17,000 --> 00:18:20,419
oh but you will need a tool to decrypt

491
00:18:18,530 --> 00:18:22,549
it cracked is gonna show up three times

492
00:18:20,419 --> 00:18:24,440
in this list one of the things that

493
00:18:22,549 --> 00:18:27,020
we'll do is decrypt that you can also

494
00:18:24,440 --> 00:18:30,950
use and packet and if you want to go

495
00:18:27,020 --> 00:18:32,480
power show you have TSI intern hash

496
00:18:30,950 --> 00:18:34,220
comparison tool but five minute on it

497
00:18:32,480 --> 00:18:37,070
we're taking a list of compromised

498
00:18:34,220 --> 00:18:38,659
hashes and we're taking a list of our

499
00:18:37,070 --> 00:18:40,850
internal hashes and I'm gonna compare

500
00:18:38,659 --> 00:18:42,530
them these are tools that'll do it

501
00:18:40,850 --> 00:18:44,270
the five-minute password audit does that

502
00:18:42,530 --> 00:18:45,830
offline you just download both files

503
00:18:44,270 --> 00:18:47,629
like you have your file and you download

504
00:18:45,830 --> 00:18:50,000
another one you just compare completely

505
00:18:47,630 --> 00:18:53,720
offline completely private practice will

506
00:18:50,000 --> 00:18:55,820
do anonymity to a cloud service to check

507
00:18:53,720 --> 00:18:58,159
it if you don't know what that means

508
00:18:55,820 --> 00:19:00,110
that don't do that you don't understand

509
00:18:58,159 --> 00:19:02,090
what data that is leaking about your

510
00:19:00,110 --> 00:19:03,260
environment don't do that I'm gonna

511
00:19:02,090 --> 00:19:04,970
recommend you just do the offline

512
00:19:03,260 --> 00:19:06,379
version because a you're guaranteed to

513
00:19:04,970 --> 00:19:07,549
be allowed depending on your company you

514
00:19:06,380 --> 00:19:09,020
may not be allowed to use the cloud

515
00:19:07,549 --> 00:19:17,510
service that way or something like your

516
00:19:09,020 --> 00:19:18,889
password something later anyway auditing

517
00:19:17,510 --> 00:19:23,419
tools is completely optional you can by

518
00:19:18,890 --> 00:19:26,090
hand just compare in hash this hash and

519
00:19:23,419 --> 00:19:27,620
password they line up okay I know this

520
00:19:26,090 --> 00:19:30,080
person was compromised with this

521
00:19:27,620 --> 00:19:31,879
password you can do that by hand if you

522
00:19:30,080 --> 00:19:34,750
don't want to do that my hand cracked it

523
00:19:31,880 --> 00:19:36,890
and Gpad will cover that same password

524
00:19:34,750 --> 00:19:38,450
and then you will need a BitTorrent

525
00:19:36,890 --> 00:19:41,840
client for this if you have never

526
00:19:38,450 --> 00:19:44,990
torrent it anything before not scary not

527
00:19:41,840 --> 00:19:46,699
illegal and transmission is one that I

528
00:19:44,990 --> 00:19:47,990
can give a thumbs up to but if you've

529
00:19:46,700 --> 00:19:49,800
toured in something before use whatever

530
00:19:47,990 --> 00:19:51,510
you think

531
00:19:49,800 --> 00:19:54,210
weird list these are our lists of

532
00:19:51,510 --> 00:19:55,200
Internet passwords in fact every word

533
00:19:54,210 --> 00:19:57,360
list we're going to use here is

534
00:19:55,200 --> 00:20:00,450
candidate passwords except for Google's

535
00:19:57,360 --> 00:20:02,729
list of top English words

536
00:20:00,450 --> 00:20:07,250
um the real passwords when probable

537
00:20:02,730 --> 00:20:07,250
passwords is statistically significant

538
00:20:07,410 --> 00:20:11,370
I will they have a copy of my slide so I

539
00:20:10,230 --> 00:20:13,170
don't know how b-sides hands them out

540
00:20:11,370 --> 00:20:14,760
and I'm also going to put these on

541
00:20:13,170 --> 00:20:16,320
github I apologize for not doing that

542
00:20:14,760 --> 00:20:19,230
before the talk but I didn't have the

543
00:20:16,320 --> 00:20:21,510
opportunity Rob award list is

544
00:20:19,230 --> 00:20:24,030
statistically significant their lowest

545
00:20:21,510 --> 00:20:26,970
threshold is that five different dumps

546
00:20:24,030 --> 00:20:29,670
had the password

547
00:20:26,970 --> 00:20:31,500
that's their lowest threshold the most

548
00:20:29,670 --> 00:20:34,880
probable ones were far far more than

549
00:20:31,500 --> 00:20:36,990
that so it is a giant list of the most

550
00:20:34,880 --> 00:20:39,750
statistically significant passwords all

551
00:20:36,990 --> 00:20:41,160
the way to ones that were only five

552
00:20:39,750 --> 00:20:44,250
different people across five different

553
00:20:41,160 --> 00:20:47,580
dumps this is your biggest bang for your

554
00:20:44,250 --> 00:20:50,430
buck wordless passphrase word list if we

555
00:20:47,580 --> 00:20:51,830
are pushing for 12 plus characters we're

556
00:20:50,430 --> 00:20:56,049
going to be start using pass phrases I

557
00:20:51,830 --> 00:20:57,908
guess I'm training them to pass phrases

558
00:20:56,049 --> 00:21:01,149
passphrase word list contains the lazy

559
00:20:57,909 --> 00:21:06,159
passphrases song lyrics poppy dia quotes

560
00:21:01,149 --> 00:21:08,229
all that stuff potent passwords into him

561
00:21:06,159 --> 00:21:09,580
murdered by Count that's actually our

562
00:21:08,230 --> 00:21:11,139
hash list we're gonna use for the five

563
00:21:09,580 --> 00:21:12,249
minute audit not technically worthless

564
00:21:11,139 --> 00:21:16,418
but didn't know where else to put it

565
00:21:12,249 --> 00:21:18,039
crack station peak pass and reach

566
00:21:16,419 --> 00:21:20,970
compilation are all just when we be

567
00:21:18,039 --> 00:21:20,970
really big list

568
00:21:21,710 --> 00:21:27,380
later cyclists contains all kinds of

569
00:21:25,460 --> 00:21:29,750
useful things it includes your standard

570
00:21:27,380 --> 00:21:32,120
everybody talks about rock you rock you

571
00:21:29,750 --> 00:21:33,680
in a tutorial for password cracking you

572
00:21:32,120 --> 00:21:35,659
don't know where to grab a copy there's

573
00:21:33,680 --> 00:21:38,480
a place you can grab a copy and then

574
00:21:35,660 --> 00:21:40,070
Google's about ten thousand words is the

575
00:21:38,480 --> 00:21:42,340
only list of actual words in our whistle

576
00:21:40,070 --> 00:21:42,340
wordless

577
00:21:43,870 --> 00:21:50,799
rules rules are he's a manipulating an

578
00:21:47,350 --> 00:21:52,990
input password in my way my I do a head

579
00:21:50,799 --> 00:21:56,200
different Who am I joke every single I'm

580
00:21:52,990 --> 00:21:58,840
this one it's elite speak who am i how

581
00:21:56,200 --> 00:22:00,490
do I take am I and turn it into the lead

582
00:21:58,840 --> 00:22:03,100
speaker there's a rule for that

583
00:22:00,490 --> 00:22:04,720
it's just onion mango or green yeah

584
00:22:03,100 --> 00:22:06,730
passwords they're a multiplier for your

585
00:22:04,720 --> 00:22:10,270
guesses if you're just reading a word

586
00:22:06,730 --> 00:22:12,520
list is not fully usable oh you know

587
00:22:10,270 --> 00:22:14,139
rule lets you fully utilize it the only

588
00:22:12,520 --> 00:22:16,629
one I'm going to say is required is one

589
00:22:14,140 --> 00:22:18,429
rule to rule them all it is

590
00:22:16,630 --> 00:22:20,590
statistically your best bang for your

591
00:22:18,429 --> 00:22:21,909
buck in terms of rule the other rule I'm

592
00:22:20,590 --> 00:22:25,510
going to say is required is gonna come

593
00:22:21,909 --> 00:22:27,820
to pass cat optional little rules the

594
00:22:25,510 --> 00:22:29,169
NSA rule said and then notice probable

595
00:22:27,820 --> 00:22:30,549
word list is here again they do the

596
00:22:29,169 --> 00:22:35,470
statistical analysis of it and made a

597
00:22:30,549 --> 00:22:38,830
bunch of rule Israeli optional grab if

598
00:22:35,470 --> 00:22:41,970
you want to tracking techniques first

599
00:22:38,830 --> 00:22:41,970
one and the biggest one we're gonna do

600
00:22:43,790 --> 00:22:47,060
what word lists are gonna be paying to

601
00:22:45,980 --> 00:22:48,410
them I'd have some stuff there you're

602
00:22:47,060 --> 00:22:50,240
gonna have rules that are going to swap

603
00:22:48,410 --> 00:22:52,130
the characters out such as leaps decline

604
00:22:50,240 --> 00:22:54,830
your abs are gonna pen things at the end

605
00:22:52,130 --> 00:22:58,110
just to cover and or they could be

606
00:22:54,830 --> 00:23:00,510
appending a specific thing like a date

607
00:22:58,110 --> 00:23:01,709
fools are really really powerful this is

608
00:23:00,510 --> 00:23:03,120
the first thing that any like

609
00:23:01,710 --> 00:23:04,200
professional cracking company is going

610
00:23:03,120 --> 00:23:05,909
to do this is the first thing you're a

611
00:23:04,200 --> 00:23:08,490
red team is gonna do is they have their

612
00:23:05,910 --> 00:23:09,690
preferred word list their preferred set

613
00:23:08,490 --> 00:23:11,840
of rules and they're gonna run the word

614
00:23:09,690 --> 00:23:11,840
with

615
00:23:13,750 --> 00:23:15,810
you

616
00:23:16,130 --> 00:23:21,450
accommodator Combinator is how you do

617
00:23:19,710 --> 00:23:22,740
unless we're list on the right do every

618
00:23:21,450 --> 00:23:25,220
possible combination that's how you do

619
00:23:22,740 --> 00:23:25,220
it Doody

620
00:23:27,170 --> 00:23:33,820
like ash cat with its Combinator attack

621
00:23:29,510 --> 00:23:33,820
we'll only due to some other limitations

622
00:23:34,570 --> 00:23:37,539
it says you're supposed to be able to

623
00:23:35,979 --> 00:23:39,190
apply a rule to each list before you go

624
00:23:37,539 --> 00:23:42,669
in I could only get it to work on the

625
00:23:39,190 --> 00:23:44,889
right and you're limited to only two

626
00:23:42,669 --> 00:23:47,649
words Steve Prince fixes this furnace

627
00:23:44,889 --> 00:23:49,149
will do any combination up to the length

628
00:23:47,649 --> 00:23:51,549
you want you can say give me everything

629
00:23:49,149 --> 00:23:54,238
from five words and make sure you're

630
00:23:51,549 --> 00:23:57,129
only giving me outputs that are between

631
00:23:54,239 --> 00:24:01,719
you do that and if you don't cap it

632
00:23:57,129 --> 00:24:03,549
it'll run forever going forever um it is

633
00:24:01,719 --> 00:24:04,659
being piped into hash get this is good

634
00:24:03,549 --> 00:24:06,519
things and it has bad things the good

635
00:24:04,659 --> 00:24:08,499
thing is anything hash cut can do you

636
00:24:06,519 --> 00:24:12,639
can do you I would attack you can also

637
00:24:08,499 --> 00:24:14,079
just talking about downside pipe seems

638
00:24:12,639 --> 00:24:15,369
to cause weird performance issues I can

639
00:24:14,079 --> 00:24:17,109
never get it to actually do full

640
00:24:15,369 --> 00:24:18,579
utilization so if we have any password

641
00:24:17,109 --> 00:24:20,908
cracking in the house the one who tell

642
00:24:18,579 --> 00:24:20,908
me what's up

643
00:24:21,350 --> 00:24:26,149
your print this is what we're actually

644
00:24:23,269 --> 00:24:27,799
gonna do with Dominator imprints once I

645
00:24:26,149 --> 00:24:29,330
have cracked a bunch of passwords how do

646
00:24:27,799 --> 00:24:30,860
I get more passwords out of them how do

647
00:24:29,330 --> 00:24:33,939
i turn my small list of passwords into a

648
00:24:30,860 --> 00:24:36,289
list a password related password attacks

649
00:24:33,940 --> 00:24:39,139
fingerprints make sure I'm gonna call it

650
00:24:36,289 --> 00:24:40,399
a golden dictionary points that anybody

651
00:24:39,139 --> 00:24:43,250
who knows why I call it a golden

652
00:24:40,399 --> 00:24:44,809
dictionary is all of the passwords

653
00:24:43,250 --> 00:24:46,309
you've already crashed I'm gonna take

654
00:24:44,809 --> 00:24:49,580
that you're gonna push it through a tool

655
00:24:46,309 --> 00:24:51,168
called expander that will rotate for

656
00:24:49,580 --> 00:24:53,509
different character combinations and

657
00:24:51,169 --> 00:24:55,100
will chop it into just length so you're

658
00:24:53,509 --> 00:24:57,080
gonna do every combination of those

659
00:24:55,100 --> 00:25:00,259
blanks a Combinator you're gonna get

660
00:24:57,080 --> 00:25:02,629
every combination of like words prints

661
00:25:00,259 --> 00:25:05,360
can do whatever you want

662
00:25:02,630 --> 00:25:06,830
this is a great thing to do once you

663
00:25:05,360 --> 00:25:08,570
already have some passwords to find more

664
00:25:06,830 --> 00:25:10,610
because an attackers gonna do this and

665
00:25:08,570 --> 00:25:12,800
attackers gonna find related password

666
00:25:10,610 --> 00:25:15,020
somebody had an old password they change

667
00:25:12,800 --> 00:25:17,470
it and minorly how you find their new

668
00:25:15,020 --> 00:25:17,470
password

669
00:25:18,220 --> 00:25:23,919
asks our what people are actually doing

670
00:25:20,200 --> 00:25:25,330
when they talk about pick a pattern you

671
00:25:23,919 --> 00:25:27,909
only crack things within that pattern

672
00:25:25,330 --> 00:25:30,010
pretty simple four-digit pin we're only

673
00:25:27,909 --> 00:25:32,740
going to do things of exactly like four

674
00:25:30,010 --> 00:25:34,450
and we're gonna do every digit bambbles

675
00:25:32,740 --> 00:25:36,340
on that they wanted to crack passwords

676
00:25:34,450 --> 00:25:40,809
one or password

677
00:25:36,340 --> 00:25:43,850
ooh more secure gonna do lowercase R

678
00:25:40,809 --> 00:25:47,960
eight characters and then one day

679
00:25:43,850 --> 00:25:51,678
and generate these with axe with the

680
00:25:47,960 --> 00:25:53,859
most statistically difficult one on

681
00:25:51,679 --> 00:25:56,210
analyzing a list of crack passwords over

682
00:25:53,859 --> 00:25:58,189
gonna take advantage up here to be able

683
00:25:56,210 --> 00:26:00,559
to say alright what do I want to do if I

684
00:25:58,190 --> 00:26:05,019
want to have a bit coverage of 8

685
00:26:00,559 --> 00:26:05,019
characters a pack gives me everything

686
00:26:06,460 --> 00:26:11,320
so let you get longer than brute force

687
00:26:08,049 --> 00:26:12,460
so us on our brown store budget at

688
00:26:11,320 --> 00:26:14,559
cracking regs are not gonna be able to

689
00:26:12,460 --> 00:26:16,330
prove all of eight characters but we can

690
00:26:14,559 --> 00:26:18,870
get good coverage of the patterns people

691
00:26:16,330 --> 00:26:18,870
actually

692
00:26:19,670 --> 00:26:22,910
and if you want to push longer than that

693
00:26:21,110 --> 00:26:25,240
you can you're just not gonna be able to

694
00:26:22,910 --> 00:26:25,240
do as many

695
00:26:27,130 --> 00:26:30,400
well let's get into how we actually do

696
00:26:28,630 --> 00:26:37,000
this step one is to grab and decrypt the

697
00:26:30,400 --> 00:26:38,380
hashes envyus NTDs hill if you just run

698
00:26:37,000 --> 00:26:40,809
it it'll drop you into a shell and you

699
00:26:38,380 --> 00:26:42,970
can type these commands manually want to

700
00:26:40,809 --> 00:26:45,580
do it all in one line you can put L

701
00:26:42,970 --> 00:26:47,830
input onto it this is going to give you

702
00:26:45,580 --> 00:26:50,260
each amp is your output you just say

703
00:26:47,830 --> 00:26:51,610
this taking a backup of a lot of

704
00:26:50,260 --> 00:26:53,770
important stuff in the Tipene controller

705
00:26:51,610 --> 00:26:56,740
or to us includes the file that has the

706
00:26:53,770 --> 00:27:01,840
ashes in it and it includes system hive

707
00:26:56,740 --> 00:27:03,640
as practice there as I mentioned there

708
00:27:01,840 --> 00:27:07,840
other tools you can do this with give it

709
00:27:03,640 --> 00:27:10,320
the pass through that system hive will

710
00:27:07,840 --> 00:27:10,320
decrypt it

711
00:27:11,460 --> 00:27:18,860
it

712
00:27:13,340 --> 00:27:20,840
downloaded and archived are at UM list

713
00:27:18,860 --> 00:27:23,120
they import this I know somebody would

714
00:27:20,840 --> 00:27:25,639
complain that it didn't work if I didn't

715
00:27:23,120 --> 00:27:27,530
letting the execution policy we're gonna

716
00:27:25,640 --> 00:27:29,240
import it we're gonna run it it's gonna

717
00:27:27,530 --> 00:27:31,520
give you a list of every account that

718
00:27:29,240 --> 00:27:33,500
matches an own publicly compromised pack

719
00:27:31,520 --> 00:27:35,030
so you know what the password is but you

720
00:27:33,500 --> 00:27:37,540
know it's actually compromised out there

721
00:27:35,030 --> 00:27:37,540
somewhere

722
00:27:38,820 --> 00:27:42,269
spend a little bit more time on this

723
00:27:40,349 --> 00:27:44,980
we'll all complete within an hour most

724
00:27:42,269 --> 00:27:48,580
of these are delayed two to five minutes

725
00:27:44,980 --> 00:27:52,360
- cat daddy exceed what we're using -

726
00:27:48,580 --> 00:27:54,909
uppercase o optimize this makes it run

727
00:27:52,360 --> 00:27:58,010
like 10 times faster outside you can't

728
00:27:54,910 --> 00:27:59,810
do anything over 27 characters

729
00:27:58,010 --> 00:28:02,480
the vast majority of our things that's a

730
00:27:59,810 --> 00:28:05,960
trade-off were willing to make em is the

731
00:28:02,480 --> 00:28:08,090
type of hash in this case is in a clean

732
00:28:05,960 --> 00:28:10,480
ntlm hash so that's one thousand for the

733
00:28:08,090 --> 00:28:10,480
coat

734
00:28:11,500 --> 00:28:16,450
your pod file is your output hashes

735
00:28:13,870 --> 00:28:18,668
we're it's saving what it cracks and

736
00:28:16,450 --> 00:28:21,309
then use names because we're doing user

737
00:28:18,669 --> 00:28:23,590
name password format for our output we

738
00:28:21,309 --> 00:28:25,210
million hey this is a bat format and

739
00:28:23,590 --> 00:28:27,639
ashes that takes T is all the things you

740
00:28:25,210 --> 00:28:30,009
jump we're gonna take in a word list in

741
00:28:27,639 --> 00:28:33,309
this case it's the biggest bird list in

742
00:28:30,009 --> 00:28:36,230
our probable word list everything in

743
00:28:33,309 --> 00:28:38,418
there is at least five different

744
00:28:36,230 --> 00:28:41,299
five people across five different public

745
00:28:38,419 --> 00:28:43,580
dumps that password and then we're gonna

746
00:28:41,299 --> 00:28:47,870
run a rule on it that's 64 comes with

747
00:28:43,580 --> 00:28:50,418
hash Kat was at one point that's the

748
00:28:47,870 --> 00:28:51,918
rules and it's still really solid it's a

749
00:28:50,419 --> 00:28:53,870
lightweight rule it's gonna run pretty

750
00:28:51,919 --> 00:28:56,559
fast even though this is a big list so

751
00:28:53,870 --> 00:28:56,559
going to complete

752
00:28:58,790 --> 00:29:02,180
next we're gonna cover our passphrases

753
00:29:00,470 --> 00:29:04,460
hopefully we're at 12 plots characters

754
00:29:02,180 --> 00:29:08,440
hopefully people aren't using the same

755
00:29:04,460 --> 00:29:08,440
we allowed

756
00:29:09,890 --> 00:29:13,040
that doesn't mean they're gonna start

757
00:29:11,270 --> 00:29:16,790
doing song lyrics and things like that

758
00:29:13,040 --> 00:29:19,580
we're gonna run it this that passphrases

759
00:29:16,790 --> 00:29:22,100
project comes with rules specifically

760
00:29:19,580 --> 00:29:24,649
intended for this really the rule one is

761
00:29:22,100 --> 00:29:27,469
going to do things with spaces gonna do

762
00:29:24,650 --> 00:29:28,340
intelligent placement of its faces and

763
00:29:27,470 --> 00:29:32,210
then we're gonna run it with their other

764
00:29:28,340 --> 00:29:33,709
one it's pretty fast how again we're

765
00:29:32,210 --> 00:29:35,720
using something other probable word list

766
00:29:33,710 --> 00:29:38,480
we're taking a much smaller one instead

767
00:29:35,720 --> 00:29:40,400
of two billion using a one and a half

768
00:29:38,480 --> 00:29:42,169
million so it's a lot smaller we're

769
00:29:40,400 --> 00:29:45,140
gonna run it with a much more expensive

770
00:29:42,169 --> 00:29:49,400
rule we're out I would say that one rule

771
00:29:45,140 --> 00:29:52,820
rule them all is but it's still lighter

772
00:29:49,400 --> 00:29:55,450
than a lot of the heavy this because

773
00:29:52,820 --> 00:29:55,450
we're using smaller

774
00:29:56,810 --> 00:29:59,480
who's gonna give us a little more

775
00:29:57,890 --> 00:30:03,850
confidence if there was something

776
00:29:59,480 --> 00:30:03,850
similar to but not an exact match

777
00:30:06,970 --> 00:30:13,720
now we get into masks I asked Pat Capac

778
00:30:10,630 --> 00:30:16,980
can you give me as any eight character

779
00:30:13,720 --> 00:30:20,530
mass as I can crack in 30 min ago this

780
00:30:16,980 --> 00:30:22,780
is as little statistical coverage as a

781
00:30:20,530 --> 00:30:25,980
higher percentage of those patterns as

782
00:30:22,780 --> 00:30:25,980
you can cover in half an hour

783
00:30:26,210 --> 00:30:30,580
and if I wasn't doing that this probably

784
00:30:27,860 --> 00:30:30,580
would have been about a fish

785
00:30:31,720 --> 00:30:34,440
the weekend on it

786
00:30:33,210 --> 00:30:36,270
we'll spend a little more time in this

787
00:30:34,440 --> 00:30:38,309
and complete her of one hour on it and

788
00:30:36,270 --> 00:30:39,899
then we're gonna go up some stuff to

789
00:30:38,309 --> 00:30:44,158
leave running over the weekend this can

790
00:30:39,899 --> 00:30:45,719
be on your workstation it doesn't notice

791
00:30:44,159 --> 00:30:48,390
there's going to be a w3 in our command

792
00:30:45,720 --> 00:30:50,789
lines that's the workload if you do that

793
00:30:48,390 --> 00:30:55,590
while you're using desktop it's gonna

794
00:30:50,789 --> 00:30:57,029
weigh this we're leaving it running Arif

795
00:30:55,590 --> 00:31:00,010
it's wagging we're not using it

796
00:30:57,029 --> 00:31:01,570
here's the workload of three

797
00:31:00,010 --> 00:31:03,070
we're gonna take one rule to rule them

798
00:31:01,570 --> 00:31:04,300
all

799
00:31:03,070 --> 00:31:07,510
you're a big one and we're gonna take

800
00:31:04,300 --> 00:31:10,330
big lists gonna run that big bull plus

801
00:31:07,510 --> 00:31:14,080
our op 2 billion list you can also

802
00:31:10,330 --> 00:31:15,820
download crack station we passed and run

803
00:31:14,080 --> 00:31:18,280
it across those one of these is going to

804
00:31:15,820 --> 00:31:19,990
take between like let's go around like

805
00:31:18,280 --> 00:31:21,520
five six hours I think at least one of

806
00:31:19,990 --> 00:31:23,110
those take supposed to twelve but

807
00:31:21,520 --> 00:31:26,760
everything in the weekend all it will

808
00:31:23,110 --> 00:31:26,760
complete because of business

809
00:31:28,320 --> 00:31:34,169
next we're gonna run eight hours of any

810
00:31:32,520 --> 00:31:37,050
character passwords that's the first

811
00:31:34,170 --> 00:31:38,730
half hour will be redundant but we're

812
00:31:37,050 --> 00:31:43,680
gonna get better coverage of this pager

813
00:31:38,730 --> 00:31:45,090
password and it's worth it to do even if

814
00:31:43,680 --> 00:31:47,010
you have pushes both characters because

815
00:31:45,090 --> 00:31:48,899
I guarantee have a service account

816
00:31:47,010 --> 00:31:52,860
somewhere that is still a character of

817
00:31:48,900 --> 00:31:54,180
old password music nobody's rotated

818
00:31:52,860 --> 00:31:56,990
they're still going to be that so it's

819
00:31:54,180 --> 00:31:56,990
still worth covering it

820
00:31:57,830 --> 00:32:01,399
next we're gonna take that passphrase

821
00:31:59,420 --> 00:32:04,850
list and we're gonna take that first

822
00:32:01,400 --> 00:32:06,350
passphrase rule no spaces and then we're

823
00:32:04,850 --> 00:32:06,830
gonna run that through one little rule

824
00:32:06,350 --> 00:32:09,020
them all

825
00:32:06,830 --> 00:32:09,919
sometimes order matters in haschke and

826
00:32:09,020 --> 00:32:11,450
sometimes it doesn't

827
00:32:09,920 --> 00:32:13,490
may have noticed that I swapped the

828
00:32:11,450 --> 00:32:14,720
order of where I was staying rule and

829
00:32:13,490 --> 00:32:17,450
where I was saying word list and it was

830
00:32:14,720 --> 00:32:21,590
fine this case it actually matters it

831
00:32:17,450 --> 00:32:24,370
will run one and then it will run one

832
00:32:21,590 --> 00:32:24,370
rule to rule them all

833
00:32:28,399 --> 00:32:34,489
next up let me use a 64 roll weight or

834
00:32:33,139 --> 00:32:36,229
its additive it's not doing the same

835
00:32:34,490 --> 00:32:37,879
thing it's now taking 1password is

836
00:32:36,230 --> 00:32:39,620
making multiplying that into a bunch of

837
00:32:37,879 --> 00:32:40,668
candidates by applying every rule we're

838
00:32:39,620 --> 00:32:43,870
gonna take that and we're gonna have it

839
00:32:40,669 --> 00:32:43,870
do the same thing again

840
00:32:49,770 --> 00:32:53,940
you know that three or three Monday

841
00:32:51,750 --> 00:32:56,539
morning you come in got a collection of

842
00:32:53,940 --> 00:32:59,070
hashes already cracked over the weekend

843
00:32:56,539 --> 00:33:00,270
to take all those passwords ooh crash

844
00:32:59,070 --> 00:33:01,200
we're gonna stick them in our golden

845
00:33:00,270 --> 00:33:04,049
dictionary and then we're going to

846
00:33:01,200 --> 00:33:05,309
expand it yes this is a useless use that

847
00:33:04,049 --> 00:33:08,540
don't give me a hard time about it the

848
00:33:05,309 --> 00:33:09,710
other syntax is way harder to read

849
00:33:08,540 --> 00:33:11,960
nigger girl in dictionary we're gonna

850
00:33:09,710 --> 00:33:13,580
push it through expander sort it and

851
00:33:11,960 --> 00:33:15,230
we're gonna unique it because it doesn't

852
00:33:13,580 --> 00:33:18,439
take care of that put it into a file

853
00:33:15,230 --> 00:33:24,169
called film dictionary and this is done

854
00:33:18,440 --> 00:33:26,750
in andiron windows yes after you in

855
00:33:24,169 --> 00:33:28,490
unique and once they have that we're

856
00:33:26,750 --> 00:33:29,990
just gonna do the Combinator attack on

857
00:33:28,490 --> 00:33:32,120
it take our left hand side and a right

858
00:33:29,990 --> 00:33:35,299
hand side as ago every possible

859
00:33:32,120 --> 00:33:38,689
combination of going to complete in

860
00:33:35,299 --> 00:33:42,410
about a second but you can do it until

861
00:33:38,690 --> 00:33:44,660
you had passwords already practice at

862
00:33:42,410 --> 00:33:47,480
this point your weekend audit is done go

863
00:33:44,660 --> 00:33:49,870
and you say alright these people need to

864
00:33:47,480 --> 00:33:51,190
rotate the past

865
00:33:49,870 --> 00:33:53,050
what do we want to get into continuous

866
00:33:51,190 --> 00:33:56,020
auditing leave something running between

867
00:33:53,050 --> 00:33:57,580
or weekend on it

868
00:33:56,020 --> 00:33:59,800
this is where you definitely need a

869
00:33:57,580 --> 00:34:01,750
dedicated machine you know one of these

870
00:33:59,800 --> 00:34:07,860
running in and not have to worry about

871
00:34:01,750 --> 00:34:10,929
it you can pay some time with it and

872
00:34:07,860 --> 00:34:13,230
this is where if you wanted to a little

873
00:34:10,929 --> 00:34:15,580
bit of money in it

874
00:34:13,230 --> 00:34:17,350
it all depends on what your goal is and

875
00:34:15,580 --> 00:34:20,110
what you're after what are we getting

876
00:34:17,350 --> 00:34:21,790
out of doing this a professional isn't

877
00:34:20,110 --> 00:34:24,000
going to be using a scratch graphics

878
00:34:21,790 --> 00:34:24,000
card

879
00:34:28,918 --> 00:34:33,808
but if their rig is four times stronger

880
00:34:30,989 --> 00:34:37,259
than ours he covered with the same thing

881
00:34:33,809 --> 00:34:39,809
they would in a week then use a there's

882
00:34:37,260 --> 00:34:42,659
a twelve times stronger I need to use

883
00:34:39,809 --> 00:34:44,250
three months to hire five that's still a

884
00:34:42,659 --> 00:34:46,950
little bit more confidence that we would

885
00:34:44,250 --> 00:34:50,879
have found internally on our own what we

886
00:34:46,949 --> 00:34:53,268
it if we had external auditor that's our

887
00:34:50,879 --> 00:34:53,268
goal here

888
00:34:57,710 --> 00:35:00,520
now we're going to do this

889
00:35:01,480 --> 00:35:06,670
everybody's you covering all the vet

890
00:35:02,740 --> 00:35:08,290
care occurs if you have pushed up to 12

891
00:35:06,670 --> 00:35:09,940
you only have to do this once just to

892
00:35:08,290 --> 00:35:13,029
clean out your old legacy stuff your old

893
00:35:09,940 --> 00:35:21,540
service bouncer and from that point you

894
00:35:13,030 --> 00:35:24,360
then alright what can I get if you are

895
00:35:21,540 --> 00:35:26,670
still stuck at age

896
00:35:24,360 --> 00:35:29,780
any really important because we'll crack

897
00:35:26,670 --> 00:35:31,950
a whole bunch of your ehh password is

898
00:35:29,780 --> 00:35:35,480
basically significant everything that

899
00:35:31,950 --> 00:35:35,480
was at least 1% of the population

900
00:35:37,360 --> 00:35:40,650
you wave hassle in reports this is going

901
00:35:39,250 --> 00:35:44,640
to take about six days

902
00:35:40,650 --> 00:35:44,640
10:50 it's gonna take about six days

903
00:35:44,660 --> 00:35:47,940
did you like fingerprint attack but

904
00:35:46,619 --> 00:35:49,380
we're gonna do it a little bit better

905
00:35:47,940 --> 00:35:51,300
we're not gonna limit ourselves suggest

906
00:35:49,380 --> 00:35:54,990
lengths to we're gonna use prints for it

907
00:35:51,300 --> 00:35:58,470
so P P 64 is prints processor I'm gonna

908
00:35:54,990 --> 00:36:00,118
say max element count is or women how

909
00:35:58,470 --> 00:36:02,129
long this is going to go I'm gonna take

910
00:36:00,119 --> 00:36:04,460
in the golden dictionary push it through

911
00:36:02,130 --> 00:36:07,910
prints and I hand that over to hash cap

912
00:36:04,460 --> 00:36:07,910
get optimized

913
00:36:08,500 --> 00:36:14,290
and then Prince comes with its own rules

914
00:36:10,480 --> 00:36:17,190
so we're gonna rule on it this is going

915
00:36:14,290 --> 00:36:22,380
to give you even more related password

916
00:36:17,190 --> 00:36:22,380
time we'll help you build confidence

917
00:36:22,910 --> 00:36:27,830
next something it's gonna take be doing

918
00:36:26,270 --> 00:36:29,990
something meaningful for the rest of our

919
00:36:27,830 --> 00:36:33,190
time Prince is also a good choice here

920
00:36:29,990 --> 00:36:33,189
we're going to use Google

921
00:36:35,350 --> 00:36:43,500
that's gonna take and this me not

922
00:36:37,630 --> 00:36:43,500
complete I wait you to give Alice

923
00:36:50,640 --> 00:36:54,180
just washing her feet do this every

924
00:36:52,410 --> 00:36:56,009
quarter whatever level of maturity

925
00:36:54,180 --> 00:36:58,799
you've decided to exist on just do it

926
00:36:56,010 --> 00:37:01,380
quarterly actually those passwords have

927
00:36:58,799 --> 00:37:05,490
them rotated and give person specific

928
00:37:01,380 --> 00:37:08,059
advice on how to her password hey I was

929
00:37:05,490 --> 00:37:08,058
able to crack it

930
00:37:12,839 --> 00:37:17,460
optional upgrades for this those of you

931
00:37:15,809 --> 00:37:19,170
are familiar with house we're cracking

932
00:37:17,460 --> 00:37:21,509
you're probably wondering why I didn't

933
00:37:19,170 --> 00:37:22,890
talk about hybrid attacks I didn't talk

934
00:37:21,509 --> 00:37:24,420
about hybrid attack success I cracked

935
00:37:22,890 --> 00:37:26,460
exactly zero passwords using this

936
00:37:24,420 --> 00:37:28,410
technique everything that I would have

937
00:37:26,460 --> 00:37:30,460
cracked you miss technique I had already

938
00:37:28,410 --> 00:37:34,000
cracked

939
00:37:30,460 --> 00:37:35,830
mileage may vary go ahead and try it the

940
00:37:34,000 --> 00:37:37,450
example I'm giving you here is using it

941
00:37:35,830 --> 00:37:40,779
on your zone dictionary which is very

942
00:37:37,450 --> 00:37:42,609
fast and let you or expensive every

943
00:37:40,780 --> 00:37:44,110
input password is going to get every

944
00:37:42,610 --> 00:37:45,490
possible combination of that mask

945
00:37:44,110 --> 00:37:48,520
applied so there's a really big

946
00:37:45,490 --> 00:37:50,770
multiplier something that's you know

947
00:37:48,520 --> 00:37:53,830
like for long hear something you can

948
00:37:50,770 --> 00:38:00,310
only do on all this we're gonna use a

949
00:37:53,830 --> 00:38:03,819
larger candidate list smaller now it can

950
00:38:00,310 --> 00:38:06,340
either prepend or a pen cannot do both

951
00:38:03,820 --> 00:38:09,240
the right-hand side of this equation or

952
00:38:06,340 --> 00:38:11,890
does the left-hand side of this Bigley

953
00:38:09,240 --> 00:38:14,649
order matters even though I'm telling it

954
00:38:11,890 --> 00:38:18,310
hey attack mode is six the append mode

955
00:38:14,650 --> 00:38:20,410
Oh cares that I'm putting the mask after

956
00:38:18,310 --> 00:38:24,130
the word list and even though I am

957
00:38:20,410 --> 00:38:26,200
telling it hey V attack mode is 7 the

958
00:38:24,130 --> 00:38:30,940
upend it still requires me to put that

959
00:38:26,200 --> 00:38:32,020
before the gold missionary okay so the

960
00:38:30,940 --> 00:38:32,980
thing you can do is optimize your word

961
00:38:32,020 --> 00:38:35,380
list you may have noticed that I'm

962
00:38:32,980 --> 00:38:37,780
telling you to run that command on or a

963
00:38:35,380 --> 00:38:40,080
different big honking list probably have

964
00:38:37,780 --> 00:38:40,080
a bunch

965
00:38:40,460 --> 00:38:43,849
the reason I'm telling you to do that is

966
00:38:41,750 --> 00:38:49,400
because I think the level of effort

967
00:38:43,849 --> 00:38:51,650
required to actually a little bit of a

968
00:38:49,400 --> 00:38:54,109
high ass for most people if you want to

969
00:38:51,650 --> 00:38:55,670
go after it the street forward way to do

970
00:38:54,109 --> 00:38:58,910
it requires you to be able to fit that

971
00:38:55,670 --> 00:39:01,040
entire amount in RAM at one time have

972
00:38:58,910 --> 00:39:02,810
enough RAM or other ways to do it

973
00:39:01,040 --> 00:39:07,040
without that that are a lot more painful

974
00:39:02,810 --> 00:39:09,619
there is Splash was a tool that would do

975
00:39:07,040 --> 00:39:13,029
this for you there was the problem is

976
00:39:09,619 --> 00:39:15,740
that real world lists word lists have

977
00:39:13,030 --> 00:39:17,569
green coatings and Python does not like

978
00:39:15,740 --> 00:39:20,629
that so it Python tool this has to just

979
00:39:17,569 --> 00:39:24,170
like a week file basically fuzzing the

980
00:39:20,630 --> 00:39:26,690
Python decoder at that point so tool was

981
00:39:24,170 --> 00:39:29,920
not happy I was sad it work on all word

982
00:39:26,690 --> 00:39:29,920
list did not work on my big ones

983
00:39:30,150 --> 00:39:34,080
another thing you can do is hash cut

984
00:39:31,620 --> 00:39:37,560
sessions those command lines were absurd

985
00:39:34,080 --> 00:39:39,150
enough on the slides in practice

986
00:39:37,560 --> 00:39:40,740
anything I'm leaving running over the

987
00:39:39,150 --> 00:39:42,360
weekend or leaving running when I'm away

988
00:39:40,740 --> 00:39:45,000
from it I'm gonna name it with a

989
00:39:42,360 --> 00:39:46,470
specific session so that I can go check

990
00:39:45,000 --> 00:39:49,350
that session file to see if it completed

991
00:39:46,470 --> 00:39:50,819
and I can see just by looking at the

992
00:39:49,350 --> 00:39:54,308
files on disk

993
00:39:50,820 --> 00:39:55,630
each sessions have started to rock

994
00:39:54,309 --> 00:39:56,769
and then also analyze your comb

995
00:39:55,630 --> 00:39:58,239
dictionary pack if you're successful

996
00:39:56,769 --> 00:40:00,788
with this and or particularly if you're

997
00:39:58,239 --> 00:40:02,920
too large enough organization iona game

998
00:40:00,789 --> 00:40:04,569
passwords you get enough of them you can

999
00:40:02,920 --> 00:40:08,309
analyze those with pack and go after

1000
00:40:04,569 --> 00:40:08,308
what are the patterns my

1001
00:40:18,330 --> 00:40:20,390
you

1002
00:40:47,609 --> 00:40:51,709
oh yeah so endpoint protection is

1003
00:40:55,789 --> 00:40:59,269
don't have anything

1004
00:41:02,390 --> 00:41:07,819
those are you ranch guard will not play

1005
00:41:04,760 --> 00:41:09,380
well with soccer on windows somewhere or

1006
00:41:07,820 --> 00:41:10,040
anything else on the high price that's

1007
00:41:09,380 --> 00:41:11,630
not an option

1008
00:41:10,040 --> 00:41:13,490
where they did credential guard they had

1009
00:41:11,630 --> 00:41:16,100
Alice a protection you can play that and

1010
00:41:13,490 --> 00:41:18,470
then there's stuff for this in Windows

1011
00:41:16,100 --> 00:41:19,549
Defender there this defender has a lot

1012
00:41:18,470 --> 00:41:21,410
of amazing stuff in it that you just

1013
00:41:19,550 --> 00:41:24,200
have to go in either into the registry

1014
00:41:21,410 --> 00:41:26,600
or into policy and turn on it has

1015
00:41:24,200 --> 00:41:30,049
something well I have all of that

1016
00:41:26,600 --> 00:41:32,799
deployed that I can deploy it to make it

1017
00:41:30,050 --> 00:41:32,800
as hard as possible

1018
00:41:37,270 --> 00:41:39,330
you

1019
00:41:45,330 --> 00:41:49,359
and I make it really really difficult to

1020
00:41:47,800 --> 00:41:51,160
get hashes out of memory yes is

1021
00:41:49,359 --> 00:41:54,299
everybody on Windows 10 so that there's

1022
00:41:51,160 --> 00:41:54,299
no plaintext credentials yeah

1023
00:41:55,670 --> 00:42:04,820
this is one little you know puzzle piece

1024
00:41:59,240 --> 00:42:07,459
your whole jigsaw of entire security but

1025
00:42:04,820 --> 00:42:09,790
one thing you do this is a thing that I

1026
00:42:07,460 --> 00:42:09,790
see

1027
00:42:17,590 --> 00:42:19,650
you

1028
00:42:32,470 --> 00:42:38,200
my crazy setup was finding an unused

1029
00:42:35,470 --> 00:42:40,899
desktop it had a powerful enough cheap

1030
00:42:38,200 --> 00:42:43,899
and getting my boss to let me buy a 1070

1031
00:42:40,900 --> 00:42:46,250
I let it get in going windows on it and

1032
00:42:43,900 --> 00:42:49,340
then running

1033
00:42:46,250 --> 00:42:53,660
crazy-cool ins no oh so I do have a

1034
00:42:49,340 --> 00:42:56,360
crazy-cool and I use MSI Afterburner to

1035
00:42:53,660 --> 00:42:59,540
force two teams the fan curve as the fan

1036
00:42:56,360 --> 00:43:02,360
curve going down that's the craziest

1037
00:42:59,540 --> 00:43:04,270
thing I've done so you could get into

1038
00:43:02,360 --> 00:43:07,100
can i overclock this can I do like

1039
00:43:04,270 --> 00:43:10,040
coolant on it is that worth it for the

1040
00:43:07,100 --> 00:43:12,310
majority of people in practice I don't

1041
00:43:10,040 --> 00:43:15,329
think

1042
00:43:12,310 --> 00:43:17,429
want to get into

1043
00:43:15,329 --> 00:43:18,630
if you want to get into this more

1044
00:43:17,429 --> 00:43:20,759
seriously you want to build a

1045
00:43:18,630 --> 00:43:23,369
professional cracking rig get into all

1046
00:43:20,759 --> 00:43:26,489
that but if you have no budget but you

1047
00:43:23,369 --> 00:43:29,779
can surround a jeep and do almost

1048
00:43:26,489 --> 00:43:29,779
everything I'm talking about today

1049
00:43:33,750 --> 00:43:35,810
you

1050
00:43:37,710 --> 00:43:42,450
yes so thing that AWS changes is that

1051
00:43:40,980 --> 00:43:45,000
it's no longer about how much money is

1052
00:43:42,450 --> 00:43:47,970
it for he it's about Giga hashes per

1053
00:43:45,000 --> 00:43:50,280
dollar how many of you have to do I want

1054
00:43:47,970 --> 00:43:51,899
to spend on tracking this thing how many

1055
00:43:50,280 --> 00:43:53,069
is required to crack my goal all right

1056
00:43:51,900 --> 00:43:54,990
how much time do I have to say that

1057
00:43:53,069 --> 00:43:57,808
because you're not limited to one GB we

1058
00:43:54,990 --> 00:44:00,089
buy as many of those instances in AWS as

1059
00:43:57,809 --> 00:44:05,329
you want just figure out how much money

1060
00:44:00,089 --> 00:44:05,328
do I want to spend to crack this for me

1061
00:44:12,530 --> 00:44:18,530
the calculation for is this going to be

1062
00:44:15,990 --> 00:44:18,529
cost effective

1063
00:44:22,160 --> 00:44:24,640
absolutely

1064
00:44:29,790 --> 00:44:34,849
boy you're in the back

1065
00:44:32,030 --> 00:44:36,380
I was gonna call it make like call you

1066
00:44:34,849 --> 00:44:38,770
out when you walked in I decided that

1067
00:44:36,380 --> 00:44:38,770
would be

1068
00:44:43,060 --> 00:44:45,120
you

1069
00:45:13,999 --> 00:45:16,058
you

1070
00:45:20,049 --> 00:45:22,109
you

1071
00:45:38,270 --> 00:45:41,599
I would say that you're gonna forever

1072
00:45:40,190 --> 00:45:43,910
hold on to your golden dictionary and

1073
00:45:41,599 --> 00:45:45,950
add to it every password you've ever

1074
00:45:43,910 --> 00:45:47,810
cracked and that is where you're gonna

1075
00:45:45,950 --> 00:45:50,720
go when you do if you want to implement

1076
00:45:47,810 --> 00:45:52,310
password filtering your password filter

1077
00:45:50,720 --> 00:45:53,419
lets you what are the commonalities is

1078
00:45:52,310 --> 00:45:55,220
that the company name is that

1079
00:45:53,420 --> 00:45:57,020
everybody's favorite sports team no

1080
00:45:55,220 --> 00:45:59,450
password containing that is allowed and

1081
00:45:57,020 --> 00:46:01,070
then also if I have a password that

1082
00:45:59,450 --> 00:46:02,660
somebody's trying to use multiple times

1083
00:46:01,070 --> 00:46:05,800
throw it into the filters so that when

1084
00:46:02,660 --> 00:46:05,799
they try to use that they're not allowed

1085
00:46:07,210 --> 00:46:11,200
there's always going to be that one user

1086
00:46:08,980 --> 00:46:12,819
that is going to try to mess up your day

1087
00:46:11,200 --> 00:46:15,930
that's where the hard controls of

1088
00:46:12,819 --> 00:46:15,930
minimum lags in the past

1089
00:46:22,900 --> 00:46:24,960
you

1090
00:46:42,610 --> 00:46:47,290
so this specific the person behind that

1091
00:46:45,550 --> 00:46:49,300
passphrase list also created a tool

1092
00:46:47,290 --> 00:46:51,009
called lyric class that's how they're

1093
00:46:49,300 --> 00:46:54,420
pulling song lyrics into that what

1094
00:46:51,010 --> 00:46:54,420
they're doing is looking up

1095
00:46:55,329 --> 00:47:01,839
and he grabs a like top 100 artists

1096
00:46:59,739 --> 00:47:04,149
downloaded every song lyrics for those

1097
00:47:01,839 --> 00:47:07,049
top 100 artists and then parse it like

1098
00:47:04,149 --> 00:47:07,049
every possible combination

1099
00:47:12,430 --> 00:47:17,680
oh mighty thing with telling people not

1100
00:47:15,010 --> 00:47:20,829
to use fun later if I can just go to the

1101
00:47:17,680 --> 00:47:22,419
net and download a list and punish that

1102
00:47:20,829 --> 00:47:25,299
list and it'll match your password

1103
00:47:22,420 --> 00:47:27,800
password is too common it's portable if

1104
00:47:25,299 --> 00:47:30,550
something somebody can crack

1105
00:47:27,800 --> 00:47:30,550
something

1106
00:47:30,760 --> 00:47:36,150
so that's the same problem with what

1107
00:47:33,220 --> 00:47:38,730
quotes the same thing

1108
00:47:36,150 --> 00:47:44,240
yeah your favorite bible verse like I

1109
00:47:38,730 --> 00:47:44,240
screw into my Wittenberg

1110
00:47:52,750 --> 00:47:58,980
so if it's

1111
00:47:55,010 --> 00:48:00,960
somebody else laying around on your hard

1112
00:47:58,980 --> 00:48:03,990
drive I come from a forensics background

1113
00:48:00,960 --> 00:48:05,700
you know we track people's passwords org

1114
00:48:03,990 --> 00:48:08,000
list every single word on the entire

1115
00:48:05,700 --> 00:48:08,000
hard drive

1116
00:48:08,600 --> 00:48:12,940
if it's anything like that somebody's

1117
00:48:10,340 --> 00:48:12,940
going to be able to guess it

1118
00:48:13,600 --> 00:48:19,540
but I always tell people is listen yes

1119
00:48:16,060 --> 00:48:21,310
is generating X random words using a

1120
00:48:19,540 --> 00:48:24,420
tool like dice we're gonna be a little

1121
00:48:21,310 --> 00:48:28,770
bit of a pain yeah gonna be easy to type

1122
00:48:24,420 --> 00:48:28,770
are you going to remember it after you

1123
00:48:33,530 --> 00:48:35,590
you

1124
00:48:48,670 --> 00:48:52,559
so that's a decision you're gonna need

1125
00:48:50,559 --> 00:48:56,049
me to make what is the right thing

1126
00:48:52,559 --> 00:48:58,150
they've got a small office block down

1127
00:48:56,049 --> 00:49:03,038
anything cloud-based is a a no for

1128
00:48:58,150 --> 00:49:06,700
Policy firewall for us we win with keep

1129
00:49:03,039 --> 00:49:09,400
and if they keep this I wanted to leave

1130
00:49:06,700 --> 00:49:12,058
when you don't need that's just some

1131
00:49:09,400 --> 00:49:12,059
part of the golden image

1132
00:49:12,940 --> 00:49:16,230
for an organization in a different

1133
00:49:17,130 --> 00:49:24,599
situated I'm suggesting to you as to all

1134
00:49:20,890 --> 00:49:28,078
of you is humping the password fault

1135
00:49:24,599 --> 00:49:28,079
better than not

1136
00:49:35,030 --> 00:49:40,390
which vault is the right for you and

1137
00:49:37,160 --> 00:49:40,390
your organization depends on you

1138
00:49:49,760 --> 00:49:51,820
you

1139
00:49:52,339 --> 00:49:54,400
you

1140
00:50:31,050 --> 00:50:35,990
we're now getting down to a point where

1141
00:50:32,280 --> 00:50:35,990
we have a understanding of

1142
00:50:40,490 --> 00:50:42,549
you

1143
00:51:04,360 --> 00:51:09,810
i'ii be surprised very high quality

1144
00:51:15,580 --> 00:51:21,370
very famously like four different ways

1145
00:51:19,160 --> 00:51:21,370
to

1146
00:51:33,130 --> 00:51:38,190
mfa deployed I would be very very

1147
00:51:35,140 --> 00:51:38,190
interesting validating

1148
00:51:52,230 --> 00:51:54,290
you

1149
00:51:57,390 --> 00:51:59,450
you

1150
00:52:00,100 --> 00:52:02,160
you

1151
00:52:04,980 --> 00:52:08,420
I've actually settled on

1152
00:52:10,779 --> 00:52:15,900
you

1153
00:52:12,820 --> 00:52:15,900
this laptop

1154
00:52:23,230 --> 00:52:25,290
you

1155
00:52:29,720 --> 00:52:32,560
but I

1156
00:52:33,800 --> 00:52:35,860
you

1157
00:52:42,569 --> 00:52:47,160
have fun any on topic question

1158
00:52:49,310 --> 00:52:51,370
you

1159
00:53:08,640 --> 00:53:15,150
nothing insecurity is yes or no

1160
00:53:10,890 --> 00:53:17,370
everything is how bad do they want is if

1161
00:53:15,150 --> 00:53:19,350
somebody wants to hack

1162
00:53:17,370 --> 00:53:22,830
there exists out there somebody who has

1163
00:53:19,350 --> 00:53:25,830
the O'Day's found in their arsenal get

1164
00:53:22,830 --> 00:53:30,470
into your organ take not going to do

1165
00:53:25,830 --> 00:53:30,470
that O'Day is worth way more to them

1166
00:53:33,829 --> 00:53:37,299
about duder can say he is

1167
00:53:49,870 --> 00:53:54,040
you want to leave a kind of like a five

1168
00:53:51,490 --> 00:53:55,569
out of five mature level that's gonna be

1169
00:53:54,040 --> 00:53:58,920
a lot of money for you but it also needs

1170
00:53:55,570 --> 00:53:58,920
a massive amount of money

1171
00:53:59,470 --> 00:54:04,200
our organization not want to live in a 5

1172
00:54:01,900 --> 00:54:04,200
out of 5

1173
00:54:05,210 --> 00:54:08,440
now where's well

1174
00:54:11,710 --> 00:54:16,210
place here um somebody wants to crack

1175
00:54:14,080 --> 00:54:16,630
that house where they can I'm out of

1176
00:54:16,210 --> 00:54:20,490
money

1177
00:54:16,630 --> 00:54:20,490
they literally exhaust

1178
00:54:25,359 --> 00:54:31,479
I spend that much on you and answer that

1179
00:54:30,039 --> 00:54:38,160
question of are they going to send them

1180
00:54:31,479 --> 00:54:38,160
up from you but here do I want my thirty

1181
00:54:38,940 --> 00:54:42,599
in my organization

1182
00:54:57,440 --> 00:55:00,580
sure you should match

1183
00:55:21,319 --> 00:55:23,380
you

