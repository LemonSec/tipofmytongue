1
00:00:05,780 --> 00:00:13,950
my talk is about a man-in-the-middle

2
00:00:09,180 --> 00:00:16,110
attack against this industrial control

3
00:00:13,950 --> 00:00:18,810
system here very simple industrial

4
00:00:16,110 --> 00:00:21,090
control system just got a controller and

5
00:00:18,810 --> 00:00:24,479
appeals<font color="#E5E5E5"> or a PLC controller programmable</font>

6
00:00:21,090 --> 00:00:26,520
<font color="#CCCCCC">logic controller and an IO block but I</font>

7
00:00:24,480 --> 00:00:30,779
actually got a<font color="#CCCCCC"> chance to</font><font color="#E5E5E5"> get down into</font>

8
00:00:26,520 --> 00:00:34,170
the details of what what went on during

9
00:00:30,779 --> 00:00:37,350
the man in the middle attack itself to

10
00:00:34,170 --> 00:00:40,309
the actual control signals themself so I

11
00:00:37,350 --> 00:00:45,480
try and<font color="#CCCCCC"> go</font><font color="#E5E5E5"> into that a little bit more</font>

12
00:00:40,309 --> 00:00:47,940
<font color="#E5E5E5">about me I'm a senior investigator at</font>

13
00:00:45,480 --> 00:00:50,928
<font color="#CCCCCC">Connexus consulting</font><font color="#E5E5E5"> I do industrial</font>

14
00:00:47,940 --> 00:00:55,260
<font color="#E5E5E5">control system and scada system</font>

15
00:00:50,929 --> 00:00:57,809
assessments and designs for a variety of

16
00:00:55,260 --> 00:01:02,449
customers anywhere<font color="#CCCCCC"> from energy companies</font>

17
00:00:57,809 --> 00:01:05,370
to oil and gas to process control to

18
00:01:02,449 --> 00:01:08,670
manufacturing and everything pretty much

19
00:01:05,370 --> 00:01:13,200
between I've been<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> this for 20 plus</font>

20
00:01:08,670 --> 00:01:17,570
years i'm also a developer on our

21
00:01:13,200 --> 00:01:20,010
analysis software internally and<font color="#E5E5E5"> i</font>

22
00:01:17,570 --> 00:01:21,869
previously worked at nist in the

23
00:01:20,010 --> 00:01:24,810
engineering lab where I did control

24
00:01:21,870 --> 00:01:28,790
systems automated vehicles wireless

25
00:01:24,810 --> 00:01:31,350
sensors and systems I'm now basically

26
00:01:28,790 --> 00:01:37,980
I've been a consultant now for three

27
00:01:31,350 --> 00:01:41,850
years that was my midlife crisis so this

28
00:01:37,980 --> 00:01:44,490
also shows on also the co-chair of the

29
00:01:41,850 --> 00:01:45,720
is a 99 committee and if you know

30
00:01:44,490 --> 00:01:48,390
anything about<font color="#E5E5E5"> a destra control system</font>

31
00:01:45,720 --> 00:01:49,920
security that's<font color="#E5E5E5"> the basically the</font>

32
00:01:48,390 --> 00:01:52,350
<font color="#E5E5E5">committee that's developing all of the</font>

33
00:01:49,920 --> 00:01:55,050
industrial control system cybersecurity

34
00:01:52,350 --> 00:01:56,490
standards internationally there's NIST

35
00:01:55,050 --> 00:01:58,200
is doing some and<font color="#E5E5E5"> some other people are</font>

36
00:01:56,490 --> 00:02:03,570
doing it but we're trying to coordinate

37
00:01:58,200 --> 00:02:05,580
everything across the board so when this

38
00:02:03,570 --> 00:02:08,728
shows up mane of<font color="#E5E5E5"> the middle attacks are</font>

39
00:02:05,580 --> 00:02:13,349
nothing new<font color="#E5E5E5"> I'm not going to run the</font>

40
00:02:08,729 --> 00:02:16,020
coolest man a middle attack here because

41
00:02:13,349 --> 00:02:17,820
honestly industrial control systems are

42
00:02:16,020 --> 00:02:18,880
<font color="#E5E5E5">the kind of things that you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> look at</font>

43
00:02:17,820 --> 00:02:22,239
wrong<font color="#CCCCCC"> and they go down</font>

44
00:02:18,880 --> 00:02:25,450
the in general they're very fragile

45
00:02:22,240 --> 00:02:28,030
they're very stable so they work really

46
00:02:25,450 --> 00:02:31,929
well as long<font color="#CCCCCC"> as you don't go near them</font>

47
00:02:28,030 --> 00:02:36,180
in general<font color="#E5E5E5"> some of the newer systems and</font>

48
00:02:31,930 --> 00:02:39,460
and newer protocols are doing better but

49
00:02:36,180 --> 00:02:42,640
generally the systems are to be

50
00:02:39,460 --> 00:02:46,120
protected like<font color="#E5E5E5"> your most secure data</font>

51
00:02:42,640 --> 00:02:49,420
they've got to be protected with layers

52
00:02:46,120 --> 00:02:52,300
<font color="#E5E5E5">of protection so that you don't get the</font>

53
00:02:49,420 --> 00:02:54,609
standard<font color="#E5E5E5"> kind of things coming down in</font>

54
00:02:52,300 --> 00:02:56,530
there and a lot of times even protected

55
00:02:54,610 --> 00:02:58,900
to where you<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> want your IT</font>

56
00:02:56,530 --> 00:03:01,870
department coming down<font color="#CCCCCC"> to so the IT</font>

57
00:02:58,900 --> 00:03:05,700
department a lot of times is restricted

58
00:03:01,870 --> 00:03:05,700
from coming down into the system as well

59
00:03:06,630 --> 00:03:15,010
there's a ton of videos and tutorials

60
00:03:11,320 --> 00:03:21,940
and all that kind of stuff out<font color="#CCCCCC"> there in</font>

61
00:03:15,010 --> 00:03:27,549
the world for doing man the middle tax

62
00:03:21,940 --> 00:03:30,450
so<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to go into those one of</font>

63
00:03:27,550 --> 00:03:36,340
<font color="#CCCCCC">the best ones I actually found was from</font>

64
00:03:30,450 --> 00:03:42,339
<font color="#CCCCCC">iron geek he has a really good tutorial</font>

65
00:03:36,340 --> 00:03:45,280
on doing man the middle attacks and

66
00:03:42,340 --> 00:03:48,010
writing filters and everything in the

67
00:03:45,280 --> 00:03:50,860
mean in between so i would definitely

68
00:03:48,010 --> 00:03:56,549
<font color="#E5E5E5">highly recommend taking a look at his</font>

69
00:03:50,860 --> 00:03:58,930
stuff if you get a<font color="#CCCCCC"> chance iron geek</font>

70
00:03:56,550 --> 00:04:00,900
Adrian<font color="#E5E5E5"> Crenshaw he does a lot of the</font>

71
00:03:58,930 --> 00:04:03,310
videos and things like that<font color="#E5E5E5"> but he also</font>

72
00:04:00,900 --> 00:04:08,020
really knows a hell of a<font color="#E5E5E5"> lot about</font>

73
00:04:03,310 --> 00:04:10,750
ettercap and things like that so this<font color="#E5E5E5"> is</font>

74
00:04:08,020 --> 00:04:13,660
not a talk about<font color="#E5E5E5"> how to run a really</font>

75
00:04:10,750 --> 00:04:17,350
cool man in the middle attack it's how

76
00:04:13,660 --> 00:04:19,450
<font color="#E5E5E5">to do a man-in-the-middle attack and see</font>

77
00:04:17,350 --> 00:04:25,480
what happens to the control system when

78
00:04:19,450 --> 00:04:27,460
<font color="#E5E5E5">you do that so I ICS and scada</font><font color="#CCCCCC"> systems--</font>

79
00:04:25,480 --> 00:04:29,080
they really rely on deterministic

80
00:04:27,460 --> 00:04:31,900
communications and when you run in a

81
00:04:29,080 --> 00:04:32,719
<font color="#E5E5E5">manner middle attacks the determinism of</font>

82
00:04:31,900 --> 00:04:35,060
those systems

83
00:04:32,720 --> 00:04:36,500
really get affected and we<font color="#E5E5E5"> actually</font>

84
00:04:35,060 --> 00:04:37,880
wanted to see what would<font color="#CCCCCC"> happen to</font><font color="#E5E5E5"> the</font>

85
00:04:36,500 --> 00:04:39,890
real-time communications when you get

86
00:04:37,880 --> 00:04:42,409
down into<font color="#CCCCCC"> that point into the levels of</font>

87
00:04:39,890 --> 00:04:45,080
actually having this man in the middle

88
00:04:42,410 --> 00:04:47,990
attack and see what what effect it had

89
00:04:45,080 --> 00:04:49,669
on a deterministic communications can

90
00:04:47,990 --> 00:04:51,860
you detect the man in the middle attack

91
00:04:49,670 --> 00:04:55,070
using simple tools or do you really need

92
00:04:51,860 --> 00:04:57,290
a big monster IDs system or<font color="#E5E5E5"> something</font>

93
00:04:55,070 --> 00:04:59,390
that's home built or something like that

94
00:04:57,290 --> 00:05:01,460
we wanted to<font color="#E5E5E5"> see what what you could do</font>

95
00:04:59,390 --> 00:05:06,169
and how easily you could find some of

96
00:05:01,460 --> 00:05:10,909
this stuff so what do I have in this box

97
00:05:06,170 --> 00:05:13,310
I have a controller so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the this</font>

98
00:05:10,910 --> 00:05:15,290
is the controller the<font color="#CCCCCC"> PLC here for</font>

99
00:05:13,310 --> 00:05:19,070
grammar logic controller I've got an<font color="#E5E5E5"> IO</font>

100
00:05:15,290 --> 00:05:22,070
block right here that controls these

101
00:05:19,070 --> 00:05:24,380
buttons so you hit the<font color="#CCCCCC"> button the light</font>

102
00:05:22,070 --> 00:05:26,270
<font color="#CCCCCC">blunt the light turns on the light on</font>

103
00:05:24,380 --> 00:05:28,700
these is independently controlled from

104
00:05:26,270 --> 00:05:31,669
the<font color="#E5E5E5"> button push so the button push sends</font>

105
00:05:28,700 --> 00:05:33,440
a signal to the PLC the<font color="#CCCCCC"> PLC says turn on</font>

106
00:05:31,669 --> 00:05:35,780
the light so it sends a signal<font color="#E5E5E5"> back to</font>

107
00:05:33,440 --> 00:05:37,400
turn on the<font color="#CCCCCC"> light so you</font><font color="#E5E5E5"> can actually do</font>

108
00:05:35,780 --> 00:05:39,530
the man in the middle attack to actually

109
00:05:37,400 --> 00:05:44,830
adjust what<font color="#E5E5E5"> happens with</font><font color="#CCCCCC"> the lights in</font>

110
00:05:39,530 --> 00:05:48,049
this<font color="#E5E5E5"> box I'm right basically</font><font color="#CCCCCC"> I ran</font>

111
00:05:44,830 --> 00:05:50,870
ettercap<font color="#CCCCCC"> incomplete script kiddie mode I</font>

112
00:05:48,050 --> 00:05:52,669
said plug in turn on I'm not an editor

113
00:05:50,870 --> 00:05:55,790
cap expert I got a chance to<font color="#CCCCCC"> play around</font>

114
00:05:52,669 --> 00:05:57,950
<font color="#E5E5E5">with it because it was fun but I really</font>

115
00:05:55,790 --> 00:05:59,120
don't know enough and talk to other

116
00:05:57,950 --> 00:06:02,870
people if you want to<font color="#E5E5E5"> know how to do it</font>

117
00:05:59,120 --> 00:06:07,550
or get better total script kiddie with

118
00:06:02,870 --> 00:06:10,100
this I captured traffic this is one of

119
00:06:07,550 --> 00:06:13,550
<font color="#E5E5E5">the netgear switches has a mirror has a</font>

120
00:06:10,100 --> 00:06:15,380
mere port and so we spanned the taps are

121
00:06:13,550 --> 00:06:17,540
spammed up the ports and basically

122
00:06:15,380 --> 00:06:19,130
captured off the me report there so we

123
00:06:17,540 --> 00:06:22,100
had at least<font color="#E5E5E5"> a clean capture of all the</font>

124
00:06:19,130 --> 00:06:23,540
traffic on the network the<font color="#CCCCCC"> plc do i owe</font>

125
00:06:22,100 --> 00:06:26,150
communications uses what's called

126
00:06:23,540 --> 00:06:30,320
<font color="#E5E5E5">ethernet industrial protocol this is not</font>

127
00:06:26,150 --> 00:06:33,950
ethernet/ip as in tcp/ip terrible name

128
00:06:30,320 --> 00:06:35,380
but it was what<font color="#CCCCCC"> it is look it up I go I</font>

129
00:06:33,950 --> 00:06:38,870
<font color="#CCCCCC">think I've got a little bit on that</font>

130
00:06:35,380 --> 00:06:40,610
later we ran a 10 millisecond frequency

131
00:06:38,870 --> 00:06:43,280
which is<font color="#CCCCCC"> a fairly</font><font color="#E5E5E5"> standard for</font>

132
00:06:40,610 --> 00:06:44,750
industrial control systems not too fast

133
00:06:43,280 --> 00:06:46,280
to where you're doing like really high

134
00:06:44,750 --> 00:06:47,840
speed control

135
00:06:46,280 --> 00:06:50,270
and you really<font color="#E5E5E5"> get down to the point of</font>

136
00:06:47,840 --> 00:06:53,060
actually looking at like how you can

137
00:06:50,270 --> 00:06:55,340
synchronize multiple devices clocks and

138
00:06:53,060 --> 00:06:58,070
everything like that<font color="#E5E5E5"> this is general</font>

139
00:06:55,340 --> 00:07:01,359
purpose manufacturing auto manufacturers

140
00:06:58,070 --> 00:07:03,800
typically use 10 milliseconds air

141
00:07:01,360 --> 00:07:09,830
aircraft manufacturers like Boeing and

142
00:07:03,800 --> 00:07:11,300
<font color="#CCCCCC">and your</font><font color="#E5E5E5"> Airbus they typically run all</font>

143
00:07:09,830 --> 00:07:13,849
their controllers at<font color="#E5E5E5"> 10 milliseconds so</font>

144
00:07:11,300 --> 00:07:15,830
it's a fairly common frequency to run

145
00:07:13,850 --> 00:07:18,160
it's fast<font color="#CCCCCC"> enough that</font><font color="#E5E5E5"> we can get some</font>

146
00:07:15,830 --> 00:07:20,539
good high<font color="#CCCCCC"> quality high</font><font color="#E5E5E5"> fidelity data to</font>

147
00:07:18,160 --> 00:07:23,870
and basically<font color="#E5E5E5"> we're running a man</font><font color="#CCCCCC"> Tamila</font>

148
00:07:20,540 --> 00:07:27,530
text the<font color="#CCCCCC"> PLC itself so target one in</font>

149
00:07:23,870 --> 00:07:28,910
editor cap was the<font color="#E5E5E5"> PLC and not we</font>

150
00:07:27,530 --> 00:07:32,299
weren't running it against the<font color="#CCCCCC"> IO block</font>

151
00:07:28,910 --> 00:07:34,610
itself so a little bit<font color="#E5E5E5"> about ethernet/ip</font>

152
00:07:32,300 --> 00:07:36,410
it was a bit originally developed by a

153
00:07:34,610 --> 00:07:40,100
company called<font color="#CCCCCC"> Rockwell Automation</font><font color="#E5E5E5"> allen</font>

154
00:07:36,410 --> 00:07:42,919
<font color="#E5E5E5">bradley and it's now managed by a group</font>

155
00:07:40,100 --> 00:07:44,510
called<font color="#CCCCCC"> ODB a it's generally used at the</font>

156
00:07:42,919 --> 00:07:48,200
lower<font color="#E5E5E5"> level so you won't</font><font color="#CCCCCC"> see ethernet IP</font>

157
00:07:44,510 --> 00:07:50,810
traffic up past sort of the controller

158
00:07:48,200 --> 00:07:54,669
level generally the<font color="#CCCCCC"> controller's talk to</font>

159
00:07:50,810 --> 00:07:58,750
something to some sort of historian or

160
00:07:54,669 --> 00:08:01,669
HMI system using another protocol in

161
00:07:58,750 --> 00:08:03,800
<font color="#CCCCCC">Ethernet IP is typically between the</font><font color="#E5E5E5"> PLC</font>

162
00:08:01,669 --> 00:08:07,909
and<font color="#CCCCCC"> the lower level devices down below</font>

163
00:08:03,800 --> 00:08:11,570
the HMIS the motors the<font color="#E5E5E5"> i/o blocks</font>

164
00:08:07,910 --> 00:08:15,740
sensors all that kind of stuff<font color="#E5E5E5"> ODB a re</font>

165
00:08:11,570 --> 00:08:18,469
<font color="#E5E5E5">mi p uses it's basically a common layer</font>

166
00:08:15,740 --> 00:08:21,110
4 and up protocol it uses the tcp/ip

167
00:08:18,470 --> 00:08:22,580
stack unmodified so they've figured out

168
00:08:21,110 --> 00:08:26,390
how to actually do determinates of

169
00:08:22,580 --> 00:08:27,710
communications over standard tcp IP some

170
00:08:26,390 --> 00:08:30,770
of the industrial protocols<font color="#CCCCCC"> have</font>

171
00:08:27,710 --> 00:08:35,539
actually gone and removed portions of

172
00:08:30,770 --> 00:08:38,210
the<font color="#CCCCCC"> tcp stack as they've gone along for</font>

173
00:08:35,539 --> 00:08:41,210
different reasons some<font color="#E5E5E5"> of them get down</font>

174
00:08:38,210 --> 00:08:43,070
into doing synchronizations in the nano

175
00:08:41,210 --> 00:08:46,160
seconds when you're<font color="#E5E5E5"> actually like</font>

176
00:08:43,070 --> 00:08:47,300
running news<font color="#E5E5E5"> paper mills and stuff like</font>

177
00:08:46,160 --> 00:08:49,850
that where they're actually<font color="#E5E5E5"> running</font>

178
00:08:47,300 --> 00:08:53,329
<font color="#CCCCCC">mile-long</font><font color="#E5E5E5"> hundred motors have to be</font>

179
00:08:49,850 --> 00:08:54,980
synchronized at the few microseconds so

180
00:08:53,330 --> 00:08:57,830
they<font color="#E5E5E5"> found that they have to do it a</font>

181
00:08:54,980 --> 00:08:59,779
different way using specialized

182
00:08:57,830 --> 00:09:03,050
protocols and they've actually removed

183
00:08:59,779 --> 00:09:05,240
even forces down to removing like the

184
00:09:03,050 --> 00:09:10,878
802 link layer stuff to where they run

185
00:09:05,240 --> 00:09:13,100
just literally over<font color="#E5E5E5"> 80</font><font color="#CCCCCC"> 25 level so but</font>

186
00:09:10,879 --> 00:09:14,899
<font color="#CCCCCC">ease and IP has done all they've made a</font>

187
00:09:13,100 --> 00:09:17,800
point of stating from the very beginning

188
00:09:14,899 --> 00:09:22,220
that they wanted<font color="#E5E5E5"> to run</font><font color="#CCCCCC"> everything over</font>

189
00:09:17,800 --> 00:09:24,439
unmodified<font color="#E5E5E5"> tcp/ip it uses both a command</font>

190
00:09:22,220 --> 00:09:26,899
response type protocol so kind of like

191
00:09:24,439 --> 00:09:29,269
you're<font color="#E5E5E5"> a server client kind of stuff so</font>

192
00:09:26,899 --> 00:09:31,309
<font color="#E5E5E5">give me your data here's my data give me</font>

193
00:09:29,269 --> 00:09:34,370
your data here's my data and they also

194
00:09:31,309 --> 00:09:36,379
do a publishing subscribe where the

195
00:09:34,370 --> 00:09:38,089
device is kind of agree during their

196
00:09:36,379 --> 00:09:40,459
hand shaking of how fast the data is

197
00:09:38,089 --> 00:09:42,559
going<font color="#E5E5E5"> to come out and then it the i/o</font>

198
00:09:40,459 --> 00:09:43,969
block in<font color="#E5E5E5"> this case just</font><font color="#CCCCCC"> says here's my</font>

199
00:09:42,559 --> 00:09:45,649
<font color="#E5E5E5">data here's my data here's my data</font>

200
00:09:43,970 --> 00:09:47,449
here's my data here with my data and the

201
00:09:45,649 --> 00:09:50,660
other guys say<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> that's cool I got it</font>

202
00:09:47,449 --> 00:09:52,490
and they just<font color="#E5E5E5"> sort of they use a</font>

203
00:09:50,660 --> 00:09:54,110
handshake to basically make sure that

204
00:09:52,490 --> 00:09:56,480
the communications still going on but

205
00:09:54,110 --> 00:09:59,120
<font color="#CCCCCC">they don't go into anything of actually</font>

206
00:09:56,480 --> 00:10:02,629
having to<font color="#E5E5E5"> ask every</font><font color="#CCCCCC"> single time for that</font>

207
00:09:59,120 --> 00:10:05,230
piece<font color="#CCCCCC"> of data if you look</font><font color="#E5E5E5"> in wireshark</font>

208
00:10:02,629 --> 00:10:09,680
you'll find the protocol in there it's

209
00:10:05,230 --> 00:10:11,480
<font color="#CCCCCC">in wireshark gets en IP is the the four</font>

210
00:10:09,680 --> 00:10:15,920
digit or the<font color="#E5E5E5"> four letter kind of code</font>

211
00:10:11,480 --> 00:10:20,240
for it the command response uses<font color="#CCCCCC"> TCP 44</font>

212
00:10:15,920 --> 00:10:21,439
<font color="#CCCCCC">818 and this does what's it does two</font>

213
00:10:20,240 --> 00:10:23,629
different types of messages<font color="#CCCCCC"> ones called</font>

214
00:10:21,439 --> 00:10:25,730
unconnected so this is the i want<font color="#E5E5E5"> to</font>

215
00:10:23,629 --> 00:10:27,649
start<font color="#E5E5E5"> talking</font><font color="#CCCCCC"> to you I don't know who</font>

216
00:10:25,730 --> 00:10:29,269
<font color="#CCCCCC">you are yet so here's here's a message</font>

217
00:10:27,649 --> 00:10:32,300
to get<font color="#E5E5E5"> that started this is sort of the</font>

218
00:10:29,269 --> 00:10:34,250
initial handshake process then they have

219
00:10:32,300 --> 00:10:36,559
what's called connected messaging that

220
00:10:34,250 --> 00:10:39,350
will actually use<font color="#E5E5E5"> long-term TCP</font>

221
00:10:36,559 --> 00:10:42,170
connections and sending commands and

222
00:10:39,350 --> 00:10:45,529
responses over that<font color="#CCCCCC"> long-term long</font>

223
00:10:42,170 --> 00:10:47,240
duration TCP connection with some sort

224
00:10:45,529 --> 00:10:50,779
of periodic rates but again most of time

225
00:10:47,240 --> 00:10:55,939
it's it's that would be a like some sort

226
00:10:50,779 --> 00:10:57,319
of HMI system or command response where

227
00:10:55,939 --> 00:10:59,089
someone is actually having<font color="#CCCCCC"> to actually a</font>

228
00:10:57,319 --> 00:11:02,479
human<font color="#E5E5E5"> is having to be</font><font color="#CCCCCC"> in the operation</font>

229
00:10:59,089 --> 00:11:03,860
typically it wouldn't<font color="#CCCCCC"> be the actual low</font>

230
00:11:02,480 --> 00:11:06,050
level control stuff the low level

231
00:11:03,860 --> 00:11:11,350
control is typically done with publish

232
00:11:06,050 --> 00:11:11,349
and subscribe and that<font color="#E5E5E5"> uses UDP 2222</font>

233
00:11:13,439 --> 00:11:17,498
it's considered<font color="#E5E5E5"> real-time messaging</font>

234
00:11:15,759 --> 00:11:19,029
because it's it's an implicit connection

235
00:11:17,499 --> 00:11:20,439
they agree during their hand shaking

236
00:11:19,029 --> 00:11:22,180
process of<font color="#E5E5E5"> what the message is going to</font>

237
00:11:20,439 --> 00:11:24,939
look like how<font color="#E5E5E5"> often they're going to</font>

238
00:11:22,180 --> 00:11:27,040
send and then basically that initial

239
00:11:24,939 --> 00:11:29,170
communication handshaking goes away so

240
00:11:27,040 --> 00:11:31,629
the initial tcp command stuff goes away

241
00:11:29,170 --> 00:11:34,029
and then it's<font color="#CCCCCC"> just a full UDP back and</font>

242
00:11:31,629 --> 00:11:35,350
forth if they don't hear a UDP message

243
00:11:34,029 --> 00:11:37,449
from those devices within a certain

244
00:11:35,350 --> 00:11:40,300
amount of time they will<font color="#CCCCCC"> actually close</font>

245
00:11:37,449 --> 00:11:41,829
down the connection and then if it's

246
00:11:40,300 --> 00:11:43,120
programmed that way it'll reestablish

247
00:11:41,829 --> 00:11:46,569
connection otherwise it'll go<font color="#E5E5E5"> into some</font>

248
00:11:43,120 --> 00:11:49,240
error state so and<font color="#E5E5E5"> this is how pretty</font>

249
00:11:46,569 --> 00:11:53,128
much most of the<font color="#CCCCCC"> real-time</font><font color="#E5E5E5"> communication</font>

250
00:11:49,240 --> 00:11:55,930
works it can use either multi for the

251
00:11:53,129 --> 00:11:58,720
publisher so in this case the<font color="#E5E5E5"> i/o block</font>

252
00:11:55,930 --> 00:12:00,758
itself<font color="#E5E5E5"> that's publishing data it can use</font>

253
00:11:58,720 --> 00:12:03,730
a multicast protocol or it can do

254
00:12:00,759 --> 00:12:05,110
unicast they didn't they did multicast

255
00:12:03,730 --> 00:12:07,420
originally because they wanted<font color="#E5E5E5"> to have</font>

256
00:12:05,110 --> 00:12:11,050
the idea of<font color="#E5E5E5"> having multiple devices be</font>

257
00:12:07,420 --> 00:12:13,120
able to subscribe to that and this guy

258
00:12:11,050 --> 00:12:17,160
would only have to produce one packet to

259
00:12:13,120 --> 00:12:21,730
that everyone would sort<font color="#E5E5E5"> of listen in to</font>

260
00:12:17,160 --> 00:12:22,540
so what do I actually have here I kind

261
00:12:21,730 --> 00:12:29,529
of went<font color="#CCCCCC"> through this a little bit</font>

262
00:12:22,540 --> 00:12:32,529
already plc io block<font color="#CCCCCC"> a netgear i had the</font>

263
00:12:29,529 --> 00:12:34,990
GS 108<font color="#E5E5E5"> e so it's got a its got the</font>

264
00:12:32,529 --> 00:12:38,709
<font color="#E5E5E5">ability to me report on it and it's</font>

265
00:12:34,990 --> 00:12:40,870
gigabit<font color="#CCCCCC"> i ran a man in the middle man</font>

266
00:12:38,709 --> 00:12:44,709
the middle machine was kali linux<font color="#E5E5E5"> 2</font>

267
00:12:40,870 --> 00:12:46,959
point<font color="#E5E5E5"> 0 vm and i just used the default</font>

268
00:12:44,709 --> 00:12:50,619
cali version of ettercap that was in

269
00:12:46,959 --> 00:12:53,888
there so<font color="#E5E5E5"> and then the capture machine</font>

270
00:12:50,620 --> 00:12:55,959
was kali linux native and whatever their

271
00:12:53,889 --> 00:12:58,540
native version of Wireshark typically<font color="#CCCCCC"> i</font>

272
00:12:55,959 --> 00:13:00,550
<font color="#E5E5E5">actually recompile Wireshark myself just</font>

273
00:12:58,540 --> 00:13:02,620
because it's a lot better that way but

274
00:13:00,550 --> 00:13:05,949
in this case I just<font color="#E5E5E5"> did a dumb</font>

275
00:13:02,620 --> 00:13:08,110
completely new wife of the system and

276
00:13:05,949 --> 00:13:09,878
and just reloaded it by itself just<font color="#CCCCCC"> to</font>

277
00:13:08,110 --> 00:13:15,160
have a clean system that I didn't have

278
00:13:09,879 --> 00:13:19,559
<font color="#E5E5E5">to mess with or basically proved out so</font>

279
00:13:15,160 --> 00:13:22,269
I did ettercap with target one being the

280
00:13:19,559 --> 00:13:23,790
PLC itself that was the main target of

281
00:13:22,269 --> 00:13:25,840
the<font color="#CCCCCC"> P of</font><font color="#E5E5E5"> the man in the middle attack</font>

282
00:13:23,790 --> 00:13:31,030
and target<font color="#E5E5E5"> too was the</font>

283
00:13:25,840 --> 00:13:34,600
a block and basically I just ran our

284
00:13:31,030 --> 00:13:36,130
poisoning with this with the sniff

285
00:13:34,600 --> 00:13:38,260
remote connections<font color="#E5E5E5"> just because it was a</font>

286
00:13:36,130 --> 00:13:40,330
little bit<font color="#E5E5E5"> easier</font><font color="#CCCCCC"> to do that</font><font color="#E5E5E5"> since the</font>

287
00:13:38,260 --> 00:13:44,800
networks are extremely small things like

288
00:13:40,330 --> 00:13:45,760
the ICMP<font color="#E5E5E5"> forget what the some of the</font>

289
00:13:44,800 --> 00:13:48,040
<font color="#E5E5E5">other</font><font color="#CCCCCC"> things but basically it's like</font>

290
00:13:45,760 --> 00:13:50,050
ICMP there was no gateway I could go<font color="#E5E5E5"> to</font>

291
00:13:48,040 --> 00:13:53,430
like spoof out the Gateway for these

292
00:13:50,050 --> 00:13:56,709
connections so since this is so small

293
00:13:53,430 --> 00:13:58,599
and this switch<font color="#E5E5E5"> really wasn't doing a</font>

294
00:13:56,710 --> 00:14:00,490
whole lot<font color="#CCCCCC"> of layer 3 routing or anything</font>

295
00:13:58,600 --> 00:14:02,230
like that our poisoning was the only one

296
00:14:00,490 --> 00:14:04,810
that<font color="#CCCCCC"> really made sense since it was all</font>

297
00:14:02,230 --> 00:14:07,270
physically on the same switch it wasn't

298
00:14:04,810 --> 00:14:09,849
have the trans transmitted over routes

299
00:14:07,270 --> 00:14:12,610
or anything and just<font color="#E5E5E5"> to let you know I</font>

300
00:14:09,850 --> 00:14:16,840
actually did run all<font color="#CCCCCC"> of this stuff</font>

301
00:14:12,610 --> 00:14:18,880
through a through<font color="#E5E5E5"> virustotal</font><font color="#CCCCCC"> Network</font>

302
00:14:16,840 --> 00:14:22,240
minor and bro like all the actual stuff

303
00:14:18,880 --> 00:14:25,000
that I actually ran against this system

304
00:14:22,240 --> 00:14:28,290
I ran those through and none of them

305
00:14:25,000 --> 00:14:30,670
detected the attacks or at least alerted

306
00:14:28,290 --> 00:14:32,890
like there was some<font color="#E5E5E5"> really bad thing</font>

307
00:14:30,670 --> 00:14:35,110
going on it noticed some new traffic

308
00:14:32,890 --> 00:14:37,090
noticed some ICMP traffic that came

309
00:14:35,110 --> 00:14:40,390
through for the for the art poisoning

310
00:14:37,090 --> 00:14:43,830
itself but that was it there was nothing

311
00:14:40,390 --> 00:14:49,120
extra special that it really alerted on

312
00:14:43,830 --> 00:14:55,290
so these are pretty stealthy if you

313
00:14:49,120 --> 00:14:58,120
actually can go through them it's uh

314
00:14:55,290 --> 00:14:59,380
they are<font color="#E5E5E5"> working on it I know I've</font>

315
00:14:58,120 --> 00:15:00,520
actually worked with Liam<font color="#E5E5E5"> and he</font>

316
00:14:59,380 --> 00:15:03,550
actually wanted<font color="#E5E5E5"> to try and play around</font>

317
00:15:00,520 --> 00:15:06,310
<font color="#E5E5E5">with one of these boxes but he left DC</font>

318
00:15:03,550 --> 00:15:08,109
before you get a chance<font color="#E5E5E5"> to do it so but</font>

319
00:15:06,310 --> 00:15:10,599
<font color="#E5E5E5">yeah he he wants to play around and</font>

320
00:15:08,110 --> 00:15:12,610
actually learn more about ethernet/ip I

321
00:15:10,600 --> 00:15:14,200
know that they do have<font color="#E5E5E5"> something in</font>

322
00:15:12,610 --> 00:15:19,720
there for it but I<font color="#E5E5E5"> don't know to what</font>

323
00:15:14,200 --> 00:15:21,460
extent they've got stuff so um I did

324
00:15:19,720 --> 00:15:23,380
actually run a filtered attack just<font color="#E5E5E5"> to</font>

325
00:15:21,460 --> 00:15:25,660
see if I could actually adjust the data

326
00:15:23,380 --> 00:15:30,310
that<font color="#E5E5E5"> was going on through here and and</font>

327
00:15:25,660 --> 00:15:32,860
turn<font color="#E5E5E5"> lights on and off without without</font>

328
00:15:30,310 --> 00:15:37,599
the system<font color="#E5E5E5"> really realizing what was</font>

329
00:15:32,860 --> 00:15:39,610
<font color="#E5E5E5">going on so inside the because it uses</font>

330
00:15:37,600 --> 00:15:41,620
UDP

331
00:15:39,610 --> 00:15:43,899
it's a connection<font color="#E5E5E5"> it's connectionless so</font>

332
00:15:41,620 --> 00:15:45,790
what they do is they handle the

333
00:15:43,899 --> 00:15:48,220
connection oriented stuff at the upper

334
00:15:45,790 --> 00:15:51,399
levels at<font color="#CCCCCC"> the actual layer 7 application</font>

335
00:15:48,220 --> 00:15:52,779
layer so they have embedded in the

336
00:15:51,399 --> 00:15:56,290
real-time communication they use a

337
00:15:52,779 --> 00:15:59,950
connection ID a sequence number and then

338
00:15:56,290 --> 00:16:02,740
the data<font color="#E5E5E5"> is a separate field so in order</font>

339
00:15:59,950 --> 00:16:04,839
to actually spoof out the signals what i

340
00:16:02,740 --> 00:16:08,950
did is i advanced the sequence number by

341
00:16:04,839 --> 00:16:13,390
<font color="#CCCCCC">five to basically make mice my signal</font>

342
00:16:08,950 --> 00:16:15,970
more relevant<font color="#E5E5E5"> and it actually basically</font>

343
00:16:13,390 --> 00:16:19,180
said<font color="#CCCCCC"> okay the PLC signal that was</font><font color="#E5E5E5"> that</font>

344
00:16:15,970 --> 00:16:21,519
the sequence number minus<font color="#E5E5E5"> five is old</font>

345
00:16:19,180 --> 00:16:25,120
data so that doesn't<font color="#E5E5E5"> matter</font><font color="#CCCCCC"> anymore so</font>

346
00:16:21,519 --> 00:16:27,279
it<font color="#E5E5E5"> just said screw it you're done and it</font>

347
00:16:25,120 --> 00:16:32,440
took my man in<font color="#E5E5E5"> the middle data as</font>

348
00:16:27,279 --> 00:16:35,589
preferred data that point yep exactly

349
00:16:32,440 --> 00:16:38,019
I'm and and they're<font color="#E5E5E5"> supposed to be some</font>

350
00:16:35,589 --> 00:16:40,990
protocol stuff to handle that where it's

351
00:16:38,019 --> 00:16:44,980
only allowed to handle one sequence

352
00:16:40,990 --> 00:16:46,959
number change at a time but I chose five

353
00:16:44,980 --> 00:16:49,060
in this case<font color="#CCCCCC"> to make it obvious but you</font>

354
00:16:46,959 --> 00:16:51,219
can<font color="#E5E5E5"> actually I did it to where I just</font>

355
00:16:49,060 --> 00:16:54,640
advanced at one sequence number and that

356
00:16:51,220 --> 00:16:56,529
worked just as well so I only did it for

357
00:16:54,640 --> 00:16:59,490
five here just to make sure that it was

358
00:16:56,529 --> 00:17:01,810
actually noticeable in the data itself

359
00:16:59,490 --> 00:17:03,190
and then what<font color="#E5E5E5"> I did is I actually wanted</font>

360
00:17:01,810 --> 00:17:06,458
<font color="#CCCCCC">to see what would happen</font><font color="#E5E5E5"> to the data</font>

361
00:17:03,190 --> 00:17:08,230
itself if I adjusted things so I

362
00:17:06,459 --> 00:17:12,189
adjusted the data signals for these

363
00:17:08,230 --> 00:17:14,980
buttons coming the commanded data what I

364
00:17:12,189 --> 00:17:17,620
did<font color="#E5E5E5"> is like the command from the PLC to</font>

365
00:17:14,980 --> 00:17:20,410
the<font color="#E5E5E5"> i/o block I actually adjusted I</font>

366
00:17:17,619 --> 00:17:22,869
added for to that which you'll<font color="#CCCCCC"> see at</font>

367
00:17:20,410 --> 00:17:27,880
<font color="#CCCCCC">the end basically just shifts over which</font>

368
00:17:22,869 --> 00:17:30,879
button it thinks is pushed so it

369
00:17:27,880 --> 00:17:34,390
actually it when it thought it<font color="#CCCCCC"> was open</font>

370
00:17:30,880 --> 00:17:37,510
and not pushed it actually looked like

371
00:17:34,390 --> 00:17:42,070
it was pushed from the<font color="#E5E5E5"> PLC said go ahead</font>

372
00:17:37,510 --> 00:17:43,660
and light that light so and I put this

373
00:17:42,070 --> 00:17:45,428
up here on the screen I'm actually

374
00:17:43,660 --> 00:17:46,840
checking to find out I have to check

375
00:17:45,429 --> 00:17:49,120
with my employer to find out if I'm

376
00:17:46,840 --> 00:17:51,370
allowed to<font color="#CCCCCC"> release these since it is</font>

377
00:17:49,120 --> 00:17:53,110
actually<font color="#E5E5E5"> an attack against an industrial</font>

378
00:17:51,370 --> 00:17:56,080
protocol I don't know if I'm going to

379
00:17:53,110 --> 00:18:02,020
legally allowed to do that but or if our

380
00:17:56,080 --> 00:18:04,899
<font color="#E5E5E5">lawyers will just throw a fit so I've</font>

381
00:18:02,020 --> 00:18:06,610
got it basically I'll find out<font color="#CCCCCC"> and let</font>

382
00:18:04,900 --> 00:18:10,750
<font color="#E5E5E5">people know on Twitter if that's going</font>

383
00:18:06,610 --> 00:18:12,580
to happen so so this is<font color="#E5E5E5"> actually the</font>

384
00:18:10,750 --> 00:18:15,309
series of tests<font color="#CCCCCC"> that</font><font color="#E5E5E5"> Iran Iran one</font>

385
00:18:12,580 --> 00:18:16,870
series with the multicast which this is

386
00:18:15,309 --> 00:18:19,710
actually the more common way that in

387
00:18:16,870 --> 00:18:23,110
<font color="#E5E5E5">Ethernet IP is run with multicast</font>

388
00:18:19,710 --> 00:18:25,000
publisher data and I ran a baseline I

389
00:18:23,110 --> 00:18:27,100
actually rent through and did the button

390
00:18:25,000 --> 00:18:30,840
pushes just to see what the different

391
00:18:27,100 --> 00:18:33,340
data comes out as ran the middle attack

392
00:18:30,840 --> 00:18:35,530
here I did man-in-the-middle attack with

393
00:18:33,340 --> 00:18:37,510
<font color="#E5E5E5">the button pushes ran the filter and</font>

394
00:18:35,530 --> 00:18:39,639
then reran with the button pushes and

395
00:18:37,510 --> 00:18:43,390
then<font color="#E5E5E5"> I ran the whole series again with</font>

396
00:18:39,640 --> 00:18:44,470
unicast data as well so and this is

397
00:18:43,390 --> 00:18:46,419
another<font color="#E5E5E5"> one of these things I</font><font color="#CCCCCC"> got to</font>

398
00:18:44,470 --> 00:18:49,179
<font color="#CCCCCC">check with</font><font color="#E5E5E5"> my employer whether I'm</font>

399
00:18:46,419 --> 00:18:51,490
allowed to post these capture files I

400
00:18:49,179 --> 00:18:52,990
think the Wireshark captures I might be

401
00:18:51,490 --> 00:19:01,030
able to post I'm not<font color="#CCCCCC"> sure about the</font>

402
00:18:52,990 --> 00:19:03,130
filter itself but hey it I<font color="#E5E5E5"> mean this</font><font color="#CCCCCC"> was</font>

403
00:19:01,030 --> 00:19:06,190
this<font color="#CCCCCC"> is the filter here it's like four</font>

404
00:19:03,130 --> 00:19:07,480
lines five lines of code so but I just

405
00:19:06,190 --> 00:19:12,610
<font color="#E5E5E5">got to check whether I'm allowed to post</font>

406
00:19:07,480 --> 00:19:15,610
that up on<font color="#CCCCCC"> the Internet so here's the</font>

407
00:19:12,610 --> 00:19:18,580
actual like detailed information I had

408
00:19:15,610 --> 00:19:22,418
the mac address for the<font color="#E5E5E5"> plc the IP</font>

409
00:19:18,580 --> 00:19:24,520
address<font color="#CCCCCC"> mac address IP address the plc</font>

410
00:19:22,419 --> 00:19:27,549
i/o block was running 10 milliseconds

411
00:19:24,520 --> 00:19:29,790
cyclic frequency and<font color="#E5E5E5"> this is a unicast</font>

412
00:19:27,549 --> 00:19:33,450
connection here so<font color="#E5E5E5"> this is always saying</font>

413
00:19:29,790 --> 00:19:36,340
I'm talking to you directly over unicast

414
00:19:33,450 --> 00:19:41,260
and then the<font color="#E5E5E5"> i/o block publisher of the</font>

415
00:19:36,340 --> 00:19:42,490
data was using did both multicast so the

416
00:19:41,260 --> 00:19:46,840
multicast is going out<font color="#E5E5E5"> to this IP</font>

417
00:19:42,490 --> 00:19:48,730
address at that<font color="#E5E5E5"> 10 frequency unicast of</font>

418
00:19:46,840 --> 00:19:51,809
course goes directly to it and then

419
00:19:48,730 --> 00:19:55,630
that's the mac address of my vmware

420
00:19:51,809 --> 00:19:57,780
man-in-the-middle station so when you

421
00:19:55,630 --> 00:20:01,030
actually get into looking at stuff

422
00:19:57,780 --> 00:20:06,090
here's just again so for the baseline

423
00:20:01,030 --> 00:20:08,428
test this connection here was unicast

424
00:20:06,090 --> 00:20:09,990
and then this was either multicast or

425
00:20:08,429 --> 00:20:14,130
unicast depending on the test<font color="#E5E5E5"> that I was</font>

426
00:20:09,990 --> 00:20:16,440
running and so let me<font color="#CCCCCC"> explain a little</font>

427
00:20:14,130 --> 00:20:19,909
bit what this is what you're actually

428
00:20:16,440 --> 00:20:23,549
looking at is the cyclic frequency of

429
00:20:19,909 --> 00:20:26,820
these signals so this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> actually 10</font>

430
00:20:23,549 --> 00:20:30,629
milliseconds right here and what you<font color="#E5E5E5"> see</font>

431
00:20:26,820 --> 00:20:35,520
is between about<font color="#E5E5E5"> 10 point this is 10.4</font>

432
00:20:30,630 --> 00:20:37,740
here and this is 9.8 so within about

433
00:20:35,520 --> 00:20:42,350
four hundred microseconds distribution

434
00:20:37,740 --> 00:20:44,580
you get these signals all going

435
00:20:42,350 --> 00:20:46,320
basically at approximately<font color="#CCCCCC"> ten</font>

436
00:20:44,580 --> 00:20:48,720
milliseconds every 10 milliseconds

437
00:20:46,320 --> 00:20:51,990
you've got your spacing on what the data

438
00:20:48,720 --> 00:20:54,570
<font color="#E5E5E5">is and then this is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> this is the PLC</font>

439
00:20:51,990 --> 00:20:56,929
communication to the<font color="#E5E5E5"> i/o block itself a</font>

440
00:20:54,570 --> 00:21:02,279
little<font color="#CCCCCC"> bit wider</font><font color="#E5E5E5"> distribution but again</font>

441
00:20:56,929 --> 00:21:03,779
this is 10 this is 10.4 10.6 so again

442
00:21:02,279 --> 00:21:06,419
you've got<font color="#CCCCCC"> about maybe five hundred</font>

443
00:21:03,779 --> 00:21:09,840
micro second distribution on here and so

444
00:21:06,419 --> 00:21:13,320
these are fairly deterministic this is

445
00:21:09,840 --> 00:21:16,590
well within ten percent of the mean of

446
00:21:13,320 --> 00:21:19,710
the<font color="#E5E5E5"> signal so this is this is pretty</font>

447
00:21:16,590 --> 00:21:22,139
<font color="#E5E5E5">well deterministic on your signals so</font>

448
00:21:19,710 --> 00:21:25,590
now what happens<font color="#E5E5E5"> when you actually run</font>

449
00:21:22,140 --> 00:21:30,750
the man the middle attack and so for the

450
00:21:25,590 --> 00:21:33,360
multicast test because this signal was

451
00:21:30,750 --> 00:21:35,220
multicast coming back the man in the

452
00:21:33,360 --> 00:21:38,309
middle attack did not actually do it

453
00:21:35,220 --> 00:21:40,230
because it<font color="#CCCCCC"> was going after IP address to</font>

454
00:21:38,309 --> 00:21:42,299
IP address and since this was<font color="#E5E5E5"> actually</font>

455
00:21:40,230 --> 00:21:44,760
going on<font color="#E5E5E5"> over multicast it never</font>

456
00:21:42,299 --> 00:21:47,220
actually was affected by<font color="#CCCCCC"> the Manimal</font>

457
00:21:44,760 --> 00:21:50,250
attack itself the only one<font color="#E5E5E5"> that was was</font>

458
00:21:47,220 --> 00:21:53,490
the signal between the<font color="#E5E5E5"> PLC and the</font><font color="#CCCCCC"> i/o</font>

459
00:21:50,250 --> 00:21:58,320
block so when you actually look at<font color="#CCCCCC"> it</font>

460
00:21:53,490 --> 00:22:01,049
you'll see two packets from the<font color="#E5E5E5"> PLC</font>

461
00:21:58,320 --> 00:22:03,240
effectively from the PLC to the i/o

462
00:22:01,049 --> 00:22:06,330
block but when you<font color="#E5E5E5"> actually start</font>

463
00:22:03,240 --> 00:22:08,490
looking at the ethernet packet here like

464
00:22:06,330 --> 00:22:12,928
in this particular packet this one went

465
00:22:08,490 --> 00:22:14,820
from the PLC to the<font color="#E5E5E5"> VMware station the</font>

466
00:22:12,929 --> 00:22:18,679
next one of course went from the VL via

467
00:22:14,820 --> 00:22:20,139
VMware station to the<font color="#E5E5E5"> i/o block itself</font>

468
00:22:18,679 --> 00:22:22,300
and then

469
00:22:20,140 --> 00:22:26,530
as<font color="#E5E5E5"> I show here down here is the sequence</font>

470
00:22:22,300 --> 00:22:27,909
number and data from this I was not

471
00:22:26,530 --> 00:22:29,530
running<font color="#E5E5E5"> the filter at this time I've got</font>

472
00:22:27,910 --> 00:22:31,780
<font color="#E5E5E5">another one later that actually shows</font>

473
00:22:29,530 --> 00:22:34,330
the filter but you can actually see in

474
00:22:31,780 --> 00:22:39,340
the sequence numbers and then again in

475
00:22:34,330 --> 00:22:40,899
in the ethernet/ip like version here

476
00:22:39,340 --> 00:22:42,340
you've got<font color="#E5E5E5"> a connection ID and the</font>

477
00:22:40,900 --> 00:22:47,430
sequence number and so you can<font color="#E5E5E5"> actually</font>

478
00:22:42,340 --> 00:22:50,409
watch it<font color="#E5E5E5"> moving up as you go along so</font>

479
00:22:47,430 --> 00:22:52,990
with the multicast<font color="#E5E5E5"> tests basically</font>

480
00:22:50,410 --> 00:22:55,450
there's no difference between<font color="#E5E5E5"> what the</font>

481
00:22:52,990 --> 00:22:57,700
<font color="#CCCCCC">PLC is</font><font color="#E5E5E5"> sending out and what the i/o</font>

482
00:22:55,450 --> 00:22:58,930
block is sending out they don't<font color="#CCCCCC"> even</font>

483
00:22:57,700 --> 00:23:01,540
notice<font color="#CCCCCC"> that a man of middle attacks</font>

484
00:22:58,930 --> 00:23:03,010
going on at all they are pretty dumb

485
00:23:01,540 --> 00:23:05,770
with this they don't<font color="#CCCCCC"> even</font><font color="#E5E5E5"> know</font>

486
00:23:03,010 --> 00:23:08,050
anything's going on but then what

487
00:23:05,770 --> 00:23:11,200
<font color="#CCCCCC">happens when you actually look at so</font>

488
00:23:08,050 --> 00:23:17,710
this<font color="#CCCCCC"> is looking</font><font color="#E5E5E5"> at just the IP address</font>

489
00:23:11,200 --> 00:23:21,910
of the the PLC to the IP address of the

490
00:23:17,710 --> 00:23:23,110
<font color="#E5E5E5">i/o block and then so obviously this is</font>

491
00:23:21,910 --> 00:23:26,350
where I was running the man in the

492
00:23:23,110 --> 00:23:29,139
middle attack here this is actually

493
00:23:26,350 --> 00:23:31,389
<font color="#E5E5E5">combined</font><font color="#CCCCCC"> it's seen both those sets of</font>

494
00:23:29,140 --> 00:23:33,880
packets so<font color="#E5E5E5"> looking back at this it's</font>

495
00:23:31,390 --> 00:23:36,160
actually<font color="#E5E5E5"> doing it's actually just</font>

496
00:23:33,880 --> 00:23:39,070
analyzing both these sets of packets in

497
00:23:36,160 --> 00:23:40,900
here so this isn't<font color="#CCCCCC"> really what</font><font color="#E5E5E5"> you want</font>

498
00:23:39,070 --> 00:23:44,860
to look at this is what you want to<font color="#E5E5E5"> look</font>

499
00:23:40,900 --> 00:23:48,160
at so this is what the actual<font color="#E5E5E5"> IO block</font>

500
00:23:44,860 --> 00:23:50,949
is seeing that's directed at its<font color="#E5E5E5"> Mac so</font>

501
00:23:48,160 --> 00:23:52,750
here you've got<font color="#CCCCCC"> the PLC signal and then</font>

502
00:23:50,950 --> 00:23:55,030
you actually<font color="#E5E5E5"> launch the man in the</font>

503
00:23:52,750 --> 00:23:58,840
middle attack and<font color="#CCCCCC"> you notice the man in</font>

504
00:23:55,030 --> 00:24:01,510
the middle attack itself doesn't<font color="#CCCCCC"> okay so</font>

505
00:23:58,840 --> 00:24:03,129
it doesn't affect<font color="#CCCCCC"> a mean of</font><font color="#E5E5E5"> the signal</font>

506
00:24:01,510 --> 00:24:06,220
at all but<font color="#E5E5E5"> there is a noticeable</font>

507
00:24:03,130 --> 00:24:10,150
difference in the distribution<font color="#E5E5E5"> of the</font>

508
00:24:06,220 --> 00:24:12,040
attack from the PLC to the<font color="#CCCCCC"> i/o block</font>

509
00:24:10,150 --> 00:24:16,450
where this actual man-in-the-middle

510
00:24:12,040 --> 00:24:19,360
attack was going on but again<font color="#E5E5E5"> most of</font>

511
00:24:16,450 --> 00:24:21,280
<font color="#E5E5E5">these devices they take averages so as</font>

512
00:24:19,360 --> 00:24:23,949
long as<font color="#CCCCCC"> the average number of packets</font>

513
00:24:21,280 --> 00:24:28,570
remains the same they don't<font color="#CCCCCC"> actually</font>

514
00:24:23,950 --> 00:24:30,820
record anything about the they don't

515
00:24:28,570 --> 00:24:31,840
record anything about the the packet

516
00:24:30,820 --> 00:24:32,800
distributions or anything like that

517
00:24:31,840 --> 00:24:33,939
internally

518
00:24:32,800 --> 00:24:36,220
this is the kind of stuff you can

519
00:24:33,940 --> 00:24:38,860
measure yourself though<font color="#E5E5E5"> you can go in</font>

520
00:24:36,220 --> 00:24:43,570
and<font color="#CCCCCC"> just run wireshark captures take</font>

521
00:24:38,860 --> 00:24:46,479
Wireshark and export to whatever you

522
00:24:43,570 --> 00:24:48,669
want the<font color="#CCCCCC"> i actually did this</font><font color="#E5E5E5"> is using my</font>

523
00:24:46,480 --> 00:24:51,340
specialized analysis software but you

524
00:24:48,670 --> 00:24:53,860
can take and throw this into a<font color="#CCCCCC"> csv file</font>

525
00:24:51,340 --> 00:24:56,189
and plot it in<font color="#CCCCCC"> excel if you want this is</font>

526
00:24:53,860 --> 00:24:58,929
actually<font color="#E5E5E5"> not that hard to do in Excel</font>

527
00:24:56,190 --> 00:25:00,700
basically you isolate the you isolate

528
00:24:58,930 --> 00:25:02,440
the stream you want and then it comes

529
00:25:00,700 --> 00:25:04,420
<font color="#E5E5E5">out as a nice straight long number you</font>

530
00:25:02,440 --> 00:25:06,430
can post the data and<font color="#E5E5E5"> actually figure</font>

531
00:25:04,420 --> 00:25:08,440
<font color="#CCCCCC">out what the communications is on this</font>

532
00:25:06,430 --> 00:25:11,380
all this is is just<font color="#E5E5E5"> literally the time</font>

533
00:25:08,440 --> 00:25:14,560
during the test over the time between

534
00:25:11,380 --> 00:25:17,590
subsequent packets so it's a delta time

535
00:25:14,560 --> 00:25:19,300
versus time so it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> that hard to</font><font color="#E5E5E5"> do</font>

536
00:25:17,590 --> 00:25:21,280
I've got actually a little bit more

537
00:25:19,300 --> 00:25:24,820
information<font color="#CCCCCC"> on</font><font color="#E5E5E5"> that from talk I did it</font>

538
00:25:21,280 --> 00:25:28,540
besides DC last month i<font color="#CCCCCC"> think it</font><font color="#E5E5E5"> was so</font>

539
00:25:24,820 --> 00:25:32,470
if you want that<font color="#E5E5E5"> and it's it's not that</font>

540
00:25:28,540 --> 00:25:35,020
hard to do so now<font color="#E5E5E5"> running unicast the</font>

541
00:25:32,470 --> 00:25:37,360
man in the middle attack actually did do

542
00:25:35,020 --> 00:25:39,610
the reverse communications and now you

543
00:25:37,360 --> 00:25:42,550
get<font color="#E5E5E5"> something very similar so in here</font>

544
00:25:39,610 --> 00:25:47,800
you've got<font color="#CCCCCC"> now two packets going for</font>

545
00:25:42,550 --> 00:25:51,790
each one that you initially had from the

546
00:25:47,800 --> 00:25:53,950
from the devices and again the<font color="#CCCCCC"> plc</font>

547
00:25:51,790 --> 00:25:55,629
itself and the<font color="#E5E5E5"> i/o block itself didn't</font>

548
00:25:53,950 --> 00:25:57,010
care one way or the other than the man

549
00:25:55,630 --> 00:25:58,810
<font color="#E5E5E5">of middle attack was going on they</font>

550
00:25:57,010 --> 00:26:03,580
<font color="#E5E5E5">actually didn't adjust their timing at</font>

551
00:25:58,810 --> 00:26:05,080
all but then like the<font color="#E5E5E5"> first time this is</font>

552
00:26:03,580 --> 00:26:07,600
actually what<font color="#CCCCCC"> it looks like just doing</font>

553
00:26:05,080 --> 00:26:09,790
the IP<font color="#CCCCCC"> address and in this particular</font>

554
00:26:07,600 --> 00:26:11,949
case the herringbone patterns<font color="#E5E5E5"> from what</font>

555
00:26:09,790 --> 00:26:14,110
<font color="#E5E5E5">I've seen a lot of times has to do with</font>

556
00:26:11,950 --> 00:26:16,780
clock skew between the two different

557
00:26:14,110 --> 00:26:18,429
devices the man in the middle<font color="#E5E5E5"> at the man</font>

558
00:26:16,780 --> 00:26:21,149
of the middle pc was just a slightly

559
00:26:18,430 --> 00:26:24,400
clock skewed so it it drifted

560
00:26:21,150 --> 00:26:26,140
differently than the device so that's

561
00:26:24,400 --> 00:26:28,090
where you get these weird patterns in

562
00:26:26,140 --> 00:26:29,800
here but<font color="#E5E5E5"> again this isn't really</font><font color="#CCCCCC"> what</font>

563
00:26:28,090 --> 00:26:32,070
you want to<font color="#E5E5E5"> look at this is what you</font>

564
00:26:29,800 --> 00:26:35,350
want to<font color="#E5E5E5"> look at and so this</font><font color="#CCCCCC"> is actually</font>

565
00:26:32,070 --> 00:26:38,500
looking<font color="#E5E5E5"> at the man in</font><font color="#CCCCCC"> the middle attack</font>

566
00:26:35,350 --> 00:26:40,480
here this is the the standard plc to<font color="#CCCCCC"> i/o</font>

567
00:26:38,500 --> 00:26:42,100
block communications or this is actually

568
00:26:40,480 --> 00:26:44,170
sorry this is the i/o block coming<font color="#E5E5E5"> out</font>

569
00:26:42,100 --> 00:26:46,379
and again the mean remains the same so

570
00:26:44,170 --> 00:26:48,300
in general you actually wouldn't

571
00:26:46,380 --> 00:26:50,430
no statistics would happen in<font color="#E5E5E5"> this</font>

572
00:26:48,300 --> 00:26:52,440
system that would tell you anything was

573
00:26:50,430 --> 00:26:54,270
going on this is the kind of thing<font color="#CCCCCC"> that</font>

574
00:26:52,440 --> 00:27:00,330
you can capture yourself on a monitor

575
00:26:54,270 --> 00:27:04,139
port and do some form of of analysis NSM

576
00:27:00,330 --> 00:27:06,720
basically with very cheap tools a laptop

577
00:27:04,140 --> 00:27:16,560
Wireshark and Excel you can do this

578
00:27:06,720 --> 00:27:18,540
stuff yourself yes yes exactly and that

579
00:27:16,560 --> 00:27:22,590
the kind of thing that this<font color="#E5E5E5"> is what you</font>

580
00:27:18,540 --> 00:27:24,149
would<font color="#E5E5E5"> do periodically testing so this</font><font color="#CCCCCC"> is</font>

581
00:27:22,590 --> 00:27:28,290
a huge<font color="#E5E5E5"> amount of data to try and go</font>

582
00:27:24,150 --> 00:27:29,400
through in real time but it's the kind

583
00:27:28,290 --> 00:27:33,240
of thing that if you had to do a

584
00:27:29,400 --> 00:27:35,250
periodic yearly annual assessment you go

585
00:27:33,240 --> 00:27:37,410
through you go to each you go to

586
00:27:35,250 --> 00:27:40,560
different<font color="#E5E5E5"> places around your network you</font>

587
00:27:37,410 --> 00:27:42,570
capture<font color="#CCCCCC"> the traffic</font><font color="#E5E5E5"> and you</font><font color="#CCCCCC"> spend a week</font>

588
00:27:40,560 --> 00:27:44,909
<font color="#E5E5E5">or two analyzing it coming up with a</font>

589
00:27:42,570 --> 00:27:48,629
signature of what your system has in it

590
00:27:44,910 --> 00:27:50,340
to begin with and during your factory

591
00:27:48,630 --> 00:27:52,560
acceptance testing your site except as

592
00:27:50,340 --> 00:27:54,480
testing<font color="#E5E5E5"> your commissioning basically all</font>

593
00:27:52,560 --> 00:27:57,090
<font color="#E5E5E5">during that time where you can get clean</font>

594
00:27:54,480 --> 00:27:59,730
gold standard versions of what should<font color="#E5E5E5"> be</font>

595
00:27:57,090 --> 00:28:01,169
on your systems at any one time and then

596
00:27:59,730 --> 00:28:02,610
you can come<font color="#CCCCCC"> back and start comparing</font>

597
00:28:01,170 --> 00:28:05,520
them and look for these different

598
00:28:02,610 --> 00:28:07,860
signatures of<font color="#CCCCCC"> Oh sums something is</font>

599
00:28:05,520 --> 00:28:09,150
different than what it used to<font color="#CCCCCC"> be hmm</font>

600
00:28:07,860 --> 00:28:11,219
maybe I should go<font color="#CCCCCC"> and investigate and</font>

601
00:28:09,150 --> 00:28:12,960
then and<font color="#E5E5E5"> then you go in and do second</font>

602
00:28:11,220 --> 00:28:16,130
tier third to your analysis of what's

603
00:28:12,960 --> 00:28:19,320
going<font color="#E5E5E5"> on but just</font><font color="#CCCCCC"> looking at what</font>

604
00:28:16,130 --> 00:28:21,210
happened now versus what happened<font color="#E5E5E5"> before</font>

605
00:28:19,320 --> 00:28:25,260
you<font color="#CCCCCC"> can really get</font><font color="#E5E5E5"> a lot of information</font>

606
00:28:21,210 --> 00:28:26,760
out of your systems so now I did

607
00:28:25,260 --> 00:28:29,160
actually run the filter just<font color="#E5E5E5"> to see what</font>

608
00:28:26,760 --> 00:28:33,780
would happen and<font color="#E5E5E5"> I can</font><font color="#CCCCCC"> show you this</font>

609
00:28:29,160 --> 00:28:36,810
downstairs to a little bit more but so

610
00:28:33,780 --> 00:28:40,110
we<font color="#E5E5E5"> really weren't looking to see what</font>

611
00:28:36,810 --> 00:28:41,639
effect filter<font color="#E5E5E5"> really wasn't</font><font color="#CCCCCC"> very</font>

612
00:28:40,110 --> 00:28:44,340
difficult as you saw was a few lines of

613
00:28:41,640 --> 00:28:46,380
code it really didn't do very much but

614
00:28:44,340 --> 00:28:47,820
it was<font color="#CCCCCC"> something to</font><font color="#E5E5E5"> see if the filter</font>

615
00:28:46,380 --> 00:28:50,310
actually had any<font color="#E5E5E5"> effect on the</font>

616
00:28:47,820 --> 00:28:53,100
performance data did did running<font color="#CCCCCC"> a</font>

617
00:28:50,310 --> 00:28:55,320
filter here on this actually move these

618
00:28:53,100 --> 00:28:57,719
lines at all because of<font color="#E5E5E5"> the additional</font>

619
00:28:55,320 --> 00:29:00,120
processing that had to<font color="#CCCCCC"> go on in the man</font>

620
00:28:57,720 --> 00:29:02,400
middle attack itself well basically<font color="#CCCCCC"> we</font>

621
00:29:00,120 --> 00:29:03,659
did the we did everything here and it

622
00:29:02,400 --> 00:29:05,810
actually didn't affect the performance

623
00:29:03,660 --> 00:29:09,900
at all it was<font color="#E5E5E5"> pretty much the</font><font color="#CCCCCC"> same thing</font>

624
00:29:05,810 --> 00:29:11,429
what I did<font color="#CCCCCC"> just to lay it out here so I</font>

625
00:29:09,900 --> 00:29:14,670
actually went<font color="#E5E5E5"> through and ran a whole</font>

626
00:29:11,430 --> 00:29:16,710
series of tests one went through the

627
00:29:14,670 --> 00:29:18,600
whole process I only put in a few<font color="#CCCCCC"> of the</font>

628
00:29:16,710 --> 00:29:22,500
buttons here but I've got<font color="#CCCCCC"> the full set</font>

629
00:29:18,600 --> 00:29:24,360
of like two of<font color="#E5E5E5"> them and then three of</font>

630
00:29:22,500 --> 00:29:26,670
them and did a whole series of that kind

631
00:29:24,360 --> 00:29:28,439
of stuff<font color="#E5E5E5"> that I've got recorded and</font>

632
00:29:26,670 --> 00:29:29,610
basically with what you can see here is

633
00:29:28,440 --> 00:29:31,650
that<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the signal it was</font>

634
00:29:29,610 --> 00:29:33,540
originally here and all it did is just

635
00:29:31,650 --> 00:29:35,790
<font color="#E5E5E5">add four to the data effectively what</font>

636
00:29:33,540 --> 00:29:38,370
that did is that shifted the bit pattern

637
00:29:35,790 --> 00:29:41,580
over so one of<font color="#E5E5E5"> the buttons acted</font>

638
00:29:38,370 --> 00:29:43,520
opposite of the way it<font color="#CCCCCC"> should so I think</font>

639
00:29:41,580 --> 00:29:46,919
in this case it was this second button

640
00:29:43,520 --> 00:29:49,980
that was uh that was basically bit

641
00:29:46,920 --> 00:29:51,480
number four it would turn off when it

642
00:29:49,980 --> 00:29:53,400
was<font color="#CCCCCC"> supposed</font><font color="#E5E5E5"> to turn on and it was on</font>

643
00:29:51,480 --> 00:29:56,100
when it was supposed<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be off so pretty</font>

644
00:29:53,400 --> 00:29:57,810
simple instead of it was basically on

645
00:29:56,100 --> 00:30:00,419
now and<font color="#E5E5E5"> then it would shut off when I</font>

646
00:29:57,810 --> 00:30:02,010
would<font color="#E5E5E5"> hit the button but effectively it</font>

647
00:30:00,420 --> 00:30:04,620
showed<font color="#CCCCCC"> that you could actually do this</font>

648
00:30:02,010 --> 00:30:07,710
with relatively simple kinds of things

649
00:30:04,620 --> 00:30:09,679
and as I said<font color="#CCCCCC"> I I learned how to use</font>

650
00:30:07,710 --> 00:30:13,380
that<font color="#E5E5E5"> or cap in about like half an hour</font>

651
00:30:09,680 --> 00:30:15,000
and found iron geeks tutorial and wrote

652
00:30:13,380 --> 00:30:17,220
a filter in about another half an hour

653
00:30:15,000 --> 00:30:19,290
and ran a man-in-the-middle attack so

654
00:30:17,220 --> 00:30:21,870
it's not that<font color="#E5E5E5"> hard to do especially</font>

655
00:30:19,290 --> 00:30:24,360
against industrial control systems that

656
00:30:21,870 --> 00:30:27,239
<font color="#E5E5E5">I mean the stuff exists in wireshark you</font>

657
00:30:24,360 --> 00:30:31,530
can go and figure it out and<font color="#CCCCCC"> then adjust</font>

658
00:30:27,240 --> 00:30:37,890
<font color="#E5E5E5">what you need to do and</font><font color="#CCCCCC"> then here you</font>

659
00:30:31,530 --> 00:30:41,340
can actually see so where is it so this

660
00:30:37,890 --> 00:30:47,760
this packet right here these<font color="#CCCCCC"> two this</font>

661
00:30:41,340 --> 00:30:51,870
was 25 42 it became 2547 and then also

662
00:30:47,760 --> 00:30:55,379
the data in this particular case was 40

663
00:30:51,870 --> 00:30:56,790
and it became 44 that's all I did by

664
00:30:55,380 --> 00:31:00,450
advancing the sequence number I

665
00:30:56,790 --> 00:31:03,360
basically took control by by being newer

666
00:31:00,450 --> 00:31:08,400
than<font color="#E5E5E5"> the previous data so it disregarded</font>

667
00:31:03,360 --> 00:31:10,800
what was going on the captures as i said

668
00:31:08,400 --> 00:31:11,430
i'm going to<font color="#E5E5E5"> try and probably post them</font>

669
00:31:10,800 --> 00:31:14,490
up

670
00:31:11,430 --> 00:31:17,460
our github but I<font color="#CCCCCC"> got to check</font><font color="#E5E5E5"> with my</font>

671
00:31:14,490 --> 00:31:20,130
<font color="#E5E5E5">employer first i will post stuff out to</font>

672
00:31:17,460 --> 00:31:24,060
<font color="#E5E5E5">Twitter after</font><font color="#CCCCCC"> I find out yes or no</font>

673
00:31:20,130 --> 00:31:28,080
whether i can do that<font color="#E5E5E5"> or</font><font color="#CCCCCC"> not and this is</font>

674
00:31:24,060 --> 00:31:33,929
my contact information so Jim<font color="#CCCCCC"> gilson my</font>

675
00:31:28,080 --> 00:31:53,970
Twitter<font color="#E5E5E5"> and so that's it there any</font>

676
00:31:33,930 --> 00:31:56,640
questions yeah extremely so yeah did the

677
00:31:53,970 --> 00:31:58,820
guys that actually did<font color="#E5E5E5"> Stuxnet not that</font>

678
00:31:56,640 --> 00:32:02,430
<font color="#E5E5E5">people know who did</font><font color="#CCCCCC"> that or anything</font>

679
00:31:58,820 --> 00:32:05,399
<font color="#E5E5E5">they had very detailed information about</font>

680
00:32:02,430 --> 00:32:08,040
exactly the system's exactly the data

681
00:32:05,400 --> 00:32:09,300
<font color="#E5E5E5">that was being contained in there and</font>

682
00:32:08,040 --> 00:32:11,190
and they didn't actually run a

683
00:32:09,300 --> 00:32:13,470
man-in-the-middle attack against this

684
00:32:11,190 --> 00:32:14,790
communications they ran it against the

685
00:32:13,470 --> 00:32:18,390
engineering work station which

686
00:32:14,790 --> 00:32:20,720
programmed this and so they they

687
00:32:18,390 --> 00:32:23,460
adjusted the engineering<font color="#E5E5E5"> work station to</font>

688
00:32:20,720 --> 00:32:25,080
actually cause even worse things<font color="#E5E5E5"> I just</font>

689
00:32:23,460 --> 00:32:27,120
did one simple thing but they actually

690
00:32:25,080 --> 00:32:31,379
<font color="#CCCCCC">added a lot of extra math to go in and</font>

691
00:32:27,120 --> 00:32:34,199
actually like vibrate it more and do

692
00:32:31,380 --> 00:32:36,030
some<font color="#E5E5E5"> really nasty stuff to it so but</font>

693
00:32:34,200 --> 00:32:39,630
<font color="#E5E5E5">they had very detailed information about</font>

694
00:32:36,030 --> 00:32:41,790
the very specific protocols and data

695
00:32:39,630 --> 00:32:43,820
sets and everything to go along<font color="#CCCCCC"> with</font>

696
00:32:41,790 --> 00:32:43,820
that

697
00:32:53,059 --> 00:33:01,370
yes actually ethernet IP is in<font color="#CCCCCC"> the</font>

698
00:32:56,749 --> 00:33:05,210
process of actually building in security

699
00:33:01,370 --> 00:33:07,850
to their system since they use a default

700
00:33:05,210 --> 00:33:12,919
tcp/ip stack they're actually putting in

701
00:33:07,850 --> 00:33:16,809
ssl/tls and certificates and the whole

702
00:33:12,919 --> 00:33:22,039
deal some of the other protocols d mp3

703
00:33:16,809 --> 00:33:26,960
has<font color="#CCCCCC"> a certain security built into its</font>

704
00:33:22,039 --> 00:33:30,110
connection but there<font color="#E5E5E5"> are very</font><font color="#CCCCCC"> few that</font>

705
00:33:26,960 --> 00:33:32,149
have security these<font color="#E5E5E5"> systems were never</font>

706
00:33:30,110 --> 00:33:35,330
designed with security in mind they were

707
00:33:32,149 --> 00:33:39,408
designed<font color="#CCCCCC"> to get a job</font><font color="#E5E5E5"> done ethernet IP</font>

708
00:33:35,330 --> 00:33:45,799
is a protocol was written in it was

709
00:33:39,409 --> 00:33:51,049
published<font color="#E5E5E5"> by ODB a in 2001 it was built</font>

710
00:33:45,799 --> 00:33:53,658
by Rockwell before that in the late 90s

711
00:33:51,049 --> 00:33:57,950
but<font color="#CCCCCC"> again it was actually based on a</font>

712
00:33:53,659 --> 00:34:02,389
protocol that was<font color="#E5E5E5"> written for thick net</font>

713
00:33:57,950 --> 00:34:04,249
pipe inside a plant that you couldn't

714
00:34:02,389 --> 00:34:07,158
physically get on to because you didn't

715
00:34:04,249 --> 00:34:09,560
<font color="#E5E5E5">have the the actual connection to tap</font>

716
00:34:07,159 --> 00:34:13,159
into it so the protocol was based on

717
00:34:09,560 --> 00:34:15,230
really<font color="#E5E5E5"> old stuff a field bus technology</font>

718
00:34:13,159 --> 00:34:18,829
that was never designed to have security

719
00:34:15,230 --> 00:34:20,599
built in very<font color="#E5E5E5"> little clothes stuff we're</font>

720
00:34:18,829 --> 00:34:23,329
literally if you if you didn't have your

721
00:34:20,599 --> 00:34:27,919
terminators screwed in tight enough you

722
00:34:23,329 --> 00:34:35,720
would throw the<font color="#E5E5E5"> whole system off so it's</font>

723
00:34:27,918 --> 00:34:39,379
an absolutely some protocols are other

724
00:34:35,719 --> 00:34:41,480
protocols are not so things like profi

725
00:34:39,379 --> 00:34:45,319
net which is a european standard they've

726
00:34:41,480 --> 00:34:46,940
basically decided that they don't need

727
00:34:45,319 --> 00:34:49,489
<font color="#E5E5E5">security because they're now literally</font>

728
00:34:46,940 --> 00:34:52,280
getting rid of parts of the tcp/ip stack

729
00:34:49,489 --> 00:34:57,129
and when you get down into<font color="#E5E5E5"> the real-time</font>

730
00:34:52,280 --> 00:34:59,750
<font color="#E5E5E5">what they call industrial real time</font>

731
00:34:57,130 --> 00:35:03,740
where they're literally synchronizing

732
00:34:59,750 --> 00:35:05,450
motors at microseconds if things<font color="#E5E5E5"> aren't</font>

733
00:35:03,740 --> 00:35:05,750
plugged in just right you're going to

734
00:35:05,450 --> 00:35:07,490
throw

735
00:35:05,750 --> 00:35:08,950
whole system off so again they're

736
00:35:07,490 --> 00:35:16,540
getting down into<font color="#E5E5E5"> where they basically</font>

737
00:35:08,950 --> 00:35:16,540
<font color="#E5E5E5">model the fieldbus</font><font color="#CCCCCC"> over stp cables</font>

738
00:35:29,850 --> 00:35:37,560
well okay so this test uh this

739
00:35:32,880 --> 00:35:46,920
particular test was around 70 seconds of

740
00:35:37,560 --> 00:35:49,890
data and this was<font color="#E5E5E5"> 7,000 points so I mean</font>

741
00:35:46,920 --> 00:35:52,290
not not a huge amount<font color="#CCCCCC"> but the capture</font>

742
00:35:49,890 --> 00:35:54,810
files are already just for that 60

743
00:35:52,290 --> 00:35:57,960
seconds<font color="#E5E5E5"> and this is one device talking</font>

744
00:35:54,810 --> 00:35:59,880
to one other device that's not when you

745
00:35:57,960 --> 00:36:02,070
actually consider a full plant when<font color="#E5E5E5"> you</font>

746
00:35:59,880 --> 00:36:04,050
start considering a full plant then

747
00:36:02,070 --> 00:36:05,850
you're getting into gigabytes of data

748
00:36:04,050 --> 00:36:14,520
per day that you have to go through and

749
00:36:05,850 --> 00:36:17,160
<font color="#E5E5E5">analyze and analyze really down deep not</font>

750
00:36:14,520 --> 00:36:20,070
really because most of the time the<font color="#E5E5E5"> real</font>

751
00:36:17,160 --> 00:36:23,910
<font color="#E5E5E5">time traffic does not leave the local</font>

752
00:36:20,070 --> 00:36:26,400
switch so the real time traffic in a lot

753
00:36:23,910 --> 00:36:29,700
of<font color="#CCCCCC"> these cases</font><font color="#E5E5E5"> they're very cell</font>

754
00:36:26,400 --> 00:36:33,960
oriented so this PLC will talk to this

755
00:36:29,700 --> 00:36:36,569
<font color="#E5E5E5">i/o block and this screen this HMI all</font>

756
00:36:33,960 --> 00:36:38,130
plugged into the same switch and unless

757
00:36:36,570 --> 00:36:39,810
there's some specific amount of

758
00:36:38,130 --> 00:36:43,310
information<font color="#E5E5E5"> that needs to go out of that</font>

759
00:36:39,810 --> 00:36:45,750
switch nothing ever leaves that switch

760
00:36:43,310 --> 00:36:48,660
you need to tap into it and that's where

761
00:36:45,750 --> 00:36:50,490
things like industrial IDs systems there

762
00:36:48,660 --> 00:36:53,129
they've tried<font color="#CCCCCC"> to like really push them</font>

763
00:36:50,490 --> 00:36:54,870
down lower into the architecture but the

764
00:36:53,130 --> 00:36:59,820
<font color="#E5E5E5">problem is you're now talking having to</font>

765
00:36:54,870 --> 00:37:04,700
throw a 1500 to 3000 dollar box at every

766
00:36:59,820 --> 00:37:06,420
single work cell just to do analysis and

767
00:37:04,700 --> 00:37:07,950
then you've<font color="#E5E5E5"> got to build out the</font>

768
00:37:06,420 --> 00:37:11,550
infrastructure to<font color="#E5E5E5"> talk from those guys</font>

769
00:37:07,950 --> 00:37:17,339
to some sort of supervisory IDs and you

770
00:37:11,550 --> 00:37:19,830
really get into problems yes and if

771
00:37:17,340 --> 00:37:23,550
you're dealing<font color="#CCCCCC"> with a medical systems</font>

772
00:37:19,830 --> 00:37:26,790
<font color="#E5E5E5">food and drug any change to the system</font>

773
00:37:23,550 --> 00:37:31,380
at all<font color="#E5E5E5"> requires recertification of the</font>

774
00:37:26,790 --> 00:37:33,420
entire line so not<font color="#E5E5E5"> just recertification</font>

775
00:37:31,380 --> 00:37:36,920
of this one cell you've now got<font color="#E5E5E5"> to</font>

776
00:37:33,420 --> 00:37:42,230
recertify an entire 5200 work cell line

777
00:37:36,920 --> 00:37:42,230
for simply doing AV updates

778
00:37:42,900 --> 00:37:54,770
so companies don't want to do that how

779
00:37:46,619 --> 00:37:58,710
do they do<font color="#E5E5E5"> security today huge levels of</font>

780
00:37:54,770 --> 00:38:00,240
isolation and segregation generally they

781
00:37:58,710 --> 00:38:02,579
basically disconnected as much as

782
00:38:00,240 --> 00:38:03,990
possible and don't touch it if they're

783
00:38:02,579 --> 00:38:08,849
in at that point of where they're doing

784
00:38:03,990 --> 00:38:11,339
<font color="#E5E5E5">Nuclear Regulatory certification or Food</font>

785
00:38:08,849 --> 00:38:14,190
Drug certification things like that most

786
00:38:11,339 --> 00:38:18,440
of<font color="#E5E5E5"> times those systems are install it</font>

787
00:38:14,190 --> 00:38:25,410
and forklift upgraded in 25 years so

788
00:38:18,440 --> 00:38:28,950
that's yes yes yeah literally like

789
00:38:25,410 --> 00:38:33,270
they're down times<font color="#CCCCCC"> their their</font><font color="#E5E5E5"> uptime</font>

790
00:38:28,950 --> 00:38:36,618
downtime is in 79 s reliability they

791
00:38:33,270 --> 00:38:36,619
they just don't shut<font color="#CCCCCC"> down</font>

792
00:38:43,970 --> 00:38:49,109
again syslog will give you averages it

793
00:38:47,700 --> 00:38:50,819
won't give you the detailed

794
00:38:49,110 --> 00:38:53,190
fingerprinting kind of stuff that<font color="#CCCCCC"> you</font>

795
00:38:50,820 --> 00:38:54,990
that you really need<font color="#CCCCCC"> to determine what's</font>

796
00:38:53,190 --> 00:38:57,270
going on yeah averages will give you

797
00:38:54,990 --> 00:38:58,589
some things and you can tell oh yeah all

798
00:38:57,270 --> 00:39:00,210
of<font color="#CCCCCC"> a sudden we're going to ddos from</font>

799
00:38:58,590 --> 00:39:01,530
something over here but i can tell you

800
00:39:00,210 --> 00:39:03,450
most of time when you're<font color="#E5E5E5"> going to do</font>

801
00:39:01,530 --> 00:39:06,000
<font color="#E5E5E5">stuff in the industrial world it's</font>

802
00:39:03,450 --> 00:39:08,759
<font color="#E5E5E5">because the nic card on the HMI went</font>

803
00:39:06,000 --> 00:39:12,810
down and not because you're<font color="#CCCCCC"> getting a</font>

804
00:39:08,760 --> 00:39:14,790
real actual<font color="#E5E5E5"> external DDoS attack or the</font>

805
00:39:12,810 --> 00:39:18,029
guy with the forklift ran over the power

806
00:39:14,790 --> 00:39:20,040
wire or network cable or the fiber that

807
00:39:18,030 --> 00:39:22,680
was hanging<font color="#E5E5E5"> cross here all of a sudden</font>

808
00:39:20,040 --> 00:39:27,270
started to go down<font color="#E5E5E5"> I got hit by the guy</font>

809
00:39:22,680 --> 00:39:29,009
running the stuff across the way or you

810
00:39:27,270 --> 00:39:31,770
turned on<font color="#E5E5E5"> a motor on the other side of</font>

811
00:39:29,010 --> 00:39:34,290
the plant and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> emi translated over</font>

812
00:39:31,770 --> 00:39:42,110
the wire and now you've got now you've

813
00:39:34,290 --> 00:39:45,840
got a problem<font color="#E5E5E5"> with that so yeah 99</font>

814
00:39:42,110 --> 00:39:49,950
whenever we've run into things<font color="#E5E5E5"> I've only</font>

815
00:39:45,840 --> 00:39:54,570
run into one active malware<font color="#E5E5E5"> instance</font>

816
00:39:49,950 --> 00:39:57,660
when I have I did an assessment and even

817
00:39:54,570 --> 00:40:02,040
that malware was questionable it was it

818
00:39:57,660 --> 00:40:03,870
showed up as an attack in virustotal and

819
00:40:02,040 --> 00:40:06,660
a couple other places but when you

820
00:40:03,870 --> 00:40:09,390
really looked at it it it looked like it

821
00:40:06,660 --> 00:40:11,759
was actually an<font color="#E5E5E5"> old industrial device</font>

822
00:40:09,390 --> 00:40:13,440
that was using<font color="#CCCCCC"> a proprietary protocol</font>

823
00:40:11,760 --> 00:40:16,290
and doing something it wasn't supposed

824
00:40:13,440 --> 00:40:21,620
<font color="#CCCCCC">to do but we couldn't verify that so we</font>

825
00:40:16,290 --> 00:40:21,620
had at<font color="#E5E5E5"> least flag it as malware so</font>

826
00:40:27,589 --> 00:40:33,150
of course there is stuff out there the

827
00:40:31,499 --> 00:40:35,459
companies<font color="#CCCCCC"> that I have gone into an</font>

828
00:40:33,150 --> 00:40:39,749
assess that's not the problems that they

829
00:40:35,459 --> 00:40:42,089
have so<font color="#CCCCCC"> um and if you look at have X</font>

830
00:40:39,749 --> 00:40:43,319
have<font color="#E5E5E5"> X was not and that was nothing</font><font color="#CCCCCC"> to</font>

831
00:40:42,089 --> 00:40:49,069
do with the industrial control system

832
00:40:43,319 --> 00:40:52,829
itself that was a rat on the vendor site

833
00:40:49,069 --> 00:40:56,219
so they went basically did a<font color="#CCCCCC"> a rogue</font>

834
00:40:52,829 --> 00:41:00,269
version of the firmware for devices on

835
00:40:56,219 --> 00:41:01,859
the mint on<font color="#CCCCCC"> the actual vendor site and</font>

836
00:41:00,269 --> 00:41:04,198
so when people downloaded a new version

837
00:41:01,859 --> 00:41:06,269
they downloaded the firm the virus<font color="#CCCCCC"> from</font>

838
00:41:04,199 --> 00:41:10,099
<font color="#E5E5E5">there it wasn't</font><font color="#CCCCCC"> actually an attack</font><font color="#E5E5E5"> on</font>

839
00:41:06,269 --> 00:41:10,098
the<font color="#CCCCCC"> industrial control system itself</font>

840
00:41:13,430 --> 00:41:21,589
yeah again it's one of<font color="#E5E5E5"> these that it</font>

841
00:41:17,400 --> 00:41:29,430
exists it's out there people found it

842
00:41:21,589 --> 00:41:32,849
but you attend yeah the likelihood of

843
00:41:29,430 --> 00:41:36,509
actually seeing that on a system you're

844
00:41:32,849 --> 00:41:38,249
assessing is extremely rare<font color="#CCCCCC"> because of</font>

845
00:41:36,509 --> 00:41:40,979
simply the fact that these systems<font color="#E5E5E5"> don't</font>

846
00:41:38,249 --> 00:41:44,299
change and if they do somebody did

847
00:41:40,979 --> 00:41:44,299
something they're not<font color="#E5E5E5"> supposed to do</font>

848
00:41:52,980 --> 00:41:59,820
um it's<font color="#E5E5E5"> actually a lot easier because</font>

849
00:41:56,760 --> 00:42:02,490
you can go<font color="#CCCCCC"> through and fingerprint your</font>

850
00:41:59,820 --> 00:42:04,290
systems you<font color="#CCCCCC"> can actually</font><font color="#E5E5E5"> blow Dwight</font>

851
00:42:02,490 --> 00:42:05,879
listing on a<font color="#E5E5E5"> system in an industrial</font>

852
00:42:04,290 --> 00:42:08,580
control system<font color="#E5E5E5"> and get really good</font>

853
00:42:05,880 --> 00:42:10,619
results at it because<font color="#E5E5E5"> those systems even</font>

854
00:42:08,580 --> 00:42:11,759
the HMI systems and the controllers and

855
00:42:10,619 --> 00:42:13,980
all<font color="#E5E5E5"> its kind of stuff that are pc-based</font>

856
00:42:11,760 --> 00:42:17,550
they don't change but once a<font color="#CCCCCC"> year</font>

857
00:42:13,980 --> 00:42:20,510
typically so you only have to redo that

858
00:42:17,550 --> 00:42:23,250
white list once every year instead of

859
00:42:20,510 --> 00:42:25,950
every time Microsoft decides to ship out

860
00:42:23,250 --> 00:42:28,470
an update or every time there's an Adobe

861
00:42:25,950 --> 00:42:29,759
failure or things like that so so

862
00:42:28,470 --> 00:42:33,859
whitelisting actually works really well

863
00:42:29,760 --> 00:42:36,780
for pc based systems these systems here

864
00:42:33,859 --> 00:42:39,840
typically they don't<font color="#E5E5E5"> even bother to try</font>

865
00:42:36,780 --> 00:42:42,119
and fix it and determine what really

866
00:42:39,840 --> 00:42:44,010
went on forensic<font color="#E5E5E5"> Leon here they will</font>

867
00:42:42,119 --> 00:42:46,859
<font color="#E5E5E5">just say I need</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> this system back</font>

868
00:42:44,010 --> 00:42:49,800
up and running now I have this copy<font color="#E5E5E5"> of</font>

869
00:42:46,859 --> 00:42:51,540
my program that was running<font color="#E5E5E5"> on here and</font>

870
00:42:49,800 --> 00:42:53,460
<font color="#E5E5E5">this firmware I'm going to load it</font>

871
00:42:51,540 --> 00:42:55,710
because it'll take me 10 minutes to do

872
00:42:53,460 --> 00:42:58,020
that whereas it would take me days to

873
00:42:55,710 --> 00:43:00,119
rip this out and put a new<font color="#CCCCCC"> one in and</font>

874
00:42:58,020 --> 00:43:01,970
forensic<font color="#E5E5E5"> Lee and analyze what's going on</font>

875
00:43:00,119 --> 00:43:04,590
in here<font color="#CCCCCC"> and all this kind of stuff</font><font color="#E5E5E5"> so</font>

876
00:43:01,970 --> 00:43:11,819
it's<font color="#E5E5E5"> mostly about dollars</font><font color="#CCCCCC"> of getting</font>

877
00:43:04,590 --> 00:43:14,670
production back online so as i said i

878
00:43:11,820 --> 00:43:16,710
will be i have three of these<font color="#E5E5E5"> systems</font>

879
00:43:14,670 --> 00:43:19,230
with me<font color="#E5E5E5"> i</font><font color="#CCCCCC"> actually put them on the table</font>

880
00:43:16,710 --> 00:43:22,440
downstairs just before lunch if you<font color="#CCCCCC"> want</font>

881
00:43:19,230 --> 00:43:24,540
<font color="#CCCCCC">to feel free to play around with it I've</font>

882
00:43:22,440 --> 00:43:26,730
got port one set up on each one of these

883
00:43:24,540 --> 00:43:29,160
switches as a mere port so you can go in

884
00:43:26,730 --> 00:43:32,000
and<font color="#CCCCCC"> see what's on there</font><font color="#E5E5E5"> I would ask you</font>

885
00:43:29,160 --> 00:43:35,490
don't<font color="#CCCCCC"> be a dick and reprogram my devices</font>

886
00:43:32,000 --> 00:43:37,920
I can I have the program's<font color="#CCCCCC"> a myth need</font>

887
00:43:35,490 --> 00:43:44,990
to fix them but I would basically just

888
00:43:37,920 --> 00:43:44,990
asked you not to yeah<font color="#E5E5E5"> exactly</font><font color="#CCCCCC"> so thank</font>

889
00:43:46,980 --> 00:43:49,040
you

