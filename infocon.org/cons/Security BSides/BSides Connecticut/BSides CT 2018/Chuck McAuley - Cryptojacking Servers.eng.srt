1
00:00:00,030 --> 00:00:05,759
alright alright again thank you everyone

2
00:00:03,030 --> 00:00:07,770
for coming to b-sides this year we got

3
00:00:05,759 --> 00:00:09,510
some great talks we have the CTF going

4
00:00:07,770 --> 00:00:11,428
and thank you so much to all the

5
00:00:09,510 --> 00:00:13,590
volunteers and the sponsors I hope

6
00:00:11,429 --> 00:00:15,629
everyone has had a chance to to stop by

7
00:00:13,590 --> 00:00:19,460
and speak with them but I would like to

8
00:00:15,630 --> 00:00:21,720
get our next speaker up and running and

9
00:00:19,460 --> 00:00:22,980
his name is Chuck McCauley and he has a

10
00:00:21,720 --> 00:00:32,910
great talk

11
00:00:22,980 --> 00:00:36,510
so enjoy hello guys I hope you guys have

12
00:00:32,910 --> 00:00:37,620
had a good lunch and first talk in the

13
00:00:36,510 --> 00:00:42,839
afternoon lunch learning all about

14
00:00:37,620 --> 00:00:45,959
lambda things right so I'm gonna talk to

15
00:00:42,840 --> 00:00:48,960
you guys today about crypto miners how

16
00:00:45,960 --> 00:00:51,719
they do drive-by exploits break into

17
00:00:48,960 --> 00:00:56,399
servers and then make fake money off of

18
00:00:51,719 --> 00:00:59,090
your equipment for you my name's Chuck I

19
00:00:56,399 --> 00:01:01,800
work I work a much more complicated

20
00:00:59,090 --> 00:01:04,530
company name it's called Ixia a keysight

21
00:01:01,800 --> 00:01:06,119
company i keeping the victim of being

22
00:01:04,530 --> 00:01:09,180
acquired by bigger and bigger companies

23
00:01:06,119 --> 00:01:11,220
so if you don't know what keysight is i

24
00:01:09,180 --> 00:01:13,740
didn't either go google them they make

25
00:01:11,220 --> 00:01:17,700
all kinds of stuff they're giant a mega

26
00:01:13,740 --> 00:01:20,520
conglomerate thing I'm a man of many

27
00:01:17,700 --> 00:01:22,290
hats when I worked there I participate

28
00:01:20,520 --> 00:01:24,960
in new product development hacking

29
00:01:22,290 --> 00:01:27,750
threat intelligence research firewall

30
00:01:24,960 --> 00:01:30,179
intrusion protection testing is sort of

31
00:01:27,750 --> 00:01:32,310
where I came from and I've been in

32
00:01:30,180 --> 00:01:35,850
InfoSec ever since I left college and

33
00:01:32,310 --> 00:01:38,369
that was a long time ago I can tell from

34
00:01:35,850 --> 00:01:41,850
being here today that I'm much much

35
00:01:38,369 --> 00:01:43,920
older than I used to be I'm not really

36
00:01:41,850 --> 00:01:46,020
big on social media but if you like to

37
00:01:43,920 --> 00:01:49,710
follow people on Twitter a noble Trout

38
00:01:46,020 --> 00:01:51,990
that's about all I am and I mostly post

39
00:01:49,710 --> 00:01:53,699
stuff about InfoSec but also stuff about

40
00:01:51,990 --> 00:01:56,408
a new Land Rover Defender I just bought

41
00:01:53,700 --> 00:01:58,509
with the right hand drive

42
00:01:56,409 --> 00:01:59,860
and I signed up as an uber driver four

43
00:01:58,509 --> 00:02:02,799
years ago because I just wanted to

44
00:01:59,860 --> 00:02:03,880
figure out what it was like Alex did go

45
00:02:02,799 --> 00:02:08,380
up and down mountains and watch too much

46
00:02:03,880 --> 00:02:11,079
TV so there my hubby's anyway so what

47
00:02:08,380 --> 00:02:14,440
are we gonna look at today we're gonna

48
00:02:11,080 --> 00:02:16,450
look at crypto miners on servers notably

49
00:02:14,440 --> 00:02:18,700
other people's crypto miners on your

50
00:02:16,450 --> 00:02:22,179
servers and we're gonna look at what I

51
00:02:18,700 --> 00:02:24,940
calling for different campaigns that are

52
00:02:22,180 --> 00:02:28,030
telling you to infect servers and pump

53
00:02:24,940 --> 00:02:30,040
fake cryptocurrency stuff up into other

54
00:02:28,030 --> 00:02:31,870
people's pools and things I'll show you

55
00:02:30,040 --> 00:02:36,730
the tools tactics and procedures that

56
00:02:31,870 --> 00:02:40,180
are used to develop into play this stuff

57
00:02:36,730 --> 00:02:41,920
and what to look for and we'll even get

58
00:02:40,180 --> 00:02:43,269
a little bit of partial attribution not

59
00:02:41,920 --> 00:02:44,738
full attribution I'm not gonna show you

60
00:02:43,269 --> 00:02:48,250
screen grab of the guy's Twitter profile

61
00:02:44,739 --> 00:02:53,500
sorry you don't need to be a crypto

62
00:02:48,250 --> 00:02:55,750
currency advocate or naysayer or really

63
00:02:53,500 --> 00:02:59,380
understand them very much but you need

64
00:02:55,750 --> 00:03:01,660
to sort of at least know what a crypto

65
00:02:59,380 --> 00:03:04,630
current cone is what gnome own arrow is

66
00:03:01,660 --> 00:03:06,819
and that mining is a thing and that you

67
00:03:04,630 --> 00:03:09,510
can use Mon arrow to buy drugs or video

68
00:03:06,819 --> 00:03:11,440
games or go online gambling or something

69
00:03:09,510 --> 00:03:13,268
that's about all you need to know about

70
00:03:11,440 --> 00:03:14,590
that don't so if you hoping they're

71
00:03:13,269 --> 00:03:19,989
gonna learn how to do cryptocurrency

72
00:03:14,590 --> 00:03:22,930
mining monk-like talk so part of what we

73
00:03:19,989 --> 00:03:25,989
do at Ixia a keysight company is threat

74
00:03:22,930 --> 00:03:28,359
intelligence we manage a giant honeypot

75
00:03:25,989 --> 00:03:31,209
network with hundreds of simulated

76
00:03:28,359 --> 00:03:33,819
servers they grab web shell exploits

77
00:03:31,209 --> 00:03:36,250
brute force errs simulate administrative

78
00:03:33,819 --> 00:03:40,149
consoles ICS systems all kinds of fun

79
00:03:36,250 --> 00:03:43,000
stuff and without going into too many

80
00:03:40,150 --> 00:03:45,370
details it's sort of a hybrid of open

81
00:03:43,000 --> 00:03:47,260
and closed source software we even use

82
00:03:45,370 --> 00:03:49,299
some off-the-shelf tooling you'll see

83
00:03:47,260 --> 00:03:51,040
Splunk screenshots in here spunks great

84
00:03:49,299 --> 00:03:55,090
for us to just do the data mining on the

85
00:03:51,040 --> 00:03:58,209
raw data and these are some of the

86
00:03:55,090 --> 00:04:00,579
attacks that we use that we see a lot so

87
00:03:58,209 --> 00:04:02,799
we targeting WordPress or Oracle Apache

88
00:04:00,579 --> 00:04:05,949
Tomcat those are sorts of stuff that you

89
00:04:02,799 --> 00:04:08,769
see a lot happening across these these

90
00:04:05,949 --> 00:04:09,819
drive by hackers also a whole bunch of

91
00:04:08,769 --> 00:04:11,349
wanna cry and that's

92
00:04:09,819 --> 00:04:15,909
and B exploits for the last year and a

93
00:04:11,349 --> 00:04:17,560
half right if you aren't in the honey

94
00:04:15,909 --> 00:04:19,358
pots come talk to me there are lots of

95
00:04:17,560 --> 00:04:21,608
fun to set up they're really hard to

96
00:04:19,358 --> 00:04:24,460
maintain and get good data from once you

97
00:04:21,608 --> 00:04:26,198
start scaling beyond about five which is

98
00:04:24,460 --> 00:04:30,039
sort of the problem sets that we've been

99
00:04:26,199 --> 00:04:32,259
working with so some of the more

100
00:04:30,039 --> 00:04:34,300
interesting things that we've seen from

101
00:04:32,259 --> 00:04:37,030
watching these sort of drive-by exploits

102
00:04:34,300 --> 00:04:38,590
as they develop and get better and this

103
00:04:37,030 --> 00:04:42,070
stuff in red some of this stuff is from

104
00:04:38,590 --> 00:04:43,840
back when I was in college right but you

105
00:04:42,070 --> 00:04:45,969
know you've got sort of Perl BOTS and

106
00:04:43,840 --> 00:04:49,000
DDoS bots that are trying to just plant

107
00:04:45,970 --> 00:04:51,190
themselves on a system and then send out

108
00:04:49,000 --> 00:04:54,849
spam or send up the now service attacks

109
00:04:51,190 --> 00:04:56,530
from that server off somewhere else you

110
00:04:54,849 --> 00:04:58,120
the most modern variant of that you

111
00:04:56,530 --> 00:05:00,580
could probably think of as Mirai org a

112
00:04:58,120 --> 00:05:02,410
fagot those sorts of bots that are now

113
00:05:00,580 --> 00:05:07,930
infecting IOT devices but they have a

114
00:05:02,410 --> 00:05:09,729
long lineage going way back more

115
00:05:07,930 --> 00:05:11,789
recently you've got ransomware which

116
00:05:09,729 --> 00:05:15,430
worms its way across a network and then

117
00:05:11,789 --> 00:05:18,550
basically profits from locking access to

118
00:05:15,430 --> 00:05:19,990
that system so the first stuff was I

119
00:05:18,550 --> 00:05:22,870
land on the server then I figure out

120
00:05:19,990 --> 00:05:25,659
what I have is it a value I steal it if

121
00:05:22,870 --> 00:05:28,960
not I'll use it to deploy and send out

122
00:05:25,659 --> 00:05:30,940
my own stuff the second one is just I

123
00:05:28,960 --> 00:05:32,620
don't care what's on there if I deny you

124
00:05:30,940 --> 00:05:34,810
from using it I don't need to figure out

125
00:05:32,620 --> 00:05:36,070
a way to sell the marketing list that

126
00:05:34,810 --> 00:05:37,419
you have but I know it's important to

127
00:05:36,070 --> 00:05:41,080
you and you're gonna pay me to get it

128
00:05:37,419 --> 00:05:43,000
back now the last sort of version of

129
00:05:41,080 --> 00:05:44,889
this has now become just I'm gonna use

130
00:05:43,000 --> 00:05:46,599
your computer II sources I don't care

131
00:05:44,889 --> 00:05:47,849
what you have I'm gonna kill it all off

132
00:05:46,599 --> 00:05:50,169
and just use it to make me

133
00:05:47,849 --> 00:05:52,000
cryptocurrency and then sell that for

134
00:05:50,169 --> 00:05:53,680
cold hard cash this is much more

135
00:05:52,000 --> 00:05:56,860
effective and a much more sort of linear

136
00:05:53,680 --> 00:05:59,050
progression of taking the thing that I

137
00:05:56,860 --> 00:06:02,620
got and making it into money which is

138
00:05:59,050 --> 00:06:05,219
what I want and so you sort of see this

139
00:06:02,620 --> 00:06:08,380
sort of crisscross of risk versus reward

140
00:06:05,219 --> 00:06:10,539
more servers equal more value and

141
00:06:08,380 --> 00:06:12,310
benefit for you and there's less risk

142
00:06:10,539 --> 00:06:14,590
right there's less interaction or

143
00:06:12,310 --> 00:06:18,809
anything that need to happen here as we

144
00:06:14,590 --> 00:06:24,659
move from left to right right

145
00:06:18,809 --> 00:06:27,279
so let's look at a campaign one this one

146
00:06:24,659 --> 00:06:29,938
tried to use three different exploits I

147
00:06:27,279 --> 00:06:31,900
was able to get full sort of

148
00:06:29,939 --> 00:06:33,069
understanding a two of them and one of

149
00:06:31,900 --> 00:06:35,679
them was sort of a little bit of a

150
00:06:33,069 --> 00:06:38,349
guesswork going on there you'll notice

151
00:06:35,680 --> 00:06:41,740
that it's using an awesome attacks from

152
00:06:38,349 --> 00:06:42,849
2013 and 2012 all of this data that

153
00:06:41,740 --> 00:06:45,969
you're looking at from the honeypot

154
00:06:42,849 --> 00:06:48,610
perspective was harvested from say

155
00:06:45,969 --> 00:06:51,490
December last year until June so these

156
00:06:48,610 --> 00:06:52,870
are relatively recent honeypot data logs

157
00:06:51,490 --> 00:06:54,879
that we've been digging through to find

158
00:06:52,870 --> 00:06:58,360
this stuff but the exploits use tend to

159
00:06:54,879 --> 00:07:00,099
date back a few more years you also have

160
00:06:58,360 --> 00:07:02,229
a JavaScript injection attempt which

161
00:07:00,099 --> 00:07:03,729
also show you and it was able to tie all

162
00:07:02,229 --> 00:07:06,159
these together by looking at the same

163
00:07:03,729 --> 00:07:10,508
wallet and hostname hosting some of the

164
00:07:06,159 --> 00:07:13,509
stuff so the first CVE I saw this

165
00:07:10,509 --> 00:07:17,559
January 10 2017 this is that Ruby

166
00:07:13,509 --> 00:07:20,499
exploit from 2013 and if you dig into it

167
00:07:17,559 --> 00:07:23,289
you'll see that it's what we call a DC

168
00:07:20,499 --> 00:07:27,009
relation vulnerability so you post a

169
00:07:23,289 --> 00:07:29,919
file to a Ruby on Rails server with some

170
00:07:27,009 --> 00:07:32,229
XML formatting and then some base 64

171
00:07:29,919 --> 00:07:33,998
garbage well anyone who's done a

172
00:07:32,229 --> 00:07:36,039
networked CTF will tell you if I see

173
00:07:33,999 --> 00:07:38,169
base64 the first thing I do is decode it

174
00:07:36,039 --> 00:07:40,748
and see what it is and there it is it

175
00:07:38,169 --> 00:07:42,520
just runs system updates crontab with a

176
00:07:40,749 --> 00:07:47,169
shell script to run and double you get

177
00:07:42,520 --> 00:07:48,549
and you're off to the races so you don't

178
00:07:47,169 --> 00:07:50,558
really need to understand what the

179
00:07:48,550 --> 00:07:52,899
exploit does in order to understand what

180
00:07:50,559 --> 00:07:55,809
it does I guess is the right way of

181
00:07:52,899 --> 00:07:59,110
putting it right if you see double you

182
00:07:55,809 --> 00:08:02,349
get in a post it's bad this is gonna be

183
00:07:59,110 --> 00:08:04,180
a common theme so this one is a PHP

184
00:08:02,349 --> 00:08:10,240
exploit where it's just basically hey

185
00:08:04,180 --> 00:08:12,129
PHP run this and PHP goes okay and it's

186
00:08:10,240 --> 00:08:15,430
the exact same file that loads up in

187
00:08:12,129 --> 00:08:17,319
crontab I hope you guys can see this at

188
00:08:15,430 --> 00:08:18,939
the back if you can't feel free to just

189
00:08:17,319 --> 00:08:20,589
stand up and move forward because

190
00:08:18,939 --> 00:08:24,009
otherwise this is just gonna be a bunch

191
00:08:20,589 --> 00:08:26,080
of screens that you can't see at the

192
00:08:24,009 --> 00:08:31,479
bottom this is actually from an SSH

193
00:08:26,080 --> 00:08:32,500
honeypot and it's the username being

194
00:08:31,479 --> 00:08:34,840
sent over

195
00:08:32,500 --> 00:08:36,669
now I've found a couple of one abilities

196
00:08:34,840 --> 00:08:39,270
like this a long time ago in like Nets

197
00:08:36,669 --> 00:08:42,039
green and juniper firewalls and

198
00:08:39,270 --> 00:08:44,439
basically you try to log in via SSH you

199
00:08:42,039 --> 00:08:46,150
send JavaScript in there and then when

200
00:08:44,440 --> 00:08:48,490
you go in the web log and you go to see

201
00:08:46,150 --> 00:08:49,900
invalid user logged in it will run the

202
00:08:48,490 --> 00:08:53,260
the shell script for you

203
00:08:49,900 --> 00:08:55,600
as the web administrator access to the

204
00:08:53,260 --> 00:08:58,150
firewall so you can make a permission of

205
00:08:55,600 --> 00:09:00,970
allow everything so this probably is

206
00:08:58,150 --> 00:09:04,150
injecting a JavaScript based crypto

207
00:09:00,970 --> 00:09:05,590
miner unfortunately the site hosting

208
00:09:04,150 --> 00:09:08,020
this was down by the time I went and

209
00:09:05,590 --> 00:09:11,860
found it so that's conjecture but I'm

210
00:09:08,020 --> 00:09:13,449
guessing the internet research is is not

211
00:09:11,860 --> 00:09:17,290
a place that you want to go on the

212
00:09:13,450 --> 00:09:20,740
Internet and that's because it hosts

213
00:09:17,290 --> 00:09:22,990
this file here which is is the file that

214
00:09:20,740 --> 00:09:25,630
was injected with crontab and what it

215
00:09:22,990 --> 00:09:29,250
does is there's a bunch of alphabet soup

216
00:09:25,630 --> 00:09:33,850
stuff going on here but basically it's

217
00:09:29,250 --> 00:09:35,950
downloading a file called sshd from a

218
00:09:33,850 --> 00:09:38,800
tour to a web address and then running

219
00:09:35,950 --> 00:09:41,230
it it does some other clever things like

220
00:09:38,800 --> 00:09:44,170
if you look at the stuff that's using

221
00:09:41,230 --> 00:09:47,860
sis octal it's basically optimizing a

222
00:09:44,170 --> 00:09:51,579
computer to mine Manero for you and then

223
00:09:47,860 --> 00:09:54,550
it also will download a newer version of

224
00:09:51,580 --> 00:09:56,350
itself and if you keep monitoring those

225
00:09:54,550 --> 00:09:58,420
URLs they keep changing and they'll

226
00:09:56,350 --> 00:09:59,830
overrate the crontab with a new cron tab

227
00:09:58,420 --> 00:10:02,110
to download to the shell script from a

228
00:09:59,830 --> 00:10:05,620
new place so it keeps migrating around

229
00:10:02,110 --> 00:10:07,960
the internet what's really kind of cute

230
00:10:05,620 --> 00:10:11,440
at the end is it runs that binary form

231
00:10:07,960 --> 00:10:13,720
own arrow and it will if it fails it

232
00:10:11,440 --> 00:10:15,790
will put a fail message with the you

233
00:10:13,720 --> 00:10:18,910
name architecture and all the other

234
00:10:15,790 --> 00:10:20,589
details in the user-agent header of curl

235
00:10:18,910 --> 00:10:23,110
and send it to that toward a web address

236
00:10:20,589 --> 00:10:25,270
so he's keeping track of all the systems

237
00:10:23,110 --> 00:10:26,830
that fail to run his mo narrow minor so

238
00:10:25,270 --> 00:10:28,180
he can go back and fix his script and

239
00:10:26,830 --> 00:10:33,760
make it work more effectively later

240
00:10:28,180 --> 00:10:37,300
which is kind of neat but bad for you so

241
00:10:33,760 --> 00:10:38,800
here this is a quick demonstration of

242
00:10:37,300 --> 00:10:40,870
how you can use this great forensics

243
00:10:38,800 --> 00:10:43,930
tool called strings which comes on every

244
00:10:40,870 --> 00:10:45,139
Linux distribution on the planet you run

245
00:10:43,930 --> 00:10:47,299
across an unknown blah

246
00:10:45,139 --> 00:10:49,369
of data and then you use search to find

247
00:10:47,299 --> 00:10:51,949
what you want now if you know anything

248
00:10:49,369 --> 00:10:53,959
about the when our mining protocol it

249
00:10:51,949 --> 00:10:56,029
uses something called stratum and if we

250
00:10:53,959 --> 00:10:57,498
look here we search for stratum and

251
00:10:56,029 --> 00:10:58,970
immediately we find all these static

252
00:10:57,499 --> 00:11:02,269
strings compiled in here we find the

253
00:10:58,970 --> 00:11:04,519
wallet the pool and everything else that

254
00:11:02,269 --> 00:11:06,049
it's connecting to so now knowing the

255
00:11:04,519 --> 00:11:10,329
pool that we're connecting to and the

256
00:11:06,049 --> 00:11:16,459
wallet address that's mining we can now

257
00:11:10,329 --> 00:11:19,040
fail at PowerPoint there we go go to the

258
00:11:16,459 --> 00:11:20,899
pool plug in the address and find out

259
00:11:19,040 --> 00:11:22,579
how much Mon arrow the guy his mind and

260
00:11:20,899 --> 00:11:28,579
his current hash rate which is kind of

261
00:11:22,579 --> 00:11:31,479
neat and this guy has mined 11.1 to XM r

262
00:11:28,579 --> 00:11:35,079
which is Mon arrow fake currency money

263
00:11:31,480 --> 00:11:37,790
and that according to Yahoo Finance is

264
00:11:35,079 --> 00:11:39,199
worth two hundred forty six dollars to

265
00:11:37,790 --> 00:11:41,299
someone who doesn't have something

266
00:11:39,199 --> 00:11:43,128
better to do with their money which

267
00:11:41,299 --> 00:11:46,489
means that it's two thousand seven

268
00:11:43,129 --> 00:11:48,499
hundred six dollars of profit or stored

269
00:11:46,489 --> 00:11:53,419
value as burnin burnin a key would call

270
00:11:48,499 --> 00:11:55,600
that so anyway that's what he did and

271
00:11:53,419 --> 00:11:59,329
now we're gonna go on to the next guy so

272
00:11:55,600 --> 00:12:01,970
this guy decided that Monera wasn't cool

273
00:11:59,329 --> 00:12:04,669
for anyone anymore and he wanted to do

274
00:12:01,970 --> 00:12:07,429
something called electro Neum electro

275
00:12:04,669 --> 00:12:08,839
neum is another Kryptonite algorithm

276
00:12:07,429 --> 00:12:11,360
based protocol if you look into Mon

277
00:12:08,839 --> 00:12:13,549
arrow there's a reference network called

278
00:12:11,360 --> 00:12:16,009
kryptonite and there's a whole bunch of

279
00:12:13,549 --> 00:12:17,389
branches and forks off of it so Mon

280
00:12:16,009 --> 00:12:21,259
arrow is not your only one but there's a

281
00:12:17,389 --> 00:12:25,749
lot of clones of it out there and this

282
00:12:21,259 --> 00:12:28,639
one made good use of CVE 2017 56:38

283
00:12:25,749 --> 00:12:31,999
which was most known for the Equifax

284
00:12:28,639 --> 00:12:33,829
hack coming into Apache struts once

285
00:12:31,999 --> 00:12:36,709
again how many of you guys have seen

286
00:12:33,829 --> 00:12:40,758
this vulnerability yourself you looked

287
00:12:36,709 --> 00:12:42,919
at it hands okay a couple it's once

288
00:12:40,759 --> 00:12:44,329
again like one of those vulnerabilities

289
00:12:42,919 --> 00:12:45,889
that you don't need to actually

290
00:12:44,329 --> 00:12:48,079
understand the vulnerability to

291
00:12:45,889 --> 00:12:50,959
recognize the badness it just runs curl

292
00:12:48,079 --> 00:12:52,429
and says download me and run me and you

293
00:12:50,959 --> 00:12:55,939
go okay and then the rest is just

294
00:12:52,429 --> 00:12:57,529
framing of the attack so it's another DC

295
00:12:55,939 --> 00:12:59,059
realization vulnerability that means you

296
00:12:57,529 --> 00:13:01,849
basically create a

297
00:12:59,059 --> 00:13:03,829
sort of instance of an object you shove

298
00:13:01,849 --> 00:13:06,589
it into the server the server takes that

299
00:13:03,829 --> 00:13:08,209
object makes it takes that text makes it

300
00:13:06,589 --> 00:13:10,309
back into an object and runs the code

301
00:13:08,209 --> 00:13:12,888
that's in there and then part of that

302
00:13:10,309 --> 00:13:17,358
deserialization process is to run curl

303
00:13:12,889 --> 00:13:20,389
and download itself so when we go and we

304
00:13:17,359 --> 00:13:22,369
look at this one this shell script

305
00:13:20,389 --> 00:13:24,409
wasn't a single statically compiled

306
00:13:22,369 --> 00:13:26,329
program so we didn't have to run strings

307
00:13:24,409 --> 00:13:28,669
to figure it out we just needed to

308
00:13:26,329 --> 00:13:31,008
download the configuration file so we

309
00:13:28,669 --> 00:13:31,759
got an IP address and the wallet it was

310
00:13:31,009 --> 00:13:34,129
right there

311
00:13:31,759 --> 00:13:37,099
but this presented its own unique set of

312
00:13:34,129 --> 00:13:41,839
challenges to figure out attribution and

313
00:13:37,099 --> 00:13:43,219
what we figured out was that because if

314
00:13:41,839 --> 00:13:44,709
you just have the IP address of the

315
00:13:43,219 --> 00:13:47,419
server

316
00:13:44,709 --> 00:13:50,059
you can't just connect to that IP

317
00:13:47,419 --> 00:13:51,739
address and say hello give me all your

318
00:13:50,059 --> 00:13:54,409
pool data it'll just return back like

319
00:13:51,739 --> 00:13:56,449
mining server online for you so you go

320
00:13:54,409 --> 00:13:58,099
to passive DNS and you say well are

321
00:13:56,449 --> 00:14:00,169
there any host names associated with

322
00:13:58,099 --> 00:14:03,379
this IP address and we get one called

323
00:14:00,169 --> 00:14:06,139
new ETN pool dot info I'm like great so

324
00:14:03,379 --> 00:14:09,049
I type an ATM pool dot info and lo and

325
00:14:06,139 --> 00:14:11,119
behold it's the mining pool web console

326
00:14:09,049 --> 00:14:14,839
and then I plug in the address and I see

327
00:14:11,119 --> 00:14:16,849
how much electro neum he has and then

328
00:14:14,839 --> 00:14:18,739
according to a site that wasn't Yahoo

329
00:14:16,849 --> 00:14:22,789
Finance because even Yahoo Finance

330
00:14:18,739 --> 00:14:25,879
doesn't track electro neum we found out

331
00:14:22,789 --> 00:14:31,819
that each electro neum is worth seven

332
00:14:25,879 --> 00:14:35,359
cents but he had mined a hundred and

333
00:14:31,819 --> 00:14:36,889
thirty one thousand coins of Electra

334
00:14:35,359 --> 00:14:42,439
Neum so that ended up being a lot of

335
00:14:36,889 --> 00:14:44,349
money in real dollars so I was like I've

336
00:14:42,439 --> 00:14:47,118
never heard of this what is this stuff

337
00:14:44,349 --> 00:14:48,589
and apparently if you go look up online

338
00:14:47,119 --> 00:14:51,079
there were at the Mobile World Congress

339
00:14:48,589 --> 00:14:52,939
aid a bunch of young people or marketing

340
00:14:51,079 --> 00:14:55,279
stuff it's gonna change how you pay for

341
00:14:52,939 --> 00:14:59,238
stuff with your phone cuz Apple iPhone

342
00:14:55,279 --> 00:15:03,979
pay doesn't work or it does for me I

343
00:14:59,239 --> 00:15:06,469
don't know about you and so they start

344
00:15:03,979 --> 00:15:07,879
this thing called an ICO and ICO is an

345
00:15:06,469 --> 00:15:10,039
initial coin offering what it really

346
00:15:07,879 --> 00:15:12,120
means is hey get in on this now and

347
00:15:10,039 --> 00:15:14,550
start mining me my coins and you will

348
00:15:12,120 --> 00:15:17,100
the benefits of selling them later at an

349
00:15:14,550 --> 00:15:19,439
inflated cost to someone else some might

350
00:15:17,100 --> 00:15:24,630
call these things like Ponzi scheme like

351
00:15:19,440 --> 00:15:28,110
or scam me but this is what they do and

352
00:15:24,630 --> 00:15:30,420
so then it closed early October 20th to

353
00:15:28,110 --> 00:15:33,779
make sure you keep these dates in mind

354
00:15:30,420 --> 00:15:35,849
because this matters and then someone

355
00:15:33,779 --> 00:15:40,110
called hacker won on November 1st said

356
00:15:35,850 --> 00:15:41,700
that yes it's safe but I don't know what

357
00:15:40,110 --> 00:15:47,100
that is it didn't really lead anywhere

358
00:15:41,700 --> 00:15:48,990
safe feeling so I went and was like well

359
00:15:47,100 --> 00:15:50,970
when's the first time I saw this guy

360
00:15:48,990 --> 00:15:52,380
because I had his IP address in show

361
00:15:50,970 --> 00:15:54,630
script where it came from and what he

362
00:15:52,380 --> 00:15:58,290
was trying to inject and sure enough it

363
00:15:54,630 --> 00:15:59,730
was in the middle of his of the ICO that

364
00:15:58,290 --> 00:16:03,089
he just sort of appeared out of nowhere

365
00:15:59,730 --> 00:16:04,920
and if you know anything about mining

366
00:16:03,089 --> 00:16:06,779
currency you want to mine the early

367
00:16:04,920 --> 00:16:08,939
currency it's the easy numbers to figure

368
00:16:06,779 --> 00:16:11,970
out right if you're in there later then

369
00:16:08,940 --> 00:16:16,770
it's a lot harder to find those math

370
00:16:11,970 --> 00:16:18,540
beanie babies right so you really want

371
00:16:16,770 --> 00:16:24,360
to be there early and that's why he got

372
00:16:18,540 --> 00:16:27,930
131 thousand of them so yeah that you

373
00:16:24,360 --> 00:16:29,880
know that's what they're doing so then

374
00:16:27,930 --> 00:16:34,069
this is another one it's the same stuff

375
00:16:29,880 --> 00:16:36,959
again but this one is a Oracle

376
00:16:34,070 --> 00:16:39,630
deserialization vulnerability and it has

377
00:16:36,959 --> 00:16:44,489
curl it downloads a thing and it sends

378
00:16:39,630 --> 00:16:48,589
it to bash this one's bone arrow I mean

379
00:16:44,490 --> 00:16:48,589
it was good from February 24th April 4th

380
00:16:48,680 --> 00:16:52,349
so if we look at this one this guy start

381
00:16:51,450 --> 00:16:54,750
getting really clever

382
00:16:52,350 --> 00:16:56,670
he kills everything that runs on the

383
00:16:54,750 --> 00:16:58,860
system like if you looked at this it

384
00:16:56,670 --> 00:17:01,110
speak ill for pages and pages and pages

385
00:16:58,860 --> 00:17:04,349
and pages because apache and Postgres

386
00:17:01,110 --> 00:17:08,459
and and IP addresses and everything

387
00:17:04,349 --> 00:17:10,438
death to it all and then on the right he

388
00:17:08,459 --> 00:17:12,809
keeps trying to download different types

389
00:17:10,439 --> 00:17:14,220
of miners and making sure they execute

390
00:17:12,809 --> 00:17:15,510
if they don't execute he downloads a

391
00:17:14,220 --> 00:17:18,449
different miner and runs it

392
00:17:15,510 --> 00:17:21,109
over and over and over again so he's

393
00:17:18,449 --> 00:17:23,940
like really trying very very very hard

394
00:17:21,109 --> 00:17:26,698
once again we were able to pull out the

395
00:17:23,940 --> 00:17:31,320
mining pool and the hash and get all

396
00:17:26,699 --> 00:17:34,290
that out and then he also targets

397
00:17:31,320 --> 00:17:36,750
windows so he's got this Auto Exe file

398
00:17:34,290 --> 00:17:38,010
that he downloads he used Windows shell

399
00:17:36,750 --> 00:17:40,590
to do it and then he also as a

400
00:17:38,010 --> 00:17:44,300
PowerShell script he tries to inject so

401
00:17:40,590 --> 00:17:46,770
he tries both ways to get to run and

402
00:17:44,300 --> 00:17:50,280
tries to tries to hit it each way right

403
00:17:46,770 --> 00:17:52,410
and then when we execute it in our kuku

404
00:17:50,280 --> 00:17:55,770
sandbox we find that the wallet is the

405
00:17:52,410 --> 00:17:57,690
exact same so then we go and we find the

406
00:17:55,770 --> 00:18:01,230
wallet and we find out that he made 95

407
00:17:57,690 --> 00:18:10,140
dollars out of all that effort sometimes

408
00:18:01,230 --> 00:18:11,460
you know the winner so it's kind of neat

409
00:18:10,140 --> 00:18:13,500
because you can sort of get like a good

410
00:18:11,460 --> 00:18:15,270
site survey of what bugs are like best

411
00:18:13,500 --> 00:18:21,540
to exploit right from watching this

412
00:18:15,270 --> 00:18:25,590
stuff passively completely and now we

413
00:18:21,540 --> 00:18:28,860
have example for this guy was kind of

414
00:18:25,590 --> 00:18:31,919
interesting so he once again targeted

415
00:18:28,860 --> 00:18:35,189
that WebLogic Oracle bug

416
00:18:31,920 --> 00:18:37,320
it was moon arrow again it also targeted

417
00:18:35,190 --> 00:18:40,530
this thing called a cacti Network

418
00:18:37,320 --> 00:18:42,360
weather map which is like one of our

419
00:18:40,530 --> 00:18:46,440
biggest hitters on our honey pots for

420
00:18:42,360 --> 00:18:48,600
some reason and it's this really weird

421
00:18:46,440 --> 00:18:50,850
sort of joomla plugin kind of thing or

422
00:18:48,600 --> 00:18:52,290
wordpress plugin for monitoring your

423
00:18:50,850 --> 00:18:54,419
network health I don't know where it

424
00:18:52,290 --> 00:18:57,450
came from but they love to exploit it

425
00:18:54,420 --> 00:18:59,070
and then there's a URL which at the time

426
00:18:57,450 --> 00:19:03,000
I still don't know what it's for

427
00:18:59,070 --> 00:19:06,030
it was cool that PHP question mark ID

428
00:19:03,000 --> 00:19:08,130
equals and then shell script there's no

429
00:19:06,030 --> 00:19:10,530
CVE that I can seem to associate this

430
00:19:08,130 --> 00:19:12,000
one with so I don't know what it's

431
00:19:10,530 --> 00:19:15,270
exploiting and no one else can seem to

432
00:19:12,000 --> 00:19:17,760
figure it out on the interwebs so and

433
00:19:15,270 --> 00:19:19,440
then this guy used different wallets but

434
00:19:17,760 --> 00:19:24,180
he always hosted all of his secondary

435
00:19:19,440 --> 00:19:28,299
payloads at the same IP so that's how we

436
00:19:24,180 --> 00:19:31,119
sort of tied it all together for him so

437
00:19:28,299 --> 00:19:34,059
I don't know if any of you can read this

438
00:19:31,119 --> 00:19:36,428
side but at the top those are the cools

439
00:19:34,059 --> 00:19:38,199
at PHP stuff and like I said I couldn't

440
00:19:36,429 --> 00:19:39,879
figure out what that what vulnerability

441
00:19:38,199 --> 00:19:41,799
that was referencing then you got the

442
00:19:39,879 --> 00:19:43,599
weather map plug-in attacks and then

443
00:19:41,799 --> 00:19:48,190
you've got the at the very bottom the

444
00:19:43,599 --> 00:19:52,839
Oracle WebLogic one right he targeted

445
00:19:48,190 --> 00:19:56,619
Oracle with Windows and downloaded minor

446
00:19:52,839 --> 00:20:01,359
XMR Exe on there and attempted to

447
00:19:56,619 --> 00:20:03,549
execute it and the windows binaries are

448
00:20:01,359 --> 00:20:06,428
not always easy enough to just execute

449
00:20:03,549 --> 00:20:08,109
and you see a screenshot of the mining

450
00:20:06,429 --> 00:20:10,869
wallet there I wish everything was that

451
00:20:08,109 --> 00:20:14,079
easy it can be packed it can be hidden

452
00:20:10,869 --> 00:20:15,549
demonized shoved the way I did figure

453
00:20:14,079 --> 00:20:18,399
out later I could have used been walk on

454
00:20:15,549 --> 00:20:20,859
this one to figure it out but I just

455
00:20:18,399 --> 00:20:23,559
detonated it and then looked at the

456
00:20:20,859 --> 00:20:25,389
network traffic and it was right there

457
00:20:23,559 --> 00:20:28,149
and it had the mining server connected

458
00:20:25,389 --> 00:20:30,059
to and the the wallet and all the stuff

459
00:20:28,149 --> 00:20:34,089
I've shown you four or five times now

460
00:20:30,059 --> 00:20:37,479
and was able to figure out that on the

461
00:20:34,089 --> 00:20:41,769
windows side he made 1600 bucks mining

462
00:20:37,479 --> 00:20:43,989
this stuff which was kind of neat but

463
00:20:41,769 --> 00:20:46,749
once again over on Linux it was a sad

464
00:20:43,989 --> 00:20:49,419
trombone noise you can't probably see

465
00:20:46,749 --> 00:20:51,999
that but it says point zero three XMR so

466
00:20:49,419 --> 00:20:54,279
it was a nothing so whatever he was

467
00:20:51,999 --> 00:20:57,329
trying to exploit on on Linux wasn't

468
00:20:54,279 --> 00:21:01,029
working but he hit it big with Windows

469
00:20:57,329 --> 00:21:03,969
so those are the four campaigns I wanted

470
00:21:01,029 --> 00:21:08,829
to show you guys take a quick breath and

471
00:21:03,969 --> 00:21:10,989
drink my water the next part of this is

472
00:21:08,829 --> 00:21:13,359
I'm gonna look and show you sort of like

473
00:21:10,989 --> 00:21:17,469
the amount of scale and energy required

474
00:21:13,359 --> 00:21:19,059
to do this sort of stuff so you can sort

475
00:21:17,469 --> 00:21:21,609
of try to figure out how to measure what

476
00:21:19,059 --> 00:21:23,229
the impact is from people doing this

477
00:21:21,609 --> 00:21:25,869
stuff on the Internet

478
00:21:23,229 --> 00:21:27,819
to be fair I could sit all day looking

479
00:21:25,869 --> 00:21:29,468
at my honeypot logs and find millions of

480
00:21:27,819 --> 00:21:30,668
instances of this stuff I just picked on

481
00:21:29,469 --> 00:21:36,069
these four guys because they were the

482
00:21:30,669 --> 00:21:39,940
first four I found and I've never worked

483
00:21:36,069 --> 00:21:41,620
at Splunk or maybe money off of selling

484
00:21:39,940 --> 00:21:43,780
spunk or anything but I'm

485
00:21:41,620 --> 00:21:45,309
huge proponent of using it at this point

486
00:21:43,780 --> 00:21:47,889
because digging through it the fine

487
00:21:45,309 --> 00:21:50,290
stuff is just so fast compared to using

488
00:21:47,890 --> 00:21:51,490
anything else so if it wasn't for Splunk

489
00:21:50,290 --> 00:21:53,680
I would've been able to find all that

490
00:21:51,490 --> 00:21:59,410
stuff for you anyway

491
00:21:53,680 --> 00:22:01,510
so what we can do with these pools is

492
00:21:59,410 --> 00:22:04,150
they'll show you the hash rate of a

493
00:22:01,510 --> 00:22:06,670
wallet so you can see how many hashes

494
00:22:04,150 --> 00:22:10,870
are submitted per I think 5-minute

495
00:22:06,670 --> 00:22:13,090
interval into pool from a certain wallet

496
00:22:10,870 --> 00:22:14,770
now the stuff goes into the pool with

497
00:22:13,090 --> 00:22:16,629
one wallet but you can ship it out with

498
00:22:14,770 --> 00:22:20,590
another one that's the point of the

499
00:22:16,630 --> 00:22:22,720
pollute pool it's a slush fund right but

500
00:22:20,590 --> 00:22:25,629
then we know what the hash rate is

501
00:22:22,720 --> 00:22:28,720
forgiven CPU so we can figure out using

502
00:22:25,630 --> 00:22:31,420
a certain CPU as sort of our common

503
00:22:28,720 --> 00:22:33,880
denominator how many borrowed CPUs were

504
00:22:31,420 --> 00:22:37,900
used to figure out this the this number

505
00:22:33,880 --> 00:22:39,790
of hashes right so figuring that out I

506
00:22:37,900 --> 00:22:40,840
asked a friend who minds monera even

507
00:22:39,790 --> 00:22:44,800
though I keep telling him to stop

508
00:22:40,840 --> 00:22:46,209
wasting his time and stupid I said well

509
00:22:44,800 --> 00:22:47,830
what are you doing your laptop and he

510
00:22:46,210 --> 00:22:51,070
said oh I'm getting like four to six

511
00:22:47,830 --> 00:22:53,830
hundred hashes a second and so I was

512
00:22:51,070 --> 00:22:55,928
like we'll just use the i7 fine it does

513
00:22:53,830 --> 00:22:58,899
five hundred hashes a second I'll work

514
00:22:55,929 --> 00:23:00,970
with that I don't care really and let's

515
00:22:58,900 --> 00:23:02,440
work on the assumption that a lot of

516
00:23:00,970 --> 00:23:04,300
these CBE's that we're using are also

517
00:23:02,440 --> 00:23:06,190
old too so people are probably going to

518
00:23:04,300 --> 00:23:08,260
be running the most bang spring brand

519
00:23:06,190 --> 00:23:09,220
spanking lee new AMD processor all the

520
00:23:08,260 --> 00:23:11,620
time you don't know what you're

521
00:23:09,220 --> 00:23:16,179
infecting when you're doing this right

522
00:23:11,620 --> 00:23:20,080
it's brain prey so if we take that and

523
00:23:16,179 --> 00:23:21,580
we assume 130 watts per I 7 processor we

524
00:23:20,080 --> 00:23:24,040
can figure out from each of these

525
00:23:21,580 --> 00:23:25,899
campaigns who's the biggest electricity

526
00:23:24,040 --> 00:23:28,149
consumer of all right who be the most

527
00:23:25,900 --> 00:23:29,950
number of hashes per second and it's the

528
00:23:28,150 --> 00:23:34,570
first one I showed you he was doing

529
00:23:29,950 --> 00:23:38,110
48,000 hashes a section a second which

530
00:23:34,570 --> 00:23:40,899
comes out to 96 borrowed laptops is the

531
00:23:38,110 --> 00:23:43,080
denominator I decided to use and twelve

532
00:23:40,900 --> 00:23:46,270
thousand four hundred eighty watts

533
00:23:43,080 --> 00:23:49,840
that's ten times what an average home in

534
00:23:46,270 --> 00:23:52,600
America uses for electricity per day so

535
00:23:49,840 --> 00:23:54,629
that's a lot of juice that he's sucking

536
00:23:52,600 --> 00:23:56,699
away the

537
00:23:54,630 --> 00:23:58,230
rest of them all sort of floated you can

538
00:23:56,700 --> 00:24:01,890
see here floated between eight and

539
00:23:58,230 --> 00:24:05,210
nineteen laptops of consumed electricity

540
00:24:01,890 --> 00:24:09,540
but still this actually works out into

541
00:24:05,210 --> 00:24:11,760
in my mind real energy real effort and

542
00:24:09,540 --> 00:24:15,000
real work that's now being pointlessly

543
00:24:11,760 --> 00:24:17,340
wasted in stolen from you right so it

544
00:24:15,000 --> 00:24:20,190
bears in mind to try to work it back to

545
00:24:17,340 --> 00:24:23,570
an actual cost impact of not grabbing

546
00:24:20,190 --> 00:24:26,610
this stuff and kicking off your network

547
00:24:23,570 --> 00:24:28,350
the other neat thing is is a lot of

548
00:24:26,610 --> 00:24:32,159
people probably say like well I think

549
00:24:28,350 --> 00:24:34,679
Mon Aero is you know meant to be able to

550
00:24:32,160 --> 00:24:36,750
hide identity well it is but you need to

551
00:24:34,680 --> 00:24:39,090
have a wallet to send it into the pool

552
00:24:36,750 --> 00:24:40,500
you can use another wallet to send it

553
00:24:39,090 --> 00:24:42,889
from the pool to somewhere else and

554
00:24:40,500 --> 00:24:46,950
that's sort of where the Chafee and the

555
00:24:42,890 --> 00:24:49,320
mix-ins of all the other hashes come in

556
00:24:46,950 --> 00:24:51,060
so if you can actually find that

557
00:24:49,320 --> 00:24:54,149
original wallet and then find that

558
00:24:51,060 --> 00:24:55,860
wallet sitting with someone else you

559
00:24:54,150 --> 00:24:58,020
might be able to get some attribution an

560
00:24:55,860 --> 00:25:00,659
intent to an actual person it would

561
00:24:58,020 --> 00:25:03,960
still be hard because anyone can submit

562
00:25:00,660 --> 00:25:05,850
with that hash to the pool if you

563
00:25:03,960 --> 00:25:13,440
feeling generous but that would be a

564
00:25:05,850 --> 00:25:15,330
little weird anyway so that's sort of

565
00:25:13,440 --> 00:25:17,670
how the pool stuff works and then I was

566
00:25:15,330 --> 00:25:19,139
looking at the pools and and how they're

567
00:25:17,670 --> 00:25:21,600
used like this and I realized that

568
00:25:19,140 --> 00:25:23,670
they're really not sort of like a pool

569
00:25:21,600 --> 00:25:26,280
pool sort of implies like group effort

570
00:25:23,670 --> 00:25:28,290
or resource sharing in some way right

571
00:25:26,280 --> 00:25:32,820
but really it's more like money

572
00:25:28,290 --> 00:25:34,560
laundering I though I don't care about

573
00:25:32,820 --> 00:25:36,480
the hash that I send it in with just

574
00:25:34,560 --> 00:25:38,370
that it's attributed to me and I send it

575
00:25:36,480 --> 00:25:40,320
out to other hashes and I have a way of

576
00:25:38,370 --> 00:25:45,870
putting it in and cleaning it and

577
00:25:40,320 --> 00:25:49,590
sending it back out so that's probably a

578
00:25:45,870 --> 00:25:51,719
better way of thinking about it and the

579
00:25:49,590 --> 00:25:54,620
conclusions on here I don't know if I

580
00:25:51,720 --> 00:25:56,900
really have a good conclusion for you

581
00:25:54,620 --> 00:25:59,129
normally they're like key takeaways or

582
00:25:56,900 --> 00:26:01,200
things that you need to take back with

583
00:25:59,130 --> 00:26:02,700
you I would just say make sure your

584
00:26:01,200 --> 00:26:04,560
network monitoring is looking for

585
00:26:02,700 --> 00:26:06,010
stratum leaving your network it's

586
00:26:04,560 --> 00:26:07,810
probably a really good

587
00:26:06,010 --> 00:26:09,190
strategy to stop this stuff to begin

588
00:26:07,810 --> 00:26:11,950
with

589
00:26:09,190 --> 00:26:15,250
also endpoint security of course to stop

590
00:26:11,950 --> 00:26:17,050
anything executing on there but really

591
00:26:15,250 --> 00:26:19,690
what I've learned is that there's a lot

592
00:26:17,050 --> 00:26:21,280
of scamming and abusers trying to

593
00:26:19,690 --> 00:26:23,520
generate profits off of other people's

594
00:26:21,280 --> 00:26:26,320
computers with this stuff more recently

595
00:26:23,520 --> 00:26:28,360
and I meant to steal the slides but I

596
00:26:26,320 --> 00:26:30,159
didn't have time one of our guys in

597
00:26:28,360 --> 00:26:33,280
Romania will be presenting next week at

598
00:26:30,160 --> 00:26:35,470
deaf camp and what he caught was a bunch

599
00:26:33,280 --> 00:26:38,560
of people using the eternal blue exploit

600
00:26:35,470 --> 00:26:40,480
which wanna cry also used to run around

601
00:26:38,560 --> 00:26:41,580
shifting miners from location to

602
00:26:40,480 --> 00:26:44,920
location

603
00:26:41,580 --> 00:26:49,990
and generating Monera coins with that as

604
00:26:44,920 --> 00:26:51,610
well so those are probably the main

605
00:26:49,990 --> 00:26:54,460
things to sort of take away from that

606
00:26:51,610 --> 00:26:56,649
and that is also like why I don't really

607
00:26:54,460 --> 00:26:58,780
dabble around and cryptocurrency at all

608
00:26:56,650 --> 00:27:00,940
is because there's just too too much

609
00:26:58,780 --> 00:27:02,410
sketchy stuff flying around with it the

610
00:27:00,940 --> 00:27:04,240
more I look at it like this the more I'm

611
00:27:02,410 --> 00:27:10,720
like I don't want any part to do with

612
00:27:04,240 --> 00:27:12,490
this stuff so I'll stop now that's sort

613
00:27:10,720 --> 00:27:14,050
of presentation one I have a bonus

614
00:27:12,490 --> 00:27:15,790
presentation because I told these guys

615
00:27:14,050 --> 00:27:18,070
that I was only gonna take up 30 minutes

616
00:27:15,790 --> 00:27:23,070
and they gave me an hour so are there

617
00:27:18,070 --> 00:27:23,070
any questions on this one yes

618
00:27:37,040 --> 00:27:44,389
I never really bothered executing them

619
00:27:43,040 --> 00:27:45,830
long enough to look at the network

620
00:27:44,390 --> 00:27:49,310
traffic data to see if they use it for

621
00:27:45,830 --> 00:27:50,899
c2 they definitely like half these

622
00:27:49,310 --> 00:27:52,730
miners like two of them at least are

623
00:27:50,900 --> 00:27:54,860
using off-the-shelf well known hashes

624
00:27:52,730 --> 00:27:56,210
for just XM our regular configuration I

625
00:27:54,860 --> 00:27:57,709
don't think that modified the code at

626
00:27:56,210 --> 00:27:59,270
all they don't care

627
00:27:57,710 --> 00:28:01,520
like that's the thing this lets you get

628
00:27:59,270 --> 00:28:04,250
past having c2 at all you don't need to

629
00:28:01,520 --> 00:28:06,440
have c2 you just break it out rake it

630
00:28:04,250 --> 00:28:08,150
out rake it out like once a week sort of

631
00:28:06,440 --> 00:28:10,250
like the Mirai botnet guy is like I just

632
00:28:08,150 --> 00:28:13,910
put this out there once a week I get

633
00:28:10,250 --> 00:28:18,890
300,000 IOT devices why do I need c2 why

634
00:28:13,910 --> 00:28:38,150
do I need persistence guy back there

635
00:28:18,890 --> 00:28:41,600
question i I know of names of endpoint

636
00:28:38,150 --> 00:28:43,760
solutions like the biggest one on the

637
00:28:41,600 --> 00:28:46,189
planet is probably carbon block right

638
00:28:43,760 --> 00:28:48,620
I've never deployed an endpoint solution

639
00:28:46,190 --> 00:28:50,720
so I can't really advocate for one over

640
00:28:48,620 --> 00:28:53,030
another one but what it will do is

641
00:28:50,720 --> 00:28:54,770
identify when you have something weird

642
00:28:53,030 --> 00:28:56,660
executing your environment that's on the

643
00:28:54,770 --> 00:28:58,850
only one computer out of a thousand and

644
00:28:56,660 --> 00:29:02,030
anything that will do that for you is a

645
00:28:58,850 --> 00:29:04,520
good thing to probably have right what

646
00:29:02,030 --> 00:29:06,110
we actually use this for our threat

647
00:29:04,520 --> 00:29:09,350
intelligence for is on a network based

648
00:29:06,110 --> 00:29:11,419
platform where we'll stop you from

649
00:29:09,350 --> 00:29:13,909
communicating to these locations we

650
00:29:11,420 --> 00:29:17,390
identify them as hosting malicious shell

651
00:29:13,910 --> 00:29:19,340
scripts or malicious BOTS or mining

652
00:29:17,390 --> 00:29:22,330
pools or whatever and we'll flag them

653
00:29:19,340 --> 00:29:24,470
for you and halt communication so that's

654
00:29:22,330 --> 00:29:28,480
what we're looking at from a network

655
00:29:24,470 --> 00:29:28,480
level yes

656
00:29:32,890 --> 00:29:57,549
I heard SELinux selinux a farmer and not

657
00:29:44,470 --> 00:29:58,840
much else I'm sorry man right yeah if

658
00:29:57,549 --> 00:30:01,510
you have like a file monitoring

659
00:29:58,840 --> 00:30:03,220
integrity solution that like either

660
00:30:01,510 --> 00:30:07,799
alert you when stuff's modified or

661
00:30:03,220 --> 00:30:14,260
prevents it from happening yes for sure

662
00:30:07,799 --> 00:30:16,240
but obviously not everyone does that but

663
00:30:14,260 --> 00:30:18,040
yes that's that that's a totally valid

664
00:30:16,240 --> 00:30:20,320
way of hardening it down but there's

665
00:30:18,040 --> 00:30:22,899
there's a lot of times like like that

666
00:30:20,320 --> 00:30:24,340
rails example right there's a lot of

667
00:30:22,900 --> 00:30:26,080
times where you're gonna end up with a

668
00:30:24,340 --> 00:30:27,879
bespoke application that's running rails

669
00:30:26,080 --> 00:30:29,590
and no one wants to touch it because

670
00:30:27,880 --> 00:30:31,600
everyone's afraid of breaking it and

671
00:30:29,590 --> 00:30:34,809
it's running a business critical hoozy

672
00:30:31,600 --> 00:30:36,159
what's it's right so I know I actually

673
00:30:34,809 --> 00:30:37,690
have written a couple of those business

674
00:30:36,160 --> 00:30:43,360
critical hootie budgets and I don't want

675
00:30:37,690 --> 00:30:45,370
to touch it so any other questions about

676
00:30:43,360 --> 00:30:51,100
crypto miners llanera

677
00:30:45,370 --> 00:30:53,049
kryptonite no if I were you I would try

678
00:30:51,100 --> 00:30:55,270
to either figure out or maintain my own

679
00:30:53,049 --> 00:30:57,280
blacklist of mining pools as a starting

680
00:30:55,270 --> 00:30:58,450
point because there's no reason anything

681
00:30:57,280 --> 00:31:04,540
on your network should be touching that

682
00:30:58,450 --> 00:31:06,370
stuff okay so as promised I have a bonus

683
00:31:04,540 --> 00:31:08,320
presentation and this one I asked them

684
00:31:06,370 --> 00:31:11,610
not to record so I'll use foul language

685
00:31:08,320 --> 00:31:11,610
to make it extra

