1
00:00:03,730 --> 00:00:09,850
today you want to talk to you about a

2
00:00:06,430 --> 00:00:14,020
piece of malware called for MOOC which

3
00:00:09,850 --> 00:00:15,580
well we will try to showcase a good

4
00:00:14,020 --> 00:00:17,800
example that what we believe is

5
00:00:15,580 --> 00:00:19,300
cybercrime and the cybercrime industry

6
00:00:17,800 --> 00:00:22,660
and how it works and what it does and

7
00:00:19,300 --> 00:00:23,830
how it does what it does okay so first

8
00:00:22,660 --> 00:00:26,679
we will introduce ourselves

9
00:00:23,830 --> 00:00:28,448
then because I don't know exactly what

10
00:00:26,679 --> 00:00:30,400
background each of you has we want to

11
00:00:28,449 --> 00:00:32,619
introduce just a tiny bit how cybercrime

12
00:00:30,400 --> 00:00:33,460
is right now at this point any time at

13
00:00:32,619 --> 00:00:36,850
this point in time

14
00:00:33,460 --> 00:00:38,350
then we'll be loath of you the malware

15
00:00:36,850 --> 00:00:40,719
sample the distribution of the malware

16
00:00:38,350 --> 00:00:43,329
sample the panel how it works the tweets

17
00:00:40,719 --> 00:00:46,000
it has that kind of stuff and afterwards

18
00:00:43,329 --> 00:00:48,519
we will just talk about the threat actor

19
00:00:46,000 --> 00:00:51,760
behind this behind this malware the

20
00:00:48,519 --> 00:00:55,929
developer who made the malware and his

21
00:00:51,760 --> 00:00:58,030
history with with it okay so let's start

22
00:00:55,929 --> 00:01:01,960
I'm big telecine I am lab stimulated

23
00:00:58,030 --> 00:01:03,129
blue live my job mainly entails threat

24
00:01:01,960 --> 00:01:06,190
analyst with a bit of reverse

25
00:01:03,129 --> 00:01:08,679
engineering on the side I know I wish as

26
00:01:06,190 --> 00:01:10,960
well that this was like the other way

27
00:01:08,680 --> 00:01:13,300
around but it is what it is if you have

28
00:01:10,960 --> 00:01:14,380
any doubts about hope you have any

29
00:01:13,300 --> 00:01:17,440
questions that we can answer right now

30
00:01:14,380 --> 00:01:20,740
you can just send an email okay hi I'm

31
00:01:17,440 --> 00:01:25,270
more ha I'm working him to live for four

32
00:01:20,740 --> 00:01:28,390
years the last two laps team member and

33
00:01:25,270 --> 00:01:33,520
I work in I'm working doing threat

34
00:01:28,390 --> 00:01:35,010
analysis and protector tracking and all

35
00:01:33,520 --> 00:01:37,920
their things

36
00:01:35,010 --> 00:01:41,020
okay so let's cut to the chase

37
00:01:37,920 --> 00:01:42,360
interesting part that's that's better

38
00:01:41,020 --> 00:01:47,110
right

39
00:01:42,360 --> 00:01:48,370
hello yeah okay so cyber crime is a

40
00:01:47,110 --> 00:01:50,220
living entity it adapts the

41
00:01:48,370 --> 00:01:53,590
countermeasures and it evolves with time

42
00:01:50,220 --> 00:01:56,860
what does this mean that means that when

43
00:01:53,590 --> 00:01:58,870
we try to look at that in at an event

44
00:01:56,860 --> 00:02:00,520
that happened related to cyber crime we

45
00:01:58,870 --> 00:02:03,220
also need a context and that context is

46
00:02:00,520 --> 00:02:04,720
usually like time and the technology

47
00:02:03,220 --> 00:02:08,378
available world events that kind of

48
00:02:04,720 --> 00:02:09,419
stuff okay which is what we will try to

49
00:02:08,378 --> 00:02:11,489
do right now

50
00:02:09,419 --> 00:02:13,120
[Music]

51
00:02:11,489 --> 00:02:16,670
what Wow

52
00:02:13,120 --> 00:02:19,760
okay so what you cannot see here

53
00:02:16,670 --> 00:02:22,069
is is a picture representing the current

54
00:02:19,760 --> 00:02:24,440
the state of cybercrime right now a

55
00:02:22,069 --> 00:02:27,260
cybercrime can be seen as a sort of

56
00:02:24,440 --> 00:02:28,819
industry in which you have like you have

57
00:02:27,260 --> 00:02:30,410
your providers you have people creating

58
00:02:28,819 --> 00:02:32,420
services you have channels to exchange

59
00:02:30,410 --> 00:02:35,290
information you have channels to sell

60
00:02:32,420 --> 00:02:37,549
information and you have clients from

61
00:02:35,290 --> 00:02:39,799
organizations well organized groups you

62
00:02:37,550 --> 00:02:42,050
have a script kiddies you have almost

63
00:02:39,800 --> 00:02:44,480
everything in here people that code for

64
00:02:42,050 --> 00:02:46,340
money people that just his only job is

65
00:02:44,480 --> 00:02:48,230
focused purely on distribution of

66
00:02:46,340 --> 00:02:49,670
malware others that the only thing they

67
00:02:48,230 --> 00:02:51,859
do is just trying to gather information

68
00:02:49,670 --> 00:02:54,079
as well and sell it related to

69
00:02:51,860 --> 00:02:55,970
distribution campaigns and then you have

70
00:02:54,080 --> 00:02:59,090
researchers meddling in the middle which

71
00:02:55,970 --> 00:03:01,070
sometimes you find as well in this case

72
00:02:59,090 --> 00:03:06,019
because we're dealing with a malware

73
00:03:01,070 --> 00:03:08,239
related cybercrime operation I wanted to

74
00:03:06,019 --> 00:03:11,420
introduce you to the concept of the kill

75
00:03:08,239 --> 00:03:15,290
chain the kill chain is just like this

76
00:03:11,420 --> 00:03:16,970
this these steps which describe what the

77
00:03:15,290 --> 00:03:19,579
threat actor or what the threat actors

78
00:03:16,970 --> 00:03:21,799
have to do from the moment they decide

79
00:03:19,580 --> 00:03:24,230
they want to infect someone or some

80
00:03:21,799 --> 00:03:27,470
group of people to the moment in which

81
00:03:24,230 --> 00:03:29,899
they manage to steal their data the

82
00:03:27,470 --> 00:03:32,410
first step which would be reconnaissance

83
00:03:29,900 --> 00:03:34,790
is just an attempt to gather information

84
00:03:32,410 --> 00:03:36,590
let's say you want for example to attack

85
00:03:34,790 --> 00:03:38,540
a company a known company so what you

86
00:03:36,590 --> 00:03:41,209
want to do is you want to find out how

87
00:03:38,540 --> 00:03:42,140
do they configure the users how their

88
00:03:41,209 --> 00:03:44,420
emails work

89
00:03:42,140 --> 00:03:45,920
what kind of signatures they have do

90
00:03:44,420 --> 00:03:47,480
they have a firewall do they have a wife

91
00:03:45,920 --> 00:03:48,798
that kind of stuff you know something

92
00:03:47,480 --> 00:03:51,369
anything that can stop you when you try

93
00:03:48,799 --> 00:03:55,299
to attack them in this case for example

94
00:03:51,370 --> 00:03:57,410
if you wanted to attack United Kingdom

95
00:03:55,299 --> 00:03:59,450
people just in general you know like

96
00:03:57,410 --> 00:04:00,739
targeting civilians you would need to

97
00:03:59,450 --> 00:04:02,359
acquire lists of emails that you know

98
00:04:00,739 --> 00:04:05,690
belong there because that way you can

99
00:04:02,360 --> 00:04:09,590
make very focused campaigns the next

100
00:04:05,690 --> 00:04:12,079
step with this weaponization would be to

101
00:04:09,590 --> 00:04:14,959
look for that exploit that exploit kit

102
00:04:12,079 --> 00:04:17,030
that vulnerability or just a word macro

103
00:04:14,959 --> 00:04:18,250
that you can use in order to infect

104
00:04:17,029 --> 00:04:21,289
those people

105
00:04:18,250 --> 00:04:23,090
Laer which is a next step these four

106
00:04:21,289 --> 00:04:25,520
steps can be almost what these three

107
00:04:23,090 --> 00:04:27,409
steps can almost always go together so

108
00:04:25,520 --> 00:04:29,330
in an email for example an email

109
00:04:27,410 --> 00:04:30,050
campaign you would have an email with an

110
00:04:29,330 --> 00:04:32,270
attachment

111
00:04:30,050 --> 00:04:35,720
and that email has a Content that email

112
00:04:32,270 --> 00:04:37,878
is sent to someone in particular so the

113
00:04:35,720 --> 00:04:39,500
email might be the Lord like hey have

114
00:04:37,879 --> 00:04:42,409
you sets have you seen these photos in

115
00:04:39,500 --> 00:04:43,849
here that I'm sending you the the

116
00:04:42,409 --> 00:04:46,159
weaponization might be the exploit

117
00:04:43,849 --> 00:04:47,509
that's inside those photos and the

118
00:04:46,159 --> 00:04:49,009
redirection of exploitation would be

119
00:04:47,509 --> 00:04:52,280
when you managed to get the user to open

120
00:04:49,009 --> 00:04:54,020
that that file once the user has opened

121
00:04:52,280 --> 00:04:56,568
that file the infection phase begins

122
00:04:54,020 --> 00:04:58,520
this is when the malware sets up his his

123
00:04:56,569 --> 00:05:00,530
house and he gains persistence and he

124
00:04:58,520 --> 00:05:03,948
decides that he is going to live in that

125
00:05:00,530 --> 00:05:06,679
computer because it's of interest to him

126
00:05:03,949 --> 00:05:10,460
so we are assuming that it's a it's able

127
00:05:06,680 --> 00:05:12,440
to tell one real user from a VM from a

128
00:05:10,460 --> 00:05:15,109
sandbox from a researcher sandbox you

129
00:05:12,440 --> 00:05:16,819
know that kind of stuff after verifying

130
00:05:15,110 --> 00:05:18,349
all of that information it will contact

131
00:05:16,819 --> 00:05:20,180
its command and control server which is

132
00:05:18,349 --> 00:05:22,250
the server that the threat actor that

133
00:05:20,180 --> 00:05:25,280
actor the group will use in order to

134
00:05:22,250 --> 00:05:29,360
like manipulate the sample and then it

135
00:05:25,280 --> 00:05:33,068
will begin stealing data so for farm

136
00:05:29,360 --> 00:05:35,990
work oh yeah sorry I forgot about this

137
00:05:33,069 --> 00:05:39,560
in here I'm just showing some examples

138
00:05:35,990 --> 00:05:41,449
of forums mostly frequent by script

139
00:05:39,560 --> 00:05:43,759
kiddies and that kind of stuff that kind

140
00:05:41,449 --> 00:05:45,440
of low-level profile in which they are

141
00:05:43,759 --> 00:05:46,759
already like offering in here in these

142
00:05:45,440 --> 00:05:48,830
last entries as Windows installation

143
00:05:46,759 --> 00:05:50,479
uniqueness this is a guy offering a

144
00:05:48,830 --> 00:05:52,370
service he has already about not

145
00:05:50,479 --> 00:05:53,900
deployed with I'm just making this up

146
00:05:52,370 --> 00:05:56,810
because I can't I can't remember the

147
00:05:53,900 --> 00:05:59,568
exact number but 1000 watts and he says

148
00:05:56,810 --> 00:06:01,699
look I have a 1000 computers I am

149
00:05:59,569 --> 00:06:03,979
renting them to you you can infect those

150
00:06:01,699 --> 00:06:07,009
computers if you want and you skip the

151
00:06:03,979 --> 00:06:09,740
for the first four steps of the Quixote

152
00:06:07,009 --> 00:06:11,419
and he's just offering that service in

153
00:06:09,740 --> 00:06:13,370
here you can see people offering

154
00:06:11,419 --> 00:06:15,669
tutorials how to create an exploit back

155
00:06:13,370 --> 00:06:18,110
newbie for newbies and kind of stuff

156
00:06:15,669 --> 00:06:20,060
here tutorial for you is how to set up

157
00:06:18,110 --> 00:06:21,620
an easy to be botnet panel so they are

158
00:06:20,060 --> 00:06:25,840
trying to transfer knowledge they are

159
00:06:21,620 --> 00:06:28,279
trying to teach teacher cybercrime

160
00:06:25,840 --> 00:06:32,690
cybercrime people who will want to

161
00:06:28,279 --> 00:06:36,409
commit felonies as well and that's just

162
00:06:32,690 --> 00:06:39,770
another example as well okay now about

163
00:06:36,409 --> 00:06:41,060
forum work what is form work form work

164
00:06:39,770 --> 00:06:43,960
is known for being one of the best

165
00:06:41,060 --> 00:06:45,610
information still malware out there

166
00:06:43,960 --> 00:06:47,770
it has support for more than 80

167
00:06:45,610 --> 00:06:50,949
applications for how will it tell you

168
00:06:47,770 --> 00:06:53,560
about that afterwards it's the

169
00:06:50,949 --> 00:06:55,150
techniques it uses are known as form

170
00:06:53,560 --> 00:06:57,610
grabbing and keylogging I am sure most

171
00:06:55,150 --> 00:07:01,690
of you know what keylogging is but form

172
00:06:57,610 --> 00:07:03,759
grabbing it's not such it's not so known

173
00:07:01,690 --> 00:07:07,060
as keylogging from grabbing is basically

174
00:07:03,759 --> 00:07:08,710
a technique which works through the

175
00:07:07,060 --> 00:07:12,160
infecting a known process for example

176
00:07:08,710 --> 00:07:14,979
the chrome process and then hooking the

177
00:07:12,160 --> 00:07:17,050
calls it makes to make the requests to

178
00:07:14,979 --> 00:07:18,669
your to the server his contacting that

179
00:07:17,050 --> 00:07:20,080
way he can examine the buffer that you

180
00:07:18,669 --> 00:07:23,919
can have in that request and is still

181
00:07:20,080 --> 00:07:25,659
information from there it also it's also

182
00:07:23,919 --> 00:07:27,490
credential stealer we call credential

183
00:07:25,660 --> 00:07:29,410
stealers every malware that has the

184
00:07:27,490 --> 00:07:32,380
capability of going to the Chrome

185
00:07:29,410 --> 00:07:33,669
Firefox or Internet Explorer vault and

186
00:07:32,380 --> 00:07:35,139
the vault is where they store the

187
00:07:33,669 --> 00:07:36,490
credentials you know that message that

188
00:07:35,139 --> 00:07:38,260
pops up hey do you want to stop your

189
00:07:36,490 --> 00:07:40,900
credential so this very critical service

190
00:07:38,260 --> 00:07:42,639
yes okay well when you get infected the

191
00:07:40,900 --> 00:07:47,590
marvel will go to that database and

192
00:07:42,639 --> 00:07:48,880
still of your stuff and then another

193
00:07:47,590 --> 00:07:50,440
characteristic that I find this very

194
00:07:48,880 --> 00:07:52,690
interesting besides being sold on

195
00:07:50,440 --> 00:07:55,479
underground forums instead of markets or

196
00:07:52,690 --> 00:07:57,699
from peer to peer which also happens is

197
00:07:55,479 --> 00:08:00,940
that for book offers a subscription plan

198
00:07:57,699 --> 00:08:03,550
you can basically pay like $30 a month

199
00:08:00,940 --> 00:08:05,110
and you get your domain and you get your

200
00:08:03,550 --> 00:08:06,610
host and you get your sample and you

201
00:08:05,110 --> 00:08:12,130
only have to distribute it and

202
00:08:06,610 --> 00:08:13,780
everything else is set up for you so in

203
00:08:12,130 --> 00:08:16,210
order to understand how form work works

204
00:08:13,780 --> 00:08:18,940
and how the people around it are using

205
00:08:16,210 --> 00:08:20,560
it we need to analyze every piece of

206
00:08:18,940 --> 00:08:22,120
knowledge that we get and from a

207
00:08:20,560 --> 00:08:23,860
research point of view the pieces of

208
00:08:22,120 --> 00:08:26,889
knowledge we get our command and control

209
00:08:23,860 --> 00:08:30,300
servers we get samples we get emails

210
00:08:26,889 --> 00:08:32,500
used by the for the distribution we get

211
00:08:30,300 --> 00:08:34,930
everything we can communications keys

212
00:08:32,500 --> 00:08:37,120
they use all of that it is what we call

213
00:08:34,929 --> 00:08:39,848
indicators of compromise or indicator of

214
00:08:37,120 --> 00:08:41,830
actor and this stuff can identify a

215
00:08:39,849 --> 00:08:44,860
single actor among a group for example

216
00:08:41,830 --> 00:08:47,380
or a targeted attack just based on that

217
00:08:44,860 --> 00:08:52,209
information and each what we will try to

218
00:08:47,380 --> 00:08:53,620
showcase today okay now we're going to

219
00:08:52,209 --> 00:08:55,869
continue with the distribution and the

220
00:08:53,620 --> 00:08:57,790
campaign's we have detected for this

221
00:08:55,870 --> 00:09:01,139
presentation why

222
00:08:57,790 --> 00:09:04,899
we were investigating for look we found

223
00:09:01,139 --> 00:09:09,519
some campaigns that where a distribution

224
00:09:04,899 --> 00:09:12,449
of for book through email campaigns this

225
00:09:09,519 --> 00:09:16,920
emails have attached it an RTF document

226
00:09:12,449 --> 00:09:20,979
the most affected countries where United

227
00:09:16,920 --> 00:09:25,510
Kingdom United States Canada suit Korea

228
00:09:20,980 --> 00:09:31,120
and France this was executed in the last

229
00:09:25,510 --> 00:09:35,829
quarter of 2019 and these documents take

230
00:09:31,120 --> 00:09:41,110
profit about two to exploits and a

231
00:09:35,829 --> 00:09:44,349
Microsoft Office and Microsoft Windows

232
00:09:41,110 --> 00:09:46,029
common controls activist code execute

233
00:09:44,350 --> 00:09:48,220
your narrative I know that the name is

234
00:09:46,029 --> 00:09:50,620
like very long but I'm sure you have do

235
00:09:48,220 --> 00:09:53,170
you remember if I'm not mistaken do you

236
00:09:50,620 --> 00:09:54,970
remember like a news piece that said hey

237
00:09:53,170 --> 00:09:58,110
be careful because we found the

238
00:09:54,970 --> 00:10:01,600
vulnerability that exploits the equation

239
00:09:58,110 --> 00:10:03,100
the equation yeah for malaria for for

240
00:10:01,600 --> 00:10:06,630
talks well that's that's the thing that

241
00:10:03,100 --> 00:10:12,399
they're using yeah both of them are

242
00:10:06,630 --> 00:10:15,910
affecting the Microsoft Office where the

243
00:10:12,399 --> 00:10:20,589
two are buffer overflow guna now it is

244
00:10:15,910 --> 00:10:24,610
to why were investigating this we found

245
00:10:20,589 --> 00:10:26,949
that they are using common subjects all

246
00:10:24,610 --> 00:10:29,290
of them are talking about the products

247
00:10:26,949 --> 00:10:32,620
order that we found that there are a

248
00:10:29,290 --> 00:10:35,290
different subjects the quotation and

249
00:10:32,620 --> 00:10:37,930
inquiry that we found six different and

250
00:10:35,290 --> 00:10:41,019
documents we can see some of the

251
00:10:37,930 --> 00:10:45,089
subjects they were using and we found

252
00:10:41,019 --> 00:10:48,279
four different campaigns using different

253
00:10:45,089 --> 00:10:54,279
emails we can see here that they bought

254
00:10:48,279 --> 00:10:57,699
some some domain and here they were

255
00:10:54,279 --> 00:11:03,310
using free domain and using Gmail maybe

256
00:10:57,699 --> 00:11:06,189
from my cones that were still in here we

257
00:11:03,310 --> 00:11:09,969
can see it two of the two samples of the

258
00:11:06,189 --> 00:11:11,140
emails use it and you can see that the

259
00:11:09,970 --> 00:11:14,140
both of yous

260
00:11:11,140 --> 00:11:16,900
targeting some corporations and they

261
00:11:14,140 --> 00:11:19,150
want to to infect this kind of people

262
00:11:16,900 --> 00:11:21,370
yep basically the content of the email

263
00:11:19,150 --> 00:11:23,260
plus the subjects we've seen before they

264
00:11:21,370 --> 00:11:25,060
make reference to corporate contexts

265
00:11:23,260 --> 00:11:26,770
which is why we assume that they are

266
00:11:25,060 --> 00:11:31,589
targeting companies and not particular

267
00:11:26,770 --> 00:11:34,630
people yes Oh individuals then now

268
00:11:31,590 --> 00:11:35,950
Victor will talk about yeah about the

269
00:11:34,630 --> 00:11:40,420
thingy the reverse engineering thingy

270
00:11:35,950 --> 00:11:41,620
yeah okay so first thing and that's

271
00:11:40,420 --> 00:11:44,110
something that I find very interesting

272
00:11:41,620 --> 00:11:45,550
form would be sold and backed that's not

273
00:11:44,110 --> 00:11:47,680
usually happens usually when you buy

274
00:11:45,550 --> 00:11:50,620
when you buy buy where you find malware

275
00:11:47,680 --> 00:11:53,530
the malware usually comes with a builder

276
00:11:50,620 --> 00:11:58,870
and the Builder is has some sort of fu D

277
00:11:53,530 --> 00:12:02,760
which is fully undetectable Packer which

278
00:11:58,870 --> 00:12:04,690
gives gives you a final payload that

279
00:12:02,760 --> 00:12:06,760
allows you to just distribute it

280
00:12:04,690 --> 00:12:09,070
immediately that way when you sell your

281
00:12:06,760 --> 00:12:11,650
stuff to script kiddies they won't

282
00:12:09,070 --> 00:12:15,550
up okay and send something that's just

283
00:12:11,650 --> 00:12:18,550
the raw malware this works in our favor

284
00:12:15,550 --> 00:12:21,579
and against us in this case I found I

285
00:12:18,550 --> 00:12:25,240
found four book with visual basic script

286
00:12:21,580 --> 00:12:26,620
Packers Knapp C++ Delphi Packers very

287
00:12:25,240 --> 00:12:28,240
different stuff you know with very

288
00:12:26,620 --> 00:12:30,220
different techniques and packing into a

289
00:12:28,240 --> 00:12:32,890
new into a new process I'm packing in

290
00:12:30,220 --> 00:12:35,140
the same layer and as I was saying this

291
00:12:32,890 --> 00:12:37,000
has advantages and disadvantages mind

292
00:12:35,140 --> 00:12:40,090
you these are switched around these are

293
00:12:37,000 --> 00:12:42,130
advantages for them not for me okay so

294
00:12:40,090 --> 00:12:43,360
one of the advantages is that it's hard

295
00:12:42,130 --> 00:12:45,400
to unpack automatically

296
00:12:43,360 --> 00:12:47,020
I like when I'm investigating a new

297
00:12:45,400 --> 00:12:49,120
sample or what I'm trying to follow a

298
00:12:47,020 --> 00:12:50,650
campaign one thing that I try to do is

299
00:12:49,120 --> 00:12:52,330
to make a script that we low to medium

300
00:12:50,650 --> 00:12:54,220
packing so that I can more easily

301
00:12:52,330 --> 00:12:57,730
identify changes and that kind of stuff

302
00:12:54,220 --> 00:12:59,320
well this is hard with for mob basically

303
00:12:57,730 --> 00:13:02,590
because each Packer use its own

304
00:12:59,320 --> 00:13:04,630
technique and recognizing them it's more

305
00:13:02,590 --> 00:13:06,730
difficult on the other hand as a

306
00:13:04,630 --> 00:13:08,189
disadvantage for them you can find

307
00:13:06,730 --> 00:13:10,810
samples that are not packed

308
00:13:08,190 --> 00:13:12,880
making the first step of reckoning stuff

309
00:13:10,810 --> 00:13:14,650
of trying to understand the malware and

310
00:13:12,880 --> 00:13:19,390
find samples for that malware a bit

311
00:13:14,650 --> 00:13:21,040
easier another thing that I found that

312
00:13:19,390 --> 00:13:23,470
was very interesting as well is that

313
00:13:21,040 --> 00:13:25,660
firm work has a ton of anti features

314
00:13:23,470 --> 00:13:29,710
anti features at all of those features

315
00:13:25,660 --> 00:13:32,410
that what they work for is to hinder the

316
00:13:29,710 --> 00:13:35,290
researcher the researcher Alice's of the

317
00:13:32,410 --> 00:13:37,030
sample and these are just like untidy

318
00:13:35,290 --> 00:13:39,699
buggers and the sandbox VM and she

319
00:13:37,030 --> 00:13:41,380
analyses all of that stuff I wanted to

320
00:13:39,700 --> 00:13:43,390
make a special mention and I will ask

321
00:13:41,380 --> 00:13:45,550
anyone who speaks French in the room to

322
00:13:43,390 --> 00:13:48,340
please forgive me for making your ears

323
00:13:45,550 --> 00:13:50,380
bleed I wanted to thank give me Julian I

324
00:13:48,340 --> 00:13:52,600
know that I didn't pronounce that very

325
00:13:50,380 --> 00:13:54,610
well from storm shield who published

326
00:13:52,600 --> 00:13:57,160
like a very very very very very detailed

327
00:13:54,610 --> 00:14:01,120
blog post related to these phantom

328
00:13:57,160 --> 00:14:03,579
measures okay so let's just have a quick

329
00:14:01,120 --> 00:14:04,840
overview of these measures for anti

330
00:14:03,580 --> 00:14:07,030
sandbox and on TBN techniques

331
00:14:04,840 --> 00:14:09,640
it has like dynamic function calling it

332
00:14:07,030 --> 00:14:10,480
has it load it loads its own copy of

333
00:14:09,640 --> 00:14:13,300
ntdll

334
00:14:10,480 --> 00:14:16,170
so that it erases any hooks you may have

335
00:14:13,300 --> 00:14:18,900
in that it checks for running processes

336
00:14:16,170 --> 00:14:22,839
that are known to be used by researchers

337
00:14:18,900 --> 00:14:25,780
it checks the loaded dll's sandbox paths

338
00:14:22,840 --> 00:14:27,580
user names and there are a few more that

339
00:14:25,780 --> 00:14:30,970
haven't been listed I wanted to speak

340
00:14:27,580 --> 00:14:33,760
about just to add a bit of my thing here

341
00:14:30,970 --> 00:14:36,640
just a couple of screenshots about the

342
00:14:33,760 --> 00:14:38,020
dynamic function calling as we will see

343
00:14:36,640 --> 00:14:39,790
later on form work

344
00:14:38,020 --> 00:14:42,760
tries to have like the least amount of

345
00:14:39,790 --> 00:14:44,589
information available on the go for

346
00:14:42,760 --> 00:14:47,230
further research so everything is

347
00:14:44,590 --> 00:14:49,000
encrypted in buffers and in this case it

348
00:14:47,230 --> 00:14:51,460
has a buffer with the list of hashes and

349
00:14:49,000 --> 00:14:54,700
these slices could respond to the crc32

350
00:14:51,460 --> 00:14:56,560
of a function name okay so when it wants

351
00:14:54,700 --> 00:14:57,850
to make a dynamic buna wants to call a

352
00:14:56,560 --> 00:14:59,859
function in this case

353
00:14:57,850 --> 00:15:01,120
anti system core information what it

354
00:14:59,860 --> 00:15:03,340
will do it will resolve the address

355
00:15:01,120 --> 00:15:05,200
first and afterwards in here I'm not

356
00:15:03,340 --> 00:15:09,220
sure if you can see it there's a call ax

357
00:15:05,200 --> 00:15:11,140
which will make the dynamic call okay so

358
00:15:09,220 --> 00:15:13,750
how does it do that first it gets the

359
00:15:11,140 --> 00:15:15,939
crc32 for that call and then it goes to

360
00:15:13,750 --> 00:15:18,310
the header of ntdll in this case looks

361
00:15:15,940 --> 00:15:20,200
to the export functions makes the crc32

362
00:15:18,310 --> 00:15:22,359
of all of the functions until it finds a

363
00:15:20,200 --> 00:15:24,070
match as you can see here in EAX

364
00:15:22,360 --> 00:15:27,460
you have the same value here then you

365
00:15:24,070 --> 00:15:30,460
have well not move but that's like a

366
00:15:27,460 --> 00:15:32,320
Python command line and you can in here

367
00:15:30,460 --> 00:15:33,040
down here you can see that there is the

368
00:15:32,320 --> 00:15:35,140
same number and

369
00:15:33,040 --> 00:15:38,319
then up there and that's the crc32

370
00:15:35,140 --> 00:15:40,300
forensic query system information after

371
00:15:38,320 --> 00:15:42,340
doing that it will just perform the call

372
00:15:40,300 --> 00:15:47,319
as you can see in the X you have the

373
00:15:42,340 --> 00:15:48,820
beginning of the function okay it also I

374
00:15:47,320 --> 00:15:52,380
also wanted to mention I don't know if

375
00:15:48,820 --> 00:15:56,200
there's a lot of malware savvy

376
00:15:52,380 --> 00:15:58,120
researchers here but when malware wants

377
00:15:56,200 --> 00:15:59,800
to iterate around the different

378
00:15:58,120 --> 00:16:03,820
processes that are running in the system

379
00:15:59,800 --> 00:16:07,000
what you usually see is is them making

380
00:16:03,820 --> 00:16:09,550
use of a function called create help

381
00:16:07,000 --> 00:16:11,440
snapshot 32 to something like that which

382
00:16:09,550 --> 00:16:13,780
is things as an object of the processes

383
00:16:11,440 --> 00:16:15,220
that are running okay in this case what

384
00:16:13,780 --> 00:16:16,900
it does is use the function that I

385
00:16:15,220 --> 00:16:18,970
mentioned previously and security system

386
00:16:16,900 --> 00:16:21,120
information with the flag you can see

387
00:16:18,970 --> 00:16:23,860
down there system process information

388
00:16:21,120 --> 00:16:26,140
which will return the same structure or

389
00:16:23,860 --> 00:16:28,120
one very similar to that of the other

390
00:16:26,140 --> 00:16:29,590
column but this is like weig sneakier

391
00:16:28,120 --> 00:16:32,050
when you are checking out the behavior

392
00:16:29,590 --> 00:16:33,970
of the sample instead of seeing a call

393
00:16:32,050 --> 00:16:35,770
that just tells you hey I'm looking at

394
00:16:33,970 --> 00:16:37,510
all the at all the processes did you see

395
00:16:35,770 --> 00:16:39,640
something waiting for information and

396
00:16:37,510 --> 00:16:40,750
unless you know that oh five is the flag

397
00:16:39,640 --> 00:16:46,720
that you need to get that information

398
00:16:40,750 --> 00:16:49,060
you lost I just thought it was cool as

399
00:16:46,720 --> 00:16:51,250
for other things it does it takes for a

400
00:16:49,060 --> 00:16:52,810
for an T debugging as well and in this

401
00:16:51,250 --> 00:16:54,370
case it's X for kernel debugging which

402
00:16:52,810 --> 00:16:56,290
is not it's something unusual as well

403
00:16:54,370 --> 00:16:58,420
using the same function I mentioned

404
00:16:56,290 --> 00:17:01,089
before and then instead of going to like

405
00:16:58,420 --> 00:17:03,160
every malware to the P to the P AV and

406
00:17:01,090 --> 00:17:05,410
checking if it's being the work with my

407
00:17:03,160 --> 00:17:08,349
being debugged it just checks if there's

408
00:17:05,410 --> 00:17:09,339
a process above port open which is very

409
00:17:08,349 --> 00:17:13,060
sneaky as well

410
00:17:09,339 --> 00:17:14,230
and harder to bypass okay now to the

411
00:17:13,060 --> 00:17:18,849
last encryption remember that I

412
00:17:14,230 --> 00:17:22,270
mentioned some buffers well I hope that

413
00:17:18,849 --> 00:17:25,389
the yes ASM would be better but it is

414
00:17:22,270 --> 00:17:27,010
not so well it's fine I mean the only

415
00:17:25,390 --> 00:17:28,960
thing it needs to do in order to decode

416
00:17:27,010 --> 00:17:30,400
the information it has like two

417
00:17:28,960 --> 00:17:32,590
different functions to decode different

418
00:17:30,400 --> 00:17:34,510
types of buffers ones are encrypted

419
00:17:32,590 --> 00:17:36,340
the others are encoded the rights that

420
00:17:34,510 --> 00:17:38,770
are the developers that are encoded are

421
00:17:36,340 --> 00:17:40,179
just he just applies like a series of

422
00:17:38,770 --> 00:17:41,710
transforms that I don't think they are a

423
00:17:40,180 --> 00:17:43,180
standard they just something he cooked

424
00:17:41,710 --> 00:17:45,430
himself and the other one is encrypted

425
00:17:43,180 --> 00:17:46,270
with 34 like almost everything else in

426
00:17:45,430 --> 00:17:48,700
the sample

427
00:17:46,270 --> 00:17:50,440
in this case what it does and that's the

428
00:17:48,700 --> 00:17:52,540
interesting part is you see that

429
00:17:50,440 --> 00:17:53,710
function here getting cryptid buffer the

430
00:17:52,540 --> 00:17:54,610
only thing it does is called the next

431
00:17:53,710 --> 00:17:56,980
instruction yeah

432
00:17:54,610 --> 00:17:59,379
call sign dollar sign plus five will

433
00:17:56,980 --> 00:18:01,360
call the pop AIX when you do the pop AIX

434
00:17:59,380 --> 00:18:03,670
after the call has pushed at the top of

435
00:18:01,360 --> 00:18:05,199
the stack the return address you put the

436
00:18:03,670 --> 00:18:08,320
return address which is the beginning of

437
00:18:05,200 --> 00:18:09,790
the function at the pad in EAX okay so

438
00:18:08,320 --> 00:18:13,120
now you have these others in EAX

439
00:18:09,790 --> 00:18:16,300
when it returns it will move it will add

440
00:18:13,120 --> 00:18:18,850
two to a X so now it's pointing here and

441
00:18:16,300 --> 00:18:20,139
it will get into the code block the code

442
00:18:18,850 --> 00:18:21,939
block the only thing that will do is

443
00:18:20,140 --> 00:18:23,290
check if that begins with the parameter

444
00:18:21,940 --> 00:18:28,690
of the function as you can see in here

445
00:18:23,290 --> 00:18:30,340
yes 55:8 be like here 55 and ap if it

446
00:18:28,690 --> 00:18:33,190
begins with the point of the function it

447
00:18:30,340 --> 00:18:35,699
knows that that after that call there is

448
00:18:33,190 --> 00:18:40,059
an encrypted buffer it will add three

449
00:18:35,700 --> 00:18:42,130
yeah and that gets you these others here

450
00:18:40,059 --> 00:18:42,610
which is the beginning of the encryption

451
00:18:42,130 --> 00:18:45,400
buffer

452
00:18:42,610 --> 00:18:48,490
I just thought that was something cool

453
00:18:45,400 --> 00:18:50,650
he does it's not nothing in here is new

454
00:18:48,490 --> 00:18:52,270
I mean all of all of this is done by

455
00:18:50,650 --> 00:18:53,530
other samples I just think that firm

456
00:18:52,270 --> 00:18:56,590
work is very interesting because it kind

457
00:18:53,530 --> 00:18:59,260
of gathers a lot of small things in

458
00:18:56,590 --> 00:19:01,300
small techniques what you can see in

459
00:18:59,260 --> 00:19:03,220
here any reverse engineer will tell you

460
00:19:01,300 --> 00:19:06,909
that this looks like like a checking

461
00:19:03,220 --> 00:19:10,840
function every time that that form book

462
00:19:06,910 --> 00:19:12,520
detects every time that lunch is one of

463
00:19:10,840 --> 00:19:15,459
those antics so the anti debug the

464
00:19:12,520 --> 00:19:17,500
kernel debugging DMI being in exhibited

465
00:19:15,460 --> 00:19:19,000
in a sandbox every time it does that it

466
00:19:17,500 --> 00:19:21,160
will fill in a structure that it keeps

467
00:19:19,000 --> 00:19:22,929
internally and this structure has got

468
00:19:21,160 --> 00:19:25,300
just a bunch of flags and that's what

469
00:19:22,929 --> 00:19:27,100
it's looking at here okay every one of

470
00:19:25,300 --> 00:19:29,409
these conditions is it maybe in the back

471
00:19:27,100 --> 00:19:31,928
no anybody in a sandbox not in a VM no

472
00:19:29,410 --> 00:19:34,120
next next next next next when you have

473
00:19:31,929 --> 00:19:35,860
reverse engineer some samples the first

474
00:19:34,120 --> 00:19:38,229
thing you will try to do is say okay I'm

475
00:19:35,860 --> 00:19:39,820
just a skipping all of this I don't care

476
00:19:38,230 --> 00:19:41,320
what you think you with what you think

477
00:19:39,820 --> 00:19:43,059
I'm what you kept I don't care what you

478
00:19:41,320 --> 00:19:44,439
think you are I'm telling you what you

479
00:19:43,059 --> 00:19:47,559
are and you are not in a sandbox so

480
00:19:44,440 --> 00:19:49,870
continue your execution thing is every

481
00:19:47,559 --> 00:19:53,500
time it fails one of these checks it

482
00:19:49,870 --> 00:19:55,330
modifies the crc32 list so the next time

483
00:19:53,500 --> 00:19:57,490
it attempts to resolve a function it

484
00:19:55,330 --> 00:19:59,549
will get a null pointer it will call to

485
00:19:57,490 --> 00:20:02,100
a null pointer and the sample will crash

486
00:19:59,549 --> 00:20:04,679
so you have to actually manage to bypass

487
00:20:02,100 --> 00:20:07,949
each of them one by one or else you

488
00:20:04,679 --> 00:20:10,230
don't get the sample to get assuming it

489
00:20:07,950 --> 00:20:12,210
passes all of those checks it injects a

490
00:20:10,230 --> 00:20:16,049
payload in Dukes brother is a Nikoli as

491
00:20:12,210 --> 00:20:17,820
well using lesser known methods and then

492
00:20:16,049 --> 00:20:21,059
it's an exact secretarial from a list of

493
00:20:17,820 --> 00:20:22,408
processes and then if that everything

494
00:20:21,059 --> 00:20:24,509
that it made everything work correctly

495
00:20:22,409 --> 00:20:26,519
it will tidy up the house it will gain

496
00:20:24,509 --> 00:20:29,700
persistence so it can survive three

497
00:20:26,519 --> 00:20:31,559
boots and then it will delete the

498
00:20:29,700 --> 00:20:36,480
original sample so there's no choice

499
00:20:31,559 --> 00:20:38,759
that it says it has been there and then

500
00:20:36,480 --> 00:20:40,649
we'll start scaling it which is the

501
00:20:38,759 --> 00:20:43,649
whole purpose of the marker how does it

502
00:20:40,649 --> 00:20:44,908
do that besides checking out the D volts

503
00:20:43,649 --> 00:20:48,658
which is something that's very common

504
00:20:44,909 --> 00:20:50,820
already for week we'll hook different

505
00:20:48,659 --> 00:20:54,359
api's some of them which are very common

506
00:20:50,820 --> 00:20:56,668
like HTTP and request a or W and then we

507
00:20:54,359 --> 00:20:58,199
just put a hook in there and get the

508
00:20:56,669 --> 00:21:00,539
buffer you're trying to send a request

509
00:20:58,200 --> 00:21:02,519
when examining the buffer even the

510
00:21:00,539 --> 00:21:04,320
buffer it has some key words like login

511
00:21:02,519 --> 00:21:05,399
username password it will keep that date

512
00:21:04,320 --> 00:21:08,059
and send it to the command and control

513
00:21:05,399 --> 00:21:11,850
server and now he has your data

514
00:21:08,059 --> 00:21:15,090
the interesting part about this damn it

515
00:21:11,850 --> 00:21:16,230
okay in there I'm sorry I just was using

516
00:21:15,090 --> 00:21:17,820
like a white screen and everything

517
00:21:16,230 --> 00:21:20,429
looked fine but in here it just

518
00:21:17,820 --> 00:21:22,499
compressed of it sorry what it does in

519
00:21:20,429 --> 00:21:24,179
here I don't know if you can well I

520
00:21:22,499 --> 00:21:25,980
think the highlighted parts are clearly

521
00:21:24,179 --> 00:21:27,989
enough so basically this is just a lamp

522
00:21:25,980 --> 00:21:32,309
with volatility of a process being

523
00:21:27,989 --> 00:21:34,830
hooked by my form book and what it has

524
00:21:32,309 --> 00:21:36,960
done it has hook a module that it's from

525
00:21:34,830 --> 00:21:38,908
from it's very targeted because it's

526
00:21:36,960 --> 00:21:42,210
from the Mozilla the Mozilla framework

527
00:21:38,909 --> 00:21:43,919
in CSS the DLL and this has a function

528
00:21:42,210 --> 00:21:46,649
called peer write which is used to write

529
00:21:43,919 --> 00:21:49,109
two buffers or sockets so that's what he

530
00:21:46,649 --> 00:21:51,689
has put this very like very surgical

531
00:21:49,109 --> 00:21:53,850
very surgical hook instead of hooking a

532
00:21:51,690 --> 00:21:55,440
more common happy it's targeting Firefox

533
00:21:53,850 --> 00:21:56,279
specifically I just thought that was

534
00:21:55,440 --> 00:21:58,830
relevant as well

535
00:21:56,279 --> 00:22:00,480
and now morph I will continue with an

536
00:21:58,830 --> 00:22:03,580
explanation related to the panel and the

537
00:22:00,480 --> 00:22:07,179
communications in the last month

538
00:22:03,580 --> 00:22:11,168
for book was a wall bit a lot and you

539
00:22:07,179 --> 00:22:13,779
now can find the version 4.2 but the

540
00:22:11,169 --> 00:22:20,039
most common versions what we can find in

541
00:22:13,779 --> 00:22:24,850
a while where the 3.8 and the 3.29 but

542
00:22:20,039 --> 00:22:30,549
here we can see the version 3.1 that

543
00:22:24,850 --> 00:22:32,649
it's it was fully set in a forum when

544
00:22:30,549 --> 00:22:35,259
you look at in you can find the

545
00:22:32,649 --> 00:22:37,268
dashboard in this you can see some

546
00:22:35,259 --> 00:22:42,639
statistics about the exfiltrated data

547
00:22:37,269 --> 00:22:49,289
here and well here you can see some of

548
00:22:42,639 --> 00:22:52,029
the users where was their last login and

549
00:22:49,289 --> 00:22:54,009
you can see the panel has a lot of the

550
00:22:52,029 --> 00:22:58,330
languages with super to translate this

551
00:22:54,009 --> 00:23:01,179
this panel you have a lot of the delayed

552
00:22:58,330 --> 00:23:06,279
views about the the forums the

553
00:23:01,179 --> 00:23:10,440
keystrokes or the the passwords that for

554
00:23:06,279 --> 00:23:12,850
MOOC was stealing and you can see that

555
00:23:10,440 --> 00:23:18,070
future of for MOOC that is pretty cool

556
00:23:12,850 --> 00:23:20,590
because it's like file browsing in in

557
00:23:18,070 --> 00:23:25,299
the computers that were infected by

558
00:23:20,590 --> 00:23:27,238
phone book in this case in this case

559
00:23:25,299 --> 00:23:29,889
this functionality in this version

560
00:23:27,239 --> 00:23:34,480
wasn't finished but in in the newest

561
00:23:29,889 --> 00:23:37,899
version Suites it's working and that you

562
00:23:34,480 --> 00:23:43,749
have have you with the control panel of

563
00:23:37,899 --> 00:23:45,488
the users every customer have a panel

564
00:23:43,749 --> 00:23:50,019
individual panel that it's identified

565
00:23:45,489 --> 00:23:52,269
with this part of the path this is the

566
00:23:50,019 --> 00:23:54,820
account name of the author panel every

567
00:23:52,269 --> 00:23:58,720
customer have one but every panel can

568
00:23:54,820 --> 00:24:00,340
have multiple users let's talk about the

569
00:23:58,720 --> 00:24:05,710
encryption and the communication with

570
00:24:00,340 --> 00:24:08,109
the C to the face step 2 to the

571
00:24:05,710 --> 00:24:13,960
communication is to get a key the key is

572
00:24:08,109 --> 00:24:17,250
unique reddit account nickname to do

573
00:24:13,960 --> 00:24:20,580
this for book takes the domain and the

574
00:24:17,250 --> 00:24:26,130
and the account name and do a heist that

575
00:24:20,580 --> 00:24:29,280
has huge result this is not the finality

576
00:24:26,130 --> 00:24:31,050
because for book do especially it's not

577
00:24:29,280 --> 00:24:34,470
a special operations he change the

578
00:24:31,050 --> 00:24:36,300
Indian s of the of the files to get the

579
00:24:34,470 --> 00:24:40,290
little endian version of the heist and

580
00:24:36,300 --> 00:24:43,830
then we have the key and we can include

581
00:24:40,290 --> 00:24:49,050
the communication using our c4 then the

582
00:24:43,830 --> 00:24:54,960
phases of the sample 2 step itself in

583
00:24:49,050 --> 00:24:56,820
the panel to do this must send a special

584
00:24:54,960 --> 00:25:02,030
packet that starts with a magic

585
00:24:56,820 --> 00:25:06,300
identified by fvn team followed by a

586
00:25:02,030 --> 00:25:09,899
crc32 the version of the panel the

587
00:25:06,300 --> 00:25:12,930
operating system name and you said

588
00:25:09,900 --> 00:25:19,860
encoded in base64 all this information

589
00:25:12,930 --> 00:25:24,180
is encrypted in in FC 4 and is included

590
00:25:19,860 --> 00:25:28,169
in random parameter that later will be

591
00:25:24,180 --> 00:25:30,720
used you can see here in green some

592
00:25:28,170 --> 00:25:37,170
information and parameter that are fake

593
00:25:30,720 --> 00:25:40,830
parameters to try to disguise the other

594
00:25:37,170 --> 00:25:43,280
parameters and the important things to

595
00:25:40,830 --> 00:25:46,590
exfiltrate information the first of all

596
00:25:43,280 --> 00:25:51,389
take the information and identifies

597
00:25:46,590 --> 00:25:53,550
every packet with this s where they say

598
00:25:51,390 --> 00:25:55,830
the solar that are affected and they

599
00:25:53,550 --> 00:25:59,490
kind of or the type of the information

600
00:25:55,830 --> 00:26:06,230
that he is filtrating with all this

601
00:25:59,490 --> 00:26:11,280
information the sample encrypt it and

602
00:26:06,230 --> 00:26:14,070
put it inside that parameter followed by

603
00:26:11,280 --> 00:26:16,260
another time they use it in base64

604
00:26:14,070 --> 00:26:20,159
and this parameter that it's important

605
00:26:16,260 --> 00:26:22,410
because that identifies the type of the

606
00:26:20,160 --> 00:26:24,860
information that it's filtrating all

607
00:26:22,410 --> 00:26:29,450
this information is another time

608
00:26:24,860 --> 00:26:31,409
encrypted in FC 4 and put it inside the

609
00:26:29,450 --> 00:26:39,780
previous parameter that we

610
00:26:31,410 --> 00:26:45,510
since then in oh this is the panel

611
00:26:39,780 --> 00:26:49,820
okay you can't see here a function that

612
00:26:45,510 --> 00:26:52,680
is collet and this device the type of

613
00:26:49,820 --> 00:26:54,990
that exfiltrated here

614
00:26:52,680 --> 00:26:57,720
you can see that the beard parameter

615
00:26:54,990 --> 00:27:02,220
when is nine he is calling a function

616
00:26:57,720 --> 00:27:05,300
that is collet not locked is that it's

617
00:27:02,220 --> 00:27:09,030
used to exfiltrate the keystrokes the

618
00:27:05,300 --> 00:27:12,149
recovery data the passwords and all this

619
00:27:09,030 --> 00:27:17,580
kind of information every packet that

620
00:27:12,150 --> 00:27:21,870
it's C to recollects to information like

621
00:27:17,580 --> 00:27:23,610
the IP idea of the boat another kind of

622
00:27:21,870 --> 00:27:27,030
information that it's important for the

623
00:27:23,610 --> 00:27:30,750
world and now we will talk about the

624
00:27:27,030 --> 00:27:34,889
definite actor and how they were

625
00:27:30,750 --> 00:27:37,740
evolving and in the last year's the main

626
00:27:34,890 --> 00:27:42,570
actor and the parameter of the four book

627
00:27:37,740 --> 00:27:43,980
is in decoded that starts his activity

628
00:27:42,570 --> 00:27:47,850
in hoc forums and it's an underground

629
00:27:43,980 --> 00:27:50,640
forum and it starts taking part in

630
00:27:47,850 --> 00:27:54,449
programming threats that are talking

631
00:27:50,640 --> 00:28:00,480
about assembly C and C++ and some pen

632
00:27:54,450 --> 00:28:03,980
testing and hacking threads initially he

633
00:28:00,480 --> 00:28:06,360
was selling some shell codes but in

634
00:28:03,980 --> 00:28:08,820
February of 2016

635
00:28:06,360 --> 00:28:10,830
he has started to sell for the first

636
00:28:08,820 --> 00:28:16,320
version the first version only was for

637
00:28:10,830 --> 00:28:19,070
grabbing malware and only works in

638
00:28:16,320 --> 00:28:26,580
Internet Explorer Firefox and Chrome

639
00:28:19,070 --> 00:28:29,040
later in May of 2016 the version 2 were

640
00:28:26,580 --> 00:28:31,050
released in this case he added the the

641
00:28:29,040 --> 00:28:33,840
one of the most important features that

642
00:28:31,050 --> 00:28:35,760
is the recovery of past versions of some

643
00:28:33,840 --> 00:28:37,790
so we're like all loot chrome and

644
00:28:35,760 --> 00:28:37,790
firefox

645
00:28:39,200 --> 00:28:47,399
well he created a new a new thread

646
00:28:43,980 --> 00:28:50,279
to sell the rest but when she started he

647
00:28:47,399 --> 00:28:54,649
started to sell their version 3 he dated

648
00:28:50,279 --> 00:28:58,409
this then we don't know how was the the

649
00:28:54,649 --> 00:29:04,010
how the logo looked yeah it an educated

650
00:28:58,409 --> 00:29:08,490
guess yeah within that is pretty similar

651
00:29:04,010 --> 00:29:12,230
then one of the things that is pretty

652
00:29:08,490 --> 00:29:16,080
cool in the in for book it's that in

653
00:29:12,230 --> 00:29:19,169
July of the 2016 he has started to sell

654
00:29:16,080 --> 00:29:23,490
for book as a service he have three kind

655
00:29:19,169 --> 00:29:26,309
of plans that you pay every week every

656
00:29:23,490 --> 00:29:30,620
month or every three months and he hosts

657
00:29:26,309 --> 00:29:34,649
your panel and will deliver you a binary

658
00:29:30,620 --> 00:29:42,590
you can buy a binary hosting your own

659
00:29:34,649 --> 00:29:46,768
Brown panel to well this is the same

660
00:29:42,590 --> 00:29:49,379
when you have the pro plan when there

661
00:29:46,769 --> 00:29:51,990
are updates you can send by a private

662
00:29:49,380 --> 00:29:54,000
message your account ID then he delivery

663
00:29:51,990 --> 00:30:01,679
you the binary updated with a new

664
00:29:54,000 --> 00:30:05,159
version in April of 2017 the version 3

665
00:30:01,679 --> 00:30:07,519
was released and there are a lot of

666
00:30:05,159 --> 00:30:10,139
dates that were important like the

667
00:30:07,519 --> 00:30:13,230
complete encryption of the communication

668
00:30:10,139 --> 00:30:15,990
they have the Kinect and more brochures

669
00:30:13,230 --> 00:30:18,419
and book fixes that were dated one of

670
00:30:15,990 --> 00:30:21,269
the important things here is this now

671
00:30:18,419 --> 00:30:25,169
one computer can be affected by two or

672
00:30:21,269 --> 00:30:28,019
more for books then two people that buy

673
00:30:25,169 --> 00:30:30,960
the different different for book with

674
00:30:28,019 --> 00:30:36,389
his own account can infect them the same

675
00:30:30,960 --> 00:30:39,750
computer well the prices will rotate it

676
00:30:36,389 --> 00:30:42,570
and then now were higher than the

677
00:30:39,750 --> 00:30:49,080
previous version but you continues

678
00:30:42,570 --> 00:30:53,760
having the same kind of packages well in

679
00:30:49,080 --> 00:30:56,100
October of 2017 and decoder stopped

680
00:30:53,760 --> 00:30:57,840
selling for book because they were use

681
00:30:56,100 --> 00:31:01,409
it to a makeup

682
00:30:57,840 --> 00:31:03,179
and they say that is not the way that he

683
00:31:01,410 --> 00:31:05,130
wants that full moon well you said yes

684
00:31:03,180 --> 00:31:06,990
suppose the form book is an educational

685
00:31:05,130 --> 00:31:11,900
tool and you have yes it you know

686
00:31:06,990 --> 00:31:11,900
principal your eat your wife and this

687
00:31:11,930 --> 00:31:19,530
okay after the CSS stop some some uses

688
00:31:16,380 --> 00:31:24,900
way less covet by Impostors of a decoder

689
00:31:19,530 --> 00:31:29,580
they were contacted via Skype and well

690
00:31:24,900 --> 00:31:31,860
this is move it yes sorry at some point

691
00:31:29,580 --> 00:31:34,110
we I think we misplaced this this is

692
00:31:31,860 --> 00:31:36,780
just like the software supported but for

693
00:31:34,110 --> 00:31:39,419
homework yeah they're in the top of the

694
00:31:36,780 --> 00:31:42,389
matches you can see this words that have

695
00:31:39,420 --> 00:31:44,220
super to the password recovery and there

696
00:31:42,390 --> 00:31:47,700
are a lot of so where that supports a

697
00:31:44,220 --> 00:31:50,700
keystroke its filtration the phone

698
00:31:47,700 --> 00:31:53,670
grabbing and sniffs at the people at the

699
00:31:50,700 --> 00:31:59,280
end what was a top was just broken roses

700
00:31:53,670 --> 00:32:09,120
an email client yeah okay and this is

701
00:31:59,280 --> 00:32:13,139
repeated okay and after this for books

702
00:32:09,120 --> 00:32:16,889
to be appeared in some markets where

703
00:32:13,140 --> 00:32:21,180
it's led to like this one that it's hot

704
00:32:16,890 --> 00:32:24,240
tools it's a software or malware malware

705
00:32:21,180 --> 00:32:27,660
market and there are other people that

706
00:32:24,240 --> 00:32:29,310
says that half the crack adverse enough

707
00:32:27,660 --> 00:32:31,320
for book and sell it you know their

708
00:32:29,310 --> 00:32:33,510
forums I get the feeling that the

709
00:32:31,320 --> 00:32:36,689
tendency of bad guys of using like dark

710
00:32:33,510 --> 00:32:37,980
themes is playing against us here not in

711
00:32:36,690 --> 00:32:43,320
this screenshot you're supposed to see

712
00:32:37,980 --> 00:32:47,820
the text saying I'm so cool

713
00:32:43,320 --> 00:32:50,689
and this is a guy well this is I write

714
00:32:47,820 --> 00:32:53,429
that up three mmm the accounts of

715
00:32:50,690 --> 00:32:58,980
subscription of for book I he wants to

716
00:32:53,430 --> 00:33:01,320
sell two of them and they he has the

717
00:32:58,980 --> 00:33:04,820
approval of the ng color that is the

718
00:33:01,320 --> 00:33:10,370
main straight actor team already in this

719
00:33:04,820 --> 00:33:10,370
okay so no back to me

720
00:33:11,200 --> 00:33:16,179
really underneath to have these tubs and

721
00:33:12,910 --> 00:33:17,590
be able to exchange you know to have

722
00:33:16,179 --> 00:33:20,080
Borja take over because I sometimes

723
00:33:17,590 --> 00:33:22,899
forget to breathe and at the end was I

724
00:33:20,080 --> 00:33:26,049
like oh I have to scoop speaking and it

725
00:33:22,900 --> 00:33:29,290
was really hard but you know well just

726
00:33:26,049 --> 00:33:30,850
the conclusion okay overall poor book it

727
00:33:29,290 --> 00:33:32,409
used to be coded by someone who has a

728
00:33:30,850 --> 00:33:34,830
bit of experience it's not a malware

729
00:33:32,410 --> 00:33:38,590
made by some script kiddie and that's

730
00:33:34,830 --> 00:33:40,919
important because by how he works by

731
00:33:38,590 --> 00:33:44,168
having a subscription model it allows

732
00:33:40,920 --> 00:33:46,960
lesser you know like less lesser cyber

733
00:33:44,169 --> 00:33:49,900
criminals to say so to use his more

734
00:33:46,960 --> 00:33:52,169
advanced malware which gives them tools

735
00:33:49,900 --> 00:33:55,059
that they haven't supposed to have and

736
00:33:52,169 --> 00:33:58,900
enables them to do more damage with the

737
00:33:55,059 --> 00:34:00,940
same technical knowledge as you have

738
00:33:58,900 --> 00:34:04,540
seen during the I hope during the

739
00:34:00,940 --> 00:34:07,419
assembly detail and well as you have not

740
00:34:04,540 --> 00:34:09,520
seen thanks the orc has screenshot the

741
00:34:07,419 --> 00:34:13,300
code is relatively clean the flow of

742
00:34:09,520 --> 00:34:15,190
execution it's kind of alright as well

743
00:34:13,300 --> 00:34:16,990
it has extensive support for many

744
00:34:15,190 --> 00:34:19,270
applications that means that the guy has

745
00:34:16,989 --> 00:34:21,520
actually went and just studied how they

746
00:34:19,270 --> 00:34:24,040
worked and what functions did they use

747
00:34:21,520 --> 00:34:27,100
and how to hook them in Windows 7 and

748
00:34:24,040 --> 00:34:30,279
Windows XP in Windows 10 so you know

749
00:34:27,100 --> 00:34:32,710
changes in versions that kind of stuff

750
00:34:30,280 --> 00:34:36,730
ETS was being using like even though the

751
00:34:32,710 --> 00:34:38,050
techniques key uses they are known they

752
00:34:36,730 --> 00:34:41,290
are not something new he hasn't invented

753
00:34:38,050 --> 00:34:43,419
something no but the thing is that most

754
00:34:41,290 --> 00:34:47,918
of them are very sneaky and you don't

755
00:34:43,418 --> 00:34:50,739
usually see them in common malware so on

756
00:34:47,918 --> 00:34:53,168
the other hand it does make use of very

757
00:34:50,739 --> 00:34:55,418
weak encryption mechanisms I remember

758
00:34:53,168 --> 00:34:57,400
having when I was working in pen testing

759
00:34:55,418 --> 00:34:59,230
and remember having a client telling me

760
00:34:57,400 --> 00:35:02,859
that lc4 is not encryption its encoding

761
00:34:59,230 --> 00:35:04,390
so you know well using lc4 for the

762
00:35:02,859 --> 00:35:07,569
communication and encrypting the buffers

763
00:35:04,390 --> 00:35:09,460
it's not like very heavily encrypted but

764
00:35:07,570 --> 00:35:11,050
I do believe this is the result the

765
00:35:09,460 --> 00:35:13,119
result of a trade off if you want to be

766
00:35:11,050 --> 00:35:15,820
sneaky you cannot use like heavyweight

767
00:35:13,119 --> 00:35:18,640
type API is like the encryption API s--

768
00:35:15,820 --> 00:35:20,350
so that might be the reason the other

769
00:35:18,640 --> 00:35:24,368
hand the choice for the communication

770
00:35:20,350 --> 00:35:24,790
key that is like a mistake for me using

771
00:35:24,369 --> 00:35:27,760
the

772
00:35:24,790 --> 00:35:29,980
of the domain and not being backed by

773
00:35:27,760 --> 00:35:31,840
default that I do think as well it's a

774
00:35:29,980 --> 00:35:35,830
mistake or something that he could

775
00:35:31,840 --> 00:35:38,470
improve so even though it has its flaws

776
00:35:35,830 --> 00:35:42,310
we do believe we will know that the

777
00:35:38,470 --> 00:35:44,379
model is being maintained still but even

778
00:35:42,310 --> 00:35:45,790
though sales have stopped if the market

779
00:35:44,380 --> 00:35:47,770
this thing is still being maintained

780
00:35:45,790 --> 00:35:49,570
that must mean that the guy has a

781
00:35:47,770 --> 00:35:52,030
generating enough revenue with a client

782
00:35:49,570 --> 00:35:53,650
it nuts right now okay so that makes him

783
00:35:52,030 --> 00:35:56,110
like a bit more dangerous because he

784
00:35:53,650 --> 00:35:58,180
cannot like focus on those clients and

785
00:35:56,110 --> 00:35:59,950
develop for them and we don't get the

786
00:35:58,180 --> 00:36:01,149
updates because when he was posting on

787
00:35:59,950 --> 00:36:03,520
the forum hey I have now implemented

788
00:36:01,150 --> 00:36:05,650
like a new system and you're hooking in

789
00:36:03,520 --> 00:36:06,970
giant okay so you just go to the part of

790
00:36:05,650 --> 00:36:08,860
the hooking and you see the changes that

791
00:36:06,970 --> 00:36:12,250
makes it more difficult for us to follow

792
00:36:08,860 --> 00:36:14,310
him and to track him and he keeps - he

793
00:36:12,250 --> 00:36:20,110
gets to keep doing his job which is like

794
00:36:14,310 --> 00:36:23,350
try to steal from people I hope you have

795
00:36:20,110 --> 00:36:25,690
liked seeing what we intended we first

796
00:36:23,350 --> 00:36:28,150
the showcase just one research we have

797
00:36:25,690 --> 00:36:29,590
gone global distribution how them our

798
00:36:28,150 --> 00:36:31,450
works we have seen the panel the

799
00:36:29,590 --> 00:36:34,120
communication encryption techniques it

800
00:36:31,450 --> 00:36:36,549
uses with all of this information for

801
00:36:34,120 --> 00:36:38,290
example the encryption key we can track

802
00:36:36,550 --> 00:36:39,730
the different campaigns we can track the

803
00:36:38,290 --> 00:36:41,920
different actors you can try to

804
00:36:39,730 --> 00:36:44,380
correlate them for example as you seen

805
00:36:41,920 --> 00:36:46,420
before the emails using the email and

806
00:36:44,380 --> 00:36:48,790
then the sample that that's document you

807
00:36:46,420 --> 00:36:51,430
can execute it in a sandbox get the RTF

808
00:36:48,790 --> 00:36:53,380
extract the payload from the payload

809
00:36:51,430 --> 00:36:55,000
extract the key or the C of the other

810
00:36:53,380 --> 00:36:56,590
one and control server and you can

811
00:36:55,000 --> 00:36:58,660
follow a specific group C who is

812
00:36:56,590 --> 00:37:00,370
targeting why are they targeting them

813
00:36:58,660 --> 00:37:02,920
what's the level of experience and

814
00:37:00,370 --> 00:37:07,870
that's what we basically try to show you

815
00:37:02,920 --> 00:37:10,480
how we do it I believe you will find

816
00:37:07,870 --> 00:37:12,759
most of the IOC s we used for this in

817
00:37:10,480 --> 00:37:15,280
relief community you can have even more

818
00:37:12,760 --> 00:37:16,900
OC s for form book if you want to do a

819
00:37:15,280 --> 00:37:19,150
bit of poking around

820
00:37:16,900 --> 00:37:22,690
we have quando control servers hashes I

821
00:37:19,150 --> 00:37:24,340
believe they're even some emails I just

822
00:37:22,690 --> 00:37:26,560
think I encourage you to come and get

823
00:37:24,340 --> 00:37:29,880
them if you want them and also if you

824
00:37:26,560 --> 00:37:33,380
want to share you're more than welcome

825
00:37:29,880 --> 00:37:44,309
so questions

826
00:37:33,380 --> 00:37:44,309
[Applause]

827
00:37:48,980 --> 00:37:53,610
I'm not seeing questions but I wanted to

828
00:37:52,020 --> 00:37:55,470
thank all of you because I think I've

829
00:37:53,610 --> 00:37:57,480
heard someone love of one of her jokes

830
00:37:55,470 --> 00:37:59,669
and that really motivates me to keep

831
00:37:57,480 --> 00:38:13,970
improving and making my presentations

832
00:37:59,670 --> 00:38:16,470
better so see that guy Thanks okay I

833
00:38:13,970 --> 00:38:20,399
great job guys thanks for the

834
00:38:16,470 --> 00:38:22,859
presentation I just wanted to know if do

835
00:38:20,400 --> 00:38:27,090
you have any estimation of how much

836
00:38:22,860 --> 00:38:30,000
money this this guy may have like Gordon

837
00:38:27,090 --> 00:38:32,550
from the software from the licenses we

838
00:38:30,000 --> 00:38:35,580
did try to make an estimation but it was

839
00:38:32,550 --> 00:38:39,420
running a bit wild about four more

840
00:38:35,580 --> 00:38:41,160
guesses would they think are very bad he

841
00:38:39,420 --> 00:38:43,530
was about making about a half a million

842
00:38:41,160 --> 00:38:45,149
as of now but that's like I think

843
00:38:43,530 --> 00:38:46,470
Twitter's everything because we were

844
00:38:45,150 --> 00:38:49,170
just trying to count the different

845
00:38:46,470 --> 00:38:51,419
domains we found which see if he's

846
00:38:49,170 --> 00:38:53,130
domain identify the client you can get

847
00:38:51,420 --> 00:38:55,440
the amount of the domain or the amount

848
00:38:53,130 --> 00:38:57,690
of time that path was active and from

849
00:38:55,440 --> 00:38:59,310
that you can try to assume in heat they

850
00:38:57,690 --> 00:39:01,110
are using because they're not dumb the

851
00:38:59,310 --> 00:39:04,860
cheapest subscription you can try to

852
00:39:01,110 --> 00:39:06,540
like guess but I mean probably some

853
00:39:04,860 --> 00:39:08,580
didn't PayPal rhizoma from the leaked

854
00:39:06,540 --> 00:39:10,890
version probably some are they don't

855
00:39:08,580 --> 00:39:12,299
know some they might be from the

856
00:39:10,890 --> 00:39:14,190
beginning maybe they haven't updated the

857
00:39:12,300 --> 00:39:23,190
subscription plans so half a million

858
00:39:14,190 --> 00:39:24,840
it's like a while yes but yeah that

859
00:39:23,190 --> 00:39:32,240
would be an option we haven't done it

860
00:39:24,840 --> 00:39:32,240
yet though okay

861
00:39:32,610 --> 00:39:34,670
you

862
00:39:34,720 --> 00:39:37,870
[Applause]

