1
00:00:03,280 --> 00:00:06,160
okay let me know when you can see it

2
00:00:06,160 --> 00:00:07,919
okay great um

3
00:00:07,919 --> 00:00:10,959
i'm gonna make the

4
00:00:11,040 --> 00:00:13,440
yeah great

5
00:00:13,440 --> 00:00:14,240
so

6
00:00:14,240 --> 00:00:17,119
good afternoon everyone um i first want

7
00:00:17,119 --> 00:00:18,960
to thank you all for being here uh both

8
00:00:18,960 --> 00:00:20,560
the ones watching it online and the ones

9
00:00:20,560 --> 00:00:22,960
that are watching it recorded after some

10
00:00:22,960 --> 00:00:23,840
months

11
00:00:23,840 --> 00:00:26,400
um so the name of this talk is atomistic

12
00:00:26,400 --> 00:00:27,680
internet of things foundation testing

13
00:00:27,680 --> 00:00:29,199
methodology

14
00:00:29,199 --> 00:00:31,599
it is an entry level talk so hopefully

15
00:00:31,599 --> 00:00:33,840
everyone will be able to to understand

16
00:00:33,840 --> 00:00:35,680
it and the and the approach that is

17
00:00:35,680 --> 00:00:36,880
suggested

18
00:00:36,880 --> 00:00:39,600
and it covers the thought process that i

19
00:00:39,600 --> 00:00:41,360
followed um

20
00:00:41,360 --> 00:00:42,800
when creating this iot and testing

21
00:00:42,800 --> 00:00:44,559
methodology that i've made for my

22
00:00:44,559 --> 00:00:46,079
current employer

23
00:00:46,079 --> 00:00:47,360
during this presentation i will try to

24
00:00:47,360 --> 00:00:49,360
answer the questions on why an iot

25
00:00:49,360 --> 00:00:51,680
penetration testimony is necessary is

26
00:00:51,680 --> 00:00:55,199
necessary and why surprisingly it is

27
00:00:55,199 --> 00:00:57,039
not as hard to apply as one would think

28
00:00:57,039 --> 00:00:59,760
both okay the word atomistic here is

29
00:00:59,760 --> 00:01:01,359
really important because one of the

30
00:01:01,359 --> 00:01:03,680
conclusions that will arrive at the end

31
00:01:03,680 --> 00:01:04,720
of this

32
00:01:04,720 --> 00:01:07,040
talk is that when doing an append test

33
00:01:07,040 --> 00:01:10,479
to an iot device it is better to

34
00:01:10,479 --> 00:01:12,960
to see it as a contest of many things uh

35
00:01:12,960 --> 00:01:15,439
hence atomistic instead of seeing it as

36
00:01:15,439 --> 00:01:18,000
a whole okay

37
00:01:18,000 --> 00:01:19,680
um before we begin with the content i'd

38
00:01:19,680 --> 00:01:21,920
like to introduce myself um i'm a

39
00:01:21,920 --> 00:01:23,759
telecommunications engineer and and

40
00:01:23,759 --> 00:01:25,759
holds several um fantastic and cloud

41
00:01:25,759 --> 00:01:27,600
security certifications

42
00:01:27,600 --> 00:01:30,159
my interests at the moment are in iot of

43
00:01:30,159 --> 00:01:32,960
course and web security also i'm i'm

44
00:01:32,960 --> 00:01:35,920
looking into into the ways to add um

45
00:01:35,920 --> 00:01:38,720
security into the the devops model and i

46
00:01:38,720 --> 00:01:40,400
also play ctf in my free time and i'm

47
00:01:40,400 --> 00:01:42,240
getting started in the in the bounty

48
00:01:42,240 --> 00:01:44,720
scene i was born in in georgia here in

49
00:01:44,720 --> 00:01:47,439
in catalonia in a in a city up north and

50
00:01:47,439 --> 00:01:49,759
i'm based in barcelona since i started

51
00:01:49,759 --> 00:01:51,840
my studies i love music in all its forms

52
00:01:51,840 --> 00:01:53,759
and singing with our channel and i also

53
00:01:53,759 --> 00:01:56,320
do krav maga which is the this self uh

54
00:01:56,320 --> 00:01:58,799
defense israeli system so

55
00:01:58,799 --> 00:02:00,880
really into the offensive and defensive

56
00:02:00,880 --> 00:02:01,759
stuff

57
00:02:01,759 --> 00:02:02,960
um

58
00:02:02,960 --> 00:02:06,719
so let's jump to talk why this talk okay

59
00:02:06,719 --> 00:02:09,280
um my current employer is a company from

60
00:02:09,280 --> 00:02:11,120
the beverage industry and it has

61
00:02:11,120 --> 00:02:12,560
factories across

62
00:02:12,560 --> 00:02:15,040
europe okay one of the things that we

63
00:02:15,040 --> 00:02:18,000
were worried about uh were all these um

64
00:02:18,000 --> 00:02:19,920
small iot devices that were being

65
00:02:19,920 --> 00:02:22,720
introduced into the factories

66
00:02:22,720 --> 00:02:23,840
from which

67
00:02:23,840 --> 00:02:26,239
security augmentation was rare and which

68
00:02:26,239 --> 00:02:29,200
we didn't know how to test okay

69
00:02:29,200 --> 00:02:31,599
these recent years we have seen

70
00:02:31,599 --> 00:02:33,920
several different type of breaches

71
00:02:33,920 --> 00:02:35,599
from heart implants as you can see in

72
00:02:35,599 --> 00:02:38,239
the screen to defibrillators to the well

73
00:02:38,239 --> 00:02:39,760
i think most of the cd professionals

74
00:02:39,760 --> 00:02:42,239
have seen the the funny car hacking

75
00:02:42,239 --> 00:02:44,239
videos that that have been released

76
00:02:44,239 --> 00:02:45,519
these last years

77
00:02:45,519 --> 00:02:48,480
um but there was one specific incident

78
00:02:48,480 --> 00:02:51,280
which got a lot of attention which was

79
00:02:51,280 --> 00:02:54,080
the barca data bridge in this um data

80
00:02:54,080 --> 00:02:56,959
breach what happened um

81
00:02:56,959 --> 00:02:59,280
is that the access to an administration

82
00:02:59,280 --> 00:03:01,599
interface uh was lost so credentials

83
00:03:01,599 --> 00:03:04,159
were reused and the hackers

84
00:03:04,159 --> 00:03:06,800
got access to more than 150

85
00:03:06,800 --> 00:03:08,959
000 uh

86
00:03:08,959 --> 00:03:11,760
like webcams um the image you can see in

87
00:03:11,760 --> 00:03:13,360
the in the left bottom of the of the

88
00:03:13,360 --> 00:03:15,760
screen it's the barcata camera in the

89
00:03:15,760 --> 00:03:17,200
madison county jail where you can see

90
00:03:17,200 --> 00:03:19,760
the inmates doing their daily things

91
00:03:19,760 --> 00:03:21,680
um so the question that was made from

92
00:03:21,680 --> 00:03:23,599
upper management and that is that is a

93
00:03:23,599 --> 00:03:26,640
recurrent thing so uh when there is the

94
00:03:26,640 --> 00:03:29,360
the supply chaining attack the case

95
00:03:29,360 --> 00:03:31,680
that was so famous so much ago they also

96
00:03:31,680 --> 00:03:33,440
asked like what can we do to stop this

97
00:03:33,440 --> 00:03:35,360
in this case they ask

98
00:03:35,360 --> 00:03:37,120
how can we protect these iot devices are

99
00:03:37,120 --> 00:03:39,920
being introduced um

100
00:03:39,920 --> 00:03:41,120
and we have to take into account that

101
00:03:41,120 --> 00:03:43,440
when talking about iot devices we're not

102
00:03:43,440 --> 00:03:45,280
only talking about information security

103
00:03:45,280 --> 00:03:46,640
so we're not only trying to protect

104
00:03:46,640 --> 00:03:49,680
information that we store in our systems

105
00:03:49,680 --> 00:03:52,640
um more and more we see um iot devices

106
00:03:52,640 --> 00:03:55,040
that are used um by people like i don't

107
00:03:55,040 --> 00:03:57,920
know um you know these automatic drones

108
00:03:57,920 --> 00:04:01,040
or or vehicles that have some some

109
00:04:01,040 --> 00:04:04,400
autonomy but um are still manipulated by

110
00:04:04,400 --> 00:04:06,640
by humans um

111
00:04:06,640 --> 00:04:08,080
in the event that these speakers are

112
00:04:08,080 --> 00:04:10,640
hacked as with uh with uh car hacking

113
00:04:10,640 --> 00:04:13,280
for example so that the consequences are

114
00:04:13,280 --> 00:04:16,399
really really huge okay

115
00:04:16,399 --> 00:04:18,478
and and the first question that we that

116
00:04:18,478 --> 00:04:20,560
we had is is there a wallproof solution

117
00:04:20,560 --> 00:04:22,720
so is there something we can do that

118
00:04:22,720 --> 00:04:24,479
will make iot devices secure so

119
00:04:24,479 --> 00:04:27,040
definitely not uh but there are things

120
00:04:27,040 --> 00:04:29,199
that can be done okay and before

121
00:04:29,199 --> 00:04:30,960
starting with the within test mythology

122
00:04:30,960 --> 00:04:33,120
per se i wanted to explain uh some of

123
00:04:33,120 --> 00:04:34,800
the things that we are doing and that i

124
00:04:34,800 --> 00:04:36,639
think that companies should consider uh

125
00:04:36,639 --> 00:04:38,880
the first one that is usually done using

126
00:04:38,880 --> 00:04:40,800
under the gdpr is the third party

127
00:04:40,800 --> 00:04:42,560
security assessments where we check the

128
00:04:42,560 --> 00:04:44,400
controls that the suppliers have

129
00:04:44,400 --> 00:04:45,600
and

130
00:04:45,600 --> 00:04:46,560
um

131
00:04:46,560 --> 00:04:49,040
if you are a company uh

132
00:04:49,040 --> 00:04:51,440
who who develops or who has other

133
00:04:51,440 --> 00:04:53,199
companies that develop iot devices for

134
00:04:53,199 --> 00:04:55,360
for for them and then it's also worth it

135
00:04:55,360 --> 00:04:57,040
to have an iot security standard and

136
00:04:57,040 --> 00:05:00,400
enforce it moreover the the biggest um

137
00:05:00,400 --> 00:05:03,759
cloud competitors these are aws azure

138
00:05:03,759 --> 00:05:06,160
and and google cloud platform have

139
00:05:06,160 --> 00:05:08,960
lately also released um specific iot

140
00:05:08,960 --> 00:05:10,960
management solutions essentially was

141
00:05:10,960 --> 00:05:12,960
this what these solutions do is they

142
00:05:12,960 --> 00:05:15,759
allow you to onboard fan of board iot

143
00:05:15,759 --> 00:05:18,639
devices um which gives you visibility on

144
00:05:18,639 --> 00:05:19,919
on on them

145
00:05:19,919 --> 00:05:21,680
you can see them

146
00:05:21,680 --> 00:05:23,280
yes if they have for example they also

147
00:05:23,280 --> 00:05:25,520
do like kind of an ids ids function so

148
00:05:25,520 --> 00:05:27,360
you can see if the device has open

149
00:05:27,360 --> 00:05:28,479
boards if the device has no

150
00:05:28,479 --> 00:05:30,560
vulnerability and also if it detects

151
00:05:30,560 --> 00:05:33,039
that one day one for example iot device

152
00:05:33,039 --> 00:05:34,320
starts communicating with a command and

153
00:05:34,320 --> 00:05:36,479
control they can alert

154
00:05:36,479 --> 00:05:38,880
you of that of that incident and you can

155
00:05:38,880 --> 00:05:41,039
respond appropriately

156
00:05:41,039 --> 00:05:43,280
the last item that can be done is

157
00:05:43,280 --> 00:05:45,199
spendtest iot devices for low hanging

158
00:05:45,199 --> 00:05:47,680
fruits and the low hanging fruits part

159
00:05:47,680 --> 00:05:50,160
here is is really relevant because we're

160
00:05:50,160 --> 00:05:52,320
not trying to use i know that is a

161
00:05:52,320 --> 00:05:54,560
technique and it's a totally valid

162
00:05:54,560 --> 00:05:56,000
technique for researchers who try to

163
00:05:56,000 --> 00:05:58,240
find very specific vulnerabilities in

164
00:05:58,240 --> 00:05:59,520
commercialized devices but we're not

165
00:05:59,520 --> 00:06:01,680
trying to use lasers to modify the state

166
00:06:01,680 --> 00:06:04,560
of the chip and do things which are

167
00:06:04,560 --> 00:06:07,520
i think very hard for us for the

168
00:06:07,520 --> 00:06:10,000
majority of us to understand in a 45

169
00:06:10,000 --> 00:06:12,560
minute talks we're talking about

170
00:06:12,560 --> 00:06:14,560
mitigating the risk that the oasp

171
00:06:14,560 --> 00:06:16,800
internet of things top 10 has classified

172
00:06:16,800 --> 00:06:19,759
as the ones to avoid at all cost and

173
00:06:19,759 --> 00:06:23,600
which are these these iot risks okay and

174
00:06:23,600 --> 00:06:26,800
we have the divas.10 here for those that

175
00:06:26,800 --> 00:06:30,080
uh didn't know um owasp has a top 10

176
00:06:30,080 --> 00:06:33,840
only for iot vulnerabilities and this

177
00:06:33,840 --> 00:06:36,479
top 10 is intended for

178
00:06:36,479 --> 00:06:38,479
both researchers enterprises and

179
00:06:38,479 --> 00:06:41,039
security professionals and is labeled as

180
00:06:41,039 --> 00:06:43,280
the vulnerabilities to avoid at all

181
00:06:43,280 --> 00:06:44,560
costs

182
00:06:44,560 --> 00:06:46,080
one could think that these

183
00:06:46,080 --> 00:06:49,120
vulnerabilities are really specific and

184
00:06:49,120 --> 00:06:50,800
really hard to exploit but if you start

185
00:06:50,800 --> 00:06:52,720
reviewing the list and we're going to do

186
00:06:52,720 --> 00:06:54,560
it uh really fast but i think it's

187
00:06:54,560 --> 00:06:56,800
important to have this uh information

188
00:06:56,800 --> 00:06:58,960
for the for the rest of the talk um we

189
00:06:58,960 --> 00:07:00,639
see that the first one is weak guessable

190
00:07:00,639 --> 00:07:03,360
or hardcoded passwords so

191
00:07:03,360 --> 00:07:05,840
yes a web page where you can log in with

192
00:07:05,840 --> 00:07:07,680
that mean and and one two three four

193
00:07:07,680 --> 00:07:09,840
that was the the usual thing in routers

194
00:07:09,840 --> 00:07:13,199
uh up until not so long ago but nowadays

195
00:07:13,199 --> 00:07:16,080
we are seeing this uh this mirai botnets

196
00:07:16,080 --> 00:07:18,319
which what they do is they hack iot

197
00:07:18,319 --> 00:07:19,680
devices using the four credentials that

198
00:07:19,680 --> 00:07:21,280
they did this huge botnet that can

199
00:07:21,280 --> 00:07:24,800
attack uh web pages across the world

200
00:07:24,800 --> 00:07:26,080
also we have number two in secure

201
00:07:26,080 --> 00:07:28,240
network services so again

202
00:07:28,240 --> 00:07:29,840
and this is related with

203
00:07:29,840 --> 00:07:32,560
the lack of secure update mechanisms so

204
00:07:32,560 --> 00:07:33,919
usually you have insecure network

205
00:07:33,919 --> 00:07:36,000
services because the iot devices are not

206
00:07:36,000 --> 00:07:37,759
properly maintained

207
00:07:37,759 --> 00:07:41,120
and what this means is having an ssh

208
00:07:41,120 --> 00:07:44,319
service that is outdated an ftp server

209
00:07:44,319 --> 00:07:45,919
that can be accessed from from the

210
00:07:45,919 --> 00:07:47,199
outside

211
00:07:47,199 --> 00:07:48,639
number three is in secure ecosystem

212
00:07:48,639 --> 00:07:51,360
interfaces that means web pages apis

213
00:07:51,360 --> 00:07:53,840
cloud or mobile applications which are

214
00:07:53,840 --> 00:07:55,759
poorly made and introducing

215
00:07:55,759 --> 00:07:58,960
vulnerabilities to the iot ecosystem

216
00:07:58,960 --> 00:08:00,240
then you have the lack of security

217
00:08:00,240 --> 00:08:01,680
mechanism because one of the things that

218
00:08:01,680 --> 00:08:03,520
is really problematic with iot devices

219
00:08:03,520 --> 00:08:04,639
that you can

220
00:08:04,639 --> 00:08:06,639
plug a usb

221
00:08:06,639 --> 00:08:09,199
flash a new version of the of the of the

222
00:08:09,199 --> 00:08:11,199
firmware that the iot is using and if

223
00:08:11,199 --> 00:08:13,840
the iot doesn't have measures to control

224
00:08:13,840 --> 00:08:15,599
that well signature verification

225
00:08:15,599 --> 00:08:18,160
measures to make sure that the that the

226
00:08:18,160 --> 00:08:19,759
firmware that you're trying to flash is

227
00:08:19,759 --> 00:08:21,759
actually intended for that device

228
00:08:21,759 --> 00:08:23,199
uh

229
00:08:23,199 --> 00:08:24,319
then you're going to be able to i don't

230
00:08:24,319 --> 00:08:26,080
know have a shell on the device have an

231
00:08:26,080 --> 00:08:27,360
endpoint that's always listening for

232
00:08:27,360 --> 00:08:29,199
your commands whatever you want

233
00:08:29,199 --> 00:08:31,280
and well and the rest it's it's a

234
00:08:31,280 --> 00:08:33,279
similar idea okay but uh in secure

235
00:08:33,279 --> 00:08:34,799
voltaic components of course if you

236
00:08:34,799 --> 00:08:37,200
can't update the device in a proper

237
00:08:37,200 --> 00:08:38,880
manner you you will usually have a

238
00:08:38,880 --> 00:08:40,479
insecure and updated components

239
00:08:40,479 --> 00:08:42,000
insufficient privacy protection is

240
00:08:42,000 --> 00:08:43,760
related also with number nine which is

241
00:08:43,760 --> 00:08:45,200
in secure default settings so we see a

242
00:08:45,200 --> 00:08:46,560
lot of things which are not

243
00:08:46,560 --> 00:08:49,040
vulnerabilities per se but design faults

244
00:08:49,040 --> 00:08:50,880
that are there because no one has

245
00:08:50,880 --> 00:08:52,399
actually made the risk assessment of the

246
00:08:52,399 --> 00:08:54,880
iot device um

247
00:08:54,880 --> 00:08:57,200
and well then the the lack of encryption

248
00:08:57,200 --> 00:08:59,360
number seven uh lack of device

249
00:08:59,360 --> 00:09:01,040
management and lack of physical

250
00:09:01,040 --> 00:09:03,040
hardening okay these are the

251
00:09:03,040 --> 00:09:05,680
the ten uh vulnerabilities to avoid at

252
00:09:05,680 --> 00:09:08,320
all cost

253
00:09:08,320 --> 00:09:10,959
but before we start uh talking about how

254
00:09:10,959 --> 00:09:12,640
to address all these vulnerabilities

255
00:09:12,640 --> 00:09:14,640
with uh with uh pentest methodology i

256
00:09:14,640 --> 00:09:16,000
wanted to to

257
00:09:16,000 --> 00:09:18,959
like waste two minutes to also um show

258
00:09:18,959 --> 00:09:21,040
some of the documents which are

259
00:09:21,040 --> 00:09:23,440
really relevant and and for companies

260
00:09:23,440 --> 00:09:24,880
that are starting to look into iot

261
00:09:24,880 --> 00:09:25,920
security

262
00:09:25,920 --> 00:09:27,519
they can be interesting

263
00:09:27,519 --> 00:09:29,279
and isa has a

264
00:09:29,279 --> 00:09:31,360
super interesting documentation they

265
00:09:31,360 --> 00:09:32,560
have

266
00:09:32,560 --> 00:09:34,080
six pieces of information which start

267
00:09:34,080 --> 00:09:35,839
with a baseline security for iot and

268
00:09:35,839 --> 00:09:37,600
they have the smart cars hospitals

269
00:09:37,600 --> 00:09:40,240
airport cities and industry 4.0

270
00:09:40,240 --> 00:09:43,200
so what they do and here for example

271
00:09:43,200 --> 00:09:44,480
i have the

272
00:09:44,480 --> 00:09:46,160
the part of the

273
00:09:46,160 --> 00:09:47,760
of the

274
00:09:47,760 --> 00:09:50,080
smart cars is they do a document that

275
00:09:50,080 --> 00:09:52,000
first has an overview of the sector

276
00:09:52,000 --> 00:09:54,240
then the the assets that apply to this

277
00:09:54,240 --> 00:09:56,160
sector then they do a threat and risk

278
00:09:56,160 --> 00:09:58,480
analysis so where are the weak points of

279
00:09:58,480 --> 00:10:00,480
this specific sector and they analyze

280
00:10:00,480 --> 00:10:02,160
attacks as they have happened in the in

281
00:10:02,160 --> 00:10:03,600
the recent years

282
00:10:03,600 --> 00:10:05,200
lastly they suggest security good

283
00:10:05,200 --> 00:10:07,200
practices and recommendations to avoid

284
00:10:07,200 --> 00:10:10,160
these types of attack

285
00:10:10,160 --> 00:10:11,760
the last document that i wanted to show

286
00:10:11,760 --> 00:10:13,440
is the iot security verification

287
00:10:13,440 --> 00:10:15,519
standard for those of you who come from

288
00:10:15,519 --> 00:10:17,760
an application security background you

289
00:10:17,760 --> 00:10:19,680
are probably um

290
00:10:19,680 --> 00:10:20,959
so you probably know the application

291
00:10:20,959 --> 00:10:23,279
security verification standard

292
00:10:23,279 --> 00:10:26,000
from mo wasp which essentially um

293
00:10:26,000 --> 00:10:27,920
classifies web pages in three different

294
00:10:27,920 --> 00:10:30,880
levels and then suggests um

295
00:10:30,880 --> 00:10:34,000
so requirements to make them secure um

296
00:10:34,000 --> 00:10:37,279
this isbs document follows the same

297
00:10:37,279 --> 00:10:39,120
approach uh what it does is it

298
00:10:39,120 --> 00:10:41,920
classifies iot um systems in three

299
00:10:41,920 --> 00:10:43,279
levels depending on the type of data

300
00:10:43,279 --> 00:10:44,959
they are treating or the place in the

301
00:10:44,959 --> 00:10:46,399
factory

302
00:10:46,399 --> 00:10:49,040
that they are that they are working

303
00:10:49,040 --> 00:10:52,000
and then divide the iot per se in five

304
00:10:52,000 --> 00:10:54,720
different sections this is similar to

305
00:10:54,720 --> 00:10:56,320
the to the

306
00:10:56,320 --> 00:10:58,160
to the division to the atomistic part

307
00:10:58,160 --> 00:10:59,360
that we're going to do for this contest

308
00:10:59,360 --> 00:11:00,399
methodology

309
00:11:00,399 --> 00:11:02,160
and essentially you can see that these

310
00:11:02,160 --> 00:11:04,640
um five sections are the iot ecosystem

311
00:11:04,640 --> 00:11:08,399
essentially web pages apis and cloud uh

312
00:11:08,399 --> 00:11:10,560
platforms then you have the user space

313
00:11:10,560 --> 00:11:12,240
where you well you'll see the the

314
00:11:12,240 --> 00:11:14,240
credentials and you encrypt the data and

315
00:11:14,240 --> 00:11:15,839
then you have the communication part

316
00:11:15,839 --> 00:11:17,440
which essentially will be the wireless

317
00:11:17,440 --> 00:11:19,120
communications and the hardware platform

318
00:11:19,120 --> 00:11:20,560
which means the chips that you have

319
00:11:20,560 --> 00:11:21,760
physically

320
00:11:21,760 --> 00:11:22,720
in that platform

321
00:11:22,720 --> 00:11:25,440
[Music]

322
00:11:25,440 --> 00:11:26,240
um

323
00:11:26,240 --> 00:11:27,920
so with iot devices being idle

324
00:11:27,920 --> 00:11:29,680
infrastructure there was the need to

325
00:11:29,680 --> 00:11:31,760
first understand which was the attack

326
00:11:31,760 --> 00:11:34,480
surface of an iot device and then

327
00:11:34,480 --> 00:11:36,079
developed the pentesh methodology that

328
00:11:36,079 --> 00:11:37,360
would help us

329
00:11:37,360 --> 00:11:40,000
actually protect these these iot devices

330
00:11:40,000 --> 00:11:42,720
by finding low-hanging vulnerabilities

331
00:11:42,720 --> 00:11:46,079
okay so i did what everyone would do i

332
00:11:46,079 --> 00:11:47,600
went to google and started searching

333
00:11:47,600 --> 00:11:49,920
which were the the files the articles

334
00:11:49,920 --> 00:11:51,360
that were more relevant and that

335
00:11:51,360 --> 00:11:54,000
provided more information on on this

336
00:11:54,000 --> 00:11:55,519
topic

337
00:11:55,519 --> 00:11:56,800
um

338
00:11:56,800 --> 00:11:59,360
there was one mind map which was really

339
00:11:59,360 --> 00:12:00,839
interesting by

340
00:12:00,839 --> 00:12:03,920
chirag here and essentially he devised

341
00:12:03,920 --> 00:12:06,160
the attack surface of an iot in three

342
00:12:06,160 --> 00:12:08,320
different parts hardware software and

343
00:12:08,320 --> 00:12:09,279
network

344
00:12:09,279 --> 00:12:11,120
what is interesting about this my map is

345
00:12:11,120 --> 00:12:13,839
that you can see which are some of the

346
00:12:13,839 --> 00:12:16,560
most used tools when attacking these iot

347
00:12:16,560 --> 00:12:18,240
devices for example when you have a

348
00:12:18,240 --> 00:12:20,079
hardware um

349
00:12:20,079 --> 00:12:21,360
part of an id device that you want to

350
00:12:21,360 --> 00:12:22,880
contest you can do bleaching attacks

351
00:12:22,880 --> 00:12:24,959
high channel attacks um but you can also

352
00:12:24,959 --> 00:12:27,200
try to to connect directly to the to the

353
00:12:27,200 --> 00:12:30,880
exposed debugging interfaces like urtsbi

354
00:12:30,880 --> 00:12:32,959
i2c and jtag

355
00:12:32,959 --> 00:12:34,480
the same happens with software so you

356
00:12:34,480 --> 00:12:36,240
have mobile applications web

357
00:12:36,240 --> 00:12:38,639
applications okay so this this idea that

358
00:12:38,639 --> 00:12:40,240
keeps repeating and then you have the

359
00:12:40,240 --> 00:12:42,320
network part with the different

360
00:12:42,320 --> 00:12:44,480
wireless protocols but also the wired

361
00:12:44,480 --> 00:12:45,600
ones

362
00:12:45,600 --> 00:12:47,040
the approach that that should have

363
00:12:47,040 --> 00:12:48,639
followed to do is

364
00:12:48,639 --> 00:12:50,800
my map is very similar to the one that i

365
00:12:50,800 --> 00:12:53,120
later followed with the difference that

366
00:12:53,120 --> 00:12:56,079
when thinking it and and saying okay how

367
00:12:56,079 --> 00:12:58,320
do i explain this in an easy to

368
00:12:58,320 --> 00:13:00,399
understand a way because of course we

369
00:13:00,399 --> 00:13:02,800
have to to speak with people across the

370
00:13:02,800 --> 00:13:05,360
company to ask them to do uh iot pen

371
00:13:05,360 --> 00:13:07,120
test how do i explain the different

372
00:13:07,120 --> 00:13:08,880
parts that we're going to test

373
00:13:08,880 --> 00:13:09,210
and

374
00:13:09,210 --> 00:13:10,880
[Music]

375
00:13:10,880 --> 00:13:12,800
that led me to the to the following

376
00:13:12,800 --> 00:13:14,480
question and the question is what is

377
00:13:14,480 --> 00:13:17,279
actually iot cyber security and this is

378
00:13:17,279 --> 00:13:19,680
a a very broad question but if you think

379
00:13:19,680 --> 00:13:21,920
about it so an iot can have the cloud it

380
00:13:21,920 --> 00:13:24,800
can have the web and api it can have

381
00:13:24,800 --> 00:13:26,800
a mobile application in which you can

382
00:13:26,800 --> 00:13:29,440
configure several aspects of the iot but

383
00:13:29,440 --> 00:13:31,120
then sometimes you also have like i

384
00:13:31,120 --> 00:13:33,440
don't know a distribution of iot devices

385
00:13:33,440 --> 00:13:35,519
as happens with the philips hue

386
00:13:35,519 --> 00:13:36,959
light bulbs and then you have a

387
00:13:36,959 --> 00:13:39,519
centralizer which controls how the light

388
00:13:39,519 --> 00:13:41,120
bulbs work so

389
00:13:41,120 --> 00:13:44,399
the architectures in an iot system are

390
00:13:44,399 --> 00:13:48,160
really really huge and a big part when

391
00:13:48,160 --> 00:13:50,160
testing them is to understand how they

392
00:13:50,160 --> 00:13:52,160
are made and what do you actually need

393
00:13:52,160 --> 00:13:53,680
to test okay

394
00:13:53,680 --> 00:13:55,760
which leads us

395
00:13:55,760 --> 00:13:58,480
to the five iot and testing categories

396
00:13:58,480 --> 00:13:59,279
okay

397
00:13:59,279 --> 00:14:01,600
the way uh the methodology in the way

398
00:14:01,600 --> 00:14:03,839
that i have divided an iot pen test is

399
00:14:03,839 --> 00:14:06,079
in these five categories so essentially

400
00:14:06,079 --> 00:14:07,839
have the hardware which would be the

401
00:14:07,839 --> 00:14:09,519
physical security of the controller but

402
00:14:09,519 --> 00:14:10,480
also

403
00:14:10,480 --> 00:14:13,279
have they left um the booking interfaces

404
00:14:13,279 --> 00:14:16,000
um in the in the that can be accessed by

405
00:14:16,000 --> 00:14:18,079
an attacker uh do they have it's like

406
00:14:18,079 --> 00:14:19,680
some iot devices have all the

407
00:14:19,680 --> 00:14:22,399
information stored in a in a micro sd

408
00:14:22,399 --> 00:14:24,880
card so is the firmware there can i

409
00:14:24,880 --> 00:14:27,040
extract the the firmware and then do

410
00:14:27,040 --> 00:14:28,880
what i want with it then we have of

411
00:14:28,880 --> 00:14:31,279
course the weapon api um

412
00:14:31,279 --> 00:14:32,720
um category the mobile application

413
00:14:32,720 --> 00:14:34,560
within the radio communication ones

414
00:14:34,560 --> 00:14:36,079
hardware and firmware you will always

415
00:14:36,079 --> 00:14:38,399
have but the other thresh

416
00:14:38,399 --> 00:14:40,959
the other three sorry are optional and

417
00:14:40,959 --> 00:14:43,120
and will depend on the architecture that

418
00:14:43,120 --> 00:14:45,440
you that you find

419
00:14:45,440 --> 00:14:46,399
um

420
00:14:46,399 --> 00:14:47,120
the

421
00:14:47,120 --> 00:14:49,440
the the key here and and the concept

422
00:14:49,440 --> 00:14:52,000
that must um i think the goal is to

423
00:14:52,000 --> 00:14:55,680
encourage uh people to to lose um

424
00:14:55,680 --> 00:14:57,440
like the fear of pentesting devices

425
00:14:57,440 --> 00:14:59,519
because they are too complex is to split

426
00:14:59,519 --> 00:15:01,440
the architecture in something that that

427
00:15:01,440 --> 00:15:03,600
they can understand because weapon api

428
00:15:03,600 --> 00:15:05,360
there's a lot of documentation on how to

429
00:15:05,360 --> 00:15:07,600
contest mobile applications is the same

430
00:15:07,600 --> 00:15:09,600
firmware there's also some documentation

431
00:15:09,600 --> 00:15:12,639
and apply this atomistic categories to

432
00:15:12,639 --> 00:15:15,760
an iot pen test as a whole

433
00:15:15,760 --> 00:15:16,639
um

434
00:15:16,639 --> 00:15:18,240
what i did during the research that

435
00:15:18,240 --> 00:15:19,120
ended up

436
00:15:19,120 --> 00:15:21,440
developing the methodology and let me

437
00:15:21,440 --> 00:15:24,079
like do a small um

438
00:15:24,079 --> 00:15:26,959
yeah update hear the methodology

439
00:15:26,959 --> 00:15:29,440
is going to be public um it is not

440
00:15:29,440 --> 00:15:31,920
public at the moment i want to do it but

441
00:15:31,920 --> 00:15:34,000
um i'm waiting for the moment to update

442
00:15:34,000 --> 00:15:36,160
it with the with the

443
00:15:36,160 --> 00:15:38,000
well the last information that we get

444
00:15:38,000 --> 00:15:39,759
from from doing different contests in

445
00:15:39,759 --> 00:15:40,399
the

446
00:15:40,399 --> 00:15:42,399
in the company where i'm working from um

447
00:15:42,399 --> 00:15:44,240
but yeah at some point it will be public

448
00:15:44,240 --> 00:15:46,240
if anyone has a doubt about it you can

449
00:15:46,240 --> 00:15:47,920
drop me an email or or whatever i'll be

450
00:15:47,920 --> 00:15:50,320
happy to answer um how it's going to how

451
00:15:50,320 --> 00:15:52,000
it's going to work um

452
00:15:52,000 --> 00:15:53,519
during the following slides we're going

453
00:15:53,519 --> 00:15:55,440
to see the state of the art of each of

454
00:15:55,440 --> 00:15:56,959
these categories and then we're going to

455
00:15:56,959 --> 00:15:59,040
see which work was done to understand

456
00:15:59,040 --> 00:16:01,120
actually how to test them and and the

457
00:16:01,120 --> 00:16:03,360
mapping of the test that a band tester

458
00:16:03,360 --> 00:16:05,920
can do for each category

459
00:16:05,920 --> 00:16:08,240
so the state of the art of hardware band

460
00:16:08,240 --> 00:16:10,160
testing was pretty limited if you go and

461
00:16:10,160 --> 00:16:11,440
search online

462
00:16:11,440 --> 00:16:13,120
for hardware security hardware and

463
00:16:13,120 --> 00:16:15,519
testing hardware offensive security um

464
00:16:15,519 --> 00:16:16,800
you'll see that the options are really

465
00:16:16,800 --> 00:16:18,800
very limited um

466
00:16:18,800 --> 00:16:20,720
there is one page which is called iot

467
00:16:20,720 --> 00:16:23,440
and testing guide which has

468
00:16:23,440 --> 00:16:25,680
a lot of interesting information

469
00:16:25,680 --> 00:16:28,560
but but limited but they had key

470
00:16:28,560 --> 00:16:31,839
concepts as the fccid identification

471
00:16:31,839 --> 00:16:34,320
that allows you to get an understanding

472
00:16:34,320 --> 00:16:36,399
on how the iot devices are made

473
00:16:36,399 --> 00:16:38,320
and there was also also articles from

474
00:16:38,320 --> 00:16:40,639
fireeye um that essentially explained

475
00:16:40,639 --> 00:16:42,720
that the first part when trying to break

476
00:16:42,720 --> 00:16:44,800
a hardware is to research the device

477
00:16:44,800 --> 00:16:46,480
identify the components know how it

478
00:16:46,480 --> 00:16:48,880
works uh which parts does it have and

479
00:16:48,880 --> 00:16:50,639
then try to dump the flash and from

480
00:16:50,639 --> 00:16:53,920
there extract analyze the firmware

481
00:16:53,920 --> 00:16:56,000
um so what i did in this in this

482
00:16:56,000 --> 00:16:59,040
category was first try the fccid

483
00:16:59,040 --> 00:17:01,759
identification that i that i told you so

484
00:17:01,759 --> 00:17:04,480
the fcc id it's the federal

485
00:17:04,480 --> 00:17:06,559
communications commission from the

486
00:17:06,559 --> 00:17:08,640
united states essentially it gives an

487
00:17:08,640 --> 00:17:12,160
identification number to each

488
00:17:12,160 --> 00:17:14,319
device that has to be sold to the to the

489
00:17:14,319 --> 00:17:17,039
public and then they leave or they put

490
00:17:17,039 --> 00:17:18,480
some of the information of the test that

491
00:17:18,480 --> 00:17:20,319
they do to guarantee that the device

492
00:17:20,319 --> 00:17:22,480
works in the intended frequency and that

493
00:17:22,480 --> 00:17:25,280
it has like acceptable uh values as

494
00:17:25,280 --> 00:17:26,799
according to the law and all those

495
00:17:26,799 --> 00:17:28,960
documents are uploaded online

496
00:17:28,960 --> 00:17:31,280
and but also i try to to find user

497
00:17:31,280 --> 00:17:32,960
manuals datasheets change logs and for

498
00:17:32,960 --> 00:17:34,320
example here you can see the example of

499
00:17:34,320 --> 00:17:36,240
an amazon echo

500
00:17:36,240 --> 00:17:38,480
i took the fcc id as you can see as you

501
00:17:38,480 --> 00:17:40,000
can see here

502
00:17:40,000 --> 00:17:40,799
and

503
00:17:40,799 --> 00:17:43,200
and then by searching for

504
00:17:43,200 --> 00:17:45,520
fixing guides you can see exactly which

505
00:17:45,520 --> 00:17:47,120
components it is using so imagine you

506
00:17:47,120 --> 00:17:49,039
want to dump the flash memory of the

507
00:17:49,039 --> 00:17:50,960
amazon echo then you know exactly what

508
00:17:50,960 --> 00:17:53,039
it is sitting you can then

509
00:17:53,039 --> 00:17:54,080
spin up

510
00:17:54,080 --> 00:17:56,400
the documentation of this specific chip

511
00:17:56,400 --> 00:17:57,360
and see

512
00:17:57,360 --> 00:17:58,880
where is the information stored it's not

513
00:17:58,880 --> 00:18:01,840
a simple process okay so soldering is

514
00:18:01,840 --> 00:18:03,679
it's another difficult part when you

515
00:18:03,679 --> 00:18:04,960
want to receive this information but at

516
00:18:04,960 --> 00:18:08,320
least you know where to start okay

517
00:18:08,320 --> 00:18:11,360
and what you can see in the fccid page

518
00:18:11,360 --> 00:18:13,520
sorry is the

519
00:18:13,520 --> 00:18:15,919
essentially the disassembly and the

520
00:18:15,919 --> 00:18:18,559
model and the frequencies and the

521
00:18:18,559 --> 00:18:20,720
protocols that the device accepts so for

522
00:18:20,720 --> 00:18:22,640
example if you go to this webpage which

523
00:18:22,640 --> 00:18:24,559
is publicly available you're going to

524
00:18:24,559 --> 00:18:27,200
see an amazon echo uh teared up into

525
00:18:27,200 --> 00:18:29,280
pieces to understand how it actually

526
00:18:29,280 --> 00:18:31,600
works

527
00:18:31,919 --> 00:18:34,640
and we jump to the firmware um

528
00:18:34,640 --> 00:18:35,919
and and and

529
00:18:35,919 --> 00:18:37,280
and the state of the art of the film

530
00:18:37,280 --> 00:18:39,760
work and here we have so in throughout

531
00:18:39,760 --> 00:18:41,440
the presentation we're going to see the

532
00:18:41,440 --> 00:18:43,840
different uh tools that the wasp offers

533
00:18:43,840 --> 00:18:45,440
so here we have the finger security

534
00:18:45,440 --> 00:18:47,919
testing methodology which explains in

535
00:18:47,919 --> 00:18:49,840
detail how to

536
00:18:49,840 --> 00:18:51,120
first understand how the femur is

537
00:18:51,120 --> 00:18:52,640
working how to extract it and then how

538
00:18:52,640 --> 00:18:55,440
to analyze it and also there were some

539
00:18:55,440 --> 00:18:57,919
articles explaining why didn't walk and

540
00:18:57,919 --> 00:18:59,840
maybe if there are some of you who play

541
00:18:59,840 --> 00:19:02,320
ctf's now and then you're going to know

542
00:19:02,320 --> 00:19:04,799
what being what is used for so it's a

543
00:19:04,799 --> 00:19:06,559
it's a tool that essentially passes a

544
00:19:06,559 --> 00:19:08,720
file and keeps identifying the magic

545
00:19:08,720 --> 00:19:11,039
numbers and then once he knows that the

546
00:19:11,039 --> 00:19:12,000
file

547
00:19:12,000 --> 00:19:14,480
has i don't know 10 uh smaller files

548
00:19:14,480 --> 00:19:17,280
inside it extracts them in a folder for

549
00:19:17,280 --> 00:19:19,520
you to review so essentially it's like a

550
00:19:19,520 --> 00:19:22,480
decompressor uh for for file formats

551
00:19:22,480 --> 00:19:25,440
which are not not known

552
00:19:25,440 --> 00:19:28,640
and what we have in the fstm guide

553
00:19:28,640 --> 00:19:31,360
it's um so they have composed it in nine

554
00:19:31,360 --> 00:19:33,360
stages and they start by

555
00:19:33,360 --> 00:19:35,360
like gathering information and they

556
00:19:35,360 --> 00:19:36,960
explain the different methods of

557
00:19:36,960 --> 00:19:38,559
obtaining the firmware how you can

558
00:19:38,559 --> 00:19:41,039
analyze it how to extract it

559
00:19:41,039 --> 00:19:43,520
and then how to to analyze the file

560
00:19:43,520 --> 00:19:45,039
system in the file system is where

561
00:19:45,039 --> 00:19:46,240
you're going to find the goal is when

562
00:19:46,240 --> 00:19:47,840
you're going to find the credentials the

563
00:19:47,840 --> 00:19:49,520
hardcoded credentials and all that

564
00:19:49,520 --> 00:19:53,520
information that the wasp was um

565
00:19:53,520 --> 00:19:56,160
like warning us about okay so if you

566
00:19:56,160 --> 00:19:58,000
want to get to know if there are secure

567
00:19:58,000 --> 00:19:59,919
network services if there are we get

568
00:19:59,919 --> 00:20:00,799
several

569
00:20:00,799 --> 00:20:02,720
hardware passwords then you're going to

570
00:20:02,720 --> 00:20:05,520
find that in the file system which

571
00:20:05,520 --> 00:20:08,000
most of the times is something similar

572
00:20:08,000 --> 00:20:09,120
uh

573
00:20:09,120 --> 00:20:10,000
to

574
00:20:10,000 --> 00:20:11,679
two lens

575
00:20:11,679 --> 00:20:13,760
um so what i did in this in this

576
00:20:13,760 --> 00:20:15,840
category was to

577
00:20:15,840 --> 00:20:16,960
first

578
00:20:16,960 --> 00:20:19,120
i bought a cam a baby ip cam which was

579
00:20:19,120 --> 00:20:20,880
known to be vulnerable in this case as

580
00:20:20,880 --> 00:20:22,240
you can see in the picture it was

581
00:20:22,240 --> 00:20:25,440
exposing the the urt ports so i soldered

582
00:20:25,440 --> 00:20:28,960
myself uh i soldered um well yeah the

583
00:20:28,960 --> 00:20:32,320
connection with the urt

584
00:20:32,320 --> 00:20:35,120
urt2usb interface and then i was able to

585
00:20:35,120 --> 00:20:38,480
interact uh directly with the uh iptv

586
00:20:38,480 --> 00:20:39,200
cam

587
00:20:39,200 --> 00:20:41,600
um what is also important to know is

588
00:20:41,600 --> 00:20:43,520
that most of the times you are banging

589
00:20:43,520 --> 00:20:45,360
your health into the world to extract

590
00:20:45,360 --> 00:20:47,200
the firmware from the

591
00:20:47,200 --> 00:20:49,919
from the flash memory chip uh but

592
00:20:49,919 --> 00:20:51,840
some of the manufacturers actually

593
00:20:51,840 --> 00:20:53,280
release it online so for example what

594
00:20:53,280 --> 00:20:55,440
you can see in this in these images here

595
00:20:55,440 --> 00:20:58,159
is the firmware for a well-known uh

596
00:20:58,159 --> 00:21:01,760
router um for from the link and if you

597
00:21:01,760 --> 00:21:04,080
get this firmware then you can unpack it

598
00:21:04,080 --> 00:21:06,559
you see the binary binary then you can

599
00:21:06,559 --> 00:21:07,919
run bin work on it and you're going to

600
00:21:07,919 --> 00:21:09,760
see the different files that it's using

601
00:21:09,760 --> 00:21:11,840
um the goal when you get this framework

602
00:21:11,840 --> 00:21:14,159
is to be able to emulate it so you'll

603
00:21:14,159 --> 00:21:16,240
have to understand in which architecture

604
00:21:16,240 --> 00:21:18,720
it is running and then using qm or the

605
00:21:18,720 --> 00:21:20,880
appropriate tools you can emulate it in

606
00:21:20,880 --> 00:21:23,200
your machine and interact with it as if

607
00:21:23,200 --> 00:21:24,799
it were a live

608
00:21:24,799 --> 00:21:27,280
device

609
00:21:28,480 --> 00:21:30,080
and with that said we go to the third

610
00:21:30,080 --> 00:21:32,960
category which is weapon api and here

611
00:21:32,960 --> 00:21:34,799
wasp has covered so we have all the

612
00:21:34,799 --> 00:21:37,520
documentation that we want all the multi

613
00:21:37,520 --> 00:21:39,600
guides on how to test applications which

614
00:21:39,600 --> 00:21:41,360
tests should be conducted we have the

615
00:21:41,360 --> 00:21:44,240
last of them for application security

616
00:21:44,240 --> 00:21:46,799
likewise we have the wasp.10 for api

617
00:21:46,799 --> 00:21:48,480
security

618
00:21:48,480 --> 00:21:52,000
so lots of good information but although

619
00:21:52,000 --> 00:21:54,000
you can find um

620
00:21:54,000 --> 00:21:56,640
so you can find any of the well-known

621
00:21:56,640 --> 00:21:58,799
web vulnerabilities in an iot device

622
00:21:58,799 --> 00:22:01,200
there are some specific vulnerabilities

623
00:22:01,200 --> 00:22:04,159
which are more relevant in iot devices

624
00:22:04,159 --> 00:22:05,200
which are the ones we are going to

625
00:22:05,200 --> 00:22:07,039
discuss now

626
00:22:07,039 --> 00:22:09,280
and i'm going to explain why so this

627
00:22:09,280 --> 00:22:11,039
vulnerability is an injection on their

628
00:22:11,039 --> 00:22:13,919
abilities buffer overflow and differing

629
00:22:13,919 --> 00:22:16,559
vulnerabilities the reason why these

630
00:22:16,559 --> 00:22:18,880
vulnerabilities are more relevant in iot

631
00:22:18,880 --> 00:22:20,960
devices is that for example with

632
00:22:20,960 --> 00:22:23,679
injection vulnerabilities if the website

633
00:22:23,679 --> 00:22:26,480
is hosted directly by the iot device

634
00:22:26,480 --> 00:22:29,039
and you find a way to execute code as in

635
00:22:29,039 --> 00:22:31,760
a remote core execution and then you're

636
00:22:31,760 --> 00:22:33,520
already touching the device so you don't

637
00:22:33,520 --> 00:22:36,320
have any additional security

638
00:22:36,320 --> 00:22:38,159
measure that is going to impact maybe

639
00:22:38,159 --> 00:22:41,280
you can have users as a data slash data

640
00:22:41,280 --> 00:22:43,360
that will like restrict you from jumping

641
00:22:43,360 --> 00:22:45,280
to the root but then again we've talked

642
00:22:45,280 --> 00:22:48,000
about how iot devices are hardly updated

643
00:22:48,000 --> 00:22:50,080
so probably will be easier for you to

644
00:22:50,080 --> 00:22:52,159
find an exploit that allows you to

645
00:22:52,159 --> 00:22:55,840
escalate previous um

646
00:22:55,840 --> 00:22:56,960
um

647
00:22:56,960 --> 00:22:59,760
likewise if you find a buffer overflow

648
00:22:59,760 --> 00:23:00,799
um

649
00:23:00,799 --> 00:23:03,919
the most likely scenario is that memory

650
00:23:03,919 --> 00:23:05,280
protection technique protection

651
00:23:05,280 --> 00:23:08,960
techniques like dev or aslr

652
00:23:08,960 --> 00:23:10,960
are disabled the reason for this is that

653
00:23:10,960 --> 00:23:13,200
you have to think

654
00:23:13,200 --> 00:23:14,880
how much it costs an id device so if you

655
00:23:14,880 --> 00:23:16,880
have an iot device that is that costs

656
00:23:16,880 --> 00:23:18,320
five euros

657
00:23:18,320 --> 00:23:20,400
and they have to build the device build

658
00:23:20,400 --> 00:23:22,000
the web page build the mobile

659
00:23:22,000 --> 00:23:23,600
application

660
00:23:23,600 --> 00:23:25,360
this is this stuff expensive so

661
00:23:25,360 --> 00:23:28,320
sometimes the usability versus security

662
00:23:28,320 --> 00:23:30,400
and wins the usability and then they

663
00:23:30,400 --> 00:23:32,480
decide to disable all these

664
00:23:32,480 --> 00:23:34,640
memory protections that we are used to

665
00:23:34,640 --> 00:23:36,480
in limit services

666
00:23:36,480 --> 00:23:39,280
and in linux operating systems

667
00:23:39,280 --> 00:23:43,120
to make the device run smoother

668
00:23:43,120 --> 00:23:44,960
and last but not least important beefing

669
00:23:44,960 --> 00:23:46,640
vulnerabilities do you think

670
00:23:46,640 --> 00:23:49,760
vulnerabilities have gained a lot of

671
00:23:49,760 --> 00:23:51,600
popularity well they have always been

672
00:23:51,600 --> 00:23:53,840
popular but for example this last month

673
00:23:53,840 --> 00:23:56,400
i think we saw uh maybe some of you can

674
00:23:56,400 --> 00:23:58,559
recall the confluence vulnerability

675
00:23:58,559 --> 00:23:59,840
where there was a patch that was

676
00:23:59,840 --> 00:24:02,159
released and researchers um when they

677
00:24:02,159 --> 00:24:04,960
saw that it was a critical security

678
00:24:04,960 --> 00:24:06,480
patch they went they downloaded the

679
00:24:06,480 --> 00:24:08,320
patch they reversed it and they knew

680
00:24:08,320 --> 00:24:11,200
exactly what was the problem and in a

681
00:24:11,200 --> 00:24:12,960
matter of days they were able to develop

682
00:24:12,960 --> 00:24:15,440
an exploit which started to be exploited

683
00:24:15,440 --> 00:24:19,200
in the wild in in a matter of hours um

684
00:24:19,200 --> 00:24:22,640
with iot devices happens the same

685
00:24:22,640 --> 00:24:24,240
with the idea

686
00:24:24,240 --> 00:24:26,960
that most iot devices are never updated

687
00:24:26,960 --> 00:24:29,440
when when they need to be updated so now

688
00:24:29,440 --> 00:24:31,120
imagine that the secure researchers get

689
00:24:31,120 --> 00:24:35,440
your amazon echo device or gets your um

690
00:24:35,440 --> 00:24:37,360
the the the ip cam that you have bought

691
00:24:37,360 --> 00:24:39,039
for your home which was only 10 years

692
00:24:39,039 --> 00:24:40,640
and seemed like the perfect deal and

693
00:24:40,640 --> 00:24:42,320
they see that there is a remote code

694
00:24:42,320 --> 00:24:44,320
execution vulnerability

695
00:24:44,320 --> 00:24:47,200
um and the manufacturer releases a hot

696
00:24:47,200 --> 00:24:49,440
fix um

697
00:24:49,440 --> 00:24:52,400
if the secure update mechanism isn't

698
00:24:52,400 --> 00:24:53,840
there if the device are not updating

699
00:24:53,840 --> 00:24:56,960
automatically then in a matter of days

700
00:24:56,960 --> 00:24:58,559
this vulnerability will be exploited in

701
00:24:58,559 --> 00:24:59,600
a while wild

702
00:24:59,600 --> 00:25:01,039
what you can see in the screen these

703
00:25:01,039 --> 00:25:04,400
these two screenshots um are basically a

704
00:25:04,400 --> 00:25:08,320
an academic dummy uh case to show the

705
00:25:08,320 --> 00:25:10,400
risk so imagine that you have the old

706
00:25:10,400 --> 00:25:11,919
firmware where you get

707
00:25:11,919 --> 00:25:14,159
you get the variable in php and then you

708
00:25:14,159 --> 00:25:16,799
you do an eval tweet eval has

709
00:25:16,799 --> 00:25:19,840
long been regarded as a vulnerable um

710
00:25:19,840 --> 00:25:22,400
function and it's used in ctf for those

711
00:25:22,400 --> 00:25:24,640
of you who play um

712
00:25:24,640 --> 00:25:26,159
and now the manufacturer release

713
00:25:26,159 --> 00:25:28,320
releases a new file which essentially

714
00:25:28,320 --> 00:25:30,559
tries to uh sanitize the input okay this

715
00:25:30,559 --> 00:25:32,159
is what you need so what an attacker

716
00:25:32,159 --> 00:25:33,760
will do is they'll know that the new

717
00:25:33,760 --> 00:25:35,440
file has a security fix but they don't

718
00:25:35,440 --> 00:25:37,440
know where it is they'll just do a div

719
00:25:37,440 --> 00:25:38,640
and they'll know exactly where the

720
00:25:38,640 --> 00:25:40,799
injection point is they're going to then

721
00:25:40,799 --> 00:25:43,600
enumerate devices which they know have

722
00:25:43,600 --> 00:25:45,279
not been touched usually because there's

723
00:25:45,279 --> 00:25:46,720
the version number in the footer of the

724
00:25:46,720 --> 00:25:48,799
page or or well a lot of different

725
00:25:48,799 --> 00:25:51,440
measures and they'll have a remote code

726
00:25:51,440 --> 00:25:55,039
execution if that's the case

727
00:25:55,600 --> 00:25:56,559
um

728
00:25:56,559 --> 00:25:59,440
with that said uh we go to the fourth

729
00:25:59,440 --> 00:26:01,679
category which is mobile applications

730
00:26:01,679 --> 00:26:02,720
and again

731
00:26:02,720 --> 00:26:04,000
uh

732
00:26:04,000 --> 00:26:06,240
has discovered okay um

733
00:26:06,240 --> 00:26:07,840
we have the waste attempt so we know

734
00:26:07,840 --> 00:26:10,400
which are the things that we we want to

735
00:26:10,400 --> 00:26:11,760
be secure for

736
00:26:11,760 --> 00:26:13,919
and we know how to test for these

737
00:26:13,919 --> 00:26:15,279
vulnerabilities because we have the

738
00:26:15,279 --> 00:26:17,760
mobile security testing live

739
00:26:17,760 --> 00:26:19,600
um

740
00:26:19,600 --> 00:26:21,600
what i did during the research here was

741
00:26:21,600 --> 00:26:24,240
first of all to understand how the i'm

742
00:26:24,240 --> 00:26:26,640
not uh i'm not a mobile uh then tester

743
00:26:26,640 --> 00:26:29,200
but yes understand how the process of

744
00:26:29,200 --> 00:26:30,720
contesting my application works how you

745
00:26:30,720 --> 00:26:32,159
can reverse it how you can extract these

746
00:26:32,159 --> 00:26:34,320
other files and how you can understand

747
00:26:34,320 --> 00:26:36,799
how the application works from there um

748
00:26:36,799 --> 00:26:39,279
one tool that is used to provide us apk

749
00:26:39,279 --> 00:26:43,200
is its apk tool and essentially when uh

750
00:26:43,200 --> 00:26:45,039
reviewing some of the

751
00:26:45,039 --> 00:26:47,279
cheap mobile applications for

752
00:26:47,279 --> 00:26:49,760
for iot devices there was one which

753
00:26:49,760 --> 00:26:52,320
essentially was doing what and i'm going

754
00:26:52,320 --> 00:26:54,240
to the beginning again so what the wasp

755
00:26:54,240 --> 00:26:55,200
is

756
00:26:55,200 --> 00:26:56,720
warning us about so we guess about our

757
00:26:56,720 --> 00:26:58,880
hardcore passwords okay um so what they

758
00:26:58,880 --> 00:27:02,000
were doing is if the password is it's

759
00:27:02,000 --> 00:27:03,760
has not been set then the password will

760
00:27:03,760 --> 00:27:06,400
be no password so then if you just

761
00:27:06,400 --> 00:27:08,080
build your payload then you're going to

762
00:27:08,080 --> 00:27:10,320
be able to interact with the device um

763
00:27:10,320 --> 00:27:11,679
as if you were

764
00:27:11,679 --> 00:27:14,480
the owner of it

765
00:27:14,480 --> 00:27:16,320
so again we're not looking for that

766
00:27:16,320 --> 00:27:18,399
specific book

767
00:27:18,399 --> 00:27:20,320
that is going to be that is super

768
00:27:20,320 --> 00:27:23,440
complex and that needs uh two months of

769
00:27:23,440 --> 00:27:26,000
research to find we're looking about bad

770
00:27:26,000 --> 00:27:28,640
practices from the from the iot uh

771
00:27:28,640 --> 00:27:30,960
manufacturing companies that could leave

772
00:27:30,960 --> 00:27:34,159
organizations at risk

773
00:27:34,159 --> 00:27:35,679
and

774
00:27:35,679 --> 00:27:38,159
we go to the final uh category which is

775
00:27:38,159 --> 00:27:40,240
the radio communication one so there

776
00:27:40,240 --> 00:27:42,159
were some articles in in radio

777
00:27:42,159 --> 00:27:44,480
communications um

778
00:27:44,480 --> 00:27:46,080
there's there are some articles on this

779
00:27:46,080 --> 00:27:48,399
on and i've seen lately some some extra

780
00:27:48,399 --> 00:27:50,880
ones which have appeared on how to test

781
00:27:50,880 --> 00:27:53,200
iot devices uh for the bluetooth low

782
00:27:53,200 --> 00:27:55,360
energy vulnerabilities and also there is

783
00:27:55,360 --> 00:27:57,520
a really good talk uh from black hat usa

784
00:27:57,520 --> 00:28:01,200
2015 that explains how zigbee works

785
00:28:01,200 --> 00:28:03,039
where are its vulnerabilities how you

786
00:28:03,039 --> 00:28:05,039
can exploit them how in certain

787
00:28:05,039 --> 00:28:06,720
scenarios you can jump the communication

788
00:28:06,720 --> 00:28:08,880
to force

789
00:28:08,880 --> 00:28:11,200
a certain key to be sent and you can

790
00:28:11,200 --> 00:28:12,960
intercept it and then you can take over

791
00:28:12,960 --> 00:28:15,039
the devices so all these ideas

792
00:28:15,039 --> 00:28:17,120
and while here

793
00:28:17,120 --> 00:28:18,240
this was a

794
00:28:18,240 --> 00:28:20,080
it was the first time i saw zigbee and

795
00:28:20,080 --> 00:28:21,840
ambushes of energy so i first tried to

796
00:28:21,840 --> 00:28:23,919
understand how they were they are really

797
00:28:23,919 --> 00:28:25,200
specific probably you have to think like

798
00:28:25,200 --> 00:28:26,080
they are

799
00:28:26,080 --> 00:28:28,640
like http or tcp like you learn them in

800
00:28:28,640 --> 00:28:30,399
college or on your own but

801
00:28:30,399 --> 00:28:32,000
you have to to study them and you need

802
00:28:32,000 --> 00:28:33,440
to understand how they work before

803
00:28:33,440 --> 00:28:35,919
you're able to craft requests and then

804
00:28:35,919 --> 00:28:37,279
using

805
00:28:37,279 --> 00:28:39,200
uh bluetooth low energy sniffer i was

806
00:28:39,200 --> 00:28:42,240
able to intercept the the request from

807
00:28:42,240 --> 00:28:45,360
uh above a lightning bolt which was

808
00:28:45,360 --> 00:28:47,760
vulnerable and i was able to change the

809
00:28:47,760 --> 00:28:50,559
color of the bulb using uh the computer

810
00:28:50,559 --> 00:28:52,879
okay

811
00:28:53,760 --> 00:28:55,039
so

812
00:28:55,039 --> 00:28:56,320
um

813
00:28:56,320 --> 00:28:58,960
before finishing the talk um i wanted to

814
00:28:58,960 --> 00:29:01,200
present uh two real

815
00:29:01,200 --> 00:29:03,840
uh world uh case scenarios which we have

816
00:29:03,840 --> 00:29:05,600
tested in the company where i'm

817
00:29:05,600 --> 00:29:06,960
currently working

818
00:29:06,960 --> 00:29:07,840
um

819
00:29:07,840 --> 00:29:10,080
explain which have been the takeaways

820
00:29:10,080 --> 00:29:11,520
that uh

821
00:29:11,520 --> 00:29:12,720
yeah that we have

822
00:29:12,720 --> 00:29:13,919
that we have seen from doing these

823
00:29:13,919 --> 00:29:17,679
pendants and where we think um

824
00:29:17,679 --> 00:29:19,679
are the risks okay

825
00:29:19,679 --> 00:29:22,480
uh so first i've i've thrown a little

826
00:29:22,480 --> 00:29:23,840
bit which was the architecture of the

827
00:29:23,840 --> 00:29:25,760
iot system that we're going to

828
00:29:25,760 --> 00:29:27,600
we're going to then test so as you can

829
00:29:27,600 --> 00:29:29,279
see um so this

830
00:29:29,279 --> 00:29:30,960
so for you to understand these were like

831
00:29:30,960 --> 00:29:32,240
um smart

832
00:29:32,240 --> 00:29:35,120
lightning uh panels which are placed on

833
00:29:35,120 --> 00:29:37,440
on the factories in the in the rooftop

834
00:29:37,440 --> 00:29:39,520
um so depending on the light that comes

835
00:29:39,520 --> 00:29:43,279
from inside um they can uh they can

836
00:29:43,279 --> 00:29:45,360
change the amount of light that they are

837
00:29:45,360 --> 00:29:47,279
emitting and also depending on the

838
00:29:47,279 --> 00:29:50,080
number of of sound and and the footsteps

839
00:29:50,080 --> 00:29:52,320
that they hear they can change also the

840
00:29:52,320 --> 00:29:54,880
the quantity of light that they need

841
00:29:54,880 --> 00:29:55,760
um

842
00:29:55,760 --> 00:29:57,279
the architecture that the company

843
00:29:57,279 --> 00:29:59,600
providing this this service was using is

844
00:29:59,600 --> 00:30:00,480
they had

845
00:30:00,480 --> 00:30:02,399
an on-site web appliance which was a

846
00:30:02,399 --> 00:30:04,240
linux server and then they would connect

847
00:30:04,240 --> 00:30:06,159
directly to our internal network siege

848
00:30:06,159 --> 00:30:07,760
they would place their network gateways

849
00:30:07,760 --> 00:30:09,919
there and each network gateway which

850
00:30:09,919 --> 00:30:13,200
would communicate with 20 to 50 um

851
00:30:13,200 --> 00:30:14,720
lightning panels so we had several

852
00:30:14,720 --> 00:30:16,559
network gateways

853
00:30:16,559 --> 00:30:17,360
so

854
00:30:17,360 --> 00:30:18,399
the first thing that we need to

855
00:30:18,399 --> 00:30:20,960
understand was what uh

856
00:30:20,960 --> 00:30:23,919
needed test okay and in this case you

857
00:30:23,919 --> 00:30:26,320
can see it it is pretty clear um so we

858
00:30:26,320 --> 00:30:27,679
had the web appliance server

859
00:30:27,679 --> 00:30:29,279
configuration so it was an ubuntu

860
00:30:29,279 --> 00:30:31,440
machine i have really updated one we had

861
00:30:31,440 --> 00:30:33,600
the web application we had the different

862
00:30:33,600 --> 00:30:35,679
gateways uh we have the zigbee

863
00:30:35,679 --> 00:30:38,159
connection per se and we had the the

864
00:30:38,159 --> 00:30:40,799
lining panels and the and the physical

865
00:30:40,799 --> 00:30:43,520
security of those panels

866
00:30:43,520 --> 00:30:44,640
um

867
00:30:44,640 --> 00:30:46,480
when there is a gateway usually the the

868
00:30:46,480 --> 00:30:47,919
logic of the application sits in the

869
00:30:47,919 --> 00:30:50,000
gateway and the zigbee doesn't have so

870
00:30:50,000 --> 00:30:52,320
sorry the lightning panel or the end iot

871
00:30:52,320 --> 00:30:54,480
device doesn't have much intelligence

872
00:30:54,480 --> 00:30:57,440
and and all the magic to say

873
00:30:57,440 --> 00:31:01,200
in some way happens on the gateway okay

874
00:31:01,200 --> 00:31:02,080
so

875
00:31:02,080 --> 00:31:04,399
which were the the high level fundings

876
00:31:04,399 --> 00:31:06,960
of of this pen test um so when we

877
00:31:06,960 --> 00:31:09,279
started uh like scrubbing the surface

878
00:31:09,279 --> 00:31:12,159
and seeing what was what was happening

879
00:31:12,159 --> 00:31:14,640
and what was there um we saw that the

880
00:31:14,640 --> 00:31:16,000
system was using outdated in this

881
00:31:16,000 --> 00:31:19,120
machine so it had an ssh open for

882
00:31:19,120 --> 00:31:20,880
administrative purposes

883
00:31:20,880 --> 00:31:23,120
and it exposed several additional

884
00:31:23,120 --> 00:31:25,279
outdated services like apache2 so

885
00:31:25,279 --> 00:31:26,399
imagine

886
00:31:26,399 --> 00:31:29,440
one day this ssh key or ssh password

887
00:31:29,440 --> 00:31:30,399
gets

888
00:31:30,399 --> 00:31:32,799
lost then um

889
00:31:32,799 --> 00:31:34,799
in a second all the bad guys can access

890
00:31:34,799 --> 00:31:37,200
i don't know several iot systems in

891
00:31:37,200 --> 00:31:39,440
in the world um also the linux machine

892
00:31:39,440 --> 00:31:42,080
was not updated was provided as is

893
00:31:42,080 --> 00:31:45,360
um when checking the web appliance https

894
00:31:45,360 --> 00:31:47,440
which is an internal requirement that we

895
00:31:47,440 --> 00:31:50,080
have at the company was not being used

896
00:31:50,080 --> 00:31:51,600
there was no password complexity on the

897
00:31:51,600 --> 00:31:54,480
webpage um default launcher default

898
00:31:54,480 --> 00:31:56,559
credentials were being used both in the

899
00:31:56,559 --> 00:31:59,039
so in the ssh service as i have

900
00:31:59,039 --> 00:32:02,320
explained and in the web appliance

901
00:32:02,320 --> 00:32:04,799
um the lighting giants were also

902
00:32:04,799 --> 00:32:06,240
exposing some

903
00:32:06,240 --> 00:32:08,320
debugging

904
00:32:08,320 --> 00:32:11,200
interfaces and they had well several

905
00:32:11,200 --> 00:32:15,320
additional web vulnerabilities

906
00:32:16,480 --> 00:32:18,240
um

907
00:32:18,240 --> 00:32:20,480
so you're going to wonder where are the

908
00:32:20,480 --> 00:32:21,760
radio communication and hardware

909
00:32:21,760 --> 00:32:23,279
vulnerabilities and one of the

910
00:32:23,279 --> 00:32:25,760
conclusions of the of the pen test and

911
00:32:25,760 --> 00:32:28,000
and of the of the work that we have been

912
00:32:28,000 --> 00:32:31,279
doing internally is that um usually the

913
00:32:31,279 --> 00:32:33,360
company commercializing a service like

914
00:32:33,360 --> 00:32:35,679
this smart lightning for example um

915
00:32:35,679 --> 00:32:37,440
builds the webpage can build the mobile

916
00:32:37,440 --> 00:32:39,039
application if there's one builds the

917
00:32:39,039 --> 00:32:41,760
server where everything is going to is

918
00:32:41,760 --> 00:32:43,760
going to happen but doesn't build the

919
00:32:43,760 --> 00:32:46,960
the zigbee modules because for specific

920
00:32:46,960 --> 00:32:48,399
network um

921
00:32:48,399 --> 00:32:50,880
modules it happens the same with the gsm

922
00:32:50,880 --> 00:32:53,840
gsm modules that mobile phones have um

923
00:32:53,840 --> 00:32:56,240
they are only a

924
00:32:56,240 --> 00:32:57,840
few suppliers in the world that produce

925
00:32:57,840 --> 00:33:00,399
them and they make sure that the that

926
00:33:00,399 --> 00:33:02,159
the chips are working as expected and

927
00:33:02,159 --> 00:33:04,799
that are implementing the the

928
00:33:04,799 --> 00:33:07,039
radio communications protocols as they

929
00:33:07,039 --> 00:33:08,960
are supposed to

930
00:33:08,960 --> 00:33:11,120
another thing that that can happen is

931
00:33:11,120 --> 00:33:13,840
that sometimes uh companies will

932
00:33:13,840 --> 00:33:15,600
tweak some of the configuration and

933
00:33:15,600 --> 00:33:17,679
there are um

934
00:33:17,679 --> 00:33:19,279
there are well there are occasions where

935
00:33:19,279 --> 00:33:22,159
you can find uh some security uh

936
00:33:22,159 --> 00:33:24,960
measures off that can put the system at

937
00:33:24,960 --> 00:33:26,080
risk okay

938
00:33:26,080 --> 00:33:27,600
um

939
00:33:27,600 --> 00:33:29,360
the second scenario that we have

940
00:33:29,360 --> 00:33:30,960
contested

941
00:33:30,960 --> 00:33:32,480
is the connected works okay so

942
00:33:32,480 --> 00:33:34,960
essentially there is a fridge which has

943
00:33:34,960 --> 00:33:37,840
a cam and can take photos of

944
00:33:37,840 --> 00:33:39,840
how

945
00:33:39,840 --> 00:33:40,880
how

946
00:33:40,880 --> 00:33:43,120
so if the bottles on in the fridge have

947
00:33:43,120 --> 00:33:45,120
been emptied or not and if the fridge

948
00:33:45,120 --> 00:33:48,080
needs refill and this system had an ios

949
00:33:48,080 --> 00:33:50,240
application but it also had a web

950
00:33:50,240 --> 00:33:52,240
appliance that was built on top on azure

951
00:33:52,240 --> 00:33:53,279
iot

952
00:33:53,279 --> 00:33:55,360
um which in turn communicated with

953
00:33:55,360 --> 00:33:57,840
salesforce so you see again a pretty

954
00:33:57,840 --> 00:34:00,240
complex architecture uh where you need

955
00:34:00,240 --> 00:34:03,039
to test different things in order to to

956
00:34:03,039 --> 00:34:04,960
give some assurance on the whole system

957
00:34:04,960 --> 00:34:06,720
know and the things that needed testing

958
00:34:06,720 --> 00:34:08,800
here were the web appliance the ios

959
00:34:08,800 --> 00:34:10,480
application the bluetooth low energy

960
00:34:10,480 --> 00:34:11,520
connection

961
00:34:11,520 --> 00:34:14,239
and the controller of the fridge

962
00:34:14,239 --> 00:34:16,960
and also the integration with salesforce

963
00:34:16,960 --> 00:34:20,000
um so which were again the findings and

964
00:34:20,000 --> 00:34:23,040
the idea repeats okay um

965
00:34:23,040 --> 00:34:25,599
several webinars were found okay so we

966
00:34:25,599 --> 00:34:28,639
had xss password release related ones

967
00:34:28,639 --> 00:34:30,879
session management and also several

968
00:34:30,879 --> 00:34:32,960
mobile application vulnerabilities

969
00:34:32,960 --> 00:34:35,679
um but in the other hand

970
00:34:35,679 --> 00:34:37,760
the device was really well protected so

971
00:34:37,760 --> 00:34:41,440
it was one in one of oaf's iot isbs

972
00:34:41,440 --> 00:34:42,719
recommendation as you can see in the

973
00:34:42,719 --> 00:34:45,199
screen so all the contents of the

974
00:34:45,199 --> 00:34:47,599
controller were

975
00:34:47,599 --> 00:34:50,560
filled with this type of glue which was

976
00:34:50,560 --> 00:34:53,599
in turn covered in a black um

977
00:34:53,599 --> 00:34:55,280
with black painting and it was

978
00:34:55,280 --> 00:34:57,359
impossible to know which chips were

979
00:34:57,359 --> 00:34:59,280
working if you could extract something

980
00:34:59,280 --> 00:35:01,119
from there if there was a

981
00:35:01,119 --> 00:35:02,720
debugging interface that you could plug

982
00:35:02,720 --> 00:35:05,520
into um it was it was really really

983
00:35:05,520 --> 00:35:07,760
difficult to do we tried to pry it open

984
00:35:07,760 --> 00:35:09,920
uh but uh but yeah it was it was really

985
00:35:09,920 --> 00:35:10,800
secure

986
00:35:10,800 --> 00:35:12,800
and and also the bluetooth energy

987
00:35:12,800 --> 00:35:14,800
connection that the controller was using

988
00:35:14,800 --> 00:35:16,880
uh was using the authentication so first

989
00:35:16,880 --> 00:35:18,720
the mobile application would connect to

990
00:35:18,720 --> 00:35:20,400
the cloud and retrieve some type of

991
00:35:20,400 --> 00:35:22,560
credentials then the ios application

992
00:35:22,560 --> 00:35:24,240
would do a connection to the free using

993
00:35:24,240 --> 00:35:26,320
bluetooth energy which would in turn

994
00:35:26,320 --> 00:35:28,640
check with the online application if it

995
00:35:28,640 --> 00:35:30,480
was allowed plus so this made the

996
00:35:30,480 --> 00:35:32,160
bluetooth energy also non

997
00:35:32,160 --> 00:35:34,720
straightforward we tried to do a python

998
00:35:34,720 --> 00:35:36,240
script that would interact with it and

999
00:35:36,240 --> 00:35:38,800
try to bypass it but yeah it was a lot

1000
00:35:38,800 --> 00:35:42,560
of time and and we we gave it a a green

1001
00:35:42,560 --> 00:35:44,640
check

1002
00:35:44,640 --> 00:35:46,079
um

1003
00:35:46,079 --> 00:35:47,839
so well um

1004
00:35:47,839 --> 00:35:49,760
again which are the conclusions of this

1005
00:35:49,760 --> 00:35:51,119
of these fantastic that we did to the

1006
00:35:51,119 --> 00:35:53,200
connected coolers that the things that

1007
00:35:53,200 --> 00:35:54,800
are sold at scale so for example i

1008
00:35:54,800 --> 00:35:57,119
imagine that the company that that sells

1009
00:35:57,119 --> 00:35:58,800
this this controller is selling millions

1010
00:35:58,800 --> 00:35:59,680
of them

1011
00:35:59,680 --> 00:36:01,119
are well protected they know that they

1012
00:36:01,119 --> 00:36:03,359
have an ip that they want to protect and

1013
00:36:03,359 --> 00:36:06,320
they do it really well um but then where

1014
00:36:06,320 --> 00:36:07,520
you can find

1015
00:36:07,520 --> 00:36:08,640
more opportunities or more

1016
00:36:08,640 --> 00:36:10,480
vulnerabilities in the web is in the web

1017
00:36:10,480 --> 00:36:13,200
application and mobile application where

1018
00:36:13,200 --> 00:36:14,160
uh

1019
00:36:14,160 --> 00:36:16,079
yeah it's something that is being pushed

1020
00:36:16,079 --> 00:36:19,359
or made and and and can be can be

1021
00:36:19,359 --> 00:36:21,760
vulnerable

1022
00:36:21,760 --> 00:36:22,560
and

1023
00:36:22,560 --> 00:36:24,480
we have a right to the conclusions so if

1024
00:36:24,480 --> 00:36:26,320
you have followed the talk i hope uh i

1025
00:36:26,320 --> 00:36:28,079
have been able to convince you that

1026
00:36:28,079 --> 00:36:29,760
although sometimes we might lack time

1027
00:36:29,760 --> 00:36:32,079
and knowledge of a specific iot device

1028
00:36:32,079 --> 00:36:33,520
there are always tests which can and

1029
00:36:33,520 --> 00:36:35,520
should be done to make sure our specs

1030
00:36:35,520 --> 00:36:37,920
iot top 10 vulnerabilities are avoided

1031
00:36:37,920 --> 00:36:41,040
um it is not only limited to the to the

1032
00:36:41,040 --> 00:36:44,960
pen testing effort so again uh if you go

1033
00:36:44,960 --> 00:36:46,960
back to the beginning i i think it's

1034
00:36:46,960 --> 00:36:49,760
really important to have a a really

1035
00:36:49,760 --> 00:36:51,839
good third participant where the

1036
00:36:51,839 --> 00:36:52,880
provider

1037
00:36:52,880 --> 00:36:54,640
explains which security measures they

1038
00:36:54,640 --> 00:36:56,960
have used for the iot device and also if

1039
00:36:56,960 --> 00:36:58,640
you are the one on boarding the iot

1040
00:36:58,640 --> 00:37:00,800
devices use a platform that makes it

1041
00:37:00,800 --> 00:37:02,960
easy for you so that that allows you to

1042
00:37:02,960 --> 00:37:05,760
see which devices are communicating why

1043
00:37:05,760 --> 00:37:07,680
you have some of them which are offline

1044
00:37:07,680 --> 00:37:10,480
why you have an outbound connection to a

1045
00:37:10,480 --> 00:37:12,320
service that might be dangerous et

1046
00:37:12,320 --> 00:37:14,160
cetera et cetera

1047
00:37:14,160 --> 00:37:15,680
and

1048
00:37:15,680 --> 00:37:17,680
and yeah radio communications modules

1049
00:37:17,680 --> 00:37:19,359
are usually out of the box devices that

1050
00:37:19,359 --> 00:37:20,880
are acquired from a limited number of

1051
00:37:20,880 --> 00:37:23,280
suppliers and are usually well protected

1052
00:37:23,280 --> 00:37:24,079
so

1053
00:37:24,079 --> 00:37:25,040
uh

1054
00:37:25,040 --> 00:37:26,240
i think

1055
00:37:26,240 --> 00:37:28,079
like there has been there has to be

1056
00:37:28,079 --> 00:37:29,520
specific research

1057
00:37:29,520 --> 00:37:30,880
there and it's not something that the

1058
00:37:30,880 --> 00:37:32,800
companies can do and that if you want to

1059
00:37:32,800 --> 00:37:35,200
try all these iot specific communication

1060
00:37:35,200 --> 00:37:36,960
protocols you're going to need a

1061
00:37:36,960 --> 00:37:39,920
specific specific equipment but there's

1062
00:37:39,920 --> 00:37:43,359
plenty of information online

1063
00:37:43,440 --> 00:37:46,160
thank you very much for listening to me

1064
00:37:46,160 --> 00:37:47,839
you have any questions

1065
00:37:47,839 --> 00:37:49,760
you can drop me an email you can find me

1066
00:37:49,760 --> 00:37:53,599
on twitter or you can ask here

1067
00:37:54,400 --> 00:37:55,839
awesome thank you now for the

1068
00:37:55,839 --> 00:37:58,720
presentation thank you okay

1069
00:37:58,720 --> 00:38:00,800
um i'm not saying we got

1070
00:38:00,800 --> 00:38:03,520
any questions almost like

1071
00:38:03,520 --> 00:38:06,000
i do have one

1072
00:38:06,000 --> 00:38:06,800
um

1073
00:38:06,800 --> 00:38:08,240
so i wanted to ask you

1074
00:38:08,240 --> 00:38:10,320
when you find those vulnerabilities on

1075
00:38:10,320 --> 00:38:12,160
on the devices right and

1076
00:38:12,160 --> 00:38:14,160
and you i guess you report that back to

1077
00:38:14,160 --> 00:38:16,720
you to the vendor so how that processes

1078
00:38:16,720 --> 00:38:19,119
and this brilliant track or sometimes

1079
00:38:19,119 --> 00:38:21,920
you know yeah it's in the right way

1080
00:38:21,920 --> 00:38:24,160
yeah it's super difficult so when they

1081
00:38:24,160 --> 00:38:26,400
have a vulnerability uh getting them to

1082
00:38:26,400 --> 00:38:28,079
fix it it's hard

1083
00:38:28,079 --> 00:38:29,520
for the first scenario that i've

1084
00:38:29,520 --> 00:38:30,839
presented the one of the lighting

1085
00:38:30,839 --> 00:38:33,119
systems uh what they said is oh yeah

1086
00:38:33,119 --> 00:38:35,680
well because uh someone told us that you

1087
00:38:35,680 --> 00:38:38,960
wanted the in so the internal um linux

1088
00:38:38,960 --> 00:38:41,200
server option but we also have a cloud

1089
00:38:41,200 --> 00:38:43,280
solution which is

1090
00:38:43,280 --> 00:38:45,520
well protected and has been tested so

1091
00:38:45,520 --> 00:38:47,680
you should probably just switch and and

1092
00:38:47,680 --> 00:38:49,200
the company is like okay but we have

1093
00:38:49,200 --> 00:38:50,960
just purchased the old system so why are

1094
00:38:50,960 --> 00:38:54,480
you telling this now um

1095
00:38:54,480 --> 00:38:57,359
and yes if you find stuff in the mobile

1096
00:38:57,359 --> 00:38:59,200
and web application usually it's easier

1097
00:38:59,200 --> 00:39:00,880
for them to find if you find that the

1098
00:39:00,880 --> 00:39:02,640
block interface or for example in the

1099
00:39:02,640 --> 00:39:04,720
connected cooler parts we found some

1100
00:39:04,720 --> 00:39:06,640
credentials which were always being sent

1101
00:39:06,640 --> 00:39:08,800
to the mobile application fixing things

1102
00:39:08,800 --> 00:39:09,760
which are

1103
00:39:09,760 --> 00:39:11,200
in the in the

1104
00:39:11,200 --> 00:39:12,880
in the skeleton of the application it's

1105
00:39:12,880 --> 00:39:14,560
really difficult for them and

1106
00:39:14,560 --> 00:39:15,599
and

1107
00:39:15,599 --> 00:39:17,119
yeah it's it's a it's a difficult

1108
00:39:17,119 --> 00:39:19,440
process but we try now

1109
00:39:19,440 --> 00:39:20,560
well at least you haven't been

1110
00:39:20,560 --> 00:39:23,599
prosecuted right as yet

1111
00:39:23,599 --> 00:39:25,839
yeah

1112
00:39:26,320 --> 00:39:27,760
did you did you manage to put some

1113
00:39:27,760 --> 00:39:29,920
mitigation in place for those cases or

1114
00:39:29,920 --> 00:39:32,079
some

1115
00:39:32,320 --> 00:39:34,720
um yeah of course so for example some of

1116
00:39:34,720 --> 00:39:36,640
the things that we reported and we said

1117
00:39:36,640 --> 00:39:37,599
um

1118
00:39:37,599 --> 00:39:38,400
so

1119
00:39:38,400 --> 00:39:39,920
there are things

1120
00:39:39,920 --> 00:39:43,520
that companies uh um can can can can

1121
00:39:43,520 --> 00:39:45,760
refuse to do for example so if when we

1122
00:39:45,760 --> 00:39:48,079
found the limus machine which had ssh

1123
00:39:48,079 --> 00:39:50,800
this ssh service which was always open

1124
00:39:50,800 --> 00:39:52,320
with an updated machine and we said we

1125
00:39:52,320 --> 00:39:54,000
don't want that there so we have a level

1126
00:39:54,000 --> 00:39:56,160
of security in the company that we try

1127
00:39:56,160 --> 00:39:58,160
to maintain across all our assets and

1128
00:39:58,160 --> 00:40:00,079
you're breaching that security they say

1129
00:40:00,079 --> 00:40:02,640
yes we're going to to do a small update

1130
00:40:02,640 --> 00:40:04,000
and we're going to ship it even if it's

1131
00:40:04,000 --> 00:40:05,200
just for you because they understand

1132
00:40:05,200 --> 00:40:08,319
that it's something unacceptable um if

1133
00:40:08,319 --> 00:40:11,119
you find stuff that is like well that is

1134
00:40:11,119 --> 00:40:12,960
a vulnerability but exploitation is not

1135
00:40:12,960 --> 00:40:15,760
so straightforward uh then

1136
00:40:15,760 --> 00:40:17,119
um

1137
00:40:17,119 --> 00:40:18,480
yeah it's more it's more difficult for

1138
00:40:18,480 --> 00:40:20,319
them yeah it's the same it's the same

1139
00:40:20,319 --> 00:40:22,560
idea

1140
00:40:22,560 --> 00:40:26,079
okay i mean in those cases you you

1141
00:40:26,079 --> 00:40:27,920
i mean like it's like

1142
00:40:27,920 --> 00:40:29,680
internal you may in a company internally

1143
00:40:29,680 --> 00:40:31,839
if we do yeah yeah so for example what

1144
00:40:31,839 --> 00:40:35,280
we do and i think this is a work that um

1145
00:40:35,280 --> 00:40:37,520
other companies have to start doing is

1146
00:40:37,520 --> 00:40:38,880
in our standard we define the things

1147
00:40:38,880 --> 00:40:40,240
that we that we want to know for sure

1148
00:40:40,240 --> 00:40:41,359
for example

1149
00:40:41,359 --> 00:40:43,520
things that i believe not the majority

1150
00:40:43,520 --> 00:40:45,760
of companies have like a good asset

1151
00:40:45,760 --> 00:40:48,960
inventory knowing which versions are are

1152
00:40:48,960 --> 00:40:50,880
running on the devices where are the

1153
00:40:50,880 --> 00:40:52,240
devices because most of the people don't

1154
00:40:52,240 --> 00:40:54,079
know where the iot devices are placed so

1155
00:40:54,079 --> 00:40:55,920
we try to do some of that stuff

1156
00:40:55,920 --> 00:40:57,680
internally having

1157
00:40:57,680 --> 00:40:59,599
yes like tracking files and having a

1158
00:40:59,599 --> 00:41:00,880
list of the suppliers that we have that

1159
00:41:00,880 --> 00:41:03,920
have uh put um like services in our

1160
00:41:03,920 --> 00:41:05,920
network um as we would do for example

1161
00:41:05,920 --> 00:41:08,240
with the vpn also vpns in in internal

1162
00:41:08,240 --> 00:41:09,760
networks has always been a thing but

1163
00:41:09,760 --> 00:41:12,800
nowadays they are trying to reduce it um

1164
00:41:12,800 --> 00:41:14,800
but without the help of the supplier

1165
00:41:14,800 --> 00:41:17,359
there's only so much a company can make

1166
00:41:17,359 --> 00:41:19,440
but yeah can make but yes we we try to

1167
00:41:19,440 --> 00:41:21,839
do our best

1168
00:41:22,960 --> 00:41:25,200
thanks

1169
00:41:25,359 --> 00:41:27,440
now so thanks so much for your

1170
00:41:27,440 --> 00:41:29,599
presentation i said so it's great to see

1171
00:41:29,599 --> 00:41:31,040
local talent here presenting in this

1172
00:41:31,040 --> 00:41:32,160
conference

1173
00:41:32,160 --> 00:41:34,000
and i hope to see you again and

1174
00:41:34,000 --> 00:41:35,760
hopefully face to face on the internet

1175
00:41:35,760 --> 00:41:39,520
conference and yeah all the best thanks

1176
00:41:39,520 --> 00:41:43,160
thanks thank you

