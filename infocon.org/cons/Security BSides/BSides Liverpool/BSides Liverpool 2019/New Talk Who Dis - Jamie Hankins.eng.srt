1
00:00:02,570 --> 00:00:09,559
I'd like to introduce a very very

2
00:00:05,330 --> 00:00:11,150
exceptional talk Jamie I've known for

3
00:00:09,559 --> 00:00:14,690
quite some time and through various

4
00:00:11,150 --> 00:00:16,130
parts of industry I asked him he was one

5
00:00:14,690 --> 00:00:19,099
of the very first people I approached to

6
00:00:16,129 --> 00:00:22,700
submit a talk and he said to me what on

7
00:00:19,099 --> 00:00:24,829
I said on memes have you got any only

8
00:00:22,700 --> 00:00:25,989
create great memes we can talk about and

9
00:00:24,829 --> 00:00:29,809
he duly obliged

10
00:00:25,989 --> 00:00:31,669
he's lands up I think about 175 pages

11
00:00:29,809 --> 00:00:33,710
worth of memes on one page on wanna cry

12
00:00:31,669 --> 00:00:35,030
yeah I don't know if anyone else's I

13
00:00:33,710 --> 00:00:36,880
don't have any ones here the Warnock

14
00:00:35,030 --> 00:00:39,140
writers anyone anyone here the wanna cry

15
00:00:36,880 --> 00:00:43,220
anyone sink sinkholes anyone

16
00:00:39,140 --> 00:00:46,640
never heard of em so Jamie's favorite

17
00:00:43,220 --> 00:00:49,579
phrase is effing wanna cry because he

18
00:00:46,640 --> 00:00:51,200
loves it that much but the contents is

19
00:00:49,579 --> 00:00:53,630
absolutely golden so once again thank

20
00:00:51,200 --> 00:00:59,450
you very much obviously you Jamie thanks

21
00:00:53,630 --> 00:01:02,810
for saying fuck this up too much I'm

22
00:00:59,450 --> 00:01:05,990
gonna be talking about one I cry and

23
00:01:02,810 --> 00:01:19,510
kind of what happened Oh pictures please

24
00:01:05,990 --> 00:01:23,658
so that's kind of what the big okay so

25
00:01:19,510 --> 00:01:25,970
that's not too bad okay so Who am I why

26
00:01:23,659 --> 00:01:34,820
the fuck am i talking why isn't Marcus

27
00:01:25,970 --> 00:01:37,009
here you know so Jing wanna cry was just

28
00:01:34,820 --> 00:01:40,600
an analyst post-arrest

29
00:01:37,010 --> 00:01:44,060
I became the head of French are

30
00:01:40,600 --> 00:01:45,710
conveniently yes you know a lot of

31
00:01:44,060 --> 00:01:47,990
people probably don't know who I am well

32
00:01:45,710 --> 00:01:49,729
I'm here ba ba ba I worked with him for

33
00:01:47,990 --> 00:01:50,809
nine months before wanna cry on other

34
00:01:49,729 --> 00:01:54,700
bits and pieces

35
00:01:50,810 --> 00:01:57,799
cyber crime stuff Mirai other bullshit

36
00:01:54,700 --> 00:01:59,540
and then during wanna cry it was me and

37
00:01:57,799 --> 00:02:01,600
Marcus who were kind of responsible for

38
00:01:59,540 --> 00:02:05,600
running it raising with law enforcement

39
00:02:01,600 --> 00:02:10,608
insurgents community certs everyone and

40
00:02:05,600 --> 00:02:12,439
their mothers by like day I worked in

41
00:02:10,609 --> 00:02:14,630
France I'll but by night I'm a drunk

42
00:02:12,439 --> 00:02:18,049
shit poster

43
00:02:14,630 --> 00:02:18,049
okay so

44
00:02:39,400 --> 00:02:47,750
definitely my favorite meme so I was in

45
00:02:44,660 --> 00:02:49,280
Vegas the day before the arrest this is

46
00:02:47,750 --> 00:02:53,000
what the villa we were staying at look

47
00:02:49,280 --> 00:02:54,650
like can confirm all right so me and him

48
00:02:53,000 --> 00:02:56,960
gave a talk two years ago at a

49
00:02:54,650 --> 00:02:59,210
conference called side by Hagan we're

50
00:02:56,960 --> 00:03:03,560
kind of talking about bits and pieces

51
00:02:59,210 --> 00:03:04,700
but so yeah we kind of my like we're not

52
00:03:03,560 --> 00:03:06,590
gonna talk about this stuff and we kind

53
00:03:04,700 --> 00:03:09,649
of went for it but I don't think we told

54
00:03:06,590 --> 00:03:11,420
the right story at the time but also

55
00:03:09,650 --> 00:03:12,800
like I'm taking this slide and there's

56
00:03:11,420 --> 00:03:15,950
one other thing I'm not going to be

57
00:03:12,800 --> 00:03:18,560
talking about it's hard to talk about

58
00:03:15,950 --> 00:03:20,480
wanna cry without talking about Marcus

59
00:03:18,560 --> 00:03:22,430
so I'll definitely be talking about him

60
00:03:20,480 --> 00:03:24,709
and you know the awesome work we did

61
00:03:22,430 --> 00:03:26,090
during that time but like his legal case

62
00:03:24,710 --> 00:03:28,820
is very much something I won't be

63
00:03:26,090 --> 00:03:34,190
discussing like no questions all unlike

64
00:03:28,820 --> 00:03:35,810
this so I figured maybe some people

65
00:03:34,190 --> 00:03:39,800
actually didn't know what happened so I

66
00:03:35,810 --> 00:03:42,739
built a kind of shit timeline so

67
00:03:39,800 --> 00:03:44,989
Microsoft released a patch for this

68
00:03:42,739 --> 00:03:50,570
thing and then it got leaked kind of a

69
00:03:44,989 --> 00:03:52,880
month later the kind of the background

70
00:03:50,570 --> 00:03:57,920
on that allegedly is that the NSA tipped

71
00:03:52,880 --> 00:04:00,500
off Microsoft but who knows twelve of

72
00:03:57,920 --> 00:04:02,600
May that great day well like everything

73
00:04:00,500 --> 00:04:06,380
blew up and then three days later when

74
00:04:02,600 --> 00:04:09,530
XP got the patch so I started this talk

75
00:04:06,380 --> 00:04:12,320
up with low alarm means but I want to

76
00:04:09,530 --> 00:04:16,100
set the context so for the next 50 or so

77
00:04:12,320 --> 00:04:17,750
slides there's a lot I'm basically

78
00:04:16,100 --> 00:04:20,919
talking about the like my stressful two

79
00:04:17,750 --> 00:04:25,190
weeks of like our lives it was shit I

80
00:04:20,918 --> 00:04:26,870
also wouldn't go back and like change

81
00:04:25,190 --> 00:04:29,870
anything because it was awesome but like

82
00:04:26,870 --> 00:04:31,130
I wouldn't dare again so what you're

83
00:04:29,870 --> 00:04:32,660
looking at here is virustotal

84
00:04:31,130 --> 00:04:36,940
intelligence this is kind of what the

85
00:04:32,660 --> 00:04:41,050
industry use for tracking like samples

86
00:04:36,940 --> 00:04:41,050
so put on lazy

87
00:04:41,500 --> 00:04:48,790
[Music]

88
00:04:43,660 --> 00:04:51,160
here cool so here is the first

89
00:04:48,790 --> 00:04:52,690
submission day which is when the sample

90
00:04:51,160 --> 00:04:57,100
first appeared on virustotal

91
00:04:52,690 --> 00:04:59,410
and you can see like kind of 732 732

92
00:04:57,100 --> 00:05:01,210
peering most of this is from like API

93
00:04:59,410 --> 00:05:03,010
driven stuff so like you know if you

94
00:05:01,210 --> 00:05:06,070
like get a snake-oil vendor and they're

95
00:05:03,010 --> 00:05:07,390
like pop-up box on your network that box

96
00:05:06,070 --> 00:05:15,370
probably uploading all your shit to

97
00:05:07,390 --> 00:05:16,840
Beauty know all of them so yeah

98
00:05:15,370 --> 00:05:18,880
sometimes it's really useful and

99
00:05:16,840 --> 00:05:21,969
sometimes it's like oh now I can read

100
00:05:18,880 --> 00:05:23,560
all your internal emails chairs so

101
00:05:21,970 --> 00:05:25,330
during the next kind of eight hours one

102
00:05:23,560 --> 00:05:28,120
a cry spread around the internet fucking

103
00:05:25,330 --> 00:05:30,460
everything cut no one knew the true

104
00:05:28,120 --> 00:05:32,860
impact some people on Twitter were like

105
00:05:30,460 --> 00:05:36,640
this doesn't look good you know maybe we

106
00:05:32,860 --> 00:05:37,810
should care about this and we just

107
00:05:36,640 --> 00:05:40,539
registered domain names because it

108
00:05:37,810 --> 00:05:41,860
looked fucking cool and so we'd want to

109
00:05:40,540 --> 00:05:45,480
see what was call out towards the main

110
00:05:41,860 --> 00:05:50,140
end so that's what happened in this case

111
00:05:45,480 --> 00:05:52,930
that's free fray five Kevin Bowman or

112
00:05:50,140 --> 00:05:56,110
Goss IVA dog posted a Fred and sis does

113
00:05:52,930 --> 00:06:00,940
anyone here know whispers oh well let's

114
00:05:56,110 --> 00:06:03,250
say more than one okay ncic are great

115
00:06:00,940 --> 00:06:05,680
but sis is a bit rash at times but

116
00:06:03,250 --> 00:06:07,780
during wanna cry it was awesome we were

117
00:06:05,680 --> 00:06:09,400
able to coordinate with like everyone in

118
00:06:07,780 --> 00:06:10,780
the UK about this thing it was really

119
00:06:09,400 --> 00:06:13,270
cool

120
00:06:10,780 --> 00:06:15,250
also as a side note if you ever deal

121
00:06:13,270 --> 00:06:17,080
with logging systems or incidents

122
00:06:15,250 --> 00:06:19,870
centralized on the time zone because

123
00:06:17,080 --> 00:06:21,789
otherwise you're on a world of pain we

124
00:06:19,870 --> 00:06:23,200
now use UTC for everything but during

125
00:06:21,790 --> 00:06:27,340
this incident we did not and it was

126
00:06:23,200 --> 00:06:29,200
painful here's one a cry somewhere it

127
00:06:27,340 --> 00:06:31,869
shouldn't be I think this is an ATM but

128
00:06:29,200 --> 00:06:35,680
I'm not sure because there's like some

129
00:06:31,870 --> 00:06:37,270
weird shit on it the left is definitely

130
00:06:35,680 --> 00:06:40,150
an ATM and then on the right that's a

131
00:06:37,270 --> 00:06:43,450
German train station more places one or

132
00:06:40,150 --> 00:06:45,929
I definitely shouldn't have been and it

133
00:06:43,450 --> 00:06:48,370
also shouldn't have been on that sign

134
00:06:45,930 --> 00:06:51,520
now I really struggle to find pictures

135
00:06:48,370 --> 00:06:54,190
of it in like hospitals and stuff but

136
00:06:51,520 --> 00:06:56,289
this one seems to be legit and it's a

137
00:06:54,190 --> 00:06:57,090
picture of in our radiology department I

138
00:06:56,290 --> 00:07:01,439
think

139
00:06:57,090 --> 00:07:03,539
not great I went searching on toy

140
00:07:01,439 --> 00:07:05,639
terminal found these really good tweets

141
00:07:03,539 --> 00:07:08,120
just about the impact it was having no

142
00:07:05,639 --> 00:07:13,289
basic thing don't come in its like

143
00:07:08,120 --> 00:07:17,279
useless this reddit post was awesome

144
00:07:13,289 --> 00:07:18,960
so me and Marcus didn't really care it's

145
00:07:17,279 --> 00:07:19,979
not that we didn't care but it wasn't a

146
00:07:18,960 --> 00:07:22,020
priority to us

147
00:07:19,979 --> 00:07:24,949
Marcus was on holiday and I was fucking

148
00:07:22,020 --> 00:07:27,900
around with like cyber crimes stuff

149
00:07:24,949 --> 00:07:31,169
until it started fucking with the NHS

150
00:07:27,900 --> 00:07:33,150
and you know like like compromised a

151
00:07:31,169 --> 00:07:33,659
random organisation in the UK who gives

152
00:07:33,150 --> 00:07:35,429
a shit

153
00:07:33,659 --> 00:07:37,139
compromised like the National Health

154
00:07:35,430 --> 00:07:40,110
Service and people really start paying

155
00:07:37,139 --> 00:07:46,110
attention so this is my like favorite

156
00:07:40,110 --> 00:07:51,449
quote from that ready same yeah I am

157
00:07:46,110 --> 00:07:53,909
when I sorry when I was speaking to UK

158
00:07:51,449 --> 00:07:56,520
like entire dance community I definitely

159
00:07:53,909 --> 00:07:58,550
said them that a few times and so free

160
00:07:56,520 --> 00:08:02,128
o8 Marcus registered the domain name

161
00:07:58,550 --> 00:08:03,659
like 4 p.m. in the UK it's important

162
00:08:02,129 --> 00:08:05,610
note yeah at this point it was time it

163
00:08:03,659 --> 00:08:07,589
really we didn't know it was a kill

164
00:08:05,610 --> 00:08:09,750
switch we just wanted to know where this

165
00:08:07,589 --> 00:08:13,199
was coming from he didn't actually have

166
00:08:09,750 --> 00:08:14,729
a look at the sample either he just saw

167
00:08:13,199 --> 00:08:17,789
the domain and was that I need to get to

168
00:08:14,729 --> 00:08:20,849
this which is what we would do today as

169
00:08:17,789 --> 00:08:23,580
well so for the next couple hours Marcus

170
00:08:20,849 --> 00:08:28,199
kind of worked independently verifying

171
00:08:23,580 --> 00:08:30,810
what he was seeing and the data we we

172
00:08:28,199 --> 00:08:32,849
had quite a bit big like disconnect it

173
00:08:30,810 --> 00:08:34,349
wasn't uncommon for like one of us to be

174
00:08:32,849 --> 00:08:35,789
working as me and the other one to be

175
00:08:34,349 --> 00:08:38,399
working on something else totally

176
00:08:35,789 --> 00:08:40,260
separately and so it wasn't it toward a

177
00:08:38,399 --> 00:08:42,360
phone call from someone at the UK and

178
00:08:40,260 --> 00:08:44,250
CSE saying did you know Marcus has the

179
00:08:42,360 --> 00:08:47,000
domain I mean he's working on a pupae

180
00:08:44,250 --> 00:08:49,110
Mac was like that's fucking awesome

181
00:08:47,000 --> 00:08:54,300
literally the first thing he did was a

182
00:08:49,110 --> 00:08:57,329
pupae map we didn't know what the hell

183
00:08:54,300 --> 00:09:01,290
to do so we just tweeted because it was

184
00:08:57,329 --> 00:09:04,319
awesome like we had the domain name were

185
00:09:01,290 --> 00:09:08,010
not an AV vendor like we don't have to

186
00:09:04,320 --> 00:09:10,520
deploy patches or push out signatures so

187
00:09:08,010 --> 00:09:13,110
let's just shit post instead

188
00:09:10,520 --> 00:09:14,280
you know it was a massive S&B worm

189
00:09:13,110 --> 00:09:18,900
spreading around the internet it was

190
00:09:14,280 --> 00:09:20,579
pretty bad and pretty scary as well so I

191
00:09:18,900 --> 00:09:23,720
managed to find some really old

192
00:09:20,580 --> 00:09:26,640
conversations between me and Marcus and

193
00:09:23,720 --> 00:09:28,590
so in this case he's asking me to check

194
00:09:26,640 --> 00:09:31,980
the sample to see if there's anything in

195
00:09:28,590 --> 00:09:34,170
there as special there's because a lot

196
00:09:31,980 --> 00:09:36,030
of the cybercrime stuff we monitor uses

197
00:09:34,170 --> 00:09:38,640
a DJ or a domain generation algorithm

198
00:09:36,030 --> 00:09:41,520
and that means it would rotate out the

199
00:09:38,640 --> 00:09:42,630
domains very regularly so like some DJ's

200
00:09:41,520 --> 00:09:44,189
you have to register something like

201
00:09:42,630 --> 00:09:46,500
every three days and you might need like

202
00:09:44,190 --> 00:09:48,480
ten or fifteen domains every three days

203
00:09:46,500 --> 00:09:50,360
just to have like full visibility it

204
00:09:48,480 --> 00:09:54,540
sucks

205
00:09:50,360 --> 00:09:57,300
so 6:28 p.m. I was like think we can

206
00:09:54,540 --> 00:09:58,920
stop this we'd already stopped it by

207
00:09:57,300 --> 00:10:02,609
registering the domain and having it

208
00:09:58,920 --> 00:10:04,579
resolved yeah we didn't really know

209
00:10:02,610 --> 00:10:07,770
what's going on

210
00:10:04,580 --> 00:10:10,440
so this is what I was looking at when

211
00:10:07,770 --> 00:10:13,590
Marcus asked me to look at it and and

212
00:10:10,440 --> 00:10:17,310
this is very very very very very simple

213
00:10:13,590 --> 00:10:18,750
apart from when the like Fae of the NHS

214
00:10:17,310 --> 00:10:20,579
and you've got like the government on

215
00:10:18,750 --> 00:10:22,650
the other side of the phone going what's

216
00:10:20,580 --> 00:10:24,090
going on normally you expect the

217
00:10:22,650 --> 00:10:26,430
government to be giving you the answers

218
00:10:24,090 --> 00:10:34,080
in this case it was asked giving the

219
00:10:26,430 --> 00:10:36,930
government the answers it was shit so

220
00:10:34,080 --> 00:10:39,120
here's kind of the biggest function the

221
00:10:36,930 --> 00:10:42,660
main super really important function and

222
00:10:39,120 --> 00:10:45,570
it basically just opens a website what

223
00:10:42,660 --> 00:10:49,589
is really annoying though is see it

224
00:10:45,570 --> 00:10:54,690
returns a void but if you read the docs

225
00:10:49,590 --> 00:10:57,540
it actually only returns null if it was

226
00:10:54,690 --> 00:10:59,430
unable to make the connection if it can

227
00:10:57,540 --> 00:11:01,920
make the connection it returns a handle

228
00:10:59,430 --> 00:11:05,099
so here's kind of what it looks like

229
00:11:01,920 --> 00:11:07,260
basically you've got a buffer copy the

230
00:11:05,100 --> 00:11:11,220
URL into the buffer you create like a

231
00:11:07,260 --> 00:11:13,140
new internet session and then you take

232
00:11:11,220 --> 00:11:15,210
your internet session the euro islands

233
00:11:13,140 --> 00:11:18,780
and like stupid flags cuz Microsoft and

234
00:11:15,210 --> 00:11:20,220
then if there's a handle in close your

235
00:11:18,780 --> 00:11:22,740
handles because you don't want to handle

236
00:11:20,220 --> 00:11:22,970
leak and then you just return zero but

237
00:11:22,740 --> 00:11:25,370
if

238
00:11:22,970 --> 00:11:26,180
there was like no it would do this like

239
00:11:25,370 --> 00:11:30,560
service shit

240
00:11:26,180 --> 00:11:33,380
which would blow up so at this point me

241
00:11:30,560 --> 00:11:35,030
and Marcus were like I'm not arguing but

242
00:11:33,380 --> 00:11:37,790
we were like have we fixed it have we

243
00:11:35,030 --> 00:11:40,160
not like arguing over the output of this

244
00:11:37,790 --> 00:11:41,839
like either output because neither of us

245
00:11:40,160 --> 00:11:47,540
could really concentrate you know I

246
00:11:41,840 --> 00:11:51,770
either sucks at the best of times so

247
00:11:47,540 --> 00:11:56,240
yeah I didn't do a good job at

248
00:11:51,770 --> 00:12:05,090
communicating this with Marcus our

249
00:11:56,240 --> 00:12:06,920
priorities I were on I was on the find

250
00:12:05,090 --> 00:12:09,560
someone at the NCSE in it and they were

251
00:12:06,920 --> 00:12:11,810
like what's going on as I walk and talk

252
00:12:09,560 --> 00:12:13,819
like Starbucks phases in 12 minutes

253
00:12:11,810 --> 00:12:18,680
so it's gonna be a really long night

254
00:12:13,820 --> 00:12:20,390
like fucking I'm going to Starbucks no

255
00:12:18,680 --> 00:12:23,060
one knew what was going on like I said

256
00:12:20,390 --> 00:12:26,740
like the NSA are the Sky News work or

257
00:12:23,060 --> 00:12:29,989
Nyssa NSA back door as if it's that easy

258
00:12:26,740 --> 00:12:32,690
and all we were seeing was like the

259
00:12:29,990 --> 00:12:35,960
media Twitter and are like the fucking

260
00:12:32,690 --> 00:12:37,730
pupae map just lighting up and so each

261
00:12:35,960 --> 00:12:43,550
one of these represents a prevented

262
00:12:37,730 --> 00:12:48,260
infection yeah we were just like we need

263
00:12:43,550 --> 00:12:50,500
to keep this up a blank slide Oh No here

264
00:12:48,260 --> 00:12:50,500
we go

265
00:12:53,690 --> 00:13:00,110
this morning office one assertion turned

266
00:12:56,930 --> 00:13:07,010
up and said unfortunately we've been

267
00:13:00,110 --> 00:13:07,010
[Music]

268
00:13:07,020 --> 00:13:12,540
a bunch of I was sitting behind his

269
00:13:09,870 --> 00:13:16,620
penis trying to disturb people eyes I

270
00:13:12,540 --> 00:13:18,839
had a lady who had she'll be exactly

271
00:13:16,620 --> 00:13:21,900
which identity could paralyze her

272
00:13:18,840 --> 00:13:26,400
accountant we had to divert her to other

273
00:13:21,900 --> 00:13:28,350
Hospital I really like was scaring me my

274
00:13:26,400 --> 00:13:30,810
father less significant issues with our

275
00:13:28,350 --> 00:13:34,020
IT systems we can't access any patient

276
00:13:30,810 --> 00:13:34,890
records result prescription requests so

277
00:13:34,020 --> 00:13:39,770
we're here

278
00:13:34,890 --> 00:13:39,770
surgery is open but we've got very

279
00:13:42,170 --> 00:13:45,339
[Music]

280
00:13:50,340 --> 00:13:53,450
[Music]

281
00:13:54,700 --> 00:13:59,380
yeah I mean at least it told me instead

282
00:13:57,280 --> 00:14:35,100
of just turning off because that would

283
00:13:59,380 --> 00:14:35,100
be a pretty nice thing so it was like

284
00:14:35,520 --> 00:14:40,900
very tired at this point so sleep is

285
00:14:38,980 --> 00:14:45,660
like a really major thing during one I

286
00:14:40,900 --> 00:14:48,040
cry so let's get this shitty animation

287
00:14:45,660 --> 00:14:50,439
so on the first day of one of hours

288
00:14:48,040 --> 00:14:54,400
awake for 19 hours the second day 18

289
00:14:50,440 --> 00:14:57,480
hours third day 19 fourth day 21 and on

290
00:14:54,400 --> 00:15:00,730
the fifth day I finally slept 15 hours

291
00:14:57,480 --> 00:15:02,590
this might not seem too bad but when

292
00:15:00,730 --> 00:15:05,440
you're sleeping on your sofa with your

293
00:15:02,590 --> 00:15:07,480
MacBook and everything not on silent

294
00:15:05,440 --> 00:15:10,510
waking up every time you receive a text

295
00:15:07,480 --> 00:15:14,320
Skype message slag whatever you don't

296
00:15:10,510 --> 00:15:16,660
sleep yeah didn't sleep in my bed for

297
00:15:14,320 --> 00:15:18,670
like five days because I just wanted to

298
00:15:16,660 --> 00:15:22,170
stay awake for this entire thing but

299
00:15:18,670 --> 00:15:24,490
that's what they seemed possible and

300
00:15:22,170 --> 00:15:28,599
next day Saturday it's just kind of when

301
00:15:24,490 --> 00:15:30,850
it's only really just beginning so I

302
00:15:28,600 --> 00:15:31,870
mentioned earlier we tracked Mirai or we

303
00:15:30,850 --> 00:15:34,030
did

304
00:15:31,870 --> 00:15:36,760
it's like shitty beside let's not even

305
00:15:34,030 --> 00:15:38,680
cybercrime it's like children with bond

306
00:15:36,760 --> 00:15:42,490
that's some of the actors with it were

307
00:15:38,680 --> 00:15:46,150
quite sophisticated though and some of

308
00:15:42,490 --> 00:15:50,890
them decided fuck Marcus and went for

309
00:15:46,150 --> 00:15:55,319
the kill switch it's kind of our

310
00:15:50,890 --> 00:15:57,850
reaction to press accidental hero

311
00:15:55,320 --> 00:15:59,830
something that went around a lot but

312
00:15:57,850 --> 00:16:03,600
this wasn't really important for us

313
00:15:59,830 --> 00:16:05,950
the press was scary and like it kind of

314
00:16:03,600 --> 00:16:08,680
communicate how bad this really was to

315
00:16:05,950 --> 00:16:11,350
us but what was really bad was

316
00:16:08,680 --> 00:16:14,579
seeing the legitimate requests mixed in

317
00:16:11,350 --> 00:16:16,420
with DDoS attacks in our access logs

318
00:16:14,579 --> 00:16:20,618
they were everywhere

319
00:16:16,420 --> 00:16:23,410
and they just didn't stop this is our

320
00:16:20,619 --> 00:16:25,240
internal telemetry telling us about the

321
00:16:23,410 --> 00:16:26,769
attacks we're seeing my favorite one is

322
00:16:25,240 --> 00:16:29,189
this one where they attack the entire

323
00:16:26,769 --> 00:16:32,860
site with the path of crime or bitch

324
00:16:29,189 --> 00:16:34,809
they weren't fans of Marcos so yeah we

325
00:16:32,860 --> 00:16:37,559
were seeing this being attacked and the

326
00:16:34,809 --> 00:16:40,629
kill switches and basically everything

327
00:16:37,559 --> 00:16:43,149
more news the news just didn't stop it

328
00:16:40,629 --> 00:16:46,959
was a huge media cycle for them but the

329
00:16:43,149 --> 00:16:49,149
impact it had on us was kind of it made

330
00:16:46,959 --> 00:16:52,118
everything worse because we were always

331
00:16:49,149 --> 00:16:54,189
more aware of what was going on which

332
00:16:52,119 --> 00:16:57,040
sucked so this is a conversation between

333
00:16:54,189 --> 00:16:59,410
me and the CEO on the Saturday where I'm

334
00:16:57,040 --> 00:17:01,809
communicating that if our sinkholes go

335
00:16:59,410 --> 00:17:03,670
down or something breaks everyone gets

336
00:17:01,809 --> 00:17:07,720
infected and he's like who's watching

337
00:17:03,670 --> 00:17:12,819
this unlike the entire world and I felt

338
00:17:07,720 --> 00:17:14,500
like that very much at the time I said

339
00:17:12,819 --> 00:17:16,688
you know like if I service go down we

340
00:17:14,500 --> 00:17:18,849
can spin up more we we were using the

341
00:17:16,689 --> 00:17:19,990
data for telemetry so line metric was

342
00:17:18,849 --> 00:17:21,549
really important because we were

343
00:17:19,990 --> 00:17:23,459
searched airing this with law

344
00:17:21,549 --> 00:17:26,408
enforcement agents communities the certs

345
00:17:23,459 --> 00:17:28,980
people like that to find the devices and

346
00:17:26,409 --> 00:17:32,260
get them off the internet and patched

347
00:17:28,980 --> 00:17:34,450
but he said you know at this point it's

348
00:17:32,260 --> 00:17:38,220
it's worth more just keeping it alive

349
00:17:34,450 --> 00:17:41,710
for certain than having that telemetry

350
00:17:38,220 --> 00:17:45,130
so we killed it at that point now this

351
00:17:41,710 --> 00:17:47,690
is Sky News entire day

352
00:17:45,130 --> 00:18:26,559
[Music]

353
00:17:47,690 --> 00:18:26,559
this is today but we are deploying a

354
00:18:30,879 --> 00:18:43,519
most important so I mentioned NCSE a few

355
00:18:40,100 --> 00:18:45,110
times they were fucking awesome they

356
00:18:43,519 --> 00:18:46,850
were doing welfare checks for me and

357
00:18:45,110 --> 00:18:48,709
Marcus you know ringing us up making

358
00:18:46,850 --> 00:18:50,928
sure we hadn't like jumped off the roofs

359
00:18:48,710 --> 00:18:54,919
of wherever you lived making sure were

360
00:18:50,929 --> 00:18:57,980
ok offering a support they were really

361
00:18:54,919 --> 00:18:59,929
good yeah I mean like there's a blog

362
00:18:57,980 --> 00:19:01,850
post on their website with like malware

363
00:18:59,929 --> 00:19:03,470
tech as the author and the wrestlers

364
00:19:01,850 --> 00:19:05,360
like the authors like all government

365
00:19:03,470 --> 00:19:10,789
people with like first name last initial

366
00:19:05,360 --> 00:19:14,959
it's really cool sunday is what I call

367
00:19:10,789 --> 00:19:17,658
fuck the press day as soon a day max got

368
00:19:14,960 --> 00:19:19,639
doxxed and you know like regardless of

369
00:19:17,659 --> 00:19:22,129
what you think about him and like his

370
00:19:19,639 --> 00:19:24,049
case and stuff the fact that like the UK

371
00:19:22,129 --> 00:19:28,959
media went after him like this is really

372
00:19:24,049 --> 00:19:28,960
shit I actually have anis

373
00:19:31,169 --> 00:19:39,219
so I luckily didn't get rekt by the

374
00:19:35,200 --> 00:19:41,080
media but I had an escape route so I had

375
00:19:39,219 --> 00:19:42,669
like a side door into my flat and I was

376
00:19:41,080 --> 00:19:44,439
gonna go like go out the back and like

377
00:19:42,669 --> 00:19:47,289
someone was gonna like come pick me up

378
00:19:44,440 --> 00:19:49,840
and I just stay there for a while it was

379
00:19:47,289 --> 00:19:52,149
a genuine concern for us I think Marcus

380
00:19:49,840 --> 00:19:55,330
was actually jumping over his like the

381
00:19:52,149 --> 00:19:56,949
back garden gate to get out because

382
00:19:55,330 --> 00:20:00,249
there were so many like press in the

383
00:19:56,950 --> 00:20:02,379
front and I went out on the Sunday and

384
00:20:00,249 --> 00:20:04,539
brought all the papers it's really weird

385
00:20:02,379 --> 00:20:08,529
having your boss on the front page of

386
00:20:04,539 --> 00:20:10,869
all the major like news like yeah

387
00:20:08,529 --> 00:20:15,249
Marcus's mom reads the daily mounds like

388
00:20:10,869 --> 00:20:17,859
why is my son on the front page so we

389
00:20:15,249 --> 00:20:19,690
had that that kind of pressure and then

390
00:20:17,859 --> 00:20:23,678
we had more DDoS more and more and more

391
00:20:19,690 --> 00:20:27,279
it got a lot worse this is actually from

392
00:20:23,679 --> 00:20:29,320
Russian IP addresses and there's this

393
00:20:27,279 --> 00:20:31,149
like whole meme about attribution and IP

394
00:20:29,320 --> 00:20:33,339
based search bution but all we were

395
00:20:31,149 --> 00:20:35,408
seeing was like Russian IP addresses

396
00:20:33,339 --> 00:20:38,139
slamming the kill switch this wasn't

397
00:20:35,409 --> 00:20:39,940
like Mirai this was like an actual like

398
00:20:38,139 --> 00:20:43,599
real botnet with some actual power

399
00:20:39,940 --> 00:20:46,450
causing actual outages I don't think

400
00:20:43,599 --> 00:20:49,359
there were too many issues but we were

401
00:20:46,450 --> 00:20:50,799
seeing like actual sinkholes go down and

402
00:20:49,359 --> 00:20:53,349
we just kept replacing them it was like

403
00:20:50,799 --> 00:20:55,299
whack-a-mole we weren't sleeping we were

404
00:20:53,349 --> 00:20:56,109
just watching this shit happen in real

405
00:20:55,299 --> 00:21:02,619
time

406
00:20:56,109 --> 00:21:04,539
more DDoS so much DDoS fuck dealers by

407
00:21:02,619 --> 00:21:07,478
the 15th it was like how many more days

408
00:21:04,539 --> 00:21:10,029
of this shit that we have like how how

409
00:21:07,479 --> 00:21:11,559
long until we have a solution how long

410
00:21:10,029 --> 00:21:16,059
until it stops and obviously it doesn't

411
00:21:11,559 --> 00:21:18,639
stop during the weekend though InfoSec

412
00:21:16,059 --> 00:21:20,859
twitter glorious InfoSec twitter ahead

413
00:21:18,639 --> 00:21:23,889
noticed this on an AV vendors website

414
00:21:20,859 --> 00:21:27,820
and it was the NHS is totally protected

415
00:21:23,889 --> 00:21:31,949
with insert your AV vendor name here I'm

416
00:21:27,820 --> 00:21:34,570
gonna yeah can neither confirm nor deny

417
00:21:31,950 --> 00:21:36,729
yeah and then they actually had someone

418
00:21:34,570 --> 00:21:40,599
come in during the weekend to update

419
00:21:36,729 --> 00:21:42,970
their website like they obviously cared

420
00:21:40,599 --> 00:21:44,950
and now there's

421
00:21:42,970 --> 00:21:46,240
is where things that really fun will

422
00:21:44,950 --> 00:21:50,470
love law enforcement

423
00:21:46,240 --> 00:21:54,309
they're great they seize two of our

424
00:21:50,470 --> 00:21:57,130
servers in France about two hours before

425
00:21:54,309 --> 00:22:00,639
we got this letter don't know why never

426
00:21:57,130 --> 00:22:02,470
got them back cheers for that and so

427
00:22:00,640 --> 00:22:05,110
here's kind of how the kill switch

428
00:22:02,470 --> 00:22:07,690
worked so we registered the main that

429
00:22:05,110 --> 00:22:11,439
donated their domain name with namecheap

430
00:22:07,690 --> 00:22:13,720
and then we had the AWS route 53 name

431
00:22:11,440 --> 00:22:16,600
servers set on that and then they were

432
00:22:13,720 --> 00:22:19,809
pointing to some ec2 instances and some

433
00:22:16,600 --> 00:22:22,000
OVH Canadia servers and Francis the

434
00:22:19,809 --> 00:22:25,000
French ones are the ones we lost

435
00:22:22,000 --> 00:22:28,809
yeah cheers for that on top of that we

436
00:22:25,000 --> 00:22:30,390
had nginx PHP fbm and PHP ask our single

437
00:22:28,809 --> 00:22:32,710
stack fucking sucked

438
00:22:30,390 --> 00:22:34,450
not that we weren't configured for this

439
00:22:32,710 --> 00:22:36,760
we weren't ready for DDoS attacks you

440
00:22:34,450 --> 00:22:41,020
know we were just like sync calling some

441
00:22:36,760 --> 00:22:43,539
shitty cybercrime and like apt stuff so

442
00:22:41,020 --> 00:22:45,700
this is kind of a kill switch code at

443
00:22:43,539 --> 00:22:47,950
the time so we get the URI the user

444
00:22:45,700 --> 00:22:51,460
agent the host name and then we checked

445
00:22:47,950 --> 00:22:54,360
the host and the user agent and we play

446
00:22:51,460 --> 00:22:58,020
some music if you were a human being and

447
00:22:54,360 --> 00:22:58,020
how do I get my mouse

448
00:23:07,560 --> 00:23:12,750
ago thing the sinkhole so they see the

449
00:23:10,440 --> 00:23:15,480
malware go to the kill switch be like

450
00:23:12,750 --> 00:23:18,480
what the hell is this why is it playing

451
00:23:15,480 --> 00:23:22,470
this music or maybe the actors are into

452
00:23:18,480 --> 00:23:26,310
this yeah Marcus if that was fucking

453
00:23:22,470 --> 00:23:28,350
great his like the rest of the code so

454
00:23:26,310 --> 00:23:30,030
we get source IP destination you know

455
00:23:28,350 --> 00:23:33,360
all this kind of stuff use for like

456
00:23:30,030 --> 00:23:36,149
detection and we pay into a UDP packet

457
00:23:33,360 --> 00:23:38,129
and then we'd send it to a sinkhole and

458
00:23:36,150 --> 00:23:39,570
we'd respond with this kind of sinkhole

459
00:23:38,130 --> 00:23:42,750
Tech where the bots spy harder and the

460
00:23:39,570 --> 00:23:47,220
researchers harder found that out in

461
00:23:42,750 --> 00:23:49,770
Vegas so on the 15th we were getting

462
00:23:47,220 --> 00:23:52,160
sick of DDoS and we'd already kind of

463
00:23:49,770 --> 00:23:55,620
spoken to the CEO about losing telemetry

464
00:23:52,160 --> 00:23:57,300
over kind of keeping this up how many

465
00:23:55,620 --> 00:23:59,659
people in the room do you think could

466
00:23:57,300 --> 00:24:02,040
keep a website up a static website

467
00:23:59,660 --> 00:24:04,620
against no matter what a hundred percent

468
00:24:02,040 --> 00:24:05,730
of the time okay I'm glad know and put

469
00:24:04,620 --> 00:24:10,290
their hands up because I still don't

470
00:24:05,730 --> 00:24:12,720
think I can do it so to this day we're

471
00:24:10,290 --> 00:24:15,180
still work ladler we're on their

472
00:24:12,720 --> 00:24:16,260
Enterprise plan for free enterprise

473
00:24:15,180 --> 00:24:19,620
registrar

474
00:24:16,260 --> 00:24:22,500
they are awesome we wouldn't be sleeping

475
00:24:19,620 --> 00:24:24,810
without them they actually developed

476
00:24:22,500 --> 00:24:28,440
some custom software to ship the logs

477
00:24:24,810 --> 00:24:30,480
from their end to us in real time while

478
00:24:28,440 --> 00:24:33,060
the incident was ongoing they didn't

479
00:24:30,480 --> 00:24:34,800
have this they wrote it for us we used

480
00:24:33,060 --> 00:24:36,540
it for a year and a half until they

481
00:24:34,800 --> 00:24:38,340
develop it into a natural product and

482
00:24:36,540 --> 00:24:41,159
now we use the real you know good

483
00:24:38,340 --> 00:24:43,649
version but yeah like huge props to

484
00:24:41,160 --> 00:24:46,140
raise guys now at this point

485
00:24:43,650 --> 00:24:47,610
everything's kind of a blur I was not

486
00:24:46,140 --> 00:24:49,590
really expecting about wanna cry for

487
00:24:47,610 --> 00:24:53,100
like two years so when Brian was like

488
00:24:49,590 --> 00:24:54,689
talk about wanna crimes like really so I

489
00:24:53,100 --> 00:24:56,730
had to like go fishing out of every I

490
00:24:54,690 --> 00:24:59,250
actually spent like four hours one night

491
00:24:56,730 --> 00:25:01,290
trying to find my old Twitter logs I

492
00:24:59,250 --> 00:25:05,250
couldn't find them which is probably a

493
00:25:01,290 --> 00:25:07,590
good thing so because kind of struggle

494
00:25:05,250 --> 00:25:09,840
with data we've got some really nice

495
00:25:07,590 --> 00:25:13,560
data Cisco and brother if I do this from

496
00:25:09,840 --> 00:25:15,959
the time and you know it kind of you can

497
00:25:13,560 --> 00:25:18,090
see it increasing and on the 16th after

498
00:25:15,960 --> 00:25:21,180
we moved to cloud blur we got absolutely

499
00:25:18,090 --> 00:25:22,949
hammered by Dean DNS attack and

500
00:25:21,180 --> 00:25:25,980
I think it would have gone down if we

501
00:25:22,950 --> 00:25:28,410
weren't with them and we had moved now

502
00:25:25,980 --> 00:25:30,810
this is kind of the statement we made at

503
00:25:28,410 --> 00:25:33,240
the time basically a hundred and fifty

504
00:25:30,810 --> 00:25:35,790
thousand unique IP addresses who reached

505
00:25:33,240 --> 00:25:38,010
out to us in two days but because of the

506
00:25:35,790 --> 00:25:40,590
kill switch and how it all works you've

507
00:25:38,010 --> 00:25:43,410
got things like gnats and all sorts of

508
00:25:40,590 --> 00:25:46,980
bullshit and basically because of that

509
00:25:43,410 --> 00:25:49,350
you can see multiple hits per an IP

510
00:25:46,980 --> 00:25:51,660
address and from that you can kind of

511
00:25:49,350 --> 00:25:53,610
expedite the number of hosts behind it

512
00:25:51,660 --> 00:25:54,870
but it's not hard to do accurately

513
00:25:53,610 --> 00:25:57,000
because you know you've got things like

514
00:25:54,870 --> 00:25:59,659
people rebooting their machines so we've

515
00:25:57,000 --> 00:26:04,740
never been able to like properly do this

516
00:25:59,660 --> 00:26:09,180
yeah here's yeah that works

517
00:26:04,740 --> 00:26:11,130
so here's kind of first day it's not too

518
00:26:09,180 --> 00:26:16,140
bad and then spikes still have no idea

519
00:26:11,130 --> 00:26:17,550
what spike it's the first day as well we

520
00:26:16,140 --> 00:26:21,120
had some like issues with our kind of

521
00:26:17,550 --> 00:26:23,730
telemetry so the oldest sinkhole stayed

522
00:26:21,120 --> 00:26:25,560
up the suposse past like infection

523
00:26:23,730 --> 00:26:27,660
processor we had at the time didn't and

524
00:26:25,560 --> 00:26:31,679
so that crashed Wishman we lost data

525
00:26:27,660 --> 00:26:35,010
because there was no kind of buffer this

526
00:26:31,680 --> 00:26:38,340
is terrifying so what you're seeing here

527
00:26:35,010 --> 00:26:41,850
is one a cries ability to fuck you up

528
00:26:38,340 --> 00:26:44,909
even now so on the first day there was

529
00:26:41,850 --> 00:26:48,810
one here the next day 26 the next day 24

530
00:26:44,910 --> 00:26:52,800
they have to about 41 22 17 2015

531
00:26:48,810 --> 00:26:58,139
it's suddenly if any of those fail that

532
00:26:52,800 --> 00:27:01,649
machine gets infected it's horrendous

533
00:26:58,140 --> 00:27:03,120
and this is still a valid issue today we

534
00:27:01,650 --> 00:27:06,540
keep it up we'll see millions of

535
00:27:03,120 --> 00:27:09,389
requests a month like but too many is

536
00:27:06,540 --> 00:27:13,710
pretty bad another thing that happened

537
00:27:09,390 --> 00:27:19,230
muffs got free pizza obviously and vice

538
00:27:13,710 --> 00:27:21,060
obviously wrote about that you know just

539
00:27:19,230 --> 00:27:23,250
didn't get to use it that much just kind

540
00:27:21,060 --> 00:27:25,460
of a shame I actually started hashtag

541
00:27:23,250 --> 00:27:28,860
pizza for to so few

542
00:27:25,460 --> 00:27:30,480
it didn't really work some people make

543
00:27:28,860 --> 00:27:33,030
pizza means as well and they were

544
00:27:30,480 --> 00:27:35,700
terrible but these people were making

545
00:27:33,030 --> 00:27:39,000
means to support the effort it didn't

546
00:27:35,700 --> 00:27:39,870
work so it's my I get the phone call

547
00:27:39,000 --> 00:27:41,750
about his arrest

548
00:27:39,870 --> 00:27:44,010
so me and Marquez were out in Vegas

549
00:27:41,750 --> 00:27:50,610
allegedly for Def Con and blackhat but I

550
00:27:44,010 --> 00:27:52,590
was just getting smashed so I was flying

551
00:27:50,610 --> 00:27:53,219
out the day after Marcus so I get a

552
00:27:52,590 --> 00:27:55,530
phone call

553
00:27:53,220 --> 00:27:57,210
cos I I'm with the FBI can you remove

554
00:27:55,530 --> 00:27:59,190
Marcus's wanna cry kill switch access

555
00:27:57,210 --> 00:28:01,230
I'm like what the fuck like why would I

556
00:27:59,190 --> 00:28:05,790
need to do that so i-i've been arrested

557
00:28:01,230 --> 00:28:07,770
early the fuck so because we have to

558
00:28:05,790 --> 00:28:09,960
move his access a lot of kind of the

559
00:28:07,770 --> 00:28:12,900
graphs and stuff were all tied to him

560
00:28:09,960 --> 00:28:15,030
and so when we moved his access the

561
00:28:12,900 --> 00:28:17,730
graphs went dead and so I had to like

562
00:28:15,030 --> 00:28:20,160
time this with the indictments coming

563
00:28:17,730 --> 00:28:23,100
out so that people didn't start freaking

564
00:28:20,160 --> 00:28:25,110
out over the kill switch going down and

565
00:28:23,100 --> 00:28:27,600
I had to tweet you know saying yeah it's

566
00:28:25,110 --> 00:28:30,270
like because of this not because it's

567
00:28:27,600 --> 00:28:32,610
dead what's really really really weird

568
00:28:30,270 --> 00:28:34,650
North Korea tried to move some not us

569
00:28:32,610 --> 00:28:36,600
and Bitcoin the night here was arrested

570
00:28:34,650 --> 00:28:39,830
I have no idea what that was about but

571
00:28:36,600 --> 00:28:43,530
I'm pretty sure it's just coincidence

572
00:28:39,830 --> 00:28:45,000
so yeah Marcus Stubb and they really

573
00:28:43,530 --> 00:28:49,050
know who's responsible for keeping him

574
00:28:45,000 --> 00:28:50,610
banned I guess it's me like yeah well

575
00:28:49,050 --> 00:28:53,669
maybe the FBI would arrest me if I gave

576
00:28:50,610 --> 00:28:57,929
him access National Audit Office in the

577
00:28:53,670 --> 00:28:59,030
UK did a inaud it into one a crime this

578
00:28:57,930 --> 00:29:04,050
is pretty awesome

579
00:28:59,030 --> 00:29:06,990
so 34 trusts were in fact did 46 weren't

580
00:29:04,050 --> 00:29:08,850
but were in fact reporting disruption

581
00:29:06,990 --> 00:29:10,320
this is because of things like shutting

582
00:29:08,850 --> 00:29:12,449
down their systems because they're wide

583
00:29:10,320 --> 00:29:15,210
or maybe shared systems that have gone

584
00:29:12,450 --> 00:29:16,980
down or when affected there were 21

585
00:29:15,210 --> 00:29:20,460
trusts that tried to call that to the

586
00:29:16,980 --> 00:29:22,920
kill switch but weren't locked as far as

587
00:29:20,460 --> 00:29:24,990
I know these are 21 trusts that weren't

588
00:29:22,920 --> 00:29:30,780
infected because of the kill switch just

589
00:29:24,990 --> 00:29:36,270
pretty fucking cool 603 kind of like NHS

590
00:29:30,780 --> 00:29:39,770
things 595 GPS no NHS organisation pay

591
00:29:36,270 --> 00:29:42,990
the ransom like thank fuck for that

592
00:29:39,770 --> 00:29:46,680
so nineteen thousand appointments

593
00:29:42,990 --> 00:29:48,390
cancelled what's really cool is like we

594
00:29:46,680 --> 00:29:49,590
weren't actually named checked we kind

595
00:29:48,390 --> 00:29:51,900
of were named checked in like an

596
00:29:49,590 --> 00:29:56,520
official government report talking about

597
00:29:51,900 --> 00:29:58,670
the kill switch which was cool nice a

598
00:29:56,520 --> 00:30:01,530
day on this missus from the fifth month

599
00:29:58,670 --> 00:30:03,360
idiots are still trying to take down the

600
00:30:01,530 --> 00:30:06,930
kill switch like actual government

601
00:30:03,360 --> 00:30:09,870
employees see and like kill it it's bad

602
00:30:06,930 --> 00:30:11,580
guy infrastructure people need to change

603
00:30:09,870 --> 00:30:16,080
the way they think about infrastructure

604
00:30:11,580 --> 00:30:18,240
and IOC s we have major issues with the

605
00:30:16,080 --> 00:30:20,010
kill switch the main because people just

606
00:30:18,240 --> 00:30:22,920
spread IOC's and it's like blacklist

607
00:30:20,010 --> 00:30:24,240
that don't say how many things were

608
00:30:22,920 --> 00:30:26,670
probably impacted by that that's

609
00:30:24,240 --> 00:30:30,900
probably quite a few now earlier this

610
00:30:26,670 --> 00:30:34,140
week I Verizon this fuck Verizon I woke

611
00:30:30,900 --> 00:30:36,870
up Tuesday and the internet was kind of

612
00:30:34,140 --> 00:30:38,820
not working and I know someone from

613
00:30:36,870 --> 00:30:41,219
class I was like hi does anyone know

614
00:30:38,820 --> 00:30:43,679
anyone on a s blah blah blah it's like

615
00:30:41,220 --> 00:30:45,480
why and I know says I really coming from

616
00:30:43,680 --> 00:30:48,650
their network and obviously us being

617
00:30:45,480 --> 00:30:54,260
with CloudFlare this is kind of worrying

618
00:30:48,650 --> 00:30:58,410
so this is the above graph is what

619
00:30:54,260 --> 00:31:00,300
horizon no this is what cloud flows

620
00:30:58,410 --> 00:31:02,460
global traffic look like and at the

621
00:31:00,300 --> 00:31:04,860
bottom this is what we saw and we

622
00:31:02,460 --> 00:31:07,730
compared this to the week before and it

623
00:31:04,860 --> 00:31:10,080
doesn't look like we're impactive

624
00:31:07,730 --> 00:31:12,090
basically the IP addresses that they

625
00:31:10,080 --> 00:31:13,560
really tore the prefixes didn't include

626
00:31:12,090 --> 00:31:16,020
the Killswitch IP so we've got quite

627
00:31:13,560 --> 00:31:17,940
lucky that if they fuck this up though

628
00:31:16,020 --> 00:31:20,490
two hundred and twenty two thousand

629
00:31:17,940 --> 00:31:23,100
requests came in during that outage so

630
00:31:20,490 --> 00:31:25,260
that's potentially two hundred and

631
00:31:23,100 --> 00:31:28,110
twenty two thousand unique machines that

632
00:31:25,260 --> 00:31:30,540
would have been affected 37,000 unique

633
00:31:28,110 --> 00:31:32,790
IP addresses in that time it's pretty

634
00:31:30,540 --> 00:31:36,540
bad we learn a lot of lessons from this

635
00:31:32,790 --> 00:31:39,210
so we assume people will fuck things up

636
00:31:36,540 --> 00:31:41,460
systems will fuck things up law

637
00:31:39,210 --> 00:31:45,240
enforcement will attack us like

638
00:31:41,460 --> 00:31:47,730
everyone's going to attack us we we know

639
00:31:45,240 --> 00:31:50,310
we have to scale everything infinitely

640
00:31:47,730 --> 00:31:52,080
you know like PHP isn't gonna work at

641
00:31:50,310 --> 00:31:54,350
this scale we need like something

642
00:31:52,080 --> 00:31:54,350
reliable

643
00:31:55,020 --> 00:31:59,020
we're learning to communicate and

644
00:31:57,130 --> 00:32:00,520
running incidents me and Marcus have

645
00:31:59,020 --> 00:32:02,500
never run an incident before we've never

646
00:32:00,520 --> 00:32:05,139
done in certain response we've never

647
00:32:02,500 --> 00:32:06,940
done anything of this scale so learning

648
00:32:05,140 --> 00:32:08,620
to communicate also learning to like

649
00:32:06,940 --> 00:32:11,140
rotate your people out and making sure

650
00:32:08,620 --> 00:32:12,550
that there's like enough info there that

651
00:32:11,140 --> 00:32:16,390
you can swap someone out at any time

652
00:32:12,550 --> 00:32:17,800
like me and Marcus had died I don't know

653
00:32:16,390 --> 00:32:23,070
who we're talking this over like

654
00:32:17,800 --> 00:32:27,760
hopefully NCSE or someone in the kind of

655
00:32:23,070 --> 00:32:31,030
in five days of wanna cry I did 92 hours

656
00:32:27,760 --> 00:32:33,460
of work it's not fun when the recommend

657
00:32:31,030 --> 00:32:36,490
so why are we doing now this is our

658
00:32:33,460 --> 00:32:38,340
infrastructure now we wrote our own kill

659
00:32:36,490 --> 00:32:40,870
switch stack which is like go

660
00:32:38,340 --> 00:32:44,230
micro-services and then we encode that

661
00:32:40,870 --> 00:32:47,709
data send it to another thing and we put

662
00:32:44,230 --> 00:32:50,800
Kafka everywhere now this means that all

663
00:32:47,710 --> 00:32:53,260
of this shit here can die and it was

664
00:32:50,800 --> 00:32:54,520
fine we'll still have the data Kafka's

665
00:32:53,260 --> 00:32:56,140
fucking awesome if you have any

666
00:32:54,520 --> 00:32:59,379
real-time systems I'd recommend putting

667
00:32:56,140 --> 00:33:01,060
Kafka somewhere in between here's what

668
00:32:59,380 --> 00:33:04,330
we're working on now this is victim

669
00:33:01,060 --> 00:33:06,490
notification and we're kind of trying to

670
00:33:04,330 --> 00:33:08,320
notify all the victims of one a cry and

671
00:33:06,490 --> 00:33:08,950
all the other botnets we track and we do

672
00:33:08,320 --> 00:33:11,850
this for free

673
00:33:08,950 --> 00:33:14,590
we kind of realized post wanna cry that

674
00:33:11,850 --> 00:33:16,510
monetizing victim data is not right and

675
00:33:14,590 --> 00:33:24,429
vendors shouldn't be doing it fuck them

676
00:33:16,510 --> 00:33:26,560
if they're doing it so for wanna cry we

677
00:33:24,430 --> 00:33:29,860
saw 58 million hits in the last 30 days

678
00:33:26,560 --> 00:33:32,740
from 1.6 million unique source IPS from

679
00:33:29,860 --> 00:33:36,250
208 countries this is a global issue and

680
00:33:32,740 --> 00:33:40,360
it still exists thanks for listening to

681
00:33:36,250 --> 00:33:42,100
my talk oh yeah during this talk we

682
00:33:40,360 --> 00:33:44,110
responded this is based on last week's

683
00:33:42,100 --> 00:33:45,909
statistics because of the there's a

684
00:33:44,110 --> 00:33:48,520
backlog system for one on Christ so we

685
00:33:45,910 --> 00:33:50,650
can do in real time but for last week my

686
00:33:48,520 --> 00:33:53,020
talk if I'd done it last week when I

687
00:33:50,650 --> 00:33:57,120
responded to 18,000 requests from 6,000

688
00:33:53,020 --> 00:34:00,190
IP addresses in 122 countries burned

689
00:33:57,120 --> 00:34:00,189
[Music]

690
00:34:06,000 --> 00:34:09,339
thank you very much Jamie you're gonna

691
00:34:08,379 --> 00:34:11,199
stay there for a couple minutes because

692
00:34:09,339 --> 00:34:15,609
I'm gonna guess that there's a few

693
00:34:11,199 --> 00:34:19,000
questions so first of all right okay

694
00:34:15,609 --> 00:34:21,040
okay okay just just give me one minute

695
00:34:19,000 --> 00:34:22,750
with Jamie I personally want to pass on

696
00:34:21,040 --> 00:34:24,609
thanks because I think everybody in this

697
00:34:22,750 --> 00:34:25,510
room has got some thanks to pass on to

698
00:34:24,609 --> 00:34:26,139
you for the work that you've done the

699
00:34:25,510 --> 00:34:29,080
past couple years

700
00:34:26,139 --> 00:34:31,450
so you see Jamie tonight he likes Diet

701
00:34:29,080 --> 00:34:33,190
Coke and vodka just just make sure his

702
00:34:31,449 --> 00:34:33,698
arms are full of dicor vodka Thank You

703
00:34:33,190 --> 00:34:36,789
Jamie

704
00:34:33,699 --> 00:34:36,789
[Applause]

