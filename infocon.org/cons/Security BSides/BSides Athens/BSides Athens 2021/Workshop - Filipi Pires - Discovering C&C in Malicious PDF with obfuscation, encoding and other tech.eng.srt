1
00:00:04,400 --> 00:00:06,080
hello everyone

2
00:00:06,080 --> 00:00:09,599
welcome aboard my name is felipes i'm so

3
00:00:09,599 --> 00:00:10,800
glad to be here to talk

4
00:00:10,800 --> 00:00:13,120
to you for you and today we're going to

5
00:00:13,120 --> 00:00:14,719
talk about discovering cnc

6
00:00:14,719 --> 00:00:18,080
and malicious pdf using

7
00:00:18,080 --> 00:00:19,920
some techniques like you know the

8
00:00:19,920 --> 00:00:21,920
sophistications encoding

9
00:00:21,920 --> 00:00:26,000
any others uh techniques that you we can

10
00:00:26,000 --> 00:00:28,880
see during this workshop during this

11
00:00:28,880 --> 00:00:30,240
conversation

12
00:00:30,240 --> 00:00:33,760
right so let me introduce myself

13
00:00:33,760 --> 00:00:36,800
so it doesn't matter and

14
00:00:36,800 --> 00:00:39,520
who am i but okay anyway i need to

15
00:00:39,520 --> 00:00:40,320
present some

16
00:00:40,320 --> 00:00:43,200
uh contact for me in the social medias

17
00:00:43,200 --> 00:00:45,039
right so i have this

18
00:00:45,039 --> 00:00:48,079
web page and uh you know let me

19
00:00:48,079 --> 00:00:51,600
show you here i have it in my um

20
00:00:51,600 --> 00:00:54,399
virtual machine here so if you'd like to

21
00:00:54,399 --> 00:00:55,600
open your

22
00:00:55,600 --> 00:00:58,160
your avatar machine to you know to

23
00:00:58,160 --> 00:01:00,079
practice with me together

24
00:01:00,079 --> 00:01:02,399
so we can practice together during this

25
00:01:02,399 --> 00:01:04,000
workshop there is this conversation

26
00:01:04,000 --> 00:01:04,720
right so

27
00:01:04,720 --> 00:01:08,640
i have here this um simple kala linux so

28
00:01:08,640 --> 00:01:09,520
you can use in

29
00:01:09,520 --> 00:01:12,960
arcane linux or another linux resolution

30
00:01:12,960 --> 00:01:13,520
is

31
00:01:13,520 --> 00:01:16,720
it's you know for you you can use it

32
00:01:16,720 --> 00:01:18,720
what whatever you prefer right so this

33
00:01:18,720 --> 00:01:19,920
is my home page

34
00:01:19,920 --> 00:01:22,080
it's very simple web page you know

35
00:01:22,080 --> 00:01:23,600
statistical man page

36
00:01:23,600 --> 00:01:26,720
here's information about me and uh

37
00:01:26,720 --> 00:01:27,759
here's some

38
00:01:27,759 --> 00:01:29,520
open source projects that i have been

39
00:01:29,520 --> 00:01:32,240
participating i have been participating

40
00:01:32,240 --> 00:01:34,720
and uh some this project is very

41
00:01:34,720 --> 00:01:36,960
interesting because it's related to uh

42
00:01:36,960 --> 00:01:39,280
a security right so here's it's another

43
00:01:39,280 --> 00:01:41,680
relate to devops and

44
00:01:41,680 --> 00:01:44,399
to help the developers using you know

45
00:01:44,399 --> 00:01:44,960
the

46
00:01:44,960 --> 00:01:47,040
this kind of projects using for example

47
00:01:47,040 --> 00:01:49,920
in a mobile project and web applications

48
00:01:49,920 --> 00:01:51,680
and whatever here's it's another

49
00:01:51,680 --> 00:01:53,360
difference works with uh

50
00:01:53,360 --> 00:01:56,320
different um cycles and something like

51
00:01:56,320 --> 00:01:56,640
that

52
00:01:56,640 --> 00:01:59,520
right so here some presentations some

53
00:01:59,520 --> 00:02:01,200
talks that i did

54
00:02:01,200 --> 00:02:03,520
that i made in some events probably in

55
00:02:03,520 --> 00:02:05,040
the future this workshop

56
00:02:05,040 --> 00:02:08,160
will be here in this website

57
00:02:08,160 --> 00:02:09,679
and here if you'd like to see some

58
00:02:09,679 --> 00:02:11,680
articles about

59
00:02:11,680 --> 00:02:13,760
about me but about some testing that i

60
00:02:13,760 --> 00:02:14,879
made that i did

61
00:02:14,879 --> 00:02:16,879
or you know whatever so here's some

62
00:02:16,879 --> 00:02:18,239
articles

63
00:02:18,239 --> 00:02:21,040
that was published right so let's return

64
00:02:21,040 --> 00:02:22,239
my presentations

65
00:02:22,239 --> 00:02:25,520
again i have been you know i used a lot

66
00:02:25,520 --> 00:02:28,480
twitter and github and uh and linkedin

67
00:02:28,480 --> 00:02:29,520
this is the main

68
00:02:29,520 --> 00:02:31,519
social medias that i have been working

69
00:02:31,519 --> 00:02:32,959
right so

70
00:02:32,959 --> 00:02:34,879
i i have been working at security

71
00:02:34,879 --> 00:02:36,560
research and security advocate at

72
00:02:36,560 --> 00:02:37,680
supernovation

73
00:02:37,680 --> 00:02:39,519
it's a brazilian company and i'm

74
00:02:39,519 --> 00:02:40,800
advocating from this

75
00:02:40,800 --> 00:02:43,680
uh awesome project hack is not a crime

76
00:02:43,680 --> 00:02:44,239
because

77
00:02:44,239 --> 00:02:46,879
uh i would like to talk more about this

78
00:02:46,879 --> 00:02:47,599
for you

79
00:02:47,599 --> 00:02:49,760
it's um you know it's a very good

80
00:02:49,760 --> 00:02:51,519
project um

81
00:02:51,519 --> 00:02:53,840
initiative actually and the idea is to

82
00:02:53,840 --> 00:02:57,280
explain more about the people about this

83
00:02:57,280 --> 00:02:59,599
this thing and this concept right

84
00:02:59,599 --> 00:03:01,599
because hacking it's really not a crime

85
00:03:01,599 --> 00:03:05,599
it's a life cycle uh my life cycles are

86
00:03:05,599 --> 00:03:06,480
is a

87
00:03:06,480 --> 00:03:09,519
lifestyle right it's a creative mind

88
00:03:09,519 --> 00:03:12,000
when you see some software when you work

89
00:03:12,000 --> 00:03:13,040
with uh you know

90
00:03:13,040 --> 00:03:15,440
discover something and this is the

91
00:03:15,440 --> 00:03:16,159
focuses

92
00:03:16,159 --> 00:03:18,640
about this project right so i am as part

93
00:03:18,640 --> 00:03:19,680
of the staff team

94
00:03:19,680 --> 00:03:23,360
of the dcg dcg 511 in sao paulo here in

95
00:03:23,360 --> 00:03:24,400
brazil by the way

96
00:03:24,400 --> 00:03:27,120
i am talking here from sao paulo in my

97
00:03:27,120 --> 00:03:28,879
small office here as you can see behind

98
00:03:28,879 --> 00:03:29,440
me

99
00:03:29,440 --> 00:03:32,560
is my balcony you know i have here some

100
00:03:32,560 --> 00:03:36,080
uh apartment buildings behind me and uh

101
00:03:36,080 --> 00:03:37,840
yes i am security research and

102
00:03:37,840 --> 00:03:40,640
instructor about the portuguese courses

103
00:03:40,640 --> 00:03:42,400
in the hacker security it's a brazilian

104
00:03:42,400 --> 00:03:44,239
company and i'm structure

105
00:03:44,239 --> 00:03:46,799
and the writer and reviewer for the

106
00:03:46,799 --> 00:03:47,920
three magazine

107
00:03:47,920 --> 00:03:50,480
and i have one course about the malware

108
00:03:50,480 --> 00:03:51,680
hunting

109
00:03:51,680 --> 00:03:54,239
right guys so let's talk about our

110
00:03:54,239 --> 00:03:56,319
summary today

111
00:03:56,319 --> 00:03:58,159
first of all i'd like to explain more

112
00:03:58,159 --> 00:04:00,400
details just a concept actually about

113
00:04:00,400 --> 00:04:01,519
the what is

114
00:04:01,519 --> 00:04:03,599
thread and after that we'll explain more

115
00:04:03,599 --> 00:04:05,280
about them our analysis those first

116
00:04:05,280 --> 00:04:06,080
steps

117
00:04:06,080 --> 00:04:07,760
and i will talk about in the end of this

118
00:04:07,760 --> 00:04:10,400
workshop about the structure of the pdf

119
00:04:10,400 --> 00:04:12,640
and i will explain about the demo and i

120
00:04:12,640 --> 00:04:14,480
will open to

121
00:04:14,480 --> 00:04:17,680
you to answer some questions right so

122
00:04:17,680 --> 00:04:20,160
again uh if you'd like to open your

123
00:04:20,160 --> 00:04:22,000
virtual machine during this conversation

124
00:04:22,000 --> 00:04:24,320
during this conversation

125
00:04:24,320 --> 00:04:27,360
no my goodness during this conversation

126
00:04:27,360 --> 00:04:30,400
it was pretty cool right so what is

127
00:04:30,400 --> 00:04:31,120
threat

128
00:04:31,120 --> 00:04:33,120
first of all it's just a concept

129
00:04:33,120 --> 00:04:34,560
according this is it's not

130
00:04:34,560 --> 00:04:36,720
my definitions right it's a definition

131
00:04:36,720 --> 00:04:37,759
for this iso

132
00:04:37,759 --> 00:04:41,120
thread is defined as a potential what

133
00:04:41,120 --> 00:04:42,880
potential cause of an incident

134
00:04:42,880 --> 00:04:45,759
right so maybe you know it may cause

135
00:04:45,759 --> 00:04:47,840
harm to the system organizations

136
00:04:47,840 --> 00:04:51,280
but it means why what flipping exactly

137
00:04:51,280 --> 00:04:55,120
it's a kind of softer attacks or maybe a

138
00:04:55,120 --> 00:04:57,120
death of intellectual intellectual

139
00:04:57,120 --> 00:04:58,880
property or maybe

140
00:04:58,880 --> 00:05:02,000
identity death right it's very common

141
00:05:02,000 --> 00:05:04,960
and the sabot sabotage and information

142
00:05:04,960 --> 00:05:05,759
distortions

143
00:05:05,759 --> 00:05:08,960
are example of the information security

144
00:05:08,960 --> 00:05:12,160
threats it means all those

145
00:05:12,160 --> 00:05:15,440
things it is threat right so uh

146
00:05:15,440 --> 00:05:17,440
everything is related to a software

147
00:05:17,440 --> 00:05:19,520
right so when you build something like

148
00:05:19,520 --> 00:05:22,479
you know some applications and apps for

149
00:05:22,479 --> 00:05:24,160
them to use in an ios

150
00:05:24,160 --> 00:05:27,280
or android it's uh it's a software

151
00:05:27,280 --> 00:05:29,759
right and if you have some hardware

152
00:05:29,759 --> 00:05:30,720
probably you have some

153
00:05:30,720 --> 00:05:34,080
uh a layer of the firmware or

154
00:05:34,080 --> 00:05:36,400
you know some application behind and a

155
00:05:36,400 --> 00:05:38,000
software if you have an appliance you

156
00:05:38,000 --> 00:05:39,759
have a software there

157
00:05:39,759 --> 00:05:42,639
it means you know everything it's

158
00:05:42,639 --> 00:05:44,240
related to a software so when you have

159
00:05:44,240 --> 00:05:44,639
some

160
00:05:44,639 --> 00:05:47,840
at software attack is it is a threat

161
00:05:47,840 --> 00:05:49,759
right so and of course when you produce

162
00:05:49,759 --> 00:05:52,080
something when you

163
00:05:52,080 --> 00:05:54,720
is a software house for example and you

164
00:05:54,720 --> 00:05:56,960
have some tough intellectual property or

165
00:05:56,960 --> 00:06:00,479
if they death is related to a threat so

166
00:06:00,479 --> 00:06:01,199
all those

167
00:06:01,199 --> 00:06:03,919
thing is threat why i need to understand

168
00:06:03,919 --> 00:06:05,120
about that flip

169
00:06:05,120 --> 00:06:07,360
because when you see about that you need

170
00:06:07,360 --> 00:06:08,400
to understand

171
00:06:08,400 --> 00:06:12,319
when you receive some software or some

172
00:06:12,319 --> 00:06:15,360
artifact you need to understand

173
00:06:15,360 --> 00:06:18,720
if this software it was malicious or not

174
00:06:18,720 --> 00:06:20,880
in this case this is the first step

175
00:06:20,880 --> 00:06:21,759
right so the

176
00:06:21,759 --> 00:06:24,720
identification is stopped it's a simple

177
00:06:24,720 --> 00:06:26,240
uh

178
00:06:26,240 --> 00:06:29,520
life cycle uh of course it's just

179
00:06:29,520 --> 00:06:32,639
one opinion and i see this a good life

180
00:06:32,639 --> 00:06:33,440
cycle from

181
00:06:33,440 --> 00:06:36,639
a friend a brazilian friend right so uh

182
00:06:36,639 --> 00:06:39,120
and you in this step it's very important

183
00:06:39,120 --> 00:06:39,840
because

184
00:06:39,840 --> 00:06:42,960
uh you can decide not decide you you

185
00:06:42,960 --> 00:06:44,800
need to understand if this

186
00:06:44,800 --> 00:06:47,280
artifact or this simple right is

187
00:06:47,280 --> 00:06:48,639
malicious or not

188
00:06:48,639 --> 00:06:52,479
in this case probably if is malicious

189
00:06:52,479 --> 00:06:55,039
you have a maor or maldot which means

190
00:06:55,039 --> 00:06:56,960
maori it's a softer malicious and maldoc

191
00:06:56,960 --> 00:06:58,080
it's obviously

192
00:06:58,080 --> 00:07:00,319
malicious document and after the

193
00:07:00,319 --> 00:07:02,000
identification step you can choose

194
00:07:02,000 --> 00:07:04,160
what the best strategy or method to

195
00:07:04,160 --> 00:07:05,199
apply in this

196
00:07:05,199 --> 00:07:07,759
analysis you can define is if we will

197
00:07:07,759 --> 00:07:08,639
use in a

198
00:07:08,639 --> 00:07:11,039
statistic analysis right or dynamic

199
00:07:11,039 --> 00:07:11,919
analysis

200
00:07:11,919 --> 00:07:14,960
and after that you can produce

201
00:07:14,960 --> 00:07:16,800
something very interesting then usually

202
00:07:16,800 --> 00:07:18,639
the manager and the coordinators exactly

203
00:07:18,639 --> 00:07:19,840
it's like a lot

204
00:07:19,840 --> 00:07:22,639
right it means it's a report because you

205
00:07:22,639 --> 00:07:24,319
can present that with

206
00:07:24,319 --> 00:07:27,840
your leader right because when you make

207
00:07:27,840 --> 00:07:29,280
some analysis you can produce this

208
00:07:29,280 --> 00:07:30,479
report so

209
00:07:30,479 --> 00:07:33,199
after this report when your manager or

210
00:07:33,199 --> 00:07:34,639
your boss has

211
00:07:34,639 --> 00:07:38,160
um this report on the table

212
00:07:38,160 --> 00:07:42,240
you can do another actions what

213
00:07:42,240 --> 00:07:45,039
is the next steps step you can improve

214
00:07:45,039 --> 00:07:47,199
your defenses mechanism because

215
00:07:47,199 --> 00:07:49,840
if you see if you understand what is the

216
00:07:49,840 --> 00:07:50,240
real

217
00:07:50,240 --> 00:07:53,440
the real path about this artifact you

218
00:07:53,440 --> 00:07:54,080
can

219
00:07:54,080 --> 00:07:57,599
improve your defenses mechanism right

220
00:07:57,599 --> 00:07:58,400
because

221
00:07:58,400 --> 00:08:01,440
if for example this malware bypass some

222
00:08:01,440 --> 00:08:04,960
security sensor that you have you can

223
00:08:04,960 --> 00:08:07,440
make some adjustments in the settings or

224
00:08:07,440 --> 00:08:09,199
something like that right

225
00:08:09,199 --> 00:08:12,639
if you have a a big company or maybe if

226
00:08:12,639 --> 00:08:14,080
you have a small company it's not a

227
00:08:14,080 --> 00:08:15,440
problem you can

228
00:08:15,440 --> 00:08:18,960
try you know to build this awesome idea

229
00:08:18,960 --> 00:08:21,919
this cyber threat intelligence right

230
00:08:21,919 --> 00:08:23,280
because you can use many

231
00:08:23,280 --> 00:08:26,080
different tools to in you know to

232
00:08:26,080 --> 00:08:27,759
automate this process

233
00:08:27,759 --> 00:08:31,039
to generate intelligence uh

234
00:08:31,039 --> 00:08:33,760
you know against threat that's the point

235
00:08:33,760 --> 00:08:34,399
here

236
00:08:34,399 --> 00:08:37,120
and of course you need to strengthening

237
00:08:37,120 --> 00:08:38,559
cyber resilience

238
00:08:38,559 --> 00:08:40,799
in your team in your environment because

239
00:08:40,799 --> 00:08:42,320
you know the threads

240
00:08:42,320 --> 00:08:45,519
are changing all the time so this is a

241
00:08:45,519 --> 00:08:47,040
simple life cycle

242
00:08:47,040 --> 00:08:49,440
about the mara knights the simple of

243
00:08:49,440 --> 00:08:50,480
course is not

244
00:08:50,480 --> 00:08:54,480
only the only

245
00:08:54,480 --> 00:08:56,959
module you can use another different

246
00:08:56,959 --> 00:08:58,720
it's not a problem but it just

247
00:08:58,720 --> 00:09:01,519
one simple idea for you right so let's

248
00:09:01,519 --> 00:09:03,360
explain more about the statistical

249
00:09:03,360 --> 00:09:05,120
analysis it's very simple

250
00:09:05,120 --> 00:09:08,240
usually we began our exploration right

251
00:09:08,240 --> 00:09:10,080
of moral analysis with the statistical

252
00:09:10,080 --> 00:09:11,120
analysis

253
00:09:11,120 --> 00:09:14,320
which is often the first step

254
00:09:14,320 --> 00:09:17,040
in our studies why because the

255
00:09:17,040 --> 00:09:19,040
statistical analysis describe

256
00:09:19,040 --> 00:09:21,600
usually the process of analyzing a

257
00:09:21,600 --> 00:09:22,080
program

258
00:09:22,080 --> 00:09:25,040
code right or maybe a structure to

259
00:09:25,040 --> 00:09:26,160
determine

260
00:09:26,160 --> 00:09:28,800
its functions for example you have some

261
00:09:28,800 --> 00:09:29,600
code

262
00:09:29,600 --> 00:09:33,680
and if this code has some library

263
00:09:33,680 --> 00:09:35,760
and for example some library called some

264
00:09:35,760 --> 00:09:36,959
function inside

265
00:09:36,959 --> 00:09:39,920
your system operations right so the

266
00:09:39,920 --> 00:09:41,519
program itself

267
00:09:41,519 --> 00:09:43,600
doesn't run at this time you know of

268
00:09:43,600 --> 00:09:45,120
course depending

269
00:09:45,120 --> 00:09:48,560
on what the program you are using right

270
00:09:48,560 --> 00:09:51,440
so this makes the parsing process more

271
00:09:51,440 --> 00:09:51,920
you know

272
00:09:51,920 --> 00:09:54,880
safe because we aren't actually

273
00:09:54,880 --> 00:09:55,760
excluding

274
00:09:55,760 --> 00:09:59,360
it right so it means doesn't run

275
00:09:59,360 --> 00:10:02,079
at this time because of this usually is

276
00:10:02,079 --> 00:10:02,640
the first

277
00:10:02,640 --> 00:10:05,680
step in mre study or using for amour

278
00:10:05,680 --> 00:10:06,560
analysts

279
00:10:06,560 --> 00:10:10,079
right so when you explain for a dynamic

280
00:10:10,079 --> 00:10:10,880
analysis for

281
00:10:10,880 --> 00:10:13,040
other hand is different it's based

282
00:10:13,040 --> 00:10:14,399
solely or only

283
00:10:14,399 --> 00:10:17,600
on behavior it means and in the

284
00:10:17,600 --> 00:10:19,839
interaction that malware has

285
00:10:19,839 --> 00:10:22,560
when it's executed or monologue or

286
00:10:22,560 --> 00:10:23,279
malware is

287
00:10:23,279 --> 00:10:26,640
used also known like

288
00:10:26,640 --> 00:10:28,880
run time and noise you see it's

289
00:10:28,880 --> 00:10:30,240
different

290
00:10:30,240 --> 00:10:32,640
because one of these tests or this

291
00:10:32,640 --> 00:10:33,360
analysis

292
00:10:33,360 --> 00:10:36,480
you uh use it in the runtime

293
00:10:36,480 --> 00:10:39,600
in an order it doesn't run at time it's

294
00:10:39,600 --> 00:10:41,200
different right it's very

295
00:10:41,200 --> 00:10:43,680
simple explanation but because it's it's

296
00:10:43,680 --> 00:10:45,200
very clear and it's not

297
00:10:45,200 --> 00:10:47,279
i don't need to explain more deeply

298
00:10:47,279 --> 00:10:48,959
because it's it's a simple definition

299
00:10:48,959 --> 00:10:50,880
one of these you reside

300
00:10:50,880 --> 00:10:52,959
the mower and you see the behavior any

301
00:10:52,959 --> 00:10:54,640
other you don't you don't execute the

302
00:10:54,640 --> 00:10:56,480
malware you need to see the call the

303
00:10:56,480 --> 00:10:57,360
structure

304
00:10:57,360 --> 00:10:59,920
and you know and understand how this

305
00:10:59,920 --> 00:11:01,440
malware or maldoc

306
00:11:01,440 --> 00:11:04,000
or sample works right so it can be

307
00:11:04,000 --> 00:11:04,560
easily

308
00:11:04,560 --> 00:11:07,600
automated there are sites today

309
00:11:07,600 --> 00:11:09,519
that already performer analysis with the

310
00:11:09,519 --> 00:11:11,440
malicious artifact using you know

311
00:11:11,440 --> 00:11:14,000
the simple concept call it sandbox or

312
00:11:14,000 --> 00:11:15,040
maybe when you're

313
00:11:15,040 --> 00:11:18,240
is performing this simple in um

314
00:11:18,240 --> 00:11:21,760
web application uh scanning and uh

315
00:11:21,760 --> 00:11:23,600
actually it's uh antivirus is kind of

316
00:11:23,600 --> 00:11:25,040
like you know virustoto

317
00:11:25,040 --> 00:11:26,959
ustoto it's antivirus scanning when you

318
00:11:26,959 --> 00:11:28,079
put some

319
00:11:28,079 --> 00:11:30,320
sample inside or url inside inside of

320
00:11:30,320 --> 00:11:31,360
the zeros total

321
00:11:31,360 --> 00:11:33,680
anyways they could this and of course

322
00:11:33,680 --> 00:11:35,120
you have many engines

323
00:11:35,120 --> 00:11:37,440
provide for many different security

324
00:11:37,440 --> 00:11:40,480
vendors inside of this uh jerusalem it's

325
00:11:40,480 --> 00:11:41,760
antivirus is scanning

326
00:11:41,760 --> 00:11:44,160
right so this is a uh is when you talk

327
00:11:44,160 --> 00:11:46,959
about the automated process or a dynamic

328
00:11:46,959 --> 00:11:49,680
it's kind of dynamic analysis right but

329
00:11:49,680 --> 00:11:51,680
it's very common when you use

330
00:11:51,680 --> 00:11:53,600
uh this kind of concept sandbox when you

331
00:11:53,600 --> 00:11:55,120
have the virtual machine

332
00:11:55,120 --> 00:11:57,760
with many engines and you can you know

333
00:11:57,760 --> 00:11:59,519
put the smallers inside of this virtual

334
00:11:59,519 --> 00:12:01,279
machine and then they could themselves

335
00:12:01,279 --> 00:12:04,480
and you can see and analyze the behavior

336
00:12:04,480 --> 00:12:06,320
right but of course in both of these

337
00:12:06,320 --> 00:12:07,839
analysis we need to understand about

338
00:12:07,839 --> 00:12:09,680
this basis

339
00:12:09,680 --> 00:12:10,880
it's very important during this

340
00:12:10,880 --> 00:12:12,959
conversation you need to understand

341
00:12:12,959 --> 00:12:16,000
about those phases it is

342
00:12:16,000 --> 00:12:19,600
very important right guys so okay

343
00:12:19,600 --> 00:12:22,079
before to talk about the physical

344
00:12:22,079 --> 00:12:24,000
logical analysis we need to understand

345
00:12:24,000 --> 00:12:27,120
about this basis that i am talking right

346
00:12:27,120 --> 00:12:27,680
so

347
00:12:27,680 --> 00:12:31,279
let's see here about the identification

348
00:12:31,279 --> 00:12:33,200
step do you remember the life cycle this

349
00:12:33,200 --> 00:12:34,639
is the first step so

350
00:12:34,639 --> 00:12:37,200
if you have now a virtual machine you

351
00:12:37,200 --> 00:12:38,639
can open your

352
00:12:38,639 --> 00:12:40,880
terminal when you're bash you can

353
00:12:40,880 --> 00:12:42,480
execute this

354
00:12:42,480 --> 00:12:45,040
commands with me so first of all let's

355
00:12:45,040 --> 00:12:46,639
see here let's open

356
00:12:46,639 --> 00:12:50,320
the simple the zoo do you know this

357
00:12:50,320 --> 00:12:53,920
repository the zoo uh github you can

358
00:12:53,920 --> 00:12:54,560
write

359
00:12:54,560 --> 00:12:58,079
in this way click enter and after that

360
00:12:58,079 --> 00:12:58,959
you have here

361
00:12:58,959 --> 00:13:03,920
the let me okay here i think it's good

362
00:13:03,920 --> 00:13:07,360
the zoo repository of live mowers for

363
00:13:07,360 --> 00:13:10,720
your your what your

364
00:13:10,720 --> 00:13:14,160
whatever okay you have here let's see

365
00:13:14,160 --> 00:13:16,480
live on our repository right so it's a

366
00:13:16,480 --> 00:13:19,040
project created to make the possibility

367
00:13:19,040 --> 00:13:21,360
of more analysis open and available to

368
00:13:21,360 --> 00:13:22,639
the public

369
00:13:22,639 --> 00:13:25,760
so pay attention here guys because all

370
00:13:25,760 --> 00:13:26,160
those

371
00:13:26,160 --> 00:13:28,959
mowers it is a real right it's not a

372
00:13:28,959 --> 00:13:31,120
fake mower so pay attention here

373
00:13:31,120 --> 00:13:34,880
when you manipulate this different

374
00:13:34,880 --> 00:13:37,600
uh mars you can execute all those models

375
00:13:37,600 --> 00:13:39,519
inside your bar but it's not necessary

376
00:13:39,519 --> 00:13:40,320
for now

377
00:13:40,320 --> 00:13:42,320
right but you can download after that

378
00:13:42,320 --> 00:13:43,440
it's not a problem

379
00:13:43,440 --> 00:13:45,120
and of course remember you need to make

380
00:13:45,120 --> 00:13:46,880
some settings in your network

381
00:13:46,880 --> 00:13:48,959
environment you know isolate your

382
00:13:48,959 --> 00:13:50,079
virtual machine

383
00:13:50,079 --> 00:13:51,680
it's very important to understand about

384
00:13:51,680 --> 00:13:53,279
that right so if you have some question

385
00:13:53,279 --> 00:13:54,079
you can

386
00:13:54,079 --> 00:13:57,760
uh write me you know in the in a github

387
00:13:57,760 --> 00:14:00,000
or can send a message by you know a

388
00:14:00,000 --> 00:14:02,480
twitter on linkedin wherever

389
00:14:02,480 --> 00:14:04,160
you can send me a message if you need

390
00:14:04,160 --> 00:14:05,680
this understand about these

391
00:14:05,680 --> 00:14:07,839
configurations in your network right

392
00:14:07,839 --> 00:14:09,680
so you can click here in ours and after

393
00:14:09,680 --> 00:14:11,519
that you can click on binaries

394
00:14:11,519 --> 00:14:14,720
right and after that boom you have here

395
00:14:14,720 --> 00:14:18,399
the awesomes many different mowers right

396
00:14:18,399 --> 00:14:21,440
and then the right rod and the different

397
00:14:21,440 --> 00:14:24,880
attempts and but different samples right

398
00:14:24,880 --> 00:14:26,480
not samples in this case it's a

399
00:14:26,480 --> 00:14:28,160
real mower right the pitot locker and

400
00:14:28,160 --> 00:14:30,320
some rents over and let's see here the

401
00:14:30,320 --> 00:14:32,000
equation group you know it's an

402
00:14:32,000 --> 00:14:34,240
apt group and i don't know if you know

403
00:14:34,240 --> 00:14:35,600
but it's an apt group

404
00:14:35,600 --> 00:14:39,199
it's a simple of course of this mars

405
00:14:39,199 --> 00:14:41,760
let's see anothers here linux chopros

406
00:14:41,760 --> 00:14:43,279
encoder

407
00:14:43,279 --> 00:14:45,199
as you can see here it's an elf it's a

408
00:14:45,199 --> 00:14:46,399
different of the pe

409
00:14:46,399 --> 00:14:48,639
portable executable in this case it's

410
00:14:48,639 --> 00:14:50,800
for a linux platform

411
00:14:50,800 --> 00:14:53,920
and here to aos

412
00:14:53,920 --> 00:14:57,279
in this case it's natural uh sam

413
00:14:57,279 --> 00:15:00,160
mowers right it's a mac os and let's see

414
00:15:00,160 --> 00:15:00,639
here

415
00:15:00,639 --> 00:15:04,639
oh nice many ram servers to manipulate

416
00:15:04,639 --> 00:15:04,959
be

417
00:15:04,959 --> 00:15:07,680
i know again be careful to this version

418
00:15:07,680 --> 00:15:08,959
because it's totally

419
00:15:08,959 --> 00:15:13,680
real so let's see here another treasure

420
00:15:13,680 --> 00:15:16,480
i don't know if you are hearing but i

421
00:15:16,480 --> 00:15:18,160
have a truck here

422
00:15:18,160 --> 00:15:20,639
next to my apartment now and uh the guy

423
00:15:20,639 --> 00:15:22,000
probably talking

424
00:15:22,000 --> 00:15:24,639
some you know promotions like that or

425
00:15:24,639 --> 00:15:25,120
you know

426
00:15:25,120 --> 00:15:28,480
whatever i'm sorry for that guys but

427
00:15:28,480 --> 00:15:31,279
this is the pandemic you know it's a new

428
00:15:31,279 --> 00:15:31,920
real life

429
00:15:31,920 --> 00:15:34,880
unfortunately and but we have here

430
00:15:34,880 --> 00:15:36,079
another difference

431
00:15:36,079 --> 00:15:39,600
uh take a look at this win3 apt 28

432
00:15:39,600 --> 00:15:42,639
20 32 and

433
00:15:42,639 --> 00:15:45,759
another zip right you can download

434
00:15:45,759 --> 00:15:48,240
whatever you want right so let's see

435
00:15:48,240 --> 00:15:49,600
another here another

436
00:15:49,600 --> 00:15:52,639
very interesting repository just right

437
00:15:52,639 --> 00:15:56,560
in the in the google maw bazaar here

438
00:15:56,560 --> 00:15:59,360
and click enter and uh and after that

439
00:15:59,360 --> 00:16:00,639
you have here let's see

440
00:16:00,639 --> 00:16:04,000
maura bazaar our sample exchange

441
00:16:04,000 --> 00:16:07,360
click here and after that you have here

442
00:16:07,360 --> 00:16:08,079
the mower

443
00:16:08,079 --> 00:16:11,759
bazaar by abuse ch

444
00:16:11,759 --> 00:16:13,759
you can click here in our bazaar

445
00:16:13,759 --> 00:16:16,480
database and take a look where and see

446
00:16:16,480 --> 00:16:20,639
here another awesome project inside

447
00:16:20,639 --> 00:16:23,920
our environment not in our environment

448
00:16:23,920 --> 00:16:26,079
it's a repository right you can and see

449
00:16:26,079 --> 00:16:27,759
many different powers here

450
00:16:27,759 --> 00:16:31,120
again be careful because here we have

451
00:16:31,120 --> 00:16:34,160
many uh mower

452
00:16:34,160 --> 00:16:37,199
you know and of course you can try

453
00:16:37,199 --> 00:16:39,360
during your you know tests your

454
00:16:39,360 --> 00:16:40,639
improvement your acknowledgement

455
00:16:40,639 --> 00:16:43,759
you have here and pe executable you have

456
00:16:43,759 --> 00:16:45,920
here it's a document right

457
00:16:45,920 --> 00:16:49,279
xls and here you have a doc and zip

458
00:16:49,279 --> 00:16:50,800
you can download many different let's

459
00:16:50,800 --> 00:16:52,800
see another here if you have here

460
00:16:52,800 --> 00:16:56,959
and a pdf click search and uh

461
00:16:56,959 --> 00:16:59,519
hit f i don't know if this syntax is

462
00:16:59,519 --> 00:17:00,639
correct

463
00:17:00,639 --> 00:17:04,880
and uh okay tag uh

464
00:17:04,880 --> 00:17:08,400
let's see here pdf again let's see

465
00:17:08,400 --> 00:17:12,079
search and uh yes searching now

466
00:17:12,079 --> 00:17:14,480
and okay it's here let's see here

467
00:17:14,480 --> 00:17:15,679
another pdf

468
00:17:15,679 --> 00:17:18,400
if you'd like to see more deeply you can

469
00:17:18,400 --> 00:17:19,119
download

470
00:17:19,119 --> 00:17:22,640
all those samples and pe and

471
00:17:22,640 --> 00:17:24,959
oh man take a look at this philip it's

472
00:17:24,959 --> 00:17:26,000
me right

473
00:17:26,000 --> 00:17:29,440
guys you can click here if you'd like to

474
00:17:29,440 --> 00:17:32,480
download my not myself actually

475
00:17:32,480 --> 00:17:35,520
it's actually it's a mower that i will

476
00:17:35,520 --> 00:17:37,360
explain during this conversation there

477
00:17:37,360 --> 00:17:37,840
is

478
00:17:37,840 --> 00:17:40,880
during this um

479
00:17:40,880 --> 00:17:44,080
presentations right so when i uploaded

480
00:17:44,080 --> 00:17:44,559
this

481
00:17:44,559 --> 00:17:47,440
mower inside of this platform i lived in

482
00:17:47,440 --> 00:17:49,360
poland in that time but now i'm

483
00:17:49,360 --> 00:17:51,760
leaving and i'm talking from brazil and

484
00:17:51,760 --> 00:17:53,679
okay you can download this and you can

485
00:17:53,679 --> 00:17:55,679
make your testings during

486
00:17:55,679 --> 00:17:58,080
this workshop right so let's return my

487
00:17:58,080 --> 00:18:00,400
virtual machine here let me list

488
00:18:00,400 --> 00:18:02,400
all those samples that i have here

489
00:18:02,400 --> 00:18:03,520
inside of my

490
00:18:03,520 --> 00:18:06,880
machine then which don't mind much oh my

491
00:18:06,880 --> 00:18:07,760
goodness

492
00:18:07,760 --> 00:18:10,559
that i have inside of my virtual machine

493
00:18:10,559 --> 00:18:11,600
and i have here

494
00:18:11,600 --> 00:18:14,640
the amazon amazon doc

495
00:18:14,640 --> 00:18:18,880
docx bl doc pdf invoice.pdf

496
00:18:18,880 --> 00:18:22,000
linux without extension uh

497
00:18:22,000 --> 00:18:25,799
pdf it's a directory it's a folder and

498
00:18:25,799 --> 00:18:28,799
redpo.cso probably it's a

499
00:18:28,799 --> 00:18:32,000
it's a it's a different it's um it's

500
00:18:32,000 --> 00:18:32,640
another

501
00:18:32,640 --> 00:18:36,480
code to make uh if you're using gcc to

502
00:18:36,480 --> 00:18:37,280
create an

503
00:18:37,280 --> 00:18:40,720
elf file and resume pdf and sample pdf

504
00:18:40,720 --> 00:18:41,600
here

505
00:18:41,600 --> 00:18:45,520
folder with a wing uh it's a vf portable

506
00:18:45,520 --> 00:18:46,400
inside of this

507
00:18:46,400 --> 00:18:48,320
let's check here so okay let's

508
00:18:48,320 --> 00:18:50,320
understand what the first step that i

509
00:18:50,320 --> 00:18:50,799
can

510
00:18:50,799 --> 00:18:52,559
as a good themself here in my

511
00:18:52,559 --> 00:18:54,640
environment and uh

512
00:18:54,640 --> 00:18:57,520
maybe i am using the file because it's a

513
00:18:57,520 --> 00:18:58,160
good

514
00:18:58,160 --> 00:19:00,880
tool or good com command to as a good

515
00:19:00,880 --> 00:19:01,360
right

516
00:19:01,360 --> 00:19:04,799
so let's see amazon first of all

517
00:19:04,799 --> 00:19:06,799
let's see what happened here i can

518
00:19:06,799 --> 00:19:10,000
identify the microsoft word 2007 plus

519
00:19:10,000 --> 00:19:12,720
right and another is a file an amazon

520
00:19:12,720 --> 00:19:13,840
doc

521
00:19:13,840 --> 00:19:16,960
docx yes it's it is

522
00:19:16,960 --> 00:19:20,240
okay okay it's obviously maybe

523
00:19:20,240 --> 00:19:22,000
and let's see another bill my friend

524
00:19:22,000 --> 00:19:24,240
view let's see here my friend bill

525
00:19:24,240 --> 00:19:26,960
i like this guy view it's a it's a pdf

526
00:19:26,960 --> 00:19:27,919
document perfect

527
00:19:27,919 --> 00:19:30,880
so let's see here another invoice.pdf

528
00:19:30,880 --> 00:19:32,320
file

529
00:19:32,320 --> 00:19:36,080
and maybe you are asking you

530
00:19:36,080 --> 00:19:39,200
about so i need to execute this

531
00:19:39,200 --> 00:19:42,160
command in all those files yeah this is

532
00:19:42,160 --> 00:19:43,919
the identification step you remember i

533
00:19:43,919 --> 00:19:45,280
need to understand

534
00:19:45,280 --> 00:19:48,640
what it is or what is exactly the binary

535
00:19:48,640 --> 00:19:49,360
right so

536
00:19:49,360 --> 00:19:52,320
let's see again file let's see linux

537
00:19:52,320 --> 00:19:52,799
talk

538
00:19:52,799 --> 00:19:56,000
text it's a text oops in this case it's

539
00:19:56,000 --> 00:19:56,880
not a text

540
00:19:56,880 --> 00:19:59,600
take a look at this it's a elf it's a

541
00:19:59,600 --> 00:20:00,559
it's a cootable

542
00:20:00,559 --> 00:20:03,200
right so it's different but take a look

543
00:20:03,200 --> 00:20:03,919
this here

544
00:20:03,919 --> 00:20:06,559
is the extension in this case it's

545
00:20:06,559 --> 00:20:08,559
doctest but it's not

546
00:20:08,559 --> 00:20:10,720
this case is different it's elf take a

547
00:20:10,720 --> 00:20:13,280
look at this it's very interesting here

548
00:20:13,280 --> 00:20:16,320
because here it's the base i need to

549
00:20:16,320 --> 00:20:18,159
understand how this command works

550
00:20:18,159 --> 00:20:21,600
how this file works and

551
00:20:21,600 --> 00:20:25,280
after before or before i execute

552
00:20:25,280 --> 00:20:28,720
any whatever comment i i can as i could

553
00:20:28,720 --> 00:20:30,799
in this virtual machine or in my

554
00:20:30,799 --> 00:20:32,559
environment i need to understand

555
00:20:32,559 --> 00:20:35,200
how this exactly worked so i can set for

556
00:20:35,200 --> 00:20:35,919
example my

557
00:20:35,919 --> 00:20:38,400
file let me looking inside of this

558
00:20:38,400 --> 00:20:39,600
commandment file

559
00:20:39,600 --> 00:20:42,960
how this works exactly and oops

560
00:20:42,960 --> 00:20:46,559
let's see here okay so man file

561
00:20:46,559 --> 00:20:49,039
it's what it is this tools actually

562
00:20:49,039 --> 00:20:50,240
determine

563
00:20:50,240 --> 00:20:53,120
a file type take a look this then of

564
00:20:53,120 --> 00:20:54,799
course maybe you understand you know

565
00:20:54,799 --> 00:20:56,400
about that but you need to understand

566
00:20:56,400 --> 00:20:58,320
how this exactly works so the manual

567
00:20:58,320 --> 00:21:01,280
page document verse 5.39

568
00:21:01,280 --> 00:21:04,480
on a file comment okay here's some flags

569
00:21:04,480 --> 00:21:06,159
or comments that you can set

570
00:21:06,159 --> 00:21:09,120
when you execute this file and okay so

571
00:21:09,120 --> 00:21:10,559
why

572
00:21:10,559 --> 00:21:14,400
you are show us this philippines this is

573
00:21:14,400 --> 00:21:15,200
a good cash

574
00:21:15,200 --> 00:21:17,039
question because here we have some

575
00:21:17,039 --> 00:21:18,240
interesting information

576
00:21:18,240 --> 00:21:22,000
the magic tests are used to check for

577
00:21:22,000 --> 00:21:25,280
files with data's in particular fixed

578
00:21:25,280 --> 00:21:29,440
formats so perfect so these tools

579
00:21:29,440 --> 00:21:32,880
presenters exactly

580
00:21:32,880 --> 00:21:34,720
different or not different but exactly

581
00:21:34,720 --> 00:21:35,919
particular fixed

582
00:21:35,919 --> 00:21:38,480
fixed formats right so the canonical

583
00:21:38,480 --> 00:21:39,760
example okay

584
00:21:39,760 --> 00:21:43,360
of this a binary executable

585
00:21:43,360 --> 00:21:45,600
program do you remember about the thread

586
00:21:45,600 --> 00:21:47,360
it's a software but when you have some

587
00:21:47,360 --> 00:21:48,080
software

588
00:21:48,080 --> 00:21:50,080
some software we have a software

589
00:21:50,080 --> 00:21:51,679
compiler right

590
00:21:51,679 --> 00:21:55,760
uh it means changing this program

591
00:21:55,760 --> 00:21:59,120
to a compiled program perfect so r

592
00:21:59,120 --> 00:22:02,559
a dot 8 file was format is defined

593
00:22:02,559 --> 00:22:06,159
in an elf dot h so it means here

594
00:22:06,159 --> 00:22:08,480
maybe you have and there's interesting

595
00:22:08,480 --> 00:22:10,080
information here so let's see here let

596
00:22:10,080 --> 00:22:10,799
me

597
00:22:10,799 --> 00:22:14,480
cop elf.h to understand more about this

598
00:22:14,480 --> 00:22:17,679
information let me open another

599
00:22:17,679 --> 00:22:22,320
split vertically okay let me open here

600
00:22:22,320 --> 00:22:26,880
and let me find this not find the locate

601
00:22:26,880 --> 00:22:27,360
sorry

602
00:22:27,360 --> 00:22:31,039
i can use find too but i prefer using uh

603
00:22:31,039 --> 00:22:34,159
let me pass here okay in the beginning

604
00:22:34,159 --> 00:22:35,200
here

605
00:22:35,200 --> 00:22:39,520
uh user include let me check

606
00:22:39,520 --> 00:22:42,799
this important thing here because here

607
00:22:42,799 --> 00:22:45,520
in the explanation of the do you

608
00:22:45,520 --> 00:22:46,559
remember

609
00:22:46,559 --> 00:22:50,320
and the in the in the middle of the fire

610
00:22:50,320 --> 00:22:51,360
we have here the

611
00:22:51,360 --> 00:22:54,880
good explanation about this extensions

612
00:22:54,880 --> 00:22:56,559
take a look at this here

613
00:22:56,559 --> 00:22:59,600
about the here whose format

614
00:22:59,600 --> 00:23:02,880
is defined so here in this file maybe i

615
00:23:02,880 --> 00:23:04,080
have some

616
00:23:04,080 --> 00:23:06,559
format defined but what kind of maybe

617
00:23:06,559 --> 00:23:09,520
it's a elf because

618
00:23:09,520 --> 00:23:11,280
the material the explanation it's about

619
00:23:11,280 --> 00:23:13,120
that flat check here uh

620
00:23:13,120 --> 00:23:16,400
it's uh i use nano you know

621
00:23:16,400 --> 00:23:19,280
lit to read and take a look what i am

622
00:23:19,280 --> 00:23:20,480
seeing here

623
00:23:20,480 --> 00:23:24,240
in this moment in this file

624
00:23:24,240 --> 00:23:28,559
take a look this user include

625
00:23:28,559 --> 00:23:32,600
dash user usr dot

626
00:23:32,600 --> 00:23:35,200
include.alph.h of this file defined is

627
00:23:35,200 --> 00:23:36,080
standard

628
00:23:36,080 --> 00:23:37,840
elf type take a look at this of course

629
00:23:37,840 --> 00:23:39,520
this conversation this workshop is

630
00:23:39,520 --> 00:23:42,559
related to a pdf

631
00:23:42,559 --> 00:23:44,640
but when you talk about the malwares you

632
00:23:44,640 --> 00:23:46,880
can you need to understand about the elf

633
00:23:46,880 --> 00:23:48,159
you know you need to understand about

634
00:23:48,159 --> 00:23:50,159
the pe portable executable you need to

635
00:23:50,159 --> 00:23:52,000
understand about the different docks

636
00:23:52,000 --> 00:23:54,640
uh like you know dock or an xls

637
00:23:54,640 --> 00:23:56,080
powerpoint

638
00:23:56,080 --> 00:23:58,720
whatever and uh and of course the pdf so

639
00:23:58,720 --> 00:24:00,640
here we have a good example when you

640
00:24:00,640 --> 00:24:02,480
read

641
00:24:02,480 --> 00:24:05,360
the manual buddy i flip i don't like to

642
00:24:05,360 --> 00:24:06,640
read the manual

643
00:24:06,640 --> 00:24:09,679
i know maybe i don't like to but it's

644
00:24:09,679 --> 00:24:10,159
very

645
00:24:10,159 --> 00:24:14,320
important why because here you have a

646
00:24:14,320 --> 00:24:14,960
types

647
00:24:14,960 --> 00:24:17,360
and structure and macros right so let's

648
00:24:17,360 --> 00:24:18,640
see

649
00:24:18,640 --> 00:24:21,520
behind here let's move here you have the

650
00:24:21,520 --> 00:24:22,880
structure of the byte so

651
00:24:22,880 --> 00:24:25,919
16 bytes quantity about the elf and a

652
00:24:25,919 --> 00:24:26,400
half

653
00:24:26,400 --> 00:24:29,840
an award and and the next word

654
00:24:29,840 --> 00:24:32,080
maybe all those explanations it's very

655
00:24:32,080 --> 00:24:33,520
cool for another talk

656
00:24:33,520 --> 00:24:35,600
but okay because we don't have a time to

657
00:24:35,600 --> 00:24:37,679
explain all those details now

658
00:24:37,679 --> 00:24:40,880
and here the elf file header this

659
00:24:40,880 --> 00:24:41,600
appears

660
00:24:41,600 --> 00:24:44,720
at the start of every elf

661
00:24:44,720 --> 00:24:48,080
file take a look at this this is the

662
00:24:48,080 --> 00:24:51,440
elf file header one of this part

663
00:24:51,440 --> 00:24:55,360
of the elf structure but philip this

664
00:24:55,360 --> 00:24:57,919
conversation is about elf it's about pdf

665
00:24:57,919 --> 00:25:00,000
no or just to understand something about

666
00:25:00,000 --> 00:25:02,480
demand right so the first idea when you

667
00:25:02,480 --> 00:25:03,679
talk about the header

668
00:25:03,679 --> 00:25:07,039
you have this array

669
00:25:07,039 --> 00:25:09,279
what array this in the first array we

670
00:25:09,279 --> 00:25:10,880
have this

671
00:25:10,880 --> 00:25:14,320
identity when you have this array

672
00:25:14,320 --> 00:25:17,600
and a 16 bytes do you remember take take

673
00:25:17,600 --> 00:25:19,919
a look at this they structure the first

674
00:25:19,919 --> 00:25:23,440
you have 60 bytes in

675
00:25:23,440 --> 00:25:26,880
this structure right so

676
00:25:26,880 --> 00:25:31,360
this is the identity

677
00:25:31,520 --> 00:25:34,559
structure in the header of what

678
00:25:34,559 --> 00:25:35,840
information do you have

679
00:25:35,840 --> 00:25:37,919
in the identity structure you have a

680
00:25:37,919 --> 00:25:39,039
magic number

681
00:25:39,039 --> 00:25:41,760
and others information but what that

682
00:25:41,760 --> 00:25:44,159
means magic number flip

683
00:25:44,159 --> 00:25:46,880
take a look at this one second i will

684
00:25:46,880 --> 00:25:48,480
explain more about the magic number but

685
00:25:48,480 --> 00:25:50,320
you have here others information

686
00:25:50,320 --> 00:25:53,520
so okay let's return our uh man

687
00:25:53,520 --> 00:25:56,720
because i didn't finish the here okay

688
00:25:56,720 --> 00:25:59,039
okay let's continue the explanation

689
00:25:59,039 --> 00:26:00,000
possib

690
00:26:00,000 --> 00:26:04,159
possible uh as exact.he

691
00:26:04,159 --> 00:26:07,039
in the standard included directory okay

692
00:26:07,039 --> 00:26:08,480
this file

693
00:26:08,480 --> 00:26:11,679
but these files has a what a magic

694
00:26:11,679 --> 00:26:12,480
number

695
00:26:12,480 --> 00:26:15,600
what it is exactly storage

696
00:26:15,600 --> 00:26:18,799
in a particular place near the beginning

697
00:26:18,799 --> 00:26:22,320
of the file that tells

698
00:26:22,320 --> 00:26:24,640
the unix operation system that the file

699
00:26:24,640 --> 00:26:26,080
is a binary

700
00:26:26,080 --> 00:26:30,880
executable and each of the several types

701
00:26:30,880 --> 00:26:34,159
uh theoretic the concept of

702
00:26:34,159 --> 00:26:38,000
magic has has been applied

703
00:26:38,000 --> 00:26:42,000
by extension to data files it means

704
00:26:42,000 --> 00:26:46,159
you have a magic number in all those

705
00:26:46,159 --> 00:26:49,840
files in a particular place

706
00:26:49,840 --> 00:26:53,279
in the beginning right so it means

707
00:26:53,279 --> 00:26:56,720
you usually you always have the magic

708
00:26:56,720 --> 00:26:57,520
number so

709
00:26:57,520 --> 00:27:00,880
it means all those bios has a magical

710
00:27:00,880 --> 00:27:02,559
number i feel if i

711
00:27:02,559 --> 00:27:04,880
i already know about that so no worries

712
00:27:04,880 --> 00:27:06,080
but probably we have

713
00:27:06,080 --> 00:27:09,520
some people now watching this video

714
00:27:09,520 --> 00:27:13,120
people didn't know nowhere but every

715
00:27:13,120 --> 00:27:16,480
people now uh know

716
00:27:16,480 --> 00:27:18,640
now right so take a look at this the

717
00:27:18,640 --> 00:27:21,279
information identifying this

718
00:27:21,279 --> 00:27:24,240
here the identification this file is

719
00:27:24,240 --> 00:27:25,200
ready from

720
00:27:25,200 --> 00:27:28,240
what atc magic

721
00:27:28,240 --> 00:27:31,760
and the compiled magic file and user

722
00:27:31,760 --> 00:27:33,200
share misc

723
00:27:33,200 --> 00:27:37,360
dash slash magic doc mgc

724
00:27:37,360 --> 00:27:40,880
it means you have all those informations

725
00:27:40,880 --> 00:27:42,399
compiled here in your

726
00:27:42,399 --> 00:27:45,279
system operations right but i need you

727
00:27:45,279 --> 00:27:47,600
and i would like to explain more details

728
00:27:47,600 --> 00:27:48,640
about that

729
00:27:48,640 --> 00:27:52,399
right about this kind of concept so

730
00:27:52,399 --> 00:27:56,880
uh let me close here again

731
00:27:56,880 --> 00:28:01,039
let me close here this uh okay

732
00:28:01,120 --> 00:28:04,399
uh is it okay and uh here take a look at

733
00:28:04,399 --> 00:28:04,720
this

734
00:28:04,720 --> 00:28:07,840
i download this the real

735
00:28:07,840 --> 00:28:10,320
file code to understand more deeply

736
00:28:10,320 --> 00:28:12,240
about this simple code

737
00:28:12,240 --> 00:28:14,960
the simple comment the simple base right

738
00:28:14,960 --> 00:28:16,320
so let's see here

739
00:28:16,320 --> 00:28:20,480
cd file and um

740
00:28:20,559 --> 00:28:25,120
magic it's a magic i don't remember

741
00:28:25,120 --> 00:28:28,960
let's see here uh it's uh okay magic

742
00:28:28,960 --> 00:28:32,480
magic magic magaziner

743
00:28:32,480 --> 00:28:35,360
take a look at this magazine and what i

744
00:28:35,360 --> 00:28:36,159
have here

745
00:28:36,159 --> 00:28:40,080
so take a look at this i have all those

746
00:28:40,080 --> 00:28:44,240
magic numbers for many different

747
00:28:44,240 --> 00:28:47,840
bios like you know enough pdf

748
00:28:47,840 --> 00:28:51,520
here i have from vmware

749
00:28:51,520 --> 00:28:54,720
or i have here another from let's see

750
00:28:54,720 --> 00:28:58,480
another elf here you know

751
00:28:58,480 --> 00:29:01,039
here take a look at this and uh on

752
00:29:01,039 --> 00:29:03,039
windows we have here windows too

753
00:29:03,039 --> 00:29:06,399
let's see what is the windows here it's

754
00:29:06,399 --> 00:29:09,279
windows take a look at this and web

755
00:29:09,279 --> 00:29:10,480
assembly

756
00:29:10,480 --> 00:29:13,520
and uh we have a pideon might say where

757
00:29:13,520 --> 00:29:15,200
is python here

758
00:29:15,200 --> 00:29:18,320
take a look at this

759
00:29:18,399 --> 00:29:21,440
uh it's here piden

760
00:29:21,440 --> 00:29:25,840
i don't know i lost but i lost python my

761
00:29:25,840 --> 00:29:27,679
anyway we have python here but i don't

762
00:29:27,679 --> 00:29:29,840
know exactly here it's python

763
00:29:29,840 --> 00:29:34,960
okay so let's see uh uh javascript

764
00:29:34,960 --> 00:29:38,320
javascript javascript inside of this

765
00:29:38,320 --> 00:29:40,159
uh it's a database of this many

766
00:29:40,159 --> 00:29:43,120
different uh

767
00:29:43,120 --> 00:29:45,520
magic numbers so as you can see here you

768
00:29:45,520 --> 00:29:46,480
have some rules

769
00:29:46,480 --> 00:29:50,000
to understand when the

770
00:29:50,000 --> 00:29:54,320
file comment we will identify

771
00:29:54,320 --> 00:29:56,960
you know what is exactly that file of

772
00:29:56,960 --> 00:29:59,039
these fire right so let's see here

773
00:29:59,039 --> 00:30:01,600
this is when you have the beginning do

774
00:30:01,600 --> 00:30:03,360
you remember in the beginning

775
00:30:03,360 --> 00:30:06,000
of the particular place in the beginning

776
00:30:06,000 --> 00:30:07,440
do you remember the explanation

777
00:30:07,440 --> 00:30:09,360
here when you have this information in

778
00:30:09,360 --> 00:30:10,880
the beginning you have

779
00:30:10,880 --> 00:30:14,240
what a node.js script executable right

780
00:30:14,240 --> 00:30:18,720
so let's see other and maybe a python

781
00:30:18,799 --> 00:30:20,720
right in here maybe python we have a

782
00:30:20,720 --> 00:30:22,159
different rules

783
00:30:22,159 --> 00:30:24,640
many rules by the way take a look at

784
00:30:24,640 --> 00:30:25,200
this

785
00:30:25,200 --> 00:30:27,360
and there's some reject some strings

786
00:30:27,360 --> 00:30:28,880
here take a look at this

787
00:30:28,880 --> 00:30:32,960
okay and um the same case here take a

788
00:30:32,960 --> 00:30:34,320
look there's a final script

789
00:30:34,320 --> 00:30:38,240
perfect okay let me manipulate something

790
00:30:38,240 --> 00:30:41,679
let me create here nano uh malware

791
00:30:41,679 --> 00:30:44,080
very creative.text perfect and the

792
00:30:44,080 --> 00:30:45,440
malware

793
00:30:45,440 --> 00:30:49,520
is malicious malicious

794
00:30:49,520 --> 00:30:53,360
let's save here and um

795
00:30:53,360 --> 00:30:56,880
okay yes save and okay let me

796
00:30:56,880 --> 00:31:00,159
i will create this sample right so it's

797
00:31:00,159 --> 00:31:01,679
a text take a look at this i have to put

798
00:31:01,679 --> 00:31:02,720
the file command

799
00:31:02,720 --> 00:31:05,919
and that that the tools uh

800
00:31:05,919 --> 00:31:09,679
performance in this uh file and the

801
00:31:09,679 --> 00:31:12,080
file understand how this matching

802
00:31:12,080 --> 00:31:14,960
numbers work so let me manipulate this

803
00:31:14,960 --> 00:31:18,000
file now so first of all

804
00:31:18,000 --> 00:31:21,600
let me put for example let me return

805
00:31:21,600 --> 00:31:23,200
here

806
00:31:23,200 --> 00:31:26,559
and uh okay

807
00:31:26,559 --> 00:31:30,399
no let me see about the javascript

808
00:31:30,399 --> 00:31:32,320
because i really don't remember okay

809
00:31:32,320 --> 00:31:34,480
it's a binging there's a

810
00:31:34,480 --> 00:31:36,880
a simple let me copy here and i

811
00:31:36,880 --> 00:31:37,840
completely forgot

812
00:31:37,840 --> 00:31:40,799
being slash note it's very simple but i

813
00:31:40,799 --> 00:31:41,440
forgot

814
00:31:41,440 --> 00:31:44,159
sorry for that let me manipulate now let

815
00:31:44,159 --> 00:31:46,159
me paste here

816
00:31:46,159 --> 00:31:48,399
slash you know being bash x not being

817
00:31:48,399 --> 00:31:49,200
bashed b note

818
00:31:49,200 --> 00:31:53,360
actually let me save here and like

819
00:31:53,360 --> 00:31:57,200
uh click yes and uh save here and again

820
00:31:57,200 --> 00:32:00,240
file mower take a look at this it's not

821
00:32:00,240 --> 00:32:00,880
a

822
00:32:00,880 --> 00:32:03,200
you know take a look this is not a text

823
00:32:03,200 --> 00:32:04,159
more

824
00:32:04,159 --> 00:32:07,279
it's an ojs you know and uh

825
00:32:07,279 --> 00:32:10,799
if i try to read here it's it's

826
00:32:10,799 --> 00:32:13,679
you know but it's not exactly javascript

827
00:32:13,679 --> 00:32:15,039
because the extension is different you

828
00:32:15,039 --> 00:32:16,640
remember when i execute this

829
00:32:16,640 --> 00:32:19,919
file command in another text it was f

830
00:32:19,919 --> 00:32:21,279
file do you remember

831
00:32:21,279 --> 00:32:22,399
we'll take a look at this let me

832
00:32:22,399 --> 00:32:25,200
manipulate again file

833
00:32:25,200 --> 00:32:29,120
it's a nano okay i will put here

834
00:32:29,120 --> 00:32:33,120
just a simple comment here

835
00:32:33,120 --> 00:32:37,919
let me that here and uh

836
00:32:37,919 --> 00:32:41,120
let me save and yes what

837
00:32:41,120 --> 00:32:44,159
what happened here file mower

838
00:32:44,159 --> 00:32:46,559
it's a python take a look at this

839
00:32:46,559 --> 00:32:48,000
because this is the

840
00:32:48,000 --> 00:32:50,799
do you remember what the name it's a

841
00:32:50,799 --> 00:32:53,600
magic number

842
00:32:53,600 --> 00:32:55,120
because i'm manipulating the magic

843
00:32:55,120 --> 00:32:58,000
number here right

844
00:32:58,000 --> 00:33:02,240
okay so let me let me do another

845
00:33:02,240 --> 00:33:06,320
last manipulation mower uh

846
00:33:06,320 --> 00:33:10,720
or the final material text

847
00:33:10,720 --> 00:33:13,919
okay no it's not i need to put the

848
00:33:13,919 --> 00:33:14,799
correct name

849
00:33:14,799 --> 00:33:18,240
it's uh it's different here

850
00:33:18,240 --> 00:33:22,000
okay now it's okay perfect let me put

851
00:33:22,000 --> 00:33:23,519
here what

852
00:33:23,519 --> 00:33:26,880
uh that money putting percent pdf

853
00:33:26,880 --> 00:33:30,640
and one doc one doc

854
00:33:30,640 --> 00:33:34,240
or six let me save here what happened

855
00:33:34,240 --> 00:33:35,120
because

856
00:33:35,120 --> 00:33:36,880
i don't know how the file works in this

857
00:33:36,880 --> 00:33:38,880
case let's see here

858
00:33:38,880 --> 00:33:42,799
catch mower i have here person pdf

859
00:33:42,799 --> 00:33:46,640
and i have here uh from a pilot script

860
00:33:46,640 --> 00:33:49,919
and here the text so let's see what

861
00:33:49,919 --> 00:33:53,200
works here file malware.txt

862
00:33:53,200 --> 00:33:56,880
it is a pdf document take a look this

863
00:33:56,880 --> 00:34:01,440
why because if you see a pdf here

864
00:34:01,440 --> 00:34:04,080
take a look this they string in the

865
00:34:04,080 --> 00:34:05,360
beginning

866
00:34:05,360 --> 00:34:09,440
exactly a string that i wrote

867
00:34:09,440 --> 00:34:12,960
right so why i explain all those

868
00:34:12,960 --> 00:34:16,320
things to you because you need to

869
00:34:16,320 --> 00:34:18,159
understand about those basis it's very

870
00:34:18,159 --> 00:34:19,280
very important

871
00:34:19,280 --> 00:34:21,280
right so we need to understand how this

872
00:34:21,280 --> 00:34:22,399
tool works

873
00:34:22,399 --> 00:34:24,960
it's not a simple comment right so

874
00:34:24,960 --> 00:34:26,879
another simple example let me return

875
00:34:26,879 --> 00:34:28,719
here root

876
00:34:28,719 --> 00:34:32,000
and uh malware

877
00:34:32,000 --> 00:34:34,960
and yes okay so let's see here i have

878
00:34:34,960 --> 00:34:35,520
different

879
00:34:35,520 --> 00:34:38,800
uh files linux files here

880
00:34:38,800 --> 00:34:41,599
linux okay so let's see for example uh

881
00:34:41,599 --> 00:34:43,599
file linux

882
00:34:43,599 --> 00:34:47,040
32 okay linux

883
00:34:47,040 --> 00:34:48,870
64 and

884
00:34:48,870 --> 00:34:51,839
[Music]

885
00:34:51,839 --> 00:34:56,480
take a look at this if i execute this xd

886
00:34:57,040 --> 00:35:01,839
xd let me check here in xd or xd

887
00:35:01,839 --> 00:35:05,280
okay xd uh

888
00:35:05,280 --> 00:35:09,920
dash any 32 and the linux

889
00:35:09,920 --> 00:35:13,200
32 take a look this i have here

890
00:35:13,200 --> 00:35:15,920
the extra decimal information right and

891
00:35:15,920 --> 00:35:16,800
here i have what

892
00:35:16,800 --> 00:35:19,760
i have string here right so let me put

893
00:35:19,760 --> 00:35:20,240
here

894
00:35:20,240 --> 00:35:22,710
another thing like

895
00:35:22,710 --> 00:35:25,040
[Music]

896
00:35:25,040 --> 00:35:30,079
not 32 bytes i will put all those

897
00:35:30,079 --> 00:35:32,800
uh not let me put in the pipe class here

898
00:35:32,800 --> 00:35:33,599
because i'm

899
00:35:33,599 --> 00:35:37,119
using the terminator here and uh

900
00:35:37,119 --> 00:35:39,280
you know i don't have a good buffer to

901
00:35:39,280 --> 00:35:40,400
show

902
00:35:40,400 --> 00:35:42,880
let me like less okay so take a look at

903
00:35:42,880 --> 00:35:43,520
this

904
00:35:43,520 --> 00:35:46,000
i have here that the all those strings

905
00:35:46,000 --> 00:35:47,200
here

906
00:35:47,200 --> 00:35:50,960
and take a look this

907
00:35:51,839 --> 00:35:54,800
okay not different informations here

908
00:35:54,800 --> 00:35:56,640
just say strings right so

909
00:35:56,640 --> 00:35:59,920
let me turn here and i will explain

910
00:35:59,920 --> 00:36:02,000
one thing about that i have here the

911
00:36:02,000 --> 00:36:04,079
string in the beginning right

912
00:36:04,079 --> 00:36:07,680
if you are using here the strings

913
00:36:09,280 --> 00:36:12,320
strings strings

914
00:36:12,320 --> 00:36:15,599
yes a uh

915
00:36:15,599 --> 00:36:18,320
it means all right and i put here the

916
00:36:18,320 --> 00:36:19,359
linux

917
00:36:19,359 --> 00:36:22,800
32 5

918
00:36:22,800 --> 00:36:26,000
last take a look what happened so i

919
00:36:26,000 --> 00:36:29,440
should i should see

920
00:36:29,440 --> 00:36:31,359
this information right because it's as a

921
00:36:31,359 --> 00:36:32,720
string right so

922
00:36:32,720 --> 00:36:34,240
when you click enter take a look this

923
00:36:34,240 --> 00:36:36,640
went where the place is start

924
00:36:36,640 --> 00:36:40,800
right so i can't see the elf information

925
00:36:40,800 --> 00:36:45,040
right take a look at this

926
00:36:46,079 --> 00:36:49,920
let me explain another thing using

927
00:36:49,920 --> 00:36:52,320
in a different way a different parade so

928
00:36:52,320 --> 00:36:53,040
let me

929
00:36:53,040 --> 00:36:55,920
go to a windows folder i have here

930
00:36:55,920 --> 00:36:58,800
windows file

931
00:36:59,520 --> 00:37:02,640
i have a simple one with cool

932
00:37:02,640 --> 00:37:05,520
very cool simple it's uh this is a p

933
00:37:05,520 --> 00:37:06,240
it's a p

934
00:37:06,240 --> 00:37:10,160
let me check who is it's another pe okay

935
00:37:10,160 --> 00:37:13,359
let me put here in uh xd and again

936
00:37:13,359 --> 00:37:16,000
lex the aminos nominal sorry and the

937
00:37:16,000 --> 00:37:16,640
dash

938
00:37:16,640 --> 00:37:19,920
uh went forward and

939
00:37:19,920 --> 00:37:22,480
put here

940
00:37:28,400 --> 00:37:33,040
sorry oh my goodness

941
00:37:33,760 --> 00:37:36,960
okay perfect take a look at this

942
00:37:36,960 --> 00:37:39,119
in the beginning of the file we have the

943
00:37:39,119 --> 00:37:40,640
mz

944
00:37:40,640 --> 00:37:42,560
information which means this is the one

945
00:37:42,560 --> 00:37:44,560
of this magic number of the pe

946
00:37:44,560 --> 00:37:47,040
right and here we have another string so

947
00:37:47,040 --> 00:37:48,079
let me

948
00:37:48,079 --> 00:37:51,920
put again but no

949
00:37:51,920 --> 00:37:55,040
informations about the the limitations

950
00:37:55,040 --> 00:37:56,880
of the bytes and i will put pipelast

951
00:37:56,880 --> 00:37:57,520
here

952
00:37:57,520 --> 00:37:59,839
because i would like to see many strings

953
00:37:59,839 --> 00:38:01,680
here so mz

954
00:38:01,680 --> 00:38:04,640
and this program cannot be run in dos

955
00:38:04,640 --> 00:38:05,280
mode

956
00:38:05,280 --> 00:38:08,320
and wherever here the pe signature it's

957
00:38:08,320 --> 00:38:09,200
it's here

958
00:38:09,200 --> 00:38:11,760
right and let's see oh here the session

959
00:38:11,760 --> 00:38:12,960
dot text

960
00:38:12,960 --> 00:38:16,240
another session uh

961
00:38:16,240 --> 00:38:19,680
or data right so uh in

962
00:38:19,680 --> 00:38:22,320
usually it's uh not usually not so

963
00:38:22,320 --> 00:38:23,920
related really only it's or

964
00:38:23,920 --> 00:38:27,040
all data it's data it's another session

965
00:38:27,040 --> 00:38:27,599
each

966
00:38:27,599 --> 00:38:30,640
session or src usually related to an

967
00:38:30,640 --> 00:38:33,680
image or you know

968
00:38:33,680 --> 00:38:35,839
or something like that and many other

969
00:38:35,839 --> 00:38:37,040
strings rear

970
00:38:37,040 --> 00:38:40,480
here but if you as i could hear these

971
00:38:40,480 --> 00:38:42,240
strings

972
00:38:42,240 --> 00:38:45,440
take a look this is strings such all

973
00:38:45,440 --> 00:38:48,880
please so what should be the first

974
00:38:48,880 --> 00:38:52,880
letter the first thing string mz right

975
00:38:52,880 --> 00:38:56,720
but does it

976
00:38:56,720 --> 00:39:00,960
happen why

977
00:39:00,960 --> 00:39:03,440
it's a good question but yeah you need

978
00:39:03,440 --> 00:39:04,720
to understand about the what

979
00:39:04,720 --> 00:39:06,720
none of these three oh my goodness i

980
00:39:06,720 --> 00:39:08,800
don't like to read them off philly

981
00:39:08,800 --> 00:39:10,240
it's a totally it's not a

982
00:39:10,240 --> 00:39:11,839
 guys

983
00:39:11,839 --> 00:39:13,359
you need to understand about that right

984
00:39:13,359 --> 00:39:15,359
so strings what

985
00:39:15,359 --> 00:39:18,079
print the sequence the sequence of the

986
00:39:18,079 --> 00:39:19,520
printable characters

987
00:39:19,520 --> 00:39:23,839
in files right so for each file given

988
00:39:23,839 --> 00:39:26,320
you know strings prints the printable

989
00:39:26,320 --> 00:39:26,960
character

990
00:39:26,960 --> 00:39:31,599
sequence that are at least what

991
00:39:31,839 --> 00:39:36,400
at least four characters long

992
00:39:36,400 --> 00:39:40,240
because of this don't

993
00:39:40,240 --> 00:39:43,280
show or don't appears the mz because

994
00:39:43,280 --> 00:39:43,599
it's

995
00:39:43,599 --> 00:39:46,800
two characters and elf because it's

996
00:39:46,800 --> 00:39:50,400
three characters that is the key

997
00:39:50,400 --> 00:39:52,960
right so i even understand those ways i

998
00:39:52,960 --> 00:39:53,760
just like to

999
00:39:53,760 --> 00:39:56,400
as i could some or perform some comments

1000
00:39:56,400 --> 00:39:56,880
or

1001
00:39:56,880 --> 00:39:59,680
using some tools but is i know maybe

1002
00:39:59,680 --> 00:40:01,200
it's useful but

1003
00:40:01,200 --> 00:40:04,400
it's useless when you don't know about

1004
00:40:04,400 --> 00:40:05,440
the basis

1005
00:40:05,440 --> 00:40:07,440
right so because of this union we need

1006
00:40:07,440 --> 00:40:08,800
understand about the base

1007
00:40:08,800 --> 00:40:11,119
so let me return about my presentations

1008
00:40:11,119 --> 00:40:11,839
here

1009
00:40:11,839 --> 00:40:14,000
and when you talk about the pdf is

1010
00:40:14,000 --> 00:40:15,760
different you understand about the

1011
00:40:15,760 --> 00:40:17,440
structure because the structure is

1012
00:40:17,440 --> 00:40:18,640
almost different

1013
00:40:18,640 --> 00:40:21,599
not almost it's a similar of course but

1014
00:40:21,599 --> 00:40:23,599
maybe it's uh

1015
00:40:23,599 --> 00:40:26,720
maybe it's a maybe similar or not but in

1016
00:40:26,720 --> 00:40:28,000
general pdf has a

1017
00:40:28,000 --> 00:40:30,160
four parts right first of all it's a

1018
00:40:30,160 --> 00:40:31,040
header it's

1019
00:40:31,040 --> 00:40:32,640
almost the same when you have another

1020
00:40:32,640 --> 00:40:34,480
different full files

1021
00:40:34,480 --> 00:40:36,319
and you have a body it's a different

1022
00:40:36,319 --> 00:40:37,680
because you have many

1023
00:40:37,680 --> 00:40:40,000
information content inside of this body

1024
00:40:40,000 --> 00:40:41,760
you have a cross reference table

1025
00:40:41,760 --> 00:40:45,040
and you have a trailer in the end of the

1026
00:40:45,040 --> 00:40:46,000
fire right so

1027
00:40:46,000 --> 00:40:49,359
it means is you can see in this way

1028
00:40:49,359 --> 00:40:51,760
in the beginning you can see the header

1029
00:40:51,760 --> 00:40:52,480
usually

1030
00:40:52,480 --> 00:40:54,640
you can see the version of the number

1031
00:40:54,640 --> 00:40:57,119
you see the body with the pages

1032
00:40:57,119 --> 00:40:59,839
image font and bookmark and formulas

1033
00:40:59,839 --> 00:41:02,720
object because you know pdf it means

1034
00:41:02,720 --> 00:41:05,359
uh it's a not a text it's a text file

1035
00:41:05,359 --> 00:41:07,359
but with many

1036
00:41:07,359 --> 00:41:10,400
polar or maybe you know good images did

1037
00:41:10,400 --> 00:41:10,960
you know

1038
00:41:10,960 --> 00:41:14,240
i'm joking but you know you have here

1039
00:41:14,240 --> 00:41:15,680
the interesting informations cross

1040
00:41:15,680 --> 00:41:17,359
reference table it's very

1041
00:41:17,359 --> 00:41:19,520
interesting because you have a locations

1042
00:41:19,520 --> 00:41:20,480
of the objects

1043
00:41:20,480 --> 00:41:23,520
if in the file for a random access right

1044
00:41:23,520 --> 00:41:24,160
so

1045
00:41:24,160 --> 00:41:26,240
location of the certain objects eating

1046
00:41:26,240 --> 00:41:27,520
the body

1047
00:41:27,520 --> 00:41:28,960
and locations of the cross reference

1048
00:41:28,960 --> 00:41:31,359
table in the file it means all those

1049
00:41:31,359 --> 00:41:33,280
cross reference table

1050
00:41:33,280 --> 00:41:36,480
it's is referenced

1051
00:41:36,480 --> 00:41:38,640
in another object so for example let's

1052
00:41:38,640 --> 00:41:40,000
suppose you have

1053
00:41:40,000 --> 00:41:43,520
uh 20 objects inside so many of these

1054
00:41:43,520 --> 00:41:44,560
objects

1055
00:41:44,560 --> 00:41:47,680
it is a reference themselves

1056
00:41:47,680 --> 00:41:51,119
right uh itself in in this

1057
00:41:51,119 --> 00:41:54,319
way right so i'll explain more in in a

1058
00:41:54,319 --> 00:41:55,520
demo now

1059
00:41:55,520 --> 00:41:59,359
so not here okay so let me explain about

1060
00:41:59,359 --> 00:41:59,760
that

1061
00:41:59,760 --> 00:42:02,240
so i will show you i have a folder here

1062
00:42:02,240 --> 00:42:04,480
i have a sample here i have a file

1063
00:42:04,480 --> 00:42:07,359
that i i didn't have is this file it's

1064
00:42:07,359 --> 00:42:08,800
malicious or so i do

1065
00:42:08,800 --> 00:42:11,839
execute this first tool pdf id

1066
00:42:11,839 --> 00:42:14,960
provided by dj steven by the way so here

1067
00:42:14,960 --> 00:42:16,960
as you can see the header you know

1068
00:42:16,960 --> 00:42:18,160
percent pdf

1069
00:42:18,160 --> 00:42:21,280
and you have object 15

1070
00:42:21,280 --> 00:42:23,920
right you have a streaming two and you

1071
00:42:23,920 --> 00:42:25,200
have a cross reference table

1072
00:42:25,200 --> 00:42:26,400
and take a look this is a very

1073
00:42:26,400 --> 00:42:28,240
interesting information here

1074
00:42:28,240 --> 00:42:30,880
because usually these tools when

1075
00:42:30,880 --> 00:42:32,640
probably when dj steven created this

1076
00:42:32,640 --> 00:42:33,200
tool

1077
00:42:33,200 --> 00:42:36,720
during he understood about

1078
00:42:36,720 --> 00:42:38,960
the structure of the pdf makes sense for

1079
00:42:38,960 --> 00:42:39,760
you

1080
00:42:39,760 --> 00:42:43,200
and then after that he can create these

1081
00:42:43,200 --> 00:42:46,720
tools to scan some informations inside

1082
00:42:46,720 --> 00:42:47,760
of the

1083
00:42:47,760 --> 00:42:50,800
pdf right so these uh

1084
00:42:50,800 --> 00:42:52,800
tools as they put some scanning inside

1085
00:42:52,800 --> 00:42:54,079
of the pdf

1086
00:42:54,079 --> 00:42:56,560
and they can find for example the name

1087
00:42:56,560 --> 00:42:57,680
of the object

1088
00:42:57,680 --> 00:43:01,040
if the pdf has some e-stream usually

1089
00:43:01,040 --> 00:43:02,720
when the attacker

1090
00:43:02,720 --> 00:43:05,280
like to put some a malicious software

1091
00:43:05,280 --> 00:43:07,760
they use they stream to put some alicia

1092
00:43:07,760 --> 00:43:10,160
things inside of the stream right okay

1093
00:43:10,160 --> 00:43:10,800
so this is

1094
00:43:10,800 --> 00:43:14,079
these tools um you can

1095
00:43:14,079 --> 00:43:17,119
uh or this this tool uh got

1096
00:43:17,119 --> 00:43:20,240
to find information inside the uh the

1097
00:43:20,240 --> 00:43:21,359
pdf right

1098
00:43:21,359 --> 00:43:24,160
and take a look this dash page that

1099
00:43:24,160 --> 00:43:24,720
script

1100
00:43:24,720 --> 00:43:28,240
encrypt dash slash not dash slash right

1101
00:43:28,240 --> 00:43:31,359
so slash object stream

1102
00:43:31,359 --> 00:43:34,560
javascript js javascript a a open

1103
00:43:34,560 --> 00:43:36,720
actions and another information here

1104
00:43:36,720 --> 00:43:40,000
so when you see this slash it

1105
00:43:40,000 --> 00:43:43,119
means that all those informations

1106
00:43:43,119 --> 00:43:46,400
are inside of this main information

1107
00:43:46,400 --> 00:43:49,440
here right so we don't have to see more

1108
00:43:49,440 --> 00:43:50,480
about the man

1109
00:43:50,480 --> 00:43:52,480
okay of the pdf id but you can see you

1110
00:43:52,480 --> 00:43:54,880
can read you need to read

1111
00:43:54,880 --> 00:43:57,200
after this workshop these conversations

1112
00:43:57,200 --> 00:43:58,960
right so let's continue to see the video

1113
00:43:58,960 --> 00:44:01,440
take a look this we have five javascript

1114
00:44:01,440 --> 00:44:02,240
inside

1115
00:44:02,240 --> 00:44:04,640
of this pdf make sense to you and here

1116
00:44:04,640 --> 00:44:06,240
we have another interesting information

1117
00:44:06,240 --> 00:44:08,160
open action what is mean what do you

1118
00:44:08,160 --> 00:44:10,160
mean filipino connection inside of pdf

1119
00:44:10,160 --> 00:44:11,760
it's here it's very

1120
00:44:11,760 --> 00:44:15,359
very important informations

1121
00:44:18,079 --> 00:44:21,119
and when you have some open action

1122
00:44:21,119 --> 00:44:22,160
inside of pdf

1123
00:44:22,160 --> 00:44:25,920
it means that the user just needs to

1124
00:44:25,920 --> 00:44:27,599
download a file

1125
00:44:27,599 --> 00:44:31,760
right and after that when the file

1126
00:44:31,760 --> 00:44:34,960
is downloaded in your environment

1127
00:44:34,960 --> 00:44:38,800
the pdf can as a good themselves

1128
00:44:38,800 --> 00:44:41,040
inside of your environment because they

1129
00:44:41,040 --> 00:44:43,359
have this open action

1130
00:44:43,359 --> 00:44:46,400
action right this uh

1131
00:44:46,400 --> 00:44:49,520
this action defining inside of

1132
00:44:49,520 --> 00:44:51,440
the fire right heath and the fire

1133
00:44:51,440 --> 00:44:52,880
perfect so if you

1134
00:44:52,880 --> 00:44:55,280
when you will analyze some pdf and you

1135
00:44:55,280 --> 00:44:56,560
see some open action

1136
00:44:56,560 --> 00:45:00,000
or a a it's mean the same meaning right

1137
00:45:00,000 --> 00:45:00,880
so

1138
00:45:00,880 --> 00:45:03,359
the pdf just the user just need to as to

1139
00:45:03,359 --> 00:45:05,520
download the file inside of the

1140
00:45:05,520 --> 00:45:08,640
the machine and after that the pdf will

1141
00:45:08,640 --> 00:45:10,079
execute themselves right

1142
00:45:10,079 --> 00:45:12,319
so okay let's continue to analyze so

1143
00:45:12,319 --> 00:45:14,400
after that all

1144
00:45:14,400 --> 00:45:16,400
knowing this knowing this information i

1145
00:45:16,400 --> 00:45:18,000
execute another common

1146
00:45:18,000 --> 00:45:20,720
pdf dash parser it's another tool

1147
00:45:20,720 --> 00:45:22,319
provided by dda steven

1148
00:45:22,319 --> 00:45:25,119
i execute this with dash that's run it's

1149
00:45:25,119 --> 00:45:26,000
been i view

1150
00:45:26,000 --> 00:45:28,079
the idea here is to collect all those

1151
00:45:28,079 --> 00:45:30,319
random informations inside of this pdf

1152
00:45:30,319 --> 00:45:33,599
okay perfect let me understand about

1153
00:45:33,599 --> 00:45:34,319
this

1154
00:45:34,319 --> 00:45:37,920
uh those results so

1155
00:45:37,920 --> 00:45:40,079
here the header take a look this and

1156
00:45:40,079 --> 00:45:41,359
after that i have object

1157
00:45:41,359 --> 00:45:44,000
one and take a look this object one

1158
00:45:44,000 --> 00:45:45,200
referring what

1159
00:45:45,200 --> 00:45:48,400
referring object true object three

1160
00:45:48,400 --> 00:45:51,920
object four object five six

1161
00:45:51,920 --> 00:45:55,440
and seven but in the beginning when

1162
00:45:55,440 --> 00:45:59,520
i we started analyze this file we had

1163
00:45:59,520 --> 00:46:03,040
a 15 we remember so but i just can't see

1164
00:46:03,040 --> 00:46:03,760
here

1165
00:46:03,760 --> 00:46:07,119
seven but i have 15.

1166
00:46:07,119 --> 00:46:10,000
you know don't forgot don't forget this

1167
00:46:10,000 --> 00:46:11,280
number right so

1168
00:46:11,280 --> 00:46:13,359
and i have here an object one reference

1169
00:46:13,359 --> 00:46:14,960
to the javascript

1170
00:46:14,960 --> 00:46:17,839
and take a look at this javascript and i

1171
00:46:17,839 --> 00:46:18,960
have here open action

1172
00:46:18,960 --> 00:46:21,760
oops take a look this interesting thing

1173
00:46:21,760 --> 00:46:22,960
i have an open action

1174
00:46:22,960 --> 00:46:25,200
and and there is a good dysfunction

1175
00:46:25,200 --> 00:46:26,800
inside of this bitcoin machine take a

1176
00:46:26,800 --> 00:46:27,200
look

1177
00:46:27,200 --> 00:46:30,240
what action performance

1178
00:46:30,240 --> 00:46:32,720
performing or performing this action

1179
00:46:32,720 --> 00:46:35,760
performed inside the victim machine

1180
00:46:35,760 --> 00:46:39,599
is some action related a what

1181
00:46:39,599 --> 00:46:43,839
related to some javascript right so we

1182
00:46:43,839 --> 00:46:45,680
can see you can understand this

1183
00:46:45,680 --> 00:46:47,760
okay so let's continue to analyze but i

1184
00:46:47,760 --> 00:46:49,359
need to unders i don't understand

1185
00:46:49,359 --> 00:46:51,599
the code but i know that is javascript

1186
00:46:51,599 --> 00:46:52,960
because i am seeing here

1187
00:46:52,960 --> 00:46:56,079
so okay let me return

1188
00:46:56,079 --> 00:46:58,720
here sorry okay so i have here the

1189
00:46:58,720 --> 00:46:59,680
object two

1190
00:46:59,680 --> 00:47:02,880
three and take a look this here in four

1191
00:47:02,880 --> 00:47:05,440
or i have reference object eight and

1192
00:47:05,440 --> 00:47:07,119
object nine guys

1193
00:47:07,119 --> 00:47:10,160
okay so now i have eight and nine object

1194
00:47:10,160 --> 00:47:13,359
right so we need to see more deeply take

1195
00:47:13,359 --> 00:47:14,880
a look this oops

1196
00:47:14,880 --> 00:47:17,200
object seven take a look what appears

1197
00:47:17,200 --> 00:47:18,560
here the object

1198
00:47:18,560 --> 00:47:22,319
tn but in inside of the or eating

1199
00:47:22,319 --> 00:47:24,720
the objecting we have a what i have a

1200
00:47:24,720 --> 00:47:25,680
javascript

1201
00:47:25,680 --> 00:47:27,599
so i have one the first javascript on

1202
00:47:27,599 --> 00:47:29,280
the first but i have javascript inside

1203
00:47:29,280 --> 00:47:30,720
that object 10.

1204
00:47:30,720 --> 00:47:34,240
perfect let's continue to see here oops

1205
00:47:34,240 --> 00:47:37,200
object nine i have a reference to object

1206
00:47:37,200 --> 00:47:39,839
four right because represent object four

1207
00:47:39,839 --> 00:47:40,800
reference

1208
00:47:40,800 --> 00:47:43,440
object nine perfect but have here

1209
00:47:43,440 --> 00:47:44,400
another object

1210
00:47:44,400 --> 00:47:48,079
eleven do you remember an explanation of

1211
00:47:48,079 --> 00:47:49,200
the structure

1212
00:47:49,200 --> 00:47:51,920
all those objects are referenced in

1213
00:47:51,920 --> 00:47:52,559
themselves

1214
00:47:52,559 --> 00:47:56,240
right so oh let continues here

1215
00:47:56,240 --> 00:47:58,880
the object 10 do you remember we have a

1216
00:47:58,880 --> 00:47:59,920
javascript

1217
00:47:59,920 --> 00:48:02,160
okay and i have javascript but i have

1218
00:48:02,160 --> 00:48:03,920
another referencing

1219
00:48:03,920 --> 00:48:07,440
object 12. oh i need to see

1220
00:48:07,440 --> 00:48:09,760
there but take a look this a different

1221
00:48:09,760 --> 00:48:10,880
information

1222
00:48:10,880 --> 00:48:14,079
in object 11 we have a what we have

1223
00:48:14,079 --> 00:48:15,920
not referenced but i have what

1224
00:48:15,920 --> 00:48:17,280
information we have here

1225
00:48:17,280 --> 00:48:21,119
contains a stream it means i have here

1226
00:48:21,119 --> 00:48:23,520
something inside of this stream but i i

1227
00:48:23,520 --> 00:48:24,319
don't know what

1228
00:48:24,319 --> 00:48:26,720
this means in this case but i need to

1229
00:48:26,720 --> 00:48:28,000
investigate right

1230
00:48:28,000 --> 00:48:29,599
so and when i have another interesting

1231
00:48:29,599 --> 00:48:31,760
information flat decode

1232
00:48:31,760 --> 00:48:34,240
means i need to decode this information

1233
00:48:34,240 --> 00:48:35,040
inside of this

1234
00:48:35,040 --> 00:48:37,280
string but i have here the left the

1235
00:48:37,280 --> 00:48:38,640
remember the left is

1236
00:48:38,640 --> 00:48:40,720
it's really it means it's it's related

1237
00:48:40,720 --> 00:48:41,920
to a size

1238
00:48:41,920 --> 00:48:44,640
right so but the size is at 36 it's not

1239
00:48:44,640 --> 00:48:45,920
too much it's bigger

1240
00:48:45,920 --> 00:48:47,760
it's not bigger it's it's more very very

1241
00:48:47,760 --> 00:48:50,079
small but have here a object

1242
00:48:50,079 --> 00:48:53,280
12 you remember but another reference oh

1243
00:48:53,280 --> 00:48:53,839
my goodness

1244
00:48:53,839 --> 00:48:57,599
it's 13 okay but here guys take a look

1245
00:48:57,599 --> 00:48:59,599
at this

1246
00:48:59,599 --> 00:49:02,720
in object 13 i have a streaming

1247
00:49:02,720 --> 00:49:04,400
flat the code but take a look this is

1248
00:49:04,400 --> 00:49:06,240
the sizing it's

1249
00:49:06,240 --> 00:49:10,240
too big so i need to see more deeply

1250
00:49:10,240 --> 00:49:11,680
inside of this

1251
00:49:11,680 --> 00:49:13,680
maybe here i have some suspicions i have

1252
00:49:13,680 --> 00:49:15,200
object 14

1253
00:49:15,200 --> 00:49:19,200
and 15. okay so next steps to see what

1254
00:49:19,200 --> 00:49:21,359
the 13 object because i have here the

1255
00:49:21,359 --> 00:49:23,760
stream right a big stream

1256
00:49:23,760 --> 00:49:26,640
and i really could this pdf the cup

1257
00:49:26,640 --> 00:49:28,319
because you can use to compress

1258
00:49:28,319 --> 00:49:31,280
for a pdf inside but i i will use

1259
00:49:31,280 --> 00:49:33,200
another thing to uncompress because if i

1260
00:49:33,200 --> 00:49:34,559
can use the compress

1261
00:49:34,559 --> 00:49:36,559
i can uncompress the idea here is to

1262
00:49:36,559 --> 00:49:39,280
uncompress all those informations inside

1263
00:49:39,280 --> 00:49:42,839
of this pdf so i do as i could this

1264
00:49:42,839 --> 00:49:44,160
output

1265
00:49:44,160 --> 00:49:47,040
in this output is done text and take a

1266
00:49:47,040 --> 00:49:47,520
look so

1267
00:49:47,520 --> 00:49:51,520
i can find here wow

1268
00:49:53,280 --> 00:49:59,200
pretty cool take a look at this

1269
00:49:59,200 --> 00:50:02,079
streaming and the size i uncompressed

1270
00:50:02,079 --> 00:50:02,800
the code

1271
00:50:02,800 --> 00:50:06,720
and i have here the first techniques

1272
00:50:06,720 --> 00:50:10,000
technique i found here the

1273
00:50:10,000 --> 00:50:13,440
javascript obfuscated so i need to what

1274
00:50:13,440 --> 00:50:15,440
there's a forescape of this code

1275
00:50:15,440 --> 00:50:17,440
to try and understand more deeply what

1276
00:50:17,440 --> 00:50:18,640
this code

1277
00:50:18,640 --> 00:50:22,240
means needs exactly in my environment

1278
00:50:22,240 --> 00:50:23,760
or in this case indeed in the with my

1279
00:50:23,760 --> 00:50:25,359
machine right so

1280
00:50:25,359 --> 00:50:29,400
next step i will cop this and i called

1281
00:50:29,400 --> 00:50:31,520
payload.html white because i

1282
00:50:31,520 --> 00:50:34,960
do remember i'm talking to uh javascript

1283
00:50:34,960 --> 00:50:37,119
so sometimes your javascript is related

1284
00:50:37,119 --> 00:50:38,880
to a web application

1285
00:50:38,880 --> 00:50:42,559
so imc i know and see i

1286
00:50:42,559 --> 00:50:45,599
saw some evil parameters and i ch

1287
00:50:45,599 --> 00:50:48,640
is changing this parameter to try

1288
00:50:48,640 --> 00:50:51,680
uh watch this information in some

1289
00:50:51,680 --> 00:50:55,200
uh document right in a in a browser

1290
00:50:55,200 --> 00:50:57,359
right and if you see here take a look

1291
00:50:57,359 --> 00:50:58,800
these different colors by the way

1292
00:50:58,800 --> 00:51:01,040
probably i have something here inside

1293
00:51:01,040 --> 00:51:03,200
and after that i can investigate more

1294
00:51:03,200 --> 00:51:05,760
that but as you can see here

1295
00:51:05,760 --> 00:51:07,520
the two already identified some

1296
00:51:07,520 --> 00:51:09,920
different colors here so i am putting

1297
00:51:09,920 --> 00:51:11,839
the document right because i will write

1298
00:51:11,839 --> 00:51:13,839
this information in a web browser

1299
00:51:13,839 --> 00:51:16,240
and take a look what happened i am i

1300
00:51:16,240 --> 00:51:17,440
save here

1301
00:51:17,440 --> 00:51:20,720
the payload.html right

1302
00:51:20,720 --> 00:51:24,000
perfect and i will give the permission

1303
00:51:24,000 --> 00:51:27,040
to execute themselves

1304
00:51:27,040 --> 00:51:29,760
in the web browser and i will open this

1305
00:51:29,760 --> 00:51:30,880
in uh

1306
00:51:30,880 --> 00:51:37,839
okay everything it works

1307
00:51:39,839 --> 00:51:43,839
wow take a look this is what i am

1308
00:51:44,480 --> 00:51:48,559
found a payload you know what

1309
00:51:48,559 --> 00:51:51,599
what that means it's very simple here we

1310
00:51:51,599 --> 00:51:52,240
have a

1311
00:51:52,240 --> 00:51:54,960
package responsible to downloading the

1312
00:51:54,960 --> 00:51:56,079
hitman machine

1313
00:51:56,079 --> 00:51:58,960
and this package and this part of this

1314
00:51:58,960 --> 00:51:59,359
code

1315
00:51:59,359 --> 00:52:01,920
is responsible to call back to the

1316
00:52:01,920 --> 00:52:04,160
commanding controller from the attacker

1317
00:52:04,160 --> 00:52:06,240
you see so inside of this java

1318
00:52:06,240 --> 00:52:07,359
javascript

1319
00:52:07,359 --> 00:52:10,880
obfuscated i found a payload responsible

1320
00:52:10,880 --> 00:52:12,000
to call

1321
00:52:12,000 --> 00:52:15,040
to the cnc from the attacker you see

1322
00:52:15,040 --> 00:52:18,240
so but here if you see yeah maybe you

1323
00:52:18,240 --> 00:52:19,760
need to understand more

1324
00:52:19,760 --> 00:52:22,800
about that i am season percent here and

1325
00:52:22,800 --> 00:52:24,079
a very

1326
00:52:24,079 --> 00:52:27,440
uh you know common behavior not behavior

1327
00:52:27,440 --> 00:52:28,079
but

1328
00:52:28,079 --> 00:52:31,200
it means maybe make sense to investigate

1329
00:52:31,200 --> 00:52:32,559
more about that right

1330
00:52:32,559 --> 00:52:35,760
so the next step that i did

1331
00:52:35,760 --> 00:52:38,960
in this or that i am doing i do

1332
00:52:38,960 --> 00:52:41,760
and oh my goodness i have some problem

1333
00:52:41,760 --> 00:52:44,000
with the verb you know

1334
00:52:44,000 --> 00:52:46,000
but the next step is i will cop this

1335
00:52:46,000 --> 00:52:48,000
code because i will try

1336
00:52:48,000 --> 00:52:50,079
to continue to investigate because i am

1337
00:52:50,079 --> 00:52:51,520
see the behavior so i'm

1338
00:52:51,520 --> 00:52:55,280
setting this nano again and i i will put

1339
00:52:55,280 --> 00:52:58,319
i i i put the real payload

1340
00:52:58,319 --> 00:53:02,160
right and i pass this i save the folder

1341
00:53:02,160 --> 00:53:04,319
right and after that take a look what i

1342
00:53:04,319 --> 00:53:05,599
did i set this

1343
00:53:05,599 --> 00:53:10,000
the set because i am cut this percent

1344
00:53:10,000 --> 00:53:13,280
and i will then my idea is to just see

1345
00:53:13,280 --> 00:53:16,000
this real information here take a look

1346
00:53:16,000 --> 00:53:16,960
this this simple

1347
00:53:16,960 --> 00:53:19,760
encode because here we have another

1348
00:53:19,760 --> 00:53:20,559
technique

1349
00:53:20,559 --> 00:53:23,359
the encode technique do you remember you

1350
00:53:23,359 --> 00:53:25,680
can use different encodings to like

1351
00:53:25,680 --> 00:53:29,200
you know um uh

1352
00:53:29,200 --> 00:53:31,359
let me another in this case i'll be

1353
00:53:31,359 --> 00:53:32,720
using unicode based

1354
00:53:32,720 --> 00:53:35,119
in in two bytes it's different but you

1355
00:53:35,119 --> 00:53:35,839
can use an

1356
00:53:35,839 --> 00:53:39,599
and basic uh basis 64 baby

1357
00:53:39,599 --> 00:53:42,720
16 baby you know 32

1358
00:53:42,720 --> 00:53:44,319
encrypting the encrypt you can use in

1359
00:53:44,319 --> 00:53:45,760
different encoding

1360
00:53:45,760 --> 00:53:48,480
in this case the attacker uses an older

1361
00:53:48,480 --> 00:53:49,040
technique

1362
00:53:49,040 --> 00:53:52,640
it's encoded based on

1363
00:53:52,640 --> 00:53:56,319
ec2 based on unicode it means

1364
00:53:56,319 --> 00:53:58,400
and it's explained uh you know it's low

1365
00:53:58,400 --> 00:53:59,440
because it's

1366
00:53:59,440 --> 00:54:02,880
it's uh oldest it's older

1367
00:54:02,880 --> 00:54:04,800
it's it's older this kind of technique

1368
00:54:04,800 --> 00:54:06,440
because it's based on

1369
00:54:06,440 --> 00:54:10,559
ec2 ec2 what pays it in only code

1370
00:54:10,559 --> 00:54:13,599
is not any in an ascii right it's

1371
00:54:13,599 --> 00:54:15,440
different it based on unicode

1372
00:54:15,440 --> 00:54:17,520
because it's too bad as key it's on one

1373
00:54:17,520 --> 00:54:18,559
byte right

1374
00:54:18,559 --> 00:54:20,640
so here i have the unicode okay but

1375
00:54:20,640 --> 00:54:22,240
maybe you are asking

1376
00:54:22,240 --> 00:54:24,640
uh if you are asking for example philip

1377
00:54:24,640 --> 00:54:25,760
you just show us

1378
00:54:25,760 --> 00:54:27,680
about the you know linux platform but i

1379
00:54:27,680 --> 00:54:29,119
will go i like to work with them or

1380
00:54:29,119 --> 00:54:30,160
analysis with a

1381
00:54:30,160 --> 00:54:33,760
windows environment in the works i have

1382
00:54:33,760 --> 00:54:36,799
another thing to you i knew i used in

1383
00:54:36,799 --> 00:54:39,359
this case mozilla by blobby

1384
00:54:39,359 --> 00:54:42,240
it's a very cool platform i passed here

1385
00:54:42,240 --> 00:54:43,040
the same

1386
00:54:43,040 --> 00:54:45,280
same code take a look at this the same

1387
00:54:45,280 --> 00:54:46,480
percent

1388
00:54:46,480 --> 00:54:49,200
and i cut this percent of this

1389
00:54:49,200 --> 00:54:50,880
information take a look this

1390
00:54:50,880 --> 00:54:54,240
and i generate what i generate a x-file

1391
00:54:54,240 --> 00:54:57,920
doc binary because my idea is is to

1392
00:54:57,920 --> 00:54:59,280
generate this binary because do you

1393
00:54:59,280 --> 00:55:00,480
remember the a called

1394
00:55:00,480 --> 00:55:03,660
technique using the ec2 by

1395
00:55:03,660 --> 00:55:05,280
[Music]

1396
00:55:05,280 --> 00:55:08,240
unicode right so i generate in this

1397
00:55:08,240 --> 00:55:08,799
casing

1398
00:55:08,799 --> 00:55:11,280
using this platform in mozilla the x

1399
00:55:11,280 --> 00:55:12,559
file binary and

1400
00:55:12,559 --> 00:55:15,839
in the end what i did i use short

1401
00:55:15,839 --> 00:55:18,559
search from the dairy stevens again to

1402
00:55:18,559 --> 00:55:19,440
try and find

1403
00:55:19,440 --> 00:55:22,240
what uh inside of this file x file

1404
00:55:22,240 --> 00:55:23,280
binary

1405
00:55:23,280 --> 00:55:26,319
if i found some http

1406
00:55:26,319 --> 00:55:29,599
request and what and take a look this

1407
00:55:29,599 --> 00:55:31,599
what i found here

1408
00:55:31,599 --> 00:55:34,960
the server from the

1409
00:55:34,960 --> 00:55:38,240
attacker because this code

1410
00:55:38,240 --> 00:55:41,520
it is using this unicode right so this

1411
00:55:41,520 --> 00:55:45,040
uh command controller it was

1412
00:55:45,040 --> 00:55:48,799
in estonia in that time right so i found

1413
00:55:48,799 --> 00:55:49,200
the

1414
00:55:49,200 --> 00:55:51,200
commanding controller for for the attack

1415
00:55:51,200 --> 00:55:54,000
right so if you have now question guys i

1416
00:55:54,000 --> 00:55:54,880
am hoping

1417
00:55:54,880 --> 00:55:57,280
to talk to you but just to finish up my

1418
00:55:57,280 --> 00:55:58,319
presentations

1419
00:55:58,319 --> 00:56:00,240
here our conversation during this

1420
00:56:00,240 --> 00:56:01,760
workshop

1421
00:56:01,760 --> 00:56:04,079
the point here is you need to understand

1422
00:56:04,079 --> 00:56:05,520
about those ways that i

1423
00:56:05,520 --> 00:56:07,599
explained during this conversation and

1424
00:56:07,599 --> 00:56:09,280
during this workshop

1425
00:56:09,280 --> 00:56:11,920
and another point here take a look i

1426
00:56:11,920 --> 00:56:13,359
found the file

1427
00:56:13,359 --> 00:56:15,920
pdf file inside this pdf has a

1428
00:56:15,920 --> 00:56:16,880
javascript

1429
00:56:16,880 --> 00:56:20,079
do you remember do disrupts just this

1430
00:56:20,079 --> 00:56:21,280
javascript it was

1431
00:56:21,280 --> 00:56:24,400
uh using the obfuscation techniques we

1432
00:56:24,400 --> 00:56:24,880
remember

1433
00:56:24,880 --> 00:56:27,920
inside of this pdf we had the open

1434
00:56:27,920 --> 00:56:29,359
action it means just

1435
00:56:29,359 --> 00:56:31,920
the user needs to download the file and

1436
00:56:31,920 --> 00:56:32,720
after that

1437
00:56:32,720 --> 00:56:35,359
this open action will execute this

1438
00:56:35,359 --> 00:56:36,480
javascript

1439
00:56:36,480 --> 00:56:39,839
that is obfuscated inside of this

1440
00:56:39,839 --> 00:56:40,559
javascript

1441
00:56:40,559 --> 00:56:44,960
we found the payload responsible to

1442
00:56:44,960 --> 00:56:48,079
uh connect uh

1443
00:56:48,079 --> 00:56:51,520
to the cnc right the callback

1444
00:56:51,520 --> 00:56:54,480
to the vitamin machine from the cnc the

1445
00:56:54,480 --> 00:56:55,839
commanding controller

1446
00:56:55,839 --> 00:57:00,240
using what using a unicode techniques

1447
00:57:00,240 --> 00:57:02,880
technique to encode the information of

1448
00:57:02,880 --> 00:57:03,599
the

1449
00:57:03,599 --> 00:57:06,880
eyepiece or the eyepiece of the ip from

1450
00:57:06,880 --> 00:57:11,520
the attacker it was in estonia europe

1451
00:57:11,520 --> 00:57:14,400
right so guys thank you so much for

1452
00:57:14,400 --> 00:57:15,680
being here with me

1453
00:57:15,680 --> 00:57:18,559
thank you for having me this event and

1454
00:57:18,559 --> 00:57:19,119
again

1455
00:57:19,119 --> 00:57:21,200
hear my contact on social media so if

1456
00:57:21,200 --> 00:57:22,640
you have any question please

1457
00:57:22,640 --> 00:57:25,920
let me know and you know keeping hockey

1458
00:57:25,920 --> 00:57:26,799
and if you

1459
00:57:26,799 --> 00:57:31,119
need something count everything on me

1460
00:57:31,119 --> 00:57:33,920
not everything actually you can count on

1461
00:57:33,920 --> 00:57:40,400
me always

