1
00:00:00,000 --> 00:00:06,420
yeah my name is<font color="#CCCCCC"> capers and I'm a senior</font>

2
00:00:04,019 --> 00:00:09,800
<font color="#CCCCCC">security analyst box I represent the</font>

3
00:00:06,420 --> 00:00:14,269
entire<font color="#E5E5E5"> Ohio branch of official box</font>

4
00:00:09,800 --> 00:00:16,320
office<font color="#E5E5E5"> today we're going to do</font>

5
00:00:14,269 --> 00:00:21,240
<font color="#CCCCCC">introduction to privilege escalation and</font>

6
00:00:16,320 --> 00:00:23,400
linux-based systems<font color="#E5E5E5"> so this is I came in</font>

7
00:00:21,240 --> 00:00:25,470
through web app with what develop

8
00:00:23,400 --> 00:00:27,060
testing<font color="#E5E5E5"> and when I first got into</font>

9
00:00:25,470 --> 00:00:28,470
servers<font color="#E5E5E5"> when I finally made it through</font>

10
00:00:27,060 --> 00:00:29,820
the applications I had no idea<font color="#E5E5E5"> what to</font>

11
00:00:28,470 --> 00:00:31,948
do particularly in Linux

12
00:00:29,820 --> 00:00:35,730
so this talk starts<font color="#CCCCCC"> basically from that</font>

13
00:00:31,949 --> 00:00:38,129
point<font color="#E5E5E5"> and goes through basic privilege</font>

14
00:00:35,730 --> 00:00:50,129
escalation<font color="#E5E5E5"> paths once you're in the</font>

15
00:00:38,129 --> 00:00:52,610
<font color="#E5E5E5">server system it's</font><font color="#CCCCCC"> believed that we</font>

16
00:00:50,129 --> 00:00:52,610
contact

17
00:01:00,780 --> 00:01:05,920
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> I have an official</font><font color="#E5E5E5"> package about</font>

18
00:01:03,550 --> 00:01:09,250
four<font color="#CCCCCC"> months before that I</font><font color="#E5E5E5"> ran a</font>

19
00:01:05,920 --> 00:01:11,050
consulting firm on my own<font color="#CCCCCC"> while</font><font color="#E5E5E5"> I got</font>

20
00:01:09,250 --> 00:01:13,659
myself<font color="#CCCCCC"> l-train</font><font color="#E5E5E5"> debt I'm self-taught</font><font color="#CCCCCC"> pet</font>

21
00:01:11,050 --> 00:01:15,789
<font color="#E5E5E5">tester</font><font color="#CCCCCC"> I have degrees in literature not</font>

22
00:01:13,659 --> 00:01:17,290
computer science<font color="#E5E5E5"> but it's the same kind</font>

23
00:01:15,790 --> 00:01:19,290
<font color="#CCCCCC">of systems analysis</font><font color="#E5E5E5"> instead of analyzing</font>

24
00:01:17,290 --> 00:01:22,630
words<font color="#CCCCCC"> that you analyze</font><font color="#E5E5E5"> technical systems</font>

25
00:01:19,290 --> 00:01:25,990
today<font color="#E5E5E5"> is outline going to do a</font>

26
00:01:22,630 --> 00:01:27,460
definition<font color="#E5E5E5"> and framing for</font><font color="#CCCCCC"> the top</font><font color="#E5E5E5"> I'll</font>

27
00:01:25,990 --> 00:01:29,199
go through<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> web sneaking with box</font>

28
00:01:27,460 --> 00:01:32,229
mode<font color="#CCCCCC"> those are the three kinds of paths</font>

29
00:01:29,200 --> 00:01:34,030
that are organized and then summary the

30
00:01:32,229 --> 00:01:35,979
list of<font color="#E5E5E5"> resources at the end sticking</font>

31
00:01:34,030 --> 00:01:39,310
<font color="#E5E5E5">slide deck and a practice via a</font><font color="#CCCCCC"> build</font>

32
00:01:35,979 --> 00:01:41,770
for<font color="#E5E5E5"> this talk which has known paths</font>

33
00:01:39,310 --> 00:01:49,030
<font color="#E5E5E5">built into it except I can't promise the</font>

34
00:01:41,770 --> 00:01:53,140
<font color="#CCCCCC">crown so</font><font color="#E5E5E5"> a proposed escalation</font>

35
00:01:49,030 --> 00:01:54,550
definition was tricky to<font color="#E5E5E5"> find a single</font>

36
00:01:53,140 --> 00:01:56,619
one<font color="#E5E5E5"> but I don't think</font><font color="#CCCCCC"> of it basically</font>

37
00:01:54,550 --> 00:01:58,539
<font color="#CCCCCC">using the privileges of various agents</font>

38
00:01:56,619 --> 00:01:59,890
to gain access<font color="#CCCCCC"> to resources so you're</font>

39
00:01:58,539 --> 00:02:02,920
hopping through users or through

40
00:01:59,890 --> 00:02:04,330
services to get<font color="#CCCCCC"> access to more and more</font>

41
00:02:02,920 --> 00:02:06,759
<font color="#E5E5E5">things higher levels of privileges so</font>

42
00:02:04,330 --> 00:02:08,050
that you can accomplish your<font color="#E5E5E5"> goal</font>

43
00:02:06,759 --> 00:02:11,410
frequently that's going to be popping

44
00:02:08,050 --> 00:02:12,880
<font color="#CCCCCC">you're rich oh</font><font color="#E5E5E5"> that's fun people a</font>

45
00:02:11,410 --> 00:02:15,970
disability can happen in a variety of

46
00:02:12,880 --> 00:02:19,239
<font color="#E5E5E5">systems comes into play basically once</font>

47
00:02:15,970 --> 00:02:20,950
you are ready<font color="#CCCCCC"> to take ownership</font><font color="#E5E5E5"> and</font>

48
00:02:19,239 --> 00:02:24,550
today's<font color="#CCCCCC"> stuff is specifically focused on</font>

49
00:02:20,950 --> 00:02:28,700
<font color="#E5E5E5">once you are inside the web server now</font>

50
00:02:24,550 --> 00:02:30,469
you want to get persistence and

51
00:02:28,700 --> 00:02:33,560
so the framing that<font color="#E5E5E5"> we're going to use</font>

52
00:02:30,469 --> 00:02:35,620
today<font color="#E5E5E5"> is looking at who is doing the</font>

53
00:02:33,560 --> 00:02:37,879
execution and what are their privileges

54
00:02:35,620 --> 00:02:40,609
<font color="#E5E5E5">so they're</font><font color="#CCCCCC"> basically two</font><font color="#E5E5E5"> ways eskalene</font>

55
00:02:37,879 --> 00:02:41,840
<font color="#E5E5E5">in one situation</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> agent</font><font color="#E5E5E5"> the</font>

56
00:02:40,609 --> 00:02:44,629
current user that you've<font color="#E5E5E5"> taken control</font>

57
00:02:41,840 --> 00:02:46,189
<font color="#E5E5E5">of their permissions are sufficient to</font>

58
00:02:44,629 --> 00:02:48,409
execute<font color="#CCCCCC"> commands to</font><font color="#E5E5E5"> do what you want</font>

59
00:02:46,189 --> 00:02:50,719
the second path is where something<font color="#E5E5E5"> else</font>

60
00:02:48,409 --> 00:02:53,569
<font color="#E5E5E5">is the agent you can get a service or</font>

61
00:02:50,719 --> 00:02:55,608
program<font color="#E5E5E5"> or another user to execute the</font>

62
00:02:53,569 --> 00:02:57,108
command under<font color="#E5E5E5"> their permissions which</font>

63
00:02:55,609 --> 00:02:59,599
are the<font color="#CCCCCC"> ones sufficient to do what you</font>

64
00:02:57,109 --> 00:03:02,180
want<font color="#E5E5E5"> to do so we're gonna come back to</font>

65
00:02:59,599 --> 00:03:04,849
this<font color="#E5E5E5"> repeatedly today talking</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> when</font>

66
00:03:02,180 --> 00:03:06,560
your user<font color="#CCCCCC"> is an agent</font><font color="#E5E5E5"> and when you're</font>

67
00:03:04,849 --> 00:03:09,048
getting<font color="#E5E5E5"> something else</font><font color="#CCCCCC"> to do the agent</font>

68
00:03:06,560 --> 00:03:12,590
for you it's what about testing<font color="#CCCCCC"> a good</font>

69
00:03:09,049 --> 00:03:14,000
analogy<font color="#CCCCCC"> for that something else is like</font>

70
00:03:12,590 --> 00:03:16,459
a cross-site request forgery<font color="#CCCCCC"> where you</font>

71
00:03:14,000 --> 00:03:18,319
get a<font color="#E5E5E5"> user to take an action for you and</font>

72
00:03:16,459 --> 00:03:21,859
execute a payload under their

73
00:03:18,319 --> 00:03:23,958
permissions you're not the one<font color="#CCCCCC"> doing the</font>

74
00:03:21,859 --> 00:03:27,349
command<font color="#E5E5E5"> you</font><font color="#CCCCCC"> set up abdominals</font><font color="#E5E5E5"> but you</font>

75
00:03:23,959 --> 00:03:31,430
get them to execute<font color="#E5E5E5"> the</font><font color="#CCCCCC"> same kind of</font>

76
00:03:27,349 --> 00:03:33,409
<font color="#CCCCCC">situation</font><font color="#E5E5E5"> easy code we're going</font><font color="#CCCCCC"> to</font>

77
00:03:31,430 --> 00:03:35,659
<font color="#CCCCCC">basically</font><font color="#E5E5E5"> start when you hop into the</font>

78
00:03:33,409 --> 00:03:37,310
web server<font color="#CCCCCC"> I'm going to look at the</font>

79
00:03:35,659 --> 00:03:39,409
privileges and commissions<font color="#E5E5E5"> path we're in</font>

80
00:03:37,310 --> 00:03:41,989
a<font color="#E5E5E5"> pseudo</font><font color="#CCCCCC"> we're going to look for leaked</font>

81
00:03:39,409 --> 00:03:44,358
information<font color="#CCCCCC"> to reuse potentials all of</font>

82
00:03:41,989 --> 00:03:46,389
these are using your current permissions

83
00:03:44,359 --> 00:03:48,650
you're the<font color="#E5E5E5"> agent for everything at ease</font>

84
00:03:46,389 --> 00:03:50,540
so when I'm<font color="#CCCCCC"> having to a</font><font color="#E5E5E5"> servant</font><font color="#CCCCCC"> visiting</font>

85
00:03:48,650 --> 00:03:53,000
<font color="#E5E5E5">it the first thing I want to do is check</font>

86
00:03:50,540 --> 00:03:55,519
<font color="#E5E5E5">Who I am and where</font><font color="#CCCCCC"> I am and whether I</font>

87
00:03:53,000 --> 00:03:58,220
<font color="#E5E5E5">have everything that I need</font><font color="#CCCCCC"> already so</font>

88
00:03:55,519 --> 00:04:00,019
if you've<font color="#CCCCCC"> come in through our worst</font>

89
00:03:58,220 --> 00:04:03,079
shelter web application<font color="#E5E5E5"> you probably</font>

90
00:04:00,019 --> 00:04:07,340
<font color="#CCCCCC">have a web user or depth</font><font color="#E5E5E5"> of data user</font>

91
00:04:03,079 --> 00:04:10,360
and you are probably<font color="#E5E5E5"> in the web route if</font>

92
00:04:07,340 --> 00:04:11,740
you compromised<font color="#CCCCCC"> ssh credentials in</font>

93
00:04:10,360 --> 00:04:14,440
yourself<font color="#CCCCCC"> directly into the server that</font>

94
00:04:11,740 --> 00:04:16,660
<font color="#E5E5E5">way</font><font color="#CCCCCC"> your that user and your probably in</font>

95
00:04:14,440 --> 00:04:18,519
their home directory<font color="#E5E5E5"> so</font><font color="#CCCCCC"> Who am</font><font color="#E5E5E5"> I an ID</font>

96
00:04:16,660 --> 00:04:22,600
of elements<font color="#E5E5E5"> commands those you give you</font>

97
00:04:18,519 --> 00:04:24,340
<font color="#E5E5E5">username idea group configurations PWD</font>

98
00:04:22,600 --> 00:04:26,260
was<font color="#CCCCCC"> taken current working directory</font>

99
00:04:24,340 --> 00:04:28,150
those are good places to start<font color="#CCCCCC"> figure</font>

100
00:04:26,260 --> 00:04:28,990
out who you are<font color="#E5E5E5"> where you</font><font color="#CCCCCC"> are and where</font>

101
00:04:28,150 --> 00:04:31,929
you<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to go next</font>

102
00:04:28,990 --> 00:04:33,370
I<font color="#E5E5E5"> always double</font><font color="#CCCCCC"> check if I have</font>

103
00:04:31,930 --> 00:04:35,860
<font color="#E5E5E5">everything that I need at the beginning</font>

104
00:04:33,370 --> 00:04:37,390
<font color="#E5E5E5">because I have many times spent two</font>

105
00:04:35,860 --> 00:04:39,070
hours<font color="#E5E5E5"> trying to find a privilege it's</font>

106
00:04:37,390 --> 00:04:43,030
really two paths for something I<font color="#CCCCCC"> already</font>

107
00:04:39,070 --> 00:04:46,150
have ownership<font color="#E5E5E5"> over so you can cut</font><font color="#CCCCCC"> out</font>

108
00:04:43,030 --> 00:04:47,979
<font color="#E5E5E5">the Etsy shadow file to try to get</font><font color="#CCCCCC"> pots</font>

109
00:04:46,150 --> 00:04:50,020
of hashes<font color="#E5E5E5"> if you have access to that you</font>

110
00:04:47,980 --> 00:04:51,670
are an elevated user if you have access

111
00:04:50,020 --> 00:04:52,990
<font color="#CCCCCC">to the root directory you're already an</font>

112
00:04:51,670 --> 00:04:56,350
elevated users<font color="#E5E5E5"> to these are shortcuts</font>

113
00:04:52,990 --> 00:04:57,850
<font color="#E5E5E5">that I use to see what I can see already</font>

114
00:04:56,350 --> 00:05:00,310
<font color="#E5E5E5">what am i couldn't</font><font color="#CCCCCC"> accessible at the</font>

115
00:04:57,850 --> 00:05:03,120
<font color="#E5E5E5">beginning I guess that instead of</font>

116
00:05:00,310 --> 00:05:14,919
<font color="#CCCCCC">checking my actual permission</font>

117
00:05:03,120 --> 00:05:16,570
<font color="#CCCCCC">Betsie</font><font color="#E5E5E5"> shadow versus</font><font color="#CCCCCC"> se password the</font>

118
00:05:14,919 --> 00:05:18,669
<font color="#E5E5E5">next thing I do is</font><font color="#CCCCCC"> check permissions</font><font color="#E5E5E5"> why</font>

119
00:05:16,570 --> 00:05:22,240
do<font color="#E5E5E5"> I have read access</font><font color="#CCCCCC"> to where do</font><font color="#E5E5E5"> I have</font>

120
00:05:18,669 --> 00:05:24,430
write access<font color="#CCCCCC"> looking to</font><font color="#E5E5E5"> see what other</font>

121
00:05:22,240 --> 00:05:27,460
users<font color="#CCCCCC"> can I read in the home directory</font>

122
00:05:24,430 --> 00:05:29,320
<font color="#CCCCCC">so in this instance level 3 user is</font>

123
00:05:27,460 --> 00:05:30,820
<font color="#CCCCCC">seven seven seven four eight</font><font color="#E5E5E5"> we have</font>

124
00:05:29,320 --> 00:05:32,530
full read/write access to their

125
00:05:30,820 --> 00:05:35,010
directory that<font color="#E5E5E5"> may give us additional</font>

126
00:05:32,530 --> 00:05:37,890
information<font color="#CCCCCC"> may be</font><font color="#E5E5E5"> able to put our own</font>

127
00:05:35,010 --> 00:05:40,210
<font color="#CCCCCC">RSA key in there and log in as that</font><font color="#E5E5E5"> user</font>

128
00:05:37,890 --> 00:05:42,190
<font color="#E5E5E5">we're gonna check and see what all is in</font>

129
00:05:40,210 --> 00:05:44,140
these are there and I picked it into

130
00:05:42,190 --> 00:05:47,800
less so it's easier to<font color="#E5E5E5"> read but we're</font>

131
00:05:44,140 --> 00:05:49,210
gonna try<font color="#CCCCCC"> to list out all the programs</font>

132
00:05:47,800 --> 00:05:51,280
that<font color="#E5E5E5"> are there all the utilities that</font>

133
00:05:49,210 --> 00:05:54,820
<font color="#E5E5E5">are in use are shared and see what their</font>

134
00:05:51,280 --> 00:05:56,260
permissions look like this is a good

135
00:05:54,820 --> 00:05:59,200
thing<font color="#E5E5E5"> also to start looking and seeing</font>

136
00:05:56,260 --> 00:06:00,610
what's there<font color="#E5E5E5"> what what custom files can</font>

137
00:05:59,200 --> 00:06:02,039
you start seeing<font color="#E5E5E5"> what sorts of</font>

138
00:06:00,610 --> 00:06:07,320
executables

139
00:06:02,040 --> 00:06:07,919
who owns them who gets executed<font color="#CCCCCC"> on i'm</font>

140
00:06:07,320 --> 00:06:10,740
going<font color="#E5E5E5"> to look at</font><font color="#CCCCCC"> the environment</font>

141
00:06:07,919 --> 00:06:13,080
<font color="#E5E5E5">variable which it didn't like captain</font>

142
00:06:10,740 --> 00:06:14,669
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> variables are configurations</font>

143
00:06:13,080 --> 00:06:19,229
for that user<font color="#CCCCCC"> on that particular system</font>

144
00:06:14,669 --> 00:06:21,960
<font color="#CCCCCC">so it'll tell you where they get to</font>

145
00:06:19,229 --> 00:06:23,340
start what the working directory<font color="#E5E5E5"> is some</font>

146
00:06:21,960 --> 00:06:25,320
of their sort of permission

147
00:06:23,340 --> 00:06:28,349
configurations<font color="#E5E5E5"> it'll tell you what their</font>

148
00:06:25,320 --> 00:06:29,719
path is set to<font color="#E5E5E5"> but again</font><font color="#CCCCCC"> this is more</font>

149
00:06:28,350 --> 00:06:31,860
details<font color="#E5E5E5"> about the user you</font><font color="#CCCCCC"> have</font>

150
00:06:29,720 --> 00:06:34,889
information<font color="#E5E5E5"> about</font><font color="#CCCCCC"> the system</font><font color="#E5E5E5"> you're</font>

151
00:06:31,860 --> 00:06:38,250
<font color="#CCCCCC">working with this is you can</font><font color="#E5E5E5"> start</font>

152
00:06:34,889 --> 00:06:40,070
looking<font color="#CCCCCC"> for information</font><font color="#E5E5E5"> I'm gonna check</font>

153
00:06:38,250 --> 00:06:44,760
for<font color="#E5E5E5"> right access in particular</font><font color="#CCCCCC"> places</font>

154
00:06:40,070 --> 00:06:46,469
<font color="#CCCCCC">any</font><font color="#E5E5E5"> SSH directories anything in the</font>

155
00:06:44,760 --> 00:06:52,320
<font color="#E5E5E5">route and I'm gonna see if I can write</font>

156
00:06:46,470 --> 00:06:54,389
to crontab<font color="#E5E5E5"> just in case so this user in</font>

157
00:06:52,320 --> 00:06:58,580
the demo doesn't<font color="#CCCCCC"> Commission to a lot</font><font color="#E5E5E5"> of</font>

158
00:06:54,389 --> 00:07:01,650
things yet<font color="#CCCCCC"> I get denied</font><font color="#E5E5E5"> that's fine</font>

159
00:06:58,580 --> 00:07:03,150
we'll work with<font color="#E5E5E5"> it we didn't</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> to read</font>

160
00:07:01,650 --> 00:07:04,500
from<font color="#CCCCCC"> that there we</font><font color="#E5E5E5"> go so there's my</font>

161
00:07:03,150 --> 00:07:06,870
<font color="#E5E5E5">front functions that run</font><font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> come back</font>

162
00:07:04,500 --> 00:07:09,090
to this later<font color="#E5E5E5"> but these are</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> the</font>

163
00:07:06,870 --> 00:07:11,460
places<font color="#CCCCCC"> that</font><font color="#E5E5E5"> technicial you want to get</font>

164
00:07:09,090 --> 00:07:14,340
into a system<font color="#E5E5E5"> what can I do with the</font>

165
00:07:11,460 --> 00:07:18,448
<font color="#E5E5E5">user a half the next thing you like to</font>

166
00:07:14,340 --> 00:07:20,580
<font color="#E5E5E5">check assume</font><font color="#CCCCCC"> Super User</font><font color="#E5E5E5"> do something to</font>

167
00:07:18,449 --> 00:07:23,220
do -<font color="#E5E5E5"> L will tell us what commands and</font>

168
00:07:20,580 --> 00:07:30,448
<font color="#E5E5E5">pseudo permissions we have me executed</font>

169
00:07:23,220 --> 00:07:31,680
we need a<font color="#E5E5E5"> spec so it also tells us so in</font>

170
00:07:30,449 --> 00:07:34,620
this instance<font color="#CCCCCC"> pseudo touch all those</font>

171
00:07:31,680 --> 00:07:36,930
boxes<font color="#E5E5E5"> needed a password</font><font color="#CCCCCC"> I didn't know it</font>

172
00:07:34,620 --> 00:07:40,590
<font color="#CCCCCC">so I was</font><font color="#E5E5E5"> able to see what the pseudo</font>

173
00:07:36,930 --> 00:07:43,380
permissions are and<font color="#E5E5E5"> soup-bone which</font>

174
00:07:40,590 --> 00:07:45,810
boxes has all right so I<font color="#E5E5E5"> can sue any</font>

175
00:07:43,380 --> 00:07:50,820
program<font color="#CCCCCC"> ask</font><font color="#E5E5E5"> route with this user as long</font>

176
00:07:45,810 --> 00:07:52,260
as I know<font color="#E5E5E5"> the password so the way it</font>

177
00:07:50,820 --> 00:07:54,810
<font color="#CCCCCC">works</font><font color="#E5E5E5"> first you tonight</font>

178
00:07:52,260 --> 00:07:58,430
<font color="#CCCCCC">sudo the commander's to do bangbang to</font>

179
00:07:54,810 --> 00:08:01,380
repeat the previous command<font color="#E5E5E5"> sudo and</font>

180
00:07:58,430 --> 00:08:03,930
<font color="#CCCCCC">what the</font><font color="#E5E5E5"> password entered already in</font>

181
00:08:01,380 --> 00:08:10,650
this session we get the output<font color="#E5E5E5"> of</font><font color="#CCCCCC"> it as</font>

182
00:08:03,930 --> 00:08:13,270
a shadow<font color="#CCCCCC"> claw the</font><font color="#E5E5E5"> FCC universe file is</font>

183
00:08:10,650 --> 00:08:16,270
the permissions or<font color="#CCCCCC"> users</font>

184
00:08:13,270 --> 00:08:18,460
so what programs<font color="#E5E5E5"> they</font><font color="#CCCCCC"> can run and under</font>

185
00:08:16,270 --> 00:08:19,810
what permissions and then<font color="#CCCCCC"> Etsy</font><font color="#E5E5E5"> group I</font>

186
00:08:18,460 --> 00:08:21,430
<font color="#E5E5E5">also like to</font><font color="#CCCCCC"> check at</font><font color="#E5E5E5"> this point</font><font color="#CCCCCC"> phone</font>

187
00:08:19,810 --> 00:08:23,650
it's usually<font color="#E5E5E5"> not locked to</font><font color="#CCCCCC"> a sudo</font>

188
00:08:21,430 --> 00:08:24,910
command<font color="#CCCCCC"> but it will tell you the groups</font>

189
00:08:23,650 --> 00:08:27,580
<font color="#E5E5E5">that are</font><font color="#CCCCCC"> operating and the users that</font>

190
00:08:24,910 --> 00:08:29,430
are part of<font color="#E5E5E5"> those groups hopping through</font>

191
00:08:27,580 --> 00:08:31,330
<font color="#CCCCCC">group permissions is a nice way to</font>

192
00:08:29,430 --> 00:08:33,010
escalate privileges without even

193
00:08:31,330 --> 00:08:36,218
compromise necessarily individually

194
00:08:33,010 --> 00:08:39,520
<font color="#E5E5E5">music you've shared groups with users</font>

195
00:08:36,219 --> 00:08:41,260
who<font color="#CCCCCC"> can sometimes read or execute</font>

196
00:08:39,520 --> 00:08:47,079
<font color="#CCCCCC">wireless based on those group</font>

197
00:08:41,260 --> 00:08:49,750
permissions<font color="#CCCCCC"> if I skip over</font><font color="#E5E5E5"> something or</font>

198
00:08:47,080 --> 00:08:53,050
you can't read it just<font color="#E5E5E5"> let me know so</font>

199
00:08:49,750 --> 00:08:55,870
<font color="#CCCCCC">this is our first</font><font color="#E5E5E5"> exploit of the day the</font>

200
00:08:53,050 --> 00:08:57,750
OS<font color="#E5E5E5"> box this user in this instance has no</font>

201
00:08:55,870 --> 00:08:59,680
password sudo permission for Python

202
00:08:57,750 --> 00:09:01,360
language compilers<font color="#CCCCCC"> that are</font>

203
00:08:59,680 --> 00:09:03,310
misconfigured<font color="#CCCCCC"> for</font><font color="#E5E5E5"> interpreters owners</font>

204
00:09:01,360 --> 00:09:05,980
<font color="#E5E5E5">configure the</font><font color="#CCCCCC"> student</font><font color="#E5E5E5"> Commission's can</font>

205
00:09:03,310 --> 00:09:08,619
execute jealous because you<font color="#CCCCCC"> student icon</font>

206
00:09:05,980 --> 00:09:11,020
when you run it whatever<font color="#E5E5E5"> Python runs</font>

207
00:09:08,620 --> 00:09:13,029
runs under root permissions as well<font color="#E5E5E5"> so</font>

208
00:09:11,020 --> 00:09:16,360
<font color="#E5E5E5">our example</font><font color="#CCCCCC"> here we're going</font><font color="#E5E5E5"> to write a</font>

209
00:09:13,029 --> 00:09:20,470
Python statement to import library use a

210
00:09:16,360 --> 00:09:24,490
spawn function<font color="#E5E5E5"> to spawn a new shell and</font>

211
00:09:20,470 --> 00:09:25,570
<font color="#E5E5E5">that's out because we sued</font><font color="#CCCCCC"> Python runs</font>

212
00:09:24,490 --> 00:09:33,820
under<font color="#CCCCCC"> root permissions and</font><font color="#E5E5E5"> we have</font>

213
00:09:25,570 --> 00:09:39,600
virtual<font color="#E5E5E5"> super simple so again this is</font>

214
00:09:33,820 --> 00:09:39,600
we're we're using the permissions of<font color="#E5E5E5"> I</font>

215
00:09:42,209 --> 00:09:47,709
also need<font color="#E5E5E5"> to check pretty early on for</font>

216
00:09:44,740 --> 00:09:49,990
credential reuse<font color="#CCCCCC"> reuse that separates</font>

217
00:09:47,709 --> 00:09:51,430
<font color="#CCCCCC">rampant</font><font color="#E5E5E5"> there isn't usually</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> sysadmin</font>

218
00:09:49,990 --> 00:09:52,959
<font color="#E5E5E5">sitting over your shoulder telling you</font>

219
00:09:51,430 --> 00:09:55,989
to<font color="#E5E5E5"> make a new password so if you've</font>

220
00:09:52,959 --> 00:09:58,420
compromised<font color="#CCCCCC"> any of the web application</font>

221
00:09:55,990 --> 00:10:01,240
passwords<font color="#E5E5E5"> if you have</font><font color="#CCCCCC"> compromising</font>

222
00:09:58,420 --> 00:10:03,670
<font color="#CCCCCC">pattern or specific user of your system</font>

223
00:10:01,240 --> 00:10:05,170
if you know<font color="#E5E5E5"> that you're targeting a</font>

224
00:10:03,670 --> 00:10:06,670
particular admin you have their email

225
00:10:05,170 --> 00:10:08,140
<font color="#E5E5E5">and you can see if they have no one</font>

226
00:10:06,670 --> 00:10:10,990
compromised passwords out there and all

227
00:10:08,140 --> 00:10:13,270
the big<font color="#E5E5E5"> databases</font><font color="#CCCCCC"> they're also</font><font color="#E5E5E5"> common</font><font color="#CCCCCC"> to</font>

228
00:10:10,990 --> 00:10:14,970
default passwords for different<font color="#CCCCCC"> services</font>

229
00:10:13,270 --> 00:10:17,960
<font color="#CCCCCC">that might be on your</font><font color="#E5E5E5"> server</font>

230
00:10:14,970 --> 00:10:21,710
<font color="#E5E5E5">any of those might help us leave</font>

231
00:10:17,960 --> 00:10:26,930
privileges as well<font color="#CCCCCC"> especially if there</font>

232
00:10:21,710 --> 00:10:28,340
are vulnerable<font color="#CCCCCC"> surfaces</font><font color="#E5E5E5"> like you can get</font>

233
00:10:26,930 --> 00:10:30,050
<font color="#CCCCCC">a</font><font color="#E5E5E5"> shell</font><font color="#CCCCCC"> escape my sequel you want</font>

234
00:10:28,340 --> 00:10:30,860
another my simple password<font color="#CCCCCC"> maybe you</font>

235
00:10:30,050 --> 00:10:32,479
already<font color="#E5E5E5"> have it</font>

236
00:10:30,860 --> 00:10:37,340
maybe it's in some other thing<font color="#CCCCCC"> we need</font>

237
00:10:32,480 --> 00:10:39,020
<font color="#CCCCCC">compromise</font><font color="#E5E5E5"> so I like to check the</font>

238
00:10:37,340 --> 00:10:42,290
<font color="#CCCCCC">credentials for any services that I ran</font>

239
00:10:39,020 --> 00:10:43,939
into<font color="#E5E5E5"> I also like to</font><font color="#CCCCCC"> check bash history</font>

240
00:10:42,290 --> 00:10:46,250
<font color="#CCCCCC">for the current user and</font><font color="#E5E5E5"> a negative user</font>

241
00:10:43,940 --> 00:10:48,080
so<font color="#E5E5E5"> that I can read</font><font color="#CCCCCC"> bachelor's degree of</font>

242
00:10:46,250 --> 00:10:51,350
course is all of the commands entered

243
00:10:48,080 --> 00:10:52,730
into the terminals for that user<font color="#CCCCCC"> batch</font>

244
00:10:51,350 --> 00:10:56,900
<font color="#CCCCCC">history is</font><font color="#E5E5E5"> updated at the end of every</font>

245
00:10:52,730 --> 00:10:58,550
session<font color="#CCCCCC"> batch ester is recorded for all</font>

246
00:10:56,900 --> 00:11:00,170
<font color="#CCCCCC">the users</font><font color="#E5E5E5"> history is just</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to be</font>

247
00:10:58,550 --> 00:11:03,439
the live output or in your<font color="#CCCCCC"> current user</font>

248
00:11:00,170 --> 00:11:04,520
session<font color="#E5E5E5"> so if you do something and you</font>

249
00:11:03,440 --> 00:11:05,900
<font color="#CCCCCC">want to remember what</font><font color="#E5E5E5"> it is you can</font>

250
00:11:04,520 --> 00:11:09,740
check<font color="#CCCCCC"> history but the batch Lister use a</font>

251
00:11:05,900 --> 00:11:11,630
<font color="#E5E5E5">static</font><font color="#CCCCCC"> file</font><font color="#E5E5E5"> yeah there may be things</font>

252
00:11:09,740 --> 00:11:13,010
entered into the<font color="#E5E5E5"> history they're useful</font>

253
00:11:11,630 --> 00:11:15,860
<font color="#E5E5E5">it will probably point you in the</font>

254
00:11:13,010 --> 00:11:17,960
direction of custom executables<font color="#E5E5E5"> that</font>

255
00:11:15,860 --> 00:11:20,390
<font color="#CCCCCC">exist on</font><font color="#E5E5E5"> the system that's that user has</font>

256
00:11:17,960 --> 00:11:22,640
run<font color="#E5E5E5"> and if you can see it for other</font>

257
00:11:20,390 --> 00:11:25,689
users likewise it'll give you some more

258
00:11:22,640 --> 00:11:25,689
<font color="#E5E5E5">information about where to go next</font>

259
00:11:25,840 --> 00:11:29,750
check the<font color="#E5E5E5"> logs at this point for</font>

260
00:11:27,830 --> 00:11:31,610
additional leaked information<font color="#E5E5E5"> are the</font>

261
00:11:29,750 --> 00:11:33,770
credentials<font color="#E5E5E5"> and loves getting useful</font>

262
00:11:31,610 --> 00:11:36,470
<font color="#CCCCCC">information about what's</font><font color="#E5E5E5"> running on this</font>

263
00:11:33,770 --> 00:11:38,090
<font color="#CCCCCC">system</font><font color="#E5E5E5"> who has access to it when does it</font>

264
00:11:36,470 --> 00:11:40,010
run<font color="#CCCCCC"> what</font><font color="#E5E5E5"> information does that</font>

265
00:11:38,090 --> 00:11:42,260
<font color="#E5E5E5">executable need to function</font><font color="#CCCCCC"> correctly</font>

266
00:11:40,010 --> 00:11:45,230
<font color="#CCCCCC">when those are locked</font>

267
00:11:42,260 --> 00:11:47,840
<font color="#E5E5E5">there are also</font><font color="#CCCCCC"> blog exploits for</font>

268
00:11:45,230 --> 00:11:50,150
misconfigured systems<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> has known</font>

269
00:11:47,840 --> 00:11:53,750
ones<font color="#CCCCCC"> my school had an only</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> awhile</font>

270
00:11:50,150 --> 00:11:57,560
<font color="#E5E5E5">where you could rewrite with a symlink</font>

271
00:11:53,750 --> 00:12:00,050
<font color="#E5E5E5">the target of the log output and put it</font>

272
00:11:57,560 --> 00:12:02,689
in<font color="#E5E5E5"> place that you control so logs can</font>

273
00:12:00,050 --> 00:12:05,240
sometimes themselves lead to information

274
00:12:02,690 --> 00:12:07,280
disclosures or escalations but they also

275
00:12:05,240 --> 00:12:10,990
are documentation of<font color="#E5E5E5"> what's in the</font>

276
00:12:07,280 --> 00:12:10,990
<font color="#CCCCCC">system and what</font><font color="#E5E5E5"> information</font>

277
00:12:12,100 --> 00:12:16,100
so do you see what real fast<font color="#CCCCCC"> because the</font>

278
00:12:14,990 --> 00:12:18,500
other ones are a<font color="#E5E5E5"> little more complex</font>

279
00:12:16,100 --> 00:12:20,660
<font color="#CCCCCC">everyone will</font><font color="#E5E5E5"> be so far easy mode is</font>

280
00:12:18,500 --> 00:12:23,540
figure out<font color="#E5E5E5"> where you are what you can do</font>

281
00:12:20,660 --> 00:12:25,880
<font color="#E5E5E5">check to see what you need in order to</font>

282
00:12:23,540 --> 00:12:27,740
<font color="#E5E5E5">start moving</font><font color="#CCCCCC"> forward do you need</font>

283
00:12:25,880 --> 00:12:29,930
additional permissions for<font color="#E5E5E5"> sudo or for</font>

284
00:12:27,740 --> 00:12:36,110
other services<font color="#E5E5E5"> what information is just</font>

285
00:12:29,930 --> 00:12:38,149
<font color="#CCCCCC">available in the various</font><font color="#E5E5E5"> again a to path</font>

286
00:12:36,110 --> 00:12:41,949
desolation<font color="#E5E5E5"> where the agent or the</font>

287
00:12:38,149 --> 00:12:41,949
<font color="#E5E5E5">majority</font><font color="#CCCCCC"> of these something</font><font color="#E5E5E5"> else changes</font>

288
00:12:42,519 --> 00:12:47,660
sneaky no it's my favorite mostly<font color="#CCCCCC"> suid</font>

289
00:12:45,350 --> 00:12:51,860
bits shell escapes may not share

290
00:12:47,660 --> 00:12:55,100
<font color="#CCCCCC">commence and</font><font color="#E5E5E5"> wild</font><font color="#CCCCCC"> cards</font><font color="#E5E5E5"> appear so</font><font color="#CCCCCC"> suid</font>

291
00:12:51,860 --> 00:12:57,380
bits set<font color="#E5E5E5"> UID bit for</font><font color="#CCCCCC"> linux permissions</font>

292
00:12:55,100 --> 00:12:59,930
usually<font color="#E5E5E5"> have read write and execute</font><font color="#CCCCCC"> put</font>

293
00:12:57,380 --> 00:13:03,380
the<font color="#E5E5E5"> X</font><font color="#CCCCCC"> or execute can be replaced by an X</font>

294
00:12:59,930 --> 00:13:05,810
this means<font color="#E5E5E5"> that instead of the current</font>

295
00:13:03,380 --> 00:13:08,540
user executing the executable under

296
00:13:05,810 --> 00:13:11,508
their permissions<font color="#CCCCCC"> anyone who can execute</font>

297
00:13:08,540 --> 00:13:14,410
it does so under root permissions so

298
00:13:11,509 --> 00:13:16,880
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> making it world executable</font>

299
00:13:14,410 --> 00:13:20,050
<font color="#E5E5E5">except anyone uses their permissions you</font>

300
00:13:16,880 --> 00:13:23,839
set this to<font color="#E5E5E5"> a deep</font><font color="#CCCCCC"> it or a group ID bit</font>

301
00:13:20,050 --> 00:13:26,389
and that lets anyone execute it as the

302
00:13:23,839 --> 00:13:28,579
privileged user recently<font color="#E5E5E5"> grouped these</font>

303
00:13:26,389 --> 00:13:30,649
are great<font color="#E5E5E5"> because a lot of executables</font>

304
00:13:28,579 --> 00:13:34,430
onyx require<font color="#E5E5E5"> their permissions</font><font color="#CCCCCC"> to</font>

305
00:13:30,649 --> 00:13:35,509
private<font color="#E5E5E5"> and if you want assess admin</font>

306
00:13:34,430 --> 00:13:38,120
wants other people<font color="#CCCCCC"> will</font><font color="#E5E5E5"> be able to run</font>

307
00:13:35,509 --> 00:13:44,920
that<font color="#E5E5E5"> program</font><font color="#CCCCCC"> does</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> necessary</font><font color="#CCCCCC"> bit</font>

308
00:13:38,120 --> 00:13:44,920
<font color="#E5E5E5">and we as the</font><font color="#CCCCCC"> checkers can explain that</font>

309
00:13:45,310 --> 00:13:52,579
so how do we<font color="#E5E5E5"> find the list of student</font>

310
00:13:48,709 --> 00:13:54,829
and<font color="#CCCCCC"> who</font><font color="#E5E5E5"> interests</font><font color="#CCCCCC"> GID binaries these are</font>

311
00:13:52,579 --> 00:13:56,750
equivalent<font color="#CCCCCC"> and these are equivalent</font><font color="#E5E5E5"> so</font>

312
00:13:54,829 --> 00:13:59,689
we're gonna do fine statements to look

313
00:13:56,750 --> 00:14:01,519
for a user that<font color="#E5E5E5"> has an</font><font color="#CCCCCC"> S for a group</font>

314
00:13:59,689 --> 00:14:03,110
that<font color="#CCCCCC"> has a nest the four thousand and</font>

315
00:14:01,519 --> 00:14:04,939
<font color="#E5E5E5">two thousand are just the octal limits</font>

316
00:14:03,110 --> 00:14:06,769
<font color="#E5E5E5">for those we're gonna look for file</font>

317
00:14:04,939 --> 00:14:09,139
types<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> send all the errors to</font>

318
00:14:06,769 --> 00:14:13,750
a null directory<font color="#CCCCCC"> that will output</font><font color="#E5E5E5"> the</font>

319
00:14:09,139 --> 00:14:21,990
<font color="#E5E5E5">list of super</font><font color="#CCCCCC"> duper good</font>

320
00:14:13,750 --> 00:14:24,040
executables so here's our<font color="#E5E5E5"> list</font>

321
00:14:21,990 --> 00:14:26,500
what I like<font color="#E5E5E5"> to do is get fresh</font>

322
00:14:24,040 --> 00:14:28,779
<font color="#CCCCCC">intelligence when I was first started</font>

323
00:14:26,500 --> 00:14:30,370
and figure out<font color="#E5E5E5"> what comes standard so I</font>

324
00:14:28,779 --> 00:14:33,420
didn't get<font color="#E5E5E5"> bogged down in</font><font color="#CCCCCC"> a bunch of</font>

325
00:14:30,370 --> 00:14:37,120
standard utilities<font color="#CCCCCC"> that</font><font color="#E5E5E5"> were not example</font>

326
00:14:33,420 --> 00:14:39,339
people<font color="#E5E5E5"> who are not familiar with sort of</font>

327
00:14:37,120 --> 00:14:41,680
standards<font color="#CCCCCC"> - and utilities what always</font>

328
00:14:39,339 --> 00:14:43,329
<font color="#E5E5E5">sort of runs with a</font><font color="#CCCCCC"> suid bit but</font><font color="#E5E5E5"> nine</font>

329
00:14:41,680 --> 00:14:45,219
might not be exploitable<font color="#CCCCCC"> King is a</font>

330
00:14:43,329 --> 00:14:46,719
classic one<font color="#E5E5E5"> can't</font><font color="#CCCCCC"> really do a</font><font color="#E5E5E5"> lot of</font>

331
00:14:45,220 --> 00:14:50,500
<font color="#E5E5E5">exploits with pain but</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> always around</font>

332
00:14:46,720 --> 00:14:52,029
<font color="#E5E5E5">this</font><font color="#CCCCCC"> route always suit</font><font color="#E5E5E5"> it so you know</font>

333
00:14:50,500 --> 00:14:53,940
you<font color="#CCCCCC"> can get excited about it but</font><font color="#E5E5E5"> it</font>

334
00:14:52,029 --> 00:15:04,089
might<font color="#CCCCCC"> not be the best place</font><font color="#E5E5E5"> to start</font>

335
00:14:53,940 --> 00:15:05,890
<font color="#E5E5E5">your next place so exploitable suit</font>

336
00:15:04,089 --> 00:15:07,600
programs your standard utilities we're

337
00:15:05,890 --> 00:15:09,730
gonna try<font color="#E5E5E5"> shell escapes frequently</font><font color="#CCCCCC"> our</font>

338
00:15:07,600 --> 00:15:12,130
command option arguments if you find

339
00:15:09,730 --> 00:15:13,930
custom executables<font color="#E5E5E5"> or scripts we're</font>

340
00:15:12,130 --> 00:15:15,839
gonna try to reset the path<font color="#E5E5E5"> locally</font>

341
00:15:13,930 --> 00:15:18,310
<font color="#E5E5E5">we're gonna watch out</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> wildcards so</font>

342
00:15:15,839 --> 00:15:20,050
there's another<font color="#E5E5E5"> statement up</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> that</font>

343
00:15:18,310 --> 00:15:21,939
is going<font color="#CCCCCC"> to try</font><font color="#E5E5E5"> to do a combined search</font>

344
00:15:20,050 --> 00:15:23,740
and we're going<font color="#E5E5E5"> to add an option</font>

345
00:15:21,940 --> 00:15:25,120
<font color="#E5E5E5">argument here to list out</font><font color="#CCCCCC"> the</font>

346
00:15:23,740 --> 00:15:28,540
permissions for<font color="#CCCCCC"> all</font><font color="#E5E5E5"> of them so we</font><font color="#CCCCCC"> can</font>

347
00:15:25,120 --> 00:15:30,610
check in one statement or all the

348
00:15:28,540 --> 00:15:33,510
information that<font color="#CCCCCC"> I want going forward so</font>

349
00:15:30,610 --> 00:15:35,740
we're gonna<font color="#E5E5E5"> grab</font><font color="#CCCCCC"> all of the suet files</font>

350
00:15:33,510 --> 00:15:37,510
which isn't<font color="#CCCCCC"> really all</font><font color="#E5E5E5"> of it</font><font color="#CCCCCC"> just cuz</font>

351
00:15:35,740 --> 00:15:39,160
these<font color="#E5E5E5"> are ones but here what you see the</font>

352
00:15:37,510 --> 00:15:41,800
permissions<font color="#CCCCCC"> and there's our happy fest</font>

353
00:15:39,160 --> 00:15:45,420
we're gonna run the<font color="#CCCCCC"> n4 group and the see</font>

354
00:15:41,800 --> 00:15:48,579
that<font color="#CCCCCC"> say max I'm in a group executable</font>

355
00:15:45,420 --> 00:15:52,060
<font color="#E5E5E5">they are running its</font><font color="#CCCCCC"> route</font><font color="#E5E5E5"> one has a</font>

356
00:15:48,579 --> 00:15:54,189
group<font color="#E5E5E5"> of boots that are different</font><font color="#CCCCCC"> here</font>

357
00:15:52,060 --> 00:16:00,069
we've<font color="#E5E5E5"> got the group route but they're</font>

358
00:15:54,190 --> 00:16:01,270
<font color="#E5E5E5">owned by a different</font><font color="#CCCCCC"> user yeah getting</font>

359
00:16:00,070 --> 00:16:02,950
familiar<font color="#E5E5E5"> with what's typically going to</font>

360
00:16:01,270 --> 00:16:04,480
<font color="#E5E5E5">be on a system that's not necessarily</font>

361
00:16:02,950 --> 00:16:06,370
exploitable<font color="#E5E5E5"> will help you sort of</font><font color="#CCCCCC"> focus</font>

362
00:16:04,480 --> 00:16:09,430
in on where<font color="#E5E5E5"> you want to really target</font>

363
00:16:06,370 --> 00:16:11,829
<font color="#CCCCCC">records shell escapes are some of my</font>

364
00:16:09,430 --> 00:16:12,939
favorite<font color="#E5E5E5"> things I left for an hour when</font>

365
00:16:11,829 --> 00:16:14,500
I first learned<font color="#E5E5E5"> about them so shell</font>

366
00:16:12,940 --> 00:16:17,529
escapes<font color="#E5E5E5"> are intentional functionality</font>

367
00:16:14,500 --> 00:16:21,310
built into a program to<font color="#E5E5E5"> execute commands</font>

368
00:16:17,529 --> 00:16:25,209
within<font color="#CCCCCC"> there</font><font color="#E5E5E5"> frequently a bank</font><font color="#CCCCCC"> command</font>

369
00:16:21,310 --> 00:16:26,560
<font color="#CCCCCC">where Bank hash command and so this is</font>

370
00:16:25,209 --> 00:16:28,479
the my sequel example we're<font color="#E5E5E5"> going to</font>

371
00:16:26,560 --> 00:16:29,709
figure out<font color="#E5E5E5"> which</font><font color="#CCCCCC"> mice people were</font><font color="#E5E5E5"> using</font>

372
00:16:28,480 --> 00:16:34,089
we're going to look<font color="#E5E5E5"> at its permissions</font>

373
00:16:29,709 --> 00:16:36,339
we're gonna burn<font color="#E5E5E5"> that it is in fact suet</font>

374
00:16:34,089 --> 00:16:37,869
<font color="#E5E5E5">we're gonna log in we're gonna do the</font>

375
00:16:36,339 --> 00:16:42,069
shell escape and we have ourselves a

376
00:16:37,869 --> 00:16:44,470
root shell<font color="#CCCCCC"> because my sequel</font><font color="#E5E5E5"> is running</font>

377
00:16:42,069 --> 00:16:45,759
<font color="#E5E5E5">it now you may say but Kate you love</font><font color="#CCCCCC"> me</font>

378
00:16:44,470 --> 00:16:48,040
<font color="#CCCCCC">this week yeah I've written</font><font color="#E5E5E5"> again that</font>

379
00:16:45,759 --> 00:16:50,619
didn't matter to sue it on my sequel

380
00:16:48,040 --> 00:16:53,259
<font color="#CCCCCC">that mattered it's because</font><font color="#E5E5E5"> my sequel</font>

381
00:16:50,619 --> 00:16:55,929
itself is<font color="#CCCCCC"> running is</font><font color="#E5E5E5"> route whatever it</font>

382
00:16:53,259 --> 00:16:58,269
executes from within<font color="#E5E5E5"> the program will</font>

383
00:16:55,929 --> 00:17:03,220
also<font color="#E5E5E5"> run a script</font><font color="#CCCCCC"> so she'll sweets</font><font color="#E5E5E5"> or</font>

384
00:16:58,269 --> 00:17:04,870
misconfigured executables<font color="#E5E5E5"> they're</font>

385
00:17:03,220 --> 00:17:06,519
getting locked down<font color="#E5E5E5"> less and more in</font>

386
00:17:04,869 --> 00:17:10,000
this particular<font color="#CCCCCC"> Linux version that I was</font>

387
00:17:06,519 --> 00:17:14,859
demoing did not work they gave me<font color="#CCCCCC"> shells</font>

388
00:17:10,000 --> 00:17:17,589
for the<font color="#E5E5E5"> user I had</font><font color="#CCCCCC"> then Emacs a lot of</font>

389
00:17:14,859 --> 00:17:19,329
programs have<font color="#E5E5E5"> shells gates</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> super</font>

390
00:17:17,589 --> 00:17:21,668
useful but they're also<font color="#E5E5E5"> easily</font>

391
00:17:19,329 --> 00:17:25,209
compromised<font color="#E5E5E5"> if the underlying</font><font color="#CCCCCC"> program is</font>

392
00:17:21,669 --> 00:17:27,760
itself<font color="#E5E5E5"> is configured</font><font color="#CCCCCC"> main</font><font color="#E5E5E5"> option targets</font>

393
00:17:25,209 --> 00:17:31,269
are similar<font color="#E5E5E5"> it's another way to execute</font>

394
00:17:27,760 --> 00:17:34,149
commands on<font color="#CCCCCC"> the results</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> prying it up</font>

395
00:17:31,269 --> 00:17:35,950
for<font color="#E5E5E5"> example on the results of us so</font>

396
00:17:34,149 --> 00:17:37,570
we've actually already done this when we

397
00:17:35,950 --> 00:17:42,730
were looking<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Stewart</font><font color="#E5E5E5"> files per gram</font>

398
00:17:37,570 --> 00:17:44,168
- exec - LS<font color="#E5E5E5"> Ald all of our results</font><font color="#CCCCCC"> that</font>

399
00:17:42,730 --> 00:17:48,370
does<font color="#E5E5E5"> is for everything</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> fine pulls</font>

400
00:17:44,169 --> 00:17:51,309
back it executes the list<font color="#E5E5E5"> command on</font>

401
00:17:48,370 --> 00:17:53,979
each result so here we<font color="#E5E5E5"> get the full</font>

402
00:17:51,309 --> 00:17:57,850
permissions<font color="#E5E5E5"> of our fine</font><font color="#CCCCCC"> state</font><font color="#E5E5E5"> well if we</font>

403
00:17:53,980 --> 00:18:02,169
<font color="#E5E5E5">execute a different statement say open a</font>

404
00:17:57,850 --> 00:18:05,709
new shell then fine<font color="#E5E5E5"> which is suited will</font>

405
00:18:02,169 --> 00:18:08,830
execute in bash<font color="#E5E5E5"> or</font><font color="#CCCCCC"> bin Essex perhaps on</font>

406
00:18:05,710 --> 00:18:10,899
<font color="#E5E5E5">this one for every results it will do</font>

407
00:18:08,830 --> 00:18:13,330
<font color="#CCCCCC">that under</font><font color="#E5E5E5"> its permissions and since</font>

408
00:18:10,899 --> 00:18:17,049
mine<font color="#CCCCCC"> is running is rope - what it opens</font>

409
00:18:13,330 --> 00:18:18,519
<font color="#E5E5E5">is a root shell for us so this is</font>

410
00:18:17,049 --> 00:18:20,950
<font color="#E5E5E5">another intentional functionality these</font>

411
00:18:18,519 --> 00:18:22,510
are designed<font color="#CCCCCC"> to accept</font><font color="#E5E5E5"> additional</font>

412
00:18:20,950 --> 00:18:25,510
commands and do additional<font color="#E5E5E5"> operations</font>

413
00:18:22,510 --> 00:18:29,370
<font color="#E5E5E5">but</font><font color="#CCCCCC"> there is configuration and misuse we</font>

414
00:18:25,510 --> 00:18:29,370
can exploit these<font color="#E5E5E5"> to Deborah Johnson</font>

415
00:18:31,950 --> 00:18:37,360
so we're gonna do an<font color="#E5E5E5"> example</font><font color="#CCCCCC"> it is a</font>

416
00:18:35,500 --> 00:18:40,660
kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> shell</font><font color="#E5E5E5"> escape</font><font color="#CCCCCC"> I ran into</font><font color="#E5E5E5"> this</font>

417
00:18:37,360 --> 00:18:43,270
recently<font color="#E5E5E5"> it's real fun so</font><font color="#CCCCCC"> nano is a text</font>

418
00:18:40,660 --> 00:18:46,720
<font color="#CCCCCC">editor</font><font color="#E5E5E5"> frequently found for people who</font>

419
00:18:43,270 --> 00:18:47,980
<font color="#E5E5E5">don't like</font><font color="#CCCCCC"> then where you</font><font color="#E5E5E5"> max</font><font color="#CCCCCC"> so we're</font>

420
00:18:46,720 --> 00:18:51,400
going to check the permissions on<font color="#CCCCCC"> nano</font>

421
00:18:47,980 --> 00:18:56,380
<font color="#E5E5E5">and we do see</font><font color="#CCCCCC"> assembly</font><font color="#E5E5E5"> we're gonna check</font>

422
00:18:51,400 --> 00:19:01,240
bin<font color="#CCCCCC"> nano</font><font color="#E5E5E5"> and it is in fact</font><font color="#CCCCCC"> soon</font><font color="#E5E5E5"> it can</font>

423
00:18:56,380 --> 00:19:04,810
<font color="#E5E5E5">run as root in this system</font><font color="#CCCCCC"> so Nano lets</font>

424
00:19:01,240 --> 00:19:06,220
you load a custom<font color="#CCCCCC"> spell check file</font><font color="#E5E5E5"> so</font>

425
00:19:04,810 --> 00:19:08,649
<font color="#E5E5E5">that when you are checking the spelling</font>

426
00:19:06,220 --> 00:19:11,710
of a particular document<font color="#CCCCCC"> it</font><font color="#E5E5E5"> uses your</font>

427
00:19:08,650 --> 00:19:14,050
<font color="#E5E5E5">defined list of spelling Corrections</font>

428
00:19:11,710 --> 00:19:16,360
well what we're<font color="#E5E5E5"> gonna do is substitute</font>

429
00:19:14,050 --> 00:19:19,590
that with our own<font color="#CCCCCC"> temp file that</font>

430
00:19:16,360 --> 00:19:21,250
contains an<font color="#CCCCCC"> executed shell commands</font>

431
00:19:19,590 --> 00:19:22,750
<font color="#E5E5E5">we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> make it</font>

432
00:19:21,250 --> 00:19:24,970
that file itself that temp file

433
00:19:22,750 --> 00:19:28,060
executable<font color="#E5E5E5"> and then we're gonna load it</font>

434
00:19:24,970 --> 00:19:30,720
up in nano<font color="#E5E5E5"> as the spell check file for a</font>

435
00:19:28,060 --> 00:19:33,580
random file that we<font color="#E5E5E5"> want to have it</font>

436
00:19:30,720 --> 00:19:35,770
ceramic temp file<font color="#E5E5E5"> except she'll make it</font>

437
00:19:33,580 --> 00:19:38,470
<font color="#E5E5E5">executable</font><font color="#CCCCCC"> loaded with the</font><font color="#E5E5E5"> dash S or</font>

438
00:19:35,770 --> 00:19:42,190
<font color="#E5E5E5">spell option argument and then</font><font color="#CCCCCC"> within</font>

439
00:19:38,470 --> 00:19:44,140
<font color="#E5E5E5">nano</font><font color="#CCCCCC"> control-t is how you open a spell</font>

440
00:19:42,190 --> 00:19:48,280
check but when we do<font color="#E5E5E5"> that nano</font>

441
00:19:44,140 --> 00:19:53,590
<font color="#CCCCCC">sua did execute</font><font color="#E5E5E5"> our temporary but opens</font>

442
00:19:48,280 --> 00:19:56,350
<font color="#E5E5E5">the shell and this is another kind of</font>

443
00:19:53,590 --> 00:19:58,929
<font color="#CCCCCC">we've loaded a nested file we control</font>

444
00:19:56,350 --> 00:20:03,310
<font color="#CCCCCC">that file so we can have</font><font color="#E5E5E5"> it run any</font>

445
00:19:58,930 --> 00:20:05,230
<font color="#E5E5E5">handy one and the program</font><font color="#CCCCCC"> nano execute</font>

446
00:20:03,310 --> 00:20:12,629
<font color="#CCCCCC">another</font><font color="#E5E5E5"> its permissions which in this</font>

447
00:20:05,230 --> 00:20:14,380
case are so there's another way to

448
00:20:12,630 --> 00:20:16,090
<font color="#E5E5E5">there's another situation where you</font>

449
00:20:14,380 --> 00:20:17,640
going to<font color="#CCCCCC"> setup</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Dominos</font><font color="#E5E5E5"> the path</font>

450
00:20:16,090 --> 00:20:20,350
environment<font color="#E5E5E5"> variable we talked about</font>

451
00:20:17,640 --> 00:20:22,930
tells the underlying<font color="#CCCCCC"> operating system</font>

452
00:20:20,350 --> 00:20:24,310
<font color="#E5E5E5">Linux where to look for the</font><font color="#CCCCCC"> execute</font><font color="#E5E5E5"> so</font>

453
00:20:22,930 --> 00:20:27,490
that you don't have to specify the<font color="#E5E5E5"> full</font>

454
00:20:24,310 --> 00:20:28,870
path you inside LS instead of<font color="#CCCCCC"> been LS</font>

455
00:20:27,490 --> 00:20:32,050
every time you want<font color="#CCCCCC"> to list out the</font>

456
00:20:28,870 --> 00:20:33,639
permissions of a file<font color="#E5E5E5"> or directory so</font>

457
00:20:32,050 --> 00:20:35,379
classic use cases where<font color="#E5E5E5"> you want to</font>

458
00:20:33,640 --> 00:20:38,980
<font color="#E5E5E5">prank your admin</font>

459
00:20:35,380 --> 00:20:41,620
scenario bill<font color="#CCCCCC"> once the prank is I've</font>

460
00:20:38,980 --> 00:20:43,510
been his supervisor sue has her path

461
00:20:41,620 --> 00:20:46,178
starting with dot dot is the relative

462
00:20:43,510 --> 00:20:48,520
location<font color="#E5E5E5"> so her path environment</font>

463
00:20:46,179 --> 00:20:50,740
variable says<font color="#E5E5E5"> look where you are</font><font color="#CCCCCC"> current</font>

464
00:20:48,520 --> 00:20:52,750
directory<font color="#E5E5E5"> first when the executable</font><font color="#CCCCCC"> been</font>

465
00:20:50,740 --> 00:20:55,960
live in these<font color="#E5E5E5"> other places</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> he writes</font>

466
00:20:52,750 --> 00:20:57,460
<font color="#E5E5E5">a script he names it LS and sticks it in</font>

467
00:20:55,960 --> 00:20:59,410
his home directory<font color="#CCCCCC"> calls up</font><font color="#E5E5E5"> sue it says</font>

468
00:20:57,460 --> 00:21:02,020
he soon LS isn't working my home

469
00:20:59,410 --> 00:21:04,179
directory<font color="#CCCCCC"> what's going</font><font color="#E5E5E5"> on sue goes into</font>

470
00:21:02,020 --> 00:21:08,379
the server<font color="#E5E5E5"> into</font><font color="#CCCCCC"> Bill's home directory</font>

471
00:21:04,179 --> 00:21:13,570
<font color="#E5E5E5">and tries to run LS her path is set to</font>

472
00:21:08,380 --> 00:21:16,720
local so what Linux finds is<font color="#CCCCCC"> bills</font><font color="#E5E5E5"> LS</font>

473
00:21:13,570 --> 00:21:19,418
file first and execute that's what she's

474
00:21:16,720 --> 00:21:27,130
<font color="#CCCCCC">wanting to do it execute his script</font>

475
00:21:19,419 --> 00:21:31,150
instead<font color="#CCCCCC"> so I hop on to a web server</font><font color="#E5E5E5"> and</font>

476
00:21:27,130 --> 00:21:32,409
I find a custom program<font color="#CCCCCC"> probably not</font>

477
00:21:31,150 --> 00:21:34,270
going<font color="#E5E5E5"> to know what the other users have</font>

478
00:21:32,409 --> 00:21:38,260
<font color="#CCCCCC">their pack American set to this is one</font>

479
00:21:34,270 --> 00:21:40,030
you<font color="#E5E5E5"> can run yourself</font><font color="#CCCCCC"> I find custom</font>

480
00:21:38,260 --> 00:21:42,520
script on the server<font color="#E5E5E5"> that executes</font><font color="#CCCCCC"> a</font>

481
00:21:40,030 --> 00:21:47,289
<font color="#CCCCCC">call to an alias program</font><font color="#E5E5E5"> it's going</font><font color="#CCCCCC"> to</font>

482
00:21:42,520 --> 00:21:50,950
call<font color="#E5E5E5"> instead of</font><font color="#CCCCCC"> finding</font><font color="#E5E5E5"> or I can see</font>

483
00:21:47,289 --> 00:21:52,450
that a program is<font color="#CCCCCC"> running the PSP wants</font>

484
00:21:50,950 --> 00:21:58,299
to help us information about currently

485
00:21:52,450 --> 00:22:00,039
<font color="#CCCCCC">running processes if what it calls that</font>

486
00:21:58,299 --> 00:22:02,950
script<font color="#CCCCCC"> comes under root privileges you</font>

487
00:22:00,039 --> 00:22:05,320
<font color="#CCCCCC">can</font><font color="#E5E5E5"> explain so here's our use case we</font>

488
00:22:02,950 --> 00:22:06,610
have a helper<font color="#CCCCCC"> SH file</font><font color="#E5E5E5"> it's a custom</font>

489
00:22:05,320 --> 00:22:08,879
script<font color="#E5E5E5"> on the web server that makes life</font>

490
00:22:06,610 --> 00:22:11,139
easy for<font color="#E5E5E5"> an admin it's got</font><font color="#CCCCCC"> a suet bit</font>

491
00:22:08,880 --> 00:22:12,280
there's a<font color="#CCCCCC"> command within</font><font color="#E5E5E5"> the script that</font>

492
00:22:11,140 --> 00:22:15,220
<font color="#E5E5E5">recognized to execute something</font>

493
00:22:12,280 --> 00:22:17,710
<font color="#E5E5E5">recognizable</font><font color="#CCCCCC"> we recognize it say haha I</font>

494
00:22:15,220 --> 00:22:21,130
can<font color="#E5E5E5"> run this exploit in a writable</font>

495
00:22:17,710 --> 00:22:25,240
directory we make a new file we rewrite

496
00:22:21,130 --> 00:22:28,360
our pack and<font color="#E5E5E5"> then we execute</font><font color="#CCCCCC"> so we're</font>

497
00:22:25,240 --> 00:22:32,880
gonna<font color="#E5E5E5"> find the suited programs it's</font>

498
00:22:28,360 --> 00:22:32,879
gonna pull up helper script

499
00:22:33,450 --> 00:22:38,140
<font color="#E5E5E5">top one user share cup</font><font color="#CCCCCC"> rsh that's not</font>

500
00:22:36,700 --> 00:22:40,030
the standard utility so<font color="#CCCCCC"> if I think my</font>

501
00:22:38,140 --> 00:22:43,210
<font color="#E5E5E5">radio right away</font><font color="#CCCCCC"> so what is this what is</font>

502
00:22:40,030 --> 00:22:44,129
this<font color="#E5E5E5"> helper script</font><font color="#CCCCCC"> I run it to see what</font>

503
00:22:43,210 --> 00:22:46,410
it does

504
00:22:44,130 --> 00:22:47,970
well first I check permissions

505
00:22:46,410 --> 00:22:49,380
so<font color="#E5E5E5"> I'm gonna see the Commission's is</font>

506
00:22:47,970 --> 00:22:50,910
this something that<font color="#E5E5E5"> might be executed I</font>

507
00:22:49,380 --> 00:22:53,280
might be<font color="#CCCCCC"> exploitable it's got a seaweed</font>

508
00:22:50,910 --> 00:22:58,350
bit<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> on my route</font><font color="#E5E5E5"> I definitely am</font>

509
00:22:53,280 --> 00:22:58,980
interested<font color="#CCCCCC"> in this so now I run it see</font>

510
00:22:58,350 --> 00:23:02,280
what<font color="#E5E5E5"> it does</font>

511
00:22:58,980 --> 00:23:02,940
I recognize this<font color="#CCCCCC"> all right it's running</font>

512
00:23:02,280 --> 00:23:07,160
<font color="#E5E5E5">yes</font>

513
00:23:02,940 --> 00:23:11,190
so somewhere in that<font color="#E5E5E5"> file is the command</font>

514
00:23:07,160 --> 00:23:14,640
it's executing the PS command<font color="#CCCCCC"> confirm</font><font color="#E5E5E5"> by</font>

515
00:23:11,190 --> 00:23:16,410
running it myself<font color="#CCCCCC"> I hope that they've</font>

516
00:23:14,640 --> 00:23:18,480
<font color="#E5E5E5">just used the alias</font><font color="#CCCCCC"> right it's not</font>

517
00:23:16,410 --> 00:23:22,820
perfectly fine<font color="#CCCCCC"> so I'm gonna try this</font>

518
00:23:18,480 --> 00:23:26,700
<font color="#E5E5E5">next time I'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> go into that</font>

519
00:23:22,820 --> 00:23:33,419
<font color="#CCCCCC">world</font><font color="#E5E5E5"> right book let me see what out</font>

520
00:23:26,700 --> 00:23:34,110
<font color="#CCCCCC">there make a new file and I'm</font><font color="#E5E5E5"> going to</font>

521
00:23:33,420 --> 00:23:38,220
name that<font color="#E5E5E5"> file</font>

522
00:23:34,110 --> 00:23:43,320
<font color="#E5E5E5">yes well here I'll</font><font color="#CCCCCC"> check it out</font><font color="#E5E5E5"> my path</font>

523
00:23:38,220 --> 00:23:46,850
is<font color="#CCCCCC"> not set to dot yet now</font><font color="#E5E5E5"> I will make a</font>

524
00:23:43,320 --> 00:23:51,060
new file and<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> gonna put a thin Sh</font>

525
00:23:46,850 --> 00:23:53,189
<font color="#E5E5E5">right I'm gonna open</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> shell as the</font>

526
00:23:51,060 --> 00:23:58,429
content of that file I'm gonna make it

527
00:23:53,190 --> 00:23:58,430
executable<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> rewrite my path</font>

528
00:24:04,660 --> 00:24:09,430
so there's the permission<font color="#CCCCCC"> the next</font><font color="#E5E5E5"> pupil</font>

529
00:24:06,790 --> 00:24:11,170
file it's owned<font color="#CCCCCC"> by me</font><font color="#E5E5E5"> I'm gonna rewrite</font>

530
00:24:09,430 --> 00:24:16,840
I've have to include the relative alias

531
00:24:11,170 --> 00:24:19,870
<font color="#E5E5E5">spinning a little dot export</font><font color="#CCCCCC"> pop confirm</font>

532
00:24:16,840 --> 00:24:24,129
that it does in fact contain dub

533
00:24:19,870 --> 00:24:26,110
beginning<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> anything I run Linux</font>

534
00:24:24,130 --> 00:24:27,550
will look in<font color="#E5E5E5"> like current location first</font>

535
00:24:26,110 --> 00:24:31,360
<font color="#E5E5E5">and now I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> execute that helper</font>

536
00:24:27,550 --> 00:24:34,450
script<font color="#CCCCCC"> cover</font><font color="#E5E5E5"> script is</font><font color="#CCCCCC"> suited</font><font color="#E5E5E5"> it's going</font>

537
00:24:31,360 --> 00:24:37,060
<font color="#E5E5E5">to as</font><font color="#CCCCCC"> root</font><font color="#E5E5E5"> look for</font><font color="#CCCCCC"> a PS command it'll</font>

538
00:24:34,450 --> 00:24:39,730
find my local copy first<font color="#CCCCCC"> and execute the</font>

539
00:24:37,060 --> 00:24:45,909
contents within it<font color="#E5E5E5"> which in this case is</font>

540
00:24:39,730 --> 00:24:48,970
<font color="#CCCCCC">nothing a new job</font><font color="#E5E5E5"> so it can be</font><font color="#CCCCCC"> difficult</font>

541
00:24:45,910 --> 00:24:51,250
in the while to determine what those

542
00:24:48,970 --> 00:24:53,370
custom scripts are executing<font color="#CCCCCC"> the</font>

543
00:24:51,250 --> 00:24:56,650
frequently compiles are not readable but

544
00:24:53,370 --> 00:24:57,810
if you get familiar<font color="#E5E5E5"> with sort of basic</font>

545
00:24:56,650 --> 00:25:00,700
commands<font color="#E5E5E5"> it can be sometimes</font>

546
00:24:57,810 --> 00:25:02,250
particularly<font color="#E5E5E5"> messy skip environment</font><font color="#CCCCCC"> it's</font>

547
00:25:00,700 --> 00:25:07,420
usually pretty<font color="#CCCCCC"> obvious what it's viewing</font>

548
00:25:02,250 --> 00:25:09,040
and so you can try<font color="#CCCCCC"> to explain what parts</font>

549
00:25:07,420 --> 00:25:10,900
of<font color="#CCCCCC"> super powerful wire fox can be</font>

550
00:25:09,040 --> 00:25:12,070
<font color="#E5E5E5">exploited</font><font color="#CCCCCC"> so this is one</font><font color="#E5E5E5"> of the coolest</font>

551
00:25:10,900 --> 00:25:16,410
<font color="#E5E5E5">things that</font><font color="#CCCCCC"> I've learned in the last</font>

552
00:25:12,070 --> 00:25:19,960
<font color="#CCCCCC">couple years when using a start wildcard</font>

553
00:25:16,410 --> 00:25:23,080
the shell interprets - finally as a

554
00:25:19,960 --> 00:25:24,790
command option argument again things you

555
00:25:23,080 --> 00:25:27,040
submit to<font color="#E5E5E5"> the utility to give it</font>

556
00:25:24,790 --> 00:25:33,360
rameters we did it with<font color="#E5E5E5"> fine when we</font>

557
00:25:27,040 --> 00:25:37,540
<font color="#E5E5E5">submitted sex</font><font color="#CCCCCC"> command</font><font color="#E5E5E5"> so if you if you</font>

558
00:25:33,360 --> 00:25:41,080
name your file<font color="#E5E5E5"> - something it will</font>

559
00:25:37,540 --> 00:25:43,510
<font color="#E5E5E5">submit command options we run when you</font>

560
00:25:41,080 --> 00:25:46,149
<font color="#CCCCCC">run</font><font color="#E5E5E5"> into a</font><font color="#CCCCCC"> webpart</font><font color="#E5E5E5"> process so here's an</font>

561
00:25:43,510 --> 00:25:48,220
example we have<font color="#CCCCCC"> a directory in that</font>

562
00:25:46,150 --> 00:25:51,310
given directory we<font color="#CCCCCC"> have a reference file</font>

563
00:25:48,220 --> 00:25:55,600
and we've made a new file<font color="#E5E5E5"> and we think</font>

564
00:25:51,310 --> 00:25:57,220
<font color="#E5E5E5">that's just reference file</font><font color="#CCCCCC"> huge be</font><font color="#E5E5E5"> so -</font>

565
00:25:55,600 --> 00:26:01,120
<font color="#CCCCCC">just reference is a command option for</font>

566
00:25:57,220 --> 00:26:02,800
our<font color="#E5E5E5"> CH own executable it says take this</font>

567
00:26:01,120 --> 00:26:04,810
file that<font color="#E5E5E5"> we've specified in the</font>

568
00:26:02,800 --> 00:26:09,460
reference option<font color="#E5E5E5"> take all of its</font>

569
00:26:04,810 --> 00:26:10,899
permissions<font color="#E5E5E5"> and apply it to every file</font>

570
00:26:09,460 --> 00:26:13,330
when<font color="#CCCCCC"> we're rewriting</font><font color="#E5E5E5"> all the files in</font>

571
00:26:10,900 --> 00:26:14,610
the directory so initially we say you

572
00:26:13,330 --> 00:26:15,840
know<font color="#CCCCCC"> root has this this</font>

573
00:26:14,610 --> 00:26:18,629
newest processor cron job<font color="#CCCCCC"> that says</font>

574
00:26:15,840 --> 00:26:20,159
rewrite the ownership of<font color="#CCCCCC"> all files</font><font color="#E5E5E5"> all</font>

575
00:26:18,630 --> 00:26:22,679
PHP files in this directory is nobody

576
00:26:20,160 --> 00:26:24,480
nobody when it comes to our reference

577
00:26:22,679 --> 00:26:27,330
<font color="#E5E5E5">file that we've added to that directory</font>

578
00:26:24,480 --> 00:26:30,270
the reference file becomes an<font color="#CCCCCC"> option and</font>

579
00:26:27,330 --> 00:26:33,059
says ignore<font color="#E5E5E5"> this use the permissions of</font>

580
00:26:30,270 --> 00:26:35,730
this file<font color="#E5E5E5"> if that file reference has the</font>

581
00:26:33,059 --> 00:26:39,178
permissions that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> need in order to</font>

582
00:26:35,730 --> 00:26:41,190
escalate privileges<font color="#CCCCCC"> that statement</font><font color="#E5E5E5"> will</font>

583
00:26:39,179 --> 00:26:44,670
rewrite on the ownership of<font color="#CCCCCC"> the files to</font>

584
00:26:41,190 --> 00:26:50,970
our reference<font color="#E5E5E5"> because we made a command</font>

585
00:26:44,670 --> 00:26:53,250
option argument as a file<font color="#E5E5E5"> so it's gonna</font>

586
00:26:50,970 --> 00:26:55,110
map the permissions on to every<font color="#CCCCCC"> file</font>

587
00:26:53,250 --> 00:26:59,580
directory<font color="#E5E5E5"> because</font><font color="#CCCCCC"> it interprets the file</font>

588
00:26:55,110 --> 00:27:00,870
name as an option<font color="#E5E5E5"> this is another</font>

589
00:26:59,580 --> 00:27:02,280
example<font color="#E5E5E5"> of how that works</font><font color="#CCCCCC"> I don't</font>

590
00:27:00,870 --> 00:27:04,290
<font color="#CCCCCC">recommend</font><font color="#E5E5E5"> doing it unless you're willing</font>

591
00:27:02,280 --> 00:27:07,770
<font color="#CCCCCC">to delete your</font><font color="#E5E5E5"> file system but here</font>

592
00:27:04,290 --> 00:27:10,799
we've named our file - our F slash<font color="#E5E5E5"> start</font>

593
00:27:07,770 --> 00:27:12,570
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> so when we get remove star when it</font>

594
00:27:10,799 --> 00:27:15,990
<font color="#E5E5E5">gets to the Dutch are F slash start file</font>

595
00:27:12,570 --> 00:27:17,850
<font color="#CCCCCC">a command becomes RM dash RF slash star</font>

596
00:27:15,990 --> 00:27:22,799
which one<font color="#CCCCCC"> / simply remove your entire</font>

597
00:27:17,850 --> 00:27:25,168
<font color="#E5E5E5">crisis because RM is interpreting</font>

598
00:27:22,799 --> 00:27:27,870
through the<font color="#CCCCCC"> wild-card</font><font color="#E5E5E5"> the file name has</font>

599
00:27:25,169 --> 00:27:30,090
an option it's not<font color="#E5E5E5"> recognizing it as a</font>

600
00:27:27,870 --> 00:27:35,059
file it only interprets it as a command

601
00:27:30,090 --> 00:27:37,409
<font color="#E5E5E5">option and so it executes so wild cards</font>

602
00:27:35,059 --> 00:27:39,870
<font color="#E5E5E5">are a great</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> to look out for in</font>

603
00:27:37,410 --> 00:27:41,970
custom scripts or cron jobs or you know

604
00:27:39,870 --> 00:27:44,370
that<font color="#E5E5E5"> you can do certain executables with</font>

605
00:27:41,970 --> 00:27:46,080
options<font color="#E5E5E5"> try to see if you have the</font>

606
00:27:44,370 --> 00:27:49,979
permissions in<font color="#E5E5E5"> the directories where</font>

607
00:27:46,080 --> 00:27:52,830
they run to manipulate the<font color="#CCCCCC"> process</font>

608
00:27:49,980 --> 00:28:00,090
itself that<font color="#CCCCCC"> wild</font><font color="#E5E5E5"> heart process to do</font>

609
00:27:52,830 --> 00:28:02,178
actions unintentional so that's our

610
00:28:00,090 --> 00:28:04,830
<font color="#E5E5E5">sneaky mode mostly see we give sweet</font>

611
00:28:02,179 --> 00:28:07,440
angelic<font color="#CCCCCC"> eight smashed arguments have</font>

612
00:28:04,830 --> 00:28:08,428
equals dot and<font color="#CCCCCC"> wildcards good our two</font>

613
00:28:07,440 --> 00:28:10,679
ways of escalating

614
00:28:08,429 --> 00:28:12,720
CEO is entirely getting something<font color="#E5E5E5"> else</font>

615
00:28:10,679 --> 00:28:15,690
to do the work<font color="#CCCCCC"> for you</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> we are</font>

616
00:28:12,720 --> 00:28:19,919
using the permissions<font color="#E5E5E5"> of the executable</font>

617
00:28:15,690 --> 00:28:23,270
<font color="#CCCCCC">that is suited to take action ports</font><font color="#E5E5E5"> we</font>

618
00:28:19,919 --> 00:28:23,270
want the<font color="#CCCCCC"> sewer permissions</font>

619
00:28:23,820 --> 00:28:31,540
<font color="#E5E5E5">okay well</font><font color="#CCCCCC"> last bit boss mode is prana</font>

620
00:28:28,660 --> 00:28:33,309
<font color="#CCCCCC">Colonel</font><font color="#E5E5E5"> cron jobs are skewed a man's</font>

621
00:28:31,540 --> 00:28:36,070
executed on<font color="#CCCCCC"> a schedule</font><font color="#E5E5E5"> they are almost</font>

622
00:28:33,309 --> 00:28:37,299
always<font color="#CCCCCC"> done under root permissions two</font>

623
00:28:36,070 --> 00:28:42,070
<font color="#E5E5E5">things to look for</font><font color="#CCCCCC"> when you're starting</font>

624
00:28:37,299 --> 00:28:44,200
<font color="#E5E5E5">to look in the cron area is for car not</font>

625
00:28:42,070 --> 00:28:46,330
allow<font color="#CCCCCC"> cron job deny</font><font color="#E5E5E5"> those specifying zip</font>

626
00:28:44,200 --> 00:28:47,679
<font color="#CCCCCC">images that they don't</font><font color="#E5E5E5"> exist</font><font color="#CCCCCC"> probably</font>

627
00:28:46,330 --> 00:28:51,159
<font color="#E5E5E5">don't have to worry about your specific</font>

628
00:28:47,679 --> 00:28:52,030
<font color="#CCCCCC">these</font><font color="#E5E5E5"> are being blocked what</font><font color="#CCCCCC"> chrome</font><font color="#E5E5E5"> does</font>

629
00:28:51,160 --> 00:28:53,860
takes a file

630
00:28:52,030 --> 00:28:57,250
<font color="#CCCCCC">I'll tell us what's</font><font color="#E5E5E5"> execute</font><font color="#CCCCCC"> when the</font>

631
00:28:53,860 --> 00:29:01,000
file is usually contacted<font color="#CCCCCC"> there</font><font color="#E5E5E5"> also</font>

632
00:28:57,250 --> 00:29:03,940
cron directories<font color="#CCCCCC"> that will run at</font>

633
00:29:01,000 --> 00:29:06,280
certain configurable times hourly weekly

634
00:29:03,940 --> 00:29:09,520
monthly and you can often<font color="#CCCCCC"> write just</font><font color="#E5E5E5"> a</font>

635
00:29:06,280 --> 00:29:13,870
script<font color="#E5E5E5"> in their mission and it'll get</font>

636
00:29:09,520 --> 00:29:15,460
executed<font color="#E5E5E5"> at</font><font color="#CCCCCC"> batcher also</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> time</font>

637
00:29:13,870 --> 00:29:16,649
execution<font color="#CCCCCC"> will work a lot like cron</font><font color="#E5E5E5"> but</font>

638
00:29:15,460 --> 00:29:18,910
they are not periodic

639
00:29:16,650 --> 00:29:22,030
<font color="#E5E5E5">so cron is typically what we want to</font>

640
00:29:18,910 --> 00:29:23,770
exploit roommates to exploit<font color="#CCCCCC"> Crum you're</font>

641
00:29:22,030 --> 00:29:25,990
gonna actually over it it's a<font color="#E5E5E5"> cron tap</font>

642
00:29:23,770 --> 00:29:27,940
file<font color="#CCCCCC"> if you can you're</font><font color="#E5E5E5"> going to look for</font>

643
00:29:25,990 --> 00:29:32,160
a privilege<font color="#CCCCCC"> miss</font><font color="#E5E5E5"> configuration on a cron</font>

644
00:29:27,940 --> 00:29:34,350
directory<font color="#E5E5E5"> so you can add your own to run</font>

645
00:29:32,160 --> 00:29:36,370
and if<font color="#CCCCCC"> none of those are open to you</font>

646
00:29:34,350 --> 00:29:38,199
you're gonna<font color="#E5E5E5"> try to look and see</font>

647
00:29:36,370 --> 00:29:41,770
something<font color="#CCCCCC"> downstream that's vulnerable</font>

648
00:29:38,200 --> 00:29:44,110
<font color="#E5E5E5">in a comp process so you're going</font><font color="#CCCCCC"> to see</font>

649
00:29:41,770 --> 00:29:45,639
what cars<font color="#E5E5E5"> are running follow it down to</font>

650
00:29:44,110 --> 00:29:47,590
the<font color="#E5E5E5"> ActionScript</font><font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> trying to</font>

651
00:29:45,640 --> 00:29:50,140
execute periodically and see if you can

652
00:29:47,590 --> 00:29:52,209
manipulate<font color="#E5E5E5"> that somehow got some</font>

653
00:29:50,140 --> 00:29:55,780
<font color="#E5E5E5">examples first one is just over it it's</font>

654
00:29:52,210 --> 00:29:59,679
a crontab<font color="#CCCCCC"> you</font><font color="#E5E5E5"> look at the permissions on</font>

655
00:29:55,780 --> 00:30:01,410
crontab<font color="#E5E5E5"> they should be should be rude</font>

656
00:29:59,679 --> 00:30:09,130
<font color="#E5E5E5">right so</font><font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> gonna list out</font><font color="#CCCCCC"> that seat</font>

657
00:30:01,410 --> 00:30:12,130
just<font color="#E5E5E5"> for prawns and it is owned by roof</font>

658
00:30:09,130 --> 00:30:13,750
<font color="#CCCCCC">root is nothing that can write to</font><font color="#E5E5E5"> it and</font>

659
00:30:12,130 --> 00:30:18,070
cut<font color="#CCCCCC"> it out to read it see what</font><font color="#E5E5E5"> it looks</font>

660
00:30:13,750 --> 00:30:19,690
like<font color="#E5E5E5"> here are our periodic scripts they</font>

661
00:30:18,070 --> 00:30:24,159
run as roots these are the commands that

662
00:30:19,690 --> 00:30:25,570
<font color="#E5E5E5">are executed</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to just</font><font color="#CCCCCC"> nano see</font>

663
00:30:24,160 --> 00:30:27,340
if I can edit that file

664
00:30:25,570 --> 00:30:30,668
sometimes the<font color="#CCCCCC"> permissions aren't what</font>

665
00:30:27,340 --> 00:30:32,370
you think they<font color="#E5E5E5"> are so nano itself is</font>

666
00:30:30,669 --> 00:30:37,060
suited in this system

667
00:30:32,370 --> 00:30:40,120
so it can open<font color="#E5E5E5"> a file that is a group so</font>

668
00:30:37,060 --> 00:30:42,129
even though<font color="#CCCCCC"> Etsy crontab is owned and</font>

669
00:30:40,120 --> 00:30:42,489
only writable by<font color="#CCCCCC"> root I have</font><font color="#E5E5E5"> access to</font>

670
00:30:42,130 --> 00:30:46,090
<font color="#CCCCCC">it</font>

671
00:30:42,490 --> 00:30:47,560
<font color="#E5E5E5">this is one</font><font color="#CCCCCC"> of those</font><font color="#E5E5E5"> things where you</font>

672
00:30:46,090 --> 00:30:50,080
can't always believe<font color="#E5E5E5"> the permissions</font>

673
00:30:47,560 --> 00:30:52,540
that<font color="#E5E5E5"> you see so this is</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> a bunch of</font>

674
00:30:50,080 --> 00:30:55,419
optional commands<font color="#E5E5E5"> to prove that I can in</font>

675
00:30:52,540 --> 00:30:59,350
<font color="#E5E5E5">fact edit this file and make updates to</font>

676
00:30:55,420 --> 00:31:03,070
<font color="#CCCCCC">profit</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> let's check</font><font color="#E5E5E5"> there are any</font>

677
00:30:59,350 --> 00:31:05,379
permissions in various layers<font color="#E5E5E5"> second</font>

678
00:31:03,070 --> 00:31:07,510
we're going<font color="#E5E5E5"> to look for is can we write</font>

679
00:31:05,380 --> 00:31:14,170
to a cron directory<font color="#E5E5E5"> so we're gonna do</font>

680
00:31:07,510 --> 00:31:16,060
the listing out of things again we

681
00:31:14,170 --> 00:31:18,910
noticed that cron<font color="#CCCCCC"> de</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> leave is</font>

682
00:31:16,060 --> 00:31:21,159
writable<font color="#E5E5E5"> by its group right and this</font>

683
00:31:18,910 --> 00:31:24,100
group<font color="#E5E5E5"> is not root so do we share group</font>

684
00:31:21,160 --> 00:31:28,270
permissions with that group we do<font color="#E5E5E5"> is</font>

685
00:31:24,100 --> 00:31:29,860
this an example<font color="#E5E5E5"> right</font><font color="#CCCCCC"> we share</font>

686
00:31:28,270 --> 00:31:33,430
<font color="#CCCCCC">permissions our current user has</font>

687
00:31:29,860 --> 00:31:35,560
permission<font color="#CCCCCC"> to update</font><font color="#E5E5E5"> that directory so</font>

688
00:31:33,430 --> 00:31:38,340
we're gonna go in<font color="#E5E5E5"> and look what's in</font>

689
00:31:35,560 --> 00:31:43,600
that directory<font color="#E5E5E5"> we're gonna make our new</font>

690
00:31:38,340 --> 00:31:45,399
file and we do in fact<font color="#E5E5E5"> have permission</font>

691
00:31:43,600 --> 00:31:47,169
in<font color="#CCCCCC"> this scenario to create new</font>

692
00:31:45,400 --> 00:31:48,730
directories<font color="#E5E5E5"> for new files within that</font>

693
00:31:47,170 --> 00:31:50,440
are really<font color="#CCCCCC"> directory that means that</font>

694
00:31:48,730 --> 00:31:52,960
they will<font color="#CCCCCC"> whatever's in that</font><font color="#E5E5E5"> test file</font>

695
00:31:50,440 --> 00:32:00,310
script will automatically execute every

696
00:31:52,960 --> 00:32:05,560
hour<font color="#E5E5E5"> a specified</font><font color="#CCCCCC"> entire yeah</font><font color="#E5E5E5"> so run</font>

697
00:32:00,310 --> 00:32:10,690
parts so anything<font color="#CCCCCC"> that we put</font><font color="#E5E5E5"> in there</font>

698
00:32:05,560 --> 00:32:11,770
is gonna<font color="#E5E5E5"> get executed third and we look</font>

699
00:32:10,690 --> 00:32:14,710
for<font color="#E5E5E5"> something down the stream that's</font>

700
00:32:11,770 --> 00:32:17,350
honorable<font color="#E5E5E5"> it's a little more complex so</font>

701
00:32:14,710 --> 00:32:20,530
in our cron<font color="#CCCCCC"> D in this example there's a</font>

702
00:32:17,350 --> 00:32:21,909
clean trash script please<font color="#E5E5E5"> trash</font>

703
00:32:20,530 --> 00:32:22,930
definition cron job so we're gonna look

704
00:32:21,910 --> 00:32:27,760
at<font color="#E5E5E5"> it what is it safe</font>

705
00:32:22,930 --> 00:32:29,740
well every 30 minutes<font color="#CCCCCC"> root</font><font color="#E5E5E5"> execute these</font>

706
00:32:27,760 --> 00:32:32,050
scripts so I'm gonna go<font color="#E5E5E5"> and look at</font>

707
00:32:29,740 --> 00:32:34,390
those scripts<font color="#E5E5E5"> what do they do</font><font color="#CCCCCC"> alright it</font>

708
00:32:32,050 --> 00:32:35,379
normal<font color="#CCCCCC"> and they have other processes</font>

709
00:32:34,390 --> 00:32:37,580
<font color="#E5E5E5">that</font>

710
00:32:35,380 --> 00:32:39,830
so I'm going<font color="#E5E5E5"> to list out all the</font><font color="#CCCCCC"> creep</font>

711
00:32:37,580 --> 00:32:41,320
clean trash piles it turns out one of

712
00:32:39,830 --> 00:32:46,850
them is right<font color="#E5E5E5"> away</font>

713
00:32:41,320 --> 00:32:49,189
frankly trap level<font color="#CCCCCC"> 3 is misconfigured so</font>

714
00:32:46,850 --> 00:32:52,580
I'm going to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that I could have</font>

715
00:32:49,190 --> 00:32:56,720
did it just to<font color="#E5E5E5"> check yep there we go</font><font color="#CCCCCC"> I</font>

716
00:32:52,580 --> 00:32:57,889
<font color="#E5E5E5">can</font><font color="#CCCCCC"> bump by this file</font><font color="#E5E5E5"> and what it does</font>

717
00:32:56,720 --> 00:32:59,450
right<font color="#CCCCCC"> now is it just empties the trash</font>

718
00:32:57,890 --> 00:33:01,040
periodically but that's an important

719
00:32:59,450 --> 00:33:05,390
because we<font color="#CCCCCC"> can write to it</font><font color="#E5E5E5"> it means we</font>

720
00:33:01,040 --> 00:33:08,530
can<font color="#E5E5E5"> rewrite it so we're gonna write our</font>

721
00:33:05,390 --> 00:33:11,810
own shell script<font color="#CCCCCC"> in a root shell highly</font>

722
00:33:08,530 --> 00:33:13,790
modify its permissions<font color="#E5E5E5"> and then we're</font>

723
00:33:11,810 --> 00:33:16,760
gonna have that cron job that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can</font>

724
00:33:13,790 --> 00:33:19,129
edit modify its permission so we can run

725
00:33:16,760 --> 00:33:22,730
<font color="#CCCCCC">at its</font><font color="#E5E5E5"> root so our</font><font color="#CCCCCC"> Garrett duck see</font><font color="#E5E5E5"> it's</font>

726
00:33:19,130 --> 00:33:23,480
just<font color="#E5E5E5"> gonna execute big bash we're gonna</font>

727
00:33:22,730 --> 00:33:34,610
compile it

728
00:33:23,480 --> 00:33:36,290
GCC<font color="#CCCCCC"> we never to get</font><font color="#E5E5E5"> rid executable we're</font>

729
00:33:34,610 --> 00:33:40,250
gonna modify<font color="#E5E5E5"> its permission so it will</font>

730
00:33:36,290 --> 00:33:43,850
execute which in this process<font color="#E5E5E5"> already</font>

731
00:33:40,250 --> 00:33:46,400
<font color="#E5E5E5">happened so it's owned</font><font color="#CCCCCC"> by us here's our</font>

732
00:33:43,850 --> 00:33:49,219
get rid executable it is executable but

733
00:33:46,400 --> 00:33:51,860
it's owned by OS boxes<font color="#CCCCCC"> that's not gonna</font>

734
00:33:49,220 --> 00:33:54,170
<font color="#E5E5E5">help me much because</font><font color="#CCCCCC"> when it runs right</font>

735
00:33:51,860 --> 00:33:55,610
now it will execute a shell under my

736
00:33:54,170 --> 00:34:00,070
permissions<font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> execute a shell</font>

737
00:33:55,610 --> 00:34:04,969
under<font color="#E5E5E5"> root permissions so I'm gonna add</font>

738
00:34:00,070 --> 00:34:08,060
an ownership change to my get root

739
00:34:04,970 --> 00:34:10,429
executable<font color="#E5E5E5"> and I'm going to sue it might</font>

740
00:34:08,060 --> 00:34:12,730
get<font color="#E5E5E5"> root executable and I'm gonna stick</font>

741
00:34:10,429 --> 00:34:17,120
these commands into that vulnerable

742
00:34:12,730 --> 00:34:20,300
<font color="#E5E5E5">Fronda that I have recommended so I'm</font>

743
00:34:17,120 --> 00:34:24,679
gonna echo<font color="#E5E5E5"> those into</font><font color="#CCCCCC"> my clean trash</font>

744
00:34:20,300 --> 00:34:25,970
<font color="#CCCCCC">level-3 script</font><font color="#E5E5E5"> and then when cron</font><font color="#CCCCCC"> so</font>

745
00:34:24,679 --> 00:34:28,250
this is the process cron is gonna

746
00:34:25,969 --> 00:34:30,560
execute pre trash level frequent<font color="#E5E5E5"> every</font>

747
00:34:28,250 --> 00:34:33,290
<font color="#E5E5E5">hour clean tracks level</font><font color="#CCCCCC"> three now says</font>

748
00:34:30,560 --> 00:34:36,380
change the ownership of the get<font color="#CCCCCC"> mood</font>

749
00:34:33,290 --> 00:34:39,659
executable to<font color="#CCCCCC"> route and give it a</font><font color="#E5E5E5"> stupid</font>

750
00:34:36,380 --> 00:34:44,220
thing so I waited<font color="#CCCCCC"> 30 minutes</font>

751
00:34:39,659 --> 00:34:45,929
and the cron job executed now I'm<font color="#E5E5E5"> gonna</font>

752
00:34:44,219 --> 00:34:51,388
<font color="#E5E5E5">check the Commission's on my get rid</font>

753
00:34:45,929 --> 00:34:53,668
<font color="#E5E5E5">script</font><font color="#CCCCCC"> together and now the permissions</font>

754
00:34:51,389 --> 00:34:56,190
have been updated right<font color="#CCCCCC"> it has a</font><font color="#E5E5E5"> suid</font>

755
00:34:53,668 --> 00:35:00,868
<font color="#E5E5E5">bit and it's owned by group so now</font><font color="#CCCCCC"> when</font>

756
00:34:56,190 --> 00:35:08,220
<font color="#E5E5E5">I execute that</font><font color="#CCCCCC"> route it should open</font><font color="#E5E5E5"> a</font>

757
00:35:00,869 --> 00:35:10,559
<font color="#E5E5E5">shopping run it and I hope it works</font><font color="#CCCCCC"> it's</font>

758
00:35:08,220 --> 00:35:12,808
<font color="#E5E5E5">just under</font><font color="#CCCCCC"> their own</font><font color="#E5E5E5"> permissions this</font>

759
00:35:10,559 --> 00:35:14,519
particular system have different ways of

760
00:35:12,809 --> 00:35:20,000
interpreting bin<font color="#E5E5E5"> Bachelor suspension</font><font color="#CCCCCC"> and</font>

761
00:35:14,519 --> 00:35:23,008
I got<font color="#E5E5E5"> the</font><font color="#CCCCCC"> kata</font><font color="#E5E5E5"> me so I made a</font><font color="#CCCCCC"> new one</font>

762
00:35:20,000 --> 00:35:25,559
<font color="#CCCCCC">Golub route me that just says business</font>

763
00:35:23,009 --> 00:35:27,210
<font color="#CCCCCC">eight shoes I did the same process and</font>

764
00:35:25,559 --> 00:35:30,079
waited<font color="#E5E5E5"> 30 minutes I got sticky bit it's</font>

765
00:35:27,210 --> 00:35:33,390
owned<font color="#E5E5E5"> by</font><font color="#CCCCCC"> route now when I execute it</font>

766
00:35:30,079 --> 00:35:36,150
<font color="#CCCCCC">opens the shell correctly so I left this</font>

767
00:35:33,390 --> 00:35:38,038
in because<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> part of why this is</font><font color="#E5E5E5"> a</font>

768
00:35:36,150 --> 00:35:42,240
<font color="#E5E5E5">possibility right</font><font color="#CCCCCC"> not only are we four</font>

769
00:35:38,039 --> 00:35:44,670
levels deep in our<font color="#E5E5E5"> attack but anytime</font>

770
00:35:42,240 --> 00:35:46,589
you<font color="#CCCCCC"> are trying to write a</font><font color="#E5E5E5"> custom file</font>

771
00:35:44,670 --> 00:35:48,329
<font color="#E5E5E5">and you pilot</font><font color="#CCCCCC"> it to do a thing there's</font>

772
00:35:46,589 --> 00:35:51,390
probably bugging involved which is<font color="#E5E5E5"> not</font>

773
00:35:48,329 --> 00:35:53,730
for<font color="#CCCCCC"> novice users but this is the process</font>

774
00:35:51,390 --> 00:35:55,200
<font color="#CCCCCC">right if you can't override</font><font color="#E5E5E5"> the front up</font>

775
00:35:53,730 --> 00:35:56,609
file if you can't write to<font color="#CCCCCC"> a directory</font>

776
00:35:55,200 --> 00:35:58,529
look and see if there's something

777
00:35:56,609 --> 00:36:00,058
vulnerable down the stream maybe there's

778
00:35:58,529 --> 00:36:02,759
a custom script<font color="#CCCCCC"> that's is</font><font color="#E5E5E5"> configured</font>

779
00:36:00,059 --> 00:36:05,549
maybe there's a group overlap that<font color="#E5E5E5"> you</font>

780
00:36:02,759 --> 00:36:07,829
can exploit maybe it called me that

781
00:36:05,549 --> 00:36:10,559
night<font color="#CCCCCC"> plate trash</font><font color="#E5E5E5"> level three cats out a</font>

782
00:36:07,829 --> 00:36:13,559
file and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can do the pack dot exploit</font>

783
00:36:10,559 --> 00:36:15,150
on that file or<font color="#CCCCCC"> that is running there</font>

784
00:36:13,559 --> 00:36:18,630
<font color="#E5E5E5">there are options for combining things</font>

785
00:36:15,150 --> 00:36:19,769
that<font color="#CCCCCC"> that's why this is that's</font><font color="#E5E5E5"> good</font>

786
00:36:18,630 --> 00:36:21,809
theory behind it<font color="#E5E5E5"> I think we're gonna</font>

787
00:36:19,769 --> 00:36:24,089
target<font color="#E5E5E5"> something downstream we're</font><font color="#CCCCCC"> gonna</font>

788
00:36:21,809 --> 00:36:27,450
get<font color="#E5E5E5"> a</font><font color="#CCCCCC"> route process to</font><font color="#E5E5E5"> execute our</font>

789
00:36:24,089 --> 00:36:30,720
<font color="#E5E5E5">commands and give ourselves elevated</font>

790
00:36:27,450 --> 00:36:33,058
privileges kernel exploits is the last

791
00:36:30,720 --> 00:36:34,129
<font color="#E5E5E5">think of the day out so fast today</font><font color="#CCCCCC"> this</font>

792
00:36:33,059 --> 00:36:36,660
is great

793
00:36:34,130 --> 00:36:38,280
hope you like<font color="#CCCCCC"> zidane you</font><font color="#E5E5E5"> see so kernel</font>

794
00:36:36,660 --> 00:36:40,379
exploit is basically a magic<font color="#E5E5E5"> bullet</font>

795
00:36:38,280 --> 00:36:42,780
<font color="#E5E5E5">what if you just compromised the server</font>

796
00:36:40,380 --> 00:36:44,370
itself forget about permissions forget

797
00:36:42,780 --> 00:36:45,840
about users<font color="#E5E5E5"> forget about executables</font>

798
00:36:44,370 --> 00:36:50,220
what if we target the underlying

799
00:36:45,840 --> 00:36:53,310
structure<font color="#CCCCCC"> the outside</font><font color="#E5E5E5"> is for common</font>

800
00:36:50,220 --> 00:36:54,600
<font color="#E5E5E5">kernel and OS combinations there are</font>

801
00:36:53,310 --> 00:36:56,730
lots of exploits out there if it's

802
00:36:54,600 --> 00:36:59,130
normal<font color="#E5E5E5"> somebody's probably written a</font>

803
00:36:56,730 --> 00:37:01,230
script that<font color="#CCCCCC"> will exploit it for you</font>

804
00:36:59,130 --> 00:37:02,640
the downside is there are probably<font color="#CCCCCC"> lots</font>

805
00:37:01,230 --> 00:37:05,100
of scripts<font color="#E5E5E5"> that you will have to compile</font>

806
00:37:02,640 --> 00:37:08,730
a debugger<font color="#E5E5E5"> clearly not my favorite thing</font>

807
00:37:05,100 --> 00:37:13,350
<font color="#CCCCCC">in the world so exploit DB has a lot of</font>

808
00:37:08,730 --> 00:37:14,940
them or known vulnerable<font color="#E5E5E5"> curls you ran</font>

809
00:37:13,350 --> 00:37:17,370
<font color="#CCCCCC">an ox Laura sue Perkins server and a</font>

810
00:37:14,940 --> 00:37:19,530
really big deal<font color="#CCCCCC"> for these is that you're</font>

811
00:37:17,370 --> 00:37:21,569
gonna<font color="#E5E5E5"> have to debug why it doesn't work</font>

812
00:37:19,530 --> 00:37:24,060
initially<font color="#E5E5E5"> each of the servers that</font>

813
00:37:21,570 --> 00:37:26,760
<font color="#CCCCCC">you're going to see everything</font><font color="#E5E5E5"> you run</font>

814
00:37:24,060 --> 00:37:28,529
into has custom configurations nobody's

815
00:37:26,760 --> 00:37:31,440
running things just out of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> vise so a</font>

816
00:37:28,530 --> 00:37:35,280
lot of<font color="#E5E5E5"> the current exploits depend on a</font>

817
00:37:31,440 --> 00:37:38,670
<font color="#E5E5E5">certain configuration of permissions</font><font color="#CCCCCC"> and</font>

818
00:37:35,280 --> 00:37:41,660
where<font color="#E5E5E5"> things are located and so when you</font>

819
00:37:38,670 --> 00:37:43,890
<font color="#E5E5E5">start trying to do our kernel activate</font>

820
00:37:41,660 --> 00:37:45,480
<font color="#CCCCCC">you're gonna have to figure</font><font color="#E5E5E5"> out the</font>

821
00:37:43,890 --> 00:37:47,460
difference between<font color="#E5E5E5"> the environment</font>

822
00:37:45,480 --> 00:37:49,590
you're attacking and what the exploit is

823
00:37:47,460 --> 00:37:51,930
<font color="#E5E5E5">sex</font><font color="#CCCCCC"> and that's gonna be a lot of people</font>

824
00:37:49,590 --> 00:37:54,630
<font color="#CCCCCC">where is it looking for</font><font color="#E5E5E5"> this file can i</font>

825
00:37:51,930 --> 00:37:57,330
model Phi that can i rewrite<font color="#E5E5E5"> the kernel</font>

826
00:37:54,630 --> 00:37:58,700
<font color="#CCCCCC">work</font><font color="#E5E5E5"> the exploit or can I</font><font color="#CCCCCC"> remove</font>

827
00:37:57,330 --> 00:38:02,279
something<font color="#E5E5E5"> on the web server</font>

828
00:37:58,700 --> 00:38:06,029
<font color="#E5E5E5">so that's bullet but it's not as simple</font>

829
00:38:02,280 --> 00:38:07,920
as<font color="#E5E5E5"> people</font><font color="#CCCCCC"> those</font><font color="#E5E5E5"> are the commands</font><font color="#CCCCCC"> LV</font>

830
00:38:06,030 --> 00:38:12,210
<font color="#CCCCCC">release - a and s Eamonn will give you</font>

831
00:38:07,920 --> 00:38:13,950
your OS version and your kernel version

832
00:38:12,210 --> 00:38:18,350
that's what you search for when you're

833
00:38:13,950 --> 00:38:18,350
looking<font color="#E5E5E5"> for an already written</font>

834
00:38:18,710 --> 00:38:25,020
so the VM<font color="#CCCCCC"> that I built for</font><font color="#E5E5E5"> you guys does</font>

835
00:38:22,590 --> 00:38:27,930
not it theoretically has a kernel

836
00:38:25,020 --> 00:38:29,250
exploit but<font color="#CCCCCC"> they didn't run</font><font color="#E5E5E5"> it so you're</font>

837
00:38:27,930 --> 00:38:31,230
welcome to<font color="#E5E5E5"> try that but all of the other</font>

838
00:38:29,250 --> 00:38:34,950
things<font color="#CCCCCC"> that you've seen</font><font color="#E5E5E5"> today all the</font>

839
00:38:31,230 --> 00:38:36,990
<font color="#E5E5E5">stupid exploits misconfigured</font><font color="#CCCCCC"> and the</font>

840
00:38:34,950 --> 00:38:38,189
director<font color="#CCCCCC"> Commission's they all exist so</font>

841
00:38:36,990 --> 00:38:38,669
if you want to<font color="#E5E5E5"> practice this woman I</font>

842
00:38:38,190 --> 00:38:40,920
mean

843
00:38:38,670 --> 00:38:44,610
this<font color="#CCCCCC"> talk specifically they're all so</font>

844
00:38:40,920 --> 00:38:45,960
<font color="#E5E5E5">much on the web so boss mode our cron</font>

845
00:38:44,610 --> 00:38:48,330
jobs again we're going<font color="#E5E5E5"> to try to attack</font>

846
00:38:45,960 --> 00:38:50,130
on tap<font color="#E5E5E5"> a write up a crown directory</font>

847
00:38:48,330 --> 00:38:53,700
<font color="#CCCCCC">gonna try to</font><font color="#E5E5E5"> effect something downstream</font>

848
00:38:50,130 --> 00:38:56,010
and my last resort is<font color="#CCCCCC"> Colonel exploits</font>

849
00:38:53,700 --> 00:38:57,540
just<font color="#E5E5E5"> isn't</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> so much time of trying</font>

850
00:38:56,010 --> 00:38:59,340
to<font color="#E5E5E5"> get the exploit to work on a</font>

851
00:38:57,540 --> 00:39:00,480
<font color="#E5E5E5">particular</font><font color="#CCCCCC"> I'm there things like</font><font color="#E5E5E5"> dirty</font>

852
00:38:59,340 --> 00:39:04,590
how they're supposed<font color="#CCCCCC"> to be basically a</font>

853
00:39:00,480 --> 00:39:07,560
<font color="#E5E5E5">nuclear attack but you also sometimes</font>

854
00:39:04,590 --> 00:39:09,660
blow stuff<font color="#E5E5E5"> up they don't want to waste</font>

855
00:39:07,560 --> 00:39:11,460
<font color="#CCCCCC">us</font><font color="#E5E5E5"> like again where you are the</font><font color="#CCCCCC"> agent or</font>

856
00:39:09,660 --> 00:39:13,379
<font color="#E5E5E5">something else</font><font color="#CCCCCC"> in agent bus mode</font>

857
00:39:11,460 --> 00:39:15,300
something else is the agent<font color="#E5E5E5"> most of the</font>

858
00:39:13,380 --> 00:39:17,130
kernel exploits are going to look<font color="#E5E5E5"> a lot</font>

859
00:39:15,300 --> 00:39:19,860
<font color="#E5E5E5">like the complex on job exploit where</font>

860
00:39:17,130 --> 00:39:22,500
<font color="#E5E5E5">you're that the kernel exploit that's</font>

861
00:39:19,860 --> 00:39:24,360
written<font color="#E5E5E5"> is manipulating known processes</font>

862
00:39:22,500 --> 00:39:26,340
and utilities<font color="#E5E5E5"> exploiting common</font>

863
00:39:24,360 --> 00:39:30,080
permissions that are<font color="#E5E5E5"> likely in place in</font>

864
00:39:26,340 --> 00:39:32,130
<font color="#E5E5E5">order</font><font color="#CCCCCC"> to give you something</font>

865
00:39:30,080 --> 00:39:33,810
<font color="#CCCCCC">mostly it's something else</font><font color="#E5E5E5"> the agent</font>

866
00:39:32,130 --> 00:39:35,790
here but you're probably<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to set up</font>

867
00:39:33,810 --> 00:39:42,810
a lot more dominance<font color="#E5E5E5"> in these exploits</font>

868
00:39:35,790 --> 00:39:44,009
then that's that<font color="#E5E5E5"> so in summary the goal</font>

869
00:39:42,810 --> 00:39:45,779
within<font color="#E5E5E5"> a web server once you've made it</font>

870
00:39:44,010 --> 00:39:47,670
<font color="#CCCCCC">through the superficial</font><font color="#E5E5E5"> layer you don't</font>

871
00:39:45,780 --> 00:39:49,800
<font color="#CCCCCC">want persistence but be able to hop back</font>

872
00:39:47,670 --> 00:39:52,170
in at will and you're going<font color="#E5E5E5"> to want to</font>

873
00:39:49,800 --> 00:39:54,210
escalate privileges<font color="#E5E5E5"> our framework was</font>

874
00:39:52,170 --> 00:39:56,100
thinking about<font color="#E5E5E5"> who's</font><font color="#CCCCCC"> the agent if it's</font>

875
00:39:54,210 --> 00:39:57,450
you drop yourself into a shell<font color="#E5E5E5"> and give</font>

876
00:39:56,100 --> 00:39:59,190
yourself<font color="#CCCCCC"> persistence</font><font color="#E5E5E5"> you know you have</font>

877
00:39:57,450 --> 00:40:00,839
what you<font color="#CCCCCC"> need</font><font color="#E5E5E5"> if something else</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font>

878
00:39:59,190 --> 00:40:03,840
agent you need that intermediate step

879
00:40:00,840 --> 00:40:06,720
<font color="#E5E5E5">you can find a utility or</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> process</font>

880
00:40:03,840 --> 00:40:09,390
that's<font color="#CCCCCC"> gonna help you execute a root</font>

881
00:40:06,720 --> 00:40:12,089
<font color="#CCCCCC">shell and give yourself assistance so</font>

882
00:40:09,390 --> 00:40:14,370
<font color="#CCCCCC">our easy sneaky and bus modes various</font>

883
00:40:12,090 --> 00:40:15,810
things<font color="#CCCCCC"> talked about</font><font color="#E5E5E5"> today again Linux</font>

884
00:40:14,370 --> 00:40:17,640
<font color="#CCCCCC">depends make</font><font color="#E5E5E5"> barely consistent</font><font color="#CCCCCC"> I mean</font>

885
00:40:15,810 --> 00:40:19,560
<font color="#CCCCCC">super wipers</font><font color="#E5E5E5"> for a</font><font color="#CCCCCC"> platform all the</font>

886
00:40:17,640 --> 00:40:23,009
various versions<font color="#CCCCCC"> are fairly consistent</font>

887
00:40:19,560 --> 00:40:24,660
in where things with<font color="#E5E5E5"> where to</font><font color="#CCCCCC"> look for</font>

888
00:40:23,010 --> 00:40:26,580
particular utilities what until<font color="#E5E5E5"> these</font>

889
00:40:24,660 --> 00:40:28,830
come standard so if you get more

890
00:40:26,580 --> 00:40:30,840
<font color="#E5E5E5">familiar with the Windows environment</font><font color="#CCCCCC"> it</font>

891
00:40:28,830 --> 00:40:33,210
gets a<font color="#E5E5E5"> lot faster to determine what</font>

892
00:40:30,840 --> 00:40:37,320
paths are open to you in<font color="#CCCCCC"> this particular</font>

893
00:40:33,210 --> 00:40:40,620
instance resources in my contact

894
00:40:37,320 --> 00:40:42,120
information again<font color="#E5E5E5"> slide decks up with</font>

895
00:40:40,620 --> 00:40:44,400
<font color="#E5E5E5">Kiev versions of all the exploits</font>

896
00:40:42,120 --> 00:40:45,330
<font color="#E5E5E5">there's pecs be I'm there it's</font><font color="#CCCCCC"> about a</font>

897
00:40:44,400 --> 00:40:48,450
<font color="#E5E5E5">cake</font>

898
00:40:45,330 --> 00:40:51,600
it's the lightweight but<font color="#CCCCCC"> too</font>

899
00:40:48,450 --> 00:40:53,100
ready to go and then<font color="#E5E5E5"> these</font><font color="#CCCCCC"> are resources</font>

900
00:40:51,600 --> 00:40:55,680
<font color="#E5E5E5">either that I used in developing the top</font>

901
00:40:53,100 --> 00:40:57,029
<font color="#E5E5E5">or things</font><font color="#CCCCCC"> like the payout</font><font color="#E5E5E5"> you look at</font>

902
00:40:55,680 --> 00:40:58,799
the top is a pretty good guide I'm

903
00:40:57,030 --> 00:41:01,020
privileged escalation has similar

904
00:40:58,800 --> 00:41:02,400
<font color="#E5E5E5">explanations but what I really love</font>

905
00:41:01,020 --> 00:41:04,970
about that limits at the bottom there's

906
00:41:02,400 --> 00:41:09,869
about<font color="#CCCCCC"> fifteen virtual machines</font>

907
00:41:04,970 --> 00:41:11,939
<font color="#E5E5E5">well</font><font color="#CCCCCC"> Huff mostly and</font><font color="#E5E5E5"> they define what</font>

908
00:41:09,869 --> 00:41:13,740
exploits are represented in<font color="#CCCCCC"> each one</font><font color="#E5E5E5"> so</font>

909
00:41:11,940 --> 00:41:15,300
if<font color="#E5E5E5"> you really want to practice</font><font color="#CCCCCC"> kernel</font>

910
00:41:13,740 --> 00:41:16,680
exploits you really want to look<font color="#E5E5E5"> at suet</font>

911
00:41:15,300 --> 00:41:18,600
bits for<font color="#E5E5E5"> a while you can pull up</font>

912
00:41:16,680 --> 00:41:19,859
individual virtual machines that<font color="#E5E5E5"> will</font>

913
00:41:18,600 --> 00:41:28,680
use those<font color="#CCCCCC"> exploits</font>

914
00:41:19,859 --> 00:41:31,170
it's it's a graceful we have about 15

915
00:41:28,680 --> 00:41:35,060
minutes<font color="#CCCCCC"> for</font><font color="#E5E5E5"> questions things you want to</font>

916
00:41:31,170 --> 00:41:35,060
<font color="#E5E5E5">go over</font><font color="#CCCCCC"> again I talk really fast I know</font>

