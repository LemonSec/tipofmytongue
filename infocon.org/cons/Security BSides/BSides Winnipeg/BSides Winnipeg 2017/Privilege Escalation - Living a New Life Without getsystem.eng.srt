1
00:00:01,010 --> 00:00:07,350
<font color="#CCCCCC">Hey hello everyone my name is Dimitri</font>

2
00:00:05,370 --> 00:00:09,780
and<font color="#E5E5E5"> I'm going to present you</font><font color="#CCCCCC"> privilege</font>

3
00:00:07,350 --> 00:00:13,469
<font color="#CCCCCC">escalation</font><font color="#E5E5E5"> some basic stuff for Windows</font>

4
00:00:09,780 --> 00:00:19,979
and<font color="#E5E5E5"> Linux so oh my</font><font color="#CCCCCC"> i'm software</font>

5
00:00:13,469 --> 00:00:22,619
developer okay i'm software developer

6
00:00:19,980 --> 00:00:25,260
and<font color="#CCCCCC"> pc</font><font color="#E5E5E5"> internal security</font><font color="#CCCCCC"> assessor at</font><font color="#E5E5E5"> IQ</font>

7
00:00:22,619 --> 00:00:33,600
metrics<font color="#E5E5E5"> and also</font><font color="#CCCCCC"> husband's</font><font color="#E5E5E5"> and recently</font>

8
00:00:25,260 --> 00:00:36,149
<font color="#E5E5E5">and father so so privilege escalation in</font>

9
00:00:33,600 --> 00:00:38,610
<font color="#CCCCCC">shirts</font><font color="#E5E5E5"> who will need to help a little</font>

10
00:00:36,149 --> 00:00:42,360
evil unicorn<font color="#CCCCCC"> to climb from restrictor</font>

11
00:00:38,610 --> 00:00:49,110
user to system roots level using barks

12
00:00:42,360 --> 00:00:52,230
miss configuration or other tricks okay

13
00:00:49,110 --> 00:00:54,539
so<font color="#CCCCCC"> Metasploit has very powerful get</font>

14
00:00:52,230 --> 00:00:57,510
system command<font color="#E5E5E5"> and when it works you</font>

15
00:00:54,539 --> 00:00:59,399
<font color="#E5E5E5">will get system excels immediately but</font>

16
00:00:57,510 --> 00:01:02,280
sometimes it doesn't<font color="#E5E5E5"> work and you won't</font>

17
00:00:59,399 --> 00:01:04,409
<font color="#E5E5E5">get</font><font color="#CCCCCC"> your system</font><font color="#E5E5E5"> so one day I started to</font>

18
00:01:02,280 --> 00:01:06,510
<font color="#CCCCCC">think why it works sometimes why it</font>

19
00:01:04,409 --> 00:01:08,880
doesn't<font color="#E5E5E5"> work when it works how</font><font color="#CCCCCC"> it works</font>

20
00:01:06,510 --> 00:01:13,850
<font color="#E5E5E5">at what can I do that might explode at</font>

21
00:01:08,880 --> 00:01:17,658
all so I check source code on github<font color="#E5E5E5"> and</font>

22
00:01:13,850 --> 00:01:21,179
basically says<font color="#CCCCCC"> guesses</font><font color="#E5E5E5"> and module works</font>

23
00:01:17,659 --> 00:01:23,490
only for Windows<font color="#E5E5E5"> and it will elevate</font>

24
00:01:21,180 --> 00:01:25,799
privileges from<font color="#E5E5E5"> administrator account to</font>

25
00:01:23,490 --> 00:01:28,110
system account and actual source code

26
00:01:25,799 --> 00:01:33,570
confirms the only<font color="#CCCCCC"> support this platform</font>

27
00:01:28,110 --> 00:01:36,960
is<font color="#E5E5E5"> Windows ok so what happens when I</font>

28
00:01:33,570 --> 00:01:40,350
type<font color="#CCCCCC"> gets system</font><font color="#E5E5E5"> get system uses three</font>

29
00:01:36,960 --> 00:01:43,530
techniques<font color="#CCCCCC"> tools M relies on named pipe</font>

30
00:01:40,350 --> 00:01:45,929
impersonation and the last one relies on

31
00:01:43,530 --> 00:01:48,180
token duplication but all three

32
00:01:45,930 --> 00:01:53,009
techniques depends on ability of

33
00:01:48,180 --> 00:01:55,290
<font color="#E5E5E5">privileged user to create service or to</font>

34
00:01:53,009 --> 00:01:59,159
inject a service and<font color="#E5E5E5"> you can find more</font>

35
00:01:55,290 --> 00:02:03,119
details more technical details by

36
00:01:59,159 --> 00:02:06,780
following<font color="#E5E5E5"> the link the problem that we</font>

37
00:02:03,119 --> 00:02:10,169
have with<font color="#E5E5E5"> the get system well first of</font>

38
00:02:06,780 --> 00:02:12,629
all<font color="#E5E5E5"> if you have a USC user account</font>

39
00:02:10,169 --> 00:02:13,829
control enabled<font color="#E5E5E5"> it won't work</font>

40
00:02:12,629 --> 00:02:15,359
so in<font color="#CCCCCC"> order</font>

41
00:02:13,830 --> 00:02:19,470
to get your system<font color="#E5E5E5"> first</font><font color="#CCCCCC"> you need to</font>

42
00:02:15,360 --> 00:02:21,960
<font color="#E5E5E5">bypass USC</font><font color="#CCCCCC"> Metasploit has some models</font><font color="#E5E5E5"> to</font>

43
00:02:19,470 --> 00:02:24,960
bypass<font color="#E5E5E5"> UAC</font><font color="#CCCCCC"> so it's</font><font color="#E5E5E5"> not a problem but</font>

44
00:02:21,960 --> 00:02:27,120
first you<font color="#E5E5E5"> need to vapor CAC and as I</font>

45
00:02:24,960 --> 00:02:29,070
mentioned<font color="#CCCCCC"> before it works only under</font>

46
00:02:27,120 --> 00:02:31,830
<font color="#E5E5E5">administrators so first you</font><font color="#CCCCCC"> need to get</font>

47
00:02:29,070 --> 00:02:35,820
administrator<font color="#CCCCCC"> Metasploit provides some</font>

48
00:02:31,830 --> 00:02:38,100
local exploits<font color="#E5E5E5"> so you can run it get</font>

49
00:02:35,820 --> 00:02:44,010
administrators and bypass UEC and

50
00:02:38,100 --> 00:02:47,070
<font color="#E5E5E5">hopefully you'll get your system so I</font>

51
00:02:44,010 --> 00:02:49,470
started to search what other options we

52
00:02:47,070 --> 00:02:51,810
have and found a lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> interests in</font>

53
00:02:49,470 --> 00:02:54,630
materials in<font color="#CCCCCC"> Internet so I'm going to</font>

54
00:02:51,810 --> 00:02:56,370
share some of<font color="#CCCCCC"> my functions so we can use</font>

55
00:02:54,630 --> 00:02:59,340
<font color="#E5E5E5">schedule</font><font color="#CCCCCC"> tasks we see exact or some</font>

56
00:02:56,370 --> 00:03:03,030
other tools to<font color="#CCCCCC"> elevate privileges from</font>

57
00:02:59,340 --> 00:03:05,760
administrator to system the first<font color="#E5E5E5"> one</font>

58
00:03:03,030 --> 00:03:09,000
and the easiest<font color="#E5E5E5"> one is</font><font color="#CCCCCC"> add commands so</font>

59
00:03:05,760 --> 00:03:12,179
<font color="#CCCCCC">add allows you</font><font color="#E5E5E5"> to schedule a task and in</font>

60
00:03:09,000 --> 00:03:15,180
this sample<font color="#CCCCCC"> I will ask to provide a</font>

61
00:03:12,180 --> 00:03:18,480
comment line in interactive mode<font color="#CCCCCC"> and</font><font color="#E5E5E5"> one</font>

62
00:03:15,180 --> 00:03:22,140
<font color="#E5E5E5">x counts I will get system console which</font>

63
00:03:18,480 --> 00:03:24,179
<font color="#CCCCCC">is pretty nice</font><font color="#E5E5E5"> the tricky part</font><font color="#CCCCCC"> so it</font>

64
00:03:22,140 --> 00:03:28,290
works only in Windows<font color="#E5E5E5"> XP and Windows</font>

65
00:03:24,180 --> 00:03:30,480
2003<font color="#CCCCCC"> on Windows 7</font><font color="#E5E5E5"> due</font><font color="#CCCCCC"> to security</font>

66
00:03:28,290 --> 00:03:34,260
<font color="#E5E5E5">enhancements is this task will run only</font>

67
00:03:30,480 --> 00:03:37,350
<font color="#E5E5E5">in non interactively mode well it's</font>

68
00:03:34,260 --> 00:03:40,440
still kind of<font color="#CCCCCC"> works</font><font color="#E5E5E5"> so if you add a</font>

69
00:03:37,350 --> 00:03:44,040
special C parameter to comment line<font color="#E5E5E5"> in</font>

70
00:03:40,440 --> 00:03:48,209
my sample<font color="#E5E5E5"> I</font><font color="#CCCCCC"> asked</font><font color="#E5E5E5"> add command to</font>

71
00:03:44,040 --> 00:03:51,359
schedule a task and show output of<font color="#E5E5E5"> my</font>

72
00:03:48,209 --> 00:03:54,150
<font color="#E5E5E5">commands and redirect output to text</font>

73
00:03:51,360 --> 00:03:58,620
file<font color="#E5E5E5"> and once complete when task is</font>

74
00:03:54,150 --> 00:04:00,900
completed then<font color="#E5E5E5"> arises at</font><font color="#CCCCCC"> seven firelands</font>

75
00:03:58,620 --> 00:04:03,720
I was able<font color="#CCCCCC"> to see that was actually</font>

76
00:04:00,900 --> 00:04:06,239
<font color="#E5E5E5">created by system so it still</font><font color="#CCCCCC"> works but</font>

77
00:04:03,720 --> 00:04:12,120
in Windows 10<font color="#CCCCCC"> this</font><font color="#E5E5E5"> command is duplicated</font>

78
00:04:06,239 --> 00:04:14,280
and you cannot use it next option also

79
00:04:12,120 --> 00:04:15,150
the simplest<font color="#E5E5E5"> one is PC exact amount is a</font>

80
00:04:14,280 --> 00:04:18,660
part of

81
00:04:15,150 --> 00:04:20,850
sysinternals<font color="#CCCCCC"> - so you need to</font><font color="#E5E5E5"> run this</font>

82
00:04:18,660 --> 00:04:23,700
command under demonstrator provide

83
00:04:20,850 --> 00:04:27,620
additional parameters as an<font color="#E5E5E5"> eye and you</font>

84
00:04:23,700 --> 00:04:31,050
will get system console<font color="#E5E5E5"> immediately</font>

85
00:04:27,620 --> 00:04:33,390
next one is interactive service so

86
00:04:31,050 --> 00:04:35,930
normal<font color="#E5E5E5"> service cannot directly interact</font>

87
00:04:33,390 --> 00:04:38,159
with<font color="#E5E5E5"> a user but there is a special type</font>

88
00:04:35,930 --> 00:04:40,380
interactive service which<font color="#E5E5E5"> allows</font><font color="#CCCCCC"> to</font>

89
00:04:38,160 --> 00:04:42,870
launch system console in interactive

90
00:04:40,380 --> 00:04:45,360
mode of course you can elevate

91
00:04:42,870 --> 00:04:47,640
privileges with normal services<font color="#E5E5E5"> but it's</font>

92
00:04:45,360 --> 00:04:49,440
a different<font color="#CCCCCC"> story and</font><font color="#E5E5E5"> my goal was</font><font color="#CCCCCC"> to</font>

93
00:04:47,640 --> 00:04:52,440
launch this in console for current user

94
00:04:49,440 --> 00:04:56,100
<font color="#E5E5E5">so what i'm</font><font color="#CCCCCC"> doing here i'm creating</font><font color="#E5E5E5"> a</font>

95
00:04:52,440 --> 00:05:01,290
service<font color="#CCCCCC"> as and as a binary pass I pass</font>

96
00:04:56,100 --> 00:05:03,780
in<font color="#CCCCCC"> T /</font><font color="#E5E5E5"> key star command</font><font color="#CCCCCC"> and sell the</font>

97
00:05:01,290 --> 00:05:06,090
service style will be interact then I

98
00:05:03,780 --> 00:05:11,159
start<font color="#E5E5E5"> the service and what's happened</font>

99
00:05:06,090 --> 00:05:14,219
here<font color="#E5E5E5"> I found that some link an icon</font>

100
00:05:11,160 --> 00:05:17,130
appears so when I click to<font color="#CCCCCC"> this icon</font><font color="#E5E5E5"> a</font>

101
00:05:14,220 --> 00:05:19,860
strange<font color="#E5E5E5"> message appears as well and</font>

102
00:05:17,130 --> 00:05:23,420
basically<font color="#E5E5E5"> it says we</font><font color="#CCCCCC"> have a surprise for</font>

103
00:05:19,860 --> 00:05:26,550
<font color="#E5E5E5">you so when you click</font><font color="#CCCCCC"> view to</font><font color="#E5E5E5"> message</font>

104
00:05:23,420 --> 00:05:28,410
you will figure out<font color="#E5E5E5"> that</font><font color="#CCCCCC"> actually we</font>

105
00:05:26,550 --> 00:05:32,760
enter<font color="#CCCCCC"> to special interactive services</font>

106
00:05:28,410 --> 00:05:35,940
<font color="#E5E5E5">mode and here you go there is</font><font color="#CCCCCC"> your</font>

107
00:05:32,760 --> 00:05:38,789
system<font color="#E5E5E5"> console waiting</font><font color="#CCCCCC"> for you</font>

108
00:05:35,940 --> 00:05:41,400
it works in Windows<font color="#E5E5E5"> 7</font><font color="#CCCCCC"> just great on</font>

109
00:05:38,790 --> 00:05:43,620
Windows 8 and<font color="#E5E5E5"> higher interactive</font>

110
00:05:41,400 --> 00:05:45,719
services disabled by default so first

111
00:05:43,620 --> 00:05:49,080
you will<font color="#E5E5E5"> need to enable it in registry</font>

112
00:05:45,720 --> 00:05:51,690
and<font color="#CCCCCC"> Scott on interactive services</font><font color="#E5E5E5"> key</font>

113
00:05:49,080 --> 00:05:53,700
and if it<font color="#E5E5E5"> still doesn't work probably</font>

114
00:05:51,690 --> 00:05:55,800
<font color="#E5E5E5">you will need to start</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> service that</font>

115
00:05:53,700 --> 00:06:00,530
<font color="#E5E5E5">actually supports interactive services</font>

116
00:05:55,800 --> 00:06:07,680
<font color="#CCCCCC">in my case it was UI 0 detect service</font>

117
00:06:00,530 --> 00:06:10,890
now let's go back to<font color="#E5E5E5"> user for user we</font>

118
00:06:07,680 --> 00:06:14,370
should use some tricks<font color="#E5E5E5"> and hidden</font>

119
00:06:10,890 --> 00:06:17,490
features so MSI is<font color="#CCCCCC"> Anna style</font><font color="#E5E5E5"> package</font>

120
00:06:14,370 --> 00:06:19,560
file format used<font color="#CCCCCC"> by windows and MSI</font>

121
00:06:17,490 --> 00:06:23,180
packages can be<font color="#E5E5E5"> installed</font><font color="#CCCCCC"> with elevated</font>

122
00:06:19,560 --> 00:06:26,520
<font color="#E5E5E5">privileges for non that means users but</font>

123
00:06:23,180 --> 00:06:30,000
is disabled by default so in<font color="#E5E5E5"> order to</font>

124
00:06:26,520 --> 00:06:32,549
use<font color="#CCCCCC"> it you should have this registry key</font>

125
00:06:30,000 --> 00:06:34,800
always installed elevated<font color="#CCCCCC"> into branches</font>

126
00:06:32,550 --> 00:06:36,770
<font color="#CCCCCC">under</font><font color="#E5E5E5"> current user and</font><font color="#CCCCCC"> under</font><font color="#E5E5E5"> local</font>

127
00:06:34,800 --> 00:06:39,720
machine and<font color="#E5E5E5"> it should be set</font><font color="#CCCCCC"> to 1</font>

128
00:06:36,770 --> 00:06:41,070
<font color="#E5E5E5">luckily some administrators will enable</font>

129
00:06:39,720 --> 00:06:42,420
it<font color="#CCCCCC"> for you because</font>

130
00:06:41,070 --> 00:06:44,580
they would like<font color="#CCCCCC"> to provide</font><font color="#E5E5E5"> the</font>

131
00:06:42,420 --> 00:06:47,700
<font color="#CCCCCC">opportunity to install</font><font color="#E5E5E5"> Microsoft</font>

132
00:06:44,580 --> 00:06:50,640
packages for non admin users with

133
00:06:47,700 --> 00:06:54,150
elevated privileges<font color="#CCCCCC"> so you can check if</font>

134
00:06:50,640 --> 00:06:57,539
it works<font color="#E5E5E5"> then you</font><font color="#CCCCCC"> can ask MSF phenome to</font>

135
00:06:54,150 --> 00:06:59,669
generate<font color="#CCCCCC"> payload as</font><font color="#E5E5E5"> MSI package you</font>

136
00:06:57,540 --> 00:07:05,040
install this package<font color="#E5E5E5"> and you will have</font>

137
00:06:59,670 --> 00:07:08,490
your show<font color="#E5E5E5"> pretty nice next one is</font>

138
00:07:05,040 --> 00:07:11,130
installation and recover files<font color="#E5E5E5"> so</font><font color="#CCCCCC"> are to</font>

139
00:07:08,490 --> 00:07:14,310
automate<font color="#E5E5E5"> Windows setup files there is</font>

140
00:07:11,130 --> 00:07:17,370
<font color="#E5E5E5">sound called an through file so in an</font>

141
00:07:14,310 --> 00:07:19,950
through file you will find<font color="#E5E5E5"> some settings</font>

142
00:07:17,370 --> 00:07:22,080
<font color="#E5E5E5">for automatic</font><font color="#CCCCCC"> Windows setup</font><font color="#E5E5E5"> like</font>

143
00:07:19,950 --> 00:07:24,900
partition disk is<font color="#CCCCCC"> allocation or Windows</font>

144
00:07:22,080 --> 00:07:29,280
image is a product key<font color="#E5E5E5"> and also it can</font>

145
00:07:24,900 --> 00:07:33,289
<font color="#E5E5E5">contains user accounts</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> usually this</font>

146
00:07:29,280 --> 00:07:35,729
<font color="#CCCCCC">has</font><font color="#E5E5E5"> roof file codes and attend dot XML</font>

147
00:07:33,290 --> 00:07:39,330
when it opened when you find this file

148
00:07:35,730 --> 00:07:41,280
and<font color="#E5E5E5"> open it you will find out</font><font color="#CCCCCC"> that user</font>

149
00:07:39,330 --> 00:07:44,099
accounts<font color="#CCCCCC"> information actually</font><font color="#E5E5E5"> stores in</font>

150
00:07:41,280 --> 00:07:48,000
plain<font color="#E5E5E5"> text or</font><font color="#CCCCCC"> base64-encoded which</font>

151
00:07:44,100 --> 00:07:50,490
equals<font color="#CCCCCC"> to plain text so it's good the</font>

152
00:07:48,000 --> 00:07:54,000
last<font color="#E5E5E5"> one is all tricks so you can try to</font>

153
00:07:50,490 --> 00:07:57,810
find unprotected<font color="#CCCCCC"> sound files in repair</font>

154
00:07:54,000 --> 00:08:01,140
folder then<font color="#E5E5E5"> you can copy this file with</font>

155
00:07:57,810 --> 00:08:03,360
system file and try<font color="#E5E5E5"> to recreate ntlm</font>

156
00:08:01,140 --> 00:08:09,599
hashes offline and<font color="#E5E5E5"> you will get your</font>

157
00:08:03,360 --> 00:08:11,250
credentials missing files so some

158
00:08:09,600 --> 00:08:13,440
incorrectly deleted application a

159
00:08:11,250 --> 00:08:16,380
service can still have<font color="#E5E5E5"> auto run entering</font>

160
00:08:13,440 --> 00:08:18,210
the<font color="#CCCCCC"> system so if you find</font><font color="#E5E5E5"> such orphan</font>

161
00:08:16,380 --> 00:08:20,159
<font color="#E5E5E5">records we can create a file with</font>

162
00:08:18,210 --> 00:08:23,340
specific names that will<font color="#E5E5E5"> be launched on</font>

163
00:08:20,160 --> 00:08:26,760
system start<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> a use of Taranis c</font>

164
00:08:23,340 --> 00:08:29,280
command<font color="#E5E5E5"> and if we find any of these</font>

165
00:08:26,760 --> 00:08:32,729
<font color="#E5E5E5">records we</font><font color="#CCCCCC"> can create payload give it</font>

166
00:08:29,280 --> 00:08:34,799
the<font color="#E5E5E5"> name</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the name</font><font color="#CCCCCC"> the file where that</font>

167
00:08:32,729 --> 00:08:37,099
wasn't<font color="#E5E5E5"> found and then put it to the</font>

168
00:08:34,799 --> 00:08:43,348
location<font color="#CCCCCC"> and then restart the system</font><font color="#E5E5E5"> and</font>

169
00:08:37,099 --> 00:08:45,240
probably it will<font color="#E5E5E5"> run under system the</font>

170
00:08:43,349 --> 00:08:46,380
next windows feature<font color="#E5E5E5"> calls and water</font>

171
00:08:45,240 --> 00:08:49,500
services<font color="#E5E5E5"> pass</font>

172
00:08:46,380 --> 00:08:51,210
so when service executable pass is not

173
00:08:49,500 --> 00:08:54,510
in close<font color="#E5E5E5"> with quotation marks</font><font color="#CCCCCC"> and</font>

174
00:08:51,210 --> 00:08:57,870
contain space we have very<font color="#CCCCCC"> interesting</font>

175
00:08:54,510 --> 00:09:00,689
behavior<font color="#CCCCCC"> in my sample I have a special</font>

176
00:08:57,870 --> 00:09:03,029
service my service and I register it we

177
00:09:00,690 --> 00:09:05,639
without quotation<font color="#E5E5E5"> mark and it contains</font>

178
00:09:03,029 --> 00:09:08,699
spaces so<font color="#E5E5E5"> Windows will search for</font>

179
00:09:05,639 --> 00:09:10,680
service file in the following<font color="#CCCCCC"> so first</font>

180
00:09:08,699 --> 00:09:12,959
it will search for program dot exe file

181
00:09:10,680 --> 00:09:15,359
on C<font color="#E5E5E5"> Drive then for program detects if</font>

182
00:09:12,959 --> 00:09:19,109
<font color="#CCCCCC">I'll under Program Files folder and etc</font>

183
00:09:15,360 --> 00:09:22,260
<font color="#E5E5E5">and on the last one it will check</font><font color="#CCCCCC"> for my</font>

184
00:09:19,110 --> 00:09:24,660
service for<font color="#E5E5E5"> actual file so if we have</font>

185
00:09:22,260 --> 00:09:26,639
proper<font color="#CCCCCC"> permission we</font><font color="#E5E5E5"> actually can create</font>

186
00:09:24,660 --> 00:09:30,240
programs<font color="#E5E5E5"> that exist I'll and put it</font>

187
00:09:26,639 --> 00:09:32,790
under<font color="#E5E5E5"> C Drive for example and next time</font>

188
00:09:30,240 --> 00:09:35,850
service will start program<font color="#E5E5E5"> don't exist</font>

189
00:09:32,790 --> 00:09:38,610
<font color="#E5E5E5">I'll instead of my service dot xzen so</font>

190
00:09:35,850 --> 00:09:41,760
the only<font color="#CCCCCC"> problem here is that usually we</font>

191
00:09:38,610 --> 00:09:45,750
don't<font color="#E5E5E5"> have access to</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> Drive</font><font color="#CCCCCC"> risk</font>

192
00:09:41,760 --> 00:09:47,730
utility that can check access<font color="#E5E5E5"> for you</font>

193
00:09:45,750 --> 00:09:51,620
it's called control access<font color="#E5E5E5"> control list</font>

194
00:09:47,730 --> 00:09:56,040
or integrity control access<font color="#E5E5E5"> control list</font>

195
00:09:51,620 --> 00:09:57,930
<font color="#E5E5E5">so I run around these commands and I</font>

196
00:09:56,040 --> 00:10:01,829
confirm that only administrators has

197
00:09:57,930 --> 00:10:04,519
full access to C<font color="#E5E5E5"> Drive</font><font color="#CCCCCC"> and as a user I</font>

198
00:10:01,829 --> 00:10:07,199
<font color="#CCCCCC">have on the original access to C Drive</font>

199
00:10:04,519 --> 00:10:12,240
similarly I can<font color="#E5E5E5"> check all</font><font color="#CCCCCC"> as allocations</font>

200
00:10:07,199 --> 00:10:15,389
<font color="#CCCCCC">okay next utility is access</font><font color="#E5E5E5"> checks so</font>

201
00:10:12,240 --> 00:10:17,930
with<font color="#E5E5E5"> this utility we can ask to display</font>

202
00:10:15,389 --> 00:10:21,209
all services<font color="#CCCCCC"> as specific user can modify</font>

203
00:10:17,930 --> 00:10:23,370
in my sample<font color="#CCCCCC"> I asked</font><font color="#E5E5E5"> to display all</font>

204
00:10:21,209 --> 00:10:26,399
services<font color="#CCCCCC"> at administrator can modify it</font>

205
00:10:23,370 --> 00:10:29,490
<font color="#CCCCCC">to demonstrate output</font><font color="#E5E5E5"> so we're looking</font>

206
00:10:26,399 --> 00:10:32,000
here for<font color="#E5E5E5"> services all access and if you</font>

207
00:10:29,490 --> 00:10:35,310
found services all access service for

208
00:10:32,000 --> 00:10:38,220
restricted<font color="#CCCCCC"> user name it means we can</font>

209
00:10:35,310 --> 00:10:40,829
modify the service<font color="#E5E5E5"> we can get property</font>

210
00:10:38,220 --> 00:10:43,620
<font color="#CCCCCC">of the service with CQC</font><font color="#E5E5E5"> command and</font>

211
00:10:40,829 --> 00:10:46,888
we're looking for<font color="#CCCCCC"> star type and binary</font>

212
00:10:43,620 --> 00:10:48,810
<font color="#CCCCCC">pass name because we can modify the</font>

213
00:10:46,889 --> 00:10:51,360
service we can update the binary<font color="#E5E5E5"> of path</font>

214
00:10:48,810 --> 00:10:54,449
name and we can configure<font color="#E5E5E5"> service to</font>

215
00:10:51,360 --> 00:10:57,510
<font color="#E5E5E5">actually do some evil stuff here it can</font>

216
00:10:54,449 --> 00:11:02,130
be<font color="#E5E5E5"> payloads or simply commands restart</font>

217
00:10:57,510 --> 00:11:03,930
the service<font color="#E5E5E5"> and your results last</font>

218
00:11:02,130 --> 00:11:07,470
utility to check permissions is

219
00:11:03,930 --> 00:11:09,449
<font color="#CCCCCC">supernatural</font><font color="#E5E5E5"> so basically it can check</font>

220
00:11:07,470 --> 00:11:12,600
security<font color="#CCCCCC"> information about files</font>

221
00:11:09,449 --> 00:11:15,139
registry keys and services<font color="#CCCCCC"> in my case</font>

222
00:11:12,600 --> 00:11:17,730
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> checking Sura</font><font color="#E5E5E5"> and chicken registry</font>

223
00:11:15,139 --> 00:11:21,059
let's imagine<font color="#CCCCCC"> situations that for some</font>

224
00:11:17,730 --> 00:11:26,160
reason<font color="#E5E5E5"> normal user can</font><font color="#CCCCCC"> modify register</font>

225
00:11:21,059 --> 00:11:29,189
entry for service<font color="#E5E5E5"> in my scenario</font><font color="#CCCCCC"> users</font>

226
00:11:26,160 --> 00:11:31,019
has only read access<font color="#E5E5E5"> permission to</font><font color="#CCCCCC"> this</font>

227
00:11:29,189 --> 00:11:35,099
service and<font color="#CCCCCC"> that</font><font color="#E5E5E5"> means</font><font color="#CCCCCC"> urgent health</font>

228
00:11:31,019 --> 00:11:40,139
<font color="#E5E5E5">whose full access but if the user could</font>

229
00:11:35,100 --> 00:11:43,259
modify the service he will update<font color="#E5E5E5"> image</font>

230
00:11:40,139 --> 00:11:45,749
<font color="#CCCCCC">base in registry and set</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> to some</font>

231
00:11:43,259 --> 00:11:48,899
malicious payload<font color="#E5E5E5"> so</font><font color="#CCCCCC"> next</font><font color="#E5E5E5"> time after</font>

232
00:11:45,749 --> 00:11:55,730
<font color="#E5E5E5">restart instead of normal service will</font>

233
00:11:48,899 --> 00:12:00,149
<font color="#CCCCCC">run payload the last one is exploits</font>

234
00:11:55,730 --> 00:12:03,029
<font color="#CCCCCC">well basically</font><font color="#E5E5E5"> software will never be</font>

235
00:12:00,149 --> 00:12:06,109
free<font color="#CCCCCC"> of bugs</font><font color="#E5E5E5"> so penetration tester just</font>

236
00:12:03,029 --> 00:12:09,029
changes<font color="#E5E5E5"> here's Arsenal from time to time</font>

237
00:12:06,109 --> 00:12:11,489
we will need to<font color="#E5E5E5"> know operation system</font>

238
00:12:09,029 --> 00:12:13,339
version and<font color="#E5E5E5"> insult updates in order to</font>

239
00:12:11,489 --> 00:12:16,499
search<font color="#CCCCCC"> for</font><font color="#E5E5E5"> available vulnerabilities</font>

240
00:12:13,339 --> 00:12:19,110
then we need to compile exploits copy to

241
00:12:16,499 --> 00:12:22,439
<font color="#E5E5E5">vulnerable system run it and get your</font>

242
00:12:19,110 --> 00:12:25,309
system so in order<font color="#E5E5E5"> to get this</font>

243
00:12:22,439 --> 00:12:27,660
<font color="#E5E5E5">information we</font><font color="#CCCCCC"> can use system info</font>

244
00:12:25,309 --> 00:12:30,059
command<font color="#E5E5E5"> line so it will provide</font>

245
00:12:27,660 --> 00:12:32,819
<font color="#CCCCCC">information about</font><font color="#E5E5E5"> operation system and</font>

246
00:12:30,059 --> 00:12:36,149
insult hotfix<font color="#CCCCCC"> or we can send a query</font>

247
00:12:32,819 --> 00:12:38,759
<font color="#CCCCCC">using WMI so it's kind of the same but</font>

248
00:12:36,149 --> 00:12:40,980
<font color="#CCCCCC">the problem</font><font color="#E5E5E5"> here it's not a trivial</font><font color="#CCCCCC"> task</font>

249
00:12:38,759 --> 00:12:44,220
to identify what what<font color="#CCCCCC"> fixes and mission</font>

250
00:12:40,980 --> 00:12:46,709
<font color="#E5E5E5">and what exploits were going to use in</font>

251
00:12:44,220 --> 00:12:50,160
this case<font color="#E5E5E5"> luckily we have a special</font>

252
00:12:46,709 --> 00:12:53,309
tools<font color="#CCCCCC"> for it</font><font color="#E5E5E5"> so it's so cold exploits</font>

253
00:12:50,160 --> 00:12:56,189
the gestures in my case I'm<font color="#CCCCCC"> using</font>

254
00:12:53,309 --> 00:12:57,779
Windows Explorer suggesters<font color="#E5E5E5"> where and it</font>

255
00:12:56,189 --> 00:13:01,199
can be downloaded<font color="#CCCCCC"> by the phone and</font>

256
00:12:57,779 --> 00:13:03,869
<font color="#CCCCCC">github link</font><font color="#E5E5E5"> so how it</font><font color="#CCCCCC"> works first it</font>

257
00:13:01,199 --> 00:13:06,779
fetches information from Microsoft

258
00:13:03,869 --> 00:13:10,169
<font color="#CCCCCC">websites and create database of all</font>

259
00:13:06,779 --> 00:13:12,959
known vulnerabilities<font color="#E5E5E5"> then we need to</font>

260
00:13:10,169 --> 00:13:15,779
provide<font color="#E5E5E5"> output from system info commands</font>

261
00:13:12,959 --> 00:13:19,138
<font color="#E5E5E5">and we will use it as an input</font><font color="#CCCCCC"> for this</font>

262
00:13:15,779 --> 00:13:21,379
utility this<font color="#CCCCCC"> xanthus utility will</font>

263
00:13:19,139 --> 00:13:27,119
actually compare and salvage what<font color="#E5E5E5"> fixes</font>

264
00:13:21,379 --> 00:13:29,489
against available<font color="#CCCCCC"> owner abilities and it</font>

265
00:13:27,119 --> 00:13:33,839
will suggest<font color="#E5E5E5"> what you can try to use</font>

266
00:13:29,489 --> 00:13:36,059
<font color="#E5E5E5">here so</font><font color="#CCCCCC"> am will means that Metasploit</font>

267
00:13:33,839 --> 00:13:38,819
module is available<font color="#E5E5E5"> for this model</font><font color="#CCCCCC"> for</font>

268
00:13:36,059 --> 00:13:42,059
<font color="#E5E5E5">this vulnerability and he means that</font>

269
00:13:38,819 --> 00:13:45,809
<font color="#E5E5E5">public exploit is available but there is</font>

270
00:13:42,059 --> 00:13:47,999
a catch this<font color="#E5E5E5"> utility can provide a lot</font>

271
00:13:45,809 --> 00:13:50,279
<font color="#CCCCCC">of false positives because it will</font>

272
00:13:47,999 --> 00:13:53,189
assume that<font color="#E5E5E5"> all</font><font color="#CCCCCC"> services and duplication</font>

273
00:13:50,279 --> 00:13:56,040
are installed<font color="#CCCCCC"> so if you don't have I</font>

274
00:13:53,189 --> 00:14:02,819
<font color="#CCCCCC">asked</font><font color="#E5E5E5"> or it won't run you still will</font>

275
00:13:56,040 --> 00:14:05,488
have some entries now<font color="#CCCCCC"> let's go to Linux</font>

276
00:14:02,819 --> 00:14:08,040
so<font color="#CCCCCC"> Linux exploits this kind is the same</font>

277
00:14:05,489 --> 00:14:10,529
first you need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> find exploit then you</font>

278
00:14:08,040 --> 00:14:15,660
need to copy exploits compile<font color="#E5E5E5"> run</font>

279
00:14:10,529 --> 00:14:20,879
sounds<font color="#E5E5E5"> easy but actually it's not</font><font color="#CCCCCC"> so the</font>

280
00:14:15,660 --> 00:14:24,420
reason there<font color="#E5E5E5"> are too many available</font>

281
00:14:20,879 --> 00:14:26,669
<font color="#E5E5E5">Linux versions so and exploits a not</font>

282
00:14:24,420 --> 00:14:29,099
<font color="#CCCCCC">universal</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> one that runs</font><font color="#E5E5E5"> on one</font>

283
00:14:26,669 --> 00:14:31,619
<font color="#E5E5E5">operation system can fail on different</font>

284
00:14:29,100 --> 00:14:33,689
<font color="#E5E5E5">operation system so basically</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> will</font>

285
00:14:31,619 --> 00:14:35,869
need to know details about<font color="#E5E5E5"> installed</font>

286
00:14:33,689 --> 00:14:39,059
operation system and kernel version

287
00:14:35,869 --> 00:14:41,579
<font color="#E5E5E5">after you find exploits kernel exploit</font>

288
00:14:39,059 --> 00:14:44,040
source code<font color="#E5E5E5"> you will need to compile it</font>

289
00:14:41,579 --> 00:14:47,459
on target machine but before that you

290
00:14:44,040 --> 00:14:51,209
<font color="#E5E5E5">need to copy it somehow</font><font color="#CCCCCC"> of course you</font>

291
00:14:47,459 --> 00:14:53,878
can try to compile it on<font color="#E5E5E5"> own virtual</font>

292
00:14:51,209 --> 00:14:56,549
machine or find<font color="#E5E5E5"> recompile to version but</font>

293
00:14:53,879 --> 00:14:59,040
please do<font color="#E5E5E5"> not run precompiled exploits</font>

294
00:14:56,549 --> 00:15:04,529
because you you don't know what<font color="#CCCCCC"> will</font>

295
00:14:59,040 --> 00:15:06,329
<font color="#CCCCCC">happen to get required information you</font>

296
00:15:04,529 --> 00:15:08,249
can<font color="#CCCCCC"> use the</font><font color="#E5E5E5"> following commands so for</font>

297
00:15:06,329 --> 00:15:11,279
distribution<font color="#E5E5E5"> type and version is you</font>

298
00:15:08,249 --> 00:15:14,699
named our<font color="#CCCCCC"> adjust rich information</font><font color="#E5E5E5"> from</font>

299
00:15:11,279 --> 00:15:17,100
the<font color="#E5E5E5"> following files to get information</font>

300
00:15:14,699 --> 00:15:19,529
about development tools languages and

301
00:15:17,100 --> 00:15:23,189
how we can<font color="#E5E5E5"> upload the files basically we</font>

302
00:15:19,529 --> 00:15:25,549
<font color="#CCCCCC">just search for</font><font color="#E5E5E5"> Perl Python GCC CC and</font>

303
00:15:23,189 --> 00:15:30,480
other utilities that<font color="#E5E5E5"> we can use</font><font color="#CCCCCC"> to copy</font>

304
00:15:25,549 --> 00:15:34,169
<font color="#CCCCCC">exploited binaries to target version</font><font color="#E5E5E5"> ok</font>

305
00:15:30,480 --> 00:15:35,190
now<font color="#CCCCCC"> times for tricks world</font><font color="#E5E5E5"> cards so</font><font color="#CCCCCC"> wild</font>

306
00:15:34,169 --> 00:15:37,800
<font color="#CCCCCC">cards is a special</font>

307
00:15:35,190 --> 00:15:42,450
character that<font color="#E5E5E5"> increases the flexibility</font>

308
00:15:37,800 --> 00:15:46,290
and<font color="#CCCCCC"> efficiency</font><font color="#E5E5E5"> of searches it recommends</font>

309
00:15:42,450 --> 00:15:48,750
<font color="#CCCCCC">that</font><font color="#E5E5E5"> self-explanatory</font><font color="#CCCCCC"> so to list all</font>

310
00:15:46,290 --> 00:15:52,110
files with XYZ extension just<font color="#E5E5E5"> search for</font>

311
00:15:48,750 --> 00:15:54,720
<font color="#CCCCCC">athletes</font><font color="#E5E5E5"> dodge XYZ to remove all files</font>

312
00:15:52,110 --> 00:15:58,410
with this extension<font color="#E5E5E5"> use Asterix again</font>

313
00:15:54,720 --> 00:16:00,360
<font color="#CCCCCC">XYZ or if you want</font><font color="#E5E5E5"> to show content of</font>

314
00:15:58,410 --> 00:16:03,630
all<font color="#E5E5E5"> files the stars from</font><font color="#CCCCCC"> graphics name</font>

315
00:16:00,360 --> 00:16:06,630
it will<font color="#E5E5E5"> be care to prefix</font><font color="#CCCCCC"> asterisks so</font>

316
00:16:03,630 --> 00:16:09,300
in my system I created another<font color="#E5E5E5"> user</font>

317
00:16:06,630 --> 00:16:12,710
I called him routine it's a normal user

318
00:16:09,300 --> 00:16:17,339
and one day he would like to<font color="#CCCCCC"> become</font><font color="#E5E5E5"> root</font>

319
00:16:12,710 --> 00:16:20,070
so<font color="#CCCCCC"> rooty created two directories</font><font color="#E5E5E5"> called</font>

320
00:16:17,340 --> 00:16:26,900
<font color="#E5E5E5">dr1 and dr2 and three files but one</font>

321
00:16:20,070 --> 00:16:29,790
about su and minus RF and it's a trap

322
00:16:26,900 --> 00:16:31,680
<font color="#CCCCCC">routine knows that root user will</font>

323
00:16:29,790 --> 00:16:32,449
actually<font color="#CCCCCC"> do some routine stuff in</font><font color="#E5E5E5"> this</font>

324
00:16:31,680 --> 00:16:35,010
folder

325
00:16:32,450 --> 00:16:39,030
<font color="#E5E5E5">basically root will try to remove all</font>

326
00:16:35,010 --> 00:16:42,210
files but not directories so when the

327
00:16:39,030 --> 00:16:44,850
<font color="#E5E5E5">root run this command</font><font color="#CCCCCC"> I Ram space Astrix</font>

328
00:16:42,210 --> 00:16:48,120
<font color="#E5E5E5">every single gun accepts the strange</font>

329
00:16:44,850 --> 00:16:51,300
<font color="#CCCCCC">minus RF file</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> what happened here</font>

330
00:16:48,120 --> 00:16:54,390
<font color="#E5E5E5">because we use a wild-card</font><font color="#CCCCCC"> equivalent</font>

331
00:16:51,300 --> 00:16:58,290
commands will<font color="#CCCCCC"> be around your</font><font color="#E5E5E5"> one or two</font>

332
00:16:54,390 --> 00:17:00,210
for one<font color="#E5E5E5"> file to and minus RF so her F</font>

333
00:16:58,290 --> 00:17:03,000
<font color="#E5E5E5">file name will actually will</font><font color="#CCCCCC"> be</font>

334
00:17:00,210 --> 00:17:06,720
arguments<font color="#E5E5E5"> for RM command and it will</font>

335
00:17:03,000 --> 00:17:12,720
remove every single<font color="#CCCCCC"> person</font><font color="#E5E5E5"> except minus</font>

336
00:17:06,720 --> 00:17:14,430
RF file which is argument we can<font color="#E5E5E5"> do the</font>

337
00:17:12,720 --> 00:17:17,579
same trick with as a commands<font color="#E5E5E5"> for</font>

338
00:17:14,430 --> 00:17:19,410
example char and shown so<font color="#E5E5E5"> pepper have</font>

339
00:17:17,579 --> 00:17:22,349
allows to set actions after<font color="#E5E5E5"> reaching</font>

340
00:17:19,410 --> 00:17:25,230
checkpoint<font color="#E5E5E5"> and if we create checkpoint</font>

341
00:17:22,349 --> 00:17:29,760
<font color="#E5E5E5">action commands which will execute our</font>

342
00:17:25,230 --> 00:17:32,610
custom shell script<font color="#E5E5E5"> then instead of our</font>

343
00:17:29,760 --> 00:17:35,430
<font color="#CCCCCC">having</font><font color="#E5E5E5"> home folder it will</font><font color="#CCCCCC"> actually</font>

344
00:17:32,610 --> 00:17:38,939
execute custom script and it's very

345
00:17:35,430 --> 00:17:43,670
<font color="#E5E5E5">dangerous because you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> find some some</font>

346
00:17:38,940 --> 00:17:47,460
<font color="#E5E5E5">schedules in</font><font color="#CCCCCC"> cron and as a several is</font>

347
00:17:43,670 --> 00:17:48,960
change file<font color="#E5E5E5"> owner commands</font><font color="#CCCCCC"> so normally</font>

348
00:17:47,460 --> 00:17:53,460
this command will

349
00:17:48,960 --> 00:17:56,220
all PHP files<font color="#CCCCCC"> Sunao with the owner</font><font color="#E5E5E5"> but</font>

350
00:17:53,460 --> 00:17:58,860
it's also contained a reference<font color="#E5E5E5"> argument</font>

351
00:17:56,220 --> 00:18:01,530
and if Ruchi creates a<font color="#E5E5E5"> special file</font>

352
00:17:58,860 --> 00:18:05,669
<font color="#CCCCCC">calls</font><font color="#E5E5E5"> - man's reference equals to root</font>

353
00:18:01,530 --> 00:18:09,270
<font color="#CCCCCC">file dot PHP</font><font color="#E5E5E5"> then actually he becomes</font>

354
00:18:05,670 --> 00:18:11,730
the owner of all PHP files because we

355
00:18:09,270 --> 00:18:13,650
will use reference file<font color="#E5E5E5"> owners and group</font>

356
00:18:11,730 --> 00:18:17,090
rather than<font color="#E5E5E5"> specifying</font><font color="#CCCCCC"> owners of</font><font color="#E5E5E5"> group</font>

357
00:18:13,650 --> 00:18:20,910
<font color="#CCCCCC">values and there is a lot of</font><font color="#E5E5E5"> tricks you</font>

358
00:18:17,090 --> 00:18:21,600
<font color="#CCCCCC">can</font><font color="#E5E5E5"> find full article by the following</font>

359
00:18:20,910 --> 00:18:28,470
<font color="#CCCCCC">address</font>

360
00:18:21,600 --> 00:18:31,919
I recommend next<font color="#E5E5E5"> interest in item as su</font>

361
00:18:28,470 --> 00:18:34,910
<font color="#E5E5E5">ID and as JD Beach</font><font color="#CCCCCC"> so basically it's a</font>

362
00:18:31,920 --> 00:18:37,920
special visit<font color="#E5E5E5"> you can set for</font>

363
00:18:34,910 --> 00:18:40,290
executables<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> experience will</font><font color="#E5E5E5"> be</font>

364
00:18:37,920 --> 00:18:43,200
launched<font color="#CCCCCC"> with the</font><font color="#E5E5E5"> rights of the owner</font><font color="#CCCCCC"> or</font>

365
00:18:40,290 --> 00:18:46,889
<font color="#E5E5E5">the group so you can use the following</font>

366
00:18:43,200 --> 00:18:51,660
commands<font color="#E5E5E5"> find and try to search</font><font color="#CCCCCC"> for all</font>

367
00:18:46,890 --> 00:18:54,000
these<font color="#E5E5E5"> files with</font><font color="#CCCCCC"> suid bit and with as</font>

368
00:18:51,660 --> 00:18:56,550
<font color="#CCCCCC">JIT bit</font><font color="#E5E5E5"> once you find this because you</font>

369
00:18:54,000 --> 00:18:59,490
<font color="#E5E5E5">have two</font><font color="#CCCCCC"> options here</font><font color="#E5E5E5"> so you can try to</font>

370
00:18:56,550 --> 00:19:01,409
<font color="#E5E5E5">crash application and take control it</font>

371
00:18:59,490 --> 00:19:04,200
will be public exploits or other

372
00:19:01,410 --> 00:19:09,510
parameters<font color="#CCCCCC"> or you can do a comment</font>

373
00:19:04,200 --> 00:19:12,570
injection to<font color="#E5E5E5"> demonstrate this feature</font>

374
00:19:09,510 --> 00:19:16,550
I prefer comment injection<font color="#E5E5E5"> so as a</font><font color="#CCCCCC"> root</font>

375
00:19:12,570 --> 00:19:23,100
<font color="#CCCCCC">I added</font><font color="#E5E5E5"> as be to find</font><font color="#CCCCCC"> commands so anyone</font>

376
00:19:16,550 --> 00:19:24,960
will can<font color="#CCCCCC"> find any file and if you use</font>

377
00:19:23,100 --> 00:19:27,500
the properties of the<font color="#CCCCCC"> find command you</font>

378
00:19:24,960 --> 00:19:31,380
<font color="#E5E5E5">will see extra as</font><font color="#CCCCCC"> beats</font><font color="#E5E5E5"> it's yellow bit</font>

379
00:19:27,500 --> 00:19:34,350
so routine<font color="#CCCCCC"> I</font><font color="#E5E5E5"> figure out</font><font color="#CCCCCC"> that fan command</font>

380
00:19:31,380 --> 00:19:38,130
has sued<font color="#CCCCCC"> bid</font><font color="#E5E5E5"> and he knows that he can</font>

381
00:19:34,350 --> 00:19:42,419
pass extra comment to<font color="#E5E5E5"> this command in my</font>

382
00:19:38,130 --> 00:19:46,260
case he would like to<font color="#E5E5E5"> prompt for</font>

383
00:19:42,420 --> 00:19:49,860
interactive shell<font color="#CCCCCC"> so once</font><font color="#E5E5E5"> he</font><font color="#CCCCCC"> executes</font>

384
00:19:46,260 --> 00:19:53,940
<font color="#CCCCCC">fan command he will also</font><font color="#E5E5E5"> get root shell</font>

385
00:19:49,860 --> 00:19:56,969
and<font color="#E5E5E5"> worm a basically to demonstrate that</font>

386
00:19:53,940 --> 00:20:02,010
<font color="#CCCCCC">its root but root is a good guy so he</font>

387
00:19:56,970 --> 00:20:02,520
removes his<font color="#E5E5E5"> bit the last item is fun</font>

388
00:20:02,010 --> 00:20:06,059
with

389
00:20:02,520 --> 00:20:08,760
so normally<font color="#CCCCCC"> past dozen contains dot</font>

390
00:20:06,059 --> 00:20:12,559
which indicates<font color="#E5E5E5"> current directory but</font>

391
00:20:08,760 --> 00:20:15,990
let's imagine<font color="#E5E5E5"> we have</font><font color="#CCCCCC"> sysadmin</font><font color="#E5E5E5"> who don't</font>

392
00:20:12,559 --> 00:20:18,420
who doesn't like<font color="#CCCCCC"> to see exception</font>

393
00:20:15,990 --> 00:20:21,240
comment<font color="#E5E5E5"> not found when he executes job</font>

394
00:20:18,420 --> 00:20:25,710
dot P I command<font color="#E5E5E5"> so</font><font color="#CCCCCC"> everytime</font><font color="#E5E5E5"> normally</font>

395
00:20:21,240 --> 00:20:28,140
you need to<font color="#CCCCCC"> specify</font><font color="#E5E5E5"> that these scripts</font>

396
00:20:25,710 --> 00:20:31,470
belongs to current directory using<font color="#E5E5E5"> dot</font>

397
00:20:28,140 --> 00:20:35,340
slash job dot P I and only<font color="#E5E5E5"> after</font><font color="#CCCCCC"> that it</font>

398
00:20:31,470 --> 00:20:37,380
will work<font color="#E5E5E5"> let's imagine this laser</font>

399
00:20:35,340 --> 00:20:41,129
demonstrator decided to add current

400
00:20:37,380 --> 00:20:44,520
<font color="#E5E5E5">directory to pass so we can see that dot</font>

401
00:20:41,130 --> 00:20:48,630
is added and now administrator can

402
00:20:44,520 --> 00:20:53,520
actually run job script<font color="#E5E5E5"> without dot</font>

403
00:20:48,630 --> 00:20:56,190
slash<font color="#E5E5E5"> so it's good</font><font color="#CCCCCC"> life for</font><font color="#E5E5E5"> him but what</font>

404
00:20:53,520 --> 00:20:58,830
can do<font color="#E5E5E5"> routine and</font><font color="#CCCCCC"> Ruchi can actually</font>

405
00:20:56,190 --> 00:21:04,250
create own<font color="#CCCCCC"> tellus</font><font color="#E5E5E5"> commands or any other</font>

406
00:20:58,830 --> 00:21:10,620
system<font color="#CCCCCC"> commands in</font><font color="#E5E5E5"> my case he created</font>

407
00:21:04,250 --> 00:21:13,040
supplication and it will create it will

408
00:21:10,620 --> 00:21:16,320
<font color="#CCCCCC">output as a result of Who I am</font><font color="#E5E5E5"> command</font>

409
00:21:13,040 --> 00:21:19,350
<font color="#E5E5E5">when you type</font><font color="#CCCCCC"> LS then Ruta composes</font>

410
00:21:16,320 --> 00:21:21,960
command<font color="#E5E5E5"> and he's waiting for route</font>

411
00:21:19,350 --> 00:21:26,129
because his Linux<font color="#E5E5E5"> many administrators</font>

412
00:21:21,960 --> 00:21:29,190
<font color="#E5E5E5">users shall and there is a big chance</font>

413
00:21:26,130 --> 00:21:32,580
that LS command will be<font color="#E5E5E5"> used</font><font color="#CCCCCC"> by route</font><font color="#E5E5E5"> so</font>

414
00:21:29,190 --> 00:21:34,950
instead<font color="#CCCCCC"> of viewing</font><font color="#E5E5E5"> the list of files he</font>

415
00:21:32,580 --> 00:21:38,090
will see output from<font color="#CCCCCC"> Who I am command</font>

416
00:21:34,950 --> 00:21:38,090
and<font color="#E5E5E5"> its route</font>

417
00:21:38,809 --> 00:21:49,440
so don't use this feature as a windows

418
00:21:47,010 --> 00:21:52,620
are there<font color="#E5E5E5"> is a lot of automated tools</font>

419
00:21:49,440 --> 00:21:55,830
for privilege escalation or<font color="#CCCCCC"> exploit</font>

420
00:21:52,620 --> 00:21:57,899
checker so I recommend<font color="#E5E5E5"> to review some</font><font color="#CCCCCC"> of</font>

421
00:21:55,830 --> 00:22:00,379
them and check for source<font color="#E5E5E5"> code and you</font>

422
00:21:57,900 --> 00:22:05,010
<font color="#CCCCCC">will find interesting</font><font color="#E5E5E5"> tricks in</font><font color="#CCCCCC"> it and</font>

423
00:22:00,380 --> 00:22:08,309
as a<font color="#E5E5E5"> baseline</font><font color="#CCCCCC"> you can use a guide</font><font color="#E5E5E5"> from</font>

424
00:22:05,010 --> 00:22:10,679
<font color="#CCCCCC">God milk is the last link</font><font color="#E5E5E5"> it contains</font>

425
00:22:08,309 --> 00:22:14,030
<font color="#E5E5E5">all commands that you can</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> for</font>

426
00:22:10,679 --> 00:22:14,030
privilege escalation Linux

427
00:22:14,760 --> 00:22:18,080
and<font color="#E5E5E5"> basically as I said</font>

428
00:22:28,320 --> 00:22:31,408
thank you

429
00:22:34,090 --> 00:22:36,220
[Applause]

