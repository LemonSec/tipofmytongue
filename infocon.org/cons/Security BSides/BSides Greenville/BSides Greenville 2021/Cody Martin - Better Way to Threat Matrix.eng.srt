1
00:00:04,960 --> 00:00:07,200
hello folks uh thanks for coming

2
00:00:07,200 --> 00:00:09,200
uh my name is cody martin i'm a red team

3
00:00:09,200 --> 00:00:11,519
operator with black lantern security

4
00:00:11,519 --> 00:00:12,960
uh today i'm gonna talk about threat

5
00:00:12,960 --> 00:00:15,280
matrices which are products of risk

6
00:00:15,280 --> 00:00:17,359
assessments um thermal agencies

7
00:00:17,359 --> 00:00:19,359
calculate risk associated with different

8
00:00:19,359 --> 00:00:21,600
attack narratives that are kind of

9
00:00:21,600 --> 00:00:23,039
developed and

10
00:00:23,039 --> 00:00:24,880
maintained and burst out of doing those

11
00:00:24,880 --> 00:00:27,680
risk assessments

12
00:00:28,160 --> 00:00:29,679
um so what's the problem with these

13
00:00:29,679 --> 00:00:31,679
threat matrices um

14
00:00:31,679 --> 00:00:34,000
well while they're very important uh for

15
00:00:34,000 --> 00:00:35,840
conducting accurate modern assessments

16
00:00:35,840 --> 00:00:39,040
of risk uh their creation can be

17
00:00:39,040 --> 00:00:41,600
tedious complicated and often prone to

18
00:00:41,600 --> 00:00:45,440
bias which overall just results in poor

19
00:00:45,440 --> 00:00:47,440
risk assessment

20
00:00:47,440 --> 00:00:49,280
well we hope to be solving these issues

21
00:00:49,280 --> 00:00:53,280
with our new tool enter the matrix

22
00:00:54,879 --> 00:00:56,079
okay so when i'm talking about risk

23
00:00:56,079 --> 00:00:58,559
assessments i'm referring to a nist

24
00:00:58,559 --> 00:01:00,160
special publication

25
00:01:00,160 --> 00:01:03,199
the guide to conducting risk assessments

26
00:01:03,199 --> 00:01:05,119
these assessments are meant to be

27
00:01:05,119 --> 00:01:08,000
executed regularly as major

28
00:01:08,000 --> 00:01:10,400
elements of organizational

29
00:01:10,400 --> 00:01:12,720
risk management processes

30
00:01:12,720 --> 00:01:14,159
one of the main products of these risk

31
00:01:14,159 --> 00:01:18,080
assessments are threat matrices

32
00:01:20,159 --> 00:01:22,720
okay and these risk assessments should

33
00:01:22,720 --> 00:01:24,560
typically be concerned with

34
00:01:24,560 --> 00:01:26,320
what are likely threats how those

35
00:01:26,320 --> 00:01:28,240
threats manifest themselves

36
00:01:28,240 --> 00:01:29,439
what are

37
00:01:29,439 --> 00:01:30,560
what's being attacked in these

38
00:01:30,560 --> 00:01:32,560
situations are those things vulnerable

39
00:01:32,560 --> 00:01:35,119
and are there any potential impacts from

40
00:01:35,119 --> 00:01:36,880
those things being attacked

41
00:01:36,880 --> 00:01:38,880
uh threat matrices organize these

42
00:01:38,880 --> 00:01:41,200
concerns into narratives which

43
00:01:41,200 --> 00:01:42,799
quantify the risk that an organization

44
00:01:42,799 --> 00:01:44,399
can utilize to

45
00:01:44,399 --> 00:01:45,920
better direct their

46
00:01:45,920 --> 00:01:49,840
often limited resources with

47
00:01:50,159 --> 00:01:52,720
okay so if you've not seen one

48
00:01:52,720 --> 00:01:54,399
this is a threat matrix

49
00:01:54,399 --> 00:01:57,280
um we're covering you know the what is

50
00:01:57,280 --> 00:01:59,439
being attacked in the threat scenario

51
00:01:59,439 --> 00:02:01,840
and uh events column

52
00:02:01,840 --> 00:02:03,520
um what

53
00:02:03,520 --> 00:02:04,399
is

54
00:02:04,399 --> 00:02:05,439
um

55
00:02:05,439 --> 00:02:07,520
what's it vulnerable to and and how is

56
00:02:07,520 --> 00:02:10,160
it defended and the vulnerabilities

57
00:02:10,160 --> 00:02:12,959
predisposing conditions and mitigations

58
00:02:12,959 --> 00:02:14,000
columns

59
00:02:14,000 --> 00:02:16,560
uh also what the impact is felt uh from

60
00:02:16,560 --> 00:02:19,520
that event happening is in the uh impact

61
00:02:19,520 --> 00:02:22,640
column there at the end

62
00:02:22,640 --> 00:02:25,280
okay so why are these things difficult

63
00:02:25,280 --> 00:02:27,440
why do they tend to be difficult um for

64
00:02:27,440 --> 00:02:29,599
one it's hard to maintain consistency

65
00:02:29,599 --> 00:02:33,280
between and even within organizations

66
00:02:33,280 --> 00:02:35,519
also calculating certain values within

67
00:02:35,519 --> 00:02:36,959
the threat matrix can be kind of

68
00:02:36,959 --> 00:02:38,160
complicated

69
00:02:38,160 --> 00:02:40,879
uh this in turn can lead to bad

70
00:02:40,879 --> 00:02:42,959
assessments of risk and

71
00:02:42,959 --> 00:02:45,840
again kind of limit or waste resources

72
00:02:45,840 --> 00:02:47,680
that are

73
00:02:47,680 --> 00:02:51,440
so often limited by organizations

74
00:02:51,440 --> 00:02:53,920
lastly just working with within excel in

75
00:02:53,920 --> 00:02:57,040
general provides its own challenges and

76
00:02:57,040 --> 00:02:59,200
provides an opportunity for unnecessary

77
00:02:59,200 --> 00:03:02,959
mistakes and often bias on part of the

78
00:03:02,959 --> 00:03:05,360
the operators uh creating these for

79
00:03:05,360 --> 00:03:07,920
their clients

80
00:03:08,720 --> 00:03:11,840
okay so haha this is you know

81
00:03:11,840 --> 00:03:13,840
me trying to fill out my first one and

82
00:03:13,840 --> 00:03:16,959
just kind of hating the day

83
00:03:17,519 --> 00:03:19,040
but uh yeah

84
00:03:19,040 --> 00:03:20,239
so

85
00:03:20,239 --> 00:03:23,040
here's a example scenario uh we've got

86
00:03:23,040 --> 00:03:24,879
apt-41

87
00:03:24,879 --> 00:03:26,239
executing

88
00:03:26,239 --> 00:03:30,480
ransomware on a target organization

89
00:03:30,480 --> 00:03:32,239
these matrices typically involve

90
00:03:32,239 --> 00:03:34,080
multiple scenarios um each of these

91
00:03:34,080 --> 00:03:35,280
scenarios

92
00:03:35,280 --> 00:03:37,920
are a collection of events

93
00:03:37,920 --> 00:03:39,760
uh each of these events considers

94
00:03:39,760 --> 00:03:41,200
something being attacked you know its

95
00:03:41,200 --> 00:03:43,440
vulnerabilities its defenses and any

96
00:03:43,440 --> 00:03:45,680
possible impacts uh incurred by the

97
00:03:45,680 --> 00:03:47,040
client

98
00:03:47,040 --> 00:03:50,239
each event also has a threat source as

99
00:03:50,239 --> 00:03:52,560
highlighted in the slide here

100
00:03:52,560 --> 00:03:55,120
um these threat sources would typically

101
00:03:55,120 --> 00:03:56,080
be like

102
00:03:56,080 --> 00:03:57,760
you'd want to think like a you know an

103
00:03:57,760 --> 00:04:00,480
apt or insider threat or something along

104
00:04:00,480 --> 00:04:03,040
those lines

105
00:04:03,280 --> 00:04:05,519
okay we've also uh strayed a little bit

106
00:04:05,519 --> 00:04:07,680
from the nist recommendations and

107
00:04:07,680 --> 00:04:10,640
included the minor attack ids

108
00:04:10,640 --> 00:04:12,959
to this nist template

109
00:04:12,959 --> 00:04:14,400
you can see they're hyperlinked here so

110
00:04:14,400 --> 00:04:15,680
whenever you click on those it'll take

111
00:04:15,680 --> 00:04:17,040
you to the

112
00:04:17,040 --> 00:04:20,000
um mitre attack website for full details

113
00:04:20,000 --> 00:04:23,600
on what that technique is

114
00:04:23,919 --> 00:04:25,919
um here we can see

115
00:04:25,919 --> 00:04:27,919
threat source characteristics which

116
00:04:27,919 --> 00:04:30,560
model your attacker's capability intent

117
00:04:30,560 --> 00:04:33,199
and level of targeting

118
00:04:33,199 --> 00:04:34,960
there's also a relevance column which

119
00:04:34,960 --> 00:04:36,240
shows how

120
00:04:36,240 --> 00:04:37,919
that particular event is relevant to

121
00:04:37,919 --> 00:04:39,199
your client

122
00:04:39,199 --> 00:04:41,040
just as an example

123
00:04:41,040 --> 00:04:43,120
like a confirmed event would be

124
00:04:43,120 --> 00:04:44,720
something that the

125
00:04:44,720 --> 00:04:46,080
um

126
00:04:46,080 --> 00:04:47,600
the the team conducting the risk

127
00:04:47,600 --> 00:04:50,080
assessment uh successfully executed

128
00:04:50,080 --> 00:04:52,720
while doing the assessment

129
00:04:52,720 --> 00:04:53,919
whether that's landing a fishing

130
00:04:53,919 --> 00:04:56,560
campaign or

131
00:04:56,560 --> 00:05:01,120
getting domain admin you know whatever

132
00:05:01,280 --> 00:05:03,600
also we have the two base likelihood

133
00:05:03,600 --> 00:05:06,960
values for attack initiation and

134
00:05:06,960 --> 00:05:09,440
that event resulting in adverse impact

135
00:05:09,440 --> 00:05:11,520
these two combined yield and overall

136
00:05:11,520 --> 00:05:14,400
likelihood value

137
00:05:15,759 --> 00:05:17,039
we also have vulnerabilities

138
00:05:17,039 --> 00:05:18,800
predisposing conditions

139
00:05:18,800 --> 00:05:20,479
the vulnerability severity and

140
00:05:20,479 --> 00:05:21,919
pervasiveness of a predisposing

141
00:05:21,919 --> 00:05:23,440
condition

142
00:05:23,440 --> 00:05:25,840
also mitigations are called out here

143
00:05:25,840 --> 00:05:29,440
that were observed during the assessment

144
00:05:30,880 --> 00:05:32,720
uh and lastly

145
00:05:32,720 --> 00:05:34,560
impact which considers the depth at

146
00:05:34,560 --> 00:05:37,600
which a particular event affects your

147
00:05:37,600 --> 00:05:41,120
your client organization

148
00:05:43,360 --> 00:05:46,479
okay so how do we calculate risk

149
00:05:46,479 --> 00:05:49,039
that kind of last column here

150
00:05:49,039 --> 00:05:50,960
there are three major factors that

151
00:05:50,960 --> 00:05:52,960
ultimately determine the overall risk

152
00:05:52,960 --> 00:05:54,479
the first two are those base likelihood

153
00:05:54,479 --> 00:05:56,639
values which are like i said before

154
00:05:56,639 --> 00:05:58,080
combined and they

155
00:05:58,080 --> 00:05:59,759
are evaluated to yield a overall

156
00:05:59,759 --> 00:06:02,639
likelihood value

157
00:06:02,960 --> 00:06:04,160
and then also

158
00:06:04,160 --> 00:06:05,759
the overall likelihood is combined with

159
00:06:05,759 --> 00:06:08,880
the level of impact um these two

160
00:06:08,880 --> 00:06:12,160
values are evaluated and yields a uh a

161
00:06:12,160 --> 00:06:15,280
value for overall risk

162
00:06:15,840 --> 00:06:17,199
uh you might be thinking like what's the

163
00:06:17,199 --> 00:06:18,800
point of all these other columns if

164
00:06:18,800 --> 00:06:20,400
really only three of them end up

165
00:06:20,400 --> 00:06:23,120
determining your overall risk

166
00:06:23,120 --> 00:06:24,800
it's kind of important to take into

167
00:06:24,800 --> 00:06:27,280
account those other columns

168
00:06:27,280 --> 00:06:29,120
particularly

169
00:06:29,120 --> 00:06:31,759
attack initiation likelihood benefits a

170
00:06:31,759 --> 00:06:34,319
great deal from taking the threat source

171
00:06:34,319 --> 00:06:35,759
threat source characteristics into

172
00:06:35,759 --> 00:06:38,960
account um the likelihood of an event

173
00:06:38,960 --> 00:06:41,360
leading to you know adverse impact uh

174
00:06:41,360 --> 00:06:43,039
benefits from taking

175
00:06:43,039 --> 00:06:45,919
the relevancy of that event into account

176
00:06:45,919 --> 00:06:47,120
um

177
00:06:47,120 --> 00:06:49,120
yeah

178
00:06:49,120 --> 00:06:50,960
and then whenever you're deciding the

179
00:06:50,960 --> 00:06:53,360
value for level of impact uh you'd want

180
00:06:53,360 --> 00:06:55,039
to take into account you know what

181
00:06:55,039 --> 00:06:56,560
vulnerabilities did you discover were

182
00:06:56,560 --> 00:06:58,160
there any predisposing conditions in

183
00:06:58,160 --> 00:07:00,080
place

184
00:07:00,080 --> 00:07:01,919
when doing the assessment and did you

185
00:07:01,919 --> 00:07:03,919
run into any mitigations that

186
00:07:03,919 --> 00:07:06,479
uh impeded or blocked that event from

187
00:07:06,479 --> 00:07:09,359
happening altogether

188
00:07:10,560 --> 00:07:12,319
uh one last thing about threat matrices

189
00:07:12,319 --> 00:07:14,080
that i really want to bring out

190
00:07:14,080 --> 00:07:15,120
they

191
00:07:15,120 --> 00:07:16,720
are really meant to just ensure that

192
00:07:16,720 --> 00:07:18,000
that leadership

193
00:07:18,000 --> 00:07:19,599
uh product owners defenders and

194
00:07:19,599 --> 00:07:21,680
assessors are all working from within

195
00:07:21,680 --> 00:07:24,880
the same reality um threat matrices

196
00:07:24,880 --> 00:07:27,280
should typically be considered a single

197
00:07:27,280 --> 00:07:30,240
point of truth uh between all parties

198
00:07:30,240 --> 00:07:32,240
and there really needs to be

199
00:07:32,240 --> 00:07:34,880
good sound reasoning in place before

200
00:07:34,880 --> 00:07:35,919
changing

201
00:07:35,919 --> 00:07:39,758
um the contents of one

202
00:07:40,240 --> 00:07:43,280
okay so all that brings us to uh

203
00:07:43,280 --> 00:07:46,720
our tool uh etm or uh enter the matrix

204
00:07:46,720 --> 00:07:48,720
it was created to make the entire threat

205
00:07:48,720 --> 00:07:51,120
matrix process as painless as possible

206
00:07:51,120 --> 00:07:53,360
while increasing overall consistency

207
00:07:53,360 --> 00:07:56,160
within an assessing organization

208
00:07:56,160 --> 00:07:59,039
it's also updatable as ttps change um

209
00:07:59,039 --> 00:08:02,160
like the miter attack framework

210
00:08:02,160 --> 00:08:05,759
it's changing at a pretty quick clip

211
00:08:05,759 --> 00:08:08,160
over time etm has grown to include graph

212
00:08:08,160 --> 00:08:10,560
generation and also improved consistency

213
00:08:10,560 --> 00:08:12,800
within the community resulting in

214
00:08:12,800 --> 00:08:14,479
better data for

215
00:08:14,479 --> 00:08:17,599
all of our clients hopefully

216
00:08:18,319 --> 00:08:20,080
uh if you want to give it a try

217
00:08:20,080 --> 00:08:22,240
it's over on the black lantern security

218
00:08:22,240 --> 00:08:24,639
github repo

219
00:08:24,639 --> 00:08:27,520
it's a web application it's written in

220
00:08:27,520 --> 00:08:29,680
csharp on.net core

221
00:08:29,680 --> 00:08:32,479
uses as the database

222
00:08:32,479 --> 00:08:35,039
uh it supports local authentication or

223
00:08:35,039 --> 00:08:37,440
ldap integration

224
00:08:37,440 --> 00:08:38,159
for

225
00:08:38,159 --> 00:08:39,440
for

226
00:08:39,440 --> 00:08:41,679
authenticating to the application

227
00:08:41,679 --> 00:08:42,719
um

228
00:08:42,719 --> 00:08:46,320
also graphis and d3 javascript library

229
00:08:46,320 --> 00:08:48,399
are used on the backend for generating

230
00:08:48,399 --> 00:08:51,279
the graphs

231
00:08:51,519 --> 00:08:54,080
okay so how do we go about fixing some

232
00:08:54,080 --> 00:08:56,080
of the problems that um

233
00:08:56,080 --> 00:08:57,760
that we've identified

234
00:08:57,760 --> 00:08:58,800
um

235
00:08:58,800 --> 00:09:02,160
for one the the uh user interface

236
00:09:02,160 --> 00:09:04,240
uh should hopefully reduce the pain felt

237
00:09:04,240 --> 00:09:06,160
by the end user by removing their need

238
00:09:06,160 --> 00:09:08,640
to interact directly with the within

239
00:09:08,640 --> 00:09:10,959
excel

240
00:09:11,360 --> 00:09:13,519
also we've included helper dialogs

241
00:09:13,519 --> 00:09:15,120
for each factor which eliminates the

242
00:09:15,120 --> 00:09:17,120
need to cross-reference with outside

243
00:09:17,120 --> 00:09:18,880
information

244
00:09:18,880 --> 00:09:21,040
particularly the tables found in nist

245
00:09:21,040 --> 00:09:22,800
documentation

246
00:09:22,800 --> 00:09:25,120
we also added our own

247
00:09:25,120 --> 00:09:27,040
bls descriptions just to make it a

248
00:09:27,040 --> 00:09:28,480
little more

249
00:09:28,480 --> 00:09:32,080
easy to understand easy to follow

250
00:09:32,880 --> 00:09:35,360
etm also will automatically generate

251
00:09:35,360 --> 00:09:37,279
spreadsheets for you which removes the

252
00:09:37,279 --> 00:09:38,720
need for you to

253
00:09:38,720 --> 00:09:40,959
you know fuss with formatting inside of

254
00:09:40,959 --> 00:09:43,279
excel

255
00:09:43,680 --> 00:09:46,560
it also takes care of the calculations

256
00:09:46,560 --> 00:09:48,800
that i mentioned before

257
00:09:48,800 --> 00:09:50,640
for the overall likelihood and overall

258
00:09:50,640 --> 00:09:52,320
risk values

259
00:09:52,320 --> 00:09:54,080
just based on you know the other values

260
00:09:54,080 --> 00:09:57,839
that you put into the application

261
00:09:59,200 --> 00:10:01,040
etm provides a

262
00:10:01,040 --> 00:10:02,880
repository of

263
00:10:02,880 --> 00:10:05,200
past assessments that you can learn from

264
00:10:05,200 --> 00:10:07,200
and pull from to maintain a little bit

265
00:10:07,200 --> 00:10:09,360
more consistency over time within your

266
00:10:09,360 --> 00:10:12,079
organization

267
00:10:13,040 --> 00:10:16,000
you can also create templates in etm

268
00:10:16,000 --> 00:10:17,920
this allows you to reuse threat sources

269
00:10:17,920 --> 00:10:19,440
and events that

270
00:10:19,440 --> 00:10:22,000
you had used in the past

271
00:10:22,000 --> 00:10:25,360
and something we aim to improve uh over

272
00:10:25,360 --> 00:10:27,360
time uh is consistency within the

273
00:10:27,360 --> 00:10:29,279
community uh we think we can do this

274
00:10:29,279 --> 00:10:31,200
with template packs

275
00:10:31,200 --> 00:10:32,880
templating out

276
00:10:32,880 --> 00:10:34,560
different threat sources

277
00:10:34,560 --> 00:10:35,920
different

278
00:10:35,920 --> 00:10:37,440
attack narratives

279
00:10:37,440 --> 00:10:38,959
and these can be imported and exported

280
00:10:38,959 --> 00:10:41,518
from the tool

281
00:10:42,959 --> 00:10:45,200
a part of the attack narratives you can

282
00:10:45,200 --> 00:10:46,880
also generate graphs

283
00:10:46,880 --> 00:10:48,399
alongside them

284
00:10:48,399 --> 00:10:50,399
this makes presenting the results of

285
00:10:50,399 --> 00:10:53,440
your assessment a little bit easier to

286
00:10:53,440 --> 00:10:56,640
non-technical audiences

287
00:10:57,600 --> 00:11:00,880
etm also generates threat trees uh it

288
00:11:00,880 --> 00:11:03,680
goes through and accumulates all of the

289
00:11:03,680 --> 00:11:06,079
miter techniques that were used during

290
00:11:06,079 --> 00:11:08,480
an assessment and it allows the end user

291
00:11:08,480 --> 00:11:11,680
to connect them in any way they wish

292
00:11:11,680 --> 00:11:13,920
custom categories as many links as you

293
00:11:13,920 --> 00:11:16,320
want um you can change the overall style

294
00:11:16,320 --> 00:11:17,120
and

295
00:11:17,120 --> 00:11:18,560
yeah

296
00:11:18,560 --> 00:11:21,120
yeah so yeah um graph features

297
00:11:21,120 --> 00:11:22,320
um

298
00:11:22,320 --> 00:11:23,360
they

299
00:11:23,360 --> 00:11:25,040
kind of allows your tree to have a wide

300
00:11:25,040 --> 00:11:28,480
amount a wide array of customization

301
00:11:28,480 --> 00:11:31,040
this affects the shape size direction

302
00:11:31,040 --> 00:11:33,279
and style of your graph

303
00:11:33,279 --> 00:11:34,959
also each node

304
00:11:34,959 --> 00:11:36,480
has a wide selection of options to

305
00:11:36,480 --> 00:11:37,760
choose from

306
00:11:37,760 --> 00:11:39,600
that changes how

307
00:11:39,600 --> 00:11:41,279
each technique is presented with inside

308
00:11:41,279 --> 00:11:43,839
your graph

309
00:11:44,320 --> 00:11:47,279
spreadsheets the etm exports are

310
00:11:47,279 --> 00:11:50,160
can be considered living so as clients

311
00:11:50,160 --> 00:11:51,839
improve their security posture over time

312
00:11:51,839 --> 00:11:53,680
they can return back to

313
00:11:53,680 --> 00:11:55,760
these threat matrices and update them

314
00:11:55,760 --> 00:11:57,519
and as they update them those calculated

315
00:11:57,519 --> 00:12:00,000
fields for overall likelihood and

316
00:12:00,000 --> 00:12:01,680
overall risk

317
00:12:01,680 --> 00:12:03,760
are handled automatically within the

318
00:12:03,760 --> 00:12:06,240
spreadsheet

319
00:12:06,240 --> 00:12:09,120
and lastly etm can export threat

320
00:12:09,120 --> 00:12:12,560
matrices to printable pdf form if for

321
00:12:12,560 --> 00:12:14,639
whatever reason a digital copy of a

322
00:12:14,639 --> 00:12:16,880
threat matrix isn't

323
00:12:16,880 --> 00:12:19,600
isn't preferred

324
00:12:21,040 --> 00:12:24,959
okay so i'm going to switch over

325
00:12:24,959 --> 00:12:28,240
to a demo hopefully

326
00:12:28,240 --> 00:12:30,639
let's see

327
00:12:34,399 --> 00:12:36,240
okay

328
00:12:36,240 --> 00:12:39,839
hopefully this is still getting shared

329
00:12:41,360 --> 00:12:42,880
we can see your virtual machine loading

330
00:12:42,880 --> 00:12:43,600
up

331
00:12:43,600 --> 00:12:47,560
awesome great news

332
00:12:54,240 --> 00:12:56,399
okay

333
00:12:56,399 --> 00:12:58,720
kind of a wonky resolution but

334
00:12:58,720 --> 00:13:01,279
it'll be okay so like i mentioned before

335
00:13:01,279 --> 00:13:03,920
um etm has a local authentication in

336
00:13:03,920 --> 00:13:05,120
place so

337
00:13:05,120 --> 00:13:08,399
you can go ahead and log in as your

338
00:13:08,399 --> 00:13:11,040
admin user

339
00:13:11,040 --> 00:13:15,719
and claim right

340
00:13:28,880 --> 00:13:31,880
hopefully

341
00:13:51,199 --> 00:13:54,399
okay just wanted to hang okay well

342
00:13:54,399 --> 00:13:57,360
just a second

343
00:13:58,480 --> 00:14:01,360
uh it's also uh made to run with docker

344
00:14:01,360 --> 00:14:04,920
so that's kind of cool

345
00:14:16,000 --> 00:14:18,320
we go

346
00:14:19,839 --> 00:14:23,320
cool okay

347
00:14:32,320 --> 00:14:33,920
okay so we can go ahead and log in with

348
00:14:33,920 --> 00:14:36,320
our admin user uh you can create new

349
00:14:36,320 --> 00:14:39,320
users

350
00:14:44,000 --> 00:14:45,760
go ahead and log out

351
00:14:45,760 --> 00:14:47,920
log back in with our newly

352
00:14:47,920 --> 00:14:50,719
created user

353
00:14:50,880 --> 00:14:52,320
all right

354
00:14:52,320 --> 00:14:53,680
and this is the

355
00:14:53,680 --> 00:14:55,040
main landing page you can go to

356
00:14:55,040 --> 00:14:58,160
assessments you can view your templates

357
00:14:58,160 --> 00:14:59,680
just viewing over to assessments you can

358
00:14:59,680 --> 00:15:02,240
see that past repository of assessments

359
00:15:02,240 --> 00:15:04,800
that have been done

360
00:15:05,360 --> 00:15:06,639
let's see

361
00:15:06,639 --> 00:15:08,160
go to awesomecorp

362
00:15:08,160 --> 00:15:10,000
because they're awesome

363
00:15:10,000 --> 00:15:11,600
and these are the scenarios that have

364
00:15:11,600 --> 00:15:13,920
been uh started

365
00:15:13,920 --> 00:15:15,360
for this assessment

366
00:15:15,360 --> 00:15:17,120
uh we've got an over privileged web app

367
00:15:17,120 --> 00:15:19,680
and the apt-41 ransomware that i was uh

368
00:15:19,680 --> 00:15:22,560
referring to in the slides

369
00:15:22,560 --> 00:15:24,639
let's go ahead and look at apt-41

370
00:15:24,639 --> 00:15:27,040
ransomware um

371
00:15:27,040 --> 00:15:28,720
here you can see all of the events

372
00:15:28,720 --> 00:15:30,880
involved in that particular attack

373
00:15:30,880 --> 00:15:32,320
narrative

374
00:15:32,320 --> 00:15:34,000
i do want to throw out that if you if

375
00:15:34,000 --> 00:15:35,600
you're making one of these and they're

376
00:15:35,600 --> 00:15:37,120
kind of out of order if you want to

377
00:15:37,120 --> 00:15:39,120
reorder them you can totally just drag

378
00:15:39,120 --> 00:15:40,639
and drop them around and put them in

379
00:15:40,639 --> 00:15:42,480
whatever order you you need them to be

380
00:15:42,480 --> 00:15:44,320
in

381
00:15:44,320 --> 00:15:45,360
um

382
00:15:45,360 --> 00:15:47,839
also just want to point out here that we

383
00:15:47,839 --> 00:15:49,600
are missing the last step for them

384
00:15:49,600 --> 00:15:52,240
actually deploying ransomware um so we'd

385
00:15:52,240 --> 00:15:54,399
have to create an event

386
00:15:54,399 --> 00:15:56,880
um here's where you would see templates

387
00:15:56,880 --> 00:15:58,639
to pull from if you had any uh you could

388
00:15:58,639 --> 00:16:00,480
also create just from new if you wanted

389
00:16:00,480 --> 00:16:01,920
to

390
00:16:01,920 --> 00:16:03,600
but we actually have templates for this

391
00:16:03,600 --> 00:16:04,880
so

392
00:16:04,880 --> 00:16:07,120
let's go ahead and

393
00:16:07,120 --> 00:16:09,839
import

394
00:16:10,720 --> 00:16:14,800
there we go 1841 ransomware

395
00:16:14,800 --> 00:16:16,959
go ahead and import that in

396
00:16:16,959 --> 00:16:19,120
there we go we can see we've got abt41

397
00:16:19,120 --> 00:16:21,600
deploys ransomware there

398
00:16:21,600 --> 00:16:25,279
so we can go back to our assessment

399
00:16:26,000 --> 00:16:28,560
and create an event and now that list is

400
00:16:28,560 --> 00:16:30,639
populated as filters so if you want to

401
00:16:30,639 --> 00:16:33,000
do ransomware

402
00:16:33,000 --> 00:16:35,360
apt-41 of course it's in all of those

403
00:16:35,360 --> 00:16:36,399
but

404
00:16:36,399 --> 00:16:39,839
yeah ransomware import it

405
00:16:39,839 --> 00:16:41,680
uh pretty much everything in here is

406
00:16:41,680 --> 00:16:44,000
already filled out because it's it was a

407
00:16:44,000 --> 00:16:45,839
templated out event

408
00:16:45,839 --> 00:16:47,759
um

409
00:16:47,759 --> 00:16:48,800
let's say

410
00:16:48,800 --> 00:16:51,440
this is the this is how we're supporting

411
00:16:51,440 --> 00:16:53,440
mitre attack uh you can go through and

412
00:16:53,440 --> 00:16:54,800
these are just kind of accordion

413
00:16:54,800 --> 00:16:56,160
categories that you can go through and

414
00:16:56,160 --> 00:16:57,519
select from

415
00:16:57,519 --> 00:17:00,560
um each of these little helper icons as

416
00:17:00,560 --> 00:17:02,399
you can see will take you to the micro

417
00:17:02,399 --> 00:17:04,480
attack website if you need

418
00:17:04,480 --> 00:17:06,000
more information about it before you

419
00:17:06,000 --> 00:17:07,839
make your choice

420
00:17:07,839 --> 00:17:09,199
if you already know what you're looking

421
00:17:09,199 --> 00:17:11,359
for you can just

422
00:17:11,359 --> 00:17:13,039
type up in here

423
00:17:13,039 --> 00:17:15,520
the name of what you're looking for

424
00:17:15,520 --> 00:17:17,119
we're looking for data encrypted for

425
00:17:17,119 --> 00:17:18,799
impact which is already selected it's

426
00:17:18,799 --> 00:17:21,199
awesome

427
00:17:21,919 --> 00:17:23,199
um

428
00:17:23,199 --> 00:17:25,039
i also want to shout out that we are

429
00:17:25,039 --> 00:17:27,520
supporting attack for ics uh i think in

430
00:17:27,520 --> 00:17:28,799
the last talk

431
00:17:28,799 --> 00:17:29,919
um

432
00:17:29,919 --> 00:17:31,679
colonial pipeline and stuff was was

433
00:17:31,679 --> 00:17:34,320
detect and i think it's going to be

434
00:17:34,320 --> 00:17:35,520
uh

435
00:17:35,520 --> 00:17:37,679
the area of more focus hopefully in the

436
00:17:37,679 --> 00:17:39,120
future but

437
00:17:39,120 --> 00:17:40,559
um

438
00:17:40,559 --> 00:17:41,520
yeah

439
00:17:41,520 --> 00:17:42,340
so

440
00:17:42,340 --> 00:17:43,679
[Music]

441
00:17:43,679 --> 00:17:45,600
oh and then the other hyper helper

442
00:17:45,600 --> 00:17:48,000
dialogues that i mentioned in the talk

443
00:17:48,000 --> 00:17:49,919
um

444
00:17:49,919 --> 00:17:52,240
like attacker intent

445
00:17:52,240 --> 00:17:54,480
uh here you can see nist descriptions of

446
00:17:54,480 --> 00:17:55,440
what a

447
00:17:55,440 --> 00:17:56,720
very high

448
00:17:56,720 --> 00:17:59,360
uh attacker attempt would be

449
00:17:59,360 --> 00:18:00,480
um

450
00:18:00,480 --> 00:18:03,760
they like to use terms like um

451
00:18:03,760 --> 00:18:05,840
you know severely impede

452
00:18:05,840 --> 00:18:07,200
um

453
00:18:07,200 --> 00:18:09,200
impede

454
00:18:09,200 --> 00:18:10,400
uh

455
00:18:10,400 --> 00:18:12,480
yeah it can just kind of be a little bit

456
00:18:12,480 --> 00:18:14,400
vague so we

457
00:18:14,400 --> 00:18:16,480
took initiative and just kind of created

458
00:18:16,480 --> 00:18:18,720
our own um a little bit easier to

459
00:18:18,720 --> 00:18:21,840
understand descriptions here

460
00:18:23,040 --> 00:18:24,400
[Music]

461
00:18:24,400 --> 00:18:26,000
okay the only thing that's not included

462
00:18:26,000 --> 00:18:28,000
in these templates is the graph

463
00:18:28,000 --> 00:18:29,919
information for

464
00:18:29,919 --> 00:18:31,919
the attack narrative graphs

465
00:18:31,919 --> 00:18:33,919
so whenever you import them just you

466
00:18:33,919 --> 00:18:35,200
just want to collect

467
00:18:35,200 --> 00:18:38,400
or select what icons you want to use

468
00:18:38,400 --> 00:18:40,720
this is a set of completely custom icons

469
00:18:40,720 --> 00:18:41,679
that

470
00:18:41,679 --> 00:18:44,320
we made for the tool

471
00:18:44,320 --> 00:18:44,900
um

472
00:18:44,900 --> 00:18:48,019
[Music]

473
00:18:50,000 --> 00:18:52,240
okay and then the description here is

474
00:18:52,240 --> 00:18:53,600
the description that will actually show

475
00:18:53,600 --> 00:18:55,200
up in the graph

476
00:18:55,200 --> 00:18:57,840
um

477
00:18:58,320 --> 00:19:00,480
keep it pretty simple

478
00:19:00,480 --> 00:19:02,559
and then the proceeded by area

479
00:19:02,559 --> 00:19:06,640
you can have as many or as few as one

480
00:19:06,640 --> 00:19:08,640
links leading to this

481
00:19:08,640 --> 00:19:10,640
this event occurring in your graph

482
00:19:10,640 --> 00:19:13,679
so if you um

483
00:19:13,679 --> 00:19:15,440
you know if you wanted to show off that

484
00:19:15,440 --> 00:19:17,120
you know you have to execute four things

485
00:19:17,120 --> 00:19:19,120
simultaneously to lead to

486
00:19:19,120 --> 00:19:22,320
um one vulnerability being exploited um

487
00:19:22,320 --> 00:19:24,400
you can totally do that with this

488
00:19:24,400 --> 00:19:25,440
um

489
00:19:25,440 --> 00:19:26,960
right here we're just

490
00:19:26,960 --> 00:19:29,200
connecting domain admin to deploy

491
00:19:29,200 --> 00:19:32,000
ransomware go ahead and save that

492
00:19:32,000 --> 00:19:33,360
um oh

493
00:19:33,360 --> 00:19:36,320
also if you do create an event

494
00:19:36,320 --> 00:19:38,240
manually you can go ahead and save that

495
00:19:38,240 --> 00:19:41,520
out as a template if you want

496
00:19:42,160 --> 00:19:43,120
okay

497
00:19:43,120 --> 00:19:45,360
so

498
00:19:46,640 --> 00:19:48,400
all right so we can go ahead and show

499
00:19:48,400 --> 00:19:53,200
the graph uh these are made um

500
00:19:53,200 --> 00:19:55,840
they utilize the d3 javascript library

501
00:19:55,840 --> 00:19:59,840
on the back end um it's pretty neat

502
00:19:59,840 --> 00:20:01,440
you can just kind of click and drag your

503
00:20:01,440 --> 00:20:03,679
graph wherever you want it and it'll

504
00:20:03,679 --> 00:20:04,840
it'll stick

505
00:20:04,840 --> 00:20:06,559
there

506
00:20:06,559 --> 00:20:08,720
there we go to make it look

507
00:20:08,720 --> 00:20:11,760
as neat or unorganized as you want

508
00:20:11,760 --> 00:20:14,320
double clicking releases

509
00:20:14,320 --> 00:20:17,360
all these icons for you

510
00:20:17,919 --> 00:20:20,240
this will when you click the save button

511
00:20:20,240 --> 00:20:22,080
it'll it'll save as a transparent

512
00:20:22,080 --> 00:20:24,320
background so you can use it in any kind

513
00:20:24,320 --> 00:20:25,200
of

514
00:20:25,200 --> 00:20:27,919
watermark documents that you want to use

515
00:20:27,919 --> 00:20:28,799
um

516
00:20:28,799 --> 00:20:30,240
also

517
00:20:30,240 --> 00:20:31,840
there's a markdown button we have

518
00:20:31,840 --> 00:20:33,360
another tool called

519
00:20:33,360 --> 00:20:35,600
right hat that we developed to kind of

520
00:20:35,600 --> 00:20:37,760
replace the need to use

521
00:20:37,760 --> 00:20:39,440
like word processing

522
00:20:39,440 --> 00:20:42,559
tools also incorporates

523
00:20:42,559 --> 00:20:44,880
a technical finding

524
00:20:44,880 --> 00:20:46,559
repository and

525
00:20:46,559 --> 00:20:48,000
keeping track of findings during an

526
00:20:48,000 --> 00:20:49,120
assessment

527
00:20:49,120 --> 00:20:52,320
um utilizes markdown so it behooved us

528
00:20:52,320 --> 00:20:54,559
to just generate um a lot of things and

529
00:20:54,559 --> 00:20:56,400
mark down in our other tools

530
00:20:56,400 --> 00:20:57,679
um

531
00:20:57,679 --> 00:20:59,520
this automatically you know generates

532
00:20:59,520 --> 00:21:01,200
that markdown based on the event

533
00:21:01,200 --> 00:21:02,960
descriptions

534
00:21:02,960 --> 00:21:05,919
for each of those events

535
00:21:10,559 --> 00:21:12,640
what else

536
00:21:12,640 --> 00:21:14,840
[Music]

537
00:21:14,840 --> 00:21:18,320
um uh next i can show off the threat

538
00:21:18,320 --> 00:21:19,679
tree

539
00:21:19,679 --> 00:21:21,919
um so like i said earlier uh these

540
00:21:21,919 --> 00:21:23,840
accumulate all of the

541
00:21:23,840 --> 00:21:25,760
uh attack techniques that were used

542
00:21:25,760 --> 00:21:28,400
across the assessment and presents them

543
00:21:28,400 --> 00:21:31,280
to the end user um most values can be

544
00:21:31,280 --> 00:21:32,799
left as default

545
00:21:32,799 --> 00:21:35,679
uh just to make a nice pretty graph

546
00:21:35,679 --> 00:21:37,840
but um

547
00:21:37,840 --> 00:21:39,760
they they do need to be connected though

548
00:21:39,760 --> 00:21:41,280
by the end user

549
00:21:41,280 --> 00:21:43,200
um so we can scroll down to the bottom

550
00:21:43,200 --> 00:21:45,919
here and see the event that we just

551
00:21:45,919 --> 00:21:48,000
added which was

552
00:21:48,000 --> 00:21:49,440
data encrypted for impact we can go

553
00:21:49,440 --> 00:21:51,919
ahead and enable that in our graph

554
00:21:51,919 --> 00:21:53,440
um

555
00:21:53,440 --> 00:21:56,000
we can change we can select a category

556
00:21:56,000 --> 00:21:58,000
for it but we don't really have an

557
00:21:58,000 --> 00:21:59,679
impact category

558
00:21:59,679 --> 00:22:02,159
so i'm going to go ahead and

559
00:22:02,159 --> 00:22:04,320
save our change there and then we can

560
00:22:04,320 --> 00:22:06,320
edit the category

561
00:22:06,320 --> 00:22:09,840
and just go ahead and add it in

562
00:22:10,960 --> 00:22:14,720
so say impact

563
00:22:14,720 --> 00:22:16,720
and

564
00:22:16,720 --> 00:22:18,880
let's see and for whatever reason um

565
00:22:18,880 --> 00:22:20,799
firefox doesn't like rendering this

566
00:22:20,799 --> 00:22:22,720
color in the drop down list

567
00:22:22,720 --> 00:22:23,600
um

568
00:22:23,600 --> 00:22:24,799
so that's

569
00:22:24,799 --> 00:22:27,840
kind of annoying but uh in chrome it

570
00:22:27,840 --> 00:22:30,640
works a lot better

571
00:22:30,640 --> 00:22:32,880
so go ahead and save that

572
00:22:32,880 --> 00:22:35,039
and we'll go back down to our node and

573
00:22:35,039 --> 00:22:38,880
plop it into the correct category

574
00:22:38,880 --> 00:22:40,720
there we go

575
00:22:40,720 --> 00:22:42,880
and then we're also going to connect it

576
00:22:42,880 --> 00:22:43,600
to

577
00:22:43,600 --> 00:22:46,959
uh proceeding techniques

578
00:22:47,660 --> 00:22:53,440
[Music]

579
00:22:53,440 --> 00:22:55,840
okay

580
00:22:55,840 --> 00:22:57,030
there we go

581
00:22:57,030 --> 00:22:58,640
[Music]

582
00:22:58,640 --> 00:22:59,840
and

583
00:22:59,840 --> 00:23:01,200
there we go

584
00:23:01,200 --> 00:23:03,200
okay and i also want to point out that

585
00:23:03,200 --> 00:23:05,600
um a lot of these options like making

586
00:23:05,600 --> 00:23:07,440
the graph ranked or making graph

587
00:23:07,440 --> 00:23:10,720
clustered or directed

588
00:23:10,720 --> 00:23:12,320
we don't expect anybody to really know

589
00:23:12,320 --> 00:23:15,280
what that means so we included helper

590
00:23:15,280 --> 00:23:16,960
dialogues here too so if you want to

591
00:23:16,960 --> 00:23:18,559
make your graph ranked

592
00:23:18,559 --> 00:23:21,039
um you see on the left here that's

593
00:23:21,039 --> 00:23:22,080
that's kind of what it would look like

594
00:23:22,080 --> 00:23:23,280
with their

595
00:23:23,280 --> 00:23:25,039
if you had a and b ranked together and c

596
00:23:25,039 --> 00:23:26,799
and d ranked together and

597
00:23:26,799 --> 00:23:28,960
yeah so we give examples for what all

598
00:23:28,960 --> 00:23:31,039
these options mean um you can also just

599
00:23:31,039 --> 00:23:32,320
kind of play around with them and see

600
00:23:32,320 --> 00:23:34,080
what different kinds of uh kinds of

601
00:23:34,080 --> 00:23:38,639
graphs you you end up with kind of cool

602
00:23:38,799 --> 00:23:40,559
um

603
00:23:40,559 --> 00:23:42,559
okay we'll go ahead and save changes and

604
00:23:42,559 --> 00:23:44,559
export the graph

605
00:23:44,559 --> 00:23:46,400
um

606
00:23:46,400 --> 00:23:48,400
go ahead and zoom out here my resolution

607
00:23:48,400 --> 00:23:50,000
is crazy but you can kind of see here

608
00:23:50,000 --> 00:23:50,960
that

609
00:23:50,960 --> 00:23:52,799
you've got your recon phase your initial

610
00:23:52,799 --> 00:23:55,120
access techniques happening here

611
00:23:55,120 --> 00:23:57,440
escalating privilege gaining persistence

612
00:23:57,440 --> 00:23:59,840
then also impact

613
00:23:59,840 --> 00:24:02,960
these arrows can be changed to a wide

614
00:24:02,960 --> 00:24:05,679
selection of different styles

615
00:24:05,679 --> 00:24:08,159
how these edges are merged or not merged

616
00:24:08,159 --> 00:24:11,520
or styled can all be changed

617
00:24:11,520 --> 00:24:13,679
so yeah

618
00:24:13,679 --> 00:24:17,720
go ahead and go back

619
00:24:19,940 --> 00:24:21,360
[Music]

620
00:24:21,360 --> 00:24:23,120
okay so

621
00:24:23,120 --> 00:24:25,840
i think lastly we want to look at

622
00:24:25,840 --> 00:24:29,279
actually exporting the threat matrix um

623
00:24:29,279 --> 00:24:31,679
first we can see exporting

624
00:24:31,679 --> 00:24:35,279
to html or print to pdf

625
00:24:35,279 --> 00:24:38,320
first you'll kind of get this html page

626
00:24:38,320 --> 00:24:40,960
super high contrast

627
00:24:40,960 --> 00:24:43,039
you can review your

628
00:24:43,039 --> 00:24:45,440
threat matrix here

629
00:24:45,440 --> 00:24:48,159
going to print

630
00:24:48,960 --> 00:24:50,720
if you want if you want colors and stuff

631
00:24:50,720 --> 00:24:52,880
you'll have to

632
00:24:52,880 --> 00:24:55,200
go over here to more settings

633
00:24:55,200 --> 00:24:57,279
print backgrounds

634
00:24:57,279 --> 00:24:58,720
you can kill the headers and footers if

635
00:24:58,720 --> 00:25:00,799
you want switch it over to landscape and

636
00:25:00,799 --> 00:25:02,799
now it's a lot prettier um

637
00:25:02,799 --> 00:25:07,120
but yeah that's how you do that

638
00:25:08,240 --> 00:25:11,240
and

639
00:25:15,440 --> 00:25:17,919
and then exporting we can also export as

640
00:25:17,919 --> 00:25:19,440
the

641
00:25:19,440 --> 00:25:22,320
um original deliverable uh a nice pretty

642
00:25:22,320 --> 00:25:24,799
spreadsheet um we're running in windows

643
00:25:24,799 --> 00:25:26,400
right or not we're running in linux

644
00:25:26,400 --> 00:25:28,159
right here so it's going to open up in

645
00:25:28,159 --> 00:25:30,960
open office and look kind of

646
00:25:30,960 --> 00:25:31,840
um

647
00:25:31,840 --> 00:25:33,200
kind of less and i've noticed that

648
00:25:33,200 --> 00:25:35,840
whenever opening this up in openoffice

649
00:25:35,840 --> 00:25:37,520
you kind of have to

650
00:25:37,520 --> 00:25:39,360
highlight some stuff and and get it to

651
00:25:39,360 --> 00:25:41,760
expand but when opening it in powerpoint

652
00:25:41,760 --> 00:25:44,320
like we normally would um

653
00:25:44,320 --> 00:25:46,240
it doesn't have that issue

654
00:25:46,240 --> 00:25:47,120
um

655
00:25:47,120 --> 00:25:48,960
but yeah there's the

656
00:25:48,960 --> 00:25:50,559
threat matrix

657
00:25:50,559 --> 00:25:53,120
um and like i mentioned uh these guys

658
00:25:53,120 --> 00:25:54,559
are

659
00:25:54,559 --> 00:25:57,039
clickable so whoever you hand this off

660
00:25:57,039 --> 00:25:59,520
to can click these and look and go oh

661
00:25:59,520 --> 00:26:01,120
okay um

662
00:26:01,120 --> 00:26:03,760
gathering victim network information

663
00:26:03,760 --> 00:26:05,120
you know what are the mitigations that

664
00:26:05,120 --> 00:26:08,879
we can go ahead and put in place

665
00:26:09,279 --> 00:26:10,720
so yeah

666
00:26:10,720 --> 00:26:12,240
um

667
00:26:12,240 --> 00:26:14,159
yeah i think that um

668
00:26:14,159 --> 00:26:16,080
kind of concludes

669
00:26:16,080 --> 00:26:19,919
the the demo portion let me see if i can

670
00:26:19,919 --> 00:26:23,120
get this back over to

671
00:26:23,120 --> 00:26:25,840
presenting

672
00:26:26,720 --> 00:26:30,159
yeah looks like it worked okay cool so

673
00:26:30,159 --> 00:26:32,159
yeah all i have left is really just you

674
00:26:32,159 --> 00:26:32,960
know

675
00:26:32,960 --> 00:26:34,799
if anybody has any questions feel free

676
00:26:34,799 --> 00:26:36,480
to reach out um

677
00:26:36,480 --> 00:26:38,240
you can check out our website

678
00:26:38,240 --> 00:26:40,640
blacklinersecurity.com

679
00:26:40,640 --> 00:26:42,960
we also i know i mentioned right hat one

680
00:26:42,960 --> 00:26:44,720
of our other tools but we have

681
00:26:44,720 --> 00:26:46,080
um

682
00:26:46,080 --> 00:26:49,039
a whole heaping load of uh

683
00:26:49,039 --> 00:26:51,440
free tools over at github

684
00:26:51,440 --> 00:26:53,440
slash black lantern security

685
00:26:53,440 --> 00:26:55,919
um this tool obviously over at under the

686
00:26:55,919 --> 00:26:57,200
matrix

687
00:26:57,200 --> 00:26:59,600
if you want to contact me um i've got a

688
00:26:59,600 --> 00:27:01,919
little website wfank.com

689
00:27:01,919 --> 00:27:03,360
uh you'd also find me on twitter

690
00:27:03,360 --> 00:27:05,120
debbiefrank14

691
00:27:05,120 --> 00:27:07,679
um so yeah i'll just kind of leave it

692
00:27:07,679 --> 00:27:09,440
open for questions if anybody has any

693
00:27:09,440 --> 00:27:13,799
but uh thanks for having me

