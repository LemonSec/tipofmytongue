1
00:00:05,839 --> 00:00:07,759
we're going to go ahead and get started

2
00:00:07,759 --> 00:00:09,280
here

3
00:00:09,280 --> 00:00:10,960
i just get a sound check that someone

4
00:00:10,960 --> 00:00:13,599
can hear me

5
00:00:14,000 --> 00:00:16,720
all right thank you very much

6
00:00:16,720 --> 00:00:18,480
uh so do you want to

7
00:00:18,480 --> 00:00:20,320
run to our sponsors real quick thank

8
00:00:20,320 --> 00:00:22,000
them for their support i know we just

9
00:00:22,000 --> 00:00:23,439
outlined them in track one but for those

10
00:00:23,439 --> 00:00:25,039
who maybe didn't join opening remarks we

11
00:00:25,039 --> 00:00:26,080
really couldn't do this without our

12
00:00:26,080 --> 00:00:28,320
sponsors today so really thankful for

13
00:00:28,320 --> 00:00:31,439
elliot davis fordless utilsec lucy

14
00:00:31,439 --> 00:00:34,559
secure ideas dutonomy checkpoint tech

15
00:00:34,559 --> 00:00:38,160
refresh fortinet craig hook security

16
00:00:38,160 --> 00:00:39,680
secure it

17
00:00:39,680 --> 00:00:42,879
corelight crowdstrike defcon kivu

18
00:00:42,879 --> 00:00:45,520
and north greenville university cyber

19
00:00:45,520 --> 00:00:47,200
security program so really thankful for

20
00:00:47,200 --> 00:00:48,480
all of them their support this year

21
00:00:48,480 --> 00:00:50,640
coming out and supporting us

22
00:00:50,640 --> 00:00:53,520
in our virtual b signs

23
00:00:53,520 --> 00:00:54,879
we're going to go ahead and get started

24
00:00:54,879 --> 00:00:56,399
since we're already five minutes late

25
00:00:56,399 --> 00:00:59,840
coming off opening remarks

26
00:01:00,399 --> 00:01:04,319
really appreciate the opportunity to

27
00:01:04,319 --> 00:01:06,880
speak today

28
00:01:06,880 --> 00:01:09,200
to kick us off so

29
00:01:09,200 --> 00:01:11,360
my name is ryan baisley i'm going to be

30
00:01:11,360 --> 00:01:12,880
our first speaker this morning then

31
00:01:12,880 --> 00:01:14,640
we'll we'll hand it over to the rest of

32
00:01:14,640 --> 00:01:16,960
the day

33
00:01:17,040 --> 00:01:19,040
talk today is lessons learned from my

34
00:01:19,040 --> 00:01:22,159
time in security operations i had the

35
00:01:22,159 --> 00:01:24,479
distinct privilege of doing some

36
00:01:24,479 --> 00:01:27,280
consulting work for two large life

37
00:01:27,280 --> 00:01:29,119
science organizations

38
00:01:29,119 --> 00:01:30,479
i really want to share some of the

39
00:01:30,479 --> 00:01:32,320
lessons learned today

40
00:01:32,320 --> 00:01:34,640
from my experience there

41
00:01:34,640 --> 00:01:37,360
this is definitely interactive and if

42
00:01:37,360 --> 00:01:39,280
you have any questions feel free to put

43
00:01:39,280 --> 00:01:40,799
them in the chat

44
00:01:40,799 --> 00:01:42,479
and then i will try to address those

45
00:01:42,479 --> 00:01:44,399
there at the end

46
00:01:44,399 --> 00:01:45,840
uh and if there's any comments or

47
00:01:45,840 --> 00:01:47,759
whatever also remember to use the

48
00:01:47,759 --> 00:01:50,479
discord for some chat and communication

49
00:01:50,479 --> 00:01:52,880
ongoing afterwards i'll be around

50
00:01:52,880 --> 00:01:54,640
throughout the day

51
00:01:54,640 --> 00:01:56,560
so look forward to that so we'll go

52
00:01:56,560 --> 00:01:58,000
ahead and get jump

53
00:01:58,000 --> 00:02:00,560
jumped in

54
00:02:00,560 --> 00:02:02,479
so just a quick intro many of you may

55
00:02:02,479 --> 00:02:04,240
not know who i am

56
00:02:04,240 --> 00:02:07,600
i'm a husband a father i am a consultant

57
00:02:07,600 --> 00:02:10,239
i consider myself a relationship builder

58
00:02:10,239 --> 00:02:11,760
i am a born-again christian so that

59
00:02:11,760 --> 00:02:13,599
really formulates all i do it's at the

60
00:02:13,599 --> 00:02:15,040
center there

61
00:02:15,040 --> 00:02:17,520
i'm a lifelong learner i love working

62
00:02:17,520 --> 00:02:19,280
with non-profits

63
00:02:19,280 --> 00:02:21,440
i am one of our b-sides greenville

64
00:02:21,440 --> 00:02:25,920
organizers and i love to travel

65
00:02:28,480 --> 00:02:29,599
so in consulting one of the

66
00:02:29,599 --> 00:02:31,599
opportunities i had was really defining

67
00:02:31,599 --> 00:02:33,599
a personal purpose and i thought this

68
00:02:33,599 --> 00:02:35,440
was important because it kind of sets up

69
00:02:35,440 --> 00:02:37,360
you know who i am what i do

70
00:02:37,360 --> 00:02:39,040
and drives into really the purpose of

71
00:02:39,040 --> 00:02:40,640
this talk and so

72
00:02:40,640 --> 00:02:42,800
really out my purpose is to find life's

73
00:02:42,800 --> 00:02:44,480
meaning so that we boldly reveal our

74
00:02:44,480 --> 00:02:46,879
true selves and one of my best i bring

75
00:02:46,879 --> 00:02:48,640
my purpose to life guided by a set of

76
00:02:48,640 --> 00:02:51,040
actions so i ask a lot of questions i

77
00:02:51,040 --> 00:02:52,959
try to encourage others and i try to

78
00:02:52,959 --> 00:02:56,160
serve others as much as possible

79
00:02:56,160 --> 00:02:58,319
and by living my purpose every day i

80
00:02:58,319 --> 00:03:00,720
actively build a world and i imagine a

81
00:03:00,720 --> 00:03:02,879
world in which people can seek out new

82
00:03:02,879 --> 00:03:04,159
opportunities that challenge their

83
00:03:04,159 --> 00:03:06,480
potential where people feel validated in

84
00:03:06,480 --> 00:03:08,319
their decision making after receiving

85
00:03:08,319 --> 00:03:10,640
counsel and being encouraged

86
00:03:10,640 --> 00:03:12,879
and that people consider thoughtfully on

87
00:03:12,879 --> 00:03:14,239
what they want and are empowered to

88
00:03:14,239 --> 00:03:15,840
pursue their desires

89
00:03:15,840 --> 00:03:17,599
and this talk today really is to try and

90
00:03:17,599 --> 00:03:19,440
help people maybe experience a side of

91
00:03:19,440 --> 00:03:21,280
security you know we get a lot of

92
00:03:21,280 --> 00:03:23,840
students in these in these conversations

93
00:03:23,840 --> 00:03:26,000
which really appreciate people who are

94
00:03:26,000 --> 00:03:27,760
trying to enter the field and people who

95
00:03:27,760 --> 00:03:29,280
are well into their career may be

96
00:03:29,280 --> 00:03:31,200
looking for a change and so i hope that

97
00:03:31,200 --> 00:03:33,200
some lessons from today

98
00:03:33,200 --> 00:03:34,720
can help you

99
00:03:34,720 --> 00:03:36,560
understand and maybe challenge that

100
00:03:36,560 --> 00:03:39,760
potential that you have

101
00:03:39,760 --> 00:03:41,200
so the purpose for today we're going to

102
00:03:41,200 --> 00:03:43,040
explore some of the lessons learned from

103
00:03:43,040 --> 00:03:44,879
security operations

104
00:03:44,879 --> 00:03:46,400
i'm going to share about

105
00:03:46,400 --> 00:03:48,400
the life i lived working in security

106
00:03:48,400 --> 00:03:49,680
operations

107
00:03:49,680 --> 00:03:50,799
and then at the end of the day we're

108
00:03:50,799 --> 00:03:52,159
going to try and encourage people maybe

109
00:03:52,159 --> 00:03:55,359
to give secops a try

110
00:03:56,959 --> 00:03:57,920
so

111
00:03:57,920 --> 00:03:59,120
the first lesson we're going to talk

112
00:03:59,120 --> 00:04:01,360
about is an operating model

113
00:04:01,360 --> 00:04:03,599
and the operating model is is really how

114
00:04:03,599 --> 00:04:05,360
an organization is structured and so

115
00:04:05,360 --> 00:04:06,720
like i said

116
00:04:06,720 --> 00:04:08,720
i had the opportunity to work at two

117
00:04:08,720 --> 00:04:12,080
life science organizations very large

118
00:04:12,080 --> 00:04:15,360
global entities and the first

119
00:04:15,360 --> 00:04:16,880
organization where i experienced

120
00:04:16,880 --> 00:04:18,320
security monitoring they had the

121
00:04:18,320 --> 00:04:20,320
following operating model

122
00:04:20,320 --> 00:04:23,040
so they had a u.s team lead and they had

123
00:04:23,040 --> 00:04:24,400
12 analysts

124
00:04:24,400 --> 00:04:26,400
using an outsourced sock from a leading

125
00:04:26,400 --> 00:04:30,479
sock provider they operated 24x7

126
00:04:30,479 --> 00:04:33,440
in the second organization i experienced

127
00:04:33,440 --> 00:04:35,360
they had a slightly different model

128
00:04:35,360 --> 00:04:37,040
where they actually had a u.s team lead

129
00:04:37,040 --> 00:04:39,680
still but then they had in-source

130
00:04:39,680 --> 00:04:41,360
analysts in

131
00:04:41,360 --> 00:04:43,680
what they call gdc's or global delivery

132
00:04:43,680 --> 00:04:44,639
centers

133
00:04:44,639 --> 00:04:47,040
and so they have four to eight analysts

134
00:04:47,040 --> 00:04:48,400
in mexico

135
00:04:48,400 --> 00:04:50,160
and they had four to eight analysts in

136
00:04:50,160 --> 00:04:53,040
india and each team would cover uh

137
00:04:53,040 --> 00:04:55,919
13 hours or so in mexico 14 hours in

138
00:04:55,919 --> 00:04:57,759
india just based on the time differences

139
00:04:57,759 --> 00:04:59,120
and such

140
00:04:59,120 --> 00:05:03,039
and this really shared service model

141
00:05:03,039 --> 00:05:04,960
they were all in the same place you know

142
00:05:04,960 --> 00:05:06,720
that was pre-covered once cove would

143
00:05:06,720 --> 00:05:09,840
happen they all went home

144
00:05:09,840 --> 00:05:11,840
but it was you know this shared delivery

145
00:05:11,840 --> 00:05:12,880
center

146
00:05:12,880 --> 00:05:14,400
was more than just security operations

147
00:05:14,400 --> 00:05:16,320
it was your networking team it was uh

148
00:05:16,320 --> 00:05:18,320
people who were over email

149
00:05:18,320 --> 00:05:20,000
and i found this really you know an

150
00:05:20,000 --> 00:05:21,520
interesting concept when i hadn't

151
00:05:21,520 --> 00:05:24,400
experienced before

152
00:05:24,400 --> 00:05:26,639
and so the second organization when i

153
00:05:26,639 --> 00:05:29,199
started they were doing this 24 by 7 by

154
00:05:29,199 --> 00:05:32,400
365 but one of the things that

155
00:05:32,400 --> 00:05:34,000
i encountered really quickly when i was

156
00:05:34,000 --> 00:05:36,479
there was they the organization had some

157
00:05:36,479 --> 00:05:38,880
some challenging retention issues i

158
00:05:38,880 --> 00:05:40,639
guess we could say and they actually had

159
00:05:40,639 --> 00:05:43,600
to move back to a 24x5 model and escape

160
00:05:43,600 --> 00:05:45,919
that those weekend days

161
00:05:45,919 --> 00:05:46,960
uh

162
00:05:46,960 --> 00:05:48,960
so i learned here

163
00:05:48,960 --> 00:05:50,880
that varying operating models can work

164
00:05:50,880 --> 00:05:53,120
whether in house or outsourcing they

165
00:05:53,120 --> 00:05:55,120
both operated well

166
00:05:55,120 --> 00:05:57,440
i did feel that the bond of having this

167
00:05:57,440 --> 00:05:59,199
in-house team

168
00:05:59,199 --> 00:06:01,520
was was much stronger with the team

169
00:06:01,520 --> 00:06:03,520
leads and with myself

170
00:06:03,520 --> 00:06:05,520
there was much more chemistry

171
00:06:05,520 --> 00:06:08,080
i felt the team operated at least in my

172
00:06:08,080 --> 00:06:09,440
opinion

173
00:06:09,440 --> 00:06:11,199
and from what i experienced at a higher

174
00:06:11,199 --> 00:06:13,039
level

175
00:06:13,039 --> 00:06:15,280
you know some of the challenges that

176
00:06:15,280 --> 00:06:17,840
these organizations faced both of them

177
00:06:17,840 --> 00:06:21,199
even in mexico romania india

178
00:06:21,199 --> 00:06:22,400
was

179
00:06:22,400 --> 00:06:24,560
we see this here in the us as well as as

180
00:06:24,560 --> 00:06:26,880
recruiting and retaining talent you know

181
00:06:26,880 --> 00:06:29,680
the going rate in mexico and india

182
00:06:29,680 --> 00:06:32,400
for talent had gone up significantly and

183
00:06:32,400 --> 00:06:34,000
the organization i was working with had

184
00:06:34,000 --> 00:06:36,400
faced some legacy hr challenges with

185
00:06:36,400 --> 00:06:39,680
finding uh equitable pay

186
00:06:39,680 --> 00:06:41,919
based on current data and so you know it

187
00:06:41,919 --> 00:06:43,840
was very people were finding that they

188
00:06:43,840 --> 00:06:45,840
could go out and make more somewhere

189
00:06:45,840 --> 00:06:46,800
else

190
00:06:46,800 --> 00:06:48,160
and so they were they were losing these

191
00:06:48,160 --> 00:06:49,280
people

192
00:06:49,280 --> 00:06:51,039
one other thing i found interesting was

193
00:06:51,039 --> 00:06:53,680
in india they actually have a 90-day

194
00:06:53,680 --> 00:06:55,120
notice period

195
00:06:55,120 --> 00:06:57,120
and so what you would you'd find

196
00:06:57,120 --> 00:06:58,400
happening is someone would give their

197
00:06:58,400 --> 00:06:59,840
notice

198
00:06:59,840 --> 00:07:01,199
and then they would go and they would

199
00:07:01,199 --> 00:07:03,039
shop around so they may give their

200
00:07:03,039 --> 00:07:05,360
notice and have an offer in hand and

201
00:07:05,360 --> 00:07:07,360
once they do that they start shopping

202
00:07:07,360 --> 00:07:08,639
around

203
00:07:08,639 --> 00:07:11,199
for for another offer that's higher

204
00:07:11,199 --> 00:07:12,800
and so you would find people who you

205
00:07:12,800 --> 00:07:14,479
think you had on the hook

206
00:07:14,479 --> 00:07:16,400
to to take your job or take an

207
00:07:16,400 --> 00:07:18,639
opportunity to open wreck

208
00:07:18,639 --> 00:07:19,919
and then they would be gone because

209
00:07:19,919 --> 00:07:21,440
they'd find something else that was more

210
00:07:21,440 --> 00:07:23,520
lucrative for them so it was something

211
00:07:23,520 --> 00:07:24,720
that was interesting i hadn't

212
00:07:24,720 --> 00:07:27,440
experienced before um due to that very

213
00:07:27,440 --> 00:07:31,840
lengthy notice period that's in india

214
00:07:34,800 --> 00:07:37,520
so the second lesson learned was really

215
00:07:37,520 --> 00:07:40,400
the importance of having process

216
00:07:40,400 --> 00:07:42,400
and in the second organization i worked

217
00:07:42,400 --> 00:07:43,599
with

218
00:07:43,599 --> 00:07:45,919
this was a lion's share of what i was

219
00:07:45,919 --> 00:07:48,240
responsible for doing so we were

220
00:07:48,240 --> 00:07:50,960
responsible for building these triage

221
00:07:50,960 --> 00:07:53,440
playbooks these were focused more on

222
00:07:53,440 --> 00:07:55,520
actioning alerts and trying to weed out

223
00:07:55,520 --> 00:07:58,479
the noise and known behavior we had

224
00:07:58,479 --> 00:08:01,520
created a known behavior onenote you

225
00:08:01,520 --> 00:08:03,440
could use any note taking tool that

226
00:08:03,440 --> 00:08:05,680
could be easily shared across the team

227
00:08:05,680 --> 00:08:07,520
but this known behavior onenote was

228
00:08:07,520 --> 00:08:09,919
something we used very regularly in

229
00:08:09,919 --> 00:08:11,680
triaging

230
00:08:11,680 --> 00:08:14,240
incidents in their edr platform

231
00:08:14,240 --> 00:08:16,479
included items like known executables

232
00:08:16,479 --> 00:08:18,479
that may flag something

233
00:08:18,479 --> 00:08:21,440
known programs internal red team boxes

234
00:08:21,440 --> 00:08:23,520
vulnerability boxes that you know if you

235
00:08:23,520 --> 00:08:25,199
saw something coming off it would you

236
00:08:25,199 --> 00:08:27,520
know light up like a christmas tree but

237
00:08:27,520 --> 00:08:30,400
really was internal activity

238
00:08:30,400 --> 00:08:34,080
we also had a known malicious behavior

239
00:08:34,080 --> 00:08:36,080
uh one note as well

240
00:08:36,080 --> 00:08:38,080
and we tracked in their

241
00:08:38,080 --> 00:08:40,640
behavior based on mitre and the attack

242
00:08:40,640 --> 00:08:42,799
framework what analysts would kind of

243
00:08:42,799 --> 00:08:46,080
review alerts against

244
00:08:46,080 --> 00:08:48,240
we also created these investigation

245
00:08:48,240 --> 00:08:50,240
playbooks and so these were focused more

246
00:08:50,240 --> 00:08:52,399
on deeper analysis

247
00:08:52,399 --> 00:08:54,080
but we had originally set out to match

248
00:08:54,080 --> 00:08:57,120
these categories outlined in the verizon

249
00:08:57,120 --> 00:08:59,279
data breach incident report

250
00:08:59,279 --> 00:09:01,680
we ended up scaling that back to

251
00:09:01,680 --> 00:09:03,680
roughly three playbooks that we felt

252
00:09:03,680 --> 00:09:06,959
like encompassed a majority of potential

253
00:09:06,959 --> 00:09:09,680
incidents and in our categories we ended

254
00:09:09,680 --> 00:09:12,080
up with malware gdos

255
00:09:12,080 --> 00:09:14,480
and a bucket of other

256
00:09:14,480 --> 00:09:16,880
and really our key we had a couple key

257
00:09:16,880 --> 00:09:19,200
questions to answer and it took us a bit

258
00:09:19,200 --> 00:09:21,519
of time to kind of fine-tune these and

259
00:09:21,519 --> 00:09:23,920
what we were trying to accomplish so

260
00:09:23,920 --> 00:09:27,120
our key questions we ended up with were

261
00:09:27,120 --> 00:09:29,600
is the rant is this ransomware or

262
00:09:29,600 --> 00:09:31,200
credential theft

263
00:09:31,200 --> 00:09:33,120
has the activity been automatically

264
00:09:33,120 --> 00:09:34,720
blocked by a tool

265
00:09:34,720 --> 00:09:36,720
is the activity new

266
00:09:36,720 --> 00:09:38,320
is the activity spreading or is it

267
00:09:38,320 --> 00:09:40,080
localized

268
00:09:40,080 --> 00:09:42,560
is the activity malicious

269
00:09:42,560 --> 00:09:44,399
what's the source

270
00:09:44,399 --> 00:09:46,880
and is the threat action internal or

271
00:09:46,880 --> 00:09:48,160
external

272
00:09:48,160 --> 00:09:50,320
and so we tried to formulate questions

273
00:09:50,320 --> 00:09:52,000
and processes without being too

274
00:09:52,000 --> 00:09:54,160
prescriptive for the analysts but enough

275
00:09:54,160 --> 00:09:56,080
to give them to try and march down these

276
00:09:56,080 --> 00:09:58,240
questions to identify if something

277
00:09:58,240 --> 00:09:59,760
really was

278
00:09:59,760 --> 00:10:01,600
malicious and needed to be actioned or

279
00:10:01,600 --> 00:10:04,600
quarantined

280
00:10:04,640 --> 00:10:06,079
the next thing we did is we created

281
00:10:06,079 --> 00:10:08,079
operations playbooks and these really

282
00:10:08,079 --> 00:10:10,399
focused on tool specific actions and

283
00:10:10,399 --> 00:10:12,079
tasks

284
00:10:12,079 --> 00:10:14,160
maybe better titled job aids in some

285
00:10:14,160 --> 00:10:15,839
organizations

286
00:10:15,839 --> 00:10:18,240
so we had a daily handoff you know

287
00:10:18,240 --> 00:10:20,560
between mexico and india that we had a

288
00:10:20,560 --> 00:10:22,959
defined process for

289
00:10:22,959 --> 00:10:25,760
servicenow how to enter tickets various

290
00:10:25,760 --> 00:10:28,720
security tools metrics and reporting

291
00:10:28,720 --> 00:10:32,000
and then non-standard software

292
00:10:32,000 --> 00:10:33,920
also developed some threat hunts they

293
00:10:33,920 --> 00:10:36,880
were focused on specific tools we had

294
00:10:36,880 --> 00:10:40,320
one for email threat hunting one for

295
00:10:40,320 --> 00:10:43,440
lol bins or living off the land binaries

296
00:10:43,440 --> 00:10:45,519
and we also had a specific one at the

297
00:10:45,519 --> 00:10:46,399
time

298
00:10:46,399 --> 00:10:48,720
there was a big

299
00:10:48,720 --> 00:10:51,040
influx of trick bot activity so we

300
00:10:51,040 --> 00:10:53,600
developed a specific trick bot threat

301
00:10:53,600 --> 00:10:54,480
hunt

302
00:10:54,480 --> 00:10:57,040
as that was a prime item if you remember

303
00:10:57,040 --> 00:10:59,680
back in about a year and a half ago

304
00:10:59,680 --> 00:11:00,959
against the health sciences

305
00:11:00,959 --> 00:11:02,640
organizations as things were picking up

306
00:11:02,640 --> 00:11:05,120
with covid

307
00:11:05,120 --> 00:11:06,800
one of the things i also

308
00:11:06,800 --> 00:11:08,399
actually learned this from one of my

309
00:11:08,399 --> 00:11:10,640
colleagues in india was having this

310
00:11:10,640 --> 00:11:13,360
concept and idea and document of an ir

311
00:11:13,360 --> 00:11:15,760
or a sock cover book

312
00:11:15,760 --> 00:11:17,760
and this was one item that we added late

313
00:11:17,760 --> 00:11:19,360
in the engagement

314
00:11:19,360 --> 00:11:21,920
and it was really a an operations guide

315
00:11:21,920 --> 00:11:23,360
that contained

316
00:11:23,360 --> 00:11:26,240
a list of everything a new individual

317
00:11:26,240 --> 00:11:27,360
might need

318
00:11:27,360 --> 00:11:28,399
so it was

319
00:11:28,399 --> 00:11:30,640
the perfect document for this new hired

320
00:11:30,640 --> 00:11:32,560
and contained you know the org chart it

321
00:11:32,560 --> 00:11:35,279
contained what tools were used

322
00:11:35,279 --> 00:11:38,079
documentation repositories who

323
00:11:38,079 --> 00:11:39,920
who was on the team where they were on

324
00:11:39,920 --> 00:11:41,040
the team

325
00:11:41,040 --> 00:11:43,040
because we we had found that you know we

326
00:11:43,040 --> 00:11:45,279
had a new hire come in in india

327
00:11:45,279 --> 00:11:47,680
so that person knew the india team

328
00:11:47,680 --> 00:11:49,360
fairly well

329
00:11:49,360 --> 00:11:51,519
but that person maybe had no clue who

330
00:11:51,519 --> 00:11:53,600
the person in the mexico team was

331
00:11:53,600 --> 00:11:55,040
because this organization the reporting

332
00:11:55,040 --> 00:11:56,880
structures didn't actually go up to the

333
00:11:56,880 --> 00:11:59,040
team leads they had managers in those

334
00:11:59,040 --> 00:12:01,600
delivery centers where everyone reported

335
00:12:01,600 --> 00:12:03,279
so we found this to be really helpful in

336
00:12:03,279 --> 00:12:04,720
people getting acclimated to the

337
00:12:04,720 --> 00:12:08,079
environment really quickly

338
00:12:08,320 --> 00:12:10,399
so lessons learned here

339
00:12:10,399 --> 00:12:13,839
you cannot document enough especially

340
00:12:13,839 --> 00:12:15,680
once the team

341
00:12:15,680 --> 00:12:18,480
lost these experienced analysts from

342
00:12:18,480 --> 00:12:20,079
that attrition that they've gone through

343
00:12:20,079 --> 00:12:22,399
in retention issues that documentation

344
00:12:22,399 --> 00:12:24,000
played a key role in keeping the team

345
00:12:24,000 --> 00:12:26,240
engaged and up-to-date and what was

346
00:12:26,240 --> 00:12:29,120
going on and what they needed to do

347
00:12:29,120 --> 00:12:31,200
really we need to be thorough and think

348
00:12:31,200 --> 00:12:32,880
about what the new hires are going to

349
00:12:32,880 --> 00:12:35,360
need you know we knew once someone got

350
00:12:35,360 --> 00:12:37,279
into the swing of things you know they

351
00:12:37,279 --> 00:12:38,399
were going to be able to go through the

352
00:12:38,399 --> 00:12:40,079
investigation it was going to be kind of

353
00:12:40,079 --> 00:12:42,320
that you know rote memory they were

354
00:12:42,320 --> 00:12:43,519
going to know

355
00:12:43,519 --> 00:12:44,800
but we had to provide that initial

356
00:12:44,800 --> 00:12:47,120
foundation

357
00:12:47,120 --> 00:12:49,200
then my colleague had these three terms

358
00:12:49,200 --> 00:12:51,600
that you know they stick with me abc

359
00:12:51,600 --> 00:12:55,120
accuracy brevity and clarity keep those

360
00:12:55,120 --> 00:12:56,560
principles in mind when you're working

361
00:12:56,560 --> 00:12:59,760
through your documentation

362
00:12:59,839 --> 00:13:01,120
one of the challenges we faced was

363
00:13:01,120 --> 00:13:03,279
knowing just simply what documentation

364
00:13:03,279 --> 00:13:04,880
to nix and what to keep and where to

365
00:13:04,880 --> 00:13:07,120
condense and where to combine

366
00:13:07,120 --> 00:13:08,639
you know people find this you have so

367
00:13:08,639 --> 00:13:10,720
much documentation sometimes

368
00:13:10,720 --> 00:13:13,440
how do you make it actionable and usable

369
00:13:13,440 --> 00:13:15,519
this was a challenge that we faced and

370
00:13:15,519 --> 00:13:17,440
we decided to like i said consolidate

371
00:13:17,440 --> 00:13:19,040
some of that documentation into just

372
00:13:19,040 --> 00:13:22,880
those three investigation playbooks

373
00:13:22,880 --> 00:13:24,639
uh so here's here's i got a couple

374
00:13:24,639 --> 00:13:26,720
examples of just some quick

375
00:13:26,720 --> 00:13:29,360
process flow charts that we developed

376
00:13:29,360 --> 00:13:31,120
we found that having different flow

377
00:13:31,120 --> 00:13:33,120
charts was was very helpful for an

378
00:13:33,120 --> 00:13:35,440
analyst who would visually represent and

379
00:13:35,440 --> 00:13:37,360
be able to identify the information they

380
00:13:37,360 --> 00:13:38,240
needed

381
00:13:38,240 --> 00:13:40,560
this was underpinned by

382
00:13:40,560 --> 00:13:42,240
some of that more extensive written

383
00:13:42,240 --> 00:13:44,320
documentation

384
00:13:44,320 --> 00:13:46,320
i've seen this in multiple organizations

385
00:13:46,320 --> 00:13:48,560
and how they do that i had a great

386
00:13:48,560 --> 00:13:50,560
colleague who was able to develop these

387
00:13:50,560 --> 00:13:52,720
uh with with great precision and

388
00:13:52,720 --> 00:13:54,880
accuracy

389
00:13:54,880 --> 00:13:56,880
so this was one we had developed for uh

390
00:13:56,880 --> 00:14:00,240
the edr platform

391
00:14:01,120 --> 00:14:02,880
and then this is one we had developed

392
00:14:02,880 --> 00:14:05,680
for uh the messaging platform and how to

393
00:14:05,680 --> 00:14:09,040
evaluate email

394
00:14:12,959 --> 00:14:14,320
next thing

395
00:14:14,320 --> 00:14:16,240
that we're gonna talk about is is simple

396
00:14:16,240 --> 00:14:18,000
reporting and keeping track of things

397
00:14:18,000 --> 00:14:19,680
there's so much information that's going

398
00:14:19,680 --> 00:14:20,480
on

399
00:14:20,480 --> 00:14:22,480
um and so we had to come up with some

400
00:14:22,480 --> 00:14:24,639
ways to to track everything that was

401
00:14:24,639 --> 00:14:26,320
going on and one of the big tools we

402
00:14:26,320 --> 00:14:28,959
used was onenote we used this for major

403
00:14:28,959 --> 00:14:31,920
incidents where we would track after a

404
00:14:31,920 --> 00:14:34,800
triage what was happening and realizing

405
00:14:34,800 --> 00:14:36,959
if something was bigger than a normal

406
00:14:36,959 --> 00:14:39,040
incident it could be triaged out or

407
00:14:39,040 --> 00:14:40,639
investigated in

408
00:14:40,639 --> 00:14:43,040
15 20 30 minutes

409
00:14:43,040 --> 00:14:45,680
with maybe a little larger of an impact

410
00:14:45,680 --> 00:14:47,440
we'd open up a onenote so we'd start

411
00:14:47,440 --> 00:14:49,199
timelining what happened we'd have a

412
00:14:49,199 --> 00:14:52,000
decision log or a tree really almost

413
00:14:52,000 --> 00:14:53,600
thinking of like a

414
00:14:53,600 --> 00:14:56,000
a raid blog basically you know what

415
00:14:56,000 --> 00:14:57,920
risks are we facing

416
00:14:57,920 --> 00:14:59,040
what are potential issues what

417
00:14:59,040 --> 00:15:00,880
assumptions are we making up to that

418
00:15:00,880 --> 00:15:02,959
point and then what decisions and

419
00:15:02,959 --> 00:15:06,079
actions are we taking

420
00:15:06,079 --> 00:15:08,160
we draft incident summaries

421
00:15:08,160 --> 00:15:09,680
it was a great place the team could add

422
00:15:09,680 --> 00:15:11,920
information draft those incident

423
00:15:11,920 --> 00:15:14,240
summaries that could then be elevated up

424
00:15:14,240 --> 00:15:17,600
to senior leadership

425
00:15:17,839 --> 00:15:19,760
we also had daily handoff reporting this

426
00:15:19,760 --> 00:15:21,360
was really a summary document of

427
00:15:21,360 --> 00:15:23,279
incidents found during the day what

428
00:15:23,279 --> 00:15:25,279
hunts the team was doing as far as

429
00:15:25,279 --> 00:15:26,880
threat hunts what needed to be handed

430
00:15:26,880 --> 00:15:28,399
off and picked up

431
00:15:28,399 --> 00:15:30,720
again we used one note for this found it

432
00:15:30,720 --> 00:15:32,800
to be really great we would go through

433
00:15:32,800 --> 00:15:35,040
those one notes for the daily handoffs

434
00:15:35,040 --> 00:15:36,800
when we had our daily shift handoff

435
00:15:36,800 --> 00:15:38,079
calls

436
00:15:38,079 --> 00:15:39,600
and the team would kind of keep a pulse

437
00:15:39,600 --> 00:15:42,560
on what was going on of you that way

438
00:15:42,560 --> 00:15:44,639
yeah most organizations you know

439
00:15:44,639 --> 00:15:47,040
tracking stuff via tickets servicenow

440
00:15:47,040 --> 00:15:50,160
cherwell jira whatever it may be

441
00:15:50,160 --> 00:15:53,120
keeping that stuff updated with with

442
00:15:53,120 --> 00:15:55,519
information if you're able to to build

443
00:15:55,519 --> 00:15:57,920
that out and kind of dice out certain

444
00:15:57,920 --> 00:16:00,399
fields that makes reporting so much

445
00:16:00,399 --> 00:16:02,959
easier

446
00:16:03,279 --> 00:16:05,440
we also had a daily shift checklist so

447
00:16:05,440 --> 00:16:07,600
this would actually supplement our

448
00:16:07,600 --> 00:16:10,000
operations guide on the daily handoff it

449
00:16:10,000 --> 00:16:12,399
was really just a checklist of kind of a

450
00:16:12,399 --> 00:16:14,560
prioritized list of where the team

451
00:16:14,560 --> 00:16:16,880
should should start their day

452
00:16:16,880 --> 00:16:18,800
check the sock hotline check any

453
00:16:18,800 --> 00:16:20,959
relevant email inboxes if you have a

454
00:16:20,959 --> 00:16:22,720
security mailbox

455
00:16:22,720 --> 00:16:26,720
uh reviewing tools in certain orders

456
00:16:26,720 --> 00:16:28,480
and then we had a weekly status update

457
00:16:28,480 --> 00:16:29,519
so we had the daily that we had the

458
00:16:29,519 --> 00:16:30,800
weekly and the weekly was a little bit

459
00:16:30,800 --> 00:16:32,959
higher level a little bit elevated

460
00:16:32,959 --> 00:16:34,639
so we gather highlights from the week we

461
00:16:34,639 --> 00:16:37,839
talk about maybe hr people development

462
00:16:37,839 --> 00:16:39,440
we'd review any new threat intel that

463
00:16:39,440 --> 00:16:42,720
came across from their internal cti team

464
00:16:42,720 --> 00:16:44,800
we'd go over items of interest and then

465
00:16:44,800 --> 00:16:47,600
if there were any itops related issues

466
00:16:47,600 --> 00:16:51,519
we would discuss those as well

467
00:16:51,519 --> 00:16:53,839
so lessons learned here

468
00:16:53,839 --> 00:16:55,279
much can happen over the course of the

469
00:16:55,279 --> 00:16:57,680
day let alone a week or a month we found

470
00:16:57,680 --> 00:17:00,399
that this onenote really helped us

471
00:17:00,399 --> 00:17:01,839
you know kind of keep track and it was

472
00:17:01,839 --> 00:17:03,360
really easily searchable to go back

473
00:17:03,360 --> 00:17:05,359
through and look for a specific host

474
00:17:05,359 --> 00:17:08,559
name or or look for a application

475
00:17:08,559 --> 00:17:10,000
name

476
00:17:10,000 --> 00:17:11,359
and and maybe what incident then we

477
00:17:11,359 --> 00:17:13,199
could go back to the edr tool or we

478
00:17:13,199 --> 00:17:15,119
could then take use that as a launching

479
00:17:15,119 --> 00:17:17,359
point into the ticketing tool to go do a

480
00:17:17,359 --> 00:17:19,599
deeper investigation get some historical

481
00:17:19,599 --> 00:17:22,400
information on something

482
00:17:22,400 --> 00:17:24,400
look for anomalous metrics we're

483
00:17:24,400 --> 00:17:26,000
tracking all that metric look for

484
00:17:26,000 --> 00:17:27,919
something that's anomalous what is rare

485
00:17:27,919 --> 00:17:30,240
in your environment

486
00:17:30,240 --> 00:17:31,679
encourage your teams to document

487
00:17:31,679 --> 00:17:33,840
extensively what they find during the

488
00:17:33,840 --> 00:17:36,160
investigations put as much information

489
00:17:36,160 --> 00:17:38,000
you know as feasible

490
00:17:38,000 --> 00:17:40,640
and that doesn't impact you know speed

491
00:17:40,640 --> 00:17:43,280
of execution in the tickets because

492
00:17:43,280 --> 00:17:45,200
you'll find that information later to be

493
00:17:45,200 --> 00:17:48,160
super valuable

494
00:17:48,160 --> 00:17:49,840
challenges we face

495
00:17:49,840 --> 00:17:52,000
documentation getting analysts to

496
00:17:52,000 --> 00:17:54,240
actually update with extensive notes

497
00:17:54,240 --> 00:17:56,320
throughout the investigation they'd keep

498
00:17:56,320 --> 00:17:58,880
an incident report on their desktop you

499
00:17:58,880 --> 00:17:59,919
know they'd be going through their thing

500
00:17:59,919 --> 00:18:01,679
and they'd pick it up the next day but

501
00:18:01,679 --> 00:18:03,440
sometimes they'd fail to update what

502
00:18:03,440 --> 00:18:05,360
they'd found in that report into the

503
00:18:05,360 --> 00:18:07,280
ticket and so during handoff or a

504
00:18:07,280 --> 00:18:09,840
weekend or a holiday

505
00:18:09,840 --> 00:18:11,919
uh you know some of this handover

506
00:18:11,919 --> 00:18:14,400
information that would be good for the

507
00:18:14,400 --> 00:18:15,919
person they wouldn't have it because

508
00:18:15,919 --> 00:18:19,760
it'd be on the desktop of the analyst

509
00:18:22,559 --> 00:18:25,440
transition to operations this was uh

510
00:18:25,440 --> 00:18:27,120
one i actually learned at the first

511
00:18:27,120 --> 00:18:28,720
organization i was we were doing a

512
00:18:28,720 --> 00:18:30,160
managed

513
00:18:30,160 --> 00:18:32,080
uh mssp

514
00:18:32,080 --> 00:18:34,000
migration basically

515
00:18:34,000 --> 00:18:36,320
it merged with two companies and so we

516
00:18:36,320 --> 00:18:38,400
had to find a way to

517
00:18:38,400 --> 00:18:40,080
figure out everything that they managed

518
00:18:40,080 --> 00:18:41,679
and then moving over to the new

519
00:18:41,679 --> 00:18:43,280
organization

520
00:18:43,280 --> 00:18:44,640
and so we developed this thing called

521
00:18:44,640 --> 00:18:47,679
tops or transition to operations

522
00:18:47,679 --> 00:18:48,880
and so

523
00:18:48,880 --> 00:18:51,600
what we it was an excel spreadsheet it

524
00:18:51,600 --> 00:18:54,640
lists out each service offering each

525
00:18:54,640 --> 00:18:56,720
you know service area

526
00:18:56,720 --> 00:18:58,480
what the product was

527
00:18:58,480 --> 00:19:00,320
and then we would just you know track it

528
00:19:00,320 --> 00:19:01,440
across

529
00:19:01,440 --> 00:19:03,760
when we migrated it to the new

530
00:19:03,760 --> 00:19:05,200
organization

531
00:19:05,200 --> 00:19:07,679
so what does tops include weld includes

532
00:19:07,679 --> 00:19:10,000
things like architecture diagrams wiring

533
00:19:10,000 --> 00:19:13,200
diagrams ip and url information

534
00:19:13,200 --> 00:19:16,320
vendor and admin manuals

535
00:19:16,320 --> 00:19:18,160
important processes such as health

536
00:19:18,160 --> 00:19:20,559
checks break fix config and change

537
00:19:20,559 --> 00:19:22,640
management patch management

538
00:19:22,640 --> 00:19:25,440
user management you know any quotes that

539
00:19:25,440 --> 00:19:27,919
were going back and forth copy of backup

540
00:19:27,919 --> 00:19:29,360
configurations if we were talking about

541
00:19:29,360 --> 00:19:32,960
a product like a firewall or uh any type

542
00:19:32,960 --> 00:19:34,880
of casbi tool

543
00:19:34,880 --> 00:19:36,880
we'd schedule functionality training

544
00:19:36,880 --> 00:19:38,799
between the two teams to make sure that

545
00:19:38,799 --> 00:19:41,039
team b who was coming on board knew what

546
00:19:41,039 --> 00:19:42,320
the world was going on in the

547
00:19:42,320 --> 00:19:45,039
organization

548
00:19:45,200 --> 00:19:47,520
and we kind of built this out into into

549
00:19:47,520 --> 00:19:50,320
phases so there was really the plan

550
00:19:50,320 --> 00:19:52,320
phase thinking from a project management

551
00:19:52,320 --> 00:19:54,240
perspective we had the plan we were

552
00:19:54,240 --> 00:19:56,320
building out how to transition what the

553
00:19:56,320 --> 00:19:58,240
products were going to be what end

554
00:19:58,240 --> 00:20:00,080
products we wanted to have and then

555
00:20:00,080 --> 00:20:02,000
there was this transition phase and we

556
00:20:02,000 --> 00:20:04,559
really did it in two parts i'd say

557
00:20:04,559 --> 00:20:06,400
so we did what we called a passive

558
00:20:06,400 --> 00:20:08,559
parallel run where both organizations

559
00:20:08,559 --> 00:20:11,679
were running at the same time

560
00:20:11,679 --> 00:20:14,480
uh organization a the primary

561
00:20:14,480 --> 00:20:17,120
uh kind of still doing the day-to-day

562
00:20:17,120 --> 00:20:19,600
but organization b was was kind of

563
00:20:19,600 --> 00:20:21,679
watching over the shoulder

564
00:20:21,679 --> 00:20:22,880
and then once we were ready to

565
00:20:22,880 --> 00:20:24,720
transition we moved into what we called

566
00:20:24,720 --> 00:20:27,360
hyper care and so this was really kind

567
00:20:27,360 --> 00:20:28,720
of the transition point where everything

568
00:20:28,720 --> 00:20:30,240
moved to b

569
00:20:30,240 --> 00:20:32,159
and they were running it and a was now

570
00:20:32,159 --> 00:20:34,240
there kind of looking over the shoulder

571
00:20:34,240 --> 00:20:35,840
until the term date of the contract

572
00:20:35,840 --> 00:20:39,439
where a would no longer be there

573
00:20:39,679 --> 00:20:41,520
here's just a quick glance at you know

574
00:20:41,520 --> 00:20:43,440
what our tops looked like you know

575
00:20:43,440 --> 00:20:45,840
simple spreadsheet gives you some ideas

576
00:20:45,840 --> 00:20:47,120
of what you can

577
00:20:47,120 --> 00:20:49,200
can do there

578
00:20:49,200 --> 00:20:51,200
and help track to make sure that your

579
00:20:51,200 --> 00:20:53,360
next transition of a tool

580
00:20:53,360 --> 00:20:55,039
or a service

581
00:20:55,039 --> 00:20:58,200
is successful

582
00:21:01,760 --> 00:21:02,880
next thing we're talking about is

583
00:21:02,880 --> 00:21:04,480
training people training is super

584
00:21:04,480 --> 00:21:05,600
important

585
00:21:05,600 --> 00:21:07,919
um and what we did here at the second

586
00:21:07,919 --> 00:21:09,840
organization i worked with is we

587
00:21:09,840 --> 00:21:12,799
actually developed a skills matrix a

588
00:21:12,799 --> 00:21:15,360
training catalog you could say and we

589
00:21:15,360 --> 00:21:17,919
had listed out 20 different skills and

590
00:21:17,919 --> 00:21:19,520
we developed a skills catalog and then

591
00:21:19,520 --> 00:21:22,000
we took those skills and we mapped

592
00:21:22,000 --> 00:21:23,520
opportunities

593
00:21:23,520 --> 00:21:25,840
and training content free training

594
00:21:25,840 --> 00:21:28,159
content to them you know you see the

595
00:21:28,159 --> 00:21:31,200
discord and stuff there's uh

596
00:21:31,200 --> 00:21:32,080
there's

597
00:21:32,080 --> 00:21:33,600
there's sand stuff and some of that's

598
00:21:33,600 --> 00:21:35,039
expensive and free but they're offering

599
00:21:35,039 --> 00:21:37,440
free courses now this is like

600
00:21:37,440 --> 00:21:40,159
b-sides material and stuff maybe from a

601
00:21:40,159 --> 00:21:42,559
mandiant conference that's out there

602
00:21:42,559 --> 00:21:45,200
and so we built that into these kind of

603
00:21:45,200 --> 00:21:47,840
big high level areas skills and then the

604
00:21:47,840 --> 00:21:51,600
matching training contents go with it

605
00:21:51,600 --> 00:21:52,799
and so

606
00:21:52,799 --> 00:21:55,120
let me show you an example here

607
00:21:55,120 --> 00:21:58,840
of kind of what we did

608
00:21:59,360 --> 00:22:00,720
so it gives you an idea this was a

609
00:22:00,720 --> 00:22:02,559
catalog then we would deliver to the

610
00:22:02,559 --> 00:22:03,440
team

611
00:22:03,440 --> 00:22:05,919
and then as they had time you know we

612
00:22:05,919 --> 00:22:08,400
had set out some required training

613
00:22:08,400 --> 00:22:09,840
you know so they could go through

614
00:22:09,840 --> 00:22:12,880
certain of these and then

615
00:22:12,880 --> 00:22:14,799
if they had extra time or if they wanted

616
00:22:14,799 --> 00:22:16,880
to go learn on their own this was

617
00:22:16,880 --> 00:22:18,640
additional content we found that based

618
00:22:18,640 --> 00:22:20,559
on these skill areas

619
00:22:20,559 --> 00:22:22,880
they could work through and match to to

620
00:22:22,880 --> 00:22:25,520
learn what the skill was

621
00:22:25,520 --> 00:22:27,679
the team also did

622
00:22:27,679 --> 00:22:29,440
external training now one of the

623
00:22:29,440 --> 00:22:31,760
challenges we did find was

624
00:22:31,760 --> 00:22:33,840
so the the training provider was based

625
00:22:33,840 --> 00:22:36,000
here in the u.s

626
00:22:36,000 --> 00:22:37,679
we had people in mexico we had people in

627
00:22:37,679 --> 00:22:39,840
india so to get everyone on the same

628
00:22:39,840 --> 00:22:42,080
training schedule we really had to kind

629
00:22:42,080 --> 00:22:44,640
of flip the india schedule

630
00:22:44,640 --> 00:22:45,360
to

631
00:22:45,360 --> 00:22:47,440
to a later day

632
00:22:47,440 --> 00:22:48,559
and

633
00:22:48,559 --> 00:22:51,039
we would start at 6 central

634
00:22:51,039 --> 00:22:52,480
in the morning

635
00:22:52,480 --> 00:22:55,280
6 a.m central and then we would go to

636
00:22:55,280 --> 00:22:58,240
it was like noon or two

637
00:22:58,240 --> 00:22:59,679
but noon or

638
00:22:59,679 --> 00:23:02,400
noon or two i don't remember which time

639
00:23:02,400 --> 00:23:04,080
in india it's like midnight for those

640
00:23:04,080 --> 00:23:06,840
folks so they have really late evenings

641
00:23:06,840 --> 00:23:09,039
so obviously

642
00:23:09,039 --> 00:23:11,280
that was what we had to do to make that

643
00:23:11,280 --> 00:23:13,760
work for both teams

644
00:23:13,760 --> 00:23:16,000
definitely a challenge we faced

645
00:23:16,000 --> 00:23:17,840
we did i would say the lesson learned

646
00:23:17,840 --> 00:23:20,320
there is you know figure out that right

647
00:23:20,320 --> 00:23:22,320
timing if if you're using those type of

648
00:23:22,320 --> 00:23:24,480
delivery models or operating models with

649
00:23:24,480 --> 00:23:26,240
people in geographic areas and you have

650
00:23:26,240 --> 00:23:28,080
to do it that way

651
00:23:28,080 --> 00:23:29,600
but also make sure that those folks

652
00:23:29,600 --> 00:23:31,600
don't have to work so when we did

653
00:23:31,600 --> 00:23:34,240
training they did training eight hours

654
00:23:34,240 --> 00:23:36,960
for training in the day labs afterwards

655
00:23:36,960 --> 00:23:38,240
and they were done

656
00:23:38,240 --> 00:23:39,200
we

657
00:23:39,200 --> 00:23:40,720
everyone supported one another on the

658
00:23:40,720 --> 00:23:42,080
team where

659
00:23:42,080 --> 00:23:43,840
those who weren't working or taking or

660
00:23:43,840 --> 00:23:45,840
those who weren't training they were the

661
00:23:45,840 --> 00:23:47,600
ones working that week and then when

662
00:23:47,600 --> 00:23:48,960
they got the opportunity to train the

663
00:23:48,960 --> 00:23:51,279
following week we flipped it so they

664
00:23:51,279 --> 00:23:53,120
never had to worry about what was going

665
00:23:53,120 --> 00:23:56,399
on in the estate

666
00:24:00,080 --> 00:24:01,440
next thing we're going to talk about is

667
00:24:01,440 --> 00:24:03,200
the the life of the packet and i

668
00:24:03,200 --> 00:24:05,520
actually had the opportunity to

669
00:24:05,520 --> 00:24:08,720
do this on some internal initiatives

670
00:24:08,720 --> 00:24:11,200
and i learned that

671
00:24:11,200 --> 00:24:12,720
this gentleman who kind of developed

672
00:24:12,720 --> 00:24:14,320
this concept

673
00:24:14,320 --> 00:24:16,799
he used to run the cisco cisco stock and

674
00:24:16,799 --> 00:24:18,720
he termed at the life of the packet

675
00:24:18,720 --> 00:24:21,679
and so you break down your framework

676
00:24:21,679 --> 00:24:23,760
into really three areas

677
00:24:23,760 --> 00:24:25,200
operational

678
00:24:25,200 --> 00:24:27,840
tactical and strategic

679
00:24:27,840 --> 00:24:28,640
so

680
00:24:28,640 --> 00:24:29,919
operational

681
00:24:29,919 --> 00:24:32,799
you map each of your data sources to an

682
00:24:32,799 --> 00:24:35,279
outcome what do you hope to gain what do

683
00:24:35,279 --> 00:24:36,880
you hope to happen

684
00:24:36,880 --> 00:24:38,960
so for example and when i get to the

685
00:24:38,960 --> 00:24:40,480
next slide

686
00:24:40,480 --> 00:24:42,080
you'll see it and it'll make a little

687
00:24:42,080 --> 00:24:43,679
more sense i think

688
00:24:43,679 --> 00:24:45,520
but for like your network operations you

689
00:24:45,520 --> 00:24:47,200
have your cisco stuff

690
00:24:47,200 --> 00:24:49,679
or your juniper stuff for it operations

691
00:24:49,679 --> 00:24:51,440
you have your servers you have domain

692
00:24:51,440 --> 00:24:53,279
controllers

693
00:24:53,279 --> 00:24:55,120
for security you have

694
00:24:55,120 --> 00:24:56,960
your endpoint your endpoint data is

695
00:24:56,960 --> 00:25:00,000
coming in firewall logs network activity

696
00:25:00,000 --> 00:25:03,120
uh windows logs

697
00:25:03,120 --> 00:25:05,200
i jumped there

698
00:25:05,200 --> 00:25:06,799
hold on

699
00:25:06,799 --> 00:25:08,320
there we go

700
00:25:08,320 --> 00:25:10,559
um

701
00:25:11,120 --> 00:25:13,360
windows log on who's logging on you know

702
00:25:13,360 --> 00:25:16,960
your your 4624 is your 46 25s process is

703
00:25:16,960 --> 00:25:18,720
being created on a host

704
00:25:18,720 --> 00:25:20,960
you have your tactical stuff okay so

705
00:25:20,960 --> 00:25:22,559
it's kind of that next level so think of

706
00:25:22,559 --> 00:25:23,840
it going across

707
00:25:23,840 --> 00:25:26,080
uh vertically on your screen

708
00:25:26,080 --> 00:25:27,600
tactical is really that time to

709
00:25:27,600 --> 00:25:30,320
detection so you you have the right data

710
00:25:30,320 --> 00:25:32,880
sources now you got to map those to the

711
00:25:32,880 --> 00:25:35,039
right skill set so you got to have your

712
00:25:35,039 --> 00:25:36,400
windows expert you got to have your

713
00:25:36,400 --> 00:25:39,039
firewall expert so you map that skill

714
00:25:39,039 --> 00:25:42,159
set and then you map that to the outcome

715
00:25:42,159 --> 00:25:45,279
okay so going back to the netapp cisco

716
00:25:45,279 --> 00:25:46,720
what information are you going to gather

717
00:25:46,720 --> 00:25:48,880
there you're going to gather ip address

718
00:25:48,880 --> 00:25:50,000
port

719
00:25:50,000 --> 00:25:51,760
from your servers and your domain

720
00:25:51,760 --> 00:25:53,600
controllers you're going to gather dns

721
00:25:53,600 --> 00:25:57,279
information a dhcp account info asset

722
00:25:57,279 --> 00:25:59,760
and subnet information

723
00:25:59,760 --> 00:26:01,840
from your endpoints you'll gather post

724
00:26:01,840 --> 00:26:05,600
names hashes urls

725
00:26:05,600 --> 00:26:06,720
all right

726
00:26:06,720 --> 00:26:09,520
so then you move into that strategic

727
00:26:09,520 --> 00:26:10,400
bucket

728
00:26:10,400 --> 00:26:12,960
this is your time to mitigation

729
00:26:12,960 --> 00:26:15,120
and this is where you work to automate

730
00:26:15,120 --> 00:26:19,840
the known and investigate the unknown

731
00:26:21,200 --> 00:26:23,039
and then he had these uh

732
00:26:23,039 --> 00:26:25,039
three vectors of threats that he would

733
00:26:25,039 --> 00:26:26,720
talk about so you can only have three

734
00:26:26,720 --> 00:26:28,400
vectors of threats

735
00:26:28,400 --> 00:26:30,880
you can have internal to internal

736
00:26:30,880 --> 00:26:33,039
internal to external

737
00:26:33,039 --> 00:26:35,440
or external to internal

738
00:26:35,440 --> 00:26:36,720
anytime you're talking about a threat

739
00:26:36,720 --> 00:26:38,960
it's going to be one of those

740
00:26:38,960 --> 00:26:41,919
three vectors

741
00:26:42,880 --> 00:26:46,720
all right so here's a here's a view

742
00:26:46,720 --> 00:26:48,799
of life of the packet okay so you see

743
00:26:48,799 --> 00:26:50,240
across the top

744
00:26:50,240 --> 00:26:52,880
this is a huge huge vizio sheet

745
00:26:52,880 --> 00:26:55,039
um so it doesn't

746
00:26:55,039 --> 00:26:56,880
accomplish all of it but you see your

747
00:26:56,880 --> 00:26:58,400
net op stuff so you got your cisco you

748
00:26:58,400 --> 00:27:00,799
got you know your various tools

749
00:27:00,799 --> 00:27:03,039
you got your it ops you got your servers

750
00:27:03,039 --> 00:27:04,880
domain controllers and then

751
00:27:04,880 --> 00:27:06,400
all of the information that kind of

752
00:27:06,400 --> 00:27:07,919
feeds into that you're feeding that into

753
00:27:07,919 --> 00:27:09,120
your sim

754
00:27:09,120 --> 00:27:11,360
that helps you make the the tactical

755
00:27:11,360 --> 00:27:12,720
discussions you know you got your

756
00:27:12,720 --> 00:27:14,720
information

757
00:27:14,720 --> 00:27:17,279
domains ports ips

758
00:27:17,279 --> 00:27:19,039
statuses

759
00:27:19,039 --> 00:27:21,600
what domain what's the dns and you can

760
00:27:21,600 --> 00:27:24,080
move that into you know alerts case

761
00:27:24,080 --> 00:27:26,399
numbers and then that's where you move

762
00:27:26,399 --> 00:27:28,960
into the strategic you know what can you

763
00:27:28,960 --> 00:27:31,760
automate if you're remediating stuff and

764
00:27:31,760 --> 00:27:35,799
what do you need to investigate

765
00:27:40,240 --> 00:27:42,960
i think this is my final

766
00:27:42,960 --> 00:27:45,919
item here this is being introspective

767
00:27:45,919 --> 00:27:48,159
with data

768
00:27:48,159 --> 00:27:49,200
so

769
00:27:49,200 --> 00:27:52,240
in the second organization i worked with

770
00:27:52,240 --> 00:27:55,440
really we had we had all these processes

771
00:27:55,440 --> 00:27:57,120
one of the things we really tried to

772
00:27:57,120 --> 00:27:59,679
dive into is looking into the data

773
00:27:59,679 --> 00:28:01,919
what types of alerts were we getting

774
00:28:01,919 --> 00:28:04,000
what were the hosts what hosts were

775
00:28:04,000 --> 00:28:05,600
receiving the alerts

776
00:28:05,600 --> 00:28:07,360
were there specific geographies that

777
00:28:07,360 --> 00:28:09,679
were receiving more alerts than others

778
00:28:09,679 --> 00:28:11,840
or were there specific business units or

779
00:28:11,840 --> 00:28:14,000
even down to the people

780
00:28:14,000 --> 00:28:16,159
of where people were receiving alerts or

781
00:28:16,159 --> 00:28:18,320
detections

782
00:28:18,320 --> 00:28:19,840
and then we tried to figure out if there

783
00:28:19,840 --> 00:28:21,679
were any trends

784
00:28:21,679 --> 00:28:24,000
so one of the things we did

785
00:28:24,000 --> 00:28:26,880
is trying to figure out what was rare in

786
00:28:26,880 --> 00:28:29,120
the environment what incurred

787
00:28:29,120 --> 00:28:30,399
very very little

788
00:28:30,399 --> 00:28:31,840
and so one of these items we did was we

789
00:28:31,840 --> 00:28:32,880
looked at

790
00:28:32,880 --> 00:28:35,440
lol bins or these living off the land

791
00:28:35,440 --> 00:28:37,200
binaries of what occurred very

792
00:28:37,200 --> 00:28:40,159
infrequently in the environment

793
00:28:40,159 --> 00:28:42,640
and if we found one we would do an

794
00:28:42,640 --> 00:28:44,480
investigation so

795
00:28:44,480 --> 00:28:45,679
something like powershell in your

796
00:28:45,679 --> 00:28:49,200
environment most likely is happening

797
00:28:49,200 --> 00:28:51,120
so many times a day that if you just

798
00:28:51,120 --> 00:28:53,279
tried to filter out power shell it's not

799
00:28:53,279 --> 00:28:55,600
going to be actionable

800
00:28:55,600 --> 00:28:59,600
but maybe something like at.exe

801
00:28:59,600 --> 00:29:01,360
or bits admin

802
00:29:01,360 --> 00:29:04,000
occurs once in 30 days why does that

803
00:29:04,000 --> 00:29:05,039
occur

804
00:29:05,039 --> 00:29:07,200
every 30 days is it a specific host does

805
00:29:07,200 --> 00:29:08,559
it jump around

806
00:29:08,559 --> 00:29:11,200
or is it really an adversary

807
00:29:11,200 --> 00:29:12,480
so

808
00:29:12,480 --> 00:29:13,679
one of the other things we looked at

809
00:29:13,679 --> 00:29:16,159
were potentially ips or domain names

810
00:29:16,159 --> 00:29:17,520
that are common

811
00:29:17,520 --> 00:29:18,960
so looking at

812
00:29:18,960 --> 00:29:22,480
long domain names or if something was

813
00:29:22,480 --> 00:29:25,200
say in

814
00:29:25,360 --> 00:29:28,559
like cert util calling out to an ip you

815
00:29:28,559 --> 00:29:31,039
know those would be very uh uncommon

816
00:29:31,039 --> 00:29:33,279
behaviors in the lol bins

817
00:29:33,279 --> 00:29:35,679
those could be potentially malicious and

818
00:29:35,679 --> 00:29:37,360
so we would look for those rare items

819
00:29:37,360 --> 00:29:39,679
and try and filter those out

820
00:29:39,679 --> 00:29:42,320
so this goes back to documenting those

821
00:29:42,320 --> 00:29:45,039
alerts types locations

822
00:29:45,039 --> 00:29:46,720
and making sure to document that thread

823
00:29:46,720 --> 00:29:48,399
intel over time you may have something

824
00:29:48,399 --> 00:29:51,039
that doesn't look right now or doesn't

825
00:29:51,039 --> 00:29:52,880
fit a profile now but maybe down the

826
00:29:52,880 --> 00:29:54,240
road it's something you see in your

827
00:29:54,240 --> 00:29:56,799
environment

828
00:29:58,080 --> 00:30:00,080
challenges we faced here

829
00:30:00,080 --> 00:30:01,919
finding rare can be really hard in a

830
00:30:01,919 --> 00:30:04,559
large environment if especially if your

831
00:30:04,559 --> 00:30:06,399
teams don't know

832
00:30:06,399 --> 00:30:09,200
what good or bad looks like

833
00:30:09,200 --> 00:30:10,880
thankfully this organization we did have

834
00:30:10,880 --> 00:30:12,960
one individual who was a kind of the

835
00:30:12,960 --> 00:30:14,720
internal red team

836
00:30:14,720 --> 00:30:16,960
and so he kind of he coached us along on

837
00:30:16,960 --> 00:30:18,399
things he would do

838
00:30:18,399 --> 00:30:21,120
uh processes he would use we were going

839
00:30:21,120 --> 00:30:23,440
through purple team exercises and trying

840
00:30:23,440 --> 00:30:24,799
to find those

841
00:30:24,799 --> 00:30:26,399
detections

842
00:30:26,399 --> 00:30:27,200
in

843
00:30:27,200 --> 00:30:28,399
the

844
00:30:28,399 --> 00:30:30,960
in the edr tool and then we talked about

845
00:30:30,960 --> 00:30:33,520
what we did and so one of these items

846
00:30:33,520 --> 00:30:36,640
was obviously base64 coded power shell

847
00:30:36,640 --> 00:30:39,760
but not all base64 encoded power shell

848
00:30:39,760 --> 00:30:41,679
is bad you know some of it's used by

849
00:30:41,679 --> 00:30:43,679
system administrators to do legitimate

850
00:30:43,679 --> 00:30:46,240
things based on you know long

851
00:30:46,240 --> 00:30:47,760
complex

852
00:30:47,760 --> 00:30:49,679
commands they need to run

853
00:30:49,679 --> 00:30:51,360
so what we did with that is we made a

854
00:30:51,360 --> 00:30:54,480
list of known good encoded strings and

855
00:30:54,480 --> 00:30:56,559
then once you're kind of investigating

856
00:30:56,559 --> 00:30:58,080
that you can say oh yeah those start

857
00:30:58,080 --> 00:30:59,600
with the first four end with the last

858
00:30:59,600 --> 00:31:00,880
four

859
00:31:00,880 --> 00:31:04,159
you know that's that's known good

860
00:31:04,159 --> 00:31:05,919
but then we'd also those ones that we

861
00:31:05,919 --> 00:31:07,519
didn't know those would be the ones we'd

862
00:31:07,519 --> 00:31:09,919
have to throw into cyber chef or some

863
00:31:09,919 --> 00:31:12,000
other tool to decode

864
00:31:12,000 --> 00:31:14,960
and see what was actually happening

865
00:31:14,960 --> 00:31:17,120
you know know how frequently something

866
00:31:17,120 --> 00:31:20,559
like invoke expression or iex is being

867
00:31:20,559 --> 00:31:21,919
used in your environment if you're able

868
00:31:21,919 --> 00:31:25,039
to search at a command line level

869
00:31:25,039 --> 00:31:29,200
looking for things that accompany string

870
00:31:29,200 --> 00:31:30,880
and then one of the ones we also did was

871
00:31:30,880 --> 00:31:33,919
looking at run dll32

872
00:31:33,919 --> 00:31:37,039
so run dll32 is if it

873
00:31:37,039 --> 00:31:40,000
if you're starting a dll

874
00:31:40,000 --> 00:31:41,760
through the command line which is

875
00:31:41,760 --> 00:31:42,880
typically

876
00:31:42,880 --> 00:31:44,080
abnormal

877
00:31:44,080 --> 00:31:48,880
it has to include the word start or

878
00:31:48,880 --> 00:31:51,600
space star and so we could formulate a

879
00:31:51,600 --> 00:31:53,200
command

880
00:31:53,200 --> 00:31:55,760
in the edr tool to

881
00:31:55,760 --> 00:31:59,200
you know look for the binary run dll32

882
00:31:59,200 --> 00:32:01,679
and then include command line start or

883
00:32:01,679 --> 00:32:02,880
space start

884
00:32:02,880 --> 00:32:04,399
we were able to find some you know

885
00:32:04,399 --> 00:32:05,600
potentially

886
00:32:05,600 --> 00:32:08,080
malicious things that way and have the

887
00:32:08,080 --> 00:32:11,439
teams investigate further

888
00:32:13,360 --> 00:32:15,840
so this is just a simple

889
00:32:15,840 --> 00:32:18,000
you know we listed out all the binaries

890
00:32:18,000 --> 00:32:19,519
and we

891
00:32:19,519 --> 00:32:22,159
uh developed searches for them this maps

892
00:32:22,159 --> 00:32:24,240
to the lol bin project you can find it

893
00:32:24,240 --> 00:32:25,840
out on github

894
00:32:25,840 --> 00:32:29,120
um cisco's got an article right up about

895
00:32:29,120 --> 00:32:31,760
top 13 binaries used by adversaries it's

896
00:32:31,760 --> 00:32:33,200
a few years old

897
00:32:33,200 --> 00:32:34,799
but still it's got some good information

898
00:32:34,799 --> 00:32:36,000
in it

899
00:32:36,000 --> 00:32:37,600
and then what we do is we go there and

900
00:32:37,600 --> 00:32:39,760
you see the far right side you see the

901
00:32:39,760 --> 00:32:42,799
volume so how often do this occur in the

902
00:32:42,799 --> 00:32:43,919
environment

903
00:32:43,919 --> 00:32:45,840
and so we'd run a search like that you

904
00:32:45,840 --> 00:32:48,000
know it includes multiple

905
00:32:48,000 --> 00:32:50,399
binaries there but we'd look for file

906
00:32:50,399 --> 00:32:51,679
name and command line we may have a

907
00:32:51,679 --> 00:32:53,200
couple and it would be a quick run

908
00:32:53,200 --> 00:32:54,559
through on the day

909
00:32:54,559 --> 00:32:58,000
you know anything look malicious here

910
00:32:58,000 --> 00:33:00,000
so

911
00:33:00,000 --> 00:33:03,120
that uh that concludes

912
00:33:03,120 --> 00:33:05,760
the the talk for this morning

913
00:33:05,760 --> 00:33:06,720
um

914
00:33:06,720 --> 00:33:09,360
any questions come up anything stand out

915
00:33:09,360 --> 00:33:10,720
to you

916
00:33:10,720 --> 00:33:12,000
anything

917
00:33:12,000 --> 00:33:14,159
as a nugget maybe you'll take back on

918
00:33:14,159 --> 00:33:16,080
monday to your teams from a lesson

919
00:33:16,080 --> 00:33:17,519
learned

920
00:33:17,519 --> 00:33:19,360
that you'd like to share with the group

921
00:33:19,360 --> 00:33:21,840
i really do appreciate everyone's time

922
00:33:21,840 --> 00:33:23,120
this morning thank you for the

923
00:33:23,120 --> 00:33:25,760
opportunity

924
00:33:25,760 --> 00:33:28,320
to speak

925
00:33:28,399 --> 00:33:31,279
any questions

926
00:33:31,519 --> 00:33:35,200
let me read back through the uh

927
00:33:35,600 --> 00:33:39,719
the discord here real quick

928
00:33:44,480 --> 00:33:47,840
cmap tools is a free tool for flowcharts

929
00:33:47,840 --> 00:33:49,519
and concept maps if you don't have

930
00:33:49,519 --> 00:33:53,080
access to vizio

931
00:33:59,039 --> 00:34:02,399
check the chat here

932
00:34:03,440 --> 00:34:05,200
quantum has a strong onenote

933
00:34:05,200 --> 00:34:07,679
documentation program yep

934
00:34:07,679 --> 00:34:10,000
i it could be evernote it could be one

935
00:34:10,000 --> 00:34:12,000
onenote so simple these days it ties

936
00:34:12,000 --> 00:34:13,918
into uh

937
00:34:13,918 --> 00:34:15,760
you know teams

938
00:34:15,760 --> 00:34:17,040
uh

939
00:34:17,040 --> 00:34:19,119
thick clients on your computer we found

940
00:34:19,119 --> 00:34:20,639
that especially

941
00:34:20,639 --> 00:34:21,918
you know especially if you're going

942
00:34:21,918 --> 00:34:23,280
through an incident

943
00:34:23,280 --> 00:34:25,359
you know you may think you have

944
00:34:25,359 --> 00:34:27,119
compromise in your environment one

945
00:34:27,119 --> 00:34:28,879
note's a simple thing you could easily

946
00:34:28,879 --> 00:34:31,679
stand up if you're in a disconnected 365

947
00:34:31,679 --> 00:34:33,440
tenant or you need to stand up a

948
00:34:33,440 --> 00:34:35,199
secondary tenant

949
00:34:35,199 --> 00:34:36,560
to run an incident or if you have

950
00:34:36,560 --> 00:34:38,639
certain tools in place that the team

951
00:34:38,639 --> 00:34:40,159
could quickly

952
00:34:40,159 --> 00:34:42,079
stand up start writing down notes what's

953
00:34:42,079 --> 00:34:43,119
going on

954
00:34:43,119 --> 00:34:44,000
um

955
00:34:44,000 --> 00:34:45,359
i don't know if i found something better

956
00:34:45,359 --> 00:34:49,679
than one note to date yet

957
00:34:49,679 --> 00:34:51,918
it's really easy to and the other thing

958
00:34:51,918 --> 00:34:53,040
like i said

959
00:34:53,040 --> 00:34:54,960
going back and searching because the

960
00:34:54,960 --> 00:34:56,719
team when they would document incidents

961
00:34:56,719 --> 00:34:58,640
in that daily handoff we would kind of

962
00:34:58,640 --> 00:35:00,240
have them write out just a one-liner on

963
00:35:00,240 --> 00:35:02,880
incidents you know host name

964
00:35:02,880 --> 00:35:03,680
uh

965
00:35:03,680 --> 00:35:05,119
you know application that may have

966
00:35:05,119 --> 00:35:07,359
gotten flagged being able to quickly go

967
00:35:07,359 --> 00:35:09,040
into onenote and type out that

968
00:35:09,040 --> 00:35:10,960
application name and see if it's

969
00:35:10,960 --> 00:35:12,880
occurred in previous days or previous

970
00:35:12,880 --> 00:35:14,960
weeks or if it's something that incurred

971
00:35:14,960 --> 00:35:17,040
three months ago

972
00:35:17,040 --> 00:35:19,119
you know was a great jumping point to

973
00:35:19,119 --> 00:35:21,680
reference a servicenow ticket

974
00:35:21,680 --> 00:35:24,399
and go find

975
00:35:27,280 --> 00:35:28,720
all right we'll really appreciate

976
00:35:28,720 --> 00:35:31,720
everyone

