1
00:00:04,940 --> 00:00:10,410
you

2
00:00:06,980 --> 00:00:13,049
all right good morning all hope everyone

3
00:00:10,410 --> 00:00:15,059
is doing well my name is Matt Costner

4
00:00:13,049 --> 00:00:17,430
and I am one of the four internet SCS in

5
00:00:15,059 --> 00:00:19,080
the South Carolina Territory I'm

6
00:00:17,430 --> 00:00:20,100
actually located in the Greenville South

7
00:00:19,080 --> 00:00:22,770
Carolina area

8
00:00:20,100 --> 00:00:24,779
Simpsonville to be exact and I've been

9
00:00:22,770 --> 00:00:27,080
with four net for a little over three

10
00:00:24,779 --> 00:00:27,080
years

11
00:00:29,130 --> 00:00:33,579
so before we get started I would be

12
00:00:31,779 --> 00:00:35,500
remiss if I did not introduce the rest

13
00:00:33,579 --> 00:00:38,260
of the four Dannette field and support

14
00:00:35,500 --> 00:00:40,540
teams for South Carolina depending on

15
00:00:38,260 --> 00:00:42,399
your company's line of business you will

16
00:00:40,540 --> 00:00:45,100
align with an account team represented

17
00:00:42,399 --> 00:00:46,750
on this slide as the special thanks to

18
00:00:45,100 --> 00:00:49,930
the marketing and channel teams for

19
00:00:46,750 --> 00:00:51,760
making this event happen some of you may

20
00:00:49,930 --> 00:00:53,949
remember that for net sponsored the post

21
00:00:51,760 --> 00:00:56,680
conference festivities at sparetime last

22
00:00:53,949 --> 00:00:59,290
year since we were unable to recreate

23
00:00:56,680 --> 00:01:00,399
this activity in the current climate we

24
00:00:59,290 --> 00:01:03,420
have another offering that I will

25
00:01:00,399 --> 00:01:03,420
announce at the end of the demonstration

26
00:01:07,740 --> 00:01:12,220
today I wanted to take some time to talk

27
00:01:10,479 --> 00:01:15,700
about a new technology segment that is

28
00:01:12,220 --> 00:01:17,380
often overlooked security operations is

29
00:01:15,700 --> 00:01:21,460
achieved through multiple products

30
00:01:17,380 --> 00:01:23,800
working in tandem today we are going to

31
00:01:21,460 --> 00:01:25,928
concentrate on just one of those it's a

32
00:01:23,800 --> 00:01:31,000
product that we've coined for two

33
00:01:25,929 --> 00:01:32,490
deceptor so first a little bit of

34
00:01:31,000 --> 00:01:36,340
background

35
00:01:32,490 --> 00:01:38,740
according to punim ins 2019 study they

36
00:01:36,340 --> 00:01:41,200
found the global average total cost of a

37
00:01:38,740 --> 00:01:45,850
data breach was three point nine two

38
00:01:41,200 --> 00:01:47,829
million dollars for the US alone the

39
00:01:45,850 --> 00:01:50,829
average total cost of a data breach was

40
00:01:47,829 --> 00:01:53,798
eight point two million dollars this is

41
00:01:50,829 --> 00:01:57,699
a huge impact to any organization of any

42
00:01:53,799 --> 00:02:00,189
size to dig deeper on the contributing

43
00:01:57,700 --> 00:02:04,030
factors to a breach we learn from

44
00:02:00,189 --> 00:02:06,630
Verizon's 2019 data breach report that

45
00:02:04,030 --> 00:02:08,649
of all breaches that organizations faced

46
00:02:06,630 --> 00:02:10,929
two-thirds can be attributed to

47
00:02:08,649 --> 00:02:12,850
organized crime that are motivated

48
00:02:10,929 --> 00:02:15,760
financially in launching attacks against

49
00:02:12,850 --> 00:02:17,890
organizations while the remaining

50
00:02:15,760 --> 00:02:21,940
one-third are from the organization's

51
00:02:17,890 --> 00:02:25,779
sysadmin or end-user community these are

52
00:02:21,940 --> 00:02:28,720
the often overlooked insider threats and

53
00:02:25,780 --> 00:02:30,459
what continues to be a trend is that it

54
00:02:28,720 --> 00:02:33,040
only takes minutes for an initial

55
00:02:30,459 --> 00:02:35,769
compromise of an asset and subsequent

56
00:02:33,040 --> 00:02:38,569
exfiltration of data once the breach is

57
00:02:35,769 --> 00:02:40,760
successful in 56

58
00:02:38,569 --> 00:02:43,219
percent of organizations took months to

59
00:02:40,760 --> 00:02:45,040
discover the breach and then additional

60
00:02:43,219 --> 00:02:51,799
time was needed to take appropriate

61
00:02:45,040 --> 00:02:53,629
remediation steps so why is it a

62
00:02:51,799 --> 00:02:56,480
challenge for organizations to discover

63
00:02:53,629 --> 00:02:59,048
these threats earlier due to the

64
00:02:56,480 --> 00:03:01,488
continued shortage of InfoSec talent

65
00:02:59,049 --> 00:03:04,250
overburden staff can't effectively

66
00:03:01,489 --> 00:03:07,129
respond to thousands of alerts received

67
00:03:04,250 --> 00:03:10,370
per day which is paralyzing the response

68
00:03:07,129 --> 00:03:15,530
to actual threats way too much noise is

69
00:03:10,370 --> 00:03:18,260
happening inside of the sock in the

70
00:03:15,530 --> 00:03:20,870
management of 30-plus different security

71
00:03:18,260 --> 00:03:23,090
products or solutions in a security

72
00:03:20,870 --> 00:03:25,370
architecture that may not naturally

73
00:03:23,090 --> 00:03:27,829
share threat intelligence creates an

74
00:03:25,370 --> 00:03:35,329
obstacle to a timely overall response

75
00:03:27,829 --> 00:03:37,430
strategy to a breach for Dannette

76
00:03:35,329 --> 00:03:40,400
addresses these challenges by offering

77
00:03:37,430 --> 00:03:44,169
security solutions for endpoints access

78
00:03:40,400 --> 00:03:48,199
points network elements the data center

79
00:03:44,169 --> 00:03:50,060
applications and the cloud these

80
00:03:48,199 --> 00:03:54,109
components are designed to work together

81
00:03:50,060 --> 00:03:57,290
as a cohesive security fabric that can

82
00:03:54,109 --> 00:03:59,689
be integrated analyzed and managed to

83
00:03:57,290 --> 00:04:02,870
provide end-to-end protection for your

84
00:03:59,689 --> 00:04:05,750
network we are going to focus on

85
00:04:02,870 --> 00:04:07,579
security operation solutions the

86
00:04:05,750 --> 00:04:09,819
Fortinet security operations solutions

87
00:04:07,579 --> 00:04:12,790
deliver advanced threat intelligence and

88
00:04:09,819 --> 00:04:15,379
technologies to prevent detect and

89
00:04:12,790 --> 00:04:18,529
respond to traditional and advanced

90
00:04:15,379 --> 00:04:21,289
threats they also aid with compliance

91
00:04:18,529 --> 00:04:23,828
and can help raise overall security

92
00:04:21,289 --> 00:04:23,829
awareness

93
00:04:26,800 --> 00:04:32,650
most security operations are tasked with

94
00:04:29,540 --> 00:04:36,230
for general Golz prevent cyberattacks

95
00:04:32,650 --> 00:04:40,239
detect advanced threats respond to

96
00:04:36,230 --> 00:04:43,040
incidents and demonstrate compliance

97
00:04:40,240 --> 00:04:44,960
with the tools listed we can increase

98
00:04:43,040 --> 00:04:47,600
security by keeping pace with the

99
00:04:44,960 --> 00:04:50,000
evolving threat landscape consolidate

100
00:04:47,600 --> 00:04:52,280
the tools necessary to minimize missed

101
00:04:50,000 --> 00:04:53,780
events and enrich our threat

102
00:04:52,280 --> 00:04:56,599
intelligence with aaaahhhhh driven

103
00:04:53,780 --> 00:05:00,950
threat feeds of malicious files IP

104
00:04:56,600 --> 00:05:02,420
addresses and more for Donets 40

105
00:05:00,950 --> 00:05:03,409
deceptor technology provides

106
00:05:02,420 --> 00:05:06,320
best-in-class

107
00:05:03,410 --> 00:05:08,960
defense and protection with security

108
00:05:06,320 --> 00:05:10,810
tripwires which trigger automated

109
00:05:08,960 --> 00:05:13,760
responses against malware and

110
00:05:10,810 --> 00:05:18,410
unauthorized users looking to access and

111
00:05:13,760 --> 00:05:21,080
exploit network resources prevention and

112
00:05:18,410 --> 00:05:24,230
detection are not the only components to

113
00:05:21,080 --> 00:05:26,240
having good security posture responding

114
00:05:24,230 --> 00:05:30,740
and containing an incident is still a

115
00:05:26,240 --> 00:05:33,290
top priority for CISOs in 2020 however

116
00:05:30,740 --> 00:05:35,390
response time is detecting at detecting

117
00:05:33,290 --> 00:05:39,740
breaches is still taking companies

118
00:05:35,390 --> 00:05:42,710
around 200 days using the security

119
00:05:39,740 --> 00:05:44,900
fabric security operations can gain the

120
00:05:42,710 --> 00:05:47,900
ability to respond to incidents across

121
00:05:44,900 --> 00:05:50,690
Fortinet and non fortinet components

122
00:05:47,900 --> 00:05:54,950
with automated actions through flexible

123
00:05:50,690 --> 00:05:55,840
workflows and advanced triggers and all

124
00:05:54,950 --> 00:05:59,200
through a single pane of glass

125
00:05:55,840 --> 00:05:59,200
management console

126
00:06:01,360 --> 00:06:06,710
to break down how security solutions

127
00:06:04,400 --> 00:06:09,280
deal with threats it is common to find

128
00:06:06,710 --> 00:06:11,960
there is a set of products or solutions

129
00:06:09,280 --> 00:06:15,469
that deal with insider threats and

130
00:06:11,960 --> 00:06:17,960
another for external threats it would be

131
00:06:15,470 --> 00:06:19,610
optimal if there was a solution that

132
00:06:17,960 --> 00:06:27,349
could protect against both external and

133
00:06:19,610 --> 00:06:29,420
internal threats at the same time for

134
00:06:27,350 --> 00:06:31,850
DES deceptor combines the notion of a

135
00:06:29,420 --> 00:06:35,570
honey pot with threat analytics and

136
00:06:31,850 --> 00:06:38,600
threat mitigation into one specifically

137
00:06:35,570 --> 00:06:41,480
for the deceptor creates decoys to lure

138
00:06:38,600 --> 00:06:42,950
attackers and inspects their behavior to

139
00:06:41,480 --> 00:06:45,680
generate accurate threat intelligence

140
00:06:42,950 --> 00:06:49,580
and to block both external and internal

141
00:06:45,680 --> 00:06:52,070
attacks Fortinet is the first major

142
00:06:49,580 --> 00:06:54,680
security vendor to offer deception

143
00:06:52,070 --> 00:06:56,810
technology and the offering is available

144
00:06:54,680 --> 00:07:01,340
as an appliance as well as a virtual

145
00:06:56,810 --> 00:07:03,140
form factor furthermore for two deceptor

146
00:07:01,340 --> 00:07:05,659
is integrated with the FortiGate

147
00:07:03,140 --> 00:07:08,270
firewall as part of the automated threat

148
00:07:05,660 --> 00:07:10,550
response process and with for two sim

149
00:07:08,270 --> 00:07:13,210
and for two analyzer for broader

150
00:07:10,550 --> 00:07:13,210
visibility

151
00:07:15,900 --> 00:07:21,250
normally the first endpoint an attacker

152
00:07:18,760 --> 00:07:24,520
compromises is only used to gain access

153
00:07:21,250 --> 00:07:27,160
to the organization's network once

154
00:07:24,520 --> 00:07:29,460
compromised and controlled the attacker

155
00:07:27,160 --> 00:07:32,110
uses this host to explore the network

156
00:07:29,460 --> 00:07:34,539
find their next target and move from

157
00:07:32,110 --> 00:07:37,330
host to host as they search for the data

158
00:07:34,540 --> 00:07:40,900
and assets that they are after for their

159
00:07:37,330 --> 00:07:43,630
attack campaigns as part of this lateral

160
00:07:40,900 --> 00:07:46,419
movement for two deceptor redirects

161
00:07:43,630 --> 00:07:48,909
attacks to decoy and real devices

162
00:07:46,420 --> 00:07:52,270
equipped with lures that appear

163
00:07:48,910 --> 00:07:56,050
indistinguishable from real IT and OT

164
00:07:52,270 --> 00:07:58,930
assets these decode these decoys are

165
00:07:56,050 --> 00:08:01,480
highly interactive this allows

166
00:07:58,930 --> 00:08:03,670
organizations to detect they have been

167
00:08:01,480 --> 00:08:07,300
compromised before the attacker has a

168
00:08:03,670 --> 00:08:09,910
chance to achieve their goal one key

169
00:08:07,300 --> 00:08:12,370
advantage of 40 deceptor is that it

170
00:08:09,910 --> 00:08:14,680
allows organizations to centrally manage

171
00:08:12,370 --> 00:08:18,820
and automate the deployment of pre-built

172
00:08:14,680 --> 00:08:21,610
or custom decoy VMs and lures which

173
00:08:18,820 --> 00:08:29,140
results in a rapid deployment usually

174
00:08:21,610 --> 00:08:31,420
within a single day to eliminate the

175
00:08:29,140 --> 00:08:34,240
initial compromised and breach well

176
00:08:31,420 --> 00:08:37,150
dwell time and also the challenge with

177
00:08:34,240 --> 00:08:39,130
too many alerts that create noise for to

178
00:08:37,150 --> 00:08:41,949
deceptor acts as an early warning system

179
00:08:39,130 --> 00:08:44,530
that exposes an attackers malicious

180
00:08:41,950 --> 00:08:47,500
intent that translates to immediate

181
00:08:44,530 --> 00:08:51,069
alerts sent to the security teams or sim

182
00:08:47,500 --> 00:08:53,650
for review and validation for to

183
00:08:51,070 --> 00:08:56,620
deceptor applies analytics to a

184
00:08:53,650 --> 00:08:58,930
consolidated set of security events then

185
00:08:56,620 --> 00:09:01,270
correlates and attributes them to the

186
00:08:58,930 --> 00:09:03,760
threat actor along with a timeline of

187
00:09:01,270 --> 00:09:06,550
activities which helps bring to the

188
00:09:03,760 --> 00:09:09,120
surface the larger threat campaign in a

189
00:09:06,550 --> 00:09:09,120
single pane of glass

190
00:09:12,660 --> 00:09:17,180
to help the lien

191
00:09:14,550 --> 00:09:20,790
InfoSec team scale and create a seamless

192
00:09:17,180 --> 00:09:23,550
consolidated threat response for two

193
00:09:20,790 --> 00:09:25,800
deceptor allows security analysts to

194
00:09:23,550 --> 00:09:28,349
manually investigate and apply manual

195
00:09:25,800 --> 00:09:31,140
remediation or automatically block these

196
00:09:28,350 --> 00:09:34,290
attacks based on severity before actual

197
00:09:31,140 --> 00:09:41,220
damage occurs via an integration with

198
00:09:34,290 --> 00:09:43,170
the FortiGate firewall to provide for

199
00:09:41,220 --> 00:09:46,079
contextual intelligence for the

200
00:09:43,170 --> 00:09:48,660
attackers activity for the deceptor uses

201
00:09:46,079 --> 00:09:51,689
an anti reconnaissance and an anti

202
00:09:48,660 --> 00:09:53,459
exploit service that comprised of three

203
00:09:51,689 --> 00:09:57,689
detection engines that are powered by

204
00:09:53,459 --> 00:10:01,829
four two guard labs the AI enable

205
00:09:57,689 --> 00:10:05,579
anti-malware service the AI enabled web

206
00:10:01,829 --> 00:10:08,670
filtering service and lastly IPS

207
00:10:05,579 --> 00:10:11,599
detection these services allow the

208
00:10:08,670 --> 00:10:14,329
detection of malware malicious URLs

209
00:10:11,600 --> 00:10:18,689
exploits and network based attacks

210
00:10:14,329 --> 00:10:20,519
observed within the decoys it allows the

211
00:10:18,689 --> 00:10:23,250
security team to drill down to a threat

212
00:10:20,519 --> 00:10:26,569
campaign core latest activities and

213
00:10:23,250 --> 00:10:28,920
accelerate analysis of the threat

214
00:10:26,569 --> 00:10:31,680
integration with the FortiGate devices

215
00:10:28,920 --> 00:10:38,819
allows for an automated mitigation of

216
00:10:31,680 --> 00:10:41,339
that threaten for DES deceptor is very

217
00:10:38,819 --> 00:10:43,290
flexible allowing organizations to

218
00:10:41,339 --> 00:10:45,269
deploy the solution either as an

219
00:10:43,290 --> 00:10:48,629
appliance or a virtual form factor

220
00:10:45,269 --> 00:10:51,269
on-premise all the while the network of

221
00:10:48,629 --> 00:10:54,480
decoys can cover the entire organization

222
00:10:51,269 --> 00:10:57,509
from branch locations to the campus data

223
00:10:54,480 --> 00:11:00,629
center public cloud and even the

224
00:10:57,509 --> 00:11:02,850
operational technology networks the

225
00:11:00,629 --> 00:11:06,209
deception vm's offered today simulate

226
00:11:02,850 --> 00:11:09,949
Windows Linux industrial control systems

227
00:11:06,209 --> 00:11:09,949
and other SCADA devices

228
00:11:12,250 --> 00:11:18,110
so in summary organizations have to deal

229
00:11:15,860 --> 00:11:21,860
with breaches like an originator from

230
00:11:18,110 --> 00:11:23,570
external or internal threats for de

231
00:11:21,860 --> 00:11:25,910
deceptor helps with this redirecting

232
00:11:23,570 --> 00:11:28,640
with redirecting these attacks and by

233
00:11:25,910 --> 00:11:30,500
analyzing the attackers behavior which

234
00:11:28,640 --> 00:11:33,130
provides sauk teams actionable

235
00:11:30,500 --> 00:11:35,870
intelligence to respond to these threats

236
00:11:33,130 --> 00:11:37,820
through the security fabric security

237
00:11:35,870 --> 00:11:40,610
teams can share intelligence with a sim

238
00:11:37,820 --> 00:11:42,230
for broader visibility and inline

239
00:11:40,610 --> 00:11:44,200
security controls can block both

240
00:11:42,230 --> 00:11:47,560
external and internal actors

241
00:11:44,200 --> 00:11:50,140
automatically before any damage is done

242
00:11:47,560 --> 00:11:53,300
for two deceptor is a holistic solution

243
00:11:50,140 --> 00:12:00,830
covering the entire organization for

244
00:11:53,300 --> 00:12:05,390
both IT and OT segments alright so from

245
00:12:00,830 --> 00:12:07,550
here I want to run a couple scenarios in

246
00:12:05,390 --> 00:12:10,939
a lab environment gonna show you how the

247
00:12:07,550 --> 00:12:17,930
product works let me share my screen

248
00:12:10,940 --> 00:12:20,920
here so if really everyone can see my

249
00:12:17,930 --> 00:12:24,140
screen so let me kind of set the stage

250
00:12:20,920 --> 00:12:26,209
we're gonna go through both I'm gonna

251
00:12:24,140 --> 00:12:30,500
clean the offense and a defense in this

252
00:12:26,210 --> 00:12:32,960
scenario the scenario is that we have

253
00:12:30,500 --> 00:12:37,340
already compromised a machine inside of

254
00:12:32,960 --> 00:12:39,650
a company's DMZ we've done some research

255
00:12:37,340 --> 00:12:42,890
as well we know this company uses the

256
00:12:39,650 --> 00:12:44,959
syntax of first initial last name for

257
00:12:42,890 --> 00:12:47,569
usernames so we're gonna use that to our

258
00:12:44,960 --> 00:12:50,750
advantage and we're going to run through

259
00:12:47,570 --> 00:12:55,070
kind of an escalation of or a stair-step

260
00:12:50,750 --> 00:12:58,640
of attacks own a box that's going to be

261
00:12:55,070 --> 00:13:01,070
our pivot point inside of the DMZ but

262
00:12:58,640 --> 00:13:03,410
first I want to jump into the four to

263
00:13:01,070 --> 00:13:06,580
deceptor console and kind of show you

264
00:13:03,410 --> 00:13:10,339
how easy it is to deploy some of these

265
00:13:06,580 --> 00:13:12,200
decoy beams into the network and we'll

266
00:13:10,340 --> 00:13:15,620
start here with a dashboard which I call

267
00:13:12,200 --> 00:13:17,210
kind of your 30,000 foot view from here

268
00:13:15,620 --> 00:13:20,570
you can actually see all the different

269
00:13:17,210 --> 00:13:22,990
events and incidents that are actually

270
00:13:20,570 --> 00:13:25,240
we actually were able to detect

271
00:13:22,990 --> 00:13:27,520
so all of your events are going to be an

272
00:13:25,240 --> 00:13:29,680
inner circle and then all the incidents

273
00:13:27,520 --> 00:13:31,449
that comprise of all the events will be

274
00:13:29,680 --> 00:13:33,250
on the outer circle and you can see the

275
00:13:31,450 --> 00:13:38,410
different severity levels here critical

276
00:13:33,250 --> 00:13:41,110
medium low and high then we want to look

277
00:13:38,410 --> 00:13:43,029
at the different lures or applications

278
00:13:41,110 --> 00:13:46,120
or services that are actually deployed

279
00:13:43,029 --> 00:13:48,550
as part of these decoy beams out in the

280
00:13:46,120 --> 00:13:49,540
environment so you see some some ones

281
00:13:48,550 --> 00:13:54,910
that you're actually probably familiar

282
00:13:49,540 --> 00:13:57,610
with SMB RDP SSH and then some stuff

283
00:13:54,910 --> 00:14:02,319
that's actually associated with ot

284
00:13:57,610 --> 00:14:03,670
networks so back net and and Modbus so

285
00:14:02,320 --> 00:14:05,200
if you're not as familiar with ot you

286
00:14:03,670 --> 00:14:08,020
may man it may not be as familiar with

287
00:14:05,200 --> 00:14:10,000
those protocols we get some good

288
00:14:08,020 --> 00:14:11,860
information here and these are actually

289
00:14:10,000 --> 00:14:13,899
configurable widgets so we can change

290
00:14:11,860 --> 00:14:15,940
the timeline associated with a lot of

291
00:14:13,899 --> 00:14:19,060
these I think we have three options here

292
00:14:15,940 --> 00:14:21,040
24 hours or seven days and four weeks so

293
00:14:19,060 --> 00:14:23,469
we keep the analytics for a good period

294
00:14:21,040 --> 00:14:26,319
of time we're also handing this off to a

295
00:14:23,470 --> 00:14:30,190
sim or for to analyzer as well for

296
00:14:26,320 --> 00:14:31,899
long-term storage but you can see I've

297
00:14:30,190 --> 00:14:36,160
got a lot and actually have to preface

298
00:14:31,899 --> 00:14:38,320
this actually before I put this up for

299
00:14:36,160 --> 00:14:40,180
the b-sides demo actually opened up a

300
00:14:38,320 --> 00:14:42,310
couple boxes to the outside to generate

301
00:14:40,180 --> 00:14:45,910
some traffic so there was a Windows box

302
00:14:42,310 --> 00:14:48,160
that had RDP enabled there was a Bunty

303
00:14:45,910 --> 00:14:50,079
box that had SSH enable and they're all

304
00:14:48,160 --> 00:14:51,699
going to be using simple username

305
00:14:50,079 --> 00:14:54,099
password combinations so that's why

306
00:14:51,700 --> 00:14:55,720
you're seeing all this information here

307
00:14:54,100 --> 00:14:58,000
so these are the incidents in the last

308
00:14:55,720 --> 00:14:59,410
seven days and of course here are the

309
00:14:58,000 --> 00:15:02,110
events that actually make up those

310
00:14:59,410 --> 00:15:04,000
incidents a lot from China right kind of

311
00:15:02,110 --> 00:15:05,520
surprised so much from France but you

312
00:15:04,000 --> 00:15:09,279
can actually look at it on a

313
00:15:05,520 --> 00:15:12,399
geographical map here so we've got China

314
00:15:09,279 --> 00:15:14,950
having 918 incidence Russia and the

315
00:15:12,399 --> 00:15:17,230
5,000 and surprisingly for some reason a

316
00:15:14,950 --> 00:15:19,270
lot of surprises me but France is

317
00:15:17,230 --> 00:15:22,510
actually the leader here with over

318
00:15:19,270 --> 00:15:24,699
20,000 incidents the good guys in Canada

319
00:15:22,510 --> 00:15:28,930
don't seem to be wanting to attack me

320
00:15:24,700 --> 00:15:31,600
for some reason distribution of services

321
00:15:28,930 --> 00:15:33,520
like I said before RDP SSH we can do TCP

322
00:15:31,600 --> 00:15:35,470
listeners on specific ports and I'll get

323
00:15:33,520 --> 00:15:36,460
into that a little bit later and then

324
00:15:35,470 --> 00:15:38,890
just your

325
00:15:36,460 --> 00:15:42,220
overall incidents over time again we can

326
00:15:38,890 --> 00:15:44,319
change the the time value for this so

327
00:15:42,220 --> 00:15:47,710
let's look and see what actually goes

328
00:15:44,320 --> 00:15:50,620
into building out this deception Network

329
00:15:47,710 --> 00:15:53,529
so here are the options we have from an

330
00:15:50,620 --> 00:15:56,440
OS standpoint so we can actually pull a

331
00:15:53,529 --> 00:15:57,970
48 firewall image down and that's the

332
00:15:56,440 --> 00:16:00,070
only one I haven't pulled down here and

333
00:15:57,970 --> 00:16:03,160
then beside this you can see which lures

334
00:16:00,070 --> 00:16:05,050
are associated with which images so the

335
00:16:03,160 --> 00:16:06,760
FortiGate would be associated with a VPN

336
00:16:05,050 --> 00:16:09,160
connection we would set it out on the

337
00:16:06,760 --> 00:16:10,930
edge we would have simple username and

338
00:16:09,160 --> 00:16:13,120
password on it and hoping someone could

339
00:16:10,930 --> 00:16:15,279
actually compromise the box and then

340
00:16:13,120 --> 00:16:17,140
start to pivot and that's pretty much

341
00:16:15,279 --> 00:16:19,420
the case for all of these we want them

342
00:16:17,140 --> 00:16:21,310
to compromise the box we want to see

343
00:16:19,420 --> 00:16:23,770
what they're doing what the next steps

344
00:16:21,310 --> 00:16:25,930
are what tools are trying to download so

345
00:16:23,770 --> 00:16:28,360
we can prepare to how to mitigate that

346
00:16:25,930 --> 00:16:29,979
threat so we got some skater devices

347
00:16:28,360 --> 00:16:32,170
here and this skater device is actually

348
00:16:29,980 --> 00:16:35,140
in a bun tube box that actually has some

349
00:16:32,170 --> 00:16:37,599
some code on it that simulates a SCADA

350
00:16:35,140 --> 00:16:39,370
or an ICS device and again we can see

351
00:16:37,600 --> 00:16:41,680
the lures that are available for this

352
00:16:39,370 --> 00:16:43,990
box as well and then we've got an a

353
00:16:41,680 --> 00:16:48,400
bunch of Linux box and a couple flavors

354
00:16:43,990 --> 00:16:51,790
of Windows Windows 7 Windows 10 SSH

355
00:16:48,400 --> 00:16:54,400
for a bun - RDP for remote management

356
00:16:51,790 --> 00:16:56,620
access for these Windows boxes and SMB

357
00:16:54,400 --> 00:17:00,490
and Samba as well as any TCP listeners

358
00:16:56,620 --> 00:17:02,140
that you wanted to set so once we

359
00:17:00,490 --> 00:17:03,550
download these images you can see these

360
00:17:02,140 --> 00:17:05,050
are initialized and this one's still

361
00:17:03,550 --> 00:17:07,300
outstanding but once we have these

362
00:17:05,050 --> 00:17:10,809
downloaded all we have to do is build

363
00:17:07,300 --> 00:17:12,459
out a deployment network typically port

364
00:17:10,809 --> 00:17:13,869
number 1 is going to be reserved for

365
00:17:12,459 --> 00:17:15,520
management so it's going to be on the

366
00:17:13,869 --> 00:17:17,500
safe side of the network or that trusted

367
00:17:15,520 --> 00:17:20,439
side usually on a network management

368
00:17:17,500 --> 00:17:23,619
VLAN anything any other port can be used

369
00:17:20,439 --> 00:17:25,030
for deploying of decoys into the

370
00:17:23,619 --> 00:17:28,208
environment

371
00:17:25,030 --> 00:17:31,240
so from here I've actually just created

372
00:17:28,209 --> 00:17:34,809
two networks two different DM Z's and

373
00:17:31,240 --> 00:17:36,760
then I can deploy two decoys out this is

374
00:17:34,809 --> 00:17:39,428
a VM that I'm running right here for for

375
00:17:36,760 --> 00:17:44,290
two deceptor we could I could pull a

376
00:17:39,429 --> 00:17:46,300
trunk into VMware and actually set up

377
00:17:44,290 --> 00:17:49,760
out of VLAN detection or manually set

378
00:17:46,300 --> 00:17:51,770
VLAN IDs these IP addresses are mainly

379
00:17:49,760 --> 00:17:53,870
to be used for proxy purposes into the

380
00:17:51,770 --> 00:17:55,430
beams and I'll show you that shortly but

381
00:17:53,870 --> 00:17:58,810
that's pretty much once you download the

382
00:17:55,430 --> 00:18:01,820
image files you set up the networks and

383
00:17:58,810 --> 00:18:05,600
the last step is just to deploy the the

384
00:18:01,820 --> 00:18:07,550
actual decoy VMs so I've got a template

385
00:18:05,600 --> 00:18:10,669
here I'll jump into that I'll name it

386
00:18:07,550 --> 00:18:12,590
test just to be simple but you can see

387
00:18:10,670 --> 00:18:15,260
the services that are enabled here

388
00:18:12,590 --> 00:18:18,379
RDP like I said my username and password

389
00:18:15,260 --> 00:18:20,629
if I wanted an SMB share same thing and

390
00:18:18,380 --> 00:18:23,150
then I can give it a creative you know

391
00:18:20,630 --> 00:18:26,540
enticing name like banking or private

392
00:18:23,150 --> 00:18:28,010
something like that and then a TCP

393
00:18:26,540 --> 00:18:30,290
listener I've got it set up as port 80

394
00:18:28,010 --> 00:18:32,300
but I see a lot of times this comes in

395
00:18:30,290 --> 00:18:33,620
handy too where if you had a custom

396
00:18:32,300 --> 00:18:35,510
application well not really a custom

397
00:18:33,620 --> 00:18:39,830
application but an application that you

398
00:18:35,510 --> 00:18:42,080
were hosting internally that maybe had a

399
00:18:39,830 --> 00:18:44,179
an odd port number that you wanted to

400
00:18:42,080 --> 00:18:46,970
advertise and see if someone could pick

401
00:18:44,180 --> 00:18:49,460
it up as that service and start sending

402
00:18:46,970 --> 00:18:53,420
exploits towards that this is where that

403
00:18:49,460 --> 00:18:55,580
TCP listener would be handy here so once

404
00:18:53,420 --> 00:18:57,590
we do this we just click Next and this

405
00:18:55,580 --> 00:18:59,379
is where you actually add that interface

406
00:18:57,590 --> 00:19:02,419
from the deployment network step earlier

407
00:18:59,380 --> 00:19:04,790
right into here so much like port 2 I

408
00:19:02,420 --> 00:19:06,920
can select DHCP so I'm just gonna grab a

409
00:19:04,790 --> 00:19:09,379
regular DHCP address from here

410
00:19:06,920 --> 00:19:11,810
your DHCP server I can set it statically

411
00:19:09,380 --> 00:19:13,600
if you want to no big deal there and

412
00:19:11,810 --> 00:19:16,820
then that's it you just click deploy

413
00:19:13,600 --> 00:19:19,730
once you click deploy all of your decoys

414
00:19:16,820 --> 00:19:22,370
will show up here you can see I've got a

415
00:19:19,730 --> 00:19:24,170
couple at bunty boxes a couple one seven

416
00:19:22,370 --> 00:19:26,810
I got a SCADA device sitting out there

417
00:19:24,170 --> 00:19:28,760
and then it's just typical controls if I

418
00:19:26,810 --> 00:19:31,159
wanted to see how this box is configured

419
00:19:28,760 --> 00:19:32,990
I can click on it and see exactly what's

420
00:19:31,160 --> 00:19:35,480
configured user names password that kind

421
00:19:32,990 --> 00:19:37,550
of stuff right and if I want to jump

422
00:19:35,480 --> 00:19:39,980
into a box I can easily just B&C

423
00:19:37,550 --> 00:19:42,740
directly into here we're using that

424
00:19:39,980 --> 00:19:44,240
proxy IP that we set up earlier in order

425
00:19:42,740 --> 00:19:46,820
to do this so we're still on the safe

426
00:19:44,240 --> 00:19:49,430
side of the network and the same thing

427
00:19:46,820 --> 00:19:51,889
for the window side I can open up an RDP

428
00:19:49,430 --> 00:19:53,810
session directly from here so we have

429
00:19:51,890 --> 00:19:56,240
access to the VM via proxy so

430
00:19:53,810 --> 00:19:57,940
everything's safe and you can see the

431
00:19:56,240 --> 00:20:01,750
services that I've got listed here so

432
00:19:57,940 --> 00:20:04,330
SMB Samba SMB here for Windows

433
00:20:01,750 --> 00:20:06,700
a TCP listener here on port 80 so we're

434
00:20:04,330 --> 00:20:10,240
gonna actually hit these boxes as part

435
00:20:06,700 --> 00:20:13,450
of this demonstration the decoy map is

436
00:20:10,240 --> 00:20:16,240
gonna be more of what's out there what

437
00:20:13,450 --> 00:20:18,520
do we have running same thing here's our

438
00:20:16,240 --> 00:20:20,080
decoys anything that's read it's

439
00:20:18,520 --> 00:20:23,290
critical we can click on any of this

440
00:20:20,080 --> 00:20:24,970
stuff view incidents it's not typically

441
00:20:23,290 --> 00:20:27,909
what I use I usually just go to the

442
00:20:24,970 --> 00:20:29,770
analysis engine here inside of porta

443
00:20:27,910 --> 00:20:32,230
deceptor but we'll get to that here in

444
00:20:29,770 --> 00:20:35,620
just a moment so let's go ahead and jump

445
00:20:32,230 --> 00:20:37,030
over to our kali linux box so this is

446
00:20:35,620 --> 00:20:39,850
going to be the box that i stated that

447
00:20:37,030 --> 00:20:43,240
we compromised i know we're not going to

448
00:20:39,850 --> 00:20:44,800
compromise a kali linux box and real

449
00:20:43,240 --> 00:20:48,910
life we're just gonna have to make

450
00:20:44,800 --> 00:20:50,800
believe here just a little bit so i'm

451
00:20:48,910 --> 00:20:54,490
gonna go ahead and start off with just

452
00:20:50,800 --> 00:20:56,200
running a simple in map scan against one

453
00:20:54,490 --> 00:20:58,660
of these decoy beams and then we're

454
00:20:56,200 --> 00:21:01,030
gonna look and see flip back and forth

455
00:20:58,660 --> 00:21:02,920
will go offensive then will flip over to

456
00:21:01,030 --> 00:21:05,860
for data scepter see what we can see

457
00:21:02,920 --> 00:21:09,340
from a defensive standpoint and see if

458
00:21:05,860 --> 00:21:11,709
the the analytics makes sense so i'm

459
00:21:09,340 --> 00:21:15,580
going to pull up a couple of command

460
00:21:11,710 --> 00:21:18,640
line scripts that i've got here and

461
00:21:15,580 --> 00:21:21,010
we're just gonna quickly run them so dot

462
00:21:18,640 --> 00:21:23,530
48 that's the abun two box that decoy

463
00:21:21,010 --> 00:21:25,870
that we looked at earlier so we'll let

464
00:21:23,530 --> 00:21:28,560
this run just a minute and we'll see

465
00:21:25,870 --> 00:21:28,560
what we get back

466
00:21:55,790 --> 00:21:59,850
all right so we got a response after a

467
00:21:58,140 --> 00:22:02,130
little while so we can see the ports

468
00:21:59,850 --> 00:22:03,570
that are actually open on this decoy box

469
00:22:02,130 --> 00:22:06,930
of course we don't know it's a decoy

470
00:22:03,570 --> 00:22:09,240
we're inside of a customers or customer

471
00:22:06,930 --> 00:22:13,230
company's Network and we're trying to

472
00:22:09,240 --> 00:22:14,280
pivot at this point so we see SSH 80s

473
00:22:13,230 --> 00:22:19,620
listening

474
00:22:14,280 --> 00:22:21,840
we got NetBIOS we've got SMB running so

475
00:22:19,620 --> 00:22:24,000
let's let's go back to the defensive

476
00:22:21,840 --> 00:22:27,340
side and let's see if we can see any of

477
00:22:24,000 --> 00:22:32,200
this stuff so let me go to analysis

478
00:22:27,340 --> 00:22:34,030
and we're gonna see on this side there's

479
00:22:32,200 --> 00:22:35,830
actually a couple of events that

480
00:22:34,030 --> 00:22:40,780
happened right because we're scanning

481
00:22:35,830 --> 00:22:42,730
multiple ports so port 22 139 443 so

482
00:22:40,780 --> 00:22:45,639
these are lining up with exactly what

483
00:22:42,730 --> 00:22:47,980
the results that we got from the nmap

484
00:22:45,640 --> 00:22:49,900
scan and we can see all the source ports

485
00:22:47,980 --> 00:22:53,140
that we used in order to do this we

486
00:22:49,900 --> 00:22:56,530
actually can pull down the pcap for this

487
00:22:53,140 --> 00:22:58,420
transaction if you wanted to so we did

488
00:22:56,530 --> 00:23:03,160
we were able to capture that the nmap

489
00:22:58,420 --> 00:23:05,020
scan still not as concerning right you

490
00:23:03,160 --> 00:23:07,480
know in maps concerning scans are

491
00:23:05,020 --> 00:23:10,510
concerning inside your network more so

492
00:23:07,480 --> 00:23:12,280
right but not as big of a deal it's not

493
00:23:10,510 --> 00:23:14,440
going to create a campaign out of it yet

494
00:23:12,280 --> 00:23:16,240
so let's go back and let's let's dig a

495
00:23:14,440 --> 00:23:18,730
little bit deeper so the next thing I

496
00:23:16,240 --> 00:23:21,280
want to do is I told you before that

497
00:23:18,730 --> 00:23:24,220
I've done my research I know that the

498
00:23:21,280 --> 00:23:26,290
syntax for username passwords inside of

499
00:23:24,220 --> 00:23:29,770
this company is first initial last name

500
00:23:26,290 --> 00:23:31,750
I know there's a John Smith so we're

501
00:23:29,770 --> 00:23:34,270
going to go after John Smith and we're

502
00:23:31,750 --> 00:23:36,790
going to use Hydra and do a brute force

503
00:23:34,270 --> 00:23:38,980
password attack using a word list from

504
00:23:36,790 --> 00:23:46,870
Metasploit so let's go ahead and copy

505
00:23:38,980 --> 00:23:49,590
and paste that in right quick so the

506
00:23:46,870 --> 00:23:49,590
attack is started

507
00:24:18,830 --> 00:24:24,918
I apologize i quarantine myself this is

508
00:24:23,230 --> 00:24:26,450
something I was going to show you

509
00:24:24,919 --> 00:24:28,100
earlier I thought I'd turn this off but

510
00:24:26,450 --> 00:24:29,419
I did quarantine myself so we'll go

511
00:24:28,100 --> 00:24:31,070
ahead and talk about that while I've got

512
00:24:29,419 --> 00:24:33,740
so we do have the integration with the

513
00:24:31,070 --> 00:24:37,010
FortiGate firewall where I can actually

514
00:24:33,740 --> 00:24:40,549
hit the API on an upstream FortiGate

515
00:24:37,010 --> 00:24:42,408
firewall and quarantine devices so what

516
00:24:40,549 --> 00:24:44,210
that means is we're going to show up in

517
00:24:42,409 --> 00:24:47,659
quarantine here which you see we got two

518
00:24:44,210 --> 00:24:49,880
minutes left before this guy has fallen

519
00:24:47,659 --> 00:24:51,590
off of the quarantine ban I've got it

520
00:24:49,880 --> 00:24:54,710
set for five minutes you can set it

521
00:24:51,590 --> 00:24:57,320
upwards - I think multiple days to

522
00:24:54,710 --> 00:24:59,120
quarantine this so once your quarantine

523
00:24:57,320 --> 00:25:01,220
we can actually go upstream to the

524
00:24:59,120 --> 00:25:04,219
FortiGate firewall and we can actually

525
00:25:01,220 --> 00:25:06,470
monitor that as well so we go into

526
00:25:04,220 --> 00:25:08,750
quarantine monitor here we can actually

527
00:25:06,470 --> 00:25:12,230
see that the timer's are going to be the

528
00:25:08,750 --> 00:25:14,570
same from the API call and we can see

529
00:25:12,230 --> 00:25:16,970
the device that's actually the threat

530
00:25:14,570 --> 00:25:18,799
from here we can actually do some things

531
00:25:16,970 --> 00:25:21,169
as far as create address objects out of

532
00:25:18,799 --> 00:25:23,240
it so we can put it on a bad list we can

533
00:25:21,169 --> 00:25:24,740
quarantine it all together so there's

534
00:25:23,240 --> 00:25:26,419
two different types of quarantine ones

535
00:25:24,740 --> 00:25:29,779
AB and quarantine which is gonna be

536
00:25:26,419 --> 00:25:31,039
temporary and more nak based and then we

537
00:25:29,779 --> 00:25:32,980
can actually quarantine the host all

538
00:25:31,039 --> 00:25:35,450
together to where it can't pass traffic

539
00:25:32,980 --> 00:25:38,990
we do have some integrations if you used

540
00:25:35,450 --> 00:25:40,490
our secure access switching and wireless

541
00:25:38,990 --> 00:25:41,630
- where we can actually do this before

542
00:25:40,490 --> 00:25:46,130
it actually gets into the fabric

543
00:25:41,630 --> 00:25:47,720
altogether and then we can actually

544
00:25:46,130 --> 00:25:50,179
build out some automation as well

545
00:25:47,720 --> 00:25:53,630
which is kind of cool so once I built

546
00:25:50,179 --> 00:25:54,889
out an automation step for this and I'm

547
00:25:53,630 --> 00:25:57,230
not really doing anything but sitting in

548
00:25:54,889 --> 00:26:00,139
an email but we can run CLI scripts and

549
00:25:57,230 --> 00:26:02,690
we can actually do things to this

550
00:26:00,139 --> 00:26:04,389
endpoint in addition to banning the IP

551
00:26:02,690 --> 00:26:07,669
address enough for two gate firewall

552
00:26:04,389 --> 00:26:09,620
maybe we want to set off a script for

553
00:26:07,669 --> 00:26:10,909
something that we can do is from a

554
00:26:09,620 --> 00:26:14,178
security operation standpoint in the

555
00:26:10,909 --> 00:26:16,940
sock but it depends on the event that

556
00:26:14,179 --> 00:26:18,679
you choose and again all I've done is a

557
00:26:16,940 --> 00:26:21,289
looking at an event in that quarantine

558
00:26:18,679 --> 00:26:23,059
I'm less than an email and then here's

559
00:26:21,289 --> 00:26:25,029
the email address so I'm gonna send it

560
00:26:23,059 --> 00:26:26,960
to now just show up in your inbox so

561
00:26:25,029 --> 00:26:29,090
that was something I was going to cover

562
00:26:26,960 --> 00:26:30,909
a little bit later but since I blocked

563
00:26:29,090 --> 00:26:32,980
myself then

564
00:26:30,909 --> 00:26:35,649
I figured it might as well use the time

565
00:26:32,980 --> 00:26:39,759
wisely here so let's given another 20

566
00:26:35,649 --> 00:26:43,120
seconds and we'll run that again but as

567
00:26:39,759 --> 00:26:48,399
you can see that quarantine does work we

568
00:26:43,120 --> 00:26:52,239
weren't able to run the the brute-force

569
00:26:48,399 --> 00:26:53,799
attack from there so refresh here looks

570
00:26:52,240 --> 00:26:56,710
like we're good let's go back to Ford

571
00:26:53,799 --> 00:26:58,480
acceptor we refresh here looks like

572
00:26:56,710 --> 00:27:03,340
we're good let's go ahead and run that

573
00:26:58,480 --> 00:27:03,759
attack again alright so this time it

574
00:27:03,340 --> 00:27:06,220
worked

575
00:27:03,759 --> 00:27:09,460
we didn't quarantine ourselves and you

576
00:27:06,220 --> 00:27:11,200
can see it takes it took three tries in

577
00:27:09,460 --> 00:27:13,929
order to guess the password of password

578
00:27:11,200 --> 00:27:16,330
yes we made this really really simple we

579
00:27:13,929 --> 00:27:18,309
want these decoys to be compromised we

580
00:27:16,330 --> 00:27:20,529
want to see where they're pivoting what

581
00:27:18,309 --> 00:27:22,509
tools are using next so let's go back to

582
00:27:20,529 --> 00:27:27,129
four to deceptor and let's take a look

583
00:27:22,509 --> 00:27:29,470
at the analysis and we should see

584
00:27:27,129 --> 00:27:31,990
something new and we do we actually see

585
00:27:29,470 --> 00:27:33,850
you see I did some testing earlier but

586
00:27:31,990 --> 00:27:37,269
you actually see there was no username

587
00:27:33,850 --> 00:27:40,360
before we actually did the brute-force

588
00:27:37,269 --> 00:27:42,909
attack so now we actually know the

589
00:27:40,360 --> 00:27:45,580
username used in this transaction and we

590
00:27:42,909 --> 00:27:49,450
can actually go through showing that an

591
00:27:45,580 --> 00:27:51,939
SSH session was established to wrong

592
00:27:49,450 --> 00:27:54,070
passwords were guessed and then we

593
00:27:51,940 --> 00:27:58,419
actually were able to guess the password

594
00:27:54,070 --> 00:28:02,289
on the third attempt so we see all of

595
00:27:58,419 --> 00:28:05,950
that activity so we're good so far so

596
00:28:02,289 --> 00:28:08,620
let's go a little bit deeper let's run

597
00:28:05,950 --> 00:28:10,809
let's run some commands right so we've

598
00:28:08,620 --> 00:28:12,549
got interactive access or we are gonna

599
00:28:10,809 --> 00:28:15,009
have in torretta interactive access to

600
00:28:12,549 --> 00:28:17,230
the console let's go ahead and log into

601
00:28:15,009 --> 00:28:22,779
this box since we know the user name and

602
00:28:17,230 --> 00:28:25,059
password now passwords password so now

603
00:28:22,779 --> 00:28:27,220
we're on that box that decoy although we

604
00:28:25,059 --> 00:28:29,799
don't know as a decoy I'm gonna just run

605
00:28:27,220 --> 00:28:32,470
some commands to see what we got we got

606
00:28:29,799 --> 00:28:34,090
a loopback address the interface that I

607
00:28:32,470 --> 00:28:36,220
came in on it looks like we have another

608
00:28:34,090 --> 00:28:38,740
interface so this box is multihomed

609
00:28:36,220 --> 00:28:41,799
that could be interesting for pivoting

610
00:28:38,740 --> 00:28:44,460
out let's see if we can see any files

611
00:28:41,799 --> 00:28:48,360
hidden files yep we got some files here

612
00:28:44,460 --> 00:28:50,669
in the home directory that that we just

613
00:28:48,360 --> 00:28:52,830
done a list on I want to look at that

614
00:28:50,669 --> 00:29:01,080
history file there

615
00:28:52,830 --> 00:29:02,960
I see yep so you could pick up some

616
00:29:01,080 --> 00:29:07,590
interesting things there depending on

617
00:29:02,960 --> 00:29:11,610
who is in here before so let's let's do

618
00:29:07,590 --> 00:29:13,379
something else let's actually let's do

619
00:29:11,610 --> 00:29:16,619
something a threat actor would actually

620
00:29:13,379 --> 00:29:18,539
do so let's go and grab some tool sets

621
00:29:16,619 --> 00:29:20,039
and this is not malicious tools that's

622
00:29:18,539 --> 00:29:22,019
right this is just going to emulate that

623
00:29:20,039 --> 00:29:24,720
but this is what they would do they

624
00:29:22,019 --> 00:29:26,759
would go out grab a tool from a website

625
00:29:24,720 --> 00:29:29,249
and be able to pull the tool down and

626
00:29:26,759 --> 00:29:31,590
use it to pivot or move laterally inside

627
00:29:29,249 --> 00:29:34,440
the network so we're going to use this

628
00:29:31,590 --> 00:29:38,090
site and this is just a simple HTML file

629
00:29:34,440 --> 00:29:40,559
so we downloaded that there's the file

630
00:29:38,090 --> 00:29:43,379
so let's go back to four to deceptor and

631
00:29:40,559 --> 00:29:50,759
see what we can see again from the

632
00:29:43,379 --> 00:29:55,379
analysis tab so we've got an interaction

633
00:29:50,759 --> 00:29:59,009
here again we got the attack user source

634
00:29:55,379 --> 00:30:01,080
port we started the session again we're

635
00:29:59,009 --> 00:30:04,139
coming in here and here we go here all

636
00:30:01,080 --> 00:30:06,500
the commands that the threat actor

637
00:30:04,139 --> 00:30:09,740
actually ran

638
00:30:06,500 --> 00:30:12,080
during his session the other thing is

639
00:30:09,740 --> 00:30:17,179
let's look at the web filtering events

640
00:30:12,080 --> 00:30:19,870
and we can actually drill down to this

641
00:30:17,179 --> 00:30:19,870
and see

642
00:30:19,899 --> 00:30:27,738
that there was a here we go there was a

643
00:30:24,379 --> 00:30:30,619
malicious website hit so the threat

644
00:30:27,739 --> 00:30:32,869
actor actually hit this website if we

645
00:30:30,619 --> 00:30:35,569
wanted to go even further I can pull

646
00:30:32,869 --> 00:30:37,458
this peek app and I can look at the URI

647
00:30:35,569 --> 00:30:39,859
that was actually used what package what

648
00:30:37,459 --> 00:30:41,899
toolset did they pull down gives you

649
00:30:39,859 --> 00:30:44,329
more visibility into knowing what you're

650
00:30:41,899 --> 00:30:49,248
up against when someone's actually

651
00:30:44,329 --> 00:30:53,269
inside your network already so I got one

652
00:30:49,249 --> 00:30:56,989
more step or more attack that I want to

653
00:30:53,269 --> 00:30:58,579
place Ford on this machine and it's

654
00:30:56,989 --> 00:31:00,589
gonna be an exploit attack and actually

655
00:30:58,579 --> 00:31:02,239
I'm changing machines now but it's going

656
00:31:00,589 --> 00:31:04,458
to show you the same thing so I'm gonna

657
00:31:02,239 --> 00:31:07,699
do a Windows attack on a Windows machine

658
00:31:04,459 --> 00:31:10,009
this is an old decom attack I've got a I

659
00:31:07,699 --> 00:31:12,469
gotta update my sources but let me go

660
00:31:10,009 --> 00:31:16,909
ahead and just run this attack on this

661
00:31:12,469 --> 00:31:19,369
machine and the attack is actually going

662
00:31:16,909 --> 00:31:22,219
to fail this is a more this is an

663
00:31:19,369 --> 00:31:25,668
updated version actually this Windows 7

664
00:31:22,219 --> 00:31:31,309
this this exploit was originally built

665
00:31:25,669 --> 00:31:33,199
for Windows 2003 server so this is going

666
00:31:31,309 --> 00:31:34,969
to fail but we want to look at what

667
00:31:33,199 --> 00:31:36,619
we're seeing and for DES deceptor from

668
00:31:34,969 --> 00:31:39,049
an analytic standpoint that's the most

669
00:31:36,619 --> 00:31:42,458
important thing so we're gonna go and

670
00:31:39,049 --> 00:31:42,459
look at IP s events

671
00:31:44,240 --> 00:31:51,080
we can actually look at the victim port

672
00:31:46,280 --> 00:31:54,710
it's 135 and we can actually see the IPS

673
00:31:51,080 --> 00:31:57,800
attack actually happened we can pull

674
00:31:54,710 --> 00:32:00,380
again the pcap associated with this and

675
00:31:57,800 --> 00:32:04,100
we can actually see the attack or remote

676
00:32:00,380 --> 00:32:06,910
activation request here so a lot of good

677
00:32:04,100 --> 00:32:10,070
information so we've covered pretty much

678
00:32:06,910 --> 00:32:11,660
scanning we've covered any kind of

679
00:32:10,070 --> 00:32:13,639
remote tool sets that are needed to be

680
00:32:11,660 --> 00:32:15,559
downloaded any malicious code that's

681
00:32:13,640 --> 00:32:18,230
downloaded we've covered any kind of

682
00:32:15,559 --> 00:32:21,980
exploits or network based attacks we've

683
00:32:18,230 --> 00:32:24,710
been able to see all of that so far so

684
00:32:21,980 --> 00:32:26,300
from the offensive side we're done we're

685
00:32:24,710 --> 00:32:28,940
gonna go in here and talk about a couple

686
00:32:26,300 --> 00:32:30,409
more things one we've already talked

687
00:32:28,940 --> 00:32:31,820
about was the integration with the

688
00:32:30,410 --> 00:32:35,570
FortiGate because I accidentally

689
00:32:31,820 --> 00:32:39,559
quarantine myself in advance but this

690
00:32:35,570 --> 00:32:41,870
time I want to look at the actual lures

691
00:32:39,559 --> 00:32:44,629
that you can put on legitimate machines

692
00:32:41,870 --> 00:32:46,909
so the machines may be inside your

693
00:32:44,630 --> 00:32:49,610
network maybe you've got a finance VLAN

694
00:32:46,910 --> 00:32:53,960
maybe in the DMZ we can actually pull

695
00:32:49,610 --> 00:32:57,678
tokens from these decoys and what that

696
00:32:53,960 --> 00:33:00,020
means is I can pull a token package and

697
00:32:57,679 --> 00:33:04,130
install them on legitimate machines and

698
00:33:00,020 --> 00:33:07,250
maybe these tokens will lead lead the

699
00:33:04,130 --> 00:33:10,040
thread actor to the decoys by hiding

700
00:33:07,250 --> 00:33:14,000
cache credentials on those machines for

701
00:33:10,040 --> 00:33:16,610
RDP or SSH maybe there's a symbolic link

702
00:33:14,000 --> 00:33:19,190
pointing to a share again called banking

703
00:33:16,610 --> 00:33:20,840
or private that would entice a threat

704
00:33:19,190 --> 00:33:22,940
actor that's already compromised a

705
00:33:20,840 --> 00:33:25,449
legitimate machine to start showing

706
00:33:22,940 --> 00:33:28,730
themselves by attacking at a decoy

707
00:33:25,450 --> 00:33:29,960
elsewhere in the network so there's some

708
00:33:28,730 --> 00:33:33,559
cool things that we can actually deploy

709
00:33:29,960 --> 00:33:35,480
to legitimate machines to push them over

710
00:33:33,559 --> 00:33:38,980
to attack one of the decoys that you've

711
00:33:35,480 --> 00:33:41,660
got sitting out there in the network I

712
00:33:38,980 --> 00:33:45,010
think that is about it since we've

713
00:33:41,660 --> 00:33:45,010
already covered the FortiGate piece

