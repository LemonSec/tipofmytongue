1
00:00:02,909 --> 00:00:08,550
so thank you so much for coming and I

2
00:00:05,279 --> 00:00:11,400
hope you had a great lunch there my name

3
00:00:08,550 --> 00:00:14,160
is Ren zone Cruz and I work for Milan

4
00:00:11,400 --> 00:00:17,760
mutia so shout out formal Mattia outside

5
00:00:14,160 --> 00:00:19,980
and also at the back I'll be discussing

6
00:00:17,760 --> 00:00:23,099
about dfi our no cost

7
00:00:19,980 --> 00:00:29,999
performing dfi our without breaking the

8
00:00:23,099 --> 00:00:33,149
bank and let's start so just my whole my

9
00:00:29,999 --> 00:00:35,460
page it was a bit tough for the past

10
00:00:33,149 --> 00:00:39,930
three months and it's not perfect but

11
00:00:35,460 --> 00:00:44,820
also we had some great discussions as

12
00:00:39,930 --> 00:00:46,830
well as some feelings in some media so

13
00:00:44,820 --> 00:00:49,050
we got featured in Manila Bulletin in

14
00:00:46,830 --> 00:00:52,110
Philippines which is an delivering

15
00:00:49,050 --> 00:00:54,930
newspaper back then and also had the

16
00:00:52,110 --> 00:00:57,930
chance to have a interview in national

17
00:00:54,930 --> 00:00:58,590
television to discuss about how to be

18
00:00:57,930 --> 00:01:02,150
safe online

19
00:00:58,590 --> 00:01:05,250
just last month and I work for

20
00:01:02,150 --> 00:01:07,679
government right now and I work for oil

21
00:01:05,250 --> 00:01:11,100
and gas company for the past two years

22
00:01:07,679 --> 00:01:14,280
and also I'm a co-founder of a guide am

23
00:01:11,100 --> 00:01:16,048
guide them is the training center in the

24
00:01:14,280 --> 00:01:18,539
Philippines just start off but we keep

25
00:01:16,049 --> 00:01:20,880
on working hard just to make it a better

26
00:01:18,539 --> 00:01:23,490
one and this is actually my third

27
00:01:20,880 --> 00:01:26,579
besides conference so I'm really glad

28
00:01:23,490 --> 00:01:28,770
that we have here now in Doha so I got

29
00:01:26,579 --> 00:01:33,089
accepted last year in besides Vancouver

30
00:01:28,770 --> 00:01:36,270
and to discuss about windows for

31
00:01:33,090 --> 00:01:38,100
educating our windows forensics and for

32
00:01:36,270 --> 00:01:41,189
instigate things using Windows artifacts

33
00:01:38,100 --> 00:01:46,318
and also had a chance to delivery and

34
00:01:41,189 --> 00:01:49,020
besides London so yeah so I'm gonna be

35
00:01:46,319 --> 00:01:50,969
talking about the bunch of topics so

36
00:01:49,020 --> 00:01:53,459
before we have talked about more of the

37
00:01:50,969 --> 00:01:55,439
offensive kind of thing so let's just

38
00:01:53,459 --> 00:01:59,490
switch gear right now and focus more on

39
00:01:55,439 --> 00:02:01,048
the defensive capabilities and that we

40
00:01:59,490 --> 00:02:04,589
have and that we can do right now in our

41
00:02:01,049 --> 00:02:07,499
organization so we will discuss first

42
00:02:04,590 --> 00:02:11,550
about end point logging visibility how

43
00:02:07,499 --> 00:02:14,400
to collect those logs and data that we

44
00:02:11,550 --> 00:02:16,290
need in a fast and efficient way how can

45
00:02:14,400 --> 00:02:18,810
we do an IR triage

46
00:02:16,290 --> 00:02:20,340
also an efficient way how can we perform

47
00:02:18,810 --> 00:02:23,219
breath hunting if you don't have budget

48
00:02:20,340 --> 00:02:25,859
or video web zero budget and how how can

49
00:02:23,219 --> 00:02:29,159
we craft a detection engineering from a

50
00:02:25,859 --> 00:02:31,769
better standpoint so all of this

51
00:02:29,159 --> 00:02:34,349
capabilities right now can cause a lot

52
00:02:31,769 --> 00:02:36,799
of money buying some tools and stuff but

53
00:02:34,349 --> 00:02:39,599
what if you don't have budget so how

54
00:02:36,799 --> 00:02:42,239
much would it cost me if I do those

55
00:02:39,599 --> 00:02:44,310
things so that just cost me zero because

56
00:02:42,239 --> 00:02:46,950
we need to have a lot of github repo

57
00:02:44,310 --> 00:02:49,170
open source tools from the wild that can

58
00:02:46,950 --> 00:02:55,230
we leverage to perform these kind of

59
00:02:49,170 --> 00:02:58,470
capabilities sounds dope right okay so

60
00:02:55,230 --> 00:03:00,540
the step or the first step what you're

61
00:02:58,470 --> 00:03:04,620
going to do step are step zero when you

62
00:03:00,540 --> 00:03:06,900
got bridge so the first thing that you

63
00:03:04,620 --> 00:03:10,049
need to do is to update your resume so

64
00:03:06,900 --> 00:03:11,819
you'll be you will be having stressful

65
00:03:10,049 --> 00:03:14,970
meetings right after the bridge and

66
00:03:11,819 --> 00:03:16,738
you're also playing in a blaming game

67
00:03:14,970 --> 00:03:18,180
and as well

68
00:03:16,739 --> 00:03:21,000
you have to rebuild the infrastructure

69
00:03:18,180 --> 00:03:23,159
it depends on the criticality and the

70
00:03:21,000 --> 00:03:26,250
last thing is you you not getting any

71
00:03:23,159 --> 00:03:29,510
bonus at all so you're gonna update your

72
00:03:26,250 --> 00:03:32,760
resume is someone agree to me

73
00:03:29,510 --> 00:03:37,548
okay so kidding aside so what is the f

74
00:03:32,760 --> 00:03:40,379
ir so these are the people who loves

75
00:03:37,549 --> 00:03:41,849
creating stories for what happened in

76
00:03:40,379 --> 00:03:44,069
the bridge they're the one who

77
00:03:41,849 --> 00:03:46,260
investigates things out trying to

78
00:03:44,069 --> 00:03:48,358
correlate vlogs from one data source

79
00:03:46,260 --> 00:03:50,459
from one different data source and to

80
00:03:48,359 --> 00:03:53,030
another and then they're the one who is

81
00:03:50,459 --> 00:03:56,190
creating those timeline analysis and

82
00:03:53,030 --> 00:03:59,519
they're like the digital Sherlock Holmes

83
00:03:56,190 --> 00:04:04,199
on your area so for us to have in the

84
00:03:59,519 --> 00:04:05,669
same page and there's this big problems

85
00:04:04,199 --> 00:04:07,889
right now when it comes to Incident

86
00:04:05,669 --> 00:04:11,489
Response so I read this Science

87
00:04:07,889 --> 00:04:13,590
Institute report from 2019 and the first

88
00:04:11,489 --> 00:04:15,689
thing that we need to focus on is

89
00:04:13,590 --> 00:04:18,599
getting the right data first we need to

90
00:04:15,689 --> 00:04:20,488
prioritize things so if we're being

91
00:04:18,599 --> 00:04:24,360
attacked by from the network level so

92
00:04:20,488 --> 00:04:26,188
are we really doing some coverage at all

93
00:04:24,360 --> 00:04:27,900
getting those logs and how about the

94
00:04:26,189 --> 00:04:30,750
endpoint capabilities how about the

95
00:04:27,900 --> 00:04:33,049
endpoint logs so I've had an engagement

96
00:04:30,750 --> 00:04:35,939
way back when I was in Philippines and

97
00:04:33,050 --> 00:04:38,969
so the client says that they are all

98
00:04:35,939 --> 00:04:41,219
running a Windows 10 but unfortunately

99
00:04:38,969 --> 00:04:45,960
we saw some three Windows XP in the Box

100
00:04:41,219 --> 00:04:48,210
still running in a domain so what we

101
00:04:45,960 --> 00:04:50,909
need right now is the visibility so the

102
00:04:48,210 --> 00:04:53,008
task that we had before the detection

103
00:04:50,909 --> 00:04:55,050
capabilities those are the theories and

104
00:04:53,009 --> 00:04:57,509
this stuff is all about implementation

105
00:04:55,050 --> 00:04:59,039
of those theories which is kind of makes

106
00:04:57,509 --> 00:05:02,129
sense because we really need those

107
00:04:59,039 --> 00:05:05,940
grading capabilities and visibility at

108
00:05:02,129 --> 00:05:08,969
all what do you really need so we need

109
00:05:05,940 --> 00:05:11,340
to prioritize things do we really need

110
00:05:08,969 --> 00:05:12,780
to focus on the endpoint level or could

111
00:05:11,340 --> 00:05:16,138
be a network level or it could be both

112
00:05:12,780 --> 00:05:18,840
and formulas so we should learn from the

113
00:05:16,139 --> 00:05:21,750
lessons learning that we are

114
00:05:18,840 --> 00:05:24,150
encountering so if we're being attacked

115
00:05:21,750 --> 00:05:26,460
by pitching okay so we need to increase

116
00:05:24,150 --> 00:05:28,650
more security could be on our endpoint

117
00:05:26,460 --> 00:05:33,419
level or could be we need to detect the

118
00:05:28,650 --> 00:05:35,460
is logs and those things and another

119
00:05:33,419 --> 00:05:37,469
improvement that I saw in the report is

120
00:05:35,460 --> 00:05:41,370
that number one is the shortage of

121
00:05:37,469 --> 00:05:44,539
staffing and skills so we have a lot of

122
00:05:41,370 --> 00:05:47,879
security professionals in Qatar and

123
00:05:44,539 --> 00:05:50,068
there are some there are some skills

124
00:05:47,879 --> 00:05:52,710
that there's some curves that we need to

125
00:05:50,069 --> 00:05:56,190
fill up and that is a skill set as well

126
00:05:52,710 --> 00:05:59,489
as the resources so I think everyone can

127
00:05:56,190 --> 00:06:02,990
agree that there are lack of order a

128
00:05:59,490 --> 00:06:05,759
shortage when it comes to resources so

129
00:06:02,990 --> 00:06:07,830
sometimes the security engineering is

130
00:06:05,759 --> 00:06:10,080
doing also the trophy hunting doing the

131
00:06:07,830 --> 00:06:13,680
reverse engineering and the worst is

132
00:06:10,080 --> 00:06:15,508
also the season so those those problems

133
00:06:13,680 --> 00:06:18,479
that were normally encountered and

134
00:06:15,509 --> 00:06:21,779
number two is the lack of budget so not

135
00:06:18,479 --> 00:06:22,800
everyone has the capability or has the

136
00:06:21,779 --> 00:06:25,949
money

137
00:06:22,800 --> 00:06:28,229
- to buy all this stuff and all the

138
00:06:25,949 --> 00:06:30,060
tools expensive tools in the market so

139
00:06:28,229 --> 00:06:32,159
we need to have an alternative solutions

140
00:06:30,060 --> 00:06:35,370
for that so that's why I have this stuff

141
00:06:32,159 --> 00:06:37,530
- to use enable my Arsenal's and to

142
00:06:35,370 --> 00:06:42,539
discuss about the good open-source tools

143
00:06:37,530 --> 00:06:46,289
from the world to do DF IR and another

144
00:06:42,539 --> 00:06:49,289
further improvement is again the

145
00:06:46,289 --> 00:06:52,310
visibility so if you don't have a vr

146
00:06:49,289 --> 00:06:55,680
platform so is that the end of the world

147
00:06:52,310 --> 00:06:57,419
as well as the protection engineering so

148
00:06:55,680 --> 00:06:59,120
most of the time we're just focusing

149
00:06:57,419 --> 00:07:01,919
more on the signatures based detection

150
00:06:59,120 --> 00:07:06,629
but right now sophisticated malware is

151
00:07:01,919 --> 00:07:08,758
as well as a pcs doing some low beams or

152
00:07:06,629 --> 00:07:12,509
living off the land binaries so they're

153
00:07:08,759 --> 00:07:14,639
trying to use all the all the processes

154
00:07:12,509 --> 00:07:16,800
and binaries that's already in the

155
00:07:14,639 --> 00:07:19,319
window side as well as in the Linux side

156
00:07:16,800 --> 00:07:20,520
so we need to focus more on the TTP's or

157
00:07:19,319 --> 00:07:23,400
the techniques tactics and procedures

158
00:07:20,520 --> 00:07:26,128
and how about if you have a bunch of iOS

159
00:07:23,400 --> 00:07:28,830
is what if we have thousands of iOS is

160
00:07:26,129 --> 00:07:32,370
how can we do it or how can we how can

161
00:07:28,830 --> 00:07:35,039
we scan an infected machine using

162
00:07:32,370 --> 00:07:39,810
different IPS domains and hashes that we

163
00:07:35,039 --> 00:07:42,060
have in an on demand manner so these are

164
00:07:39,810 --> 00:07:44,759
the security incidents in a nutshell

165
00:07:42,060 --> 00:07:48,719
we're talking about logs from different

166
00:07:44,759 --> 00:07:51,690
different data sets is there any i/o

167
00:07:48,719 --> 00:07:53,909
sees you sir duskie search sends IP

168
00:07:51,690 --> 00:07:55,440
hashes that we need to monitor this any

169
00:07:53,909 --> 00:07:57,389
particular domains that we need to

170
00:07:55,440 --> 00:07:59,310
monitor and how about those fighters

171
00:07:57,389 --> 00:08:02,490
attack how about those attacks that

172
00:07:59,310 --> 00:08:04,620
leverage PowerShell w3 p WP spooning

173
00:08:02,490 --> 00:08:07,740
shells which is kind of relevant to the

174
00:08:04,620 --> 00:08:11,849
recent cv that we encounter and how

175
00:08:07,740 --> 00:08:13,620
about the rules do we have a coverage to

176
00:08:11,849 --> 00:08:18,409
the text search rules I mean such

177
00:08:13,620 --> 00:08:21,180
attacks what what rules are we using and

178
00:08:18,409 --> 00:08:23,819
so there is also a love-in challenge so

179
00:08:21,180 --> 00:08:26,819
if if we collect too little we might

180
00:08:23,819 --> 00:08:28,590
miss something and if we collect too

181
00:08:26,819 --> 00:08:31,670
much that might overrun the seam that

182
00:08:28,590 --> 00:08:33,530
we're using and the switches the queries

183
00:08:31,670 --> 00:08:36,560
that were using to detect those threats

184
00:08:33,530 --> 00:08:40,069
can be can take so much time before it

185
00:08:36,559 --> 00:08:42,530
gives at the output so let's talk about

186
00:08:40,070 --> 00:08:45,110
this month so I think most of you guys

187
00:08:42,530 --> 00:08:47,329
are really aware of what this mode can

188
00:08:45,110 --> 00:08:50,270
do it or environment this is free this

189
00:08:47,330 --> 00:08:53,360
is part of the sysinternals of Markus on

190
00:08:50,270 --> 00:08:56,569
average so this this is really a great

191
00:08:53,360 --> 00:08:59,510
platform for you to enable visibility in

192
00:08:56,570 --> 00:09:01,220
your endpoint perimeter and this is also

193
00:08:59,510 --> 00:09:03,080
supported by different communities

194
00:09:01,220 --> 00:09:05,960
there's a lot of configurations files

195
00:09:03,080 --> 00:09:08,270
that you can see on github but I've

196
00:09:05,960 --> 00:09:12,230
included that just to which I really

197
00:09:08,270 --> 00:09:14,660
recommend so these are the capabilities

198
00:09:12,230 --> 00:09:16,880
of sis mine I'm not going to talk about

199
00:09:14,660 --> 00:09:18,860
everything here but the SIS were also

200
00:09:16,880 --> 00:09:22,670
have this event IDs from event 1 to

201
00:09:18,860 --> 00:09:26,060
event 22 and also there is it event 255

202
00:09:22,670 --> 00:09:28,040
with system and errors the developers of

203
00:09:26,060 --> 00:09:30,319
this one they keep on updating it from

204
00:09:28,040 --> 00:09:31,819
time to time so we don't have any

205
00:09:30,320 --> 00:09:34,460
support on this because this is a free

206
00:09:31,820 --> 00:09:36,530
tool but Microsoft is towards now into

207
00:09:34,460 --> 00:09:40,610
open source so they're really doing a

208
00:09:36,530 --> 00:09:43,100
good job here and also I want to point

209
00:09:40,610 --> 00:09:46,310
out this image capability of this mode

210
00:09:43,100 --> 00:09:50,090
so if an attacker using mimic us and

211
00:09:46,310 --> 00:09:52,250
they just recompile that binary and then

212
00:09:50,090 --> 00:09:55,700
change the name let's say me me me me

213
00:09:52,250 --> 00:09:58,070
dogs or me me axe so the IP the hashes

214
00:09:55,700 --> 00:10:01,970
the hashes would change but the impact

215
00:09:58,070 --> 00:10:04,520
can be still that like that so it is

216
00:10:01,970 --> 00:10:08,180
also a great way to detect those piece

217
00:10:04,520 --> 00:10:10,490
of malware that is relevant to the to

218
00:10:08,180 --> 00:10:13,849
that specific attacker that specific

219
00:10:10,490 --> 00:10:17,270
binary so it is very important to enable

220
00:10:13,850 --> 00:10:19,250
impact in your environment so how do we

221
00:10:17,270 --> 00:10:21,439
install this money you can just take

222
00:10:19,250 --> 00:10:22,790
some pen circles on 15 seconds and you

223
00:10:21,440 --> 00:10:25,610
have suspending your environment and

224
00:10:22,790 --> 00:10:28,189
this one needs to have a configuration

225
00:10:25,610 --> 00:10:30,680
file so I've heard a question recently

226
00:10:28,190 --> 00:10:32,890
that it's really hard to map everything

227
00:10:30,680 --> 00:10:35,420
on the ATT and seek a framework and

228
00:10:32,890 --> 00:10:38,650
someone does not insist on configuration

229
00:10:35,420 --> 00:10:41,349
file well symphysis security is doing

230
00:10:38,650 --> 00:10:44,100
really a good job covering this those

231
00:10:41,350 --> 00:10:49,480
looked into security perspective and

232
00:10:44,100 --> 00:10:52,300
also on of Haifa so I have a webinar and

233
00:10:49,480 --> 00:10:54,460
is the is the speaker and he also

234
00:10:52,300 --> 00:10:58,870
created a good configuration file that

235
00:10:54,460 --> 00:11:01,300
matches the ATT NC k so it sometimes

236
00:10:58,870 --> 00:11:03,880
it's it's also paying to do some

237
00:11:01,300 --> 00:11:06,520
configuration it's not a rocket science

238
00:11:03,880 --> 00:11:09,689
but at least somehow community support

239
00:11:06,520 --> 00:11:16,090
system on and they've made a lot of

240
00:11:09,690 --> 00:11:17,410
contribution to that project and let's

241
00:11:16,090 --> 00:11:20,350
talk about the life of an incident

242
00:11:17,410 --> 00:11:23,230
responder so the first rule of incident

243
00:11:20,350 --> 00:11:27,310
response is always expect the exact

244
00:11:23,230 --> 00:11:33,400
opposite of what client tells you do you

245
00:11:27,310 --> 00:11:35,500
agree all right so for example the

246
00:11:33,400 --> 00:11:39,010
client tells you that we have a perfect

247
00:11:35,500 --> 00:11:44,250
Network we're really good we're almost

248
00:11:39,010 --> 00:11:47,800
perfect and ok so this is like an IR guy

249
00:11:44,250 --> 00:11:51,010
who's like guarded by everyone and what

250
00:11:47,800 --> 00:11:53,800
typing what everyone what anything is

251
00:11:51,010 --> 00:11:57,580
that he types it is being look I'll pay

252
00:11:53,800 --> 00:11:59,770
the client so there is also another IR

253
00:11:57,580 --> 00:12:02,860
guy that could be like a know-it-all guy

254
00:11:59,770 --> 00:12:06,010
so sometimes clients cease and I are as

255
00:12:02,860 --> 00:12:07,660
a know-it-all so they can ask like can

256
00:12:06,010 --> 00:12:09,790
you format the PC can you do some

257
00:12:07,660 --> 00:12:11,650
network cabling can you do do you know

258
00:12:09,790 --> 00:12:13,480
how to execute machine learning trapped

259
00:12:11,650 --> 00:12:17,500
intelligence or artificial intelligence

260
00:12:13,480 --> 00:12:19,990
data science those passwords sometimes

261
00:12:17,500 --> 00:12:25,360
it was being asked by the client due to

262
00:12:19,990 --> 00:12:27,400
the IR consultant and so they beg they

263
00:12:25,360 --> 00:12:29,950
tend to help to high expectations and

264
00:12:27,400 --> 00:12:32,650
basically they said that the client is

265
00:12:29,950 --> 00:12:36,430
always right but how the client makes

266
00:12:32,650 --> 00:12:38,920
the network infrastructure sounds based

267
00:12:36,430 --> 00:12:42,459
on their perspective so they tend to

268
00:12:38,920 --> 00:12:44,530
have this like a dream

269
00:12:42,460 --> 00:12:47,680
data centers like Google Data Centers

270
00:12:44,530 --> 00:12:49,780
very perfect one but in reality when you

271
00:12:47,680 --> 00:12:52,300
go to the client side you can see like

272
00:12:49,780 --> 00:12:57,520
this so it's like a bit just

273
00:12:52,300 --> 00:13:01,240
with bunch of cables okay and as an IR

274
00:12:57,520 --> 00:13:05,050
like I was like when I was like what did

275
00:13:01,240 --> 00:13:11,500
I get myself into so both of the IR can

276
00:13:05,050 --> 00:13:13,689
you live in this like URI okay so okay

277
00:13:11,500 --> 00:13:15,970
we have sis one already so how can we

278
00:13:13,690 --> 00:13:18,070
collect those data those who large in

279
00:13:15,970 --> 00:13:21,160
efficient manner and how can we collect

280
00:13:18,070 --> 00:13:25,570
that in an automated way so I've seen

281
00:13:21,160 --> 00:13:27,880
some entities as well doing Incident

282
00:13:25,570 --> 00:13:30,240
Response and performing forensics and

283
00:13:27,880 --> 00:13:33,910
analysis on the light box itself and

284
00:13:30,240 --> 00:13:36,670
taking so much time these in hours

285
00:13:33,910 --> 00:13:39,100
couples of hours digging dive to those

286
00:13:36,670 --> 00:13:41,400
events that really doesn't make sense at

287
00:13:39,100 --> 00:13:44,110
all so we need really a two who

288
00:13:41,400 --> 00:13:47,230
automatically collects those data in a

289
00:13:44,110 --> 00:13:49,630
security manner so I've made a project

290
00:13:47,230 --> 00:13:52,810
before a couple of years ago so I made a

291
00:13:49,630 --> 00:13:56,260
batch script to collect those I are

292
00:13:52,810 --> 00:13:57,699
irrelevant artifacts and I'm gonna be

293
00:13:56,260 --> 00:14:00,490
honest to myself that I'm not good at

294
00:13:57,700 --> 00:14:03,460
coding and I thought that maybe there's

295
00:14:00,490 --> 00:14:06,940
someone out there who created this data

296
00:14:03,460 --> 00:14:09,010
collection before and there is so

297
00:14:06,940 --> 00:14:11,560
there's a live response collection so

298
00:14:09,010 --> 00:14:13,720
this is a single downloadable zip file

299
00:14:11,560 --> 00:14:18,609
that can be run for any locations and it

300
00:14:13,720 --> 00:14:21,670
can support different OS like Linux Mac

301
00:14:18,610 --> 00:14:23,380
and Windows it's very portable you can

302
00:14:21,670 --> 00:14:27,250
just run it and then just wait for it to

303
00:14:23,380 --> 00:14:29,470
be finished so this is the lab response

304
00:14:27,250 --> 00:14:31,900
collection goobie so you can also

305
00:14:29,470 --> 00:14:35,350
perform memory down there you can just

306
00:14:31,900 --> 00:14:37,209
stick the triage and or if you want to

307
00:14:35,350 --> 00:14:40,680
get all the lives you just have to hit

308
00:14:37,210 --> 00:14:45,060
the complete one so this is a sample of

309
00:14:40,680 --> 00:14:47,410
me running the live response collection

310
00:14:45,060 --> 00:14:52,089
it collects you at the memory table it

311
00:14:47,410 --> 00:14:54,640
uses the purpose of RAM capture for

312
00:14:52,090 --> 00:14:56,740
volatile data it uses variety of course

313
00:14:54,640 --> 00:14:57,750
it also depends on sysinternals tools

314
00:14:56,740 --> 00:15:00,779
get

315
00:14:57,750 --> 00:15:03,300
the processor Oaxaca Explorer and this

316
00:15:00,779 --> 00:15:05,310
imaging it uses the fdk command-line

317
00:15:03,300 --> 00:15:10,769
tool so which is not bad

318
00:15:05,310 --> 00:15:13,170
so why free so we don't we don't need to

319
00:15:10,769 --> 00:15:14,819
go to the engagement where when you go

320
00:15:13,170 --> 00:15:17,399
there that's the only time that they

321
00:15:14,819 --> 00:15:20,610
start doing the imaging processes that

322
00:15:17,399 --> 00:15:22,980
takes hours and take days by filling

323
00:15:20,610 --> 00:15:25,949
this tool we can save time we can save

324
00:15:22,980 --> 00:15:28,019
money we can also do it remotely we can

325
00:15:25,949 --> 00:15:30,120
just give the to run the tool and then

326
00:15:28,019 --> 00:15:34,769
give it back to us so we can start

327
00:15:30,120 --> 00:15:37,560
analyzing the processes and I wanna I

328
00:15:34,769 --> 00:15:41,430
want to put also this tool because this

329
00:15:37,560 --> 00:15:42,508
really a create one I've even touch base

330
00:15:41,430 --> 00:15:45,750
with the creator of this which is

331
00:15:42,509 --> 00:15:48,480
Alexander man so I even asked him that

332
00:15:45,750 --> 00:15:50,300
if I can include his tool in my talk and

333
00:15:48,480 --> 00:15:53,220
then he said yeah that sounds great

334
00:15:50,300 --> 00:15:55,589
this is one of the fastest forensics

335
00:15:53,220 --> 00:15:58,680
data collector tools that I've use for a

336
00:15:55,589 --> 00:16:01,589
while which escape crawl artifact parser

337
00:15:58,680 --> 00:16:05,459
instructor it runs in a google base as

338
00:16:01,589 --> 00:16:07,139
well it can be run in command line so

339
00:16:05,459 --> 00:16:08,819
this is the Cape in action so if you if

340
00:16:07,139 --> 00:16:11,399
you click something there will be also a

341
00:16:08,819 --> 00:16:13,620
command line parses there so whenever

342
00:16:11,399 --> 00:16:17,970
you want to run it and a GUI you can do

343
00:16:13,620 --> 00:16:21,750
it in a command line so here's the thing

344
00:16:17,970 --> 00:16:25,110
I have this VM that runs on a 50 gig of

345
00:16:21,750 --> 00:16:27,540
high days and I want to collect the IR

346
00:16:25,110 --> 00:16:29,699
artifacts there and it just took me 36

347
00:16:27,540 --> 00:16:33,540
seconds to complete to complete those

348
00:16:29,699 --> 00:16:37,529
data collection and it gives me 723 of

349
00:16:33,540 --> 00:16:39,449
em BMP files so it's really fast if

350
00:16:37,529 --> 00:16:42,089
we're talking about data collections and

351
00:16:39,449 --> 00:16:43,500
I hope that everyone who's doing those

352
00:16:42,089 --> 00:16:45,509
data collections in forensics can

353
00:16:43,500 --> 00:16:49,980
leverage this tool because you can also

354
00:16:45,509 --> 00:16:52,939
put your own modules there and use it on

355
00:16:49,980 --> 00:16:56,629
your own purpose

356
00:16:52,939 --> 00:17:02,990
so YK is very robust very flexible very

357
00:16:56,629 --> 00:17:02,990
portable and its really really very fast

358
00:17:03,049 --> 00:17:08,829
ok so also the data that you can collect

359
00:17:06,689 --> 00:17:11,350
the data that we collected can be

360
00:17:08,829 --> 00:17:14,408
so process within that keep itself so

361
00:17:11,349 --> 00:17:18,158
you have to leverage that let's shift

362
00:17:14,409 --> 00:17:21,789
gears a little bit and discuss how I OC

363
00:17:18,159 --> 00:17:24,699
works so for the sub perspective we have

364
00:17:21,789 --> 00:17:27,250
a different IP hashes domains we have

365
00:17:24,699 --> 00:17:29,950
thousands thousands of those but what if

366
00:17:27,250 --> 00:17:31,480
we need to run those irises in just one

367
00:17:29,950 --> 00:17:36,010
endpoint that is being infected by

368
00:17:31,480 --> 00:17:38,220
malware ransomware or whatever so it

369
00:17:36,010 --> 00:17:40,990
comes to the point that yarrow roots is

370
00:17:38,220 --> 00:17:43,179
being used from the from the wild now

371
00:17:40,990 --> 00:17:47,649
and also being used by the myeloid

372
00:17:43,179 --> 00:17:52,260
researcher and how can we how can we

373
00:17:47,649 --> 00:17:55,840
boost some scanning using this Jana was

374
00:17:52,260 --> 00:17:58,179
including the different IPS IOC s from

375
00:17:55,840 --> 00:18:01,269
the community itself so there's this

376
00:17:58,179 --> 00:18:04,510
thing called Loki Loki to the rescue so

377
00:18:01,269 --> 00:18:06,700
Loki was created by Florian Roth and

378
00:18:04,510 --> 00:18:07,990
he's also the one who created signals

379
00:18:06,700 --> 00:18:11,350
which I will be talking later

380
00:18:07,990 --> 00:18:13,240
so Loki is if an IOC scanner that you

381
00:18:11,350 --> 00:18:16,059
can leverage during your IR engagement

382
00:18:13,240 --> 00:18:18,669
so it contains apt tools have tools and

383
00:18:16,059 --> 00:18:22,529
also web shows so web shells are

384
00:18:18,669 --> 00:18:25,840
normally being available on the

385
00:18:22,529 --> 00:18:29,080
antivirus perspective so if you run this

386
00:18:25,840 --> 00:18:32,189
too it can detects a lot of things so

387
00:18:29,080 --> 00:18:34,928
this is a command line based platform

388
00:18:32,190 --> 00:18:37,000
when I try to run it so I have an

389
00:18:34,929 --> 00:18:40,059
infected machine I run a lot of attack

390
00:18:37,000 --> 00:18:44,250
I'll run a PT simulator and then it

391
00:18:40,059 --> 00:18:46,990
keeps me like this so this is just small

392
00:18:44,250 --> 00:18:50,169
defections that we can give me can the

393
00:18:46,990 --> 00:18:53,260
program that can be abused by anyone it

394
00:18:50,169 --> 00:18:55,350
can also diffic a jpg file that if you

395
00:18:53,260 --> 00:18:58,629
click jpg file it executes its payload

396
00:18:55,350 --> 00:19:00,549
it can also do those normal external

397
00:18:58,630 --> 00:19:03,549
file or Microsoft Word that contains

398
00:19:00,549 --> 00:19:06,610
JavaScript that has embedded JavaScript

399
00:19:03,549 --> 00:19:08,918
or one it's exploits or payload so we

400
00:19:06,610 --> 00:19:13,600
can leverage this and use these as our

401
00:19:08,919 --> 00:19:14,820
IR Arsenal as well so this is just a

402
00:19:13,600 --> 00:19:19,030
plug-and-play

403
00:19:14,820 --> 00:19:21,129
it is conveyor and also in a GPO

404
00:19:19,030 --> 00:19:23,710
and this is free and there's an

405
00:19:21,130 --> 00:19:25,540
enterprise version of Thor off of Loki

406
00:19:23,710 --> 00:19:29,410
which is an apt scandal Thor

407
00:19:25,540 --> 00:19:34,510
so the Marvel fans out there you know

408
00:19:29,410 --> 00:19:36,220
where he gave those names and right now

409
00:19:34,510 --> 00:19:40,540
I'm gonna be talking about red hunting

410
00:19:36,220 --> 00:19:42,820
with zero budget so I'm a fan of EDR I'm

411
00:19:40,540 --> 00:19:45,550
not saying that idiots but I'm really a

412
00:19:42,820 --> 00:19:46,929
fan of that we use different if there

413
00:19:45,550 --> 00:19:49,690
are platforms and it really makes sense

414
00:19:46,930 --> 00:19:52,840
to video in your environment but what if

415
00:19:49,690 --> 00:19:54,970
you can't afford easier so how can you

416
00:19:52,840 --> 00:19:57,879
how can you investigate OSI smell like

417
00:19:54,970 --> 00:20:02,470
special logs how those windows event

418
00:19:57,880 --> 00:20:05,050
vlogs if you don't have a budget and the

419
00:20:02,470 --> 00:20:07,150
finest attack right now leveraging

420
00:20:05,050 --> 00:20:10,570
living off the land binaries are being

421
00:20:07,150 --> 00:20:15,010
used by the sophisticated campaigns apts

422
00:20:10,570 --> 00:20:16,659
and malware's so the the by where the

423
00:20:15,010 --> 00:20:18,940
attackers are stepping out their game

424
00:20:16,660 --> 00:20:21,430
and trying to leverage the pioneers that

425
00:20:18,940 --> 00:20:24,190
inside of the Windows platform so how

426
00:20:21,430 --> 00:20:29,950
can we detect those things are you

427
00:20:24,190 --> 00:20:32,350
familiar with this logs this is a

428
00:20:29,950 --> 00:20:36,330
Metasploit meterpreter payload via

429
00:20:32,350 --> 00:20:40,030
command line it contains base64 a format

430
00:20:36,330 --> 00:20:41,129
so deep blue sea a line from Eric Conrad

431
00:20:40,030 --> 00:20:44,350
from sands

432
00:20:41,130 --> 00:20:47,740
he created a powerful tool that detects

433
00:20:44,350 --> 00:20:54,070
those effects that easily evaded by

434
00:20:47,740 --> 00:20:56,650
antivirus it effects base64 commands it

435
00:20:54,070 --> 00:20:58,450
affects password spraying and a lot of

436
00:20:56,650 --> 00:21:01,720
things and you can also convert the

437
00:20:58,450 --> 00:21:04,840
output into a report to be CSV could be

438
00:21:01,720 --> 00:21:09,240
an HTML file as well so I have a demo

439
00:21:04,840 --> 00:21:13,600
here but I just recorded with okay so

440
00:21:09,240 --> 00:21:19,060
I've run a one-liner mimic ads on my VM

441
00:21:13,600 --> 00:21:23,290
using PowerShell and okay so when I copy

442
00:21:19,060 --> 00:21:24,600
it and then it runs on my VM and after

443
00:21:23,290 --> 00:21:27,120
running this

444
00:21:24,600 --> 00:21:30,330
I will open the deep blue sea Li and

445
00:21:27,120 --> 00:21:34,830
then you can see how how deep blue sea

446
00:21:30,330 --> 00:21:38,550
Li can detect such attacks I'm not sure

447
00:21:34,830 --> 00:21:40,439
if you can see it but so done with the

448
00:21:38,550 --> 00:21:43,830
mimic us and now I'm opening deep blue

449
00:21:40,440 --> 00:21:47,130
sea Li and then I apart the lab the

450
00:21:43,830 --> 00:21:49,050
PowerShell so it it gives me the flag

451
00:21:47,130 --> 00:21:53,250
that is being used by mimic as in para

452
00:21:49,050 --> 00:21:59,159
Shou it's it's a lot but I just stopped

453
00:21:53,250 --> 00:22:02,310
it and it will detect the Polish absurd

454
00:21:59,160 --> 00:22:05,010
station the base64-encoded commands and

455
00:22:02,310 --> 00:22:07,230
it also decodes the page 64 command

456
00:22:05,010 --> 00:22:09,750
itself automatically so you don't need

457
00:22:07,230 --> 00:22:13,230
to use cyber chef or whatever decoder

458
00:22:09,750 --> 00:22:16,530
that you have so here I'm just showing

459
00:22:13,230 --> 00:22:19,560
the detections that was done by mimic as

460
00:22:16,530 --> 00:22:22,770
using the Li and I'm gonna open

461
00:22:19,560 --> 00:22:27,870
the test with the exercise that I have

462
00:22:22,770 --> 00:22:32,040
here so those things are normally being

463
00:22:27,870 --> 00:22:33,659
invaded by antivirus and this is not

464
00:22:32,040 --> 00:22:35,790
perfect well you know this is free open

465
00:22:33,660 --> 00:22:38,070
source but it really helps me when it

466
00:22:35,790 --> 00:22:40,830
comes to detecting those kind of low

467
00:22:38,070 --> 00:22:43,710
beam attacks so as you can see there's a

468
00:22:40,830 --> 00:22:52,800
lot of obfuscation here and it also

469
00:22:43,710 --> 00:22:55,670
decodes it automatically ok the last

470
00:22:52,800 --> 00:22:58,530
topic that I wanted to talk is all about

471
00:22:55,670 --> 00:23:01,680
detection engineering so we have this

472
00:22:58,530 --> 00:23:04,860
case that one client asked us to create

473
00:23:01,680 --> 00:23:08,070
a detections to defect such case like

474
00:23:04,860 --> 00:23:11,219
mimic ads using curator okay so we spent

475
00:23:08,070 --> 00:23:13,590
time to the fact mimic as create search

476
00:23:11,220 --> 00:23:16,430
queries to detect that attack and

477
00:23:13,590 --> 00:23:20,570
another client asked us to create a

478
00:23:16,430 --> 00:23:25,470
detection to mimic as using Splunk or

479
00:23:20,570 --> 00:23:27,899
ALK and do you think the curator such

480
00:23:25,470 --> 00:23:31,650
way that we have can be run into Splunk

481
00:23:27,900 --> 00:23:33,580
and ALK as well possibly not because the

482
00:23:31,650 --> 00:23:35,650
the logic the logic is there

483
00:23:33,580 --> 00:23:37,899
but the different it contains different

484
00:23:35,650 --> 00:23:42,340
field names such as source IP it can be

485
00:23:37,900 --> 00:23:43,140
SRC that IP can be source - IP can be

486
00:23:42,340 --> 00:23:46,360
anything

487
00:23:43,140 --> 00:23:49,630
so that's why flowing god created these

488
00:23:46,360 --> 00:23:58,270
signals so he created the standard

489
00:23:49,630 --> 00:24:01,510
language to detect attacks and yeah so

490
00:23:58,270 --> 00:24:03,639
enable also analytics to Tilly use the

491
00:24:01,510 --> 00:24:05,440
sharing so across the labs it is being

492
00:24:03,640 --> 00:24:07,060
supported by the community so a lot of

493
00:24:05,440 --> 00:24:09,610
community now is creating their own

494
00:24:07,060 --> 00:24:12,899
Sigma rules and you can use that to put

495
00:24:09,610 --> 00:24:15,909
into your sim to defect such attacks and

496
00:24:12,900 --> 00:24:18,670
this is the sample of Sigma rules so it

497
00:24:15,910 --> 00:24:22,620
had it contains different meta data as

498
00:24:18,670 --> 00:24:25,810
well as the detection logic behind it

499
00:24:22,620 --> 00:24:32,350
and I have I have a little demo here as

500
00:24:25,810 --> 00:24:34,800
well talking about signals so we have

501
00:24:32,350 --> 00:24:39,159
this website called you encoded at i/o

502
00:24:34,800 --> 00:24:42,040
so here I'm trying to go to the gif have

503
00:24:39,160 --> 00:24:45,100
that contain signals and again I want to

504
00:24:42,040 --> 00:24:47,170
create rules that affect me me cats so

505
00:24:45,100 --> 00:24:49,659
there's a bunch of Sigma rules that is

506
00:24:47,170 --> 00:24:52,590
available that we can leverage even

507
00:24:49,660 --> 00:24:55,300
using different seem that we have and

508
00:24:52,590 --> 00:24:57,429
there's also a pre-filtered rules right

509
00:24:55,300 --> 00:24:59,980
there and there you go there's a mimic

510
00:24:57,430 --> 00:25:03,250
has detection okay I want to use this

511
00:24:59,980 --> 00:25:05,050
detection on my platform using ALK you

512
00:25:03,250 --> 00:25:07,030
just have to translate it and it will

513
00:25:05,050 --> 00:25:08,200
automatically translate it into either

514
00:25:07,030 --> 00:25:12,070
key fields

515
00:25:08,200 --> 00:25:13,630
how about spline and how curator you

516
00:25:12,070 --> 00:25:16,389
just have to click the translate button

517
00:25:13,630 --> 00:25:19,240
and then it will give you the exact ways

518
00:25:16,390 --> 00:25:21,360
that you can run on your platform and it

519
00:25:19,240 --> 00:25:25,000
also has the PowerShell carbon that

520
00:25:21,360 --> 00:25:27,879
whatever vendors that you have is always

521
00:25:25,000 --> 00:25:29,800
there and I want to just stop so nice

522
00:25:27,880 --> 00:25:32,500
slide that I have is about final

523
00:25:29,800 --> 00:25:34,960
fidelity so this is really a growth

524
00:25:32,500 --> 00:25:38,950
concept when it comes to detection

525
00:25:34,960 --> 00:25:41,660
strategies so the final of fidelity the

526
00:25:38,950 --> 00:25:45,020
essence of this is to each

527
00:25:41,660 --> 00:25:47,930
state exists to filter out noise in a

528
00:25:45,020 --> 00:25:50,120
calculated way but also affects the

529
00:25:47,930 --> 00:25:52,610
ability of the future steps to be

530
00:25:50,120 --> 00:25:54,709
successful so from 1 million events that

531
00:25:52,610 --> 00:25:57,050
you have it will goes down to the

532
00:25:54,710 --> 00:26:00,140
detection and then if those any heats

533
00:25:57,050 --> 00:26:02,930
under the patient's let's say from 1 tau

534
00:26:00,140 --> 00:26:06,920
1 million events going to 100 detections

535
00:26:02,930 --> 00:26:09,380
because because of the hits then that's

536
00:26:06,920 --> 00:26:11,210
the time that you go the triage if

537
00:26:09,380 --> 00:26:14,510
there's any events that is worth

538
00:26:11,210 --> 00:26:16,640
investigating for and seems like a

539
00:26:14,510 --> 00:26:18,770
legitimate or a true positive one that

540
00:26:16,640 --> 00:26:22,010
comes with the investigation pace if

541
00:26:18,770 --> 00:26:24,139
we're lack of our events and we need

542
00:26:22,010 --> 00:26:26,990
more artifacts to investigate that

543
00:26:24,140 --> 00:26:29,870
attack then that boils down to the

544
00:26:26,990 --> 00:26:31,820
remediation part so there's the essence

545
00:26:29,870 --> 00:26:34,010
of final fidelity it means to gather

546
00:26:31,820 --> 00:26:36,050
from one place to another and it needs

547
00:26:34,010 --> 00:26:38,270
to be successful for you to be able to

548
00:26:36,050 --> 00:26:43,580
defect the world I think that you need

549
00:26:38,270 --> 00:26:45,330
to investigate and that that's all thank

550
00:26:43,580 --> 00:26:50,199
you so much for your time

551
00:26:45,330 --> 00:26:57,589
[Applause]

552
00:26:50,200 --> 00:26:57,589
[Music]

